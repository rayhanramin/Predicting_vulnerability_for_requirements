<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 29297:38631616c65c43cc99b885d1de75ba2c516871ed</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 38631616c65c43cc99b885d1de75ba2c516871ed" />
<meta property="og:url" content="/comm-central/rev/38631616c65c43cc99b885d1de75ba2c516871ed" />
<meta property="og:description" content="Bug 1621782 - Import json-c sources into comm-central. r=kaie" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 38631616c65c43cc99b885d1de75ba2c516871ed 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/38631616c65c43cc99b885d1de75ba2c516871ed">shortlog</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/38631616c65c43cc99b885d1de75ba2c516871ed">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed">files</a> |
changeset |
<a href="/comm-central/raw-rev/38631616c65c43cc99b885d1de75ba2c516871ed">raw</a>  | <a href="/comm-central/archive/38631616c65c43cc99b885d1de75ba2c516871ed.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1621782">Bug 1621782</a> - Import json-c sources into comm-central. r=kaie
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#82;&#111;&#98;&#32;&#76;&#101;&#109;&#108;&#101;&#121;&#32;&#60;&#114;&#111;&#98;&#64;&#116;&#104;&#117;&#110;&#100;&#101;&#114;&#98;&#105;&#114;&#100;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 14 Apr 2020 22:30:29 +0000</td></tr>

<tr>
 <td>changeset 29297</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/38631616c65c43cc99b885d1de75ba2c516871ed">38631616c65c43cc99b885d1de75ba2c516871ed</a></td>
</tr>



<tr>
<td>parent 29296</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/fec353984d2545227f0e160e8c1fa89c00f4fa65">fec353984d2545227f0e160e8c1fa89c00f4fa65</a>
</td>
</tr>

<tr>
<td>child 29298</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/5bda64d96f5f88cd886bb7064c5108ca04403280">5bda64d96f5f88cd886bb7064c5108ca04403280</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=38631616c65c43cc99b885d1de75ba2c516871ed">17301</a></td></tr>
<tr><td>push user</td><td>thunderbird@calypsoblue.org</td></tr>
<tr><td>push date</td><td class="date age">Wed, 15 Apr 2020 18:01:44 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@7c06681d8e9a [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=7c06681d8e9a22d9226498c34b620cd4d3cf8ea3">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=7c06681d8e9a22d9226498c34b620cd4d3cf8ea3&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7c06681d8e9a22d9226498c34b620cd4d3cf8ea3&newProject=comm-central&newRevision=46d32cfff30ff3d8ad4aeeb10f557283b44c10ee&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7c06681d8e9a22d9226498c34b620cd4d3cf8ea3&newProject=comm-central&newRevision=46d32cfff30ff3d8ad4aeeb10f557283b44c10ee&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7c06681d8e9a22d9226498c34b620cd4d3cf8ea3&newProject=comm-central&newRevision=46d32cfff30ff3d8ad4aeeb10f557283b44c10ee&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28kaie%29&revcount=50">kaie</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1621782">1621782</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1621782">Bug 1621782</a> - Import json-c sources into comm-central. r=kaie

JSON-C is a dependency of RNP.

Differential Revision: <a href="https://phabricator.services.mozilla.com/D70736">https://phabricator.services.mozilla.com/D70736</a></div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/README.json-c">third_party/README.json-c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/README.json-c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/README.json-c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/README.json-c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/README.json-c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/README.json-c">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/AUTHORS">third_party/json-c/AUTHORS</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/AUTHORS">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/AUTHORS">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/AUTHORS">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/AUTHORS">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/AUTHORS">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/COPYING">third_party/json-c/COPYING</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/COPYING">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/COPYING">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/COPYING">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/COPYING">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/COPYING">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/ChangeLog">third_party/json-c/ChangeLog</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/ChangeLog">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/ChangeLog">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/ChangeLog">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/ChangeLog">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/ChangeLog">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/INSTALL">third_party/json-c/INSTALL</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/INSTALL">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/INSTALL">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/INSTALL">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/INSTALL">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/INSTALL">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/NEWS">third_party/json-c/NEWS</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/NEWS">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/NEWS">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/NEWS">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/NEWS">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/NEWS">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.html">third_party/json-c/README.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.html">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.html">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.html">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.html">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.html">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.md">third_party/json-c/README.md</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.md">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.md">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.md">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.md">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/README.md">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/RELEASE_CHECKLIST.txt">third_party/json-c/RELEASE_CHECKLIST.txt</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/RELEASE_CHECKLIST.txt">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/RELEASE_CHECKLIST.txt">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/RELEASE_CHECKLIST.txt">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/RELEASE_CHECKLIST.txt">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/RELEASE_CHECKLIST.txt">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/STYLE.txt">third_party/json-c/STYLE.txt</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/STYLE.txt">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/STYLE.txt">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/STYLE.txt">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/STYLE.txt">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/STYLE.txt">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.c">third_party/json-c/arraylist.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.c">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.h">third_party/json-c/arraylist.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/arraylist.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/bits.h">third_party/json-c/bits.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/bits.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/bits.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/bits.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/bits.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/bits.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.in">third_party/json-c/config.h.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.in">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.in">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.in">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.in">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.win32">third_party/json-c/config.h.win32</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.win32">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.win32">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.win32">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.win32">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/config.h.win32">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.c">third_party/json-c/debug.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.c">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.h">third_party/json-c/debug.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/debug.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/issues_closed_for_0.13.md">third_party/json-c/issues_closed_for_0.13.md</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/issues_closed_for_0.13.md">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/issues_closed_for_0.13.md">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/issues_closed_for_0.13.md">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/issues_closed_for_0.13.md">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/issues_closed_for_0.13.md">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json.h">third_party/json-c/json.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.c">third_party/json-c/json_c_version.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.c">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.h">third_party/json-c/json_c_version.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_c_version.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.in">third_party/json-c/json_config.h.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.in">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.in">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.in">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.in">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.win32">third_party/json-c/json_config.h.win32</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.win32">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.win32">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.win32">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.win32">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_config.h.win32">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_inttypes.h">third_party/json-c/json_inttypes.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_inttypes.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_inttypes.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_inttypes.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_inttypes.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_inttypes.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.c">third_party/json-c/json_object.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.c">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.h">third_party/json-c/json_object.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.c">third_party/json-c/json_object_iterator.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.c">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.h">third_party/json-c/json_object_iterator.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_iterator.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_private.h">third_party/json-c/json_object_private.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_private.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_private.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_private.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_private.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_object_private.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.c">third_party/json-c/json_pointer.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.c">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.h">third_party/json-c/json_pointer.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_pointer.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.c">third_party/json-c/json_tokener.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.c">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.h">third_party/json-c/json_tokener.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_tokener.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.c">third_party/json-c/json_util.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.c">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.h">third_party/json-c/json_util.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_util.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.c">third_party/json-c/json_visit.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.c">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.h">third_party/json-c/json_visit.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/json_visit.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/libjson.c">third_party/json-c/libjson.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/libjson.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/libjson.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/libjson.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/libjson.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/libjson.c">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.c">third_party/json-c/linkhash.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.c">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.h">third_party/json-c/linkhash.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/linkhash.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/math_compat.h">third_party/json-c/math_compat.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/math_compat.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/math_compat.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/math_compat.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/math_compat.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/math_compat.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.c">third_party/json-c/printbuf.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.c">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.h">third_party/json-c/printbuf.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/printbuf.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.c">third_party/json-c/random_seed.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.c">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.h">third_party/json-c/random_seed.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/random_seed.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/snprintf_compat.h">third_party/json-c/snprintf_compat.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/snprintf_compat.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/snprintf_compat.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/snprintf_compat.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/snprintf_compat.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/snprintf_compat.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strdup_compat.h">third_party/json-c/strdup_compat.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strdup_compat.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strdup_compat.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strdup_compat.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strdup_compat.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strdup_compat.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.c">third_party/json-c/strerror_override.c</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.c">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.c">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.c">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.c">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.c">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.h">third_party/json-c/strerror_override.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override_private.h">third_party/json-c/strerror_override_private.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override_private.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override_private.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override_private.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override_private.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/strerror_override_private.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/vasprintf_compat.h">third_party/json-c/vasprintf_compat.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/vasprintf_compat.h">file</a> |
<a href="/comm-central/annotate/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/vasprintf_compat.h">annotate</a> |
<a href="/comm-central/diff/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/vasprintf_compat.h">diff</a> |
<a href="/comm-central/comparison/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/vasprintf_compat.h">comparison</a> |
<a href="/comm-central/log/38631616c65c43cc99b885d1de75ba2c516871ed/third_party/json-c/vasprintf_compat.h">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1">new file mode 100644</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineminus">--- /dev/null</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineplus">+++ b/third_party/README.json-c</span>
<a href="#l1.4"></a><span id="l1.4" class="difflineat">@@ -0,0 +1,41 @@</span>
<a href="#l1.5"></a><span id="l1.5" class="difflineplus">+Directory ./json-c contains a copy of version 0.13.1 of the json-c library,</span>
<a href="#l1.6"></a><span id="l1.6" class="difflineplus">+which has been obtained from  https://s3.amazonaws.com/json-c_releases/releases/json-c-0.13.1-nodoc.tar.gz .</span>
<a href="#l1.7"></a><span id="l1.7" class="difflineplus">+(Link at https://github.com/json-c/json-c/wiki).</span>
<a href="#l1.8"></a><span id="l1.8" class="difflineplus">+</span>
<a href="#l1.9"></a><span id="l1.9" class="difflineplus">+For licensing information, please refer to the included documentation.</span>
<a href="#l1.10"></a><span id="l1.10" class="difflineplus">+</span>
<a href="#l1.11"></a><span id="l1.11" class="difflineplus">+The SHA256SUM of the imported file is:</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+94a26340c0785fcff4f46ff38609cf84ebcd670df0c8efd75d039cc951d80132  json-c-0.13.1-nodoc.tar.gz</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+The following files and directories were removed from the source distribution's root:</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+autoconf-archive/</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineplus">+fuzz/</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineplus">+tests/</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineplus">+.editorconfig</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineplus">+.gitignore</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineplus">+.travis.yml</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineplus">+Android.configure.mk</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineplus">+CMakeLists.txt</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineplus">+Doxyfile</span>
<a href="#l1.24"></a><span id="l1.24" class="difflineplus">+Makefile.am</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineplus">+Makefile.in</span>
<a href="#l1.26"></a><span id="l1.26" class="difflineplus">+README</span>
<a href="#l1.27"></a><span id="l1.27" class="difflineplus">+aclocal.m4</span>
<a href="#l1.28"></a><span id="l1.28" class="difflineplus">+appveyor.yml</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineplus">+autogen.sh</span>
<a href="#l1.30"></a><span id="l1.30" class="difflineplus">+compile</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineplus">+config.guess</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineplus">+config.sub</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineplus">+configure</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineplus">+configure.ac</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineplus">+depcomp</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineplus">+install-sh</span>
<a href="#l1.37"></a><span id="l1.37" class="difflineplus">+json-c-uninstalled.pc.in</span>
<a href="#l1.38"></a><span id="l1.38" class="difflineplus">+json-c.pc.in</span>
<a href="#l1.39"></a><span id="l1.39" class="difflineplus">+ltmain.sh</span>
<a href="#l1.40"></a><span id="l1.40" class="difflineplus">+missing</span>
<a href="#l1.41"></a><span id="l1.41" class="difflineplus">+test-driver</span>
<a href="#l1.42"></a><span id="l1.42" class="difflineplus">+</span>
<a href="#l1.43"></a><span id="l1.43" class="difflineplus">+The following files were added to the source's root by MZLA Technologies:</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineplus">+moz.build</span>
<a href="#l1.45"></a><span id="l1.45" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1">new file mode 100644</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineminus">--- /dev/null</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineplus">+++ b/third_party/json-c/AUTHORS</span>
<a href="#l2.4"></a><span id="l2.4" class="difflineat">@@ -0,0 +1,5 @@</span>
<a href="#l2.5"></a><span id="l2.5" class="difflineplus">+Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l2.6"></a><span id="l2.6" class="difflineplus">+Jehiah Czebotar &lt;jehiah@gmail.com&gt;</span>
<a href="#l2.7"></a><span id="l2.7" class="difflineplus">+Eric Haszlakiewicz &lt;hawicz+json-c@gmail.com&gt;</span>
<a href="#l2.8"></a><span id="l2.8" class="difflineplus">+C. Watford (christopher.watford@gmail.com)</span>
<a href="#l2.9"></a><span id="l2.9" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1">new file mode 100644</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineminus">--- /dev/null</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineplus">+++ b/third_party/json-c/COPYING</span>
<a href="#l3.4"></a><span id="l3.4" class="difflineat">@@ -0,0 +1,42 @@</span>
<a href="#l3.5"></a><span id="l3.5" class="difflineplus">+</span>
<a href="#l3.6"></a><span id="l3.6" class="difflineplus">+Copyright (c) 2009-2012 Eric Haszlakiewicz</span>
<a href="#l3.7"></a><span id="l3.7" class="difflineplus">+</span>
<a href="#l3.8"></a><span id="l3.8" class="difflineplus">+Permission is hereby granted, free of charge, to any person obtaining a</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineplus">+copy of this software and associated documentation files (the &quot;Software&quot;),</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineplus">+to deal in the Software without restriction, including without limitation</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineplus">+the rights to use, copy, modify, merge, publish, distribute, sublicense,</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+and/or sell copies of the Software, and to permit persons to whom the</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+Software is furnished to do so, subject to the following conditions:</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+The above copyright notice and this permission notice shall be included</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+in all copies or substantial portions of the Software.</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineplus">+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineplus">+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineplus">+SOFTWARE.</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineplus">+</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+----------------------------------------------------------------</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineplus">+</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineplus">+Copyright (c) 2004, 2005 Metaparadigm Pte Ltd</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+Permission is hereby granted, free of charge, to any person obtaining a</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+copy of this software and associated documentation files (the &quot;Software&quot;),</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+to deal in the Software without restriction, including without limitation</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+the rights to use, copy, modify, merge, publish, distribute, sublicense,</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineplus">+and/or sell copies of the Software, and to permit persons to whom the</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+Software is furnished to do so, subject to the following conditions:</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineplus">+</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineplus">+The above copyright notice and this permission notice shall be included</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+in all copies or substantial portions of the Software.</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineplus">+</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineplus">+THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineplus">+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineplus">+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<a href="#l3.43"></a><span id="l3.43" class="difflineplus">+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineplus">+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<a href="#l3.45"></a><span id="l3.45" class="difflineplus">+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineplus">+SOFTWARE.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1">new file mode 100644</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineminus">--- /dev/null</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineplus">+++ b/third_party/json-c/ChangeLog</span>
<a href="#l4.4"></a><span id="l4.4" class="difflineat">@@ -0,0 +1,382 @@</span>
<a href="#l4.5"></a><span id="l4.5" class="difflineplus">+</span>
<a href="#l4.6"></a><span id="l4.6" class="difflineplus">+0.13.1 (up to commit 0f814e5, 2018/03/04)</span>
<a href="#l4.7"></a><span id="l4.7" class="difflineplus">+=========================================</span>
<a href="#l4.8"></a><span id="l4.8" class="difflineplus">+</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineplus">+* Bump the major version of the .so library generated up to 4.0 to avoid </span>
<a href="#l4.10"></a><span id="l4.10" class="difflineplus">+  conflicts because some downstream packagers of json-c had already done</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineplus">+  their own bump to &quot;.so.3&quot; for a much older 0.12 release.</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+* Add const size_t json_c_object_sizeof()</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+* Avoid invalid free (and thus a segfault) when ref_count gets &lt; 0</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+* PR#394: fix handling of custom double formats that include a &quot;.0&quot;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+* Avoid uninitialized variable warnings in json_object_object_foreach</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+* Issue #396: fix build for certain uClibc based systems.</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+* Add a top level fuzz directory for fuzzers run by OSS-Fuzz</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+0.13 (up to commit 5dae561, 2017/11/29)</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+=================================</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+This release, being three and a half years after the 0.12 branch (f84d9c),</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+   has quite a number of changes included.  The following is a sampling of</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineplus">+   the most significant ones.</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineplus">+Since the 0.12 release, 250 issues and pull requests have been closed.</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineplus">+See issues_closed_for_0.13.md for a complete list.</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+Deprecated and removed features:</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+--------------------------------</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+* All internal use of bits.h has been eliminated.  The file will be removed.</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+	Do not use: hexdigit(), error_ptr(), error_descrition() and it_error() </span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+* lh_abort() is deprecated.  It will be removed.</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+Behavior changes:</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+-----------------</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+* Tighten the number parsing algorithm to raise errors instead of truncating</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+     the results.  For example 12.3.4 or 2015-01-15, which now return null.</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+	 See commit 99d8fc</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+* Use size_t for array length and size.  Platforms where sizeof(size_t) != sizeof(int) may not be backwards compatible</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+	See commits 45c56b, 92e9a5 and others.</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+* Check for failue when allocating memory, returning NULL and errno=ENOMEM.</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineplus">+	 See commit 2149a04.</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineplus">+</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+* Change json_object_object_add() return type from void to int, and will return -1 on failures, instead of exiting. (Note: this is not an ABI change)</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineplus">+</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineplus">+New features:</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+-------------</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineplus">+* We're aiming to follow RFC 7159 now.</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineplus">+</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineplus">+* Add a couple of additional option to json_object_to_json_string_ext:</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineplus">+	JSON_C_TO_STRING_PRETTY_TAB</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineplus">+	JSON_C_TO_STRING_NOSLASHESCAPE</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineplus">+</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineplus">+* Add a json_object_object_add_ex() function to allow for performance</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineplus">+	improvements when certain constraints are known to be true.</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineplus">+</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineplus">+* Make serialization format of doubles configurable, in two different ways:</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineplus">+	Call json_object_set_serializer with json_object_double_to_json_string and a custom</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineplus">+	 format on each double object, or</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineplus">+	Call json_c_set_serialization_double_format() to set a global or thread-wide format.</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineplus">+</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineplus">+* Add utility function for comparing json_objects - json_object_equal()</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineplus">+</span>
<a href="#l4.68"></a><span id="l4.68" class="difflineplus">+* Add a way to copy entire object trees: json_object_deep_copy()</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineplus">+* Add json_object_set_&lt;type&gt; function to modify the value of existing json_object's</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineplus">+ without the need to recreate them.  Also add a json_object_int_inc function to</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineplus">+ adjust an int's value.</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineplus">+* Add support for JSON pointer, RFC 6901.  See json_pointer.h</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineplus">+* Add a json_util_get_last_err() function to retrieve the string describing the</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineplus">+ cause of errors, instead of printing to stderr.</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineplus">+* Add perllike hash function for strings, and json_global_set_string_hash() 8f8d03d</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineplus">+* Add a json_c_visit() function to provide a way to iterate over a tree of json-c objects.</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineplus">+</span>
<a href="#l4.78"></a><span id="l4.78" class="difflineplus">+Notable bug fixes and other improvements:</span>
<a href="#l4.79"></a><span id="l4.79" class="difflineplus">+-----------------------------------------</span>
<a href="#l4.80"></a><span id="l4.80" class="difflineplus">+* Make reference increment and decrement atomic to allow passing json objects between threads.</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineplus">+* Fix json_object_object_foreach to avoid uninitialized variable warnings.</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineplus">+* Improve performance by removing unneeded data items from hashtable code and reducing duplicate hash computation.</span>
<a href="#l4.83"></a><span id="l4.83" class="difflineplus">+* Improve performance by storing small strings inside json_object</span>
<a href="#l4.84"></a><span id="l4.84" class="difflineplus">+* Improve performance of json_object_to_json_string by removing variadic printf. commit 9ff0f49</span>
<a href="#l4.85"></a><span id="l4.85" class="difflineplus">+* Issue #371: fix parsing of &quot;-Infinity&quot;, and avoid needlessly copying the input when doing so.</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineplus">+* Fix stack buffer overflow in json_object_double_to_json_string_format() - commit 2c2deb87</span>
<a href="#l4.87"></a><span id="l4.87" class="difflineplus">+* Fix various potential null ptr deref and int32 overflows</span>
<a href="#l4.88"></a><span id="l4.88" class="difflineplus">+* Issue #332: fix a long-standing bug in array_list_put_idx() where it would attempt to free previously free'd entries due to not checking the current array length.</span>
<a href="#l4.89"></a><span id="l4.89" class="difflineplus">+* Issue #195: use uselocale() instead of setlocale() in json_tokener to behave better in threaded environments.</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineplus">+* Issue #275: fix out of bounds read when handling unicode surrogate pairs.</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineplus">+* Ensure doubles that happen to be a whole number are emitted with &quot;.0&quot; - commit ca7a19</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineplus">+* PR#331: for Visual Studio, use a snprintf/vsnprintf wrapper that ensures the string is terminated.</span>
<a href="#l4.93"></a><span id="l4.93" class="difflineplus">+* Fix double to int cast overflow in json_object_get_int64.</span>
<a href="#l4.94"></a><span id="l4.94" class="difflineplus">+* Clamp double to int32 when narrowing in json_object_get_int.</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineplus">+* Use strtoll() to parse ints - instead of sscanf</span>
<a href="#l4.96"></a><span id="l4.96" class="difflineplus">+* Miscellaneous smaller changes, including removing unused variables, fixing warning</span>
<a href="#l4.97"></a><span id="l4.97" class="difflineplus">+ about uninitialized variables adding const qualifiers, reformatting code, etc...</span>
<a href="#l4.98"></a><span id="l4.98" class="difflineplus">+</span>
<a href="#l4.99"></a><span id="l4.99" class="difflineplus">+Build changes:</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineplus">+--------------</span>
<a href="#l4.101"></a><span id="l4.101" class="difflineplus">+* Add Appveyor and Travis build support</span>
<a href="#l4.102"></a><span id="l4.102" class="difflineplus">+* Switch to using CMake when building on Windows with Visual Studio.</span>
<a href="#l4.103"></a><span id="l4.103" class="difflineplus">+	A dynamic .dll is generated instead of a .lib</span>
<a href="#l4.104"></a><span id="l4.104" class="difflineplus">+	config.h is now generated, config.h.win32 should no longer be manually copied</span>
<a href="#l4.105"></a><span id="l4.105" class="difflineplus">+* Add support for MacOS through CMake too.</span>
<a href="#l4.106"></a><span id="l4.106" class="difflineplus">+* Enable silent build by default</span>
<a href="#l4.107"></a><span id="l4.107" class="difflineplus">+* Link against libm when needed</span>
<a href="#l4.108"></a><span id="l4.108" class="difflineplus">+* Add support for building with AddressSanitizer</span>
<a href="#l4.109"></a><span id="l4.109" class="difflineplus">+* Add support for building with Clang</span>
<a href="#l4.110"></a><span id="l4.110" class="difflineplus">+* Add a --enable-threading configure option, and only use the (slower) __sync_add_and_fetch()/__sync_sub_and_fetch() function when it is specified.</span>
<a href="#l4.111"></a><span id="l4.111" class="difflineplus">+</span>
<a href="#l4.112"></a><span id="l4.112" class="difflineplus">+List of new functions added:</span>
<a href="#l4.113"></a><span id="l4.113" class="difflineplus">+----------------------------</span>
<a href="#l4.114"></a><span id="l4.114" class="difflineplus">+### json_object.h</span>
<a href="#l4.115"></a><span id="l4.115" class="difflineplus">+* array_list_bsearch()</span>
<a href="#l4.116"></a><span id="l4.116" class="difflineplus">+* array_list_del_idx()</span>
<a href="#l4.117"></a><span id="l4.117" class="difflineplus">+* json_object_to_json_string_length()</span>
<a href="#l4.118"></a><span id="l4.118" class="difflineplus">+* json_object_get_userdata()</span>
<a href="#l4.119"></a><span id="l4.119" class="difflineplus">+* json_object_set_userdata()</span>
<a href="#l4.120"></a><span id="l4.120" class="difflineplus">+* json_object_object_add_ex()</span>
<a href="#l4.121"></a><span id="l4.121" class="difflineplus">+* json_object_array_bsearch()</span>
<a href="#l4.122"></a><span id="l4.122" class="difflineplus">+* json_object_array_del_idx()</span>
<a href="#l4.123"></a><span id="l4.123" class="difflineplus">+* json_object_set_boolean()</span>
<a href="#l4.124"></a><span id="l4.124" class="difflineplus">+* json_object_set_int()</span>
<a href="#l4.125"></a><span id="l4.125" class="difflineplus">+* json_object_int_inc()</span>
<a href="#l4.126"></a><span id="l4.126" class="difflineplus">+* json_object_set_int64()</span>
<a href="#l4.127"></a><span id="l4.127" class="difflineplus">+* json_c_set_serialization_double_format()</span>
<a href="#l4.128"></a><span id="l4.128" class="difflineplus">+* json_object_double_to_json_string()</span>
<a href="#l4.129"></a><span id="l4.129" class="difflineplus">+* json_object_set_double()</span>
<a href="#l4.130"></a><span id="l4.130" class="difflineplus">+* json_object_set_string()</span>
<a href="#l4.131"></a><span id="l4.131" class="difflineplus">+* json_object_set_string_len()</span>
<a href="#l4.132"></a><span id="l4.132" class="difflineplus">+* json_object_equal()</span>
<a href="#l4.133"></a><span id="l4.133" class="difflineplus">+* json_object_deep_copy()</span>
<a href="#l4.134"></a><span id="l4.134" class="difflineplus">+</span>
<a href="#l4.135"></a><span id="l4.135" class="difflineplus">+### json_pointer.h</span>
<a href="#l4.136"></a><span id="l4.136" class="difflineplus">+* json_pointer_get()</span>
<a href="#l4.137"></a><span id="l4.137" class="difflineplus">+* json_pointer_getf()</span>
<a href="#l4.138"></a><span id="l4.138" class="difflineplus">+* json_pointer_set()</span>
<a href="#l4.139"></a><span id="l4.139" class="difflineplus">+* json_pointer_setf()</span>
<a href="#l4.140"></a><span id="l4.140" class="difflineplus">+</span>
<a href="#l4.141"></a><span id="l4.141" class="difflineplus">+### json_util.h</span>
<a href="#l4.142"></a><span id="l4.142" class="difflineplus">+* json_object_from_fd()</span>
<a href="#l4.143"></a><span id="l4.143" class="difflineplus">+* json_object_to_fd()</span>
<a href="#l4.144"></a><span id="l4.144" class="difflineplus">+* json_util_get_last_err()</span>
<a href="#l4.145"></a><span id="l4.145" class="difflineplus">+</span>
<a href="#l4.146"></a><span id="l4.146" class="difflineplus">+### json_visit.h</span>
<a href="#l4.147"></a><span id="l4.147" class="difflineplus">+* json_c_visit()</span>
<a href="#l4.148"></a><span id="l4.148" class="difflineplus">+</span>
<a href="#l4.149"></a><span id="l4.149" class="difflineplus">+### linkhash.h</span>
<a href="#l4.150"></a><span id="l4.150" class="difflineplus">+* json_global_set_string_hash()</span>
<a href="#l4.151"></a><span id="l4.151" class="difflineplus">+* lh_table_resize()</span>
<a href="#l4.152"></a><span id="l4.152" class="difflineplus">+</span>
<a href="#l4.153"></a><span id="l4.153" class="difflineplus">+### printbuf.h</span>
<a href="#l4.154"></a><span id="l4.154" class="difflineplus">+* printbuf_strappend()</span>
<a href="#l4.155"></a><span id="l4.155" class="difflineplus">+</span>
<a href="#l4.156"></a><span id="l4.156" class="difflineplus">+</span>
<a href="#l4.157"></a><span id="l4.157" class="difflineplus">+0.12.1</span>
<a href="#l4.158"></a><span id="l4.158" class="difflineplus">+======</span>
<a href="#l4.159"></a><span id="l4.159" class="difflineplus">+</span>
<a href="#l4.160"></a><span id="l4.160" class="difflineplus">+  * Minimal changes to address compile issues.</span>
<a href="#l4.161"></a><span id="l4.161" class="difflineplus">+</span>
<a href="#l4.162"></a><span id="l4.162" class="difflineplus">+0.12</span>
<a href="#l4.163"></a><span id="l4.163" class="difflineplus">+====</span>
<a href="#l4.164"></a><span id="l4.164" class="difflineplus">+</span>
<a href="#l4.165"></a><span id="l4.165" class="difflineplus">+  * Address security issues:</span>
<a href="#l4.166"></a><span id="l4.166" class="difflineplus">+    * CVE-2013-6371: hash collision denial of service</span>
<a href="#l4.167"></a><span id="l4.167" class="difflineplus">+    * CVE-2013-6370: buffer overflow if size_t is larger than int</span>
<a href="#l4.168"></a><span id="l4.168" class="difflineplus">+</span>
<a href="#l4.169"></a><span id="l4.169" class="difflineplus">+  * Avoid potential overflow in json_object_get_double</span>
<a href="#l4.170"></a><span id="l4.170" class="difflineplus">+</span>
<a href="#l4.171"></a><span id="l4.171" class="difflineplus">+  * Eliminate the mc_abort() function and MC_ABORT macro.</span>
<a href="#l4.172"></a><span id="l4.172" class="difflineplus">+</span>
<a href="#l4.173"></a><span id="l4.173" class="difflineplus">+  * Make the json_tokener_errors array local.  It has been deprecated for</span>
<a href="#l4.174"></a><span id="l4.174" class="difflineplus">+     a while, and json_tokener_error_desc() should be used instead.</span>
<a href="#l4.175"></a><span id="l4.175" class="difflineplus">+</span>
<a href="#l4.176"></a><span id="l4.176" class="difflineplus">+  * change the floating point output format to %.17g so values with </span>
<a href="#l4.177"></a><span id="l4.177" class="difflineplus">+     more than 6 digits show up in the output.</span>
<a href="#l4.178"></a><span id="l4.178" class="difflineplus">+</span>
<a href="#l4.179"></a><span id="l4.179" class="difflineplus">+  * Remove the old libjson.so name compatibility support.  The library is</span>
<a href="#l4.180"></a><span id="l4.180" class="difflineplus">+      only created as libjson-c.so now and headers are only installed </span>
<a href="#l4.181"></a><span id="l4.181" class="difflineplus">+      into the ${prefix}/json-c directory.</span>
<a href="#l4.182"></a><span id="l4.182" class="difflineplus">+</span>
<a href="#l4.183"></a><span id="l4.183" class="difflineplus">+  * When supported by the linker, add the -Bsymbolic-functions flag.</span>
<a href="#l4.184"></a><span id="l4.184" class="difflineplus">+</span>
<a href="#l4.185"></a><span id="l4.185" class="difflineplus">+  * Various changes to fix the build on MSVC.</span>
<a href="#l4.186"></a><span id="l4.186" class="difflineplus">+</span>
<a href="#l4.187"></a><span id="l4.187" class="difflineplus">+  * Make strict mode more strict:</span>
<a href="#l4.188"></a><span id="l4.188" class="difflineplus">+    * number must not start with 0</span>
<a href="#l4.189"></a><span id="l4.189" class="difflineplus">+    * no single-quote strings</span>
<a href="#l4.190"></a><span id="l4.190" class="difflineplus">+    * no comments</span>
<a href="#l4.191"></a><span id="l4.191" class="difflineplus">+    * trailing char not allowed</span>
<a href="#l4.192"></a><span id="l4.192" class="difflineplus">+    * only allow lowercase literals</span>
<a href="#l4.193"></a><span id="l4.193" class="difflineplus">+</span>
<a href="#l4.194"></a><span id="l4.194" class="difflineplus">+  * Added a json_object_new_double_s() convenience function to allow</span>
<a href="#l4.195"></a><span id="l4.195" class="difflineplus">+    an exact string representation of a double to be specified when</span>
<a href="#l4.196"></a><span id="l4.196" class="difflineplus">+    creating the object and use it in json_tokener_parse_ex() so</span>
<a href="#l4.197"></a><span id="l4.197" class="difflineplus">+    a re-serialized object more exactly matches the input.</span>
<a href="#l4.198"></a><span id="l4.198" class="difflineplus">+</span>
<a href="#l4.199"></a><span id="l4.199" class="difflineplus">+  * Add support NaN and Infinity</span>
<a href="#l4.200"></a><span id="l4.200" class="difflineplus">+</span>
<a href="#l4.201"></a><span id="l4.201" class="difflineplus">+</span>
<a href="#l4.202"></a><span id="l4.202" class="difflineplus">+0.11</span>
<a href="#l4.203"></a><span id="l4.203" class="difflineplus">+====</span>
<a href="#l4.204"></a><span id="l4.204" class="difflineplus">+</span>
<a href="#l4.205"></a><span id="l4.205" class="difflineplus">+  * IMPORTANT: the name of the library has changed to libjson-c.so and</span>
<a href="#l4.206"></a><span id="l4.206" class="difflineplus">+     the header files are now in include/json-c.</span>
<a href="#l4.207"></a><span id="l4.207" class="difflineplus">+     The pkgconfig name has also changed from json to json-c.</span>
<a href="#l4.208"></a><span id="l4.208" class="difflineplus">+     You should change your build to use appropriate -I and -l options.</span>
<a href="#l4.209"></a><span id="l4.209" class="difflineplus">+     A compatibility shim is in place so builds using the old name will</span>
<a href="#l4.210"></a><span id="l4.210" class="difflineplus">+     continue to work, but that will be removed in the next release.</span>
<a href="#l4.211"></a><span id="l4.211" class="difflineplus">+  * Maximum recursion depth is now a runtime option.</span>
<a href="#l4.212"></a><span id="l4.212" class="difflineplus">+     json_tokener_new() is provided for compatibility.</span>
<a href="#l4.213"></a><span id="l4.213" class="difflineplus">+     json_tokener_new_ex(depth)</span>
<a href="#l4.214"></a><span id="l4.214" class="difflineplus">+  * Include json_object_iterator.h in the installed headers.</span>
<a href="#l4.215"></a><span id="l4.215" class="difflineplus">+  * Add support for building on Android.</span>
<a href="#l4.216"></a><span id="l4.216" class="difflineplus">+  * Rewrite json_object_object_add to replace just the value if the key already exists so keys remain valid.</span>
<a href="#l4.217"></a><span id="l4.217" class="difflineplus">+  * Make it safe to delete keys while iterating with the json_object_object_foreach macro.</span>
<a href="#l4.218"></a><span id="l4.218" class="difflineplus">+  * Add a json_set_serializer() function to allow the string output of a json_object to be customized.</span>
<a href="#l4.219"></a><span id="l4.219" class="difflineplus">+  * Make float parsing locale independent.</span>
<a href="#l4.220"></a><span id="l4.220" class="difflineplus">+  * Add a json_tokener_set_flags() function and a JSON_TOKENER_STRICT flag.</span>
<a href="#l4.221"></a><span id="l4.221" class="difflineplus">+  * Enable -Werror when building.</span>
<a href="#l4.222"></a><span id="l4.222" class="difflineplus">+  * speed improvements to parsing 64-bit integers on systems with working sscanf</span>
<a href="#l4.223"></a><span id="l4.223" class="difflineplus">+  * Add a json_object_object_length function.</span>
<a href="#l4.224"></a><span id="l4.224" class="difflineplus">+  * Fix a bug (buffer overrun) when expanding arrays to more than 64 entries.</span>
<a href="#l4.225"></a><span id="l4.225" class="difflineplus">+</span>
<a href="#l4.226"></a><span id="l4.226" class="difflineplus">+0.10</span>
<a href="#l4.227"></a><span id="l4.227" class="difflineplus">+====</span>
<a href="#l4.228"></a><span id="l4.228" class="difflineplus">+</span>
<a href="#l4.229"></a><span id="l4.229" class="difflineplus">+  * Add a json_object_to_json_string_ext() function to allow output to be</span>
<a href="#l4.230"></a><span id="l4.230" class="difflineplus">+     formatted in a more human readable form.</span>
<a href="#l4.231"></a><span id="l4.231" class="difflineplus">+  * Add json_object_object_get_ex(), a NULL-safe get object method, to be able</span>
<a href="#l4.232"></a><span id="l4.232" class="difflineplus">+     to distinguish between a key not present and the value being NULL.</span>
<a href="#l4.233"></a><span id="l4.233" class="difflineplus">+  * Add an alternative iterator implementation, see json_object_iterator.h</span>
<a href="#l4.234"></a><span id="l4.234" class="difflineplus">+  * Make json_object_iter public to enable external use of the</span>
<a href="#l4.235"></a><span id="l4.235" class="difflineplus">+     json_object_object_foreachC macro.</span>
<a href="#l4.236"></a><span id="l4.236" class="difflineplus">+  * Add a printbuf_memset() function to provide an effecient way to set and</span>
<a href="#l4.237"></a><span id="l4.237" class="difflineplus">+     append things like whitespace indentation.</span>
<a href="#l4.238"></a><span id="l4.238" class="difflineplus">+  * Adjust json_object_is_type and json_object_get_type so they return</span>
<a href="#l4.239"></a><span id="l4.239" class="difflineplus">+      json_type_null for NULL objects and handle NULL passed to</span>
<a href="#l4.240"></a><span id="l4.240" class="difflineplus">+      json_objct_object_get().</span>
<a href="#l4.241"></a><span id="l4.241" class="difflineplus">+  * Rename boolean type to json_bool.</span>
<a href="#l4.242"></a><span id="l4.242" class="difflineplus">+  * Fix various compile issues for Visual Studio and MinGW.</span>
<a href="#l4.243"></a><span id="l4.243" class="difflineplus">+  * Allow json_tokener_parse_ex() to be re-used to parse multiple object.</span>
<a href="#l4.244"></a><span id="l4.244" class="difflineplus">+     Also, fix some parsing issues with capitalized hexadecimal numbers and</span>
<a href="#l4.245"></a><span id="l4.245" class="difflineplus">+     number in E notation.</span>
<a href="#l4.246"></a><span id="l4.246" class="difflineplus">+  * Add json_tokener_get_error() and json_tokener_error_desc() to better </span>
<a href="#l4.247"></a><span id="l4.247" class="difflineplus">+     encapsulate the process of retrieving errors while parsing.</span>
<a href="#l4.248"></a><span id="l4.248" class="difflineplus">+  * Various improvements to the documentation of many functions.</span>
<a href="#l4.249"></a><span id="l4.249" class="difflineplus">+  * Add new json_object_array_sort() function.</span>
<a href="#l4.250"></a><span id="l4.250" class="difflineplus">+  * Fix a bug in json_object_get_int(), which would incorrectly return 0</span>
<a href="#l4.251"></a><span id="l4.251" class="difflineplus">+    when called on a string type object.</span>
<a href="#l4.252"></a><span id="l4.252" class="difflineplus">+    Eric Haszlakiewicz</span>
<a href="#l4.253"></a><span id="l4.253" class="difflineplus">+  * Add a json_type_to_name() function.</span>
<a href="#l4.254"></a><span id="l4.254" class="difflineplus">+    Eric Haszlakiewicz</span>
<a href="#l4.255"></a><span id="l4.255" class="difflineplus">+  * Add a json_tokener_parse_verbose() function.</span>
<a href="#l4.256"></a><span id="l4.256" class="difflineplus">+    Jehiah Czebotar</span>
<a href="#l4.257"></a><span id="l4.257" class="difflineplus">+  * Improve support for null bytes within JSON strings.</span>
<a href="#l4.258"></a><span id="l4.258" class="difflineplus">+    Jehiah Czebotar</span>
<a href="#l4.259"></a><span id="l4.259" class="difflineplus">+  * Fix file descriptor leak if memory allocation fails in json_util</span>
<a href="#l4.260"></a><span id="l4.260" class="difflineplus">+    Zachary Blair, zack_blair at hotmail dot com</span>
<a href="#l4.261"></a><span id="l4.261" class="difflineplus">+  * Add int64 support. Two new functions json_object_net_int64 and</span>
<a href="#l4.262"></a><span id="l4.262" class="difflineplus">+    json_object_get_int64. Binary compatibility preserved.</span>
<a href="#l4.263"></a><span id="l4.263" class="difflineplus">+    Eric Haszlakiewicz, EHASZLA at transunion com</span>
<a href="#l4.264"></a><span id="l4.264" class="difflineplus">+    Rui Miguel Silva Seabra, rms at 1407 dot org</span>
<a href="#l4.265"></a><span id="l4.265" class="difflineplus">+  * Fix subtle bug in linkhash where lookup could hang after all slots</span>
<a href="#l4.266"></a><span id="l4.266" class="difflineplus">+    were filled then successively freed.</span>
<a href="#l4.267"></a><span id="l4.267" class="difflineplus">+    Spotted by Jean-Marc Naud, j dash m at newtraxtech dot com</span>
<a href="#l4.268"></a><span id="l4.268" class="difflineplus">+  * Make json_object_from_file take const char *filename</span>
<a href="#l4.269"></a><span id="l4.269" class="difflineplus">+    Spotted by Vikram Raj V, vsagar at attinteractive dot com</span>
<a href="#l4.270"></a><span id="l4.270" class="difflineplus">+  * Add handling of surrogate pairs (json_tokener.c, test4.c, Makefile.am)</span>
<a href="#l4.271"></a><span id="l4.271" class="difflineplus">+    Brent Miller, bdmiller at yahoo dash inc dot com</span>
<a href="#l4.272"></a><span id="l4.272" class="difflineplus">+  * Correction to comment describing printbuf_memappend in printbuf.h</span>
<a href="#l4.273"></a><span id="l4.273" class="difflineplus">+    Brent Miller, bdmiller at yahoo dash inc dot com</span>
<a href="#l4.274"></a><span id="l4.274" class="difflineplus">+</span>
<a href="#l4.275"></a><span id="l4.275" class="difflineplus">+0.9</span>
<a href="#l4.276"></a><span id="l4.276" class="difflineplus">+===</span>
<a href="#l4.277"></a><span id="l4.277" class="difflineplus">+  * Add README.html README-WIN32.html config.h.win32 to Makefile.am</span>
<a href="#l4.278"></a><span id="l4.278" class="difflineplus">+    Michael Clark, &lt;michael@metaparadigm.com&gt;</span>
<a href="#l4.279"></a><span id="l4.279" class="difflineplus">+  * Add const qualifier to the json_tokener_parse functions</span>
<a href="#l4.280"></a><span id="l4.280" class="difflineplus">+    Eric Haszlakiewicz, EHASZLA at transunion dot com</span>
<a href="#l4.281"></a><span id="l4.281" class="difflineplus">+  * Rename min and max so we can never clash with C or C++ std library</span>
<a href="#l4.282"></a><span id="l4.282" class="difflineplus">+    Ian Atha, thatha at yahoo dash inc dot com</span>
<a href="#l4.283"></a><span id="l4.283" class="difflineplus">+  * Fix any noticeable spelling or grammar errors.</span>
<a href="#l4.284"></a><span id="l4.284" class="difflineplus">+  * Make sure every va_start has a va_end.</span>
<a href="#l4.285"></a><span id="l4.285" class="difflineplus">+  * Check all pointers for validity.</span>
<a href="#l4.286"></a><span id="l4.286" class="difflineplus">+    Erik Hovland, erik at hovland dot org</span>
<a href="#l4.287"></a><span id="l4.287" class="difflineplus">+  * Fix json_object_get_boolean to return false for empty string</span>
<a href="#l4.288"></a><span id="l4.288" class="difflineplus">+    Spotted by Vitaly Kruglikov, Vitaly dot Kruglikov at palm dot com</span>
<a href="#l4.289"></a><span id="l4.289" class="difflineplus">+  * optimizations to json_tokener_parse_ex(), printbuf_memappend()</span>
<a href="#l4.290"></a><span id="l4.290" class="difflineplus">+    Brent Miller, bdmiller at yahoo dash inc dot com</span>
<a href="#l4.291"></a><span id="l4.291" class="difflineplus">+  * Disable REFCOUNT_DEBUG by default in json_object.c</span>
<a href="#l4.292"></a><span id="l4.292" class="difflineplus">+  * Don't use this as a variable, so we can compile with a C++ compiler</span>
<a href="#l4.293"></a><span id="l4.293" class="difflineplus">+  * Add casts from void* to type of assignment when using malloc </span>
<a href="#l4.294"></a><span id="l4.294" class="difflineplus">+  * Add #ifdef __cplusplus guards to all of the headers</span>
<a href="#l4.295"></a><span id="l4.295" class="difflineplus">+  * Add typedefs for json_object, json_tokener, array_list, printbuf, lh_table</span>
<a href="#l4.296"></a><span id="l4.296" class="difflineplus">+    Michael Clark, &lt;michael@metaparadigm.com&gt;</span>
<a href="#l4.297"></a><span id="l4.297" class="difflineplus">+  * Null pointer dereference fix. Fix json_object_get_boolean strlen test</span>
<a href="#l4.298"></a><span id="l4.298" class="difflineplus">+    to not return TRUE for zero length string. Remove redundant includes.</span>
<a href="#l4.299"></a><span id="l4.299" class="difflineplus">+    Erik Hovland, erik at hovland dot org</span>
<a href="#l4.300"></a><span id="l4.300" class="difflineplus">+  * Fixed warning reported by adding -Wstrict-prototypes</span>
<a href="#l4.301"></a><span id="l4.301" class="difflineplus">+    -Wold-style-definition to the compilatin flags.</span>
<a href="#l4.302"></a><span id="l4.302" class="difflineplus">+    Dotan Barak, dotanba at gmail dot com</span>
<a href="#l4.303"></a><span id="l4.303" class="difflineplus">+  * Add const correctness to public interfaces</span>
<a href="#l4.304"></a><span id="l4.304" class="difflineplus">+    Gerard Krol, g dot c dot krol at student dot tudelft dot nl</span>
<a href="#l4.305"></a><span id="l4.305" class="difflineplus">+</span>
<a href="#l4.306"></a><span id="l4.306" class="difflineplus">+0.8</span>
<a href="#l4.307"></a><span id="l4.307" class="difflineplus">+===</span>
<a href="#l4.308"></a><span id="l4.308" class="difflineplus">+  * Add va_end for every va_start</span>
<a href="#l4.309"></a><span id="l4.309" class="difflineplus">+    Dotan Barak, dotanba at gmail dot com</span>
<a href="#l4.310"></a><span id="l4.310" class="difflineplus">+  * Add macros to enable compiling out debug code</span>
<a href="#l4.311"></a><span id="l4.311" class="difflineplus">+    Geoffrey Young, geoff at modperlcookbook dot org</span>
<a href="#l4.312"></a><span id="l4.312" class="difflineplus">+  * Fix bug with use of capital E in numbers with exponents</span>
<a href="#l4.313"></a><span id="l4.313" class="difflineplus">+    Mateusz Loskot, mateusz at loskot dot net</span>
<a href="#l4.314"></a><span id="l4.314" class="difflineplus">+  * Add stddef.h include</span>
<a href="#l4.315"></a><span id="l4.315" class="difflineplus">+  * Patch allows for json-c compile with -Werror and not fail due to</span>
<a href="#l4.316"></a><span id="l4.316" class="difflineplus">+    -Wmissing-prototypes -Wstrict-prototypes -Wmissing-declarations</span>
<a href="#l4.317"></a><span id="l4.317" class="difflineplus">+    Geoffrey Young, geoff at modperlcookbook dot org</span>
<a href="#l4.318"></a><span id="l4.318" class="difflineplus">+</span>
<a href="#l4.319"></a><span id="l4.319" class="difflineplus">+0.7</span>
<a href="#l4.320"></a><span id="l4.320" class="difflineplus">+===</span>
<a href="#l4.321"></a><span id="l4.321" class="difflineplus">+  * Add escaping of backslash to json output</span>
<a href="#l4.322"></a><span id="l4.322" class="difflineplus">+  * Add escaping of foward slash on tokenizing and output</span>
<a href="#l4.323"></a><span id="l4.323" class="difflineplus">+  * Changes to internal tokenizer from using recursion to</span>
<a href="#l4.324"></a><span id="l4.324" class="difflineplus">+    using a depth state structure to allow incremental parsing</span>
<a href="#l4.325"></a><span id="l4.325" class="difflineplus">+</span>
<a href="#l4.326"></a><span id="l4.326" class="difflineplus">+0.6</span>
<a href="#l4.327"></a><span id="l4.327" class="difflineplus">+===</span>
<a href="#l4.328"></a><span id="l4.328" class="difflineplus">+  * Fix bug in escaping of control characters</span>
<a href="#l4.329"></a><span id="l4.329" class="difflineplus">+    Johan Bjrklund, johbjo09 at kth dot se</span>
<a href="#l4.330"></a><span id="l4.330" class="difflineplus">+  * Remove include &quot;config.h&quot; from headers (should only</span>
<a href="#l4.331"></a><span id="l4.331" class="difflineplus">+    be included from .c files)</span>
<a href="#l4.332"></a><span id="l4.332" class="difflineplus">+    Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l4.333"></a><span id="l4.333" class="difflineplus">+</span>
<a href="#l4.334"></a><span id="l4.334" class="difflineplus">+0.5</span>
<a href="#l4.335"></a><span id="l4.335" class="difflineplus">+===</span>
<a href="#l4.336"></a><span id="l4.336" class="difflineplus">+  * Make headers C++ compatible by change *this to *obj</span>
<a href="#l4.337"></a><span id="l4.337" class="difflineplus">+  * Add ifdef C++ extern &quot;C&quot; to headers</span>
<a href="#l4.338"></a><span id="l4.338" class="difflineplus">+  * Use simpler definition of min and max in bits.h</span>
<a href="#l4.339"></a><span id="l4.339" class="difflineplus">+    Larry Lansing, llansing at fuzzynerd dot com</span>
<a href="#l4.340"></a><span id="l4.340" class="difflineplus">+</span>
<a href="#l4.341"></a><span id="l4.341" class="difflineplus">+  * Remove automake 1.6 requirement</span>
<a href="#l4.342"></a><span id="l4.342" class="difflineplus">+  * Move autogen commands into autogen.sh. Update README</span>
<a href="#l4.343"></a><span id="l4.343" class="difflineplus">+  * Remove error pointer special case for Windows</span>
<a href="#l4.344"></a><span id="l4.344" class="difflineplus">+  * Change license from LGPL to MIT</span>
<a href="#l4.345"></a><span id="l4.345" class="difflineplus">+    Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l4.346"></a><span id="l4.346" class="difflineplus">+</span>
<a href="#l4.347"></a><span id="l4.347" class="difflineplus">+0.4</span>
<a href="#l4.348"></a><span id="l4.348" class="difflineplus">+===</span>
<a href="#l4.349"></a><span id="l4.349" class="difflineplus">+  * Fix additional error case in object parsing</span>
<a href="#l4.350"></a><span id="l4.350" class="difflineplus">+  * Add back sign reversal in nested object parse as error pointer</span>
<a href="#l4.351"></a><span id="l4.351" class="difflineplus">+    value is negative, while error value is positive.</span>
<a href="#l4.352"></a><span id="l4.352" class="difflineplus">+    Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l4.353"></a><span id="l4.353" class="difflineplus">+</span>
<a href="#l4.354"></a><span id="l4.354" class="difflineplus">+0.3</span>
<a href="#l4.355"></a><span id="l4.355" class="difflineplus">+===</span>
<a href="#l4.356"></a><span id="l4.356" class="difflineplus">+  * fix pointer arithmetic bug for error pointer check in is_error() macro</span>
<a href="#l4.357"></a><span id="l4.357" class="difflineplus">+  * fix type passed to printbuf_memappend in json_tokener</span>
<a href="#l4.358"></a><span id="l4.358" class="difflineplus">+  * update autotools bootstrap instructions in README</span>
<a href="#l4.359"></a><span id="l4.359" class="difflineplus">+    Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l4.360"></a><span id="l4.360" class="difflineplus">+</span>
<a href="#l4.361"></a><span id="l4.361" class="difflineplus">+0.2</span>
<a href="#l4.362"></a><span id="l4.362" class="difflineplus">+===</span>
<a href="#l4.363"></a><span id="l4.363" class="difflineplus">+  * printbuf.c - C. Watford (christopher.watford@gmail.com)</span>
<a href="#l4.364"></a><span id="l4.364" class="difflineplus">+    Added a Win32/Win64 compliant implementation of vasprintf</span>
<a href="#l4.365"></a><span id="l4.365" class="difflineplus">+  * debug.c - C. Watford (christopher.watford@gmail.com)</span>
<a href="#l4.366"></a><span id="l4.366" class="difflineplus">+    Removed usage of vsyslog on Win32/Win64 systems, needs to be handled</span>
<a href="#l4.367"></a><span id="l4.367" class="difflineplus">+    by a configure script</span>
<a href="#l4.368"></a><span id="l4.368" class="difflineplus">+  * json_object.c - C. Watford (christopher.watford@gmail.com)</span>
<a href="#l4.369"></a><span id="l4.369" class="difflineplus">+    Added scope operator to wrap usage of json_object_object_foreach, this</span>
<a href="#l4.370"></a><span id="l4.370" class="difflineplus">+    needs to be rethought to be more ANSI C friendly</span>
<a href="#l4.371"></a><span id="l4.371" class="difflineplus">+  * json_object.h - C. Watford (christopher.watford@gmail.com)</span>
<a href="#l4.372"></a><span id="l4.372" class="difflineplus">+    Added Microsoft C friendly version of json_object_object_foreach</span>
<a href="#l4.373"></a><span id="l4.373" class="difflineplus">+  * json_tokener.c - C. Watford (christopher.watford@gmail.com)</span>
<a href="#l4.374"></a><span id="l4.374" class="difflineplus">+    Added a Win32/Win64 compliant implementation of strndup</span>
<a href="#l4.375"></a><span id="l4.375" class="difflineplus">+  * json_util.c - C. Watford (christopher.watford@gmail.com)</span>
<a href="#l4.376"></a><span id="l4.376" class="difflineplus">+    Added cast and mask to suffice size_t v. unsigned int conversion</span>
<a href="#l4.377"></a><span id="l4.377" class="difflineplus">+    correctness </span>
<a href="#l4.378"></a><span id="l4.378" class="difflineplus">+  * json_tokener.c - sign reversal issue on error info for nested object parse</span>
<a href="#l4.379"></a><span id="l4.379" class="difflineplus">+    spotted by Johan Bjrklund (johbjo09 at kth.se)</span>
<a href="#l4.380"></a><span id="l4.380" class="difflineplus">+  * json_object.c - escape &quot; in json_escape_str</span>
<a href="#l4.381"></a><span id="l4.381" class="difflineplus">+  * Change to automake and libtool to build shared and static library</span>
<a href="#l4.382"></a><span id="l4.382" class="difflineplus">+    Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l4.383"></a><span id="l4.383" class="difflineplus">+	</span>
<a href="#l4.384"></a><span id="l4.384" class="difflineplus">+0.1</span>
<a href="#l4.385"></a><span id="l4.385" class="difflineplus">+===</span>
<a href="#l4.386"></a><span id="l4.386" class="difflineplus">+  * initial release</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1">new file mode 100644</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineminus">--- /dev/null</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineplus">+++ b/third_party/json-c/INSTALL</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineat">@@ -0,0 +1,3 @@</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineplus">+</span>
<a href="#l5.6"></a><span id="l5.6" class="difflineplus">+See README.md for installation instructions.</span>
<a href="#l5.7"></a><span id="l5.7" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">new file mode 100644</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineminus">--- /dev/null</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineplus">+++ b/third_party/json-c/NEWS</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineat">@@ -0,0 +1,1 @@</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineplus">+See the git repo.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">new file mode 100644</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineminus">--- /dev/null</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineplus">+++ b/third_party/json-c/README.html</span>
<a href="#l7.4"></a><span id="l7.4" class="difflineat">@@ -0,0 +1,42 @@</span>
<a href="#l7.5"></a><span id="l7.5" class="difflineplus">+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</span>
<a href="#l7.6"></a><span id="l7.6" class="difflineplus">+&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot; lang=&quot;en&quot;&gt;</span>
<a href="#l7.7"></a><span id="l7.7" class="difflineplus">+	&lt;head&gt;</span>
<a href="#l7.8"></a><span id="l7.8" class="difflineplus">+		&lt;title&gt;JSON-C - A JSON implementation in C&lt;/title&gt;</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineplus">+		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot;&gt;</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineplus">+	&lt;/head&gt;</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineplus">+	&lt;body&gt;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+		&lt;h2&gt;JSON-C - A JSON implementation in C&lt;/h2&gt;</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+		&lt;h3&gt;Overview&lt;/h3&gt;</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+		&lt;p&gt;JSON-C implements a reference counting object model that allows you to easily </span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+		construct JSON objects in C, output them as JSON formatted strings and parse </span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+		JSON formatted strings back into the C representation of JSON objects.</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+		It aims to conform to &lt;a href=&quot;https://tools.ietf.org/html/rfc7159&quot;&gt;RFC 7159&lt;/a&gt;.</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+		&lt;/p&gt;</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+		&lt;h3&gt;Building&lt;/h3&gt;</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+		&lt;p&gt;To setup JSON-C to build on your system please run &lt;tt&gt;configure&lt;/tt&gt; and &lt;tt&gt;make&lt;/tt&gt;.&lt;/p&gt;</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineplus">+		&lt;p&gt;If you are on Win32 cmake is required, generally:&lt;/p&gt;</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineplus">+		&lt;ul&gt;</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+		&lt;li&gt;mkdir build&lt;/li&gt;</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineplus">+		&lt;li&gt;cd build&lt;/li&gt;</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+		&lt;li&gt;cmake ..&lt;/li&gt;</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineplus">+		&lt;li&gt;msbuild &quot;json-c.vcxproj&quot; /m /verbosity:normal /p:OutDir=lib\&lt;/li&gt;</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineplus">+		&lt;li&gt;Or, open the project in Visual Studio&lt;/li&gt;</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineplus">+		&lt;/ul&gt;</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineplus">+</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+		&lt;h3&gt;Documentation&lt;/h3&gt;</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineplus">+		&lt;P&gt;Doxygen generated documentation exists &lt;a href=&quot;doc/html/json__object_8h.html&quot;&gt;here&lt;/a&gt;</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+		and Win32 specific notes can be found &lt;a href=&quot;README-WIN32.html&quot;&gt;here&lt;/a&gt;.&lt;/P&gt;</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineplus">+</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+		&lt;h3&gt;&lt;a href=&quot;https://github.com/json-c/json-c&quot;&gt;GIT Reposository&lt;/a&gt;&lt;/h3&gt;</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineplus">+		&lt;p&gt;&lt;strong&gt;&lt;code&gt;git clone https://github.com/json-c/json-c.git&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineplus">+</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineplus">+		&lt;h3&gt;&lt;a href=&quot;http://groups.google.com/group/json-c&quot;&gt;Mailing List&lt;/a&gt;&lt;/h3&gt;</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineplus">+                &lt;pi&gt;Send email to &lt;strong&gt;&lt;code&gt;json-c &lt;i&gt;&amp;lt;at&amp;gt;&lt;/i&gt; googlegroups &lt;i&gt;&amp;lt;dot&amp;gt;&lt;/i&gt; com&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineplus">+</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+		&lt;h3&gt;&lt;a href=&quot;COPYING&quot;&gt;License&lt;/a&gt;&lt;/h3&gt;</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineplus">+		&lt;p&gt;This program is free software; you can redistribute it and/or modify it under the terms of the MIT License.&lt;/p&gt;</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineplus">+		&lt;hr/&gt;</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineplus">+	&lt;/body&gt;</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineplus">+&lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1">new file mode 100644</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineminus">--- /dev/null</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineplus">+++ b/third_party/json-c/README.md</span>
<a href="#l8.4"></a><span id="l8.4" class="difflineat">@@ -0,0 +1,173 @@</span>
<a href="#l8.5"></a><span id="l8.5" class="difflineplus">+`json-c`                       {#mainpage}</span>
<a href="#l8.6"></a><span id="l8.6" class="difflineplus">+========</span>
<a href="#l8.7"></a><span id="l8.7" class="difflineplus">+</span>
<a href="#l8.8"></a><span id="l8.8" class="difflineplus">+1. [Overview and Build Status](#overview)</span>
<a href="#l8.9"></a><span id="l8.9" class="difflineplus">+2. [Building on Unix](#buildunix)</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineplus">+3. [Install Prerequisites](#installprereq)</span>
<a href="#l8.11"></a><span id="l8.11" class="difflineplus">+4. [Building with partial threading support](#buildthreaded)</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+5. [Linking to libjson-c](#linking)</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+6. [Using json-c](#using)</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+JSON-C - A JSON implementation in C &lt;a name=&quot;overview&quot;&gt;&lt;/a&gt;</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+-----------------------------------</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+Build Status</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+* [AppVeyor Build](https://ci.appveyor.com/project/hawicz/json-c) ![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/json-c/json-c?branch=master&amp;svg=true)</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+* [Travis Build](https://travis-ci.org/json-c/json-c) ![Travis Build Status](https://travis-ci.org/json-c/json-c.svg?branch=master)</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineplus">+</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+JSON-C implements a reference counting object model that allows you to easily </span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+construct JSON objects in C, output them as JSON formatted strings and parse </span>
<a href="#l8.24"></a><span id="l8.24" class="difflineplus">+JSON formatted strings back into the C representation of JSON objects.</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineplus">+It aims to conform to [RFC 7159](https://tools.ietf.org/html/rfc7159).</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineplus">+</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineplus">+</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineplus">+Building on Unix with `git`, `gcc` and `autotools` &lt;a name=&quot;buildunix&quot;&gt;&lt;/a&gt;</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineplus">+--------------------------------------------------</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineplus">+</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineplus">+Home page for json-c: https://github.com/json-c/json-c/wiki</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineplus">+</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineplus">+### Prerequisites:</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineplus">+</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineplus">+See also the &quot;Installing prerequisites&quot; section below.</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineplus">+</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineplus">+ - `gcc`, `clang`, or another C compiler</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+ - `libtool&gt;=2.2.6b`</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineplus">+</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+If you're not using a release tarball, you'll also need:</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineplus">+</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineplus">+ - `autoconf&gt;=2.64` (`autoreconf`)</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineplus">+ - `automake&gt;=1.13`</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineplus">+</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineplus">+Make sure you have a complete `libtool` install, including `libtoolize`.</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineplus">+</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineplus">+To generate docs (e.g. as part of make distcheck) you'll also need:</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineplus">+ - `doxygen&gt;=1.8.13`</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineplus">+</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineplus">+### Build instructions:</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineplus">+`json-c` GitHub repo: https://github.com/json-c/json-c</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineplus">+</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineplus">+```sh</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineplus">+$ git clone https://github.com/json-c/json-c.git</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineplus">+$ cd json-c</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineplus">+$ sh autogen.sh</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineplus">+```</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineplus">+</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineplus">+followed by</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineplus">+</span>
<a href="#l8.62"></a><span id="l8.62" class="difflineplus">+```sh</span>
<a href="#l8.63"></a><span id="l8.63" class="difflineplus">+$ ./configure  # --enable-threading</span>
<a href="#l8.64"></a><span id="l8.64" class="difflineplus">+$ make</span>
<a href="#l8.65"></a><span id="l8.65" class="difflineplus">+$ make install</span>
<a href="#l8.66"></a><span id="l8.66" class="difflineplus">+```</span>
<a href="#l8.67"></a><span id="l8.67" class="difflineplus">+</span>
<a href="#l8.68"></a><span id="l8.68" class="difflineplus">+To build and run the test programs:</span>
<a href="#l8.69"></a><span id="l8.69" class="difflineplus">+</span>
<a href="#l8.70"></a><span id="l8.70" class="difflineplus">+```sh</span>
<a href="#l8.71"></a><span id="l8.71" class="difflineplus">+$ make check</span>
<a href="#l8.72"></a><span id="l8.72" class="difflineplus">+$ make USE_VALGRIND=0 check   # optionally skip using valgrind</span>
<a href="#l8.73"></a><span id="l8.73" class="difflineplus">+```</span>
<a href="#l8.74"></a><span id="l8.74" class="difflineplus">+</span>
<a href="#l8.75"></a><span id="l8.75" class="difflineplus">+Install prerequisites &lt;a name=&quot;installprereq&quot;&gt;&lt;/a&gt;</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineplus">+-----------------------</span>
<a href="#l8.77"></a><span id="l8.77" class="difflineplus">+</span>
<a href="#l8.78"></a><span id="l8.78" class="difflineplus">+If you are on a relatively modern system, you'll likely be able to install</span>
<a href="#l8.79"></a><span id="l8.79" class="difflineplus">+the prerequisites using your OS's packaging system.  </span>
<a href="#l8.80"></a><span id="l8.80" class="difflineplus">+</span>
<a href="#l8.81"></a><span id="l8.81" class="difflineplus">+### Install using apt (e.g. Ubuntu 16.04.2 LTS)</span>
<a href="#l8.82"></a><span id="l8.82" class="difflineplus">+```sh</span>
<a href="#l8.83"></a><span id="l8.83" class="difflineplus">+sudo apt install git</span>
<a href="#l8.84"></a><span id="l8.84" class="difflineplus">+sudo apt install autoconf automake libtool</span>
<a href="#l8.85"></a><span id="l8.85" class="difflineplus">+sudo apt install valgrind # optional</span>
<a href="#l8.86"></a><span id="l8.86" class="difflineplus">+```</span>
<a href="#l8.87"></a><span id="l8.87" class="difflineplus">+</span>
<a href="#l8.88"></a><span id="l8.88" class="difflineplus">+Then start from the &quot;git clone&quot; command, above.</span>
<a href="#l8.89"></a><span id="l8.89" class="difflineplus">+</span>
<a href="#l8.90"></a><span id="l8.90" class="difflineplus">+### Manually install and build autoconf, automake and libtool</span>
<a href="#l8.91"></a><span id="l8.91" class="difflineplus">+</span>
<a href="#l8.92"></a><span id="l8.92" class="difflineplus">+For older OS's that don't have up-to-date version of the packages will</span>
<a href="#l8.93"></a><span id="l8.93" class="difflineplus">+require a bit more work. For example, CentOS release 5.11, etc...</span>
<a href="#l8.94"></a><span id="l8.94" class="difflineplus">+</span>
<a href="#l8.95"></a><span id="l8.95" class="difflineplus">+```sh</span>
<a href="#l8.96"></a><span id="l8.96" class="difflineplus">+curl -O http://ftp.gnu.org/gnu/autoconf/autoconf-2.69.tar.gz</span>
<a href="#l8.97"></a><span id="l8.97" class="difflineplus">+curl -O http://ftp.gnu.org/gnu/automake/automake-1.15.tar.gz</span>
<a href="#l8.98"></a><span id="l8.98" class="difflineplus">+curl -O http://ftp.gnu.org/gnu/libtool/libtool-2.2.6b.tar.gz</span>
<a href="#l8.99"></a><span id="l8.99" class="difflineplus">+</span>
<a href="#l8.100"></a><span id="l8.100" class="difflineplus">+tar xzf autoconf-2.69.tar.gz</span>
<a href="#l8.101"></a><span id="l8.101" class="difflineplus">+tar xzf automake-1.15.tar.gz</span>
<a href="#l8.102"></a><span id="l8.102" class="difflineplus">+tar xzf libtool-2.2.6b.tar.gz</span>
<a href="#l8.103"></a><span id="l8.103" class="difflineplus">+</span>
<a href="#l8.104"></a><span id="l8.104" class="difflineplus">+export PATH=${HOME}/ac_install/bin:$PATH</span>
<a href="#l8.105"></a><span id="l8.105" class="difflineplus">+</span>
<a href="#l8.106"></a><span id="l8.106" class="difflineplus">+(cd autoconf-2.69 &amp;&amp; \</span>
<a href="#l8.107"></a><span id="l8.107" class="difflineplus">+  ./configure --prefix ${HOME}/ac_install &amp;&amp; \</span>
<a href="#l8.108"></a><span id="l8.108" class="difflineplus">+  make &amp;&amp; \</span>
<a href="#l8.109"></a><span id="l8.109" class="difflineplus">+  make install)</span>
<a href="#l8.110"></a><span id="l8.110" class="difflineplus">+</span>
<a href="#l8.111"></a><span id="l8.111" class="difflineplus">+(cd automake-1.15 &amp;&amp; \</span>
<a href="#l8.112"></a><span id="l8.112" class="difflineplus">+  ./configure --prefix ${HOME}/ac_install &amp;&amp; \</span>
<a href="#l8.113"></a><span id="l8.113" class="difflineplus">+  make &amp;&amp; \</span>
<a href="#l8.114"></a><span id="l8.114" class="difflineplus">+  make install)</span>
<a href="#l8.115"></a><span id="l8.115" class="difflineplus">+</span>
<a href="#l8.116"></a><span id="l8.116" class="difflineplus">+(cd libtool-2.2.6b &amp;&amp; \</span>
<a href="#l8.117"></a><span id="l8.117" class="difflineplus">+  ./configure --prefix ${HOME}/ac_install &amp;&amp; \</span>
<a href="#l8.118"></a><span id="l8.118" class="difflineplus">+  make &amp;&amp; \</span>
<a href="#l8.119"></a><span id="l8.119" class="difflineplus">+  make install)</span>
<a href="#l8.120"></a><span id="l8.120" class="difflineplus">+```</span>
<a href="#l8.121"></a><span id="l8.121" class="difflineplus">+</span>
<a href="#l8.122"></a><span id="l8.122" class="difflineplus">+</span>
<a href="#l8.123"></a><span id="l8.123" class="difflineplus">+Building with partial threading support &lt;a name=&quot;buildthreaded&quot;&gt;&lt;/a&gt;</span>
<a href="#l8.124"></a><span id="l8.124" class="difflineplus">+----------------------------------------</span>
<a href="#l8.125"></a><span id="l8.125" class="difflineplus">+</span>
<a href="#l8.126"></a><span id="l8.126" class="difflineplus">+Although json-c does not support fully multi-threaded access to</span>
<a href="#l8.127"></a><span id="l8.127" class="difflineplus">+object trees, it has some code to help make use in threaded programs</span>
<a href="#l8.128"></a><span id="l8.128" class="difflineplus">+a bit safer.  Currently, this is limited to using atomic operations for</span>
<a href="#l8.129"></a><span id="l8.129" class="difflineplus">+json_object_get() and json_object_put().</span>
<a href="#l8.130"></a><span id="l8.130" class="difflineplus">+</span>
<a href="#l8.131"></a><span id="l8.131" class="difflineplus">+Since this may have a performance impact, of at least 3x slower</span>
<a href="#l8.132"></a><span id="l8.132" class="difflineplus">+according to https://stackoverflow.com/a/11609063, it is disabled by</span>
<a href="#l8.133"></a><span id="l8.133" class="difflineplus">+default.  You may turn it on by adjusting your configure command with:</span>
<a href="#l8.134"></a><span id="l8.134" class="difflineplus">+   --enable-threading</span>
<a href="#l8.135"></a><span id="l8.135" class="difflineplus">+</span>
<a href="#l8.136"></a><span id="l8.136" class="difflineplus">+Separately, the default hash function used for object field keys,</span>
<a href="#l8.137"></a><span id="l8.137" class="difflineplus">+lh_char_hash, uses a compare-and-swap operation to ensure the randomly</span>
<a href="#l8.138"></a><span id="l8.138" class="difflineplus">+seed is only generated once.  Because this is a one-time operation, it</span>
<a href="#l8.139"></a><span id="l8.139" class="difflineplus">+is always compiled in when the compare-and-swap operation is available.</span>
<a href="#l8.140"></a><span id="l8.140" class="difflineplus">+</span>
<a href="#l8.141"></a><span id="l8.141" class="difflineplus">+</span>
<a href="#l8.142"></a><span id="l8.142" class="difflineplus">+Linking to `libjson-c` &lt;a name=&quot;linking&quot;&gt;</span>
<a href="#l8.143"></a><span id="l8.143" class="difflineplus">+----------------------</span>
<a href="#l8.144"></a><span id="l8.144" class="difflineplus">+</span>
<a href="#l8.145"></a><span id="l8.145" class="difflineplus">+If your system has `pkgconfig`,</span>
<a href="#l8.146"></a><span id="l8.146" class="difflineplus">+then you can just add this to your `makefile`:</span>
<a href="#l8.147"></a><span id="l8.147" class="difflineplus">+</span>
<a href="#l8.148"></a><span id="l8.148" class="difflineplus">+```make</span>
<a href="#l8.149"></a><span id="l8.149" class="difflineplus">+CFLAGS += $(shell pkg-config --cflags json-c)</span>
<a href="#l8.150"></a><span id="l8.150" class="difflineplus">+LDFLAGS += $(shell pkg-config --libs json-c)</span>
<a href="#l8.151"></a><span id="l8.151" class="difflineplus">+```</span>
<a href="#l8.152"></a><span id="l8.152" class="difflineplus">+</span>
<a href="#l8.153"></a><span id="l8.153" class="difflineplus">+Without `pkgconfig`, you would do something like this:</span>
<a href="#l8.154"></a><span id="l8.154" class="difflineplus">+</span>
<a href="#l8.155"></a><span id="l8.155" class="difflineplus">+```make</span>
<a href="#l8.156"></a><span id="l8.156" class="difflineplus">+JSON_C_DIR=/path/to/json_c/install</span>
<a href="#l8.157"></a><span id="l8.157" class="difflineplus">+CFLAGS += -I$(JSON_C_DIR)/include/json-c</span>
<a href="#l8.158"></a><span id="l8.158" class="difflineplus">+LDFLAGS+= -L$(JSON_C_DIR)/lib -ljson-c</span>
<a href="#l8.159"></a><span id="l8.159" class="difflineplus">+```</span>
<a href="#l8.160"></a><span id="l8.160" class="difflineplus">+</span>
<a href="#l8.161"></a><span id="l8.161" class="difflineplus">+</span>
<a href="#l8.162"></a><span id="l8.162" class="difflineplus">+Using json-c &lt;a name=&quot;using&quot;&gt;</span>
<a href="#l8.163"></a><span id="l8.163" class="difflineplus">+------------</span>
<a href="#l8.164"></a><span id="l8.164" class="difflineplus">+</span>
<a href="#l8.165"></a><span id="l8.165" class="difflineplus">+To use json-c you can either include json.h, or preferrably, one of the</span>
<a href="#l8.166"></a><span id="l8.166" class="difflineplus">+following more specific header files:</span>
<a href="#l8.167"></a><span id="l8.167" class="difflineplus">+</span>
<a href="#l8.168"></a><span id="l8.168" class="difflineplus">+* json_object.h  - Core types and methods.</span>
<a href="#l8.169"></a><span id="l8.169" class="difflineplus">+* json_tokener.h - Methods for parsing and serializing json-c object trees.</span>
<a href="#l8.170"></a><span id="l8.170" class="difflineplus">+* json_pointer.h - JSON Pointer (RFC 6901) implementation for retrieving</span>
<a href="#l8.171"></a><span id="l8.171" class="difflineplus">+                   objects from a json-c object tree.</span>
<a href="#l8.172"></a><span id="l8.172" class="difflineplus">+* json_object_iterator.h - Methods for iterating over single json_object instances.</span>
<a href="#l8.173"></a><span id="l8.173" class="difflineplus">+* json_visit.h   - Methods for walking a tree of json-c objects.</span>
<a href="#l8.174"></a><span id="l8.174" class="difflineplus">+* json_util.h    - Miscelleanous utility functions.</span>
<a href="#l8.175"></a><span id="l8.175" class="difflineplus">+</span>
<a href="#l8.176"></a><span id="l8.176" class="difflineplus">+For a full list of headers see [files.html](files.html)</span>
<a href="#l8.177"></a><span id="l8.177" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1">new file mode 100644</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineminus">--- /dev/null</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineplus">+++ b/third_party/json-c/RELEASE_CHECKLIST.txt</span>
<a href="#l9.4"></a><span id="l9.4" class="difflineat">@@ -0,0 +1,136 @@</span>
<a href="#l9.5"></a><span id="l9.5" class="difflineplus">+</span>
<a href="#l9.6"></a><span id="l9.6" class="difflineplus">+Release checklist:</span>
<a href="#l9.7"></a><span id="l9.7" class="difflineplus">+</span>
<a href="#l9.8"></a><span id="l9.8" class="difflineplus">+release=0.13</span>
<a href="#l9.9"></a><span id="l9.9" class="difflineplus">+git clone https://github.com/json-c/json-c json-c-${release}</span>
<a href="#l9.10"></a><span id="l9.10" class="difflineplus">+cd json-c-${release}</span>
<a href="#l9.11"></a><span id="l9.11" class="difflineplus">+</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+Check that the compile works on Linux</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+Check that the compile works on NetBSD</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+Check that the compile works on Windows</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+Run &quot;make distcheck&quot; and fix any problems</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+	 (e.g. adding new files to SOURCES variables in Makefile.am)</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+Check ChangeLog to see if anything should be added.</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+Make any fixes/changes *before* branching.</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+  git branch json-c-${release}</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineplus">+  git checkout json-c-${release}</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineplus">+</span>
<a href="#l9.23"></a><span id="l9.23" class="difflineplus">+------------</span>
<a href="#l9.24"></a><span id="l9.24" class="difflineplus">+</span>
<a href="#l9.25"></a><span id="l9.25" class="difflineplus">+Update the version in json_c_version.h</span>
<a href="#l9.26"></a><span id="l9.26" class="difflineplus">+Update the version in Doxyfile</span>
<a href="#l9.27"></a><span id="l9.27" class="difflineplus">+Update the version in configure.ac</span>
<a href="#l9.28"></a><span id="l9.28" class="difflineplus">+Update the version in CMakeLists.txt</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineplus">+	Use ${release}.</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineplus">+</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineplus">+Update the libjson_la_LDFLAGS line in Makefile.am to the new version.</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+	Generally, unless we're doing a major release, change:</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineplus">+		-version-info x:y:z</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineplus">+	to</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineplus">+		-version-info x:y+1:z</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineplus">+------------</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineplus">+</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineplus">+Generate the configure script and other files:</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineplus">+  sh autogen.sh</span>
<a href="#l9.41"></a><span id="l9.41" class="difflineplus">+  git add -f Makefile.in aclocal.m4 config.guess config.h.in \</span>
<a href="#l9.42"></a><span id="l9.42" class="difflineplus">+       config.sub configure depcomp install-sh \</span>
<a href="#l9.43"></a><span id="l9.43" class="difflineplus">+       ltmain.sh missing tests/Makefile.in \</span>
<a href="#l9.44"></a><span id="l9.44" class="difflineplus">+       INSTALL</span>
<a href="#l9.45"></a><span id="l9.45" class="difflineplus">+</span>
<a href="#l9.46"></a><span id="l9.46" class="difflineplus">+  # check for anything else to be added:</span>
<a href="#l9.47"></a><span id="l9.47" class="difflineplus">+  git status --ignored</span>
<a href="#l9.48"></a><span id="l9.48" class="difflineplus">+  git commit</span>
<a href="#l9.49"></a><span id="l9.49" class="difflineplus">+</span>
<a href="#l9.50"></a><span id="l9.50" class="difflineplus">+------------</span>
<a href="#l9.51"></a><span id="l9.51" class="difflineplus">+</span>
<a href="#l9.52"></a><span id="l9.52" class="difflineplus">+Generate the doxygen documentation:</span>
<a href="#l9.53"></a><span id="l9.53" class="difflineplus">+  doxygen</span>
<a href="#l9.54"></a><span id="l9.54" class="difflineplus">+  git add -f doc</span>
<a href="#l9.55"></a><span id="l9.55" class="difflineplus">+  git commit doc</span>
<a href="#l9.56"></a><span id="l9.56" class="difflineplus">+</span>
<a href="#l9.57"></a><span id="l9.57" class="difflineplus">+------------</span>
<a href="#l9.58"></a><span id="l9.58" class="difflineplus">+</span>
<a href="#l9.59"></a><span id="l9.59" class="difflineplus">+cd ..</span>
<a href="#l9.60"></a><span id="l9.60" class="difflineplus">+echo .git &gt; excludes</span>
<a href="#l9.61"></a><span id="l9.61" class="difflineplus">+echo autom4te.cache &gt;&gt; excludes</span>
<a href="#l9.62"></a><span id="l9.62" class="difflineplus">+tar -czf json-c-${release}.tar.gz -X excludes json-c-${release}</span>
<a href="#l9.63"></a><span id="l9.63" class="difflineplus">+</span>
<a href="#l9.64"></a><span id="l9.64" class="difflineplus">+echo doc &gt;&gt; excludes</span>
<a href="#l9.65"></a><span id="l9.65" class="difflineplus">+tar -czf json-c-${release}-nodoc.tar.gz -X excludes json-c-${release}</span>
<a href="#l9.66"></a><span id="l9.66" class="difflineplus">+</span>
<a href="#l9.67"></a><span id="l9.67" class="difflineplus">+------------</span>
<a href="#l9.68"></a><span id="l9.68" class="difflineplus">+</span>
<a href="#l9.69"></a><span id="l9.69" class="difflineplus">+Tag the branch:</span>
<a href="#l9.70"></a><span id="l9.70" class="difflineplus">+cd json-c-${release}</span>
<a href="#l9.71"></a><span id="l9.71" class="difflineplus">+git tag -a json-c-${release}-$(date +%Y%m%d) -m &quot;Release json-c-${release}&quot;</span>
<a href="#l9.72"></a><span id="l9.72" class="difflineplus">+</span>
<a href="#l9.73"></a><span id="l9.73" class="difflineplus">+git push origin json-c-${release}</span>
<a href="#l9.74"></a><span id="l9.74" class="difflineplus">+git push --tags</span>
<a href="#l9.75"></a><span id="l9.75" class="difflineplus">+</span>
<a href="#l9.76"></a><span id="l9.76" class="difflineplus">+------------</span>
<a href="#l9.77"></a><span id="l9.77" class="difflineplus">+</span>
<a href="#l9.78"></a><span id="l9.78" class="difflineplus">+Go to Amazon S3 service at:</span>
<a href="#l9.79"></a><span id="l9.79" class="difflineplus">+    https://console.aws.amazon.com/s3/</span>
<a href="#l9.80"></a><span id="l9.80" class="difflineplus">+</span>
<a href="#l9.81"></a><span id="l9.81" class="difflineplus">+Upload the two tarballs in the json-c_releases folder.</span>
<a href="#l9.82"></a><span id="l9.82" class="difflineplus">+	When uploading, use &quot;Reduced Redundancy&quot;, and make the uploaded files publicly accessible.</span>
<a href="#l9.83"></a><span id="l9.83" class="difflineplus">+</span>
<a href="#l9.84"></a><span id="l9.84" class="difflineplus">+Logout of Amazon S3, and verify that the files are visible.</span>
<a href="#l9.85"></a><span id="l9.85" class="difflineplus">+    https://s3.amazonaws.com/json-c_releases/releases/index.html</span>
<a href="#l9.86"></a><span id="l9.86" class="difflineplus">+</span>
<a href="#l9.87"></a><span id="l9.87" class="difflineplus">+===================================</span>
<a href="#l9.88"></a><span id="l9.88" class="difflineplus">+</span>
<a href="#l9.89"></a><span id="l9.89" class="difflineplus">+Post-release checklist:</span>
<a href="#l9.90"></a><span id="l9.90" class="difflineplus">+</span>
<a href="#l9.91"></a><span id="l9.91" class="difflineplus">+git checkout master</span>
<a href="#l9.92"></a><span id="l9.92" class="difflineplus">+Add new section to ChangeLog</span>
<a href="#l9.93"></a><span id="l9.93" class="difflineplus">+Update the version in json_c_version.h</span>
<a href="#l9.94"></a><span id="l9.94" class="difflineplus">+Update the version in Doxyfile</span>
<a href="#l9.95"></a><span id="l9.95" class="difflineplus">+Update the version in configure.ac</span>
<a href="#l9.96"></a><span id="l9.96" class="difflineplus">+Update the version in CMakeLists.txt</span>
<a href="#l9.97"></a><span id="l9.97" class="difflineplus">+    Use ${release}.99 to indicate a version &quot;newer&quot; than anything on the branch.</span>
<a href="#l9.98"></a><span id="l9.98" class="difflineplus">+</span>
<a href="#l9.99"></a><span id="l9.99" class="difflineplus">+Leave the libjson_la_LDFLAGS line in Makefile.am alone.</span>
<a href="#l9.100"></a><span id="l9.100" class="difflineplus">+	For more details see:</span>
<a href="#l9.101"></a><span id="l9.101" class="difflineplus">+	http://www.gnu.org/software/libtool/manual/html_node/Updating-version-info.html</span>
<a href="#l9.102"></a><span id="l9.102" class="difflineplus">+</span>
<a href="#l9.103"></a><span id="l9.103" class="difflineplus">+------------</span>
<a href="#l9.104"></a><span id="l9.104" class="difflineplus">+</span>
<a href="#l9.105"></a><span id="l9.105" class="difflineplus">+Update the gh-pages branch with new docs:</span>
<a href="#l9.106"></a><span id="l9.106" class="difflineplus">+</span>
<a href="#l9.107"></a><span id="l9.107" class="difflineplus">+cd json-c-${release}</span>
<a href="#l9.108"></a><span id="l9.108" class="difflineplus">+git checkout json-c-${release}</span>
<a href="#l9.109"></a><span id="l9.109" class="difflineplus">+cd ..</span>
<a href="#l9.110"></a><span id="l9.110" class="difflineplus">+</span>
<a href="#l9.111"></a><span id="l9.111" class="difflineplus">+git clone -b gh-pages https://github.com/json-c/json-c json-c-pages</span>
<a href="#l9.112"></a><span id="l9.112" class="difflineplus">+cd json-c-pages</span>
<a href="#l9.113"></a><span id="l9.113" class="difflineplus">+mkdir json-c-${release}</span>
<a href="#l9.114"></a><span id="l9.114" class="difflineplus">+cp -R ../json-c-${release}/doc json-c-${release}/.</span>
<a href="#l9.115"></a><span id="l9.115" class="difflineplus">+cp ../json-c-${release}/README-WIN32.html json-c-${release}/.</span>
<a href="#l9.116"></a><span id="l9.116" class="difflineplus">+git add json-c-${release}</span>
<a href="#l9.117"></a><span id="l9.117" class="difflineplus">+git commit</span>
<a href="#l9.118"></a><span id="l9.118" class="difflineplus">+</span>
<a href="#l9.119"></a><span id="l9.119" class="difflineplus">+vi index.html</span>
<a href="#l9.120"></a><span id="l9.120" class="difflineplus">+    Add/change links to current release.</span>
<a href="#l9.121"></a><span id="l9.121" class="difflineplus">+</span>
<a href="#l9.122"></a><span id="l9.122" class="difflineplus">+git commit index.html</span>
<a href="#l9.123"></a><span id="l9.123" class="difflineplus">+</span>
<a href="#l9.124"></a><span id="l9.124" class="difflineplus">+git push</span>
<a href="#l9.125"></a><span id="l9.125" class="difflineplus">+</span>
<a href="#l9.126"></a><span id="l9.126" class="difflineplus">+------------</span>
<a href="#l9.127"></a><span id="l9.127" class="difflineplus">+</span>
<a href="#l9.128"></a><span id="l9.128" class="difflineplus">+Update checksums on wiki page.</span>
<a href="#l9.129"></a><span id="l9.129" class="difflineplus">+</span>
<a href="#l9.130"></a><span id="l9.130" class="difflineplus">+cd ..</span>
<a href="#l9.131"></a><span id="l9.131" class="difflineplus">+openssl sha -sha256 json-c*gz</span>
<a href="#l9.132"></a><span id="l9.132" class="difflineplus">+openssl md5 json-c*gz</span>
<a href="#l9.133"></a><span id="l9.133" class="difflineplus">+</span>
<a href="#l9.134"></a><span id="l9.134" class="difflineplus">+Copy and paste this output into the wiki page at:</span>
<a href="#l9.135"></a><span id="l9.135" class="difflineplus">+	https://github.com/json-c/json-c/wiki</span>
<a href="#l9.136"></a><span id="l9.136" class="difflineplus">+</span>
<a href="#l9.137"></a><span id="l9.137" class="difflineplus">+------------</span>
<a href="#l9.138"></a><span id="l9.138" class="difflineplus">+</span>
<a href="#l9.139"></a><span id="l9.139" class="difflineplus">+Send an email to the mailing list.</span>
<a href="#l9.140"></a><span id="l9.140" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">new file mode 100755</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineminus">--- /dev/null</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineplus">+++ b/third_party/json-c/STYLE.txt</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineat">@@ -0,0 +1,31 @@</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineplus">+In general:</span>
<a href="#l10.6"></a><span id="l10.6" class="difflineplus">+For minor changes to a function, copy the existing formatting.</span>
<a href="#l10.7"></a><span id="l10.7" class="difflineplus">+When changing the style, commit that separately from other changes.</span>
<a href="#l10.8"></a><span id="l10.8" class="difflineplus">+For new code and major changes to a function, switch to the official json-c style.</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineplus">+</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineplus">+Official json-c style:</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineplus">+Aim for readability, not strict conformance to fixed style rules.</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+These rules are not comprehensive.  Look to existing code for guidelines.</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+Indentation is tab based, with continuations of long lines starting with tabs then spaces for alignment.</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+Try to line up components of continuation lines with corresponding part of the line above (i.e. &quot;indent -lp&quot; effect), but avoid excessive identation tha causes extra line wraps. </span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+ e.g. (T=tab, S=space):</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineplus">+TTTTsome_long_func_call(arg1, arg2,</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineplus">+TTTTSSSSSSSSSSSSSSSSSSSarg3, arg4);</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineplus">+TTTTsome_reallly_really_long_func_name(arg1,</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineplus">+TTTTTarg2, arg3, arg4);</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineplus">+There should be a space between &quot;if&quot;/&quot;while&quot; and the following parenthesis.</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineplus">+&quot;case&quot; lines are indented at the same level as the &quot;switch&quot; statement.</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineplus">+Commas are followed by a single space.</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineplus">+Include spaces around most non-unary, non-postfix operators, &quot;=&quot;, &quot;==', &quot;&amp;&quot;, &quot;||&quot;, etc...</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineplus">+Function calls have no space between the name and the parenthesis.</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineplus">+Curly braces go on their own line.</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineplus">+Curly braces may be omitted.</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineplus">+</span>
<a href="#l10.28"></a><span id="l10.28" class="difflineplus">+Naming:</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineplus">+Words within function and variable names are separated with underscores.  Avoid camel case.</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineplus">+Prefer longer, more descriptive names, but not excessively so.  No single letter variable names.</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineplus">+</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+Other:</span>
<a href="#l10.33"></a><span id="l10.33" class="difflineplus">+Variables should be defined for the smallest scope needed.</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineplus">+Functions should be defined static when possible.</span>
<a href="#l10.35"></a><span id="l10.35" class="difflineplus">+When possible, avoid exposing internals in the public API.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">new file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- /dev/null</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ b/third_party/json-c/arraylist.c</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -0,0 +1,146 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineplus">+/*</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineplus">+ * $Id: arraylist.c,v 1.4 2006/01/26 02:16:28 mclark Exp $</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineplus">+ *</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineplus">+ *</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+ *</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+ */</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+#include &lt;limits.h&gt;</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineplus">+</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineplus">+#ifdef STDC_HEADERS</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineplus">+# include &lt;stdlib.h&gt;</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineplus">+# include &lt;string.h&gt;</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineplus">+#endif /* STDC_HEADERS */</span>
<a href="#l11.24"></a><span id="l11.24" class="difflineplus">+</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineplus">+#if defined(HAVE_STRINGS_H) &amp;&amp; !defined(_STRING_H) &amp;&amp; !defined(__USE_BSD)</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineplus">+# include &lt;strings.h&gt;</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineplus">+#endif /* HAVE_STRINGS_H */</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineplus">+#ifndef SIZE_T_MAX</span>
<a href="#l11.30"></a><span id="l11.30" class="difflineplus">+#if SIZEOF_SIZE_T == SIZEOF_INT</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineplus">+#define SIZE_T_MAX UINT_MAX</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+#elif SIZEOF_SIZE_T == SIZEOF_LONG</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineplus">+#define SIZE_T_MAX ULONG_MAX</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineplus">+#elif SIZEOF_SIZE_T == SIZEOF_LONG_LONG</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineplus">+#define SIZE_T_MAX ULLONG_MAX</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineplus">+#else</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineplus">+#error Unable to determine size of size_t</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineplus">+#endif</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineplus">+#endif</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineplus">+</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineplus">+#include &quot;arraylist.h&quot;</span>
<a href="#l11.42"></a><span id="l11.42" class="difflineplus">+</span>
<a href="#l11.43"></a><span id="l11.43" class="difflineplus">+struct array_list*</span>
<a href="#l11.44"></a><span id="l11.44" class="difflineplus">+array_list_new(array_list_free_fn *free_fn)</span>
<a href="#l11.45"></a><span id="l11.45" class="difflineplus">+{</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineplus">+  struct array_list *arr;</span>
<a href="#l11.47"></a><span id="l11.47" class="difflineplus">+</span>
<a href="#l11.48"></a><span id="l11.48" class="difflineplus">+  arr = (struct array_list*)calloc(1, sizeof(struct array_list));</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineplus">+  if(!arr) return NULL;</span>
<a href="#l11.50"></a><span id="l11.50" class="difflineplus">+  arr-&gt;size = ARRAY_LIST_DEFAULT_SIZE;</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineplus">+  arr-&gt;length = 0;</span>
<a href="#l11.52"></a><span id="l11.52" class="difflineplus">+  arr-&gt;free_fn = free_fn;</span>
<a href="#l11.53"></a><span id="l11.53" class="difflineplus">+  if(!(arr-&gt;array = (void**)calloc(sizeof(void*), arr-&gt;size))) {</span>
<a href="#l11.54"></a><span id="l11.54" class="difflineplus">+    free(arr);</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineplus">+    return NULL;</span>
<a href="#l11.56"></a><span id="l11.56" class="difflineplus">+  }</span>
<a href="#l11.57"></a><span id="l11.57" class="difflineplus">+  return arr;</span>
<a href="#l11.58"></a><span id="l11.58" class="difflineplus">+}</span>
<a href="#l11.59"></a><span id="l11.59" class="difflineplus">+</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineplus">+extern void</span>
<a href="#l11.61"></a><span id="l11.61" class="difflineplus">+array_list_free(struct array_list *arr)</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineplus">+{</span>
<a href="#l11.63"></a><span id="l11.63" class="difflineplus">+  size_t i;</span>
<a href="#l11.64"></a><span id="l11.64" class="difflineplus">+  for(i = 0; i &lt; arr-&gt;length; i++)</span>
<a href="#l11.65"></a><span id="l11.65" class="difflineplus">+    if(arr-&gt;array[i]) arr-&gt;free_fn(arr-&gt;array[i]);</span>
<a href="#l11.66"></a><span id="l11.66" class="difflineplus">+  free(arr-&gt;array);</span>
<a href="#l11.67"></a><span id="l11.67" class="difflineplus">+  free(arr);</span>
<a href="#l11.68"></a><span id="l11.68" class="difflineplus">+}</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineplus">+</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineplus">+void*</span>
<a href="#l11.71"></a><span id="l11.71" class="difflineplus">+array_list_get_idx(struct array_list *arr, size_t i)</span>
<a href="#l11.72"></a><span id="l11.72" class="difflineplus">+{</span>
<a href="#l11.73"></a><span id="l11.73" class="difflineplus">+  if(i &gt;= arr-&gt;length) return NULL;</span>
<a href="#l11.74"></a><span id="l11.74" class="difflineplus">+  return arr-&gt;array[i];</span>
<a href="#l11.75"></a><span id="l11.75" class="difflineplus">+}</span>
<a href="#l11.76"></a><span id="l11.76" class="difflineplus">+</span>
<a href="#l11.77"></a><span id="l11.77" class="difflineplus">+static int array_list_expand_internal(struct array_list *arr, size_t max)</span>
<a href="#l11.78"></a><span id="l11.78" class="difflineplus">+{</span>
<a href="#l11.79"></a><span id="l11.79" class="difflineplus">+  void *t;</span>
<a href="#l11.80"></a><span id="l11.80" class="difflineplus">+  size_t new_size;</span>
<a href="#l11.81"></a><span id="l11.81" class="difflineplus">+</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineplus">+  if(max &lt; arr-&gt;size) return 0;</span>
<a href="#l11.83"></a><span id="l11.83" class="difflineplus">+  /* Avoid undefined behaviour on size_t overflow */</span>
<a href="#l11.84"></a><span id="l11.84" class="difflineplus">+  if( arr-&gt;size &gt;= SIZE_T_MAX / 2 )</span>
<a href="#l11.85"></a><span id="l11.85" class="difflineplus">+    new_size = max;</span>
<a href="#l11.86"></a><span id="l11.86" class="difflineplus">+  else</span>
<a href="#l11.87"></a><span id="l11.87" class="difflineplus">+  {</span>
<a href="#l11.88"></a><span id="l11.88" class="difflineplus">+    new_size = arr-&gt;size &lt;&lt; 1;</span>
<a href="#l11.89"></a><span id="l11.89" class="difflineplus">+    if (new_size &lt; max)</span>
<a href="#l11.90"></a><span id="l11.90" class="difflineplus">+      new_size = max;</span>
<a href="#l11.91"></a><span id="l11.91" class="difflineplus">+  }</span>
<a href="#l11.92"></a><span id="l11.92" class="difflineplus">+  if (new_size &gt; (~((size_t)0)) / sizeof(void*)) return -1;</span>
<a href="#l11.93"></a><span id="l11.93" class="difflineplus">+  if (!(t = realloc(arr-&gt;array, new_size*sizeof(void*)))) return -1;</span>
<a href="#l11.94"></a><span id="l11.94" class="difflineplus">+  arr-&gt;array = (void**)t;</span>
<a href="#l11.95"></a><span id="l11.95" class="difflineplus">+  (void)memset(arr-&gt;array + arr-&gt;size, 0, (new_size-arr-&gt;size)*sizeof(void*));</span>
<a href="#l11.96"></a><span id="l11.96" class="difflineplus">+  arr-&gt;size = new_size;</span>
<a href="#l11.97"></a><span id="l11.97" class="difflineplus">+  return 0;</span>
<a href="#l11.98"></a><span id="l11.98" class="difflineplus">+}</span>
<a href="#l11.99"></a><span id="l11.99" class="difflineplus">+</span>
<a href="#l11.100"></a><span id="l11.100" class="difflineplus">+int</span>
<a href="#l11.101"></a><span id="l11.101" class="difflineplus">+array_list_put_idx(struct array_list *arr, size_t idx, void *data)</span>
<a href="#l11.102"></a><span id="l11.102" class="difflineplus">+{</span>
<a href="#l11.103"></a><span id="l11.103" class="difflineplus">+  if (idx &gt; SIZE_T_MAX - 1 ) return -1;</span>
<a href="#l11.104"></a><span id="l11.104" class="difflineplus">+  if(array_list_expand_internal(arr, idx+1)) return -1;</span>
<a href="#l11.105"></a><span id="l11.105" class="difflineplus">+  if(idx &lt; arr-&gt;length &amp;&amp; arr-&gt;array[idx])</span>
<a href="#l11.106"></a><span id="l11.106" class="difflineplus">+    arr-&gt;free_fn(arr-&gt;array[idx]);</span>
<a href="#l11.107"></a><span id="l11.107" class="difflineplus">+  arr-&gt;array[idx] = data;</span>
<a href="#l11.108"></a><span id="l11.108" class="difflineplus">+  if(arr-&gt;length &lt;= idx) arr-&gt;length = idx + 1;</span>
<a href="#l11.109"></a><span id="l11.109" class="difflineplus">+  return 0;</span>
<a href="#l11.110"></a><span id="l11.110" class="difflineplus">+}</span>
<a href="#l11.111"></a><span id="l11.111" class="difflineplus">+</span>
<a href="#l11.112"></a><span id="l11.112" class="difflineplus">+int</span>
<a href="#l11.113"></a><span id="l11.113" class="difflineplus">+array_list_add(struct array_list *arr, void *data)</span>
<a href="#l11.114"></a><span id="l11.114" class="difflineplus">+{</span>
<a href="#l11.115"></a><span id="l11.115" class="difflineplus">+  return array_list_put_idx(arr, arr-&gt;length, data);</span>
<a href="#l11.116"></a><span id="l11.116" class="difflineplus">+}</span>
<a href="#l11.117"></a><span id="l11.117" class="difflineplus">+</span>
<a href="#l11.118"></a><span id="l11.118" class="difflineplus">+void</span>
<a href="#l11.119"></a><span id="l11.119" class="difflineplus">+array_list_sort(struct array_list *arr, int(*sort_fn)(const void *, const void *))</span>
<a href="#l11.120"></a><span id="l11.120" class="difflineplus">+{</span>
<a href="#l11.121"></a><span id="l11.121" class="difflineplus">+  qsort(arr-&gt;array, arr-&gt;length, sizeof(arr-&gt;array[0]), sort_fn);</span>
<a href="#l11.122"></a><span id="l11.122" class="difflineplus">+}</span>
<a href="#l11.123"></a><span id="l11.123" class="difflineplus">+</span>
<a href="#l11.124"></a><span id="l11.124" class="difflineplus">+void* array_list_bsearch(const void **key, struct array_list *arr,</span>
<a href="#l11.125"></a><span id="l11.125" class="difflineplus">+		int (*sort_fn)(const void *, const void *))</span>
<a href="#l11.126"></a><span id="l11.126" class="difflineplus">+{</span>
<a href="#l11.127"></a><span id="l11.127" class="difflineplus">+	return bsearch(key, arr-&gt;array, arr-&gt;length, sizeof(arr-&gt;array[0]),</span>
<a href="#l11.128"></a><span id="l11.128" class="difflineplus">+			sort_fn);</span>
<a href="#l11.129"></a><span id="l11.129" class="difflineplus">+}</span>
<a href="#l11.130"></a><span id="l11.130" class="difflineplus">+</span>
<a href="#l11.131"></a><span id="l11.131" class="difflineplus">+size_t</span>
<a href="#l11.132"></a><span id="l11.132" class="difflineplus">+array_list_length(struct array_list *arr)</span>
<a href="#l11.133"></a><span id="l11.133" class="difflineplus">+{</span>
<a href="#l11.134"></a><span id="l11.134" class="difflineplus">+  return arr-&gt;length;</span>
<a href="#l11.135"></a><span id="l11.135" class="difflineplus">+}</span>
<a href="#l11.136"></a><span id="l11.136" class="difflineplus">+</span>
<a href="#l11.137"></a><span id="l11.137" class="difflineplus">+int</span>
<a href="#l11.138"></a><span id="l11.138" class="difflineplus">+array_list_del_idx( struct array_list *arr, size_t idx, size_t count )</span>
<a href="#l11.139"></a><span id="l11.139" class="difflineplus">+{</span>
<a href="#l11.140"></a><span id="l11.140" class="difflineplus">+	size_t i, stop;</span>
<a href="#l11.141"></a><span id="l11.141" class="difflineplus">+</span>
<a href="#l11.142"></a><span id="l11.142" class="difflineplus">+	stop = idx + count;</span>
<a href="#l11.143"></a><span id="l11.143" class="difflineplus">+	if ( idx &gt;= arr-&gt;length || stop &gt; arr-&gt;length ) return -1;</span>
<a href="#l11.144"></a><span id="l11.144" class="difflineplus">+	for ( i = idx; i &lt; stop; ++i ) {</span>
<a href="#l11.145"></a><span id="l11.145" class="difflineplus">+		if ( arr-&gt;array[i] ) arr-&gt;free_fn( arr-&gt;array[i] );</span>
<a href="#l11.146"></a><span id="l11.146" class="difflineplus">+	}</span>
<a href="#l11.147"></a><span id="l11.147" class="difflineplus">+	memmove( arr-&gt;array + idx, arr-&gt;array + stop, (arr-&gt;length - stop) * sizeof(void*) );</span>
<a href="#l11.148"></a><span id="l11.148" class="difflineplus">+	arr-&gt;length -= count;</span>
<a href="#l11.149"></a><span id="l11.149" class="difflineplus">+	return 0;</span>
<a href="#l11.150"></a><span id="l11.150" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">new file mode 100644</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineminus">--- /dev/null</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineplus">+++ b/third_party/json-c/arraylist.h</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineat">@@ -0,0 +1,70 @@</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineplus">+/*</span>
<a href="#l12.6"></a><span id="l12.6" class="difflineplus">+ * $Id: arraylist.h,v 1.4 2006/01/26 02:16:28 mclark Exp $</span>
<a href="#l12.7"></a><span id="l12.7" class="difflineplus">+ *</span>
<a href="#l12.8"></a><span id="l12.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineplus">+ *</span>
<a href="#l12.11"></a><span id="l12.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+ *</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+ */</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+/**</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+ * @file</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+ * @brief Internal methods for working with json_type_array objects.</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+ *        Although this is exposed by the json_object_get_array() method,</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+ *        it is not recommended for direct use.</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+ */</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+#ifndef _arraylist_h_</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+#define _arraylist_h_</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineplus">+#endif</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineplus">+#define ARRAY_LIST_DEFAULT_SIZE 32</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineplus">+</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+typedef void (array_list_free_fn) (void *data);</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+struct array_list</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+{</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineplus">+  void **array;</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineplus">+  size_t length;</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineplus">+  size_t size;</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineplus">+  array_list_free_fn *free_fn;</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineplus">+};</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineplus">+typedef struct array_list array_list;</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineplus">+</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineplus">+extern struct array_list*</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineplus">+array_list_new(array_list_free_fn *free_fn);</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineplus">+</span>
<a href="#l12.45"></a><span id="l12.45" class="difflineplus">+extern void</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineplus">+array_list_free(struct array_list *al);</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineplus">+</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineplus">+extern void*</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineplus">+array_list_get_idx(struct array_list *al, size_t i);</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineplus">+</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineplus">+extern int</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineplus">+array_list_put_idx(struct array_list *al, size_t i, void *data);</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineplus">+</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+extern int</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineplus">+array_list_add(struct array_list *al, void *data);</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineplus">+</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+extern size_t</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineplus">+array_list_length(struct array_list *al);</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineplus">+</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineplus">+extern void</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineplus">+array_list_sort(struct array_list *arr, int(*compar)(const void *, const void *));</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineplus">+</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineplus">+extern void* array_list_bsearch(const void **key,</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineplus">+		struct array_list *arr,</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineplus">+		int (*sort_fn)(const void *, const void *));</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineplus">+</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineplus">+extern int </span>
<a href="#l12.68"></a><span id="l12.68" class="difflineplus">+array_list_del_idx(struct array_list *arr, size_t idx, size_t count);</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineplus">+</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineplus">+}</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineplus">+#endif</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineplus">+</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1">new file mode 100644</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineminus">--- /dev/null</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineplus">+++ b/third_party/json-c/bits.h</span>
<a href="#l13.4"></a><span id="l13.4" class="difflineat">@@ -0,0 +1,36 @@</span>
<a href="#l13.5"></a><span id="l13.5" class="difflineplus">+/**</span>
<a href="#l13.6"></a><span id="l13.6" class="difflineplus">+ * @file</span>
<a href="#l13.7"></a><span id="l13.7" class="difflineplus">+ * @brief Do not use, only contains deprecated defines.</span>
<a href="#l13.8"></a><span id="l13.8" class="difflineplus">+ * @deprecated Use json_util.h instead.</span>
<a href="#l13.9"></a><span id="l13.9" class="difflineplus">+ *</span>
<a href="#l13.10"></a><span id="l13.10" class="difflineplus">+ * $Id: bits.h,v 1.10 2006/01/30 23:07:57 mclark Exp $</span>
<a href="#l13.11"></a><span id="l13.11" class="difflineplus">+ *</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineplus">+ *</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineplus">+ *</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineplus">+ */</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineplus">+</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineplus">+#ifndef _bits_h_</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineplus">+#define _bits_h_</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineplus">+</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineplus">+/**</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineplus">+ * @deprecated</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineplus">+ */</span>
<a href="#l13.26"></a><span id="l13.26" class="difflineplus">+#define hexdigit(x) (((x) &lt;= '9') ? (x) - '0' : ((x) &amp; 7) + 9)</span>
<a href="#l13.27"></a><span id="l13.27" class="difflineplus">+/**</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineplus">+ * @deprecated</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineplus">+ */</span>
<a href="#l13.30"></a><span id="l13.30" class="difflineplus">+#define error_ptr(error) ((void*)error)</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineplus">+/**</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+ * @deprecated</span>
<a href="#l13.33"></a><span id="l13.33" class="difflineplus">+ */</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineplus">+#define error_description(error)  (json_tokener_get_error(error))</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineplus">+/**</span>
<a href="#l13.36"></a><span id="l13.36" class="difflineplus">+ * @deprecated</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineplus">+ */</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineplus">+#define is_error(ptr) (ptr == NULL)</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineplus">+</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1">new file mode 100644</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineminus">--- /dev/null</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineplus">+++ b/third_party/json-c/config.h.in</span>
<a href="#l14.4"></a><span id="l14.4" class="difflineat">@@ -0,0 +1,196 @@</span>
<a href="#l14.5"></a><span id="l14.5" class="difflineplus">+/* config.h.in.  Generated from configure.ac by autoheader.  */</span>
<a href="#l14.6"></a><span id="l14.6" class="difflineplus">+</span>
<a href="#l14.7"></a><span id="l14.7" class="difflineplus">+/* Enable RDRAND Hardware RNG Hash Seed */</span>
<a href="#l14.8"></a><span id="l14.8" class="difflineplus">+#undef ENABLE_RDRAND</span>
<a href="#l14.9"></a><span id="l14.9" class="difflineplus">+</span>
<a href="#l14.10"></a><span id="l14.10" class="difflineplus">+/* Enable partial threading support */</span>
<a href="#l14.11"></a><span id="l14.11" class="difflineplus">+#undef ENABLE_THREADING</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+/* Define if .gnu.warning accepts long strings. */</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+#undef HAS_GNU_WARNING_LONG</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineplus">+/* Has atomic builtins */</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+#undef HAVE_ATOMIC_BUILTINS</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineplus">+</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineplus">+/* Define to 1 if you have the declaration of `INFINITY', and to 0 if you</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineplus">+   don't. */</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineplus">+#undef HAVE_DECL_INFINITY</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineplus">+</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineplus">+/* Define to 1 if you have the declaration of `isinf', and to 0 if you don't.</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineplus">+   */</span>
<a href="#l14.25"></a><span id="l14.25" class="difflineplus">+#undef HAVE_DECL_ISINF</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineplus">+</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineplus">+/* Define to 1 if you have the declaration of `isnan', and to 0 if you don't.</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineplus">+   */</span>
<a href="#l14.29"></a><span id="l14.29" class="difflineplus">+#undef HAVE_DECL_ISNAN</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineplus">+</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineplus">+/* Define to 1 if you have the declaration of `nan', and to 0 if you don't. */</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+#undef HAVE_DECL_NAN</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineplus">+</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineplus">+/* Define to 1 if you have the declaration of `_finite', and to 0 if you</span>
<a href="#l14.35"></a><span id="l14.35" class="difflineplus">+   don't. */</span>
<a href="#l14.36"></a><span id="l14.36" class="difflineplus">+#undef HAVE_DECL__FINITE</span>
<a href="#l14.37"></a><span id="l14.37" class="difflineplus">+</span>
<a href="#l14.38"></a><span id="l14.38" class="difflineplus">+/* Define to 1 if you have the declaration of `_isnan', and to 0 if you don't.</span>
<a href="#l14.39"></a><span id="l14.39" class="difflineplus">+   */</span>
<a href="#l14.40"></a><span id="l14.40" class="difflineplus">+#undef HAVE_DECL__ISNAN</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineplus">+</span>
<a href="#l14.42"></a><span id="l14.42" class="difflineplus">+/* Define to 1 if you have the &lt;dlfcn.h&gt; header file. */</span>
<a href="#l14.43"></a><span id="l14.43" class="difflineplus">+#undef HAVE_DLFCN_H</span>
<a href="#l14.44"></a><span id="l14.44" class="difflineplus">+</span>
<a href="#l14.45"></a><span id="l14.45" class="difflineplus">+/* Define to 1 if you don't have `vprintf' but do have `_doprnt.' */</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineplus">+#undef HAVE_DOPRNT</span>
<a href="#l14.47"></a><span id="l14.47" class="difflineplus">+</span>
<a href="#l14.48"></a><span id="l14.48" class="difflineplus">+/* Define to 1 if you have the &lt;endian.h&gt; header file. */</span>
<a href="#l14.49"></a><span id="l14.49" class="difflineplus">+#undef HAVE_ENDIAN_H</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineplus">+</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+/* Define to 1 if you have the &lt;fcntl.h&gt; header file. */</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+#undef HAVE_FCNTL_H</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineplus">+</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineplus">+/* Define to 1 if you have the &lt;inttypes.h&gt; header file. */</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineplus">+#undef HAVE_INTTYPES_H</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineplus">+</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineplus">+/* Define to 1 if you have the &lt;limits.h&gt; header file. */</span>
<a href="#l14.58"></a><span id="l14.58" class="difflineplus">+#undef HAVE_LIMITS_H</span>
<a href="#l14.59"></a><span id="l14.59" class="difflineplus">+</span>
<a href="#l14.60"></a><span id="l14.60" class="difflineplus">+/* Define to 1 if you have the &lt;locale.h&gt; header file. */</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineplus">+#undef HAVE_LOCALE_H</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineplus">+</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineplus">+/* Define to 1 if you have the &lt;memory.h&gt; header file. */</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineplus">+#undef HAVE_MEMORY_H</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineplus">+</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineplus">+/* Define to 1 if you have the `open' function. */</span>
<a href="#l14.67"></a><span id="l14.67" class="difflineplus">+#undef HAVE_OPEN</span>
<a href="#l14.68"></a><span id="l14.68" class="difflineplus">+</span>
<a href="#l14.69"></a><span id="l14.69" class="difflineplus">+/* Define to 1 if you have the `realloc' function. */</span>
<a href="#l14.70"></a><span id="l14.70" class="difflineplus">+#undef HAVE_REALLOC</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineplus">+</span>
<a href="#l14.72"></a><span id="l14.72" class="difflineplus">+/* Define to 1 if you have the `setlocale' function. */</span>
<a href="#l14.73"></a><span id="l14.73" class="difflineplus">+#undef HAVE_SETLOCALE</span>
<a href="#l14.74"></a><span id="l14.74" class="difflineplus">+</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineplus">+/* Define to 1 if you have the `snprintf' function. */</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineplus">+#undef HAVE_SNPRINTF</span>
<a href="#l14.77"></a><span id="l14.77" class="difflineplus">+</span>
<a href="#l14.78"></a><span id="l14.78" class="difflineplus">+/* Define to 1 if you have the &lt;stdarg.h&gt; header file. */</span>
<a href="#l14.79"></a><span id="l14.79" class="difflineplus">+#undef HAVE_STDARG_H</span>
<a href="#l14.80"></a><span id="l14.80" class="difflineplus">+</span>
<a href="#l14.81"></a><span id="l14.81" class="difflineplus">+/* Define to 1 if you have the &lt;stdint.h&gt; header file. */</span>
<a href="#l14.82"></a><span id="l14.82" class="difflineplus">+#undef HAVE_STDINT_H</span>
<a href="#l14.83"></a><span id="l14.83" class="difflineplus">+</span>
<a href="#l14.84"></a><span id="l14.84" class="difflineplus">+/* Define to 1 if you have the &lt;stdlib.h&gt; header file. */</span>
<a href="#l14.85"></a><span id="l14.85" class="difflineplus">+#undef HAVE_STDLIB_H</span>
<a href="#l14.86"></a><span id="l14.86" class="difflineplus">+</span>
<a href="#l14.87"></a><span id="l14.87" class="difflineplus">+/* Define to 1 if you have the `strcasecmp' function. */</span>
<a href="#l14.88"></a><span id="l14.88" class="difflineplus">+#undef HAVE_STRCASECMP</span>
<a href="#l14.89"></a><span id="l14.89" class="difflineplus">+</span>
<a href="#l14.90"></a><span id="l14.90" class="difflineplus">+/* Define to 1 if you have the `strdup' function. */</span>
<a href="#l14.91"></a><span id="l14.91" class="difflineplus">+#undef HAVE_STRDUP</span>
<a href="#l14.92"></a><span id="l14.92" class="difflineplus">+</span>
<a href="#l14.93"></a><span id="l14.93" class="difflineplus">+/* Define to 1 if you have the `strerror' function. */</span>
<a href="#l14.94"></a><span id="l14.94" class="difflineplus">+#undef HAVE_STRERROR</span>
<a href="#l14.95"></a><span id="l14.95" class="difflineplus">+</span>
<a href="#l14.96"></a><span id="l14.96" class="difflineplus">+/* Define to 1 if you have the &lt;strings.h&gt; header file. */</span>
<a href="#l14.97"></a><span id="l14.97" class="difflineplus">+#undef HAVE_STRINGS_H</span>
<a href="#l14.98"></a><span id="l14.98" class="difflineplus">+</span>
<a href="#l14.99"></a><span id="l14.99" class="difflineplus">+/* Define to 1 if you have the &lt;string.h&gt; header file. */</span>
<a href="#l14.100"></a><span id="l14.100" class="difflineplus">+#undef HAVE_STRING_H</span>
<a href="#l14.101"></a><span id="l14.101" class="difflineplus">+</span>
<a href="#l14.102"></a><span id="l14.102" class="difflineplus">+/* Define to 1 if you have the `strncasecmp' function. */</span>
<a href="#l14.103"></a><span id="l14.103" class="difflineplus">+#undef HAVE_STRNCASECMP</span>
<a href="#l14.104"></a><span id="l14.104" class="difflineplus">+</span>
<a href="#l14.105"></a><span id="l14.105" class="difflineplus">+/* Define to 1 if you have the &lt;syslog.h&gt; header file. */</span>
<a href="#l14.106"></a><span id="l14.106" class="difflineplus">+#undef HAVE_SYSLOG_H</span>
<a href="#l14.107"></a><span id="l14.107" class="difflineplus">+</span>
<a href="#l14.108"></a><span id="l14.108" class="difflineplus">+/* Define to 1 if you have the &lt;sys/cdefs.h&gt; header file. */</span>
<a href="#l14.109"></a><span id="l14.109" class="difflineplus">+#undef HAVE_SYS_CDEFS_H</span>
<a href="#l14.110"></a><span id="l14.110" class="difflineplus">+</span>
<a href="#l14.111"></a><span id="l14.111" class="difflineplus">+/* Define to 1 if you have the &lt;sys/param.h&gt; header file. */</span>
<a href="#l14.112"></a><span id="l14.112" class="difflineplus">+#undef HAVE_SYS_PARAM_H</span>
<a href="#l14.113"></a><span id="l14.113" class="difflineplus">+</span>
<a href="#l14.114"></a><span id="l14.114" class="difflineplus">+/* Define to 1 if you have the &lt;sys/stat.h&gt; header file. */</span>
<a href="#l14.115"></a><span id="l14.115" class="difflineplus">+#undef HAVE_SYS_STAT_H</span>
<a href="#l14.116"></a><span id="l14.116" class="difflineplus">+</span>
<a href="#l14.117"></a><span id="l14.117" class="difflineplus">+/* Define to 1 if you have the &lt;sys/types.h&gt; header file. */</span>
<a href="#l14.118"></a><span id="l14.118" class="difflineplus">+#undef HAVE_SYS_TYPES_H</span>
<a href="#l14.119"></a><span id="l14.119" class="difflineplus">+</span>
<a href="#l14.120"></a><span id="l14.120" class="difflineplus">+/* Define to 1 if you have the &lt;unistd.h&gt; header file. */</span>
<a href="#l14.121"></a><span id="l14.121" class="difflineplus">+#undef HAVE_UNISTD_H</span>
<a href="#l14.122"></a><span id="l14.122" class="difflineplus">+</span>
<a href="#l14.123"></a><span id="l14.123" class="difflineplus">+/* Define to 1 if you have the `uselocale' function. */</span>
<a href="#l14.124"></a><span id="l14.124" class="difflineplus">+#undef HAVE_USELOCALE</span>
<a href="#l14.125"></a><span id="l14.125" class="difflineplus">+</span>
<a href="#l14.126"></a><span id="l14.126" class="difflineplus">+/* Define to 1 if you have the `vasprintf' function. */</span>
<a href="#l14.127"></a><span id="l14.127" class="difflineplus">+#undef HAVE_VASPRINTF</span>
<a href="#l14.128"></a><span id="l14.128" class="difflineplus">+</span>
<a href="#l14.129"></a><span id="l14.129" class="difflineplus">+/* Define to 1 if you have the `vprintf' function. */</span>
<a href="#l14.130"></a><span id="l14.130" class="difflineplus">+#undef HAVE_VPRINTF</span>
<a href="#l14.131"></a><span id="l14.131" class="difflineplus">+</span>
<a href="#l14.132"></a><span id="l14.132" class="difflineplus">+/* Define to 1 if you have the `vsnprintf' function. */</span>
<a href="#l14.133"></a><span id="l14.133" class="difflineplus">+#undef HAVE_VSNPRINTF</span>
<a href="#l14.134"></a><span id="l14.134" class="difflineplus">+</span>
<a href="#l14.135"></a><span id="l14.135" class="difflineplus">+/* Define to 1 if you have the `vsyslog' function. */</span>
<a href="#l14.136"></a><span id="l14.136" class="difflineplus">+#undef HAVE_VSYSLOG</span>
<a href="#l14.137"></a><span id="l14.137" class="difflineplus">+</span>
<a href="#l14.138"></a><span id="l14.138" class="difflineplus">+/* Define to 1 if you have the &lt;xlocale.h&gt; header file. */</span>
<a href="#l14.139"></a><span id="l14.139" class="difflineplus">+#undef HAVE_XLOCALE_H</span>
<a href="#l14.140"></a><span id="l14.140" class="difflineplus">+</span>
<a href="#l14.141"></a><span id="l14.141" class="difflineplus">+/* Have __thread */</span>
<a href="#l14.142"></a><span id="l14.142" class="difflineplus">+#undef HAVE___THREAD</span>
<a href="#l14.143"></a><span id="l14.143" class="difflineplus">+</span>
<a href="#l14.144"></a><span id="l14.144" class="difflineplus">+/* Public define for json_inttypes.h */</span>
<a href="#l14.145"></a><span id="l14.145" class="difflineplus">+#undef JSON_C_HAVE_INTTYPES_H</span>
<a href="#l14.146"></a><span id="l14.146" class="difflineplus">+</span>
<a href="#l14.147"></a><span id="l14.147" class="difflineplus">+/* Define to the sub-directory in which libtool stores uninstalled libraries.</span>
<a href="#l14.148"></a><span id="l14.148" class="difflineplus">+   */</span>
<a href="#l14.149"></a><span id="l14.149" class="difflineplus">+#undef LT_OBJDIR</span>
<a href="#l14.150"></a><span id="l14.150" class="difflineplus">+</span>
<a href="#l14.151"></a><span id="l14.151" class="difflineplus">+/* Name of package */</span>
<a href="#l14.152"></a><span id="l14.152" class="difflineplus">+#undef PACKAGE</span>
<a href="#l14.153"></a><span id="l14.153" class="difflineplus">+</span>
<a href="#l14.154"></a><span id="l14.154" class="difflineplus">+/* Define to the address where bug reports for this package should be sent. */</span>
<a href="#l14.155"></a><span id="l14.155" class="difflineplus">+#undef PACKAGE_BUGREPORT</span>
<a href="#l14.156"></a><span id="l14.156" class="difflineplus">+</span>
<a href="#l14.157"></a><span id="l14.157" class="difflineplus">+/* Define to the full name of this package. */</span>
<a href="#l14.158"></a><span id="l14.158" class="difflineplus">+#undef PACKAGE_NAME</span>
<a href="#l14.159"></a><span id="l14.159" class="difflineplus">+</span>
<a href="#l14.160"></a><span id="l14.160" class="difflineplus">+/* Define to the full name and version of this package. */</span>
<a href="#l14.161"></a><span id="l14.161" class="difflineplus">+#undef PACKAGE_STRING</span>
<a href="#l14.162"></a><span id="l14.162" class="difflineplus">+</span>
<a href="#l14.163"></a><span id="l14.163" class="difflineplus">+/* Define to the one symbol short name of this package. */</span>
<a href="#l14.164"></a><span id="l14.164" class="difflineplus">+#undef PACKAGE_TARNAME</span>
<a href="#l14.165"></a><span id="l14.165" class="difflineplus">+</span>
<a href="#l14.166"></a><span id="l14.166" class="difflineplus">+/* Define to the home page for this package. */</span>
<a href="#l14.167"></a><span id="l14.167" class="difflineplus">+#undef PACKAGE_URL</span>
<a href="#l14.168"></a><span id="l14.168" class="difflineplus">+</span>
<a href="#l14.169"></a><span id="l14.169" class="difflineplus">+/* Define to the version of this package. */</span>
<a href="#l14.170"></a><span id="l14.170" class="difflineplus">+#undef PACKAGE_VERSION</span>
<a href="#l14.171"></a><span id="l14.171" class="difflineplus">+</span>
<a href="#l14.172"></a><span id="l14.172" class="difflineplus">+/* The number of bytes in type int */</span>
<a href="#l14.173"></a><span id="l14.173" class="difflineplus">+#undef SIZEOF_INT</span>
<a href="#l14.174"></a><span id="l14.174" class="difflineplus">+</span>
<a href="#l14.175"></a><span id="l14.175" class="difflineplus">+/* The number of bytes in type int64_t */</span>
<a href="#l14.176"></a><span id="l14.176" class="difflineplus">+#undef SIZEOF_INT64_T</span>
<a href="#l14.177"></a><span id="l14.177" class="difflineplus">+</span>
<a href="#l14.178"></a><span id="l14.178" class="difflineplus">+/* The number of bytes in type long */</span>
<a href="#l14.179"></a><span id="l14.179" class="difflineplus">+#undef SIZEOF_LONG</span>
<a href="#l14.180"></a><span id="l14.180" class="difflineplus">+</span>
<a href="#l14.181"></a><span id="l14.181" class="difflineplus">+/* The number of bytes in type long long */</span>
<a href="#l14.182"></a><span id="l14.182" class="difflineplus">+#undef SIZEOF_LONG_LONG</span>
<a href="#l14.183"></a><span id="l14.183" class="difflineplus">+</span>
<a href="#l14.184"></a><span id="l14.184" class="difflineplus">+/* The number of bytes in type size_t */</span>
<a href="#l14.185"></a><span id="l14.185" class="difflineplus">+#undef SIZEOF_SIZE_T</span>
<a href="#l14.186"></a><span id="l14.186" class="difflineplus">+</span>
<a href="#l14.187"></a><span id="l14.187" class="difflineplus">+/* Specifier for __thread */</span>
<a href="#l14.188"></a><span id="l14.188" class="difflineplus">+#undef SPEC___THREAD</span>
<a href="#l14.189"></a><span id="l14.189" class="difflineplus">+</span>
<a href="#l14.190"></a><span id="l14.190" class="difflineplus">+/* Define to 1 if you have the ANSI C header files. */</span>
<a href="#l14.191"></a><span id="l14.191" class="difflineplus">+#undef STDC_HEADERS</span>
<a href="#l14.192"></a><span id="l14.192" class="difflineplus">+</span>
<a href="#l14.193"></a><span id="l14.193" class="difflineplus">+/* Version number of package */</span>
<a href="#l14.194"></a><span id="l14.194" class="difflineplus">+#undef VERSION</span>
<a href="#l14.195"></a><span id="l14.195" class="difflineplus">+</span>
<a href="#l14.196"></a><span id="l14.196" class="difflineplus">+/* Define to empty if `const' does not conform to ANSI C. */</span>
<a href="#l14.197"></a><span id="l14.197" class="difflineplus">+#undef const</span>
<a href="#l14.198"></a><span id="l14.198" class="difflineplus">+</span>
<a href="#l14.199"></a><span id="l14.199" class="difflineplus">+/* Define to `unsigned int' if &lt;sys/types.h&gt; does not define. */</span>
<a href="#l14.200"></a><span id="l14.200" class="difflineplus">+#undef size_t</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1">new file mode 100644</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineminus">--- /dev/null</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineplus">+++ b/third_party/json-c/config.h.win32</span>
<a href="#l15.4"></a><span id="l15.4" class="difflineat">@@ -0,0 +1,205 @@</span>
<a href="#l15.5"></a><span id="l15.5" class="difflineplus">+/* config.h.in.  Generated from configure.ac by autoheader.  */</span>
<a href="#l15.6"></a><span id="l15.6" class="difflineplus">+</span>
<a href="#l15.7"></a><span id="l15.7" class="difflineplus">+/* Enable RDRANR Hardware RNG Hash Seed */</span>
<a href="#l15.8"></a><span id="l15.8" class="difflineplus">+#undef ENABLE_RDRAND</span>
<a href="#l15.9"></a><span id="l15.9" class="difflineplus">+</span>
<a href="#l15.10"></a><span id="l15.10" class="difflineplus">+/* Define if .gnu.warning accepts long strings. */</span>
<a href="#l15.11"></a><span id="l15.11" class="difflineplus">+#undef HAS_GNU_WARNING_LONG</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineplus">+</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+/* Define to 1 if you have the declaration of `INFINITY', and to 0 if you</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+   don't. */</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+#if (defined(_MSC_VER) &amp;&amp; _MSC_VER &gt;= 1800) || defined(__MINGW32__)</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+#define HAVE_DECL_INFINITY 1</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineplus">+#endif</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineplus">+</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+/* Define to 1 if you have the declaration of `isinf', and to 0 if you don't.</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineplus">+   */</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineplus">+#if (defined(_MSC_VER) &amp;&amp; _MSC_VER &gt;= 1800) || defined(__MINGW32__)</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineplus">+#define HAVE_DECL_ISINF 1</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+#endif</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineplus">+</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+/* Define to 1 if you have the declaration of `isnan', and to 0 if you don't.</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+   */</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineplus">+#if (defined(_MSC_VER) &amp;&amp; _MSC_VER &gt;= 1800) || defined(__MINGW32__)</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineplus">+#define HAVE_DECL_ISNAN 1</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineplus">+#endif</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineplus">+</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineplus">+/* Define to 1 if you have the declaration of `nan', and to 0 if you don't. */</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+#if (defined(_MSC_VER) &amp;&amp; _MSC_VER &gt;= 1800) || defined(__MINGW32__)</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineplus">+#define HAVE_DECL_NAN 1</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineplus">+#endif</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineplus">+</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineplus">+/* Define to 1 if you have the declaration of `_finite', and to 0 if you</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+   don't. */</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+#define HAVE_DECL__FINITE 1</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineplus">+</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineplus">+/* Define to 1 if you have the declaration of `_isnan', and to 0 if you don't.</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineplus">+   */</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineplus">+#define HAVE_DECL__ISNAN 1</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineplus">+</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineplus">+/* Define to 1 if you have the &lt;dlfcn.h&gt; header file. */</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineplus">+#define HAVE_DLFCN_H 1</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineplus">+</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineplus">+/* Define to 1 if you don't have `vprintf' but do have `_doprnt.' */</span>
<a href="#l15.48"></a><span id="l15.48" class="difflineplus">+#define HAVE_DOPRNT 1</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineplus">+</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineplus">+/* Define to 1 if you have the &lt;endian.h&gt; header file. */</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineplus">+#undef HAVE_ENDIAN_H</span>
<a href="#l15.52"></a><span id="l15.52" class="difflineplus">+</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineplus">+/* Define to 1 if you have the &lt;fcntl.h&gt; header file. */</span>
<a href="#l15.54"></a><span id="l15.54" class="difflineplus">+#define HAVE_FCNTL_H 1</span>
<a href="#l15.55"></a><span id="l15.55" class="difflineplus">+</span>
<a href="#l15.56"></a><span id="l15.56" class="difflineplus">+/* Define to 1 if you have the &lt;inttypes.h&gt; header file. */</span>
<a href="#l15.57"></a><span id="l15.57" class="difflineplus">+#define HAVE_INTTYPES_H 1</span>
<a href="#l15.58"></a><span id="l15.58" class="difflineplus">+</span>
<a href="#l15.59"></a><span id="l15.59" class="difflineplus">+/* Define to 1 if you have the &lt;limits.h&gt; header file. */</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineplus">+#define HAVE_LIMITS_H 1</span>
<a href="#l15.61"></a><span id="l15.61" class="difflineplus">+</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineplus">+/* Define to 1 if you have the &lt;locale.h&gt; header file. */</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineplus">+#define HAVE_LOCALE_H 1</span>
<a href="#l15.64"></a><span id="l15.64" class="difflineplus">+</span>
<a href="#l15.65"></a><span id="l15.65" class="difflineplus">+/* Define to 1 if your system has a GNU libc compatible `malloc' function, and</span>
<a href="#l15.66"></a><span id="l15.66" class="difflineplus">+   to 0 otherwise. */</span>
<a href="#l15.67"></a><span id="l15.67" class="difflineplus">+#define HAVE_MALLOC 1</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineplus">+</span>
<a href="#l15.69"></a><span id="l15.69" class="difflineplus">+/* Define to 1 if you have the &lt;memory.h&gt; header file. */</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineplus">+#define HAVE_MEMORY_H 1</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineplus">+</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineplus">+/* Define to 1 if you have the `open' function. */</span>
<a href="#l15.73"></a><span id="l15.73" class="difflineplus">+#define HAVE_OPEN 1</span>
<a href="#l15.74"></a><span id="l15.74" class="difflineplus">+</span>
<a href="#l15.75"></a><span id="l15.75" class="difflineplus">+/* Define to 1 if your system has a GNU libc compatible `realloc' function,</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineplus">+   and to 0 otherwise. */</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineplus">+#define HAVE_REALLOC 1</span>
<a href="#l15.78"></a><span id="l15.78" class="difflineplus">+</span>
<a href="#l15.79"></a><span id="l15.79" class="difflineplus">+/* Define to 1 if you have the `setlocale' function. */</span>
<a href="#l15.80"></a><span id="l15.80" class="difflineplus">+#define HAVE_SETLOCALE 1</span>
<a href="#l15.81"></a><span id="l15.81" class="difflineplus">+</span>
<a href="#l15.82"></a><span id="l15.82" class="difflineplus">+/* Define to 1 if you have the `snprintf' function. */</span>
<a href="#l15.83"></a><span id="l15.83" class="difflineplus">+#if defined(__MINGW32__)</span>
<a href="#l15.84"></a><span id="l15.84" class="difflineplus">+#define HAVE_SNPRINTF 1</span>
<a href="#l15.85"></a><span id="l15.85" class="difflineplus">+#else</span>
<a href="#l15.86"></a><span id="l15.86" class="difflineplus">+#undef HAVE_SNPRINTF</span>
<a href="#l15.87"></a><span id="l15.87" class="difflineplus">+#endif</span>
<a href="#l15.88"></a><span id="l15.88" class="difflineplus">+</span>
<a href="#l15.89"></a><span id="l15.89" class="difflineplus">+/* Define to 1 if you have the &lt;stdarg.h&gt; header file. */</span>
<a href="#l15.90"></a><span id="l15.90" class="difflineplus">+#define HAVE_STDARG_H 1</span>
<a href="#l15.91"></a><span id="l15.91" class="difflineplus">+</span>
<a href="#l15.92"></a><span id="l15.92" class="difflineplus">+/* Define to 1 if you have the &lt;stdint.h&gt; header file. */</span>
<a href="#l15.93"></a><span id="l15.93" class="difflineplus">+#define HAVE_STDINT_H 1</span>
<a href="#l15.94"></a><span id="l15.94" class="difflineplus">+</span>
<a href="#l15.95"></a><span id="l15.95" class="difflineplus">+/* Define to 1 if you have the &lt;stdlib.h&gt; header file. */</span>
<a href="#l15.96"></a><span id="l15.96" class="difflineplus">+#define HAVE_STDLIB_H 1</span>
<a href="#l15.97"></a><span id="l15.97" class="difflineplus">+</span>
<a href="#l15.98"></a><span id="l15.98" class="difflineplus">+/* Define to 1 if you have the `strcasecmp' function. */</span>
<a href="#l15.99"></a><span id="l15.99" class="difflineplus">+#define HAVE_STRCASECMP 1</span>
<a href="#l15.100"></a><span id="l15.100" class="difflineplus">+</span>
<a href="#l15.101"></a><span id="l15.101" class="difflineplus">+/* Define to 1 if you have the `strdup' function. */</span>
<a href="#l15.102"></a><span id="l15.102" class="difflineplus">+#define HAVE_STRDUP 0</span>
<a href="#l15.103"></a><span id="l15.103" class="difflineplus">+</span>
<a href="#l15.104"></a><span id="l15.104" class="difflineplus">+/* Define to 1 if you have the `strerror' function. */</span>
<a href="#l15.105"></a><span id="l15.105" class="difflineplus">+#define HAVE_STRERROR 1</span>
<a href="#l15.106"></a><span id="l15.106" class="difflineplus">+</span>
<a href="#l15.107"></a><span id="l15.107" class="difflineplus">+/* Define to 1 if you have the &lt;strings.h&gt; header file. */</span>
<a href="#l15.108"></a><span id="l15.108" class="difflineplus">+#undef HAVE_STRINGS_H</span>
<a href="#l15.109"></a><span id="l15.109" class="difflineplus">+</span>
<a href="#l15.110"></a><span id="l15.110" class="difflineplus">+/* Define to 1 if you have the &lt;string.h&gt; header file. */</span>
<a href="#l15.111"></a><span id="l15.111" class="difflineplus">+#define HAVE_STRING_H 1</span>
<a href="#l15.112"></a><span id="l15.112" class="difflineplus">+</span>
<a href="#l15.113"></a><span id="l15.113" class="difflineplus">+/* Define to 1 if you have the `strncasecmp' function. */</span>
<a href="#l15.114"></a><span id="l15.114" class="difflineplus">+#if defined(__MINGW32__)</span>
<a href="#l15.115"></a><span id="l15.115" class="difflineplus">+#define HAVE_STRNCASECMP 1</span>
<a href="#l15.116"></a><span id="l15.116" class="difflineplus">+#else</span>
<a href="#l15.117"></a><span id="l15.117" class="difflineplus">+#undef HAVE_STRNCASECMP</span>
<a href="#l15.118"></a><span id="l15.118" class="difflineplus">+#endif</span>
<a href="#l15.119"></a><span id="l15.119" class="difflineplus">+</span>
<a href="#l15.120"></a><span id="l15.120" class="difflineplus">+#cmakedefine HAVE_STRTOLL</span>
<a href="#l15.121"></a><span id="l15.121" class="difflineplus">+#cmakedefine strtoll @cmake_strtoll@</span>
<a href="#l15.122"></a><span id="l15.122" class="difflineplus">+</span>
<a href="#l15.123"></a><span id="l15.123" class="difflineplus">+/* Define to 1 if you have the &lt;syslog.h&gt; header file. */</span>
<a href="#l15.124"></a><span id="l15.124" class="difflineplus">+#undef HAVE_SYSLOG_H</span>
<a href="#l15.125"></a><span id="l15.125" class="difflineplus">+</span>
<a href="#l15.126"></a><span id="l15.126" class="difflineplus">+/* Define to 1 if you have the &lt;sys/cdefs.h&gt; header file. */</span>
<a href="#l15.127"></a><span id="l15.127" class="difflineplus">+#define HAVE_SYS_CDEFS_H 1</span>
<a href="#l15.128"></a><span id="l15.128" class="difflineplus">+</span>
<a href="#l15.129"></a><span id="l15.129" class="difflineplus">+/* Define to 1 if you have the &lt;sys/param.h&gt; header file. */</span>
<a href="#l15.130"></a><span id="l15.130" class="difflineplus">+#if defined(__MINGW32__)</span>
<a href="#l15.131"></a><span id="l15.131" class="difflineplus">+#define HAVE_SYS_PARAM_H 1</span>
<a href="#l15.132"></a><span id="l15.132" class="difflineplus">+#else</span>
<a href="#l15.133"></a><span id="l15.133" class="difflineplus">+#undef HAVE_SYS_PARAM_H</span>
<a href="#l15.134"></a><span id="l15.134" class="difflineplus">+#endif</span>
<a href="#l15.135"></a><span id="l15.135" class="difflineplus">+</span>
<a href="#l15.136"></a><span id="l15.136" class="difflineplus">+/* Define to 1 if you have the &lt;sys/stat.h&gt; header file. */</span>
<a href="#l15.137"></a><span id="l15.137" class="difflineplus">+#define HAVE_SYS_STAT_H 1</span>
<a href="#l15.138"></a><span id="l15.138" class="difflineplus">+</span>
<a href="#l15.139"></a><span id="l15.139" class="difflineplus">+/* Define to 1 if you have the &lt;sys/types.h&gt; header file. */</span>
<a href="#l15.140"></a><span id="l15.140" class="difflineplus">+#define HAVE_SYS_TYPES_H 1</span>
<a href="#l15.141"></a><span id="l15.141" class="difflineplus">+</span>
<a href="#l15.142"></a><span id="l15.142" class="difflineplus">+/* Define to 1 if you have the &lt;unistd.h&gt; header file. */</span>
<a href="#l15.143"></a><span id="l15.143" class="difflineplus">+#if defined(__MINGW32__)</span>
<a href="#l15.144"></a><span id="l15.144" class="difflineplus">+#define HAVE_UNISTD_H 1</span>
<a href="#l15.145"></a><span id="l15.145" class="difflineplus">+#else</span>
<a href="#l15.146"></a><span id="l15.146" class="difflineplus">+#undef HAVE_UNISTD_H</span>
<a href="#l15.147"></a><span id="l15.147" class="difflineplus">+#endif</span>
<a href="#l15.148"></a><span id="l15.148" class="difflineplus">+</span>
<a href="#l15.149"></a><span id="l15.149" class="difflineplus">+/* Define to 1 if you have the `vasprintf' function. */</span>
<a href="#l15.150"></a><span id="l15.150" class="difflineplus">+#if defined(__MINGW32__)</span>
<a href="#l15.151"></a><span id="l15.151" class="difflineplus">+#define HAVE_VASPRINTF 1</span>
<a href="#l15.152"></a><span id="l15.152" class="difflineplus">+#else</span>
<a href="#l15.153"></a><span id="l15.153" class="difflineplus">+#undef HAVE_VASPRINTF</span>
<a href="#l15.154"></a><span id="l15.154" class="difflineplus">+#endif</span>
<a href="#l15.155"></a><span id="l15.155" class="difflineplus">+</span>
<a href="#l15.156"></a><span id="l15.156" class="difflineplus">+/* Define to 1 if you have the `vprintf' function. */</span>
<a href="#l15.157"></a><span id="l15.157" class="difflineplus">+#define HAVE_VPRINTF 1</span>
<a href="#l15.158"></a><span id="l15.158" class="difflineplus">+</span>
<a href="#l15.159"></a><span id="l15.159" class="difflineplus">+/* Define to 1 if you have the `vsnprintf' function. */</span>
<a href="#l15.160"></a><span id="l15.160" class="difflineplus">+#define HAVE_VSNPRINTF 1</span>
<a href="#l15.161"></a><span id="l15.161" class="difflineplus">+</span>
<a href="#l15.162"></a><span id="l15.162" class="difflineplus">+/* Define to 1 if you have the `vsyslog' function. */</span>
<a href="#l15.163"></a><span id="l15.163" class="difflineplus">+#undef HAVE_VSYSLOG</span>
<a href="#l15.164"></a><span id="l15.164" class="difflineplus">+</span>
<a href="#l15.165"></a><span id="l15.165" class="difflineplus">+/* Define to the sub-directory in which libtool stores uninstalled libraries.</span>
<a href="#l15.166"></a><span id="l15.166" class="difflineplus">+   */</span>
<a href="#l15.167"></a><span id="l15.167" class="difflineplus">+#undef LT_OBJDIR</span>
<a href="#l15.168"></a><span id="l15.168" class="difflineplus">+</span>
<a href="#l15.169"></a><span id="l15.169" class="difflineplus">+/* Define to 1 if your C compiler doesn't accept -c and -o together. */</span>
<a href="#l15.170"></a><span id="l15.170" class="difflineplus">+/* #undef NO_MINUS_C_MINUS_O */</span>
<a href="#l15.171"></a><span id="l15.171" class="difflineplus">+</span>
<a href="#l15.172"></a><span id="l15.172" class="difflineplus">+/* Name of package */</span>
<a href="#l15.173"></a><span id="l15.173" class="difflineplus">+#define PACKAGE &quot;json-c&quot;</span>
<a href="#l15.174"></a><span id="l15.174" class="difflineplus">+</span>
<a href="#l15.175"></a><span id="l15.175" class="difflineplus">+/* Define to the address where bug reports for this package should be sent. */</span>
<a href="#l15.176"></a><span id="l15.176" class="difflineplus">+#define PACKAGE_BUGREPORT &quot;json-c@googlegroups.com&quot;</span>
<a href="#l15.177"></a><span id="l15.177" class="difflineplus">+</span>
<a href="#l15.178"></a><span id="l15.178" class="difflineplus">+/* Define to the full name of this package. */</span>
<a href="#l15.179"></a><span id="l15.179" class="difflineplus">+#define PACKAGE_NAME &quot;JSON C Library&quot;</span>
<a href="#l15.180"></a><span id="l15.180" class="difflineplus">+</span>
<a href="#l15.181"></a><span id="l15.181" class="difflineplus">+/* Define to the full name and version of this package. */</span>
<a href="#l15.182"></a><span id="l15.182" class="difflineplus">+#define PACKAGE_STRING &quot;JSON C Library 0.13.1&quot;</span>
<a href="#l15.183"></a><span id="l15.183" class="difflineplus">+</span>
<a href="#l15.184"></a><span id="l15.184" class="difflineplus">+/* Define to the one symbol short name of this package. */</span>
<a href="#l15.185"></a><span id="l15.185" class="difflineplus">+#define PACKAGE_TARNAME &quot;json-c&quot;</span>
<a href="#l15.186"></a><span id="l15.186" class="difflineplus">+</span>
<a href="#l15.187"></a><span id="l15.187" class="difflineplus">+/* Define to the home page for this package. */</span>
<a href="#l15.188"></a><span id="l15.188" class="difflineplus">+#define PACKAGE_URL &quot;https://github.com/json-c/json-c&quot;</span>
<a href="#l15.189"></a><span id="l15.189" class="difflineplus">+</span>
<a href="#l15.190"></a><span id="l15.190" class="difflineplus">+/* Define to the version of this package. */</span>
<a href="#l15.191"></a><span id="l15.191" class="difflineplus">+#define PACKAGE_VERSION &quot;0.13.1&quot;</span>
<a href="#l15.192"></a><span id="l15.192" class="difflineplus">+</span>
<a href="#l15.193"></a><span id="l15.193" class="difflineplus">+/* Define to 1 if you have the ANSI C header files. */</span>
<a href="#l15.194"></a><span id="l15.194" class="difflineplus">+#define STDC_HEADERS 1</span>
<a href="#l15.195"></a><span id="l15.195" class="difflineplus">+</span>
<a href="#l15.196"></a><span id="l15.196" class="difflineplus">+/* Version number of package */</span>
<a href="#l15.197"></a><span id="l15.197" class="difflineplus">+#define VERSION &quot;0.13.1&quot;</span>
<a href="#l15.198"></a><span id="l15.198" class="difflineplus">+</span>
<a href="#l15.199"></a><span id="l15.199" class="difflineplus">+/* Define to empty if `const' does not conform to ANSI C. */</span>
<a href="#l15.200"></a><span id="l15.200" class="difflineplus">+/* #undef const */</span>
<a href="#l15.201"></a><span id="l15.201" class="difflineplus">+</span>
<a href="#l15.202"></a><span id="l15.202" class="difflineplus">+/* Define to rpl_malloc if the replacement function should be used. */</span>
<a href="#l15.203"></a><span id="l15.203" class="difflineplus">+/* #undef malloc */</span>
<a href="#l15.204"></a><span id="l15.204" class="difflineplus">+</span>
<a href="#l15.205"></a><span id="l15.205" class="difflineplus">+/* Define to rpl_realloc if the replacement function should be used. */</span>
<a href="#l15.206"></a><span id="l15.206" class="difflineplus">+/* #undef realloc */</span>
<a href="#l15.207"></a><span id="l15.207" class="difflineplus">+</span>
<a href="#l15.208"></a><span id="l15.208" class="difflineplus">+/* Define to `unsigned int' if &lt;sys/types.h&gt; does not define. */</span>
<a href="#l15.209"></a><span id="l15.209" class="difflineplus">+/* #undef size_t */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1">new file mode 100644</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineminus">--- /dev/null</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineplus">+++ b/third_party/json-c/debug.c</span>
<a href="#l16.4"></a><span id="l16.4" class="difflineat">@@ -0,0 +1,83 @@</span>
<a href="#l16.5"></a><span id="l16.5" class="difflineplus">+/*</span>
<a href="#l16.6"></a><span id="l16.6" class="difflineplus">+ * $Id: debug.c,v 1.5 2006/01/26 02:16:28 mclark Exp $</span>
<a href="#l16.7"></a><span id="l16.7" class="difflineplus">+ *</span>
<a href="#l16.8"></a><span id="l16.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l16.9"></a><span id="l16.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l16.10"></a><span id="l16.10" class="difflineplus">+ *</span>
<a href="#l16.11"></a><span id="l16.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+ *</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+ */</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineplus">+</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineplus">+#include &lt;stdio.h&gt;</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineplus">+#include &lt;stdlib.h&gt;</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineplus">+#include &lt;string.h&gt;</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineplus">+#include &lt;stdarg.h&gt;</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineplus">+</span>
<a href="#l16.23"></a><span id="l16.23" class="difflineplus">+#if HAVE_SYSLOG_H</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineplus">+# include &lt;syslog.h&gt;</span>
<a href="#l16.25"></a><span id="l16.25" class="difflineplus">+#endif /* HAVE_SYSLOG_H */</span>
<a href="#l16.26"></a><span id="l16.26" class="difflineplus">+</span>
<a href="#l16.27"></a><span id="l16.27" class="difflineplus">+#if HAVE_UNISTD_H</span>
<a href="#l16.28"></a><span id="l16.28" class="difflineplus">+# include &lt;unistd.h&gt;</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineplus">+#endif /* HAVE_UNISTD_H */</span>
<a href="#l16.30"></a><span id="l16.30" class="difflineplus">+</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineplus">+#if HAVE_SYS_PARAM_H</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineplus">+#include &lt;sys/param.h&gt;</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineplus">+#endif /* HAVE_SYS_PARAM_H */</span>
<a href="#l16.34"></a><span id="l16.34" class="difflineplus">+</span>
<a href="#l16.35"></a><span id="l16.35" class="difflineplus">+#include &quot;debug.h&quot;</span>
<a href="#l16.36"></a><span id="l16.36" class="difflineplus">+</span>
<a href="#l16.37"></a><span id="l16.37" class="difflineplus">+static int _syslog = 0;</span>
<a href="#l16.38"></a><span id="l16.38" class="difflineplus">+static int _debug = 0;</span>
<a href="#l16.39"></a><span id="l16.39" class="difflineplus">+</span>
<a href="#l16.40"></a><span id="l16.40" class="difflineplus">+void mc_set_debug(int debug) { _debug = debug; }</span>
<a href="#l16.41"></a><span id="l16.41" class="difflineplus">+int mc_get_debug(void) { return _debug; }</span>
<a href="#l16.42"></a><span id="l16.42" class="difflineplus">+</span>
<a href="#l16.43"></a><span id="l16.43" class="difflineplus">+extern void mc_set_syslog(int syslog)</span>
<a href="#l16.44"></a><span id="l16.44" class="difflineplus">+{</span>
<a href="#l16.45"></a><span id="l16.45" class="difflineplus">+  _syslog = syslog;</span>
<a href="#l16.46"></a><span id="l16.46" class="difflineplus">+}</span>
<a href="#l16.47"></a><span id="l16.47" class="difflineplus">+</span>
<a href="#l16.48"></a><span id="l16.48" class="difflineplus">+void mc_debug(const char *msg, ...)</span>
<a href="#l16.49"></a><span id="l16.49" class="difflineplus">+{</span>
<a href="#l16.50"></a><span id="l16.50" class="difflineplus">+  va_list ap;</span>
<a href="#l16.51"></a><span id="l16.51" class="difflineplus">+  if(_debug) {</span>
<a href="#l16.52"></a><span id="l16.52" class="difflineplus">+    va_start(ap, msg);</span>
<a href="#l16.53"></a><span id="l16.53" class="difflineplus">+#if HAVE_VSYSLOG</span>
<a href="#l16.54"></a><span id="l16.54" class="difflineplus">+    if(_syslog) {</span>
<a href="#l16.55"></a><span id="l16.55" class="difflineplus">+		vsyslog(LOG_DEBUG, msg, ap);</span>
<a href="#l16.56"></a><span id="l16.56" class="difflineplus">+	} else</span>
<a href="#l16.57"></a><span id="l16.57" class="difflineplus">+#endif</span>
<a href="#l16.58"></a><span id="l16.58" class="difflineplus">+		vprintf(msg, ap);</span>
<a href="#l16.59"></a><span id="l16.59" class="difflineplus">+    va_end(ap);</span>
<a href="#l16.60"></a><span id="l16.60" class="difflineplus">+  }</span>
<a href="#l16.61"></a><span id="l16.61" class="difflineplus">+}</span>
<a href="#l16.62"></a><span id="l16.62" class="difflineplus">+</span>
<a href="#l16.63"></a><span id="l16.63" class="difflineplus">+void mc_error(const char *msg, ...)</span>
<a href="#l16.64"></a><span id="l16.64" class="difflineplus">+{</span>
<a href="#l16.65"></a><span id="l16.65" class="difflineplus">+  va_list ap;</span>
<a href="#l16.66"></a><span id="l16.66" class="difflineplus">+  va_start(ap, msg);</span>
<a href="#l16.67"></a><span id="l16.67" class="difflineplus">+#if HAVE_VSYSLOG</span>
<a href="#l16.68"></a><span id="l16.68" class="difflineplus">+    if(_syslog) {</span>
<a href="#l16.69"></a><span id="l16.69" class="difflineplus">+		vsyslog(LOG_ERR, msg, ap);</span>
<a href="#l16.70"></a><span id="l16.70" class="difflineplus">+	} else</span>
<a href="#l16.71"></a><span id="l16.71" class="difflineplus">+#endif</span>
<a href="#l16.72"></a><span id="l16.72" class="difflineplus">+		vfprintf(stderr, msg, ap);</span>
<a href="#l16.73"></a><span id="l16.73" class="difflineplus">+  va_end(ap);</span>
<a href="#l16.74"></a><span id="l16.74" class="difflineplus">+}</span>
<a href="#l16.75"></a><span id="l16.75" class="difflineplus">+</span>
<a href="#l16.76"></a><span id="l16.76" class="difflineplus">+void mc_info(const char *msg, ...)</span>
<a href="#l16.77"></a><span id="l16.77" class="difflineplus">+{</span>
<a href="#l16.78"></a><span id="l16.78" class="difflineplus">+  va_list ap;</span>
<a href="#l16.79"></a><span id="l16.79" class="difflineplus">+  va_start(ap, msg);</span>
<a href="#l16.80"></a><span id="l16.80" class="difflineplus">+#if HAVE_VSYSLOG</span>
<a href="#l16.81"></a><span id="l16.81" class="difflineplus">+    if(_syslog) {</span>
<a href="#l16.82"></a><span id="l16.82" class="difflineplus">+		vsyslog(LOG_INFO, msg, ap);</span>
<a href="#l16.83"></a><span id="l16.83" class="difflineplus">+	} else</span>
<a href="#l16.84"></a><span id="l16.84" class="difflineplus">+#endif</span>
<a href="#l16.85"></a><span id="l16.85" class="difflineplus">+		vfprintf(stderr, msg, ap);</span>
<a href="#l16.86"></a><span id="l16.86" class="difflineplus">+  va_end(ap);</span>
<a href="#l16.87"></a><span id="l16.87" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1">new file mode 100644</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineminus">--- /dev/null</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineplus">+++ b/third_party/json-c/debug.h</span>
<a href="#l17.4"></a><span id="l17.4" class="difflineat">@@ -0,0 +1,75 @@</span>
<a href="#l17.5"></a><span id="l17.5" class="difflineplus">+/*</span>
<a href="#l17.6"></a><span id="l17.6" class="difflineplus">+ * $Id: debug.h,v 1.5 2006/01/30 23:07:57 mclark Exp $</span>
<a href="#l17.7"></a><span id="l17.7" class="difflineplus">+ *</span>
<a href="#l17.8"></a><span id="l17.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l17.9"></a><span id="l17.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l17.10"></a><span id="l17.10" class="difflineplus">+ * Copyright (c) 2009 Hewlett-Packard Development Company, L.P.</span>
<a href="#l17.11"></a><span id="l17.11" class="difflineplus">+ *</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+ *</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineplus">+ */</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineplus">+/**</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineplus">+ * @file</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineplus">+ * @brief Do not use, json-c internal, may be changed or removed at any time.</span>
<a href="#l17.20"></a><span id="l17.20" class="difflineplus">+ */</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineplus">+#ifndef _DEBUG_H_</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineplus">+#define _DEBUG_H_</span>
<a href="#l17.23"></a><span id="l17.23" class="difflineplus">+</span>
<a href="#l17.24"></a><span id="l17.24" class="difflineplus">+#include &lt;stdlib.h&gt;</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineplus">+</span>
<a href="#l17.26"></a><span id="l17.26" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l17.27"></a><span id="l17.27" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l17.28"></a><span id="l17.28" class="difflineplus">+#endif</span>
<a href="#l17.29"></a><span id="l17.29" class="difflineplus">+</span>
<a href="#l17.30"></a><span id="l17.30" class="difflineplus">+extern void mc_set_debug(int debug);</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineplus">+extern int mc_get_debug(void);</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+</span>
<a href="#l17.33"></a><span id="l17.33" class="difflineplus">+extern void mc_set_syslog(int syslog);</span>
<a href="#l17.34"></a><span id="l17.34" class="difflineplus">+</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineplus">+extern void mc_debug(const char *msg, ...);</span>
<a href="#l17.36"></a><span id="l17.36" class="difflineplus">+extern void mc_error(const char *msg, ...);</span>
<a href="#l17.37"></a><span id="l17.37" class="difflineplus">+extern void mc_info(const char *msg, ...);</span>
<a href="#l17.38"></a><span id="l17.38" class="difflineplus">+</span>
<a href="#l17.39"></a><span id="l17.39" class="difflineplus">+#ifndef __STRING</span>
<a href="#l17.40"></a><span id="l17.40" class="difflineplus">+#define __STRING(x) #x</span>
<a href="#l17.41"></a><span id="l17.41" class="difflineplus">+#endif</span>
<a href="#l17.42"></a><span id="l17.42" class="difflineplus">+</span>
<a href="#l17.43"></a><span id="l17.43" class="difflineplus">+#ifndef PARSER_BROKEN_FIXED</span>
<a href="#l17.44"></a><span id="l17.44" class="difflineplus">+</span>
<a href="#l17.45"></a><span id="l17.45" class="difflineplus">+#define JASSERT(cond) do {} while(0)</span>
<a href="#l17.46"></a><span id="l17.46" class="difflineplus">+</span>
<a href="#l17.47"></a><span id="l17.47" class="difflineplus">+#else</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineplus">+</span>
<a href="#l17.49"></a><span id="l17.49" class="difflineplus">+#define JASSERT(cond) do { \</span>
<a href="#l17.50"></a><span id="l17.50" class="difflineplus">+		if (!(cond)) { \</span>
<a href="#l17.51"></a><span id="l17.51" class="difflineplus">+			mc_error(&quot;cjson assert failure %s:%d : cond \&quot;&quot; __STRING(cond) &quot;failed\n&quot;, __FILE__, __LINE__); \</span>
<a href="#l17.52"></a><span id="l17.52" class="difflineplus">+			*(int *)0 = 1;\</span>
<a href="#l17.53"></a><span id="l17.53" class="difflineplus">+			abort(); \</span>
<a href="#l17.54"></a><span id="l17.54" class="difflineplus">+		}\</span>
<a href="#l17.55"></a><span id="l17.55" class="difflineplus">+	} while(0)</span>
<a href="#l17.56"></a><span id="l17.56" class="difflineplus">+</span>
<a href="#l17.57"></a><span id="l17.57" class="difflineplus">+#endif</span>
<a href="#l17.58"></a><span id="l17.58" class="difflineplus">+</span>
<a href="#l17.59"></a><span id="l17.59" class="difflineplus">+#define MC_ERROR(x, ...) mc_error(x, ##__VA_ARGS__)</span>
<a href="#l17.60"></a><span id="l17.60" class="difflineplus">+</span>
<a href="#l17.61"></a><span id="l17.61" class="difflineplus">+#ifdef MC_MAINTAINER_MODE</span>
<a href="#l17.62"></a><span id="l17.62" class="difflineplus">+#define MC_SET_DEBUG(x) mc_set_debug(x)</span>
<a href="#l17.63"></a><span id="l17.63" class="difflineplus">+#define MC_GET_DEBUG() mc_get_debug()</span>
<a href="#l17.64"></a><span id="l17.64" class="difflineplus">+#define MC_SET_SYSLOG(x) mc_set_syslog(x)</span>
<a href="#l17.65"></a><span id="l17.65" class="difflineplus">+#define MC_DEBUG(x, ...) mc_debug(x, ##__VA_ARGS__)</span>
<a href="#l17.66"></a><span id="l17.66" class="difflineplus">+#define MC_INFO(x, ...) mc_info(x, ##__VA_ARGS__)</span>
<a href="#l17.67"></a><span id="l17.67" class="difflineplus">+#else</span>
<a href="#l17.68"></a><span id="l17.68" class="difflineplus">+#define MC_SET_DEBUG(x) if (0) mc_set_debug(x)</span>
<a href="#l17.69"></a><span id="l17.69" class="difflineplus">+#define MC_GET_DEBUG() (0)</span>
<a href="#l17.70"></a><span id="l17.70" class="difflineplus">+#define MC_SET_SYSLOG(x) if (0) mc_set_syslog(x)</span>
<a href="#l17.71"></a><span id="l17.71" class="difflineplus">+#define MC_DEBUG(x, ...) if (0) mc_debug(x, ##__VA_ARGS__)</span>
<a href="#l17.72"></a><span id="l17.72" class="difflineplus">+#define MC_INFO(x, ...) if (0) mc_info(x, ##__VA_ARGS__)</span>
<a href="#l17.73"></a><span id="l17.73" class="difflineplus">+#endif</span>
<a href="#l17.74"></a><span id="l17.74" class="difflineplus">+</span>
<a href="#l17.75"></a><span id="l17.75" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l17.76"></a><span id="l17.76" class="difflineplus">+}</span>
<a href="#l17.77"></a><span id="l17.77" class="difflineplus">+#endif</span>
<a href="#l17.78"></a><span id="l17.78" class="difflineplus">+</span>
<a href="#l17.79"></a><span id="l17.79" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1">new file mode 100644</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineminus">--- /dev/null</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineplus">+++ b/third_party/json-c/issues_closed_for_0.13.md</span>
<a href="#l18.4"></a><span id="l18.4" class="difflineat">@@ -0,0 +1,267 @@</span>
<a href="#l18.5"></a><span id="l18.5" class="difflineplus">+</span>
<a href="#l18.6"></a><span id="l18.6" class="difflineplus">+This list was created with:</span>
<a href="#l18.7"></a><span id="l18.7" class="difflineplus">+</span>
<a href="#l18.8"></a><span id="l18.8" class="difflineplus">+curl https://api.github.com/search/issues?q=&quot;repo%3Ajson-c%2Fjson-c+closed%3A&gt;2014-04-10+created%3A&lt;2017-12-01&amp;sort=created&amp;order=asc&amp;per_page=400&amp;page=1&quot; &gt; issues1.out</span>
<a href="#l18.9"></a><span id="l18.9" class="difflineplus">+curl https://api.github.com/search/issues?q=&quot;repo%3Ajson-c%2Fjson-c+closed%3A&gt;2014-04-10+created%3A&lt;2017-12-01&amp;sort=created&amp;order=asc&amp;per_page=400&amp;page=2&quot; &gt; issues2.out</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineplus">+curl https://api.github.com/search/issues?q=&quot;repo%3Ajson-c%2Fjson-c+closed%3A&gt;2014-04-10+created%3A&lt;2017-12-01&amp;sort=created&amp;order=asc&amp;per_page=400&amp;page=3&quot; &gt; issues3.out</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineplus">+jq -r '.items[] | &quot;[&quot; + .title + &quot;](&quot; + .url + &quot;)&quot; | tostring' issues?.out  &gt; issues.md</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineplus">+#... manual editing ...</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineplus">+----</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineplus">+</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineplus">+Issues and Pull Requests closed for the 0.13 release</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineplus">+(since commit f84d9c, the 0.12 branch point, 2014-04-10)</span>
<a href="#l18.18"></a><span id="l18.18" class="difflineplus">+</span>
<a href="#l18.19"></a><span id="l18.19" class="difflineplus">+[Make json_object_object_add() indicate success or failure, test fix](https://api.github.com/repos/json-c/json-c/issues/61)</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineplus">+[Build fixes (make dist and make distcheck)](https://api.github.com/repos/json-c/json-c/issues/113)</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineplus">+[Fixing build](https://api.github.com/repos/json-c/json-c/issues/124)</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineplus">+[Fix compile error(variable size set but not used) on g++4.6](https://api.github.com/repos/json-c/json-c/issues/125)</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineplus">+[Removed unused size variable.](https://api.github.com/repos/json-c/json-c/issues/126)</span>
<a href="#l18.24"></a><span id="l18.24" class="difflineplus">+[remove unused `size` variable](https://api.github.com/repos/json-c/json-c/issues/127)</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineplus">+[Remove unused variable from json_tokenizer.c](https://api.github.com/repos/json-c/json-c/issues/128)</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineplus">+[Failed to compile under Ubuntu 13.10 32bit](https://api.github.com/repos/json-c/json-c/issues/130)</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineplus">+[undefined symbol: __sync_val_compare_and_swap_4 ](https://api.github.com/repos/json-c/json-c/issues/131)</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineplus">+[Remove unused variable 'size'](https://api.github.com/repos/json-c/json-c/issues/132)</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineplus">+[Update and rename README to README.md](https://api.github.com/repos/json-c/json-c/issues/133)</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineplus">+[Must remove variable size...](https://api.github.com/repos/json-c/json-c/issues/134)</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+[bits.h uses removed json_tokener_errors\[error\]](https://api.github.com/repos/json-c/json-c/issues/135)</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineplus">+[Error when running make check](https://api.github.com/repos/json-c/json-c/issues/136)</span>
<a href="#l18.33"></a><span id="l18.33" class="difflineplus">+[config.h.in should not be in git](https://api.github.com/repos/json-c/json-c/issues/137)</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineplus">+[Can't build on RHEL 6.5 due to dependency on automake-1.14](https://api.github.com/repos/json-c/json-c/issues/138)</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineplus">+[Code bug in random_test.c evaluating same expression twice ](https://api.github.com/repos/json-c/json-c/issues/140)</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineplus">+[Removed duplicate check in random_seed test - bug #140](https://api.github.com/repos/json-c/json-c/issues/141)</span>
<a href="#l18.37"></a><span id="l18.37" class="difflineplus">+[Please undeprecate json_object_object_get](https://api.github.com/repos/json-c/json-c/issues/142)</span>
<a href="#l18.38"></a><span id="l18.38" class="difflineplus">+[Introduce json_object_from_fd](https://api.github.com/repos/json-c/json-c/issues/144)</span>
<a href="#l18.39"></a><span id="l18.39" class="difflineplus">+[Handle % character properly](https://api.github.com/repos/json-c/json-c/issues/145)</span>
<a href="#l18.40"></a><span id="l18.40" class="difflineplus">+[TAGS rename](https://api.github.com/repos/json-c/json-c/issues/146)</span>
<a href="#l18.41"></a><span id="l18.41" class="difflineplus">+[Bump the soname](https://api.github.com/repos/json-c/json-c/issues/148)</span>
<a href="#l18.42"></a><span id="l18.42" class="difflineplus">+[SONAME bump](https://api.github.com/repos/json-c/json-c/issues/149)</span>
<a href="#l18.43"></a><span id="l18.43" class="difflineplus">+[Fix build using MinGW.](https://api.github.com/repos/json-c/json-c/issues/150)</span>
<a href="#l18.44"></a><span id="l18.44" class="difflineplus">+[Remove json_type enum trailing comma](https://api.github.com/repos/json-c/json-c/issues/151)</span>
<a href="#l18.45"></a><span id="l18.45" class="difflineplus">+[error while compiling json-c library version 0.11](https://api.github.com/repos/json-c/json-c/issues/152)</span>
<a href="#l18.46"></a><span id="l18.46" class="difflineplus">+[improve doc for json_object_to_json_string()](https://api.github.com/repos/json-c/json-c/issues/153)</span>
<a href="#l18.47"></a><span id="l18.47" class="difflineplus">+[double precision](https://api.github.com/repos/json-c/json-c/issues/154)</span>
<a href="#l18.48"></a><span id="l18.48" class="difflineplus">+[add bsearch for arrays](https://api.github.com/repos/json-c/json-c/issues/155)</span>
<a href="#l18.49"></a><span id="l18.49" class="difflineplus">+[Remove trailing whitespaces](https://api.github.com/repos/json-c/json-c/issues/156)</span>
<a href="#l18.50"></a><span id="l18.50" class="difflineplus">+[JSON-C shall not exit on calloc fail.](https://api.github.com/repos/json-c/json-c/issues/157)</span>
<a href="#l18.51"></a><span id="l18.51" class="difflineplus">+[while using json-c 0.11, I am facing strange crash issue in json_object_put.](https://api.github.com/repos/json-c/json-c/issues/158)</span>
<a href="#l18.52"></a><span id="l18.52" class="difflineplus">+[json_tokener.c compile error](https://api.github.com/repos/json-c/json-c/issues/159)</span>
<a href="#l18.53"></a><span id="l18.53" class="difflineplus">+[missing header file on windows??](https://api.github.com/repos/json-c/json-c/issues/160)</span>
<a href="#l18.54"></a><span id="l18.54" class="difflineplus">+[Is there a way to append to file?](https://api.github.com/repos/json-c/json-c/issues/161)</span>
<a href="#l18.55"></a><span id="l18.55" class="difflineplus">+[json_util: add directory check for POSIX distros](https://api.github.com/repos/json-c/json-c/issues/162)</span>
<a href="#l18.56"></a><span id="l18.56" class="difflineplus">+[Fix Win32 build problems](https://api.github.com/repos/json-c/json-c/issues/163)</span>
<a href="#l18.57"></a><span id="l18.57" class="difflineplus">+[made it compile and link on Widnows (as static library)](https://api.github.com/repos/json-c/json-c/issues/164)</span>
<a href="#l18.58"></a><span id="l18.58" class="difflineplus">+[json_object_to_json_string_ext length](https://api.github.com/repos/json-c/json-c/issues/165)</span>
<a href="#l18.59"></a><span id="l18.59" class="difflineplus">+[Can't build on Windows with Visual Studio 2010](https://api.github.com/repos/json-c/json-c/issues/167)</span>
<a href="#l18.60"></a><span id="l18.60" class="difflineplus">+[Tightening the number parsing algorithm](https://api.github.com/repos/json-c/json-c/issues/168)</span>
<a href="#l18.61"></a><span id="l18.61" class="difflineplus">+[Doesn't compile on ubuntu 14.04, 64bit](https://api.github.com/repos/json-c/json-c/issues/169)</span>
<a href="#l18.62"></a><span id="l18.62" class="difflineplus">+[Generated files in repository](https://api.github.com/repos/json-c/json-c/issues/170)</span>
<a href="#l18.63"></a><span id="l18.63" class="difflineplus">+[Update configuration for VS2010 and win64](https://api.github.com/repos/json-c/json-c/issues/171)</span>
<a href="#l18.64"></a><span id="l18.64" class="difflineplus">+[Adding support for parsing octal numbers](https://api.github.com/repos/json-c/json-c/issues/172)</span>
<a href="#l18.65"></a><span id="l18.65" class="difflineplus">+[json_parse_int64 doesn't work correctly at illumos](https://api.github.com/repos/json-c/json-c/issues/173)</span>
<a href="#l18.66"></a><span id="l18.66" class="difflineplus">+[Adding JSON_C_TO_STRING_PRETTY_TAB flag](https://api.github.com/repos/json-c/json-c/issues/174)</span>
<a href="#l18.67"></a><span id="l18.67" class="difflineplus">+[make check fails 4 tests with overflows when built with ASAN](https://api.github.com/repos/json-c/json-c/issues/175)</span>
<a href="#l18.68"></a><span id="l18.68" class="difflineplus">+[Possible to delete an array element at a given idx ?](https://api.github.com/repos/json-c/json-c/issues/176)</span>
<a href="#l18.69"></a><span id="l18.69" class="difflineplus">+[Fix compiler warnings](https://api.github.com/repos/json-c/json-c/issues/177)</span>
<a href="#l18.70"></a><span id="l18.70" class="difflineplus">+[Unable to compile on CentOS5](https://api.github.com/repos/json-c/json-c/issues/178)</span>
<a href="#l18.71"></a><span id="l18.71" class="difflineplus">+[Added array_list_del_idx and json_object_array_del_idx](https://api.github.com/repos/json-c/json-c/issues/179)</span>
<a href="#l18.72"></a><span id="l18.72" class="difflineplus">+[Enable silent build by default](https://api.github.com/repos/json-c/json-c/issues/180)</span>
<a href="#l18.73"></a><span id="l18.73" class="difflineplus">+[json_tokener_parse_ex accepts invalid JSON](https://api.github.com/repos/json-c/json-c/issues/181)</span>
<a href="#l18.74"></a><span id="l18.74" class="difflineplus">+[Link against libm when needed](https://api.github.com/repos/json-c/json-c/issues/182)</span>
<a href="#l18.75"></a><span id="l18.75" class="difflineplus">+[Apply compile warning fix to master branch](https://api.github.com/repos/json-c/json-c/issues/183)</span>
<a href="#l18.76"></a><span id="l18.76" class="difflineplus">+[Use only GCC-specific flags when compiling with GCC](https://api.github.com/repos/json-c/json-c/issues/184)</span>
<a href="#l18.77"></a><span id="l18.77" class="difflineplus">+[compile error](https://api.github.com/repos/json-c/json-c/issues/185)</span>
<a href="#l18.78"></a><span id="l18.78" class="difflineplus">+[Syntax error](https://api.github.com/repos/json-c/json-c/issues/186)</span>
<a href="#l18.79"></a><span id="l18.79" class="difflineplus">+[array_list_get_idx and negative indexes.](https://api.github.com/repos/json-c/json-c/issues/187)</span>
<a href="#l18.80"></a><span id="l18.80" class="difflineplus">+[json_object_object_foreach warnings](https://api.github.com/repos/json-c/json-c/issues/188)</span>
<a href="#l18.81"></a><span id="l18.81" class="difflineplus">+[noisy json_object_from_file: error opening file](https://api.github.com/repos/json-c/json-c/issues/189)</span>
<a href="#l18.82"></a><span id="l18.82" class="difflineplus">+[warning: initialization discards const qualifier from pointer target type \[enabled by default\]](https://api.github.com/repos/json-c/json-c/issues/190)</span>
<a href="#l18.83"></a><span id="l18.83" class="difflineplus">+[json_tokener_parse  accepts invalid JSON {&quot;key&quot;: &quot;value&quot; ,  }](https://api.github.com/repos/json-c/json-c/issues/192)</span>
<a href="#l18.84"></a><span id="l18.84" class="difflineplus">+[Make serialization format of doubles configurable](https://api.github.com/repos/json-c/json-c/issues/193)</span>
<a href="#l18.85"></a><span id="l18.85" class="difflineplus">+[Add utility function for comparing json_objects](https://api.github.com/repos/json-c/json-c/issues/194)</span>
<a href="#l18.86"></a><span id="l18.86" class="difflineplus">+[Call uselocale instead of setlocale](https://api.github.com/repos/json-c/json-c/issues/195)</span>
<a href="#l18.87"></a><span id="l18.87" class="difflineplus">+[Performance improvements](https://api.github.com/repos/json-c/json-c/issues/196)</span>
<a href="#l18.88"></a><span id="l18.88" class="difflineplus">+[Time for a new release?](https://api.github.com/repos/json-c/json-c/issues/197)</span>
<a href="#l18.89"></a><span id="l18.89" class="difflineplus">+[Fix possible memory leak and remove superfluous NULL checks before free()](https://api.github.com/repos/json-c/json-c/issues/198)</span>
<a href="#l18.90"></a><span id="l18.90" class="difflineplus">+[Fix build in Visual Studio](https://api.github.com/repos/json-c/json-c/issues/199)</span>
<a href="#l18.91"></a><span id="l18.91" class="difflineplus">+[Add build scripts for CI platforms](https://api.github.com/repos/json-c/json-c/issues/200)</span>
<a href="#l18.92"></a><span id="l18.92" class="difflineplus">+[disable forward-slash escaping?](https://api.github.com/repos/json-c/json-c/issues/201)</span>
<a href="#l18.93"></a><span id="l18.93" class="difflineplus">+[Array with objects support](https://api.github.com/repos/json-c/json-c/issues/202)</span>
<a href="#l18.94"></a><span id="l18.94" class="difflineplus">+[Add source position/coordinates to API](https://api.github.com/repos/json-c/json-c/issues/203)</span>
<a href="#l18.95"></a><span id="l18.95" class="difflineplus">+[json-c/json.h not found ](https://api.github.com/repos/json-c/json-c/issues/204)</span>
<a href="#l18.96"></a><span id="l18.96" class="difflineplus">+[json-c Compiled with Visual Studios](https://api.github.com/repos/json-c/json-c/issues/205)</span>
<a href="#l18.97"></a><span id="l18.97" class="difflineplus">+[what do i use in place of json_object_object_get?](https://api.github.com/repos/json-c/json-c/issues/206)</span>
<a href="#l18.98"></a><span id="l18.98" class="difflineplus">+[Add support for property pairs directly added to arrays](https://api.github.com/repos/json-c/json-c/issues/207)</span>
<a href="#l18.99"></a><span id="l18.99" class="difflineplus">+[Performance enhancements (mainly) to json_object_to_json_string()](https://api.github.com/repos/json-c/json-c/issues/208)</span>
<a href="#l18.100"></a><span id="l18.100" class="difflineplus">+[fix regression from 2d549662be832da838aa063da2efa78ee3b99668](https://api.github.com/repos/json-c/json-c/issues/209)</span>
<a href="#l18.101"></a><span id="l18.101" class="difflineplus">+[Use size_t for arrays](https://api.github.com/repos/json-c/json-c/issues/210)</span>
<a href="#l18.102"></a><span id="l18.102" class="difflineplus">+[Atomic updates for the refcount](https://api.github.com/repos/json-c/json-c/issues/211)</span>
<a href="#l18.103"></a><span id="l18.103" class="difflineplus">+[Refcount doesn't work between threads](https://api.github.com/repos/json-c/json-c/issues/212)</span>
<a href="#l18.104"></a><span id="l18.104" class="difflineplus">+[fix to compile with microsoft visual c++ 2010](https://api.github.com/repos/json-c/json-c/issues/213)</span>
<a href="#l18.105"></a><span id="l18.105" class="difflineplus">+[Some non-GNU systems support __sync_val_compare_and_swap](https://api.github.com/repos/json-c/json-c/issues/214)</span>
<a href="#l18.106"></a><span id="l18.106" class="difflineplus">+[Build json-c for window 64 bit.](https://api.github.com/repos/json-c/json-c/issues/215)</span>
<a href="#l18.107"></a><span id="l18.107" class="difflineplus">+[configure: check realloc with AC_CHECK_FUNCS() to fix cross-compilation.](https://api.github.com/repos/json-c/json-c/issues/216)</span>
<a href="#l18.108"></a><span id="l18.108" class="difflineplus">+[Checking for functions in float.h](https://api.github.com/repos/json-c/json-c/issues/217)</span>
<a href="#l18.109"></a><span id="l18.109" class="difflineplus">+[Use a macro to indicate C99 to the compiler](https://api.github.com/repos/json-c/json-c/issues/218)</span>
<a href="#l18.110"></a><span id="l18.110" class="difflineplus">+[Fix various potential null ptr deref and int32 overflows](https://api.github.com/repos/json-c/json-c/issues/219)</span>
<a href="#l18.111"></a><span id="l18.111" class="difflineplus">+[Add utility function for comparing json_objects](https://api.github.com/repos/json-c/json-c/issues/220)</span>
<a href="#l18.112"></a><span id="l18.112" class="difflineplus">+[JSON_C_TO_STRING_NOSLASHESCAPE works incorrectly](https://api.github.com/repos/json-c/json-c/issues/221)</span>
<a href="#l18.113"></a><span id="l18.113" class="difflineplus">+[Fix issue #221: JSON_C_TO_STRING_NOSLASHESCAPE works incorrectly](https://api.github.com/repos/json-c/json-c/issues/222)</span>
<a href="#l18.114"></a><span id="l18.114" class="difflineplus">+[Clarify json_object_get_string documentation of NULL handling &amp; return](https://api.github.com/repos/json-c/json-c/issues/223)</span>
<a href="#l18.115"></a><span id="l18.115" class="difflineplus">+[json_tokener.c - all warnings being treated as errors](https://api.github.com/repos/json-c/json-c/issues/224)</span>
<a href="#l18.116"></a><span id="l18.116" class="difflineplus">+[Hi, will you support clib as a &quot;registry&quot;?](https://api.github.com/repos/json-c/json-c/issues/225)</span>
<a href="#l18.117"></a><span id="l18.117" class="difflineplus">+[Bump SOVERSION to 3](https://api.github.com/repos/json-c/json-c/issues/227)</span>
<a href="#l18.118"></a><span id="l18.118" class="difflineplus">+[avoid double slashes from json](https://api.github.com/repos/json-c/json-c/issues/228)</span>
<a href="#l18.119"></a><span id="l18.119" class="difflineplus">+[configure fails: checking size of size_t... configure: error: cannot determine a size for size_t](https://api.github.com/repos/json-c/json-c/issues/229)</span>
<a href="#l18.120"></a><span id="l18.120" class="difflineplus">+[Use stdint.h to check for size_t size](https://api.github.com/repos/json-c/json-c/issues/230)</span>
<a href="#l18.121"></a><span id="l18.121" class="difflineplus">+[Fix size_t size check for first-time builds](https://api.github.com/repos/json-c/json-c/issues/231)</span>
<a href="#l18.122"></a><span id="l18.122" class="difflineplus">+[tests/tests1: fix printf format for size_t arguments](https://api.github.com/repos/json-c/json-c/issues/232)</span>
<a href="#l18.123"></a><span id="l18.123" class="difflineplus">+[Include stddef.h in json_object.h](https://api.github.com/repos/json-c/json-c/issues/233)</span>
<a href="#l18.124"></a><span id="l18.124" class="difflineplus">+[Add public API to use userdata independently of custom serializer](https://api.github.com/repos/json-c/json-c/issues/234)</span>
<a href="#l18.125"></a><span id="l18.125" class="difflineplus">+[Undefined symbols Error for architecture x86_64 on Mac ](https://api.github.com/repos/json-c/json-c/issues/235)</span>
<a href="#l18.126"></a><span id="l18.126" class="difflineplus">+[Building a project which uses json-c with flag -Wcast-qual causes compilation errors](https://api.github.com/repos/json-c/json-c/issues/236)</span>
<a href="#l18.127"></a><span id="l18.127" class="difflineplus">+[handle escaped utf-8](https://api.github.com/repos/json-c/json-c/issues/237)</span>
<a href="#l18.128"></a><span id="l18.128" class="difflineplus">+[linkhash.c: optimised the table_free path](https://api.github.com/repos/json-c/json-c/issues/238)</span>
<a href="#l18.129"></a><span id="l18.129" class="difflineplus">+[initialize null terminator of new printbuf](https://api.github.com/repos/json-c/json-c/issues/239)</span>
<a href="#l18.130"></a><span id="l18.130" class="difflineplus">+[Compile error: Variable set but not used](https://api.github.com/repos/json-c/json-c/issues/240)</span>
<a href="#l18.131"></a><span id="l18.131" class="difflineplus">+[getting error in date string 19\/07\/2016, fixed for error 19/07/2016](https://api.github.com/repos/json-c/json-c/issues/241)</span>
<a href="#l18.132"></a><span id="l18.132" class="difflineplus">+[json_tokener_parse error](https://api.github.com/repos/json-c/json-c/issues/242)</span>
<a href="#l18.133"></a><span id="l18.133" class="difflineplus">+[Fix #165](https://api.github.com/repos/json-c/json-c/issues/243)</span>
<a href="#l18.134"></a><span id="l18.134" class="difflineplus">+[Error while compiling source from RHEL5, could you please help me to fix this ](https://api.github.com/repos/json-c/json-c/issues/244)</span>
<a href="#l18.135"></a><span id="l18.135" class="difflineplus">+[json-c compile in window xp](https://api.github.com/repos/json-c/json-c/issues/245)</span>
<a href="#l18.136"></a><span id="l18.136" class="difflineplus">+[Mac: uselocale failed to build](https://api.github.com/repos/json-c/json-c/issues/246)</span>
<a href="#l18.137"></a><span id="l18.137" class="difflineplus">+[json_object_array_del_idx function has segment fault error?](https://api.github.com/repos/json-c/json-c/issues/247)</span>
<a href="#l18.138"></a><span id="l18.138" class="difflineplus">+[Minor changes in C source code](https://api.github.com/repos/json-c/json-c/issues/248)</span>
<a href="#l18.139"></a><span id="l18.139" class="difflineplus">+[Improving README](https://api.github.com/repos/json-c/json-c/issues/249)</span>
<a href="#l18.140"></a><span id="l18.140" class="difflineplus">+[Improving .gitignore](https://api.github.com/repos/json-c/json-c/issues/250)</span>
<a href="#l18.141"></a><span id="l18.141" class="difflineplus">+[Adding a file for EditorConfig](https://api.github.com/repos/json-c/json-c/issues/251)</span>
<a href="#l18.142"></a><span id="l18.142" class="difflineplus">+[Very minor changes not related to C source code](https://api.github.com/repos/json-c/json-c/issues/252)</span>
<a href="#l18.143"></a><span id="l18.143" class="difflineplus">+[Adding a test with cppcheck for Travis CI](https://api.github.com/repos/json-c/json-c/issues/253)</span>
<a href="#l18.144"></a><span id="l18.144" class="difflineplus">+[Very minor changes to some tests](https://api.github.com/repos/json-c/json-c/issues/254)</span>
<a href="#l18.145"></a><span id="l18.145" class="difflineplus">+[Minor changes in C source code](https://api.github.com/repos/json-c/json-c/issues/255)</span>
<a href="#l18.146"></a><span id="l18.146" class="difflineplus">+[Mailing list dead?](https://api.github.com/repos/json-c/json-c/issues/256)</span>
<a href="#l18.147"></a><span id="l18.147" class="difflineplus">+[Defining a coding style](https://api.github.com/repos/json-c/json-c/issues/257)</span>
<a href="#l18.148"></a><span id="l18.148" class="difflineplus">+[Enable CI services](https://api.github.com/repos/json-c/json-c/issues/258)</span>
<a href="#l18.149"></a><span id="l18.149" class="difflineplus">+[Fails to parse valid json](https://api.github.com/repos/json-c/json-c/issues/259)</span>
<a href="#l18.150"></a><span id="l18.150" class="difflineplus">+[Adding an object to itself](https://api.github.com/repos/json-c/json-c/issues/260)</span>
<a href="#l18.151"></a><span id="l18.151" class="difflineplus">+[Lack of proper documentation](https://api.github.com/repos/json-c/json-c/issues/261)</span>
<a href="#l18.152"></a><span id="l18.152" class="difflineplus">+[Add Cmakefile and fix compiler warning.](https://api.github.com/repos/json-c/json-c/issues/262)</span>
<a href="#l18.153"></a><span id="l18.153" class="difflineplus">+[Compiler Warnings with VS2015](https://api.github.com/repos/json-c/json-c/issues/263)</span>
<a href="#l18.154"></a><span id="l18.154" class="difflineplus">+[successed in simple test   while failed in my project](https://api.github.com/repos/json-c/json-c/issues/264)</span>
<a href="#l18.155"></a><span id="l18.155" class="difflineplus">+[Conformance report for reference](https://api.github.com/repos/json-c/json-c/issues/265)</span>
<a href="#l18.156"></a><span id="l18.156" class="difflineplus">+[crash perhaps related to reference counting](https://api.github.com/repos/json-c/json-c/issues/266)</span>
<a href="#l18.157"></a><span id="l18.157" class="difflineplus">+[Removes me as Win32 maintainer, because I'm not.](https://api.github.com/repos/json-c/json-c/issues/267)</span>
<a href="#l18.158"></a><span id="l18.158" class="difflineplus">+[Documentation of json_object_to_json_string gives no information about memory management](https://api.github.com/repos/json-c/json-c/issues/268)</span>
<a href="#l18.159"></a><span id="l18.159" class="difflineplus">+[json_object_&lt;type&gt;_set(json_object *o,&lt;type&gt; value) API for value setting in json object private structure](https://api.github.com/repos/json-c/json-c/issues/269)</span>
<a href="#l18.160"></a><span id="l18.160" class="difflineplus">+[new API json_object_new_double_f(doubel d,const char * fmt);](https://api.github.com/repos/json-c/json-c/issues/270)</span>
<a href="#l18.161"></a><span id="l18.161" class="difflineplus">+[Cannot compile using CMake on macOS](https://api.github.com/repos/json-c/json-c/issues/271)</span>
<a href="#l18.162"></a><span id="l18.162" class="difflineplus">+[fixed wrong object name in json_object_all_values_equal](https://api.github.com/repos/json-c/json-c/issues/273)</span>
<a href="#l18.163"></a><span id="l18.163" class="difflineplus">+[Support for 64 bit pointers on Windows](https://api.github.com/repos/json-c/json-c/issues/274)</span>
<a href="#l18.164"></a><span id="l18.164" class="difflineplus">+[Out-of-bounds read in json_tokener_parse_ex](https://api.github.com/repos/json-c/json-c/issues/275)</span>
<a href="#l18.165"></a><span id="l18.165" class="difflineplus">+[ ./configure for centos release 6.7(final) failure](https://api.github.com/repos/json-c/json-c/issues/276)</span>
<a href="#l18.166"></a><span id="l18.166" class="difflineplus">+[Json object set xxx](https://api.github.com/repos/json-c/json-c/issues/277)</span>
<a href="#l18.167"></a><span id="l18.167" class="difflineplus">+[Serialization of double with no fractional component drops trailing zero](https://api.github.com/repos/json-c/json-c/issues/278)</span>
<a href="#l18.168"></a><span id="l18.168" class="difflineplus">+[Segmentation fault in array_list_length()](https://api.github.com/repos/json-c/json-c/issues/279)</span>
<a href="#l18.169"></a><span id="l18.169" class="difflineplus">+[Should json_object_array_get_idx  check whether input obj is array? ](https://api.github.com/repos/json-c/json-c/issues/280)</span>
<a href="#l18.170"></a><span id="l18.170" class="difflineplus">+[how to pretty print json-c? ](https://api.github.com/repos/json-c/json-c/issues/281)</span>
<a href="#l18.171"></a><span id="l18.171" class="difflineplus">+[ignore temporary files](https://api.github.com/repos/json-c/json-c/issues/282)</span>
<a href="#l18.172"></a><span id="l18.172" class="difflineplus">+[json_pointer: add first revision based on RFC 6901](https://api.github.com/repos/json-c/json-c/issues/283)</span>
<a href="#l18.173"></a><span id="l18.173" class="difflineplus">+[Resusing  json_tokener object](https://api.github.com/repos/json-c/json-c/issues/284)</span>
<a href="#l18.174"></a><span id="l18.174" class="difflineplus">+[Revert &quot;compat/strdup.h: move common compat check for strdup() to own](https://api.github.com/repos/json-c/json-c/issues/285)</span>
<a href="#l18.175"></a><span id="l18.175" class="difflineplus">+[json_tokener_parse_ex() returns json_tokener_continue on zero-length string](https://api.github.com/repos/json-c/json-c/issues/286)</span>
<a href="#l18.176"></a><span id="l18.176" class="difflineplus">+[json_pointer: extend setter &amp; getter with printf() style arguments](https://api.github.com/repos/json-c/json-c/issues/287)</span>
<a href="#l18.177"></a><span id="l18.177" class="difflineplus">+[Fix _GNU_SOURCE define for vasprintf](https://api.github.com/repos/json-c/json-c/issues/288)</span>
<a href="#l18.178"></a><span id="l18.178" class="difflineplus">+[bugfix: floating point representaion without fractional part ](https://api.github.com/repos/json-c/json-c/issues/289)</span>
<a href="#l18.179"></a><span id="l18.179" class="difflineplus">+[duplicate an json_object](https://api.github.com/repos/json-c/json-c/issues/290)</span>
<a href="#l18.180"></a><span id="l18.180" class="difflineplus">+[isspace assert error](https://api.github.com/repos/json-c/json-c/issues/291)</span>
<a href="#l18.181"></a><span id="l18.181" class="difflineplus">+[configure error  &quot;./configure: line 13121: syntax error near unexpected token `-Wall'&quot;](https://api.github.com/repos/json-c/json-c/issues/292)</span>
<a href="#l18.182"></a><span id="l18.182" class="difflineplus">+[how to make with bitcode for ios](https://api.github.com/repos/json-c/json-c/issues/293)</span>
<a href="#l18.183"></a><span id="l18.183" class="difflineplus">+[Adding UTF-8 validation.  Fixes #122](https://api.github.com/repos/json-c/json-c/issues/294)</span>
<a href="#l18.184"></a><span id="l18.184" class="difflineplus">+[cross compile w/ mingw](https://api.github.com/repos/json-c/json-c/issues/295)</span>
<a href="#l18.185"></a><span id="l18.185" class="difflineplus">+[Missing functions header in json_object.h](https://api.github.com/repos/json-c/json-c/issues/296)</span>
<a href="#l18.186"></a><span id="l18.186" class="difflineplus">+[could not parse string to Json object? Like string str=\&quot;helloworld;E\\test\\log\\;end\&quot;](https://api.github.com/repos/json-c/json-c/issues/297)</span>
<a href="#l18.187"></a><span id="l18.187" class="difflineplus">+[Building using CMake doesn't work](https://api.github.com/repos/json-c/json-c/issues/298)</span>
<a href="#l18.188"></a><span id="l18.188" class="difflineplus">+[Improve json_object -&gt; string performance](https://api.github.com/repos/json-c/json-c/issues/299)</span>
<a href="#l18.189"></a><span id="l18.189" class="difflineplus">+[Running tests with MinGW build](https://api.github.com/repos/json-c/json-c/issues/300)</span>
<a href="#l18.190"></a><span id="l18.190" class="difflineplus">+[How to deep copy  json_object in C++ ?](https://api.github.com/repos/json-c/json-c/issues/301)</span>
<a href="#l18.191"></a><span id="l18.191" class="difflineplus">+[json_tokener_parse_ex doesn't parse JSON values](https://api.github.com/repos/json-c/json-c/issues/302)</span>
<a href="#l18.192"></a><span id="l18.192" class="difflineplus">+[fix doc in tokener header file](https://api.github.com/repos/json-c/json-c/issues/303)</span>
<a href="#l18.193"></a><span id="l18.193" class="difflineplus">+[(.text+0x72846): undefined reference to `is_error'](https://api.github.com/repos/json-c/json-c/issues/304)</span>
<a href="#l18.194"></a><span id="l18.194" class="difflineplus">+[Fix compilation without C-99 option](https://api.github.com/repos/json-c/json-c/issues/305)</span>
<a href="#l18.195"></a><span id="l18.195" class="difflineplus">+[./configure: line 12748 -error=deprecated-declarations](https://api.github.com/repos/json-c/json-c/issues/306)</span>
<a href="#l18.196"></a><span id="l18.196" class="difflineplus">+[Memory leak in json_tokener_parse](https://api.github.com/repos/json-c/json-c/issues/307)</span>
<a href="#l18.197"></a><span id="l18.197" class="difflineplus">+[AM_PROG_LIBTOOL not found on Linux](https://api.github.com/repos/json-c/json-c/issues/308)</span>
<a href="#l18.198"></a><span id="l18.198" class="difflineplus">+[GCC 7 reports various -Wimplicit-fallthrough= errors](https://api.github.com/repos/json-c/json-c/issues/309)</span>
<a href="#l18.199"></a><span id="l18.199" class="difflineplus">+[Add FALLTHRU comment to handle GCC7 warnings.](https://api.github.com/repos/json-c/json-c/issues/310)</span>
<a href="#l18.200"></a><span id="l18.200" class="difflineplus">+[Fix error C3688 when compiling on Visual Studio 2015](https://api.github.com/repos/json-c/json-c/issues/311)</span>
<a href="#l18.201"></a><span id="l18.201" class="difflineplus">+[Fix CMake Build process improved for MinGW and MSYS2](https://api.github.com/repos/json-c/json-c/issues/312)</span>
<a href="#l18.202"></a><span id="l18.202" class="difflineplus">+[VERBOSE=1 make check; tests/test_util_file.test.c and tests/test_util_file.expected out of sync](https://api.github.com/repos/json-c/json-c/issues/313)</span>
<a href="#l18.203"></a><span id="l18.203" class="difflineplus">+[Passing -1 to json_tokener_parse_ex is possibly unsafe](https://api.github.com/repos/json-c/json-c/issues/315)</span>
<a href="#l18.204"></a><span id="l18.204" class="difflineplus">+[Memory Returned by json_object_to_json_string not freed](https://api.github.com/repos/json-c/json-c/issues/316)</span>
<a href="#l18.205"></a><span id="l18.205" class="difflineplus">+[json_object_get_string gives segmentation error](https://api.github.com/repos/json-c/json-c/issues/317)</span>
<a href="#l18.206"></a><span id="l18.206" class="difflineplus">+[PVS-Studio static analyzer analyze results](https://api.github.com/repos/json-c/json-c/issues/318)</span>
<a href="#l18.207"></a><span id="l18.207" class="difflineplus">+[Windows: Fix dynamic library build with Visual Studio](https://api.github.com/repos/json-c/json-c/issues/319)</span>
<a href="#l18.208"></a><span id="l18.208" class="difflineplus">+[Can't compile in Mac OS X El Capitan](https://api.github.com/repos/json-c/json-c/issues/320)</span>
<a href="#l18.209"></a><span id="l18.209" class="difflineplus">+[build,cmake: fix vasprintf implicit definition and generate both static &amp; shared libs](https://api.github.com/repos/json-c/json-c/issues/321)</span>
<a href="#l18.210"></a><span id="l18.210" class="difflineplus">+[can not link with libjson-c.a](https://api.github.com/repos/json-c/json-c/issues/322)</span>
<a href="#l18.211"></a><span id="l18.211" class="difflineplus">+[implicit fallthrough detected by gcc 7.1](https://api.github.com/repos/json-c/json-c/issues/323)</span>
<a href="#l18.212"></a><span id="l18.212" class="difflineplus">+[JsonPath like function?](https://api.github.com/repos/json-c/json-c/issues/324)</span>
<a href="#l18.213"></a><span id="l18.213" class="difflineplus">+[Fix stack buffer overflow in json_object_double_to_json_string_format()](https://api.github.com/repos/json-c/json-c/issues/325)</span>
<a href="#l18.214"></a><span id="l18.214" class="difflineplus">+[why json-c so hard to compile](https://api.github.com/repos/json-c/json-c/issues/327)</span>
<a href="#l18.215"></a><span id="l18.215" class="difflineplus">+[json_object: implement json_object_deep_copy() function](https://api.github.com/repos/json-c/json-c/issues/328)</span>
<a href="#l18.216"></a><span id="l18.216" class="difflineplus">+[build,cmake: build,cmake: rename libjson-c-static.a to libjson-c.a](https://api.github.com/repos/json-c/json-c/issues/329)</span>
<a href="#l18.217"></a><span id="l18.217" class="difflineplus">+[tests: symlink basic tests to a single file that has the common code](https://api.github.com/repos/json-c/json-c/issues/330)</span>
<a href="#l18.218"></a><span id="l18.218" class="difflineplus">+[Safe use of snprintf() / vsnprintf() for Visual studio, and thread-safety fix](https://api.github.com/repos/json-c/json-c/issues/331)</span>
<a href="#l18.219"></a><span id="l18.219" class="difflineplus">+[Valgrind: invalid read after json_object_array_del_idx.](https://api.github.com/repos/json-c/json-c/issues/332)</span>
<a href="#l18.220"></a><span id="l18.220" class="difflineplus">+[Replace obsolete AM_PROG_LIBTOOL](https://api.github.com/repos/json-c/json-c/issues/333)</span>
<a href="#l18.221"></a><span id="l18.221" class="difflineplus">+[README.md: show build status tag from travis-ci.org](https://api.github.com/repos/json-c/json-c/issues/335)</span>
<a href="#l18.222"></a><span id="l18.222" class="difflineplus">+[tests: fix tests in travis-ci.org](https://api.github.com/repos/json-c/json-c/issues/336)</span>
<a href="#l18.223"></a><span id="l18.223" class="difflineplus">+[Synchronize &quot;potentially racy&quot; random seed in lh_char_hash()](https://api.github.com/repos/json-c/json-c/issues/337)</span>
<a href="#l18.224"></a><span id="l18.224" class="difflineplus">+[implement json_object_int_inc(json_object *, int64_t)](https://api.github.com/repos/json-c/json-c/issues/338)</span>
<a href="#l18.225"></a><span id="l18.225" class="difflineplus">+[Json schema validation](https://api.github.com/repos/json-c/json-c/issues/339)</span>
<a href="#l18.226"></a><span id="l18.226" class="difflineplus">+[strerror_override: add extern &quot;C&quot; and JSON_EXPORT specifiers for Visual C++ compilers](https://api.github.com/repos/json-c/json-c/issues/340)</span>
<a href="#l18.227"></a><span id="l18.227" class="difflineplus">+[character &quot;/&quot; parse as &quot;\/&quot;](https://api.github.com/repos/json-c/json-c/issues/341)</span>
<a href="#l18.228"></a><span id="l18.228" class="difflineplus">+[ No such file or directory &quot;/usr/include/json.h&quot;](https://api.github.com/repos/json-c/json-c/issues/342)</span>
<a href="#l18.229"></a><span id="l18.229" class="difflineplus">+[Can't parse json](https://api.github.com/repos/json-c/json-c/issues/343)</span>
<a href="#l18.230"></a><span id="l18.230" class="difflineplus">+[Fix Mingw build](https://api.github.com/repos/json-c/json-c/issues/344)</span>
<a href="#l18.231"></a><span id="l18.231" class="difflineplus">+[Fix make dist and make distcheck](https://api.github.com/repos/json-c/json-c/issues/345)</span>
<a href="#l18.232"></a><span id="l18.232" class="difflineplus">+[Clamp double to int32 when narrowing in json_object_get_int.](https://api.github.com/repos/json-c/json-c/issues/346)</span>
<a href="#l18.233"></a><span id="l18.233" class="difflineplus">+[MSVC linker error json_c_strerror](https://api.github.com/repos/json-c/json-c/issues/347)</span>
<a href="#l18.234"></a><span id="l18.234" class="difflineplus">+[why](https://api.github.com/repos/json-c/json-c/issues/348)</span>
<a href="#l18.235"></a><span id="l18.235" class="difflineplus">+[`missing` is missing?](https://api.github.com/repos/json-c/json-c/issues/349)</span>
<a href="#l18.236"></a><span id="l18.236" class="difflineplus">+[stderror-override and disable-shared](https://api.github.com/repos/json-c/json-c/issues/350)</span>
<a href="#l18.237"></a><span id="l18.237" class="difflineplus">+[SIZE_T_MAX redefined from limits.h](https://api.github.com/repos/json-c/json-c/issues/351)</span>
<a href="#l18.238"></a><span id="l18.238" class="difflineplus">+[`INSTALL` overrides an automake script.](https://api.github.com/repos/json-c/json-c/issues/352)</span>
<a href="#l18.239"></a><span id="l18.239" class="difflineplus">+[Documentation issues](https://api.github.com/repos/json-c/json-c/issues/353)</span>
<a href="#l18.240"></a><span id="l18.240" class="difflineplus">+[Fixes #351 #352 #353 ](https://api.github.com/repos/json-c/json-c/issues/354)</span>
<a href="#l18.241"></a><span id="l18.241" class="difflineplus">+[1.make it can been compiled with Visual Studio 2010 by modify the CMakeList.txt and others](https://api.github.com/repos/json-c/json-c/issues/355)</span>
<a href="#l18.242"></a><span id="l18.242" class="difflineplus">+[VS2008 test  test_util_file.cpp err!](https://api.github.com/repos/json-c/json-c/issues/356)</span>
<a href="#l18.243"></a><span id="l18.243" class="difflineplus">+[__json_c_strerror incompatibility with link-time optimization](https://api.github.com/repos/json-c/json-c/issues/357)</span>
<a href="#l18.244"></a><span id="l18.244" class="difflineplus">+[make issue](https://api.github.com/repos/json-c/json-c/issues/358)</span>
<a href="#l18.245"></a><span id="l18.245" class="difflineplus">+[update CMakeLists.txt for compile with visual studio at least 2010](https://api.github.com/repos/json-c/json-c/issues/359)</span>
<a href="#l18.246"></a><span id="l18.246" class="difflineplus">+[Use strtoll() to parse ints](https://api.github.com/repos/json-c/json-c/issues/360)</span>
<a href="#l18.247"></a><span id="l18.247" class="difflineplus">+[Fix double to int cast overflow in json_object_get_int64.](https://api.github.com/repos/json-c/json-c/issues/361)</span>
<a href="#l18.248"></a><span id="l18.248" class="difflineplus">+[CMake Package Config](https://api.github.com/repos/json-c/json-c/issues/362)</span>
<a href="#l18.249"></a><span id="l18.249" class="difflineplus">+[Issue #338, add json_object_add_int functions](https://api.github.com/repos/json-c/json-c/issues/363)</span>
<a href="#l18.250"></a><span id="l18.250" class="difflineplus">+[Cmake is Errir](https://api.github.com/repos/json-c/json-c/issues/364)</span>
<a href="#l18.251"></a><span id="l18.251" class="difflineplus">+[added fallthrough for gcc7](https://api.github.com/repos/json-c/json-c/issues/365)</span>
<a href="#l18.252"></a><span id="l18.252" class="difflineplus">+[how to check  the json string,crash!](https://api.github.com/repos/json-c/json-c/issues/366)</span>
<a href="#l18.253"></a><span id="l18.253" class="difflineplus">+[Is json-c support &quot;redirect&quot; semantic?](https://api.github.com/repos/json-c/json-c/issues/367)</span>
<a href="#l18.254"></a><span id="l18.254" class="difflineplus">+[Add examples](https://api.github.com/repos/json-c/json-c/issues/368)</span>
<a href="#l18.255"></a><span id="l18.255" class="difflineplus">+[How to build json-c library for android?](https://api.github.com/repos/json-c/json-c/issues/369)</span>
<a href="#l18.256"></a><span id="l18.256" class="difflineplus">+[Compiling using clang-cl](https://api.github.com/repos/json-c/json-c/issues/370)</span>
<a href="#l18.257"></a><span id="l18.257" class="difflineplus">+[Invalid parsing for Infinity with json-c 0.12](https://api.github.com/repos/json-c/json-c/issues/371)</span>
<a href="#l18.258"></a><span id="l18.258" class="difflineplus">+[Json-c 0.12: Fixed Infinity bug](https://api.github.com/repos/json-c/json-c/issues/372)</span>
<a href="#l18.259"></a><span id="l18.259" class="difflineplus">+[build: fix build on appveyor CI](https://api.github.com/repos/json-c/json-c/issues/373)</span>
<a href="#l18.260"></a><span id="l18.260" class="difflineplus">+[Undefined symbols for architecture x86_64:](https://api.github.com/repos/json-c/json-c/issues/374)</span>
<a href="#l18.261"></a><span id="l18.261" class="difflineplus">+[what would happened when json_object_object_add add the same key](https://api.github.com/repos/json-c/json-c/issues/375)</span>
<a href="#l18.262"></a><span id="l18.262" class="difflineplus">+[Eclipse error ](https://api.github.com/repos/json-c/json-c/issues/376)</span>
<a href="#l18.263"></a><span id="l18.263" class="difflineplus">+[on gcc 7.2.0 on my linux distribution with json-c  2013-04-02 source](https://api.github.com/repos/json-c/json-c/issues/377)</span>
<a href="#l18.264"></a><span id="l18.264" class="difflineplus">+[ Eclipse: library (libjson-c) not found, but configured](https://api.github.com/repos/json-c/json-c/issues/378)</span>
<a href="#l18.265"></a><span id="l18.265" class="difflineplus">+[error: this statement may fall through \[-Werror=implicit-fallthrough=\]](https://api.github.com/repos/json-c/json-c/issues/379)</span>
<a href="#l18.266"></a><span id="l18.266" class="difflineplus">+[Build on Windows](https://api.github.com/repos/json-c/json-c/issues/380)</span>
<a href="#l18.267"></a><span id="l18.267" class="difflineplus">+[Fix makedist](https://api.github.com/repos/json-c/json-c/issues/381)</span>
<a href="#l18.268"></a><span id="l18.268" class="difflineplus">+[Memory leak for json_tokener_parse_ex for version 0.12.1](https://api.github.com/repos/json-c/json-c/issues/382)</span>
<a href="#l18.269"></a><span id="l18.269" class="difflineplus">+[Fix a compiler warning.](https://api.github.com/repos/json-c/json-c/issues/383)</span>
<a href="#l18.270"></a><span id="l18.270" class="difflineplus">+[Fix a VS 2015 compiler warnings.](https://api.github.com/repos/json-c/json-c/issues/384)</span>
<a href="#l18.271"></a><span id="l18.271" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1">new file mode 100644</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineminus">--- /dev/null</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineplus">+++ b/third_party/json-c/json.h</span>
<a href="#l19.4"></a><span id="l19.4" class="difflineat">@@ -0,0 +1,38 @@</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineplus">+/*</span>
<a href="#l19.6"></a><span id="l19.6" class="difflineplus">+ * $Id: json.h,v 1.6 2006/01/26 02:16:28 mclark Exp $</span>
<a href="#l19.7"></a><span id="l19.7" class="difflineplus">+ *</span>
<a href="#l19.8"></a><span id="l19.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l19.9"></a><span id="l19.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l19.10"></a><span id="l19.10" class="difflineplus">+ * Copyright (c) 2009 Hewlett-Packard Development Company, L.P.</span>
<a href="#l19.11"></a><span id="l19.11" class="difflineplus">+ *</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+ *</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+ */</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineplus">+</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+/**</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineplus">+ * @file</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineplus">+ * @brief A convenience header that may be included instead of other individual ones.</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineplus">+ */</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineplus">+#ifndef _json_h_</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineplus">+#define _json_h_</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineplus">+</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l19.26"></a><span id="l19.26" class="difflineplus">+#endif</span>
<a href="#l19.27"></a><span id="l19.27" class="difflineplus">+</span>
<a href="#l19.28"></a><span id="l19.28" class="difflineplus">+#include &quot;debug.h&quot;</span>
<a href="#l19.29"></a><span id="l19.29" class="difflineplus">+#include &quot;linkhash.h&quot;</span>
<a href="#l19.30"></a><span id="l19.30" class="difflineplus">+#include &quot;arraylist.h&quot;</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineplus">+#include &quot;json_util.h&quot;</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineplus">+#include &quot;json_object.h&quot;</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineplus">+#include &quot;json_pointer.h&quot;</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineplus">+#include &quot;json_tokener.h&quot;</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineplus">+#include &quot;json_object_iterator.h&quot;</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineplus">+#include &quot;json_c_version.h&quot;</span>
<a href="#l19.37"></a><span id="l19.37" class="difflineplus">+</span>
<a href="#l19.38"></a><span id="l19.38" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l19.39"></a><span id="l19.39" class="difflineplus">+}</span>
<a href="#l19.40"></a><span id="l19.40" class="difflineplus">+#endif</span>
<a href="#l19.41"></a><span id="l19.41" class="difflineplus">+</span>
<a href="#l19.42"></a><span id="l19.42" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1">new file mode 100644</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineminus">--- /dev/null</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineplus">+++ b/third_party/json-c/json_c_version.c</span>
<a href="#l20.4"></a><span id="l20.4" class="difflineat">@@ -0,0 +1,20 @@</span>
<a href="#l20.5"></a><span id="l20.5" class="difflineplus">+/*</span>
<a href="#l20.6"></a><span id="l20.6" class="difflineplus">+ * Copyright (c) 2012 Eric Haszlakiewicz</span>
<a href="#l20.7"></a><span id="l20.7" class="difflineplus">+ *</span>
<a href="#l20.8"></a><span id="l20.8" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l20.9"></a><span id="l20.9" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l20.10"></a><span id="l20.10" class="difflineplus">+ */</span>
<a href="#l20.11"></a><span id="l20.11" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineplus">+</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+#include &quot;json_c_version.h&quot;</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineplus">+</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineplus">+const char *json_c_version(void)</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineplus">+{</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineplus">+	return JSON_C_VERSION;</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineplus">+}</span>
<a href="#l20.19"></a><span id="l20.19" class="difflineplus">+</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineplus">+int json_c_version_num(void)</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineplus">+{</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineplus">+	return JSON_C_VERSION_NUM;</span>
<a href="#l20.23"></a><span id="l20.23" class="difflineplus">+}</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1">new file mode 100644</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineminus">--- /dev/null</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineplus">+++ b/third_party/json-c/json_c_version.h</span>
<a href="#l21.4"></a><span id="l21.4" class="difflineat">@@ -0,0 +1,40 @@</span>
<a href="#l21.5"></a><span id="l21.5" class="difflineplus">+/*</span>
<a href="#l21.6"></a><span id="l21.6" class="difflineplus">+ * Copyright (c) 2012,2017 Eric Haszlakiewicz</span>
<a href="#l21.7"></a><span id="l21.7" class="difflineplus">+ *</span>
<a href="#l21.8"></a><span id="l21.8" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l21.9"></a><span id="l21.9" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l21.10"></a><span id="l21.10" class="difflineplus">+ */</span>
<a href="#l21.11"></a><span id="l21.11" class="difflineplus">+</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+/**</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+ * @file</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+ * @brief Methods for retrieving the json-c version.</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineplus">+ */</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineplus">+#ifndef _json_c_version_h_</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineplus">+#define _json_c_version_h_</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineplus">+</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineplus">+#define JSON_C_MAJOR_VERSION 0</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineplus">+#define JSON_C_MINOR_VERSION 13</span>
<a href="#l21.21"></a><span id="l21.21" class="difflineplus">+#define JSON_C_MICRO_VERSION 01</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineplus">+#define JSON_C_VERSION_NUM ((JSON_C_MAJOR_VERSION &lt;&lt; 16) | \</span>
<a href="#l21.23"></a><span id="l21.23" class="difflineplus">+                            (JSON_C_MINOR_VERSION &lt;&lt; 8) | \</span>
<a href="#l21.24"></a><span id="l21.24" class="difflineplus">+                            JSON_C_MICRO_VERSION)</span>
<a href="#l21.25"></a><span id="l21.25" class="difflineplus">+#define JSON_C_VERSION &quot;0.13.1&quot;</span>
<a href="#l21.26"></a><span id="l21.26" class="difflineplus">+</span>
<a href="#l21.27"></a><span id="l21.27" class="difflineplus">+/**</span>
<a href="#l21.28"></a><span id="l21.28" class="difflineplus">+ * @see JSON_C_VERSION</span>
<a href="#l21.29"></a><span id="l21.29" class="difflineplus">+ * @return the version of the json-c library as a string</span>
<a href="#l21.30"></a><span id="l21.30" class="difflineplus">+ */</span>
<a href="#l21.31"></a><span id="l21.31" class="difflineplus">+const char *json_c_version(void); /* Returns JSON_C_VERSION */</span>
<a href="#l21.32"></a><span id="l21.32" class="difflineplus">+</span>
<a href="#l21.33"></a><span id="l21.33" class="difflineplus">+/**</span>
<a href="#l21.34"></a><span id="l21.34" class="difflineplus">+ * The json-c version encoded into an int, with the low order 8 bits</span>
<a href="#l21.35"></a><span id="l21.35" class="difflineplus">+ * being the micro version, the next higher 8 bits being the minor version</span>
<a href="#l21.36"></a><span id="l21.36" class="difflineplus">+ * and the next higher 8 bits being the major version.</span>
<a href="#l21.37"></a><span id="l21.37" class="difflineplus">+ * For example, 7.12.99 would be 0x00070B63.</span>
<a href="#l21.38"></a><span id="l21.38" class="difflineplus">+ *</span>
<a href="#l21.39"></a><span id="l21.39" class="difflineplus">+ * @see JSON_C_VERSION_NUM</span>
<a href="#l21.40"></a><span id="l21.40" class="difflineplus">+ * @return the version of the json-c library as an int</span>
<a href="#l21.41"></a><span id="l21.41" class="difflineplus">+ */</span>
<a href="#l21.42"></a><span id="l21.42" class="difflineplus">+int json_c_version_num(void);     /* Returns JSON_C_VERSION_NUM */</span>
<a href="#l21.43"></a><span id="l21.43" class="difflineplus">+</span>
<a href="#l21.44"></a><span id="l21.44" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1">new file mode 100644</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineminus">--- /dev/null</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineplus">+++ b/third_party/json-c/json_config.h.in</span>
<a href="#l22.4"></a><span id="l22.4" class="difflineat">@@ -0,0 +1,3 @@</span>
<a href="#l22.5"></a><span id="l22.5" class="difflineplus">+</span>
<a href="#l22.6"></a><span id="l22.6" class="difflineplus">+/* Define to 1 if you have the &lt;inttypes.h&gt; header file. */</span>
<a href="#l22.7"></a><span id="l22.7" class="difflineplus">+#undef JSON_C_HAVE_INTTYPES_H</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1">new file mode 100644</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineminus">--- /dev/null</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineplus">+++ b/third_party/json-c/json_config.h.win32</span>
<a href="#l23.4"></a><span id="l23.4" class="difflineat">@@ -0,0 +1,5 @@</span>
<a href="#l23.5"></a><span id="l23.5" class="difflineplus">+</span>
<a href="#l23.6"></a><span id="l23.6" class="difflineplus">+/* Define to 1 if you have the &lt;inttypes.h&gt; header file. */</span>
<a href="#l23.7"></a><span id="l23.7" class="difflineplus">+#if defined(_MSC_VER) &amp;&amp; _MSC_VER &gt;= 1800</span>
<a href="#l23.8"></a><span id="l23.8" class="difflineplus">+#define JSON_C_HAVE_INTTYPES_H 1</span>
<a href="#l23.9"></a><span id="l23.9" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1">new file mode 100644</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineminus">--- /dev/null</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineplus">+++ b/third_party/json-c/json_inttypes.h</span>
<a href="#l24.4"></a><span id="l24.4" class="difflineat">@@ -0,0 +1,23 @@</span>
<a href="#l24.5"></a><span id="l24.5" class="difflineplus">+</span>
<a href="#l24.6"></a><span id="l24.6" class="difflineplus">+/**</span>
<a href="#l24.7"></a><span id="l24.7" class="difflineplus">+ * @file</span>
<a href="#l24.8"></a><span id="l24.8" class="difflineplus">+ * @brief Do not use, json-c internal, may be changed or removed at any time.</span>
<a href="#l24.9"></a><span id="l24.9" class="difflineplus">+ */</span>
<a href="#l24.10"></a><span id="l24.10" class="difflineplus">+#ifndef _json_inttypes_h_</span>
<a href="#l24.11"></a><span id="l24.11" class="difflineplus">+#define _json_inttypes_h_</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineplus">+</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+#include &quot;json_config.h&quot;</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineplus">+</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineplus">+#ifdef JSON_C_HAVE_INTTYPES_H</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineplus">+/* inttypes.h includes stdint.h */</span>
<a href="#l24.17"></a><span id="l24.17" class="difflineplus">+#include &lt;inttypes.h&gt;</span>
<a href="#l24.18"></a><span id="l24.18" class="difflineplus">+</span>
<a href="#l24.19"></a><span id="l24.19" class="difflineplus">+#else</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineplus">+#include &lt;stdint.h&gt;</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineplus">+</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineplus">+#define PRId64 &quot;I64d&quot;</span>
<a href="#l24.23"></a><span id="l24.23" class="difflineplus">+#define SCNd64 &quot;I64d&quot;</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineplus">+</span>
<a href="#l24.25"></a><span id="l24.25" class="difflineplus">+#endif</span>
<a href="#l24.26"></a><span id="l24.26" class="difflineplus">+</span>
<a href="#l24.27"></a><span id="l24.27" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1">new file mode 100644</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineminus">--- /dev/null</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineplus">+++ b/third_party/json-c/json_object.c</span>
<a href="#l25.4"></a><span id="l25.4" class="difflineat">@@ -0,0 +1,1493 @@</span>
<a href="#l25.5"></a><span id="l25.5" class="difflineplus">+/*</span>
<a href="#l25.6"></a><span id="l25.6" class="difflineplus">+ * $Id: json_object.c,v 1.17 2006/07/25 03:24:50 mclark Exp $</span>
<a href="#l25.7"></a><span id="l25.7" class="difflineplus">+ *</span>
<a href="#l25.8"></a><span id="l25.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l25.9"></a><span id="l25.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l25.10"></a><span id="l25.10" class="difflineplus">+ * Copyright (c) 2009 Hewlett-Packard Development Company, L.P.</span>
<a href="#l25.11"></a><span id="l25.11" class="difflineplus">+ *</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+ *</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+ */</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineplus">+</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineplus">+</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineplus">+#include &quot;strerror_override.h&quot;</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineplus">+</span>
<a href="#l25.21"></a><span id="l25.21" class="difflineplus">+#include &lt;assert.h&gt;</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineplus">+#include &lt;ctype.h&gt;</span>
<a href="#l25.23"></a><span id="l25.23" class="difflineplus">+#include &lt;stdio.h&gt;</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineplus">+#include &lt;stdlib.h&gt;</span>
<a href="#l25.25"></a><span id="l25.25" class="difflineplus">+#include &lt;stddef.h&gt;</span>
<a href="#l25.26"></a><span id="l25.26" class="difflineplus">+#include &lt;string.h&gt;</span>
<a href="#l25.27"></a><span id="l25.27" class="difflineplus">+#include &lt;math.h&gt;</span>
<a href="#l25.28"></a><span id="l25.28" class="difflineplus">+</span>
<a href="#l25.29"></a><span id="l25.29" class="difflineplus">+#include &quot;debug.h&quot;</span>
<a href="#l25.30"></a><span id="l25.30" class="difflineplus">+#include &quot;printbuf.h&quot;</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineplus">+#include &quot;linkhash.h&quot;</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineplus">+#include &quot;arraylist.h&quot;</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineplus">+#include &quot;json_inttypes.h&quot;</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineplus">+#include &quot;json_object.h&quot;</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineplus">+#include &quot;json_object_private.h&quot;</span>
<a href="#l25.36"></a><span id="l25.36" class="difflineplus">+#include &quot;json_util.h&quot;</span>
<a href="#l25.37"></a><span id="l25.37" class="difflineplus">+#include &quot;math_compat.h&quot;</span>
<a href="#l25.38"></a><span id="l25.38" class="difflineplus">+#include &quot;strdup_compat.h&quot;</span>
<a href="#l25.39"></a><span id="l25.39" class="difflineplus">+#include &quot;snprintf_compat.h&quot;</span>
<a href="#l25.40"></a><span id="l25.40" class="difflineplus">+</span>
<a href="#l25.41"></a><span id="l25.41" class="difflineplus">+#if SIZEOF_LONG_LONG != SIZEOF_INT64_T</span>
<a href="#l25.42"></a><span id="l25.42" class="difflineplus">+#error &quot;The long long type isn't 64-bits&quot;</span>
<a href="#l25.43"></a><span id="l25.43" class="difflineplus">+#endif</span>
<a href="#l25.44"></a><span id="l25.44" class="difflineplus">+</span>
<a href="#l25.45"></a><span id="l25.45" class="difflineplus">+// Don't define this.  It's not thread-safe.</span>
<a href="#l25.46"></a><span id="l25.46" class="difflineplus">+/* #define REFCOUNT_DEBUG 1 */</span>
<a href="#l25.47"></a><span id="l25.47" class="difflineplus">+</span>
<a href="#l25.48"></a><span id="l25.48" class="difflineplus">+const char *json_number_chars = &quot;0123456789.+-eE&quot;;</span>
<a href="#l25.49"></a><span id="l25.49" class="difflineplus">+const char *json_hex_chars = &quot;0123456789abcdefABCDEF&quot;;</span>
<a href="#l25.50"></a><span id="l25.50" class="difflineplus">+</span>
<a href="#l25.51"></a><span id="l25.51" class="difflineplus">+static void json_object_generic_delete(struct json_object* jso);</span>
<a href="#l25.52"></a><span id="l25.52" class="difflineplus">+static struct json_object* json_object_new(enum json_type o_type);</span>
<a href="#l25.53"></a><span id="l25.53" class="difflineplus">+</span>
<a href="#l25.54"></a><span id="l25.54" class="difflineplus">+static json_object_to_json_string_fn json_object_object_to_json_string;</span>
<a href="#l25.55"></a><span id="l25.55" class="difflineplus">+static json_object_to_json_string_fn json_object_boolean_to_json_string;</span>
<a href="#l25.56"></a><span id="l25.56" class="difflineplus">+static json_object_to_json_string_fn json_object_double_to_json_string_default;</span>
<a href="#l25.57"></a><span id="l25.57" class="difflineplus">+static json_object_to_json_string_fn json_object_int_to_json_string;</span>
<a href="#l25.58"></a><span id="l25.58" class="difflineplus">+static json_object_to_json_string_fn json_object_string_to_json_string;</span>
<a href="#l25.59"></a><span id="l25.59" class="difflineplus">+static json_object_to_json_string_fn json_object_array_to_json_string;</span>
<a href="#l25.60"></a><span id="l25.60" class="difflineplus">+</span>
<a href="#l25.61"></a><span id="l25.61" class="difflineplus">+</span>
<a href="#l25.62"></a><span id="l25.62" class="difflineplus">+/* ref count debugging */</span>
<a href="#l25.63"></a><span id="l25.63" class="difflineplus">+</span>
<a href="#l25.64"></a><span id="l25.64" class="difflineplus">+#ifdef REFCOUNT_DEBUG</span>
<a href="#l25.65"></a><span id="l25.65" class="difflineplus">+</span>
<a href="#l25.66"></a><span id="l25.66" class="difflineplus">+static struct lh_table *json_object_table;</span>
<a href="#l25.67"></a><span id="l25.67" class="difflineplus">+</span>
<a href="#l25.68"></a><span id="l25.68" class="difflineplus">+static void json_object_init(void) __attribute__ ((constructor));</span>
<a href="#l25.69"></a><span id="l25.69" class="difflineplus">+static void json_object_init(void) {</span>
<a href="#l25.70"></a><span id="l25.70" class="difflineplus">+	MC_DEBUG(&quot;json_object_init: creating object table\n&quot;);</span>
<a href="#l25.71"></a><span id="l25.71" class="difflineplus">+	json_object_table = lh_kptr_table_new(128, NULL);</span>
<a href="#l25.72"></a><span id="l25.72" class="difflineplus">+}</span>
<a href="#l25.73"></a><span id="l25.73" class="difflineplus">+</span>
<a href="#l25.74"></a><span id="l25.74" class="difflineplus">+static void json_object_fini(void) __attribute__ ((destructor));</span>
<a href="#l25.75"></a><span id="l25.75" class="difflineplus">+static void json_object_fini(void)</span>
<a href="#l25.76"></a><span id="l25.76" class="difflineplus">+{</span>
<a href="#l25.77"></a><span id="l25.77" class="difflineplus">+	struct lh_entry *ent;</span>
<a href="#l25.78"></a><span id="l25.78" class="difflineplus">+	if (MC_GET_DEBUG())</span>
<a href="#l25.79"></a><span id="l25.79" class="difflineplus">+	{</span>
<a href="#l25.80"></a><span id="l25.80" class="difflineplus">+		if (json_object_table-&gt;count)</span>
<a href="#l25.81"></a><span id="l25.81" class="difflineplus">+		{</span>
<a href="#l25.82"></a><span id="l25.82" class="difflineplus">+			MC_DEBUG(&quot;json_object_fini: %d referenced objects at exit\n&quot;,</span>
<a href="#l25.83"></a><span id="l25.83" class="difflineplus">+			   json_object_table-&gt;count);</span>
<a href="#l25.84"></a><span id="l25.84" class="difflineplus">+			lh_foreach(json_object_table, ent)</span>
<a href="#l25.85"></a><span id="l25.85" class="difflineplus">+			{</span>
<a href="#l25.86"></a><span id="l25.86" class="difflineplus">+				struct json_object* obj =</span>
<a href="#l25.87"></a><span id="l25.87" class="difflineplus">+				  (struct json_object*) lh_entry_v(ent);</span>
<a href="#l25.88"></a><span id="l25.88" class="difflineplus">+				MC_DEBUG(&quot;\t%s:%p\n&quot;,</span>
<a href="#l25.89"></a><span id="l25.89" class="difflineplus">+					 json_type_to_name(obj-&gt;o_type), obj);</span>
<a href="#l25.90"></a><span id="l25.90" class="difflineplus">+			}</span>
<a href="#l25.91"></a><span id="l25.91" class="difflineplus">+		}</span>
<a href="#l25.92"></a><span id="l25.92" class="difflineplus">+	}</span>
<a href="#l25.93"></a><span id="l25.93" class="difflineplus">+	MC_DEBUG(&quot;json_object_fini: freeing object table\n&quot;);</span>
<a href="#l25.94"></a><span id="l25.94" class="difflineplus">+	lh_table_free(json_object_table);</span>
<a href="#l25.95"></a><span id="l25.95" class="difflineplus">+}</span>
<a href="#l25.96"></a><span id="l25.96" class="difflineplus">+#endif /* REFCOUNT_DEBUG */</span>
<a href="#l25.97"></a><span id="l25.97" class="difflineplus">+</span>
<a href="#l25.98"></a><span id="l25.98" class="difflineplus">+</span>
<a href="#l25.99"></a><span id="l25.99" class="difflineplus">+/* helper for accessing the optimized string data component in json_object</span>
<a href="#l25.100"></a><span id="l25.100" class="difflineplus">+ */</span>
<a href="#l25.101"></a><span id="l25.101" class="difflineplus">+static const char *</span>
<a href="#l25.102"></a><span id="l25.102" class="difflineplus">+get_string_component(const struct json_object *jso)</span>
<a href="#l25.103"></a><span id="l25.103" class="difflineplus">+{</span>
<a href="#l25.104"></a><span id="l25.104" class="difflineplus">+	return (jso-&gt;o.c_string.len &lt; LEN_DIRECT_STRING_DATA) ?</span>
<a href="#l25.105"></a><span id="l25.105" class="difflineplus">+		   jso-&gt;o.c_string.str.data : jso-&gt;o.c_string.str.ptr;</span>
<a href="#l25.106"></a><span id="l25.106" class="difflineplus">+}</span>
<a href="#l25.107"></a><span id="l25.107" class="difflineplus">+</span>
<a href="#l25.108"></a><span id="l25.108" class="difflineplus">+/* string escaping */</span>
<a href="#l25.109"></a><span id="l25.109" class="difflineplus">+</span>
<a href="#l25.110"></a><span id="l25.110" class="difflineplus">+static int json_escape_str(struct printbuf *pb, const char *str, int len, int flags)</span>
<a href="#l25.111"></a><span id="l25.111" class="difflineplus">+{</span>
<a href="#l25.112"></a><span id="l25.112" class="difflineplus">+	int pos = 0, start_offset = 0;</span>
<a href="#l25.113"></a><span id="l25.113" class="difflineplus">+	unsigned char c;</span>
<a href="#l25.114"></a><span id="l25.114" class="difflineplus">+	while (len--)</span>
<a href="#l25.115"></a><span id="l25.115" class="difflineplus">+	{</span>
<a href="#l25.116"></a><span id="l25.116" class="difflineplus">+		c = str[pos];</span>
<a href="#l25.117"></a><span id="l25.117" class="difflineplus">+		switch(c)</span>
<a href="#l25.118"></a><span id="l25.118" class="difflineplus">+		{</span>
<a href="#l25.119"></a><span id="l25.119" class="difflineplus">+		case '\b':</span>
<a href="#l25.120"></a><span id="l25.120" class="difflineplus">+		case '\n':</span>
<a href="#l25.121"></a><span id="l25.121" class="difflineplus">+		case '\r':</span>
<a href="#l25.122"></a><span id="l25.122" class="difflineplus">+		case '\t':</span>
<a href="#l25.123"></a><span id="l25.123" class="difflineplus">+		case '\f':</span>
<a href="#l25.124"></a><span id="l25.124" class="difflineplus">+		case '&quot;':</span>
<a href="#l25.125"></a><span id="l25.125" class="difflineplus">+		case '\\':</span>
<a href="#l25.126"></a><span id="l25.126" class="difflineplus">+		case '/':</span>
<a href="#l25.127"></a><span id="l25.127" class="difflineplus">+			if((flags &amp; JSON_C_TO_STRING_NOSLASHESCAPE) &amp;&amp; c == '/')</span>
<a href="#l25.128"></a><span id="l25.128" class="difflineplus">+			{</span>
<a href="#l25.129"></a><span id="l25.129" class="difflineplus">+				pos++;</span>
<a href="#l25.130"></a><span id="l25.130" class="difflineplus">+				break;</span>
<a href="#l25.131"></a><span id="l25.131" class="difflineplus">+			}</span>
<a href="#l25.132"></a><span id="l25.132" class="difflineplus">+</span>
<a href="#l25.133"></a><span id="l25.133" class="difflineplus">+			if(pos - start_offset &gt; 0)</span>
<a href="#l25.134"></a><span id="l25.134" class="difflineplus">+				printbuf_memappend(pb, str + start_offset, pos - start_offset);</span>
<a href="#l25.135"></a><span id="l25.135" class="difflineplus">+</span>
<a href="#l25.136"></a><span id="l25.136" class="difflineplus">+			if(c == '\b') printbuf_memappend(pb, &quot;\\b&quot;, 2);</span>
<a href="#l25.137"></a><span id="l25.137" class="difflineplus">+			else if(c == '\n') printbuf_memappend(pb, &quot;\\n&quot;, 2);</span>
<a href="#l25.138"></a><span id="l25.138" class="difflineplus">+			else if(c == '\r') printbuf_memappend(pb, &quot;\\r&quot;, 2);</span>
<a href="#l25.139"></a><span id="l25.139" class="difflineplus">+			else if(c == '\t') printbuf_memappend(pb, &quot;\\t&quot;, 2);</span>
<a href="#l25.140"></a><span id="l25.140" class="difflineplus">+			else if(c == '\f') printbuf_memappend(pb, &quot;\\f&quot;, 2);</span>
<a href="#l25.141"></a><span id="l25.141" class="difflineplus">+			else if(c == '&quot;') printbuf_memappend(pb, &quot;\\\&quot;&quot;, 2);</span>
<a href="#l25.142"></a><span id="l25.142" class="difflineplus">+			else if(c == '\\') printbuf_memappend(pb, &quot;\\\\&quot;, 2);</span>
<a href="#l25.143"></a><span id="l25.143" class="difflineplus">+			else if(c == '/') printbuf_memappend(pb, &quot;\\/&quot;, 2);</span>
<a href="#l25.144"></a><span id="l25.144" class="difflineplus">+</span>
<a href="#l25.145"></a><span id="l25.145" class="difflineplus">+			start_offset = ++pos;</span>
<a href="#l25.146"></a><span id="l25.146" class="difflineplus">+			break;</span>
<a href="#l25.147"></a><span id="l25.147" class="difflineplus">+		default:</span>
<a href="#l25.148"></a><span id="l25.148" class="difflineplus">+			if(c &lt; ' ')</span>
<a href="#l25.149"></a><span id="l25.149" class="difflineplus">+			{</span>
<a href="#l25.150"></a><span id="l25.150" class="difflineplus">+				char sbuf[7];</span>
<a href="#l25.151"></a><span id="l25.151" class="difflineplus">+				if(pos - start_offset &gt; 0)</span>
<a href="#l25.152"></a><span id="l25.152" class="difflineplus">+					printbuf_memappend(pb,</span>
<a href="#l25.153"></a><span id="l25.153" class="difflineplus">+							   str + start_offset,</span>
<a href="#l25.154"></a><span id="l25.154" class="difflineplus">+							   pos - start_offset);</span>
<a href="#l25.155"></a><span id="l25.155" class="difflineplus">+				snprintf(sbuf, sizeof(sbuf),</span>
<a href="#l25.156"></a><span id="l25.156" class="difflineplus">+					 &quot;\\u00%c%c&quot;,</span>
<a href="#l25.157"></a><span id="l25.157" class="difflineplus">+					 json_hex_chars[c &gt;&gt; 4],</span>
<a href="#l25.158"></a><span id="l25.158" class="difflineplus">+					 json_hex_chars[c &amp; 0xf]);</span>
<a href="#l25.159"></a><span id="l25.159" class="difflineplus">+				printbuf_memappend_fast(pb, sbuf, (int) sizeof(sbuf) - 1);</span>
<a href="#l25.160"></a><span id="l25.160" class="difflineplus">+				start_offset = ++pos;</span>
<a href="#l25.161"></a><span id="l25.161" class="difflineplus">+			} else</span>
<a href="#l25.162"></a><span id="l25.162" class="difflineplus">+				pos++;</span>
<a href="#l25.163"></a><span id="l25.163" class="difflineplus">+		}</span>
<a href="#l25.164"></a><span id="l25.164" class="difflineplus">+	}</span>
<a href="#l25.165"></a><span id="l25.165" class="difflineplus">+	if (pos - start_offset &gt; 0)</span>
<a href="#l25.166"></a><span id="l25.166" class="difflineplus">+		printbuf_memappend(pb, str + start_offset, pos - start_offset);</span>
<a href="#l25.167"></a><span id="l25.167" class="difflineplus">+	return 0;</span>
<a href="#l25.168"></a><span id="l25.168" class="difflineplus">+}</span>
<a href="#l25.169"></a><span id="l25.169" class="difflineplus">+</span>
<a href="#l25.170"></a><span id="l25.170" class="difflineplus">+</span>
<a href="#l25.171"></a><span id="l25.171" class="difflineplus">+/* reference counting */</span>
<a href="#l25.172"></a><span id="l25.172" class="difflineplus">+</span>
<a href="#l25.173"></a><span id="l25.173" class="difflineplus">+extern struct json_object* json_object_get(struct json_object *jso)</span>
<a href="#l25.174"></a><span id="l25.174" class="difflineplus">+{</span>
<a href="#l25.175"></a><span id="l25.175" class="difflineplus">+	if (!jso) return jso;</span>
<a href="#l25.176"></a><span id="l25.176" class="difflineplus">+</span>
<a href="#l25.177"></a><span id="l25.177" class="difflineplus">+#if defined(HAVE_ATOMIC_BUILTINS) &amp;&amp; defined(ENABLE_THREADING)</span>
<a href="#l25.178"></a><span id="l25.178" class="difflineplus">+	__sync_add_and_fetch(&amp;jso-&gt;_ref_count, 1);</span>
<a href="#l25.179"></a><span id="l25.179" class="difflineplus">+#else</span>
<a href="#l25.180"></a><span id="l25.180" class="difflineplus">+	++jso-&gt;_ref_count;</span>
<a href="#l25.181"></a><span id="l25.181" class="difflineplus">+#endif        </span>
<a href="#l25.182"></a><span id="l25.182" class="difflineplus">+</span>
<a href="#l25.183"></a><span id="l25.183" class="difflineplus">+	return jso;</span>
<a href="#l25.184"></a><span id="l25.184" class="difflineplus">+}</span>
<a href="#l25.185"></a><span id="l25.185" class="difflineplus">+</span>
<a href="#l25.186"></a><span id="l25.186" class="difflineplus">+int json_object_put(struct json_object *jso)</span>
<a href="#l25.187"></a><span id="l25.187" class="difflineplus">+{</span>
<a href="#l25.188"></a><span id="l25.188" class="difflineplus">+	if(!jso) return 0;</span>
<a href="#l25.189"></a><span id="l25.189" class="difflineplus">+</span>
<a href="#l25.190"></a><span id="l25.190" class="difflineplus">+	/* Avoid invalid free and crash explicitly instead of (silently)</span>
<a href="#l25.191"></a><span id="l25.191" class="difflineplus">+	 * segfaulting.</span>
<a href="#l25.192"></a><span id="l25.192" class="difflineplus">+	 */</span>
<a href="#l25.193"></a><span id="l25.193" class="difflineplus">+	assert(jso-&gt;_ref_count &gt; 0);</span>
<a href="#l25.194"></a><span id="l25.194" class="difflineplus">+</span>
<a href="#l25.195"></a><span id="l25.195" class="difflineplus">+#if defined(HAVE_ATOMIC_BUILTINS) &amp;&amp; defined(ENABLE_THREADING)</span>
<a href="#l25.196"></a><span id="l25.196" class="difflineplus">+	/* Note: this only allow the refcount to remain correct</span>
<a href="#l25.197"></a><span id="l25.197" class="difflineplus">+	 * when multiple threads are adjusting it.  It is still an error </span>
<a href="#l25.198"></a><span id="l25.198" class="difflineplus">+	 * for a thread to decrement the refcount if it doesn't &quot;own&quot; it,</span>
<a href="#l25.199"></a><span id="l25.199" class="difflineplus">+	 * as that can result in the thread that loses the race to 0</span>
<a href="#l25.200"></a><span id="l25.200" class="difflineplus">+	 * operating on an already-freed object.</span>
<a href="#l25.201"></a><span id="l25.201" class="difflineplus">+	 */</span>
<a href="#l25.202"></a><span id="l25.202" class="difflineplus">+	if (__sync_sub_and_fetch(&amp;jso-&gt;_ref_count, 1) &gt; 0) return 0;</span>
<a href="#l25.203"></a><span id="l25.203" class="difflineplus">+#else</span>
<a href="#l25.204"></a><span id="l25.204" class="difflineplus">+	if (--jso-&gt;_ref_count &gt; 0) return 0;</span>
<a href="#l25.205"></a><span id="l25.205" class="difflineplus">+#endif</span>
<a href="#l25.206"></a><span id="l25.206" class="difflineplus">+</span>
<a href="#l25.207"></a><span id="l25.207" class="difflineplus">+	if (jso-&gt;_user_delete)</span>
<a href="#l25.208"></a><span id="l25.208" class="difflineplus">+		jso-&gt;_user_delete(jso, jso-&gt;_userdata);</span>
<a href="#l25.209"></a><span id="l25.209" class="difflineplus">+	jso-&gt;_delete(jso);</span>
<a href="#l25.210"></a><span id="l25.210" class="difflineplus">+	return 1;</span>
<a href="#l25.211"></a><span id="l25.211" class="difflineplus">+}</span>
<a href="#l25.212"></a><span id="l25.212" class="difflineplus">+</span>
<a href="#l25.213"></a><span id="l25.213" class="difflineplus">+</span>
<a href="#l25.214"></a><span id="l25.214" class="difflineplus">+/* generic object construction and destruction parts */</span>
<a href="#l25.215"></a><span id="l25.215" class="difflineplus">+</span>
<a href="#l25.216"></a><span id="l25.216" class="difflineplus">+static void json_object_generic_delete(struct json_object* jso)</span>
<a href="#l25.217"></a><span id="l25.217" class="difflineplus">+{</span>
<a href="#l25.218"></a><span id="l25.218" class="difflineplus">+#ifdef REFCOUNT_DEBUG</span>
<a href="#l25.219"></a><span id="l25.219" class="difflineplus">+	MC_DEBUG(&quot;json_object_delete_%s: %p\n&quot;,</span>
<a href="#l25.220"></a><span id="l25.220" class="difflineplus">+	   json_type_to_name(jso-&gt;o_type), jso);</span>
<a href="#l25.221"></a><span id="l25.221" class="difflineplus">+	lh_table_delete(json_object_table, jso);</span>
<a href="#l25.222"></a><span id="l25.222" class="difflineplus">+#endif /* REFCOUNT_DEBUG */</span>
<a href="#l25.223"></a><span id="l25.223" class="difflineplus">+	printbuf_free(jso-&gt;_pb);</span>
<a href="#l25.224"></a><span id="l25.224" class="difflineplus">+	free(jso);</span>
<a href="#l25.225"></a><span id="l25.225" class="difflineplus">+}</span>
<a href="#l25.226"></a><span id="l25.226" class="difflineplus">+</span>
<a href="#l25.227"></a><span id="l25.227" class="difflineplus">+static struct json_object* json_object_new(enum json_type o_type)</span>
<a href="#l25.228"></a><span id="l25.228" class="difflineplus">+{</span>
<a href="#l25.229"></a><span id="l25.229" class="difflineplus">+	struct json_object *jso;</span>
<a href="#l25.230"></a><span id="l25.230" class="difflineplus">+</span>
<a href="#l25.231"></a><span id="l25.231" class="difflineplus">+	jso = (struct json_object*)calloc(sizeof(struct json_object), 1);</span>
<a href="#l25.232"></a><span id="l25.232" class="difflineplus">+	if (!jso)</span>
<a href="#l25.233"></a><span id="l25.233" class="difflineplus">+		return NULL;</span>
<a href="#l25.234"></a><span id="l25.234" class="difflineplus">+	jso-&gt;o_type = o_type;</span>
<a href="#l25.235"></a><span id="l25.235" class="difflineplus">+	jso-&gt;_ref_count = 1;</span>
<a href="#l25.236"></a><span id="l25.236" class="difflineplus">+	jso-&gt;_delete = &amp;json_object_generic_delete;</span>
<a href="#l25.237"></a><span id="l25.237" class="difflineplus">+#ifdef REFCOUNT_DEBUG</span>
<a href="#l25.238"></a><span id="l25.238" class="difflineplus">+	lh_table_insert(json_object_table, jso, jso);</span>
<a href="#l25.239"></a><span id="l25.239" class="difflineplus">+	MC_DEBUG(&quot;json_object_new_%s: %p\n&quot;, json_type_to_name(jso-&gt;o_type), jso);</span>
<a href="#l25.240"></a><span id="l25.240" class="difflineplus">+#endif /* REFCOUNT_DEBUG */</span>
<a href="#l25.241"></a><span id="l25.241" class="difflineplus">+	return jso;</span>
<a href="#l25.242"></a><span id="l25.242" class="difflineplus">+}</span>
<a href="#l25.243"></a><span id="l25.243" class="difflineplus">+</span>
<a href="#l25.244"></a><span id="l25.244" class="difflineplus">+</span>
<a href="#l25.245"></a><span id="l25.245" class="difflineplus">+/* type checking functions */</span>
<a href="#l25.246"></a><span id="l25.246" class="difflineplus">+</span>
<a href="#l25.247"></a><span id="l25.247" class="difflineplus">+int json_object_is_type(const struct json_object *jso, enum json_type type)</span>
<a href="#l25.248"></a><span id="l25.248" class="difflineplus">+{</span>
<a href="#l25.249"></a><span id="l25.249" class="difflineplus">+	if (!jso)</span>
<a href="#l25.250"></a><span id="l25.250" class="difflineplus">+		return (type == json_type_null);</span>
<a href="#l25.251"></a><span id="l25.251" class="difflineplus">+	return (jso-&gt;o_type == type);</span>
<a href="#l25.252"></a><span id="l25.252" class="difflineplus">+}</span>
<a href="#l25.253"></a><span id="l25.253" class="difflineplus">+</span>
<a href="#l25.254"></a><span id="l25.254" class="difflineplus">+enum json_type json_object_get_type(const struct json_object *jso)</span>
<a href="#l25.255"></a><span id="l25.255" class="difflineplus">+{</span>
<a href="#l25.256"></a><span id="l25.256" class="difflineplus">+	if (!jso)</span>
<a href="#l25.257"></a><span id="l25.257" class="difflineplus">+		return json_type_null;</span>
<a href="#l25.258"></a><span id="l25.258" class="difflineplus">+	return jso-&gt;o_type;</span>
<a href="#l25.259"></a><span id="l25.259" class="difflineplus">+}</span>
<a href="#l25.260"></a><span id="l25.260" class="difflineplus">+</span>
<a href="#l25.261"></a><span id="l25.261" class="difflineplus">+void* json_object_get_userdata(json_object *jso) {</span>
<a href="#l25.262"></a><span id="l25.262" class="difflineplus">+	return jso ? jso-&gt;_userdata : NULL;</span>
<a href="#l25.263"></a><span id="l25.263" class="difflineplus">+}</span>
<a href="#l25.264"></a><span id="l25.264" class="difflineplus">+</span>
<a href="#l25.265"></a><span id="l25.265" class="difflineplus">+void json_object_set_userdata(json_object *jso, void *userdata,</span>
<a href="#l25.266"></a><span id="l25.266" class="difflineplus">+			      json_object_delete_fn *user_delete)</span>
<a href="#l25.267"></a><span id="l25.267" class="difflineplus">+{</span>
<a href="#l25.268"></a><span id="l25.268" class="difflineplus">+	// Can't return failure, so abort if we can't perform the operation.</span>
<a href="#l25.269"></a><span id="l25.269" class="difflineplus">+	assert(jso != NULL);</span>
<a href="#l25.270"></a><span id="l25.270" class="difflineplus">+</span>
<a href="#l25.271"></a><span id="l25.271" class="difflineplus">+	// First, clean up any previously existing user info</span>
<a href="#l25.272"></a><span id="l25.272" class="difflineplus">+	if (jso-&gt;_user_delete)</span>
<a href="#l25.273"></a><span id="l25.273" class="difflineplus">+		jso-&gt;_user_delete(jso, jso-&gt;_userdata);</span>
<a href="#l25.274"></a><span id="l25.274" class="difflineplus">+</span>
<a href="#l25.275"></a><span id="l25.275" class="difflineplus">+	jso-&gt;_userdata = userdata;</span>
<a href="#l25.276"></a><span id="l25.276" class="difflineplus">+	jso-&gt;_user_delete = user_delete;</span>
<a href="#l25.277"></a><span id="l25.277" class="difflineplus">+}</span>
<a href="#l25.278"></a><span id="l25.278" class="difflineplus">+</span>
<a href="#l25.279"></a><span id="l25.279" class="difflineplus">+/* set a custom conversion to string */</span>
<a href="#l25.280"></a><span id="l25.280" class="difflineplus">+</span>
<a href="#l25.281"></a><span id="l25.281" class="difflineplus">+void json_object_set_serializer(json_object *jso,</span>
<a href="#l25.282"></a><span id="l25.282" class="difflineplus">+	json_object_to_json_string_fn *to_string_func,</span>
<a href="#l25.283"></a><span id="l25.283" class="difflineplus">+	void *userdata,</span>
<a href="#l25.284"></a><span id="l25.284" class="difflineplus">+	json_object_delete_fn *user_delete)</span>
<a href="#l25.285"></a><span id="l25.285" class="difflineplus">+{</span>
<a href="#l25.286"></a><span id="l25.286" class="difflineplus">+	json_object_set_userdata(jso, userdata, user_delete);</span>
<a href="#l25.287"></a><span id="l25.287" class="difflineplus">+</span>
<a href="#l25.288"></a><span id="l25.288" class="difflineplus">+	if (to_string_func == NULL)</span>
<a href="#l25.289"></a><span id="l25.289" class="difflineplus">+	{</span>
<a href="#l25.290"></a><span id="l25.290" class="difflineplus">+		// Reset to the standard serialization function</span>
<a href="#l25.291"></a><span id="l25.291" class="difflineplus">+		switch(jso-&gt;o_type)</span>
<a href="#l25.292"></a><span id="l25.292" class="difflineplus">+		{</span>
<a href="#l25.293"></a><span id="l25.293" class="difflineplus">+		case json_type_null:</span>
<a href="#l25.294"></a><span id="l25.294" class="difflineplus">+			jso-&gt;_to_json_string = NULL;</span>
<a href="#l25.295"></a><span id="l25.295" class="difflineplus">+			break;</span>
<a href="#l25.296"></a><span id="l25.296" class="difflineplus">+		case json_type_boolean:</span>
<a href="#l25.297"></a><span id="l25.297" class="difflineplus">+			jso-&gt;_to_json_string = &amp;json_object_boolean_to_json_string;</span>
<a href="#l25.298"></a><span id="l25.298" class="difflineplus">+			break;</span>
<a href="#l25.299"></a><span id="l25.299" class="difflineplus">+		case json_type_double:</span>
<a href="#l25.300"></a><span id="l25.300" class="difflineplus">+			jso-&gt;_to_json_string = &amp;json_object_double_to_json_string_default;</span>
<a href="#l25.301"></a><span id="l25.301" class="difflineplus">+			break;</span>
<a href="#l25.302"></a><span id="l25.302" class="difflineplus">+		case json_type_int:</span>
<a href="#l25.303"></a><span id="l25.303" class="difflineplus">+			jso-&gt;_to_json_string = &amp;json_object_int_to_json_string;</span>
<a href="#l25.304"></a><span id="l25.304" class="difflineplus">+			break;</span>
<a href="#l25.305"></a><span id="l25.305" class="difflineplus">+		case json_type_object:</span>
<a href="#l25.306"></a><span id="l25.306" class="difflineplus">+			jso-&gt;_to_json_string = &amp;json_object_object_to_json_string;</span>
<a href="#l25.307"></a><span id="l25.307" class="difflineplus">+			break;</span>
<a href="#l25.308"></a><span id="l25.308" class="difflineplus">+		case json_type_array:</span>
<a href="#l25.309"></a><span id="l25.309" class="difflineplus">+			jso-&gt;_to_json_string = &amp;json_object_array_to_json_string;</span>
<a href="#l25.310"></a><span id="l25.310" class="difflineplus">+			break;</span>
<a href="#l25.311"></a><span id="l25.311" class="difflineplus">+		case json_type_string:</span>
<a href="#l25.312"></a><span id="l25.312" class="difflineplus">+			jso-&gt;_to_json_string = &amp;json_object_string_to_json_string;</span>
<a href="#l25.313"></a><span id="l25.313" class="difflineplus">+			break;</span>
<a href="#l25.314"></a><span id="l25.314" class="difflineplus">+		}</span>
<a href="#l25.315"></a><span id="l25.315" class="difflineplus">+		return;</span>
<a href="#l25.316"></a><span id="l25.316" class="difflineplus">+	}</span>
<a href="#l25.317"></a><span id="l25.317" class="difflineplus">+</span>
<a href="#l25.318"></a><span id="l25.318" class="difflineplus">+	jso-&gt;_to_json_string = to_string_func;</span>
<a href="#l25.319"></a><span id="l25.319" class="difflineplus">+}</span>
<a href="#l25.320"></a><span id="l25.320" class="difflineplus">+</span>
<a href="#l25.321"></a><span id="l25.321" class="difflineplus">+</span>
<a href="#l25.322"></a><span id="l25.322" class="difflineplus">+/* extended conversion to string */</span>
<a href="#l25.323"></a><span id="l25.323" class="difflineplus">+</span>
<a href="#l25.324"></a><span id="l25.324" class="difflineplus">+const char* json_object_to_json_string_length(struct json_object *jso, int flags, size_t *length)</span>
<a href="#l25.325"></a><span id="l25.325" class="difflineplus">+{</span>
<a href="#l25.326"></a><span id="l25.326" class="difflineplus">+	const char *r = NULL;</span>
<a href="#l25.327"></a><span id="l25.327" class="difflineplus">+	size_t s = 0;</span>
<a href="#l25.328"></a><span id="l25.328" class="difflineplus">+</span>
<a href="#l25.329"></a><span id="l25.329" class="difflineplus">+	if (!jso)</span>
<a href="#l25.330"></a><span id="l25.330" class="difflineplus">+	{</span>
<a href="#l25.331"></a><span id="l25.331" class="difflineplus">+		s = 4;</span>
<a href="#l25.332"></a><span id="l25.332" class="difflineplus">+		r = &quot;null&quot;;</span>
<a href="#l25.333"></a><span id="l25.333" class="difflineplus">+	}</span>
<a href="#l25.334"></a><span id="l25.334" class="difflineplus">+	else if ((jso-&gt;_pb) || (jso-&gt;_pb = printbuf_new()))</span>
<a href="#l25.335"></a><span id="l25.335" class="difflineplus">+	{</span>
<a href="#l25.336"></a><span id="l25.336" class="difflineplus">+		printbuf_reset(jso-&gt;_pb);</span>
<a href="#l25.337"></a><span id="l25.337" class="difflineplus">+</span>
<a href="#l25.338"></a><span id="l25.338" class="difflineplus">+		if(jso-&gt;_to_json_string(jso, jso-&gt;_pb, 0, flags) &gt;= 0)</span>
<a href="#l25.339"></a><span id="l25.339" class="difflineplus">+		{</span>
<a href="#l25.340"></a><span id="l25.340" class="difflineplus">+			s = (size_t)jso-&gt;_pb-&gt;bpos;</span>
<a href="#l25.341"></a><span id="l25.341" class="difflineplus">+			r = jso-&gt;_pb-&gt;buf;</span>
<a href="#l25.342"></a><span id="l25.342" class="difflineplus">+		}</span>
<a href="#l25.343"></a><span id="l25.343" class="difflineplus">+	}</span>
<a href="#l25.344"></a><span id="l25.344" class="difflineplus">+</span>
<a href="#l25.345"></a><span id="l25.345" class="difflineplus">+	if (length)</span>
<a href="#l25.346"></a><span id="l25.346" class="difflineplus">+		*length = s;</span>
<a href="#l25.347"></a><span id="l25.347" class="difflineplus">+	return r;</span>
<a href="#l25.348"></a><span id="l25.348" class="difflineplus">+}</span>
<a href="#l25.349"></a><span id="l25.349" class="difflineplus">+</span>
<a href="#l25.350"></a><span id="l25.350" class="difflineplus">+const char* json_object_to_json_string_ext(struct json_object *jso, int flags)</span>
<a href="#l25.351"></a><span id="l25.351" class="difflineplus">+{</span>
<a href="#l25.352"></a><span id="l25.352" class="difflineplus">+	return json_object_to_json_string_length(jso, flags, NULL);</span>
<a href="#l25.353"></a><span id="l25.353" class="difflineplus">+}</span>
<a href="#l25.354"></a><span id="l25.354" class="difflineplus">+</span>
<a href="#l25.355"></a><span id="l25.355" class="difflineplus">+/* backwards-compatible conversion to string */</span>
<a href="#l25.356"></a><span id="l25.356" class="difflineplus">+</span>
<a href="#l25.357"></a><span id="l25.357" class="difflineplus">+const char* json_object_to_json_string(struct json_object *jso)</span>
<a href="#l25.358"></a><span id="l25.358" class="difflineplus">+{</span>
<a href="#l25.359"></a><span id="l25.359" class="difflineplus">+	return json_object_to_json_string_ext(jso, JSON_C_TO_STRING_SPACED);</span>
<a href="#l25.360"></a><span id="l25.360" class="difflineplus">+}</span>
<a href="#l25.361"></a><span id="l25.361" class="difflineplus">+</span>
<a href="#l25.362"></a><span id="l25.362" class="difflineplus">+static void indent(struct printbuf *pb, int level, int flags)</span>
<a href="#l25.363"></a><span id="l25.363" class="difflineplus">+{</span>
<a href="#l25.364"></a><span id="l25.364" class="difflineplus">+	if (flags &amp; JSON_C_TO_STRING_PRETTY)</span>
<a href="#l25.365"></a><span id="l25.365" class="difflineplus">+	{</span>
<a href="#l25.366"></a><span id="l25.366" class="difflineplus">+		if (flags &amp; JSON_C_TO_STRING_PRETTY_TAB)</span>
<a href="#l25.367"></a><span id="l25.367" class="difflineplus">+		{</span>
<a href="#l25.368"></a><span id="l25.368" class="difflineplus">+			printbuf_memset(pb, -1, '\t', level);</span>
<a href="#l25.369"></a><span id="l25.369" class="difflineplus">+		}</span>
<a href="#l25.370"></a><span id="l25.370" class="difflineplus">+		else</span>
<a href="#l25.371"></a><span id="l25.371" class="difflineplus">+		{</span>
<a href="#l25.372"></a><span id="l25.372" class="difflineplus">+			printbuf_memset(pb, -1, ' ', level * 2);</span>
<a href="#l25.373"></a><span id="l25.373" class="difflineplus">+		}</span>
<a href="#l25.374"></a><span id="l25.374" class="difflineplus">+	}</span>
<a href="#l25.375"></a><span id="l25.375" class="difflineplus">+}</span>
<a href="#l25.376"></a><span id="l25.376" class="difflineplus">+</span>
<a href="#l25.377"></a><span id="l25.377" class="difflineplus">+/* json_object_object */</span>
<a href="#l25.378"></a><span id="l25.378" class="difflineplus">+</span>
<a href="#l25.379"></a><span id="l25.379" class="difflineplus">+static int json_object_object_to_json_string(struct json_object* jso,</span>
<a href="#l25.380"></a><span id="l25.380" class="difflineplus">+					     struct printbuf *pb,</span>
<a href="#l25.381"></a><span id="l25.381" class="difflineplus">+					     int level,</span>
<a href="#l25.382"></a><span id="l25.382" class="difflineplus">+					     int flags)</span>
<a href="#l25.383"></a><span id="l25.383" class="difflineplus">+{</span>
<a href="#l25.384"></a><span id="l25.384" class="difflineplus">+	int had_children = 0;</span>
<a href="#l25.385"></a><span id="l25.385" class="difflineplus">+	struct json_object_iter iter;</span>
<a href="#l25.386"></a><span id="l25.386" class="difflineplus">+</span>
<a href="#l25.387"></a><span id="l25.387" class="difflineplus">+	printbuf_strappend(pb, &quot;{&quot; /*}*/);</span>
<a href="#l25.388"></a><span id="l25.388" class="difflineplus">+	if (flags &amp; JSON_C_TO_STRING_PRETTY)</span>
<a href="#l25.389"></a><span id="l25.389" class="difflineplus">+		printbuf_strappend(pb, &quot;\n&quot;);</span>
<a href="#l25.390"></a><span id="l25.390" class="difflineplus">+	json_object_object_foreachC(jso, iter)</span>
<a href="#l25.391"></a><span id="l25.391" class="difflineplus">+	{</span>
<a href="#l25.392"></a><span id="l25.392" class="difflineplus">+		if (had_children)</span>
<a href="#l25.393"></a><span id="l25.393" class="difflineplus">+		{</span>
<a href="#l25.394"></a><span id="l25.394" class="difflineplus">+			printbuf_strappend(pb, &quot;,&quot;);</span>
<a href="#l25.395"></a><span id="l25.395" class="difflineplus">+			if (flags &amp; JSON_C_TO_STRING_PRETTY)</span>
<a href="#l25.396"></a><span id="l25.396" class="difflineplus">+				printbuf_strappend(pb, &quot;\n&quot;);</span>
<a href="#l25.397"></a><span id="l25.397" class="difflineplus">+		}</span>
<a href="#l25.398"></a><span id="l25.398" class="difflineplus">+		had_children = 1;</span>
<a href="#l25.399"></a><span id="l25.399" class="difflineplus">+		if (flags &amp; JSON_C_TO_STRING_SPACED)</span>
<a href="#l25.400"></a><span id="l25.400" class="difflineplus">+			printbuf_strappend(pb, &quot; &quot;);</span>
<a href="#l25.401"></a><span id="l25.401" class="difflineplus">+		indent(pb, level+1, flags);</span>
<a href="#l25.402"></a><span id="l25.402" class="difflineplus">+		printbuf_strappend(pb, &quot;\&quot;&quot;);</span>
<a href="#l25.403"></a><span id="l25.403" class="difflineplus">+		json_escape_str(pb, iter.key, strlen(iter.key), flags);</span>
<a href="#l25.404"></a><span id="l25.404" class="difflineplus">+		if (flags &amp; JSON_C_TO_STRING_SPACED)</span>
<a href="#l25.405"></a><span id="l25.405" class="difflineplus">+			printbuf_strappend(pb, &quot;\&quot;: &quot;);</span>
<a href="#l25.406"></a><span id="l25.406" class="difflineplus">+		else</span>
<a href="#l25.407"></a><span id="l25.407" class="difflineplus">+			printbuf_strappend(pb, &quot;\&quot;:&quot;);</span>
<a href="#l25.408"></a><span id="l25.408" class="difflineplus">+		if(iter.val == NULL)</span>
<a href="#l25.409"></a><span id="l25.409" class="difflineplus">+			printbuf_strappend(pb, &quot;null&quot;);</span>
<a href="#l25.410"></a><span id="l25.410" class="difflineplus">+		else</span>
<a href="#l25.411"></a><span id="l25.411" class="difflineplus">+			if (iter.val-&gt;_to_json_string(iter.val, pb, level+1,flags) &lt; 0)</span>
<a href="#l25.412"></a><span id="l25.412" class="difflineplus">+				return -1;</span>
<a href="#l25.413"></a><span id="l25.413" class="difflineplus">+	}</span>
<a href="#l25.414"></a><span id="l25.414" class="difflineplus">+	if (flags &amp; JSON_C_TO_STRING_PRETTY)</span>
<a href="#l25.415"></a><span id="l25.415" class="difflineplus">+	{</span>
<a href="#l25.416"></a><span id="l25.416" class="difflineplus">+		if (had_children)</span>
<a href="#l25.417"></a><span id="l25.417" class="difflineplus">+			printbuf_strappend(pb, &quot;\n&quot;);</span>
<a href="#l25.418"></a><span id="l25.418" class="difflineplus">+		indent(pb,level,flags);</span>
<a href="#l25.419"></a><span id="l25.419" class="difflineplus">+	}</span>
<a href="#l25.420"></a><span id="l25.420" class="difflineplus">+	if (flags &amp; JSON_C_TO_STRING_SPACED)</span>
<a href="#l25.421"></a><span id="l25.421" class="difflineplus">+		return printbuf_strappend(pb, /*{*/ &quot; }&quot;);</span>
<a href="#l25.422"></a><span id="l25.422" class="difflineplus">+	else</span>
<a href="#l25.423"></a><span id="l25.423" class="difflineplus">+		return printbuf_strappend(pb, /*{*/ &quot;}&quot;);</span>
<a href="#l25.424"></a><span id="l25.424" class="difflineplus">+}</span>
<a href="#l25.425"></a><span id="l25.425" class="difflineplus">+</span>
<a href="#l25.426"></a><span id="l25.426" class="difflineplus">+</span>
<a href="#l25.427"></a><span id="l25.427" class="difflineplus">+static void json_object_lh_entry_free(struct lh_entry *ent)</span>
<a href="#l25.428"></a><span id="l25.428" class="difflineplus">+{</span>
<a href="#l25.429"></a><span id="l25.429" class="difflineplus">+	if (!ent-&gt;k_is_constant)</span>
<a href="#l25.430"></a><span id="l25.430" class="difflineplus">+		free(lh_entry_k(ent));</span>
<a href="#l25.431"></a><span id="l25.431" class="difflineplus">+	json_object_put((struct json_object*)lh_entry_v(ent));</span>
<a href="#l25.432"></a><span id="l25.432" class="difflineplus">+}</span>
<a href="#l25.433"></a><span id="l25.433" class="difflineplus">+</span>
<a href="#l25.434"></a><span id="l25.434" class="difflineplus">+static void json_object_object_delete(struct json_object* jso)</span>
<a href="#l25.435"></a><span id="l25.435" class="difflineplus">+{</span>
<a href="#l25.436"></a><span id="l25.436" class="difflineplus">+	lh_table_free(jso-&gt;o.c_object);</span>
<a href="#l25.437"></a><span id="l25.437" class="difflineplus">+	json_object_generic_delete(jso);</span>
<a href="#l25.438"></a><span id="l25.438" class="difflineplus">+}</span>
<a href="#l25.439"></a><span id="l25.439" class="difflineplus">+</span>
<a href="#l25.440"></a><span id="l25.440" class="difflineplus">+struct json_object* json_object_new_object(void)</span>
<a href="#l25.441"></a><span id="l25.441" class="difflineplus">+{</span>
<a href="#l25.442"></a><span id="l25.442" class="difflineplus">+	struct json_object *jso = json_object_new(json_type_object);</span>
<a href="#l25.443"></a><span id="l25.443" class="difflineplus">+	if (!jso)</span>
<a href="#l25.444"></a><span id="l25.444" class="difflineplus">+		return NULL;</span>
<a href="#l25.445"></a><span id="l25.445" class="difflineplus">+	jso-&gt;_delete = &amp;json_object_object_delete;</span>
<a href="#l25.446"></a><span id="l25.446" class="difflineplus">+	jso-&gt;_to_json_string = &amp;json_object_object_to_json_string;</span>
<a href="#l25.447"></a><span id="l25.447" class="difflineplus">+	jso-&gt;o.c_object = lh_kchar_table_new(JSON_OBJECT_DEF_HASH_ENTRIES,</span>
<a href="#l25.448"></a><span id="l25.448" class="difflineplus">+					     &amp;json_object_lh_entry_free);</span>
<a href="#l25.449"></a><span id="l25.449" class="difflineplus">+	if (!jso-&gt;o.c_object)</span>
<a href="#l25.450"></a><span id="l25.450" class="difflineplus">+	{</span>
<a href="#l25.451"></a><span id="l25.451" class="difflineplus">+		json_object_generic_delete(jso);</span>
<a href="#l25.452"></a><span id="l25.452" class="difflineplus">+		errno = ENOMEM;</span>
<a href="#l25.453"></a><span id="l25.453" class="difflineplus">+		return NULL;</span>
<a href="#l25.454"></a><span id="l25.454" class="difflineplus">+	}</span>
<a href="#l25.455"></a><span id="l25.455" class="difflineplus">+	return jso;</span>
<a href="#l25.456"></a><span id="l25.456" class="difflineplus">+}</span>
<a href="#l25.457"></a><span id="l25.457" class="difflineplus">+</span>
<a href="#l25.458"></a><span id="l25.458" class="difflineplus">+struct lh_table* json_object_get_object(const struct json_object *jso)</span>
<a href="#l25.459"></a><span id="l25.459" class="difflineplus">+{</span>
<a href="#l25.460"></a><span id="l25.460" class="difflineplus">+	if (!jso)</span>
<a href="#l25.461"></a><span id="l25.461" class="difflineplus">+		return NULL;</span>
<a href="#l25.462"></a><span id="l25.462" class="difflineplus">+	switch(jso-&gt;o_type)</span>
<a href="#l25.463"></a><span id="l25.463" class="difflineplus">+	{</span>
<a href="#l25.464"></a><span id="l25.464" class="difflineplus">+	case json_type_object:</span>
<a href="#l25.465"></a><span id="l25.465" class="difflineplus">+		return jso-&gt;o.c_object;</span>
<a href="#l25.466"></a><span id="l25.466" class="difflineplus">+	default:</span>
<a href="#l25.467"></a><span id="l25.467" class="difflineplus">+		return NULL;</span>
<a href="#l25.468"></a><span id="l25.468" class="difflineplus">+	}</span>
<a href="#l25.469"></a><span id="l25.469" class="difflineplus">+}</span>
<a href="#l25.470"></a><span id="l25.470" class="difflineplus">+</span>
<a href="#l25.471"></a><span id="l25.471" class="difflineplus">+int json_object_object_add_ex(struct json_object* jso,</span>
<a href="#l25.472"></a><span id="l25.472" class="difflineplus">+	const char *const key,</span>
<a href="#l25.473"></a><span id="l25.473" class="difflineplus">+	struct json_object *const val,</span>
<a href="#l25.474"></a><span id="l25.474" class="difflineplus">+	const unsigned opts)</span>
<a href="#l25.475"></a><span id="l25.475" class="difflineplus">+{</span>
<a href="#l25.476"></a><span id="l25.476" class="difflineplus">+	struct json_object *existing_value = NULL;</span>
<a href="#l25.477"></a><span id="l25.477" class="difflineplus">+	struct lh_entry *existing_entry;</span>
<a href="#l25.478"></a><span id="l25.478" class="difflineplus">+	unsigned long hash;</span>
<a href="#l25.479"></a><span id="l25.479" class="difflineplus">+</span>
<a href="#l25.480"></a><span id="l25.480" class="difflineplus">+	assert(json_object_get_type(jso) == json_type_object);</span>
<a href="#l25.481"></a><span id="l25.481" class="difflineplus">+</span>
<a href="#l25.482"></a><span id="l25.482" class="difflineplus">+	// We lookup the entry and replace the value, rather than just deleting</span>
<a href="#l25.483"></a><span id="l25.483" class="difflineplus">+	// and re-adding it, so the existing key remains valid.</span>
<a href="#l25.484"></a><span id="l25.484" class="difflineplus">+	hash = lh_get_hash(jso-&gt;o.c_object, (const void *)key);</span>
<a href="#l25.485"></a><span id="l25.485" class="difflineplus">+	existing_entry = (opts &amp; JSON_C_OBJECT_ADD_KEY_IS_NEW) ? NULL : </span>
<a href="#l25.486"></a><span id="l25.486" class="difflineplus">+			      lh_table_lookup_entry_w_hash(jso-&gt;o.c_object,</span>
<a href="#l25.487"></a><span id="l25.487" class="difflineplus">+							   (const void *)key, hash);</span>
<a href="#l25.488"></a><span id="l25.488" class="difflineplus">+</span>
<a href="#l25.489"></a><span id="l25.489" class="difflineplus">+	// The caller must avoid creating loops in the object tree, but do a</span>
<a href="#l25.490"></a><span id="l25.490" class="difflineplus">+	// quick check anyway to make sure we're not creating a trivial loop.</span>
<a href="#l25.491"></a><span id="l25.491" class="difflineplus">+	if (jso == val)</span>
<a href="#l25.492"></a><span id="l25.492" class="difflineplus">+		return -1;</span>
<a href="#l25.493"></a><span id="l25.493" class="difflineplus">+</span>
<a href="#l25.494"></a><span id="l25.494" class="difflineplus">+	if (!existing_entry)</span>
<a href="#l25.495"></a><span id="l25.495" class="difflineplus">+	{</span>
<a href="#l25.496"></a><span id="l25.496" class="difflineplus">+		const void *const k = (opts &amp; JSON_C_OBJECT_KEY_IS_CONSTANT) ?</span>
<a href="#l25.497"></a><span id="l25.497" class="difflineplus">+					(const void *)key : strdup(key);</span>
<a href="#l25.498"></a><span id="l25.498" class="difflineplus">+		if (k == NULL)</span>
<a href="#l25.499"></a><span id="l25.499" class="difflineplus">+			return -1;</span>
<a href="#l25.500"></a><span id="l25.500" class="difflineplus">+		return lh_table_insert_w_hash(jso-&gt;o.c_object, k, val, hash, opts);</span>
<a href="#l25.501"></a><span id="l25.501" class="difflineplus">+	}</span>
<a href="#l25.502"></a><span id="l25.502" class="difflineplus">+	existing_value = (json_object *) lh_entry_v(existing_entry);</span>
<a href="#l25.503"></a><span id="l25.503" class="difflineplus">+	if (existing_value)</span>
<a href="#l25.504"></a><span id="l25.504" class="difflineplus">+		json_object_put(existing_value);</span>
<a href="#l25.505"></a><span id="l25.505" class="difflineplus">+	existing_entry-&gt;v = val;</span>
<a href="#l25.506"></a><span id="l25.506" class="difflineplus">+	return 0;</span>
<a href="#l25.507"></a><span id="l25.507" class="difflineplus">+}</span>
<a href="#l25.508"></a><span id="l25.508" class="difflineplus">+</span>
<a href="#l25.509"></a><span id="l25.509" class="difflineplus">+int json_object_object_add(struct json_object* jso, const char *key,</span>
<a href="#l25.510"></a><span id="l25.510" class="difflineplus">+                           struct json_object *val)</span>
<a href="#l25.511"></a><span id="l25.511" class="difflineplus">+{</span>
<a href="#l25.512"></a><span id="l25.512" class="difflineplus">+	return json_object_object_add_ex(jso, key, val, 0);</span>
<a href="#l25.513"></a><span id="l25.513" class="difflineplus">+}</span>
<a href="#l25.514"></a><span id="l25.514" class="difflineplus">+</span>
<a href="#l25.515"></a><span id="l25.515" class="difflineplus">+</span>
<a href="#l25.516"></a><span id="l25.516" class="difflineplus">+int json_object_object_length(const struct json_object *jso)</span>
<a href="#l25.517"></a><span id="l25.517" class="difflineplus">+{</span>
<a href="#l25.518"></a><span id="l25.518" class="difflineplus">+	assert(json_object_get_type(jso) == json_type_object);</span>
<a href="#l25.519"></a><span id="l25.519" class="difflineplus">+	return lh_table_length(jso-&gt;o.c_object);</span>
<a href="#l25.520"></a><span id="l25.520" class="difflineplus">+}</span>
<a href="#l25.521"></a><span id="l25.521" class="difflineplus">+</span>
<a href="#l25.522"></a><span id="l25.522" class="difflineplus">+size_t json_c_object_sizeof(void)</span>
<a href="#l25.523"></a><span id="l25.523" class="difflineplus">+{</span>
<a href="#l25.524"></a><span id="l25.524" class="difflineplus">+	return sizeof(struct json_object);</span>
<a href="#l25.525"></a><span id="l25.525" class="difflineplus">+}</span>
<a href="#l25.526"></a><span id="l25.526" class="difflineplus">+</span>
<a href="#l25.527"></a><span id="l25.527" class="difflineplus">+struct json_object* json_object_object_get(const struct json_object* jso,</span>
<a href="#l25.528"></a><span id="l25.528" class="difflineplus">+					   const char *key)</span>
<a href="#l25.529"></a><span id="l25.529" class="difflineplus">+{</span>
<a href="#l25.530"></a><span id="l25.530" class="difflineplus">+	struct json_object *result = NULL;</span>
<a href="#l25.531"></a><span id="l25.531" class="difflineplus">+	json_object_object_get_ex(jso, key, &amp;result);</span>
<a href="#l25.532"></a><span id="l25.532" class="difflineplus">+	return result;</span>
<a href="#l25.533"></a><span id="l25.533" class="difflineplus">+}</span>
<a href="#l25.534"></a><span id="l25.534" class="difflineplus">+</span>
<a href="#l25.535"></a><span id="l25.535" class="difflineplus">+json_bool json_object_object_get_ex(const struct json_object* jso, const char *key,</span>
<a href="#l25.536"></a><span id="l25.536" class="difflineplus">+				    struct json_object **value)</span>
<a href="#l25.537"></a><span id="l25.537" class="difflineplus">+{</span>
<a href="#l25.538"></a><span id="l25.538" class="difflineplus">+	if (value != NULL)</span>
<a href="#l25.539"></a><span id="l25.539" class="difflineplus">+		*value = NULL;</span>
<a href="#l25.540"></a><span id="l25.540" class="difflineplus">+</span>
<a href="#l25.541"></a><span id="l25.541" class="difflineplus">+	if (NULL == jso)</span>
<a href="#l25.542"></a><span id="l25.542" class="difflineplus">+		return FALSE;</span>
<a href="#l25.543"></a><span id="l25.543" class="difflineplus">+</span>
<a href="#l25.544"></a><span id="l25.544" class="difflineplus">+	switch(jso-&gt;o_type)</span>
<a href="#l25.545"></a><span id="l25.545" class="difflineplus">+	{</span>
<a href="#l25.546"></a><span id="l25.546" class="difflineplus">+	case json_type_object:</span>
<a href="#l25.547"></a><span id="l25.547" class="difflineplus">+		return lh_table_lookup_ex(jso-&gt;o.c_object, (const void *) key,</span>
<a href="#l25.548"></a><span id="l25.548" class="difflineplus">+					  (void**) value);</span>
<a href="#l25.549"></a><span id="l25.549" class="difflineplus">+	default:</span>
<a href="#l25.550"></a><span id="l25.550" class="difflineplus">+		if (value != NULL)</span>
<a href="#l25.551"></a><span id="l25.551" class="difflineplus">+			*value = NULL;</span>
<a href="#l25.552"></a><span id="l25.552" class="difflineplus">+		return FALSE;</span>
<a href="#l25.553"></a><span id="l25.553" class="difflineplus">+	}</span>
<a href="#l25.554"></a><span id="l25.554" class="difflineplus">+}</span>
<a href="#l25.555"></a><span id="l25.555" class="difflineplus">+</span>
<a href="#l25.556"></a><span id="l25.556" class="difflineplus">+void json_object_object_del(struct json_object* jso, const char *key)</span>
<a href="#l25.557"></a><span id="l25.557" class="difflineplus">+{</span>
<a href="#l25.558"></a><span id="l25.558" class="difflineplus">+	assert(json_object_get_type(jso) == json_type_object);</span>
<a href="#l25.559"></a><span id="l25.559" class="difflineplus">+	lh_table_delete(jso-&gt;o.c_object, key);</span>
<a href="#l25.560"></a><span id="l25.560" class="difflineplus">+}</span>
<a href="#l25.561"></a><span id="l25.561" class="difflineplus">+</span>
<a href="#l25.562"></a><span id="l25.562" class="difflineplus">+</span>
<a href="#l25.563"></a><span id="l25.563" class="difflineplus">+/* json_object_boolean */</span>
<a href="#l25.564"></a><span id="l25.564" class="difflineplus">+</span>
<a href="#l25.565"></a><span id="l25.565" class="difflineplus">+static int json_object_boolean_to_json_string(struct json_object* jso,</span>
<a href="#l25.566"></a><span id="l25.566" class="difflineplus">+					      struct printbuf *pb,</span>
<a href="#l25.567"></a><span id="l25.567" class="difflineplus">+					      int level,</span>
<a href="#l25.568"></a><span id="l25.568" class="difflineplus">+					      int flags)</span>
<a href="#l25.569"></a><span id="l25.569" class="difflineplus">+{</span>
<a href="#l25.570"></a><span id="l25.570" class="difflineplus">+	if (jso-&gt;o.c_boolean)</span>
<a href="#l25.571"></a><span id="l25.571" class="difflineplus">+		return printbuf_strappend(pb, &quot;true&quot;);</span>
<a href="#l25.572"></a><span id="l25.572" class="difflineplus">+	return printbuf_strappend(pb, &quot;false&quot;);</span>
<a href="#l25.573"></a><span id="l25.573" class="difflineplus">+}</span>
<a href="#l25.574"></a><span id="l25.574" class="difflineplus">+</span>
<a href="#l25.575"></a><span id="l25.575" class="difflineplus">+struct json_object* json_object_new_boolean(json_bool b)</span>
<a href="#l25.576"></a><span id="l25.576" class="difflineplus">+{</span>
<a href="#l25.577"></a><span id="l25.577" class="difflineplus">+	struct json_object *jso = json_object_new(json_type_boolean);</span>
<a href="#l25.578"></a><span id="l25.578" class="difflineplus">+	if (!jso)</span>
<a href="#l25.579"></a><span id="l25.579" class="difflineplus">+		return NULL;</span>
<a href="#l25.580"></a><span id="l25.580" class="difflineplus">+	jso-&gt;_to_json_string = &amp;json_object_boolean_to_json_string;</span>
<a href="#l25.581"></a><span id="l25.581" class="difflineplus">+	jso-&gt;o.c_boolean = b;</span>
<a href="#l25.582"></a><span id="l25.582" class="difflineplus">+	return jso;</span>
<a href="#l25.583"></a><span id="l25.583" class="difflineplus">+}</span>
<a href="#l25.584"></a><span id="l25.584" class="difflineplus">+</span>
<a href="#l25.585"></a><span id="l25.585" class="difflineplus">+json_bool json_object_get_boolean(const struct json_object *jso)</span>
<a href="#l25.586"></a><span id="l25.586" class="difflineplus">+{</span>
<a href="#l25.587"></a><span id="l25.587" class="difflineplus">+	if (!jso)</span>
<a href="#l25.588"></a><span id="l25.588" class="difflineplus">+		return FALSE;</span>
<a href="#l25.589"></a><span id="l25.589" class="difflineplus">+	switch(jso-&gt;o_type)</span>
<a href="#l25.590"></a><span id="l25.590" class="difflineplus">+	{</span>
<a href="#l25.591"></a><span id="l25.591" class="difflineplus">+	case json_type_boolean:</span>
<a href="#l25.592"></a><span id="l25.592" class="difflineplus">+		return jso-&gt;o.c_boolean;</span>
<a href="#l25.593"></a><span id="l25.593" class="difflineplus">+	case json_type_int:</span>
<a href="#l25.594"></a><span id="l25.594" class="difflineplus">+		return (jso-&gt;o.c_int64 != 0);</span>
<a href="#l25.595"></a><span id="l25.595" class="difflineplus">+	case json_type_double:</span>
<a href="#l25.596"></a><span id="l25.596" class="difflineplus">+		return (jso-&gt;o.c_double != 0);</span>
<a href="#l25.597"></a><span id="l25.597" class="difflineplus">+	case json_type_string:</span>
<a href="#l25.598"></a><span id="l25.598" class="difflineplus">+		return (jso-&gt;o.c_string.len != 0);</span>
<a href="#l25.599"></a><span id="l25.599" class="difflineplus">+	default:</span>
<a href="#l25.600"></a><span id="l25.600" class="difflineplus">+		return FALSE;</span>
<a href="#l25.601"></a><span id="l25.601" class="difflineplus">+	}</span>
<a href="#l25.602"></a><span id="l25.602" class="difflineplus">+}</span>
<a href="#l25.603"></a><span id="l25.603" class="difflineplus">+</span>
<a href="#l25.604"></a><span id="l25.604" class="difflineplus">+int json_object_set_boolean(struct json_object *jso,json_bool new_value){</span>
<a href="#l25.605"></a><span id="l25.605" class="difflineplus">+	if (!jso || jso-&gt;o_type!=json_type_boolean)</span>
<a href="#l25.606"></a><span id="l25.606" class="difflineplus">+		return 0;</span>
<a href="#l25.607"></a><span id="l25.607" class="difflineplus">+	jso-&gt;o.c_boolean=new_value;</span>
<a href="#l25.608"></a><span id="l25.608" class="difflineplus">+	return 1;</span>
<a href="#l25.609"></a><span id="l25.609" class="difflineplus">+}</span>
<a href="#l25.610"></a><span id="l25.610" class="difflineplus">+</span>
<a href="#l25.611"></a><span id="l25.611" class="difflineplus">+</span>
<a href="#l25.612"></a><span id="l25.612" class="difflineplus">+/* json_object_int */</span>
<a href="#l25.613"></a><span id="l25.613" class="difflineplus">+</span>
<a href="#l25.614"></a><span id="l25.614" class="difflineplus">+static int json_object_int_to_json_string(struct json_object* jso,</span>
<a href="#l25.615"></a><span id="l25.615" class="difflineplus">+					  struct printbuf *pb,</span>
<a href="#l25.616"></a><span id="l25.616" class="difflineplus">+					  int level,</span>
<a href="#l25.617"></a><span id="l25.617" class="difflineplus">+					  int flags)</span>
<a href="#l25.618"></a><span id="l25.618" class="difflineplus">+{</span>
<a href="#l25.619"></a><span id="l25.619" class="difflineplus">+	/* room for 19 digits, the sign char, and a null term */</span>
<a href="#l25.620"></a><span id="l25.620" class="difflineplus">+	char sbuf[21];</span>
<a href="#l25.621"></a><span id="l25.621" class="difflineplus">+	snprintf(sbuf, sizeof(sbuf), &quot;%&quot; PRId64, jso-&gt;o.c_int64);</span>
<a href="#l25.622"></a><span id="l25.622" class="difflineplus">+	return printbuf_memappend (pb, sbuf, strlen(sbuf));</span>
<a href="#l25.623"></a><span id="l25.623" class="difflineplus">+}</span>
<a href="#l25.624"></a><span id="l25.624" class="difflineplus">+</span>
<a href="#l25.625"></a><span id="l25.625" class="difflineplus">+struct json_object* json_object_new_int(int32_t i)</span>
<a href="#l25.626"></a><span id="l25.626" class="difflineplus">+{</span>
<a href="#l25.627"></a><span id="l25.627" class="difflineplus">+	struct json_object *jso = json_object_new(json_type_int);</span>
<a href="#l25.628"></a><span id="l25.628" class="difflineplus">+	if (!jso)</span>
<a href="#l25.629"></a><span id="l25.629" class="difflineplus">+		return NULL;</span>
<a href="#l25.630"></a><span id="l25.630" class="difflineplus">+	jso-&gt;_to_json_string = &amp;json_object_int_to_json_string;</span>
<a href="#l25.631"></a><span id="l25.631" class="difflineplus">+	jso-&gt;o.c_int64 = i;</span>
<a href="#l25.632"></a><span id="l25.632" class="difflineplus">+	return jso;</span>
<a href="#l25.633"></a><span id="l25.633" class="difflineplus">+}</span>
<a href="#l25.634"></a><span id="l25.634" class="difflineplus">+</span>
<a href="#l25.635"></a><span id="l25.635" class="difflineplus">+int32_t json_object_get_int(const struct json_object *jso)</span>
<a href="#l25.636"></a><span id="l25.636" class="difflineplus">+{</span>
<a href="#l25.637"></a><span id="l25.637" class="difflineplus">+  int64_t cint64;</span>
<a href="#l25.638"></a><span id="l25.638" class="difflineplus">+  enum json_type o_type;</span>
<a href="#l25.639"></a><span id="l25.639" class="difflineplus">+</span>
<a href="#l25.640"></a><span id="l25.640" class="difflineplus">+  if(!jso) return 0;</span>
<a href="#l25.641"></a><span id="l25.641" class="difflineplus">+</span>
<a href="#l25.642"></a><span id="l25.642" class="difflineplus">+  o_type = jso-&gt;o_type;</span>
<a href="#l25.643"></a><span id="l25.643" class="difflineplus">+  cint64 = jso-&gt;o.c_int64;</span>
<a href="#l25.644"></a><span id="l25.644" class="difflineplus">+</span>
<a href="#l25.645"></a><span id="l25.645" class="difflineplus">+  if (o_type == json_type_string)</span>
<a href="#l25.646"></a><span id="l25.646" class="difflineplus">+  {</span>
<a href="#l25.647"></a><span id="l25.647" class="difflineplus">+	/*</span>
<a href="#l25.648"></a><span id="l25.648" class="difflineplus">+	 * Parse strings into 64-bit numbers, then use the</span>
<a href="#l25.649"></a><span id="l25.649" class="difflineplus">+	 * 64-to-32-bit number handling below.</span>
<a href="#l25.650"></a><span id="l25.650" class="difflineplus">+	 */</span>
<a href="#l25.651"></a><span id="l25.651" class="difflineplus">+	if (json_parse_int64(get_string_component(jso), &amp;cint64) != 0)</span>
<a href="#l25.652"></a><span id="l25.652" class="difflineplus">+		return 0; /* whoops, it didn't work. */</span>
<a href="#l25.653"></a><span id="l25.653" class="difflineplus">+	o_type = json_type_int;</span>
<a href="#l25.654"></a><span id="l25.654" class="difflineplus">+  }</span>
<a href="#l25.655"></a><span id="l25.655" class="difflineplus">+</span>
<a href="#l25.656"></a><span id="l25.656" class="difflineplus">+  switch(o_type) {</span>
<a href="#l25.657"></a><span id="l25.657" class="difflineplus">+  case json_type_int:</span>
<a href="#l25.658"></a><span id="l25.658" class="difflineplus">+	/* Make sure we return the correct values for out of range numbers. */</span>
<a href="#l25.659"></a><span id="l25.659" class="difflineplus">+	if (cint64 &lt;= INT32_MIN)</span>
<a href="#l25.660"></a><span id="l25.660" class="difflineplus">+		return INT32_MIN;</span>
<a href="#l25.661"></a><span id="l25.661" class="difflineplus">+	if (cint64 &gt;= INT32_MAX)</span>
<a href="#l25.662"></a><span id="l25.662" class="difflineplus">+		return INT32_MAX;</span>
<a href="#l25.663"></a><span id="l25.663" class="difflineplus">+	return (int32_t) cint64;</span>
<a href="#l25.664"></a><span id="l25.664" class="difflineplus">+  case json_type_double:</span>
<a href="#l25.665"></a><span id="l25.665" class="difflineplus">+    if (jso-&gt;o.c_double &lt;= INT32_MIN)</span>
<a href="#l25.666"></a><span id="l25.666" class="difflineplus">+      return INT32_MIN;</span>
<a href="#l25.667"></a><span id="l25.667" class="difflineplus">+    if (jso-&gt;o.c_double &gt;= INT32_MAX)</span>
<a href="#l25.668"></a><span id="l25.668" class="difflineplus">+      return INT32_MAX;</span>
<a href="#l25.669"></a><span id="l25.669" class="difflineplus">+    return (int32_t)jso-&gt;o.c_double;</span>
<a href="#l25.670"></a><span id="l25.670" class="difflineplus">+  case json_type_boolean:</span>
<a href="#l25.671"></a><span id="l25.671" class="difflineplus">+    return jso-&gt;o.c_boolean;</span>
<a href="#l25.672"></a><span id="l25.672" class="difflineplus">+  default:</span>
<a href="#l25.673"></a><span id="l25.673" class="difflineplus">+    return 0;</span>
<a href="#l25.674"></a><span id="l25.674" class="difflineplus">+  }</span>
<a href="#l25.675"></a><span id="l25.675" class="difflineplus">+}</span>
<a href="#l25.676"></a><span id="l25.676" class="difflineplus">+</span>
<a href="#l25.677"></a><span id="l25.677" class="difflineplus">+int json_object_set_int(struct json_object *jso,int new_value){</span>
<a href="#l25.678"></a><span id="l25.678" class="difflineplus">+	if (!jso || jso-&gt;o_type!=json_type_int)</span>
<a href="#l25.679"></a><span id="l25.679" class="difflineplus">+		return 0;</span>
<a href="#l25.680"></a><span id="l25.680" class="difflineplus">+	jso-&gt;o.c_int64=new_value;</span>
<a href="#l25.681"></a><span id="l25.681" class="difflineplus">+	return 1;</span>
<a href="#l25.682"></a><span id="l25.682" class="difflineplus">+}</span>
<a href="#l25.683"></a><span id="l25.683" class="difflineplus">+</span>
<a href="#l25.684"></a><span id="l25.684" class="difflineplus">+struct json_object* json_object_new_int64(int64_t i)</span>
<a href="#l25.685"></a><span id="l25.685" class="difflineplus">+{</span>
<a href="#l25.686"></a><span id="l25.686" class="difflineplus">+	struct json_object *jso = json_object_new(json_type_int);</span>
<a href="#l25.687"></a><span id="l25.687" class="difflineplus">+	if (!jso)</span>
<a href="#l25.688"></a><span id="l25.688" class="difflineplus">+		return NULL;</span>
<a href="#l25.689"></a><span id="l25.689" class="difflineplus">+	jso-&gt;_to_json_string = &amp;json_object_int_to_json_string;</span>
<a href="#l25.690"></a><span id="l25.690" class="difflineplus">+	jso-&gt;o.c_int64 = i;</span>
<a href="#l25.691"></a><span id="l25.691" class="difflineplus">+	return jso;</span>
<a href="#l25.692"></a><span id="l25.692" class="difflineplus">+}</span>
<a href="#l25.693"></a><span id="l25.693" class="difflineplus">+</span>
<a href="#l25.694"></a><span id="l25.694" class="difflineplus">+int64_t json_object_get_int64(const struct json_object *jso)</span>
<a href="#l25.695"></a><span id="l25.695" class="difflineplus">+{</span>
<a href="#l25.696"></a><span id="l25.696" class="difflineplus">+	int64_t cint;</span>
<a href="#l25.697"></a><span id="l25.697" class="difflineplus">+</span>
<a href="#l25.698"></a><span id="l25.698" class="difflineplus">+	if (!jso)</span>
<a href="#l25.699"></a><span id="l25.699" class="difflineplus">+		return 0;</span>
<a href="#l25.700"></a><span id="l25.700" class="difflineplus">+	switch(jso-&gt;o_type)</span>
<a href="#l25.701"></a><span id="l25.701" class="difflineplus">+	{</span>
<a href="#l25.702"></a><span id="l25.702" class="difflineplus">+	case json_type_int:</span>
<a href="#l25.703"></a><span id="l25.703" class="difflineplus">+		return jso-&gt;o.c_int64;</span>
<a href="#l25.704"></a><span id="l25.704" class="difflineplus">+	case json_type_double:</span>
<a href="#l25.705"></a><span id="l25.705" class="difflineplus">+		if (jso-&gt;o.c_double &gt;= INT64_MAX)</span>
<a href="#l25.706"></a><span id="l25.706" class="difflineplus">+			return INT64_MAX;</span>
<a href="#l25.707"></a><span id="l25.707" class="difflineplus">+		if (jso-&gt;o.c_double &lt;= INT64_MIN)</span>
<a href="#l25.708"></a><span id="l25.708" class="difflineplus">+			return INT64_MIN;</span>
<a href="#l25.709"></a><span id="l25.709" class="difflineplus">+		return (int64_t)jso-&gt;o.c_double;</span>
<a href="#l25.710"></a><span id="l25.710" class="difflineplus">+	case json_type_boolean:</span>
<a href="#l25.711"></a><span id="l25.711" class="difflineplus">+		return jso-&gt;o.c_boolean;</span>
<a href="#l25.712"></a><span id="l25.712" class="difflineplus">+	case json_type_string:</span>
<a href="#l25.713"></a><span id="l25.713" class="difflineplus">+		if (json_parse_int64(get_string_component(jso), &amp;cint) == 0)</span>
<a href="#l25.714"></a><span id="l25.714" class="difflineplus">+			return cint;</span>
<a href="#l25.715"></a><span id="l25.715" class="difflineplus">+		/* FALLTHRU */</span>
<a href="#l25.716"></a><span id="l25.716" class="difflineplus">+	default:</span>
<a href="#l25.717"></a><span id="l25.717" class="difflineplus">+		return 0;</span>
<a href="#l25.718"></a><span id="l25.718" class="difflineplus">+	}</span>
<a href="#l25.719"></a><span id="l25.719" class="difflineplus">+}</span>
<a href="#l25.720"></a><span id="l25.720" class="difflineplus">+</span>
<a href="#l25.721"></a><span id="l25.721" class="difflineplus">+int json_object_set_int64(struct json_object *jso,int64_t new_value){</span>
<a href="#l25.722"></a><span id="l25.722" class="difflineplus">+	if (!jso || jso-&gt;o_type!=json_type_int)</span>
<a href="#l25.723"></a><span id="l25.723" class="difflineplus">+		return 0;</span>
<a href="#l25.724"></a><span id="l25.724" class="difflineplus">+	jso-&gt;o.c_int64=new_value;</span>
<a href="#l25.725"></a><span id="l25.725" class="difflineplus">+	return 1;</span>
<a href="#l25.726"></a><span id="l25.726" class="difflineplus">+}</span>
<a href="#l25.727"></a><span id="l25.727" class="difflineplus">+</span>
<a href="#l25.728"></a><span id="l25.728" class="difflineplus">+int json_object_int_inc(struct json_object *jso, int64_t val) {</span>
<a href="#l25.729"></a><span id="l25.729" class="difflineplus">+	if (!jso || jso-&gt;o_type != json_type_int)</span>
<a href="#l25.730"></a><span id="l25.730" class="difflineplus">+		return 0;</span>
<a href="#l25.731"></a><span id="l25.731" class="difflineplus">+	if (val &gt; 0 &amp;&amp; jso-&gt;o.c_int64 &gt; INT64_MAX - val) {</span>
<a href="#l25.732"></a><span id="l25.732" class="difflineplus">+		jso-&gt;o.c_int64 = INT64_MAX;</span>
<a href="#l25.733"></a><span id="l25.733" class="difflineplus">+	} else if (val &lt; 0 &amp;&amp; jso-&gt;o.c_int64 &lt; INT64_MIN - val) {</span>
<a href="#l25.734"></a><span id="l25.734" class="difflineplus">+		jso-&gt;o.c_int64 = INT64_MIN;</span>
<a href="#l25.735"></a><span id="l25.735" class="difflineplus">+	} else {</span>
<a href="#l25.736"></a><span id="l25.736" class="difflineplus">+		jso-&gt;o.c_int64 += val;</span>
<a href="#l25.737"></a><span id="l25.737" class="difflineplus">+	}</span>
<a href="#l25.738"></a><span id="l25.738" class="difflineplus">+	return 1;</span>
<a href="#l25.739"></a><span id="l25.739" class="difflineplus">+}</span>
<a href="#l25.740"></a><span id="l25.740" class="difflineplus">+</span>
<a href="#l25.741"></a><span id="l25.741" class="difflineplus">+/* json_object_double */</span>
<a href="#l25.742"></a><span id="l25.742" class="difflineplus">+</span>
<a href="#l25.743"></a><span id="l25.743" class="difflineplus">+#if defined(HAVE___THREAD)</span>
<a href="#l25.744"></a><span id="l25.744" class="difflineplus">+// i.e. __thread or __declspec(thread)</span>
<a href="#l25.745"></a><span id="l25.745" class="difflineplus">+static SPEC___THREAD char *tls_serialization_float_format = NULL;</span>
<a href="#l25.746"></a><span id="l25.746" class="difflineplus">+#endif</span>
<a href="#l25.747"></a><span id="l25.747" class="difflineplus">+static char *global_serialization_float_format = NULL;</span>
<a href="#l25.748"></a><span id="l25.748" class="difflineplus">+</span>
<a href="#l25.749"></a><span id="l25.749" class="difflineplus">+int json_c_set_serialization_double_format(const char *double_format, int global_or_thread)</span>
<a href="#l25.750"></a><span id="l25.750" class="difflineplus">+{</span>
<a href="#l25.751"></a><span id="l25.751" class="difflineplus">+	if (global_or_thread == JSON_C_OPTION_GLOBAL)</span>
<a href="#l25.752"></a><span id="l25.752" class="difflineplus">+	{</span>
<a href="#l25.753"></a><span id="l25.753" class="difflineplus">+#if defined(HAVE___THREAD)</span>
<a href="#l25.754"></a><span id="l25.754" class="difflineplus">+		if (tls_serialization_float_format)</span>
<a href="#l25.755"></a><span id="l25.755" class="difflineplus">+		{</span>
<a href="#l25.756"></a><span id="l25.756" class="difflineplus">+			free(tls_serialization_float_format);</span>
<a href="#l25.757"></a><span id="l25.757" class="difflineplus">+			tls_serialization_float_format = NULL;</span>
<a href="#l25.758"></a><span id="l25.758" class="difflineplus">+		}</span>
<a href="#l25.759"></a><span id="l25.759" class="difflineplus">+#endif</span>
<a href="#l25.760"></a><span id="l25.760" class="difflineplus">+		if (global_serialization_float_format)</span>
<a href="#l25.761"></a><span id="l25.761" class="difflineplus">+			free(global_serialization_float_format);</span>
<a href="#l25.762"></a><span id="l25.762" class="difflineplus">+		global_serialization_float_format = double_format ? strdup(double_format) : NULL;</span>
<a href="#l25.763"></a><span id="l25.763" class="difflineplus">+	}</span>
<a href="#l25.764"></a><span id="l25.764" class="difflineplus">+	else if (global_or_thread == JSON_C_OPTION_THREAD)</span>
<a href="#l25.765"></a><span id="l25.765" class="difflineplus">+	{</span>
<a href="#l25.766"></a><span id="l25.766" class="difflineplus">+#if defined(HAVE___THREAD)</span>
<a href="#l25.767"></a><span id="l25.767" class="difflineplus">+		if (tls_serialization_float_format)</span>
<a href="#l25.768"></a><span id="l25.768" class="difflineplus">+		{</span>
<a href="#l25.769"></a><span id="l25.769" class="difflineplus">+			free(tls_serialization_float_format);</span>
<a href="#l25.770"></a><span id="l25.770" class="difflineplus">+			tls_serialization_float_format = NULL;</span>
<a href="#l25.771"></a><span id="l25.771" class="difflineplus">+		}</span>
<a href="#l25.772"></a><span id="l25.772" class="difflineplus">+		tls_serialization_float_format = double_format ? strdup(double_format) : NULL;</span>
<a href="#l25.773"></a><span id="l25.773" class="difflineplus">+#else</span>
<a href="#l25.774"></a><span id="l25.774" class="difflineplus">+		_json_c_set_last_err(&quot;json_c_set_option: not compiled with __thread support\n&quot;);</span>
<a href="#l25.775"></a><span id="l25.775" class="difflineplus">+		return -1;</span>
<a href="#l25.776"></a><span id="l25.776" class="difflineplus">+#endif</span>
<a href="#l25.777"></a><span id="l25.777" class="difflineplus">+	}</span>
<a href="#l25.778"></a><span id="l25.778" class="difflineplus">+	else</span>
<a href="#l25.779"></a><span id="l25.779" class="difflineplus">+	{</span>
<a href="#l25.780"></a><span id="l25.780" class="difflineplus">+		_json_c_set_last_err(&quot;json_c_set_option: invalid global_or_thread value: %d\n&quot;, global_or_thread);</span>
<a href="#l25.781"></a><span id="l25.781" class="difflineplus">+		return -1;</span>
<a href="#l25.782"></a><span id="l25.782" class="difflineplus">+	}</span>
<a href="#l25.783"></a><span id="l25.783" class="difflineplus">+	return 0;</span>
<a href="#l25.784"></a><span id="l25.784" class="difflineplus">+}</span>
<a href="#l25.785"></a><span id="l25.785" class="difflineplus">+</span>
<a href="#l25.786"></a><span id="l25.786" class="difflineplus">+</span>
<a href="#l25.787"></a><span id="l25.787" class="difflineplus">+static int json_object_double_to_json_string_format(struct json_object* jso,</span>
<a href="#l25.788"></a><span id="l25.788" class="difflineplus">+						    struct printbuf *pb,</span>
<a href="#l25.789"></a><span id="l25.789" class="difflineplus">+						    int level,</span>
<a href="#l25.790"></a><span id="l25.790" class="difflineplus">+						    int flags,</span>
<a href="#l25.791"></a><span id="l25.791" class="difflineplus">+						    const char *format)</span>
<a href="#l25.792"></a><span id="l25.792" class="difflineplus">+{</span>
<a href="#l25.793"></a><span id="l25.793" class="difflineplus">+	char buf[128], *p, *q;</span>
<a href="#l25.794"></a><span id="l25.794" class="difflineplus">+	int size;</span>
<a href="#l25.795"></a><span id="l25.795" class="difflineplus">+	/* Although JSON RFC does not support</span>
<a href="#l25.796"></a><span id="l25.796" class="difflineplus">+	NaN or Infinity as numeric values</span>
<a href="#l25.797"></a><span id="l25.797" class="difflineplus">+	ECMA 262 section 9.8.1 defines</span>
<a href="#l25.798"></a><span id="l25.798" class="difflineplus">+	how to handle these cases as strings */</span>
<a href="#l25.799"></a><span id="l25.799" class="difflineplus">+	if (isnan(jso-&gt;o.c_double))</span>
<a href="#l25.800"></a><span id="l25.800" class="difflineplus">+	{</span>
<a href="#l25.801"></a><span id="l25.801" class="difflineplus">+		size = snprintf(buf, sizeof(buf), &quot;NaN&quot;);</span>
<a href="#l25.802"></a><span id="l25.802" class="difflineplus">+	}</span>
<a href="#l25.803"></a><span id="l25.803" class="difflineplus">+	else if (isinf(jso-&gt;o.c_double))</span>
<a href="#l25.804"></a><span id="l25.804" class="difflineplus">+	{</span>
<a href="#l25.805"></a><span id="l25.805" class="difflineplus">+		if(jso-&gt;o.c_double &gt; 0)</span>
<a href="#l25.806"></a><span id="l25.806" class="difflineplus">+			size = snprintf(buf, sizeof(buf), &quot;Infinity&quot;);</span>
<a href="#l25.807"></a><span id="l25.807" class="difflineplus">+		else</span>
<a href="#l25.808"></a><span id="l25.808" class="difflineplus">+			size = snprintf(buf, sizeof(buf), &quot;-Infinity&quot;);</span>
<a href="#l25.809"></a><span id="l25.809" class="difflineplus">+	}</span>
<a href="#l25.810"></a><span id="l25.810" class="difflineplus">+	else</span>
<a href="#l25.811"></a><span id="l25.811" class="difflineplus">+	{</span>
<a href="#l25.812"></a><span id="l25.812" class="difflineplus">+		const char *std_format = &quot;%.17g&quot;;</span>
<a href="#l25.813"></a><span id="l25.813" class="difflineplus">+		int format_drops_decimals = 0;</span>
<a href="#l25.814"></a><span id="l25.814" class="difflineplus">+</span>
<a href="#l25.815"></a><span id="l25.815" class="difflineplus">+		if (!format)</span>
<a href="#l25.816"></a><span id="l25.816" class="difflineplus">+		{</span>
<a href="#l25.817"></a><span id="l25.817" class="difflineplus">+#if defined(HAVE___THREAD)</span>
<a href="#l25.818"></a><span id="l25.818" class="difflineplus">+			if (tls_serialization_float_format)</span>
<a href="#l25.819"></a><span id="l25.819" class="difflineplus">+				format = tls_serialization_float_format;</span>
<a href="#l25.820"></a><span id="l25.820" class="difflineplus">+			else</span>
<a href="#l25.821"></a><span id="l25.821" class="difflineplus">+#endif</span>
<a href="#l25.822"></a><span id="l25.822" class="difflineplus">+			if (global_serialization_float_format)</span>
<a href="#l25.823"></a><span id="l25.823" class="difflineplus">+				format = global_serialization_float_format;</span>
<a href="#l25.824"></a><span id="l25.824" class="difflineplus">+			else</span>
<a href="#l25.825"></a><span id="l25.825" class="difflineplus">+				format = std_format;</span>
<a href="#l25.826"></a><span id="l25.826" class="difflineplus">+		}</span>
<a href="#l25.827"></a><span id="l25.827" class="difflineplus">+		size = snprintf(buf, sizeof(buf), format, jso-&gt;o.c_double);</span>
<a href="#l25.828"></a><span id="l25.828" class="difflineplus">+</span>
<a href="#l25.829"></a><span id="l25.829" class="difflineplus">+		if (size &lt; 0)</span>
<a href="#l25.830"></a><span id="l25.830" class="difflineplus">+			return -1;</span>
<a href="#l25.831"></a><span id="l25.831" class="difflineplus">+</span>
<a href="#l25.832"></a><span id="l25.832" class="difflineplus">+		p = strchr(buf, ',');</span>
<a href="#l25.833"></a><span id="l25.833" class="difflineplus">+		if (p)</span>
<a href="#l25.834"></a><span id="l25.834" class="difflineplus">+			*p = '.';</span>
<a href="#l25.835"></a><span id="l25.835" class="difflineplus">+		else</span>
<a href="#l25.836"></a><span id="l25.836" class="difflineplus">+			p = strchr(buf, '.');</span>
<a href="#l25.837"></a><span id="l25.837" class="difflineplus">+</span>
<a href="#l25.838"></a><span id="l25.838" class="difflineplus">+		if (format == std_format || strstr(format, &quot;.0f&quot;) == NULL)</span>
<a href="#l25.839"></a><span id="l25.839" class="difflineplus">+			format_drops_decimals = 1;</span>
<a href="#l25.840"></a><span id="l25.840" class="difflineplus">+</span>
<a href="#l25.841"></a><span id="l25.841" class="difflineplus">+		if (size &lt; (int)sizeof(buf) - 2 &amp;&amp;</span>
<a href="#l25.842"></a><span id="l25.842" class="difflineplus">+		    isdigit((int)buf[0]) &amp;&amp; /* Looks like *some* kind of number */</span>
<a href="#l25.843"></a><span id="l25.843" class="difflineplus">+			!p &amp;&amp; /* Has no decimal point */</span>
<a href="#l25.844"></a><span id="l25.844" class="difflineplus">+		    strchr(buf, 'e') == NULL &amp;&amp; /* Not scientific notation */</span>
<a href="#l25.845"></a><span id="l25.845" class="difflineplus">+			format_drops_decimals)</span>
<a href="#l25.846"></a><span id="l25.846" class="difflineplus">+		{</span>
<a href="#l25.847"></a><span id="l25.847" class="difflineplus">+			// Ensure it looks like a float, even if snprintf didn't,</span>
<a href="#l25.848"></a><span id="l25.848" class="difflineplus">+			//  unless a custom format is set to omit the decimal.</span>
<a href="#l25.849"></a><span id="l25.849" class="difflineplus">+			strcat(buf, &quot;.0&quot;);</span>
<a href="#l25.850"></a><span id="l25.850" class="difflineplus">+			size += 2;</span>
<a href="#l25.851"></a><span id="l25.851" class="difflineplus">+		}</span>
<a href="#l25.852"></a><span id="l25.852" class="difflineplus">+		if (p &amp;&amp; (flags &amp; JSON_C_TO_STRING_NOZERO))</span>
<a href="#l25.853"></a><span id="l25.853" class="difflineplus">+		{</span>
<a href="#l25.854"></a><span id="l25.854" class="difflineplus">+			/* last useful digit, always keep 1 zero */</span>
<a href="#l25.855"></a><span id="l25.855" class="difflineplus">+			p++;</span>
<a href="#l25.856"></a><span id="l25.856" class="difflineplus">+			for (q=p ; *q ; q++) {</span>
<a href="#l25.857"></a><span id="l25.857" class="difflineplus">+				if (*q!='0') p=q;</span>
<a href="#l25.858"></a><span id="l25.858" class="difflineplus">+			}</span>
<a href="#l25.859"></a><span id="l25.859" class="difflineplus">+			/* drop trailing zeroes */</span>
<a href="#l25.860"></a><span id="l25.860" class="difflineplus">+			*(++p) = 0;</span>
<a href="#l25.861"></a><span id="l25.861" class="difflineplus">+			size = p-buf;</span>
<a href="#l25.862"></a><span id="l25.862" class="difflineplus">+		}</span>
<a href="#l25.863"></a><span id="l25.863" class="difflineplus">+	}</span>
<a href="#l25.864"></a><span id="l25.864" class="difflineplus">+	// although unlikely, snprintf can fail</span>
<a href="#l25.865"></a><span id="l25.865" class="difflineplus">+	if (size &lt; 0)</span>
<a href="#l25.866"></a><span id="l25.866" class="difflineplus">+		return -1;</span>
<a href="#l25.867"></a><span id="l25.867" class="difflineplus">+</span>
<a href="#l25.868"></a><span id="l25.868" class="difflineplus">+	if (size &gt;= (int)sizeof(buf))</span>
<a href="#l25.869"></a><span id="l25.869" class="difflineplus">+		// The standard formats are guaranteed not to overrun the buffer,</span>
<a href="#l25.870"></a><span id="l25.870" class="difflineplus">+		// but if a custom one happens to do so, just silently truncate.</span>
<a href="#l25.871"></a><span id="l25.871" class="difflineplus">+		size = sizeof(buf) - 1;</span>
<a href="#l25.872"></a><span id="l25.872" class="difflineplus">+	printbuf_memappend(pb, buf, size);</span>
<a href="#l25.873"></a><span id="l25.873" class="difflineplus">+	return size;</span>
<a href="#l25.874"></a><span id="l25.874" class="difflineplus">+}</span>
<a href="#l25.875"></a><span id="l25.875" class="difflineplus">+</span>
<a href="#l25.876"></a><span id="l25.876" class="difflineplus">+static int json_object_double_to_json_string_default(struct json_object* jso,</span>
<a href="#l25.877"></a><span id="l25.877" class="difflineplus">+						     struct printbuf *pb,</span>
<a href="#l25.878"></a><span id="l25.878" class="difflineplus">+						     int level,</span>
<a href="#l25.879"></a><span id="l25.879" class="difflineplus">+						     int flags)</span>
<a href="#l25.880"></a><span id="l25.880" class="difflineplus">+{</span>
<a href="#l25.881"></a><span id="l25.881" class="difflineplus">+	return json_object_double_to_json_string_format(jso, pb, level, flags,</span>
<a href="#l25.882"></a><span id="l25.882" class="difflineplus">+							NULL);</span>
<a href="#l25.883"></a><span id="l25.883" class="difflineplus">+}</span>
<a href="#l25.884"></a><span id="l25.884" class="difflineplus">+</span>
<a href="#l25.885"></a><span id="l25.885" class="difflineplus">+int json_object_double_to_json_string(struct json_object* jso,</span>
<a href="#l25.886"></a><span id="l25.886" class="difflineplus">+				      struct printbuf *pb,</span>
<a href="#l25.887"></a><span id="l25.887" class="difflineplus">+				      int level,</span>
<a href="#l25.888"></a><span id="l25.888" class="difflineplus">+				      int flags)</span>
<a href="#l25.889"></a><span id="l25.889" class="difflineplus">+{</span>
<a href="#l25.890"></a><span id="l25.890" class="difflineplus">+	return json_object_double_to_json_string_format(jso, pb, level, flags,</span>
<a href="#l25.891"></a><span id="l25.891" class="difflineplus">+							(const char *)jso-&gt;_userdata);</span>
<a href="#l25.892"></a><span id="l25.892" class="difflineplus">+}</span>
<a href="#l25.893"></a><span id="l25.893" class="difflineplus">+</span>
<a href="#l25.894"></a><span id="l25.894" class="difflineplus">+struct json_object* json_object_new_double(double d)</span>
<a href="#l25.895"></a><span id="l25.895" class="difflineplus">+{</span>
<a href="#l25.896"></a><span id="l25.896" class="difflineplus">+	struct json_object *jso = json_object_new(json_type_double);</span>
<a href="#l25.897"></a><span id="l25.897" class="difflineplus">+	if (!jso)</span>
<a href="#l25.898"></a><span id="l25.898" class="difflineplus">+		return NULL;</span>
<a href="#l25.899"></a><span id="l25.899" class="difflineplus">+	jso-&gt;_to_json_string = &amp;json_object_double_to_json_string_default;</span>
<a href="#l25.900"></a><span id="l25.900" class="difflineplus">+	jso-&gt;o.c_double = d;</span>
<a href="#l25.901"></a><span id="l25.901" class="difflineplus">+	return jso;</span>
<a href="#l25.902"></a><span id="l25.902" class="difflineplus">+}</span>
<a href="#l25.903"></a><span id="l25.903" class="difflineplus">+</span>
<a href="#l25.904"></a><span id="l25.904" class="difflineplus">+struct json_object* json_object_new_double_s(double d, const char *ds)</span>
<a href="#l25.905"></a><span id="l25.905" class="difflineplus">+{</span>
<a href="#l25.906"></a><span id="l25.906" class="difflineplus">+	char *new_ds;</span>
<a href="#l25.907"></a><span id="l25.907" class="difflineplus">+	struct json_object *jso = json_object_new_double(d);</span>
<a href="#l25.908"></a><span id="l25.908" class="difflineplus">+	if (!jso)</span>
<a href="#l25.909"></a><span id="l25.909" class="difflineplus">+		return NULL;</span>
<a href="#l25.910"></a><span id="l25.910" class="difflineplus">+</span>
<a href="#l25.911"></a><span id="l25.911" class="difflineplus">+	new_ds = strdup(ds);</span>
<a href="#l25.912"></a><span id="l25.912" class="difflineplus">+	if (!new_ds)</span>
<a href="#l25.913"></a><span id="l25.913" class="difflineplus">+	{</span>
<a href="#l25.914"></a><span id="l25.914" class="difflineplus">+		json_object_generic_delete(jso);</span>
<a href="#l25.915"></a><span id="l25.915" class="difflineplus">+		errno = ENOMEM;</span>
<a href="#l25.916"></a><span id="l25.916" class="difflineplus">+		return NULL;</span>
<a href="#l25.917"></a><span id="l25.917" class="difflineplus">+	}</span>
<a href="#l25.918"></a><span id="l25.918" class="difflineplus">+	json_object_set_serializer(jso, json_object_userdata_to_json_string,</span>
<a href="#l25.919"></a><span id="l25.919" class="difflineplus">+	    new_ds, json_object_free_userdata);</span>
<a href="#l25.920"></a><span id="l25.920" class="difflineplus">+	return jso;</span>
<a href="#l25.921"></a><span id="l25.921" class="difflineplus">+}</span>
<a href="#l25.922"></a><span id="l25.922" class="difflineplus">+</span>
<a href="#l25.923"></a><span id="l25.923" class="difflineplus">+int json_object_userdata_to_json_string(struct json_object *jso,</span>
<a href="#l25.924"></a><span id="l25.924" class="difflineplus">+	struct printbuf *pb, int level, int flags)</span>
<a href="#l25.925"></a><span id="l25.925" class="difflineplus">+{</span>
<a href="#l25.926"></a><span id="l25.926" class="difflineplus">+	int userdata_len = strlen((const char *)jso-&gt;_userdata);</span>
<a href="#l25.927"></a><span id="l25.927" class="difflineplus">+	printbuf_memappend(pb, (const char *)jso-&gt;_userdata, userdata_len);</span>
<a href="#l25.928"></a><span id="l25.928" class="difflineplus">+	return userdata_len;</span>
<a href="#l25.929"></a><span id="l25.929" class="difflineplus">+}</span>
<a href="#l25.930"></a><span id="l25.930" class="difflineplus">+</span>
<a href="#l25.931"></a><span id="l25.931" class="difflineplus">+void json_object_free_userdata(struct json_object *jso, void *userdata)</span>
<a href="#l25.932"></a><span id="l25.932" class="difflineplus">+{</span>
<a href="#l25.933"></a><span id="l25.933" class="difflineplus">+	free(userdata);</span>
<a href="#l25.934"></a><span id="l25.934" class="difflineplus">+}</span>
<a href="#l25.935"></a><span id="l25.935" class="difflineplus">+</span>
<a href="#l25.936"></a><span id="l25.936" class="difflineplus">+double json_object_get_double(const struct json_object *jso)</span>
<a href="#l25.937"></a><span id="l25.937" class="difflineplus">+{</span>
<a href="#l25.938"></a><span id="l25.938" class="difflineplus">+  double cdouble;</span>
<a href="#l25.939"></a><span id="l25.939" class="difflineplus">+  char *errPtr = NULL;</span>
<a href="#l25.940"></a><span id="l25.940" class="difflineplus">+</span>
<a href="#l25.941"></a><span id="l25.941" class="difflineplus">+  if(!jso) return 0.0;</span>
<a href="#l25.942"></a><span id="l25.942" class="difflineplus">+  switch(jso-&gt;o_type) {</span>
<a href="#l25.943"></a><span id="l25.943" class="difflineplus">+  case json_type_double:</span>
<a href="#l25.944"></a><span id="l25.944" class="difflineplus">+    return jso-&gt;o.c_double;</span>
<a href="#l25.945"></a><span id="l25.945" class="difflineplus">+  case json_type_int:</span>
<a href="#l25.946"></a><span id="l25.946" class="difflineplus">+    return jso-&gt;o.c_int64;</span>
<a href="#l25.947"></a><span id="l25.947" class="difflineplus">+  case json_type_boolean:</span>
<a href="#l25.948"></a><span id="l25.948" class="difflineplus">+    return jso-&gt;o.c_boolean;</span>
<a href="#l25.949"></a><span id="l25.949" class="difflineplus">+  case json_type_string:</span>
<a href="#l25.950"></a><span id="l25.950" class="difflineplus">+    errno = 0;</span>
<a href="#l25.951"></a><span id="l25.951" class="difflineplus">+    cdouble = strtod(get_string_component(jso), &amp;errPtr);</span>
<a href="#l25.952"></a><span id="l25.952" class="difflineplus">+</span>
<a href="#l25.953"></a><span id="l25.953" class="difflineplus">+    /* if conversion stopped at the first character, return 0.0 */</span>
<a href="#l25.954"></a><span id="l25.954" class="difflineplus">+    if (errPtr == get_string_component(jso))</span>
<a href="#l25.955"></a><span id="l25.955" class="difflineplus">+        return 0.0;</span>
<a href="#l25.956"></a><span id="l25.956" class="difflineplus">+</span>
<a href="#l25.957"></a><span id="l25.957" class="difflineplus">+    /*</span>
<a href="#l25.958"></a><span id="l25.958" class="difflineplus">+     * Check that the conversion terminated on something sensible</span>
<a href="#l25.959"></a><span id="l25.959" class="difflineplus">+     *</span>
<a href="#l25.960"></a><span id="l25.960" class="difflineplus">+     * For example, { &quot;pay&quot; : 123AB } would parse as 123.</span>
<a href="#l25.961"></a><span id="l25.961" class="difflineplus">+     */</span>
<a href="#l25.962"></a><span id="l25.962" class="difflineplus">+    if (*errPtr != '\0')</span>
<a href="#l25.963"></a><span id="l25.963" class="difflineplus">+        return 0.0;</span>
<a href="#l25.964"></a><span id="l25.964" class="difflineplus">+</span>
<a href="#l25.965"></a><span id="l25.965" class="difflineplus">+    /*</span>
<a href="#l25.966"></a><span id="l25.966" class="difflineplus">+     * If strtod encounters a string which would exceed the</span>
<a href="#l25.967"></a><span id="l25.967" class="difflineplus">+     * capacity of a double, it returns +/- HUGE_VAL and sets</span>
<a href="#l25.968"></a><span id="l25.968" class="difflineplus">+     * errno to ERANGE. But +/- HUGE_VAL is also a valid result</span>
<a href="#l25.969"></a><span id="l25.969" class="difflineplus">+     * from a conversion, so we need to check errno.</span>
<a href="#l25.970"></a><span id="l25.970" class="difflineplus">+     *</span>
<a href="#l25.971"></a><span id="l25.971" class="difflineplus">+     * Underflow also sets errno to ERANGE, but it returns 0 in</span>
<a href="#l25.972"></a><span id="l25.972" class="difflineplus">+     * that case, which is what we will return anyway.</span>
<a href="#l25.973"></a><span id="l25.973" class="difflineplus">+     *</span>
<a href="#l25.974"></a><span id="l25.974" class="difflineplus">+     * See CERT guideline ERR30-C</span>
<a href="#l25.975"></a><span id="l25.975" class="difflineplus">+     */</span>
<a href="#l25.976"></a><span id="l25.976" class="difflineplus">+    if ((HUGE_VAL == cdouble || -HUGE_VAL == cdouble) &amp;&amp;</span>
<a href="#l25.977"></a><span id="l25.977" class="difflineplus">+        (ERANGE == errno))</span>
<a href="#l25.978"></a><span id="l25.978" class="difflineplus">+            cdouble = 0.0;</span>
<a href="#l25.979"></a><span id="l25.979" class="difflineplus">+    return cdouble;</span>
<a href="#l25.980"></a><span id="l25.980" class="difflineplus">+  default:</span>
<a href="#l25.981"></a><span id="l25.981" class="difflineplus">+    return 0.0;</span>
<a href="#l25.982"></a><span id="l25.982" class="difflineplus">+  }</span>
<a href="#l25.983"></a><span id="l25.983" class="difflineplus">+}</span>
<a href="#l25.984"></a><span id="l25.984" class="difflineplus">+</span>
<a href="#l25.985"></a><span id="l25.985" class="difflineplus">+int json_object_set_double(struct json_object *jso,double new_value){</span>
<a href="#l25.986"></a><span id="l25.986" class="difflineplus">+	if (!jso || jso-&gt;o_type!=json_type_double)</span>
<a href="#l25.987"></a><span id="l25.987" class="difflineplus">+		return 0;</span>
<a href="#l25.988"></a><span id="l25.988" class="difflineplus">+	jso-&gt;o.c_double=new_value;</span>
<a href="#l25.989"></a><span id="l25.989" class="difflineplus">+	return 1;</span>
<a href="#l25.990"></a><span id="l25.990" class="difflineplus">+}</span>
<a href="#l25.991"></a><span id="l25.991" class="difflineplus">+</span>
<a href="#l25.992"></a><span id="l25.992" class="difflineplus">+/* json_object_string */</span>
<a href="#l25.993"></a><span id="l25.993" class="difflineplus">+</span>
<a href="#l25.994"></a><span id="l25.994" class="difflineplus">+static int json_object_string_to_json_string(struct json_object* jso,</span>
<a href="#l25.995"></a><span id="l25.995" class="difflineplus">+					     struct printbuf *pb,</span>
<a href="#l25.996"></a><span id="l25.996" class="difflineplus">+					     int level,</span>
<a href="#l25.997"></a><span id="l25.997" class="difflineplus">+					     int flags)</span>
<a href="#l25.998"></a><span id="l25.998" class="difflineplus">+{</span>
<a href="#l25.999"></a><span id="l25.999" class="difflineplus">+	printbuf_strappend(pb, &quot;\&quot;&quot;);</span>
<a href="#l25.1000"></a><span id="l25.1000" class="difflineplus">+	json_escape_str(pb, get_string_component(jso), jso-&gt;o.c_string.len, flags);</span>
<a href="#l25.1001"></a><span id="l25.1001" class="difflineplus">+	printbuf_strappend(pb, &quot;\&quot;&quot;);</span>
<a href="#l25.1002"></a><span id="l25.1002" class="difflineplus">+	return 0;</span>
<a href="#l25.1003"></a><span id="l25.1003" class="difflineplus">+}</span>
<a href="#l25.1004"></a><span id="l25.1004" class="difflineplus">+</span>
<a href="#l25.1005"></a><span id="l25.1005" class="difflineplus">+static void json_object_string_delete(struct json_object* jso)</span>
<a href="#l25.1006"></a><span id="l25.1006" class="difflineplus">+{</span>
<a href="#l25.1007"></a><span id="l25.1007" class="difflineplus">+	if(jso-&gt;o.c_string.len &gt;= LEN_DIRECT_STRING_DATA)</span>
<a href="#l25.1008"></a><span id="l25.1008" class="difflineplus">+		free(jso-&gt;o.c_string.str.ptr);</span>
<a href="#l25.1009"></a><span id="l25.1009" class="difflineplus">+	json_object_generic_delete(jso);</span>
<a href="#l25.1010"></a><span id="l25.1010" class="difflineplus">+}</span>
<a href="#l25.1011"></a><span id="l25.1011" class="difflineplus">+</span>
<a href="#l25.1012"></a><span id="l25.1012" class="difflineplus">+struct json_object* json_object_new_string(const char *s)</span>
<a href="#l25.1013"></a><span id="l25.1013" class="difflineplus">+{</span>
<a href="#l25.1014"></a><span id="l25.1014" class="difflineplus">+	struct json_object *jso = json_object_new(json_type_string);</span>
<a href="#l25.1015"></a><span id="l25.1015" class="difflineplus">+	if (!jso)</span>
<a href="#l25.1016"></a><span id="l25.1016" class="difflineplus">+		return NULL;</span>
<a href="#l25.1017"></a><span id="l25.1017" class="difflineplus">+	jso-&gt;_delete = &amp;json_object_string_delete;</span>
<a href="#l25.1018"></a><span id="l25.1018" class="difflineplus">+	jso-&gt;_to_json_string = &amp;json_object_string_to_json_string;</span>
<a href="#l25.1019"></a><span id="l25.1019" class="difflineplus">+	jso-&gt;o.c_string.len = strlen(s);</span>
<a href="#l25.1020"></a><span id="l25.1020" class="difflineplus">+	if(jso-&gt;o.c_string.len &lt; LEN_DIRECT_STRING_DATA) {</span>
<a href="#l25.1021"></a><span id="l25.1021" class="difflineplus">+		memcpy(jso-&gt;o.c_string.str.data, s, jso-&gt;o.c_string.len);</span>
<a href="#l25.1022"></a><span id="l25.1022" class="difflineplus">+	} else {</span>
<a href="#l25.1023"></a><span id="l25.1023" class="difflineplus">+		jso-&gt;o.c_string.str.ptr = strdup(s);</span>
<a href="#l25.1024"></a><span id="l25.1024" class="difflineplus">+		if (!jso-&gt;o.c_string.str.ptr)</span>
<a href="#l25.1025"></a><span id="l25.1025" class="difflineplus">+		{</span>
<a href="#l25.1026"></a><span id="l25.1026" class="difflineplus">+			json_object_generic_delete(jso);</span>
<a href="#l25.1027"></a><span id="l25.1027" class="difflineplus">+			errno = ENOMEM;</span>
<a href="#l25.1028"></a><span id="l25.1028" class="difflineplus">+			return NULL;</span>
<a href="#l25.1029"></a><span id="l25.1029" class="difflineplus">+		}</span>
<a href="#l25.1030"></a><span id="l25.1030" class="difflineplus">+	}</span>
<a href="#l25.1031"></a><span id="l25.1031" class="difflineplus">+	return jso;</span>
<a href="#l25.1032"></a><span id="l25.1032" class="difflineplus">+}</span>
<a href="#l25.1033"></a><span id="l25.1033" class="difflineplus">+</span>
<a href="#l25.1034"></a><span id="l25.1034" class="difflineplus">+struct json_object* json_object_new_string_len(const char *s, int len)</span>
<a href="#l25.1035"></a><span id="l25.1035" class="difflineplus">+{</span>
<a href="#l25.1036"></a><span id="l25.1036" class="difflineplus">+	char *dstbuf;</span>
<a href="#l25.1037"></a><span id="l25.1037" class="difflineplus">+	struct json_object *jso = json_object_new(json_type_string);</span>
<a href="#l25.1038"></a><span id="l25.1038" class="difflineplus">+	if (!jso)</span>
<a href="#l25.1039"></a><span id="l25.1039" class="difflineplus">+		return NULL;</span>
<a href="#l25.1040"></a><span id="l25.1040" class="difflineplus">+	jso-&gt;_delete = &amp;json_object_string_delete;</span>
<a href="#l25.1041"></a><span id="l25.1041" class="difflineplus">+	jso-&gt;_to_json_string = &amp;json_object_string_to_json_string;</span>
<a href="#l25.1042"></a><span id="l25.1042" class="difflineplus">+	if(len &lt; LEN_DIRECT_STRING_DATA) {</span>
<a href="#l25.1043"></a><span id="l25.1043" class="difflineplus">+		dstbuf = jso-&gt;o.c_string.str.data;</span>
<a href="#l25.1044"></a><span id="l25.1044" class="difflineplus">+	} else {</span>
<a href="#l25.1045"></a><span id="l25.1045" class="difflineplus">+		jso-&gt;o.c_string.str.ptr = (char*)malloc(len + 1);</span>
<a href="#l25.1046"></a><span id="l25.1046" class="difflineplus">+		if (!jso-&gt;o.c_string.str.ptr)</span>
<a href="#l25.1047"></a><span id="l25.1047" class="difflineplus">+		{</span>
<a href="#l25.1048"></a><span id="l25.1048" class="difflineplus">+			json_object_generic_delete(jso);</span>
<a href="#l25.1049"></a><span id="l25.1049" class="difflineplus">+			errno = ENOMEM;</span>
<a href="#l25.1050"></a><span id="l25.1050" class="difflineplus">+			return NULL;</span>
<a href="#l25.1051"></a><span id="l25.1051" class="difflineplus">+		}</span>
<a href="#l25.1052"></a><span id="l25.1052" class="difflineplus">+		dstbuf = jso-&gt;o.c_string.str.ptr;</span>
<a href="#l25.1053"></a><span id="l25.1053" class="difflineplus">+	}</span>
<a href="#l25.1054"></a><span id="l25.1054" class="difflineplus">+	memcpy(dstbuf, (const void *)s, len);</span>
<a href="#l25.1055"></a><span id="l25.1055" class="difflineplus">+	dstbuf[len] = '\0';</span>
<a href="#l25.1056"></a><span id="l25.1056" class="difflineplus">+	jso-&gt;o.c_string.len = len;</span>
<a href="#l25.1057"></a><span id="l25.1057" class="difflineplus">+	return jso;</span>
<a href="#l25.1058"></a><span id="l25.1058" class="difflineplus">+}</span>
<a href="#l25.1059"></a><span id="l25.1059" class="difflineplus">+</span>
<a href="#l25.1060"></a><span id="l25.1060" class="difflineplus">+const char* json_object_get_string(struct json_object *jso)</span>
<a href="#l25.1061"></a><span id="l25.1061" class="difflineplus">+{</span>
<a href="#l25.1062"></a><span id="l25.1062" class="difflineplus">+	if (!jso)</span>
<a href="#l25.1063"></a><span id="l25.1063" class="difflineplus">+		return NULL;</span>
<a href="#l25.1064"></a><span id="l25.1064" class="difflineplus">+	switch(jso-&gt;o_type)</span>
<a href="#l25.1065"></a><span id="l25.1065" class="difflineplus">+	{</span>
<a href="#l25.1066"></a><span id="l25.1066" class="difflineplus">+	case json_type_string:</span>
<a href="#l25.1067"></a><span id="l25.1067" class="difflineplus">+		return get_string_component(jso);</span>
<a href="#l25.1068"></a><span id="l25.1068" class="difflineplus">+	default:</span>
<a href="#l25.1069"></a><span id="l25.1069" class="difflineplus">+		return json_object_to_json_string(jso);</span>
<a href="#l25.1070"></a><span id="l25.1070" class="difflineplus">+	}</span>
<a href="#l25.1071"></a><span id="l25.1071" class="difflineplus">+}</span>
<a href="#l25.1072"></a><span id="l25.1072" class="difflineplus">+</span>
<a href="#l25.1073"></a><span id="l25.1073" class="difflineplus">+int json_object_get_string_len(const struct json_object *jso)</span>
<a href="#l25.1074"></a><span id="l25.1074" class="difflineplus">+{</span>
<a href="#l25.1075"></a><span id="l25.1075" class="difflineplus">+	if (!jso)</span>
<a href="#l25.1076"></a><span id="l25.1076" class="difflineplus">+		return 0;</span>
<a href="#l25.1077"></a><span id="l25.1077" class="difflineplus">+	switch(jso-&gt;o_type)</span>
<a href="#l25.1078"></a><span id="l25.1078" class="difflineplus">+	{</span>
<a href="#l25.1079"></a><span id="l25.1079" class="difflineplus">+	case json_type_string:</span>
<a href="#l25.1080"></a><span id="l25.1080" class="difflineplus">+		return jso-&gt;o.c_string.len;</span>
<a href="#l25.1081"></a><span id="l25.1081" class="difflineplus">+	default:</span>
<a href="#l25.1082"></a><span id="l25.1082" class="difflineplus">+		return 0;</span>
<a href="#l25.1083"></a><span id="l25.1083" class="difflineplus">+	}</span>
<a href="#l25.1084"></a><span id="l25.1084" class="difflineplus">+}</span>
<a href="#l25.1085"></a><span id="l25.1085" class="difflineplus">+</span>
<a href="#l25.1086"></a><span id="l25.1086" class="difflineplus">+int json_object_set_string(json_object* jso, const char* s) {</span>
<a href="#l25.1087"></a><span id="l25.1087" class="difflineplus">+	return json_object_set_string_len(jso, s, (int)(strlen(s)));</span>
<a href="#l25.1088"></a><span id="l25.1088" class="difflineplus">+}</span>
<a href="#l25.1089"></a><span id="l25.1089" class="difflineplus">+</span>
<a href="#l25.1090"></a><span id="l25.1090" class="difflineplus">+int json_object_set_string_len(json_object* jso, const char* s, int len){</span>
<a href="#l25.1091"></a><span id="l25.1091" class="difflineplus">+	char *dstbuf; </span>
<a href="#l25.1092"></a><span id="l25.1092" class="difflineplus">+	if (jso==NULL || jso-&gt;o_type!=json_type_string) return 0; 	</span>
<a href="#l25.1093"></a><span id="l25.1093" class="difflineplus">+	if (len&lt;LEN_DIRECT_STRING_DATA) {</span>
<a href="#l25.1094"></a><span id="l25.1094" class="difflineplus">+		dstbuf=jso-&gt;o.c_string.str.data;</span>
<a href="#l25.1095"></a><span id="l25.1095" class="difflineplus">+		if (jso-&gt;o.c_string.len&gt;=LEN_DIRECT_STRING_DATA) free(jso-&gt;o.c_string.str.ptr); </span>
<a href="#l25.1096"></a><span id="l25.1096" class="difflineplus">+	} else {</span>
<a href="#l25.1097"></a><span id="l25.1097" class="difflineplus">+		dstbuf=(char *)malloc(len+1);</span>
<a href="#l25.1098"></a><span id="l25.1098" class="difflineplus">+		if (dstbuf==NULL) return 0;</span>
<a href="#l25.1099"></a><span id="l25.1099" class="difflineplus">+		if (jso-&gt;o.c_string.len&gt;=LEN_DIRECT_STRING_DATA) free(jso-&gt;o.c_string.str.ptr);</span>
<a href="#l25.1100"></a><span id="l25.1100" class="difflineplus">+		jso-&gt;o.c_string.str.ptr=dstbuf;</span>
<a href="#l25.1101"></a><span id="l25.1101" class="difflineplus">+	}</span>
<a href="#l25.1102"></a><span id="l25.1102" class="difflineplus">+	jso-&gt;o.c_string.len=len;</span>
<a href="#l25.1103"></a><span id="l25.1103" class="difflineplus">+	memcpy(dstbuf, (const void *)s, len);</span>
<a href="#l25.1104"></a><span id="l25.1104" class="difflineplus">+	dstbuf[len] = '\0';</span>
<a href="#l25.1105"></a><span id="l25.1105" class="difflineplus">+	return 1; </span>
<a href="#l25.1106"></a><span id="l25.1106" class="difflineplus">+}</span>
<a href="#l25.1107"></a><span id="l25.1107" class="difflineplus">+</span>
<a href="#l25.1108"></a><span id="l25.1108" class="difflineplus">+/* json_object_array */</span>
<a href="#l25.1109"></a><span id="l25.1109" class="difflineplus">+</span>
<a href="#l25.1110"></a><span id="l25.1110" class="difflineplus">+static int json_object_array_to_json_string(struct json_object* jso,</span>
<a href="#l25.1111"></a><span id="l25.1111" class="difflineplus">+                                            struct printbuf *pb,</span>
<a href="#l25.1112"></a><span id="l25.1112" class="difflineplus">+                                            int level,</span>
<a href="#l25.1113"></a><span id="l25.1113" class="difflineplus">+                                            int flags)</span>
<a href="#l25.1114"></a><span id="l25.1114" class="difflineplus">+{</span>
<a href="#l25.1115"></a><span id="l25.1115" class="difflineplus">+	int had_children = 0;</span>
<a href="#l25.1116"></a><span id="l25.1116" class="difflineplus">+	size_t ii;</span>
<a href="#l25.1117"></a><span id="l25.1117" class="difflineplus">+</span>
<a href="#l25.1118"></a><span id="l25.1118" class="difflineplus">+	printbuf_strappend(pb, &quot;[&quot;);</span>
<a href="#l25.1119"></a><span id="l25.1119" class="difflineplus">+	if (flags &amp; JSON_C_TO_STRING_PRETTY)</span>
<a href="#l25.1120"></a><span id="l25.1120" class="difflineplus">+		printbuf_strappend(pb, &quot;\n&quot;);</span>
<a href="#l25.1121"></a><span id="l25.1121" class="difflineplus">+	for(ii=0; ii &lt; json_object_array_length(jso); ii++)</span>
<a href="#l25.1122"></a><span id="l25.1122" class="difflineplus">+	{</span>
<a href="#l25.1123"></a><span id="l25.1123" class="difflineplus">+		struct json_object *val;</span>
<a href="#l25.1124"></a><span id="l25.1124" class="difflineplus">+		if (had_children)</span>
<a href="#l25.1125"></a><span id="l25.1125" class="difflineplus">+		{</span>
<a href="#l25.1126"></a><span id="l25.1126" class="difflineplus">+			printbuf_strappend(pb, &quot;,&quot;);</span>
<a href="#l25.1127"></a><span id="l25.1127" class="difflineplus">+			if (flags &amp; JSON_C_TO_STRING_PRETTY)</span>
<a href="#l25.1128"></a><span id="l25.1128" class="difflineplus">+				printbuf_strappend(pb, &quot;\n&quot;);</span>
<a href="#l25.1129"></a><span id="l25.1129" class="difflineplus">+		}</span>
<a href="#l25.1130"></a><span id="l25.1130" class="difflineplus">+		had_children = 1;</span>
<a href="#l25.1131"></a><span id="l25.1131" class="difflineplus">+		if (flags &amp; JSON_C_TO_STRING_SPACED)</span>
<a href="#l25.1132"></a><span id="l25.1132" class="difflineplus">+			printbuf_strappend(pb, &quot; &quot;);</span>
<a href="#l25.1133"></a><span id="l25.1133" class="difflineplus">+		indent(pb, level + 1, flags);</span>
<a href="#l25.1134"></a><span id="l25.1134" class="difflineplus">+		val = json_object_array_get_idx(jso, ii);</span>
<a href="#l25.1135"></a><span id="l25.1135" class="difflineplus">+		if(val == NULL)</span>
<a href="#l25.1136"></a><span id="l25.1136" class="difflineplus">+			printbuf_strappend(pb, &quot;null&quot;);</span>
<a href="#l25.1137"></a><span id="l25.1137" class="difflineplus">+		else</span>
<a href="#l25.1138"></a><span id="l25.1138" class="difflineplus">+			if (val-&gt;_to_json_string(val, pb, level+1, flags) &lt; 0)</span>
<a href="#l25.1139"></a><span id="l25.1139" class="difflineplus">+				return -1;</span>
<a href="#l25.1140"></a><span id="l25.1140" class="difflineplus">+	}</span>
<a href="#l25.1141"></a><span id="l25.1141" class="difflineplus">+	if (flags &amp; JSON_C_TO_STRING_PRETTY)</span>
<a href="#l25.1142"></a><span id="l25.1142" class="difflineplus">+	{</span>
<a href="#l25.1143"></a><span id="l25.1143" class="difflineplus">+		if (had_children)</span>
<a href="#l25.1144"></a><span id="l25.1144" class="difflineplus">+			printbuf_strappend(pb, &quot;\n&quot;);</span>
<a href="#l25.1145"></a><span id="l25.1145" class="difflineplus">+		indent(pb,level,flags);</span>
<a href="#l25.1146"></a><span id="l25.1146" class="difflineplus">+	}</span>
<a href="#l25.1147"></a><span id="l25.1147" class="difflineplus">+</span>
<a href="#l25.1148"></a><span id="l25.1148" class="difflineplus">+	if (flags &amp; JSON_C_TO_STRING_SPACED)</span>
<a href="#l25.1149"></a><span id="l25.1149" class="difflineplus">+		return printbuf_strappend(pb, &quot; ]&quot;);</span>
<a href="#l25.1150"></a><span id="l25.1150" class="difflineplus">+	return printbuf_strappend(pb, &quot;]&quot;);</span>
<a href="#l25.1151"></a><span id="l25.1151" class="difflineplus">+}</span>
<a href="#l25.1152"></a><span id="l25.1152" class="difflineplus">+</span>
<a href="#l25.1153"></a><span id="l25.1153" class="difflineplus">+static void json_object_array_entry_free(void *data)</span>
<a href="#l25.1154"></a><span id="l25.1154" class="difflineplus">+{</span>
<a href="#l25.1155"></a><span id="l25.1155" class="difflineplus">+	json_object_put((struct json_object*)data);</span>
<a href="#l25.1156"></a><span id="l25.1156" class="difflineplus">+}</span>
<a href="#l25.1157"></a><span id="l25.1157" class="difflineplus">+</span>
<a href="#l25.1158"></a><span id="l25.1158" class="difflineplus">+static void json_object_array_delete(struct json_object* jso)</span>
<a href="#l25.1159"></a><span id="l25.1159" class="difflineplus">+{</span>
<a href="#l25.1160"></a><span id="l25.1160" class="difflineplus">+	array_list_free(jso-&gt;o.c_array);</span>
<a href="#l25.1161"></a><span id="l25.1161" class="difflineplus">+	json_object_generic_delete(jso);</span>
<a href="#l25.1162"></a><span id="l25.1162" class="difflineplus">+}</span>
<a href="#l25.1163"></a><span id="l25.1163" class="difflineplus">+</span>
<a href="#l25.1164"></a><span id="l25.1164" class="difflineplus">+struct json_object* json_object_new_array(void)</span>
<a href="#l25.1165"></a><span id="l25.1165" class="difflineplus">+{</span>
<a href="#l25.1166"></a><span id="l25.1166" class="difflineplus">+	struct json_object *jso = json_object_new(json_type_array);</span>
<a href="#l25.1167"></a><span id="l25.1167" class="difflineplus">+	if (!jso)</span>
<a href="#l25.1168"></a><span id="l25.1168" class="difflineplus">+		return NULL;</span>
<a href="#l25.1169"></a><span id="l25.1169" class="difflineplus">+	jso-&gt;_delete = &amp;json_object_array_delete;</span>
<a href="#l25.1170"></a><span id="l25.1170" class="difflineplus">+	jso-&gt;_to_json_string = &amp;json_object_array_to_json_string;</span>
<a href="#l25.1171"></a><span id="l25.1171" class="difflineplus">+	jso-&gt;o.c_array = array_list_new(&amp;json_object_array_entry_free);</span>
<a href="#l25.1172"></a><span id="l25.1172" class="difflineplus">+        if(jso-&gt;o.c_array == NULL)</span>
<a href="#l25.1173"></a><span id="l25.1173" class="difflineplus">+	{</span>
<a href="#l25.1174"></a><span id="l25.1174" class="difflineplus">+	    free(jso);</span>
<a href="#l25.1175"></a><span id="l25.1175" class="difflineplus">+	    return NULL;</span>
<a href="#l25.1176"></a><span id="l25.1176" class="difflineplus">+	}</span>
<a href="#l25.1177"></a><span id="l25.1177" class="difflineplus">+	return jso;</span>
<a href="#l25.1178"></a><span id="l25.1178" class="difflineplus">+}</span>
<a href="#l25.1179"></a><span id="l25.1179" class="difflineplus">+</span>
<a href="#l25.1180"></a><span id="l25.1180" class="difflineplus">+struct array_list* json_object_get_array(const struct json_object *jso)</span>
<a href="#l25.1181"></a><span id="l25.1181" class="difflineplus">+{</span>
<a href="#l25.1182"></a><span id="l25.1182" class="difflineplus">+	if (!jso)</span>
<a href="#l25.1183"></a><span id="l25.1183" class="difflineplus">+		return NULL;</span>
<a href="#l25.1184"></a><span id="l25.1184" class="difflineplus">+	switch(jso-&gt;o_type)</span>
<a href="#l25.1185"></a><span id="l25.1185" class="difflineplus">+	{</span>
<a href="#l25.1186"></a><span id="l25.1186" class="difflineplus">+	case json_type_array:</span>
<a href="#l25.1187"></a><span id="l25.1187" class="difflineplus">+		return jso-&gt;o.c_array;</span>
<a href="#l25.1188"></a><span id="l25.1188" class="difflineplus">+	default:</span>
<a href="#l25.1189"></a><span id="l25.1189" class="difflineplus">+		return NULL;</span>
<a href="#l25.1190"></a><span id="l25.1190" class="difflineplus">+	}</span>
<a href="#l25.1191"></a><span id="l25.1191" class="difflineplus">+}</span>
<a href="#l25.1192"></a><span id="l25.1192" class="difflineplus">+</span>
<a href="#l25.1193"></a><span id="l25.1193" class="difflineplus">+void json_object_array_sort(struct json_object *jso,</span>
<a href="#l25.1194"></a><span id="l25.1194" class="difflineplus">+			    int(*sort_fn)(const void *, const void *))</span>
<a href="#l25.1195"></a><span id="l25.1195" class="difflineplus">+{</span>
<a href="#l25.1196"></a><span id="l25.1196" class="difflineplus">+	assert(json_object_get_type(jso) == json_type_array);</span>
<a href="#l25.1197"></a><span id="l25.1197" class="difflineplus">+	array_list_sort(jso-&gt;o.c_array, sort_fn);</span>
<a href="#l25.1198"></a><span id="l25.1198" class="difflineplus">+}</span>
<a href="#l25.1199"></a><span id="l25.1199" class="difflineplus">+</span>
<a href="#l25.1200"></a><span id="l25.1200" class="difflineplus">+struct json_object* json_object_array_bsearch(</span>
<a href="#l25.1201"></a><span id="l25.1201" class="difflineplus">+		const struct json_object *key,</span>
<a href="#l25.1202"></a><span id="l25.1202" class="difflineplus">+		const struct json_object *jso,</span>
<a href="#l25.1203"></a><span id="l25.1203" class="difflineplus">+		int (*sort_fn)(const void *, const void *))</span>
<a href="#l25.1204"></a><span id="l25.1204" class="difflineplus">+{</span>
<a href="#l25.1205"></a><span id="l25.1205" class="difflineplus">+	struct json_object **result;</span>
<a href="#l25.1206"></a><span id="l25.1206" class="difflineplus">+</span>
<a href="#l25.1207"></a><span id="l25.1207" class="difflineplus">+	assert(json_object_get_type(jso) == json_type_array);</span>
<a href="#l25.1208"></a><span id="l25.1208" class="difflineplus">+	result = (struct json_object **)array_list_bsearch(</span>
<a href="#l25.1209"></a><span id="l25.1209" class="difflineplus">+			(const void **)(void *)&amp;key, jso-&gt;o.c_array, sort_fn);</span>
<a href="#l25.1210"></a><span id="l25.1210" class="difflineplus">+</span>
<a href="#l25.1211"></a><span id="l25.1211" class="difflineplus">+	if (!result)</span>
<a href="#l25.1212"></a><span id="l25.1212" class="difflineplus">+		return NULL;</span>
<a href="#l25.1213"></a><span id="l25.1213" class="difflineplus">+	return *result;</span>
<a href="#l25.1214"></a><span id="l25.1214" class="difflineplus">+}</span>
<a href="#l25.1215"></a><span id="l25.1215" class="difflineplus">+</span>
<a href="#l25.1216"></a><span id="l25.1216" class="difflineplus">+size_t json_object_array_length(const struct json_object *jso)</span>
<a href="#l25.1217"></a><span id="l25.1217" class="difflineplus">+{</span>
<a href="#l25.1218"></a><span id="l25.1218" class="difflineplus">+	assert(json_object_get_type(jso) == json_type_array);</span>
<a href="#l25.1219"></a><span id="l25.1219" class="difflineplus">+	return array_list_length(jso-&gt;o.c_array);</span>
<a href="#l25.1220"></a><span id="l25.1220" class="difflineplus">+}</span>
<a href="#l25.1221"></a><span id="l25.1221" class="difflineplus">+</span>
<a href="#l25.1222"></a><span id="l25.1222" class="difflineplus">+int json_object_array_add(struct json_object *jso,struct json_object *val)</span>
<a href="#l25.1223"></a><span id="l25.1223" class="difflineplus">+{</span>
<a href="#l25.1224"></a><span id="l25.1224" class="difflineplus">+	assert(json_object_get_type(jso) == json_type_array);</span>
<a href="#l25.1225"></a><span id="l25.1225" class="difflineplus">+	return array_list_add(jso-&gt;o.c_array, val);</span>
<a href="#l25.1226"></a><span id="l25.1226" class="difflineplus">+}</span>
<a href="#l25.1227"></a><span id="l25.1227" class="difflineplus">+</span>
<a href="#l25.1228"></a><span id="l25.1228" class="difflineplus">+int json_object_array_put_idx(struct json_object *jso, size_t idx,</span>
<a href="#l25.1229"></a><span id="l25.1229" class="difflineplus">+			      struct json_object *val)</span>
<a href="#l25.1230"></a><span id="l25.1230" class="difflineplus">+{</span>
<a href="#l25.1231"></a><span id="l25.1231" class="difflineplus">+	assert(json_object_get_type(jso) == json_type_array);</span>
<a href="#l25.1232"></a><span id="l25.1232" class="difflineplus">+	return array_list_put_idx(jso-&gt;o.c_array, idx, val);</span>
<a href="#l25.1233"></a><span id="l25.1233" class="difflineplus">+}</span>
<a href="#l25.1234"></a><span id="l25.1234" class="difflineplus">+</span>
<a href="#l25.1235"></a><span id="l25.1235" class="difflineplus">+int json_object_array_del_idx(struct json_object *jso, size_t idx, size_t count)</span>
<a href="#l25.1236"></a><span id="l25.1236" class="difflineplus">+{</span>
<a href="#l25.1237"></a><span id="l25.1237" class="difflineplus">+	assert(json_object_get_type(jso) == json_type_array);</span>
<a href="#l25.1238"></a><span id="l25.1238" class="difflineplus">+	return array_list_del_idx(jso-&gt;o.c_array, idx, count);</span>
<a href="#l25.1239"></a><span id="l25.1239" class="difflineplus">+}</span>
<a href="#l25.1240"></a><span id="l25.1240" class="difflineplus">+</span>
<a href="#l25.1241"></a><span id="l25.1241" class="difflineplus">+struct json_object* json_object_array_get_idx(const struct json_object *jso,</span>
<a href="#l25.1242"></a><span id="l25.1242" class="difflineplus">+					      size_t idx)</span>
<a href="#l25.1243"></a><span id="l25.1243" class="difflineplus">+{</span>
<a href="#l25.1244"></a><span id="l25.1244" class="difflineplus">+	assert(json_object_get_type(jso) == json_type_array);</span>
<a href="#l25.1245"></a><span id="l25.1245" class="difflineplus">+	return (struct json_object*)array_list_get_idx(jso-&gt;o.c_array, idx);</span>
<a href="#l25.1246"></a><span id="l25.1246" class="difflineplus">+}</span>
<a href="#l25.1247"></a><span id="l25.1247" class="difflineplus">+</span>
<a href="#l25.1248"></a><span id="l25.1248" class="difflineplus">+static int json_array_equal(struct json_object* jso1,</span>
<a href="#l25.1249"></a><span id="l25.1249" class="difflineplus">+			    struct json_object* jso2)</span>
<a href="#l25.1250"></a><span id="l25.1250" class="difflineplus">+{</span>
<a href="#l25.1251"></a><span id="l25.1251" class="difflineplus">+	size_t len, i;</span>
<a href="#l25.1252"></a><span id="l25.1252" class="difflineplus">+</span>
<a href="#l25.1253"></a><span id="l25.1253" class="difflineplus">+	len = json_object_array_length(jso1);</span>
<a href="#l25.1254"></a><span id="l25.1254" class="difflineplus">+	if (len != json_object_array_length(jso2))</span>
<a href="#l25.1255"></a><span id="l25.1255" class="difflineplus">+		return 0;</span>
<a href="#l25.1256"></a><span id="l25.1256" class="difflineplus">+</span>
<a href="#l25.1257"></a><span id="l25.1257" class="difflineplus">+	for (i = 0; i &lt; len; i++) {</span>
<a href="#l25.1258"></a><span id="l25.1258" class="difflineplus">+		if (!json_object_equal(json_object_array_get_idx(jso1, i),</span>
<a href="#l25.1259"></a><span id="l25.1259" class="difflineplus">+				       json_object_array_get_idx(jso2, i)))</span>
<a href="#l25.1260"></a><span id="l25.1260" class="difflineplus">+			return 0;</span>
<a href="#l25.1261"></a><span id="l25.1261" class="difflineplus">+	}</span>
<a href="#l25.1262"></a><span id="l25.1262" class="difflineplus">+	return 1;</span>
<a href="#l25.1263"></a><span id="l25.1263" class="difflineplus">+}</span>
<a href="#l25.1264"></a><span id="l25.1264" class="difflineplus">+</span>
<a href="#l25.1265"></a><span id="l25.1265" class="difflineplus">+static int json_object_all_values_equal(struct json_object* jso1,</span>
<a href="#l25.1266"></a><span id="l25.1266" class="difflineplus">+					struct json_object* jso2)</span>
<a href="#l25.1267"></a><span id="l25.1267" class="difflineplus">+{</span>
<a href="#l25.1268"></a><span id="l25.1268" class="difflineplus">+	struct json_object_iter iter;</span>
<a href="#l25.1269"></a><span id="l25.1269" class="difflineplus">+	struct json_object *sub;</span>
<a href="#l25.1270"></a><span id="l25.1270" class="difflineplus">+</span>
<a href="#l25.1271"></a><span id="l25.1271" class="difflineplus">+	assert(json_object_get_type(jso1) == json_type_object);</span>
<a href="#l25.1272"></a><span id="l25.1272" class="difflineplus">+	assert(json_object_get_type(jso2) == json_type_object);</span>
<a href="#l25.1273"></a><span id="l25.1273" class="difflineplus">+	/* Iterate over jso1 keys and see if they exist and are equal in jso2 */</span>
<a href="#l25.1274"></a><span id="l25.1274" class="difflineplus">+        json_object_object_foreachC(jso1, iter) {</span>
<a href="#l25.1275"></a><span id="l25.1275" class="difflineplus">+		if (!lh_table_lookup_ex(jso2-&gt;o.c_object, (void*)iter.key,</span>
<a href="#l25.1276"></a><span id="l25.1276" class="difflineplus">+					(void**)(void *)&amp;sub))</span>
<a href="#l25.1277"></a><span id="l25.1277" class="difflineplus">+			return 0;</span>
<a href="#l25.1278"></a><span id="l25.1278" class="difflineplus">+		if (!json_object_equal(iter.val, sub))</span>
<a href="#l25.1279"></a><span id="l25.1279" class="difflineplus">+			return 0;</span>
<a href="#l25.1280"></a><span id="l25.1280" class="difflineplus">+        }</span>
<a href="#l25.1281"></a><span id="l25.1281" class="difflineplus">+</span>
<a href="#l25.1282"></a><span id="l25.1282" class="difflineplus">+	/* Iterate over jso2 keys to see if any exist that are not in jso1 */</span>
<a href="#l25.1283"></a><span id="l25.1283" class="difflineplus">+        json_object_object_foreachC(jso2, iter) {</span>
<a href="#l25.1284"></a><span id="l25.1284" class="difflineplus">+		if (!lh_table_lookup_ex(jso1-&gt;o.c_object, (void*)iter.key,</span>
<a href="#l25.1285"></a><span id="l25.1285" class="difflineplus">+					(void**)(void *)&amp;sub))</span>
<a href="#l25.1286"></a><span id="l25.1286" class="difflineplus">+			return 0;</span>
<a href="#l25.1287"></a><span id="l25.1287" class="difflineplus">+        }</span>
<a href="#l25.1288"></a><span id="l25.1288" class="difflineplus">+</span>
<a href="#l25.1289"></a><span id="l25.1289" class="difflineplus">+	return 1;</span>
<a href="#l25.1290"></a><span id="l25.1290" class="difflineplus">+}</span>
<a href="#l25.1291"></a><span id="l25.1291" class="difflineplus">+</span>
<a href="#l25.1292"></a><span id="l25.1292" class="difflineplus">+int json_object_equal(struct json_object* jso1, struct json_object* jso2)</span>
<a href="#l25.1293"></a><span id="l25.1293" class="difflineplus">+{</span>
<a href="#l25.1294"></a><span id="l25.1294" class="difflineplus">+	if (jso1 == jso2)</span>
<a href="#l25.1295"></a><span id="l25.1295" class="difflineplus">+		return 1;</span>
<a href="#l25.1296"></a><span id="l25.1296" class="difflineplus">+</span>
<a href="#l25.1297"></a><span id="l25.1297" class="difflineplus">+	if (!jso1 || !jso2)</span>
<a href="#l25.1298"></a><span id="l25.1298" class="difflineplus">+		return 0;</span>
<a href="#l25.1299"></a><span id="l25.1299" class="difflineplus">+</span>
<a href="#l25.1300"></a><span id="l25.1300" class="difflineplus">+	if (jso1-&gt;o_type != jso2-&gt;o_type)</span>
<a href="#l25.1301"></a><span id="l25.1301" class="difflineplus">+		return 0;</span>
<a href="#l25.1302"></a><span id="l25.1302" class="difflineplus">+</span>
<a href="#l25.1303"></a><span id="l25.1303" class="difflineplus">+	switch(jso1-&gt;o_type) {</span>
<a href="#l25.1304"></a><span id="l25.1304" class="difflineplus">+		case json_type_boolean:</span>
<a href="#l25.1305"></a><span id="l25.1305" class="difflineplus">+			return (jso1-&gt;o.c_boolean == jso2-&gt;o.c_boolean);</span>
<a href="#l25.1306"></a><span id="l25.1306" class="difflineplus">+</span>
<a href="#l25.1307"></a><span id="l25.1307" class="difflineplus">+		case json_type_double:</span>
<a href="#l25.1308"></a><span id="l25.1308" class="difflineplus">+			return (jso1-&gt;o.c_double == jso2-&gt;o.c_double);</span>
<a href="#l25.1309"></a><span id="l25.1309" class="difflineplus">+</span>
<a href="#l25.1310"></a><span id="l25.1310" class="difflineplus">+		case json_type_int:</span>
<a href="#l25.1311"></a><span id="l25.1311" class="difflineplus">+			return (jso1-&gt;o.c_int64 == jso2-&gt;o.c_int64);</span>
<a href="#l25.1312"></a><span id="l25.1312" class="difflineplus">+</span>
<a href="#l25.1313"></a><span id="l25.1313" class="difflineplus">+		case json_type_string:</span>
<a href="#l25.1314"></a><span id="l25.1314" class="difflineplus">+			return (jso1-&gt;o.c_string.len == jso2-&gt;o.c_string.len &amp;&amp;</span>
<a href="#l25.1315"></a><span id="l25.1315" class="difflineplus">+				memcmp(get_string_component(jso1),</span>
<a href="#l25.1316"></a><span id="l25.1316" class="difflineplus">+				       get_string_component(jso2),</span>
<a href="#l25.1317"></a><span id="l25.1317" class="difflineplus">+				       jso1-&gt;o.c_string.len) == 0);</span>
<a href="#l25.1318"></a><span id="l25.1318" class="difflineplus">+</span>
<a href="#l25.1319"></a><span id="l25.1319" class="difflineplus">+		case json_type_object:</span>
<a href="#l25.1320"></a><span id="l25.1320" class="difflineplus">+			return json_object_all_values_equal(jso1, jso2);</span>
<a href="#l25.1321"></a><span id="l25.1321" class="difflineplus">+</span>
<a href="#l25.1322"></a><span id="l25.1322" class="difflineplus">+		case json_type_array:</span>
<a href="#l25.1323"></a><span id="l25.1323" class="difflineplus">+			return json_array_equal(jso1, jso2);</span>
<a href="#l25.1324"></a><span id="l25.1324" class="difflineplus">+</span>
<a href="#l25.1325"></a><span id="l25.1325" class="difflineplus">+		case json_type_null:</span>
<a href="#l25.1326"></a><span id="l25.1326" class="difflineplus">+			return 1;</span>
<a href="#l25.1327"></a><span id="l25.1327" class="difflineplus">+	};</span>
<a href="#l25.1328"></a><span id="l25.1328" class="difflineplus">+</span>
<a href="#l25.1329"></a><span id="l25.1329" class="difflineplus">+	return 0;</span>
<a href="#l25.1330"></a><span id="l25.1330" class="difflineplus">+}</span>
<a href="#l25.1331"></a><span id="l25.1331" class="difflineplus">+</span>
<a href="#l25.1332"></a><span id="l25.1332" class="difflineplus">+static int json_object_copy_serializer_data(struct json_object *src, struct json_object *dst)</span>
<a href="#l25.1333"></a><span id="l25.1333" class="difflineplus">+{</span>
<a href="#l25.1334"></a><span id="l25.1334" class="difflineplus">+	if (!src-&gt;_userdata &amp;&amp; !src-&gt;_user_delete)</span>
<a href="#l25.1335"></a><span id="l25.1335" class="difflineplus">+		return 0;</span>
<a href="#l25.1336"></a><span id="l25.1336" class="difflineplus">+</span>
<a href="#l25.1337"></a><span id="l25.1337" class="difflineplus">+	if (dst-&gt;_to_json_string == json_object_userdata_to_json_string)</span>
<a href="#l25.1338"></a><span id="l25.1338" class="difflineplus">+	{</span>
<a href="#l25.1339"></a><span id="l25.1339" class="difflineplus">+		dst-&gt;_userdata = strdup(src-&gt;_userdata);</span>
<a href="#l25.1340"></a><span id="l25.1340" class="difflineplus">+	}</span>
<a href="#l25.1341"></a><span id="l25.1341" class="difflineplus">+	// else if ... other supported serializers ...</span>
<a href="#l25.1342"></a><span id="l25.1342" class="difflineplus">+	else</span>
<a href="#l25.1343"></a><span id="l25.1343" class="difflineplus">+	{</span>
<a href="#l25.1344"></a><span id="l25.1344" class="difflineplus">+		_json_c_set_last_err(&quot;json_object_deep_copy: unable to copy unknown serializer data: %p\n&quot;, dst-&gt;_to_json_string);</span>
<a href="#l25.1345"></a><span id="l25.1345" class="difflineplus">+		return -1;</span>
<a href="#l25.1346"></a><span id="l25.1346" class="difflineplus">+	}</span>
<a href="#l25.1347"></a><span id="l25.1347" class="difflineplus">+	dst-&gt;_user_delete = src-&gt;_user_delete;</span>
<a href="#l25.1348"></a><span id="l25.1348" class="difflineplus">+	return 0;</span>
<a href="#l25.1349"></a><span id="l25.1349" class="difflineplus">+}</span>
<a href="#l25.1350"></a><span id="l25.1350" class="difflineplus">+</span>
<a href="#l25.1351"></a><span id="l25.1351" class="difflineplus">+</span>
<a href="#l25.1352"></a><span id="l25.1352" class="difflineplus">+/**</span>
<a href="#l25.1353"></a><span id="l25.1353" class="difflineplus">+ * The default shallow copy implementation.  Simply creates a new object of the same</span>
<a href="#l25.1354"></a><span id="l25.1354" class="difflineplus">+ * type but does *not* copy over _userdata nor retain any custom serializer.</span>
<a href="#l25.1355"></a><span id="l25.1355" class="difflineplus">+ * If custom serializers are in use, json_object_deep_copy() must be passed a shallow copy</span>
<a href="#l25.1356"></a><span id="l25.1356" class="difflineplus">+ * implementation that is aware of how to copy them.</span>
<a href="#l25.1357"></a><span id="l25.1357" class="difflineplus">+ *</span>
<a href="#l25.1358"></a><span id="l25.1358" class="difflineplus">+ * This always returns -1 or 1.  It will never return 2 since it does not copy the serializer.</span>
<a href="#l25.1359"></a><span id="l25.1359" class="difflineplus">+ */</span>
<a href="#l25.1360"></a><span id="l25.1360" class="difflineplus">+int json_c_shallow_copy_default(json_object *src, json_object *parent, const char *key, size_t index, json_object **dst)</span>
<a href="#l25.1361"></a><span id="l25.1361" class="difflineplus">+{</span>
<a href="#l25.1362"></a><span id="l25.1362" class="difflineplus">+	switch (src-&gt;o_type) {</span>
<a href="#l25.1363"></a><span id="l25.1363" class="difflineplus">+	case json_type_boolean:</span>
<a href="#l25.1364"></a><span id="l25.1364" class="difflineplus">+		*dst = json_object_new_boolean(src-&gt;o.c_boolean);</span>
<a href="#l25.1365"></a><span id="l25.1365" class="difflineplus">+		break;</span>
<a href="#l25.1366"></a><span id="l25.1366" class="difflineplus">+</span>
<a href="#l25.1367"></a><span id="l25.1367" class="difflineplus">+	case json_type_double:</span>
<a href="#l25.1368"></a><span id="l25.1368" class="difflineplus">+		*dst = json_object_new_double(src-&gt;o.c_double);</span>
<a href="#l25.1369"></a><span id="l25.1369" class="difflineplus">+		break;</span>
<a href="#l25.1370"></a><span id="l25.1370" class="difflineplus">+</span>
<a href="#l25.1371"></a><span id="l25.1371" class="difflineplus">+	case json_type_int:</span>
<a href="#l25.1372"></a><span id="l25.1372" class="difflineplus">+		*dst = json_object_new_int64(src-&gt;o.c_int64);</span>
<a href="#l25.1373"></a><span id="l25.1373" class="difflineplus">+		break;</span>
<a href="#l25.1374"></a><span id="l25.1374" class="difflineplus">+</span>
<a href="#l25.1375"></a><span id="l25.1375" class="difflineplus">+	case json_type_string:</span>
<a href="#l25.1376"></a><span id="l25.1376" class="difflineplus">+		*dst = json_object_new_string(get_string_component(src));</span>
<a href="#l25.1377"></a><span id="l25.1377" class="difflineplus">+		break;</span>
<a href="#l25.1378"></a><span id="l25.1378" class="difflineplus">+</span>
<a href="#l25.1379"></a><span id="l25.1379" class="difflineplus">+	case json_type_object:</span>
<a href="#l25.1380"></a><span id="l25.1380" class="difflineplus">+		*dst = json_object_new_object();</span>
<a href="#l25.1381"></a><span id="l25.1381" class="difflineplus">+		break;</span>
<a href="#l25.1382"></a><span id="l25.1382" class="difflineplus">+</span>
<a href="#l25.1383"></a><span id="l25.1383" class="difflineplus">+	case json_type_array:</span>
<a href="#l25.1384"></a><span id="l25.1384" class="difflineplus">+		*dst = json_object_new_array();</span>
<a href="#l25.1385"></a><span id="l25.1385" class="difflineplus">+		break;</span>
<a href="#l25.1386"></a><span id="l25.1386" class="difflineplus">+</span>
<a href="#l25.1387"></a><span id="l25.1387" class="difflineplus">+	default:</span>
<a href="#l25.1388"></a><span id="l25.1388" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l25.1389"></a><span id="l25.1389" class="difflineplus">+		return -1;</span>
<a href="#l25.1390"></a><span id="l25.1390" class="difflineplus">+	}</span>
<a href="#l25.1391"></a><span id="l25.1391" class="difflineplus">+</span>
<a href="#l25.1392"></a><span id="l25.1392" class="difflineplus">+	if (!*dst) {</span>
<a href="#l25.1393"></a><span id="l25.1393" class="difflineplus">+		errno = ENOMEM;</span>
<a href="#l25.1394"></a><span id="l25.1394" class="difflineplus">+		return -1;</span>
<a href="#l25.1395"></a><span id="l25.1395" class="difflineplus">+	}</span>
<a href="#l25.1396"></a><span id="l25.1396" class="difflineplus">+	(*dst)-&gt;_to_json_string = src-&gt;_to_json_string;</span>
<a href="#l25.1397"></a><span id="l25.1397" class="difflineplus">+	// _userdata and _user_delete are copied later</span>
<a href="#l25.1398"></a><span id="l25.1398" class="difflineplus">+	return 1;</span>
<a href="#l25.1399"></a><span id="l25.1399" class="difflineplus">+}</span>
<a href="#l25.1400"></a><span id="l25.1400" class="difflineplus">+</span>
<a href="#l25.1401"></a><span id="l25.1401" class="difflineplus">+/*</span>
<a href="#l25.1402"></a><span id="l25.1402" class="difflineplus">+ * The actual guts of json_object_deep_copy(), with a few additional args</span>
<a href="#l25.1403"></a><span id="l25.1403" class="difflineplus">+ * needed so we can keep track of where we are within the object tree.</span>
<a href="#l25.1404"></a><span id="l25.1404" class="difflineplus">+ *</span>
<a href="#l25.1405"></a><span id="l25.1405" class="difflineplus">+ * Note: caller is responsible for freeing *dst if this fails and returns -1.</span>
<a href="#l25.1406"></a><span id="l25.1406" class="difflineplus">+ */</span>
<a href="#l25.1407"></a><span id="l25.1407" class="difflineplus">+static int json_object_deep_copy_recursive(struct json_object *src, struct json_object *parent, const char *key_in_parent, size_t index_in_parent, struct json_object **dst, json_c_shallow_copy_fn *shallow_copy)</span>
<a href="#l25.1408"></a><span id="l25.1408" class="difflineplus">+{</span>
<a href="#l25.1409"></a><span id="l25.1409" class="difflineplus">+	struct json_object_iter iter;</span>
<a href="#l25.1410"></a><span id="l25.1410" class="difflineplus">+	size_t src_array_len, ii;</span>
<a href="#l25.1411"></a><span id="l25.1411" class="difflineplus">+</span>
<a href="#l25.1412"></a><span id="l25.1412" class="difflineplus">+	int shallow_copy_rc = 0;</span>
<a href="#l25.1413"></a><span id="l25.1413" class="difflineplus">+	shallow_copy_rc = shallow_copy(src, parent, key_in_parent, index_in_parent, dst);</span>
<a href="#l25.1414"></a><span id="l25.1414" class="difflineplus">+	/* -1=error, 1=object created ok, 2=userdata set */</span>
<a href="#l25.1415"></a><span id="l25.1415" class="difflineplus">+	if (shallow_copy_rc &lt; 1)</span>
<a href="#l25.1416"></a><span id="l25.1416" class="difflineplus">+	{</span>
<a href="#l25.1417"></a><span id="l25.1417" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l25.1418"></a><span id="l25.1418" class="difflineplus">+		return -1;</span>
<a href="#l25.1419"></a><span id="l25.1419" class="difflineplus">+	}</span>
<a href="#l25.1420"></a><span id="l25.1420" class="difflineplus">+	assert(*dst != NULL);</span>
<a href="#l25.1421"></a><span id="l25.1421" class="difflineplus">+</span>
<a href="#l25.1422"></a><span id="l25.1422" class="difflineplus">+	switch (src-&gt;o_type) {</span>
<a href="#l25.1423"></a><span id="l25.1423" class="difflineplus">+	case json_type_object:</span>
<a href="#l25.1424"></a><span id="l25.1424" class="difflineplus">+		json_object_object_foreachC(src, iter) {</span>
<a href="#l25.1425"></a><span id="l25.1425" class="difflineplus">+			struct json_object *jso = NULL;</span>
<a href="#l25.1426"></a><span id="l25.1426" class="difflineplus">+			/* This handles the `json_type_null` case */</span>
<a href="#l25.1427"></a><span id="l25.1427" class="difflineplus">+			if (!iter.val)</span>
<a href="#l25.1428"></a><span id="l25.1428" class="difflineplus">+				jso = NULL;</span>
<a href="#l25.1429"></a><span id="l25.1429" class="difflineplus">+			else if (json_object_deep_copy_recursive(iter.val, src, iter.key, -1, &amp;jso, shallow_copy) &lt; 0)</span>
<a href="#l25.1430"></a><span id="l25.1430" class="difflineplus">+			{</span>
<a href="#l25.1431"></a><span id="l25.1431" class="difflineplus">+				json_object_put(jso);</span>
<a href="#l25.1432"></a><span id="l25.1432" class="difflineplus">+				return -1;</span>
<a href="#l25.1433"></a><span id="l25.1433" class="difflineplus">+			}</span>
<a href="#l25.1434"></a><span id="l25.1434" class="difflineplus">+</span>
<a href="#l25.1435"></a><span id="l25.1435" class="difflineplus">+			if (json_object_object_add(*dst, iter.key, jso) &lt; 0)</span>
<a href="#l25.1436"></a><span id="l25.1436" class="difflineplus">+			{</span>
<a href="#l25.1437"></a><span id="l25.1437" class="difflineplus">+				json_object_put(jso);</span>
<a href="#l25.1438"></a><span id="l25.1438" class="difflineplus">+				return -1;</span>
<a href="#l25.1439"></a><span id="l25.1439" class="difflineplus">+			}</span>
<a href="#l25.1440"></a><span id="l25.1440" class="difflineplus">+		}</span>
<a href="#l25.1441"></a><span id="l25.1441" class="difflineplus">+		break;</span>
<a href="#l25.1442"></a><span id="l25.1442" class="difflineplus">+</span>
<a href="#l25.1443"></a><span id="l25.1443" class="difflineplus">+	case json_type_array:</span>
<a href="#l25.1444"></a><span id="l25.1444" class="difflineplus">+		src_array_len = json_object_array_length(src);</span>
<a href="#l25.1445"></a><span id="l25.1445" class="difflineplus">+		for (ii = 0; ii &lt; src_array_len; ii++) {</span>
<a href="#l25.1446"></a><span id="l25.1446" class="difflineplus">+			struct json_object *jso = NULL;</span>
<a href="#l25.1447"></a><span id="l25.1447" class="difflineplus">+			struct json_object *jso1 = json_object_array_get_idx(src, ii);</span>
<a href="#l25.1448"></a><span id="l25.1448" class="difflineplus">+			/* This handles the `json_type_null` case */</span>
<a href="#l25.1449"></a><span id="l25.1449" class="difflineplus">+			if (!jso1)</span>
<a href="#l25.1450"></a><span id="l25.1450" class="difflineplus">+				jso = NULL;</span>
<a href="#l25.1451"></a><span id="l25.1451" class="difflineplus">+			else if (json_object_deep_copy_recursive(jso1, src, NULL, ii, &amp;jso, shallow_copy) &lt; 0)</span>
<a href="#l25.1452"></a><span id="l25.1452" class="difflineplus">+			{</span>
<a href="#l25.1453"></a><span id="l25.1453" class="difflineplus">+				json_object_put(jso);</span>
<a href="#l25.1454"></a><span id="l25.1454" class="difflineplus">+				return -1;</span>
<a href="#l25.1455"></a><span id="l25.1455" class="difflineplus">+			}</span>
<a href="#l25.1456"></a><span id="l25.1456" class="difflineplus">+</span>
<a href="#l25.1457"></a><span id="l25.1457" class="difflineplus">+			if (json_object_array_add(*dst, jso) &lt; 0)</span>
<a href="#l25.1458"></a><span id="l25.1458" class="difflineplus">+			{</span>
<a href="#l25.1459"></a><span id="l25.1459" class="difflineplus">+				json_object_put(jso);</span>
<a href="#l25.1460"></a><span id="l25.1460" class="difflineplus">+				return -1;</span>
<a href="#l25.1461"></a><span id="l25.1461" class="difflineplus">+			}</span>
<a href="#l25.1462"></a><span id="l25.1462" class="difflineplus">+		}</span>
<a href="#l25.1463"></a><span id="l25.1463" class="difflineplus">+		break;</span>
<a href="#l25.1464"></a><span id="l25.1464" class="difflineplus">+</span>
<a href="#l25.1465"></a><span id="l25.1465" class="difflineplus">+	default:</span>
<a href="#l25.1466"></a><span id="l25.1466" class="difflineplus">+		break;</span>
<a href="#l25.1467"></a><span id="l25.1467" class="difflineplus">+		/* else, nothing to do, shallow_copy already did. */</span>
<a href="#l25.1468"></a><span id="l25.1468" class="difflineplus">+	}</span>
<a href="#l25.1469"></a><span id="l25.1469" class="difflineplus">+</span>
<a href="#l25.1470"></a><span id="l25.1470" class="difflineplus">+	if (shallow_copy_rc != 2)</span>
<a href="#l25.1471"></a><span id="l25.1471" class="difflineplus">+		return json_object_copy_serializer_data(src, *dst);</span>
<a href="#l25.1472"></a><span id="l25.1472" class="difflineplus">+</span>
<a href="#l25.1473"></a><span id="l25.1473" class="difflineplus">+	return 0;</span>
<a href="#l25.1474"></a><span id="l25.1474" class="difflineplus">+}</span>
<a href="#l25.1475"></a><span id="l25.1475" class="difflineplus">+</span>
<a href="#l25.1476"></a><span id="l25.1476" class="difflineplus">+int json_object_deep_copy(struct json_object *src, struct json_object **dst, json_c_shallow_copy_fn *shallow_copy)</span>
<a href="#l25.1477"></a><span id="l25.1477" class="difflineplus">+{</span>
<a href="#l25.1478"></a><span id="l25.1478" class="difflineplus">+	int rc;</span>
<a href="#l25.1479"></a><span id="l25.1479" class="difflineplus">+</span>
<a href="#l25.1480"></a><span id="l25.1480" class="difflineplus">+	/* Check if arguments are sane ; *dst must not point to a non-NULL object */</span>
<a href="#l25.1481"></a><span id="l25.1481" class="difflineplus">+	if (!src || !dst || *dst) {</span>
<a href="#l25.1482"></a><span id="l25.1482" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l25.1483"></a><span id="l25.1483" class="difflineplus">+		return -1;</span>
<a href="#l25.1484"></a><span id="l25.1484" class="difflineplus">+	}</span>
<a href="#l25.1485"></a><span id="l25.1485" class="difflineplus">+</span>
<a href="#l25.1486"></a><span id="l25.1486" class="difflineplus">+	if (shallow_copy == NULL)</span>
<a href="#l25.1487"></a><span id="l25.1487" class="difflineplus">+		shallow_copy = json_c_shallow_copy_default;</span>
<a href="#l25.1488"></a><span id="l25.1488" class="difflineplus">+</span>
<a href="#l25.1489"></a><span id="l25.1489" class="difflineplus">+	rc = json_object_deep_copy_recursive(src, NULL, NULL, -1, dst, shallow_copy);</span>
<a href="#l25.1490"></a><span id="l25.1490" class="difflineplus">+	if (rc &lt; 0) {</span>
<a href="#l25.1491"></a><span id="l25.1491" class="difflineplus">+		json_object_put(*dst);</span>
<a href="#l25.1492"></a><span id="l25.1492" class="difflineplus">+		*dst = NULL;</span>
<a href="#l25.1493"></a><span id="l25.1493" class="difflineplus">+	}</span>
<a href="#l25.1494"></a><span id="l25.1494" class="difflineplus">+</span>
<a href="#l25.1495"></a><span id="l25.1495" class="difflineplus">+	return rc;</span>
<a href="#l25.1496"></a><span id="l25.1496" class="difflineplus">+}</span>
<a href="#l25.1497"></a><span id="l25.1497" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1">new file mode 100644</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineminus">--- /dev/null</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineplus">+++ b/third_party/json-c/json_object.h</span>
<a href="#l26.4"></a><span id="l26.4" class="difflineat">@@ -0,0 +1,1034 @@</span>
<a href="#l26.5"></a><span id="l26.5" class="difflineplus">+/*</span>
<a href="#l26.6"></a><span id="l26.6" class="difflineplus">+ * $Id: json_object.h,v 1.12 2006/01/30 23:07:57 mclark Exp $</span>
<a href="#l26.7"></a><span id="l26.7" class="difflineplus">+ *</span>
<a href="#l26.8"></a><span id="l26.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l26.9"></a><span id="l26.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l26.10"></a><span id="l26.10" class="difflineplus">+ * Copyright (c) 2009 Hewlett-Packard Development Company, L.P.</span>
<a href="#l26.11"></a><span id="l26.11" class="difflineplus">+ *</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l26.14"></a><span id="l26.14" class="difflineplus">+ *</span>
<a href="#l26.15"></a><span id="l26.15" class="difflineplus">+ */</span>
<a href="#l26.16"></a><span id="l26.16" class="difflineplus">+</span>
<a href="#l26.17"></a><span id="l26.17" class="difflineplus">+/**</span>
<a href="#l26.18"></a><span id="l26.18" class="difflineplus">+ * @file</span>
<a href="#l26.19"></a><span id="l26.19" class="difflineplus">+ * @brief Core json-c API.  Start here, or with json_tokener.h</span>
<a href="#l26.20"></a><span id="l26.20" class="difflineplus">+ */</span>
<a href="#l26.21"></a><span id="l26.21" class="difflineplus">+#ifndef _json_object_h_</span>
<a href="#l26.22"></a><span id="l26.22" class="difflineplus">+#define _json_object_h_</span>
<a href="#l26.23"></a><span id="l26.23" class="difflineplus">+</span>
<a href="#l26.24"></a><span id="l26.24" class="difflineplus">+#ifdef __GNUC__</span>
<a href="#l26.25"></a><span id="l26.25" class="difflineplus">+#define THIS_FUNCTION_IS_DEPRECATED(func) func __attribute__ ((deprecated))</span>
<a href="#l26.26"></a><span id="l26.26" class="difflineplus">+#elif defined(_MSC_VER)</span>
<a href="#l26.27"></a><span id="l26.27" class="difflineplus">+#define THIS_FUNCTION_IS_DEPRECATED(func) __declspec(deprecated) func</span>
<a href="#l26.28"></a><span id="l26.28" class="difflineplus">+#elif defined(__clang__)</span>
<a href="#l26.29"></a><span id="l26.29" class="difflineplus">+#define THIS_FUNCTION_IS_DEPRECATED(func) func __deprecated</span>
<a href="#l26.30"></a><span id="l26.30" class="difflineplus">+#else</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineplus">+#define THIS_FUNCTION_IS_DEPRECATED(func) func</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineplus">+#endif</span>
<a href="#l26.33"></a><span id="l26.33" class="difflineplus">+</span>
<a href="#l26.34"></a><span id="l26.34" class="difflineplus">+#ifdef __GNUC__</span>
<a href="#l26.35"></a><span id="l26.35" class="difflineplus">+#define JSON_C_CONST_FUNCTION(func) func __attribute__((const))</span>
<a href="#l26.36"></a><span id="l26.36" class="difflineplus">+#else</span>
<a href="#l26.37"></a><span id="l26.37" class="difflineplus">+#define JSON_C_CONST_FUNCTION(func) func</span>
<a href="#l26.38"></a><span id="l26.38" class="difflineplus">+#endif</span>
<a href="#l26.39"></a><span id="l26.39" class="difflineplus">+</span>
<a href="#l26.40"></a><span id="l26.40" class="difflineplus">+#if defined(_MSC_VER) </span>
<a href="#l26.41"></a><span id="l26.41" class="difflineplus">+#define JSON_EXPORT __declspec(dllexport)</span>
<a href="#l26.42"></a><span id="l26.42" class="difflineplus">+#else</span>
<a href="#l26.43"></a><span id="l26.43" class="difflineplus">+#define JSON_EXPORT extern</span>
<a href="#l26.44"></a><span id="l26.44" class="difflineplus">+#endif</span>
<a href="#l26.45"></a><span id="l26.45" class="difflineplus">+</span>
<a href="#l26.46"></a><span id="l26.46" class="difflineplus">+#include &lt;stddef.h&gt;</span>
<a href="#l26.47"></a><span id="l26.47" class="difflineplus">+#include &quot;json_inttypes.h&quot;</span>
<a href="#l26.48"></a><span id="l26.48" class="difflineplus">+#include &quot;printbuf.h&quot;</span>
<a href="#l26.49"></a><span id="l26.49" class="difflineplus">+</span>
<a href="#l26.50"></a><span id="l26.50" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l26.51"></a><span id="l26.51" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l26.52"></a><span id="l26.52" class="difflineplus">+#endif</span>
<a href="#l26.53"></a><span id="l26.53" class="difflineplus">+</span>
<a href="#l26.54"></a><span id="l26.54" class="difflineplus">+#define JSON_OBJECT_DEF_HASH_ENTRIES 16</span>
<a href="#l26.55"></a><span id="l26.55" class="difflineplus">+</span>
<a href="#l26.56"></a><span id="l26.56" class="difflineplus">+/**</span>
<a href="#l26.57"></a><span id="l26.57" class="difflineplus">+ * A flag for the json_object_to_json_string_ext() and</span>
<a href="#l26.58"></a><span id="l26.58" class="difflineplus">+ * json_object_to_file_ext() functions which causes the output</span>
<a href="#l26.59"></a><span id="l26.59" class="difflineplus">+ * to have no extra whitespace or formatting applied.</span>
<a href="#l26.60"></a><span id="l26.60" class="difflineplus">+ */</span>
<a href="#l26.61"></a><span id="l26.61" class="difflineplus">+#define JSON_C_TO_STRING_PLAIN      0</span>
<a href="#l26.62"></a><span id="l26.62" class="difflineplus">+/**</span>
<a href="#l26.63"></a><span id="l26.63" class="difflineplus">+ * A flag for the json_object_to_json_string_ext() and</span>
<a href="#l26.64"></a><span id="l26.64" class="difflineplus">+ * json_object_to_file_ext() functions which causes the output to have</span>
<a href="#l26.65"></a><span id="l26.65" class="difflineplus">+ * minimal whitespace inserted to make things slightly more readable.</span>
<a href="#l26.66"></a><span id="l26.66" class="difflineplus">+ */</span>
<a href="#l26.67"></a><span id="l26.67" class="difflineplus">+#define JSON_C_TO_STRING_SPACED     (1&lt;&lt;0)</span>
<a href="#l26.68"></a><span id="l26.68" class="difflineplus">+/**</span>
<a href="#l26.69"></a><span id="l26.69" class="difflineplus">+ * A flag for the json_object_to_json_string_ext() and</span>
<a href="#l26.70"></a><span id="l26.70" class="difflineplus">+ * json_object_to_file_ext() functions which causes</span>
<a href="#l26.71"></a><span id="l26.71" class="difflineplus">+ * the output to be formatted.</span>
<a href="#l26.72"></a><span id="l26.72" class="difflineplus">+ *</span>
<a href="#l26.73"></a><span id="l26.73" class="difflineplus">+ * See the &quot;Two Space Tab&quot; option at http://jsonformatter.curiousconcept.com/</span>
<a href="#l26.74"></a><span id="l26.74" class="difflineplus">+ * for an example of the format.</span>
<a href="#l26.75"></a><span id="l26.75" class="difflineplus">+ */</span>
<a href="#l26.76"></a><span id="l26.76" class="difflineplus">+#define JSON_C_TO_STRING_PRETTY     (1&lt;&lt;1)</span>
<a href="#l26.77"></a><span id="l26.77" class="difflineplus">+/**</span>
<a href="#l26.78"></a><span id="l26.78" class="difflineplus">+ * A flag for the json_object_to_json_string_ext() and</span>
<a href="#l26.79"></a><span id="l26.79" class="difflineplus">+ * json_object_to_file_ext() functions which causes</span>
<a href="#l26.80"></a><span id="l26.80" class="difflineplus">+ * the output to be formatted.</span>
<a href="#l26.81"></a><span id="l26.81" class="difflineplus">+ *</span>
<a href="#l26.82"></a><span id="l26.82" class="difflineplus">+ * Instead of a &quot;Two Space Tab&quot; this gives a single tab character.</span>
<a href="#l26.83"></a><span id="l26.83" class="difflineplus">+ */</span>
<a href="#l26.84"></a><span id="l26.84" class="difflineplus">+#define JSON_C_TO_STRING_PRETTY_TAB (1&lt;&lt;3)</span>
<a href="#l26.85"></a><span id="l26.85" class="difflineplus">+/**</span>
<a href="#l26.86"></a><span id="l26.86" class="difflineplus">+ * A flag to drop trailing zero for float values</span>
<a href="#l26.87"></a><span id="l26.87" class="difflineplus">+ */</span>
<a href="#l26.88"></a><span id="l26.88" class="difflineplus">+#define JSON_C_TO_STRING_NOZERO     (1&lt;&lt;2)</span>
<a href="#l26.89"></a><span id="l26.89" class="difflineplus">+</span>
<a href="#l26.90"></a><span id="l26.90" class="difflineplus">+/**</span>
<a href="#l26.91"></a><span id="l26.91" class="difflineplus">+ * Don't escape forward slashes.</span>
<a href="#l26.92"></a><span id="l26.92" class="difflineplus">+ */</span>
<a href="#l26.93"></a><span id="l26.93" class="difflineplus">+#define JSON_C_TO_STRING_NOSLASHESCAPE (1&lt;&lt;4)</span>
<a href="#l26.94"></a><span id="l26.94" class="difflineplus">+</span>
<a href="#l26.95"></a><span id="l26.95" class="difflineplus">+/**</span>
<a href="#l26.96"></a><span id="l26.96" class="difflineplus">+ * A flag for the json_object_object_add_ex function which</span>
<a href="#l26.97"></a><span id="l26.97" class="difflineplus">+ * causes the value to be added without a check if it already exists.</span>
<a href="#l26.98"></a><span id="l26.98" class="difflineplus">+ * Note: it is the responsibilty of the caller to ensure that no</span>
<a href="#l26.99"></a><span id="l26.99" class="difflineplus">+ * key is added multiple times. If this is done, results are</span>
<a href="#l26.100"></a><span id="l26.100" class="difflineplus">+ * unpredictable. While this option is somewhat dangerous, it</span>
<a href="#l26.101"></a><span id="l26.101" class="difflineplus">+ * permits potentially large performance savings in code that</span>
<a href="#l26.102"></a><span id="l26.102" class="difflineplus">+ * knows for sure the key values are unique (e.g. because the</span>
<a href="#l26.103"></a><span id="l26.103" class="difflineplus">+ * code adds a well-known set of constant key values).</span>
<a href="#l26.104"></a><span id="l26.104" class="difflineplus">+ */</span>
<a href="#l26.105"></a><span id="l26.105" class="difflineplus">+#define JSON_C_OBJECT_ADD_KEY_IS_NEW (1&lt;&lt;1)</span>
<a href="#l26.106"></a><span id="l26.106" class="difflineplus">+/**</span>
<a href="#l26.107"></a><span id="l26.107" class="difflineplus">+ * A flag for the json_object_object_add_ex function which</span>
<a href="#l26.108"></a><span id="l26.108" class="difflineplus">+ * flags the key as being constant memory. This means that</span>
<a href="#l26.109"></a><span id="l26.109" class="difflineplus">+ * the key will NOT be copied via strdup(), resulting in a</span>
<a href="#l26.110"></a><span id="l26.110" class="difflineplus">+ * potentially huge performance win (malloc, strdup and</span>
<a href="#l26.111"></a><span id="l26.111" class="difflineplus">+ * free are usually performance hogs). It is acceptable to</span>
<a href="#l26.112"></a><span id="l26.112" class="difflineplus">+ * use this flag for keys in non-constant memory blocks if</span>
<a href="#l26.113"></a><span id="l26.113" class="difflineplus">+ * the caller ensure that the memory holding the key lives</span>
<a href="#l26.114"></a><span id="l26.114" class="difflineplus">+ * longer than the corresponding json object. However, this</span>
<a href="#l26.115"></a><span id="l26.115" class="difflineplus">+ * is somewhat dangerous and should only be done if really</span>
<a href="#l26.116"></a><span id="l26.116" class="difflineplus">+ * justified.</span>
<a href="#l26.117"></a><span id="l26.117" class="difflineplus">+ * The general use-case for this flag is cases where the</span>
<a href="#l26.118"></a><span id="l26.118" class="difflineplus">+ * key is given as a real constant value in the function</span>
<a href="#l26.119"></a><span id="l26.119" class="difflineplus">+ * call, e.g. as in</span>
<a href="#l26.120"></a><span id="l26.120" class="difflineplus">+ *   json_object_object_add_ex(obj, &quot;ip&quot;, json,</span>
<a href="#l26.121"></a><span id="l26.121" class="difflineplus">+ *       JSON_C_OBJECT_KEY_IS_CONSTANT);</span>
<a href="#l26.122"></a><span id="l26.122" class="difflineplus">+ */</span>
<a href="#l26.123"></a><span id="l26.123" class="difflineplus">+#define JSON_C_OBJECT_KEY_IS_CONSTANT (1&lt;&lt;2)</span>
<a href="#l26.124"></a><span id="l26.124" class="difflineplus">+</span>
<a href="#l26.125"></a><span id="l26.125" class="difflineplus">+#undef FALSE</span>
<a href="#l26.126"></a><span id="l26.126" class="difflineplus">+#define FALSE ((json_bool)0)</span>
<a href="#l26.127"></a><span id="l26.127" class="difflineplus">+</span>
<a href="#l26.128"></a><span id="l26.128" class="difflineplus">+#undef TRUE</span>
<a href="#l26.129"></a><span id="l26.129" class="difflineplus">+#define TRUE ((json_bool)1)</span>
<a href="#l26.130"></a><span id="l26.130" class="difflineplus">+</span>
<a href="#l26.131"></a><span id="l26.131" class="difflineplus">+/**</span>
<a href="#l26.132"></a><span id="l26.132" class="difflineplus">+ * Set the global value of an option, which will apply to all</span>
<a href="#l26.133"></a><span id="l26.133" class="difflineplus">+ * current and future threads that have not set a thread-local value.</span>
<a href="#l26.134"></a><span id="l26.134" class="difflineplus">+ *</span>
<a href="#l26.135"></a><span id="l26.135" class="difflineplus">+ * @see json_c_set_serialization_double_format</span>
<a href="#l26.136"></a><span id="l26.136" class="difflineplus">+ */</span>
<a href="#l26.137"></a><span id="l26.137" class="difflineplus">+#define JSON_C_OPTION_GLOBAL (0)</span>
<a href="#l26.138"></a><span id="l26.138" class="difflineplus">+/**</span>
<a href="#l26.139"></a><span id="l26.139" class="difflineplus">+ * Set a thread-local value of an option, overriding the global value.</span>
<a href="#l26.140"></a><span id="l26.140" class="difflineplus">+ * This will fail if json-c is not compiled with threading enabled, and</span>
<a href="#l26.141"></a><span id="l26.141" class="difflineplus">+ * with the __thread specifier (or equivalent) available.</span>
<a href="#l26.142"></a><span id="l26.142" class="difflineplus">+ *</span>
<a href="#l26.143"></a><span id="l26.143" class="difflineplus">+ * @see json_c_set_serialization_double_format</span>
<a href="#l26.144"></a><span id="l26.144" class="difflineplus">+ */</span>
<a href="#l26.145"></a><span id="l26.145" class="difflineplus">+#define JSON_C_OPTION_THREAD (1)</span>
<a href="#l26.146"></a><span id="l26.146" class="difflineplus">+</span>
<a href="#l26.147"></a><span id="l26.147" class="difflineplus">+/**</span>
<a href="#l26.148"></a><span id="l26.148" class="difflineplus">+ * A structure to use with json_object_object_foreachC() loops.</span>
<a href="#l26.149"></a><span id="l26.149" class="difflineplus">+ * Contains key, val and entry members.</span>
<a href="#l26.150"></a><span id="l26.150" class="difflineplus">+ */</span>
<a href="#l26.151"></a><span id="l26.151" class="difflineplus">+struct json_object_iter</span>
<a href="#l26.152"></a><span id="l26.152" class="difflineplus">+{</span>
<a href="#l26.153"></a><span id="l26.153" class="difflineplus">+	char *key;</span>
<a href="#l26.154"></a><span id="l26.154" class="difflineplus">+	struct json_object *val;</span>
<a href="#l26.155"></a><span id="l26.155" class="difflineplus">+	struct lh_entry *entry;</span>
<a href="#l26.156"></a><span id="l26.156" class="difflineplus">+};</span>
<a href="#l26.157"></a><span id="l26.157" class="difflineplus">+typedef struct json_object_iter json_object_iter;</span>
<a href="#l26.158"></a><span id="l26.158" class="difflineplus">+</span>
<a href="#l26.159"></a><span id="l26.159" class="difflineplus">+typedef int json_bool;</span>
<a href="#l26.160"></a><span id="l26.160" class="difflineplus">+</span>
<a href="#l26.161"></a><span id="l26.161" class="difflineplus">+/**</span>
<a href="#l26.162"></a><span id="l26.162" class="difflineplus">+ * @brief The core type for all type of JSON objects handled by json-c</span>
<a href="#l26.163"></a><span id="l26.163" class="difflineplus">+ */</span>
<a href="#l26.164"></a><span id="l26.164" class="difflineplus">+typedef struct json_object json_object;</span>
<a href="#l26.165"></a><span id="l26.165" class="difflineplus">+</span>
<a href="#l26.166"></a><span id="l26.166" class="difflineplus">+/**</span>
<a href="#l26.167"></a><span id="l26.167" class="difflineplus">+ * Type of custom user delete functions.  See json_object_set_serializer.</span>
<a href="#l26.168"></a><span id="l26.168" class="difflineplus">+ */</span>
<a href="#l26.169"></a><span id="l26.169" class="difflineplus">+typedef void (json_object_delete_fn)(struct json_object *jso, void *userdata);</span>
<a href="#l26.170"></a><span id="l26.170" class="difflineplus">+</span>
<a href="#l26.171"></a><span id="l26.171" class="difflineplus">+/**</span>
<a href="#l26.172"></a><span id="l26.172" class="difflineplus">+ * Type of a custom serialization function.  See json_object_set_serializer.</span>
<a href="#l26.173"></a><span id="l26.173" class="difflineplus">+ */</span>
<a href="#l26.174"></a><span id="l26.174" class="difflineplus">+typedef int (json_object_to_json_string_fn)(struct json_object *jso,</span>
<a href="#l26.175"></a><span id="l26.175" class="difflineplus">+						struct printbuf *pb,</span>
<a href="#l26.176"></a><span id="l26.176" class="difflineplus">+						int level,</span>
<a href="#l26.177"></a><span id="l26.177" class="difflineplus">+						int flags);</span>
<a href="#l26.178"></a><span id="l26.178" class="difflineplus">+</span>
<a href="#l26.179"></a><span id="l26.179" class="difflineplus">+/* supported object types */</span>
<a href="#l26.180"></a><span id="l26.180" class="difflineplus">+</span>
<a href="#l26.181"></a><span id="l26.181" class="difflineplus">+typedef enum json_type {</span>
<a href="#l26.182"></a><span id="l26.182" class="difflineplus">+  /* If you change this, be sure to update json_type_to_name() too */</span>
<a href="#l26.183"></a><span id="l26.183" class="difflineplus">+  json_type_null,</span>
<a href="#l26.184"></a><span id="l26.184" class="difflineplus">+  json_type_boolean,</span>
<a href="#l26.185"></a><span id="l26.185" class="difflineplus">+  json_type_double,</span>
<a href="#l26.186"></a><span id="l26.186" class="difflineplus">+  json_type_int,</span>
<a href="#l26.187"></a><span id="l26.187" class="difflineplus">+  json_type_object,</span>
<a href="#l26.188"></a><span id="l26.188" class="difflineplus">+  json_type_array,</span>
<a href="#l26.189"></a><span id="l26.189" class="difflineplus">+  json_type_string</span>
<a href="#l26.190"></a><span id="l26.190" class="difflineplus">+} json_type;</span>
<a href="#l26.191"></a><span id="l26.191" class="difflineplus">+</span>
<a href="#l26.192"></a><span id="l26.192" class="difflineplus">+/* reference counting functions */</span>
<a href="#l26.193"></a><span id="l26.193" class="difflineplus">+</span>
<a href="#l26.194"></a><span id="l26.194" class="difflineplus">+/**</span>
<a href="#l26.195"></a><span id="l26.195" class="difflineplus">+ * Increment the reference count of json_object, thereby grabbing shared</span>
<a href="#l26.196"></a><span id="l26.196" class="difflineplus">+ * ownership of obj.</span>
<a href="#l26.197"></a><span id="l26.197" class="difflineplus">+ *</span>
<a href="#l26.198"></a><span id="l26.198" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.199"></a><span id="l26.199" class="difflineplus">+ */</span>
<a href="#l26.200"></a><span id="l26.200" class="difflineplus">+JSON_EXPORT struct json_object* json_object_get(struct json_object *obj);</span>
<a href="#l26.201"></a><span id="l26.201" class="difflineplus">+</span>
<a href="#l26.202"></a><span id="l26.202" class="difflineplus">+/**</span>
<a href="#l26.203"></a><span id="l26.203" class="difflineplus">+ * Decrement the reference count of json_object and free if it reaches zero.</span>
<a href="#l26.204"></a><span id="l26.204" class="difflineplus">+ * You must have ownership of obj prior to doing this or you will cause an</span>
<a href="#l26.205"></a><span id="l26.205" class="difflineplus">+ * imbalance in the reference count.</span>
<a href="#l26.206"></a><span id="l26.206" class="difflineplus">+ *</span>
<a href="#l26.207"></a><span id="l26.207" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.208"></a><span id="l26.208" class="difflineplus">+ * @returns 1 if the object was freed.</span>
<a href="#l26.209"></a><span id="l26.209" class="difflineplus">+ */</span>
<a href="#l26.210"></a><span id="l26.210" class="difflineplus">+JSON_EXPORT int json_object_put(struct json_object *obj);</span>
<a href="#l26.211"></a><span id="l26.211" class="difflineplus">+</span>
<a href="#l26.212"></a><span id="l26.212" class="difflineplus">+/**</span>
<a href="#l26.213"></a><span id="l26.213" class="difflineplus">+ * Check if the json_object is of a given type</span>
<a href="#l26.214"></a><span id="l26.214" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.215"></a><span id="l26.215" class="difflineplus">+ * @param type one of:</span>
<a href="#l26.216"></a><span id="l26.216" class="difflineplus">+     json_type_null (i.e. obj == NULL),</span>
<a href="#l26.217"></a><span id="l26.217" class="difflineplus">+     json_type_boolean,</span>
<a href="#l26.218"></a><span id="l26.218" class="difflineplus">+     json_type_double,</span>
<a href="#l26.219"></a><span id="l26.219" class="difflineplus">+     json_type_int,</span>
<a href="#l26.220"></a><span id="l26.220" class="difflineplus">+     json_type_object,</span>
<a href="#l26.221"></a><span id="l26.221" class="difflineplus">+     json_type_array,</span>
<a href="#l26.222"></a><span id="l26.222" class="difflineplus">+     json_type_string</span>
<a href="#l26.223"></a><span id="l26.223" class="difflineplus">+ */</span>
<a href="#l26.224"></a><span id="l26.224" class="difflineplus">+JSON_EXPORT int json_object_is_type(const struct json_object *obj, enum json_type type);</span>
<a href="#l26.225"></a><span id="l26.225" class="difflineplus">+</span>
<a href="#l26.226"></a><span id="l26.226" class="difflineplus">+/**</span>
<a href="#l26.227"></a><span id="l26.227" class="difflineplus">+ * Get the type of the json_object.  See also json_type_to_name() to turn this</span>
<a href="#l26.228"></a><span id="l26.228" class="difflineplus">+ * into a string suitable, for instance, for logging.</span>
<a href="#l26.229"></a><span id="l26.229" class="difflineplus">+ *</span>
<a href="#l26.230"></a><span id="l26.230" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.231"></a><span id="l26.231" class="difflineplus">+ * @returns type being one of:</span>
<a href="#l26.232"></a><span id="l26.232" class="difflineplus">+     json_type_null (i.e. obj == NULL),</span>
<a href="#l26.233"></a><span id="l26.233" class="difflineplus">+     json_type_boolean,</span>
<a href="#l26.234"></a><span id="l26.234" class="difflineplus">+     json_type_double,</span>
<a href="#l26.235"></a><span id="l26.235" class="difflineplus">+     json_type_int,</span>
<a href="#l26.236"></a><span id="l26.236" class="difflineplus">+     json_type_object,</span>
<a href="#l26.237"></a><span id="l26.237" class="difflineplus">+     json_type_array,</span>
<a href="#l26.238"></a><span id="l26.238" class="difflineplus">+     json_type_string</span>
<a href="#l26.239"></a><span id="l26.239" class="difflineplus">+ */</span>
<a href="#l26.240"></a><span id="l26.240" class="difflineplus">+JSON_EXPORT enum json_type json_object_get_type(const struct json_object *obj);</span>
<a href="#l26.241"></a><span id="l26.241" class="difflineplus">+</span>
<a href="#l26.242"></a><span id="l26.242" class="difflineplus">+</span>
<a href="#l26.243"></a><span id="l26.243" class="difflineplus">+/** Stringify object to json format.</span>
<a href="#l26.244"></a><span id="l26.244" class="difflineplus">+ * Equivalent to json_object_to_json_string_ext(obj, JSON_C_TO_STRING_SPACED)</span>
<a href="#l26.245"></a><span id="l26.245" class="difflineplus">+ * The pointer you get is an internal of your json object. You don't</span>
<a href="#l26.246"></a><span id="l26.246" class="difflineplus">+ * have to free it, later use of json_object_put() should be sufficient.</span>
<a href="#l26.247"></a><span id="l26.247" class="difflineplus">+ * If you can not ensure there's no concurrent access to *obj use</span>
<a href="#l26.248"></a><span id="l26.248" class="difflineplus">+ * strdup().</span>
<a href="#l26.249"></a><span id="l26.249" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.250"></a><span id="l26.250" class="difflineplus">+ * @returns a string in JSON format</span>
<a href="#l26.251"></a><span id="l26.251" class="difflineplus">+ */</span>
<a href="#l26.252"></a><span id="l26.252" class="difflineplus">+JSON_EXPORT const char* json_object_to_json_string(struct json_object *obj);</span>
<a href="#l26.253"></a><span id="l26.253" class="difflineplus">+</span>
<a href="#l26.254"></a><span id="l26.254" class="difflineplus">+/** Stringify object to json format</span>
<a href="#l26.255"></a><span id="l26.255" class="difflineplus">+ * @see json_object_to_json_string() for details on how to free string.</span>
<a href="#l26.256"></a><span id="l26.256" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.257"></a><span id="l26.257" class="difflineplus">+ * @param flags formatting options, see JSON_C_TO_STRING_PRETTY and other constants</span>
<a href="#l26.258"></a><span id="l26.258" class="difflineplus">+ * @returns a string in JSON format</span>
<a href="#l26.259"></a><span id="l26.259" class="difflineplus">+ */</span>
<a href="#l26.260"></a><span id="l26.260" class="difflineplus">+JSON_EXPORT const char* json_object_to_json_string_ext(struct json_object *obj, int</span>
<a href="#l26.261"></a><span id="l26.261" class="difflineplus">+flags);</span>
<a href="#l26.262"></a><span id="l26.262" class="difflineplus">+</span>
<a href="#l26.263"></a><span id="l26.263" class="difflineplus">+/** Stringify object to json format</span>
<a href="#l26.264"></a><span id="l26.264" class="difflineplus">+ * @see json_object_to_json_string() for details on how to free string.</span>
<a href="#l26.265"></a><span id="l26.265" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.266"></a><span id="l26.266" class="difflineplus">+ * @param flags formatting options, see JSON_C_TO_STRING_PRETTY and other constants</span>
<a href="#l26.267"></a><span id="l26.267" class="difflineplus">+ * @param length a pointer where, if not NULL, the length (without null) is stored</span>
<a href="#l26.268"></a><span id="l26.268" class="difflineplus">+ * @returns a string in JSON format and the length if not NULL</span>
<a href="#l26.269"></a><span id="l26.269" class="difflineplus">+ */</span>
<a href="#l26.270"></a><span id="l26.270" class="difflineplus">+JSON_EXPORT const char* json_object_to_json_string_length(struct json_object *obj, int</span>
<a href="#l26.271"></a><span id="l26.271" class="difflineplus">+flags, size_t *length);</span>
<a href="#l26.272"></a><span id="l26.272" class="difflineplus">+</span>
<a href="#l26.273"></a><span id="l26.273" class="difflineplus">+/**</span>
<a href="#l26.274"></a><span id="l26.274" class="difflineplus">+ * Returns the userdata set by json_object_set_userdata() or</span>
<a href="#l26.275"></a><span id="l26.275" class="difflineplus">+ * json_object_set_serializer()</span>
<a href="#l26.276"></a><span id="l26.276" class="difflineplus">+ *</span>
<a href="#l26.277"></a><span id="l26.277" class="difflineplus">+ * @param jso the object to return the userdata for</span>
<a href="#l26.278"></a><span id="l26.278" class="difflineplus">+ */</span>
<a href="#l26.279"></a><span id="l26.279" class="difflineplus">+JSON_EXPORT void* json_object_get_userdata(json_object *jso);</span>
<a href="#l26.280"></a><span id="l26.280" class="difflineplus">+</span>
<a href="#l26.281"></a><span id="l26.281" class="difflineplus">+/**</span>
<a href="#l26.282"></a><span id="l26.282" class="difflineplus">+ * Set an opaque userdata value for an object</span>
<a href="#l26.283"></a><span id="l26.283" class="difflineplus">+ *</span>
<a href="#l26.284"></a><span id="l26.284" class="difflineplus">+ * The userdata can be retrieved using json_object_get_userdata().</span>
<a href="#l26.285"></a><span id="l26.285" class="difflineplus">+ *</span>
<a href="#l26.286"></a><span id="l26.286" class="difflineplus">+ * If custom userdata is already set on this object, any existing user_delete</span>
<a href="#l26.287"></a><span id="l26.287" class="difflineplus">+ * function is called before the new one is set.</span>
<a href="#l26.288"></a><span id="l26.288" class="difflineplus">+ *</span>
<a href="#l26.289"></a><span id="l26.289" class="difflineplus">+ * The user_delete parameter is optional and may be passed as NULL, even if</span>
<a href="#l26.290"></a><span id="l26.290" class="difflineplus">+ * the userdata parameter is non-NULL.  It will be called just before the</span>
<a href="#l26.291"></a><span id="l26.291" class="difflineplus">+ * json_object is deleted, after it's reference count goes to zero</span>
<a href="#l26.292"></a><span id="l26.292" class="difflineplus">+ * (see json_object_put()).</span>
<a href="#l26.293"></a><span id="l26.293" class="difflineplus">+ * If this is not provided, it is up to the caller to free the userdata at</span>
<a href="#l26.294"></a><span id="l26.294" class="difflineplus">+ * an appropriate time. (i.e. after the json_object is deleted)</span>
<a href="#l26.295"></a><span id="l26.295" class="difflineplus">+ *</span>
<a href="#l26.296"></a><span id="l26.296" class="difflineplus">+ * Note: Objects created by parsing strings may have custom serializers set</span>
<a href="#l26.297"></a><span id="l26.297" class="difflineplus">+ * which expect the userdata to contain specific data (due to use of</span>
<a href="#l26.298"></a><span id="l26.298" class="difflineplus">+ * json_object_new_double_s()). In this case, json_object_set_serialiser() with</span>
<a href="#l26.299"></a><span id="l26.299" class="difflineplus">+ * NULL as to_string_func should be used instead to set the userdata and reset</span>
<a href="#l26.300"></a><span id="l26.300" class="difflineplus">+ * the serializer to its default value.</span>
<a href="#l26.301"></a><span id="l26.301" class="difflineplus">+ *</span>
<a href="#l26.302"></a><span id="l26.302" class="difflineplus">+ * @param jso the object to set the userdata for</span>
<a href="#l26.303"></a><span id="l26.303" class="difflineplus">+ * @param userdata an optional opaque cookie</span>
<a href="#l26.304"></a><span id="l26.304" class="difflineplus">+ * @param user_delete an optional function from freeing userdata</span>
<a href="#l26.305"></a><span id="l26.305" class="difflineplus">+ */</span>
<a href="#l26.306"></a><span id="l26.306" class="difflineplus">+JSON_EXPORT void json_object_set_userdata(json_object *jso, void *userdata,</span>
<a href="#l26.307"></a><span id="l26.307" class="difflineplus">+				     json_object_delete_fn *user_delete);</span>
<a href="#l26.308"></a><span id="l26.308" class="difflineplus">+</span>
<a href="#l26.309"></a><span id="l26.309" class="difflineplus">+/**</span>
<a href="#l26.310"></a><span id="l26.310" class="difflineplus">+ * Set a custom serialization function to be used when this particular object</span>
<a href="#l26.311"></a><span id="l26.311" class="difflineplus">+ * is converted to a string by json_object_to_json_string.</span>
<a href="#l26.312"></a><span id="l26.312" class="difflineplus">+ *</span>
<a href="#l26.313"></a><span id="l26.313" class="difflineplus">+ * If custom userdata is already set on this object, any existing user_delete</span>
<a href="#l26.314"></a><span id="l26.314" class="difflineplus">+ * function is called before the new one is set.</span>
<a href="#l26.315"></a><span id="l26.315" class="difflineplus">+ *</span>
<a href="#l26.316"></a><span id="l26.316" class="difflineplus">+ * If to_string_func is NULL the default behaviour is reset (but the userdata</span>
<a href="#l26.317"></a><span id="l26.317" class="difflineplus">+ * and user_delete fields are still set).</span>
<a href="#l26.318"></a><span id="l26.318" class="difflineplus">+ *</span>
<a href="#l26.319"></a><span id="l26.319" class="difflineplus">+ * The userdata parameter is optional and may be passed as NULL. It can be used</span>
<a href="#l26.320"></a><span id="l26.320" class="difflineplus">+ * to provide additional data for to_string_func to use. This parameter may</span>
<a href="#l26.321"></a><span id="l26.321" class="difflineplus">+ * be NULL even if user_delete is non-NULL.</span>
<a href="#l26.322"></a><span id="l26.322" class="difflineplus">+ *</span>
<a href="#l26.323"></a><span id="l26.323" class="difflineplus">+ * The user_delete parameter is optional and may be passed as NULL, even if</span>
<a href="#l26.324"></a><span id="l26.324" class="difflineplus">+ * the userdata parameter is non-NULL.  It will be called just before the</span>
<a href="#l26.325"></a><span id="l26.325" class="difflineplus">+ * json_object is deleted, after it's reference count goes to zero</span>
<a href="#l26.326"></a><span id="l26.326" class="difflineplus">+ * (see json_object_put()).</span>
<a href="#l26.327"></a><span id="l26.327" class="difflineplus">+ * If this is not provided, it is up to the caller to free the userdata at</span>
<a href="#l26.328"></a><span id="l26.328" class="difflineplus">+ * an appropriate time. (i.e. after the json_object is deleted)</span>
<a href="#l26.329"></a><span id="l26.329" class="difflineplus">+ *</span>
<a href="#l26.330"></a><span id="l26.330" class="difflineplus">+ * Note that the userdata is the same as set by json_object_set_userdata(), so</span>
<a href="#l26.331"></a><span id="l26.331" class="difflineplus">+ * care must be taken not to overwrite the value when both a custom serializer</span>
<a href="#l26.332"></a><span id="l26.332" class="difflineplus">+ * and json_object_set_userdata() are used.</span>
<a href="#l26.333"></a><span id="l26.333" class="difflineplus">+ *</span>
<a href="#l26.334"></a><span id="l26.334" class="difflineplus">+ * @param jso the object to customize</span>
<a href="#l26.335"></a><span id="l26.335" class="difflineplus">+ * @param to_string_func the custom serialization function</span>
<a href="#l26.336"></a><span id="l26.336" class="difflineplus">+ * @param userdata an optional opaque cookie</span>
<a href="#l26.337"></a><span id="l26.337" class="difflineplus">+ * @param user_delete an optional function from freeing userdata</span>
<a href="#l26.338"></a><span id="l26.338" class="difflineplus">+ */</span>
<a href="#l26.339"></a><span id="l26.339" class="difflineplus">+JSON_EXPORT void json_object_set_serializer(json_object *jso,</span>
<a href="#l26.340"></a><span id="l26.340" class="difflineplus">+	json_object_to_json_string_fn *to_string_func,</span>
<a href="#l26.341"></a><span id="l26.341" class="difflineplus">+	void *userdata,</span>
<a href="#l26.342"></a><span id="l26.342" class="difflineplus">+	json_object_delete_fn *user_delete);</span>
<a href="#l26.343"></a><span id="l26.343" class="difflineplus">+</span>
<a href="#l26.344"></a><span id="l26.344" class="difflineplus">+#ifdef __clang__</span>
<a href="#l26.345"></a><span id="l26.345" class="difflineplus">+/*</span>
<a href="#l26.346"></a><span id="l26.346" class="difflineplus">+ * Clang doesn't pay attention to the parameters defined in the</span>
<a href="#l26.347"></a><span id="l26.347" class="difflineplus">+ * function typedefs used here, so turn off spurious doc warnings.</span>
<a href="#l26.348"></a><span id="l26.348" class="difflineplus">+ * {</span>
<a href="#l26.349"></a><span id="l26.349" class="difflineplus">+ */</span>
<a href="#l26.350"></a><span id="l26.350" class="difflineplus">+#pragma clang diagnostic push</span>
<a href="#l26.351"></a><span id="l26.351" class="difflineplus">+#pragma clang diagnostic ignored &quot;-Wdocumentation&quot;</span>
<a href="#l26.352"></a><span id="l26.352" class="difflineplus">+#endif</span>
<a href="#l26.353"></a><span id="l26.353" class="difflineplus">+</span>
<a href="#l26.354"></a><span id="l26.354" class="difflineplus">+/**</span>
<a href="#l26.355"></a><span id="l26.355" class="difflineplus">+ * Simply call free on the userdata pointer.</span>
<a href="#l26.356"></a><span id="l26.356" class="difflineplus">+ * Can be used with json_object_set_serializer().</span>
<a href="#l26.357"></a><span id="l26.357" class="difflineplus">+ *</span>
<a href="#l26.358"></a><span id="l26.358" class="difflineplus">+ * @param jso unused</span>
<a href="#l26.359"></a><span id="l26.359" class="difflineplus">+ * @param userdata the pointer that is passed to free().</span>
<a href="#l26.360"></a><span id="l26.360" class="difflineplus">+ */</span>
<a href="#l26.361"></a><span id="l26.361" class="difflineplus">+json_object_delete_fn json_object_free_userdata;</span>
<a href="#l26.362"></a><span id="l26.362" class="difflineplus">+</span>
<a href="#l26.363"></a><span id="l26.363" class="difflineplus">+/**</span>
<a href="#l26.364"></a><span id="l26.364" class="difflineplus">+ * Copy the jso-&gt;_userdata string over to pb as-is.</span>
<a href="#l26.365"></a><span id="l26.365" class="difflineplus">+ * Can be used with json_object_set_serializer().</span>
<a href="#l26.366"></a><span id="l26.366" class="difflineplus">+ *</span>
<a href="#l26.367"></a><span id="l26.367" class="difflineplus">+ * @param jso The object whose _userdata is used.</span>
<a href="#l26.368"></a><span id="l26.368" class="difflineplus">+ * @param pb The destination buffer.</span>
<a href="#l26.369"></a><span id="l26.369" class="difflineplus">+ * @param level Ignored.</span>
<a href="#l26.370"></a><span id="l26.370" class="difflineplus">+ * @param flags Ignored.</span>
<a href="#l26.371"></a><span id="l26.371" class="difflineplus">+ */</span>
<a href="#l26.372"></a><span id="l26.372" class="difflineplus">+json_object_to_json_string_fn json_object_userdata_to_json_string;</span>
<a href="#l26.373"></a><span id="l26.373" class="difflineplus">+</span>
<a href="#l26.374"></a><span id="l26.374" class="difflineplus">+#ifdef __clang__</span>
<a href="#l26.375"></a><span id="l26.375" class="difflineplus">+/* } */</span>
<a href="#l26.376"></a><span id="l26.376" class="difflineplus">+#pragma clang diagnostic pop</span>
<a href="#l26.377"></a><span id="l26.377" class="difflineplus">+#endif</span>
<a href="#l26.378"></a><span id="l26.378" class="difflineplus">+</span>
<a href="#l26.379"></a><span id="l26.379" class="difflineplus">+</span>
<a href="#l26.380"></a><span id="l26.380" class="difflineplus">+/* object type methods */</span>
<a href="#l26.381"></a><span id="l26.381" class="difflineplus">+</span>
<a href="#l26.382"></a><span id="l26.382" class="difflineplus">+/** Create a new empty object with a reference count of 1.  The caller of</span>
<a href="#l26.383"></a><span id="l26.383" class="difflineplus">+ * this object initially has sole ownership.  Remember, when using</span>
<a href="#l26.384"></a><span id="l26.384" class="difflineplus">+ * json_object_object_add or json_object_array_put_idx, ownership will</span>
<a href="#l26.385"></a><span id="l26.385" class="difflineplus">+ * transfer to the object/array.  Call json_object_get if you want to maintain</span>
<a href="#l26.386"></a><span id="l26.386" class="difflineplus">+ * shared ownership or also add this object as a child of multiple objects or</span>
<a href="#l26.387"></a><span id="l26.387" class="difflineplus">+ * arrays.  Any ownerships you acquired but did not transfer must be released</span>
<a href="#l26.388"></a><span id="l26.388" class="difflineplus">+ * through json_object_put.</span>
<a href="#l26.389"></a><span id="l26.389" class="difflineplus">+ *</span>
<a href="#l26.390"></a><span id="l26.390" class="difflineplus">+ * @returns a json_object of type json_type_object</span>
<a href="#l26.391"></a><span id="l26.391" class="difflineplus">+ */</span>
<a href="#l26.392"></a><span id="l26.392" class="difflineplus">+JSON_EXPORT struct json_object* json_object_new_object(void);</span>
<a href="#l26.393"></a><span id="l26.393" class="difflineplus">+</span>
<a href="#l26.394"></a><span id="l26.394" class="difflineplus">+/** Get the hashtable of a json_object of type json_type_object</span>
<a href="#l26.395"></a><span id="l26.395" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.396"></a><span id="l26.396" class="difflineplus">+ * @returns a linkhash</span>
<a href="#l26.397"></a><span id="l26.397" class="difflineplus">+ */</span>
<a href="#l26.398"></a><span id="l26.398" class="difflineplus">+JSON_EXPORT struct lh_table* json_object_get_object(const struct json_object *obj);</span>
<a href="#l26.399"></a><span id="l26.399" class="difflineplus">+</span>
<a href="#l26.400"></a><span id="l26.400" class="difflineplus">+/** Get the size of an object in terms of the number of fields it has.</span>
<a href="#l26.401"></a><span id="l26.401" class="difflineplus">+ * @param obj the json_object whose length to return</span>
<a href="#l26.402"></a><span id="l26.402" class="difflineplus">+ */</span>
<a href="#l26.403"></a><span id="l26.403" class="difflineplus">+JSON_EXPORT int json_object_object_length(const struct json_object* obj);</span>
<a href="#l26.404"></a><span id="l26.404" class="difflineplus">+</span>
<a href="#l26.405"></a><span id="l26.405" class="difflineplus">+/** Get the sizeof (struct json_object).</span>
<a href="#l26.406"></a><span id="l26.406" class="difflineplus">+ * @returns a size_t with the sizeof (struct json_object)</span>
<a href="#l26.407"></a><span id="l26.407" class="difflineplus">+ */</span>
<a href="#l26.408"></a><span id="l26.408" class="difflineplus">+JSON_C_CONST_FUNCTION(JSON_EXPORT size_t json_c_object_sizeof(void));</span>
<a href="#l26.409"></a><span id="l26.409" class="difflineplus">+</span>
<a href="#l26.410"></a><span id="l26.410" class="difflineplus">+/** Add an object field to a json_object of type json_type_object</span>
<a href="#l26.411"></a><span id="l26.411" class="difflineplus">+ *</span>
<a href="#l26.412"></a><span id="l26.412" class="difflineplus">+ * The reference count will *not* be incremented. This is to make adding</span>
<a href="#l26.413"></a><span id="l26.413" class="difflineplus">+ * fields to objects in code more compact. If you want to retain a reference</span>
<a href="#l26.414"></a><span id="l26.414" class="difflineplus">+ * to an added object, independent of the lifetime of obj, you must wrap the</span>
<a href="#l26.415"></a><span id="l26.415" class="difflineplus">+ * passed object with json_object_get.</span>
<a href="#l26.416"></a><span id="l26.416" class="difflineplus">+ *</span>
<a href="#l26.417"></a><span id="l26.417" class="difflineplus">+ * Upon calling this, the ownership of val transfers to obj.  Thus you must</span>
<a href="#l26.418"></a><span id="l26.418" class="difflineplus">+ * make sure that you do in fact have ownership over this object.  For instance,</span>
<a href="#l26.419"></a><span id="l26.419" class="difflineplus">+ * json_object_new_object will give you ownership until you transfer it,</span>
<a href="#l26.420"></a><span id="l26.420" class="difflineplus">+ * whereas json_object_object_get does not.</span>
<a href="#l26.421"></a><span id="l26.421" class="difflineplus">+ *</span>
<a href="#l26.422"></a><span id="l26.422" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.423"></a><span id="l26.423" class="difflineplus">+ * @param key the object field name (a private copy will be duplicated)</span>
<a href="#l26.424"></a><span id="l26.424" class="difflineplus">+ * @param val a json_object or NULL member to associate with the given field</span>
<a href="#l26.425"></a><span id="l26.425" class="difflineplus">+ *</span>
<a href="#l26.426"></a><span id="l26.426" class="difflineplus">+ * @return On success, &lt;code&gt;0&lt;/code&gt; is returned.</span>
<a href="#l26.427"></a><span id="l26.427" class="difflineplus">+ * 	On error, a negative value is returned.</span>
<a href="#l26.428"></a><span id="l26.428" class="difflineplus">+ */</span>
<a href="#l26.429"></a><span id="l26.429" class="difflineplus">+JSON_EXPORT int json_object_object_add(struct json_object* obj, const char *key,</span>
<a href="#l26.430"></a><span id="l26.430" class="difflineplus">+				   struct json_object *val);</span>
<a href="#l26.431"></a><span id="l26.431" class="difflineplus">+</span>
<a href="#l26.432"></a><span id="l26.432" class="difflineplus">+/** Add an object field to a json_object of type json_type_object</span>
<a href="#l26.433"></a><span id="l26.433" class="difflineplus">+ *</span>
<a href="#l26.434"></a><span id="l26.434" class="difflineplus">+ * The semantics are identical to json_object_object_add, except that an</span>
<a href="#l26.435"></a><span id="l26.435" class="difflineplus">+ * additional flag fields gives you more control over some detail aspects</span>
<a href="#l26.436"></a><span id="l26.436" class="difflineplus">+ * of processing. See the description of JSON_C_OBJECT_ADD_* flags for more</span>
<a href="#l26.437"></a><span id="l26.437" class="difflineplus">+ * details.</span>
<a href="#l26.438"></a><span id="l26.438" class="difflineplus">+ *</span>
<a href="#l26.439"></a><span id="l26.439" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.440"></a><span id="l26.440" class="difflineplus">+ * @param key the object field name (a private copy will be duplicated)</span>
<a href="#l26.441"></a><span id="l26.441" class="difflineplus">+ * @param val a json_object or NULL member to associate with the given field</span>
<a href="#l26.442"></a><span id="l26.442" class="difflineplus">+ * @param opts process-modifying options. To specify multiple options, use </span>
<a href="#l26.443"></a><span id="l26.443" class="difflineplus">+ *             arithmetic or (OPT1|OPT2)</span>
<a href="#l26.444"></a><span id="l26.444" class="difflineplus">+ */</span>
<a href="#l26.445"></a><span id="l26.445" class="difflineplus">+JSON_EXPORT int json_object_object_add_ex(struct json_object* obj,</span>
<a href="#l26.446"></a><span id="l26.446" class="difflineplus">+				const char *const key,</span>
<a href="#l26.447"></a><span id="l26.447" class="difflineplus">+				struct json_object *const val,</span>
<a href="#l26.448"></a><span id="l26.448" class="difflineplus">+				const unsigned opts);</span>
<a href="#l26.449"></a><span id="l26.449" class="difflineplus">+</span>
<a href="#l26.450"></a><span id="l26.450" class="difflineplus">+/** Get the json_object associate with a given object field.</span>
<a href="#l26.451"></a><span id="l26.451" class="difflineplus">+ * Deprecated/discouraged: used json_object_object_get_ex instead.</span>
<a href="#l26.452"></a><span id="l26.452" class="difflineplus">+ *</span>
<a href="#l26.453"></a><span id="l26.453" class="difflineplus">+ * This returns NULL if the field is found but its value is null, or if</span>
<a href="#l26.454"></a><span id="l26.454" class="difflineplus">+ *  the field is not found, or if obj is not a json_type_object.  If you</span>
<a href="#l26.455"></a><span id="l26.455" class="difflineplus">+ *  need to distinguis between these cases, use json_object_object_get_ex().</span>
<a href="#l26.456"></a><span id="l26.456" class="difflineplus">+ *</span>
<a href="#l26.457"></a><span id="l26.457" class="difflineplus">+ * *No* reference counts will be changed.  There is no need to manually adjust</span>
<a href="#l26.458"></a><span id="l26.458" class="difflineplus">+ * reference counts through the json_object_put/json_object_get methods unless</span>
<a href="#l26.459"></a><span id="l26.459" class="difflineplus">+ * you need to have the child (value) reference maintain a different lifetime</span>
<a href="#l26.460"></a><span id="l26.460" class="difflineplus">+ * than the owning parent (obj). Ownership of the returned value is retained</span>
<a href="#l26.461"></a><span id="l26.461" class="difflineplus">+ * by obj (do not do json_object_put unless you have done a json_object_get).</span>
<a href="#l26.462"></a><span id="l26.462" class="difflineplus">+ * If you delete the value from obj (json_object_object_del) and wish to access</span>
<a href="#l26.463"></a><span id="l26.463" class="difflineplus">+ * the returned reference afterwards, make sure you have first gotten shared</span>
<a href="#l26.464"></a><span id="l26.464" class="difflineplus">+ * ownership through json_object_get (&amp; don't forget to do a json_object_put</span>
<a href="#l26.465"></a><span id="l26.465" class="difflineplus">+ * or transfer ownership to prevent a memory leak).</span>
<a href="#l26.466"></a><span id="l26.466" class="difflineplus">+ *</span>
<a href="#l26.467"></a><span id="l26.467" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.468"></a><span id="l26.468" class="difflineplus">+ * @param key the object field name</span>
<a href="#l26.469"></a><span id="l26.469" class="difflineplus">+ * @returns the json_object associated with the given field name</span>
<a href="#l26.470"></a><span id="l26.470" class="difflineplus">+ */</span>
<a href="#l26.471"></a><span id="l26.471" class="difflineplus">+JSON_EXPORT struct json_object* json_object_object_get(const struct json_object* obj,</span>
<a href="#l26.472"></a><span id="l26.472" class="difflineplus">+						  const char *key);</span>
<a href="#l26.473"></a><span id="l26.473" class="difflineplus">+</span>
<a href="#l26.474"></a><span id="l26.474" class="difflineplus">+/** Get the json_object associated with a given object field.</span>
<a href="#l26.475"></a><span id="l26.475" class="difflineplus">+ *</span>
<a href="#l26.476"></a><span id="l26.476" class="difflineplus">+ * This returns true if the key is found, false in all other cases (including</span>
<a href="#l26.477"></a><span id="l26.477" class="difflineplus">+ * if obj isn't a json_type_object).</span>
<a href="#l26.478"></a><span id="l26.478" class="difflineplus">+ *</span>
<a href="#l26.479"></a><span id="l26.479" class="difflineplus">+ * *No* reference counts will be changed.  There is no need to manually adjust</span>
<a href="#l26.480"></a><span id="l26.480" class="difflineplus">+ * reference counts through the json_object_put/json_object_get methods unless</span>
<a href="#l26.481"></a><span id="l26.481" class="difflineplus">+ * you need to have the child (value) reference maintain a different lifetime</span>
<a href="#l26.482"></a><span id="l26.482" class="difflineplus">+ * than the owning parent (obj).  Ownership of value is retained by obj.</span>
<a href="#l26.483"></a><span id="l26.483" class="difflineplus">+ *</span>
<a href="#l26.484"></a><span id="l26.484" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.485"></a><span id="l26.485" class="difflineplus">+ * @param key the object field name</span>
<a href="#l26.486"></a><span id="l26.486" class="difflineplus">+ * @param value a pointer where to store a reference to the json_object</span>
<a href="#l26.487"></a><span id="l26.487" class="difflineplus">+ *              associated with the given field name.</span>
<a href="#l26.488"></a><span id="l26.488" class="difflineplus">+ *</span>
<a href="#l26.489"></a><span id="l26.489" class="difflineplus">+ *              It is safe to pass a NULL value.</span>
<a href="#l26.490"></a><span id="l26.490" class="difflineplus">+ * @returns whether or not the key exists</span>
<a href="#l26.491"></a><span id="l26.491" class="difflineplus">+ */</span>
<a href="#l26.492"></a><span id="l26.492" class="difflineplus">+JSON_EXPORT json_bool json_object_object_get_ex(const struct json_object* obj,</span>
<a href="#l26.493"></a><span id="l26.493" class="difflineplus">+                                           const char *key,</span>
<a href="#l26.494"></a><span id="l26.494" class="difflineplus">+                                           struct json_object **value);</span>
<a href="#l26.495"></a><span id="l26.495" class="difflineplus">+</span>
<a href="#l26.496"></a><span id="l26.496" class="difflineplus">+/** Delete the given json_object field</span>
<a href="#l26.497"></a><span id="l26.497" class="difflineplus">+ *</span>
<a href="#l26.498"></a><span id="l26.498" class="difflineplus">+ * The reference count will be decremented for the deleted object.  If there</span>
<a href="#l26.499"></a><span id="l26.499" class="difflineplus">+ * are no more owners of the value represented by this key, then the value is</span>
<a href="#l26.500"></a><span id="l26.500" class="difflineplus">+ * freed.  Otherwise, the reference to the value will remain in memory.</span>
<a href="#l26.501"></a><span id="l26.501" class="difflineplus">+ *</span>
<a href="#l26.502"></a><span id="l26.502" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.503"></a><span id="l26.503" class="difflineplus">+ * @param key the object field name</span>
<a href="#l26.504"></a><span id="l26.504" class="difflineplus">+ */</span>
<a href="#l26.505"></a><span id="l26.505" class="difflineplus">+JSON_EXPORT void json_object_object_del(struct json_object* obj, const char *key);</span>
<a href="#l26.506"></a><span id="l26.506" class="difflineplus">+</span>
<a href="#l26.507"></a><span id="l26.507" class="difflineplus">+/**</span>
<a href="#l26.508"></a><span id="l26.508" class="difflineplus">+ * Iterate through all keys and values of an object.</span>
<a href="#l26.509"></a><span id="l26.509" class="difflineplus">+ *</span>
<a href="#l26.510"></a><span id="l26.510" class="difflineplus">+ * Adding keys to the object while iterating is NOT allowed.</span>
<a href="#l26.511"></a><span id="l26.511" class="difflineplus">+ *</span>
<a href="#l26.512"></a><span id="l26.512" class="difflineplus">+ * Deleting an existing key, or replacing an existing key with a</span>
<a href="#l26.513"></a><span id="l26.513" class="difflineplus">+ * new value IS allowed.</span>
<a href="#l26.514"></a><span id="l26.514" class="difflineplus">+ *</span>
<a href="#l26.515"></a><span id="l26.515" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.516"></a><span id="l26.516" class="difflineplus">+ * @param key the local name for the char* key variable defined in the body</span>
<a href="#l26.517"></a><span id="l26.517" class="difflineplus">+ * @param val the local name for the json_object* object variable defined in</span>
<a href="#l26.518"></a><span id="l26.518" class="difflineplus">+ *            the body</span>
<a href="#l26.519"></a><span id="l26.519" class="difflineplus">+ */</span>
<a href="#l26.520"></a><span id="l26.520" class="difflineplus">+#if defined(__GNUC__) &amp;&amp; !defined(__STRICT_ANSI__) &amp;&amp; __STDC_VERSION__ &gt;= 199901L</span>
<a href="#l26.521"></a><span id="l26.521" class="difflineplus">+</span>
<a href="#l26.522"></a><span id="l26.522" class="difflineplus">+# define json_object_object_foreach(obj,key,val) \</span>
<a href="#l26.523"></a><span id="l26.523" class="difflineplus">+	char *key = NULL; \</span>
<a href="#l26.524"></a><span id="l26.524" class="difflineplus">+	struct json_object *val __attribute__((__unused__)) = NULL; \</span>
<a href="#l26.525"></a><span id="l26.525" class="difflineplus">+	for(struct lh_entry *entry ## key = json_object_get_object(obj)-&gt;head, *entry_next ## key = NULL; \</span>
<a href="#l26.526"></a><span id="l26.526" class="difflineplus">+		({ if(entry ## key) { \</span>
<a href="#l26.527"></a><span id="l26.527" class="difflineplus">+			key = (char*)lh_entry_k(entry ## key); \</span>
<a href="#l26.528"></a><span id="l26.528" class="difflineplus">+			val = (struct json_object*)lh_entry_v(entry ## key); \</span>
<a href="#l26.529"></a><span id="l26.529" class="difflineplus">+			entry_next ## key = entry ## key-&gt;next; \</span>
<a href="#l26.530"></a><span id="l26.530" class="difflineplus">+		} ; entry ## key; }); \</span>
<a href="#l26.531"></a><span id="l26.531" class="difflineplus">+		entry ## key = entry_next ## key )</span>
<a href="#l26.532"></a><span id="l26.532" class="difflineplus">+</span>
<a href="#l26.533"></a><span id="l26.533" class="difflineplus">+#else /* ANSI C or MSC */</span>
<a href="#l26.534"></a><span id="l26.534" class="difflineplus">+</span>
<a href="#l26.535"></a><span id="l26.535" class="difflineplus">+# define json_object_object_foreach(obj,key,val) \</span>
<a href="#l26.536"></a><span id="l26.536" class="difflineplus">+	char *key = NULL;\</span>
<a href="#l26.537"></a><span id="l26.537" class="difflineplus">+	struct json_object *val = NULL; \</span>
<a href="#l26.538"></a><span id="l26.538" class="difflineplus">+	struct lh_entry *entry ## key; \</span>
<a href="#l26.539"></a><span id="l26.539" class="difflineplus">+	struct lh_entry *entry_next ## key = NULL; \</span>
<a href="#l26.540"></a><span id="l26.540" class="difflineplus">+	for(entry ## key = json_object_get_object(obj)-&gt;head; \</span>
<a href="#l26.541"></a><span id="l26.541" class="difflineplus">+		(entry ## key ? ( \</span>
<a href="#l26.542"></a><span id="l26.542" class="difflineplus">+			key = (char*)lh_entry_k(entry ## key), \</span>
<a href="#l26.543"></a><span id="l26.543" class="difflineplus">+			val = (struct json_object*)lh_entry_v(entry ## key), \</span>
<a href="#l26.544"></a><span id="l26.544" class="difflineplus">+			entry_next ## key = entry ## key-&gt;next, \</span>
<a href="#l26.545"></a><span id="l26.545" class="difflineplus">+			entry ## key) : 0); \</span>
<a href="#l26.546"></a><span id="l26.546" class="difflineplus">+		entry ## key = entry_next ## key)</span>
<a href="#l26.547"></a><span id="l26.547" class="difflineplus">+</span>
<a href="#l26.548"></a><span id="l26.548" class="difflineplus">+#endif /* defined(__GNUC__) &amp;&amp; !defined(__STRICT_ANSI__) &amp;&amp; __STDC_VERSION__ &gt;= 199901L */</span>
<a href="#l26.549"></a><span id="l26.549" class="difflineplus">+</span>
<a href="#l26.550"></a><span id="l26.550" class="difflineplus">+/** Iterate through all keys and values of an object (ANSI C Safe)</span>
<a href="#l26.551"></a><span id="l26.551" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.552"></a><span id="l26.552" class="difflineplus">+ * @param iter the object iterator, use type json_object_iter</span>
<a href="#l26.553"></a><span id="l26.553" class="difflineplus">+ */</span>
<a href="#l26.554"></a><span id="l26.554" class="difflineplus">+#define json_object_object_foreachC(obj,iter) \</span>
<a href="#l26.555"></a><span id="l26.555" class="difflineplus">+ for(iter.entry = json_object_get_object(obj)-&gt;head; \</span>
<a href="#l26.556"></a><span id="l26.556" class="difflineplus">+     (iter.entry ? (iter.key = (char*)lh_entry_k(iter.entry), iter.val = (struct json_object*)lh_entry_v(iter.entry), iter.entry) : 0); \</span>
<a href="#l26.557"></a><span id="l26.557" class="difflineplus">+     iter.entry = iter.entry-&gt;next)</span>
<a href="#l26.558"></a><span id="l26.558" class="difflineplus">+</span>
<a href="#l26.559"></a><span id="l26.559" class="difflineplus">+/* Array type methods */</span>
<a href="#l26.560"></a><span id="l26.560" class="difflineplus">+</span>
<a href="#l26.561"></a><span id="l26.561" class="difflineplus">+/** Create a new empty json_object of type json_type_array</span>
<a href="#l26.562"></a><span id="l26.562" class="difflineplus">+ * @returns a json_object of type json_type_array</span>
<a href="#l26.563"></a><span id="l26.563" class="difflineplus">+ */</span>
<a href="#l26.564"></a><span id="l26.564" class="difflineplus">+JSON_EXPORT struct json_object* json_object_new_array(void);</span>
<a href="#l26.565"></a><span id="l26.565" class="difflineplus">+</span>
<a href="#l26.566"></a><span id="l26.566" class="difflineplus">+/** Get the arraylist of a json_object of type json_type_array</span>
<a href="#l26.567"></a><span id="l26.567" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.568"></a><span id="l26.568" class="difflineplus">+ * @returns an arraylist</span>
<a href="#l26.569"></a><span id="l26.569" class="difflineplus">+ */</span>
<a href="#l26.570"></a><span id="l26.570" class="difflineplus">+JSON_EXPORT struct array_list* json_object_get_array(const struct json_object *obj);</span>
<a href="#l26.571"></a><span id="l26.571" class="difflineplus">+</span>
<a href="#l26.572"></a><span id="l26.572" class="difflineplus">+/** Get the length of a json_object of type json_type_array</span>
<a href="#l26.573"></a><span id="l26.573" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.574"></a><span id="l26.574" class="difflineplus">+ * @returns an int</span>
<a href="#l26.575"></a><span id="l26.575" class="difflineplus">+ */</span>
<a href="#l26.576"></a><span id="l26.576" class="difflineplus">+JSON_EXPORT size_t json_object_array_length(const struct json_object *obj);</span>
<a href="#l26.577"></a><span id="l26.577" class="difflineplus">+</span>
<a href="#l26.578"></a><span id="l26.578" class="difflineplus">+/** Sorts the elements of jso of type json_type_array</span>
<a href="#l26.579"></a><span id="l26.579" class="difflineplus">+*</span>
<a href="#l26.580"></a><span id="l26.580" class="difflineplus">+* Pointers to the json_object pointers will be passed as the two arguments</span>
<a href="#l26.581"></a><span id="l26.581" class="difflineplus">+* to sort_fn</span>
<a href="#l26.582"></a><span id="l26.582" class="difflineplus">+*</span>
<a href="#l26.583"></a><span id="l26.583" class="difflineplus">+* @param jso the json_object instance</span>
<a href="#l26.584"></a><span id="l26.584" class="difflineplus">+* @param sort_fn a sorting function</span>
<a href="#l26.585"></a><span id="l26.585" class="difflineplus">+*/</span>
<a href="#l26.586"></a><span id="l26.586" class="difflineplus">+JSON_EXPORT void json_object_array_sort(struct json_object *jso, int(*sort_fn)(const void *, const void *));</span>
<a href="#l26.587"></a><span id="l26.587" class="difflineplus">+</span>
<a href="#l26.588"></a><span id="l26.588" class="difflineplus">+/** Binary search a sorted array for a specified key object.</span>
<a href="#l26.589"></a><span id="l26.589" class="difflineplus">+ *</span>
<a href="#l26.590"></a><span id="l26.590" class="difflineplus">+ * It depends on your compare function what's sufficient as a key.</span>
<a href="#l26.591"></a><span id="l26.591" class="difflineplus">+ * Usually you create some dummy object with the parameter compared in</span>
<a href="#l26.592"></a><span id="l26.592" class="difflineplus">+ * it, to identify the right item you're actually looking for.</span>
<a href="#l26.593"></a><span id="l26.593" class="difflineplus">+ *</span>
<a href="#l26.594"></a><span id="l26.594" class="difflineplus">+ * @see json_object_array_sort() for hints on the compare function.</span>
<a href="#l26.595"></a><span id="l26.595" class="difflineplus">+ *</span>
<a href="#l26.596"></a><span id="l26.596" class="difflineplus">+ * @param key a dummy json_object with the right key</span>
<a href="#l26.597"></a><span id="l26.597" class="difflineplus">+ * @param jso the array object we're searching</span>
<a href="#l26.598"></a><span id="l26.598" class="difflineplus">+ * @param sort_fn the sort/compare function</span>
<a href="#l26.599"></a><span id="l26.599" class="difflineplus">+ *</span>
<a href="#l26.600"></a><span id="l26.600" class="difflineplus">+ * @return the wanted json_object instance</span>
<a href="#l26.601"></a><span id="l26.601" class="difflineplus">+ */</span>
<a href="#l26.602"></a><span id="l26.602" class="difflineplus">+JSON_EXPORT struct json_object* json_object_array_bsearch(</span>
<a href="#l26.603"></a><span id="l26.603" class="difflineplus">+		const struct json_object *key,</span>
<a href="#l26.604"></a><span id="l26.604" class="difflineplus">+		const struct json_object *jso,</span>
<a href="#l26.605"></a><span id="l26.605" class="difflineplus">+		int (*sort_fn)(const void *, const void *));</span>
<a href="#l26.606"></a><span id="l26.606" class="difflineplus">+</span>
<a href="#l26.607"></a><span id="l26.607" class="difflineplus">+/** Add an element to the end of a json_object of type json_type_array</span>
<a href="#l26.608"></a><span id="l26.608" class="difflineplus">+ *</span>
<a href="#l26.609"></a><span id="l26.609" class="difflineplus">+ * The reference count will *not* be incremented. This is to make adding</span>
<a href="#l26.610"></a><span id="l26.610" class="difflineplus">+ * fields to objects in code more compact. If you want to retain a reference</span>
<a href="#l26.611"></a><span id="l26.611" class="difflineplus">+ * to an added object you must wrap the passed object with json_object_get</span>
<a href="#l26.612"></a><span id="l26.612" class="difflineplus">+ *</span>
<a href="#l26.613"></a><span id="l26.613" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.614"></a><span id="l26.614" class="difflineplus">+ * @param val the json_object to be added</span>
<a href="#l26.615"></a><span id="l26.615" class="difflineplus">+ */</span>
<a href="#l26.616"></a><span id="l26.616" class="difflineplus">+JSON_EXPORT int json_object_array_add(struct json_object *obj,</span>
<a href="#l26.617"></a><span id="l26.617" class="difflineplus">+				 struct json_object *val);</span>
<a href="#l26.618"></a><span id="l26.618" class="difflineplus">+</span>
<a href="#l26.619"></a><span id="l26.619" class="difflineplus">+/** Insert or replace an element at a specified index in an array (a json_object of type json_type_array)</span>
<a href="#l26.620"></a><span id="l26.620" class="difflineplus">+ *</span>
<a href="#l26.621"></a><span id="l26.621" class="difflineplus">+ * The reference count will *not* be incremented. This is to make adding</span>
<a href="#l26.622"></a><span id="l26.622" class="difflineplus">+ * fields to objects in code more compact. If you want to retain a reference</span>
<a href="#l26.623"></a><span id="l26.623" class="difflineplus">+ * to an added object you must wrap the passed object with json_object_get</span>
<a href="#l26.624"></a><span id="l26.624" class="difflineplus">+ *</span>
<a href="#l26.625"></a><span id="l26.625" class="difflineplus">+ * The reference count of a replaced object will be decremented.</span>
<a href="#l26.626"></a><span id="l26.626" class="difflineplus">+ *</span>
<a href="#l26.627"></a><span id="l26.627" class="difflineplus">+ * The array size will be automatically be expanded to the size of the</span>
<a href="#l26.628"></a><span id="l26.628" class="difflineplus">+ * index if the index is larger than the current size.</span>
<a href="#l26.629"></a><span id="l26.629" class="difflineplus">+ *</span>
<a href="#l26.630"></a><span id="l26.630" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.631"></a><span id="l26.631" class="difflineplus">+ * @param idx the index to insert the element at</span>
<a href="#l26.632"></a><span id="l26.632" class="difflineplus">+ * @param val the json_object to be added</span>
<a href="#l26.633"></a><span id="l26.633" class="difflineplus">+ */</span>
<a href="#l26.634"></a><span id="l26.634" class="difflineplus">+JSON_EXPORT int json_object_array_put_idx(struct json_object *obj, size_t idx,</span>
<a href="#l26.635"></a><span id="l26.635" class="difflineplus">+				     struct json_object *val);</span>
<a href="#l26.636"></a><span id="l26.636" class="difflineplus">+</span>
<a href="#l26.637"></a><span id="l26.637" class="difflineplus">+/** Get the element at specificed index of the array (a json_object of type json_type_array)</span>
<a href="#l26.638"></a><span id="l26.638" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.639"></a><span id="l26.639" class="difflineplus">+ * @param idx the index to get the element at</span>
<a href="#l26.640"></a><span id="l26.640" class="difflineplus">+ * @returns the json_object at the specified index (or NULL)</span>
<a href="#l26.641"></a><span id="l26.641" class="difflineplus">+ */</span>
<a href="#l26.642"></a><span id="l26.642" class="difflineplus">+JSON_EXPORT struct json_object* json_object_array_get_idx(const struct json_object *obj,</span>
<a href="#l26.643"></a><span id="l26.643" class="difflineplus">+						     size_t idx);</span>
<a href="#l26.644"></a><span id="l26.644" class="difflineplus">+</span>
<a href="#l26.645"></a><span id="l26.645" class="difflineplus">+/** Delete an elements from a specified index in an array (a json_object of type json_type_array)</span>
<a href="#l26.646"></a><span id="l26.646" class="difflineplus">+ *</span>
<a href="#l26.647"></a><span id="l26.647" class="difflineplus">+ * The reference count will be decremented for each of the deleted objects.  If there</span>
<a href="#l26.648"></a><span id="l26.648" class="difflineplus">+ * are no more owners of an element that is being deleted, then the value is </span>
<a href="#l26.649"></a><span id="l26.649" class="difflineplus">+ * freed.  Otherwise, the reference to the value will remain in memory.</span>
<a href="#l26.650"></a><span id="l26.650" class="difflineplus">+ *</span>
<a href="#l26.651"></a><span id="l26.651" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.652"></a><span id="l26.652" class="difflineplus">+ * @param idx the index to start deleting elements at</span>
<a href="#l26.653"></a><span id="l26.653" class="difflineplus">+ * @param count the number of elements to delete</span>
<a href="#l26.654"></a><span id="l26.654" class="difflineplus">+ * @returns 0 if the elements were successfully deleted</span>
<a href="#l26.655"></a><span id="l26.655" class="difflineplus">+ */</span>
<a href="#l26.656"></a><span id="l26.656" class="difflineplus">+JSON_EXPORT int json_object_array_del_idx(struct json_object *obj, size_t idx, size_t count);</span>
<a href="#l26.657"></a><span id="l26.657" class="difflineplus">+</span>
<a href="#l26.658"></a><span id="l26.658" class="difflineplus">+/* json_bool type methods */</span>
<a href="#l26.659"></a><span id="l26.659" class="difflineplus">+</span>
<a href="#l26.660"></a><span id="l26.660" class="difflineplus">+/** Create a new empty json_object of type json_type_boolean</span>
<a href="#l26.661"></a><span id="l26.661" class="difflineplus">+ * @param b a json_bool TRUE or FALSE (1 or 0)</span>
<a href="#l26.662"></a><span id="l26.662" class="difflineplus">+ * @returns a json_object of type json_type_boolean</span>
<a href="#l26.663"></a><span id="l26.663" class="difflineplus">+ */</span>
<a href="#l26.664"></a><span id="l26.664" class="difflineplus">+JSON_EXPORT struct json_object* json_object_new_boolean(json_bool b);</span>
<a href="#l26.665"></a><span id="l26.665" class="difflineplus">+</span>
<a href="#l26.666"></a><span id="l26.666" class="difflineplus">+/** Get the json_bool value of a json_object</span>
<a href="#l26.667"></a><span id="l26.667" class="difflineplus">+ *</span>
<a href="#l26.668"></a><span id="l26.668" class="difflineplus">+ * The type is coerced to a json_bool if the passed object is not a json_bool.</span>
<a href="#l26.669"></a><span id="l26.669" class="difflineplus">+ * integer and double objects will return FALSE if there value is zero</span>
<a href="#l26.670"></a><span id="l26.670" class="difflineplus">+ * or TRUE otherwise. If the passed object is a string it will return</span>
<a href="#l26.671"></a><span id="l26.671" class="difflineplus">+ * TRUE if it has a non zero length. If any other object type is passed</span>
<a href="#l26.672"></a><span id="l26.672" class="difflineplus">+ * TRUE will be returned if the object is not NULL.</span>
<a href="#l26.673"></a><span id="l26.673" class="difflineplus">+ *</span>
<a href="#l26.674"></a><span id="l26.674" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.675"></a><span id="l26.675" class="difflineplus">+ * @returns a json_bool</span>
<a href="#l26.676"></a><span id="l26.676" class="difflineplus">+ */</span>
<a href="#l26.677"></a><span id="l26.677" class="difflineplus">+JSON_EXPORT json_bool json_object_get_boolean(const struct json_object *obj);</span>
<a href="#l26.678"></a><span id="l26.678" class="difflineplus">+</span>
<a href="#l26.679"></a><span id="l26.679" class="difflineplus">+</span>
<a href="#l26.680"></a><span id="l26.680" class="difflineplus">+/** Set the json_bool value of a json_object</span>
<a href="#l26.681"></a><span id="l26.681" class="difflineplus">+ * </span>
<a href="#l26.682"></a><span id="l26.682" class="difflineplus">+ * The type of obj is checked to be a json_type_boolean and 0 is returned </span>
<a href="#l26.683"></a><span id="l26.683" class="difflineplus">+ * if it is not without any further actions. If type of obj is json_type_boolean</span>
<a href="#l26.684"></a><span id="l26.684" class="difflineplus">+ * the obect value is chaned to new_value</span>
<a href="#l26.685"></a><span id="l26.685" class="difflineplus">+ *</span>
<a href="#l26.686"></a><span id="l26.686" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.687"></a><span id="l26.687" class="difflineplus">+ * @param new_value the value to be set</span>
<a href="#l26.688"></a><span id="l26.688" class="difflineplus">+ * @returns 1 if value is set correctly, 0 otherwise</span>
<a href="#l26.689"></a><span id="l26.689" class="difflineplus">+ */</span>
<a href="#l26.690"></a><span id="l26.690" class="difflineplus">+JSON_EXPORT int json_object_set_boolean(struct json_object *obj,json_bool new_value);</span>
<a href="#l26.691"></a><span id="l26.691" class="difflineplus">+</span>
<a href="#l26.692"></a><span id="l26.692" class="difflineplus">+</span>
<a href="#l26.693"></a><span id="l26.693" class="difflineplus">+/* int type methods */</span>
<a href="#l26.694"></a><span id="l26.694" class="difflineplus">+</span>
<a href="#l26.695"></a><span id="l26.695" class="difflineplus">+/** Create a new empty json_object of type json_type_int</span>
<a href="#l26.696"></a><span id="l26.696" class="difflineplus">+ * Note that values are stored as 64-bit values internally.</span>
<a href="#l26.697"></a><span id="l26.697" class="difflineplus">+ * To ensure the full range is maintained, use json_object_new_int64 instead.</span>
<a href="#l26.698"></a><span id="l26.698" class="difflineplus">+ * @param i the integer</span>
<a href="#l26.699"></a><span id="l26.699" class="difflineplus">+ * @returns a json_object of type json_type_int</span>
<a href="#l26.700"></a><span id="l26.700" class="difflineplus">+ */</span>
<a href="#l26.701"></a><span id="l26.701" class="difflineplus">+JSON_EXPORT struct json_object* json_object_new_int(int32_t i);</span>
<a href="#l26.702"></a><span id="l26.702" class="difflineplus">+</span>
<a href="#l26.703"></a><span id="l26.703" class="difflineplus">+</span>
<a href="#l26.704"></a><span id="l26.704" class="difflineplus">+/** Create a new empty json_object of type json_type_int</span>
<a href="#l26.705"></a><span id="l26.705" class="difflineplus">+ * @param i the integer</span>
<a href="#l26.706"></a><span id="l26.706" class="difflineplus">+ * @returns a json_object of type json_type_int</span>
<a href="#l26.707"></a><span id="l26.707" class="difflineplus">+ */</span>
<a href="#l26.708"></a><span id="l26.708" class="difflineplus">+JSON_EXPORT struct json_object* json_object_new_int64(int64_t i);</span>
<a href="#l26.709"></a><span id="l26.709" class="difflineplus">+</span>
<a href="#l26.710"></a><span id="l26.710" class="difflineplus">+</span>
<a href="#l26.711"></a><span id="l26.711" class="difflineplus">+/** Get the int value of a json_object</span>
<a href="#l26.712"></a><span id="l26.712" class="difflineplus">+ *</span>
<a href="#l26.713"></a><span id="l26.713" class="difflineplus">+ * The type is coerced to a int if the passed object is not a int.</span>
<a href="#l26.714"></a><span id="l26.714" class="difflineplus">+ * double objects will return their integer conversion. Strings will be</span>
<a href="#l26.715"></a><span id="l26.715" class="difflineplus">+ * parsed as an integer. If no conversion exists then 0 is returned</span>
<a href="#l26.716"></a><span id="l26.716" class="difflineplus">+ * and errno is set to EINVAL. null is equivalent to 0 (no error values set)</span>
<a href="#l26.717"></a><span id="l26.717" class="difflineplus">+ *</span>
<a href="#l26.718"></a><span id="l26.718" class="difflineplus">+ * Note that integers are stored internally as 64-bit values.</span>
<a href="#l26.719"></a><span id="l26.719" class="difflineplus">+ * If the value of too big or too small to fit into 32-bit, INT32_MAX or</span>
<a href="#l26.720"></a><span id="l26.720" class="difflineplus">+ * INT32_MIN are returned, respectively.</span>
<a href="#l26.721"></a><span id="l26.721" class="difflineplus">+ *</span>
<a href="#l26.722"></a><span id="l26.722" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.723"></a><span id="l26.723" class="difflineplus">+ * @returns an int</span>
<a href="#l26.724"></a><span id="l26.724" class="difflineplus">+ */</span>
<a href="#l26.725"></a><span id="l26.725" class="difflineplus">+JSON_EXPORT int32_t json_object_get_int(const struct json_object *obj);</span>
<a href="#l26.726"></a><span id="l26.726" class="difflineplus">+</span>
<a href="#l26.727"></a><span id="l26.727" class="difflineplus">+/** Set the int value of a json_object</span>
<a href="#l26.728"></a><span id="l26.728" class="difflineplus">+ * </span>
<a href="#l26.729"></a><span id="l26.729" class="difflineplus">+ * The type of obj is checked to be a json_type_int and 0 is returned </span>
<a href="#l26.730"></a><span id="l26.730" class="difflineplus">+ * if it is not without any further actions. If type of obj is json_type_int</span>
<a href="#l26.731"></a><span id="l26.731" class="difflineplus">+ * the obect value is changed to new_value</span>
<a href="#l26.732"></a><span id="l26.732" class="difflineplus">+ *</span>
<a href="#l26.733"></a><span id="l26.733" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.734"></a><span id="l26.734" class="difflineplus">+ * @param new_value the value to be set</span>
<a href="#l26.735"></a><span id="l26.735" class="difflineplus">+ * @returns 1 if value is set correctly, 0 otherwise</span>
<a href="#l26.736"></a><span id="l26.736" class="difflineplus">+ */</span>
<a href="#l26.737"></a><span id="l26.737" class="difflineplus">+JSON_EXPORT int json_object_set_int(struct json_object *obj,int new_value);</span>
<a href="#l26.738"></a><span id="l26.738" class="difflineplus">+</span>
<a href="#l26.739"></a><span id="l26.739" class="difflineplus">+/** Increment a json_type_int object by the given amount, which may be negative.</span>
<a href="#l26.740"></a><span id="l26.740" class="difflineplus">+ *</span>
<a href="#l26.741"></a><span id="l26.741" class="difflineplus">+ * If the type of obj is not json_type_int then 0 is returned with no further</span>
<a href="#l26.742"></a><span id="l26.742" class="difflineplus">+ * action taken.</span>
<a href="#l26.743"></a><span id="l26.743" class="difflineplus">+ * If the addition would result in a overflow, the object value</span>
<a href="#l26.744"></a><span id="l26.744" class="difflineplus">+ * is set to INT64_MAX.</span>
<a href="#l26.745"></a><span id="l26.745" class="difflineplus">+ * If the addition would result in a underflow, the object value</span>
<a href="#l26.746"></a><span id="l26.746" class="difflineplus">+ * is set to INT64_MIN.</span>
<a href="#l26.747"></a><span id="l26.747" class="difflineplus">+ * Neither overflow nor underflow affect the return value.</span>
<a href="#l26.748"></a><span id="l26.748" class="difflineplus">+ *</span>
<a href="#l26.749"></a><span id="l26.749" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.750"></a><span id="l26.750" class="difflineplus">+ * @param val the value to add</span>
<a href="#l26.751"></a><span id="l26.751" class="difflineplus">+ * @returns 1 if the increment succeded, 0 otherwise</span>
<a href="#l26.752"></a><span id="l26.752" class="difflineplus">+ */</span>
<a href="#l26.753"></a><span id="l26.753" class="difflineplus">+JSON_EXPORT int json_object_int_inc(struct json_object *obj, int64_t val);</span>
<a href="#l26.754"></a><span id="l26.754" class="difflineplus">+</span>
<a href="#l26.755"></a><span id="l26.755" class="difflineplus">+</span>
<a href="#l26.756"></a><span id="l26.756" class="difflineplus">+/** Get the int value of a json_object</span>
<a href="#l26.757"></a><span id="l26.757" class="difflineplus">+ *</span>
<a href="#l26.758"></a><span id="l26.758" class="difflineplus">+ * The type is coerced to a int64 if the passed object is not a int64.</span>
<a href="#l26.759"></a><span id="l26.759" class="difflineplus">+ * double objects will return their int64 conversion. Strings will be</span>
<a href="#l26.760"></a><span id="l26.760" class="difflineplus">+ * parsed as an int64. If no conversion exists then 0 is returned.</span>
<a href="#l26.761"></a><span id="l26.761" class="difflineplus">+ *</span>
<a href="#l26.762"></a><span id="l26.762" class="difflineplus">+ * NOTE: Set errno to 0 directly before a call to this function to determine</span>
<a href="#l26.763"></a><span id="l26.763" class="difflineplus">+ * whether or not conversion was successful (it does not clear the value for</span>
<a href="#l26.764"></a><span id="l26.764" class="difflineplus">+ * you).</span>
<a href="#l26.765"></a><span id="l26.765" class="difflineplus">+ *</span>
<a href="#l26.766"></a><span id="l26.766" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.767"></a><span id="l26.767" class="difflineplus">+ * @returns an int64</span>
<a href="#l26.768"></a><span id="l26.768" class="difflineplus">+ */</span>
<a href="#l26.769"></a><span id="l26.769" class="difflineplus">+JSON_EXPORT int64_t json_object_get_int64(const struct json_object *obj);</span>
<a href="#l26.770"></a><span id="l26.770" class="difflineplus">+</span>
<a href="#l26.771"></a><span id="l26.771" class="difflineplus">+</span>
<a href="#l26.772"></a><span id="l26.772" class="difflineplus">+/** Set the int64_t value of a json_object</span>
<a href="#l26.773"></a><span id="l26.773" class="difflineplus">+ * </span>
<a href="#l26.774"></a><span id="l26.774" class="difflineplus">+ * The type of obj is checked to be a json_type_int and 0 is returned </span>
<a href="#l26.775"></a><span id="l26.775" class="difflineplus">+ * if it is not without any further actions. If type of obj is json_type_int</span>
<a href="#l26.776"></a><span id="l26.776" class="difflineplus">+ * the obect value is chaned to new_value</span>
<a href="#l26.777"></a><span id="l26.777" class="difflineplus">+ *</span>
<a href="#l26.778"></a><span id="l26.778" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.779"></a><span id="l26.779" class="difflineplus">+ * @param new_value the value to be set</span>
<a href="#l26.780"></a><span id="l26.780" class="difflineplus">+ * @returns 1 if value is set correctly, 0 otherwise</span>
<a href="#l26.781"></a><span id="l26.781" class="difflineplus">+ */</span>
<a href="#l26.782"></a><span id="l26.782" class="difflineplus">+JSON_EXPORT int json_object_set_int64(struct json_object *obj,int64_t new_value);</span>
<a href="#l26.783"></a><span id="l26.783" class="difflineplus">+</span>
<a href="#l26.784"></a><span id="l26.784" class="difflineplus">+/* double type methods */</span>
<a href="#l26.785"></a><span id="l26.785" class="difflineplus">+</span>
<a href="#l26.786"></a><span id="l26.786" class="difflineplus">+/** Create a new empty json_object of type json_type_double</span>
<a href="#l26.787"></a><span id="l26.787" class="difflineplus">+ *</span>
<a href="#l26.788"></a><span id="l26.788" class="difflineplus">+ * @see json_object_double_to_json_string() for how to set a custom format string.</span>
<a href="#l26.789"></a><span id="l26.789" class="difflineplus">+ *</span>
<a href="#l26.790"></a><span id="l26.790" class="difflineplus">+ * @param d the double</span>
<a href="#l26.791"></a><span id="l26.791" class="difflineplus">+ * @returns a json_object of type json_type_double</span>
<a href="#l26.792"></a><span id="l26.792" class="difflineplus">+ */</span>
<a href="#l26.793"></a><span id="l26.793" class="difflineplus">+JSON_EXPORT struct json_object* json_object_new_double(double d);</span>
<a href="#l26.794"></a><span id="l26.794" class="difflineplus">+</span>
<a href="#l26.795"></a><span id="l26.795" class="difflineplus">+/**</span>
<a href="#l26.796"></a><span id="l26.796" class="difflineplus">+ * Create a new json_object of type json_type_double, using</span>
<a href="#l26.797"></a><span id="l26.797" class="difflineplus">+ * the exact serialized representation of the value.</span>
<a href="#l26.798"></a><span id="l26.798" class="difflineplus">+ *</span>
<a href="#l26.799"></a><span id="l26.799" class="difflineplus">+ * This allows for numbers that would otherwise get displayed</span>
<a href="#l26.800"></a><span id="l26.800" class="difflineplus">+ * inefficiently (e.g. 12.3 =&gt; &quot;12.300000000000001&quot;) to be</span>
<a href="#l26.801"></a><span id="l26.801" class="difflineplus">+ * serialized with the more convenient form.</span>
<a href="#l26.802"></a><span id="l26.802" class="difflineplus">+ *</span>
<a href="#l26.803"></a><span id="l26.803" class="difflineplus">+ * Notes:</span>
<a href="#l26.804"></a><span id="l26.804" class="difflineplus">+ *</span>
<a href="#l26.805"></a><span id="l26.805" class="difflineplus">+ * This is used by json_tokener_parse_ex() to allow for</span>
<a href="#l26.806"></a><span id="l26.806" class="difflineplus">+ * an exact re-serialization of a parsed object.</span>
<a href="#l26.807"></a><span id="l26.807" class="difflineplus">+ *</span>
<a href="#l26.808"></a><span id="l26.808" class="difflineplus">+ * The userdata field is used to store the string representation, so it</span>
<a href="#l26.809"></a><span id="l26.809" class="difflineplus">+ * can't be used for other data if this function is used.</span>
<a href="#l26.810"></a><span id="l26.810" class="difflineplus">+ *</span>
<a href="#l26.811"></a><span id="l26.811" class="difflineplus">+ * An equivalent sequence of calls is:</span>
<a href="#l26.812"></a><span id="l26.812" class="difflineplus">+ * @code</span>
<a href="#l26.813"></a><span id="l26.813" class="difflineplus">+ *   jso = json_object_new_double(d);</span>
<a href="#l26.814"></a><span id="l26.814" class="difflineplus">+ *   json_object_set_serializer(jso, json_object_userdata_to_json_string,</span>
<a href="#l26.815"></a><span id="l26.815" class="difflineplus">+ *       strdup(ds), json_object_free_userdata);</span>
<a href="#l26.816"></a><span id="l26.816" class="difflineplus">+ * @endcode</span>
<a href="#l26.817"></a><span id="l26.817" class="difflineplus">+ *</span>
<a href="#l26.818"></a><span id="l26.818" class="difflineplus">+ * @param d the numeric value of the double.</span>
<a href="#l26.819"></a><span id="l26.819" class="difflineplus">+ * @param ds the string representation of the double.  This will be copied.</span>
<a href="#l26.820"></a><span id="l26.820" class="difflineplus">+ */</span>
<a href="#l26.821"></a><span id="l26.821" class="difflineplus">+JSON_EXPORT struct json_object* json_object_new_double_s(double d, const char *ds);</span>
<a href="#l26.822"></a><span id="l26.822" class="difflineplus">+</span>
<a href="#l26.823"></a><span id="l26.823" class="difflineplus">+/**</span>
<a href="#l26.824"></a><span id="l26.824" class="difflineplus">+ * Set a global or thread-local json-c option, depending on whether</span>
<a href="#l26.825"></a><span id="l26.825" class="difflineplus">+ *  JSON_C_OPTION_GLOBAL or JSON_C_OPTION_THREAD is passed.</span>
<a href="#l26.826"></a><span id="l26.826" class="difflineplus">+ * Thread-local options default to undefined, and inherit from the global</span>
<a href="#l26.827"></a><span id="l26.827" class="difflineplus">+ *  value, even if the global value is changed after the thread is created.</span>
<a href="#l26.828"></a><span id="l26.828" class="difflineplus">+ * Attempting to set thread-local options when threading is not compiled in</span>
<a href="#l26.829"></a><span id="l26.829" class="difflineplus">+ *  will result in an error.  Be sure to check the return value.</span>
<a href="#l26.830"></a><span id="l26.830" class="difflineplus">+ *</span>
<a href="#l26.831"></a><span id="l26.831" class="difflineplus">+ * double_format is a &quot;%g&quot; printf format, such as &quot;%.20g&quot;</span>
<a href="#l26.832"></a><span id="l26.832" class="difflineplus">+ *</span>
<a href="#l26.833"></a><span id="l26.833" class="difflineplus">+ * @return -1 on errors, 0 on success.</span>
<a href="#l26.834"></a><span id="l26.834" class="difflineplus">+ */</span>
<a href="#l26.835"></a><span id="l26.835" class="difflineplus">+int json_c_set_serialization_double_format(const char *double_format, int global_or_thread);</span>
<a href="#l26.836"></a><span id="l26.836" class="difflineplus">+</span>
<a href="#l26.837"></a><span id="l26.837" class="difflineplus">+</span>
<a href="#l26.838"></a><span id="l26.838" class="difflineplus">+</span>
<a href="#l26.839"></a><span id="l26.839" class="difflineplus">+/** Serialize a json_object of type json_type_double to a string.</span>
<a href="#l26.840"></a><span id="l26.840" class="difflineplus">+ *</span>
<a href="#l26.841"></a><span id="l26.841" class="difflineplus">+ * This function isn't meant to be called directly. Instead, you can set a</span>
<a href="#l26.842"></a><span id="l26.842" class="difflineplus">+ * custom format string for the serialization of this double using the</span>
<a href="#l26.843"></a><span id="l26.843" class="difflineplus">+ * following call (where &quot;%.17g&quot; actually is the default):</span>
<a href="#l26.844"></a><span id="l26.844" class="difflineplus">+ *</span>
<a href="#l26.845"></a><span id="l26.845" class="difflineplus">+ * @code</span>
<a href="#l26.846"></a><span id="l26.846" class="difflineplus">+ *   jso = json_object_new_double(d);</span>
<a href="#l26.847"></a><span id="l26.847" class="difflineplus">+ *   json_object_set_serializer(jso, json_object_double_to_json_string,</span>
<a href="#l26.848"></a><span id="l26.848" class="difflineplus">+ *       &quot;%.17g&quot;, NULL);</span>
<a href="#l26.849"></a><span id="l26.849" class="difflineplus">+ * @endcode</span>
<a href="#l26.850"></a><span id="l26.850" class="difflineplus">+ *</span>
<a href="#l26.851"></a><span id="l26.851" class="difflineplus">+ * @see printf(3) man page for format strings</span>
<a href="#l26.852"></a><span id="l26.852" class="difflineplus">+ *</span>
<a href="#l26.853"></a><span id="l26.853" class="difflineplus">+ * @param jso The json_type_double object that is serialized.</span>
<a href="#l26.854"></a><span id="l26.854" class="difflineplus">+ * @param pb The destination buffer.</span>
<a href="#l26.855"></a><span id="l26.855" class="difflineplus">+ * @param level Ignored.</span>
<a href="#l26.856"></a><span id="l26.856" class="difflineplus">+ * @param flags Ignored.</span>
<a href="#l26.857"></a><span id="l26.857" class="difflineplus">+ */</span>
<a href="#l26.858"></a><span id="l26.858" class="difflineplus">+JSON_EXPORT int json_object_double_to_json_string(struct json_object* jso,</span>
<a href="#l26.859"></a><span id="l26.859" class="difflineplus">+					     struct printbuf *pb,</span>
<a href="#l26.860"></a><span id="l26.860" class="difflineplus">+					     int level,</span>
<a href="#l26.861"></a><span id="l26.861" class="difflineplus">+					     int flags);</span>
<a href="#l26.862"></a><span id="l26.862" class="difflineplus">+</span>
<a href="#l26.863"></a><span id="l26.863" class="difflineplus">+/** Get the double floating point value of a json_object</span>
<a href="#l26.864"></a><span id="l26.864" class="difflineplus">+ *</span>
<a href="#l26.865"></a><span id="l26.865" class="difflineplus">+ * The type is coerced to a double if the passed object is not a double.</span>
<a href="#l26.866"></a><span id="l26.866" class="difflineplus">+ * integer objects will return their double conversion. Strings will be</span>
<a href="#l26.867"></a><span id="l26.867" class="difflineplus">+ * parsed as a double. If no conversion exists then 0.0 is returned and</span>
<a href="#l26.868"></a><span id="l26.868" class="difflineplus">+ * errno is set to EINVAL. null is equivalent to 0 (no error values set)</span>
<a href="#l26.869"></a><span id="l26.869" class="difflineplus">+ *</span>
<a href="#l26.870"></a><span id="l26.870" class="difflineplus">+ * If the value is too big to fit in a double, then the value is set to</span>
<a href="#l26.871"></a><span id="l26.871" class="difflineplus">+ * the closest infinity with errno set to ERANGE. If strings cannot be</span>
<a href="#l26.872"></a><span id="l26.872" class="difflineplus">+ * converted to their double value, then EINVAL is set &amp; NaN is returned.</span>
<a href="#l26.873"></a><span id="l26.873" class="difflineplus">+ *</span>
<a href="#l26.874"></a><span id="l26.874" class="difflineplus">+ * Arrays of length 0 are interpreted as 0 (with no error flags set).</span>
<a href="#l26.875"></a><span id="l26.875" class="difflineplus">+ * Arrays of length 1 are effectively cast to the equivalent object and</span>
<a href="#l26.876"></a><span id="l26.876" class="difflineplus">+ * converted using the above rules.  All other arrays set the error to</span>
<a href="#l26.877"></a><span id="l26.877" class="difflineplus">+ * EINVAL &amp; return NaN.</span>
<a href="#l26.878"></a><span id="l26.878" class="difflineplus">+ *</span>
<a href="#l26.879"></a><span id="l26.879" class="difflineplus">+ * NOTE: Set errno to 0 directly before a call to this function to</span>
<a href="#l26.880"></a><span id="l26.880" class="difflineplus">+ * determine whether or not conversion was successful (it does not clear</span>
<a href="#l26.881"></a><span id="l26.881" class="difflineplus">+ * the value for you).</span>
<a href="#l26.882"></a><span id="l26.882" class="difflineplus">+ *</span>
<a href="#l26.883"></a><span id="l26.883" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.884"></a><span id="l26.884" class="difflineplus">+ * @returns a double floating point number</span>
<a href="#l26.885"></a><span id="l26.885" class="difflineplus">+ */</span>
<a href="#l26.886"></a><span id="l26.886" class="difflineplus">+JSON_EXPORT double json_object_get_double(const struct json_object *obj);</span>
<a href="#l26.887"></a><span id="l26.887" class="difflineplus">+</span>
<a href="#l26.888"></a><span id="l26.888" class="difflineplus">+</span>
<a href="#l26.889"></a><span id="l26.889" class="difflineplus">+/** Set the double value of a json_object</span>
<a href="#l26.890"></a><span id="l26.890" class="difflineplus">+ * </span>
<a href="#l26.891"></a><span id="l26.891" class="difflineplus">+ * The type of obj is checked to be a json_type_double and 0 is returned </span>
<a href="#l26.892"></a><span id="l26.892" class="difflineplus">+ * if it is not without any further actions. If type of obj is json_type_double</span>
<a href="#l26.893"></a><span id="l26.893" class="difflineplus">+ * the obect value is chaned to new_value</span>
<a href="#l26.894"></a><span id="l26.894" class="difflineplus">+ *</span>
<a href="#l26.895"></a><span id="l26.895" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.896"></a><span id="l26.896" class="difflineplus">+ * @param new_value the value to be set</span>
<a href="#l26.897"></a><span id="l26.897" class="difflineplus">+ * @returns 1 if value is set correctly, 0 otherwise</span>
<a href="#l26.898"></a><span id="l26.898" class="difflineplus">+ */</span>
<a href="#l26.899"></a><span id="l26.899" class="difflineplus">+JSON_EXPORT int json_object_set_double(struct json_object *obj,double new_value);</span>
<a href="#l26.900"></a><span id="l26.900" class="difflineplus">+</span>
<a href="#l26.901"></a><span id="l26.901" class="difflineplus">+</span>
<a href="#l26.902"></a><span id="l26.902" class="difflineplus">+</span>
<a href="#l26.903"></a><span id="l26.903" class="difflineplus">+/* string type methods */</span>
<a href="#l26.904"></a><span id="l26.904" class="difflineplus">+</span>
<a href="#l26.905"></a><span id="l26.905" class="difflineplus">+/** Create a new empty json_object of type json_type_string</span>
<a href="#l26.906"></a><span id="l26.906" class="difflineplus">+ *</span>
<a href="#l26.907"></a><span id="l26.907" class="difflineplus">+ * A copy of the string is made and the memory is managed by the json_object</span>
<a href="#l26.908"></a><span id="l26.908" class="difflineplus">+ *</span>
<a href="#l26.909"></a><span id="l26.909" class="difflineplus">+ * @param s the string</span>
<a href="#l26.910"></a><span id="l26.910" class="difflineplus">+ * @returns a json_object of type json_type_string</span>
<a href="#l26.911"></a><span id="l26.911" class="difflineplus">+ */</span>
<a href="#l26.912"></a><span id="l26.912" class="difflineplus">+JSON_EXPORT struct json_object* json_object_new_string(const char *s);</span>
<a href="#l26.913"></a><span id="l26.913" class="difflineplus">+</span>
<a href="#l26.914"></a><span id="l26.914" class="difflineplus">+JSON_EXPORT struct json_object* json_object_new_string_len(const char *s, int len);</span>
<a href="#l26.915"></a><span id="l26.915" class="difflineplus">+</span>
<a href="#l26.916"></a><span id="l26.916" class="difflineplus">+/** Get the string value of a json_object</span>
<a href="#l26.917"></a><span id="l26.917" class="difflineplus">+ *</span>
<a href="#l26.918"></a><span id="l26.918" class="difflineplus">+ * If the passed object is of type json_type_null (i.e. obj == NULL),</span>
<a href="#l26.919"></a><span id="l26.919" class="difflineplus">+ * NULL is returned.</span>
<a href="#l26.920"></a><span id="l26.920" class="difflineplus">+ *</span>
<a href="#l26.921"></a><span id="l26.921" class="difflineplus">+ * If the passed object of type json_type_string, the string contents</span>
<a href="#l26.922"></a><span id="l26.922" class="difflineplus">+ * are returned.</span>
<a href="#l26.923"></a><span id="l26.923" class="difflineplus">+ *</span>
<a href="#l26.924"></a><span id="l26.924" class="difflineplus">+ * Otherwise the JSON representation of the object is returned.</span>
<a href="#l26.925"></a><span id="l26.925" class="difflineplus">+ *</span>
<a href="#l26.926"></a><span id="l26.926" class="difflineplus">+ * The returned string memory is managed by the json_object and will</span>
<a href="#l26.927"></a><span id="l26.927" class="difflineplus">+ * be freed when the reference count of the json_object drops to zero.</span>
<a href="#l26.928"></a><span id="l26.928" class="difflineplus">+ *</span>
<a href="#l26.929"></a><span id="l26.929" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.930"></a><span id="l26.930" class="difflineplus">+ * @returns a string or NULL</span>
<a href="#l26.931"></a><span id="l26.931" class="difflineplus">+ */</span>
<a href="#l26.932"></a><span id="l26.932" class="difflineplus">+JSON_EXPORT const char* json_object_get_string(struct json_object *obj);</span>
<a href="#l26.933"></a><span id="l26.933" class="difflineplus">+</span>
<a href="#l26.934"></a><span id="l26.934" class="difflineplus">+/** Get the string length of a json_object</span>
<a href="#l26.935"></a><span id="l26.935" class="difflineplus">+ *</span>
<a href="#l26.936"></a><span id="l26.936" class="difflineplus">+ * If the passed object is not of type json_type_string then zero</span>
<a href="#l26.937"></a><span id="l26.937" class="difflineplus">+ * will be returned.</span>
<a href="#l26.938"></a><span id="l26.938" class="difflineplus">+ *</span>
<a href="#l26.939"></a><span id="l26.939" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.940"></a><span id="l26.940" class="difflineplus">+ * @returns int</span>
<a href="#l26.941"></a><span id="l26.941" class="difflineplus">+ */</span>
<a href="#l26.942"></a><span id="l26.942" class="difflineplus">+JSON_EXPORT int json_object_get_string_len(const struct json_object *obj);</span>
<a href="#l26.943"></a><span id="l26.943" class="difflineplus">+</span>
<a href="#l26.944"></a><span id="l26.944" class="difflineplus">+</span>
<a href="#l26.945"></a><span id="l26.945" class="difflineplus">+/** Set the string value of a json_object with zero terminated strings</span>
<a href="#l26.946"></a><span id="l26.946" class="difflineplus">+ * equivalent to json_object_set_string_len (obj, new_value, strlen(new_value))</span>
<a href="#l26.947"></a><span id="l26.947" class="difflineplus">+ * @returns 1 if value is set correctly, 0 otherwise</span>
<a href="#l26.948"></a><span id="l26.948" class="difflineplus">+ */</span>
<a href="#l26.949"></a><span id="l26.949" class="difflineplus">+JSON_EXPORT int json_object_set_string(json_object* obj, const char* new_value);</span>
<a href="#l26.950"></a><span id="l26.950" class="difflineplus">+</span>
<a href="#l26.951"></a><span id="l26.951" class="difflineplus">+/** Set the string value of a json_object str</span>
<a href="#l26.952"></a><span id="l26.952" class="difflineplus">+ * </span>
<a href="#l26.953"></a><span id="l26.953" class="difflineplus">+ * The type of obj is checked to be a json_type_string and 0 is returned </span>
<a href="#l26.954"></a><span id="l26.954" class="difflineplus">+ * if it is not without any further actions. If type of obj is json_type_string</span>
<a href="#l26.955"></a><span id="l26.955" class="difflineplus">+ * the obect value is chaned to new_value</span>
<a href="#l26.956"></a><span id="l26.956" class="difflineplus">+ *</span>
<a href="#l26.957"></a><span id="l26.957" class="difflineplus">+ * @param obj the json_object instance</span>
<a href="#l26.958"></a><span id="l26.958" class="difflineplus">+ * @param new_value the value to be set; Since string legth is given in len this need not be zero terminated</span>
<a href="#l26.959"></a><span id="l26.959" class="difflineplus">+ * @param len the length of new_value</span>
<a href="#l26.960"></a><span id="l26.960" class="difflineplus">+ * @returns 1 if value is set correctly, 0 otherwise</span>
<a href="#l26.961"></a><span id="l26.961" class="difflineplus">+ */</span>
<a href="#l26.962"></a><span id="l26.962" class="difflineplus">+JSON_EXPORT int json_object_set_string_len(json_object* obj, const char* new_value, int len);</span>
<a href="#l26.963"></a><span id="l26.963" class="difflineplus">+</span>
<a href="#l26.964"></a><span id="l26.964" class="difflineplus">+/** Check if two json_object's are equal</span>
<a href="#l26.965"></a><span id="l26.965" class="difflineplus">+ *</span>
<a href="#l26.966"></a><span id="l26.966" class="difflineplus">+ * If the passed objects are equal 1 will be returned.</span>
<a href="#l26.967"></a><span id="l26.967" class="difflineplus">+ * Equality is defined as follows:</span>
<a href="#l26.968"></a><span id="l26.968" class="difflineplus">+ * - json_objects of different types are never equal</span>
<a href="#l26.969"></a><span id="l26.969" class="difflineplus">+ * - json_objects of the same primitive type are equal if the</span>
<a href="#l26.970"></a><span id="l26.970" class="difflineplus">+ *   c-representation of their value is equal</span>
<a href="#l26.971"></a><span id="l26.971" class="difflineplus">+ * - json-arrays are considered equal if all values at the same</span>
<a href="#l26.972"></a><span id="l26.972" class="difflineplus">+ *   indices are equal (same order)</span>
<a href="#l26.973"></a><span id="l26.973" class="difflineplus">+ * - Complex json_objects are considered equal if all</span>
<a href="#l26.974"></a><span id="l26.974" class="difflineplus">+ *   contained objects referenced by their key are equal,</span>
<a href="#l26.975"></a><span id="l26.975" class="difflineplus">+ *   regardless their order.</span>
<a href="#l26.976"></a><span id="l26.976" class="difflineplus">+ *</span>
<a href="#l26.977"></a><span id="l26.977" class="difflineplus">+ * @param obj1 the first json_object instance</span>
<a href="#l26.978"></a><span id="l26.978" class="difflineplus">+ * @param obj2 the second json_object instance</span>
<a href="#l26.979"></a><span id="l26.979" class="difflineplus">+ * @returns whether both objects are equal or not</span>
<a href="#l26.980"></a><span id="l26.980" class="difflineplus">+ */</span>
<a href="#l26.981"></a><span id="l26.981" class="difflineplus">+JSON_EXPORT int json_object_equal(struct json_object *obj1,</span>
<a href="#l26.982"></a><span id="l26.982" class="difflineplus">+			     struct json_object *obj2);</span>
<a href="#l26.983"></a><span id="l26.983" class="difflineplus">+</span>
<a href="#l26.984"></a><span id="l26.984" class="difflineplus">+/**</span>
<a href="#l26.985"></a><span id="l26.985" class="difflineplus">+ * Perform a shallow copy of src into *dst as part of an overall json_object_deep_copy().</span>
<a href="#l26.986"></a><span id="l26.986" class="difflineplus">+ *</span>
<a href="#l26.987"></a><span id="l26.987" class="difflineplus">+ * If src is part of a containing object or array, parent will be non-NULL,</span>
<a href="#l26.988"></a><span id="l26.988" class="difflineplus">+ * and key or index will be provided.</span>
<a href="#l26.989"></a><span id="l26.989" class="difflineplus">+ * When shallow_copy is called *dst will be NULL, and must be non-NULL when it returns.</span>
<a href="#l26.990"></a><span id="l26.990" class="difflineplus">+ * src will never be NULL.</span>
<a href="#l26.991"></a><span id="l26.991" class="difflineplus">+ *</span>
<a href="#l26.992"></a><span id="l26.992" class="difflineplus">+ * If shallow_copy sets the serializer on an object, return 2 to indicate to </span>
<a href="#l26.993"></a><span id="l26.993" class="difflineplus">+ *  json_object_deep_copy that it should not attempt to use the standard userdata</span>
<a href="#l26.994"></a><span id="l26.994" class="difflineplus">+ *  copy function.</span>
<a href="#l26.995"></a><span id="l26.995" class="difflineplus">+ *</span>
<a href="#l26.996"></a><span id="l26.996" class="difflineplus">+ * @return On success 1 or 2, -1 on errors</span>
<a href="#l26.997"></a><span id="l26.997" class="difflineplus">+ */</span>
<a href="#l26.998"></a><span id="l26.998" class="difflineplus">+typedef int (json_c_shallow_copy_fn)(json_object *src, json_object *parent, const char *key, size_t index, json_object **dst);</span>
<a href="#l26.999"></a><span id="l26.999" class="difflineplus">+</span>
<a href="#l26.1000"></a><span id="l26.1000" class="difflineplus">+/**</span>
<a href="#l26.1001"></a><span id="l26.1001" class="difflineplus">+ * The default shallow copy implementation for use with json_object_deep_copy().</span>
<a href="#l26.1002"></a><span id="l26.1002" class="difflineplus">+ * This simply calls the appropriate json_object_new_&lt;type&gt;() function and </span>
<a href="#l26.1003"></a><span id="l26.1003" class="difflineplus">+ * copies over the serializer function (_to_json_string internal field of</span>
<a href="#l26.1004"></a><span id="l26.1004" class="difflineplus">+ * the json_object structure) but not any _userdata or _user_delete values.</span>
<a href="#l26.1005"></a><span id="l26.1005" class="difflineplus">+ *</span>
<a href="#l26.1006"></a><span id="l26.1006" class="difflineplus">+ * If you're writing a custom shallow_copy function, perhaps because you're using</span>
<a href="#l26.1007"></a><span id="l26.1007" class="difflineplus">+ * your own custom serializer, you can call this first to create the new object</span>
<a href="#l26.1008"></a><span id="l26.1008" class="difflineplus">+ * before customizing it with json_object_set_serializer().</span>
<a href="#l26.1009"></a><span id="l26.1009" class="difflineplus">+ *</span>
<a href="#l26.1010"></a><span id="l26.1010" class="difflineplus">+ * @return 1 on success, -1 on errors, but never 2.</span>
<a href="#l26.1011"></a><span id="l26.1011" class="difflineplus">+ */</span>
<a href="#l26.1012"></a><span id="l26.1012" class="difflineplus">+json_c_shallow_copy_fn json_c_shallow_copy_default;</span>
<a href="#l26.1013"></a><span id="l26.1013" class="difflineplus">+</span>
<a href="#l26.1014"></a><span id="l26.1014" class="difflineplus">+/**</span>
<a href="#l26.1015"></a><span id="l26.1015" class="difflineplus">+ * Copy the contents of the JSON object.</span>
<a href="#l26.1016"></a><span id="l26.1016" class="difflineplus">+ * The destination object must be initialized to NULL,</span>
<a href="#l26.1017"></a><span id="l26.1017" class="difflineplus">+ * to make sure this function won't overwrite an existing JSON object.</span>
<a href="#l26.1018"></a><span id="l26.1018" class="difflineplus">+ *</span>
<a href="#l26.1019"></a><span id="l26.1019" class="difflineplus">+ * This does roughly the same thing as</span>
<a href="#l26.1020"></a><span id="l26.1020" class="difflineplus">+ * `json_tokener_parse(json_object_get_string(src))`.</span>
<a href="#l26.1021"></a><span id="l26.1021" class="difflineplus">+ *</span>
<a href="#l26.1022"></a><span id="l26.1022" class="difflineplus">+ * @param src source JSON object whose contents will be copied</span>
<a href="#l26.1023"></a><span id="l26.1023" class="difflineplus">+ * @param dst pointer to the destination object where the contents of `src`;</span>
<a href="#l26.1024"></a><span id="l26.1024" class="difflineplus">+ *            make sure this pointer is initialized to NULL</span>
<a href="#l26.1025"></a><span id="l26.1025" class="difflineplus">+ * @param shallow_copy an optional function to copy individual objects, needed</span>
<a href="#l26.1026"></a><span id="l26.1026" class="difflineplus">+ *                     when custom serializers are in use.  See also</span>
<a href="#l26.1027"></a><span id="l26.1027" class="difflineplus">+ *                     json_object set_serializer.</span>
<a href="#l26.1028"></a><span id="l26.1028" class="difflineplus">+ *</span>
<a href="#l26.1029"></a><span id="l26.1029" class="difflineplus">+ * @returns 0 if the copy went well, -1 if an error occured during copy</span>
<a href="#l26.1030"></a><span id="l26.1030" class="difflineplus">+ *          or if the destination pointer is non-NULL</span>
<a href="#l26.1031"></a><span id="l26.1031" class="difflineplus">+ */</span>
<a href="#l26.1032"></a><span id="l26.1032" class="difflineplus">+</span>
<a href="#l26.1033"></a><span id="l26.1033" class="difflineplus">+JSON_EXPORT int json_object_deep_copy(struct json_object *src, struct json_object **dst, json_c_shallow_copy_fn *shallow_copy); </span>
<a href="#l26.1034"></a><span id="l26.1034" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l26.1035"></a><span id="l26.1035" class="difflineplus">+}</span>
<a href="#l26.1036"></a><span id="l26.1036" class="difflineplus">+#endif</span>
<a href="#l26.1037"></a><span id="l26.1037" class="difflineplus">+</span>
<a href="#l26.1038"></a><span id="l26.1038" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1">new file mode 100644</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineminus">--- /dev/null</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineplus">+++ b/third_party/json-c/json_object_iterator.c</span>
<a href="#l27.4"></a><span id="l27.4" class="difflineat">@@ -0,0 +1,163 @@</span>
<a href="#l27.5"></a><span id="l27.5" class="difflineplus">+/**</span>
<a href="#l27.6"></a><span id="l27.6" class="difflineplus">+*******************************************************************************</span>
<a href="#l27.7"></a><span id="l27.7" class="difflineplus">+* @file json_object_iterator.c</span>
<a href="#l27.8"></a><span id="l27.8" class="difflineplus">+*</span>
<a href="#l27.9"></a><span id="l27.9" class="difflineplus">+* Copyright (c) 2009-2012 Hewlett-Packard Development Company, L.P.</span>
<a href="#l27.10"></a><span id="l27.10" class="difflineplus">+*</span>
<a href="#l27.11"></a><span id="l27.11" class="difflineplus">+* This library is free software; you can redistribute it and/or modify</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineplus">+* it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+*</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineplus">+*******************************************************************************</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineplus">+*/</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineplus">+</span>
<a href="#l27.17"></a><span id="l27.17" class="difflineplus">+#include &lt;stddef.h&gt;</span>
<a href="#l27.18"></a><span id="l27.18" class="difflineplus">+</span>
<a href="#l27.19"></a><span id="l27.19" class="difflineplus">+#include &quot;json.h&quot;</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineplus">+#include &quot;json_object_private.h&quot;</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineplus">+</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineplus">+#include &quot;json_object_iterator.h&quot;</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineplus">+</span>
<a href="#l27.24"></a><span id="l27.24" class="difflineplus">+/**</span>
<a href="#l27.25"></a><span id="l27.25" class="difflineplus">+ * How It Works</span>
<a href="#l27.26"></a><span id="l27.26" class="difflineplus">+ *</span>
<a href="#l27.27"></a><span id="l27.27" class="difflineplus">+ * For each JSON Object, json-c maintains a linked list of zero</span>
<a href="#l27.28"></a><span id="l27.28" class="difflineplus">+ * or more lh_entry (link-hash entry) structures inside the</span>
<a href="#l27.29"></a><span id="l27.29" class="difflineplus">+ * Object's link-hash table (lh_table).</span>
<a href="#l27.30"></a><span id="l27.30" class="difflineplus">+ *</span>
<a href="#l27.31"></a><span id="l27.31" class="difflineplus">+ * Each lh_entry structure on the JSON Object's linked list</span>
<a href="#l27.32"></a><span id="l27.32" class="difflineplus">+ * represents a single name/value pair.  The &quot;next&quot; field of the</span>
<a href="#l27.33"></a><span id="l27.33" class="difflineplus">+ * last lh_entry in the list is set to NULL, which terminates</span>
<a href="#l27.34"></a><span id="l27.34" class="difflineplus">+ * the list.</span>
<a href="#l27.35"></a><span id="l27.35" class="difflineplus">+ *</span>
<a href="#l27.36"></a><span id="l27.36" class="difflineplus">+ * We represent a valid iterator that refers to an actual</span>
<a href="#l27.37"></a><span id="l27.37" class="difflineplus">+ * name/value pair via a pointer to the pair's lh_entry</span>
<a href="#l27.38"></a><span id="l27.38" class="difflineplus">+ * structure set as the iterator's opaque_ field.</span>
<a href="#l27.39"></a><span id="l27.39" class="difflineplus">+ *</span>
<a href="#l27.40"></a><span id="l27.40" class="difflineplus">+ * We follow json-c's current pair list representation by</span>
<a href="#l27.41"></a><span id="l27.41" class="difflineplus">+ * representing a valid &quot;end&quot; iterator (one that refers past the</span>
<a href="#l27.42"></a><span id="l27.42" class="difflineplus">+ * last pair) with a NULL value in the iterator's opaque_ field.</span>
<a href="#l27.43"></a><span id="l27.43" class="difflineplus">+ *</span>
<a href="#l27.44"></a><span id="l27.44" class="difflineplus">+ * A JSON Object without any pairs in it will have the &quot;head&quot;</span>
<a href="#l27.45"></a><span id="l27.45" class="difflineplus">+ * field of its lh_table structure set to NULL.  For such an</span>
<a href="#l27.46"></a><span id="l27.46" class="difflineplus">+ * object, json_object_iter_begin will return an iterator with</span>
<a href="#l27.47"></a><span id="l27.47" class="difflineplus">+ * the opaque_ field set to NULL, which is equivalent to the</span>
<a href="#l27.48"></a><span id="l27.48" class="difflineplus">+ * &quot;end&quot; iterator.</span>
<a href="#l27.49"></a><span id="l27.49" class="difflineplus">+ *</span>
<a href="#l27.50"></a><span id="l27.50" class="difflineplus">+ * When iterating, we simply update the iterator's opaque_ field</span>
<a href="#l27.51"></a><span id="l27.51" class="difflineplus">+ * to point to the next lh_entry structure in the linked list.</span>
<a href="#l27.52"></a><span id="l27.52" class="difflineplus">+ * opaque_ will become NULL once we iterate past the last pair</span>
<a href="#l27.53"></a><span id="l27.53" class="difflineplus">+ * in the list, which makes the iterator equivalent to the &quot;end&quot;</span>
<a href="#l27.54"></a><span id="l27.54" class="difflineplus">+ * iterator.</span>
<a href="#l27.55"></a><span id="l27.55" class="difflineplus">+ */</span>
<a href="#l27.56"></a><span id="l27.56" class="difflineplus">+</span>
<a href="#l27.57"></a><span id="l27.57" class="difflineplus">+/// Our current representation of the &quot;end&quot; iterator;</span>
<a href="#l27.58"></a><span id="l27.58" class="difflineplus">+///</span>
<a href="#l27.59"></a><span id="l27.59" class="difflineplus">+/// @note May not always be NULL</span>
<a href="#l27.60"></a><span id="l27.60" class="difflineplus">+static const void* kObjectEndIterValue = NULL;</span>
<a href="#l27.61"></a><span id="l27.61" class="difflineplus">+</span>
<a href="#l27.62"></a><span id="l27.62" class="difflineplus">+/**</span>
<a href="#l27.63"></a><span id="l27.63" class="difflineplus">+ * ****************************************************************************</span>
<a href="#l27.64"></a><span id="l27.64" class="difflineplus">+ */</span>
<a href="#l27.65"></a><span id="l27.65" class="difflineplus">+struct json_object_iterator</span>
<a href="#l27.66"></a><span id="l27.66" class="difflineplus">+json_object_iter_begin(struct json_object* obj)</span>
<a href="#l27.67"></a><span id="l27.67" class="difflineplus">+{</span>
<a href="#l27.68"></a><span id="l27.68" class="difflineplus">+    struct json_object_iterator iter;</span>
<a href="#l27.69"></a><span id="l27.69" class="difflineplus">+    struct lh_table* pTable;</span>
<a href="#l27.70"></a><span id="l27.70" class="difflineplus">+</span>
<a href="#l27.71"></a><span id="l27.71" class="difflineplus">+    /// @note json_object_get_object will return NULL if passed NULL</span>
<a href="#l27.72"></a><span id="l27.72" class="difflineplus">+    ///       or a non-json_type_object instance</span>
<a href="#l27.73"></a><span id="l27.73" class="difflineplus">+    pTable = json_object_get_object(obj);</span>
<a href="#l27.74"></a><span id="l27.74" class="difflineplus">+    JASSERT(NULL != pTable);</span>
<a href="#l27.75"></a><span id="l27.75" class="difflineplus">+</span>
<a href="#l27.76"></a><span id="l27.76" class="difflineplus">+    /// @note For a pair-less Object, head is NULL, which matches our</span>
<a href="#l27.77"></a><span id="l27.77" class="difflineplus">+    ///       definition of the &quot;end&quot; iterator</span>
<a href="#l27.78"></a><span id="l27.78" class="difflineplus">+    iter.opaque_ = pTable-&gt;head;</span>
<a href="#l27.79"></a><span id="l27.79" class="difflineplus">+    return iter;</span>
<a href="#l27.80"></a><span id="l27.80" class="difflineplus">+}</span>
<a href="#l27.81"></a><span id="l27.81" class="difflineplus">+</span>
<a href="#l27.82"></a><span id="l27.82" class="difflineplus">+/**</span>
<a href="#l27.83"></a><span id="l27.83" class="difflineplus">+ * ****************************************************************************</span>
<a href="#l27.84"></a><span id="l27.84" class="difflineplus">+ */</span>
<a href="#l27.85"></a><span id="l27.85" class="difflineplus">+struct json_object_iterator</span>
<a href="#l27.86"></a><span id="l27.86" class="difflineplus">+json_object_iter_end(const struct json_object* obj)</span>
<a href="#l27.87"></a><span id="l27.87" class="difflineplus">+{</span>
<a href="#l27.88"></a><span id="l27.88" class="difflineplus">+    struct json_object_iterator iter;</span>
<a href="#l27.89"></a><span id="l27.89" class="difflineplus">+</span>
<a href="#l27.90"></a><span id="l27.90" class="difflineplus">+    JASSERT(NULL != obj);</span>
<a href="#l27.91"></a><span id="l27.91" class="difflineplus">+    JASSERT(json_object_is_type(obj, json_type_object));</span>
<a href="#l27.92"></a><span id="l27.92" class="difflineplus">+</span>
<a href="#l27.93"></a><span id="l27.93" class="difflineplus">+    iter.opaque_ = kObjectEndIterValue;</span>
<a href="#l27.94"></a><span id="l27.94" class="difflineplus">+</span>
<a href="#l27.95"></a><span id="l27.95" class="difflineplus">+    return iter;</span>
<a href="#l27.96"></a><span id="l27.96" class="difflineplus">+}</span>
<a href="#l27.97"></a><span id="l27.97" class="difflineplus">+</span>
<a href="#l27.98"></a><span id="l27.98" class="difflineplus">+/**</span>
<a href="#l27.99"></a><span id="l27.99" class="difflineplus">+ * ****************************************************************************</span>
<a href="#l27.100"></a><span id="l27.100" class="difflineplus">+ */</span>
<a href="#l27.101"></a><span id="l27.101" class="difflineplus">+void</span>
<a href="#l27.102"></a><span id="l27.102" class="difflineplus">+json_object_iter_next(struct json_object_iterator* iter)</span>
<a href="#l27.103"></a><span id="l27.103" class="difflineplus">+{</span>
<a href="#l27.104"></a><span id="l27.104" class="difflineplus">+    JASSERT(NULL != iter);</span>
<a href="#l27.105"></a><span id="l27.105" class="difflineplus">+    JASSERT(kObjectEndIterValue != iter-&gt;opaque_);</span>
<a href="#l27.106"></a><span id="l27.106" class="difflineplus">+</span>
<a href="#l27.107"></a><span id="l27.107" class="difflineplus">+    iter-&gt;opaque_ = ((const struct lh_entry *)iter-&gt;opaque_)-&gt;next;</span>
<a href="#l27.108"></a><span id="l27.108" class="difflineplus">+}</span>
<a href="#l27.109"></a><span id="l27.109" class="difflineplus">+</span>
<a href="#l27.110"></a><span id="l27.110" class="difflineplus">+</span>
<a href="#l27.111"></a><span id="l27.111" class="difflineplus">+/**</span>
<a href="#l27.112"></a><span id="l27.112" class="difflineplus">+ * ****************************************************************************</span>
<a href="#l27.113"></a><span id="l27.113" class="difflineplus">+ */</span>
<a href="#l27.114"></a><span id="l27.114" class="difflineplus">+const char*</span>
<a href="#l27.115"></a><span id="l27.115" class="difflineplus">+json_object_iter_peek_name(const struct json_object_iterator* iter)</span>
<a href="#l27.116"></a><span id="l27.116" class="difflineplus">+{</span>
<a href="#l27.117"></a><span id="l27.117" class="difflineplus">+    JASSERT(NULL != iter);</span>
<a href="#l27.118"></a><span id="l27.118" class="difflineplus">+    JASSERT(kObjectEndIterValue != iter-&gt;opaque_);</span>
<a href="#l27.119"></a><span id="l27.119" class="difflineplus">+</span>
<a href="#l27.120"></a><span id="l27.120" class="difflineplus">+    return (const char*)(((const struct lh_entry *)iter-&gt;opaque_)-&gt;k);</span>
<a href="#l27.121"></a><span id="l27.121" class="difflineplus">+}</span>
<a href="#l27.122"></a><span id="l27.122" class="difflineplus">+</span>
<a href="#l27.123"></a><span id="l27.123" class="difflineplus">+</span>
<a href="#l27.124"></a><span id="l27.124" class="difflineplus">+/**</span>
<a href="#l27.125"></a><span id="l27.125" class="difflineplus">+ * ****************************************************************************</span>
<a href="#l27.126"></a><span id="l27.126" class="difflineplus">+ */</span>
<a href="#l27.127"></a><span id="l27.127" class="difflineplus">+struct json_object*</span>
<a href="#l27.128"></a><span id="l27.128" class="difflineplus">+json_object_iter_peek_value(const struct json_object_iterator* iter)</span>
<a href="#l27.129"></a><span id="l27.129" class="difflineplus">+{</span>
<a href="#l27.130"></a><span id="l27.130" class="difflineplus">+    JASSERT(NULL != iter);</span>
<a href="#l27.131"></a><span id="l27.131" class="difflineplus">+    JASSERT(kObjectEndIterValue != iter-&gt;opaque_);</span>
<a href="#l27.132"></a><span id="l27.132" class="difflineplus">+</span>
<a href="#l27.133"></a><span id="l27.133" class="difflineplus">+    return (struct json_object*)lh_entry_v((const struct lh_entry *)iter-&gt;opaque_);</span>
<a href="#l27.134"></a><span id="l27.134" class="difflineplus">+}</span>
<a href="#l27.135"></a><span id="l27.135" class="difflineplus">+</span>
<a href="#l27.136"></a><span id="l27.136" class="difflineplus">+</span>
<a href="#l27.137"></a><span id="l27.137" class="difflineplus">+/**</span>
<a href="#l27.138"></a><span id="l27.138" class="difflineplus">+ * ****************************************************************************</span>
<a href="#l27.139"></a><span id="l27.139" class="difflineplus">+ */</span>
<a href="#l27.140"></a><span id="l27.140" class="difflineplus">+json_bool</span>
<a href="#l27.141"></a><span id="l27.141" class="difflineplus">+json_object_iter_equal(const struct json_object_iterator* iter1,</span>
<a href="#l27.142"></a><span id="l27.142" class="difflineplus">+                       const struct json_object_iterator* iter2)</span>
<a href="#l27.143"></a><span id="l27.143" class="difflineplus">+{</span>
<a href="#l27.144"></a><span id="l27.144" class="difflineplus">+    JASSERT(NULL != iter1);</span>
<a href="#l27.145"></a><span id="l27.145" class="difflineplus">+    JASSERT(NULL != iter2);</span>
<a href="#l27.146"></a><span id="l27.146" class="difflineplus">+</span>
<a href="#l27.147"></a><span id="l27.147" class="difflineplus">+    return (iter1-&gt;opaque_ == iter2-&gt;opaque_);</span>
<a href="#l27.148"></a><span id="l27.148" class="difflineplus">+}</span>
<a href="#l27.149"></a><span id="l27.149" class="difflineplus">+</span>
<a href="#l27.150"></a><span id="l27.150" class="difflineplus">+</span>
<a href="#l27.151"></a><span id="l27.151" class="difflineplus">+/**</span>
<a href="#l27.152"></a><span id="l27.152" class="difflineplus">+ * ****************************************************************************</span>
<a href="#l27.153"></a><span id="l27.153" class="difflineplus">+ */</span>
<a href="#l27.154"></a><span id="l27.154" class="difflineplus">+struct json_object_iterator</span>
<a href="#l27.155"></a><span id="l27.155" class="difflineplus">+json_object_iter_init_default(void)</span>
<a href="#l27.156"></a><span id="l27.156" class="difflineplus">+{</span>
<a href="#l27.157"></a><span id="l27.157" class="difflineplus">+    struct json_object_iterator iter;</span>
<a href="#l27.158"></a><span id="l27.158" class="difflineplus">+</span>
<a href="#l27.159"></a><span id="l27.159" class="difflineplus">+    /**</span>
<a href="#l27.160"></a><span id="l27.160" class="difflineplus">+     * @note Make this a negative, invalid value, such that</span>
<a href="#l27.161"></a><span id="l27.161" class="difflineplus">+     *       accidental access to it would likely be trapped by the</span>
<a href="#l27.162"></a><span id="l27.162" class="difflineplus">+     *       hardware as an invalid address.</span>
<a href="#l27.163"></a><span id="l27.163" class="difflineplus">+     */</span>
<a href="#l27.164"></a><span id="l27.164" class="difflineplus">+    iter.opaque_ = NULL;</span>
<a href="#l27.165"></a><span id="l27.165" class="difflineplus">+</span>
<a href="#l27.166"></a><span id="l27.166" class="difflineplus">+    return iter;</span>
<a href="#l27.167"></a><span id="l27.167" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1">new file mode 100644</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineminus">--- /dev/null</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineplus">+++ b/third_party/json-c/json_object_iterator.h</span>
<a href="#l28.4"></a><span id="l28.4" class="difflineat">@@ -0,0 +1,240 @@</span>
<a href="#l28.5"></a><span id="l28.5" class="difflineplus">+/**</span>
<a href="#l28.6"></a><span id="l28.6" class="difflineplus">+*******************************************************************************</span>
<a href="#l28.7"></a><span id="l28.7" class="difflineplus">+* @file json_object_iterator.h</span>
<a href="#l28.8"></a><span id="l28.8" class="difflineplus">+*</span>
<a href="#l28.9"></a><span id="l28.9" class="difflineplus">+* Copyright (c) 2009-2012 Hewlett-Packard Development Company, L.P.</span>
<a href="#l28.10"></a><span id="l28.10" class="difflineplus">+*</span>
<a href="#l28.11"></a><span id="l28.11" class="difflineplus">+* This library is free software; you can redistribute it and/or modify</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineplus">+* it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+*</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineplus">+* @brief  An API for iterating over json_type_object objects,</span>
<a href="#l28.15"></a><span id="l28.15" class="difflineplus">+*         styled to be familiar to C++ programmers.</span>
<a href="#l28.16"></a><span id="l28.16" class="difflineplus">+*         Unlike json_object_object_foreach() and</span>
<a href="#l28.17"></a><span id="l28.17" class="difflineplus">+*         json_object_object_foreachC(), this avoids the need to expose</span>
<a href="#l28.18"></a><span id="l28.18" class="difflineplus">+*         json-c internals like lh_entry.</span>
<a href="#l28.19"></a><span id="l28.19" class="difflineplus">+*</span>
<a href="#l28.20"></a><span id="l28.20" class="difflineplus">+* API attributes: &lt;br&gt;</span>
<a href="#l28.21"></a><span id="l28.21" class="difflineplus">+*   * Thread-safe: NO&lt;br&gt;</span>
<a href="#l28.22"></a><span id="l28.22" class="difflineplus">+*   * Reentrant: NO</span>
<a href="#l28.23"></a><span id="l28.23" class="difflineplus">+*</span>
<a href="#l28.24"></a><span id="l28.24" class="difflineplus">+*******************************************************************************</span>
<a href="#l28.25"></a><span id="l28.25" class="difflineplus">+*/</span>
<a href="#l28.26"></a><span id="l28.26" class="difflineplus">+</span>
<a href="#l28.27"></a><span id="l28.27" class="difflineplus">+</span>
<a href="#l28.28"></a><span id="l28.28" class="difflineplus">+#ifndef JSON_OBJECT_ITERATOR_H</span>
<a href="#l28.29"></a><span id="l28.29" class="difflineplus">+#define JSON_OBJECT_ITERATOR_H</span>
<a href="#l28.30"></a><span id="l28.30" class="difflineplus">+</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineplus">+#include &lt;stddef.h&gt;</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineplus">+</span>
<a href="#l28.33"></a><span id="l28.33" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l28.34"></a><span id="l28.34" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l28.35"></a><span id="l28.35" class="difflineplus">+#endif</span>
<a href="#l28.36"></a><span id="l28.36" class="difflineplus">+</span>
<a href="#l28.37"></a><span id="l28.37" class="difflineplus">+/**</span>
<a href="#l28.38"></a><span id="l28.38" class="difflineplus">+ * Forward declaration for the opaque iterator information.</span>
<a href="#l28.39"></a><span id="l28.39" class="difflineplus">+ */</span>
<a href="#l28.40"></a><span id="l28.40" class="difflineplus">+struct json_object_iter_info_;</span>
<a href="#l28.41"></a><span id="l28.41" class="difflineplus">+</span>
<a href="#l28.42"></a><span id="l28.42" class="difflineplus">+/**</span>
<a href="#l28.43"></a><span id="l28.43" class="difflineplus">+ * The opaque iterator that references a name/value pair within</span>
<a href="#l28.44"></a><span id="l28.44" class="difflineplus">+ * a JSON Object instance or the &quot;end&quot; iterator value.</span>
<a href="#l28.45"></a><span id="l28.45" class="difflineplus">+ */</span>
<a href="#l28.46"></a><span id="l28.46" class="difflineplus">+struct json_object_iterator {</span>
<a href="#l28.47"></a><span id="l28.47" class="difflineplus">+    const void* opaque_;</span>
<a href="#l28.48"></a><span id="l28.48" class="difflineplus">+};</span>
<a href="#l28.49"></a><span id="l28.49" class="difflineplus">+</span>
<a href="#l28.50"></a><span id="l28.50" class="difflineplus">+</span>
<a href="#l28.51"></a><span id="l28.51" class="difflineplus">+/**</span>
<a href="#l28.52"></a><span id="l28.52" class="difflineplus">+ * forward declaration of json-c's JSON value instance structure</span>
<a href="#l28.53"></a><span id="l28.53" class="difflineplus">+ */</span>
<a href="#l28.54"></a><span id="l28.54" class="difflineplus">+struct json_object;</span>
<a href="#l28.55"></a><span id="l28.55" class="difflineplus">+</span>
<a href="#l28.56"></a><span id="l28.56" class="difflineplus">+</span>
<a href="#l28.57"></a><span id="l28.57" class="difflineplus">+/**</span>
<a href="#l28.58"></a><span id="l28.58" class="difflineplus">+ * Initializes an iterator structure to a &quot;default&quot; value that</span>
<a href="#l28.59"></a><span id="l28.59" class="difflineplus">+ * is convenient for initializing an iterator variable to a</span>
<a href="#l28.60"></a><span id="l28.60" class="difflineplus">+ * default state (e.g., initialization list in a class'</span>
<a href="#l28.61"></a><span id="l28.61" class="difflineplus">+ * constructor).</span>
<a href="#l28.62"></a><span id="l28.62" class="difflineplus">+ *</span>
<a href="#l28.63"></a><span id="l28.63" class="difflineplus">+ * @code</span>
<a href="#l28.64"></a><span id="l28.64" class="difflineplus">+ * struct json_object_iterator iter = json_object_iter_init_default();</span>
<a href="#l28.65"></a><span id="l28.65" class="difflineplus">+ * MyClass() : iter_(json_object_iter_init_default())</span>
<a href="#l28.66"></a><span id="l28.66" class="difflineplus">+ * @endcode</span>
<a href="#l28.67"></a><span id="l28.67" class="difflineplus">+ *</span>
<a href="#l28.68"></a><span id="l28.68" class="difflineplus">+ * @note The initialized value doesn't reference any specific</span>
<a href="#l28.69"></a><span id="l28.69" class="difflineplus">+ *       pair, is considered an invalid iterator, and MUST NOT</span>
<a href="#l28.70"></a><span id="l28.70" class="difflineplus">+ *       be passed to any json-c API that expects a valid</span>
<a href="#l28.71"></a><span id="l28.71" class="difflineplus">+ *       iterator.</span>
<a href="#l28.72"></a><span id="l28.72" class="difflineplus">+ *</span>
<a href="#l28.73"></a><span id="l28.73" class="difflineplus">+ * @note User and internal code MUST NOT make any assumptions</span>
<a href="#l28.74"></a><span id="l28.74" class="difflineplus">+ *       about and dependencies on the value of the &quot;default&quot;</span>
<a href="#l28.75"></a><span id="l28.75" class="difflineplus">+ *       iterator value.</span>
<a href="#l28.76"></a><span id="l28.76" class="difflineplus">+ *</span>
<a href="#l28.77"></a><span id="l28.77" class="difflineplus">+ * @return json_object_iterator</span>
<a href="#l28.78"></a><span id="l28.78" class="difflineplus">+ */</span>
<a href="#l28.79"></a><span id="l28.79" class="difflineplus">+struct json_object_iterator</span>
<a href="#l28.80"></a><span id="l28.80" class="difflineplus">+json_object_iter_init_default(void);</span>
<a href="#l28.81"></a><span id="l28.81" class="difflineplus">+</span>
<a href="#l28.82"></a><span id="l28.82" class="difflineplus">+/** Retrieves an iterator to the first pair of the JSON Object.</span>
<a href="#l28.83"></a><span id="l28.83" class="difflineplus">+ *</span>
<a href="#l28.84"></a><span id="l28.84" class="difflineplus">+ * @warning 	Any modification of the underlying pair invalidates all</span>
<a href="#l28.85"></a><span id="l28.85" class="difflineplus">+ * 		iterators to that pair.</span>
<a href="#l28.86"></a><span id="l28.86" class="difflineplus">+ *</span>
<a href="#l28.87"></a><span id="l28.87" class="difflineplus">+ * @param obj	JSON Object instance (MUST be of type json_object)</span>
<a href="#l28.88"></a><span id="l28.88" class="difflineplus">+ *</span>
<a href="#l28.89"></a><span id="l28.89" class="difflineplus">+ * @return json_object_iterator If the JSON Object has at</span>
<a href="#l28.90"></a><span id="l28.90" class="difflineplus">+ *              least one pair, on return, the iterator refers</span>
<a href="#l28.91"></a><span id="l28.91" class="difflineplus">+ *              to the first pair. If the JSON Object doesn't</span>
<a href="#l28.92"></a><span id="l28.92" class="difflineplus">+ *              have any pairs, the returned iterator is</span>
<a href="#l28.93"></a><span id="l28.93" class="difflineplus">+ *              equivalent to the &quot;end&quot; iterator for the same</span>
<a href="#l28.94"></a><span id="l28.94" class="difflineplus">+ *              JSON Object instance.</span>
<a href="#l28.95"></a><span id="l28.95" class="difflineplus">+ *</span>
<a href="#l28.96"></a><span id="l28.96" class="difflineplus">+ * @code</span>
<a href="#l28.97"></a><span id="l28.97" class="difflineplus">+ * struct json_object_iterator it;</span>
<a href="#l28.98"></a><span id="l28.98" class="difflineplus">+ * struct json_object_iterator itEnd;</span>
<a href="#l28.99"></a><span id="l28.99" class="difflineplus">+ * struct json_object* obj;</span>
<a href="#l28.100"></a><span id="l28.100" class="difflineplus">+ *</span>
<a href="#l28.101"></a><span id="l28.101" class="difflineplus">+ * obj = json_tokener_parse(&quot;{'first':'george', 'age':100}&quot;);</span>
<a href="#l28.102"></a><span id="l28.102" class="difflineplus">+ * it = json_object_iter_begin(obj);</span>
<a href="#l28.103"></a><span id="l28.103" class="difflineplus">+ * itEnd = json_object_iter_end(obj);</span>
<a href="#l28.104"></a><span id="l28.104" class="difflineplus">+ *</span>
<a href="#l28.105"></a><span id="l28.105" class="difflineplus">+ * while (!json_object_iter_equal(&amp;it, &amp;itEnd)) {</span>
<a href="#l28.106"></a><span id="l28.106" class="difflineplus">+ *     printf(&quot;%s\n&quot;,</span>
<a href="#l28.107"></a><span id="l28.107" class="difflineplus">+ *            json_object_iter_peek_name(&amp;it));</span>
<a href="#l28.108"></a><span id="l28.108" class="difflineplus">+ *     json_object_iter_next(&amp;it);</span>
<a href="#l28.109"></a><span id="l28.109" class="difflineplus">+ * }</span>
<a href="#l28.110"></a><span id="l28.110" class="difflineplus">+ *</span>
<a href="#l28.111"></a><span id="l28.111" class="difflineplus">+ * @endcode</span>
<a href="#l28.112"></a><span id="l28.112" class="difflineplus">+ */</span>
<a href="#l28.113"></a><span id="l28.113" class="difflineplus">+struct json_object_iterator</span>
<a href="#l28.114"></a><span id="l28.114" class="difflineplus">+json_object_iter_begin(struct json_object* obj);</span>
<a href="#l28.115"></a><span id="l28.115" class="difflineplus">+</span>
<a href="#l28.116"></a><span id="l28.116" class="difflineplus">+/** Retrieves the iterator that represents the position beyond the</span>
<a href="#l28.117"></a><span id="l28.117" class="difflineplus">+ *  last pair of the given JSON Object instance.</span>
<a href="#l28.118"></a><span id="l28.118" class="difflineplus">+ *</span>
<a href="#l28.119"></a><span id="l28.119" class="difflineplus">+ *  @warning Do NOT write code that assumes that the &quot;end&quot;</span>
<a href="#l28.120"></a><span id="l28.120" class="difflineplus">+ *        iterator value is NULL, even if it is so in a</span>
<a href="#l28.121"></a><span id="l28.121" class="difflineplus">+ *        particular instance of the implementation.</span>
<a href="#l28.122"></a><span id="l28.122" class="difflineplus">+ *</span>
<a href="#l28.123"></a><span id="l28.123" class="difflineplus">+ *  @note The reason we do not (and MUST NOT) provide</span>
<a href="#l28.124"></a><span id="l28.124" class="difflineplus">+ *        &quot;json_object_iter_is_end(json_object_iterator* iter)&quot;</span>
<a href="#l28.125"></a><span id="l28.125" class="difflineplus">+ *        type of API is because it would limit the underlying</span>
<a href="#l28.126"></a><span id="l28.126" class="difflineplus">+ *        representation of name/value containment (or force us</span>
<a href="#l28.127"></a><span id="l28.127" class="difflineplus">+ *        to add additional, otherwise unnecessary, fields to</span>
<a href="#l28.128"></a><span id="l28.128" class="difflineplus">+ *        the iterator structure). The &quot;end&quot; iterator and the</span>
<a href="#l28.129"></a><span id="l28.129" class="difflineplus">+ *        equality test method, on the other hand, permit us to</span>
<a href="#l28.130"></a><span id="l28.130" class="difflineplus">+ *        cleanly abstract pretty much any reasonable underlying</span>
<a href="#l28.131"></a><span id="l28.131" class="difflineplus">+ *        representation without burdening the iterator</span>
<a href="#l28.132"></a><span id="l28.132" class="difflineplus">+ *        structure with unnecessary data.</span>
<a href="#l28.133"></a><span id="l28.133" class="difflineplus">+ *</span>
<a href="#l28.134"></a><span id="l28.134" class="difflineplus">+ *  @note For performance reasons, memorize the &quot;end&quot; iterator prior</span>
<a href="#l28.135"></a><span id="l28.135" class="difflineplus">+ *        to any loop.</span>
<a href="#l28.136"></a><span id="l28.136" class="difflineplus">+ *</span>
<a href="#l28.137"></a><span id="l28.137" class="difflineplus">+ * @param obj JSON Object instance (MUST be of type json_object)</span>
<a href="#l28.138"></a><span id="l28.138" class="difflineplus">+ *</span>
<a href="#l28.139"></a><span id="l28.139" class="difflineplus">+ * @return json_object_iterator On return, the iterator refers</span>
<a href="#l28.140"></a><span id="l28.140" class="difflineplus">+ *              to the &quot;end&quot; of the Object instance's pairs</span>
<a href="#l28.141"></a><span id="l28.141" class="difflineplus">+ *              (i.e., NOT the last pair, but &quot;beyond the last</span>
<a href="#l28.142"></a><span id="l28.142" class="difflineplus">+ *              pair&quot; value)</span>
<a href="#l28.143"></a><span id="l28.143" class="difflineplus">+ */</span>
<a href="#l28.144"></a><span id="l28.144" class="difflineplus">+struct json_object_iterator</span>
<a href="#l28.145"></a><span id="l28.145" class="difflineplus">+json_object_iter_end(const struct json_object* obj);</span>
<a href="#l28.146"></a><span id="l28.146" class="difflineplus">+</span>
<a href="#l28.147"></a><span id="l28.147" class="difflineplus">+/** Returns an iterator to the next pair, if any</span>
<a href="#l28.148"></a><span id="l28.148" class="difflineplus">+ *</span>
<a href="#l28.149"></a><span id="l28.149" class="difflineplus">+ * @warning	Any modification of the underlying pair</span>
<a href="#l28.150"></a><span id="l28.150" class="difflineplus">+ *       	invalidates all iterators to that pair.</span>
<a href="#l28.151"></a><span id="l28.151" class="difflineplus">+ *</span>
<a href="#l28.152"></a><span id="l28.152" class="difflineplus">+ * @param iter [IN/OUT] Pointer to iterator that references a</span>
<a href="#l28.153"></a><span id="l28.153" class="difflineplus">+ *         name/value pair; MUST be a valid, non-end iterator.</span>
<a href="#l28.154"></a><span id="l28.154" class="difflineplus">+ *         WARNING: bad things will happen if invalid or &quot;end&quot;</span>
<a href="#l28.155"></a><span id="l28.155" class="difflineplus">+ *         iterator is passed. Upon return will contain the</span>
<a href="#l28.156"></a><span id="l28.156" class="difflineplus">+ *         reference to the next pair if there is one; if there</span>
<a href="#l28.157"></a><span id="l28.157" class="difflineplus">+ *         are no more pairs, will contain the &quot;end&quot; iterator</span>
<a href="#l28.158"></a><span id="l28.158" class="difflineplus">+ *         value, which may be compared against the return value</span>
<a href="#l28.159"></a><span id="l28.159" class="difflineplus">+ *         of json_object_iter_end() for the same JSON Object</span>
<a href="#l28.160"></a><span id="l28.160" class="difflineplus">+ *         instance.</span>
<a href="#l28.161"></a><span id="l28.161" class="difflineplus">+ */</span>
<a href="#l28.162"></a><span id="l28.162" class="difflineplus">+void</span>
<a href="#l28.163"></a><span id="l28.163" class="difflineplus">+json_object_iter_next(struct json_object_iterator* iter);</span>
<a href="#l28.164"></a><span id="l28.164" class="difflineplus">+</span>
<a href="#l28.165"></a><span id="l28.165" class="difflineplus">+</span>
<a href="#l28.166"></a><span id="l28.166" class="difflineplus">+/** Returns a const pointer to the name of the pair referenced</span>
<a href="#l28.167"></a><span id="l28.167" class="difflineplus">+ *  by the given iterator.</span>
<a href="#l28.168"></a><span id="l28.168" class="difflineplus">+ *</span>
<a href="#l28.169"></a><span id="l28.169" class="difflineplus">+ * @param iter pointer to iterator that references a name/value</span>
<a href="#l28.170"></a><span id="l28.170" class="difflineplus">+ *             pair; MUST be a valid, non-end iterator.</span>
<a href="#l28.171"></a><span id="l28.171" class="difflineplus">+ *</span>
<a href="#l28.172"></a><span id="l28.172" class="difflineplus">+ * @warning	bad things will happen if an invalid or</span>
<a href="#l28.173"></a><span id="l28.173" class="difflineplus">+ *             	&quot;end&quot; iterator is passed.</span>
<a href="#l28.174"></a><span id="l28.174" class="difflineplus">+ *</span>
<a href="#l28.175"></a><span id="l28.175" class="difflineplus">+ * @return const char* Pointer to the name of the referenced</span>
<a href="#l28.176"></a><span id="l28.176" class="difflineplus">+ *         name/value pair.  The name memory belongs to the</span>
<a href="#l28.177"></a><span id="l28.177" class="difflineplus">+ *         name/value pair, will be freed when the pair is</span>
<a href="#l28.178"></a><span id="l28.178" class="difflineplus">+ *         deleted or modified, and MUST NOT be modified or</span>
<a href="#l28.179"></a><span id="l28.179" class="difflineplus">+ *         freed by the user.</span>
<a href="#l28.180"></a><span id="l28.180" class="difflineplus">+ */</span>
<a href="#l28.181"></a><span id="l28.181" class="difflineplus">+const char*</span>
<a href="#l28.182"></a><span id="l28.182" class="difflineplus">+json_object_iter_peek_name(const struct json_object_iterator* iter);</span>
<a href="#l28.183"></a><span id="l28.183" class="difflineplus">+</span>
<a href="#l28.184"></a><span id="l28.184" class="difflineplus">+</span>
<a href="#l28.185"></a><span id="l28.185" class="difflineplus">+/** Returns a pointer to the json-c instance representing the</span>
<a href="#l28.186"></a><span id="l28.186" class="difflineplus">+ *  value of the referenced name/value pair, without altering</span>
<a href="#l28.187"></a><span id="l28.187" class="difflineplus">+ *  the instance's reference count.</span>
<a href="#l28.188"></a><span id="l28.188" class="difflineplus">+ *</span>
<a href="#l28.189"></a><span id="l28.189" class="difflineplus">+ * @param iter 	pointer to iterator that references a name/value</span>
<a href="#l28.190"></a><span id="l28.190" class="difflineplus">+ *             	pair; MUST be a valid, non-end iterator.</span>
<a href="#l28.191"></a><span id="l28.191" class="difflineplus">+ *</span>
<a href="#l28.192"></a><span id="l28.192" class="difflineplus">+ * @warning	bad things will happen if invalid or</span>
<a href="#l28.193"></a><span id="l28.193" class="difflineplus">+ *             &quot;end&quot; iterator is passed.</span>
<a href="#l28.194"></a><span id="l28.194" class="difflineplus">+ *</span>
<a href="#l28.195"></a><span id="l28.195" class="difflineplus">+ * @return struct json_object* Pointer to the json-c value</span>
<a href="#l28.196"></a><span id="l28.196" class="difflineplus">+ *         instance of the referenced name/value pair;  the</span>
<a href="#l28.197"></a><span id="l28.197" class="difflineplus">+ *         value's reference count is not changed by this</span>
<a href="#l28.198"></a><span id="l28.198" class="difflineplus">+ *         function: if you plan to hold on to this json-c node,</span>
<a href="#l28.199"></a><span id="l28.199" class="difflineplus">+ *         take a look at json_object_get() and</span>
<a href="#l28.200"></a><span id="l28.200" class="difflineplus">+ *         json_object_put(). IMPORTANT: json-c API represents</span>
<a href="#l28.201"></a><span id="l28.201" class="difflineplus">+ *         the JSON Null value as a NULL json_object instance</span>
<a href="#l28.202"></a><span id="l28.202" class="difflineplus">+ *         pointer.</span>
<a href="#l28.203"></a><span id="l28.203" class="difflineplus">+ */</span>
<a href="#l28.204"></a><span id="l28.204" class="difflineplus">+struct json_object*</span>
<a href="#l28.205"></a><span id="l28.205" class="difflineplus">+json_object_iter_peek_value(const struct json_object_iterator* iter);</span>
<a href="#l28.206"></a><span id="l28.206" class="difflineplus">+</span>
<a href="#l28.207"></a><span id="l28.207" class="difflineplus">+</span>
<a href="#l28.208"></a><span id="l28.208" class="difflineplus">+/** Tests two iterators for equality.  Typically used to test</span>
<a href="#l28.209"></a><span id="l28.209" class="difflineplus">+ *  for end of iteration by comparing an iterator to the</span>
<a href="#l28.210"></a><span id="l28.210" class="difflineplus">+ *  corresponding &quot;end&quot; iterator (that was derived from the same</span>
<a href="#l28.211"></a><span id="l28.211" class="difflineplus">+ *  JSON Object instance).</span>
<a href="#l28.212"></a><span id="l28.212" class="difflineplus">+ *</span>
<a href="#l28.213"></a><span id="l28.213" class="difflineplus">+ *  @note The reason we do not (and MUST NOT) provide</span>
<a href="#l28.214"></a><span id="l28.214" class="difflineplus">+ *        &quot;json_object_iter_is_end(json_object_iterator* iter)&quot;</span>
<a href="#l28.215"></a><span id="l28.215" class="difflineplus">+ *        type of API is because it would limit the underlying</span>
<a href="#l28.216"></a><span id="l28.216" class="difflineplus">+ *        representation of name/value containment (or force us</span>
<a href="#l28.217"></a><span id="l28.217" class="difflineplus">+ *        to add additional, otherwise unnecessary, fields to</span>
<a href="#l28.218"></a><span id="l28.218" class="difflineplus">+ *        the iterator structure). The equality test method, on</span>
<a href="#l28.219"></a><span id="l28.219" class="difflineplus">+ *        the other hand, permits us to cleanly abstract pretty</span>
<a href="#l28.220"></a><span id="l28.220" class="difflineplus">+ *        much any reasonable underlying representation.</span>
<a href="#l28.221"></a><span id="l28.221" class="difflineplus">+ *</span>
<a href="#l28.222"></a><span id="l28.222" class="difflineplus">+ * @param iter1 Pointer to first valid, non-NULL iterator</span>
<a href="#l28.223"></a><span id="l28.223" class="difflineplus">+ * @param iter2 POinter to second valid, non-NULL iterator</span>
<a href="#l28.224"></a><span id="l28.224" class="difflineplus">+ *</span>
<a href="#l28.225"></a><span id="l28.225" class="difflineplus">+ * @warning	if a NULL iterator pointer or an uninitialized</span>
<a href="#l28.226"></a><span id="l28.226" class="difflineplus">+ *       	or invalid iterator, or iterators derived from</span>
<a href="#l28.227"></a><span id="l28.227" class="difflineplus">+ *       	different JSON Object instances are passed, bad things</span>
<a href="#l28.228"></a><span id="l28.228" class="difflineplus">+ *       	will happen!</span>
<a href="#l28.229"></a><span id="l28.229" class="difflineplus">+ *</span>
<a href="#l28.230"></a><span id="l28.230" class="difflineplus">+ * @return json_bool non-zero if iterators are equal (i.e., both</span>
<a href="#l28.231"></a><span id="l28.231" class="difflineplus">+ *         reference the same name/value pair or are both at</span>
<a href="#l28.232"></a><span id="l28.232" class="difflineplus">+ *         &quot;end&quot;); zero if they are not equal.</span>
<a href="#l28.233"></a><span id="l28.233" class="difflineplus">+ */</span>
<a href="#l28.234"></a><span id="l28.234" class="difflineplus">+json_bool</span>
<a href="#l28.235"></a><span id="l28.235" class="difflineplus">+json_object_iter_equal(const struct json_object_iterator* iter1,</span>
<a href="#l28.236"></a><span id="l28.236" class="difflineplus">+                       const struct json_object_iterator* iter2);</span>
<a href="#l28.237"></a><span id="l28.237" class="difflineplus">+</span>
<a href="#l28.238"></a><span id="l28.238" class="difflineplus">+</span>
<a href="#l28.239"></a><span id="l28.239" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l28.240"></a><span id="l28.240" class="difflineplus">+}</span>
<a href="#l28.241"></a><span id="l28.241" class="difflineplus">+#endif</span>
<a href="#l28.242"></a><span id="l28.242" class="difflineplus">+</span>
<a href="#l28.243"></a><span id="l28.243" class="difflineplus">+</span>
<a href="#l28.244"></a><span id="l28.244" class="difflineplus">+#endif /* JSON_OBJECT_ITERATOR_H */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1">new file mode 100644</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineminus">--- /dev/null</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineplus">+++ b/third_party/json-c/json_object_private.h</span>
<a href="#l29.4"></a><span id="l29.4" class="difflineat">@@ -0,0 +1,64 @@</span>
<a href="#l29.5"></a><span id="l29.5" class="difflineplus">+/*</span>
<a href="#l29.6"></a><span id="l29.6" class="difflineplus">+ * $Id: json_object_private.h,v 1.4 2006/01/26 02:16:28 mclark Exp $</span>
<a href="#l29.7"></a><span id="l29.7" class="difflineplus">+ *</span>
<a href="#l29.8"></a><span id="l29.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l29.9"></a><span id="l29.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l29.10"></a><span id="l29.10" class="difflineplus">+ *</span>
<a href="#l29.11"></a><span id="l29.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+ *</span>
<a href="#l29.14"></a><span id="l29.14" class="difflineplus">+ */</span>
<a href="#l29.15"></a><span id="l29.15" class="difflineplus">+</span>
<a href="#l29.16"></a><span id="l29.16" class="difflineplus">+/**</span>
<a href="#l29.17"></a><span id="l29.17" class="difflineplus">+ * @file</span>
<a href="#l29.18"></a><span id="l29.18" class="difflineplus">+ * @brief Do not use, json-c internal, may be changed or removed at any time.</span>
<a href="#l29.19"></a><span id="l29.19" class="difflineplus">+ */</span>
<a href="#l29.20"></a><span id="l29.20" class="difflineplus">+#ifndef _json_object_private_h_</span>
<a href="#l29.21"></a><span id="l29.21" class="difflineplus">+#define _json_object_private_h_</span>
<a href="#l29.22"></a><span id="l29.22" class="difflineplus">+</span>
<a href="#l29.23"></a><span id="l29.23" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l29.24"></a><span id="l29.24" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l29.25"></a><span id="l29.25" class="difflineplus">+#endif</span>
<a href="#l29.26"></a><span id="l29.26" class="difflineplus">+</span>
<a href="#l29.27"></a><span id="l29.27" class="difflineplus">+#define LEN_DIRECT_STRING_DATA 32 /**&lt; how many bytes are directly stored in json_object for strings? */</span>
<a href="#l29.28"></a><span id="l29.28" class="difflineplus">+</span>
<a href="#l29.29"></a><span id="l29.29" class="difflineplus">+typedef void (json_object_private_delete_fn)(struct json_object *o);</span>
<a href="#l29.30"></a><span id="l29.30" class="difflineplus">+</span>
<a href="#l29.31"></a><span id="l29.31" class="difflineplus">+struct json_object</span>
<a href="#l29.32"></a><span id="l29.32" class="difflineplus">+{</span>
<a href="#l29.33"></a><span id="l29.33" class="difflineplus">+  enum json_type o_type;</span>
<a href="#l29.34"></a><span id="l29.34" class="difflineplus">+  json_object_private_delete_fn *_delete;</span>
<a href="#l29.35"></a><span id="l29.35" class="difflineplus">+  json_object_to_json_string_fn *_to_json_string;</span>
<a href="#l29.36"></a><span id="l29.36" class="difflineplus">+  int _ref_count;</span>
<a href="#l29.37"></a><span id="l29.37" class="difflineplus">+  struct printbuf *_pb;</span>
<a href="#l29.38"></a><span id="l29.38" class="difflineplus">+  union data {</span>
<a href="#l29.39"></a><span id="l29.39" class="difflineplus">+    json_bool c_boolean;</span>
<a href="#l29.40"></a><span id="l29.40" class="difflineplus">+    double c_double;</span>
<a href="#l29.41"></a><span id="l29.41" class="difflineplus">+    int64_t c_int64;</span>
<a href="#l29.42"></a><span id="l29.42" class="difflineplus">+    struct lh_table *c_object;</span>
<a href="#l29.43"></a><span id="l29.43" class="difflineplus">+    struct array_list *c_array;</span>
<a href="#l29.44"></a><span id="l29.44" class="difflineplus">+    struct {</span>
<a href="#l29.45"></a><span id="l29.45" class="difflineplus">+	union {</span>
<a href="#l29.46"></a><span id="l29.46" class="difflineplus">+		/* optimize: if we have small strings, we can store them</span>
<a href="#l29.47"></a><span id="l29.47" class="difflineplus">+		 * directly. This saves considerable CPU cycles AND memory.</span>
<a href="#l29.48"></a><span id="l29.48" class="difflineplus">+		 */</span>
<a href="#l29.49"></a><span id="l29.49" class="difflineplus">+		char *ptr;</span>
<a href="#l29.50"></a><span id="l29.50" class="difflineplus">+		char data[LEN_DIRECT_STRING_DATA];</span>
<a href="#l29.51"></a><span id="l29.51" class="difflineplus">+	} str;</span>
<a href="#l29.52"></a><span id="l29.52" class="difflineplus">+        int len;</span>
<a href="#l29.53"></a><span id="l29.53" class="difflineplus">+    } c_string;</span>
<a href="#l29.54"></a><span id="l29.54" class="difflineplus">+  } o;</span>
<a href="#l29.55"></a><span id="l29.55" class="difflineplus">+  json_object_delete_fn *_user_delete;</span>
<a href="#l29.56"></a><span id="l29.56" class="difflineplus">+  void *_userdata;</span>
<a href="#l29.57"></a><span id="l29.57" class="difflineplus">+};</span>
<a href="#l29.58"></a><span id="l29.58" class="difflineplus">+</span>
<a href="#l29.59"></a><span id="l29.59" class="difflineplus">+void _json_c_set_last_err(const char *err_fmt, ...);</span>
<a href="#l29.60"></a><span id="l29.60" class="difflineplus">+</span>
<a href="#l29.61"></a><span id="l29.61" class="difflineplus">+extern const char *json_number_chars;</span>
<a href="#l29.62"></a><span id="l29.62" class="difflineplus">+extern const char *json_hex_chars;</span>
<a href="#l29.63"></a><span id="l29.63" class="difflineplus">+</span>
<a href="#l29.64"></a><span id="l29.64" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l29.65"></a><span id="l29.65" class="difflineplus">+}</span>
<a href="#l29.66"></a><span id="l29.66" class="difflineplus">+#endif</span>
<a href="#l29.67"></a><span id="l29.67" class="difflineplus">+</span>
<a href="#l29.68"></a><span id="l29.68" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1">new file mode 100644</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineminus">--- /dev/null</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineplus">+++ b/third_party/json-c/json_pointer.c</span>
<a href="#l30.4"></a><span id="l30.4" class="difflineat">@@ -0,0 +1,327 @@</span>
<a href="#l30.5"></a><span id="l30.5" class="difflineplus">+/*</span>
<a href="#l30.6"></a><span id="l30.6" class="difflineplus">+ * Copyright (c) 2016 Alexandru Ardelean.</span>
<a href="#l30.7"></a><span id="l30.7" class="difflineplus">+ *</span>
<a href="#l30.8"></a><span id="l30.8" class="difflineplus">+ * This is free software; you can redistribute it and/or modify</span>
<a href="#l30.9"></a><span id="l30.9" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l30.10"></a><span id="l30.10" class="difflineplus">+ *</span>
<a href="#l30.11"></a><span id="l30.11" class="difflineplus">+ */</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineplus">+</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineplus">+</span>
<a href="#l30.15"></a><span id="l30.15" class="difflineplus">+#include &quot;strerror_override.h&quot;</span>
<a href="#l30.16"></a><span id="l30.16" class="difflineplus">+</span>
<a href="#l30.17"></a><span id="l30.17" class="difflineplus">+#include &lt;stdarg.h&gt;</span>
<a href="#l30.18"></a><span id="l30.18" class="difflineplus">+#include &lt;stdio.h&gt;</span>
<a href="#l30.19"></a><span id="l30.19" class="difflineplus">+#include &lt;stdlib.h&gt;</span>
<a href="#l30.20"></a><span id="l30.20" class="difflineplus">+#include &lt;string.h&gt;</span>
<a href="#l30.21"></a><span id="l30.21" class="difflineplus">+#include &lt;ctype.h&gt;</span>
<a href="#l30.22"></a><span id="l30.22" class="difflineplus">+</span>
<a href="#l30.23"></a><span id="l30.23" class="difflineplus">+#include &quot;json_pointer.h&quot;</span>
<a href="#l30.24"></a><span id="l30.24" class="difflineplus">+#include &quot;strdup_compat.h&quot;</span>
<a href="#l30.25"></a><span id="l30.25" class="difflineplus">+#include &quot;vasprintf_compat.h&quot;</span>
<a href="#l30.26"></a><span id="l30.26" class="difflineplus">+</span>
<a href="#l30.27"></a><span id="l30.27" class="difflineplus">+/**</span>
<a href="#l30.28"></a><span id="l30.28" class="difflineplus">+ * JavaScript Object Notation (JSON) Pointer</span>
<a href="#l30.29"></a><span id="l30.29" class="difflineplus">+ *   RFC 6901 - https://tools.ietf.org/html/rfc6901</span>
<a href="#l30.30"></a><span id="l30.30" class="difflineplus">+ */</span>
<a href="#l30.31"></a><span id="l30.31" class="difflineplus">+</span>
<a href="#l30.32"></a><span id="l30.32" class="difflineplus">+static void string_replace_all_occurrences_with_char(char *s, const char *occur, char repl_char)</span>
<a href="#l30.33"></a><span id="l30.33" class="difflineplus">+{</span>
<a href="#l30.34"></a><span id="l30.34" class="difflineplus">+	int slen = strlen(s);</span>
<a href="#l30.35"></a><span id="l30.35" class="difflineplus">+	int skip = strlen(occur) - 1; /* length of the occurence, minus the char we're replacing */</span>
<a href="#l30.36"></a><span id="l30.36" class="difflineplus">+	char *p = s;</span>
<a href="#l30.37"></a><span id="l30.37" class="difflineplus">+	while ((p = strstr(p, occur))) {</span>
<a href="#l30.38"></a><span id="l30.38" class="difflineplus">+		*p = repl_char;</span>
<a href="#l30.39"></a><span id="l30.39" class="difflineplus">+		p++;</span>
<a href="#l30.40"></a><span id="l30.40" class="difflineplus">+		slen -= skip;</span>
<a href="#l30.41"></a><span id="l30.41" class="difflineplus">+		memmove(p, (p + skip), slen - (p - s) + 1); /* includes null char too */</span>
<a href="#l30.42"></a><span id="l30.42" class="difflineplus">+	}</span>
<a href="#l30.43"></a><span id="l30.43" class="difflineplus">+}</span>
<a href="#l30.44"></a><span id="l30.44" class="difflineplus">+</span>
<a href="#l30.45"></a><span id="l30.45" class="difflineplus">+static int is_valid_index(struct json_object *jo, const char *path, int32_t *idx)</span>
<a href="#l30.46"></a><span id="l30.46" class="difflineplus">+{</span>
<a href="#l30.47"></a><span id="l30.47" class="difflineplus">+	int i, len = strlen(path);</span>
<a href="#l30.48"></a><span id="l30.48" class="difflineplus">+	/* this code-path optimizes a bit, for when we reference the 0-9 index range in a JSON array</span>
<a href="#l30.49"></a><span id="l30.49" class="difflineplus">+	   and because leading zeros not allowed */</span>
<a href="#l30.50"></a><span id="l30.50" class="difflineplus">+	if (len == 1) {</span>
<a href="#l30.51"></a><span id="l30.51" class="difflineplus">+		if (isdigit((int)path[0])) {</span>
<a href="#l30.52"></a><span id="l30.52" class="difflineplus">+			*idx = (path[0] - '0');</span>
<a href="#l30.53"></a><span id="l30.53" class="difflineplus">+			goto check_oob;</span>
<a href="#l30.54"></a><span id="l30.54" class="difflineplus">+		}</span>
<a href="#l30.55"></a><span id="l30.55" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l30.56"></a><span id="l30.56" class="difflineplus">+		return 0;</span>
<a href="#l30.57"></a><span id="l30.57" class="difflineplus">+	}</span>
<a href="#l30.58"></a><span id="l30.58" class="difflineplus">+	/* leading zeros not allowed per RFC */</span>
<a href="#l30.59"></a><span id="l30.59" class="difflineplus">+	if (path[0] == '0') {</span>
<a href="#l30.60"></a><span id="l30.60" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l30.61"></a><span id="l30.61" class="difflineplus">+		return 0;</span>
<a href="#l30.62"></a><span id="l30.62" class="difflineplus">+	}</span>
<a href="#l30.63"></a><span id="l30.63" class="difflineplus">+	/* RFC states base-10 decimals */</span>
<a href="#l30.64"></a><span id="l30.64" class="difflineplus">+	for (i = 0; i &lt; len; i++) {</span>
<a href="#l30.65"></a><span id="l30.65" class="difflineplus">+		if (!isdigit((int)path[i])) {</span>
<a href="#l30.66"></a><span id="l30.66" class="difflineplus">+			errno = EINVAL;</span>
<a href="#l30.67"></a><span id="l30.67" class="difflineplus">+			return 0;</span>
<a href="#l30.68"></a><span id="l30.68" class="difflineplus">+		}</span>
<a href="#l30.69"></a><span id="l30.69" class="difflineplus">+	}</span>
<a href="#l30.70"></a><span id="l30.70" class="difflineplus">+</span>
<a href="#l30.71"></a><span id="l30.71" class="difflineplus">+	*idx = strtol(path, NULL, 10);</span>
<a href="#l30.72"></a><span id="l30.72" class="difflineplus">+	if (*idx &lt; 0) {</span>
<a href="#l30.73"></a><span id="l30.73" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l30.74"></a><span id="l30.74" class="difflineplus">+		return 0;</span>
<a href="#l30.75"></a><span id="l30.75" class="difflineplus">+	}</span>
<a href="#l30.76"></a><span id="l30.76" class="difflineplus">+check_oob:</span>
<a href="#l30.77"></a><span id="l30.77" class="difflineplus">+	len = json_object_array_length(jo);</span>
<a href="#l30.78"></a><span id="l30.78" class="difflineplus">+	if (*idx &gt;= len) {</span>
<a href="#l30.79"></a><span id="l30.79" class="difflineplus">+		errno = ENOENT;</span>
<a href="#l30.80"></a><span id="l30.80" class="difflineplus">+		return 0;</span>
<a href="#l30.81"></a><span id="l30.81" class="difflineplus">+	}</span>
<a href="#l30.82"></a><span id="l30.82" class="difflineplus">+</span>
<a href="#l30.83"></a><span id="l30.83" class="difflineplus">+	return 1;</span>
<a href="#l30.84"></a><span id="l30.84" class="difflineplus">+}</span>
<a href="#l30.85"></a><span id="l30.85" class="difflineplus">+</span>
<a href="#l30.86"></a><span id="l30.86" class="difflineplus">+static int json_pointer_get_single_path(struct json_object *obj, char *path, struct json_object **value)</span>
<a href="#l30.87"></a><span id="l30.87" class="difflineplus">+{</span>
<a href="#l30.88"></a><span id="l30.88" class="difflineplus">+	if (json_object_is_type(obj, json_type_array)) {</span>
<a href="#l30.89"></a><span id="l30.89" class="difflineplus">+		int32_t idx;</span>
<a href="#l30.90"></a><span id="l30.90" class="difflineplus">+		if (!is_valid_index(obj, path, &amp;idx))</span>
<a href="#l30.91"></a><span id="l30.91" class="difflineplus">+			return -1;</span>
<a href="#l30.92"></a><span id="l30.92" class="difflineplus">+		obj = json_object_array_get_idx(obj, idx);</span>
<a href="#l30.93"></a><span id="l30.93" class="difflineplus">+		if (obj) {</span>
<a href="#l30.94"></a><span id="l30.94" class="difflineplus">+			if (value)</span>
<a href="#l30.95"></a><span id="l30.95" class="difflineplus">+				*value = obj;</span>
<a href="#l30.96"></a><span id="l30.96" class="difflineplus">+			return 0;</span>
<a href="#l30.97"></a><span id="l30.97" class="difflineplus">+		}</span>
<a href="#l30.98"></a><span id="l30.98" class="difflineplus">+		/* Entry not found */</span>
<a href="#l30.99"></a><span id="l30.99" class="difflineplus">+		errno = ENOENT;</span>
<a href="#l30.100"></a><span id="l30.100" class="difflineplus">+		return -1;</span>
<a href="#l30.101"></a><span id="l30.101" class="difflineplus">+	}</span>
<a href="#l30.102"></a><span id="l30.102" class="difflineplus">+</span>
<a href="#l30.103"></a><span id="l30.103" class="difflineplus">+	/* RFC states that we first must eval all ~1 then all ~0 */</span>
<a href="#l30.104"></a><span id="l30.104" class="difflineplus">+	string_replace_all_occurrences_with_char(path, &quot;~1&quot;, '/');</span>
<a href="#l30.105"></a><span id="l30.105" class="difflineplus">+	string_replace_all_occurrences_with_char(path, &quot;~0&quot;, '~');</span>
<a href="#l30.106"></a><span id="l30.106" class="difflineplus">+</span>
<a href="#l30.107"></a><span id="l30.107" class="difflineplus">+	if (!json_object_object_get_ex(obj, path, value)) {</span>
<a href="#l30.108"></a><span id="l30.108" class="difflineplus">+		errno = ENOENT;</span>
<a href="#l30.109"></a><span id="l30.109" class="difflineplus">+		return -1;</span>
<a href="#l30.110"></a><span id="l30.110" class="difflineplus">+	}</span>
<a href="#l30.111"></a><span id="l30.111" class="difflineplus">+</span>
<a href="#l30.112"></a><span id="l30.112" class="difflineplus">+	return 0;</span>
<a href="#l30.113"></a><span id="l30.113" class="difflineplus">+}</span>
<a href="#l30.114"></a><span id="l30.114" class="difflineplus">+</span>
<a href="#l30.115"></a><span id="l30.115" class="difflineplus">+static int json_pointer_set_single_path(</span>
<a href="#l30.116"></a><span id="l30.116" class="difflineplus">+	struct json_object *parent,</span>
<a href="#l30.117"></a><span id="l30.117" class="difflineplus">+	const char *path,</span>
<a href="#l30.118"></a><span id="l30.118" class="difflineplus">+	struct json_object *value)</span>
<a href="#l30.119"></a><span id="l30.119" class="difflineplus">+{</span>
<a href="#l30.120"></a><span id="l30.120" class="difflineplus">+	if (json_object_is_type(parent, json_type_array)) {</span>
<a href="#l30.121"></a><span id="l30.121" class="difflineplus">+		int32_t idx;</span>
<a href="#l30.122"></a><span id="l30.122" class="difflineplus">+		/* RFC (Chapter 4) states that '-' may be used to add new elements to an array */</span>
<a href="#l30.123"></a><span id="l30.123" class="difflineplus">+		if (path[0] == '-' &amp;&amp; path[1] == '\0')</span>
<a href="#l30.124"></a><span id="l30.124" class="difflineplus">+			return json_object_array_add(parent, value);</span>
<a href="#l30.125"></a><span id="l30.125" class="difflineplus">+		if (!is_valid_index(parent, path, &amp;idx))</span>
<a href="#l30.126"></a><span id="l30.126" class="difflineplus">+			return -1;</span>
<a href="#l30.127"></a><span id="l30.127" class="difflineplus">+		return json_object_array_put_idx(parent, idx, value);</span>
<a href="#l30.128"></a><span id="l30.128" class="difflineplus">+	}</span>
<a href="#l30.129"></a><span id="l30.129" class="difflineplus">+</span>
<a href="#l30.130"></a><span id="l30.130" class="difflineplus">+	/* path replacements should have been done in json_pointer_get_single_path(),</span>
<a href="#l30.131"></a><span id="l30.131" class="difflineplus">+	   and we should still be good here */</span>
<a href="#l30.132"></a><span id="l30.132" class="difflineplus">+	if (json_object_is_type(parent, json_type_object))</span>
<a href="#l30.133"></a><span id="l30.133" class="difflineplus">+		return json_object_object_add(parent, path, value);</span>
<a href="#l30.134"></a><span id="l30.134" class="difflineplus">+</span>
<a href="#l30.135"></a><span id="l30.135" class="difflineplus">+	/* Getting here means that we tried to &quot;dereference&quot; a primitive JSON type (like string, int, bool).</span>
<a href="#l30.136"></a><span id="l30.136" class="difflineplus">+	   i.e. add a sub-object to it */</span>
<a href="#l30.137"></a><span id="l30.137" class="difflineplus">+	errno = ENOENT;</span>
<a href="#l30.138"></a><span id="l30.138" class="difflineplus">+	return -1;</span>
<a href="#l30.139"></a><span id="l30.139" class="difflineplus">+}</span>
<a href="#l30.140"></a><span id="l30.140" class="difflineplus">+</span>
<a href="#l30.141"></a><span id="l30.141" class="difflineplus">+static int json_pointer_get_recursive(</span>
<a href="#l30.142"></a><span id="l30.142" class="difflineplus">+	struct json_object *obj,</span>
<a href="#l30.143"></a><span id="l30.143" class="difflineplus">+	char *path,</span>
<a href="#l30.144"></a><span id="l30.144" class="difflineplus">+	struct json_object **value)</span>
<a href="#l30.145"></a><span id="l30.145" class="difflineplus">+{</span>
<a href="#l30.146"></a><span id="l30.146" class="difflineplus">+	char *endp;</span>
<a href="#l30.147"></a><span id="l30.147" class="difflineplus">+	int rc;</span>
<a href="#l30.148"></a><span id="l30.148" class="difflineplus">+</span>
<a href="#l30.149"></a><span id="l30.149" class="difflineplus">+	/* All paths (on each recursion level must have a leading '/' */</span>
<a href="#l30.150"></a><span id="l30.150" class="difflineplus">+	if (path[0] != '/') {</span>
<a href="#l30.151"></a><span id="l30.151" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l30.152"></a><span id="l30.152" class="difflineplus">+		return -1;</span>
<a href="#l30.153"></a><span id="l30.153" class="difflineplus">+	}</span>
<a href="#l30.154"></a><span id="l30.154" class="difflineplus">+	path++;</span>
<a href="#l30.155"></a><span id="l30.155" class="difflineplus">+</span>
<a href="#l30.156"></a><span id="l30.156" class="difflineplus">+	endp = strchr(path, '/');</span>
<a href="#l30.157"></a><span id="l30.157" class="difflineplus">+	if (endp)</span>
<a href="#l30.158"></a><span id="l30.158" class="difflineplus">+		*endp = '\0';</span>
<a href="#l30.159"></a><span id="l30.159" class="difflineplus">+</span>
<a href="#l30.160"></a><span id="l30.160" class="difflineplus">+	/* If we err-ed here, return here */</span>
<a href="#l30.161"></a><span id="l30.161" class="difflineplus">+	if ((rc = json_pointer_get_single_path(obj, path, &amp;obj)))</span>
<a href="#l30.162"></a><span id="l30.162" class="difflineplus">+		return rc;</span>
<a href="#l30.163"></a><span id="l30.163" class="difflineplus">+</span>
<a href="#l30.164"></a><span id="l30.164" class="difflineplus">+	if (endp) {</span>
<a href="#l30.165"></a><span id="l30.165" class="difflineplus">+		*endp = '/'; /* Put the slash back, so that the sanity check passes on next recursion level */</span>
<a href="#l30.166"></a><span id="l30.166" class="difflineplus">+		return json_pointer_get_recursive(obj, endp, value);</span>
<a href="#l30.167"></a><span id="l30.167" class="difflineplus">+	}</span>
<a href="#l30.168"></a><span id="l30.168" class="difflineplus">+</span>
<a href="#l30.169"></a><span id="l30.169" class="difflineplus">+	/* We should be at the end of the recursion here */</span>
<a href="#l30.170"></a><span id="l30.170" class="difflineplus">+	if (value)</span>
<a href="#l30.171"></a><span id="l30.171" class="difflineplus">+		*value = obj;</span>
<a href="#l30.172"></a><span id="l30.172" class="difflineplus">+</span>
<a href="#l30.173"></a><span id="l30.173" class="difflineplus">+	return 0;</span>
<a href="#l30.174"></a><span id="l30.174" class="difflineplus">+}</span>
<a href="#l30.175"></a><span id="l30.175" class="difflineplus">+</span>
<a href="#l30.176"></a><span id="l30.176" class="difflineplus">+int json_pointer_get(struct json_object *obj, const char *path, struct json_object **res)</span>
<a href="#l30.177"></a><span id="l30.177" class="difflineplus">+{</span>
<a href="#l30.178"></a><span id="l30.178" class="difflineplus">+	char *path_copy = NULL;</span>
<a href="#l30.179"></a><span id="l30.179" class="difflineplus">+	int rc;</span>
<a href="#l30.180"></a><span id="l30.180" class="difflineplus">+</span>
<a href="#l30.181"></a><span id="l30.181" class="difflineplus">+	if (!obj || !path) {</span>
<a href="#l30.182"></a><span id="l30.182" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l30.183"></a><span id="l30.183" class="difflineplus">+		return -1;</span>
<a href="#l30.184"></a><span id="l30.184" class="difflineplus">+	}</span>
<a href="#l30.185"></a><span id="l30.185" class="difflineplus">+</span>
<a href="#l30.186"></a><span id="l30.186" class="difflineplus">+	if (path[0] == '\0') {</span>
<a href="#l30.187"></a><span id="l30.187" class="difflineplus">+		if (res)</span>
<a href="#l30.188"></a><span id="l30.188" class="difflineplus">+			*res = obj;</span>
<a href="#l30.189"></a><span id="l30.189" class="difflineplus">+		return 0;</span>
<a href="#l30.190"></a><span id="l30.190" class="difflineplus">+	}</span>
<a href="#l30.191"></a><span id="l30.191" class="difflineplus">+</span>
<a href="#l30.192"></a><span id="l30.192" class="difflineplus">+	/* pass a working copy to the recursive call */</span>
<a href="#l30.193"></a><span id="l30.193" class="difflineplus">+	if (!(path_copy = strdup(path))) {</span>
<a href="#l30.194"></a><span id="l30.194" class="difflineplus">+		errno = ENOMEM;</span>
<a href="#l30.195"></a><span id="l30.195" class="difflineplus">+		return -1;</span>
<a href="#l30.196"></a><span id="l30.196" class="difflineplus">+	}</span>
<a href="#l30.197"></a><span id="l30.197" class="difflineplus">+	rc = json_pointer_get_recursive(obj, path_copy, res);</span>
<a href="#l30.198"></a><span id="l30.198" class="difflineplus">+	free(path_copy);</span>
<a href="#l30.199"></a><span id="l30.199" class="difflineplus">+</span>
<a href="#l30.200"></a><span id="l30.200" class="difflineplus">+	return rc;</span>
<a href="#l30.201"></a><span id="l30.201" class="difflineplus">+}</span>
<a href="#l30.202"></a><span id="l30.202" class="difflineplus">+</span>
<a href="#l30.203"></a><span id="l30.203" class="difflineplus">+int json_pointer_getf(struct json_object *obj, struct json_object **res, const char *path_fmt, ...)</span>
<a href="#l30.204"></a><span id="l30.204" class="difflineplus">+{</span>
<a href="#l30.205"></a><span id="l30.205" class="difflineplus">+	char *path_copy = NULL;</span>
<a href="#l30.206"></a><span id="l30.206" class="difflineplus">+	int rc = 0;</span>
<a href="#l30.207"></a><span id="l30.207" class="difflineplus">+	va_list args;</span>
<a href="#l30.208"></a><span id="l30.208" class="difflineplus">+</span>
<a href="#l30.209"></a><span id="l30.209" class="difflineplus">+	if (!obj || !path_fmt) {</span>
<a href="#l30.210"></a><span id="l30.210" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l30.211"></a><span id="l30.211" class="difflineplus">+		return -1;</span>
<a href="#l30.212"></a><span id="l30.212" class="difflineplus">+	}</span>
<a href="#l30.213"></a><span id="l30.213" class="difflineplus">+</span>
<a href="#l30.214"></a><span id="l30.214" class="difflineplus">+	va_start(args, path_fmt);</span>
<a href="#l30.215"></a><span id="l30.215" class="difflineplus">+	rc = vasprintf(&amp;path_copy, path_fmt, args);</span>
<a href="#l30.216"></a><span id="l30.216" class="difflineplus">+	va_end(args);</span>
<a href="#l30.217"></a><span id="l30.217" class="difflineplus">+</span>
<a href="#l30.218"></a><span id="l30.218" class="difflineplus">+	if (rc &lt; 0)</span>
<a href="#l30.219"></a><span id="l30.219" class="difflineplus">+		return rc;</span>
<a href="#l30.220"></a><span id="l30.220" class="difflineplus">+</span>
<a href="#l30.221"></a><span id="l30.221" class="difflineplus">+	if (path_copy[0] == '\0') {</span>
<a href="#l30.222"></a><span id="l30.222" class="difflineplus">+		if (res)</span>
<a href="#l30.223"></a><span id="l30.223" class="difflineplus">+			*res = obj;</span>
<a href="#l30.224"></a><span id="l30.224" class="difflineplus">+		goto out;</span>
<a href="#l30.225"></a><span id="l30.225" class="difflineplus">+	}</span>
<a href="#l30.226"></a><span id="l30.226" class="difflineplus">+</span>
<a href="#l30.227"></a><span id="l30.227" class="difflineplus">+	rc = json_pointer_get_recursive(obj, path_copy, res);</span>
<a href="#l30.228"></a><span id="l30.228" class="difflineplus">+out:</span>
<a href="#l30.229"></a><span id="l30.229" class="difflineplus">+	free(path_copy);</span>
<a href="#l30.230"></a><span id="l30.230" class="difflineplus">+</span>
<a href="#l30.231"></a><span id="l30.231" class="difflineplus">+	return rc;</span>
<a href="#l30.232"></a><span id="l30.232" class="difflineplus">+}</span>
<a href="#l30.233"></a><span id="l30.233" class="difflineplus">+</span>
<a href="#l30.234"></a><span id="l30.234" class="difflineplus">+int json_pointer_set(struct json_object **obj, const char *path, struct json_object *value)</span>
<a href="#l30.235"></a><span id="l30.235" class="difflineplus">+{</span>
<a href="#l30.236"></a><span id="l30.236" class="difflineplus">+	const char *endp;</span>
<a href="#l30.237"></a><span id="l30.237" class="difflineplus">+	char *path_copy = NULL;</span>
<a href="#l30.238"></a><span id="l30.238" class="difflineplus">+	struct json_object *set = NULL;</span>
<a href="#l30.239"></a><span id="l30.239" class="difflineplus">+	int rc;</span>
<a href="#l30.240"></a><span id="l30.240" class="difflineplus">+</span>
<a href="#l30.241"></a><span id="l30.241" class="difflineplus">+	if (!obj || !path) {</span>
<a href="#l30.242"></a><span id="l30.242" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l30.243"></a><span id="l30.243" class="difflineplus">+		return -1;</span>
<a href="#l30.244"></a><span id="l30.244" class="difflineplus">+	}</span>
<a href="#l30.245"></a><span id="l30.245" class="difflineplus">+</span>
<a href="#l30.246"></a><span id="l30.246" class="difflineplus">+	if (path[0] == '\0') {</span>
<a href="#l30.247"></a><span id="l30.247" class="difflineplus">+		json_object_put(*obj);</span>
<a href="#l30.248"></a><span id="l30.248" class="difflineplus">+		*obj = value;</span>
<a href="#l30.249"></a><span id="l30.249" class="difflineplus">+		return 0;</span>
<a href="#l30.250"></a><span id="l30.250" class="difflineplus">+	}</span>
<a href="#l30.251"></a><span id="l30.251" class="difflineplus">+</span>
<a href="#l30.252"></a><span id="l30.252" class="difflineplus">+	if (path[0] != '/') {</span>
<a href="#l30.253"></a><span id="l30.253" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l30.254"></a><span id="l30.254" class="difflineplus">+		return -1;</span>
<a href="#l30.255"></a><span id="l30.255" class="difflineplus">+	}</span>
<a href="#l30.256"></a><span id="l30.256" class="difflineplus">+</span>
<a href="#l30.257"></a><span id="l30.257" class="difflineplus">+	/* If there's only 1 level to set, stop here */</span>
<a href="#l30.258"></a><span id="l30.258" class="difflineplus">+	if ((endp = strrchr(path, '/')) == path) {</span>
<a href="#l30.259"></a><span id="l30.259" class="difflineplus">+		path++;</span>
<a href="#l30.260"></a><span id="l30.260" class="difflineplus">+		return json_pointer_set_single_path(*obj, path, value);</span>
<a href="#l30.261"></a><span id="l30.261" class="difflineplus">+	}</span>
<a href="#l30.262"></a><span id="l30.262" class="difflineplus">+</span>
<a href="#l30.263"></a><span id="l30.263" class="difflineplus">+	/* pass a working copy to the recursive call */</span>
<a href="#l30.264"></a><span id="l30.264" class="difflineplus">+	if (!(path_copy = strdup(path))) {</span>
<a href="#l30.265"></a><span id="l30.265" class="difflineplus">+		errno = ENOMEM;</span>
<a href="#l30.266"></a><span id="l30.266" class="difflineplus">+		return -1;</span>
<a href="#l30.267"></a><span id="l30.267" class="difflineplus">+	}</span>
<a href="#l30.268"></a><span id="l30.268" class="difflineplus">+	path_copy[endp - path] = '\0';</span>
<a href="#l30.269"></a><span id="l30.269" class="difflineplus">+	rc = json_pointer_get_recursive(*obj, path_copy, &amp;set);</span>
<a href="#l30.270"></a><span id="l30.270" class="difflineplus">+	free(path_copy);</span>
<a href="#l30.271"></a><span id="l30.271" class="difflineplus">+</span>
<a href="#l30.272"></a><span id="l30.272" class="difflineplus">+	if (rc)</span>
<a href="#l30.273"></a><span id="l30.273" class="difflineplus">+		return rc;</span>
<a href="#l30.274"></a><span id="l30.274" class="difflineplus">+</span>
<a href="#l30.275"></a><span id="l30.275" class="difflineplus">+	endp++;</span>
<a href="#l30.276"></a><span id="l30.276" class="difflineplus">+	return json_pointer_set_single_path(set, endp, value);</span>
<a href="#l30.277"></a><span id="l30.277" class="difflineplus">+}</span>
<a href="#l30.278"></a><span id="l30.278" class="difflineplus">+</span>
<a href="#l30.279"></a><span id="l30.279" class="difflineplus">+int json_pointer_setf(struct json_object **obj, struct json_object *value, const char *path_fmt, ...)</span>
<a href="#l30.280"></a><span id="l30.280" class="difflineplus">+{</span>
<a href="#l30.281"></a><span id="l30.281" class="difflineplus">+	char *endp;</span>
<a href="#l30.282"></a><span id="l30.282" class="difflineplus">+	char *path_copy = NULL;</span>
<a href="#l30.283"></a><span id="l30.283" class="difflineplus">+	struct json_object *set = NULL;</span>
<a href="#l30.284"></a><span id="l30.284" class="difflineplus">+	va_list args;</span>
<a href="#l30.285"></a><span id="l30.285" class="difflineplus">+	int rc = 0;</span>
<a href="#l30.286"></a><span id="l30.286" class="difflineplus">+</span>
<a href="#l30.287"></a><span id="l30.287" class="difflineplus">+	if (!obj || !path_fmt) {</span>
<a href="#l30.288"></a><span id="l30.288" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l30.289"></a><span id="l30.289" class="difflineplus">+		return -1;</span>
<a href="#l30.290"></a><span id="l30.290" class="difflineplus">+	}</span>
<a href="#l30.291"></a><span id="l30.291" class="difflineplus">+</span>
<a href="#l30.292"></a><span id="l30.292" class="difflineplus">+	/* pass a working copy to the recursive call */</span>
<a href="#l30.293"></a><span id="l30.293" class="difflineplus">+	va_start(args, path_fmt);</span>
<a href="#l30.294"></a><span id="l30.294" class="difflineplus">+	rc = vasprintf(&amp;path_copy, path_fmt, args);</span>
<a href="#l30.295"></a><span id="l30.295" class="difflineplus">+	va_end(args);</span>
<a href="#l30.296"></a><span id="l30.296" class="difflineplus">+</span>
<a href="#l30.297"></a><span id="l30.297" class="difflineplus">+	if (rc &lt; 0)</span>
<a href="#l30.298"></a><span id="l30.298" class="difflineplus">+		return rc;</span>
<a href="#l30.299"></a><span id="l30.299" class="difflineplus">+</span>
<a href="#l30.300"></a><span id="l30.300" class="difflineplus">+	if (path_copy[0] == '\0') {</span>
<a href="#l30.301"></a><span id="l30.301" class="difflineplus">+		json_object_put(*obj);</span>
<a href="#l30.302"></a><span id="l30.302" class="difflineplus">+		*obj = value;</span>
<a href="#l30.303"></a><span id="l30.303" class="difflineplus">+		goto out;</span>
<a href="#l30.304"></a><span id="l30.304" class="difflineplus">+	}</span>
<a href="#l30.305"></a><span id="l30.305" class="difflineplus">+</span>
<a href="#l30.306"></a><span id="l30.306" class="difflineplus">+	if (path_copy[0] != '/') {</span>
<a href="#l30.307"></a><span id="l30.307" class="difflineplus">+		errno = EINVAL;</span>
<a href="#l30.308"></a><span id="l30.308" class="difflineplus">+		rc = -1;</span>
<a href="#l30.309"></a><span id="l30.309" class="difflineplus">+		goto out;</span>
<a href="#l30.310"></a><span id="l30.310" class="difflineplus">+	}</span>
<a href="#l30.311"></a><span id="l30.311" class="difflineplus">+</span>
<a href="#l30.312"></a><span id="l30.312" class="difflineplus">+	/* If there's only 1 level to set, stop here */</span>
<a href="#l30.313"></a><span id="l30.313" class="difflineplus">+	if ((endp = strrchr(path_copy, '/')) == path_copy) {</span>
<a href="#l30.314"></a><span id="l30.314" class="difflineplus">+		set = *obj;</span>
<a href="#l30.315"></a><span id="l30.315" class="difflineplus">+		goto set_single_path;</span>
<a href="#l30.316"></a><span id="l30.316" class="difflineplus">+	}</span>
<a href="#l30.317"></a><span id="l30.317" class="difflineplus">+</span>
<a href="#l30.318"></a><span id="l30.318" class="difflineplus">+	*endp = '\0';</span>
<a href="#l30.319"></a><span id="l30.319" class="difflineplus">+	rc = json_pointer_get_recursive(*obj, path_copy, &amp;set);</span>
<a href="#l30.320"></a><span id="l30.320" class="difflineplus">+</span>
<a href="#l30.321"></a><span id="l30.321" class="difflineplus">+	if (rc)</span>
<a href="#l30.322"></a><span id="l30.322" class="difflineplus">+		goto out;</span>
<a href="#l30.323"></a><span id="l30.323" class="difflineplus">+</span>
<a href="#l30.324"></a><span id="l30.324" class="difflineplus">+set_single_path:</span>
<a href="#l30.325"></a><span id="l30.325" class="difflineplus">+	endp++;</span>
<a href="#l30.326"></a><span id="l30.326" class="difflineplus">+	rc = json_pointer_set_single_path(set, endp, value);</span>
<a href="#l30.327"></a><span id="l30.327" class="difflineplus">+out:</span>
<a href="#l30.328"></a><span id="l30.328" class="difflineplus">+	free(path_copy);</span>
<a href="#l30.329"></a><span id="l30.329" class="difflineplus">+	return rc;</span>
<a href="#l30.330"></a><span id="l30.330" class="difflineplus">+}</span>
<a href="#l30.331"></a><span id="l30.331" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1">new file mode 100644</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineminus">--- /dev/null</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineplus">+++ b/third_party/json-c/json_pointer.h</span>
<a href="#l31.4"></a><span id="l31.4" class="difflineat">@@ -0,0 +1,120 @@</span>
<a href="#l31.5"></a><span id="l31.5" class="difflineplus">+/*</span>
<a href="#l31.6"></a><span id="l31.6" class="difflineplus">+ * Copyright (c) 2016 Alexadru Ardelean.</span>
<a href="#l31.7"></a><span id="l31.7" class="difflineplus">+ *</span>
<a href="#l31.8"></a><span id="l31.8" class="difflineplus">+ * This is free software; you can redistribute it and/or modify</span>
<a href="#l31.9"></a><span id="l31.9" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l31.10"></a><span id="l31.10" class="difflineplus">+ *</span>
<a href="#l31.11"></a><span id="l31.11" class="difflineplus">+ */</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineplus">+</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+/**</span>
<a href="#l31.14"></a><span id="l31.14" class="difflineplus">+ * @file</span>
<a href="#l31.15"></a><span id="l31.15" class="difflineplus">+ * @brief JSON Pointer (RFC 6901) implementation for retrieving</span>
<a href="#l31.16"></a><span id="l31.16" class="difflineplus">+ *        objects from a json-c object tree.</span>
<a href="#l31.17"></a><span id="l31.17" class="difflineplus">+ */</span>
<a href="#l31.18"></a><span id="l31.18" class="difflineplus">+#ifndef _json_pointer_h_</span>
<a href="#l31.19"></a><span id="l31.19" class="difflineplus">+#define _json_pointer_h_</span>
<a href="#l31.20"></a><span id="l31.20" class="difflineplus">+</span>
<a href="#l31.21"></a><span id="l31.21" class="difflineplus">+#include &quot;json_object.h&quot;</span>
<a href="#l31.22"></a><span id="l31.22" class="difflineplus">+</span>
<a href="#l31.23"></a><span id="l31.23" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l31.24"></a><span id="l31.24" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l31.25"></a><span id="l31.25" class="difflineplus">+#endif</span>
<a href="#l31.26"></a><span id="l31.26" class="difflineplus">+</span>
<a href="#l31.27"></a><span id="l31.27" class="difflineplus">+/**</span>
<a href="#l31.28"></a><span id="l31.28" class="difflineplus">+ * Retrieves a JSON sub-object from inside another JSON object</span>
<a href="#l31.29"></a><span id="l31.29" class="difflineplus">+ * using the JSON pointer notation as defined in RFC 6901</span>
<a href="#l31.30"></a><span id="l31.30" class="difflineplus">+ *   https://tools.ietf.org/html/rfc6901</span>
<a href="#l31.31"></a><span id="l31.31" class="difflineplus">+ *</span>
<a href="#l31.32"></a><span id="l31.32" class="difflineplus">+ * The returned JSON sub-object is equivalent to parsing manually the</span>
<a href="#l31.33"></a><span id="l31.33" class="difflineplus">+ * 'obj' JSON tree ; i.e. it's not a new object that is created, but rather</span>
<a href="#l31.34"></a><span id="l31.34" class="difflineplus">+ * a pointer inside the JSON tree.</span>
<a href="#l31.35"></a><span id="l31.35" class="difflineplus">+ *</span>
<a href="#l31.36"></a><span id="l31.36" class="difflineplus">+ * Internally, this is equivalent to doing a series of 'json_object_object_get()'</span>
<a href="#l31.37"></a><span id="l31.37" class="difflineplus">+ * and 'json_object_array_get_idx()' along the given 'path'.</span>
<a href="#l31.38"></a><span id="l31.38" class="difflineplus">+ *</span>
<a href="#l31.39"></a><span id="l31.39" class="difflineplus">+ * Note that the 'path' string supports 'printf()' type arguments, so, whatever</span>
<a href="#l31.40"></a><span id="l31.40" class="difflineplus">+ * is added after the 'res' param will be treated as an argument for 'path'</span>
<a href="#l31.41"></a><span id="l31.41" class="difflineplus">+ * Example: json_pointer_get(obj, &quot;/foo/%d/%s&quot;, &amp;res, 0, bar)</span>
<a href="#l31.42"></a><span id="l31.42" class="difflineplus">+ * This means, that you need to escape '%' with '%%' (just like in printf())</span>
<a href="#l31.43"></a><span id="l31.43" class="difflineplus">+ *</span>
<a href="#l31.44"></a><span id="l31.44" class="difflineplus">+ * @param obj the json_object instance/tree from where to retrieve sub-objects</span>
<a href="#l31.45"></a><span id="l31.45" class="difflineplus">+ * @param path a (RFC6901) string notation for the sub-object to retrieve</span>
<a href="#l31.46"></a><span id="l31.46" class="difflineplus">+ * @param res a pointer where to store a reference to the json_object</span>
<a href="#l31.47"></a><span id="l31.47" class="difflineplus">+ *              associated with the given path</span>
<a href="#l31.48"></a><span id="l31.48" class="difflineplus">+ *</span>
<a href="#l31.49"></a><span id="l31.49" class="difflineplus">+ * @return negative if an error (or not found), or 0 if succeeded</span>
<a href="#l31.50"></a><span id="l31.50" class="difflineplus">+ */</span>
<a href="#l31.51"></a><span id="l31.51" class="difflineplus">+int json_pointer_get(struct json_object *obj, const char *path, struct json_object **res);</span>
<a href="#l31.52"></a><span id="l31.52" class="difflineplus">+</span>
<a href="#l31.53"></a><span id="l31.53" class="difflineplus">+/**</span>
<a href="#l31.54"></a><span id="l31.54" class="difflineplus">+ * This is a variant of 'json_pointer_get()' that supports printf() style arguments.</span>
<a href="#l31.55"></a><span id="l31.55" class="difflineplus">+ *</span>
<a href="#l31.56"></a><span id="l31.56" class="difflineplus">+ * Example: json_pointer_getf(obj, res, &quot;/foo/%d/%s&quot;, 0, bak)</span>
<a href="#l31.57"></a><span id="l31.57" class="difflineplus">+ * This also means that you need to escape '%' with '%%' (just like in printf())</span>
<a href="#l31.58"></a><span id="l31.58" class="difflineplus">+ *</span>
<a href="#l31.59"></a><span id="l31.59" class="difflineplus">+ * Please take into consideration all recommended 'printf()' format security</span>
<a href="#l31.60"></a><span id="l31.60" class="difflineplus">+ * aspects when using this function.</span>
<a href="#l31.61"></a><span id="l31.61" class="difflineplus">+ *</span>
<a href="#l31.62"></a><span id="l31.62" class="difflineplus">+ * @param obj the json_object instance/tree to which to add a sub-object</span>
<a href="#l31.63"></a><span id="l31.63" class="difflineplus">+ * @param res a pointer where to store a reference to the json_object</span>
<a href="#l31.64"></a><span id="l31.64" class="difflineplus">+ *              associated with the given path</span>
<a href="#l31.65"></a><span id="l31.65" class="difflineplus">+ * @param path_fmt a printf() style format for the path</span>
<a href="#l31.66"></a><span id="l31.66" class="difflineplus">+ *</span>
<a href="#l31.67"></a><span id="l31.67" class="difflineplus">+ * @return negative if an error (or not found), or 0 if succeeded</span>
<a href="#l31.68"></a><span id="l31.68" class="difflineplus">+ */</span>
<a href="#l31.69"></a><span id="l31.69" class="difflineplus">+int json_pointer_getf(struct json_object *obj, struct json_object **res, const char *path_fmt, ...);</span>
<a href="#l31.70"></a><span id="l31.70" class="difflineplus">+</span>
<a href="#l31.71"></a><span id="l31.71" class="difflineplus">+/**</span>
<a href="#l31.72"></a><span id="l31.72" class="difflineplus">+ * Sets JSON object 'value' in the 'obj' tree at the location specified</span>
<a href="#l31.73"></a><span id="l31.73" class="difflineplus">+ * by the 'path'. 'path' is JSON pointer notation as defined in RFC 6901</span>
<a href="#l31.74"></a><span id="l31.74" class="difflineplus">+ *   https://tools.ietf.org/html/rfc6901</span>
<a href="#l31.75"></a><span id="l31.75" class="difflineplus">+ *</span>
<a href="#l31.76"></a><span id="l31.76" class="difflineplus">+ * Note that 'obj' is a double pointer, mostly for the &quot;&quot; (empty string)</span>
<a href="#l31.77"></a><span id="l31.77" class="difflineplus">+ * case, where the entire JSON object would be replaced by 'value'.</span>
<a href="#l31.78"></a><span id="l31.78" class="difflineplus">+ * In the case of the &quot;&quot; path, the object at '*obj' will have it's refcount</span>
<a href="#l31.79"></a><span id="l31.79" class="difflineplus">+ * decremented with 'json_object_put()' and the 'value' object will be assigned to it.</span>
<a href="#l31.80"></a><span id="l31.80" class="difflineplus">+ *</span>
<a href="#l31.81"></a><span id="l31.81" class="difflineplus">+ * For other cases (JSON sub-objects) ownership of 'value' will be transferred into</span>
<a href="#l31.82"></a><span id="l31.82" class="difflineplus">+ * '*obj' via 'json_object_object_add()' &amp; 'json_object_array_put_idx()', so the</span>
<a href="#l31.83"></a><span id="l31.83" class="difflineplus">+ * only time the refcount should be decremented for 'value' is when the return value of</span>
<a href="#l31.84"></a><span id="l31.84" class="difflineplus">+ * 'json_pointer_set()' is negative (meaning the 'value' object did not get set into '*obj').</span>
<a href="#l31.85"></a><span id="l31.85" class="difflineplus">+ *</span>
<a href="#l31.86"></a><span id="l31.86" class="difflineplus">+ * That also implies that 'json_pointer_set()' does not do any refcount incrementing.</span>
<a href="#l31.87"></a><span id="l31.87" class="difflineplus">+ * (Just that single decrement that was mentioned above).</span>
<a href="#l31.88"></a><span id="l31.88" class="difflineplus">+ *</span>
<a href="#l31.89"></a><span id="l31.89" class="difflineplus">+ * Note that the 'path' string supports 'printf()' type arguments, so, whatever</span>
<a href="#l31.90"></a><span id="l31.90" class="difflineplus">+ * is added after the 'value' param will be treated as an argument for 'path'</span>
<a href="#l31.91"></a><span id="l31.91" class="difflineplus">+ * Example: json_pointer_set(obj, &quot;/foo/%d/%s&quot;, value, 0, bak)</span>
<a href="#l31.92"></a><span id="l31.92" class="difflineplus">+ * This means, that you need to escape '%' with '%%' (just like in printf())</span>
<a href="#l31.93"></a><span id="l31.93" class="difflineplus">+ *</span>
<a href="#l31.94"></a><span id="l31.94" class="difflineplus">+ * @param obj the json_object instance/tree to which to add a sub-object</span>
<a href="#l31.95"></a><span id="l31.95" class="difflineplus">+ * @param path a (RFC6901) string notation for the sub-object to set in the tree</span>
<a href="#l31.96"></a><span id="l31.96" class="difflineplus">+ * @param value object to set at path</span>
<a href="#l31.97"></a><span id="l31.97" class="difflineplus">+ *</span>
<a href="#l31.98"></a><span id="l31.98" class="difflineplus">+ * @return negative if an error (or not found), or 0 if succeeded</span>
<a href="#l31.99"></a><span id="l31.99" class="difflineplus">+ */</span>
<a href="#l31.100"></a><span id="l31.100" class="difflineplus">+int json_pointer_set(struct json_object **obj, const char *path, struct json_object *value);</span>
<a href="#l31.101"></a><span id="l31.101" class="difflineplus">+</span>
<a href="#l31.102"></a><span id="l31.102" class="difflineplus">+/**</span>
<a href="#l31.103"></a><span id="l31.103" class="difflineplus">+ * This is a variant of 'json_pointer_set()' that supports printf() style arguments.</span>
<a href="#l31.104"></a><span id="l31.104" class="difflineplus">+ *</span>
<a href="#l31.105"></a><span id="l31.105" class="difflineplus">+ * Example: json_pointer_setf(obj, value, &quot;/foo/%d/%s&quot;, 0, bak)</span>
<a href="#l31.106"></a><span id="l31.106" class="difflineplus">+ * This also means that you need to escape '%' with '%%' (just like in printf())</span>
<a href="#l31.107"></a><span id="l31.107" class="difflineplus">+ *</span>
<a href="#l31.108"></a><span id="l31.108" class="difflineplus">+ * Please take into consideration all recommended 'printf()' format security</span>
<a href="#l31.109"></a><span id="l31.109" class="difflineplus">+ * aspects when using this function.</span>
<a href="#l31.110"></a><span id="l31.110" class="difflineplus">+ *</span>
<a href="#l31.111"></a><span id="l31.111" class="difflineplus">+ * @param obj the json_object instance/tree to which to add a sub-object</span>
<a href="#l31.112"></a><span id="l31.112" class="difflineplus">+ * @param value object to set at path</span>
<a href="#l31.113"></a><span id="l31.113" class="difflineplus">+ * @param path_fmt a printf() style format for the path</span>
<a href="#l31.114"></a><span id="l31.114" class="difflineplus">+ *</span>
<a href="#l31.115"></a><span id="l31.115" class="difflineplus">+ * @return negative if an error (or not found), or 0 if succeeded</span>
<a href="#l31.116"></a><span id="l31.116" class="difflineplus">+ */</span>
<a href="#l31.117"></a><span id="l31.117" class="difflineplus">+int json_pointer_setf(struct json_object **obj, struct json_object *value, const char *path_fmt, ...);</span>
<a href="#l31.118"></a><span id="l31.118" class="difflineplus">+</span>
<a href="#l31.119"></a><span id="l31.119" class="difflineplus">+</span>
<a href="#l31.120"></a><span id="l31.120" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l31.121"></a><span id="l31.121" class="difflineplus">+}</span>
<a href="#l31.122"></a><span id="l31.122" class="difflineplus">+#endif</span>
<a href="#l31.123"></a><span id="l31.123" class="difflineplus">+</span>
<a href="#l31.124"></a><span id="l31.124" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1">new file mode 100644</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineminus">--- /dev/null</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineplus">+++ b/third_party/json-c/json_tokener.c</span>
<a href="#l32.4"></a><span id="l32.4" class="difflineat">@@ -0,0 +1,997 @@</span>
<a href="#l32.5"></a><span id="l32.5" class="difflineplus">+/*</span>
<a href="#l32.6"></a><span id="l32.6" class="difflineplus">+ * $Id: json_tokener.c,v 1.20 2006/07/25 03:24:50 mclark Exp $</span>
<a href="#l32.7"></a><span id="l32.7" class="difflineplus">+ *</span>
<a href="#l32.8"></a><span id="l32.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l32.9"></a><span id="l32.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l32.10"></a><span id="l32.10" class="difflineplus">+ *</span>
<a href="#l32.11"></a><span id="l32.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+ *</span>
<a href="#l32.14"></a><span id="l32.14" class="difflineplus">+ *</span>
<a href="#l32.15"></a><span id="l32.15" class="difflineplus">+ * Copyright (c) 2008-2009 Yahoo! Inc.  All rights reserved.</span>
<a href="#l32.16"></a><span id="l32.16" class="difflineplus">+ * The copyrights to the contents of this file are licensed under the MIT License</span>
<a href="#l32.17"></a><span id="l32.17" class="difflineplus">+ * (http://www.opensource.org/licenses/mit-license.php)</span>
<a href="#l32.18"></a><span id="l32.18" class="difflineplus">+ */</span>
<a href="#l32.19"></a><span id="l32.19" class="difflineplus">+</span>
<a href="#l32.20"></a><span id="l32.20" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l32.21"></a><span id="l32.21" class="difflineplus">+</span>
<a href="#l32.22"></a><span id="l32.22" class="difflineplus">+#include &lt;math.h&gt;</span>
<a href="#l32.23"></a><span id="l32.23" class="difflineplus">+#include &quot;math_compat.h&quot;</span>
<a href="#l32.24"></a><span id="l32.24" class="difflineplus">+#include &lt;stdio.h&gt;</span>
<a href="#l32.25"></a><span id="l32.25" class="difflineplus">+#include &lt;stdlib.h&gt;</span>
<a href="#l32.26"></a><span id="l32.26" class="difflineplus">+#include &lt;stddef.h&gt;</span>
<a href="#l32.27"></a><span id="l32.27" class="difflineplus">+#include &lt;ctype.h&gt;</span>
<a href="#l32.28"></a><span id="l32.28" class="difflineplus">+#include &lt;string.h&gt;</span>
<a href="#l32.29"></a><span id="l32.29" class="difflineplus">+#include &lt;limits.h&gt;</span>
<a href="#l32.30"></a><span id="l32.30" class="difflineplus">+</span>
<a href="#l32.31"></a><span id="l32.31" class="difflineplus">+#include &quot;debug.h&quot;</span>
<a href="#l32.32"></a><span id="l32.32" class="difflineplus">+#include &quot;printbuf.h&quot;</span>
<a href="#l32.33"></a><span id="l32.33" class="difflineplus">+#include &quot;arraylist.h&quot;</span>
<a href="#l32.34"></a><span id="l32.34" class="difflineplus">+#include &quot;json_inttypes.h&quot;</span>
<a href="#l32.35"></a><span id="l32.35" class="difflineplus">+#include &quot;json_object.h&quot;</span>
<a href="#l32.36"></a><span id="l32.36" class="difflineplus">+#include &quot;json_object_private.h&quot;</span>
<a href="#l32.37"></a><span id="l32.37" class="difflineplus">+#include &quot;json_tokener.h&quot;</span>
<a href="#l32.38"></a><span id="l32.38" class="difflineplus">+#include &quot;json_util.h&quot;</span>
<a href="#l32.39"></a><span id="l32.39" class="difflineplus">+#include &quot;strdup_compat.h&quot;</span>
<a href="#l32.40"></a><span id="l32.40" class="difflineplus">+</span>
<a href="#l32.41"></a><span id="l32.41" class="difflineplus">+#ifdef HAVE_LOCALE_H</span>
<a href="#l32.42"></a><span id="l32.42" class="difflineplus">+#include &lt;locale.h&gt;</span>
<a href="#l32.43"></a><span id="l32.43" class="difflineplus">+#endif /* HAVE_LOCALE_H */</span>
<a href="#l32.44"></a><span id="l32.44" class="difflineplus">+#ifdef HAVE_XLOCALE_H</span>
<a href="#l32.45"></a><span id="l32.45" class="difflineplus">+#include &lt;xlocale.h&gt;</span>
<a href="#l32.46"></a><span id="l32.46" class="difflineplus">+#endif</span>
<a href="#l32.47"></a><span id="l32.47" class="difflineplus">+</span>
<a href="#l32.48"></a><span id="l32.48" class="difflineplus">+#define jt_hexdigit(x) (((x) &lt;= '9') ? (x) - '0' : ((x) &amp; 7) + 9)</span>
<a href="#l32.49"></a><span id="l32.49" class="difflineplus">+</span>
<a href="#l32.50"></a><span id="l32.50" class="difflineplus">+#if !HAVE_STRNCASECMP &amp;&amp; defined(_MSC_VER)</span>
<a href="#l32.51"></a><span id="l32.51" class="difflineplus">+  /* MSC has the version as _strnicmp */</span>
<a href="#l32.52"></a><span id="l32.52" class="difflineplus">+# define strncasecmp _strnicmp</span>
<a href="#l32.53"></a><span id="l32.53" class="difflineplus">+#elif !HAVE_STRNCASECMP</span>
<a href="#l32.54"></a><span id="l32.54" class="difflineplus">+# error You do not have strncasecmp on your system.</span>
<a href="#l32.55"></a><span id="l32.55" class="difflineplus">+#endif /* HAVE_STRNCASECMP */</span>
<a href="#l32.56"></a><span id="l32.56" class="difflineplus">+</span>
<a href="#l32.57"></a><span id="l32.57" class="difflineplus">+/* Use C99 NAN by default; if not available, nan(&quot;&quot;) should work too. */</span>
<a href="#l32.58"></a><span id="l32.58" class="difflineplus">+#ifndef NAN</span>
<a href="#l32.59"></a><span id="l32.59" class="difflineplus">+#define NAN nan(&quot;&quot;)</span>
<a href="#l32.60"></a><span id="l32.60" class="difflineplus">+#endif /* !NAN */</span>
<a href="#l32.61"></a><span id="l32.61" class="difflineplus">+</span>
<a href="#l32.62"></a><span id="l32.62" class="difflineplus">+static const char json_null_str[] = &quot;null&quot;;</span>
<a href="#l32.63"></a><span id="l32.63" class="difflineplus">+static const int json_null_str_len = sizeof(json_null_str) - 1;</span>
<a href="#l32.64"></a><span id="l32.64" class="difflineplus">+static const char json_inf_str[] = &quot;Infinity&quot;;</span>
<a href="#l32.65"></a><span id="l32.65" class="difflineplus">+static const char json_inf_str_lower[] = &quot;infinity&quot;;</span>
<a href="#l32.66"></a><span id="l32.66" class="difflineplus">+static const unsigned int json_inf_str_len = sizeof(json_inf_str) - 1;</span>
<a href="#l32.67"></a><span id="l32.67" class="difflineplus">+static const char json_nan_str[] = &quot;NaN&quot;;</span>
<a href="#l32.68"></a><span id="l32.68" class="difflineplus">+static const int json_nan_str_len = sizeof(json_nan_str) - 1;</span>
<a href="#l32.69"></a><span id="l32.69" class="difflineplus">+static const char json_true_str[] = &quot;true&quot;;</span>
<a href="#l32.70"></a><span id="l32.70" class="difflineplus">+static const int json_true_str_len = sizeof(json_true_str) - 1;</span>
<a href="#l32.71"></a><span id="l32.71" class="difflineplus">+static const char json_false_str[] = &quot;false&quot;;</span>
<a href="#l32.72"></a><span id="l32.72" class="difflineplus">+static const int json_false_str_len = sizeof(json_false_str) - 1;</span>
<a href="#l32.73"></a><span id="l32.73" class="difflineplus">+</span>
<a href="#l32.74"></a><span id="l32.74" class="difflineplus">+static const char* json_tokener_errors[] = {</span>
<a href="#l32.75"></a><span id="l32.75" class="difflineplus">+  &quot;success&quot;,</span>
<a href="#l32.76"></a><span id="l32.76" class="difflineplus">+  &quot;continue&quot;,</span>
<a href="#l32.77"></a><span id="l32.77" class="difflineplus">+  &quot;nesting too deep&quot;,</span>
<a href="#l32.78"></a><span id="l32.78" class="difflineplus">+  &quot;unexpected end of data&quot;,</span>
<a href="#l32.79"></a><span id="l32.79" class="difflineplus">+  &quot;unexpected character&quot;,</span>
<a href="#l32.80"></a><span id="l32.80" class="difflineplus">+  &quot;null expected&quot;,</span>
<a href="#l32.81"></a><span id="l32.81" class="difflineplus">+  &quot;boolean expected&quot;,</span>
<a href="#l32.82"></a><span id="l32.82" class="difflineplus">+  &quot;number expected&quot;,</span>
<a href="#l32.83"></a><span id="l32.83" class="difflineplus">+  &quot;array value separator ',' expected&quot;,</span>
<a href="#l32.84"></a><span id="l32.84" class="difflineplus">+  &quot;quoted object property name expected&quot;,</span>
<a href="#l32.85"></a><span id="l32.85" class="difflineplus">+  &quot;object property name separator ':' expected&quot;,</span>
<a href="#l32.86"></a><span id="l32.86" class="difflineplus">+  &quot;object value separator ',' expected&quot;,</span>
<a href="#l32.87"></a><span id="l32.87" class="difflineplus">+  &quot;invalid string sequence&quot;,</span>
<a href="#l32.88"></a><span id="l32.88" class="difflineplus">+  &quot;expected comment&quot;,</span>
<a href="#l32.89"></a><span id="l32.89" class="difflineplus">+  &quot;buffer size overflow&quot;</span>
<a href="#l32.90"></a><span id="l32.90" class="difflineplus">+};</span>
<a href="#l32.91"></a><span id="l32.91" class="difflineplus">+</span>
<a href="#l32.92"></a><span id="l32.92" class="difflineplus">+const char *json_tokener_error_desc(enum json_tokener_error jerr)</span>
<a href="#l32.93"></a><span id="l32.93" class="difflineplus">+{</span>
<a href="#l32.94"></a><span id="l32.94" class="difflineplus">+	int jerr_int = (int) jerr;</span>
<a href="#l32.95"></a><span id="l32.95" class="difflineplus">+	if (jerr_int &lt; 0 ||</span>
<a href="#l32.96"></a><span id="l32.96" class="difflineplus">+	    jerr_int &gt;= (int)(sizeof(json_tokener_errors) / sizeof(json_tokener_errors[0])))</span>
<a href="#l32.97"></a><span id="l32.97" class="difflineplus">+		return &quot;Unknown error, &quot;</span>
<a href="#l32.98"></a><span id="l32.98" class="difflineplus">+		       &quot;invalid json_tokener_error value passed to json_tokener_error_desc()&quot;;</span>
<a href="#l32.99"></a><span id="l32.99" class="difflineplus">+	return json_tokener_errors[jerr];</span>
<a href="#l32.100"></a><span id="l32.100" class="difflineplus">+}</span>
<a href="#l32.101"></a><span id="l32.101" class="difflineplus">+</span>
<a href="#l32.102"></a><span id="l32.102" class="difflineplus">+enum json_tokener_error json_tokener_get_error(struct json_tokener *tok)</span>
<a href="#l32.103"></a><span id="l32.103" class="difflineplus">+{</span>
<a href="#l32.104"></a><span id="l32.104" class="difflineplus">+	return tok-&gt;err;</span>
<a href="#l32.105"></a><span id="l32.105" class="difflineplus">+}</span>
<a href="#l32.106"></a><span id="l32.106" class="difflineplus">+</span>
<a href="#l32.107"></a><span id="l32.107" class="difflineplus">+/* Stuff for decoding unicode sequences */</span>
<a href="#l32.108"></a><span id="l32.108" class="difflineplus">+#define IS_HIGH_SURROGATE(uc) (((uc) &amp; 0xFC00) == 0xD800)</span>
<a href="#l32.109"></a><span id="l32.109" class="difflineplus">+#define IS_LOW_SURROGATE(uc)  (((uc) &amp; 0xFC00) == 0xDC00)</span>
<a href="#l32.110"></a><span id="l32.110" class="difflineplus">+#define DECODE_SURROGATE_PAIR(hi,lo) ((((hi) &amp; 0x3FF) &lt;&lt; 10) + ((lo) &amp; 0x3FF) + 0x10000)</span>
<a href="#l32.111"></a><span id="l32.111" class="difflineplus">+static unsigned char utf8_replacement_char[3] = { 0xEF, 0xBF, 0xBD };</span>
<a href="#l32.112"></a><span id="l32.112" class="difflineplus">+</span>
<a href="#l32.113"></a><span id="l32.113" class="difflineplus">+struct json_tokener* json_tokener_new_ex(int depth)</span>
<a href="#l32.114"></a><span id="l32.114" class="difflineplus">+{</span>
<a href="#l32.115"></a><span id="l32.115" class="difflineplus">+  struct json_tokener *tok;</span>
<a href="#l32.116"></a><span id="l32.116" class="difflineplus">+</span>
<a href="#l32.117"></a><span id="l32.117" class="difflineplus">+  tok = (struct json_tokener*)calloc(1, sizeof(struct json_tokener));</span>
<a href="#l32.118"></a><span id="l32.118" class="difflineplus">+  if (!tok) return NULL;</span>
<a href="#l32.119"></a><span id="l32.119" class="difflineplus">+  tok-&gt;stack = (struct json_tokener_srec *) calloc(depth,</span>
<a href="#l32.120"></a><span id="l32.120" class="difflineplus">+						   sizeof(struct json_tokener_srec));</span>
<a href="#l32.121"></a><span id="l32.121" class="difflineplus">+  if (!tok-&gt;stack) {</span>
<a href="#l32.122"></a><span id="l32.122" class="difflineplus">+    free(tok);</span>
<a href="#l32.123"></a><span id="l32.123" class="difflineplus">+    return NULL;</span>
<a href="#l32.124"></a><span id="l32.124" class="difflineplus">+  }</span>
<a href="#l32.125"></a><span id="l32.125" class="difflineplus">+  tok-&gt;pb = printbuf_new();</span>
<a href="#l32.126"></a><span id="l32.126" class="difflineplus">+  tok-&gt;max_depth = depth;</span>
<a href="#l32.127"></a><span id="l32.127" class="difflineplus">+  json_tokener_reset(tok);</span>
<a href="#l32.128"></a><span id="l32.128" class="difflineplus">+  return tok;</span>
<a href="#l32.129"></a><span id="l32.129" class="difflineplus">+}</span>
<a href="#l32.130"></a><span id="l32.130" class="difflineplus">+</span>
<a href="#l32.131"></a><span id="l32.131" class="difflineplus">+struct json_tokener* json_tokener_new(void)</span>
<a href="#l32.132"></a><span id="l32.132" class="difflineplus">+{</span>
<a href="#l32.133"></a><span id="l32.133" class="difflineplus">+  return json_tokener_new_ex(JSON_TOKENER_DEFAULT_DEPTH);</span>
<a href="#l32.134"></a><span id="l32.134" class="difflineplus">+}</span>
<a href="#l32.135"></a><span id="l32.135" class="difflineplus">+</span>
<a href="#l32.136"></a><span id="l32.136" class="difflineplus">+void json_tokener_free(struct json_tokener *tok)</span>
<a href="#l32.137"></a><span id="l32.137" class="difflineplus">+{</span>
<a href="#l32.138"></a><span id="l32.138" class="difflineplus">+  json_tokener_reset(tok);</span>
<a href="#l32.139"></a><span id="l32.139" class="difflineplus">+  if (tok-&gt;pb) printbuf_free(tok-&gt;pb);</span>
<a href="#l32.140"></a><span id="l32.140" class="difflineplus">+  free(tok-&gt;stack);</span>
<a href="#l32.141"></a><span id="l32.141" class="difflineplus">+  free(tok);</span>
<a href="#l32.142"></a><span id="l32.142" class="difflineplus">+}</span>
<a href="#l32.143"></a><span id="l32.143" class="difflineplus">+</span>
<a href="#l32.144"></a><span id="l32.144" class="difflineplus">+static void json_tokener_reset_level(struct json_tokener *tok, int depth)</span>
<a href="#l32.145"></a><span id="l32.145" class="difflineplus">+{</span>
<a href="#l32.146"></a><span id="l32.146" class="difflineplus">+  tok-&gt;stack[depth].state = json_tokener_state_eatws;</span>
<a href="#l32.147"></a><span id="l32.147" class="difflineplus">+  tok-&gt;stack[depth].saved_state = json_tokener_state_start;</span>
<a href="#l32.148"></a><span id="l32.148" class="difflineplus">+  json_object_put(tok-&gt;stack[depth].current);</span>
<a href="#l32.149"></a><span id="l32.149" class="difflineplus">+  tok-&gt;stack[depth].current = NULL;</span>
<a href="#l32.150"></a><span id="l32.150" class="difflineplus">+  free(tok-&gt;stack[depth].obj_field_name);</span>
<a href="#l32.151"></a><span id="l32.151" class="difflineplus">+  tok-&gt;stack[depth].obj_field_name = NULL;</span>
<a href="#l32.152"></a><span id="l32.152" class="difflineplus">+}</span>
<a href="#l32.153"></a><span id="l32.153" class="difflineplus">+</span>
<a href="#l32.154"></a><span id="l32.154" class="difflineplus">+void json_tokener_reset(struct json_tokener *tok)</span>
<a href="#l32.155"></a><span id="l32.155" class="difflineplus">+{</span>
<a href="#l32.156"></a><span id="l32.156" class="difflineplus">+  int i;</span>
<a href="#l32.157"></a><span id="l32.157" class="difflineplus">+  if (!tok)</span>
<a href="#l32.158"></a><span id="l32.158" class="difflineplus">+    return;</span>
<a href="#l32.159"></a><span id="l32.159" class="difflineplus">+</span>
<a href="#l32.160"></a><span id="l32.160" class="difflineplus">+  for(i = tok-&gt;depth; i &gt;= 0; i--)</span>
<a href="#l32.161"></a><span id="l32.161" class="difflineplus">+    json_tokener_reset_level(tok, i);</span>
<a href="#l32.162"></a><span id="l32.162" class="difflineplus">+  tok-&gt;depth = 0;</span>
<a href="#l32.163"></a><span id="l32.163" class="difflineplus">+  tok-&gt;err = json_tokener_success;</span>
<a href="#l32.164"></a><span id="l32.164" class="difflineplus">+}</span>
<a href="#l32.165"></a><span id="l32.165" class="difflineplus">+</span>
<a href="#l32.166"></a><span id="l32.166" class="difflineplus">+struct json_object* json_tokener_parse(const char *str)</span>
<a href="#l32.167"></a><span id="l32.167" class="difflineplus">+{</span>
<a href="#l32.168"></a><span id="l32.168" class="difflineplus">+    enum json_tokener_error jerr_ignored;</span>
<a href="#l32.169"></a><span id="l32.169" class="difflineplus">+    struct json_object* obj;</span>
<a href="#l32.170"></a><span id="l32.170" class="difflineplus">+    obj = json_tokener_parse_verbose(str, &amp;jerr_ignored);</span>
<a href="#l32.171"></a><span id="l32.171" class="difflineplus">+    return obj;</span>
<a href="#l32.172"></a><span id="l32.172" class="difflineplus">+}</span>
<a href="#l32.173"></a><span id="l32.173" class="difflineplus">+</span>
<a href="#l32.174"></a><span id="l32.174" class="difflineplus">+struct json_object* json_tokener_parse_verbose(const char *str,</span>
<a href="#l32.175"></a><span id="l32.175" class="difflineplus">+					       enum json_tokener_error *error)</span>
<a href="#l32.176"></a><span id="l32.176" class="difflineplus">+{</span>
<a href="#l32.177"></a><span id="l32.177" class="difflineplus">+    struct json_tokener* tok;</span>
<a href="#l32.178"></a><span id="l32.178" class="difflineplus">+    struct json_object* obj;</span>
<a href="#l32.179"></a><span id="l32.179" class="difflineplus">+</span>
<a href="#l32.180"></a><span id="l32.180" class="difflineplus">+    tok = json_tokener_new();</span>
<a href="#l32.181"></a><span id="l32.181" class="difflineplus">+    if (!tok)</span>
<a href="#l32.182"></a><span id="l32.182" class="difflineplus">+      return NULL;</span>
<a href="#l32.183"></a><span id="l32.183" class="difflineplus">+    obj = json_tokener_parse_ex(tok, str, -1);</span>
<a href="#l32.184"></a><span id="l32.184" class="difflineplus">+    *error = tok-&gt;err;</span>
<a href="#l32.185"></a><span id="l32.185" class="difflineplus">+    if(tok-&gt;err != json_tokener_success) {</span>
<a href="#l32.186"></a><span id="l32.186" class="difflineplus">+		if (obj != NULL)</span>
<a href="#l32.187"></a><span id="l32.187" class="difflineplus">+			json_object_put(obj);</span>
<a href="#l32.188"></a><span id="l32.188" class="difflineplus">+        obj = NULL;</span>
<a href="#l32.189"></a><span id="l32.189" class="difflineplus">+    }</span>
<a href="#l32.190"></a><span id="l32.190" class="difflineplus">+</span>
<a href="#l32.191"></a><span id="l32.191" class="difflineplus">+    json_tokener_free(tok);</span>
<a href="#l32.192"></a><span id="l32.192" class="difflineplus">+    return obj;</span>
<a href="#l32.193"></a><span id="l32.193" class="difflineplus">+}</span>
<a href="#l32.194"></a><span id="l32.194" class="difflineplus">+</span>
<a href="#l32.195"></a><span id="l32.195" class="difflineplus">+#define state  tok-&gt;stack[tok-&gt;depth].state</span>
<a href="#l32.196"></a><span id="l32.196" class="difflineplus">+#define saved_state  tok-&gt;stack[tok-&gt;depth].saved_state</span>
<a href="#l32.197"></a><span id="l32.197" class="difflineplus">+#define current tok-&gt;stack[tok-&gt;depth].current</span>
<a href="#l32.198"></a><span id="l32.198" class="difflineplus">+#define obj_field_name tok-&gt;stack[tok-&gt;depth].obj_field_name</span>
<a href="#l32.199"></a><span id="l32.199" class="difflineplus">+</span>
<a href="#l32.200"></a><span id="l32.200" class="difflineplus">+/* Optimization:</span>
<a href="#l32.201"></a><span id="l32.201" class="difflineplus">+ * json_tokener_parse_ex() consumed a lot of CPU in its main loop,</span>
<a href="#l32.202"></a><span id="l32.202" class="difflineplus">+ * iterating character-by character.  A large performance boost is</span>
<a href="#l32.203"></a><span id="l32.203" class="difflineplus">+ * achieved by using tighter loops to locally handle units such as</span>
<a href="#l32.204"></a><span id="l32.204" class="difflineplus">+ * comments and strings.  Loops that handle an entire token within</span>
<a href="#l32.205"></a><span id="l32.205" class="difflineplus">+ * their scope also gather entire strings and pass them to</span>
<a href="#l32.206"></a><span id="l32.206" class="difflineplus">+ * printbuf_memappend() in a single call, rather than calling</span>
<a href="#l32.207"></a><span id="l32.207" class="difflineplus">+ * printbuf_memappend() one char at a time.</span>
<a href="#l32.208"></a><span id="l32.208" class="difflineplus">+ *</span>
<a href="#l32.209"></a><span id="l32.209" class="difflineplus">+ * PEEK_CHAR() and ADVANCE_CHAR() macros are used for code that is</span>
<a href="#l32.210"></a><span id="l32.210" class="difflineplus">+ * common to both the main loop and the tighter loops.</span>
<a href="#l32.211"></a><span id="l32.211" class="difflineplus">+ */</span>
<a href="#l32.212"></a><span id="l32.212" class="difflineplus">+</span>
<a href="#l32.213"></a><span id="l32.213" class="difflineplus">+/* PEEK_CHAR(dest, tok) macro:</span>
<a href="#l32.214"></a><span id="l32.214" class="difflineplus">+ *   Peeks at the current char and stores it in dest.</span>
<a href="#l32.215"></a><span id="l32.215" class="difflineplus">+ *   Returns 1 on success, sets tok-&gt;err and returns 0 if no more chars.</span>
<a href="#l32.216"></a><span id="l32.216" class="difflineplus">+ *   Implicit inputs:  str, len vars</span>
<a href="#l32.217"></a><span id="l32.217" class="difflineplus">+ */</span>
<a href="#l32.218"></a><span id="l32.218" class="difflineplus">+#define PEEK_CHAR(dest, tok)			\</span>
<a href="#l32.219"></a><span id="l32.219" class="difflineplus">+  (((tok)-&gt;char_offset == len) ?		\</span>
<a href="#l32.220"></a><span id="l32.220" class="difflineplus">+   (((tok)-&gt;depth == 0 &amp;&amp;			\</span>
<a href="#l32.221"></a><span id="l32.221" class="difflineplus">+     state == json_tokener_state_eatws &amp;&amp;	\</span>
<a href="#l32.222"></a><span id="l32.222" class="difflineplus">+     saved_state == json_tokener_state_finish	\</span>
<a href="#l32.223"></a><span id="l32.223" class="difflineplus">+     ) ?					\</span>
<a href="#l32.224"></a><span id="l32.224" class="difflineplus">+    (((tok)-&gt;err = json_tokener_success), 0)	\</span>
<a href="#l32.225"></a><span id="l32.225" class="difflineplus">+    :						\</span>
<a href="#l32.226"></a><span id="l32.226" class="difflineplus">+    (((tok)-&gt;err = json_tokener_continue), 0)	\</span>
<a href="#l32.227"></a><span id="l32.227" class="difflineplus">+    ) :						\</span>
<a href="#l32.228"></a><span id="l32.228" class="difflineplus">+   (((dest) = *str), 1)				\</span>
<a href="#l32.229"></a><span id="l32.229" class="difflineplus">+   )</span>
<a href="#l32.230"></a><span id="l32.230" class="difflineplus">+</span>
<a href="#l32.231"></a><span id="l32.231" class="difflineplus">+/* ADVANCE_CHAR() macro:</span>
<a href="#l32.232"></a><span id="l32.232" class="difflineplus">+ *   Incrementes str &amp; tok-&gt;char_offset.</span>
<a href="#l32.233"></a><span id="l32.233" class="difflineplus">+ *   For convenience of existing conditionals, returns the old value of c (0 on eof)</span>
<a href="#l32.234"></a><span id="l32.234" class="difflineplus">+ *   Implicit inputs:  c var</span>
<a href="#l32.235"></a><span id="l32.235" class="difflineplus">+ */</span>
<a href="#l32.236"></a><span id="l32.236" class="difflineplus">+#define ADVANCE_CHAR(str, tok) \</span>
<a href="#l32.237"></a><span id="l32.237" class="difflineplus">+  ( ++(str), ((tok)-&gt;char_offset)++, c)</span>
<a href="#l32.238"></a><span id="l32.238" class="difflineplus">+</span>
<a href="#l32.239"></a><span id="l32.239" class="difflineplus">+</span>
<a href="#l32.240"></a><span id="l32.240" class="difflineplus">+/* End optimization macro defs */</span>
<a href="#l32.241"></a><span id="l32.241" class="difflineplus">+</span>
<a href="#l32.242"></a><span id="l32.242" class="difflineplus">+</span>
<a href="#l32.243"></a><span id="l32.243" class="difflineplus">+struct json_object* json_tokener_parse_ex(struct json_tokener *tok,</span>
<a href="#l32.244"></a><span id="l32.244" class="difflineplus">+					  const char *str, int len)</span>
<a href="#l32.245"></a><span id="l32.245" class="difflineplus">+{</span>
<a href="#l32.246"></a><span id="l32.246" class="difflineplus">+  struct json_object *obj = NULL;</span>
<a href="#l32.247"></a><span id="l32.247" class="difflineplus">+  char c = '\1';</span>
<a href="#l32.248"></a><span id="l32.248" class="difflineplus">+#ifdef HAVE_USELOCALE</span>
<a href="#l32.249"></a><span id="l32.249" class="difflineplus">+  locale_t oldlocale = uselocale(NULL);</span>
<a href="#l32.250"></a><span id="l32.250" class="difflineplus">+  locale_t newloc;</span>
<a href="#l32.251"></a><span id="l32.251" class="difflineplus">+#elif defined(HAVE_SETLOCALE)</span>
<a href="#l32.252"></a><span id="l32.252" class="difflineplus">+  char *oldlocale = NULL;</span>
<a href="#l32.253"></a><span id="l32.253" class="difflineplus">+#endif</span>
<a href="#l32.254"></a><span id="l32.254" class="difflineplus">+</span>
<a href="#l32.255"></a><span id="l32.255" class="difflineplus">+  tok-&gt;char_offset = 0;</span>
<a href="#l32.256"></a><span id="l32.256" class="difflineplus">+  tok-&gt;err = json_tokener_success;</span>
<a href="#l32.257"></a><span id="l32.257" class="difflineplus">+</span>
<a href="#l32.258"></a><span id="l32.258" class="difflineplus">+  /* this interface is presently not 64-bit clean due to the int len argument</span>
<a href="#l32.259"></a><span id="l32.259" class="difflineplus">+     and the internal printbuf interface that takes 32-bit int len arguments</span>
<a href="#l32.260"></a><span id="l32.260" class="difflineplus">+     so the function limits the maximum string size to INT32_MAX (2GB).</span>
<a href="#l32.261"></a><span id="l32.261" class="difflineplus">+     If the function is called with len == -1 then strlen is called to check</span>
<a href="#l32.262"></a><span id="l32.262" class="difflineplus">+     the string length is less than INT32_MAX (2GB) */</span>
<a href="#l32.263"></a><span id="l32.263" class="difflineplus">+  if ((len &lt; -1) || (len == -1 &amp;&amp; strlen(str) &gt; INT32_MAX)) {</span>
<a href="#l32.264"></a><span id="l32.264" class="difflineplus">+    tok-&gt;err = json_tokener_error_size;</span>
<a href="#l32.265"></a><span id="l32.265" class="difflineplus">+    return NULL;</span>
<a href="#l32.266"></a><span id="l32.266" class="difflineplus">+  }</span>
<a href="#l32.267"></a><span id="l32.267" class="difflineplus">+</span>
<a href="#l32.268"></a><span id="l32.268" class="difflineplus">+#ifdef HAVE_USELOCALE</span>
<a href="#l32.269"></a><span id="l32.269" class="difflineplus">+  {</span>
<a href="#l32.270"></a><span id="l32.270" class="difflineplus">+    locale_t duploc = duplocale(oldlocale);</span>
<a href="#l32.271"></a><span id="l32.271" class="difflineplus">+    newloc = newlocale(LC_NUMERIC, &quot;C&quot;, duploc);</span>
<a href="#l32.272"></a><span id="l32.272" class="difflineplus">+    // XXX at least Debian 8.4 has a bug in newlocale where it doesn't</span>
<a href="#l32.273"></a><span id="l32.273" class="difflineplus">+    //  change the decimal separator unless you set LC_TIME!</span>
<a href="#l32.274"></a><span id="l32.274" class="difflineplus">+    if (newloc)</span>
<a href="#l32.275"></a><span id="l32.275" class="difflineplus">+    {</span>
<a href="#l32.276"></a><span id="l32.276" class="difflineplus">+      duploc = newloc; // original duploc has been freed by newlocale()</span>
<a href="#l32.277"></a><span id="l32.277" class="difflineplus">+      newloc = newlocale(LC_TIME, &quot;C&quot;, duploc);</span>
<a href="#l32.278"></a><span id="l32.278" class="difflineplus">+    }</span>
<a href="#l32.279"></a><span id="l32.279" class="difflineplus">+    if (newloc == NULL)</span>
<a href="#l32.280"></a><span id="l32.280" class="difflineplus">+    {</span>
<a href="#l32.281"></a><span id="l32.281" class="difflineplus">+      freelocale(duploc);</span>
<a href="#l32.282"></a><span id="l32.282" class="difflineplus">+      return NULL;</span>
<a href="#l32.283"></a><span id="l32.283" class="difflineplus">+    }</span>
<a href="#l32.284"></a><span id="l32.284" class="difflineplus">+    uselocale(newloc);</span>
<a href="#l32.285"></a><span id="l32.285" class="difflineplus">+  }</span>
<a href="#l32.286"></a><span id="l32.286" class="difflineplus">+#elif defined(HAVE_SETLOCALE)</span>
<a href="#l32.287"></a><span id="l32.287" class="difflineplus">+  {</span>
<a href="#l32.288"></a><span id="l32.288" class="difflineplus">+    char *tmplocale;</span>
<a href="#l32.289"></a><span id="l32.289" class="difflineplus">+    tmplocale = setlocale(LC_NUMERIC, NULL);</span>
<a href="#l32.290"></a><span id="l32.290" class="difflineplus">+    if (tmplocale) oldlocale = strdup(tmplocale);</span>
<a href="#l32.291"></a><span id="l32.291" class="difflineplus">+    setlocale(LC_NUMERIC, &quot;C&quot;);</span>
<a href="#l32.292"></a><span id="l32.292" class="difflineplus">+  }</span>
<a href="#l32.293"></a><span id="l32.293" class="difflineplus">+#endif</span>
<a href="#l32.294"></a><span id="l32.294" class="difflineplus">+</span>
<a href="#l32.295"></a><span id="l32.295" class="difflineplus">+  while (PEEK_CHAR(c, tok)) {</span>
<a href="#l32.296"></a><span id="l32.296" class="difflineplus">+</span>
<a href="#l32.297"></a><span id="l32.297" class="difflineplus">+  redo_char:</span>
<a href="#l32.298"></a><span id="l32.298" class="difflineplus">+    switch(state) {</span>
<a href="#l32.299"></a><span id="l32.299" class="difflineplus">+</span>
<a href="#l32.300"></a><span id="l32.300" class="difflineplus">+    case json_tokener_state_eatws:</span>
<a href="#l32.301"></a><span id="l32.301" class="difflineplus">+      /* Advance until we change state */</span>
<a href="#l32.302"></a><span id="l32.302" class="difflineplus">+      while (isspace((int)c)) {</span>
<a href="#l32.303"></a><span id="l32.303" class="difflineplus">+	if ((!ADVANCE_CHAR(str, tok)) || (!PEEK_CHAR(c, tok)))</span>
<a href="#l32.304"></a><span id="l32.304" class="difflineplus">+	  goto out;</span>
<a href="#l32.305"></a><span id="l32.305" class="difflineplus">+      }</span>
<a href="#l32.306"></a><span id="l32.306" class="difflineplus">+      if(c == '/' &amp;&amp; !(tok-&gt;flags &amp; JSON_TOKENER_STRICT)) {</span>
<a href="#l32.307"></a><span id="l32.307" class="difflineplus">+	printbuf_reset(tok-&gt;pb);</span>
<a href="#l32.308"></a><span id="l32.308" class="difflineplus">+	printbuf_memappend_fast(tok-&gt;pb, &amp;c, 1);</span>
<a href="#l32.309"></a><span id="l32.309" class="difflineplus">+	state = json_tokener_state_comment_start;</span>
<a href="#l32.310"></a><span id="l32.310" class="difflineplus">+      } else {</span>
<a href="#l32.311"></a><span id="l32.311" class="difflineplus">+	state = saved_state;</span>
<a href="#l32.312"></a><span id="l32.312" class="difflineplus">+	goto redo_char;</span>
<a href="#l32.313"></a><span id="l32.313" class="difflineplus">+      }</span>
<a href="#l32.314"></a><span id="l32.314" class="difflineplus">+      break;</span>
<a href="#l32.315"></a><span id="l32.315" class="difflineplus">+</span>
<a href="#l32.316"></a><span id="l32.316" class="difflineplus">+    case json_tokener_state_start:</span>
<a href="#l32.317"></a><span id="l32.317" class="difflineplus">+      switch(c) {</span>
<a href="#l32.318"></a><span id="l32.318" class="difflineplus">+      case '{':</span>
<a href="#l32.319"></a><span id="l32.319" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.320"></a><span id="l32.320" class="difflineplus">+	saved_state = json_tokener_state_object_field_start;</span>
<a href="#l32.321"></a><span id="l32.321" class="difflineplus">+	current = json_object_new_object();</span>
<a href="#l32.322"></a><span id="l32.322" class="difflineplus">+	if(current == NULL)</span>
<a href="#l32.323"></a><span id="l32.323" class="difflineplus">+		goto out;</span>
<a href="#l32.324"></a><span id="l32.324" class="difflineplus">+	break;</span>
<a href="#l32.325"></a><span id="l32.325" class="difflineplus">+      case '[':</span>
<a href="#l32.326"></a><span id="l32.326" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.327"></a><span id="l32.327" class="difflineplus">+	saved_state = json_tokener_state_array;</span>
<a href="#l32.328"></a><span id="l32.328" class="difflineplus">+	current = json_object_new_array();</span>
<a href="#l32.329"></a><span id="l32.329" class="difflineplus">+	if(current == NULL)</span>
<a href="#l32.330"></a><span id="l32.330" class="difflineplus">+		goto out;</span>
<a href="#l32.331"></a><span id="l32.331" class="difflineplus">+	break;</span>
<a href="#l32.332"></a><span id="l32.332" class="difflineplus">+      case 'I':</span>
<a href="#l32.333"></a><span id="l32.333" class="difflineplus">+      case 'i':</span>
<a href="#l32.334"></a><span id="l32.334" class="difflineplus">+	state = json_tokener_state_inf;</span>
<a href="#l32.335"></a><span id="l32.335" class="difflineplus">+	printbuf_reset(tok-&gt;pb);</span>
<a href="#l32.336"></a><span id="l32.336" class="difflineplus">+	tok-&gt;st_pos = 0;</span>
<a href="#l32.337"></a><span id="l32.337" class="difflineplus">+	goto redo_char;</span>
<a href="#l32.338"></a><span id="l32.338" class="difflineplus">+      case 'N':</span>
<a href="#l32.339"></a><span id="l32.339" class="difflineplus">+      case 'n':</span>
<a href="#l32.340"></a><span id="l32.340" class="difflineplus">+	state = json_tokener_state_null; // or NaN</span>
<a href="#l32.341"></a><span id="l32.341" class="difflineplus">+	printbuf_reset(tok-&gt;pb);</span>
<a href="#l32.342"></a><span id="l32.342" class="difflineplus">+	tok-&gt;st_pos = 0;</span>
<a href="#l32.343"></a><span id="l32.343" class="difflineplus">+	goto redo_char;</span>
<a href="#l32.344"></a><span id="l32.344" class="difflineplus">+      case '\'':</span>
<a href="#l32.345"></a><span id="l32.345" class="difflineplus">+        if (tok-&gt;flags &amp; JSON_TOKENER_STRICT) {</span>
<a href="#l32.346"></a><span id="l32.346" class="difflineplus">+            /* in STRICT mode only double-quote are allowed */</span>
<a href="#l32.347"></a><span id="l32.347" class="difflineplus">+            tok-&gt;err = json_tokener_error_parse_unexpected;</span>
<a href="#l32.348"></a><span id="l32.348" class="difflineplus">+            goto out;</span>
<a href="#l32.349"></a><span id="l32.349" class="difflineplus">+        }</span>
<a href="#l32.350"></a><span id="l32.350" class="difflineplus">+	/* FALLTHRU */</span>
<a href="#l32.351"></a><span id="l32.351" class="difflineplus">+      case '&quot;':</span>
<a href="#l32.352"></a><span id="l32.352" class="difflineplus">+	state = json_tokener_state_string;</span>
<a href="#l32.353"></a><span id="l32.353" class="difflineplus">+	printbuf_reset(tok-&gt;pb);</span>
<a href="#l32.354"></a><span id="l32.354" class="difflineplus">+	tok-&gt;quote_char = c;</span>
<a href="#l32.355"></a><span id="l32.355" class="difflineplus">+	break;</span>
<a href="#l32.356"></a><span id="l32.356" class="difflineplus">+      case 'T':</span>
<a href="#l32.357"></a><span id="l32.357" class="difflineplus">+      case 't':</span>
<a href="#l32.358"></a><span id="l32.358" class="difflineplus">+      case 'F':</span>
<a href="#l32.359"></a><span id="l32.359" class="difflineplus">+      case 'f':</span>
<a href="#l32.360"></a><span id="l32.360" class="difflineplus">+	state = json_tokener_state_boolean;</span>
<a href="#l32.361"></a><span id="l32.361" class="difflineplus">+	printbuf_reset(tok-&gt;pb);</span>
<a href="#l32.362"></a><span id="l32.362" class="difflineplus">+	tok-&gt;st_pos = 0;</span>
<a href="#l32.363"></a><span id="l32.363" class="difflineplus">+	goto redo_char;</span>
<a href="#l32.364"></a><span id="l32.364" class="difflineplus">+      case '0':</span>
<a href="#l32.365"></a><span id="l32.365" class="difflineplus">+      case '1':</span>
<a href="#l32.366"></a><span id="l32.366" class="difflineplus">+      case '2':</span>
<a href="#l32.367"></a><span id="l32.367" class="difflineplus">+      case '3':</span>
<a href="#l32.368"></a><span id="l32.368" class="difflineplus">+      case '4':</span>
<a href="#l32.369"></a><span id="l32.369" class="difflineplus">+      case '5':</span>
<a href="#l32.370"></a><span id="l32.370" class="difflineplus">+      case '6':</span>
<a href="#l32.371"></a><span id="l32.371" class="difflineplus">+      case '7':</span>
<a href="#l32.372"></a><span id="l32.372" class="difflineplus">+      case '8':</span>
<a href="#l32.373"></a><span id="l32.373" class="difflineplus">+      case '9':</span>
<a href="#l32.374"></a><span id="l32.374" class="difflineplus">+      case '-':</span>
<a href="#l32.375"></a><span id="l32.375" class="difflineplus">+	state = json_tokener_state_number;</span>
<a href="#l32.376"></a><span id="l32.376" class="difflineplus">+	printbuf_reset(tok-&gt;pb);</span>
<a href="#l32.377"></a><span id="l32.377" class="difflineplus">+	tok-&gt;is_double = 0;</span>
<a href="#l32.378"></a><span id="l32.378" class="difflineplus">+	goto redo_char;</span>
<a href="#l32.379"></a><span id="l32.379" class="difflineplus">+      default:</span>
<a href="#l32.380"></a><span id="l32.380" class="difflineplus">+	tok-&gt;err = json_tokener_error_parse_unexpected;</span>
<a href="#l32.381"></a><span id="l32.381" class="difflineplus">+	goto out;</span>
<a href="#l32.382"></a><span id="l32.382" class="difflineplus">+      }</span>
<a href="#l32.383"></a><span id="l32.383" class="difflineplus">+      break;</span>
<a href="#l32.384"></a><span id="l32.384" class="difflineplus">+</span>
<a href="#l32.385"></a><span id="l32.385" class="difflineplus">+    case json_tokener_state_finish:</span>
<a href="#l32.386"></a><span id="l32.386" class="difflineplus">+      if(tok-&gt;depth == 0) goto out;</span>
<a href="#l32.387"></a><span id="l32.387" class="difflineplus">+      obj = json_object_get(current);</span>
<a href="#l32.388"></a><span id="l32.388" class="difflineplus">+      json_tokener_reset_level(tok, tok-&gt;depth);</span>
<a href="#l32.389"></a><span id="l32.389" class="difflineplus">+      tok-&gt;depth--;</span>
<a href="#l32.390"></a><span id="l32.390" class="difflineplus">+      goto redo_char;</span>
<a href="#l32.391"></a><span id="l32.391" class="difflineplus">+</span>
<a href="#l32.392"></a><span id="l32.392" class="difflineplus">+    case json_tokener_state_inf: /* aka starts with 'i' (or 'I', or &quot;-i&quot;, or &quot;-I&quot;) */</span>
<a href="#l32.393"></a><span id="l32.393" class="difflineplus">+      {</span>
<a href="#l32.394"></a><span id="l32.394" class="difflineplus">+	/* If we were guaranteed to have len set, then we could (usually) handle</span>
<a href="#l32.395"></a><span id="l32.395" class="difflineplus">+	 * the entire &quot;Infinity&quot; check in a single strncmp (strncasecmp), but</span>
<a href="#l32.396"></a><span id="l32.396" class="difflineplus">+	 * since len might be -1 (i.e. &quot;read until \0&quot;), we need to check it</span>
<a href="#l32.397"></a><span id="l32.397" class="difflineplus">+	 * a character at a time.</span>
<a href="#l32.398"></a><span id="l32.398" class="difflineplus">+	 * Trying to handle it both ways would make this code considerably more</span>
<a href="#l32.399"></a><span id="l32.399" class="difflineplus">+	 * complicated with likely little performance benefit.</span>
<a href="#l32.400"></a><span id="l32.400" class="difflineplus">+	 */</span>
<a href="#l32.401"></a><span id="l32.401" class="difflineplus">+	int is_negative = 0;</span>
<a href="#l32.402"></a><span id="l32.402" class="difflineplus">+	const char *_json_inf_str = json_inf_str;</span>
<a href="#l32.403"></a><span id="l32.403" class="difflineplus">+	if (!(tok-&gt;flags &amp; JSON_TOKENER_STRICT))</span>
<a href="#l32.404"></a><span id="l32.404" class="difflineplus">+		_json_inf_str = json_inf_str_lower;</span>
<a href="#l32.405"></a><span id="l32.405" class="difflineplus">+</span>
<a href="#l32.406"></a><span id="l32.406" class="difflineplus">+	/* Note: tok-&gt;st_pos must be 0 when state is set to json_tokener_state_inf */</span>
<a href="#l32.407"></a><span id="l32.407" class="difflineplus">+	while (tok-&gt;st_pos &lt; (int)json_inf_str_len)</span>
<a href="#l32.408"></a><span id="l32.408" class="difflineplus">+	{</span>
<a href="#l32.409"></a><span id="l32.409" class="difflineplus">+		char inf_char = *str;</span>
<a href="#l32.410"></a><span id="l32.410" class="difflineplus">+		if (!(tok-&gt;flags &amp; JSON_TOKENER_STRICT))</span>
<a href="#l32.411"></a><span id="l32.411" class="difflineplus">+			inf_char = tolower((int)*str);</span>
<a href="#l32.412"></a><span id="l32.412" class="difflineplus">+		if (inf_char != _json_inf_str[tok-&gt;st_pos])</span>
<a href="#l32.413"></a><span id="l32.413" class="difflineplus">+		{</span>
<a href="#l32.414"></a><span id="l32.414" class="difflineplus">+			tok-&gt;err = json_tokener_error_parse_unexpected;</span>
<a href="#l32.415"></a><span id="l32.415" class="difflineplus">+			goto out;</span>
<a href="#l32.416"></a><span id="l32.416" class="difflineplus">+		}</span>
<a href="#l32.417"></a><span id="l32.417" class="difflineplus">+		tok-&gt;st_pos++;</span>
<a href="#l32.418"></a><span id="l32.418" class="difflineplus">+		(void)ADVANCE_CHAR(str, tok);</span>
<a href="#l32.419"></a><span id="l32.419" class="difflineplus">+		if (!PEEK_CHAR(c, tok))</span>
<a href="#l32.420"></a><span id="l32.420" class="difflineplus">+		{</span>
<a href="#l32.421"></a><span id="l32.421" class="difflineplus">+			/* out of input chars, for now at least */</span>
<a href="#l32.422"></a><span id="l32.422" class="difflineplus">+			goto out;</span>
<a href="#l32.423"></a><span id="l32.423" class="difflineplus">+		}</span>
<a href="#l32.424"></a><span id="l32.424" class="difflineplus">+	}</span>
<a href="#l32.425"></a><span id="l32.425" class="difflineplus">+	/* We checked the full length of &quot;Infinity&quot;, so create the object.</span>
<a href="#l32.426"></a><span id="l32.426" class="difflineplus">+	 * When handling -Infinity, the number parsing code will have dropped</span>
<a href="#l32.427"></a><span id="l32.427" class="difflineplus">+	 * the &quot;-&quot; into tok-&gt;pb for us, so check it now.</span>
<a href="#l32.428"></a><span id="l32.428" class="difflineplus">+	 */</span>
<a href="#l32.429"></a><span id="l32.429" class="difflineplus">+	if (printbuf_length(tok-&gt;pb) &gt; 0 &amp;&amp; *(tok-&gt;pb-&gt;buf) == '-')</span>
<a href="#l32.430"></a><span id="l32.430" class="difflineplus">+	{</span>
<a href="#l32.431"></a><span id="l32.431" class="difflineplus">+		is_negative = 1;</span>
<a href="#l32.432"></a><span id="l32.432" class="difflineplus">+	}</span>
<a href="#l32.433"></a><span id="l32.433" class="difflineplus">+	current = json_object_new_double(is_negative</span>
<a href="#l32.434"></a><span id="l32.434" class="difflineplus">+					 ? -INFINITY : INFINITY);</span>
<a href="#l32.435"></a><span id="l32.435" class="difflineplus">+	if (current == NULL)</span>
<a href="#l32.436"></a><span id="l32.436" class="difflineplus">+		goto out;</span>
<a href="#l32.437"></a><span id="l32.437" class="difflineplus">+	saved_state = json_tokener_state_finish;</span>
<a href="#l32.438"></a><span id="l32.438" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.439"></a><span id="l32.439" class="difflineplus">+	goto redo_char;</span>
<a href="#l32.440"></a><span id="l32.440" class="difflineplus">+	 </span>
<a href="#l32.441"></a><span id="l32.441" class="difflineplus">+      }</span>
<a href="#l32.442"></a><span id="l32.442" class="difflineplus">+      break;</span>
<a href="#l32.443"></a><span id="l32.443" class="difflineplus">+    case json_tokener_state_null: /* aka starts with 'n' */</span>
<a href="#l32.444"></a><span id="l32.444" class="difflineplus">+      {</span>
<a href="#l32.445"></a><span id="l32.445" class="difflineplus">+	int size;</span>
<a href="#l32.446"></a><span id="l32.446" class="difflineplus">+	int size_nan;</span>
<a href="#l32.447"></a><span id="l32.447" class="difflineplus">+	printbuf_memappend_fast(tok-&gt;pb, &amp;c, 1);</span>
<a href="#l32.448"></a><span id="l32.448" class="difflineplus">+	size = json_min(tok-&gt;st_pos+1, json_null_str_len);</span>
<a href="#l32.449"></a><span id="l32.449" class="difflineplus">+	size_nan = json_min(tok-&gt;st_pos+1, json_nan_str_len);</span>
<a href="#l32.450"></a><span id="l32.450" class="difflineplus">+	if((!(tok-&gt;flags &amp; JSON_TOKENER_STRICT) &amp;&amp;</span>
<a href="#l32.451"></a><span id="l32.451" class="difflineplus">+	  strncasecmp(json_null_str, tok-&gt;pb-&gt;buf, size) == 0)</span>
<a href="#l32.452"></a><span id="l32.452" class="difflineplus">+	  || (strncmp(json_null_str, tok-&gt;pb-&gt;buf, size) == 0)</span>
<a href="#l32.453"></a><span id="l32.453" class="difflineplus">+	  ) {</span>
<a href="#l32.454"></a><span id="l32.454" class="difflineplus">+	  if (tok-&gt;st_pos == json_null_str_len) {</span>
<a href="#l32.455"></a><span id="l32.455" class="difflineplus">+	    current = NULL;</span>
<a href="#l32.456"></a><span id="l32.456" class="difflineplus">+	    saved_state = json_tokener_state_finish;</span>
<a href="#l32.457"></a><span id="l32.457" class="difflineplus">+	    state = json_tokener_state_eatws;</span>
<a href="#l32.458"></a><span id="l32.458" class="difflineplus">+	    goto redo_char;</span>
<a href="#l32.459"></a><span id="l32.459" class="difflineplus">+	  }</span>
<a href="#l32.460"></a><span id="l32.460" class="difflineplus">+	}</span>
<a href="#l32.461"></a><span id="l32.461" class="difflineplus">+	else if ((!(tok-&gt;flags &amp; JSON_TOKENER_STRICT) &amp;&amp;</span>
<a href="#l32.462"></a><span id="l32.462" class="difflineplus">+	          strncasecmp(json_nan_str, tok-&gt;pb-&gt;buf, size_nan) == 0) ||</span>
<a href="#l32.463"></a><span id="l32.463" class="difflineplus">+	         (strncmp(json_nan_str, tok-&gt;pb-&gt;buf, size_nan) == 0)</span>
<a href="#l32.464"></a><span id="l32.464" class="difflineplus">+	        )</span>
<a href="#l32.465"></a><span id="l32.465" class="difflineplus">+	{</span>
<a href="#l32.466"></a><span id="l32.466" class="difflineplus">+		if (tok-&gt;st_pos == json_nan_str_len)</span>
<a href="#l32.467"></a><span id="l32.467" class="difflineplus">+		{</span>
<a href="#l32.468"></a><span id="l32.468" class="difflineplus">+			current = json_object_new_double(NAN);</span>
<a href="#l32.469"></a><span id="l32.469" class="difflineplus">+			if (current == NULL)</span>
<a href="#l32.470"></a><span id="l32.470" class="difflineplus">+			    goto out;</span>
<a href="#l32.471"></a><span id="l32.471" class="difflineplus">+			saved_state = json_tokener_state_finish;</span>
<a href="#l32.472"></a><span id="l32.472" class="difflineplus">+			state = json_tokener_state_eatws;</span>
<a href="#l32.473"></a><span id="l32.473" class="difflineplus">+			goto redo_char;</span>
<a href="#l32.474"></a><span id="l32.474" class="difflineplus">+		}</span>
<a href="#l32.475"></a><span id="l32.475" class="difflineplus">+	} else {</span>
<a href="#l32.476"></a><span id="l32.476" class="difflineplus">+	  tok-&gt;err = json_tokener_error_parse_null;</span>
<a href="#l32.477"></a><span id="l32.477" class="difflineplus">+	  goto out;</span>
<a href="#l32.478"></a><span id="l32.478" class="difflineplus">+	}</span>
<a href="#l32.479"></a><span id="l32.479" class="difflineplus">+	tok-&gt;st_pos++;</span>
<a href="#l32.480"></a><span id="l32.480" class="difflineplus">+      }</span>
<a href="#l32.481"></a><span id="l32.481" class="difflineplus">+      break;</span>
<a href="#l32.482"></a><span id="l32.482" class="difflineplus">+</span>
<a href="#l32.483"></a><span id="l32.483" class="difflineplus">+    case json_tokener_state_comment_start:</span>
<a href="#l32.484"></a><span id="l32.484" class="difflineplus">+      if(c == '*') {</span>
<a href="#l32.485"></a><span id="l32.485" class="difflineplus">+	state = json_tokener_state_comment;</span>
<a href="#l32.486"></a><span id="l32.486" class="difflineplus">+      } else if(c == '/') {</span>
<a href="#l32.487"></a><span id="l32.487" class="difflineplus">+	state = json_tokener_state_comment_eol;</span>
<a href="#l32.488"></a><span id="l32.488" class="difflineplus">+      } else {</span>
<a href="#l32.489"></a><span id="l32.489" class="difflineplus">+	tok-&gt;err = json_tokener_error_parse_comment;</span>
<a href="#l32.490"></a><span id="l32.490" class="difflineplus">+	goto out;</span>
<a href="#l32.491"></a><span id="l32.491" class="difflineplus">+      }</span>
<a href="#l32.492"></a><span id="l32.492" class="difflineplus">+      printbuf_memappend_fast(tok-&gt;pb, &amp;c, 1);</span>
<a href="#l32.493"></a><span id="l32.493" class="difflineplus">+      break;</span>
<a href="#l32.494"></a><span id="l32.494" class="difflineplus">+</span>
<a href="#l32.495"></a><span id="l32.495" class="difflineplus">+    case json_tokener_state_comment:</span>
<a href="#l32.496"></a><span id="l32.496" class="difflineplus">+              {</span>
<a href="#l32.497"></a><span id="l32.497" class="difflineplus">+          /* Advance until we change state */</span>
<a href="#l32.498"></a><span id="l32.498" class="difflineplus">+          const char *case_start = str;</span>
<a href="#l32.499"></a><span id="l32.499" class="difflineplus">+          while(c != '*') {</span>
<a href="#l32.500"></a><span id="l32.500" class="difflineplus">+            if (!ADVANCE_CHAR(str, tok) || !PEEK_CHAR(c, tok)) {</span>
<a href="#l32.501"></a><span id="l32.501" class="difflineplus">+              printbuf_memappend_fast(tok-&gt;pb, case_start, str-case_start);</span>
<a href="#l32.502"></a><span id="l32.502" class="difflineplus">+              goto out;</span>
<a href="#l32.503"></a><span id="l32.503" class="difflineplus">+            }</span>
<a href="#l32.504"></a><span id="l32.504" class="difflineplus">+          }</span>
<a href="#l32.505"></a><span id="l32.505" class="difflineplus">+          printbuf_memappend_fast(tok-&gt;pb, case_start, 1+str-case_start);</span>
<a href="#l32.506"></a><span id="l32.506" class="difflineplus">+          state = json_tokener_state_comment_end;</span>
<a href="#l32.507"></a><span id="l32.507" class="difflineplus">+        }</span>
<a href="#l32.508"></a><span id="l32.508" class="difflineplus">+            break;</span>
<a href="#l32.509"></a><span id="l32.509" class="difflineplus">+</span>
<a href="#l32.510"></a><span id="l32.510" class="difflineplus">+    case json_tokener_state_comment_eol:</span>
<a href="#l32.511"></a><span id="l32.511" class="difflineplus">+      {</span>
<a href="#l32.512"></a><span id="l32.512" class="difflineplus">+	/* Advance until we change state */</span>
<a href="#l32.513"></a><span id="l32.513" class="difflineplus">+	const char *case_start = str;</span>
<a href="#l32.514"></a><span id="l32.514" class="difflineplus">+	while(c != '\n') {</span>
<a href="#l32.515"></a><span id="l32.515" class="difflineplus">+	  if (!ADVANCE_CHAR(str, tok) || !PEEK_CHAR(c, tok)) {</span>
<a href="#l32.516"></a><span id="l32.516" class="difflineplus">+	    printbuf_memappend_fast(tok-&gt;pb, case_start, str-case_start);</span>
<a href="#l32.517"></a><span id="l32.517" class="difflineplus">+	    goto out;</span>
<a href="#l32.518"></a><span id="l32.518" class="difflineplus">+	  }</span>
<a href="#l32.519"></a><span id="l32.519" class="difflineplus">+	}</span>
<a href="#l32.520"></a><span id="l32.520" class="difflineplus">+	printbuf_memappend_fast(tok-&gt;pb, case_start, str-case_start);</span>
<a href="#l32.521"></a><span id="l32.521" class="difflineplus">+	MC_DEBUG(&quot;json_tokener_comment: %s\n&quot;, tok-&gt;pb-&gt;buf);</span>
<a href="#l32.522"></a><span id="l32.522" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.523"></a><span id="l32.523" class="difflineplus">+      }</span>
<a href="#l32.524"></a><span id="l32.524" class="difflineplus">+      break;</span>
<a href="#l32.525"></a><span id="l32.525" class="difflineplus">+</span>
<a href="#l32.526"></a><span id="l32.526" class="difflineplus">+    case json_tokener_state_comment_end:</span>
<a href="#l32.527"></a><span id="l32.527" class="difflineplus">+      printbuf_memappend_fast(tok-&gt;pb, &amp;c, 1);</span>
<a href="#l32.528"></a><span id="l32.528" class="difflineplus">+      if(c == '/') {</span>
<a href="#l32.529"></a><span id="l32.529" class="difflineplus">+	MC_DEBUG(&quot;json_tokener_comment: %s\n&quot;, tok-&gt;pb-&gt;buf);</span>
<a href="#l32.530"></a><span id="l32.530" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.531"></a><span id="l32.531" class="difflineplus">+      } else {</span>
<a href="#l32.532"></a><span id="l32.532" class="difflineplus">+	state = json_tokener_state_comment;</span>
<a href="#l32.533"></a><span id="l32.533" class="difflineplus">+      }</span>
<a href="#l32.534"></a><span id="l32.534" class="difflineplus">+      break;</span>
<a href="#l32.535"></a><span id="l32.535" class="difflineplus">+</span>
<a href="#l32.536"></a><span id="l32.536" class="difflineplus">+    case json_tokener_state_string:</span>
<a href="#l32.537"></a><span id="l32.537" class="difflineplus">+      {</span>
<a href="#l32.538"></a><span id="l32.538" class="difflineplus">+	/* Advance until we change state */</span>
<a href="#l32.539"></a><span id="l32.539" class="difflineplus">+	const char *case_start = str;</span>
<a href="#l32.540"></a><span id="l32.540" class="difflineplus">+	while(1) {</span>
<a href="#l32.541"></a><span id="l32.541" class="difflineplus">+	  if(c == tok-&gt;quote_char) {</span>
<a href="#l32.542"></a><span id="l32.542" class="difflineplus">+	    printbuf_memappend_fast(tok-&gt;pb, case_start, str-case_start);</span>
<a href="#l32.543"></a><span id="l32.543" class="difflineplus">+	    current = json_object_new_string_len(tok-&gt;pb-&gt;buf, tok-&gt;pb-&gt;bpos);</span>
<a href="#l32.544"></a><span id="l32.544" class="difflineplus">+	    if(current == NULL)</span>
<a href="#l32.545"></a><span id="l32.545" class="difflineplus">+		goto out;</span>
<a href="#l32.546"></a><span id="l32.546" class="difflineplus">+	    saved_state = json_tokener_state_finish;</span>
<a href="#l32.547"></a><span id="l32.547" class="difflineplus">+	    state = json_tokener_state_eatws;</span>
<a href="#l32.548"></a><span id="l32.548" class="difflineplus">+	    break;</span>
<a href="#l32.549"></a><span id="l32.549" class="difflineplus">+	  } else if(c == '\\') {</span>
<a href="#l32.550"></a><span id="l32.550" class="difflineplus">+	    printbuf_memappend_fast(tok-&gt;pb, case_start, str-case_start);</span>
<a href="#l32.551"></a><span id="l32.551" class="difflineplus">+	    saved_state = json_tokener_state_string;</span>
<a href="#l32.552"></a><span id="l32.552" class="difflineplus">+	    state = json_tokener_state_string_escape;</span>
<a href="#l32.553"></a><span id="l32.553" class="difflineplus">+	    break;</span>
<a href="#l32.554"></a><span id="l32.554" class="difflineplus">+	  }</span>
<a href="#l32.555"></a><span id="l32.555" class="difflineplus">+	  if (!ADVANCE_CHAR(str, tok) || !PEEK_CHAR(c, tok)) {</span>
<a href="#l32.556"></a><span id="l32.556" class="difflineplus">+	    printbuf_memappend_fast(tok-&gt;pb, case_start, str-case_start);</span>
<a href="#l32.557"></a><span id="l32.557" class="difflineplus">+	    goto out;</span>
<a href="#l32.558"></a><span id="l32.558" class="difflineplus">+	  }</span>
<a href="#l32.559"></a><span id="l32.559" class="difflineplus">+	}</span>
<a href="#l32.560"></a><span id="l32.560" class="difflineplus">+      }</span>
<a href="#l32.561"></a><span id="l32.561" class="difflineplus">+      break;</span>
<a href="#l32.562"></a><span id="l32.562" class="difflineplus">+</span>
<a href="#l32.563"></a><span id="l32.563" class="difflineplus">+    case json_tokener_state_string_escape:</span>
<a href="#l32.564"></a><span id="l32.564" class="difflineplus">+      switch(c) {</span>
<a href="#l32.565"></a><span id="l32.565" class="difflineplus">+      case '&quot;':</span>
<a href="#l32.566"></a><span id="l32.566" class="difflineplus">+      case '\\':</span>
<a href="#l32.567"></a><span id="l32.567" class="difflineplus">+      case '/':</span>
<a href="#l32.568"></a><span id="l32.568" class="difflineplus">+	printbuf_memappend_fast(tok-&gt;pb, &amp;c, 1);</span>
<a href="#l32.569"></a><span id="l32.569" class="difflineplus">+	state = saved_state;</span>
<a href="#l32.570"></a><span id="l32.570" class="difflineplus">+	break;</span>
<a href="#l32.571"></a><span id="l32.571" class="difflineplus">+      case 'b':</span>
<a href="#l32.572"></a><span id="l32.572" class="difflineplus">+      case 'n':</span>
<a href="#l32.573"></a><span id="l32.573" class="difflineplus">+      case 'r':</span>
<a href="#l32.574"></a><span id="l32.574" class="difflineplus">+      case 't':</span>
<a href="#l32.575"></a><span id="l32.575" class="difflineplus">+      case 'f':</span>
<a href="#l32.576"></a><span id="l32.576" class="difflineplus">+	if(c == 'b') printbuf_memappend_fast(tok-&gt;pb, &quot;\b&quot;, 1);</span>
<a href="#l32.577"></a><span id="l32.577" class="difflineplus">+	else if(c == 'n') printbuf_memappend_fast(tok-&gt;pb, &quot;\n&quot;, 1);</span>
<a href="#l32.578"></a><span id="l32.578" class="difflineplus">+	else if(c == 'r') printbuf_memappend_fast(tok-&gt;pb, &quot;\r&quot;, 1);</span>
<a href="#l32.579"></a><span id="l32.579" class="difflineplus">+	else if(c == 't') printbuf_memappend_fast(tok-&gt;pb, &quot;\t&quot;, 1);</span>
<a href="#l32.580"></a><span id="l32.580" class="difflineplus">+	else if(c == 'f') printbuf_memappend_fast(tok-&gt;pb, &quot;\f&quot;, 1);</span>
<a href="#l32.581"></a><span id="l32.581" class="difflineplus">+	state = saved_state;</span>
<a href="#l32.582"></a><span id="l32.582" class="difflineplus">+	break;</span>
<a href="#l32.583"></a><span id="l32.583" class="difflineplus">+      case 'u':</span>
<a href="#l32.584"></a><span id="l32.584" class="difflineplus">+	tok-&gt;ucs_char = 0;</span>
<a href="#l32.585"></a><span id="l32.585" class="difflineplus">+	tok-&gt;st_pos = 0;</span>
<a href="#l32.586"></a><span id="l32.586" class="difflineplus">+	state = json_tokener_state_escape_unicode;</span>
<a href="#l32.587"></a><span id="l32.587" class="difflineplus">+	break;</span>
<a href="#l32.588"></a><span id="l32.588" class="difflineplus">+      default:</span>
<a href="#l32.589"></a><span id="l32.589" class="difflineplus">+	tok-&gt;err = json_tokener_error_parse_string;</span>
<a href="#l32.590"></a><span id="l32.590" class="difflineplus">+	goto out;</span>
<a href="#l32.591"></a><span id="l32.591" class="difflineplus">+      }</span>
<a href="#l32.592"></a><span id="l32.592" class="difflineplus">+      break;</span>
<a href="#l32.593"></a><span id="l32.593" class="difflineplus">+</span>
<a href="#l32.594"></a><span id="l32.594" class="difflineplus">+    case json_tokener_state_escape_unicode:</span>
<a href="#l32.595"></a><span id="l32.595" class="difflineplus">+	{</span>
<a href="#l32.596"></a><span id="l32.596" class="difflineplus">+          unsigned int got_hi_surrogate = 0;</span>
<a href="#l32.597"></a><span id="l32.597" class="difflineplus">+</span>
<a href="#l32.598"></a><span id="l32.598" class="difflineplus">+	  /* Handle a 4-byte sequence, or two sequences if a surrogate pair */</span>
<a href="#l32.599"></a><span id="l32.599" class="difflineplus">+	  while(1) {</span>
<a href="#l32.600"></a><span id="l32.600" class="difflineplus">+	    if (c &amp;&amp; strchr(json_hex_chars, c)) {</span>
<a href="#l32.601"></a><span id="l32.601" class="difflineplus">+	      tok-&gt;ucs_char += ((unsigned int)jt_hexdigit(c) &lt;&lt; ((3-tok-&gt;st_pos++)*4));</span>
<a href="#l32.602"></a><span id="l32.602" class="difflineplus">+	      if(tok-&gt;st_pos == 4) {</span>
<a href="#l32.603"></a><span id="l32.603" class="difflineplus">+		unsigned char unescaped_utf[4];</span>
<a href="#l32.604"></a><span id="l32.604" class="difflineplus">+</span>
<a href="#l32.605"></a><span id="l32.605" class="difflineplus">+                if (got_hi_surrogate) {</span>
<a href="#l32.606"></a><span id="l32.606" class="difflineplus">+		  if (IS_LOW_SURROGATE(tok-&gt;ucs_char)) {</span>
<a href="#l32.607"></a><span id="l32.607" class="difflineplus">+                    /* Recalculate the ucs_char, then fall thru to process normally */</span>
<a href="#l32.608"></a><span id="l32.608" class="difflineplus">+                    tok-&gt;ucs_char = DECODE_SURROGATE_PAIR(got_hi_surrogate, tok-&gt;ucs_char);</span>
<a href="#l32.609"></a><span id="l32.609" class="difflineplus">+                  } else {</span>
<a href="#l32.610"></a><span id="l32.610" class="difflineplus">+                    /* Hi surrogate was not followed by a low surrogate */</span>
<a href="#l32.611"></a><span id="l32.611" class="difflineplus">+                    /* Replace the hi and process the rest normally */</span>
<a href="#l32.612"></a><span id="l32.612" class="difflineplus">+		    printbuf_memappend_fast(tok-&gt;pb, (char*)utf8_replacement_char, 3);</span>
<a href="#l32.613"></a><span id="l32.613" class="difflineplus">+                  }</span>
<a href="#l32.614"></a><span id="l32.614" class="difflineplus">+                  got_hi_surrogate = 0;</span>
<a href="#l32.615"></a><span id="l32.615" class="difflineplus">+                }</span>
<a href="#l32.616"></a><span id="l32.616" class="difflineplus">+</span>
<a href="#l32.617"></a><span id="l32.617" class="difflineplus">+		if (tok-&gt;ucs_char &lt; 0x80) {</span>
<a href="#l32.618"></a><span id="l32.618" class="difflineplus">+		  unescaped_utf[0] = tok-&gt;ucs_char;</span>
<a href="#l32.619"></a><span id="l32.619" class="difflineplus">+		  printbuf_memappend_fast(tok-&gt;pb, (char*)unescaped_utf, 1);</span>
<a href="#l32.620"></a><span id="l32.620" class="difflineplus">+		} else if (tok-&gt;ucs_char &lt; 0x800) {</span>
<a href="#l32.621"></a><span id="l32.621" class="difflineplus">+		  unescaped_utf[0] = 0xc0 | (tok-&gt;ucs_char &gt;&gt; 6);</span>
<a href="#l32.622"></a><span id="l32.622" class="difflineplus">+		  unescaped_utf[1] = 0x80 | (tok-&gt;ucs_char &amp; 0x3f);</span>
<a href="#l32.623"></a><span id="l32.623" class="difflineplus">+		  printbuf_memappend_fast(tok-&gt;pb, (char*)unescaped_utf, 2);</span>
<a href="#l32.624"></a><span id="l32.624" class="difflineplus">+		} else if (IS_HIGH_SURROGATE(tok-&gt;ucs_char)) {</span>
<a href="#l32.625"></a><span id="l32.625" class="difflineplus">+                  /* Got a high surrogate.  Remember it and look for the</span>
<a href="#l32.626"></a><span id="l32.626" class="difflineplus">+                   * the beginning of another sequence, which should be the</span>
<a href="#l32.627"></a><span id="l32.627" class="difflineplus">+                   * low surrogate.</span>
<a href="#l32.628"></a><span id="l32.628" class="difflineplus">+                   */</span>
<a href="#l32.629"></a><span id="l32.629" class="difflineplus">+                  got_hi_surrogate = tok-&gt;ucs_char;</span>
<a href="#l32.630"></a><span id="l32.630" class="difflineplus">+                  /* Not at end, and the next two chars should be &quot;\u&quot; */</span>
<a href="#l32.631"></a><span id="l32.631" class="difflineplus">+                  if ((len == -1 || len &gt; (tok-&gt;char_offset + 2)) &amp;&amp;</span>
<a href="#l32.632"></a><span id="l32.632" class="difflineplus">+                      // str[0] != '0' &amp;&amp;  // implied by json_hex_chars, above.</span>
<a href="#l32.633"></a><span id="l32.633" class="difflineplus">+                      (str[1] == '\\') &amp;&amp;</span>
<a href="#l32.634"></a><span id="l32.634" class="difflineplus">+                      (str[2] == 'u'))</span>
<a href="#l32.635"></a><span id="l32.635" class="difflineplus">+                  {</span>
<a href="#l32.636"></a><span id="l32.636" class="difflineplus">+                /* Advance through the 16 bit surrogate, and move on to the</span>
<a href="#l32.637"></a><span id="l32.637" class="difflineplus">+                 * next sequence. The next step is to process the following</span>
<a href="#l32.638"></a><span id="l32.638" class="difflineplus">+                 * characters.</span>
<a href="#l32.639"></a><span id="l32.639" class="difflineplus">+                 */</span>
<a href="#l32.640"></a><span id="l32.640" class="difflineplus">+	            if( !ADVANCE_CHAR(str, tok) || !ADVANCE_CHAR(str, tok) ) {</span>
<a href="#l32.641"></a><span id="l32.641" class="difflineplus">+                    printbuf_memappend_fast(tok-&gt;pb,</span>
<a href="#l32.642"></a><span id="l32.642" class="difflineplus">+					    (char*) utf8_replacement_char, 3);</span>
<a href="#l32.643"></a><span id="l32.643" class="difflineplus">+		    }</span>
<a href="#l32.644"></a><span id="l32.644" class="difflineplus">+                    /* Advance to the first char of the next sequence and</span>
<a href="#l32.645"></a><span id="l32.645" class="difflineplus">+                     * continue processing with the next sequence.</span>
<a href="#l32.646"></a><span id="l32.646" class="difflineplus">+                     */</span>
<a href="#l32.647"></a><span id="l32.647" class="difflineplus">+	            if (!ADVANCE_CHAR(str, tok) || !PEEK_CHAR(c, tok)) {</span>
<a href="#l32.648"></a><span id="l32.648" class="difflineplus">+	              printbuf_memappend_fast(tok-&gt;pb,</span>
<a href="#l32.649"></a><span id="l32.649" class="difflineplus">+					      (char*) utf8_replacement_char, 3);</span>
<a href="#l32.650"></a><span id="l32.650" class="difflineplus">+	              goto out;</span>
<a href="#l32.651"></a><span id="l32.651" class="difflineplus">+                    }</span>
<a href="#l32.652"></a><span id="l32.652" class="difflineplus">+	            tok-&gt;ucs_char = 0;</span>
<a href="#l32.653"></a><span id="l32.653" class="difflineplus">+                    tok-&gt;st_pos = 0;</span>
<a href="#l32.654"></a><span id="l32.654" class="difflineplus">+                    continue; /* other json_tokener_state_escape_unicode */</span>
<a href="#l32.655"></a><span id="l32.655" class="difflineplus">+                  } else {</span>
<a href="#l32.656"></a><span id="l32.656" class="difflineplus">+                    /* Got a high surrogate without another sequence following</span>
<a href="#l32.657"></a><span id="l32.657" class="difflineplus">+                     * it.  Put a replacement char in for the hi surrogate</span>
<a href="#l32.658"></a><span id="l32.658" class="difflineplus">+                     * and pretend we finished.</span>
<a href="#l32.659"></a><span id="l32.659" class="difflineplus">+                     */</span>
<a href="#l32.660"></a><span id="l32.660" class="difflineplus">+		    printbuf_memappend_fast(tok-&gt;pb,</span>
<a href="#l32.661"></a><span id="l32.661" class="difflineplus">+					    (char*) utf8_replacement_char, 3);</span>
<a href="#l32.662"></a><span id="l32.662" class="difflineplus">+                  }</span>
<a href="#l32.663"></a><span id="l32.663" class="difflineplus">+		} else if (IS_LOW_SURROGATE(tok-&gt;ucs_char)) {</span>
<a href="#l32.664"></a><span id="l32.664" class="difflineplus">+                  /* Got a low surrogate not preceded by a high */</span>
<a href="#l32.665"></a><span id="l32.665" class="difflineplus">+		  printbuf_memappend_fast(tok-&gt;pb, (char*)utf8_replacement_char, 3);</span>
<a href="#l32.666"></a><span id="l32.666" class="difflineplus">+                } else if (tok-&gt;ucs_char &lt; 0x10000) {</span>
<a href="#l32.667"></a><span id="l32.667" class="difflineplus">+		  unescaped_utf[0] = 0xe0 | (tok-&gt;ucs_char &gt;&gt; 12);</span>
<a href="#l32.668"></a><span id="l32.668" class="difflineplus">+		  unescaped_utf[1] = 0x80 | ((tok-&gt;ucs_char &gt;&gt; 6) &amp; 0x3f);</span>
<a href="#l32.669"></a><span id="l32.669" class="difflineplus">+		  unescaped_utf[2] = 0x80 | (tok-&gt;ucs_char &amp; 0x3f);</span>
<a href="#l32.670"></a><span id="l32.670" class="difflineplus">+		  printbuf_memappend_fast(tok-&gt;pb, (char*)unescaped_utf, 3);</span>
<a href="#l32.671"></a><span id="l32.671" class="difflineplus">+		} else if (tok-&gt;ucs_char &lt; 0x110000) {</span>
<a href="#l32.672"></a><span id="l32.672" class="difflineplus">+		  unescaped_utf[0] = 0xf0 | ((tok-&gt;ucs_char &gt;&gt; 18) &amp; 0x07);</span>
<a href="#l32.673"></a><span id="l32.673" class="difflineplus">+		  unescaped_utf[1] = 0x80 | ((tok-&gt;ucs_char &gt;&gt; 12) &amp; 0x3f);</span>
<a href="#l32.674"></a><span id="l32.674" class="difflineplus">+		  unescaped_utf[2] = 0x80 | ((tok-&gt;ucs_char &gt;&gt; 6) &amp; 0x3f);</span>
<a href="#l32.675"></a><span id="l32.675" class="difflineplus">+		  unescaped_utf[3] = 0x80 | (tok-&gt;ucs_char &amp; 0x3f);</span>
<a href="#l32.676"></a><span id="l32.676" class="difflineplus">+		  printbuf_memappend_fast(tok-&gt;pb, (char*)unescaped_utf, 4);</span>
<a href="#l32.677"></a><span id="l32.677" class="difflineplus">+		} else {</span>
<a href="#l32.678"></a><span id="l32.678" class="difflineplus">+                  /* Don't know what we got--insert the replacement char */</span>
<a href="#l32.679"></a><span id="l32.679" class="difflineplus">+		  printbuf_memappend_fast(tok-&gt;pb, (char*)utf8_replacement_char, 3);</span>
<a href="#l32.680"></a><span id="l32.680" class="difflineplus">+                }</span>
<a href="#l32.681"></a><span id="l32.681" class="difflineplus">+		state = saved_state;</span>
<a href="#l32.682"></a><span id="l32.682" class="difflineplus">+		break;</span>
<a href="#l32.683"></a><span id="l32.683" class="difflineplus">+	      }</span>
<a href="#l32.684"></a><span id="l32.684" class="difflineplus">+	    } else {</span>
<a href="#l32.685"></a><span id="l32.685" class="difflineplus">+	      tok-&gt;err = json_tokener_error_parse_string;</span>
<a href="#l32.686"></a><span id="l32.686" class="difflineplus">+	      goto out;</span>
<a href="#l32.687"></a><span id="l32.687" class="difflineplus">+	    }</span>
<a href="#l32.688"></a><span id="l32.688" class="difflineplus">+	  if (!ADVANCE_CHAR(str, tok) || !PEEK_CHAR(c, tok)) {</span>
<a href="#l32.689"></a><span id="l32.689" class="difflineplus">+            if (got_hi_surrogate) /* Clean up any pending chars */</span>
<a href="#l32.690"></a><span id="l32.690" class="difflineplus">+	      printbuf_memappend_fast(tok-&gt;pb, (char*)utf8_replacement_char, 3);</span>
<a href="#l32.691"></a><span id="l32.691" class="difflineplus">+	    goto out;</span>
<a href="#l32.692"></a><span id="l32.692" class="difflineplus">+	  }</span>
<a href="#l32.693"></a><span id="l32.693" class="difflineplus">+	}</span>
<a href="#l32.694"></a><span id="l32.694" class="difflineplus">+      }</span>
<a href="#l32.695"></a><span id="l32.695" class="difflineplus">+      break;</span>
<a href="#l32.696"></a><span id="l32.696" class="difflineplus">+</span>
<a href="#l32.697"></a><span id="l32.697" class="difflineplus">+    case json_tokener_state_boolean:</span>
<a href="#l32.698"></a><span id="l32.698" class="difflineplus">+      {</span>
<a href="#l32.699"></a><span id="l32.699" class="difflineplus">+	int size1, size2;</span>
<a href="#l32.700"></a><span id="l32.700" class="difflineplus">+	printbuf_memappend_fast(tok-&gt;pb, &amp;c, 1);</span>
<a href="#l32.701"></a><span id="l32.701" class="difflineplus">+	size1 = json_min(tok-&gt;st_pos+1, json_true_str_len);</span>
<a href="#l32.702"></a><span id="l32.702" class="difflineplus">+	size2 = json_min(tok-&gt;st_pos+1, json_false_str_len);</span>
<a href="#l32.703"></a><span id="l32.703" class="difflineplus">+	if((!(tok-&gt;flags &amp; JSON_TOKENER_STRICT) &amp;&amp;</span>
<a href="#l32.704"></a><span id="l32.704" class="difflineplus">+	  strncasecmp(json_true_str, tok-&gt;pb-&gt;buf, size1) == 0)</span>
<a href="#l32.705"></a><span id="l32.705" class="difflineplus">+	  || (strncmp(json_true_str, tok-&gt;pb-&gt;buf, size1) == 0)</span>
<a href="#l32.706"></a><span id="l32.706" class="difflineplus">+	  ) {</span>
<a href="#l32.707"></a><span id="l32.707" class="difflineplus">+	  if(tok-&gt;st_pos == json_true_str_len) {</span>
<a href="#l32.708"></a><span id="l32.708" class="difflineplus">+	    current = json_object_new_boolean(1);</span>
<a href="#l32.709"></a><span id="l32.709" class="difflineplus">+	    if(current == NULL)</span>
<a href="#l32.710"></a><span id="l32.710" class="difflineplus">+		goto out;</span>
<a href="#l32.711"></a><span id="l32.711" class="difflineplus">+	    saved_state = json_tokener_state_finish;</span>
<a href="#l32.712"></a><span id="l32.712" class="difflineplus">+	    state = json_tokener_state_eatws;</span>
<a href="#l32.713"></a><span id="l32.713" class="difflineplus">+	    goto redo_char;</span>
<a href="#l32.714"></a><span id="l32.714" class="difflineplus">+	  }</span>
<a href="#l32.715"></a><span id="l32.715" class="difflineplus">+	} else if((!(tok-&gt;flags &amp; JSON_TOKENER_STRICT) &amp;&amp;</span>
<a href="#l32.716"></a><span id="l32.716" class="difflineplus">+	  strncasecmp(json_false_str, tok-&gt;pb-&gt;buf, size2) == 0)</span>
<a href="#l32.717"></a><span id="l32.717" class="difflineplus">+	  || (strncmp(json_false_str, tok-&gt;pb-&gt;buf, size2) == 0)) {</span>
<a href="#l32.718"></a><span id="l32.718" class="difflineplus">+	  if(tok-&gt;st_pos == json_false_str_len) {</span>
<a href="#l32.719"></a><span id="l32.719" class="difflineplus">+	    current = json_object_new_boolean(0);</span>
<a href="#l32.720"></a><span id="l32.720" class="difflineplus">+	    if(current == NULL)</span>
<a href="#l32.721"></a><span id="l32.721" class="difflineplus">+		goto out;</span>
<a href="#l32.722"></a><span id="l32.722" class="difflineplus">+	    saved_state = json_tokener_state_finish;</span>
<a href="#l32.723"></a><span id="l32.723" class="difflineplus">+	    state = json_tokener_state_eatws;</span>
<a href="#l32.724"></a><span id="l32.724" class="difflineplus">+	    goto redo_char;</span>
<a href="#l32.725"></a><span id="l32.725" class="difflineplus">+	  }</span>
<a href="#l32.726"></a><span id="l32.726" class="difflineplus">+	} else {</span>
<a href="#l32.727"></a><span id="l32.727" class="difflineplus">+	  tok-&gt;err = json_tokener_error_parse_boolean;</span>
<a href="#l32.728"></a><span id="l32.728" class="difflineplus">+	  goto out;</span>
<a href="#l32.729"></a><span id="l32.729" class="difflineplus">+	}</span>
<a href="#l32.730"></a><span id="l32.730" class="difflineplus">+	tok-&gt;st_pos++;</span>
<a href="#l32.731"></a><span id="l32.731" class="difflineplus">+      }</span>
<a href="#l32.732"></a><span id="l32.732" class="difflineplus">+      break;</span>
<a href="#l32.733"></a><span id="l32.733" class="difflineplus">+</span>
<a href="#l32.734"></a><span id="l32.734" class="difflineplus">+    case json_tokener_state_number:</span>
<a href="#l32.735"></a><span id="l32.735" class="difflineplus">+      {</span>
<a href="#l32.736"></a><span id="l32.736" class="difflineplus">+	/* Advance until we change state */</span>
<a href="#l32.737"></a><span id="l32.737" class="difflineplus">+	const char *case_start = str;</span>
<a href="#l32.738"></a><span id="l32.738" class="difflineplus">+	int case_len=0;</span>
<a href="#l32.739"></a><span id="l32.739" class="difflineplus">+	int is_exponent=0;</span>
<a href="#l32.740"></a><span id="l32.740" class="difflineplus">+	int negativesign_next_possible_location=1;</span>
<a href="#l32.741"></a><span id="l32.741" class="difflineplus">+	while(c &amp;&amp; strchr(json_number_chars, c)) {</span>
<a href="#l32.742"></a><span id="l32.742" class="difflineplus">+	  ++case_len;</span>
<a href="#l32.743"></a><span id="l32.743" class="difflineplus">+</span>
<a href="#l32.744"></a><span id="l32.744" class="difflineplus">+	  /* non-digit characters checks */</span>
<a href="#l32.745"></a><span id="l32.745" class="difflineplus">+	  /* note: since the main loop condition to get here was</span>
<a href="#l32.746"></a><span id="l32.746" class="difflineplus">+	           an input starting with 0-9 or '-', we are</span>
<a href="#l32.747"></a><span id="l32.747" class="difflineplus">+	           protected from input starting with '.' or</span>
<a href="#l32.748"></a><span id="l32.748" class="difflineplus">+	           e/E. */</span>
<a href="#l32.749"></a><span id="l32.749" class="difflineplus">+	  if (c == '.') {</span>
<a href="#l32.750"></a><span id="l32.750" class="difflineplus">+	    if (tok-&gt;is_double != 0) {</span>
<a href="#l32.751"></a><span id="l32.751" class="difflineplus">+	      /* '.' can only be found once, and out of the exponent part.</span>
<a href="#l32.752"></a><span id="l32.752" class="difflineplus">+	         Thus, if the input is already flagged as double, it</span>
<a href="#l32.753"></a><span id="l32.753" class="difflineplus">+	         is invalid. */</span>
<a href="#l32.754"></a><span id="l32.754" class="difflineplus">+	      tok-&gt;err = json_tokener_error_parse_number;</span>
<a href="#l32.755"></a><span id="l32.755" class="difflineplus">+	      goto out;</span>
<a href="#l32.756"></a><span id="l32.756" class="difflineplus">+	    }</span>
<a href="#l32.757"></a><span id="l32.757" class="difflineplus">+	    tok-&gt;is_double = 1;</span>
<a href="#l32.758"></a><span id="l32.758" class="difflineplus">+	  }</span>
<a href="#l32.759"></a><span id="l32.759" class="difflineplus">+	  if (c == 'e' || c == 'E') {</span>
<a href="#l32.760"></a><span id="l32.760" class="difflineplus">+	    if (is_exponent != 0) {</span>
<a href="#l32.761"></a><span id="l32.761" class="difflineplus">+	      /* only one exponent possible */</span>
<a href="#l32.762"></a><span id="l32.762" class="difflineplus">+	      tok-&gt;err = json_tokener_error_parse_number;</span>
<a href="#l32.763"></a><span id="l32.763" class="difflineplus">+	      goto out;</span>
<a href="#l32.764"></a><span id="l32.764" class="difflineplus">+	    }</span>
<a href="#l32.765"></a><span id="l32.765" class="difflineplus">+	    is_exponent = 1;</span>
<a href="#l32.766"></a><span id="l32.766" class="difflineplus">+	    tok-&gt;is_double = 1;</span>
<a href="#l32.767"></a><span id="l32.767" class="difflineplus">+	    /* the exponent part can begin with a negative sign */</span>
<a href="#l32.768"></a><span id="l32.768" class="difflineplus">+	    negativesign_next_possible_location = case_len + 1;</span>
<a href="#l32.769"></a><span id="l32.769" class="difflineplus">+	  }</span>
<a href="#l32.770"></a><span id="l32.770" class="difflineplus">+	  if (c == '-' &amp;&amp; case_len != negativesign_next_possible_location) {</span>
<a href="#l32.771"></a><span id="l32.771" class="difflineplus">+	    /* If the negative sign is not where expected (ie</span>
<a href="#l32.772"></a><span id="l32.772" class="difflineplus">+	       start of input or start of exponent part), the</span>
<a href="#l32.773"></a><span id="l32.773" class="difflineplus">+	       input is invalid. */</span>
<a href="#l32.774"></a><span id="l32.774" class="difflineplus">+	    tok-&gt;err = json_tokener_error_parse_number;</span>
<a href="#l32.775"></a><span id="l32.775" class="difflineplus">+	    goto out;</span>
<a href="#l32.776"></a><span id="l32.776" class="difflineplus">+	  }</span>
<a href="#l32.777"></a><span id="l32.777" class="difflineplus">+</span>
<a href="#l32.778"></a><span id="l32.778" class="difflineplus">+	  if (!ADVANCE_CHAR(str, tok) || !PEEK_CHAR(c, tok)) {</span>
<a href="#l32.779"></a><span id="l32.779" class="difflineplus">+	    printbuf_memappend_fast(tok-&gt;pb, case_start, case_len);</span>
<a href="#l32.780"></a><span id="l32.780" class="difflineplus">+	    goto out;</span>
<a href="#l32.781"></a><span id="l32.781" class="difflineplus">+	  }</span>
<a href="#l32.782"></a><span id="l32.782" class="difflineplus">+	}</span>
<a href="#l32.783"></a><span id="l32.783" class="difflineplus">+        if (case_len&gt;0)</span>
<a href="#l32.784"></a><span id="l32.784" class="difflineplus">+          printbuf_memappend_fast(tok-&gt;pb, case_start, case_len);</span>
<a href="#l32.785"></a><span id="l32.785" class="difflineplus">+</span>
<a href="#l32.786"></a><span id="l32.786" class="difflineplus">+	// Check for -Infinity</span>
<a href="#l32.787"></a><span id="l32.787" class="difflineplus">+	if (tok-&gt;pb-&gt;buf[0] == '-' &amp;&amp; case_len &lt;= 1 &amp;&amp;</span>
<a href="#l32.788"></a><span id="l32.788" class="difflineplus">+	    (c == 'i' || c == 'I'))</span>
<a href="#l32.789"></a><span id="l32.789" class="difflineplus">+	{</span>
<a href="#l32.790"></a><span id="l32.790" class="difflineplus">+		state = json_tokener_state_inf;</span>
<a href="#l32.791"></a><span id="l32.791" class="difflineplus">+		tok-&gt;st_pos = 0;</span>
<a href="#l32.792"></a><span id="l32.792" class="difflineplus">+		goto redo_char;</span>
<a href="#l32.793"></a><span id="l32.793" class="difflineplus">+	}</span>
<a href="#l32.794"></a><span id="l32.794" class="difflineplus">+      }</span>
<a href="#l32.795"></a><span id="l32.795" class="difflineplus">+      {</span>
<a href="#l32.796"></a><span id="l32.796" class="difflineplus">+	int64_t num64;</span>
<a href="#l32.797"></a><span id="l32.797" class="difflineplus">+	double  numd;</span>
<a href="#l32.798"></a><span id="l32.798" class="difflineplus">+	if (!tok-&gt;is_double &amp;&amp; json_parse_int64(tok-&gt;pb-&gt;buf, &amp;num64) == 0) {</span>
<a href="#l32.799"></a><span id="l32.799" class="difflineplus">+		if (num64 &amp;&amp; tok-&gt;pb-&gt;buf[0]=='0' &amp;&amp;</span>
<a href="#l32.800"></a><span id="l32.800" class="difflineplus">+		    (tok-&gt;flags &amp; JSON_TOKENER_STRICT)) {</span>
<a href="#l32.801"></a><span id="l32.801" class="difflineplus">+			/* in strict mode, number must not start with 0 */</span>
<a href="#l32.802"></a><span id="l32.802" class="difflineplus">+			tok-&gt;err = json_tokener_error_parse_number;</span>
<a href="#l32.803"></a><span id="l32.803" class="difflineplus">+			goto out;</span>
<a href="#l32.804"></a><span id="l32.804" class="difflineplus">+		}</span>
<a href="#l32.805"></a><span id="l32.805" class="difflineplus">+		current = json_object_new_int64(num64);</span>
<a href="#l32.806"></a><span id="l32.806" class="difflineplus">+		if(current == NULL)</span>
<a href="#l32.807"></a><span id="l32.807" class="difflineplus">+		    goto out;</span>
<a href="#l32.808"></a><span id="l32.808" class="difflineplus">+	}</span>
<a href="#l32.809"></a><span id="l32.809" class="difflineplus">+	else if(tok-&gt;is_double &amp;&amp; json_parse_double(tok-&gt;pb-&gt;buf, &amp;numd) == 0)</span>
<a href="#l32.810"></a><span id="l32.810" class="difflineplus">+	{</span>
<a href="#l32.811"></a><span id="l32.811" class="difflineplus">+          current = json_object_new_double_s(numd, tok-&gt;pb-&gt;buf);</span>
<a href="#l32.812"></a><span id="l32.812" class="difflineplus">+	  if(current == NULL)</span>
<a href="#l32.813"></a><span id="l32.813" class="difflineplus">+		goto out;</span>
<a href="#l32.814"></a><span id="l32.814" class="difflineplus">+        } else {</span>
<a href="#l32.815"></a><span id="l32.815" class="difflineplus">+          tok-&gt;err = json_tokener_error_parse_number;</span>
<a href="#l32.816"></a><span id="l32.816" class="difflineplus">+          goto out;</span>
<a href="#l32.817"></a><span id="l32.817" class="difflineplus">+        }</span>
<a href="#l32.818"></a><span id="l32.818" class="difflineplus">+        saved_state = json_tokener_state_finish;</span>
<a href="#l32.819"></a><span id="l32.819" class="difflineplus">+        state = json_tokener_state_eatws;</span>
<a href="#l32.820"></a><span id="l32.820" class="difflineplus">+        goto redo_char;</span>
<a href="#l32.821"></a><span id="l32.821" class="difflineplus">+      }</span>
<a href="#l32.822"></a><span id="l32.822" class="difflineplus">+      break;</span>
<a href="#l32.823"></a><span id="l32.823" class="difflineplus">+</span>
<a href="#l32.824"></a><span id="l32.824" class="difflineplus">+    case json_tokener_state_array_after_sep:</span>
<a href="#l32.825"></a><span id="l32.825" class="difflineplus">+    case json_tokener_state_array:</span>
<a href="#l32.826"></a><span id="l32.826" class="difflineplus">+      if(c == ']') {</span>
<a href="#l32.827"></a><span id="l32.827" class="difflineplus">+	if (state == json_tokener_state_array_after_sep &amp;&amp;</span>
<a href="#l32.828"></a><span id="l32.828" class="difflineplus">+	    (tok-&gt;flags &amp; JSON_TOKENER_STRICT))</span>
<a href="#l32.829"></a><span id="l32.829" class="difflineplus">+	  {</span>
<a href="#l32.830"></a><span id="l32.830" class="difflineplus">+	    tok-&gt;err = json_tokener_error_parse_unexpected;</span>
<a href="#l32.831"></a><span id="l32.831" class="difflineplus">+	    goto out;</span>
<a href="#l32.832"></a><span id="l32.832" class="difflineplus">+	  }</span>
<a href="#l32.833"></a><span id="l32.833" class="difflineplus">+	saved_state = json_tokener_state_finish;</span>
<a href="#l32.834"></a><span id="l32.834" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.835"></a><span id="l32.835" class="difflineplus">+      } else {</span>
<a href="#l32.836"></a><span id="l32.836" class="difflineplus">+	if(tok-&gt;depth &gt;= tok-&gt;max_depth-1) {</span>
<a href="#l32.837"></a><span id="l32.837" class="difflineplus">+	  tok-&gt;err = json_tokener_error_depth;</span>
<a href="#l32.838"></a><span id="l32.838" class="difflineplus">+	  goto out;</span>
<a href="#l32.839"></a><span id="l32.839" class="difflineplus">+	}</span>
<a href="#l32.840"></a><span id="l32.840" class="difflineplus">+	state = json_tokener_state_array_add;</span>
<a href="#l32.841"></a><span id="l32.841" class="difflineplus">+	tok-&gt;depth++;</span>
<a href="#l32.842"></a><span id="l32.842" class="difflineplus">+	json_tokener_reset_level(tok, tok-&gt;depth);</span>
<a href="#l32.843"></a><span id="l32.843" class="difflineplus">+	goto redo_char;</span>
<a href="#l32.844"></a><span id="l32.844" class="difflineplus">+      }</span>
<a href="#l32.845"></a><span id="l32.845" class="difflineplus">+      break;</span>
<a href="#l32.846"></a><span id="l32.846" class="difflineplus">+</span>
<a href="#l32.847"></a><span id="l32.847" class="difflineplus">+    case json_tokener_state_array_add:</span>
<a href="#l32.848"></a><span id="l32.848" class="difflineplus">+      if( json_object_array_add(current, obj) != 0 )</span>
<a href="#l32.849"></a><span id="l32.849" class="difflineplus">+        goto out;</span>
<a href="#l32.850"></a><span id="l32.850" class="difflineplus">+      saved_state = json_tokener_state_array_sep;</span>
<a href="#l32.851"></a><span id="l32.851" class="difflineplus">+      state = json_tokener_state_eatws;</span>
<a href="#l32.852"></a><span id="l32.852" class="difflineplus">+      goto redo_char;</span>
<a href="#l32.853"></a><span id="l32.853" class="difflineplus">+</span>
<a href="#l32.854"></a><span id="l32.854" class="difflineplus">+    case json_tokener_state_array_sep:</span>
<a href="#l32.855"></a><span id="l32.855" class="difflineplus">+      if(c == ']') {</span>
<a href="#l32.856"></a><span id="l32.856" class="difflineplus">+	saved_state = json_tokener_state_finish;</span>
<a href="#l32.857"></a><span id="l32.857" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.858"></a><span id="l32.858" class="difflineplus">+      } else if(c == ',') {</span>
<a href="#l32.859"></a><span id="l32.859" class="difflineplus">+	saved_state = json_tokener_state_array_after_sep;</span>
<a href="#l32.860"></a><span id="l32.860" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.861"></a><span id="l32.861" class="difflineplus">+      } else {</span>
<a href="#l32.862"></a><span id="l32.862" class="difflineplus">+	tok-&gt;err = json_tokener_error_parse_array;</span>
<a href="#l32.863"></a><span id="l32.863" class="difflineplus">+	goto out;</span>
<a href="#l32.864"></a><span id="l32.864" class="difflineplus">+      }</span>
<a href="#l32.865"></a><span id="l32.865" class="difflineplus">+      break;</span>
<a href="#l32.866"></a><span id="l32.866" class="difflineplus">+</span>
<a href="#l32.867"></a><span id="l32.867" class="difflineplus">+    case json_tokener_state_object_field_start:</span>
<a href="#l32.868"></a><span id="l32.868" class="difflineplus">+    case json_tokener_state_object_field_start_after_sep:</span>
<a href="#l32.869"></a><span id="l32.869" class="difflineplus">+      if(c == '}') {</span>
<a href="#l32.870"></a><span id="l32.870" class="difflineplus">+		if (state == json_tokener_state_object_field_start_after_sep &amp;&amp;</span>
<a href="#l32.871"></a><span id="l32.871" class="difflineplus">+		    (tok-&gt;flags &amp; JSON_TOKENER_STRICT))</span>
<a href="#l32.872"></a><span id="l32.872" class="difflineplus">+		{</span>
<a href="#l32.873"></a><span id="l32.873" class="difflineplus">+			tok-&gt;err = json_tokener_error_parse_unexpected;</span>
<a href="#l32.874"></a><span id="l32.874" class="difflineplus">+			goto out;</span>
<a href="#l32.875"></a><span id="l32.875" class="difflineplus">+		}</span>
<a href="#l32.876"></a><span id="l32.876" class="difflineplus">+	saved_state = json_tokener_state_finish;</span>
<a href="#l32.877"></a><span id="l32.877" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.878"></a><span id="l32.878" class="difflineplus">+      } else if (c == '&quot;' || c == '\'') {</span>
<a href="#l32.879"></a><span id="l32.879" class="difflineplus">+	tok-&gt;quote_char = c;</span>
<a href="#l32.880"></a><span id="l32.880" class="difflineplus">+	printbuf_reset(tok-&gt;pb);</span>
<a href="#l32.881"></a><span id="l32.881" class="difflineplus">+	state = json_tokener_state_object_field;</span>
<a href="#l32.882"></a><span id="l32.882" class="difflineplus">+      } else {</span>
<a href="#l32.883"></a><span id="l32.883" class="difflineplus">+	tok-&gt;err = json_tokener_error_parse_object_key_name;</span>
<a href="#l32.884"></a><span id="l32.884" class="difflineplus">+	goto out;</span>
<a href="#l32.885"></a><span id="l32.885" class="difflineplus">+      }</span>
<a href="#l32.886"></a><span id="l32.886" class="difflineplus">+      break;</span>
<a href="#l32.887"></a><span id="l32.887" class="difflineplus">+</span>
<a href="#l32.888"></a><span id="l32.888" class="difflineplus">+    case json_tokener_state_object_field:</span>
<a href="#l32.889"></a><span id="l32.889" class="difflineplus">+      {</span>
<a href="#l32.890"></a><span id="l32.890" class="difflineplus">+	/* Advance until we change state */</span>
<a href="#l32.891"></a><span id="l32.891" class="difflineplus">+	const char *case_start = str;</span>
<a href="#l32.892"></a><span id="l32.892" class="difflineplus">+	while(1) {</span>
<a href="#l32.893"></a><span id="l32.893" class="difflineplus">+	  if(c == tok-&gt;quote_char) {</span>
<a href="#l32.894"></a><span id="l32.894" class="difflineplus">+	    printbuf_memappend_fast(tok-&gt;pb, case_start, str-case_start);</span>
<a href="#l32.895"></a><span id="l32.895" class="difflineplus">+	    obj_field_name = strdup(tok-&gt;pb-&gt;buf);</span>
<a href="#l32.896"></a><span id="l32.896" class="difflineplus">+	    saved_state = json_tokener_state_object_field_end;</span>
<a href="#l32.897"></a><span id="l32.897" class="difflineplus">+	    state = json_tokener_state_eatws;</span>
<a href="#l32.898"></a><span id="l32.898" class="difflineplus">+	    break;</span>
<a href="#l32.899"></a><span id="l32.899" class="difflineplus">+	  } else if(c == '\\') {</span>
<a href="#l32.900"></a><span id="l32.900" class="difflineplus">+	    printbuf_memappend_fast(tok-&gt;pb, case_start, str-case_start);</span>
<a href="#l32.901"></a><span id="l32.901" class="difflineplus">+	    saved_state = json_tokener_state_object_field;</span>
<a href="#l32.902"></a><span id="l32.902" class="difflineplus">+	    state = json_tokener_state_string_escape;</span>
<a href="#l32.903"></a><span id="l32.903" class="difflineplus">+	    break;</span>
<a href="#l32.904"></a><span id="l32.904" class="difflineplus">+	  }</span>
<a href="#l32.905"></a><span id="l32.905" class="difflineplus">+	  if (!ADVANCE_CHAR(str, tok) || !PEEK_CHAR(c, tok)) {</span>
<a href="#l32.906"></a><span id="l32.906" class="difflineplus">+	    printbuf_memappend_fast(tok-&gt;pb, case_start, str-case_start);</span>
<a href="#l32.907"></a><span id="l32.907" class="difflineplus">+	    goto out;</span>
<a href="#l32.908"></a><span id="l32.908" class="difflineplus">+	  }</span>
<a href="#l32.909"></a><span id="l32.909" class="difflineplus">+	}</span>
<a href="#l32.910"></a><span id="l32.910" class="difflineplus">+      }</span>
<a href="#l32.911"></a><span id="l32.911" class="difflineplus">+      break;</span>
<a href="#l32.912"></a><span id="l32.912" class="difflineplus">+</span>
<a href="#l32.913"></a><span id="l32.913" class="difflineplus">+    case json_tokener_state_object_field_end:</span>
<a href="#l32.914"></a><span id="l32.914" class="difflineplus">+      if(c == ':') {</span>
<a href="#l32.915"></a><span id="l32.915" class="difflineplus">+	saved_state = json_tokener_state_object_value;</span>
<a href="#l32.916"></a><span id="l32.916" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.917"></a><span id="l32.917" class="difflineplus">+      } else {</span>
<a href="#l32.918"></a><span id="l32.918" class="difflineplus">+	tok-&gt;err = json_tokener_error_parse_object_key_sep;</span>
<a href="#l32.919"></a><span id="l32.919" class="difflineplus">+	goto out;</span>
<a href="#l32.920"></a><span id="l32.920" class="difflineplus">+      }</span>
<a href="#l32.921"></a><span id="l32.921" class="difflineplus">+      break;</span>
<a href="#l32.922"></a><span id="l32.922" class="difflineplus">+</span>
<a href="#l32.923"></a><span id="l32.923" class="difflineplus">+    case json_tokener_state_object_value:</span>
<a href="#l32.924"></a><span id="l32.924" class="difflineplus">+      if(tok-&gt;depth &gt;= tok-&gt;max_depth-1) {</span>
<a href="#l32.925"></a><span id="l32.925" class="difflineplus">+	tok-&gt;err = json_tokener_error_depth;</span>
<a href="#l32.926"></a><span id="l32.926" class="difflineplus">+	goto out;</span>
<a href="#l32.927"></a><span id="l32.927" class="difflineplus">+      }</span>
<a href="#l32.928"></a><span id="l32.928" class="difflineplus">+      state = json_tokener_state_object_value_add;</span>
<a href="#l32.929"></a><span id="l32.929" class="difflineplus">+      tok-&gt;depth++;</span>
<a href="#l32.930"></a><span id="l32.930" class="difflineplus">+      json_tokener_reset_level(tok, tok-&gt;depth);</span>
<a href="#l32.931"></a><span id="l32.931" class="difflineplus">+      goto redo_char;</span>
<a href="#l32.932"></a><span id="l32.932" class="difflineplus">+</span>
<a href="#l32.933"></a><span id="l32.933" class="difflineplus">+    case json_tokener_state_object_value_add:</span>
<a href="#l32.934"></a><span id="l32.934" class="difflineplus">+      json_object_object_add(current, obj_field_name, obj);</span>
<a href="#l32.935"></a><span id="l32.935" class="difflineplus">+      free(obj_field_name);</span>
<a href="#l32.936"></a><span id="l32.936" class="difflineplus">+      obj_field_name = NULL;</span>
<a href="#l32.937"></a><span id="l32.937" class="difflineplus">+      saved_state = json_tokener_state_object_sep;</span>
<a href="#l32.938"></a><span id="l32.938" class="difflineplus">+      state = json_tokener_state_eatws;</span>
<a href="#l32.939"></a><span id="l32.939" class="difflineplus">+      goto redo_char;</span>
<a href="#l32.940"></a><span id="l32.940" class="difflineplus">+</span>
<a href="#l32.941"></a><span id="l32.941" class="difflineplus">+    case json_tokener_state_object_sep:</span>
<a href="#l32.942"></a><span id="l32.942" class="difflineplus">+      /* { */</span>
<a href="#l32.943"></a><span id="l32.943" class="difflineplus">+      if(c == '}') {</span>
<a href="#l32.944"></a><span id="l32.944" class="difflineplus">+	saved_state = json_tokener_state_finish;</span>
<a href="#l32.945"></a><span id="l32.945" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.946"></a><span id="l32.946" class="difflineplus">+      } else if(c == ',') {</span>
<a href="#l32.947"></a><span id="l32.947" class="difflineplus">+	saved_state = json_tokener_state_object_field_start_after_sep;</span>
<a href="#l32.948"></a><span id="l32.948" class="difflineplus">+	state = json_tokener_state_eatws;</span>
<a href="#l32.949"></a><span id="l32.949" class="difflineplus">+      } else {</span>
<a href="#l32.950"></a><span id="l32.950" class="difflineplus">+	tok-&gt;err = json_tokener_error_parse_object_value_sep;</span>
<a href="#l32.951"></a><span id="l32.951" class="difflineplus">+	goto out;</span>
<a href="#l32.952"></a><span id="l32.952" class="difflineplus">+      }</span>
<a href="#l32.953"></a><span id="l32.953" class="difflineplus">+      break;</span>
<a href="#l32.954"></a><span id="l32.954" class="difflineplus">+</span>
<a href="#l32.955"></a><span id="l32.955" class="difflineplus">+    }</span>
<a href="#l32.956"></a><span id="l32.956" class="difflineplus">+    if (!ADVANCE_CHAR(str, tok))</span>
<a href="#l32.957"></a><span id="l32.957" class="difflineplus">+      goto out;</span>
<a href="#l32.958"></a><span id="l32.958" class="difflineplus">+  } /* while(PEEK_CHAR) */</span>
<a href="#l32.959"></a><span id="l32.959" class="difflineplus">+</span>
<a href="#l32.960"></a><span id="l32.960" class="difflineplus">+ out:</span>
<a href="#l32.961"></a><span id="l32.961" class="difflineplus">+  if (c &amp;&amp;</span>
<a href="#l32.962"></a><span id="l32.962" class="difflineplus">+     (state == json_tokener_state_finish) &amp;&amp;</span>
<a href="#l32.963"></a><span id="l32.963" class="difflineplus">+     (tok-&gt;depth == 0) &amp;&amp;</span>
<a href="#l32.964"></a><span id="l32.964" class="difflineplus">+     (tok-&gt;flags &amp; JSON_TOKENER_STRICT)) {</span>
<a href="#l32.965"></a><span id="l32.965" class="difflineplus">+      /* unexpected char after JSON data */</span>
<a href="#l32.966"></a><span id="l32.966" class="difflineplus">+      tok-&gt;err = json_tokener_error_parse_unexpected;</span>
<a href="#l32.967"></a><span id="l32.967" class="difflineplus">+  }</span>
<a href="#l32.968"></a><span id="l32.968" class="difflineplus">+  if (!c) { /* We hit an eof char (0) */</span>
<a href="#l32.969"></a><span id="l32.969" class="difflineplus">+    if(state != json_tokener_state_finish &amp;&amp;</span>
<a href="#l32.970"></a><span id="l32.970" class="difflineplus">+       saved_state != json_tokener_state_finish)</span>
<a href="#l32.971"></a><span id="l32.971" class="difflineplus">+      tok-&gt;err = json_tokener_error_parse_eof;</span>
<a href="#l32.972"></a><span id="l32.972" class="difflineplus">+  }</span>
<a href="#l32.973"></a><span id="l32.973" class="difflineplus">+</span>
<a href="#l32.974"></a><span id="l32.974" class="difflineplus">+#ifdef HAVE_USELOCALE</span>
<a href="#l32.975"></a><span id="l32.975" class="difflineplus">+  uselocale(oldlocale);</span>
<a href="#l32.976"></a><span id="l32.976" class="difflineplus">+  freelocale(newloc); </span>
<a href="#l32.977"></a><span id="l32.977" class="difflineplus">+#elif defined(HAVE_SETLOCALE)</span>
<a href="#l32.978"></a><span id="l32.978" class="difflineplus">+  setlocale(LC_NUMERIC, oldlocale);</span>
<a href="#l32.979"></a><span id="l32.979" class="difflineplus">+  free(oldlocale);</span>
<a href="#l32.980"></a><span id="l32.980" class="difflineplus">+#endif</span>
<a href="#l32.981"></a><span id="l32.981" class="difflineplus">+</span>
<a href="#l32.982"></a><span id="l32.982" class="difflineplus">+  if (tok-&gt;err == json_tokener_success)</span>
<a href="#l32.983"></a><span id="l32.983" class="difflineplus">+  {</span>
<a href="#l32.984"></a><span id="l32.984" class="difflineplus">+    json_object *ret = json_object_get(current);</span>
<a href="#l32.985"></a><span id="l32.985" class="difflineplus">+	int ii;</span>
<a href="#l32.986"></a><span id="l32.986" class="difflineplus">+</span>
<a href="#l32.987"></a><span id="l32.987" class="difflineplus">+	/* Partially reset, so we parse additional objects on subsequent calls. */</span>
<a href="#l32.988"></a><span id="l32.988" class="difflineplus">+    for(ii = tok-&gt;depth; ii &gt;= 0; ii--)</span>
<a href="#l32.989"></a><span id="l32.989" class="difflineplus">+      json_tokener_reset_level(tok, ii);</span>
<a href="#l32.990"></a><span id="l32.990" class="difflineplus">+    return ret;</span>
<a href="#l32.991"></a><span id="l32.991" class="difflineplus">+  }</span>
<a href="#l32.992"></a><span id="l32.992" class="difflineplus">+</span>
<a href="#l32.993"></a><span id="l32.993" class="difflineplus">+  MC_DEBUG(&quot;json_tokener_parse_ex: error %s at offset %d\n&quot;,</span>
<a href="#l32.994"></a><span id="l32.994" class="difflineplus">+	   json_tokener_errors[tok-&gt;err], tok-&gt;char_offset);</span>
<a href="#l32.995"></a><span id="l32.995" class="difflineplus">+  return NULL;</span>
<a href="#l32.996"></a><span id="l32.996" class="difflineplus">+}</span>
<a href="#l32.997"></a><span id="l32.997" class="difflineplus">+</span>
<a href="#l32.998"></a><span id="l32.998" class="difflineplus">+void json_tokener_set_flags(struct json_tokener *tok, int flags)</span>
<a href="#l32.999"></a><span id="l32.999" class="difflineplus">+{</span>
<a href="#l32.1000"></a><span id="l32.1000" class="difflineplus">+	tok-&gt;flags = flags;</span>
<a href="#l32.1001"></a><span id="l32.1001" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1">new file mode 100644</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineminus">--- /dev/null</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineplus">+++ b/third_party/json-c/json_tokener.h</span>
<a href="#l33.4"></a><span id="l33.4" class="difflineat">@@ -0,0 +1,216 @@</span>
<a href="#l33.5"></a><span id="l33.5" class="difflineplus">+/*</span>
<a href="#l33.6"></a><span id="l33.6" class="difflineplus">+ * $Id: json_tokener.h,v 1.10 2006/07/25 03:24:50 mclark Exp $</span>
<a href="#l33.7"></a><span id="l33.7" class="difflineplus">+ *</span>
<a href="#l33.8"></a><span id="l33.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l33.9"></a><span id="l33.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l33.10"></a><span id="l33.10" class="difflineplus">+ *</span>
<a href="#l33.11"></a><span id="l33.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+ *</span>
<a href="#l33.14"></a><span id="l33.14" class="difflineplus">+ */</span>
<a href="#l33.15"></a><span id="l33.15" class="difflineplus">+</span>
<a href="#l33.16"></a><span id="l33.16" class="difflineplus">+/**</span>
<a href="#l33.17"></a><span id="l33.17" class="difflineplus">+ * @file</span>
<a href="#l33.18"></a><span id="l33.18" class="difflineplus">+ * @brief Methods to parse an input string into a tree of json_object objects.</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineplus">+ */</span>
<a href="#l33.20"></a><span id="l33.20" class="difflineplus">+#ifndef _json_tokener_h_</span>
<a href="#l33.21"></a><span id="l33.21" class="difflineplus">+#define _json_tokener_h_</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineplus">+</span>
<a href="#l33.23"></a><span id="l33.23" class="difflineplus">+#include &lt;stddef.h&gt;</span>
<a href="#l33.24"></a><span id="l33.24" class="difflineplus">+#include &quot;json_object.h&quot;</span>
<a href="#l33.25"></a><span id="l33.25" class="difflineplus">+</span>
<a href="#l33.26"></a><span id="l33.26" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l33.27"></a><span id="l33.27" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l33.28"></a><span id="l33.28" class="difflineplus">+#endif</span>
<a href="#l33.29"></a><span id="l33.29" class="difflineplus">+</span>
<a href="#l33.30"></a><span id="l33.30" class="difflineplus">+enum json_tokener_error {</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineplus">+  json_tokener_success,</span>
<a href="#l33.32"></a><span id="l33.32" class="difflineplus">+  json_tokener_continue,</span>
<a href="#l33.33"></a><span id="l33.33" class="difflineplus">+  json_tokener_error_depth,</span>
<a href="#l33.34"></a><span id="l33.34" class="difflineplus">+  json_tokener_error_parse_eof,</span>
<a href="#l33.35"></a><span id="l33.35" class="difflineplus">+  json_tokener_error_parse_unexpected,</span>
<a href="#l33.36"></a><span id="l33.36" class="difflineplus">+  json_tokener_error_parse_null,</span>
<a href="#l33.37"></a><span id="l33.37" class="difflineplus">+  json_tokener_error_parse_boolean,</span>
<a href="#l33.38"></a><span id="l33.38" class="difflineplus">+  json_tokener_error_parse_number,</span>
<a href="#l33.39"></a><span id="l33.39" class="difflineplus">+  json_tokener_error_parse_array,</span>
<a href="#l33.40"></a><span id="l33.40" class="difflineplus">+  json_tokener_error_parse_object_key_name,</span>
<a href="#l33.41"></a><span id="l33.41" class="difflineplus">+  json_tokener_error_parse_object_key_sep,</span>
<a href="#l33.42"></a><span id="l33.42" class="difflineplus">+  json_tokener_error_parse_object_value_sep,</span>
<a href="#l33.43"></a><span id="l33.43" class="difflineplus">+  json_tokener_error_parse_string,</span>
<a href="#l33.44"></a><span id="l33.44" class="difflineplus">+  json_tokener_error_parse_comment,</span>
<a href="#l33.45"></a><span id="l33.45" class="difflineplus">+  json_tokener_error_size</span>
<a href="#l33.46"></a><span id="l33.46" class="difflineplus">+};</span>
<a href="#l33.47"></a><span id="l33.47" class="difflineplus">+</span>
<a href="#l33.48"></a><span id="l33.48" class="difflineplus">+enum json_tokener_state {</span>
<a href="#l33.49"></a><span id="l33.49" class="difflineplus">+  json_tokener_state_eatws,</span>
<a href="#l33.50"></a><span id="l33.50" class="difflineplus">+  json_tokener_state_start,</span>
<a href="#l33.51"></a><span id="l33.51" class="difflineplus">+  json_tokener_state_finish,</span>
<a href="#l33.52"></a><span id="l33.52" class="difflineplus">+  json_tokener_state_null,</span>
<a href="#l33.53"></a><span id="l33.53" class="difflineplus">+  json_tokener_state_comment_start,</span>
<a href="#l33.54"></a><span id="l33.54" class="difflineplus">+  json_tokener_state_comment,</span>
<a href="#l33.55"></a><span id="l33.55" class="difflineplus">+  json_tokener_state_comment_eol,</span>
<a href="#l33.56"></a><span id="l33.56" class="difflineplus">+  json_tokener_state_comment_end,</span>
<a href="#l33.57"></a><span id="l33.57" class="difflineplus">+  json_tokener_state_string,</span>
<a href="#l33.58"></a><span id="l33.58" class="difflineplus">+  json_tokener_state_string_escape,</span>
<a href="#l33.59"></a><span id="l33.59" class="difflineplus">+  json_tokener_state_escape_unicode,</span>
<a href="#l33.60"></a><span id="l33.60" class="difflineplus">+  json_tokener_state_boolean,</span>
<a href="#l33.61"></a><span id="l33.61" class="difflineplus">+  json_tokener_state_number,</span>
<a href="#l33.62"></a><span id="l33.62" class="difflineplus">+  json_tokener_state_array,</span>
<a href="#l33.63"></a><span id="l33.63" class="difflineplus">+  json_tokener_state_array_add,</span>
<a href="#l33.64"></a><span id="l33.64" class="difflineplus">+  json_tokener_state_array_sep,</span>
<a href="#l33.65"></a><span id="l33.65" class="difflineplus">+  json_tokener_state_object_field_start,</span>
<a href="#l33.66"></a><span id="l33.66" class="difflineplus">+  json_tokener_state_object_field,</span>
<a href="#l33.67"></a><span id="l33.67" class="difflineplus">+  json_tokener_state_object_field_end,</span>
<a href="#l33.68"></a><span id="l33.68" class="difflineplus">+  json_tokener_state_object_value,</span>
<a href="#l33.69"></a><span id="l33.69" class="difflineplus">+  json_tokener_state_object_value_add,</span>
<a href="#l33.70"></a><span id="l33.70" class="difflineplus">+  json_tokener_state_object_sep,</span>
<a href="#l33.71"></a><span id="l33.71" class="difflineplus">+  json_tokener_state_array_after_sep,</span>
<a href="#l33.72"></a><span id="l33.72" class="difflineplus">+  json_tokener_state_object_field_start_after_sep,</span>
<a href="#l33.73"></a><span id="l33.73" class="difflineplus">+  json_tokener_state_inf</span>
<a href="#l33.74"></a><span id="l33.74" class="difflineplus">+};</span>
<a href="#l33.75"></a><span id="l33.75" class="difflineplus">+</span>
<a href="#l33.76"></a><span id="l33.76" class="difflineplus">+struct json_tokener_srec</span>
<a href="#l33.77"></a><span id="l33.77" class="difflineplus">+{</span>
<a href="#l33.78"></a><span id="l33.78" class="difflineplus">+  enum json_tokener_state state, saved_state;</span>
<a href="#l33.79"></a><span id="l33.79" class="difflineplus">+  struct json_object *obj;</span>
<a href="#l33.80"></a><span id="l33.80" class="difflineplus">+  struct json_object *current;</span>
<a href="#l33.81"></a><span id="l33.81" class="difflineplus">+  char *obj_field_name;</span>
<a href="#l33.82"></a><span id="l33.82" class="difflineplus">+};</span>
<a href="#l33.83"></a><span id="l33.83" class="difflineplus">+</span>
<a href="#l33.84"></a><span id="l33.84" class="difflineplus">+#define JSON_TOKENER_DEFAULT_DEPTH 32</span>
<a href="#l33.85"></a><span id="l33.85" class="difflineplus">+</span>
<a href="#l33.86"></a><span id="l33.86" class="difflineplus">+struct json_tokener</span>
<a href="#l33.87"></a><span id="l33.87" class="difflineplus">+{</span>
<a href="#l33.88"></a><span id="l33.88" class="difflineplus">+  char *str;</span>
<a href="#l33.89"></a><span id="l33.89" class="difflineplus">+  struct printbuf *pb;</span>
<a href="#l33.90"></a><span id="l33.90" class="difflineplus">+  int max_depth, depth, is_double, st_pos, char_offset;</span>
<a href="#l33.91"></a><span id="l33.91" class="difflineplus">+  enum json_tokener_error err;</span>
<a href="#l33.92"></a><span id="l33.92" class="difflineplus">+  unsigned int ucs_char;</span>
<a href="#l33.93"></a><span id="l33.93" class="difflineplus">+  char quote_char;</span>
<a href="#l33.94"></a><span id="l33.94" class="difflineplus">+  struct json_tokener_srec *stack;</span>
<a href="#l33.95"></a><span id="l33.95" class="difflineplus">+  int flags;</span>
<a href="#l33.96"></a><span id="l33.96" class="difflineplus">+};</span>
<a href="#l33.97"></a><span id="l33.97" class="difflineplus">+/**</span>
<a href="#l33.98"></a><span id="l33.98" class="difflineplus">+ * @deprecated Unused in json-c code</span>
<a href="#l33.99"></a><span id="l33.99" class="difflineplus">+ */</span>
<a href="#l33.100"></a><span id="l33.100" class="difflineplus">+typedef struct json_tokener json_tokener;</span>
<a href="#l33.101"></a><span id="l33.101" class="difflineplus">+</span>
<a href="#l33.102"></a><span id="l33.102" class="difflineplus">+/**</span>
<a href="#l33.103"></a><span id="l33.103" class="difflineplus">+ * Be strict when parsing JSON input.  Use caution with</span>
<a href="#l33.104"></a><span id="l33.104" class="difflineplus">+ * this flag as what is considered valid may become more</span>
<a href="#l33.105"></a><span id="l33.105" class="difflineplus">+ * restrictive from one release to the next, causing your</span>
<a href="#l33.106"></a><span id="l33.106" class="difflineplus">+ * code to fail on previously working input.</span>
<a href="#l33.107"></a><span id="l33.107" class="difflineplus">+ *</span>
<a href="#l33.108"></a><span id="l33.108" class="difflineplus">+ * This flag is not set by default.</span>
<a href="#l33.109"></a><span id="l33.109" class="difflineplus">+ *</span>
<a href="#l33.110"></a><span id="l33.110" class="difflineplus">+ * @see json_tokener_set_flags()</span>
<a href="#l33.111"></a><span id="l33.111" class="difflineplus">+ */</span>
<a href="#l33.112"></a><span id="l33.112" class="difflineplus">+#define JSON_TOKENER_STRICT  0x01</span>
<a href="#l33.113"></a><span id="l33.113" class="difflineplus">+</span>
<a href="#l33.114"></a><span id="l33.114" class="difflineplus">+/**</span>
<a href="#l33.115"></a><span id="l33.115" class="difflineplus">+ * Given an error previously returned by json_tokener_get_error(),</span>
<a href="#l33.116"></a><span id="l33.116" class="difflineplus">+ * return a human readable description of the error.</span>
<a href="#l33.117"></a><span id="l33.117" class="difflineplus">+ *</span>
<a href="#l33.118"></a><span id="l33.118" class="difflineplus">+ * @return a generic error message is returned if an invalid error value is provided.</span>
<a href="#l33.119"></a><span id="l33.119" class="difflineplus">+ */</span>
<a href="#l33.120"></a><span id="l33.120" class="difflineplus">+const char *json_tokener_error_desc(enum json_tokener_error jerr);</span>
<a href="#l33.121"></a><span id="l33.121" class="difflineplus">+</span>
<a href="#l33.122"></a><span id="l33.122" class="difflineplus">+/**</span>
<a href="#l33.123"></a><span id="l33.123" class="difflineplus">+ * Retrieve the error caused by the last call to json_tokener_parse_ex(),</span>
<a href="#l33.124"></a><span id="l33.124" class="difflineplus">+ * or json_tokener_success if there is no error.</span>
<a href="#l33.125"></a><span id="l33.125" class="difflineplus">+ *</span>
<a href="#l33.126"></a><span id="l33.126" class="difflineplus">+ * When parsing a JSON string in pieces, if the tokener is in the middle</span>
<a href="#l33.127"></a><span id="l33.127" class="difflineplus">+ * of parsing this will return json_tokener_continue.</span>
<a href="#l33.128"></a><span id="l33.128" class="difflineplus">+ *</span>
<a href="#l33.129"></a><span id="l33.129" class="difflineplus">+ * See also json_tokener_error_desc().</span>
<a href="#l33.130"></a><span id="l33.130" class="difflineplus">+ */</span>
<a href="#l33.131"></a><span id="l33.131" class="difflineplus">+JSON_EXPORT enum json_tokener_error json_tokener_get_error(struct json_tokener *tok);</span>
<a href="#l33.132"></a><span id="l33.132" class="difflineplus">+</span>
<a href="#l33.133"></a><span id="l33.133" class="difflineplus">+JSON_EXPORT struct json_tokener* json_tokener_new(void);</span>
<a href="#l33.134"></a><span id="l33.134" class="difflineplus">+JSON_EXPORT struct json_tokener* json_tokener_new_ex(int depth);</span>
<a href="#l33.135"></a><span id="l33.135" class="difflineplus">+JSON_EXPORT void json_tokener_free(struct json_tokener *tok);</span>
<a href="#l33.136"></a><span id="l33.136" class="difflineplus">+JSON_EXPORT void json_tokener_reset(struct json_tokener *tok);</span>
<a href="#l33.137"></a><span id="l33.137" class="difflineplus">+JSON_EXPORT struct json_object* json_tokener_parse(const char *str);</span>
<a href="#l33.138"></a><span id="l33.138" class="difflineplus">+JSON_EXPORT struct json_object* json_tokener_parse_verbose(const char *str, enum json_tokener_error *error);</span>
<a href="#l33.139"></a><span id="l33.139" class="difflineplus">+</span>
<a href="#l33.140"></a><span id="l33.140" class="difflineplus">+/**</span>
<a href="#l33.141"></a><span id="l33.141" class="difflineplus">+ * Set flags that control how parsing will be done.</span>
<a href="#l33.142"></a><span id="l33.142" class="difflineplus">+ */</span>
<a href="#l33.143"></a><span id="l33.143" class="difflineplus">+JSON_EXPORT void json_tokener_set_flags(struct json_tokener *tok, int flags);</span>
<a href="#l33.144"></a><span id="l33.144" class="difflineplus">+</span>
<a href="#l33.145"></a><span id="l33.145" class="difflineplus">+/**</span>
<a href="#l33.146"></a><span id="l33.146" class="difflineplus">+ * Parse a string and return a non-NULL json_object if a valid JSON value</span>
<a href="#l33.147"></a><span id="l33.147" class="difflineplus">+ * is found.  The string does not need to be a JSON object or array;</span>
<a href="#l33.148"></a><span id="l33.148" class="difflineplus">+ * it can also be a string, number or boolean value.</span>
<a href="#l33.149"></a><span id="l33.149" class="difflineplus">+ *</span>
<a href="#l33.150"></a><span id="l33.150" class="difflineplus">+ * A partial JSON string can be parsed.  If the parsing is incomplete,</span>
<a href="#l33.151"></a><span id="l33.151" class="difflineplus">+ * NULL will be returned and json_tokener_get_error() will return</span>
<a href="#l33.152"></a><span id="l33.152" class="difflineplus">+ * json_tokener_continue.</span>
<a href="#l33.153"></a><span id="l33.153" class="difflineplus">+ * json_tokener_parse_ex() can then be called with additional bytes in str</span>
<a href="#l33.154"></a><span id="l33.154" class="difflineplus">+ * to continue the parsing.</span>
<a href="#l33.155"></a><span id="l33.155" class="difflineplus">+ *</span>
<a href="#l33.156"></a><span id="l33.156" class="difflineplus">+ * If json_tokener_parse_ex() returns NULL and the error is anything other than</span>
<a href="#l33.157"></a><span id="l33.157" class="difflineplus">+ * json_tokener_continue, a fatal error has occurred and parsing must be</span>
<a href="#l33.158"></a><span id="l33.158" class="difflineplus">+ * halted.  Then, the tok object must not be reused until json_tokener_reset() is</span>
<a href="#l33.159"></a><span id="l33.159" class="difflineplus">+ * called.</span>
<a href="#l33.160"></a><span id="l33.160" class="difflineplus">+ *</span>
<a href="#l33.161"></a><span id="l33.161" class="difflineplus">+ * When a valid JSON value is parsed, a non-NULL json_object will be</span>
<a href="#l33.162"></a><span id="l33.162" class="difflineplus">+ * returned.  Also, json_tokener_get_error() will return json_tokener_success.</span>
<a href="#l33.163"></a><span id="l33.163" class="difflineplus">+ * Be sure to check the type with json_object_is_type() or</span>
<a href="#l33.164"></a><span id="l33.164" class="difflineplus">+ * json_object_get_type() before using the object.</span>
<a href="#l33.165"></a><span id="l33.165" class="difflineplus">+ *</span>
<a href="#l33.166"></a><span id="l33.166" class="difflineplus">+ * @b XXX this shouldn't use internal fields:</span>
<a href="#l33.167"></a><span id="l33.167" class="difflineplus">+ * Trailing characters after the parsed value do not automatically cause an</span>
<a href="#l33.168"></a><span id="l33.168" class="difflineplus">+ * error.  It is up to the caller to decide whether to treat this as an</span>
<a href="#l33.169"></a><span id="l33.169" class="difflineplus">+ * error or to handle the additional characters, perhaps by parsing another</span>
<a href="#l33.170"></a><span id="l33.170" class="difflineplus">+ * json value starting from that point.</span>
<a href="#l33.171"></a><span id="l33.171" class="difflineplus">+ *</span>
<a href="#l33.172"></a><span id="l33.172" class="difflineplus">+ * Extra characters can be detected by comparing the tok-&gt;char_offset against</span>
<a href="#l33.173"></a><span id="l33.173" class="difflineplus">+ * the length of the last len parameter passed in.</span>
<a href="#l33.174"></a><span id="l33.174" class="difflineplus">+ *</span>
<a href="#l33.175"></a><span id="l33.175" class="difflineplus">+ * The tokener does \b not maintain an internal buffer so the caller is</span>
<a href="#l33.176"></a><span id="l33.176" class="difflineplus">+ * responsible for calling json_tokener_parse_ex with an appropriate str</span>
<a href="#l33.177"></a><span id="l33.177" class="difflineplus">+ * parameter starting with the extra characters.</span>
<a href="#l33.178"></a><span id="l33.178" class="difflineplus">+ *</span>
<a href="#l33.179"></a><span id="l33.179" class="difflineplus">+ * This interface is presently not 64-bit clean due to the int len argument</span>
<a href="#l33.180"></a><span id="l33.180" class="difflineplus">+ * so the function limits the maximum string size to INT32_MAX (2GB).</span>
<a href="#l33.181"></a><span id="l33.181" class="difflineplus">+ * If the function is called with len == -1 then strlen is called to check</span>
<a href="#l33.182"></a><span id="l33.182" class="difflineplus">+ * the string length is less than INT32_MAX (2GB)</span>
<a href="#l33.183"></a><span id="l33.183" class="difflineplus">+ *</span>
<a href="#l33.184"></a><span id="l33.184" class="difflineplus">+ * Example:</span>
<a href="#l33.185"></a><span id="l33.185" class="difflineplus">+ * @code</span>
<a href="#l33.186"></a><span id="l33.186" class="difflineplus">+json_object *jobj = NULL;</span>
<a href="#l33.187"></a><span id="l33.187" class="difflineplus">+const char *mystring = NULL;</span>
<a href="#l33.188"></a><span id="l33.188" class="difflineplus">+int stringlen = 0;</span>
<a href="#l33.189"></a><span id="l33.189" class="difflineplus">+enum json_tokener_error jerr;</span>
<a href="#l33.190"></a><span id="l33.190" class="difflineplus">+do {</span>
<a href="#l33.191"></a><span id="l33.191" class="difflineplus">+	mystring = ...  // get JSON string, e.g. read from file, etc...</span>
<a href="#l33.192"></a><span id="l33.192" class="difflineplus">+	stringlen = strlen(mystring);</span>
<a href="#l33.193"></a><span id="l33.193" class="difflineplus">+	jobj = json_tokener_parse_ex(tok, mystring, stringlen);</span>
<a href="#l33.194"></a><span id="l33.194" class="difflineplus">+} while ((jerr = json_tokener_get_error(tok)) == json_tokener_continue);</span>
<a href="#l33.195"></a><span id="l33.195" class="difflineplus">+if (jerr != json_tokener_success)</span>
<a href="#l33.196"></a><span id="l33.196" class="difflineplus">+{</span>
<a href="#l33.197"></a><span id="l33.197" class="difflineplus">+	fprintf(stderr, &quot;Error: %s\n&quot;, json_tokener_error_desc(jerr));</span>
<a href="#l33.198"></a><span id="l33.198" class="difflineplus">+	// Handle errors, as appropriate for your application.</span>
<a href="#l33.199"></a><span id="l33.199" class="difflineplus">+}</span>
<a href="#l33.200"></a><span id="l33.200" class="difflineplus">+if (tok-&gt;char_offset &lt; stringlen) // XXX shouldn't access internal fields</span>
<a href="#l33.201"></a><span id="l33.201" class="difflineplus">+{</span>
<a href="#l33.202"></a><span id="l33.202" class="difflineplus">+	// Handle extra characters after parsed object as desired.</span>
<a href="#l33.203"></a><span id="l33.203" class="difflineplus">+	// e.g. issue an error, parse another object from that point, etc...</span>
<a href="#l33.204"></a><span id="l33.204" class="difflineplus">+}</span>
<a href="#l33.205"></a><span id="l33.205" class="difflineplus">+// Success, use jobj here.</span>
<a href="#l33.206"></a><span id="l33.206" class="difflineplus">+</span>
<a href="#l33.207"></a><span id="l33.207" class="difflineplus">+@endcode</span>
<a href="#l33.208"></a><span id="l33.208" class="difflineplus">+ *</span>
<a href="#l33.209"></a><span id="l33.209" class="difflineplus">+ * @param tok a json_tokener previously allocated with json_tokener_new()</span>
<a href="#l33.210"></a><span id="l33.210" class="difflineplus">+ * @param str an string with any valid JSON expression, or portion of.  This does not need to be null terminated.</span>
<a href="#l33.211"></a><span id="l33.211" class="difflineplus">+ * @param len the length of str</span>
<a href="#l33.212"></a><span id="l33.212" class="difflineplus">+ */</span>
<a href="#l33.213"></a><span id="l33.213" class="difflineplus">+JSON_EXPORT struct json_object* json_tokener_parse_ex(struct json_tokener *tok,</span>
<a href="#l33.214"></a><span id="l33.214" class="difflineplus">+						 const char *str, int len);</span>
<a href="#l33.215"></a><span id="l33.215" class="difflineplus">+</span>
<a href="#l33.216"></a><span id="l33.216" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l33.217"></a><span id="l33.217" class="difflineplus">+}</span>
<a href="#l33.218"></a><span id="l33.218" class="difflineplus">+#endif</span>
<a href="#l33.219"></a><span id="l33.219" class="difflineplus">+</span>
<a href="#l33.220"></a><span id="l33.220" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1">new file mode 100644</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineminus">--- /dev/null</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineplus">+++ b/third_party/json-c/json_util.c</span>
<a href="#l34.4"></a><span id="l34.4" class="difflineat">@@ -0,0 +1,243 @@</span>
<a href="#l34.5"></a><span id="l34.5" class="difflineplus">+/*</span>
<a href="#l34.6"></a><span id="l34.6" class="difflineplus">+ * $Id: json_util.c,v 1.4 2006/01/30 23:07:57 mclark Exp $</span>
<a href="#l34.7"></a><span id="l34.7" class="difflineplus">+ *</span>
<a href="#l34.8"></a><span id="l34.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l34.9"></a><span id="l34.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l34.10"></a><span id="l34.10" class="difflineplus">+ *</span>
<a href="#l34.11"></a><span id="l34.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+ *</span>
<a href="#l34.14"></a><span id="l34.14" class="difflineplus">+ */</span>
<a href="#l34.15"></a><span id="l34.15" class="difflineplus">+</span>
<a href="#l34.16"></a><span id="l34.16" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l34.17"></a><span id="l34.17" class="difflineplus">+#undef realloc</span>
<a href="#l34.18"></a><span id="l34.18" class="difflineplus">+</span>
<a href="#l34.19"></a><span id="l34.19" class="difflineplus">+#include &quot;strerror_override.h&quot;</span>
<a href="#l34.20"></a><span id="l34.20" class="difflineplus">+</span>
<a href="#l34.21"></a><span id="l34.21" class="difflineplus">+#include &lt;stdarg.h&gt;</span>
<a href="#l34.22"></a><span id="l34.22" class="difflineplus">+#include &lt;stdio.h&gt;</span>
<a href="#l34.23"></a><span id="l34.23" class="difflineplus">+#include &lt;stdlib.h&gt;</span>
<a href="#l34.24"></a><span id="l34.24" class="difflineplus">+#include &lt;stddef.h&gt;</span>
<a href="#l34.25"></a><span id="l34.25" class="difflineplus">+#include &lt;limits.h&gt;</span>
<a href="#l34.26"></a><span id="l34.26" class="difflineplus">+#include &lt;string.h&gt;</span>
<a href="#l34.27"></a><span id="l34.27" class="difflineplus">+#include &lt;ctype.h&gt;</span>
<a href="#l34.28"></a><span id="l34.28" class="difflineplus">+</span>
<a href="#l34.29"></a><span id="l34.29" class="difflineplus">+#ifdef HAVE_SYS_TYPES_H</span>
<a href="#l34.30"></a><span id="l34.30" class="difflineplus">+#include &lt;sys/types.h&gt;</span>
<a href="#l34.31"></a><span id="l34.31" class="difflineplus">+#endif /* HAVE_SYS_TYPES_H */</span>
<a href="#l34.32"></a><span id="l34.32" class="difflineplus">+</span>
<a href="#l34.33"></a><span id="l34.33" class="difflineplus">+#ifdef HAVE_SYS_STAT_H</span>
<a href="#l34.34"></a><span id="l34.34" class="difflineplus">+#include &lt;sys/stat.h&gt;</span>
<a href="#l34.35"></a><span id="l34.35" class="difflineplus">+#endif /* HAVE_SYS_STAT_H */</span>
<a href="#l34.36"></a><span id="l34.36" class="difflineplus">+</span>
<a href="#l34.37"></a><span id="l34.37" class="difflineplus">+#ifdef HAVE_FCNTL_H</span>
<a href="#l34.38"></a><span id="l34.38" class="difflineplus">+#include &lt;fcntl.h&gt;</span>
<a href="#l34.39"></a><span id="l34.39" class="difflineplus">+#endif /* HAVE_FCNTL_H */</span>
<a href="#l34.40"></a><span id="l34.40" class="difflineplus">+</span>
<a href="#l34.41"></a><span id="l34.41" class="difflineplus">+#ifdef HAVE_UNISTD_H</span>
<a href="#l34.42"></a><span id="l34.42" class="difflineplus">+# include &lt;unistd.h&gt;</span>
<a href="#l34.43"></a><span id="l34.43" class="difflineplus">+#endif /* HAVE_UNISTD_H */</span>
<a href="#l34.44"></a><span id="l34.44" class="difflineplus">+</span>
<a href="#l34.45"></a><span id="l34.45" class="difflineplus">+#ifdef WIN32</span>
<a href="#l34.46"></a><span id="l34.46" class="difflineplus">+# if MSC_VER &lt; 1800</span>
<a href="#l34.47"></a><span id="l34.47" class="difflineplus">+/* strtoll is available only since Visual Studio 2013 */</span>
<a href="#l34.48"></a><span id="l34.48" class="difflineplus">+#  define strtoll _strtoi64</span>
<a href="#l34.49"></a><span id="l34.49" class="difflineplus">+# endif</span>
<a href="#l34.50"></a><span id="l34.50" class="difflineplus">+# define WIN32_LEAN_AND_MEAN</span>
<a href="#l34.51"></a><span id="l34.51" class="difflineplus">+# include &lt;windows.h&gt;</span>
<a href="#l34.52"></a><span id="l34.52" class="difflineplus">+# include &lt;io.h&gt;</span>
<a href="#l34.53"></a><span id="l34.53" class="difflineplus">+#endif /* defined(WIN32) */</span>
<a href="#l34.54"></a><span id="l34.54" class="difflineplus">+</span>
<a href="#l34.55"></a><span id="l34.55" class="difflineplus">+#if !defined(HAVE_OPEN) &amp;&amp; defined(WIN32)</span>
<a href="#l34.56"></a><span id="l34.56" class="difflineplus">+# define open _open</span>
<a href="#l34.57"></a><span id="l34.57" class="difflineplus">+#endif</span>
<a href="#l34.58"></a><span id="l34.58" class="difflineplus">+</span>
<a href="#l34.59"></a><span id="l34.59" class="difflineplus">+#include &quot;snprintf_compat.h&quot;</span>
<a href="#l34.60"></a><span id="l34.60" class="difflineplus">+</span>
<a href="#l34.61"></a><span id="l34.61" class="difflineplus">+#include &quot;debug.h&quot;</span>
<a href="#l34.62"></a><span id="l34.62" class="difflineplus">+#include &quot;printbuf.h&quot;</span>
<a href="#l34.63"></a><span id="l34.63" class="difflineplus">+#include &quot;json_inttypes.h&quot;</span>
<a href="#l34.64"></a><span id="l34.64" class="difflineplus">+#include &quot;json_object.h&quot;</span>
<a href="#l34.65"></a><span id="l34.65" class="difflineplus">+#include &quot;json_tokener.h&quot;</span>
<a href="#l34.66"></a><span id="l34.66" class="difflineplus">+#include &quot;json_util.h&quot;</span>
<a href="#l34.67"></a><span id="l34.67" class="difflineplus">+</span>
<a href="#l34.68"></a><span id="l34.68" class="difflineplus">+static int _json_object_to_fd(int fd, struct json_object *obj, int flags, const char *filename);</span>
<a href="#l34.69"></a><span id="l34.69" class="difflineplus">+</span>
<a href="#l34.70"></a><span id="l34.70" class="difflineplus">+static char _last_err[256] = &quot;&quot;;</span>
<a href="#l34.71"></a><span id="l34.71" class="difflineplus">+</span>
<a href="#l34.72"></a><span id="l34.72" class="difflineplus">+const char *json_util_get_last_err()</span>
<a href="#l34.73"></a><span id="l34.73" class="difflineplus">+{</span>
<a href="#l34.74"></a><span id="l34.74" class="difflineplus">+	if (_last_err[0] == '\0')</span>
<a href="#l34.75"></a><span id="l34.75" class="difflineplus">+		return NULL;</span>
<a href="#l34.76"></a><span id="l34.76" class="difflineplus">+	return _last_err;</span>
<a href="#l34.77"></a><span id="l34.77" class="difflineplus">+}</span>
<a href="#l34.78"></a><span id="l34.78" class="difflineplus">+</span>
<a href="#l34.79"></a><span id="l34.79" class="difflineplus">+void _json_c_set_last_err(const char *err_fmt, ...)</span>
<a href="#l34.80"></a><span id="l34.80" class="difflineplus">+{</span>
<a href="#l34.81"></a><span id="l34.81" class="difflineplus">+	va_list ap;</span>
<a href="#l34.82"></a><span id="l34.82" class="difflineplus">+	va_start(ap, err_fmt);</span>
<a href="#l34.83"></a><span id="l34.83" class="difflineplus">+	// Ignore (attempted) overruns from snprintf</span>
<a href="#l34.84"></a><span id="l34.84" class="difflineplus">+	(void)vsnprintf(_last_err, sizeof(_last_err), err_fmt, ap);</span>
<a href="#l34.85"></a><span id="l34.85" class="difflineplus">+	va_end(ap);</span>
<a href="#l34.86"></a><span id="l34.86" class="difflineplus">+}</span>
<a href="#l34.87"></a><span id="l34.87" class="difflineplus">+</span>
<a href="#l34.88"></a><span id="l34.88" class="difflineplus">+struct json_object* json_object_from_fd(int fd)</span>
<a href="#l34.89"></a><span id="l34.89" class="difflineplus">+{</span>
<a href="#l34.90"></a><span id="l34.90" class="difflineplus">+  struct printbuf *pb;</span>
<a href="#l34.91"></a><span id="l34.91" class="difflineplus">+  struct json_object *obj;</span>
<a href="#l34.92"></a><span id="l34.92" class="difflineplus">+  char buf[JSON_FILE_BUF_SIZE];</span>
<a href="#l34.93"></a><span id="l34.93" class="difflineplus">+  int ret;</span>
<a href="#l34.94"></a><span id="l34.94" class="difflineplus">+</span>
<a href="#l34.95"></a><span id="l34.95" class="difflineplus">+  if(!(pb = printbuf_new())) {</span>
<a href="#l34.96"></a><span id="l34.96" class="difflineplus">+    _json_c_set_last_err(&quot;json_object_from_file: printbuf_new failed\n&quot;);</span>
<a href="#l34.97"></a><span id="l34.97" class="difflineplus">+    return NULL;</span>
<a href="#l34.98"></a><span id="l34.98" class="difflineplus">+  }</span>
<a href="#l34.99"></a><span id="l34.99" class="difflineplus">+  while((ret = read(fd, buf, JSON_FILE_BUF_SIZE)) &gt; 0) {</span>
<a href="#l34.100"></a><span id="l34.100" class="difflineplus">+    printbuf_memappend(pb, buf, ret);</span>
<a href="#l34.101"></a><span id="l34.101" class="difflineplus">+  }</span>
<a href="#l34.102"></a><span id="l34.102" class="difflineplus">+  if(ret &lt; 0) {</span>
<a href="#l34.103"></a><span id="l34.103" class="difflineplus">+    _json_c_set_last_err(&quot;json_object_from_fd: error reading fd %d: %s\n&quot;, fd, strerror(errno));</span>
<a href="#l34.104"></a><span id="l34.104" class="difflineplus">+    printbuf_free(pb);</span>
<a href="#l34.105"></a><span id="l34.105" class="difflineplus">+    return NULL;</span>
<a href="#l34.106"></a><span id="l34.106" class="difflineplus">+  }</span>
<a href="#l34.107"></a><span id="l34.107" class="difflineplus">+  obj = json_tokener_parse(pb-&gt;buf);</span>
<a href="#l34.108"></a><span id="l34.108" class="difflineplus">+  printbuf_free(pb);</span>
<a href="#l34.109"></a><span id="l34.109" class="difflineplus">+  return obj;</span>
<a href="#l34.110"></a><span id="l34.110" class="difflineplus">+}</span>
<a href="#l34.111"></a><span id="l34.111" class="difflineplus">+</span>
<a href="#l34.112"></a><span id="l34.112" class="difflineplus">+struct json_object* json_object_from_file(const char *filename)</span>
<a href="#l34.113"></a><span id="l34.113" class="difflineplus">+{</span>
<a href="#l34.114"></a><span id="l34.114" class="difflineplus">+  struct json_object *obj;</span>
<a href="#l34.115"></a><span id="l34.115" class="difflineplus">+  int fd;</span>
<a href="#l34.116"></a><span id="l34.116" class="difflineplus">+</span>
<a href="#l34.117"></a><span id="l34.117" class="difflineplus">+  if((fd = open(filename, O_RDONLY)) &lt; 0) {</span>
<a href="#l34.118"></a><span id="l34.118" class="difflineplus">+    _json_c_set_last_err(&quot;json_object_from_file: error opening file %s: %s\n&quot;,</span>
<a href="#l34.119"></a><span id="l34.119" class="difflineplus">+	     filename, strerror(errno));</span>
<a href="#l34.120"></a><span id="l34.120" class="difflineplus">+    return NULL;</span>
<a href="#l34.121"></a><span id="l34.121" class="difflineplus">+  }</span>
<a href="#l34.122"></a><span id="l34.122" class="difflineplus">+  obj = json_object_from_fd(fd);</span>
<a href="#l34.123"></a><span id="l34.123" class="difflineplus">+  close(fd);</span>
<a href="#l34.124"></a><span id="l34.124" class="difflineplus">+  return obj;</span>
<a href="#l34.125"></a><span id="l34.125" class="difflineplus">+}</span>
<a href="#l34.126"></a><span id="l34.126" class="difflineplus">+</span>
<a href="#l34.127"></a><span id="l34.127" class="difflineplus">+/* extended &quot;format and write to file&quot; function */</span>
<a href="#l34.128"></a><span id="l34.128" class="difflineplus">+</span>
<a href="#l34.129"></a><span id="l34.129" class="difflineplus">+int json_object_to_file_ext(const char *filename, struct json_object *obj, int flags)</span>
<a href="#l34.130"></a><span id="l34.130" class="difflineplus">+{</span>
<a href="#l34.131"></a><span id="l34.131" class="difflineplus">+	int fd, ret;</span>
<a href="#l34.132"></a><span id="l34.132" class="difflineplus">+	int saved_errno;</span>
<a href="#l34.133"></a><span id="l34.133" class="difflineplus">+</span>
<a href="#l34.134"></a><span id="l34.134" class="difflineplus">+	if (!obj) {</span>
<a href="#l34.135"></a><span id="l34.135" class="difflineplus">+		_json_c_set_last_err(&quot;json_object_to_file: object is null\n&quot;);</span>
<a href="#l34.136"></a><span id="l34.136" class="difflineplus">+		return -1;</span>
<a href="#l34.137"></a><span id="l34.137" class="difflineplus">+	}</span>
<a href="#l34.138"></a><span id="l34.138" class="difflineplus">+</span>
<a href="#l34.139"></a><span id="l34.139" class="difflineplus">+	if ((fd = open(filename, O_WRONLY | O_TRUNC | O_CREAT, 0644)) &lt; 0) {</span>
<a href="#l34.140"></a><span id="l34.140" class="difflineplus">+		_json_c_set_last_err(&quot;json_object_to_file: error opening file %s: %s\n&quot;,</span>
<a href="#l34.141"></a><span id="l34.141" class="difflineplus">+		              filename, strerror(errno));</span>
<a href="#l34.142"></a><span id="l34.142" class="difflineplus">+		return -1;</span>
<a href="#l34.143"></a><span id="l34.143" class="difflineplus">+	}</span>
<a href="#l34.144"></a><span id="l34.144" class="difflineplus">+	ret = _json_object_to_fd(fd, obj, flags, filename);</span>
<a href="#l34.145"></a><span id="l34.145" class="difflineplus">+	saved_errno = errno;</span>
<a href="#l34.146"></a><span id="l34.146" class="difflineplus">+	close(fd);</span>
<a href="#l34.147"></a><span id="l34.147" class="difflineplus">+	errno = saved_errno;</span>
<a href="#l34.148"></a><span id="l34.148" class="difflineplus">+	return ret;</span>
<a href="#l34.149"></a><span id="l34.149" class="difflineplus">+}</span>
<a href="#l34.150"></a><span id="l34.150" class="difflineplus">+</span>
<a href="#l34.151"></a><span id="l34.151" class="difflineplus">+int json_object_to_fd(int fd, struct json_object *obj, int flags)</span>
<a href="#l34.152"></a><span id="l34.152" class="difflineplus">+{</span>
<a href="#l34.153"></a><span id="l34.153" class="difflineplus">+	if (!obj) {</span>
<a href="#l34.154"></a><span id="l34.154" class="difflineplus">+		_json_c_set_last_err(&quot;json_object_to_fd: object is null\n&quot;);</span>
<a href="#l34.155"></a><span id="l34.155" class="difflineplus">+		return -1;</span>
<a href="#l34.156"></a><span id="l34.156" class="difflineplus">+	}</span>
<a href="#l34.157"></a><span id="l34.157" class="difflineplus">+</span>
<a href="#l34.158"></a><span id="l34.158" class="difflineplus">+	return _json_object_to_fd(fd, obj, flags, NULL);</span>
<a href="#l34.159"></a><span id="l34.159" class="difflineplus">+}</span>
<a href="#l34.160"></a><span id="l34.160" class="difflineplus">+static int _json_object_to_fd(int fd, struct json_object *obj, int flags, const char *filename)</span>
<a href="#l34.161"></a><span id="l34.161" class="difflineplus">+{</span>
<a href="#l34.162"></a><span id="l34.162" class="difflineplus">+	int ret;</span>
<a href="#l34.163"></a><span id="l34.163" class="difflineplus">+	const char *json_str;</span>
<a href="#l34.164"></a><span id="l34.164" class="difflineplus">+	unsigned int wpos, wsize;</span>
<a href="#l34.165"></a><span id="l34.165" class="difflineplus">+</span>
<a href="#l34.166"></a><span id="l34.166" class="difflineplus">+	filename = filename ? filename : &quot;(fd)&quot;;</span>
<a href="#l34.167"></a><span id="l34.167" class="difflineplus">+</span>
<a href="#l34.168"></a><span id="l34.168" class="difflineplus">+	if (!(json_str = json_object_to_json_string_ext(obj,flags))) {</span>
<a href="#l34.169"></a><span id="l34.169" class="difflineplus">+		return -1;</span>
<a href="#l34.170"></a><span id="l34.170" class="difflineplus">+	}</span>
<a href="#l34.171"></a><span id="l34.171" class="difflineplus">+</span>
<a href="#l34.172"></a><span id="l34.172" class="difflineplus">+	wsize = (unsigned int)(strlen(json_str) &amp; UINT_MAX); /* CAW: probably unnecessary, but the most 64bit safe */</span>
<a href="#l34.173"></a><span id="l34.173" class="difflineplus">+	wpos = 0;</span>
<a href="#l34.174"></a><span id="l34.174" class="difflineplus">+	while(wpos &lt; wsize) {</span>
<a href="#l34.175"></a><span id="l34.175" class="difflineplus">+		if((ret = write(fd, json_str + wpos, wsize-wpos)) &lt; 0) {</span>
<a href="#l34.176"></a><span id="l34.176" class="difflineplus">+		  _json_c_set_last_err(&quot;json_object_to_file: error writing file %s: %s\n&quot;,</span>
<a href="#l34.177"></a><span id="l34.177" class="difflineplus">+			 filename, strerror(errno));</span>
<a href="#l34.178"></a><span id="l34.178" class="difflineplus">+		  return -1;</span>
<a href="#l34.179"></a><span id="l34.179" class="difflineplus">+		}</span>
<a href="#l34.180"></a><span id="l34.180" class="difflineplus">+</span>
<a href="#l34.181"></a><span id="l34.181" class="difflineplus">+		/* because of the above check for ret &lt; 0, we can safely cast and add */</span>
<a href="#l34.182"></a><span id="l34.182" class="difflineplus">+		wpos += (unsigned int)ret;</span>
<a href="#l34.183"></a><span id="l34.183" class="difflineplus">+	}</span>
<a href="#l34.184"></a><span id="l34.184" class="difflineplus">+</span>
<a href="#l34.185"></a><span id="l34.185" class="difflineplus">+	return 0;</span>
<a href="#l34.186"></a><span id="l34.186" class="difflineplus">+}</span>
<a href="#l34.187"></a><span id="l34.187" class="difflineplus">+</span>
<a href="#l34.188"></a><span id="l34.188" class="difflineplus">+// backwards compatible &quot;format and write to file&quot; function</span>
<a href="#l34.189"></a><span id="l34.189" class="difflineplus">+</span>
<a href="#l34.190"></a><span id="l34.190" class="difflineplus">+int json_object_to_file(const char *filename, struct json_object *obj)</span>
<a href="#l34.191"></a><span id="l34.191" class="difflineplus">+{</span>
<a href="#l34.192"></a><span id="l34.192" class="difflineplus">+  return json_object_to_file_ext(filename, obj, JSON_C_TO_STRING_PLAIN);</span>
<a href="#l34.193"></a><span id="l34.193" class="difflineplus">+}</span>
<a href="#l34.194"></a><span id="l34.194" class="difflineplus">+</span>
<a href="#l34.195"></a><span id="l34.195" class="difflineplus">+int json_parse_double(const char *buf, double *retval)</span>
<a href="#l34.196"></a><span id="l34.196" class="difflineplus">+{</span>
<a href="#l34.197"></a><span id="l34.197" class="difflineplus">+  char *end;</span>
<a href="#l34.198"></a><span id="l34.198" class="difflineplus">+  *retval = strtod(buf, &amp;end);</span>
<a href="#l34.199"></a><span id="l34.199" class="difflineplus">+  return end == buf ? 1 : 0;</span>
<a href="#l34.200"></a><span id="l34.200" class="difflineplus">+}</span>
<a href="#l34.201"></a><span id="l34.201" class="difflineplus">+</span>
<a href="#l34.202"></a><span id="l34.202" class="difflineplus">+int json_parse_int64(const char *buf, int64_t *retval)</span>
<a href="#l34.203"></a><span id="l34.203" class="difflineplus">+{</span>
<a href="#l34.204"></a><span id="l34.204" class="difflineplus">+	char *end = NULL;</span>
<a href="#l34.205"></a><span id="l34.205" class="difflineplus">+	int64_t val;</span>
<a href="#l34.206"></a><span id="l34.206" class="difflineplus">+</span>
<a href="#l34.207"></a><span id="l34.207" class="difflineplus">+	errno = 0;</span>
<a href="#l34.208"></a><span id="l34.208" class="difflineplus">+	val = strtoll(buf, &amp;end, 10);</span>
<a href="#l34.209"></a><span id="l34.209" class="difflineplus">+	if (end != buf)</span>
<a href="#l34.210"></a><span id="l34.210" class="difflineplus">+		*retval = val;</span>
<a href="#l34.211"></a><span id="l34.211" class="difflineplus">+	return ((val == 0 &amp;&amp; errno != 0) || (end == buf)) ? 1 : 0;</span>
<a href="#l34.212"></a><span id="l34.212" class="difflineplus">+}</span>
<a href="#l34.213"></a><span id="l34.213" class="difflineplus">+</span>
<a href="#l34.214"></a><span id="l34.214" class="difflineplus">+#ifndef HAVE_REALLOC</span>
<a href="#l34.215"></a><span id="l34.215" class="difflineplus">+void* rpl_realloc(void* p, size_t n)</span>
<a href="#l34.216"></a><span id="l34.216" class="difflineplus">+{</span>
<a href="#l34.217"></a><span id="l34.217" class="difflineplus">+	if (n == 0)</span>
<a href="#l34.218"></a><span id="l34.218" class="difflineplus">+		n = 1;</span>
<a href="#l34.219"></a><span id="l34.219" class="difflineplus">+	if (p == 0)</span>
<a href="#l34.220"></a><span id="l34.220" class="difflineplus">+		return malloc(n);</span>
<a href="#l34.221"></a><span id="l34.221" class="difflineplus">+	return realloc(p, n);</span>
<a href="#l34.222"></a><span id="l34.222" class="difflineplus">+}</span>
<a href="#l34.223"></a><span id="l34.223" class="difflineplus">+#endif</span>
<a href="#l34.224"></a><span id="l34.224" class="difflineplus">+</span>
<a href="#l34.225"></a><span id="l34.225" class="difflineplus">+#define NELEM(a)        (sizeof(a) / sizeof(a[0]))</span>
<a href="#l34.226"></a><span id="l34.226" class="difflineplus">+static const char* json_type_name[] = {</span>
<a href="#l34.227"></a><span id="l34.227" class="difflineplus">+  /* If you change this, be sure to update the enum json_type definition too */</span>
<a href="#l34.228"></a><span id="l34.228" class="difflineplus">+  &quot;null&quot;,</span>
<a href="#l34.229"></a><span id="l34.229" class="difflineplus">+  &quot;boolean&quot;,</span>
<a href="#l34.230"></a><span id="l34.230" class="difflineplus">+  &quot;double&quot;,</span>
<a href="#l34.231"></a><span id="l34.231" class="difflineplus">+  &quot;int&quot;,</span>
<a href="#l34.232"></a><span id="l34.232" class="difflineplus">+  &quot;object&quot;,</span>
<a href="#l34.233"></a><span id="l34.233" class="difflineplus">+  &quot;array&quot;,</span>
<a href="#l34.234"></a><span id="l34.234" class="difflineplus">+  &quot;string&quot;,</span>
<a href="#l34.235"></a><span id="l34.235" class="difflineplus">+};</span>
<a href="#l34.236"></a><span id="l34.236" class="difflineplus">+</span>
<a href="#l34.237"></a><span id="l34.237" class="difflineplus">+const char *json_type_to_name(enum json_type o_type)</span>
<a href="#l34.238"></a><span id="l34.238" class="difflineplus">+{</span>
<a href="#l34.239"></a><span id="l34.239" class="difflineplus">+	int o_type_int = (int)o_type;</span>
<a href="#l34.240"></a><span id="l34.240" class="difflineplus">+	if (o_type_int &lt; 0 || o_type_int &gt;= (int)NELEM(json_type_name))</span>
<a href="#l34.241"></a><span id="l34.241" class="difflineplus">+	{</span>
<a href="#l34.242"></a><span id="l34.242" class="difflineplus">+		_json_c_set_last_err(&quot;json_type_to_name: type %d is out of range [0,%d]\n&quot;, o_type, NELEM(json_type_name));</span>
<a href="#l34.243"></a><span id="l34.243" class="difflineplus">+		return NULL;</span>
<a href="#l34.244"></a><span id="l34.244" class="difflineplus">+	}</span>
<a href="#l34.245"></a><span id="l34.245" class="difflineplus">+	return json_type_name[o_type];</span>
<a href="#l34.246"></a><span id="l34.246" class="difflineplus">+}</span>
<a href="#l34.247"></a><span id="l34.247" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1">new file mode 100644</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineminus">--- /dev/null</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineplus">+++ b/third_party/json-c/json_util.h</span>
<a href="#l35.4"></a><span id="l35.4" class="difflineat">@@ -0,0 +1,106 @@</span>
<a href="#l35.5"></a><span id="l35.5" class="difflineplus">+/*</span>
<a href="#l35.6"></a><span id="l35.6" class="difflineplus">+ * $Id: json_util.h,v 1.4 2006/01/30 23:07:57 mclark Exp $</span>
<a href="#l35.7"></a><span id="l35.7" class="difflineplus">+ *</span>
<a href="#l35.8"></a><span id="l35.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l35.9"></a><span id="l35.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l35.10"></a><span id="l35.10" class="difflineplus">+ *</span>
<a href="#l35.11"></a><span id="l35.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+ *</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineplus">+ */</span>
<a href="#l35.15"></a><span id="l35.15" class="difflineplus">+</span>
<a href="#l35.16"></a><span id="l35.16" class="difflineplus">+/**</span>
<a href="#l35.17"></a><span id="l35.17" class="difflineplus">+ * @file</span>
<a href="#l35.18"></a><span id="l35.18" class="difflineplus">+ * @brief Miscllaneous utility functions and macros.</span>
<a href="#l35.19"></a><span id="l35.19" class="difflineplus">+ */ </span>
<a href="#l35.20"></a><span id="l35.20" class="difflineplus">+#ifndef _json_util_h_</span>
<a href="#l35.21"></a><span id="l35.21" class="difflineplus">+#define _json_util_h_</span>
<a href="#l35.22"></a><span id="l35.22" class="difflineplus">+</span>
<a href="#l35.23"></a><span id="l35.23" class="difflineplus">+#include &quot;json_object.h&quot;</span>
<a href="#l35.24"></a><span id="l35.24" class="difflineplus">+</span>
<a href="#l35.25"></a><span id="l35.25" class="difflineplus">+#ifndef json_min</span>
<a href="#l35.26"></a><span id="l35.26" class="difflineplus">+#define json_min(a,b) ((a) &lt; (b) ? (a) : (b))</span>
<a href="#l35.27"></a><span id="l35.27" class="difflineplus">+#endif</span>
<a href="#l35.28"></a><span id="l35.28" class="difflineplus">+</span>
<a href="#l35.29"></a><span id="l35.29" class="difflineplus">+#ifndef json_max</span>
<a href="#l35.30"></a><span id="l35.30" class="difflineplus">+#define json_max(a,b) ((a) &gt; (b) ? (a) : (b))</span>
<a href="#l35.31"></a><span id="l35.31" class="difflineplus">+#endif</span>
<a href="#l35.32"></a><span id="l35.32" class="difflineplus">+</span>
<a href="#l35.33"></a><span id="l35.33" class="difflineplus">+</span>
<a href="#l35.34"></a><span id="l35.34" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l35.35"></a><span id="l35.35" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l35.36"></a><span id="l35.36" class="difflineplus">+#endif</span>
<a href="#l35.37"></a><span id="l35.37" class="difflineplus">+</span>
<a href="#l35.38"></a><span id="l35.38" class="difflineplus">+#define JSON_FILE_BUF_SIZE 4096</span>
<a href="#l35.39"></a><span id="l35.39" class="difflineplus">+</span>
<a href="#l35.40"></a><span id="l35.40" class="difflineplus">+/* utility functions */</span>
<a href="#l35.41"></a><span id="l35.41" class="difflineplus">+/**</span>
<a href="#l35.42"></a><span id="l35.42" class="difflineplus">+ * Read the full contents of the given file, then convert it to a</span>
<a href="#l35.43"></a><span id="l35.43" class="difflineplus">+ * json_object using json_tokener_parse().</span>
<a href="#l35.44"></a><span id="l35.44" class="difflineplus">+ *</span>
<a href="#l35.45"></a><span id="l35.45" class="difflineplus">+ * Returns -1 if something fails.  See json_util_get_last_err() for details.</span>
<a href="#l35.46"></a><span id="l35.46" class="difflineplus">+ */</span>
<a href="#l35.47"></a><span id="l35.47" class="difflineplus">+extern struct json_object* json_object_from_file(const char *filename);</span>
<a href="#l35.48"></a><span id="l35.48" class="difflineplus">+</span>
<a href="#l35.49"></a><span id="l35.49" class="difflineplus">+/**</span>
<a href="#l35.50"></a><span id="l35.50" class="difflineplus">+ * Create a JSON object from already opened file descriptor.</span>
<a href="#l35.51"></a><span id="l35.51" class="difflineplus">+ *</span>
<a href="#l35.52"></a><span id="l35.52" class="difflineplus">+ * This function can be helpful, when you opened the file already,</span>
<a href="#l35.53"></a><span id="l35.53" class="difflineplus">+ * e.g. when you have a temp file.</span>
<a href="#l35.54"></a><span id="l35.54" class="difflineplus">+ * Note, that the fd must be readable at the actual position, i.e.</span>
<a href="#l35.55"></a><span id="l35.55" class="difflineplus">+ * use lseek(fd, 0, SEEK_SET) before.</span>
<a href="#l35.56"></a><span id="l35.56" class="difflineplus">+ *</span>
<a href="#l35.57"></a><span id="l35.57" class="difflineplus">+ * Returns -1 if something fails.  See json_util_get_last_err() for details.</span>
<a href="#l35.58"></a><span id="l35.58" class="difflineplus">+ */</span>
<a href="#l35.59"></a><span id="l35.59" class="difflineplus">+extern struct json_object* json_object_from_fd(int fd);</span>
<a href="#l35.60"></a><span id="l35.60" class="difflineplus">+</span>
<a href="#l35.61"></a><span id="l35.61" class="difflineplus">+/**</span>
<a href="#l35.62"></a><span id="l35.62" class="difflineplus">+ * Equivalent to:</span>
<a href="#l35.63"></a><span id="l35.63" class="difflineplus">+ *   json_object_to_file_ext(filename, obj, JSON_C_TO_STRING_PLAIN);</span>
<a href="#l35.64"></a><span id="l35.64" class="difflineplus">+ *</span>
<a href="#l35.65"></a><span id="l35.65" class="difflineplus">+ * Returns -1 if something fails.  See json_util_get_last_err() for details.</span>
<a href="#l35.66"></a><span id="l35.66" class="difflineplus">+ */</span>
<a href="#l35.67"></a><span id="l35.67" class="difflineplus">+extern int json_object_to_file(const char *filename, struct json_object *obj);</span>
<a href="#l35.68"></a><span id="l35.68" class="difflineplus">+</span>
<a href="#l35.69"></a><span id="l35.69" class="difflineplus">+/**</span>
<a href="#l35.70"></a><span id="l35.70" class="difflineplus">+ * Open and truncate the given file, creating it if necessary, then</span>
<a href="#l35.71"></a><span id="l35.71" class="difflineplus">+ * convert the json_object to a string and write it to the file.</span>
<a href="#l35.72"></a><span id="l35.72" class="difflineplus">+ *</span>
<a href="#l35.73"></a><span id="l35.73" class="difflineplus">+ * Returns -1 if something fails.  See json_util_get_last_err() for details.</span>
<a href="#l35.74"></a><span id="l35.74" class="difflineplus">+ */</span>
<a href="#l35.75"></a><span id="l35.75" class="difflineplus">+extern int json_object_to_file_ext(const char *filename, struct json_object *obj, int flags);</span>
<a href="#l35.76"></a><span id="l35.76" class="difflineplus">+</span>
<a href="#l35.77"></a><span id="l35.77" class="difflineplus">+/**</span>
<a href="#l35.78"></a><span id="l35.78" class="difflineplus">+ * Convert the json_object to a string and write it to the file descriptor.</span>
<a href="#l35.79"></a><span id="l35.79" class="difflineplus">+ * Handles partial writes and will keep writing until done, or an error</span>
<a href="#l35.80"></a><span id="l35.80" class="difflineplus">+ * occurs.</span>
<a href="#l35.81"></a><span id="l35.81" class="difflineplus">+ *</span>
<a href="#l35.82"></a><span id="l35.82" class="difflineplus">+ * @param fd an open, writable file descriptor to write to</span>
<a href="#l35.83"></a><span id="l35.83" class="difflineplus">+ * @param obj the object to serializer and write</span>
<a href="#l35.84"></a><span id="l35.84" class="difflineplus">+ * @param flags flags to pass to json_object_to_json_string_ext()</span>
<a href="#l35.85"></a><span id="l35.85" class="difflineplus">+ * @return -1 if something fails.  See json_util_get_last_err() for details.</span>
<a href="#l35.86"></a><span id="l35.86" class="difflineplus">+ */</span>
<a href="#l35.87"></a><span id="l35.87" class="difflineplus">+extern int json_object_to_fd(int fd, struct json_object *obj, int flags);</span>
<a href="#l35.88"></a><span id="l35.88" class="difflineplus">+</span>
<a href="#l35.89"></a><span id="l35.89" class="difflineplus">+/**</span>
<a href="#l35.90"></a><span id="l35.90" class="difflineplus">+ * Return the last error from various json-c functions, including:</span>
<a href="#l35.91"></a><span id="l35.91" class="difflineplus">+ * json_object_to_file{,_ext}, json_object_to_fd() or</span>
<a href="#l35.92"></a><span id="l35.92" class="difflineplus">+ * json_object_from_{file,fd}, or NULL if there is none.</span>
<a href="#l35.93"></a><span id="l35.93" class="difflineplus">+ */</span>
<a href="#l35.94"></a><span id="l35.94" class="difflineplus">+const char *json_util_get_last_err(void);</span>
<a href="#l35.95"></a><span id="l35.95" class="difflineplus">+</span>
<a href="#l35.96"></a><span id="l35.96" class="difflineplus">+</span>
<a href="#l35.97"></a><span id="l35.97" class="difflineplus">+extern int json_parse_int64(const char *buf, int64_t *retval);</span>
<a href="#l35.98"></a><span id="l35.98" class="difflineplus">+extern int json_parse_double(const char *buf, double *retval);</span>
<a href="#l35.99"></a><span id="l35.99" class="difflineplus">+</span>
<a href="#l35.100"></a><span id="l35.100" class="difflineplus">+/**</span>
<a href="#l35.101"></a><span id="l35.101" class="difflineplus">+ * Return a string describing the type of the object.</span>
<a href="#l35.102"></a><span id="l35.102" class="difflineplus">+ * e.g. &quot;int&quot;, or &quot;object&quot;, etc...</span>
<a href="#l35.103"></a><span id="l35.103" class="difflineplus">+ */</span>
<a href="#l35.104"></a><span id="l35.104" class="difflineplus">+extern const char *json_type_to_name(enum json_type o_type);</span>
<a href="#l35.105"></a><span id="l35.105" class="difflineplus">+</span>
<a href="#l35.106"></a><span id="l35.106" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l35.107"></a><span id="l35.107" class="difflineplus">+}</span>
<a href="#l35.108"></a><span id="l35.108" class="difflineplus">+#endif</span>
<a href="#l35.109"></a><span id="l35.109" class="difflineplus">+</span>
<a href="#l35.110"></a><span id="l35.110" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1">new file mode 100644</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineminus">--- /dev/null</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineplus">+++ b/third_party/json-c/json_visit.c</span>
<a href="#l36.4"></a><span id="l36.4" class="difflineat">@@ -0,0 +1,133 @@</span>
<a href="#l36.5"></a><span id="l36.5" class="difflineplus">+/*</span>
<a href="#l36.6"></a><span id="l36.6" class="difflineplus">+ * Copyright (c) 2016 Eric Haszlakiewicz</span>
<a href="#l36.7"></a><span id="l36.7" class="difflineplus">+ *</span>
<a href="#l36.8"></a><span id="l36.8" class="difflineplus">+ * This is free software; you can redistribute it and/or modify</span>
<a href="#l36.9"></a><span id="l36.9" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l36.10"></a><span id="l36.10" class="difflineplus">+ */</span>
<a href="#l36.11"></a><span id="l36.11" class="difflineplus">+</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineplus">+#include &lt;stdio.h&gt;</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+</span>
<a href="#l36.14"></a><span id="l36.14" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l36.15"></a><span id="l36.15" class="difflineplus">+#include &quot;json_inttypes.h&quot;</span>
<a href="#l36.16"></a><span id="l36.16" class="difflineplus">+#include &quot;json_object.h&quot;</span>
<a href="#l36.17"></a><span id="l36.17" class="difflineplus">+#include &quot;json_visit.h&quot;</span>
<a href="#l36.18"></a><span id="l36.18" class="difflineplus">+#include &quot;linkhash.h&quot;</span>
<a href="#l36.19"></a><span id="l36.19" class="difflineplus">+</span>
<a href="#l36.20"></a><span id="l36.20" class="difflineplus">+static int _json_c_visit(json_object *jso, json_object *parent_jso,</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineplus">+                         const char *jso_key, size_t *jso_index,</span>
<a href="#l36.22"></a><span id="l36.22" class="difflineplus">+                         json_c_visit_userfunc *userfunc, void *userarg);</span>
<a href="#l36.23"></a><span id="l36.23" class="difflineplus">+</span>
<a href="#l36.24"></a><span id="l36.24" class="difflineplus">+int json_c_visit(json_object *jso, int future_flags,</span>
<a href="#l36.25"></a><span id="l36.25" class="difflineplus">+                 json_c_visit_userfunc *userfunc, void *userarg)</span>
<a href="#l36.26"></a><span id="l36.26" class="difflineplus">+{</span>
<a href="#l36.27"></a><span id="l36.27" class="difflineplus">+	int ret = _json_c_visit(jso, NULL, NULL, NULL, userfunc, userarg);</span>
<a href="#l36.28"></a><span id="l36.28" class="difflineplus">+	switch(ret)</span>
<a href="#l36.29"></a><span id="l36.29" class="difflineplus">+	{</span>
<a href="#l36.30"></a><span id="l36.30" class="difflineplus">+	case JSON_C_VISIT_RETURN_CONTINUE:</span>
<a href="#l36.31"></a><span id="l36.31" class="difflineplus">+	case JSON_C_VISIT_RETURN_SKIP:</span>
<a href="#l36.32"></a><span id="l36.32" class="difflineplus">+	case JSON_C_VISIT_RETURN_POP:</span>
<a href="#l36.33"></a><span id="l36.33" class="difflineplus">+	case JSON_C_VISIT_RETURN_STOP:</span>
<a href="#l36.34"></a><span id="l36.34" class="difflineplus">+		return 0;</span>
<a href="#l36.35"></a><span id="l36.35" class="difflineplus">+	default:</span>
<a href="#l36.36"></a><span id="l36.36" class="difflineplus">+		return JSON_C_VISIT_RETURN_ERROR;</span>
<a href="#l36.37"></a><span id="l36.37" class="difflineplus">+	}</span>
<a href="#l36.38"></a><span id="l36.38" class="difflineplus">+}</span>
<a href="#l36.39"></a><span id="l36.39" class="difflineplus">+static int _json_c_visit(json_object *jso, json_object *parent_jso,</span>
<a href="#l36.40"></a><span id="l36.40" class="difflineplus">+                         const char *jso_key, size_t *jso_index,</span>
<a href="#l36.41"></a><span id="l36.41" class="difflineplus">+                         json_c_visit_userfunc *userfunc, void *userarg)</span>
<a href="#l36.42"></a><span id="l36.42" class="difflineplus">+{</span>
<a href="#l36.43"></a><span id="l36.43" class="difflineplus">+	int userret = userfunc(jso, 0, parent_jso, jso_key, jso_index, userarg);</span>
<a href="#l36.44"></a><span id="l36.44" class="difflineplus">+	switch(userret)</span>
<a href="#l36.45"></a><span id="l36.45" class="difflineplus">+	{</span>
<a href="#l36.46"></a><span id="l36.46" class="difflineplus">+	case JSON_C_VISIT_RETURN_CONTINUE:</span>
<a href="#l36.47"></a><span id="l36.47" class="difflineplus">+		break;</span>
<a href="#l36.48"></a><span id="l36.48" class="difflineplus">+	case JSON_C_VISIT_RETURN_SKIP:</span>
<a href="#l36.49"></a><span id="l36.49" class="difflineplus">+	case JSON_C_VISIT_RETURN_POP:</span>
<a href="#l36.50"></a><span id="l36.50" class="difflineplus">+	case JSON_C_VISIT_RETURN_STOP:</span>
<a href="#l36.51"></a><span id="l36.51" class="difflineplus">+	case JSON_C_VISIT_RETURN_ERROR:</span>
<a href="#l36.52"></a><span id="l36.52" class="difflineplus">+		return userret;</span>
<a href="#l36.53"></a><span id="l36.53" class="difflineplus">+	default:</span>
<a href="#l36.54"></a><span id="l36.54" class="difflineplus">+		fprintf(stderr, &quot;ERROR: invalid return value from json_c_visit userfunc: %d\n&quot;, userret);</span>
<a href="#l36.55"></a><span id="l36.55" class="difflineplus">+		return JSON_C_VISIT_RETURN_ERROR;</span>
<a href="#l36.56"></a><span id="l36.56" class="difflineplus">+	}</span>
<a href="#l36.57"></a><span id="l36.57" class="difflineplus">+</span>
<a href="#l36.58"></a><span id="l36.58" class="difflineplus">+	switch(json_object_get_type(jso))</span>
<a href="#l36.59"></a><span id="l36.59" class="difflineplus">+	{</span>
<a href="#l36.60"></a><span id="l36.60" class="difflineplus">+	case json_type_null:</span>
<a href="#l36.61"></a><span id="l36.61" class="difflineplus">+	case json_type_boolean:</span>
<a href="#l36.62"></a><span id="l36.62" class="difflineplus">+	case json_type_double:</span>
<a href="#l36.63"></a><span id="l36.63" class="difflineplus">+	case json_type_int:</span>
<a href="#l36.64"></a><span id="l36.64" class="difflineplus">+	case json_type_string:</span>
<a href="#l36.65"></a><span id="l36.65" class="difflineplus">+		// we already called userfunc above, move on to the next object</span>
<a href="#l36.66"></a><span id="l36.66" class="difflineplus">+		return JSON_C_VISIT_RETURN_CONTINUE;</span>
<a href="#l36.67"></a><span id="l36.67" class="difflineplus">+</span>
<a href="#l36.68"></a><span id="l36.68" class="difflineplus">+	case json_type_object:</span>
<a href="#l36.69"></a><span id="l36.69" class="difflineplus">+	{</span>
<a href="#l36.70"></a><span id="l36.70" class="difflineplus">+		json_object_object_foreach(jso, key, child)</span>
<a href="#l36.71"></a><span id="l36.71" class="difflineplus">+		{</span>
<a href="#l36.72"></a><span id="l36.72" class="difflineplus">+			userret = _json_c_visit(child, jso, key, NULL, userfunc, userarg);</span>
<a href="#l36.73"></a><span id="l36.73" class="difflineplus">+			if (userret == JSON_C_VISIT_RETURN_POP)</span>
<a href="#l36.74"></a><span id="l36.74" class="difflineplus">+				break;</span>
<a href="#l36.75"></a><span id="l36.75" class="difflineplus">+			if (userret == JSON_C_VISIT_RETURN_STOP ||</span>
<a href="#l36.76"></a><span id="l36.76" class="difflineplus">+				userret == JSON_C_VISIT_RETURN_ERROR)</span>
<a href="#l36.77"></a><span id="l36.77" class="difflineplus">+				return userret;</span>
<a href="#l36.78"></a><span id="l36.78" class="difflineplus">+			if (userret != JSON_C_VISIT_RETURN_CONTINUE &amp;&amp;</span>
<a href="#l36.79"></a><span id="l36.79" class="difflineplus">+				userret != JSON_C_VISIT_RETURN_SKIP)</span>
<a href="#l36.80"></a><span id="l36.80" class="difflineplus">+			{</span>
<a href="#l36.81"></a><span id="l36.81" class="difflineplus">+				fprintf(stderr, &quot;INTERNAL ERROR: _json_c_visit returned %d\n&quot;, userret);</span>
<a href="#l36.82"></a><span id="l36.82" class="difflineplus">+				return JSON_C_VISIT_RETURN_ERROR;</span>
<a href="#l36.83"></a><span id="l36.83" class="difflineplus">+			}</span>
<a href="#l36.84"></a><span id="l36.84" class="difflineplus">+		}</span>
<a href="#l36.85"></a><span id="l36.85" class="difflineplus">+		break;</span>
<a href="#l36.86"></a><span id="l36.86" class="difflineplus">+	}</span>
<a href="#l36.87"></a><span id="l36.87" class="difflineplus">+	case json_type_array:</span>
<a href="#l36.88"></a><span id="l36.88" class="difflineplus">+	{</span>
<a href="#l36.89"></a><span id="l36.89" class="difflineplus">+		size_t array_len = json_object_array_length(jso);</span>
<a href="#l36.90"></a><span id="l36.90" class="difflineplus">+		size_t ii;</span>
<a href="#l36.91"></a><span id="l36.91" class="difflineplus">+		for (ii = 0; ii &lt; array_len; ii++)</span>
<a href="#l36.92"></a><span id="l36.92" class="difflineplus">+		{</span>
<a href="#l36.93"></a><span id="l36.93" class="difflineplus">+			json_object *child = json_object_array_get_idx(jso, ii);</span>
<a href="#l36.94"></a><span id="l36.94" class="difflineplus">+			userret = _json_c_visit(child, jso, NULL, &amp;ii, userfunc, userarg);</span>
<a href="#l36.95"></a><span id="l36.95" class="difflineplus">+			if (userret == JSON_C_VISIT_RETURN_POP)</span>
<a href="#l36.96"></a><span id="l36.96" class="difflineplus">+				break;</span>
<a href="#l36.97"></a><span id="l36.97" class="difflineplus">+			if (userret == JSON_C_VISIT_RETURN_STOP ||</span>
<a href="#l36.98"></a><span id="l36.98" class="difflineplus">+				userret == JSON_C_VISIT_RETURN_ERROR)</span>
<a href="#l36.99"></a><span id="l36.99" class="difflineplus">+				return userret;</span>
<a href="#l36.100"></a><span id="l36.100" class="difflineplus">+			if (userret != JSON_C_VISIT_RETURN_CONTINUE &amp;&amp;</span>
<a href="#l36.101"></a><span id="l36.101" class="difflineplus">+				userret != JSON_C_VISIT_RETURN_SKIP)</span>
<a href="#l36.102"></a><span id="l36.102" class="difflineplus">+			{</span>
<a href="#l36.103"></a><span id="l36.103" class="difflineplus">+				fprintf(stderr, &quot;INTERNAL ERROR: _json_c_visit returned %d\n&quot;, userret);</span>
<a href="#l36.104"></a><span id="l36.104" class="difflineplus">+				return JSON_C_VISIT_RETURN_ERROR;</span>
<a href="#l36.105"></a><span id="l36.105" class="difflineplus">+			}</span>
<a href="#l36.106"></a><span id="l36.106" class="difflineplus">+		}</span>
<a href="#l36.107"></a><span id="l36.107" class="difflineplus">+		break;</span>
<a href="#l36.108"></a><span id="l36.108" class="difflineplus">+	}</span>
<a href="#l36.109"></a><span id="l36.109" class="difflineplus">+	default:</span>
<a href="#l36.110"></a><span id="l36.110" class="difflineplus">+		fprintf(stderr, &quot;INTERNAL ERROR: _json_c_visit found object of unknown type: %d\n&quot;, json_object_get_type(jso));</span>
<a href="#l36.111"></a><span id="l36.111" class="difflineplus">+		return JSON_C_VISIT_RETURN_ERROR;</span>
<a href="#l36.112"></a><span id="l36.112" class="difflineplus">+	}</span>
<a href="#l36.113"></a><span id="l36.113" class="difflineplus">+</span>
<a href="#l36.114"></a><span id="l36.114" class="difflineplus">+	// Call userfunc for the second type on container types, after all</span>
<a href="#l36.115"></a><span id="l36.115" class="difflineplus">+	//  members of the container have been visited.</span>
<a href="#l36.116"></a><span id="l36.116" class="difflineplus">+	// Non-container types will have already returned before this point.</span>
<a href="#l36.117"></a><span id="l36.117" class="difflineplus">+</span>
<a href="#l36.118"></a><span id="l36.118" class="difflineplus">+	userret = userfunc(jso, JSON_C_VISIT_SECOND, parent_jso, jso_key, jso_index, userarg);</span>
<a href="#l36.119"></a><span id="l36.119" class="difflineplus">+	switch(userret)</span>
<a href="#l36.120"></a><span id="l36.120" class="difflineplus">+	{</span>
<a href="#l36.121"></a><span id="l36.121" class="difflineplus">+	case JSON_C_VISIT_RETURN_SKIP:</span>
<a href="#l36.122"></a><span id="l36.122" class="difflineplus">+	case JSON_C_VISIT_RETURN_POP:</span>
<a href="#l36.123"></a><span id="l36.123" class="difflineplus">+		// These are not really sensible during JSON_C_VISIT_SECOND, </span>
<a href="#l36.124"></a><span id="l36.124" class="difflineplus">+		// but map them to JSON_C_VISIT_CONTINUE anyway.</span>
<a href="#l36.125"></a><span id="l36.125" class="difflineplus">+		// FALLTHROUGH</span>
<a href="#l36.126"></a><span id="l36.126" class="difflineplus">+	case JSON_C_VISIT_RETURN_CONTINUE:</span>
<a href="#l36.127"></a><span id="l36.127" class="difflineplus">+		return JSON_C_VISIT_RETURN_CONTINUE;</span>
<a href="#l36.128"></a><span id="l36.128" class="difflineplus">+	case JSON_C_VISIT_RETURN_STOP:</span>
<a href="#l36.129"></a><span id="l36.129" class="difflineplus">+	case JSON_C_VISIT_RETURN_ERROR:</span>
<a href="#l36.130"></a><span id="l36.130" class="difflineplus">+		return userret;</span>
<a href="#l36.131"></a><span id="l36.131" class="difflineplus">+	default:</span>
<a href="#l36.132"></a><span id="l36.132" class="difflineplus">+		fprintf(stderr, &quot;ERROR: invalid return value from json_c_visit userfunc: %d\n&quot;, userret);</span>
<a href="#l36.133"></a><span id="l36.133" class="difflineplus">+		return JSON_C_VISIT_RETURN_ERROR;</span>
<a href="#l36.134"></a><span id="l36.134" class="difflineplus">+	}</span>
<a href="#l36.135"></a><span id="l36.135" class="difflineplus">+	// NOTREACHED</span>
<a href="#l36.136"></a><span id="l36.136" class="difflineplus">+}</span>
<a href="#l36.137"></a><span id="l36.137" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1">new file mode 100644</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineminus">--- /dev/null</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineplus">+++ b/third_party/json-c/json_visit.h</span>
<a href="#l37.4"></a><span id="l37.4" class="difflineat">@@ -0,0 +1,95 @@</span>
<a href="#l37.5"></a><span id="l37.5" class="difflineplus">+</span>
<a href="#l37.6"></a><span id="l37.6" class="difflineplus">+#ifndef _json_c_json_visit_h_</span>
<a href="#l37.7"></a><span id="l37.7" class="difflineplus">+#define _json_c_json_visit_h_</span>
<a href="#l37.8"></a><span id="l37.8" class="difflineplus">+</span>
<a href="#l37.9"></a><span id="l37.9" class="difflineplus">+/**</span>
<a href="#l37.10"></a><span id="l37.10" class="difflineplus">+ * @file</span>
<a href="#l37.11"></a><span id="l37.11" class="difflineplus">+ * @brief Methods for walking a tree of objects.</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineplus">+ */</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+#include &quot;json_object.h&quot;</span>
<a href="#l37.14"></a><span id="l37.14" class="difflineplus">+</span>
<a href="#l37.15"></a><span id="l37.15" class="difflineplus">+typedef int (json_c_visit_userfunc)(json_object *jso, int flags,</span>
<a href="#l37.16"></a><span id="l37.16" class="difflineplus">+                                     json_object *parent_jso,                                                        const char *jso_key,</span>
<a href="#l37.17"></a><span id="l37.17" class="difflineplus">+                                     size_t *jso_index, void *userarg);</span>
<a href="#l37.18"></a><span id="l37.18" class="difflineplus">+</span>
<a href="#l37.19"></a><span id="l37.19" class="difflineplus">+/**</span>
<a href="#l37.20"></a><span id="l37.20" class="difflineplus">+ * Visit each object in the JSON hierarchy starting at jso.</span>
<a href="#l37.21"></a><span id="l37.21" class="difflineplus">+ * For each object, userfunc is called, passing the object and userarg.</span>
<a href="#l37.22"></a><span id="l37.22" class="difflineplus">+ * If the object has a parent (i.e. anything other than jso itself)</span>
<a href="#l37.23"></a><span id="l37.23" class="difflineplus">+ * its parent will be passed as parent_jso, and either jso_key or jso_index</span>
<a href="#l37.24"></a><span id="l37.24" class="difflineplus">+ * will be set, depending on whether the parent is an object or an array.</span>
<a href="#l37.25"></a><span id="l37.25" class="difflineplus">+ *</span>
<a href="#l37.26"></a><span id="l37.26" class="difflineplus">+ * Nodes will be visited depth first, but containers (arrays and objects)</span>
<a href="#l37.27"></a><span id="l37.27" class="difflineplus">+ * will be visited twice, the second time with JSON_C_VISIT_SECOND set in</span>
<a href="#l37.28"></a><span id="l37.28" class="difflineplus">+ * flags.</span>
<a href="#l37.29"></a><span id="l37.29" class="difflineplus">+ *</span>
<a href="#l37.30"></a><span id="l37.30" class="difflineplus">+ * userfunc must return one of the defined return values, to indicate</span>
<a href="#l37.31"></a><span id="l37.31" class="difflineplus">+ * whether and how to continue visiting nodes, or one of various ways to stop.</span>
<a href="#l37.32"></a><span id="l37.32" class="difflineplus">+ *</span>
<a href="#l37.33"></a><span id="l37.33" class="difflineplus">+ * Returns 0 if nodes were visited successfully, even if some were </span>
<a href="#l37.34"></a><span id="l37.34" class="difflineplus">+ *  intentionally skipped due to what userfunc returned.</span>
<a href="#l37.35"></a><span id="l37.35" class="difflineplus">+ * Returns &lt;0 if an error occurred during iteration, including if</span>
<a href="#l37.36"></a><span id="l37.36" class="difflineplus">+ *  userfunc returned JSON_C_VISIT_RETURN_ERROR.</span>
<a href="#l37.37"></a><span id="l37.37" class="difflineplus">+ */</span>
<a href="#l37.38"></a><span id="l37.38" class="difflineplus">+int json_c_visit(json_object *jso, int future_flags,</span>
<a href="#l37.39"></a><span id="l37.39" class="difflineplus">+                 json_c_visit_userfunc *userfunc, void *userarg);</span>
<a href="#l37.40"></a><span id="l37.40" class="difflineplus">+</span>
<a href="#l37.41"></a><span id="l37.41" class="difflineplus">+/**</span>
<a href="#l37.42"></a><span id="l37.42" class="difflineplus">+ * Passed to json_c_visit_userfunc as one of the flags values to indicate</span>
<a href="#l37.43"></a><span id="l37.43" class="difflineplus">+ * that this is the second time a container (array or object) is being</span>
<a href="#l37.44"></a><span id="l37.44" class="difflineplus">+ * called, after all of it's members have been iterated over.</span>
<a href="#l37.45"></a><span id="l37.45" class="difflineplus">+ */</span>
<a href="#l37.46"></a><span id="l37.46" class="difflineplus">+#define JSON_C_VISIT_SECOND  0x02</span>
<a href="#l37.47"></a><span id="l37.47" class="difflineplus">+</span>
<a href="#l37.48"></a><span id="l37.48" class="difflineplus">+/**</span>
<a href="#l37.49"></a><span id="l37.49" class="difflineplus">+ * This json_c_visit_userfunc return value indicates that iteration</span>
<a href="#l37.50"></a><span id="l37.50" class="difflineplus">+ * should proceed normally.</span>
<a href="#l37.51"></a><span id="l37.51" class="difflineplus">+ */</span>
<a href="#l37.52"></a><span id="l37.52" class="difflineplus">+#define JSON_C_VISIT_RETURN_CONTINUE 0</span>
<a href="#l37.53"></a><span id="l37.53" class="difflineplus">+</span>
<a href="#l37.54"></a><span id="l37.54" class="difflineplus">+</span>
<a href="#l37.55"></a><span id="l37.55" class="difflineplus">+/**</span>
<a href="#l37.56"></a><span id="l37.56" class="difflineplus">+ * This json_c_visit_userfunc return value indicates that iteration</span>
<a href="#l37.57"></a><span id="l37.57" class="difflineplus">+ * over the members of the current object should be skipped.</span>
<a href="#l37.58"></a><span id="l37.58" class="difflineplus">+ * If the current object isn't a container (array or object), this</span>
<a href="#l37.59"></a><span id="l37.59" class="difflineplus">+ * is no different than JSON_C_VISIT_RETURN_CONTINUE.</span>
<a href="#l37.60"></a><span id="l37.60" class="difflineplus">+ */</span>
<a href="#l37.61"></a><span id="l37.61" class="difflineplus">+#define JSON_C_VISIT_RETURN_SKIP 7547</span>
<a href="#l37.62"></a><span id="l37.62" class="difflineplus">+</span>
<a href="#l37.63"></a><span id="l37.63" class="difflineplus">+/**</span>
<a href="#l37.64"></a><span id="l37.64" class="difflineplus">+ * This json_c_visit_userfunc return value indicates that iteration</span>
<a href="#l37.65"></a><span id="l37.65" class="difflineplus">+ * of the fields/elements of the &lt;b&gt;containing&lt;/b&gt; object should stop</span>
<a href="#l37.66"></a><span id="l37.66" class="difflineplus">+ * and continue &quot;popped up&quot; a level of the object hierarchy.</span>
<a href="#l37.67"></a><span id="l37.67" class="difflineplus">+ * For example, returning this when handling arg will result in </span>
<a href="#l37.68"></a><span id="l37.68" class="difflineplus">+ * arg3 and any other fields being skipped.   The next call to userfunc</span>
<a href="#l37.69"></a><span id="l37.69" class="difflineplus">+ * will be the JSON_C_VISIT_SECOND call on &quot;foo&quot;, followed by a userfunc</span>
<a href="#l37.70"></a><span id="l37.70" class="difflineplus">+ * call on &quot;bar&quot;.</span>
<a href="#l37.71"></a><span id="l37.71" class="difflineplus">+ * &lt;pre&gt;</span>
<a href="#l37.72"></a><span id="l37.72" class="difflineplus">+ * {</span>
<a href="#l37.73"></a><span id="l37.73" class="difflineplus">+ *   &quot;foo&quot;: {</span>
<a href="#l37.74"></a><span id="l37.74" class="difflineplus">+ *     &quot;arg1&quot;: 1,</span>
<a href="#l37.75"></a><span id="l37.75" class="difflineplus">+ *     &quot;arg2&quot;: 2,</span>
<a href="#l37.76"></a><span id="l37.76" class="difflineplus">+ *     &quot;arg3&quot;: 3,</span>
<a href="#l37.77"></a><span id="l37.77" class="difflineplus">+ *     ...</span>
<a href="#l37.78"></a><span id="l37.78" class="difflineplus">+ *   },</span>
<a href="#l37.79"></a><span id="l37.79" class="difflineplus">+ *   &quot;bar&quot;: {</span>
<a href="#l37.80"></a><span id="l37.80" class="difflineplus">+ *     ...</span>
<a href="#l37.81"></a><span id="l37.81" class="difflineplus">+ *   }</span>
<a href="#l37.82"></a><span id="l37.82" class="difflineplus">+ * }</span>
<a href="#l37.83"></a><span id="l37.83" class="difflineplus">+ * &lt;/pre&gt;</span>
<a href="#l37.84"></a><span id="l37.84" class="difflineplus">+ */</span>
<a href="#l37.85"></a><span id="l37.85" class="difflineplus">+#define JSON_C_VISIT_RETURN_POP 767</span>
<a href="#l37.86"></a><span id="l37.86" class="difflineplus">+</span>
<a href="#l37.87"></a><span id="l37.87" class="difflineplus">+/**</span>
<a href="#l37.88"></a><span id="l37.88" class="difflineplus">+ * This json_c_visit_userfunc return value indicates that iteration</span>
<a href="#l37.89"></a><span id="l37.89" class="difflineplus">+ * should stop immediately, and cause json_c_visit to return success.</span>
<a href="#l37.90"></a><span id="l37.90" class="difflineplus">+ */</span>
<a href="#l37.91"></a><span id="l37.91" class="difflineplus">+#define JSON_C_VISIT_RETURN_STOP 7867</span>
<a href="#l37.92"></a><span id="l37.92" class="difflineplus">+</span>
<a href="#l37.93"></a><span id="l37.93" class="difflineplus">+/**</span>
<a href="#l37.94"></a><span id="l37.94" class="difflineplus">+ * This json_c_visit_userfunc return value indicates that iteration</span>
<a href="#l37.95"></a><span id="l37.95" class="difflineplus">+ * should stop immediately, and cause json_c_visit to return an error.</span>
<a href="#l37.96"></a><span id="l37.96" class="difflineplus">+ */</span>
<a href="#l37.97"></a><span id="l37.97" class="difflineplus">+#define JSON_C_VISIT_RETURN_ERROR -1</span>
<a href="#l37.98"></a><span id="l37.98" class="difflineplus">+</span>
<a href="#l37.99"></a><span id="l37.99" class="difflineplus">+#endif /* _json_c_json_visit_h_ */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1">new file mode 100644</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineminus">--- /dev/null</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineplus">+++ b/third_party/json-c/libjson.c</span>
<a href="#l38.4"></a><span id="l38.4" class="difflineat">@@ -0,0 +1,26 @@</span>
<a href="#l38.5"></a><span id="l38.5" class="difflineplus">+</span>
<a href="#l38.6"></a><span id="l38.6" class="difflineplus">+/* dummy source file for compatibility purposes */</span>
<a href="#l38.7"></a><span id="l38.7" class="difflineplus">+</span>
<a href="#l38.8"></a><span id="l38.8" class="difflineplus">+#if defined(HAVE_CDEFS_H)</span>
<a href="#l38.9"></a><span id="l38.9" class="difflineplus">+#include &lt;sys/cdefs.h&gt;</span>
<a href="#l38.10"></a><span id="l38.10" class="difflineplus">+#endif</span>
<a href="#l38.11"></a><span id="l38.11" class="difflineplus">+</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineplus">+#ifndef __warn_references</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineplus">+#if defined(__GNUC__)  &amp;&amp; defined (HAS_GNU_WARNING_LONG)</span>
<a href="#l38.15"></a><span id="l38.15" class="difflineplus">+</span>
<a href="#l38.16"></a><span id="l38.16" class="difflineplus">+#define __warn_references(sym,msg)                  \</span>
<a href="#l38.17"></a><span id="l38.17" class="difflineplus">+  __asm__(&quot;.section .gnu&quot; #sym &quot;,\n\t.ascii \&quot;&quot; msg &quot;\&quot;\n\t.text&quot;);</span>
<a href="#l38.18"></a><span id="l38.18" class="difflineplus">+</span>
<a href="#l38.19"></a><span id="l38.19" class="difflineplus">+#else</span>
<a href="#l38.20"></a><span id="l38.20" class="difflineplus">+#define __warn_references(sym,msg)    /* nothing */</span>
<a href="#l38.21"></a><span id="l38.21" class="difflineplus">+#endif</span>
<a href="#l38.22"></a><span id="l38.22" class="difflineplus">+</span>
<a href="#l38.23"></a><span id="l38.23" class="difflineplus">+#endif</span>
<a href="#l38.24"></a><span id="l38.24" class="difflineplus">+</span>
<a href="#l38.25"></a><span id="l38.25" class="difflineplus">+#include &quot;json_object.h&quot;</span>
<a href="#l38.26"></a><span id="l38.26" class="difflineplus">+</span>
<a href="#l38.27"></a><span id="l38.27" class="difflineplus">+__warn_references(json_object_get, &quot;Warning: please link against libjson-c instead of libjson&quot;);</span>
<a href="#l38.28"></a><span id="l38.28" class="difflineplus">+</span>
<a href="#l38.29"></a><span id="l38.29" class="difflineplus">+/*        __asm__(&quot;.section .gnu.warning.&quot; __STRING(sym)  \</span>
<a href="#l38.30"></a><span id="l38.30" class="difflineplus">+            &quot; ; .ascii \&quot;&quot; msg &quot;\&quot; ; .text&quot;) */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1">new file mode 100644</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineminus">--- /dev/null</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineplus">+++ b/third_party/json-c/linkhash.c</span>
<a href="#l39.4"></a><span id="l39.4" class="difflineat">@@ -0,0 +1,690 @@</span>
<a href="#l39.5"></a><span id="l39.5" class="difflineplus">+/*</span>
<a href="#l39.6"></a><span id="l39.6" class="difflineplus">+ * $Id: linkhash.c,v 1.4 2006/01/26 02:16:28 mclark Exp $</span>
<a href="#l39.7"></a><span id="l39.7" class="difflineplus">+ *</span>
<a href="#l39.8"></a><span id="l39.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l39.9"></a><span id="l39.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l39.10"></a><span id="l39.10" class="difflineplus">+ * Copyright (c) 2009 Hewlett-Packard Development Company, L.P.</span>
<a href="#l39.11"></a><span id="l39.11" class="difflineplus">+ *</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l39.14"></a><span id="l39.14" class="difflineplus">+ *</span>
<a href="#l39.15"></a><span id="l39.15" class="difflineplus">+ */</span>
<a href="#l39.16"></a><span id="l39.16" class="difflineplus">+</span>
<a href="#l39.17"></a><span id="l39.17" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l39.18"></a><span id="l39.18" class="difflineplus">+</span>
<a href="#l39.19"></a><span id="l39.19" class="difflineplus">+#include &lt;stdio.h&gt;</span>
<a href="#l39.20"></a><span id="l39.20" class="difflineplus">+#include &lt;string.h&gt;</span>
<a href="#l39.21"></a><span id="l39.21" class="difflineplus">+#include &lt;stdlib.h&gt;</span>
<a href="#l39.22"></a><span id="l39.22" class="difflineplus">+#include &lt;stdarg.h&gt;</span>
<a href="#l39.23"></a><span id="l39.23" class="difflineplus">+#include &lt;stddef.h&gt;</span>
<a href="#l39.24"></a><span id="l39.24" class="difflineplus">+#include &lt;limits.h&gt;</span>
<a href="#l39.25"></a><span id="l39.25" class="difflineplus">+</span>
<a href="#l39.26"></a><span id="l39.26" class="difflineplus">+#ifdef HAVE_ENDIAN_H</span>
<a href="#l39.27"></a><span id="l39.27" class="difflineplus">+# include &lt;endian.h&gt;    /* attempt to define endianness */</span>
<a href="#l39.28"></a><span id="l39.28" class="difflineplus">+#endif</span>
<a href="#l39.29"></a><span id="l39.29" class="difflineplus">+</span>
<a href="#l39.30"></a><span id="l39.30" class="difflineplus">+#if defined(_MSC_VER) || defined(__MINGW32__)</span>
<a href="#l39.31"></a><span id="l39.31" class="difflineplus">+# define WIN32_LEAN_AND_MEAN</span>
<a href="#l39.32"></a><span id="l39.32" class="difflineplus">+# include &lt;windows.h&gt;   /* Get InterlockedCompareExchange */</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineplus">+#endif</span>
<a href="#l39.34"></a><span id="l39.34" class="difflineplus">+</span>
<a href="#l39.35"></a><span id="l39.35" class="difflineplus">+#include &quot;random_seed.h&quot;</span>
<a href="#l39.36"></a><span id="l39.36" class="difflineplus">+#include &quot;linkhash.h&quot;</span>
<a href="#l39.37"></a><span id="l39.37" class="difflineplus">+</span>
<a href="#l39.38"></a><span id="l39.38" class="difflineplus">+/* hash functions */</span>
<a href="#l39.39"></a><span id="l39.39" class="difflineplus">+static unsigned long lh_char_hash(const void *k);</span>
<a href="#l39.40"></a><span id="l39.40" class="difflineplus">+static unsigned long lh_perllike_str_hash(const void *k);</span>
<a href="#l39.41"></a><span id="l39.41" class="difflineplus">+static lh_hash_fn *char_hash_fn = lh_char_hash;</span>
<a href="#l39.42"></a><span id="l39.42" class="difflineplus">+</span>
<a href="#l39.43"></a><span id="l39.43" class="difflineplus">+int</span>
<a href="#l39.44"></a><span id="l39.44" class="difflineplus">+json_global_set_string_hash(const int h)</span>
<a href="#l39.45"></a><span id="l39.45" class="difflineplus">+{</span>
<a href="#l39.46"></a><span id="l39.46" class="difflineplus">+	switch(h) {</span>
<a href="#l39.47"></a><span id="l39.47" class="difflineplus">+	case JSON_C_STR_HASH_DFLT:</span>
<a href="#l39.48"></a><span id="l39.48" class="difflineplus">+		char_hash_fn = lh_char_hash;</span>
<a href="#l39.49"></a><span id="l39.49" class="difflineplus">+		break;</span>
<a href="#l39.50"></a><span id="l39.50" class="difflineplus">+	case JSON_C_STR_HASH_PERLLIKE:</span>
<a href="#l39.51"></a><span id="l39.51" class="difflineplus">+		char_hash_fn = lh_perllike_str_hash;</span>
<a href="#l39.52"></a><span id="l39.52" class="difflineplus">+		break;</span>
<a href="#l39.53"></a><span id="l39.53" class="difflineplus">+	default:</span>
<a href="#l39.54"></a><span id="l39.54" class="difflineplus">+		return -1;</span>
<a href="#l39.55"></a><span id="l39.55" class="difflineplus">+	}</span>
<a href="#l39.56"></a><span id="l39.56" class="difflineplus">+	return 0;</span>
<a href="#l39.57"></a><span id="l39.57" class="difflineplus">+}</span>
<a href="#l39.58"></a><span id="l39.58" class="difflineplus">+</span>
<a href="#l39.59"></a><span id="l39.59" class="difflineplus">+void lh_abort(const char *msg, ...)</span>
<a href="#l39.60"></a><span id="l39.60" class="difflineplus">+{</span>
<a href="#l39.61"></a><span id="l39.61" class="difflineplus">+	va_list ap;</span>
<a href="#l39.62"></a><span id="l39.62" class="difflineplus">+	va_start(ap, msg);</span>
<a href="#l39.63"></a><span id="l39.63" class="difflineplus">+	vprintf(msg, ap);</span>
<a href="#l39.64"></a><span id="l39.64" class="difflineplus">+	va_end(ap);</span>
<a href="#l39.65"></a><span id="l39.65" class="difflineplus">+	exit(1);</span>
<a href="#l39.66"></a><span id="l39.66" class="difflineplus">+}</span>
<a href="#l39.67"></a><span id="l39.67" class="difflineplus">+</span>
<a href="#l39.68"></a><span id="l39.68" class="difflineplus">+static unsigned long lh_ptr_hash(const void *k)</span>
<a href="#l39.69"></a><span id="l39.69" class="difflineplus">+{</span>
<a href="#l39.70"></a><span id="l39.70" class="difflineplus">+	/* CAW: refactored to be 64bit nice */</span>
<a href="#l39.71"></a><span id="l39.71" class="difflineplus">+	return (unsigned long)((((ptrdiff_t)k * LH_PRIME) &gt;&gt; 4) &amp; ULONG_MAX);</span>
<a href="#l39.72"></a><span id="l39.72" class="difflineplus">+}</span>
<a href="#l39.73"></a><span id="l39.73" class="difflineplus">+</span>
<a href="#l39.74"></a><span id="l39.74" class="difflineplus">+int lh_ptr_equal(const void *k1, const void *k2)</span>
<a href="#l39.75"></a><span id="l39.75" class="difflineplus">+{</span>
<a href="#l39.76"></a><span id="l39.76" class="difflineplus">+	return (k1 == k2);</span>
<a href="#l39.77"></a><span id="l39.77" class="difflineplus">+}</span>
<a href="#l39.78"></a><span id="l39.78" class="difflineplus">+</span>
<a href="#l39.79"></a><span id="l39.79" class="difflineplus">+/*</span>
<a href="#l39.80"></a><span id="l39.80" class="difflineplus">+ * hashlittle from lookup3.c, by Bob Jenkins, May 2006, Public Domain.</span>
<a href="#l39.81"></a><span id="l39.81" class="difflineplus">+ * http://burtleburtle.net/bob/c/lookup3.c</span>
<a href="#l39.82"></a><span id="l39.82" class="difflineplus">+ * minor modifications to make functions static so no symbols are exported</span>
<a href="#l39.83"></a><span id="l39.83" class="difflineplus">+ * minor mofifications to compile with -Werror</span>
<a href="#l39.84"></a><span id="l39.84" class="difflineplus">+ */</span>
<a href="#l39.85"></a><span id="l39.85" class="difflineplus">+</span>
<a href="#l39.86"></a><span id="l39.86" class="difflineplus">+/*</span>
<a href="#l39.87"></a><span id="l39.87" class="difflineplus">+-------------------------------------------------------------------------------</span>
<a href="#l39.88"></a><span id="l39.88" class="difflineplus">+lookup3.c, by Bob Jenkins, May 2006, Public Domain.</span>
<a href="#l39.89"></a><span id="l39.89" class="difflineplus">+</span>
<a href="#l39.90"></a><span id="l39.90" class="difflineplus">+These are functions for producing 32-bit hashes for hash table lookup.</span>
<a href="#l39.91"></a><span id="l39.91" class="difflineplus">+hashword(), hashlittle(), hashlittle2(), hashbig(), mix(), and final()</span>
<a href="#l39.92"></a><span id="l39.92" class="difflineplus">+are externally useful functions.  Routines to test the hash are included</span>
<a href="#l39.93"></a><span id="l39.93" class="difflineplus">+if SELF_TEST is defined.  You can use this free for any purpose.  It's in</span>
<a href="#l39.94"></a><span id="l39.94" class="difflineplus">+the public domain.  It has no warranty.</span>
<a href="#l39.95"></a><span id="l39.95" class="difflineplus">+</span>
<a href="#l39.96"></a><span id="l39.96" class="difflineplus">+You probably want to use hashlittle().  hashlittle() and hashbig()</span>
<a href="#l39.97"></a><span id="l39.97" class="difflineplus">+hash byte arrays.  hashlittle() is is faster than hashbig() on</span>
<a href="#l39.98"></a><span id="l39.98" class="difflineplus">+little-endian machines.  Intel and AMD are little-endian machines.</span>
<a href="#l39.99"></a><span id="l39.99" class="difflineplus">+On second thought, you probably want hashlittle2(), which is identical to</span>
<a href="#l39.100"></a><span id="l39.100" class="difflineplus">+hashlittle() except it returns two 32-bit hashes for the price of one.</span>
<a href="#l39.101"></a><span id="l39.101" class="difflineplus">+You could implement hashbig2() if you wanted but I haven't bothered here.</span>
<a href="#l39.102"></a><span id="l39.102" class="difflineplus">+</span>
<a href="#l39.103"></a><span id="l39.103" class="difflineplus">+If you want to find a hash of, say, exactly 7 integers, do</span>
<a href="#l39.104"></a><span id="l39.104" class="difflineplus">+  a = i1;  b = i2;  c = i3;</span>
<a href="#l39.105"></a><span id="l39.105" class="difflineplus">+  mix(a,b,c);</span>
<a href="#l39.106"></a><span id="l39.106" class="difflineplus">+  a += i4; b += i5; c += i6;</span>
<a href="#l39.107"></a><span id="l39.107" class="difflineplus">+  mix(a,b,c);</span>
<a href="#l39.108"></a><span id="l39.108" class="difflineplus">+  a += i7;</span>
<a href="#l39.109"></a><span id="l39.109" class="difflineplus">+  final(a,b,c);</span>
<a href="#l39.110"></a><span id="l39.110" class="difflineplus">+then use c as the hash value.  If you have a variable length array of</span>
<a href="#l39.111"></a><span id="l39.111" class="difflineplus">+4-byte integers to hash, use hashword().  If you have a byte array (like</span>
<a href="#l39.112"></a><span id="l39.112" class="difflineplus">+a character string), use hashlittle().  If you have several byte arrays, or</span>
<a href="#l39.113"></a><span id="l39.113" class="difflineplus">+a mix of things, see the comments above hashlittle().</span>
<a href="#l39.114"></a><span id="l39.114" class="difflineplus">+</span>
<a href="#l39.115"></a><span id="l39.115" class="difflineplus">+Why is this so big?  I read 12 bytes at a time into 3 4-byte integers,</span>
<a href="#l39.116"></a><span id="l39.116" class="difflineplus">+then mix those integers.  This is fast (you can do a lot more thorough</span>
<a href="#l39.117"></a><span id="l39.117" class="difflineplus">+mixing with 12*3 instructions on 3 integers than you can with 3 instructions</span>
<a href="#l39.118"></a><span id="l39.118" class="difflineplus">+on 1 byte), but shoehorning those bytes into integers efficiently is messy.</span>
<a href="#l39.119"></a><span id="l39.119" class="difflineplus">+-------------------------------------------------------------------------------</span>
<a href="#l39.120"></a><span id="l39.120" class="difflineplus">+*/</span>
<a href="#l39.121"></a><span id="l39.121" class="difflineplus">+</span>
<a href="#l39.122"></a><span id="l39.122" class="difflineplus">+/*</span>
<a href="#l39.123"></a><span id="l39.123" class="difflineplus">+ * My best guess at if you are big-endian or little-endian.  This may</span>
<a href="#l39.124"></a><span id="l39.124" class="difflineplus">+ * need adjustment.</span>
<a href="#l39.125"></a><span id="l39.125" class="difflineplus">+ */</span>
<a href="#l39.126"></a><span id="l39.126" class="difflineplus">+#if (defined(__BYTE_ORDER) &amp;&amp; defined(__LITTLE_ENDIAN) &amp;&amp; \</span>
<a href="#l39.127"></a><span id="l39.127" class="difflineplus">+     __BYTE_ORDER == __LITTLE_ENDIAN) || \</span>
<a href="#l39.128"></a><span id="l39.128" class="difflineplus">+    (defined(i386) || defined(__i386__) || defined(__i486__) || \</span>
<a href="#l39.129"></a><span id="l39.129" class="difflineplus">+     defined(__i586__) || defined(__i686__) || defined(vax) || defined(MIPSEL))</span>
<a href="#l39.130"></a><span id="l39.130" class="difflineplus">+# define HASH_LITTLE_ENDIAN 1</span>
<a href="#l39.131"></a><span id="l39.131" class="difflineplus">+# define HASH_BIG_ENDIAN 0</span>
<a href="#l39.132"></a><span id="l39.132" class="difflineplus">+#elif (defined(__BYTE_ORDER) &amp;&amp; defined(__BIG_ENDIAN) &amp;&amp; \</span>
<a href="#l39.133"></a><span id="l39.133" class="difflineplus">+       __BYTE_ORDER == __BIG_ENDIAN) || \</span>
<a href="#l39.134"></a><span id="l39.134" class="difflineplus">+      (defined(sparc) || defined(POWERPC) || defined(mc68000) || defined(sel))</span>
<a href="#l39.135"></a><span id="l39.135" class="difflineplus">+# define HASH_LITTLE_ENDIAN 0</span>
<a href="#l39.136"></a><span id="l39.136" class="difflineplus">+# define HASH_BIG_ENDIAN 1</span>
<a href="#l39.137"></a><span id="l39.137" class="difflineplus">+#else</span>
<a href="#l39.138"></a><span id="l39.138" class="difflineplus">+# define HASH_LITTLE_ENDIAN 0</span>
<a href="#l39.139"></a><span id="l39.139" class="difflineplus">+# define HASH_BIG_ENDIAN 0</span>
<a href="#l39.140"></a><span id="l39.140" class="difflineplus">+#endif</span>
<a href="#l39.141"></a><span id="l39.141" class="difflineplus">+</span>
<a href="#l39.142"></a><span id="l39.142" class="difflineplus">+#define hashsize(n) ((uint32_t)1&lt;&lt;(n))</span>
<a href="#l39.143"></a><span id="l39.143" class="difflineplus">+#define hashmask(n) (hashsize(n)-1)</span>
<a href="#l39.144"></a><span id="l39.144" class="difflineplus">+#define rot(x,k) (((x)&lt;&lt;(k)) | ((x)&gt;&gt;(32-(k))))</span>
<a href="#l39.145"></a><span id="l39.145" class="difflineplus">+</span>
<a href="#l39.146"></a><span id="l39.146" class="difflineplus">+/*</span>
<a href="#l39.147"></a><span id="l39.147" class="difflineplus">+-------------------------------------------------------------------------------</span>
<a href="#l39.148"></a><span id="l39.148" class="difflineplus">+mix -- mix 3 32-bit values reversibly.</span>
<a href="#l39.149"></a><span id="l39.149" class="difflineplus">+</span>
<a href="#l39.150"></a><span id="l39.150" class="difflineplus">+This is reversible, so any information in (a,b,c) before mix() is</span>
<a href="#l39.151"></a><span id="l39.151" class="difflineplus">+still in (a,b,c) after mix().</span>
<a href="#l39.152"></a><span id="l39.152" class="difflineplus">+</span>
<a href="#l39.153"></a><span id="l39.153" class="difflineplus">+If four pairs of (a,b,c) inputs are run through mix(), or through</span>
<a href="#l39.154"></a><span id="l39.154" class="difflineplus">+mix() in reverse, there are at least 32 bits of the output that</span>
<a href="#l39.155"></a><span id="l39.155" class="difflineplus">+are sometimes the same for one pair and different for another pair.</span>
<a href="#l39.156"></a><span id="l39.156" class="difflineplus">+This was tested for:</span>
<a href="#l39.157"></a><span id="l39.157" class="difflineplus">+* pairs that differed by one bit, by two bits, in any combination</span>
<a href="#l39.158"></a><span id="l39.158" class="difflineplus">+  of top bits of (a,b,c), or in any combination of bottom bits of</span>
<a href="#l39.159"></a><span id="l39.159" class="difflineplus">+  (a,b,c).</span>
<a href="#l39.160"></a><span id="l39.160" class="difflineplus">+* &quot;differ&quot; is defined as +, -, ^, or ~^.  For + and -, I transformed</span>
<a href="#l39.161"></a><span id="l39.161" class="difflineplus">+  the output delta to a Gray code (a^(a&gt;&gt;1)) so a string of 1's (as</span>
<a href="#l39.162"></a><span id="l39.162" class="difflineplus">+  is commonly produced by subtraction) look like a single 1-bit</span>
<a href="#l39.163"></a><span id="l39.163" class="difflineplus">+  difference.</span>
<a href="#l39.164"></a><span id="l39.164" class="difflineplus">+* the base values were pseudorandom, all zero but one bit set, or</span>
<a href="#l39.165"></a><span id="l39.165" class="difflineplus">+  all zero plus a counter that starts at zero.</span>
<a href="#l39.166"></a><span id="l39.166" class="difflineplus">+</span>
<a href="#l39.167"></a><span id="l39.167" class="difflineplus">+Some k values for my &quot;a-=c; a^=rot(c,k); c+=b;&quot; arrangement that</span>
<a href="#l39.168"></a><span id="l39.168" class="difflineplus">+satisfy this are</span>
<a href="#l39.169"></a><span id="l39.169" class="difflineplus">+    4  6  8 16 19  4</span>
<a href="#l39.170"></a><span id="l39.170" class="difflineplus">+    9 15  3 18 27 15</span>
<a href="#l39.171"></a><span id="l39.171" class="difflineplus">+   14  9  3  7 17  3</span>
<a href="#l39.172"></a><span id="l39.172" class="difflineplus">+Well, &quot;9 15 3 18 27 15&quot; didn't quite get 32 bits diffing</span>
<a href="#l39.173"></a><span id="l39.173" class="difflineplus">+for &quot;differ&quot; defined as + with a one-bit base and a two-bit delta.  I</span>
<a href="#l39.174"></a><span id="l39.174" class="difflineplus">+used http://burtleburtle.net/bob/hash/avalanche.html to choose</span>
<a href="#l39.175"></a><span id="l39.175" class="difflineplus">+the operations, constants, and arrangements of the variables.</span>
<a href="#l39.176"></a><span id="l39.176" class="difflineplus">+</span>
<a href="#l39.177"></a><span id="l39.177" class="difflineplus">+This does not achieve avalanche.  There are input bits of (a,b,c)</span>
<a href="#l39.178"></a><span id="l39.178" class="difflineplus">+that fail to affect some output bits of (a,b,c), especially of a.  The</span>
<a href="#l39.179"></a><span id="l39.179" class="difflineplus">+most thoroughly mixed value is c, but it doesn't really even achieve</span>
<a href="#l39.180"></a><span id="l39.180" class="difflineplus">+avalanche in c.</span>
<a href="#l39.181"></a><span id="l39.181" class="difflineplus">+</span>
<a href="#l39.182"></a><span id="l39.182" class="difflineplus">+This allows some parallelism.  Read-after-writes are good at doubling</span>
<a href="#l39.183"></a><span id="l39.183" class="difflineplus">+the number of bits affected, so the goal of mixing pulls in the opposite</span>
<a href="#l39.184"></a><span id="l39.184" class="difflineplus">+direction as the goal of parallelism.  I did what I could.  Rotates</span>
<a href="#l39.185"></a><span id="l39.185" class="difflineplus">+seem to cost as much as shifts on every machine I could lay my hands</span>
<a href="#l39.186"></a><span id="l39.186" class="difflineplus">+on, and rotates are much kinder to the top and bottom bits, so I used</span>
<a href="#l39.187"></a><span id="l39.187" class="difflineplus">+rotates.</span>
<a href="#l39.188"></a><span id="l39.188" class="difflineplus">+-------------------------------------------------------------------------------</span>
<a href="#l39.189"></a><span id="l39.189" class="difflineplus">+*/</span>
<a href="#l39.190"></a><span id="l39.190" class="difflineplus">+#define mix(a,b,c) \</span>
<a href="#l39.191"></a><span id="l39.191" class="difflineplus">+{ \</span>
<a href="#l39.192"></a><span id="l39.192" class="difflineplus">+  a -= c;  a ^= rot(c, 4);  c += b; \</span>
<a href="#l39.193"></a><span id="l39.193" class="difflineplus">+  b -= a;  b ^= rot(a, 6);  a += c; \</span>
<a href="#l39.194"></a><span id="l39.194" class="difflineplus">+  c -= b;  c ^= rot(b, 8);  b += a; \</span>
<a href="#l39.195"></a><span id="l39.195" class="difflineplus">+  a -= c;  a ^= rot(c,16);  c += b; \</span>
<a href="#l39.196"></a><span id="l39.196" class="difflineplus">+  b -= a;  b ^= rot(a,19);  a += c; \</span>
<a href="#l39.197"></a><span id="l39.197" class="difflineplus">+  c -= b;  c ^= rot(b, 4);  b += a; \</span>
<a href="#l39.198"></a><span id="l39.198" class="difflineplus">+}</span>
<a href="#l39.199"></a><span id="l39.199" class="difflineplus">+</span>
<a href="#l39.200"></a><span id="l39.200" class="difflineplus">+/*</span>
<a href="#l39.201"></a><span id="l39.201" class="difflineplus">+-------------------------------------------------------------------------------</span>
<a href="#l39.202"></a><span id="l39.202" class="difflineplus">+final -- final mixing of 3 32-bit values (a,b,c) into c</span>
<a href="#l39.203"></a><span id="l39.203" class="difflineplus">+</span>
<a href="#l39.204"></a><span id="l39.204" class="difflineplus">+Pairs of (a,b,c) values differing in only a few bits will usually</span>
<a href="#l39.205"></a><span id="l39.205" class="difflineplus">+produce values of c that look totally different.  This was tested for</span>
<a href="#l39.206"></a><span id="l39.206" class="difflineplus">+* pairs that differed by one bit, by two bits, in any combination</span>
<a href="#l39.207"></a><span id="l39.207" class="difflineplus">+  of top bits of (a,b,c), or in any combination of bottom bits of</span>
<a href="#l39.208"></a><span id="l39.208" class="difflineplus">+  (a,b,c).</span>
<a href="#l39.209"></a><span id="l39.209" class="difflineplus">+* &quot;differ&quot; is defined as +, -, ^, or ~^.  For + and -, I transformed</span>
<a href="#l39.210"></a><span id="l39.210" class="difflineplus">+  the output delta to a Gray code (a^(a&gt;&gt;1)) so a string of 1's (as</span>
<a href="#l39.211"></a><span id="l39.211" class="difflineplus">+  is commonly produced by subtraction) look like a single 1-bit</span>
<a href="#l39.212"></a><span id="l39.212" class="difflineplus">+  difference.</span>
<a href="#l39.213"></a><span id="l39.213" class="difflineplus">+* the base values were pseudorandom, all zero but one bit set, or</span>
<a href="#l39.214"></a><span id="l39.214" class="difflineplus">+  all zero plus a counter that starts at zero.</span>
<a href="#l39.215"></a><span id="l39.215" class="difflineplus">+</span>
<a href="#l39.216"></a><span id="l39.216" class="difflineplus">+These constants passed:</span>
<a href="#l39.217"></a><span id="l39.217" class="difflineplus">+ 14 11 25 16 4 14 24</span>
<a href="#l39.218"></a><span id="l39.218" class="difflineplus">+ 12 14 25 16 4 14 24</span>
<a href="#l39.219"></a><span id="l39.219" class="difflineplus">+and these came close:</span>
<a href="#l39.220"></a><span id="l39.220" class="difflineplus">+  4  8 15 26 3 22 24</span>
<a href="#l39.221"></a><span id="l39.221" class="difflineplus">+ 10  8 15 26 3 22 24</span>
<a href="#l39.222"></a><span id="l39.222" class="difflineplus">+ 11  8 15 26 3 22 24</span>
<a href="#l39.223"></a><span id="l39.223" class="difflineplus">+-------------------------------------------------------------------------------</span>
<a href="#l39.224"></a><span id="l39.224" class="difflineplus">+*/</span>
<a href="#l39.225"></a><span id="l39.225" class="difflineplus">+#define final(a,b,c) \</span>
<a href="#l39.226"></a><span id="l39.226" class="difflineplus">+{ \</span>
<a href="#l39.227"></a><span id="l39.227" class="difflineplus">+  c ^= b; c -= rot(b,14); \</span>
<a href="#l39.228"></a><span id="l39.228" class="difflineplus">+  a ^= c; a -= rot(c,11); \</span>
<a href="#l39.229"></a><span id="l39.229" class="difflineplus">+  b ^= a; b -= rot(a,25); \</span>
<a href="#l39.230"></a><span id="l39.230" class="difflineplus">+  c ^= b; c -= rot(b,16); \</span>
<a href="#l39.231"></a><span id="l39.231" class="difflineplus">+  a ^= c; a -= rot(c,4);  \</span>
<a href="#l39.232"></a><span id="l39.232" class="difflineplus">+  b ^= a; b -= rot(a,14); \</span>
<a href="#l39.233"></a><span id="l39.233" class="difflineplus">+  c ^= b; c -= rot(b,24); \</span>
<a href="#l39.234"></a><span id="l39.234" class="difflineplus">+}</span>
<a href="#l39.235"></a><span id="l39.235" class="difflineplus">+</span>
<a href="#l39.236"></a><span id="l39.236" class="difflineplus">+</span>
<a href="#l39.237"></a><span id="l39.237" class="difflineplus">+/*</span>
<a href="#l39.238"></a><span id="l39.238" class="difflineplus">+-------------------------------------------------------------------------------</span>
<a href="#l39.239"></a><span id="l39.239" class="difflineplus">+hashlittle() -- hash a variable-length key into a 32-bit value</span>
<a href="#l39.240"></a><span id="l39.240" class="difflineplus">+  k       : the key (the unaligned variable-length array of bytes)</span>
<a href="#l39.241"></a><span id="l39.241" class="difflineplus">+  length  : the length of the key, counting by bytes</span>
<a href="#l39.242"></a><span id="l39.242" class="difflineplus">+  initval : can be any 4-byte value</span>
<a href="#l39.243"></a><span id="l39.243" class="difflineplus">+Returns a 32-bit value.  Every bit of the key affects every bit of</span>
<a href="#l39.244"></a><span id="l39.244" class="difflineplus">+the return value.  Two keys differing by one or two bits will have</span>
<a href="#l39.245"></a><span id="l39.245" class="difflineplus">+totally different hash values.</span>
<a href="#l39.246"></a><span id="l39.246" class="difflineplus">+</span>
<a href="#l39.247"></a><span id="l39.247" class="difflineplus">+The best hash table sizes are powers of 2.  There is no need to do</span>
<a href="#l39.248"></a><span id="l39.248" class="difflineplus">+mod a prime (mod is sooo slow!).  If you need less than 32 bits,</span>
<a href="#l39.249"></a><span id="l39.249" class="difflineplus">+use a bitmask.  For example, if you need only 10 bits, do</span>
<a href="#l39.250"></a><span id="l39.250" class="difflineplus">+  h = (h &amp; hashmask(10));</span>
<a href="#l39.251"></a><span id="l39.251" class="difflineplus">+In which case, the hash table should have hashsize(10) elements.</span>
<a href="#l39.252"></a><span id="l39.252" class="difflineplus">+</span>
<a href="#l39.253"></a><span id="l39.253" class="difflineplus">+If you are hashing n strings (uint8_t **)k, do it like this:</span>
<a href="#l39.254"></a><span id="l39.254" class="difflineplus">+  for (i=0, h=0; i&lt;n; ++i) h = hashlittle( k[i], len[i], h);</span>
<a href="#l39.255"></a><span id="l39.255" class="difflineplus">+</span>
<a href="#l39.256"></a><span id="l39.256" class="difflineplus">+By Bob Jenkins, 2006.  bob_jenkins@burtleburtle.net.  You may use this</span>
<a href="#l39.257"></a><span id="l39.257" class="difflineplus">+code any way you wish, private, educational, or commercial.  It's free.</span>
<a href="#l39.258"></a><span id="l39.258" class="difflineplus">+</span>
<a href="#l39.259"></a><span id="l39.259" class="difflineplus">+Use for hash table lookup, or anything where one collision in 2^^32 is</span>
<a href="#l39.260"></a><span id="l39.260" class="difflineplus">+acceptable.  Do NOT use for cryptographic purposes.</span>
<a href="#l39.261"></a><span id="l39.261" class="difflineplus">+-------------------------------------------------------------------------------</span>
<a href="#l39.262"></a><span id="l39.262" class="difflineplus">+*/</span>
<a href="#l39.263"></a><span id="l39.263" class="difflineplus">+</span>
<a href="#l39.264"></a><span id="l39.264" class="difflineplus">+static uint32_t hashlittle( const void *key, size_t length, uint32_t initval)</span>
<a href="#l39.265"></a><span id="l39.265" class="difflineplus">+{</span>
<a href="#l39.266"></a><span id="l39.266" class="difflineplus">+  uint32_t a,b,c;                                          /* internal state */</span>
<a href="#l39.267"></a><span id="l39.267" class="difflineplus">+  union { const void *ptr; size_t i; } u;     /* needed for Mac Powerbook G4 */</span>
<a href="#l39.268"></a><span id="l39.268" class="difflineplus">+</span>
<a href="#l39.269"></a><span id="l39.269" class="difflineplus">+  /* Set up the internal state */</span>
<a href="#l39.270"></a><span id="l39.270" class="difflineplus">+  a = b = c = 0xdeadbeef + ((uint32_t)length) + initval;</span>
<a href="#l39.271"></a><span id="l39.271" class="difflineplus">+</span>
<a href="#l39.272"></a><span id="l39.272" class="difflineplus">+  u.ptr = key;</span>
<a href="#l39.273"></a><span id="l39.273" class="difflineplus">+  if (HASH_LITTLE_ENDIAN &amp;&amp; ((u.i &amp; 0x3) == 0)) {</span>
<a href="#l39.274"></a><span id="l39.274" class="difflineplus">+    const uint32_t *k = (const uint32_t *)key;         /* read 32-bit chunks */</span>
<a href="#l39.275"></a><span id="l39.275" class="difflineplus">+</span>
<a href="#l39.276"></a><span id="l39.276" class="difflineplus">+    /*------ all but last block: aligned reads and affect 32 bits of (a,b,c) */</span>
<a href="#l39.277"></a><span id="l39.277" class="difflineplus">+    while (length &gt; 12)</span>
<a href="#l39.278"></a><span id="l39.278" class="difflineplus">+    {</span>
<a href="#l39.279"></a><span id="l39.279" class="difflineplus">+      a += k[0];</span>
<a href="#l39.280"></a><span id="l39.280" class="difflineplus">+      b += k[1];</span>
<a href="#l39.281"></a><span id="l39.281" class="difflineplus">+      c += k[2];</span>
<a href="#l39.282"></a><span id="l39.282" class="difflineplus">+      mix(a,b,c);</span>
<a href="#l39.283"></a><span id="l39.283" class="difflineplus">+      length -= 12;</span>
<a href="#l39.284"></a><span id="l39.284" class="difflineplus">+      k += 3;</span>
<a href="#l39.285"></a><span id="l39.285" class="difflineplus">+    }</span>
<a href="#l39.286"></a><span id="l39.286" class="difflineplus">+</span>
<a href="#l39.287"></a><span id="l39.287" class="difflineplus">+    /*----------------------------- handle the last (probably partial) block */</span>
<a href="#l39.288"></a><span id="l39.288" class="difflineplus">+    /*</span>
<a href="#l39.289"></a><span id="l39.289" class="difflineplus">+     * &quot;k[2]&amp;0xffffff&quot; actually reads beyond the end of the string, but</span>
<a href="#l39.290"></a><span id="l39.290" class="difflineplus">+     * then masks off the part it's not allowed to read.  Because the</span>
<a href="#l39.291"></a><span id="l39.291" class="difflineplus">+     * string is aligned, the masked-off tail is in the same word as the</span>
<a href="#l39.292"></a><span id="l39.292" class="difflineplus">+     * rest of the string.  Every machine with memory protection I've seen</span>
<a href="#l39.293"></a><span id="l39.293" class="difflineplus">+     * does it on word boundaries, so is OK with this.  But VALGRIND will</span>
<a href="#l39.294"></a><span id="l39.294" class="difflineplus">+     * still catch it and complain.  The masking trick does make the hash</span>
<a href="#l39.295"></a><span id="l39.295" class="difflineplus">+     * noticably faster for short strings (like English words).</span>
<a href="#l39.296"></a><span id="l39.296" class="difflineplus">+     * AddressSanitizer is similarly picky about overrunning</span>
<a href="#l39.297"></a><span id="l39.297" class="difflineplus">+	 * the buffer. (http://clang.llvm.org/docs/AddressSanitizer.html</span>
<a href="#l39.298"></a><span id="l39.298" class="difflineplus">+     */</span>
<a href="#l39.299"></a><span id="l39.299" class="difflineplus">+#ifdef VALGRIND</span>
<a href="#l39.300"></a><span id="l39.300" class="difflineplus">+#    define PRECISE_MEMORY_ACCESS 1</span>
<a href="#l39.301"></a><span id="l39.301" class="difflineplus">+#elif defined(__SANITIZE_ADDRESS__) /* GCC's ASAN */</span>
<a href="#l39.302"></a><span id="l39.302" class="difflineplus">+#    define PRECISE_MEMORY_ACCESS 1</span>
<a href="#l39.303"></a><span id="l39.303" class="difflineplus">+#elif defined(__has_feature)</span>
<a href="#l39.304"></a><span id="l39.304" class="difflineplus">+#  if __has_feature(address_sanitizer) /* Clang's ASAN */</span>
<a href="#l39.305"></a><span id="l39.305" class="difflineplus">+#    define PRECISE_MEMORY_ACCESS 1</span>
<a href="#l39.306"></a><span id="l39.306" class="difflineplus">+#  endif</span>
<a href="#l39.307"></a><span id="l39.307" class="difflineplus">+#endif</span>
<a href="#l39.308"></a><span id="l39.308" class="difflineplus">+#ifndef PRECISE_MEMORY_ACCESS</span>
<a href="#l39.309"></a><span id="l39.309" class="difflineplus">+</span>
<a href="#l39.310"></a><span id="l39.310" class="difflineplus">+    switch(length)</span>
<a href="#l39.311"></a><span id="l39.311" class="difflineplus">+    {</span>
<a href="#l39.312"></a><span id="l39.312" class="difflineplus">+    case 12: c+=k[2]; b+=k[1]; a+=k[0]; break;</span>
<a href="#l39.313"></a><span id="l39.313" class="difflineplus">+    case 11: c+=k[2]&amp;0xffffff; b+=k[1]; a+=k[0]; break;</span>
<a href="#l39.314"></a><span id="l39.314" class="difflineplus">+    case 10: c+=k[2]&amp;0xffff; b+=k[1]; a+=k[0]; break;</span>
<a href="#l39.315"></a><span id="l39.315" class="difflineplus">+    case 9 : c+=k[2]&amp;0xff; b+=k[1]; a+=k[0]; break;</span>
<a href="#l39.316"></a><span id="l39.316" class="difflineplus">+    case 8 : b+=k[1]; a+=k[0]; break;</span>
<a href="#l39.317"></a><span id="l39.317" class="difflineplus">+    case 7 : b+=k[1]&amp;0xffffff; a+=k[0]; break;</span>
<a href="#l39.318"></a><span id="l39.318" class="difflineplus">+    case 6 : b+=k[1]&amp;0xffff; a+=k[0]; break;</span>
<a href="#l39.319"></a><span id="l39.319" class="difflineplus">+    case 5 : b+=k[1]&amp;0xff; a+=k[0]; break;</span>
<a href="#l39.320"></a><span id="l39.320" class="difflineplus">+    case 4 : a+=k[0]; break;</span>
<a href="#l39.321"></a><span id="l39.321" class="difflineplus">+    case 3 : a+=k[0]&amp;0xffffff; break;</span>
<a href="#l39.322"></a><span id="l39.322" class="difflineplus">+    case 2 : a+=k[0]&amp;0xffff; break;</span>
<a href="#l39.323"></a><span id="l39.323" class="difflineplus">+    case 1 : a+=k[0]&amp;0xff; break;</span>
<a href="#l39.324"></a><span id="l39.324" class="difflineplus">+    case 0 : return c;              /* zero length strings require no mixing */</span>
<a href="#l39.325"></a><span id="l39.325" class="difflineplus">+    }</span>
<a href="#l39.326"></a><span id="l39.326" class="difflineplus">+</span>
<a href="#l39.327"></a><span id="l39.327" class="difflineplus">+#else /* make valgrind happy */</span>
<a href="#l39.328"></a><span id="l39.328" class="difflineplus">+</span>
<a href="#l39.329"></a><span id="l39.329" class="difflineplus">+    const uint8_t  *k8 = (const uint8_t *)k;</span>
<a href="#l39.330"></a><span id="l39.330" class="difflineplus">+    switch(length)</span>
<a href="#l39.331"></a><span id="l39.331" class="difflineplus">+    {</span>
<a href="#l39.332"></a><span id="l39.332" class="difflineplus">+    case 12: c+=k[2]; b+=k[1]; a+=k[0]; break;</span>
<a href="#l39.333"></a><span id="l39.333" class="difflineplus">+    case 11: c+=((uint32_t)k8[10])&lt;&lt;16;  /* fall through */</span>
<a href="#l39.334"></a><span id="l39.334" class="difflineplus">+    case 10: c+=((uint32_t)k8[9])&lt;&lt;8;    /* fall through */</span>
<a href="#l39.335"></a><span id="l39.335" class="difflineplus">+    case 9 : c+=k8[8];                   /* fall through */</span>
<a href="#l39.336"></a><span id="l39.336" class="difflineplus">+    case 8 : b+=k[1]; a+=k[0]; break;</span>
<a href="#l39.337"></a><span id="l39.337" class="difflineplus">+    case 7 : b+=((uint32_t)k8[6])&lt;&lt;16;   /* fall through */</span>
<a href="#l39.338"></a><span id="l39.338" class="difflineplus">+    case 6 : b+=((uint32_t)k8[5])&lt;&lt;8;    /* fall through */</span>
<a href="#l39.339"></a><span id="l39.339" class="difflineplus">+    case 5 : b+=k8[4];                   /* fall through */</span>
<a href="#l39.340"></a><span id="l39.340" class="difflineplus">+    case 4 : a+=k[0]; break;</span>
<a href="#l39.341"></a><span id="l39.341" class="difflineplus">+    case 3 : a+=((uint32_t)k8[2])&lt;&lt;16;   /* fall through */</span>
<a href="#l39.342"></a><span id="l39.342" class="difflineplus">+    case 2 : a+=((uint32_t)k8[1])&lt;&lt;8;    /* fall through */</span>
<a href="#l39.343"></a><span id="l39.343" class="difflineplus">+    case 1 : a+=k8[0]; break;</span>
<a href="#l39.344"></a><span id="l39.344" class="difflineplus">+    case 0 : return c;</span>
<a href="#l39.345"></a><span id="l39.345" class="difflineplus">+    }</span>
<a href="#l39.346"></a><span id="l39.346" class="difflineplus">+</span>
<a href="#l39.347"></a><span id="l39.347" class="difflineplus">+#endif /* !valgrind */</span>
<a href="#l39.348"></a><span id="l39.348" class="difflineplus">+</span>
<a href="#l39.349"></a><span id="l39.349" class="difflineplus">+  } else if (HASH_LITTLE_ENDIAN &amp;&amp; ((u.i &amp; 0x1) == 0)) {</span>
<a href="#l39.350"></a><span id="l39.350" class="difflineplus">+    const uint16_t *k = (const uint16_t *)key;         /* read 16-bit chunks */</span>
<a href="#l39.351"></a><span id="l39.351" class="difflineplus">+    const uint8_t  *k8;</span>
<a href="#l39.352"></a><span id="l39.352" class="difflineplus">+</span>
<a href="#l39.353"></a><span id="l39.353" class="difflineplus">+    /*--------------- all but last block: aligned reads and different mixing */</span>
<a href="#l39.354"></a><span id="l39.354" class="difflineplus">+    while (length &gt; 12)</span>
<a href="#l39.355"></a><span id="l39.355" class="difflineplus">+    {</span>
<a href="#l39.356"></a><span id="l39.356" class="difflineplus">+      a += k[0] + (((uint32_t)k[1])&lt;&lt;16);</span>
<a href="#l39.357"></a><span id="l39.357" class="difflineplus">+      b += k[2] + (((uint32_t)k[3])&lt;&lt;16);</span>
<a href="#l39.358"></a><span id="l39.358" class="difflineplus">+      c += k[4] + (((uint32_t)k[5])&lt;&lt;16);</span>
<a href="#l39.359"></a><span id="l39.359" class="difflineplus">+      mix(a,b,c);</span>
<a href="#l39.360"></a><span id="l39.360" class="difflineplus">+      length -= 12;</span>
<a href="#l39.361"></a><span id="l39.361" class="difflineplus">+      k += 6;</span>
<a href="#l39.362"></a><span id="l39.362" class="difflineplus">+    }</span>
<a href="#l39.363"></a><span id="l39.363" class="difflineplus">+</span>
<a href="#l39.364"></a><span id="l39.364" class="difflineplus">+    /*----------------------------- handle the last (probably partial) block */</span>
<a href="#l39.365"></a><span id="l39.365" class="difflineplus">+    k8 = (const uint8_t *)k;</span>
<a href="#l39.366"></a><span id="l39.366" class="difflineplus">+    switch(length)</span>
<a href="#l39.367"></a><span id="l39.367" class="difflineplus">+    {</span>
<a href="#l39.368"></a><span id="l39.368" class="difflineplus">+    case 12: c+=k[4]+(((uint32_t)k[5])&lt;&lt;16);</span>
<a href="#l39.369"></a><span id="l39.369" class="difflineplus">+             b+=k[2]+(((uint32_t)k[3])&lt;&lt;16);</span>
<a href="#l39.370"></a><span id="l39.370" class="difflineplus">+             a+=k[0]+(((uint32_t)k[1])&lt;&lt;16);</span>
<a href="#l39.371"></a><span id="l39.371" class="difflineplus">+             break;</span>
<a href="#l39.372"></a><span id="l39.372" class="difflineplus">+    case 11: c+=((uint32_t)k8[10])&lt;&lt;16;     /* fall through */</span>
<a href="#l39.373"></a><span id="l39.373" class="difflineplus">+    case 10: c+=k[4];</span>
<a href="#l39.374"></a><span id="l39.374" class="difflineplus">+             b+=k[2]+(((uint32_t)k[3])&lt;&lt;16);</span>
<a href="#l39.375"></a><span id="l39.375" class="difflineplus">+             a+=k[0]+(((uint32_t)k[1])&lt;&lt;16);</span>
<a href="#l39.376"></a><span id="l39.376" class="difflineplus">+             break;</span>
<a href="#l39.377"></a><span id="l39.377" class="difflineplus">+    case 9 : c+=k8[8];                      /* fall through */</span>
<a href="#l39.378"></a><span id="l39.378" class="difflineplus">+    case 8 : b+=k[2]+(((uint32_t)k[3])&lt;&lt;16);</span>
<a href="#l39.379"></a><span id="l39.379" class="difflineplus">+             a+=k[0]+(((uint32_t)k[1])&lt;&lt;16);</span>
<a href="#l39.380"></a><span id="l39.380" class="difflineplus">+             break;</span>
<a href="#l39.381"></a><span id="l39.381" class="difflineplus">+    case 7 : b+=((uint32_t)k8[6])&lt;&lt;16;      /* fall through */</span>
<a href="#l39.382"></a><span id="l39.382" class="difflineplus">+    case 6 : b+=k[2];</span>
<a href="#l39.383"></a><span id="l39.383" class="difflineplus">+             a+=k[0]+(((uint32_t)k[1])&lt;&lt;16);</span>
<a href="#l39.384"></a><span id="l39.384" class="difflineplus">+             break;</span>
<a href="#l39.385"></a><span id="l39.385" class="difflineplus">+    case 5 : b+=k8[4];                      /* fall through */</span>
<a href="#l39.386"></a><span id="l39.386" class="difflineplus">+    case 4 : a+=k[0]+(((uint32_t)k[1])&lt;&lt;16);</span>
<a href="#l39.387"></a><span id="l39.387" class="difflineplus">+             break;</span>
<a href="#l39.388"></a><span id="l39.388" class="difflineplus">+    case 3 : a+=((uint32_t)k8[2])&lt;&lt;16;      /* fall through */</span>
<a href="#l39.389"></a><span id="l39.389" class="difflineplus">+    case 2 : a+=k[0];</span>
<a href="#l39.390"></a><span id="l39.390" class="difflineplus">+             break;</span>
<a href="#l39.391"></a><span id="l39.391" class="difflineplus">+    case 1 : a+=k8[0];</span>
<a href="#l39.392"></a><span id="l39.392" class="difflineplus">+             break;</span>
<a href="#l39.393"></a><span id="l39.393" class="difflineplus">+    case 0 : return c;                     /* zero length requires no mixing */</span>
<a href="#l39.394"></a><span id="l39.394" class="difflineplus">+    }</span>
<a href="#l39.395"></a><span id="l39.395" class="difflineplus">+</span>
<a href="#l39.396"></a><span id="l39.396" class="difflineplus">+  } else {                        /* need to read the key one byte at a time */</span>
<a href="#l39.397"></a><span id="l39.397" class="difflineplus">+    const uint8_t *k = (const uint8_t *)key;</span>
<a href="#l39.398"></a><span id="l39.398" class="difflineplus">+</span>
<a href="#l39.399"></a><span id="l39.399" class="difflineplus">+    /*--------------- all but the last block: affect some 32 bits of (a,b,c) */</span>
<a href="#l39.400"></a><span id="l39.400" class="difflineplus">+    while (length &gt; 12)</span>
<a href="#l39.401"></a><span id="l39.401" class="difflineplus">+    {</span>
<a href="#l39.402"></a><span id="l39.402" class="difflineplus">+      a += k[0];</span>
<a href="#l39.403"></a><span id="l39.403" class="difflineplus">+      a += ((uint32_t)k[1])&lt;&lt;8;</span>
<a href="#l39.404"></a><span id="l39.404" class="difflineplus">+      a += ((uint32_t)k[2])&lt;&lt;16;</span>
<a href="#l39.405"></a><span id="l39.405" class="difflineplus">+      a += ((uint32_t)k[3])&lt;&lt;24;</span>
<a href="#l39.406"></a><span id="l39.406" class="difflineplus">+      b += k[4];</span>
<a href="#l39.407"></a><span id="l39.407" class="difflineplus">+      b += ((uint32_t)k[5])&lt;&lt;8;</span>
<a href="#l39.408"></a><span id="l39.408" class="difflineplus">+      b += ((uint32_t)k[6])&lt;&lt;16;</span>
<a href="#l39.409"></a><span id="l39.409" class="difflineplus">+      b += ((uint32_t)k[7])&lt;&lt;24;</span>
<a href="#l39.410"></a><span id="l39.410" class="difflineplus">+      c += k[8];</span>
<a href="#l39.411"></a><span id="l39.411" class="difflineplus">+      c += ((uint32_t)k[9])&lt;&lt;8;</span>
<a href="#l39.412"></a><span id="l39.412" class="difflineplus">+      c += ((uint32_t)k[10])&lt;&lt;16;</span>
<a href="#l39.413"></a><span id="l39.413" class="difflineplus">+      c += ((uint32_t)k[11])&lt;&lt;24;</span>
<a href="#l39.414"></a><span id="l39.414" class="difflineplus">+      mix(a,b,c);</span>
<a href="#l39.415"></a><span id="l39.415" class="difflineplus">+      length -= 12;</span>
<a href="#l39.416"></a><span id="l39.416" class="difflineplus">+      k += 12;</span>
<a href="#l39.417"></a><span id="l39.417" class="difflineplus">+    }</span>
<a href="#l39.418"></a><span id="l39.418" class="difflineplus">+</span>
<a href="#l39.419"></a><span id="l39.419" class="difflineplus">+    /*-------------------------------- last block: affect all 32 bits of (c) */</span>
<a href="#l39.420"></a><span id="l39.420" class="difflineplus">+    switch(length)                   /* all the case statements fall through */</span>
<a href="#l39.421"></a><span id="l39.421" class="difflineplus">+    {</span>
<a href="#l39.422"></a><span id="l39.422" class="difflineplus">+    case 12: c+=((uint32_t)k[11])&lt;&lt;24; /* FALLTHRU */</span>
<a href="#l39.423"></a><span id="l39.423" class="difflineplus">+    case 11: c+=((uint32_t)k[10])&lt;&lt;16; /* FALLTHRU */</span>
<a href="#l39.424"></a><span id="l39.424" class="difflineplus">+    case 10: c+=((uint32_t)k[9])&lt;&lt;8; /* FALLTHRU */</span>
<a href="#l39.425"></a><span id="l39.425" class="difflineplus">+    case 9 : c+=k[8]; /* FALLTHRU */</span>
<a href="#l39.426"></a><span id="l39.426" class="difflineplus">+    case 8 : b+=((uint32_t)k[7])&lt;&lt;24; /* FALLTHRU */</span>
<a href="#l39.427"></a><span id="l39.427" class="difflineplus">+    case 7 : b+=((uint32_t)k[6])&lt;&lt;16; /* FALLTHRU */</span>
<a href="#l39.428"></a><span id="l39.428" class="difflineplus">+    case 6 : b+=((uint32_t)k[5])&lt;&lt;8; /* FALLTHRU */</span>
<a href="#l39.429"></a><span id="l39.429" class="difflineplus">+    case 5 : b+=k[4]; /* FALLTHRU */</span>
<a href="#l39.430"></a><span id="l39.430" class="difflineplus">+    case 4 : a+=((uint32_t)k[3])&lt;&lt;24; /* FALLTHRU */</span>
<a href="#l39.431"></a><span id="l39.431" class="difflineplus">+    case 3 : a+=((uint32_t)k[2])&lt;&lt;16; /* FALLTHRU */</span>
<a href="#l39.432"></a><span id="l39.432" class="difflineplus">+    case 2 : a+=((uint32_t)k[1])&lt;&lt;8; /* FALLTHRU */</span>
<a href="#l39.433"></a><span id="l39.433" class="difflineplus">+    case 1 : a+=k[0];</span>
<a href="#l39.434"></a><span id="l39.434" class="difflineplus">+             break;</span>
<a href="#l39.435"></a><span id="l39.435" class="difflineplus">+    case 0 : return c;</span>
<a href="#l39.436"></a><span id="l39.436" class="difflineplus">+    }</span>
<a href="#l39.437"></a><span id="l39.437" class="difflineplus">+  }</span>
<a href="#l39.438"></a><span id="l39.438" class="difflineplus">+</span>
<a href="#l39.439"></a><span id="l39.439" class="difflineplus">+  final(a,b,c);</span>
<a href="#l39.440"></a><span id="l39.440" class="difflineplus">+  return c;</span>
<a href="#l39.441"></a><span id="l39.441" class="difflineplus">+}</span>
<a href="#l39.442"></a><span id="l39.442" class="difflineplus">+</span>
<a href="#l39.443"></a><span id="l39.443" class="difflineplus">+/* a simple hash function similiar to what perl does for strings.</span>
<a href="#l39.444"></a><span id="l39.444" class="difflineplus">+ * for good results, the string should not be excessivly large.</span>
<a href="#l39.445"></a><span id="l39.445" class="difflineplus">+ */</span>
<a href="#l39.446"></a><span id="l39.446" class="difflineplus">+static unsigned long lh_perllike_str_hash(const void *k) </span>
<a href="#l39.447"></a><span id="l39.447" class="difflineplus">+{</span>
<a href="#l39.448"></a><span id="l39.448" class="difflineplus">+    const char *rkey = (const char *)k;</span>
<a href="#l39.449"></a><span id="l39.449" class="difflineplus">+    unsigned hashval = 1;</span>
<a href="#l39.450"></a><span id="l39.450" class="difflineplus">+</span>
<a href="#l39.451"></a><span id="l39.451" class="difflineplus">+    while (*rkey)</span>
<a href="#l39.452"></a><span id="l39.452" class="difflineplus">+        hashval = hashval * 33 + *rkey++;</span>
<a href="#l39.453"></a><span id="l39.453" class="difflineplus">+</span>
<a href="#l39.454"></a><span id="l39.454" class="difflineplus">+    return hashval;</span>
<a href="#l39.455"></a><span id="l39.455" class="difflineplus">+}</span>
<a href="#l39.456"></a><span id="l39.456" class="difflineplus">+</span>
<a href="#l39.457"></a><span id="l39.457" class="difflineplus">+static unsigned long lh_char_hash(const void *k)</span>
<a href="#l39.458"></a><span id="l39.458" class="difflineplus">+{</span>
<a href="#l39.459"></a><span id="l39.459" class="difflineplus">+#if defined _MSC_VER || defined __MINGW32__</span>
<a href="#l39.460"></a><span id="l39.460" class="difflineplus">+#define RANDOM_SEED_TYPE LONG</span>
<a href="#l39.461"></a><span id="l39.461" class="difflineplus">+#else</span>
<a href="#l39.462"></a><span id="l39.462" class="difflineplus">+#define RANDOM_SEED_TYPE int</span>
<a href="#l39.463"></a><span id="l39.463" class="difflineplus">+#endif</span>
<a href="#l39.464"></a><span id="l39.464" class="difflineplus">+	static volatile RANDOM_SEED_TYPE random_seed = -1;</span>
<a href="#l39.465"></a><span id="l39.465" class="difflineplus">+</span>
<a href="#l39.466"></a><span id="l39.466" class="difflineplus">+	if (random_seed == -1) {</span>
<a href="#l39.467"></a><span id="l39.467" class="difflineplus">+		RANDOM_SEED_TYPE seed;</span>
<a href="#l39.468"></a><span id="l39.468" class="difflineplus">+		/* we can't use -1 as it is the unitialized sentinel */</span>
<a href="#l39.469"></a><span id="l39.469" class="difflineplus">+		while ((seed = json_c_get_random_seed()) == -1);</span>
<a href="#l39.470"></a><span id="l39.470" class="difflineplus">+#if SIZEOF_INT == 8 &amp;&amp; defined __GCC_HAVE_SYNC_COMPARE_AND_SWAP_8</span>
<a href="#l39.471"></a><span id="l39.471" class="difflineplus">+#define USE_SYNC_COMPARE_AND_SWAP 1</span>
<a href="#l39.472"></a><span id="l39.472" class="difflineplus">+#endif</span>
<a href="#l39.473"></a><span id="l39.473" class="difflineplus">+#if SIZEOF_INT == 4 &amp;&amp; defined __GCC_HAVE_SYNC_COMPARE_AND_SWAP_4</span>
<a href="#l39.474"></a><span id="l39.474" class="difflineplus">+#define USE_SYNC_COMPARE_AND_SWAP 1</span>
<a href="#l39.475"></a><span id="l39.475" class="difflineplus">+#endif</span>
<a href="#l39.476"></a><span id="l39.476" class="difflineplus">+#if SIZEOF_INT == 2 &amp;&amp; defined __GCC_HAVE_SYNC_COMPARE_AND_SWAP_2</span>
<a href="#l39.477"></a><span id="l39.477" class="difflineplus">+#define USE_SYNC_COMPARE_AND_SWAP 1</span>
<a href="#l39.478"></a><span id="l39.478" class="difflineplus">+#endif</span>
<a href="#l39.479"></a><span id="l39.479" class="difflineplus">+#if defined USE_SYNC_COMPARE_AND_SWAP</span>
<a href="#l39.480"></a><span id="l39.480" class="difflineplus">+		(void)__sync_val_compare_and_swap(&amp;random_seed, -1, seed);</span>
<a href="#l39.481"></a><span id="l39.481" class="difflineplus">+#elif defined _MSC_VER || defined __MINGW32__</span>
<a href="#l39.482"></a><span id="l39.482" class="difflineplus">+		InterlockedCompareExchange(&amp;random_seed, seed, -1);</span>
<a href="#l39.483"></a><span id="l39.483" class="difflineplus">+#else</span>
<a href="#l39.484"></a><span id="l39.484" class="difflineplus">+//#warning &quot;racy random seed initializtion if used by multiple threads&quot;</span>
<a href="#l39.485"></a><span id="l39.485" class="difflineplus">+		random_seed = seed; /* potentially racy */</span>
<a href="#l39.486"></a><span id="l39.486" class="difflineplus">+#endif</span>
<a href="#l39.487"></a><span id="l39.487" class="difflineplus">+	}</span>
<a href="#l39.488"></a><span id="l39.488" class="difflineplus">+</span>
<a href="#l39.489"></a><span id="l39.489" class="difflineplus">+	return hashlittle((const char*)k, strlen((const char*)k), random_seed);</span>
<a href="#l39.490"></a><span id="l39.490" class="difflineplus">+}</span>
<a href="#l39.491"></a><span id="l39.491" class="difflineplus">+</span>
<a href="#l39.492"></a><span id="l39.492" class="difflineplus">+int lh_char_equal(const void *k1, const void *k2)</span>
<a href="#l39.493"></a><span id="l39.493" class="difflineplus">+{</span>
<a href="#l39.494"></a><span id="l39.494" class="difflineplus">+	return (strcmp((const char*)k1, (const char*)k2) == 0);</span>
<a href="#l39.495"></a><span id="l39.495" class="difflineplus">+}</span>
<a href="#l39.496"></a><span id="l39.496" class="difflineplus">+</span>
<a href="#l39.497"></a><span id="l39.497" class="difflineplus">+struct lh_table* lh_table_new(int size,</span>
<a href="#l39.498"></a><span id="l39.498" class="difflineplus">+			      lh_entry_free_fn *free_fn,</span>
<a href="#l39.499"></a><span id="l39.499" class="difflineplus">+			      lh_hash_fn *hash_fn,</span>
<a href="#l39.500"></a><span id="l39.500" class="difflineplus">+			      lh_equal_fn *equal_fn)</span>
<a href="#l39.501"></a><span id="l39.501" class="difflineplus">+{</span>
<a href="#l39.502"></a><span id="l39.502" class="difflineplus">+	int i;</span>
<a href="#l39.503"></a><span id="l39.503" class="difflineplus">+	struct lh_table *t;</span>
<a href="#l39.504"></a><span id="l39.504" class="difflineplus">+</span>
<a href="#l39.505"></a><span id="l39.505" class="difflineplus">+	t = (struct lh_table*)calloc(1, sizeof(struct lh_table));</span>
<a href="#l39.506"></a><span id="l39.506" class="difflineplus">+	if (!t)</span>
<a href="#l39.507"></a><span id="l39.507" class="difflineplus">+		return NULL;</span>
<a href="#l39.508"></a><span id="l39.508" class="difflineplus">+</span>
<a href="#l39.509"></a><span id="l39.509" class="difflineplus">+	t-&gt;count = 0;</span>
<a href="#l39.510"></a><span id="l39.510" class="difflineplus">+	t-&gt;size = size;</span>
<a href="#l39.511"></a><span id="l39.511" class="difflineplus">+	t-&gt;table = (struct lh_entry*)calloc(size, sizeof(struct lh_entry));</span>
<a href="#l39.512"></a><span id="l39.512" class="difflineplus">+	if (!t-&gt;table)</span>
<a href="#l39.513"></a><span id="l39.513" class="difflineplus">+	{</span>
<a href="#l39.514"></a><span id="l39.514" class="difflineplus">+		free(t);</span>
<a href="#l39.515"></a><span id="l39.515" class="difflineplus">+		return NULL;</span>
<a href="#l39.516"></a><span id="l39.516" class="difflineplus">+	}</span>
<a href="#l39.517"></a><span id="l39.517" class="difflineplus">+	t-&gt;free_fn = free_fn;</span>
<a href="#l39.518"></a><span id="l39.518" class="difflineplus">+	t-&gt;hash_fn = hash_fn;</span>
<a href="#l39.519"></a><span id="l39.519" class="difflineplus">+	t-&gt;equal_fn = equal_fn;</span>
<a href="#l39.520"></a><span id="l39.520" class="difflineplus">+	for(i = 0; i &lt; size; i++) t-&gt;table[i].k = LH_EMPTY;</span>
<a href="#l39.521"></a><span id="l39.521" class="difflineplus">+	return t;</span>
<a href="#l39.522"></a><span id="l39.522" class="difflineplus">+}</span>
<a href="#l39.523"></a><span id="l39.523" class="difflineplus">+</span>
<a href="#l39.524"></a><span id="l39.524" class="difflineplus">+struct lh_table* lh_kchar_table_new(int size,</span>
<a href="#l39.525"></a><span id="l39.525" class="difflineplus">+				    lh_entry_free_fn *free_fn)</span>
<a href="#l39.526"></a><span id="l39.526" class="difflineplus">+{</span>
<a href="#l39.527"></a><span id="l39.527" class="difflineplus">+	return lh_table_new(size, free_fn, char_hash_fn, lh_char_equal);</span>
<a href="#l39.528"></a><span id="l39.528" class="difflineplus">+}</span>
<a href="#l39.529"></a><span id="l39.529" class="difflineplus">+</span>
<a href="#l39.530"></a><span id="l39.530" class="difflineplus">+struct lh_table* lh_kptr_table_new(int size,</span>
<a href="#l39.531"></a><span id="l39.531" class="difflineplus">+				   lh_entry_free_fn *free_fn)</span>
<a href="#l39.532"></a><span id="l39.532" class="difflineplus">+{</span>
<a href="#l39.533"></a><span id="l39.533" class="difflineplus">+	return lh_table_new(size, free_fn, lh_ptr_hash, lh_ptr_equal);</span>
<a href="#l39.534"></a><span id="l39.534" class="difflineplus">+}</span>
<a href="#l39.535"></a><span id="l39.535" class="difflineplus">+</span>
<a href="#l39.536"></a><span id="l39.536" class="difflineplus">+int lh_table_resize(struct lh_table *t, int new_size)</span>
<a href="#l39.537"></a><span id="l39.537" class="difflineplus">+{</span>
<a href="#l39.538"></a><span id="l39.538" class="difflineplus">+	struct lh_table *new_t;</span>
<a href="#l39.539"></a><span id="l39.539" class="difflineplus">+	struct lh_entry *ent;</span>
<a href="#l39.540"></a><span id="l39.540" class="difflineplus">+</span>
<a href="#l39.541"></a><span id="l39.541" class="difflineplus">+	new_t = lh_table_new(new_size, NULL, t-&gt;hash_fn, t-&gt;equal_fn);</span>
<a href="#l39.542"></a><span id="l39.542" class="difflineplus">+	if (new_t == NULL)</span>
<a href="#l39.543"></a><span id="l39.543" class="difflineplus">+		return -1;</span>
<a href="#l39.544"></a><span id="l39.544" class="difflineplus">+</span>
<a href="#l39.545"></a><span id="l39.545" class="difflineplus">+	for (ent = t-&gt;head; ent != NULL; ent = ent-&gt;next)</span>
<a href="#l39.546"></a><span id="l39.546" class="difflineplus">+	{</span>
<a href="#l39.547"></a><span id="l39.547" class="difflineplus">+		unsigned long h = lh_get_hash(new_t, ent-&gt;k);</span>
<a href="#l39.548"></a><span id="l39.548" class="difflineplus">+		unsigned int opts = 0;</span>
<a href="#l39.549"></a><span id="l39.549" class="difflineplus">+		if (ent-&gt;k_is_constant)</span>
<a href="#l39.550"></a><span id="l39.550" class="difflineplus">+			opts = JSON_C_OBJECT_KEY_IS_CONSTANT;</span>
<a href="#l39.551"></a><span id="l39.551" class="difflineplus">+		if (lh_table_insert_w_hash(new_t, ent-&gt;k, ent-&gt;v, h, opts) != 0)</span>
<a href="#l39.552"></a><span id="l39.552" class="difflineplus">+		{</span>
<a href="#l39.553"></a><span id="l39.553" class="difflineplus">+			lh_table_free(new_t);</span>
<a href="#l39.554"></a><span id="l39.554" class="difflineplus">+			return -1;</span>
<a href="#l39.555"></a><span id="l39.555" class="difflineplus">+		}</span>
<a href="#l39.556"></a><span id="l39.556" class="difflineplus">+	}</span>
<a href="#l39.557"></a><span id="l39.557" class="difflineplus">+	free(t-&gt;table);</span>
<a href="#l39.558"></a><span id="l39.558" class="difflineplus">+	t-&gt;table = new_t-&gt;table;</span>
<a href="#l39.559"></a><span id="l39.559" class="difflineplus">+	t-&gt;size = new_size;</span>
<a href="#l39.560"></a><span id="l39.560" class="difflineplus">+	t-&gt;head = new_t-&gt;head;</span>
<a href="#l39.561"></a><span id="l39.561" class="difflineplus">+	t-&gt;tail = new_t-&gt;tail;</span>
<a href="#l39.562"></a><span id="l39.562" class="difflineplus">+	free(new_t);</span>
<a href="#l39.563"></a><span id="l39.563" class="difflineplus">+</span>
<a href="#l39.564"></a><span id="l39.564" class="difflineplus">+	return 0;</span>
<a href="#l39.565"></a><span id="l39.565" class="difflineplus">+}</span>
<a href="#l39.566"></a><span id="l39.566" class="difflineplus">+</span>
<a href="#l39.567"></a><span id="l39.567" class="difflineplus">+void lh_table_free(struct lh_table *t)</span>
<a href="#l39.568"></a><span id="l39.568" class="difflineplus">+{</span>
<a href="#l39.569"></a><span id="l39.569" class="difflineplus">+	struct lh_entry *c;</span>
<a href="#l39.570"></a><span id="l39.570" class="difflineplus">+	if(t-&gt;free_fn) {</span>
<a href="#l39.571"></a><span id="l39.571" class="difflineplus">+		for(c = t-&gt;head; c != NULL; c = c-&gt;next)</span>
<a href="#l39.572"></a><span id="l39.572" class="difflineplus">+			t-&gt;free_fn(c);</span>
<a href="#l39.573"></a><span id="l39.573" class="difflineplus">+	}</span>
<a href="#l39.574"></a><span id="l39.574" class="difflineplus">+	free(t-&gt;table);</span>
<a href="#l39.575"></a><span id="l39.575" class="difflineplus">+	free(t);</span>
<a href="#l39.576"></a><span id="l39.576" class="difflineplus">+}</span>
<a href="#l39.577"></a><span id="l39.577" class="difflineplus">+</span>
<a href="#l39.578"></a><span id="l39.578" class="difflineplus">+</span>
<a href="#l39.579"></a><span id="l39.579" class="difflineplus">+int lh_table_insert_w_hash(struct lh_table *t, const void *k, const void *v, const unsigned long h, const unsigned opts)</span>
<a href="#l39.580"></a><span id="l39.580" class="difflineplus">+{</span>
<a href="#l39.581"></a><span id="l39.581" class="difflineplus">+	unsigned long n;</span>
<a href="#l39.582"></a><span id="l39.582" class="difflineplus">+</span>
<a href="#l39.583"></a><span id="l39.583" class="difflineplus">+	if (t-&gt;count &gt;= t-&gt;size * LH_LOAD_FACTOR)</span>
<a href="#l39.584"></a><span id="l39.584" class="difflineplus">+		if (lh_table_resize(t, t-&gt;size * 2) != 0)</span>
<a href="#l39.585"></a><span id="l39.585" class="difflineplus">+			return -1;</span>
<a href="#l39.586"></a><span id="l39.586" class="difflineplus">+</span>
<a href="#l39.587"></a><span id="l39.587" class="difflineplus">+	n = h % t-&gt;size;</span>
<a href="#l39.588"></a><span id="l39.588" class="difflineplus">+</span>
<a href="#l39.589"></a><span id="l39.589" class="difflineplus">+	while( 1 ) {</span>
<a href="#l39.590"></a><span id="l39.590" class="difflineplus">+		if(t-&gt;table[n].k == LH_EMPTY || t-&gt;table[n].k == LH_FREED) break;</span>
<a href="#l39.591"></a><span id="l39.591" class="difflineplus">+		if ((int)++n == t-&gt;size) n = 0;</span>
<a href="#l39.592"></a><span id="l39.592" class="difflineplus">+	}</span>
<a href="#l39.593"></a><span id="l39.593" class="difflineplus">+</span>
<a href="#l39.594"></a><span id="l39.594" class="difflineplus">+	t-&gt;table[n].k = k;</span>
<a href="#l39.595"></a><span id="l39.595" class="difflineplus">+	t-&gt;table[n].k_is_constant = (opts &amp; JSON_C_OBJECT_KEY_IS_CONSTANT);</span>
<a href="#l39.596"></a><span id="l39.596" class="difflineplus">+	t-&gt;table[n].v = v;</span>
<a href="#l39.597"></a><span id="l39.597" class="difflineplus">+	t-&gt;count++;</span>
<a href="#l39.598"></a><span id="l39.598" class="difflineplus">+</span>
<a href="#l39.599"></a><span id="l39.599" class="difflineplus">+	if(t-&gt;head == NULL) {</span>
<a href="#l39.600"></a><span id="l39.600" class="difflineplus">+		t-&gt;head = t-&gt;tail = &amp;t-&gt;table[n];</span>
<a href="#l39.601"></a><span id="l39.601" class="difflineplus">+		t-&gt;table[n].next = t-&gt;table[n].prev = NULL;</span>
<a href="#l39.602"></a><span id="l39.602" class="difflineplus">+	} else {</span>
<a href="#l39.603"></a><span id="l39.603" class="difflineplus">+		t-&gt;tail-&gt;next = &amp;t-&gt;table[n];</span>
<a href="#l39.604"></a><span id="l39.604" class="difflineplus">+		t-&gt;table[n].prev = t-&gt;tail;</span>
<a href="#l39.605"></a><span id="l39.605" class="difflineplus">+		t-&gt;table[n].next = NULL;</span>
<a href="#l39.606"></a><span id="l39.606" class="difflineplus">+		t-&gt;tail = &amp;t-&gt;table[n];</span>
<a href="#l39.607"></a><span id="l39.607" class="difflineplus">+	}</span>
<a href="#l39.608"></a><span id="l39.608" class="difflineplus">+</span>
<a href="#l39.609"></a><span id="l39.609" class="difflineplus">+	return 0;</span>
<a href="#l39.610"></a><span id="l39.610" class="difflineplus">+}</span>
<a href="#l39.611"></a><span id="l39.611" class="difflineplus">+int lh_table_insert(struct lh_table *t, const void *k, const void *v)</span>
<a href="#l39.612"></a><span id="l39.612" class="difflineplus">+{</span>
<a href="#l39.613"></a><span id="l39.613" class="difflineplus">+	return lh_table_insert_w_hash(t, k, v, lh_get_hash(t, k), 0);</span>
<a href="#l39.614"></a><span id="l39.614" class="difflineplus">+}</span>
<a href="#l39.615"></a><span id="l39.615" class="difflineplus">+</span>
<a href="#l39.616"></a><span id="l39.616" class="difflineplus">+</span>
<a href="#l39.617"></a><span id="l39.617" class="difflineplus">+struct lh_entry* lh_table_lookup_entry_w_hash(struct lh_table *t, const void *k, const unsigned long h)</span>
<a href="#l39.618"></a><span id="l39.618" class="difflineplus">+{</span>
<a href="#l39.619"></a><span id="l39.619" class="difflineplus">+	unsigned long n = h % t-&gt;size;</span>
<a href="#l39.620"></a><span id="l39.620" class="difflineplus">+	int count = 0;</span>
<a href="#l39.621"></a><span id="l39.621" class="difflineplus">+</span>
<a href="#l39.622"></a><span id="l39.622" class="difflineplus">+	while( count &lt; t-&gt;size ) {</span>
<a href="#l39.623"></a><span id="l39.623" class="difflineplus">+		if(t-&gt;table[n].k == LH_EMPTY) return NULL;</span>
<a href="#l39.624"></a><span id="l39.624" class="difflineplus">+		if(t-&gt;table[n].k != LH_FREED &amp;&amp;</span>
<a href="#l39.625"></a><span id="l39.625" class="difflineplus">+		   t-&gt;equal_fn(t-&gt;table[n].k, k)) return &amp;t-&gt;table[n];</span>
<a href="#l39.626"></a><span id="l39.626" class="difflineplus">+		if ((int)++n == t-&gt;size) n = 0;</span>
<a href="#l39.627"></a><span id="l39.627" class="difflineplus">+		count++;</span>
<a href="#l39.628"></a><span id="l39.628" class="difflineplus">+	}</span>
<a href="#l39.629"></a><span id="l39.629" class="difflineplus">+	return NULL;</span>
<a href="#l39.630"></a><span id="l39.630" class="difflineplus">+}</span>
<a href="#l39.631"></a><span id="l39.631" class="difflineplus">+</span>
<a href="#l39.632"></a><span id="l39.632" class="difflineplus">+struct lh_entry* lh_table_lookup_entry(struct lh_table *t, const void *k)</span>
<a href="#l39.633"></a><span id="l39.633" class="difflineplus">+{</span>
<a href="#l39.634"></a><span id="l39.634" class="difflineplus">+	return lh_table_lookup_entry_w_hash(t, k, lh_get_hash(t, k));</span>
<a href="#l39.635"></a><span id="l39.635" class="difflineplus">+}</span>
<a href="#l39.636"></a><span id="l39.636" class="difflineplus">+</span>
<a href="#l39.637"></a><span id="l39.637" class="difflineplus">+const void* lh_table_lookup(struct lh_table *t, const void *k)</span>
<a href="#l39.638"></a><span id="l39.638" class="difflineplus">+{</span>
<a href="#l39.639"></a><span id="l39.639" class="difflineplus">+	void *result;</span>
<a href="#l39.640"></a><span id="l39.640" class="difflineplus">+	lh_table_lookup_ex(t, k, &amp;result);</span>
<a href="#l39.641"></a><span id="l39.641" class="difflineplus">+	return result;</span>
<a href="#l39.642"></a><span id="l39.642" class="difflineplus">+}</span>
<a href="#l39.643"></a><span id="l39.643" class="difflineplus">+</span>
<a href="#l39.644"></a><span id="l39.644" class="difflineplus">+json_bool lh_table_lookup_ex(struct lh_table* t, const void* k, void **v)</span>
<a href="#l39.645"></a><span id="l39.645" class="difflineplus">+{</span>
<a href="#l39.646"></a><span id="l39.646" class="difflineplus">+	struct lh_entry *e = lh_table_lookup_entry(t, k);</span>
<a href="#l39.647"></a><span id="l39.647" class="difflineplus">+	if (e != NULL) {</span>
<a href="#l39.648"></a><span id="l39.648" class="difflineplus">+		if (v != NULL) *v = lh_entry_v(e);</span>
<a href="#l39.649"></a><span id="l39.649" class="difflineplus">+		return TRUE; /* key found */</span>
<a href="#l39.650"></a><span id="l39.650" class="difflineplus">+	}</span>
<a href="#l39.651"></a><span id="l39.651" class="difflineplus">+	if (v != NULL) *v = NULL;</span>
<a href="#l39.652"></a><span id="l39.652" class="difflineplus">+		return FALSE; /* key not found */</span>
<a href="#l39.653"></a><span id="l39.653" class="difflineplus">+}</span>
<a href="#l39.654"></a><span id="l39.654" class="difflineplus">+</span>
<a href="#l39.655"></a><span id="l39.655" class="difflineplus">+int lh_table_delete_entry(struct lh_table *t, struct lh_entry *e)</span>
<a href="#l39.656"></a><span id="l39.656" class="difflineplus">+{</span>
<a href="#l39.657"></a><span id="l39.657" class="difflineplus">+	ptrdiff_t n = (ptrdiff_t)(e - t-&gt;table); /* CAW: fixed to be 64bit nice, still need the crazy negative case... */</span>
<a href="#l39.658"></a><span id="l39.658" class="difflineplus">+</span>
<a href="#l39.659"></a><span id="l39.659" class="difflineplus">+	/* CAW: this is bad, really bad, maybe stack goes other direction on this machine... */</span>
<a href="#l39.660"></a><span id="l39.660" class="difflineplus">+	if(n &lt; 0) { return -2; }</span>
<a href="#l39.661"></a><span id="l39.661" class="difflineplus">+</span>
<a href="#l39.662"></a><span id="l39.662" class="difflineplus">+	if(t-&gt;table[n].k == LH_EMPTY || t-&gt;table[n].k == LH_FREED) return -1;</span>
<a href="#l39.663"></a><span id="l39.663" class="difflineplus">+	t-&gt;count--;</span>
<a href="#l39.664"></a><span id="l39.664" class="difflineplus">+	if(t-&gt;free_fn) t-&gt;free_fn(e);</span>
<a href="#l39.665"></a><span id="l39.665" class="difflineplus">+	t-&gt;table[n].v = NULL;</span>
<a href="#l39.666"></a><span id="l39.666" class="difflineplus">+	t-&gt;table[n].k = LH_FREED;</span>
<a href="#l39.667"></a><span id="l39.667" class="difflineplus">+	if(t-&gt;tail == &amp;t-&gt;table[n] &amp;&amp; t-&gt;head == &amp;t-&gt;table[n]) {</span>
<a href="#l39.668"></a><span id="l39.668" class="difflineplus">+		t-&gt;head = t-&gt;tail = NULL;</span>
<a href="#l39.669"></a><span id="l39.669" class="difflineplus">+	} else if (t-&gt;head == &amp;t-&gt;table[n]) {</span>
<a href="#l39.670"></a><span id="l39.670" class="difflineplus">+		t-&gt;head-&gt;next-&gt;prev = NULL;</span>
<a href="#l39.671"></a><span id="l39.671" class="difflineplus">+		t-&gt;head = t-&gt;head-&gt;next;</span>
<a href="#l39.672"></a><span id="l39.672" class="difflineplus">+	} else if (t-&gt;tail == &amp;t-&gt;table[n]) {</span>
<a href="#l39.673"></a><span id="l39.673" class="difflineplus">+		t-&gt;tail-&gt;prev-&gt;next = NULL;</span>
<a href="#l39.674"></a><span id="l39.674" class="difflineplus">+		t-&gt;tail = t-&gt;tail-&gt;prev;</span>
<a href="#l39.675"></a><span id="l39.675" class="difflineplus">+	} else {</span>
<a href="#l39.676"></a><span id="l39.676" class="difflineplus">+		t-&gt;table[n].prev-&gt;next = t-&gt;table[n].next;</span>
<a href="#l39.677"></a><span id="l39.677" class="difflineplus">+		t-&gt;table[n].next-&gt;prev = t-&gt;table[n].prev;</span>
<a href="#l39.678"></a><span id="l39.678" class="difflineplus">+	}</span>
<a href="#l39.679"></a><span id="l39.679" class="difflineplus">+	t-&gt;table[n].next = t-&gt;table[n].prev = NULL;</span>
<a href="#l39.680"></a><span id="l39.680" class="difflineplus">+	return 0;</span>
<a href="#l39.681"></a><span id="l39.681" class="difflineplus">+}</span>
<a href="#l39.682"></a><span id="l39.682" class="difflineplus">+</span>
<a href="#l39.683"></a><span id="l39.683" class="difflineplus">+</span>
<a href="#l39.684"></a><span id="l39.684" class="difflineplus">+int lh_table_delete(struct lh_table *t, const void *k)</span>
<a href="#l39.685"></a><span id="l39.685" class="difflineplus">+{</span>
<a href="#l39.686"></a><span id="l39.686" class="difflineplus">+	struct lh_entry *e = lh_table_lookup_entry(t, k);</span>
<a href="#l39.687"></a><span id="l39.687" class="difflineplus">+	if(!e) return -1;</span>
<a href="#l39.688"></a><span id="l39.688" class="difflineplus">+	return lh_table_delete_entry(t, e);</span>
<a href="#l39.689"></a><span id="l39.689" class="difflineplus">+}</span>
<a href="#l39.690"></a><span id="l39.690" class="difflineplus">+</span>
<a href="#l39.691"></a><span id="l39.691" class="difflineplus">+int lh_table_length(struct lh_table *t)</span>
<a href="#l39.692"></a><span id="l39.692" class="difflineplus">+{</span>
<a href="#l39.693"></a><span id="l39.693" class="difflineplus">+	return t-&gt;count;</span>
<a href="#l39.694"></a><span id="l39.694" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1">new file mode 100644</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineminus">--- /dev/null</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineplus">+++ b/third_party/json-c/linkhash.h</span>
<a href="#l40.4"></a><span id="l40.4" class="difflineat">@@ -0,0 +1,406 @@</span>
<a href="#l40.5"></a><span id="l40.5" class="difflineplus">+/*</span>
<a href="#l40.6"></a><span id="l40.6" class="difflineplus">+ * $Id: linkhash.h,v 1.6 2006/01/30 23:07:57 mclark Exp $</span>
<a href="#l40.7"></a><span id="l40.7" class="difflineplus">+ *</span>
<a href="#l40.8"></a><span id="l40.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l40.9"></a><span id="l40.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l40.10"></a><span id="l40.10" class="difflineplus">+ * Copyright (c) 2009 Hewlett-Packard Development Company, L.P.</span>
<a href="#l40.11"></a><span id="l40.11" class="difflineplus">+ *</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l40.14"></a><span id="l40.14" class="difflineplus">+ *</span>
<a href="#l40.15"></a><span id="l40.15" class="difflineplus">+ */</span>
<a href="#l40.16"></a><span id="l40.16" class="difflineplus">+</span>
<a href="#l40.17"></a><span id="l40.17" class="difflineplus">+/**</span>
<a href="#l40.18"></a><span id="l40.18" class="difflineplus">+ * @file</span>
<a href="#l40.19"></a><span id="l40.19" class="difflineplus">+ * @brief Internal methods for working with json_type_object objects.  Although</span>
<a href="#l40.20"></a><span id="l40.20" class="difflineplus">+ *        this is exposed by the json_object_get_object() function and within the</span>
<a href="#l40.21"></a><span id="l40.21" class="difflineplus">+ *        json_object_iter type, it is not recommended for direct use.</span>
<a href="#l40.22"></a><span id="l40.22" class="difflineplus">+ */</span>
<a href="#l40.23"></a><span id="l40.23" class="difflineplus">+#ifndef _linkhash_h_</span>
<a href="#l40.24"></a><span id="l40.24" class="difflineplus">+#define _linkhash_h_</span>
<a href="#l40.25"></a><span id="l40.25" class="difflineplus">+</span>
<a href="#l40.26"></a><span id="l40.26" class="difflineplus">+#include &quot;json_object.h&quot;</span>
<a href="#l40.27"></a><span id="l40.27" class="difflineplus">+</span>
<a href="#l40.28"></a><span id="l40.28" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l40.29"></a><span id="l40.29" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l40.30"></a><span id="l40.30" class="difflineplus">+#endif</span>
<a href="#l40.31"></a><span id="l40.31" class="difflineplus">+</span>
<a href="#l40.32"></a><span id="l40.32" class="difflineplus">+/**</span>
<a href="#l40.33"></a><span id="l40.33" class="difflineplus">+ * golden prime used in hash functions</span>
<a href="#l40.34"></a><span id="l40.34" class="difflineplus">+ */</span>
<a href="#l40.35"></a><span id="l40.35" class="difflineplus">+#define LH_PRIME 0x9e370001UL</span>
<a href="#l40.36"></a><span id="l40.36" class="difflineplus">+</span>
<a href="#l40.37"></a><span id="l40.37" class="difflineplus">+/**</span>
<a href="#l40.38"></a><span id="l40.38" class="difflineplus">+ * The fraction of filled hash buckets until an insert will cause the table</span>
<a href="#l40.39"></a><span id="l40.39" class="difflineplus">+ * to be resized.</span>
<a href="#l40.40"></a><span id="l40.40" class="difflineplus">+ * This can range from just above 0 up to 1.0.</span>
<a href="#l40.41"></a><span id="l40.41" class="difflineplus">+ */</span>
<a href="#l40.42"></a><span id="l40.42" class="difflineplus">+#define LH_LOAD_FACTOR 0.66</span>
<a href="#l40.43"></a><span id="l40.43" class="difflineplus">+</span>
<a href="#l40.44"></a><span id="l40.44" class="difflineplus">+/**</span>
<a href="#l40.45"></a><span id="l40.45" class="difflineplus">+ * sentinel pointer value for empty slots</span>
<a href="#l40.46"></a><span id="l40.46" class="difflineplus">+ */</span>
<a href="#l40.47"></a><span id="l40.47" class="difflineplus">+#define LH_EMPTY (void*)-1</span>
<a href="#l40.48"></a><span id="l40.48" class="difflineplus">+</span>
<a href="#l40.49"></a><span id="l40.49" class="difflineplus">+/**</span>
<a href="#l40.50"></a><span id="l40.50" class="difflineplus">+ * sentinel pointer value for freed slots</span>
<a href="#l40.51"></a><span id="l40.51" class="difflineplus">+ */</span>
<a href="#l40.52"></a><span id="l40.52" class="difflineplus">+#define LH_FREED (void*)-2</span>
<a href="#l40.53"></a><span id="l40.53" class="difflineplus">+</span>
<a href="#l40.54"></a><span id="l40.54" class="difflineplus">+/**</span>
<a href="#l40.55"></a><span id="l40.55" class="difflineplus">+ * default string hash function</span>
<a href="#l40.56"></a><span id="l40.56" class="difflineplus">+ */</span>
<a href="#l40.57"></a><span id="l40.57" class="difflineplus">+#define JSON_C_STR_HASH_DFLT 0</span>
<a href="#l40.58"></a><span id="l40.58" class="difflineplus">+</span>
<a href="#l40.59"></a><span id="l40.59" class="difflineplus">+/**</span>
<a href="#l40.60"></a><span id="l40.60" class="difflineplus">+ * perl-like string hash function</span>
<a href="#l40.61"></a><span id="l40.61" class="difflineplus">+ */</span>
<a href="#l40.62"></a><span id="l40.62" class="difflineplus">+#define JSON_C_STR_HASH_PERLLIKE 1</span>
<a href="#l40.63"></a><span id="l40.63" class="difflineplus">+</span>
<a href="#l40.64"></a><span id="l40.64" class="difflineplus">+/**</span>
<a href="#l40.65"></a><span id="l40.65" class="difflineplus">+ * This function sets the hash function to be used for strings.</span>
<a href="#l40.66"></a><span id="l40.66" class="difflineplus">+ * Must be one of the JSON_C_STR_HASH_* values.</span>
<a href="#l40.67"></a><span id="l40.67" class="difflineplus">+ * @returns 0 - ok, -1 if parameter was invalid</span>
<a href="#l40.68"></a><span id="l40.68" class="difflineplus">+ */</span>
<a href="#l40.69"></a><span id="l40.69" class="difflineplus">+int json_global_set_string_hash(const int h);</span>
<a href="#l40.70"></a><span id="l40.70" class="difflineplus">+</span>
<a href="#l40.71"></a><span id="l40.71" class="difflineplus">+struct lh_entry;</span>
<a href="#l40.72"></a><span id="l40.72" class="difflineplus">+</span>
<a href="#l40.73"></a><span id="l40.73" class="difflineplus">+/**</span>
<a href="#l40.74"></a><span id="l40.74" class="difflineplus">+ * callback function prototypes</span>
<a href="#l40.75"></a><span id="l40.75" class="difflineplus">+ */</span>
<a href="#l40.76"></a><span id="l40.76" class="difflineplus">+typedef void (lh_entry_free_fn) (struct lh_entry *e);</span>
<a href="#l40.77"></a><span id="l40.77" class="difflineplus">+/**</span>
<a href="#l40.78"></a><span id="l40.78" class="difflineplus">+ * callback function prototypes</span>
<a href="#l40.79"></a><span id="l40.79" class="difflineplus">+ */</span>
<a href="#l40.80"></a><span id="l40.80" class="difflineplus">+typedef unsigned long (lh_hash_fn) (const void *k);</span>
<a href="#l40.81"></a><span id="l40.81" class="difflineplus">+/**</span>
<a href="#l40.82"></a><span id="l40.82" class="difflineplus">+ * callback function prototypes</span>
<a href="#l40.83"></a><span id="l40.83" class="difflineplus">+ */</span>
<a href="#l40.84"></a><span id="l40.84" class="difflineplus">+typedef int (lh_equal_fn) (const void *k1, const void *k2);</span>
<a href="#l40.85"></a><span id="l40.85" class="difflineplus">+</span>
<a href="#l40.86"></a><span id="l40.86" class="difflineplus">+/**</span>
<a href="#l40.87"></a><span id="l40.87" class="difflineplus">+ * An entry in the hash table</span>
<a href="#l40.88"></a><span id="l40.88" class="difflineplus">+ */</span>
<a href="#l40.89"></a><span id="l40.89" class="difflineplus">+struct lh_entry {</span>
<a href="#l40.90"></a><span id="l40.90" class="difflineplus">+	/**</span>
<a href="#l40.91"></a><span id="l40.91" class="difflineplus">+	 * The key.  Use lh_entry_k() instead of accessing this directly.</span>
<a href="#l40.92"></a><span id="l40.92" class="difflineplus">+	 */</span>
<a href="#l40.93"></a><span id="l40.93" class="difflineplus">+	const void *k;</span>
<a href="#l40.94"></a><span id="l40.94" class="difflineplus">+	/**</span>
<a href="#l40.95"></a><span id="l40.95" class="difflineplus">+	 * A flag for users of linkhash to know whether or not they</span>
<a href="#l40.96"></a><span id="l40.96" class="difflineplus">+	 * need to free k.</span>
<a href="#l40.97"></a><span id="l40.97" class="difflineplus">+	 */</span>
<a href="#l40.98"></a><span id="l40.98" class="difflineplus">+	int k_is_constant;</span>
<a href="#l40.99"></a><span id="l40.99" class="difflineplus">+	/**</span>
<a href="#l40.100"></a><span id="l40.100" class="difflineplus">+	 * The value.  Use lh_entry_v() instead of accessing this directly.</span>
<a href="#l40.101"></a><span id="l40.101" class="difflineplus">+	 */</span>
<a href="#l40.102"></a><span id="l40.102" class="difflineplus">+	const void *v;</span>
<a href="#l40.103"></a><span id="l40.103" class="difflineplus">+	/**</span>
<a href="#l40.104"></a><span id="l40.104" class="difflineplus">+	 * The next entry</span>
<a href="#l40.105"></a><span id="l40.105" class="difflineplus">+	 */</span>
<a href="#l40.106"></a><span id="l40.106" class="difflineplus">+	struct lh_entry *next;</span>
<a href="#l40.107"></a><span id="l40.107" class="difflineplus">+	/**</span>
<a href="#l40.108"></a><span id="l40.108" class="difflineplus">+	 * The previous entry.</span>
<a href="#l40.109"></a><span id="l40.109" class="difflineplus">+	 */</span>
<a href="#l40.110"></a><span id="l40.110" class="difflineplus">+	struct lh_entry *prev;</span>
<a href="#l40.111"></a><span id="l40.111" class="difflineplus">+};</span>
<a href="#l40.112"></a><span id="l40.112" class="difflineplus">+</span>
<a href="#l40.113"></a><span id="l40.113" class="difflineplus">+</span>
<a href="#l40.114"></a><span id="l40.114" class="difflineplus">+/**</span>
<a href="#l40.115"></a><span id="l40.115" class="difflineplus">+ * The hash table structure.</span>
<a href="#l40.116"></a><span id="l40.116" class="difflineplus">+ */</span>
<a href="#l40.117"></a><span id="l40.117" class="difflineplus">+struct lh_table {</span>
<a href="#l40.118"></a><span id="l40.118" class="difflineplus">+	/**</span>
<a href="#l40.119"></a><span id="l40.119" class="difflineplus">+	 * Size of our hash.</span>
<a href="#l40.120"></a><span id="l40.120" class="difflineplus">+	 */</span>
<a href="#l40.121"></a><span id="l40.121" class="difflineplus">+	int size;</span>
<a href="#l40.122"></a><span id="l40.122" class="difflineplus">+	/**</span>
<a href="#l40.123"></a><span id="l40.123" class="difflineplus">+	 * Numbers of entries.</span>
<a href="#l40.124"></a><span id="l40.124" class="difflineplus">+	 */</span>
<a href="#l40.125"></a><span id="l40.125" class="difflineplus">+	int count;</span>
<a href="#l40.126"></a><span id="l40.126" class="difflineplus">+</span>
<a href="#l40.127"></a><span id="l40.127" class="difflineplus">+	/**</span>
<a href="#l40.128"></a><span id="l40.128" class="difflineplus">+	 * The first entry.</span>
<a href="#l40.129"></a><span id="l40.129" class="difflineplus">+	 */</span>
<a href="#l40.130"></a><span id="l40.130" class="difflineplus">+	struct lh_entry *head;</span>
<a href="#l40.131"></a><span id="l40.131" class="difflineplus">+</span>
<a href="#l40.132"></a><span id="l40.132" class="difflineplus">+	/**</span>
<a href="#l40.133"></a><span id="l40.133" class="difflineplus">+	 * The last entry.</span>
<a href="#l40.134"></a><span id="l40.134" class="difflineplus">+	 */</span>
<a href="#l40.135"></a><span id="l40.135" class="difflineplus">+	struct lh_entry *tail;</span>
<a href="#l40.136"></a><span id="l40.136" class="difflineplus">+</span>
<a href="#l40.137"></a><span id="l40.137" class="difflineplus">+	struct lh_entry *table;</span>
<a href="#l40.138"></a><span id="l40.138" class="difflineplus">+</span>
<a href="#l40.139"></a><span id="l40.139" class="difflineplus">+	/**</span>
<a href="#l40.140"></a><span id="l40.140" class="difflineplus">+	 * A pointer onto the function responsible for freeing an entry.</span>
<a href="#l40.141"></a><span id="l40.141" class="difflineplus">+	 */</span>
<a href="#l40.142"></a><span id="l40.142" class="difflineplus">+	lh_entry_free_fn *free_fn;</span>
<a href="#l40.143"></a><span id="l40.143" class="difflineplus">+	lh_hash_fn *hash_fn;</span>
<a href="#l40.144"></a><span id="l40.144" class="difflineplus">+	lh_equal_fn *equal_fn;</span>
<a href="#l40.145"></a><span id="l40.145" class="difflineplus">+};</span>
<a href="#l40.146"></a><span id="l40.146" class="difflineplus">+typedef struct lh_table lh_table;</span>
<a href="#l40.147"></a><span id="l40.147" class="difflineplus">+</span>
<a href="#l40.148"></a><span id="l40.148" class="difflineplus">+</span>
<a href="#l40.149"></a><span id="l40.149" class="difflineplus">+/**</span>
<a href="#l40.150"></a><span id="l40.150" class="difflineplus">+ * Convenience list iterator.</span>
<a href="#l40.151"></a><span id="l40.151" class="difflineplus">+ */</span>
<a href="#l40.152"></a><span id="l40.152" class="difflineplus">+#define lh_foreach(table, entry) \</span>
<a href="#l40.153"></a><span id="l40.153" class="difflineplus">+for(entry = table-&gt;head; entry; entry = entry-&gt;next)</span>
<a href="#l40.154"></a><span id="l40.154" class="difflineplus">+</span>
<a href="#l40.155"></a><span id="l40.155" class="difflineplus">+/**</span>
<a href="#l40.156"></a><span id="l40.156" class="difflineplus">+ * lh_foreach_safe allows calling of deletion routine while iterating.</span>
<a href="#l40.157"></a><span id="l40.157" class="difflineplus">+ *</span>
<a href="#l40.158"></a><span id="l40.158" class="difflineplus">+ * @param table a struct lh_table * to iterate over</span>
<a href="#l40.159"></a><span id="l40.159" class="difflineplus">+ * @param entry a struct lh_entry * variable to hold each element</span>
<a href="#l40.160"></a><span id="l40.160" class="difflineplus">+ * @param tmp a struct lh_entry * variable to hold a temporary pointer to the next element</span>
<a href="#l40.161"></a><span id="l40.161" class="difflineplus">+ */</span>
<a href="#l40.162"></a><span id="l40.162" class="difflineplus">+#define lh_foreach_safe(table, entry, tmp) \</span>
<a href="#l40.163"></a><span id="l40.163" class="difflineplus">+for(entry = table-&gt;head; entry &amp;&amp; ((tmp = entry-&gt;next) || 1); entry = tmp)</span>
<a href="#l40.164"></a><span id="l40.164" class="difflineplus">+</span>
<a href="#l40.165"></a><span id="l40.165" class="difflineplus">+</span>
<a href="#l40.166"></a><span id="l40.166" class="difflineplus">+</span>
<a href="#l40.167"></a><span id="l40.167" class="difflineplus">+/**</span>
<a href="#l40.168"></a><span id="l40.168" class="difflineplus">+ * Create a new linkhash table.</span>
<a href="#l40.169"></a><span id="l40.169" class="difflineplus">+ *</span>
<a href="#l40.170"></a><span id="l40.170" class="difflineplus">+ * @param size initial table size. The table is automatically resized</span>
<a href="#l40.171"></a><span id="l40.171" class="difflineplus">+ * although this incurs a performance penalty.</span>
<a href="#l40.172"></a><span id="l40.172" class="difflineplus">+ * @param free_fn callback function used to free memory for entries</span>
<a href="#l40.173"></a><span id="l40.173" class="difflineplus">+ * when lh_table_free or lh_table_delete is called.</span>
<a href="#l40.174"></a><span id="l40.174" class="difflineplus">+ * If NULL is provided, then memory for keys and values</span>
<a href="#l40.175"></a><span id="l40.175" class="difflineplus">+ * must be freed by the caller.</span>
<a href="#l40.176"></a><span id="l40.176" class="difflineplus">+ * @param hash_fn  function used to hash keys. 2 standard ones are defined:</span>
<a href="#l40.177"></a><span id="l40.177" class="difflineplus">+ * lh_ptr_hash and lh_char_hash for hashing pointer values</span>
<a href="#l40.178"></a><span id="l40.178" class="difflineplus">+ * and C strings respectively.</span>
<a href="#l40.179"></a><span id="l40.179" class="difflineplus">+ * @param equal_fn comparison function to compare keys. 2 standard ones defined:</span>
<a href="#l40.180"></a><span id="l40.180" class="difflineplus">+ * lh_ptr_hash and lh_char_hash for comparing pointer values</span>
<a href="#l40.181"></a><span id="l40.181" class="difflineplus">+ * and C strings respectively.</span>
<a href="#l40.182"></a><span id="l40.182" class="difflineplus">+ * @return On success, a pointer to the new linkhash table is returned.</span>
<a href="#l40.183"></a><span id="l40.183" class="difflineplus">+ * 	On error, a null pointer is returned.</span>
<a href="#l40.184"></a><span id="l40.184" class="difflineplus">+ */</span>
<a href="#l40.185"></a><span id="l40.185" class="difflineplus">+extern struct lh_table* lh_table_new(int size,</span>
<a href="#l40.186"></a><span id="l40.186" class="difflineplus">+				     lh_entry_free_fn *free_fn,</span>
<a href="#l40.187"></a><span id="l40.187" class="difflineplus">+				     lh_hash_fn *hash_fn,</span>
<a href="#l40.188"></a><span id="l40.188" class="difflineplus">+				     lh_equal_fn *equal_fn);</span>
<a href="#l40.189"></a><span id="l40.189" class="difflineplus">+</span>
<a href="#l40.190"></a><span id="l40.190" class="difflineplus">+/**</span>
<a href="#l40.191"></a><span id="l40.191" class="difflineplus">+ * Convenience function to create a new linkhash table with char keys.</span>
<a href="#l40.192"></a><span id="l40.192" class="difflineplus">+ *</span>
<a href="#l40.193"></a><span id="l40.193" class="difflineplus">+ * @param size initial table size.</span>
<a href="#l40.194"></a><span id="l40.194" class="difflineplus">+ * @param free_fn callback function used to free memory for entries.</span>
<a href="#l40.195"></a><span id="l40.195" class="difflineplus">+ * @return On success, a pointer to the new linkhash table is returned.</span>
<a href="#l40.196"></a><span id="l40.196" class="difflineplus">+ * 	On error, a null pointer is returned.</span>
<a href="#l40.197"></a><span id="l40.197" class="difflineplus">+ */</span>
<a href="#l40.198"></a><span id="l40.198" class="difflineplus">+extern struct lh_table* lh_kchar_table_new(int size,</span>
<a href="#l40.199"></a><span id="l40.199" class="difflineplus">+					   lh_entry_free_fn *free_fn);</span>
<a href="#l40.200"></a><span id="l40.200" class="difflineplus">+</span>
<a href="#l40.201"></a><span id="l40.201" class="difflineplus">+</span>
<a href="#l40.202"></a><span id="l40.202" class="difflineplus">+/**</span>
<a href="#l40.203"></a><span id="l40.203" class="difflineplus">+ * Convenience function to create a new linkhash table with ptr keys.</span>
<a href="#l40.204"></a><span id="l40.204" class="difflineplus">+ *</span>
<a href="#l40.205"></a><span id="l40.205" class="difflineplus">+ * @param size initial table size.</span>
<a href="#l40.206"></a><span id="l40.206" class="difflineplus">+ * @param free_fn callback function used to free memory for entries.</span>
<a href="#l40.207"></a><span id="l40.207" class="difflineplus">+ * @return On success, a pointer to the new linkhash table is returned.</span>
<a href="#l40.208"></a><span id="l40.208" class="difflineplus">+ * 	On error, a null pointer is returned.</span>
<a href="#l40.209"></a><span id="l40.209" class="difflineplus">+ */</span>
<a href="#l40.210"></a><span id="l40.210" class="difflineplus">+extern struct lh_table* lh_kptr_table_new(int size,</span>
<a href="#l40.211"></a><span id="l40.211" class="difflineplus">+					  lh_entry_free_fn *free_fn);</span>
<a href="#l40.212"></a><span id="l40.212" class="difflineplus">+</span>
<a href="#l40.213"></a><span id="l40.213" class="difflineplus">+</span>
<a href="#l40.214"></a><span id="l40.214" class="difflineplus">+/**</span>
<a href="#l40.215"></a><span id="l40.215" class="difflineplus">+ * Free a linkhash table.</span>
<a href="#l40.216"></a><span id="l40.216" class="difflineplus">+ *</span>
<a href="#l40.217"></a><span id="l40.217" class="difflineplus">+ * If a lh_entry_free_fn callback free function was provided then it is</span>
<a href="#l40.218"></a><span id="l40.218" class="difflineplus">+ * called for all entries in the table.</span>
<a href="#l40.219"></a><span id="l40.219" class="difflineplus">+ *</span>
<a href="#l40.220"></a><span id="l40.220" class="difflineplus">+ * @param t table to free.</span>
<a href="#l40.221"></a><span id="l40.221" class="difflineplus">+ */</span>
<a href="#l40.222"></a><span id="l40.222" class="difflineplus">+extern void lh_table_free(struct lh_table *t);</span>
<a href="#l40.223"></a><span id="l40.223" class="difflineplus">+</span>
<a href="#l40.224"></a><span id="l40.224" class="difflineplus">+</span>
<a href="#l40.225"></a><span id="l40.225" class="difflineplus">+/**</span>
<a href="#l40.226"></a><span id="l40.226" class="difflineplus">+ * Insert a record into the table.</span>
<a href="#l40.227"></a><span id="l40.227" class="difflineplus">+ *</span>
<a href="#l40.228"></a><span id="l40.228" class="difflineplus">+ * @param t the table to insert into.</span>
<a href="#l40.229"></a><span id="l40.229" class="difflineplus">+ * @param k a pointer to the key to insert.</span>
<a href="#l40.230"></a><span id="l40.230" class="difflineplus">+ * @param v a pointer to the value to insert.</span>
<a href="#l40.231"></a><span id="l40.231" class="difflineplus">+ *</span>
<a href="#l40.232"></a><span id="l40.232" class="difflineplus">+ * @return On success, &lt;code&gt;0&lt;/code&gt; is returned.</span>
<a href="#l40.233"></a><span id="l40.233" class="difflineplus">+ * 	On error, a negative value is returned.</span>
<a href="#l40.234"></a><span id="l40.234" class="difflineplus">+ */</span>
<a href="#l40.235"></a><span id="l40.235" class="difflineplus">+extern int lh_table_insert(struct lh_table *t, const void *k, const void *v);</span>
<a href="#l40.236"></a><span id="l40.236" class="difflineplus">+</span>
<a href="#l40.237"></a><span id="l40.237" class="difflineplus">+</span>
<a href="#l40.238"></a><span id="l40.238" class="difflineplus">+/**</span>
<a href="#l40.239"></a><span id="l40.239" class="difflineplus">+ * Insert a record into the table using a precalculated key hash.</span>
<a href="#l40.240"></a><span id="l40.240" class="difflineplus">+ *</span>
<a href="#l40.241"></a><span id="l40.241" class="difflineplus">+ * The hash h, which should be calculated with lh_get_hash() on k, is provided by</span>
<a href="#l40.242"></a><span id="l40.242" class="difflineplus">+ *  the caller, to allow for optimization when multiple operations with the same</span>
<a href="#l40.243"></a><span id="l40.243" class="difflineplus">+ *  key are known to be needed.</span>
<a href="#l40.244"></a><span id="l40.244" class="difflineplus">+ *</span>
<a href="#l40.245"></a><span id="l40.245" class="difflineplus">+ * @param t the table to insert into.</span>
<a href="#l40.246"></a><span id="l40.246" class="difflineplus">+ * @param k a pointer to the key to insert.</span>
<a href="#l40.247"></a><span id="l40.247" class="difflineplus">+ * @param v a pointer to the value to insert.</span>
<a href="#l40.248"></a><span id="l40.248" class="difflineplus">+ * @param h hash value of the key to insert</span>
<a href="#l40.249"></a><span id="l40.249" class="difflineplus">+ * @param opts if set to JSON_C_OBJECT_KEY_IS_CONSTANT, sets lh_entry.k_is_constant</span>
<a href="#l40.250"></a><span id="l40.250" class="difflineplus">+ *             so t's free function knows to avoid freeing the key.</span>
<a href="#l40.251"></a><span id="l40.251" class="difflineplus">+ */</span>
<a href="#l40.252"></a><span id="l40.252" class="difflineplus">+extern int lh_table_insert_w_hash(struct lh_table *t, const void *k, const void *v, const unsigned long h, const unsigned opts);</span>
<a href="#l40.253"></a><span id="l40.253" class="difflineplus">+</span>
<a href="#l40.254"></a><span id="l40.254" class="difflineplus">+</span>
<a href="#l40.255"></a><span id="l40.255" class="difflineplus">+/**</span>
<a href="#l40.256"></a><span id="l40.256" class="difflineplus">+ * Lookup a record in the table.</span>
<a href="#l40.257"></a><span id="l40.257" class="difflineplus">+ *</span>
<a href="#l40.258"></a><span id="l40.258" class="difflineplus">+ * @param t the table to lookup</span>
<a href="#l40.259"></a><span id="l40.259" class="difflineplus">+ * @param k a pointer to the key to lookup</span>
<a href="#l40.260"></a><span id="l40.260" class="difflineplus">+ * @return a pointer to the record structure of the value or NULL if it does not exist.</span>
<a href="#l40.261"></a><span id="l40.261" class="difflineplus">+ */</span>
<a href="#l40.262"></a><span id="l40.262" class="difflineplus">+extern struct lh_entry* lh_table_lookup_entry(struct lh_table *t, const void *k);</span>
<a href="#l40.263"></a><span id="l40.263" class="difflineplus">+</span>
<a href="#l40.264"></a><span id="l40.264" class="difflineplus">+/**</span>
<a href="#l40.265"></a><span id="l40.265" class="difflineplus">+ * Lookup a record in the table using a precalculated key hash.</span>
<a href="#l40.266"></a><span id="l40.266" class="difflineplus">+ *</span>
<a href="#l40.267"></a><span id="l40.267" class="difflineplus">+ * The hash h, which should be calculated with lh_get_hash() on k, is provided by</span>
<a href="#l40.268"></a><span id="l40.268" class="difflineplus">+ *  the caller, to allow for optimization when multiple operations with the same</span>
<a href="#l40.269"></a><span id="l40.269" class="difflineplus">+ *  key are known to be needed.</span>
<a href="#l40.270"></a><span id="l40.270" class="difflineplus">+ *</span>
<a href="#l40.271"></a><span id="l40.271" class="difflineplus">+ * @param t the table to lookup</span>
<a href="#l40.272"></a><span id="l40.272" class="difflineplus">+ * @param k a pointer to the key to lookup</span>
<a href="#l40.273"></a><span id="l40.273" class="difflineplus">+ * @param h hash value of the key to lookup</span>
<a href="#l40.274"></a><span id="l40.274" class="difflineplus">+ * @return a pointer to the record structure of the value or NULL if it does not exist.</span>
<a href="#l40.275"></a><span id="l40.275" class="difflineplus">+ */</span>
<a href="#l40.276"></a><span id="l40.276" class="difflineplus">+extern struct lh_entry* lh_table_lookup_entry_w_hash(struct lh_table *t, const void *k, const unsigned long h);</span>
<a href="#l40.277"></a><span id="l40.277" class="difflineplus">+</span>
<a href="#l40.278"></a><span id="l40.278" class="difflineplus">+/**</span>
<a href="#l40.279"></a><span id="l40.279" class="difflineplus">+ * Lookup a record into the table.</span>
<a href="#l40.280"></a><span id="l40.280" class="difflineplus">+ *</span>
<a href="#l40.281"></a><span id="l40.281" class="difflineplus">+ * @param t the table to lookup</span>
<a href="#l40.282"></a><span id="l40.282" class="difflineplus">+ * @param k a pointer to the key to lookup</span>
<a href="#l40.283"></a><span id="l40.283" class="difflineplus">+ * @return a pointer to the found value or NULL if it does not exist.</span>
<a href="#l40.284"></a><span id="l40.284" class="difflineplus">+ * @deprecated Use lh_table_lookup_ex() instead.</span>
<a href="#l40.285"></a><span id="l40.285" class="difflineplus">+ */</span>
<a href="#l40.286"></a><span id="l40.286" class="difflineplus">+THIS_FUNCTION_IS_DEPRECATED(extern const void* lh_table_lookup(struct lh_table *t, const void *k));</span>
<a href="#l40.287"></a><span id="l40.287" class="difflineplus">+</span>
<a href="#l40.288"></a><span id="l40.288" class="difflineplus">+/**</span>
<a href="#l40.289"></a><span id="l40.289" class="difflineplus">+ * Lookup a record in the table.</span>
<a href="#l40.290"></a><span id="l40.290" class="difflineplus">+ *</span>
<a href="#l40.291"></a><span id="l40.291" class="difflineplus">+ * @param t the table to lookup</span>
<a href="#l40.292"></a><span id="l40.292" class="difflineplus">+ * @param k a pointer to the key to lookup</span>
<a href="#l40.293"></a><span id="l40.293" class="difflineplus">+ * @param v a pointer to a where to store the found value (set to NULL if it doesn't exist).</span>
<a href="#l40.294"></a><span id="l40.294" class="difflineplus">+ * @return whether or not the key was found</span>
<a href="#l40.295"></a><span id="l40.295" class="difflineplus">+ */</span>
<a href="#l40.296"></a><span id="l40.296" class="difflineplus">+extern json_bool lh_table_lookup_ex(struct lh_table *t, const void *k, void **v);</span>
<a href="#l40.297"></a><span id="l40.297" class="difflineplus">+</span>
<a href="#l40.298"></a><span id="l40.298" class="difflineplus">+/**</span>
<a href="#l40.299"></a><span id="l40.299" class="difflineplus">+ * Delete a record from the table.</span>
<a href="#l40.300"></a><span id="l40.300" class="difflineplus">+ *</span>
<a href="#l40.301"></a><span id="l40.301" class="difflineplus">+ * If a callback free function is provided then it is called for the</span>
<a href="#l40.302"></a><span id="l40.302" class="difflineplus">+ * for the item being deleted.</span>
<a href="#l40.303"></a><span id="l40.303" class="difflineplus">+ * @param t the table to delete from.</span>
<a href="#l40.304"></a><span id="l40.304" class="difflineplus">+ * @param e a pointer to the entry to delete.</span>
<a href="#l40.305"></a><span id="l40.305" class="difflineplus">+ * @return 0 if the item was deleted.</span>
<a href="#l40.306"></a><span id="l40.306" class="difflineplus">+ * @return -1 if it was not found.</span>
<a href="#l40.307"></a><span id="l40.307" class="difflineplus">+ */</span>
<a href="#l40.308"></a><span id="l40.308" class="difflineplus">+extern int lh_table_delete_entry(struct lh_table *t, struct lh_entry *e);</span>
<a href="#l40.309"></a><span id="l40.309" class="difflineplus">+</span>
<a href="#l40.310"></a><span id="l40.310" class="difflineplus">+</span>
<a href="#l40.311"></a><span id="l40.311" class="difflineplus">+/**</span>
<a href="#l40.312"></a><span id="l40.312" class="difflineplus">+ * Delete a record from the table.</span>
<a href="#l40.313"></a><span id="l40.313" class="difflineplus">+ *</span>
<a href="#l40.314"></a><span id="l40.314" class="difflineplus">+ * If a callback free function is provided then it is called for the</span>
<a href="#l40.315"></a><span id="l40.315" class="difflineplus">+ * for the item being deleted.</span>
<a href="#l40.316"></a><span id="l40.316" class="difflineplus">+ * @param t the table to delete from.</span>
<a href="#l40.317"></a><span id="l40.317" class="difflineplus">+ * @param k a pointer to the key to delete.</span>
<a href="#l40.318"></a><span id="l40.318" class="difflineplus">+ * @return 0 if the item was deleted.</span>
<a href="#l40.319"></a><span id="l40.319" class="difflineplus">+ * @return -1 if it was not found.</span>
<a href="#l40.320"></a><span id="l40.320" class="difflineplus">+ */</span>
<a href="#l40.321"></a><span id="l40.321" class="difflineplus">+extern int lh_table_delete(struct lh_table *t, const void *k);</span>
<a href="#l40.322"></a><span id="l40.322" class="difflineplus">+</span>
<a href="#l40.323"></a><span id="l40.323" class="difflineplus">+extern int lh_table_length(struct lh_table *t);</span>
<a href="#l40.324"></a><span id="l40.324" class="difflineplus">+</span>
<a href="#l40.325"></a><span id="l40.325" class="difflineplus">+/**</span>
<a href="#l40.326"></a><span id="l40.326" class="difflineplus">+ * Prints a message to &lt;code&gt;stdout&lt;/code&gt;,</span>
<a href="#l40.327"></a><span id="l40.327" class="difflineplus">+ * then exits the program with an exit code of &lt;code&gt;1&lt;/code&gt;.</span>
<a href="#l40.328"></a><span id="l40.328" class="difflineplus">+ *</span>
<a href="#l40.329"></a><span id="l40.329" class="difflineplus">+ * @param msg Message format string, like for &lt;code&gt;printf&lt;/code&gt;.</span>
<a href="#l40.330"></a><span id="l40.330" class="difflineplus">+ * @param ... Format args.</span>
<a href="#l40.331"></a><span id="l40.331" class="difflineplus">+ *</span>
<a href="#l40.332"></a><span id="l40.332" class="difflineplus">+ * @deprecated Since it is not a good idea to exit the entire program</span>
<a href="#l40.333"></a><span id="l40.333" class="difflineplus">+ * 	because of an internal library failure, json-c will no longer</span>
<a href="#l40.334"></a><span id="l40.334" class="difflineplus">+ * 	use this function internally.</span>
<a href="#l40.335"></a><span id="l40.335" class="difflineplus">+ * 	However, because its interface is public, it will remain part of</span>
<a href="#l40.336"></a><span id="l40.336" class="difflineplus">+ * 	the API on the off chance of legacy software using it externally.</span>
<a href="#l40.337"></a><span id="l40.337" class="difflineplus">+ */</span>
<a href="#l40.338"></a><span id="l40.338" class="difflineplus">+THIS_FUNCTION_IS_DEPRECATED(void lh_abort(const char *msg, ...));</span>
<a href="#l40.339"></a><span id="l40.339" class="difflineplus">+</span>
<a href="#l40.340"></a><span id="l40.340" class="difflineplus">+/**</span>
<a href="#l40.341"></a><span id="l40.341" class="difflineplus">+ * Resizes the specified table.</span>
<a href="#l40.342"></a><span id="l40.342" class="difflineplus">+ *</span>
<a href="#l40.343"></a><span id="l40.343" class="difflineplus">+ * @param t Pointer to table to resize.</span>
<a href="#l40.344"></a><span id="l40.344" class="difflineplus">+ * @param new_size New table size. Must be positive.</span>
<a href="#l40.345"></a><span id="l40.345" class="difflineplus">+ *</span>
<a href="#l40.346"></a><span id="l40.346" class="difflineplus">+ * @return On success, &lt;code&gt;0&lt;/code&gt; is returned.</span>
<a href="#l40.347"></a><span id="l40.347" class="difflineplus">+ * 	On error, a negative value is returned.</span>
<a href="#l40.348"></a><span id="l40.348" class="difflineplus">+ */</span>
<a href="#l40.349"></a><span id="l40.349" class="difflineplus">+int lh_table_resize(struct lh_table *t, int new_size);</span>
<a href="#l40.350"></a><span id="l40.350" class="difflineplus">+</span>
<a href="#l40.351"></a><span id="l40.351" class="difflineplus">+</span>
<a href="#l40.352"></a><span id="l40.352" class="difflineplus">+/**</span>
<a href="#l40.353"></a><span id="l40.353" class="difflineplus">+ * @deprecated Don't use this outside of linkhash.h:</span>
<a href="#l40.354"></a><span id="l40.354" class="difflineplus">+ */</span>
<a href="#l40.355"></a><span id="l40.355" class="difflineplus">+#if !defined(_MSC_VER) || (_MSC_VER &gt; 1800)</span>
<a href="#l40.356"></a><span id="l40.356" class="difflineplus">+/* VS2010 can't handle inline funcs, so skip it there */</span>
<a href="#l40.357"></a><span id="l40.357" class="difflineplus">+#define _LH_INLINE inline</span>
<a href="#l40.358"></a><span id="l40.358" class="difflineplus">+#else</span>
<a href="#l40.359"></a><span id="l40.359" class="difflineplus">+#define _LH_INLINE</span>
<a href="#l40.360"></a><span id="l40.360" class="difflineplus">+#endif</span>
<a href="#l40.361"></a><span id="l40.361" class="difflineplus">+</span>
<a href="#l40.362"></a><span id="l40.362" class="difflineplus">+/**</span>
<a href="#l40.363"></a><span id="l40.363" class="difflineplus">+ * Calculate the hash of a key for a given table.</span>
<a href="#l40.364"></a><span id="l40.364" class="difflineplus">+ *</span>
<a href="#l40.365"></a><span id="l40.365" class="difflineplus">+ * This is an exension to support functions that need to calculate</span>
<a href="#l40.366"></a><span id="l40.366" class="difflineplus">+ * the hash several times and allows them to do it just once and then pass</span>
<a href="#l40.367"></a><span id="l40.367" class="difflineplus">+ * in the hash to all utility functions. Depending on use case, this can be a</span>
<a href="#l40.368"></a><span id="l40.368" class="difflineplus">+ * considerable performance improvement.</span>
<a href="#l40.369"></a><span id="l40.369" class="difflineplus">+ * @param t the table (used to obtain hash function)</span>
<a href="#l40.370"></a><span id="l40.370" class="difflineplus">+ * @param k a pointer to the key to lookup</span>
<a href="#l40.371"></a><span id="l40.371" class="difflineplus">+ * @return the key's hash</span>
<a href="#l40.372"></a><span id="l40.372" class="difflineplus">+ */</span>
<a href="#l40.373"></a><span id="l40.373" class="difflineplus">+static _LH_INLINE unsigned long lh_get_hash(const struct lh_table *t, const void *k)</span>
<a href="#l40.374"></a><span id="l40.374" class="difflineplus">+{</span>
<a href="#l40.375"></a><span id="l40.375" class="difflineplus">+	return t-&gt;hash_fn(k);</span>
<a href="#l40.376"></a><span id="l40.376" class="difflineplus">+}</span>
<a href="#l40.377"></a><span id="l40.377" class="difflineplus">+</span>
<a href="#l40.378"></a><span id="l40.378" class="difflineplus">+#undef _LH_INLINE</span>
<a href="#l40.379"></a><span id="l40.379" class="difflineplus">+</span>
<a href="#l40.380"></a><span id="l40.380" class="difflineplus">+/**</span>
<a href="#l40.381"></a><span id="l40.381" class="difflineplus">+ * @deprecated Don't use this outside of linkhash.h:</span>
<a href="#l40.382"></a><span id="l40.382" class="difflineplus">+ */</span>
<a href="#l40.383"></a><span id="l40.383" class="difflineplus">+#ifdef __UNCONST</span>
<a href="#l40.384"></a><span id="l40.384" class="difflineplus">+#define _LH_UNCONST(a) __UNCONST(a)</span>
<a href="#l40.385"></a><span id="l40.385" class="difflineplus">+#else</span>
<a href="#l40.386"></a><span id="l40.386" class="difflineplus">+#define _LH_UNCONST(a) ((void *)(uintptr_t)(const void *)(a))</span>
<a href="#l40.387"></a><span id="l40.387" class="difflineplus">+#endif</span>
<a href="#l40.388"></a><span id="l40.388" class="difflineplus">+</span>
<a href="#l40.389"></a><span id="l40.389" class="difflineplus">+/**</span>
<a href="#l40.390"></a><span id="l40.390" class="difflineplus">+ * Return a non-const version of lh_entry.k.</span>
<a href="#l40.391"></a><span id="l40.391" class="difflineplus">+ *</span>
<a href="#l40.392"></a><span id="l40.392" class="difflineplus">+ * lh_entry.k is const to indicate and help ensure that linkhash itself doesn't modify</span>
<a href="#l40.393"></a><span id="l40.393" class="difflineplus">+ * it, but callers are allowed to do what they want with it.</span>
<a href="#l40.394"></a><span id="l40.394" class="difflineplus">+ * See also lh_entry.k_is_constant</span>
<a href="#l40.395"></a><span id="l40.395" class="difflineplus">+ */</span>
<a href="#l40.396"></a><span id="l40.396" class="difflineplus">+#define lh_entry_k(entry) _LH_UNCONST((entry)-&gt;k)</span>
<a href="#l40.397"></a><span id="l40.397" class="difflineplus">+</span>
<a href="#l40.398"></a><span id="l40.398" class="difflineplus">+/**</span>
<a href="#l40.399"></a><span id="l40.399" class="difflineplus">+ * Return a non-const version of lh_entry.v.</span>
<a href="#l40.400"></a><span id="l40.400" class="difflineplus">+ *</span>
<a href="#l40.401"></a><span id="l40.401" class="difflineplus">+ * v is const to indicate and help ensure that linkhash itself doesn't modify</span>
<a href="#l40.402"></a><span id="l40.402" class="difflineplus">+ * it, but callers are allowed to do what they want with it.</span>
<a href="#l40.403"></a><span id="l40.403" class="difflineplus">+ */</span>
<a href="#l40.404"></a><span id="l40.404" class="difflineplus">+#define lh_entry_v(entry) _LH_UNCONST((entry)-&gt;v)</span>
<a href="#l40.405"></a><span id="l40.405" class="difflineplus">+</span>
<a href="#l40.406"></a><span id="l40.406" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l40.407"></a><span id="l40.407" class="difflineplus">+}</span>
<a href="#l40.408"></a><span id="l40.408" class="difflineplus">+#endif</span>
<a href="#l40.409"></a><span id="l40.409" class="difflineplus">+</span>
<a href="#l40.410"></a><span id="l40.410" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1">new file mode 100644</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineminus">--- /dev/null</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineplus">+++ b/third_party/json-c/math_compat.h</span>
<a href="#l41.4"></a><span id="l41.4" class="difflineat">@@ -0,0 +1,36 @@</span>
<a href="#l41.5"></a><span id="l41.5" class="difflineplus">+#ifndef __math_compat_h</span>
<a href="#l41.6"></a><span id="l41.6" class="difflineplus">+#define __math_compat_h</span>
<a href="#l41.7"></a><span id="l41.7" class="difflineplus">+</span>
<a href="#l41.8"></a><span id="l41.8" class="difflineplus">+/**</span>
<a href="#l41.9"></a><span id="l41.9" class="difflineplus">+ * @file</span>
<a href="#l41.10"></a><span id="l41.10" class="difflineplus">+ * @brief Do not use, json-c internal, may be changed or removed at any time.</span>
<a href="#l41.11"></a><span id="l41.11" class="difflineplus">+ */</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineplus">+</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+/* Define isnan, isinf, infinity and nan on Windows/MSVC */</span>
<a href="#l41.14"></a><span id="l41.14" class="difflineplus">+</span>
<a href="#l41.15"></a><span id="l41.15" class="difflineplus">+#ifndef HAVE_DECL_ISNAN</span>
<a href="#l41.16"></a><span id="l41.16" class="difflineplus">+# ifdef HAVE_DECL__ISNAN</span>
<a href="#l41.17"></a><span id="l41.17" class="difflineplus">+#include &lt;float.h&gt;</span>
<a href="#l41.18"></a><span id="l41.18" class="difflineplus">+#define isnan(x) _isnan(x)</span>
<a href="#l41.19"></a><span id="l41.19" class="difflineplus">+# endif</span>
<a href="#l41.20"></a><span id="l41.20" class="difflineplus">+#endif</span>
<a href="#l41.21"></a><span id="l41.21" class="difflineplus">+</span>
<a href="#l41.22"></a><span id="l41.22" class="difflineplus">+#ifndef HAVE_DECL_ISINF</span>
<a href="#l41.23"></a><span id="l41.23" class="difflineplus">+# ifdef HAVE_DECL__FINITE</span>
<a href="#l41.24"></a><span id="l41.24" class="difflineplus">+#include &lt;float.h&gt;</span>
<a href="#l41.25"></a><span id="l41.25" class="difflineplus">+#define isinf(x) (!_finite(x))</span>
<a href="#l41.26"></a><span id="l41.26" class="difflineplus">+# endif</span>
<a href="#l41.27"></a><span id="l41.27" class="difflineplus">+#endif</span>
<a href="#l41.28"></a><span id="l41.28" class="difflineplus">+</span>
<a href="#l41.29"></a><span id="l41.29" class="difflineplus">+#ifndef HAVE_DECL_INFINITY</span>
<a href="#l41.30"></a><span id="l41.30" class="difflineplus">+#include &lt;float.h&gt;</span>
<a href="#l41.31"></a><span id="l41.31" class="difflineplus">+#define INFINITY (DBL_MAX + DBL_MAX)</span>
<a href="#l41.32"></a><span id="l41.32" class="difflineplus">+#define HAVE_DECL_INFINITY</span>
<a href="#l41.33"></a><span id="l41.33" class="difflineplus">+#endif</span>
<a href="#l41.34"></a><span id="l41.34" class="difflineplus">+</span>
<a href="#l41.35"></a><span id="l41.35" class="difflineplus">+#ifndef HAVE_DECL_NAN</span>
<a href="#l41.36"></a><span id="l41.36" class="difflineplus">+#define NAN (INFINITY - INFINITY)</span>
<a href="#l41.37"></a><span id="l41.37" class="difflineplus">+#define HAVE_DECL_NAN</span>
<a href="#l41.38"></a><span id="l41.38" class="difflineplus">+#endif</span>
<a href="#l41.39"></a><span id="l41.39" class="difflineplus">+</span>
<a href="#l41.40"></a><span id="l41.40" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1">new file mode 100644</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineminus">--- /dev/null</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineplus">+++ b/third_party/json-c/printbuf.c</span>
<a href="#l42.4"></a><span id="l42.4" class="difflineat">@@ -0,0 +1,155 @@</span>
<a href="#l42.5"></a><span id="l42.5" class="difflineplus">+/*</span>
<a href="#l42.6"></a><span id="l42.6" class="difflineplus">+ * $Id: printbuf.c,v 1.5 2006/01/26 02:16:28 mclark Exp $</span>
<a href="#l42.7"></a><span id="l42.7" class="difflineplus">+ *</span>
<a href="#l42.8"></a><span id="l42.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l42.9"></a><span id="l42.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l42.10"></a><span id="l42.10" class="difflineplus">+ *</span>
<a href="#l42.11"></a><span id="l42.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+ *</span>
<a href="#l42.14"></a><span id="l42.14" class="difflineplus">+ *</span>
<a href="#l42.15"></a><span id="l42.15" class="difflineplus">+ * Copyright (c) 2008-2009 Yahoo! Inc.  All rights reserved.</span>
<a href="#l42.16"></a><span id="l42.16" class="difflineplus">+ * The copyrights to the contents of this file are licensed under the MIT License</span>
<a href="#l42.17"></a><span id="l42.17" class="difflineplus">+ * (http://www.opensource.org/licenses/mit-license.php)</span>
<a href="#l42.18"></a><span id="l42.18" class="difflineplus">+ */</span>
<a href="#l42.19"></a><span id="l42.19" class="difflineplus">+</span>
<a href="#l42.20"></a><span id="l42.20" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l42.21"></a><span id="l42.21" class="difflineplus">+</span>
<a href="#l42.22"></a><span id="l42.22" class="difflineplus">+#include &lt;stdio.h&gt;</span>
<a href="#l42.23"></a><span id="l42.23" class="difflineplus">+#include &lt;stdlib.h&gt;</span>
<a href="#l42.24"></a><span id="l42.24" class="difflineplus">+#include &lt;string.h&gt;</span>
<a href="#l42.25"></a><span id="l42.25" class="difflineplus">+</span>
<a href="#l42.26"></a><span id="l42.26" class="difflineplus">+#ifdef HAVE_STDARG_H</span>
<a href="#l42.27"></a><span id="l42.27" class="difflineplus">+# include &lt;stdarg.h&gt;</span>
<a href="#l42.28"></a><span id="l42.28" class="difflineplus">+#else /* !HAVE_STDARG_H */</span>
<a href="#l42.29"></a><span id="l42.29" class="difflineplus">+# error Not enough var arg support!</span>
<a href="#l42.30"></a><span id="l42.30" class="difflineplus">+#endif /* HAVE_STDARG_H */</span>
<a href="#l42.31"></a><span id="l42.31" class="difflineplus">+</span>
<a href="#l42.32"></a><span id="l42.32" class="difflineplus">+#include &quot;debug.h&quot;</span>
<a href="#l42.33"></a><span id="l42.33" class="difflineplus">+#include &quot;printbuf.h&quot;</span>
<a href="#l42.34"></a><span id="l42.34" class="difflineplus">+#include &quot;snprintf_compat.h&quot;</span>
<a href="#l42.35"></a><span id="l42.35" class="difflineplus">+#include &quot;vasprintf_compat.h&quot;</span>
<a href="#l42.36"></a><span id="l42.36" class="difflineplus">+</span>
<a href="#l42.37"></a><span id="l42.37" class="difflineplus">+static int printbuf_extend(struct printbuf *p, int min_size);</span>
<a href="#l42.38"></a><span id="l42.38" class="difflineplus">+</span>
<a href="#l42.39"></a><span id="l42.39" class="difflineplus">+struct printbuf* printbuf_new(void)</span>
<a href="#l42.40"></a><span id="l42.40" class="difflineplus">+{</span>
<a href="#l42.41"></a><span id="l42.41" class="difflineplus">+  struct printbuf *p;</span>
<a href="#l42.42"></a><span id="l42.42" class="difflineplus">+</span>
<a href="#l42.43"></a><span id="l42.43" class="difflineplus">+  p = (struct printbuf*)calloc(1, sizeof(struct printbuf));</span>
<a href="#l42.44"></a><span id="l42.44" class="difflineplus">+  if(!p) return NULL;</span>
<a href="#l42.45"></a><span id="l42.45" class="difflineplus">+  p-&gt;size = 32;</span>
<a href="#l42.46"></a><span id="l42.46" class="difflineplus">+  p-&gt;bpos = 0;</span>
<a href="#l42.47"></a><span id="l42.47" class="difflineplus">+  if(!(p-&gt;buf = (char*)malloc(p-&gt;size))) {</span>
<a href="#l42.48"></a><span id="l42.48" class="difflineplus">+    free(p);</span>
<a href="#l42.49"></a><span id="l42.49" class="difflineplus">+    return NULL;</span>
<a href="#l42.50"></a><span id="l42.50" class="difflineplus">+  }</span>
<a href="#l42.51"></a><span id="l42.51" class="difflineplus">+  p-&gt;buf[0]= '\0';</span>
<a href="#l42.52"></a><span id="l42.52" class="difflineplus">+  return p;</span>
<a href="#l42.53"></a><span id="l42.53" class="difflineplus">+}</span>
<a href="#l42.54"></a><span id="l42.54" class="difflineplus">+</span>
<a href="#l42.55"></a><span id="l42.55" class="difflineplus">+</span>
<a href="#l42.56"></a><span id="l42.56" class="difflineplus">+/**</span>
<a href="#l42.57"></a><span id="l42.57" class="difflineplus">+ * Extend the buffer p so it has a size of at least min_size.</span>
<a href="#l42.58"></a><span id="l42.58" class="difflineplus">+ *</span>
<a href="#l42.59"></a><span id="l42.59" class="difflineplus">+ * If the current size is large enough, nothing is changed.</span>
<a href="#l42.60"></a><span id="l42.60" class="difflineplus">+ *</span>
<a href="#l42.61"></a><span id="l42.61" class="difflineplus">+ * Note: this does not check the available space!  The caller</span>
<a href="#l42.62"></a><span id="l42.62" class="difflineplus">+ *  is responsible for performing those calculations.</span>
<a href="#l42.63"></a><span id="l42.63" class="difflineplus">+ */</span>
<a href="#l42.64"></a><span id="l42.64" class="difflineplus">+static int printbuf_extend(struct printbuf *p, int min_size)</span>
<a href="#l42.65"></a><span id="l42.65" class="difflineplus">+{</span>
<a href="#l42.66"></a><span id="l42.66" class="difflineplus">+	char *t;</span>
<a href="#l42.67"></a><span id="l42.67" class="difflineplus">+	int new_size;</span>
<a href="#l42.68"></a><span id="l42.68" class="difflineplus">+</span>
<a href="#l42.69"></a><span id="l42.69" class="difflineplus">+	if (p-&gt;size &gt;= min_size)</span>
<a href="#l42.70"></a><span id="l42.70" class="difflineplus">+		return 0;</span>
<a href="#l42.71"></a><span id="l42.71" class="difflineplus">+</span>
<a href="#l42.72"></a><span id="l42.72" class="difflineplus">+	new_size = p-&gt;size * 2;</span>
<a href="#l42.73"></a><span id="l42.73" class="difflineplus">+	if (new_size &lt; min_size + 8)</span>
<a href="#l42.74"></a><span id="l42.74" class="difflineplus">+		new_size =  min_size + 8;</span>
<a href="#l42.75"></a><span id="l42.75" class="difflineplus">+#ifdef PRINTBUF_DEBUG</span>
<a href="#l42.76"></a><span id="l42.76" class="difflineplus">+	MC_DEBUG(&quot;printbuf_memappend: realloc &quot;</span>
<a href="#l42.77"></a><span id="l42.77" class="difflineplus">+	  &quot;bpos=%d min_size=%d old_size=%d new_size=%d\n&quot;,</span>
<a href="#l42.78"></a><span id="l42.78" class="difflineplus">+	  p-&gt;bpos, min_size, p-&gt;size, new_size);</span>
<a href="#l42.79"></a><span id="l42.79" class="difflineplus">+#endif /* PRINTBUF_DEBUG */</span>
<a href="#l42.80"></a><span id="l42.80" class="difflineplus">+	if(!(t = (char*)realloc(p-&gt;buf, new_size)))</span>
<a href="#l42.81"></a><span id="l42.81" class="difflineplus">+		return -1;</span>
<a href="#l42.82"></a><span id="l42.82" class="difflineplus">+	p-&gt;size = new_size;</span>
<a href="#l42.83"></a><span id="l42.83" class="difflineplus">+	p-&gt;buf = t;</span>
<a href="#l42.84"></a><span id="l42.84" class="difflineplus">+	return 0;</span>
<a href="#l42.85"></a><span id="l42.85" class="difflineplus">+}</span>
<a href="#l42.86"></a><span id="l42.86" class="difflineplus">+</span>
<a href="#l42.87"></a><span id="l42.87" class="difflineplus">+int printbuf_memappend(struct printbuf *p, const char *buf, int size)</span>
<a href="#l42.88"></a><span id="l42.88" class="difflineplus">+{</span>
<a href="#l42.89"></a><span id="l42.89" class="difflineplus">+  if (p-&gt;size &lt;= p-&gt;bpos + size + 1) {</span>
<a href="#l42.90"></a><span id="l42.90" class="difflineplus">+    if (printbuf_extend(p, p-&gt;bpos + size + 1) &lt; 0)</span>
<a href="#l42.91"></a><span id="l42.91" class="difflineplus">+      return -1;</span>
<a href="#l42.92"></a><span id="l42.92" class="difflineplus">+  }</span>
<a href="#l42.93"></a><span id="l42.93" class="difflineplus">+  memcpy(p-&gt;buf + p-&gt;bpos, buf, size);</span>
<a href="#l42.94"></a><span id="l42.94" class="difflineplus">+  p-&gt;bpos += size;</span>
<a href="#l42.95"></a><span id="l42.95" class="difflineplus">+  p-&gt;buf[p-&gt;bpos]= '\0';</span>
<a href="#l42.96"></a><span id="l42.96" class="difflineplus">+  return size;</span>
<a href="#l42.97"></a><span id="l42.97" class="difflineplus">+}</span>
<a href="#l42.98"></a><span id="l42.98" class="difflineplus">+</span>
<a href="#l42.99"></a><span id="l42.99" class="difflineplus">+int printbuf_memset(struct printbuf *pb, int offset, int charvalue, int len)</span>
<a href="#l42.100"></a><span id="l42.100" class="difflineplus">+{</span>
<a href="#l42.101"></a><span id="l42.101" class="difflineplus">+	int size_needed;</span>
<a href="#l42.102"></a><span id="l42.102" class="difflineplus">+</span>
<a href="#l42.103"></a><span id="l42.103" class="difflineplus">+	if (offset == -1)</span>
<a href="#l42.104"></a><span id="l42.104" class="difflineplus">+		offset = pb-&gt;bpos;</span>
<a href="#l42.105"></a><span id="l42.105" class="difflineplus">+	size_needed = offset + len;</span>
<a href="#l42.106"></a><span id="l42.106" class="difflineplus">+	if (pb-&gt;size &lt; size_needed)</span>
<a href="#l42.107"></a><span id="l42.107" class="difflineplus">+	{</span>
<a href="#l42.108"></a><span id="l42.108" class="difflineplus">+		if (printbuf_extend(pb, size_needed) &lt; 0)</span>
<a href="#l42.109"></a><span id="l42.109" class="difflineplus">+			return -1;</span>
<a href="#l42.110"></a><span id="l42.110" class="difflineplus">+	}</span>
<a href="#l42.111"></a><span id="l42.111" class="difflineplus">+</span>
<a href="#l42.112"></a><span id="l42.112" class="difflineplus">+	memset(pb-&gt;buf + offset, charvalue, len);</span>
<a href="#l42.113"></a><span id="l42.113" class="difflineplus">+	if (pb-&gt;bpos &lt; size_needed)</span>
<a href="#l42.114"></a><span id="l42.114" class="difflineplus">+		pb-&gt;bpos = size_needed;</span>
<a href="#l42.115"></a><span id="l42.115" class="difflineplus">+</span>
<a href="#l42.116"></a><span id="l42.116" class="difflineplus">+	return 0;</span>
<a href="#l42.117"></a><span id="l42.117" class="difflineplus">+}</span>
<a href="#l42.118"></a><span id="l42.118" class="difflineplus">+</span>
<a href="#l42.119"></a><span id="l42.119" class="difflineplus">+int sprintbuf(struct printbuf *p, const char *msg, ...)</span>
<a href="#l42.120"></a><span id="l42.120" class="difflineplus">+{</span>
<a href="#l42.121"></a><span id="l42.121" class="difflineplus">+  va_list ap;</span>
<a href="#l42.122"></a><span id="l42.122" class="difflineplus">+  char *t;</span>
<a href="#l42.123"></a><span id="l42.123" class="difflineplus">+  int size;</span>
<a href="#l42.124"></a><span id="l42.124" class="difflineplus">+  char buf[128];</span>
<a href="#l42.125"></a><span id="l42.125" class="difflineplus">+</span>
<a href="#l42.126"></a><span id="l42.126" class="difflineplus">+  /* user stack buffer first */</span>
<a href="#l42.127"></a><span id="l42.127" class="difflineplus">+  va_start(ap, msg);</span>
<a href="#l42.128"></a><span id="l42.128" class="difflineplus">+  size = vsnprintf(buf, 128, msg, ap);</span>
<a href="#l42.129"></a><span id="l42.129" class="difflineplus">+  va_end(ap);</span>
<a href="#l42.130"></a><span id="l42.130" class="difflineplus">+  /* if string is greater than stack buffer, then use dynamic string</span>
<a href="#l42.131"></a><span id="l42.131" class="difflineplus">+     with vasprintf.  Note: some implementation of vsnprintf return -1</span>
<a href="#l42.132"></a><span id="l42.132" class="difflineplus">+     if output is truncated whereas some return the number of bytes that</span>
<a href="#l42.133"></a><span id="l42.133" class="difflineplus">+     would have been written - this code handles both cases. */</span>
<a href="#l42.134"></a><span id="l42.134" class="difflineplus">+  if(size == -1 || size &gt; 127) {</span>
<a href="#l42.135"></a><span id="l42.135" class="difflineplus">+    va_start(ap, msg);</span>
<a href="#l42.136"></a><span id="l42.136" class="difflineplus">+    if((size = vasprintf(&amp;t, msg, ap)) &lt; 0) { va_end(ap); return -1; }</span>
<a href="#l42.137"></a><span id="l42.137" class="difflineplus">+    va_end(ap);</span>
<a href="#l42.138"></a><span id="l42.138" class="difflineplus">+    printbuf_memappend(p, t, size);</span>
<a href="#l42.139"></a><span id="l42.139" class="difflineplus">+    free(t);</span>
<a href="#l42.140"></a><span id="l42.140" class="difflineplus">+    return size;</span>
<a href="#l42.141"></a><span id="l42.141" class="difflineplus">+  } else {</span>
<a href="#l42.142"></a><span id="l42.142" class="difflineplus">+    printbuf_memappend(p, buf, size);</span>
<a href="#l42.143"></a><span id="l42.143" class="difflineplus">+    return size;</span>
<a href="#l42.144"></a><span id="l42.144" class="difflineplus">+  }</span>
<a href="#l42.145"></a><span id="l42.145" class="difflineplus">+}</span>
<a href="#l42.146"></a><span id="l42.146" class="difflineplus">+</span>
<a href="#l42.147"></a><span id="l42.147" class="difflineplus">+void printbuf_reset(struct printbuf *p)</span>
<a href="#l42.148"></a><span id="l42.148" class="difflineplus">+{</span>
<a href="#l42.149"></a><span id="l42.149" class="difflineplus">+  p-&gt;buf[0] = '\0';</span>
<a href="#l42.150"></a><span id="l42.150" class="difflineplus">+  p-&gt;bpos = 0;</span>
<a href="#l42.151"></a><span id="l42.151" class="difflineplus">+}</span>
<a href="#l42.152"></a><span id="l42.152" class="difflineplus">+</span>
<a href="#l42.153"></a><span id="l42.153" class="difflineplus">+void printbuf_free(struct printbuf *p)</span>
<a href="#l42.154"></a><span id="l42.154" class="difflineplus">+{</span>
<a href="#l42.155"></a><span id="l42.155" class="difflineplus">+  if(p) {</span>
<a href="#l42.156"></a><span id="l42.156" class="difflineplus">+    free(p-&gt;buf);</span>
<a href="#l42.157"></a><span id="l42.157" class="difflineplus">+    free(p);</span>
<a href="#l42.158"></a><span id="l42.158" class="difflineplus">+  }</span>
<a href="#l42.159"></a><span id="l42.159" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1">new file mode 100644</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineminus">--- /dev/null</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineplus">+++ b/third_party/json-c/printbuf.h</span>
<a href="#l43.4"></a><span id="l43.4" class="difflineat">@@ -0,0 +1,122 @@</span>
<a href="#l43.5"></a><span id="l43.5" class="difflineplus">+/*</span>
<a href="#l43.6"></a><span id="l43.6" class="difflineplus">+ * $Id: printbuf.h,v 1.4 2006/01/26 02:16:28 mclark Exp $</span>
<a href="#l43.7"></a><span id="l43.7" class="difflineplus">+ *</span>
<a href="#l43.8"></a><span id="l43.8" class="difflineplus">+ * Copyright (c) 2004, 2005 Metaparadigm Pte. Ltd.</span>
<a href="#l43.9"></a><span id="l43.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l43.10"></a><span id="l43.10" class="difflineplus">+ *</span>
<a href="#l43.11"></a><span id="l43.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+ *</span>
<a href="#l43.14"></a><span id="l43.14" class="difflineplus">+ *</span>
<a href="#l43.15"></a><span id="l43.15" class="difflineplus">+ * Copyright (c) 2008-2009 Yahoo! Inc.  All rights reserved.</span>
<a href="#l43.16"></a><span id="l43.16" class="difflineplus">+ * The copyrights to the contents of this file are licensed under the MIT License</span>
<a href="#l43.17"></a><span id="l43.17" class="difflineplus">+ * (http://www.opensource.org/licenses/mit-license.php)</span>
<a href="#l43.18"></a><span id="l43.18" class="difflineplus">+ */</span>
<a href="#l43.19"></a><span id="l43.19" class="difflineplus">+</span>
<a href="#l43.20"></a><span id="l43.20" class="difflineplus">+/**</span>
<a href="#l43.21"></a><span id="l43.21" class="difflineplus">+ * @file</span>
<a href="#l43.22"></a><span id="l43.22" class="difflineplus">+ * @brief Internal string buffer handing.  Unless you're writing a </span>
<a href="#l43.23"></a><span id="l43.23" class="difflineplus">+ *        json_object_to_json_string_fn implementation for use with</span>
<a href="#l43.24"></a><span id="l43.24" class="difflineplus">+ *        json_object_set_serializer() direct use of this is not</span>
<a href="#l43.25"></a><span id="l43.25" class="difflineplus">+ *        recommended.</span>
<a href="#l43.26"></a><span id="l43.26" class="difflineplus">+ */</span>
<a href="#l43.27"></a><span id="l43.27" class="difflineplus">+#ifndef _printbuf_h_</span>
<a href="#l43.28"></a><span id="l43.28" class="difflineplus">+#define _printbuf_h_</span>
<a href="#l43.29"></a><span id="l43.29" class="difflineplus">+</span>
<a href="#l43.30"></a><span id="l43.30" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l43.31"></a><span id="l43.31" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l43.32"></a><span id="l43.32" class="difflineplus">+#endif</span>
<a href="#l43.33"></a><span id="l43.33" class="difflineplus">+</span>
<a href="#l43.34"></a><span id="l43.34" class="difflineplus">+struct printbuf {</span>
<a href="#l43.35"></a><span id="l43.35" class="difflineplus">+  char *buf;</span>
<a href="#l43.36"></a><span id="l43.36" class="difflineplus">+  int bpos;</span>
<a href="#l43.37"></a><span id="l43.37" class="difflineplus">+  int size;</span>
<a href="#l43.38"></a><span id="l43.38" class="difflineplus">+};</span>
<a href="#l43.39"></a><span id="l43.39" class="difflineplus">+typedef struct printbuf printbuf;</span>
<a href="#l43.40"></a><span id="l43.40" class="difflineplus">+</span>
<a href="#l43.41"></a><span id="l43.41" class="difflineplus">+extern struct printbuf*</span>
<a href="#l43.42"></a><span id="l43.42" class="difflineplus">+printbuf_new(void);</span>
<a href="#l43.43"></a><span id="l43.43" class="difflineplus">+</span>
<a href="#l43.44"></a><span id="l43.44" class="difflineplus">+/* As an optimization, printbuf_memappend_fast() is defined as a macro</span>
<a href="#l43.45"></a><span id="l43.45" class="difflineplus">+ * that handles copying data if the buffer is large enough; otherwise</span>
<a href="#l43.46"></a><span id="l43.46" class="difflineplus">+ * it invokes printbuf_memappend() which performs the heavy</span>
<a href="#l43.47"></a><span id="l43.47" class="difflineplus">+ * lifting of realloc()ing the buffer and copying data.</span>
<a href="#l43.48"></a><span id="l43.48" class="difflineplus">+ *</span>
<a href="#l43.49"></a><span id="l43.49" class="difflineplus">+ * Your code should not use printbuf_memappend() directly unless it</span>
<a href="#l43.50"></a><span id="l43.50" class="difflineplus">+ * checks the return code. Use printbuf_memappend_fast() instead.</span>
<a href="#l43.51"></a><span id="l43.51" class="difflineplus">+ */</span>
<a href="#l43.52"></a><span id="l43.52" class="difflineplus">+extern int</span>
<a href="#l43.53"></a><span id="l43.53" class="difflineplus">+printbuf_memappend(struct printbuf *p, const char *buf, int size);</span>
<a href="#l43.54"></a><span id="l43.54" class="difflineplus">+</span>
<a href="#l43.55"></a><span id="l43.55" class="difflineplus">+#define printbuf_memappend_fast(p, bufptr, bufsize)          \</span>
<a href="#l43.56"></a><span id="l43.56" class="difflineplus">+do {                                                         \</span>
<a href="#l43.57"></a><span id="l43.57" class="difflineplus">+  if ((p-&gt;size - p-&gt;bpos) &gt; bufsize) {                       \</span>
<a href="#l43.58"></a><span id="l43.58" class="difflineplus">+    memcpy(p-&gt;buf + p-&gt;bpos, (bufptr), bufsize);             \</span>
<a href="#l43.59"></a><span id="l43.59" class="difflineplus">+    p-&gt;bpos += bufsize;                                      \</span>
<a href="#l43.60"></a><span id="l43.60" class="difflineplus">+    p-&gt;buf[p-&gt;bpos]= '\0';                                   \</span>
<a href="#l43.61"></a><span id="l43.61" class="difflineplus">+  } else {  printbuf_memappend(p, (bufptr), bufsize); }      \</span>
<a href="#l43.62"></a><span id="l43.62" class="difflineplus">+} while (0)</span>
<a href="#l43.63"></a><span id="l43.63" class="difflineplus">+</span>
<a href="#l43.64"></a><span id="l43.64" class="difflineplus">+#define printbuf_length(p) ((p)-&gt;bpos)</span>
<a href="#l43.65"></a><span id="l43.65" class="difflineplus">+</span>
<a href="#l43.66"></a><span id="l43.66" class="difflineplus">+/**</span>
<a href="#l43.67"></a><span id="l43.67" class="difflineplus">+ * Results in a compile error if the argument is not a string literal.</span>
<a href="#l43.68"></a><span id="l43.68" class="difflineplus">+ */</span>
<a href="#l43.69"></a><span id="l43.69" class="difflineplus">+#define _printbuf_check_literal(mystr) (&quot;&quot; mystr)</span>
<a href="#l43.70"></a><span id="l43.70" class="difflineplus">+</span>
<a href="#l43.71"></a><span id="l43.71" class="difflineplus">+/**</span>
<a href="#l43.72"></a><span id="l43.72" class="difflineplus">+ * This is an optimization wrapper around printbuf_memappend() that is useful</span>
<a href="#l43.73"></a><span id="l43.73" class="difflineplus">+ * for appending string literals. Since the size of string constants is known</span>
<a href="#l43.74"></a><span id="l43.74" class="difflineplus">+ * at compile time, using this macro can avoid a costly strlen() call. This is</span>
<a href="#l43.75"></a><span id="l43.75" class="difflineplus">+ * especially helpful when a constant string must be appended many times. If</span>
<a href="#l43.76"></a><span id="l43.76" class="difflineplus">+ * you got here because of a compilation error caused by passing something</span>
<a href="#l43.77"></a><span id="l43.77" class="difflineplus">+ * other than a string literal, use printbuf_memappend_fast() in conjunction</span>
<a href="#l43.78"></a><span id="l43.78" class="difflineplus">+ * with strlen().</span>
<a href="#l43.79"></a><span id="l43.79" class="difflineplus">+ *</span>
<a href="#l43.80"></a><span id="l43.80" class="difflineplus">+ * See also:</span>
<a href="#l43.81"></a><span id="l43.81" class="difflineplus">+ *   printbuf_memappend_fast()</span>
<a href="#l43.82"></a><span id="l43.82" class="difflineplus">+ *   printbuf_memappend()</span>
<a href="#l43.83"></a><span id="l43.83" class="difflineplus">+ *   sprintbuf()</span>
<a href="#l43.84"></a><span id="l43.84" class="difflineplus">+ */</span>
<a href="#l43.85"></a><span id="l43.85" class="difflineplus">+#define printbuf_strappend(pb, str) \</span>
<a href="#l43.86"></a><span id="l43.86" class="difflineplus">+   printbuf_memappend ((pb), _printbuf_check_literal(str), sizeof(str) - 1)</span>
<a href="#l43.87"></a><span id="l43.87" class="difflineplus">+</span>
<a href="#l43.88"></a><span id="l43.88" class="difflineplus">+/**</span>
<a href="#l43.89"></a><span id="l43.89" class="difflineplus">+ * Set len bytes of the buffer to charvalue, starting at offset offset.</span>
<a href="#l43.90"></a><span id="l43.90" class="difflineplus">+ * Similar to calling memset(x, charvalue, len);</span>
<a href="#l43.91"></a><span id="l43.91" class="difflineplus">+ *</span>
<a href="#l43.92"></a><span id="l43.92" class="difflineplus">+ * The memory allocated for the buffer is extended as necessary.</span>
<a href="#l43.93"></a><span id="l43.93" class="difflineplus">+ *</span>
<a href="#l43.94"></a><span id="l43.94" class="difflineplus">+ * If offset is -1, this starts at the end of the current data in the buffer.</span>
<a href="#l43.95"></a><span id="l43.95" class="difflineplus">+ */</span>
<a href="#l43.96"></a><span id="l43.96" class="difflineplus">+extern int</span>
<a href="#l43.97"></a><span id="l43.97" class="difflineplus">+printbuf_memset(struct printbuf *pb, int offset, int charvalue, int len);</span>
<a href="#l43.98"></a><span id="l43.98" class="difflineplus">+</span>
<a href="#l43.99"></a><span id="l43.99" class="difflineplus">+/**</span>
<a href="#l43.100"></a><span id="l43.100" class="difflineplus">+ * Formatted print to printbuf.</span>
<a href="#l43.101"></a><span id="l43.101" class="difflineplus">+ *</span>
<a href="#l43.102"></a><span id="l43.102" class="difflineplus">+ * This function is the most expensive of the available functions for appending</span>
<a href="#l43.103"></a><span id="l43.103" class="difflineplus">+ * string data to a printbuf and should be used only where convenience is more</span>
<a href="#l43.104"></a><span id="l43.104" class="difflineplus">+ * important than speed. Avoid using this function in high performance code or</span>
<a href="#l43.105"></a><span id="l43.105" class="difflineplus">+ * tight loops; in these scenarios, consider using snprintf() with a static</span>
<a href="#l43.106"></a><span id="l43.106" class="difflineplus">+ * buffer in conjunction with one of the printbuf_*append() functions.</span>
<a href="#l43.107"></a><span id="l43.107" class="difflineplus">+ *</span>
<a href="#l43.108"></a><span id="l43.108" class="difflineplus">+ * See also:</span>
<a href="#l43.109"></a><span id="l43.109" class="difflineplus">+ *   printbuf_memappend_fast()</span>
<a href="#l43.110"></a><span id="l43.110" class="difflineplus">+ *   printbuf_memappend()</span>
<a href="#l43.111"></a><span id="l43.111" class="difflineplus">+ *   printbuf_strappend()</span>
<a href="#l43.112"></a><span id="l43.112" class="difflineplus">+ */</span>
<a href="#l43.113"></a><span id="l43.113" class="difflineplus">+extern int</span>
<a href="#l43.114"></a><span id="l43.114" class="difflineplus">+sprintbuf(struct printbuf *p, const char *msg, ...);</span>
<a href="#l43.115"></a><span id="l43.115" class="difflineplus">+</span>
<a href="#l43.116"></a><span id="l43.116" class="difflineplus">+extern void</span>
<a href="#l43.117"></a><span id="l43.117" class="difflineplus">+printbuf_reset(struct printbuf *p);</span>
<a href="#l43.118"></a><span id="l43.118" class="difflineplus">+</span>
<a href="#l43.119"></a><span id="l43.119" class="difflineplus">+extern void</span>
<a href="#l43.120"></a><span id="l43.120" class="difflineplus">+printbuf_free(struct printbuf *p);</span>
<a href="#l43.121"></a><span id="l43.121" class="difflineplus">+</span>
<a href="#l43.122"></a><span id="l43.122" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l43.123"></a><span id="l43.123" class="difflineplus">+}</span>
<a href="#l43.124"></a><span id="l43.124" class="difflineplus">+#endif</span>
<a href="#l43.125"></a><span id="l43.125" class="difflineplus">+</span>
<a href="#l43.126"></a><span id="l43.126" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1">new file mode 100644</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineminus">--- /dev/null</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineplus">+++ b/third_party/json-c/random_seed.c</span>
<a href="#l44.4"></a><span id="l44.4" class="difflineat">@@ -0,0 +1,238 @@</span>
<a href="#l44.5"></a><span id="l44.5" class="difflineplus">+/*</span>
<a href="#l44.6"></a><span id="l44.6" class="difflineplus">+ * random_seed.c</span>
<a href="#l44.7"></a><span id="l44.7" class="difflineplus">+ *</span>
<a href="#l44.8"></a><span id="l44.8" class="difflineplus">+ * Copyright (c) 2013 Metaparadigm Pte. Ltd.</span>
<a href="#l44.9"></a><span id="l44.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l44.10"></a><span id="l44.10" class="difflineplus">+ *</span>
<a href="#l44.11"></a><span id="l44.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+ *</span>
<a href="#l44.14"></a><span id="l44.14" class="difflineplus">+ */</span>
<a href="#l44.15"></a><span id="l44.15" class="difflineplus">+</span>
<a href="#l44.16"></a><span id="l44.16" class="difflineplus">+#include &quot;strerror_override.h&quot;</span>
<a href="#l44.17"></a><span id="l44.17" class="difflineplus">+#include &lt;stdio.h&gt;</span>
<a href="#l44.18"></a><span id="l44.18" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l44.19"></a><span id="l44.19" class="difflineplus">+#include &quot;random_seed.h&quot;</span>
<a href="#l44.20"></a><span id="l44.20" class="difflineplus">+</span>
<a href="#l44.21"></a><span id="l44.21" class="difflineplus">+#define DEBUG_SEED(s)</span>
<a href="#l44.22"></a><span id="l44.22" class="difflineplus">+</span>
<a href="#l44.23"></a><span id="l44.23" class="difflineplus">+</span>
<a href="#l44.24"></a><span id="l44.24" class="difflineplus">+#if defined ENABLE_RDRAND</span>
<a href="#l44.25"></a><span id="l44.25" class="difflineplus">+</span>
<a href="#l44.26"></a><span id="l44.26" class="difflineplus">+/* cpuid */</span>
<a href="#l44.27"></a><span id="l44.27" class="difflineplus">+</span>
<a href="#l44.28"></a><span id="l44.28" class="difflineplus">+#if defined __GNUC__ &amp;&amp; (defined __i386__ || defined __x86_64__)</span>
<a href="#l44.29"></a><span id="l44.29" class="difflineplus">+#define HAS_X86_CPUID 1</span>
<a href="#l44.30"></a><span id="l44.30" class="difflineplus">+</span>
<a href="#l44.31"></a><span id="l44.31" class="difflineplus">+static void do_cpuid(int regs[], int h)</span>
<a href="#l44.32"></a><span id="l44.32" class="difflineplus">+{</span>
<a href="#l44.33"></a><span id="l44.33" class="difflineplus">+    __asm__ __volatile__(</span>
<a href="#l44.34"></a><span id="l44.34" class="difflineplus">+#if defined __x86_64__</span>
<a href="#l44.35"></a><span id="l44.35" class="difflineplus">+                         &quot;pushq %%rbx;\n&quot;</span>
<a href="#l44.36"></a><span id="l44.36" class="difflineplus">+#else</span>
<a href="#l44.37"></a><span id="l44.37" class="difflineplus">+                         &quot;pushl %%ebx;\n&quot;</span>
<a href="#l44.38"></a><span id="l44.38" class="difflineplus">+#endif</span>
<a href="#l44.39"></a><span id="l44.39" class="difflineplus">+                         &quot;cpuid;\n&quot;</span>
<a href="#l44.40"></a><span id="l44.40" class="difflineplus">+#if defined __x86_64__</span>
<a href="#l44.41"></a><span id="l44.41" class="difflineplus">+                         &quot;popq %%rbx;\n&quot;</span>
<a href="#l44.42"></a><span id="l44.42" class="difflineplus">+#else</span>
<a href="#l44.43"></a><span id="l44.43" class="difflineplus">+                         &quot;popl %%ebx;\n&quot;</span>
<a href="#l44.44"></a><span id="l44.44" class="difflineplus">+#endif</span>
<a href="#l44.45"></a><span id="l44.45" class="difflineplus">+                         : &quot;=a&quot;(regs[0]), [ebx] &quot;=r&quot;(regs[1]), &quot;=c&quot;(regs[2]), &quot;=d&quot;(regs[3])</span>
<a href="#l44.46"></a><span id="l44.46" class="difflineplus">+                         : &quot;a&quot;(h));</span>
<a href="#l44.47"></a><span id="l44.47" class="difflineplus">+}</span>
<a href="#l44.48"></a><span id="l44.48" class="difflineplus">+</span>
<a href="#l44.49"></a><span id="l44.49" class="difflineplus">+#elif defined _MSC_VER</span>
<a href="#l44.50"></a><span id="l44.50" class="difflineplus">+</span>
<a href="#l44.51"></a><span id="l44.51" class="difflineplus">+#define HAS_X86_CPUID 1</span>
<a href="#l44.52"></a><span id="l44.52" class="difflineplus">+#define do_cpuid __cpuid</span>
<a href="#l44.53"></a><span id="l44.53" class="difflineplus">+</span>
<a href="#l44.54"></a><span id="l44.54" class="difflineplus">+#endif</span>
<a href="#l44.55"></a><span id="l44.55" class="difflineplus">+</span>
<a href="#l44.56"></a><span id="l44.56" class="difflineplus">+/* has_rdrand */</span>
<a href="#l44.57"></a><span id="l44.57" class="difflineplus">+</span>
<a href="#l44.58"></a><span id="l44.58" class="difflineplus">+#if HAS_X86_CPUID</span>
<a href="#l44.59"></a><span id="l44.59" class="difflineplus">+</span>
<a href="#l44.60"></a><span id="l44.60" class="difflineplus">+static int has_rdrand()</span>
<a href="#l44.61"></a><span id="l44.61" class="difflineplus">+{</span>
<a href="#l44.62"></a><span id="l44.62" class="difflineplus">+    // CPUID.01H:ECX.RDRAND[bit 30] == 1</span>
<a href="#l44.63"></a><span id="l44.63" class="difflineplus">+    int regs[4];</span>
<a href="#l44.64"></a><span id="l44.64" class="difflineplus">+    do_cpuid(regs, 1);</span>
<a href="#l44.65"></a><span id="l44.65" class="difflineplus">+    return (regs[2] &amp; (1 &lt;&lt; 30)) != 0;</span>
<a href="#l44.66"></a><span id="l44.66" class="difflineplus">+}</span>
<a href="#l44.67"></a><span id="l44.67" class="difflineplus">+</span>
<a href="#l44.68"></a><span id="l44.68" class="difflineplus">+#endif</span>
<a href="#l44.69"></a><span id="l44.69" class="difflineplus">+</span>
<a href="#l44.70"></a><span id="l44.70" class="difflineplus">+/* get_rdrand_seed - GCC x86 and X64 */</span>
<a href="#l44.71"></a><span id="l44.71" class="difflineplus">+</span>
<a href="#l44.72"></a><span id="l44.72" class="difflineplus">+#if defined __GNUC__ &amp;&amp; (defined __i386__ || defined __x86_64__)</span>
<a href="#l44.73"></a><span id="l44.73" class="difflineplus">+</span>
<a href="#l44.74"></a><span id="l44.74" class="difflineplus">+#define HAVE_RDRAND 1</span>
<a href="#l44.75"></a><span id="l44.75" class="difflineplus">+</span>
<a href="#l44.76"></a><span id="l44.76" class="difflineplus">+static int get_rdrand_seed()</span>
<a href="#l44.77"></a><span id="l44.77" class="difflineplus">+{</span>
<a href="#l44.78"></a><span id="l44.78" class="difflineplus">+    DEBUG_SEED(&quot;get_rdrand_seed&quot;);</span>
<a href="#l44.79"></a><span id="l44.79" class="difflineplus">+    int _eax;</span>
<a href="#l44.80"></a><span id="l44.80" class="difflineplus">+    // rdrand eax</span>
<a href="#l44.81"></a><span id="l44.81" class="difflineplus">+    __asm__ __volatile__(&quot;1: .byte 0x0F\n&quot;</span>
<a href="#l44.82"></a><span id="l44.82" class="difflineplus">+                         &quot;   .byte 0xC7\n&quot;</span>
<a href="#l44.83"></a><span id="l44.83" class="difflineplus">+                         &quot;   .byte 0xF0\n&quot;</span>
<a href="#l44.84"></a><span id="l44.84" class="difflineplus">+                         &quot;   jnc 1b;\n&quot;</span>
<a href="#l44.85"></a><span id="l44.85" class="difflineplus">+                         : &quot;=a&quot; (_eax));</span>
<a href="#l44.86"></a><span id="l44.86" class="difflineplus">+    return _eax;</span>
<a href="#l44.87"></a><span id="l44.87" class="difflineplus">+}</span>
<a href="#l44.88"></a><span id="l44.88" class="difflineplus">+</span>
<a href="#l44.89"></a><span id="l44.89" class="difflineplus">+#endif</span>
<a href="#l44.90"></a><span id="l44.90" class="difflineplus">+</span>
<a href="#l44.91"></a><span id="l44.91" class="difflineplus">+#if defined _MSC_VER</span>
<a href="#l44.92"></a><span id="l44.92" class="difflineplus">+</span>
<a href="#l44.93"></a><span id="l44.93" class="difflineplus">+#if _MSC_VER &gt;= 1700</span>
<a href="#l44.94"></a><span id="l44.94" class="difflineplus">+#define HAVE_RDRAND 1</span>
<a href="#l44.95"></a><span id="l44.95" class="difflineplus">+</span>
<a href="#l44.96"></a><span id="l44.96" class="difflineplus">+/* get_rdrand_seed - Visual Studio 2012 and above */</span>
<a href="#l44.97"></a><span id="l44.97" class="difflineplus">+</span>
<a href="#l44.98"></a><span id="l44.98" class="difflineplus">+static int get_rdrand_seed()</span>
<a href="#l44.99"></a><span id="l44.99" class="difflineplus">+{</span>
<a href="#l44.100"></a><span id="l44.100" class="difflineplus">+    DEBUG_SEED(&quot;get_rdrand_seed&quot;);</span>
<a href="#l44.101"></a><span id="l44.101" class="difflineplus">+    int r;</span>
<a href="#l44.102"></a><span id="l44.102" class="difflineplus">+    while (_rdrand32_step(&amp;r) == 0);</span>
<a href="#l44.103"></a><span id="l44.103" class="difflineplus">+    return r;</span>
<a href="#l44.104"></a><span id="l44.104" class="difflineplus">+}</span>
<a href="#l44.105"></a><span id="l44.105" class="difflineplus">+</span>
<a href="#l44.106"></a><span id="l44.106" class="difflineplus">+#elif defined _M_IX86</span>
<a href="#l44.107"></a><span id="l44.107" class="difflineplus">+#define HAVE_RDRAND 1</span>
<a href="#l44.108"></a><span id="l44.108" class="difflineplus">+</span>
<a href="#l44.109"></a><span id="l44.109" class="difflineplus">+/* get_rdrand_seed - Visual Studio 2010 and below - x86 only */</span>
<a href="#l44.110"></a><span id="l44.110" class="difflineplus">+</span>
<a href="#l44.111"></a><span id="l44.111" class="difflineplus">+static int get_rdrand_seed()</span>
<a href="#l44.112"></a><span id="l44.112" class="difflineplus">+{</span>
<a href="#l44.113"></a><span id="l44.113" class="difflineplus">+	DEBUG_SEED(&quot;get_rdrand_seed&quot;);</span>
<a href="#l44.114"></a><span id="l44.114" class="difflineplus">+	int _eax;</span>
<a href="#l44.115"></a><span id="l44.115" class="difflineplus">+retry:</span>
<a href="#l44.116"></a><span id="l44.116" class="difflineplus">+	// rdrand eax</span>
<a href="#l44.117"></a><span id="l44.117" class="difflineplus">+	__asm _emit 0x0F __asm _emit 0xC7 __asm _emit 0xF0</span>
<a href="#l44.118"></a><span id="l44.118" class="difflineplus">+	__asm jnc retry</span>
<a href="#l44.119"></a><span id="l44.119" class="difflineplus">+	__asm mov _eax, eax</span>
<a href="#l44.120"></a><span id="l44.120" class="difflineplus">+	return _eax;</span>
<a href="#l44.121"></a><span id="l44.121" class="difflineplus">+}</span>
<a href="#l44.122"></a><span id="l44.122" class="difflineplus">+</span>
<a href="#l44.123"></a><span id="l44.123" class="difflineplus">+#endif</span>
<a href="#l44.124"></a><span id="l44.124" class="difflineplus">+#endif</span>
<a href="#l44.125"></a><span id="l44.125" class="difflineplus">+</span>
<a href="#l44.126"></a><span id="l44.126" class="difflineplus">+#endif /* defined ENABLE_RDRAND */</span>
<a href="#l44.127"></a><span id="l44.127" class="difflineplus">+</span>
<a href="#l44.128"></a><span id="l44.128" class="difflineplus">+</span>
<a href="#l44.129"></a><span id="l44.129" class="difflineplus">+/* has_dev_urandom */</span>
<a href="#l44.130"></a><span id="l44.130" class="difflineplus">+</span>
<a href="#l44.131"></a><span id="l44.131" class="difflineplus">+#if defined (__APPLE__) || defined(__unix__) || defined(__linux__)</span>
<a href="#l44.132"></a><span id="l44.132" class="difflineplus">+</span>
<a href="#l44.133"></a><span id="l44.133" class="difflineplus">+#include &lt;string.h&gt;</span>
<a href="#l44.134"></a><span id="l44.134" class="difflineplus">+#include &lt;fcntl.h&gt;</span>
<a href="#l44.135"></a><span id="l44.135" class="difflineplus">+#include &lt;unistd.h&gt;</span>
<a href="#l44.136"></a><span id="l44.136" class="difflineplus">+#include &lt;stdlib.h&gt;</span>
<a href="#l44.137"></a><span id="l44.137" class="difflineplus">+#include &lt;sys/stat.h&gt;</span>
<a href="#l44.138"></a><span id="l44.138" class="difflineplus">+</span>
<a href="#l44.139"></a><span id="l44.139" class="difflineplus">+#define HAVE_DEV_RANDOM 1</span>
<a href="#l44.140"></a><span id="l44.140" class="difflineplus">+</span>
<a href="#l44.141"></a><span id="l44.141" class="difflineplus">+static const char *dev_random_file = &quot;/dev/urandom&quot;;</span>
<a href="#l44.142"></a><span id="l44.142" class="difflineplus">+</span>
<a href="#l44.143"></a><span id="l44.143" class="difflineplus">+static int has_dev_urandom()</span>
<a href="#l44.144"></a><span id="l44.144" class="difflineplus">+{</span>
<a href="#l44.145"></a><span id="l44.145" class="difflineplus">+    struct stat buf;</span>
<a href="#l44.146"></a><span id="l44.146" class="difflineplus">+    if (stat(dev_random_file, &amp;buf)) {</span>
<a href="#l44.147"></a><span id="l44.147" class="difflineplus">+        return 0;</span>
<a href="#l44.148"></a><span id="l44.148" class="difflineplus">+    }</span>
<a href="#l44.149"></a><span id="l44.149" class="difflineplus">+    return ((buf.st_mode &amp; S_IFCHR) != 0);</span>
<a href="#l44.150"></a><span id="l44.150" class="difflineplus">+}</span>
<a href="#l44.151"></a><span id="l44.151" class="difflineplus">+</span>
<a href="#l44.152"></a><span id="l44.152" class="difflineplus">+</span>
<a href="#l44.153"></a><span id="l44.153" class="difflineplus">+/* get_dev_random_seed */</span>
<a href="#l44.154"></a><span id="l44.154" class="difflineplus">+</span>
<a href="#l44.155"></a><span id="l44.155" class="difflineplus">+static int get_dev_random_seed()</span>
<a href="#l44.156"></a><span id="l44.156" class="difflineplus">+{</span>
<a href="#l44.157"></a><span id="l44.157" class="difflineplus">+    DEBUG_SEED(&quot;get_dev_random_seed&quot;);</span>
<a href="#l44.158"></a><span id="l44.158" class="difflineplus">+</span>
<a href="#l44.159"></a><span id="l44.159" class="difflineplus">+    int fd = open(dev_random_file, O_RDONLY);</span>
<a href="#l44.160"></a><span id="l44.160" class="difflineplus">+    if (fd &lt; 0) {</span>
<a href="#l44.161"></a><span id="l44.161" class="difflineplus">+        fprintf(stderr, &quot;error opening %s: %s&quot;, dev_random_file, strerror(errno));</span>
<a href="#l44.162"></a><span id="l44.162" class="difflineplus">+        exit(1);</span>
<a href="#l44.163"></a><span id="l44.163" class="difflineplus">+    }</span>
<a href="#l44.164"></a><span id="l44.164" class="difflineplus">+</span>
<a href="#l44.165"></a><span id="l44.165" class="difflineplus">+    int r;</span>
<a href="#l44.166"></a><span id="l44.166" class="difflineplus">+    ssize_t nread = read(fd, &amp;r, sizeof(r));</span>
<a href="#l44.167"></a><span id="l44.167" class="difflineplus">+    if (nread != sizeof(r)) {</span>
<a href="#l44.168"></a><span id="l44.168" class="difflineplus">+        fprintf(stderr, &quot;error short read %s: %s&quot;, dev_random_file, strerror(errno));</span>
<a href="#l44.169"></a><span id="l44.169" class="difflineplus">+        exit(1);</span>
<a href="#l44.170"></a><span id="l44.170" class="difflineplus">+    }</span>
<a href="#l44.171"></a><span id="l44.171" class="difflineplus">+</span>
<a href="#l44.172"></a><span id="l44.172" class="difflineplus">+    close(fd);</span>
<a href="#l44.173"></a><span id="l44.173" class="difflineplus">+    return r;</span>
<a href="#l44.174"></a><span id="l44.174" class="difflineplus">+}</span>
<a href="#l44.175"></a><span id="l44.175" class="difflineplus">+</span>
<a href="#l44.176"></a><span id="l44.176" class="difflineplus">+#endif</span>
<a href="#l44.177"></a><span id="l44.177" class="difflineplus">+</span>
<a href="#l44.178"></a><span id="l44.178" class="difflineplus">+</span>
<a href="#l44.179"></a><span id="l44.179" class="difflineplus">+/* get_cryptgenrandom_seed */</span>
<a href="#l44.180"></a><span id="l44.180" class="difflineplus">+</span>
<a href="#l44.181"></a><span id="l44.181" class="difflineplus">+#ifdef WIN32</span>
<a href="#l44.182"></a><span id="l44.182" class="difflineplus">+</span>
<a href="#l44.183"></a><span id="l44.183" class="difflineplus">+#define HAVE_CRYPTGENRANDOM 1</span>
<a href="#l44.184"></a><span id="l44.184" class="difflineplus">+</span>
<a href="#l44.185"></a><span id="l44.185" class="difflineplus">+#include &lt;windows.h&gt;</span>
<a href="#l44.186"></a><span id="l44.186" class="difflineplus">+#include &lt;wincrypt.h&gt;</span>
<a href="#l44.187"></a><span id="l44.187" class="difflineplus">+#ifndef __GNUC__</span>
<a href="#l44.188"></a><span id="l44.188" class="difflineplus">+#pragma comment(lib, &quot;advapi32.lib&quot;)</span>
<a href="#l44.189"></a><span id="l44.189" class="difflineplus">+#endif</span>
<a href="#l44.190"></a><span id="l44.190" class="difflineplus">+</span>
<a href="#l44.191"></a><span id="l44.191" class="difflineplus">+static int get_cryptgenrandom_seed()</span>
<a href="#l44.192"></a><span id="l44.192" class="difflineplus">+{</span>
<a href="#l44.193"></a><span id="l44.193" class="difflineplus">+    HCRYPTPROV hProvider = 0;</span>
<a href="#l44.194"></a><span id="l44.194" class="difflineplus">+    int r;</span>
<a href="#l44.195"></a><span id="l44.195" class="difflineplus">+</span>
<a href="#l44.196"></a><span id="l44.196" class="difflineplus">+    DEBUG_SEED(&quot;get_cryptgenrandom_seed&quot;);</span>
<a href="#l44.197"></a><span id="l44.197" class="difflineplus">+</span>
<a href="#l44.198"></a><span id="l44.198" class="difflineplus">+    if (!CryptAcquireContextW(&amp;hProvider, 0, 0, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT | CRYPT_SILENT)) {</span>
<a href="#l44.199"></a><span id="l44.199" class="difflineplus">+        fprintf(stderr, &quot;error CryptAcquireContextW&quot;);</span>
<a href="#l44.200"></a><span id="l44.200" class="difflineplus">+        exit(1);</span>
<a href="#l44.201"></a><span id="l44.201" class="difflineplus">+    }</span>
<a href="#l44.202"></a><span id="l44.202" class="difflineplus">+</span>
<a href="#l44.203"></a><span id="l44.203" class="difflineplus">+    if (!CryptGenRandom(hProvider, sizeof(r), (BYTE*)&amp;r)) {</span>
<a href="#l44.204"></a><span id="l44.204" class="difflineplus">+        fprintf(stderr, &quot;error CryptGenRandom&quot;);</span>
<a href="#l44.205"></a><span id="l44.205" class="difflineplus">+        exit(1);</span>
<a href="#l44.206"></a><span id="l44.206" class="difflineplus">+    }</span>
<a href="#l44.207"></a><span id="l44.207" class="difflineplus">+</span>
<a href="#l44.208"></a><span id="l44.208" class="difflineplus">+    CryptReleaseContext(hProvider, 0);</span>
<a href="#l44.209"></a><span id="l44.209" class="difflineplus">+</span>
<a href="#l44.210"></a><span id="l44.210" class="difflineplus">+    return r;</span>
<a href="#l44.211"></a><span id="l44.211" class="difflineplus">+}</span>
<a href="#l44.212"></a><span id="l44.212" class="difflineplus">+</span>
<a href="#l44.213"></a><span id="l44.213" class="difflineplus">+#endif</span>
<a href="#l44.214"></a><span id="l44.214" class="difflineplus">+</span>
<a href="#l44.215"></a><span id="l44.215" class="difflineplus">+</span>
<a href="#l44.216"></a><span id="l44.216" class="difflineplus">+/* get_time_seed */</span>
<a href="#l44.217"></a><span id="l44.217" class="difflineplus">+</span>
<a href="#l44.218"></a><span id="l44.218" class="difflineplus">+#include &lt;time.h&gt;</span>
<a href="#l44.219"></a><span id="l44.219" class="difflineplus">+</span>
<a href="#l44.220"></a><span id="l44.220" class="difflineplus">+static int get_time_seed()</span>
<a href="#l44.221"></a><span id="l44.221" class="difflineplus">+{</span>
<a href="#l44.222"></a><span id="l44.222" class="difflineplus">+    DEBUG_SEED(&quot;get_time_seed&quot;);</span>
<a href="#l44.223"></a><span id="l44.223" class="difflineplus">+</span>
<a href="#l44.224"></a><span id="l44.224" class="difflineplus">+    return (int)time(NULL) * 433494437;</span>
<a href="#l44.225"></a><span id="l44.225" class="difflineplus">+}</span>
<a href="#l44.226"></a><span id="l44.226" class="difflineplus">+</span>
<a href="#l44.227"></a><span id="l44.227" class="difflineplus">+</span>
<a href="#l44.228"></a><span id="l44.228" class="difflineplus">+/* json_c_get_random_seed */</span>
<a href="#l44.229"></a><span id="l44.229" class="difflineplus">+</span>
<a href="#l44.230"></a><span id="l44.230" class="difflineplus">+int json_c_get_random_seed()</span>
<a href="#l44.231"></a><span id="l44.231" class="difflineplus">+{</span>
<a href="#l44.232"></a><span id="l44.232" class="difflineplus">+#if HAVE_RDRAND</span>
<a href="#l44.233"></a><span id="l44.233" class="difflineplus">+    if (has_rdrand()) return get_rdrand_seed();</span>
<a href="#l44.234"></a><span id="l44.234" class="difflineplus">+#endif</span>
<a href="#l44.235"></a><span id="l44.235" class="difflineplus">+#if HAVE_DEV_RANDOM</span>
<a href="#l44.236"></a><span id="l44.236" class="difflineplus">+    if (has_dev_urandom()) return get_dev_random_seed();</span>
<a href="#l44.237"></a><span id="l44.237" class="difflineplus">+#endif</span>
<a href="#l44.238"></a><span id="l44.238" class="difflineplus">+#if HAVE_CRYPTGENRANDOM</span>
<a href="#l44.239"></a><span id="l44.239" class="difflineplus">+    return get_cryptgenrandom_seed();</span>
<a href="#l44.240"></a><span id="l44.240" class="difflineplus">+#endif</span>
<a href="#l44.241"></a><span id="l44.241" class="difflineplus">+    return get_time_seed();</span>
<a href="#l44.242"></a><span id="l44.242" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1">new file mode 100644</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineminus">--- /dev/null</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineplus">+++ b/third_party/json-c/random_seed.h</span>
<a href="#l45.4"></a><span id="l45.4" class="difflineat">@@ -0,0 +1,29 @@</span>
<a href="#l45.5"></a><span id="l45.5" class="difflineplus">+/*</span>
<a href="#l45.6"></a><span id="l45.6" class="difflineplus">+ * random_seed.h</span>
<a href="#l45.7"></a><span id="l45.7" class="difflineplus">+ *</span>
<a href="#l45.8"></a><span id="l45.8" class="difflineplus">+ * Copyright (c) 2013 Metaparadigm Pte. Ltd.</span>
<a href="#l45.9"></a><span id="l45.9" class="difflineplus">+ * Michael Clark &lt;michael@metaparadigm.com&gt;</span>
<a href="#l45.10"></a><span id="l45.10" class="difflineplus">+ *</span>
<a href="#l45.11"></a><span id="l45.11" class="difflineplus">+ * This library is free software; you can redistribute it and/or modify</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineplus">+ * it under the terms of the MIT license. See COPYING for details.</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+ *</span>
<a href="#l45.14"></a><span id="l45.14" class="difflineplus">+ */</span>
<a href="#l45.15"></a><span id="l45.15" class="difflineplus">+</span>
<a href="#l45.16"></a><span id="l45.16" class="difflineplus">+/**</span>
<a href="#l45.17"></a><span id="l45.17" class="difflineplus">+ * @file</span>
<a href="#l45.18"></a><span id="l45.18" class="difflineplus">+ * @brief Do not use, json-c internal, may be changed or removed at any time.</span>
<a href="#l45.19"></a><span id="l45.19" class="difflineplus">+ */</span>
<a href="#l45.20"></a><span id="l45.20" class="difflineplus">+#ifndef seed_h</span>
<a href="#l45.21"></a><span id="l45.21" class="difflineplus">+#define seed_h</span>
<a href="#l45.22"></a><span id="l45.22" class="difflineplus">+</span>
<a href="#l45.23"></a><span id="l45.23" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l45.24"></a><span id="l45.24" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l45.25"></a><span id="l45.25" class="difflineplus">+#endif</span>
<a href="#l45.26"></a><span id="l45.26" class="difflineplus">+</span>
<a href="#l45.27"></a><span id="l45.27" class="difflineplus">+extern int json_c_get_random_seed();</span>
<a href="#l45.28"></a><span id="l45.28" class="difflineplus">+</span>
<a href="#l45.29"></a><span id="l45.29" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l45.30"></a><span id="l45.30" class="difflineplus">+}</span>
<a href="#l45.31"></a><span id="l45.31" class="difflineplus">+#endif</span>
<a href="#l45.32"></a><span id="l45.32" class="difflineplus">+</span>
<a href="#l45.33"></a><span id="l45.33" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1">new file mode 100644</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineminus">--- /dev/null</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineplus">+++ b/third_party/json-c/snprintf_compat.h</span>
<a href="#l46.4"></a><span id="l46.4" class="difflineat">@@ -0,0 +1,41 @@</span>
<a href="#l46.5"></a><span id="l46.5" class="difflineplus">+#ifndef __snprintf_compat_h</span>
<a href="#l46.6"></a><span id="l46.6" class="difflineplus">+#define __snprintf_compat_h</span>
<a href="#l46.7"></a><span id="l46.7" class="difflineplus">+</span>
<a href="#l46.8"></a><span id="l46.8" class="difflineplus">+/**</span>
<a href="#l46.9"></a><span id="l46.9" class="difflineplus">+ * @file</span>
<a href="#l46.10"></a><span id="l46.10" class="difflineplus">+ * @brief Do not use, json-c internal, may be changed or removed at any time.</span>
<a href="#l46.11"></a><span id="l46.11" class="difflineplus">+ */</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineplus">+</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineplus">+/*</span>
<a href="#l46.14"></a><span id="l46.14" class="difflineplus">+ * Microsoft's _vsnprintf and _snprint don't always terminate</span>
<a href="#l46.15"></a><span id="l46.15" class="difflineplus">+ * the string, so use wrappers that ensure that.</span>
<a href="#l46.16"></a><span id="l46.16" class="difflineplus">+ */</span>
<a href="#l46.17"></a><span id="l46.17" class="difflineplus">+</span>
<a href="#l46.18"></a><span id="l46.18" class="difflineplus">+#include &lt;stdarg.h&gt;</span>
<a href="#l46.19"></a><span id="l46.19" class="difflineplus">+</span>
<a href="#l46.20"></a><span id="l46.20" class="difflineplus">+#if !defined(HAVE_SNPRINTF) &amp;&amp; defined(_MSC_VER)</span>
<a href="#l46.21"></a><span id="l46.21" class="difflineplus">+static int json_c_vsnprintf(char *str, size_t size, const char *format, va_list ap)</span>
<a href="#l46.22"></a><span id="l46.22" class="difflineplus">+{</span>
<a href="#l46.23"></a><span id="l46.23" class="difflineplus">+	int ret;</span>
<a href="#l46.24"></a><span id="l46.24" class="difflineplus">+	ret = _vsnprintf(str, size, format, ap);</span>
<a href="#l46.25"></a><span id="l46.25" class="difflineplus">+	str[size - 1] = '\0';</span>
<a href="#l46.26"></a><span id="l46.26" class="difflineplus">+	return ret;</span>
<a href="#l46.27"></a><span id="l46.27" class="difflineplus">+}</span>
<a href="#l46.28"></a><span id="l46.28" class="difflineplus">+#define vsnprintf json_c_vsnprintf</span>
<a href="#l46.29"></a><span id="l46.29" class="difflineplus">+</span>
<a href="#l46.30"></a><span id="l46.30" class="difflineplus">+static int json_c_snprintf(char *str, size_t size, const char *format, ...)</span>
<a href="#l46.31"></a><span id="l46.31" class="difflineplus">+{</span>
<a href="#l46.32"></a><span id="l46.32" class="difflineplus">+	va_list ap;</span>
<a href="#l46.33"></a><span id="l46.33" class="difflineplus">+	int ret;</span>
<a href="#l46.34"></a><span id="l46.34" class="difflineplus">+	va_start(ap, format);</span>
<a href="#l46.35"></a><span id="l46.35" class="difflineplus">+	ret = json_c_vsnprintf(str, size, format, ap);</span>
<a href="#l46.36"></a><span id="l46.36" class="difflineplus">+	va_end(ap);</span>
<a href="#l46.37"></a><span id="l46.37" class="difflineplus">+	return ret;</span>
<a href="#l46.38"></a><span id="l46.38" class="difflineplus">+}</span>
<a href="#l46.39"></a><span id="l46.39" class="difflineplus">+#define snprintf json_c_snprintf</span>
<a href="#l46.40"></a><span id="l46.40" class="difflineplus">+</span>
<a href="#l46.41"></a><span id="l46.41" class="difflineplus">+#elif !defined(HAVE_SNPRINTF) /* !HAVE_SNPRINTF */</span>
<a href="#l46.42"></a><span id="l46.42" class="difflineplus">+# error Need vsnprintf!</span>
<a href="#l46.43"></a><span id="l46.43" class="difflineplus">+#endif /* !HAVE_SNPRINTF &amp;&amp; defined(WIN32) */</span>
<a href="#l46.44"></a><span id="l46.44" class="difflineplus">+</span>
<a href="#l46.45"></a><span id="l46.45" class="difflineplus">+#endif /* __snprintf_compat_h */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1">new file mode 100644</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineminus">--- /dev/null</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineplus">+++ b/third_party/json-c/strdup_compat.h</span>
<a href="#l47.4"></a><span id="l47.4" class="difflineat">@@ -0,0 +1,16 @@</span>
<a href="#l47.5"></a><span id="l47.5" class="difflineplus">+#ifndef __strdup_compat_h</span>
<a href="#l47.6"></a><span id="l47.6" class="difflineplus">+#define __strdup_compat_h</span>
<a href="#l47.7"></a><span id="l47.7" class="difflineplus">+</span>
<a href="#l47.8"></a><span id="l47.8" class="difflineplus">+/**</span>
<a href="#l47.9"></a><span id="l47.9" class="difflineplus">+ * @file</span>
<a href="#l47.10"></a><span id="l47.10" class="difflineplus">+ * @brief Do not use, json-c internal, may be changed or removed at any time.</span>
<a href="#l47.11"></a><span id="l47.11" class="difflineplus">+ */</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineplus">+</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineplus">+#if !defined(HAVE_STRDUP) &amp;&amp; defined(_MSC_VER)</span>
<a href="#l47.14"></a><span id="l47.14" class="difflineplus">+  /* MSC has the version as _strdup */</span>
<a href="#l47.15"></a><span id="l47.15" class="difflineplus">+# define strdup _strdup</span>
<a href="#l47.16"></a><span id="l47.16" class="difflineplus">+#elif !defined(HAVE_STRDUP)</span>
<a href="#l47.17"></a><span id="l47.17" class="difflineplus">+# error You do not have strdup on your system.</span>
<a href="#l47.18"></a><span id="l47.18" class="difflineplus">+#endif /* HAVE_STRDUP */</span>
<a href="#l47.19"></a><span id="l47.19" class="difflineplus">+</span>
<a href="#l47.20"></a><span id="l47.20" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1">new file mode 100644</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineminus">--- /dev/null</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineplus">+++ b/third_party/json-c/strerror_override.c</span>
<a href="#l48.4"></a><span id="l48.4" class="difflineat">@@ -0,0 +1,101 @@</span>
<a href="#l48.5"></a><span id="l48.5" class="difflineplus">+#define STRERROR_OVERRIDE_IMPL 1</span>
<a href="#l48.6"></a><span id="l48.6" class="difflineplus">+#include &quot;strerror_override.h&quot;</span>
<a href="#l48.7"></a><span id="l48.7" class="difflineplus">+</span>
<a href="#l48.8"></a><span id="l48.8" class="difflineplus">+/*</span>
<a href="#l48.9"></a><span id="l48.9" class="difflineplus">+ * Override strerror() to get consistent output across platforms.</span>
<a href="#l48.10"></a><span id="l48.10" class="difflineplus">+ */</span>
<a href="#l48.11"></a><span id="l48.11" class="difflineplus">+</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineplus">+static struct {</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineplus">+	int errno_value;</span>
<a href="#l48.14"></a><span id="l48.14" class="difflineplus">+	const char *errno_str;</span>
<a href="#l48.15"></a><span id="l48.15" class="difflineplus">+} errno_list[] = {</span>
<a href="#l48.16"></a><span id="l48.16" class="difflineplus">+#define STRINGIFY(x) #x</span>
<a href="#l48.17"></a><span id="l48.17" class="difflineplus">+#define ENTRY(x) {x, &amp;STRINGIFY(undef_ ## x)[6]}</span>
<a href="#l48.18"></a><span id="l48.18" class="difflineplus">+	ENTRY(EPERM),</span>
<a href="#l48.19"></a><span id="l48.19" class="difflineplus">+	ENTRY(ENOENT),</span>
<a href="#l48.20"></a><span id="l48.20" class="difflineplus">+	ENTRY(ESRCH),</span>
<a href="#l48.21"></a><span id="l48.21" class="difflineplus">+	ENTRY(EINTR),</span>
<a href="#l48.22"></a><span id="l48.22" class="difflineplus">+	ENTRY(EIO),</span>
<a href="#l48.23"></a><span id="l48.23" class="difflineplus">+	ENTRY(ENXIO),</span>
<a href="#l48.24"></a><span id="l48.24" class="difflineplus">+	ENTRY(E2BIG),</span>
<a href="#l48.25"></a><span id="l48.25" class="difflineplus">+	ENTRY(ENOEXEC),</span>
<a href="#l48.26"></a><span id="l48.26" class="difflineplus">+	ENTRY(EBADF),</span>
<a href="#l48.27"></a><span id="l48.27" class="difflineplus">+	ENTRY(ECHILD),</span>
<a href="#l48.28"></a><span id="l48.28" class="difflineplus">+	ENTRY(EDEADLK),</span>
<a href="#l48.29"></a><span id="l48.29" class="difflineplus">+	ENTRY(ENOMEM),</span>
<a href="#l48.30"></a><span id="l48.30" class="difflineplus">+	ENTRY(EACCES),</span>
<a href="#l48.31"></a><span id="l48.31" class="difflineplus">+	ENTRY(EFAULT),</span>
<a href="#l48.32"></a><span id="l48.32" class="difflineplus">+#ifdef ENOTBLK</span>
<a href="#l48.33"></a><span id="l48.33" class="difflineplus">+	ENTRY(ENOTBLK),</span>
<a href="#l48.34"></a><span id="l48.34" class="difflineplus">+#endif</span>
<a href="#l48.35"></a><span id="l48.35" class="difflineplus">+	ENTRY(EBUSY),</span>
<a href="#l48.36"></a><span id="l48.36" class="difflineplus">+	ENTRY(EEXIST),</span>
<a href="#l48.37"></a><span id="l48.37" class="difflineplus">+	ENTRY(EXDEV),</span>
<a href="#l48.38"></a><span id="l48.38" class="difflineplus">+	ENTRY(ENODEV),</span>
<a href="#l48.39"></a><span id="l48.39" class="difflineplus">+	ENTRY(ENOTDIR),</span>
<a href="#l48.40"></a><span id="l48.40" class="difflineplus">+	ENTRY(EISDIR),</span>
<a href="#l48.41"></a><span id="l48.41" class="difflineplus">+	ENTRY(EINVAL),</span>
<a href="#l48.42"></a><span id="l48.42" class="difflineplus">+	ENTRY(ENFILE),</span>
<a href="#l48.43"></a><span id="l48.43" class="difflineplus">+	ENTRY(EMFILE),</span>
<a href="#l48.44"></a><span id="l48.44" class="difflineplus">+	ENTRY(ENOTTY),</span>
<a href="#l48.45"></a><span id="l48.45" class="difflineplus">+#ifdef ETXTBSY</span>
<a href="#l48.46"></a><span id="l48.46" class="difflineplus">+	ENTRY(ETXTBSY),</span>
<a href="#l48.47"></a><span id="l48.47" class="difflineplus">+#endif</span>
<a href="#l48.48"></a><span id="l48.48" class="difflineplus">+	ENTRY(EFBIG),</span>
<a href="#l48.49"></a><span id="l48.49" class="difflineplus">+	ENTRY(ENOSPC),</span>
<a href="#l48.50"></a><span id="l48.50" class="difflineplus">+	ENTRY(ESPIPE),</span>
<a href="#l48.51"></a><span id="l48.51" class="difflineplus">+	ENTRY(EROFS),</span>
<a href="#l48.52"></a><span id="l48.52" class="difflineplus">+	ENTRY(EMLINK),</span>
<a href="#l48.53"></a><span id="l48.53" class="difflineplus">+	ENTRY(EPIPE),</span>
<a href="#l48.54"></a><span id="l48.54" class="difflineplus">+	ENTRY(EDOM),</span>
<a href="#l48.55"></a><span id="l48.55" class="difflineplus">+	ENTRY(ERANGE),</span>
<a href="#l48.56"></a><span id="l48.56" class="difflineplus">+	ENTRY(EAGAIN),</span>
<a href="#l48.57"></a><span id="l48.57" class="difflineplus">+	{ 0, (char *)0 }</span>
<a href="#l48.58"></a><span id="l48.58" class="difflineplus">+};</span>
<a href="#l48.59"></a><span id="l48.59" class="difflineplus">+</span>
<a href="#l48.60"></a><span id="l48.60" class="difflineplus">+// Enabled during tests</span>
<a href="#l48.61"></a><span id="l48.61" class="difflineplus">+int _json_c_strerror_enable = 0;</span>
<a href="#l48.62"></a><span id="l48.62" class="difflineplus">+</span>
<a href="#l48.63"></a><span id="l48.63" class="difflineplus">+#define PREFIX &quot;ERRNO=&quot;</span>
<a href="#l48.64"></a><span id="l48.64" class="difflineplus">+static char errno_buf[128] = PREFIX;</span>
<a href="#l48.65"></a><span id="l48.65" class="difflineplus">+char *_json_c_strerror(int errno_in)</span>
<a href="#l48.66"></a><span id="l48.66" class="difflineplus">+{</span>
<a href="#l48.67"></a><span id="l48.67" class="difflineplus">+	int start_idx;</span>
<a href="#l48.68"></a><span id="l48.68" class="difflineplus">+	char digbuf[20];</span>
<a href="#l48.69"></a><span id="l48.69" class="difflineplus">+	int ii, jj;</span>
<a href="#l48.70"></a><span id="l48.70" class="difflineplus">+</span>
<a href="#l48.71"></a><span id="l48.71" class="difflineplus">+	if (!_json_c_strerror_enable)</span>
<a href="#l48.72"></a><span id="l48.72" class="difflineplus">+		return strerror(errno_in);</span>
<a href="#l48.73"></a><span id="l48.73" class="difflineplus">+</span>
<a href="#l48.74"></a><span id="l48.74" class="difflineplus">+	// Avoid standard functions, so we don't need to include any</span>
<a href="#l48.75"></a><span id="l48.75" class="difflineplus">+	// headers, or guess at signatures.</span>
<a href="#l48.76"></a><span id="l48.76" class="difflineplus">+</span>
<a href="#l48.77"></a><span id="l48.77" class="difflineplus">+	for (ii = 0; errno_list[ii].errno_str != (char *)0; ii++)</span>
<a href="#l48.78"></a><span id="l48.78" class="difflineplus">+	{</span>
<a href="#l48.79"></a><span id="l48.79" class="difflineplus">+		const char *errno_str = errno_list[ii].errno_str;</span>
<a href="#l48.80"></a><span id="l48.80" class="difflineplus">+		if (errno_list[ii].errno_value != errno_in)</span>
<a href="#l48.81"></a><span id="l48.81" class="difflineplus">+			continue;</span>
<a href="#l48.82"></a><span id="l48.82" class="difflineplus">+</span>
<a href="#l48.83"></a><span id="l48.83" class="difflineplus">+		for (start_idx = sizeof(PREFIX) - 1, jj = 0; errno_str[jj] != '\0'; jj++, start_idx++)</span>
<a href="#l48.84"></a><span id="l48.84" class="difflineplus">+		{</span>
<a href="#l48.85"></a><span id="l48.85" class="difflineplus">+			errno_buf[start_idx] = errno_str[jj];</span>
<a href="#l48.86"></a><span id="l48.86" class="difflineplus">+		}</span>
<a href="#l48.87"></a><span id="l48.87" class="difflineplus">+		errno_buf[start_idx] = '\0';</span>
<a href="#l48.88"></a><span id="l48.88" class="difflineplus">+		return errno_buf;</span>
<a href="#l48.89"></a><span id="l48.89" class="difflineplus">+	}</span>
<a href="#l48.90"></a><span id="l48.90" class="difflineplus">+</span>
<a href="#l48.91"></a><span id="l48.91" class="difflineplus">+	// It's not one of the known errno values, return the numeric value.</span>
<a href="#l48.92"></a><span id="l48.92" class="difflineplus">+	for (ii = 0; errno_in &gt; 10; errno_in /= 10, ii++)</span>
<a href="#l48.93"></a><span id="l48.93" class="difflineplus">+	{</span>
<a href="#l48.94"></a><span id="l48.94" class="difflineplus">+		digbuf[ii] = &quot;0123456789&quot;[(errno_in % 10)];</span>
<a href="#l48.95"></a><span id="l48.95" class="difflineplus">+	}</span>
<a href="#l48.96"></a><span id="l48.96" class="difflineplus">+	digbuf[ii] = &quot;0123456789&quot;[(errno_in % 10)];</span>
<a href="#l48.97"></a><span id="l48.97" class="difflineplus">+</span>
<a href="#l48.98"></a><span id="l48.98" class="difflineplus">+	// Reverse the digits</span>
<a href="#l48.99"></a><span id="l48.99" class="difflineplus">+	for (start_idx = sizeof(PREFIX) - 1 ; ii &gt;= 0; ii--, start_idx++)</span>
<a href="#l48.100"></a><span id="l48.100" class="difflineplus">+	{</span>
<a href="#l48.101"></a><span id="l48.101" class="difflineplus">+		errno_buf[start_idx] = digbuf[ii];</span>
<a href="#l48.102"></a><span id="l48.102" class="difflineplus">+	}</span>
<a href="#l48.103"></a><span id="l48.103" class="difflineplus">+	return errno_buf;</span>
<a href="#l48.104"></a><span id="l48.104" class="difflineplus">+}</span>
<a href="#l48.105"></a><span id="l48.105" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1">new file mode 100644</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineminus">--- /dev/null</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineplus">+++ b/third_party/json-c/strerror_override.h</span>
<a href="#l49.4"></a><span id="l49.4" class="difflineat">@@ -0,0 +1,30 @@</span>
<a href="#l49.5"></a><span id="l49.5" class="difflineplus">+#ifndef _json_strerror_override_h_</span>
<a href="#l49.6"></a><span id="l49.6" class="difflineplus">+#define _json_strerror_override_h_</span>
<a href="#l49.7"></a><span id="l49.7" class="difflineplus">+</span>
<a href="#l49.8"></a><span id="l49.8" class="difflineplus">+/**</span>
<a href="#l49.9"></a><span id="l49.9" class="difflineplus">+ * @file</span>
<a href="#l49.10"></a><span id="l49.10" class="difflineplus">+ * @brief Do not use, json-c internal, may be changed or removed at any time.</span>
<a href="#l49.11"></a><span id="l49.11" class="difflineplus">+ */</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineplus">+</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineplus">+#include &quot;config.h&quot;</span>
<a href="#l49.14"></a><span id="l49.14" class="difflineplus">+#include &lt;errno.h&gt;</span>
<a href="#l49.15"></a><span id="l49.15" class="difflineplus">+</span>
<a href="#l49.16"></a><span id="l49.16" class="difflineplus">+#include &quot;json_object.h&quot; /* for JSON_EXPORT */</span>
<a href="#l49.17"></a><span id="l49.17" class="difflineplus">+</span>
<a href="#l49.18"></a><span id="l49.18" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l49.19"></a><span id="l49.19" class="difflineplus">+extern &quot;C&quot; {</span>
<a href="#l49.20"></a><span id="l49.20" class="difflineplus">+#endif</span>
<a href="#l49.21"></a><span id="l49.21" class="difflineplus">+</span>
<a href="#l49.22"></a><span id="l49.22" class="difflineplus">+#include &lt;string.h&gt;</span>
<a href="#l49.23"></a><span id="l49.23" class="difflineplus">+</span>
<a href="#l49.24"></a><span id="l49.24" class="difflineplus">+JSON_EXPORT char *_json_c_strerror(int errno_in);</span>
<a href="#l49.25"></a><span id="l49.25" class="difflineplus">+</span>
<a href="#l49.26"></a><span id="l49.26" class="difflineplus">+#ifndef STRERROR_OVERRIDE_IMPL</span>
<a href="#l49.27"></a><span id="l49.27" class="difflineplus">+#define strerror	_json_c_strerror</span>
<a href="#l49.28"></a><span id="l49.28" class="difflineplus">+#endif</span>
<a href="#l49.29"></a><span id="l49.29" class="difflineplus">+</span>
<a href="#l49.30"></a><span id="l49.30" class="difflineplus">+#ifdef __cplusplus</span>
<a href="#l49.31"></a><span id="l49.31" class="difflineplus">+}</span>
<a href="#l49.32"></a><span id="l49.32" class="difflineplus">+#endif</span>
<a href="#l49.33"></a><span id="l49.33" class="difflineplus">+</span>
<a href="#l49.34"></a><span id="l49.34" class="difflineplus">+#endif /* _json_strerror_override_h_ */ </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1">new file mode 100644</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineminus">--- /dev/null</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineplus">+++ b/third_party/json-c/strerror_override_private.h</span>
<a href="#l50.4"></a><span id="l50.4" class="difflineat">@@ -0,0 +1,12 @@</span>
<a href="#l50.5"></a><span id="l50.5" class="difflineplus">+#ifndef __json_strerror_override_private_h__</span>
<a href="#l50.6"></a><span id="l50.6" class="difflineplus">+#define __json_strerror_override_private_h__</span>
<a href="#l50.7"></a><span id="l50.7" class="difflineplus">+</span>
<a href="#l50.8"></a><span id="l50.8" class="difflineplus">+/**</span>
<a href="#l50.9"></a><span id="l50.9" class="difflineplus">+ * @file</span>
<a href="#l50.10"></a><span id="l50.10" class="difflineplus">+ * @brief Do not use, json-c internal, may be changed or removed at any time.</span>
<a href="#l50.11"></a><span id="l50.11" class="difflineplus">+ */</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineplus">+</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+/* Used by tests to get consistent output */</span>
<a href="#l50.14"></a><span id="l50.14" class="difflineplus">+extern int _json_c_strerror_enable;</span>
<a href="#l50.15"></a><span id="l50.15" class="difflineplus">+</span>
<a href="#l50.16"></a><span id="l50.16" class="difflineplus">+#endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1">new file mode 100644</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineminus">--- /dev/null</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineplus">+++ b/third_party/json-c/vasprintf_compat.h</span>
<a href="#l51.4"></a><span id="l51.4" class="difflineat">@@ -0,0 +1,46 @@</span>
<a href="#l51.5"></a><span id="l51.5" class="difflineplus">+#ifndef __vasprintf_compat_h</span>
<a href="#l51.6"></a><span id="l51.6" class="difflineplus">+#define __vasprintf_compat_h</span>
<a href="#l51.7"></a><span id="l51.7" class="difflineplus">+</span>
<a href="#l51.8"></a><span id="l51.8" class="difflineplus">+/**</span>
<a href="#l51.9"></a><span id="l51.9" class="difflineplus">+ * @file</span>
<a href="#l51.10"></a><span id="l51.10" class="difflineplus">+ * @brief Do not use, json-c internal, may be changed or removed at any time.</span>
<a href="#l51.11"></a><span id="l51.11" class="difflineplus">+ */</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineplus">+</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineplus">+#include &quot;snprintf_compat.h&quot;</span>
<a href="#l51.14"></a><span id="l51.14" class="difflineplus">+</span>
<a href="#l51.15"></a><span id="l51.15" class="difflineplus">+#if !defined(HAVE_VASPRINTF)</span>
<a href="#l51.16"></a><span id="l51.16" class="difflineplus">+/* CAW: compliant version of vasprintf */</span>
<a href="#l51.17"></a><span id="l51.17" class="difflineplus">+static int vasprintf(char **buf, const char *fmt, va_list ap)</span>
<a href="#l51.18"></a><span id="l51.18" class="difflineplus">+{</span>
<a href="#l51.19"></a><span id="l51.19" class="difflineplus">+#ifndef WIN32</span>
<a href="#l51.20"></a><span id="l51.20" class="difflineplus">+	static char _T_emptybuffer = '\0';</span>
<a href="#l51.21"></a><span id="l51.21" class="difflineplus">+#endif /* !defined(WIN32) */</span>
<a href="#l51.22"></a><span id="l51.22" class="difflineplus">+	int chars;</span>
<a href="#l51.23"></a><span id="l51.23" class="difflineplus">+	char *b;</span>
<a href="#l51.24"></a><span id="l51.24" class="difflineplus">+</span>
<a href="#l51.25"></a><span id="l51.25" class="difflineplus">+	if(!buf) { return -1; }</span>
<a href="#l51.26"></a><span id="l51.26" class="difflineplus">+</span>
<a href="#l51.27"></a><span id="l51.27" class="difflineplus">+#ifdef WIN32</span>
<a href="#l51.28"></a><span id="l51.28" class="difflineplus">+	chars = _vscprintf(fmt, ap)+1;</span>
<a href="#l51.29"></a><span id="l51.29" class="difflineplus">+#else /* !defined(WIN32) */</span>
<a href="#l51.30"></a><span id="l51.30" class="difflineplus">+	/* CAW: RAWR! We have to hope to god here that vsnprintf doesn't overwrite</span>
<a href="#l51.31"></a><span id="l51.31" class="difflineplus">+	   our buffer like on some 64bit sun systems.... but hey, its time to move on */</span>
<a href="#l51.32"></a><span id="l51.32" class="difflineplus">+	chars = vsnprintf(&amp;_T_emptybuffer, 0, fmt, ap)+1;</span>
<a href="#l51.33"></a><span id="l51.33" class="difflineplus">+	if(chars &lt; 0) { chars *= -1; } /* CAW: old glibc versions have this problem */</span>
<a href="#l51.34"></a><span id="l51.34" class="difflineplus">+#endif /* defined(WIN32) */</span>
<a href="#l51.35"></a><span id="l51.35" class="difflineplus">+</span>
<a href="#l51.36"></a><span id="l51.36" class="difflineplus">+	b = (char*)malloc(sizeof(char)*chars);</span>
<a href="#l51.37"></a><span id="l51.37" class="difflineplus">+	if(!b) { return -1; }</span>
<a href="#l51.38"></a><span id="l51.38" class="difflineplus">+</span>
<a href="#l51.39"></a><span id="l51.39" class="difflineplus">+	if((chars = vsprintf(b, fmt, ap)) &lt; 0)</span>
<a href="#l51.40"></a><span id="l51.40" class="difflineplus">+	{</span>
<a href="#l51.41"></a><span id="l51.41" class="difflineplus">+		free(b);</span>
<a href="#l51.42"></a><span id="l51.42" class="difflineplus">+	} else {</span>
<a href="#l51.43"></a><span id="l51.43" class="difflineplus">+		*buf = b;</span>
<a href="#l51.44"></a><span id="l51.44" class="difflineplus">+	}</span>
<a href="#l51.45"></a><span id="l51.45" class="difflineplus">+</span>
<a href="#l51.46"></a><span id="l51.46" class="difflineplus">+	return chars;</span>
<a href="#l51.47"></a><span id="l51.47" class="difflineplus">+}</span>
<a href="#l51.48"></a><span id="l51.48" class="difflineplus">+#endif /* !HAVE_VASPRINTF */</span>
<a href="#l51.49"></a><span id="l51.49" class="difflineplus">+</span>
<a href="#l51.50"></a><span id="l51.50" class="difflineplus">+#endif /* __vasprintf_compat_h */</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:31Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

