<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 3386:d6e41eeedfa8b77619906c815fff2570ab621937</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ d6e41eeedfa8b77619906c815fff2570ab621937" />
<meta property="og:url" content="/comm-central/rev/d6e41eeedfa8b77619906c815fff2570ab621937" />
<meta property="og:description" content="Bug 507601 - Port |Bug 414038 - Replace rdf-driven folder pane with a js-driven/non-rdf treeview| to SeaMonkey; (Av1a) Remove GetFolderAttribute() + Bug 439839; r=iann_bugzilla" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / d6e41eeedfa8b77619906c815fff2570ab621937 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/d6e41eeedfa8b77619906c815fff2570ab621937">shortlog</a> |
<a href="/comm-central/log/d6e41eeedfa8b77619906c815fff2570ab621937">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/d6e41eeedfa8b77619906c815fff2570ab621937">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/d6e41eeedfa8b77619906c815fff2570ab621937">files</a> |
changeset |
<a href="/comm-central/raw-rev/d6e41eeedfa8b77619906c815fff2570ab621937">raw</a>  | <a href="/comm-central/archive/d6e41eeedfa8b77619906c815fff2570ab621937.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=507601">Bug 507601</a> - Port |<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=414038">Bug 414038</a> - Replace rdf-driven folder pane with a js-driven/non-rdf treeview| to SeaMonkey; (Av1a) Remove GetFolderAttribute() + <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=439839">Bug 439839</a>; r=iann_bugzilla
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#83;&#101;&#114;&#103;&#101;&#32;&#71;&#97;&#117;&#116;&#104;&#101;&#114;&#105;&#101;&#32;&#60;&#115;&#103;&#97;&#117;&#116;&#104;&#101;&#114;&#105;&#101;&#46;&#98;&#122;&#64;&#102;&#114;&#101;&#101;&#46;&#102;&#114;&#62;</td></tr>
<tr><td></td><td class="date age">Mon, 24 Aug 2009 04:04:23 +0200</td></tr>

<tr>
 <td>changeset 3386</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/d6e41eeedfa8b77619906c815fff2570ab621937">d6e41eeedfa8b77619906c815fff2570ab621937</a></td>
</tr>



<tr>
<td>parent 3385</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/45cd7a8e23e56131d38a72123b40072702bb9332">45cd7a8e23e56131d38a72123b40072702bb9332</a>
</td>
</tr>

<tr>
<td>child 3387</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/a23c5d7a07668ceeda1ae09efec4b06a6961e863">a23c5d7a07668ceeda1ae09efec4b06a6961e863</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=d6e41eeedfa8b77619906c815fff2570ab621937">2751</a></td></tr>
<tr><td>push user</td><td>sgautherie.bz@free.fr</td></tr>
<tr><td>push date</td><td class="date age">Mon, 24 Aug 2009 02:09:59 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@a23c5d7a0766 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a23c5d7a07668ceeda1ae09efec4b06a6961e863">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a23c5d7a07668ceeda1ae09efec4b06a6961e863&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a23c5d7a07668ceeda1ae09efec4b06a6961e863&newProject=comm-central&newRevision=d6e41eeedfa8b77619906c815fff2570ab621937&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a23c5d7a07668ceeda1ae09efec4b06a6961e863&newProject=comm-central&newRevision=d6e41eeedfa8b77619906c815fff2570ab621937&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a23c5d7a07668ceeda1ae09efec4b06a6961e863&newProject=comm-central&newRevision=d6e41eeedfa8b77619906c815fff2570ab621937&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28iann_bugzilla%29&revcount=50">iann_bugzilla</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=507601">507601</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=414038">414038</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=439839">439839</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=507601">Bug 507601</a> - Port |<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=414038">Bug 414038</a> - Replace rdf-driven folder pane with a js-driven/non-rdf treeview| to SeaMonkey; (Av1a) Remove GetFolderAttribute() + <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=439839">Bug 439839</a>; r=iann_bugzilla

<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=439839">Bug 439839</a> - Next and previous keyboard shortcuts and menus broken</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mail3PaneWindowCommands.js">suite/mailnews/mail3PaneWindowCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mail3PaneWindowCommands.js">file</a> |
<a href="/comm-central/annotate/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mail3PaneWindowCommands.js">annotate</a> |
<a href="/comm-central/diff/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mail3PaneWindowCommands.js">diff</a> |
<a href="/comm-central/comparison/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mail3PaneWindowCommands.js">comparison</a> |
<a href="/comm-central/log/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mail3PaneWindowCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mailContextMenus.js">suite/mailnews/mailContextMenus.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mailContextMenus.js">file</a> |
<a href="/comm-central/annotate/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mailContextMenus.js">annotate</a> |
<a href="/comm-central/diff/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mailContextMenus.js">diff</a> |
<a href="/comm-central/comparison/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mailContextMenus.js">comparison</a> |
<a href="/comm-central/log/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/mailContextMenus.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/msgMail3PaneWindow.js">suite/mailnews/msgMail3PaneWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/msgMail3PaneWindow.js">file</a> |
<a href="/comm-central/annotate/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/msgMail3PaneWindow.js">annotate</a> |
<a href="/comm-central/diff/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/msgMail3PaneWindow.js">diff</a> |
<a href="/comm-central/comparison/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/msgMail3PaneWindow.js">comparison</a> |
<a href="/comm-central/log/d6e41eeedfa8b77619906c815fff2570ab621937/suite/mailnews/msgMail3PaneWindow.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/suite/mailnews/mail3PaneWindowCommands.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/suite/mailnews/mail3PaneWindowCommands.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -83,35 +83,34 @@ var FolderPaneController =</span>
<a href="#l1.4"></a><span id="l1.4">       var folderTree = GetFolderTree();</span>
<a href="#l1.5"></a><span id="l1.5">       var startIndex = {};</span>
<a href="#l1.6"></a><span id="l1.6">       var endIndex = {};</span>
<a href="#l1.7"></a><span id="l1.7">       folderTree.view.selection.getRangeAt(0, startIndex, endIndex);</span>
<a href="#l1.8"></a><span id="l1.8">       if (startIndex.value &gt;= 0) {</span>
<a href="#l1.9"></a><span id="l1.9">         var canDeleteThisFolder;</span>
<a href="#l1.10"></a><span id="l1.10"> 				var specialFolder = null;</span>
<a href="#l1.11"></a><span id="l1.11"> 				var isServer = null;</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-				var serverType = null;</span>
<a href="#l1.13"></a><span id="l1.13"> 				try {</span>
<a href="#l1.14"></a><span id="l1.14">           var folderResource = GetFolderResource(folderTree, startIndex.value);</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-          specialFolder = GetFolderAttribute(folderTree, folderResource, &quot;SpecialFolder&quot;);</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-          isServer = GetFolderAttribute(folderTree, folderResource, &quot;IsServer&quot;);</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-          serverType = GetFolderAttribute(folderTree, folderResource, &quot;ServerType&quot;);</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-          if (serverType == &quot;nntp&quot;) {</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineplus">+          let folder = folderResource.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineplus">+          specialFolder = getSpecialFolderString(folder);</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineplus">+          isServer = folder.isServer;</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineplus">+          if (folder.server.type == &quot;nntp&quot;) {</span>
<a href="#l1.23"></a><span id="l1.23"> 			     	if ( command == &quot;cmd_delete&quot; ) {</span>
<a href="#l1.24"></a><span id="l1.24"> 					      goSetMenuValue(command, 'valueNewsgroup');</span>
<a href="#l1.25"></a><span id="l1.25"> 				    	  goSetAccessKey(command, 'valueNewsgroupAccessKey');</span>
<a href="#l1.26"></a><span id="l1.26">             }</span>
<a href="#l1.27"></a><span id="l1.27">           }</span>
<a href="#l1.28"></a><span id="l1.28"> 				}</span>
<a href="#l1.29"></a><span id="l1.29"> 				catch (ex) {</span>
<a href="#l1.30"></a><span id="l1.30"> 					//dump(&quot;specialFolder failure: &quot; + ex + &quot;\n&quot;);</span>
<a href="#l1.31"></a><span id="l1.31"> 				} </span>
<a href="#l1.32"></a><span id="l1.32">         if (specialFolder == &quot;Inbox&quot; || specialFolder == &quot;Trash&quot; || specialFolder == &quot;Drafts&quot; ||</span>
<a href="#l1.33"></a><span id="l1.33">             specialFolder == &quot;Sent&quot; || specialFolder == &quot;Templates&quot; || specialFolder == &quot;Unsent Messages&quot; ||</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-            (specialFolder == &quot;Junk&quot; &amp;&amp; !CanRenameDeleteJunkMail(GetSelectedFolderURI())) || isServer == &quot;true&quot;)</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineplus">+            (specialFolder == &quot;Junk&quot; &amp;&amp; !CanRenameDeleteJunkMail(GetSelectedFolderURI())) || isServer)</span>
<a href="#l1.36"></a><span id="l1.36">           canDeleteThisFolder = false;</span>
<a href="#l1.37"></a><span id="l1.37">         else</span>
<a href="#l1.38"></a><span id="l1.38">           canDeleteThisFolder = true;</span>
<a href="#l1.39"></a><span id="l1.39">         return canDeleteThisFolder &amp;&amp; isCommandEnabled(command);</span>
<a href="#l1.40"></a><span id="l1.40">       }</span>
<a href="#l1.41"></a><span id="l1.41"> 			else</span>
<a href="#l1.42"></a><span id="l1.42"> 				return false;</span>
<a href="#l1.43"></a><span id="l1.43"> </span>
<a href="#l1.44"></a><span id="l1.44" class="difflineat">@@ -868,18 +867,18 @@ function IsRenameFolderEnabled()</span>
<a href="#l1.45"></a><span id="l1.45">     var folderTree = GetFolderTree();</span>
<a href="#l1.46"></a><span id="l1.46">     var selection = folderTree.view.selection;</span>
<a href="#l1.47"></a><span id="l1.47">     if (selection.count == 1)</span>
<a href="#l1.48"></a><span id="l1.48">     {</span>
<a href="#l1.49"></a><span id="l1.49">         var startIndex = {};</span>
<a href="#l1.50"></a><span id="l1.50">         var endIndex = {};</span>
<a href="#l1.51"></a><span id="l1.51">         selection.getRangeAt(0, startIndex, endIndex);</span>
<a href="#l1.52"></a><span id="l1.52">         var folderResource = GetFolderResource(folderTree, startIndex.value);</span>
<a href="#l1.53"></a><span id="l1.53" class="difflineminus">-        var canRename = GetFolderAttribute(folderTree, folderResource, &quot;CanRename&quot;) == &quot;true&quot;;</span>
<a href="#l1.54"></a><span id="l1.54" class="difflineminus">-        return canRename &amp;&amp; isCommandEnabled(&quot;cmd_renameFolder&quot;);</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineplus">+        let folder = folderResource.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l1.56"></a><span id="l1.56" class="difflineplus">+        return folder.canRename &amp;&amp; isCommandEnabled(&quot;cmd_renameFolder&quot;);</span>
<a href="#l1.57"></a><span id="l1.57">     }</span>
<a href="#l1.58"></a><span id="l1.58">     else</span>
<a href="#l1.59"></a><span id="l1.59">         return false;</span>
<a href="#l1.60"></a><span id="l1.60"> }</span>
<a href="#l1.61"></a><span id="l1.61"> </span>
<a href="#l1.62"></a><span id="l1.62"> function IsCanSearchMessagesEnabled()</span>
<a href="#l1.63"></a><span id="l1.63"> {</span>
<a href="#l1.64"></a><span id="l1.64">   var folderURI = GetSelectedFolderURI();</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineat">@@ -897,20 +896,21 @@ function IsFolderCharsetEnabled()</span>
<a href="#l1.66"></a><span id="l1.66"> }</span>
<a href="#l1.67"></a><span id="l1.67"> </span>
<a href="#l1.68"></a><span id="l1.68"> function IsPropertiesEnabled(command)</span>
<a href="#l1.69"></a><span id="l1.69"> {</span>
<a href="#l1.70"></a><span id="l1.70">    try </span>
<a href="#l1.71"></a><span id="l1.71">    {</span>
<a href="#l1.72"></a><span id="l1.72">       var folderTree = GetFolderTree();</span>
<a href="#l1.73"></a><span id="l1.73">       var folderResource = GetSelectedFolderResource();</span>
<a href="#l1.74"></a><span id="l1.74" class="difflineplus">+      let folder = folderResource.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l1.75"></a><span id="l1.75"> </span>
<a href="#l1.76"></a><span id="l1.76">       // when servers are selected</span>
<a href="#l1.77"></a><span id="l1.77">       // it should be &quot;Edit | Properties...&quot;</span>
<a href="#l1.78"></a><span id="l1.78" class="difflineminus">-      if (GetFolderAttribute(folderTree, folderResource, &quot;IsServer&quot;) == &quot;true&quot;)</span>
<a href="#l1.79"></a><span id="l1.79" class="difflineplus">+      if (folder.isServer)</span>
<a href="#l1.80"></a><span id="l1.80">         goSetMenuValue(command, &quot;valueGeneric&quot;);</span>
<a href="#l1.81"></a><span id="l1.81">       else </span>
<a href="#l1.82"></a><span id="l1.82">         goSetMenuValue(command, isNewsURI(folderResource.Value) ? &quot;valueNewsgroup&quot; : &quot;valueFolder&quot;);</span>
<a href="#l1.83"></a><span id="l1.83">    }</span>
<a href="#l1.84"></a><span id="l1.84">    catch (ex) </span>
<a href="#l1.85"></a><span id="l1.85">    {</span>
<a href="#l1.86"></a><span id="l1.86">       // properties menu failure</span>
<a href="#l1.87"></a><span id="l1.87">    }</span>
<a href="#l1.88"></a><span id="l1.88" class="difflineat">@@ -929,17 +929,18 @@ function IsFolderSelected()</span>
<a href="#l1.89"></a><span id="l1.89">     var folderTree = GetFolderTree();</span>
<a href="#l1.90"></a><span id="l1.90">     var selection = folderTree.view.selection;</span>
<a href="#l1.91"></a><span id="l1.91">     if (selection.count == 1)</span>
<a href="#l1.92"></a><span id="l1.92">     {</span>
<a href="#l1.93"></a><span id="l1.93">         var startIndex = {};</span>
<a href="#l1.94"></a><span id="l1.94">         var endIndex = {};</span>
<a href="#l1.95"></a><span id="l1.95">         selection.getRangeAt(0, startIndex, endIndex);</span>
<a href="#l1.96"></a><span id="l1.96">         var folderResource = GetFolderResource(folderTree, startIndex.value);</span>
<a href="#l1.97"></a><span id="l1.97" class="difflineminus">-        return GetFolderAttribute(folderTree, folderResource, &quot;IsServer&quot;) != &quot;true&quot;;</span>
<a href="#l1.98"></a><span id="l1.98" class="difflineplus">+        let folder = folderResource.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l1.99"></a><span id="l1.99" class="difflineplus">+        return !folder.isServer;</span>
<a href="#l1.100"></a><span id="l1.100">     }</span>
<a href="#l1.101"></a><span id="l1.101">     else</span>
<a href="#l1.102"></a><span id="l1.102">         return false;</span>
<a href="#l1.103"></a><span id="l1.103"> }</span>
<a href="#l1.104"></a><span id="l1.104"> </span>
<a href="#l1.105"></a><span id="l1.105"> function IsMessageDisplayedInMessagePane()</span>
<a href="#l1.106"></a><span id="l1.106"> {</span>
<a href="#l1.107"></a><span id="l1.107">   return (!IsMessagePaneCollapsed() &amp;&amp; (GetNumSelectedMessages() &gt; 0));</span>
<a href="#l1.108"></a><span id="l1.108" class="difflineat">@@ -947,18 +948,17 @@ function IsMessageDisplayedInMessagePane</span>
<a href="#l1.109"></a><span id="l1.109"> </span>
<a href="#l1.110"></a><span id="l1.110"> function MsgDeleteFolder()</span>
<a href="#l1.111"></a><span id="l1.111"> {</span>
<a href="#l1.112"></a><span id="l1.112">     var folderTree = GetFolderTree();</span>
<a href="#l1.113"></a><span id="l1.113">     var selectedFolders = GetSelectedMsgFolders();</span>
<a href="#l1.114"></a><span id="l1.114">     for (var i = 0; i &lt; selectedFolders.length; i++)</span>
<a href="#l1.115"></a><span id="l1.115">     {</span>
<a href="#l1.116"></a><span id="l1.116">         var selectedFolder = selectedFolders[i];</span>
<a href="#l1.117"></a><span id="l1.117" class="difflineminus">-        var folderResource = selectedFolder.QueryInterface(Components.interfaces.nsIRDFResource);</span>
<a href="#l1.118"></a><span id="l1.118" class="difflineminus">-        var specialFolder = GetFolderAttribute(folderTree, folderResource, &quot;SpecialFolder&quot;);</span>
<a href="#l1.119"></a><span id="l1.119" class="difflineplus">+        let specialFolder = getSpecialFolderString(selectedFolder);</span>
<a href="#l1.120"></a><span id="l1.120">         if (specialFolder != &quot;Inbox&quot; &amp;&amp; specialFolder != &quot;Trash&quot;)</span>
<a href="#l1.121"></a><span id="l1.121">         {</span>
<a href="#l1.122"></a><span id="l1.122">             var folder = selectedFolder.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l1.123"></a><span id="l1.123">             if (folder.flags &amp; Components.interfaces.nsMsgFolderFlags.Virtual)</span>
<a href="#l1.124"></a><span id="l1.124">             {</span>
<a href="#l1.125"></a><span id="l1.125">                 if (gCurrentVirtualFolderUri == selectedFolder.URI)</span>
<a href="#l1.126"></a><span id="l1.126">                   gCurrentVirtualFolderUri = null;</span>
<a href="#l1.127"></a><span id="l1.127">                 var array = Components.classes[&quot;@mozilla.org/array;1&quot;]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/suite/mailnews/mailContextMenus.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/suite/mailnews/mailContextMenus.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -220,20 +220,21 @@ function FillFolderPaneContextMenu()</span>
<a href="#l2.4"></a><span id="l2.4">   var folderTree = GetFolderTree();</span>
<a href="#l2.5"></a><span id="l2.5">   var startIndex = {};</span>
<a href="#l2.6"></a><span id="l2.6">   var endIndex = {};</span>
<a href="#l2.7"></a><span id="l2.7">   folderTree.view.selection.getRangeAt(0, startIndex, endIndex);</span>
<a href="#l2.8"></a><span id="l2.8">   if (startIndex.value &lt; 0)</span>
<a href="#l2.9"></a><span id="l2.9">     return false;</span>
<a href="#l2.10"></a><span id="l2.10">   var numSelected = endIndex.value - startIndex.value + 1;</span>
<a href="#l2.11"></a><span id="l2.11">   var folderResource = GetFolderResource(folderTree, startIndex.value);</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+  let folder = GetMsgFolderFromUri(folderResource.Value, false);</span>
<a href="#l2.13"></a><span id="l2.13"> </span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-  var isServer = GetFolderAttribute(folderTree, folderResource, &quot;IsServer&quot;) == 'true';</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineminus">-  var serverType = GetFolderAttribute(folderTree, folderResource, &quot;ServerType&quot;);</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineminus">-  var specialFolder = GetFolderAttribute(folderTree, folderResource, &quot;SpecialFolder&quot;);</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+  let isServer = folder.isServer;</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+  let serverType = folder.server.type;</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+  let specialFolder = getSpecialFolderString(folder);</span>
<a href="#l2.20"></a><span id="l2.20">   var canSubscribeToFolder = (serverType == &quot;nntp&quot;) ||</span>
<a href="#l2.21"></a><span id="l2.21">                              (serverType == &quot;imap&quot;) ||</span>
<a href="#l2.22"></a><span id="l2.22">                              (serverType == &quot;rss&quot;);</span>
<a href="#l2.23"></a><span id="l2.23">   var isNewsgroup = !isServer &amp;&amp; serverType == 'nntp';</span>
<a href="#l2.24"></a><span id="l2.24">   var isMailFolder = !isServer &amp;&amp; serverType != 'nntp';</span>
<a href="#l2.25"></a><span id="l2.25">   var isVirtualFolder = (specialFolder == &quot;Virtual&quot;);</span>
<a href="#l2.26"></a><span id="l2.26">   const kTrashFlag = Components.interfaces.nsMsgFolderFlags.Trash;</span>
<a href="#l2.27"></a><span id="l2.27">   var msgFolder =</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineat">@@ -309,29 +310,25 @@ function FillFolderPaneContextMenu()</span>
<a href="#l2.29"></a><span id="l2.29">   goUpdateCommand('cmd_search');</span>
<a href="#l2.30"></a><span id="l2.30"> </span>
<a href="#l2.31"></a><span id="l2.31">   return(true);</span>
<a href="#l2.32"></a><span id="l2.32"> }</span>
<a href="#l2.33"></a><span id="l2.33"> </span>
<a href="#l2.34"></a><span id="l2.34"> function SetupRenameMenuItem(folderResource, numSelected, isServer, serverType, specialFolder)</span>
<a href="#l2.35"></a><span id="l2.35"> {</span>
<a href="#l2.36"></a><span id="l2.36">   var msgFolder = folderResource.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineminus">-  var folderTree = GetFolderTree();</span>
<a href="#l2.38"></a><span id="l2.38">   var isSpecialFolder = !(specialFolder == &quot;none&quot; || (specialFolder == &quot;Junk&quot; &amp;&amp; CanRenameDeleteJunkMail(msgFolder.URI))</span>
<a href="#l2.39"></a><span id="l2.39">                                                   || (specialFolder == &quot;Virtual&quot;));</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineminus">-  var canRename = GetFolderAttribute(folderTree, folderResource, &quot;CanRename&quot;) == &quot;true&quot;;</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineminus">-</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineplus">+  let canRename = msgFolder.canRename;</span>
<a href="#l2.43"></a><span id="l2.43">   ShowMenuItem(&quot;folderPaneContext-rename&quot;, (numSelected &lt;= 1) &amp;&amp; !isServer &amp;&amp; !isSpecialFolder &amp;&amp; canRename);</span>
<a href="#l2.44"></a><span id="l2.44">   var folder = GetMsgFolderFromResource(folderResource);</span>
<a href="#l2.45"></a><span id="l2.45">   EnableMenuItem(&quot;folderPaneContext-rename&quot;, !isServer &amp;&amp; folder.isCommandEnabled(&quot;cmd_renameFolder&quot;));</span>
<a href="#l2.46"></a><span id="l2.46"> </span>
<a href="#l2.47"></a><span id="l2.47" class="difflineminus">-  if(canRename)</span>
<a href="#l2.48"></a><span id="l2.48" class="difflineminus">-  {</span>
<a href="#l2.49"></a><span id="l2.49" class="difflineplus">+  if (canRename)</span>
<a href="#l2.50"></a><span id="l2.50">     SetMenuItemLabel(&quot;folderPaneContext-rename&quot;, gMessengerBundle.getString(&quot;renameFolder&quot;));</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineminus">-  }</span>
<a href="#l2.52"></a><span id="l2.52"> }</span>
<a href="#l2.53"></a><span id="l2.53"> </span>
<a href="#l2.54"></a><span id="l2.54"> function SetupRemoveMenuItem(folderResource, numSelected, isServer, serverType, specialFolder)</span>
<a href="#l2.55"></a><span id="l2.55"> {</span>
<a href="#l2.56"></a><span id="l2.56">   var msgFolder = folderResource.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l2.57"></a><span id="l2.57">   var isMail = serverType != 'nntp';</span>
<a href="#l2.58"></a><span id="l2.58">   var isSpecialFolder = !(specialFolder == &quot;none&quot; || (specialFolder == &quot;Junk&quot; &amp;&amp; CanRenameDeleteJunkMail(msgFolder.URI))</span>
<a href="#l2.59"></a><span id="l2.59">                                                   || (specialFolder == &quot;Virtual&quot;));</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineat">@@ -347,46 +344,41 @@ function SetupRemoveMenuItem(folderResou</span>
<a href="#l2.61"></a><span id="l2.61">   if(isMail &amp;&amp; !isSpecialFolder)</span>
<a href="#l2.62"></a><span id="l2.62">   {</span>
<a href="#l2.63"></a><span id="l2.63">     SetMenuItemLabel(&quot;folderPaneContext-remove&quot;, gMessengerBundle.getString(&quot;removeFolder&quot;));</span>
<a href="#l2.64"></a><span id="l2.64">   }</span>
<a href="#l2.65"></a><span id="l2.65"> }</span>
<a href="#l2.66"></a><span id="l2.66"> </span>
<a href="#l2.67"></a><span id="l2.67"> function SetupCompactMenuItem(folderResource, numSelected)</span>
<a href="#l2.68"></a><span id="l2.68"> {</span>
<a href="#l2.69"></a><span id="l2.69" class="difflineminus">-  var folderTree = GetFolderTree();</span>
<a href="#l2.70"></a><span id="l2.70" class="difflineminus">-  var canCompact = GetFolderAttribute(folderTree, folderResource, &quot;CanCompact&quot;) == &quot;true&quot;;</span>
<a href="#l2.71"></a><span id="l2.71" class="difflineminus">-  ShowMenuItem(&quot;folderPaneContext-compact&quot;, (numSelected &lt;=1) &amp;&amp; canCompact);</span>
<a href="#l2.72"></a><span id="l2.72">   var folder = GetMsgFolderFromResource(folderResource);</span>
<a href="#l2.73"></a><span id="l2.73" class="difflineplus">+</span>
<a href="#l2.74"></a><span id="l2.74" class="difflineplus">+  ShowMenuItem(&quot;folderPaneContext-compact&quot;, numSelected &lt;= 1 &amp;&amp; folder.canCompact);</span>
<a href="#l2.75"></a><span id="l2.75">   EnableMenuItem(&quot;folderPaneContext-compact&quot;, folder.isCommandEnabled(&quot;cmd_compactFolder&quot;));</span>
<a href="#l2.76"></a><span id="l2.76"> </span>
<a href="#l2.77"></a><span id="l2.77" class="difflineminus">-  if(canCompact)</span>
<a href="#l2.78"></a><span id="l2.78" class="difflineminus">-  {</span>
<a href="#l2.79"></a><span id="l2.79" class="difflineplus">+  if (canCompact)</span>
<a href="#l2.80"></a><span id="l2.80">     SetMenuItemLabel(&quot;folderPaneContext-compact&quot;, gMessengerBundle.getString(&quot;compactFolder&quot;));</span>
<a href="#l2.81"></a><span id="l2.81" class="difflineminus">-  }</span>
<a href="#l2.82"></a><span id="l2.82"> }</span>
<a href="#l2.83"></a><span id="l2.83"> </span>
<a href="#l2.84"></a><span id="l2.84"> function SetupNewMenuItem(folderResource, numSelected, isServer, serverType, specialFolder)</span>
<a href="#l2.85"></a><span id="l2.85"> {</span>
<a href="#l2.86"></a><span id="l2.86" class="difflineminus">-  var folderTree = GetFolderTree();</span>
<a href="#l2.87"></a><span id="l2.87" class="difflineminus">-  var canCreateNew = GetFolderAttribute(folderTree, folderResource, &quot;CanCreateSubfolders&quot;) == &quot;true&quot;;</span>
<a href="#l2.88"></a><span id="l2.88" class="difflineplus">+  let folder = folderResource.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l2.89"></a><span id="l2.89">   var isInbox = specialFolder == &quot;Inbox&quot;;</span>
<a href="#l2.90"></a><span id="l2.90"> </span>
<a href="#l2.91"></a><span id="l2.91" class="difflineminus">-  var isIMAPFolder = GetFolderAttribute(folderTree, folderResource,</span>
<a href="#l2.92"></a><span id="l2.92" class="difflineminus">-                       &quot;ServerType&quot;) == &quot;imap&quot;;</span>
<a href="#l2.93"></a><span id="l2.93" class="difflineminus">-</span>
<a href="#l2.94"></a><span id="l2.94" class="difflineminus">-  var ioService = Components.classes[&quot;@mozilla.org/network/io-service;1&quot;]</span>
<a href="#l2.95"></a><span id="l2.95" class="difflineminus">-                         .getService(Components.interfaces.nsIIOService);</span>
<a href="#l2.96"></a><span id="l2.96" class="difflineplus">+  const ioService = Components.classes[&quot;@mozilla.org/network/io-service;1&quot;]</span>
<a href="#l2.97"></a><span id="l2.97" class="difflineplus">+                              .getService(Components.interfaces.nsIIOService);</span>
<a href="#l2.98"></a><span id="l2.98"> </span>
<a href="#l2.99"></a><span id="l2.99" class="difflineminus">-  var showNew = ((numSelected &lt;=1) &amp;&amp; (serverType != 'nntp') &amp;&amp; canCreateNew) || isInbox;</span>
<a href="#l2.100"></a><span id="l2.100" class="difflineplus">+  let showNew = (numSelected &lt;= 1 &amp;&amp; serverType != &quot;nntp&quot; &amp;&amp;</span>
<a href="#l2.101"></a><span id="l2.101" class="difflineplus">+                 folder.canCreateSubfolders) || isInbox;</span>
<a href="#l2.102"></a><span id="l2.102">   ShowMenuItem(&quot;folderPaneContext-new&quot;, showNew);</span>
<a href="#l2.103"></a><span id="l2.103" class="difflineminus">-  EnableMenuItem(&quot;folderPaneContext-new&quot;, !isIMAPFolder || !ioService.offline);</span>
<a href="#l2.104"></a><span id="l2.104" class="difflineminus">-  if(showNew)</span>
<a href="#l2.105"></a><span id="l2.105" class="difflineplus">+  EnableMenuItem(&quot;folderPaneContext-new&quot;,</span>
<a href="#l2.106"></a><span id="l2.106" class="difflineplus">+                 folder.server.type != &quot;imap&quot; || !ioService.offline);</span>
<a href="#l2.107"></a><span id="l2.107" class="difflineplus">+  if (showNew)</span>
<a href="#l2.108"></a><span id="l2.108">   {</span>
<a href="#l2.109"></a><span id="l2.109" class="difflineminus">-    if(isServer || isInbox)</span>
<a href="#l2.110"></a><span id="l2.110" class="difflineplus">+    if (isServer || isInbox)</span>
<a href="#l2.111"></a><span id="l2.111">       SetMenuItemLabel(&quot;folderPaneContext-new&quot;, gMessengerBundle.getString(&quot;newFolder&quot;));</span>
<a href="#l2.112"></a><span id="l2.112">     else</span>
<a href="#l2.113"></a><span id="l2.113">       SetMenuItemLabel(&quot;folderPaneContext-new&quot;, gMessengerBundle.getString(&quot;newSubfolder&quot;));</span>
<a href="#l2.114"></a><span id="l2.114">   }</span>
<a href="#l2.115"></a><span id="l2.115"> }</span>
<a href="#l2.116"></a><span id="l2.116"> </span>
<a href="#l2.117"></a><span id="l2.117"> function ShowMenuItem(id, showItem)</span>
<a href="#l2.118"></a><span id="l2.118"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/suite/mailnews/msgMail3PaneWindow.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/suite/mailnews/msgMail3PaneWindow.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1006,18 +1006,28 @@ function OnLocationTreeSelect(menulist)</span>
<a href="#l3.4"></a><span id="l3.4"> </span>
<a href="#l3.5"></a><span id="l3.5"> function UpdateLocationBar(resource)</span>
<a href="#l3.6"></a><span id="l3.6"> {</span>
<a href="#l3.7"></a><span id="l3.7">     var tree = GetFolderTree();</span>
<a href="#l3.8"></a><span id="l3.8">     var folders = document.getElementById('locationFolders');</span>
<a href="#l3.9"></a><span id="l3.9">     var icon = document.getElementById('locationIcon');</span>
<a href="#l3.10"></a><span id="l3.10">     var names = ['BiffState', 'NewMessages', 'HasUnreadMessages',</span>
<a href="#l3.11"></a><span id="l3.11">         'SpecialFolder', 'IsServer', 'IsSecure', 'ServerType', 'NoSelect'];</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    var label = GetFolderAttribute(tree, resource, 'FolderTreeName');</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-    folders.setAttribute(&quot;label&quot;, label);</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+    let folder = resource.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+    folders.setAttribute(&quot;label&quot;, folder.prettyName);</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+    const rdfService = Components.classes[&quot;@mozilla.org/rdf/rdf-service;1&quot;]</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+                                 .getService(Components.interfaces.nsIRDFService);</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+    function GetFolderAttribute(tree, source, attribute) {</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+      let property = rdfService.GetResource(&quot;http://home.netscape.com/NC-rdf#&quot; + attribute);</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+      let target = tree.database.GetTarget(source, property, true);</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineplus">+      if (target)</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineplus">+        target = target.QueryInterface(Components.interfaces.nsIRDFLiteral).Value;</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineplus">+      return target;</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineplus">+    }</span>
<a href="#l3.26"></a><span id="l3.26">     for (var i in names) {</span>
<a href="#l3.27"></a><span id="l3.27">         var name = names[i];</span>
<a href="#l3.28"></a><span id="l3.28">         var value = GetFolderAttribute(tree, resource, name);</span>
<a href="#l3.29"></a><span id="l3.29">         folders.setAttribute(name, value);</span>
<a href="#l3.30"></a><span id="l3.30">         icon.setAttribute(name, value);</span>
<a href="#l3.31"></a><span id="l3.31">     }</span>
<a href="#l3.32"></a><span id="l3.32">     folders.setAttribute('uri', resource.Value);</span>
<a href="#l3.33"></a><span id="l3.33"> }</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineat">@@ -1451,25 +1461,16 @@ function GetFolderResource(tree, index)</span>
<a href="#l3.35"></a><span id="l3.35">   return tree.builderView.getResourceAtIndex(index);</span>
<a href="#l3.36"></a><span id="l3.36"> }</span>
<a href="#l3.37"></a><span id="l3.37"> </span>
<a href="#l3.38"></a><span id="l3.38"> function GetFolderIndex(tree, resource)</span>
<a href="#l3.39"></a><span id="l3.39"> {</span>
<a href="#l3.40"></a><span id="l3.40">   return tree.builderView.getIndexOfResource(resource);</span>
<a href="#l3.41"></a><span id="l3.41"> }</span>
<a href="#l3.42"></a><span id="l3.42"> </span>
<a href="#l3.43"></a><span id="l3.43" class="difflineminus">-function GetFolderAttribute(tree, source, attribute)</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineminus">-{</span>
<a href="#l3.45"></a><span id="l3.45" class="difflineminus">-  var property = RDF.GetResource(&quot;http://home.netscape.com/NC-rdf#&quot; + attribute);</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineminus">-  var target = tree.database.GetTarget(source, property, true);</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineminus">-  if (target)</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineminus">-    target = target.QueryInterface(Components.interfaces.nsIRDFLiteral).Value;</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineminus">-  return target;</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineminus">-}</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineminus">-</span>
<a href="#l3.52"></a><span id="l3.52"> // Some of the per account junk mail settings have been</span>
<a href="#l3.53"></a><span id="l3.53"> // converted to global prefs. Let's try to migrate some</span>
<a href="#l3.54"></a><span id="l3.54"> // of those settings from the default account.</span>
<a href="#l3.55"></a><span id="l3.55"> function MigrateJunkMailSettings()</span>
<a href="#l3.56"></a><span id="l3.56"> {</span>
<a href="#l3.57"></a><span id="l3.57">   var junkMailSettingsVersion = pref.getIntPref(&quot;mail.spam.version&quot;);</span>
<a href="#l3.58"></a><span id="l3.58">   if (!junkMailSettingsVersion)</span>
<a href="#l3.59"></a><span id="l3.59">   {</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineat">@@ -1493,8 +1494,33 @@ function MigrateJunkMailSettings()</span>
<a href="#l3.61"></a><span id="l3.61">         pref.setBoolPref(&quot;mail.spam.logging.enabled&quot;, pref.getBoolPref(prefix + &quot;spamLoggingEnabled&quot;));</span>
<a href="#l3.62"></a><span id="l3.62">       if (pref.prefHasUserValue(prefix + &quot;markAsReadOnSpam&quot;))</span>
<a href="#l3.63"></a><span id="l3.63">         pref.setBoolPref(&quot;mail.spam.markAsReadOnSpam&quot;, pref.getBoolPref(prefix + &quot;markAsReadOnSpam&quot;));</span>
<a href="#l3.64"></a><span id="l3.64">     }</span>
<a href="#l3.65"></a><span id="l3.65">     // bump the version so we don't bother doing this again.</span>
<a href="#l3.66"></a><span id="l3.66">     pref.setIntPref(&quot;mail.spam.version&quot;, 1);</span>
<a href="#l3.67"></a><span id="l3.67">   }</span>
<a href="#l3.68"></a><span id="l3.68"> }</span>
<a href="#l3.69"></a><span id="l3.69" class="difflineplus">+</span>
<a href="#l3.70"></a><span id="l3.70" class="difflineplus">+/**</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineplus">+ * Returns a string representation of a folder's specialFolder attribute.</span>
<a href="#l3.72"></a><span id="l3.72" class="difflineplus">+ *</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineplus">+ * @param aFolder The folder whose specialFolder attribute to return.</span>
<a href="#l3.74"></a><span id="l3.74" class="difflineplus">+ */</span>
<a href="#l3.75"></a><span id="l3.75" class="difflineplus">+function getSpecialFolderString(aFolder) {</span>
<a href="#l3.76"></a><span id="l3.76" class="difflineplus">+  if (aFolder.flags &amp; 0x1000) // MSG_FOLDER_FLAG_INBOX</span>
<a href="#l3.77"></a><span id="l3.77" class="difflineplus">+    return &quot;Inbox&quot;;</span>
<a href="#l3.78"></a><span id="l3.78" class="difflineplus">+  if (aFolder.flags &amp; 0x0100) // MSG_FOLDER_FLAG_TRASH</span>
<a href="#l3.79"></a><span id="l3.79" class="difflineplus">+    return &quot;Trash&quot;;</span>
<a href="#l3.80"></a><span id="l3.80" class="difflineplus">+  if (aFolder.flags &amp; 0x0800) // MSG_FOLDER_FLAG_QUEUE</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineplus">+    return &quot;Unsent Messages&quot;;</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineplus">+  if (aFolder.flags &amp; 0x0200) // MSG_FOLDER_FLAG_SENTMAIL</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineplus">+    return &quot;Sent&quot;;</span>
<a href="#l3.84"></a><span id="l3.84" class="difflineplus">+  if (aFolder.flags &amp; 0x0400) // MSG_FOLDER_FLAG_DRAFTS</span>
<a href="#l3.85"></a><span id="l3.85" class="difflineplus">+    return &quot;Drafts&quot;;</span>
<a href="#l3.86"></a><span id="l3.86" class="difflineplus">+  if (aFolder.flags &amp; 0x400000) // MSG_FOLDER_FLAG_TEMPLATES</span>
<a href="#l3.87"></a><span id="l3.87" class="difflineplus">+    return &quot;Templates&quot;;</span>
<a href="#l3.88"></a><span id="l3.88" class="difflineplus">+  if (aFolder.flags &amp; 0x40000000) // MSG_FOLDER_FLAG_JUNK</span>
<a href="#l3.89"></a><span id="l3.89" class="difflineplus">+    return &quot;Junk&quot;;</span>
<a href="#l3.90"></a><span id="l3.90" class="difflineplus">+  if (aFolder.flags &amp; 0x0020) // MSG_FOLDER_FLAG_VIRTUAL</span>
<a href="#l3.91"></a><span id="l3.91" class="difflineplus">+    return &quot;Virtual&quot;;</span>
<a href="#l3.92"></a><span id="l3.92" class="difflineplus">+  return &quot;none&quot;;</span>
<a href="#l3.93"></a><span id="l3.93" class="difflineplus">+}</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

