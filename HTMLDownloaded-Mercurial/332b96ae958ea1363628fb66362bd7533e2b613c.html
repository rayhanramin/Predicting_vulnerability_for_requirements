<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 20044:332b96ae958ea1363628fb66362bd7533e2b613c</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 332b96ae958ea1363628fb66362bd7533e2b613c" />
<meta property="og:url" content="/comm-central/rev/332b96ae958ea1363628fb66362bd7533e2b613c" />
<meta property="og:description" content="Bug 1280898 - Set up eslint for calendar files - enable brace-style rule. r=MakeMyDay" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 332b96ae958ea1363628fb66362bd7533e2b613c 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/332b96ae958ea1363628fb66362bd7533e2b613c">shortlog</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/332b96ae958ea1363628fb66362bd7533e2b613c">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c">files</a> |
changeset |
<a href="/comm-central/raw-rev/332b96ae958ea1363628fb66362bd7533e2b613c">raw</a>  | <a href="/comm-central/archive/332b96ae958ea1363628fb66362bd7533e2b613c.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable brace-style rule. r=MakeMyDay
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#101;&#115;&#108;&#105;&#110;&#116;&#32;&#60;&#101;&#115;&#108;&#105;&#110;&#116;&#64;&#98;&#117;&#103;&#122;&#105;&#108;&#108;&#97;&#46;&#107;&#101;&#119;&#105;&#115;&#46;&#99;&#104;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 08 Jul 2016 11:19:17 +0200</td></tr>

<tr>
 <td>changeset 20044</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/332b96ae958ea1363628fb66362bd7533e2b613c">332b96ae958ea1363628fb66362bd7533e2b613c</a></td>
</tr>



<tr>
<td>parent 20043</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/a7312b12f00f6b39084b768a6252669ed641d0b4">a7312b12f00f6b39084b768a6252669ed641d0b4</a>
</td>
</tr>

<tr>
<td>child 20045</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/d67d30c8c222ad68b1f2f97e770ac6b1f75a1770">d67d30c8c222ad68b1f2f97e770ac6b1f75a1770</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=332b96ae958ea1363628fb66362bd7533e2b613c">12297</a></td></tr>
<tr><td>push user</td><td>mozilla@kewis.ch</td></tr>
<tr><td>push date</td><td class="date age">Fri, 16 Sep 2016 20:17:21 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@f3dc3e4a87d4 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=f3dc3e4a87d4590884873d9248b3e6f6a01f0165">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=f3dc3e4a87d4590884873d9248b3e6f6a01f0165&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f3dc3e4a87d4590884873d9248b3e6f6a01f0165&newProject=comm-central&newRevision=a7312b12f00f6b39084b768a6252669ed641d0b4&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f3dc3e4a87d4590884873d9248b3e6f6a01f0165&newProject=comm-central&newRevision=a7312b12f00f6b39084b768a6252669ed641d0b4&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f3dc3e4a87d4590884873d9248b3e6f6a01f0165&newProject=comm-central&newRevision=a7312b12f00f6b39084b768a6252669ed641d0b4&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28MakeMyDay%29&revcount=50">MakeMyDay</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">1280898</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable brace-style rule. r=MakeMyDay

MozReview-Commit-ID: KBzW1Va97zD</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/.eslintrc">calendar/.eslintrc</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/.eslintrc">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/.eslintrc">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/.eslintrc">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/.eslintrc">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/.eslintrc">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calDateTime.js">calendar/base/backend/icaljs/calDateTime.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calDateTime.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calDateTime.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calDateTime.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calDateTime.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calDateTime.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calICSService.js">calendar/base/backend/icaljs/calICSService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calICSService.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calICSService.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calICSService.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calICSService.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calICSService.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calPeriod.js">calendar/base/backend/icaljs/calPeriod.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calPeriod.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calPeriod.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calPeriod.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calPeriod.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calPeriod.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calRecurrenceRule.js">calendar/base/backend/icaljs/calRecurrenceRule.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calRecurrenceRule.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calRecurrenceRule.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calRecurrenceRule.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calRecurrenceRule.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/backend/icaljs/calRecurrenceRule.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/agenda-listbox.js">calendar/base/content/agenda-listbox.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/agenda-listbox.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/agenda-listbox.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/agenda-listbox.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/agenda-listbox.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/agenda-listbox.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-base-view.xml">calendar/base/content/calendar-base-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-base-view.xml">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-base-view.xml">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-base-view.xml">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-base-view.xml">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-base-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-multiday-view.xml">calendar/base/content/calendar-multiday-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-multiday-view.xml">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-multiday-view.xml">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-multiday-view.xml">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-multiday-view.xml">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-multiday-view.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-tree.xml">calendar/base/content/calendar-task-tree.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-tree.xml">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-tree.xml">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-tree.xml">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-tree.xml">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-tree.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-view.js">calendar/base/content/calendar-task-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-view.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-view.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-view.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-view.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-task-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-ui-utils.js">calendar/base/content/calendar-ui-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-ui-utils.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-ui-utils.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-ui-utils.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-ui-utils.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/calendar-ui-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/import-export.js">calendar/base/content/import-export.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/import-export.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/import-export.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/import-export.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/import-export.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/import-export.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/widgets/minimonth.xml">calendar/base/content/widgets/minimonth.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/widgets/minimonth.xml">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/widgets/minimonth.xml">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/widgets/minimonth.xml">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/widgets/minimonth.xml">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/content/widgets/minimonth.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calAuthUtils.jsm">calendar/base/modules/calAuthUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calAuthUtils.jsm">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calAuthUtils.jsm">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calAuthUtils.jsm">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calAuthUtils.jsm">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calAuthUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calItipUtils.jsm">calendar/base/modules/calItipUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calItipUtils.jsm">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calItipUtils.jsm">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calItipUtils.jsm">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calItipUtils.jsm">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/modules/calItipUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calApplicationUtils.js">calendar/base/src/calApplicationUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calApplicationUtils.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calApplicationUtils.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calApplicationUtils.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calApplicationUtils.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calApplicationUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calProtocolHandler.js">calendar/base/src/calProtocolHandler.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calProtocolHandler.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calProtocolHandler.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calProtocolHandler.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calProtocolHandler.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calProtocolHandler.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calRecurrenceInfo.js">calendar/base/src/calRecurrenceInfo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calRecurrenceInfo.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calRecurrenceInfo.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calRecurrenceInfo.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calRecurrenceInfo.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calRecurrenceInfo.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calUtils.js">calendar/base/src/calUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calUtils.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calUtils.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calUtils.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calUtils.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/base/src/calUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/import-export/calMonthGridPrinter.js">calendar/import-export/calMonthGridPrinter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/import-export/calMonthGridPrinter.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/import-export/calMonthGridPrinter.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/import-export/calMonthGridPrinter.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/import-export/calMonthGridPrinter.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/import-export/calMonthGridPrinter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/components/calItipProtocolHandler.js">calendar/lightning/components/calItipProtocolHandler.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/components/calItipProtocolHandler.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/components/calItipProtocolHandler.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/components/calItipProtocolHandler.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/components/calItipProtocolHandler.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/components/calItipProtocolHandler.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/modules/ltnInvitationUtils.jsm">calendar/lightning/modules/ltnInvitationUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/modules/ltnInvitationUtils.jsm">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/modules/ltnInvitationUtils.jsm">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/modules/ltnInvitationUtils.jsm">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/modules/ltnInvitationUtils.jsm">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/lightning/modules/ltnInvitationUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavCalendar.js">calendar/providers/caldav/calDavCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavCalendar.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavCalendar.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavCalendar.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavCalendar.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavRequestHandlers.js">calendar/providers/caldav/calDavRequestHandlers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavRequestHandlers.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavRequestHandlers.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavRequestHandlers.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavRequestHandlers.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/caldav/calDavRequestHandlers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/composite/calCompositeCalendar.js">calendar/providers/composite/calCompositeCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/composite/calCompositeCalendar.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/composite/calCompositeCalendar.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/composite/calCompositeCalendar.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/composite/calCompositeCalendar.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/composite/calCompositeCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/ics/calICSCalendar.js">calendar/providers/ics/calICSCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/ics/calICSCalendar.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/ics/calICSCalendar.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/ics/calICSCalendar.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/ics/calICSCalendar.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/ics/calICSCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageCalendar.js">calendar/providers/storage/calStorageCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageCalendar.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageCalendar.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageCalendar.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageCalendar.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageUpgrade.jsm">calendar/providers/storage/calStorageUpgrade.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageUpgrade.jsm">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageUpgrade.jsm">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageUpgrade.jsm">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageUpgrade.jsm">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/storage/calStorageUpgrade.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapRequest.js">calendar/providers/wcap/calWcapRequest.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapRequest.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapRequest.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapRequest.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapRequest.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapRequest.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapSession.js">calendar/providers/wcap/calWcapSession.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapSession.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapSession.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapSession.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapSession.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/providers/wcap/calWcapSession.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/datetimepickers/datetimepickers.xml">calendar/resources/content/datetimepickers/datetimepickers.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/datetimepickers/datetimepickers.xml">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/datetimepickers/datetimepickers.xml">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/datetimepickers/datetimepickers.xml">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/datetimepickers/datetimepickers.xml">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/datetimepickers/datetimepickers.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/mouseoverPreviews.js">calendar/resources/content/mouseoverPreviews.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/mouseoverPreviews.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/mouseoverPreviews.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/mouseoverPreviews.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/mouseoverPreviews.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/mouseoverPreviews.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publish.js">calendar/resources/content/publish.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publish.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publish.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publish.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publish.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publish.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publishDialog.js">calendar/resources/content/publishDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publishDialog.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publishDialog.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publishDialog.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publishDialog.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/resources/content/publishDialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/shared-modules/calendar-utils.js">calendar/test/mozmill/shared-modules/calendar-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/shared-modules/calendar-utils.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/shared-modules/calendar-utils.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/shared-modules/calendar-utils.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/shared-modules/calendar-utils.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/shared-modules/calendar-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/views/testTaskView.js">calendar/test/mozmill/views/testTaskView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/views/testTaskView.js">file</a> |
<a href="/comm-central/annotate/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/views/testTaskView.js">annotate</a> |
<a href="/comm-central/diff/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/views/testTaskView.js">diff</a> |
<a href="/comm-central/comparison/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/views/testTaskView.js">comparison</a> |
<a href="/comm-central/log/332b96ae958ea1363628fb66362bd7533e2b613c/calendar/test/mozmill/views/testTaskView.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/.eslintrc</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/.eslintrc</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,13 +1,17 @@</span>
<a href="#l1.4"></a><span id="l1.4"> {</span>
<a href="#l1.5"></a><span id="l1.5">   &quot;extends&quot;: [</span>
<a href="#l1.6"></a><span id="l1.6">     &quot;../mozilla/toolkit/.eslintrc&quot;</span>
<a href="#l1.7"></a><span id="l1.7">   ],</span>
<a href="#l1.8"></a><span id="l1.8">   &quot;rules&quot;: {</span>
<a href="#l1.9"></a><span id="l1.9" class="difflineplus">+    // Enforce one true brace style (opening brace on the same line)</span>
<a href="#l1.10"></a><span id="l1.10" class="difflineplus">+    // Allow single line (for now) because of the vast number of changes needed</span>
<a href="#l1.11"></a><span id="l1.11" class="difflineplus">+    &quot;brace-style&quot;: [2, &quot;1tbs&quot;, {&quot;allowSingleLine&quot;: true}],</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+</span>
<a href="#l1.13"></a><span id="l1.13">     // Enforce newline at the end of file, with no multiple empty lines.</span>
<a href="#l1.14"></a><span id="l1.14">     &quot;eol-last&quot;: 2,</span>
<a href="#l1.15"></a><span id="l1.15"> </span>
<a href="#l1.16"></a><span id="l1.16">     // Disallow using variables outside the blocks they are defined</span>
<a href="#l1.17"></a><span id="l1.17">     &quot;block-scoped-var&quot;: 2,</span>
<a href="#l1.18"></a><span id="l1.18"> </span>
<a href="#l1.19"></a><span id="l1.19">     // Allow trailing commas for easy list extension.  Having them does not</span>
<a href="#l1.20"></a><span id="l1.20">     // impair readability, but also not required either.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calDateTime.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calDateTime.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -49,20 +49,22 @@ calDateTime.prototype = {</span>
<a href="#l2.4"></a><span id="l2.4"> </span>
<a href="#l2.5"></a><span id="l2.5">     get minute() { return this.innerObject.minute; },</span>
<a href="#l2.6"></a><span id="l2.6">     set minute(val) { this.innerObject.minute = val; },</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8">     get second() { return this.innerObject.second; },</span>
<a href="#l2.9"></a><span id="l2.9">     set second(val) { this.innerObject.second = val; },</span>
<a href="#l2.10"></a><span id="l2.10"> </span>
<a href="#l2.11"></a><span id="l2.11">     get timezone() { return new calICALJSTimezone(this.innerObject.zone); },</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-    set timezone(val) { unwrapSetter(ICAL.Timezone, val, function(val) {</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-        this.innerObject.zone = val;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-        return val;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineminus">-    }, this); },</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+    set timezone(val) {</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+        unwrapSetter(ICAL.Timezone, val, function(val) {</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+            this.innerObject.zone = val;</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+            return val;</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+        }, this);</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+    },</span>
<a href="#l2.22"></a><span id="l2.22"> </span>
<a href="#l2.23"></a><span id="l2.23">     resetTo: function (yr, mo, dy, hr, mi, sc, tz) {</span>
<a href="#l2.24"></a><span id="l2.24">         this.innerObject.fromData({</span>
<a href="#l2.25"></a><span id="l2.25">             year: yr, month: mo + 1, day: dy,</span>
<a href="#l2.26"></a><span id="l2.26">             hour: hr, minute: mi, second: sc,</span>
<a href="#l2.27"></a><span id="l2.27">         });</span>
<a href="#l2.28"></a><span id="l2.28">         this.timezone = tz;</span>
<a href="#l2.29"></a><span id="l2.29">     },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calICSService.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calICSService.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -74,30 +74,32 @@ calIcalProperty.prototype = {</span>
<a href="#l3.4"></a><span id="l3.4">     },</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6">     get valueAsDatetime() {</span>
<a href="#l3.7"></a><span id="l3.7">         let val = this.innerObject.getFirstValue();</span>
<a href="#l3.8"></a><span id="l3.8">         let isIcalTime = val &amp;&amp; (typeof val == &quot;object&quot;) &amp;&amp;</span>
<a href="#l3.9"></a><span id="l3.9">                          (&quot;icalclass&quot; in val) &amp;&amp; val.icalclass == &quot;icaltime&quot;;</span>
<a href="#l3.10"></a><span id="l3.10">         return (isIcalTime ? new calDateTime(val) : null);</span>
<a href="#l3.11"></a><span id="l3.11">     },</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    set valueAsDatetime(val) { unwrapSetter(ICAL.Time, val, function(val) {</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-        if (val &amp;&amp; val.zone &amp;&amp;</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-            val.zone != ICAL.Timezone.utcTimezone &amp;&amp;</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-            val.zone != ICAL.Timezone.localTimezone) {</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineminus">-            this.innerObject.setParameter(&quot;TZID&quot;, val.zone.tzid);</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineminus">-            if (this.parent) {</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineminus">-                let tzref = wrapGetter(calICALJSTimezone, val.zone);</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineminus">-                this.parent.addTimezoneReference(tzref);</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+    set valueAsDatetime(val) {</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+        unwrapSetter(ICAL.Time, val, function(val) {</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineplus">+            if (val &amp;&amp; val.zone &amp;&amp;</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineplus">+                val.zone != ICAL.Timezone.utcTimezone &amp;&amp;</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineplus">+                val.zone != ICAL.Timezone.localTimezone) {</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineplus">+                this.innerObject.setParameter(&quot;TZID&quot;, val.zone.tzid);</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+                if (this.parent) {</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineplus">+                    let tzref = wrapGetter(calICALJSTimezone, val.zone);</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineplus">+                    this.parent.addTimezoneReference(tzref);</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+                }</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+            } else {</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+                this.innerObject.removeParameter(&quot;TZID&quot;);</span>
<a href="#l3.32"></a><span id="l3.32">             }</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineminus">-        } else {</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineminus">-            this.innerObject.removeParameter(&quot;TZID&quot;);</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineminus">-        }</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineminus">-        this.innerObject.setValue(val);</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineminus">-    }, this); },</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+            this.innerObject.setValue(val);</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineplus">+        }, this);</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineplus">+    },</span>
<a href="#l3.41"></a><span id="l3.41"> </span>
<a href="#l3.42"></a><span id="l3.42">     get propertyName() { return this.innerObject.name.toUpperCase(); },</span>
<a href="#l3.43"></a><span id="l3.43"> </span>
<a href="#l3.44"></a><span id="l3.44">     getParameter: function(name) {</span>
<a href="#l3.45"></a><span id="l3.45">         // Unfortuantely getting the &quot;VALUE&quot; parameter won't work, since in</span>
<a href="#l3.46"></a><span id="l3.46">         // jCal it has been translated to the value type id.</span>
<a href="#l3.47"></a><span id="l3.47">         if (name == &quot;VALUE&quot;) {</span>
<a href="#l3.48"></a><span id="l3.48">             let propname = this.innerObject.name.toLowerCase();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calPeriod.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calPeriod.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -27,27 +27,31 @@ calPeriod.prototype = {</span>
<a href="#l4.4"></a><span id="l4.4"> </span>
<a href="#l4.5"></a><span id="l4.5">     get icalPeriod() { return this.innerObject; },</span>
<a href="#l4.6"></a><span id="l4.6">     set icalPeriod(val) { this.innerObject = val; },</span>
<a href="#l4.7"></a><span id="l4.7"> </span>
<a href="#l4.8"></a><span id="l4.8">     makeImmutable: function() { this.isMutable = false; },</span>
<a href="#l4.9"></a><span id="l4.9">     clone: function() { return new calPeriod(this.innerObject.clone()); },</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11">     get start() { return wrapGetter(calDateTime, this.innerObject.start); },</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-    set start(val) { unwrapSetter(ICAL.Time, val, function(val) {</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-        this.innerObject.start = val;</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-    }, this); },</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+    set start(val) {</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+        unwrapSetter(ICAL.Time, val, function(val) {</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+            this.innerObject.start = val;</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+        }, this);</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+    },</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21">     get end() { return wrapGetter(calDateTime, this.innerObject.getEnd()); },</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineminus">-    set end(val) { unwrapSetter(ICAL.Time, val, function(val) {</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineminus">-        if (this.innerObject.duration) {</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineminus">-            this.innerObject.duration = null;</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineminus">-        }</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineminus">-        this.innerObject.end = val;</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineminus">-    }, this); },</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+    set end(val) {</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+        unwrapSetter(ICAL.Time, val, function(val) {</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+            if (this.innerObject.duration) {</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+                this.innerObject.duration = null;</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+            }</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+            this.innerObject.end = val;</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+        }, this);</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+    },</span>
<a href="#l4.36"></a><span id="l4.36"> </span>
<a href="#l4.37"></a><span id="l4.37">     get duration() { return wrapGetter(calDuration, this.innerObject.getDuration()); },</span>
<a href="#l4.38"></a><span id="l4.38"> </span>
<a href="#l4.39"></a><span id="l4.39">     get icalString() { return this.innerObject.toICALString(); },</span>
<a href="#l4.40"></a><span id="l4.40">     set icalString(val) {</span>
<a href="#l4.41"></a><span id="l4.41">         let dates = ICAL.parse._parseValue(val, &quot;period&quot;, ICAL.design.icalendar);</span>
<a href="#l4.42"></a><span id="l4.42">         this.innerObject = ICAL.Period.fromString(dates.join(&quot;/&quot;));</span>
<a href="#l4.43"></a><span id="l4.43">         return val;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calRecurrenceRule.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calRecurrenceRule.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -98,19 +98,21 @@ calRecurrenceRule.prototype = {</span>
<a href="#l5.4"></a><span id="l5.4">     get icalString() { return &quot;RRULE:&quot; + this.innerObject.toString() + ICAL.newLineChar; },</span>
<a href="#l5.5"></a><span id="l5.5">     set icalString(val) { this.innerObject = ICAL.Recur.fromString(val.replace(/^RRULE:/i, &quot;&quot;)); },</span>
<a href="#l5.6"></a><span id="l5.6"> </span>
<a href="#l5.7"></a><span id="l5.7">     get icalProperty() {</span>
<a href="#l5.8"></a><span id="l5.8">         let prop = new ICAL.Property(&quot;rrule&quot;);</span>
<a href="#l5.9"></a><span id="l5.9">         prop.setValue(this.innerObject);</span>
<a href="#l5.10"></a><span id="l5.10">         return new calIcalProperty(prop);</span>
<a href="#l5.11"></a><span id="l5.11">     },</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-    set icalProperty(val) { unwrapSetter(ICAL.Property, val, function(val) {</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-        this.innerObject = val.getFirstValue();</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-    }, this); },</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+    set icalProperty(val) {</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+        unwrapSetter(ICAL.Property, val, function(val) {</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+            this.innerObject = val.getFirstValue();</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+        }, this);</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+    },</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21">     get type() { return this.innerObject.freq; },</span>
<a href="#l5.22"></a><span id="l5.22">     set type(val) { this.innerObject.freq = val; },</span>
<a href="#l5.23"></a><span id="l5.23"> </span>
<a href="#l5.24"></a><span id="l5.24">     get interval() { return this.innerObject.interval; },</span>
<a href="#l5.25"></a><span id="l5.25">     set interval(val) { this.innerObject.interval = val; },</span>
<a href="#l5.26"></a><span id="l5.26"> </span>
<a href="#l5.27"></a><span id="l5.27">     get count() {</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineat">@@ -123,24 +125,26 @@ calRecurrenceRule.prototype = {</span>
<a href="#l5.29"></a><span id="l5.29"> </span>
<a href="#l5.30"></a><span id="l5.30">     get untilDate() {</span>
<a href="#l5.31"></a><span id="l5.31">         if (this.innerObject.until) {</span>
<a href="#l5.32"></a><span id="l5.32">             return new calDateTime(this.innerObject.until);</span>
<a href="#l5.33"></a><span id="l5.33">         } else {</span>
<a href="#l5.34"></a><span id="l5.34">             return null;</span>
<a href="#l5.35"></a><span id="l5.35">         }</span>
<a href="#l5.36"></a><span id="l5.36">     },</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineminus">-    set untilDate(val) { unwrapSetter(ICAL.Time, val, function(val) {</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineminus">-        if (val.timezone != ICAL.Timezone.utcTimezone &amp;&amp;</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineminus">-            val.timezone != ICAL.Timezone.localTimezone) {</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineminus">-            val = val.convertToZone(ICAL.Timezone.utcTimezone);</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineminus">-        }</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+    set untilDate(val) {</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+        unwrapSetter(ICAL.Time, val, function(val) {</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+            if (val.timezone != ICAL.Timezone.utcTimezone &amp;&amp;</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+                val.timezone != ICAL.Timezone.localTimezone) {</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineplus">+                val = val.convertToZone(ICAL.Timezone.utcTimezone);</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineplus">+            }</span>
<a href="#l5.48"></a><span id="l5.48"> </span>
<a href="#l5.49"></a><span id="l5.49" class="difflineminus">-        this.innerObject.until = val;</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineminus">-    }, this); },</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+            this.innerObject.until = val;</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineplus">+        }, this);</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineplus">+    },</span>
<a href="#l5.54"></a><span id="l5.54"> </span>
<a href="#l5.55"></a><span id="l5.55">     get isByCount() { return this.innerObject.isByCount(); },</span>
<a href="#l5.56"></a><span id="l5.56"> </span>
<a href="#l5.57"></a><span id="l5.57">     get weekStart() { return this.innerObject.wkst - 1; },</span>
<a href="#l5.58"></a><span id="l5.58">     set weekStart(val) { this.innerObject.wkst = val + 1; },</span>
<a href="#l5.59"></a><span id="l5.59"> </span>
<a href="#l5.60"></a><span id="l5.60">     getComponent: function(aType, aCount) {</span>
<a href="#l5.61"></a><span id="l5.61">         let values = this.innerObject.getComponent(aType);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/agenda-listbox.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/agenda-listbox.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -928,26 +928,24 @@ agendaListbox.calendarObserver.onStartBa</span>
<a href="#l6.4"></a><span id="l6.4"> agendaListbox.calendarObserver.onEndBatch =</span>
<a href="#l6.5"></a><span id="l6.5"> function() {</span>
<a href="#l6.6"></a><span id="l6.6"> };</span>
<a href="#l6.7"></a><span id="l6.7"> </span>
<a href="#l6.8"></a><span id="l6.8"> agendaListbox.calendarObserver.onLoad = function() {</span>
<a href="#l6.9"></a><span id="l6.9">     this.agendaListbox.refreshCalendarQuery();</span>
<a href="#l6.10"></a><span id="l6.10"> };</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-agendaListbox.calendarObserver.onAddItem =</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-function observer_onAddItem(item)</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-{</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-  if (!isEvent(item)) {</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineminus">-      return;</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineminus">-  }</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineminus">-// get all sub items if it is a recurring item</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineminus">-  var occs = this.getOccurrencesBetween(item);</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineminus">-  occs.forEach(this.agendaListbox.addItem, this.agendaListbox);</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineminus">-  setCurrentEvent();</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+agendaListbox.calendarObserver.onAddItem = function observer_onAddItem(item) {</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+    if (!isEvent(item)) {</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineplus">+        return;</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineplus">+    }</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineplus">+    // get all sub items if it is a recurring item</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineplus">+    var occs = this.getOccurrencesBetween(item);</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineplus">+    occs.forEach(this.agendaListbox.addItem, this.agendaListbox);</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineplus">+    setCurrentEvent();</span>
<a href="#l6.30"></a><span id="l6.30"> };</span>
<a href="#l6.31"></a><span id="l6.31"> </span>
<a href="#l6.32"></a><span id="l6.32"> agendaListbox.calendarObserver.getOccurrencesBetween =</span>
<a href="#l6.33"></a><span id="l6.33"> function getOccurrencesBetween(aItem) {</span>
<a href="#l6.34"></a><span id="l6.34">     var occs = [];</span>
<a href="#l6.35"></a><span id="l6.35">     var start = this.agendaListbox.getStart();</span>
<a href="#l6.36"></a><span id="l6.36">     var end = this.agendaListbox.getEnd();</span>
<a href="#l6.37"></a><span id="l6.37">     if (start &amp;&amp; end) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/calendar-base-view.xml</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/calendar-base-view.xml</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -245,17 +245,18 @@</span>
<a href="#l7.4"></a><span id="l7.4"> </span>
<a href="#l7.5"></a><span id="l7.5">         this.mTimezone = calendarDefaultTimezone();</span>
<a href="#l7.6"></a><span id="l7.6">         let alarmService = Components.classes['@mozilla.org/calendar/alarm-service;1']</span>
<a href="#l7.7"></a><span id="l7.7">                            .getService(Components.interfaces.calIAlarmService);</span>
<a href="#l7.8"></a><span id="l7.8">         alarmService.addObserver(this.mObserver);</span>
<a href="#l7.9"></a><span id="l7.9">         let self = this;</span>
<a href="#l7.10"></a><span id="l7.10">         this.setAttribute(&quot;type&quot;, this.type);</span>
<a href="#l7.11"></a><span id="l7.11">         this.mResizeHandler = function resizeHandler() {</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-            self.onResize(self); };</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+            self.onResize(self);</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+        };</span>
<a href="#l7.15"></a><span id="l7.15">         this.viewBroadcaster.addEventListener(this.getAttribute(&quot;type&quot;) + &quot;viewresized&quot;, this.mResizeHandler, true);</span>
<a href="#l7.16"></a><span id="l7.16">         // add a preference observer to monitor changes</span>
<a href="#l7.17"></a><span id="l7.17">         Services.prefs.addObserver(&quot;calendar.&quot;, this.mPrefObserver, false);</span>
<a href="#l7.18"></a><span id="l7.18">         this.weekStartOffset = Preferences.get(&quot;calendar.week.start&quot;, 0);</span>
<a href="#l7.19"></a><span id="l7.19">         this.updateDaysOffPrefs();</span>
<a href="#l7.20"></a><span id="l7.20">         this.mPendingRefreshJobs = new Map();</span>
<a href="#l7.21"></a><span id="l7.21">         this.mLog = Log4Moz.getConfiguredLogger(&quot;calBaseView&quot;);</span>
<a href="#l7.22"></a><span id="l7.22">         this.mFlashingEvents = {};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1769,18 +1769,17 @@</span>
<a href="#l8.4"></a><span id="l8.4">               // calendar.</span>
<a href="#l8.5"></a><span id="l8.5">               // TODO We might want to get rid of the extra displayCalendar</span>
<a href="#l8.6"></a><span id="l8.6">               // member.</span>
<a href="#l8.7"></a><span id="l8.7">               col.calendarView.controller.createNewEvent(null,</span>
<a href="#l8.8"></a><span id="l8.8">                                                          newStart,</span>
<a href="#l8.9"></a><span id="l8.9">                                                          newEnd);</span>
<a href="#l8.10"></a><span id="l8.10">           } else if (dragState.dragType == &quot;move&quot; ||</span>
<a href="#l8.11"></a><span id="l8.11">                      dragState.dragType == &quot;modify-start&quot; ||</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-                     dragState.dragType == &quot;modify-end&quot;)</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-          {</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+                     dragState.dragType == &quot;modify-end&quot;) {</span>
<a href="#l8.15"></a><span id="l8.15">               col.calendarView.controller.modifyOccurrence(dragState.dragOccurrence,</span>
<a href="#l8.16"></a><span id="l8.16">                                                            newStart, newEnd);</span>
<a href="#l8.17"></a><span id="l8.17">           }</span>
<a href="#l8.18"></a><span id="l8.18">           document.calendarEventColumnDragging = null;</span>
<a href="#l8.19"></a><span id="l8.19">           col.mDragState = null;</span>
<a href="#l8.20"></a><span id="l8.20">         ]]&gt;&lt;/body&gt;</span>
<a href="#l8.21"></a><span id="l8.21">       &lt;/method&gt;</span>
<a href="#l8.22"></a><span id="l8.22"> </span>
<a href="#l8.23"></a><span id="l8.23" class="difflineat">@@ -2624,20 +2623,21 @@</span>
<a href="#l8.24"></a><span id="l8.24">               }</span>
<a href="#l8.25"></a><span id="l8.25">               if (!aPpmChanged || aViewChanged || oldPrefInt != prefInt) {</span>
<a href="#l8.26"></a><span id="l8.26">                   // Synchronize the timer with a multiple of the interval.</span>
<a href="#l8.27"></a><span id="l8.27">                   let firstInterval = (prefInt - nowMinutes % prefInt) * 60 - now.second;</span>
<a href="#l8.28"></a><span id="l8.28">                   if (timeIndicator.timer) {</span>
<a href="#l8.29"></a><span id="l8.29">                       timeIndicator.cancel();</span>
<a href="#l8.30"></a><span id="l8.30">                   }</span>
<a href="#l8.31"></a><span id="l8.31">                   timeIndicator.lastView = this.id;</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineminus">-                  let self = this;</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineminus">-                  timeIndicator.timer = setTimeout(function() {self.updateTimeIndicatorPosition(false);</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineminus">-                                                               timeIndicator.start(prefInt * 60, self);},</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineminus">-                                                   firstInterval * 1000);</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineplus">+                  timeIndicator.timer = setTimeout(() =&gt; {</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineplus">+                      this.updateTimeIndicatorPosition(false);</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+                      timeIndicator.start(prefInt * 60, this);</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineplus">+                  }, firstInterval * 1000);</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+</span>
<a href="#l8.41"></a><span id="l8.41">                   // Set the time for the first positioning of the indicator.</span>
<a href="#l8.42"></a><span id="l8.42">                   let time = Math.floor(nowMinutes / prefInt) * prefInt;</span>
<a href="#l8.43"></a><span id="l8.43">                   document.getElementById(&quot;day-view&quot;).mTimeIndicatorMinutes = time;</span>
<a href="#l8.44"></a><span id="l8.44">                   document.getElementById(&quot;week-view&quot;).mTimeIndicatorMinutes = time;</span>
<a href="#l8.45"></a><span id="l8.45">               }</span>
<a href="#l8.46"></a><span id="l8.46">           } else if (aUpdateTheTimer === false) {</span>
<a href="#l8.47"></a><span id="l8.47">               // Set the time for every positioning after the first</span>
<a href="#l8.48"></a><span id="l8.48">               document.getElementById(&quot;day-view&quot;).mTimeIndicatorMinutes = nowMinutes;</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineat">@@ -3600,18 +3600,17 @@</span>
<a href="#l8.50"></a><span id="l8.50">         &lt;parameter name=&quot;aClientY&quot;/&gt;</span>
<a href="#l8.51"></a><span id="l8.51">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l8.52"></a><span id="l8.52">           if (!this.mDateColumns) {</span>
<a href="#l8.53"></a><span id="l8.53">               return null;</span>
<a href="#l8.54"></a><span id="l8.54">           }</span>
<a href="#l8.55"></a><span id="l8.55">           for (var col of this.mDateColumns) {</span>
<a href="#l8.56"></a><span id="l8.56">               let bo = document.getAnonymousElementByAttribute(col.column, &quot;anonid&quot;, &quot;boxstack&quot;).boxObject;</span>
<a href="#l8.57"></a><span id="l8.57">               if ((aClientX &gt;= bo.screenX) &amp;&amp; (aClientX &lt;= (bo.screenX + bo.width)) &amp;&amp;</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineminus">-                  (aClientY &gt;= bo.screenY) &amp;&amp; (aClientY &lt;= (bo.screenY + bo.height)))</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineminus">-              {</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineplus">+                  (aClientY &gt;= bo.screenY) &amp;&amp; (aClientY &lt;= (bo.screenY + bo.height))) {</span>
<a href="#l8.61"></a><span id="l8.61">                   return col.column;</span>
<a href="#l8.62"></a><span id="l8.62">               }</span>
<a href="#l8.63"></a><span id="l8.63">           }</span>
<a href="#l8.64"></a><span id="l8.64">           return null;</span>
<a href="#l8.65"></a><span id="l8.65">         ]]&gt;&lt;/body&gt;</span>
<a href="#l8.66"></a><span id="l8.66">       &lt;/method&gt;</span>
<a href="#l8.67"></a><span id="l8.67"> </span>
<a href="#l8.68"></a><span id="l8.68">       &lt;method name=&quot;adjustScrollbarSpacersForAlldayEvents&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -559,23 +559,20 @@</span>
<a href="#l9.4"></a><span id="l9.4">                   }</span>
<a href="#l9.5"></a><span id="l9.5">               }</span>
<a href="#l9.6"></a><span id="l9.6">           },</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8">           // Called on the view when a header is clicked.</span>
<a href="#l9.9"></a><span id="l9.9">           cycleHeader: function mTV_cycleHeader(aCol) {</span>
<a href="#l9.10"></a><span id="l9.10">               if (!this.selectedColumn) {</span>
<a href="#l9.11"></a><span id="l9.11">                   this.sortDirection = &quot;ascending&quot;;</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-              }</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-              else {</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineminus">-                  if (!this.sortDirection || this.sortDirection == &quot;descending&quot;) {</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineminus">-                      this.sortDirection = &quot;ascending&quot;;</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineminus">-                  } else {</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineminus">-                      this.sortDirection = &quot;descending&quot;;</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineminus">-                  }</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+              } else if (!this.sortDirection || this.sortDirection == &quot;descending&quot;) {</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+                  this.sortDirection = &quot;ascending&quot;;</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineplus">+              } else {</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineplus">+                  this.sortDirection = &quot;descending&quot;;</span>
<a href="#l9.23"></a><span id="l9.23">               }</span>
<a href="#l9.24"></a><span id="l9.24">               this.selectedColumn = aCol.element;</span>
<a href="#l9.25"></a><span id="l9.25">               let selectedItems = this.binding.selectedTasks;</span>
<a href="#l9.26"></a><span id="l9.26">               this.binding.sortItems();</span>
<a href="#l9.27"></a><span id="l9.27">               if (selectedItems != undefined) {</span>
<a href="#l9.28"></a><span id="l9.28">                   this.tree.view.selection.clearSelection();</span>
<a href="#l9.29"></a><span id="l9.29">                   for (let item of selectedItems){</span>
<a href="#l9.30"></a><span id="l9.30">                       let index = this.binding.mHash2Index[item.hashId];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/content/calendar-task-view.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-view.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -231,26 +231,20 @@ function taskViewObserveDisplayDeckChang</span>
<a href="#l10.4"></a><span id="l10.4">     let deck = event.target;</span>
<a href="#l10.5"></a><span id="l10.5"> </span>
<a href="#l10.6"></a><span id="l10.6">     // Bug 309505: The 'select' event also fires when we change the selected</span>
<a href="#l10.7"></a><span id="l10.7">     // panel of calendar-view-box.  Workaround with this check.</span>
<a href="#l10.8"></a><span id="l10.8">     if (deck.id != &quot;calendarDisplayDeck&quot;) {</span>
<a href="#l10.9"></a><span id="l10.9">         return;</span>
<a href="#l10.10"></a><span id="l10.10">     }</span>
<a href="#l10.11"></a><span id="l10.11"> </span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-    let id = null;</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-    try {</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-        id = deck.selectedPanel.id;</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineminus">-    }</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineminus">-    catch (e) {}</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineminus">-</span>
<a href="#l10.18"></a><span id="l10.18">     // In case we find that the task view has been made visible, we refresh the view.</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineminus">-    if (id == &quot;calendar-task-box&quot;) {</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineminus">-        taskViewUpdate(</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineminus">-            document.getElementById(&quot;task-tree-filtergroup&quot;).value || &quot;all&quot;);</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineplus">+    if (deck.selectedPanel &amp;&amp; deck.selectedPanel.id == &quot;calendar-task-box&quot;) {</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineplus">+        let taskFilterGroup = document.getElementById(&quot;task-tree-filtergroup&quot;);</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineplus">+        taskViewUpdate(taskFilterGroup.value || &quot;all&quot;);</span>
<a href="#l10.25"></a><span id="l10.25">     }</span>
<a href="#l10.26"></a><span id="l10.26"> }</span>
<a href="#l10.27"></a><span id="l10.27"> </span>
<a href="#l10.28"></a><span id="l10.28"> // Install event listeners for the display deck change and connect task tree to filter field</span>
<a href="#l10.29"></a><span id="l10.29"> function taskViewOnLoad() {</span>
<a href="#l10.30"></a><span id="l10.30">     let deck = document.getElementById(&quot;calendarDisplayDeck&quot;);</span>
<a href="#l10.31"></a><span id="l10.31">     let tree = document.getElementById(&quot;calendar-task-tree&quot;);</span>
<a href="#l10.32"></a><span id="l10.32"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/content/calendar-ui-utils.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/content/calendar-ui-utils.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -373,18 +373,17 @@ function checkRadioControl(aParent, aVal</span>
<a href="#l11.4"></a><span id="l11.4">         if (element.hasAttribute(&quot;value&quot;)) {</span>
<a href="#l11.5"></a><span id="l11.5">             var compValue = element.getAttribute(&quot;value&quot;);</span>
<a href="#l11.6"></a><span id="l11.6">             if (compValue == aValue) {</span>
<a href="#l11.7"></a><span id="l11.7">                 if (element.localName == &quot;menuitem&quot;) {</span>
<a href="#l11.8"></a><span id="l11.8">                     if (element.getAttribute(&quot;type&quot;) == &quot;radio&quot;) {</span>
<a href="#l11.9"></a><span id="l11.9">                         element.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l11.10"></a><span id="l11.10">                         return true;</span>
<a href="#l11.11"></a><span id="l11.11">                     }</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-                }</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-                else if (element.localName == &quot;radio&quot;) {</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+                } else if (element.localName == &quot;radio&quot;) {</span>
<a href="#l11.15"></a><span id="l11.15">                     element.radioGroup.selectedItem = element;</span>
<a href="#l11.16"></a><span id="l11.16">                     return true;</span>
<a href="#l11.17"></a><span id="l11.17">                 }</span>
<a href="#l11.18"></a><span id="l11.18">             }</span>
<a href="#l11.19"></a><span id="l11.19">         }</span>
<a href="#l11.20"></a><span id="l11.20">     }</span>
<a href="#l11.21"></a><span id="l11.21">     return false;</span>
<a href="#l11.22"></a><span id="l11.22"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/content/import-export.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/content/import-export.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -316,22 +316,20 @@ function saveEventsToFile(calendarEventA</span>
<a href="#l12.4"></a><span id="l12.4">  * the user will be prompted with a list of calendars to choose which one to export.</span>
<a href="#l12.5"></a><span id="l12.5">  *</span>
<a href="#l12.6"></a><span id="l12.6">  * @param aCalendar     (optional) A specific calendar to export</span>
<a href="#l12.7"></a><span id="l12.7">  */</span>
<a href="#l12.8"></a><span id="l12.8"> function exportEntireCalendar(aCalendar) {</span>
<a href="#l12.9"></a><span id="l12.9">     var itemArray = [];</span>
<a href="#l12.10"></a><span id="l12.10">     var getListener = {</span>
<a href="#l12.11"></a><span id="l12.11">         QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]),</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-        onOperationComplete: function(aCalendar, aStatus, aOperationType, aId, aDetail)</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-        {</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+        onOperationComplete: function(aCalendar, aStatus, aOperationType, aId, aDetail) {</span>
<a href="#l12.15"></a><span id="l12.15">             saveEventsToFile(itemArray, aCalendar.name);</span>
<a href="#l12.16"></a><span id="l12.16">         },</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-        onGetResult: function(aCalendar, aStatus, aItemType, aDetail, aCount, aItems)</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-        {</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+        onGetResult: function(aCalendar, aStatus, aItemType, aDetail, aCount, aItems) {</span>
<a href="#l12.20"></a><span id="l12.20">             for (let item of aItems) {</span>
<a href="#l12.21"></a><span id="l12.21">                 itemArray.push(item);</span>
<a href="#l12.22"></a><span id="l12.22">             }</span>
<a href="#l12.23"></a><span id="l12.23">         }</span>
<a href="#l12.24"></a><span id="l12.24">     };</span>
<a href="#l12.25"></a><span id="l12.25"> </span>
<a href="#l12.26"></a><span id="l12.26">     function getItemsFromCal(aCal) {</span>
<a href="#l12.27"></a><span id="l12.27">         aCal.getItems(Components.interfaces.calICalendar.ITEM_FILTER_ALL_ITEMS,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/content/widgets/minimonth.xml</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/content/widgets/minimonth.xml</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -753,18 +753,17 @@</span>
<a href="#l13.4"></a><span id="l13.4">                   minLength = Math.min(minLength, dayList[i].length);</span>
<a href="#l13.5"></a><span id="l13.5">               }</span>
<a href="#l13.6"></a><span id="l13.6">               // 2. If some day name abbrev. is longer than 2 chars (not Catalan),</span>
<a href="#l13.7"></a><span id="l13.7">               //    and ALL localized day names share same prefix (as in Chinese),</span>
<a href="#l13.8"></a><span id="l13.8">               //    then trim shared &quot;day-&quot; prefix.</span>
<a href="#l13.9"></a><span id="l13.9">               if (dayList.some(function(dayAbbr){ return dayAbbr.length &gt; 2; })) {</span>
<a href="#l13.10"></a><span id="l13.10">                   for (var endPrefix = 0; endPrefix &lt; minLength; endPrefix++) {</span>
<a href="#l13.11"></a><span id="l13.11">                       var c = dayList[0][endPrefix];</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-                      if (dayList.some(function(dayAbbr) {</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-                                             return dayAbbr[endPrefix] != c; })) {</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineplus">+                      if (dayList.some(dayAbbr =&gt; dayAbbr[endPrefix] != c)) {</span>
<a href="#l13.15"></a><span id="l13.15">                           if (endPrefix &gt; 0) {</span>
<a href="#l13.16"></a><span id="l13.16">                               for (i = 0; i &lt; dayList.length; i++) { // trim prefix chars.</span>
<a href="#l13.17"></a><span id="l13.17">                                   dayList[i] = dayList[i].substring(endPrefix);</span>
<a href="#l13.18"></a><span id="l13.18">                               }</span>
<a href="#l13.19"></a><span id="l13.19">                           }</span>
<a href="#l13.20"></a><span id="l13.20">                           break;</span>
<a href="#l13.21"></a><span id="l13.21">                       }</span>
<a href="#l13.22"></a><span id="l13.22">                   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/modules/calAuthUtils.jsm</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/modules/calAuthUtils.jsm</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -196,18 +196,17 @@ cal.auth.Prompt.prototype = {</span>
<a href="#l14.4"></a><span id="l14.4">                 now.getTime() - this.mReturnedLogins[keyStr].getTime() &lt; 60000) {</span>
<a href="#l14.5"></a><span id="l14.5">                 cal.LOG(&quot;Credentials removed for: user=&quot; + username + &quot;, host=&quot; + aPasswordRealm.prePath + &quot;, realm=&quot; + aPasswordRealm.realm)</span>
<a href="#l14.6"></a><span id="l14.6"> ;</span>
<a href="#l14.7"></a><span id="l14.7">                 delete this.mReturnedLogins[keyStr];</span>
<a href="#l14.8"></a><span id="l14.8">                 cal.auth.passwordManagerRemove(username,</span>
<a href="#l14.9"></a><span id="l14.9">                                                aPasswordRealm.prePath,</span>
<a href="#l14.10"></a><span id="l14.10">                                                aPasswordRealm.realm);</span>
<a href="#l14.11"></a><span id="l14.11">                 return {found: false, username: username};</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-            }</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-            else {</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+            } else {</span>
<a href="#l14.15"></a><span id="l14.15">                 this.mReturnedLogins[keyStr] = now;</span>
<a href="#l14.16"></a><span id="l14.16">             }</span>
<a href="#l14.17"></a><span id="l14.17">         }</span>
<a href="#l14.18"></a><span id="l14.18">         return {found: found, username: username, password: password};</span>
<a href="#l14.19"></a><span id="l14.19">     },</span>
<a href="#l14.20"></a><span id="l14.20"> </span>
<a href="#l14.21"></a><span id="l14.21">     /**</span>
<a href="#l14.22"></a><span id="l14.22">      * Requests a username and a password. Implementations will commonly show a</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/base/modules/calItipUtils.jsm</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/base/modules/calItipUtils.jsm</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -447,18 +447,17 @@ cal.itip = {</span>
<a href="#l15.4"></a><span id="l15.4">                 if (matchingCals.length &gt; 0) {</span>
<a href="#l15.5"></a><span id="l15.5">                     calendars = matchingCals;</span>
<a href="#l15.6"></a><span id="l15.6">                 }</span>
<a href="#l15.7"></a><span id="l15.7">             }</span>
<a href="#l15.8"></a><span id="l15.8"> </span>
<a href="#l15.9"></a><span id="l15.9">             if (calendars.length == 0) {</span>
<a href="#l15.10"></a><span id="l15.10">                 let msg = cal.calGetString(&quot;lightning&quot;, &quot;imipNoCalendarAvailable&quot;, null, &quot;lightning&quot;);</span>
<a href="#l15.11"></a><span id="l15.11">                 aWindow.alert(msg);</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-            }</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-            else if (calendars.length == 1) {</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+            } else if (calendars.length == 1) {</span>
<a href="#l15.15"></a><span id="l15.15">                 // There's only one calendar, so it's silly to ask what calendar</span>
<a href="#l15.16"></a><span id="l15.16">                 // the user wants to import into.</span>
<a href="#l15.17"></a><span id="l15.17">                 targetCalendar = calendars[0];</span>
<a href="#l15.18"></a><span id="l15.18">             } else {</span>
<a href="#l15.19"></a><span id="l15.19">                 // Ask what calendar to import into</span>
<a href="#l15.20"></a><span id="l15.20">                 let args = {};</span>
<a href="#l15.21"></a><span id="l15.21">                 args.calendars = calendars;</span>
<a href="#l15.22"></a><span id="l15.22">                 args.onOk = function selectCalendar(aCal) { targetCalendar = aCal; };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/base/src/calApplicationUtils.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/base/src/calApplicationUtils.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -7,18 +7,17 @@ Components.utils.import(&quot;resource://gre/</span>
<a href="#l16.4"></a><span id="l16.4"> </span>
<a href="#l16.5"></a><span id="l16.5"> /**</span>
<a href="#l16.6"></a><span id="l16.6">  * Launch the given url (string) in the external browser. If an event is passed,</span>
<a href="#l16.7"></a><span id="l16.7">  * then this is only done on left click and the event propagation is stopped.</span>
<a href="#l16.8"></a><span id="l16.8">  *</span>
<a href="#l16.9"></a><span id="l16.9">  * @param url       The URL to open, as a string</span>
<a href="#l16.10"></a><span id="l16.10">  * @param event     (optional) The event that caused the URL to open</span>
<a href="#l16.11"></a><span id="l16.11">  */</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-function launchBrowser(url, event)</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-{</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+function launchBrowser(url, event) {</span>
<a href="#l16.15"></a><span id="l16.15">   // Bail out if there is no url set, or an event was passed without left-click</span>
<a href="#l16.16"></a><span id="l16.16">   if (!url || (event &amp;&amp; event.button != 0)) {</span>
<a href="#l16.17"></a><span id="l16.17">     return;</span>
<a href="#l16.18"></a><span id="l16.18">   }</span>
<a href="#l16.19"></a><span id="l16.19"> </span>
<a href="#l16.20"></a><span id="l16.20">   // 0. Prevent people from trying to launch URLs such as javascript:foo();</span>
<a href="#l16.21"></a><span id="l16.21">   //    by only allowing URLs starting with http or https.</span>
<a href="#l16.22"></a><span id="l16.22">   // XXX: We likely will want to do this using nsIURLs in the future to</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/base/src/calProtocolHandler.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/base/src/calProtocolHandler.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -37,18 +37,17 @@ calProtocolHandler.prototype = {</span>
<a href="#l17.4"></a><span id="l17.4">                  this.mHttpProtocol.defaultPort, aSpec, anOriginalCharset, aBaseURI);</span>
<a href="#l17.5"></a><span id="l17.5">         return uri;</span>
<a href="#l17.6"></a><span id="l17.6">     },</span>
<a href="#l17.7"></a><span id="l17.7"> </span>
<a href="#l17.8"></a><span id="l17.8">     newChannel: function cph_newChannel(aUri) {</span>
<a href="#l17.9"></a><span id="l17.9">       return this.newChannel2(aUri, null);</span>
<a href="#l17.10"></a><span id="l17.10">     },</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-    newChannel2: function cph_newChannel2(aUri, aLoadInfo)</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineminus">-    {</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+    newChannel2: function cph_newChannel2(aUri, aLoadInfo) {</span>
<a href="#l17.15"></a><span id="l17.15">         // make sure to clone the uri, because we are about to change</span>
<a href="#l17.16"></a><span id="l17.16">         // it, and we don't want to change the original uri.</span>
<a href="#l17.17"></a><span id="l17.17">         let uri = aUri.clone();</span>
<a href="#l17.18"></a><span id="l17.18">         uri.scheme = this.mHttpProtocol.scheme;</span>
<a href="#l17.19"></a><span id="l17.19"> </span>
<a href="#l17.20"></a><span id="l17.20">         let channel;</span>
<a href="#l17.21"></a><span id="l17.21">         if (aLoadInfo) {</span>
<a href="#l17.22"></a><span id="l17.22">             channel = Services.io.newChannelFromURIWithLoadInfo(uri, aLoadInfo);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/base/src/calRecurrenceInfo.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/base/src/calRecurrenceInfo.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -685,18 +685,17 @@ calRecurrenceInfo.prototype = {</span>
<a href="#l18.4"></a><span id="l18.4">     // we'll do for incoming ITIP events though.</span>
<a href="#l18.5"></a><span id="l18.5">     //</span>
<a href="#l18.6"></a><span id="l18.6">     modifyException: function cRI_modifyException(anItem, aTakeOverOwnership) {</span>
<a href="#l18.7"></a><span id="l18.7">         this.ensureBaseItem();</span>
<a href="#l18.8"></a><span id="l18.8"> </span>
<a href="#l18.9"></a><span id="l18.9">         anItem = calTryWrappedJSObject(anItem);</span>
<a href="#l18.10"></a><span id="l18.10"> </span>
<a href="#l18.11"></a><span id="l18.11">         if (anItem.parentItem.calendar != this.mBaseItem.calendar &amp;&amp;</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-            anItem.parentItem.id != this.mBaseItem.id)</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">-        {</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineplus">+            anItem.parentItem.id != this.mBaseItem.id) {</span>
<a href="#l18.15"></a><span id="l18.15">             ERROR(&quot;recurrenceInfo::addException: item parentItem != this.mBaseItem (calendar/id)!&quot;);</span>
<a href="#l18.16"></a><span id="l18.16">             throw Components.results.NS_ERROR_INVALID_ARG;</span>
<a href="#l18.17"></a><span id="l18.17">         }</span>
<a href="#l18.18"></a><span id="l18.18"> </span>
<a href="#l18.19"></a><span id="l18.19">         if (anItem.recurrenceId == null) {</span>
<a href="#l18.20"></a><span id="l18.20">             ERROR(&quot;recurrenceInfo::addException: item with null recurrenceId!&quot;);</span>
<a href="#l18.21"></a><span id="l18.21">             throw Components.results.NS_ERROR_INVALID_ARG;</span>
<a href="#l18.22"></a><span id="l18.22">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/base/src/calUtils.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/base/src/calUtils.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -1016,18 +1016,17 @@ function showError(aMsg) {</span>
<a href="#l19.4"></a><span id="l19.4"> }</span>
<a href="#l19.5"></a><span id="l19.5"> </span>
<a href="#l19.6"></a><span id="l19.6"> /**</span>
<a href="#l19.7"></a><span id="l19.7">  * Pick whichever of &quot;black&quot; or &quot;white&quot; will look better when used as a text</span>
<a href="#l19.8"></a><span id="l19.8">  * color against a background of bgColor.</span>
<a href="#l19.9"></a><span id="l19.9">  *</span>
<a href="#l19.10"></a><span id="l19.10">  * @param bgColor   the background color as a &quot;#RRGGBB&quot; string</span>
<a href="#l19.11"></a><span id="l19.11">  */</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-function getContrastingTextColor(bgColor)</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-{</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+function getContrastingTextColor(bgColor) {</span>
<a href="#l19.15"></a><span id="l19.15">     var calcColor = bgColor.replace(/#/g, &quot;&quot;);</span>
<a href="#l19.16"></a><span id="l19.16">     var red = parseInt(calcColor.substring(0, 2), 16);</span>
<a href="#l19.17"></a><span id="l19.17">     var green = parseInt(calcColor.substring(2, 4), 16);</span>
<a href="#l19.18"></a><span id="l19.18">     var blue = parseInt(calcColor.substring(4, 6), 16);</span>
<a href="#l19.19"></a><span id="l19.19"> </span>
<a href="#l19.20"></a><span id="l19.20">     // Calculate the brightness (Y) value using the YUV color system.</span>
<a href="#l19.21"></a><span id="l19.21">     var brightness = (0.299 * red) + (0.587 * green) + (0.114 * blue);</span>
<a href="#l19.22"></a><span id="l19.22"> </span>
<a href="#l19.23"></a><span id="l19.23" class="difflineat">@@ -1070,18 +1069,17 @@ function calGetEndDateProp(aItem) {</span>
<a href="#l19.24"></a><span id="l19.24">  * Checks whether the passed item fits into the demanded range.</span>
<a href="#l19.25"></a><span id="l19.25">  *</span>
<a href="#l19.26"></a><span id="l19.26">  * @param item               the item</span>
<a href="#l19.27"></a><span id="l19.27">  * @param rangeStart         (inclusive) range start or null (open range)</span>
<a href="#l19.28"></a><span id="l19.28">  * @param rangeStart         (exclusive) range end or null (open range)</span>
<a href="#l19.29"></a><span id="l19.29">  * @param returnDtstartOrDue returns item's start (or due) date in case</span>
<a href="#l19.30"></a><span id="l19.30">  *                           the item is in the specified Range; null otherwise.</span>
<a href="#l19.31"></a><span id="l19.31">  */</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineminus">-function checkIfInRange(item, rangeStart, rangeEnd, returnDtstartOrDue)</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineminus">-{</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineplus">+function checkIfInRange(item, rangeStart, rangeEnd, returnDtstartOrDue) {</span>
<a href="#l19.35"></a><span id="l19.35">     let startDate;</span>
<a href="#l19.36"></a><span id="l19.36">     let endDate;</span>
<a href="#l19.37"></a><span id="l19.37">     let queryStart = ensureDateTime(rangeStart);</span>
<a href="#l19.38"></a><span id="l19.38">     if (isEvent(item)) {</span>
<a href="#l19.39"></a><span id="l19.39">         startDate = item.startDate;</span>
<a href="#l19.40"></a><span id="l19.40">         if (!startDate) { // DTSTART mandatory</span>
<a href="#l19.41"></a><span id="l19.41">             // xxx todo: should we assert this case?</span>
<a href="#l19.42"></a><span id="l19.42">             return null;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/import-export/calMonthGridPrinter.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/import-export/calMonthGridPrinter.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -45,18 +45,17 @@ calMonthPrinter.prototype = {</span>
<a href="#l20.4"></a><span id="l20.4">         if (aStart &amp;&amp; aEnd) {</span>
<a href="#l20.5"></a><span id="l20.5">             let startDate = this.normalizeStartDate(aStart);</span>
<a href="#l20.6"></a><span id="l20.6">             let endDate = this.normalizeEndDate(aEnd);</span>
<a href="#l20.7"></a><span id="l20.7">             let weekInfoService = cal.getWeekInfoService();</span>
<a href="#l20.8"></a><span id="l20.8"> </span>
<a href="#l20.9"></a><span id="l20.9">             // Now set up all the months we need to</span>
<a href="#l20.10"></a><span id="l20.10">             for (let current = startDate.clone();</span>
<a href="#l20.11"></a><span id="l20.11">                  weekInfoService.getEndOfWeek(current.endOfMonth).compare(endDate) &lt; 0;</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-                 current.month += 1)</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineminus">-            {</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineplus">+                 current.month += 1) {</span>
<a href="#l20.15"></a><span id="l20.15">                 this.setupMonth(document, current, dayTable);</span>
<a href="#l20.16"></a><span id="l20.16">             }</span>
<a href="#l20.17"></a><span id="l20.17">         }</span>
<a href="#l20.18"></a><span id="l20.18"> </span>
<a href="#l20.19"></a><span id="l20.19">         for (let item of aItems) {</span>
<a href="#l20.20"></a><span id="l20.20">             let itemStartDate = item[cal.calGetStartDateProp(item)] || item[cal.calGetEndDateProp(item)];</span>
<a href="#l20.21"></a><span id="l20.21">             let itemEndDate = item[cal.calGetEndDateProp(item)] || item[cal.calGetStartDateProp(item)];</span>
<a href="#l20.22"></a><span id="l20.22"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/lightning/components/calItipProtocolHandler.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/lightning/components/calItipProtocolHandler.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -82,18 +82,17 @@ ItipProtocolHandler.prototype = {</span>
<a href="#l21.4"></a><span id="l21.4">         dump(&quot;Creating new URI for &quot; + spec + &quot;\n&quot;);</span>
<a href="#l21.5"></a><span id="l21.5">         return url.QueryInterface(CI.nsIURI);</span>
<a href="#l21.6"></a><span id="l21.6">     },</span>
<a href="#l21.7"></a><span id="l21.7"> </span>
<a href="#l21.8"></a><span id="l21.8">     newChannel: function (URI) {</span>
<a href="#l21.9"></a><span id="l21.9">         return this.newChannel2(URI, null);</span>
<a href="#l21.10"></a><span id="l21.10">     },</span>
<a href="#l21.11"></a><span id="l21.11"> </span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-    newChannel2: function(URI, aLoadInfo)</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineminus">-    {</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+    newChannel2: function(URI, aLoadInfo) {</span>
<a href="#l21.15"></a><span id="l21.15">         dump(&quot;Creating new ItipChannel for &quot; + URI + &quot;\n&quot;);</span>
<a href="#l21.16"></a><span id="l21.16">         return new ItipChannel(URI);</span>
<a href="#l21.17"></a><span id="l21.17">     },</span>
<a href="#l21.18"></a><span id="l21.18"> };</span>
<a href="#l21.19"></a><span id="l21.19"> </span>
<a href="#l21.20"></a><span id="l21.20"> function ItipContentHandler() {</span>
<a href="#l21.21"></a><span id="l21.21">     this.wrappedJSObject = this;</span>
<a href="#l21.22"></a><span id="l21.22"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -364,19 +364,18 @@ ltn.invitation = {</span>
<a href="#l22.4"></a><span id="l22.4">                             // if att is the user his/herself, who accepted an invitation he/she was</span>
<a href="#l22.5"></a><span id="l22.5">                             // not invited to, we exclude him/her from decoration</span>
<a href="#l22.6"></a><span id="l22.6">                             let notExcluded = (excludeAddress == &quot;&quot; ||</span>
<a href="#l22.7"></a><span id="l22.7">                                                !att.includes(excludeAddress));</span>
<a href="#l22.8"></a><span id="l22.8">                             // decorate removed attendees</span>
<a href="#l22.9"></a><span id="l22.9">                             if (!(att in attendees) &amp;&amp; notExcluded) {</span>
<a href="#l22.10"></a><span id="l22.10">                                 _content2Child(oldAttendees[att], 'removed', att);</span>
<a href="#l22.11"></a><span id="l22.11">                                 content.appendChild(oldAttendees[att].parentNode.cloneNode(true));</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-                            }</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineminus">-                            // highlight partstat, role or usertype changes</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineminus">-                            else if ((att in attendees) &amp;&amp; notExcluded) {</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineplus">+                            } else if ((att in attendees) &amp;&amp; notExcluded) {</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineplus">+                                // highlight partstat, role or usertype changes</span>
<a href="#l22.17"></a><span id="l22.17">                                 let oldAtts = oldAttendees[att].parentNode</span>
<a href="#l22.18"></a><span id="l22.18">                                                                .getElementsByClassName(&quot;itip-icon&quot;)[0]</span>
<a href="#l22.19"></a><span id="l22.19">                                                                .attributes;</span>
<a href="#l22.20"></a><span id="l22.20">                                 let newAtts = attendees[att].parentNode</span>
<a href="#l22.21"></a><span id="l22.21">                                                             .getElementsByClassName(&quot;itip-icon&quot;)[0]</span>
<a href="#l22.22"></a><span id="l22.22">                                                             .attributes;</span>
<a href="#l22.23"></a><span id="l22.23">                                 let hasChanged = function (name) {</span>
<a href="#l22.24"></a><span id="l22.24">                                     return oldAtts.getNamedItem(name).value !=</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -1360,18 +1360,17 @@ calDavCalendar.prototype = {</span>
<a href="#l23.4"></a><span id="l23.4">             let headchannel = cal.prepHttpChannel(this.makeUri(), null, null, this);</span>
<a href="#l23.5"></a><span id="l23.5">             headchannel.requestMethod = &quot;OPTIONS&quot;;</span>
<a href="#l23.6"></a><span id="l23.6">             headchannel.open();</span>
<a href="#l23.7"></a><span id="l23.7">             headchannel.QueryInterface(Components.interfaces.nsIHttpChannel);</span>
<a href="#l23.8"></a><span id="l23.8">             try {</span>
<a href="#l23.9"></a><span id="l23.9">               if (headchannel.responseStatus != 200) {</span>
<a href="#l23.10"></a><span id="l23.10">                 throw &quot;OPTIONS returned unexpected status code: &quot; + headchannel.responseStatus;</span>
<a href="#l23.11"></a><span id="l23.11">               }</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-            }</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineminus">-            catch (e) {</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineplus">+            } catch (e) {</span>
<a href="#l23.15"></a><span id="l23.15">                 cal.WARN(&quot;CalDAV: Exception: &quot; + e);</span>
<a href="#l23.16"></a><span id="l23.16">                 notifyListener(Components.results.NS_ERROR_FAILURE);</span>
<a href="#l23.17"></a><span id="l23.17">             }</span>
<a href="#l23.18"></a><span id="l23.18">         }</span>
<a href="#l23.19"></a><span id="l23.19"> </span>
<a href="#l23.20"></a><span id="l23.20">         // Call getUpdatedItems right away if its the first refresh</span>
<a href="#l23.21"></a><span id="l23.21">         // *OR* if webdav Sync is enabled (It is redundant to send a request</span>
<a href="#l23.22"></a><span id="l23.22">         // to get the collection tag (getctag) on a calendar if it supports</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineat">@@ -2607,18 +2606,17 @@ calDavCalendar.prototype = {</span>
<a href="#l23.24"></a><span id="l23.24">         if (aString.charAt(0) != &quot;/&quot;) {</span>
<a href="#l23.25"></a><span id="l23.25">             aString = this.extractPathFromSpec(aString);</span>
<a href="#l23.26"></a><span id="l23.26">         }</span>
<a href="#l23.27"></a><span id="l23.27"> </span>
<a href="#l23.28"></a><span id="l23.28">         var uriComponents = aString.split(&quot;/&quot;);</span>
<a href="#l23.29"></a><span id="l23.29">         for (var i = 0; i &lt; uriComponents.length; i++) {</span>
<a href="#l23.30"></a><span id="l23.30">             try {</span>
<a href="#l23.31"></a><span id="l23.31">                 uriComponents[i] = decodeURIComponent(uriComponents[i]);</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineminus">-            }</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineminus">-            catch (e) {</span>
<a href="#l23.34"></a><span id="l23.34" class="difflineplus">+            } catch (e) {</span>
<a href="#l23.35"></a><span id="l23.35">                 cal.WARN(&quot;CalDAV: Exception decoding path &quot; + aString + &quot;, segment: &quot; + uriComponents[i]);</span>
<a href="#l23.36"></a><span id="l23.36">             }</span>
<a href="#l23.37"></a><span id="l23.37">         }</span>
<a href="#l23.38"></a><span id="l23.38">         return uriComponents.join(&quot;/&quot;);</span>
<a href="#l23.39"></a><span id="l23.39">     },</span>
<a href="#l23.40"></a><span id="l23.40">     isInbox: function caldav_isInbox(aString) {</span>
<a href="#l23.41"></a><span id="l23.41">         // Note: If you change this, make sure it really returns a boolean</span>
<a href="#l23.42"></a><span id="l23.42">         // value and not null!</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/calendar/providers/caldav/calDavRequestHandlers.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavRequestHandlers.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -377,22 +377,21 @@ webDavSyncHandler.prototype = {</span>
<a href="#l24.4"></a><span id="l24.4">             cal.WARN(&quot;CalDAV: No response status doing webdav sync for calendar &quot; + this.calendar.name);</span>
<a href="#l24.5"></a><span id="l24.5">         }</span>
<a href="#l24.6"></a><span id="l24.6"> </span>
<a href="#l24.7"></a><span id="l24.7">         if (responseStatus == 207) {</span>
<a href="#l24.8"></a><span id="l24.8">             // We only need to parse 207's, anything else is probably a</span>
<a href="#l24.9"></a><span id="l24.9">             // server error (i.e 50x).</span>
<a href="#l24.10"></a><span id="l24.10">             httpchannel.contentType = &quot;application/xml&quot;;</span>
<a href="#l24.11"></a><span id="l24.11">             this._reader.onStartRequest(request, context);</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-        }</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineminus">-        // Invalidate sync token with 4xx errors that could indicate the</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineminus">-        // sync token has become invalid and do a refresh</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineminus">-        else if (this.calendar.mWebdavSyncToken != null &amp;&amp;</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineminus">-                 responseStatus &gt;= 400 &amp;&amp;</span>
<a href="#l24.17"></a><span id="l24.17" class="difflineminus">-                 responseStatus &lt;= 499) {</span>
<a href="#l24.18"></a><span id="l24.18" class="difflineplus">+        } else if (this.calendar.mWebdavSyncToken != null &amp;&amp;</span>
<a href="#l24.19"></a><span id="l24.19" class="difflineplus">+                   responseStatus &gt;= 400 &amp;&amp;</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineplus">+                   responseStatus &lt;= 499) {</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineplus">+            // Invalidate sync token with 4xx errors that could indicate the</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineplus">+            // sync token has become invalid and do a refresh</span>
<a href="#l24.23"></a><span id="l24.23">             cal.LOG(&quot;CalDAV: Reseting sync token because server returned status code: &quot; + responseStatus);</span>
<a href="#l24.24"></a><span id="l24.24">             this._reader = null;</span>
<a href="#l24.25"></a><span id="l24.25">             this.calendar.mWebdavSyncToken = null;</span>
<a href="#l24.26"></a><span id="l24.26">             this.calendar.saveCalendarProperties();</span>
<a href="#l24.27"></a><span id="l24.27">             this.calendar.safeRefresh(this.changeLogListener);</span>
<a href="#l24.28"></a><span id="l24.28">         } else {</span>
<a href="#l24.29"></a><span id="l24.29">             cal.WARN(&quot;CalDAV: Error doing webdav sync: &quot; + responseStatus);</span>
<a href="#l24.30"></a><span id="l24.30">             this.calendar.reportDavError(Components.interfaces.calIErrors.DAV_REPORT_ERROR);</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineat">@@ -506,18 +505,17 @@ webDavSyncHandler.prototype = {</span>
<a href="#l24.32"></a><span id="l24.32">                 this.isInPropStat = false;</span>
<a href="#l24.33"></a><span id="l24.33">                 break;</span>
<a href="#l24.34"></a><span id="l24.34">             case &quot;propstat&quot;:</span>
<a href="#l24.35"></a><span id="l24.35">                 this.isInPropStat = true;</span>
<a href="#l24.36"></a><span id="l24.36">                 break;</span>
<a href="#l24.37"></a><span id="l24.37">             case &quot;status&quot;:</span>
<a href="#l24.38"></a><span id="l24.38">                 if (this.isInPropStat) {</span>
<a href="#l24.39"></a><span id="l24.39">                     this.tag = &quot;propstat_&quot; + aLocalName;</span>
<a href="#l24.40"></a><span id="l24.40" class="difflineminus">-                }</span>
<a href="#l24.41"></a><span id="l24.41" class="difflineminus">-                else {</span>
<a href="#l24.42"></a><span id="l24.42" class="difflineplus">+                } else {</span>
<a href="#l24.43"></a><span id="l24.43">                     this.tag = aLocalName;</span>
<a href="#l24.44"></a><span id="l24.44">                 }</span>
<a href="#l24.45"></a><span id="l24.45">                 this.currentResponse[this.tag] = &quot;&quot;;</span>
<a href="#l24.46"></a><span id="l24.46">                 break;</span>
<a href="#l24.47"></a><span id="l24.47">             case &quot;href&quot;:</span>
<a href="#l24.48"></a><span id="l24.48">             case &quot;getetag&quot;:</span>
<a href="#l24.49"></a><span id="l24.49">             case &quot;getcontenttype&quot;:</span>
<a href="#l24.50"></a><span id="l24.50">             case &quot;sync-token&quot;:</span>
<a href="#l24.51"></a><span id="l24.51" class="difflineat">@@ -552,18 +550,17 @@ webDavSyncHandler.prototype = {</span>
<a href="#l24.52"></a><span id="l24.52">                 // Deleted item</span>
<a href="#l24.53"></a><span id="l24.53">                 if (r.href &amp;&amp; r.href.length &amp;&amp;</span>
<a href="#l24.54"></a><span id="l24.54">                     r.status &amp;&amp;</span>
<a href="#l24.55"></a><span id="l24.55">                     r.status.length &amp;&amp;</span>
<a href="#l24.56"></a><span id="l24.56">                     r.status.indexOf(&quot; 404&quot;) &gt; 0) {</span>
<a href="#l24.57"></a><span id="l24.57">                     if (this.calendar.mHrefIndex[r.href]) {</span>
<a href="#l24.58"></a><span id="l24.58">                         this.changeCount++;</span>
<a href="#l24.59"></a><span id="l24.59">                         this.calendar.deleteTargetCalendarItem(r.href);</span>
<a href="#l24.60"></a><span id="l24.60" class="difflineminus">-                    }</span>
<a href="#l24.61"></a><span id="l24.61" class="difflineminus">-                    else {</span>
<a href="#l24.62"></a><span id="l24.62" class="difflineplus">+                    } else {</span>
<a href="#l24.63"></a><span id="l24.63">                         cal.LOG(&quot;CalDAV: skipping unfound deleted item : &quot; + r.href);</span>
<a href="#l24.64"></a><span id="l24.64">                     }</span>
<a href="#l24.65"></a><span id="l24.65">                 // Only handle Created or Updated calendar items</span>
<a href="#l24.66"></a><span id="l24.66">                 } else if (r.getcontenttype &amp;&amp;</span>
<a href="#l24.67"></a><span id="l24.67">                            r.getcontenttype.substr(0, 13) == &quot;text/calendar&quot; &amp;&amp;</span>
<a href="#l24.68"></a><span id="l24.68">                            r.getetag &amp;&amp; r.getetag.length &amp;&amp;</span>
<a href="#l24.69"></a><span id="l24.69">                            r.href &amp;&amp; r.href.length &amp;&amp;</span>
<a href="#l24.70"></a><span id="l24.70">                            (!r.status ||                 // Draft 3 does not require</span>
<a href="#l24.71"></a><span id="l24.71" class="difflineat">@@ -863,18 +860,17 @@ multigetSyncHandler.prototype = {</span>
<a href="#l24.72"></a><span id="l24.72">                 this.isInPropStat = false;</span>
<a href="#l24.73"></a><span id="l24.73">                 break;</span>
<a href="#l24.74"></a><span id="l24.74">             case &quot;propstat&quot;:</span>
<a href="#l24.75"></a><span id="l24.75">                 this.isInPropStat = true;</span>
<a href="#l24.76"></a><span id="l24.76">                 break;</span>
<a href="#l24.77"></a><span id="l24.77">             case &quot;status&quot;:</span>
<a href="#l24.78"></a><span id="l24.78">                 if (this.isInPropStat) {</span>
<a href="#l24.79"></a><span id="l24.79">                     this.tag = &quot;propstat_&quot; + aLocalName;</span>
<a href="#l24.80"></a><span id="l24.80" class="difflineminus">-                }</span>
<a href="#l24.81"></a><span id="l24.81" class="difflineminus">-                else {</span>
<a href="#l24.82"></a><span id="l24.82" class="difflineplus">+                } else {</span>
<a href="#l24.83"></a><span id="l24.83">                     this.tag = aLocalName;</span>
<a href="#l24.84"></a><span id="l24.84">                 }</span>
<a href="#l24.85"></a><span id="l24.85">                 this.currentResponse[this.tag] = &quot;&quot;;</span>
<a href="#l24.86"></a><span id="l24.86">                 break;</span>
<a href="#l24.87"></a><span id="l24.87">             case &quot;calendar-data&quot;:</span>
<a href="#l24.88"></a><span id="l24.88">             case &quot;href&quot;:</span>
<a href="#l24.89"></a><span id="l24.89">             case &quot;getetag&quot;:</span>
<a href="#l24.90"></a><span id="l24.90">                 this.tag = aLocalName.replace(/-/g, '');</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/providers/composite/calCompositeCalendar.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/providers/composite/calCompositeCalendar.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -464,25 +464,17 @@ calCompositeGetListenerHelper.prototype </span>
<a href="#l25.4"></a><span id="l25.4">                         this.mCompositeCalendar.mStatusObserver.stopMeteors();</span>
<a href="#l25.5"></a><span id="l25.5">                     }</span>
<a href="#l25.6"></a><span id="l25.6">                 }</span>
<a href="#l25.7"></a><span id="l25.7">             });</span>
<a href="#l25.8"></a><span id="l25.8">         }</span>
<a href="#l25.9"></a><span id="l25.9">         return this.mOpGroup;</span>
<a href="#l25.10"></a><span id="l25.10">     },</span>
<a href="#l25.11"></a><span id="l25.11"> </span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-    QueryInterface: function (aIID) {</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">-        if (!aIID.equals(Components.interfaces.nsISupports) &amp;&amp;</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineminus">-            !aIID.equals(Components.interfaces.calIOperationListener))</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineminus">-        {</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineminus">-            throw Components.results.NS_ERROR_NO_INTERFACE;</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineminus">-        }</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineminus">-</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineminus">-        return this;</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineminus">-    },</span>
<a href="#l25.21"></a><span id="l25.21" class="difflineplus">+    QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]),</span>
<a href="#l25.22"></a><span id="l25.22"> </span>
<a href="#l25.23"></a><span id="l25.23">     onOperationComplete: function (aCalendar, aStatus, aOperationType, aId, aDetail) {</span>
<a href="#l25.24"></a><span id="l25.24">         if (!this.mRealListener) {</span>
<a href="#l25.25"></a><span id="l25.25">             // has been cancelled, ignore any providers firing on this...</span>
<a href="#l25.26"></a><span id="l25.26">             return;</span>
<a href="#l25.27"></a><span id="l25.27">         }</span>
<a href="#l25.28"></a><span id="l25.28">         if (this.mFinished) {</span>
<a href="#l25.29"></a><span id="l25.29">             dump(&quot;+++ calCompositeGetListenerHelper.onOperationComplete: called with mFinished == true!&quot;);</span>
<a href="#l25.30"></a><span id="l25.30" class="difflineat">@@ -526,20 +518,18 @@ calCompositeGetListenerHelper.prototype </span>
<a href="#l25.31"></a><span id="l25.31">             return;</span>
<a href="#l25.32"></a><span id="l25.32">         }</span>
<a href="#l25.33"></a><span id="l25.33"> </span>
<a href="#l25.34"></a><span id="l25.34">         // ignore if we have a max and we're past it</span>
<a href="#l25.35"></a><span id="l25.35">         if (this.mMaxItems &amp;&amp; this.mItemsReceived &gt;= this.mMaxItems) {</span>
<a href="#l25.36"></a><span id="l25.36">             return;</span>
<a href="#l25.37"></a><span id="l25.37">         }</span>
<a href="#l25.38"></a><span id="l25.38"> </span>
<a href="#l25.39"></a><span id="l25.39" class="difflineminus">-        if (Components.isSuccessCode(aStatus) &amp;&amp;</span>
<a href="#l25.40"></a><span id="l25.40" class="difflineminus">-            this.mMaxItems &amp;&amp;</span>
<a href="#l25.41"></a><span id="l25.41" class="difflineminus">-            ((this.mItemsReceived + aCount) &gt; this.mMaxItems))</span>
<a href="#l25.42"></a><span id="l25.42" class="difflineminus">-        {</span>
<a href="#l25.43"></a><span id="l25.43" class="difflineplus">+        if (Components.isSuccessCode(aStatus) &amp;&amp; this.mMaxItems &amp;&amp;</span>
<a href="#l25.44"></a><span id="l25.44" class="difflineplus">+            ((this.mItemsReceived + aCount) &gt; this.mMaxItems)) {</span>
<a href="#l25.45"></a><span id="l25.45">             // this will blow past the limit</span>
<a href="#l25.46"></a><span id="l25.46">             aCount = this.mMaxItems - this.mItemsReceived;</span>
<a href="#l25.47"></a><span id="l25.47">             aItems = aItems.slice(0, aCount);</span>
<a href="#l25.48"></a><span id="l25.48">         }</span>
<a href="#l25.49"></a><span id="l25.49"> </span>
<a href="#l25.50"></a><span id="l25.50">         // send GetResults to the real listener</span>
<a href="#l25.51"></a><span id="l25.51">         this.mRealListener.onGetResult(aCalendar, aStatus, aItemType, aDetail, aCount, aItems);</span>
<a href="#l25.52"></a><span id="l25.52">         this.mItemsReceived += aCount;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -206,18 +206,17 @@ calICSCalendar.prototype = {</span>
<a href="#l26.4"></a><span id="l26.4">     asyncOnChannelRedirect: function(aOldChannel, aNewChannel, aFlags, aCallback) {</span>
<a href="#l26.5"></a><span id="l26.5">         this.prepareChannel(aNewChannel, true);</span>
<a href="#l26.6"></a><span id="l26.6">         aCallback.onRedirectVerifyCallback(Components.results.NS_OK);</span>
<a href="#l26.7"></a><span id="l26.7">     },</span>
<a href="#l26.8"></a><span id="l26.8"> </span>
<a href="#l26.9"></a><span id="l26.9">     // nsIStreamLoaderObserver impl</span>
<a href="#l26.10"></a><span id="l26.10">     // Listener for download. Parse the downloaded file</span>
<a href="#l26.11"></a><span id="l26.11"> </span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-    onStreamComplete: function(loader, ctxt, status, resultLength, result)</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineminus">-    {</span>
<a href="#l26.14"></a><span id="l26.14" class="difflineplus">+    onStreamComplete: function(loader, ctxt, status, resultLength, result) {</span>
<a href="#l26.15"></a><span id="l26.15">         let forceRefresh = ctxt.QueryInterface(Components.interfaces.nsISupportsPRBool).data;</span>
<a href="#l26.16"></a><span id="l26.16">         let cont = false;</span>
<a href="#l26.17"></a><span id="l26.17"> </span>
<a href="#l26.18"></a><span id="l26.18">         if (Components.isSuccessCode(status)) {</span>
<a href="#l26.19"></a><span id="l26.19">             // Allow the hook to get needed data (like an etag) of the channel</span>
<a href="#l26.20"></a><span id="l26.20">             cont = this.mHooks.onAfterGet(loader.request, forceRefresh);</span>
<a href="#l26.21"></a><span id="l26.21">             cal.LOG(&quot;[calICSCalendar] Loading ICS succeeded, needs further processing: &quot; + cont);</span>
<a href="#l26.22"></a><span id="l26.22">         } else {</span>
<a href="#l26.23"></a><span id="l26.23" class="difflineat">@@ -316,18 +315,17 @@ calICSCalendar.prototype = {</span>
<a href="#l26.24"></a><span id="l26.24"> </span>
<a href="#l26.25"></a><span id="l26.25">     doWriteICS: function () {</span>
<a href="#l26.26"></a><span id="l26.26">         cal.LOG(&quot;[calICSCalendar] Writing ICS File &quot; + this.uri.spec);</span>
<a href="#l26.27"></a><span id="l26.27">         var savedthis = this;</span>
<a href="#l26.28"></a><span id="l26.28">         var listener =</span>
<a href="#l26.29"></a><span id="l26.29">         {</span>
<a href="#l26.30"></a><span id="l26.30">             serializer: null,</span>
<a href="#l26.31"></a><span id="l26.31">             QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]),</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineminus">-            onOperationComplete: function(aCalendar, aStatus, aOperationType, aId, aDetail)</span>
<a href="#l26.33"></a><span id="l26.33" class="difflineminus">-            {</span>
<a href="#l26.34"></a><span id="l26.34" class="difflineplus">+            onOperationComplete: function(aCalendar, aStatus, aOperationType, aId, aDetail) {</span>
<a href="#l26.35"></a><span id="l26.35">                 var inLastWindowClosingSurvivalArea = false;</span>
<a href="#l26.36"></a><span id="l26.36">                 try {</span>
<a href="#l26.37"></a><span id="l26.37">                     // All events are returned. Now set up a channel and a</span>
<a href="#l26.38"></a><span id="l26.38">                     // streamloader to upload.  onStopRequest will be called</span>
<a href="#l26.39"></a><span id="l26.39">                     // once the write has finished</span>
<a href="#l26.40"></a><span id="l26.40">                     var channel = Services.io.newChannelFromURI2(savedthis.mUri,</span>
<a href="#l26.41"></a><span id="l26.41">                                                                  null,</span>
<a href="#l26.42"></a><span id="l26.42">                                                                  Services.scriptSecurityManager.getSystemPrincipal(),</span>
<a href="#l26.43"></a><span id="l26.43" class="difflineat">@@ -369,18 +367,17 @@ calICSCalendar.prototype = {</span>
<a href="#l26.44"></a><span id="l26.44">                     savedthis.mObserver.onError(savedthis.superCalendar,</span>
<a href="#l26.45"></a><span id="l26.45">                                                 ex.result, &quot;The calendar could not be saved; there &quot; +</span>
<a href="#l26.46"></a><span id="l26.46">                                                 &quot;was a failure: 0x&quot; + ex.result.toString(16));</span>
<a href="#l26.47"></a><span id="l26.47">                     savedthis.mObserver.onError(savedthis.superCalendar, calIErrors.MODIFICATION_FAILED, &quot;&quot;);</span>
<a href="#l26.48"></a><span id="l26.48">                     savedthis.unlock(calIErrors.MODIFICATION_FAILED);</span>
<a href="#l26.49"></a><span id="l26.49">                     savedthis.forceRefresh();</span>
<a href="#l26.50"></a><span id="l26.50">                 }</span>
<a href="#l26.51"></a><span id="l26.51">             },</span>
<a href="#l26.52"></a><span id="l26.52" class="difflineminus">-            onGetResult: function(aCalendar, aStatus, aItemType, aDetail, aCount, aItems)</span>
<a href="#l26.53"></a><span id="l26.53" class="difflineminus">-            {</span>
<a href="#l26.54"></a><span id="l26.54" class="difflineplus">+            onGetResult: function(aCalendar, aStatus, aItemType, aDetail, aCount, aItems) {</span>
<a href="#l26.55"></a><span id="l26.55">                 this.serializer.addItems(aItems, aCount);</span>
<a href="#l26.56"></a><span id="l26.56">             }</span>
<a href="#l26.57"></a><span id="l26.57">         };</span>
<a href="#l26.58"></a><span id="l26.58">         listener.serializer = Components.classes[&quot;@mozilla.org/calendar/ics-serializer;1&quot;].</span>
<a href="#l26.59"></a><span id="l26.59">                                          createInstance(Components.interfaces.calIIcsSerializer);</span>
<a href="#l26.60"></a><span id="l26.60">         for (let comp of this.unmappedComponents) {</span>
<a href="#l26.61"></a><span id="l26.61">             listener.serializer.addComponent(comp);</span>
<a href="#l26.62"></a><span id="l26.62">         }</span>
<a href="#l26.63"></a><span id="l26.63" class="difflineat">@@ -414,18 +411,17 @@ calICSCalendar.prototype = {</span>
<a href="#l26.64"></a><span id="l26.64">          // All data must be consumed. For an upload channel, there is</span>
<a href="#l26.65"></a><span id="l26.65">          // no meaningfull data. So it gets read and then ignored</span>
<a href="#l26.66"></a><span id="l26.66">          let scriptableInputStream =</span>
<a href="#l26.67"></a><span id="l26.67">              Components.classes[&quot;@mozilla.org/scriptableinputstream;1&quot;]</span>
<a href="#l26.68"></a><span id="l26.68">                        .createInstance(Components.interfaces.nsIScriptableInputStream);</span>
<a href="#l26.69"></a><span id="l26.69">          scriptableInputStream.init(inStream);</span>
<a href="#l26.70"></a><span id="l26.70">          scriptableInputStream.read(-1);</span>
<a href="#l26.71"></a><span id="l26.71">     },</span>
<a href="#l26.72"></a><span id="l26.72" class="difflineminus">-    onStopRequest: function(request, ctxt, status, errorMsg)</span>
<a href="#l26.73"></a><span id="l26.73" class="difflineminus">-    {</span>
<a href="#l26.74"></a><span id="l26.74" class="difflineplus">+    onStopRequest: function(request, ctxt, status, errorMsg) {</span>
<a href="#l26.75"></a><span id="l26.75">         ctxt = ctxt.wrappedJSObject;</span>
<a href="#l26.76"></a><span id="l26.76">         let httpChannel;</span>
<a href="#l26.77"></a><span id="l26.77">         let requestSucceeded = false;</span>
<a href="#l26.78"></a><span id="l26.78">         try {</span>
<a href="#l26.79"></a><span id="l26.79">             httpChannel = request.QueryInterface(Components.interfaces.nsIHttpChannel);</span>
<a href="#l26.80"></a><span id="l26.80">             requestSucceeded = httpChannel.requestSucceeded;</span>
<a href="#l26.81"></a><span id="l26.81">         } catch (e) {</span>
<a href="#l26.82"></a><span id="l26.82">         }</span>
<a href="#l26.83"></a><span id="l26.83" class="difflineat">@@ -491,28 +487,25 @@ calICSCalendar.prototype = {</span>
<a href="#l26.84"></a><span id="l26.84">         this.processQueue();</span>
<a href="#l26.85"></a><span id="l26.85">     },</span>
<a href="#l26.86"></a><span id="l26.86"> </span>
<a href="#l26.87"></a><span id="l26.87">     getItem: function (aId, aListener) {</span>
<a href="#l26.88"></a><span id="l26.88">         this.queue.push({action: 'get_item', id: aId, listener: aListener});</span>
<a href="#l26.89"></a><span id="l26.89">         this.processQueue();</span>
<a href="#l26.90"></a><span id="l26.90">     },</span>
<a href="#l26.91"></a><span id="l26.91"> </span>
<a href="#l26.92"></a><span id="l26.92" class="difflineminus">-    getItems: function (aItemFilter, aCount,</span>
<a href="#l26.93"></a><span id="l26.93" class="difflineminus">-                        aRangeStart, aRangeEnd, aListener)</span>
<a href="#l26.94"></a><span id="l26.94" class="difflineminus">-    {</span>
<a href="#l26.95"></a><span id="l26.95" class="difflineplus">+    getItems: function(aItemFilter, aCount, aRangeStart, aRangeEnd, aListener) {</span>
<a href="#l26.96"></a><span id="l26.96">         this.queue.push({action: 'get_items',</span>
<a href="#l26.97"></a><span id="l26.97">                          itemFilter: aItemFilter, count: aCount,</span>
<a href="#l26.98"></a><span id="l26.98">                          rangeStart: aRangeStart, rangeEnd: aRangeEnd,</span>
<a href="#l26.99"></a><span id="l26.99">                          listener: aListener});</span>
<a href="#l26.100"></a><span id="l26.100">         this.processQueue();</span>
<a href="#l26.101"></a><span id="l26.101">     },</span>
<a href="#l26.102"></a><span id="l26.102"> </span>
<a href="#l26.103"></a><span id="l26.103" class="difflineminus">-    processQueue: function ()</span>
<a href="#l26.104"></a><span id="l26.104" class="difflineminus">-    {</span>
<a href="#l26.105"></a><span id="l26.105" class="difflineplus">+    processQueue: function() {</span>
<a href="#l26.106"></a><span id="l26.106">         if (this.isLocked()) {</span>
<a href="#l26.107"></a><span id="l26.107">             return;</span>
<a href="#l26.108"></a><span id="l26.108">         }</span>
<a href="#l26.109"></a><span id="l26.109"> </span>
<a href="#l26.110"></a><span id="l26.110">         function modListener(action) {</span>
<a href="#l26.111"></a><span id="l26.111">             this.mAction = action;</span>
<a href="#l26.112"></a><span id="l26.112">         }</span>
<a href="#l26.113"></a><span id="l26.113">         modListener.prototype = {</span>
<a href="#l26.114"></a><span id="l26.114" class="difflineat">@@ -598,26 +591,24 @@ calICSCalendar.prototype = {</span>
<a href="#l26.115"></a><span id="l26.115">                 }</span>
<a href="#l26.116"></a><span id="l26.116">             });</span>
<a href="#l26.117"></a><span id="l26.117">         this.mModificationActions = [];</span>
<a href="#l26.118"></a><span id="l26.118"> </span>
<a href="#l26.119"></a><span id="l26.119">         this.locked = false;</span>
<a href="#l26.120"></a><span id="l26.120">         this.processQueue();</span>
<a href="#l26.121"></a><span id="l26.121">     },</span>
<a href="#l26.122"></a><span id="l26.122"> </span>
<a href="#l26.123"></a><span id="l26.123" class="difflineminus">-    isLocked: function () {</span>
<a href="#l26.124"></a><span id="l26.124" class="difflineplus">+    isLocked: function() {</span>
<a href="#l26.125"></a><span id="l26.125">         return this.locked;</span>
<a href="#l26.126"></a><span id="l26.126">     },</span>
<a href="#l26.127"></a><span id="l26.127"> </span>
<a href="#l26.128"></a><span id="l26.128" class="difflineminus">-    startBatch: function ()</span>
<a href="#l26.129"></a><span id="l26.129" class="difflineminus">-    {</span>
<a href="#l26.130"></a><span id="l26.130" class="difflineplus">+    startBatch: function() {</span>
<a href="#l26.131"></a><span id="l26.131">         this.mObserver.onStartBatch();</span>
<a href="#l26.132"></a><span id="l26.132">     },</span>
<a href="#l26.133"></a><span id="l26.133" class="difflineminus">-    endBatch: function ()</span>
<a href="#l26.134"></a><span id="l26.134" class="difflineminus">-    {</span>
<a href="#l26.135"></a><span id="l26.135" class="difflineplus">+    endBatch: function() {</span>
<a href="#l26.136"></a><span id="l26.136">         this.mObserver.onEndBatch();</span>
<a href="#l26.137"></a><span id="l26.137">     },</span>
<a href="#l26.138"></a><span id="l26.138"> </span>
<a href="#l26.139"></a><span id="l26.139">     /**</span>
<a href="#l26.140"></a><span id="l26.140">      * @see nsIInterfaceRequestor</span>
<a href="#l26.141"></a><span id="l26.141">      * @see calProviderUtils.jsm</span>
<a href="#l26.142"></a><span id="l26.142">      */</span>
<a href="#l26.143"></a><span id="l26.143">     getInterface: cal.InterfaceRequestor_getInterface,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -662,18 +662,17 @@ calStorageCalendar.prototype = {</span>
<a href="#l27.4"></a><span id="l27.4">     getItems: function cSC_getItems(aItemFilter, aCount,</span>
<a href="#l27.5"></a><span id="l27.5">                                     aRangeStart, aRangeEnd, aListener) {</span>
<a href="#l27.6"></a><span id="l27.6">         let this_ = this;</span>
<a href="#l27.7"></a><span id="l27.7">         cal.postPone(function() {</span>
<a href="#l27.8"></a><span id="l27.8">             this_.getItems_(aItemFilter, aCount, aRangeStart, aRangeEnd, aListener);</span>
<a href="#l27.9"></a><span id="l27.9">         });</span>
<a href="#l27.10"></a><span id="l27.10">     },</span>
<a href="#l27.11"></a><span id="l27.11">     getItems_: function cSC_getItems_(aItemFilter, aCount,</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-                                      aRangeStart, aRangeEnd, aListener)</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineminus">-    {</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineplus">+                                      aRangeStart, aRangeEnd, aListener) {</span>
<a href="#l27.15"></a><span id="l27.15">         if (!aListener) {</span>
<a href="#l27.16"></a><span id="l27.16">             return;</span>
<a href="#l27.17"></a><span id="l27.17">         }</span>
<a href="#l27.18"></a><span id="l27.18"> </span>
<a href="#l27.19"></a><span id="l27.19">         let self = this;</span>
<a href="#l27.20"></a><span id="l27.20"> </span>
<a href="#l27.21"></a><span id="l27.21">         let itemsFound = [];</span>
<a href="#l27.22"></a><span id="l27.22">         let startTime = -0x7fffffffffffffff;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/providers/storage/calStorageUpgrade.jsm</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageUpgrade.jsm</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1005,18 +1005,17 @@ upgrade.v13 = function upgrade_v13(db, v</span>
<a href="#l28.4"></a><span id="l28.4">         if (db) {</span>
<a href="#l28.5"></a><span id="l28.5">             for (let itemTable of [&quot;events&quot;, &quot;todos&quot;]) {</span>
<a href="#l28.6"></a><span id="l28.6">                 let stmt = createStatement(db,</span>
<a href="#l28.7"></a><span id="l28.7">                                            &quot;SELECT id, cal_id FROM cal_&quot; + itemTable);</span>
<a href="#l28.8"></a><span id="l28.8">                 try {</span>
<a href="#l28.9"></a><span id="l28.9">                     while (stmt.executeStep()) {</span>
<a href="#l28.10"></a><span id="l28.10">                         calIds[stmt.row.id] = stmt.row.cal_id;</span>
<a href="#l28.11"></a><span id="l28.11">                     }</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-                }</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineminus">-                finally {</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineplus">+                } finally {</span>
<a href="#l28.15"></a><span id="l28.15">                     stmt.reset();</span>
<a href="#l28.16"></a><span id="l28.16">                 }</span>
<a href="#l28.17"></a><span id="l28.17">             }</span>
<a href="#l28.18"></a><span id="l28.18">         }</span>
<a href="#l28.19"></a><span id="l28.19"> </span>
<a href="#l28.20"></a><span id="l28.20">         for (let tblid of [&quot;attendees&quot;, &quot;recurrence&quot;, &quot;properties&quot;,</span>
<a href="#l28.21"></a><span id="l28.21">                            &quot;attachments&quot;]) {</span>
<a href="#l28.22"></a><span id="l28.22">             addColumn(tbl, &quot;cal_&quot; + tblid, &quot;cal_id&quot;, &quot;INTEGER&quot;, db);</span>
<a href="#l28.23"></a><span id="l28.23" class="difflineat">@@ -1223,18 +1222,17 @@ upgrade.v17 = function upgrade_v17(db, v</span>
<a href="#l28.24"></a><span id="l28.24">                 stmt = db.createStatement(&quot;SELECT recurrence_id_tz,&quot; +</span>
<a href="#l28.25"></a><span id="l28.25">                                               &quot;       recurrence_id&quot; +</span>
<a href="#l28.26"></a><span id="l28.26">                                               &quot;  FROM cal_&quot; + tblName +</span>
<a href="#l28.27"></a><span id="l28.27">                                               &quot; LIMIT 1&quot;);</span>
<a href="#l28.28"></a><span id="l28.28">                 stmt.executeStep();</span>
<a href="#l28.29"></a><span id="l28.29">             } catch (e) {</span>
<a href="#l28.30"></a><span id="l28.30">                 // An error happened, which means the cols don't exist</span>
<a href="#l28.31"></a><span id="l28.31">                 hasColumns = false;</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineminus">-            }</span>
<a href="#l28.33"></a><span id="l28.33" class="difflineminus">-            finally {</span>
<a href="#l28.34"></a><span id="l28.34" class="difflineplus">+            } finally {</span>
<a href="#l28.35"></a><span id="l28.35">                 if (stmt) {</span>
<a href="#l28.36"></a><span id="l28.36">                     stmt.finalize();</span>
<a href="#l28.37"></a><span id="l28.37">                 }</span>
<a href="#l28.38"></a><span id="l28.38">             }</span>
<a href="#l28.39"></a><span id="l28.39"> </span>
<a href="#l28.40"></a><span id="l28.40">             // Only add the columns if they are not there yet (i.e added in v16)</span>
<a href="#l28.41"></a><span id="l28.41">             // Since relations were broken all along, also make sure and add the</span>
<a href="#l28.42"></a><span id="l28.42">             // columns to the javascript object if there is no database.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapRequest.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapRequest.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -107,19 +107,18 @@ calWcapRequest.prototype = {</span>
<a href="#l29.4"></a><span id="l29.4">         }</span>
<a href="#l29.5"></a><span id="l29.5">     },</span>
<a href="#l29.6"></a><span id="l29.6"> </span>
<a href="#l29.7"></a><span id="l29.7">     detachSubRequest: function calWcapRequest_detachSubRequest(req, err) {</span>
<a href="#l29.8"></a><span id="l29.8">         this.m_attachedRequests = this.m_attachedRequests.filter( function(req_) { return req.id != req_.id; } );</span>
<a href="#l29.9"></a><span id="l29.9">         if (err) {</span>
<a href="#l29.10"></a><span id="l29.10">             // first failing sub request stops parent request:</span>
<a href="#l29.11"></a><span id="l29.11">             this.execRespFunc(err);</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-        }</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineminus">-        // assures that respFunc is executed after all sub requests have been completed:</span>
<a href="#l29.14"></a><span id="l29.14" class="difflineminus">-        else if (!this.m_locked &amp;&amp; this.m_attachedRequests.length == 0) {</span>
<a href="#l29.15"></a><span id="l29.15" class="difflineplus">+        } else if (!this.m_locked &amp;&amp; this.m_attachedRequests.length == 0) {</span>
<a href="#l29.16"></a><span id="l29.16" class="difflineplus">+            // assures that respFunc is executed after all sub requests have been completed:</span>
<a href="#l29.17"></a><span id="l29.17">             this.execRespFunc();</span>
<a href="#l29.18"></a><span id="l29.18">         }</span>
<a href="#l29.19"></a><span id="l29.19">     },</span>
<a href="#l29.20"></a><span id="l29.20"> </span>
<a href="#l29.21"></a><span id="l29.21">     cancelAllSubRequests: function calWcapRequest_cancelAllSubRequests(status) {</span>
<a href="#l29.22"></a><span id="l29.22">         var attachedRequests = this.m_attachedRequests;</span>
<a href="#l29.23"></a><span id="l29.23">         this.m_attachedRequests = [];</span>
<a href="#l29.24"></a><span id="l29.24">         attachedRequests.forEach( function(req) { req.cancel(null); } );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -628,18 +628,17 @@ calWcapSession.prototype = {</span>
<a href="#l30.4"></a><span id="l30.4">                                 try {</span>
<a href="#l30.5"></a><span id="l30.5">                                     var calId = calendar.calId;</span>
<a href="#l30.6"></a><span id="l30.6">                                     if ((cals[calId] !== undefined) &amp;&amp; !retrievedCals[calId]) {</span>
<a href="#l30.7"></a><span id="l30.7">                                         retrievedCals[calId] = calendar;</span>
<a href="#l30.8"></a><span id="l30.8">                                         if (respFunc) {</span>
<a href="#l30.9"></a><span id="l30.9">                                             respFunc(calendar);</span>
<a href="#l30.10"></a><span id="l30.10">                                         }</span>
<a href="#l30.11"></a><span id="l30.11">                                     }</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-                                }</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineminus">-                                catch (exc) { // ignore but log any errors on subscribed calendars:</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineplus">+                                } catch (exc) { // ignore but log any errors on subscribed calendars:</span>
<a href="#l30.15"></a><span id="l30.15">                                     logError(exc, this_);</span>
<a href="#l30.16"></a><span id="l30.16">                                 }</span>
<a href="#l30.17"></a><span id="l30.17">                             }</span>
<a href="#l30.18"></a><span id="l30.18">                         } catch (exc) { // ignore but log any errors on subscribed calendars:</span>
<a href="#l30.19"></a><span id="l30.19">                             logError(exc, this_);</span>
<a href="#l30.20"></a><span id="l30.20">                         }</span>
<a href="#l30.21"></a><span id="l30.21">                     }</span>
<a href="#l30.22"></a><span id="l30.22">                 };</span>
<a href="#l30.23"></a><span id="l30.23" class="difflineat">@@ -1106,18 +1105,17 @@ calWcapSession.prototype = {</span>
<a href="#l30.24"></a><span id="l30.24">         }</span>
<a href="#l30.25"></a><span id="l30.25">     },</span>
<a href="#l30.26"></a><span id="l30.26"> </span>
<a href="#l30.27"></a><span id="l30.27">     // called before the delete actually takes place</span>
<a href="#l30.28"></a><span id="l30.28">     onCalendarDeleting: function calWcapSession_onCalendarDeleting(aCalendar) {</span>
<a href="#l30.29"></a><span id="l30.29">     }</span>
<a href="#l30.30"></a><span id="l30.30"> };</span>
<a href="#l30.31"></a><span id="l30.31"> </span>
<a href="#l30.32"></a><span id="l30.32" class="difflineminus">-function confirmInsecureLogin(uri)</span>
<a href="#l30.33"></a><span id="l30.33" class="difflineminus">-{</span>
<a href="#l30.34"></a><span id="l30.34" class="difflineplus">+function confirmInsecureLogin(uri) {</span>
<a href="#l30.35"></a><span id="l30.35">     if (!confirmInsecureLogin.m_confirmedHttpLogins) {</span>
<a href="#l30.36"></a><span id="l30.36">         confirmInsecureLogin.m_confirmedHttpLogins = {};</span>
<a href="#l30.37"></a><span id="l30.37">         var confirmedHttpLogins = getPref(&quot;calendar.wcap.confirmed_http_logins&quot;, &quot;&quot;);</span>
<a href="#l30.38"></a><span id="l30.38">         var tuples = confirmedHttpLogins.split(',');</span>
<a href="#l30.39"></a><span id="l30.39">         for (var tuple of tuples) {</span>
<a href="#l30.40"></a><span id="l30.40">             var ar = tuple.split(':');</span>
<a href="#l30.41"></a><span id="l30.41">             confirmInsecureLogin.m_confirmedHttpLogins[ar[0]] = ar[1];</span>
<a href="#l30.42"></a><span id="l30.42">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -366,18 +366,17 @@</span>
<a href="#l31.4"></a><span id="l31.4">         &lt;/body&gt;</span>
<a href="#l31.5"></a><span id="l31.5">       &lt;/method&gt;</span>
<a href="#l31.6"></a><span id="l31.6"> </span>
<a href="#l31.7"></a><span id="l31.7">       &lt;method name=&quot;clickDate&quot;&gt;</span>
<a href="#l31.8"></a><span id="l31.8">         &lt;parameter name=&quot;aEvent&quot; /&gt;</span>
<a href="#l31.9"></a><span id="l31.9">         &lt;body&gt;</span>
<a href="#l31.10"></a><span id="l31.10">           &lt;![CDATA[</span>
<a href="#l31.11"></a><span id="l31.11">             var datepicker = aEvent.target.parentNode.parentNode.kDatePicker;</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-            if (!datepicker.mInPopup)</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineminus">-            {</span>
<a href="#l31.14"></a><span id="l31.14" class="difflineplus">+            if (!datepicker.mInPopup) {</span>
<a href="#l31.15"></a><span id="l31.15">               // aEvent.target is the minimonth</span>
<a href="#l31.16"></a><span id="l31.16">               datepicker.update(new Date(aEvent.target.value), true);</span>
<a href="#l31.17"></a><span id="l31.17">               // select changed value so no cursor appears (can't type to it).</span>
<a href="#l31.18"></a><span id="l31.18">               datepicker.select();</span>
<a href="#l31.19"></a><span id="l31.19">               aEvent.target.parentNode.hidePopup();</span>
<a href="#l31.20"></a><span id="l31.20">             }</span>
<a href="#l31.21"></a><span id="l31.21">           ]]&gt;</span>
<a href="#l31.22"></a><span id="l31.22">         &lt;/body&gt;</span>
<a href="#l31.23"></a><span id="l31.23" class="difflineat">@@ -1896,18 +1895,17 @@</span>
<a href="#l31.24"></a><span id="l31.24">                     // captured by the optional separator pattern after seconds digits,</span>
<a href="#l31.25"></a><span id="l31.25">                     // or after minutes if no seconds, or after hours if no minutes.</span>
<a href="#l31.26"></a><span id="l31.26">                     for (var k = SEC_INDEX; k &gt;= HR_INDEX; k -= 2) {</span>
<a href="#l31.27"></a><span id="l31.27">                       var nextSepI = k + 1;</span>
<a href="#l31.28"></a><span id="l31.28">                       var nextDigitsI = k + 2;</span>
<a href="#l31.29"></a><span id="l31.29">                       if ((k == SEC_INDEX ||</span>
<a href="#l31.30"></a><span id="l31.30">                            (!amProbeArray[nextDigitsI] &amp;&amp; !pmProbeArray[nextDigitsI]))</span>
<a href="#l31.31"></a><span id="l31.31">                           &amp;&amp; amProbeArray[nextSepI] &amp;&amp; pmProbeArray[nextSepI]</span>
<a href="#l31.32"></a><span id="l31.32" class="difflineminus">-                          &amp;&amp; amProbeArray[nextSepI] != pmProbeArray[nextSepI])</span>
<a href="#l31.33"></a><span id="l31.33" class="difflineminus">-                      {</span>
<a href="#l31.34"></a><span id="l31.34" class="difflineplus">+                          &amp;&amp; amProbeArray[nextSepI] != pmProbeArray[nextSepI]) {</span>
<a href="#l31.35"></a><span id="l31.35">                         amProbeArray[POST_INDEX] =</span>
<a href="#l31.36"></a><span id="l31.36">                           amProbeArray[nextSepI] + amProbeArray[POST_INDEX];</span>
<a href="#l31.37"></a><span id="l31.37">                         pmProbeArray[POST_INDEX] =</span>
<a href="#l31.38"></a><span id="l31.38">                           pmProbeArray[nextSepI] + pmProbeArray[POST_INDEX];</span>
<a href="#l31.39"></a><span id="l31.39">                         this.ampmIndex = POST_INDEX;</span>
<a href="#l31.40"></a><span id="l31.40">                         break;</span>
<a href="#l31.41"></a><span id="l31.41">                       }</span>
<a href="#l31.42"></a><span id="l31.42">                     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/calendar/resources/content/mouseoverPreviews.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/calendar/resources/content/mouseoverPreviews.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -13,18 +13,17 @@</span>
<a href="#l32.4"></a><span id="l32.4"> </span>
<a href="#l32.5"></a><span id="l32.5"> /** PUBLIC</span>
<a href="#l32.6"></a><span id="l32.6">  *</span>
<a href="#l32.7"></a><span id="l32.7">  *  This changes the mouseover preview based on the start and end dates</span>
<a href="#l32.8"></a><span id="l32.8">  *  of an occurrence of a (one-time or recurring) calEvent or calToDo.</span>
<a href="#l32.9"></a><span id="l32.9">  *  Used by all grid views.</span>
<a href="#l32.10"></a><span id="l32.10">  */</span>
<a href="#l32.11"></a><span id="l32.11"> </span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-function onMouseOverItem( occurrenceBoxMouseEvent )</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineminus">-{</span>
<a href="#l32.14"></a><span id="l32.14" class="difflineplus">+function onMouseOverItem( occurrenceBoxMouseEvent ) {</span>
<a href="#l32.15"></a><span id="l32.15">   if (&quot;occurrence&quot; in occurrenceBoxMouseEvent.currentTarget) {</span>
<a href="#l32.16"></a><span id="l32.16">     // occurrence of repeating event or todo</span>
<a href="#l32.17"></a><span id="l32.17">       var occurrence = occurrenceBoxMouseEvent.currentTarget.occurrence;</span>
<a href="#l32.18"></a><span id="l32.18">       const toolTip = document.getElementById(&quot;itemTooltip&quot;);</span>
<a href="#l32.19"></a><span id="l32.19">       return showToolTip(toolTip, occurrence);</span>
<a href="#l32.20"></a><span id="l32.20">   }</span>
<a href="#l32.21"></a><span id="l32.21">   return false;</span>
<a href="#l32.22"></a><span id="l32.22"> }</span>
<a href="#l32.23"></a><span id="l32.23" class="difflineat">@@ -44,113 +43,99 @@ function showToolTip(aToolTip, aItem) {</span>
<a href="#l32.24"></a><span id="l32.24">         }</span>
<a href="#l32.25"></a><span id="l32.25">     }</span>
<a href="#l32.26"></a><span id="l32.26">     return false;</span>
<a href="#l32.27"></a><span id="l32.27"> }</span>
<a href="#l32.28"></a><span id="l32.28"> </span>
<a href="#l32.29"></a><span id="l32.29"> /**</span>
<a href="#l32.30"></a><span id="l32.30">  *  Called when a user hovers over a todo element and the text for the mouse over is changed.</span>
<a href="#l32.31"></a><span id="l32.31">  */</span>
<a href="#l32.32"></a><span id="l32.32" class="difflineminus">-</span>
<a href="#l32.33"></a><span id="l32.33" class="difflineminus">-function getPreviewForTask( toDoItem )</span>
<a href="#l32.34"></a><span id="l32.34" class="difflineminus">-{</span>
<a href="#l32.35"></a><span id="l32.35" class="difflineminus">-  if ( toDoItem )</span>
<a href="#l32.36"></a><span id="l32.36" class="difflineminus">-  {</span>
<a href="#l32.37"></a><span id="l32.37" class="difflineplus">+function getPreviewForTask(toDoItem) {</span>
<a href="#l32.38"></a><span id="l32.38" class="difflineplus">+  if (toDoItem) {</span>
<a href="#l32.39"></a><span id="l32.39">     const vbox = document.createElement( &quot;vbox&quot; );</span>
<a href="#l32.40"></a><span id="l32.40">     vbox.setAttribute(&quot;class&quot;, &quot;tooltipBox&quot;);</span>
<a href="#l32.41"></a><span id="l32.41">     // tooltip appears above or below pointer, so may have as little as</span>
<a href="#l32.42"></a><span id="l32.42">     // one half the screen height available (avoid top going off screen).</span>
<a href="#l32.43"></a><span id="l32.43">     vbox.maxHeight = Math.floor(screen.height / 2);</span>
<a href="#l32.44"></a><span id="l32.44">     boxInitializeHeaderGrid(vbox);</span>
<a href="#l32.45"></a><span id="l32.45"> </span>
<a href="#l32.46"></a><span id="l32.46">     var hasHeader = false;</span>
<a href="#l32.47"></a><span id="l32.47"> </span>
<a href="#l32.48"></a><span id="l32.48" class="difflineminus">-    if (toDoItem.title)</span>
<a href="#l32.49"></a><span id="l32.49" class="difflineminus">-    {</span>
<a href="#l32.50"></a><span id="l32.50" class="difflineplus">+    if (toDoItem.title) {</span>
<a href="#l32.51"></a><span id="l32.51">       boxAppendLabeledText(vbox, &quot;tooltipTitle&quot;, toDoItem.title);</span>
<a href="#l32.52"></a><span id="l32.52">       hasHeader = true;</span>
<a href="#l32.53"></a><span id="l32.53">     }</span>
<a href="#l32.54"></a><span id="l32.54"> </span>
<a href="#l32.55"></a><span id="l32.55">     var location = toDoItem.getProperty(&quot;LOCATION&quot;);</span>
<a href="#l32.56"></a><span id="l32.56" class="difflineminus">-    if (location)</span>
<a href="#l32.57"></a><span id="l32.57" class="difflineminus">-    {</span>
<a href="#l32.58"></a><span id="l32.58" class="difflineplus">+    if (location) {</span>
<a href="#l32.59"></a><span id="l32.59">       boxAppendLabeledText(vbox, &quot;tooltipLocation&quot;, location);</span>
<a href="#l32.60"></a><span id="l32.60">       hasHeader = true;</span>
<a href="#l32.61"></a><span id="l32.61">     }</span>
<a href="#l32.62"></a><span id="l32.62"> </span>
<a href="#l32.63"></a><span id="l32.63">     // First try to get calendar name appearing in tooltip</span>
<a href="#l32.64"></a><span id="l32.64">     if (toDoItem.calendar.name) {</span>
<a href="#l32.65"></a><span id="l32.65">       let calendarNameString = toDoItem.calendar.name;</span>
<a href="#l32.66"></a><span id="l32.66">       boxAppendLabeledText(vbox, &quot;tooltipCalName&quot;, calendarNameString);</span>
<a href="#l32.67"></a><span id="l32.67">     }</span>
<a href="#l32.68"></a><span id="l32.68"> </span>
<a href="#l32.69"></a><span id="l32.69" class="difflineminus">-    if (toDoItem.entryDate &amp;&amp; toDoItem.entryDate.isValid)</span>
<a href="#l32.70"></a><span id="l32.70" class="difflineminus">-    {</span>
<a href="#l32.71"></a><span id="l32.71" class="difflineplus">+    if (toDoItem.entryDate &amp;&amp; toDoItem.entryDate.isValid) {</span>
<a href="#l32.72"></a><span id="l32.72">       boxAppendLabeledDateTime(vbox, &quot;tooltipStart&quot;, toDoItem.entryDate);</span>
<a href="#l32.73"></a><span id="l32.73">       hasHeader = true;</span>
<a href="#l32.74"></a><span id="l32.74">     }</span>
<a href="#l32.75"></a><span id="l32.75"> </span>
<a href="#l32.76"></a><span id="l32.76" class="difflineminus">-    if (toDoItem.dueDate &amp;&amp; toDoItem.dueDate.isValid)</span>
<a href="#l32.77"></a><span id="l32.77" class="difflineminus">-    {</span>
<a href="#l32.78"></a><span id="l32.78" class="difflineplus">+    if (toDoItem.dueDate &amp;&amp; toDoItem.dueDate.isValid) {</span>
<a href="#l32.79"></a><span id="l32.79">       boxAppendLabeledDateTime(vbox, &quot;tooltipDue&quot;, toDoItem.dueDate);</span>
<a href="#l32.80"></a><span id="l32.80">       hasHeader = true;</span>
<a href="#l32.81"></a><span id="l32.81">     }</span>
<a href="#l32.82"></a><span id="l32.82"> </span>
<a href="#l32.83"></a><span id="l32.83" class="difflineminus">-    if (toDoItem.priority &amp;&amp; toDoItem.priority != 0)</span>
<a href="#l32.84"></a><span id="l32.84" class="difflineminus">-    {</span>
<a href="#l32.85"></a><span id="l32.85" class="difflineplus">+    if (toDoItem.priority &amp;&amp; toDoItem.priority != 0) {</span>
<a href="#l32.86"></a><span id="l32.86">       var priorityInteger = parseInt(toDoItem.priority, 10);</span>
<a href="#l32.87"></a><span id="l32.87">       var priorityString;</span>
<a href="#l32.88"></a><span id="l32.88"> </span>
<a href="#l32.89"></a><span id="l32.89">       // These cut-offs should match calendar-event-dialog.js</span>
<a href="#l32.90"></a><span id="l32.90">       if (priorityInteger &gt;= 1 &amp;&amp; priorityInteger &lt;= 4) {</span>
<a href="#l32.91"></a><span id="l32.91">            priorityString = calGetString('calendar', 'highPriority'); // high priority</span>
<a href="#l32.92"></a><span id="l32.92">       } else if (priorityInteger == 5) {</span>
<a href="#l32.93"></a><span id="l32.93">           priorityString = calGetString('calendar', 'normalPriority'); // normal priority</span>
<a href="#l32.94"></a><span id="l32.94">       } else {</span>
<a href="#l32.95"></a><span id="l32.95">           priorityString = calGetString('calendar', 'lowPriority'); // low priority</span>
<a href="#l32.96"></a><span id="l32.96">       }</span>
<a href="#l32.97"></a><span id="l32.97">       boxAppendLabeledText(vbox, &quot;tooltipPriority&quot;, priorityString);</span>
<a href="#l32.98"></a><span id="l32.98">       hasHeader = true;</span>
<a href="#l32.99"></a><span id="l32.99">     }</span>
<a href="#l32.100"></a><span id="l32.100"> </span>
<a href="#l32.101"></a><span id="l32.101" class="difflineminus">-    if (toDoItem.status &amp;&amp; toDoItem.status != &quot;NONE&quot;)</span>
<a href="#l32.102"></a><span id="l32.102" class="difflineminus">-    {</span>
<a href="#l32.103"></a><span id="l32.103" class="difflineplus">+    if (toDoItem.status &amp;&amp; toDoItem.status != &quot;NONE&quot;) {</span>
<a href="#l32.104"></a><span id="l32.104">       var status = getToDoStatusString(toDoItem);</span>
<a href="#l32.105"></a><span id="l32.105">       boxAppendLabeledText(vbox, &quot;tooltipStatus&quot;, status);</span>
<a href="#l32.106"></a><span id="l32.106">       hasHeader = true;</span>
<a href="#l32.107"></a><span id="l32.107">     }</span>
<a href="#l32.108"></a><span id="l32.108"> </span>
<a href="#l32.109"></a><span id="l32.109" class="difflineminus">-    if (toDoItem.status != null &amp;&amp; toDoItem.percentComplete != 0 &amp;&amp; toDoItem.percentComplete != 100)</span>
<a href="#l32.110"></a><span id="l32.110" class="difflineminus">-    {</span>
<a href="#l32.111"></a><span id="l32.111" class="difflineplus">+    if (toDoItem.status != null &amp;&amp; toDoItem.percentComplete != 0 &amp;&amp; toDoItem.percentComplete != 100) {</span>
<a href="#l32.112"></a><span id="l32.112">       boxAppendLabeledText(vbox, &quot;tooltipPercent&quot;, String(toDoItem.percentComplete) + &quot;%&quot;);</span>
<a href="#l32.113"></a><span id="l32.113">       hasHeader = true;</span>
<a href="#l32.114"></a><span id="l32.114" class="difflineminus">-    } else if (toDoItem.percentComplete == 100)</span>
<a href="#l32.115"></a><span id="l32.115" class="difflineminus">-    {</span>
<a href="#l32.116"></a><span id="l32.116" class="difflineplus">+    } else if (toDoItem.percentComplete == 100) {</span>
<a href="#l32.117"></a><span id="l32.117">       if (toDoItem.completedDate == null) {</span>
<a href="#l32.118"></a><span id="l32.118">         boxAppendLabeledText(vbox, &quot;tooltipPercent&quot;, &quot;100%&quot;);</span>
<a href="#l32.119"></a><span id="l32.119">       } else {</span>
<a href="#l32.120"></a><span id="l32.120">         boxAppendLabeledDateTime(vbox, &quot;tooltipCompleted&quot;, toDoItem.completedDate);</span>
<a href="#l32.121"></a><span id="l32.121">       }</span>
<a href="#l32.122"></a><span id="l32.122">       hasHeader = true;</span>
<a href="#l32.123"></a><span id="l32.123">     }</span>
<a href="#l32.124"></a><span id="l32.124"> </span>
<a href="#l32.125"></a><span id="l32.125">     var description = toDoItem.getProperty(&quot;DESCRIPTION&quot;);</span>
<a href="#l32.126"></a><span id="l32.126" class="difflineminus">-    if (description)</span>
<a href="#l32.127"></a><span id="l32.127" class="difflineminus">-    {</span>
<a href="#l32.128"></a><span id="l32.128" class="difflineplus">+    if (description) {</span>
<a href="#l32.129"></a><span id="l32.129">       // display wrapped description lines like body of message below headers</span>
<a href="#l32.130"></a><span id="l32.130">       if (hasHeader) {</span>
<a href="#l32.131"></a><span id="l32.131">         boxAppendBodySeparator(vbox);</span>
<a href="#l32.132"></a><span id="l32.132">       }</span>
<a href="#l32.133"></a><span id="l32.133">       boxAppendBody(vbox, description);</span>
<a href="#l32.134"></a><span id="l32.134">     }</span>
<a href="#l32.135"></a><span id="l32.135"> </span>
<a href="#l32.136"></a><span id="l32.136">     return ( vbox );</span>
<a href="#l32.137"></a><span id="l32.137" class="difflineminus">-  }</span>
<a href="#l32.138"></a><span id="l32.138" class="difflineminus">-  else</span>
<a href="#l32.139"></a><span id="l32.139" class="difflineminus">-  {</span>
<a href="#l32.140"></a><span id="l32.140" class="difflineplus">+  } else {</span>
<a href="#l32.141"></a><span id="l32.141">     return null;</span>
<a href="#l32.142"></a><span id="l32.142">   }</span>
<a href="#l32.143"></a><span id="l32.143"> }</span>
<a href="#l32.144"></a><span id="l32.144"> </span>
<a href="#l32.145"></a><span id="l32.145"> /**</span>
<a href="#l32.146"></a><span id="l32.146">  *  Called when mouse moves over a different, or</span>
<a href="#l32.147"></a><span id="l32.147">  *  when mouse moves over event in event list.</span>
<a href="#l32.148"></a><span id="l32.148">  *  The instStartDate is date of instance displayed at event box</span>
<a href="#l32.149"></a><span id="l32.149" class="difflineat">@@ -207,37 +192,33 @@ function getPreviewForEvent( aEvent) {</span>
<a href="#l32.150"></a><span id="l32.150">     return ( vbox );</span>
<a href="#l32.151"></a><span id="l32.151">   } else {</span>
<a href="#l32.152"></a><span id="l32.152">       return null;</span>
<a href="#l32.153"></a><span id="l32.153">   }</span>
<a href="#l32.154"></a><span id="l32.154"> }</span>
<a href="#l32.155"></a><span id="l32.155"> </span>
<a href="#l32.156"></a><span id="l32.156"> </span>
<a href="#l32.157"></a><span id="l32.157"> /** String for event status: (none), Tentative, Confirmed, or Cancelled **/</span>
<a href="#l32.158"></a><span id="l32.158" class="difflineminus">-function getEventStatusString(calendarEvent)</span>
<a href="#l32.159"></a><span id="l32.159" class="difflineminus">-{</span>
<a href="#l32.160"></a><span id="l32.160" class="difflineminus">-  switch ( calendarEvent.status )</span>
<a href="#l32.161"></a><span id="l32.161" class="difflineminus">-  {</span>
<a href="#l32.162"></a><span id="l32.162" class="difflineplus">+function getEventStatusString(calendarEvent) {</span>
<a href="#l32.163"></a><span id="l32.163" class="difflineplus">+  switch ( calendarEvent.status ) {</span>
<a href="#l32.164"></a><span id="l32.164">     // Event status value keywords are specified in RFC2445sec4.8.1.11</span>
<a href="#l32.165"></a><span id="l32.165">     case &quot;TENTATIVE&quot;:</span>
<a href="#l32.166"></a><span id="l32.166">       return calGetString('calendar', &quot;statusTentative&quot;);</span>
<a href="#l32.167"></a><span id="l32.167">     case &quot;CONFIRMED&quot;:</span>
<a href="#l32.168"></a><span id="l32.168">       return calGetString('calendar', &quot;statusConfirmed&quot;);</span>
<a href="#l32.169"></a><span id="l32.169">     case &quot;CANCELLED&quot;:</span>
<a href="#l32.170"></a><span id="l32.170">       return calGetString('calendar', &quot;eventStatusCancelled&quot;);</span>
<a href="#l32.171"></a><span id="l32.171">      default:</span>
<a href="#l32.172"></a><span id="l32.172">         return &quot;&quot;;</span>
<a href="#l32.173"></a><span id="l32.173">   }</span>
<a href="#l32.174"></a><span id="l32.174"> }</span>
<a href="#l32.175"></a><span id="l32.175"> </span>
<a href="#l32.176"></a><span id="l32.176"> /** String for todo status: (none), NeedsAction, InProcess, Cancelled, or Completed **/</span>
<a href="#l32.177"></a><span id="l32.177" class="difflineminus">-function getToDoStatusString(iCalToDo)</span>
<a href="#l32.178"></a><span id="l32.178" class="difflineminus">-{</span>
<a href="#l32.179"></a><span id="l32.179" class="difflineminus">-  switch ( iCalToDo.status )</span>
<a href="#l32.180"></a><span id="l32.180" class="difflineminus">-  {</span>
<a href="#l32.181"></a><span id="l32.181" class="difflineplus">+function getToDoStatusString(iCalToDo) {</span>
<a href="#l32.182"></a><span id="l32.182" class="difflineplus">+  switch ( iCalToDo.status ) {</span>
<a href="#l32.183"></a><span id="l32.183">     // Todo status keywords are specified in RFC2445sec4.8.1.11</span>
<a href="#l32.184"></a><span id="l32.184">     case &quot;NEEDS-ACTION&quot;:</span>
<a href="#l32.185"></a><span id="l32.185">       return calGetString('calendar', &quot;statusNeedsAction&quot;);</span>
<a href="#l32.186"></a><span id="l32.186">     case &quot;IN-PROCESS&quot;:</span>
<a href="#l32.187"></a><span id="l32.187">       return calGetString('calendar', &quot;statusInProcess&quot;);</span>
<a href="#l32.188"></a><span id="l32.188">     case &quot;CANCELLED&quot;:</span>
<a href="#l32.189"></a><span id="l32.189">       return calGetString('calendar', &quot;todoStatusCancelled&quot;);</span>
<a href="#l32.190"></a><span id="l32.190">     case &quot;COMPLETED&quot;:</span>
<a href="#l32.191"></a><span id="l32.191" class="difflineat">@@ -259,55 +240,51 @@ function boxAppendBodySeparator(vbox) {</span>
<a href="#l32.192"></a><span id="l32.192"> }</span>
<a href="#l32.193"></a><span id="l32.193"> </span>
<a href="#l32.194"></a><span id="l32.194"> /**</span>
<a href="#l32.195"></a><span id="l32.195">  * PRIVATE: Append description to box for body text.  Text may contain</span>
<a href="#l32.196"></a><span id="l32.196">  * paragraphs; line indent and line breaks will be preserved by CSS.</span>
<a href="#l32.197"></a><span id="l32.197">  * @param box           box to which to append body</span>
<a href="#l32.198"></a><span id="l32.198">  * @param textString    text of body</span>
<a href="#l32.199"></a><span id="l32.199">  */</span>
<a href="#l32.200"></a><span id="l32.200" class="difflineminus">-function boxAppendBody(box, textString)</span>
<a href="#l32.201"></a><span id="l32.201" class="difflineminus">-{</span>
<a href="#l32.202"></a><span id="l32.202" class="difflineplus">+function boxAppendBody(box, textString) {</span>
<a href="#l32.203"></a><span id="l32.203">   var textNode = document.createTextNode(textString);</span>
<a href="#l32.204"></a><span id="l32.204">   var xulDescription = document.createElement(&quot;description&quot;);</span>
<a href="#l32.205"></a><span id="l32.205">   xulDescription.setAttribute(&quot;class&quot;, &quot;tooltipBody&quot;);</span>
<a href="#l32.206"></a><span id="l32.206">   xulDescription.appendChild(textNode);</span>
<a href="#l32.207"></a><span id="l32.207">   box.appendChild(xulDescription);</span>
<a href="#l32.208"></a><span id="l32.208"> }</span>
<a href="#l32.209"></a><span id="l32.209"> </span>
<a href="#l32.210"></a><span id="l32.210"> /**</span>
<a href="#l32.211"></a><span id="l32.211">  * PRIVATE: Use dateFormatter to format date and time,</span>
<a href="#l32.212"></a><span id="l32.212">  * and to header grid append a row containing localized Label: date.</span>
<a href="#l32.213"></a><span id="l32.213">  */</span>
<a href="#l32.214"></a><span id="l32.214" class="difflineminus">-function boxAppendLabeledDateTime(box, labelProperty, date)</span>
<a href="#l32.215"></a><span id="l32.215" class="difflineminus">-{</span>
<a href="#l32.216"></a><span id="l32.216" class="difflineplus">+function boxAppendLabeledDateTime(box, labelProperty, date) {</span>
<a href="#l32.217"></a><span id="l32.217">   date = date.getInTimezone(calendarDefaultTimezone());</span>
<a href="#l32.218"></a><span id="l32.218">   var formattedDateTime = getDateFormatter().formatDateTime(date);</span>
<a href="#l32.219"></a><span id="l32.219">   boxAppendLabeledText(box, labelProperty, formattedDateTime);</span>
<a href="#l32.220"></a><span id="l32.220"> }</span>
<a href="#l32.221"></a><span id="l32.221"> </span>
<a href="#l32.222"></a><span id="l32.222"> /**</span>
<a href="#l32.223"></a><span id="l32.223">  * PRIVATE: Use dateFormatter to format date and time interval,</span>
<a href="#l32.224"></a><span id="l32.224">  * and to header grid append a row containing localized Label: interval.</span>
<a href="#l32.225"></a><span id="l32.225">  * @param box               contains header grid.</span>
<a href="#l32.226"></a><span id="l32.226">  * @param labelProperty     name of property for localized field label.</span>
<a href="#l32.227"></a><span id="l32.227">  * @param item              the event or task</span>
<a href="#l32.228"></a><span id="l32.228">  */</span>
<a href="#l32.229"></a><span id="l32.229" class="difflineminus">-function boxAppendLabeledDateTimeInterval(box, labelProperty, item)</span>
<a href="#l32.230"></a><span id="l32.230" class="difflineminus">-{</span>
<a href="#l32.231"></a><span id="l32.231" class="difflineplus">+function boxAppendLabeledDateTimeInterval(box, labelProperty, item) {</span>
<a href="#l32.232"></a><span id="l32.232">   var dateString = getDateFormatter().formatItemInterval(item);</span>
<a href="#l32.233"></a><span id="l32.233">   boxAppendLabeledText(box, labelProperty, dateString);</span>
<a href="#l32.234"></a><span id="l32.234"> }</span>
<a href="#l32.235"></a><span id="l32.235"> </span>
<a href="#l32.236"></a><span id="l32.236"> /**</span>
<a href="#l32.237"></a><span id="l32.237">  * PRIVATE: create empty 2-column grid for header fields,</span>
<a href="#l32.238"></a><span id="l32.238">  * and append it to box.</span>
<a href="#l32.239"></a><span id="l32.239">  */</span>
<a href="#l32.240"></a><span id="l32.240" class="difflineminus">-function boxInitializeHeaderGrid(box)</span>
<a href="#l32.241"></a><span id="l32.241" class="difflineminus">-{</span>
<a href="#l32.242"></a><span id="l32.242" class="difflineplus">+function boxInitializeHeaderGrid(box) {</span>
<a href="#l32.243"></a><span id="l32.243">   var grid = document.createElement(&quot;grid&quot;);</span>
<a href="#l32.244"></a><span id="l32.244">   grid.setAttribute(&quot;class&quot;, &quot;tooltipHeaderGrid&quot;);</span>
<a href="#l32.245"></a><span id="l32.245">   var rows;</span>
<a href="#l32.246"></a><span id="l32.246">   {</span>
<a href="#l32.247"></a><span id="l32.247">     var columns = document.createElement(&quot;columns&quot;);</span>
<a href="#l32.248"></a><span id="l32.248">     {</span>
<a href="#l32.249"></a><span id="l32.249">       var labelColumn = document.createElement(&quot;column&quot;);</span>
<a href="#l32.250"></a><span id="l32.250">       labelColumn.setAttribute(&quot;class&quot;, &quot;tooltipLabelColumn&quot;);</span>
<a href="#l32.251"></a><span id="l32.251" class="difflineat">@@ -325,55 +302,51 @@ function boxInitializeHeaderGrid(box)</span>
<a href="#l32.252"></a><span id="l32.252"> </span>
<a href="#l32.253"></a><span id="l32.253"> /**</span>
<a href="#l32.254"></a><span id="l32.254">  * PRIVATE: To headers grid, append a row containing Label: value,</span>
<a href="#l32.255"></a><span id="l32.255">  * where label is localized text for labelProperty.</span>
<a href="#l32.256"></a><span id="l32.256">  * @param box               box containing headers grid</span>
<a href="#l32.257"></a><span id="l32.257">  * @param labelProperty     name of property for localized name of header</span>
<a href="#l32.258"></a><span id="l32.258">  * @param textString        value of header field.</span>
<a href="#l32.259"></a><span id="l32.259">  */</span>
<a href="#l32.260"></a><span id="l32.260" class="difflineminus">-function boxAppendLabeledText(box, labelProperty, textString)</span>
<a href="#l32.261"></a><span id="l32.261" class="difflineminus">-{</span>
<a href="#l32.262"></a><span id="l32.262" class="difflineplus">+function boxAppendLabeledText(box, labelProperty, textString) {</span>
<a href="#l32.263"></a><span id="l32.263">   var labelText = calGetString('calendar', labelProperty);</span>
<a href="#l32.264"></a><span id="l32.264">   var rows = box.getElementsByTagNameNS(box.namespaceURI, &quot;rows&quot;)[0];</span>
<a href="#l32.265"></a><span id="l32.265">   {</span>
<a href="#l32.266"></a><span id="l32.266">     var row = document.createElement(&quot;row&quot;);</span>
<a href="#l32.267"></a><span id="l32.267">     {</span>
<a href="#l32.268"></a><span id="l32.268">       row.appendChild(createTooltipHeaderLabel(labelText));</span>
<a href="#l32.269"></a><span id="l32.269">       row.appendChild(createTooltipHeaderDescription(textString));</span>
<a href="#l32.270"></a><span id="l32.270">     }</span>
<a href="#l32.271"></a><span id="l32.271">     rows.appendChild(row);</span>
<a href="#l32.272"></a><span id="l32.272">   }</span>
<a href="#l32.273"></a><span id="l32.273"> }</span>
<a href="#l32.274"></a><span id="l32.274"> </span>
<a href="#l32.275"></a><span id="l32.275"> /** PRIVATE: create element for field label (for header grid). **/</span>
<a href="#l32.276"></a><span id="l32.276" class="difflineminus">-function createTooltipHeaderLabel(text)</span>
<a href="#l32.277"></a><span id="l32.277" class="difflineminus">-{</span>
<a href="#l32.278"></a><span id="l32.278" class="difflineplus">+function createTooltipHeaderLabel(text) {</span>
<a href="#l32.279"></a><span id="l32.279">   var label = document.createElement(&quot;label&quot;);</span>
<a href="#l32.280"></a><span id="l32.280">   label.setAttribute(&quot;class&quot;, &quot;tooltipHeaderLabel&quot;);</span>
<a href="#l32.281"></a><span id="l32.281">   label.appendChild(document.createTextNode(text));</span>
<a href="#l32.282"></a><span id="l32.282">   return label;</span>
<a href="#l32.283"></a><span id="l32.283"> }</span>
<a href="#l32.284"></a><span id="l32.284"> </span>
<a href="#l32.285"></a><span id="l32.285"> /** PRIVATE: create element for field value (for header grid). **/</span>
<a href="#l32.286"></a><span id="l32.286" class="difflineminus">-function createTooltipHeaderDescription(text)</span>
<a href="#l32.287"></a><span id="l32.287" class="difflineminus">-{</span>
<a href="#l32.288"></a><span id="l32.288" class="difflineplus">+function createTooltipHeaderDescription(text) {</span>
<a href="#l32.289"></a><span id="l32.289">   var label = document.createElement(&quot;description&quot;);</span>
<a href="#l32.290"></a><span id="l32.290">   label.setAttribute(&quot;class&quot;, &quot;tooltipHeaderDescription&quot;);</span>
<a href="#l32.291"></a><span id="l32.291">   label.appendChild(document.createTextNode(text));</span>
<a href="#l32.292"></a><span id="l32.292">   return label;</span>
<a href="#l32.293"></a><span id="l32.293"> }</span>
<a href="#l32.294"></a><span id="l32.294"> </span>
<a href="#l32.295"></a><span id="l32.295"> /**</span>
<a href="#l32.296"></a><span id="l32.296">  * If now is during an occurrence, return the occurrence.</span>
<a href="#l32.297"></a><span id="l32.297">  * Else if now is before an occurrence, return the next occurrence.</span>
<a href="#l32.298"></a><span id="l32.298">  * Otherwise return the previous occurrence.</span>
<a href="#l32.299"></a><span id="l32.299">  */</span>
<a href="#l32.300"></a><span id="l32.300" class="difflineminus">-function getCurrentNextOrPreviousRecurrence(calendarEvent)</span>
<a href="#l32.301"></a><span id="l32.301" class="difflineminus">-{</span>
<a href="#l32.302"></a><span id="l32.302" class="difflineplus">+function getCurrentNextOrPreviousRecurrence(calendarEvent) {</span>
<a href="#l32.303"></a><span id="l32.303">     if (!calendarEvent.recurrenceInfo) {</span>
<a href="#l32.304"></a><span id="l32.304">         return calendarEvent;</span>
<a href="#l32.305"></a><span id="l32.305">     }</span>
<a href="#l32.306"></a><span id="l32.306"> </span>
<a href="#l32.307"></a><span id="l32.307">     var dur = calendarEvent.duration.clone();</span>
<a href="#l32.308"></a><span id="l32.308">     dur.isNegative = true;</span>
<a href="#l32.309"></a><span id="l32.309"> </span>
<a href="#l32.310"></a><span id="l32.310">     // To find current event when now is during event, look for occurrence</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/resources/content/publish.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/resources/content/publish.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -6,46 +6,43 @@</span>
<a href="#l33.4"></a><span id="l33.4"> Components.utils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l33.5"></a><span id="l33.5"> Components.utils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l33.6"></a><span id="l33.6"> Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l33.7"></a><span id="l33.7"> </span>
<a href="#l33.8"></a><span id="l33.8"> /**</span>
<a href="#l33.9"></a><span id="l33.9">  * publishCalendarData</span>
<a href="#l33.10"></a><span id="l33.10">  * Show publish dialog, ask for URL and publish all selected items.</span>
<a href="#l33.11"></a><span id="l33.11">  */</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-function publishCalendarData()</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineminus">-{</span>
<a href="#l33.14"></a><span id="l33.14" class="difflineplus">+function publishCalendarData() {</span>
<a href="#l33.15"></a><span id="l33.15">    var args = {};</span>
<a href="#l33.16"></a><span id="l33.16"> </span>
<a href="#l33.17"></a><span id="l33.17">    args.onOk = self.publishCalendarDataDialogResponse;</span>
<a href="#l33.18"></a><span id="l33.18"> </span>
<a href="#l33.19"></a><span id="l33.19">    openDialog(&quot;chrome://calendar/content/publishDialog.xul&quot;, &quot;caPublishEvents&quot;,</span>
<a href="#l33.20"></a><span id="l33.20">               &quot;chrome,titlebar,modal,resizable&quot;, args );</span>
<a href="#l33.21"></a><span id="l33.21"> }</span>
<a href="#l33.22"></a><span id="l33.22"> </span>
<a href="#l33.23"></a><span id="l33.23"> /**</span>
<a href="#l33.24"></a><span id="l33.24">  * publishCalendarDataDialogResponse</span>
<a href="#l33.25"></a><span id="l33.25">  * Callback method for publishCalendarData() that is called when the user</span>
<a href="#l33.26"></a><span id="l33.26">  * presses the OK button in the publish dialog.</span>
<a href="#l33.27"></a><span id="l33.27">  */</span>
<a href="#l33.28"></a><span id="l33.28" class="difflineminus">-function publishCalendarDataDialogResponse(CalendarPublishObject, aProgressDialog)</span>
<a href="#l33.29"></a><span id="l33.29" class="difflineminus">-{</span>
<a href="#l33.30"></a><span id="l33.30" class="difflineplus">+function publishCalendarDataDialogResponse(CalendarPublishObject, aProgressDialog) {</span>
<a href="#l33.31"></a><span id="l33.31">     publishItemArray(currentView().getSelectedItems({}),</span>
<a href="#l33.32"></a><span id="l33.32">                      CalendarPublishObject.remotePath, aProgressDialog);</span>
<a href="#l33.33"></a><span id="l33.33"> }</span>
<a href="#l33.34"></a><span id="l33.34"> </span>
<a href="#l33.35"></a><span id="l33.35"> /**</span>
<a href="#l33.36"></a><span id="l33.36">  * publishEntireCalendar</span>
<a href="#l33.37"></a><span id="l33.37">  * Show publish dialog, ask for URL and publish all items from the calendar.</span>
<a href="#l33.38"></a><span id="l33.38">  *</span>
<a href="#l33.39"></a><span id="l33.39">  * @param aCalendar   (optional) The calendar that will be published. If ommitted</span>
<a href="#l33.40"></a><span id="l33.40">  *                               the user will be prompted to select a calendar.</span>
<a href="#l33.41"></a><span id="l33.41">  */</span>
<a href="#l33.42"></a><span id="l33.42" class="difflineminus">-function publishEntireCalendar(aCalendar)</span>
<a href="#l33.43"></a><span id="l33.43" class="difflineminus">-{</span>
<a href="#l33.44"></a><span id="l33.44" class="difflineplus">+function publishEntireCalendar(aCalendar) {</span>
<a href="#l33.45"></a><span id="l33.45">     if (!aCalendar) {</span>
<a href="#l33.46"></a><span id="l33.46">         let count = {};</span>
<a href="#l33.47"></a><span id="l33.47">         let calendars = getCalendarManager().getCalendars(count);</span>
<a href="#l33.48"></a><span id="l33.48"> </span>
<a href="#l33.49"></a><span id="l33.49">         if (count.value == 1) {</span>
<a href="#l33.50"></a><span id="l33.50">             // Do not ask user for calendar if only one calendar exists</span>
<a href="#l33.51"></a><span id="l33.51">             aCalendar = calendars[0];</span>
<a href="#l33.52"></a><span id="l33.52">         } else {</span>
<a href="#l33.53"></a><span id="l33.53" class="difflineat">@@ -82,31 +79,28 @@ function publishEntireCalendar(aCalendar</span>
<a href="#l33.54"></a><span id="l33.54">     return;</span>
<a href="#l33.55"></a><span id="l33.55"> }</span>
<a href="#l33.56"></a><span id="l33.56"> </span>
<a href="#l33.57"></a><span id="l33.57"> /**</span>
<a href="#l33.58"></a><span id="l33.58">  * publishEntireCalendarDialogResponse</span>
<a href="#l33.59"></a><span id="l33.59">  * Callback method for publishEntireCalendar() that is called when the user</span>
<a href="#l33.60"></a><span id="l33.60">  * presses the OK button in the publish dialog.</span>
<a href="#l33.61"></a><span id="l33.61">  */</span>
<a href="#l33.62"></a><span id="l33.62" class="difflineminus">-function publishEntireCalendarDialogResponse(CalendarPublishObject, aProgressDialog)</span>
<a href="#l33.63"></a><span id="l33.63" class="difflineminus">-{</span>
<a href="#l33.64"></a><span id="l33.64" class="difflineplus">+function publishEntireCalendarDialogResponse(CalendarPublishObject, aProgressDialog) {</span>
<a href="#l33.65"></a><span id="l33.65">     // store the selected remote ics path as a calendar preference</span>
<a href="#l33.66"></a><span id="l33.66">     CalendarPublishObject.calendar.setProperty(&quot;remote-ics-path&quot;,</span>
<a href="#l33.67"></a><span id="l33.67">                                            CalendarPublishObject.remotePath);</span>
<a href="#l33.68"></a><span id="l33.68"> </span>
<a href="#l33.69"></a><span id="l33.69">     var itemArray = [];</span>
<a href="#l33.70"></a><span id="l33.70">     var getListener = {</span>
<a href="#l33.71"></a><span id="l33.71">         QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]),</span>
<a href="#l33.72"></a><span id="l33.72" class="difflineminus">-        onOperationComplete: function(aCalendar, aStatus, aOperationType, aId, aDetail)</span>
<a href="#l33.73"></a><span id="l33.73" class="difflineminus">-        {</span>
<a href="#l33.74"></a><span id="l33.74" class="difflineplus">+        onOperationComplete: function(aCalendar, aStatus, aOperationType, aId, aDetail) {</span>
<a href="#l33.75"></a><span id="l33.75">             publishItemArray(itemArray, CalendarPublishObject.remotePath, aProgressDialog);</span>
<a href="#l33.76"></a><span id="l33.76">         },</span>
<a href="#l33.77"></a><span id="l33.77" class="difflineminus">-        onGetResult: function(aCalendar, aStatus, aItemType, aDetail, aCount, aItems)</span>
<a href="#l33.78"></a><span id="l33.78" class="difflineminus">-        {</span>
<a href="#l33.79"></a><span id="l33.79" class="difflineplus">+        onGetResult: function(aCalendar, aStatus, aItemType, aDetail, aCount, aItems) {</span>
<a href="#l33.80"></a><span id="l33.80">             if (!Components.isSuccessCode(aStatus)) {</span>
<a href="#l33.81"></a><span id="l33.81">                 aborted = true;</span>
<a href="#l33.82"></a><span id="l33.82">                 return;</span>
<a href="#l33.83"></a><span id="l33.83">             }</span>
<a href="#l33.84"></a><span id="l33.84">             if (aCount) {</span>
<a href="#l33.85"></a><span id="l33.85">                 for (var i = 0; i &lt; aCount; ++i) {</span>
<a href="#l33.86"></a><span id="l33.86">                     // Store a (short living) reference to the item.</span>
<a href="#l33.87"></a><span id="l33.87">                     var itemCopy = aItems[i].clone();</span>
<a href="#l33.88"></a><span id="l33.88" class="difflineat">@@ -201,22 +195,20 @@ var notificationCallbacks =</span>
<a href="#l33.89"></a><span id="l33.89">         throw Components.results.NS_ERROR_NO_INTERFACE;</span>
<a href="#l33.90"></a><span id="l33.90">     }</span>
<a href="#l33.91"></a><span id="l33.91"> }</span>
<a href="#l33.92"></a><span id="l33.92"> </span>
<a href="#l33.93"></a><span id="l33.93"> </span>
<a href="#l33.94"></a><span id="l33.94"> var publishingListener = {</span>
<a href="#l33.95"></a><span id="l33.95">     QueryInterface: XPCOMUtils.generateQI([Components.interfaces.nsIStreamListener]),</span>
<a href="#l33.96"></a><span id="l33.96"> </span>
<a href="#l33.97"></a><span id="l33.97" class="difflineminus">-    onStartRequest: function(request, ctxt)</span>
<a href="#l33.98"></a><span id="l33.98" class="difflineminus">-    {</span>
<a href="#l33.99"></a><span id="l33.99" class="difflineplus">+    onStartRequest: function(request, ctxt) {</span>
<a href="#l33.100"></a><span id="l33.100">     },</span>
<a href="#l33.101"></a><span id="l33.101"> </span>
<a href="#l33.102"></a><span id="l33.102" class="difflineminus">-    onStopRequest: function(request, ctxt, status, errorMsg)</span>
<a href="#l33.103"></a><span id="l33.103" class="difflineminus">-    {</span>
<a href="#l33.104"></a><span id="l33.104" class="difflineplus">+    onStopRequest: function(request, ctxt, status, errorMsg) {</span>
<a href="#l33.105"></a><span id="l33.105">         ctxt.wrappedJSObject.onStopUpload();</span>
<a href="#l33.106"></a><span id="l33.106"> </span>
<a href="#l33.107"></a><span id="l33.107">         let channel;</span>
<a href="#l33.108"></a><span id="l33.108">         let props = Services.strings.createBundle(&quot;chrome://calendar/locale/calendar.properties&quot;);</span>
<a href="#l33.109"></a><span id="l33.109">         let requestSucceeded;</span>
<a href="#l33.110"></a><span id="l33.110">         try {</span>
<a href="#l33.111"></a><span id="l33.111">             channel = request.QueryInterface(Components.interfaces.nsIHttpChannel);</span>
<a href="#l33.112"></a><span id="l33.112">             requestSucceeded = channel.requestSucceeded;</span>
<a href="#l33.113"></a><span id="l33.113" class="difflineat">@@ -227,13 +219,11 @@ var publishingListener = {</span>
<a href="#l33.114"></a><span id="l33.114">                                   props.formatStringFromName('httpPutError', [channel.responseStatus, channel.responseStatusText], 2));</span>
<a href="#l33.115"></a><span id="l33.115">         } else if (!channel &amp;&amp; !Components.isSuccessCode(request.status)) {</span>
<a href="#l33.116"></a><span id="l33.116">             // XXX this should be made human-readable.</span>
<a href="#l33.117"></a><span id="l33.117">             Services.prompt.alert(null, calGetString(&quot;calendar&quot;, &quot;genericErrorTitle&quot;),</span>
<a href="#l33.118"></a><span id="l33.118">                                   props.formatStringFromName('otherPutError', [request.status.toString(16)], 1));</span>
<a href="#l33.119"></a><span id="l33.119">         }</span>
<a href="#l33.120"></a><span id="l33.120">     },</span>
<a href="#l33.121"></a><span id="l33.121"> </span>
<a href="#l33.122"></a><span id="l33.122" class="difflineminus">-    onDataAvailable: function(request, ctxt, inStream, sourceOffset, count)</span>
<a href="#l33.123"></a><span id="l33.123" class="difflineminus">-    {</span>
<a href="#l33.124"></a><span id="l33.124" class="difflineplus">+    onDataAvailable: function(request, ctxt, inStream, sourceOffset, count) {</span>
<a href="#l33.125"></a><span id="l33.125">     }</span>
<a href="#l33.126"></a><span id="l33.126"> }</span>
<a href="#l33.127"></a><span id="l33.127" class="difflineminus">-</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/resources/content/publishDialog.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/resources/content/publishDialog.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -3,18 +3,17 @@</span>
<a href="#l34.4"></a><span id="l34.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l34.5"></a><span id="l34.5"> </span>
<a href="#l34.6"></a><span id="l34.6"> var gOnOkFunction;   // function to be called when user clicks OK</span>
<a href="#l34.7"></a><span id="l34.7"> var gPublishObject;</span>
<a href="#l34.8"></a><span id="l34.8"> </span>
<a href="#l34.9"></a><span id="l34.9"> /**</span>
<a href="#l34.10"></a><span id="l34.10"> *   Called when the dialog is loaded.</span>
<a href="#l34.11"></a><span id="l34.11"> */</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-function loadCalendarPublishDialog()</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineminus">-{</span>
<a href="#l34.14"></a><span id="l34.14" class="difflineplus">+function loadCalendarPublishDialog() {</span>
<a href="#l34.15"></a><span id="l34.15">    // Get arguments, see description at top of file</span>
<a href="#l34.16"></a><span id="l34.16"> </span>
<a href="#l34.17"></a><span id="l34.17">    var args = window.arguments[0];</span>
<a href="#l34.18"></a><span id="l34.18"> </span>
<a href="#l34.19"></a><span id="l34.19">    gOnOkFunction = args.onOk;</span>
<a href="#l34.20"></a><span id="l34.20"> </span>
<a href="#l34.21"></a><span id="l34.21">    if (args.publishObject) {</span>
<a href="#l34.22"></a><span id="l34.22">       gPublishObject = args.publishObject;</span>
<a href="#l34.23"></a><span id="l34.23" class="difflineat">@@ -33,40 +32,37 @@ function loadCalendarPublishDialog()</span>
<a href="#l34.24"></a><span id="l34.24"> }</span>
<a href="#l34.25"></a><span id="l34.25"> </span>
<a href="#l34.26"></a><span id="l34.26"> </span>
<a href="#l34.27"></a><span id="l34.27"> </span>
<a href="#l34.28"></a><span id="l34.28"> /**</span>
<a href="#l34.29"></a><span id="l34.29"> *   Called when the OK button is clicked.</span>
<a href="#l34.30"></a><span id="l34.30"> */</span>
<a href="#l34.31"></a><span id="l34.31"> </span>
<a href="#l34.32"></a><span id="l34.32" class="difflineminus">-function onOKCommand()</span>
<a href="#l34.33"></a><span id="l34.33" class="difflineminus">-{</span>
<a href="#l34.34"></a><span id="l34.34" class="difflineplus">+function onOKCommand() {</span>
<a href="#l34.35"></a><span id="l34.35">    gPublishObject.remotePath = document.getElementById( &quot;publish-remotePath-textbox&quot; ).value;</span>
<a href="#l34.36"></a><span id="l34.36"> </span>
<a href="#l34.37"></a><span id="l34.37">    // call caller's on OK function</span>
<a href="#l34.38"></a><span id="l34.38">    gOnOkFunction(gPublishObject, progressDialog);</span>
<a href="#l34.39"></a><span id="l34.39">    document.getElementById( &quot;calendar-publishwindow&quot; ).getButton( &quot;accept&quot; ).setAttribute( &quot;label&quot;, closeButtonLabel );</span>
<a href="#l34.40"></a><span id="l34.40">    document.getElementById( &quot;calendar-publishwindow&quot; ).setAttribute( &quot;ondialogaccept&quot;, &quot;closeDialog()&quot; );</span>
<a href="#l34.41"></a><span id="l34.41">    return ( false );</span>
<a href="#l34.42"></a><span id="l34.42"> }</span>
<a href="#l34.43"></a><span id="l34.43"> </span>
<a href="#l34.44"></a><span id="l34.44"> </span>
<a href="#l34.45"></a><span id="l34.45" class="difflineminus">-function checkURLField( )</span>
<a href="#l34.46"></a><span id="l34.46" class="difflineminus">-{</span>
<a href="#l34.47"></a><span id="l34.47" class="difflineplus">+function checkURLField() {</span>
<a href="#l34.48"></a><span id="l34.48">    if (document.getElementById( &quot;publish-remotePath-textbox&quot; ).value.length == 0) {</span>
<a href="#l34.49"></a><span id="l34.49">       document.getElementById( &quot;calendar-publishwindow&quot; ).getButton( &quot;accept&quot; ).setAttribute( &quot;disabled&quot;, &quot;true&quot; );</span>
<a href="#l34.50"></a><span id="l34.50">    } else {</span>
<a href="#l34.51"></a><span id="l34.51">       document.getElementById( &quot;calendar-publishwindow&quot; ).getButton( &quot;accept&quot; ).removeAttribute( &quot;disabled&quot; );</span>
<a href="#l34.52"></a><span id="l34.52">    }</span>
<a href="#l34.53"></a><span id="l34.53"> }</span>
<a href="#l34.54"></a><span id="l34.54"> </span>
<a href="#l34.55"></a><span id="l34.55" class="difflineminus">-function closeDialog( )</span>
<a href="#l34.56"></a><span id="l34.56" class="difflineminus">-{</span>
<a href="#l34.57"></a><span id="l34.57" class="difflineminus">-   self.close( );</span>
<a href="#l34.58"></a><span id="l34.58" class="difflineplus">+function closeDialog() {</span>
<a href="#l34.59"></a><span id="l34.59" class="difflineplus">+   self.close();</span>
<a href="#l34.60"></a><span id="l34.60"> }</span>
<a href="#l34.61"></a><span id="l34.61"> </span>
<a href="#l34.62"></a><span id="l34.62"> var progressDialog = {</span>
<a href="#l34.63"></a><span id="l34.63">     onStartUpload: function() {</span>
<a href="#l34.64"></a><span id="l34.64">         document.getElementById( &quot;publish-progressmeter&quot; ).setAttribute( &quot;mode&quot;, &quot;undetermined&quot; );</span>
<a href="#l34.65"></a><span id="l34.65">     },</span>
<a href="#l34.66"></a><span id="l34.66"> </span>
<a href="#l34.67"></a><span id="l34.67">     onStopUpload: function() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -20,17 +20,18 @@ var testAnnualRecurrence = function () {</span>
<a href="#l35.4"></a><span id="l35.4">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l35.5"></a><span id="l35.5">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l35.6"></a><span id="l35.6">   calUtils.goToDate(controller, startYear, 1, 1);</span>
<a href="#l35.7"></a><span id="l35.7"> </span>
<a href="#l35.8"></a><span id="l35.8">   // rotate view</span>
<a href="#l35.9"></a><span id="l35.9">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l35.10"></a><span id="l35.10">   controller.waitFor(function() {</span>
<a href="#l35.11"></a><span id="l35.11">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-    return view.orient == &quot;horizontal&quot;});</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+    return view.orient == &quot;horizontal&quot;;</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineplus">+  });</span>
<a href="#l35.15"></a><span id="l35.15"> </span>
<a href="#l35.16"></a><span id="l35.16">   // create yearly recurring all-day event</span>
<a href="#l35.17"></a><span id="l35.17">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l35.18"></a><span id="l35.18">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined)));</span>
<a href="#l35.19"></a><span id="l35.19">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l35.20"></a><span id="l35.20">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l35.21"></a><span id="l35.21">                  .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l35.22"></a><span id="l35.22">   event.sleep(sleep);</span>
<a href="#l35.23"></a><span id="l35.23" class="difflineat">@@ -81,14 +82,15 @@ var testAnnualRecurrence = function () {</span>
<a href="#l35.24"></a><span id="l35.24">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l35.25"></a><span id="l35.25">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l35.26"></a><span id="l35.26">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l35.27"></a><span id="l35.27"> </span>
<a href="#l35.28"></a><span id="l35.28">   // reset view</span>
<a href="#l35.29"></a><span id="l35.29">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l35.30"></a><span id="l35.30">   controller.waitFor(function() {</span>
<a href="#l35.31"></a><span id="l35.31">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l35.32"></a><span id="l35.32" class="difflineminus">-    return view.orient == &quot;vertical&quot;});</span>
<a href="#l35.33"></a><span id="l35.33" class="difflineplus">+    return view.orient == &quot;vertical&quot;;</span>
<a href="#l35.34"></a><span id="l35.34" class="difflineplus">+  });</span>
<a href="#l35.35"></a><span id="l35.35"> }</span>
<a href="#l35.36"></a><span id="l35.36"> </span>
<a href="#l35.37"></a><span id="l35.37"> var teardownTest = function(module) {</span>
<a href="#l35.38"></a><span id="l35.38">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l35.39"></a><span id="l35.39"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -19,17 +19,18 @@ var testBiweeklyRecurrence = function ()</span>
<a href="#l36.4"></a><span id="l36.4">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l36.5"></a><span id="l36.5">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l36.6"></a><span id="l36.6">   calUtils.goToDate(controller, 2009, 1, 31);</span>
<a href="#l36.7"></a><span id="l36.7"> </span>
<a href="#l36.8"></a><span id="l36.8">   // rotate view</span>
<a href="#l36.9"></a><span id="l36.9">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l36.10"></a><span id="l36.10">   controller.waitFor(function() {</span>
<a href="#l36.11"></a><span id="l36.11">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-    return view.orient == &quot;horizontal&quot;});</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+    return view.orient == &quot;horizontal&quot;;</span>
<a href="#l36.14"></a><span id="l36.14" class="difflineplus">+  });</span>
<a href="#l36.15"></a><span id="l36.15"> </span>
<a href="#l36.16"></a><span id="l36.16">   // create biweekly event</span>
<a href="#l36.17"></a><span id="l36.17">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l36.18"></a><span id="l36.18">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l36.19"></a><span id="l36.19">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l36.20"></a><span id="l36.20">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l36.21"></a><span id="l36.21"> </span>
<a href="#l36.22"></a><span id="l36.22">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l36.23"></a><span id="l36.23" class="difflineat">@@ -106,14 +107,15 @@ var testBiweeklyRecurrence = function ()</span>
<a href="#l36.24"></a><span id="l36.24">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l36.25"></a><span id="l36.25">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l36.26"></a><span id="l36.26"> </span>
<a href="#l36.27"></a><span id="l36.27">   // reset view</span>
<a href="#l36.28"></a><span id="l36.28">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l36.29"></a><span id="l36.29">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l36.30"></a><span id="l36.30">   controller.waitFor(function() {</span>
<a href="#l36.31"></a><span id="l36.31">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l36.32"></a><span id="l36.32" class="difflineminus">-    return view.orient == &quot;vertical&quot;});</span>
<a href="#l36.33"></a><span id="l36.33" class="difflineplus">+    return view.orient == &quot;vertical&quot;;</span>
<a href="#l36.34"></a><span id="l36.34" class="difflineplus">+  });</span>
<a href="#l36.35"></a><span id="l36.35"> }</span>
<a href="#l36.36"></a><span id="l36.36"> </span>
<a href="#l36.37"></a><span id="l36.37"> var teardownTest = function(module) {</span>
<a href="#l36.38"></a><span id="l36.38">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l36.39"></a><span id="l36.39"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -19,17 +19,18 @@ var testDailyRecurrence = function () {</span>
<a href="#l37.4"></a><span id="l37.4">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l37.5"></a><span id="l37.5">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l37.6"></a><span id="l37.6">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l37.7"></a><span id="l37.7"> </span>
<a href="#l37.8"></a><span id="l37.8">   // rotate view</span>
<a href="#l37.9"></a><span id="l37.9">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l37.10"></a><span id="l37.10">   controller.waitFor(function() {</span>
<a href="#l37.11"></a><span id="l37.11">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-    return view.orient == &quot;horizontal&quot;});</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+    return view.orient == &quot;horizontal&quot;;</span>
<a href="#l37.14"></a><span id="l37.14" class="difflineplus">+  });</span>
<a href="#l37.15"></a><span id="l37.15"> </span>
<a href="#l37.16"></a><span id="l37.16">   // create daily event</span>
<a href="#l37.17"></a><span id="l37.17">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l37.18"></a><span id="l37.18">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l37.19"></a><span id="l37.19">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l37.20"></a><span id="l37.20">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l37.21"></a><span id="l37.21">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l37.22"></a><span id="l37.22"> </span>
<a href="#l37.23"></a><span id="l37.23" class="difflineat">@@ -205,14 +206,15 @@ var testDailyRecurrence = function () {</span>
<a href="#l37.24"></a><span id="l37.24">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l37.25"></a><span id="l37.25">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l37.26"></a><span id="l37.26"> </span>
<a href="#l37.27"></a><span id="l37.27">   // reset view</span>
<a href="#l37.28"></a><span id="l37.28">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l37.29"></a><span id="l37.29">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l37.30"></a><span id="l37.30">   controller.waitFor(function() {</span>
<a href="#l37.31"></a><span id="l37.31">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l37.32"></a><span id="l37.32" class="difflineminus">-    return view.orient == &quot;vertical&quot;});</span>
<a href="#l37.33"></a><span id="l37.33" class="difflineplus">+    return view.orient == &quot;vertical&quot;;</span>
<a href="#l37.34"></a><span id="l37.34" class="difflineplus">+  });</span>
<a href="#l37.35"></a><span id="l37.35"> }</span>
<a href="#l37.36"></a><span id="l37.36"> </span>
<a href="#l37.37"></a><span id="l37.37"> var teardownTest = function(module) {</span>
<a href="#l37.38"></a><span id="l37.38">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l37.39"></a><span id="l37.39"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -19,17 +19,18 @@ var testLastDayOfMonthRecurrence = funct</span>
<a href="#l38.4"></a><span id="l38.4">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l38.5"></a><span id="l38.5">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l38.6"></a><span id="l38.6">   calUtils.goToDate(controller, 2008, 1, 31); // start with a leap year</span>
<a href="#l38.7"></a><span id="l38.7"> </span>
<a href="#l38.8"></a><span id="l38.8">   // rotate view</span>
<a href="#l38.9"></a><span id="l38.9">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l38.10"></a><span id="l38.10">   controller.waitFor(function() {</span>
<a href="#l38.11"></a><span id="l38.11">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-    return view.orient == &quot;horizontal&quot;});</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+    return view.orient == &quot;horizontal&quot;;</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineplus">+  });</span>
<a href="#l38.15"></a><span id="l38.15"> </span>
<a href="#l38.16"></a><span id="l38.16">   // create monthly recurring event</span>
<a href="#l38.17"></a><span id="l38.17">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l38.18"></a><span id="l38.18">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l38.19"></a><span id="l38.19">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l38.20"></a><span id="l38.20">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l38.21"></a><span id="l38.21">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l38.22"></a><span id="l38.22"> </span>
<a href="#l38.23"></a><span id="l38.23" class="difflineat">@@ -102,17 +103,18 @@ var testLastDayOfMonthRecurrence = funct</span>
<a href="#l38.24"></a><span id="l38.24">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l38.25"></a><span id="l38.25">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l38.26"></a><span id="l38.26">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l38.27"></a><span id="l38.27"> </span>
<a href="#l38.28"></a><span id="l38.28">   // reset view</span>
<a href="#l38.29"></a><span id="l38.29">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l38.30"></a><span id="l38.30">   controller.waitFor(function() {</span>
<a href="#l38.31"></a><span id="l38.31">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l38.32"></a><span id="l38.32" class="difflineminus">-    return view.orient == &quot;vertical&quot;});</span>
<a href="#l38.33"></a><span id="l38.33" class="difflineplus">+    return view.orient == &quot;vertical&quot;;</span>
<a href="#l38.34"></a><span id="l38.34" class="difflineplus">+  });</span>
<a href="#l38.35"></a><span id="l38.35"> }</span>
<a href="#l38.36"></a><span id="l38.36"> </span>
<a href="#l38.37"></a><span id="l38.37"> function setRecurrence(recurrence){</span>
<a href="#l38.38"></a><span id="l38.38">   recurrence.sleep(sleep);</span>
<a href="#l38.39"></a><span id="l38.39"> </span>
<a href="#l38.40"></a><span id="l38.40">   // monthly</span>
<a href="#l38.41"></a><span id="l38.41">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined,</span>
<a href="#l38.42"></a><span id="l38.42">     undefined, &quot;2&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -20,17 +20,18 @@ var testWeeklyNRecurrence = function () </span>
<a href="#l39.4"></a><span id="l39.4">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l39.5"></a><span id="l39.5">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l39.6"></a><span id="l39.6">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l39.7"></a><span id="l39.7"> </span>
<a href="#l39.8"></a><span id="l39.8">   // rotate view</span>
<a href="#l39.9"></a><span id="l39.9">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l39.10"></a><span id="l39.10">   controller.waitFor(function() {</span>
<a href="#l39.11"></a><span id="l39.11">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-    return view.orient == &quot;horizontal&quot;});</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+    return view.orient == &quot;horizontal&quot;;</span>
<a href="#l39.14"></a><span id="l39.14" class="difflineplus">+  });</span>
<a href="#l39.15"></a><span id="l39.15"> </span>
<a href="#l39.16"></a><span id="l39.16">   // create weekly recurring event</span>
<a href="#l39.17"></a><span id="l39.17">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l39.18"></a><span id="l39.18">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l39.19"></a><span id="l39.19">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l39.20"></a><span id="l39.20">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l39.21"></a><span id="l39.21"> </span>
<a href="#l39.22"></a><span id="l39.22">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l39.23"></a><span id="l39.23" class="difflineat">@@ -86,17 +87,18 @@ var testWeeklyNRecurrence = function () </span>
<a href="#l39.24"></a><span id="l39.24">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l39.25"></a><span id="l39.25">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.26"></a><span id="l39.26"> </span>
<a href="#l39.27"></a><span id="l39.27">   // reset view</span>
<a href="#l39.28"></a><span id="l39.28">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l39.29"></a><span id="l39.29">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l39.30"></a><span id="l39.30">   controller.waitFor(function() {</span>
<a href="#l39.31"></a><span id="l39.31">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l39.32"></a><span id="l39.32" class="difflineminus">-    return view.orient == &quot;vertical&quot;});</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineplus">+    return view.orient == &quot;vertical&quot;;</span>
<a href="#l39.34"></a><span id="l39.34" class="difflineplus">+  });</span>
<a href="#l39.35"></a><span id="l39.35"> }</span>
<a href="#l39.36"></a><span id="l39.36"> </span>
<a href="#l39.37"></a><span id="l39.37"> function setRecurrence(recurrence){</span>
<a href="#l39.38"></a><span id="l39.38">   // weekly</span>
<a href="#l39.39"></a><span id="l39.39">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l39.40"></a><span id="l39.40">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l39.41"></a><span id="l39.41">   recurrence.sleep(sleep);</span>
<a href="#l39.42"></a><span id="l39.42"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -21,17 +21,18 @@ var testWeeklyUntilRecurrence = function</span>
<a href="#l40.4"></a><span id="l40.4">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l40.5"></a><span id="l40.5">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l40.6"></a><span id="l40.6">   calUtils.goToDate(controller, 2009, 1, 5); // Monday</span>
<a href="#l40.7"></a><span id="l40.7"> </span>
<a href="#l40.8"></a><span id="l40.8">   // rotate view</span>
<a href="#l40.9"></a><span id="l40.9">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l40.10"></a><span id="l40.10">   controller.waitFor(function() {</span>
<a href="#l40.11"></a><span id="l40.11">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-    return view.orient == &quot;horizontal&quot;});</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+    return view.orient == &quot;horizontal&quot;;</span>
<a href="#l40.14"></a><span id="l40.14" class="difflineplus">+  });</span>
<a href="#l40.15"></a><span id="l40.15"> </span>
<a href="#l40.16"></a><span id="l40.16">   // create weekly recurring event</span>
<a href="#l40.17"></a><span id="l40.17">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l40.18"></a><span id="l40.18">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l40.19"></a><span id="l40.19">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l40.20"></a><span id="l40.20">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l40.21"></a><span id="l40.21"> </span>
<a href="#l40.22"></a><span id="l40.22">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l40.23"></a><span id="l40.23" class="difflineat">@@ -113,17 +114,18 @@ var testWeeklyUntilRecurrence = function</span>
<a href="#l40.24"></a><span id="l40.24">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l40.25"></a><span id="l40.25">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l40.26"></a><span id="l40.26"> </span>
<a href="#l40.27"></a><span id="l40.27">   // reset view</span>
<a href="#l40.28"></a><span id="l40.28">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l40.29"></a><span id="l40.29">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l40.30"></a><span id="l40.30">   controller.waitFor(function() {</span>
<a href="#l40.31"></a><span id="l40.31">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l40.32"></a><span id="l40.32" class="difflineminus">-    return view.orient == &quot;vertical&quot;});</span>
<a href="#l40.33"></a><span id="l40.33" class="difflineplus">+    return view.orient == &quot;vertical&quot;;</span>
<a href="#l40.34"></a><span id="l40.34" class="difflineplus">+  });</span>
<a href="#l40.35"></a><span id="l40.35"> }</span>
<a href="#l40.36"></a><span id="l40.36"> </span>
<a href="#l40.37"></a><span id="l40.37"> function setRecurrence(recurrence){</span>
<a href="#l40.38"></a><span id="l40.38">   // weekly</span>
<a href="#l40.39"></a><span id="l40.39">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l40.40"></a><span id="l40.40">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l40.41"></a><span id="l40.41">   recurrence.sleep(sleep);</span>
<a href="#l40.42"></a><span id="l40.42"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -21,17 +21,18 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l41.4"></a><span id="l41.4">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l41.5"></a><span id="l41.5">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l41.6"></a><span id="l41.6">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l41.7"></a><span id="l41.7"> </span>
<a href="#l41.8"></a><span id="l41.8">   // rotate view</span>
<a href="#l41.9"></a><span id="l41.9">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l41.10"></a><span id="l41.10">   controller.waitFor(function() {</span>
<a href="#l41.11"></a><span id="l41.11">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-    return view.orient == &quot;horizontal&quot;});</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+    return view.orient == &quot;horizontal&quot;;</span>
<a href="#l41.14"></a><span id="l41.14" class="difflineplus">+  });</span>
<a href="#l41.15"></a><span id="l41.15"> </span>
<a href="#l41.16"></a><span id="l41.16">   // create weekly recurring event</span>
<a href="#l41.17"></a><span id="l41.17">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l41.18"></a><span id="l41.18">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l41.19"></a><span id="l41.19">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l41.20"></a><span id="l41.20">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l41.21"></a><span id="l41.21"> </span>
<a href="#l41.22"></a><span id="l41.22">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l41.23"></a><span id="l41.23" class="difflineat">@@ -205,17 +206,18 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l41.24"></a><span id="l41.24">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l41.25"></a><span id="l41.25">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l41.26"></a><span id="l41.26">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l41.27"></a><span id="l41.27"> </span>
<a href="#l41.28"></a><span id="l41.28">   // reset view</span>
<a href="#l41.29"></a><span id="l41.29">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l41.30"></a><span id="l41.30">   controller.waitFor(function() {</span>
<a href="#l41.31"></a><span id="l41.31">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l41.32"></a><span id="l41.32" class="difflineminus">-    return view.orient == &quot;vertical&quot;});</span>
<a href="#l41.33"></a><span id="l41.33" class="difflineplus">+    return view.orient == &quot;vertical&quot;;</span>
<a href="#l41.34"></a><span id="l41.34" class="difflineplus">+  });</span>
<a href="#l41.35"></a><span id="l41.35"> }</span>
<a href="#l41.36"></a><span id="l41.36"> </span>
<a href="#l41.37"></a><span id="l41.37"> function setRecurrence(recurrence){</span>
<a href="#l41.38"></a><span id="l41.38">   // weekly</span>
<a href="#l41.39"></a><span id="l41.39">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l41.40"></a><span id="l41.40">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l41.41"></a><span id="l41.41">   recurrence.sleep(sleep);</span>
<a href="#l41.42"></a><span id="l41.42"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -341,18 +341,17 @@ function createCalendar(controller, name</span>
<a href="#l42.4"></a><span id="l42.4">  * Retrieves array of all calendar-event-box elements in node</span>
<a href="#l42.5"></a><span id="l42.5">  * @param node - node to be searched</span>
<a href="#l42.6"></a><span id="l42.6">  * @param eventNodes - array where to put resultíng nodes</span>
<a href="#l42.7"></a><span id="l42.7">  */</span>
<a href="#l42.8"></a><span id="l42.8"> function findEventsInNode(node, eventNodes) {</span>
<a href="#l42.9"></a><span id="l42.9">   if (node.tagName == &quot;calendar-event-box&quot;) {</span>
<a href="#l42.10"></a><span id="l42.10">     eventNodes.push(node);</span>
<a href="#l42.11"></a><span id="l42.11">     return;</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-  }</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineminus">-  else if (node.children.length &gt; 0) {</span>
<a href="#l42.14"></a><span id="l42.14" class="difflineplus">+  } else if (node.children.length &gt; 0) {</span>
<a href="#l42.15"></a><span id="l42.15">     for (let i = 0; i &lt; node.children.length; i++) {</span>
<a href="#l42.16"></a><span id="l42.16">       findEventsInNode(node.children[i], eventNodes);</span>
<a href="#l42.17"></a><span id="l42.17">     }</span>
<a href="#l42.18"></a><span id="l42.18">   }</span>
<a href="#l42.19"></a><span id="l42.19"> }</span>
<a href="#l42.20"></a><span id="l42.20"> </span>
<a href="#l42.21"></a><span id="l42.21"> /**</span>
<a href="#l42.22"></a><span id="l42.22">  *  Helper function to enter event/task dialog data</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/calendar/test/mozmill/views/testTaskView.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testTaskView.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -57,18 +57,20 @@ var testTaskView = function () {</span>
<a href="#l43.4"></a><span id="l43.4">   controller.keypress(new elementslib.Lookup(controller.window.document, taskView</span>
<a href="#l43.5"></a><span id="l43.5">     + 'id(&quot;task-addition-box&quot;)/id(&quot;view-task-edit-field&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l43.6"></a><span id="l43.6">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l43.7"></a><span id="l43.7">     &quot;VK_RETURN&quot;,</span>
<a href="#l43.8"></a><span id="l43.8">     {});</span>
<a href="#l43.9"></a><span id="l43.9"> </span>
<a href="#l43.10"></a><span id="l43.10">   // verify added</span>
<a href="#l43.11"></a><span id="l43.11">   let countAfter;</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-  controller.waitFor(function() {countAfter = taskTreeNode.mTaskArray.length;</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineminus">-                                 return countBefore + 1 == countAfter});</span>
<a href="#l43.14"></a><span id="l43.14" class="difflineplus">+  controller.waitFor(function() {</span>
<a href="#l43.15"></a><span id="l43.15" class="difflineplus">+    countAfter = taskTreeNode.mTaskArray.length;</span>
<a href="#l43.16"></a><span id="l43.16" class="difflineplus">+    return countBefore + 1 == countAfter;</span>
<a href="#l43.17"></a><span id="l43.17" class="difflineplus">+  });</span>
<a href="#l43.18"></a><span id="l43.18"> </span>
<a href="#l43.19"></a><span id="l43.19">   // last added task is automatically selected so verify detail window data</span>
<a href="#l43.20"></a><span id="l43.20">   controller.assertJSProperty(new elementslib.ID(controller.window.document,</span>
<a href="#l43.21"></a><span id="l43.21">     &quot;calendar-task-details-title&quot;), &quot;textContent&quot;, title);</span>
<a href="#l43.22"></a><span id="l43.22"> </span>
<a href="#l43.23"></a><span id="l43.23">   // open added task</span>
<a href="#l43.24"></a><span id="l43.24">   // doubleclick on completion checkbox is ignored as opening action, so don't click at immediate</span>
<a href="#l43.25"></a><span id="l43.25">   // left where the checkbox is located</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

