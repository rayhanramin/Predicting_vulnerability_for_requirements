<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 25951:5b2feb6ef34995790afd24631089fbb41db101fa</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 5b2feb6ef34995790afd24631089fbb41db101fa" />
<meta property="og:url" content="/comm-central/rev/5b2feb6ef34995790afd24631089fbb41db101fa" />
<meta property="og:description" content="Bug 1530868 - Fix imports in chat after bug 1520643. r=freaktechnik" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 5b2feb6ef34995790afd24631089fbb41db101fa 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/5b2feb6ef34995790afd24631089fbb41db101fa">shortlog</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/5b2feb6ef34995790afd24631089fbb41db101fa">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa">files</a> |
changeset |
<a href="/comm-central/raw-rev/5b2feb6ef34995790afd24631089fbb41db101fa">raw</a>  | <a href="/comm-central/archive/5b2feb6ef34995790afd24631089fbb41db101fa.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1530868">Bug 1530868</a> - Fix imports in chat after <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1520643">bug 1520643</a>. r=freaktechnik
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#80;&#97;&#116;&#114;&#105;&#99;&#107;&#32;&#67;&#108;&#111;&#107;&#101;&#32;&#60;&#99;&#108;&#111;&#107;&#101;&#112;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Wed, 27 Feb 2019 08:50:50 -0500</td></tr>

<tr>
 <td>changeset 25951</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/5b2feb6ef34995790afd24631089fbb41db101fa">5b2feb6ef34995790afd24631089fbb41db101fa</a></td>
</tr>



<tr>
<td>parent 25950</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/19d33231b78c7f74957f9116120773ef3e215ea0">19d33231b78c7f74957f9116120773ef3e215ea0</a>
</td>
</tr>

<tr>
<td>child 25952</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/6cc15820a0c21f70dc9183bf13a0c8949c1172b8">6cc15820a0c21f70dc9183bf13a0c8949c1172b8</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=5b2feb6ef34995790afd24631089fbb41db101fa">15575</a></td></tr>
<tr><td>push user</td><td>clokep@gmail.com</td></tr>
<tr><td>push date</td><td class="date age">Wed, 27 Feb 2019 13:51:25 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@5b2feb6ef349 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=5b2feb6ef34995790afd24631089fbb41db101fa">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=5b2feb6ef34995790afd24631089fbb41db101fa&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=5b2feb6ef34995790afd24631089fbb41db101fa&newProject=comm-central&newRevision=5b2feb6ef34995790afd24631089fbb41db101fa&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=5b2feb6ef34995790afd24631089fbb41db101fa&newProject=comm-central&newRevision=5b2feb6ef34995790afd24631089fbb41db101fa&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=5b2feb6ef34995790afd24631089fbb41db101fa&newProject=comm-central&newRevision=5b2feb6ef34995790afd24631089fbb41db101fa&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28freaktechnik%29&revcount=50">freaktechnik</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1530868">1530868</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1520643">1520643</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1530868">Bug 1530868</a> - Fix imports in chat after <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1520643">bug 1520643</a>. r=freaktechnik</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/socket.jsm">chat/modules/socket.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/socket.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/socket.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/socket.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/socket.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/socket.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/test/test_ArrayBufferUtils.js">chat/modules/test/test_ArrayBufferUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/test/test_ArrayBufferUtils.js">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/test/test_ArrayBufferUtils.js">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/test/test_ArrayBufferUtils.js">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/test/test_ArrayBufferUtils.js">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/modules/test/test_ArrayBufferUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircBase.jsm">chat/protocols/irc/ircBase.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircBase.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircBase.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircBase.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircBase.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircBase.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCAP.jsm">chat/protocols/irc/ircCAP.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCAP.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCAP.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCAP.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCAP.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCAP.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCTCP.jsm">chat/protocols/irc/ircCTCP.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCTCP.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCTCP.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCTCP.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCTCP.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCTCP.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCommands.jsm">chat/protocols/irc/ircCommands.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCommands.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCommands.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCommands.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCommands.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircCommands.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircDCC.jsm">chat/protocols/irc/ircDCC.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircDCC.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircDCC.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircDCC.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircDCC.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircDCC.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircHandlers.jsm">chat/protocols/irc/ircHandlers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircHandlers.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircHandlers.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircHandlers.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircHandlers.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircHandlers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircISUPPORT.jsm">chat/protocols/irc/ircISUPPORT.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircISUPPORT.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircISUPPORT.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircISUPPORT.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircISUPPORT.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircISUPPORT.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircNonStandard.jsm">chat/protocols/irc/ircNonStandard.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircNonStandard.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircNonStandard.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircNonStandard.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircNonStandard.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircNonStandard.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircSASL.jsm">chat/protocols/irc/ircSASL.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircSASL.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircSASL.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircSASL.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircSASL.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircSASL.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircServices.jsm">chat/protocols/irc/ircServices.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircServices.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircServices.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircServices.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircServices.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircServices.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircUtils.jsm">chat/protocols/irc/ircUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircUtils.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircUtils.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircUtils.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircUtils.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircWatchMonitor.jsm">chat/protocols/irc/ircWatchMonitor.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircWatchMonitor.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircWatchMonitor.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircWatchMonitor.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircWatchMonitor.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/ircWatchMonitor.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpColoring.js">chat/protocols/irc/test/test_ctcpColoring.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpColoring.js">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpColoring.js">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpColoring.js">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpColoring.js">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpColoring.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpFormatting.js">chat/protocols/irc/test/test_ctcpFormatting.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpFormatting.js">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpFormatting.js">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpFormatting.js">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpFormatting.js">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ctcpFormatting.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ircServerTime.js">chat/protocols/irc/test/test_ircServerTime.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ircServerTime.js">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ircServerTime.js">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ircServerTime.js">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ircServerTime.js">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/irc/test/test_ircServerTime.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/matrix/matrix-sdk.jsm">chat/protocols/matrix/matrix-sdk.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/matrix/matrix-sdk.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/matrix/matrix-sdk.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/matrix/matrix-sdk.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/matrix/matrix-sdk.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/matrix/matrix-sdk.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/skype/skype.js">chat/protocols/skype/skype.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/skype/skype.js">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/skype/skype.js">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/skype/skype.js">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/skype/skype.js">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/skype/skype.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-authmechs.jsm">chat/protocols/xmpp/xmpp-authmechs.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-authmechs.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-authmechs.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-authmechs.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-authmechs.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-authmechs.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-commands.jsm">chat/protocols/xmpp/xmpp-commands.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-commands.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-commands.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-commands.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-commands.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-commands.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-session.jsm">chat/protocols/xmpp/xmpp-session.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-session.jsm">file</a> |
<a href="/comm-central/annotate/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-session.jsm">annotate</a> |
<a href="/comm-central/diff/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-session.jsm">diff</a> |
<a href="/comm-central/comparison/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-session.jsm">comparison</a> |
<a href="/comm-central/log/5b2feb6ef34995790afd24631089fbb41db101fa/chat/protocols/xmpp/xmpp-session.jsm">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/chat/modules/socket.jsm</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/chat/modules/socket.jsm</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -73,34 +73,23 @@</span>
<a href="#l1.4"></a><span id="l1.4">  *     keep shifting the first element off and calling as setTimeout for the</span>
<a href="#l1.5"></a><span id="l1.5">  *     desired flood time?).</span>
<a href="#l1.6"></a><span id="l1.6">  */</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8"> this.EXPORTED_SYMBOLS = [&quot;Socket&quot;];</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10"> const {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l1.11"></a><span id="l1.11"> var {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-  copyBytes,</span>
<a href="#l1.13"></a><span id="l1.13">   ArrayBufferToBytes,</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-  BytesToArrayBuffer,</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-  StringToBytes,</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-  StringToArrayBuffer,</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-  ArrayBufferToString,</span>
<a href="#l1.18"></a><span id="l1.18">   ArrayBufferToHexString,</span>
<a href="#l1.19"></a><span id="l1.19"> } = ChromeUtils.import(&quot;resource:///modules/ArrayBufferUtils.jsm&quot;);</span>
<a href="#l1.20"></a><span id="l1.20"> var {</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineminus">-  XPCOMUtils,</span>
<a href="#l1.22"></a><span id="l1.22">   setTimeout,</span>
<a href="#l1.23"></a><span id="l1.23">   clearTimeout,</span>
<a href="#l1.24"></a><span id="l1.24">   executeSoon,</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineminus">-  nsSimpleEnumerator,</span>
<a href="#l1.26"></a><span id="l1.26" class="difflineminus">-  EmptyEnumerator,</span>
<a href="#l1.27"></a><span id="l1.27" class="difflineminus">-  ClassInfo,</span>
<a href="#l1.28"></a><span id="l1.28" class="difflineminus">-  l10nHelper,</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineminus">-  initLogModule,</span>
<a href="#l1.30"></a><span id="l1.30"> } = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l1.31"></a><span id="l1.31"> var {getHiddenHTMLWindow} = ChromeUtils.import(&quot;resource:///modules/hiddenWindow.jsm&quot;);</span>
<a href="#l1.32"></a><span id="l1.32"> </span>
<a href="#l1.33"></a><span id="l1.33"> // Network errors see: xpcom/base/nsError.h</span>
<a href="#l1.34"></a><span id="l1.34"> var NS_ERROR_MODULE_NETWORK = 2152398848;</span>
<a href="#l1.35"></a><span id="l1.35"> var NS_ERROR_CONNECTION_REFUSED = NS_ERROR_MODULE_NETWORK + 13;</span>
<a href="#l1.36"></a><span id="l1.36"> var NS_ERROR_NET_TIMEOUT = NS_ERROR_MODULE_NETWORK + 14;</span>
<a href="#l1.37"></a><span id="l1.37"> var NS_ERROR_NET_RESET = NS_ERROR_MODULE_NETWORK + 20;</span>
<a href="#l1.38"></a><span id="l1.38" class="difflineat">@@ -112,19 +101,16 @@ var BinaryInputStream =</span>
<a href="#l1.39"></a><span id="l1.39">   Components.Constructor(&quot;@mozilla.org/binaryinputstream;1&quot;,</span>
<a href="#l1.40"></a><span id="l1.40">                          &quot;nsIBinaryInputStream&quot;, &quot;setInputStream&quot;);</span>
<a href="#l1.41"></a><span id="l1.41"> var BinaryOutputStream =</span>
<a href="#l1.42"></a><span id="l1.42">   Components.Constructor(&quot;@mozilla.org/binaryoutputstream;1&quot;,</span>
<a href="#l1.43"></a><span id="l1.43">                          &quot;nsIBinaryOutputStream&quot;, &quot;setOutputStream&quot;);</span>
<a href="#l1.44"></a><span id="l1.44"> var ScriptableInputStream =</span>
<a href="#l1.45"></a><span id="l1.45">   Components.Constructor(&quot;@mozilla.org/scriptableinputstream;1&quot;,</span>
<a href="#l1.46"></a><span id="l1.46">                          &quot;nsIScriptableInputStream&quot;, &quot;init&quot;);</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineminus">-var ServerSocket =</span>
<a href="#l1.48"></a><span id="l1.48" class="difflineminus">-  Components.Constructor(&quot;@mozilla.org/network/server-socket;1&quot;,</span>
<a href="#l1.49"></a><span id="l1.49" class="difflineminus">-                         &quot;nsIServerSocket&quot;, &quot;init&quot;);</span>
<a href="#l1.50"></a><span id="l1.50"> var InputStreamPump =</span>
<a href="#l1.51"></a><span id="l1.51">   Components.Constructor(&quot;@mozilla.org/network/input-stream-pump;1&quot;,</span>
<a href="#l1.52"></a><span id="l1.52">                          &quot;nsIInputStreamPump&quot;, &quot;init&quot;);</span>
<a href="#l1.53"></a><span id="l1.53"> var ScriptableUnicodeConverter =</span>
<a href="#l1.54"></a><span id="l1.54">   Components.Constructor(&quot;@mozilla.org/intl/scriptableunicodeconverter&quot;,</span>
<a href="#l1.55"></a><span id="l1.55">                          &quot;nsIScriptableUnicodeConverter&quot;);</span>
<a href="#l1.56"></a><span id="l1.56"> </span>
<a href="#l1.57"></a><span id="l1.57"> var Socket = {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/chat/modules/test/test_ArrayBufferUtils.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/chat/modules/test/test_ArrayBufferUtils.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,17 +1,15 @@</span>
<a href="#l2.4"></a><span id="l2.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l2.5"></a><span id="l2.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l2.6"></a><span id="l2.6"> </span>
<a href="#l2.7"></a><span id="l2.7"> var {</span>
<a href="#l2.8"></a><span id="l2.8" class="difflineminus">-  copyBytes,</span>
<a href="#l2.9"></a><span id="l2.9">   ArrayBufferToBytes,</span>
<a href="#l2.10"></a><span id="l2.10">   BytesToArrayBuffer,</span>
<a href="#l2.11"></a><span id="l2.11">   StringToBytes,</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-  StringToArrayBuffer,</span>
<a href="#l2.13"></a><span id="l2.13">   ArrayBufferToString,</span>
<a href="#l2.14"></a><span id="l2.14">   ArrayBufferToHexString,</span>
<a href="#l2.15"></a><span id="l2.15"> } = ChromeUtils.import(&quot;resource:///modules/ArrayBufferUtils.jsm&quot;);</span>
<a href="#l2.16"></a><span id="l2.16"> </span>
<a href="#l2.17"></a><span id="l2.17"> function do_check_arraybuffer_eq(a, b) {</span>
<a href="#l2.18"></a><span id="l2.18">   let viewA = new Uint8Array(a);</span>
<a href="#l2.19"></a><span id="l2.19">   let viewB = new Uint8Array(b);</span>
<a href="#l2.20"></a><span id="l2.20"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/chat/protocols/irc/ircBase.jsm</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/chat/protocols/irc/ircBase.jsm</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -15,48 +15,28 @@</span>
<a href="#l3.4"></a><span id="l3.4">  *   RFC 2813: Internet Relay Chat: Server Protocol</span>
<a href="#l3.5"></a><span id="l3.5">  *     http://tools.ietf.org/html/rfc2813</span>
<a href="#l3.6"></a><span id="l3.6">  *   RFC 1459: Internet Relay Chat Protocol</span>
<a href="#l3.7"></a><span id="l3.7">  *     http://tools.ietf.org/html/rfc1459</span>
<a href="#l3.8"></a><span id="l3.8">  */</span>
<a href="#l3.9"></a><span id="l3.9"> this.EXPORTED_SYMBOLS = [&quot;ircBase&quot;];</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11"> var {</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  XPCOMUtils,</span>
<a href="#l3.13"></a><span id="l3.13">   setTimeout,</span>
<a href="#l3.14"></a><span id="l3.14">   clearTimeout,</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-  executeSoon,</span>
<a href="#l3.16"></a><span id="l3.16">   nsSimpleEnumerator,</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineminus">-  EmptyEnumerator,</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineminus">-  ClassInfo,</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineminus">-  l10nHelper,</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineminus">-  initLogModule,</span>
<a href="#l3.21"></a><span id="l3.21"> } = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l3.22"></a><span id="l3.22"> var {Services} = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l3.23"></a><span id="l3.23"> var {ircHandlers} = ChromeUtils.import(&quot;resource:///modules/ircHandlers.jsm&quot;);</span>
<a href="#l3.24"></a><span id="l3.24"> var {</span>
<a href="#l3.25"></a><span id="l3.25">   _,</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineminus">-  _conv,</span>
<a href="#l3.27"></a><span id="l3.27">   ctcpFormatToText,</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineminus">-  ctcpFormatToHTML,</span>
<a href="#l3.29"></a><span id="l3.29">   conversationErrorMessage,</span>
<a href="#l3.30"></a><span id="l3.30">   kListRefreshInterval,</span>
<a href="#l3.31"></a><span id="l3.31"> } = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineminus">-var {</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineminus">-  GenericAccountPrototype,</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineminus">-  GenericAccountBuddyPrototype,</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineminus">-  GenericConvIMPrototype,</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineminus">-  GenericConvChatPrototype,</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineminus">-  GenericConvChatBuddyPrototype,</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineminus">-  GenericConversationPrototype,</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineminus">-  GenericMessagePrototype,</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineminus">-  GenericProtocolPrototype,</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineminus">-  Message,</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineminus">-  TooltipInfo,</span>
<a href="#l3.43"></a><span id="l3.43" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/jsProtoHelper.jsm&quot;);</span>
<a href="#l3.44"></a><span id="l3.44"> </span>
<a href="#l3.45"></a><span id="l3.45"> function privmsg(aAccount, aMessage, aIsNotification) {</span>
<a href="#l3.46"></a><span id="l3.46">   let params = {incoming: true, tags: aMessage.tags};</span>
<a href="#l3.47"></a><span id="l3.47">   if (aIsNotification)</span>
<a href="#l3.48"></a><span id="l3.48">     params.notification = true;</span>
<a href="#l3.49"></a><span id="l3.49">   aAccount.getConversation(aAccount.isMUCName(aMessage.params[0]) ?</span>
<a href="#l3.50"></a><span id="l3.50">                              aMessage.params[0] : aMessage.origin)</span>
<a href="#l3.51"></a><span id="l3.51">           .writeMessage(aMessage.origin, aMessage.params[1], params);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/chat/protocols/irc/ircCAP.jsm</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/chat/protocols/irc/ircCAP.jsm</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -15,24 +15,16 @@</span>
<a href="#l4.4"></a><span id="l4.4">  *</span>
<a href="#l4.5"></a><span id="l4.5">  * Note that this doesn't include any implementation as these RFCs do not even</span>
<a href="#l4.6"></a><span id="l4.6">  * include example parameters.</span>
<a href="#l4.7"></a><span id="l4.7">  */</span>
<a href="#l4.8"></a><span id="l4.8"> </span>
<a href="#l4.9"></a><span id="l4.9"> this.EXPORTED_SYMBOLS = [&quot;ircCAP&quot;];</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11"> const {ircHandlers} = ChromeUtils.import(&quot;resource:///modules/ircHandlers.jsm&quot;);</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-var {</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-  _,</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-  _conv,</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-  ctcpFormatToText,</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">-  ctcpFormatToHTML,</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">-  conversationErrorMessage,</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineminus">-  kListRefreshInterval,</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21"> /*</span>
<a href="#l4.22"></a><span id="l4.22">  * Parses a CAP message of the form:</span>
<a href="#l4.23"></a><span id="l4.23">  *   CAP &lt;subcommand&gt; [&lt;parameters&gt;]</span>
<a href="#l4.24"></a><span id="l4.24">  * The cap field is added to the message and it has the following fields:</span>
<a href="#l4.25"></a><span id="l4.25">  *   subcommand</span>
<a href="#l4.26"></a><span id="l4.26">  *   parameters A list of capabilities.</span>
<a href="#l4.27"></a><span id="l4.27">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/chat/protocols/irc/ircCTCP.jsm</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/chat/protocols/irc/ircCTCP.jsm</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -6,36 +6,18 @@</span>
<a href="#l5.4"></a><span id="l5.4">  * This implements the Client-to-Client Protocol (CTCP), a subprotocol of IRC.</span>
<a href="#l5.5"></a><span id="l5.5">  *   REVISED AND UPDATED CTCP SPECIFICATION</span>
<a href="#l5.6"></a><span id="l5.6">  *     http://www.alien.net.au/irc/ctcp.txt</span>
<a href="#l5.7"></a><span id="l5.7">  */</span>
<a href="#l5.8"></a><span id="l5.8"> </span>
<a href="#l5.9"></a><span id="l5.9"> this.EXPORTED_SYMBOLS = [&quot;ircCTCP&quot;, &quot;ctcpBase&quot;];</span>
<a href="#l5.10"></a><span id="l5.10"> </span>
<a href="#l5.11"></a><span id="l5.11"> const {Services} = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-var {</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-  XPCOMUtils,</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-  setTimeout,</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineminus">-  clearTimeout,</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineminus">-  executeSoon,</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineminus">-  nsSimpleEnumerator,</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineminus">-  EmptyEnumerator,</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineminus">-  ClassInfo,</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineminus">-  l10nHelper,</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineminus">-  initLogModule,</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l5.23"></a><span id="l5.23"> const {ircHandlers} = ChromeUtils.import(&quot;resource:///modules/ircHandlers.jsm&quot;);</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineminus">-var {</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineminus">-  _,</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineminus">-  _conv,</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineminus">-  ctcpFormatToText,</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineminus">-  ctcpFormatToHTML,</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineminus">-  conversationErrorMessage,</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineminus">-  kListRefreshInterval,</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+var {_} = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l5.33"></a><span id="l5.33"> </span>
<a href="#l5.34"></a><span id="l5.34"> // Split into a CTCP message which is a single command and a single parameter:</span>
<a href="#l5.35"></a><span id="l5.35"> //   &lt;command&gt; &quot; &quot; &lt;parameter&gt;</span>
<a href="#l5.36"></a><span id="l5.36"> // The high level dequote is to unescape \001 in the message content.</span>
<a href="#l5.37"></a><span id="l5.37"> function CTCPMessage(aMessage, aRawCTCPMessage) {</span>
<a href="#l5.38"></a><span id="l5.38">   let message = Object.assign({}, aMessage);</span>
<a href="#l5.39"></a><span id="l5.39">   message.ctcp = {};</span>
<a href="#l5.40"></a><span id="l5.40">   message.ctcp.rawMessage = aRawCTCPMessage;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/chat/protocols/irc/ircCommands.jsm</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/chat/protocols/irc/ircCommands.jsm</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1,35 +1,19 @@</span>
<a href="#l6.4"></a><span id="l6.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.5"></a><span id="l6.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.6"></a><span id="l6.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l6.7"></a><span id="l6.7"> </span>
<a href="#l6.8"></a><span id="l6.8"> // This is to be exported directly onto the IRC prplIProtocol object, directly</span>
<a href="#l6.9"></a><span id="l6.9"> // implementing the commands field before we register them.</span>
<a href="#l6.10"></a><span id="l6.10"> this.EXPORTED_SYMBOLS = [&quot;commands&quot;];</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-var {</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-  XPCOMUtils,</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-  setTimeout,</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-  clearTimeout,</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineminus">-  executeSoon,</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineminus">-  nsSimpleEnumerator,</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineminus">-  EmptyEnumerator,</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineminus">-  ClassInfo,</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineminus">-  l10nHelper,</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineminus">-  initLogModule,</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineminus">-var {</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineminus">-  _,</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineminus">-  _conv,</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineminus">-  ctcpFormatToText,</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineminus">-  ctcpFormatToHTML,</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineminus">-  conversationErrorMessage,</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineminus">-  kListRefreshInterval,</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineplus">+var {Services} = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+var {ClassInfo} = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineplus">+var {_} = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l6.34"></a><span id="l6.34"> </span>
<a href="#l6.35"></a><span id="l6.35"> // Shortcut to get the JavaScript conversation object.</span>
<a href="#l6.36"></a><span id="l6.36"> function getConv(aConv) { return aConv.wrappedJSObject; }</span>
<a href="#l6.37"></a><span id="l6.37"> </span>
<a href="#l6.38"></a><span id="l6.38"> // Shortcut to get the JavaScript account object.</span>
<a href="#l6.39"></a><span id="l6.39"> function getAccount(aConv) { return getConv(aConv)._account; }</span>
<a href="#l6.40"></a><span id="l6.40"> </span>
<a href="#l6.41"></a><span id="l6.41"> // Trim leading and trailing spaces and split a string by any type of space.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/chat/protocols/irc/ircDCC.jsm</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/chat/protocols/irc/ircDCC.jsm</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -7,36 +7,16 @@</span>
<a href="#l7.4"></a><span id="l7.4">  * protocol.</span>
<a href="#l7.5"></a><span id="l7.5">  *   A description of the DCC protocol</span>
<a href="#l7.6"></a><span id="l7.6">  *     http://www.irchelp.org/irchelp/rfc/dccspec.html</span>
<a href="#l7.7"></a><span id="l7.7">  */</span>
<a href="#l7.8"></a><span id="l7.8"> </span>
<a href="#l7.9"></a><span id="l7.9"> this.EXPORTED_SYMBOLS = [&quot;ctcpDCC&quot;/* , &quot;dccBase&quot;*/];</span>
<a href="#l7.10"></a><span id="l7.10"> </span>
<a href="#l7.11"></a><span id="l7.11"> const {ircHandlers} = ChromeUtils.import(&quot;resource:///modules/ircHandlers.jsm&quot;);</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-var {</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-  _,</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-  _conv,</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-  ctcpFormatToText,</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineminus">-  ctcpFormatToHTML,</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineminus">-  conversationErrorMessage,</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineminus">-  kListRefreshInterval,</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineminus">-var {</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineminus">-  GenericAccountPrototype,</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineminus">-  GenericAccountBuddyPrototype,</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineminus">-  GenericConvIMPrototype,</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineminus">-  GenericConvChatPrototype,</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineminus">-  GenericConvChatBuddyPrototype,</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineminus">-  GenericConversationPrototype,</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineminus">-  GenericMessagePrototype,</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineminus">-  GenericProtocolPrototype,</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineminus">-  Message,</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineminus">-  TooltipInfo,</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/jsProtoHelper.jsm&quot;);</span>
<a href="#l7.32"></a><span id="l7.32"> </span>
<a href="#l7.33"></a><span id="l7.33"> // Parse a CTCP message into a DCC message. A DCC message is a CTCP message of</span>
<a href="#l7.34"></a><span id="l7.34"> // the form:</span>
<a href="#l7.35"></a><span id="l7.35"> //   DCC &lt;type&gt; &lt;argument&gt; &lt;address&gt; &lt;port&gt; [&lt;size&gt;]</span>
<a href="#l7.36"></a><span id="l7.36"> function DCCMessage(aMessage, aAccount) {</span>
<a href="#l7.37"></a><span id="l7.37">   let message = aMessage;</span>
<a href="#l7.38"></a><span id="l7.38">   let params = message.ctcp.param.split(&quot; &quot;);</span>
<a href="#l7.39"></a><span id="l7.39">   if (params.length &lt; 4) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/chat/protocols/irc/ircHandlers.jsm</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/chat/protocols/irc/ircHandlers.jsm</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1,23 +1,14 @@</span>
<a href="#l8.4"></a><span id="l8.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.5"></a><span id="l8.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.6"></a><span id="l8.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8"> this.EXPORTED_SYMBOLS = [&quot;ircHandlers&quot;];</span>
<a href="#l8.9"></a><span id="l8.9"> </span>
<a href="#l8.10"></a><span id="l8.10" class="difflineminus">-var {</span>
<a href="#l8.11"></a><span id="l8.11" class="difflineminus">-  _,</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-  _conv,</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-  ctcpFormatToText,</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-  ctcpFormatToHTML,</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-  conversationErrorMessage,</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineminus">-  kListRefreshInterval,</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineminus">-</span>
<a href="#l8.19"></a><span id="l8.19"> var ircHandlers = {</span>
<a href="#l8.20"></a><span id="l8.20">   /*</span>
<a href="#l8.21"></a><span id="l8.21">    * Object to hold the IRC handlers, each handler is an object that implements:</span>
<a href="#l8.22"></a><span id="l8.22">    *   name        The display name of the handler.</span>
<a href="#l8.23"></a><span id="l8.23">    *   priority    The priority of the handler (0 is default, positive is</span>
<a href="#l8.24"></a><span id="l8.24">    *               higher priority)</span>
<a href="#l8.25"></a><span id="l8.25">    *   isEnabled   A function where 'this' is bound to the account object. This</span>
<a href="#l8.26"></a><span id="l8.26">    *               should reflect whether this handler should be used for this</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/chat/protocols/irc/ircISUPPORT.jsm</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/chat/protocols/irc/ircISUPPORT.jsm</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -10,24 +10,16 @@</span>
<a href="#l9.4"></a><span id="l9.4">  *   RFC Drafts: IRC RPL_ISUPPORT Numeric Definition</span>
<a href="#l9.5"></a><span id="l9.5">  *     http://tools.ietf.org/html/draft-brocklesby-irc-isupport-03</span>
<a href="#l9.6"></a><span id="l9.6">  *     http://tools.ietf.org/html/draft-hardy-irc-isupport-00</span>
<a href="#l9.7"></a><span id="l9.7">  */</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9"> this.EXPORTED_SYMBOLS = [&quot;ircISUPPORT&quot;, &quot;isupportBase&quot;];</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11"> const {ircHandlers} = ChromeUtils.import(&quot;resource:///modules/ircHandlers.jsm&quot;);</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-var {</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-  _,</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineminus">-  _conv,</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineminus">-  ctcpFormatToText,</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineminus">-  ctcpFormatToHTML,</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineminus">-  conversationErrorMessage,</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineminus">-  kListRefreshInterval,</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l9.20"></a><span id="l9.20"> </span>
<a href="#l9.21"></a><span id="l9.21"> /*</span>
<a href="#l9.22"></a><span id="l9.22">  * Parses an ircMessage into an ISUPPORT message for each token of the form:</span>
<a href="#l9.23"></a><span id="l9.23">  *   &lt;parameter&gt;=&lt;value&gt; or -&lt;value&gt;</span>
<a href="#l9.24"></a><span id="l9.24">  * The isupport field is added to the message and it has the following fields:</span>
<a href="#l9.25"></a><span id="l9.25">  *   parameter  What is being configured by this ISUPPORT token.</span>
<a href="#l9.26"></a><span id="l9.26">  *   useDefault Whether this parameter should be reset to the default value, as</span>
<a href="#l9.27"></a><span id="l9.27">  *              defined by the RFC.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/chat/protocols/irc/ircNonStandard.jsm</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/chat/protocols/irc/ircNonStandard.jsm</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -12,19 +12,16 @@</span>
<a href="#l10.4"></a><span id="l10.4">  *  https://github.com/atheme/charybdis/blob/master/include/numeric.h</span>
<a href="#l10.5"></a><span id="l10.5">  *  http://hg.unrealircd.com/hg/unreal/raw-file/tip/include/numeric.h</span>
<a href="#l10.6"></a><span id="l10.6">  */</span>
<a href="#l10.7"></a><span id="l10.7"> this.EXPORTED_SYMBOLS = [&quot;ircNonStandard&quot;];</span>
<a href="#l10.8"></a><span id="l10.8"> </span>
<a href="#l10.9"></a><span id="l10.9"> const {ircHandlers} = ChromeUtils.import(&quot;resource:///modules/ircHandlers.jsm&quot;);</span>
<a href="#l10.10"></a><span id="l10.10"> var {</span>
<a href="#l10.11"></a><span id="l10.11">   _,</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-  _conv,</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-  ctcpFormatToText,</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-  ctcpFormatToHTML,</span>
<a href="#l10.15"></a><span id="l10.15">   conversationErrorMessage,</span>
<a href="#l10.16"></a><span id="l10.16">   kListRefreshInterval,</span>
<a href="#l10.17"></a><span id="l10.17"> } = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l10.18"></a><span id="l10.18"> </span>
<a href="#l10.19"></a><span id="l10.19"> var ircNonStandard = {</span>
<a href="#l10.20"></a><span id="l10.20">   name: &quot;Non-Standard IRC Extensions&quot;,</span>
<a href="#l10.21"></a><span id="l10.21">   priority: ircHandlers.DEFAULT_PRIORITY + 1,</span>
<a href="#l10.22"></a><span id="l10.22">   isEnabled: () =&gt; true,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/chat/protocols/irc/ircSASL.jsm</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/chat/protocols/irc/ircSASL.jsm</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -6,24 +6,16 @@</span>
<a href="#l11.4"></a><span id="l11.4">  * This implements SASL for IRC.</span>
<a href="#l11.5"></a><span id="l11.5">  *   https://raw.github.com/atheme/atheme/master/doc/SASL</span>
<a href="#l11.6"></a><span id="l11.6">  *   https://github.com/ircv3/ircv3-specifications/blob/master/extensions/sasl-3.1</span>
<a href="#l11.7"></a><span id="l11.7">  */</span>
<a href="#l11.8"></a><span id="l11.8"> </span>
<a href="#l11.9"></a><span id="l11.9"> this.EXPORTED_SYMBOLS = [&quot;ircSASL&quot;, &quot;capSASL&quot;];</span>
<a href="#l11.10"></a><span id="l11.10"> </span>
<a href="#l11.11"></a><span id="l11.11"> const {ircHandlers} = ChromeUtils.import(&quot;resource:///modules/ircHandlers.jsm&quot;);</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-var {</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-  _,</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-  _conv,</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineminus">-  ctcpFormatToText,</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineminus">-  ctcpFormatToHTML,</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineminus">-  conversationErrorMessage,</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineminus">-  kListRefreshInterval,</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l11.20"></a><span id="l11.20"> </span>
<a href="#l11.21"></a><span id="l11.21"> var ircSASL = {</span>
<a href="#l11.22"></a><span id="l11.22">   name: &quot;SASL AUTHENTICATE&quot;,</span>
<a href="#l11.23"></a><span id="l11.23">   priority: ircHandlers.DEFAULT_PRIORITY,</span>
<a href="#l11.24"></a><span id="l11.24">   isEnabled: () =&gt; true,</span>
<a href="#l11.25"></a><span id="l11.25"> </span>
<a href="#l11.26"></a><span id="l11.26">   commands: {</span>
<a href="#l11.27"></a><span id="l11.27">     &quot;AUTHENTICATE&quot;: function(aMessage) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/chat/protocols/irc/ircServices.jsm</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/chat/protocols/irc/ircServices.jsm</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -14,35 +14,20 @@</span>
<a href="#l12.4"></a><span id="l12.4">  *</span>
<a href="#l12.5"></a><span id="l12.5">  * Anope</span>
<a href="#l12.6"></a><span id="l12.6">  *  http://www.anope.org/docgen/1.8/</span>
<a href="#l12.7"></a><span id="l12.7">  */</span>
<a href="#l12.8"></a><span id="l12.8"> </span>
<a href="#l12.9"></a><span id="l12.9"> this.EXPORTED_SYMBOLS = [&quot;ircServices&quot;, &quot;servicesBase&quot;];</span>
<a href="#l12.10"></a><span id="l12.10"> </span>
<a href="#l12.11"></a><span id="l12.11"> var {</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  XPCOMUtils,</span>
<a href="#l12.13"></a><span id="l12.13">   setTimeout,</span>
<a href="#l12.14"></a><span id="l12.14">   clearTimeout,</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-  executeSoon,</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-  nsSimpleEnumerator,</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-  EmptyEnumerator,</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-  ClassInfo,</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineminus">-  l10nHelper,</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineminus">-  initLogModule,</span>
<a href="#l12.21"></a><span id="l12.21"> } = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l12.22"></a><span id="l12.22"> const {ircHandlers} = ChromeUtils.import(&quot;resource:///modules/ircHandlers.jsm&quot;);</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineminus">-var {</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineminus">-  _,</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineminus">-  _conv,</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineminus">-  ctcpFormatToText,</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineminus">-  ctcpFormatToHTML,</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineminus">-  conversationErrorMessage,</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineminus">-  kListRefreshInterval,</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l12.31"></a><span id="l12.31"> </span>
<a href="#l12.32"></a><span id="l12.32"> /*</span>
<a href="#l12.33"></a><span id="l12.33">  * If a service is found, an extra field (serviceName) is added with the</span>
<a href="#l12.34"></a><span id="l12.34">  * &quot;generic&quot; service name (e.g. a bot which performs NickServ like functionality</span>
<a href="#l12.35"></a><span id="l12.35">  * will be mapped to NickServ).</span>
<a href="#l12.36"></a><span id="l12.36">  */</span>
<a href="#l12.37"></a><span id="l12.37"> function ServiceMessage(aAccount, aMessage) {</span>
<a href="#l12.38"></a><span id="l12.38">   // This should be a property of the account or configurable somehow, it maps</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/chat/protocols/irc/ircUtils.jsm</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/chat/protocols/irc/ircUtils.jsm</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -2,24 +2,17 @@</span>
<a href="#l13.4"></a><span id="l13.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l13.5"></a><span id="l13.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l13.6"></a><span id="l13.6"> </span>
<a href="#l13.7"></a><span id="l13.7"> this.EXPORTED_SYMBOLS = [&quot;_&quot;, &quot;_conv&quot;, &quot;ctcpFormatToText&quot;, &quot;ctcpFormatToHTML&quot;,</span>
<a href="#l13.8"></a><span id="l13.8">                           &quot;conversationErrorMessage&quot;, &quot;kListRefreshInterval&quot;];</span>
<a href="#l13.9"></a><span id="l13.9"> </span>
<a href="#l13.10"></a><span id="l13.10"> var {</span>
<a href="#l13.11"></a><span id="l13.11">   XPCOMUtils,</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-  setTimeout,</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-  clearTimeout,</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-  executeSoon,</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineminus">-  nsSimpleEnumerator,</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineminus">-  EmptyEnumerator,</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineminus">-  ClassInfo,</span>
<a href="#l13.18"></a><span id="l13.18">   l10nHelper,</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineminus">-  initLogModule,</span>
<a href="#l13.20"></a><span id="l13.20"> } = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l13.21"></a><span id="l13.21"> </span>
<a href="#l13.22"></a><span id="l13.22"> XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l13.23"></a><span id="l13.23">   l10nHelper(&quot;chrome://chat/locale/irc.properties&quot;)</span>
<a href="#l13.24"></a><span id="l13.24"> );</span>
<a href="#l13.25"></a><span id="l13.25"> </span>
<a href="#l13.26"></a><span id="l13.26"> XPCOMUtils.defineLazyGetter(this, &quot;_conv&quot;, () =&gt;</span>
<a href="#l13.27"></a><span id="l13.27">   l10nHelper(&quot;chrome://chat/locale/conversations.properties&quot;)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/chat/protocols/irc/ircWatchMonitor.jsm</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/chat/protocols/irc/ircWatchMonitor.jsm</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -10,36 +10,18 @@</span>
<a href="#l14.4"></a><span id="l14.4">  *     https://github.com/atheme/charybdis/blob/master/doc/monitor.txt</span>
<a href="#l14.5"></a><span id="l14.5">  *   WATCH (supported by Bahamut and UnrealIRCd)</span>
<a href="#l14.6"></a><span id="l14.6">  *     http://www.stack.nl/~jilles/cgi-bin/hgwebdir.cgi/irc-documentation-jilles/raw-file/tip/reference/draft-meglio-irc-watch-00.txt</span>
<a href="#l14.7"></a><span id="l14.7">  */</span>
<a href="#l14.8"></a><span id="l14.8"> </span>
<a href="#l14.9"></a><span id="l14.9"> this.EXPORTED_SYMBOLS = [&quot;ircWATCH&quot;, &quot;isupportWATCH&quot;, &quot;ircMONITOR&quot;,</span>
<a href="#l14.10"></a><span id="l14.10">                           &quot;isupportMONITOR&quot;];</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-var {</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-  XPCOMUtils,</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-  setTimeout,</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-  clearTimeout,</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineminus">-  executeSoon,</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineminus">-  nsSimpleEnumerator,</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineminus">-  EmptyEnumerator,</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineminus">-  ClassInfo,</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineminus">-  l10nHelper,</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineminus">-  initLogModule,</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineplus">+var {clearTimeout} = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l14.24"></a><span id="l14.24"> const {ircHandlers} = ChromeUtils.import(&quot;resource:///modules/ircHandlers.jsm&quot;);</span>
<a href="#l14.25"></a><span id="l14.25" class="difflineminus">-var {</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineminus">-  _,</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineminus">-  _conv,</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineminus">-  ctcpFormatToText,</span>
<a href="#l14.29"></a><span id="l14.29" class="difflineminus">-  ctcpFormatToHTML,</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineminus">-  conversationErrorMessage,</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-  kListRefreshInterval,</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l14.33"></a><span id="l14.33"> </span>
<a href="#l14.34"></a><span id="l14.34"> function setStatus(aAccount, aNick, aStatus) {</span>
<a href="#l14.35"></a><span id="l14.35">   if (!aAccount.watchEnabled &amp;&amp; !aAccount.monitorEnabled)</span>
<a href="#l14.36"></a><span id="l14.36">     return false;</span>
<a href="#l14.37"></a><span id="l14.37"> </span>
<a href="#l14.38"></a><span id="l14.38">   if (aStatus == &quot;AWAY&quot;) {</span>
<a href="#l14.39"></a><span id="l14.39">     // We need to request the away message.</span>
<a href="#l14.40"></a><span id="l14.40">     aAccount.requestCurrentWhois(aNick);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/chat/protocols/irc/test/test_ctcpColoring.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_ctcpColoring.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -1,18 +1,14 @@</span>
<a href="#l15.4"></a><span id="l15.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l15.5"></a><span id="l15.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l15.6"></a><span id="l15.6"> </span>
<a href="#l15.7"></a><span id="l15.7"> var {</span>
<a href="#l15.8"></a><span id="l15.8" class="difflineminus">-  _,</span>
<a href="#l15.9"></a><span id="l15.9" class="difflineminus">-  _conv,</span>
<a href="#l15.10"></a><span id="l15.10">   ctcpFormatToText,</span>
<a href="#l15.11"></a><span id="l15.11">   ctcpFormatToHTML,</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-  conversationErrorMessage,</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-  kListRefreshInterval,</span>
<a href="#l15.14"></a><span id="l15.14"> } = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l15.15"></a><span id="l15.15"> </span>
<a href="#l15.16"></a><span id="l15.16"> var input = [</span>
<a href="#l15.17"></a><span id="l15.17">   // From http://www.mirc.com/colors.html</span>
<a href="#l15.18"></a><span id="l15.18">   &quot;\x035,12colored text and background\x03&quot;,</span>
<a href="#l15.19"></a><span id="l15.19">   &quot;\x035colored text\x03&quot;,</span>
<a href="#l15.20"></a><span id="l15.20">   &quot;\x033colored text \x035,2more colored text and background\x03&quot;,</span>
<a href="#l15.21"></a><span id="l15.21">   &quot;\x033,5colored text and background \x038other colored text but same background\x03&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/chat/protocols/irc/test/test_ctcpFormatting.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_ctcpFormatting.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -1,18 +1,14 @@</span>
<a href="#l16.4"></a><span id="l16.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l16.5"></a><span id="l16.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l16.6"></a><span id="l16.6"> </span>
<a href="#l16.7"></a><span id="l16.7"> var {</span>
<a href="#l16.8"></a><span id="l16.8" class="difflineminus">-  _,</span>
<a href="#l16.9"></a><span id="l16.9" class="difflineminus">-  _conv,</span>
<a href="#l16.10"></a><span id="l16.10">   ctcpFormatToText,</span>
<a href="#l16.11"></a><span id="l16.11">   ctcpFormatToHTML,</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-  conversationErrorMessage,</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-  kListRefreshInterval,</span>
<a href="#l16.14"></a><span id="l16.14"> } = ChromeUtils.import(&quot;resource:///modules/ircUtils.jsm&quot;);</span>
<a href="#l16.15"></a><span id="l16.15"> </span>
<a href="#l16.16"></a><span id="l16.16"> // TODO add a test for special JS characters (|, etc...)</span>
<a href="#l16.17"></a><span id="l16.17"> </span>
<a href="#l16.18"></a><span id="l16.18"> var input = [</span>
<a href="#l16.19"></a><span id="l16.19">   &quot;The quick brown fox \x02jumps\x02 over the lazy dog.&quot;,</span>
<a href="#l16.20"></a><span id="l16.20">   &quot;The quick brown fox \x02jumps\x0F over the lazy dog.&quot;,</span>
<a href="#l16.21"></a><span id="l16.21">   &quot;The quick brown \x16fox jumps\x16 over the lazy dog.&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/chat/protocols/irc/test/test_ircServerTime.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_ircServerTime.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -1,12 +1,12 @@</span>
<a href="#l17.4"></a><span id="l17.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l17.5"></a><span id="l17.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l17.6"></a><span id="l17.6"> </span>
<a href="#l17.7"></a><span id="l17.7" class="difflineminus">-var {capServerTime, tagServerTime} = ChromeUtils.import(&quot;resource:///modules/ircServerTime.jsm&quot;);</span>
<a href="#l17.8"></a><span id="l17.8" class="difflineplus">+var {tagServerTime} = ChromeUtils.import(&quot;resource:///modules/ircServerTime.jsm&quot;);</span>
<a href="#l17.9"></a><span id="l17.9"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l17.10"></a><span id="l17.10"> </span>
<a href="#l17.11"></a><span id="l17.11"> var irc = {};</span>
<a href="#l17.12"></a><span id="l17.12"> Services.scriptloader.loadSubScript(&quot;resource:///components/irc.js&quot;, irc);</span>
<a href="#l17.13"></a><span id="l17.13"> </span>
<a href="#l17.14"></a><span id="l17.14"> function getTags(aRawMsg) {</span>
<a href="#l17.15"></a><span id="l17.15">   const {tags} = irc.ircMessage(aRawMsg, &quot;doesnt@matter&quot;);</span>
<a href="#l17.16"></a><span id="l17.16"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/chat/protocols/matrix/matrix-sdk.jsm</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/chat/protocols/matrix/matrix-sdk.jsm</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -1,16 +1,14 @@</span>
<a href="#l18.4"></a><span id="l18.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l18.5"></a><span id="l18.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l18.6"></a><span id="l18.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l18.7"></a><span id="l18.7"> </span>
<a href="#l18.8"></a><span id="l18.8"> const {console} = ChromeUtils.import(&quot;resource://gre/modules/Console.jsm&quot;);</span>
<a href="#l18.9"></a><span id="l18.9" class="difflineminus">-var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l18.10"></a><span id="l18.10"> const {clearInterval, clearTimeout, setInterval, setTimeout} = ChromeUtils.import(&quot;resource://gre/modules/Timer.jsm&quot;);</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineminus">-Cu.importGlobalProperties([&quot;XMLHttpRequest&quot;]);</span>
<a href="#l18.12"></a><span id="l18.12"> </span>
<a href="#l18.13"></a><span id="l18.13"> const { Loader, Require, Module } = ChromeUtils.import(&quot;resource://devtools/shared/base-loader.js&quot;);</span>
<a href="#l18.14"></a><span id="l18.14"> </span>
<a href="#l18.15"></a><span id="l18.15"> this.EXPORTED_SYMBOLS = [&quot;MatrixSDK&quot;];</span>
<a href="#l18.16"></a><span id="l18.16"> </span>
<a href="#l18.17"></a><span id="l18.17"> // Set-up loading so require works properly in CommonJS modules.</span>
<a href="#l18.18"></a><span id="l18.18"> let matrixPath = &quot;resource:///modules/matrix/&quot;;</span>
<a href="#l18.19"></a><span id="l18.19"> let loader = Loader({</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/chat/protocols/skype/skype.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/chat/protocols/skype/skype.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -9,17 +9,23 @@ var {</span>
<a href="#l19.4"></a><span id="l19.4">   BytesToArrayBuffer,</span>
<a href="#l19.5"></a><span id="l19.5">   StringToBytes,</span>
<a href="#l19.6"></a><span id="l19.6">   StringToArrayBuffer,</span>
<a href="#l19.7"></a><span id="l19.7">   ArrayBufferToString,</span>
<a href="#l19.8"></a><span id="l19.8">   ArrayBufferToHexString,</span>
<a href="#l19.9"></a><span id="l19.9"> } = ChromeUtils.import(&quot;resource:///modules/ArrayBufferUtils.jsm&quot;);</span>
<a href="#l19.10"></a><span id="l19.10"> var {bigInt} = ChromeUtils.import(&quot;resource:///modules/BigInteger.jsm&quot;);</span>
<a href="#l19.11"></a><span id="l19.11"> var {Services} = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-var {EmptyEnumerator, XPCOMUtils} = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+var {</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+  EmptyEnumerator,</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+  XPCOMUtils,</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineplus">+  clearTimeout,</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+  l10nHelper,</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineplus">+  nsSimpleEnumerator,</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineplus">+} = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l19.20"></a><span id="l19.20"> var {</span>
<a href="#l19.21"></a><span id="l19.21">   GenericAccountPrototype,</span>
<a href="#l19.22"></a><span id="l19.22">   GenericAccountBuddyPrototype,</span>
<a href="#l19.23"></a><span id="l19.23">   GenericConvIMPrototype,</span>
<a href="#l19.24"></a><span id="l19.24">   GenericConvChatPrototype,</span>
<a href="#l19.25"></a><span id="l19.25">   GenericConvChatBuddyPrototype,</span>
<a href="#l19.26"></a><span id="l19.26">   GenericConversationPrototype,</span>
<a href="#l19.27"></a><span id="l19.27">   GenericMessagePrototype,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/chat/protocols/xmpp/xmpp-authmechs.jsm</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/chat/protocols/xmpp/xmpp-authmechs.jsm</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -10,21 +10,17 @@</span>
<a href="#l20.4"></a><span id="l20.4"> // add-ons can add support for more auth mechanisms easily by adding them</span>
<a href="#l20.5"></a><span id="l20.5"> // in XMPPAuthMechanisms without having to modify XMPPSession.</span>
<a href="#l20.6"></a><span id="l20.6"> </span>
<a href="#l20.7"></a><span id="l20.7"> this.EXPORTED_SYMBOLS = [&quot;XMPPAuthMechanisms&quot;];</span>
<a href="#l20.8"></a><span id="l20.8"> </span>
<a href="#l20.9"></a><span id="l20.9"> const {CommonUtils} = ChromeUtils.import(&quot;resource://services-common/utils.js&quot;);</span>
<a href="#l20.10"></a><span id="l20.10"> const {CryptoUtils} = ChromeUtils.import(&quot;resource://services-crypto/utils.js&quot;);</span>
<a href="#l20.11"></a><span id="l20.11"> const {XPCOMUtils} = ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-var {</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineminus">-  Stanza,</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineminus">-  XMPPParser,</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineminus">-  SupportedFeatures,</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/xmpp-xml.jsm&quot;);</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineplus">+var {Stanza} = ChromeUtils.import(&quot;resource:///modules/xmpp-xml.jsm&quot;);</span>
<a href="#l20.18"></a><span id="l20.18"> XPCOMUtils.defineLazyGlobalGetters(this, [&quot;crypto&quot;]);</span>
<a href="#l20.19"></a><span id="l20.19"> </span>
<a href="#l20.20"></a><span id="l20.20"> // Handle PLAIN authorization mechanism.</span>
<a href="#l20.21"></a><span id="l20.21"> function* PlainAuth(aUsername, aPassword, aDomain) {</span>
<a href="#l20.22"></a><span id="l20.22">   let data = &quot;\0&quot; + aUsername + &quot;\0&quot; + aPassword;</span>
<a href="#l20.23"></a><span id="l20.23"> </span>
<a href="#l20.24"></a><span id="l20.24">   // btoa for Unicode, see https://developer.mozilla.org/en-US/docs/DOM/window.btoa</span>
<a href="#l20.25"></a><span id="l20.25">   let base64Data = btoa(unescape(encodeURIComponent(data)));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/chat/protocols/xmpp/xmpp-commands.jsm</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/chat/protocols/xmpp/xmpp-commands.jsm</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -1,24 +1,17 @@</span>
<a href="#l21.4"></a><span id="l21.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l21.5"></a><span id="l21.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l21.6"></a><span id="l21.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l21.7"></a><span id="l21.7"> </span>
<a href="#l21.8"></a><span id="l21.8"> this.EXPORTED_SYMBOLS = [&quot;commands&quot;];</span>
<a href="#l21.9"></a><span id="l21.9"> </span>
<a href="#l21.10"></a><span id="l21.10"> var {</span>
<a href="#l21.11"></a><span id="l21.11">   XPCOMUtils,</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-  setTimeout,</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineminus">-  clearTimeout,</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineminus">-  executeSoon,</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineminus">-  nsSimpleEnumerator,</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineminus">-  EmptyEnumerator,</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineminus">-  ClassInfo,</span>
<a href="#l21.18"></a><span id="l21.18">   l10nHelper,</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineminus">-  initLogModule,</span>
<a href="#l21.20"></a><span id="l21.20"> } = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l21.21"></a><span id="l21.21"> </span>
<a href="#l21.22"></a><span id="l21.22"> XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l21.23"></a><span id="l21.23">   l10nHelper(&quot;chrome://chat/locale/xmpp.properties&quot;)</span>
<a href="#l21.24"></a><span id="l21.24"> );</span>
<a href="#l21.25"></a><span id="l21.25"> </span>
<a href="#l21.26"></a><span id="l21.26"> // Get conversation object.</span>
<a href="#l21.27"></a><span id="l21.27"> function getConv(aConv) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/chat/protocols/xmpp/xmpp-session.jsm</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/chat/protocols/xmpp/xmpp-session.jsm</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -3,30 +3,22 @@</span>
<a href="#l22.4"></a><span id="l22.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l22.5"></a><span id="l22.5"> </span>
<a href="#l22.6"></a><span id="l22.6"> this.EXPORTED_SYMBOLS = [&quot;XMPPSession&quot;, &quot;XMPPDefaultResource&quot;];</span>
<a href="#l22.7"></a><span id="l22.7"> </span>
<a href="#l22.8"></a><span id="l22.8"> const {DNS} = ChromeUtils.import(&quot;resource:///modules/DNS.jsm&quot;);</span>
<a href="#l22.9"></a><span id="l22.9"> const {Services} = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l22.10"></a><span id="l22.10"> var {</span>
<a href="#l22.11"></a><span id="l22.11">   XPCOMUtils,</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-  setTimeout,</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineminus">-  clearTimeout,</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineminus">-  executeSoon,</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineminus">-  nsSimpleEnumerator,</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineminus">-  EmptyEnumerator,</span>
<a href="#l22.17"></a><span id="l22.17" class="difflineminus">-  ClassInfo,</span>
<a href="#l22.18"></a><span id="l22.18">   l10nHelper,</span>
<a href="#l22.19"></a><span id="l22.19" class="difflineminus">-  initLogModule,</span>
<a href="#l22.20"></a><span id="l22.20"> } = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l22.21"></a><span id="l22.21"> var {Socket} = ChromeUtils.import(&quot;resource:///modules/socket.jsm&quot;);</span>
<a href="#l22.22"></a><span id="l22.22"> var {</span>
<a href="#l22.23"></a><span id="l22.23">   Stanza,</span>
<a href="#l22.24"></a><span id="l22.24">   XMPPParser,</span>
<a href="#l22.25"></a><span id="l22.25" class="difflineminus">-  SupportedFeatures,</span>
<a href="#l22.26"></a><span id="l22.26"> } = ChromeUtils.import(&quot;resource:///modules/xmpp-xml.jsm&quot;);</span>
<a href="#l22.27"></a><span id="l22.27"> var {XMPPAuthMechanisms} = ChromeUtils.import(&quot;resource:///modules/xmpp-authmechs.jsm&quot;);</span>
<a href="#l22.28"></a><span id="l22.28"> </span>
<a href="#l22.29"></a><span id="l22.29"> XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l22.30"></a><span id="l22.30">   l10nHelper(&quot;chrome://chat/locale/xmpp.properties&quot;)</span>
<a href="#l22.31"></a><span id="l22.31"> );</span>
<a href="#l22.32"></a><span id="l22.32"> </span>
<a href="#l22.33"></a><span id="l22.33"> // Workaround because a lazy getter can't be exported.</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

