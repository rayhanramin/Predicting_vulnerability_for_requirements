<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 20069:12957589835a7d5e54809d335388c5b960019105</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 12957589835a7d5e54809d335388c5b960019105" />
<meta property="og:url" content="/comm-central/rev/12957589835a7d5e54809d335388c5b960019105" />
<meta property="og:description" content="Bug 1280898 - Set up eslint for calendar files - enable operator-linebreak rule. r=MakeMyDay" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 12957589835a7d5e54809d335388c5b960019105 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/12957589835a7d5e54809d335388c5b960019105">shortlog</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/12957589835a7d5e54809d335388c5b960019105">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105">files</a> |
changeset |
<a href="/comm-central/raw-rev/12957589835a7d5e54809d335388c5b960019105">raw</a>  | <a href="/comm-central/archive/12957589835a7d5e54809d335388c5b960019105.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable operator-linebreak rule. r=MakeMyDay
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#101;&#115;&#108;&#105;&#110;&#116;&#32;&#60;&#101;&#115;&#108;&#105;&#110;&#116;&#64;&#98;&#117;&#103;&#122;&#105;&#108;&#108;&#97;&#46;&#107;&#101;&#119;&#105;&#115;&#46;&#99;&#104;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 08 Jul 2016 14:03:21 +0200</td></tr>

<tr>
 <td>changeset 20069</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/12957589835a7d5e54809d335388c5b960019105">12957589835a7d5e54809d335388c5b960019105</a></td>
</tr>



<tr>
<td>parent 20068</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/32bf9c43bef86ccf9bd434b50967e6c0b818b1af">32bf9c43bef86ccf9bd434b50967e6c0b818b1af</a>
</td>
</tr>

<tr>
<td>child 20070</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/9bb63b34413f5bb8e13d909962b80a5181866d6b">9bb63b34413f5bb8e13d909962b80a5181866d6b</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=12957589835a7d5e54809d335388c5b960019105">12306</a></td></tr>
<tr><td>push user</td><td>mozilla@kewis.ch</td></tr>
<tr><td>push date</td><td class="date age">Sat, 17 Sep 2016 23:12:50 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@12957589835a [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=12957589835a7d5e54809d335388c5b960019105">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=12957589835a7d5e54809d335388c5b960019105&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=12957589835a7d5e54809d335388c5b960019105&newProject=comm-central&newRevision=12957589835a7d5e54809d335388c5b960019105&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=12957589835a7d5e54809d335388c5b960019105&newProject=comm-central&newRevision=12957589835a7d5e54809d335388c5b960019105&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=12957589835a7d5e54809d335388c5b960019105&newProject=comm-central&newRevision=12957589835a7d5e54809d335388c5b960019105&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28MakeMyDay%29&revcount=50">MakeMyDay</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">1280898</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable operator-linebreak rule. r=MakeMyDay

MozReview-Commit-ID: FnPxua1UO6V</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/.eslintrc">calendar/.eslintrc</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/.eslintrc">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/.eslintrc">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/.eslintrc">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/.eslintrc">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/.eslintrc">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.js">calendar/base/content/agenda-listbox.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.xml">calendar/base/content/agenda-listbox.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.xml">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.xml">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.xml">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.xml">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/agenda-listbox.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-base-view.xml">calendar/base/content/calendar-base-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-base-view.xml">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-base-view.xml">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-base-view.xml">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-base-view.xml">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-base-view.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-item-editing.js">calendar/base/content/calendar-item-editing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-item-editing.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-item-editing.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-item-editing.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-item-editing.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-item-editing.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-month-view.xml">calendar/base/content/calendar-month-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-month-view.xml">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-month-view.xml">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-month-view.xml">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-month-view.xml">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-month-view.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-multiday-view.xml">calendar/base/content/calendar-multiday-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-multiday-view.xml">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-multiday-view.xml">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-multiday-view.xml">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-multiday-view.xml">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-multiday-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-task-tree.xml">calendar/base/content/calendar-task-tree.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-task-tree.xml">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-task-tree.xml">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-task-tree.xml">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-task-tree.xml">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-task-tree.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-unifinder.js">calendar/base/content/calendar-unifinder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-unifinder.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-unifinder.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-unifinder.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-unifinder.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-unifinder.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-view-core.xml">calendar/base/content/calendar-view-core.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-view-core.xml">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-view-core.xml">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-view-core.xml">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-view-core.xml">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/calendar-view-core.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-dialog-utils.js">calendar/base/content/dialogs/calendar-dialog-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-dialog-utils.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-dialog-utils.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-dialog-utils.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-dialog-utils.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-dialog-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">calendar/base/content/dialogs/calendar-event-dialog-attendees.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-summary-dialog.js">calendar/base/content/dialogs/calendar-summary-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-summary-dialog.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-summary-dialog.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-summary-dialog.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-summary-dialog.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/dialogs/calendar-summary-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/categories.js">calendar/base/content/preferences/categories.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/categories.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/categories.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/categories.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/categories.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/categories.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/editCategory.js">calendar/base/content/preferences/editCategory.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/editCategory.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/editCategory.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/editCategory.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/editCategory.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/preferences/editCategory.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/widgets/calendar-widgets.xml">calendar/base/content/widgets/calendar-widgets.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/widgets/calendar-widgets.xml">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/widgets/calendar-widgets.xml">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/widgets/calendar-widgets.xml">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/widgets/calendar-widgets.xml">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/content/widgets/calendar-widgets.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calItipUtils.jsm">calendar/base/modules/calItipUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calItipUtils.jsm">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calItipUtils.jsm">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calItipUtils.jsm">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calItipUtils.jsm">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calItipUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calUtils.jsm">calendar/base/modules/calUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calUtils.jsm">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calUtils.jsm">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calUtils.jsm">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calUtils.jsm">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/modules/calUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calFilter.js">calendar/base/src/calFilter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calFilter.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calFilter.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calFilter.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calFilter.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calFilter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calRecurrenceInfo.js">calendar/base/src/calRecurrenceInfo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calRecurrenceInfo.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calRecurrenceInfo.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calRecurrenceInfo.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calRecurrenceInfo.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calRecurrenceInfo.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calUtils.js">calendar/base/src/calUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calUtils.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calUtils.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calUtils.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calUtils.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/base/src/calUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/html-item-editing/react-code.js">calendar/lightning/content/html-item-editing/react-code.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/html-item-editing/react-code.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/html-item-editing/react-code.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/html-item-editing/react-code.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/html-item-editing/react-code.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/html-item-editing/react-code.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-iframe.js">calendar/lightning/content/lightning-item-iframe.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-iframe.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-iframe.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-iframe.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-iframe.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-iframe.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-panel.js">calendar/lightning/content/lightning-item-panel.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-panel.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-panel.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-panel.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-panel.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/content/lightning-item-panel.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/modules/ltnInvitationUtils.jsm">calendar/lightning/modules/ltnInvitationUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/modules/ltnInvitationUtils.jsm">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/modules/ltnInvitationUtils.jsm">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/modules/ltnInvitationUtils.jsm">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/modules/ltnInvitationUtils.jsm">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/lightning/modules/ltnInvitationUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/providers/caldav/calDavCalendar.js">calendar/providers/caldav/calDavCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/providers/caldav/calDavCalendar.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/providers/caldav/calDavCalendar.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/providers/caldav/calDavCalendar.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/providers/caldav/calDavCalendar.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/providers/caldav/calDavCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/providers/storage/calStorageCalendar.js">calendar/providers/storage/calStorageCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/providers/storage/calStorageCalendar.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/providers/storage/calStorageCalendar.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/providers/storage/calStorageCalendar.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/providers/storage/calStorageCalendar.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/providers/storage/calStorageCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/providers/wcap/calWcapCalendarItems.js">calendar/providers/wcap/calWcapCalendarItems.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/providers/wcap/calWcapCalendarItems.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/providers/wcap/calWcapCalendarItems.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/providers/wcap/calWcapCalendarItems.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/providers/wcap/calWcapCalendarItems.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/providers/wcap/calWcapCalendarItems.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/resources/content/datetimepickers/datetimepickers.xml">calendar/resources/content/datetimepickers/datetimepickers.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/resources/content/datetimepickers/datetimepickers.xml">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/resources/content/datetimepickers/datetimepickers.xml">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/resources/content/datetimepickers/datetimepickers.xml">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/resources/content/datetimepickers/datetimepickers.xml">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/resources/content/datetimepickers/datetimepickers.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialog.js">calendar/test/mozmill/eventDialog/testEventDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialog.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialog.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialog.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialog.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testUTF8.js">calendar/test/mozmill/eventDialog/testUTF8.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testUTF8.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testUTF8.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testUTF8.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testUTF8.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/eventDialog/testUTF8.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">calendar/test/mozmill/recurrence/testAnnualRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testDailyRecurrence.js">calendar/test/mozmill/recurrence/testDailyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testDailyRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testDailyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testDailyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testDailyRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testDailyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/calendar-utils.js">calendar/test/mozmill/shared-modules/calendar-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/calendar-utils.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/calendar-utils.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/calendar-utils.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/calendar-utils.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/calendar-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/timezone-utils.js">calendar/test/mozmill/shared-modules/timezone-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/timezone-utils.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/timezone-utils.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/timezone-utils.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/timezone-utils.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/shared-modules/timezone-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testBasicFunctionality.js">calendar/test/mozmill/testBasicFunctionality.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testBasicFunctionality.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testBasicFunctionality.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testBasicFunctionality.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testBasicFunctionality.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testBasicFunctionality.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testLocalICS.js">calendar/test/mozmill/testLocalICS.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testLocalICS.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testLocalICS.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testLocalICS.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testLocalICS.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testLocalICS.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testTodayPane.js">calendar/test/mozmill/testTodayPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testTodayPane.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testTodayPane.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testTodayPane.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testTodayPane.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/testTodayPane.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/timezoneTests/test2.js">calendar/test/mozmill/timezoneTests/test2.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/timezoneTests/test2.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/timezoneTests/test2.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/timezoneTests/test2.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/timezoneTests/test2.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/timezoneTests/test2.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testDayView.js">calendar/test/mozmill/views/testDayView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testDayView.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testDayView.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testDayView.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testDayView.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testDayView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMonthView.js">calendar/test/mozmill/views/testMonthView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMonthView.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMonthView.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMonthView.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMonthView.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMonthView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMultiweekView.js">calendar/test/mozmill/views/testMultiweekView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMultiweekView.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMultiweekView.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMultiweekView.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMultiweekView.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testMultiweekView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testTaskView.js">calendar/test/mozmill/views/testTaskView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testTaskView.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testTaskView.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testTaskView.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testTaskView.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testTaskView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testWeekView.js">calendar/test/mozmill/views/testWeekView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testWeekView.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testWeekView.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testWeekView.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testWeekView.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/mozmill/views/testWeekView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/unit/test_gdata_provider.js">calendar/test/unit/test_gdata_provider.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12957589835a7d5e54809d335388c5b960019105/calendar/test/unit/test_gdata_provider.js">file</a> |
<a href="/comm-central/annotate/12957589835a7d5e54809d335388c5b960019105/calendar/test/unit/test_gdata_provider.js">annotate</a> |
<a href="/comm-central/diff/12957589835a7d5e54809d335388c5b960019105/calendar/test/unit/test_gdata_provider.js">diff</a> |
<a href="/comm-central/comparison/12957589835a7d5e54809d335388c5b960019105/calendar/test/unit/test_gdata_provider.js">comparison</a> |
<a href="/comm-central/log/12957589835a7d5e54809d335388c5b960019105/calendar/test/unit/test_gdata_provider.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/.eslintrc</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/.eslintrc</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -348,16 +348,19 @@</span>
<a href="#l1.4"></a><span id="l1.4">     &quot;no-fallthrough&quot;: 2,</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6">     // Disallow Floating Decimals</span>
<a href="#l1.7"></a><span id="l1.7">     &quot;no-floating-decimal&quot;: 2,</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9">     // Require Space Before Blocks</span>
<a href="#l1.10"></a><span id="l1.10">     &quot;space-before-blocks&quot;: 2,</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+    // Operators always before the line break</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    &quot;operator-linebreak&quot;: [2, &quot;after&quot;, { &quot;overrides&quot;: { &quot;:&quot;: &quot;before&quot;, &quot;?&quot;: &quot;ignore&quot;}}],</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+</span>
<a href="#l1.15"></a><span id="l1.15">     // Will enable these rules later</span>
<a href="#l1.16"></a><span id="l1.16">     &quot;block-spacing&quot;: 0,</span>
<a href="#l1.17"></a><span id="l1.17">     &quot;no-lonely-if&quot;: 0,</span>
<a href="#l1.18"></a><span id="l1.18">     &quot;computed-property-spacing&quot;: 0,</span>
<a href="#l1.19"></a><span id="l1.19"> </span>
<a href="#l1.20"></a><span id="l1.20">     // The following rules will not be enabled currently, but are kept here for</span>
<a href="#l1.21"></a><span id="l1.21">     // easier updates in the future.</span>
<a href="#l1.22"></a><span id="l1.22">     &quot;no-else-return&quot;: 0,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/agenda-listbox.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/agenda-listbox.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -514,18 +514,18 @@ function deleteItem(aItem, aMoveSelectio</span>
<a href="#l2.4"></a><span id="l2.4">  * Remove all items belonging to the specified calendar.</span>
<a href="#l2.5"></a><span id="l2.5">  *</span>
<a href="#l2.6"></a><span id="l2.6">  * @param aCalendar         The item to compare.</span>
<a href="#l2.7"></a><span id="l2.7">  */</span>
<a href="#l2.8"></a><span id="l2.8"> agendaListbox.deleteItemsFromCalendar =</span>
<a href="#l2.9"></a><span id="l2.9"> function deleteItemsFromCalendar(aCalendar) {</span>
<a href="#l2.10"></a><span id="l2.10">     let childNodes = Array.from(this.agendaListboxControl.childNodes);</span>
<a href="#l2.11"></a><span id="l2.11">     for (let childNode of childNodes) {</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        if (childNode &amp;&amp; childNode.occurrence</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-            &amp;&amp; childNode.occurrence.calendar.id == aCalendar.id) {</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+        if (childNode &amp;&amp; childNode.occurrence &amp;&amp;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+            childNode.occurrence.calendar.id == aCalendar.id) {</span>
<a href="#l2.16"></a><span id="l2.16">             childNode.remove();</span>
<a href="#l2.17"></a><span id="l2.17">         }</span>
<a href="#l2.18"></a><span id="l2.18">     }</span>
<a href="#l2.19"></a><span id="l2.19"> };</span>
<a href="#l2.20"></a><span id="l2.20"> </span>
<a href="#l2.21"></a><span id="l2.21"> /**</span>
<a href="#l2.22"></a><span id="l2.22">  * Compares two items to see if they have the same id and their start date</span>
<a href="#l2.23"></a><span id="l2.23">  * matches</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/agenda-listbox.xml</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/agenda-listbox.xml</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -222,35 +222,35 @@</span>
<a href="#l3.4"></a><span id="l3.4">             // Show items's date for long periods but also for &quot;Upcoming&quot;</span>
<a href="#l3.5"></a><span id="l3.5">             // period with one day duration.</span>
<a href="#l3.6"></a><span id="l3.6">             let longFormat = aPeriod.multiday || aPeriod.duration &gt; 1;</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8">             let duration = &quot;&quot;;</span>
<a href="#l3.9"></a><span id="l3.9">             let iconType = &quot;&quot;;</span>
<a href="#l3.10"></a><span id="l3.10">             if (startDate.compare(endDate) == 0) {</span>
<a href="#l3.11"></a><span id="l3.11">                 // event that starts and ends in the same day, midnight included</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-                duration = longFormat ? dateFormatter.formatDateTime(start) :</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-                                        dateFormatter.formatTime(start);</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+                duration = longFormat ? dateFormatter.formatDateTime(start)</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+                                      : dateFormatter.formatTime(start);</span>
<a href="#l3.16"></a><span id="l3.16">             } else {</span>
<a href="#l3.17"></a><span id="l3.17">                 // event spanning multiple days</span>
<a href="#l3.18"></a><span id="l3.18">                 if (startDate.compare(periodStartDate) &gt;= 0 &amp;&amp;</span>
<a href="#l3.19"></a><span id="l3.19">                      startDate.compare(periodEndDate) &lt;= 0) {</span>
<a href="#l3.20"></a><span id="l3.20">                     iconType = &quot;start&quot;;</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineminus">-                    duration = longFormat ? dateFormatter.formatDateTime(start) :</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineminus">-                                            dateFormatter.formatTime(start);</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineplus">+                    duration = longFormat ? dateFormatter.formatDateTime(start)</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineplus">+                                          : dateFormatter.formatTime(start);</span>
<a href="#l3.25"></a><span id="l3.25">                 } else if (endDate.compare(periodStartDate) &gt;= 0 &amp;&amp;</span>
<a href="#l3.26"></a><span id="l3.26">                            endDate.compare(periodEndDate) &lt;= 0) {</span>
<a href="#l3.27"></a><span id="l3.27">                     iconType = &quot;end&quot;;</span>
<a href="#l3.28"></a><span id="l3.28">                     if (endAtMidnight) {</span>
<a href="#l3.29"></a><span id="l3.29">                         duration = dateFormatter.formatDate(endDate) + &quot; &quot;;</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-                        duration = longFormat ? duration + calGetString(&quot;dateFormat&quot;, &quot;midnight&quot;) :</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-                                                calGetString(&quot;dateFormat&quot;, &quot;midnight&quot;);</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+                        duration = longFormat ? duration + calGetString(&quot;dateFormat&quot;, &quot;midnight&quot;)</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+                                              : calGetString(&quot;dateFormat&quot;, &quot;midnight&quot;);</span>
<a href="#l3.34"></a><span id="l3.34">                     } else {</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineminus">-                        duration = longFormat ? dateFormatter.formatDateTime(end) :</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineminus">-                                                dateFormatter.formatTime(end);</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineplus">+                        duration = longFormat ? dateFormatter.formatDateTime(end)</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+                                              : dateFormatter.formatTime(end);</span>
<a href="#l3.39"></a><span id="l3.39">                     }</span>
<a href="#l3.40"></a><span id="l3.40">                 } else {</span>
<a href="#l3.41"></a><span id="l3.41">                     iconType = &quot;continue&quot;;</span>
<a href="#l3.42"></a><span id="l3.42">                 }</span>
<a href="#l3.43"></a><span id="l3.43">             }</span>
<a href="#l3.44"></a><span id="l3.44">             let multiDayImage = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;agenda-multiDayEvent-image&quot;);</span>
<a href="#l3.45"></a><span id="l3.45">             multiDayImage.setAttribute(&quot;type&quot;, iconType);</span>
<a href="#l3.46"></a><span id="l3.46">             let durationbox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;agenda-event-start&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-base-view.xml</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-base-view.xml</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -363,18 +363,18 @@</span>
<a href="#l4.4"></a><span id="l4.4">       &lt;/property&gt;</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6">       &lt;property name=&quot;initialized&quot;&gt;</span>
<a href="#l4.7"></a><span id="l4.7">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l4.8"></a><span id="l4.8">             let retval;</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10">             // Some views throw when accessing an uninitialized startDay</span>
<a href="#l4.11"></a><span id="l4.11">             try {</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-                retval = this.displayCalendar &amp;&amp; this.startDay</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-                         &amp;&amp; this.endDay;</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+                retval = this.displayCalendar &amp;&amp; this.startDay &amp;&amp;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+                         this.endDay;</span>
<a href="#l4.16"></a><span id="l4.16">             } catch (ex) {</span>
<a href="#l4.17"></a><span id="l4.17">                 return false;</span>
<a href="#l4.18"></a><span id="l4.18">             }</span>
<a href="#l4.19"></a><span id="l4.19">             return retval;</span>
<a href="#l4.20"></a><span id="l4.20">         ]]&gt;&lt;/getter&gt;</span>
<a href="#l4.21"></a><span id="l4.21">       &lt;/property&gt;</span>
<a href="#l4.22"></a><span id="l4.22"> </span>
<a href="#l4.23"></a><span id="l4.23">       &lt;method name=&quot;goToDay&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/calendar-item-editing.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/calendar-item-editing.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -397,28 +397,28 @@ function openEventDialog(calendarItem, c</span>
<a href="#l5.4"></a><span id="l5.4">         calendars = calendars.filter(userCanAddItemsToCalendar);</span>
<a href="#l5.5"></a><span id="l5.5">     } else { /* modify */</span>
<a href="#l5.6"></a><span id="l5.6">         calendars = calendars.filter((aCalendar) =&gt; {</span>
<a href="#l5.7"></a><span id="l5.7">             /* If the calendar is the item calendar, we check that the item</span>
<a href="#l5.8"></a><span id="l5.8">              * can be modified. If the calendar is NOT the item calendar, we</span>
<a href="#l5.9"></a><span id="l5.9">              * check that the user can remove items from that calendar and</span>
<a href="#l5.10"></a><span id="l5.10">              * add items to the current one.</span>
<a href="#l5.11"></a><span id="l5.11">              */</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-            return (((calendarItem.calendar != aCalendar)</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-                     &amp;&amp; userCanDeleteItemsFromCalendar(calendarItem.calendar)</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-                     &amp;&amp; userCanAddItemsToCalendar(aCalendar))</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineminus">-                    || ((calendarItem.calendar == aCalendar)</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineminus">-                        &amp;&amp; userCanModifyItem(calendarItem)));</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+            return (((calendarItem.calendar != aCalendar) &amp;&amp;</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+                     userCanDeleteItemsFromCalendar(calendarItem.calendar) &amp;&amp;</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+                     userCanAddItemsToCalendar(aCalendar)) ||</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+                    ((calendarItem.calendar == aCalendar) &amp;&amp;</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+                     userCanModifyItem(calendarItem)));</span>
<a href="#l5.22"></a><span id="l5.22">         });</span>
<a href="#l5.23"></a><span id="l5.23">     }</span>
<a href="#l5.24"></a><span id="l5.24"> </span>
<a href="#l5.25"></a><span id="l5.25" class="difflineminus">-    if (mode == &quot;new&quot;</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineminus">-        &amp;&amp; (!isCalendarWritable(calendar)</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineminus">-            || !userCanAddItemsToCalendar(calendar)</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineminus">-            || !isItemSupported(calendar))) {</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+    if (mode == &quot;new&quot; &amp;&amp;</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+        (!isCalendarWritable(calendar) ||</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+         !userCanAddItemsToCalendar(calendar) ||</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+         !isItemSupported(calendar))) {</span>
<a href="#l5.33"></a><span id="l5.33">         if (calendars.length &lt; 1) {</span>
<a href="#l5.34"></a><span id="l5.34">             // There are no writable calendars or no calendar supports the given</span>
<a href="#l5.35"></a><span id="l5.35">             // item. Don't show the dialog.</span>
<a href="#l5.36"></a><span id="l5.36">             disposeJob(job);</span>
<a href="#l5.37"></a><span id="l5.37">             return;</span>
<a href="#l5.38"></a><span id="l5.38">         } else {</span>
<a href="#l5.39"></a><span id="l5.39">             // Pick the first calendar that supports the item and is writable</span>
<a href="#l5.40"></a><span id="l5.40">             calendar = calendars[0];</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineat">@@ -459,19 +459,18 @@ function openEventDialog(calendarItem, c</span>
<a href="#l5.42"></a><span id="l5.42">     let wrappedCalendar = cal.wrapInstance(calendar, Components.interfaces.calISchedulingSupport);</span>
<a href="#l5.43"></a><span id="l5.43">     let isInvitation = wrappedCalendar &amp;&amp; wrappedCalendar.isInvitation(calendarItem);</span>
<a href="#l5.44"></a><span id="l5.44"> </span>
<a href="#l5.45"></a><span id="l5.45">     // open the dialog modeless</span>
<a href="#l5.46"></a><span id="l5.46">     let url;</span>
<a href="#l5.47"></a><span id="l5.47">     let isEditable = mode == &quot;modify&quot; &amp;&amp; !isInvitation &amp;&amp; userCanModifyItem(calendarItem);</span>
<a href="#l5.48"></a><span id="l5.48">     if (isCalendarWritable(calendar) &amp;&amp; (mode == &quot;new&quot; || isEditable)) {</span>
<a href="#l5.49"></a><span id="l5.49">         if (args.inTab) {</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineminus">-            url = args.useNewItemUI ?</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineminus">-                &quot;chrome://lightning/content/html-item-editing/lightning-item-iframe.html&quot; :</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineminus">-                &quot;chrome://lightning/content/lightning-item-iframe.xul&quot;;</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineplus">+            url = args.useNewItemUI ? &quot;chrome://lightning/content/html-item-editing/lightning-item-iframe.html&quot;</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineplus">+                                    : &quot;chrome://lightning/content/lightning-item-iframe.xul&quot;;</span>
<a href="#l5.55"></a><span id="l5.55">         } else {</span>
<a href="#l5.56"></a><span id="l5.56">             url = &quot;chrome://calendar/content/calendar-event-dialog.xul&quot;;</span>
<a href="#l5.57"></a><span id="l5.57">         }</span>
<a href="#l5.58"></a><span id="l5.58">     } else {</span>
<a href="#l5.59"></a><span id="l5.59">         url = &quot;chrome://calendar/content/calendar-summary-dialog.xul&quot;;</span>
<a href="#l5.60"></a><span id="l5.60">         args.inTab = false;</span>
<a href="#l5.61"></a><span id="l5.61">     }</span>
<a href="#l5.62"></a><span id="l5.62"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/calendar-month-view.xml</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/calendar-month-view.xml</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -79,18 +79,18 @@</span>
<a href="#l6.4"></a><span id="l6.4">         &lt;setter&gt;&lt;![CDATA[</span>
<a href="#l6.5"></a><span id="l6.5">           ASSERT(!this.mOccurrence, &quot;Code changes needed to set the occurrence twice&quot;, true);</span>
<a href="#l6.6"></a><span id="l6.6">           this.mOccurrence = val;</span>
<a href="#l6.7"></a><span id="l6.7">           if (cal.isEvent(val)) {</span>
<a href="#l6.8"></a><span id="l6.8">             if (!val.startDate.isDate) {</span>
<a href="#l6.9"></a><span id="l6.9">               let label = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;item-label&quot;);</span>
<a href="#l6.10"></a><span id="l6.10">               let df = Components.classes[&quot;@mozilla.org/calendar/datetime-formatter;1&quot;]</span>
<a href="#l6.11"></a><span id="l6.11">                                  .getService(Components.interfaces.calIDateTimeFormatter);</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-              let timezone = this.calendarView ? this.calendarView.mTimezone :</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-                             calendarDefaultTimezone();</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+              let timezone = this.calendarView ? this.calendarView.mTimezone</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+                                               : calendarDefaultTimezone();</span>
<a href="#l6.16"></a><span id="l6.16">               let parentDate = ensureDateTime(this.parentBox.date);</span>
<a href="#l6.17"></a><span id="l6.17">               let startTime = val.startDate.getInTimezone(timezone);</span>
<a href="#l6.18"></a><span id="l6.18">               let endTime = val.endDate.getInTimezone(timezone);</span>
<a href="#l6.19"></a><span id="l6.19">               let nextDay = parentDate.clone();</span>
<a href="#l6.20"></a><span id="l6.20">               nextDay.day++;</span>
<a href="#l6.21"></a><span id="l6.21">               let comp = endTime.compare(nextDay);</span>
<a href="#l6.22"></a><span id="l6.22">               if (startTime.compare(parentDate) == -1) {</span>
<a href="#l6.23"></a><span id="l6.23">                 if (comp == 1) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1787,20 +1787,20 @@</span>
<a href="#l7.4"></a><span id="l7.4">         &lt;parameter name=&quot;aOccurrence&quot;/&gt;</span>
<a href="#l7.5"></a><span id="l7.5">         &lt;!-- &quot;start&quot;, &quot;end&quot;, &quot;middle&quot; --&gt;</span>
<a href="#l7.6"></a><span id="l7.6">         &lt;parameter name=&quot;aGrabbedElement&quot;/&gt;</span>
<a href="#l7.7"></a><span id="l7.7">         &lt;!-- mouse screenX/screenY from the event --&gt;</span>
<a href="#l7.8"></a><span id="l7.8">         &lt;parameter name=&quot;aMouseX&quot;/&gt;</span>
<a href="#l7.9"></a><span id="l7.9">         &lt;parameter name=&quot;aMouseY&quot;/&gt;</span>
<a href="#l7.10"></a><span id="l7.10">         &lt;parameter name=&quot;aSnapInt&quot;/&gt;</span>
<a href="#l7.11"></a><span id="l7.11">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-          if (!isCalendarWritable(aOccurrence.calendar)</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-              || !userCanModifyItem(aOccurrence)</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-              || (aOccurrence.calendar instanceof Components.interfaces.calISchedulingSupport &amp;&amp; aOccurrence.calendar.isInvitation(aOccurrence))</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-              || aOccurrence.calendar.getProperty(&quot;capabilities.events.supported&quot;) === false) {</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+          if (!isCalendarWritable(aOccurrence.calendar) ||</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+              !userCanModifyItem(aOccurrence) ||</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+              (aOccurrence.calendar instanceof Components.interfaces.calISchedulingSupport &amp;&amp; aOccurrence.calendar.isInvitation(aOccurrence)) ||</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+              aOccurrence.calendar.getProperty(&quot;capabilities.events.supported&quot;) === false) {</span>
<a href="#l7.20"></a><span id="l7.20">               return;</span>
<a href="#l7.21"></a><span id="l7.21">           }</span>
<a href="#l7.22"></a><span id="l7.22"> </span>
<a href="#l7.23"></a><span id="l7.23">           this.mDragState = {</span>
<a href="#l7.24"></a><span id="l7.24">               origColumn: this,</span>
<a href="#l7.25"></a><span id="l7.25">               dragOccurrence: aOccurrence,</span>
<a href="#l7.26"></a><span id="l7.26">               mouseOffset: 0,</span>
<a href="#l7.27"></a><span id="l7.27">               offset: null,</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineat">@@ -2578,18 +2578,18 @@</span>
<a href="#l7.29"></a><span id="l7.29">           let todayColumn = this.findColumnForDate(this.today());</span>
<a href="#l7.30"></a><span id="l7.30">           if (todayColumn) {</span>
<a href="#l7.31"></a><span id="l7.31">               setBooleanAttribute(todayColumn.column.timeIndicatorBox, &quot;hidden&quot;, hideIndicator);</span>
<a href="#l7.32"></a><span id="l7.32">           }</span>
<a href="#l7.33"></a><span id="l7.33">           // Update the timer but only under some circumstances, otherwise</span>
<a href="#l7.34"></a><span id="l7.34">           // it will update the wrong view or it will start without need.</span>
<a href="#l7.35"></a><span id="l7.35">           let currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l7.36"></a><span id="l7.36">           let currView = currentView().type;</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineminus">-          if (currentMode == &quot;calendar&quot; &amp;&amp; currView == this.type &amp;&amp; !hideIndicator</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineminus">-              &amp;&amp; (currView == &quot;day&quot; || currView == &quot;week&quot;)) {</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineplus">+          if (currentMode == &quot;calendar&quot; &amp;&amp; currView == this.type &amp;&amp; !hideIndicator &amp;&amp;</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineplus">+              (currView == &quot;day&quot; || currView == &quot;week&quot;)) {</span>
<a href="#l7.41"></a><span id="l7.41">               this.updateTimeIndicatorPosition(true);</span>
<a href="#l7.42"></a><span id="l7.42">           }</span>
<a href="#l7.43"></a><span id="l7.43">         ]]&gt;&lt;/body&gt;</span>
<a href="#l7.44"></a><span id="l7.44">       &lt;/method&gt;</span>
<a href="#l7.45"></a><span id="l7.45"> </span>
<a href="#l7.46"></a><span id="l7.46">       &lt;method name=&quot;updateTimeIndicatorPosition&quot;&gt;</span>
<a href="#l7.47"></a><span id="l7.47">         &lt;parameter name=&quot;aUpdateTheTimer&quot;/&gt;</span>
<a href="#l7.48"></a><span id="l7.48">         &lt;parameter name=&quot;aPpmChanged&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1007,20 +1007,21 @@</span>
<a href="#l8.4"></a><span id="l8.4">             this.mTreeView.removeItems(tasks);</span>
<a href="#l8.5"></a><span id="l8.5">         ]]&gt;&lt;/body&gt;</span>
<a href="#l8.6"></a><span id="l8.6">       &lt;/method&gt;</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8">       &lt;method name=&quot;sortItems&quot;&gt;</span>
<a href="#l8.9"></a><span id="l8.9">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l8.10"></a><span id="l8.10">           if (this.mTreeView.selectedColumn) {</span>
<a href="#l8.11"></a><span id="l8.11">               let modifier = (this.mTreeView.sortDirection == &quot;descending&quot; ? -1 : 1);</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-              let sortKey = cal.sortEntry.mSortKey = this.mTreeView.selectedColumn.getAttribute(&quot;sortKey&quot;) ?</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-                          this.mTreeView.selectedColumn.getAttribute(&quot;sortKey&quot;) :</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-                          this.mTreeView.selectedColumn.getAttribute(&quot;itemproperty&quot;);</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-              let sortType = cal.getSortTypeForSortKey(sortKey);</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+              let column = this.mTreeView.selectedColumn;</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+              cal.sortEntry.mSortKey = column.getAttribute(&quot;sortKey&quot;)</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+                                       ? column.getAttribute(&quot;sortKey&quot;)</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+                                       : column.getAttribute(&quot;itemproperty&quot;);</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+              let sortType = cal.getSortTypeForSortKey(cal.sortEntry.mSortKey);</span>
<a href="#l8.21"></a><span id="l8.21"> </span>
<a href="#l8.22"></a><span id="l8.22">               // sort (key,item) entries</span>
<a href="#l8.23"></a><span id="l8.23">               cal.sortEntry.mSortStartedDate = now();</span>
<a href="#l8.24"></a><span id="l8.24">               let entries = this.mTaskArray.map(cal.sortEntry, cal.sortEntry);</span>
<a href="#l8.25"></a><span id="l8.25">               entries.sort(cal.sortEntryComparer(sortType, modifier));</span>
<a href="#l8.26"></a><span id="l8.26">               this.mTaskArray = entries.map(cal.sortEntryItem);</span>
<a href="#l8.27"></a><span id="l8.27">           }</span>
<a href="#l8.28"></a><span id="l8.28"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/content/calendar-unifinder.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/content/calendar-unifinder.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -850,30 +850,28 @@ function refreshEventTree() {</span>
<a href="#l9.4"></a><span id="l9.4">  *</span>
<a href="#l9.5"></a><span id="l9.5">  * If you are implementing a new filter, you can overwrite this function and</span>
<a href="#l9.6"></a><span id="l9.6">  * filter the items accordingly and afterwards call this function with the</span>
<a href="#l9.7"></a><span id="l9.7">  * result.</span>
<a href="#l9.8"></a><span id="l9.8">  *</span>
<a href="#l9.9"></a><span id="l9.9">  * @param eventArray        The array of items to be set in the unifinder.</span>
<a href="#l9.10"></a><span id="l9.10">  */</span>
<a href="#l9.11"></a><span id="l9.11"> function addItemsFromCompositeCalendarInternal(eventArray) {</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    let newItems</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-        = eventArray.filter(unifinderTreeView.mFilter.isItemInFilters,</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineminus">-                            unifinderTreeView.mFilter);</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+    let newItems = eventArray.filter(unifinderTreeView.mFilter.isItemInFilters,</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+                                     unifinderTreeView.mFilter);</span>
<a href="#l9.17"></a><span id="l9.17">     unifinderTreeView.setItems(newItems);</span>
<a href="#l9.18"></a><span id="l9.18"> </span>
<a href="#l9.19"></a><span id="l9.19">     // Select selected events in the tree. Not passing the argument gets the</span>
<a href="#l9.20"></a><span id="l9.20">     // items from the view.</span>
<a href="#l9.21"></a><span id="l9.21">     unifinderTreeView.setSelectedItems();</span>
<a href="#l9.22"></a><span id="l9.22"> }</span>
<a href="#l9.23"></a><span id="l9.23"> </span>
<a href="#l9.24"></a><span id="l9.24"> function addItemsFromSingleCalendarInternal(eventArray) {</span>
<a href="#l9.25"></a><span id="l9.25" class="difflineminus">-    let newItems</span>
<a href="#l9.26"></a><span id="l9.26" class="difflineminus">-        = eventArray.filter(unifinderTreeView.mFilter.isItemInFilters,</span>
<a href="#l9.27"></a><span id="l9.27" class="difflineminus">-                            unifinderTreeView.mFilter);</span>
<a href="#l9.28"></a><span id="l9.28" class="difflineplus">+    let newItems = eventArray.filter(unifinderTreeView.mFilter.isItemInFilters,</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineplus">+                                     unifinderTreeView.mFilter);</span>
<a href="#l9.30"></a><span id="l9.30">     unifinderTreeView.setItems(unifinderTreeView.eventArray.concat(newItems));</span>
<a href="#l9.31"></a><span id="l9.31"> </span>
<a href="#l9.32"></a><span id="l9.32">     // Select selected events in the tree. Not passing the argument gets the</span>
<a href="#l9.33"></a><span id="l9.33">     // items from the view.</span>
<a href="#l9.34"></a><span id="l9.34">     unifinderTreeView.setSelectedItems();</span>
<a href="#l9.35"></a><span id="l9.35"> }</span>
<a href="#l9.36"></a><span id="l9.36"> </span>
<a href="#l9.37"></a><span id="l9.37"> function addItemsFromCalendar(aCalendar, aAddItemsInternalFunc) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/content/calendar-view-core.xml</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/content/calendar-view-core.xml</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -147,18 +147,18 @@</span>
<a href="#l10.4"></a><span id="l10.4">         onget=&quot;return document.getAnonymousElementByAttribute(this, 'anonid', 'event-name');&quot;/&gt;</span>
<a href="#l10.5"></a><span id="l10.5">       &lt;property name=&quot;eventNameTextbox&quot; readonly=&quot;true&quot;</span>
<a href="#l10.6"></a><span id="l10.6">         onget=&quot;return document.getAnonymousElementByAttribute(this, 'anonid', 'event-name-textbox');&quot;/&gt;</span>
<a href="#l10.7"></a><span id="l10.7"> </span>
<a href="#l10.8"></a><span id="l10.8">       &lt;method name=&quot;setEditableLabel&quot;&gt;</span>
<a href="#l10.9"></a><span id="l10.9">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l10.10"></a><span id="l10.10">           let evl = this.eventNameLabel;</span>
<a href="#l10.11"></a><span id="l10.11">           let item = this.mOccurrence;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-          evl.value = (item.title ? item.title.replace(/\n/g, ' ') :</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-                                    cal.calGetString(&quot;calendar&quot;, &quot;eventUntitled&quot;));</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+          evl.value = (item.title ? item.title.replace(/\n/g, ' ')</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+                                  : cal.calGetString(&quot;calendar&quot;, &quot;eventUntitled&quot;));</span>
<a href="#l10.16"></a><span id="l10.16">         ]]&gt;&lt;/body&gt;</span>
<a href="#l10.17"></a><span id="l10.17">       &lt;/method&gt;</span>
<a href="#l10.18"></a><span id="l10.18"> </span>
<a href="#l10.19"></a><span id="l10.19">       &lt;method name=&quot;setCSSClasses&quot;&gt;</span>
<a href="#l10.20"></a><span id="l10.20">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l10.21"></a><span id="l10.21">           let item = this.mOccurrence;</span>
<a href="#l10.22"></a><span id="l10.22">           this.setAttribute(&quot;calendar-uri&quot;, item.calendar.uri.spec);</span>
<a href="#l10.23"></a><span id="l10.23">           this.setAttribute(&quot;calendar-id&quot;, item.calendar.id);</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineat">@@ -358,19 +358,18 @@</span>
<a href="#l10.25"></a><span id="l10.25">             onMouseOverItem(event);</span>
<a href="#l10.26"></a><span id="l10.26">         }</span>
<a href="#l10.27"></a><span id="l10.27">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l10.28"></a><span id="l10.28">       &lt;handler event=&quot;dragstart&quot;&gt;&lt;![CDATA[</span>
<a href="#l10.29"></a><span id="l10.29">         if (event.target.localName == &quot;calendar-event-box&quot;) {</span>
<a href="#l10.30"></a><span id="l10.30">             return;</span>
<a href="#l10.31"></a><span id="l10.31">         }</span>
<a href="#l10.32"></a><span id="l10.32">         let item = this.occurrence;</span>
<a href="#l10.33"></a><span id="l10.33" class="difflineminus">-        if (!isCalendarWritable(item.calendar)</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineminus">-            || !userCanModifyItem(item)</span>
<a href="#l10.35"></a><span id="l10.35" class="difflineminus">-            || (item.calendar instanceof Components.interfaces.calISchedulingSupport &amp;&amp; item.calendar.isInvitation(item))) {</span>
<a href="#l10.36"></a><span id="l10.36" class="difflineplus">+        let isInvitation = item.calendar instanceof Components.interfaces.calISchedulingSupport &amp;&amp; item.calendar.isInvitation(item);</span>
<a href="#l10.37"></a><span id="l10.37" class="difflineplus">+        if (!isCalendarWritable(item.calendar) || !userCanModifyItem(item) || isInvitation) {</span>
<a href="#l10.38"></a><span id="l10.38">             return;</span>
<a href="#l10.39"></a><span id="l10.39">         }</span>
<a href="#l10.40"></a><span id="l10.40">         if (!this.selected) {</span>
<a href="#l10.41"></a><span id="l10.41">             this.select(event);</span>
<a href="#l10.42"></a><span id="l10.42">         }</span>
<a href="#l10.43"></a><span id="l10.43">         invokeEventDragSession(item, this);</span>
<a href="#l10.44"></a><span id="l10.44">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l10.45"></a><span id="l10.45">     &lt;/handlers&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -392,19 +392,19 @@ function getDefaultAlarmType() {</span>
<a href="#l11.4"></a><span id="l11.4">  * Get the currently selected calendar. For dialogs with a menulist of</span>
<a href="#l11.5"></a><span id="l11.5">  * calendars, this is the currently chosen calendar, otherwise its the fixed</span>
<a href="#l11.6"></a><span id="l11.6">  * calendar from the window's item.</span>
<a href="#l11.7"></a><span id="l11.7">  *</span>
<a href="#l11.8"></a><span id="l11.8">  * @return      The currently selected calendar.</span>
<a href="#l11.9"></a><span id="l11.9">  */</span>
<a href="#l11.10"></a><span id="l11.10"> function getCurrentCalendar() {</span>
<a href="#l11.11"></a><span id="l11.11">     let calendarNode = document.getElementById(&quot;item-calendar&quot;);</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-    return (calendarNode &amp;&amp; calendarNode.selectedItem ?</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-                calendarNode.selectedItem.calendar :</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-                window.calendarItem.calendar);</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+    return (calendarNode &amp;&amp; calendarNode.selectedItem</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+                                ? calendarNode.selectedItem.calendar</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+                                : window.calendarItem.calendar);</span>
<a href="#l11.18"></a><span id="l11.18"> }</span>
<a href="#l11.19"></a><span id="l11.19"> </span>
<a href="#l11.20"></a><span id="l11.20"> /**</span>
<a href="#l11.21"></a><span id="l11.21">  * Common update functions for both event dialogs. Called when a reminder has</span>
<a href="#l11.22"></a><span id="l11.22">  * been selected from the menulist.</span>
<a href="#l11.23"></a><span id="l11.23">  *</span>
<a href="#l11.24"></a><span id="l11.24">  * @param aSuppressDialogs     If true, controls are updated without prompting</span>
<a href="#l11.25"></a><span id="l11.25">  *                               for changes with the dialog</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-attendees.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-attendees.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -91,24 +91,22 @@ function onLoad() {</span>
<a href="#l12.4"></a><span id="l12.4"> </span>
<a href="#l12.5"></a><span id="l12.5">     // we need to enforce several layout constraints which can't be modelled</span>
<a href="#l12.6"></a><span id="l12.6">     // with plain xul and css, at least as far as i know.</span>
<a href="#l12.7"></a><span id="l12.7">     const kStylesheet = &quot;chrome://calendar/skin/calendar-event-dialog.css&quot;;</span>
<a href="#l12.8"></a><span id="l12.8">     for (let stylesheet of document.styleSheets) {</span>
<a href="#l12.9"></a><span id="l12.9">         if (stylesheet.href == kStylesheet) {</span>
<a href="#l12.10"></a><span id="l12.10">             // make the dummy-spacer #1 [top] the same height as the timebar</span>
<a href="#l12.11"></a><span id="l12.11">             let timebar = document.getElementById(&quot;timebar&quot;);</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-            stylesheet.insertRule(</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-                &quot;.attendee-spacer-top { height: &quot;</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-                    + timebar.boxObject.height + &quot;px; }&quot;, 0);</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+            stylesheet.insertRule(&quot;.attendee-spacer-top { height: &quot; +</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+                                  timebar.boxObject.height + &quot;px; }&quot;, 0);</span>
<a href="#l12.17"></a><span id="l12.17">             // make the dummy-spacer #2 [bottom] the same height as the scrollbar</span>
<a href="#l12.18"></a><span id="l12.18">             let scrollbar = document.getElementById(&quot;horizontal-scrollbar&quot;);</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineminus">-            stylesheet.insertRule(</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineminus">-                &quot;.attendee-spacer-bottom { height: &quot;</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineminus">-                    + scrollbar.boxObject.height + &quot;px; }&quot;, 0);</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+            stylesheet.insertRule(&quot;.attendee-spacer-bottom { height: &quot; +</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+                                  scrollbar.boxObject.height + &quot;px; }&quot;, 0);</span>
<a href="#l12.24"></a><span id="l12.24">             break;</span>
<a href="#l12.25"></a><span id="l12.25">         }</span>
<a href="#l12.26"></a><span id="l12.26">     }</span>
<a href="#l12.27"></a><span id="l12.27"> </span>
<a href="#l12.28"></a><span id="l12.28">     // attach an observer to get notified of changes</span>
<a href="#l12.29"></a><span id="l12.29">     // that are relevant to this dialog.</span>
<a href="#l12.30"></a><span id="l12.30">     let prefObserver = {</span>
<a href="#l12.31"></a><span id="l12.31">         observe: function aD_observe(aSubject, aTopic, aPrefName) {</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineat">@@ -899,18 +897,18 @@ function onAttrModified(event) {</span>
<a href="#l12.33"></a><span id="l12.33">         event.attrName == &quot;focused&quot;) {</span>
<a href="#l12.34"></a><span id="l12.34">         let attendees = document.getElementById(&quot;attendees-list&quot;);</span>
<a href="#l12.35"></a><span id="l12.35">         if (event.newValue == &quot;true&quot;) {</span>
<a href="#l12.36"></a><span id="l12.36">             let grid = document.getElementById(&quot;freebusy-grid&quot;);</span>
<a href="#l12.37"></a><span id="l12.37">             if (grid.firstVisibleRow != attendees.firstVisibleRow) {</span>
<a href="#l12.38"></a><span id="l12.38">                 grid.firstVisibleRow = attendees.firstVisibleRow;</span>
<a href="#l12.39"></a><span id="l12.39">             }</span>
<a href="#l12.40"></a><span id="l12.40">         }</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineminus">-        if (!target.lastListCheckedValue</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineminus">-            || target.lastListCheckedValue != target.value) {</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineplus">+        if (!target.lastListCheckedValue ||</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineplus">+            target.lastListCheckedValue != target.value) {</span>
<a href="#l12.45"></a><span id="l12.45">             attendees.resolvePotentialList(target);</span>
<a href="#l12.46"></a><span id="l12.46">             target.lastListCheckedValue = target.value;</span>
<a href="#l12.47"></a><span id="l12.47">         }</span>
<a href="#l12.48"></a><span id="l12.48">     }</span>
<a href="#l12.49"></a><span id="l12.49"> </span>
<a href="#l12.50"></a><span id="l12.50">     if (event.originalTarget.localName == &quot;scrollbar&quot;) {</span>
<a href="#l12.51"></a><span id="l12.51">         let scrollbar = event.originalTarget;</span>
<a href="#l12.52"></a><span id="l12.52">         if (scrollbar.hasAttribute(&quot;maxpos&quot;)) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -166,19 +166,18 @@</span>
<a href="#l13.4"></a><span id="l13.4">                           .getService(</span>
<a href="#l13.5"></a><span id="l13.5">                               Components.interfaces.calIDateTimeFormatter);</span>
<a href="#l13.6"></a><span id="l13.6">           }</span>
<a href="#l13.7"></a><span id="l13.7"> </span>
<a href="#l13.8"></a><span id="l13.8">           // First set the formatted date string as title</span>
<a href="#l13.9"></a><span id="l13.9">           let day =</span>
<a href="#l13.10"></a><span id="l13.10">               document.getAnonymousElementByAttribute(</span>
<a href="#l13.11"></a><span id="l13.11">                   this, &quot;anonid&quot;, &quot;day&quot;);</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-          let dateValue = (this.mZoomFactor &gt; 100) ?</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-              this.mDateFormatter.formatDateShort(date) :</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-              this.mDateFormatter.formatDateLong(date);</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineplus">+          let dateValue = this.mZoomFactor &gt; 100 ? this.mDateFormatter.formatDateShort(date)</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineplus">+                                                 : this.mDateFormatter.formatDateLong(date);</span>
<a href="#l13.17"></a><span id="l13.17">           day.setAttribute(&quot;value&quot;, dateValue);</span>
<a href="#l13.18"></a><span id="l13.18"> </span>
<a href="#l13.19"></a><span id="l13.19">           // Now create as many 'hour' elements as needed</span>
<a href="#l13.20"></a><span id="l13.20">           let step_in_minutes = Math.floor(60 * this.mZoomFactor / 100);</span>
<a href="#l13.21"></a><span id="l13.21">           let hours =</span>
<a href="#l13.22"></a><span id="l13.22">               document.getAnonymousElementByAttribute(</span>
<a href="#l13.23"></a><span id="l13.23">                   this, &quot;anonid&quot;, &quot;hours&quot;);</span>
<a href="#l13.24"></a><span id="l13.24">           date.hour = this.mStartHour;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -50,21 +50,21 @@ function onLoad() {</span>
<a href="#l14.4"></a><span id="l14.4">         setDialogId(document.documentElement, &quot;calendar-event-summary-dialog&quot;);</span>
<a href="#l14.5"></a><span id="l14.5">     } else if (cal.isToDo(item)) {</span>
<a href="#l14.6"></a><span id="l14.6">         setDialogId(document.documentElement, &quot;calendar-task-summary-dialog&quot;);</span>
<a href="#l14.7"></a><span id="l14.7">     }</span>
<a href="#l14.8"></a><span id="l14.8"> </span>
<a href="#l14.9"></a><span id="l14.9">     window.attendees = item.getAttendees({});</span>
<a href="#l14.10"></a><span id="l14.10"> </span>
<a href="#l14.11"></a><span id="l14.11">     let calendar = cal.wrapInstance(item.calendar, Components.interfaces.calISchedulingSupport);</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-    window.readOnly = !(isCalendarWritable(calendar)</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-                        &amp;&amp; (userCanModifyItem(item)</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-                            || (calendar</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-                                &amp;&amp; item.calendar.isInvitation(item)</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineminus">-                                &amp;&amp; userCanRespondToInvitation(item))));</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+    window.readOnly = !(isCalendarWritable(calendar) &amp;&amp;</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineplus">+                        (userCanModifyItem(item) ||</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineplus">+                         (calendar &amp;&amp;</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineplus">+                          item.calendar.isInvitation(item) &amp;&amp;</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineplus">+                          userCanRespondToInvitation(item))));</span>
<a href="#l14.22"></a><span id="l14.22">     if (!window.readOnly &amp;&amp; calendar) {</span>
<a href="#l14.23"></a><span id="l14.23">         let attendee = calendar.getInvitedAttendee(item);</span>
<a href="#l14.24"></a><span id="l14.24">         if (attendee) {</span>
<a href="#l14.25"></a><span id="l14.25">             // if this is an unresponded invitation, preset our default alarm values:</span>
<a href="#l14.26"></a><span id="l14.26">             if (!item.getAlarms({}).length &amp;&amp;</span>
<a href="#l14.27"></a><span id="l14.27">                 (attendee.participationStatus == &quot;NEEDS-ACTION&quot;)) {</span>
<a href="#l14.28"></a><span id="l14.28">                 cal.alarms.setDefaultValues(item);</span>
<a href="#l14.29"></a><span id="l14.29">             }</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineat">@@ -237,18 +237,18 @@ function updateInvitationStatus() {</span>
<a href="#l14.31"></a><span id="l14.31">  */</span>
<a href="#l14.32"></a><span id="l14.32"> function updatePartStat() {</span>
<a href="#l14.33"></a><span id="l14.33">   let statusElement = document.getElementById(&quot;item-participation&quot;);</span>
<a href="#l14.34"></a><span id="l14.34">   if (window.attendee) {</span>
<a href="#l14.35"></a><span id="l14.35">       let item = window.arguments[0];</span>
<a href="#l14.36"></a><span id="l14.36">       let aclEntry = item.calendar.aclEntry;</span>
<a href="#l14.37"></a><span id="l14.37">       if (aclEntry) {</span>
<a href="#l14.38"></a><span id="l14.38">           let userAddresses = aclEntry.getUserAddresses({});</span>
<a href="#l14.39"></a><span id="l14.39" class="difflineminus">-          if (userAddresses.length &gt; 0</span>
<a href="#l14.40"></a><span id="l14.40" class="difflineminus">-              &amp;&amp; !cal.attendeeMatchesAddresses(window.attendee, userAddresses)) {</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineplus">+          if (userAddresses.length &gt; 0 &amp;&amp;</span>
<a href="#l14.42"></a><span id="l14.42" class="difflineplus">+              !cal.attendeeMatchesAddresses(window.attendee, userAddresses)) {</span>
<a href="#l14.43"></a><span id="l14.43">               window.attendee.setProperty(&quot;SENT-BY&quot;, &quot;mailto:&quot; + userAddresses[0]);</span>
<a href="#l14.44"></a><span id="l14.44">           }</span>
<a href="#l14.45"></a><span id="l14.45">       }</span>
<a href="#l14.46"></a><span id="l14.46"> </span>
<a href="#l14.47"></a><span id="l14.47">       window.attendee.participationStatus = statusElement.value;</span>
<a href="#l14.48"></a><span id="l14.48">   }</span>
<a href="#l14.49"></a><span id="l14.49"> }</span>
<a href="#l14.50"></a><span id="l14.50"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/base/content/preferences/categories.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/base/content/preferences/categories.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -109,19 +109,19 @@ var gCategoriesPane = {</span>
<a href="#l15.4"></a><span id="l15.4">     addCategory: function gCP_addCategory() {</span>
<a href="#l15.5"></a><span id="l15.5">         let listbox = document.getElementById(&quot;categorieslist&quot;);</span>
<a href="#l15.6"></a><span id="l15.6">         listbox.clearSelection();</span>
<a href="#l15.7"></a><span id="l15.7">         this.updateButtons();</span>
<a href="#l15.8"></a><span id="l15.8">         window.openDialog(&quot;chrome://calendar/content/preferences/editCategory.xul&quot;,</span>
<a href="#l15.9"></a><span id="l15.9">                           &quot;addCategory&quot;,</span>
<a href="#l15.10"></a><span id="l15.10">                           // Workaround for Bug 1151440 - the HTML color picker won't work</span>
<a href="#l15.11"></a><span id="l15.11">                           // in linux when opened from modal dialog</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-                          (AppConstants.platform == &quot;linux&quot;) ?</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-                            &quot;centerscreen,chrome,resizable=no&quot; :</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineminus">-                            &quot;modal,centerscreen,chrome,resizable=no&quot;,</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+                          AppConstants.platform == &quot;linux&quot;</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+                              ? &quot;centerscreen,chrome,resizable=no&quot;</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineplus">+                              : &quot;modal,centerscreen,chrome,resizable=no&quot;,</span>
<a href="#l15.18"></a><span id="l15.18">                           &quot;&quot;, null, addTitle);</span>
<a href="#l15.19"></a><span id="l15.19">     },</span>
<a href="#l15.20"></a><span id="l15.20"> </span>
<a href="#l15.21"></a><span id="l15.21">     /**</span>
<a href="#l15.22"></a><span id="l15.22">      * Edits the currently selected category using the edit category dialog.</span>
<a href="#l15.23"></a><span id="l15.23">      */</span>
<a href="#l15.24"></a><span id="l15.24">     editCategory: function gCP_editCategory() {</span>
<a href="#l15.25"></a><span id="l15.25">         let list = document.getElementById(&quot;categorieslist&quot;);</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineat">@@ -133,19 +133,19 @@ var gCategoriesPane = {</span>
<a href="#l15.27"></a><span id="l15.27">             // If the pref doesn't exist, don't bail out here.</span>
<a href="#l15.28"></a><span id="l15.28">         }</span>
<a href="#l15.29"></a><span id="l15.29"> </span>
<a href="#l15.30"></a><span id="l15.30">         if (list.selectedItem) {</span>
<a href="#l15.31"></a><span id="l15.31">             window.openDialog(&quot;chrome://calendar/content/preferences/editCategory.xul&quot;,</span>
<a href="#l15.32"></a><span id="l15.32">                               &quot;editCategory&quot;,</span>
<a href="#l15.33"></a><span id="l15.33">                               // Workaround for Bug 1151440 - the HTML color picker won't work</span>
<a href="#l15.34"></a><span id="l15.34">                               // in linux when opened from modal dialog</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineminus">-                              (AppConstants.platform == &quot;linux&quot;) ?</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineminus">-                                &quot;centerscreen,chrome,resizable=no&quot; :</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineminus">-                                &quot;modal,centerscreen,chrome,resizable=no&quot;,</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+                              AppConstants.platform == &quot;linux&quot;</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineplus">+                                  ? &quot;centerscreen,chrome,resizable=no&quot;</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineplus">+                                  : &quot;modal,centerscreen,chrome,resizable=no&quot;,</span>
<a href="#l15.41"></a><span id="l15.41">                               gCategoryList[list.selectedIndex], currentColor, editTitle);</span>
<a href="#l15.42"></a><span id="l15.42">         }</span>
<a href="#l15.43"></a><span id="l15.43">     },</span>
<a href="#l15.44"></a><span id="l15.44"> </span>
<a href="#l15.45"></a><span id="l15.45">     /**</span>
<a href="#l15.46"></a><span id="l15.46">      * Removes the selected category.</span>
<a href="#l15.47"></a><span id="l15.47">      */</span>
<a href="#l15.48"></a><span id="l15.48">     deleteCategory: function gCP_deleteCategory() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/base/content/preferences/editCategory.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/base/content/preferences/editCategory.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -24,19 +24,19 @@ function editCategoryLoad() {</span>
<a href="#l16.4"></a><span id="l16.4">     toggleColor();</span>
<a href="#l16.5"></a><span id="l16.5"> }</span>
<a href="#l16.6"></a><span id="l16.6"> </span>
<a href="#l16.7"></a><span id="l16.7"> /**</span>
<a href="#l16.8"></a><span id="l16.8">  * Handler function to be called when the category dialog is accepted and</span>
<a href="#l16.9"></a><span id="l16.9">  * the opener should further process the selected name and color</span>
<a href="#l16.10"></a><span id="l16.10">  */</span>
<a href="#l16.11"></a><span id="l16.11"> function doOK() {</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-    let color = document.getElementById(&quot;useColor&quot;).checked ?</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-                document.getElementById(&quot;categoryColor&quot;).value :</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineminus">-                null;</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+    let color = document.getElementById(&quot;useColor&quot;).checked</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineplus">+                    ? document.getElementById(&quot;categoryColor&quot;).value</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineplus">+                    : null;</span>
<a href="#l16.18"></a><span id="l16.18"> </span>
<a href="#l16.19"></a><span id="l16.19">     let categoryName = document.getElementById(&quot;categoryName&quot;).value;</span>
<a href="#l16.20"></a><span id="l16.20">     window.opener.gCategoriesPane.saveCategory(categoryName, color);</span>
<a href="#l16.21"></a><span id="l16.21">     return true;</span>
<a href="#l16.22"></a><span id="l16.22"> }</span>
<a href="#l16.23"></a><span id="l16.23"> </span>
<a href="#l16.24"></a><span id="l16.24"> /**</span>
<a href="#l16.25"></a><span id="l16.25">  * Handler function to be called when the category name changed</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-widgets.xml</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-widgets.xml</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -378,18 +378,18 @@</span>
<a href="#l17.4"></a><span id="l17.4">       &lt;/method&gt;</span>
<a href="#l17.5"></a><span id="l17.5"> </span>
<a href="#l17.6"></a><span id="l17.6">       &lt;method name=&quot;setVisible&quot;&gt;</span>
<a href="#l17.7"></a><span id="l17.7">         &lt;parameter name=&quot;aVisible&quot;/&gt;</span>
<a href="#l17.8"></a><span id="l17.8">         &lt;parameter name=&quot;aPushModeCollapsedAttribute&quot;/&gt;</span>
<a href="#l17.9"></a><span id="l17.9">         &lt;parameter name=&quot;aNotifyRefControl&quot;/&gt;</span>
<a href="#l17.10"></a><span id="l17.10">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l17.11"></a><span id="l17.11">             let notifyRefControl = ((aNotifyRefControl == null) || (aNotifyRefControl === true));</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-            let pushModeCollapsedAttribute = ((aPushModeCollapsedAttribute == null)</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineminus">-                                                 || (aPushModeCollapsedAttribute === true));</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+            let pushModeCollapsedAttribute = aPushModeCollapsedAttribute == null ||</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineplus">+                                             aPushModeCollapsedAttribute === true;</span>
<a href="#l17.16"></a><span id="l17.16">             let collapsedModes = [];</span>
<a href="#l17.17"></a><span id="l17.17">             let modeIndex = -1;</span>
<a href="#l17.18"></a><span id="l17.18">             let display = aVisible;</span>
<a href="#l17.19"></a><span id="l17.19">             let collapsedInMode = false;</span>
<a href="#l17.20"></a><span id="l17.20">             if (this.hasAttribute(&quot;collapsedinmodes&quot;)) {</span>
<a href="#l17.21"></a><span id="l17.21">                 collapsedModes = this.getAttribute(&quot;collapsedinmodes&quot;).split(&quot;,&quot;);</span>
<a href="#l17.22"></a><span id="l17.22">                 modeIndex = collapsedModes.indexOf(this.currentMode);</span>
<a href="#l17.23"></a><span id="l17.23">                 collapsedInMode = (modeIndex &gt; -1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/base/modules/calItipUtils.jsm</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/base/modules/calItipUtils.jsm</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -142,18 +142,18 @@ cal.itip = {</span>
<a href="#l18.4"></a><span id="l18.4">         } else { // There is no METHOD in the content-type header (spec violation).</span>
<a href="#l18.5"></a><span id="l18.5">                  // Fall back to using the one from the itipItem's ICS.</span>
<a href="#l18.6"></a><span id="l18.6">             imipMethod = itipItem.receivedMethod;</span>
<a href="#l18.7"></a><span id="l18.7">         }</span>
<a href="#l18.8"></a><span id="l18.8">         cal.LOG(&quot;iTIP method: &quot; + imipMethod);</span>
<a href="#l18.9"></a><span id="l18.9"> </span>
<a href="#l18.10"></a><span id="l18.10">         let isWritableCalendar = function(aCalendar) {</span>
<a href="#l18.11"></a><span id="l18.11">             /* TODO: missing ACL check for existing items (require callback API) */</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-            return (cal.itip.isSchedulingCalendar(aCalendar)</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">-                    &amp;&amp; cal.userCanAddItemsToCalendar(aCalendar));</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineplus">+            return cal.itip.isSchedulingCalendar(aCalendar) &amp;&amp;</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineplus">+                   cal.userCanAddItemsToCalendar(aCalendar);</span>
<a href="#l18.16"></a><span id="l18.16">         };</span>
<a href="#l18.17"></a><span id="l18.17"> </span>
<a href="#l18.18"></a><span id="l18.18">         let writableCalendars = cal.getCalendarManager().getCalendars({}).filter(isWritableCalendar);</span>
<a href="#l18.19"></a><span id="l18.19">         if (writableCalendars.length &gt; 0) {</span>
<a href="#l18.20"></a><span id="l18.20">             let compCal = Components.classes[&quot;@mozilla.org/calendar/calendar;1?type=composite&quot;]</span>
<a href="#l18.21"></a><span id="l18.21">                                     .createInstance(Components.interfaces.calICompositeCalendar);</span>
<a href="#l18.22"></a><span id="l18.22">             writableCalendars.forEach(compCal.addCalendar, compCal);</span>
<a href="#l18.23"></a><span id="l18.23">             itipItem.targetCalendar = compCal;</span>
<a href="#l18.24"></a><span id="l18.24" class="difflineat">@@ -593,18 +593,18 @@ cal.itip = {</span>
<a href="#l18.25"></a><span id="l18.25"> </span>
<a href="#l18.26"></a><span id="l18.26">         let invitedAttendee = cal.isInvitation(aItem) &amp;&amp; cal.getInvitedAttendee(aItem);</span>
<a href="#l18.27"></a><span id="l18.27">         if (invitedAttendee) { // actually is an invitation copy, fix attendee list to send REPLY</span>
<a href="#l18.28"></a><span id="l18.28">             /* We check if the attendee id matches one of of the</span>
<a href="#l18.29"></a><span id="l18.29">              * userAddresses. If they aren't equal, it means that</span>
<a href="#l18.30"></a><span id="l18.30">              * someone is accepting invitations on behalf of an other user. */</span>
<a href="#l18.31"></a><span id="l18.31">             if (aItem.calendar.aclEntry) {</span>
<a href="#l18.32"></a><span id="l18.32">                 let userAddresses = aItem.calendar.aclEntry.getUserAddresses({});</span>
<a href="#l18.33"></a><span id="l18.33" class="difflineminus">-                if (userAddresses.length &gt; 0</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineminus">-                    &amp;&amp; !cal.attendeeMatchesAddresses(invitedAttendee, userAddresses)) {</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineplus">+                if (userAddresses.length &gt; 0 &amp;&amp;</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineplus">+                    !cal.attendeeMatchesAddresses(invitedAttendee, userAddresses)) {</span>
<a href="#l18.37"></a><span id="l18.37">                     invitedAttendee = invitedAttendee.clone();</span>
<a href="#l18.38"></a><span id="l18.38">                     invitedAttendee.setProperty(&quot;SENT-BY&quot;, &quot;mailto:&quot; + userAddresses[0]);</span>
<a href="#l18.39"></a><span id="l18.39">                 }</span>
<a href="#l18.40"></a><span id="l18.40">             }</span>
<a href="#l18.41"></a><span id="l18.41"> </span>
<a href="#l18.42"></a><span id="l18.42">             if (aItem.organizer) {</span>
<a href="#l18.43"></a><span id="l18.43">                 let origInvitedAttendee = (aOriginalItem &amp;&amp; aOriginalItem.getAttendeeById(invitedAttendee.id));</span>
<a href="#l18.44"></a><span id="l18.44"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/base/modules/calUtils.jsm</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/base/modules/calUtils.jsm</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -838,18 +838,18 @@ var cal = {</span>
<a href="#l19.4"></a><span id="l19.4">     removeChildElementsByAttribute: function removeChildElementsByAttribute(aParentNode, aAttribute, aValue) {</span>
<a href="#l19.5"></a><span id="l19.5">         let childNode = aParentNode.lastChild;</span>
<a href="#l19.6"></a><span id="l19.6">         while (childNode) {</span>
<a href="#l19.7"></a><span id="l19.7">             let prevChildNode = childNode.previousSibling;</span>
<a href="#l19.8"></a><span id="l19.8">             if (!aAttribute || aAttribute === undefined) {</span>
<a href="#l19.9"></a><span id="l19.9">                 childNode.remove();</span>
<a href="#l19.10"></a><span id="l19.10">              } else if (!aValue || aValue === undefined) {</span>
<a href="#l19.11"></a><span id="l19.11">                 childNode.remove();</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-            } else if (childNode &amp;&amp; childNode.hasAttribute(aAttribute)</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-                &amp;&amp; childNode.getAttribute(aAttribute) == aValue) {</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+            } else if (childNode &amp;&amp; childNode.hasAttribute(aAttribute) &amp;&amp;</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+                       childNode.getAttribute(aAttribute) == aValue) {</span>
<a href="#l19.16"></a><span id="l19.16">                 childNode.remove();</span>
<a href="#l19.17"></a><span id="l19.17">             }</span>
<a href="#l19.18"></a><span id="l19.18">             childNode = prevChildNode;</span>
<a href="#l19.19"></a><span id="l19.19">         }</span>
<a href="#l19.20"></a><span id="l19.20">     },</span>
<a href="#l19.21"></a><span id="l19.21"> </span>
<a href="#l19.22"></a><span id="l19.22">     /**</span>
<a href="#l19.23"></a><span id="l19.23">      * Returns the most recent calendar window in an application independent way</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/base/src/calFilter.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/base/src/calFilter.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -489,18 +489,18 @@ calFilter.prototype = {</span>
<a href="#l20.4"></a><span id="l20.4">                 result.addDuration(duration);</span>
<a href="#l20.5"></a><span id="l20.5">             }</span>
<a href="#l20.6"></a><span id="l20.6">         } else {</span>
<a href="#l20.7"></a><span id="l20.7">             switch (prop) {</span>
<a href="#l20.8"></a><span id="l20.8">                 case props.FILTER_DATE_ALL:</span>
<a href="#l20.9"></a><span id="l20.9">                     result = null;</span>
<a href="#l20.10"></a><span id="l20.10">                     break;</span>
<a href="#l20.11"></a><span id="l20.11">                 case props.FILTER_DATE_VIEW:</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-                    result = start ? currentView().startDay.clone() :</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineminus">-                                     currentView().endDay.clone();</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineplus">+                    result = start ? currentView().startDay.clone()</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineplus">+                                   : currentView().endDay.clone();</span>
<a href="#l20.16"></a><span id="l20.16">                     break;</span>
<a href="#l20.17"></a><span id="l20.17">                 case props.FILTER_DATE_SELECTED:</span>
<a href="#l20.18"></a><span id="l20.18">                     result = selectedDate.clone();</span>
<a href="#l20.19"></a><span id="l20.19">                     result.isDate = true;</span>
<a href="#l20.20"></a><span id="l20.20">                     break;</span>
<a href="#l20.21"></a><span id="l20.21">                 case props.FILTER_DATE_SELECTED_OR_NOW: {</span>
<a href="#l20.22"></a><span id="l20.22">                     result = selectedDate.clone();</span>
<a href="#l20.23"></a><span id="l20.23">                     let resultJSDate = cal.dateTimeToJsDate(result);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/base/src/calRecurrenceInfo.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/base/src/calRecurrenceInfo.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -324,20 +324,19 @@ calRecurrenceInfo.prototype = {</span>
<a href="#l21.4"></a><span id="l21.4">                     // was found in a previous round, we can go ahead and start</span>
<a href="#l21.5"></a><span id="l21.5">                     // searching from that occurrence.</span>
<a href="#l21.6"></a><span id="l21.6">                     let searchStart = nextOccurrences[i] || startDate;</span>
<a href="#l21.7"></a><span id="l21.7"> </span>
<a href="#l21.8"></a><span id="l21.8">                     // Search for the next occurrence after aTime. If the last</span>
<a href="#l21.9"></a><span id="l21.9">                     // round was invalid, then in this round we need to search</span>
<a href="#l21.10"></a><span id="l21.10">                     // after nextOccurrences[i] to make sure getNextOccurrence()</span>
<a href="#l21.11"></a><span id="l21.11">                     // doesn't find the same occurrence again.</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-                    let searchDate =</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineminus">-                        (nextOccurrences[i] &amp;&amp; nextOccurrences[i].compare(aTime) &gt; 0 ?</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineminus">-                            nextOccurrences[i] :</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineminus">-                            aTime);</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineplus">+                    let searchDate = nextOccurrences[i] &amp;&amp; nextOccurrences[i].compare(aTime) &gt; 0</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineplus">+                        ? nextOccurrences[i]</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineplus">+                        : aTime;</span>
<a href="#l21.19"></a><span id="l21.19"> </span>
<a href="#l21.20"></a><span id="l21.20">                     nextOccurrences[i] = rRuleInstance</span>
<a href="#l21.21"></a><span id="l21.21">                                              .getNextOccurrence(searchStart, searchDate);</span>
<a href="#l21.22"></a><span id="l21.22">                 }</span>
<a href="#l21.23"></a><span id="l21.23"> </span>
<a href="#l21.24"></a><span id="l21.24">                 // As decided in bug 734245, an EXDATE of type DATE shall also match a DTSTART of type DATE-TIME</span>
<a href="#l21.25"></a><span id="l21.25">                 let nextKey = getRidKey(nextOccurrences[i]);</span>
<a href="#l21.26"></a><span id="l21.26">                 let isInExceptionMap = nextKey &amp;&amp; (this.mExceptionMap[nextKey.substring(0, 8)] ||</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/base/src/calUtils.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/base/src/calUtils.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -356,35 +356,35 @@ function userCanRespondToInvitation(aIte</span>
<a href="#l22.4"></a><span id="l22.4">  * Opens the Create Calendar wizard</span>
<a href="#l22.5"></a><span id="l22.5">  *</span>
<a href="#l22.6"></a><span id="l22.6">  * @param aCallback  a function to be performed after calendar creation</span>
<a href="#l22.7"></a><span id="l22.7">  */</span>
<a href="#l22.8"></a><span id="l22.8"> function openCalendarWizard(aCallback) {</span>
<a href="#l22.9"></a><span id="l22.9">     openDialog(&quot;chrome://calendar/content/calendarCreation.xul&quot;, &quot;caEditServer&quot;,</span>
<a href="#l22.10"></a><span id="l22.10">                // Workaround for Bug 1151440 - the HTML color picker won't work</span>
<a href="#l22.11"></a><span id="l22.11">                // in linux when opened from modal dialog</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-               (AppConstants.platform == &quot;linux&quot;) ?</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineminus">-                 &quot;chrome,titlebar,resizable&quot; :</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineminus">-                 &quot;modal,chrome,titlebar,resizable&quot;,</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineplus">+               AppConstants.platform == &quot;linux&quot;</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineplus">+                   ? &quot;chrome,titlebar,resizable&quot;</span>
<a href="#l22.17"></a><span id="l22.17" class="difflineplus">+                   : &quot;modal,chrome,titlebar,resizable&quot;,</span>
<a href="#l22.18"></a><span id="l22.18">                aCallback);</span>
<a href="#l22.19"></a><span id="l22.19"> }</span>
<a href="#l22.20"></a><span id="l22.20"> </span>
<a href="#l22.21"></a><span id="l22.21"> /**</span>
<a href="#l22.22"></a><span id="l22.22">  * Opens the calendar properties window for aCalendar</span>
<a href="#l22.23"></a><span id="l22.23">  *</span>
<a href="#l22.24"></a><span id="l22.24">  * @param aCalendar  the calendar whose properties should be displayed</span>
<a href="#l22.25"></a><span id="l22.25">  */</span>
<a href="#l22.26"></a><span id="l22.26"> function openCalendarProperties(aCalendar) {</span>
<a href="#l22.27"></a><span id="l22.27">     openDialog(&quot;chrome://calendar/content/calendar-properties-dialog.xul&quot;,</span>
<a href="#l22.28"></a><span id="l22.28">                &quot;CalendarPropertiesDialog&quot;,</span>
<a href="#l22.29"></a><span id="l22.29">                // Workaround for Bug 1151440 - the HTML color picker won't work</span>
<a href="#l22.30"></a><span id="l22.30">                // in linux when opened from modal dialog</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-               (AppConstants.platform == &quot;linux&quot;) ?</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineminus">-                 &quot;chrome,titlebar,resizable&quot; :</span>
<a href="#l22.33"></a><span id="l22.33" class="difflineminus">-                 &quot;modal,chrome,titlebar,resizable&quot;,</span>
<a href="#l22.34"></a><span id="l22.34" class="difflineplus">+               AppConstants.platform == &quot;linux&quot;</span>
<a href="#l22.35"></a><span id="l22.35" class="difflineplus">+                   ? &quot;chrome,titlebar,resizable&quot;</span>
<a href="#l22.36"></a><span id="l22.36" class="difflineplus">+                   : &quot;modal,chrome,titlebar,resizable&quot;,</span>
<a href="#l22.37"></a><span id="l22.37">                { calendar: aCalendar });</span>
<a href="#l22.38"></a><span id="l22.38"> }</span>
<a href="#l22.39"></a><span id="l22.39"> </span>
<a href="#l22.40"></a><span id="l22.40"> /**</span>
<a href="#l22.41"></a><span id="l22.41">  * Opens the print dialog</span>
<a href="#l22.42"></a><span id="l22.42">  */</span>
<a href="#l22.43"></a><span id="l22.43"> function calPrint() {</span>
<a href="#l22.44"></a><span id="l22.44">     openDialog(&quot;chrome://calendar/content/calendar-print-dialog.xul&quot;, &quot;Print&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/lightning/content/html-item-editing/react-code.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/lightning/content/html-item-editing/react-code.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -365,26 +365,24 @@ var TopComponent = React.createClass({</span>
<a href="#l23.4"></a><span id="l23.4">             { id: 'repeatDiv', className: 'box' },</span>
<a href="#l23.5"></a><span id="l23.5">             'Repeat ',</span>
<a href="#l23.6"></a><span id="l23.6">             React.createElement(Dropdown, {</span>
<a href="#l23.7"></a><span id="l23.7">                 keyprop: 'repeat',</span>
<a href="#l23.8"></a><span id="l23.8">                 value: this.state.repeat,</span>
<a href="#l23.9"></a><span id="l23.9">                 options: this.props.repeatList,</span>
<a href="#l23.10"></a><span id="l23.10">                 onInput: this.handleSimpleChange</span>
<a href="#l23.11"></a><span id="l23.11">             }),</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-            (this.state.repeat != 'none' ?</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineminus">-                ' Until ' :</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineminus">-                null),</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineplus">+            (this.state.repeat != 'none' ? ' Until ' : null),</span>
<a href="#l23.16"></a><span id="l23.16">             (this.state.repeat!= 'none' ?</span>
<a href="#l23.17"></a><span id="l23.17">                 React.createElement(TextField, {</span>
<a href="#l23.18"></a><span id="l23.18">                     keyprop: 'repeatUntilDate',</span>
<a href="#l23.19"></a><span id="l23.19">                     value: this.state.repeatUntilDate,</span>
<a href="#l23.20"></a><span id="l23.20">                     onInput: this.handleSimpleChange</span>
<a href="#l23.21"></a><span id="l23.21" class="difflineminus">-                }) :</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineminus">-                null)</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineplus">+                })</span>
<a href="#l23.24"></a><span id="l23.24" class="difflineplus">+                : null)</span>
<a href="#l23.25"></a><span id="l23.25">         );</span>
<a href="#l23.26"></a><span id="l23.26">         let calendarDiv = React.DOM.div(</span>
<a href="#l23.27"></a><span id="l23.27">             { id: 'calendarDiv', className: 'box' },</span>
<a href="#l23.28"></a><span id="l23.28">             'Calendar ',</span>
<a href="#l23.29"></a><span id="l23.29">             React.createElement(Dropdown, {</span>
<a href="#l23.30"></a><span id="l23.30">                 keyprop: 'calendarId',</span>
<a href="#l23.31"></a><span id="l23.31">                 value: this.state.calendarId,</span>
<a href="#l23.32"></a><span id="l23.32">                 options: this.props.calendarList,</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineat">@@ -443,18 +441,18 @@ var TopComponent = React.createClass({</span>
<a href="#l23.34"></a><span id="l23.34">         );</span>
<a href="#l23.35"></a><span id="l23.35">         let urlDiv = (this.state.showUrl ?</span>
<a href="#l23.36"></a><span id="l23.36">             React.DOM.div(</span>
<a href="#l23.37"></a><span id="l23.37">             { id: 'urlDiv', className: 'box' },</span>
<a href="#l23.38"></a><span id="l23.38">             'Event link ',</span>
<a href="#l23.39"></a><span id="l23.39">             React.createElement(Link, {</span>
<a href="#l23.40"></a><span id="l23.40">                 value: this.state.url,</span>
<a href="#l23.41"></a><span id="l23.41">                 onInput: this.linkClicked</span>
<a href="#l23.42"></a><span id="l23.42" class="difflineminus">-            })) :</span>
<a href="#l23.43"></a><span id="l23.43" class="difflineminus">-            null</span>
<a href="#l23.44"></a><span id="l23.44" class="difflineplus">+            }))</span>
<a href="#l23.45"></a><span id="l23.45" class="difflineplus">+            : null</span>
<a href="#l23.46"></a><span id="l23.46">         );</span>
<a href="#l23.47"></a><span id="l23.47"> </span>
<a href="#l23.48"></a><span id="l23.48">         let privacyDiv = React.DOM.div(</span>
<a href="#l23.49"></a><span id="l23.49">             { id: 'privacyDiv', className: 'box' },</span>
<a href="#l23.50"></a><span id="l23.50">             'Privacy ',</span>
<a href="#l23.51"></a><span id="l23.51">             React.createElement(Dropdown, {</span>
<a href="#l23.52"></a><span id="l23.52">                 keyprop: 'privacy',</span>
<a href="#l23.53"></a><span id="l23.53">                 value: this.state.privacy,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -448,23 +448,23 @@ function onCommandCancel() {</span>
<a href="#l24.4"></a><span id="l24.4">     if (gInTab &amp;&amp; gTabInfoObject) {</span>
<a href="#l24.5"></a><span id="l24.5">         // Switch to the tab that the prompt refers to.</span>
<a href="#l24.6"></a><span id="l24.6">         gTabmail.switchToTab(gTabInfoObject);</span>
<a href="#l24.7"></a><span id="l24.7">     }</span>
<a href="#l24.8"></a><span id="l24.8"> </span>
<a href="#l24.9"></a><span id="l24.9">     let promptService = Components.interfaces.nsIPromptService;</span>
<a href="#l24.10"></a><span id="l24.10"> </span>
<a href="#l24.11"></a><span id="l24.11">     let promptTitle = cal.calGetString(&quot;calendar&quot;,</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-                                       isEvent(window.calendarItem) ?</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineminus">-                                          &quot;askSaveTitleEvent&quot; :</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineminus">-                                          &quot;askSaveTitleTask&quot;);</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineplus">+                                       isEvent(window.calendarItem)</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineplus">+                                          ? &quot;askSaveTitleEvent&quot;</span>
<a href="#l24.17"></a><span id="l24.17" class="difflineplus">+                                          : &quot;askSaveTitleTask&quot;);</span>
<a href="#l24.18"></a><span id="l24.18">     let promptMessage = cal.calGetString(&quot;calendar&quot;,</span>
<a href="#l24.19"></a><span id="l24.19" class="difflineminus">-                                         isEvent(window.calendarItem) ?</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineminus">-                                            &quot;askSaveMessageEvent&quot; :</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineminus">-                                            &quot;askSaveMessageTask&quot;);</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineplus">+                                         isEvent(window.calendarItem)</span>
<a href="#l24.23"></a><span id="l24.23" class="difflineplus">+                                            ? &quot;askSaveMessageEvent&quot;</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineplus">+                                            : &quot;askSaveMessageTask&quot;);</span>
<a href="#l24.25"></a><span id="l24.25"> </span>
<a href="#l24.26"></a><span id="l24.26">     let flags = promptService.BUTTON_TITLE_SAVE *</span>
<a href="#l24.27"></a><span id="l24.27">                 promptService.BUTTON_POS_0 +</span>
<a href="#l24.28"></a><span id="l24.28">                 promptService.BUTTON_TITLE_CANCEL *</span>
<a href="#l24.29"></a><span id="l24.29">                 promptService.BUTTON_POS_1 +</span>
<a href="#l24.30"></a><span id="l24.30">                 promptService.BUTTON_TITLE_DONT_SAVE *</span>
<a href="#l24.31"></a><span id="l24.31">                 promptService.BUTTON_POS_2;</span>
<a href="#l24.32"></a><span id="l24.32"> </span>
<a href="#l24.33"></a><span id="l24.33" class="difflineat">@@ -1817,17 +1817,17 @@ function editAttendees() {</span>
<a href="#l24.34"></a><span id="l24.34">         gEndTimezone = endTime.timezone;</span>
<a href="#l24.35"></a><span id="l24.35">         gStartTime = startTime.getInTimezone(kDefaultTimezone);</span>
<a href="#l24.36"></a><span id="l24.36">         gEndTime = endTime.getInTimezone(kDefaultTimezone);</span>
<a href="#l24.37"></a><span id="l24.37">         gItemDuration = duration;</span>
<a href="#l24.38"></a><span id="l24.38">         updateAttendees();</span>
<a href="#l24.39"></a><span id="l24.39">         updateDateTime();</span>
<a href="#l24.40"></a><span id="l24.40">         updateAllDay();</span>
<a href="#l24.41"></a><span id="l24.41"> </span>
<a href="#l24.42"></a><span id="l24.42" class="difflineminus">-        if (isAllDay != gStartTime.isDate){</span>
<a href="#l24.43"></a><span id="l24.43" class="difflineplus">+        if (isAllDay != gStartTime.isDate) {</span>
<a href="#l24.44"></a><span id="l24.44">             setShowTimeAs(gStartTime.isDate);</span>
<a href="#l24.45"></a><span id="l24.45">         }</span>
<a href="#l24.46"></a><span id="l24.46">     };</span>
<a href="#l24.47"></a><span id="l24.47"> </span>
<a href="#l24.48"></a><span id="l24.48">     let startTime = gStartTime.getInTimezone(gStartTimezone);</span>
<a href="#l24.49"></a><span id="l24.49">     let endTime = gEndTime.getInTimezone(gEndTimezone);</span>
<a href="#l24.50"></a><span id="l24.50"> </span>
<a href="#l24.51"></a><span id="l24.51">     let isAllDay = getElementValue(&quot;event-all-day&quot;, &quot;checked&quot;);</span>
<a href="#l24.52"></a><span id="l24.52" class="difflineat">@@ -2086,17 +2086,17 @@ function lastDirectory(aFileUri) {</span>
<a href="#l24.53"></a><span id="l24.53"> /**</span>
<a href="#l24.54"></a><span id="l24.54">  * Turns an url into a string that can be used in UI.</span>
<a href="#l24.55"></a><span id="l24.55">  * - For a file:// url, shows the filename.</span>
<a href="#l24.56"></a><span id="l24.56">  * - For a http:// url, removes protocol and trailing slash</span>
<a href="#l24.57"></a><span id="l24.57">  *</span>
<a href="#l24.58"></a><span id="l24.58">  * @param aUri    The uri to parse.</span>
<a href="#l24.59"></a><span id="l24.59">  * @return        A string that can be used in UI.</span>
<a href="#l24.60"></a><span id="l24.60">  */</span>
<a href="#l24.61"></a><span id="l24.61" class="difflineminus">-function makePrettyName(aUri){</span>
<a href="#l24.62"></a><span id="l24.62" class="difflineplus">+function makePrettyName(aUri) {</span>
<a href="#l24.63"></a><span id="l24.63">     let name = aUri.spec;</span>
<a href="#l24.64"></a><span id="l24.64"> </span>
<a href="#l24.65"></a><span id="l24.65">     if (aUri.schemeIs(&quot;file&quot;)) {</span>
<a href="#l24.66"></a><span id="l24.66">         name = aUri.spec.split(&quot;/&quot;).pop();</span>
<a href="#l24.67"></a><span id="l24.67">     } else if (aUri.schemeIs(&quot;http&quot;)) {</span>
<a href="#l24.68"></a><span id="l24.68">         name = aUri.spec.replace(/\/$/, &quot;&quot;).replace(/^http:\/\//, &quot;&quot;);</span>
<a href="#l24.69"></a><span id="l24.69">     }</span>
<a href="#l24.70"></a><span id="l24.70">     return name;</span>
<a href="#l24.71"></a><span id="l24.71" class="difflineat">@@ -2935,18 +2935,18 @@ function saveItem() {</span>
<a href="#l24.72"></a><span id="l24.72">     }</span>
<a href="#l24.73"></a><span id="l24.73"> </span>
<a href="#l24.74"></a><span id="l24.74">     // We check if the organizerID is different from our</span>
<a href="#l24.75"></a><span id="l24.75">     // calendar-user-address-set. The organzerID is the owner of the calendar.</span>
<a href="#l24.76"></a><span id="l24.76">     // If it's different, that is because someone is acting on behalf of</span>
<a href="#l24.77"></a><span id="l24.77">     // the organizer.</span>
<a href="#l24.78"></a><span id="l24.78">     if (item.organizer &amp;&amp; item.calendar.aclEntry) {</span>
<a href="#l24.79"></a><span id="l24.79">         let userAddresses = item.calendar.aclEntry.getUserAddresses({});</span>
<a href="#l24.80"></a><span id="l24.80" class="difflineminus">-        if (userAddresses.length &gt; 0</span>
<a href="#l24.81"></a><span id="l24.81" class="difflineminus">-            &amp;&amp; !cal.attendeeMatchesAddresses(item.organizer, userAddresses)) {</span>
<a href="#l24.82"></a><span id="l24.82" class="difflineplus">+        if (userAddresses.length &gt; 0 &amp;&amp;</span>
<a href="#l24.83"></a><span id="l24.83" class="difflineplus">+            !cal.attendeeMatchesAddresses(item.organizer, userAddresses)) {</span>
<a href="#l24.84"></a><span id="l24.84">             let organizer = item.organizer.clone();</span>
<a href="#l24.85"></a><span id="l24.85">             organizer.setProperty(&quot;SENT-BY&quot;, &quot;mailto:&quot; + userAddresses[0]);</span>
<a href="#l24.86"></a><span id="l24.86">             item.organizer = organizer;</span>
<a href="#l24.87"></a><span id="l24.87">         }</span>
<a href="#l24.88"></a><span id="l24.88">     }</span>
<a href="#l24.89"></a><span id="l24.89">     return item;</span>
<a href="#l24.90"></a><span id="l24.90"> }</span>
<a href="#l24.91"></a><span id="l24.91"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-panel.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-panel.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -157,19 +157,18 @@ window.addEventListener(&quot;message&quot;, recei</span>
<a href="#l25.4"></a><span id="l25.4">  * named in aMessage.command.  If aIframeId is omitted, the message will</span>
<a href="#l25.5"></a><span id="l25.5">  * be sent to the iframe of the current tab.</span>
<a href="#l25.6"></a><span id="l25.6">  *</span>
<a href="#l25.7"></a><span id="l25.7">  * @param {Object} aMessage          Contains the message being sent</span>
<a href="#l25.8"></a><span id="l25.8">  * @param {string} aMessage.command  The name of a function to call</span>
<a href="#l25.9"></a><span id="l25.9">  * @param {string} aIframeId         (optional) id of an iframe to send the message to</span>
<a href="#l25.10"></a><span id="l25.10">  */</span>
<a href="#l25.11"></a><span id="l25.11"> function sendMessage(aMessage, aIframeId) {</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-    let iframeId = gTabmail ?</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">-                   aIframeId || gTabmail.currentTabInfo.iframe.id :</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineminus">-                   &quot;lightning-item-panel-iframe&quot;;</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+    let iframeId = gTabmail ? aIframeId || gTabmail.currentTabInfo.iframe.id</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineplus">+                            : &quot;lightning-item-panel-iframe&quot;;</span>
<a href="#l25.17"></a><span id="l25.17">     let iframe = document.getElementById(iframeId);</span>
<a href="#l25.18"></a><span id="l25.18">     iframe.contentWindow.postMessage(aMessage, &quot;*&quot;);</span>
<a href="#l25.19"></a><span id="l25.19"> }</span>
<a href="#l25.20"></a><span id="l25.20"> </span>
<a href="#l25.21"></a><span id="l25.21"> /**</span>
<a href="#l25.22"></a><span id="l25.22">  * When the user closes the window, this function handles prompting them</span>
<a href="#l25.23"></a><span id="l25.23">  * to save any unsaved changes for any open item tabs, before closing the</span>
<a href="#l25.24"></a><span id="l25.24">  * window, or not if 'cancel' was clicked.  Requires sending and receiving</span>
<a href="#l25.25"></a><span id="l25.25" class="difflineat">@@ -224,19 +223,19 @@ function onLoadLightningItemPanel(aIfram</span>
<a href="#l25.26"></a><span id="l25.26">         iframe = document.getElementById(iframeId);</span>
<a href="#l25.27"></a><span id="l25.27">         iframeSrc = aUrl;</span>
<a href="#l25.28"></a><span id="l25.28"> </span>
<a href="#l25.29"></a><span id="l25.29">         // Add a listener to detect close events, prompt user about saving changes.</span>
<a href="#l25.30"></a><span id="l25.30">         window.addEventListener(&quot;close&quot;, windowCloseListener, false);</span>
<a href="#l25.31"></a><span id="l25.31">     } else {</span>
<a href="#l25.32"></a><span id="l25.32">         // window dialog case</span>
<a href="#l25.33"></a><span id="l25.33">         iframe = document.createElement(&quot;iframe&quot;);</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineminus">-        iframeSrc = window.arguments[0].useNewItemUI ?</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineminus">-            &quot;chrome://lightning/content/html-item-editing/lightning-item-iframe.html&quot; :</span>
<a href="#l25.36"></a><span id="l25.36" class="difflineminus">-            &quot;chrome://lightning/content/lightning-item-iframe.xul&quot;;</span>
<a href="#l25.37"></a><span id="l25.37" class="difflineplus">+        iframeSrc = window.arguments[0].useNewItemUI</span>
<a href="#l25.38"></a><span id="l25.38" class="difflineplus">+            ? &quot;chrome://lightning/content/html-item-editing/lightning-item-iframe.html&quot;</span>
<a href="#l25.39"></a><span id="l25.39" class="difflineplus">+            : &quot;chrome://lightning/content/lightning-item-iframe.xul&quot;;</span>
<a href="#l25.40"></a><span id="l25.40"> </span>
<a href="#l25.41"></a><span id="l25.41">         iframe.setAttribute(&quot;id&quot;, &quot;lightning-item-panel-iframe&quot;);</span>
<a href="#l25.42"></a><span id="l25.42">         iframe.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l25.43"></a><span id="l25.43"> </span>
<a href="#l25.44"></a><span id="l25.44">         let dialog = document.getElementById(&quot;calendar-event-dialog&quot;);</span>
<a href="#l25.45"></a><span id="l25.45">         let statusbar = document.getElementById(&quot;status-bar&quot;);</span>
<a href="#l25.46"></a><span id="l25.46"> </span>
<a href="#l25.47"></a><span id="l25.47">         // Note: iframe.contentWindow is undefined before the iframe is inserted here.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -40,19 +40,19 @@ ltn.invitation = {</span>
<a href="#l26.4"></a><span id="l26.4">                 case &quot;REPLY&quot;: {</span>
<a href="#l26.5"></a><span id="l26.5">                     // This is a reply received from someone else, there should</span>
<a href="#l26.6"></a><span id="l26.6">                     // be just one attendee, the attendee that replied. If</span>
<a href="#l26.7"></a><span id="l26.7">                     // there is more than one attendee, just take the first so</span>
<a href="#l26.8"></a><span id="l26.8">                     // code doesn't break here.</span>
<a href="#l26.9"></a><span id="l26.9">                     let attendees = item.getAttendees({});</span>
<a href="#l26.10"></a><span id="l26.10">                     if (attendees &amp;&amp; attendees.length &gt;= 1) {</span>
<a href="#l26.11"></a><span id="l26.11">                         let sender = attendees[0];</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-                        let statusString = (sender.participationStatus == &quot;DECLINED&quot; ?</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineminus">-                                            &quot;itipReplyBodyDecline&quot; :</span>
<a href="#l26.14"></a><span id="l26.14" class="difflineminus">-                                            &quot;itipReplyBodyAccept&quot;);</span>
<a href="#l26.15"></a><span id="l26.15" class="difflineplus">+                        let statusString = sender.participationStatus == &quot;DECLINED&quot;</span>
<a href="#l26.16"></a><span id="l26.16" class="difflineplus">+                                               ? &quot;itipReplyBodyDecline&quot;</span>
<a href="#l26.17"></a><span id="l26.17" class="difflineplus">+                                               : &quot;itipReplyBodyAccept&quot;;</span>
<a href="#l26.18"></a><span id="l26.18"> </span>
<a href="#l26.19"></a><span id="l26.19">                         header = ltn.getString(&quot;lightning&quot;, statusString, [sender.toString()]);</span>
<a href="#l26.20"></a><span id="l26.20">                     } else {</span>
<a href="#l26.21"></a><span id="l26.21">                         header = &quot;&quot;;</span>
<a href="#l26.22"></a><span id="l26.22">                     }</span>
<a href="#l26.23"></a><span id="l26.23">                     break;</span>
<a href="#l26.24"></a><span id="l26.24">                 }</span>
<a href="#l26.25"></a><span id="l26.25">             }</span>
<a href="#l26.26"></a><span id="l26.26" class="difflineat">@@ -401,18 +401,18 @@ ltn.invitation = {</span>
<a href="#l26.27"></a><span id="l26.27"> </span>
<a href="#l26.28"></a><span id="l26.28">     /**</span>
<a href="#l26.29"></a><span id="l26.29">      * Returns the header section for an invitation email.</span>
<a href="#l26.30"></a><span id="l26.30">      * @param   {String}         aMessageId  the message id to use for that email</span>
<a href="#l26.31"></a><span id="l26.31">      * @param   {nsIMsgIdentity} aIdentity   the identity to use for that email</span>
<a href="#l26.32"></a><span id="l26.32">      * @returns {String}                     the source code of the header section of the email</span>
<a href="#l26.33"></a><span id="l26.33">      */</span>
<a href="#l26.34"></a><span id="l26.34">     getHeaderSection: function(aMessageId, aIdentity, aToList, aSubject) {</span>
<a href="#l26.35"></a><span id="l26.35" class="difflineminus">-        let from = !aIdentity.fullName.length ? aIdentity.email :</span>
<a href="#l26.36"></a><span id="l26.36" class="difflineminus">-                                                cal.validateRecipientList(aIdentity.fullName +</span>
<a href="#l26.37"></a><span id="l26.37" class="difflineplus">+        let from = !aIdentity.fullName.length ? aIdentity.email</span>
<a href="#l26.38"></a><span id="l26.38" class="difflineplus">+                                              : cal.validateRecipientList(aIdentity.fullName +</span>
<a href="#l26.39"></a><span id="l26.39">                                                                           &quot; &lt;&quot; + aIdentity.email + &quot;&gt;&quot;);</span>
<a href="#l26.40"></a><span id="l26.40">         let header = (&quot;MIME-version: 1.0\r\n&quot; +</span>
<a href="#l26.41"></a><span id="l26.41">                       (aIdentity.replyTo ? &quot;Return-path: &quot; +</span>
<a href="#l26.42"></a><span id="l26.42">                                            ltn.invitation.encodeMimeHeader(aIdentity.replyTo, true) +</span>
<a href="#l26.43"></a><span id="l26.43">                                            &quot;\r\n&quot; : &quot;&quot;) +</span>
<a href="#l26.44"></a><span id="l26.44">                       &quot;From: &quot; + ltn.invitation.encodeMimeHeader(from, true) + &quot;\r\n&quot; +</span>
<a href="#l26.45"></a><span id="l26.45">                       (aIdentity.organization ? &quot;Organization: &quot; +</span>
<a href="#l26.46"></a><span id="l26.46">                                                 ltn.invitation.encodeMimeHeader(aIdentity.organization) +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -2406,19 +2406,19 @@ calDavCalendar.prototype = {</span>
<a href="#l27.4"></a><span id="l27.4">             aCalId = this.calendarUserAddress; // continue with calendar-user-address</span>
<a href="#l27.5"></a><span id="l27.5">         }</span>
<a href="#l27.6"></a><span id="l27.6"> </span>
<a href="#l27.7"></a><span id="l27.7">         // the caller prepends MAILTO: to calid strings containing @</span>
<a href="#l27.8"></a><span id="l27.8">         // but apple needs that to be mailto:</span>
<a href="#l27.9"></a><span id="l27.9">         let aCalIdParts = aCalId.split(&quot;:&quot;);</span>
<a href="#l27.10"></a><span id="l27.10">         aCalIdParts[0] = aCalIdParts[0].toLowerCase();</span>
<a href="#l27.11"></a><span id="l27.11"> </span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-        if (aCalIdParts[0] != &quot;mailto&quot;</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineminus">-            &amp;&amp; aCalIdParts[0] != &quot;http&quot;</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineminus">-            &amp;&amp; aCalIdParts[0] != &quot;https&quot;) {</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineplus">+        if (aCalIdParts[0] != &quot;mailto&quot; &amp;&amp;</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineplus">+            aCalIdParts[0] != &quot;http&quot; &amp;&amp;</span>
<a href="#l27.17"></a><span id="l27.17" class="difflineplus">+            aCalIdParts[0] != &quot;https&quot;) {</span>
<a href="#l27.18"></a><span id="l27.18">             aListener.onResult(null, null);</span>
<a href="#l27.19"></a><span id="l27.19">             return;</span>
<a href="#l27.20"></a><span id="l27.20">         }</span>
<a href="#l27.21"></a><span id="l27.21">         let mailto_aCalId = aCalIdParts.join(&quot;:&quot;);</span>
<a href="#l27.22"></a><span id="l27.22"> </span>
<a href="#l27.23"></a><span id="l27.23">         let thisCalendar = this;</span>
<a href="#l27.24"></a><span id="l27.24"> </span>
<a href="#l27.25"></a><span id="l27.25">         let organizer = this.calendarUserAddress;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -851,18 +851,18 @@ calStorageCalendar.prototype = {</span>
<a href="#l28.4"></a><span id="l28.4">             }</span>
<a href="#l28.5"></a><span id="l28.5"> </span>
<a href="#l28.6"></a><span id="l28.6">             // Process the recurring events from the cache</span>
<a href="#l28.7"></a><span id="l28.7">             for (let id in this.mRecEventCache) {</span>
<a href="#l28.8"></a><span id="l28.8">                 let evitem = this.mRecEventCache[id];</span>
<a href="#l28.9"></a><span id="l28.9">                 let offline_journal_flag = this.mRecEventCacheOfflineFlags[evitem.id] || null;</span>
<a href="#l28.10"></a><span id="l28.10">                 // No need to return flagged unless asked i.e. sp.offline_journal == offline_journal_flag</span>
<a href="#l28.11"></a><span id="l28.11">                 // Return created and modified offline records if sp.offline_journal is null alongwith events that have no flag</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-                if ((sp.offline_journal == null &amp;&amp; offline_journal_flag != cICL.OFFLINE_FLAG_DELETED_RECORD)</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineminus">-                    || (sp.offline_journal != null &amp;&amp; offline_journal_flag == sp.offline_journal)) {</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineplus">+                if ((sp.offline_journal == null &amp;&amp; offline_journal_flag != cICL.OFFLINE_FLAG_DELETED_RECORD) ||</span>
<a href="#l28.15"></a><span id="l28.15" class="difflineplus">+                    (sp.offline_journal != null &amp;&amp; offline_journal_flag == sp.offline_journal)) {</span>
<a href="#l28.16"></a><span id="l28.16">                     count += handleResultItem(evitem, Components.interfaces.calIEvent);</span>
<a href="#l28.17"></a><span id="l28.17">                     if (checkCount()) {</span>
<a href="#l28.18"></a><span id="l28.18">                         return;</span>
<a href="#l28.19"></a><span id="l28.19">                     }</span>
<a href="#l28.20"></a><span id="l28.20">                 }</span>
<a href="#l28.21"></a><span id="l28.21">             }</span>
<a href="#l28.22"></a><span id="l28.22">         }</span>
<a href="#l28.23"></a><span id="l28.23"> </span>
<a href="#l28.24"></a><span id="l28.24" class="difflineat">@@ -1262,26 +1262,26 @@ calStorageCalendar.prototype = {</span>
<a href="#l28.25"></a><span id="l28.25">             this.mSelectRelationsForItemWithRecurrenceId = this.mDB.createStatement(</span>
<a href="#l28.26"></a><span id="l28.26">                 &quot;SELECT * FROM cal_relations&quot; +</span>
<a href="#l28.27"></a><span id="l28.27">                 &quot; WHERE item_id = :item_id AND cal_id = :cal_id&quot; +</span>
<a href="#l28.28"></a><span id="l28.28">                 &quot; AND recurrence_id = :recurrence_id&quot; +</span>
<a href="#l28.29"></a><span id="l28.29">                 &quot; AND recurrence_id_tz = :recurrence_id_tz&quot;</span>
<a href="#l28.30"></a><span id="l28.30">                 );</span>
<a href="#l28.31"></a><span id="l28.31"> </span>
<a href="#l28.32"></a><span id="l28.32">             this.mSelectMetaData = this.mDB.createStatement(</span>
<a href="#l28.33"></a><span id="l28.33" class="difflineminus">-                &quot;SELECT * FROM cal_metadata&quot;</span>
<a href="#l28.34"></a><span id="l28.34" class="difflineminus">-                + &quot; WHERE item_id = :item_id AND cal_id = :cal_id&quot;);</span>
<a href="#l28.35"></a><span id="l28.35" class="difflineplus">+                &quot;SELECT * FROM cal_metadata&quot; +</span>
<a href="#l28.36"></a><span id="l28.36" class="difflineplus">+                &quot; WHERE item_id = :item_id AND cal_id = :cal_id&quot;);</span>
<a href="#l28.37"></a><span id="l28.37"> </span>
<a href="#l28.38"></a><span id="l28.38">             this.mSelectAllMetaData = this.mDB.createStatement(</span>
<a href="#l28.39"></a><span id="l28.39" class="difflineminus">-                &quot;SELECT * FROM cal_metadata&quot;</span>
<a href="#l28.40"></a><span id="l28.40" class="difflineminus">-                + &quot; WHERE cal_id = :cal_id&quot;);</span>
<a href="#l28.41"></a><span id="l28.41" class="difflineplus">+                &quot;SELECT * FROM cal_metadata&quot; +</span>
<a href="#l28.42"></a><span id="l28.42" class="difflineplus">+                &quot; WHERE cal_id = :cal_id&quot;);</span>
<a href="#l28.43"></a><span id="l28.43"> </span>
<a href="#l28.44"></a><span id="l28.44">             this.mSelectAlarmsForItem = this.mDB.createStatement(</span>
<a href="#l28.45"></a><span id="l28.45" class="difflineminus">-                &quot;SELECT icalString FROM cal_alarms&quot;</span>
<a href="#l28.46"></a><span id="l28.46" class="difflineminus">-                + &quot; WHERE item_id = :item_id AND cal_id = :cal_id&quot; +</span>
<a href="#l28.47"></a><span id="l28.47" class="difflineplus">+                &quot;SELECT icalString FROM cal_alarms&quot; +</span>
<a href="#l28.48"></a><span id="l28.48" class="difflineplus">+                &quot; WHERE item_id = :item_id AND cal_id = :cal_id&quot; +</span>
<a href="#l28.49"></a><span id="l28.49">                 &quot; AND recurrence_id IS NULL&quot;</span>
<a href="#l28.50"></a><span id="l28.50">                 );</span>
<a href="#l28.51"></a><span id="l28.51"> </span>
<a href="#l28.52"></a><span id="l28.52">             this.mSelectAlarmsForItemWithRecurrenceId = this.mDB.createStatement(</span>
<a href="#l28.53"></a><span id="l28.53">                 &quot;SELECT icalString FROM cal_alarms&quot; +</span>
<a href="#l28.54"></a><span id="l28.54">                 &quot; WHERE item_id = :item_id AND cal_id = :cal_id&quot; +</span>
<a href="#l28.55"></a><span id="l28.55">                 &quot; AND recurrence_id = :recurrence_id&quot; +</span>
<a href="#l28.56"></a><span id="l28.56">                 &quot; AND recurrence_id_tz = :recurrence_id_tz&quot;</span>
<a href="#l28.57"></a><span id="l28.57" class="difflineat">@@ -1336,19 +1336,19 @@ calStorageCalendar.prototype = {</span>
<a href="#l28.58"></a><span id="l28.58"> </span>
<a href="#l28.59"></a><span id="l28.59">             this.mInsertRelation = this.mDB.createStatement(</span>
<a href="#l28.60"></a><span id="l28.60">                 &quot;INSERT INTO cal_relations &quot; +</span>
<a href="#l28.61"></a><span id="l28.61">                 &quot; (cal_id, item_id, icalString, recurrence_id, recurrence_id_tz) &quot; +</span>
<a href="#l28.62"></a><span id="l28.62">                 &quot;VALUES (:cal_id, :item_id, :icalString, :recurrence_id, :recurrence_id_tz)&quot;</span>
<a href="#l28.63"></a><span id="l28.63">                 );</span>
<a href="#l28.64"></a><span id="l28.64"> </span>
<a href="#l28.65"></a><span id="l28.65">             this.mInsertMetaData = this.mDB.createStatement(</span>
<a href="#l28.66"></a><span id="l28.66" class="difflineminus">-                &quot;INSERT INTO cal_metadata&quot;</span>
<a href="#l28.67"></a><span id="l28.67" class="difflineminus">-                + &quot; (cal_id, item_id, value)&quot;</span>
<a href="#l28.68"></a><span id="l28.68" class="difflineminus">-                + &quot; VALUES (:cal_id, :item_id, :value)&quot;);</span>
<a href="#l28.69"></a><span id="l28.69" class="difflineplus">+                &quot;INSERT INTO cal_metadata&quot; +</span>
<a href="#l28.70"></a><span id="l28.70" class="difflineplus">+                &quot; (cal_id, item_id, value)&quot; +</span>
<a href="#l28.71"></a><span id="l28.71" class="difflineplus">+                &quot; VALUES (:cal_id, :item_id, :value)&quot;);</span>
<a href="#l28.72"></a><span id="l28.72"> </span>
<a href="#l28.73"></a><span id="l28.73">             this.mInsertAlarm = this.mDB.createStatement(</span>
<a href="#l28.74"></a><span id="l28.74">                 &quot;INSERT INTO cal_alarms &quot; +</span>
<a href="#l28.75"></a><span id="l28.75">                 &quot;  (cal_id, item_id, icalString, recurrence_id, recurrence_id_tz) &quot; +</span>
<a href="#l28.76"></a><span id="l28.76">                 &quot;VALUES  (:cal_id, :item_id, :icalString, :recurrence_id, :recurrence_id_tz)  &quot;</span>
<a href="#l28.77"></a><span id="l28.77">                 );</span>
<a href="#l28.78"></a><span id="l28.78">             // Offline Operations</span>
<a href="#l28.79"></a><span id="l28.79">             this.mEditEventOfflineFlag = this.mDB.createStatement(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -361,18 +361,18 @@ function calWcapCalendar_storeItem(bAddI</span>
<a href="#l29.4"></a><span id="l29.4">         // So in these cases: write all data of master.</span>
<a href="#l29.5"></a><span id="l29.5"> </span>
<a href="#l29.6"></a><span id="l29.6">         let bIsAllDay = false;</span>
<a href="#l29.7"></a><span id="l29.7">         let dtstart, dtend;</span>
<a href="#l29.8"></a><span id="l29.8">         if (bIsEvent) {</span>
<a href="#l29.9"></a><span id="l29.9">             dtstart = item.startDate;</span>
<a href="#l29.10"></a><span id="l29.10">             dtend = item.endDate;</span>
<a href="#l29.11"></a><span id="l29.11">             bIsAllDay = (dtstart.isDate &amp;&amp; dtend.isDate);</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-            if (!oldItem || !identicalDatetimes(dtstart, oldItem.startDate)</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineminus">-                         || !identicalDatetimes(dtend, oldItem.endDate)) {</span>
<a href="#l29.14"></a><span id="l29.14" class="difflineplus">+            if (!oldItem || !identicalDatetimes(dtstart, oldItem.startDate) ||</span>
<a href="#l29.15"></a><span id="l29.15" class="difflineplus">+                !identicalDatetimes(dtend, oldItem.endDate)) {</span>
<a href="#l29.16"></a><span id="l29.16">                 params += (&quot;&amp;dtstart=&quot; + getIcalUTC(dtstart)); // timezone will be set with tzid param</span>
<a href="#l29.17"></a><span id="l29.17">                 params += (&quot;&amp;dtend=&quot; + getIcalUTC(dtend));</span>
<a href="#l29.18"></a><span id="l29.18">                 params += (bIsAllDay ? &quot;&amp;isAllDay=1&quot; : &quot;&amp;isAllDay=0&quot;);</span>
<a href="#l29.19"></a><span id="l29.19"> </span>
<a href="#l29.20"></a><span id="l29.20">                 if (bIsParent &amp;&amp; item.recurrenceInfo) {</span>
<a href="#l29.21"></a><span id="l29.21">                     oldItem = null; // recurrence/exceptions hack: write whole master</span>
<a href="#l29.22"></a><span id="l29.22">                 }</span>
<a href="#l29.23"></a><span id="l29.23">             }</span>
<a href="#l29.24"></a><span id="l29.24" class="difflineat">@@ -383,18 +383,18 @@ function calWcapCalendar_storeItem(bAddI</span>
<a href="#l29.25"></a><span id="l29.25">             dtend = item.dueDate;</span>
<a href="#l29.26"></a><span id="l29.26"> </span>
<a href="#l29.27"></a><span id="l29.27">             // cs bug: enforce DUE (set to DTSTART) if alarm is set</span>
<a href="#l29.28"></a><span id="l29.28">             if (!dtend &amp;&amp; item.getAlarms({}).length) {</span>
<a href="#l29.29"></a><span id="l29.29">                 dtend = dtstart;</span>
<a href="#l29.30"></a><span id="l29.30">             }</span>
<a href="#l29.31"></a><span id="l29.31"> </span>
<a href="#l29.32"></a><span id="l29.32">             bIsAllDay = (dtstart &amp;&amp; dtstart.isDate);</span>
<a href="#l29.33"></a><span id="l29.33" class="difflineminus">-            if (!oldItem || !identicalDatetimes(dtstart, oldItem.entryDate)</span>
<a href="#l29.34"></a><span id="l29.34" class="difflineminus">-                         || !identicalDatetimes(dtend, oldItem.dueDate)) {</span>
<a href="#l29.35"></a><span id="l29.35" class="difflineplus">+            if (!oldItem || !identicalDatetimes(dtstart, oldItem.entryDate) ||</span>
<a href="#l29.36"></a><span id="l29.36" class="difflineplus">+                !identicalDatetimes(dtend, oldItem.dueDate)) {</span>
<a href="#l29.37"></a><span id="l29.37">                 params += (&quot;&amp;dtstart=&quot; + getIcalUTC(dtstart)); // timezone will be set with tzid param</span>
<a href="#l29.38"></a><span id="l29.38">                 params += (&quot;&amp;due=&quot; + getIcalUTC(dtend)); // timezone will be set with tzid param</span>
<a href="#l29.39"></a><span id="l29.39">                 params += (bIsAllDay ? &quot;&amp;isAllDay=1&quot; : &quot;&amp;isAllDay=0&quot;);</span>
<a href="#l29.40"></a><span id="l29.40"> </span>
<a href="#l29.41"></a><span id="l29.41">                 if (bIsParent &amp;&amp; item.recurrenceInfo) {</span>
<a href="#l29.42"></a><span id="l29.42">                     oldItem = null; // recurrence/exceptions hack: write whole master</span>
<a href="#l29.43"></a><span id="l29.43">                 }</span>
<a href="#l29.44"></a><span id="l29.44">             }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -1895,19 +1895,19 @@</span>
<a href="#l30.4"></a><span id="l30.4">                   } else {</span>
<a href="#l30.5"></a><span id="l30.5">                     // check if need to append previous character,</span>
<a href="#l30.6"></a><span id="l30.6">                     // captured by the optional separator pattern after seconds digits,</span>
<a href="#l30.7"></a><span id="l30.7">                     // or after minutes if no seconds, or after hours if no minutes.</span>
<a href="#l30.8"></a><span id="l30.8">                     for (let k = SEC_INDEX; k &gt;= HR_INDEX; k -= 2) {</span>
<a href="#l30.9"></a><span id="l30.9">                       let nextSepI = k + 1;</span>
<a href="#l30.10"></a><span id="l30.10">                       let nextDigitsI = k + 2;</span>
<a href="#l30.11"></a><span id="l30.11">                       if ((k == SEC_INDEX ||</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-                           (!amProbeArray[nextDigitsI] &amp;&amp; !pmProbeArray[nextDigitsI]))</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineminus">-                          &amp;&amp; amProbeArray[nextSepI] &amp;&amp; pmProbeArray[nextSepI]</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineminus">-                          &amp;&amp; amProbeArray[nextSepI] != pmProbeArray[nextSepI]) {</span>
<a href="#l30.15"></a><span id="l30.15" class="difflineplus">+                           (!amProbeArray[nextDigitsI] &amp;&amp; !pmProbeArray[nextDigitsI])) &amp;&amp;</span>
<a href="#l30.16"></a><span id="l30.16" class="difflineplus">+                          amProbeArray[nextSepI] &amp;&amp; pmProbeArray[nextSepI] &amp;&amp;</span>
<a href="#l30.17"></a><span id="l30.17" class="difflineplus">+                          amProbeArray[nextSepI] != pmProbeArray[nextSepI]) {</span>
<a href="#l30.18"></a><span id="l30.18">                         amProbeArray[POST_INDEX] =</span>
<a href="#l30.19"></a><span id="l30.19">                           amProbeArray[nextSepI] + amProbeArray[POST_INDEX];</span>
<a href="#l30.20"></a><span id="l30.20">                         pmProbeArray[POST_INDEX] =</span>
<a href="#l30.21"></a><span id="l30.21">                           pmProbeArray[nextSepI] + pmProbeArray[POST_INDEX];</span>
<a href="#l30.22"></a><span id="l30.22">                         this.ampmIndex = POST_INDEX;</span>
<a href="#l30.23"></a><span id="l30.23">                         break;</span>
<a href="#l30.24"></a><span id="l30.24">                       }</span>
<a href="#l30.25"></a><span id="l30.25">                     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testEventDialog.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testEventDialog.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -16,51 +16,51 @@ var url = &quot;http://mozilla.org&quot;;</span>
<a href="#l31.4"></a><span id="l31.4"> </span>
<a href="#l31.5"></a><span id="l31.5"> var setupModule = function(module) {</span>
<a href="#l31.6"></a><span id="l31.6">   controller = mozmill.getMail3PaneController();</span>
<a href="#l31.7"></a><span id="l31.7">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l31.8"></a><span id="l31.8"> };</span>
<a href="#l31.9"></a><span id="l31.9"> </span>
<a href="#l31.10"></a><span id="l31.10"> var testEventDialog = function() {</span>
<a href="#l31.11"></a><span id="l31.11">   // paths</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-  let monthView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/'</span>
<a href="#l31.14"></a><span id="l31.14" class="difflineminus">-    + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;month-view&quot;)/';</span>
<a href="#l31.15"></a><span id="l31.15" class="difflineminus">-  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l31.16"></a><span id="l31.16" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l31.17"></a><span id="l31.17" class="difflineminus">-    + 'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l31.18"></a><span id="l31.18" class="difflineplus">+  let monthView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l31.19"></a><span id="l31.19" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/' +</span>
<a href="#l31.20"></a><span id="l31.20" class="difflineplus">+    'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;month-view&quot;)/';</span>
<a href="#l31.21"></a><span id="l31.21" class="difflineplus">+  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l31.22"></a><span id="l31.22" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/' +</span>
<a href="#l31.23"></a><span id="l31.23" class="difflineplus">+    'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l31.24"></a><span id="l31.24">   let eventDialog = '/id(&quot;calendar-event-dialog&quot;)/id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/';</span>
<a href="#l31.25"></a><span id="l31.25"> </span>
<a href="#l31.26"></a><span id="l31.26" class="difflineminus">-  let eventBox = monthView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/'</span>
<a href="#l31.27"></a><span id="l31.27" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[rowNumber]/[columnNumber]/'</span>
<a href="#l31.28"></a><span id="l31.28" class="difflineminus">-    + '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}/anon({&quot;flex&quot;:&quot;1&quot;})/'</span>
<a href="#l31.29"></a><span id="l31.29" class="difflineminus">-    + '[0]/anon({&quot;anonid&quot;:&quot;event-container&quot;})/{&quot;class&quot;:&quot;calendar-event-selection&quot;}/'</span>
<a href="#l31.30"></a><span id="l31.30" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;eventbox&quot;})/{&quot;class&quot;:&quot;calendar-event-details&quot;}';</span>
<a href="#l31.31"></a><span id="l31.31" class="difflineplus">+  let eventBox = monthView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/' +</span>
<a href="#l31.32"></a><span id="l31.32" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[rowNumber]/[columnNumber]/' +</span>
<a href="#l31.33"></a><span id="l31.33" class="difflineplus">+    '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}/anon({&quot;flex&quot;:&quot;1&quot;})/' +</span>
<a href="#l31.34"></a><span id="l31.34" class="difflineplus">+    '[0]/anon({&quot;anonid&quot;:&quot;event-container&quot;})/{&quot;class&quot;:&quot;calendar-event-selection&quot;}/' +</span>
<a href="#l31.35"></a><span id="l31.35" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;eventbox&quot;})/{&quot;class&quot;:&quot;calendar-event-details&quot;}';</span>
<a href="#l31.36"></a><span id="l31.36"> </span>
<a href="#l31.37"></a><span id="l31.37">   // open month view</span>
<a href="#l31.38"></a><span id="l31.38">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l31.39"></a><span id="l31.39">   controller.waitThenClick(new elementslib.ID(controller.window.document, &quot;calendar-month-view-button&quot;));</span>
<a href="#l31.40"></a><span id="l31.40"> </span>
<a href="#l31.41"></a><span id="l31.41">   // pick year</span>
<a href="#l31.42"></a><span id="l31.42" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l31.43"></a><span id="l31.43" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l31.44"></a><span id="l31.44" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l31.45"></a><span id="l31.45" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l31.46"></a><span id="l31.46" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;2009&quot;}'));</span>
<a href="#l31.47"></a><span id="l31.47" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l31.48"></a><span id="l31.48" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l31.49"></a><span id="l31.49" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l31.50"></a><span id="l31.50" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l31.51"></a><span id="l31.51" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;2009&quot;}'));</span>
<a href="#l31.52"></a><span id="l31.52"> </span>
<a href="#l31.53"></a><span id="l31.53">   // pick month</span>
<a href="#l31.54"></a><span id="l31.54" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l31.55"></a><span id="l31.55" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})'));</span>
<a href="#l31.56"></a><span id="l31.56" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l31.57"></a><span id="l31.57" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l31.58"></a><span id="l31.58" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;0&quot;}'));</span>
<a href="#l31.59"></a><span id="l31.59" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l31.60"></a><span id="l31.60" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})'));</span>
<a href="#l31.61"></a><span id="l31.61" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l31.62"></a><span id="l31.62" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l31.63"></a><span id="l31.63" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;0&quot;}'));</span>
<a href="#l31.64"></a><span id="l31.64"> </span>
<a href="#l31.65"></a><span id="l31.65">   // pick day</span>
<a href="#l31.66"></a><span id="l31.66" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l31.67"></a><span id="l31.67" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l31.68"></a><span id="l31.68" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l31.69"></a><span id="l31.69" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l31.70"></a><span id="l31.70">   controller.sleep(sleep);</span>
<a href="#l31.71"></a><span id="l31.71"> </span>
<a href="#l31.72"></a><span id="l31.72">   // create new event</span>
<a href="#l31.73"></a><span id="l31.73">   controller.mainMenu.click(&quot;#ltnNewEvent&quot;);</span>
<a href="#l31.74"></a><span id="l31.74">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l31.75"></a><span id="l31.75">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l31.76"></a><span id="l31.76"> </span>
<a href="#l31.77"></a><span id="l31.77">   // check that the start time is correct</span>
<a href="#l31.78"></a><span id="l31.78" class="difflineat">@@ -74,41 +74,41 @@ var testEventDialog = function() {</span>
<a href="#l31.79"></a><span id="l31.79">     startHour = startHour % 12;</span>
<a href="#l31.80"></a><span id="l31.80">     if (startHour == 0) {</span>
<a href="#l31.81"></a><span id="l31.81">       startHour = 12;</span>
<a href="#l31.82"></a><span id="l31.82">     }</span>
<a href="#l31.83"></a><span id="l31.83">   }</span>
<a href="#l31.84"></a><span id="l31.84"> </span>
<a href="#l31.85"></a><span id="l31.85">   let startTime = startHour + ':00' + ampm;</span>
<a href="#l31.86"></a><span id="l31.86">   let endTime = ((startHour + 1) % 24) + ':00' + ampm;</span>
<a href="#l31.87"></a><span id="l31.87" class="difflineminus">-  let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l31.88"></a><span id="l31.88" class="difflineminus">-    + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l31.89"></a><span id="l31.89" class="difflineminus">-    + 'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/'</span>
<a href="#l31.90"></a><span id="l31.90" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/id(&quot;timepicker-text&quot;)/'</span>
<a href="#l31.91"></a><span id="l31.91" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'</span>
<a href="#l31.92"></a><span id="l31.92" class="difflineplus">+  let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l31.93"></a><span id="l31.93" class="difflineplus">+    'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l31.94"></a><span id="l31.94" class="difflineplus">+    'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/' +</span>
<a href="#l31.95"></a><span id="l31.95" class="difflineplus">+    'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/id(&quot;timepicker-text&quot;)/' +</span>
<a href="#l31.96"></a><span id="l31.96" class="difflineplus">+    'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'</span>
<a href="#l31.97"></a><span id="l31.97">     );</span>
<a href="#l31.98"></a><span id="l31.98">   event.waitForElement(startTimeInput);</span>
<a href="#l31.99"></a><span id="l31.99">   event.assertValue(startTimeInput, startTime);</span>
<a href="#l31.100"></a><span id="l31.100"> </span>
<a href="#l31.101"></a><span id="l31.101">   // check selected calendar</span>
<a href="#l31.102"></a><span id="l31.102" class="difflineminus">-  event.assertNode(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l31.103"></a><span id="l31.103" class="difflineminus">-    + 'id(&quot;event-grid-category-color-row&quot;)/id(&quot;event-grid-category-box&quot;)/id(&quot;item-calendar&quot;)/[0]/'</span>
<a href="#l31.104"></a><span id="l31.104" class="difflineminus">-    + '{&quot;selected&quot;:&quot;true&quot;,&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l31.105"></a><span id="l31.105" class="difflineplus">+  event.assertNode(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l31.106"></a><span id="l31.106" class="difflineplus">+    'id(&quot;event-grid-category-color-row&quot;)/id(&quot;event-grid-category-box&quot;)/id(&quot;item-calendar&quot;)/[0]/' +</span>
<a href="#l31.107"></a><span id="l31.107" class="difflineplus">+    '{&quot;selected&quot;:&quot;true&quot;,&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l31.108"></a><span id="l31.108"> </span>
<a href="#l31.109"></a><span id="l31.109">   // fill in name, location, description</span>
<a href="#l31.110"></a><span id="l31.110" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l31.111"></a><span id="l31.111" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l31.112"></a><span id="l31.112" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l31.113"></a><span id="l31.113" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l31.114"></a><span id="l31.114" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l31.115"></a><span id="l31.115" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l31.116"></a><span id="l31.116">     title);</span>
<a href="#l31.117"></a><span id="l31.117" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l31.118"></a><span id="l31.118" class="difflineminus">-    + 'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l31.119"></a><span id="l31.119" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'), location);</span>
<a href="#l31.120"></a><span id="l31.120" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l31.121"></a><span id="l31.121" class="difflineminus">-    + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l31.122"></a><span id="l31.122" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l31.123"></a><span id="l31.123" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l31.124"></a><span id="l31.124" class="difflineplus">+    'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l31.125"></a><span id="l31.125" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'), location);</span>
<a href="#l31.126"></a><span id="l31.126" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l31.127"></a><span id="l31.127" class="difflineplus">+    'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l31.128"></a><span id="l31.128" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l31.129"></a><span id="l31.129">     desc);</span>
<a href="#l31.130"></a><span id="l31.130"> </span>
<a href="#l31.131"></a><span id="l31.131">   // set category</span>
<a href="#l31.132"></a><span id="l31.132">   let categories = utils.getProperty(&quot;chrome://calendar/locale/categories.properties&quot;, &quot;categories2&quot;);</span>
<a href="#l31.133"></a><span id="l31.133">   let category = categories.split(',')[4]; // pick 4th value in a comma-separated list</span>
<a href="#l31.134"></a><span id="l31.134">   event.select(new elementslib.ID(event.window.document, &quot;item-categories&quot;), null, category);</span>
<a href="#l31.135"></a><span id="l31.135"> </span>
<a href="#l31.136"></a><span id="l31.136">   // repeat daily</span>
<a href="#l31.137"></a><span id="l31.137" class="difflineat">@@ -128,29 +128,29 @@ var testEventDialog = function() {</span>
<a href="#l31.138"></a><span id="l31.138">   event.click(new elementslib.ID(event.window.document, &quot;button-privacy&quot;));</span>
<a href="#l31.139"></a><span id="l31.139">   event.click(new elementslib.ID(event.window.document, &quot;event-privacy-private-menuitem&quot;));</span>
<a href="#l31.140"></a><span id="l31.140">   let label = (new elementslib.ID(event.window.document, &quot;status-privacy-private-box&quot;));</span>
<a href="#l31.141"></a><span id="l31.141">   event.assertJS(event.window.getComputedStyle(label.getNode(), null).getPropertyValue(&quot;visibility&quot;) == &quot;visible&quot;);</span>
<a href="#l31.142"></a><span id="l31.142"> </span>
<a href="#l31.143"></a><span id="l31.143">   // add attachment and verify added</span>
<a href="#l31.144"></a><span id="l31.144">   calUtils.handleAddingAttachment(event, url);</span>
<a href="#l31.145"></a><span id="l31.145">   event.click(new elementslib.ID(event.window.document, &quot;button-url&quot;));</span>
<a href="#l31.146"></a><span id="l31.146" class="difflineminus">-  event.assertNode(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l31.147"></a><span id="l31.147" class="difflineminus">-    + 'id(&quot;event-grid-attachment-row&quot;)/id(&quot;attachment-link&quot;)/{&quot;label&quot;:&quot;mozilla.org&quot;}'));</span>
<a href="#l31.148"></a><span id="l31.148" class="difflineplus">+  event.assertNode(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l31.149"></a><span id="l31.149" class="difflineplus">+    'id(&quot;event-grid-attachment-row&quot;)/id(&quot;attachment-link&quot;)/{&quot;label&quot;:&quot;mozilla.org&quot;}'));</span>
<a href="#l31.150"></a><span id="l31.150"> </span>
<a href="#l31.151"></a><span id="l31.151">   // save</span>
<a href="#l31.152"></a><span id="l31.152">   calUtils.acceptSendingNotificationMail(event);</span>
<a href="#l31.153"></a><span id="l31.153">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l31.154"></a><span id="l31.154"> </span>
<a href="#l31.155"></a><span id="l31.155">   // catch and dismiss alarm</span>
<a href="#l31.156"></a><span id="l31.156">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:AlarmWindow&quot;).length &gt; 0;}, sleep);</span>
<a href="#l31.157"></a><span id="l31.157">   let alarm = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:AlarmWindow&quot;)[0]);</span>
<a href="#l31.158"></a><span id="l31.158">   // dismiss all button, label in .dtd file, bug #504635</span>
<a href="#l31.159"></a><span id="l31.159" class="difflineminus">-  alarm.waitThenClick(new elementslib.Lookup(alarm.window.document, '/id(&quot;calendar-alarm-dialog&quot;)/'</span>
<a href="#l31.160"></a><span id="l31.160" class="difflineminus">-    + 'id(&quot;alarm-actionbar&quot;)/[1]'));</span>
<a href="#l31.161"></a><span id="l31.161" class="difflineplus">+  alarm.waitThenClick(new elementslib.Lookup(alarm.window.document, '/id(&quot;calendar-alarm-dialog&quot;)/' +</span>
<a href="#l31.162"></a><span id="l31.162" class="difflineplus">+    'id(&quot;alarm-actionbar&quot;)/[1]'));</span>
<a href="#l31.163"></a><span id="l31.163">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:AlarmWindow&quot;).length == 0;}, sleep);</span>
<a href="#l31.164"></a><span id="l31.164"> </span>
<a href="#l31.165"></a><span id="l31.165">   // verify event and alarm icon visible every day of the month and check tooltip</span>
<a href="#l31.166"></a><span id="l31.166">   // 1st January is Thursday so there's three days to check in the first row</span>
<a href="#l31.167"></a><span id="l31.167">   controller.assertNode(new elementslib.Lookup(controller.window.document,</span>
<a href="#l31.168"></a><span id="l31.168">     eventBox.replace(&quot;rowNumber&quot;, &quot;0&quot;).replace(&quot;columnNumber&quot;, &quot;4&quot;)));</span>
<a href="#l31.169"></a><span id="l31.169">   checkIcon(eventBox, &quot;0&quot;, &quot;4&quot;);</span>
<a href="#l31.170"></a><span id="l31.170">   checkTooltip(monthView, &quot;0&quot;, &quot;4&quot;, &quot;1&quot;, startTime, endTime);</span>
<a href="#l31.171"></a><span id="l31.171" class="difflineat">@@ -219,50 +219,50 @@ var testEventDialog = function() {</span>
<a href="#l31.172"></a><span id="l31.172">         controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document,</span>
<a href="#l31.173"></a><span id="l31.173">           eventBox.replace(&quot;rowNumber&quot;, row).replace(&quot;columnNumber&quot;, col)));</span>
<a href="#l31.174"></a><span id="l31.174">     }</span>
<a href="#l31.175"></a><span id="l31.175">   }</span>
<a href="#l31.176"></a><span id="l31.176"> };</span>
<a href="#l31.177"></a><span id="l31.177"> </span>
<a href="#l31.178"></a><span id="l31.178"> function handleAttendees(attendees) {</span>
<a href="#l31.179"></a><span id="l31.179">   let input = new elementslib.Lookup(attendees.window.document,</span>
<a href="#l31.180"></a><span id="l31.180" class="difflineminus">-    '/id(&quot;calendar-event-dialog-attendees-v2&quot;)/[6]/[0]/id(&quot;attendees-list&quot;)/'</span>
<a href="#l31.181"></a><span id="l31.181" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;listbox&quot;})/[1]/[1]/anon({&quot;anonid&quot;:&quot;input&quot;})/'</span>
<a href="#l31.182"></a><span id="l31.182" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;autocomplete-textbox-container&quot;})/'</span>
<a href="#l31.183"></a><span id="l31.183" class="difflineminus">-    + '{&quot;class&quot;:&quot;textbox-input-box&quot;}/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l31.184"></a><span id="l31.184" class="difflineplus">+    '/id(&quot;calendar-event-dialog-attendees-v2&quot;)/[6]/[0]/id(&quot;attendees-list&quot;)/' +</span>
<a href="#l31.185"></a><span id="l31.185" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;listbox&quot;})/[1]/[1]/anon({&quot;anonid&quot;:&quot;input&quot;})/' +</span>
<a href="#l31.186"></a><span id="l31.186" class="difflineplus">+    'anon({&quot;class&quot;:&quot;autocomplete-textbox-container&quot;})/' +</span>
<a href="#l31.187"></a><span id="l31.187" class="difflineplus">+    '{&quot;class&quot;:&quot;textbox-input-box&quot;}/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l31.188"></a><span id="l31.188">   attendees.waitForElement(input);</span>
<a href="#l31.189"></a><span id="l31.189">   attendees.type(input, attendee);</span>
<a href="#l31.190"></a><span id="l31.190">   attendees.click(new elementslib.Lookup(attendees.window.document,</span>
<a href="#l31.191"></a><span id="l31.191">     '/id(&quot;calendar-event-dialog-attendees-v2&quot;)/anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l31.192"></a><span id="l31.192"> }</span>
<a href="#l31.193"></a><span id="l31.193"> </span>
<a href="#l31.194"></a><span id="l31.194"> function checkIcon(eventBox, row, col) {</span>
<a href="#l31.195"></a><span id="l31.195">   let icon = new elementslib.Lookup(controller.window.document,</span>
<a href="#l31.196"></a><span id="l31.196">     (eventBox + '/anon({&quot;anonid&quot;:&quot;category-box-stack&quot;})/anon({&quot;align&quot;: &quot;right&quot;})/anon({&quot;class&quot;:&quot;alarm-icons-box&quot;})/anon({&quot;class&quot;: &quot;reminder-icon&quot;})')</span>
<a href="#l31.197"></a><span id="l31.197">     .replace(&quot;rowNumber&quot;, row).replace(&quot;columnNumber&quot;, col));</span>
<a href="#l31.198"></a><span id="l31.198">   controller.assertJS(icon.getNode().getAttribute(&quot;value&quot;) == &quot;DISPLAY&quot;);</span>
<a href="#l31.199"></a><span id="l31.199"> }</span>
<a href="#l31.200"></a><span id="l31.200"> </span>
<a href="#l31.201"></a><span id="l31.201"> function checkTooltip(monthView, row, col, date, startTime, endTime) {</span>
<a href="#l31.202"></a><span id="l31.202" class="difflineminus">-  let mouseOverItem = monthView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/'</span>
<a href="#l31.203"></a><span id="l31.203" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[rowNumber]/[columnNumber]/'</span>
<a href="#l31.204"></a><span id="l31.204" class="difflineminus">-    + '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l31.205"></a><span id="l31.205" class="difflineplus">+  let mouseOverItem = monthView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/' +</span>
<a href="#l31.206"></a><span id="l31.206" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[rowNumber]/[columnNumber]/' +</span>
<a href="#l31.207"></a><span id="l31.207" class="difflineplus">+    '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l31.208"></a><span id="l31.208">   controller.mouseOver(new elementslib.Lookup(controller.window.document,</span>
<a href="#l31.209"></a><span id="l31.209">           mouseOverItem.replace(&quot;rowNumber&quot;, row).replace(&quot;columnNumber&quot;, col)));</span>
<a href="#l31.210"></a><span id="l31.210"> </span>
<a href="#l31.211"></a><span id="l31.211">   // check title</span>
<a href="#l31.212"></a><span id="l31.212">   let eventName = new elementslib.Lookup(controller.window.document,</span>
<a href="#l31.213"></a><span id="l31.213" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;calendar-popupset&quot;)/id(&quot;itemTooltip&quot;)/'</span>
<a href="#l31.214"></a><span id="l31.214" class="difflineminus">-    + '{&quot;class&quot;:&quot;tooltipBox&quot;}/{&quot;class&quot;:&quot;tooltipHeaderGrid&quot;}/[1]/[0]/[1]');</span>
<a href="#l31.215"></a><span id="l31.215" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;calendar-popupset&quot;)/id(&quot;itemTooltip&quot;)/' +</span>
<a href="#l31.216"></a><span id="l31.216" class="difflineplus">+    '{&quot;class&quot;:&quot;tooltipBox&quot;}/{&quot;class&quot;:&quot;tooltipHeaderGrid&quot;}/[1]/[0]/[1]');</span>
<a href="#l31.217"></a><span id="l31.217">   controller.assertJS(eventName.getNode().textContent == title);</span>
<a href="#l31.218"></a><span id="l31.218"> </span>
<a href="#l31.219"></a><span id="l31.219">   // check date and time</span>
<a href="#l31.220"></a><span id="l31.220">   // date-time string contains strings formatted in operating system language so check numeric values only</span>
<a href="#l31.221"></a><span id="l31.221">   let dateTime = new elementslib.Lookup(controller.window.document,</span>
<a href="#l31.222"></a><span id="l31.222" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;calendar-popupset&quot;)/id(&quot;itemTooltip&quot;)/'</span>
<a href="#l31.223"></a><span id="l31.223" class="difflineminus">-    + '{&quot;class&quot;:&quot;tooltipBox&quot;}/{&quot;class&quot;:&quot;tooltipHeaderGrid&quot;}/[1]/[2]/[1]').getNode().textContent + '';</span>
<a href="#l31.224"></a><span id="l31.224" class="difflineminus">-  controller.assertJS(dateTime.includes(date) &amp;&amp; dateTime.includes(startTime)</span>
<a href="#l31.225"></a><span id="l31.225" class="difflineminus">-    &amp;&amp; dateTime.includes(endTime));</span>
<a href="#l31.226"></a><span id="l31.226" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;calendar-popupset&quot;)/id(&quot;itemTooltip&quot;)/' +</span>
<a href="#l31.227"></a><span id="l31.227" class="difflineplus">+    '{&quot;class&quot;:&quot;tooltipBox&quot;}/{&quot;class&quot;:&quot;tooltipHeaderGrid&quot;}/[1]/[2]/[1]').getNode().textContent + '';</span>
<a href="#l31.228"></a><span id="l31.228" class="difflineplus">+  controller.assertJS(dateTime.includes(date) &amp;&amp; dateTime.includes(startTime) &amp;&amp;</span>
<a href="#l31.229"></a><span id="l31.229" class="difflineplus">+    dateTime.includes(endTime));</span>
<a href="#l31.230"></a><span id="l31.230"> }</span>
<a href="#l31.231"></a><span id="l31.231"> </span>
<a href="#l31.232"></a><span id="l31.232"> var teardownTest = function(module) {</span>
<a href="#l31.233"></a><span id="l31.233">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l31.234"></a><span id="l31.234"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -51,18 +51,18 @@ var testEventDialogModificationPrompt = </span>
<a href="#l32.4"></a><span id="l32.4">   // enter first set of data</span>
<a href="#l32.5"></a><span id="l32.5">   calUtils.setData(event, data[0]);</span>
<a href="#l32.6"></a><span id="l32.6"> </span>
<a href="#l32.7"></a><span id="l32.7">   // save</span>
<a href="#l32.8"></a><span id="l32.8">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l32.9"></a><span id="l32.9"> </span>
<a href="#l32.10"></a><span id="l32.10">   // open, but change nothing</span>
<a href="#l32.11"></a><span id="l32.11">   let eventBox = new elementslib.Lookup(controller.window.document,</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineminus">-    + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}');</span>
<a href="#l32.14"></a><span id="l32.14" class="difflineplus">+    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8) +</span>
<a href="#l32.15"></a><span id="l32.15" class="difflineplus">+    '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}');</span>
<a href="#l32.16"></a><span id="l32.16">   controller.waitForElement(eventBox);</span>
<a href="#l32.17"></a><span id="l32.17">   controller.doubleClick(eventBox);</span>
<a href="#l32.18"></a><span id="l32.18">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l32.19"></a><span id="l32.19">   event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l32.20"></a><span id="l32.20">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l32.21"></a><span id="l32.21"> </span>
<a href="#l32.22"></a><span id="l32.22">   // modal dialog setup</span>
<a href="#l32.23"></a><span id="l32.23">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l32.24"></a><span id="l32.24" class="difflineat">@@ -70,18 +70,18 @@ var testEventDialogModificationPrompt = </span>
<a href="#l32.25"></a><span id="l32.25"> </span>
<a href="#l32.26"></a><span id="l32.26">   // escape the event window, there should be no prompt to save event</span>
<a href="#l32.27"></a><span id="l32.27">   event.keypress(undefined, &quot;VK_ESCAPE&quot;, {});</span>
<a href="#l32.28"></a><span id="l32.28">   controller.sleep(sleep);</span>
<a href="#l32.29"></a><span id="l32.29">   md.stop();</span>
<a href="#l32.30"></a><span id="l32.30"> </span>
<a href="#l32.31"></a><span id="l32.31">   // open</span>
<a href="#l32.32"></a><span id="l32.32">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l32.33"></a><span id="l32.33" class="difflineminus">-    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)</span>
<a href="#l32.34"></a><span id="l32.34" class="difflineminus">-    + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}'));</span>
<a href="#l32.35"></a><span id="l32.35" class="difflineplus">+    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8) +</span>
<a href="#l32.36"></a><span id="l32.36" class="difflineplus">+    '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}'));</span>
<a href="#l32.37"></a><span id="l32.37">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l32.38"></a><span id="l32.38">   event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l32.39"></a><span id="l32.39">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l32.40"></a><span id="l32.40"> </span>
<a href="#l32.41"></a><span id="l32.41">   // change all values</span>
<a href="#l32.42"></a><span id="l32.42">   calUtils.setData(event, data[1]);</span>
<a href="#l32.43"></a><span id="l32.43"> </span>
<a href="#l32.44"></a><span id="l32.44">   // edit all values back to original</span>
<a href="#l32.45"></a><span id="l32.45" class="difflineat">@@ -111,18 +111,18 @@ var testEventDialogModificationPrompt = </span>
<a href="#l32.46"></a><span id="l32.46">     controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l32.47"></a><span id="l32.47">     event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l32.48"></a><span id="l32.48">       .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l32.49"></a><span id="l32.49">     calUtils.setData(event, newlines[i]);</span>
<a href="#l32.50"></a><span id="l32.50">     event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l32.51"></a><span id="l32.51"> </span>
<a href="#l32.52"></a><span id="l32.52">     // open and close</span>
<a href="#l32.53"></a><span id="l32.53">     eventBox = new elementslib.Lookup(controller.window.document,</span>
<a href="#l32.54"></a><span id="l32.54" class="difflineminus">-      calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)</span>
<a href="#l32.55"></a><span id="l32.55" class="difflineminus">-      + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}');</span>
<a href="#l32.56"></a><span id="l32.56" class="difflineplus">+      calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8) +</span>
<a href="#l32.57"></a><span id="l32.57" class="difflineplus">+      '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}');</span>
<a href="#l32.58"></a><span id="l32.58">     controller.waitForElement(eventBox);</span>
<a href="#l32.59"></a><span id="l32.59">     controller.doubleClick(eventBox);</span>
<a href="#l32.60"></a><span id="l32.60">     controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l32.61"></a><span id="l32.61">     event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l32.62"></a><span id="l32.62">       .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l32.63"></a><span id="l32.63">     md = new modalDialog.modalDialog(event.window);</span>
<a href="#l32.64"></a><span id="l32.64">     md.start(handleSavePrompt);</span>
<a href="#l32.65"></a><span id="l32.65">     event.keypress(undefined, &quot;VK_ESCAPE&quot;, {});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testUTF8.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testUTF8.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -24,59 +24,59 @@ var testUTF8 = function() {</span>
<a href="#l33.4"></a><span id="l33.4"> </span>
<a href="#l33.5"></a><span id="l33.5">   // create new event</span>
<a href="#l33.6"></a><span id="l33.6">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l33.7"></a><span id="l33.7">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, 8)));</span>
<a href="#l33.8"></a><span id="l33.8">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l33.9"></a><span id="l33.9">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l33.10"></a><span id="l33.10"> </span>
<a href="#l33.11"></a><span id="l33.11">   // fill in name, location, description</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-  let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l33.14"></a><span id="l33.14" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l33.15"></a><span id="l33.15" class="difflineplus">+  let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l33.16"></a><span id="l33.16" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l33.17"></a><span id="l33.17" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l33.18"></a><span id="l33.18">   event.waitForElement(titleTextBox);</span>
<a href="#l33.19"></a><span id="l33.19">   event.type(titleTextBox, UTF8string);</span>
<a href="#l33.20"></a><span id="l33.20" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l33.21"></a><span id="l33.21" class="difflineminus">-    + 'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l33.23"></a><span id="l33.23" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l33.24"></a><span id="l33.24" class="difflineplus">+    'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l33.25"></a><span id="l33.25" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l33.26"></a><span id="l33.26">     UTF8string);</span>
<a href="#l33.27"></a><span id="l33.27" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l33.28"></a><span id="l33.28" class="difflineminus">-    + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l33.29"></a><span id="l33.29" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l33.30"></a><span id="l33.30" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineplus">+    'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l33.32"></a><span id="l33.32" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l33.33"></a><span id="l33.33">     UTF8string);</span>
<a href="#l33.34"></a><span id="l33.34"> </span>
<a href="#l33.35"></a><span id="l33.35">   // select category</span>
<a href="#l33.36"></a><span id="l33.36">   event.select(new elementslib.ID(event.window.document, &quot;item-categories&quot;), undefined,</span>
<a href="#l33.37"></a><span id="l33.37">     UTF8string);</span>
<a href="#l33.38"></a><span id="l33.38"> </span>
<a href="#l33.39"></a><span id="l33.39">   // save</span>
<a href="#l33.40"></a><span id="l33.40">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l33.41"></a><span id="l33.41"> </span>
<a href="#l33.42"></a><span id="l33.42">   // open</span>
<a href="#l33.43"></a><span id="l33.43">   let eventBox = new elementslib.Lookup(controller.window.document,</span>
<a href="#l33.44"></a><span id="l33.44" class="difflineminus">-    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)</span>
<a href="#l33.45"></a><span id="l33.45" class="difflineminus">-    + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + UTF8string.toLowerCase() + '&quot;}');</span>
<a href="#l33.46"></a><span id="l33.46" class="difflineplus">+    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8) +</span>
<a href="#l33.47"></a><span id="l33.47" class="difflineplus">+    '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + UTF8string.toLowerCase() + '&quot;}');</span>
<a href="#l33.48"></a><span id="l33.48">   controller.waitForElement(eventBox);</span>
<a href="#l33.49"></a><span id="l33.49">   controller.doubleClick(eventBox);</span>
<a href="#l33.50"></a><span id="l33.50">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l33.51"></a><span id="l33.51">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l33.52"></a><span id="l33.52"> </span>
<a href="#l33.53"></a><span id="l33.53">   // check values</span>
<a href="#l33.54"></a><span id="l33.54" class="difflineminus">-  titleTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l33.55"></a><span id="l33.55" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l33.56"></a><span id="l33.56" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l33.57"></a><span id="l33.57" class="difflineplus">+  titleTextBox = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l33.58"></a><span id="l33.58" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l33.59"></a><span id="l33.59" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l33.60"></a><span id="l33.60">   event.waitForElement(titleTextBox);</span>
<a href="#l33.61"></a><span id="l33.61">   event.assertValue(titleTextBox, UTF8string);</span>
<a href="#l33.62"></a><span id="l33.62" class="difflineminus">-  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l33.63"></a><span id="l33.63" class="difflineminus">-    + 'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l33.64"></a><span id="l33.64" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l33.65"></a><span id="l33.65" class="difflineplus">+  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l33.66"></a><span id="l33.66" class="difflineplus">+    'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l33.67"></a><span id="l33.67" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l33.68"></a><span id="l33.68">     UTF8string);</span>
<a href="#l33.69"></a><span id="l33.69" class="difflineminus">-  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l33.70"></a><span id="l33.70" class="difflineminus">-    + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l33.71"></a><span id="l33.71" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l33.72"></a><span id="l33.72" class="difflineplus">+  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l33.73"></a><span id="l33.73" class="difflineplus">+    'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l33.74"></a><span id="l33.74" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l33.75"></a><span id="l33.75">     UTF8string);</span>
<a href="#l33.76"></a><span id="l33.76">   event.assertValue(new elementslib.ID(event.window.document, &quot;item-categories&quot;),</span>
<a href="#l33.77"></a><span id="l33.77">     UTF8string);</span>
<a href="#l33.78"></a><span id="l33.78"> </span>
<a href="#l33.79"></a><span id="l33.79">   // escape the event window</span>
<a href="#l33.80"></a><span id="l33.80">   event.keypress(undefined, &quot;VK_ESCAPE&quot;, {});</span>
<a href="#l33.81"></a><span id="l33.81"> };</span>
<a href="#l33.82"></a><span id="l33.82"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testAnnualRecurrence.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testAnnualRecurrence.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -39,44 +39,44 @@ var testAnnualRecurrence = function() {</span>
<a href="#l34.4"></a><span id="l34.4">   let box = &quot;&quot;;</span>
<a href="#l34.5"></a><span id="l34.5">   for (let i = 0; i &lt; checkYears.length; i++) {</span>
<a href="#l34.6"></a><span id="l34.6">     calUtils.goToDate(controller, checkYears[i], 1, 1);</span>
<a href="#l34.7"></a><span id="l34.7">     let date = new Date(checkYears[i], 0, 1);</span>
<a href="#l34.8"></a><span id="l34.8">     let column = date.getDay() + 1;</span>
<a href="#l34.9"></a><span id="l34.9"> </span>
<a href="#l34.10"></a><span id="l34.10">     // day view</span>
<a href="#l34.11"></a><span id="l34.11">     calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined)</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineminus">-      + eventPath;</span>
<a href="#l34.14"></a><span id="l34.14" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined) +</span>
<a href="#l34.15"></a><span id="l34.15" class="difflineplus">+      eventPath;</span>
<a href="#l34.16"></a><span id="l34.16">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l34.17"></a><span id="l34.17"> </span>
<a href="#l34.18"></a><span id="l34.18">     // week view</span>
<a href="#l34.19"></a><span id="l34.19">     calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l34.20"></a><span id="l34.20" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.ALLDAY, undefined, column, undefined)</span>
<a href="#l34.21"></a><span id="l34.21" class="difflineminus">-      + eventPath;</span>
<a href="#l34.22"></a><span id="l34.22" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.ALLDAY, undefined, column, undefined) +</span>
<a href="#l34.23"></a><span id="l34.23" class="difflineplus">+      eventPath;</span>
<a href="#l34.24"></a><span id="l34.24">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l34.25"></a><span id="l34.25"> </span>
<a href="#l34.26"></a><span id="l34.26">     // multiweek view</span>
<a href="#l34.27"></a><span id="l34.27">     calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l34.28"></a><span id="l34.28" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.ALLDAY, 1, column, undefined)</span>
<a href="#l34.29"></a><span id="l34.29" class="difflineminus">-      + eventPath;</span>
<a href="#l34.30"></a><span id="l34.30" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.ALLDAY, 1, column, undefined) +</span>
<a href="#l34.31"></a><span id="l34.31" class="difflineplus">+      eventPath;</span>
<a href="#l34.32"></a><span id="l34.32">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l34.33"></a><span id="l34.33"> </span>
<a href="#l34.34"></a><span id="l34.34">     // month view</span>
<a href="#l34.35"></a><span id="l34.35">     calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l34.36"></a><span id="l34.36" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.ALLDAY, 1, column, undefined)</span>
<a href="#l34.37"></a><span id="l34.37" class="difflineminus">-      + eventPath;</span>
<a href="#l34.38"></a><span id="l34.38" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.ALLDAY, 1, column, undefined) +</span>
<a href="#l34.39"></a><span id="l34.39" class="difflineplus">+      eventPath;</span>
<a href="#l34.40"></a><span id="l34.40">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l34.41"></a><span id="l34.41">   }</span>
<a href="#l34.42"></a><span id="l34.42"> </span>
<a href="#l34.43"></a><span id="l34.43">   // delete event</span>
<a href="#l34.44"></a><span id="l34.44">   calUtils.goToDate(controller, checkYears[0], 1, 1);</span>
<a href="#l34.45"></a><span id="l34.45">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l34.46"></a><span id="l34.46" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined)</span>
<a href="#l34.47"></a><span id="l34.47" class="difflineminus">-    + eventPath;</span>
<a href="#l34.48"></a><span id="l34.48" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined) +</span>
<a href="#l34.49"></a><span id="l34.49" class="difflineplus">+    eventPath;</span>
<a href="#l34.50"></a><span id="l34.50">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l34.51"></a><span id="l34.51">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l34.52"></a><span id="l34.52">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l34.53"></a><span id="l34.53">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l34.54"></a><span id="l34.54">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l34.55"></a><span id="l34.55"> };</span>
<a href="#l34.56"></a><span id="l34.56"> </span>
<a href="#l34.57"></a><span id="l34.57"> var teardownTest = function(module) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -26,31 +26,31 @@ var testBiweeklyRecurrence = function() </span>
<a href="#l35.4"></a><span id="l35.4">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l35.5"></a><span id="l35.5">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l35.6"></a><span id="l35.6"> </span>
<a href="#l35.7"></a><span id="l35.7">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l35.8"></a><span id="l35.8">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;bi.weekly&quot;);</span>
<a href="#l35.9"></a><span id="l35.9">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l35.10"></a><span id="l35.10">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l35.11"></a><span id="l35.11"> </span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineminus">-    + eventPath;</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineplus">+  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l35.15"></a><span id="l35.15" class="difflineplus">+    eventPath;</span>
<a href="#l35.16"></a><span id="l35.16"> </span>
<a href="#l35.17"></a><span id="l35.17">   // check day view</span>
<a href="#l35.18"></a><span id="l35.18">   for (let i = 0; i &lt; 4; i++) {</span>
<a href="#l35.19"></a><span id="l35.19">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l35.20"></a><span id="l35.20">     calUtils.forward(controller, 14);</span>
<a href="#l35.21"></a><span id="l35.21">   }</span>
<a href="#l35.22"></a><span id="l35.22"> </span>
<a href="#l35.23"></a><span id="l35.23">   // check week view</span>
<a href="#l35.24"></a><span id="l35.24">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l35.25"></a><span id="l35.25">   calUtils.goToDate(controller, 2009, 1, 31);</span>
<a href="#l35.26"></a><span id="l35.26"> </span>
<a href="#l35.27"></a><span id="l35.27" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, hour)</span>
<a href="#l35.28"></a><span id="l35.28" class="difflineminus">-    + eventPath;</span>
<a href="#l35.29"></a><span id="l35.29" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, hour) +</span>
<a href="#l35.30"></a><span id="l35.30" class="difflineplus">+    eventPath;</span>
<a href="#l35.31"></a><span id="l35.31">   for (let i = 0; i &lt; 4; i++) {</span>
<a href="#l35.32"></a><span id="l35.32">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l35.33"></a><span id="l35.33">     calUtils.forward(controller, 2);</span>
<a href="#l35.34"></a><span id="l35.34">   }</span>
<a href="#l35.35"></a><span id="l35.35"> </span>
<a href="#l35.36"></a><span id="l35.36">   // check multiweek view</span>
<a href="#l35.37"></a><span id="l35.37">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l35.38"></a><span id="l35.38">   calUtils.goToDate(controller, 2009, 1, 31);</span>
<a href="#l35.39"></a><span id="l35.39" class="difflineat">@@ -66,36 +66,36 @@ var testBiweeklyRecurrence = function() </span>
<a href="#l35.40"></a><span id="l35.40">     calUtils.forward(controller, 1);</span>
<a href="#l35.41"></a><span id="l35.41">   }</span>
<a href="#l35.42"></a><span id="l35.42"> </span>
<a href="#l35.43"></a><span id="l35.43">   // check month view</span>
<a href="#l35.44"></a><span id="l35.44">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l35.45"></a><span id="l35.45">   calUtils.goToDate(controller, 2009, 1, 31);</span>
<a href="#l35.46"></a><span id="l35.46"> </span>
<a href="#l35.47"></a><span id="l35.47">   // January</span>
<a href="#l35.48"></a><span id="l35.48" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 5, 7, undefined)</span>
<a href="#l35.49"></a><span id="l35.49" class="difflineminus">-    + eventPath;</span>
<a href="#l35.50"></a><span id="l35.50" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 5, 7, undefined) +</span>
<a href="#l35.51"></a><span id="l35.51" class="difflineplus">+    eventPath;</span>
<a href="#l35.52"></a><span id="l35.52">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l35.53"></a><span id="l35.53">   calUtils.forward(controller, 1);</span>
<a href="#l35.54"></a><span id="l35.54"> </span>
<a href="#l35.55"></a><span id="l35.55">   // February</span>
<a href="#l35.56"></a><span id="l35.56" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 7, undefined)</span>
<a href="#l35.57"></a><span id="l35.57" class="difflineminus">-    + eventPath;</span>
<a href="#l35.58"></a><span id="l35.58" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 7, undefined) +</span>
<a href="#l35.59"></a><span id="l35.59" class="difflineplus">+    eventPath;</span>
<a href="#l35.60"></a><span id="l35.60">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l35.61"></a><span id="l35.61" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 4, 7, undefined)</span>
<a href="#l35.62"></a><span id="l35.62" class="difflineminus">-    + eventPath;</span>
<a href="#l35.63"></a><span id="l35.63" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 4, 7, undefined) +</span>
<a href="#l35.64"></a><span id="l35.64" class="difflineplus">+    eventPath;</span>
<a href="#l35.65"></a><span id="l35.65">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l35.66"></a><span id="l35.66">   calUtils.forward(controller, 1);</span>
<a href="#l35.67"></a><span id="l35.67"> </span>
<a href="#l35.68"></a><span id="l35.68">   // March</span>
<a href="#l35.69"></a><span id="l35.69" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 7, undefined)</span>
<a href="#l35.70"></a><span id="l35.70" class="difflineminus">-    + eventPath;</span>
<a href="#l35.71"></a><span id="l35.71" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 7, undefined) +</span>
<a href="#l35.72"></a><span id="l35.72" class="difflineplus">+    eventPath;</span>
<a href="#l35.73"></a><span id="l35.73">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l35.74"></a><span id="l35.74" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 4, 7, undefined)</span>
<a href="#l35.75"></a><span id="l35.75" class="difflineminus">-    + eventPath;</span>
<a href="#l35.76"></a><span id="l35.76" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 4, 7, undefined) +</span>
<a href="#l35.77"></a><span id="l35.77" class="difflineplus">+    eventPath;</span>
<a href="#l35.78"></a><span id="l35.78">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l35.79"></a><span id="l35.79"> </span>
<a href="#l35.80"></a><span id="l35.80">   // delete event</span>
<a href="#l35.81"></a><span id="l35.81">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l35.82"></a><span id="l35.82">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l35.83"></a><span id="l35.83">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l35.84"></a><span id="l35.84">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l35.85"></a><span id="l35.85">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testDailyRecurrence.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testDailyRecurrence.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -28,176 +28,176 @@ var testDailyRecurrence = function() {</span>
<a href="#l36.4"></a><span id="l36.4">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l36.5"></a><span id="l36.5"> </span>
<a href="#l36.6"></a><span id="l36.6">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l36.7"></a><span id="l36.7">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l36.8"></a><span id="l36.8">     &quot;daily&quot;);</span>
<a href="#l36.9"></a><span id="l36.9">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l36.10"></a><span id="l36.10"> </span>
<a href="#l36.11"></a><span id="l36.11">   // check day view for 7 days</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-  let daybox = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour, undefined)</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineminus">-    + eventPath;</span>
<a href="#l36.14"></a><span id="l36.14" class="difflineplus">+  let daybox = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour, undefined) +</span>
<a href="#l36.15"></a><span id="l36.15" class="difflineplus">+    eventPath;</span>
<a href="#l36.16"></a><span id="l36.16">   controller.waitForElement(new elementslib.Lookup(controller.window.document, daybox));</span>
<a href="#l36.17"></a><span id="l36.17"> </span>
<a href="#l36.18"></a><span id="l36.18">   for (let day = 1; day &lt;= 7; day++) {</span>
<a href="#l36.19"></a><span id="l36.19">     controller.assertNode(new elementslib.Lookup(controller.window.document, daybox));</span>
<a href="#l36.20"></a><span id="l36.20">     calUtils.forward(controller, 1);</span>
<a href="#l36.21"></a><span id="l36.21">   }</span>
<a href="#l36.22"></a><span id="l36.22"> </span>
<a href="#l36.23"></a><span id="l36.23">   // check week view for 2 weeks</span>
<a href="#l36.24"></a><span id="l36.24">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l36.25"></a><span id="l36.25">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l36.26"></a><span id="l36.26"> </span>
<a href="#l36.27"></a><span id="l36.27">   for (let day = 5; day &lt;= 7; day++) {</span>
<a href="#l36.28"></a><span id="l36.28" class="difflineminus">-    let weekbox = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, 1, day, hour)</span>
<a href="#l36.29"></a><span id="l36.29" class="difflineminus">-      + eventPath;</span>
<a href="#l36.30"></a><span id="l36.30" class="difflineplus">+    let weekbox = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, 1, day, hour) +</span>
<a href="#l36.31"></a><span id="l36.31" class="difflineplus">+      eventPath;</span>
<a href="#l36.32"></a><span id="l36.32">     controller.assertNode(new elementslib.Lookup(controller.window.document, weekbox));</span>
<a href="#l36.33"></a><span id="l36.33">   }</span>
<a href="#l36.34"></a><span id="l36.34"> </span>
<a href="#l36.35"></a><span id="l36.35">   calUtils.forward(controller, 1);</span>
<a href="#l36.36"></a><span id="l36.36"> </span>
<a href="#l36.37"></a><span id="l36.37">   for (let day = 1; day &lt;= 7; day++) {</span>
<a href="#l36.38"></a><span id="l36.38" class="difflineminus">-    let weekbox = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, 2, day, hour)</span>
<a href="#l36.39"></a><span id="l36.39" class="difflineminus">-      + eventPath;</span>
<a href="#l36.40"></a><span id="l36.40" class="difflineplus">+    let weekbox = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, 2, day, hour) +</span>
<a href="#l36.41"></a><span id="l36.41" class="difflineplus">+      eventPath;</span>
<a href="#l36.42"></a><span id="l36.42">     controller.assertNode(new elementslib.Lookup(controller.window.document, weekbox));</span>
<a href="#l36.43"></a><span id="l36.43">   }</span>
<a href="#l36.44"></a><span id="l36.44"> </span>
<a href="#l36.45"></a><span id="l36.45">   // check multiweek view for 4 weeks</span>
<a href="#l36.46"></a><span id="l36.46">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l36.47"></a><span id="l36.47">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l36.48"></a><span id="l36.48"> </span>
<a href="#l36.49"></a><span id="l36.49">   for (let day = 5; day &lt;= 7; day++) {</span>
<a href="#l36.50"></a><span id="l36.50" class="difflineminus">-    let mweekbox = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, day, hour)</span>
<a href="#l36.51"></a><span id="l36.51" class="difflineminus">-      + eventPath;</span>
<a href="#l36.52"></a><span id="l36.52" class="difflineplus">+    let mweekbox = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, day, hour) +</span>
<a href="#l36.53"></a><span id="l36.53" class="difflineplus">+      eventPath;</span>
<a href="#l36.54"></a><span id="l36.54">     controller.assertNode(new elementslib.Lookup(controller.window.document, mweekbox));</span>
<a href="#l36.55"></a><span id="l36.55">   }</span>
<a href="#l36.56"></a><span id="l36.56"> </span>
<a href="#l36.57"></a><span id="l36.57">   for (let week = 2; week &lt;= 4; week++) {</span>
<a href="#l36.58"></a><span id="l36.58">     for (let day = 1; day &lt;= 7; day++) {</span>
<a href="#l36.59"></a><span id="l36.59" class="difflineminus">-      let mweekbox = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, week, day, hour)</span>
<a href="#l36.60"></a><span id="l36.60" class="difflineminus">-        + eventPath;</span>
<a href="#l36.61"></a><span id="l36.61" class="difflineplus">+      let mweekbox = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, week, day, hour) +</span>
<a href="#l36.62"></a><span id="l36.62" class="difflineplus">+        eventPath;</span>
<a href="#l36.63"></a><span id="l36.63">       controller.assertNode(new elementslib.Lookup(controller.window.document, mweekbox));</span>
<a href="#l36.64"></a><span id="l36.64">     }</span>
<a href="#l36.65"></a><span id="l36.65">   }</span>
<a href="#l36.66"></a><span id="l36.66"> </span>
<a href="#l36.67"></a><span id="l36.67">   // check month view for all 5 weeks</span>
<a href="#l36.68"></a><span id="l36.68">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l36.69"></a><span id="l36.69">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l36.70"></a><span id="l36.70"> </span>
<a href="#l36.71"></a><span id="l36.71">   for (let day = 5; day &lt;= 7; day++) {</span>
<a href="#l36.72"></a><span id="l36.72" class="difflineminus">-    let mbox = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, day, undefined)</span>
<a href="#l36.73"></a><span id="l36.73" class="difflineminus">-      + eventPath;</span>
<a href="#l36.74"></a><span id="l36.74" class="difflineplus">+    let mbox = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, day, undefined) +</span>
<a href="#l36.75"></a><span id="l36.75" class="difflineplus">+      eventPath;</span>
<a href="#l36.76"></a><span id="l36.76">     controller.assertNode(new elementslib.Lookup(controller.window.document, mbox));</span>
<a href="#l36.77"></a><span id="l36.77">   }</span>
<a href="#l36.78"></a><span id="l36.78"> </span>
<a href="#l36.79"></a><span id="l36.79">   for (let week = 2; week &lt;= 5; week++) {</span>
<a href="#l36.80"></a><span id="l36.80">     for (let day = 1; day &lt;= 7; day++) {</span>
<a href="#l36.81"></a><span id="l36.81" class="difflineminus">-      let mbox = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, week, day, undefined)</span>
<a href="#l36.82"></a><span id="l36.82" class="difflineminus">-        + eventPath;</span>
<a href="#l36.83"></a><span id="l36.83" class="difflineplus">+      let mbox = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, week, day, undefined) +</span>
<a href="#l36.84"></a><span id="l36.84" class="difflineplus">+        eventPath;</span>
<a href="#l36.85"></a><span id="l36.85">       controller.assertNode(new elementslib.Lookup(controller.window.document, mbox));</span>
<a href="#l36.86"></a><span id="l36.86">     }</span>
<a href="#l36.87"></a><span id="l36.87">   }</span>
<a href="#l36.88"></a><span id="l36.88"> </span>
<a href="#l36.89"></a><span id="l36.89">   // delete 3rd January occurrence</span>
<a href="#l36.90"></a><span id="l36.90" class="difflineminus">-  let saturday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, 7, undefined)</span>
<a href="#l36.91"></a><span id="l36.91" class="difflineminus">-    + eventPath;</span>
<a href="#l36.92"></a><span id="l36.92" class="difflineplus">+  let saturday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, 7, undefined) +</span>
<a href="#l36.93"></a><span id="l36.93" class="difflineplus">+    eventPath;</span>
<a href="#l36.94"></a><span id="l36.94">   calUtils.handleOccurrenceDeletion(controller, false);</span>
<a href="#l36.95"></a><span id="l36.95">   controller.click(new elementslib.Lookup(controller.window.document, saturday));</span>
<a href="#l36.96"></a><span id="l36.96">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l36.97"></a><span id="l36.97">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l36.98"></a><span id="l36.98"> </span>
<a href="#l36.99"></a><span id="l36.99">   // verify in all views</span>
<a href="#l36.100"></a><span id="l36.100">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, saturday));</span>
<a href="#l36.101"></a><span id="l36.101"> </span>
<a href="#l36.102"></a><span id="l36.102">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l36.103"></a><span id="l36.103" class="difflineminus">-  saturday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, 7, undefined)</span>
<a href="#l36.104"></a><span id="l36.104" class="difflineminus">-    + eventPath;</span>
<a href="#l36.105"></a><span id="l36.105" class="difflineplus">+  saturday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, 7, undefined) +</span>
<a href="#l36.106"></a><span id="l36.106" class="difflineplus">+    eventPath;</span>
<a href="#l36.107"></a><span id="l36.107">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, saturday));</span>
<a href="#l36.108"></a><span id="l36.108"> </span>
<a href="#l36.109"></a><span id="l36.109">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l36.110"></a><span id="l36.110" class="difflineminus">-  saturday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, undefined)</span>
<a href="#l36.111"></a><span id="l36.111" class="difflineminus">-    + eventPath;</span>
<a href="#l36.112"></a><span id="l36.112" class="difflineplus">+  saturday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, undefined) +</span>
<a href="#l36.113"></a><span id="l36.113" class="difflineplus">+    eventPath;</span>
<a href="#l36.114"></a><span id="l36.114">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, saturday));</span>
<a href="#l36.115"></a><span id="l36.115"> </span>
<a href="#l36.116"></a><span id="l36.116">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l36.117"></a><span id="l36.117" class="difflineminus">-  saturday = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, undefined)</span>
<a href="#l36.118"></a><span id="l36.118" class="difflineminus">-    + eventPath;</span>
<a href="#l36.119"></a><span id="l36.119" class="difflineplus">+  saturday = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, undefined) +</span>
<a href="#l36.120"></a><span id="l36.120" class="difflineplus">+    eventPath;</span>
<a href="#l36.121"></a><span id="l36.121">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, saturday));</span>
<a href="#l36.122"></a><span id="l36.122"> </span>
<a href="#l36.123"></a><span id="l36.123">   // go to previous day to edit event to occur only on weekdays</span>
<a href="#l36.124"></a><span id="l36.124">   calUtils.back(controller, 1);</span>
<a href="#l36.125"></a><span id="l36.125"> </span>
<a href="#l36.126"></a><span id="l36.126">   calUtils.handleParentModification(controller, false);</span>
<a href="#l36.127"></a><span id="l36.127">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l36.128"></a><span id="l36.128" class="difflineminus">-    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l36.129"></a><span id="l36.129" class="difflineminus">-      + eventPath));</span>
<a href="#l36.130"></a><span id="l36.130" class="difflineplus">+    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l36.131"></a><span id="l36.131" class="difflineplus">+      eventPath));</span>
<a href="#l36.132"></a><span id="l36.132"> </span>
<a href="#l36.133"></a><span id="l36.133">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l36.134"></a><span id="l36.134">   event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l36.135"></a><span id="l36.135">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l36.136"></a><span id="l36.136"> </span>
<a href="#l36.137"></a><span id="l36.137">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l36.138"></a><span id="l36.138">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l36.139"></a><span id="l36.139">     &quot;every.weekday&quot;);</span>
<a href="#l36.140"></a><span id="l36.140">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l36.141"></a><span id="l36.141">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l36.142"></a><span id="l36.142"> </span>
<a href="#l36.143"></a><span id="l36.143">   // check day view for 7 days</span>
<a href="#l36.144"></a><span id="l36.144" class="difflineminus">-  let day = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, undefined)</span>
<a href="#l36.145"></a><span id="l36.145" class="difflineminus">-    + eventPath;</span>
<a href="#l36.146"></a><span id="l36.146" class="difflineplus">+  let day = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, undefined) +</span>
<a href="#l36.147"></a><span id="l36.147" class="difflineplus">+    eventPath;</span>
<a href="#l36.148"></a><span id="l36.148">   let dates = [[2009, 1, 3],</span>
<a href="#l36.149"></a><span id="l36.149">                [2009, 1, 4]];</span>
<a href="#l36.150"></a><span id="l36.150">   for (let i = 0; i &lt; dates.length; i++) {</span>
<a href="#l36.151"></a><span id="l36.151">     calUtils.goToDate(controller, dates[i][0], dates[i][1], dates[i][2]);</span>
<a href="#l36.152"></a><span id="l36.152">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l36.153"></a><span id="l36.153">   }</span>
<a href="#l36.154"></a><span id="l36.154"> </span>
<a href="#l36.155"></a><span id="l36.155">   // check week view for 2 weeks</span>
<a href="#l36.156"></a><span id="l36.156">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l36.157"></a><span id="l36.157">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l36.158"></a><span id="l36.158"> </span>
<a href="#l36.159"></a><span id="l36.159">   for (let i = 0; i &lt;= 1; i++) {</span>
<a href="#l36.160"></a><span id="l36.160" class="difflineminus">-    let weekday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 1, undefined)</span>
<a href="#l36.161"></a><span id="l36.161" class="difflineminus">-      + eventPath;</span>
<a href="#l36.162"></a><span id="l36.162" class="difflineplus">+    let weekday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 1, undefined) +</span>
<a href="#l36.163"></a><span id="l36.163" class="difflineplus">+      eventPath;</span>
<a href="#l36.164"></a><span id="l36.164">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, weekday));</span>
<a href="#l36.165"></a><span id="l36.165" class="difflineminus">-    weekday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, undefined)</span>
<a href="#l36.166"></a><span id="l36.166" class="difflineminus">-      + eventPath;</span>
<a href="#l36.167"></a><span id="l36.167" class="difflineplus">+    weekday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, undefined) +</span>
<a href="#l36.168"></a><span id="l36.168" class="difflineplus">+      eventPath;</span>
<a href="#l36.169"></a><span id="l36.169">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, weekday));</span>
<a href="#l36.170"></a><span id="l36.170">     calUtils.forward(controller, 1);</span>
<a href="#l36.171"></a><span id="l36.171">   }</span>
<a href="#l36.172"></a><span id="l36.172"> </span>
<a href="#l36.173"></a><span id="l36.173">   // check multiweek view for 4 weeks</span>
<a href="#l36.174"></a><span id="l36.174">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l36.175"></a><span id="l36.175">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l36.176"></a><span id="l36.176"> </span>
<a href="#l36.177"></a><span id="l36.177">   for (let i = 1; i &lt;= 4; i++) {</span>
<a href="#l36.178"></a><span id="l36.178" class="difflineminus">-    let mweekday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, i, 1, undefined)</span>
<a href="#l36.179"></a><span id="l36.179" class="difflineminus">-      + eventPath;</span>
<a href="#l36.180"></a><span id="l36.180" class="difflineplus">+    let mweekday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, i, 1, undefined) +</span>
<a href="#l36.181"></a><span id="l36.181" class="difflineplus">+      eventPath;</span>
<a href="#l36.182"></a><span id="l36.182">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, mweekday));</span>
<a href="#l36.183"></a><span id="l36.183" class="difflineminus">-    mweekday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, i, 7, undefined)</span>
<a href="#l36.184"></a><span id="l36.184" class="difflineminus">-      + eventPath;</span>
<a href="#l36.185"></a><span id="l36.185" class="difflineplus">+    mweekday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, i, 7, undefined) +</span>
<a href="#l36.186"></a><span id="l36.186" class="difflineplus">+      eventPath;</span>
<a href="#l36.187"></a><span id="l36.187">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, mweekday));</span>
<a href="#l36.188"></a><span id="l36.188">   }</span>
<a href="#l36.189"></a><span id="l36.189"> </span>
<a href="#l36.190"></a><span id="l36.190">   // check month view for all 5 weeks</span>
<a href="#l36.191"></a><span id="l36.191">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l36.192"></a><span id="l36.192">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l36.193"></a><span id="l36.193"> </span>
<a href="#l36.194"></a><span id="l36.194">   for (let i = 1; i &lt;= 5; i++) {</span>
<a href="#l36.195"></a><span id="l36.195" class="difflineminus">-    let mday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, i, 1, undefined)</span>
<a href="#l36.196"></a><span id="l36.196" class="difflineminus">-      + eventPath;</span>
<a href="#l36.197"></a><span id="l36.197" class="difflineplus">+    let mday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, i, 1, undefined) +</span>
<a href="#l36.198"></a><span id="l36.198" class="difflineplus">+      eventPath;</span>
<a href="#l36.199"></a><span id="l36.199">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, mday));</span>
<a href="#l36.200"></a><span id="l36.200" class="difflineminus">-    mday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, i, 7, undefined)</span>
<a href="#l36.201"></a><span id="l36.201" class="difflineminus">-      + eventPath;</span>
<a href="#l36.202"></a><span id="l36.202" class="difflineplus">+    mday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, i, 7, undefined) +</span>
<a href="#l36.203"></a><span id="l36.203" class="difflineplus">+      eventPath;</span>
<a href="#l36.204"></a><span id="l36.204">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, mday));</span>
<a href="#l36.205"></a><span id="l36.205">   }</span>
<a href="#l36.206"></a><span id="l36.206"> </span>
<a href="#l36.207"></a><span id="l36.207">   // delete event</span>
<a href="#l36.208"></a><span id="l36.208" class="difflineminus">-  day = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, 5, undefined)</span>
<a href="#l36.209"></a><span id="l36.209" class="difflineminus">-    + eventPath;</span>
<a href="#l36.210"></a><span id="l36.210" class="difflineplus">+  day = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, 5, undefined) +</span>
<a href="#l36.211"></a><span id="l36.211" class="difflineplus">+    eventPath;</span>
<a href="#l36.212"></a><span id="l36.212">   controller.click(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l36.213"></a><span id="l36.213">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l36.214"></a><span id="l36.214">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l36.215"></a><span id="l36.215">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l36.216"></a><span id="l36.216">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l36.217"></a><span id="l36.217"> };</span>
<a href="#l36.218"></a><span id="l36.218"> </span>
<a href="#l36.219"></a><span id="l36.219"> var teardownTest = function(module) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -55,32 +55,32 @@ var testLastDayOfMonthRecurrence = funct</span>
<a href="#l37.4"></a><span id="l37.4">   let box = &quot;&quot;;</span>
<a href="#l37.5"></a><span id="l37.5"> </span>
<a href="#l37.6"></a><span id="l37.6">   // check all dates</span>
<a href="#l37.7"></a><span id="l37.7">   for (let i = 0; i &lt; checkingData.length; i++) {</span>
<a href="#l37.8"></a><span id="l37.8">     calUtils.goToDate(controller, checkingData[i][0], checkingData[i][1], checkingData[i][2]);</span>
<a href="#l37.9"></a><span id="l37.9"> </span>
<a href="#l37.10"></a><span id="l37.10">     // day view</span>
<a href="#l37.11"></a><span id="l37.11">     calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineminus">-      + eventPath;</span>
<a href="#l37.14"></a><span id="l37.14" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l37.15"></a><span id="l37.15" class="difflineplus">+      eventPath;</span>
<a href="#l37.16"></a><span id="l37.16">     controller.waitForElement(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l37.17"></a><span id="l37.17"> </span>
<a href="#l37.18"></a><span id="l37.18">     // week view</span>
<a href="#l37.19"></a><span id="l37.19">     calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l37.20"></a><span id="l37.20">     let date = new Date(checkingData[i][0], checkingData[i][1] - 1, checkingData[i][2]);</span>
<a href="#l37.21"></a><span id="l37.21">     let column = date.getDay() + 1;</span>
<a href="#l37.22"></a><span id="l37.22" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, column, hour)</span>
<a href="#l37.23"></a><span id="l37.23" class="difflineminus">-      + eventPath;</span>
<a href="#l37.24"></a><span id="l37.24" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, column, hour) +</span>
<a href="#l37.25"></a><span id="l37.25" class="difflineplus">+      eventPath;</span>
<a href="#l37.26"></a><span id="l37.26">     controller.waitForElement(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l37.27"></a><span id="l37.27"> </span>
<a href="#l37.28"></a><span id="l37.28">     // multiweek view</span>
<a href="#l37.29"></a><span id="l37.29">     calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l37.30"></a><span id="l37.30" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, column, undefined)</span>
<a href="#l37.31"></a><span id="l37.31" class="difflineminus">-      + eventPath;</span>
<a href="#l37.32"></a><span id="l37.32" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, column, undefined) +</span>
<a href="#l37.33"></a><span id="l37.33" class="difflineplus">+      eventPath;</span>
<a href="#l37.34"></a><span id="l37.34">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l37.35"></a><span id="l37.35"> </span>
<a href="#l37.36"></a><span id="l37.36">     // month view</span>
<a href="#l37.37"></a><span id="l37.37">     calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l37.38"></a><span id="l37.38">     box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, checkingData[i][3],</span>
<a href="#l37.39"></a><span id="l37.39">       column, undefined) + eventPath;</span>
<a href="#l37.40"></a><span id="l37.40">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l37.41"></a><span id="l37.41">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -30,55 +30,55 @@ var testWeeklyNRecurrence = function() {</span>
<a href="#l38.4"></a><span id="l38.4">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l38.5"></a><span id="l38.5">   md.start(setRecurrence);</span>
<a href="#l38.6"></a><span id="l38.6">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l38.7"></a><span id="l38.7">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l38.8"></a><span id="l38.8"> </span>
<a href="#l38.9"></a><span id="l38.9">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l38.10"></a><span id="l38.10"> </span>
<a href="#l38.11"></a><span id="l38.11">   // check day view</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineminus">-    + eventPath;</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineplus">+  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l38.15"></a><span id="l38.15" class="difflineplus">+    eventPath;</span>
<a href="#l38.16"></a><span id="l38.16"> </span>
<a href="#l38.17"></a><span id="l38.17">   // Monday, Tuesday, Wednesday, Thursday</span>
<a href="#l38.18"></a><span id="l38.18">   for (let i = 0; i &lt; 4; i++) {</span>
<a href="#l38.19"></a><span id="l38.19">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l38.20"></a><span id="l38.20">     calUtils.forward(controller, 1);</span>
<a href="#l38.21"></a><span id="l38.21">   }</span>
<a href="#l38.22"></a><span id="l38.22"> </span>
<a href="#l38.23"></a><span id="l38.23">   // Saturday</span>
<a href="#l38.24"></a><span id="l38.24">   calUtils.forward(controller, 1);</span>
<a href="#l38.25"></a><span id="l38.25">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l38.26"></a><span id="l38.26"> </span>
<a href="#l38.27"></a><span id="l38.27">   // check week view</span>
<a href="#l38.28"></a><span id="l38.28">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l38.29"></a><span id="l38.29"> </span>
<a href="#l38.30"></a><span id="l38.30">   // Monday, Tuesday, Wednesday, Thursday</span>
<a href="#l38.31"></a><span id="l38.31">   for (let i = 2; i &lt; 6; i++) {</span>
<a href="#l38.32"></a><span id="l38.32" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, i, hour)</span>
<a href="#l38.33"></a><span id="l38.33" class="difflineminus">-      + eventPath;</span>
<a href="#l38.34"></a><span id="l38.34" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, i, hour) +</span>
<a href="#l38.35"></a><span id="l38.35" class="difflineplus">+      eventPath;</span>
<a href="#l38.36"></a><span id="l38.36">     controller.waitForElement(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l38.37"></a><span id="l38.37">   }</span>
<a href="#l38.38"></a><span id="l38.38"> </span>
<a href="#l38.39"></a><span id="l38.39">   // Saturday</span>
<a href="#l38.40"></a><span id="l38.40" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, hour)</span>
<a href="#l38.41"></a><span id="l38.41" class="difflineminus">-    + eventPath;</span>
<a href="#l38.42"></a><span id="l38.42" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, hour) +</span>
<a href="#l38.43"></a><span id="l38.43" class="difflineplus">+    eventPath;</span>
<a href="#l38.44"></a><span id="l38.44">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l38.45"></a><span id="l38.45"> </span>
<a href="#l38.46"></a><span id="l38.46">   // check multiweek view</span>
<a href="#l38.47"></a><span id="l38.47">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l38.48"></a><span id="l38.48">   checkMultiWeekView(&quot;multiweek&quot;);</span>
<a href="#l38.49"></a><span id="l38.49"> </span>
<a href="#l38.50"></a><span id="l38.50">   // check month view</span>
<a href="#l38.51"></a><span id="l38.51">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l38.52"></a><span id="l38.52">   checkMultiWeekView(&quot;month&quot;);</span>
<a href="#l38.53"></a><span id="l38.53"> </span>
<a href="#l38.54"></a><span id="l38.54">   // delete event</span>
<a href="#l38.55"></a><span id="l38.55" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 2, hour)</span>
<a href="#l38.56"></a><span id="l38.56" class="difflineminus">-    + eventPath;</span>
<a href="#l38.57"></a><span id="l38.57" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 2, hour) +</span>
<a href="#l38.58"></a><span id="l38.58" class="difflineplus">+    eventPath;</span>
<a href="#l38.59"></a><span id="l38.59">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l38.60"></a><span id="l38.60">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l38.61"></a><span id="l38.61">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l38.62"></a><span id="l38.62">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l38.63"></a><span id="l38.63">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l38.64"></a><span id="l38.64"> };</span>
<a href="#l38.65"></a><span id="l38.65"> </span>
<a href="#l38.66"></a><span id="l38.66"> function setRecurrence(recurrence) {</span>
<a href="#l38.67"></a><span id="l38.67" class="difflineat">@@ -88,58 +88,58 @@ function setRecurrence(recurrence) {</span>
<a href="#l38.68"></a><span id="l38.68">   recurrence.sleep(sleep);</span>
<a href="#l38.69"></a><span id="l38.69"> </span>
<a href="#l38.70"></a><span id="l38.70">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l38.71"></a><span id="l38.71">   let tue = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.3.Mmm&quot;);</span>
<a href="#l38.72"></a><span id="l38.72">   let wed = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.4.Mmm&quot;);</span>
<a href="#l38.73"></a><span id="l38.73">   let thu = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.5.Mmm&quot;);</span>
<a href="#l38.74"></a><span id="l38.74">   let sat = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.7.Mmm&quot;);</span>
<a href="#l38.75"></a><span id="l38.75"> </span>
<a href="#l38.76"></a><span id="l38.76" class="difflineminus">-  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/'</span>
<a href="#l38.77"></a><span id="l38.77" class="difflineminus">-    + 'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/'</span>
<a href="#l38.78"></a><span id="l38.78" class="difflineminus">-    + 'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l38.79"></a><span id="l38.79" class="difflineplus">+  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/' +</span>
<a href="#l38.80"></a><span id="l38.80" class="difflineplus">+    'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/' +</span>
<a href="#l38.81"></a><span id="l38.81" class="difflineplus">+    'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l38.82"></a><span id="l38.82"> </span>
<a href="#l38.83"></a><span id="l38.83">   // starting from Monday so it should be checked</span>
<a href="#l38.84"></a><span id="l38.84">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + mon + '&quot;}'));</span>
<a href="#l38.85"></a><span id="l38.85">   // check Tuesday, Wednesday, Thursday and Saturday too</span>
<a href="#l38.86"></a><span id="l38.86">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + tue + '&quot;}'));</span>
<a href="#l38.87"></a><span id="l38.87">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + wed + '&quot;}'));</span>
<a href="#l38.88"></a><span id="l38.88">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + thu + '&quot;}'));</span>
<a href="#l38.89"></a><span id="l38.89">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + sat + '&quot;}'));</span>
<a href="#l38.90"></a><span id="l38.90"> </span>
<a href="#l38.91"></a><span id="l38.91">   // set number of occurrences</span>
<a href="#l38.92"></a><span id="l38.92">   recurrence.click(new elementslib.ID(recurrence.window.document, &quot;recurrence-range-for&quot;));</span>
<a href="#l38.93"></a><span id="l38.93" class="difflineminus">-  let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/'</span>
<a href="#l38.94"></a><span id="l38.94" class="difflineminus">-    + 'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-count-box&quot;)/id(&quot;repeat-ntimes-count&quot;)/'</span>
<a href="#l38.95"></a><span id="l38.95" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l38.96"></a><span id="l38.96" class="difflineplus">+  let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/' +</span>
<a href="#l38.97"></a><span id="l38.97" class="difflineplus">+    'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-count-box&quot;)/id(&quot;repeat-ntimes-count&quot;)/' +</span>
<a href="#l38.98"></a><span id="l38.98" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l38.99"></a><span id="l38.99">   // replace previous number</span>
<a href="#l38.100"></a><span id="l38.100">   recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l38.101"></a><span id="l38.101">   recurrence.type(new elementslib.Lookup(recurrence.window.document, input), &quot;4&quot;);</span>
<a href="#l38.102"></a><span id="l38.102"> </span>
<a href="#l38.103"></a><span id="l38.103">   // close dialog</span>
<a href="#l38.104"></a><span id="l38.104" class="difflineminus">-  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l38.105"></a><span id="l38.105" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l38.106"></a><span id="l38.106" class="difflineplus">+  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/' +</span>
<a href="#l38.107"></a><span id="l38.107" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l38.108"></a><span id="l38.108"> }</span>
<a href="#l38.109"></a><span id="l38.109"> </span>
<a href="#l38.110"></a><span id="l38.110"> function checkMultiWeekView(view) {</span>
<a href="#l38.111"></a><span id="l38.111">   let week = 1;</span>
<a href="#l38.112"></a><span id="l38.112"> </span>
<a href="#l38.113"></a><span id="l38.113">   // in month view event starts from 2nd row</span>
<a href="#l38.114"></a><span id="l38.114">   if (view == &quot;month&quot;) {</span>
<a href="#l38.115"></a><span id="l38.115">     week++;</span>
<a href="#l38.116"></a><span id="l38.116">   }</span>
<a href="#l38.117"></a><span id="l38.117"> </span>
<a href="#l38.118"></a><span id="l38.118">   // Monday, Tuesday, Wednesday, Thursday</span>
<a href="#l38.119"></a><span id="l38.119">   for (let i = 2; i &lt; 6; i++) {</span>
<a href="#l38.120"></a><span id="l38.120" class="difflineminus">-    let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, i, undefined)</span>
<a href="#l38.121"></a><span id="l38.121" class="difflineminus">-      + eventPath;</span>
<a href="#l38.122"></a><span id="l38.122" class="difflineplus">+    let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, i, undefined) +</span>
<a href="#l38.123"></a><span id="l38.123" class="difflineplus">+      eventPath;</span>
<a href="#l38.124"></a><span id="l38.124">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l38.125"></a><span id="l38.125">   }</span>
<a href="#l38.126"></a><span id="l38.126"> </span>
<a href="#l38.127"></a><span id="l38.127">   // Saturday</span>
<a href="#l38.128"></a><span id="l38.128" class="difflineminus">-  let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 7, undefined)</span>
<a href="#l38.129"></a><span id="l38.129" class="difflineminus">-    + eventPath;</span>
<a href="#l38.130"></a><span id="l38.130" class="difflineplus">+  let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 7, undefined) +</span>
<a href="#l38.131"></a><span id="l38.131" class="difflineplus">+    eventPath;</span>
<a href="#l38.132"></a><span id="l38.132">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l38.133"></a><span id="l38.133"> }</span>
<a href="#l38.134"></a><span id="l38.134"> </span>
<a href="#l38.135"></a><span id="l38.135"> var teardownTest = function(module) {</span>
<a href="#l38.136"></a><span id="l38.136">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l38.137"></a><span id="l38.137"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -32,18 +32,18 @@ var testWeeklyUntilRecurrence = function</span>
<a href="#l39.4"></a><span id="l39.4">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l39.5"></a><span id="l39.5">   md.start(setRecurrence);</span>
<a href="#l39.6"></a><span id="l39.6">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l39.7"></a><span id="l39.7">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l39.8"></a><span id="l39.8"> </span>
<a href="#l39.9"></a><span id="l39.9">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l39.10"></a><span id="l39.10">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l39.11"></a><span id="l39.11"> </span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineminus">-    + eventPath;</span>
<a href="#l39.14"></a><span id="l39.14" class="difflineplus">+  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l39.15"></a><span id="l39.15" class="difflineplus">+    eventPath;</span>
<a href="#l39.16"></a><span id="l39.16"> </span>
<a href="#l39.17"></a><span id="l39.17">   // check day view</span>
<a href="#l39.18"></a><span id="l39.18">   for (let week = 0; week &lt; 3; week++) {</span>
<a href="#l39.19"></a><span id="l39.19">     // Monday</span>
<a href="#l39.20"></a><span id="l39.20">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.21"></a><span id="l39.21">     calUtils.forward(controller, 2);</span>
<a href="#l39.22"></a><span id="l39.22">     // Wednesday</span>
<a href="#l39.23"></a><span id="l39.23">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.24"></a><span id="l39.24" class="difflineat">@@ -60,53 +60,53 @@ var testWeeklyUntilRecurrence = function</span>
<a href="#l39.25"></a><span id="l39.25">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.26"></a><span id="l39.26">   calUtils.forward(controller, 2);</span>
<a href="#l39.27"></a><span id="l39.27"> </span>
<a href="#l39.28"></a><span id="l39.28">   // check week view</span>
<a href="#l39.29"></a><span id="l39.29">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l39.30"></a><span id="l39.30">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l39.31"></a><span id="l39.31">   for (let week = 0; week &lt; 3; week++) {</span>
<a href="#l39.32"></a><span id="l39.32">     // Monday</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour)</span>
<a href="#l39.34"></a><span id="l39.34" class="difflineminus">-      + eventPath;</span>
<a href="#l39.35"></a><span id="l39.35" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour) +</span>
<a href="#l39.36"></a><span id="l39.36" class="difflineplus">+      eventPath;</span>
<a href="#l39.37"></a><span id="l39.37">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.38"></a><span id="l39.38">     // Wednesday</span>
<a href="#l39.39"></a><span id="l39.39" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 4, hour)</span>
<a href="#l39.40"></a><span id="l39.40" class="difflineminus">-      + eventPath;</span>
<a href="#l39.41"></a><span id="l39.41" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 4, hour) +</span>
<a href="#l39.42"></a><span id="l39.42" class="difflineplus">+      eventPath;</span>
<a href="#l39.43"></a><span id="l39.43">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.44"></a><span id="l39.44">     // Friday</span>
<a href="#l39.45"></a><span id="l39.45" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 6, hour)</span>
<a href="#l39.46"></a><span id="l39.46" class="difflineminus">-      + eventPath;</span>
<a href="#l39.47"></a><span id="l39.47" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 6, hour) +</span>
<a href="#l39.48"></a><span id="l39.48" class="difflineplus">+      eventPath;</span>
<a href="#l39.49"></a><span id="l39.49">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.50"></a><span id="l39.50"> </span>
<a href="#l39.51"></a><span id="l39.51">     calUtils.forward(controller, 1);</span>
<a href="#l39.52"></a><span id="l39.52">   }</span>
<a href="#l39.53"></a><span id="l39.53"> </span>
<a href="#l39.54"></a><span id="l39.54">   // Monday, last occurrence</span>
<a href="#l39.55"></a><span id="l39.55" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour)</span>
<a href="#l39.56"></a><span id="l39.56" class="difflineminus">-    + eventPath;</span>
<a href="#l39.57"></a><span id="l39.57" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour) +</span>
<a href="#l39.58"></a><span id="l39.58" class="difflineplus">+    eventPath;</span>
<a href="#l39.59"></a><span id="l39.59">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.60"></a><span id="l39.60">   // Wednesday</span>
<a href="#l39.61"></a><span id="l39.61" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 4, hour)</span>
<a href="#l39.62"></a><span id="l39.62" class="difflineminus">-    + eventPath;</span>
<a href="#l39.63"></a><span id="l39.63" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 4, hour) +</span>
<a href="#l39.64"></a><span id="l39.64" class="difflineplus">+    eventPath;</span>
<a href="#l39.65"></a><span id="l39.65">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.66"></a><span id="l39.66"> </span>
<a href="#l39.67"></a><span id="l39.67">   // check multiweek view</span>
<a href="#l39.68"></a><span id="l39.68">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l39.69"></a><span id="l39.69">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l39.70"></a><span id="l39.70">   checkMultiWeekView(&quot;multiweek&quot;);</span>
<a href="#l39.71"></a><span id="l39.71"> </span>
<a href="#l39.72"></a><span id="l39.72">   // check month view</span>
<a href="#l39.73"></a><span id="l39.73">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l39.74"></a><span id="l39.74">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l39.75"></a><span id="l39.75">   checkMultiWeekView(&quot;month&quot;);</span>
<a href="#l39.76"></a><span id="l39.76"> </span>
<a href="#l39.77"></a><span id="l39.77">   // delete event</span>
<a href="#l39.78"></a><span id="l39.78" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 2, undefined)</span>
<a href="#l39.79"></a><span id="l39.79" class="difflineminus">-    + eventPath;</span>
<a href="#l39.80"></a><span id="l39.80" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 2, undefined) +</span>
<a href="#l39.81"></a><span id="l39.81" class="difflineplus">+    eventPath;</span>
<a href="#l39.82"></a><span id="l39.82">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.83"></a><span id="l39.83">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l39.84"></a><span id="l39.84">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l39.85"></a><span id="l39.85">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l39.86"></a><span id="l39.86">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.87"></a><span id="l39.87"> };</span>
<a href="#l39.88"></a><span id="l39.88"> </span>
<a href="#l39.89"></a><span id="l39.89"> function setRecurrence(recurrence) {</span>
<a href="#l39.90"></a><span id="l39.90" class="difflineat">@@ -114,67 +114,67 @@ function setRecurrence(recurrence) {</span>
<a href="#l39.91"></a><span id="l39.91">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l39.92"></a><span id="l39.92">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l39.93"></a><span id="l39.93">   recurrence.sleep(sleep);</span>
<a href="#l39.94"></a><span id="l39.94"> </span>
<a href="#l39.95"></a><span id="l39.95">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l39.96"></a><span id="l39.96">   let wed = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.4.Mmm&quot;);</span>
<a href="#l39.97"></a><span id="l39.97">   let fri = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.6.Mmm&quot;);</span>
<a href="#l39.98"></a><span id="l39.98"> </span>
<a href="#l39.99"></a><span id="l39.99" class="difflineminus">-  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/'</span>
<a href="#l39.100"></a><span id="l39.100" class="difflineminus">-    + 'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/'</span>
<a href="#l39.101"></a><span id="l39.101" class="difflineminus">-    + 'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l39.102"></a><span id="l39.102" class="difflineplus">+  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/' +</span>
<a href="#l39.103"></a><span id="l39.103" class="difflineplus">+    'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/' +</span>
<a href="#l39.104"></a><span id="l39.104" class="difflineplus">+    'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l39.105"></a><span id="l39.105"> </span>
<a href="#l39.106"></a><span id="l39.106">   // starting from Monday so it should be checked</span>
<a href="#l39.107"></a><span id="l39.107">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + mon + '&quot;}'));</span>
<a href="#l39.108"></a><span id="l39.108">   // check Wednesday and Friday too</span>
<a href="#l39.109"></a><span id="l39.109">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + wed + '&quot;}'));</span>
<a href="#l39.110"></a><span id="l39.110">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + fri + '&quot;}'));</span>
<a href="#l39.111"></a><span id="l39.111"> </span>
<a href="#l39.112"></a><span id="l39.112">   // set until date</span>
<a href="#l39.113"></a><span id="l39.113">   recurrence.click(new elementslib.ID(recurrence.window.document, &quot;recurrence-range-until&quot;));</span>
<a href="#l39.114"></a><span id="l39.114" class="difflineminus">-  let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/'</span>
<a href="#l39.115"></a><span id="l39.115" class="difflineminus">-    + 'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-until-box&quot;)/id(&quot;repeat-until-date&quot;)/'</span>
<a href="#l39.116"></a><span id="l39.116" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/{&quot;class&quot;:&quot;datepicker-text-class&quot;}/'</span>
<a href="#l39.117"></a><span id="l39.117" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l39.118"></a><span id="l39.118" class="difflineplus">+  let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/' +</span>
<a href="#l39.119"></a><span id="l39.119" class="difflineplus">+    'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-until-box&quot;)/id(&quot;repeat-until-date&quot;)/' +</span>
<a href="#l39.120"></a><span id="l39.120" class="difflineplus">+    'anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/{&quot;class&quot;:&quot;datepicker-text-class&quot;}/' +</span>
<a href="#l39.121"></a><span id="l39.121" class="difflineplus">+    'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l39.122"></a><span id="l39.122">   // delete previous date</span>
<a href="#l39.123"></a><span id="l39.123">   recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l39.124"></a><span id="l39.124">   recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;VK_DELETE&quot;, {});</span>
<a href="#l39.125"></a><span id="l39.125"> </span>
<a href="#l39.126"></a><span id="l39.126">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l39.127"></a><span id="l39.127">                      .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l39.128"></a><span id="l39.128">   let endDateString = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l39.129"></a><span id="l39.129">                                              endDate.getFullYear(), endDate.getMonth() + 1, endDate.getDate());</span>
<a href="#l39.130"></a><span id="l39.130">   recurrence.type(new elementslib.Lookup(recurrence.window.document, input), endDateString);</span>
<a href="#l39.131"></a><span id="l39.131"> </span>
<a href="#l39.132"></a><span id="l39.132">   // close dialog</span>
<a href="#l39.133"></a><span id="l39.133" class="difflineminus">-  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l39.134"></a><span id="l39.134" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l39.135"></a><span id="l39.135" class="difflineplus">+  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/' +</span>
<a href="#l39.136"></a><span id="l39.136" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l39.137"></a><span id="l39.137"> }</span>
<a href="#l39.138"></a><span id="l39.138"> </span>
<a href="#l39.139"></a><span id="l39.139"> function checkMultiWeekView(view) {</span>
<a href="#l39.140"></a><span id="l39.140">   let startWeek = 1;</span>
<a href="#l39.141"></a><span id="l39.141"> </span>
<a href="#l39.142"></a><span id="l39.142">   // in month view event starts from 2nd row</span>
<a href="#l39.143"></a><span id="l39.143">   if (view == &quot;month&quot;) {</span>
<a href="#l39.144"></a><span id="l39.144">     startWeek++;</span>
<a href="#l39.145"></a><span id="l39.145">   }</span>
<a href="#l39.146"></a><span id="l39.146"> </span>
<a href="#l39.147"></a><span id="l39.147">   for (let week = startWeek; week &lt; startWeek + 3; week++) {</span>
<a href="#l39.148"></a><span id="l39.148">     // Monday</span>
<a href="#l39.149"></a><span id="l39.149" class="difflineminus">-    let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 2, undefined)</span>
<a href="#l39.150"></a><span id="l39.150" class="difflineminus">-      + eventPath;</span>
<a href="#l39.151"></a><span id="l39.151" class="difflineplus">+    let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 2, undefined) +</span>
<a href="#l39.152"></a><span id="l39.152" class="difflineplus">+      eventPath;</span>
<a href="#l39.153"></a><span id="l39.153">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.154"></a><span id="l39.154">     // Wednesday</span>
<a href="#l39.155"></a><span id="l39.155" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 4, undefined)</span>
<a href="#l39.156"></a><span id="l39.156" class="difflineminus">-      + eventPath;</span>
<a href="#l39.157"></a><span id="l39.157" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 4, undefined) +</span>
<a href="#l39.158"></a><span id="l39.158" class="difflineplus">+      eventPath;</span>
<a href="#l39.159"></a><span id="l39.159">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.160"></a><span id="l39.160">     // Friday</span>
<a href="#l39.161"></a><span id="l39.161" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 6, undefined)</span>
<a href="#l39.162"></a><span id="l39.162" class="difflineminus">-      + eventPath;</span>
<a href="#l39.163"></a><span id="l39.163" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 6, undefined) +</span>
<a href="#l39.164"></a><span id="l39.164" class="difflineplus">+      eventPath;</span>
<a href="#l39.165"></a><span id="l39.165">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.166"></a><span id="l39.166">   }</span>
<a href="#l39.167"></a><span id="l39.167"> </span>
<a href="#l39.168"></a><span id="l39.168">   // Monday, last occurrence</span>
<a href="#l39.169"></a><span id="l39.169">   let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek + 3, 2,</span>
<a href="#l39.170"></a><span id="l39.170">     undefined) + eventPath;</span>
<a href="#l39.171"></a><span id="l39.171">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l39.172"></a><span id="l39.172">   // Wednesday</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -34,34 +34,34 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l40.4"></a><span id="l40.4">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l40.5"></a><span id="l40.5"> </span>
<a href="#l40.6"></a><span id="l40.6">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l40.7"></a><span id="l40.7">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l40.8"></a><span id="l40.8"> </span>
<a href="#l40.9"></a><span id="l40.9">   // move 5th January occurrence to 6th January</span>
<a href="#l40.10"></a><span id="l40.10">   calUtils.handleOccurrenceModification(controller, false);</span>
<a href="#l40.11"></a><span id="l40.11">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineminus">-      + eventPath));</span>
<a href="#l40.14"></a><span id="l40.14" class="difflineplus">+    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l40.15"></a><span id="l40.15" class="difflineplus">+      eventPath));</span>
<a href="#l40.16"></a><span id="l40.16">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l40.17"></a><span id="l40.17">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l40.18"></a><span id="l40.18">   event.sleep(sleep);</span>
<a href="#l40.19"></a><span id="l40.19"> </span>
<a href="#l40.20"></a><span id="l40.20" class="difflineminus">-  let startDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/'</span>
<a href="#l40.21"></a><span id="l40.21" class="difflineminus">-    + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-startdate-row&quot;)/'</span>
<a href="#l40.22"></a><span id="l40.22" class="difflineminus">-    + 'id(&quot;event-grid-startdate-picker-box&quot;)/id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/'</span>
<a href="#l40.23"></a><span id="l40.23" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l40.24"></a><span id="l40.24" class="difflineminus">-    + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l40.25"></a><span id="l40.25" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l40.26"></a><span id="l40.26" class="difflineminus">-  let endDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/'</span>
<a href="#l40.27"></a><span id="l40.27" class="difflineminus">-    + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-enddate-row&quot;)/[1]/'</span>
<a href="#l40.28"></a><span id="l40.28" class="difflineminus">-    + 'id(&quot;event-grid-enddate-picker-box&quot;)/id(&quot;event-endtime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/'</span>
<a href="#l40.29"></a><span id="l40.29" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l40.30"></a><span id="l40.30" class="difflineminus">-    + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l40.31"></a><span id="l40.31" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l40.32"></a><span id="l40.32" class="difflineplus">+  let startDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/' +</span>
<a href="#l40.33"></a><span id="l40.33" class="difflineplus">+    'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-startdate-row&quot;)/' +</span>
<a href="#l40.34"></a><span id="l40.34" class="difflineplus">+    'id(&quot;event-grid-startdate-picker-box&quot;)/id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/' +</span>
<a href="#l40.35"></a><span id="l40.35" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/' +</span>
<a href="#l40.36"></a><span id="l40.36" class="difflineplus">+    '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/' +</span>
<a href="#l40.37"></a><span id="l40.37" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l40.38"></a><span id="l40.38" class="difflineplus">+  let endDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/' +</span>
<a href="#l40.39"></a><span id="l40.39" class="difflineplus">+    'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-enddate-row&quot;)/[1]/' +</span>
<a href="#l40.40"></a><span id="l40.40" class="difflineplus">+    'id(&quot;event-grid-enddate-picker-box&quot;)/id(&quot;event-endtime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/' +</span>
<a href="#l40.41"></a><span id="l40.41" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/' +</span>
<a href="#l40.42"></a><span id="l40.42" class="difflineplus">+    '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/' +</span>
<a href="#l40.43"></a><span id="l40.43" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l40.44"></a><span id="l40.44"> </span>
<a href="#l40.45"></a><span id="l40.45">   event.keypress(startDateInput, &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l40.46"></a><span id="l40.46">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l40.47"></a><span id="l40.47">                      .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l40.48"></a><span id="l40.48">   let startDateString = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l40.49"></a><span id="l40.49">                                              startDate.getFullYear(), startDate.getMonth() + 1, startDate.getDate());</span>
<a href="#l40.50"></a><span id="l40.50">   event.type(startDateInput, startDateString);</span>
<a href="#l40.51"></a><span id="l40.51">   // applies startdate change</span>
<a href="#l40.52"></a><span id="l40.52" class="difflineat">@@ -69,44 +69,44 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l40.53"></a><span id="l40.53"> </span>
<a href="#l40.54"></a><span id="l40.54">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l40.55"></a><span id="l40.55">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l40.56"></a><span id="l40.56"> </span>
<a href="#l40.57"></a><span id="l40.57">   // change recurrence rule</span>
<a href="#l40.58"></a><span id="l40.58">   calUtils.goToDate(controller, 2009, 1, 7);</span>
<a href="#l40.59"></a><span id="l40.59">   calUtils.handleParentModification(controller, false);</span>
<a href="#l40.60"></a><span id="l40.60">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l40.61"></a><span id="l40.61" class="difflineminus">-    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l40.62"></a><span id="l40.62" class="difflineminus">-      + eventPath));</span>
<a href="#l40.63"></a><span id="l40.63" class="difflineplus">+    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l40.64"></a><span id="l40.64" class="difflineplus">+      eventPath));</span>
<a href="#l40.65"></a><span id="l40.65">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l40.66"></a><span id="l40.66">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l40.67"></a><span id="l40.67"> </span>
<a href="#l40.68"></a><span id="l40.68">   md = new modalDialog.modalDialog(event.window);</span>
<a href="#l40.69"></a><span id="l40.69">   md.start(changeRecurrence);</span>
<a href="#l40.70"></a><span id="l40.70">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l40.71"></a><span id="l40.71">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l40.72"></a><span id="l40.72"> </span>
<a href="#l40.73"></a><span id="l40.73">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l40.74"></a><span id="l40.74">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l40.75"></a><span id="l40.75"> </span>
<a href="#l40.76"></a><span id="l40.76">   // check two weeks</span>
<a href="#l40.77"></a><span id="l40.77">   // day view</span>
<a href="#l40.78"></a><span id="l40.78">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l40.79"></a><span id="l40.79" class="difflineminus">-  let path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l40.80"></a><span id="l40.80" class="difflineminus">-    + eventPath;</span>
<a href="#l40.81"></a><span id="l40.81" class="difflineplus">+  let path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l40.82"></a><span id="l40.82" class="difflineplus">+    eventPath;</span>
<a href="#l40.83"></a><span id="l40.83"> </span>
<a href="#l40.84"></a><span id="l40.84">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l40.85"></a><span id="l40.85">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l40.86"></a><span id="l40.86"> </span>
<a href="#l40.87"></a><span id="l40.87">   calUtils.forward(controller, 1);</span>
<a href="#l40.88"></a><span id="l40.88" class="difflineminus">-  let tuesPath = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/'</span>
<a href="#l40.89"></a><span id="l40.89" class="difflineminus">-    + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/'</span>
<a href="#l40.90"></a><span id="l40.90" class="difflineminus">-    + 'id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/'</span>
<a href="#l40.91"></a><span id="l40.91" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[0]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/'</span>
<a href="#l40.92"></a><span id="l40.92" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/[eventIndex]';</span>
<a href="#l40.93"></a><span id="l40.93" class="difflineplus">+  let tuesPath = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/' +</span>
<a href="#l40.94"></a><span id="l40.94" class="difflineplus">+    'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/' +</span>
<a href="#l40.95"></a><span id="l40.95" class="difflineplus">+    'id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/' +</span>
<a href="#l40.96"></a><span id="l40.96" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[0]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/' +</span>
<a href="#l40.97"></a><span id="l40.97" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/[eventIndex]';</span>
<a href="#l40.98"></a><span id="l40.98">   // assert exactly two</span>
<a href="#l40.99"></a><span id="l40.99">   controller.assertNode(new elementslib.Lookup(controller.window.document,</span>
<a href="#l40.100"></a><span id="l40.100">     tuesPath.replace(&quot;eventIndex&quot;, &quot;0&quot;) + eventPath));</span>
<a href="#l40.101"></a><span id="l40.101">   controller.assertNode(new elementslib.Lookup(controller.window.document,</span>
<a href="#l40.102"></a><span id="l40.102">     tuesPath.replace(&quot;eventIndex&quot;, &quot;1&quot;) + eventPath));</span>
<a href="#l40.103"></a><span id="l40.103">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document,</span>
<a href="#l40.104"></a><span id="l40.104">     tuesPath.replace(&quot;eventIndex&quot;, &quot;2&quot;) + eventPath));</span>
<a href="#l40.105"></a><span id="l40.105"> </span>
<a href="#l40.106"></a><span id="l40.106" class="difflineat">@@ -134,25 +134,25 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l40.107"></a><span id="l40.107">   controller.assertNode(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l40.108"></a><span id="l40.108">   calUtils.forward(controller, 1);</span>
<a href="#l40.109"></a><span id="l40.109">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l40.110"></a><span id="l40.110"> </span>
<a href="#l40.111"></a><span id="l40.111">   // week view</span>
<a href="#l40.112"></a><span id="l40.112">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l40.113"></a><span id="l40.113">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l40.114"></a><span id="l40.114"> </span>
<a href="#l40.115"></a><span id="l40.115" class="difflineminus">-  path = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour)</span>
<a href="#l40.116"></a><span id="l40.116" class="difflineminus">-    + eventPath;</span>
<a href="#l40.117"></a><span id="l40.117" class="difflineplus">+  path = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour) +</span>
<a href="#l40.118"></a><span id="l40.118" class="difflineplus">+    eventPath;</span>
<a href="#l40.119"></a><span id="l40.119">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l40.120"></a><span id="l40.120"> </span>
<a href="#l40.121"></a><span id="l40.121" class="difflineminus">-  tuesPath = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/'</span>
<a href="#l40.122"></a><span id="l40.122" class="difflineminus">-    + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/'</span>
<a href="#l40.123"></a><span id="l40.123" class="difflineminus">-    + 'id(&quot;view-deck&quot;)/id(&quot;week-view&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/'</span>
<a href="#l40.124"></a><span id="l40.124" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[dayIndex]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/'</span>
<a href="#l40.125"></a><span id="l40.125" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/[eventIndex]';</span>
<a href="#l40.126"></a><span id="l40.126" class="difflineplus">+  tuesPath = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/' +</span>
<a href="#l40.127"></a><span id="l40.127" class="difflineplus">+    'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/' +</span>
<a href="#l40.128"></a><span id="l40.128" class="difflineplus">+    'id(&quot;view-deck&quot;)/id(&quot;week-view&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/' +</span>
<a href="#l40.129"></a><span id="l40.129" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[dayIndex]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/' +</span>
<a href="#l40.130"></a><span id="l40.130" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/[eventIndex]';</span>
<a href="#l40.131"></a><span id="l40.131">   // assert exactly two</span>
<a href="#l40.132"></a><span id="l40.132">   controller.assertNode(new elementslib.Lookup(controller.window.document,</span>
<a href="#l40.133"></a><span id="l40.133">     tuesPath.replace(&quot;dayIndex&quot;, &quot;2&quot;).replace(&quot;eventIndex&quot;, &quot;0&quot;) + eventPath));</span>
<a href="#l40.134"></a><span id="l40.134">   controller.assertNode(new elementslib.Lookup(controller.window.document,</span>
<a href="#l40.135"></a><span id="l40.135">     tuesPath.replace(&quot;dayIndex&quot;, &quot;2&quot;).replace(&quot;eventIndex&quot;, &quot;1&quot;) + eventPath));</span>
<a href="#l40.136"></a><span id="l40.136">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document,</span>
<a href="#l40.137"></a><span id="l40.137">     tuesPath.replace(&quot;dayIndex&quot;, &quot;2&quot;).replace(&quot;eventIndex&quot;, &quot;2&quot;) + eventPath));</span>
<a href="#l40.138"></a><span id="l40.138"> </span>
<a href="#l40.139"></a><span id="l40.139" class="difflineat">@@ -188,18 +188,18 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l40.140"></a><span id="l40.140"> </span>
<a href="#l40.141"></a><span id="l40.141">   // month view</span>
<a href="#l40.142"></a><span id="l40.142">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l40.143"></a><span id="l40.143">   checkMultiWeekView(&quot;month&quot;);</span>
<a href="#l40.144"></a><span id="l40.144"> </span>
<a href="#l40.145"></a><span id="l40.145">   // delete event</span>
<a href="#l40.146"></a><span id="l40.146">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l40.147"></a><span id="l40.147">   calUtils.goToDate(controller, 2009, 1, 12);</span>
<a href="#l40.148"></a><span id="l40.148" class="difflineminus">-  path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l40.149"></a><span id="l40.149" class="difflineminus">-    + eventPath;</span>
<a href="#l40.150"></a><span id="l40.150" class="difflineplus">+  path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l40.151"></a><span id="l40.151" class="difflineplus">+    eventPath;</span>
<a href="#l40.152"></a><span id="l40.152">   controller.click(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l40.153"></a><span id="l40.153">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l40.154"></a><span id="l40.154">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l40.155"></a><span id="l40.155">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l40.156"></a><span id="l40.156">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l40.157"></a><span id="l40.157"> };</span>
<a href="#l40.158"></a><span id="l40.158"> </span>
<a href="#l40.159"></a><span id="l40.159"> function setRecurrence(recurrence) {</span>
<a href="#l40.160"></a><span id="l40.160" class="difflineat">@@ -207,57 +207,57 @@ function setRecurrence(recurrence) {</span>
<a href="#l40.161"></a><span id="l40.161">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l40.162"></a><span id="l40.162">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l40.163"></a><span id="l40.163">   recurrence.sleep(sleep);</span>
<a href="#l40.164"></a><span id="l40.164"> </span>
<a href="#l40.165"></a><span id="l40.165">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l40.166"></a><span id="l40.166">   let wed = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.4.Mmm&quot;);</span>
<a href="#l40.167"></a><span id="l40.167">   let fri = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.6.Mmm&quot;);</span>
<a href="#l40.168"></a><span id="l40.168"> </span>
<a href="#l40.169"></a><span id="l40.169" class="difflineminus">-  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/'</span>
<a href="#l40.170"></a><span id="l40.170" class="difflineminus">-    + 'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/'</span>
<a href="#l40.171"></a><span id="l40.171" class="difflineminus">-    + 'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l40.172"></a><span id="l40.172" class="difflineplus">+  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/' +</span>
<a href="#l40.173"></a><span id="l40.173" class="difflineplus">+    'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/' +</span>
<a href="#l40.174"></a><span id="l40.174" class="difflineplus">+    'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l40.175"></a><span id="l40.175"> </span>
<a href="#l40.176"></a><span id="l40.176">   // starting from Monday so it should be checked</span>
<a href="#l40.177"></a><span id="l40.177">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + mon + '&quot;}'));</span>
<a href="#l40.178"></a><span id="l40.178">   // check Wednesday and Friday too</span>
<a href="#l40.179"></a><span id="l40.179">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + wed + '&quot;}'));</span>
<a href="#l40.180"></a><span id="l40.180">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + fri + '&quot;}'));</span>
<a href="#l40.181"></a><span id="l40.181"> </span>
<a href="#l40.182"></a><span id="l40.182">   // close dialog</span>
<a href="#l40.183"></a><span id="l40.183" class="difflineminus">-  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l40.184"></a><span id="l40.184" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l40.185"></a><span id="l40.185" class="difflineplus">+  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/' +</span>
<a href="#l40.186"></a><span id="l40.186" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l40.187"></a><span id="l40.187"> }</span>
<a href="#l40.188"></a><span id="l40.188"> </span>
<a href="#l40.189"></a><span id="l40.189"> function changeRecurrence(recurrence) {</span>
<a href="#l40.190"></a><span id="l40.190">   // weekly</span>
<a href="#l40.191"></a><span id="l40.191">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l40.192"></a><span id="l40.192">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l40.193"></a><span id="l40.193">   recurrence.sleep(sleep);</span>
<a href="#l40.194"></a><span id="l40.194"> </span>
<a href="#l40.195"></a><span id="l40.195">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l40.196"></a><span id="l40.196">   let tue = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.3.Mmm&quot;);</span>
<a href="#l40.197"></a><span id="l40.197">   let wed = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.4.Mmm&quot;);</span>
<a href="#l40.198"></a><span id="l40.198">   let fri = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.6.Mmm&quot;);</span>
<a href="#l40.199"></a><span id="l40.199"> </span>
<a href="#l40.200"></a><span id="l40.200" class="difflineminus">-  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/'</span>
<a href="#l40.201"></a><span id="l40.201" class="difflineminus">-    + 'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/'</span>
<a href="#l40.202"></a><span id="l40.202" class="difflineminus">-    + 'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l40.203"></a><span id="l40.203" class="difflineplus">+  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/' +</span>
<a href="#l40.204"></a><span id="l40.204" class="difflineplus">+    'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/' +</span>
<a href="#l40.205"></a><span id="l40.205" class="difflineplus">+    'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l40.206"></a><span id="l40.206"> </span>
<a href="#l40.207"></a><span id="l40.207">   // check old rule</span>
<a href="#l40.208"></a><span id="l40.208">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + mon + '&quot;}'));</span>
<a href="#l40.209"></a><span id="l40.209">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + wed + '&quot;}'));</span>
<a href="#l40.210"></a><span id="l40.210">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + fri + '&quot;}'));</span>
<a href="#l40.211"></a><span id="l40.211"> </span>
<a href="#l40.212"></a><span id="l40.212">   // check Tuesday</span>
<a href="#l40.213"></a><span id="l40.213">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + tue + '&quot;}'));</span>
<a href="#l40.214"></a><span id="l40.214"> </span>
<a href="#l40.215"></a><span id="l40.215">   // close dialog</span>
<a href="#l40.216"></a><span id="l40.216" class="difflineminus">-  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l40.217"></a><span id="l40.217" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l40.218"></a><span id="l40.218" class="difflineplus">+  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/' +</span>
<a href="#l40.219"></a><span id="l40.219" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l40.220"></a><span id="l40.220"> }</span>
<a href="#l40.221"></a><span id="l40.221"> </span>
<a href="#l40.222"></a><span id="l40.222"> function checkMultiWeekView(view) {</span>
<a href="#l40.223"></a><span id="l40.223">   let startWeek = view == &quot;multiweek&quot; ? 1 : 2;</span>
<a href="#l40.224"></a><span id="l40.224"> </span>
<a href="#l40.225"></a><span id="l40.225">   let path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 2, hour);</span>
<a href="#l40.226"></a><span id="l40.226">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l40.227"></a><span id="l40.227">   // assert exactly two</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -44,44 +44,44 @@ var testAnnualRecurrence = function() {</span>
<a href="#l41.4"></a><span id="l41.4">   let box = &quot;&quot;;</span>
<a href="#l41.5"></a><span id="l41.5">   for (let i = 0; i &lt; checkYears.length; i++) {</span>
<a href="#l41.6"></a><span id="l41.6">     calUtils.goToDate(controller, checkYears[i], 1, 1);</span>
<a href="#l41.7"></a><span id="l41.7">     let date = new Date(checkYears[i], 0, 1);</span>
<a href="#l41.8"></a><span id="l41.8">     let column = date.getDay() + 1;</span>
<a href="#l41.9"></a><span id="l41.9"> </span>
<a href="#l41.10"></a><span id="l41.10">     // day view</span>
<a href="#l41.11"></a><span id="l41.11">     calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined)</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineminus">-      + eventPath;</span>
<a href="#l41.14"></a><span id="l41.14" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined) +</span>
<a href="#l41.15"></a><span id="l41.15" class="difflineplus">+      eventPath;</span>
<a href="#l41.16"></a><span id="l41.16">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l41.17"></a><span id="l41.17"> </span>
<a href="#l41.18"></a><span id="l41.18">     // week view</span>
<a href="#l41.19"></a><span id="l41.19">     calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l41.20"></a><span id="l41.20" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.ALLDAY, undefined, column, undefined)</span>
<a href="#l41.21"></a><span id="l41.21" class="difflineminus">-      + eventPath;</span>
<a href="#l41.22"></a><span id="l41.22" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.ALLDAY, undefined, column, undefined) +</span>
<a href="#l41.23"></a><span id="l41.23" class="difflineplus">+      eventPath;</span>
<a href="#l41.24"></a><span id="l41.24">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l41.25"></a><span id="l41.25"> </span>
<a href="#l41.26"></a><span id="l41.26">     // multiweek view</span>
<a href="#l41.27"></a><span id="l41.27">     calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l41.28"></a><span id="l41.28" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.ALLDAY, 1, column, undefined)</span>
<a href="#l41.29"></a><span id="l41.29" class="difflineminus">-      + eventPath;</span>
<a href="#l41.30"></a><span id="l41.30" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.ALLDAY, 1, column, undefined) +</span>
<a href="#l41.31"></a><span id="l41.31" class="difflineplus">+      eventPath;</span>
<a href="#l41.32"></a><span id="l41.32">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l41.33"></a><span id="l41.33"> </span>
<a href="#l41.34"></a><span id="l41.34">     // month view</span>
<a href="#l41.35"></a><span id="l41.35">     calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l41.36"></a><span id="l41.36" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.ALLDAY, 1, column, undefined)</span>
<a href="#l41.37"></a><span id="l41.37" class="difflineminus">-      + eventPath;</span>
<a href="#l41.38"></a><span id="l41.38" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.ALLDAY, 1, column, undefined) +</span>
<a href="#l41.39"></a><span id="l41.39" class="difflineplus">+      eventPath;</span>
<a href="#l41.40"></a><span id="l41.40">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l41.41"></a><span id="l41.41">   }</span>
<a href="#l41.42"></a><span id="l41.42"> </span>
<a href="#l41.43"></a><span id="l41.43">   // delete event</span>
<a href="#l41.44"></a><span id="l41.44">   calUtils.goToDate(controller, checkYears[0], 1, 1);</span>
<a href="#l41.45"></a><span id="l41.45">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l41.46"></a><span id="l41.46" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined)</span>
<a href="#l41.47"></a><span id="l41.47" class="difflineminus">-    + eventPath;</span>
<a href="#l41.48"></a><span id="l41.48" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined) +</span>
<a href="#l41.49"></a><span id="l41.49" class="difflineplus">+    eventPath;</span>
<a href="#l41.50"></a><span id="l41.50">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l41.51"></a><span id="l41.51">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l41.52"></a><span id="l41.52">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l41.53"></a><span id="l41.53">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l41.54"></a><span id="l41.54">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l41.55"></a><span id="l41.55"> </span>
<a href="#l41.56"></a><span id="l41.56">   // reset view</span>
<a href="#l41.57"></a><span id="l41.57">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -33,31 +33,31 @@ var testBiweeklyRecurrence = function() </span>
<a href="#l42.4"></a><span id="l42.4">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l42.5"></a><span id="l42.5">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l42.6"></a><span id="l42.6"> </span>
<a href="#l42.7"></a><span id="l42.7">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l42.8"></a><span id="l42.8">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;bi.weekly&quot;);</span>
<a href="#l42.9"></a><span id="l42.9">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l42.10"></a><span id="l42.10">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l42.11"></a><span id="l42.11"> </span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineminus">-    + eventPath;</span>
<a href="#l42.14"></a><span id="l42.14" class="difflineplus">+  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l42.15"></a><span id="l42.15" class="difflineplus">+    eventPath;</span>
<a href="#l42.16"></a><span id="l42.16"> </span>
<a href="#l42.17"></a><span id="l42.17">   // check day view</span>
<a href="#l42.18"></a><span id="l42.18">   for (let i = 0; i &lt; 4; i++) {</span>
<a href="#l42.19"></a><span id="l42.19">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l42.20"></a><span id="l42.20">     calUtils.forward(controller, 14);</span>
<a href="#l42.21"></a><span id="l42.21">   }</span>
<a href="#l42.22"></a><span id="l42.22"> </span>
<a href="#l42.23"></a><span id="l42.23">   // check week view</span>
<a href="#l42.24"></a><span id="l42.24">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l42.25"></a><span id="l42.25">   calUtils.goToDate(controller, 2009, 1, 31);</span>
<a href="#l42.26"></a><span id="l42.26"> </span>
<a href="#l42.27"></a><span id="l42.27" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, hour)</span>
<a href="#l42.28"></a><span id="l42.28" class="difflineminus">-    + eventPath;</span>
<a href="#l42.29"></a><span id="l42.29" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, hour) +</span>
<a href="#l42.30"></a><span id="l42.30" class="difflineplus">+    eventPath;</span>
<a href="#l42.31"></a><span id="l42.31">   for (let i = 0; i &lt; 4; i++) {</span>
<a href="#l42.32"></a><span id="l42.32">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l42.33"></a><span id="l42.33">     calUtils.forward(2);</span>
<a href="#l42.34"></a><span id="l42.34">   }</span>
<a href="#l42.35"></a><span id="l42.35"> </span>
<a href="#l42.36"></a><span id="l42.36">   // check multiweek view</span>
<a href="#l42.37"></a><span id="l42.37">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l42.38"></a><span id="l42.38">   calUtils.goToDate(controller, 2009, 1, 31);</span>
<a href="#l42.39"></a><span id="l42.39" class="difflineat">@@ -73,36 +73,36 @@ var testBiweeklyRecurrence = function() </span>
<a href="#l42.40"></a><span id="l42.40">     calUtils.forward(controller, 1);</span>
<a href="#l42.41"></a><span id="l42.41">   }</span>
<a href="#l42.42"></a><span id="l42.42"> </span>
<a href="#l42.43"></a><span id="l42.43">   // check month view</span>
<a href="#l42.44"></a><span id="l42.44">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l42.45"></a><span id="l42.45">   calUtils.goToDate(controller, 2009, 1, 31);</span>
<a href="#l42.46"></a><span id="l42.46"> </span>
<a href="#l42.47"></a><span id="l42.47">   // January</span>
<a href="#l42.48"></a><span id="l42.48" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 5, 7, undefined)</span>
<a href="#l42.49"></a><span id="l42.49" class="difflineminus">-    + eventPath;</span>
<a href="#l42.50"></a><span id="l42.50" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 5, 7, undefined) +</span>
<a href="#l42.51"></a><span id="l42.51" class="difflineplus">+    eventPath;</span>
<a href="#l42.52"></a><span id="l42.52">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l42.53"></a><span id="l42.53">   calUtils.forward(controller, 1);</span>
<a href="#l42.54"></a><span id="l42.54"> </span>
<a href="#l42.55"></a><span id="l42.55">   // February</span>
<a href="#l42.56"></a><span id="l42.56" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 7, undefined)</span>
<a href="#l42.57"></a><span id="l42.57" class="difflineminus">-    + eventPath;</span>
<a href="#l42.58"></a><span id="l42.58" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 7, undefined) +</span>
<a href="#l42.59"></a><span id="l42.59" class="difflineplus">+    eventPath;</span>
<a href="#l42.60"></a><span id="l42.60">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l42.61"></a><span id="l42.61" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 4, 7, undefined)</span>
<a href="#l42.62"></a><span id="l42.62" class="difflineminus">-    + eventPath;</span>
<a href="#l42.63"></a><span id="l42.63" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 4, 7, undefined) +</span>
<a href="#l42.64"></a><span id="l42.64" class="difflineplus">+    eventPath;</span>
<a href="#l42.65"></a><span id="l42.65">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l42.66"></a><span id="l42.66">   calUtils.forward(controller, 1);</span>
<a href="#l42.67"></a><span id="l42.67"> </span>
<a href="#l42.68"></a><span id="l42.68">   // March</span>
<a href="#l42.69"></a><span id="l42.69" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 7, undefined)</span>
<a href="#l42.70"></a><span id="l42.70" class="difflineminus">-    + eventPath;</span>
<a href="#l42.71"></a><span id="l42.71" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 7, undefined) +</span>
<a href="#l42.72"></a><span id="l42.72" class="difflineplus">+    eventPath;</span>
<a href="#l42.73"></a><span id="l42.73">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l42.74"></a><span id="l42.74" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 4, 7, undefined)</span>
<a href="#l42.75"></a><span id="l42.75" class="difflineminus">-    + eventPath;</span>
<a href="#l42.76"></a><span id="l42.76" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 4, 7, undefined) +</span>
<a href="#l42.77"></a><span id="l42.77" class="difflineplus">+    eventPath;</span>
<a href="#l42.78"></a><span id="l42.78">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l42.79"></a><span id="l42.79"> </span>
<a href="#l42.80"></a><span id="l42.80">   // delete event</span>
<a href="#l42.81"></a><span id="l42.81">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l42.82"></a><span id="l42.82">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l42.83"></a><span id="l42.83">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l42.84"></a><span id="l42.84">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l42.85"></a><span id="l42.85">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -35,176 +35,176 @@ var testDailyRecurrence = function() {</span>
<a href="#l43.4"></a><span id="l43.4">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l43.5"></a><span id="l43.5"> </span>
<a href="#l43.6"></a><span id="l43.6">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l43.7"></a><span id="l43.7">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l43.8"></a><span id="l43.8">     &quot;daily&quot;);</span>
<a href="#l43.9"></a><span id="l43.9">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l43.10"></a><span id="l43.10"> </span>
<a href="#l43.11"></a><span id="l43.11">   // check day view for 7 days</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-  let daybox = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour, undefined)</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineminus">-    + eventPath;</span>
<a href="#l43.14"></a><span id="l43.14" class="difflineplus">+  let daybox = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour, undefined) +</span>
<a href="#l43.15"></a><span id="l43.15" class="difflineplus">+    eventPath;</span>
<a href="#l43.16"></a><span id="l43.16">   controller.waitForElement(new elementslib.Lookup(controller.window.document, daybox));</span>
<a href="#l43.17"></a><span id="l43.17"> </span>
<a href="#l43.18"></a><span id="l43.18">   for (let day = 1; day &lt;= 7; day++) {</span>
<a href="#l43.19"></a><span id="l43.19">     controller.assertNode(new elementslib.Lookup(controller.window.document, daybox));</span>
<a href="#l43.20"></a><span id="l43.20">     calUtils.forward(controller, 1);</span>
<a href="#l43.21"></a><span id="l43.21">   }</span>
<a href="#l43.22"></a><span id="l43.22"> </span>
<a href="#l43.23"></a><span id="l43.23">   // check week view for 2 weeks</span>
<a href="#l43.24"></a><span id="l43.24">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l43.25"></a><span id="l43.25">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l43.26"></a><span id="l43.26"> </span>
<a href="#l43.27"></a><span id="l43.27">   for (let day = 5; day &lt;= 7; day++) {</span>
<a href="#l43.28"></a><span id="l43.28" class="difflineminus">-    let weekbox = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, 1, day, hour)</span>
<a href="#l43.29"></a><span id="l43.29" class="difflineminus">-      + eventPath;</span>
<a href="#l43.30"></a><span id="l43.30" class="difflineplus">+    let weekbox = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, 1, day, hour) +</span>
<a href="#l43.31"></a><span id="l43.31" class="difflineplus">+      eventPath;</span>
<a href="#l43.32"></a><span id="l43.32">     controller.assertNode(new elementslib.Lookup(controller.window.document, weekbox));</span>
<a href="#l43.33"></a><span id="l43.33">   }</span>
<a href="#l43.34"></a><span id="l43.34"> </span>
<a href="#l43.35"></a><span id="l43.35">   calUtils.forward(controller, 1);</span>
<a href="#l43.36"></a><span id="l43.36"> </span>
<a href="#l43.37"></a><span id="l43.37">   for (let day = 1; day &lt;= 7; day++) {</span>
<a href="#l43.38"></a><span id="l43.38" class="difflineminus">-    let weekbox = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, 2, day, hour)</span>
<a href="#l43.39"></a><span id="l43.39" class="difflineminus">-      + eventPath;</span>
<a href="#l43.40"></a><span id="l43.40" class="difflineplus">+    let weekbox = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, 2, day, hour) +</span>
<a href="#l43.41"></a><span id="l43.41" class="difflineplus">+      eventPath;</span>
<a href="#l43.42"></a><span id="l43.42">     controller.assertNode(new elementslib.Lookup(controller.window.document, weekbox));</span>
<a href="#l43.43"></a><span id="l43.43">   }</span>
<a href="#l43.44"></a><span id="l43.44"> </span>
<a href="#l43.45"></a><span id="l43.45">   // check multiweek view for 4 weeks</span>
<a href="#l43.46"></a><span id="l43.46">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l43.47"></a><span id="l43.47">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l43.48"></a><span id="l43.48"> </span>
<a href="#l43.49"></a><span id="l43.49">   for (let day = 5; day &lt;= 7; day++) {</span>
<a href="#l43.50"></a><span id="l43.50" class="difflineminus">-    let mweekbox = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, day, hour)</span>
<a href="#l43.51"></a><span id="l43.51" class="difflineminus">-      + eventPath;</span>
<a href="#l43.52"></a><span id="l43.52" class="difflineplus">+    let mweekbox = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, day, hour) +</span>
<a href="#l43.53"></a><span id="l43.53" class="difflineplus">+      eventPath;</span>
<a href="#l43.54"></a><span id="l43.54">     controller.assertNode(new elementslib.Lookup(controller.window.document, mweekbox));</span>
<a href="#l43.55"></a><span id="l43.55">   }</span>
<a href="#l43.56"></a><span id="l43.56"> </span>
<a href="#l43.57"></a><span id="l43.57">   for (let week = 2; week &lt;= 4; week++) {</span>
<a href="#l43.58"></a><span id="l43.58">     for (let day = 1; day &lt;= 7; day++) {</span>
<a href="#l43.59"></a><span id="l43.59" class="difflineminus">-      let mweekbox = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, week, day, hour)</span>
<a href="#l43.60"></a><span id="l43.60" class="difflineminus">-        + eventPath;</span>
<a href="#l43.61"></a><span id="l43.61" class="difflineplus">+      let mweekbox = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, week, day, hour) +</span>
<a href="#l43.62"></a><span id="l43.62" class="difflineplus">+        eventPath;</span>
<a href="#l43.63"></a><span id="l43.63">       controller.assertNode(new elementslib.Lookup(controller.window.document, mweekbox));</span>
<a href="#l43.64"></a><span id="l43.64">     }</span>
<a href="#l43.65"></a><span id="l43.65">   }</span>
<a href="#l43.66"></a><span id="l43.66"> </span>
<a href="#l43.67"></a><span id="l43.67">   // check month view for all 5 weeks</span>
<a href="#l43.68"></a><span id="l43.68">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l43.69"></a><span id="l43.69">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l43.70"></a><span id="l43.70"> </span>
<a href="#l43.71"></a><span id="l43.71">   for (let day = 5; day &lt;= 7; day++) {</span>
<a href="#l43.72"></a><span id="l43.72" class="difflineminus">-    let mbox = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, day, undefined)</span>
<a href="#l43.73"></a><span id="l43.73" class="difflineminus">-      + eventPath;</span>
<a href="#l43.74"></a><span id="l43.74" class="difflineplus">+    let mbox = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, day, undefined) +</span>
<a href="#l43.75"></a><span id="l43.75" class="difflineplus">+      eventPath;</span>
<a href="#l43.76"></a><span id="l43.76">     controller.assertNode(new elementslib.Lookup(controller.window.document, mbox));</span>
<a href="#l43.77"></a><span id="l43.77">   }</span>
<a href="#l43.78"></a><span id="l43.78"> </span>
<a href="#l43.79"></a><span id="l43.79">   for (let week = 2; week &lt;= 5; week++) {</span>
<a href="#l43.80"></a><span id="l43.80">     for (let day = 1; day &lt;= 7; day++) {</span>
<a href="#l43.81"></a><span id="l43.81" class="difflineminus">-      let mbox = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, week, day, undefined)</span>
<a href="#l43.82"></a><span id="l43.82" class="difflineminus">-        + eventPath;</span>
<a href="#l43.83"></a><span id="l43.83" class="difflineplus">+      let mbox = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, week, day, undefined) +</span>
<a href="#l43.84"></a><span id="l43.84" class="difflineplus">+        eventPath;</span>
<a href="#l43.85"></a><span id="l43.85">       controller.assertNode(new elementslib.Lookup(controller.window.document, mbox));</span>
<a href="#l43.86"></a><span id="l43.86">     }</span>
<a href="#l43.87"></a><span id="l43.87">   }</span>
<a href="#l43.88"></a><span id="l43.88"> </span>
<a href="#l43.89"></a><span id="l43.89">   // delete 3rd January occurrence</span>
<a href="#l43.90"></a><span id="l43.90" class="difflineminus">-  let saturday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, 7, undefined)</span>
<a href="#l43.91"></a><span id="l43.91" class="difflineminus">-    + eventPath;</span>
<a href="#l43.92"></a><span id="l43.92" class="difflineplus">+  let saturday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, 7, undefined) +</span>
<a href="#l43.93"></a><span id="l43.93" class="difflineplus">+    eventPath;</span>
<a href="#l43.94"></a><span id="l43.94">   calUtils.handleOccurrenceDeletion(controller, false);</span>
<a href="#l43.95"></a><span id="l43.95">   controller.click(new elementslib.Lookup(controller.window.document, saturday));</span>
<a href="#l43.96"></a><span id="l43.96">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l43.97"></a><span id="l43.97">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l43.98"></a><span id="l43.98"> </span>
<a href="#l43.99"></a><span id="l43.99">   // verify in all views</span>
<a href="#l43.100"></a><span id="l43.100">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, saturday));</span>
<a href="#l43.101"></a><span id="l43.101"> </span>
<a href="#l43.102"></a><span id="l43.102">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l43.103"></a><span id="l43.103" class="difflineminus">-  saturday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, 7, undefined)</span>
<a href="#l43.104"></a><span id="l43.104" class="difflineminus">-    + eventPath;</span>
<a href="#l43.105"></a><span id="l43.105" class="difflineplus">+  saturday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, 7, undefined) +</span>
<a href="#l43.106"></a><span id="l43.106" class="difflineplus">+    eventPath;</span>
<a href="#l43.107"></a><span id="l43.107">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, saturday));</span>
<a href="#l43.108"></a><span id="l43.108"> </span>
<a href="#l43.109"></a><span id="l43.109">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l43.110"></a><span id="l43.110" class="difflineminus">-  saturday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, undefined)</span>
<a href="#l43.111"></a><span id="l43.111" class="difflineminus">-    + eventPath;</span>
<a href="#l43.112"></a><span id="l43.112" class="difflineplus">+  saturday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, undefined) +</span>
<a href="#l43.113"></a><span id="l43.113" class="difflineplus">+    eventPath;</span>
<a href="#l43.114"></a><span id="l43.114">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, saturday));</span>
<a href="#l43.115"></a><span id="l43.115"> </span>
<a href="#l43.116"></a><span id="l43.116">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l43.117"></a><span id="l43.117" class="difflineminus">-  saturday = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, undefined)</span>
<a href="#l43.118"></a><span id="l43.118" class="difflineminus">-    + eventPath;</span>
<a href="#l43.119"></a><span id="l43.119" class="difflineplus">+  saturday = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, undefined) +</span>
<a href="#l43.120"></a><span id="l43.120" class="difflineplus">+    eventPath;</span>
<a href="#l43.121"></a><span id="l43.121">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, saturday));</span>
<a href="#l43.122"></a><span id="l43.122"> </span>
<a href="#l43.123"></a><span id="l43.123">   // go to previous day to edit event to occur only on weekdays</span>
<a href="#l43.124"></a><span id="l43.124">   calUtils.back(controller, 1);</span>
<a href="#l43.125"></a><span id="l43.125"> </span>
<a href="#l43.126"></a><span id="l43.126">   calUtils.handleParentModification(controller, false);</span>
<a href="#l43.127"></a><span id="l43.127">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l43.128"></a><span id="l43.128" class="difflineminus">-    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l43.129"></a><span id="l43.129" class="difflineminus">-      + eventPath));</span>
<a href="#l43.130"></a><span id="l43.130" class="difflineplus">+    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l43.131"></a><span id="l43.131" class="difflineplus">+      eventPath));</span>
<a href="#l43.132"></a><span id="l43.132"> </span>
<a href="#l43.133"></a><span id="l43.133">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l43.134"></a><span id="l43.134">   event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l43.135"></a><span id="l43.135">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l43.136"></a><span id="l43.136"> </span>
<a href="#l43.137"></a><span id="l43.137">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l43.138"></a><span id="l43.138">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l43.139"></a><span id="l43.139">     &quot;every.weekday&quot;);</span>
<a href="#l43.140"></a><span id="l43.140">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l43.141"></a><span id="l43.141">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l43.142"></a><span id="l43.142"> </span>
<a href="#l43.143"></a><span id="l43.143">   // check day view for 7 days</span>
<a href="#l43.144"></a><span id="l43.144" class="difflineminus">-  let day = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, undefined)</span>
<a href="#l43.145"></a><span id="l43.145" class="difflineminus">-    + eventPath;</span>
<a href="#l43.146"></a><span id="l43.146" class="difflineplus">+  let day = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, undefined) +</span>
<a href="#l43.147"></a><span id="l43.147" class="difflineplus">+    eventPath;</span>
<a href="#l43.148"></a><span id="l43.148">   let dates = [[2009, 1, 3],</span>
<a href="#l43.149"></a><span id="l43.149">                [2009, 1, 4]];</span>
<a href="#l43.150"></a><span id="l43.150">   for (let i = 0; i &lt; dates.length; i++) {</span>
<a href="#l43.151"></a><span id="l43.151">     calUtils.goToDate(controller, dates[i][0], dates[i][1], dates[i][2]);</span>
<a href="#l43.152"></a><span id="l43.152">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l43.153"></a><span id="l43.153">   }</span>
<a href="#l43.154"></a><span id="l43.154"> </span>
<a href="#l43.155"></a><span id="l43.155">   // check week view for 2 weeks</span>
<a href="#l43.156"></a><span id="l43.156">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l43.157"></a><span id="l43.157">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l43.158"></a><span id="l43.158"> </span>
<a href="#l43.159"></a><span id="l43.159">   for (let i = 0; i &lt;= 1; i++) {</span>
<a href="#l43.160"></a><span id="l43.160" class="difflineminus">-    let weekday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 1, undefined)</span>
<a href="#l43.161"></a><span id="l43.161" class="difflineminus">-      + eventPath;</span>
<a href="#l43.162"></a><span id="l43.162" class="difflineplus">+    let weekday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 1, undefined) +</span>
<a href="#l43.163"></a><span id="l43.163" class="difflineplus">+      eventPath;</span>
<a href="#l43.164"></a><span id="l43.164">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, weekday));</span>
<a href="#l43.165"></a><span id="l43.165" class="difflineminus">-    weekday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, undefined)</span>
<a href="#l43.166"></a><span id="l43.166" class="difflineminus">-      + eventPath;</span>
<a href="#l43.167"></a><span id="l43.167" class="difflineplus">+    weekday = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, undefined) +</span>
<a href="#l43.168"></a><span id="l43.168" class="difflineplus">+      eventPath;</span>
<a href="#l43.169"></a><span id="l43.169">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, weekday));</span>
<a href="#l43.170"></a><span id="l43.170">     calUtils.forward(controller, 1);</span>
<a href="#l43.171"></a><span id="l43.171">   }</span>
<a href="#l43.172"></a><span id="l43.172"> </span>
<a href="#l43.173"></a><span id="l43.173">   // check multiweek view for 4 weeks</span>
<a href="#l43.174"></a><span id="l43.174">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l43.175"></a><span id="l43.175">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l43.176"></a><span id="l43.176"> </span>
<a href="#l43.177"></a><span id="l43.177">   for (let i = 1; i &lt;= 4; i++) {</span>
<a href="#l43.178"></a><span id="l43.178" class="difflineminus">-    let mweekday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, i, 1, undefined)</span>
<a href="#l43.179"></a><span id="l43.179" class="difflineminus">-      + eventPath;</span>
<a href="#l43.180"></a><span id="l43.180" class="difflineplus">+    let mweekday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, i, 1, undefined) +</span>
<a href="#l43.181"></a><span id="l43.181" class="difflineplus">+      eventPath;</span>
<a href="#l43.182"></a><span id="l43.182">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, mweekday));</span>
<a href="#l43.183"></a><span id="l43.183" class="difflineminus">-    mweekday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, i, 7, undefined)</span>
<a href="#l43.184"></a><span id="l43.184" class="difflineminus">-      + eventPath;</span>
<a href="#l43.185"></a><span id="l43.185" class="difflineplus">+    mweekday = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, i, 7, undefined) +</span>
<a href="#l43.186"></a><span id="l43.186" class="difflineplus">+      eventPath;</span>
<a href="#l43.187"></a><span id="l43.187">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, mweekday));</span>
<a href="#l43.188"></a><span id="l43.188">   }</span>
<a href="#l43.189"></a><span id="l43.189"> </span>
<a href="#l43.190"></a><span id="l43.190">   // check month view for all 5 weeks</span>
<a href="#l43.191"></a><span id="l43.191">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l43.192"></a><span id="l43.192">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l43.193"></a><span id="l43.193"> </span>
<a href="#l43.194"></a><span id="l43.194">   for (let i = 1; i &lt;= 5; i++) {</span>
<a href="#l43.195"></a><span id="l43.195" class="difflineminus">-    let mday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, i, 1, undefined)</span>
<a href="#l43.196"></a><span id="l43.196" class="difflineminus">-      + eventPath;</span>
<a href="#l43.197"></a><span id="l43.197" class="difflineplus">+    let mday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, i, 1, undefined) +</span>
<a href="#l43.198"></a><span id="l43.198" class="difflineplus">+      eventPath;</span>
<a href="#l43.199"></a><span id="l43.199">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, mday));</span>
<a href="#l43.200"></a><span id="l43.200" class="difflineminus">-    mday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, i, 7, undefined)</span>
<a href="#l43.201"></a><span id="l43.201" class="difflineminus">-      + eventPath;</span>
<a href="#l43.202"></a><span id="l43.202" class="difflineplus">+    mday = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, i, 7, undefined) +</span>
<a href="#l43.203"></a><span id="l43.203" class="difflineplus">+      eventPath;</span>
<a href="#l43.204"></a><span id="l43.204">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, mday));</span>
<a href="#l43.205"></a><span id="l43.205">   }</span>
<a href="#l43.206"></a><span id="l43.206"> </span>
<a href="#l43.207"></a><span id="l43.207">   // delete event</span>
<a href="#l43.208"></a><span id="l43.208" class="difflineminus">-  day = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, 5, undefined)</span>
<a href="#l43.209"></a><span id="l43.209" class="difflineminus">-    + eventPath;</span>
<a href="#l43.210"></a><span id="l43.210" class="difflineplus">+  day = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, 5, undefined) +</span>
<a href="#l43.211"></a><span id="l43.211" class="difflineplus">+    eventPath;</span>
<a href="#l43.212"></a><span id="l43.212">   controller.click(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l43.213"></a><span id="l43.213">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l43.214"></a><span id="l43.214">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l43.215"></a><span id="l43.215">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l43.216"></a><span id="l43.216">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l43.217"></a><span id="l43.217"> </span>
<a href="#l43.218"></a><span id="l43.218">   // reset view</span>
<a href="#l43.219"></a><span id="l43.219">   calUtils.switchToView(controller, &quot;day&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -63,32 +63,32 @@ var testLastDayOfMonthRecurrence = funct</span>
<a href="#l44.4"></a><span id="l44.4">   let box = &quot;&quot;;</span>
<a href="#l44.5"></a><span id="l44.5"> </span>
<a href="#l44.6"></a><span id="l44.6">   // check all dates</span>
<a href="#l44.7"></a><span id="l44.7">   for (let i = 0; i &lt; checkingData.length; i++) {</span>
<a href="#l44.8"></a><span id="l44.8">     calUtils.goToDate(controller, checkingData[i][0], checkingData[i][1], checkingData[i][2]);</span>
<a href="#l44.9"></a><span id="l44.9"> </span>
<a href="#l44.10"></a><span id="l44.10">     // day view</span>
<a href="#l44.11"></a><span id="l44.11">     calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineminus">-      + eventPath;</span>
<a href="#l44.14"></a><span id="l44.14" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l44.15"></a><span id="l44.15" class="difflineplus">+      eventPath;</span>
<a href="#l44.16"></a><span id="l44.16">     controller.waitForElement(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l44.17"></a><span id="l44.17"> </span>
<a href="#l44.18"></a><span id="l44.18">     // week view</span>
<a href="#l44.19"></a><span id="l44.19">     calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l44.20"></a><span id="l44.20">     let date = new Date(checkingData[i][0], checkingData[i][1] - 1, checkingData[i][2]);</span>
<a href="#l44.21"></a><span id="l44.21">     let column = date.getDay() + 1;</span>
<a href="#l44.22"></a><span id="l44.22" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, column, hour)</span>
<a href="#l44.23"></a><span id="l44.23" class="difflineminus">-      + eventPath;</span>
<a href="#l44.24"></a><span id="l44.24" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, column, hour) +</span>
<a href="#l44.25"></a><span id="l44.25" class="difflineplus">+      eventPath;</span>
<a href="#l44.26"></a><span id="l44.26">     controller.waitForElement(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l44.27"></a><span id="l44.27"> </span>
<a href="#l44.28"></a><span id="l44.28">     // multiweek view</span>
<a href="#l44.29"></a><span id="l44.29">     calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l44.30"></a><span id="l44.30" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, column, undefined)</span>
<a href="#l44.31"></a><span id="l44.31" class="difflineminus">-      + eventPath;</span>
<a href="#l44.32"></a><span id="l44.32" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;multiweek&quot;, calUtils.EVENT_BOX, 1, column, undefined) +</span>
<a href="#l44.33"></a><span id="l44.33" class="difflineplus">+      eventPath;</span>
<a href="#l44.34"></a><span id="l44.34">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l44.35"></a><span id="l44.35"> </span>
<a href="#l44.36"></a><span id="l44.36">     // month view</span>
<a href="#l44.37"></a><span id="l44.37">     calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l44.38"></a><span id="l44.38">     box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, checkingData[i][3],</span>
<a href="#l44.39"></a><span id="l44.39">       column, undefined) + eventPath;</span>
<a href="#l44.40"></a><span id="l44.40">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l44.41"></a><span id="l44.41">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -37,55 +37,55 @@ var testWeeklyNRecurrence = function() {</span>
<a href="#l45.4"></a><span id="l45.4">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l45.5"></a><span id="l45.5">   md.start(setRecurrence);</span>
<a href="#l45.6"></a><span id="l45.6">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l45.7"></a><span id="l45.7">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l45.8"></a><span id="l45.8"> </span>
<a href="#l45.9"></a><span id="l45.9">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l45.10"></a><span id="l45.10"> </span>
<a href="#l45.11"></a><span id="l45.11">   // check day view</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineminus">-    + eventPath;</span>
<a href="#l45.14"></a><span id="l45.14" class="difflineplus">+  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l45.15"></a><span id="l45.15" class="difflineplus">+    eventPath;</span>
<a href="#l45.16"></a><span id="l45.16"> </span>
<a href="#l45.17"></a><span id="l45.17">   // Monday, Tuesday, Wednesday, Thursday</span>
<a href="#l45.18"></a><span id="l45.18">   for (let i = 0; i &lt; 4; i++) {</span>
<a href="#l45.19"></a><span id="l45.19">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l45.20"></a><span id="l45.20">     calUtils.forward(controller, 1);</span>
<a href="#l45.21"></a><span id="l45.21">   }</span>
<a href="#l45.22"></a><span id="l45.22"> </span>
<a href="#l45.23"></a><span id="l45.23">   // Saturday</span>
<a href="#l45.24"></a><span id="l45.24">   calUtils.forward(controller, 1);</span>
<a href="#l45.25"></a><span id="l45.25">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l45.26"></a><span id="l45.26"> </span>
<a href="#l45.27"></a><span id="l45.27">   // check week view</span>
<a href="#l45.28"></a><span id="l45.28">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l45.29"></a><span id="l45.29"> </span>
<a href="#l45.30"></a><span id="l45.30">   // Monday, Tuesday, Wednesday, Thursday</span>
<a href="#l45.31"></a><span id="l45.31">   for (let i = 2; i &lt; 6; i++) {</span>
<a href="#l45.32"></a><span id="l45.32" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, i, hour)</span>
<a href="#l45.33"></a><span id="l45.33" class="difflineminus">-      + eventPath;</span>
<a href="#l45.34"></a><span id="l45.34" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, i, hour) +</span>
<a href="#l45.35"></a><span id="l45.35" class="difflineplus">+      eventPath;</span>
<a href="#l45.36"></a><span id="l45.36">     controller.waitForElement(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l45.37"></a><span id="l45.37">   }</span>
<a href="#l45.38"></a><span id="l45.38"> </span>
<a href="#l45.39"></a><span id="l45.39">   // Saturday</span>
<a href="#l45.40"></a><span id="l45.40" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, hour)</span>
<a href="#l45.41"></a><span id="l45.41" class="difflineminus">-    + eventPath;</span>
<a href="#l45.42"></a><span id="l45.42" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 7, hour) +</span>
<a href="#l45.43"></a><span id="l45.43" class="difflineplus">+    eventPath;</span>
<a href="#l45.44"></a><span id="l45.44">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l45.45"></a><span id="l45.45"> </span>
<a href="#l45.46"></a><span id="l45.46">   // check multiweek view</span>
<a href="#l45.47"></a><span id="l45.47">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l45.48"></a><span id="l45.48">   checkMultiWeekView(&quot;multiweek&quot;);</span>
<a href="#l45.49"></a><span id="l45.49"> </span>
<a href="#l45.50"></a><span id="l45.50">   // check month view</span>
<a href="#l45.51"></a><span id="l45.51">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l45.52"></a><span id="l45.52">   checkMultiWeekView(&quot;month&quot;);</span>
<a href="#l45.53"></a><span id="l45.53"> </span>
<a href="#l45.54"></a><span id="l45.54">   // delete event</span>
<a href="#l45.55"></a><span id="l45.55" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 2, hour)</span>
<a href="#l45.56"></a><span id="l45.56" class="difflineminus">-    + eventPath;</span>
<a href="#l45.57"></a><span id="l45.57" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 2, hour) +</span>
<a href="#l45.58"></a><span id="l45.58" class="difflineplus">+    eventPath;</span>
<a href="#l45.59"></a><span id="l45.59">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l45.60"></a><span id="l45.60">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l45.61"></a><span id="l45.61">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l45.62"></a><span id="l45.62">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l45.63"></a><span id="l45.63">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l45.64"></a><span id="l45.64"> </span>
<a href="#l45.65"></a><span id="l45.65">   // reset view</span>
<a href="#l45.66"></a><span id="l45.66">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l45.67"></a><span id="l45.67" class="difflineat">@@ -103,58 +103,58 @@ function setRecurrence(recurrence) {</span>
<a href="#l45.68"></a><span id="l45.68">   recurrence.sleep(sleep);</span>
<a href="#l45.69"></a><span id="l45.69"> </span>
<a href="#l45.70"></a><span id="l45.70">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l45.71"></a><span id="l45.71">   let tue = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.3.Mmm&quot;);</span>
<a href="#l45.72"></a><span id="l45.72">   let wed = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.4.Mmm&quot;);</span>
<a href="#l45.73"></a><span id="l45.73">   let thu = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.5.Mmm&quot;);</span>
<a href="#l45.74"></a><span id="l45.74">   let sat = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.7.Mmm&quot;);</span>
<a href="#l45.75"></a><span id="l45.75"> </span>
<a href="#l45.76"></a><span id="l45.76" class="difflineminus">-  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/'</span>
<a href="#l45.77"></a><span id="l45.77" class="difflineminus">-    + 'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/'</span>
<a href="#l45.78"></a><span id="l45.78" class="difflineminus">-    + 'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l45.79"></a><span id="l45.79" class="difflineplus">+  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/' +</span>
<a href="#l45.80"></a><span id="l45.80" class="difflineplus">+    'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/' +</span>
<a href="#l45.81"></a><span id="l45.81" class="difflineplus">+    'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l45.82"></a><span id="l45.82"> </span>
<a href="#l45.83"></a><span id="l45.83">   // starting from Monday so it should be checked</span>
<a href="#l45.84"></a><span id="l45.84">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + mon + '&quot;}'));</span>
<a href="#l45.85"></a><span id="l45.85">   // check Tuesday, Wednesday, Thursday and Saturday too</span>
<a href="#l45.86"></a><span id="l45.86">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + tue + '&quot;}'));</span>
<a href="#l45.87"></a><span id="l45.87">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + wed + '&quot;}'));</span>
<a href="#l45.88"></a><span id="l45.88">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + thu + '&quot;}'));</span>
<a href="#l45.89"></a><span id="l45.89">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + sat + '&quot;}'));</span>
<a href="#l45.90"></a><span id="l45.90"> </span>
<a href="#l45.91"></a><span id="l45.91">   // set number of occurrences</span>
<a href="#l45.92"></a><span id="l45.92">   recurrence.click(new elementslib.ID(recurrence.window.document, &quot;recurrence-range-for&quot;));</span>
<a href="#l45.93"></a><span id="l45.93" class="difflineminus">-  let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/'</span>
<a href="#l45.94"></a><span id="l45.94" class="difflineminus">-    + 'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-count-box&quot;)/id(&quot;repeat-ntimes-count&quot;)/'</span>
<a href="#l45.95"></a><span id="l45.95" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l45.96"></a><span id="l45.96" class="difflineplus">+  let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/' +</span>
<a href="#l45.97"></a><span id="l45.97" class="difflineplus">+    'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-count-box&quot;)/id(&quot;repeat-ntimes-count&quot;)/' +</span>
<a href="#l45.98"></a><span id="l45.98" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l45.99"></a><span id="l45.99">   // replace previous number</span>
<a href="#l45.100"></a><span id="l45.100">   recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l45.101"></a><span id="l45.101">   recurrence.type(new elementslib.Lookup(recurrence.window.document, input), &quot;4&quot;);</span>
<a href="#l45.102"></a><span id="l45.102"> </span>
<a href="#l45.103"></a><span id="l45.103">   // close dialog</span>
<a href="#l45.104"></a><span id="l45.104" class="difflineminus">-  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l45.105"></a><span id="l45.105" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l45.106"></a><span id="l45.106" class="difflineplus">+  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/' +</span>
<a href="#l45.107"></a><span id="l45.107" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l45.108"></a><span id="l45.108"> }</span>
<a href="#l45.109"></a><span id="l45.109"> </span>
<a href="#l45.110"></a><span id="l45.110"> function checkMultiWeekView(view) {</span>
<a href="#l45.111"></a><span id="l45.111">   let week = 1;</span>
<a href="#l45.112"></a><span id="l45.112"> </span>
<a href="#l45.113"></a><span id="l45.113">   // in month view event starts from 2nd row</span>
<a href="#l45.114"></a><span id="l45.114">   if (view == &quot;month&quot;) {</span>
<a href="#l45.115"></a><span id="l45.115">     week++;</span>
<a href="#l45.116"></a><span id="l45.116">   }</span>
<a href="#l45.117"></a><span id="l45.117"> </span>
<a href="#l45.118"></a><span id="l45.118">   // Monday, Tuesday, Wednesday, Thursday</span>
<a href="#l45.119"></a><span id="l45.119">   for (let i = 2; i &lt; 6; i++) {</span>
<a href="#l45.120"></a><span id="l45.120" class="difflineminus">-    let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, i, undefined)</span>
<a href="#l45.121"></a><span id="l45.121" class="difflineminus">-      + eventPath;</span>
<a href="#l45.122"></a><span id="l45.122" class="difflineplus">+    let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, i, undefined) +</span>
<a href="#l45.123"></a><span id="l45.123" class="difflineplus">+      eventPath;</span>
<a href="#l45.124"></a><span id="l45.124">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l45.125"></a><span id="l45.125">   }</span>
<a href="#l45.126"></a><span id="l45.126"> </span>
<a href="#l45.127"></a><span id="l45.127">   // Saturday</span>
<a href="#l45.128"></a><span id="l45.128" class="difflineminus">-  let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 7, undefined)</span>
<a href="#l45.129"></a><span id="l45.129" class="difflineminus">-    + eventPath;</span>
<a href="#l45.130"></a><span id="l45.130" class="difflineplus">+  let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 7, undefined) +</span>
<a href="#l45.131"></a><span id="l45.131" class="difflineplus">+    eventPath;</span>
<a href="#l45.132"></a><span id="l45.132">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l45.133"></a><span id="l45.133"> }</span>
<a href="#l45.134"></a><span id="l45.134"> </span>
<a href="#l45.135"></a><span id="l45.135"> var teardownTest = function(module) {</span>
<a href="#l45.136"></a><span id="l45.136">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l45.137"></a><span id="l45.137"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -38,18 +38,18 @@ var testWeeklyUntilRecurrence = function</span>
<a href="#l46.4"></a><span id="l46.4">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l46.5"></a><span id="l46.5">   md.start(setRecurrence);</span>
<a href="#l46.6"></a><span id="l46.6">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l46.7"></a><span id="l46.7">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l46.8"></a><span id="l46.8"> </span>
<a href="#l46.9"></a><span id="l46.9">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l46.10"></a><span id="l46.10">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l46.11"></a><span id="l46.11"> </span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineminus">-    + eventPath;</span>
<a href="#l46.14"></a><span id="l46.14" class="difflineplus">+  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l46.15"></a><span id="l46.15" class="difflineplus">+    eventPath;</span>
<a href="#l46.16"></a><span id="l46.16"> </span>
<a href="#l46.17"></a><span id="l46.17">   // check day view</span>
<a href="#l46.18"></a><span id="l46.18">   for (let week = 0; week &lt; 3; week++) {</span>
<a href="#l46.19"></a><span id="l46.19">     // Monday</span>
<a href="#l46.20"></a><span id="l46.20">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.21"></a><span id="l46.21">     calUtils.forward(controller, 2);</span>
<a href="#l46.22"></a><span id="l46.22">     // Wednesday</span>
<a href="#l46.23"></a><span id="l46.23">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.24"></a><span id="l46.24" class="difflineat">@@ -66,53 +66,53 @@ var testWeeklyUntilRecurrence = function</span>
<a href="#l46.25"></a><span id="l46.25">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.26"></a><span id="l46.26">   calUtils.forward(controller, 2);</span>
<a href="#l46.27"></a><span id="l46.27"> </span>
<a href="#l46.28"></a><span id="l46.28">   // check week view</span>
<a href="#l46.29"></a><span id="l46.29">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l46.30"></a><span id="l46.30">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l46.31"></a><span id="l46.31">   for (let week = 0; week &lt; 3; week++) {</span>
<a href="#l46.32"></a><span id="l46.32">     // Monday</span>
<a href="#l46.33"></a><span id="l46.33" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour)</span>
<a href="#l46.34"></a><span id="l46.34" class="difflineminus">-      + eventPath;</span>
<a href="#l46.35"></a><span id="l46.35" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour) +</span>
<a href="#l46.36"></a><span id="l46.36" class="difflineplus">+      eventPath;</span>
<a href="#l46.37"></a><span id="l46.37">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.38"></a><span id="l46.38">     // Wednesday</span>
<a href="#l46.39"></a><span id="l46.39" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 4, hour)</span>
<a href="#l46.40"></a><span id="l46.40" class="difflineminus">-      + eventPath;</span>
<a href="#l46.41"></a><span id="l46.41" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 4, hour) +</span>
<a href="#l46.42"></a><span id="l46.42" class="difflineplus">+      eventPath;</span>
<a href="#l46.43"></a><span id="l46.43">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.44"></a><span id="l46.44">     // Friday</span>
<a href="#l46.45"></a><span id="l46.45" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 6, hour)</span>
<a href="#l46.46"></a><span id="l46.46" class="difflineminus">-      + eventPath;</span>
<a href="#l46.47"></a><span id="l46.47" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 6, hour) +</span>
<a href="#l46.48"></a><span id="l46.48" class="difflineplus">+      eventPath;</span>
<a href="#l46.49"></a><span id="l46.49">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.50"></a><span id="l46.50"> </span>
<a href="#l46.51"></a><span id="l46.51">     calUtils.forward(controller, 1);</span>
<a href="#l46.52"></a><span id="l46.52">   }</span>
<a href="#l46.53"></a><span id="l46.53"> </span>
<a href="#l46.54"></a><span id="l46.54">   // Monday, last occurrence</span>
<a href="#l46.55"></a><span id="l46.55" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour)</span>
<a href="#l46.56"></a><span id="l46.56" class="difflineminus">-    + eventPath;</span>
<a href="#l46.57"></a><span id="l46.57" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour) +</span>
<a href="#l46.58"></a><span id="l46.58" class="difflineplus">+    eventPath;</span>
<a href="#l46.59"></a><span id="l46.59">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.60"></a><span id="l46.60">   // Wednesday</span>
<a href="#l46.61"></a><span id="l46.61" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 4, hour)</span>
<a href="#l46.62"></a><span id="l46.62" class="difflineminus">-    + eventPath;</span>
<a href="#l46.63"></a><span id="l46.63" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 4, hour) +</span>
<a href="#l46.64"></a><span id="l46.64" class="difflineplus">+    eventPath;</span>
<a href="#l46.65"></a><span id="l46.65">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.66"></a><span id="l46.66"> </span>
<a href="#l46.67"></a><span id="l46.67">   // check multiweek view</span>
<a href="#l46.68"></a><span id="l46.68">   calUtils.switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l46.69"></a><span id="l46.69">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l46.70"></a><span id="l46.70">   checkMultiWeekView(&quot;multiweek&quot;);</span>
<a href="#l46.71"></a><span id="l46.71"> </span>
<a href="#l46.72"></a><span id="l46.72">   // check month view</span>
<a href="#l46.73"></a><span id="l46.73">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l46.74"></a><span id="l46.74">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l46.75"></a><span id="l46.75">   checkMultiWeekView(&quot;month&quot;);</span>
<a href="#l46.76"></a><span id="l46.76"> </span>
<a href="#l46.77"></a><span id="l46.77">   // delete event</span>
<a href="#l46.78"></a><span id="l46.78" class="difflineminus">-  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 2, undefined)</span>
<a href="#l46.79"></a><span id="l46.79" class="difflineminus">-    + eventPath;</span>
<a href="#l46.80"></a><span id="l46.80" class="difflineplus">+  box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 2, undefined) +</span>
<a href="#l46.81"></a><span id="l46.81" class="difflineplus">+    eventPath;</span>
<a href="#l46.82"></a><span id="l46.82">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.83"></a><span id="l46.83">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l46.84"></a><span id="l46.84">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l46.85"></a><span id="l46.85">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l46.86"></a><span id="l46.86">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.87"></a><span id="l46.87"> </span>
<a href="#l46.88"></a><span id="l46.88">   // reset view</span>
<a href="#l46.89"></a><span id="l46.89">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l46.90"></a><span id="l46.90" class="difflineat">@@ -128,68 +128,68 @@ function setRecurrence(recurrence) {</span>
<a href="#l46.91"></a><span id="l46.91">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l46.92"></a><span id="l46.92">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l46.93"></a><span id="l46.93">   recurrence.sleep(sleep);</span>
<a href="#l46.94"></a><span id="l46.94"> </span>
<a href="#l46.95"></a><span id="l46.95">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l46.96"></a><span id="l46.96">   let wed = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.4.Mmm&quot;);</span>
<a href="#l46.97"></a><span id="l46.97">   let fri = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.6.Mmm&quot;);</span>
<a href="#l46.98"></a><span id="l46.98"> </span>
<a href="#l46.99"></a><span id="l46.99" class="difflineminus">-  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/'</span>
<a href="#l46.100"></a><span id="l46.100" class="difflineminus">-    + 'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/'</span>
<a href="#l46.101"></a><span id="l46.101" class="difflineminus">-    + 'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l46.102"></a><span id="l46.102" class="difflineplus">+  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/' +</span>
<a href="#l46.103"></a><span id="l46.103" class="difflineplus">+    'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/' +</span>
<a href="#l46.104"></a><span id="l46.104" class="difflineplus">+    'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l46.105"></a><span id="l46.105"> </span>
<a href="#l46.106"></a><span id="l46.106">   // starting from Monday so it should be checked</span>
<a href="#l46.107"></a><span id="l46.107">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + mon + '&quot;}'));</span>
<a href="#l46.108"></a><span id="l46.108">   // check Wednesday and Friday too</span>
<a href="#l46.109"></a><span id="l46.109">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + wed + '&quot;}'));</span>
<a href="#l46.110"></a><span id="l46.110">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + fri + '&quot;}'));</span>
<a href="#l46.111"></a><span id="l46.111"> </span>
<a href="#l46.112"></a><span id="l46.112">   // set until date</span>
<a href="#l46.113"></a><span id="l46.113">   recurrence.click(new elementslib.ID(recurrence.window.document, &quot;recurrence-range-until&quot;));</span>
<a href="#l46.114"></a><span id="l46.114" class="difflineminus">-  let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/'</span>
<a href="#l46.115"></a><span id="l46.115" class="difflineminus">-    + 'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-until-box&quot;)/id(&quot;repeat-until-date&quot;)/'</span>
<a href="#l46.116"></a><span id="l46.116" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/{&quot;class&quot;:&quot;datepicker-text-class&quot;}/'</span>
<a href="#l46.117"></a><span id="l46.117" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l46.118"></a><span id="l46.118" class="difflineplus">+  let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/' +</span>
<a href="#l46.119"></a><span id="l46.119" class="difflineplus">+    'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-until-box&quot;)/id(&quot;repeat-until-date&quot;)/' +</span>
<a href="#l46.120"></a><span id="l46.120" class="difflineplus">+    'anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/{&quot;class&quot;:&quot;datepicker-text-class&quot;}/' +</span>
<a href="#l46.121"></a><span id="l46.121" class="difflineplus">+    'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l46.122"></a><span id="l46.122">   // delete previous date</span>
<a href="#l46.123"></a><span id="l46.123">   recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l46.124"></a><span id="l46.124">   recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;VK_DELETE&quot;, {});</span>
<a href="#l46.125"></a><span id="l46.125"> </span>
<a href="#l46.126"></a><span id="l46.126">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l46.127"></a><span id="l46.127">                      .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l46.128"></a><span id="l46.128">   let endDateString = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l46.129"></a><span id="l46.129">                                              endDate.getFullYear(), endDate.getMonth() + 1, endDate.getDate());</span>
<a href="#l46.130"></a><span id="l46.130"> </span>
<a href="#l46.131"></a><span id="l46.131">   recurrence.type(new elementslib.Lookup(recurrence.window.document, input), endDateString);</span>
<a href="#l46.132"></a><span id="l46.132"> </span>
<a href="#l46.133"></a><span id="l46.133">   // close dialog</span>
<a href="#l46.134"></a><span id="l46.134" class="difflineminus">-  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l46.135"></a><span id="l46.135" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l46.136"></a><span id="l46.136" class="difflineplus">+  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/' +</span>
<a href="#l46.137"></a><span id="l46.137" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l46.138"></a><span id="l46.138"> }</span>
<a href="#l46.139"></a><span id="l46.139"> </span>
<a href="#l46.140"></a><span id="l46.140"> function checkMultiWeekView(view) {</span>
<a href="#l46.141"></a><span id="l46.141">   let startWeek = 1;</span>
<a href="#l46.142"></a><span id="l46.142"> </span>
<a href="#l46.143"></a><span id="l46.143">   // in month view event starts from 2nd row</span>
<a href="#l46.144"></a><span id="l46.144">   if (view == &quot;month&quot;) {</span>
<a href="#l46.145"></a><span id="l46.145">     startWeek++;</span>
<a href="#l46.146"></a><span id="l46.146">   }</span>
<a href="#l46.147"></a><span id="l46.147"> </span>
<a href="#l46.148"></a><span id="l46.148">   for (let week = startWeek; week &lt; startWeek + 3; week++) {</span>
<a href="#l46.149"></a><span id="l46.149">     // Monday</span>
<a href="#l46.150"></a><span id="l46.150" class="difflineminus">-    let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 2, undefined)</span>
<a href="#l46.151"></a><span id="l46.151" class="difflineminus">-      + eventPath;</span>
<a href="#l46.152"></a><span id="l46.152" class="difflineplus">+    let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 2, undefined) +</span>
<a href="#l46.153"></a><span id="l46.153" class="difflineplus">+      eventPath;</span>
<a href="#l46.154"></a><span id="l46.154">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.155"></a><span id="l46.155">     // Wednesday</span>
<a href="#l46.156"></a><span id="l46.156" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 4, undefined)</span>
<a href="#l46.157"></a><span id="l46.157" class="difflineminus">-      + eventPath;</span>
<a href="#l46.158"></a><span id="l46.158" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 4, undefined) +</span>
<a href="#l46.159"></a><span id="l46.159" class="difflineplus">+      eventPath;</span>
<a href="#l46.160"></a><span id="l46.160">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.161"></a><span id="l46.161">     // Friday</span>
<a href="#l46.162"></a><span id="l46.162" class="difflineminus">-    box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 6, undefined)</span>
<a href="#l46.163"></a><span id="l46.163" class="difflineminus">-      + eventPath;</span>
<a href="#l46.164"></a><span id="l46.164" class="difflineplus">+    box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 6, undefined) +</span>
<a href="#l46.165"></a><span id="l46.165" class="difflineplus">+      eventPath;</span>
<a href="#l46.166"></a><span id="l46.166">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.167"></a><span id="l46.167">   }</span>
<a href="#l46.168"></a><span id="l46.168"> </span>
<a href="#l46.169"></a><span id="l46.169">   // Monday, last occurrence</span>
<a href="#l46.170"></a><span id="l46.170">   let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek + 3, 2,</span>
<a href="#l46.171"></a><span id="l46.171">     undefined) + eventPath;</span>
<a href="#l46.172"></a><span id="l46.172">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l46.173"></a><span id="l46.173">   // Wednesday</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -40,34 +40,34 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l47.4"></a><span id="l47.4">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l47.5"></a><span id="l47.5">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l47.6"></a><span id="l47.6"> </span>
<a href="#l47.7"></a><span id="l47.7">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l47.8"></a><span id="l47.8"> </span>
<a href="#l47.9"></a><span id="l47.9">   // move 5th January occurrence to 6th January</span>
<a href="#l47.10"></a><span id="l47.10">   calUtils.handleOccurrenceModification(controller, false);</span>
<a href="#l47.11"></a><span id="l47.11">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineminus">-      + eventPath));</span>
<a href="#l47.14"></a><span id="l47.14" class="difflineplus">+    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l47.15"></a><span id="l47.15" class="difflineplus">+      eventPath));</span>
<a href="#l47.16"></a><span id="l47.16">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l47.17"></a><span id="l47.17">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l47.18"></a><span id="l47.18">   event.sleep(sleep);</span>
<a href="#l47.19"></a><span id="l47.19"> </span>
<a href="#l47.20"></a><span id="l47.20" class="difflineminus">-  let startDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/'</span>
<a href="#l47.21"></a><span id="l47.21" class="difflineminus">-    + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-startdate-row&quot;)/'</span>
<a href="#l47.22"></a><span id="l47.22" class="difflineminus">-    + 'id(&quot;event-grid-startdate-picker-box&quot;)/id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/'</span>
<a href="#l47.23"></a><span id="l47.23" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l47.24"></a><span id="l47.24" class="difflineminus">-    + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l47.25"></a><span id="l47.25" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l47.26"></a><span id="l47.26" class="difflineminus">-  let endDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/'</span>
<a href="#l47.27"></a><span id="l47.27" class="difflineminus">-    + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-enddate-row&quot;)/[1]/'</span>
<a href="#l47.28"></a><span id="l47.28" class="difflineminus">-    + 'id(&quot;event-grid-enddate-picker-box&quot;)/id(&quot;event-endtime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/'</span>
<a href="#l47.29"></a><span id="l47.29" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l47.30"></a><span id="l47.30" class="difflineminus">-    + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l47.31"></a><span id="l47.31" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l47.32"></a><span id="l47.32" class="difflineplus">+  let startDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/' +</span>
<a href="#l47.33"></a><span id="l47.33" class="difflineplus">+    'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-startdate-row&quot;)/' +</span>
<a href="#l47.34"></a><span id="l47.34" class="difflineplus">+    'id(&quot;event-grid-startdate-picker-box&quot;)/id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/' +</span>
<a href="#l47.35"></a><span id="l47.35" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/' +</span>
<a href="#l47.36"></a><span id="l47.36" class="difflineplus">+    '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/' +</span>
<a href="#l47.37"></a><span id="l47.37" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l47.38"></a><span id="l47.38" class="difflineplus">+  let endDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/' +</span>
<a href="#l47.39"></a><span id="l47.39" class="difflineplus">+    'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-enddate-row&quot;)/[1]/' +</span>
<a href="#l47.40"></a><span id="l47.40" class="difflineplus">+    'id(&quot;event-grid-enddate-picker-box&quot;)/id(&quot;event-endtime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/' +</span>
<a href="#l47.41"></a><span id="l47.41" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/' +</span>
<a href="#l47.42"></a><span id="l47.42" class="difflineplus">+    '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/' +</span>
<a href="#l47.43"></a><span id="l47.43" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l47.44"></a><span id="l47.44"> </span>
<a href="#l47.45"></a><span id="l47.45">   event.keypress(startDateInput, &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l47.46"></a><span id="l47.46">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l47.47"></a><span id="l47.47">                      .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l47.48"></a><span id="l47.48">   let startDateString = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l47.49"></a><span id="l47.49">                                              startDate.getFullYear(), startDate.getMonth() + 1, startDate.getDate());</span>
<a href="#l47.50"></a><span id="l47.50">   event.type(startDateInput, startDateString);</span>
<a href="#l47.51"></a><span id="l47.51">   // applies startdate change</span>
<a href="#l47.52"></a><span id="l47.52" class="difflineat">@@ -75,44 +75,44 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l47.53"></a><span id="l47.53"> </span>
<a href="#l47.54"></a><span id="l47.54">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l47.55"></a><span id="l47.55">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l47.56"></a><span id="l47.56"> </span>
<a href="#l47.57"></a><span id="l47.57">   // change recurrence rule</span>
<a href="#l47.58"></a><span id="l47.58">   calUtils.goToDate(controller, 2009, 1, 7);</span>
<a href="#l47.59"></a><span id="l47.59">   calUtils.handleParentModification(controller, false);</span>
<a href="#l47.60"></a><span id="l47.60">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l47.61"></a><span id="l47.61" class="difflineminus">-    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l47.62"></a><span id="l47.62" class="difflineminus">-      + eventPath));</span>
<a href="#l47.63"></a><span id="l47.63" class="difflineplus">+    calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l47.64"></a><span id="l47.64" class="difflineplus">+      eventPath));</span>
<a href="#l47.65"></a><span id="l47.65">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l47.66"></a><span id="l47.66">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l47.67"></a><span id="l47.67"> </span>
<a href="#l47.68"></a><span id="l47.68">   md = new modalDialog.modalDialog(event.window);</span>
<a href="#l47.69"></a><span id="l47.69">   md.start(changeRecurrence);</span>
<a href="#l47.70"></a><span id="l47.70">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l47.71"></a><span id="l47.71">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l47.72"></a><span id="l47.72"> </span>
<a href="#l47.73"></a><span id="l47.73">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l47.74"></a><span id="l47.74">   controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l47.75"></a><span id="l47.75"> </span>
<a href="#l47.76"></a><span id="l47.76">   // check two weeks</span>
<a href="#l47.77"></a><span id="l47.77">   // day view</span>
<a href="#l47.78"></a><span id="l47.78">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l47.79"></a><span id="l47.79" class="difflineminus">-  let path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l47.80"></a><span id="l47.80" class="difflineminus">-    + eventPath;</span>
<a href="#l47.81"></a><span id="l47.81" class="difflineplus">+  let path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l47.82"></a><span id="l47.82" class="difflineplus">+    eventPath;</span>
<a href="#l47.83"></a><span id="l47.83"> </span>
<a href="#l47.84"></a><span id="l47.84">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l47.85"></a><span id="l47.85">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l47.86"></a><span id="l47.86"> </span>
<a href="#l47.87"></a><span id="l47.87">   calUtils.forward(controller, 1);</span>
<a href="#l47.88"></a><span id="l47.88" class="difflineminus">-  let tuesPath = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/'</span>
<a href="#l47.89"></a><span id="l47.89" class="difflineminus">-    + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/'</span>
<a href="#l47.90"></a><span id="l47.90" class="difflineminus">-    + 'id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/'</span>
<a href="#l47.91"></a><span id="l47.91" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[0]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/'</span>
<a href="#l47.92"></a><span id="l47.92" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/[eventIndex]';</span>
<a href="#l47.93"></a><span id="l47.93" class="difflineplus">+  let tuesPath = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/' +</span>
<a href="#l47.94"></a><span id="l47.94" class="difflineplus">+    'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/' +</span>
<a href="#l47.95"></a><span id="l47.95" class="difflineplus">+    'id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/' +</span>
<a href="#l47.96"></a><span id="l47.96" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[0]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/' +</span>
<a href="#l47.97"></a><span id="l47.97" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/[eventIndex]';</span>
<a href="#l47.98"></a><span id="l47.98">   // assert exactly two</span>
<a href="#l47.99"></a><span id="l47.99">   controller.assertNode(new elementslib.Lookup(controller.window.document,</span>
<a href="#l47.100"></a><span id="l47.100">     tuesPath.replace(&quot;eventIndex&quot;, &quot;0&quot;) + eventPath));</span>
<a href="#l47.101"></a><span id="l47.101">   controller.assertNode(new elementslib.Lookup(controller.window.document,</span>
<a href="#l47.102"></a><span id="l47.102">     tuesPath.replace(&quot;eventIndex&quot;, &quot;1&quot;) + eventPath));</span>
<a href="#l47.103"></a><span id="l47.103">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document,</span>
<a href="#l47.104"></a><span id="l47.104">     tuesPath.replace(&quot;eventIndex&quot;, &quot;2&quot;) + eventPath));</span>
<a href="#l47.105"></a><span id="l47.105"> </span>
<a href="#l47.106"></a><span id="l47.106" class="difflineat">@@ -140,25 +140,25 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l47.107"></a><span id="l47.107">   controller.assertNode(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l47.108"></a><span id="l47.108">   calUtils.forward(controller, 1);</span>
<a href="#l47.109"></a><span id="l47.109">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l47.110"></a><span id="l47.110"> </span>
<a href="#l47.111"></a><span id="l47.111">   // week view</span>
<a href="#l47.112"></a><span id="l47.112">   calUtils.switchToView(controller, &quot;week&quot;);</span>
<a href="#l47.113"></a><span id="l47.113">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l47.114"></a><span id="l47.114"> </span>
<a href="#l47.115"></a><span id="l47.115" class="difflineminus">-  path = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour)</span>
<a href="#l47.116"></a><span id="l47.116" class="difflineminus">-    + eventPath;</span>
<a href="#l47.117"></a><span id="l47.117" class="difflineplus">+  path = calUtils.getEventBoxPath(controller, &quot;week&quot;, calUtils.EVENT_BOX, undefined, 2, hour) +</span>
<a href="#l47.118"></a><span id="l47.118" class="difflineplus">+    eventPath;</span>
<a href="#l47.119"></a><span id="l47.119">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l47.120"></a><span id="l47.120"> </span>
<a href="#l47.121"></a><span id="l47.121" class="difflineminus">-  tuesPath = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/'</span>
<a href="#l47.122"></a><span id="l47.122" class="difflineminus">-    + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/'</span>
<a href="#l47.123"></a><span id="l47.123" class="difflineminus">-    + 'id(&quot;view-deck&quot;)/id(&quot;week-view&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/'</span>
<a href="#l47.124"></a><span id="l47.124" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[dayIndex]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/'</span>
<a href="#l47.125"></a><span id="l47.125" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/[eventIndex]';</span>
<a href="#l47.126"></a><span id="l47.126" class="difflineplus">+  tuesPath = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/' +</span>
<a href="#l47.127"></a><span id="l47.127" class="difflineplus">+    'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/' +</span>
<a href="#l47.128"></a><span id="l47.128" class="difflineplus">+    'id(&quot;view-deck&quot;)/id(&quot;week-view&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/' +</span>
<a href="#l47.129"></a><span id="l47.129" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[dayIndex]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/' +</span>
<a href="#l47.130"></a><span id="l47.130" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/[eventIndex]';</span>
<a href="#l47.131"></a><span id="l47.131">   // assert exactly two</span>
<a href="#l47.132"></a><span id="l47.132">   controller.assertNode(new elementslib.Lookup(controller.window.document,</span>
<a href="#l47.133"></a><span id="l47.133">     tuesPath.replace(&quot;dayIndex&quot;, &quot;2&quot;).replace(&quot;eventIndex&quot;, &quot;0&quot;) + eventPath));</span>
<a href="#l47.134"></a><span id="l47.134">   controller.assertNode(new elementslib.Lookup(controller.window.document,</span>
<a href="#l47.135"></a><span id="l47.135">     tuesPath.replace(&quot;dayIndex&quot;, &quot;2&quot;).replace(&quot;eventIndex&quot;, &quot;1&quot;) + eventPath));</span>
<a href="#l47.136"></a><span id="l47.136">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document,</span>
<a href="#l47.137"></a><span id="l47.137">     tuesPath.replace(&quot;dayIndex&quot;, &quot;2&quot;).replace(&quot;eventIndex&quot;, &quot;2&quot;) + eventPath));</span>
<a href="#l47.138"></a><span id="l47.138"> </span>
<a href="#l47.139"></a><span id="l47.139" class="difflineat">@@ -194,18 +194,18 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l47.140"></a><span id="l47.140"> </span>
<a href="#l47.141"></a><span id="l47.141">   // month view</span>
<a href="#l47.142"></a><span id="l47.142">   calUtils.switchToView(controller, &quot;month&quot;);</span>
<a href="#l47.143"></a><span id="l47.143">   checkMultiWeekView(&quot;month&quot;);</span>
<a href="#l47.144"></a><span id="l47.144"> </span>
<a href="#l47.145"></a><span id="l47.145">   // delete event</span>
<a href="#l47.146"></a><span id="l47.146">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l47.147"></a><span id="l47.147">   calUtils.goToDate(controller, 2009, 1, 12);</span>
<a href="#l47.148"></a><span id="l47.148" class="difflineminus">-  path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l47.149"></a><span id="l47.149" class="difflineminus">-    + eventPath;</span>
<a href="#l47.150"></a><span id="l47.150" class="difflineplus">+  path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l47.151"></a><span id="l47.151" class="difflineplus">+    eventPath;</span>
<a href="#l47.152"></a><span id="l47.152">   controller.click(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l47.153"></a><span id="l47.153">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l47.154"></a><span id="l47.154">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l47.155"></a><span id="l47.155">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l47.156"></a><span id="l47.156">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l47.157"></a><span id="l47.157"> </span>
<a href="#l47.158"></a><span id="l47.158">   // reset view</span>
<a href="#l47.159"></a><span id="l47.159">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l47.160"></a><span id="l47.160" class="difflineat">@@ -220,57 +220,57 @@ function setRecurrence(recurrence) {</span>
<a href="#l47.161"></a><span id="l47.161">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l47.162"></a><span id="l47.162">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l47.163"></a><span id="l47.163">   recurrence.sleep(sleep);</span>
<a href="#l47.164"></a><span id="l47.164"> </span>
<a href="#l47.165"></a><span id="l47.165">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l47.166"></a><span id="l47.166">   let wed = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.4.Mmm&quot;);</span>
<a href="#l47.167"></a><span id="l47.167">   let fri = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.6.Mmm&quot;);</span>
<a href="#l47.168"></a><span id="l47.168"> </span>
<a href="#l47.169"></a><span id="l47.169" class="difflineminus">-  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/'</span>
<a href="#l47.170"></a><span id="l47.170" class="difflineminus">-    + 'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/'</span>
<a href="#l47.171"></a><span id="l47.171" class="difflineminus">-    + 'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l47.172"></a><span id="l47.172" class="difflineplus">+  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/' +</span>
<a href="#l47.173"></a><span id="l47.173" class="difflineplus">+    'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/' +</span>
<a href="#l47.174"></a><span id="l47.174" class="difflineplus">+    'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l47.175"></a><span id="l47.175"> </span>
<a href="#l47.176"></a><span id="l47.176">   // starting from Monday so it should be checked</span>
<a href="#l47.177"></a><span id="l47.177">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + mon + '&quot;}'));</span>
<a href="#l47.178"></a><span id="l47.178">   // check Wednesday and Friday too</span>
<a href="#l47.179"></a><span id="l47.179">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + wed + '&quot;}'));</span>
<a href="#l47.180"></a><span id="l47.180">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + fri + '&quot;}'));</span>
<a href="#l47.181"></a><span id="l47.181"> </span>
<a href="#l47.182"></a><span id="l47.182">   // close dialog</span>
<a href="#l47.183"></a><span id="l47.183" class="difflineminus">-  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l47.184"></a><span id="l47.184" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l47.185"></a><span id="l47.185" class="difflineplus">+  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/' +</span>
<a href="#l47.186"></a><span id="l47.186" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l47.187"></a><span id="l47.187"> }</span>
<a href="#l47.188"></a><span id="l47.188"> </span>
<a href="#l47.189"></a><span id="l47.189"> function changeRecurrence(recurrence) {</span>
<a href="#l47.190"></a><span id="l47.190">   // weekly</span>
<a href="#l47.191"></a><span id="l47.191">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l47.192"></a><span id="l47.192">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l47.193"></a><span id="l47.193">   recurrence.sleep(sleep);</span>
<a href="#l47.194"></a><span id="l47.194"> </span>
<a href="#l47.195"></a><span id="l47.195">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l47.196"></a><span id="l47.196">   let tue = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.3.Mmm&quot;);</span>
<a href="#l47.197"></a><span id="l47.197">   let wed = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.4.Mmm&quot;);</span>
<a href="#l47.198"></a><span id="l47.198">   let fri = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.6.Mmm&quot;);</span>
<a href="#l47.199"></a><span id="l47.199"> </span>
<a href="#l47.200"></a><span id="l47.200" class="difflineminus">-  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/'</span>
<a href="#l47.201"></a><span id="l47.201" class="difflineminus">-    + 'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/'</span>
<a href="#l47.202"></a><span id="l47.202" class="difflineminus">-    + 'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l47.203"></a><span id="l47.203" class="difflineplus">+  let days = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-pattern-groupbox&quot;)/' +</span>
<a href="#l47.204"></a><span id="l47.204" class="difflineplus">+    'id(&quot;recurrence-pattern-grid&quot;)/id(&quot;recurrence-pattern-rows&quot;)/id(&quot;recurrence-pattern-period-row&quot;)/' +</span>
<a href="#l47.205"></a><span id="l47.205" class="difflineplus">+    'id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/';</span>
<a href="#l47.206"></a><span id="l47.206"> </span>
<a href="#l47.207"></a><span id="l47.207">   // check old rule</span>
<a href="#l47.208"></a><span id="l47.208">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + mon + '&quot;}'));</span>
<a href="#l47.209"></a><span id="l47.209">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + wed + '&quot;}'));</span>
<a href="#l47.210"></a><span id="l47.210">   recurrence.assertChecked(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + fri + '&quot;}'));</span>
<a href="#l47.211"></a><span id="l47.211"> </span>
<a href="#l47.212"></a><span id="l47.212">   // check Tuesday</span>
<a href="#l47.213"></a><span id="l47.213">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + tue + '&quot;}'));</span>
<a href="#l47.214"></a><span id="l47.214"> </span>
<a href="#l47.215"></a><span id="l47.215">   // close dialog</span>
<a href="#l47.216"></a><span id="l47.216" class="difflineminus">-  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l47.217"></a><span id="l47.217" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l47.218"></a><span id="l47.218" class="difflineplus">+  recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/' +</span>
<a href="#l47.219"></a><span id="l47.219" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l47.220"></a><span id="l47.220"> }</span>
<a href="#l47.221"></a><span id="l47.221"> </span>
<a href="#l47.222"></a><span id="l47.222"> function checkMultiWeekView(view) {</span>
<a href="#l47.223"></a><span id="l47.223">   let startWeek = view == &quot;multiweek&quot; ? 1 : 2;</span>
<a href="#l47.224"></a><span id="l47.224"> </span>
<a href="#l47.225"></a><span id="l47.225">   let path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 2, hour);</span>
<a href="#l47.226"></a><span id="l47.226">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l47.227"></a><span id="l47.227">   // assert exactly two</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -18,35 +18,35 @@ var CANVAS_BOX = 1; // Use when you need</span>
<a href="#l48.4"></a><span id="l48.4"> var ALLDAY = 2; // Use when you need an allday canvas or event box</span>
<a href="#l48.5"></a><span id="l48.5"> </span>
<a href="#l48.6"></a><span id="l48.6"> /**</span>
<a href="#l48.7"></a><span id="l48.7">  *  Accept to send notification email with event to attendees</span>
<a href="#l48.8"></a><span id="l48.8">  *  @param controller - Mozmill window controller</span>
<a href="#l48.9"></a><span id="l48.9">  */</span>
<a href="#l48.10"></a><span id="l48.10"> function acceptSendingNotificationMail(controller) {</span>
<a href="#l48.11"></a><span id="l48.11">   modalDialog.plan_for_modal_dialog(&quot;commonDialog&quot;, function(dialog) {</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-      dialog.waitThenClick(new elementslib.Lookup(dialog.window.document, '/id(&quot;commonDialog&quot;)/'</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineminus">-        + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l48.14"></a><span id="l48.14" class="difflineplus">+      dialog.waitThenClick(new elementslib.Lookup(dialog.window.document, '/id(&quot;commonDialog&quot;)/' +</span>
<a href="#l48.15"></a><span id="l48.15" class="difflineplus">+        'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l48.16"></a><span id="l48.16">     }</span>
<a href="#l48.17"></a><span id="l48.17">   );</span>
<a href="#l48.18"></a><span id="l48.18"> </span>
<a href="#l48.19"></a><span id="l48.19">   modalDialog.wait_for_modal_dialog(&quot;commonDialog&quot;);</span>
<a href="#l48.20"></a><span id="l48.20"> }</span>
<a href="#l48.21"></a><span id="l48.21"> </span>
<a href="#l48.22"></a><span id="l48.22"> /**</span>
<a href="#l48.23"></a><span id="l48.23">  *  Add an attachment with url</span>
<a href="#l48.24"></a><span id="l48.24">  *  @param controller - Mozmill window controller</span>
<a href="#l48.25"></a><span id="l48.25">  */</span>
<a href="#l48.26"></a><span id="l48.26"> function handleAddingAttachment(controller, url) {</span>
<a href="#l48.27"></a><span id="l48.27">   modalDialog.plan_for_modal_dialog(&quot;commonDialog&quot;, function(attachment) {</span>
<a href="#l48.28"></a><span id="l48.28">     let input = new elementslib.ID(attachment.window.document, 'loginTextbox');</span>
<a href="#l48.29"></a><span id="l48.29">     attachment.waitForElement(input);</span>
<a href="#l48.30"></a><span id="l48.30">     input.getNode().value = url;</span>
<a href="#l48.31"></a><span id="l48.31" class="difflineminus">-    attachment.click(new elementslib.Lookup(attachment.window.document, '/id(&quot;commonDialog&quot;)/'</span>
<a href="#l48.32"></a><span id="l48.32" class="difflineminus">-      + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l48.33"></a><span id="l48.33" class="difflineplus">+    attachment.click(new elementslib.Lookup(attachment.window.document, '/id(&quot;commonDialog&quot;)/' +</span>
<a href="#l48.34"></a><span id="l48.34" class="difflineplus">+      'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l48.35"></a><span id="l48.35">   });</span>
<a href="#l48.36"></a><span id="l48.36"> </span>
<a href="#l48.37"></a><span id="l48.37">   modalDialog.wait_for_modal_dialog(&quot;commonDialog&quot;);</span>
<a href="#l48.38"></a><span id="l48.38"> }</span>
<a href="#l48.39"></a><span id="l48.39"> </span>
<a href="#l48.40"></a><span id="l48.40"> /**</span>
<a href="#l48.41"></a><span id="l48.41">  *  Choose to delete just one occurrence of a repeating event</span>
<a href="#l48.42"></a><span id="l48.42">  *  @param controller - Mozmill window controller</span>
<a href="#l48.43"></a><span id="l48.43" class="difflineat">@@ -143,89 +143,89 @@ function switchToView(controller, view) </span>
<a href="#l48.44"></a><span id="l48.44"> /**</span>
<a href="#l48.45"></a><span id="l48.45">  *  Go to a specific date using minimonth</span>
<a href="#l48.46"></a><span id="l48.46">  *  @param controller - main window controller</span>
<a href="#l48.47"></a><span id="l48.47">  *  @param year - four-digit year</span>
<a href="#l48.48"></a><span id="l48.48">  *  @param month - 1-based index of a month</span>
<a href="#l48.49"></a><span id="l48.49">  *  @param day - 1-based index of a day</span>
<a href="#l48.50"></a><span id="l48.50">  */</span>
<a href="#l48.51"></a><span id="l48.51"> function goToDate(controller, year, month, day) {</span>
<a href="#l48.52"></a><span id="l48.52" class="difflineminus">-  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l48.53"></a><span id="l48.53" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l48.54"></a><span id="l48.54" class="difflineminus">-    + 'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l48.55"></a><span id="l48.55" class="difflineminus">-  let activeYear = (new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l48.56"></a><span id="l48.56" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l48.57"></a><span id="l48.57" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;current&quot;:&quot;true&quot;}')).getNode().getAttribute(&quot;value&quot;);</span>
<a href="#l48.58"></a><span id="l48.58" class="difflineminus">-  let activeMonth = (new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l48.59"></a><span id="l48.59" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l48.60"></a><span id="l48.60" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;current&quot;:&quot;true&quot;}')).getNode().getAttribute(&quot;index&quot;);</span>
<a href="#l48.61"></a><span id="l48.61" class="difflineplus">+  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l48.62"></a><span id="l48.62" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/' +</span>
<a href="#l48.63"></a><span id="l48.63" class="difflineplus">+    'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l48.64"></a><span id="l48.64" class="difflineplus">+  let activeYear = (new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l48.65"></a><span id="l48.65" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l48.66"></a><span id="l48.66" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;current&quot;:&quot;true&quot;}')).getNode().getAttribute(&quot;value&quot;);</span>
<a href="#l48.67"></a><span id="l48.67" class="difflineplus">+  let activeMonth = (new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l48.68"></a><span id="l48.68" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l48.69"></a><span id="l48.69" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;current&quot;:&quot;true&quot;}')).getNode().getAttribute(&quot;index&quot;);</span>
<a href="#l48.70"></a><span id="l48.70">   let yearDifference = activeYear - year;</span>
<a href="#l48.71"></a><span id="l48.71">   let monthDifference = activeMonth - (month - 1);</span>
<a href="#l48.72"></a><span id="l48.72"> </span>
<a href="#l48.73"></a><span id="l48.73">   if (yearDifference != 0) {</span>
<a href="#l48.74"></a><span id="l48.74" class="difflineminus">-    let scrollArrow = yearDifference &gt; 0 ?</span>
<a href="#l48.75"></a><span id="l48.75" class="difflineminus">-      (new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l48.76"></a><span id="l48.76" class="difflineminus">-        + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l48.77"></a><span id="l48.77" class="difflineminus">-        + 'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;class&quot;:&quot;autorepeatbutton-up&quot;}')).getNode() :</span>
<a href="#l48.78"></a><span id="l48.78" class="difflineminus">-      (new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l48.79"></a><span id="l48.79" class="difflineminus">-        + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l48.80"></a><span id="l48.80" class="difflineminus">-        + 'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;class&quot;:&quot;autorepeatbutton-down&quot;}')).getNode();</span>
<a href="#l48.81"></a><span id="l48.81" class="difflineplus">+    let scrollArrow = yearDifference &gt; 0</span>
<a href="#l48.82"></a><span id="l48.82" class="difflineplus">+      ? (new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l48.83"></a><span id="l48.83" class="difflineplus">+          'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l48.84"></a><span id="l48.84" class="difflineplus">+          'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;class&quot;:&quot;autorepeatbutton-up&quot;}')).getNode()</span>
<a href="#l48.85"></a><span id="l48.85" class="difflineplus">+      : (new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l48.86"></a><span id="l48.86" class="difflineplus">+          'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l48.87"></a><span id="l48.87" class="difflineplus">+          'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;class&quot;:&quot;autorepeatbutton-down&quot;}')).getNode();</span>
<a href="#l48.88"></a><span id="l48.88"> </span>
<a href="#l48.89"></a><span id="l48.89">     // pick year</span>
<a href="#l48.90"></a><span id="l48.90" class="difflineminus">-    controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l48.91"></a><span id="l48.91" class="difflineminus">-      + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l48.92"></a><span id="l48.92" class="difflineplus">+    controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l48.93"></a><span id="l48.93" class="difflineplus">+      'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l48.94"></a><span id="l48.94">     controller.sleep(500);</span>
<a href="#l48.95"></a><span id="l48.95"> </span>
<a href="#l48.96"></a><span id="l48.96">     for (let i = 0; i &lt; Math.abs(yearDifference); i++) {</span>
<a href="#l48.97"></a><span id="l48.97">       scrollArrow.doCommand();</span>
<a href="#l48.98"></a><span id="l48.98">       controller.sleep(100);</span>
<a href="#l48.99"></a><span id="l48.99">     }</span>
<a href="#l48.100"></a><span id="l48.100"> </span>
<a href="#l48.101"></a><span id="l48.101" class="difflineminus">-    controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l48.102"></a><span id="l48.102" class="difflineminus">-      + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l48.103"></a><span id="l48.103" class="difflineminus">-      + 'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;' + year + '&quot;}'));</span>
<a href="#l48.104"></a><span id="l48.104" class="difflineplus">+    controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l48.105"></a><span id="l48.105" class="difflineplus">+      'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l48.106"></a><span id="l48.106" class="difflineplus">+      'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;' + year + '&quot;}'));</span>
<a href="#l48.107"></a><span id="l48.107">     controller.sleep(500);</span>
<a href="#l48.108"></a><span id="l48.108">   }</span>
<a href="#l48.109"></a><span id="l48.109"> </span>
<a href="#l48.110"></a><span id="l48.110">   if (monthDifference != 0) {</span>
<a href="#l48.111"></a><span id="l48.111">     // pick month</span>
<a href="#l48.112"></a><span id="l48.112" class="difflineminus">-    controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l48.113"></a><span id="l48.113" class="difflineminus">-      + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})/[' + activeMonth</span>
<a href="#l48.114"></a><span id="l48.114" class="difflineminus">-      + ']'));</span>
<a href="#l48.115"></a><span id="l48.115" class="difflineminus">-    controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l48.116"></a><span id="l48.116" class="difflineminus">-      + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l48.117"></a><span id="l48.117" class="difflineminus">-      + 'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;' + (month - 1) + '&quot;}'));</span>
<a href="#l48.118"></a><span id="l48.118" class="difflineplus">+    controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l48.119"></a><span id="l48.119" class="difflineplus">+      'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})/[' + activeMonth +</span>
<a href="#l48.120"></a><span id="l48.120" class="difflineplus">+      ']'));</span>
<a href="#l48.121"></a><span id="l48.121" class="difflineplus">+    controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l48.122"></a><span id="l48.122" class="difflineplus">+      'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l48.123"></a><span id="l48.123" class="difflineplus">+      'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;' + (month - 1) + '&quot;}'));</span>
<a href="#l48.124"></a><span id="l48.124">     controller.sleep(500);</span>
<a href="#l48.125"></a><span id="l48.125">   }</span>
<a href="#l48.126"></a><span id="l48.126"> </span>
<a href="#l48.127"></a><span id="l48.127">   let lastDayInFirstRow = (new elementslib.Lookup(controller.window.document,</span>
<a href="#l48.128"></a><span id="l48.128">     miniMonth + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/[6]')).getNode().getAttribute(&quot;value&quot;);</span>
<a href="#l48.129"></a><span id="l48.129">   let positionOfFirst = 7 - lastDayInFirstRow;</span>
<a href="#l48.130"></a><span id="l48.130">   let dateColumn = (positionOfFirst + day - 1) % 7;</span>
<a href="#l48.131"></a><span id="l48.131">   let dateRow = Math.floor((positionOfFirst + day - 1) / 7);</span>
<a href="#l48.132"></a><span id="l48.132"> </span>
<a href="#l48.133"></a><span id="l48.133">   // pick day</span>
<a href="#l48.134"></a><span id="l48.134" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l48.135"></a><span id="l48.135" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[' + (dateRow + 1) + ']/[' + dateColumn + ']'));</span>
<a href="#l48.136"></a><span id="l48.136" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l48.137"></a><span id="l48.137" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[' + (dateRow + 1) + ']/[' + dateColumn + ']'));</span>
<a href="#l48.138"></a><span id="l48.138">   controller.sleep(500);</span>
<a href="#l48.139"></a><span id="l48.139"> }</span>
<a href="#l48.140"></a><span id="l48.140"> </span>
<a href="#l48.141"></a><span id="l48.141"> /**</span>
<a href="#l48.142"></a><span id="l48.142">  *  @param controller - main window controller</span>
<a href="#l48.143"></a><span id="l48.143">  *  @param view - day, week, multiweek or month</span>
<a href="#l48.144"></a><span id="l48.144">  *  @param option - bg for creating event, fg for checking</span>
<a href="#l48.145"></a><span id="l48.145">  *  @param row - only used in multiweek and month view, 1-based index of a row</span>
<a href="#l48.146"></a><span id="l48.146">  *  @param column - 1-based index of a column</span>
<a href="#l48.147"></a><span id="l48.147">  *  @param hour - index of hour box</span>
<a href="#l48.148"></a><span id="l48.148">  *  @returns path string</span>
<a href="#l48.149"></a><span id="l48.149">  */</span>
<a href="#l48.150"></a><span id="l48.150"> function getEventBoxPath(controller, view, option, row, column, hour) {</span>
<a href="#l48.151"></a><span id="l48.151" class="difflineminus">-  let viewDeck = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l48.152"></a><span id="l48.152" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/'</span>
<a href="#l48.153"></a><span id="l48.153" class="difflineminus">-    + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)';</span>
<a href="#l48.154"></a><span id="l48.154" class="difflineplus">+  let viewDeck = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l48.155"></a><span id="l48.155" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/' +</span>
<a href="#l48.156"></a><span id="l48.156" class="difflineplus">+    'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)';</span>
<a href="#l48.157"></a><span id="l48.157">   let dayView = viewDeck + '/id(&quot;day-view&quot;)';</span>
<a href="#l48.158"></a><span id="l48.158">   let weekView = viewDeck + '/id(&quot;week-view&quot;)';</span>
<a href="#l48.159"></a><span id="l48.159">   let multiweekView = viewDeck + '/id(&quot;multiweek-view&quot;)';</span>
<a href="#l48.160"></a><span id="l48.160">   let monthView = viewDeck + '/id(&quot;month-view&quot;)';</span>
<a href="#l48.161"></a><span id="l48.161"> </span>
<a href="#l48.162"></a><span id="l48.162">   let path = '';</span>
<a href="#l48.163"></a><span id="l48.163">   switch (view) {</span>
<a href="#l48.164"></a><span id="l48.164">     case &quot;week&quot;:</span>
<a href="#l48.165"></a><span id="l48.165" class="difflineat">@@ -253,18 +253,18 @@ function getEventBoxPath(controller, vie</span>
<a href="#l48.166"></a><span id="l48.166">     if (option == CANVAS_BOX) {</span>
<a href="#l48.167"></a><span id="l48.167">       path += '/anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[' + hour + ']';</span>
<a href="#l48.168"></a><span id="l48.168">     } else {</span>
<a href="#l48.169"></a><span id="l48.169">       path += '/anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}';</span>
<a href="#l48.170"></a><span id="l48.170">     }</span>
<a href="#l48.171"></a><span id="l48.171"> </span>
<a href="#l48.172"></a><span id="l48.172">     return path;</span>
<a href="#l48.173"></a><span id="l48.173">   } else {</span>
<a href="#l48.174"></a><span id="l48.174" class="difflineminus">-    path += '/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/'</span>
<a href="#l48.175"></a><span id="l48.175" class="difflineminus">-      + 'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[' + (row - 1) + ']/[' + (column - 1) + ']';</span>
<a href="#l48.176"></a><span id="l48.176" class="difflineplus">+    path += '/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/' +</span>
<a href="#l48.177"></a><span id="l48.177" class="difflineplus">+      'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[' + (row - 1) + ']/[' + (column - 1) + ']';</span>
<a href="#l48.178"></a><span id="l48.178"> </span>
<a href="#l48.179"></a><span id="l48.179">     if (option == CANVAS_BOX) {</span>
<a href="#l48.180"></a><span id="l48.180">       path += '/anon({&quot;anonid&quot;:&quot;day-items&quot;})';</span>
<a href="#l48.181"></a><span id="l48.181">     }</span>
<a href="#l48.182"></a><span id="l48.182"> </span>
<a href="#l48.183"></a><span id="l48.183">     return path;</span>
<a href="#l48.184"></a><span id="l48.184">   }</span>
<a href="#l48.185"></a><span id="l48.185"> }</span>
<a href="#l48.186"></a><span id="l48.186" class="difflineat">@@ -321,19 +321,19 @@ function createCalendar(controller, name</span>
<a href="#l48.187"></a><span id="l48.187"> </span>
<a href="#l48.188"></a><span id="l48.188">   let url = defaultView.makeURL(&quot;moz-storage-calendar://&quot;);</span>
<a href="#l48.189"></a><span id="l48.189">   let calendar = manager.createCalendar(&quot;storage&quot;, url);</span>
<a href="#l48.190"></a><span id="l48.190">   calendar.name = name;</span>
<a href="#l48.191"></a><span id="l48.191">   manager.registerCalendar(calendar);</span>
<a href="#l48.192"></a><span id="l48.192"> </span>
<a href="#l48.193"></a><span id="l48.193">   let id = calendar.id;</span>
<a href="#l48.194"></a><span id="l48.194">   let calendarTree = (new elementslib.Lookup(controller.window.document,</span>
<a href="#l48.195"></a><span id="l48.195" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/'</span>
<a href="#l48.196"></a><span id="l48.196" class="difflineminus">-    + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/id(&quot;calendar-panel&quot;)/'</span>
<a href="#l48.197"></a><span id="l48.197" class="difflineminus">-    + 'id(&quot;calendar-list-pane&quot;)/id(&quot;calendar-listtree-pane&quot;)/id(&quot;calendar-list-tree-widget&quot;)'))</span>
<a href="#l48.198"></a><span id="l48.198" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/' +</span>
<a href="#l48.199"></a><span id="l48.199" class="difflineplus">+    'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/id(&quot;calendar-panel&quot;)/' +</span>
<a href="#l48.200"></a><span id="l48.200" class="difflineplus">+    'id(&quot;calendar-list-pane&quot;)/id(&quot;calendar-listtree-pane&quot;)/id(&quot;calendar-list-tree-widget&quot;)'))</span>
<a href="#l48.201"></a><span id="l48.201">     .getNode();</span>
<a href="#l48.202"></a><span id="l48.202">   for (i = 0; i &lt; calendarTree.mCalendarList.length; i++) {</span>
<a href="#l48.203"></a><span id="l48.203">     if (calendarTree.mCalendarList[i].id == id) {</span>
<a href="#l48.204"></a><span id="l48.204">       calendarTree.tree.view.selection.select(i);</span>
<a href="#l48.205"></a><span id="l48.205">     }</span>
<a href="#l48.206"></a><span id="l48.206">   }</span>
<a href="#l48.207"></a><span id="l48.207"> }</span>
<a href="#l48.208"></a><span id="l48.208"> </span>
<a href="#l48.209"></a><span id="l48.209" class="difflineat">@@ -390,77 +390,77 @@ function setData(controller, data) {</span>
<a href="#l48.210"></a><span id="l48.210">   try {</span>
<a href="#l48.211"></a><span id="l48.211">     (new elementslib.Lookup(controller.window.document, eventDialog)).getNode();</span>
<a href="#l48.212"></a><span id="l48.212">     dialog = eventDialog;</span>
<a href="#l48.213"></a><span id="l48.213">   } catch (error) {</span>
<a href="#l48.214"></a><span id="l48.214">     dialog = taskDialog;</span>
<a href="#l48.215"></a><span id="l48.215">     isEvent = false;</span>
<a href="#l48.216"></a><span id="l48.216">   }</span>
<a href="#l48.217"></a><span id="l48.217"> </span>
<a href="#l48.218"></a><span id="l48.218" class="difflineminus">-  let dateInput = 'anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/{&quot;class&quot;:&quot;datepicker-text-class&quot;}/'</span>
<a href="#l48.219"></a><span id="l48.219" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l48.220"></a><span id="l48.220" class="difflineminus">-  let timeInput = 'anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/'</span>
<a href="#l48.221"></a><span id="l48.221" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/'</span>
<a href="#l48.222"></a><span id="l48.222" class="difflineminus">-    + 'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l48.223"></a><span id="l48.223" class="difflineminus">-  let startDateInput = new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.224"></a><span id="l48.224" class="difflineminus">-    + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l48.225"></a><span id="l48.225" class="difflineminus">-    + (isEvent ? 'id(&quot;event-starttime&quot;)/' : 'id(&quot;todo-entrydate&quot;)/')</span>
<a href="#l48.226"></a><span id="l48.226" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' + dateInput);</span>
<a href="#l48.227"></a><span id="l48.227" class="difflineminus">-  let endDateInput = new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.228"></a><span id="l48.228" class="difflineminus">-    + 'id(&quot;event-grid-enddate-row&quot;)/[1]/id(&quot;event-grid-enddate-picker-box&quot;)/'</span>
<a href="#l48.229"></a><span id="l48.229" class="difflineminus">-    + (isEvent ? 'id(&quot;event-endtime&quot;)/' : 'id(&quot;todo-duedate&quot;)/')</span>
<a href="#l48.230"></a><span id="l48.230" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' + dateInput);</span>
<a href="#l48.231"></a><span id="l48.231" class="difflineminus">-  let startTimeInput = new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.232"></a><span id="l48.232" class="difflineminus">-    + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l48.233"></a><span id="l48.233" class="difflineminus">-    + (isEvent ? 'id(&quot;event-starttime&quot;)/' : 'id(&quot;todo-entrydate&quot;)/')</span>
<a href="#l48.234"></a><span id="l48.234" class="difflineminus">-    + timeInput);</span>
<a href="#l48.235"></a><span id="l48.235" class="difflineminus">-  let endTimeInput = new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.236"></a><span id="l48.236" class="difflineminus">-    + 'id(&quot;event-grid-enddate-row&quot;)/[1]/id(&quot;event-grid-enddate-picker-box&quot;)/'</span>
<a href="#l48.237"></a><span id="l48.237" class="difflineminus">-    + (isEvent ? 'id(&quot;event-endtime&quot;)/' : 'id(&quot;todo-duedate&quot;)/')</span>
<a href="#l48.238"></a><span id="l48.238" class="difflineminus">-    + timeInput);</span>
<a href="#l48.239"></a><span id="l48.239" class="difflineplus">+  let dateInput = 'anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/{&quot;class&quot;:&quot;datepicker-text-class&quot;}/' +</span>
<a href="#l48.240"></a><span id="l48.240" class="difflineplus">+    'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l48.241"></a><span id="l48.241" class="difflineplus">+  let timeInput = 'anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/' +</span>
<a href="#l48.242"></a><span id="l48.242" class="difflineplus">+    'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/' +</span>
<a href="#l48.243"></a><span id="l48.243" class="difflineplus">+    'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l48.244"></a><span id="l48.244" class="difflineplus">+  let startDateInput = new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.245"></a><span id="l48.245" class="difflineplus">+    'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l48.246"></a><span id="l48.246" class="difflineplus">+    (isEvent ? 'id(&quot;event-starttime&quot;)/' : 'id(&quot;todo-entrydate&quot;)/') +</span>
<a href="#l48.247"></a><span id="l48.247" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' + dateInput);</span>
<a href="#l48.248"></a><span id="l48.248" class="difflineplus">+  let endDateInput = new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.249"></a><span id="l48.249" class="difflineplus">+    'id(&quot;event-grid-enddate-row&quot;)/[1]/id(&quot;event-grid-enddate-picker-box&quot;)/' +</span>
<a href="#l48.250"></a><span id="l48.250" class="difflineplus">+    (isEvent ? 'id(&quot;event-endtime&quot;)/' : 'id(&quot;todo-duedate&quot;)/') +</span>
<a href="#l48.251"></a><span id="l48.251" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' + dateInput);</span>
<a href="#l48.252"></a><span id="l48.252" class="difflineplus">+  let startTimeInput = new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.253"></a><span id="l48.253" class="difflineplus">+    'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l48.254"></a><span id="l48.254" class="difflineplus">+    (isEvent ? 'id(&quot;event-starttime&quot;)/' : 'id(&quot;todo-entrydate&quot;)/') +</span>
<a href="#l48.255"></a><span id="l48.255" class="difflineplus">+    timeInput);</span>
<a href="#l48.256"></a><span id="l48.256" class="difflineplus">+  let endTimeInput = new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.257"></a><span id="l48.257" class="difflineplus">+    'id(&quot;event-grid-enddate-row&quot;)/[1]/id(&quot;event-grid-enddate-picker-box&quot;)/' +</span>
<a href="#l48.258"></a><span id="l48.258" class="difflineplus">+    (isEvent ? 'id(&quot;event-endtime&quot;)/' : 'id(&quot;todo-duedate&quot;)/') +</span>
<a href="#l48.259"></a><span id="l48.259" class="difflineplus">+    timeInput);</span>
<a href="#l48.260"></a><span id="l48.260">   let completedDateInput = new elementslib.Lookup(controller.window.document,</span>
<a href="#l48.261"></a><span id="l48.261" class="difflineminus">-    dialog + 'id(&quot;event-grid-todo-status-row&quot;)/id(&quot;event-grid-todo-status-picker-box&quot;)/'</span>
<a href="#l48.262"></a><span id="l48.262" class="difflineminus">-    + 'id(&quot;completed-date-picker&quot;)/' + dateInput);</span>
<a href="#l48.263"></a><span id="l48.263" class="difflineminus">-  let percentCompleteInput = new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.264"></a><span id="l48.264" class="difflineminus">-    + 'id(&quot;event-grid-todo-status-row&quot;)/id(&quot;event-grid-todo-status-picker-box&quot;)/'</span>
<a href="#l48.265"></a><span id="l48.265" class="difflineminus">-    + 'id(&quot;percent-complete-textbox&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/'</span>
<a href="#l48.266"></a><span id="l48.266" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l48.267"></a><span id="l48.267" class="difflineplus">+    dialog + 'id(&quot;event-grid-todo-status-row&quot;)/id(&quot;event-grid-todo-status-picker-box&quot;)/' +</span>
<a href="#l48.268"></a><span id="l48.268" class="difflineplus">+    'id(&quot;completed-date-picker&quot;)/' + dateInput);</span>
<a href="#l48.269"></a><span id="l48.269" class="difflineplus">+  let percentCompleteInput = new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.270"></a><span id="l48.270" class="difflineplus">+    'id(&quot;event-grid-todo-status-row&quot;)/id(&quot;event-grid-todo-status-picker-box&quot;)/' +</span>
<a href="#l48.271"></a><span id="l48.271" class="difflineplus">+    'id(&quot;percent-complete-textbox&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/' +</span>
<a href="#l48.272"></a><span id="l48.272" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l48.273"></a><span id="l48.273">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l48.274"></a><span id="l48.274">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l48.275"></a><span id="l48.275">   let mac = utils.appInfo.os.toLowerCase().includes(&quot;darwin&quot;);</span>
<a href="#l48.276"></a><span id="l48.276">   // wait for input elements' values to be populated</span>
<a href="#l48.277"></a><span id="l48.277">   controller.sleep(sleep);</span>
<a href="#l48.278"></a><span id="l48.278"> </span>
<a href="#l48.279"></a><span id="l48.279">   // title</span>
<a href="#l48.280"></a><span id="l48.280">   if (data.title != undefined) {</span>
<a href="#l48.281"></a><span id="l48.281">     if (!mac) {</span>
<a href="#l48.282"></a><span id="l48.282" class="difflineminus">-      controller.keypress(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.283"></a><span id="l48.283" class="difflineminus">-        + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l48.284"></a><span id="l48.284" class="difflineminus">-        + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.285"></a><span id="l48.285" class="difflineplus">+      controller.keypress(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.286"></a><span id="l48.286" class="difflineplus">+        'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l48.287"></a><span id="l48.287" class="difflineplus">+        'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.288"></a><span id="l48.288">         'a', { ctrlKey: true });</span>
<a href="#l48.289"></a><span id="l48.289" class="difflineminus">-      controller.type(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.290"></a><span id="l48.290" class="difflineminus">-        + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l48.291"></a><span id="l48.291" class="difflineminus">-        + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.292"></a><span id="l48.292" class="difflineplus">+      controller.type(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.293"></a><span id="l48.293" class="difflineplus">+        'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l48.294"></a><span id="l48.294" class="difflineplus">+        'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.295"></a><span id="l48.295">         data.title);</span>
<a href="#l48.296"></a><span id="l48.296">     } else {</span>
<a href="#l48.297"></a><span id="l48.297">       let titleField = new elementslib.ID(controller.window.document, &quot;item-title&quot;);</span>
<a href="#l48.298"></a><span id="l48.298">       titleField.getNode().value = data.title;</span>
<a href="#l48.299"></a><span id="l48.299">     }</span>
<a href="#l48.300"></a><span id="l48.300">   }</span>
<a href="#l48.301"></a><span id="l48.301"> </span>
<a href="#l48.302"></a><span id="l48.302">   // location</span>
<a href="#l48.303"></a><span id="l48.303">   if (data.location != undefined) {</span>
<a href="#l48.304"></a><span id="l48.304">     if (!mac) {</span>
<a href="#l48.305"></a><span id="l48.305" class="difflineminus">-      controller.keypress(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.306"></a><span id="l48.306" class="difflineminus">-        + 'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l48.307"></a><span id="l48.307" class="difflineminus">-        + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.308"></a><span id="l48.308" class="difflineplus">+      controller.keypress(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.309"></a><span id="l48.309" class="difflineplus">+        'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l48.310"></a><span id="l48.310" class="difflineplus">+        'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.311"></a><span id="l48.311">         'a', { ctrlKey: true });</span>
<a href="#l48.312"></a><span id="l48.312" class="difflineminus">-      controller.type(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.313"></a><span id="l48.313" class="difflineminus">-        + 'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l48.314"></a><span id="l48.314" class="difflineminus">-        + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.315"></a><span id="l48.315" class="difflineplus">+      controller.type(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.316"></a><span id="l48.316" class="difflineplus">+        'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l48.317"></a><span id="l48.317" class="difflineplus">+        'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.318"></a><span id="l48.318">         data.location);</span>
<a href="#l48.319"></a><span id="l48.319">     } else {</span>
<a href="#l48.320"></a><span id="l48.320">       let locationField = new elementslib.ID(controller.window.document, &quot;item-location&quot;);</span>
<a href="#l48.321"></a><span id="l48.321">       locationField.getNode().value = data.location;</span>
<a href="#l48.322"></a><span id="l48.322">     }</span>
<a href="#l48.323"></a><span id="l48.323">   }</span>
<a href="#l48.324"></a><span id="l48.324"> </span>
<a href="#l48.325"></a><span id="l48.325">   // category</span>
<a href="#l48.326"></a><span id="l48.326" class="difflineat">@@ -547,28 +547,28 @@ function setData(controller, data) {</span>
<a href="#l48.327"></a><span id="l48.327">   // reminder</span>
<a href="#l48.328"></a><span id="l48.328">   if (data.reminder != undefined) {</span>
<a href="#l48.329"></a><span id="l48.329">     controller.select(new elementslib.ID(controller.window.document, &quot;item-alarm&quot;), data.reminder);</span>
<a href="#l48.330"></a><span id="l48.330">   }</span>
<a href="#l48.331"></a><span id="l48.331"> </span>
<a href="#l48.332"></a><span id="l48.332">   // description</span>
<a href="#l48.333"></a><span id="l48.333">   if (data.description != undefined) {</span>
<a href="#l48.334"></a><span id="l48.334">     if (!mac) {</span>
<a href="#l48.335"></a><span id="l48.335" class="difflineminus">-      controller.keypress(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.336"></a><span id="l48.336" class="difflineminus">-        + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l48.337"></a><span id="l48.337" class="difflineminus">-        + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.338"></a><span id="l48.338" class="difflineplus">+      controller.keypress(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.339"></a><span id="l48.339" class="difflineplus">+        'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l48.340"></a><span id="l48.340" class="difflineplus">+        'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.341"></a><span id="l48.341">         'a', { ctrlKey: true });</span>
<a href="#l48.342"></a><span id="l48.342" class="difflineminus">-      controller.type(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.343"></a><span id="l48.343" class="difflineminus">-        + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l48.344"></a><span id="l48.344" class="difflineminus">-        + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.345"></a><span id="l48.345" class="difflineplus">+      controller.type(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.346"></a><span id="l48.346" class="difflineplus">+        'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l48.347"></a><span id="l48.347" class="difflineplus">+        'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l48.348"></a><span id="l48.348">         data.description);</span>
<a href="#l48.349"></a><span id="l48.349">     } else {</span>
<a href="#l48.350"></a><span id="l48.350" class="difflineminus">-      let descField = new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.351"></a><span id="l48.351" class="difflineminus">-        + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l48.352"></a><span id="l48.352" class="difflineminus">-        + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l48.353"></a><span id="l48.353" class="difflineplus">+      let descField = new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.354"></a><span id="l48.354" class="difflineplus">+        'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l48.355"></a><span id="l48.355" class="difflineplus">+        'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l48.356"></a><span id="l48.356">       descField.getNode().value = data.description;</span>
<a href="#l48.357"></a><span id="l48.357">     }</span>
<a href="#l48.358"></a><span id="l48.358">   }</span>
<a href="#l48.359"></a><span id="l48.359"> </span>
<a href="#l48.360"></a><span id="l48.360">   // priority</span>
<a href="#l48.361"></a><span id="l48.361">   if (data.priority != undefined) {</span>
<a href="#l48.362"></a><span id="l48.362">     controller.mainMenu.click(&quot;#options-priority-&quot; + data.priority + &quot;-label&quot;);</span>
<a href="#l48.363"></a><span id="l48.363">   }</span>
<a href="#l48.364"></a><span id="l48.364" class="difflineat">@@ -621,18 +621,18 @@ function setData(controller, data) {</span>
<a href="#l48.365"></a><span id="l48.365"> </span>
<a href="#l48.366"></a><span id="l48.366">   // attachment</span>
<a href="#l48.367"></a><span id="l48.367">   if (data.attachment != undefined) {</span>
<a href="#l48.368"></a><span id="l48.368">     if (data.attachment.add != undefined) {</span>
<a href="#l48.369"></a><span id="l48.369">       handleAddingAttachment(controller, data.attachment.add);</span>
<a href="#l48.370"></a><span id="l48.370">       controller.click(new elementslib.ID(controller.window.document, &quot;button-url&quot;));</span>
<a href="#l48.371"></a><span id="l48.371">     }</span>
<a href="#l48.372"></a><span id="l48.372">     if (data.attachment.delete != undefined) {</span>
<a href="#l48.373"></a><span id="l48.373" class="difflineminus">-      controller.click(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l48.374"></a><span id="l48.374" class="difflineminus">-        + 'id(&quot;event-grid-attachment-row&quot;)/id(&quot;attachment-link&quot;)/{&quot;label&quot;:&quot;' +</span>
<a href="#l48.375"></a><span id="l48.375" class="difflineplus">+      controller.click(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l48.376"></a><span id="l48.376" class="difflineplus">+        'id(&quot;event-grid-attachment-row&quot;)/id(&quot;attachment-link&quot;)/{&quot;label&quot;:&quot;' +</span>
<a href="#l48.377"></a><span id="l48.377">         data.attachment.delete + '&quot;}'));</span>
<a href="#l48.378"></a><span id="l48.378">       controller.keypress(new elementslib.ID(controller.window.document, &quot;attachment-link&quot;),</span>
<a href="#l48.379"></a><span id="l48.379">         &quot;VK_DELETE&quot;, {});</span>
<a href="#l48.380"></a><span id="l48.380">     }</span>
<a href="#l48.381"></a><span id="l48.381">   }</span>
<a href="#l48.382"></a><span id="l48.382"> </span>
<a href="#l48.383"></a><span id="l48.383">   controller.sleep(sleep);</span>
<a href="#l48.384"></a><span id="l48.384"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/timezone-utils.js</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/timezone-utils.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -6,24 +6,24 @@ var calUtils = require(&quot;calendar-utils&quot;)</span>
<a href="#l49.4"></a><span id="l49.4"> var prefs = require(&quot;prefs&quot;);</span>
<a href="#l49.5"></a><span id="l49.5"> </span>
<a href="#l49.6"></a><span id="l49.6"> function switchAppTimezone(timezone) {</span>
<a href="#l49.7"></a><span id="l49.7">   // change directly as Mac has different Lookup &amp; XPath than Windows &amp; Linux, bug 536605</span>
<a href="#l49.8"></a><span id="l49.8">   prefs.preferences.setPref(&quot;calendar.timezone.local&quot;, timezone);</span>
<a href="#l49.9"></a><span id="l49.9"> }</span>
<a href="#l49.10"></a><span id="l49.10"> </span>
<a href="#l49.11"></a><span id="l49.11"> function verify(controller, dates, timezones, times) {</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-  let dayView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/'</span>
<a href="#l49.14"></a><span id="l49.14" class="difflineminus">-    + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)';</span>
<a href="#l49.15"></a><span id="l49.15" class="difflineminus">-  let dayStack = dayView + '/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/'</span>
<a href="#l49.16"></a><span id="l49.16" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[0]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/'</span>
<a href="#l49.17"></a><span id="l49.17" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}';</span>
<a href="#l49.18"></a><span id="l49.18" class="difflineminus">-  let timeLine = dayView + '/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;timebar&quot;})/'</span>
<a href="#l49.19"></a><span id="l49.19" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;topbox&quot;})/';</span>
<a href="#l49.20"></a><span id="l49.20" class="difflineplus">+  let dayView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l49.21"></a><span id="l49.21" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/' +</span>
<a href="#l49.22"></a><span id="l49.22" class="difflineplus">+    'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)';</span>
<a href="#l49.23"></a><span id="l49.23" class="difflineplus">+  let dayStack = dayView + '/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/' +</span>
<a href="#l49.24"></a><span id="l49.24" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[0]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/' +</span>
<a href="#l49.25"></a><span id="l49.25" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}';</span>
<a href="#l49.26"></a><span id="l49.26" class="difflineplus">+  let timeLine = dayView + '/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;timebar&quot;})/' +</span>
<a href="#l49.27"></a><span id="l49.27" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;topbox&quot;})/';</span>
<a href="#l49.28"></a><span id="l49.28">   let allowedDifference = 3;</span>
<a href="#l49.29"></a><span id="l49.29"> </span>
<a href="#l49.30"></a><span id="l49.30">   /* Event box' time can't be deduced from it's position in                    ----------------</span>
<a href="#l49.31"></a><span id="l49.31">      xul element tree because for each event a box is laid over whole day and  |___spacer_____|</span>
<a href="#l49.32"></a><span id="l49.32">      a spacer is added to push the event to it's correct location.             |__event_box___|</span>
<a href="#l49.33"></a><span id="l49.33">      But timeline can be used to retrieve the position of a particular hour    |day continues |</span>
<a href="#l49.34"></a><span id="l49.34">      on screen and it can be compared against the position of the event.       ----------------</span>
<a href="#l49.35"></a><span id="l49.35">   */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/calendar/test/mozmill/testBasicFunctionality.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/calendar/test/mozmill/testBasicFunctionality.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -13,80 +13,80 @@ var modalDialog;</span>
<a href="#l50.4"></a><span id="l50.4"> var setupModule = function(module) {</span>
<a href="#l50.5"></a><span id="l50.5">   controller = mozmill.getMail3PaneController();</span>
<a href="#l50.6"></a><span id="l50.6">   modalDialog = collector.getModule('window-helpers');</span>
<a href="#l50.7"></a><span id="l50.7"> };</span>
<a href="#l50.8"></a><span id="l50.8"> </span>
<a href="#l50.9"></a><span id="l50.9"> var testSmokeTest = function() {</span>
<a href="#l50.10"></a><span id="l50.10">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l50.11"></a><span id="l50.11">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-  let path = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/'</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineminus">-    + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/';</span>
<a href="#l50.14"></a><span id="l50.14" class="difflineplus">+  let path = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/' +</span>
<a href="#l50.15"></a><span id="l50.15" class="difflineplus">+    'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/';</span>
<a href="#l50.16"></a><span id="l50.16"> </span>
<a href="#l50.17"></a><span id="l50.17">   // open calendar view</span>
<a href="#l50.18"></a><span id="l50.18">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l50.19"></a><span id="l50.19"> </span>
<a href="#l50.20"></a><span id="l50.20">   // check for minimonth</span>
<a href="#l50.21"></a><span id="l50.21">   controller.waitForElement(new elementslib.ID(controller.window.document, &quot;calMinimonth&quot;));</span>
<a href="#l50.22"></a><span id="l50.22">   // every month has a first</span>
<a href="#l50.23"></a><span id="l50.23" class="difflineminus">-  controller.assertNode(new elementslib.Lookup(controller.window.document, path</span>
<a href="#l50.24"></a><span id="l50.24" class="difflineminus">-    + 'id(&quot;ltnSidebar&quot;)/id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/'</span>
<a href="#l50.25"></a><span id="l50.25" class="difflineminus">-    + 'id(&quot;calMinimonth&quot;)/anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l50.26"></a><span id="l50.26" class="difflineplus">+  controller.assertNode(new elementslib.Lookup(controller.window.document, path +</span>
<a href="#l50.27"></a><span id="l50.27" class="difflineplus">+    'id(&quot;ltnSidebar&quot;)/id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/' +</span>
<a href="#l50.28"></a><span id="l50.28" class="difflineplus">+    'id(&quot;calMinimonth&quot;)/anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l50.29"></a><span id="l50.29"> </span>
<a href="#l50.30"></a><span id="l50.30">   // check for calendar list</span>
<a href="#l50.31"></a><span id="l50.31">   controller.assertNode(new elementslib.ID(controller.window.document, &quot;calendar-list-pane&quot;));</span>
<a href="#l50.32"></a><span id="l50.32" class="difflineminus">-  controller.assertNode(new elementslib.Lookup(controller.window.document, path</span>
<a href="#l50.33"></a><span id="l50.33" class="difflineminus">-    + 'id(&quot;ltnSidebar&quot;)/id(&quot;calendar-panel&quot;)/id(&quot;calendar-list-pane&quot;)/id(&quot;calendar-listtree-pane&quot;)/'</span>
<a href="#l50.34"></a><span id="l50.34" class="difflineminus">-    + 'id(&quot;calendar-list-tree-widget&quot;)/anon({&quot;anonid&quot;:&quot;tree&quot;})/anon({&quot;anonid&quot;:&quot;treechildren&quot;})'));</span>
<a href="#l50.35"></a><span id="l50.35" class="difflineplus">+  controller.assertNode(new elementslib.Lookup(controller.window.document, path +</span>
<a href="#l50.36"></a><span id="l50.36" class="difflineplus">+    'id(&quot;ltnSidebar&quot;)/id(&quot;calendar-panel&quot;)/id(&quot;calendar-list-pane&quot;)/id(&quot;calendar-listtree-pane&quot;)/' +</span>
<a href="#l50.37"></a><span id="l50.37" class="difflineplus">+    'id(&quot;calendar-list-tree-widget&quot;)/anon({&quot;anonid&quot;:&quot;tree&quot;})/anon({&quot;anonid&quot;:&quot;treechildren&quot;})'));</span>
<a href="#l50.38"></a><span id="l50.38"> </span>
<a href="#l50.39"></a><span id="l50.39">   // check for event search</span>
<a href="#l50.40"></a><span id="l50.40">   controller.assertNode(new elementslib.ID(controller.window.document, &quot;bottom-events-box&quot;));</span>
<a href="#l50.41"></a><span id="l50.41">   // there should be search field</span>
<a href="#l50.42"></a><span id="l50.42">   controller.assertNode(new elementslib.ID(controller.window.document, &quot;unifinder-search-field&quot;));</span>
<a href="#l50.43"></a><span id="l50.43"> </span>
<a href="#l50.44"></a><span id="l50.44">   // default view is day view which should have 09:00 label and box</span>
<a href="#l50.45"></a><span id="l50.45">   let label = dateService.FormatTime(&quot;&quot;, dateService.timeFormatNoSeconds, 9, 0, 0);</span>
<a href="#l50.46"></a><span id="l50.46" class="difflineminus">-  controller.assertNode(new elementslib.Lookup(controller.window.document, path</span>
<a href="#l50.47"></a><span id="l50.47" class="difflineminus">-    + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/'</span>
<a href="#l50.48"></a><span id="l50.48" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;timebar&quot;})/'</span>
<a href="#l50.49"></a><span id="l50.49" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;topbox&quot;})/[9]/{&quot;class&quot;:&quot;calendar-time-bar-label&quot;,&quot;value&quot;:&quot;' + label + '&quot;}'));</span>
<a href="#l50.50"></a><span id="l50.50" class="difflineminus">-  controller.assertNode(new elementslib.Lookup(controller.window.document, path</span>
<a href="#l50.51"></a><span id="l50.51" class="difflineminus">-    + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/'</span>
<a href="#l50.52"></a><span id="l50.52" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/[0]/'</span>
<a href="#l50.53"></a><span id="l50.53" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[9]'));</span>
<a href="#l50.54"></a><span id="l50.54" class="difflineplus">+  controller.assertNode(new elementslib.Lookup(controller.window.document, path +</span>
<a href="#l50.55"></a><span id="l50.55" class="difflineplus">+    'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/' +</span>
<a href="#l50.56"></a><span id="l50.56" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;timebar&quot;})/' +</span>
<a href="#l50.57"></a><span id="l50.57" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;topbox&quot;})/[9]/{&quot;class&quot;:&quot;calendar-time-bar-label&quot;,&quot;value&quot;:&quot;' + label + '&quot;}'));</span>
<a href="#l50.58"></a><span id="l50.58" class="difflineplus">+  controller.assertNode(new elementslib.Lookup(controller.window.document, path +</span>
<a href="#l50.59"></a><span id="l50.59" class="difflineplus">+    'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/' +</span>
<a href="#l50.60"></a><span id="l50.60" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/[0]/' +</span>
<a href="#l50.61"></a><span id="l50.61" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[9]'));</span>
<a href="#l50.62"></a><span id="l50.62"> </span>
<a href="#l50.63"></a><span id="l50.63">   // open tasks view</span>
<a href="#l50.64"></a><span id="l50.64">   controller.click(new elementslib.ID(controller.window.document, &quot;task-tab-button&quot;));</span>
<a href="#l50.65"></a><span id="l50.65">   // should be possible to filter today's tasks</span>
<a href="#l50.66"></a><span id="l50.66">   controller.waitForElement(new elementslib.ID(controller.window.document, &quot;opt_today_filter&quot;));</span>
<a href="#l50.67"></a><span id="l50.67">   // check for task add button</span>
<a href="#l50.68"></a><span id="l50.68">   controller.assertNode(new elementslib.ID(controller.window.document, &quot;calendar-add-task-button&quot;));</span>
<a href="#l50.69"></a><span id="l50.69">   // check for filtered tasks list</span>
<a href="#l50.70"></a><span id="l50.70" class="difflineminus">-  controller.assertNode(new elementslib.Lookup(controller.window.document, path</span>
<a href="#l50.71"></a><span id="l50.71" class="difflineminus">-    + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-task-box&quot;)/[1]/id(&quot;calendar-task-tree&quot;)/'</span>
<a href="#l50.72"></a><span id="l50.72" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;calendar-task-tree&quot;})/{&quot;tooltip&quot;:&quot;taskTreeTooltip&quot;}'));</span>
<a href="#l50.73"></a><span id="l50.73" class="difflineplus">+  controller.assertNode(new elementslib.Lookup(controller.window.document, path +</span>
<a href="#l50.74"></a><span id="l50.74" class="difflineplus">+    'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-task-box&quot;)/[1]/id(&quot;calendar-task-tree&quot;)/' +</span>
<a href="#l50.75"></a><span id="l50.75" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;calendar-task-tree&quot;})/{&quot;tooltip&quot;:&quot;taskTreeTooltip&quot;}'));</span>
<a href="#l50.76"></a><span id="l50.76"> </span>
<a href="#l50.77"></a><span id="l50.77">   // create test calendar</span>
<a href="#l50.78"></a><span id="l50.78">   modalDialog.plan_for_modal_dialog(&quot;Calendar:NewCalendarWizard&quot;, handleNewCalendarWizard);</span>
<a href="#l50.79"></a><span id="l50.79" class="difflineminus">-  let calendarList = new elementslib.Lookup(controller.window.document, path</span>
<a href="#l50.80"></a><span id="l50.80" class="difflineminus">-    + '/id(&quot;ltnSidebar&quot;)/id(&quot;calendar-panel&quot;)/id(&quot;calendar-list-pane&quot;)/id(&quot;calendar-listtree-pane&quot;)/'</span>
<a href="#l50.81"></a><span id="l50.81" class="difflineminus">-    + 'id(&quot;calendar-list-tree-widget&quot;)/anon({&quot;anonid&quot;:&quot;tree&quot;})/anon({&quot;anonid&quot;:&quot;treechildren&quot;})');</span>
<a href="#l50.82"></a><span id="l50.82" class="difflineplus">+  let calendarList = new elementslib.Lookup(controller.window.document, path +</span>
<a href="#l50.83"></a><span id="l50.83" class="difflineplus">+    '/id(&quot;ltnSidebar&quot;)/id(&quot;calendar-panel&quot;)/id(&quot;calendar-list-pane&quot;)/id(&quot;calendar-listtree-pane&quot;)/' +</span>
<a href="#l50.84"></a><span id="l50.84" class="difflineplus">+    'id(&quot;calendar-list-tree-widget&quot;)/anon({&quot;anonid&quot;:&quot;tree&quot;})/anon({&quot;anonid&quot;:&quot;treechildren&quot;})');</span>
<a href="#l50.85"></a><span id="l50.85">   controller.doubleClick(calendarList, 0, calendarList.getNode().boxObject.height); // bottom left</span>
<a href="#l50.86"></a><span id="l50.86">   modalDialog.wait_for_modal_dialog(&quot;Calendar:NewCalendarWizard&quot;, TIMEOUT_MODAL_DIALOG);</span>
<a href="#l50.87"></a><span id="l50.87"> };</span>
<a href="#l50.88"></a><span id="l50.88"> </span>
<a href="#l50.89"></a><span id="l50.89"> function handleNewCalendarWizard(controller) {</span>
<a href="#l50.90"></a><span id="l50.90">   let docEl = controller.window.document.documentElement;</span>
<a href="#l50.91"></a><span id="l50.91">   // click next</span>
<a href="#l50.92"></a><span id="l50.92">   docEl.getButton(&quot;next&quot;).doCommand();</span>
<a href="#l50.93"></a><span id="l50.93"> </span>
<a href="#l50.94"></a><span id="l50.94">   // set calendar name</span>
<a href="#l50.95"></a><span id="l50.95" class="difflineminus">-  let calendarNameTextBox = new elementslib.Lookup(controller.window.document, '/id(&quot;calendar-wizard&quot;)/'</span>
<a href="#l50.96"></a><span id="l50.96" class="difflineminus">-    + '{&quot;pageid&quot;:&quot;customizePage&quot;}/[1]/id(&quot;customize-rows&quot;)/id(&quot;customize-name-row&quot;)/'</span>
<a href="#l50.97"></a><span id="l50.97" class="difflineminus">-    + 'id(&quot;calendar-name&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l50.98"></a><span id="l50.98" class="difflineplus">+  let calendarNameTextBox = new elementslib.Lookup(controller.window.document, '/id(&quot;calendar-wizard&quot;)/' +</span>
<a href="#l50.99"></a><span id="l50.99" class="difflineplus">+    '{&quot;pageid&quot;:&quot;customizePage&quot;}/[1]/id(&quot;customize-rows&quot;)/id(&quot;customize-name-row&quot;)/' +</span>
<a href="#l50.100"></a><span id="l50.100" class="difflineplus">+    'id(&quot;calendar-name&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l50.101"></a><span id="l50.101">   controller.waitForElement(calendarNameTextBox);</span>
<a href="#l50.102"></a><span id="l50.102">   controller.type(calendarNameTextBox, &quot;Mozmill&quot;);</span>
<a href="#l50.103"></a><span id="l50.103"> </span>
<a href="#l50.104"></a><span id="l50.104">   // click next</span>
<a href="#l50.105"></a><span id="l50.105">   docEl.getButton(&quot;next&quot;).doCommand();</span>
<a href="#l50.106"></a><span id="l50.106"> </span>
<a href="#l50.107"></a><span id="l50.107">   // click finish</span>
<a href="#l50.108"></a><span id="l50.108">   docEl.getButton(&quot;finish&quot;).doCommand();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/calendar/test/mozmill/testLocalICS.js</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/calendar/test/mozmill/testLocalICS.js</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -50,36 +50,36 @@ var testLocalICS = function() {</span>
<a href="#l51.4"></a><span id="l51.4">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l51.5"></a><span id="l51.5">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l51.6"></a><span id="l51.6"> </span>
<a href="#l51.7"></a><span id="l51.7">   // let the iframe load</span>
<a href="#l51.8"></a><span id="l51.8">   let iframe = event.window.document.getElementById(&quot;lightning-item-panel-iframe&quot;);</span>
<a href="#l51.9"></a><span id="l51.9">   event.waitFor(() =&gt; iframe.contentWindow.onLoad &amp;&amp; iframe.contentWindow.onLoad.hasLoaded == true);</span>
<a href="#l51.10"></a><span id="l51.10"> </span>
<a href="#l51.11"></a><span id="l51.11">   // title</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-  let titleTextBox = new elementslib.Lookup(iframe.contentDocument, '/id(&quot;calendar-event-dialog-inner&quot;)/'</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineminus">-    + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-title-row&quot;)/'</span>
<a href="#l51.14"></a><span id="l51.14" class="difflineminus">-    + 'id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l51.15"></a><span id="l51.15" class="difflineplus">+  let titleTextBox = new elementslib.Lookup(iframe.contentDocument, '/id(&quot;calendar-event-dialog-inner&quot;)/' +</span>
<a href="#l51.16"></a><span id="l51.16" class="difflineplus">+    'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-title-row&quot;)/' +</span>
<a href="#l51.17"></a><span id="l51.17" class="difflineplus">+    'id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l51.18"></a><span id="l51.18">   event.waitForElement(titleTextBox);</span>
<a href="#l51.19"></a><span id="l51.19">   event.type(titleTextBox, title);</span>
<a href="#l51.20"></a><span id="l51.20"> </span>
<a href="#l51.21"></a><span id="l51.21">   // set calendar</span>
<a href="#l51.22"></a><span id="l51.22">   let itemCalendar = new elementslib.ID(event.window.document, &quot;item-calendar&quot;);</span>
<a href="#l51.23"></a><span id="l51.23">   event.select(itemCalendar, undefined, calendar);</span>
<a href="#l51.24"></a><span id="l51.24">   // HACK - Wait for the value to be selected. This is needed for platforms</span>
<a href="#l51.25"></a><span id="l51.25">   // like mac where selecting the menuitem is an asynchronous process, it might</span>
<a href="#l51.26"></a><span id="l51.26">   // be fixed in a later version of mozmill.</span>
<a href="#l51.27"></a><span id="l51.27">   event.waitFor(() =&gt; itemCalendar.getNode().value == calendar);</span>
<a href="#l51.28"></a><span id="l51.28"> </span>
<a href="#l51.29"></a><span id="l51.29">   // save</span>
<a href="#l51.30"></a><span id="l51.30">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l51.31"></a><span id="l51.31"> </span>
<a href="#l51.32"></a><span id="l51.32">   // assert presence in view</span>
<a href="#l51.33"></a><span id="l51.33" class="difflineminus">-  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l51.34"></a><span id="l51.34" class="difflineminus">-    + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar + '&quot;}';</span>
<a href="#l51.35"></a><span id="l51.35" class="difflineplus">+  let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour) +</span>
<a href="#l51.36"></a><span id="l51.36" class="difflineplus">+    '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar + '&quot;}';</span>
<a href="#l51.37"></a><span id="l51.37">   controller.waitForElement(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l51.38"></a><span id="l51.38"> </span>
<a href="#l51.39"></a><span id="l51.39">   // verify in file</span>
<a href="#l51.40"></a><span id="l51.40">   let fstream = Components.classes[&quot;@mozilla.org/network/file-input-stream;1&quot;]</span>
<a href="#l51.41"></a><span id="l51.41">                           .createInstance(Components.interfaces.nsIFileInputStream);</span>
<a href="#l51.42"></a><span id="l51.42">   let cstream = Components.classes[&quot;@mozilla.org/intl/converter-input-stream;1&quot;]</span>
<a href="#l51.43"></a><span id="l51.43">                           .createInstance(Components.interfaces.nsIConverterInputStream);</span>
<a href="#l51.44"></a><span id="l51.44"> </span>
<a href="#l51.45"></a><span id="l51.45" class="difflineat">@@ -103,31 +103,31 @@ var testLocalICS = function() {</span>
<a href="#l51.46"></a><span id="l51.46"> var teardownTest = function(module) {</span>
<a href="#l51.47"></a><span id="l51.47">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l51.48"></a><span id="l51.48"> };</span>
<a href="#l51.49"></a><span id="l51.49"> </span>
<a href="#l51.50"></a><span id="l51.50"> function handleNewCalendarWizard(wizard) {</span>
<a href="#l51.51"></a><span id="l51.51">   let docEl = wizard.window.document.documentElement;</span>
<a href="#l51.52"></a><span id="l51.52"> </span>
<a href="#l51.53"></a><span id="l51.53">   // choose network calendar</span>
<a href="#l51.54"></a><span id="l51.54" class="difflineminus">-  let remoteOption = new elementslib.Lookup(wizard.window.document, '/id(&quot;calendar-wizard&quot;)/'</span>
<a href="#l51.55"></a><span id="l51.55" class="difflineminus">-    + '{&quot;pageid&quot;:&quot;initialPage&quot;}/id(&quot;calendar-type&quot;)/{&quot;value&quot;:&quot;remote&quot;}');</span>
<a href="#l51.56"></a><span id="l51.56" class="difflineplus">+  let remoteOption = new elementslib.Lookup(wizard.window.document, '/id(&quot;calendar-wizard&quot;)/' +</span>
<a href="#l51.57"></a><span id="l51.57" class="difflineplus">+    '{&quot;pageid&quot;:&quot;initialPage&quot;}/id(&quot;calendar-type&quot;)/{&quot;value&quot;:&quot;remote&quot;}');</span>
<a href="#l51.58"></a><span id="l51.58">   wizard.waitForElement(remoteOption);</span>
<a href="#l51.59"></a><span id="l51.59">   wizard.radio(remoteOption);</span>
<a href="#l51.60"></a><span id="l51.60">   docEl.getButton(&quot;next&quot;).doCommand();</span>
<a href="#l51.61"></a><span id="l51.61"> </span>
<a href="#l51.62"></a><span id="l51.62">   // choose ical</span>
<a href="#l51.63"></a><span id="l51.63" class="difflineminus">-  let icalOption = new elementslib.Lookup(wizard.window.document, '/id(&quot;calendar-wizard&quot;)/'</span>
<a href="#l51.64"></a><span id="l51.64" class="difflineminus">-    + '{&quot;pageid&quot;:&quot;locationPage&quot;}/[1]/[1]/[0]/id(&quot;calendar-format&quot;)/{&quot;value&quot;:&quot;ics&quot;}');</span>
<a href="#l51.65"></a><span id="l51.65" class="difflineplus">+  let icalOption = new elementslib.Lookup(wizard.window.document, '/id(&quot;calendar-wizard&quot;)/' +</span>
<a href="#l51.66"></a><span id="l51.66" class="difflineplus">+    '{&quot;pageid&quot;:&quot;locationPage&quot;}/[1]/[1]/[0]/id(&quot;calendar-format&quot;)/{&quot;value&quot;:&quot;ics&quot;}');</span>
<a href="#l51.67"></a><span id="l51.67">   wizard.waitForElement(icalOption);</span>
<a href="#l51.68"></a><span id="l51.68">   wizard.radio(icalOption);</span>
<a href="#l51.69"></a><span id="l51.69">   // enter location</span>
<a href="#l51.70"></a><span id="l51.70" class="difflineminus">-  wizard.type(new elementslib.Lookup(wizard.window.document, '/id(&quot;calendar-wizard&quot;)/'</span>
<a href="#l51.71"></a><span id="l51.71" class="difflineminus">-    + '{&quot;pageid&quot;:&quot;locationPage&quot;}/[1]/[1]/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calendar-uri&quot;)/'</span>
<a href="#l51.72"></a><span id="l51.72" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l51.73"></a><span id="l51.73" class="difflineplus">+  wizard.type(new elementslib.Lookup(wizard.window.document, '/id(&quot;calendar-wizard&quot;)/' +</span>
<a href="#l51.74"></a><span id="l51.74" class="difflineplus">+    '{&quot;pageid&quot;:&quot;locationPage&quot;}/[1]/[1]/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calendar-uri&quot;)/' +</span>
<a href="#l51.75"></a><span id="l51.75" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l51.76"></a><span id="l51.76">     uri);</span>
<a href="#l51.77"></a><span id="l51.77">   docEl.getButton(&quot;next&quot;).doCommand();</span>
<a href="#l51.78"></a><span id="l51.78"> </span>
<a href="#l51.79"></a><span id="l51.79">   // name is filled in automatically using filename</span>
<a href="#l51.80"></a><span id="l51.80">   wizard.waitFor(function() {return docEl.getButton(&quot;next&quot;).disabled == false;});</span>
<a href="#l51.81"></a><span id="l51.81">   docEl.getButton(&quot;next&quot;).doCommand();</span>
<a href="#l51.82"></a><span id="l51.82"> </span>
<a href="#l51.83"></a><span id="l51.83">   // finish</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/calendar/test/mozmill/testTodayPane.js</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/calendar/test/mozmill/testTodayPane.js</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -16,232 +16,232 @@ Components.utils.import(&quot;resource://cale</span>
<a href="#l52.4"></a><span id="l52.4"> </span>
<a href="#l52.5"></a><span id="l52.5"> var setupModule = function(module) {</span>
<a href="#l52.6"></a><span id="l52.6">   controller = mozmill.getMail3PaneController();</span>
<a href="#l52.7"></a><span id="l52.7">   calUtils.createCalendar(controller, MOZMILL_CALENDAR);</span>
<a href="#l52.8"></a><span id="l52.8"> };</span>
<a href="#l52.9"></a><span id="l52.9"> </span>
<a href="#l52.10"></a><span id="l52.10"> var testTodayPane = function() {</span>
<a href="#l52.11"></a><span id="l52.11">   // paths</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-  let panels = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/';</span>
<a href="#l52.14"></a><span id="l52.14" class="difflineminus">-  let miniMonth = panels + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l52.15"></a><span id="l52.15" class="difflineminus">-    + 'id(&quot;minimonth-pane&quot;)/';</span>
<a href="#l52.16"></a><span id="l52.16" class="difflineminus">-  let dayView = panels + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;calendarDisplayDeck&quot;)/'</span>
<a href="#l52.17"></a><span id="l52.17" class="difflineminus">-    + 'id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/';</span>
<a href="#l52.18"></a><span id="l52.18" class="difflineminus">-  let dayPath = dayView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;labelbox&quot;})/'</span>
<a href="#l52.19"></a><span id="l52.19" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;labeldaybox&quot;})/{&quot;flex&quot;:&quot;1&quot;}';</span>
<a href="#l52.20"></a><span id="l52.20" class="difflineminus">-  let eventName = '/id(&quot;calendar-event-dialog-inner&quot;)/id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/'</span>
<a href="#l52.21"></a><span id="l52.21" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l52.22"></a><span id="l52.22" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l52.23"></a><span id="l52.23" class="difflineplus">+  let panels = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l52.24"></a><span id="l52.24" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/';</span>
<a href="#l52.25"></a><span id="l52.25" class="difflineplus">+  let miniMonth = panels + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/' +</span>
<a href="#l52.26"></a><span id="l52.26" class="difflineplus">+    'id(&quot;minimonth-pane&quot;)/';</span>
<a href="#l52.27"></a><span id="l52.27" class="difflineplus">+  let dayView = panels + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;calendarDisplayDeck&quot;)/' +</span>
<a href="#l52.28"></a><span id="l52.28" class="difflineplus">+    'id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/';</span>
<a href="#l52.29"></a><span id="l52.29" class="difflineplus">+  let dayPath = dayView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;labelbox&quot;})/' +</span>
<a href="#l52.30"></a><span id="l52.30" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;labeldaybox&quot;})/{&quot;flex&quot;:&quot;1&quot;}';</span>
<a href="#l52.31"></a><span id="l52.31" class="difflineplus">+  let eventName = '/id(&quot;calendar-event-dialog-inner&quot;)/id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/' +</span>
<a href="#l52.32"></a><span id="l52.32" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l52.33"></a><span id="l52.33" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l52.34"></a><span id="l52.34"> </span>
<a href="#l52.35"></a><span id="l52.35">   // open calendar view</span>
<a href="#l52.36"></a><span id="l52.36">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l52.37"></a><span id="l52.37">   controller.waitThenClick(new elementslib.ID(controller.window.document, &quot;calendar-day-view-button&quot;));</span>
<a href="#l52.38"></a><span id="l52.38"> </span>
<a href="#l52.39"></a><span id="l52.39">   // go to today and verify date</span>
<a href="#l52.40"></a><span id="l52.40" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l52.41"></a><span id="l52.41" class="difflineminus">-    + '{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/'</span>
<a href="#l52.42"></a><span id="l52.42" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;today-button&quot;})'));</span>
<a href="#l52.43"></a><span id="l52.43" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l52.44"></a><span id="l52.44" class="difflineplus">+    '{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/' +</span>
<a href="#l52.45"></a><span id="l52.45" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;today-button&quot;})'));</span>
<a href="#l52.46"></a><span id="l52.46">   let dayNode = (new elementslib.Lookup(controller.window.document, dayPath)).getNode();</span>
<a href="#l52.47"></a><span id="l52.47">   controller.assertJS(dayNode.mDate.icalString == getIsoDate());</span>
<a href="#l52.48"></a><span id="l52.48"> </span>
<a href="#l52.49"></a><span id="l52.49">   // create event 6 hours from now, if this is tomorrow then at 23 today</span>
<a href="#l52.50"></a><span id="l52.50">   // doubleclick only triggers new event dialog on visible boxes, so scrolling may be needed</span>
<a href="#l52.51"></a><span id="l52.51">   // by default visible time is 08:00 - 17:00, box of 17th hour is out of view</span>
<a href="#l52.52"></a><span id="l52.52">   let hour = (new Date()).getHours();</span>
<a href="#l52.53"></a><span id="l52.53">   let startHour = (hour &lt; 18) ? hour + 6 : 23;</span>
<a href="#l52.54"></a><span id="l52.54">   let view = (new elementslib.Lookup(controller.window.document, dayView)).getNode();</span>
<a href="#l52.55"></a><span id="l52.55"> </span>
<a href="#l52.56"></a><span id="l52.56">   if (startHour &lt; 8 || startHour &gt; 16) {</span>
<a href="#l52.57"></a><span id="l52.57">     view.scrollToMinute(60 * startHour);</span>
<a href="#l52.58"></a><span id="l52.58">   }</span>
<a href="#l52.59"></a><span id="l52.59"> </span>
<a href="#l52.60"></a><span id="l52.60" class="difflineminus">-  controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l52.61"></a><span id="l52.61" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l52.62"></a><span id="l52.62" class="difflineminus">-    + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l52.63"></a><span id="l52.63" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[' + startHour + ']'), 1, 1);</span>
<a href="#l52.64"></a><span id="l52.64" class="difflineplus">+  controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView +</span>
<a href="#l52.65"></a><span id="l52.65" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/' +</span>
<a href="#l52.66"></a><span id="l52.66" class="difflineplus">+    '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/' +</span>
<a href="#l52.67"></a><span id="l52.67" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[' + startHour + ']'), 1, 1);</span>
<a href="#l52.68"></a><span id="l52.68">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l52.69"></a><span id="l52.69">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l52.70"></a><span id="l52.70">   let iframe = event.window.document.getElementById(&quot;lightning-item-panel-iframe&quot;);</span>
<a href="#l52.71"></a><span id="l52.71">   event.waitFor(() =&gt; iframe.contentWindow.onLoad &amp;&amp; iframe.contentWindow.onLoad.hasLoaded == true);</span>
<a href="#l52.72"></a><span id="l52.72"> </span>
<a href="#l52.73"></a><span id="l52.73">   event.waitForElement(new elementslib.Lookup(iframe.contentDocument, eventName));</span>
<a href="#l52.74"></a><span id="l52.74">   event.type(new elementslib.Lookup(iframe.contentDocument, eventName), &quot;Today's Event&quot;);</span>
<a href="#l52.75"></a><span id="l52.75">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l52.76"></a><span id="l52.76">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l52.77"></a><span id="l52.77"> </span>
<a href="#l52.78"></a><span id="l52.78">   // reset view</span>
<a href="#l52.79"></a><span id="l52.79">   view.scrollToMinute(60 * 8);</span>
<a href="#l52.80"></a><span id="l52.80"> </span>
<a href="#l52.81"></a><span id="l52.81">   // go to tomorrow and add an event</span>
<a href="#l52.82"></a><span id="l52.82">   controller.click(new elementslib.ID(controller.window.document, &quot;next-view-button&quot;));</span>
<a href="#l52.83"></a><span id="l52.83" class="difflineminus">-  controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l52.84"></a><span id="l52.84" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l52.85"></a><span id="l52.85" class="difflineminus">-    + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l52.86"></a><span id="l52.86" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[9]'), 1, 1);</span>
<a href="#l52.87"></a><span id="l52.87" class="difflineplus">+  controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView +</span>
<a href="#l52.88"></a><span id="l52.88" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/' +</span>
<a href="#l52.89"></a><span id="l52.89" class="difflineplus">+    '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/' +</span>
<a href="#l52.90"></a><span id="l52.90" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[9]'), 1, 1);</span>
<a href="#l52.91"></a><span id="l52.91">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l52.92"></a><span id="l52.92">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l52.93"></a><span id="l52.93">   iframe = event.window.document.getElementById(&quot;lightning-item-panel-iframe&quot;);</span>
<a href="#l52.94"></a><span id="l52.94">   event.waitFor(() =&gt; iframe.contentWindow.onLoad &amp;&amp; iframe.contentWindow.onLoad.hasLoaded == true);</span>
<a href="#l52.95"></a><span id="l52.95"> </span>
<a href="#l52.96"></a><span id="l52.96">   event.waitForElement(new elementslib.Lookup(iframe.contentDocument, eventName));</span>
<a href="#l52.97"></a><span id="l52.97">   event.type(new elementslib.Lookup(iframe.contentDocument, eventName), &quot;Tomorrow's Event&quot;);</span>
<a href="#l52.98"></a><span id="l52.98">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l52.99"></a><span id="l52.99">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l52.100"></a><span id="l52.100"> </span>
<a href="#l52.101"></a><span id="l52.101">   // go 5 days forward and add an event</span>
<a href="#l52.102"></a><span id="l52.102">   for (let i = 0; i &lt; 5; i++) {</span>
<a href="#l52.103"></a><span id="l52.103">     controller.click(new elementslib.ID(controller.window.document, &quot;next-view-button&quot;));</span>
<a href="#l52.104"></a><span id="l52.104">   }</span>
<a href="#l52.105"></a><span id="l52.105">   controller.sleep(WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l52.106"></a><span id="l52.106"> </span>
<a href="#l52.107"></a><span id="l52.107" class="difflineminus">-  controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l52.108"></a><span id="l52.108" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l52.109"></a><span id="l52.109" class="difflineminus">-    + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l52.110"></a><span id="l52.110" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[9]'), 1, 1);</span>
<a href="#l52.111"></a><span id="l52.111" class="difflineplus">+  controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView +</span>
<a href="#l52.112"></a><span id="l52.112" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/' +</span>
<a href="#l52.113"></a><span id="l52.113" class="difflineplus">+    '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/' +</span>
<a href="#l52.114"></a><span id="l52.114" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[9]'), 1, 1);</span>
<a href="#l52.115"></a><span id="l52.115">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l52.116"></a><span id="l52.116">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l52.117"></a><span id="l52.117">   iframe = event.window.document.getElementById(&quot;lightning-item-panel-iframe&quot;);</span>
<a href="#l52.118"></a><span id="l52.118">   event.waitFor(() =&gt; iframe.contentWindow.onLoad &amp;&amp; iframe.contentWindow.onLoad.hasLoaded == true);</span>
<a href="#l52.119"></a><span id="l52.119"> </span>
<a href="#l52.120"></a><span id="l52.120">   event.waitForElement(new elementslib.Lookup(iframe.contentDocument, eventName));</span>
<a href="#l52.121"></a><span id="l52.121">   event.type(new elementslib.Lookup(iframe.contentDocument, eventName), &quot;Future's Event&quot;);</span>
<a href="#l52.122"></a><span id="l52.122">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l52.123"></a><span id="l52.123">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l52.124"></a><span id="l52.124"> </span>
<a href="#l52.125"></a><span id="l52.125">   // go to mail tab</span>
<a href="#l52.126"></a><span id="l52.126" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, '/id(&quot;messengerWindow&quot;)/'</span>
<a href="#l52.127"></a><span id="l52.127" class="difflineminus">-    + 'id(&quot;navigation-toolbox&quot;)/id(&quot;tabs-toolbar&quot;)/id(&quot;tabcontainer&quot;)/{&quot;first-tab&quot;:&quot;true&quot;,&quot;type&quot;:&quot;folder&quot;}/'</span>
<a href="#l52.128"></a><span id="l52.128" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;tab-stack&quot;})/{&quot;class&quot;:&quot;tab-background&quot;}/{&quot;class&quot;:&quot;tab-background-middle&quot;}'));</span>
<a href="#l52.129"></a><span id="l52.129" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, '/id(&quot;messengerWindow&quot;)/' +</span>
<a href="#l52.130"></a><span id="l52.130" class="difflineplus">+    'id(&quot;navigation-toolbox&quot;)/id(&quot;tabs-toolbar&quot;)/id(&quot;tabcontainer&quot;)/{&quot;first-tab&quot;:&quot;true&quot;,&quot;type&quot;:&quot;folder&quot;}/' +</span>
<a href="#l52.131"></a><span id="l52.131" class="difflineplus">+    'anon({&quot;class&quot;:&quot;tab-stack&quot;})/{&quot;class&quot;:&quot;tab-background&quot;}/{&quot;class&quot;:&quot;tab-background-middle&quot;}'));</span>
<a href="#l52.132"></a><span id="l52.132">   controller.sleep(WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l52.133"></a><span id="l52.133"> </span>
<a href="#l52.134"></a><span id="l52.134">   // verify today pane open</span>
<a href="#l52.135"></a><span id="l52.135">   controller.assertNotDOMProperty(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.136"></a><span id="l52.136">     '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)'), &quot;collapsed&quot;);</span>
<a href="#l52.137"></a><span id="l52.137"> </span>
<a href="#l52.138"></a><span id="l52.138">   // verify today pane's date</span>
<a href="#l52.139"></a><span id="l52.139">   controller.assertValue(new elementslib.ID(controller.window.document, &quot;datevalue-label&quot;),</span>
<a href="#l52.140"></a><span id="l52.140">     (new Date()).getDate());</span>
<a href="#l52.141"></a><span id="l52.141"> </span>
<a href="#l52.142"></a><span id="l52.142">   // tomorrow and soon are collapsed by default</span>
<a href="#l52.143"></a><span id="l52.143" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, '/id(&quot;messengerWindow&quot;)/'</span>
<a href="#l52.144"></a><span id="l52.144" class="difflineminus">-    + 'id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/[3]/'</span>
<a href="#l52.145"></a><span id="l52.145" class="difflineminus">-    + 'id(&quot;agenda-listbox&quot;)/id(&quot;tomorrow-header&quot;)/anon({&quot;anonid&quot;:&quot;agenda-checkbox-widget&quot;})/'</span>
<a href="#l52.146"></a><span id="l52.146" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;checkbox-check&quot;})'));</span>
<a href="#l52.147"></a><span id="l52.147" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, '/id(&quot;messengerWindow&quot;)/'</span>
<a href="#l52.148"></a><span id="l52.148" class="difflineminus">-    + 'id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/[3]/'</span>
<a href="#l52.149"></a><span id="l52.149" class="difflineminus">-    + 'id(&quot;agenda-listbox&quot;)/id(&quot;nextweek-header&quot;)/anon({&quot;anonid&quot;:&quot;agenda-checkbox-widget&quot;})/'</span>
<a href="#l52.150"></a><span id="l52.150" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;checkbox-check&quot;})'));</span>
<a href="#l52.151"></a><span id="l52.151" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, '/id(&quot;messengerWindow&quot;)/' +</span>
<a href="#l52.152"></a><span id="l52.152" class="difflineplus">+    'id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/[3]/' +</span>
<a href="#l52.153"></a><span id="l52.153" class="difflineplus">+    'id(&quot;agenda-listbox&quot;)/id(&quot;tomorrow-header&quot;)/anon({&quot;anonid&quot;:&quot;agenda-checkbox-widget&quot;})/' +</span>
<a href="#l52.154"></a><span id="l52.154" class="difflineplus">+    'anon({&quot;class&quot;:&quot;checkbox-check&quot;})'));</span>
<a href="#l52.155"></a><span id="l52.155" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, '/id(&quot;messengerWindow&quot;)/' +</span>
<a href="#l52.156"></a><span id="l52.156" class="difflineplus">+    'id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/[3]/' +</span>
<a href="#l52.157"></a><span id="l52.157" class="difflineplus">+    'id(&quot;agenda-listbox&quot;)/id(&quot;nextweek-header&quot;)/anon({&quot;anonid&quot;:&quot;agenda-checkbox-widget&quot;})/' +</span>
<a href="#l52.158"></a><span id="l52.158" class="difflineplus">+    'anon({&quot;class&quot;:&quot;checkbox-check&quot;})'));</span>
<a href="#l52.159"></a><span id="l52.159">   controller.sleep(WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l52.160"></a><span id="l52.160"> </span>
<a href="#l52.161"></a><span id="l52.161">   // verify events shown in today pane</span>
<a href="#l52.162"></a><span id="l52.162">   let now = new Date();</span>
<a href="#l52.163"></a><span id="l52.163">   now.setHours(startHour);</span>
<a href="#l52.164"></a><span id="l52.164">   now.setMinutes(0);</span>
<a href="#l52.165"></a><span id="l52.165">   let dtz = cal.calendarDefaultTimezone();</span>
<a href="#l52.166"></a><span id="l52.166">   let probeDate = cal.jsDateToDateTime(now, dtz);</span>
<a href="#l52.167"></a><span id="l52.167">   let dateFormatter = Components.classes[&quot;@mozilla.org/calendar/datetime-formatter;1&quot;]</span>
<a href="#l52.168"></a><span id="l52.168">                                 .getService(Components.interfaces.calIDateTimeFormatter);</span>
<a href="#l52.169"></a><span id="l52.169">   let startTime = dateFormatter.formatTime(probeDate);</span>
<a href="#l52.170"></a><span id="l52.170">   controller.assertText(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.171"></a><span id="l52.171" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.172"></a><span id="l52.172" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[2]/anon({&quot;anonid&quot;:&quot;agenda-container-box&quot;})/'</span>
<a href="#l52.173"></a><span id="l52.173" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;agenda-description&quot;})/[0]/anon({&quot;anonid&quot;:&quot;agenda-event-start&quot;})/'),</span>
<a href="#l52.174"></a><span id="l52.174" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.175"></a><span id="l52.175" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[2]/anon({&quot;anonid&quot;:&quot;agenda-container-box&quot;})/' +</span>
<a href="#l52.176"></a><span id="l52.176" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;agenda-description&quot;})/[0]/anon({&quot;anonid&quot;:&quot;agenda-event-start&quot;})/'),</span>
<a href="#l52.177"></a><span id="l52.177">     startTime + &quot; Today's Event&quot;);</span>
<a href="#l52.178"></a><span id="l52.178"> </span>
<a href="#l52.179"></a><span id="l52.179">   let tomorrow = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, 9, 0);</span>
<a href="#l52.180"></a><span id="l52.180">   probeDate = cal.jsDateToDateTime(tomorrow, dtz);</span>
<a href="#l52.181"></a><span id="l52.181">   startTime = dateFormatter.formatTime(probeDate);</span>
<a href="#l52.182"></a><span id="l52.182">   controller.assertText(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.183"></a><span id="l52.183" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.184"></a><span id="l52.184" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[4]/anon({&quot;anonid&quot;:&quot;agenda-container-box&quot;})/'</span>
<a href="#l52.185"></a><span id="l52.185" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;agenda-description&quot;})/[0]/anon({&quot;anonid&quot;:&quot;agenda-event-start&quot;})/'),</span>
<a href="#l52.186"></a><span id="l52.186" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.187"></a><span id="l52.187" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[4]/anon({&quot;anonid&quot;:&quot;agenda-container-box&quot;})/' +</span>
<a href="#l52.188"></a><span id="l52.188" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;agenda-description&quot;})/[0]/anon({&quot;anonid&quot;:&quot;agenda-event-start&quot;})/'),</span>
<a href="#l52.189"></a><span id="l52.189">     startTime + &quot; Tomorrow's Event&quot;);</span>
<a href="#l52.190"></a><span id="l52.190"> </span>
<a href="#l52.191"></a><span id="l52.191">   let future = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 6, 9, 0);</span>
<a href="#l52.192"></a><span id="l52.192">   probeDate = cal.jsDateToDateTime(future, dtz);</span>
<a href="#l52.193"></a><span id="l52.193">   startTime = dateFormatter.formatDateTime(probeDate);</span>
<a href="#l52.194"></a><span id="l52.194"> </span>
<a href="#l52.195"></a><span id="l52.195">   // Future event's start time</span>
<a href="#l52.196"></a><span id="l52.196">   controller.assertText(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.197"></a><span id="l52.197" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.198"></a><span id="l52.198" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[6]/anon({&quot;anonid&quot;:&quot;agenda-container-box&quot;})/'</span>
<a href="#l52.199"></a><span id="l52.199" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;agenda-description&quot;})/[0]/anon({&quot;anonid&quot;:&quot;agenda-event-start&quot;})/'),</span>
<a href="#l52.200"></a><span id="l52.200" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.201"></a><span id="l52.201" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[6]/anon({&quot;anonid&quot;:&quot;agenda-container-box&quot;})/' +</span>
<a href="#l52.202"></a><span id="l52.202" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;agenda-description&quot;})/[0]/anon({&quot;anonid&quot;:&quot;agenda-event-start&quot;})/'),</span>
<a href="#l52.203"></a><span id="l52.203">     startTime);</span>
<a href="#l52.204"></a><span id="l52.204"> </span>
<a href="#l52.205"></a><span id="l52.205">   // Future event's title</span>
<a href="#l52.206"></a><span id="l52.206">   controller.assertText(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.207"></a><span id="l52.207" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.208"></a><span id="l52.208" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[6]/anon({&quot;anonid&quot;:&quot;agenda-container-box&quot;})/'</span>
<a href="#l52.209"></a><span id="l52.209" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;agenda-description&quot;})/anon({&quot;anonid&quot;:&quot;agenda-event-title&quot;})/'),</span>
<a href="#l52.210"></a><span id="l52.210" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.211"></a><span id="l52.211" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[6]/anon({&quot;anonid&quot;:&quot;agenda-container-box&quot;})/' +</span>
<a href="#l52.212"></a><span id="l52.212" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;agenda-description&quot;})/anon({&quot;anonid&quot;:&quot;agenda-event-title&quot;})/'),</span>
<a href="#l52.213"></a><span id="l52.213">     &quot;Future's Event&quot;);</span>
<a href="#l52.214"></a><span id="l52.214"> </span>
<a href="#l52.215"></a><span id="l52.215">   // delete events</span>
<a href="#l52.216"></a><span id="l52.216">   controller.click(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.217"></a><span id="l52.217" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.218"></a><span id="l52.218" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[2]'));</span>
<a href="#l52.219"></a><span id="l52.219" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.220"></a><span id="l52.220" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[2]'));</span>
<a href="#l52.221"></a><span id="l52.221">   controller.keypress(new elementslib.ID(controller.window.document, &quot;agenda-listbox&quot;),</span>
<a href="#l52.222"></a><span id="l52.222">     &quot;VK_DELETE&quot;,</span>
<a href="#l52.223"></a><span id="l52.223">     {});</span>
<a href="#l52.224"></a><span id="l52.224">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.225"></a><span id="l52.225" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.226"></a><span id="l52.226" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[6]'));</span>
<a href="#l52.227"></a><span id="l52.227" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.228"></a><span id="l52.228" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[6]'));</span>
<a href="#l52.229"></a><span id="l52.229"> </span>
<a href="#l52.230"></a><span id="l52.230">   controller.click(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.231"></a><span id="l52.231" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.232"></a><span id="l52.232" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[3]'));</span>
<a href="#l52.233"></a><span id="l52.233" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.234"></a><span id="l52.234" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[3]'));</span>
<a href="#l52.235"></a><span id="l52.235">   controller.keypress(new elementslib.ID(controller.window.document, &quot;agenda-listbox&quot;),</span>
<a href="#l52.236"></a><span id="l52.236">     &quot;VK_DELETE&quot;,</span>
<a href="#l52.237"></a><span id="l52.237">     {});</span>
<a href="#l52.238"></a><span id="l52.238">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.239"></a><span id="l52.239" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.240"></a><span id="l52.240" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[5]'));</span>
<a href="#l52.241"></a><span id="l52.241" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.242"></a><span id="l52.242" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[5]'));</span>
<a href="#l52.243"></a><span id="l52.243"> </span>
<a href="#l52.244"></a><span id="l52.244">   controller.click(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.245"></a><span id="l52.245" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.246"></a><span id="l52.246" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[4]'));</span>
<a href="#l52.247"></a><span id="l52.247" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.248"></a><span id="l52.248" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[4]'));</span>
<a href="#l52.249"></a><span id="l52.249">   controller.keypress(new elementslib.ID(controller.window.document, &quot;agenda-listbox&quot;),</span>
<a href="#l52.250"></a><span id="l52.250">     &quot;VK_DELETE&quot;,</span>
<a href="#l52.251"></a><span id="l52.251">     {});</span>
<a href="#l52.252"></a><span id="l52.252">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.253"></a><span id="l52.253" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.254"></a><span id="l52.254" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[4]'));</span>
<a href="#l52.255"></a><span id="l52.255" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.256"></a><span id="l52.256" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[4]'));</span>
<a href="#l52.257"></a><span id="l52.257"> </span>
<a href="#l52.258"></a><span id="l52.258">   // hide and verify today pane hidden</span>
<a href="#l52.259"></a><span id="l52.259">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-status-todaypane-button&quot;));</span>
<a href="#l52.260"></a><span id="l52.260">   controller.assertNode(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.261"></a><span id="l52.261">     '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/{&quot;collapsed&quot;:&quot;true&quot;}'));</span>
<a href="#l52.262"></a><span id="l52.262"> </span>
<a href="#l52.263"></a><span id="l52.263">   // reset today pane</span>
<a href="#l52.264"></a><span id="l52.264">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-status-todaypane-button&quot;));</span>
<a href="#l52.265"></a><span id="l52.265">   controller.assertNotDOMProperty(new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.266"></a><span id="l52.266">     '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)'), &quot;collapsed&quot;);</span>
<a href="#l52.267"></a><span id="l52.267" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, '/id(&quot;messengerWindow&quot;)/'</span>
<a href="#l52.268"></a><span id="l52.268" class="difflineminus">-    + 'id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/[3]/'</span>
<a href="#l52.269"></a><span id="l52.269" class="difflineminus">-    + 'id(&quot;agenda-listbox&quot;)/id(&quot;tomorrow-header&quot;)/anon({&quot;anonid&quot;:&quot;agenda-checkbox-widget&quot;})/'</span>
<a href="#l52.270"></a><span id="l52.270" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;checkbox-check&quot;})'));</span>
<a href="#l52.271"></a><span id="l52.271" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, '/id(&quot;messengerWindow&quot;)/'</span>
<a href="#l52.272"></a><span id="l52.272" class="difflineminus">-    + 'id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/[3]/'</span>
<a href="#l52.273"></a><span id="l52.273" class="difflineminus">-    + 'id(&quot;agenda-listbox&quot;)/id(&quot;nextweek-header&quot;)/anon({&quot;anonid&quot;:&quot;agenda-checkbox-widget&quot;})/'</span>
<a href="#l52.274"></a><span id="l52.274" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;checkbox-check&quot;})'));</span>
<a href="#l52.275"></a><span id="l52.275" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, '/id(&quot;messengerWindow&quot;)/' +</span>
<a href="#l52.276"></a><span id="l52.276" class="difflineplus">+    'id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/[3]/' +</span>
<a href="#l52.277"></a><span id="l52.277" class="difflineplus">+    'id(&quot;agenda-listbox&quot;)/id(&quot;tomorrow-header&quot;)/anon({&quot;anonid&quot;:&quot;agenda-checkbox-widget&quot;})/' +</span>
<a href="#l52.278"></a><span id="l52.278" class="difflineplus">+    'anon({&quot;class&quot;:&quot;checkbox-check&quot;})'));</span>
<a href="#l52.279"></a><span id="l52.279" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, '/id(&quot;messengerWindow&quot;)/' +</span>
<a href="#l52.280"></a><span id="l52.280" class="difflineplus">+    'id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/[3]/' +</span>
<a href="#l52.281"></a><span id="l52.281" class="difflineplus">+    'id(&quot;agenda-listbox&quot;)/id(&quot;nextweek-header&quot;)/anon({&quot;anonid&quot;:&quot;agenda-checkbox-widget&quot;})/' +</span>
<a href="#l52.282"></a><span id="l52.282" class="difflineplus">+    'anon({&quot;class&quot;:&quot;checkbox-check&quot;})'));</span>
<a href="#l52.283"></a><span id="l52.283">   controller.sleep(WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l52.284"></a><span id="l52.284"> </span>
<a href="#l52.285"></a><span id="l52.285">   // verify tomorrow and soon collapsed</span>
<a href="#l52.286"></a><span id="l52.286">   tomorrow = (new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.287"></a><span id="l52.287" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.288"></a><span id="l52.288" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[1]/anon({&quot;class&quot;:&quot;agenda-checkbox&quot;})')).getNode();</span>
<a href="#l52.289"></a><span id="l52.289" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.290"></a><span id="l52.290" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[1]/anon({&quot;class&quot;:&quot;agenda-checkbox&quot;})')).getNode();</span>
<a href="#l52.291"></a><span id="l52.291">   let soon = (new elementslib.Lookup(controller.window.document,</span>
<a href="#l52.292"></a><span id="l52.292" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l52.293"></a><span id="l52.293" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[2]/anon({&quot;class&quot;:&quot;agenda-checkbox&quot;})')).getNode();</span>
<a href="#l52.294"></a><span id="l52.294" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/' +</span>
<a href="#l52.295"></a><span id="l52.295" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[2]/anon({&quot;class&quot;:&quot;agenda-checkbox&quot;})')).getNode();</span>
<a href="#l52.296"></a><span id="l52.296"> // TODO This is failing, which might actually be an error in our code!</span>
<a href="#l52.297"></a><span id="l52.297"> //  controller.assertJS(!tomorrow.hasAttribute(&quot;checked&quot;)</span>
<a href="#l52.298"></a><span id="l52.298"> //    || tomorrow.getAttribute(&quot;checked&quot;) != &quot;true&quot;);</span>
<a href="#l52.299"></a><span id="l52.299" class="difflineminus">-  controller.assertJS(!soon.hasAttribute(&quot;checked&quot;)</span>
<a href="#l52.300"></a><span id="l52.300" class="difflineminus">-    || soon.getAttribute(&quot;checked&quot;) != &quot;true&quot;);</span>
<a href="#l52.301"></a><span id="l52.301" class="difflineplus">+  controller.assertJS(!soon.hasAttribute(&quot;checked&quot;) ||</span>
<a href="#l52.302"></a><span id="l52.302" class="difflineplus">+    soon.getAttribute(&quot;checked&quot;) != &quot;true&quot;);</span>
<a href="#l52.303"></a><span id="l52.303"> };</span>
<a href="#l52.304"></a><span id="l52.304"> </span>
<a href="#l52.305"></a><span id="l52.305"> var getIsoDate = function() {</span>
<a href="#l52.306"></a><span id="l52.306">   let date = new Date();</span>
<a href="#l52.307"></a><span id="l52.307">   let year = date.getFullYear();</span>
<a href="#l52.308"></a><span id="l52.308">   let month = (date.getMonth() &lt; 9) ? '0' + (date.getMonth() + 1) : (date.getMonth() + 1);</span>
<a href="#l52.309"></a><span id="l52.309">   let day = (date.getDate() &lt; 10) ? '0' + date.getDate() : date.getDate();</span>
<a href="#l52.310"></a><span id="l52.310">   let isoDate = year + '' + month + '' + day;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test2.js</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test2.js</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -59,15 +59,15 @@ function setTimezone(event, timezone) {</span>
<a href="#l53.4"></a><span id="l53.4"> </span>
<a href="#l53.5"></a><span id="l53.5">   let modal = new modalDialog.modalDialog(event.window);</span>
<a href="#l53.6"></a><span id="l53.6">   modal.start(eventCallback);</span>
<a href="#l53.7"></a><span id="l53.7">   event.waitForElement(new elementslib.ID(event.window.document, &quot;timezone-starttime&quot;));</span>
<a href="#l53.8"></a><span id="l53.8">   event.click(new elementslib.ID(event.window.document, &quot;timezone-starttime&quot;));</span>
<a href="#l53.9"></a><span id="l53.9"> }</span>
<a href="#l53.10"></a><span id="l53.10"> </span>
<a href="#l53.11"></a><span id="l53.11"> function eventCallback(timezone) {</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-  let item = new elementslib.XPath(timezone.window.document, &quot;/*[name()='dialog']/&quot;</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineminus">-     + &quot;*[name()='menulist'][1]/*[name()='menupopup'][1]/*[@value='&quot; + gTimezone + &quot;']&quot;);</span>
<a href="#l53.14"></a><span id="l53.14" class="difflineplus">+  let item = new elementslib.XPath(timezone.window.document, &quot;/*[name()='dialog']/&quot; +</span>
<a href="#l53.15"></a><span id="l53.15" class="difflineplus">+     &quot;*[name()='menulist'][1]/*[name()='menupopup'][1]/*[@value='&quot; + gTimezone + &quot;']&quot;);</span>
<a href="#l53.16"></a><span id="l53.16">   timezone.waitForElement(item);</span>
<a href="#l53.17"></a><span id="l53.17">   timezone.click(item);</span>
<a href="#l53.18"></a><span id="l53.18" class="difflineminus">-  timezone.click(new elementslib.Lookup(timezone.window.document, '/id(&quot;calendar-event-dialog-timezone&quot;)/'</span>
<a href="#l53.19"></a><span id="l53.19" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l53.20"></a><span id="l53.20" class="difflineplus">+  timezone.click(new elementslib.Lookup(timezone.window.document, '/id(&quot;calendar-event-dialog-timezone&quot;)/' +</span>
<a href="#l53.21"></a><span id="l53.21" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l53.22"></a><span id="l53.22"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/calendar/test/mozmill/views/testDayView.js</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testDayView.js</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -14,132 +14,132 @@ var setupModule = function(module) {</span>
<a href="#l54.4"></a><span id="l54.4">   controller = mozmill.getMail3PaneController();</span>
<a href="#l54.5"></a><span id="l54.5">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l54.6"></a><span id="l54.6"> };</span>
<a href="#l54.7"></a><span id="l54.7"> </span>
<a href="#l54.8"></a><span id="l54.8"> var testDayView = function() {</span>
<a href="#l54.9"></a><span id="l54.9">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l54.10"></a><span id="l54.10">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l54.11"></a><span id="l54.11">   // paths</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l54.13"></a><span id="l54.13" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l54.14"></a><span id="l54.14" class="difflineminus">-    + 'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l54.15"></a><span id="l54.15" class="difflineminus">-  let dayView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l54.16"></a><span id="l54.16" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/'</span>
<a href="#l54.17"></a><span id="l54.17" class="difflineminus">-    + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/';</span>
<a href="#l54.18"></a><span id="l54.18" class="difflineminus">-  let day = new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l54.19"></a><span id="l54.19" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;labelbox&quot;})/anon({&quot;anonid&quot;:&quot;labeldaybox&quot;})/'</span>
<a href="#l54.20"></a><span id="l54.20" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}');</span>
<a href="#l54.21"></a><span id="l54.21" class="difflineplus">+  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l54.22"></a><span id="l54.22" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/' +</span>
<a href="#l54.23"></a><span id="l54.23" class="difflineplus">+    'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l54.24"></a><span id="l54.24" class="difflineplus">+  let dayView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l54.25"></a><span id="l54.25" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/' +</span>
<a href="#l54.26"></a><span id="l54.26" class="difflineplus">+    'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;day-view&quot;)/';</span>
<a href="#l54.27"></a><span id="l54.27" class="difflineplus">+  let day = new elementslib.Lookup(controller.window.document, dayView +</span>
<a href="#l54.28"></a><span id="l54.28" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;labelbox&quot;})/anon({&quot;anonid&quot;:&quot;labeldaybox&quot;})/' +</span>
<a href="#l54.29"></a><span id="l54.29" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}');</span>
<a href="#l54.30"></a><span id="l54.30">   let eventDialog = '/id(&quot;calendar-event-dialog&quot;)/id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/';</span>
<a href="#l54.31"></a><span id="l54.31"> </span>
<a href="#l54.32"></a><span id="l54.32">   // open day view</span>
<a href="#l54.33"></a><span id="l54.33">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l54.34"></a><span id="l54.34">   controller.waitThenClick(new elementslib.ID(controller.window.document, &quot;calendar-day-view-button&quot;));</span>
<a href="#l54.35"></a><span id="l54.35"> </span>
<a href="#l54.36"></a><span id="l54.36">   // pick year</span>
<a href="#l54.37"></a><span id="l54.37" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l54.38"></a><span id="l54.38" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l54.39"></a><span id="l54.39" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l54.40"></a><span id="l54.40" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l54.41"></a><span id="l54.41" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;2009&quot;}'));</span>
<a href="#l54.42"></a><span id="l54.42" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l54.43"></a><span id="l54.43" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l54.44"></a><span id="l54.44" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l54.45"></a><span id="l54.45" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l54.46"></a><span id="l54.46" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;2009&quot;}'));</span>
<a href="#l54.47"></a><span id="l54.47"> </span>
<a href="#l54.48"></a><span id="l54.48">   // pick month</span>
<a href="#l54.49"></a><span id="l54.49" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l54.50"></a><span id="l54.50" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})'));</span>
<a href="#l54.51"></a><span id="l54.51" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l54.52"></a><span id="l54.52" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l54.53"></a><span id="l54.53" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;0&quot;}'));</span>
<a href="#l54.54"></a><span id="l54.54" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l54.55"></a><span id="l54.55" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})'));</span>
<a href="#l54.56"></a><span id="l54.56" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l54.57"></a><span id="l54.57" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l54.58"></a><span id="l54.58" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;0&quot;}'));</span>
<a href="#l54.59"></a><span id="l54.59"> </span>
<a href="#l54.60"></a><span id="l54.60">   // pick day</span>
<a href="#l54.61"></a><span id="l54.61" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l54.62"></a><span id="l54.62" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l54.63"></a><span id="l54.63" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l54.64"></a><span id="l54.64" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l54.65"></a><span id="l54.65"> </span>
<a href="#l54.66"></a><span id="l54.66">   // verify date in view</span>
<a href="#l54.67"></a><span id="l54.67">   controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;;});</span>
<a href="#l54.68"></a><span id="l54.68"> </span>
<a href="#l54.69"></a><span id="l54.69">   // create event at 8 AM</span>
<a href="#l54.70"></a><span id="l54.70" class="difflineminus">-  controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l54.71"></a><span id="l54.71" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l54.72"></a><span id="l54.72" class="difflineminus">-    + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l54.73"></a><span id="l54.73" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[8]'), 1, 1);</span>
<a href="#l54.74"></a><span id="l54.74" class="difflineplus">+  controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView +</span>
<a href="#l54.75"></a><span id="l54.75" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/' +</span>
<a href="#l54.76"></a><span id="l54.76" class="difflineplus">+    '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/' +</span>
<a href="#l54.77"></a><span id="l54.77" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[8]'), 1, 1);</span>
<a href="#l54.78"></a><span id="l54.78">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l54.79"></a><span id="l54.79">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l54.80"></a><span id="l54.80"> </span>
<a href="#l54.81"></a><span id="l54.81">   // check that the start time is correct</span>
<a href="#l54.82"></a><span id="l54.82" class="difflineminus">-  let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l54.83"></a><span id="l54.83" class="difflineminus">-    + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l54.84"></a><span id="l54.84" class="difflineminus">-    + 'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/'</span>
<a href="#l54.85"></a><span id="l54.85" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/'</span>
<a href="#l54.86"></a><span id="l54.86" class="difflineminus">-    + 'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l54.87"></a><span id="l54.87" class="difflineplus">+  let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l54.88"></a><span id="l54.88" class="difflineplus">+    'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l54.89"></a><span id="l54.89" class="difflineplus">+    'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/' +</span>
<a href="#l54.90"></a><span id="l54.90" class="difflineplus">+    'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/' +</span>
<a href="#l54.91"></a><span id="l54.91" class="difflineplus">+    'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l54.92"></a><span id="l54.92">   event.waitForElement(startTimeInput);</span>
<a href="#l54.93"></a><span id="l54.93">   event.assertValue(startTimeInput, '8:00');</span>
<a href="#l54.94"></a><span id="l54.94">   let date = startdate = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l54.95"></a><span id="l54.95">     2009, 1, 1);</span>
<a href="#l54.96"></a><span id="l54.96" class="difflineminus">-  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l54.97"></a><span id="l54.97" class="difflineminus">-    + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l54.98"></a><span id="l54.98" class="difflineminus">-    + 'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/'</span>
<a href="#l54.99"></a><span id="l54.99" class="difflineminus">-    + 'anon({&quot;flex&quot;:&quot;1&quot;,&quot;id&quot;:&quot;hbox&quot;,&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l54.100"></a><span id="l54.100" class="difflineminus">-    + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l54.101"></a><span id="l54.101" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l54.102"></a><span id="l54.102" class="difflineplus">+  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l54.103"></a><span id="l54.103" class="difflineplus">+    'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l54.104"></a><span id="l54.104" class="difflineplus">+    'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' +</span>
<a href="#l54.105"></a><span id="l54.105" class="difflineplus">+    'anon({&quot;flex&quot;:&quot;1&quot;,&quot;id&quot;:&quot;hbox&quot;,&quot;class&quot;:&quot;datepicker-box-class&quot;})/' +</span>
<a href="#l54.106"></a><span id="l54.106" class="difflineplus">+    '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/' +</span>
<a href="#l54.107"></a><span id="l54.107" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l54.108"></a><span id="l54.108">     date);</span>
<a href="#l54.109"></a><span id="l54.109"> </span>
<a href="#l54.110"></a><span id="l54.110">   // fill in title, description and calendar</span>
<a href="#l54.111"></a><span id="l54.111" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l54.112"></a><span id="l54.112" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l54.113"></a><span id="l54.113" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l54.114"></a><span id="l54.114" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l54.115"></a><span id="l54.115" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l54.116"></a><span id="l54.116" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l54.117"></a><span id="l54.117">     title1);</span>
<a href="#l54.118"></a><span id="l54.118" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l54.119"></a><span id="l54.119" class="difflineminus">-    + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l54.120"></a><span id="l54.120" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l54.121"></a><span id="l54.121" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l54.122"></a><span id="l54.122" class="difflineplus">+    'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l54.123"></a><span id="l54.123" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l54.124"></a><span id="l54.124">     desc);</span>
<a href="#l54.125"></a><span id="l54.125">   event.select(new elementslib.ID(event.window.document, &quot;item-calendar&quot;), null, calendar);</span>
<a href="#l54.126"></a><span id="l54.126"> </span>
<a href="#l54.127"></a><span id="l54.127">   // save</span>
<a href="#l54.128"></a><span id="l54.128">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l54.129"></a><span id="l54.129"> </span>
<a href="#l54.130"></a><span id="l54.130">   // if it was created successfully, it can be opened</span>
<a href="#l54.131"></a><span id="l54.131" class="difflineminus">-  let eventBox = new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l54.132"></a><span id="l54.132" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l54.133"></a><span id="l54.133" class="difflineminus">-    + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l54.134"></a><span id="l54.134" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/[0]/'</span>
<a href="#l54.135"></a><span id="l54.135" class="difflineminus">-    + '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}');</span>
<a href="#l54.136"></a><span id="l54.136" class="difflineplus">+  let eventBox = new elementslib.Lookup(controller.window.document, dayView +</span>
<a href="#l54.137"></a><span id="l54.137" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/' +</span>
<a href="#l54.138"></a><span id="l54.138" class="difflineplus">+    '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/' +</span>
<a href="#l54.139"></a><span id="l54.139" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/[0]/' +</span>
<a href="#l54.140"></a><span id="l54.140" class="difflineplus">+    '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}');</span>
<a href="#l54.141"></a><span id="l54.141">   controller.waitForElement(eventBox);</span>
<a href="#l54.142"></a><span id="l54.142">   controller.doubleClick(eventBox);</span>
<a href="#l54.143"></a><span id="l54.143">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l54.144"></a><span id="l54.144">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l54.145"></a><span id="l54.145"> </span>
<a href="#l54.146"></a><span id="l54.146">   // change title and save changes</span>
<a href="#l54.147"></a><span id="l54.147" class="difflineminus">-  let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l54.148"></a><span id="l54.148" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l54.149"></a><span id="l54.149" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l54.150"></a><span id="l54.150" class="difflineplus">+  let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l54.151"></a><span id="l54.151" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l54.152"></a><span id="l54.152" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l54.153"></a><span id="l54.153">   event.waitForElement(titleTextBox);</span>
<a href="#l54.154"></a><span id="l54.154">   event.type(titleTextBox, title2);</span>
<a href="#l54.155"></a><span id="l54.155">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l54.156"></a><span id="l54.156"> </span>
<a href="#l54.157"></a><span id="l54.157">   // check if name was saved</span>
<a href="#l54.158"></a><span id="l54.158" class="difflineminus">-  let eventName = new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l54.159"></a><span id="l54.159" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l54.160"></a><span id="l54.160" class="difflineminus">-    + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l54.161"></a><span id="l54.161" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/'</span>
<a href="#l54.162"></a><span id="l54.162" class="difflineminus">-    + '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}/anon({&quot;flex&quot;:&quot;1&quot;})/'</span>
<a href="#l54.163"></a><span id="l54.163" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;event-container&quot;})/{&quot;class&quot;:&quot;calendar-event-selection&quot;}/'</span>
<a href="#l54.164"></a><span id="l54.164" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;eventbox&quot;})/{&quot;class&quot;:&quot;calendar-event-details&quot;}/anon({&quot;anonid&quot;:&quot;event-name&quot;})');</span>
<a href="#l54.165"></a><span id="l54.165" class="difflineplus">+  let eventName = new elementslib.Lookup(controller.window.document, dayView +</span>
<a href="#l54.166"></a><span id="l54.166" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/' +</span>
<a href="#l54.167"></a><span id="l54.167" class="difflineplus">+    '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/' +</span>
<a href="#l54.168"></a><span id="l54.168" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/' +</span>
<a href="#l54.169"></a><span id="l54.169" class="difflineplus">+    '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}/anon({&quot;flex&quot;:&quot;1&quot;})/' +</span>
<a href="#l54.170"></a><span id="l54.170" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;event-container&quot;})/{&quot;class&quot;:&quot;calendar-event-selection&quot;}/' +</span>
<a href="#l54.171"></a><span id="l54.171" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;eventbox&quot;})/{&quot;class&quot;:&quot;calendar-event-details&quot;}/anon({&quot;anonid&quot;:&quot;event-name&quot;})');</span>
<a href="#l54.172"></a><span id="l54.172">   controller.waitForElement(eventName);</span>
<a href="#l54.173"></a><span id="l54.173">   controller.assertJSProperty(eventName, &quot;textContent&quot;, title2);</span>
<a href="#l54.174"></a><span id="l54.174"> </span>
<a href="#l54.175"></a><span id="l54.175">   // delete event</span>
<a href="#l54.176"></a><span id="l54.176" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l54.177"></a><span id="l54.177" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l54.178"></a><span id="l54.178" class="difflineminus">-    + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l54.179"></a><span id="l54.179" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/'</span>
<a href="#l54.180"></a><span id="l54.180" class="difflineminus">-    + '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}'));</span>
<a href="#l54.181"></a><span id="l54.181" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, dayView +</span>
<a href="#l54.182"></a><span id="l54.182" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/' +</span>
<a href="#l54.183"></a><span id="l54.183" class="difflineplus">+    '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/' +</span>
<a href="#l54.184"></a><span id="l54.184" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/' +</span>
<a href="#l54.185"></a><span id="l54.185" class="difflineplus">+    '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}'));</span>
<a href="#l54.186"></a><span id="l54.186">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l54.187"></a><span id="l54.187">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l54.188"></a><span id="l54.188" class="difflineminus">-  controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l54.189"></a><span id="l54.189" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l54.190"></a><span id="l54.190" class="difflineminus">-    + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l54.191"></a><span id="l54.191" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/'</span>
<a href="#l54.192"></a><span id="l54.192" class="difflineminus">-    + '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}'));</span>
<a href="#l54.193"></a><span id="l54.193" class="difflineplus">+  controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, dayView +</span>
<a href="#l54.194"></a><span id="l54.194" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/' +</span>
<a href="#l54.195"></a><span id="l54.195" class="difflineplus">+    '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/' +</span>
<a href="#l54.196"></a><span id="l54.196" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/' +</span>
<a href="#l54.197"></a><span id="l54.197" class="difflineplus">+    '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}'));</span>
<a href="#l54.198"></a><span id="l54.198"> };</span>
<a href="#l54.199"></a><span id="l54.199"> </span>
<a href="#l54.200"></a><span id="l54.200"> var teardownTest = function(module) {</span>
<a href="#l54.201"></a><span id="l54.201">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l54.202"></a><span id="l54.202"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/calendar/test/mozmill/views/testMonthView.js</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testMonthView.js</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -14,120 +14,120 @@ var setupModule = function(module) {</span>
<a href="#l55.4"></a><span id="l55.4">   controller = mozmill.getMail3PaneController();</span>
<a href="#l55.5"></a><span id="l55.5">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l55.6"></a><span id="l55.6"> };</span>
<a href="#l55.7"></a><span id="l55.7"> </span>
<a href="#l55.8"></a><span id="l55.8"> var testMonthView = function() {</span>
<a href="#l55.9"></a><span id="l55.9">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l55.10"></a><span id="l55.10">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l55.11"></a><span id="l55.11">   // paths</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l55.14"></a><span id="l55.14" class="difflineminus">-    + 'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l55.15"></a><span id="l55.15" class="difflineminus">-  let monthView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l55.16"></a><span id="l55.16" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/'</span>
<a href="#l55.17"></a><span id="l55.17" class="difflineminus">-    + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;month-view&quot;)/';</span>
<a href="#l55.18"></a><span id="l55.18" class="difflineplus">+  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l55.19"></a><span id="l55.19" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/' +</span>
<a href="#l55.20"></a><span id="l55.20" class="difflineplus">+    'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l55.21"></a><span id="l55.21" class="difflineplus">+  let monthView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l55.22"></a><span id="l55.22" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/' +</span>
<a href="#l55.23"></a><span id="l55.23" class="difflineplus">+    'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;month-view&quot;)/';</span>
<a href="#l55.24"></a><span id="l55.24">   let eventDialog = '/id(&quot;calendar-event-dialog&quot;)/id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/';</span>
<a href="#l55.25"></a><span id="l55.25" class="difflineminus">-  let eventBox = monthView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/'</span>
<a href="#l55.26"></a><span id="l55.26" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[0]/{&quot;selected&quot;:&quot;true&quot;}/'</span>
<a href="#l55.27"></a><span id="l55.27" class="difflineminus">-    + '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}/anon({&quot;flex&quot;:&quot;1&quot;})/'</span>
<a href="#l55.28"></a><span id="l55.28" class="difflineminus">-    + '[0]/anon({&quot;anonid&quot;:&quot;event-container&quot;})/{&quot;class&quot;:&quot;calendar-event-selection&quot;}/'</span>
<a href="#l55.29"></a><span id="l55.29" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;eventbox&quot;})/{&quot;class&quot;:&quot;calendar-event-details&quot;}';</span>
<a href="#l55.30"></a><span id="l55.30" class="difflineplus">+  let eventBox = monthView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/' +</span>
<a href="#l55.31"></a><span id="l55.31" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[0]/{&quot;selected&quot;:&quot;true&quot;}/' +</span>
<a href="#l55.32"></a><span id="l55.32" class="difflineplus">+    '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}/anon({&quot;flex&quot;:&quot;1&quot;})/' +</span>
<a href="#l55.33"></a><span id="l55.33" class="difflineplus">+    '[0]/anon({&quot;anonid&quot;:&quot;event-container&quot;})/{&quot;class&quot;:&quot;calendar-event-selection&quot;}/' +</span>
<a href="#l55.34"></a><span id="l55.34" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;eventbox&quot;})/{&quot;class&quot;:&quot;calendar-event-details&quot;}';</span>
<a href="#l55.35"></a><span id="l55.35"> </span>
<a href="#l55.36"></a><span id="l55.36">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l55.37"></a><span id="l55.37">   controller.waitThenClick(new elementslib.ID(controller.window.document, &quot;calendar-month-view-button&quot;));</span>
<a href="#l55.38"></a><span id="l55.38"> </span>
<a href="#l55.39"></a><span id="l55.39">   // pick year</span>
<a href="#l55.40"></a><span id="l55.40" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l55.41"></a><span id="l55.41" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l55.42"></a><span id="l55.42" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l55.43"></a><span id="l55.43" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l55.44"></a><span id="l55.44" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;2009&quot;}'));</span>
<a href="#l55.45"></a><span id="l55.45" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l55.46"></a><span id="l55.46" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l55.47"></a><span id="l55.47" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l55.48"></a><span id="l55.48" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l55.49"></a><span id="l55.49" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;2009&quot;}'));</span>
<a href="#l55.50"></a><span id="l55.50"> </span>
<a href="#l55.51"></a><span id="l55.51">   // pick month</span>
<a href="#l55.52"></a><span id="l55.52" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l55.53"></a><span id="l55.53" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})'));</span>
<a href="#l55.54"></a><span id="l55.54" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l55.55"></a><span id="l55.55" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l55.56"></a><span id="l55.56" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;0&quot;}'));</span>
<a href="#l55.57"></a><span id="l55.57" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l55.58"></a><span id="l55.58" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})'));</span>
<a href="#l55.59"></a><span id="l55.59" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l55.60"></a><span id="l55.60" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l55.61"></a><span id="l55.61" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;0&quot;}'));</span>
<a href="#l55.62"></a><span id="l55.62"> </span>
<a href="#l55.63"></a><span id="l55.63">   // pick day</span>
<a href="#l55.64"></a><span id="l55.64" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l55.65"></a><span id="l55.65" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l55.66"></a><span id="l55.66" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l55.67"></a><span id="l55.67" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l55.68"></a><span id="l55.68"> </span>
<a href="#l55.69"></a><span id="l55.69">   // verify date</span>
<a href="#l55.70"></a><span id="l55.70" class="difflineminus">-  let day = new elementslib.Lookup(controller.window.document, monthView</span>
<a href="#l55.71"></a><span id="l55.71" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/'</span>
<a href="#l55.72"></a><span id="l55.72" class="difflineminus">-    + '[0]/{&quot;selected&quot;:&quot;true&quot;}');</span>
<a href="#l55.73"></a><span id="l55.73" class="difflineplus">+  let day = new elementslib.Lookup(controller.window.document, monthView +</span>
<a href="#l55.74"></a><span id="l55.74" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/' +</span>
<a href="#l55.75"></a><span id="l55.75" class="difflineplus">+    '[0]/{&quot;selected&quot;:&quot;true&quot;}');</span>
<a href="#l55.76"></a><span id="l55.76">   controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;;});</span>
<a href="#l55.77"></a><span id="l55.77"> </span>
<a href="#l55.78"></a><span id="l55.78">   // create event</span>
<a href="#l55.79"></a><span id="l55.79">   // Thursday of 2009-01-01 should be the selected box in the first row with default settings</span>
<a href="#l55.80"></a><span id="l55.80">   let hour = new Date().getHours(); // remember time at click</span>
<a href="#l55.81"></a><span id="l55.81" class="difflineminus">-  controller.doubleClick(new elementslib.Lookup(controller.window.document, monthView</span>
<a href="#l55.82"></a><span id="l55.82" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/'</span>
<a href="#l55.83"></a><span id="l55.83" class="difflineminus">-    + '[0]/{&quot;selected&quot;:&quot;true&quot;}/anon({&quot;anonid&quot;:&quot;day-items&quot;})'));</span>
<a href="#l55.84"></a><span id="l55.84" class="difflineplus">+  controller.doubleClick(new elementslib.Lookup(controller.window.document, monthView +</span>
<a href="#l55.85"></a><span id="l55.85" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/' +</span>
<a href="#l55.86"></a><span id="l55.86" class="difflineplus">+    '[0]/{&quot;selected&quot;:&quot;true&quot;}/anon({&quot;anonid&quot;:&quot;day-items&quot;})'));</span>
<a href="#l55.87"></a><span id="l55.87">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l55.88"></a><span id="l55.88">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l55.89"></a><span id="l55.89"> </span>
<a href="#l55.90"></a><span id="l55.90">   // check that the start time is correct</span>
<a href="#l55.91"></a><span id="l55.91">   // next full hour except last hour hour of the day</span>
<a href="#l55.92"></a><span id="l55.92">   let nextHour = (hour == 23) ? hour : (hour + 1) % 24;</span>
<a href="#l55.93"></a><span id="l55.93">   let startTime = nextHour + ':00'; // next full hour</span>
<a href="#l55.94"></a><span id="l55.94" class="difflineminus">-  let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l55.95"></a><span id="l55.95" class="difflineminus">-    + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l55.96"></a><span id="l55.96" class="difflineminus">-    + 'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/'</span>
<a href="#l55.97"></a><span id="l55.97" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/'</span>
<a href="#l55.98"></a><span id="l55.98" class="difflineminus">-    + 'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l55.99"></a><span id="l55.99" class="difflineplus">+  let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l55.100"></a><span id="l55.100" class="difflineplus">+    'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l55.101"></a><span id="l55.101" class="difflineplus">+    'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/' +</span>
<a href="#l55.102"></a><span id="l55.102" class="difflineplus">+    'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/' +</span>
<a href="#l55.103"></a><span id="l55.103" class="difflineplus">+    'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l55.104"></a><span id="l55.104">   event.waitForElement(startTimeInput);</span>
<a href="#l55.105"></a><span id="l55.105">   event.assertValue(startTimeInput, startTime);</span>
<a href="#l55.106"></a><span id="l55.106">   let date = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l55.107"></a><span id="l55.107">     2009, 1, 1);</span>
<a href="#l55.108"></a><span id="l55.108" class="difflineminus">-  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l55.109"></a><span id="l55.109" class="difflineminus">-    + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l55.110"></a><span id="l55.110" class="difflineminus">-    + 'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/'</span>
<a href="#l55.111"></a><span id="l55.111" class="difflineminus">-    + 'anon({&quot;flex&quot;:&quot;1&quot;,&quot;id&quot;:&quot;hbox&quot;,&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l55.112"></a><span id="l55.112" class="difflineminus">-    + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l55.113"></a><span id="l55.113" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l55.114"></a><span id="l55.114" class="difflineplus">+  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l55.115"></a><span id="l55.115" class="difflineplus">+    'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l55.116"></a><span id="l55.116" class="difflineplus">+    'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' +</span>
<a href="#l55.117"></a><span id="l55.117" class="difflineplus">+    'anon({&quot;flex&quot;:&quot;1&quot;,&quot;id&quot;:&quot;hbox&quot;,&quot;class&quot;:&quot;datepicker-box-class&quot;})/' +</span>
<a href="#l55.118"></a><span id="l55.118" class="difflineplus">+    '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/' +</span>
<a href="#l55.119"></a><span id="l55.119" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l55.120"></a><span id="l55.120">     date);</span>
<a href="#l55.121"></a><span id="l55.121"> </span>
<a href="#l55.122"></a><span id="l55.122">   // fill in title, description and calendar</span>
<a href="#l55.123"></a><span id="l55.123" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l55.124"></a><span id="l55.124" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l55.125"></a><span id="l55.125" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l55.126"></a><span id="l55.126" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l55.127"></a><span id="l55.127" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l55.128"></a><span id="l55.128" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l55.129"></a><span id="l55.129">     title1);</span>
<a href="#l55.130"></a><span id="l55.130" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l55.131"></a><span id="l55.131" class="difflineminus">-    + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l55.132"></a><span id="l55.132" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l55.133"></a><span id="l55.133" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l55.134"></a><span id="l55.134" class="difflineplus">+    'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l55.135"></a><span id="l55.135" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l55.136"></a><span id="l55.136">     desc);</span>
<a href="#l55.137"></a><span id="l55.137">   event.click(new elementslib.ID(event.window.document, &quot;item-calendar&quot;));</span>
<a href="#l55.138"></a><span id="l55.138" class="difflineminus">-  event.click(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l55.139"></a><span id="l55.139" class="difflineminus">-    + 'id(&quot;event-grid-category-color-row&quot;)/id(&quot;event-grid-category-box&quot;)/id(&quot;item-calendar&quot;)/'</span>
<a href="#l55.140"></a><span id="l55.140" class="difflineminus">-    + '[0]/{&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l55.141"></a><span id="l55.141" class="difflineplus">+  event.click(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l55.142"></a><span id="l55.142" class="difflineplus">+    'id(&quot;event-grid-category-color-row&quot;)/id(&quot;event-grid-category-box&quot;)/id(&quot;item-calendar&quot;)/' +</span>
<a href="#l55.143"></a><span id="l55.143" class="difflineplus">+    '[0]/{&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l55.144"></a><span id="l55.144"> </span>
<a href="#l55.145"></a><span id="l55.145">   // save</span>
<a href="#l55.146"></a><span id="l55.146">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l55.147"></a><span id="l55.147"> </span>
<a href="#l55.148"></a><span id="l55.148">   // if it was created successfully, it can be opened</span>
<a href="#l55.149"></a><span id="l55.149">   controller.waitForElement(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l55.150"></a><span id="l55.150">   controller.doubleClick(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l55.151"></a><span id="l55.151">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l55.152"></a><span id="l55.152">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l55.153"></a><span id="l55.153"> </span>
<a href="#l55.154"></a><span id="l55.154">   // change title and save changes</span>
<a href="#l55.155"></a><span id="l55.155" class="difflineminus">-  let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l55.156"></a><span id="l55.156" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l55.157"></a><span id="l55.157" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l55.158"></a><span id="l55.158" class="difflineplus">+  let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l55.159"></a><span id="l55.159" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l55.160"></a><span id="l55.160" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l55.161"></a><span id="l55.161">   event.waitForElement(titleTextBox);</span>
<a href="#l55.162"></a><span id="l55.162">   event.type(titleTextBox, title2);</span>
<a href="#l55.163"></a><span id="l55.163">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l55.164"></a><span id="l55.164"> </span>
<a href="#l55.165"></a><span id="l55.165">   // check if name was saved</span>
<a href="#l55.166"></a><span id="l55.166" class="difflineminus">-  let eventName = new elementslib.Lookup(controller.window.document, eventBox</span>
<a href="#l55.167"></a><span id="l55.167" class="difflineminus">-    + '/{&quot;flex&quot;:&quot;1&quot;}/anon({&quot;anonid&quot;:&quot;event-name&quot;})');</span>
<a href="#l55.168"></a><span id="l55.168" class="difflineplus">+  let eventName = new elementslib.Lookup(controller.window.document, eventBox +</span>
<a href="#l55.169"></a><span id="l55.169" class="difflineplus">+    '/{&quot;flex&quot;:&quot;1&quot;}/anon({&quot;anonid&quot;:&quot;event-name&quot;})');</span>
<a href="#l55.170"></a><span id="l55.170">   controller.waitForElement(eventName);</span>
<a href="#l55.171"></a><span id="l55.171">   controller.assertValue(eventName, title2);</span>
<a href="#l55.172"></a><span id="l55.172"> </span>
<a href="#l55.173"></a><span id="l55.173">   // delete event</span>
<a href="#l55.174"></a><span id="l55.174">   controller.click(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l55.175"></a><span id="l55.175">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l55.176"></a><span id="l55.176">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l55.177"></a><span id="l55.177">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, eventBox));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/calendar/test/mozmill/views/testMultiweekView.js</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testMultiweekView.js</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -14,120 +14,120 @@ var setupModule = function(module) {</span>
<a href="#l56.4"></a><span id="l56.4">   controller = mozmill.getMail3PaneController();</span>
<a href="#l56.5"></a><span id="l56.5">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l56.6"></a><span id="l56.6"> };</span>
<a href="#l56.7"></a><span id="l56.7"> </span>
<a href="#l56.8"></a><span id="l56.8"> var testMultiWeekView = function() {</span>
<a href="#l56.9"></a><span id="l56.9">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l56.10"></a><span id="l56.10">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l56.11"></a><span id="l56.11">   // paths</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l56.14"></a><span id="l56.14" class="difflineminus">-    + 'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l56.15"></a><span id="l56.15" class="difflineminus">-  let multiWeekView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l56.16"></a><span id="l56.16" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/'</span>
<a href="#l56.17"></a><span id="l56.17" class="difflineminus">-    + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;multiweek-view&quot;)/';</span>
<a href="#l56.18"></a><span id="l56.18" class="difflineplus">+  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l56.19"></a><span id="l56.19" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/' +</span>
<a href="#l56.20"></a><span id="l56.20" class="difflineplus">+    'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l56.21"></a><span id="l56.21" class="difflineplus">+  let multiWeekView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l56.22"></a><span id="l56.22" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/' +</span>
<a href="#l56.23"></a><span id="l56.23" class="difflineplus">+    'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;multiweek-view&quot;)/';</span>
<a href="#l56.24"></a><span id="l56.24">   let eventDialog = '/id(&quot;calendar-event-dialog&quot;)/id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/';</span>
<a href="#l56.25"></a><span id="l56.25" class="difflineminus">-  let eventBox = multiWeekView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/'</span>
<a href="#l56.26"></a><span id="l56.26" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[0]/{&quot;selected&quot;:&quot;true&quot;}/'</span>
<a href="#l56.27"></a><span id="l56.27" class="difflineminus">-    + '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}/anon({&quot;flex&quot;:&quot;1&quot;})/'</span>
<a href="#l56.28"></a><span id="l56.28" class="difflineminus">-    + '[0]/anon({&quot;anonid&quot;:&quot;event-container&quot;})/{&quot;class&quot;:&quot;calendar-event-selection&quot;}/'</span>
<a href="#l56.29"></a><span id="l56.29" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;eventbox&quot;})/{&quot;class&quot;:&quot;calendar-event-details&quot;}';</span>
<a href="#l56.30"></a><span id="l56.30" class="difflineplus">+  let eventBox = multiWeekView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/' +</span>
<a href="#l56.31"></a><span id="l56.31" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[0]/{&quot;selected&quot;:&quot;true&quot;}/' +</span>
<a href="#l56.32"></a><span id="l56.32" class="difflineplus">+    '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}/anon({&quot;flex&quot;:&quot;1&quot;})/' +</span>
<a href="#l56.33"></a><span id="l56.33" class="difflineplus">+    '[0]/anon({&quot;anonid&quot;:&quot;event-container&quot;})/{&quot;class&quot;:&quot;calendar-event-selection&quot;}/' +</span>
<a href="#l56.34"></a><span id="l56.34" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;eventbox&quot;})/{&quot;class&quot;:&quot;calendar-event-details&quot;}';</span>
<a href="#l56.35"></a><span id="l56.35"> </span>
<a href="#l56.36"></a><span id="l56.36">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l56.37"></a><span id="l56.37">   controller.waitThenClick(new elementslib.ID(controller.window.document, &quot;calendar-multiweek-view-button&quot;));</span>
<a href="#l56.38"></a><span id="l56.38"> </span>
<a href="#l56.39"></a><span id="l56.39">   // pick year</span>
<a href="#l56.40"></a><span id="l56.40" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l56.41"></a><span id="l56.41" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l56.42"></a><span id="l56.42" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l56.43"></a><span id="l56.43" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l56.44"></a><span id="l56.44" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;2009&quot;}'));</span>
<a href="#l56.45"></a><span id="l56.45" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l56.46"></a><span id="l56.46" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l56.47"></a><span id="l56.47" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l56.48"></a><span id="l56.48" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l56.49"></a><span id="l56.49" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;2009&quot;}'));</span>
<a href="#l56.50"></a><span id="l56.50"> </span>
<a href="#l56.51"></a><span id="l56.51">   // pick month</span>
<a href="#l56.52"></a><span id="l56.52" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l56.53"></a><span id="l56.53" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})'));</span>
<a href="#l56.54"></a><span id="l56.54" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l56.55"></a><span id="l56.55" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l56.56"></a><span id="l56.56" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;0&quot;}'));</span>
<a href="#l56.57"></a><span id="l56.57" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l56.58"></a><span id="l56.58" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})'));</span>
<a href="#l56.59"></a><span id="l56.59" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l56.60"></a><span id="l56.60" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l56.61"></a><span id="l56.61" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;0&quot;}'));</span>
<a href="#l56.62"></a><span id="l56.62"> </span>
<a href="#l56.63"></a><span id="l56.63">   // pick day</span>
<a href="#l56.64"></a><span id="l56.64" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l56.65"></a><span id="l56.65" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l56.66"></a><span id="l56.66" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l56.67"></a><span id="l56.67" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l56.68"></a><span id="l56.68"> </span>
<a href="#l56.69"></a><span id="l56.69">   // verify date</span>
<a href="#l56.70"></a><span id="l56.70" class="difflineminus">-  let day = new elementslib.Lookup(controller.window.document, multiWeekView</span>
<a href="#l56.71"></a><span id="l56.71" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/'</span>
<a href="#l56.72"></a><span id="l56.72" class="difflineminus">-    + '[0]/{&quot;selected&quot;:&quot;true&quot;}');</span>
<a href="#l56.73"></a><span id="l56.73" class="difflineplus">+  let day = new elementslib.Lookup(controller.window.document, multiWeekView +</span>
<a href="#l56.74"></a><span id="l56.74" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/' +</span>
<a href="#l56.75"></a><span id="l56.75" class="difflineplus">+    '[0]/{&quot;selected&quot;:&quot;true&quot;}');</span>
<a href="#l56.76"></a><span id="l56.76">   controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;;});</span>
<a href="#l56.77"></a><span id="l56.77"> </span>
<a href="#l56.78"></a><span id="l56.78">   // create event</span>
<a href="#l56.79"></a><span id="l56.79">   // Thursday of 2009-01-01 should be the selected box in the first row with default settings</span>
<a href="#l56.80"></a><span id="l56.80">   let hour = new Date().getHours(); // remember time at click</span>
<a href="#l56.81"></a><span id="l56.81" class="difflineminus">-  controller.doubleClick(new elementslib.Lookup(controller.window.document, multiWeekView</span>
<a href="#l56.82"></a><span id="l56.82" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/'</span>
<a href="#l56.83"></a><span id="l56.83" class="difflineminus">-    + '[0]/{&quot;selected&quot;:&quot;true&quot;}/anon({&quot;anonid&quot;:&quot;day-items&quot;})'));</span>
<a href="#l56.84"></a><span id="l56.84" class="difflineplus">+  controller.doubleClick(new elementslib.Lookup(controller.window.document, multiWeekView +</span>
<a href="#l56.85"></a><span id="l56.85" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/' +</span>
<a href="#l56.86"></a><span id="l56.86" class="difflineplus">+    '[0]/{&quot;selected&quot;:&quot;true&quot;}/anon({&quot;anonid&quot;:&quot;day-items&quot;})'));</span>
<a href="#l56.87"></a><span id="l56.87">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l56.88"></a><span id="l56.88">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l56.89"></a><span id="l56.89"> </span>
<a href="#l56.90"></a><span id="l56.90">   // check that the start time is correct</span>
<a href="#l56.91"></a><span id="l56.91">   // next full hour except last hour hour of the day</span>
<a href="#l56.92"></a><span id="l56.92">   let nextHour = (hour == 23) ? hour : (hour + 1) % 24;</span>
<a href="#l56.93"></a><span id="l56.93">   let startTime = nextHour + ':00';</span>
<a href="#l56.94"></a><span id="l56.94" class="difflineminus">-  let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l56.95"></a><span id="l56.95" class="difflineminus">-    + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l56.96"></a><span id="l56.96" class="difflineminus">-    + 'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/'</span>
<a href="#l56.97"></a><span id="l56.97" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/'</span>
<a href="#l56.98"></a><span id="l56.98" class="difflineminus">-    + 'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l56.99"></a><span id="l56.99" class="difflineplus">+  let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l56.100"></a><span id="l56.100" class="difflineplus">+    'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l56.101"></a><span id="l56.101" class="difflineplus">+    'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/' +</span>
<a href="#l56.102"></a><span id="l56.102" class="difflineplus">+    'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/' +</span>
<a href="#l56.103"></a><span id="l56.103" class="difflineplus">+    'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l56.104"></a><span id="l56.104">   event.waitForElement(startTimeInput);</span>
<a href="#l56.105"></a><span id="l56.105">   event.assertValue(startTimeInput, startTime);</span>
<a href="#l56.106"></a><span id="l56.106">   let date = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l56.107"></a><span id="l56.107">     2009, 1, 1);</span>
<a href="#l56.108"></a><span id="l56.108" class="difflineminus">-  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l56.109"></a><span id="l56.109" class="difflineminus">-    + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l56.110"></a><span id="l56.110" class="difflineminus">-    + 'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/'</span>
<a href="#l56.111"></a><span id="l56.111" class="difflineminus">-    + 'anon({&quot;flex&quot;:&quot;1&quot;,&quot;id&quot;:&quot;hbox&quot;,&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l56.112"></a><span id="l56.112" class="difflineminus">-    + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l56.113"></a><span id="l56.113" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l56.114"></a><span id="l56.114" class="difflineplus">+  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l56.115"></a><span id="l56.115" class="difflineplus">+    'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l56.116"></a><span id="l56.116" class="difflineplus">+    'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' +</span>
<a href="#l56.117"></a><span id="l56.117" class="difflineplus">+    'anon({&quot;flex&quot;:&quot;1&quot;,&quot;id&quot;:&quot;hbox&quot;,&quot;class&quot;:&quot;datepicker-box-class&quot;})/' +</span>
<a href="#l56.118"></a><span id="l56.118" class="difflineplus">+    '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/' +</span>
<a href="#l56.119"></a><span id="l56.119" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l56.120"></a><span id="l56.120">     date);</span>
<a href="#l56.121"></a><span id="l56.121"> </span>
<a href="#l56.122"></a><span id="l56.122">   // fill in title, description and calendar</span>
<a href="#l56.123"></a><span id="l56.123" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l56.124"></a><span id="l56.124" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l56.125"></a><span id="l56.125" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l56.126"></a><span id="l56.126" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l56.127"></a><span id="l56.127" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l56.128"></a><span id="l56.128" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l56.129"></a><span id="l56.129">     title1);</span>
<a href="#l56.130"></a><span id="l56.130" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l56.131"></a><span id="l56.131" class="difflineminus">-    + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l56.132"></a><span id="l56.132" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l56.133"></a><span id="l56.133" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l56.134"></a><span id="l56.134" class="difflineplus">+    'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l56.135"></a><span id="l56.135" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l56.136"></a><span id="l56.136">     desc);</span>
<a href="#l56.137"></a><span id="l56.137">   event.click(new elementslib.ID(event.window.document, &quot;item-calendar&quot;));</span>
<a href="#l56.138"></a><span id="l56.138" class="difflineminus">-  event.click(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l56.139"></a><span id="l56.139" class="difflineminus">-    + 'id(&quot;event-grid-category-color-row&quot;)/id(&quot;event-grid-category-box&quot;)/id(&quot;item-calendar&quot;)/'</span>
<a href="#l56.140"></a><span id="l56.140" class="difflineminus">-    + '[0]/{&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l56.141"></a><span id="l56.141" class="difflineplus">+  event.click(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l56.142"></a><span id="l56.142" class="difflineplus">+    'id(&quot;event-grid-category-color-row&quot;)/id(&quot;event-grid-category-box&quot;)/id(&quot;item-calendar&quot;)/' +</span>
<a href="#l56.143"></a><span id="l56.143" class="difflineplus">+    '[0]/{&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l56.144"></a><span id="l56.144"> </span>
<a href="#l56.145"></a><span id="l56.145">   // save</span>
<a href="#l56.146"></a><span id="l56.146">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l56.147"></a><span id="l56.147"> </span>
<a href="#l56.148"></a><span id="l56.148">   // if it was created successfully, it can be opened</span>
<a href="#l56.149"></a><span id="l56.149">   controller.waitForElement(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l56.150"></a><span id="l56.150">   controller.doubleClick(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l56.151"></a><span id="l56.151">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l56.152"></a><span id="l56.152">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l56.153"></a><span id="l56.153"> </span>
<a href="#l56.154"></a><span id="l56.154">   // change title and save changes</span>
<a href="#l56.155"></a><span id="l56.155" class="difflineminus">-  let titmeTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l56.156"></a><span id="l56.156" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l56.157"></a><span id="l56.157" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l56.158"></a><span id="l56.158" class="difflineplus">+  let titmeTextBox = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l56.159"></a><span id="l56.159" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l56.160"></a><span id="l56.160" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l56.161"></a><span id="l56.161">   event.waitForElement(titmeTextBox);</span>
<a href="#l56.162"></a><span id="l56.162">   event.type(titmeTextBox, title2);</span>
<a href="#l56.163"></a><span id="l56.163">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l56.164"></a><span id="l56.164"> </span>
<a href="#l56.165"></a><span id="l56.165">   // check if name was saved</span>
<a href="#l56.166"></a><span id="l56.166" class="difflineminus">-  let eventName = new elementslib.Lookup(controller.window.document, eventBox</span>
<a href="#l56.167"></a><span id="l56.167" class="difflineminus">-    + '/{&quot;flex&quot;:&quot;1&quot;}/anon({&quot;anonid&quot;:&quot;event-name&quot;})');</span>
<a href="#l56.168"></a><span id="l56.168" class="difflineplus">+  let eventName = new elementslib.Lookup(controller.window.document, eventBox +</span>
<a href="#l56.169"></a><span id="l56.169" class="difflineplus">+    '/{&quot;flex&quot;:&quot;1&quot;}/anon({&quot;anonid&quot;:&quot;event-name&quot;})');</span>
<a href="#l56.170"></a><span id="l56.170">   controller.waitForElement(eventName);</span>
<a href="#l56.171"></a><span id="l56.171">   controller.assertValue(eventName, title2);</span>
<a href="#l56.172"></a><span id="l56.172"> </span>
<a href="#l56.173"></a><span id="l56.173">   // delete event</span>
<a href="#l56.174"></a><span id="l56.174">   controller.click(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l56.175"></a><span id="l56.175">   controller.keypress(new elementslib.ID(controller.window.document, &quot;multiweek-view&quot;),</span>
<a href="#l56.176"></a><span id="l56.176">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l56.177"></a><span id="l56.177">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, eventBox));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/calendar/test/mozmill/views/testTaskView.js</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testTaskView.js</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -15,53 +15,53 @@ var setupModule = function(module) {</span>
<a href="#l57.4"></a><span id="l57.4">   controller = mozmill.getMail3PaneController();</span>
<a href="#l57.5"></a><span id="l57.5">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l57.6"></a><span id="l57.6"> };</span>
<a href="#l57.7"></a><span id="l57.7"> </span>
<a href="#l57.8"></a><span id="l57.8"> // mozmill doesn't support trees yet, therefore completed checkbox and line-through style are not</span>
<a href="#l57.9"></a><span id="l57.9"> // checked</span>
<a href="#l57.10"></a><span id="l57.10"> var testTaskView = function() {</span>
<a href="#l57.11"></a><span id="l57.11">   // paths</span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-  let taskView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/'</span>
<a href="#l57.14"></a><span id="l57.14" class="difflineminus">-    + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-task-box&quot;)/';</span>
<a href="#l57.15"></a><span id="l57.15" class="difflineplus">+  let taskView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l57.16"></a><span id="l57.16" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/' +</span>
<a href="#l57.17"></a><span id="l57.17" class="difflineplus">+    'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-task-box&quot;)/';</span>
<a href="#l57.18"></a><span id="l57.18">   let taskDialog = '/id(&quot;calendar-task-dialog&quot;)/id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/';</span>
<a href="#l57.19"></a><span id="l57.19" class="difflineminus">-  let treeChildren = taskView + '[1]/id(&quot;calendar-task-tree&quot;)/anon({&quot;anonid&quot;:&quot;calendar-task-tree&quot;})/'</span>
<a href="#l57.20"></a><span id="l57.20" class="difflineminus">-    + '{&quot;tooltip&quot;:&quot;taskTreeTooltip&quot;}';</span>
<a href="#l57.21"></a><span id="l57.21" class="difflineplus">+  let treeChildren = taskView + '[1]/id(&quot;calendar-task-tree&quot;)/anon({&quot;anonid&quot;:&quot;calendar-task-tree&quot;})/' +</span>
<a href="#l57.22"></a><span id="l57.22" class="difflineplus">+    '{&quot;tooltip&quot;:&quot;taskTreeTooltip&quot;}';</span>
<a href="#l57.23"></a><span id="l57.23">   let taskTree = taskView + '[1]/id(&quot;calendar-task-tree&quot;)';</span>
<a href="#l57.24"></a><span id="l57.24">   let toolTip = '/id(&quot;messengerWindow&quot;)/id(&quot;calendar-popupset&quot;)/id(&quot;taskTreeTooltip&quot;)';</span>
<a href="#l57.25"></a><span id="l57.25">   let toolTipGrid = toolTip + '/{&quot;class&quot;:&quot;tooltipBox&quot;}/{&quot;class&quot;:&quot;tooltipHeaderGrid&quot;}/';</span>
<a href="#l57.26"></a><span id="l57.26"> </span>
<a href="#l57.27"></a><span id="l57.27">   // open task view</span>
<a href="#l57.28"></a><span id="l57.28">   controller.click(new elementslib.ID(controller.window.document, &quot;task-tab-button&quot;));</span>
<a href="#l57.29"></a><span id="l57.29">   controller.sleep(sleep);</span>
<a href="#l57.30"></a><span id="l57.30"> </span>
<a href="#l57.31"></a><span id="l57.31">   // make sure that testing calendar is selected</span>
<a href="#l57.32"></a><span id="l57.32">   let calendarTree = (new elementslib.Lookup(controller.window.document,</span>
<a href="#l57.33"></a><span id="l57.33" class="difflineminus">-    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/'</span>
<a href="#l57.34"></a><span id="l57.34" class="difflineminus">-    + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/id(&quot;calendar-panel&quot;)/'</span>
<a href="#l57.35"></a><span id="l57.35" class="difflineminus">-    + 'id(&quot;calendar-list-pane&quot;)/id(&quot;calendar-listtree-pane&quot;)/id(&quot;calendar-list-tree-widget&quot;)'))</span>
<a href="#l57.36"></a><span id="l57.36" class="difflineplus">+    '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/' +</span>
<a href="#l57.37"></a><span id="l57.37" class="difflineplus">+    'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/id(&quot;calendar-panel&quot;)/' +</span>
<a href="#l57.38"></a><span id="l57.38" class="difflineplus">+    'id(&quot;calendar-list-pane&quot;)/id(&quot;calendar-listtree-pane&quot;)/id(&quot;calendar-list-tree-widget&quot;)'))</span>
<a href="#l57.39"></a><span id="l57.39">     .getNode();</span>
<a href="#l57.40"></a><span id="l57.40">   for (i = 0; i &lt; calendarTree.mCalendarList.length; i++) {</span>
<a href="#l57.41"></a><span id="l57.41">     if (calendarTree.mCalendarList[i].name == calendar) {</span>
<a href="#l57.42"></a><span id="l57.42">       calendarTree.tree.view.selection.select(i);</span>
<a href="#l57.43"></a><span id="l57.43">     }</span>
<a href="#l57.44"></a><span id="l57.44">   }</span>
<a href="#l57.45"></a><span id="l57.45"> </span>
<a href="#l57.46"></a><span id="l57.46">   let taskTreeNode = (new elementslib.Lookup(controller.window.document, taskTree)).getNode();</span>
<a href="#l57.47"></a><span id="l57.47">   let countBefore = taskTreeNode.mTaskArray.length;</span>
<a href="#l57.48"></a><span id="l57.48"> </span>
<a href="#l57.49"></a><span id="l57.49">   // add task</span>
<a href="#l57.50"></a><span id="l57.50" class="difflineminus">-  controller.type(new elementslib.Lookup(controller.window.document, taskView</span>
<a href="#l57.51"></a><span id="l57.51" class="difflineminus">-    + 'id(&quot;task-addition-box&quot;)/id(&quot;view-task-edit-field&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l57.52"></a><span id="l57.52" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.53"></a><span id="l57.53" class="difflineplus">+  controller.type(new elementslib.Lookup(controller.window.document, taskView +</span>
<a href="#l57.54"></a><span id="l57.54" class="difflineplus">+    'id(&quot;task-addition-box&quot;)/id(&quot;view-task-edit-field&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l57.55"></a><span id="l57.55" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.56"></a><span id="l57.56">     title);</span>
<a href="#l57.57"></a><span id="l57.57" class="difflineminus">-  controller.keypress(new elementslib.Lookup(controller.window.document, taskView</span>
<a href="#l57.58"></a><span id="l57.58" class="difflineminus">-    + 'id(&quot;task-addition-box&quot;)/id(&quot;view-task-edit-field&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l57.59"></a><span id="l57.59" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.60"></a><span id="l57.60" class="difflineplus">+  controller.keypress(new elementslib.Lookup(controller.window.document, taskView +</span>
<a href="#l57.61"></a><span id="l57.61" class="difflineplus">+    'id(&quot;task-addition-box&quot;)/id(&quot;view-task-edit-field&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l57.62"></a><span id="l57.62" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.63"></a><span id="l57.63">     &quot;VK_RETURN&quot;,</span>
<a href="#l57.64"></a><span id="l57.64">     {});</span>
<a href="#l57.65"></a><span id="l57.65"> </span>
<a href="#l57.66"></a><span id="l57.66">   // verify added</span>
<a href="#l57.67"></a><span id="l57.67">   let countAfter;</span>
<a href="#l57.68"></a><span id="l57.68">   controller.waitFor(function() {</span>
<a href="#l57.69"></a><span id="l57.69">     countAfter = taskTreeNode.mTaskArray.length;</span>
<a href="#l57.70"></a><span id="l57.70">     return countBefore + 1 == countAfter;</span>
<a href="#l57.71"></a><span id="l57.71" class="difflineat">@@ -74,47 +74,47 @@ var testTaskView = function() {</span>
<a href="#l57.72"></a><span id="l57.72">   // open added task</span>
<a href="#l57.73"></a><span id="l57.73">   // doubleclick on completion checkbox is ignored as opening action, so don't click at immediate</span>
<a href="#l57.74"></a><span id="l57.74">   // left where the checkbox is located</span>
<a href="#l57.75"></a><span id="l57.75">   controller.doubleClick(new elementslib.Lookup(controller.window.document, treeChildren), 50, 0);</span>
<a href="#l57.76"></a><span id="l57.76">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l57.77"></a><span id="l57.77">   let task = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l57.78"></a><span id="l57.78"> </span>
<a href="#l57.79"></a><span id="l57.79">   // verify calendar</span>
<a href="#l57.80"></a><span id="l57.80" class="difflineminus">-  task.waitForElement(new elementslib.Lookup(task.window.document, taskDialog</span>
<a href="#l57.81"></a><span id="l57.81" class="difflineminus">-    + 'id(&quot;event-grid-category-color-row&quot;)/id(&quot;event-grid-category-box&quot;)/id(&quot;item-calendar&quot;)/[0]/'</span>
<a href="#l57.82"></a><span id="l57.82" class="difflineminus">-    + '{&quot;selected&quot;:&quot;true&quot;,&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l57.83"></a><span id="l57.83" class="difflineplus">+  task.waitForElement(new elementslib.Lookup(task.window.document, taskDialog +</span>
<a href="#l57.84"></a><span id="l57.84" class="difflineplus">+    'id(&quot;event-grid-category-color-row&quot;)/id(&quot;event-grid-category-box&quot;)/id(&quot;item-calendar&quot;)/[0]/' +</span>
<a href="#l57.85"></a><span id="l57.85" class="difflineplus">+    '{&quot;selected&quot;:&quot;true&quot;,&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l57.86"></a><span id="l57.86"> </span>
<a href="#l57.87"></a><span id="l57.87">   // add description, mark needs action and add percent complete</span>
<a href="#l57.88"></a><span id="l57.88" class="difflineminus">-  task.type(new elementslib.Lookup(task.window.document, taskDialog</span>
<a href="#l57.89"></a><span id="l57.89" class="difflineminus">-    + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l57.90"></a><span id="l57.90" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.91"></a><span id="l57.91" class="difflineplus">+  task.type(new elementslib.Lookup(task.window.document, taskDialog +</span>
<a href="#l57.92"></a><span id="l57.92" class="difflineplus">+    'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l57.93"></a><span id="l57.93" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.94"></a><span id="l57.94">     description);</span>
<a href="#l57.95"></a><span id="l57.95">   task.click(new elementslib.ID(task.window.document, &quot;todo-status-needsaction-menuitem&quot;));</span>
<a href="#l57.96"></a><span id="l57.96"> </span>
<a href="#l57.97"></a><span id="l57.97">   // delete default 0 percent complete</span>
<a href="#l57.98"></a><span id="l57.98" class="difflineminus">-  task.keypress(new elementslib.Lookup(task.window.document, taskDialog</span>
<a href="#l57.99"></a><span id="l57.99" class="difflineminus">-    + 'id(&quot;event-grid-todo-status-row&quot;)/id(&quot;event-grid-todo-status-picker-box&quot;)/'</span>
<a href="#l57.100"></a><span id="l57.100" class="difflineminus">-    + 'id(&quot;percent-complete-textbox&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/'</span>
<a href="#l57.101"></a><span id="l57.101" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.102"></a><span id="l57.102" class="difflineplus">+  task.keypress(new elementslib.Lookup(task.window.document, taskDialog +</span>
<a href="#l57.103"></a><span id="l57.103" class="difflineplus">+    'id(&quot;event-grid-todo-status-row&quot;)/id(&quot;event-grid-todo-status-picker-box&quot;)/' +</span>
<a href="#l57.104"></a><span id="l57.104" class="difflineplus">+    'id(&quot;percent-complete-textbox&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/' +</span>
<a href="#l57.105"></a><span id="l57.105" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.106"></a><span id="l57.106">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l57.107"></a><span id="l57.107" class="difflineminus">-  task.type(new elementslib.Lookup(task.window.document, taskDialog</span>
<a href="#l57.108"></a><span id="l57.108" class="difflineminus">-    + 'id(&quot;event-grid-todo-status-row&quot;)/id(&quot;event-grid-todo-status-picker-box&quot;)/'</span>
<a href="#l57.109"></a><span id="l57.109" class="difflineminus">-    + 'id(&quot;percent-complete-textbox&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/'</span>
<a href="#l57.110"></a><span id="l57.110" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.111"></a><span id="l57.111" class="difflineplus">+  task.type(new elementslib.Lookup(task.window.document, taskDialog +</span>
<a href="#l57.112"></a><span id="l57.112" class="difflineplus">+    'id(&quot;event-grid-todo-status-row&quot;)/id(&quot;event-grid-todo-status-picker-box&quot;)/' +</span>
<a href="#l57.113"></a><span id="l57.113" class="difflineplus">+    'id(&quot;percent-complete-textbox&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/' +</span>
<a href="#l57.114"></a><span id="l57.114" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.115"></a><span id="l57.115">     percentComplete);</span>
<a href="#l57.116"></a><span id="l57.116"> </span>
<a href="#l57.117"></a><span id="l57.117">   // save</span>
<a href="#l57.118"></a><span id="l57.118">   task.click(new elementslib.ID(task.window.document, &quot;button-save&quot;));</span>
<a href="#l57.119"></a><span id="l57.119">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l57.120"></a><span id="l57.120"> </span>
<a href="#l57.121"></a><span id="l57.121">   // verify description and status in details pane</span>
<a href="#l57.122"></a><span id="l57.122" class="difflineminus">-  controller.assertValue(new elementslib.Lookup(controller.window.document, taskView</span>
<a href="#l57.123"></a><span id="l57.123" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;calendar-task-details-container&quot;)/id(&quot;calendar-task-details-description&quot;)/'</span>
<a href="#l57.124"></a><span id="l57.124" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.125"></a><span id="l57.125" class="difflineplus">+  controller.assertValue(new elementslib.Lookup(controller.window.document, taskView +</span>
<a href="#l57.126"></a><span id="l57.126" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;calendar-task-details-container&quot;)/id(&quot;calendar-task-details-description&quot;)/' +</span>
<a href="#l57.127"></a><span id="l57.127" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l57.128"></a><span id="l57.128">     description);</span>
<a href="#l57.129"></a><span id="l57.129">   let status = utils.getProperty(&quot;chrome://calendar/locale/calendar.properties&quot;,</span>
<a href="#l57.130"></a><span id="l57.130">     &quot;taskDetailsStatusNeedsAction&quot;);</span>
<a href="#l57.131"></a><span id="l57.131">   controller.assertValue(new elementslib.ID(controller.window.document, &quot;calendar-task-details-status&quot;),</span>
<a href="#l57.132"></a><span id="l57.132">     status);</span>
<a href="#l57.133"></a><span id="l57.133"> </span>
<a href="#l57.134"></a><span id="l57.134">   // set high priority and verify it in detail pane</span>
<a href="#l57.135"></a><span id="l57.135">   controller.click(new elementslib.ID(controller.window.document, &quot;task-actions-priority&quot;));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/calendar/test/mozmill/views/testWeekView.js</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testWeekView.js</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -14,114 +14,114 @@ var setupModule = function(module) {</span>
<a href="#l58.4"></a><span id="l58.4">   controller = mozmill.getMail3PaneController();</span>
<a href="#l58.5"></a><span id="l58.5">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l58.6"></a><span id="l58.6"> };</span>
<a href="#l58.7"></a><span id="l58.7"> </span>
<a href="#l58.8"></a><span id="l58.8"> var testWeekView = function() {</span>
<a href="#l58.9"></a><span id="l58.9">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l58.10"></a><span id="l58.10">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l58.11"></a><span id="l58.11">   // paths</span>
<a href="#l58.12"></a><span id="l58.12" class="difflineminus">-  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l58.13"></a><span id="l58.13" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l58.14"></a><span id="l58.14" class="difflineminus">-    + 'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l58.15"></a><span id="l58.15" class="difflineminus">-  let weekView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l58.16"></a><span id="l58.16" class="difflineminus">-    + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/'</span>
<a href="#l58.17"></a><span id="l58.17" class="difflineminus">-    + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;week-view&quot;)/';</span>
<a href="#l58.18"></a><span id="l58.18" class="difflineplus">+  let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l58.19"></a><span id="l58.19" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/' +</span>
<a href="#l58.20"></a><span id="l58.20" class="difflineplus">+    'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l58.21"></a><span id="l58.21" class="difflineplus">+  let weekView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l58.22"></a><span id="l58.22" class="difflineplus">+    'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/' +</span>
<a href="#l58.23"></a><span id="l58.23" class="difflineplus">+    'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;week-view&quot;)/';</span>
<a href="#l58.24"></a><span id="l58.24">   let eventDialog = '/id(&quot;calendar-event-dialog&quot;)/id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/';</span>
<a href="#l58.25"></a><span id="l58.25" class="difflineminus">-  let eventBox = weekView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/'</span>
<a href="#l58.26"></a><span id="l58.26" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[4]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/'</span>
<a href="#l58.27"></a><span id="l58.27" class="difflineminus">-    + '{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;'</span>
<a href="#l58.28"></a><span id="l58.28" class="difflineminus">-    + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l58.29"></a><span id="l58.29" class="difflineplus">+  let eventBox = weekView + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/' +</span>
<a href="#l58.30"></a><span id="l58.30" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;daybox&quot;})/[4]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;topbox&quot;})/' +</span>
<a href="#l58.31"></a><span id="l58.31" class="difflineplus">+    '{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' +</span>
<a href="#l58.32"></a><span id="l58.32" class="difflineplus">+    calendar.toLowerCase() + '&quot;}';</span>
<a href="#l58.33"></a><span id="l58.33"> </span>
<a href="#l58.34"></a><span id="l58.34">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l58.35"></a><span id="l58.35">   controller.waitThenClick(new elementslib.ID(controller.window.document, &quot;calendar-week-view-button&quot;));</span>
<a href="#l58.36"></a><span id="l58.36"> </span>
<a href="#l58.37"></a><span id="l58.37">   // pick year</span>
<a href="#l58.38"></a><span id="l58.38" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l58.39"></a><span id="l58.39" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l58.40"></a><span id="l58.40" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l58.41"></a><span id="l58.41" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l58.42"></a><span id="l58.42" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;2009&quot;}'));</span>
<a href="#l58.43"></a><span id="l58.43" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l58.44"></a><span id="l58.44" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;yearcell&quot;})'));</span>
<a href="#l58.45"></a><span id="l58.45" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l58.46"></a><span id="l58.46" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l58.47"></a><span id="l58.47" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;2009&quot;}'));</span>
<a href="#l58.48"></a><span id="l58.48"> </span>
<a href="#l58.49"></a><span id="l58.49">   // pick month</span>
<a href="#l58.50"></a><span id="l58.50" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l58.51"></a><span id="l58.51" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})'));</span>
<a href="#l58.52"></a><span id="l58.52" class="difflineminus">-  controller.click(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l58.53"></a><span id="l58.53" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l58.54"></a><span id="l58.54" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;0&quot;}'));</span>
<a href="#l58.55"></a><span id="l58.55" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l58.56"></a><span id="l58.56" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})'));</span>
<a href="#l58.57"></a><span id="l58.57" class="difflineplus">+  controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l58.58"></a><span id="l58.58" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l58.59"></a><span id="l58.59" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;0&quot;}'));</span>
<a href="#l58.60"></a><span id="l58.60"> </span>
<a href="#l58.61"></a><span id="l58.61">   // pick day</span>
<a href="#l58.62"></a><span id="l58.62" class="difflineminus">-  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l58.63"></a><span id="l58.63" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l58.64"></a><span id="l58.64" class="difflineplus">+  controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l58.65"></a><span id="l58.65" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l58.66"></a><span id="l58.66"> </span>
<a href="#l58.67"></a><span id="l58.67">   // verify date</span>
<a href="#l58.68"></a><span id="l58.68" class="difflineminus">-  let day = new elementslib.Lookup(controller.window.document, weekView</span>
<a href="#l58.69"></a><span id="l58.69" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;labelbox&quot;})/anon({&quot;anonid&quot;:&quot;labeldaybox&quot;})/'</span>
<a href="#l58.70"></a><span id="l58.70" class="difflineminus">-    + '{&quot;selected&quot;:&quot;true&quot;}');</span>
<a href="#l58.71"></a><span id="l58.71" class="difflineplus">+  let day = new elementslib.Lookup(controller.window.document, weekView +</span>
<a href="#l58.72"></a><span id="l58.72" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;labelbox&quot;})/anon({&quot;anonid&quot;:&quot;labeldaybox&quot;})/' +</span>
<a href="#l58.73"></a><span id="l58.73" class="difflineplus">+    '{&quot;selected&quot;:&quot;true&quot;}');</span>
<a href="#l58.74"></a><span id="l58.74">   controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;;});</span>
<a href="#l58.75"></a><span id="l58.75"> </span>
<a href="#l58.76"></a><span id="l58.76">   // create event at 8 AM</span>
<a href="#l58.77"></a><span id="l58.77">   // Thursday of 2009-01-01 is 4th with default settings</span>
<a href="#l58.78"></a><span id="l58.78" class="difflineminus">-  controller.doubleClick(new elementslib.Lookup(controller.window.document, weekView</span>
<a href="#l58.79"></a><span id="l58.79" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l58.80"></a><span id="l58.80" class="difflineminus">-    + '[4]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[8]'), 1, 1);</span>
<a href="#l58.81"></a><span id="l58.81" class="difflineplus">+  controller.doubleClick(new elementslib.Lookup(controller.window.document, weekView +</span>
<a href="#l58.82"></a><span id="l58.82" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/' +</span>
<a href="#l58.83"></a><span id="l58.83" class="difflineplus">+    '[4]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[8]'), 1, 1);</span>
<a href="#l58.84"></a><span id="l58.84">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l58.85"></a><span id="l58.85">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l58.86"></a><span id="l58.86"> </span>
<a href="#l58.87"></a><span id="l58.87">   // check that the start time is correct</span>
<a href="#l58.88"></a><span id="l58.88" class="difflineminus">-  let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l58.89"></a><span id="l58.89" class="difflineminus">-    + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l58.90"></a><span id="l58.90" class="difflineminus">-    + 'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/'</span>
<a href="#l58.91"></a><span id="l58.91" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/'</span>
<a href="#l58.92"></a><span id="l58.92" class="difflineminus">-    + 'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l58.93"></a><span id="l58.93" class="difflineplus">+  let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l58.94"></a><span id="l58.94" class="difflineplus">+    'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l58.95"></a><span id="l58.95" class="difflineplus">+    'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/' +</span>
<a href="#l58.96"></a><span id="l58.96" class="difflineplus">+    'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/' +</span>
<a href="#l58.97"></a><span id="l58.97" class="difflineplus">+    'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l58.98"></a><span id="l58.98">   event.waitForElement(startTimeInput);</span>
<a href="#l58.99"></a><span id="l58.99">   event.assertValue(startTimeInput, '8:00');</span>
<a href="#l58.100"></a><span id="l58.100">   let date = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l58.101"></a><span id="l58.101">     2009, 1, 1);</span>
<a href="#l58.102"></a><span id="l58.102" class="difflineminus">-  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l58.103"></a><span id="l58.103" class="difflineminus">-    + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l58.104"></a><span id="l58.104" class="difflineminus">-    + 'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/'</span>
<a href="#l58.105"></a><span id="l58.105" class="difflineminus">-    + 'anon({&quot;flex&quot;:&quot;1&quot;,&quot;id&quot;:&quot;hbox&quot;,&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l58.106"></a><span id="l58.106" class="difflineminus">-    + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l58.107"></a><span id="l58.107" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l58.108"></a><span id="l58.108" class="difflineplus">+  event.assertValue(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l58.109"></a><span id="l58.109" class="difflineplus">+    'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l58.110"></a><span id="l58.110" class="difflineplus">+    'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' +</span>
<a href="#l58.111"></a><span id="l58.111" class="difflineplus">+    'anon({&quot;flex&quot;:&quot;1&quot;,&quot;id&quot;:&quot;hbox&quot;,&quot;class&quot;:&quot;datepicker-box-class&quot;})/' +</span>
<a href="#l58.112"></a><span id="l58.112" class="difflineplus">+    '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/' +</span>
<a href="#l58.113"></a><span id="l58.113" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l58.114"></a><span id="l58.114">     date);</span>
<a href="#l58.115"></a><span id="l58.115"> </span>
<a href="#l58.116"></a><span id="l58.116">   // fill in title, description and calendar</span>
<a href="#l58.117"></a><span id="l58.117" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l58.118"></a><span id="l58.118" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l58.119"></a><span id="l58.119" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l58.120"></a><span id="l58.120" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l58.121"></a><span id="l58.121" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l58.122"></a><span id="l58.122" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l58.123"></a><span id="l58.123">     title1);</span>
<a href="#l58.124"></a><span id="l58.124" class="difflineminus">-  event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l58.125"></a><span id="l58.125" class="difflineminus">-    + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l58.126"></a><span id="l58.126" class="difflineminus">-    + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l58.127"></a><span id="l58.127" class="difflineplus">+  event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l58.128"></a><span id="l58.128" class="difflineplus">+    'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l58.129"></a><span id="l58.129" class="difflineplus">+    'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l58.130"></a><span id="l58.130">     desc);</span>
<a href="#l58.131"></a><span id="l58.131">   event.select(new elementslib.ID(event.window.document, &quot;item-calendar&quot;), null, calendar);</span>
<a href="#l58.132"></a><span id="l58.132"> </span>
<a href="#l58.133"></a><span id="l58.133">   // save</span>
<a href="#l58.134"></a><span id="l58.134">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l58.135"></a><span id="l58.135"> </span>
<a href="#l58.136"></a><span id="l58.136">   // if it was created successfully, it can be opened</span>
<a href="#l58.137"></a><span id="l58.137">   controller.waitForElement(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l58.138"></a><span id="l58.138">   controller.doubleClick(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l58.139"></a><span id="l58.139">   controller.waitFor(function() {return utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l58.140"></a><span id="l58.140">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l58.141"></a><span id="l58.141"> </span>
<a href="#l58.142"></a><span id="l58.142">   // change title and save changes</span>
<a href="#l58.143"></a><span id="l58.143" class="difflineminus">-  let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l58.144"></a><span id="l58.144" class="difflineminus">-    + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l58.145"></a><span id="l58.145" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l58.146"></a><span id="l58.146" class="difflineplus">+  let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l58.147"></a><span id="l58.147" class="difflineplus">+    'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l58.148"></a><span id="l58.148" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l58.149"></a><span id="l58.149">   event.waitForElement(titleTextBox);</span>
<a href="#l58.150"></a><span id="l58.150">   event.type(titleTextBox, title2);</span>
<a href="#l58.151"></a><span id="l58.151">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l58.152"></a><span id="l58.152"> </span>
<a href="#l58.153"></a><span id="l58.153">   // check if name was saved</span>
<a href="#l58.154"></a><span id="l58.154" class="difflineminus">-  let eventName = new elementslib.Lookup(controller.window.document, eventBox</span>
<a href="#l58.155"></a><span id="l58.155" class="difflineminus">-    + '/anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;event-container&quot;})/{&quot;class&quot;:&quot;calendar-event-selection&quot;}/'</span>
<a href="#l58.156"></a><span id="l58.156" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;eventbox&quot;})/{&quot;class&quot;:&quot;calendar-event-details&quot;}/'</span>
<a href="#l58.157"></a><span id="l58.157" class="difflineminus">-    + 'anon({&quot;anonid&quot;:&quot;event-name&quot;})');</span>
<a href="#l58.158"></a><span id="l58.158" class="difflineplus">+  let eventName = new elementslib.Lookup(controller.window.document, eventBox +</span>
<a href="#l58.159"></a><span id="l58.159" class="difflineplus">+    '/anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;event-container&quot;})/{&quot;class&quot;:&quot;calendar-event-selection&quot;}/' +</span>
<a href="#l58.160"></a><span id="l58.160" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;eventbox&quot;})/{&quot;class&quot;:&quot;calendar-event-details&quot;}/' +</span>
<a href="#l58.161"></a><span id="l58.161" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;event-name&quot;})');</span>
<a href="#l58.162"></a><span id="l58.162">   controller.waitForElement(eventName);</span>
<a href="#l58.163"></a><span id="l58.163">   controller.assertJSProperty(eventName, &quot;textContent&quot;, title2);</span>
<a href="#l58.164"></a><span id="l58.164"> </span>
<a href="#l58.165"></a><span id="l58.165">   // delete event</span>
<a href="#l58.166"></a><span id="l58.166">   controller.click(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l58.167"></a><span id="l58.167">   controller.keypress(new elementslib.ID(controller.window.document, &quot;week-view&quot;),</span>
<a href="#l58.168"></a><span id="l58.168">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l58.169"></a><span id="l58.169">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, eventBox));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/calendar/test/unit/test_gdata_provider.js</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/calendar/test/unit/test_gdata_provider.js</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -216,19 +216,19 @@ GDataServer.prototype = {</span>
<a href="#l59.4"></a><span id="l59.4">         MockConflictPrompt.register();</span>
<a href="#l59.5"></a><span id="l59.5"> </span>
<a href="#l59.6"></a><span id="l59.6">         let cachedCalendar = calmgr.getCalendarById(client.id);</span>
<a href="#l59.7"></a><span id="l59.7">         return this.waitForLoad(cachedCalendar);</span>
<a href="#l59.8"></a><span id="l59.8">     },</span>
<a href="#l59.9"></a><span id="l59.9"> </span>
<a href="#l59.10"></a><span id="l59.10">     router: function(nextHandler, request, response) {</span>
<a href="#l59.11"></a><span id="l59.11">         try {</span>
<a href="#l59.12"></a><span id="l59.12" class="difflineminus">-            let method = request.hasHeader(&quot;X-HTTP-Method-Override&quot;) ?</span>
<a href="#l59.13"></a><span id="l59.13" class="difflineminus">-                         request.getHeader(&quot;X-HTTP-Method-Override&quot;) :</span>
<a href="#l59.14"></a><span id="l59.14" class="difflineminus">-                         request.method;</span>
<a href="#l59.15"></a><span id="l59.15" class="difflineplus">+            let method = request.hasHeader(&quot;X-HTTP-Method-Override&quot;)</span>
<a href="#l59.16"></a><span id="l59.16" class="difflineplus">+                         ? request.getHeader(&quot;X-HTTP-Method-Override&quot;)</span>
<a href="#l59.17"></a><span id="l59.17" class="difflineplus">+                         : request.method;</span>
<a href="#l59.18"></a><span id="l59.18">             let parameters = new Map(request.queryString.split(&quot;&amp;&quot;).map(p =&gt; p.split(&quot;=&quot;, 2)));</span>
<a href="#l59.19"></a><span id="l59.19"> </span>
<a href="#l59.20"></a><span id="l59.20">             let body;</span>
<a href="#l59.21"></a><span id="l59.21">             try {</span>
<a href="#l59.22"></a><span id="l59.22">                 body = JSON.parse(NetUtil.readInputStreamToString(request.bodyInputStream,</span>
<a href="#l59.23"></a><span id="l59.23">                                   request.bodyInputStream.available()));</span>
<a href="#l59.24"></a><span id="l59.24">             } catch (e) {</span>
<a href="#l59.25"></a><span id="l59.25">                 // Don't bail if json parsing failed.</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

