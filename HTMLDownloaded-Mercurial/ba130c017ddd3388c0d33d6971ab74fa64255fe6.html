<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 1345:ba130c017ddd3388c0d33d6971ab74fa64255fe6</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ ba130c017ddd3388c0d33d6971ab74fa64255fe6" />
<meta property="og:url" content="/comm-central/rev/ba130c017ddd3388c0d33d6971ab74fa64255fe6" />
<meta property="og:description" content="Bug 467087 - Update version of log4moz in gloda; r=bugmail sr=bienvenu" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / ba130c017ddd3388c0d33d6971ab74fa64255fe6 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/ba130c017ddd3388c0d33d6971ab74fa64255fe6">shortlog</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/ba130c017ddd3388c0d33d6971ab74fa64255fe6">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6">files</a> |
changeset |
<a href="/comm-central/raw-rev/ba130c017ddd3388c0d33d6971ab74fa64255fe6">raw</a>  | <a href="/comm-central/archive/ba130c017ddd3388c0d33d6971ab74fa64255fe6.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=467087">Bug 467087</a> - Update version of log4moz in gloda; r=bugmail sr=bienvenu
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#83;&#105;&#100;&#100;&#104;&#97;&#114;&#116;&#104;&#32;&#65;&#103;&#97;&#114;&#119;&#97;&#108;&#32;&#60;&#115;&#105;&#100;&#49;&#51;&#51;&#55;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Sat, 06 Dec 2008 13:38:55 +0100</td></tr>

<tr>
 <td>changeset 1345</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/ba130c017ddd3388c0d33d6971ab74fa64255fe6">ba130c017ddd3388c0d33d6971ab74fa64255fe6</a></td>
</tr>



<tr>
<td>parent 1344</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/66a806479c6c144374f5a08789669e7f6a6c018f">66a806479c6c144374f5a08789669e7f6a6c018f</a>
</td>
</tr>

<tr>
<td>child 1346</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/d3029a40763cf9f2c5dd6e3f7c79fbfce9aaee2b">d3029a40763cf9f2c5dd6e3f7c79fbfce9aaee2b</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=ba130c017ddd3388c0d33d6971ab74fa64255fe6">1056</a></td></tr>
<tr><td>push user</td><td>sgautherie.bz@free.fr</td></tr>
<tr><td>push date</td><td class="date age">Sat, 06 Dec 2008 12:39:12 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@ba130c017ddd [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=ba130c017ddd3388c0d33d6971ab74fa64255fe6">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=ba130c017ddd3388c0d33d6971ab74fa64255fe6&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=ba130c017ddd3388c0d33d6971ab74fa64255fe6&newProject=comm-central&newRevision=ba130c017ddd3388c0d33d6971ab74fa64255fe6&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=ba130c017ddd3388c0d33d6971ab74fa64255fe6&newProject=comm-central&newRevision=ba130c017ddd3388c0d33d6971ab74fa64255fe6&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=ba130c017ddd3388c0d33d6971ab74fa64255fe6&newProject=comm-central&newRevision=ba130c017ddd3388c0d33d6971ab74fa64255fe6&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28bugmail%29&revcount=50">bugmail</a>, <a href="/comm-central/log?rev=reviewer%28bienvenu%29&revcount=50">bienvenu</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=467087">467087</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=467087">Bug 467087</a> - Update version of log4moz in gloda; r=bugmail sr=bienvenu</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/collection.js">mailnews/db/gloda/modules/collection.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/collection.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/collection.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/collection.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/collection.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/collection.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/connotent.js">mailnews/db/gloda/modules/connotent.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/connotent.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/connotent.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/connotent.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/connotent.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/connotent.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/databind.js">mailnews/db/gloda/modules/databind.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/databind.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/databind.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/databind.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/databind.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/databind.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datamodel.js">mailnews/db/gloda/modules/datamodel.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datamodel.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datamodel.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datamodel.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datamodel.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datamodel.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datastore.js">mailnews/db/gloda/modules/datastore.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datastore.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datastore.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datastore.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datastore.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/datastore.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/everybody.js">mailnews/db/gloda/modules/everybody.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/everybody.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/everybody.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/everybody.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/everybody.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/everybody.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/explattr.js">mailnews/db/gloda/modules/explattr.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/explattr.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/explattr.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/explattr.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/explattr.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/explattr.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/fundattr.js">mailnews/db/gloda/modules/fundattr.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/fundattr.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/fundattr.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/fundattr.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/fundattr.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/fundattr.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/gloda.js">mailnews/db/gloda/modules/gloda.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/gloda.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/gloda.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/gloda.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/gloda.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/gloda.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/index_ab.js">mailnews/db/gloda/modules/index_ab.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/index_ab.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/index_ab.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/index_ab.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/index_ab.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/index_ab.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/indexer.js">mailnews/db/gloda/modules/indexer.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/indexer.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/indexer.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/indexer.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/indexer.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/indexer.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/log4moz.js">mailnews/db/gloda/modules/log4moz.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/log4moz.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/log4moz.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/log4moz.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/log4moz.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/log4moz.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_freetag.js">mailnews/db/gloda/modules/noun_freetag.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_freetag.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_freetag.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_freetag.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_freetag.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_freetag.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_mimetype.js">mailnews/db/gloda/modules/noun_mimetype.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_mimetype.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_mimetype.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_mimetype.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_mimetype.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/modules/noun_mimetype.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/test/resources/glodaTestHelper.js">mailnews/db/gloda/test/resources/glodaTestHelper.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/test/resources/glodaTestHelper.js">file</a> |
<a href="/comm-central/annotate/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/test/resources/glodaTestHelper.js">annotate</a> |
<a href="/comm-central/diff/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/test/resources/glodaTestHelper.js">diff</a> |
<a href="/comm-central/comparison/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/test/resources/glodaTestHelper.js">comparison</a> |
<a href="/comm-central/log/ba130c017ddd3388c0d33d6971ab74fa64255fe6/mailnews/db/gloda/test/resources/glodaTestHelper.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mailnews/db/gloda/modules/collection.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/collection.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -39,17 +39,17 @@ EXPORTED_SYMBOLS = ['GlodaCollection', '</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5"> const Cc = Components.classes;</span>
<a href="#l1.6"></a><span id="l1.6"> const Ci = Components.interfaces;</span>
<a href="#l1.7"></a><span id="l1.7"> const Cr = Components.results;</span>
<a href="#l1.8"></a><span id="l1.8"> const Cu = Components.utils;</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10"> Cu.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-const LOG = Log4Moz.Service.getLogger(&quot;gloda.collection&quot;);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+const LOG = Log4Moz.repository.getLogger(&quot;gloda.collection&quot;);</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15"> /**</span>
<a href="#l1.16"></a><span id="l1.16">  * @namespace Central registry and logic for all collections. </span>
<a href="#l1.17"></a><span id="l1.17">  *</span>
<a href="#l1.18"></a><span id="l1.18">  * The collection manager is a singleton that has the following tasks:</span>
<a href="#l1.19"></a><span id="l1.19">  * - Let views of objects (nouns) know when their objects have changed.  For</span>
<a href="#l1.20"></a><span id="l1.20">  *   example, an attribute has changed due to user action.</span>
<a href="#l1.21"></a><span id="l1.21">  * - Let views of objects based on queries know when new objects match their</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mailnews/db/gloda/modules/connotent.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/connotent.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -39,17 +39,17 @@ EXPORTED_SYMBOLS = ['GlodaContent'];</span>
<a href="#l2.4"></a><span id="l2.4"> </span>
<a href="#l2.5"></a><span id="l2.5"> const Cc = Components.classes;</span>
<a href="#l2.6"></a><span id="l2.6"> const Ci = Components.interfaces;</span>
<a href="#l2.7"></a><span id="l2.7"> const Cr = Components.results;</span>
<a href="#l2.8"></a><span id="l2.8"> const Cu = Components.utils;</span>
<a href="#l2.9"></a><span id="l2.9"> </span>
<a href="#l2.10"></a><span id="l2.10"> Cu.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-const LOG = Log4Moz.Service.getLogger(&quot;gloda.connotent&quot;);</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+const LOG = Log4Moz.repository.getLogger(&quot;gloda.connotent&quot;);</span>
<a href="#l2.14"></a><span id="l2.14"> </span>
<a href="#l2.15"></a><span id="l2.15"> function GlodaContent() {</span>
<a href="#l2.16"></a><span id="l2.16">   this._contentPriority = null;</span>
<a href="#l2.17"></a><span id="l2.17">   this._producing = false;</span>
<a href="#l2.18"></a><span id="l2.18">   this._hunks = [];</span>
<a href="#l2.19"></a><span id="l2.19"> }</span>
<a href="#l2.20"></a><span id="l2.20"> </span>
<a href="#l2.21"></a><span id="l2.21"> GlodaContent.prototype = {</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -221,9 +221,9 @@ GlodaContent.prototype = {</span>
<a href="#l2.23"></a><span id="l2.23">     </span>
<a href="#l2.24"></a><span id="l2.24">     if (!this._curHunk || this._curHunk.hunkType != this.kHunkContent) {</span>
<a href="#l2.25"></a><span id="l2.25">       this._curHunk = {hunkType: this.kHunkContent, data: data};</span>
<a href="#l2.26"></a><span id="l2.26">       this._hunks.push(this._curHunk);</span>
<a href="#l2.27"></a><span id="l2.27">     }</span>
<a href="#l2.28"></a><span id="l2.28">     else</span>
<a href="#l2.29"></a><span id="l2.29">       this._curHunk.data += &quot;\n&quot; + data;</span>
<a href="#l2.30"></a><span id="l2.30">   },</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-}</span>
<a href="#l2.32"></a><span id="l2.32">\ No newline at end of file</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/db/gloda/modules/databind.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/databind.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -39,17 +39,17 @@ EXPORTED_SYMBOLS = [&quot;GlodaDatabind&quot;];</span>
<a href="#l3.4"></a><span id="l3.4"> </span>
<a href="#l3.5"></a><span id="l3.5"> const Cc = Components.classes;</span>
<a href="#l3.6"></a><span id="l3.6"> const Ci = Components.interfaces;</span>
<a href="#l3.7"></a><span id="l3.7"> const Cr = Components.results;</span>
<a href="#l3.8"></a><span id="l3.8"> const Cu = Components.utils;</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10"> Cu.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-let DBC_LOG = Log4Moz.Service.getLogger(&quot;gloda.ds.dbc&quot;);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+let DBC_LOG = Log4Moz.repository.getLogger(&quot;gloda.ds.dbc&quot;);</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15"> function DatabindCallback(aDatabind, aCallbackThis, aCallback, aOneShot) {</span>
<a href="#l3.16"></a><span id="l3.16">   this._databind = aDatabind;</span>
<a href="#l3.17"></a><span id="l3.17">   this._callbackThis = aCallbackThis;</span>
<a href="#l3.18"></a><span id="l3.18">   this._callback = aCallback;</span>
<a href="#l3.19"></a><span id="l3.19">   this._oneShot = aOneShot;</span>
<a href="#l3.20"></a><span id="l3.20">   this._databind._datastore._pendingAsyncStatements++;</span>
<a href="#l3.21"></a><span id="l3.21"> }</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -87,17 +87,17 @@ DatabindCallback.prototype = {</span>
<a href="#l3.23"></a><span id="l3.23">       DBC_LOG.error(&quot;Exception in handleCompletion: &quot; + e);</span>
<a href="#l3.24"></a><span id="l3.24">     }</span>
<a href="#l3.25"></a><span id="l3.25">   },</span>
<a href="#l3.26"></a><span id="l3.26"> }</span>
<a href="#l3.27"></a><span id="l3.27"> </span>
<a href="#l3.28"></a><span id="l3.28"> function GlodaDatabind(aTableDef, aDatastore) {</span>
<a href="#l3.29"></a><span id="l3.29">   this._tableDef = aTableDef;</span>
<a href="#l3.30"></a><span id="l3.30">   this._datastore = aDatastore;</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-  this._log = Log4Moz.Service.getLogger(&quot;gloda.databind.&quot; + aTableDef.name);</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+  this._log = Log4Moz.repository.getLogger(&quot;gloda.databind.&quot; + aTableDef.name);</span>
<a href="#l3.33"></a><span id="l3.33">   </span>
<a href="#l3.34"></a><span id="l3.34">   let insertSql = &quot;INSERT INTO &quot; + this._tableDef._realName + &quot; (&quot; +</span>
<a href="#l3.35"></a><span id="l3.35">     [coldef[0] for each</span>
<a href="#l3.36"></a><span id="l3.36">      ([i, coldef] in Iterator(this._tableDef.columns))].join(&quot;, &quot;) +</span>
<a href="#l3.37"></a><span id="l3.37">     &quot;) VALUES (&quot; +</span>
<a href="#l3.38"></a><span id="l3.38">     [(&quot;:&quot; + coldef[0]) for each</span>
<a href="#l3.39"></a><span id="l3.39">      ([i, coldef] in Iterator(this._tableDef.columns))].join(&quot;, &quot;) +</span>
<a href="#l3.40"></a><span id="l3.40">     &quot;)&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/db/gloda/modules/datamodel.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/datamodel.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -40,17 +40,17 @@ EXPORTED_SYMBOLS = [&quot;GlodaAttributeDBDef</span>
<a href="#l4.4"></a><span id="l4.4">                     &quot;GlodaContact&quot;, &quot;GlodaIdentity&quot;];</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6"> const Cc = Components.classes;</span>
<a href="#l4.7"></a><span id="l4.7"> const Ci = Components.interfaces;</span>
<a href="#l4.8"></a><span id="l4.8"> const Cr = Components.results;</span>
<a href="#l4.9"></a><span id="l4.9"> const Cu = Components.utils;</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11"> Cu.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-const LOG = Log4Moz.Service.getLogger(&quot;gloda.datamodel&quot;);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+const LOG = Log4Moz.repository.getLogger(&quot;gloda.datamodel&quot;);</span>
<a href="#l4.14"></a><span id="l4.14"> </span>
<a href="#l4.15"></a><span id="l4.15"> Cu.import(&quot;resource://app/modules/gloda/utils.js&quot;);</span>
<a href="#l4.16"></a><span id="l4.16"> </span>
<a href="#l4.17"></a><span id="l4.17"> /**</span>
<a href="#l4.18"></a><span id="l4.18">  * @class Represents a gloda attribute definition's DB form.  This class</span>
<a href="#l4.19"></a><span id="l4.19">  *  stores the information in the database relating to this attribute</span>
<a href="#l4.20"></a><span id="l4.20">  *  definition.  Access its attrDef attribute to get at the realy juicy data.</span>
<a href="#l4.21"></a><span id="l4.21">  *  This main interesting thing this class does is serve as the keeper of the</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/db/gloda/modules/datastore.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/datastore.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -48,17 +48,17 @@ const Cr = Components.results;</span>
<a href="#l5.4"></a><span id="l5.4"> const Cu = Components.utils;</span>
<a href="#l5.5"></a><span id="l5.5"> </span>
<a href="#l5.6"></a><span id="l5.6"> Cu.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8"> Cu.import(&quot;resource://app/modules/gloda/datamodel.js&quot;);</span>
<a href="#l5.9"></a><span id="l5.9"> Cu.import(&quot;resource://app/modules/gloda/databind.js&quot;);</span>
<a href="#l5.10"></a><span id="l5.10"> Cu.import(&quot;resource://app/modules/gloda/collection.js&quot;);</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-let MBM_LOG = Log4Moz.Service.getLogger(&quot;gloda.ds.mbm&quot;);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+let MBM_LOG = Log4Moz.repository.getLogger(&quot;gloda.ds.mbm&quot;);</span>
<a href="#l5.14"></a><span id="l5.14"> </span>
<a href="#l5.15"></a><span id="l5.15"> /**</span>
<a href="#l5.16"></a><span id="l5.16">  * @class This callback handles processing the asynchronous query results of</span>
<a href="#l5.17"></a><span id="l5.17">  *  GlodaDatastore.getMessagesByMessageID.  Because that method is only</span>
<a href="#l5.18"></a><span id="l5.18">  *  called as part of the indexing process, we are guaranteed that there will</span>
<a href="#l5.19"></a><span id="l5.19">  *  be no real caching ramifications.  Accordingly, we can also defer our cache</span>
<a href="#l5.20"></a><span id="l5.20">  *  processing (via GlodaCollectionManager) until the query completes.</span>
<a href="#l5.21"></a><span id="l5.21">  *</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineat">@@ -94,17 +94,17 @@ MessagesByMessageIdCallback.prototype = </span>
<a href="#l5.23"></a><span id="l5.23">     </span>
<a href="#l5.24"></a><span id="l5.24">     MBM_LOG.debug(&quot;query completed, notifying... &quot; + this.results);</span>
<a href="#l5.25"></a><span id="l5.25">     // we no longer need to unify; it is done for us.</span>
<a href="#l5.26"></a><span id="l5.26"> </span>
<a href="#l5.27"></a><span id="l5.27">     this.callback.call(this.callbackThis, this.results);</span>
<a href="#l5.28"></a><span id="l5.28">   }</span>
<a href="#l5.29"></a><span id="l5.29"> };</span>
<a href="#l5.30"></a><span id="l5.30"> </span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-let PCH_LOG = Log4Moz.Service.getLogger(&quot;gloda.ds.pch&quot;);</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+let PCH_LOG = Log4Moz.repository.getLogger(&quot;gloda.ds.pch&quot;);</span>
<a href="#l5.33"></a><span id="l5.33"> </span>
<a href="#l5.34"></a><span id="l5.34"> function PostCommitHandler(aCallbacks) {</span>
<a href="#l5.35"></a><span id="l5.35">   this.callbacks = aCallbacks;</span>
<a href="#l5.36"></a><span id="l5.36">   GlodaDatastore._pendingAsyncStatements++;</span>
<a href="#l5.37"></a><span id="l5.37"> }</span>
<a href="#l5.38"></a><span id="l5.38"> </span>
<a href="#l5.39"></a><span id="l5.39"> PostCommitHandler.prototype = {</span>
<a href="#l5.40"></a><span id="l5.40">   handleResult: function gloda_ds_pch_handleResult(aResultSet) {</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineat">@@ -135,17 +135,17 @@ PostCommitHandler.prototype = {</span>
<a href="#l5.42"></a><span id="l5.42">     }</span>
<a href="#l5.43"></a><span id="l5.43">     catch (e) {</span>
<a href="#l5.44"></a><span id="l5.44">       PCH_LOG.error(&quot;Exception in handleCompletion: &quot; + e);</span>
<a href="#l5.45"></a><span id="l5.45">     }</span>
<a href="#l5.46"></a><span id="l5.46">       </span>
<a href="#l5.47"></a><span id="l5.47">   }</span>
<a href="#l5.48"></a><span id="l5.48"> };</span>
<a href="#l5.49"></a><span id="l5.49"> </span>
<a href="#l5.50"></a><span id="l5.50" class="difflineminus">-let QFQ_LOG = Log4Moz.Service.getLogger(&quot;gloda.ds.qfq&quot;);</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+let QFQ_LOG = Log4Moz.repository.getLogger(&quot;gloda.ds.qfq&quot;);</span>
<a href="#l5.52"></a><span id="l5.52"> </span>
<a href="#l5.53"></a><span id="l5.53"> let QueryFromQueryResolver = {</span>
<a href="#l5.54"></a><span id="l5.54">   onItemsAdded: function(aIgnoredItems, aCollection, aFake) {</span>
<a href="#l5.55"></a><span id="l5.55">     let originColl = aCollection.dataStack ? aCollection.dataStack.pop()</span>
<a href="#l5.56"></a><span id="l5.56">                                            : aCollection.data;</span>
<a href="#l5.57"></a><span id="l5.57">     //QFQ_LOG.debug(&quot;QFQR: originColl: &quot; + originColl);</span>
<a href="#l5.58"></a><span id="l5.58">     if (aCollection.completionShifter)</span>
<a href="#l5.59"></a><span id="l5.59">       aCollection.completionShifter.push(originColl);</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineat">@@ -737,17 +737,17 @@ var GlodaDatastore = {</span>
<a href="#l5.61"></a><span id="l5.61">   asyncConnection: null,</span>
<a href="#l5.62"></a><span id="l5.62"> </span>
<a href="#l5.63"></a><span id="l5.63">   /**</span>
<a href="#l5.64"></a><span id="l5.64">    * Initialize logging, create the database if it doesn't exist, &quot;upgrade&quot; it</span>
<a href="#l5.65"></a><span id="l5.65">    *  if it does and it's not up-to-date, fill our authoritative folder uri/id</span>
<a href="#l5.66"></a><span id="l5.66">    *  mapping.</span>
<a href="#l5.67"></a><span id="l5.67">    */</span>
<a href="#l5.68"></a><span id="l5.68">   _init: function gloda_ds_init(aNsJSON, aNounIDToDef) {</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineminus">-    this._log = Log4Moz.Service.getLogger(&quot;gloda.datastore&quot;);</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineplus">+    this._log = Log4Moz.repository.getLogger(&quot;gloda.datastore&quot;);</span>
<a href="#l5.71"></a><span id="l5.71">     this._log.debug(&quot;Beginning datastore initialization.&quot;);</span>
<a href="#l5.72"></a><span id="l5.72">     </span>
<a href="#l5.73"></a><span id="l5.73">     this._json = aNsJSON;</span>
<a href="#l5.74"></a><span id="l5.74">     this._nounIDToDef = aNounIDToDef;</span>
<a href="#l5.75"></a><span id="l5.75"> </span>
<a href="#l5.76"></a><span id="l5.76">     // Get the path to our global database</span>
<a href="#l5.77"></a><span id="l5.77">     var dirService = Cc[&quot;@mozilla.org/file/directory_service;1&quot;].</span>
<a href="#l5.78"></a><span id="l5.78">                      getService(Ci.nsIProperties);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/db/gloda/modules/everybody.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/everybody.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -38,17 +38,17 @@</span>
<a href="#l6.4"></a><span id="l6.4"> const EXPORTED_SYMBOLS = [];</span>
<a href="#l6.5"></a><span id="l6.5"> </span>
<a href="#l6.6"></a><span id="l6.6"> const Cc = Components.classes;</span>
<a href="#l6.7"></a><span id="l6.7"> const Ci = Components.interfaces;</span>
<a href="#l6.8"></a><span id="l6.8"> const Cr = Components.results;</span>
<a href="#l6.9"></a><span id="l6.9"> const Cu = Components.utils;</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11"> Cu.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-const LOG = Log4Moz.Service.getLogger(&quot;gloda.everybody&quot;);</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+const LOG = Log4Moz.repository.getLogger(&quot;gloda.everybody&quot;);</span>
<a href="#l6.14"></a><span id="l6.14"> </span>
<a href="#l6.15"></a><span id="l6.15"> var importNS = {};</span>
<a href="#l6.16"></a><span id="l6.16"> </span>
<a href="#l6.17"></a><span id="l6.17"> function loadModule(aModuleURI, aNSContrib) {</span>
<a href="#l6.18"></a><span id="l6.18">   try {</span>
<a href="#l6.19"></a><span id="l6.19">     LOG.info(&quot;... loading &quot; + aModuleURI);</span>
<a href="#l6.20"></a><span id="l6.20">     Cu.import(aModuleURI, importNS);</span>
<a href="#l6.21"></a><span id="l6.21">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/db/gloda/modules/explattr.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/explattr.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -67,17 +67,17 @@ const FA_READ = &quot;READ&quot;;</span>
<a href="#l7.4"></a><span id="l7.4">  *  message as read. </span>
<a href="#l7.5"></a><span id="l7.5">  */</span>
<a href="#l7.6"></a><span id="l7.6"> var GlodaExplicitAttr = {</span>
<a href="#l7.7"></a><span id="l7.7">   providerName: &quot;gloda.explattr&quot;,</span>
<a href="#l7.8"></a><span id="l7.8">   _log: null,</span>
<a href="#l7.9"></a><span id="l7.9">   _msgTagService: null,</span>
<a href="#l7.10"></a><span id="l7.10"> </span>
<a href="#l7.11"></a><span id="l7.11">   init: function gloda_explattr_init() {</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-    this._log =  Log4Moz.Service.getLogger(&quot;gloda.explattr&quot;);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+    this._log =  Log4Moz.repository.getLogger(&quot;gloda.explattr&quot;);</span>
<a href="#l7.14"></a><span id="l7.14"> </span>
<a href="#l7.15"></a><span id="l7.15">     this._msgTagService = Cc[&quot;@mozilla.org/messenger/tagservice;1&quot;].</span>
<a href="#l7.16"></a><span id="l7.16">                           getService(Ci.nsIMsgTagService);</span>
<a href="#l7.17"></a><span id="l7.17">   </span>
<a href="#l7.18"></a><span id="l7.18">     try {</span>
<a href="#l7.19"></a><span id="l7.19">       this.defineAttributes();</span>
<a href="#l7.20"></a><span id="l7.20">     }</span>
<a href="#l7.21"></a><span id="l7.21">     catch (ex) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/db/gloda/modules/fundattr.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/fundattr.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -58,17 +58,17 @@ Cu.import(&quot;resource://app/modules/gloda/</span>
<a href="#l8.4"></a><span id="l8.4">  *  than most extension providers should do.  In summary, don't mimic this code</span>
<a href="#l8.5"></a><span id="l8.5">  *  unless you won't complain when your code breaks.</span>
<a href="#l8.6"></a><span id="l8.6">  */</span>
<a href="#l8.7"></a><span id="l8.7"> var GlodaFundAttr = {</span>
<a href="#l8.8"></a><span id="l8.8">   providerName: &quot;gloda.fundattr&quot;,</span>
<a href="#l8.9"></a><span id="l8.9">   _log: null,</span>
<a href="#l8.10"></a><span id="l8.10"> </span>
<a href="#l8.11"></a><span id="l8.11">   init: function gloda_explattr_init() {</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-    this._log =  Log4Moz.Service.getLogger(&quot;gloda.fundattr&quot;);</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+    this._log =  Log4Moz.repository.getLogger(&quot;gloda.fundattr&quot;);</span>
<a href="#l8.14"></a><span id="l8.14">   </span>
<a href="#l8.15"></a><span id="l8.15">     try {</span>
<a href="#l8.16"></a><span id="l8.16">       this.defineAttributes();</span>
<a href="#l8.17"></a><span id="l8.17">     }</span>
<a href="#l8.18"></a><span id="l8.18">     catch (ex) {</span>
<a href="#l8.19"></a><span id="l8.19">       this._log.error(&quot;Error in init: &quot; + ex);</span>
<a href="#l8.20"></a><span id="l8.20">       throw ex;</span>
<a href="#l8.21"></a><span id="l8.21">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/db/gloda/modules/gloda.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/gloda.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -160,17 +160,17 @@ var Gloda = {</span>
<a href="#l9.4"></a><span id="l9.4"> </span>
<a href="#l9.5"></a><span id="l9.5">   _log: null,</span>
<a href="#l9.6"></a><span id="l9.6">   /**</span>
<a href="#l9.7"></a><span id="l9.7">    * Initialize logging; the error console window gets Warning/Error, and stdout</span>
<a href="#l9.8"></a><span id="l9.8">    *  (via dump) gets everything.</span>
<a href="#l9.9"></a><span id="l9.9">    */</span>
<a href="#l9.10"></a><span id="l9.10">   _initLogging: function gloda_ns_initLogging() {</span>
<a href="#l9.11"></a><span id="l9.11">     let formatter = new Log4Moz.BasicFormatter();</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    let root = Log4Moz.Service.rootLogger;</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    let root = Log4Moz.repository.rootLogger;</span>
<a href="#l9.14"></a><span id="l9.14">     root.level = Log4Moz.Level.Debug;</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16">     let enableConsoleLogging = false;</span>
<a href="#l9.17"></a><span id="l9.17">     let enableDumpLogging = false;</span>
<a href="#l9.18"></a><span id="l9.18">     let considerNetLogging = false;</span>
<a href="#l9.19"></a><span id="l9.19"> </span>
<a href="#l9.20"></a><span id="l9.20">     try {</span>
<a href="#l9.21"></a><span id="l9.21">       // figure out if event-driven indexing should be enabled...</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -205,17 +205,17 @@ var Gloda = {</span>
<a href="#l9.23"></a><span id="l9.23">         let [host, port] = data.split(&quot;:&quot;);</span>
<a href="#l9.24"></a><span id="l9.24">         let xf = new Log4Moz.XMLFormatter();</span>
<a href="#l9.25"></a><span id="l9.25">         let sapp = new Log4Moz.SocketAppender(host, Number(port), xf);</span>
<a href="#l9.26"></a><span id="l9.26">         sapp.level = Log4Moz.Level.All;</span>
<a href="#l9.27"></a><span id="l9.27">         root.addAppender(sapp);</span>
<a href="#l9.28"></a><span id="l9.28">       }</span>
<a href="#l9.29"></a><span id="l9.29">     }</span>
<a href="#l9.30"></a><span id="l9.30"> </span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-    this._log = Log4Moz.Service.getLogger(&quot;gloda.NS&quot;);</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+    this._log = Log4Moz.repository.getLogger(&quot;gloda.NS&quot;);</span>
<a href="#l9.33"></a><span id="l9.33">     this._log.info(&quot;Logging Initialized&quot;);</span>
<a href="#l9.34"></a><span id="l9.34">   },</span>
<a href="#l9.35"></a><span id="l9.35"> </span>
<a href="#l9.36"></a><span id="l9.36">   kIndexerIdle: 0,</span>
<a href="#l9.37"></a><span id="l9.37">   kIndexerIndexing: 1,</span>
<a href="#l9.38"></a><span id="l9.38">   kIndexerMoving: 2,</span>
<a href="#l9.39"></a><span id="l9.39">   kIndexerRemoving: 3,</span>
<a href="#l9.40"></a><span id="l9.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/db/gloda/modules/index_ab.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/index_ab.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -55,17 +55,17 @@ Cu.import(&quot;resource://app/modules/gloda/</span>
<a href="#l10.4"></a><span id="l10.4"> </span>
<a href="#l10.5"></a><span id="l10.5"> </span>
<a href="#l10.6"></a><span id="l10.6"> var GlodaABIndexer = {</span>
<a href="#l10.7"></a><span id="l10.7">   _log: null,</span>
<a href="#l10.8"></a><span id="l10.8"> </span>
<a href="#l10.9"></a><span id="l10.9">   name: &quot;ab_indexer&quot;,</span>
<a href="#l10.10"></a><span id="l10.10">   enable: function() {</span>
<a href="#l10.11"></a><span id="l10.11">     if (this._log == null)</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-      this._log =  Log4Moz.Service.getLogger(&quot;gloda.ab_indexer&quot;);</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+      this._log =  Log4Moz.repository.getLogger(&quot;gloda.ab_indexer&quot;);</span>
<a href="#l10.14"></a><span id="l10.14">   </span>
<a href="#l10.15"></a><span id="l10.15">     let abManager = Cc[&quot;@mozilla.org/abmanager;1&quot;].getService(Ci.nsIAbManager);</span>
<a href="#l10.16"></a><span id="l10.16">     abManager.addAddressBookListener(this, Ci.nsIAbListener.itemChanged);</span>
<a href="#l10.17"></a><span id="l10.17">   },</span>
<a href="#l10.18"></a><span id="l10.18">   </span>
<a href="#l10.19"></a><span id="l10.19">   disable: function() {</span>
<a href="#l10.20"></a><span id="l10.20">     let abManager = Cc[&quot;@mozilla.org/abmanager;1&quot;].getService(Ci.nsIAbManager);</span>
<a href="#l10.21"></a><span id="l10.21">     abManager.removeAddressBookListener(this);</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineat">@@ -120,17 +120,17 @@ var GlodaABIndexer = {</span>
<a href="#l10.23"></a><span id="l10.23"> };</span>
<a href="#l10.24"></a><span id="l10.24"> GlodaIndexer.registerIndexer(GlodaABIndexer);</span>
<a href="#l10.25"></a><span id="l10.25"> </span>
<a href="#l10.26"></a><span id="l10.26"> var GlodaABAttrs = {</span>
<a href="#l10.27"></a><span id="l10.27">   providerName: &quot;gloda.ab_attr&quot;,</span>
<a href="#l10.28"></a><span id="l10.28">   _log: null,</span>
<a href="#l10.29"></a><span id="l10.29"> </span>
<a href="#l10.30"></a><span id="l10.30">   init: function() {</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-    this._log =  Log4Moz.Service.getLogger(&quot;gloda.abattrs&quot;);</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+    this._log =  Log4Moz.repository.getLogger(&quot;gloda.abattrs&quot;);</span>
<a href="#l10.33"></a><span id="l10.33">     </span>
<a href="#l10.34"></a><span id="l10.34">     try {</span>
<a href="#l10.35"></a><span id="l10.35">       this.defineAttributes();</span>
<a href="#l10.36"></a><span id="l10.36">     }</span>
<a href="#l10.37"></a><span id="l10.37">     catch (ex) {</span>
<a href="#l10.38"></a><span id="l10.38">       this._log.error(&quot;Error in init: &quot; + ex);</span>
<a href="#l10.39"></a><span id="l10.39">       throw ex;</span>
<a href="#l10.40"></a><span id="l10.40">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/db/gloda/modules/indexer.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/indexer.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -64,17 +64,17 @@ Cu.import(&quot;resource://app/modules/gloda/</span>
<a href="#l11.4"></a><span id="l11.4"> </span>
<a href="#l11.5"></a><span id="l11.5"> // for list comprehension fun</span>
<a href="#l11.6"></a><span id="l11.6"> function range(begin, end) {</span>
<a href="#l11.7"></a><span id="l11.7">   for (let i = begin; i &lt; end; ++i) {</span>
<a href="#l11.8"></a><span id="l11.8">     yield i;</span>
<a href="#l11.9"></a><span id="l11.9">   }</span>
<a href="#l11.10"></a><span id="l11.10"> }</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-const GFI = Log4Moz.Service.getLogger(&quot;gloda.fixiterator&quot;);</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+const GFI = Log4Moz.repository.getLogger(&quot;gloda.fixiterator&quot;);</span>
<a href="#l11.14"></a><span id="l11.14"> </span>
<a href="#l11.15"></a><span id="l11.15"> </span>
<a href="#l11.16"></a><span id="l11.16"> // FROM STEEL (a la Joey Minta/jminta)</span>
<a href="#l11.17"></a><span id="l11.17"> // (and to go away when STEEL is checked in, although we may also want to</span>
<a href="#l11.18"></a><span id="l11.18"> //  consider just specializing the code in the few places this method is used.)</span>
<a href="#l11.19"></a><span id="l11.19"> /**</span>
<a href="#l11.20"></a><span id="l11.20">  * This function will take a variety of xpcom iterators designed for c++ and turn</span>
<a href="#l11.21"></a><span id="l11.21">  * them into a nice JavaScript style object that can be iterated using for...in</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineat">@@ -276,17 +276,17 @@ function IndexingJob(aJobType, aDeltaTyp</span>
<a href="#l11.23"></a><span id="l11.23"> var GlodaIndexer = {</span>
<a href="#l11.24"></a><span id="l11.24">   /**</span>
<a href="#l11.25"></a><span id="l11.25">    * A partial attempt to generalize to support multiple databases.  Each</span>
<a href="#l11.26"></a><span id="l11.26">    *  database would have its own datastore would have its own indexer.  But</span>
<a href="#l11.27"></a><span id="l11.27">    *  we rather inter-mingle our use of this field with the singleton global</span>
<a href="#l11.28"></a><span id="l11.28">    *  GlodaDatastore.</span>
<a href="#l11.29"></a><span id="l11.29">    */</span>
<a href="#l11.30"></a><span id="l11.30">   _datastore: GlodaDatastore,</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-  _log: Log4Moz.Service.getLogger(&quot;gloda.indexer&quot;),</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+  _log: Log4Moz.repository.getLogger(&quot;gloda.indexer&quot;),</span>
<a href="#l11.33"></a><span id="l11.33">   /**</span>
<a href="#l11.34"></a><span id="l11.34">    * Our nsITimer that we use to schedule ourselves on the main thread</span>
<a href="#l11.35"></a><span id="l11.35">    *  intermittently.  The timer always exists but may not always be active.</span>
<a href="#l11.36"></a><span id="l11.36">    */</span>
<a href="#l11.37"></a><span id="l11.37">   _timer: null,</span>
<a href="#l11.38"></a><span id="l11.38">   /**</span>
<a href="#l11.39"></a><span id="l11.39">    * Our nsITimer that we use to schedule events in the &quot;far&quot; future.  For now,</span>
<a href="#l11.40"></a><span id="l11.40">    *  this means not compelling an initial indexing sweep until some number of</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/db/gloda/modules/log4moz.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/log4moz.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -82,54 +82,63 @@ let Log4Moz = {</span>
<a href="#l12.4"></a><span id="l12.4">       40: &quot;INFO&quot;,</span>
<a href="#l12.5"></a><span id="l12.5">       30: &quot;CONFIG&quot;,</span>
<a href="#l12.6"></a><span id="l12.6">       20: &quot;DEBUG&quot;,</span>
<a href="#l12.7"></a><span id="l12.7">       10: &quot;TRACE&quot;,</span>
<a href="#l12.8"></a><span id="l12.8">       0:  &quot;ALL&quot;</span>
<a href="#l12.9"></a><span id="l12.9">     }</span>
<a href="#l12.10"></a><span id="l12.10">   },</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  get Service() {</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-    delete Log4Moz.Service;</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-    Log4Moz.Service = new Log4MozService();</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-    return Log4Moz.Service;</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+  get repository() {</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+    delete Log4Moz.repository;</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+    Log4Moz.repository = new LoggerRepository();</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+    return Log4Moz.repository;</span>
<a href="#l12.20"></a><span id="l12.20">   },</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+  set repository(value) {</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+    delete Log4Moz.repository;</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+    Log4Moz.repository = value;</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+  },</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineplus">+</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineplus">+  get LogMessage() { return LogMessage; },</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineplus">+  get Logger() { return Logger; },</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+  get LoggerRepository() { return LoggerRepository; },</span>
<a href="#l12.29"></a><span id="l12.29"> </span>
<a href="#l12.30"></a><span id="l12.30">   get Formatter() { return Formatter; },</span>
<a href="#l12.31"></a><span id="l12.31">   get BasicFormatter() { return BasicFormatter; },</span>
<a href="#l12.32"></a><span id="l12.32">   get XMLFormatter() { return XMLFormatter; },</span>
<a href="#l12.33"></a><span id="l12.33">   get Appender() { return Appender; },</span>
<a href="#l12.34"></a><span id="l12.34">   get DumpAppender() { return DumpAppender; },</span>
<a href="#l12.35"></a><span id="l12.35">   get ConsoleAppender() { return ConsoleAppender; },</span>
<a href="#l12.36"></a><span id="l12.36">   get FileAppender() { return FileAppender; },</span>
<a href="#l12.37"></a><span id="l12.37">   get SocketAppender() { return SocketAppender; },</span>
<a href="#l12.38"></a><span id="l12.38">   get RotatingFileAppender() { return RotatingFileAppender; },</span>
<a href="#l12.39"></a><span id="l12.39">   get ThrowingAppender() { return ThrowingAppender; },</span>
<a href="#l12.40"></a><span id="l12.40"> </span>
<a href="#l12.41"></a><span id="l12.41">   // Logging helper:</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineminus">-  // let logger = Log4Moz.Service.getLogger(&quot;foo&quot;);</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineplus">+  // let logger = Log4Moz.repository.getLogger(&quot;foo&quot;);</span>
<a href="#l12.44"></a><span id="l12.44">   // logger.info(Log4Moz.enumerateInterfaces(someObject).join(&quot;,&quot;));</span>
<a href="#l12.45"></a><span id="l12.45" class="difflineminus">-  enumerateInterfaces: function(aObject) {</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineplus">+  enumerateInterfaces: function Log4Moz_enumerateInterfaces(aObject) {</span>
<a href="#l12.47"></a><span id="l12.47">     let interfaces = [];</span>
<a href="#l12.48"></a><span id="l12.48"> </span>
<a href="#l12.49"></a><span id="l12.49">     for (i in Ci) {</span>
<a href="#l12.50"></a><span id="l12.50">       try {</span>
<a href="#l12.51"></a><span id="l12.51">         aObject.QueryInterface(Ci[i]);</span>
<a href="#l12.52"></a><span id="l12.52">         interfaces.push(i);</span>
<a href="#l12.53"></a><span id="l12.53">       }</span>
<a href="#l12.54"></a><span id="l12.54">       catch(ex) {}</span>
<a href="#l12.55"></a><span id="l12.55">     }</span>
<a href="#l12.56"></a><span id="l12.56"> </span>
<a href="#l12.57"></a><span id="l12.57">     return interfaces;</span>
<a href="#l12.58"></a><span id="l12.58">   },</span>
<a href="#l12.59"></a><span id="l12.59"> </span>
<a href="#l12.60"></a><span id="l12.60">   // Logging helper:</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineminus">-  // let logger = Log4Moz.Service.getLogger(&quot;foo&quot;);</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineplus">+  // let logger = Log4Moz.repository.getLogger(&quot;foo&quot;);</span>
<a href="#l12.63"></a><span id="l12.63">   // logger.info(Log4Moz.enumerateProperties(someObject).join(&quot;,&quot;));</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineminus">-  enumerateProperties: function(aObject, aExcludeComplexTypes) {</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineplus">+  enumerateProperties: function Log4Moz_enumerateProps(aObject,</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineplus">+                                                       aExcludeComplexTypes) {</span>
<a href="#l12.67"></a><span id="l12.67">     let properties = [];</span>
<a href="#l12.68"></a><span id="l12.68"> </span>
<a href="#l12.69"></a><span id="l12.69">     for (p in aObject) {</span>
<a href="#l12.70"></a><span id="l12.70">       try {</span>
<a href="#l12.71"></a><span id="l12.71">         if (aExcludeComplexTypes &amp;&amp;</span>
<a href="#l12.72"></a><span id="l12.72">             (typeof aObject[p] == &quot;object&quot; || typeof aObject[p] == &quot;function&quot;))</span>
<a href="#l12.73"></a><span id="l12.73">           continue;</span>
<a href="#l12.74"></a><span id="l12.74">         properties.push(p + &quot; = &quot; + aObject[p]);</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineat">@@ -170,25 +179,35 @@ LogMessage.prototype = {</span>
<a href="#l12.76"></a><span id="l12.76"> };</span>
<a href="#l12.77"></a><span id="l12.77"> </span>
<a href="#l12.78"></a><span id="l12.78"> /*</span>
<a href="#l12.79"></a><span id="l12.79">  * Logger</span>
<a href="#l12.80"></a><span id="l12.80">  * Hierarchical version.  Logs to all appenders, assigned or inherited</span>
<a href="#l12.81"></a><span id="l12.81">  */</span>
<a href="#l12.82"></a><span id="l12.82"> </span>
<a href="#l12.83"></a><span id="l12.83"> function Logger(name, repository) {</span>
<a href="#l12.84"></a><span id="l12.84" class="difflineminus">-  this._name = name;</span>
<a href="#l12.85"></a><span id="l12.85" class="difflineminus">-  this._repository = repository;</span>
<a href="#l12.86"></a><span id="l12.86" class="difflineminus">-  this._appenders = [];</span>
<a href="#l12.87"></a><span id="l12.87" class="difflineplus">+  this._init(name, repository);</span>
<a href="#l12.88"></a><span id="l12.88"> }</span>
<a href="#l12.89"></a><span id="l12.89"> Logger.prototype = {</span>
<a href="#l12.90"></a><span id="l12.90" class="difflineplus">+  _init: function Logger__init(name, repository) {</span>
<a href="#l12.91"></a><span id="l12.91" class="difflineplus">+    if (!repository)</span>
<a href="#l12.92"></a><span id="l12.92" class="difflineplus">+      repository = Log4Moz.repository;</span>
<a href="#l12.93"></a><span id="l12.93" class="difflineplus">+    this._name = name;</span>
<a href="#l12.94"></a><span id="l12.94" class="difflineplus">+    this._appenders = [];</span>
<a href="#l12.95"></a><span id="l12.95" class="difflineplus">+    this._repository = repository;</span>
<a href="#l12.96"></a><span id="l12.96" class="difflineplus">+  },</span>
<a href="#l12.97"></a><span id="l12.97" class="difflineplus">+</span>
<a href="#l12.98"></a><span id="l12.98">   QueryInterface: XPCOMUtils.generateQI([Ci.nsISupports]),</span>
<a href="#l12.99"></a><span id="l12.99"> </span>
<a href="#l12.100"></a><span id="l12.100">   parent: null,</span>
<a href="#l12.101"></a><span id="l12.101"> </span>
<a href="#l12.102"></a><span id="l12.102" class="difflineplus">+  get name() {</span>
<a href="#l12.103"></a><span id="l12.103" class="difflineplus">+    return this._name;</span>
<a href="#l12.104"></a><span id="l12.104" class="difflineplus">+  },</span>
<a href="#l12.105"></a><span id="l12.105" class="difflineplus">+</span>
<a href="#l12.106"></a><span id="l12.106">   _level: null,</span>
<a href="#l12.107"></a><span id="l12.107">   get level() {</span>
<a href="#l12.108"></a><span id="l12.108">     if (this._level != null)</span>
<a href="#l12.109"></a><span id="l12.109">       return this._level;</span>
<a href="#l12.110"></a><span id="l12.110">     if (this.parent)</span>
<a href="#l12.111"></a><span id="l12.111">       return this.parent.level;</span>
<a href="#l12.112"></a><span id="l12.112">     dump(&quot;log4moz warning: root logger configuration error: no level defined\n&quot;);</span>
<a href="#l12.113"></a><span id="l12.113">     return Log4Moz.Level.All;</span>
<a href="#l12.114"></a><span id="l12.114" class="difflineat">@@ -268,43 +287,47 @@ LoggerRepository.prototype = {</span>
<a href="#l12.115"></a><span id="l12.115">   //  this._rootLogger = logger;</span>
<a href="#l12.116"></a><span id="l12.116">   //},</span>
<a href="#l12.117"></a><span id="l12.117"> </span>
<a href="#l12.118"></a><span id="l12.118">   _updateParents: function LogRep__updateParents(name) {</span>
<a href="#l12.119"></a><span id="l12.119">     let pieces = name.split('.');</span>
<a href="#l12.120"></a><span id="l12.120">     let cur, parent;</span>
<a href="#l12.121"></a><span id="l12.121"> </span>
<a href="#l12.122"></a><span id="l12.122">     // find the closest parent</span>
<a href="#l12.123"></a><span id="l12.123" class="difflineminus">-    for (let i = 0; i &lt; pieces.length; i++) {</span>
<a href="#l12.124"></a><span id="l12.124" class="difflineplus">+    // don't test for the logger name itself, as there's a chance it's already</span>
<a href="#l12.125"></a><span id="l12.125" class="difflineplus">+    // there in this._loggers</span>
<a href="#l12.126"></a><span id="l12.126" class="difflineplus">+    for (let i = 0; i &lt; pieces.length - 1; i++) {</span>
<a href="#l12.127"></a><span id="l12.127">       if (cur)</span>
<a href="#l12.128"></a><span id="l12.128">         cur += '.' + pieces[i];</span>
<a href="#l12.129"></a><span id="l12.129">       else</span>
<a href="#l12.130"></a><span id="l12.130">         cur = pieces[i];</span>
<a href="#l12.131"></a><span id="l12.131">       if (cur in this._loggers)</span>
<a href="#l12.132"></a><span id="l12.132">         parent = cur;</span>
<a href="#l12.133"></a><span id="l12.133">     }</span>
<a href="#l12.134"></a><span id="l12.134"> </span>
<a href="#l12.135"></a><span id="l12.135" class="difflineminus">-    // if they are the same it has no parent</span>
<a href="#l12.136"></a><span id="l12.136" class="difflineminus">-    if (parent == name)</span>
<a href="#l12.137"></a><span id="l12.137" class="difflineplus">+    // if we didn't assign a parent above, there is no parent</span>
<a href="#l12.138"></a><span id="l12.138" class="difflineplus">+    if (!parent)</span>
<a href="#l12.139"></a><span id="l12.139">       this._loggers[name].parent = this.rootLogger;</span>
<a href="#l12.140"></a><span id="l12.140">     else</span>
<a href="#l12.141"></a><span id="l12.141">       this._loggers[name].parent = this._loggers[parent];</span>
<a href="#l12.142"></a><span id="l12.142"> </span>
<a href="#l12.143"></a><span id="l12.143">     // trigger updates for any possible descendants of this logger</span>
<a href="#l12.144"></a><span id="l12.144">     for (let logger in this._loggers) {</span>
<a href="#l12.145"></a><span id="l12.145" class="difflineminus">-      if (logger != name &amp;&amp; name.indexOf(logger) == 0)</span>
<a href="#l12.146"></a><span id="l12.146" class="difflineplus">+      if (logger != name &amp;&amp; logger.indexOf(name) == 0)</span>
<a href="#l12.147"></a><span id="l12.147">         this._updateParents(logger);</span>
<a href="#l12.148"></a><span id="l12.148">     }</span>
<a href="#l12.149"></a><span id="l12.149">   },</span>
<a href="#l12.150"></a><span id="l12.150"> </span>
<a href="#l12.151"></a><span id="l12.151">   getLogger: function LogRep_getLogger(name) {</span>
<a href="#l12.152"></a><span id="l12.152" class="difflineminus">-    if (!(name in this._loggers)) {</span>
<a href="#l12.153"></a><span id="l12.153" class="difflineminus">-      this._loggers[name] = new Logger(name, this);</span>
<a href="#l12.154"></a><span id="l12.154" class="difflineminus">-      this._updateParents(name);</span>
<a href="#l12.155"></a><span id="l12.155" class="difflineminus">-    }</span>
<a href="#l12.156"></a><span id="l12.156" class="difflineplus">+    if (!name)</span>
<a href="#l12.157"></a><span id="l12.157" class="difflineplus">+      name = this.getLogger.caller.name;</span>
<a href="#l12.158"></a><span id="l12.158" class="difflineplus">+    if (name in this._loggers)</span>
<a href="#l12.159"></a><span id="l12.159" class="difflineplus">+      return this._loggers[name];</span>
<a href="#l12.160"></a><span id="l12.160" class="difflineplus">+    this._loggers[name] = new Logger(name, this);</span>
<a href="#l12.161"></a><span id="l12.161" class="difflineplus">+    this._updateParents(name);</span>
<a href="#l12.162"></a><span id="l12.162">     return this._loggers[name];</span>
<a href="#l12.163"></a><span id="l12.163">   }</span>
<a href="#l12.164"></a><span id="l12.164"> };</span>
<a href="#l12.165"></a><span id="l12.165"> </span>
<a href="#l12.166"></a><span id="l12.166"> /*</span>
<a href="#l12.167"></a><span id="l12.167">  * Formatters</span>
<a href="#l12.168"></a><span id="l12.168">  * These massage a LogMessage into whatever output is desired</span>
<a href="#l12.169"></a><span id="l12.169">  * Only the BasicFormatter is currently implemented</span>
<a href="#l12.170"></a><span id="l12.170" class="difflineat">@@ -318,16 +341,18 @@ Formatter.prototype = {</span>
<a href="#l12.171"></a><span id="l12.171"> };</span>
<a href="#l12.172"></a><span id="l12.172"> </span>
<a href="#l12.173"></a><span id="l12.173"> // FIXME: should allow for formatting the whole string, not just the date</span>
<a href="#l12.174"></a><span id="l12.174"> function BasicFormatter(dateFormat) {</span>
<a href="#l12.175"></a><span id="l12.175">   if (dateFormat)</span>
<a href="#l12.176"></a><span id="l12.176">     this.dateFormat = dateFormat;</span>
<a href="#l12.177"></a><span id="l12.177"> }</span>
<a href="#l12.178"></a><span id="l12.178"> BasicFormatter.prototype = {</span>
<a href="#l12.179"></a><span id="l12.179" class="difflineplus">+  __proto__: Formatter.prototype,</span>
<a href="#l12.180"></a><span id="l12.180" class="difflineplus">+</span>
<a href="#l12.181"></a><span id="l12.181">   _dateFormat: null,</span>
<a href="#l12.182"></a><span id="l12.182"> </span>
<a href="#l12.183"></a><span id="l12.183">   get dateFormat() {</span>
<a href="#l12.184"></a><span id="l12.184">     if (!this._dateFormat)</span>
<a href="#l12.185"></a><span id="l12.185">       this._dateFormat = &quot;%Y-%m-%d %H:%M:%S&quot;;</span>
<a href="#l12.186"></a><span id="l12.186">     return this._dateFormat;</span>
<a href="#l12.187"></a><span id="l12.187">   },</span>
<a href="#l12.188"></a><span id="l12.188"> </span>
<a href="#l12.189"></a><span id="l12.189" class="difflineat">@@ -337,40 +362,40 @@ BasicFormatter.prototype = {</span>
<a href="#l12.190"></a><span id="l12.190"> </span>
<a href="#l12.191"></a><span id="l12.191">   format: function BF_format(message) {</span>
<a href="#l12.192"></a><span id="l12.192">     let date = new Date(message.time);</span>
<a href="#l12.193"></a><span id="l12.193">     return date.toLocaleFormat(this.dateFormat) + &quot;\t&quot; +</span>
<a href="#l12.194"></a><span id="l12.194">       message.loggerName + &quot;\t&quot; + message.levelDesc + &quot;\t&quot; +</span>
<a href="#l12.195"></a><span id="l12.195">       message.message + &quot;\n&quot;;</span>
<a href="#l12.196"></a><span id="l12.196">   }</span>
<a href="#l12.197"></a><span id="l12.197"> };</span>
<a href="#l12.198"></a><span id="l12.198" class="difflineminus">-BasicFormatter.prototype.__proto__ = new Formatter();</span>
<a href="#l12.199"></a><span id="l12.199"> </span>
<a href="#l12.200"></a><span id="l12.200"> /*</span>
<a href="#l12.201"></a><span id="l12.201">  * XMLFormatter</span>
<a href="#l12.202"></a><span id="l12.202">  * Format like log4j's XMLLayout.  The intent is that you can hook this up to</span>
<a href="#l12.203"></a><span id="l12.203">  * a SocketAppender and point them at a Chainsaw GUI running with an</span>
<a href="#l12.204"></a><span id="l12.204">  * XMLSocketReceiver running.  Then your output comes out in Chainsaw.</span>
<a href="#l12.205"></a><span id="l12.205">  * (Chainsaw is log4j's GUI that displays log output with niceties such as</span>
<a href="#l12.206"></a><span id="l12.206">  * filtering and conditional coloring.)</span>
<a href="#l12.207"></a><span id="l12.207">  */</span>
<a href="#l12.208"></a><span id="l12.208"> </span>
<a href="#l12.209"></a><span id="l12.209"> function XMLFormatter() {}</span>
<a href="#l12.210"></a><span id="l12.210"> XMLFormatter.prototype = {</span>
<a href="#l12.211"></a><span id="l12.211" class="difflineplus">+  __proto__: Formatter.prototype,</span>
<a href="#l12.212"></a><span id="l12.212" class="difflineplus">+</span>
<a href="#l12.213"></a><span id="l12.213">   format: function XF_format(message) {</span>
<a href="#l12.214"></a><span id="l12.214">     let cdataEscapedMessage = message.message.replace(CDATA_END,</span>
<a href="#l12.215"></a><span id="l12.215">                                                       CDATA_ESCAPED_END, &quot;g&quot;);</span>
<a href="#l12.216"></a><span id="l12.216">     return &quot;&lt;log4j:event logger='&quot; + message.loggerName + &quot;' &quot; +</span>
<a href="#l12.217"></a><span id="l12.217">                         &quot;level='&quot; + message.levelDesc + &quot;' thread='unknown' &quot; +</span>
<a href="#l12.218"></a><span id="l12.218">                         &quot;timestamp='&quot; + message.time + &quot;'&gt;&quot; +</span>
<a href="#l12.219"></a><span id="l12.219">       &quot;&lt;log4j:message&gt;&lt;![CDATA[&quot; + cdataEscapedMessage + &quot;]]&gt;&lt;/log4j:message&gt;&quot; +</span>
<a href="#l12.220"></a><span id="l12.220">       &quot;&lt;/log4j:event&gt;&quot;;</span>
<a href="#l12.221"></a><span id="l12.221">   }</span>
<a href="#l12.222"></a><span id="l12.222"> }</span>
<a href="#l12.223"></a><span id="l12.223" class="difflineminus">-XMLFormatter.prototype.__proto__ = new Formatter();</span>
<a href="#l12.224"></a><span id="l12.224"> </span>
<a href="#l12.225"></a><span id="l12.225"> /*</span>
<a href="#l12.226"></a><span id="l12.226">  * Appenders</span>
<a href="#l12.227"></a><span id="l12.227">  * These can be attached to Loggers to log to different places</span>
<a href="#l12.228"></a><span id="l12.228">  * Simply subclass and override doAppend to implement a new one</span>
<a href="#l12.229"></a><span id="l12.229">  */</span>
<a href="#l12.230"></a><span id="l12.230"> </span>
<a href="#l12.231"></a><span id="l12.231"> function Appender(formatter) {</span>
<a href="#l12.232"></a><span id="l12.232" class="difflineat">@@ -397,57 +422,61 @@ Appender.prototype = {</span>
<a href="#l12.233"></a><span id="l12.233"> </span>
<a href="#l12.234"></a><span id="l12.234"> /*</span>
<a href="#l12.235"></a><span id="l12.235">  * DumpAppender</span>
<a href="#l12.236"></a><span id="l12.236">  * Logs to standard out</span>
<a href="#l12.237"></a><span id="l12.237">  */</span>
<a href="#l12.238"></a><span id="l12.238"> </span>
<a href="#l12.239"></a><span id="l12.239"> function DumpAppender(formatter) {</span>
<a href="#l12.240"></a><span id="l12.240">   this._name = &quot;DumpAppender&quot;;</span>
<a href="#l12.241"></a><span id="l12.241" class="difflineminus">-  this._formatter = formatter;</span>
<a href="#l12.242"></a><span id="l12.242" class="difflineplus">+  this._formatter = formatter? formatter : new BasicFormatter();</span>
<a href="#l12.243"></a><span id="l12.243"> }</span>
<a href="#l12.244"></a><span id="l12.244"> DumpAppender.prototype = {</span>
<a href="#l12.245"></a><span id="l12.245" class="difflineplus">+  __proto__: Appender.prototype,</span>
<a href="#l12.246"></a><span id="l12.246" class="difflineplus">+</span>
<a href="#l12.247"></a><span id="l12.247">   doAppend: function DApp_doAppend(message) {</span>
<a href="#l12.248"></a><span id="l12.248">     dump(message);</span>
<a href="#l12.249"></a><span id="l12.249">   }</span>
<a href="#l12.250"></a><span id="l12.250"> };</span>
<a href="#l12.251"></a><span id="l12.251" class="difflineminus">-DumpAppender.prototype.__proto__ = new Appender();</span>
<a href="#l12.252"></a><span id="l12.252"> </span>
<a href="#l12.253"></a><span id="l12.253"> /*</span>
<a href="#l12.254"></a><span id="l12.254">  * ConsoleAppender</span>
<a href="#l12.255"></a><span id="l12.255">  * Logs to the javascript console</span>
<a href="#l12.256"></a><span id="l12.256">  */</span>
<a href="#l12.257"></a><span id="l12.257"> </span>
<a href="#l12.258"></a><span id="l12.258"> function ConsoleAppender(formatter) {</span>
<a href="#l12.259"></a><span id="l12.259">   this._name = &quot;ConsoleAppender&quot;;</span>
<a href="#l12.260"></a><span id="l12.260">   this._formatter = formatter;</span>
<a href="#l12.261"></a><span id="l12.261"> }</span>
<a href="#l12.262"></a><span id="l12.262"> ConsoleAppender.prototype = {</span>
<a href="#l12.263"></a><span id="l12.263" class="difflineplus">+  __proto__: Appender.prototype,</span>
<a href="#l12.264"></a><span id="l12.264" class="difflineplus">+</span>
<a href="#l12.265"></a><span id="l12.265">   doAppend: function CApp_doAppend(message) {</span>
<a href="#l12.266"></a><span id="l12.266">     if (message.level &gt; Log4Moz.Level.Warn) {</span>
<a href="#l12.267"></a><span id="l12.267">       Cu.reportError(message);</span>
<a href="#l12.268"></a><span id="l12.268">       return;</span>
<a href="#l12.269"></a><span id="l12.269">     }</span>
<a href="#l12.270"></a><span id="l12.270">     Cc[&quot;@mozilla.org/consoleservice;1&quot;].</span>
<a href="#l12.271"></a><span id="l12.271">       getService(Ci.nsIConsoleService).logStringMessage(message);</span>
<a href="#l12.272"></a><span id="l12.272">   }</span>
<a href="#l12.273"></a><span id="l12.273"> };</span>
<a href="#l12.274"></a><span id="l12.274" class="difflineminus">-ConsoleAppender.prototype.__proto__ = new Appender();</span>
<a href="#l12.275"></a><span id="l12.275"> </span>
<a href="#l12.276"></a><span id="l12.276"> /*</span>
<a href="#l12.277"></a><span id="l12.277">  * FileAppender</span>
<a href="#l12.278"></a><span id="l12.278">  * Logs to a file</span>
<a href="#l12.279"></a><span id="l12.279">  */</span>
<a href="#l12.280"></a><span id="l12.280"> </span>
<a href="#l12.281"></a><span id="l12.281"> function FileAppender(file, formatter) {</span>
<a href="#l12.282"></a><span id="l12.282">   this._name = &quot;FileAppender&quot;;</span>
<a href="#l12.283"></a><span id="l12.283">   this._file = file; // nsIFile</span>
<a href="#l12.284"></a><span id="l12.284" class="difflineminus">-  this._formatter = formatter;</span>
<a href="#l12.285"></a><span id="l12.285" class="difflineplus">+  this._formatter = formatter? formatter : new BasicFormatter();</span>
<a href="#l12.286"></a><span id="l12.286"> }</span>
<a href="#l12.287"></a><span id="l12.287"> FileAppender.prototype = {</span>
<a href="#l12.288"></a><span id="l12.288" class="difflineplus">+  __proto__: Appender.prototype,</span>
<a href="#l12.289"></a><span id="l12.289" class="difflineplus">+</span>
<a href="#l12.290"></a><span id="l12.290">   __fos: null,</span>
<a href="#l12.291"></a><span id="l12.291">   get _fos() {</span>
<a href="#l12.292"></a><span id="l12.292">     if (!this.__fos)</span>
<a href="#l12.293"></a><span id="l12.293">       this.openStream();</span>
<a href="#l12.294"></a><span id="l12.294">     return this.__fos;</span>
<a href="#l12.295"></a><span id="l12.295">   },</span>
<a href="#l12.296"></a><span id="l12.296"> </span>
<a href="#l12.297"></a><span id="l12.297">   openStream: function FApp_openStream() {</span>
<a href="#l12.298"></a><span id="l12.298" class="difflineat">@@ -478,37 +507,38 @@ FileAppender.prototype = {</span>
<a href="#l12.299"></a><span id="l12.299">     }</span>
<a href="#l12.300"></a><span id="l12.300">   },</span>
<a href="#l12.301"></a><span id="l12.301"> </span>
<a href="#l12.302"></a><span id="l12.302">   clear: function FApp_clear() {</span>
<a href="#l12.303"></a><span id="l12.303">     this.closeStream();</span>
<a href="#l12.304"></a><span id="l12.304">     this._file.remove(false);</span>
<a href="#l12.305"></a><span id="l12.305">   }</span>
<a href="#l12.306"></a><span id="l12.306"> };</span>
<a href="#l12.307"></a><span id="l12.307" class="difflineminus">-FileAppender.prototype.__proto__ = new Appender();</span>
<a href="#l12.308"></a><span id="l12.308"> </span>
<a href="#l12.309"></a><span id="l12.309"> /*</span>
<a href="#l12.310"></a><span id="l12.310">  * RotatingFileAppender</span>
<a href="#l12.311"></a><span id="l12.311">  * Similar to FileAppender, but rotates logs when they become too large</span>
<a href="#l12.312"></a><span id="l12.312">  */</span>
<a href="#l12.313"></a><span id="l12.313"> </span>
<a href="#l12.314"></a><span id="l12.314"> function RotatingFileAppender(file, formatter, maxSize, maxBackups) {</span>
<a href="#l12.315"></a><span id="l12.315">   if (maxSize === undefined)</span>
<a href="#l12.316"></a><span id="l12.316">     maxSize = ONE_MEGABYTE * 2;</span>
<a href="#l12.317"></a><span id="l12.317"> </span>
<a href="#l12.318"></a><span id="l12.318">   if (maxBackups === undefined)</span>
<a href="#l12.319"></a><span id="l12.319">     maxBackups = 0;</span>
<a href="#l12.320"></a><span id="l12.320"> </span>
<a href="#l12.321"></a><span id="l12.321">   this._name = &quot;RotatingFileAppender&quot;;</span>
<a href="#l12.322"></a><span id="l12.322">   this._file = file; // nsIFile</span>
<a href="#l12.323"></a><span id="l12.323" class="difflineminus">-  this._formatter = formatter;</span>
<a href="#l12.324"></a><span id="l12.324" class="difflineplus">+  this._formatter = formatter? formatter : new BasicFormatter();</span>
<a href="#l12.325"></a><span id="l12.325">   this._maxSize = maxSize;</span>
<a href="#l12.326"></a><span id="l12.326">   this._maxBackups = maxBackups;</span>
<a href="#l12.327"></a><span id="l12.327"> }</span>
<a href="#l12.328"></a><span id="l12.328"> RotatingFileAppender.prototype = {</span>
<a href="#l12.329"></a><span id="l12.329" class="difflineplus">+  __proto__: FileAppender.prototype,</span>
<a href="#l12.330"></a><span id="l12.330" class="difflineplus">+</span>
<a href="#l12.331"></a><span id="l12.331">   doAppend: function RFApp_doAppend(message) {</span>
<a href="#l12.332"></a><span id="l12.332">     if (message === null || message.length &lt;= 0)</span>
<a href="#l12.333"></a><span id="l12.333">       return;</span>
<a href="#l12.334"></a><span id="l12.334">     try {</span>
<a href="#l12.335"></a><span id="l12.335">       this.rotateLogs();</span>
<a href="#l12.336"></a><span id="l12.336">       this._fos.write(message, message.length);</span>
<a href="#l12.337"></a><span id="l12.337">     } catch(e) {</span>
<a href="#l12.338"></a><span id="l12.338">       dump(&quot;Error writing file:\n&quot; + e);</span>
<a href="#l12.339"></a><span id="l12.339" class="difflineat">@@ -530,17 +560,16 @@ RotatingFileAppender.prototype = {</span>
<a href="#l12.340"></a><span id="l12.340"> </span>
<a href="#l12.341"></a><span id="l12.341">     let cur = this._file.clone();</span>
<a href="#l12.342"></a><span id="l12.342">     if (cur.exists())</span>
<a href="#l12.343"></a><span id="l12.343">       cur.moveTo(cur.parent, cur.leafName + &quot;.1&quot;);</span>
<a href="#l12.344"></a><span id="l12.344"> </span>
<a href="#l12.345"></a><span id="l12.345">     // Note: this._file still points to the same file</span>
<a href="#l12.346"></a><span id="l12.346">   }</span>
<a href="#l12.347"></a><span id="l12.347"> };</span>
<a href="#l12.348"></a><span id="l12.348" class="difflineminus">-RotatingFileAppender.prototype.__proto__ = new FileAppender();</span>
<a href="#l12.349"></a><span id="l12.349"> </span>
<a href="#l12.350"></a><span id="l12.350"> /*</span>
<a href="#l12.351"></a><span id="l12.351">  * SocketAppender</span>
<a href="#l12.352"></a><span id="l12.352">  * Logs via TCP to a given host and port.  Attempts to automatically reconnect</span>
<a href="#l12.353"></a><span id="l12.353">  * when the connection drops or cannot be initially re-established.  Connection</span>
<a href="#l12.354"></a><span id="l12.354">  * attempts will happen at most every timeoutDelay seconds (has a sane default</span>
<a href="#l12.355"></a><span id="l12.355">  * if left blank).  Messages are dropped when there is no connection.  </span>
<a href="#l12.356"></a><span id="l12.356">  */</span>
<a href="#l12.357"></a><span id="l12.357" class="difflineat">@@ -553,16 +582,18 @@ function SocketAppender(host, port, form</span>
<a href="#l12.358"></a><span id="l12.358">   this._timeout_delay = timeoutDelay || DEFAULT_NETWORK_TIMEOUT_DELAY;</span>
<a href="#l12.359"></a><span id="l12.359"> </span>
<a href="#l12.360"></a><span id="l12.360">   this._socketService = Cc[&quot;@mozilla.org/network/socket-transport-service;1&quot;]</span>
<a href="#l12.361"></a><span id="l12.361">                           .getService(Ci.nsISocketTransportService);</span>
<a href="#l12.362"></a><span id="l12.362">   this._mainThread =</span>
<a href="#l12.363"></a><span id="l12.363">     Cc[&quot;@mozilla.org/thread-manager;1&quot;].getService().mainThread;</span>
<a href="#l12.364"></a><span id="l12.364"> }</span>
<a href="#l12.365"></a><span id="l12.365"> SocketAppender.prototype = {</span>
<a href="#l12.366"></a><span id="l12.366" class="difflineplus">+  __proto__: Appender.prototype,</span>
<a href="#l12.367"></a><span id="l12.367" class="difflineplus">+</span>
<a href="#l12.368"></a><span id="l12.368">   __nos: null,</span>
<a href="#l12.369"></a><span id="l12.369">   get _nos() {</span>
<a href="#l12.370"></a><span id="l12.370">     if (!this.__nos)</span>
<a href="#l12.371"></a><span id="l12.371">       this.openStream();</span>
<a href="#l12.372"></a><span id="l12.372">     return this.__nos;</span>
<a href="#l12.373"></a><span id="l12.373">   },</span>
<a href="#l12.374"></a><span id="l12.374">   _nextCheck: 0,</span>
<a href="#l12.375"></a><span id="l12.375">   openStream: function SApp_openStream() {</span>
<a href="#l12.376"></a><span id="l12.376" class="difflineat">@@ -629,55 +660,30 @@ SocketAppender.prototype = {</span>
<a href="#l12.377"></a><span id="l12.377">   },</span>
<a href="#l12.378"></a><span id="l12.378">   </span>
<a href="#l12.379"></a><span id="l12.379">   /* nsITransportEventSink */</span>
<a href="#l12.380"></a><span id="l12.380">   onTransportStatus: function SApp_onTransportStatus(aTransport, aStatus,</span>
<a href="#l12.381"></a><span id="l12.381">       aProgress, aProgressMax) {</span>
<a href="#l12.382"></a><span id="l12.382">     if (aStatus == 0x804b0004) // STATUS_CONNECTED_TO is not a constant.</span>
<a href="#l12.383"></a><span id="l12.383">       this._connected = true;</span>
<a href="#l12.384"></a><span id="l12.384">   },</span>
<a href="#l12.385"></a><span id="l12.385" class="difflineminus">-  </span>
<a href="#l12.386"></a><span id="l12.386"> };</span>
<a href="#l12.387"></a><span id="l12.387" class="difflineminus">-SocketAppender.prototype.__proto__ = new Appender();</span>
<a href="#l12.388"></a><span id="l12.388" class="difflineminus">-</span>
<a href="#l12.389"></a><span id="l12.389"> </span>
<a href="#l12.390"></a><span id="l12.390"> /**</span>
<a href="#l12.391"></a><span id="l12.391">  * Throws an exception whenever it gets a message.  Intended to be used in</span>
<a href="#l12.392"></a><span id="l12.392">  * automated testing situations where the code would normally log an error but</span>
<a href="#l12.393"></a><span id="l12.393">  * not die in a fatal manner. </span>
<a href="#l12.394"></a><span id="l12.394">  */</span>
<a href="#l12.395"></a><span id="l12.395"> function ThrowingAppender(thrower) {</span>
<a href="#l12.396"></a><span id="l12.396">   this._name = &quot;ThrowingAppender&quot;;</span>
<a href="#l12.397"></a><span id="l12.397">   // the default BasicFormatter we end up inheriting is fine</span>
<a href="#l12.398"></a><span id="l12.398">   this._thrower = thrower;</span>
<a href="#l12.399"></a><span id="l12.399"> }</span>
<a href="#l12.400"></a><span id="l12.400"> ThrowingAppender.prototype = {</span>
<a href="#l12.401"></a><span id="l12.401" class="difflineplus">+  __proto__: Appender.prototype,</span>
<a href="#l12.402"></a><span id="l12.402" class="difflineplus">+</span>
<a href="#l12.403"></a><span id="l12.403">   doAppend: function TApp_doAppend(message) {</span>
<a href="#l12.404"></a><span id="l12.404">     if (this._thrower)</span>
<a href="#l12.405"></a><span id="l12.405">       this._thrower(message);</span>
<a href="#l12.406"></a><span id="l12.406">     else</span>
<a href="#l12.407"></a><span id="l12.407">       throw message;</span>
<a href="#l12.408"></a><span id="l12.408">   }</span>
<a href="#l12.409"></a><span id="l12.409"> };</span>
<a href="#l12.410"></a><span id="l12.410" class="difflineminus">-ThrowingAppender.prototype.__proto__ = new Appender();</span>
<a href="#l12.411"></a><span id="l12.411" class="difflineminus">-</span>
<a href="#l12.412"></a><span id="l12.412" class="difflineminus">-</span>
<a href="#l12.413"></a><span id="l12.413" class="difflineminus">-/*</span>
<a href="#l12.414"></a><span id="l12.414" class="difflineminus">- * LoggingService</span>
<a href="#l12.415"></a><span id="l12.415" class="difflineminus">- */</span>
<a href="#l12.416"></a><span id="l12.416" class="difflineminus">-</span>
<a href="#l12.417"></a><span id="l12.417" class="difflineminus">-function Log4MozService() {</span>
<a href="#l12.418"></a><span id="l12.418" class="difflineminus">-  this._repository = new LoggerRepository();</span>
<a href="#l12.419"></a><span id="l12.419" class="difflineminus">-}</span>
<a href="#l12.420"></a><span id="l12.420" class="difflineminus">-Log4MozService.prototype = {</span>
<a href="#l12.421"></a><span id="l12.421" class="difflineminus">-  //classDescription: &quot;Log4moz Logging Service&quot;,</span>
<a href="#l12.422"></a><span id="l12.422" class="difflineminus">-  //contractID: &quot;@mozilla.org/log4moz/service;1&quot;,</span>
<a href="#l12.423"></a><span id="l12.423" class="difflineminus">-  //classID: Components.ID(&quot;{a60e50d7-90b8-4a12-ad0c-79e6a1896978}&quot;),</span>
<a href="#l12.424"></a><span id="l12.424" class="difflineminus">-  QueryInterface: XPCOMUtils.generateQI([Ci.nsISupports]),</span>
<a href="#l12.425"></a><span id="l12.425" class="difflineminus">-</span>
<a href="#l12.426"></a><span id="l12.426" class="difflineminus">-  get rootLogger() {</span>
<a href="#l12.427"></a><span id="l12.427" class="difflineminus">-    return this._repository.rootLogger;</span>
<a href="#l12.428"></a><span id="l12.428" class="difflineminus">-  },</span>
<a href="#l12.429"></a><span id="l12.429" class="difflineminus">-</span>
<a href="#l12.430"></a><span id="l12.430" class="difflineminus">-  getLogger: function LogSvc_getLogger(name) {</span>
<a href="#l12.431"></a><span id="l12.431" class="difflineminus">-    return this._repository.getLogger(name);</span>
<a href="#l12.432"></a><span id="l12.432" class="difflineminus">-  }</span>
<a href="#l12.433"></a><span id="l12.433" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/db/gloda/modules/noun_freetag.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/noun_freetag.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -56,17 +56,17 @@ FreeTag.prototype = {</span>
<a href="#l13.4"></a><span id="l13.4">   }</span>
<a href="#l13.5"></a><span id="l13.5"> };</span>
<a href="#l13.6"></a><span id="l13.6"> </span>
<a href="#l13.7"></a><span id="l13.7"> /**</span>
<a href="#l13.8"></a><span id="l13.8">  * @namespace Tag noun provider.  Since the tag unique value is stored as a</span>
<a href="#l13.9"></a><span id="l13.9">  *  parameter, we are an odd case and semantically confused.</span>
<a href="#l13.10"></a><span id="l13.10">  */</span>
<a href="#l13.11"></a><span id="l13.11"> var FreeTagNoun = {</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-  _log: Log4Moz.Service.getLogger(&quot;gloda.noun.freetag&quot;),</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+  _log: Log4Moz.repository.getLogger(&quot;gloda.noun.freetag&quot;),</span>
<a href="#l13.14"></a><span id="l13.14"> </span>
<a href="#l13.15"></a><span id="l13.15">   name: &quot;freetag&quot;,</span>
<a href="#l13.16"></a><span id="l13.16">   class: FreeTag,</span>
<a href="#l13.17"></a><span id="l13.17">   allowsArbitraryAttrs: false,</span>
<a href="#l13.18"></a><span id="l13.18">   usesParameter: true,</span>
<a href="#l13.19"></a><span id="l13.19">   </span>
<a href="#l13.20"></a><span id="l13.20">   _listeners: [],</span>
<a href="#l13.21"></a><span id="l13.21">   addListener: function(aListener) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/db/gloda/modules/noun_mimetype.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/noun_mimetype.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -39,17 +39,17 @@ EXPORTED_SYMBOLS = ['MimeType', 'MimeTyp</span>
<a href="#l14.4"></a><span id="l14.4"> </span>
<a href="#l14.5"></a><span id="l14.5"> const Cc = Components.classes;</span>
<a href="#l14.6"></a><span id="l14.6"> const Ci = Components.interfaces;</span>
<a href="#l14.7"></a><span id="l14.7"> const Cr = Components.results;</span>
<a href="#l14.8"></a><span id="l14.8"> const Cu = Components.utils;</span>
<a href="#l14.9"></a><span id="l14.9"> </span>
<a href="#l14.10"></a><span id="l14.10"> Cu.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-const LOG = Log4Moz.Service.getLogger(&quot;gloda.noun.mimetype&quot;);</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+const LOG = Log4Moz.repository.getLogger(&quot;gloda.noun.mimetype&quot;);</span>
<a href="#l14.14"></a><span id="l14.14"> </span>
<a href="#l14.15"></a><span id="l14.15"> Cu.import(&quot;resource://app/modules/gloda/gloda.js&quot;);</span>
<a href="#l14.16"></a><span id="l14.16"> </span>
<a href="#l14.17"></a><span id="l14.17"> function MimeType(aID, aType, aSubType, aFullType) {</span>
<a href="#l14.18"></a><span id="l14.18">   this._id = aID;</span>
<a href="#l14.19"></a><span id="l14.19">   this._type = aType;</span>
<a href="#l14.20"></a><span id="l14.20">   this._subType = aSubType;</span>
<a href="#l14.21"></a><span id="l14.21">   this._fullType = aFullType;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/db/gloda/test/resources/glodaTestHelper.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/db/gloda/test/resources/glodaTestHelper.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -52,17 +52,17 @@ gPrefs.setBoolPref(&quot;mailnews.database.gl</span>
<a href="#l15.4"></a><span id="l15.4"> // -- Import our modules</span>
<a href="#l15.5"></a><span id="l15.5"> Components.utils.import(&quot;resource://app/modules/gloda/public.js&quot;);</span>
<a href="#l15.6"></a><span id="l15.6"> Components.utils.import(&quot;resource://app/modules/gloda/indexer.js&quot;);</span>
<a href="#l15.7"></a><span id="l15.7"> </span>
<a href="#l15.8"></a><span id="l15.8"> // -- Add a logger listener that throws when we give it a warning/error.</span>
<a href="#l15.9"></a><span id="l15.9"> Components.utils.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l15.10"></a><span id="l15.10"> let throwingAppender = new Log4Moz.ThrowingAppender(do_throw);</span>
<a href="#l15.11"></a><span id="l15.11"> throwingAppender.level = Log4Moz.Level.Warn;</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-Log4Moz.Service.rootLogger.addAppender(throwingAppender);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+Log4Moz.repository.rootLogger.addAppender(throwingAppender);</span>
<a href="#l15.14"></a><span id="l15.14"> </span>
<a href="#l15.15"></a><span id="l15.15"> /**</span>
<a href="#l15.16"></a><span id="l15.16">  * davida's patented dump function for what ails you. </span>
<a href="#l15.17"></a><span id="l15.17">  */</span>
<a href="#l15.18"></a><span id="l15.18"> function ddumpObject(obj, name, maxDepth, curDepth)</span>
<a href="#l15.19"></a><span id="l15.19"> {</span>
<a href="#l15.20"></a><span id="l15.20">   if (curDepth == undefined)</span>
<a href="#l15.21"></a><span id="l15.21">     curDepth = 0;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

