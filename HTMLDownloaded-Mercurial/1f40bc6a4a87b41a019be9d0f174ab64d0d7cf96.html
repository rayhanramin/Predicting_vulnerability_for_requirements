<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 17811:1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96" />
<meta property="og:url" content="/comm-central/rev/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96" />
<meta property="og:description" content="Bug 1151475 - Part 2: Remove use of expression closure from mail/components/im/. r=florian" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96">shortlog</a> |
<a href="/comm-central/log/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96">files</a> |
changeset |
<a href="/comm-central/raw-rev/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96">raw</a>  | <a href="/comm-central/archive/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1151475">Bug 1151475</a> - Part 2: Remove use of expression closure from mail/components/im/. r=florian
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#84;&#111;&#111;&#114;&#117;&#32;&#70;&#117;&#106;&#105;&#115;&#97;&#119;&#97;&#32;&#60;&#97;&#114;&#97;&#105;&#95;&#97;&#64;&#109;&#97;&#99;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Mon, 20 Apr 2015 00:16:24 +0900</td></tr>

<tr>
 <td>changeset 17811</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96">1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96</a></td>
</tr>



<tr>
<td>parent 17810</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/07a6ec81889a816f9d850c6f68567cbe074228e5">07a6ec81889a816f9d850c6f68567cbe074228e5</a>
</td>
</tr>

<tr>
<td>child 17812</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/6f8790980905dd0932ba3ce31a13631d7917a137">6f8790980905dd0932ba3ce31a13631d7917a137</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96">10953</a></td></tr>
<tr><td>push user</td><td>arai_a@mac.com</td></tr>
<tr><td>push date</td><td class="date age">Sun, 19 Apr 2015 15:17:20 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@1f40bc6a4a87 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96&newProject=comm-central&newRevision=05a8c7d3c908f687275458ed8b8a443ea954054d&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96&newProject=comm-central&newRevision=05a8c7d3c908f687275458ed8b8a443ea954054d&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96&newProject=comm-central&newRevision=05a8c7d3c908f687275458ed8b8a443ea954054d&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28florian%29&revcount=50">florian</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1151475">1151475</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1151475">Bug 1151475</a> - Part 2: Remove use of expression closure from mail/components/im/. r=florian</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/addbuddy.js">mail/components/im/content/addbuddy.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/addbuddy.js">file</a> |
<a href="/comm-central/annotate/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/addbuddy.js">annotate</a> |
<a href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/addbuddy.js">diff</a> |
<a href="/comm-central/comparison/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/addbuddy.js">comparison</a> |
<a href="/comm-central/log/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/addbuddy.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/chat-messenger-overlay.js">mail/components/im/content/chat-messenger-overlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/chat-messenger-overlay.js">file</a> |
<a href="/comm-central/annotate/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/chat-messenger-overlay.js">annotate</a> |
<a href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/chat-messenger-overlay.js">diff</a> |
<a href="/comm-central/comparison/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/chat-messenger-overlay.js">comparison</a> |
<a href="/comm-central/log/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/chat-messenger-overlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imAccountWizard.js">mail/components/im/content/imAccountWizard.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imAccountWizard.js">file</a> |
<a href="/comm-central/annotate/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imAccountWizard.js">annotate</a> |
<a href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imAccountWizard.js">diff</a> |
<a href="/comm-central/comparison/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imAccountWizard.js">comparison</a> |
<a href="/comm-central/log/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imAccountWizard.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imconversation.xml">mail/components/im/content/imconversation.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imconversation.xml">file</a> |
<a href="/comm-central/annotate/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imconversation.xml">annotate</a> |
<a href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imconversation.xml">diff</a> |
<a href="/comm-central/comparison/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imconversation.xml">comparison</a> |
<a href="/comm-central/log/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imconversation.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imgroup.xml">mail/components/im/content/imgroup.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imgroup.xml">file</a> |
<a href="/comm-central/annotate/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imgroup.xml">annotate</a> |
<a href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imgroup.xml">diff</a> |
<a href="/comm-central/comparison/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imgroup.xml">comparison</a> |
<a href="/comm-central/log/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/content/imgroup.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imIncomingServer.js">mail/components/im/imIncomingServer.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imIncomingServer.js">file</a> |
<a href="/comm-central/annotate/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imIncomingServer.js">annotate</a> |
<a href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imIncomingServer.js">diff</a> |
<a href="/comm-central/comparison/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imIncomingServer.js">comparison</a> |
<a href="/comm-central/log/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imIncomingServer.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imProtocolInfo.js">mail/components/im/imProtocolInfo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imProtocolInfo.js">file</a> |
<a href="/comm-central/annotate/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imProtocolInfo.js">annotate</a> |
<a href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imProtocolInfo.js">diff</a> |
<a href="/comm-central/comparison/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imProtocolInfo.js">comparison</a> |
<a href="/comm-central/log/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/imProtocolInfo.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/messages/Footer.html">mail/components/im/messages/Footer.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/messages/Footer.html">file</a> |
<a href="/comm-central/annotate/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/messages/Footer.html">annotate</a> |
<a href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/messages/Footer.html">diff</a> |
<a href="/comm-central/comparison/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/messages/Footer.html">comparison</a> |
<a href="/comm-central/log/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/messages/Footer.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/modules/index_im.js">mail/components/im/modules/index_im.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/modules/index_im.js">file</a> |
<a href="/comm-central/annotate/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/modules/index_im.js">annotate</a> |
<a href="/comm-central/diff/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/modules/index_im.js">diff</a> |
<a href="/comm-central/comparison/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/modules/index_im.js">comparison</a> |
<a href="/comm-central/log/1f40bc6a4a87b41a019be9d0f174ab64d0d7cf96/mail/components/im/modules/index_im.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/components/im/content/addbuddy.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/components/im/content/addbuddy.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -23,16 +23,16 @@ var addBuddy = {</span>
<a href="#l1.4"></a><span id="l1.4">     accountList.selectedIndex = 0;</span>
<a href="#l1.5"></a><span id="l1.5">   },</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7">   oninput: function ab_oninput() {</span>
<a href="#l1.8"></a><span id="l1.8">     document.documentElement.getButton(&quot;accept&quot;).disabled =</span>
<a href="#l1.9"></a><span id="l1.9">       !addBuddy.getValue(&quot;name&quot;);</span>
<a href="#l1.10"></a><span id="l1.10">   },</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-  getValue: function ab_getValue(aId) document.getElementById(aId).value,</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+  getValue: function ab_getValue(aId) { return document.getElementById(aId).value; },</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15">   create: function ab_create() {</span>
<a href="#l1.16"></a><span id="l1.16">     let account = Services.accounts.getAccountById(this.getValue(&quot;accountlist&quot;));</span>
<a href="#l1.17"></a><span id="l1.17">     let group = document.getElementById(&quot;chatBundle&quot;).getString(&quot;defaultGroup&quot;);</span>
<a href="#l1.18"></a><span id="l1.18">     account.addBuddy(Services.tags.createTag(group), this.getValue(&quot;name&quot;));</span>
<a href="#l1.19"></a><span id="l1.19">   }</span>
<a href="#l1.20"></a><span id="l1.20"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/components/im/content/chat-messenger-overlay.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/components/im/content/chat-messenger-overlay.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -134,17 +134,17 @@ var chatTabType = {</span>
<a href="#l2.4"></a><span id="l2.4">     let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l2.5"></a><span id="l2.5">     if (tabmail.currentTabInfo.mode.name == &quot;chat&quot;)</span>
<a href="#l2.6"></a><span id="l2.6">       chatHandler._onTabDeactivated();</span>
<a href="#l2.7"></a><span id="l2.7">   },</span>
<a href="#l2.8"></a><span id="l2.8">   openTab: function(aTab, aArgs) {</span>
<a href="#l2.9"></a><span id="l2.9">     if (!this.hasBeenOpened) {</span>
<a href="#l2.10"></a><span id="l2.10">       let convs = imServices.conversations.getUIConversations();</span>
<a href="#l2.11"></a><span id="l2.11">       if (convs.length != 0) {</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        convs.sort(function(a, b)</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        convs.sort((a, b) =&gt;</span>
<a href="#l2.14"></a><span id="l2.14">                    a.title.toLowerCase().localeCompare(b.title.toLowerCase()));</span>
<a href="#l2.15"></a><span id="l2.15">         for each (let conv in convs)</span>
<a href="#l2.16"></a><span id="l2.16">           chatHandler._addConversation(conv);</span>
<a href="#l2.17"></a><span id="l2.17">       }</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19">       // The tab monitor will inform us when a different tab is selected.</span>
<a href="#l2.20"></a><span id="l2.20">       let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l2.21"></a><span id="l2.21">       tabmail.registerTabMonitor(this.tabMonitor);</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -285,17 +285,17 @@ var chatHandler = {</span>
<a href="#l2.23"></a><span id="l2.23">     let groupName = (contact.online ? &quot;on&quot; : &quot;off&quot;) + &quot;linecontactsGroup&quot;;</span>
<a href="#l2.24"></a><span id="l2.24">     let item = document.getElementById(groupName).removeContact(contact);</span>
<a href="#l2.25"></a><span id="l2.25">     if (list.selectedItem == item)</span>
<a href="#l2.26"></a><span id="l2.26">       list.selectedItem = elt;</span>
<a href="#l2.27"></a><span id="l2.27">   },</span>
<a href="#l2.28"></a><span id="l2.28"> </span>
<a href="#l2.29"></a><span id="l2.29">   _hasConversationForContact: function(aContact) {</span>
<a href="#l2.30"></a><span id="l2.30">     let convs = document.getElementById(&quot;conversationsGroup&quot;).contacts;</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-    return convs.some(function(aConversation)</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+    return convs.some(aConversation =&gt;</span>
<a href="#l2.33"></a><span id="l2.33">       aConversation.hasOwnProperty(&quot;imContact&quot;) &amp;&amp;</span>
<a href="#l2.34"></a><span id="l2.34">       aConversation.imContact.id == aContact.id);</span>
<a href="#l2.35"></a><span id="l2.35">   },</span>
<a href="#l2.36"></a><span id="l2.36"> </span>
<a href="#l2.37"></a><span id="l2.37">   _chatButtonUpdatePending: false,</span>
<a href="#l2.38"></a><span id="l2.38">   updateChatButtonState: function() {</span>
<a href="#l2.39"></a><span id="l2.39">     if (this._chatButtonUpdatePending)</span>
<a href="#l2.40"></a><span id="l2.40">       return;</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineat">@@ -508,17 +508,17 @@ var chatHandler = {</span>
<a href="#l2.42"></a><span id="l2.42">     observe: function(aSubject, aTopic, aData) {</span>
<a href="#l2.43"></a><span id="l2.43">       if (aTopic == &quot;contact-status-changed&quot; ||</span>
<a href="#l2.44"></a><span id="l2.44">           aTopic == &quot;contact-display-name-changed&quot; ||</span>
<a href="#l2.45"></a><span id="l2.45">           aTopic == &quot;contact-icon-changed&quot;)</span>
<a href="#l2.46"></a><span id="l2.46">         chatHandler.showContactInfo(aSubject);</span>
<a href="#l2.47"></a><span id="l2.47">     }</span>
<a href="#l2.48"></a><span id="l2.48">   },</span>
<a href="#l2.49"></a><span id="l2.49">   _observedContact: null,</span>
<a href="#l2.50"></a><span id="l2.50" class="difflineminus">-  get observedContact() this._observedContact,</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineplus">+  get observedContact() { return this._observedContact; },</span>
<a href="#l2.52"></a><span id="l2.52">   set observedContact(aContact) {</span>
<a href="#l2.53"></a><span id="l2.53">     if (aContact == this._observedContact)</span>
<a href="#l2.54"></a><span id="l2.54">       return aContact;</span>
<a href="#l2.55"></a><span id="l2.55">     if (this._observedContact) {</span>
<a href="#l2.56"></a><span id="l2.56">       this._observedContact.removeObserver(this._contactObserver);</span>
<a href="#l2.57"></a><span id="l2.57">       delete this._observedContact;</span>
<a href="#l2.58"></a><span id="l2.58">     }</span>
<a href="#l2.59"></a><span id="l2.59">     this._observedContact = aContact;</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineat">@@ -801,17 +801,17 @@ var chatHandler = {</span>
<a href="#l2.61"></a><span id="l2.61">     for each (let id in [&quot;button-join-chat&quot;, &quot;joinChatMenuItem&quot;,</span>
<a href="#l2.62"></a><span id="l2.62">                          &quot;appmenu_joinChatMenuItem&quot;]) {</span>
<a href="#l2.63"></a><span id="l2.63">       let elt = document.getElementById(id);</span>
<a href="#l2.64"></a><span id="l2.64">       if (elt)</span>
<a href="#l2.65"></a><span id="l2.65">         elt.disabled = !canJoinChat;</span>
<a href="#l2.66"></a><span id="l2.66">     }</span>
<a href="#l2.67"></a><span id="l2.67">     let groupIds = [&quot;conversations&quot;, &quot;onlinecontacts&quot;, &quot;offlinecontacts&quot;];</span>
<a href="#l2.68"></a><span id="l2.68">     let contactlist = document.getElementById(&quot;contactlistbox&quot;);</span>
<a href="#l2.69"></a><span id="l2.69" class="difflineminus">-    if (!hasAccount || !connected &amp;&amp; groupIds.every(function(id)</span>
<a href="#l2.70"></a><span id="l2.70" class="difflineplus">+    if (!hasAccount || !connected &amp;&amp; groupIds.every(id =&gt;</span>
<a href="#l2.71"></a><span id="l2.71">         document.getElementById(id + &quot;Group&quot;).contacts.length)) {</span>
<a href="#l2.72"></a><span id="l2.72">       contactlist.disabled = true;</span>
<a href="#l2.73"></a><span id="l2.73">     }</span>
<a href="#l2.74"></a><span id="l2.74">     else {</span>
<a href="#l2.75"></a><span id="l2.75">       contactlist.disabled = false;</span>
<a href="#l2.76"></a><span id="l2.76">       this._updateSelectedConversation();</span>
<a href="#l2.77"></a><span id="l2.77">     }</span>
<a href="#l2.78"></a><span id="l2.78">   },</span>
<a href="#l2.79"></a><span id="l2.79" class="difflineat">@@ -1106,17 +1106,17 @@ var chatHandler = {</span>
<a href="#l2.80"></a><span id="l2.80">       let item = listbox.selectedItem;</span>
<a href="#l2.81"></a><span id="l2.81">       if (item.localName == &quot;imconv&quot; &amp;&amp; item.convView)</span>
<a href="#l2.82"></a><span id="l2.82">         item.convView.focus();</span>
<a href="#l2.83"></a><span id="l2.83">       else</span>
<a href="#l2.84"></a><span id="l2.84">         listbox.focus();</span>
<a href="#l2.85"></a><span id="l2.85">     });</span>
<a href="#l2.86"></a><span id="l2.86">     window.addEventListener(&quot;resize&quot;, this.onConvResize.bind(this));</span>
<a href="#l2.87"></a><span id="l2.87">     document.getElementById(&quot;conversationsGroup&quot;).sortComparator =</span>
<a href="#l2.88"></a><span id="l2.88" class="difflineminus">-      function(a, b) a.title.toLowerCase().localeCompare(b.title.toLowerCase());</span>
<a href="#l2.89"></a><span id="l2.89" class="difflineplus">+      (a, b) =&gt; a.title.toLowerCase().localeCompare(b.title.toLowerCase());</span>
<a href="#l2.90"></a><span id="l2.90"> </span>
<a href="#l2.91"></a><span id="l2.91">     Components.utils.import(&quot;resource:///modules/chatHandler.jsm&quot;, this);</span>
<a href="#l2.92"></a><span id="l2.92">     if (this.ChatCore.initialized)</span>
<a href="#l2.93"></a><span id="l2.93">       this.initAfterChatCore();</span>
<a href="#l2.94"></a><span id="l2.94">     else {</span>
<a href="#l2.95"></a><span id="l2.95">       this.ChatCore.init();</span>
<a href="#l2.96"></a><span id="l2.96">       this._addObserver(&quot;chat-core-initialized&quot;);</span>
<a href="#l2.97"></a><span id="l2.97">     }</span>
<a href="#l2.98"></a><span id="l2.98" class="difflineat">@@ -1126,37 +1126,37 @@ var chatHandler = {</span>
<a href="#l2.99"></a><span id="l2.99"> function chatLogTreeGroupItem(aTitle, aLogItems) {</span>
<a href="#l2.100"></a><span id="l2.100">   this._title = aTitle;</span>
<a href="#l2.101"></a><span id="l2.101">   this._children = aLogItems;</span>
<a href="#l2.102"></a><span id="l2.102">   for each (let child in this._children)</span>
<a href="#l2.103"></a><span id="l2.103">     child._parent = this;</span>
<a href="#l2.104"></a><span id="l2.104">   this._open = false;</span>
<a href="#l2.105"></a><span id="l2.105"> }</span>
<a href="#l2.106"></a><span id="l2.106"> chatLogTreeGroupItem.prototype = {</span>
<a href="#l2.107"></a><span id="l2.107" class="difflineminus">-  getText: function() this._title,</span>
<a href="#l2.108"></a><span id="l2.108" class="difflineminus">-  get id() this._title,</span>
<a href="#l2.109"></a><span id="l2.109" class="difflineminus">-  get open() this._open,</span>
<a href="#l2.110"></a><span id="l2.110" class="difflineminus">-  get level() 0,</span>
<a href="#l2.111"></a><span id="l2.111" class="difflineminus">-  get _parent() null,</span>
<a href="#l2.112"></a><span id="l2.112" class="difflineminus">-  get children() this._children,</span>
<a href="#l2.113"></a><span id="l2.113" class="difflineminus">-  getProperties: function() &quot;&quot;</span>
<a href="#l2.114"></a><span id="l2.114" class="difflineplus">+  getText: function() { return this._title; },</span>
<a href="#l2.115"></a><span id="l2.115" class="difflineplus">+  get id() { return this._title; },</span>
<a href="#l2.116"></a><span id="l2.116" class="difflineplus">+  get open() { return this._open; },</span>
<a href="#l2.117"></a><span id="l2.117" class="difflineplus">+  get level() { return 0; },</span>
<a href="#l2.118"></a><span id="l2.118" class="difflineplus">+  get _parent() { return null; },</span>
<a href="#l2.119"></a><span id="l2.119" class="difflineplus">+  get children() { return this._children; },</span>
<a href="#l2.120"></a><span id="l2.120" class="difflineplus">+  getProperties: function() { return &quot;&quot;; }</span>
<a href="#l2.121"></a><span id="l2.121"> };</span>
<a href="#l2.122"></a><span id="l2.122"> </span>
<a href="#l2.123"></a><span id="l2.123"> function chatLogTreeLogItem(aLog, aText, aLevel) {</span>
<a href="#l2.124"></a><span id="l2.124">   this.log = aLog;</span>
<a href="#l2.125"></a><span id="l2.125">   this._text = aText;</span>
<a href="#l2.126"></a><span id="l2.126">   this._level = aLevel;</span>
<a href="#l2.127"></a><span id="l2.127"> }</span>
<a href="#l2.128"></a><span id="l2.128"> chatLogTreeLogItem.prototype = {</span>
<a href="#l2.129"></a><span id="l2.129" class="difflineminus">-  getText: function() this._text,</span>
<a href="#l2.130"></a><span id="l2.130" class="difflineminus">-  get id() this.log.title,</span>
<a href="#l2.131"></a><span id="l2.131" class="difflineminus">-  get open() false,</span>
<a href="#l2.132"></a><span id="l2.132" class="difflineminus">-  get level() this._level,</span>
<a href="#l2.133"></a><span id="l2.133" class="difflineminus">-  get children() [],</span>
<a href="#l2.134"></a><span id="l2.134" class="difflineminus">-  getProperties: function() &quot;&quot;</span>
<a href="#l2.135"></a><span id="l2.135" class="difflineplus">+  getText: function() { return this._text; },</span>
<a href="#l2.136"></a><span id="l2.136" class="difflineplus">+  get id() { return this.log.title; },</span>
<a href="#l2.137"></a><span id="l2.137" class="difflineplus">+  get open() { return false; },</span>
<a href="#l2.138"></a><span id="l2.138" class="difflineplus">+  get level() { return this._level; },</span>
<a href="#l2.139"></a><span id="l2.139" class="difflineplus">+  get children() { return []; },</span>
<a href="#l2.140"></a><span id="l2.140" class="difflineplus">+  getProperties: function() { return &quot;&quot;; }</span>
<a href="#l2.141"></a><span id="l2.141"> };</span>
<a href="#l2.142"></a><span id="l2.142"> </span>
<a href="#l2.143"></a><span id="l2.143"> function chatLogTreeView(aTree, aLogs) {</span>
<a href="#l2.144"></a><span id="l2.144">   this._tree = aTree;</span>
<a href="#l2.145"></a><span id="l2.145">   this._logs = aLogs;</span>
<a href="#l2.146"></a><span id="l2.146">   this._tree.view = this;</span>
<a href="#l2.147"></a><span id="l2.147">   this._rebuild();</span>
<a href="#l2.148"></a><span id="l2.148"> }</span>
<a href="#l2.149"></a><span id="l2.149" class="difflineat">@@ -1189,19 +1189,19 @@ chatLogTreeView.prototype = {</span>
<a href="#l2.150"></a><span id="l2.150">                                 aDate.getMonth() + 1, aDate.getDate(),</span>
<a href="#l2.151"></a><span id="l2.151">                                 aDate.getHours(), aDate.getMinutes(), 0);</span>
<a href="#l2.152"></a><span id="l2.152">     };</span>
<a href="#l2.153"></a><span id="l2.153">     let formatMonthYear = function(aDate) {</span>
<a href="#l2.154"></a><span id="l2.154">       let month = formatMonth(aDate);</span>
<a href="#l2.155"></a><span id="l2.155">       return placesBundle.getFormattedString(&quot;finduri-MonthYear&quot;,</span>
<a href="#l2.156"></a><span id="l2.156">                                              [month, aDate.getFullYear()]);</span>
<a href="#l2.157"></a><span id="l2.157">     };</span>
<a href="#l2.158"></a><span id="l2.158" class="difflineminus">-    let formatMonth = function(aDate)</span>
<a href="#l2.159"></a><span id="l2.159" class="difflineplus">+    let formatMonth = aDate =&gt;</span>
<a href="#l2.160"></a><span id="l2.160">       dateFormatBundle.getString(&quot;month.&quot; + (aDate.getMonth() + 1) + &quot;.name&quot;);</span>
<a href="#l2.161"></a><span id="l2.161" class="difflineminus">-    let formatWeekday = function(aDate)</span>
<a href="#l2.162"></a><span id="l2.162" class="difflineplus">+    let formatWeekday = aDate =&gt;</span>
<a href="#l2.163"></a><span id="l2.163">       dateFormatBundle.getString(&quot;day.&quot; + (aDate.getDay() + 1) + &quot;.name&quot;);</span>
<a href="#l2.164"></a><span id="l2.164"> </span>
<a href="#l2.165"></a><span id="l2.165">     let nowDate = new Date();</span>
<a href="#l2.166"></a><span id="l2.166">     let todayDate = new Date(nowDate.getFullYear(), nowDate.getMonth(),</span>
<a href="#l2.167"></a><span id="l2.167">                              nowDate.getDate());</span>
<a href="#l2.168"></a><span id="l2.168"> </span>
<a href="#l2.169"></a><span id="l2.169">     // The keys used in the 'firstgroups' object should match string ids.</span>
<a href="#l2.170"></a><span id="l2.170">     // The order is the reverse of that in which they will appear</span>
<a href="#l2.171"></a><span id="l2.171" class="difflineat">@@ -1290,17 +1290,17 @@ chatLogTreeView.prototype = {</span>
<a href="#l2.172"></a><span id="l2.172"> </span>
<a href="#l2.173"></a><span id="l2.173">     // Build tree.</span>
<a href="#l2.174"></a><span id="l2.174">     if (today)</span>
<a href="#l2.175"></a><span id="l2.175">       this._rowMap.push(today);</span>
<a href="#l2.176"></a><span id="l2.176">     if (yesterday)</span>
<a href="#l2.177"></a><span id="l2.177">       this._rowMap.push(yesterday);</span>
<a href="#l2.178"></a><span id="l2.178">     groupIDs.forEach(function (aGroupID) {</span>
<a href="#l2.179"></a><span id="l2.179">       let group = groups[aGroupID];</span>
<a href="#l2.180"></a><span id="l2.180" class="difflineminus">-      group.entries.sort(function(l1, l2) l2.log.time - l1.log.time);</span>
<a href="#l2.181"></a><span id="l2.181" class="difflineplus">+      group.entries.sort((l1, l2) =&gt; l2.log.time - l1.log.time);</span>
<a href="#l2.182"></a><span id="l2.182">       this._rowMap.push(new chatLogTreeGroupItem(group.name, group.entries));</span>
<a href="#l2.183"></a><span id="l2.183">     }, this);</span>
<a href="#l2.184"></a><span id="l2.184"> </span>
<a href="#l2.185"></a><span id="l2.185">     // Finally, notify the tree.</span>
<a href="#l2.186"></a><span id="l2.186">     if (this._tree)</span>
<a href="#l2.187"></a><span id="l2.187">       this._tree.rowCountChanged(0, this._rowMap.length);</span>
<a href="#l2.188"></a><span id="l2.188">   }</span>
<a href="#l2.189"></a><span id="l2.189"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/components/im/content/imAccountWizard.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/components/im/content/imAccountWizard.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -14,17 +14,17 @@ var accountWizard = {</span>
<a href="#l3.4"></a><span id="l3.4">     Services.core.init();</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6">     accountWizard.setGetMoreProtocols();</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8">     var protoList = document.getElementById(&quot;protolist&quot;);</span>
<a href="#l3.9"></a><span id="l3.9">     var protos = [];</span>
<a href="#l3.10"></a><span id="l3.10">     for (let proto in this.getProtocols())</span>
<a href="#l3.11"></a><span id="l3.11">       protos.push(proto);</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    protos.sort(function(a, b) a.name &lt; b.name ? -1 : a.name &gt; b.name ? 1 : 0);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+    protos.sort((a, b) =&gt; a.name &lt; b.name ? -1 : a.name &gt; b.name ? 1 : 0);</span>
<a href="#l3.14"></a><span id="l3.14">     protos.forEach(function(proto) {</span>
<a href="#l3.15"></a><span id="l3.15">       var id = proto.id;</span>
<a href="#l3.16"></a><span id="l3.16">       var item = protoList.appendItem(proto.name, id, id);</span>
<a href="#l3.17"></a><span id="l3.17">       item.setAttribute(&quot;image&quot;, proto.iconBaseURI + &quot;icon.png&quot;);</span>
<a href="#l3.18"></a><span id="l3.18">       item.setAttribute(&quot;class&quot;, &quot;listitem-iconic&quot;);</span>
<a href="#l3.19"></a><span id="l3.19">     });</span>
<a href="#l3.20"></a><span id="l3.20"> </span>
<a href="#l3.21"></a><span id="l3.21">     // there is a strange selection bug without this timeout</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -47,17 +47,17 @@ var accountWizard = {</span>
<a href="#l3.23"></a><span id="l3.23">   },</span>
<a href="#l3.24"></a><span id="l3.24"> </span>
<a href="#l3.25"></a><span id="l3.25">   getUsername: function aw_getUsername() {</span>
<a href="#l3.26"></a><span id="l3.26">     // If the first username textbox is empty, make sure we return an empty</span>
<a href="#l3.27"></a><span id="l3.27">     // string so that it blocks the 'next' button of the wizard.</span>
<a href="#l3.28"></a><span id="l3.28">     if (!this.userNameBoxes[0].value)</span>
<a href="#l3.29"></a><span id="l3.29">       return &quot;&quot;;</span>
<a href="#l3.30"></a><span id="l3.30"> </span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-    return this.userNameBoxes.reduce(function(prev, elt) prev + elt.value, &quot;&quot;);</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+    return this.userNameBoxes.reduce((prev, elt) =&gt; prev + elt.value, &quot;&quot;);</span>
<a href="#l3.33"></a><span id="l3.33">   },</span>
<a href="#l3.34"></a><span id="l3.34"> </span>
<a href="#l3.35"></a><span id="l3.35">   checkUsername: function aw_checkUsername() {</span>
<a href="#l3.36"></a><span id="l3.36">     var wizard = document.getElementById(&quot;accountWizard&quot;);</span>
<a href="#l3.37"></a><span id="l3.37">     var name = accountWizard.getUsername();</span>
<a href="#l3.38"></a><span id="l3.38">     var duplicateWarning = document.getElementById(&quot;duplicateAccount&quot;);</span>
<a href="#l3.39"></a><span id="l3.39">     if (!name) {</span>
<a href="#l3.40"></a><span id="l3.40">       wizard.canAdvance = false;</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineat">@@ -423,22 +423,25 @@ var accountWizard = {</span>
<a href="#l3.42"></a><span id="l3.42">     // has a special handling of the undefined value for this case.</span>
<a href="#l3.43"></a><span id="l3.43">     return undefined;</span>
<a href="#l3.44"></a><span id="l3.44">   },</span>
<a href="#l3.45"></a><span id="l3.45"> </span>
<a href="#l3.46"></a><span id="l3.46">   getIter: function(aEnumerator) {</span>
<a href="#l3.47"></a><span id="l3.47">     while (aEnumerator.hasMoreElements())</span>
<a href="#l3.48"></a><span id="l3.48">       yield aEnumerator.getNext();</span>
<a href="#l3.49"></a><span id="l3.49">   },</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineminus">-  getProtocols: function aw_getProtocols()</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineminus">-    this.getIter(Services.core.getProtocols()),</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineminus">-  getProtoOptions: function aw_getProtoOptions()</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineminus">-    this.getIter(this.proto.getOptions()),</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineminus">-  getProtoUserSplits: function aw_getProtoUserSplits()</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineminus">-    this.getIter(this.proto.getUsernameSplit()),</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineplus">+  getProtocols: function aw_getProtocols() {</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineplus">+    return this.getIter(Services.core.getProtocols());</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineplus">+  },</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineplus">+  getProtoOptions: function aw_getProtoOptions() {</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineplus">+    return this.getIter(this.proto.getOptions());</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineplus">+  },</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineplus">+  getProtoUserSplits: function aw_getProtoUserSplits() {</span>
<a href="#l3.63"></a><span id="l3.63" class="difflineplus">+    return this.getIter(this.proto.getUsernameSplit());</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineplus">+  },</span>
<a href="#l3.65"></a><span id="l3.65"> </span>
<a href="#l3.66"></a><span id="l3.66">   onGroupboxKeypress: function aw_onGroupboxKeypress(aEvent) {</span>
<a href="#l3.67"></a><span id="l3.67">     var target = aEvent.target;</span>
<a href="#l3.68"></a><span id="l3.68">     var code = aEvent.charCode || aEvent.keyCode;</span>
<a href="#l3.69"></a><span id="l3.69">     if (code == KeyEvent.DOM_VK_SPACE ||</span>
<a href="#l3.70"></a><span id="l3.70">         (code == KeyEvent.DOM_VK_LEFT &amp;&amp; !target.hasAttribute(&quot;closed&quot;)) ||</span>
<a href="#l3.71"></a><span id="l3.71">         (code == KeyEvent.DOM_VK_RIGHT &amp;&amp; target.hasAttribute(&quot;closed&quot;)))</span>
<a href="#l3.72"></a><span id="l3.72">         this.toggleGroupbox(target.id);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/components/im/content/imconversation.xml</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/components/im/content/imconversation.xml</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -487,25 +487,25 @@</span>
<a href="#l4.4"></a><span id="l4.4">             //   &quot;nick1: &quot; -&gt; &quot;nick1&quot;</span>
<a href="#l4.5"></a><span id="l4.5">             let pos = inputBox.selectionStart;</span>
<a href="#l4.6"></a><span id="l4.6">             const suffix = &quot;: &quot;;</span>
<a href="#l4.7"></a><span id="l4.7">             if (pos &gt; suffix.length &amp;&amp;</span>
<a href="#l4.8"></a><span id="l4.8">                 text.substring(pos - suffix.length, pos) == suffix) {</span>
<a href="#l4.9"></a><span id="l4.9">               let completions = [b for (b of this.buddies.keys())];</span>
<a href="#l4.10"></a><span id="l4.10">               // Check if the preceding words are a sequence of nick completions.</span>
<a href="#l4.11"></a><span id="l4.11">               let preceding = text.substring(0, pos - suffix.length).split(&quot;, &quot;);</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-              if (preceding.every(function(n) completions.indexOf(n) != -1)) {</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+              if (preceding.every(n =&gt; completions.indexOf(n) != -1)) {</span>
<a href="#l4.14"></a><span id="l4.14">                 let s = preceding.pop();</span>
<a href="#l4.15"></a><span id="l4.15">                 if (preceding.length)</span>
<a href="#l4.16"></a><span id="l4.16">                   s = suffix + s;</span>
<a href="#l4.17"></a><span id="l4.17">                 inputBox.selectionStart -= s.length + suffix.length;</span>
<a href="#l4.18"></a><span id="l4.18">                 this.addString(s);</span>
<a href="#l4.19"></a><span id="l4.19">                 if (this._completions[0].slice(-suffix.length) == suffix) {</span>
<a href="#l4.20"></a><span id="l4.20">                   this._completions =</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineminus">-                    this._completions.map(function(c) c.slice(0, -suffix.length));</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+                    this._completions.map(c =&gt; c.slice(0, -suffix.length));</span>
<a href="#l4.23"></a><span id="l4.23">                 }</span>
<a href="#l4.24"></a><span id="l4.24">                 if (this._completions.length == 1 &amp;&amp;</span>
<a href="#l4.25"></a><span id="l4.25">                     inputBox.value == this._beforeTabComplete) {</span>
<a href="#l4.26"></a><span id="l4.26">                   // Nothing left to undo or to cycle through.</span>
<a href="#l4.27"></a><span id="l4.27">                   delete this._completions;</span>
<a href="#l4.28"></a><span id="l4.28">                 }</span>
<a href="#l4.29"></a><span id="l4.29">                 return;</span>
<a href="#l4.30"></a><span id="l4.30">               }</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineat">@@ -590,29 +590,29 @@</span>
<a href="#l4.32"></a><span id="l4.32">                    this.partedBuddies[partedNicks[j]].partTime &gt; cutoffTime)</span>
<a href="#l4.33"></a><span id="l4.33">               --j;</span>
<a href="#l4.34"></a><span id="l4.34">             ++j; // Index of the first nick we want to keep.</span>
<a href="#l4.35"></a><span id="l4.35">             if (partedNicks.length &gt; j)</span>
<a href="#l4.36"></a><span id="l4.36">               completions = completions.concat(partedNicks.slice(j));</span>
<a href="#l4.37"></a><span id="l4.37"> */</span>
<a href="#l4.38"></a><span id="l4.38"> </span>
<a href="#l4.39"></a><span id="l4.39">             let outgoingNick = this._conv.nick;</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineminus">-            completions = completions.filter(function(c) c != outgoingNick);</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+            completions = completions.filter(c =&gt; c != outgoingNick);</span>
<a href="#l4.42"></a><span id="l4.42"> </span>
<a href="#l4.43"></a><span id="l4.43">             // Check if the preceding words are a sequence of nick completions.</span>
<a href="#l4.44"></a><span id="l4.44">             let wordStart = inputBox.selectionStart - word.length;</span>
<a href="#l4.45"></a><span id="l4.45">             if (wordStart &gt; 2) {</span>
<a href="#l4.46"></a><span id="l4.46">               let separator = text.substring(wordStart - 2, wordStart);</span>
<a href="#l4.47"></a><span id="l4.47">               if (separator == &quot;: &quot; || separator == &quot;, &quot;) {</span>
<a href="#l4.48"></a><span id="l4.48">                 let preceding = text.substring(0, wordStart - 2).split(&quot;, &quot;);</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineminus">-                if (preceding.every(function(n) completions.indexOf(n) != -1)) {</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineplus">+                if (preceding.every(n =&gt; completions.indexOf(n) != -1)) {</span>
<a href="#l4.51"></a><span id="l4.51">                   secondNick = true;</span>
<a href="#l4.52"></a><span id="l4.52">                   isFirstWord = true;</span>
<a href="#l4.53"></a><span id="l4.53">                   // Remove preceding completions from possible completions.</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineminus">-                  completions = completions.filter(function(c)</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineplus">+                  completions = completions.filter(c =&gt;</span>
<a href="#l4.56"></a><span id="l4.56">                     preceding.indexOf(c) == -1);</span>
<a href="#l4.57"></a><span id="l4.57">                 }</span>
<a href="#l4.58"></a><span id="l4.58">               }</span>
<a href="#l4.59"></a><span id="l4.59">             }</span>
<a href="#l4.60"></a><span id="l4.60">           }</span>
<a href="#l4.61"></a><span id="l4.61"> </span>
<a href="#l4.62"></a><span id="l4.62">           // Keep only the completions that share |word| as a prefix.</span>
<a href="#l4.63"></a><span id="l4.63">           // Be case insensitive only if |word| is entirely lower case.</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineat">@@ -659,19 +659,19 @@</span>
<a href="#l4.65"></a><span id="l4.65">           // actually exposed to the user, as if there are active nicks</span>
<a href="#l4.66"></a><span id="l4.66">           // they will be moved to the beginning of the list.</span>
<a href="#l4.67"></a><span id="l4.67">           let firstCompletion = this._completions[0];</span>
<a href="#l4.68"></a><span id="l4.68">           let lastCompletion = this._completions.slice(-1)[0];</span>
<a href="#l4.69"></a><span id="l4.69"> </span>
<a href="#l4.70"></a><span id="l4.70">           let preferredNick = false;</span>
<a href="#l4.71"></a><span id="l4.71">           if (this._conv.isChat &amp;&amp; !completingCommand) {</span>
<a href="#l4.72"></a><span id="l4.72">             // If there are active nicks, prefer those.</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineminus">-            let activeCompletions = this._completions.filter(function(c)</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineplus">+            let activeCompletions = this._completions.filter(c =&gt;</span>
<a href="#l4.75"></a><span id="l4.75">               this.buddies.has(c) &amp;&amp;</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineminus">-              !this.buddies.get(c).hasAttribute(&quot;inactive&quot;), this);</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineplus">+              !this.buddies.get(c).hasAttribute(&quot;inactive&quot;));</span>
<a href="#l4.78"></a><span id="l4.78">             if (activeCompletions.length == 1)</span>
<a href="#l4.79"></a><span id="l4.79">               preferredNick = true;</span>
<a href="#l4.80"></a><span id="l4.80">             if (activeCompletions.length) {</span>
<a href="#l4.81"></a><span id="l4.81">               // Move active nicks to the front of the queue.</span>
<a href="#l4.82"></a><span id="l4.82">               activeCompletions.reverse();</span>
<a href="#l4.83"></a><span id="l4.83">               activeCompletions.forEach(function(c) {</span>
<a href="#l4.84"></a><span id="l4.84">                 this._completions.splice(this._completions.indexOf(c), 1);</span>
<a href="#l4.85"></a><span id="l4.85">                 this._completions.unshift(c);</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineat">@@ -698,17 +698,17 @@</span>
<a href="#l4.87"></a><span id="l4.87">               // completions on the next &lt;tab&gt; press.</span>
<a href="#l4.88"></a><span id="l4.88">               this._shouldListCompletionsLater = completionsList;</span>
<a href="#l4.89"></a><span id="l4.89">             }</span>
<a href="#l4.90"></a><span id="l4.90">             else</span>
<a href="#l4.91"></a><span id="l4.91">               this._conv.systemMessage(completionsList);</span>
<a href="#l4.92"></a><span id="l4.92">           }</span>
<a href="#l4.93"></a><span id="l4.93"> </span>
<a href="#l4.94"></a><span id="l4.94">           let suffix = (isFirstWord ? firstWordSuffix : &quot;&quot;);</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineminus">-          this._completions = this._completions.map(function(c) c + suffix);</span>
<a href="#l4.96"></a><span id="l4.96" class="difflineplus">+          this._completions = this._completions.map(c =&gt; c + suffix);</span>
<a href="#l4.97"></a><span id="l4.97"> </span>
<a href="#l4.98"></a><span id="l4.98">           let completion;</span>
<a href="#l4.99"></a><span id="l4.99">           if (this._completions.length == 1 || preferredNick) {</span>
<a href="#l4.100"></a><span id="l4.100">             // Only one possible completion? Apply it! :-)</span>
<a href="#l4.101"></a><span id="l4.101">             completion = this._completions[this._completionsIndex++];</span>
<a href="#l4.102"></a><span id="l4.102">             this._completionsIndex %= this._completions.length;</span>
<a href="#l4.103"></a><span id="l4.103">           }</span>
<a href="#l4.104"></a><span id="l4.104">           else {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/components/im/content/imgroup.xml</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/components/im/content/imgroup.xml</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -114,17 +114,17 @@</span>
<a href="#l5.4"></a><span id="l5.4">       &lt;parameter name=&quot;aContact&quot;/&gt;</span>
<a href="#l5.5"></a><span id="l5.5">       &lt;body&gt;</span>
<a href="#l5.6"></a><span id="l5.6">       &lt;![CDATA[</span>
<a href="#l5.7"></a><span id="l5.7">         let contact = this.contactsById[aContact.id];</span>
<a href="#l5.8"></a><span id="l5.8">         if (!contact)</span>
<a href="#l5.9"></a><span id="l5.9">           throw &quot;Removing a contact that isn't here?&quot;;</span>
<a href="#l5.10"></a><span id="l5.10"> </span>
<a href="#l5.11"></a><span id="l5.11">         // create a new array to remove without breaking for each loops.</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-        this.contacts = this.contacts.filter(function(c) c !== contact);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+        this.contacts = this.contacts.filter(c =&gt; c !== contact);</span>
<a href="#l5.14"></a><span id="l5.14">         delete this.contactsById[contact.contact.id];</span>
<a href="#l5.15"></a><span id="l5.15"> </span>
<a href="#l5.16"></a><span id="l5.16">         contact.destroy();</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18">         // Check if some contacts remain in the group, if empty hide it.</span>
<a href="#l5.19"></a><span id="l5.19">         if (!this.contacts.length)</span>
<a href="#l5.20"></a><span id="l5.20">           this.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l5.21"></a><span id="l5.21">         else</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/components/im/imIncomingServer.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/components/im/imIncomingServer.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -4,17 +4,17 @@</span>
<a href="#l6.4"></a><span id="l6.4"> </span>
<a href="#l6.5"></a><span id="l6.5"> const {classes: Cc, interfaces: Ci, utils: Cu} = Components;</span>
<a href="#l6.6"></a><span id="l6.6"> Cu.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l6.7"></a><span id="l6.7"> Cu.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l6.8"></a><span id="l6.8"> </span>
<a href="#l6.9"></a><span id="l6.9"> function imIncomingServer() { }</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11"> imIncomingServer.prototype = {</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-  get wrappedJSObject() this,</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+  get wrappedJSObject() { return this; },</span>
<a href="#l6.14"></a><span id="l6.14">   _imAccount: null,</span>
<a href="#l6.15"></a><span id="l6.15">   get imAccount() {</span>
<a href="#l6.16"></a><span id="l6.16">     if (this._imAccount)</span>
<a href="#l6.17"></a><span id="l6.17">       return this._imAccount;</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19">     let id = this.getCharValue(&quot;imAccount&quot;);</span>
<a href="#l6.20"></a><span id="l6.20">     if (!id)</span>
<a href="#l6.21"></a><span id="l6.21">       return null;</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineat">@@ -23,26 +23,27 @@ imIncomingServer.prototype = {</span>
<a href="#l6.23"></a><span id="l6.23">   },</span>
<a href="#l6.24"></a><span id="l6.24">   set imAccount(aImAccount) {</span>
<a href="#l6.25"></a><span id="l6.25">     this._imAccount = aImAccount;</span>
<a href="#l6.26"></a><span id="l6.26">     this.setCharValue(&quot;imAccount&quot;, aImAccount.id);</span>
<a href="#l6.27"></a><span id="l6.27">   },</span>
<a href="#l6.28"></a><span id="l6.28">   _prefBranch: null,</span>
<a href="#l6.29"></a><span id="l6.29">   valid: true,</span>
<a href="#l6.30"></a><span id="l6.30">   hidden: false,</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-  get offlineSupportLevel() 0,</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineminus">-  get supportsDiskSpace() false,</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineplus">+  get offlineSupportLevel() { return 0; },</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineplus">+  get supportsDiskSpace() { return false; },</span>
<a href="#l6.35"></a><span id="l6.35">   _key: &quot;&quot;,</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineminus">-  get key() this._key,</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+  get key() { return this._key; },</span>
<a href="#l6.38"></a><span id="l6.38">   set key(aKey) {</span>
<a href="#l6.39"></a><span id="l6.39">     this._key = aKey;</span>
<a href="#l6.40"></a><span id="l6.40">     this._prefBranch = Services.prefs.getBranch(&quot;mail.server.&quot; + aKey + &quot;.&quot;);</span>
<a href="#l6.41"></a><span id="l6.41">   },</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineminus">-  equals: function(aServer)</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineminus">-    &quot;wrappedJSObject&quot; in aServer &amp;&amp; aServer.wrappedJSObject == this,</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+  equals: function (aServer) {</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineplus">+    return &quot;wrappedJSObject&quot; in aServer &amp;&amp; aServer.wrappedJSObject == this;</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineplus">+  },</span>
<a href="#l6.47"></a><span id="l6.47"> </span>
<a href="#l6.48"></a><span id="l6.48">   clearAllValues: function() {</span>
<a href="#l6.49"></a><span id="l6.49">     Services.accounts.deleteAccount(this.imAccount.id);</span>
<a href="#l6.50"></a><span id="l6.50">     this._prefBranch.deleteBranch(&quot;&quot;);</span>
<a href="#l6.51"></a><span id="l6.51">     delete this._prefBranch;</span>
<a href="#l6.52"></a><span id="l6.52">     delete this._imAccount;</span>
<a href="#l6.53"></a><span id="l6.53">   },</span>
<a href="#l6.54"></a><span id="l6.54">   // called by nsMsgAccountManager while deleting an account:</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineat">@@ -50,30 +51,30 @@ imIncomingServer.prototype = {</span>
<a href="#l6.56"></a><span id="l6.56"> </span>
<a href="#l6.57"></a><span id="l6.57">   // Shown in the &quot;Remove Account&quot; confirm prompt.</span>
<a href="#l6.58"></a><span id="l6.58">   get prettyName() {</span>
<a href="#l6.59"></a><span id="l6.59">     let protocol = this.imAccount.protocol.name || this.imAccount.protocol.id;</span>
<a href="#l6.60"></a><span id="l6.60">     return protocol + &quot; - &quot; + this.imAccount.name;</span>
<a href="#l6.61"></a><span id="l6.61">   },</span>
<a href="#l6.62"></a><span id="l6.62"> </span>
<a href="#l6.63"></a><span id="l6.63">   //XXX Flo: I don't think constructedPrettyName is visible in the UI</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineminus">-  get constructedPrettyName() &quot;constructedPrettyName FIXME&quot;,</span>
<a href="#l6.65"></a><span id="l6.65" class="difflineminus">-  get realHostName() this.hostName,</span>
<a href="#l6.66"></a><span id="l6.66" class="difflineplus">+  get constructedPrettyName() { return &quot;constructedPrettyName FIXME&quot;; },</span>
<a href="#l6.67"></a><span id="l6.67" class="difflineplus">+  get realHostName() { return this.hostName; },</span>
<a href="#l6.68"></a><span id="l6.68">   set realHostName(aValue) {},</span>
<a href="#l6.69"></a><span id="l6.69"> </span>
<a href="#l6.70"></a><span id="l6.70">   port: -1,</span>
<a href="#l6.71"></a><span id="l6.71">   accountManagerChrome: &quot;am-im.xul&quot;,</span>
<a href="#l6.72"></a><span id="l6.72"> </span>
<a href="#l6.73"></a><span id="l6.73"> </span>
<a href="#l6.74"></a><span id="l6.74">   //FIXME need a new imIIncomingService iface + classinfo for these 3 properties :(</span>
<a href="#l6.75"></a><span id="l6.75" class="difflineminus">-  get password() this.imAccount.password,</span>
<a href="#l6.76"></a><span id="l6.76" class="difflineplus">+  get password() { return this.imAccount.password; },</span>
<a href="#l6.77"></a><span id="l6.77">   set password(aPassword) {</span>
<a href="#l6.78"></a><span id="l6.78">     this.imAccount.password = aPassword;</span>
<a href="#l6.79"></a><span id="l6.79">   },</span>
<a href="#l6.80"></a><span id="l6.80" class="difflineminus">-  get alias() this.imAccount.alias,</span>
<a href="#l6.81"></a><span id="l6.81" class="difflineplus">+  get alias() { return this.imAccount.alias; },</span>
<a href="#l6.82"></a><span id="l6.82">   set alias(aAlias) {</span>
<a href="#l6.83"></a><span id="l6.83">     this.imAccount.alias = aAlias;</span>
<a href="#l6.84"></a><span id="l6.84">   },</span>
<a href="#l6.85"></a><span id="l6.85">   get autojoin() {</span>
<a href="#l6.86"></a><span id="l6.86">     try {</span>
<a href="#l6.87"></a><span id="l6.87">       let prefName = &quot;messenger.account.&quot; + this.imAccount.id + &quot;.autoJoin&quot;;</span>
<a href="#l6.88"></a><span id="l6.88">       return Services.prefs.getComplexValue(prefName, Ci.nsISupportsString).data;</span>
<a href="#l6.89"></a><span id="l6.89">     } catch (e) {</span>
<a href="#l6.90"></a><span id="l6.90" class="difflineat">@@ -169,43 +170,43 @@ imIncomingServer.prototype = {</span>
<a href="#l6.91"></a><span id="l6.91">   getCharValue: function(aPrefName) {</span>
<a href="#l6.92"></a><span id="l6.92">     try {</span>
<a href="#l6.93"></a><span id="l6.93">       return this._prefBranch.getCharPref(aPrefName);</span>
<a href="#l6.94"></a><span id="l6.94">     } catch (x) {</span>
<a href="#l6.95"></a><span id="l6.95">       return &quot;&quot;;</span>
<a href="#l6.96"></a><span id="l6.96">     }</span>
<a href="#l6.97"></a><span id="l6.97">   },</span>
<a href="#l6.98"></a><span id="l6.98"> </span>
<a href="#l6.99"></a><span id="l6.99" class="difflineminus">-  get type() this._prefBranch.getCharPref(&quot;type&quot;),</span>
<a href="#l6.100"></a><span id="l6.100" class="difflineplus">+  get type() { return this._prefBranch.getCharPref(&quot;type&quot;); },</span>
<a href="#l6.101"></a><span id="l6.101">   set type(aType) {</span>
<a href="#l6.102"></a><span id="l6.102">     this._prefBranch.setCharPref(&quot;type&quot;, aType);</span>
<a href="#l6.103"></a><span id="l6.103">   },</span>
<a href="#l6.104"></a><span id="l6.104"> </span>
<a href="#l6.105"></a><span id="l6.105" class="difflineminus">-  get username() this._prefBranch.getCharPref(&quot;userName&quot;),</span>
<a href="#l6.106"></a><span id="l6.106" class="difflineplus">+  get username() { return this._prefBranch.getCharPref(&quot;userName&quot;); },</span>
<a href="#l6.107"></a><span id="l6.107">   set username(aUsername) {</span>
<a href="#l6.108"></a><span id="l6.108">     if (!aUsername) {</span>
<a href="#l6.109"></a><span id="l6.109">       // nsMsgAccountManager::GetIncomingServer expects the pref to</span>
<a href="#l6.110"></a><span id="l6.110">       // be named userName but some early test versions with IM had</span>
<a href="#l6.111"></a><span id="l6.111">       // the pref named username.</span>
<a href="#l6.112"></a><span id="l6.112">       return;</span>
<a href="#l6.113"></a><span id="l6.113">     }</span>
<a href="#l6.114"></a><span id="l6.114">     this._prefBranch.setCharPref(&quot;userName&quot;, aUsername);</span>
<a href="#l6.115"></a><span id="l6.115">   },</span>
<a href="#l6.116"></a><span id="l6.116"> </span>
<a href="#l6.117"></a><span id="l6.117" class="difflineminus">-  get hostName() this._prefBranch.getCharPref(&quot;hostname&quot;),</span>
<a href="#l6.118"></a><span id="l6.118" class="difflineplus">+  get hostName() { return this._prefBranch.getCharPref(&quot;hostname&quot;); },</span>
<a href="#l6.119"></a><span id="l6.119">   set hostName(aHostName) {</span>
<a href="#l6.120"></a><span id="l6.120">     this._prefBranch.setCharPref(&quot;hostname&quot;, aHostName);</span>
<a href="#l6.121"></a><span id="l6.121">   },</span>
<a href="#l6.122"></a><span id="l6.122"> </span>
<a href="#l6.123"></a><span id="l6.123">   writeToFolderCache: function() { },</span>
<a href="#l6.124"></a><span id="l6.124">   closeCachedConnections: function() { },</span>
<a href="#l6.125"></a><span id="l6.125">   shutdown: function() { },</span>
<a href="#l6.126"></a><span id="l6.126">   setFilterList: function() { },</span>
<a href="#l6.127"></a><span id="l6.127"> </span>
<a href="#l6.128"></a><span id="l6.128" class="difflineminus">-  get canBeDefaultServer() false,</span>
<a href="#l6.129"></a><span id="l6.129" class="difflineplus">+  get canBeDefaultServer() { return false; },</span>
<a href="#l6.130"></a><span id="l6.130"> </span>
<a href="#l6.131"></a><span id="l6.131">   // AccountManager.js verifies that spamSettings is non-null before</span>
<a href="#l6.132"></a><span id="l6.132">   // using the initialize method, but we can't just use a null value</span>
<a href="#l6.133"></a><span id="l6.133">   // because that would crash nsMsgPurgeService::PerformPurge which</span>
<a href="#l6.134"></a><span id="l6.134">   // only verifies the nsresult return value of the spamSettings</span>
<a href="#l6.135"></a><span id="l6.135">   // getter before accessing the level property.</span>
<a href="#l6.136"></a><span id="l6.136">   get spamSettings() {</span>
<a href="#l6.137"></a><span id="l6.137">     return {</span>
<a href="#l6.138"></a><span id="l6.138" class="difflineat">@@ -215,49 +216,49 @@ imIncomingServer.prototype = {</span>
<a href="#l6.139"></a><span id="l6.139">     };</span>
<a href="#l6.140"></a><span id="l6.140">   },</span>
<a href="#l6.141"></a><span id="l6.141"> </span>
<a href="#l6.142"></a><span id="l6.142">   // nsMsgDBFolder.cpp crashes in HandleAutoCompactEvent if this doesn't exist:</span>
<a href="#l6.143"></a><span id="l6.143">   msgStore: {</span>
<a href="#l6.144"></a><span id="l6.144">     supportsCompaction: false</span>
<a href="#l6.145"></a><span id="l6.145">   },</span>
<a href="#l6.146"></a><span id="l6.146"> </span>
<a href="#l6.147"></a><span id="l6.147" class="difflineminus">-  get serverURI() &quot;im://&quot; + this.imAccount.protocol.id + &quot;/&quot; + this.imAccount.name,</span>
<a href="#l6.148"></a><span id="l6.148" class="difflineplus">+  get serverURI() { return &quot;im://&quot; + this.imAccount.protocol.id + &quot;/&quot; + this.imAccount.name; },</span>
<a href="#l6.149"></a><span id="l6.149">   _rootFolder: null,</span>
<a href="#l6.150"></a><span id="l6.150" class="difflineminus">-  get rootMsgFolder() this.rootFolder,</span>
<a href="#l6.151"></a><span id="l6.151" class="difflineplus">+  get rootMsgFolder() { return this.rootFolder; },</span>
<a href="#l6.152"></a><span id="l6.152">   get rootFolder() {</span>
<a href="#l6.153"></a><span id="l6.153">     if (this._rootFolder)</span>
<a href="#l6.154"></a><span id="l6.154">       return this._rootFolder;</span>
<a href="#l6.155"></a><span id="l6.155"> </span>
<a href="#l6.156"></a><span id="l6.156">     return (this._rootFolder = {</span>
<a href="#l6.157"></a><span id="l6.157">       isServer: true,</span>
<a href="#l6.158"></a><span id="l6.158">       server: this,</span>
<a href="#l6.159"></a><span id="l6.159" class="difflineminus">-      get prettyName() this.server.prettyName, // used in the account manager tree</span>
<a href="#l6.160"></a><span id="l6.160" class="difflineminus">-      get prettiestName() this.server.prettyName + &quot; prettiestName&quot;, // never displayed?</span>
<a href="#l6.161"></a><span id="l6.161" class="difflineminus">-      get name() this.server.prettyName + &quot; name&quot;, // never displayed?</span>
<a href="#l6.162"></a><span id="l6.162" class="difflineplus">+      get prettyName() { return this.server.prettyName; }, // used in the account manager tree</span>
<a href="#l6.163"></a><span id="l6.163" class="difflineplus">+      get prettiestName() { return this.server.prettyName + &quot; prettiestName&quot;; }, // never displayed?</span>
<a href="#l6.164"></a><span id="l6.164" class="difflineplus">+      get name() { return this.server.prettyName + &quot; name&quot;; }, // never displayed?</span>
<a href="#l6.165"></a><span id="l6.165">       // used in the folder pane tree, if we don't hide the IM accounts:</span>
<a href="#l6.166"></a><span id="l6.166" class="difflineminus">-      get abbreviatedName() this.server.prettyName + &quot;abbreviatedName&quot;,</span>
<a href="#l6.167"></a><span id="l6.167" class="difflineplus">+      get abbreviatedName() { return this.server.prettyName + &quot;abbreviatedName&quot;; },</span>
<a href="#l6.168"></a><span id="l6.168">       AddFolderListener: function() {},</span>
<a href="#l6.169"></a><span id="l6.169">       RemoveFolderListener: function() {},</span>
<a href="#l6.170"></a><span id="l6.170">       descendants: Components.classes[&quot;@mozilla.org/array;1&quot;]</span>
<a href="#l6.171"></a><span id="l6.171">                   .createInstance(Components.interfaces.nsIArray),</span>
<a href="#l6.172"></a><span id="l6.172">       ListDescendants: function(descendants) {},</span>
<a href="#l6.173"></a><span id="l6.173" class="difflineminus">-      getFolderWithFlags: function(aFlags) null,</span>
<a href="#l6.174"></a><span id="l6.174" class="difflineminus">-      getFoldersWithFlags: function(aFlags)</span>
<a href="#l6.175"></a><span id="l6.175" class="difflineplus">+      getFolderWithFlags: aFlags =&gt; null,</span>
<a href="#l6.176"></a><span id="l6.176" class="difflineplus">+      getFoldersWithFlags: aFlags =&gt;</span>
<a href="#l6.177"></a><span id="l6.177">         Components.classes[&quot;@mozilla.org/array;1&quot;]</span>
<a href="#l6.178"></a><span id="l6.178">                   .createInstance(Components.interfaces.nsIArray),</span>
<a href="#l6.179"></a><span id="l6.179" class="difflineminus">-      get subFolders() EmptyEnumerator,</span>
<a href="#l6.180"></a><span id="l6.180" class="difflineminus">-      getStringProperty: function(aPropertyName) &quot;&quot;,</span>
<a href="#l6.181"></a><span id="l6.181" class="difflineminus">-      getNumUnread: function(aDeep) 0,</span>
<a href="#l6.182"></a><span id="l6.182" class="difflineplus">+      get subFolders() { return EmptyEnumerator; },</span>
<a href="#l6.183"></a><span id="l6.183" class="difflineplus">+      getStringProperty: aPropertyName =&gt; &quot;&quot;,</span>
<a href="#l6.184"></a><span id="l6.184" class="difflineplus">+      getNumUnread: aDeep =&gt; 0,</span>
<a href="#l6.185"></a><span id="l6.185">       Shutdown: function() {},</span>
<a href="#l6.186"></a><span id="l6.186">       QueryInterface: XPCOMUtils.generateQI([Ci.nsIMsgFolder])</span>
<a href="#l6.187"></a><span id="l6.187">     });</span>
<a href="#l6.188"></a><span id="l6.188">   },</span>
<a href="#l6.189"></a><span id="l6.189"> </span>
<a href="#l6.190"></a><span id="l6.190" class="difflineminus">-  get sortOrder() 300000000,</span>
<a href="#l6.191"></a><span id="l6.191" class="difflineplus">+  get sortOrder() { return 300000000; },</span>
<a href="#l6.192"></a><span id="l6.192"> </span>
<a href="#l6.193"></a><span id="l6.193">   get protocolInfo() {</span>
<a href="#l6.194"></a><span id="l6.194">     return Components.classes[&quot;@mozilla.org/messenger/protocol/info;1?type=im&quot;]</span>
<a href="#l6.195"></a><span id="l6.195">                      .getService(Components.interfaces.nsIMsgProtocolInfo);</span>
<a href="#l6.196"></a><span id="l6.196">   },</span>
<a href="#l6.197"></a><span id="l6.197"> </span>
<a href="#l6.198"></a><span id="l6.198">   classDescription: &quot;IM Msg Incoming Server implementation&quot;,</span>
<a href="#l6.199"></a><span id="l6.199">   classID: Components.ID(&quot;{9dd7f36b-5960-4f0a-8789-f5f516bd083d}&quot;),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/components/im/imProtocolInfo.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/components/im/imProtocolInfo.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -5,32 +5,32 @@</span>
<a href="#l7.4"></a><span id="l7.4"> const {classes: Cc, interfaces: Ci, utils: Cu} = Components;</span>
<a href="#l7.5"></a><span id="l7.5"> Cu.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l7.6"></a><span id="l7.6"> </span>
<a href="#l7.7"></a><span id="l7.7"> function imProtocolInfo() { }</span>
<a href="#l7.8"></a><span id="l7.8"> </span>
<a href="#l7.9"></a><span id="l7.9"> imProtocolInfo.prototype = {</span>
<a href="#l7.10"></a><span id="l7.10"> </span>
<a href="#l7.11"></a><span id="l7.11">   defaultLocalPath: null,</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-  get serverIID() null,</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-  get requiresUsername() true,</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-  get preflightPrettyNameWithEmailAddress() false,</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-  get canDelete() true,</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+  get serverIID() { return null; },</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+  get requiresUsername() { return true; },</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+  get preflightPrettyNameWithEmailAddress() { return false; },</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+  get canDelete() { return true; },</span>
<a href="#l7.20"></a><span id="l7.20">   // Even though IM accounts can login at startup, canLoginAtStartUp</span>
<a href="#l7.21"></a><span id="l7.21">   // should be false as it's used to decide if new messages should be</span>
<a href="#l7.22"></a><span id="l7.22">   // fetched at startup and that concept of message doesn't apply to</span>
<a href="#l7.23"></a><span id="l7.23">   // IM accounts.</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineminus">-  get canLoginAtStartUp() false,</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineminus">-  get canDuplicate() false,</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineminus">-  getDefaultServerPort: function() 0,</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineminus">-  get canGetMessages() false,</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineminus">-  get canGetIncomingMessages() false,</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineminus">-  get defaultDoBiff() false,</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineminus">-  get showComposeMsgLink() false,</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-  get foldersCreatedAsync() false,</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+  get canLoginAtStartUp() { return false; },</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineplus">+  get canDuplicate() { return false; },</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+  getDefaultServerPort: () =&gt;  0,</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineplus">+  get canGetMessages() { return false; },</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+  get canGetIncomingMessages() { return false; },</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineplus">+  get defaultDoBiff() { return false; },</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineplus">+  get showComposeMsgLink() { return false; },</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineplus">+  get foldersCreatedAsync() { return false; },</span>
<a href="#l7.40"></a><span id="l7.40"> </span>
<a href="#l7.41"></a><span id="l7.41">   classDescription: &quot;IM Msg Protocol Info implementation&quot;,</span>
<a href="#l7.42"></a><span id="l7.42">   classID: Components.ID(&quot;{13118758-dad2-418c-a03d-1acbfed0cd01}&quot;),</span>
<a href="#l7.43"></a><span id="l7.43">   contractID: &quot;@mozilla.org/messenger/protocol/info;1?type=im&quot;,</span>
<a href="#l7.44"></a><span id="l7.44">   QueryInterface: XPCOMUtils.generateQI([Ci.nsIMsgProtocolInfo])</span>
<a href="#l7.45"></a><span id="l7.45"> };</span>
<a href="#l7.46"></a><span id="l7.46"> </span>
<a href="#l7.47"></a><span id="l7.47"> const NSGetFactory = XPCOMUtils.generateNSGetFactory([imProtocolInfo]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/components/im/messages/Footer.html</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/components/im/messages/Footer.html</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -8,17 +8,17 @@ function checkNewText(target)</span>
<a href="#l8.4"></a><span id="l8.4"> {</span>
<a href="#l8.5"></a><span id="l8.5">   if (target.tagName == &quot;P&quot; &amp;&amp; target.className == &quot;event&quot;) {</span>
<a href="#l8.6"></a><span id="l8.6">     let parent = target.parentNode;</span>
<a href="#l8.7"></a><span id="l8.7">     // We need to start a group with this element if there are at least 4</span>
<a href="#l8.8"></a><span id="l8.8">     // system messages and they aren't already grouped.</span>
<a href="#l8.9"></a><span id="l8.9">     if (!parent.grouped &amp;&amp; parent.querySelector(&quot;p.event:nth-of-type(4)&quot;)) {</span>
<a href="#l8.10"></a><span id="l8.10">       var p = document.createElement(&quot;p&quot;);</span>
<a href="#l8.11"></a><span id="l8.11">       p.className = &quot;eventToggle&quot;;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-      p.addEventListener(&quot;click&quot;, function (event)</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+      p.addEventListener(&quot;click&quot;, event =&gt;</span>
<a href="#l8.14"></a><span id="l8.14">         event.target.parentNode.classList.toggle(&quot;hide-children&quot;));</span>
<a href="#l8.15"></a><span id="l8.15">       parent.insertBefore(p, parent.querySelector(&quot;p.event:nth-of-type(2)&quot;));</span>
<a href="#l8.16"></a><span id="l8.16">       parent.classList.add(&quot;hide-children&quot;);</span>
<a href="#l8.17"></a><span id="l8.17">       parent.grouped = true;</span>
<a href="#l8.18"></a><span id="l8.18">     }</span>
<a href="#l8.19"></a><span id="l8.19">   }</span>
<a href="#l8.20"></a><span id="l8.20"> }</span>
<a href="#l8.21"></a><span id="l8.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/components/im/modules/index_im.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/components/im/modules/index_im.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -29,17 +29,17 @@ const FileInputStream = CC(&quot;@mozilla.org</span>
<a href="#l9.4"></a><span id="l9.4"> const ScriptableInputStream = CC(&quot;@mozilla.org/scriptableinputstream;1&quot;,</span>
<a href="#l9.5"></a><span id="l9.5">                                  &quot;nsIScriptableInputStream&quot;,</span>
<a href="#l9.6"></a><span id="l9.6">                                  &quot;init&quot;);</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8"> // kIndexingDelay is how long we wait from the point of scheduling an indexing</span>
<a href="#l9.9"></a><span id="l9.9"> // job to actually carrying it out.</span>
<a href="#l9.10"></a><span id="l9.10"> const kIndexingDelay = 5000; // in milliseconds</span>
<a href="#l9.11"></a><span id="l9.11"> </span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-XPCOMUtils.defineLazyGetter(this, &quot;MailFolder&quot;, function()</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+XPCOMUtils.defineLazyGetter(this, &quot;MailFolder&quot;, () =&gt;</span>
<a href="#l9.14"></a><span id="l9.14">   Cc[&quot;@mozilla.org/rdf/resource-factory;1?name=mailbox&quot;].createInstance(Ci.nsIMsgFolder)</span>
<a href="#l9.15"></a><span id="l9.15"> );</span>
<a href="#l9.16"></a><span id="l9.16"> </span>
<a href="#l9.17"></a><span id="l9.17"> var gIMAccounts = {};</span>
<a href="#l9.18"></a><span id="l9.18"> </span>
<a href="#l9.19"></a><span id="l9.19"> function GlodaIMConversation(aTitle, aTime, aPath, aContent)</span>
<a href="#l9.20"></a><span id="l9.20"> {</span>
<a href="#l9.21"></a><span id="l9.21">   // grokNounItem from gloda.js puts automatically the values of all</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -47,20 +47,20 @@ function GlodaIMConversation(aTitle, aTi</span>
<a href="#l9.23"></a><span id="l9.23">   // they start with _, so we put the values in _-prefixed properties,</span>
<a href="#l9.24"></a><span id="l9.24">   // and have getters in the prototype.</span>
<a href="#l9.25"></a><span id="l9.25">   this._title = aTitle;</span>
<a href="#l9.26"></a><span id="l9.26">   this._time = aTime;</span>
<a href="#l9.27"></a><span id="l9.27">   this._path = aPath;</span>
<a href="#l9.28"></a><span id="l9.28">   this._content = aContent;</span>
<a href="#l9.29"></a><span id="l9.29"> }</span>
<a href="#l9.30"></a><span id="l9.30"> GlodaIMConversation.prototype = {</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-  get title() this._title,</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineminus">-  get time() this._time,</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineminus">-  get path() this._path,</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineminus">-  get content() this._content,</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineplus">+  get title() { return this._title; },</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+  get time() { return this._time; },</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineplus">+  get path() { return this._path; },</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineplus">+  get content() { return this._content; },</span>
<a href="#l9.39"></a><span id="l9.39"> </span>
<a href="#l9.40"></a><span id="l9.40">   // for glodaFacetBindings.xml compatibility (pretend we are a message object)</span>
<a href="#l9.41"></a><span id="l9.41">   get account() {</span>
<a href="#l9.42"></a><span id="l9.42">     let [protocol, username] = this._path.split(&quot;/&quot;, 2);</span>
<a href="#l9.43"></a><span id="l9.43"> </span>
<a href="#l9.44"></a><span id="l9.44">     let cacheName = protocol + &quot;/&quot; + username;</span>
<a href="#l9.45"></a><span id="l9.45">     if (cacheName in gIMAccounts)</span>
<a href="#l9.46"></a><span id="l9.46">       return gIMAccounts[cacheName];</span>
<a href="#l9.47"></a><span id="l9.47" class="difflineat">@@ -74,19 +74,19 @@ GlodaIMConversation.prototype = {</span>
<a href="#l9.48"></a><span id="l9.48">       let imAccount = incomingServer.wrappedJSObject.imAccount;</span>
<a href="#l9.49"></a><span id="l9.49">       if (imAccount.protocol.normalizedName == protocol &amp;&amp;</span>
<a href="#l9.50"></a><span id="l9.50">           imAccount.normalizedName == username)</span>
<a href="#l9.51"></a><span id="l9.51">         return (gIMAccounts[cacheName] = new GlodaAccount(incomingServer));</span>
<a href="#l9.52"></a><span id="l9.52">     }</span>
<a href="#l9.53"></a><span id="l9.53">     // The IM conversation is probably for an account that no longer exists.</span>
<a href="#l9.54"></a><span id="l9.54">     return null;</span>
<a href="#l9.55"></a><span id="l9.55">   },</span>
<a href="#l9.56"></a><span id="l9.56" class="difflineminus">-  get subject() this._title,</span>
<a href="#l9.57"></a><span id="l9.57" class="difflineminus">-  get date() new Date(this._time * 1000),</span>
<a href="#l9.58"></a><span id="l9.58" class="difflineminus">-  get involves() Gloda.IGNORE_FACET,</span>
<a href="#l9.59"></a><span id="l9.59" class="difflineplus">+  get subject() { return this._title; },</span>
<a href="#l9.60"></a><span id="l9.60" class="difflineplus">+  get date() { return new Date(this._time * 1000); },</span>
<a href="#l9.61"></a><span id="l9.61" class="difflineplus">+  get involves() { return Gloda.IGNORE_FACET; },</span>
<a href="#l9.62"></a><span id="l9.62">   _recipients: null,</span>
<a href="#l9.63"></a><span id="l9.63">   get recipients() {</span>
<a href="#l9.64"></a><span id="l9.64">     if (!this._recipients)</span>
<a href="#l9.65"></a><span id="l9.65">       this._recipients = [{contact: {name: this._path.split(&quot;/&quot;, 2)[1]}}];</span>
<a href="#l9.66"></a><span id="l9.66">     return this._recipients;</span>
<a href="#l9.67"></a><span id="l9.67">   },</span>
<a href="#l9.68"></a><span id="l9.68">   _from: null,</span>
<a href="#l9.69"></a><span id="l9.69">   get from() {</span>
<a href="#l9.70"></a><span id="l9.70" class="difflineat">@@ -94,25 +94,25 @@ GlodaIMConversation.prototype = {</span>
<a href="#l9.71"></a><span id="l9.71">       let from = &quot;&quot;;</span>
<a href="#l9.72"></a><span id="l9.72">       let account = this.account;</span>
<a href="#l9.73"></a><span id="l9.73">       if (account)</span>
<a href="#l9.74"></a><span id="l9.74">         from = account.incomingServer.wrappedJSObject.imAccount.protocol.name;</span>
<a href="#l9.75"></a><span id="l9.75">       this._from = {value: &quot;&quot;, contact: {name: from}};</span>
<a href="#l9.76"></a><span id="l9.76">     }</span>
<a href="#l9.77"></a><span id="l9.77">     return this._from;</span>
<a href="#l9.78"></a><span id="l9.78">   },</span>
<a href="#l9.79"></a><span id="l9.79" class="difflineminus">-  get tags() [],</span>
<a href="#l9.80"></a><span id="l9.80" class="difflineminus">-  get starred() false,</span>
<a href="#l9.81"></a><span id="l9.81" class="difflineminus">-  get attachmentNames() null,</span>
<a href="#l9.82"></a><span id="l9.82" class="difflineminus">-  get indexedBodyText() this._content,</span>
<a href="#l9.83"></a><span id="l9.83" class="difflineminus">-  get read() true,</span>
<a href="#l9.84"></a><span id="l9.84" class="difflineminus">-  get folder() Gloda.IGNORE_FACET,</span>
<a href="#l9.85"></a><span id="l9.85" class="difflineplus">+  get tags() { return []; },</span>
<a href="#l9.86"></a><span id="l9.86" class="difflineplus">+  get starred() { return false; },</span>
<a href="#l9.87"></a><span id="l9.87" class="difflineplus">+  get attachmentNames() { return null; },</span>
<a href="#l9.88"></a><span id="l9.88" class="difflineplus">+  get indexedBodyText() { return this._content; },</span>
<a href="#l9.89"></a><span id="l9.89" class="difflineplus">+  get read() { return true; },</span>
<a href="#l9.90"></a><span id="l9.90" class="difflineplus">+  get folder() { return Gloda.IGNORE_FACET; },</span>
<a href="#l9.91"></a><span id="l9.91"> </span>
<a href="#l9.92"></a><span id="l9.92">   // for glodaFacetView.js _removeDupes</span>
<a href="#l9.93"></a><span id="l9.93" class="difflineminus">-  get headerMessageID() this.id</span>
<a href="#l9.94"></a><span id="l9.94" class="difflineplus">+  get headerMessageID() { return this.id; }</span>
<a href="#l9.95"></a><span id="l9.95"> };</span>
<a href="#l9.96"></a><span id="l9.96"> </span>
<a href="#l9.97"></a><span id="l9.97"> // FIXME</span>
<a href="#l9.98"></a><span id="l9.98"> var WidgetProvider = {</span>
<a href="#l9.99"></a><span id="l9.99">   providerName: &quot;widget&quot;,</span>
<a href="#l9.100"></a><span id="l9.100">   process: function () {</span>
<a href="#l9.101"></a><span id="l9.101">     //XXX What is this supposed to do?</span>
<a href="#l9.102"></a><span id="l9.102">     yield Gloda.kWorkDone;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

