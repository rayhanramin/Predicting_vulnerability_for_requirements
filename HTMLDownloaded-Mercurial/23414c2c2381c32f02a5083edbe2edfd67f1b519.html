<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 3269:23414c2c2381c32f02a5083edbe2edfd67f1b519</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 23414c2c2381c32f02a5083edbe2edfd67f1b519" />
<meta property="og:url" content="/comm-central/rev/23414c2c2381c32f02a5083edbe2edfd67f1b519" />
<meta property="og:description" content="bug 411536 - create SMILE (SeaMonkey Interface Library for Extensions), initial part with base work applicable pieces from FUEL, last review comments and nits addressed by Philip Chee, r=Neil" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 23414c2c2381c32f02a5083edbe2edfd67f1b519 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/23414c2c2381c32f02a5083edbe2edfd67f1b519">shortlog</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/23414c2c2381c32f02a5083edbe2edfd67f1b519">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519">files</a> |
changeset |
<a href="/comm-central/raw-rev/23414c2c2381c32f02a5083edbe2edfd67f1b519">raw</a>  | <a href="/comm-central/archive/23414c2c2381c32f02a5083edbe2edfd67f1b519.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=411536">bug 411536</a> - create SMILE (SeaMonkey Interface Library for Extensions), initial part with base work applicable pieces from FUEL, last review comments and nits addressed by Philip Chee, r=Neil
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#114;&#103;&#101;&#32;&#86;&#105;&#108;&#108;&#97;&#108;&#111;&#98;&#111;&#115;&#32;&#60;&#106;&#111;&#114;&#103;&#101;&#46;&#118;&#105;&#108;&#108;&#97;&#108;&#111;&#98;&#111;&#115;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Mon, 10 Aug 2009 15:30:29 +0800</td></tr>

<tr>
 <td>changeset 3269</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/23414c2c2381c32f02a5083edbe2edfd67f1b519">23414c2c2381c32f02a5083edbe2edfd67f1b519</a></td>
</tr>



<tr>
<td>parent 3268</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/1bb0e6d704340584e3a729d7eda9039a75cf6ad0">1bb0e6d704340584e3a729d7eda9039a75cf6ad0</a>
</td>
</tr>

<tr>
<td>child 3270</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/54a31dce7f855f3b1901040299d7d4916b2f9a14">54a31dce7f855f3b1901040299d7d4916b2f9a14</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=23414c2c2381c32f02a5083edbe2edfd67f1b519">2659</a></td></tr>
<tr><td>push user</td><td>kairo@kairo.at</td></tr>
<tr><td>push date</td><td class="date age">Mon, 10 Aug 2009 13:12:11 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@23414c2c2381 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=23414c2c2381c32f02a5083edbe2edfd67f1b519">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=23414c2c2381c32f02a5083edbe2edfd67f1b519&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=23414c2c2381c32f02a5083edbe2edfd67f1b519&newProject=comm-central&newRevision=23414c2c2381c32f02a5083edbe2edfd67f1b519&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=23414c2c2381c32f02a5083edbe2edfd67f1b519&newProject=comm-central&newRevision=23414c2c2381c32f02a5083edbe2edfd67f1b519&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=23414c2c2381c32f02a5083edbe2edfd67f1b519&newProject=comm-central&newRevision=23414c2c2381c32f02a5083edbe2edfd67f1b519&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Neil%29&revcount=50">Neil</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=411536">411536</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=411536">bug 411536</a> - create SMILE (SeaMonkey Interface Library for Extensions), initial part with base work applicable pieces from FUEL, last review comments and nits addressed by Philip Chee, r=Neil</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/Makefile.in">suite/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/Makefile.in">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/Makefile.in">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/Makefile.in">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/Makefile.in">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/unix/packages">suite/installer/unix/packages</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/unix/packages">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/unix/packages">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/unix/packages">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/unix/packages">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/unix/packages">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/windows/packages">suite/installer/windows/packages</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/windows/packages">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/windows/packages">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/windows/packages">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/windows/packages">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/installer/windows/packages">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/makefiles.sh">suite/makefiles.sh</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/makefiles.sh">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/makefiles.sh">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/makefiles.sh">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/makefiles.sh">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/makefiles.sh">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/Makefile.in">suite/smile/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/Makefile.in">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/Makefile.in">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/Makefile.in">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/Makefile.in">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/Makefile.in">suite/smile/public/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/Makefile.in">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/Makefile.in">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/Makefile.in">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/Makefile.in">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/smileIApplication.idl">suite/smile/public/smileIApplication.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/smileIApplication.idl">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/smileIApplication.idl">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/smileIApplication.idl">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/smileIApplication.idl">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/public/smileIApplication.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/Makefile.in">suite/smile/src/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/Makefile.in">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/Makefile.in">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/Makefile.in">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/Makefile.in">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/smileApplication.js">suite/smile/src/smileApplication.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/smileApplication.js">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/smileApplication.js">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/smileApplication.js">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/smileApplication.js">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/src/smileApplication.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentA.html">suite/smile/test/ContentA.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentA.html">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentA.html">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentA.html">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentA.html">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentA.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentB.html">suite/smile/test/ContentB.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentB.html">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentB.html">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentB.html">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentB.html">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentB.html">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentWithFrames.html">suite/smile/test/ContentWithFrames.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentWithFrames.html">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentWithFrames.html">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentWithFrames.html">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentWithFrames.html">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/ContentWithFrames.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/Makefile.in">suite/smile/test/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/Makefile.in">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/Makefile.in">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/Makefile.in">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/Makefile.in">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Application.js">suite/smile/test/browser_Application.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Application.js">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Application.js">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Application.js">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Application.js">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Application.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationPrefs.js">suite/smile/test/browser_ApplicationPrefs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationPrefs.js">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationPrefs.js">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationPrefs.js">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationPrefs.js">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationPrefs.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationQuitting.js">suite/smile/test/browser_ApplicationQuitting.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationQuitting.js">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationQuitting.js">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationQuitting.js">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationQuitting.js">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationQuitting.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationStorage.js">suite/smile/test/browser_ApplicationStorage.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationStorage.js">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationStorage.js">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationStorage.js">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationStorage.js">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_ApplicationStorage.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Browser.js">suite/smile/test/browser_Browser.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Browser.js">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Browser.js">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Browser.js">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Browser.js">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Browser.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Extensions.js">suite/smile/test/browser_Extensions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Extensions.js">file</a> |
<a href="/comm-central/annotate/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Extensions.js">annotate</a> |
<a href="/comm-central/diff/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Extensions.js">diff</a> |
<a href="/comm-central/comparison/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Extensions.js">comparison</a> |
<a href="/comm-central/log/23414c2c2381c32f02a5083edbe2edfd67f1b519/suite/smile/test/browser_Extensions.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/suite/Makefile.in</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/suite/Makefile.in</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -57,16 +57,17 @@ PARALLEL_DIRS	+= \</span>
<a href="#l1.4"></a><span id="l1.4"> 		feeds/src \</span>
<a href="#l1.5"></a><span id="l1.5"> 		locales \</span>
<a href="#l1.6"></a><span id="l1.6"> 		modules \</span>
<a href="#l1.7"></a><span id="l1.7"> 		themes/classic \</span>
<a href="#l1.8"></a><span id="l1.8"> 		themes/modern \</span>
<a href="#l1.9"></a><span id="l1.9"> 		profile \</span>
<a href="#l1.10"></a><span id="l1.10"> 		security \</span>
<a href="#l1.11"></a><span id="l1.11"> 		shell/public \</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+		smile \</span>
<a href="#l1.13"></a><span id="l1.13"> 		$(NULL)</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15"> ifeq ($(OS_ARCH),WINNT)</span>
<a href="#l1.16"></a><span id="l1.16"> PARALLEL_DIRS += shell/src</span>
<a href="#l1.17"></a><span id="l1.17"> ifdef MOZ_INSTALLER</span>
<a href="#l1.18"></a><span id="l1.18"> PARALLEL_DIRS += installer/windows</span>
<a href="#l1.19"></a><span id="l1.19"> endif</span>
<a href="#l1.20"></a><span id="l1.20"> endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/suite/installer/unix/packages</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/suite/installer/unix/packages</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -216,16 +216,17 @@ bin/components/pref.xpt</span>
<a href="#l2.4"></a><span id="l2.4"> bin/components/prefetch.xpt</span>
<a href="#l2.5"></a><span id="l2.5"> bin/components/profile.xpt</span>
<a href="#l2.6"></a><span id="l2.6"> bin/components/proxyObjInst.xpt</span>
<a href="#l2.7"></a><span id="l2.7"> bin/components/rdf.xpt</span>
<a href="#l2.8"></a><span id="l2.8"> bin/components/satchel.xpt</span>
<a href="#l2.9"></a><span id="l2.9"> bin/components/saxparser.xpt</span>
<a href="#l2.10"></a><span id="l2.10"> bin/components/shistory.xpt</span>
<a href="#l2.11"></a><span id="l2.11"> bin/components/shellservice.xpt</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+bin/components/smile.xpt</span>
<a href="#l2.13"></a><span id="l2.13"> bin/components/spellchecker.xpt</span>
<a href="#l2.14"></a><span id="l2.14"> bin/components/storage.xpt</span>
<a href="#l2.15"></a><span id="l2.15"> bin/components/suitebrowser.xpt</span>
<a href="#l2.16"></a><span id="l2.16"> bin/components/suitecommon.xpt</span>
<a href="#l2.17"></a><span id="l2.17"> bin/components/suitefeeds.xpt</span>
<a href="#l2.18"></a><span id="l2.18"> bin/components/suitemigration.xpt</span>
<a href="#l2.19"></a><span id="l2.19"> bin/components/toolkitprofile.xpt</span>
<a href="#l2.20"></a><span id="l2.20"> bin/components/toolkitremote.xpt</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineat">@@ -293,16 +294,17 @@ bin/components/nsSuiteDownloadManagerUI.</span>
<a href="#l2.22"></a><span id="l2.22"> bin/components/nsSuiteGlue.js</span>
<a href="#l2.23"></a><span id="l2.23"> bin/components/nsTaggingService.js</span>
<a href="#l2.24"></a><span id="l2.24"> bin/components/nsTypeAheadFind.js</span>
<a href="#l2.25"></a><span id="l2.25"> bin/components/nsTryToClose.js</span>
<a href="#l2.26"></a><span id="l2.26"> bin/components/nsUpdateService.js</span>
<a href="#l2.27"></a><span id="l2.27"> bin/components/nsURLFormatter.js</span>
<a href="#l2.28"></a><span id="l2.28"> bin/components/nsWebHandlerApp.js</span>
<a href="#l2.29"></a><span id="l2.29"> bin/components/pluginGlue.js</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineplus">+bin/components/smileApplication.js</span>
<a href="#l2.31"></a><span id="l2.31"> bin/components/storage-Legacy.js</span>
<a href="#l2.32"></a><span id="l2.32"> bin/components/storage-mozStorage.js</span>
<a href="#l2.33"></a><span id="l2.33"> bin/components/txEXSLTRegExFunctions.js</span>
<a href="#l2.34"></a><span id="l2.34"> bin/components/WebContentConverter.js</span>
<a href="#l2.35"></a><span id="l2.35"> </span>
<a href="#l2.36"></a><span id="l2.36"> ; Modules</span>
<a href="#l2.37"></a><span id="l2.37"> bin/modules/*</span>
<a href="#l2.38"></a><span id="l2.38"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/suite/installer/windows/packages</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/suite/installer/windows/packages</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -216,16 +216,17 @@ bin\components\pref.xpt</span>
<a href="#l3.4"></a><span id="l3.4"> bin\components\prefetch.xpt</span>
<a href="#l3.5"></a><span id="l3.5"> bin\components\profile.xpt</span>
<a href="#l3.6"></a><span id="l3.6"> bin\components\proxyObject.xpt</span>
<a href="#l3.7"></a><span id="l3.7"> bin\components\rdf.xpt</span>
<a href="#l3.8"></a><span id="l3.8"> bin\components\satchel.xpt</span>
<a href="#l3.9"></a><span id="l3.9"> bin\components\saxparser.xpt</span>
<a href="#l3.10"></a><span id="l3.10"> bin\components\shellservice.xpt</span>
<a href="#l3.11"></a><span id="l3.11"> bin\components\shistory.xpt</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+bin\components\smile.xpt</span>
<a href="#l3.13"></a><span id="l3.13"> bin\components\spellchecker.xpt</span>
<a href="#l3.14"></a><span id="l3.14"> bin\components\storage.xpt</span>
<a href="#l3.15"></a><span id="l3.15"> bin\components\suitebrowser.xpt</span>
<a href="#l3.16"></a><span id="l3.16"> bin\components\suitecommon.xpt</span>
<a href="#l3.17"></a><span id="l3.17"> bin\components\suitefeeds.xpt</span>
<a href="#l3.18"></a><span id="l3.18"> bin\components\suitemigration.xpt</span>
<a href="#l3.19"></a><span id="l3.19"> bin\components\toolkitprofile.xpt</span>
<a href="#l3.20"></a><span id="l3.20"> bin\components\txmgr.xpt</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineat">@@ -296,16 +297,17 @@ bin\components\nsSuiteDownloadManagerUI.</span>
<a href="#l3.22"></a><span id="l3.22"> bin\components\nsSuiteGlue.js</span>
<a href="#l3.23"></a><span id="l3.23"> bin\components\nsTaggingService.js</span>
<a href="#l3.24"></a><span id="l3.24"> bin\components\nsTypeAheadFind.js</span>
<a href="#l3.25"></a><span id="l3.25"> bin\components\nsTryToClose.js</span>
<a href="#l3.26"></a><span id="l3.26"> bin\components\nsUpdateService.js</span>
<a href="#l3.27"></a><span id="l3.27"> bin\components\nsURLFormatter.js</span>
<a href="#l3.28"></a><span id="l3.28"> bin\components\nsWebHandlerApp.js</span>
<a href="#l3.29"></a><span id="l3.29"> bin\components\pluginGlue.js</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+bin\components\smileApplication.js</span>
<a href="#l3.31"></a><span id="l3.31"> bin\components\storage-Legacy.js</span>
<a href="#l3.32"></a><span id="l3.32"> bin\components\storage-mozStorage.js</span>
<a href="#l3.33"></a><span id="l3.33"> bin\components\txEXSLTRegExFunctions.js</span>
<a href="#l3.34"></a><span id="l3.34"> bin\components\WebContentConverter.js</span>
<a href="#l3.35"></a><span id="l3.35"> </span>
<a href="#l3.36"></a><span id="l3.36"> ; Modules</span>
<a href="#l3.37"></a><span id="l3.37"> bin\modules\*</span>
<a href="#l3.38"></a><span id="l3.38"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/suite/makefiles.sh</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/suite/makefiles.sh</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -58,12 +58,13 @@ add_makefiles &quot;</span>
<a href="#l4.4"></a><span id="l4.4">   suite/mailnews/Makefile</span>
<a href="#l4.5"></a><span id="l4.5">   suite/modules/Makefile</span>
<a href="#l4.6"></a><span id="l4.6">   suite/modules/test/Makefile</span>
<a href="#l4.7"></a><span id="l4.7">   suite/profile/Makefile</span>
<a href="#l4.8"></a><span id="l4.8">   suite/profile/migration/public/Makefile</span>
<a href="#l4.9"></a><span id="l4.9">   suite/profile/migration/src/Makefile</span>
<a href="#l4.10"></a><span id="l4.10">   suite/shell/public/Makefile</span>
<a href="#l4.11"></a><span id="l4.11">   suite/shell/src/Makefile</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+  suite/smile/Makefile</span>
<a href="#l4.13"></a><span id="l4.13">   suite/themes/modern/Makefile</span>
<a href="#l4.14"></a><span id="l4.14">   suite/themes/classic/Makefile</span>
<a href="#l4.15"></a><span id="l4.15"> &quot;</span>
<a href="#l4.16"></a><span id="l4.16"> fi</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1">new file mode 100644</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineminus">--- /dev/null</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineplus">+++ b/suite/smile/Makefile.in</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineat">@@ -0,0 +1,50 @@</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l5.6"></a><span id="l5.6" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l5.7"></a><span id="l5.7" class="difflineplus">+#</span>
<a href="#l5.8"></a><span id="l5.8" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+#</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+# License.</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+#</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+# The Original Code is SMILE.</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+#</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+# The Initial Developer of the Original Code is Mozilla Corporation.</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2006</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+#</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineplus">+# Contributor(s):</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+#   Jorge Villalobos &lt;jorge.villalobos@gmail.com&gt;</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+#</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+#</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+DEPTH     = ../..</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+topsrcdir = @top_srcdir@</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+srcdir    = @srcdir@</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+VPATH     = @srcdir@</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineplus">+include $(DEPTH)/config/autoconf.mk</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineplus">+</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineplus">+PARALLEL_DIRS = public src</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineplus">+</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineplus">+ifdef ENABLE_TESTS</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+PARALLEL_DIRS += test</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineplus">+endif</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineplus">+</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineplus">+include $(topsrcdir)/config/rules.mk</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">new file mode 100644</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineminus">--- /dev/null</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineplus">+++ b/suite/smile/public/Makefile.in</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineat">@@ -0,0 +1,49 @@</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l6.6"></a><span id="l6.6" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l6.7"></a><span id="l6.7" class="difflineplus">+#</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+#</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+# License.</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+#</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+# The Original Code is SMILE.</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+#</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+# The Initial Developer of the Original Code is Mozilla Corporation.</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2006</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+#</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineplus">+# Contributor(s):</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineplus">+#   Jorge Villalobos &lt;jorge.villalobos@gmail.com&gt;</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineplus">+#</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineplus">+#</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineplus">+</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineplus">+DEPTH     = ../../..</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineplus">+topsrcdir = @top_srcdir@</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineplus">+srcdir    = @srcdir@</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+VPATH     = @srcdir@</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineplus">+</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineplus">+include $(DEPTH)/config/autoconf.mk</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineplus">+</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineplus">+MODULE        = smile</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineplus">+XPIDL_MODULE  = smile</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineplus">+</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+XPIDLSRCS = smileIApplication.idl</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineplus">+include $(topsrcdir)/config/rules.mk</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">new file mode 100644</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineminus">--- /dev/null</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineplus">+++ b/suite/smile/public/smileIApplication.idl</span>
<a href="#l7.4"></a><span id="l7.4" class="difflineat">@@ -0,0 +1,167 @@</span>
<a href="#l7.5"></a><span id="l7.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l7.6"></a><span id="l7.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l7.7"></a><span id="l7.7" class="difflineplus">+ *</span>
<a href="#l7.8"></a><span id="l7.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+ *</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+ * License.</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+ *</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+ * The Original Code is FUEL.</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+ *</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+ * The Initial Developer of the Original Code is Mozilla Corporation.</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2006</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineplus">+ *</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineplus">+ * Contributor(s):</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+ *  Mark Finkle &lt;mfinkle@mozilla.com&gt; (Original Author)</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineplus">+ *  John Resig  &lt;jresig@mozilla.com&gt; (Original Author)</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+ *  Jorge Villalobos &lt;jorge.villalobos@gmail.com&gt; (SeaMonkey port)</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineplus">+ *</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineplus">+ *</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineplus">+#include &quot;nsISupports.idl&quot;</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineplus">+#include &quot;extIApplication.idl&quot;</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineplus">+</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineplus">+interface nsIVariant;</span>
<a href="#l7.47"></a><span id="l7.47" class="difflineplus">+interface nsIURI;</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineplus">+interface nsIDOMHTMLDocument;</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineplus">+</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineplus">+interface smileIBrowserTab;</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineplus">+</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineplus">+/**</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineplus">+ * Interface representing a container for bookmark roots. Roots</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineplus">+ * are the top level parents for the various types of bookmarks in the system.</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineplus">+ * Empty as it is only used as the return type for Application.bookmarks. It</span>
<a href="#l7.56"></a><span id="l7.56" class="difflineplus">+ * will be supported once the Places bookmarks API is supported in SeaMonkey.</span>
<a href="#l7.57"></a><span id="l7.57" class="difflineplus">+ */</span>
<a href="#l7.58"></a><span id="l7.58" class="difflineplus">+[scriptable, uuid(1102eec4-f66b-4082-abad-c967ad7d5f76)]</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineplus">+interface smileIBookmarkRoots : nsISupports</span>
<a href="#l7.60"></a><span id="l7.60" class="difflineplus">+{</span>
<a href="#l7.61"></a><span id="l7.61" class="difflineplus">+};</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineplus">+</span>
<a href="#l7.63"></a><span id="l7.63" class="difflineplus">+/**</span>
<a href="#l7.64"></a><span id="l7.64" class="difflineplus">+ * Interface representing a browser window.</span>
<a href="#l7.65"></a><span id="l7.65" class="difflineplus">+ */</span>
<a href="#l7.66"></a><span id="l7.66" class="difflineplus">+[scriptable, uuid(1c3002ec-5aaf-4232-ab7d-835a348133fd)]</span>
<a href="#l7.67"></a><span id="l7.67" class="difflineplus">+interface smileIWindow : nsISupports</span>
<a href="#l7.68"></a><span id="l7.68" class="difflineplus">+{</span>
<a href="#l7.69"></a><span id="l7.69" class="difflineplus">+  /**</span>
<a href="#l7.70"></a><span id="l7.70" class="difflineplus">+   * A collection of browser tabs within the browser window.</span>
<a href="#l7.71"></a><span id="l7.71" class="difflineplus">+   */</span>
<a href="#l7.72"></a><span id="l7.72" class="difflineplus">+  readonly attribute nsIVariant tabs;</span>
<a href="#l7.73"></a><span id="l7.73" class="difflineplus">+</span>
<a href="#l7.74"></a><span id="l7.74" class="difflineplus">+  /**</span>
<a href="#l7.75"></a><span id="l7.75" class="difflineplus">+   * The currently-active tab within the browser window.</span>
<a href="#l7.76"></a><span id="l7.76" class="difflineplus">+   */</span>
<a href="#l7.77"></a><span id="l7.77" class="difflineplus">+  readonly attribute smileIBrowserTab activeTab;</span>
<a href="#l7.78"></a><span id="l7.78" class="difflineplus">+</span>
<a href="#l7.79"></a><span id="l7.79" class="difflineplus">+  /**</span>
<a href="#l7.80"></a><span id="l7.80" class="difflineplus">+   * Open a new browser tab, pointing to the specified URI.</span>
<a href="#l7.81"></a><span id="l7.81" class="difflineplus">+   * @param   aURI</span>
<a href="#l7.82"></a><span id="l7.82" class="difflineplus">+   *          The uri to open the browser tab to</span>
<a href="#l7.83"></a><span id="l7.83" class="difflineplus">+   */</span>
<a href="#l7.84"></a><span id="l7.84" class="difflineplus">+  smileIBrowserTab open(in nsIURI aURI);</span>
<a href="#l7.85"></a><span id="l7.85" class="difflineplus">+</span>
<a href="#l7.86"></a><span id="l7.86" class="difflineplus">+  /**</span>
<a href="#l7.87"></a><span id="l7.87" class="difflineplus">+   * The events object for the browser window.</span>
<a href="#l7.88"></a><span id="l7.88" class="difflineplus">+   * supports: &quot;TabOpen&quot;, &quot;TabClose&quot;, &quot;TabMove&quot;, &quot;TabSelect&quot;</span>
<a href="#l7.89"></a><span id="l7.89" class="difflineplus">+   */</span>
<a href="#l7.90"></a><span id="l7.90" class="difflineplus">+  readonly attribute extIEvents events;</span>
<a href="#l7.91"></a><span id="l7.91" class="difflineplus">+};</span>
<a href="#l7.92"></a><span id="l7.92" class="difflineplus">+</span>
<a href="#l7.93"></a><span id="l7.93" class="difflineplus">+/**</span>
<a href="#l7.94"></a><span id="l7.94" class="difflineplus">+ * Interface representing a browser tab.</span>
<a href="#l7.95"></a><span id="l7.95" class="difflineplus">+ */</span>
<a href="#l7.96"></a><span id="l7.96" class="difflineplus">+[scriptable, uuid(9b06c55e-5377-4c71-8bda-8e8750c5a02a)]</span>
<a href="#l7.97"></a><span id="l7.97" class="difflineplus">+interface smileIBrowserTab : nsISupports</span>
<a href="#l7.98"></a><span id="l7.98" class="difflineplus">+{</span>
<a href="#l7.99"></a><span id="l7.99" class="difflineplus">+  /**</span>
<a href="#l7.100"></a><span id="l7.100" class="difflineplus">+   * The current uri of this tab.</span>
<a href="#l7.101"></a><span id="l7.101" class="difflineplus">+   */</span>
<a href="#l7.102"></a><span id="l7.102" class="difflineplus">+  readonly attribute nsIURI uri;</span>
<a href="#l7.103"></a><span id="l7.103" class="difflineplus">+</span>
<a href="#l7.104"></a><span id="l7.104" class="difflineplus">+  /**</span>
<a href="#l7.105"></a><span id="l7.105" class="difflineplus">+   * The current index of this tab in the browser window.</span>
<a href="#l7.106"></a><span id="l7.106" class="difflineplus">+   */</span>
<a href="#l7.107"></a><span id="l7.107" class="difflineplus">+  readonly attribute PRInt32 index;</span>
<a href="#l7.108"></a><span id="l7.108" class="difflineplus">+</span>
<a href="#l7.109"></a><span id="l7.109" class="difflineplus">+  /**</span>
<a href="#l7.110"></a><span id="l7.110" class="difflineplus">+   * The browser window that is holding the tab.</span>
<a href="#l7.111"></a><span id="l7.111" class="difflineplus">+   */</span>
<a href="#l7.112"></a><span id="l7.112" class="difflineplus">+  readonly attribute smileIWindow window;</span>
<a href="#l7.113"></a><span id="l7.113" class="difflineplus">+</span>
<a href="#l7.114"></a><span id="l7.114" class="difflineplus">+  /**</span>
<a href="#l7.115"></a><span id="l7.115" class="difflineplus">+   * The content document of the browser tab.</span>
<a href="#l7.116"></a><span id="l7.116" class="difflineplus">+   */</span>
<a href="#l7.117"></a><span id="l7.117" class="difflineplus">+  readonly attribute nsIDOMHTMLDocument document;</span>
<a href="#l7.118"></a><span id="l7.118" class="difflineplus">+</span>
<a href="#l7.119"></a><span id="l7.119" class="difflineplus">+  /**</span>
<a href="#l7.120"></a><span id="l7.120" class="difflineplus">+   * The events object for the browser tab.</span>
<a href="#l7.121"></a><span id="l7.121" class="difflineplus">+   * supports: &quot;load&quot;</span>
<a href="#l7.122"></a><span id="l7.122" class="difflineplus">+   */</span>
<a href="#l7.123"></a><span id="l7.123" class="difflineplus">+  readonly attribute extIEvents events;</span>
<a href="#l7.124"></a><span id="l7.124" class="difflineplus">+</span>
<a href="#l7.125"></a><span id="l7.125" class="difflineplus">+  /**</span>
<a href="#l7.126"></a><span id="l7.126" class="difflineplus">+   * Load a new URI into this browser tab.</span>
<a href="#l7.127"></a><span id="l7.127" class="difflineplus">+   * @param   aURI</span>
<a href="#l7.128"></a><span id="l7.128" class="difflineplus">+   *          The uri to load into the browser tab</span>
<a href="#l7.129"></a><span id="l7.129" class="difflineplus">+   */</span>
<a href="#l7.130"></a><span id="l7.130" class="difflineplus">+  void load(in nsIURI aURI);</span>
<a href="#l7.131"></a><span id="l7.131" class="difflineplus">+</span>
<a href="#l7.132"></a><span id="l7.132" class="difflineplus">+  /**</span>
<a href="#l7.133"></a><span id="l7.133" class="difflineplus">+   * Give focus to this browser tab, and bring it to the front.</span>
<a href="#l7.134"></a><span id="l7.134" class="difflineplus">+   */</span>
<a href="#l7.135"></a><span id="l7.135" class="difflineplus">+  void focus();</span>
<a href="#l7.136"></a><span id="l7.136" class="difflineplus">+</span>
<a href="#l7.137"></a><span id="l7.137" class="difflineplus">+  /**</span>
<a href="#l7.138"></a><span id="l7.138" class="difflineplus">+   * Close the browser tab. This may not actually close the tab</span>
<a href="#l7.139"></a><span id="l7.139" class="difflineplus">+   * as script may abort the close operation.</span>
<a href="#l7.140"></a><span id="l7.140" class="difflineplus">+   */</span>
<a href="#l7.141"></a><span id="l7.141" class="difflineplus">+  void close();</span>
<a href="#l7.142"></a><span id="l7.142" class="difflineplus">+</span>
<a href="#l7.143"></a><span id="l7.143" class="difflineplus">+  /**</span>
<a href="#l7.144"></a><span id="l7.144" class="difflineplus">+   * Moves this browser tab before another browser tab within the window.</span>
<a href="#l7.145"></a><span id="l7.145" class="difflineplus">+   * @param   aBefore</span>
<a href="#l7.146"></a><span id="l7.146" class="difflineplus">+   *          The tab before which the target tab will be moved</span>
<a href="#l7.147"></a><span id="l7.147" class="difflineplus">+   */</span>
<a href="#l7.148"></a><span id="l7.148" class="difflineplus">+  void moveBefore(in smileIBrowserTab aBefore);</span>
<a href="#l7.149"></a><span id="l7.149" class="difflineplus">+</span>
<a href="#l7.150"></a><span id="l7.150" class="difflineplus">+  /**</span>
<a href="#l7.151"></a><span id="l7.151" class="difflineplus">+   * Move this browser tab to the last tab within the window.</span>
<a href="#l7.152"></a><span id="l7.152" class="difflineplus">+   */</span>
<a href="#l7.153"></a><span id="l7.153" class="difflineplus">+  void moveToEnd();</span>
<a href="#l7.154"></a><span id="l7.154" class="difflineplus">+};</span>
<a href="#l7.155"></a><span id="l7.155" class="difflineplus">+</span>
<a href="#l7.156"></a><span id="l7.156" class="difflineplus">+/**</span>
<a href="#l7.157"></a><span id="l7.157" class="difflineplus">+ * Interface for managing and accessing the applications systems</span>
<a href="#l7.158"></a><span id="l7.158" class="difflineplus">+ */</span>
<a href="#l7.159"></a><span id="l7.159" class="difflineplus">+[scriptable, uuid(c9ba8f65-c936-4ac6-a859-8936832b0c12)]</span>
<a href="#l7.160"></a><span id="l7.160" class="difflineplus">+interface smileIApplication : extIApplication</span>
<a href="#l7.161"></a><span id="l7.161" class="difflineplus">+{</span>
<a href="#l7.162"></a><span id="l7.162" class="difflineplus">+  /**</span>
<a href="#l7.163"></a><span id="l7.163" class="difflineplus">+   * An array of browser windows within the application.</span>
<a href="#l7.164"></a><span id="l7.164" class="difflineplus">+   */</span>
<a href="#l7.165"></a><span id="l7.165" class="difflineplus">+  readonly attribute nsIVariant windows;</span>
<a href="#l7.166"></a><span id="l7.166" class="difflineplus">+</span>
<a href="#l7.167"></a><span id="l7.167" class="difflineplus">+  /**</span>
<a href="#l7.168"></a><span id="l7.168" class="difflineplus">+   * The currently active browser window.</span>
<a href="#l7.169"></a><span id="l7.169" class="difflineplus">+   */</span>
<a href="#l7.170"></a><span id="l7.170" class="difflineplus">+  readonly attribute smileIWindow activeWindow;</span>
<a href="#l7.171"></a><span id="l7.171" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1">new file mode 100644</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineminus">--- /dev/null</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineplus">+++ b/suite/smile/src/Makefile.in</span>
<a href="#l8.4"></a><span id="l8.4" class="difflineat">@@ -0,0 +1,48 @@</span>
<a href="#l8.5"></a><span id="l8.5" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l8.6"></a><span id="l8.6" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l8.7"></a><span id="l8.7" class="difflineplus">+#</span>
<a href="#l8.8"></a><span id="l8.8" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l8.9"></a><span id="l8.9" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l8.11"></a><span id="l8.11" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+#</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+# License.</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+#</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+# The Original Code is SMILE.</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+#</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+# The Initial Developer of the Original Code is Mozilla Corporation.</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2006</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+#</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineplus">+# Contributor(s):</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineplus">+#   Jorge Villalobos &lt;jorge.villalobos@gmail.com&gt;</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineplus">+#</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+#</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineplus">+DEPTH     = ../../..</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineplus">+topsrcdir = @top_srcdir@</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineplus">+srcdir    = @srcdir@</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineplus">+VPATH     = @srcdir@</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineplus">+</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineplus">+include $(DEPTH)/config/autoconf.mk</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineplus">+</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineplus">+MODULE = smile</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineplus">+</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineplus">+EXTRA_PP_COMPONENTS = smileApplication.js</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineplus">+include $(topsrcdir)/config/rules.mk</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1">new file mode 100644</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineminus">--- /dev/null</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineplus">+++ b/suite/smile/src/smileApplication.js</span>
<a href="#l9.4"></a><span id="l9.4" class="difflineat">@@ -0,0 +1,386 @@</span>
<a href="#l9.5"></a><span id="l9.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l9.6"></a><span id="l9.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l9.7"></a><span id="l9.7" class="difflineplus">+ *</span>
<a href="#l9.8"></a><span id="l9.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l9.9"></a><span id="l9.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l9.10"></a><span id="l9.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l9.11"></a><span id="l9.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+ *</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+ * License.</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+ *</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+ * The Original Code is FUEL.</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+ *</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+ * The Initial Developer of the Original Code is Mozilla Corporation.</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2006</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l9.23"></a><span id="l9.23" class="difflineplus">+ *</span>
<a href="#l9.24"></a><span id="l9.24" class="difflineplus">+ * Contributor(s):</span>
<a href="#l9.25"></a><span id="l9.25" class="difflineplus">+ *  Mark Finkle &lt;mfinkle@mozilla.com&gt; (Original Author)</span>
<a href="#l9.26"></a><span id="l9.26" class="difflineplus">+ *  John Resig  &lt;jresig@mozilla.com&gt; (Original Author)</span>
<a href="#l9.27"></a><span id="l9.27" class="difflineplus">+ *  Jorge Villalobos &lt;jorge.villalobos@gmail.com&gt; (SeaMonkey port)</span>
<a href="#l9.28"></a><span id="l9.28" class="difflineplus">+ *</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineplus">+ *</span>
<a href="#l9.41"></a><span id="l9.41" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l9.42"></a><span id="l9.42" class="difflineplus">+</span>
<a href="#l9.43"></a><span id="l9.43" class="difflineplus">+const Ci = Components.interfaces;</span>
<a href="#l9.44"></a><span id="l9.44" class="difflineplus">+const Cc = Components.classes;</span>
<a href="#l9.45"></a><span id="l9.45" class="difflineplus">+</span>
<a href="#l9.46"></a><span id="l9.46" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l9.47"></a><span id="l9.47" class="difflineplus">+</span>
<a href="#l9.48"></a><span id="l9.48" class="difflineplus">+//=================================================</span>
<a href="#l9.49"></a><span id="l9.49" class="difflineplus">+// Singleton that holds services and utilities</span>
<a href="#l9.50"></a><span id="l9.50" class="difflineplus">+var Utilities = {</span>
<a href="#l9.51"></a><span id="l9.51" class="difflineplus">+  _bookmarks : null,</span>
<a href="#l9.52"></a><span id="l9.52" class="difflineplus">+  get bookmarks() {</span>
<a href="#l9.53"></a><span id="l9.53" class="difflineplus">+    if (!this._bookmarks) {</span>
<a href="#l9.54"></a><span id="l9.54" class="difflineplus">+      this._bookmarks =</span>
<a href="#l9.55"></a><span id="l9.55" class="difflineplus">+        Components.classes[&quot;@mozilla.org/browser/nav-bookmarks-service;1&quot;]</span>
<a href="#l9.56"></a><span id="l9.56" class="difflineplus">+                  .getService(Components.interfaces.nsINavBookmarksService);</span>
<a href="#l9.57"></a><span id="l9.57" class="difflineplus">+    }</span>
<a href="#l9.58"></a><span id="l9.58" class="difflineplus">+    return this._bookmarks;</span>
<a href="#l9.59"></a><span id="l9.59" class="difflineplus">+  },</span>
<a href="#l9.60"></a><span id="l9.60" class="difflineplus">+</span>
<a href="#l9.61"></a><span id="l9.61" class="difflineplus">+  _livemarks : null,</span>
<a href="#l9.62"></a><span id="l9.62" class="difflineplus">+  get livemarks() {</span>
<a href="#l9.63"></a><span id="l9.63" class="difflineplus">+    if (!this._livemarks) {</span>
<a href="#l9.64"></a><span id="l9.64" class="difflineplus">+      this._livemarks =</span>
<a href="#l9.65"></a><span id="l9.65" class="difflineplus">+        Components.classes[&quot;@mozilla.org/browser/livemark-service;2&quot;]</span>
<a href="#l9.66"></a><span id="l9.66" class="difflineplus">+                  .getService(Components.interfaces.nsILivemarkService);</span>
<a href="#l9.67"></a><span id="l9.67" class="difflineplus">+    }</span>
<a href="#l9.68"></a><span id="l9.68" class="difflineplus">+    return this._livemarks;</span>
<a href="#l9.69"></a><span id="l9.69" class="difflineplus">+  },</span>
<a href="#l9.70"></a><span id="l9.70" class="difflineplus">+</span>
<a href="#l9.71"></a><span id="l9.71" class="difflineplus">+  _annotations : null,</span>
<a href="#l9.72"></a><span id="l9.72" class="difflineplus">+  get annotations() {</span>
<a href="#l9.73"></a><span id="l9.73" class="difflineplus">+    if (!this._annotations) {</span>
<a href="#l9.74"></a><span id="l9.74" class="difflineplus">+      this._annotations =</span>
<a href="#l9.75"></a><span id="l9.75" class="difflineplus">+        Components.classes[&quot;@mozilla.org/browser/annotation-service;1&quot;]</span>
<a href="#l9.76"></a><span id="l9.76" class="difflineplus">+                  .getService(Components.interfaces.nsIAnnotationService);</span>
<a href="#l9.77"></a><span id="l9.77" class="difflineplus">+    }</span>
<a href="#l9.78"></a><span id="l9.78" class="difflineplus">+    return this._annotations;</span>
<a href="#l9.79"></a><span id="l9.79" class="difflineplus">+  },</span>
<a href="#l9.80"></a><span id="l9.80" class="difflineplus">+</span>
<a href="#l9.81"></a><span id="l9.81" class="difflineplus">+  _history : null,</span>
<a href="#l9.82"></a><span id="l9.82" class="difflineplus">+  get history() {</span>
<a href="#l9.83"></a><span id="l9.83" class="difflineplus">+    if (!this._history) {</span>
<a href="#l9.84"></a><span id="l9.84" class="difflineplus">+      this._history =</span>
<a href="#l9.85"></a><span id="l9.85" class="difflineplus">+        Components.classes[&quot;@mozilla.org/browser/nav-history-service;1&quot;]</span>
<a href="#l9.86"></a><span id="l9.86" class="difflineplus">+                  .getService(Components.interfaces.nsINavHistoryService);</span>
<a href="#l9.87"></a><span id="l9.87" class="difflineplus">+    }</span>
<a href="#l9.88"></a><span id="l9.88" class="difflineplus">+    return this._history;</span>
<a href="#l9.89"></a><span id="l9.89" class="difflineplus">+  },</span>
<a href="#l9.90"></a><span id="l9.90" class="difflineplus">+</span>
<a href="#l9.91"></a><span id="l9.91" class="difflineplus">+  _windowMediator : null,</span>
<a href="#l9.92"></a><span id="l9.92" class="difflineplus">+  get windowMediator() {</span>
<a href="#l9.93"></a><span id="l9.93" class="difflineplus">+    if (!this._windowMediator) {</span>
<a href="#l9.94"></a><span id="l9.94" class="difflineplus">+      this._windowMediator =</span>
<a href="#l9.95"></a><span id="l9.95" class="difflineplus">+        Components.classes[&quot;@mozilla.org/appshell/window-mediator;1&quot;]</span>
<a href="#l9.96"></a><span id="l9.96" class="difflineplus">+                  .getService(Components.interfaces.nsIWindowMediator);</span>
<a href="#l9.97"></a><span id="l9.97" class="difflineplus">+    }</span>
<a href="#l9.98"></a><span id="l9.98" class="difflineplus">+    return this._windowMediator;</span>
<a href="#l9.99"></a><span id="l9.99" class="difflineplus">+  },</span>
<a href="#l9.100"></a><span id="l9.100" class="difflineplus">+</span>
<a href="#l9.101"></a><span id="l9.101" class="difflineplus">+  makeURI : function(aSpec) {</span>
<a href="#l9.102"></a><span id="l9.102" class="difflineplus">+    if (!aSpec)</span>
<a href="#l9.103"></a><span id="l9.103" class="difflineplus">+      return null;</span>
<a href="#l9.104"></a><span id="l9.104" class="difflineplus">+    var ios = Components.classes[&quot;@mozilla.org/network/io-service;1&quot;]</span>
<a href="#l9.105"></a><span id="l9.105" class="difflineplus">+                        .getService(Components.interfaces.nsIIOService);</span>
<a href="#l9.106"></a><span id="l9.106" class="difflineplus">+    return ios.newURI(aSpec, null, null);</span>
<a href="#l9.107"></a><span id="l9.107" class="difflineplus">+  },</span>
<a href="#l9.108"></a><span id="l9.108" class="difflineplus">+</span>
<a href="#l9.109"></a><span id="l9.109" class="difflineplus">+  free : function() {</span>
<a href="#l9.110"></a><span id="l9.110" class="difflineplus">+    this._bookmarks = null;</span>
<a href="#l9.111"></a><span id="l9.111" class="difflineplus">+    this._livemarks = null;</span>
<a href="#l9.112"></a><span id="l9.112" class="difflineplus">+    this._annotations = null;</span>
<a href="#l9.113"></a><span id="l9.113" class="difflineplus">+    this._history = null;</span>
<a href="#l9.114"></a><span id="l9.114" class="difflineplus">+    this._windowMediator = null;</span>
<a href="#l9.115"></a><span id="l9.115" class="difflineplus">+  }</span>
<a href="#l9.116"></a><span id="l9.116" class="difflineplus">+};</span>
<a href="#l9.117"></a><span id="l9.117" class="difflineplus">+</span>
<a href="#l9.118"></a><span id="l9.118" class="difflineplus">+</span>
<a href="#l9.119"></a><span id="l9.119" class="difflineplus">+//=================================================</span>
<a href="#l9.120"></a><span id="l9.120" class="difflineplus">+// Window implementation</span>
<a href="#l9.121"></a><span id="l9.121" class="difflineplus">+function Window(aWindow) {</span>
<a href="#l9.122"></a><span id="l9.122" class="difflineplus">+  this._window = aWindow;</span>
<a href="#l9.123"></a><span id="l9.123" class="difflineplus">+  this._tabbrowser = aWindow.getBrowser();</span>
<a href="#l9.124"></a><span id="l9.124" class="difflineplus">+  this._events = new Events();</span>
<a href="#l9.125"></a><span id="l9.125" class="difflineplus">+  this._cleanup = {};</span>
<a href="#l9.126"></a><span id="l9.126" class="difflineplus">+</span>
<a href="#l9.127"></a><span id="l9.127" class="difflineplus">+  this._watch(&quot;TabOpen&quot;);</span>
<a href="#l9.128"></a><span id="l9.128" class="difflineplus">+  this._watch(&quot;TabMove&quot;);</span>
<a href="#l9.129"></a><span id="l9.129" class="difflineplus">+  this._watch(&quot;TabClose&quot;);</span>
<a href="#l9.130"></a><span id="l9.130" class="difflineplus">+  this._watch(&quot;TabSelect&quot;);</span>
<a href="#l9.131"></a><span id="l9.131" class="difflineplus">+</span>
<a href="#l9.132"></a><span id="l9.132" class="difflineplus">+  var self = this;</span>
<a href="#l9.133"></a><span id="l9.133" class="difflineplus">+  gShutdown.push(function() { self._shutdown(); });</span>
<a href="#l9.134"></a><span id="l9.134" class="difflineplus">+}</span>
<a href="#l9.135"></a><span id="l9.135" class="difflineplus">+</span>
<a href="#l9.136"></a><span id="l9.136" class="difflineplus">+Window.prototype = {</span>
<a href="#l9.137"></a><span id="l9.137" class="difflineplus">+  get events() {</span>
<a href="#l9.138"></a><span id="l9.138" class="difflineplus">+    return this._events;</span>
<a href="#l9.139"></a><span id="l9.139" class="difflineplus">+  },</span>
<a href="#l9.140"></a><span id="l9.140" class="difflineplus">+</span>
<a href="#l9.141"></a><span id="l9.141" class="difflineplus">+  /*</span>
<a href="#l9.142"></a><span id="l9.142" class="difflineplus">+   * Helper used to setup event handlers on the XBL element. Note that the events</span>
<a href="#l9.143"></a><span id="l9.143" class="difflineplus">+   * are actually dispatched to tabs, so we capture them.</span>
<a href="#l9.144"></a><span id="l9.144" class="difflineplus">+   */</span>
<a href="#l9.145"></a><span id="l9.145" class="difflineplus">+  _watch : function win_watch(aType) {</span>
<a href="#l9.146"></a><span id="l9.146" class="difflineplus">+    var self = this;</span>
<a href="#l9.147"></a><span id="l9.147" class="difflineplus">+    this._tabbrowser.addEventListener(aType,</span>
<a href="#l9.148"></a><span id="l9.148" class="difflineplus">+      this._cleanup[aType] = function(e){ self._event(e); },</span>
<a href="#l9.149"></a><span id="l9.149" class="difflineplus">+      true);</span>
<a href="#l9.150"></a><span id="l9.150" class="difflineplus">+  },</span>
<a href="#l9.151"></a><span id="l9.151" class="difflineplus">+</span>
<a href="#l9.152"></a><span id="l9.152" class="difflineplus">+  /*</span>
<a href="#l9.153"></a><span id="l9.153" class="difflineplus">+   * Helper event callback used to redirect events made on the XBL element</span>
<a href="#l9.154"></a><span id="l9.154" class="difflineplus">+   */</span>
<a href="#l9.155"></a><span id="l9.155" class="difflineplus">+  _event : function win_event(aEvent) {</span>
<a href="#l9.156"></a><span id="l9.156" class="difflineplus">+    this._events.dispatch(aEvent.type, new BrowserTab(this, aEvent.originalTarget));</span>
<a href="#l9.157"></a><span id="l9.157" class="difflineplus">+  },</span>
<a href="#l9.158"></a><span id="l9.158" class="difflineplus">+</span>
<a href="#l9.159"></a><span id="l9.159" class="difflineplus">+  get tabs() {</span>
<a href="#l9.160"></a><span id="l9.160" class="difflineplus">+    var tabs = [];</span>
<a href="#l9.161"></a><span id="l9.161" class="difflineplus">+    var mTabs = this._tabbrowser.mTabs;</span>
<a href="#l9.162"></a><span id="l9.162" class="difflineplus">+    for (var i = 0; i &lt; mTabs.length; i++)</span>
<a href="#l9.163"></a><span id="l9.163" class="difflineplus">+      tabs.push(new BrowserTab(this, mTabs[i]));</span>
<a href="#l9.164"></a><span id="l9.164" class="difflineplus">+    return tabs;</span>
<a href="#l9.165"></a><span id="l9.165" class="difflineplus">+  },</span>
<a href="#l9.166"></a><span id="l9.166" class="difflineplus">+</span>
<a href="#l9.167"></a><span id="l9.167" class="difflineplus">+  get activeTab() {</span>
<a href="#l9.168"></a><span id="l9.168" class="difflineplus">+    return new BrowserTab(this, this._tabbrowser.selectedTab);</span>
<a href="#l9.169"></a><span id="l9.169" class="difflineplus">+  },</span>
<a href="#l9.170"></a><span id="l9.170" class="difflineplus">+</span>
<a href="#l9.171"></a><span id="l9.171" class="difflineplus">+  open : function win_open(aURI) {</span>
<a href="#l9.172"></a><span id="l9.172" class="difflineplus">+    return new BrowserTab(this, this._tabbrowser.addTab(aURI.spec));</span>
<a href="#l9.173"></a><span id="l9.173" class="difflineplus">+  },</span>
<a href="#l9.174"></a><span id="l9.174" class="difflineplus">+</span>
<a href="#l9.175"></a><span id="l9.175" class="difflineplus">+  _shutdown : function win_shutdown() {</span>
<a href="#l9.176"></a><span id="l9.176" class="difflineplus">+    for (var type in this._cleanup)</span>
<a href="#l9.177"></a><span id="l9.177" class="difflineplus">+      this._tabbrowser.removeEventListener(type, this._cleanup[type], true);</span>
<a href="#l9.178"></a><span id="l9.178" class="difflineplus">+    this._cleanup = null;</span>
<a href="#l9.179"></a><span id="l9.179" class="difflineplus">+</span>
<a href="#l9.180"></a><span id="l9.180" class="difflineplus">+    this._window = null;</span>
<a href="#l9.181"></a><span id="l9.181" class="difflineplus">+    this._tabbrowser = null;</span>
<a href="#l9.182"></a><span id="l9.182" class="difflineplus">+    this._events = null;</span>
<a href="#l9.183"></a><span id="l9.183" class="difflineplus">+  },</span>
<a href="#l9.184"></a><span id="l9.184" class="difflineplus">+</span>
<a href="#l9.185"></a><span id="l9.185" class="difflineplus">+  QueryInterface : XPCOMUtils.generateQI([Components.interfaces.smileIWindow])</span>
<a href="#l9.186"></a><span id="l9.186" class="difflineplus">+};</span>
<a href="#l9.187"></a><span id="l9.187" class="difflineplus">+</span>
<a href="#l9.188"></a><span id="l9.188" class="difflineplus">+</span>
<a href="#l9.189"></a><span id="l9.189" class="difflineplus">+//=================================================</span>
<a href="#l9.190"></a><span id="l9.190" class="difflineplus">+// BrowserTab implementation</span>
<a href="#l9.191"></a><span id="l9.191" class="difflineplus">+function BrowserTab(aSMILEWindow, aTab) {</span>
<a href="#l9.192"></a><span id="l9.192" class="difflineplus">+  this._window = aSMILEWindow;</span>
<a href="#l9.193"></a><span id="l9.193" class="difflineplus">+  this._tabbrowser = aSMILEWindow._tabbrowser;</span>
<a href="#l9.194"></a><span id="l9.194" class="difflineplus">+  this._browser = aTab.linkedBrowser;</span>
<a href="#l9.195"></a><span id="l9.195" class="difflineplus">+  this._tab = aTab;</span>
<a href="#l9.196"></a><span id="l9.196" class="difflineplus">+  this._events = new Events();</span>
<a href="#l9.197"></a><span id="l9.197" class="difflineplus">+  this._cleanup = {};</span>
<a href="#l9.198"></a><span id="l9.198" class="difflineplus">+</span>
<a href="#l9.199"></a><span id="l9.199" class="difflineplus">+  this._watch(&quot;load&quot;);</span>
<a href="#l9.200"></a><span id="l9.200" class="difflineplus">+</span>
<a href="#l9.201"></a><span id="l9.201" class="difflineplus">+  var self = this;</span>
<a href="#l9.202"></a><span id="l9.202" class="difflineplus">+  gShutdown.push(function() { self._shutdown(); });</span>
<a href="#l9.203"></a><span id="l9.203" class="difflineplus">+}</span>
<a href="#l9.204"></a><span id="l9.204" class="difflineplus">+</span>
<a href="#l9.205"></a><span id="l9.205" class="difflineplus">+BrowserTab.prototype = {</span>
<a href="#l9.206"></a><span id="l9.206" class="difflineplus">+  get uri() {</span>
<a href="#l9.207"></a><span id="l9.207" class="difflineplus">+    return this._browser.currentURI;</span>
<a href="#l9.208"></a><span id="l9.208" class="difflineplus">+  },</span>
<a href="#l9.209"></a><span id="l9.209" class="difflineplus">+</span>
<a href="#l9.210"></a><span id="l9.210" class="difflineplus">+  get index() {</span>
<a href="#l9.211"></a><span id="l9.211" class="difflineplus">+    try {</span>
<a href="#l9.212"></a><span id="l9.212" class="difflineplus">+      return this._tabbrowser.getTabIndex(this._tab);</span>
<a href="#l9.213"></a><span id="l9.213" class="difflineplus">+    }</span>
<a href="#l9.214"></a><span id="l9.214" class="difflineplus">+    catch (e) {</span>
<a href="#l9.215"></a><span id="l9.215" class="difflineplus">+      return -1;</span>
<a href="#l9.216"></a><span id="l9.216" class="difflineplus">+    }</span>
<a href="#l9.217"></a><span id="l9.217" class="difflineplus">+  },</span>
<a href="#l9.218"></a><span id="l9.218" class="difflineplus">+</span>
<a href="#l9.219"></a><span id="l9.219" class="difflineplus">+  get events() {</span>
<a href="#l9.220"></a><span id="l9.220" class="difflineplus">+    return this._events;</span>
<a href="#l9.221"></a><span id="l9.221" class="difflineplus">+  },</span>
<a href="#l9.222"></a><span id="l9.222" class="difflineplus">+</span>
<a href="#l9.223"></a><span id="l9.223" class="difflineplus">+  get window() {</span>
<a href="#l9.224"></a><span id="l9.224" class="difflineplus">+    return this._window;</span>
<a href="#l9.225"></a><span id="l9.225" class="difflineplus">+  },</span>
<a href="#l9.226"></a><span id="l9.226" class="difflineplus">+</span>
<a href="#l9.227"></a><span id="l9.227" class="difflineplus">+  get document() {</span>
<a href="#l9.228"></a><span id="l9.228" class="difflineplus">+    return this._browser.contentDocument;</span>
<a href="#l9.229"></a><span id="l9.229" class="difflineplus">+  },</span>
<a href="#l9.230"></a><span id="l9.230" class="difflineplus">+</span>
<a href="#l9.231"></a><span id="l9.231" class="difflineplus">+  /*</span>
<a href="#l9.232"></a><span id="l9.232" class="difflineplus">+   * Helper used to setup event handlers on the XBL element</span>
<a href="#l9.233"></a><span id="l9.233" class="difflineplus">+   */</span>
<a href="#l9.234"></a><span id="l9.234" class="difflineplus">+  _watch : function bt_watch(aType) {</span>
<a href="#l9.235"></a><span id="l9.235" class="difflineplus">+    var self = this;</span>
<a href="#l9.236"></a><span id="l9.236" class="difflineplus">+    this._browser.addEventListener(aType,</span>
<a href="#l9.237"></a><span id="l9.237" class="difflineplus">+      this._cleanup[aType] = function(e){ self._event(e); },</span>
<a href="#l9.238"></a><span id="l9.238" class="difflineplus">+      true);</span>
<a href="#l9.239"></a><span id="l9.239" class="difflineplus">+  },</span>
<a href="#l9.240"></a><span id="l9.240" class="difflineplus">+</span>
<a href="#l9.241"></a><span id="l9.241" class="difflineplus">+  /*</span>
<a href="#l9.242"></a><span id="l9.242" class="difflineplus">+   * Helper event callback used to redirect events made on the XBL element</span>
<a href="#l9.243"></a><span id="l9.243" class="difflineplus">+   */</span>
<a href="#l9.244"></a><span id="l9.244" class="difflineplus">+  _event : function bt_event(aEvent) {</span>
<a href="#l9.245"></a><span id="l9.245" class="difflineplus">+    if (aEvent.type == &quot;load&quot;) {</span>
<a href="#l9.246"></a><span id="l9.246" class="difflineplus">+      if (!(aEvent.originalTarget instanceof Components.interfaces.nsIDOMDocument))</span>
<a href="#l9.247"></a><span id="l9.247" class="difflineplus">+        return;</span>
<a href="#l9.248"></a><span id="l9.248" class="difflineplus">+</span>
<a href="#l9.249"></a><span id="l9.249" class="difflineplus">+      if (aEvent.originalTarget.defaultView instanceof Components.interfaces.nsIDOMWindowInternal &amp;&amp;</span>
<a href="#l9.250"></a><span id="l9.250" class="difflineplus">+          aEvent.originalTarget.defaultView.frameElement)</span>
<a href="#l9.251"></a><span id="l9.251" class="difflineplus">+        return;</span>
<a href="#l9.252"></a><span id="l9.252" class="difflineplus">+    }</span>
<a href="#l9.253"></a><span id="l9.253" class="difflineplus">+    this._events.dispatch(aEvent.type, this);</span>
<a href="#l9.254"></a><span id="l9.254" class="difflineplus">+  },</span>
<a href="#l9.255"></a><span id="l9.255" class="difflineplus">+</span>
<a href="#l9.256"></a><span id="l9.256" class="difflineplus">+  load : function bt_load(aURI) {</span>
<a href="#l9.257"></a><span id="l9.257" class="difflineplus">+    this._browser.loadURI(aURI.spec, null, null);</span>
<a href="#l9.258"></a><span id="l9.258" class="difflineplus">+  },</span>
<a href="#l9.259"></a><span id="l9.259" class="difflineplus">+</span>
<a href="#l9.260"></a><span id="l9.260" class="difflineplus">+  focus : function bt_focus() {</span>
<a href="#l9.261"></a><span id="l9.261" class="difflineplus">+    this._tabbrowser.selectedTab = this._tab;</span>
<a href="#l9.262"></a><span id="l9.262" class="difflineplus">+    this._tabbrowser.focus();</span>
<a href="#l9.263"></a><span id="l9.263" class="difflineplus">+  },</span>
<a href="#l9.264"></a><span id="l9.264" class="difflineplus">+</span>
<a href="#l9.265"></a><span id="l9.265" class="difflineplus">+  close : function bt_close() {</span>
<a href="#l9.266"></a><span id="l9.266" class="difflineplus">+    this._tabbrowser.removeTab(this._tab);</span>
<a href="#l9.267"></a><span id="l9.267" class="difflineplus">+  },</span>
<a href="#l9.268"></a><span id="l9.268" class="difflineplus">+</span>
<a href="#l9.269"></a><span id="l9.269" class="difflineplus">+  moveBefore : function bt_movebefore(aBefore) {</span>
<a href="#l9.270"></a><span id="l9.270" class="difflineplus">+    this._tabbrowser.moveTabTo(this._tab, aBefore.index);</span>
<a href="#l9.271"></a><span id="l9.271" class="difflineplus">+  },</span>
<a href="#l9.272"></a><span id="l9.272" class="difflineplus">+</span>
<a href="#l9.273"></a><span id="l9.273" class="difflineplus">+  moveToEnd : function bt_moveend() {</span>
<a href="#l9.274"></a><span id="l9.274" class="difflineplus">+    this._tabbrowser.moveTabTo(this._tab, this._tabbrowser.browsers.length);</span>
<a href="#l9.275"></a><span id="l9.275" class="difflineplus">+  },</span>
<a href="#l9.276"></a><span id="l9.276" class="difflineplus">+</span>
<a href="#l9.277"></a><span id="l9.277" class="difflineplus">+  _shutdown : function bt_shutdown() {</span>
<a href="#l9.278"></a><span id="l9.278" class="difflineplus">+    for (var type in this._cleanup)</span>
<a href="#l9.279"></a><span id="l9.279" class="difflineplus">+      this._browser.removeEventListener(type, this._cleanup[type], true);</span>
<a href="#l9.280"></a><span id="l9.280" class="difflineplus">+    this._cleanup = null;</span>
<a href="#l9.281"></a><span id="l9.281" class="difflineplus">+</span>
<a href="#l9.282"></a><span id="l9.282" class="difflineplus">+    this._window = null;</span>
<a href="#l9.283"></a><span id="l9.283" class="difflineplus">+    this._tabbrowser = null;</span>
<a href="#l9.284"></a><span id="l9.284" class="difflineplus">+    this._browser = null;</span>
<a href="#l9.285"></a><span id="l9.285" class="difflineplus">+    this._tab = null;</span>
<a href="#l9.286"></a><span id="l9.286" class="difflineplus">+    this._events = null;</span>
<a href="#l9.287"></a><span id="l9.287" class="difflineplus">+  },</span>
<a href="#l9.288"></a><span id="l9.288" class="difflineplus">+</span>
<a href="#l9.289"></a><span id="l9.289" class="difflineplus">+  QueryInterface : XPCOMUtils.generateQI([Components.interfaces.smileIBrowserTab])</span>
<a href="#l9.290"></a><span id="l9.290" class="difflineplus">+};</span>
<a href="#l9.291"></a><span id="l9.291" class="difflineplus">+</span>
<a href="#l9.292"></a><span id="l9.292" class="difflineplus">+</span>
<a href="#l9.293"></a><span id="l9.293" class="difflineplus">+//=================================================</span>
<a href="#l9.294"></a><span id="l9.294" class="difflineplus">+// Factory - Treat Application as a singleton</span>
<a href="#l9.295"></a><span id="l9.295" class="difflineplus">+// XXX This is required, because we're registered for the 'JavaScript global</span>
<a href="#l9.296"></a><span id="l9.296" class="difflineplus">+// privileged property' category, whose handler always calls createInstance.</span>
<a href="#l9.297"></a><span id="l9.297" class="difflineplus">+// See bug 386535.</span>
<a href="#l9.298"></a><span id="l9.298" class="difflineplus">+var gSingleton = null;</span>
<a href="#l9.299"></a><span id="l9.299" class="difflineplus">+var ApplicationFactory = {</span>
<a href="#l9.300"></a><span id="l9.300" class="difflineplus">+  createInstance: function af_ci(aOuter, aIID) {</span>
<a href="#l9.301"></a><span id="l9.301" class="difflineplus">+    if (aOuter != null)</span>
<a href="#l9.302"></a><span id="l9.302" class="difflineplus">+      throw Components.results.NS_ERROR_NO_AGGREGATION;</span>
<a href="#l9.303"></a><span id="l9.303" class="difflineplus">+</span>
<a href="#l9.304"></a><span id="l9.304" class="difflineplus">+    if (gSingleton == null) {</span>
<a href="#l9.305"></a><span id="l9.305" class="difflineplus">+      gSingleton = new Application();</span>
<a href="#l9.306"></a><span id="l9.306" class="difflineplus">+    }</span>
<a href="#l9.307"></a><span id="l9.307" class="difflineplus">+</span>
<a href="#l9.308"></a><span id="l9.308" class="difflineplus">+    return gSingleton.QueryInterface(aIID);</span>
<a href="#l9.309"></a><span id="l9.309" class="difflineplus">+  }</span>
<a href="#l9.310"></a><span id="l9.310" class="difflineplus">+};</span>
<a href="#l9.311"></a><span id="l9.311" class="difflineplus">+</span>
<a href="#l9.312"></a><span id="l9.312" class="difflineplus">+</span>
<a href="#l9.313"></a><span id="l9.313" class="difflineplus">+</span>
<a href="#l9.314"></a><span id="l9.314" class="difflineplus">+//=================================================</span>
<a href="#l9.315"></a><span id="l9.315" class="difflineplus">+// Application constructor</span>
<a href="#l9.316"></a><span id="l9.316" class="difflineplus">+function Application() {</span>
<a href="#l9.317"></a><span id="l9.317" class="difflineplus">+  this.initToolkitHelpers();</span>
<a href="#l9.318"></a><span id="l9.318" class="difflineplus">+  this._bookmarks = null;</span>
<a href="#l9.319"></a><span id="l9.319" class="difflineplus">+}</span>
<a href="#l9.320"></a><span id="l9.320" class="difflineplus">+</span>
<a href="#l9.321"></a><span id="l9.321" class="difflineplus">+//=================================================</span>
<a href="#l9.322"></a><span id="l9.322" class="difflineplus">+// Application implementation</span>
<a href="#l9.323"></a><span id="l9.323" class="difflineplus">+Application.prototype = {</span>
<a href="#l9.324"></a><span id="l9.324" class="difflineplus">+  // for nsIClassInfo + XPCOMUtils</span>
<a href="#l9.325"></a><span id="l9.325" class="difflineplus">+  classDescription: &quot;Application&quot;,</span>
<a href="#l9.326"></a><span id="l9.326" class="difflineplus">+  classID:          Components.ID(&quot;c9ba8f65-c936-4ac6-a859-8936832b0c12&quot;),</span>
<a href="#l9.327"></a><span id="l9.327" class="difflineplus">+  contractID:       &quot;@mozilla.org/smile/application;1&quot;,</span>
<a href="#l9.328"></a><span id="l9.328" class="difflineplus">+</span>
<a href="#l9.329"></a><span id="l9.329" class="difflineplus">+  // redefine the default factory for XPCOMUtils</span>
<a href="#l9.330"></a><span id="l9.330" class="difflineplus">+  _xpcom_factory: ApplicationFactory,</span>
<a href="#l9.331"></a><span id="l9.331" class="difflineplus">+</span>
<a href="#l9.332"></a><span id="l9.332" class="difflineplus">+  // for nsISupports</span>
<a href="#l9.333"></a><span id="l9.333" class="difflineplus">+  QueryInterface : XPCOMUtils.generateQI(</span>
<a href="#l9.334"></a><span id="l9.334" class="difflineplus">+                     [Components.interfaces.smileIApplication,</span>
<a href="#l9.335"></a><span id="l9.335" class="difflineplus">+                      Components.interfaces.extIApplication,</span>
<a href="#l9.336"></a><span id="l9.336" class="difflineplus">+                      Components.interfaces.nsIObserver,</span>
<a href="#l9.337"></a><span id="l9.337" class="difflineplus">+                      Components.interfaces.nsIClassInfo]),</span>
<a href="#l9.338"></a><span id="l9.338" class="difflineplus">+</span>
<a href="#l9.339"></a><span id="l9.339" class="difflineplus">+  getInterfaces : function app_gi(aCount) {</span>
<a href="#l9.340"></a><span id="l9.340" class="difflineplus">+   var interfaces = [Components.interfaces.smileIApplication,</span>
<a href="#l9.341"></a><span id="l9.341" class="difflineplus">+                     Components.interfaces.extIApplication,</span>
<a href="#l9.342"></a><span id="l9.342" class="difflineplus">+                     Components.interfaces.nsIObserver,</span>
<a href="#l9.343"></a><span id="l9.343" class="difflineplus">+                     Components.interfaces.nsIClassInfo];</span>
<a href="#l9.344"></a><span id="l9.344" class="difflineplus">+    aCount.value = interfaces.length;</span>
<a href="#l9.345"></a><span id="l9.345" class="difflineplus">+    return interfaces;</span>
<a href="#l9.346"></a><span id="l9.346" class="difflineplus">+  },</span>
<a href="#l9.347"></a><span id="l9.347" class="difflineplus">+</span>
<a href="#l9.348"></a><span id="l9.348" class="difflineplus">+  // for nsIObserver</span>
<a href="#l9.349"></a><span id="l9.349" class="difflineplus">+  observe: function app_observe(aSubject, aTopic, aData) {</span>
<a href="#l9.350"></a><span id="l9.350" class="difflineplus">+    // Call the extApplication version of this function first</span>
<a href="#l9.351"></a><span id="l9.351" class="difflineplus">+    this.__proto__.__proto__.observe.call(this, aSubject, aTopic, aData);</span>
<a href="#l9.352"></a><span id="l9.352" class="difflineplus">+    if (aTopic == &quot;xpcom-shutdown&quot;) {</span>
<a href="#l9.353"></a><span id="l9.353" class="difflineplus">+      this._bookmarks = null;</span>
<a href="#l9.354"></a><span id="l9.354" class="difflineplus">+      Utilities.free();</span>
<a href="#l9.355"></a><span id="l9.355" class="difflineplus">+    }</span>
<a href="#l9.356"></a><span id="l9.356" class="difflineplus">+  },</span>
<a href="#l9.357"></a><span id="l9.357" class="difflineplus">+</span>
<a href="#l9.358"></a><span id="l9.358" class="difflineplus">+  /*</span>
<a href="#l9.359"></a><span id="l9.359" class="difflineplus">+   Uncomment once Places Bookmarks migration is complete.</span>
<a href="#l9.360"></a><span id="l9.360" class="difflineplus">+   get bookmarks() {</span>
<a href="#l9.361"></a><span id="l9.361" class="difflineplus">+</span>
<a href="#l9.362"></a><span id="l9.362" class="difflineplus">+     if (this._bookmarks == null)</span>
<a href="#l9.363"></a><span id="l9.363" class="difflineplus">+      this._bookmarks = new BookmarkRoots();</span>
<a href="#l9.364"></a><span id="l9.364" class="difflineplus">+</span>
<a href="#l9.365"></a><span id="l9.365" class="difflineplus">+    return this._bookmarks;</span>
<a href="#l9.366"></a><span id="l9.366" class="difflineplus">+  },*/</span>
<a href="#l9.367"></a><span id="l9.367" class="difflineplus">+</span>
<a href="#l9.368"></a><span id="l9.368" class="difflineplus">+  get windows() {</span>
<a href="#l9.369"></a><span id="l9.369" class="difflineplus">+    var win = [];</span>
<a href="#l9.370"></a><span id="l9.370" class="difflineplus">+    var enum = Utilities.windowMediator.getEnumerator(&quot;navigator:browser&quot;);</span>
<a href="#l9.371"></a><span id="l9.371" class="difflineplus">+</span>
<a href="#l9.372"></a><span id="l9.372" class="difflineplus">+    while (enum.hasMoreElements())</span>
<a href="#l9.373"></a><span id="l9.373" class="difflineplus">+      win.push(new Window(enum.getNext()));</span>
<a href="#l9.374"></a><span id="l9.374" class="difflineplus">+</span>
<a href="#l9.375"></a><span id="l9.375" class="difflineplus">+    return win;</span>
<a href="#l9.376"></a><span id="l9.376" class="difflineplus">+  },</span>
<a href="#l9.377"></a><span id="l9.377" class="difflineplus">+</span>
<a href="#l9.378"></a><span id="l9.378" class="difflineplus">+  get activeWindow() {</span>
<a href="#l9.379"></a><span id="l9.379" class="difflineplus">+    return new Window(Utilities.windowMediator.getMostRecentWindow(&quot;navigator:browser&quot;));</span>
<a href="#l9.380"></a><span id="l9.380" class="difflineplus">+  }</span>
<a href="#l9.381"></a><span id="l9.381" class="difflineplus">+};</span>
<a href="#l9.382"></a><span id="l9.382" class="difflineplus">+</span>
<a href="#l9.383"></a><span id="l9.383" class="difflineplus">+//module initialization</span>
<a href="#l9.384"></a><span id="l9.384" class="difflineplus">+function NSGetModule(aCompMgr, aFileSpec) {</span>
<a href="#l9.385"></a><span id="l9.385" class="difflineplus">+  // set the proto, defined in extApplication.js</span>
<a href="#l9.386"></a><span id="l9.386" class="difflineplus">+  Application.prototype.__proto__ = extApplication.prototype;</span>
<a href="#l9.387"></a><span id="l9.387" class="difflineplus">+  return XPCOMUtils.generateModule([Application]);</span>
<a href="#l9.388"></a><span id="l9.388" class="difflineplus">+}</span>
<a href="#l9.389"></a><span id="l9.389" class="difflineplus">+</span>
<a href="#l9.390"></a><span id="l9.390" class="difflineplus">+#include ../../../mozilla/toolkit/components/exthelper/extApplication.js</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">new file mode 100644</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineminus">--- /dev/null</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineplus">+++ b/suite/smile/test/ContentA.html</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineat">@@ -0,0 +1,12 @@</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineplus">+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<a href="#l10.6"></a><span id="l10.6" class="difflineplus">+&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;</span>
<a href="#l10.7"></a><span id="l10.7" class="difflineplus">+&lt;head&gt;</span>
<a href="#l10.8"></a><span id="l10.8" class="difflineplus">+    &lt;title&gt;Content Page A&lt;/title&gt;</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineplus">+&lt;/head&gt;</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineplus">+&lt;body&gt;</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineplus">+&lt;h1&gt;Content Page A&lt;/h1&gt;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+&lt;div id=&quot;desc&quot;&gt;This is a simple content page used for testing SMILE Browser API&lt;/div&gt;</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+&lt;div id=&quot;test1&quot;&gt;A&lt;/div&gt;</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+&lt;div id=&quot;test2&quot;&gt;B&lt;/div&gt;</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+&lt;/body&gt;</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineplus">+&lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">new file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- /dev/null</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ b/suite/smile/test/ContentB.html</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -0,0 +1,12 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineplus">+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineplus">+&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineplus">+&lt;head&gt;</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineplus">+    &lt;title&gt;Content Page B&lt;/title&gt;</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineplus">+&lt;/head&gt;</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineplus">+&lt;body&gt;</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineplus">+&lt;h1&gt;Content Page B&lt;/h1&gt;</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+&lt;div id=&quot;desc&quot;&gt;This is a simple content page used for testing SMILE Browser API&lt;/div&gt;</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+&lt;div id=&quot;test1&quot;&gt;1&lt;/div&gt;</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+&lt;div id=&quot;test2&quot;&gt;2&lt;/div&gt;</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+&lt;/body&gt;</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+&lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">new file mode 100644</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineminus">--- /dev/null</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineplus">+++ b/suite/smile/test/ContentWithFrames.html</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineat">@@ -0,0 +1,12 @@</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineplus">+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<a href="#l12.6"></a><span id="l12.6" class="difflineplus">+&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;</span>
<a href="#l12.7"></a><span id="l12.7" class="difflineplus">+&lt;head&gt;</span>
<a href="#l12.8"></a><span id="l12.8" class="difflineplus">+    &lt;title&gt;Content Page with Frames&lt;/title&gt;</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineplus">+&lt;/head&gt;</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineplus">+&lt;body&gt;</span>
<a href="#l12.11"></a><span id="l12.11" class="difflineplus">+&lt;h1&gt;Content Page with Frames&lt;/h1&gt;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+&lt;div id=&quot;desc&quot;&gt;This is a simple framed content page used for testing SMILE Browser API&lt;/div&gt;</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+&lt;iframe src=&quot;ContentA.html&quot;&gt;&lt;/iframe&gt;</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+&lt;iframe src=&quot;ContentB.html&quot;&gt;&lt;/iframe&gt;</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+&lt;/body&gt;</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+&lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1">new file mode 100644</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineminus">--- /dev/null</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineplus">+++ b/suite/smile/test/Makefile.in</span>
<a href="#l13.4"></a><span id="l13.4" class="difflineat">@@ -0,0 +1,60 @@</span>
<a href="#l13.5"></a><span id="l13.5" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l13.6"></a><span id="l13.6" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l13.7"></a><span id="l13.7" class="difflineplus">+#</span>
<a href="#l13.8"></a><span id="l13.8" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l13.9"></a><span id="l13.9" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l13.10"></a><span id="l13.10" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l13.11"></a><span id="l13.11" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+#</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineplus">+# License.</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineplus">+#</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineplus">+# The Original Code is SMILE.</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineplus">+#</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineplus">+# The Initial Developer of the Original Code is Mozilla Corporation.</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2006</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineplus">+#</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineplus">+# Contributor(s):</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineplus">+#   Mark Finkle &lt;mfinkle@mozilla.com&gt;</span>
<a href="#l13.26"></a><span id="l13.26" class="difflineplus">+#   John Resig  &lt;jresig@mozilla.com&gt;</span>
<a href="#l13.27"></a><span id="l13.27" class="difflineplus">+#   Jorge Villalobos &lt;jorge.villalobos@gmail.com&gt;</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineplus">+#</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l13.30"></a><span id="l13.30" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l13.33"></a><span id="l13.33" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l13.36"></a><span id="l13.36" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineplus">+#</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineplus">+</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineplus">+DEPTH          = ../../..</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineplus">+topsrcdir      = @top_srcdir@</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineplus">+srcdir         = @srcdir@</span>
<a href="#l13.46"></a><span id="l13.46" class="difflineplus">+VPATH          = @srcdir@</span>
<a href="#l13.47"></a><span id="l13.47" class="difflineplus">+relativesrcdir = suite/smile/test</span>
<a href="#l13.48"></a><span id="l13.48" class="difflineplus">+</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineplus">+include $(DEPTH)/config/autoconf.mk</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineplus">+include $(topsrcdir)/config/rules.mk</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+</span>
<a href="#l13.52"></a><span id="l13.52" class="difflineplus">+_BROWSER_FILES =browser_Application.js \</span>
<a href="#l13.53"></a><span id="l13.53" class="difflineplus">+		browser_ApplicationPrefs.js \</span>
<a href="#l13.54"></a><span id="l13.54" class="difflineplus">+		browser_ApplicationStorage.js \</span>
<a href="#l13.55"></a><span id="l13.55" class="difflineplus">+		browser_ApplicationQuitting.js \</span>
<a href="#l13.56"></a><span id="l13.56" class="difflineplus">+		browser_Browser.js \</span>
<a href="#l13.57"></a><span id="l13.57" class="difflineplus">+		browser_Extensions.js \</span>
<a href="#l13.58"></a><span id="l13.58" class="difflineplus">+		ContentA.html \</span>
<a href="#l13.59"></a><span id="l13.59" class="difflineplus">+		ContentB.html \</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineplus">+		ContentWithFrames.html \</span>
<a href="#l13.61"></a><span id="l13.61" class="difflineplus">+		$(NULL)</span>
<a href="#l13.62"></a><span id="l13.62" class="difflineplus">+</span>
<a href="#l13.63"></a><span id="l13.63" class="difflineplus">+libs::	$(_BROWSER_FILES)</span>
<a href="#l13.64"></a><span id="l13.64" class="difflineplus">+	$(INSTALL) $(foreach f,$^,&quot;$f&quot;) $(MOZDEPTH)/_tests/testing/mochitest/browser/$(relativesrcdir)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1">new file mode 100644</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineminus">--- /dev/null</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineplus">+++ b/suite/smile/test/browser_Application.js</span>
<a href="#l14.4"></a><span id="l14.4" class="difflineat">@@ -0,0 +1,86 @@</span>
<a href="#l14.5"></a><span id="l14.5" class="difflineplus">+const Ci = Components.interfaces;</span>
<a href="#l14.6"></a><span id="l14.6" class="difflineplus">+const Cc = Components.classes;</span>
<a href="#l14.7"></a><span id="l14.7" class="difflineplus">+</span>
<a href="#l14.8"></a><span id="l14.8" class="difflineplus">+// This listens for the next opened window and checks it is of the right url.</span>
<a href="#l14.9"></a><span id="l14.9" class="difflineplus">+// opencallback is called when the new window is fully loaded</span>
<a href="#l14.10"></a><span id="l14.10" class="difflineplus">+// closecallback is called when the window is closed</span>
<a href="#l14.11"></a><span id="l14.11" class="difflineplus">+function WindowOpenListener(url, opencallback, closecallback) {</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+  this.url = url;</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+  this.opencallback = opencallback;</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+  this.closecallback = closecallback;</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineplus">+  var wm = Cc[&quot;@mozilla.org/appshell/window-mediator;1&quot;].</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+           getService(Ci.nsIWindowMediator);</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineplus">+  wm.addListener(this);</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineplus">+}</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineplus">+</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineplus">+WindowOpenListener.prototype = {</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineplus">+  url: null,</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineplus">+  opencallback: null,</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineplus">+  closecallback: null,</span>
<a href="#l14.25"></a><span id="l14.25" class="difflineplus">+  window: null,</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineplus">+  domwindow: null,</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineplus">+</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineplus">+  handleEvent: function(event) {</span>
<a href="#l14.29"></a><span id="l14.29" class="difflineplus">+    is(this.domwindow.document.location.href, this.url, &quot;Should have opened the correct window&quot;);</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineplus">+</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineplus">+    this.domwindow.removeEventListener(&quot;load&quot;, this, false);</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+    // Allow any other load handlers to execute</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineplus">+    var self = this;</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineplus">+    executeSoon(function() { self.opencallback(self.domwindow); } );</span>
<a href="#l14.35"></a><span id="l14.35" class="difflineplus">+  },</span>
<a href="#l14.36"></a><span id="l14.36" class="difflineplus">+</span>
<a href="#l14.37"></a><span id="l14.37" class="difflineplus">+  onWindowTitleChange: function(window, title) {</span>
<a href="#l14.38"></a><span id="l14.38" class="difflineplus">+  },</span>
<a href="#l14.39"></a><span id="l14.39" class="difflineplus">+</span>
<a href="#l14.40"></a><span id="l14.40" class="difflineplus">+  onOpenWindow: function(window) {</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineplus">+    if (this.window)</span>
<a href="#l14.42"></a><span id="l14.42" class="difflineplus">+      return;</span>
<a href="#l14.43"></a><span id="l14.43" class="difflineplus">+</span>
<a href="#l14.44"></a><span id="l14.44" class="difflineplus">+    this.window = window;</span>
<a href="#l14.45"></a><span id="l14.45" class="difflineplus">+    this.domwindow = window.QueryInterface(Ci.nsIInterfaceRequestor)</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineplus">+                           .getInterface(Ci.nsIDOMWindowInternal);</span>
<a href="#l14.47"></a><span id="l14.47" class="difflineplus">+    this.domwindow.addEventListener(&quot;load&quot;, this, false);</span>
<a href="#l14.48"></a><span id="l14.48" class="difflineplus">+  },</span>
<a href="#l14.49"></a><span id="l14.49" class="difflineplus">+</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineplus">+  onCloseWindow: function(window) {</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+    if (this.window != window)</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+      return;</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineplus">+</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineplus">+    var wm = Cc[&quot;@mozilla.org/appshell/window-mediator;1&quot;].</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineplus">+             getService(Ci.nsIWindowMediator);</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineplus">+    wm.removeListener(this);</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineplus">+    this.opencallback = null;</span>
<a href="#l14.58"></a><span id="l14.58" class="difflineplus">+    this.window = null;</span>
<a href="#l14.59"></a><span id="l14.59" class="difflineplus">+    this.domwindow = null;</span>
<a href="#l14.60"></a><span id="l14.60" class="difflineplus">+</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineplus">+    // Let the window close complete</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineplus">+    executeSoon(this.closecallback);</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineplus">+    this.closecallback = null;</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineplus">+  }</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineplus">+};</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineplus">+</span>
<a href="#l14.67"></a><span id="l14.67" class="difflineplus">+function test() {</span>
<a href="#l14.68"></a><span id="l14.68" class="difflineplus">+  ok(Application, &quot;Check global access to Application&quot;);</span>
<a href="#l14.69"></a><span id="l14.69" class="difflineplus">+  </span>
<a href="#l14.70"></a><span id="l14.70" class="difflineplus">+  // I'd test these against a specific value, but that is bound to flucuate</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineplus">+  ok(Application.id, &quot;Check to see if an ID exists for the Application&quot;);</span>
<a href="#l14.72"></a><span id="l14.72" class="difflineplus">+  ok(Application.name, &quot;Check to see if a name exists for the Application&quot;);</span>
<a href="#l14.73"></a><span id="l14.73" class="difflineplus">+  ok(Application.version, &quot;Check to see if a version exists for the Application&quot;);</span>
<a href="#l14.74"></a><span id="l14.74" class="difflineplus">+  </span>
<a href="#l14.75"></a><span id="l14.75" class="difflineplus">+  var wMediator = Cc[&quot;@mozilla.org/appshell/window-mediator;1&quot;].getService(Ci.nsIWindowMediator);</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineplus">+  var console = wMediator.getMostRecentWindow(&quot;global:console&quot;);</span>
<a href="#l14.77"></a><span id="l14.77" class="difflineplus">+  waitForExplicitFinish();</span>
<a href="#l14.78"></a><span id="l14.78" class="difflineplus">+  ok(!console, &quot;Console should not already be open&quot;);</span>
<a href="#l14.79"></a><span id="l14.79" class="difflineplus">+</span>
<a href="#l14.80"></a><span id="l14.80" class="difflineplus">+  new WindowOpenListener(&quot;chrome://global/content/console.xul&quot;, consoleOpened, consoleClosed);</span>
<a href="#l14.81"></a><span id="l14.81" class="difflineplus">+  Application.console.open();</span>
<a href="#l14.82"></a><span id="l14.82" class="difflineplus">+}</span>
<a href="#l14.83"></a><span id="l14.83" class="difflineplus">+</span>
<a href="#l14.84"></a><span id="l14.84" class="difflineplus">+function consoleOpened(win) {</span>
<a href="#l14.85"></a><span id="l14.85" class="difflineplus">+  win.close();</span>
<a href="#l14.86"></a><span id="l14.86" class="difflineplus">+}</span>
<a href="#l14.87"></a><span id="l14.87" class="difflineplus">+</span>
<a href="#l14.88"></a><span id="l14.88" class="difflineplus">+function consoleClosed() {</span>
<a href="#l14.89"></a><span id="l14.89" class="difflineplus">+  finish();</span>
<a href="#l14.90"></a><span id="l14.90" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1">new file mode 100644</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineminus">--- /dev/null</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineplus">+++ b/suite/smile/test/browser_ApplicationPrefs.js</span>
<a href="#l15.4"></a><span id="l15.4" class="difflineat">@@ -0,0 +1,170 @@</span>
<a href="#l15.5"></a><span id="l15.5" class="difflineplus">+// The various properties that we'll be testing</span>
<a href="#l15.6"></a><span id="l15.6" class="difflineplus">+var testdata = {</span>
<a href="#l15.7"></a><span id="l15.7" class="difflineplus">+  missing: &quot;smile.smile-test-missing&quot;,</span>
<a href="#l15.8"></a><span id="l15.8" class="difflineplus">+  dummy: &quot;smile.smile-test&quot;,</span>
<a href="#l15.9"></a><span id="l15.9" class="difflineplus">+  string: &quot;browser.active_color&quot;,</span>
<a href="#l15.10"></a><span id="l15.10" class="difflineplus">+  integer: &quot;permissions.default.image&quot;,</span>
<a href="#l15.11"></a><span id="l15.11" class="difflineplus">+  boolean: &quot;browser.blink_allowed&quot;</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineplus">+};</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+function test() {</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+  // test getting non-existing values</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+  var itemValue = Application.prefs.getValue(testdata.missing, &quot;default&quot;);</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineplus">+  is(itemValue, &quot;default&quot;, &quot;Check 'Application.prefs.getValue' for non-existing item&quot;);</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineplus">+</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+  is(Application.prefs.get(testdata.missing), null, &quot;Check 'Application.prefs.get' for non-existing item&quot;);</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineplus">+</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineplus">+  // test setting and getting a value</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineplus">+  Application.prefs.setValue(testdata.dummy, &quot;dummy&quot;);</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+  itemValue = Application.prefs.getValue(testdata.dummy, &quot;default&quot;);</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineplus">+  is(itemValue, &quot;dummy&quot;, &quot;Check 'Application.prefs.getValue' for existing item&quot;);</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+  // test for overwriting an existing value</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineplus">+  Application.prefs.setValue(testdata.dummy, &quot;smarty&quot;);</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineplus">+  itemValue = Application.prefs.getValue(testdata.dummy, &quot;default&quot;);</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineplus">+  is(itemValue, &quot;smarty&quot;, &quot;Check 'Application.prefs.getValue' for overwritten item&quot;);</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineplus">+</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineplus">+  // test setting and getting a value</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+  Application.prefs.get(testdata.dummy).value = &quot;dummy2&quot;;</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineplus">+  itemValue = Application.prefs.get(testdata.dummy).value;</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineplus">+  is(itemValue, &quot;dummy2&quot;, &quot;Check 'Application.prefs.get().value' for existing item&quot;);</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineplus">+</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineplus">+  // test resetting a pref [since there is no default value, the pref should disappear]</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+  Application.prefs.get(testdata.dummy).reset();</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+  itemValue = Application.prefs.getValue(testdata.dummy, &quot;default&quot;);</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineplus">+  is(itemValue, &quot;default&quot;, &quot;Check 'Application.prefs.getValue' for reset pref&quot;);</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineplus">+</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineplus">+  // test to see if a non-existant property exists</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineplus">+  ok(!Application.prefs.has(testdata.dummy), &quot;Check non-existant property for existance&quot;);</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineplus">+</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineplus">+  // PREF: string browser.active_color == #EE0000</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineplus">+</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineplus">+  // test to see if an existing string property exists</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineplus">+  ok(Application.prefs.has(testdata.string), &quot;Check existing string property for existance&quot;);</span>
<a href="#l15.48"></a><span id="l15.48" class="difflineplus">+</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineplus">+  // test accessing a non-existant string property</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineplus">+  var val = Application.prefs.getValue(testdata.dummy, &quot;default&quot;);</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineplus">+  is(val, &quot;default&quot;, &quot;Check non-existant string property for expected value&quot;);</span>
<a href="#l15.52"></a><span id="l15.52" class="difflineplus">+</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineplus">+  // test accessing an existing string property</span>
<a href="#l15.54"></a><span id="l15.54" class="difflineplus">+  var val = Application.prefs.getValue(testdata.string, &quot;default&quot;);</span>
<a href="#l15.55"></a><span id="l15.55" class="difflineplus">+  is(val, &quot;#EE0000&quot;, &quot;Check existing string property for expected value&quot;);</span>
<a href="#l15.56"></a><span id="l15.56" class="difflineplus">+</span>
<a href="#l15.57"></a><span id="l15.57" class="difflineplus">+  // test manipulating an existing string property</span>
<a href="#l15.58"></a><span id="l15.58" class="difflineplus">+  Application.prefs.setValue(testdata.string, &quot;#EF0000&quot;);</span>
<a href="#l15.59"></a><span id="l15.59" class="difflineplus">+  var val = Application.prefs.getValue(testdata.string, &quot;default&quot;);</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineplus">+  is(val, &quot;#EF0000&quot;, &quot;Set existing string property&quot;);</span>
<a href="#l15.61"></a><span id="l15.61" class="difflineplus">+</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineplus">+  // test getting the type of an existing string property</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineplus">+  var type = Application.prefs.get(testdata.string).type;</span>
<a href="#l15.64"></a><span id="l15.64" class="difflineplus">+  is(type, &quot;String&quot;, &quot;Check 'Application.prefs.get().type' for string pref&quot;);</span>
<a href="#l15.65"></a><span id="l15.65" class="difflineplus">+</span>
<a href="#l15.66"></a><span id="l15.66" class="difflineplus">+  // test resetting an existing string property</span>
<a href="#l15.67"></a><span id="l15.67" class="difflineplus">+  Application.prefs.get(testdata.string).reset();</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineplus">+  var val = Application.prefs.getValue(testdata.string, &quot;default&quot;);</span>
<a href="#l15.69"></a><span id="l15.69" class="difflineplus">+  is(val, &quot;#EE0000&quot;, &quot;Reset existing string property&quot;);</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineplus">+</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineplus">+  // PREF: integer permissions.default.image == 1</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineplus">+</span>
<a href="#l15.73"></a><span id="l15.73" class="difflineplus">+  // test to see if an existing integer property exists</span>
<a href="#l15.74"></a><span id="l15.74" class="difflineplus">+  ok(Application.prefs.has(testdata.integer), &quot;Check existing integer property for existance&quot;);</span>
<a href="#l15.75"></a><span id="l15.75" class="difflineplus">+</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineplus">+  // test accessing a non-existant integer property</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineplus">+  var val = Application.prefs.getValue(testdata.dummy, 0);</span>
<a href="#l15.78"></a><span id="l15.78" class="difflineplus">+  is(val, 0, &quot;Check non-existant integer property for expected value&quot;);</span>
<a href="#l15.79"></a><span id="l15.79" class="difflineplus">+</span>
<a href="#l15.80"></a><span id="l15.80" class="difflineplus">+  // test accessing an existing integer property</span>
<a href="#l15.81"></a><span id="l15.81" class="difflineplus">+  var val = Application.prefs.getValue(testdata.integer, 0);</span>
<a href="#l15.82"></a><span id="l15.82" class="difflineplus">+  is(val, 1, &quot;Check existing integer property for expected value&quot;);</span>
<a href="#l15.83"></a><span id="l15.83" class="difflineplus">+</span>
<a href="#l15.84"></a><span id="l15.84" class="difflineplus">+  // test manipulating an existing integer property</span>
<a href="#l15.85"></a><span id="l15.85" class="difflineplus">+  Application.prefs.setValue(testdata.integer, 0);</span>
<a href="#l15.86"></a><span id="l15.86" class="difflineplus">+  var val = Application.prefs.getValue(testdata.integer, 1);</span>
<a href="#l15.87"></a><span id="l15.87" class="difflineplus">+  is(val, 0, &quot;Set existing integer property&quot;);</span>
<a href="#l15.88"></a><span id="l15.88" class="difflineplus">+</span>
<a href="#l15.89"></a><span id="l15.89" class="difflineplus">+  // test getting the type of an existing integer property</span>
<a href="#l15.90"></a><span id="l15.90" class="difflineplus">+  var type = Application.prefs.get(testdata.integer).type;</span>
<a href="#l15.91"></a><span id="l15.91" class="difflineplus">+  is(type, &quot;Number&quot;, &quot;Check 'Application.prefs.get().type' for integer pref&quot;);</span>
<a href="#l15.92"></a><span id="l15.92" class="difflineplus">+</span>
<a href="#l15.93"></a><span id="l15.93" class="difflineplus">+  // test resetting an existing integer property</span>
<a href="#l15.94"></a><span id="l15.94" class="difflineplus">+  Application.prefs.get(testdata.integer).reset();</span>
<a href="#l15.95"></a><span id="l15.95" class="difflineplus">+  var val = Application.prefs.getValue(testdata.integer, 0);</span>
<a href="#l15.96"></a><span id="l15.96" class="difflineplus">+  is(val, 1, &quot;Reset existing integer property&quot;);</span>
<a href="#l15.97"></a><span id="l15.97" class="difflineplus">+</span>
<a href="#l15.98"></a><span id="l15.98" class="difflineplus">+  // PREF: boolean browser.blink_allowed == true</span>
<a href="#l15.99"></a><span id="l15.99" class="difflineplus">+</span>
<a href="#l15.100"></a><span id="l15.100" class="difflineplus">+  // test to see if an existing boolean property exists</span>
<a href="#l15.101"></a><span id="l15.101" class="difflineplus">+  ok(Application.prefs.has(testdata.boolean), &quot;Check existing boolean property for existance&quot;);</span>
<a href="#l15.102"></a><span id="l15.102" class="difflineplus">+</span>
<a href="#l15.103"></a><span id="l15.103" class="difflineplus">+  // test accessing a non-existant boolean property</span>
<a href="#l15.104"></a><span id="l15.104" class="difflineplus">+  var val = Application.prefs.getValue(testdata.dummy, true);</span>
<a href="#l15.105"></a><span id="l15.105" class="difflineplus">+  ok(val, &quot;Check non-existant boolean property for expected value&quot;);</span>
<a href="#l15.106"></a><span id="l15.106" class="difflineplus">+</span>
<a href="#l15.107"></a><span id="l15.107" class="difflineplus">+  // test accessing an existing boolean property</span>
<a href="#l15.108"></a><span id="l15.108" class="difflineplus">+  var val = Application.prefs.getValue(testdata.boolean, false);</span>
<a href="#l15.109"></a><span id="l15.109" class="difflineplus">+  ok(val, &quot;Check existing boolean property for expected value&quot;);</span>
<a href="#l15.110"></a><span id="l15.110" class="difflineplus">+</span>
<a href="#l15.111"></a><span id="l15.111" class="difflineplus">+  // test manipulating an existing boolean property</span>
<a href="#l15.112"></a><span id="l15.112" class="difflineplus">+  Application.prefs.setValue(testdata.boolean, false);</span>
<a href="#l15.113"></a><span id="l15.113" class="difflineplus">+  var val = Application.prefs.getValue(testdata.boolean, true);</span>
<a href="#l15.114"></a><span id="l15.114" class="difflineplus">+  ok(!val, &quot;Set existing boolean property&quot;);</span>
<a href="#l15.115"></a><span id="l15.115" class="difflineplus">+</span>
<a href="#l15.116"></a><span id="l15.116" class="difflineplus">+  // test getting the type of an existing boolean property</span>
<a href="#l15.117"></a><span id="l15.117" class="difflineplus">+  var type = Application.prefs.get(testdata.boolean).type;</span>
<a href="#l15.118"></a><span id="l15.118" class="difflineplus">+  is(type, &quot;Boolean&quot;, &quot;Check 'Application.prefs.get().type' for boolean pref&quot;);</span>
<a href="#l15.119"></a><span id="l15.119" class="difflineplus">+</span>
<a href="#l15.120"></a><span id="l15.120" class="difflineplus">+  // test resetting an existing boolean property</span>
<a href="#l15.121"></a><span id="l15.121" class="difflineplus">+  Application.prefs.get(testdata.boolean).reset();</span>
<a href="#l15.122"></a><span id="l15.122" class="difflineplus">+  var val = Application.prefs.getValue(testdata.boolean, false);</span>
<a href="#l15.123"></a><span id="l15.123" class="difflineplus">+  ok(val, &quot;Reset existing string property for expected value&quot;);</span>
<a href="#l15.124"></a><span id="l15.124" class="difflineplus">+</span>
<a href="#l15.125"></a><span id="l15.125" class="difflineplus">+  // test getting all preferences</span>
<a href="#l15.126"></a><span id="l15.126" class="difflineplus">+  var allPrefs = Application.prefs.all;</span>
<a href="#l15.127"></a><span id="l15.127" class="difflineplus">+  ok(allPrefs.length &gt;= 800, &quot;Check 'Application.prefs.all' for the right number of preferences&quot;);</span>
<a href="#l15.128"></a><span id="l15.128" class="difflineplus">+  ok(allPrefs[0].name.length &gt; 0, &quot;Check 'Application.prefs.all' for a valid name in the starting preference&quot;);</span>
<a href="#l15.129"></a><span id="l15.129" class="difflineplus">+</span>
<a href="#l15.130"></a><span id="l15.130" class="difflineplus">+  // test the value of the preference root</span>
<a href="#l15.131"></a><span id="l15.131" class="difflineplus">+  is(Application.prefs.root, &quot;&quot;, &quot;Check the Application preference root&quot;);</span>
<a href="#l15.132"></a><span id="l15.132" class="difflineplus">+</span>
<a href="#l15.133"></a><span id="l15.133" class="difflineplus">+  // test for user changed preferences</span>
<a href="#l15.134"></a><span id="l15.134" class="difflineplus">+  ok(Application.prefs.get(&quot;browser.shell.checkDefaultBrowser&quot;).modified, &quot;A single preference is marked as modified.&quot;);</span>
<a href="#l15.135"></a><span id="l15.135" class="difflineplus">+  ok(!Application.prefs.get(testdata.string).modified, &quot;A single preference is marked as not modified.&quot;);</span>
<a href="#l15.136"></a><span id="l15.136" class="difflineplus">+</span>
<a href="#l15.137"></a><span id="l15.137" class="difflineplus">+  // test for a locked preference</span>
<a href="#l15.138"></a><span id="l15.138" class="difflineplus">+  var pref = Application.prefs.get(testdata.string);</span>
<a href="#l15.139"></a><span id="l15.139" class="difflineplus">+  ok(!pref.locked, &quot;A single preference should not be locked.&quot;);</span>
<a href="#l15.140"></a><span id="l15.140" class="difflineplus">+</span>
<a href="#l15.141"></a><span id="l15.141" class="difflineplus">+  pref.locked = true;</span>
<a href="#l15.142"></a><span id="l15.142" class="difflineplus">+  ok(pref.locked, &quot;A single preference should be locked.&quot;);</span>
<a href="#l15.143"></a><span id="l15.143" class="difflineplus">+</span>
<a href="#l15.144"></a><span id="l15.144" class="difflineplus">+  try {</span>
<a href="#l15.145"></a><span id="l15.145" class="difflineplus">+    prev.value = &quot;test value&quot;;</span>
<a href="#l15.146"></a><span id="l15.146" class="difflineplus">+</span>
<a href="#l15.147"></a><span id="l15.147" class="difflineplus">+    ok(false, &quot;A locked preference should not be able to be modified.&quot;);</span>
<a href="#l15.148"></a><span id="l15.148" class="difflineplus">+  } catch(e){</span>
<a href="#l15.149"></a><span id="l15.149" class="difflineplus">+    ok(true, &quot;A locked preference should not be able to be modified.&quot;);</span>
<a href="#l15.150"></a><span id="l15.150" class="difflineplus">+  }</span>
<a href="#l15.151"></a><span id="l15.151" class="difflineplus">+</span>
<a href="#l15.152"></a><span id="l15.152" class="difflineplus">+  pref.locked = false;</span>
<a href="#l15.153"></a><span id="l15.153" class="difflineplus">+  ok(!pref.locked, &quot;A single preference should not be locked.&quot;);</span>
<a href="#l15.154"></a><span id="l15.154" class="difflineplus">+</span>
<a href="#l15.155"></a><span id="l15.155" class="difflineplus">+  // check for change event when setting a value</span>
<a href="#l15.156"></a><span id="l15.156" class="difflineplus">+  waitForExplicitFinish();</span>
<a href="#l15.157"></a><span id="l15.157" class="difflineplus">+  Application.prefs.events.addListener(&quot;change&quot;, onPrefChange);</span>
<a href="#l15.158"></a><span id="l15.158" class="difflineplus">+  Application.prefs.setValue(&quot;smile.smile-test&quot;, &quot;change event&quot;);</span>
<a href="#l15.159"></a><span id="l15.159" class="difflineplus">+}</span>
<a href="#l15.160"></a><span id="l15.160" class="difflineplus">+</span>
<a href="#l15.161"></a><span id="l15.161" class="difflineplus">+function onPrefChange(evt) {</span>
<a href="#l15.162"></a><span id="l15.162" class="difflineplus">+  is(evt.data, testdata.dummy, &quot;Check 'Application.prefs.set' fired a change event&quot;);</span>
<a href="#l15.163"></a><span id="l15.163" class="difflineplus">+  Application.prefs.events.removeListener(&quot;change&quot;, onPrefChange);</span>
<a href="#l15.164"></a><span id="l15.164" class="difflineplus">+</span>
<a href="#l15.165"></a><span id="l15.165" class="difflineplus">+  Application.prefs.get(&quot;smile.smile-test&quot;).events.addListener(&quot;change&quot;, onPrefChange2);</span>
<a href="#l15.166"></a><span id="l15.166" class="difflineplus">+  Application.prefs.setValue(&quot;smile.smile-test&quot;, &quot;change event2&quot;);</span>
<a href="#l15.167"></a><span id="l15.167" class="difflineplus">+}</span>
<a href="#l15.168"></a><span id="l15.168" class="difflineplus">+</span>
<a href="#l15.169"></a><span id="l15.169" class="difflineplus">+function onPrefChange2(evt) {</span>
<a href="#l15.170"></a><span id="l15.170" class="difflineplus">+  is(evt.data, testdata.dummy, &quot;Check 'Application.prefs.set' fired a change event for a single preference&quot;);</span>
<a href="#l15.171"></a><span id="l15.171" class="difflineplus">+  Application.prefs.events.removeListener(&quot;change&quot;, onPrefChange2);</span>
<a href="#l15.172"></a><span id="l15.172" class="difflineplus">+</span>
<a href="#l15.173"></a><span id="l15.173" class="difflineplus">+  finish();</span>
<a href="#l15.174"></a><span id="l15.174" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1">new file mode 100644</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineminus">--- /dev/null</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineplus">+++ b/suite/smile/test/browser_ApplicationQuitting.js</span>
<a href="#l16.4"></a><span id="l16.4" class="difflineat">@@ -0,0 +1,21 @@</span>
<a href="#l16.5"></a><span id="l16.5" class="difflineplus">+function test() {</span>
<a href="#l16.6"></a><span id="l16.6" class="difflineplus">+  let quitRequestObserver = {</span>
<a href="#l16.7"></a><span id="l16.7" class="difflineplus">+    observe: function(aSubject, aTopic, aData) {</span>
<a href="#l16.8"></a><span id="l16.8" class="difflineplus">+      ok(aTopic == &quot;quit-application-requested&quot; &amp;&amp;</span>
<a href="#l16.9"></a><span id="l16.9" class="difflineplus">+         aSubject instanceof Components.interfaces.nsISupportsPRBool,</span>
<a href="#l16.10"></a><span id="l16.10" class="difflineplus">+         &quot;Received a quit request we're going to deny&quot;);</span>
<a href="#l16.11"></a><span id="l16.11" class="difflineplus">+      aSubject.data = true;</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineplus">+    }</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+  };</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+  </span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+  // ensure that we don't accidentally quit</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineplus">+  let os = Components.classes[&quot;@mozilla.org/observer-service;1&quot;]</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineplus">+                     .getService(Components.interfaces.nsIObserverService);</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineplus">+  os.addObserver(quitRequestObserver, &quot;quit-application-requested&quot;, false);</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineplus">+  </span>
<a href="#l16.20"></a><span id="l16.20" class="difflineplus">+  ok(!Application.quit(),    &quot;Tried to quit - and didn't succeed&quot;);</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineplus">+  ok(!Application.restart(), &quot;Tried to restart - and didn't succeed&quot;);</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineplus">+  </span>
<a href="#l16.23"></a><span id="l16.23" class="difflineplus">+  // clean up</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineplus">+  os.removeObserver(quitRequestObserver, &quot;quit-application-requested&quot;, false);</span>
<a href="#l16.25"></a><span id="l16.25" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1">new file mode 100644</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineminus">--- /dev/null</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineplus">+++ b/suite/smile/test/browser_ApplicationStorage.js</span>
<a href="#l17.4"></a><span id="l17.4" class="difflineat">@@ -0,0 +1,30 @@</span>
<a href="#l17.5"></a><span id="l17.5" class="difflineplus">+function test() {</span>
<a href="#l17.6"></a><span id="l17.6" class="difflineplus">+  // test for existence of values</span>
<a href="#l17.7"></a><span id="l17.7" class="difflineplus">+  var hasItem = Application.storage.has(&quot;smile-test-missing&quot;);</span>
<a href="#l17.8"></a><span id="l17.8" class="difflineplus">+  is(hasItem, false, &quot;Check 'Application.storage.has' for non-existing item&quot;);</span>
<a href="#l17.9"></a><span id="l17.9" class="difflineplus">+  Application.storage.set(&quot;smile-test&quot;, &quot;dummy&quot;);</span>
<a href="#l17.10"></a><span id="l17.10" class="difflineplus">+  hasItem = Application.storage.has(&quot;smile-test&quot;);</span>
<a href="#l17.11"></a><span id="l17.11" class="difflineplus">+  is(hasItem, true, &quot;Check 'Application.storage.has' for existing item&quot;);</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+  // test getting non-existing and existing values</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+  var itemValue = Application.storage.get(&quot;smile-test-missing&quot;, &quot;default&quot;);</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineplus">+  is(itemValue, &quot;default&quot;, &quot;Check 'Application.storage.get' for non-existing item&quot;);</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+  itemValue = Application.storage.get(&quot;smile-test&quot;, &quot;default&quot;);</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineplus">+  is(itemValue, &quot;dummy&quot;, &quot;Check 'Application.storage.get' for existing item&quot;);</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineplus">+</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineplus">+  // test for overwriting an existing value</span>
<a href="#l17.20"></a><span id="l17.20" class="difflineplus">+  Application.storage.set(&quot;smile-test&quot;, &quot;smarty&quot;);</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineplus">+  itemValue = Application.storage.get(&quot;smile-test&quot;, &quot;default&quot;);</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineplus">+  is(itemValue, &quot;smarty&quot;, &quot;Check 'Application.storage.get' for overwritten item&quot;);</span>
<a href="#l17.23"></a><span id="l17.23" class="difflineplus">+</span>
<a href="#l17.24"></a><span id="l17.24" class="difflineplus">+  // check for change event when setting a value</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineplus">+  waitForExplicitFinish();</span>
<a href="#l17.26"></a><span id="l17.26" class="difflineplus">+  Application.storage.events.addListener(&quot;change&quot;, onStorageChange);</span>
<a href="#l17.27"></a><span id="l17.27" class="difflineplus">+  Application.storage.set(&quot;smile-test&quot;, &quot;change event&quot;);</span>
<a href="#l17.28"></a><span id="l17.28" class="difflineplus">+}</span>
<a href="#l17.29"></a><span id="l17.29" class="difflineplus">+</span>
<a href="#l17.30"></a><span id="l17.30" class="difflineplus">+function onStorageChange(evt) {</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineplus">+  is(evt.data, &quot;smile-test&quot;, &quot;Check 'Application.storage.set' fired a change event&quot;);</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+  Application.storage.events.removeListener(&quot;change&quot;, onStorageChange);</span>
<a href="#l17.33"></a><span id="l17.33" class="difflineplus">+  finish();</span>
<a href="#l17.34"></a><span id="l17.34" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1">new file mode 100644</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineminus">--- /dev/null</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineplus">+++ b/suite/smile/test/browser_Browser.js</span>
<a href="#l18.4"></a><span id="l18.4" class="difflineat">@@ -0,0 +1,159 @@</span>
<a href="#l18.5"></a><span id="l18.5" class="difflineplus">+const Ci = Components.interfaces;</span>
<a href="#l18.6"></a><span id="l18.6" class="difflineplus">+const Cc = Components.classes;</span>
<a href="#l18.7"></a><span id="l18.7" class="difflineplus">+</span>
<a href="#l18.8"></a><span id="l18.8" class="difflineplus">+function url(spec) {</span>
<a href="#l18.9"></a><span id="l18.9" class="difflineplus">+  var ios = Cc[&quot;@mozilla.org/network/io-service;1&quot;].getService(Ci.nsIIOService);</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineplus">+  return ios.newURI(spec, null, null);</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineplus">+}</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineplus">+</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+var gPageA = null;</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineplus">+var gPageB = null;</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineplus">+</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineplus">+// cached data from events</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineplus">+var gTabOpenPageA = null;</span>
<a href="#l18.18"></a><span id="l18.18" class="difflineplus">+var gTabOpenPageB = null;</span>
<a href="#l18.19"></a><span id="l18.19" class="difflineplus">+var gTabOpenCount = 0;</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineplus">+var gTabCloseCount = 0;</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineplus">+var gTabMoveCount = 0;</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineplus">+var gPageLoadCount = 0;</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineplus">+</span>
<a href="#l18.24"></a><span id="l18.24" class="difflineplus">+function test() {</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineplus">+  var windows = Application.windows;</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineplus">+  ok(windows, &quot;Check access to browser windows&quot;);</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineplus">+  ok(windows.length, &quot;There should be at least one browser window open&quot;);</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineplus">+</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineplus">+  var activeWin = Application.activeWindow;</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineplus">+  activeWin.events.addListener(&quot;TabOpen&quot;, onTabOpen);</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+  activeWin.events.addListener(&quot;TabClose&quot;, onTabClose);</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineplus">+  activeWin.events.addListener(&quot;TabMove&quot;, onTabMove);</span>
<a href="#l18.33"></a><span id="l18.33" class="difflineplus">+</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineplus">+  gPageA = activeWin.open(url(&quot;chrome://mochikit/content/browser/suite/smile/test/ContentA.html&quot;));</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineplus">+  gPageA.events.addListener(&quot;load&quot;, onPageAFirstLoad);</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineplus">+</span>
<a href="#l18.37"></a><span id="l18.37" class="difflineplus">+  is(activeWin.tabs.length, 2, &quot;Checking length of 'Browser.tabs' after opening 1 additional tab&quot;);</span>
<a href="#l18.38"></a><span id="l18.38" class="difflineplus">+</span>
<a href="#l18.39"></a><span id="l18.39" class="difflineplus">+  waitForExplicitFinish();</span>
<a href="#l18.40"></a><span id="l18.40" class="difflineplus">+</span>
<a href="#l18.41"></a><span id="l18.41" class="difflineplus">+  function execAfterOpen() {</span>
<a href="#l18.42"></a><span id="l18.42" class="difflineplus">+    executeSoon(afterOpen);</span>
<a href="#l18.43"></a><span id="l18.43" class="difflineplus">+  }</span>
<a href="#l18.44"></a><span id="l18.44" class="difflineplus">+</span>
<a href="#l18.45"></a><span id="l18.45" class="difflineplus">+  function onPageAFirstLoad(event) {</span>
<a href="#l18.46"></a><span id="l18.46" class="difflineplus">+    gPageA.events.removeListener(&quot;load&quot;, onPageAFirstLoad);</span>
<a href="#l18.47"></a><span id="l18.47" class="difflineplus">+    is(gPageA.uri.spec, event.data.uri.spec, &quot;Checking event browser tab is equal to page A&quot;);</span>
<a href="#l18.48"></a><span id="l18.48" class="difflineplus">+</span>
<a href="#l18.49"></a><span id="l18.49" class="difflineplus">+    gPageB = activeWin.open(url(&quot;chrome://mochikit/content/browser/suite/smile/test/ContentB.html&quot;));</span>
<a href="#l18.50"></a><span id="l18.50" class="difflineplus">+    gPageB.events.addListener(&quot;load&quot;, execAfterOpen);</span>
<a href="#l18.51"></a><span id="l18.51" class="difflineplus">+    gPageB.focus();</span>
<a href="#l18.52"></a><span id="l18.52" class="difflineplus">+</span>
<a href="#l18.53"></a><span id="l18.53" class="difflineplus">+    is(activeWin.tabs.length, 3, &quot;Checking length of 'Browser.tabs' after opening a second additional tab&quot;);</span>
<a href="#l18.54"></a><span id="l18.54" class="difflineplus">+    is(activeWin.activeTab.index, gPageB.index, &quot;Checking 'Browser.activeTab' after setting focus&quot;);</span>
<a href="#l18.55"></a><span id="l18.55" class="difflineplus">+  }</span>
<a href="#l18.56"></a><span id="l18.56" class="difflineplus">+</span>
<a href="#l18.57"></a><span id="l18.57" class="difflineplus">+  // need to wait for the url's to be refreshed during the load</span>
<a href="#l18.58"></a><span id="l18.58" class="difflineplus">+  function afterOpen(event) {</span>
<a href="#l18.59"></a><span id="l18.59" class="difflineplus">+    gPageB.events.removeListener(&quot;load&quot;, execAfterOpen);</span>
<a href="#l18.60"></a><span id="l18.60" class="difflineplus">+    // check actuals</span>
<a href="#l18.61"></a><span id="l18.61" class="difflineplus">+    is(gPageA.uri.spec, &quot;chrome://mochikit/content/browser/suite/smile/test/ContentA.html&quot;, &quot;Checking 'BrowserTab.uri' after opening&quot;);</span>
<a href="#l18.62"></a><span id="l18.62" class="difflineplus">+    is(gPageB.uri.spec, &quot;chrome://mochikit/content/browser/suite/smile/test/ContentB.html&quot;, &quot;Checking 'BrowserTab.uri' after opening&quot;);</span>
<a href="#l18.63"></a><span id="l18.63" class="difflineplus">+</span>
<a href="#l18.64"></a><span id="l18.64" class="difflineplus">+    // check cached values from TabOpen event</span>
<a href="#l18.65"></a><span id="l18.65" class="difflineplus">+    is(gPageA.uri.spec, gTabOpenPageA.uri.spec, &quot;Checking first browser tab open is equal to page A&quot;);</span>
<a href="#l18.66"></a><span id="l18.66" class="difflineplus">+    is(gPageB.uri.spec, gTabOpenPageB.uri.spec, &quot;Checking second browser tab open is equal to page B&quot;);</span>
<a href="#l18.67"></a><span id="l18.67" class="difflineplus">+    // check event</span>
<a href="#l18.68"></a><span id="l18.68" class="difflineplus">+    is(gTabOpenCount, 2, &quot;Checking event handler for tab open&quot;);</span>
<a href="#l18.69"></a><span id="l18.69" class="difflineplus">+</span>
<a href="#l18.70"></a><span id="l18.70" class="difflineplus">+    // test document access</span>
<a href="#l18.71"></a><span id="l18.71" class="difflineplus">+    var test1 = gPageA.document.getElementById(&quot;test1&quot;);</span>
<a href="#l18.72"></a><span id="l18.72" class="difflineplus">+    ok(test1, &quot;Checking existence of element in content DOM&quot;);</span>
<a href="#l18.73"></a><span id="l18.73" class="difflineplus">+    is(test1.innerHTML, &quot;A&quot;, &quot;Checking content of element in content DOM&quot;);</span>
<a href="#l18.74"></a><span id="l18.74" class="difflineplus">+</span>
<a href="#l18.75"></a><span id="l18.75" class="difflineplus">+    // test moving tab</span>
<a href="#l18.76"></a><span id="l18.76" class="difflineplus">+    gPageA.moveToEnd();</span>
<a href="#l18.77"></a><span id="l18.77" class="difflineplus">+    is(gPageA.index, 2, &quot;Checking index after moving tab&quot;);</span>
<a href="#l18.78"></a><span id="l18.78" class="difflineplus">+</span>
<a href="#l18.79"></a><span id="l18.79" class="difflineplus">+    // check event</span>
<a href="#l18.80"></a><span id="l18.80" class="difflineplus">+    is(gTabMoveCount, 1, &quot;Checking event handler for tab move&quot;);</span>
<a href="#l18.81"></a><span id="l18.81" class="difflineplus">+</span>
<a href="#l18.82"></a><span id="l18.82" class="difflineplus">+    let browser = gBrowser.getBrowserAtIndex(gPageB.index);</span>
<a href="#l18.83"></a><span id="l18.83" class="difflineplus">+    browser.addProgressListener({</span>
<a href="#l18.84"></a><span id="l18.84" class="difflineplus">+      onStateChange: function(webProgress, request, stateFlags, status) {</span>
<a href="#l18.85"></a><span id="l18.85" class="difflineplus">+        const complete = Ci.nsIWebProgressListener.STATE_IS_WINDOW +</span>
<a href="#l18.86"></a><span id="l18.86" class="difflineplus">+                         Ci.nsIWebProgressListener.STATE_IS_NETWORK +</span>
<a href="#l18.87"></a><span id="l18.87" class="difflineplus">+                         Ci.nsIWebProgressListener.STATE_STOP;</span>
<a href="#l18.88"></a><span id="l18.88" class="difflineplus">+        if ((stateFlags &amp; complete) == complete) {</span>
<a href="#l18.89"></a><span id="l18.89" class="difflineplus">+          browser.removeProgressListener(this);</span>
<a href="#l18.90"></a><span id="l18.90" class="difflineplus">+          onPageBLoadComplete();</span>
<a href="#l18.91"></a><span id="l18.91" class="difflineplus">+        }</span>
<a href="#l18.92"></a><span id="l18.92" class="difflineplus">+      },</span>
<a href="#l18.93"></a><span id="l18.93" class="difflineplus">+</span>
<a href="#l18.94"></a><span id="l18.94" class="difflineplus">+      onLocationChange: function() { return 0; },</span>
<a href="#l18.95"></a><span id="l18.95" class="difflineplus">+      onProgressChange: function() { return 0; },</span>
<a href="#l18.96"></a><span id="l18.96" class="difflineplus">+      onStatusChange: function() { return 0; },</span>
<a href="#l18.97"></a><span id="l18.97" class="difflineplus">+      onSecurityChange: function() { return 0; },</span>
<a href="#l18.98"></a><span id="l18.98" class="difflineplus">+      QueryInterface: function(iid) {</span>
<a href="#l18.99"></a><span id="l18.99" class="difflineplus">+        if (iid.equals(Ci.nsISupportsWeakReference) ||</span>
<a href="#l18.100"></a><span id="l18.100" class="difflineplus">+           iid.equals(Ci.nsIWebProgressListener) ||</span>
<a href="#l18.101"></a><span id="l18.101" class="difflineplus">+           iid.equals(Ci.nsISupports))</span>
<a href="#l18.102"></a><span id="l18.102" class="difflineplus">+           return this;</span>
<a href="#l18.103"></a><span id="l18.103" class="difflineplus">+</span>
<a href="#l18.104"></a><span id="l18.104" class="difflineplus">+        throw Components.results.NS_ERROR_NO_INTERFACE;</span>
<a href="#l18.105"></a><span id="l18.105" class="difflineplus">+      }</span>
<a href="#l18.106"></a><span id="l18.106" class="difflineplus">+    });</span>
<a href="#l18.107"></a><span id="l18.107" class="difflineplus">+</span>
<a href="#l18.108"></a><span id="l18.108" class="difflineplus">+    // test loading new content with a frame into a tab</span>
<a href="#l18.109"></a><span id="l18.109" class="difflineplus">+    // the event will be checked in afterClose</span>
<a href="#l18.110"></a><span id="l18.110" class="difflineplus">+    gPageB.events.addListener(&quot;load&quot;, onPageBLoadWithFrames);</span>
<a href="#l18.111"></a><span id="l18.111" class="difflineplus">+    gPageB.load(url(&quot;chrome://mochikit/content/browser/suite/smile/test/ContentWithFrames.html&quot;));</span>
<a href="#l18.112"></a><span id="l18.112" class="difflineplus">+  }</span>
<a href="#l18.113"></a><span id="l18.113" class="difflineplus">+</span>
<a href="#l18.114"></a><span id="l18.114" class="difflineplus">+  function onPageBLoadWithFrames(event) {</span>
<a href="#l18.115"></a><span id="l18.115" class="difflineplus">+    gPageLoadCount++;</span>
<a href="#l18.116"></a><span id="l18.116" class="difflineplus">+  }</span>
<a href="#l18.117"></a><span id="l18.117" class="difflineplus">+</span>
<a href="#l18.118"></a><span id="l18.118" class="difflineplus">+  function onPageBLoadComplete() {</span>
<a href="#l18.119"></a><span id="l18.119" class="difflineplus">+    gPageB.events.removeListener(&quot;load&quot;, onPageBLoadWithFrames);</span>
<a href="#l18.120"></a><span id="l18.120" class="difflineplus">+    // check page load with frame event</span>
<a href="#l18.121"></a><span id="l18.121" class="difflineplus">+    is(gPageLoadCount, 1, &quot;Checking load count after loading new content with a frame&quot;);</span>
<a href="#l18.122"></a><span id="l18.122" class="difflineplus">+</span>
<a href="#l18.123"></a><span id="l18.123" class="difflineplus">+    // test loading new content into a tab</span>
<a href="#l18.124"></a><span id="l18.124" class="difflineplus">+    // the event will be checked in onPageLoad</span>
<a href="#l18.125"></a><span id="l18.125" class="difflineplus">+    gPageA.events.addListener(&quot;load&quot;, onPageASecondLoad);</span>
<a href="#l18.126"></a><span id="l18.126" class="difflineplus">+    gPageA.load(url(&quot;chrome://mochikit/content/browser/suite/smile/test/ContentB.html&quot;));</span>
<a href="#l18.127"></a><span id="l18.127" class="difflineplus">+  }</span>
<a href="#l18.128"></a><span id="l18.128" class="difflineplus">+</span>
<a href="#l18.129"></a><span id="l18.129" class="difflineplus">+  function onPageASecondLoad(event) {</span>
<a href="#l18.130"></a><span id="l18.130" class="difflineplus">+    gPageA.events.removeListener(&quot;load&quot;, onPageASecondLoad);</span>
<a href="#l18.131"></a><span id="l18.131" class="difflineplus">+    is(gPageA.uri.spec, &quot;chrome://mochikit/content/browser/suite/smile/test/ContentB.html&quot;, &quot;Checking 'BrowserTab.uri' after loading new content&quot;);</span>
<a href="#l18.132"></a><span id="l18.132" class="difflineplus">+</span>
<a href="#l18.133"></a><span id="l18.133" class="difflineplus">+    // start testing closing tabs</span>
<a href="#l18.134"></a><span id="l18.134" class="difflineplus">+    // the event will be checked in afterClose</span>
<a href="#l18.135"></a><span id="l18.135" class="difflineplus">+    // use executeSoon so the onPageASecondLoad</span>
<a href="#l18.136"></a><span id="l18.136" class="difflineplus">+    // has a chance to finish first</span>
<a href="#l18.137"></a><span id="l18.137" class="difflineplus">+    gPageA.close();</span>
<a href="#l18.138"></a><span id="l18.138" class="difflineplus">+    gPageB.close();</span>
<a href="#l18.139"></a><span id="l18.139" class="difflineplus">+</span>
<a href="#l18.140"></a><span id="l18.140" class="difflineplus">+    is(gTabCloseCount, 2, &quot;Checking that tabs closed&quot;);</span>
<a href="#l18.141"></a><span id="l18.141" class="difflineplus">+    is(activeWin.tabs.length, 1, &quot;Checking length of 'Browser.tabs' after closing 2 tabs&quot;);</span>
<a href="#l18.142"></a><span id="l18.142" class="difflineplus">+    finish();</span>
<a href="#l18.143"></a><span id="l18.143" class="difflineplus">+  }</span>
<a href="#l18.144"></a><span id="l18.144" class="difflineplus">+}</span>
<a href="#l18.145"></a><span id="l18.145" class="difflineplus">+</span>
<a href="#l18.146"></a><span id="l18.146" class="difflineplus">+function onTabOpen(event) {</span>
<a href="#l18.147"></a><span id="l18.147" class="difflineplus">+  gTabOpenCount++;</span>
<a href="#l18.148"></a><span id="l18.148" class="difflineplus">+</span>
<a href="#l18.149"></a><span id="l18.149" class="difflineplus">+  // cache these values so we can check them later (after loading completes)</span>
<a href="#l18.150"></a><span id="l18.150" class="difflineplus">+  if (gTabOpenCount == 1)</span>
<a href="#l18.151"></a><span id="l18.151" class="difflineplus">+    gTabOpenPageA = event.data;</span>
<a href="#l18.152"></a><span id="l18.152" class="difflineplus">+</span>
<a href="#l18.153"></a><span id="l18.153" class="difflineplus">+  if (gTabOpenCount == 2)</span>
<a href="#l18.154"></a><span id="l18.154" class="difflineplus">+    gTabOpenPageB = event.data;</span>
<a href="#l18.155"></a><span id="l18.155" class="difflineplus">+}</span>
<a href="#l18.156"></a><span id="l18.156" class="difflineplus">+</span>
<a href="#l18.157"></a><span id="l18.157" class="difflineplus">+function onTabClose(event) {</span>
<a href="#l18.158"></a><span id="l18.158" class="difflineplus">+  gTabCloseCount++;</span>
<a href="#l18.159"></a><span id="l18.159" class="difflineplus">+}</span>
<a href="#l18.160"></a><span id="l18.160" class="difflineplus">+</span>
<a href="#l18.161"></a><span id="l18.161" class="difflineplus">+function onTabMove(event) {</span>
<a href="#l18.162"></a><span id="l18.162" class="difflineplus">+  gTabMoveCount++;</span>
<a href="#l18.163"></a><span id="l18.163" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1">new file mode 100644</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineminus">--- /dev/null</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineplus">+++ b/suite/smile/test/browser_Extensions.js</span>
<a href="#l19.4"></a><span id="l19.4" class="difflineat">@@ -0,0 +1,126 @@</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineplus">+// The various pieces that we'll be testing</span>
<a href="#l19.6"></a><span id="l19.6" class="difflineplus">+var testdata = {</span>
<a href="#l19.7"></a><span id="l19.7" class="difflineplus">+  dummyid: &quot;smile-dummy-extension@mozilla.org&quot;,</span>
<a href="#l19.8"></a><span id="l19.8" class="difflineplus">+  dummyname: &quot;Dummy Extension&quot;,</span>
<a href="#l19.9"></a><span id="l19.9" class="difflineplus">+  inspectorid: &quot;inspector@mozilla.org&quot;,</span>
<a href="#l19.10"></a><span id="l19.10" class="difflineplus">+  inspectorname: &quot;DOM Inspector&quot;,</span>
<a href="#l19.11"></a><span id="l19.11" class="difflineplus">+  missing: &quot;smile.smile-test-missing&quot;,</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+  dummy: &quot;smile.smile-test&quot;</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+};</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+var gLastEvent = &quot;&quot;;</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineplus">+function test() {</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+  // test to see if the extensions object is available</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineplus">+  ok(Application.extensions, &quot;Check for the 'Extensions' object&quot;);</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineplus">+</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineplus">+  // test to see if a non-existant extension exists</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineplus">+  ok(!Application.extensions.has(testdata.dummyid), &quot;Check non-existant extension for existance&quot;);</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineplus">+</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineplus">+  // BUG 420028: Must find a way to add a dummy extension for test suite</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineplus">+  return;</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineplus">+</span>
<a href="#l19.26"></a><span id="l19.26" class="difflineplus">+  // test to see if an extension exists</span>
<a href="#l19.27"></a><span id="l19.27" class="difflineplus">+  ok(Application.extensions.has(testdata.inspectorid), &quot;Check extension for existance&quot;);</span>
<a href="#l19.28"></a><span id="l19.28" class="difflineplus">+</span>
<a href="#l19.29"></a><span id="l19.29" class="difflineplus">+  var inspector = Application.extensions.get(testdata.inspectorid);</span>
<a href="#l19.30"></a><span id="l19.30" class="difflineplus">+  is(inspector.id, testdata.inspectorid, &quot;Check 'Extension.id' for known extension&quot;);</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineplus">+  is(inspector.name, testdata.inspectorname, &quot;Check 'Extension.name' for known extension&quot;);</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineplus">+  // The known version number changes too frequently to hardcode in</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineplus">+  ok(inspector.version, &quot;Check 'Extension.version' for known extension&quot;);</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineplus">+  ok(inspector.firstRun, &quot;Check 'Extension.firstRun' for known extension&quot;);</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineplus">+  ok(inspector.enabled, &quot;Check 'Extension.enabled' for known extension&quot;);</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineplus">+</span>
<a href="#l19.37"></a><span id="l19.37" class="difflineplus">+  // test to see if extension find works</span>
<a href="#l19.38"></a><span id="l19.38" class="difflineplus">+  is(Application.extensions.all.length, 1, &quot;Check a find for all extensions&quot;);</span>
<a href="#l19.39"></a><span id="l19.39" class="difflineplus">+  // STORAGE TESTING</span>
<a href="#l19.40"></a><span id="l19.40" class="difflineplus">+  // Make sure the we are given the same extension (cached) so things like .storage work right</span>
<a href="#l19.41"></a><span id="l19.41" class="difflineplus">+  inspector.storage.set(&quot;test&quot;, &quot;simple check&quot;);</span>
<a href="#l19.42"></a><span id="l19.42" class="difflineplus">+  ok(inspector.storage.has(&quot;test&quot;), &quot;Checking that extension storage worked&quot;);</span>
<a href="#l19.43"></a><span id="l19.43" class="difflineplus">+</span>
<a href="#l19.44"></a><span id="l19.44" class="difflineplus">+  var inspector2 = Application.extensions.get(testdata.inspectorid);</span>
<a href="#l19.45"></a><span id="l19.45" class="difflineplus">+  is(inspector2.id, testdata.inspectorid, &quot;Check 'Extension.id' for known extension - from cache&quot;);</span>
<a href="#l19.46"></a><span id="l19.46" class="difflineplus">+  ok(inspector.storage.has(&quot;test&quot;), &quot;Checking that extension storage worked - from cache&quot;);</span>
<a href="#l19.47"></a><span id="l19.47" class="difflineplus">+  is(inspector2.storage.get(&quot;test&quot;, &quot;cache&quot;), inspector.storage.get(&quot;test&quot;, &quot;original&quot;), &quot;Checking that the storage of same extension is correct - from cache&quot;);</span>
<a href="#l19.48"></a><span id="l19.48" class="difflineplus">+</span>
<a href="#l19.49"></a><span id="l19.49" class="difflineplus">+  inspector.events.addListener(&quot;disable&quot;, onGenericEvent);</span>
<a href="#l19.50"></a><span id="l19.50" class="difflineplus">+  inspector.events.addListener(&quot;enable&quot;, onGenericEvent);</span>
<a href="#l19.51"></a><span id="l19.51" class="difflineplus">+  inspector.events.addListener(&quot;uninstall&quot;, onGenericEvent);</span>
<a href="#l19.52"></a><span id="l19.52" class="difflineplus">+  inspector.events.addListener(&quot;cancel&quot;, onGenericEvent);</span>
<a href="#l19.53"></a><span id="l19.53" class="difflineplus">+</span>
<a href="#l19.54"></a><span id="l19.54" class="difflineplus">+  var extmgr = Components.classes[&quot;@mozilla.org/extensions/manager;1&quot;]</span>
<a href="#l19.55"></a><span id="l19.55" class="difflineplus">+                         .getService(Components.interfaces.nsIExtensionManager);</span>
<a href="#l19.56"></a><span id="l19.56" class="difflineplus">+</span>
<a href="#l19.57"></a><span id="l19.57" class="difflineplus">+  extmgr.disableItem(testdata.inspectorid);</span>
<a href="#l19.58"></a><span id="l19.58" class="difflineplus">+  is(gLastEvent, &quot;disable&quot;, &quot;Checking that disable event is fired&quot;);</span>
<a href="#l19.59"></a><span id="l19.59" class="difflineplus">+</span>
<a href="#l19.60"></a><span id="l19.60" class="difflineplus">+  // enabling after a disable will only fire a 'cancel' event</span>
<a href="#l19.61"></a><span id="l19.61" class="difflineplus">+  // see - http://mxr.mozilla.org/seamonkey/source/toolkit/mozapps/extensions/src/nsExtensionManager.js.in#5216</span>
<a href="#l19.62"></a><span id="l19.62" class="difflineplus">+  extmgr.enableItem(testdata.inspectorid);</span>
<a href="#l19.63"></a><span id="l19.63" class="difflineplus">+  is(gLastEvent, &quot;cancel&quot;, &quot;Checking that enable (cancel) event is fired&quot;);</span>
<a href="#l19.64"></a><span id="l19.64" class="difflineplus">+</span>
<a href="#l19.65"></a><span id="l19.65" class="difflineplus">+  extmgr.uninstallItem(testdata.inspectorid);</span>
<a href="#l19.66"></a><span id="l19.66" class="difflineplus">+  is(gLastEvent, &quot;uninstall&quot;, &quot;Checking that uninstall event is fired&quot;);</span>
<a href="#l19.67"></a><span id="l19.67" class="difflineplus">+</span>
<a href="#l19.68"></a><span id="l19.68" class="difflineplus">+  extmgr.cancelUninstallItem(testdata.inspectorid);</span>
<a href="#l19.69"></a><span id="l19.69" class="difflineplus">+  is(gLastEvent, &quot;cancel&quot;, &quot;Checking that cancel event is fired&quot;);</span>
<a href="#l19.70"></a><span id="l19.70" class="difflineplus">+</span>
<a href="#l19.71"></a><span id="l19.71" class="difflineplus">+  // PREF TESTING</span>
<a href="#l19.72"></a><span id="l19.72" class="difflineplus">+  // Reset the install event preference, so that we can test it again later</span>
<a href="#l19.73"></a><span id="l19.73" class="difflineplus">+  inspector.prefs.get(&quot;install-event-fired&quot;).reset();</span>
<a href="#l19.74"></a><span id="l19.74" class="difflineplus">+</span>
<a href="#l19.75"></a><span id="l19.75" class="difflineplus">+  // test the value of the preference root</span>
<a href="#l19.76"></a><span id="l19.76" class="difflineplus">+  is(Application.extensions.all[0].prefs.root, &quot;extensions.inspector@mozilla.org.&quot;, &quot;Check an extension preference root&quot;);</span>
<a href="#l19.77"></a><span id="l19.77" class="difflineplus">+</span>
<a href="#l19.78"></a><span id="l19.78" class="difflineplus">+  // test getting non-existing values</span>
<a href="#l19.79"></a><span id="l19.79" class="difflineplus">+  var itemValue = inspector.prefs.getValue(testdata.missing, &quot;default&quot;);</span>
<a href="#l19.80"></a><span id="l19.80" class="difflineplus">+  is(itemValue, &quot;default&quot;, &quot;Check 'Extension.prefs.getValue' for non-existing item&quot;);</span>
<a href="#l19.81"></a><span id="l19.81" class="difflineplus">+</span>
<a href="#l19.82"></a><span id="l19.82" class="difflineplus">+  is(inspector.prefs.get(testdata.missing), null, &quot;Check 'Extension.prefs.get' for non-existing item&quot;);</span>
<a href="#l19.83"></a><span id="l19.83" class="difflineplus">+</span>
<a href="#l19.84"></a><span id="l19.84" class="difflineplus">+  // test setting and getting a value</span>
<a href="#l19.85"></a><span id="l19.85" class="difflineplus">+  inspector.prefs.setValue(testdata.dummy, &quot;dummy&quot;);</span>
<a href="#l19.86"></a><span id="l19.86" class="difflineplus">+  itemValue = inspector.prefs.getValue(testdata.dummy, &quot;default&quot;);</span>
<a href="#l19.87"></a><span id="l19.87" class="difflineplus">+  is(itemValue, &quot;dummy&quot;, &quot;Check 'Extension.prefs.getValue' for existing item&quot;);</span>
<a href="#l19.88"></a><span id="l19.88" class="difflineplus">+</span>
<a href="#l19.89"></a><span id="l19.89" class="difflineplus">+  // test for overwriting an existing value</span>
<a href="#l19.90"></a><span id="l19.90" class="difflineplus">+  inspector.prefs.setValue(testdata.dummy, &quot;smarty&quot;);</span>
<a href="#l19.91"></a><span id="l19.91" class="difflineplus">+  itemValue = inspector.prefs.getValue(testdata.dummy, &quot;default&quot;);</span>
<a href="#l19.92"></a><span id="l19.92" class="difflineplus">+  is(itemValue, &quot;smarty&quot;, &quot;Check 'Extension.prefs.getValue' for overwritten item&quot;);</span>
<a href="#l19.93"></a><span id="l19.93" class="difflineplus">+</span>
<a href="#l19.94"></a><span id="l19.94" class="difflineplus">+  // test setting and getting a value</span>
<a href="#l19.95"></a><span id="l19.95" class="difflineplus">+  inspector.prefs.get(testdata.dummy).value = &quot;dummy2&quot;;</span>
<a href="#l19.96"></a><span id="l19.96" class="difflineplus">+  itemValue = inspector.prefs.get(testdata.dummy).value;</span>
<a href="#l19.97"></a><span id="l19.97" class="difflineplus">+  is(itemValue, &quot;dummy2&quot;, &quot;Check 'Extension.prefs.get().value' for existing item&quot;);</span>
<a href="#l19.98"></a><span id="l19.98" class="difflineplus">+</span>
<a href="#l19.99"></a><span id="l19.99" class="difflineplus">+  // test resetting a pref [since there is no default value, the pref should disappear]</span>
<a href="#l19.100"></a><span id="l19.100" class="difflineplus">+  inspector.prefs.get(testdata.dummy).reset();</span>
<a href="#l19.101"></a><span id="l19.101" class="difflineplus">+  var itemValue = inspector.prefs.getValue(testdata.dummy, &quot;default&quot;);</span>
<a href="#l19.102"></a><span id="l19.102" class="difflineplus">+  is(itemValue, &quot;default&quot;, &quot;Check 'Extension.prefs.getValue' for reset pref&quot;);</span>
<a href="#l19.103"></a><span id="l19.103" class="difflineplus">+</span>
<a href="#l19.104"></a><span id="l19.104" class="difflineplus">+  // test to see if a non-existant property exists</span>
<a href="#l19.105"></a><span id="l19.105" class="difflineplus">+  ok(!inspector.prefs.has(testdata.dummy), &quot;Check non-existant property for existance&quot;);</span>
<a href="#l19.106"></a><span id="l19.106" class="difflineplus">+</span>
<a href="#l19.107"></a><span id="l19.107" class="difflineplus">+  waitForExplicitFinish();</span>
<a href="#l19.108"></a><span id="l19.108" class="difflineplus">+  inspector.prefs.events.addListener(&quot;change&quot;, onPrefChange);</span>
<a href="#l19.109"></a><span id="l19.109" class="difflineplus">+  inspector.prefs.setValue(&quot;smile.smile-test&quot;, &quot;change event&quot;);</span>
<a href="#l19.110"></a><span id="l19.110" class="difflineplus">+}</span>
<a href="#l19.111"></a><span id="l19.111" class="difflineplus">+</span>
<a href="#l19.112"></a><span id="l19.112" class="difflineplus">+function onGenericEvent(event) {</span>
<a href="#l19.113"></a><span id="l19.113" class="difflineplus">+  gLastEvent = event.type;</span>
<a href="#l19.114"></a><span id="l19.114" class="difflineplus">+}</span>
<a href="#l19.115"></a><span id="l19.115" class="difflineplus">+</span>
<a href="#l19.116"></a><span id="l19.116" class="difflineplus">+function onPrefChange(evt) {</span>
<a href="#l19.117"></a><span id="l19.117" class="difflineplus">+  var inspector3 = Application.extensions.get(testdata.inspectorid);</span>
<a href="#l19.118"></a><span id="l19.118" class="difflineplus">+</span>
<a href="#l19.119"></a><span id="l19.119" class="difflineplus">+  is(evt.data, testdata.dummy, &quot;Check 'Extension.prefs.set' fired a change event&quot;);</span>
<a href="#l19.120"></a><span id="l19.120" class="difflineplus">+  inspector3.prefs.events.removeListener(&quot;change&quot;, onPrefChange);</span>
<a href="#l19.121"></a><span id="l19.121" class="difflineplus">+</span>
<a href="#l19.122"></a><span id="l19.122" class="difflineplus">+  inspector3.prefs.get(&quot;smile.smile-test&quot;).events.addListener(&quot;change&quot;, onPrefChange2);</span>
<a href="#l19.123"></a><span id="l19.123" class="difflineplus">+  inspector3.prefs.setValue(&quot;smile.smile-test&quot;, &quot;change event2&quot;);</span>
<a href="#l19.124"></a><span id="l19.124" class="difflineplus">+}</span>
<a href="#l19.125"></a><span id="l19.125" class="difflineplus">+</span>
<a href="#l19.126"></a><span id="l19.126" class="difflineplus">+function onPrefChange2(evt) {</span>
<a href="#l19.127"></a><span id="l19.127" class="difflineplus">+  is(evt.data, testdata.dummy, &quot;Check 'Extension.prefs.set' fired a change event for a single preference&quot;);</span>
<a href="#l19.128"></a><span id="l19.128" class="difflineplus">+</span>
<a href="#l19.129"></a><span id="l19.129" class="difflineplus">+  finish();</span>
<a href="#l19.130"></a><span id="l19.130" class="difflineplus">+}</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

