<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 29702:b10f1799da169cb99d810467970394e15e4bb0ed</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ b10f1799da169cb99d810467970394e15e4bb0ed" />
<meta property="og:url" content="/comm-central/rev/b10f1799da169cb99d810467970394e15e4bb0ed" />
<meta property="og:description" content="Bug 1622703 - Copy new enterprise policies from Firefox. r=mkmelin" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / b10f1799da169cb99d810467970394e15e4bb0ed 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/b10f1799da169cb99d810467970394e15e4bb0ed">shortlog</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/b10f1799da169cb99d810467970394e15e4bb0ed">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed">files</a> |
changeset |
<a href="/comm-central/raw-rev/b10f1799da169cb99d810467970394e15e4bb0ed">raw</a>  | <a href="/comm-central/archive/b10f1799da169cb99d810467970394e15e4bb0ed.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1622703">Bug 1622703</a> - Copy new enterprise policies from Firefox. r=mkmelin
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#71;&#101;&#111;&#102;&#102;&#32;&#76;&#97;&#110;&#107;&#111;&#119;&#32;&#60;&#103;&#101;&#111;&#102;&#102;&#64;&#100;&#97;&#114;&#107;&#116;&#114;&#111;&#106;&#97;&#110;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 29 May 2020 13:44:59 +0300</td></tr>

<tr>
 <td>changeset 29702</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/b10f1799da169cb99d810467970394e15e4bb0ed">b10f1799da169cb99d810467970394e15e4bb0ed</a></td>
</tr>



<tr>
<td>parent 29701</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/bbe97f4c271640fca5a0ccc15d1f171d45c2362d">bbe97f4c271640fca5a0ccc15d1f171d45c2362d</a>
</td>
</tr>

<tr>
<td>child 29703</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/a18b970b5be8315f577a1433515dd52b04dafcf7">a18b970b5be8315f577a1433515dd52b04dafcf7</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=b10f1799da169cb99d810467970394e15e4bb0ed">17493</a></td></tr>
<tr><td>push user</td><td>mkmelin@iki.fi</td></tr>
<tr><td>push date</td><td class="date age">Fri, 29 May 2020 10:50:57 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@aa0ea60ab031 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=aa0ea60ab031095e06721e9dcd08c0cdd2766469">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=aa0ea60ab031095e06721e9dcd08c0cdd2766469&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=aa0ea60ab031095e06721e9dcd08c0cdd2766469&newProject=comm-central&newRevision=bbe97f4c271640fca5a0ccc15d1f171d45c2362d&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=aa0ea60ab031095e06721e9dcd08c0cdd2766469&newProject=comm-central&newRevision=bbe97f4c271640fca5a0ccc15d1f171d45c2362d&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=aa0ea60ab031095e06721e9dcd08c0cdd2766469&newProject=comm-central&newRevision=bbe97f4c271640fca5a0ccc15d1f171d45c2362d&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1622703">1622703</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1622703">Bug 1622703</a> - Copy new enterprise policies from Firefox. r=mkmelin</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/helpMenu.inc.xhtml">mail/base/content/helpMenu.inc.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/helpMenu.inc.xhtml">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/helpMenu.inc.xhtml">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/helpMenu.inc.xhtml">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/helpMenu.inc.xhtml">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/helpMenu.inc.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/utilityOverlay.js">mail/base/content/utilityOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/utilityOverlay.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/utilityOverlay.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/utilityOverlay.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/utilityOverlay.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/base/content/utilityOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/customizableui/content/panelUI.inc.xhtml">mail/components/customizableui/content/panelUI.inc.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/customizableui/content/panelUI.inc.xhtml">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/customizableui/content/panelUI.inc.xhtml">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/customizableui/content/panelUI.inc.xhtml">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/customizableui/content/panelUI.inc.xhtml">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/customizableui/content/panelUI.inc.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/Policies.jsm">mail/components/enterprisepolicies/Policies.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/Policies.jsm">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/Policies.jsm">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/Policies.jsm">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/Policies.jsm">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/Policies.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/schemas/policies-schema.json">mail/components/enterprisepolicies/schemas/policies-schema.json</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/schemas/policies-schema.json">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/schemas/policies-schema.json">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/schemas/policies-schema.json">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/schemas/policies-schema.json">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/schemas/policies-schema.json">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser.ini">mail/components/enterprisepolicies/tests/browser/browser.ini</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser.ini">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser.ini">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser.ini">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser.ini">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser.ini">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about.js">mail/components/enterprisepolicies/tests/browser/browser_policy_block_about.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_addons.js">mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_addons.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_addons.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_addons.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_addons.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_config.js">mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_config.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_config.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_config.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_config.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_profiles.js">mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_profiles.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_profiles.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_profiles.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_profiles.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_support.js">mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_support.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_support.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_support.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_support.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_cookie_settings.js">mail/components/enterprisepolicies/tests/browser/browser_policy_cookie_settings.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_cookie_settings.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_cookie_settings.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_cookie_settings.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_cookie_settings.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_cookie_settings.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_safemode.js">mail/components/enterprisepolicies/tests/browser/browser_policy_disable_safemode.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_safemode.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_safemode.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_safemode.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_safemode.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_safemode.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_telemetry.js">mail/components/enterprisepolicies/tests/browser/browser_policy_disable_telemetry.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_telemetry.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_telemetry.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_telemetry.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_telemetry.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_telemetry.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_downloads.js">mail/components/enterprisepolicies/tests/browser/browser_policy_downloads.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_downloads.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_downloads.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_downloads.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_downloads.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_downloads.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_passwordmanager.js">mail/components/enterprisepolicies/tests/browser/browser_policy_passwordmanager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_passwordmanager.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_passwordmanager.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_passwordmanager.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_passwordmanager.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/browser_policy_passwordmanager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser.ini">mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser.ini</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser.ini">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser.ini">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser.ini">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser.ini">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser.ini">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser_policy_hardware_acceleration.js">mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser_policy_hardware_acceleration.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser_policy_hardware_acceleration.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser_policy_hardware_acceleration.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser_policy_hardware_acceleration.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser_policy_hardware_acceleration.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser_policy_hardware_acceleration.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/disable_hardware_acceleration.json">mail/components/enterprisepolicies/tests/browser/hardware_acceleration/disable_hardware_acceleration.json</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/disable_hardware_acceleration.json">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/disable_hardware_acceleration.json">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/disable_hardware_acceleration.json">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/disable_hardware_acceleration.json">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/disable_hardware_acceleration.json">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/head.js">mail/components/enterprisepolicies/tests/browser/head.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/head.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/head.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/head.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/head.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/browser/head.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/moz.build">mail/components/enterprisepolicies/tests/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/moz.build">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/moz.build">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/moz.build">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/moz.build">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/head.js">mail/components/enterprisepolicies/tests/xpcshell/head.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/head.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/head.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/head.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/head.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/head.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_3rdparty.js">mail/components/enterprisepolicies/tests/xpcshell/test_3rdparty.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_3rdparty.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_3rdparty.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_3rdparty.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_3rdparty.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_3rdparty.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_clear_blocked_cookies.js">mail/components/enterprisepolicies/tests/xpcshell/test_clear_blocked_cookies.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_clear_blocked_cookies.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_clear_blocked_cookies.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_clear_blocked_cookies.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_clear_blocked_cookies.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_clear_blocked_cookies.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_simple_pref_policies.js">mail/components/enterprisepolicies/tests/xpcshell/test_simple_pref_policies.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_simple_pref_policies.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_simple_pref_policies.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_simple_pref_policies.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_simple_pref_policies.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/test_simple_pref_policies.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/xpcshell.ini">mail/components/enterprisepolicies/tests/xpcshell/xpcshell.ini</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/xpcshell.ini">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/xpcshell.ini">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/xpcshell.ini">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/xpcshell.ini">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/enterprisepolicies/tests/xpcshell/xpcshell.ini">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/downloads.js">mail/components/preferences/downloads.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/downloads.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/downloads.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/downloads.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/downloads.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/downloads.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.inc.xhtml">mail/components/preferences/privacy.inc.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.inc.xhtml">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.inc.xhtml">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.inc.xhtml">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.inc.xhtml">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.inc.xhtml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.js">mail/components/preferences/privacy.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.js">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.js">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.js">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.js">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/components/preferences/privacy.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/locales/en-US/messenger/policies/policies-descriptions.ftl">mail/locales/en-US/messenger/policies/policies-descriptions.ftl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b10f1799da169cb99d810467970394e15e4bb0ed/mail/locales/en-US/messenger/policies/policies-descriptions.ftl">file</a> |
<a href="/comm-central/annotate/b10f1799da169cb99d810467970394e15e4bb0ed/mail/locales/en-US/messenger/policies/policies-descriptions.ftl">annotate</a> |
<a href="/comm-central/diff/b10f1799da169cb99d810467970394e15e4bb0ed/mail/locales/en-US/messenger/policies/policies-descriptions.ftl">diff</a> |
<a href="/comm-central/comparison/b10f1799da169cb99d810467970394e15e4bb0ed/mail/locales/en-US/messenger/policies/policies-descriptions.ftl">comparison</a> |
<a href="/comm-central/log/b10f1799da169cb99d810467970394e15e4bb0ed/mail/locales/en-US/messenger/policies/policies-descriptions.ftl">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/helpMenu.inc.xhtml</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/helpMenu.inc.xhtml</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,14 +1,15 @@</span>
<a href="#l1.4"></a><span id="l1.4">       &lt;menu id=&quot;helpMenu&quot;</span>
<a href="#l1.5"></a><span id="l1.5"> #ifdef XP_WIN</span>
<a href="#l1.6"></a><span id="l1.6" class="difflineminus">-            label=&quot;&amp;helpMenuWin.label;&quot; accesskey=&quot;&amp;helpMenuWin.accesskey;&quot;&gt;</span>
<a href="#l1.7"></a><span id="l1.7" class="difflineplus">+            label=&quot;&amp;helpMenuWin.label;&quot; accesskey=&quot;&amp;helpMenuWin.accesskey;&quot;</span>
<a href="#l1.8"></a><span id="l1.8"> #else</span>
<a href="#l1.9"></a><span id="l1.9" class="difflineminus">-            label=&quot;&amp;helpMenu.label;&quot; accesskey=&quot;&amp;helpMenu.accesskey;&quot;&gt;</span>
<a href="#l1.10"></a><span id="l1.10" class="difflineplus">+            label=&quot;&amp;helpMenu.label;&quot; accesskey=&quot;&amp;helpMenu.accesskey;&quot;</span>
<a href="#l1.11"></a><span id="l1.11"> #endif</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+            onpopupshowing=&quot;buildHelpMenu();&quot;&gt;</span>
<a href="#l1.13"></a><span id="l1.13">         &lt;menupopup id=&quot;menu_HelpPopup&quot;&gt;</span>
<a href="#l1.14"></a><span id="l1.14">           &lt;menuitem id=&quot;menu_openHelp&quot;</span>
<a href="#l1.15"></a><span id="l1.15">                     label=&quot;&amp;productHelp.label;&quot;</span>
<a href="#l1.16"></a><span id="l1.16"> #ifndef XP_MACOSX</span>
<a href="#l1.17"></a><span id="l1.17">                     accesskey=&quot;&amp;productHelp.accesskey;&quot;</span>
<a href="#l1.18"></a><span id="l1.18"> #endif</span>
<a href="#l1.19"></a><span id="l1.19">                     key=&quot;key_openHelp&quot;</span>
<a href="#l1.20"></a><span id="l1.20">                     oncommand=&quot;openSupportURL();&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/utilityOverlay.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/utilityOverlay.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -400,8 +400,17 @@ function goOnEvent(aNode, aEvent) {</span>
<a href="#l2.4"></a><span id="l2.4">     controllerIndex++</span>
<a href="#l2.5"></a><span id="l2.5">   ) {</span>
<a href="#l2.6"></a><span id="l2.6">     controller = aNode.controllers.getControllerAt(controllerIndex);</span>
<a href="#l2.7"></a><span id="l2.7">     if (controller) {</span>
<a href="#l2.8"></a><span id="l2.8">       controller.onEvent(aEvent);</span>
<a href="#l2.9"></a><span id="l2.9">     }</span>
<a href="#l2.10"></a><span id="l2.10">   }</span>
<a href="#l2.11"></a><span id="l2.11"> }</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+function buildHelpMenu() {</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+  document.getElementById(</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+    &quot;helpSafeMode&quot;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+  ).disabled = !Services.policies.isAllowed(&quot;safeMode&quot;);</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+  document.getElementById(</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+    &quot;appmenu_safeMode&quot;</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+  ).disabled = !Services.policies.isAllowed(&quot;safeMode&quot;);</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/components/customizableui/content/panelUI.inc.xhtml</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/components/customizableui/content/panelUI.inc.xhtml</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -143,17 +143,17 @@</span>
<a href="#l3.4"></a><span id="l3.4">                        class=&quot;subviewbutton subviewbutton-nav&quot;</span>
<a href="#l3.5"></a><span id="l3.5">                        label=&quot;&amp;tasksMenu.label;&quot;</span>
<a href="#l3.6"></a><span id="l3.6">                        closemenu=&quot;none&quot;</span>
<a href="#l3.7"></a><span id="l3.7">                        oncommand=&quot;PanelUI.showSubView('appMenu-toolsView', this)&quot;/&gt;</span>
<a href="#l3.8"></a><span id="l3.8">         &lt;toolbarbutton id=&quot;appmenu_help&quot;</span>
<a href="#l3.9"></a><span id="l3.9">                        class=&quot;subviewbutton subviewbutton-iconic subviewbutton-nav&quot;</span>
<a href="#l3.10"></a><span id="l3.10">                        label=&quot;&amp;helpMenuWin.label;&quot;</span>
<a href="#l3.11"></a><span id="l3.11">                        closemenu=&quot;none&quot;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-                       oncommand=&quot;PanelUI.showSubView('appMenu-helpView', this)&quot;/&gt;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+                       oncommand=&quot;buildHelpMenu(); PanelUI.showSubView('appMenu-helpView', this)&quot;/&gt;</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15">         &lt;toolbarseparator/&gt;</span>
<a href="#l3.16"></a><span id="l3.16">         &lt;toolbarbutton id=&quot;appmenu-quit&quot;</span>
<a href="#l3.17"></a><span id="l3.17">                        class=&quot;subviewbutton subviewbutton-iconic&quot;</span>
<a href="#l3.18"></a><span id="l3.18"> #ifdef XP_WIN</span>
<a href="#l3.19"></a><span id="l3.19">                        label=&quot;&amp;quitApplicationCmd.label;&quot;</span>
<a href="#l3.20"></a><span id="l3.20"> #else</span>
<a href="#l3.21"></a><span id="l3.21">                        label=&quot;&amp;quitApplicationCmdUnix.label;&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/components/enterprisepolicies/Policies.jsm</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/components/enterprisepolicies/Policies.jsm</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -59,16 +59,22 @@ var EXPORTED_SYMBOLS = [&quot;Policies&quot;];</span>
<a href="#l4.4"></a><span id="l4.4">  *   It will be different for each policy. It could be a boolean,</span>
<a href="#l4.5"></a><span id="l4.5">  *   a string, an array or a complex object. All parameters have</span>
<a href="#l4.6"></a><span id="l4.6">  *   been validated according to the schema, and no unknown</span>
<a href="#l4.7"></a><span id="l4.7">  *   properties will be present on them.</span>
<a href="#l4.8"></a><span id="l4.8">  *</span>
<a href="#l4.9"></a><span id="l4.9">  * The callbacks will be bound to their parent policy object.</span>
<a href="#l4.10"></a><span id="l4.10">  */</span>
<a href="#l4.11"></a><span id="l4.11"> var Policies = {</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+  &quot;3rdparty&quot;: {</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+    onBeforeAddons(manager, param) {</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+      manager.setExtensionPolicies(param.Extensions);</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+    },</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+  },</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+</span>
<a href="#l4.18"></a><span id="l4.18">   AppAutoUpdate: {</span>
<a href="#l4.19"></a><span id="l4.19">     onBeforeUIStartup(manager, param) {</span>
<a href="#l4.20"></a><span id="l4.20">       // Logic feels a bit reversed here, but it's correct. If AppAutoUpdate is</span>
<a href="#l4.21"></a><span id="l4.21">       // true, we disallow turning off auto updating, and visa versa.</span>
<a href="#l4.22"></a><span id="l4.22">       if (param) {</span>
<a href="#l4.23"></a><span id="l4.23">         manager.disallowFeature(&quot;app-auto-updates-off&quot;);</span>
<a href="#l4.24"></a><span id="l4.24">       } else {</span>
<a href="#l4.25"></a><span id="l4.25">         manager.disallowFeature(&quot;app-auto-updates-on&quot;);</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineat">@@ -77,16 +83,86 @@ var Policies = {</span>
<a href="#l4.27"></a><span id="l4.27">   },</span>
<a href="#l4.28"></a><span id="l4.28"> </span>
<a href="#l4.29"></a><span id="l4.29">   AppUpdateURL: {</span>
<a href="#l4.30"></a><span id="l4.30">     onBeforeAddons(manager, param) {</span>
<a href="#l4.31"></a><span id="l4.31">       setDefaultPref(&quot;app.update.url&quot;, param.href);</span>
<a href="#l4.32"></a><span id="l4.32">     },</span>
<a href="#l4.33"></a><span id="l4.33">   },</span>
<a href="#l4.34"></a><span id="l4.34"> </span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+  Authentication: {</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+    onBeforeAddons(manager, param) {</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+      let locked = true;</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+      if (&quot;Locked&quot; in param) {</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+        locked = param.Locked;</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+      }</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+      if (&quot;SPNEGO&quot; in param) {</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+        setDefaultPref(</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+          &quot;network.negotiate-auth.trusted-uris&quot;,</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+          param.SPNEGO.join(&quot;, &quot;),</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineplus">+          locked</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineplus">+        );</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+      }</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineplus">+      if (&quot;Delegated&quot; in param) {</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineplus">+        setDefaultPref(</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+          &quot;network.negotiate-auth.delegation-uris&quot;,</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineplus">+          param.Delegated.join(&quot;, &quot;),</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineplus">+          locked</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineplus">+        );</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineplus">+      }</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineplus">+      if (&quot;NTLM&quot; in param) {</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineplus">+        setDefaultPref(</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineplus">+          &quot;network.automatic-ntlm-auth.trusted-uris&quot;,</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineplus">+          param.NTLM.join(&quot;, &quot;),</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineplus">+          locked</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineplus">+        );</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineplus">+      }</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineplus">+      if (&quot;AllowNonFQDN&quot; in param) {</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineplus">+        if (&quot;NTLM&quot; in param.AllowNonFQDN) {</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineplus">+          setDefaultPref(</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineplus">+            &quot;network.automatic-ntlm-auth.allow-non-fqdn&quot;,</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineplus">+            param.AllowNonFQDN.NTLM,</span>
<a href="#l4.68"></a><span id="l4.68" class="difflineplus">+            locked</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineplus">+          );</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineplus">+        }</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineplus">+        if (&quot;SPNEGO&quot; in param.AllowNonFQDN) {</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineplus">+          setDefaultPref(</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineplus">+            &quot;network.negotiate-auth.allow-non-fqdn&quot;,</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineplus">+            param.AllowNonFQDN.SPNEGO,</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineplus">+            locked</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineplus">+          );</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineplus">+        }</span>
<a href="#l4.78"></a><span id="l4.78" class="difflineplus">+      }</span>
<a href="#l4.79"></a><span id="l4.79" class="difflineplus">+      if (&quot;AllowProxies&quot; in param) {</span>
<a href="#l4.80"></a><span id="l4.80" class="difflineplus">+        if (&quot;NTLM&quot; in param.AllowProxies) {</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineplus">+          setDefaultPref(</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineplus">+            &quot;network.automatic-ntlm-auth.allow-proxies&quot;,</span>
<a href="#l4.83"></a><span id="l4.83" class="difflineplus">+            param.AllowProxies.NTLM,</span>
<a href="#l4.84"></a><span id="l4.84" class="difflineplus">+            locked</span>
<a href="#l4.85"></a><span id="l4.85" class="difflineplus">+          );</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineplus">+        }</span>
<a href="#l4.87"></a><span id="l4.87" class="difflineplus">+        if (&quot;SPNEGO&quot; in param.AllowProxies) {</span>
<a href="#l4.88"></a><span id="l4.88" class="difflineplus">+          setDefaultPref(</span>
<a href="#l4.89"></a><span id="l4.89" class="difflineplus">+            &quot;network.negotiate-auth.allow-proxies&quot;,</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineplus">+            param.AllowProxies.SPNEGO,</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineplus">+            locked</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineplus">+          );</span>
<a href="#l4.93"></a><span id="l4.93" class="difflineplus">+        }</span>
<a href="#l4.94"></a><span id="l4.94" class="difflineplus">+      }</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineplus">+      if (&quot;PrivateBrowsing&quot; in param) {</span>
<a href="#l4.96"></a><span id="l4.96" class="difflineplus">+        setDefaultPref(</span>
<a href="#l4.97"></a><span id="l4.97" class="difflineplus">+          &quot;network.auth.private-browsing-sso&quot;,</span>
<a href="#l4.98"></a><span id="l4.98" class="difflineplus">+          param.PrivateBrowsing,</span>
<a href="#l4.99"></a><span id="l4.99" class="difflineplus">+          locked</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineplus">+        );</span>
<a href="#l4.101"></a><span id="l4.101" class="difflineplus">+      }</span>
<a href="#l4.102"></a><span id="l4.102" class="difflineplus">+    },</span>
<a href="#l4.103"></a><span id="l4.103" class="difflineplus">+  },</span>
<a href="#l4.104"></a><span id="l4.104" class="difflineplus">+</span>
<a href="#l4.105"></a><span id="l4.105">   BlockAboutAddons: {</span>
<a href="#l4.106"></a><span id="l4.106">     onBeforeUIStartup(manager, param) {</span>
<a href="#l4.107"></a><span id="l4.107">       if (param) {</span>
<a href="#l4.108"></a><span id="l4.108">         blockAboutPage(manager, &quot;about:addons&quot;, true);</span>
<a href="#l4.109"></a><span id="l4.109">       }</span>
<a href="#l4.110"></a><span id="l4.110">     },</span>
<a href="#l4.111"></a><span id="l4.111">   },</span>
<a href="#l4.112"></a><span id="l4.112"> </span>
<a href="#l4.113"></a><span id="l4.113" class="difflineat">@@ -110,16 +186,22 @@ var Policies = {</span>
<a href="#l4.114"></a><span id="l4.114">   BlockAboutSupport: {</span>
<a href="#l4.115"></a><span id="l4.115">     onBeforeUIStartup(manager, param) {</span>
<a href="#l4.116"></a><span id="l4.116">       if (param) {</span>
<a href="#l4.117"></a><span id="l4.117">         blockAboutPage(manager, &quot;about:support&quot;);</span>
<a href="#l4.118"></a><span id="l4.118">       }</span>
<a href="#l4.119"></a><span id="l4.119">     },</span>
<a href="#l4.120"></a><span id="l4.120">   },</span>
<a href="#l4.121"></a><span id="l4.121"> </span>
<a href="#l4.122"></a><span id="l4.122" class="difflineplus">+  CaptivePortal: {</span>
<a href="#l4.123"></a><span id="l4.123" class="difflineplus">+    onBeforeAddons(manager, param) {</span>
<a href="#l4.124"></a><span id="l4.124" class="difflineplus">+      setAndLockPref(&quot;network.captive-portal-service.enabled&quot;, param);</span>
<a href="#l4.125"></a><span id="l4.125" class="difflineplus">+    },</span>
<a href="#l4.126"></a><span id="l4.126" class="difflineplus">+  },</span>
<a href="#l4.127"></a><span id="l4.127" class="difflineplus">+</span>
<a href="#l4.128"></a><span id="l4.128">   Certificates: {</span>
<a href="#l4.129"></a><span id="l4.129">     onBeforeAddons(manager, param) {</span>
<a href="#l4.130"></a><span id="l4.130">       if (&quot;ImportEnterpriseRoots&quot; in param) {</span>
<a href="#l4.131"></a><span id="l4.131">         setAndLockPref(</span>
<a href="#l4.132"></a><span id="l4.132">           &quot;security.enterprise_roots.enabled&quot;,</span>
<a href="#l4.133"></a><span id="l4.133">           param.ImportEnterpriseRoots</span>
<a href="#l4.134"></a><span id="l4.134">         );</span>
<a href="#l4.135"></a><span id="l4.135">       }</span>
<a href="#l4.136"></a><span id="l4.136" class="difflineat">@@ -214,16 +296,88 @@ var Policies = {</span>
<a href="#l4.137"></a><span id="l4.137">             };</span>
<a href="#l4.138"></a><span id="l4.138">             reader.readAsBinaryString(file);</span>
<a href="#l4.139"></a><span id="l4.139">           }</span>
<a href="#l4.140"></a><span id="l4.140">         })();</span>
<a href="#l4.141"></a><span id="l4.141">       }</span>
<a href="#l4.142"></a><span id="l4.142">     },</span>
<a href="#l4.143"></a><span id="l4.143">   },</span>
<a href="#l4.144"></a><span id="l4.144"> </span>
<a href="#l4.145"></a><span id="l4.145" class="difflineplus">+  Cookies: {</span>
<a href="#l4.146"></a><span id="l4.146" class="difflineplus">+    onBeforeUIStartup(manager, param) {</span>
<a href="#l4.147"></a><span id="l4.147" class="difflineplus">+      addAllowDenyPermissions(&quot;cookie&quot;, param.Allow, param.Block);</span>
<a href="#l4.148"></a><span id="l4.148" class="difflineplus">+</span>
<a href="#l4.149"></a><span id="l4.149" class="difflineplus">+      if (param.Block) {</span>
<a href="#l4.150"></a><span id="l4.150" class="difflineplus">+        const hosts = param.Block.map(url =&gt; url.hostname)</span>
<a href="#l4.151"></a><span id="l4.151" class="difflineplus">+          .sort()</span>
<a href="#l4.152"></a><span id="l4.152" class="difflineplus">+          .join(&quot;\n&quot;);</span>
<a href="#l4.153"></a><span id="l4.153" class="difflineplus">+        runOncePerModification(&quot;clearCookiesForBlockedHosts&quot;, hosts, () =&gt; {</span>
<a href="#l4.154"></a><span id="l4.154" class="difflineplus">+          for (let blocked of param.Block) {</span>
<a href="#l4.155"></a><span id="l4.155" class="difflineplus">+            Services.cookies.removeCookiesWithOriginAttributes(</span>
<a href="#l4.156"></a><span id="l4.156" class="difflineplus">+              &quot;{}&quot;,</span>
<a href="#l4.157"></a><span id="l4.157" class="difflineplus">+              blocked.hostname</span>
<a href="#l4.158"></a><span id="l4.158" class="difflineplus">+            );</span>
<a href="#l4.159"></a><span id="l4.159" class="difflineplus">+          }</span>
<a href="#l4.160"></a><span id="l4.160" class="difflineplus">+        });</span>
<a href="#l4.161"></a><span id="l4.161" class="difflineplus">+      }</span>
<a href="#l4.162"></a><span id="l4.162" class="difflineplus">+</span>
<a href="#l4.163"></a><span id="l4.163" class="difflineplus">+      if (</span>
<a href="#l4.164"></a><span id="l4.164" class="difflineplus">+        param.Default !== undefined ||</span>
<a href="#l4.165"></a><span id="l4.165" class="difflineplus">+        param.AcceptThirdParty !== undefined ||</span>
<a href="#l4.166"></a><span id="l4.166" class="difflineplus">+        param.Locked</span>
<a href="#l4.167"></a><span id="l4.167" class="difflineplus">+      ) {</span>
<a href="#l4.168"></a><span id="l4.168" class="difflineplus">+        const ACCEPT_COOKIES = 0;</span>
<a href="#l4.169"></a><span id="l4.169" class="difflineplus">+        const REJECT_THIRD_PARTY_COOKIES = 1;</span>
<a href="#l4.170"></a><span id="l4.170" class="difflineplus">+        const REJECT_ALL_COOKIES = 2;</span>
<a href="#l4.171"></a><span id="l4.171" class="difflineplus">+        const REJECT_UNVISITED_THIRD_PARTY = 3;</span>
<a href="#l4.172"></a><span id="l4.172" class="difflineplus">+</span>
<a href="#l4.173"></a><span id="l4.173" class="difflineplus">+        let newCookieBehavior = ACCEPT_COOKIES;</span>
<a href="#l4.174"></a><span id="l4.174" class="difflineplus">+        if (param.Default !== undefined &amp;&amp; !param.Default) {</span>
<a href="#l4.175"></a><span id="l4.175" class="difflineplus">+          newCookieBehavior = REJECT_ALL_COOKIES;</span>
<a href="#l4.176"></a><span id="l4.176" class="difflineplus">+        } else if (param.AcceptThirdParty) {</span>
<a href="#l4.177"></a><span id="l4.177" class="difflineplus">+          if (param.AcceptThirdParty == &quot;never&quot;) {</span>
<a href="#l4.178"></a><span id="l4.178" class="difflineplus">+            newCookieBehavior = REJECT_THIRD_PARTY_COOKIES;</span>
<a href="#l4.179"></a><span id="l4.179" class="difflineplus">+          } else if (param.AcceptThirdParty == &quot;from-visited&quot;) {</span>
<a href="#l4.180"></a><span id="l4.180" class="difflineplus">+            newCookieBehavior = REJECT_UNVISITED_THIRD_PARTY;</span>
<a href="#l4.181"></a><span id="l4.181" class="difflineplus">+          }</span>
<a href="#l4.182"></a><span id="l4.182" class="difflineplus">+        }</span>
<a href="#l4.183"></a><span id="l4.183" class="difflineplus">+</span>
<a href="#l4.184"></a><span id="l4.184" class="difflineplus">+        setDefaultPref(</span>
<a href="#l4.185"></a><span id="l4.185" class="difflineplus">+          &quot;network.cookie.cookieBehavior&quot;,</span>
<a href="#l4.186"></a><span id="l4.186" class="difflineplus">+          newCookieBehavior,</span>
<a href="#l4.187"></a><span id="l4.187" class="difflineplus">+          param.Locked</span>
<a href="#l4.188"></a><span id="l4.188" class="difflineplus">+        );</span>
<a href="#l4.189"></a><span id="l4.189" class="difflineplus">+      }</span>
<a href="#l4.190"></a><span id="l4.190" class="difflineplus">+</span>
<a href="#l4.191"></a><span id="l4.191" class="difflineplus">+      const KEEP_COOKIES_UNTIL_EXPIRATION = 0;</span>
<a href="#l4.192"></a><span id="l4.192" class="difflineplus">+      const KEEP_COOKIES_UNTIL_END_OF_SESSION = 2;</span>
<a href="#l4.193"></a><span id="l4.193" class="difflineplus">+</span>
<a href="#l4.194"></a><span id="l4.194" class="difflineplus">+      if (param.ExpireAtSessionEnd !== undefined || param.Locked) {</span>
<a href="#l4.195"></a><span id="l4.195" class="difflineplus">+        let newLifetimePolicy = KEEP_COOKIES_UNTIL_EXPIRATION;</span>
<a href="#l4.196"></a><span id="l4.196" class="difflineplus">+        if (param.ExpireAtSessionEnd) {</span>
<a href="#l4.197"></a><span id="l4.197" class="difflineplus">+          newLifetimePolicy = KEEP_COOKIES_UNTIL_END_OF_SESSION;</span>
<a href="#l4.198"></a><span id="l4.198" class="difflineplus">+        }</span>
<a href="#l4.199"></a><span id="l4.199" class="difflineplus">+</span>
<a href="#l4.200"></a><span id="l4.200" class="difflineplus">+        setDefaultPref(</span>
<a href="#l4.201"></a><span id="l4.201" class="difflineplus">+          &quot;network.cookie.lifetimePolicy&quot;,</span>
<a href="#l4.202"></a><span id="l4.202" class="difflineplus">+          newLifetimePolicy,</span>
<a href="#l4.203"></a><span id="l4.203" class="difflineplus">+          param.Locked</span>
<a href="#l4.204"></a><span id="l4.204" class="difflineplus">+        );</span>
<a href="#l4.205"></a><span id="l4.205" class="difflineplus">+      }</span>
<a href="#l4.206"></a><span id="l4.206" class="difflineplus">+    },</span>
<a href="#l4.207"></a><span id="l4.207" class="difflineplus">+  },</span>
<a href="#l4.208"></a><span id="l4.208" class="difflineplus">+</span>
<a href="#l4.209"></a><span id="l4.209" class="difflineplus">+  DefaultDownloadDirectory: {</span>
<a href="#l4.210"></a><span id="l4.210" class="difflineplus">+    onBeforeAddons(manager, param) {</span>
<a href="#l4.211"></a><span id="l4.211" class="difflineplus">+      setDefaultPref(&quot;browser.download.dir&quot;, replacePathVariables(param));</span>
<a href="#l4.212"></a><span id="l4.212" class="difflineplus">+      // If a custom download directory is being used, just lock folder list to 2.</span>
<a href="#l4.213"></a><span id="l4.213" class="difflineplus">+      setAndLockPref(&quot;browser.download.folderList&quot;, 2);</span>
<a href="#l4.214"></a><span id="l4.214" class="difflineplus">+    },</span>
<a href="#l4.215"></a><span id="l4.215" class="difflineplus">+  },</span>
<a href="#l4.216"></a><span id="l4.216" class="difflineplus">+</span>
<a href="#l4.217"></a><span id="l4.217">   DisableAppUpdate: {</span>
<a href="#l4.218"></a><span id="l4.218">     onBeforeAddons(manager, param) {</span>
<a href="#l4.219"></a><span id="l4.219">       if (param) {</span>
<a href="#l4.220"></a><span id="l4.220">         manager.disallowFeature(&quot;appUpdate&quot;);</span>
<a href="#l4.221"></a><span id="l4.221">       }</span>
<a href="#l4.222"></a><span id="l4.222">     },</span>
<a href="#l4.223"></a><span id="l4.223">   },</span>
<a href="#l4.224"></a><span id="l4.224"> </span>
<a href="#l4.225"></a><span id="l4.225" class="difflineat">@@ -276,16 +430,32 @@ var Policies = {</span>
<a href="#l4.226"></a><span id="l4.226">   DisableMasterPasswordCreation: {</span>
<a href="#l4.227"></a><span id="l4.227">     onBeforeUIStartup(manager, param) {</span>
<a href="#l4.228"></a><span id="l4.228">       if (param) {</span>
<a href="#l4.229"></a><span id="l4.229">         manager.disallowFeature(&quot;createMasterPassword&quot;);</span>
<a href="#l4.230"></a><span id="l4.230">       }</span>
<a href="#l4.231"></a><span id="l4.231">     },</span>
<a href="#l4.232"></a><span id="l4.232">   },</span>
<a href="#l4.233"></a><span id="l4.233"> </span>
<a href="#l4.234"></a><span id="l4.234" class="difflineplus">+  DisablePasswordReveal: {</span>
<a href="#l4.235"></a><span id="l4.235" class="difflineplus">+    onBeforeUIStartup(manager, param) {</span>
<a href="#l4.236"></a><span id="l4.236" class="difflineplus">+      if (param) {</span>
<a href="#l4.237"></a><span id="l4.237" class="difflineplus">+        manager.disallowFeature(&quot;passwordReveal&quot;);</span>
<a href="#l4.238"></a><span id="l4.238" class="difflineplus">+      }</span>
<a href="#l4.239"></a><span id="l4.239" class="difflineplus">+    },</span>
<a href="#l4.240"></a><span id="l4.240" class="difflineplus">+  },</span>
<a href="#l4.241"></a><span id="l4.241" class="difflineplus">+</span>
<a href="#l4.242"></a><span id="l4.242" class="difflineplus">+  DisableSafeMode: {</span>
<a href="#l4.243"></a><span id="l4.243" class="difflineplus">+    onBeforeUIStartup(manager, param) {</span>
<a href="#l4.244"></a><span id="l4.244" class="difflineplus">+      if (param) {</span>
<a href="#l4.245"></a><span id="l4.245" class="difflineplus">+        manager.disallowFeature(&quot;safeMode&quot;);</span>
<a href="#l4.246"></a><span id="l4.246" class="difflineplus">+      }</span>
<a href="#l4.247"></a><span id="l4.247" class="difflineplus">+    },</span>
<a href="#l4.248"></a><span id="l4.248" class="difflineplus">+  },</span>
<a href="#l4.249"></a><span id="l4.249" class="difflineplus">+</span>
<a href="#l4.250"></a><span id="l4.250">   DisableSecurityBypass: {</span>
<a href="#l4.251"></a><span id="l4.251">     onBeforeUIStartup(manager, param) {</span>
<a href="#l4.252"></a><span id="l4.252">       if (&quot;InvalidCertificate&quot; in param) {</span>
<a href="#l4.253"></a><span id="l4.253">         setAndLockPref(</span>
<a href="#l4.254"></a><span id="l4.254">           &quot;security.certerror.hideAddException&quot;,</span>
<a href="#l4.255"></a><span id="l4.255">           param.InvalidCertificate</span>
<a href="#l4.256"></a><span id="l4.256">         );</span>
<a href="#l4.257"></a><span id="l4.257">       }</span>
<a href="#l4.258"></a><span id="l4.258" class="difflineat">@@ -302,16 +472,37 @@ var Policies = {</span>
<a href="#l4.259"></a><span id="l4.259">   DisableSystemAddonUpdate: {</span>
<a href="#l4.260"></a><span id="l4.260">     onBeforeAddons(manager, param) {</span>
<a href="#l4.261"></a><span id="l4.261">       if (param) {</span>
<a href="#l4.262"></a><span id="l4.262">         manager.disallowFeature(&quot;SysAddonUpdate&quot;);</span>
<a href="#l4.263"></a><span id="l4.263">       }</span>
<a href="#l4.264"></a><span id="l4.264">     },</span>
<a href="#l4.265"></a><span id="l4.265">   },</span>
<a href="#l4.266"></a><span id="l4.266"> </span>
<a href="#l4.267"></a><span id="l4.267" class="difflineplus">+  DisableTelemetry: {</span>
<a href="#l4.268"></a><span id="l4.268" class="difflineplus">+    onBeforeAddons(manager, param) {</span>
<a href="#l4.269"></a><span id="l4.269" class="difflineplus">+      if (param) {</span>
<a href="#l4.270"></a><span id="l4.270" class="difflineplus">+        setAndLockPref(&quot;datareporting.healthreport.uploadEnabled&quot;, false);</span>
<a href="#l4.271"></a><span id="l4.271" class="difflineplus">+        setAndLockPref(&quot;datareporting.policy.dataSubmissionEnabled&quot;, false);</span>
<a href="#l4.272"></a><span id="l4.272" class="difflineplus">+        blockAboutPage(manager, &quot;about:telemetry&quot;);</span>
<a href="#l4.273"></a><span id="l4.273" class="difflineplus">+      }</span>
<a href="#l4.274"></a><span id="l4.274" class="difflineplus">+    },</span>
<a href="#l4.275"></a><span id="l4.275" class="difflineplus">+  },</span>
<a href="#l4.276"></a><span id="l4.276" class="difflineplus">+</span>
<a href="#l4.277"></a><span id="l4.277" class="difflineplus">+  DownloadDirectory: {</span>
<a href="#l4.278"></a><span id="l4.278" class="difflineplus">+    onBeforeAddons(manager, param) {</span>
<a href="#l4.279"></a><span id="l4.279" class="difflineplus">+      setAndLockPref(&quot;browser.download.dir&quot;, replacePathVariables(param));</span>
<a href="#l4.280"></a><span id="l4.280" class="difflineplus">+      // If a custom download directory is being used, just lock folder list to 2.</span>
<a href="#l4.281"></a><span id="l4.281" class="difflineplus">+      setAndLockPref(&quot;browser.download.folderList&quot;, 2);</span>
<a href="#l4.282"></a><span id="l4.282" class="difflineplus">+      // Per Chrome spec, user can't choose to download every time</span>
<a href="#l4.283"></a><span id="l4.283" class="difflineplus">+      // if this is set.</span>
<a href="#l4.284"></a><span id="l4.284" class="difflineplus">+      setAndLockPref(&quot;browser.download.useDownloadDir&quot;, true);</span>
<a href="#l4.285"></a><span id="l4.285" class="difflineplus">+    },</span>
<a href="#l4.286"></a><span id="l4.286" class="difflineplus">+  },</span>
<a href="#l4.287"></a><span id="l4.287" class="difflineplus">+</span>
<a href="#l4.288"></a><span id="l4.288">   Extensions: {</span>
<a href="#l4.289"></a><span id="l4.289">     onBeforeUIStartup(manager, param) {</span>
<a href="#l4.290"></a><span id="l4.290">       let uninstallingPromise = Promise.resolve();</span>
<a href="#l4.291"></a><span id="l4.291">       if (&quot;Uninstall&quot; in param) {</span>
<a href="#l4.292"></a><span id="l4.292">         uninstallingPromise = runOncePerModification(</span>
<a href="#l4.293"></a><span id="l4.293">           &quot;extensionsUninstall&quot;,</span>
<a href="#l4.294"></a><span id="l4.294">           JSON.stringify(param.Uninstall),</span>
<a href="#l4.295"></a><span id="l4.295">           async () =&gt; {</span>
<a href="#l4.296"></a><span id="l4.296" class="difflineat">@@ -379,39 +570,63 @@ var Policies = {</span>
<a href="#l4.297"></a><span id="l4.297">   ExtensionUpdate: {</span>
<a href="#l4.298"></a><span id="l4.298">     onBeforeAddons(manager, param) {</span>
<a href="#l4.299"></a><span id="l4.299">       if (!param) {</span>
<a href="#l4.300"></a><span id="l4.300">         setAndLockPref(&quot;extensions.update.enabled&quot;, param);</span>
<a href="#l4.301"></a><span id="l4.301">       }</span>
<a href="#l4.302"></a><span id="l4.302">     },</span>
<a href="#l4.303"></a><span id="l4.303">   },</span>
<a href="#l4.304"></a><span id="l4.304"> </span>
<a href="#l4.305"></a><span id="l4.305" class="difflineplus">+  HardwareAcceleration: {</span>
<a href="#l4.306"></a><span id="l4.306" class="difflineplus">+    onBeforeAddons(manager, param) {</span>
<a href="#l4.307"></a><span id="l4.307" class="difflineplus">+      if (!param) {</span>
<a href="#l4.308"></a><span id="l4.308" class="difflineplus">+        setAndLockPref(&quot;layers.acceleration.disabled&quot;, true);</span>
<a href="#l4.309"></a><span id="l4.309" class="difflineplus">+      }</span>
<a href="#l4.310"></a><span id="l4.310" class="difflineplus">+    },</span>
<a href="#l4.311"></a><span id="l4.311" class="difflineplus">+  },</span>
<a href="#l4.312"></a><span id="l4.312" class="difflineplus">+</span>
<a href="#l4.313"></a><span id="l4.313">   InstallAddonsPermission: {</span>
<a href="#l4.314"></a><span id="l4.314">     onBeforeUIStartup(manager, param) {</span>
<a href="#l4.315"></a><span id="l4.315">       if (&quot;Allow&quot; in param) {</span>
<a href="#l4.316"></a><span id="l4.316">         addAllowDenyPermissions(&quot;install&quot;, param.Allow, null);</span>
<a href="#l4.317"></a><span id="l4.317">       }</span>
<a href="#l4.318"></a><span id="l4.318">       if (&quot;Default&quot; in param) {</span>
<a href="#l4.319"></a><span id="l4.319">         setAndLockPref(&quot;xpinstall.enabled&quot;, param.Default);</span>
<a href="#l4.320"></a><span id="l4.320">         if (!param.Default) {</span>
<a href="#l4.321"></a><span id="l4.321">           blockAboutPage(manager, &quot;about:debugging&quot;);</span>
<a href="#l4.322"></a><span id="l4.322">           manager.disallowFeature(&quot;xpinstall&quot;);</span>
<a href="#l4.323"></a><span id="l4.323">         }</span>
<a href="#l4.324"></a><span id="l4.324">       }</span>
<a href="#l4.325"></a><span id="l4.325">     },</span>
<a href="#l4.326"></a><span id="l4.326">   },</span>
<a href="#l4.327"></a><span id="l4.327"> </span>
<a href="#l4.328"></a><span id="l4.328" class="difflineplus">+  PasswordManagerEnabled: {</span>
<a href="#l4.329"></a><span id="l4.329" class="difflineplus">+    onBeforeUIStartup(manager, param) {</span>
<a href="#l4.330"></a><span id="l4.330" class="difflineplus">+      if (!param) {</span>
<a href="#l4.331"></a><span id="l4.331" class="difflineplus">+        blockAboutPage(manager, &quot;about:logins&quot;, true);</span>
<a href="#l4.332"></a><span id="l4.332" class="difflineplus">+        setAndLockPref(&quot;pref.privacy.disable_button.view_passwords&quot;, true);</span>
<a href="#l4.333"></a><span id="l4.333" class="difflineplus">+      }</span>
<a href="#l4.334"></a><span id="l4.334" class="difflineplus">+      setAndLockPref(&quot;signon.rememberSignons&quot;, param);</span>
<a href="#l4.335"></a><span id="l4.335" class="difflineplus">+    },</span>
<a href="#l4.336"></a><span id="l4.336" class="difflineplus">+  },</span>
<a href="#l4.337"></a><span id="l4.337" class="difflineplus">+</span>
<a href="#l4.338"></a><span id="l4.338">   Preferences: {</span>
<a href="#l4.339"></a><span id="l4.339">     onBeforeAddons(manager, param) {</span>
<a href="#l4.340"></a><span id="l4.340">       for (let preference in param) {</span>
<a href="#l4.341"></a><span id="l4.341">         setAndLockPref(preference, param[preference]);</span>
<a href="#l4.342"></a><span id="l4.342">       }</span>
<a href="#l4.343"></a><span id="l4.343">     },</span>
<a href="#l4.344"></a><span id="l4.344">   },</span>
<a href="#l4.345"></a><span id="l4.345"> </span>
<a href="#l4.346"></a><span id="l4.346" class="difflineplus">+  PromptForDownloadLocation: {</span>
<a href="#l4.347"></a><span id="l4.347" class="difflineplus">+    onBeforeAddons(manager, param) {</span>
<a href="#l4.348"></a><span id="l4.348" class="difflineplus">+      setAndLockPref(&quot;browser.download.useDownloadDir&quot;, !param);</span>
<a href="#l4.349"></a><span id="l4.349" class="difflineplus">+    },</span>
<a href="#l4.350"></a><span id="l4.350" class="difflineplus">+  },</span>
<a href="#l4.351"></a><span id="l4.351" class="difflineplus">+</span>
<a href="#l4.352"></a><span id="l4.352">   Proxy: {</span>
<a href="#l4.353"></a><span id="l4.353">     onBeforeAddons(manager, param) {</span>
<a href="#l4.354"></a><span id="l4.354">       if (param.Locked) {</span>
<a href="#l4.355"></a><span id="l4.355">         manager.disallowFeature(&quot;changeProxySettings&quot;);</span>
<a href="#l4.356"></a><span id="l4.356">         ProxyPolicies.configureProxySettings(param, setAndLockPref);</span>
<a href="#l4.357"></a><span id="l4.357">       } else {</span>
<a href="#l4.358"></a><span id="l4.358">         ProxyPolicies.configureProxySettings(param, setDefaultPref);</span>
<a href="#l4.359"></a><span id="l4.359">       }</span>
<a href="#l4.360"></a><span id="l4.360" class="difflineat">@@ -645,16 +860,23 @@ async function runOncePerModification(ac</span>
<a href="#l4.361"></a><span id="l4.361">  *</span>
<a href="#l4.362"></a><span id="l4.362">  * Helper function that clears a runOnce policy.</span>
<a href="#l4.363"></a><span id="l4.363">  */</span>
<a href="#l4.364"></a><span id="l4.364"> function clearRunOnceModification(actionName) {</span>
<a href="#l4.365"></a><span id="l4.365">   let prefName = `browser.policies.runOncePerModification.${actionName}`;</span>
<a href="#l4.366"></a><span id="l4.366">   Services.prefs.clearUserPref(prefName);</span>
<a href="#l4.367"></a><span id="l4.367"> }</span>
<a href="#l4.368"></a><span id="l4.368"> </span>
<a href="#l4.369"></a><span id="l4.369" class="difflineplus">+function replacePathVariables(path) {</span>
<a href="#l4.370"></a><span id="l4.370" class="difflineplus">+  if (path.includes(&quot;${home}&quot;)) {</span>
<a href="#l4.371"></a><span id="l4.371" class="difflineplus">+    return path.replace(&quot;${home}&quot;, FileUtils.getFile(&quot;Home&quot;, []).path);</span>
<a href="#l4.372"></a><span id="l4.372" class="difflineplus">+  }</span>
<a href="#l4.373"></a><span id="l4.373" class="difflineplus">+  return path;</span>
<a href="#l4.374"></a><span id="l4.374" class="difflineplus">+}</span>
<a href="#l4.375"></a><span id="l4.375" class="difflineplus">+</span>
<a href="#l4.376"></a><span id="l4.376"> /**</span>
<a href="#l4.377"></a><span id="l4.377">  * installAddonFromURL</span>
<a href="#l4.378"></a><span id="l4.378">  *</span>
<a href="#l4.379"></a><span id="l4.379">  * Helper function that installs an addon from a URL</span>
<a href="#l4.380"></a><span id="l4.380">  * and verifies that the addon ID matches.</span>
<a href="#l4.381"></a><span id="l4.381">  */</span>
<a href="#l4.382"></a><span id="l4.382"> function installAddonFromURL(url, extensionID) {</span>
<a href="#l4.383"></a><span id="l4.383">   AddonManager.getInstallForURL(url, {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/components/enterprisepolicies/schemas/policies-schema.json</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/components/enterprisepolicies/schemas/policies-schema.json</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -1,51 +1,166 @@</span>
<a href="#l5.4"></a><span id="l5.4"> {</span>
<a href="#l5.5"></a><span id="l5.5">   &quot;$schema&quot;: &quot;http://json-schema.org/draft-04/schema#&quot;,</span>
<a href="#l5.6"></a><span id="l5.6">   &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.7"></a><span id="l5.7">   &quot;properties&quot;: {</span>
<a href="#l5.8"></a><span id="l5.8" class="difflineplus">+</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineplus">+    &quot;3rdparty&quot;: {</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineplus">+      &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+      &quot;properties&quot;: {</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+        &quot;Extensions&quot; : {</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+          &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+          &quot;patternProperties&quot;: {</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+            &quot;^.*$&quot;: {</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+              &quot;type&quot;: &quot;JSON&quot;</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+            }</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+          }</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+        }</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+      }</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+    },</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+</span>
<a href="#l5.23"></a><span id="l5.23">     &quot;AppAutoUpdate&quot;: {</span>
<a href="#l5.24"></a><span id="l5.24">       &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.25"></a><span id="l5.25">     },</span>
<a href="#l5.26"></a><span id="l5.26"> </span>
<a href="#l5.27"></a><span id="l5.27">     &quot;AppUpdateURL&quot;: {</span>
<a href="#l5.28"></a><span id="l5.28">       &quot;type&quot;: &quot;URL&quot;</span>
<a href="#l5.29"></a><span id="l5.29">     },</span>
<a href="#l5.30"></a><span id="l5.30"> </span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+    &quot;Authentication&quot;: {</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+      &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+      &quot;properties&quot;: {</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+        &quot;SPNEGO&quot; : {</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+          &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+          &quot;items&quot;: {</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+            &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+          }</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+        },</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+        &quot;Delegated&quot; : {</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+          &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+          &quot;items&quot;: {</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+            &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+          }</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+        },</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineplus">+        &quot;NTLM&quot; : {</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineplus">+          &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineplus">+          &quot;items&quot;: {</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineplus">+            &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineplus">+          }</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+        },</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineplus">+        &quot;AllowNonFQDN&quot;: {</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineplus">+          &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineplus">+          &quot;properties&quot;: {</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineplus">+            &quot;SPNEGO&quot;: {</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineplus">+              &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineplus">+            },</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineplus">+</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineplus">+            &quot;NTLM&quot;: {</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineplus">+              &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineplus">+            }</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineplus">+          }</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineplus">+        },</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineplus">+        &quot;AllowProxies&quot;: {</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineplus">+          &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineplus">+          &quot;properties&quot;: {</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineplus">+            &quot;SPNEGO&quot;: {</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineplus">+              &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineplus">+            },</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineplus">+</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineplus">+            &quot;NTLM&quot;: {</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineplus">+              &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineplus">+            }</span>
<a href="#l5.74"></a><span id="l5.74" class="difflineplus">+          }</span>
<a href="#l5.75"></a><span id="l5.75" class="difflineplus">+        },</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineplus">+        &quot;Locked&quot;: {</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineplus">+        },</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineplus">+        &quot;PrivateBrowsing&quot;: {</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineplus">+        }</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineplus">+      }</span>
<a href="#l5.83"></a><span id="l5.83" class="difflineplus">+    },</span>
<a href="#l5.84"></a><span id="l5.84" class="difflineplus">+</span>
<a href="#l5.85"></a><span id="l5.85">     &quot;BlockAboutAddons&quot;: {</span>
<a href="#l5.86"></a><span id="l5.86">       &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.87"></a><span id="l5.87">     },</span>
<a href="#l5.88"></a><span id="l5.88"> </span>
<a href="#l5.89"></a><span id="l5.89">     &quot;BlockAboutConfig&quot;: {</span>
<a href="#l5.90"></a><span id="l5.90">       &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.91"></a><span id="l5.91">     },</span>
<a href="#l5.92"></a><span id="l5.92"> </span>
<a href="#l5.93"></a><span id="l5.93">     &quot;BlockAboutProfiles&quot;: {</span>
<a href="#l5.94"></a><span id="l5.94">       &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.95"></a><span id="l5.95">     },</span>
<a href="#l5.96"></a><span id="l5.96"> </span>
<a href="#l5.97"></a><span id="l5.97">     &quot;BlockAboutSupport&quot;: {</span>
<a href="#l5.98"></a><span id="l5.98">       &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.99"></a><span id="l5.99">     },</span>
<a href="#l5.100"></a><span id="l5.100"> </span>
<a href="#l5.101"></a><span id="l5.101" class="difflineplus">+    &quot;CaptivePortal&quot;: {</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineplus">+      &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineplus">+    },</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineplus">+</span>
<a href="#l5.105"></a><span id="l5.105">     &quot;Certificates&quot;: {</span>
<a href="#l5.106"></a><span id="l5.106">       &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.107"></a><span id="l5.107">       &quot;properties&quot;: {</span>
<a href="#l5.108"></a><span id="l5.108">         &quot;ImportEnterpriseRoots&quot;: {</span>
<a href="#l5.109"></a><span id="l5.109">           &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.110"></a><span id="l5.110">         },</span>
<a href="#l5.111"></a><span id="l5.111">         &quot;Install&quot;: {</span>
<a href="#l5.112"></a><span id="l5.112">           &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l5.113"></a><span id="l5.113">           &quot;items&quot;: {</span>
<a href="#l5.114"></a><span id="l5.114">             &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.115"></a><span id="l5.115">           }</span>
<a href="#l5.116"></a><span id="l5.116">         }</span>
<a href="#l5.117"></a><span id="l5.117">       }</span>
<a href="#l5.118"></a><span id="l5.118">     },</span>
<a href="#l5.119"></a><span id="l5.119"> </span>
<a href="#l5.120"></a><span id="l5.120" class="difflineplus">+    &quot;Cookies&quot;: {</span>
<a href="#l5.121"></a><span id="l5.121" class="difflineplus">+      &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.122"></a><span id="l5.122" class="difflineplus">+      &quot;properties&quot;: {</span>
<a href="#l5.123"></a><span id="l5.123" class="difflineplus">+        &quot;Allow&quot;: {</span>
<a href="#l5.124"></a><span id="l5.124" class="difflineplus">+          &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l5.125"></a><span id="l5.125" class="difflineplus">+          &quot;strict&quot;: false,</span>
<a href="#l5.126"></a><span id="l5.126" class="difflineplus">+          &quot;items&quot;: {</span>
<a href="#l5.127"></a><span id="l5.127" class="difflineplus">+            &quot;type&quot;: &quot;origin&quot;</span>
<a href="#l5.128"></a><span id="l5.128" class="difflineplus">+          }</span>
<a href="#l5.129"></a><span id="l5.129" class="difflineplus">+        },</span>
<a href="#l5.130"></a><span id="l5.130" class="difflineplus">+</span>
<a href="#l5.131"></a><span id="l5.131" class="difflineplus">+        &quot;Block&quot;: {</span>
<a href="#l5.132"></a><span id="l5.132" class="difflineplus">+          &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l5.133"></a><span id="l5.133" class="difflineplus">+          &quot;strict&quot;: false,</span>
<a href="#l5.134"></a><span id="l5.134" class="difflineplus">+          &quot;items&quot;: {</span>
<a href="#l5.135"></a><span id="l5.135" class="difflineplus">+            &quot;type&quot;: &quot;origin&quot;</span>
<a href="#l5.136"></a><span id="l5.136" class="difflineplus">+          }</span>
<a href="#l5.137"></a><span id="l5.137" class="difflineplus">+        },</span>
<a href="#l5.138"></a><span id="l5.138" class="difflineplus">+</span>
<a href="#l5.139"></a><span id="l5.139" class="difflineplus">+        &quot;Default&quot;: {</span>
<a href="#l5.140"></a><span id="l5.140" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.141"></a><span id="l5.141" class="difflineplus">+        },</span>
<a href="#l5.142"></a><span id="l5.142" class="difflineplus">+</span>
<a href="#l5.143"></a><span id="l5.143" class="difflineplus">+        &quot;AcceptThirdParty&quot;: {</span>
<a href="#l5.144"></a><span id="l5.144" class="difflineplus">+          &quot;type&quot;: &quot;string&quot;,</span>
<a href="#l5.145"></a><span id="l5.145" class="difflineplus">+          &quot;enum&quot;: [&quot;always&quot;, &quot;never&quot;, &quot;from-visited&quot;]</span>
<a href="#l5.146"></a><span id="l5.146" class="difflineplus">+        },</span>
<a href="#l5.147"></a><span id="l5.147" class="difflineplus">+</span>
<a href="#l5.148"></a><span id="l5.148" class="difflineplus">+        &quot;ExpireAtSessionEnd&quot;: {</span>
<a href="#l5.149"></a><span id="l5.149" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.150"></a><span id="l5.150" class="difflineplus">+        },</span>
<a href="#l5.151"></a><span id="l5.151" class="difflineplus">+</span>
<a href="#l5.152"></a><span id="l5.152" class="difflineplus">+        &quot;Locked&quot;: {</span>
<a href="#l5.153"></a><span id="l5.153" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.154"></a><span id="l5.154" class="difflineplus">+        }</span>
<a href="#l5.155"></a><span id="l5.155" class="difflineplus">+      }</span>
<a href="#l5.156"></a><span id="l5.156" class="difflineplus">+    },</span>
<a href="#l5.157"></a><span id="l5.157" class="difflineplus">+</span>
<a href="#l5.158"></a><span id="l5.158" class="difflineplus">+    &quot;DefaultDownloadDirectory&quot;: {</span>
<a href="#l5.159"></a><span id="l5.159" class="difflineplus">+      &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.160"></a><span id="l5.160" class="difflineplus">+    },</span>
<a href="#l5.161"></a><span id="l5.161" class="difflineplus">+</span>
<a href="#l5.162"></a><span id="l5.162">     &quot;DisableAppUpdate&quot;: {</span>
<a href="#l5.163"></a><span id="l5.163">       &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.164"></a><span id="l5.164">     },</span>
<a href="#l5.165"></a><span id="l5.165"> </span>
<a href="#l5.166"></a><span id="l5.166">     &quot;DisabledCiphers&quot;: {</span>
<a href="#l5.167"></a><span id="l5.167">       &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.168"></a><span id="l5.168">       &quot;properties&quot;: {</span>
<a href="#l5.169"></a><span id="l5.169">         &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;: {</span>
<a href="#l5.170"></a><span id="l5.170" class="difflineat">@@ -81,16 +196,24 @@</span>
<a href="#l5.171"></a><span id="l5.171">     &quot;DisableDeveloperTools&quot;: {</span>
<a href="#l5.172"></a><span id="l5.172">       &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.173"></a><span id="l5.173">     },</span>
<a href="#l5.174"></a><span id="l5.174"> </span>
<a href="#l5.175"></a><span id="l5.175">     &quot;DisableMasterPasswordCreation&quot;: {</span>
<a href="#l5.176"></a><span id="l5.176">       &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.177"></a><span id="l5.177">     },</span>
<a href="#l5.178"></a><span id="l5.178"> </span>
<a href="#l5.179"></a><span id="l5.179" class="difflineplus">+    &quot;DisablePasswordReveal&quot;: {</span>
<a href="#l5.180"></a><span id="l5.180" class="difflineplus">+      &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.181"></a><span id="l5.181" class="difflineplus">+    },</span>
<a href="#l5.182"></a><span id="l5.182" class="difflineplus">+</span>
<a href="#l5.183"></a><span id="l5.183" class="difflineplus">+    &quot;DisableSafeMode&quot;: {</span>
<a href="#l5.184"></a><span id="l5.184" class="difflineplus">+      &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.185"></a><span id="l5.185" class="difflineplus">+    },</span>
<a href="#l5.186"></a><span id="l5.186" class="difflineplus">+</span>
<a href="#l5.187"></a><span id="l5.187">     &quot;DisableSecurityBypass&quot;: {</span>
<a href="#l5.188"></a><span id="l5.188">       &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.189"></a><span id="l5.189">       &quot;properties&quot;: {</span>
<a href="#l5.190"></a><span id="l5.190">         &quot;InvalidCertificate&quot;: {</span>
<a href="#l5.191"></a><span id="l5.191">           &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.192"></a><span id="l5.192">         },</span>
<a href="#l5.193"></a><span id="l5.193"> </span>
<a href="#l5.194"></a><span id="l5.194">         &quot;SafeBrowsing&quot;: {</span>
<a href="#l5.195"></a><span id="l5.195" class="difflineat">@@ -98,16 +221,24 @@</span>
<a href="#l5.196"></a><span id="l5.196">         }</span>
<a href="#l5.197"></a><span id="l5.197">       }</span>
<a href="#l5.198"></a><span id="l5.198">     },</span>
<a href="#l5.199"></a><span id="l5.199"> </span>
<a href="#l5.200"></a><span id="l5.200">     &quot;DisableSystemAddonUpdate&quot;: {</span>
<a href="#l5.201"></a><span id="l5.201">       &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.202"></a><span id="l5.202">     },</span>
<a href="#l5.203"></a><span id="l5.203"> </span>
<a href="#l5.204"></a><span id="l5.204" class="difflineplus">+    &quot;DisableTelemetry&quot;: {</span>
<a href="#l5.205"></a><span id="l5.205" class="difflineplus">+      &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.206"></a><span id="l5.206" class="difflineplus">+    },</span>
<a href="#l5.207"></a><span id="l5.207" class="difflineplus">+</span>
<a href="#l5.208"></a><span id="l5.208" class="difflineplus">+    &quot;DownloadDirectory&quot;: {</span>
<a href="#l5.209"></a><span id="l5.209" class="difflineplus">+      &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.210"></a><span id="l5.210" class="difflineplus">+    },</span>
<a href="#l5.211"></a><span id="l5.211" class="difflineplus">+</span>
<a href="#l5.212"></a><span id="l5.212">     &quot;Extensions&quot;: {</span>
<a href="#l5.213"></a><span id="l5.213">       &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.214"></a><span id="l5.214">       &quot;properties&quot;: {</span>
<a href="#l5.215"></a><span id="l5.215">         &quot;Install&quot; : {</span>
<a href="#l5.216"></a><span id="l5.216">           &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l5.217"></a><span id="l5.217">           &quot;items&quot;: {</span>
<a href="#l5.218"></a><span id="l5.218">             &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.219"></a><span id="l5.219">           }</span>
<a href="#l5.220"></a><span id="l5.220" class="difflineat">@@ -140,56 +271,129 @@</span>
<a href="#l5.221"></a><span id="l5.221">         }</span>
<a href="#l5.222"></a><span id="l5.222">       }</span>
<a href="#l5.223"></a><span id="l5.223">     },</span>
<a href="#l5.224"></a><span id="l5.224"> </span>
<a href="#l5.225"></a><span id="l5.225">     &quot;ExtensionUpdate&quot;: {</span>
<a href="#l5.226"></a><span id="l5.226">       &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.227"></a><span id="l5.227">     },</span>
<a href="#l5.228"></a><span id="l5.228"> </span>
<a href="#l5.229"></a><span id="l5.229" class="difflineplus">+    &quot;HardwareAcceleration&quot;: {</span>
<a href="#l5.230"></a><span id="l5.230" class="difflineplus">+      &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.231"></a><span id="l5.231" class="difflineplus">+    },</span>
<a href="#l5.232"></a><span id="l5.232" class="difflineplus">+</span>
<a href="#l5.233"></a><span id="l5.233">     &quot;InstallAddonsPermission&quot;: {</span>
<a href="#l5.234"></a><span id="l5.234">       &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.235"></a><span id="l5.235">       &quot;properties&quot;: {</span>
<a href="#l5.236"></a><span id="l5.236">         &quot;Allow&quot;: {</span>
<a href="#l5.237"></a><span id="l5.237">           &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l5.238"></a><span id="l5.238">           &quot;strict&quot;: false,</span>
<a href="#l5.239"></a><span id="l5.239">           &quot;items&quot;: {</span>
<a href="#l5.240"></a><span id="l5.240">             &quot;type&quot;: &quot;origin&quot;</span>
<a href="#l5.241"></a><span id="l5.241">           }</span>
<a href="#l5.242"></a><span id="l5.242">         },</span>
<a href="#l5.243"></a><span id="l5.243">         &quot;Default&quot;: {</span>
<a href="#l5.244"></a><span id="l5.244">           &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.245"></a><span id="l5.245">         }</span>
<a href="#l5.246"></a><span id="l5.246">       }</span>
<a href="#l5.247"></a><span id="l5.247">     },</span>
<a href="#l5.248"></a><span id="l5.248"> </span>
<a href="#l5.249"></a><span id="l5.249" class="difflineplus">+    &quot;PasswordManagerEnabled&quot;: {</span>
<a href="#l5.250"></a><span id="l5.250" class="difflineplus">+      &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.251"></a><span id="l5.251" class="difflineplus">+    },</span>
<a href="#l5.252"></a><span id="l5.252" class="difflineplus">+</span>
<a href="#l5.253"></a><span id="l5.253">     &quot;Preferences&quot;: {</span>
<a href="#l5.254"></a><span id="l5.254">       &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.255"></a><span id="l5.255">       &quot;properties&quot;: {</span>
<a href="#l5.256"></a><span id="l5.256" class="difflineminus">-        &quot;network.IDN_show_punycode&quot;: {</span>
<a href="#l5.257"></a><span id="l5.257" class="difflineplus">+        &quot;accessibility.force_disabled&quot;: {</span>
<a href="#l5.258"></a><span id="l5.258" class="difflineplus">+          &quot;type&quot;: &quot;number&quot;,</span>
<a href="#l5.259"></a><span id="l5.259" class="difflineplus">+          &quot;enum&quot;: [-1, 0, 1]</span>
<a href="#l5.260"></a><span id="l5.260" class="difflineplus">+        },</span>
<a href="#l5.261"></a><span id="l5.261" class="difflineplus">+        &quot;browser.cache.disk.enable&quot;: {</span>
<a href="#l5.262"></a><span id="l5.262">           &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.263"></a><span id="l5.263">         },</span>
<a href="#l5.264"></a><span id="l5.264" class="difflineminus">-        &quot;browser.fixup.dns_first_for_single_words&quot;: {</span>
<a href="#l5.265"></a><span id="l5.265" class="difflineplus">+        &quot;browser.safebrowsing.phishing.enabled&quot;: {</span>
<a href="#l5.266"></a><span id="l5.266" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.267"></a><span id="l5.267" class="difflineplus">+        },</span>
<a href="#l5.268"></a><span id="l5.268" class="difflineplus">+        &quot;browser.safebrowsing.malware.enabled&quot;: {</span>
<a href="#l5.269"></a><span id="l5.269" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.270"></a><span id="l5.270" class="difflineplus">+        },</span>
<a href="#l5.271"></a><span id="l5.271" class="difflineplus">+        &quot;browser.search.update&quot;: {</span>
<a href="#l5.272"></a><span id="l5.272">           &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.273"></a><span id="l5.273">         },</span>
<a href="#l5.274"></a><span id="l5.274">         &quot;browser.cache.disk.parent_directory&quot;: {</span>
<a href="#l5.275"></a><span id="l5.275">           &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.276"></a><span id="l5.276">         },</span>
<a href="#l5.277"></a><span id="l5.277" class="difflineminus">-        &quot;browser.urlbar.suggest.openpage&quot;: {</span>
<a href="#l5.278"></a><span id="l5.278" class="difflineplus">+        &quot;datareporting.policy.dataSubmissionPolicyBypassNotification&quot;: {</span>
<a href="#l5.279"></a><span id="l5.279" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.280"></a><span id="l5.280" class="difflineplus">+        },</span>
<a href="#l5.281"></a><span id="l5.281" class="difflineplus">+        &quot;dom.allow_scripts_to_close_windows&quot;: {</span>
<a href="#l5.282"></a><span id="l5.282" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.283"></a><span id="l5.283" class="difflineplus">+        },</span>
<a href="#l5.284"></a><span id="l5.284" class="difflineplus">+        &quot;dom.disable_window_flip&quot;: {</span>
<a href="#l5.285"></a><span id="l5.285" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.286"></a><span id="l5.286" class="difflineplus">+        },</span>
<a href="#l5.287"></a><span id="l5.287" class="difflineplus">+        &quot;dom.disable_window_move_resize&quot;: {</span>
<a href="#l5.288"></a><span id="l5.288" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.289"></a><span id="l5.289" class="difflineplus">+        },</span>
<a href="#l5.290"></a><span id="l5.290" class="difflineplus">+        &quot;dom.event.contextmenu.enabled&quot;: {</span>
<a href="#l5.291"></a><span id="l5.291" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.292"></a><span id="l5.292" class="difflineplus">+        },</span>
<a href="#l5.293"></a><span id="l5.293" class="difflineplus">+        &quot;dom.keyboardevent.keypress.hack.dispatch_non_printable_keys.addl&quot;: {</span>
<a href="#l5.294"></a><span id="l5.294" class="difflineplus">+          &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.295"></a><span id="l5.295" class="difflineplus">+        },</span>
<a href="#l5.296"></a><span id="l5.296" class="difflineplus">+        &quot;dom.keyboardevent.keypress.hack.use_legacy_keycode_and_charcode.addl&quot;: {</span>
<a href="#l5.297"></a><span id="l5.297" class="difflineplus">+          &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.298"></a><span id="l5.298" class="difflineplus">+        },</span>
<a href="#l5.299"></a><span id="l5.299" class="difflineplus">+        &quot;extensions.blocklist.enabled&quot;: {</span>
<a href="#l5.300"></a><span id="l5.300" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.301"></a><span id="l5.301" class="difflineplus">+        },</span>
<a href="#l5.302"></a><span id="l5.302" class="difflineplus">+        &quot;geo.enabled&quot;: {</span>
<a href="#l5.303"></a><span id="l5.303" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.304"></a><span id="l5.304" class="difflineplus">+        },</span>
<a href="#l5.305"></a><span id="l5.305" class="difflineplus">+        &quot;intl.accept_languages&quot;: {</span>
<a href="#l5.306"></a><span id="l5.306" class="difflineplus">+          &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.307"></a><span id="l5.307" class="difflineplus">+        },</span>
<a href="#l5.308"></a><span id="l5.308" class="difflineplus">+        &quot;network.dns.disableIPv6&quot;: {</span>
<a href="#l5.309"></a><span id="l5.309">           &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.310"></a><span id="l5.310">         },</span>
<a href="#l5.311"></a><span id="l5.311" class="difflineminus">-        &quot;browser.urlbar.suggest.history&quot;: {</span>
<a href="#l5.312"></a><span id="l5.312" class="difflineplus">+        &quot;network.IDN_show_punycode&quot;: {</span>
<a href="#l5.313"></a><span id="l5.313" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.314"></a><span id="l5.314" class="difflineplus">+        },</span>
<a href="#l5.315"></a><span id="l5.315" class="difflineplus">+        &quot;places.history.enabled&quot;: {</span>
<a href="#l5.316"></a><span id="l5.316" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.317"></a><span id="l5.317" class="difflineplus">+        },</span>
<a href="#l5.318"></a><span id="l5.318" class="difflineplus">+        &quot;print.save_print_settings&quot;: {</span>
<a href="#l5.319"></a><span id="l5.319" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.320"></a><span id="l5.320" class="difflineplus">+        },</span>
<a href="#l5.321"></a><span id="l5.321" class="difflineplus">+        &quot;security.default_personal_cert&quot;: {</span>
<a href="#l5.322"></a><span id="l5.322" class="difflineplus">+          &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.323"></a><span id="l5.323" class="difflineplus">+        },</span>
<a href="#l5.324"></a><span id="l5.324" class="difflineplus">+        &quot;security.mixed_content.block_active_content&quot;: {</span>
<a href="#l5.325"></a><span id="l5.325">           &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.326"></a><span id="l5.326">         },</span>
<a href="#l5.327"></a><span id="l5.327" class="difflineminus">-        &quot;browser.urlbar.suggest.bookmark&quot;: {</span>
<a href="#l5.328"></a><span id="l5.328" class="difflineplus">+        &quot;security.osclientcerts.autoload&quot;: {</span>
<a href="#l5.329"></a><span id="l5.329" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.330"></a><span id="l5.330" class="difflineplus">+        },</span>
<a href="#l5.331"></a><span id="l5.331" class="difflineplus">+        &quot;security.ssl.errorReporting.enabled&quot;: {</span>
<a href="#l5.332"></a><span id="l5.332">           &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.333"></a><span id="l5.333" class="difflineplus">+        },</span>
<a href="#l5.334"></a><span id="l5.334" class="difflineplus">+        &quot;security.tls.hello_downgrade_check&quot;: {</span>
<a href="#l5.335"></a><span id="l5.335" class="difflineplus">+          &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.336"></a><span id="l5.336" class="difflineplus">+        },</span>
<a href="#l5.337"></a><span id="l5.337" class="difflineplus">+        &quot;widget.content.gtk-theme-override&quot;: {</span>
<a href="#l5.338"></a><span id="l5.338" class="difflineplus">+          &quot;type&quot;: &quot;string&quot;</span>
<a href="#l5.339"></a><span id="l5.339">         }</span>
<a href="#l5.340"></a><span id="l5.340">       }</span>
<a href="#l5.341"></a><span id="l5.341">     },</span>
<a href="#l5.342"></a><span id="l5.342"> </span>
<a href="#l5.343"></a><span id="l5.343" class="difflineplus">+    &quot;PromptForDownloadLocation&quot;: {</span>
<a href="#l5.344"></a><span id="l5.344" class="difflineplus">+      &quot;type&quot;: &quot;boolean&quot;</span>
<a href="#l5.345"></a><span id="l5.345" class="difflineplus">+    },</span>
<a href="#l5.346"></a><span id="l5.346" class="difflineplus">+</span>
<a href="#l5.347"></a><span id="l5.347">     &quot;Proxy&quot;: {</span>
<a href="#l5.348"></a><span id="l5.348">       &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l5.349"></a><span id="l5.349">       &quot;properties&quot;: {</span>
<a href="#l5.350"></a><span id="l5.350">         &quot;Mode&quot;: {</span>
<a href="#l5.351"></a><span id="l5.351">           &quot;type&quot;: &quot;string&quot;,</span>
<a href="#l5.352"></a><span id="l5.352">           &quot;enum&quot;: [&quot;none&quot;, &quot;system&quot;, &quot;manual&quot;, &quot;autoDetect&quot;, &quot;autoConfig&quot;]</span>
<a href="#l5.353"></a><span id="l5.353">         },</span>
<a href="#l5.354"></a><span id="l5.354"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/components/enterprisepolicies/tests/browser/browser.ini</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/browser/browser.ini</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -9,14 +9,16 @@ prefs =</span>
<a href="#l6.4"></a><span id="l6.4"> subsuite = thunderbird</span>
<a href="#l6.5"></a><span id="l6.5"> support-files =</span>
<a href="#l6.6"></a><span id="l6.6">   policytest_v0.1.xpi</span>
<a href="#l6.7"></a><span id="l6.7">   policytest_v0.2.xpi</span>
<a href="#l6.8"></a><span id="l6.8"> </span>
<a href="#l6.9"></a><span id="l6.9"> [browser_policies_setAndLockPref_API.js]</span>
<a href="#l6.10"></a><span id="l6.10"> [browser_policy_app_auto_update.js]</span>
<a href="#l6.11"></a><span id="l6.11"> [browser_policy_app_update.js]</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-[browser_policy_block_about_addons.js]</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-[browser_policy_block_about_config.js]</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-[browser_policy_block_about_profiles.js]</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-[browser_policy_block_about_support.js]</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+[browser_policy_block_about.js]</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+[browser_policy_cookie_settings.js]</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+[browser_policy_disable_safemode.js]</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+[browser_policy_disable_telemetry.js]</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+[browser_policy_downloads.js]</span>
<a href="#l6.21"></a><span id="l6.21"> [browser_policy_extensions.js]</span>
<a href="#l6.22"></a><span id="l6.22"> [browser_policy_extensionsettings.js]</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+[browser_policy_passwordmanager.js]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">new file mode 100644</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineminus">--- /dev/null</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about.js</span>
<a href="#l7.4"></a><span id="l7.4" class="difflineat">@@ -0,0 +1,48 @@</span>
<a href="#l7.5"></a><span id="l7.5" class="difflineplus">+/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l7.6"></a><span id="l7.6" class="difflineplus">+ * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l7.7"></a><span id="l7.7" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l7.8"></a><span id="l7.8" class="difflineplus">+</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineplus">+const policiesToTest = {</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineplus">+  BlockAboutAddons: &quot;about:addons&quot;,</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineplus">+  BlockAboutConfig: &quot;about:config&quot;,</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+  BlockAboutProfiles: &quot;about:profiles&quot;,</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+  BlockAboutSupport: &quot;about:support&quot;,</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+};</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+add_task(async function testAboutTask() {</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+  for (let policy in policiesToTest) {</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+    let policyJSON = { policies: {} };</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+    policyJSON.policies[policy] = true;</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+    await testPageBlockedByPolicy(policyJSON, policiesToTest[policy]);</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+  }</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+  let policyJSON = { policies: {} };</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineplus">+  policyJSON.policies.PasswordManagerEnabled = false;</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineplus">+});</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineplus">+async function testPageBlockedByPolicy(policyJSON, page) {</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+  await setupPolicyEngineWithJson(policyJSON);</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineplus">+</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineplus">+  await withNewTab({ url: &quot;about:blank&quot; }, async browser =&gt; {</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineplus">+    BrowserTestUtils.loadURI(browser, page);</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineplus">+    await BrowserTestUtils.browserLoaded(browser, false, page, true);</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+    await SpecialPowers.spawn(browser, [page], async function(innerPage) {</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineplus">+      ok(</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+        content.document.documentURI.startsWith(</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineplus">+          &quot;about:neterror?e=blockedByPolicy&quot;</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+        ),</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineplus">+        content.document.documentURI +</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineplus">+          &quot; should start with about:neterror?e=blockedByPolicy&quot;</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineplus">+      );</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineplus">+</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineplus">+      // There is currently a testing-specific race condition that causes this test</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+      // to fail, but it is not a problem if we test after the first page load.</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineplus">+      // Until the race condition is fixed, just make sure to test this *after*</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineplus">+      // testing the page load.</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineplus">+      is(</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineplus">+        Services.policies.isAllowed(innerPage),</span>
<a href="#l7.47"></a><span id="l7.47" class="difflineplus">+        false,</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineplus">+        `Policy Engine should report ${innerPage} as not allowed`</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineplus">+      );</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineplus">+    });</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineplus">+  });</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1">deleted file mode 100644</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineminus">--- a/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_addons.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineplus">+++ /dev/null</span>
<a href="#l8.4"></a><span id="l8.4" class="difflineat">@@ -1,19 +0,0 @@</span>
<a href="#l8.5"></a><span id="l8.5" class="difflineminus">-/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l8.6"></a><span id="l8.6" class="difflineminus">- * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l8.7"></a><span id="l8.7" class="difflineminus">-&quot;use strict&quot;;</span>
<a href="#l8.8"></a><span id="l8.8" class="difflineminus">-</span>
<a href="#l8.9"></a><span id="l8.9" class="difflineminus">-add_task(async function test_about_addons() {</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineminus">-  await setupPolicyEngineWithJson({</span>
<a href="#l8.11"></a><span id="l8.11" class="difflineminus">-    policies: {</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-      BlockAboutAddons: true,</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-    },</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-  });</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineminus">-  is(</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineminus">-    Services.policies.isAllowed(&quot;about:addons&quot;),</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineminus">-    false,</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineminus">-    &quot;Policy Engine should report about:addons as not allowed&quot;</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineminus">-  );</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineminus">-</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineminus">-  await checkBlockedPage(&quot;about:addons&quot;, true);</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineminus">-});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1">deleted file mode 100644</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineminus">--- a/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_config.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineplus">+++ /dev/null</span>
<a href="#l9.4"></a><span id="l9.4" class="difflineat">@@ -1,19 +0,0 @@</span>
<a href="#l9.5"></a><span id="l9.5" class="difflineminus">-/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l9.6"></a><span id="l9.6" class="difflineminus">- * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l9.7"></a><span id="l9.7" class="difflineminus">-&quot;use strict&quot;;</span>
<a href="#l9.8"></a><span id="l9.8" class="difflineminus">-</span>
<a href="#l9.9"></a><span id="l9.9" class="difflineminus">-add_task(async function test_about_config() {</span>
<a href="#l9.10"></a><span id="l9.10" class="difflineminus">-  await setupPolicyEngineWithJson({</span>
<a href="#l9.11"></a><span id="l9.11" class="difflineminus">-    policies: {</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-      BlockAboutConfig: true,</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-    },</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineminus">-  });</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineminus">-</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineminus">-  is(</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineminus">-    Services.policies.isAllowed(&quot;about:config&quot;),</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineminus">-    false,</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineminus">-    &quot;Policy Engine should report about:config as not allowed&quot;</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineminus">-  );</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineminus">-</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineminus">-  await checkBlockedPage(&quot;about:config&quot;, true);</span>
<a href="#l9.23"></a><span id="l9.23" class="difflineminus">-});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">deleted file mode 100644</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineminus">--- a/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_profiles.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineplus">+++ /dev/null</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineat">@@ -1,19 +0,0 @@</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineminus">-/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l10.6"></a><span id="l10.6" class="difflineminus">- * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l10.7"></a><span id="l10.7" class="difflineminus">-&quot;use strict&quot;;</span>
<a href="#l10.8"></a><span id="l10.8" class="difflineminus">-</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineminus">-add_task(async function test_about_profiles() {</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineminus">-  await setupPolicyEngineWithJson({</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineminus">-    policies: {</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-      BlockAboutProfiles: true,</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-    },</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-  });</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineminus">-</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineminus">-  is(</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineminus">-    Services.policies.isAllowed(&quot;about:profiles&quot;),</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineminus">-    false,</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineminus">-    &quot;Policy Engine should report about:profiles as not allowed&quot;</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineminus">-  );</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineminus">-</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineminus">-  await checkBlockedPage(&quot;about:profiles&quot;, true);</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineminus">-});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">deleted file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- a/mail/components/enterprisepolicies/tests/browser/browser_policy_block_about_support.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ /dev/null</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -1,19 +0,0 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineminus">-/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineminus">- * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineminus">-&quot;use strict&quot;;</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineminus">-</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineminus">-add_task(async function test_about_support() {</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineminus">-  await setupPolicyEngineWithJson({</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineminus">-    policies: {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-      BlockAboutSupport: true,</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-    },</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-  });</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineminus">-</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineminus">-  is(</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineminus">-    Services.policies.isAllowed(&quot;about:support&quot;),</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineminus">-    false,</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineminus">-    &quot;Policy Engine should report about:support as not allowed&quot;</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineminus">-  );</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineminus">-</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineminus">-  await checkBlockedPage(&quot;about:support&quot;, true);</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineminus">-});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">new file mode 100644</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineminus">--- /dev/null</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/browser/browser_policy_cookie_settings.js</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineat">@@ -0,0 +1,423 @@</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineplus">+/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l12.6"></a><span id="l12.6" class="difflineplus">+ * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l12.7"></a><span id="l12.7" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l12.8"></a><span id="l12.8" class="difflineplus">+</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineplus">+const { UrlClassifierTestUtils } = ChromeUtils.import(</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineplus">+  &quot;resource://testing-common/UrlClassifierTestUtils.jsm&quot;</span>
<a href="#l12.11"></a><span id="l12.11" class="difflineplus">+);</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+XPCOMUtils.defineLazyServiceGetter(</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  Services,</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+  &quot;cookies&quot;,</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+  &quot;@mozilla.org/cookieService;1&quot;,</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+  &quot;nsICookieService&quot;</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+);</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+XPCOMUtils.defineLazyServiceGetter(</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+  Services,</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+  &quot;cookiemgr&quot;,</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+  &quot;@mozilla.org/cookiemanager;1&quot;,</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+  &quot;nsICookieManager&quot;</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+);</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineplus">+function restore_prefs() {</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineplus">+  Services.prefs.clearUserPref(&quot;network.cookie.cookieBehavior&quot;);</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineplus">+  Services.prefs.clearUserPref(&quot;network.cookie.lifetimePolicy&quot;);</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+  Services.prefs.clearUserPref(</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineplus">+    &quot;network.cookieJarSettings.unblocked_for_testing&quot;</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineplus">+  );</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+  Services.prefs.clearUserPref(</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+    &quot;network.cookie.rejectForeignWithExceptions.enabled&quot;</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+  );</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+}</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineplus">+</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineplus">+registerCleanupFunction(restore_prefs);</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineplus">+</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineplus">+async function fake_profile_change() {</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineplus">+  await new Promise(resolve =&gt; {</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineplus">+    Services.obs.addObserver(function waitForDBClose() {</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineplus">+      Services.obs.removeObserver(waitForDBClose, &quot;cookie-db-closed&quot;);</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineplus">+      resolve();</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineplus">+    }, &quot;cookie-db-closed&quot;);</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineplus">+    Services.cookies</span>
<a href="#l12.45"></a><span id="l12.45" class="difflineplus">+      .QueryInterface(Ci.nsIObserver)</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineplus">+      .observe(null, &quot;profile-before-change&quot;, &quot;shutdown-persist&quot;);</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineplus">+  });</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineplus">+  await new Promise(resolve =&gt; {</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineplus">+    Services.obs.addObserver(function waitForDBOpen() {</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineplus">+      Services.obs.removeObserver(waitForDBOpen, &quot;cookie-db-read&quot;);</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineplus">+      resolve();</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineplus">+    }, &quot;cookie-db-read&quot;);</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineplus">+    Services.cookies</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+      .QueryInterface(Ci.nsIObserver)</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineplus">+      .observe(null, &quot;profile-do-change&quot;, &quot;&quot;);</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineplus">+  });</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+}</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineplus">+</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineplus">+async function test_cookie_settings({</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineplus">+  cookiesEnabled,</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineplus">+  thirdPartyCookiesEnabled,</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineplus">+  cookiesExpireAfterSession,</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineplus">+  cookieJarSettingsLocked,</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineplus">+}) {</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineplus">+  let firstPartyURI = NetUtil.newURI(&quot;http://example.com/&quot;);</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineplus">+  let thirdPartyURI = NetUtil.newURI(&quot;http://example.org/&quot;);</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineplus">+  let channel = NetUtil.newChannel({</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineplus">+    uri: firstPartyURI,</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineplus">+    loadUsingSystemPrincipal: true,</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineplus">+  });</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineplus">+  channel.QueryInterface(</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineplus">+    Ci.nsIHttpChannelInternal</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineplus">+  ).forceAllowThirdPartyCookie = true;</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineplus">+  Services.cookies.removeAll();</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineplus">+  Services.cookies.setCookieStringFromHttp(firstPartyURI, &quot;key=value&quot;, channel);</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineplus">+  Services.cookies.setCookieStringFromHttp(thirdPartyURI, &quot;key=value&quot;, channel);</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineplus">+</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineplus">+  let expectedFirstPartyCookies = 1;</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineplus">+  let expectedThirdPartyCookies = 1;</span>
<a href="#l12.80"></a><span id="l12.80" class="difflineplus">+  if (!cookiesEnabled) {</span>
<a href="#l12.81"></a><span id="l12.81" class="difflineplus">+    expectedFirstPartyCookies = 0;</span>
<a href="#l12.82"></a><span id="l12.82" class="difflineplus">+  }</span>
<a href="#l12.83"></a><span id="l12.83" class="difflineplus">+  if (!cookiesEnabled || !thirdPartyCookiesEnabled) {</span>
<a href="#l12.84"></a><span id="l12.84" class="difflineplus">+    expectedThirdPartyCookies = 0;</span>
<a href="#l12.85"></a><span id="l12.85" class="difflineplus">+  }</span>
<a href="#l12.86"></a><span id="l12.86" class="difflineplus">+  is(</span>
<a href="#l12.87"></a><span id="l12.87" class="difflineplus">+    Services.cookiemgr.countCookiesFromHost(firstPartyURI.host),</span>
<a href="#l12.88"></a><span id="l12.88" class="difflineplus">+    expectedFirstPartyCookies,</span>
<a href="#l12.89"></a><span id="l12.89" class="difflineplus">+    &quot;Number of first-party cookies should match expected&quot;</span>
<a href="#l12.90"></a><span id="l12.90" class="difflineplus">+  );</span>
<a href="#l12.91"></a><span id="l12.91" class="difflineplus">+  is(</span>
<a href="#l12.92"></a><span id="l12.92" class="difflineplus">+    Services.cookiemgr.countCookiesFromHost(thirdPartyURI.host),</span>
<a href="#l12.93"></a><span id="l12.93" class="difflineplus">+    expectedThirdPartyCookies,</span>
<a href="#l12.94"></a><span id="l12.94" class="difflineplus">+    &quot;Number of third-party cookies should match expected&quot;</span>
<a href="#l12.95"></a><span id="l12.95" class="difflineplus">+  );</span>
<a href="#l12.96"></a><span id="l12.96" class="difflineplus">+</span>
<a href="#l12.97"></a><span id="l12.97" class="difflineplus">+  // Add a cookie so we can check if it persists past the end of the session</span>
<a href="#l12.98"></a><span id="l12.98" class="difflineplus">+  // but, first remove existing cookies set by this host to put us in a known state</span>
<a href="#l12.99"></a><span id="l12.99" class="difflineplus">+  Services.cookies.removeAll();</span>
<a href="#l12.100"></a><span id="l12.100" class="difflineplus">+  Services.cookies.setCookieStringFromHttp(</span>
<a href="#l12.101"></a><span id="l12.101" class="difflineplus">+    firstPartyURI,</span>
<a href="#l12.102"></a><span id="l12.102" class="difflineplus">+    &quot;key=value; max-age=1000&quot;,</span>
<a href="#l12.103"></a><span id="l12.103" class="difflineplus">+    channel</span>
<a href="#l12.104"></a><span id="l12.104" class="difflineplus">+  );</span>
<a href="#l12.105"></a><span id="l12.105" class="difflineplus">+</span>
<a href="#l12.106"></a><span id="l12.106" class="difflineplus">+  await fake_profile_change();</span>
<a href="#l12.107"></a><span id="l12.107" class="difflineplus">+</span>
<a href="#l12.108"></a><span id="l12.108" class="difflineplus">+  // Now check if the cookie persisted or not</span>
<a href="#l12.109"></a><span id="l12.109" class="difflineplus">+  let expectedCookieCount = 1;</span>
<a href="#l12.110"></a><span id="l12.110" class="difflineplus">+  if (cookiesExpireAfterSession || !cookiesEnabled) {</span>
<a href="#l12.111"></a><span id="l12.111" class="difflineplus">+    expectedCookieCount = 0;</span>
<a href="#l12.112"></a><span id="l12.112" class="difflineplus">+  }</span>
<a href="#l12.113"></a><span id="l12.113" class="difflineplus">+  is(</span>
<a href="#l12.114"></a><span id="l12.114" class="difflineplus">+    Services.cookies.countCookiesFromHost(firstPartyURI.host),</span>
<a href="#l12.115"></a><span id="l12.115" class="difflineplus">+    expectedCookieCount,</span>
<a href="#l12.116"></a><span id="l12.116" class="difflineplus">+    &quot;Number of cookies was not what expected after restarting session&quot;</span>
<a href="#l12.117"></a><span id="l12.117" class="difflineplus">+  );</span>
<a href="#l12.118"></a><span id="l12.118" class="difflineplus">+</span>
<a href="#l12.119"></a><span id="l12.119" class="difflineplus">+  is(</span>
<a href="#l12.120"></a><span id="l12.120" class="difflineplus">+    Services.prefs.prefIsLocked(&quot;network.cookie.cookieBehavior&quot;),</span>
<a href="#l12.121"></a><span id="l12.121" class="difflineplus">+    cookieJarSettingsLocked,</span>
<a href="#l12.122"></a><span id="l12.122" class="difflineplus">+    &quot;Cookie behavior pref lock status should be what is expected&quot;</span>
<a href="#l12.123"></a><span id="l12.123" class="difflineplus">+  );</span>
<a href="#l12.124"></a><span id="l12.124" class="difflineplus">+  is(</span>
<a href="#l12.125"></a><span id="l12.125" class="difflineplus">+    Services.prefs.prefIsLocked(&quot;network.cookie.lifetimePolicy&quot;),</span>
<a href="#l12.126"></a><span id="l12.126" class="difflineplus">+    cookieJarSettingsLocked,</span>
<a href="#l12.127"></a><span id="l12.127" class="difflineplus">+    &quot;Cookie lifetime pref lock status should be what is expected&quot;</span>
<a href="#l12.128"></a><span id="l12.128" class="difflineplus">+  );</span>
<a href="#l12.129"></a><span id="l12.129" class="difflineplus">+</span>
<a href="#l12.130"></a><span id="l12.130" class="difflineplus">+  window.openPreferencesTab(&quot;panePrivacy&quot;);</span>
<a href="#l12.131"></a><span id="l12.131" class="difflineplus">+  await BrowserTestUtils.browserLoaded(window.gPrefTab.browser);</span>
<a href="#l12.132"></a><span id="l12.132" class="difflineplus">+  let { contentDocument, contentWindow } = window.gPrefTab.browser;</span>
<a href="#l12.133"></a><span id="l12.133" class="difflineplus">+  await new Promise(resolve =&gt; contentWindow.setTimeout(resolve));</span>
<a href="#l12.134"></a><span id="l12.134" class="difflineplus">+  let expectControlsDisabled = !cookiesEnabled || cookieJarSettingsLocked;</span>
<a href="#l12.135"></a><span id="l12.135" class="difflineplus">+</span>
<a href="#l12.136"></a><span id="l12.136" class="difflineplus">+  for (let id of [&quot;acceptCookies&quot;, &quot;showCookiesButton&quot;]) {</span>
<a href="#l12.137"></a><span id="l12.137" class="difflineplus">+    is(</span>
<a href="#l12.138"></a><span id="l12.138" class="difflineplus">+      contentDocument.getElementById(id).disabled,</span>
<a href="#l12.139"></a><span id="l12.139" class="difflineplus">+      cookieJarSettingsLocked,</span>
<a href="#l12.140"></a><span id="l12.140" class="difflineplus">+      `#${id} disabled status should match expected`</span>
<a href="#l12.141"></a><span id="l12.141" class="difflineplus">+    );</span>
<a href="#l12.142"></a><span id="l12.142" class="difflineplus">+  }</span>
<a href="#l12.143"></a><span id="l12.143" class="difflineplus">+  for (let id of [</span>
<a href="#l12.144"></a><span id="l12.144" class="difflineplus">+    &quot;cookieExceptions&quot;,</span>
<a href="#l12.145"></a><span id="l12.145" class="difflineplus">+    &quot;acceptThirdPartyMenu&quot;,</span>
<a href="#l12.146"></a><span id="l12.146" class="difflineplus">+    &quot;keepCookiesUntil&quot;,</span>
<a href="#l12.147"></a><span id="l12.147" class="difflineplus">+  ]) {</span>
<a href="#l12.148"></a><span id="l12.148" class="difflineplus">+    is(</span>
<a href="#l12.149"></a><span id="l12.149" class="difflineplus">+      contentDocument.getElementById(id).disabled,</span>
<a href="#l12.150"></a><span id="l12.150" class="difflineplus">+      expectControlsDisabled,</span>
<a href="#l12.151"></a><span id="l12.151" class="difflineplus">+      `#${id} disabled status should match expected`</span>
<a href="#l12.152"></a><span id="l12.152" class="difflineplus">+    );</span>
<a href="#l12.153"></a><span id="l12.153" class="difflineplus">+  }</span>
<a href="#l12.154"></a><span id="l12.154" class="difflineplus">+</span>
<a href="#l12.155"></a><span id="l12.155" class="difflineplus">+  let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l12.156"></a><span id="l12.156" class="difflineplus">+  tabmail.closeTab(window.gPrefTab);</span>
<a href="#l12.157"></a><span id="l12.157" class="difflineplus">+}</span>
<a href="#l12.158"></a><span id="l12.158" class="difflineplus">+</span>
<a href="#l12.159"></a><span id="l12.159" class="difflineplus">+add_task(async function prepare_tracker_tables() {</span>
<a href="#l12.160"></a><span id="l12.160" class="difflineplus">+  await UrlClassifierTestUtils.addTestTrackers();</span>
<a href="#l12.161"></a><span id="l12.161" class="difflineplus">+});</span>
<a href="#l12.162"></a><span id="l12.162" class="difflineplus">+</span>
<a href="#l12.163"></a><span id="l12.163" class="difflineplus">+add_task(async function test_initial_state() {</span>
<a href="#l12.164"></a><span id="l12.164" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.165"></a><span id="l12.165" class="difflineplus">+    &quot;network.cookieJarSettings.unblocked_for_testing&quot;,</span>
<a href="#l12.166"></a><span id="l12.166" class="difflineplus">+    true</span>
<a href="#l12.167"></a><span id="l12.167" class="difflineplus">+  );</span>
<a href="#l12.168"></a><span id="l12.168" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.169"></a><span id="l12.169" class="difflineplus">+    &quot;network.cookie.rejectForeignWithExceptions.enabled&quot;,</span>
<a href="#l12.170"></a><span id="l12.170" class="difflineplus">+    false</span>
<a href="#l12.171"></a><span id="l12.171" class="difflineplus">+  );</span>
<a href="#l12.172"></a><span id="l12.172" class="difflineplus">+  await test_cookie_settings({</span>
<a href="#l12.173"></a><span id="l12.173" class="difflineplus">+    cookiesEnabled: true,</span>
<a href="#l12.174"></a><span id="l12.174" class="difflineplus">+    thirdPartyCookiesEnabled: true,</span>
<a href="#l12.175"></a><span id="l12.175" class="difflineplus">+    cookiesExpireAfterSession: false,</span>
<a href="#l12.176"></a><span id="l12.176" class="difflineplus">+    cookieJarSettingsLocked: false,</span>
<a href="#l12.177"></a><span id="l12.177" class="difflineplus">+  });</span>
<a href="#l12.178"></a><span id="l12.178" class="difflineplus">+  restore_prefs();</span>
<a href="#l12.179"></a><span id="l12.179" class="difflineplus">+});</span>
<a href="#l12.180"></a><span id="l12.180" class="difflineplus">+</span>
<a href="#l12.181"></a><span id="l12.181" class="difflineplus">+add_task(async function test_undefined_unlocked() {</span>
<a href="#l12.182"></a><span id="l12.182" class="difflineplus">+  Services.prefs.setIntPref(&quot;network.cookie.cookieBehavior&quot;, 3);</span>
<a href="#l12.183"></a><span id="l12.183" class="difflineplus">+  Services.prefs.setIntPref(&quot;network.cookie.lifetimePolicy&quot;, 2);</span>
<a href="#l12.184"></a><span id="l12.184" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.185"></a><span id="l12.185" class="difflineplus">+    &quot;network.cookieJarSettings.unblocked_for_testing&quot;,</span>
<a href="#l12.186"></a><span id="l12.186" class="difflineplus">+    true</span>
<a href="#l12.187"></a><span id="l12.187" class="difflineplus">+  );</span>
<a href="#l12.188"></a><span id="l12.188" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.189"></a><span id="l12.189" class="difflineplus">+    &quot;network.cookie.rejectForeignWithExceptions.enabled&quot;,</span>
<a href="#l12.190"></a><span id="l12.190" class="difflineplus">+    false</span>
<a href="#l12.191"></a><span id="l12.191" class="difflineplus">+  );</span>
<a href="#l12.192"></a><span id="l12.192" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l12.193"></a><span id="l12.193" class="difflineplus">+    policies: {</span>
<a href="#l12.194"></a><span id="l12.194" class="difflineplus">+      Cookies: {},</span>
<a href="#l12.195"></a><span id="l12.195" class="difflineplus">+    },</span>
<a href="#l12.196"></a><span id="l12.196" class="difflineplus">+  });</span>
<a href="#l12.197"></a><span id="l12.197" class="difflineplus">+  is(</span>
<a href="#l12.198"></a><span id="l12.198" class="difflineplus">+    Services.prefs.getIntPref(&quot;network.cookie.cookieBehavior&quot;, undefined),</span>
<a href="#l12.199"></a><span id="l12.199" class="difflineplus">+    3,</span>
<a href="#l12.200"></a><span id="l12.200" class="difflineplus">+    &quot;An empty cookie policy should not have changed the cookieBehavior preference&quot;</span>
<a href="#l12.201"></a><span id="l12.201" class="difflineplus">+  );</span>
<a href="#l12.202"></a><span id="l12.202" class="difflineplus">+  is(</span>
<a href="#l12.203"></a><span id="l12.203" class="difflineplus">+    Services.prefs.getIntPref(&quot;network.cookie.lifetimePolicy&quot;, undefined),</span>
<a href="#l12.204"></a><span id="l12.204" class="difflineplus">+    2,</span>
<a href="#l12.205"></a><span id="l12.205" class="difflineplus">+    &quot;An empty cookie policy should not have changed the lifetimePolicy preference&quot;</span>
<a href="#l12.206"></a><span id="l12.206" class="difflineplus">+  );</span>
<a href="#l12.207"></a><span id="l12.207" class="difflineplus">+  restore_prefs();</span>
<a href="#l12.208"></a><span id="l12.208" class="difflineplus">+});</span>
<a href="#l12.209"></a><span id="l12.209" class="difflineplus">+</span>
<a href="#l12.210"></a><span id="l12.210" class="difflineplus">+add_task(async function test_disabled() {</span>
<a href="#l12.211"></a><span id="l12.211" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.212"></a><span id="l12.212" class="difflineplus">+    &quot;network.cookieJarSettings.unblocked_for_testing&quot;,</span>
<a href="#l12.213"></a><span id="l12.213" class="difflineplus">+    true</span>
<a href="#l12.214"></a><span id="l12.214" class="difflineplus">+  );</span>
<a href="#l12.215"></a><span id="l12.215" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.216"></a><span id="l12.216" class="difflineplus">+    &quot;network.cookie.rejectForeignWithExceptions.enabled&quot;,</span>
<a href="#l12.217"></a><span id="l12.217" class="difflineplus">+    false</span>
<a href="#l12.218"></a><span id="l12.218" class="difflineplus">+  );</span>
<a href="#l12.219"></a><span id="l12.219" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l12.220"></a><span id="l12.220" class="difflineplus">+    policies: {</span>
<a href="#l12.221"></a><span id="l12.221" class="difflineplus">+      Cookies: {</span>
<a href="#l12.222"></a><span id="l12.222" class="difflineplus">+        Default: false,</span>
<a href="#l12.223"></a><span id="l12.223" class="difflineplus">+      },</span>
<a href="#l12.224"></a><span id="l12.224" class="difflineplus">+    },</span>
<a href="#l12.225"></a><span id="l12.225" class="difflineplus">+  });</span>
<a href="#l12.226"></a><span id="l12.226" class="difflineplus">+</span>
<a href="#l12.227"></a><span id="l12.227" class="difflineplus">+  await test_cookie_settings({</span>
<a href="#l12.228"></a><span id="l12.228" class="difflineplus">+    cookiesEnabled: false,</span>
<a href="#l12.229"></a><span id="l12.229" class="difflineplus">+    thirdPartyCookiesEnabled: true,</span>
<a href="#l12.230"></a><span id="l12.230" class="difflineplus">+    cookiesExpireAfterSession: false,</span>
<a href="#l12.231"></a><span id="l12.231" class="difflineplus">+    cookieJarSettingsLocked: false,</span>
<a href="#l12.232"></a><span id="l12.232" class="difflineplus">+  });</span>
<a href="#l12.233"></a><span id="l12.233" class="difflineplus">+  restore_prefs();</span>
<a href="#l12.234"></a><span id="l12.234" class="difflineplus">+});</span>
<a href="#l12.235"></a><span id="l12.235" class="difflineplus">+</span>
<a href="#l12.236"></a><span id="l12.236" class="difflineplus">+add_task(async function test_third_party_disabled() {</span>
<a href="#l12.237"></a><span id="l12.237" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.238"></a><span id="l12.238" class="difflineplus">+    &quot;network.cookieJarSettings.unblocked_for_testing&quot;,</span>
<a href="#l12.239"></a><span id="l12.239" class="difflineplus">+    true</span>
<a href="#l12.240"></a><span id="l12.240" class="difflineplus">+  );</span>
<a href="#l12.241"></a><span id="l12.241" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.242"></a><span id="l12.242" class="difflineplus">+    &quot;network.cookie.rejectForeignWithExceptions.enabled&quot;,</span>
<a href="#l12.243"></a><span id="l12.243" class="difflineplus">+    false</span>
<a href="#l12.244"></a><span id="l12.244" class="difflineplus">+  );</span>
<a href="#l12.245"></a><span id="l12.245" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l12.246"></a><span id="l12.246" class="difflineplus">+    policies: {</span>
<a href="#l12.247"></a><span id="l12.247" class="difflineplus">+      Cookies: {</span>
<a href="#l12.248"></a><span id="l12.248" class="difflineplus">+        AcceptThirdParty: &quot;never&quot;,</span>
<a href="#l12.249"></a><span id="l12.249" class="difflineplus">+      },</span>
<a href="#l12.250"></a><span id="l12.250" class="difflineplus">+    },</span>
<a href="#l12.251"></a><span id="l12.251" class="difflineplus">+  });</span>
<a href="#l12.252"></a><span id="l12.252" class="difflineplus">+</span>
<a href="#l12.253"></a><span id="l12.253" class="difflineplus">+  await test_cookie_settings({</span>
<a href="#l12.254"></a><span id="l12.254" class="difflineplus">+    cookiesEnabled: true,</span>
<a href="#l12.255"></a><span id="l12.255" class="difflineplus">+    thirdPartyCookiesEnabled: false,</span>
<a href="#l12.256"></a><span id="l12.256" class="difflineplus">+    cookiesExpireAfterSession: false,</span>
<a href="#l12.257"></a><span id="l12.257" class="difflineplus">+    cookieJarSettingsLocked: false,</span>
<a href="#l12.258"></a><span id="l12.258" class="difflineplus">+  });</span>
<a href="#l12.259"></a><span id="l12.259" class="difflineplus">+  restore_prefs();</span>
<a href="#l12.260"></a><span id="l12.260" class="difflineplus">+});</span>
<a href="#l12.261"></a><span id="l12.261" class="difflineplus">+</span>
<a href="#l12.262"></a><span id="l12.262" class="difflineplus">+add_task(async function test_disabled_and_third_party_disabled() {</span>
<a href="#l12.263"></a><span id="l12.263" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.264"></a><span id="l12.264" class="difflineplus">+    &quot;network.cookieJarSettings.unblocked_for_testing&quot;,</span>
<a href="#l12.265"></a><span id="l12.265" class="difflineplus">+    true</span>
<a href="#l12.266"></a><span id="l12.266" class="difflineplus">+  );</span>
<a href="#l12.267"></a><span id="l12.267" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.268"></a><span id="l12.268" class="difflineplus">+    &quot;network.cookie.rejectForeignWithExceptions.enabled&quot;,</span>
<a href="#l12.269"></a><span id="l12.269" class="difflineplus">+    false</span>
<a href="#l12.270"></a><span id="l12.270" class="difflineplus">+  );</span>
<a href="#l12.271"></a><span id="l12.271" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l12.272"></a><span id="l12.272" class="difflineplus">+    policies: {</span>
<a href="#l12.273"></a><span id="l12.273" class="difflineplus">+      Cookies: {</span>
<a href="#l12.274"></a><span id="l12.274" class="difflineplus">+        Default: false,</span>
<a href="#l12.275"></a><span id="l12.275" class="difflineplus">+        AcceptThirdParty: &quot;never&quot;,</span>
<a href="#l12.276"></a><span id="l12.276" class="difflineplus">+      },</span>
<a href="#l12.277"></a><span id="l12.277" class="difflineplus">+    },</span>
<a href="#l12.278"></a><span id="l12.278" class="difflineplus">+  });</span>
<a href="#l12.279"></a><span id="l12.279" class="difflineplus">+</span>
<a href="#l12.280"></a><span id="l12.280" class="difflineplus">+  await test_cookie_settings({</span>
<a href="#l12.281"></a><span id="l12.281" class="difflineplus">+    cookiesEnabled: false,</span>
<a href="#l12.282"></a><span id="l12.282" class="difflineplus">+    thirdPartyCookiesEnabled: false,</span>
<a href="#l12.283"></a><span id="l12.283" class="difflineplus">+    cookiesExpireAfterSession: false,</span>
<a href="#l12.284"></a><span id="l12.284" class="difflineplus">+    cookieJarSettingsLocked: false,</span>
<a href="#l12.285"></a><span id="l12.285" class="difflineplus">+  });</span>
<a href="#l12.286"></a><span id="l12.286" class="difflineplus">+  restore_prefs();</span>
<a href="#l12.287"></a><span id="l12.287" class="difflineplus">+});</span>
<a href="#l12.288"></a><span id="l12.288" class="difflineplus">+</span>
<a href="#l12.289"></a><span id="l12.289" class="difflineplus">+add_task(async function test_disabled_and_third_party_disabled_locked() {</span>
<a href="#l12.290"></a><span id="l12.290" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.291"></a><span id="l12.291" class="difflineplus">+    &quot;network.cookieJarSettings.unblocked_for_testing&quot;,</span>
<a href="#l12.292"></a><span id="l12.292" class="difflineplus">+    true</span>
<a href="#l12.293"></a><span id="l12.293" class="difflineplus">+  );</span>
<a href="#l12.294"></a><span id="l12.294" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.295"></a><span id="l12.295" class="difflineplus">+    &quot;network.cookie.rejectForeignWithExceptions.enabled&quot;,</span>
<a href="#l12.296"></a><span id="l12.296" class="difflineplus">+    false</span>
<a href="#l12.297"></a><span id="l12.297" class="difflineplus">+  );</span>
<a href="#l12.298"></a><span id="l12.298" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l12.299"></a><span id="l12.299" class="difflineplus">+    policies: {</span>
<a href="#l12.300"></a><span id="l12.300" class="difflineplus">+      Cookies: {</span>
<a href="#l12.301"></a><span id="l12.301" class="difflineplus">+        Default: false,</span>
<a href="#l12.302"></a><span id="l12.302" class="difflineplus">+        AcceptThirdParty: &quot;never&quot;,</span>
<a href="#l12.303"></a><span id="l12.303" class="difflineplus">+        Locked: true,</span>
<a href="#l12.304"></a><span id="l12.304" class="difflineplus">+      },</span>
<a href="#l12.305"></a><span id="l12.305" class="difflineplus">+    },</span>
<a href="#l12.306"></a><span id="l12.306" class="difflineplus">+  });</span>
<a href="#l12.307"></a><span id="l12.307" class="difflineplus">+</span>
<a href="#l12.308"></a><span id="l12.308" class="difflineplus">+  await test_cookie_settings({</span>
<a href="#l12.309"></a><span id="l12.309" class="difflineplus">+    cookiesEnabled: false,</span>
<a href="#l12.310"></a><span id="l12.310" class="difflineplus">+    thirdPartyCookiesEnabled: false,</span>
<a href="#l12.311"></a><span id="l12.311" class="difflineplus">+    cookiesExpireAfterSession: false,</span>
<a href="#l12.312"></a><span id="l12.312" class="difflineplus">+    cookieJarSettingsLocked: true,</span>
<a href="#l12.313"></a><span id="l12.313" class="difflineplus">+  });</span>
<a href="#l12.314"></a><span id="l12.314" class="difflineplus">+  restore_prefs();</span>
<a href="#l12.315"></a><span id="l12.315" class="difflineplus">+});</span>
<a href="#l12.316"></a><span id="l12.316" class="difflineplus">+</span>
<a href="#l12.317"></a><span id="l12.317" class="difflineplus">+add_task(async function test_undefined_locked() {</span>
<a href="#l12.318"></a><span id="l12.318" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.319"></a><span id="l12.319" class="difflineplus">+    &quot;network.cookieJarSettings.unblocked_for_testing&quot;,</span>
<a href="#l12.320"></a><span id="l12.320" class="difflineplus">+    true</span>
<a href="#l12.321"></a><span id="l12.321" class="difflineplus">+  );</span>
<a href="#l12.322"></a><span id="l12.322" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.323"></a><span id="l12.323" class="difflineplus">+    &quot;network.cookie.rejectForeignWithExceptions.enabled&quot;,</span>
<a href="#l12.324"></a><span id="l12.324" class="difflineplus">+    false</span>
<a href="#l12.325"></a><span id="l12.325" class="difflineplus">+  );</span>
<a href="#l12.326"></a><span id="l12.326" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l12.327"></a><span id="l12.327" class="difflineplus">+    policies: {</span>
<a href="#l12.328"></a><span id="l12.328" class="difflineplus">+      Cookies: {</span>
<a href="#l12.329"></a><span id="l12.329" class="difflineplus">+        Locked: true,</span>
<a href="#l12.330"></a><span id="l12.330" class="difflineplus">+      },</span>
<a href="#l12.331"></a><span id="l12.331" class="difflineplus">+    },</span>
<a href="#l12.332"></a><span id="l12.332" class="difflineplus">+  });</span>
<a href="#l12.333"></a><span id="l12.333" class="difflineplus">+</span>
<a href="#l12.334"></a><span id="l12.334" class="difflineplus">+  await test_cookie_settings({</span>
<a href="#l12.335"></a><span id="l12.335" class="difflineplus">+    cookiesEnabled: true,</span>
<a href="#l12.336"></a><span id="l12.336" class="difflineplus">+    thirdPartyCookiesEnabled: true,</span>
<a href="#l12.337"></a><span id="l12.337" class="difflineplus">+    cookiesExpireAfterSession: false,</span>
<a href="#l12.338"></a><span id="l12.338" class="difflineplus">+    cookieJarSettingsLocked: true,</span>
<a href="#l12.339"></a><span id="l12.339" class="difflineplus">+  });</span>
<a href="#l12.340"></a><span id="l12.340" class="difflineplus">+  restore_prefs();</span>
<a href="#l12.341"></a><span id="l12.341" class="difflineplus">+});</span>
<a href="#l12.342"></a><span id="l12.342" class="difflineplus">+</span>
<a href="#l12.343"></a><span id="l12.343" class="difflineplus">+add_task(async function test_cookie_expire() {</span>
<a href="#l12.344"></a><span id="l12.344" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.345"></a><span id="l12.345" class="difflineplus">+    &quot;network.cookieJarSettings.unblocked_for_testing&quot;,</span>
<a href="#l12.346"></a><span id="l12.346" class="difflineplus">+    true</span>
<a href="#l12.347"></a><span id="l12.347" class="difflineplus">+  );</span>
<a href="#l12.348"></a><span id="l12.348" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.349"></a><span id="l12.349" class="difflineplus">+    &quot;network.cookie.rejectForeignWithExceptions.enabled&quot;,</span>
<a href="#l12.350"></a><span id="l12.350" class="difflineplus">+    false</span>
<a href="#l12.351"></a><span id="l12.351" class="difflineplus">+  );</span>
<a href="#l12.352"></a><span id="l12.352" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l12.353"></a><span id="l12.353" class="difflineplus">+    policies: {</span>
<a href="#l12.354"></a><span id="l12.354" class="difflineplus">+      Cookies: {</span>
<a href="#l12.355"></a><span id="l12.355" class="difflineplus">+        ExpireAtSessionEnd: true,</span>
<a href="#l12.356"></a><span id="l12.356" class="difflineplus">+      },</span>
<a href="#l12.357"></a><span id="l12.357" class="difflineplus">+    },</span>
<a href="#l12.358"></a><span id="l12.358" class="difflineplus">+  });</span>
<a href="#l12.359"></a><span id="l12.359" class="difflineplus">+</span>
<a href="#l12.360"></a><span id="l12.360" class="difflineplus">+  await test_cookie_settings({</span>
<a href="#l12.361"></a><span id="l12.361" class="difflineplus">+    cookiesEnabled: true,</span>
<a href="#l12.362"></a><span id="l12.362" class="difflineplus">+    thirdPartyCookiesEnabled: true,</span>
<a href="#l12.363"></a><span id="l12.363" class="difflineplus">+    cookiesExpireAfterSession: true,</span>
<a href="#l12.364"></a><span id="l12.364" class="difflineplus">+    cookieJarSettingsLocked: false,</span>
<a href="#l12.365"></a><span id="l12.365" class="difflineplus">+  });</span>
<a href="#l12.366"></a><span id="l12.366" class="difflineplus">+  restore_prefs();</span>
<a href="#l12.367"></a><span id="l12.367" class="difflineplus">+});</span>
<a href="#l12.368"></a><span id="l12.368" class="difflineplus">+</span>
<a href="#l12.369"></a><span id="l12.369" class="difflineplus">+add_task(async function test_cookie_expire_locked() {</span>
<a href="#l12.370"></a><span id="l12.370" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.371"></a><span id="l12.371" class="difflineplus">+    &quot;network.cookieJarSettings.unblocked_for_testing&quot;,</span>
<a href="#l12.372"></a><span id="l12.372" class="difflineplus">+    true</span>
<a href="#l12.373"></a><span id="l12.373" class="difflineplus">+  );</span>
<a href="#l12.374"></a><span id="l12.374" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.375"></a><span id="l12.375" class="difflineplus">+    &quot;network.cookie.rejectForeignWithExceptions.enabled&quot;,</span>
<a href="#l12.376"></a><span id="l12.376" class="difflineplus">+    false</span>
<a href="#l12.377"></a><span id="l12.377" class="difflineplus">+  );</span>
<a href="#l12.378"></a><span id="l12.378" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l12.379"></a><span id="l12.379" class="difflineplus">+    policies: {</span>
<a href="#l12.380"></a><span id="l12.380" class="difflineplus">+      Cookies: {</span>
<a href="#l12.381"></a><span id="l12.381" class="difflineplus">+        ExpireAtSessionEnd: true,</span>
<a href="#l12.382"></a><span id="l12.382" class="difflineplus">+        Locked: true,</span>
<a href="#l12.383"></a><span id="l12.383" class="difflineplus">+      },</span>
<a href="#l12.384"></a><span id="l12.384" class="difflineplus">+    },</span>
<a href="#l12.385"></a><span id="l12.385" class="difflineplus">+  });</span>
<a href="#l12.386"></a><span id="l12.386" class="difflineplus">+</span>
<a href="#l12.387"></a><span id="l12.387" class="difflineplus">+  await test_cookie_settings({</span>
<a href="#l12.388"></a><span id="l12.388" class="difflineplus">+    cookiesEnabled: true,</span>
<a href="#l12.389"></a><span id="l12.389" class="difflineplus">+    thirdPartyCookiesEnabled: true,</span>
<a href="#l12.390"></a><span id="l12.390" class="difflineplus">+    cookiesExpireAfterSession: true,</span>
<a href="#l12.391"></a><span id="l12.391" class="difflineplus">+    cookieJarSettingsLocked: true,</span>
<a href="#l12.392"></a><span id="l12.392" class="difflineplus">+  });</span>
<a href="#l12.393"></a><span id="l12.393" class="difflineplus">+  restore_prefs();</span>
<a href="#l12.394"></a><span id="l12.394" class="difflineplus">+});</span>
<a href="#l12.395"></a><span id="l12.395" class="difflineplus">+</span>
<a href="#l12.396"></a><span id="l12.396" class="difflineplus">+add_task(async function test_disabled_cookie_expire_locked() {</span>
<a href="#l12.397"></a><span id="l12.397" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.398"></a><span id="l12.398" class="difflineplus">+    &quot;network.cookieJarSettings.unblocked_for_testing&quot;,</span>
<a href="#l12.399"></a><span id="l12.399" class="difflineplus">+    true</span>
<a href="#l12.400"></a><span id="l12.400" class="difflineplus">+  );</span>
<a href="#l12.401"></a><span id="l12.401" class="difflineplus">+  Services.prefs.setBoolPref(</span>
<a href="#l12.402"></a><span id="l12.402" class="difflineplus">+    &quot;network.cookie.rejectForeignWithExceptions.enabled&quot;,</span>
<a href="#l12.403"></a><span id="l12.403" class="difflineplus">+    false</span>
<a href="#l12.404"></a><span id="l12.404" class="difflineplus">+  );</span>
<a href="#l12.405"></a><span id="l12.405" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l12.406"></a><span id="l12.406" class="difflineplus">+    policies: {</span>
<a href="#l12.407"></a><span id="l12.407" class="difflineplus">+      Cookies: {</span>
<a href="#l12.408"></a><span id="l12.408" class="difflineplus">+        Default: false,</span>
<a href="#l12.409"></a><span id="l12.409" class="difflineplus">+        AcceptThirdParty: &quot;never&quot;,</span>
<a href="#l12.410"></a><span id="l12.410" class="difflineplus">+        ExpireAtSessionEnd: true,</span>
<a href="#l12.411"></a><span id="l12.411" class="difflineplus">+        Locked: true,</span>
<a href="#l12.412"></a><span id="l12.412" class="difflineplus">+      },</span>
<a href="#l12.413"></a><span id="l12.413" class="difflineplus">+    },</span>
<a href="#l12.414"></a><span id="l12.414" class="difflineplus">+  });</span>
<a href="#l12.415"></a><span id="l12.415" class="difflineplus">+</span>
<a href="#l12.416"></a><span id="l12.416" class="difflineplus">+  await test_cookie_settings({</span>
<a href="#l12.417"></a><span id="l12.417" class="difflineplus">+    cookiesEnabled: false,</span>
<a href="#l12.418"></a><span id="l12.418" class="difflineplus">+    thirdPartyCookiesEnabled: false,</span>
<a href="#l12.419"></a><span id="l12.419" class="difflineplus">+    cookiesExpireAfterSession: true,</span>
<a href="#l12.420"></a><span id="l12.420" class="difflineplus">+    cookieJarSettingsLocked: true,</span>
<a href="#l12.421"></a><span id="l12.421" class="difflineplus">+  });</span>
<a href="#l12.422"></a><span id="l12.422" class="difflineplus">+  restore_prefs();</span>
<a href="#l12.423"></a><span id="l12.423" class="difflineplus">+});</span>
<a href="#l12.424"></a><span id="l12.424" class="difflineplus">+</span>
<a href="#l12.425"></a><span id="l12.425" class="difflineplus">+add_task(async function prepare_tracker_tables() {</span>
<a href="#l12.426"></a><span id="l12.426" class="difflineplus">+  await UrlClassifierTestUtils.cleanupTestTrackers();</span>
<a href="#l12.427"></a><span id="l12.427" class="difflineplus">+});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1">new file mode 100644</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineminus">--- /dev/null</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_safemode.js</span>
<a href="#l13.4"></a><span id="l13.4" class="difflineat">@@ -0,0 +1,49 @@</span>
<a href="#l13.5"></a><span id="l13.5" class="difflineplus">+/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l13.6"></a><span id="l13.6" class="difflineplus">+ * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l13.7"></a><span id="l13.7" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l13.8"></a><span id="l13.8" class="difflineplus">+</span>
<a href="#l13.9"></a><span id="l13.9" class="difflineplus">+add_task(async function setup() {</span>
<a href="#l13.10"></a><span id="l13.10" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l13.11"></a><span id="l13.11" class="difflineplus">+    policies: {</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+      DisableSafeMode: true,</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+    },</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineplus">+  });</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineplus">+});</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineplus">+</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineplus">+add_task(async function test_help_menu() {</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineplus">+  buildHelpMenu();</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineplus">+  let safeModeMenu = document.getElementById(&quot;helpSafeMode&quot;);</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineplus">+  is(</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineplus">+    safeModeMenu.getAttribute(&quot;disabled&quot;),</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineplus">+    &quot;true&quot;,</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineplus">+    &quot;The `Restart with Add-ons Disabled...` item should be disabled&quot;</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineplus">+  );</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineplus">+  let safeModeAppMenu = document.getElementById(&quot;appmenu_safeMode&quot;);</span>
<a href="#l13.26"></a><span id="l13.26" class="difflineplus">+  is(</span>
<a href="#l13.27"></a><span id="l13.27" class="difflineplus">+    safeModeAppMenu.getAttribute(&quot;disabled&quot;),</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineplus">+    &quot;true&quot;,</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineplus">+    &quot;The `Restart with Add-ons Disabled...` appmenu item should be disabled&quot;</span>
<a href="#l13.30"></a><span id="l13.30" class="difflineplus">+  );</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineplus">+});</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+</span>
<a href="#l13.33"></a><span id="l13.33" class="difflineplus">+add_task(async function test_safemode_from_about_support() {</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineplus">+  await withNewTab({ url: &quot;about:support&quot; }, browser =&gt; {</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineplus">+    let button = content.document.getElementById(&quot;restart-in-safe-mode-button&quot;);</span>
<a href="#l13.36"></a><span id="l13.36" class="difflineplus">+    is(</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineplus">+      button.getAttribute(&quot;disabled&quot;),</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineplus">+      &quot;true&quot;,</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineplus">+      &quot;The `Restart with Add-ons Disabled...` button should be disabled&quot;</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineplus">+    );</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineplus">+  });</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineplus">+});</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineplus">+</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineplus">+add_task(async function test_safemode_from_about_profiles() {</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineplus">+  await withNewTab({ url: &quot;about:profiles&quot; }, browser =&gt; {</span>
<a href="#l13.46"></a><span id="l13.46" class="difflineplus">+    let button = content.document.getElementById(&quot;restart-in-safe-mode-button&quot;);</span>
<a href="#l13.47"></a><span id="l13.47" class="difflineplus">+    is(</span>
<a href="#l13.48"></a><span id="l13.48" class="difflineplus">+      button.getAttribute(&quot;disabled&quot;),</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineplus">+      &quot;true&quot;,</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineplus">+      &quot;The `Restart with Add-ons Disabled...` button should be disabled&quot;</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+    );</span>
<a href="#l13.52"></a><span id="l13.52" class="difflineplus">+  });</span>
<a href="#l13.53"></a><span id="l13.53" class="difflineplus">+});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1">new file mode 100644</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineminus">--- /dev/null</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/browser/browser_policy_disable_telemetry.js</span>
<a href="#l14.4"></a><span id="l14.4" class="difflineat">@@ -0,0 +1,21 @@</span>
<a href="#l14.5"></a><span id="l14.5" class="difflineplus">+/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l14.6"></a><span id="l14.6" class="difflineplus">+ * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l14.7"></a><span id="l14.7" class="difflineplus">+</span>
<a href="#l14.8"></a><span id="l14.8" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l14.9"></a><span id="l14.9" class="difflineplus">+</span>
<a href="#l14.10"></a><span id="l14.10" class="difflineplus">+add_task(async function test_policy_disable_telemetry() {</span>
<a href="#l14.11"></a><span id="l14.11" class="difflineplus">+  const { TelemetryReportingPolicy } = ChromeUtils.import(</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+    &quot;resource://gre/modules/TelemetryReportingPolicy.jsm&quot;</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+  );</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+  ok(TelemetryReportingPolicy, &quot;TelemetryReportingPolicy exists&quot;);</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineplus">+  is(TelemetryReportingPolicy.canUpload(), true, &quot;Telemetry is enabled&quot;);</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineplus">+    policies: {</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineplus">+      DisableTelemetry: true,</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineplus">+    },</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineplus">+  });</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineplus">+</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineplus">+  is(TelemetryReportingPolicy.canUpload(), false, &quot;Telemetry is disabled&quot;);</span>
<a href="#l14.25"></a><span id="l14.25" class="difflineplus">+});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1">new file mode 100644</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineminus">--- /dev/null</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/browser/browser_policy_downloads.js</span>
<a href="#l15.4"></a><span id="l15.4" class="difflineat">@@ -0,0 +1,118 @@</span>
<a href="#l15.5"></a><span id="l15.5" class="difflineplus">+/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l15.6"></a><span id="l15.6" class="difflineplus">+ * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l15.7"></a><span id="l15.7" class="difflineplus">+</span>
<a href="#l15.8"></a><span id="l15.8" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l15.9"></a><span id="l15.9" class="difflineplus">+</span>
<a href="#l15.10"></a><span id="l15.10" class="difflineplus">+ChromeUtils.defineModuleGetter(</span>
<a href="#l15.11"></a><span id="l15.11" class="difflineplus">+  this,</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineplus">+  &quot;FileUtils&quot;,</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+  &quot;resource://gre/modules/FileUtils.jsm&quot;</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+);</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+add_task(async function test_defaultdownload() {</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineplus">+    policies: {</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+      DefaultDownloadDirectory: &quot;${home}/Downloads&quot;,</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineplus">+      PromptForDownloadLocation: false,</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineplus">+    },</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineplus">+  });</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineplus">+  window.openPreferencesTab(&quot;panePrivacy&quot;);</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+  await BrowserTestUtils.browserLoaded(window.gPrefTab.browser);</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+  is(</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineplus">+    window.gPrefTab.browser.contentDocument.getElementById(&quot;alwaysAsk&quot;)</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineplus">+      .disabled,</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineplus">+    true,</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineplus">+    &quot;alwaysAsk should be disabled.&quot;</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineplus">+  );</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+  is(</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineplus">+    window.gPrefTab.browser.contentDocument.getElementById(&quot;saveTo&quot;).selected,</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineplus">+    true,</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineplus">+    &quot;saveTo should be selected.&quot;</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineplus">+  );</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+  is(</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+    window.gPrefTab.browser.contentDocument.getElementById(&quot;saveTo&quot;).disabled,</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineplus">+    true,</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineplus">+    &quot;saveTo should be disabled.&quot;</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineplus">+  );</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineplus">+  let home = FileUtils.getFile(&quot;Home&quot;, []).path;</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineplus">+  is(</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineplus">+    Services.prefs.getStringPref(&quot;browser.download.dir&quot;),</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineplus">+    home + &quot;/Downloads&quot;,</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineplus">+    &quot;browser.download.dir should be ${home}/Downloads.&quot;</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineplus">+  );</span>
<a href="#l15.48"></a><span id="l15.48" class="difflineplus">+  is(</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineplus">+    Services.prefs.getBoolPref(&quot;browser.download.useDownloadDir&quot;),</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineplus">+    true,</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineplus">+    &quot;browser.download.useDownloadDir should be true.&quot;</span>
<a href="#l15.52"></a><span id="l15.52" class="difflineplus">+  );</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineplus">+  is(</span>
<a href="#l15.54"></a><span id="l15.54" class="difflineplus">+    Services.prefs.prefIsLocked(&quot;browser.download.useDownloadDir&quot;),</span>
<a href="#l15.55"></a><span id="l15.55" class="difflineplus">+    true,</span>
<a href="#l15.56"></a><span id="l15.56" class="difflineplus">+    &quot;browser.download.useDownloadDir should be locked.&quot;</span>
<a href="#l15.57"></a><span id="l15.57" class="difflineplus">+  );</span>
<a href="#l15.58"></a><span id="l15.58" class="difflineplus">+</span>
<a href="#l15.59"></a><span id="l15.59" class="difflineplus">+  let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineplus">+  tabmail.closeTab(window.gPrefTab);</span>
<a href="#l15.61"></a><span id="l15.61" class="difflineplus">+});</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineplus">+</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineplus">+add_task(async function test_download() {</span>
<a href="#l15.64"></a><span id="l15.64" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l15.65"></a><span id="l15.65" class="difflineplus">+    policies: {</span>
<a href="#l15.66"></a><span id="l15.66" class="difflineplus">+      DownloadDirectory: &quot;${home}/Documents&quot;,</span>
<a href="#l15.67"></a><span id="l15.67" class="difflineplus">+    },</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineplus">+  });</span>
<a href="#l15.69"></a><span id="l15.69" class="difflineplus">+</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineplus">+  window.openPreferencesTab(&quot;panePrivacy&quot;);</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineplus">+  await BrowserTestUtils.browserLoaded(window.gPrefTab.browser);</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineplus">+  await new Promise(resolve =&gt;</span>
<a href="#l15.73"></a><span id="l15.73" class="difflineplus">+    window.gPrefTab.browser.contentWindow.setTimeout(resolve)</span>
<a href="#l15.74"></a><span id="l15.74" class="difflineplus">+  );</span>
<a href="#l15.75"></a><span id="l15.75" class="difflineplus">+  is(</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineplus">+    window.gPrefTab.browser.contentDocument.getElementById(&quot;alwaysAsk&quot;)</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineplus">+      .disabled,</span>
<a href="#l15.78"></a><span id="l15.78" class="difflineplus">+    true,</span>
<a href="#l15.79"></a><span id="l15.79" class="difflineplus">+    &quot;alwaysAsk should be disabled.&quot;</span>
<a href="#l15.80"></a><span id="l15.80" class="difflineplus">+  );</span>
<a href="#l15.81"></a><span id="l15.81" class="difflineplus">+  is(</span>
<a href="#l15.82"></a><span id="l15.82" class="difflineplus">+    window.gPrefTab.browser.contentDocument.getElementById(&quot;saveTo&quot;).selected,</span>
<a href="#l15.83"></a><span id="l15.83" class="difflineplus">+    true,</span>
<a href="#l15.84"></a><span id="l15.84" class="difflineplus">+    &quot;saveTo should be selected.&quot;</span>
<a href="#l15.85"></a><span id="l15.85" class="difflineplus">+  );</span>
<a href="#l15.86"></a><span id="l15.86" class="difflineplus">+  is(</span>
<a href="#l15.87"></a><span id="l15.87" class="difflineplus">+    window.gPrefTab.browser.contentDocument.getElementById(&quot;saveTo&quot;).disabled,</span>
<a href="#l15.88"></a><span id="l15.88" class="difflineplus">+    true,</span>
<a href="#l15.89"></a><span id="l15.89" class="difflineplus">+    &quot;saveTo should be disabled.&quot;</span>
<a href="#l15.90"></a><span id="l15.90" class="difflineplus">+  );</span>
<a href="#l15.91"></a><span id="l15.91" class="difflineplus">+  is(</span>
<a href="#l15.92"></a><span id="l15.92" class="difflineplus">+    window.gPrefTab.browser.contentDocument.getElementById(&quot;downloadFolder&quot;)</span>
<a href="#l15.93"></a><span id="l15.93" class="difflineplus">+      .disabled,</span>
<a href="#l15.94"></a><span id="l15.94" class="difflineplus">+    true,</span>
<a href="#l15.95"></a><span id="l15.95" class="difflineplus">+    &quot;downloadFolder should be disabled.&quot;</span>
<a href="#l15.96"></a><span id="l15.96" class="difflineplus">+  );</span>
<a href="#l15.97"></a><span id="l15.97" class="difflineplus">+  is(</span>
<a href="#l15.98"></a><span id="l15.98" class="difflineplus">+    window.gPrefTab.browser.contentDocument.getElementById(&quot;chooseFolder&quot;)</span>
<a href="#l15.99"></a><span id="l15.99" class="difflineplus">+      .disabled,</span>
<a href="#l15.100"></a><span id="l15.100" class="difflineplus">+    true,</span>
<a href="#l15.101"></a><span id="l15.101" class="difflineplus">+    &quot;chooseFolder should be disabled.&quot;</span>
<a href="#l15.102"></a><span id="l15.102" class="difflineplus">+  );</span>
<a href="#l15.103"></a><span id="l15.103" class="difflineplus">+  let home = FileUtils.getFile(&quot;Home&quot;, []).path;</span>
<a href="#l15.104"></a><span id="l15.104" class="difflineplus">+  is(</span>
<a href="#l15.105"></a><span id="l15.105" class="difflineplus">+    Services.prefs.getStringPref(&quot;browser.download.dir&quot;),</span>
<a href="#l15.106"></a><span id="l15.106" class="difflineplus">+    home + &quot;/Documents&quot;,</span>
<a href="#l15.107"></a><span id="l15.107" class="difflineplus">+    &quot;browser.download.dir should be ${home}/Documents.&quot;</span>
<a href="#l15.108"></a><span id="l15.108" class="difflineplus">+  );</span>
<a href="#l15.109"></a><span id="l15.109" class="difflineplus">+  is(</span>
<a href="#l15.110"></a><span id="l15.110" class="difflineplus">+    Services.prefs.getBoolPref(&quot;browser.download.useDownloadDir&quot;),</span>
<a href="#l15.111"></a><span id="l15.111" class="difflineplus">+    true,</span>
<a href="#l15.112"></a><span id="l15.112" class="difflineplus">+    &quot;browser.download.useDownloadDir should be true.&quot;</span>
<a href="#l15.113"></a><span id="l15.113" class="difflineplus">+  );</span>
<a href="#l15.114"></a><span id="l15.114" class="difflineplus">+  is(</span>
<a href="#l15.115"></a><span id="l15.115" class="difflineplus">+    Services.prefs.prefIsLocked(&quot;browser.download.useDownloadDir&quot;),</span>
<a href="#l15.116"></a><span id="l15.116" class="difflineplus">+    true,</span>
<a href="#l15.117"></a><span id="l15.117" class="difflineplus">+    &quot;browser.download.useDownloadDir should be locked.&quot;</span>
<a href="#l15.118"></a><span id="l15.118" class="difflineplus">+  );</span>
<a href="#l15.119"></a><span id="l15.119" class="difflineplus">+</span>
<a href="#l15.120"></a><span id="l15.120" class="difflineplus">+  let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l15.121"></a><span id="l15.121" class="difflineplus">+  tabmail.closeTab(window.gPrefTab);</span>
<a href="#l15.122"></a><span id="l15.122" class="difflineplus">+});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1">new file mode 100644</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineminus">--- /dev/null</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/browser/browser_policy_passwordmanager.js</span>
<a href="#l16.4"></a><span id="l16.4" class="difflineat">@@ -0,0 +1,24 @@</span>
<a href="#l16.5"></a><span id="l16.5" class="difflineplus">+/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l16.6"></a><span id="l16.6" class="difflineplus">+ * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l16.7"></a><span id="l16.7" class="difflineplus">+</span>
<a href="#l16.8"></a><span id="l16.8" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l16.9"></a><span id="l16.9" class="difflineplus">+</span>
<a href="#l16.10"></a><span id="l16.10" class="difflineplus">+add_task(async function test_pwmanagerbutton() {</span>
<a href="#l16.11"></a><span id="l16.11" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineplus">+    policies: {</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+      PasswordManagerEnabled: false,</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+    },</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+  });</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineplus">+</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineplus">+  window.openPreferencesTab(&quot;panePrivacy&quot;);</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineplus">+  await BrowserTestUtils.browserLoaded(window.gPrefTab.browser);</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineplus">+  is(</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineplus">+    window.gPrefTab.browser.contentDocument.getElementById(&quot;showPasswords&quot;)</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineplus">+      .disabled,</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineplus">+    true,</span>
<a href="#l16.23"></a><span id="l16.23" class="difflineplus">+    &quot;showPasswords should be disabled.&quot;</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineplus">+  );</span>
<a href="#l16.25"></a><span id="l16.25" class="difflineplus">+</span>
<a href="#l16.26"></a><span id="l16.26" class="difflineplus">+  let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l16.27"></a><span id="l16.27" class="difflineplus">+  tabmail.closeTab(window.gPrefTab);</span>
<a href="#l16.28"></a><span id="l16.28" class="difflineplus">+});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1">new file mode 100644</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineminus">--- /dev/null</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser.ini</span>
<a href="#l17.4"></a><span id="l17.4" class="difflineat">@@ -0,0 +1,12 @@</span>
<a href="#l17.5"></a><span id="l17.5" class="difflineplus">+[DEFAULT]</span>
<a href="#l17.6"></a><span id="l17.6" class="difflineplus">+prefs =</span>
<a href="#l17.7"></a><span id="l17.7" class="difflineplus">+  browser.policies.alternatePath='&lt;test-root&gt;/browser/components/enterprisepolicies/tests/browser/hardware_acceleration/disable_hardware_acceleration.json'</span>
<a href="#l17.8"></a><span id="l17.8" class="difflineplus">+  mail.provider.suppress_dialog_on_startup=true</span>
<a href="#l17.9"></a><span id="l17.9" class="difflineplus">+  mail.spotlight.firstRunDone=true</span>
<a href="#l17.10"></a><span id="l17.10" class="difflineplus">+  mail.winsearch.firstRunDone=true</span>
<a href="#l17.11"></a><span id="l17.11" class="difflineplus">+  mailnews.start_page.override_url=about:blank</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+  mailnews.start_page.url=about:blank</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+support-files =</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+  disable_hardware_acceleration.json</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineplus">+</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+[browser_policy_hardware_acceleration.js]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1">new file mode 100644</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineminus">--- /dev/null</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/browser_policy_hardware_acceleration.js</span>
<a href="#l18.4"></a><span id="l18.4" class="difflineat">@@ -0,0 +1,9 @@</span>
<a href="#l18.5"></a><span id="l18.5" class="difflineplus">+/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l18.6"></a><span id="l18.6" class="difflineplus">+ * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l18.7"></a><span id="l18.7" class="difflineplus">+</span>
<a href="#l18.8"></a><span id="l18.8" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l18.9"></a><span id="l18.9" class="difflineplus">+</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineplus">+add_task(async function test_policy_hardware_acceleration() {</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineplus">+  let winUtils = Services.wm.getMostRecentWindow(&quot;&quot;).windowUtils;</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineplus">+  is(winUtils.layerManagerType, &quot;Basic&quot;, &quot;Hardware acceleration disabled&quot;);</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1">new file mode 100644</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineminus">--- /dev/null</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/browser/hardware_acceleration/disable_hardware_acceleration.json</span>
<a href="#l19.4"></a><span id="l19.4" class="difflineat">@@ -0,0 +1,5 @@</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineplus">+{</span>
<a href="#l19.6"></a><span id="l19.6" class="difflineplus">+  &quot;policies&quot;: {</span>
<a href="#l19.7"></a><span id="l19.7" class="difflineplus">+    &quot;HardwareAcceleration&quot;: false</span>
<a href="#l19.8"></a><span id="l19.8" class="difflineplus">+  }</span>
<a href="#l19.9"></a><span id="l19.9" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mail/components/enterprisepolicies/tests/browser/head.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/browser/head.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -28,33 +28,25 @@ async function setupPolicyEngineWithJson</span>
<a href="#l20.4"></a><span id="l20.4"> function checkLockedPref(prefName, prefValue) {</span>
<a href="#l20.5"></a><span id="l20.5">   EnterprisePolicyTesting.checkPolicyPref(prefName, prefValue, true);</span>
<a href="#l20.6"></a><span id="l20.6"> }</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8"> function checkUnlockedPref(prefName, prefValue) {</span>
<a href="#l20.9"></a><span id="l20.9">   EnterprisePolicyTesting.checkPolicyPref(prefName, prefValue, false);</span>
<a href="#l20.10"></a><span id="l20.10"> }</span>
<a href="#l20.11"></a><span id="l20.11"> </span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-// Checks that a page was blocked by seeing if it was replaced with about:neterror</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineminus">-async function checkBlockedPage(url, expectedBlocked) {</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineminus">-  let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineminus">-  let index = tabmail.tabInfo.length;</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineminus">-  window.openContentTab(&quot;about:blank&quot;);</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineminus">-  let tab = tabmail.tabInfo[index];</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineminus">-  let browser = tab.browser;</span>
<a href="#l20.19"></a><span id="l20.19" class="difflineminus">-  browser.contentWindow.location.href = url;</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineplus">+async function withNewTab(options, taskFn) {</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineplus">+  let tab = window.openContentTab(options.url);</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineplus">+  await BrowserTestUtils.browserLoaded(tab.browser);</span>
<a href="#l20.23"></a><span id="l20.23"> </span>
<a href="#l20.24"></a><span id="l20.24" class="difflineminus">-  await BrowserTestUtils.waitForCondition(async function() {</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineminus">-    let blocked = await ContentTask.spawn(browser, null, async function() {</span>
<a href="#l20.26"></a><span id="l20.26" class="difflineminus">-      return content.document.documentURI.startsWith(&quot;about:neterror&quot;);</span>
<a href="#l20.27"></a><span id="l20.27" class="difflineminus">-    });</span>
<a href="#l20.28"></a><span id="l20.28" class="difflineminus">-    return blocked == expectedBlocked;</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineminus">-  }, `Page ${url} block was correct (expected=${expectedBlocked}).`);</span>
<a href="#l20.30"></a><span id="l20.30" class="difflineplus">+  let result = await taskFn(tab.browser);</span>
<a href="#l20.31"></a><span id="l20.31"> </span>
<a href="#l20.32"></a><span id="l20.32" class="difflineplus">+  let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l20.33"></a><span id="l20.33">   tabmail.closeTab(tab);</span>
<a href="#l20.34"></a><span id="l20.34" class="difflineplus">+  return Promise.resolve(result);</span>
<a href="#l20.35"></a><span id="l20.35"> }</span>
<a href="#l20.36"></a><span id="l20.36"> </span>
<a href="#l20.37"></a><span id="l20.37"> add_task(async function policies_headjs_startWithCleanSlate() {</span>
<a href="#l20.38"></a><span id="l20.38">   if (Services.policies.status != Ci.nsIEnterprisePolicies.INACTIVE) {</span>
<a href="#l20.39"></a><span id="l20.39">     await setupPolicyEngineWithJson(&quot;&quot;);</span>
<a href="#l20.40"></a><span id="l20.40">   }</span>
<a href="#l20.41"></a><span id="l20.41">   is(</span>
<a href="#l20.42"></a><span id="l20.42">     Services.policies.status,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mail/components/enterprisepolicies/tests/moz.build</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/moz.build</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -3,13 +3,14 @@</span>
<a href="#l21.4"></a><span id="l21.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l21.5"></a><span id="l21.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l21.6"></a><span id="l21.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l21.7"></a><span id="l21.7"> </span>
<a href="#l21.8"></a><span id="l21.8"> BROWSER_CHROME_MANIFESTS += [</span>
<a href="#l21.9"></a><span id="l21.9">     'browser/browser.ini',</span>
<a href="#l21.10"></a><span id="l21.10">     'browser/disable_app_update/browser.ini',</span>
<a href="#l21.11"></a><span id="l21.11">     'browser/disable_developer_tools/browser.ini',</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+    'browser/hardware_acceleration/browser.ini',</span>
<a href="#l21.13"></a><span id="l21.13"> ]</span>
<a href="#l21.14"></a><span id="l21.14"> </span>
<a href="#l21.15"></a><span id="l21.15"> XPCSHELL_TESTS_MANIFESTS += [</span>
<a href="#l21.16"></a><span id="l21.16">     'xpcshell/xpcshell.ini',</span>
<a href="#l21.17"></a><span id="l21.17"> ]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mail/components/enterprisepolicies/tests/xpcshell/head.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/xpcshell/head.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -10,16 +10,19 @@ const { Preferences } = ChromeUtils.impo</span>
<a href="#l22.4"></a><span id="l22.4">   &quot;resource://gre/modules/Preferences.jsm&quot;</span>
<a href="#l22.5"></a><span id="l22.5"> );</span>
<a href="#l22.6"></a><span id="l22.6"> const { updateAppInfo, getAppInfo } = ChromeUtils.import(</span>
<a href="#l22.7"></a><span id="l22.7">   &quot;resource://testing-common/AppInfo.jsm&quot;</span>
<a href="#l22.8"></a><span id="l22.8"> );</span>
<a href="#l22.9"></a><span id="l22.9"> const { FileTestUtils } = ChromeUtils.import(</span>
<a href="#l22.10"></a><span id="l22.10">   &quot;resource://testing-common/FileTestUtils.jsm&quot;</span>
<a href="#l22.11"></a><span id="l22.11"> );</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineplus">+const { PermissionTestUtils } = ChromeUtils.import(</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+  &quot;resource://testing-common/PermissionTestUtils.jsm&quot;</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineplus">+);</span>
<a href="#l22.15"></a><span id="l22.15"> </span>
<a href="#l22.16"></a><span id="l22.16"> updateAppInfo({</span>
<a href="#l22.17"></a><span id="l22.17">   name: &quot;XPCShell&quot;,</span>
<a href="#l22.18"></a><span id="l22.18">   ID: &quot;xpcshell@tests.mozilla.org&quot;,</span>
<a href="#l22.19"></a><span id="l22.19">   version: &quot;48&quot;,</span>
<a href="#l22.20"></a><span id="l22.20">   platformVersion: &quot;48&quot;,</span>
<a href="#l22.21"></a><span id="l22.21"> });</span>
<a href="#l22.22"></a><span id="l22.22"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1">new file mode 100644</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineminus">--- /dev/null</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/xpcshell/test_3rdparty.js</span>
<a href="#l23.4"></a><span id="l23.4" class="difflineat">@@ -0,0 +1,22 @@</span>
<a href="#l23.5"></a><span id="l23.5" class="difflineplus">+/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l23.6"></a><span id="l23.6" class="difflineplus">+ * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l23.7"></a><span id="l23.7" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l23.8"></a><span id="l23.8" class="difflineplus">+</span>
<a href="#l23.9"></a><span id="l23.9" class="difflineplus">+add_task(async function setup() {</span>
<a href="#l23.10"></a><span id="l23.10" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l23.11"></a><span id="l23.11" class="difflineplus">+    policies: {</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineplus">+      &quot;3rdparty&quot;: {</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+        Extensions: {</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineplus">+          &quot;3rdparty-policy@mozilla.com&quot;: {</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineplus">+            string: &quot;value&quot;,</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineplus">+          },</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineplus">+        },</span>
<a href="#l23.18"></a><span id="l23.18" class="difflineplus">+      },</span>
<a href="#l23.19"></a><span id="l23.19" class="difflineplus">+    },</span>
<a href="#l23.20"></a><span id="l23.20" class="difflineplus">+  });</span>
<a href="#l23.21"></a><span id="l23.21" class="difflineplus">+</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineplus">+  let extensionPolicy = Services.policies.getExtensionPolicy(</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineplus">+    &quot;3rdparty-policy@mozilla.com&quot;</span>
<a href="#l23.24"></a><span id="l23.24" class="difflineplus">+  );</span>
<a href="#l23.25"></a><span id="l23.25" class="difflineplus">+  deepEqual(extensionPolicy, { string: &quot;value&quot; });</span>
<a href="#l23.26"></a><span id="l23.26" class="difflineplus">+});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1">new file mode 100644</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineminus">--- /dev/null</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/xpcshell/test_clear_blocked_cookies.js</span>
<a href="#l24.4"></a><span id="l24.4" class="difflineat">@@ -0,0 +1,113 @@</span>
<a href="#l24.5"></a><span id="l24.5" class="difflineplus">+/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l24.6"></a><span id="l24.6" class="difflineplus">+ * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l24.7"></a><span id="l24.7" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l24.8"></a><span id="l24.8" class="difflineplus">+</span>
<a href="#l24.9"></a><span id="l24.9" class="difflineplus">+const HOSTNAME_DOMAIN = &quot;browser_policy_clear_blocked_cookies.com&quot;;</span>
<a href="#l24.10"></a><span id="l24.10" class="difflineplus">+const ORIGIN_DOMAIN = &quot;browser_policy_clear_blocked_cookies.org&quot;;</span>
<a href="#l24.11"></a><span id="l24.11" class="difflineplus">+</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineplus">+add_task(async function setup() {</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+  const expiry = Date.now() + 24 * 60 * 60;</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineplus">+  Services.cookies.add(</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineplus">+    HOSTNAME_DOMAIN,</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineplus">+    &quot;/&quot;,</span>
<a href="#l24.17"></a><span id="l24.17" class="difflineplus">+    &quot;secure&quot;,</span>
<a href="#l24.18"></a><span id="l24.18" class="difflineplus">+    &quot;true&quot;,</span>
<a href="#l24.19"></a><span id="l24.19" class="difflineplus">+    true,</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineplus">+    false,</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineplus">+    false,</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineplus">+    expiry,</span>
<a href="#l24.23"></a><span id="l24.23" class="difflineplus">+    {},</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineplus">+    Ci.nsICookie.SAMESITE_NONE</span>
<a href="#l24.25"></a><span id="l24.25" class="difflineplus">+  );</span>
<a href="#l24.26"></a><span id="l24.26" class="difflineplus">+  Services.cookies.add(</span>
<a href="#l24.27"></a><span id="l24.27" class="difflineplus">+    HOSTNAME_DOMAIN,</span>
<a href="#l24.28"></a><span id="l24.28" class="difflineplus">+    &quot;/&quot;,</span>
<a href="#l24.29"></a><span id="l24.29" class="difflineplus">+    &quot;insecure&quot;,</span>
<a href="#l24.30"></a><span id="l24.30" class="difflineplus">+    &quot;true&quot;,</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineplus">+    false,</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineplus">+    false,</span>
<a href="#l24.33"></a><span id="l24.33" class="difflineplus">+    false,</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineplus">+    expiry,</span>
<a href="#l24.35"></a><span id="l24.35" class="difflineplus">+    {},</span>
<a href="#l24.36"></a><span id="l24.36" class="difflineplus">+    Ci.nsICookie.SAMESITE_NONE</span>
<a href="#l24.37"></a><span id="l24.37" class="difflineplus">+  );</span>
<a href="#l24.38"></a><span id="l24.38" class="difflineplus">+  Services.cookies.add(</span>
<a href="#l24.39"></a><span id="l24.39" class="difflineplus">+    ORIGIN_DOMAIN,</span>
<a href="#l24.40"></a><span id="l24.40" class="difflineplus">+    &quot;/&quot;,</span>
<a href="#l24.41"></a><span id="l24.41" class="difflineplus">+    &quot;secure&quot;,</span>
<a href="#l24.42"></a><span id="l24.42" class="difflineplus">+    &quot;true&quot;,</span>
<a href="#l24.43"></a><span id="l24.43" class="difflineplus">+    true,</span>
<a href="#l24.44"></a><span id="l24.44" class="difflineplus">+    false,</span>
<a href="#l24.45"></a><span id="l24.45" class="difflineplus">+    false,</span>
<a href="#l24.46"></a><span id="l24.46" class="difflineplus">+    expiry,</span>
<a href="#l24.47"></a><span id="l24.47" class="difflineplus">+    {},</span>
<a href="#l24.48"></a><span id="l24.48" class="difflineplus">+    Ci.nsICookie.SAMESITE_NONE</span>
<a href="#l24.49"></a><span id="l24.49" class="difflineplus">+  );</span>
<a href="#l24.50"></a><span id="l24.50" class="difflineplus">+  Services.cookies.add(</span>
<a href="#l24.51"></a><span id="l24.51" class="difflineplus">+    ORIGIN_DOMAIN,</span>
<a href="#l24.52"></a><span id="l24.52" class="difflineplus">+    &quot;/&quot;,</span>
<a href="#l24.53"></a><span id="l24.53" class="difflineplus">+    &quot;insecure&quot;,</span>
<a href="#l24.54"></a><span id="l24.54" class="difflineplus">+    &quot;true&quot;,</span>
<a href="#l24.55"></a><span id="l24.55" class="difflineplus">+    false,</span>
<a href="#l24.56"></a><span id="l24.56" class="difflineplus">+    false,</span>
<a href="#l24.57"></a><span id="l24.57" class="difflineplus">+    false,</span>
<a href="#l24.58"></a><span id="l24.58" class="difflineplus">+    expiry,</span>
<a href="#l24.59"></a><span id="l24.59" class="difflineplus">+    {},</span>
<a href="#l24.60"></a><span id="l24.60" class="difflineplus">+    Ci.nsICookie.SAMESITE_NONE</span>
<a href="#l24.61"></a><span id="l24.61" class="difflineplus">+  );</span>
<a href="#l24.62"></a><span id="l24.62" class="difflineplus">+  Services.cookies.add(</span>
<a href="#l24.63"></a><span id="l24.63" class="difflineplus">+    &quot;example.net&quot;,</span>
<a href="#l24.64"></a><span id="l24.64" class="difflineplus">+    &quot;/&quot;,</span>
<a href="#l24.65"></a><span id="l24.65" class="difflineplus">+    &quot;secure&quot;,</span>
<a href="#l24.66"></a><span id="l24.66" class="difflineplus">+    &quot;true&quot;,</span>
<a href="#l24.67"></a><span id="l24.67" class="difflineplus">+    true,</span>
<a href="#l24.68"></a><span id="l24.68" class="difflineplus">+    false,</span>
<a href="#l24.69"></a><span id="l24.69" class="difflineplus">+    false,</span>
<a href="#l24.70"></a><span id="l24.70" class="difflineplus">+    expiry,</span>
<a href="#l24.71"></a><span id="l24.71" class="difflineplus">+    {},</span>
<a href="#l24.72"></a><span id="l24.72" class="difflineplus">+    Ci.nsICookie.SAMESITE_NONE</span>
<a href="#l24.73"></a><span id="l24.73" class="difflineplus">+  );</span>
<a href="#l24.74"></a><span id="l24.74" class="difflineplus">+  await setupPolicyEngineWithJson({</span>
<a href="#l24.75"></a><span id="l24.75" class="difflineplus">+    policies: {</span>
<a href="#l24.76"></a><span id="l24.76" class="difflineplus">+      Cookies: {</span>
<a href="#l24.77"></a><span id="l24.77" class="difflineplus">+        Block: [`http://${HOSTNAME_DOMAIN}`, `https://${ORIGIN_DOMAIN}:8080`],</span>
<a href="#l24.78"></a><span id="l24.78" class="difflineplus">+      },</span>
<a href="#l24.79"></a><span id="l24.79" class="difflineplus">+    },</span>
<a href="#l24.80"></a><span id="l24.80" class="difflineplus">+  });</span>
<a href="#l24.81"></a><span id="l24.81" class="difflineplus">+});</span>
<a href="#l24.82"></a><span id="l24.82" class="difflineplus">+</span>
<a href="#l24.83"></a><span id="l24.83" class="difflineplus">+function retrieve_all_cookies(host) {</span>
<a href="#l24.84"></a><span id="l24.84" class="difflineplus">+  const values = [];</span>
<a href="#l24.85"></a><span id="l24.85" class="difflineplus">+  for (let cookie of Services.cookies.getCookiesFromHost(host, {})) {</span>
<a href="#l24.86"></a><span id="l24.86" class="difflineplus">+    values.push({</span>
<a href="#l24.87"></a><span id="l24.87" class="difflineplus">+      host: cookie.host,</span>
<a href="#l24.88"></a><span id="l24.88" class="difflineplus">+      name: cookie.name,</span>
<a href="#l24.89"></a><span id="l24.89" class="difflineplus">+      path: cookie.path,</span>
<a href="#l24.90"></a><span id="l24.90" class="difflineplus">+    });</span>
<a href="#l24.91"></a><span id="l24.91" class="difflineplus">+  }</span>
<a href="#l24.92"></a><span id="l24.92" class="difflineplus">+  return values;</span>
<a href="#l24.93"></a><span id="l24.93" class="difflineplus">+}</span>
<a href="#l24.94"></a><span id="l24.94" class="difflineplus">+</span>
<a href="#l24.95"></a><span id="l24.95" class="difflineplus">+add_task(async function test_cookies_for_blocked_sites_cleared() {</span>
<a href="#l24.96"></a><span id="l24.96" class="difflineplus">+  const cookies = {</span>
<a href="#l24.97"></a><span id="l24.97" class="difflineplus">+    hostname: retrieve_all_cookies(HOSTNAME_DOMAIN),</span>
<a href="#l24.98"></a><span id="l24.98" class="difflineplus">+    origin: retrieve_all_cookies(ORIGIN_DOMAIN),</span>
<a href="#l24.99"></a><span id="l24.99" class="difflineplus">+    keep: retrieve_all_cookies(&quot;example.net&quot;),</span>
<a href="#l24.100"></a><span id="l24.100" class="difflineplus">+  };</span>
<a href="#l24.101"></a><span id="l24.101" class="difflineplus">+  const expected = {</span>
<a href="#l24.102"></a><span id="l24.102" class="difflineplus">+    hostname: [],</span>
<a href="#l24.103"></a><span id="l24.103" class="difflineplus">+    origin: [],</span>
<a href="#l24.104"></a><span id="l24.104" class="difflineplus">+    keep: [{ host: &quot;example.net&quot;, name: &quot;secure&quot;, path: &quot;/&quot; }],</span>
<a href="#l24.105"></a><span id="l24.105" class="difflineplus">+  };</span>
<a href="#l24.106"></a><span id="l24.106" class="difflineplus">+  equal(</span>
<a href="#l24.107"></a><span id="l24.107" class="difflineplus">+    JSON.stringify(cookies),</span>
<a href="#l24.108"></a><span id="l24.108" class="difflineplus">+    JSON.stringify(expected),</span>
<a href="#l24.109"></a><span id="l24.109" class="difflineplus">+    &quot;All stored cookies for blocked origins should be cleared&quot;</span>
<a href="#l24.110"></a><span id="l24.110" class="difflineplus">+  );</span>
<a href="#l24.111"></a><span id="l24.111" class="difflineplus">+});</span>
<a href="#l24.112"></a><span id="l24.112" class="difflineplus">+</span>
<a href="#l24.113"></a><span id="l24.113" class="difflineplus">+add_task(function teardown() {</span>
<a href="#l24.114"></a><span id="l24.114" class="difflineplus">+  for (let host of [HOSTNAME_DOMAIN, ORIGIN_DOMAIN, &quot;example.net&quot;]) {</span>
<a href="#l24.115"></a><span id="l24.115" class="difflineplus">+    Services.cookies.removeCookiesWithOriginAttributes(&quot;{}&quot;, host);</span>
<a href="#l24.116"></a><span id="l24.116" class="difflineplus">+  }</span>
<a href="#l24.117"></a><span id="l24.117" class="difflineplus">+});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mail/components/enterprisepolicies/tests/xpcshell/test_simple_pref_policies.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/xpcshell/test_simple_pref_policies.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -24,16 +24,91 @@ const POLICIES_TESTS = [</span>
<a href="#l25.4"></a><span id="l25.4">    *   // Locked prefs to check</span>
<a href="#l25.5"></a><span id="l25.5">    *   lockedPrefs: { &quot;feature.foo&quot;: false },</span>
<a href="#l25.6"></a><span id="l25.6">    *</span>
<a href="#l25.7"></a><span id="l25.7">    *   // Unlocked prefs to check</span>
<a href="#l25.8"></a><span id="l25.8">    *   unlockedPrefs: { &quot;bar.baz&quot;: 42 }</span>
<a href="#l25.9"></a><span id="l25.9">    * },</span>
<a href="#l25.10"></a><span id="l25.10">    */</span>
<a href="#l25.11"></a><span id="l25.11"> </span>
<a href="#l25.12"></a><span id="l25.12" class="difflineplus">+  // POLICY: DisableSecurityBypass</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+  {</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+    policies: {</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+      DisableSecurityBypass: {</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineplus">+        InvalidCertificate: true,</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineplus">+        SafeBrowsing: true,</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineplus">+      },</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineplus">+    },</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineplus">+    lockedPrefs: {</span>
<a href="#l25.21"></a><span id="l25.21" class="difflineplus">+      &quot;security.certerror.hideAddException&quot;: true,</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineplus">+      &quot;browser.safebrowsing.allowOverride&quot;: false,</span>
<a href="#l25.23"></a><span id="l25.23" class="difflineplus">+    },</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineplus">+  },</span>
<a href="#l25.25"></a><span id="l25.25" class="difflineplus">+</span>
<a href="#l25.26"></a><span id="l25.26" class="difflineplus">+  // POLICY: Authentication</span>
<a href="#l25.27"></a><span id="l25.27" class="difflineplus">+  {</span>
<a href="#l25.28"></a><span id="l25.28" class="difflineplus">+    policies: {</span>
<a href="#l25.29"></a><span id="l25.29" class="difflineplus">+      Authentication: {</span>
<a href="#l25.30"></a><span id="l25.30" class="difflineplus">+        SPNEGO: [&quot;a.com&quot;, &quot;b.com&quot;],</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineplus">+        Delegated: [&quot;a.com&quot;, &quot;b.com&quot;],</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineplus">+        NTLM: [&quot;a.com&quot;, &quot;b.com&quot;],</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineplus">+        AllowNonFQDN: {</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineplus">+          SPNEGO: true,</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineplus">+          NTLM: true,</span>
<a href="#l25.36"></a><span id="l25.36" class="difflineplus">+        },</span>
<a href="#l25.37"></a><span id="l25.37" class="difflineplus">+        AllowProxies: {</span>
<a href="#l25.38"></a><span id="l25.38" class="difflineplus">+          SPNEGO: false,</span>
<a href="#l25.39"></a><span id="l25.39" class="difflineplus">+          NTLM: false,</span>
<a href="#l25.40"></a><span id="l25.40" class="difflineplus">+        },</span>
<a href="#l25.41"></a><span id="l25.41" class="difflineplus">+        PrivateBrowsing: true,</span>
<a href="#l25.42"></a><span id="l25.42" class="difflineplus">+      },</span>
<a href="#l25.43"></a><span id="l25.43" class="difflineplus">+    },</span>
<a href="#l25.44"></a><span id="l25.44" class="difflineplus">+    lockedPrefs: {</span>
<a href="#l25.45"></a><span id="l25.45" class="difflineplus">+      &quot;network.negotiate-auth.trusted-uris&quot;: &quot;a.com, b.com&quot;,</span>
<a href="#l25.46"></a><span id="l25.46" class="difflineplus">+      &quot;network.negotiate-auth.delegation-uris&quot;: &quot;a.com, b.com&quot;,</span>
<a href="#l25.47"></a><span id="l25.47" class="difflineplus">+      &quot;network.automatic-ntlm-auth.trusted-uris&quot;: &quot;a.com, b.com&quot;,</span>
<a href="#l25.48"></a><span id="l25.48" class="difflineplus">+      &quot;network.automatic-ntlm-auth.allow-non-fqdn&quot;: true,</span>
<a href="#l25.49"></a><span id="l25.49" class="difflineplus">+      &quot;network.negotiate-auth.allow-non-fqdn&quot;: true,</span>
<a href="#l25.50"></a><span id="l25.50" class="difflineplus">+      &quot;network.automatic-ntlm-auth.allow-proxies&quot;: false,</span>
<a href="#l25.51"></a><span id="l25.51" class="difflineplus">+      &quot;network.negotiate-auth.allow-proxies&quot;: false,</span>
<a href="#l25.52"></a><span id="l25.52" class="difflineplus">+      &quot;network.auth.private-browsing-sso&quot;: true,</span>
<a href="#l25.53"></a><span id="l25.53" class="difflineplus">+    },</span>
<a href="#l25.54"></a><span id="l25.54" class="difflineplus">+  },</span>
<a href="#l25.55"></a><span id="l25.55" class="difflineplus">+</span>
<a href="#l25.56"></a><span id="l25.56" class="difflineplus">+  // POLICY: Authentication (unlocked)</span>
<a href="#l25.57"></a><span id="l25.57" class="difflineplus">+  {</span>
<a href="#l25.58"></a><span id="l25.58" class="difflineplus">+    policies: {</span>
<a href="#l25.59"></a><span id="l25.59" class="difflineplus">+      Authentication: {</span>
<a href="#l25.60"></a><span id="l25.60" class="difflineplus">+        SPNEGO: [&quot;a.com&quot;, &quot;b.com&quot;],</span>
<a href="#l25.61"></a><span id="l25.61" class="difflineplus">+        Delegated: [&quot;a.com&quot;, &quot;b.com&quot;],</span>
<a href="#l25.62"></a><span id="l25.62" class="difflineplus">+        NTLM: [&quot;a.com&quot;, &quot;b.com&quot;],</span>
<a href="#l25.63"></a><span id="l25.63" class="difflineplus">+        AllowNonFQDN: {</span>
<a href="#l25.64"></a><span id="l25.64" class="difflineplus">+          SPNEGO: true,</span>
<a href="#l25.65"></a><span id="l25.65" class="difflineplus">+          NTLM: true,</span>
<a href="#l25.66"></a><span id="l25.66" class="difflineplus">+        },</span>
<a href="#l25.67"></a><span id="l25.67" class="difflineplus">+        AllowProxies: {</span>
<a href="#l25.68"></a><span id="l25.68" class="difflineplus">+          SPNEGO: false,</span>
<a href="#l25.69"></a><span id="l25.69" class="difflineplus">+          NTLM: false,</span>
<a href="#l25.70"></a><span id="l25.70" class="difflineplus">+        },</span>
<a href="#l25.71"></a><span id="l25.71" class="difflineplus">+        PrivateBrowsing: true,</span>
<a href="#l25.72"></a><span id="l25.72" class="difflineplus">+        Locked: false,</span>
<a href="#l25.73"></a><span id="l25.73" class="difflineplus">+      },</span>
<a href="#l25.74"></a><span id="l25.74" class="difflineplus">+    },</span>
<a href="#l25.75"></a><span id="l25.75" class="difflineplus">+    unlockedPrefs: {</span>
<a href="#l25.76"></a><span id="l25.76" class="difflineplus">+      &quot;network.negotiate-auth.trusted-uris&quot;: &quot;a.com, b.com&quot;,</span>
<a href="#l25.77"></a><span id="l25.77" class="difflineplus">+      &quot;network.negotiate-auth.delegation-uris&quot;: &quot;a.com, b.com&quot;,</span>
<a href="#l25.78"></a><span id="l25.78" class="difflineplus">+      &quot;network.automatic-ntlm-auth.trusted-uris&quot;: &quot;a.com, b.com&quot;,</span>
<a href="#l25.79"></a><span id="l25.79" class="difflineplus">+      &quot;network.automatic-ntlm-auth.allow-non-fqdn&quot;: true,</span>
<a href="#l25.80"></a><span id="l25.80" class="difflineplus">+      &quot;network.negotiate-auth.allow-non-fqdn&quot;: true,</span>
<a href="#l25.81"></a><span id="l25.81" class="difflineplus">+      &quot;network.automatic-ntlm-auth.allow-proxies&quot;: false,</span>
<a href="#l25.82"></a><span id="l25.82" class="difflineplus">+      &quot;network.negotiate-auth.allow-proxies&quot;: false,</span>
<a href="#l25.83"></a><span id="l25.83" class="difflineplus">+      &quot;network.auth.private-browsing-sso&quot;: true,</span>
<a href="#l25.84"></a><span id="l25.84" class="difflineplus">+    },</span>
<a href="#l25.85"></a><span id="l25.85" class="difflineplus">+  },</span>
<a href="#l25.86"></a><span id="l25.86" class="difflineplus">+</span>
<a href="#l25.87"></a><span id="l25.87">   // POLICY: Certificates (true)</span>
<a href="#l25.88"></a><span id="l25.88">   {</span>
<a href="#l25.89"></a><span id="l25.89">     policies: {</span>
<a href="#l25.90"></a><span id="l25.90">       Certificates: {</span>
<a href="#l25.91"></a><span id="l25.91">         ImportEnterpriseRoots: true,</span>
<a href="#l25.92"></a><span id="l25.92">       },</span>
<a href="#l25.93"></a><span id="l25.93">     },</span>
<a href="#l25.94"></a><span id="l25.94">     lockedPrefs: {</span>
<a href="#l25.95"></a><span id="l25.95" class="difflineat">@@ -48,40 +123,16 @@ const POLICIES_TESTS = [</span>
<a href="#l25.96"></a><span id="l25.96">         ImportEnterpriseRoots: false,</span>
<a href="#l25.97"></a><span id="l25.97">       },</span>
<a href="#l25.98"></a><span id="l25.98">     },</span>
<a href="#l25.99"></a><span id="l25.99">     lockedPrefs: {</span>
<a href="#l25.100"></a><span id="l25.100">       &quot;security.enterprise_roots.enabled&quot;: false,</span>
<a href="#l25.101"></a><span id="l25.101">     },</span>
<a href="#l25.102"></a><span id="l25.102">   },</span>
<a href="#l25.103"></a><span id="l25.103"> </span>
<a href="#l25.104"></a><span id="l25.104" class="difflineminus">-  // POLICY: DisableSecurityBypass</span>
<a href="#l25.105"></a><span id="l25.105" class="difflineminus">-  {</span>
<a href="#l25.106"></a><span id="l25.106" class="difflineminus">-    policies: {</span>
<a href="#l25.107"></a><span id="l25.107" class="difflineminus">-      DisableSecurityBypass: {</span>
<a href="#l25.108"></a><span id="l25.108" class="difflineminus">-        InvalidCertificate: true,</span>
<a href="#l25.109"></a><span id="l25.109" class="difflineminus">-        SafeBrowsing: true,</span>
<a href="#l25.110"></a><span id="l25.110" class="difflineminus">-      },</span>
<a href="#l25.111"></a><span id="l25.111" class="difflineminus">-    },</span>
<a href="#l25.112"></a><span id="l25.112" class="difflineminus">-    lockedPrefs: {</span>
<a href="#l25.113"></a><span id="l25.113" class="difflineminus">-      &quot;security.certerror.hideAddException&quot;: true,</span>
<a href="#l25.114"></a><span id="l25.114" class="difflineminus">-      &quot;browser.safebrowsing.allowOverride&quot;: false,</span>
<a href="#l25.115"></a><span id="l25.115" class="difflineminus">-    },</span>
<a href="#l25.116"></a><span id="l25.116" class="difflineminus">-  },</span>
<a href="#l25.117"></a><span id="l25.117" class="difflineminus">-</span>
<a href="#l25.118"></a><span id="l25.118" class="difflineminus">-  // POLICY: ExtensionUpdate</span>
<a href="#l25.119"></a><span id="l25.119" class="difflineminus">-  {</span>
<a href="#l25.120"></a><span id="l25.120" class="difflineminus">-    policies: {</span>
<a href="#l25.121"></a><span id="l25.121" class="difflineminus">-      ExtensionUpdate: false,</span>
<a href="#l25.122"></a><span id="l25.122" class="difflineminus">-    },</span>
<a href="#l25.123"></a><span id="l25.123" class="difflineminus">-    lockedPrefs: {</span>
<a href="#l25.124"></a><span id="l25.124" class="difflineminus">-      &quot;extensions.update.enabled&quot;: false,</span>
<a href="#l25.125"></a><span id="l25.125" class="difflineminus">-    },</span>
<a href="#l25.126"></a><span id="l25.126" class="difflineminus">-  },</span>
<a href="#l25.127"></a><span id="l25.127" class="difflineminus">-</span>
<a href="#l25.128"></a><span id="l25.128">   // POLICY: InstallAddons.Default (block addon installs)</span>
<a href="#l25.129"></a><span id="l25.129">   {</span>
<a href="#l25.130"></a><span id="l25.130">     policies: {</span>
<a href="#l25.131"></a><span id="l25.131">       InstallAddonsPermission: {</span>
<a href="#l25.132"></a><span id="l25.132">         Default: false,</span>
<a href="#l25.133"></a><span id="l25.133">       },</span>
<a href="#l25.134"></a><span id="l25.134">     },</span>
<a href="#l25.135"></a><span id="l25.135">     lockedPrefs: {</span>
<a href="#l25.136"></a><span id="l25.136" class="difflineat">@@ -107,16 +158,36 @@ const POLICIES_TESTS = [</span>
<a href="#l25.137"></a><span id="l25.137">       SSLVersionMin: &quot;tls1.2&quot;,</span>
<a href="#l25.138"></a><span id="l25.138">       SSLVersionMax: &quot;tls1.3&quot;,</span>
<a href="#l25.139"></a><span id="l25.139">     },</span>
<a href="#l25.140"></a><span id="l25.140">     lockedPrefs: {</span>
<a href="#l25.141"></a><span id="l25.141">       &quot;security.tls.version.min&quot;: 3,</span>
<a href="#l25.142"></a><span id="l25.142">       &quot;security.tls.version.max&quot;: 4,</span>
<a href="#l25.143"></a><span id="l25.143">     },</span>
<a href="#l25.144"></a><span id="l25.144">   },</span>
<a href="#l25.145"></a><span id="l25.145" class="difflineplus">+</span>
<a href="#l25.146"></a><span id="l25.146" class="difflineplus">+  // POLICY: CaptivePortal</span>
<a href="#l25.147"></a><span id="l25.147" class="difflineplus">+  {</span>
<a href="#l25.148"></a><span id="l25.148" class="difflineplus">+    policies: {</span>
<a href="#l25.149"></a><span id="l25.149" class="difflineplus">+      CaptivePortal: false,</span>
<a href="#l25.150"></a><span id="l25.150" class="difflineplus">+    },</span>
<a href="#l25.151"></a><span id="l25.151" class="difflineplus">+    lockedPrefs: {</span>
<a href="#l25.152"></a><span id="l25.152" class="difflineplus">+      &quot;network.captive-portal-service.enabled&quot;: false,</span>
<a href="#l25.153"></a><span id="l25.153" class="difflineplus">+    },</span>
<a href="#l25.154"></a><span id="l25.154" class="difflineplus">+  },</span>
<a href="#l25.155"></a><span id="l25.155" class="difflineplus">+</span>
<a href="#l25.156"></a><span id="l25.156" class="difflineplus">+  // POLICY: ExtensionUpdate</span>
<a href="#l25.157"></a><span id="l25.157" class="difflineplus">+  {</span>
<a href="#l25.158"></a><span id="l25.158" class="difflineplus">+    policies: {</span>
<a href="#l25.159"></a><span id="l25.159" class="difflineplus">+      ExtensionUpdate: false,</span>
<a href="#l25.160"></a><span id="l25.160" class="difflineplus">+    },</span>
<a href="#l25.161"></a><span id="l25.161" class="difflineplus">+    lockedPrefs: {</span>
<a href="#l25.162"></a><span id="l25.162" class="difflineplus">+      &quot;extensions.update.enabled&quot;: false,</span>
<a href="#l25.163"></a><span id="l25.163" class="difflineplus">+    },</span>
<a href="#l25.164"></a><span id="l25.164" class="difflineplus">+  },</span>
<a href="#l25.165"></a><span id="l25.165"> ];</span>
<a href="#l25.166"></a><span id="l25.166"> </span>
<a href="#l25.167"></a><span id="l25.167"> add_task(async function test_policy_simple_prefs() {</span>
<a href="#l25.168"></a><span id="l25.168">   for (let test of POLICIES_TESTS) {</span>
<a href="#l25.169"></a><span id="l25.169">     await setupPolicyEngineWithJson({</span>
<a href="#l25.170"></a><span id="l25.170">       policies: test.policies,</span>
<a href="#l25.171"></a><span id="l25.171">     });</span>
<a href="#l25.172"></a><span id="l25.172"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mail/components/enterprisepolicies/tests/xpcshell/xpcshell.ini</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mail/components/enterprisepolicies/tests/xpcshell/xpcshell.ini</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -1,13 +1,15 @@</span>
<a href="#l26.4"></a><span id="l26.4"> [DEFAULT]</span>
<a href="#l26.5"></a><span id="l26.5"> firefox-appdir = browser</span>
<a href="#l26.6"></a><span id="l26.6"> head = head.js</span>
<a href="#l26.7"></a><span id="l26.7"> </span>
<a href="#l26.8"></a><span id="l26.8" class="difflineplus">+[test_3rdparty.js]</span>
<a href="#l26.9"></a><span id="l26.9"> [test_appupdateurl.js]</span>
<a href="#l26.10"></a><span id="l26.10" class="difflineplus">+[test_clear_blocked_cookies.js]</span>
<a href="#l26.11"></a><span id="l26.11"> [test_macosparser_unflatten.js]</span>
<a href="#l26.12"></a><span id="l26.12"> skip-if = os != 'mac'</span>
<a href="#l26.13"></a><span id="l26.13"> [test_preferences.js]</span>
<a href="#l26.14"></a><span id="l26.14"> [test_proxy.js]</span>
<a href="#l26.15"></a><span id="l26.15"> [test_requestedlocales.js]</span>
<a href="#l26.16"></a><span id="l26.16"> [test_runOnce_helper.js]</span>
<a href="#l26.17"></a><span id="l26.17"> [test_simple_pref_policies.js]</span>
<a href="#l26.18"></a><span id="l26.18"> [test_sorted_alphabetically.js]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mail/components/preferences/downloads.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mail/components/preferences/downloads.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -41,18 +41,19 @@ var gDownloadDirSection = {</span>
<a href="#l27.4"></a><span id="l27.4">     folderListPref.value = await this._fileToIndex(file);</span>
<a href="#l27.5"></a><span id="l27.5">   },</span>
<a href="#l27.6"></a><span id="l27.6"> </span>
<a href="#l27.7"></a><span id="l27.7">   onReadUseDownloadDir() {</span>
<a href="#l27.8"></a><span id="l27.8">     this.readDownloadDirPref();</span>
<a href="#l27.9"></a><span id="l27.9">     var downloadFolder = document.getElementById(&quot;downloadFolder&quot;);</span>
<a href="#l27.10"></a><span id="l27.10">     var chooseFolder = document.getElementById(&quot;chooseFolder&quot;);</span>
<a href="#l27.11"></a><span id="l27.11">     var preference = Preferences.get(&quot;browser.download.useDownloadDir&quot;);</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-    downloadFolder.disabled = !preference.value;</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineminus">-    chooseFolder.disabled = !preference.value;</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineplus">+    var dirPreference = Preferences.get(&quot;browser.download.dir&quot;);</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineplus">+    downloadFolder.disabled = !preference.value || dirPreference.locked;</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineplus">+    chooseFolder.disabled = !preference.value || dirPreference.locked;</span>
<a href="#l27.17"></a><span id="l27.17">     return undefined;</span>
<a href="#l27.18"></a><span id="l27.18">   },</span>
<a href="#l27.19"></a><span id="l27.19"> </span>
<a href="#l27.20"></a><span id="l27.20">   async _fileToIndex(aFile) {</span>
<a href="#l27.21"></a><span id="l27.21">     if (!aFile || aFile.equals(await this._getDownloadsFolder(&quot;Desktop&quot;))) {</span>
<a href="#l27.22"></a><span id="l27.22">       return 0;</span>
<a href="#l27.23"></a><span id="l27.23">     } else if (aFile.equals(await this._getDownloadsFolder(&quot;Downloads&quot;))) {</span>
<a href="#l27.24"></a><span id="l27.24">       return 1;</span>
<a href="#l27.25"></a><span id="l27.25" class="difflineat">@@ -103,23 +104,25 @@ var gDownloadDirSection = {</span>
<a href="#l27.26"></a><span id="l27.26">       downloadFolder.value = customDirPref.value</span>
<a href="#l27.27"></a><span id="l27.27">         ? customDirPref.value.path</span>
<a href="#l27.28"></a><span id="l27.28">         : &quot;&quot;;</span>
<a href="#l27.29"></a><span id="l27.29">     }</span>
<a href="#l27.30"></a><span id="l27.30"> </span>
<a href="#l27.31"></a><span id="l27.31">     var currentDirPref = Preferences.get(&quot;browser.download.downloadDir&quot;);</span>
<a href="#l27.32"></a><span id="l27.32">     var downloadDir =</span>
<a href="#l27.33"></a><span id="l27.33">       currentDirPref.value || (await this._indexToFile(folderListPref.value));</span>
<a href="#l27.34"></a><span id="l27.34" class="difflineminus">-    let urlSpec = Services.io</span>
<a href="#l27.35"></a><span id="l27.35" class="difflineminus">-      .getProtocolHandler(&quot;file&quot;)</span>
<a href="#l27.36"></a><span id="l27.36" class="difflineminus">-      .QueryInterface(Ci.nsIFileProtocolHandler)</span>
<a href="#l27.37"></a><span id="l27.37" class="difflineminus">-      .getURLSpecFromFile(downloadDir);</span>
<a href="#l27.38"></a><span id="l27.38" class="difflineplus">+    if (downloadDir) {</span>
<a href="#l27.39"></a><span id="l27.39" class="difflineplus">+      let urlSpec = Services.io</span>
<a href="#l27.40"></a><span id="l27.40" class="difflineplus">+        .getProtocolHandler(&quot;file&quot;)</span>
<a href="#l27.41"></a><span id="l27.41" class="difflineplus">+        .QueryInterface(Ci.nsIFileProtocolHandler)</span>
<a href="#l27.42"></a><span id="l27.42" class="difflineplus">+        .getURLSpecFromFile(downloadDir);</span>
<a href="#l27.43"></a><span id="l27.43"> </span>
<a href="#l27.44"></a><span id="l27.44" class="difflineminus">-    downloadFolder.style.backgroundImage =</span>
<a href="#l27.45"></a><span id="l27.45" class="difflineminus">-      &quot;url(moz-icon://&quot; + urlSpec + &quot;?size=16)&quot;;</span>
<a href="#l27.46"></a><span id="l27.46" class="difflineplus">+      downloadFolder.style.backgroundImage =</span>
<a href="#l27.47"></a><span id="l27.47" class="difflineplus">+        &quot;url(moz-icon://&quot; + urlSpec + &quot;?size=16)&quot;;</span>
<a href="#l27.48"></a><span id="l27.48" class="difflineplus">+    }</span>
<a href="#l27.49"></a><span id="l27.49"> </span>
<a href="#l27.50"></a><span id="l27.50">     return undefined;</span>
<a href="#l27.51"></a><span id="l27.51">   },</span>
<a href="#l27.52"></a><span id="l27.52"> };</span>
<a href="#l27.53"></a><span id="l27.53"> </span>
<a href="#l27.54"></a><span id="l27.54"> Preferences.get(&quot;browser.download.dir&quot;).on(</span>
<a href="#l27.55"></a><span id="l27.55">   &quot;change&quot;,</span>
<a href="#l27.56"></a><span id="l27.56">   gDownloadDirSection.readDownloadDirPref.bind(gDownloadDirSection)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mail/components/preferences/privacy.inc.xhtml</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mail/components/preferences/privacy.inc.xhtml</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -107,17 +107,18 @@</span>
<a href="#l28.4"></a><span id="l28.4">     &lt;/hbox&gt;</span>
<a href="#l28.5"></a><span id="l28.5"> </span>
<a href="#l28.6"></a><span id="l28.6">     &lt;separator data-category=&quot;panePrivacy&quot;/&gt;</span>
<a href="#l28.7"></a><span id="l28.7"> </span>
<a href="#l28.8"></a><span id="l28.8">     &lt;html:fieldset data-category=&quot;panePrivacy&quot;&gt;</span>
<a href="#l28.9"></a><span id="l28.9">       &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l28.10"></a><span id="l28.10">         &lt;description&gt;&amp;savedPasswords.intro;&lt;/description&gt;</span>
<a href="#l28.11"></a><span id="l28.11">         &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-        &lt;button label=&quot;&amp;savedPasswords.label;&quot;</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+        &lt;button id=&quot;showPasswords&quot;</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineplus">+                label=&quot;&amp;savedPasswords.label;&quot;</span>
<a href="#l28.15"></a><span id="l28.15">                 accesskey=&quot;&amp;savedPasswords.accesskey;&quot;</span>
<a href="#l28.16"></a><span id="l28.16">                 oncommand=&quot;gPrivacyPane.showPasswords();&quot;</span>
<a href="#l28.17"></a><span id="l28.17">                 preference=&quot;pref.privacy.disable_button.view_passwords&quot;/&gt;</span>
<a href="#l28.18"></a><span id="l28.18">       &lt;/hbox&gt;</span>
<a href="#l28.19"></a><span id="l28.19">       &lt;!-- XXX button to do a showExceptions()? --&gt;</span>
<a href="#l28.20"></a><span id="l28.20"> </span>
<a href="#l28.21"></a><span id="l28.21">       &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l28.22"></a><span id="l28.22"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mail/components/preferences/privacy.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mail/components/preferences/privacy.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -73,16 +73,17 @@ var gPrivacyPane = {</span>
<a href="#l29.4"></a><span id="l29.4"> </span>
<a href="#l29.5"></a><span id="l29.5">     this._initMasterPasswordUI();</span>
<a href="#l29.6"></a><span id="l29.6"> </span>
<a href="#l29.7"></a><span id="l29.7">     if (AppConstants.MOZ_CRASHREPORTER) {</span>
<a href="#l29.8"></a><span id="l29.8">       this.initSubmitCrashes();</span>
<a href="#l29.9"></a><span id="l29.9">     }</span>
<a href="#l29.10"></a><span id="l29.10">     this.initTelemetry();</span>
<a href="#l29.11"></a><span id="l29.11"> </span>
<a href="#l29.12"></a><span id="l29.12" class="difflineplus">+    this.readAcceptCookies();</span>
<a href="#l29.13"></a><span id="l29.13">     let element = document.getElementById(&quot;acceptCookies&quot;);</span>
<a href="#l29.14"></a><span id="l29.14">     Preferences.addSyncFromPrefListener(element, () =&gt;</span>
<a href="#l29.15"></a><span id="l29.15">       this.readAcceptCookies()</span>
<a href="#l29.16"></a><span id="l29.16">     );</span>
<a href="#l29.17"></a><span id="l29.17">     Preferences.addSyncToPrefListener(element, () =&gt; this.writeAcceptCookies());</span>
<a href="#l29.18"></a><span id="l29.18"> </span>
<a href="#l29.19"></a><span id="l29.19">     element = document.getElementById(&quot;acceptThirdPartyMenu&quot;);</span>
<a href="#l29.20"></a><span id="l29.20">     Preferences.addSyncFromPrefListener(element, () =&gt;</span>
<a href="#l29.21"></a><span id="l29.21" class="difflineat">@@ -113,28 +114,40 @@ var gPrivacyPane = {</span>
<a href="#l29.22"></a><span id="l29.22"> </span>
<a href="#l29.23"></a><span id="l29.23">   /**</span>
<a href="#l29.24"></a><span id="l29.24">    * Reads the network.cookie.cookieBehavior preference value and</span>
<a href="#l29.25"></a><span id="l29.25">    * enables/disables the rest of the cookie UI accordingly, returning true</span>
<a href="#l29.26"></a><span id="l29.26">    * if cookies are enabled.</span>
<a href="#l29.27"></a><span id="l29.27">    */</span>
<a href="#l29.28"></a><span id="l29.28">   readAcceptCookies() {</span>
<a href="#l29.29"></a><span id="l29.29">     let pref = Preferences.get(&quot;network.cookie.cookieBehavior&quot;);</span>
<a href="#l29.30"></a><span id="l29.30" class="difflineplus">+    let exceptionsButton = document.getElementById(&quot;cookieExceptions&quot;);</span>
<a href="#l29.31"></a><span id="l29.31">     let acceptThirdPartyLabel = document.getElementById(</span>
<a href="#l29.32"></a><span id="l29.32">       &quot;acceptThirdPartyLabel&quot;</span>
<a href="#l29.33"></a><span id="l29.33">     );</span>
<a href="#l29.34"></a><span id="l29.34">     let acceptThirdPartyMenu = document.getElementById(&quot;acceptThirdPartyMenu&quot;);</span>
<a href="#l29.35"></a><span id="l29.35">     let keepUntil = document.getElementById(&quot;keepUntil&quot;);</span>
<a href="#l29.36"></a><span id="l29.36">     let menu = document.getElementById(&quot;keepCookiesUntil&quot;);</span>
<a href="#l29.37"></a><span id="l29.37" class="difflineplus">+    let showCookiesButton = document.getElementById(&quot;showCookiesButton&quot;);</span>
<a href="#l29.38"></a><span id="l29.38"> </span>
<a href="#l29.39"></a><span id="l29.39">     // enable the rest of the UI for anything other than &quot;disable all cookies&quot;</span>
<a href="#l29.40"></a><span id="l29.40">     let acceptCookies = pref.value != 2;</span>
<a href="#l29.41"></a><span id="l29.41" class="difflineplus">+    let cookieBehaviorLocked = Services.prefs.prefIsLocked(</span>
<a href="#l29.42"></a><span id="l29.42" class="difflineplus">+      &quot;network.cookie.cookieBehavior&quot;</span>
<a href="#l29.43"></a><span id="l29.43" class="difflineplus">+    );</span>
<a href="#l29.44"></a><span id="l29.44" class="difflineplus">+    let cookieExpirationLocked = Services.prefs.prefIsLocked(</span>
<a href="#l29.45"></a><span id="l29.45" class="difflineplus">+      &quot;network.cookie.lifetimePolicy&quot;</span>
<a href="#l29.46"></a><span id="l29.46" class="difflineplus">+    );</span>
<a href="#l29.47"></a><span id="l29.47"> </span>
<a href="#l29.48"></a><span id="l29.48" class="difflineminus">-    acceptThirdPartyLabel.disabled = acceptThirdPartyMenu.disabled = !acceptCookies;</span>
<a href="#l29.49"></a><span id="l29.49" class="difflineminus">-    keepUntil.disabled = menu.disabled = !acceptCookies;</span>
<a href="#l29.50"></a><span id="l29.50" class="difflineplus">+    exceptionsButton.disabled = !acceptCookies || cookieBehaviorLocked;</span>
<a href="#l29.51"></a><span id="l29.51" class="difflineplus">+    acceptThirdPartyLabel.disabled = acceptThirdPartyMenu.disabled =</span>
<a href="#l29.52"></a><span id="l29.52" class="difflineplus">+      !acceptCookies || cookieBehaviorLocked;</span>
<a href="#l29.53"></a><span id="l29.53" class="difflineplus">+    keepUntil.disabled = menu.disabled =</span>
<a href="#l29.54"></a><span id="l29.54" class="difflineplus">+      !acceptCookies || cookieBehaviorLocked || cookieExpirationLocked;</span>
<a href="#l29.55"></a><span id="l29.55" class="difflineplus">+    showCookiesButton.disabled = cookieBehaviorLocked;</span>
<a href="#l29.56"></a><span id="l29.56"> </span>
<a href="#l29.57"></a><span id="l29.57">     return acceptCookies;</span>
<a href="#l29.58"></a><span id="l29.58">   },</span>
<a href="#l29.59"></a><span id="l29.59"> </span>
<a href="#l29.60"></a><span id="l29.60">   /**</span>
<a href="#l29.61"></a><span id="l29.61">    * Enables/disables the &quot;keep until&quot; label and menulist in response to the</span>
<a href="#l29.62"></a><span id="l29.62">    * &quot;accept cookies&quot; checkbox being checked or unchecked.</span>
<a href="#l29.63"></a><span id="l29.63">    * @return 0 if cookies are accepted, 2 if they are not;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mail/locales/en-US/messenger/policies/policies-descriptions.ftl</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mail/locales/en-US/messenger/policies/policies-descriptions.ftl</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -32,24 +32,30 @@ policy-CertificatesDescription = Add cer</span>
<a href="#l30.4"></a><span id="l30.4"> policy-Cookies = Allow or deny websites to set cookies.</span>
<a href="#l30.5"></a><span id="l30.5"> </span>
<a href="#l30.6"></a><span id="l30.6"> policy-DisabledCiphers = Disable ciphers.</span>
<a href="#l30.7"></a><span id="l30.7"> </span>
<a href="#l30.8"></a><span id="l30.8"> policy-DefaultDownloadDirectory = Set the default download directory.</span>
<a href="#l30.9"></a><span id="l30.9"> </span>
<a href="#l30.10"></a><span id="l30.10"> policy-DisableAppUpdate = Prevent { -brand-short-name } from updating.</span>
<a href="#l30.11"></a><span id="l30.11"> </span>
<a href="#l30.12"></a><span id="l30.12" class="difflineplus">+policy-DisableDefaultClientAgent = Prevent the default client agent from taking any actions. Only applicable to Windows; other platforms don’t have the agent.</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+</span>
<a href="#l30.14"></a><span id="l30.14"> policy-DisableDeveloperTools = Block access to the developer tools.</span>
<a href="#l30.15"></a><span id="l30.15"> </span>
<a href="#l30.16"></a><span id="l30.16"> policy-DisableFeedbackCommands = Disable commands to send feedback from the Help menu (Submit Feedback and Report Deceptive Site).</span>
<a href="#l30.17"></a><span id="l30.17"> </span>
<a href="#l30.18"></a><span id="l30.18"> policy-DisableForgetButton = Prevent access to the Forget button.</span>
<a href="#l30.19"></a><span id="l30.19"> </span>
<a href="#l30.20"></a><span id="l30.20" class="difflineplus">+policy-DisableFormHistory = Don’t remember search and form history.</span>
<a href="#l30.21"></a><span id="l30.21" class="difflineplus">+</span>
<a href="#l30.22"></a><span id="l30.22"> policy-DisableMasterPasswordCreation = If true, a master password can’t be created.</span>
<a href="#l30.23"></a><span id="l30.23"> </span>
<a href="#l30.24"></a><span id="l30.24" class="difflineplus">+policy-DisablePasswordReveal = Do not allow passwords to be revealed in saved logins.</span>
<a href="#l30.25"></a><span id="l30.25" class="difflineplus">+</span>
<a href="#l30.26"></a><span id="l30.26"> policy-DisableProfileImport = Disable the menu command to Import data from another application.</span>
<a href="#l30.27"></a><span id="l30.27"> </span>
<a href="#l30.28"></a><span id="l30.28"> policy-DisableSafeMode = Disable the feature to restart in Safe Mode. Note: the Shift key to enter Safe Mode can only be disabled on Windows using Group Policy.</span>
<a href="#l30.29"></a><span id="l30.29"> </span>
<a href="#l30.30"></a><span id="l30.30"> policy-DisableSecurityBypass = Prevent the user from bypassing certain security warnings.</span>
<a href="#l30.31"></a><span id="l30.31"> </span>
<a href="#l30.32"></a><span id="l30.32"> policy-DisableSystemAddonUpdate = Prevent { -brand-short-name } from installing and updating system add-ons.</span>
<a href="#l30.33"></a><span id="l30.33"> </span>
<a href="#l30.34"></a><span id="l30.34" class="difflineat">@@ -61,54 +67,80 @@ policy-DNSOverHTTPS = Configure DNS over</span>
<a href="#l30.35"></a><span id="l30.35"> </span>
<a href="#l30.36"></a><span id="l30.36"> policy-DontCheckDefaultClient = Disable check for default client on startup.</span>
<a href="#l30.37"></a><span id="l30.37"> </span>
<a href="#l30.38"></a><span id="l30.38"> policy-DownloadDirectory = Set and lock the download directory.</span>
<a href="#l30.39"></a><span id="l30.39"> </span>
<a href="#l30.40"></a><span id="l30.40"> # “lock” means that the user won’t be able to change this setting</span>
<a href="#l30.41"></a><span id="l30.41"> policy-EnableTrackingProtection = Enable or disable Content Blocking and optionally lock it.</span>
<a href="#l30.42"></a><span id="l30.42"> </span>
<a href="#l30.43"></a><span id="l30.43" class="difflineplus">+# “lock” means that the user won’t be able to change this setting</span>
<a href="#l30.44"></a><span id="l30.44" class="difflineplus">+policy-EncryptedMediaExtensions = Enable or disable Encrypted Media Extensions and optionally lock it.</span>
<a href="#l30.45"></a><span id="l30.45" class="difflineplus">+</span>
<a href="#l30.46"></a><span id="l30.46"> # A “locked” extension can’t be disabled or removed by the user. This policy</span>
<a href="#l30.47"></a><span id="l30.47"> # takes 3 keys (“Install”, ”Uninstall”, ”Locked”), you can either keep them in</span>
<a href="#l30.48"></a><span id="l30.48"> # English or translate them as verbs.</span>
<a href="#l30.49"></a><span id="l30.49"> policy-Extensions = Install, uninstall or lock extensions. The Install option takes URLs or paths as parameters. The Uninstall and Locked options take extension IDs.</span>
<a href="#l30.50"></a><span id="l30.50"> </span>
<a href="#l30.51"></a><span id="l30.51"> policy-ExtensionSettings = Manage all aspects of extension installation.</span>
<a href="#l30.52"></a><span id="l30.52"> </span>
<a href="#l30.53"></a><span id="l30.53"> policy-ExtensionUpdate = Enable or disable automatic extension updates.</span>
<a href="#l30.54"></a><span id="l30.54"> </span>
<a href="#l30.55"></a><span id="l30.55"> policy-HardwareAcceleration = If false, turn off hardware acceleration.</span>
<a href="#l30.56"></a><span id="l30.56"> </span>
<a href="#l30.57"></a><span id="l30.57"> policy-InstallAddonsPermission = Allow certain websites to install add-ons.</span>
<a href="#l30.58"></a><span id="l30.58"> </span>
<a href="#l30.59"></a><span id="l30.59" class="difflineplus">+policy-LegacyProfiles = Disable the feature enforcing a separate profile for each installation.</span>
<a href="#l30.60"></a><span id="l30.60" class="difflineplus">+</span>
<a href="#l30.61"></a><span id="l30.61" class="difflineplus">+## Do not translate &quot;SameSite&quot;, it's the name of a cookie attribute.</span>
<a href="#l30.62"></a><span id="l30.62" class="difflineplus">+</span>
<a href="#l30.63"></a><span id="l30.63" class="difflineplus">+policy-LegacySameSiteCookieBehaviorEnabled = Enable default legacy SameSite cookie behavior setting.</span>
<a href="#l30.64"></a><span id="l30.64" class="difflineplus">+</span>
<a href="#l30.65"></a><span id="l30.65" class="difflineplus">+policy-LegacySameSiteCookieBehaviorEnabledForDomainList = Revert to legacy SameSite behavior for cookies on specified sites.</span>
<a href="#l30.66"></a><span id="l30.66" class="difflineplus">+</span>
<a href="#l30.67"></a><span id="l30.67" class="difflineplus">+##</span>
<a href="#l30.68"></a><span id="l30.68" class="difflineplus">+</span>
<a href="#l30.69"></a><span id="l30.69"> policy-LocalFileLinks = Allow specific websites to link to local files.</span>
<a href="#l30.70"></a><span id="l30.70"> </span>
<a href="#l30.71"></a><span id="l30.71"> policy-NetworkPrediction = Enable or disable network prediction (DNS prefetching).</span>
<a href="#l30.72"></a><span id="l30.72"> </span>
<a href="#l30.73"></a><span id="l30.73"> policy-OfferToSaveLogins = Enforce the setting to allow { -brand-short-name } to offer to remember saved logins and passwords. Both true and false values are accepted.</span>
<a href="#l30.74"></a><span id="l30.74"> </span>
<a href="#l30.75"></a><span id="l30.75" class="difflineplus">+policy-OfferToSaveLoginsDefault = Set the default value for allowing { -brand-short-name } to offer to remember saved logins and passwords. Both true and false values are accepted.</span>
<a href="#l30.76"></a><span id="l30.76" class="difflineplus">+</span>
<a href="#l30.77"></a><span id="l30.77"> policy-OverrideFirstRunPage = Override the first run page. Set this policy to blank if you want to disable the first run page.</span>
<a href="#l30.78"></a><span id="l30.78"> </span>
<a href="#l30.79"></a><span id="l30.79"> policy-OverridePostUpdatePage = Override the post-update “What’s New” page. Set this policy to blank if you want to disable the post-update page.</span>
<a href="#l30.80"></a><span id="l30.80"> </span>
<a href="#l30.81"></a><span id="l30.81" class="difflineplus">+policy-PasswordManagerEnabled = Enable saving passwords to the password manager.</span>
<a href="#l30.82"></a><span id="l30.82" class="difflineplus">+</span>
<a href="#l30.83"></a><span id="l30.83" class="difflineplus">+# PDF.js and PDF should not be translated</span>
<a href="#l30.84"></a><span id="l30.84" class="difflineplus">+policy-PDFjs = Disable or configure PDF.js, the built-in PDF viewer in { -brand-short-name }.</span>
<a href="#l30.85"></a><span id="l30.85" class="difflineplus">+</span>
<a href="#l30.86"></a><span id="l30.86" class="difflineplus">+policy-Permissions2 = Configure permissions for camera, microphone, location, notifications, and autoplay.</span>
<a href="#l30.87"></a><span id="l30.87" class="difflineplus">+</span>
<a href="#l30.88"></a><span id="l30.88"> policy-Preferences = Set and lock the value for a subset of preferences.</span>
<a href="#l30.89"></a><span id="l30.89"> </span>
<a href="#l30.90"></a><span id="l30.90"> policy-PromptForDownloadLocation = Ask where to save files when downloading.</span>
<a href="#l30.91"></a><span id="l30.91"> </span>
<a href="#l30.92"></a><span id="l30.92"> policy-Proxy = Configure proxy settings.</span>
<a href="#l30.93"></a><span id="l30.93"> </span>
<a href="#l30.94"></a><span id="l30.94"> policy-RequestedLocales = Set the list of requested locales for the application in order of preference.</span>
<a href="#l30.95"></a><span id="l30.95"> </span>
<a href="#l30.96"></a><span id="l30.96"> policy-SanitizeOnShutdown2 = Clear navigation data on shutdown.</span>
<a href="#l30.97"></a><span id="l30.97"> </span>
<a href="#l30.98"></a><span id="l30.98"> policy-SearchEngines = Configure search engine settings. This policy is only available on the Extended Support Release (ESR) version.</span>
<a href="#l30.99"></a><span id="l30.99"> </span>
<a href="#l30.100"></a><span id="l30.100" class="difflineplus">+policy-SearchSuggestEnabled = Enable or disable search suggestions.</span>
<a href="#l30.101"></a><span id="l30.101" class="difflineplus">+</span>
<a href="#l30.102"></a><span id="l30.102"> # For more information, see https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/PKCS11/Module_Installation</span>
<a href="#l30.103"></a><span id="l30.103"> policy-SecurityDevices = Install PKCS #11 modules.</span>
<a href="#l30.104"></a><span id="l30.104"> </span>
<a href="#l30.105"></a><span id="l30.105"> policy-SSLVersionMax = Set the maximum SSL version.</span>
<a href="#l30.106"></a><span id="l30.106"> </span>
<a href="#l30.107"></a><span id="l30.107"> policy-SSLVersionMin = Set the minimum SSL version.</span>
<a href="#l30.108"></a><span id="l30.108"> </span>
<a href="#l30.109"></a><span id="l30.109"> policy-SupportMenu = Add a custom support menu item to the help menu.</span>
<a href="#l30.110"></a><span id="l30.110"> </span>
<a href="#l30.111"></a><span id="l30.111" class="difflineplus">+policy-UserMessaging = Don’t show certain messages to the user.</span>
<a href="#l30.112"></a><span id="l30.112" class="difflineplus">+</span>
<a href="#l30.113"></a><span id="l30.113"> # “format” refers to the format used for the value of this policy.</span>
<a href="#l30.114"></a><span id="l30.114"> policy-WebsiteFilter = Block websites from being visited. See documentation for more details on the format.</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:31Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

