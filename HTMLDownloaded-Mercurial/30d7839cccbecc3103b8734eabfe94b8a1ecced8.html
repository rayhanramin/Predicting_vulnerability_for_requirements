<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 18833:30d7839cccbecc3103b8734eabfe94b8a1ecced8</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 30d7839cccbecc3103b8734eabfe94b8a1ecced8" />
<meta property="og:url" content="/comm-central/rev/30d7839cccbecc3103b8734eabfe94b8a1ecced8" />
<meta property="og:description" content="Bug 1237602 - Port bug 1220564 - Remove legacy array/generator comprehension: mail. r=aceman" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 30d7839cccbecc3103b8734eabfe94b8a1ecced8 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/30d7839cccbecc3103b8734eabfe94b8a1ecced8">shortlog</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/30d7839cccbecc3103b8734eabfe94b8a1ecced8">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8">files</a> |
changeset |
<a href="/comm-central/raw-rev/30d7839cccbecc3103b8734eabfe94b8a1ecced8">raw</a>  | <a href="/comm-central/archive/30d7839cccbecc3103b8734eabfe94b8a1ecced8.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1237602">Bug 1237602</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1220564">bug 1220564</a> - Remove legacy array/generator comprehension: mail. r=aceman
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#83;&#101;&#98;&#97;&#115;&#116;&#105;&#97;&#110;&#32;&#72;&#101;&#110;&#103;&#115;&#116;&#32;&#60;&#97;&#114;&#99;&#104;&#97;&#101;&#111;&#112;&#116;&#101;&#114;&#121;&#120;&#64;&#99;&#111;&#111;&#108;&#101;&#45;&#102;&#105;&#108;&#101;&#115;&#46;&#100;&#101;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 12 Jan 2016 00:27:24 +0100</td></tr>

<tr>
 <td>changeset 18833</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/30d7839cccbecc3103b8734eabfe94b8a1ecced8">30d7839cccbecc3103b8734eabfe94b8a1ecced8</a></td>
</tr>



<tr>
<td>parent 18832</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/17e3470d8d8d489e589b3c8a36c5e3b89a73068d">17e3470d8d8d489e589b3c8a36c5e3b89a73068d</a>
</td>
</tr>

<tr>
<td>child 18834</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/1a7fafc84e67cb372998e45e1568dc832f85b6d6">1a7fafc84e67cb372998e45e1568dc832f85b6d6</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=30d7839cccbecc3103b8734eabfe94b8a1ecced8">11539</a></td></tr>
<tr><td>push user</td><td>archaeopteryx@coole-files.de</td></tr>
<tr><td>push date</td><td class="date age">Mon, 11 Jan 2016 23:31:12 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@1a7fafc84e67 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1a7fafc84e67cb372998e45e1568dc832f85b6d6">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1a7fafc84e67cb372998e45e1568dc832f85b6d6&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1a7fafc84e67cb372998e45e1568dc832f85b6d6&newProject=comm-central&newRevision=17e3470d8d8d489e589b3c8a36c5e3b89a73068d&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1a7fafc84e67cb372998e45e1568dc832f85b6d6&newProject=comm-central&newRevision=17e3470d8d8d489e589b3c8a36c5e3b89a73068d&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1a7fafc84e67cb372998e45e1568dc832f85b6d6&newProject=comm-central&newRevision=17e3470d8d8d489e589b3c8a36c5e3b89a73068d&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28aceman%29&revcount=50">aceman</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1237602">1237602</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1220564">1220564</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1237602">Bug 1237602</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1220564">bug 1220564</a> - Remove legacy array/generator comprehension: mail. r=aceman</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderDisplay.js">mail/base/content/folderDisplay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderDisplay.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderDisplay.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderDisplay.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderDisplay.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderDisplay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderPane.js">mail/base/content/folderPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderPane.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderPane.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderPane.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderPane.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/folderPane.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/multimessageview.js">mail/base/content/multimessageview.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/multimessageview.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/multimessageview.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/multimessageview.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/multimessageview.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/base/content/multimessageview.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/accounts.js">mail/components/about-support/content/accounts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/accounts.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/accounts.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/accounts.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/accounts.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/accounts.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/extensions.js">mail/components/about-support/content/extensions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/extensions.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/extensions.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/extensions.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/extensions.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/extensions.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/prefs.js">mail/components/about-support/content/prefs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/prefs.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/prefs.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/prefs.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/prefs.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/about-support/content/prefs.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/MsgComposeCommands.js">mail/components/compose/content/MsgComposeCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/MsgComposeCommands.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/MsgComposeCommands.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/MsgComposeCommands.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/MsgComposeCommands.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/MsgComposeCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/addressingWidgetOverlay.js">mail/components/compose/content/addressingWidgetOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/addressingWidgetOverlay.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/addressingWidgetOverlay.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/addressingWidgetOverlay.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/addressingWidgetOverlay.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/compose/content/addressingWidgetOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/devtools/modules/XULRootActor.js">mail/components/devtools/modules/XULRootActor.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/devtools/modules/XULRootActor.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/devtools/modules/XULRootActor.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/devtools/modules/XULRootActor.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/devtools/modules/XULRootActor.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/devtools/modules/XULRootActor.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/test/unit/test_about_support.js">mail/components/test/unit/test_about_support.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/test/unit/test_about_support.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/test/unit/test_about_support.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/test/unit/test_about_support.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/test/unit/test_about_support.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/test/unit/test_about_support.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/wintaskbar/windowsJumpLists.js">mail/components/wintaskbar/windowsJumpLists.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/wintaskbar/windowsJumpLists.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/wintaskbar/windowsJumpLists.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/wintaskbar/windowsJumpLists.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/wintaskbar/windowsJumpLists.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/components/wintaskbar/windowsJumpLists.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/cloudfile/test-cloudfile-add-account-dialog.js">mail/test/mozmill/cloudfile/test-cloudfile-add-account-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/cloudfile/test-cloudfile-add-account-dialog.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/cloudfile/test-cloudfile-add-account-dialog.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/cloudfile/test-cloudfile-add-account-dialog.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/cloudfile/test-cloudfile-add-account-dialog.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/cloudfile/test-cloudfile-add-account-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/folder-display/test-pane-focus.js">mail/test/mozmill/folder-display/test-pane-focus.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/folder-display/test-pane-focus.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/folder-display/test-pane-focus.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/folder-display/test-pane-focus.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/folder-display/test-pane-focus.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/folder-display/test-pane-focus.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/newmailaccount/test-newmailaccount.js">mail/test/mozmill/newmailaccount/test-newmailaccount.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/newmailaccount/test-newmailaccount.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/newmailaccount/test-newmailaccount.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/newmailaccount/test-newmailaccount.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/newmailaccount/test-newmailaccount.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/newmailaccount/test-newmailaccount.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/pref-window/test-font-chooser.js">mail/test/mozmill/pref-window/test-font-chooser.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/pref-window/test-font-chooser.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/pref-window/test-font-chooser.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/pref-window/test-font-chooser.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/pref-window/test-font-chooser.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/pref-window/test-font-chooser.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">mail/test/mozmill/shared-modules/test-folder-display-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">file</a> |
<a href="/comm-central/annotate/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">annotate</a> |
<a href="/comm-central/diff/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">diff</a> |
<a href="/comm-central/comparison/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">comparison</a> |
<a href="/comm-central/log/30d7839cccbecc3103b8734eabfe94b8a1ecced8/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/folderDisplay.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/folderDisplay.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -239,19 +239,18 @@ FolderDisplayWidget.prototype = {</span>
<a href="#l1.4"></a><span id="l1.4">    * the single- and multi-message content windows. When changing focus to the</span>
<a href="#l1.5"></a><span id="l1.5">    * message pane, be sure to focus the appropriate content window in addition</span>
<a href="#l1.6"></a><span id="l1.6">    * to the messagepanebox (doing both is required in order to blur the</span>
<a href="#l1.7"></a><span id="l1.7">    * previously-focused chrome element).</span>
<a href="#l1.8"></a><span id="l1.8">    *</span>
<a href="#l1.9"></a><span id="l1.9">    * @return the focused pane</span>
<a href="#l1.10"></a><span id="l1.10">    */</span>
<a href="#l1.11"></a><span id="l1.11">   get focusedPane() {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    let panes = [document.getElementById(id) for (id of [</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-      &quot;threadTree&quot;, &quot;folderTree&quot;, &quot;messagepanebox&quot;</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-    ])];</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+    let panes = [&quot;threadTree&quot;, &quot;folderTree&quot;, &quot;messagepanebox&quot;].map(id =&gt;</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineplus">+        document.getElementById(id));</span>
<a href="#l1.17"></a><span id="l1.17"> </span>
<a href="#l1.18"></a><span id="l1.18">     let currentNode = top.document.activeElement;</span>
<a href="#l1.19"></a><span id="l1.19"> </span>
<a href="#l1.20"></a><span id="l1.20">     while (currentNode) {</span>
<a href="#l1.21"></a><span id="l1.21">       if (panes.includes(currentNode))</span>
<a href="#l1.22"></a><span id="l1.22">         return currentNode;</span>
<a href="#l1.23"></a><span id="l1.23"> </span>
<a href="#l1.24"></a><span id="l1.24">       currentNode = currentNode.parentNode;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/folderPane.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/folderPane.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1638,17 +1638,17 @@ var gFolderTreeView = {</span>
<a href="#l2.4"></a><span id="l2.4">           let bLabel = b.prettyName;</span>
<a href="#l2.5"></a><span id="l2.5">           if (aLabel == bLabel) {</span>
<a href="#l2.6"></a><span id="l2.6">             aLabel = a.server.prettyName;</span>
<a href="#l2.7"></a><span id="l2.7">             bLabel = b.server.prettyName;</span>
<a href="#l2.8"></a><span id="l2.8">           }</span>
<a href="#l2.9"></a><span id="l2.9">           return folderNameCompare(aLabel, bLabel);</span>
<a href="#l2.10"></a><span id="l2.10">         });</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        let items = [new ftvItem(f) for (f of recentFolders)];</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        let items = recentFolders.map(f =&gt; new ftvItem(f));</span>
<a href="#l2.14"></a><span id="l2.14"> </span>
<a href="#l2.15"></a><span id="l2.15">         // There are no children in this view!</span>
<a href="#l2.16"></a><span id="l2.16">         // And we want to display the account name to distinguish folders w/</span>
<a href="#l2.17"></a><span id="l2.17">         // the same name.</span>
<a href="#l2.18"></a><span id="l2.18">         for (let folder of items) {</span>
<a href="#l2.19"></a><span id="l2.19">           folder.__defineGetter__(&quot;children&quot;, () =&gt; []);</span>
<a href="#l2.20"></a><span id="l2.20">           folder.addServerName = true;</span>
<a href="#l2.21"></a><span id="l2.21">         }</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -2580,18 +2580,17 @@ var gFolderTreeController = {</span>
<a href="#l2.23"></a><span id="l2.23">       return;</span>
<a href="#l2.24"></a><span id="l2.24"> </span>
<a href="#l2.25"></a><span id="l2.25">     // Delete any subfolders this folder might have</span>
<a href="#l2.26"></a><span id="l2.26">     let iter = folder.subFolders;</span>
<a href="#l2.27"></a><span id="l2.27">     while (iter.hasMoreElements())</span>
<a href="#l2.28"></a><span id="l2.28">       folder.propagateDelete(iter.getNext(), true, msgWindow);</span>
<a href="#l2.29"></a><span id="l2.29"> </span>
<a href="#l2.30"></a><span id="l2.30">     // Now delete the messages</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-    iter = fixIterator(folder.messages);</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineminus">-    let messages = [m for (m in iter)];</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+    let messages = Array.from(fixIterator(folder.messages));</span>
<a href="#l2.34"></a><span id="l2.34">     let children = toXPCOMArray(messages, Ci.nsIMutableArray);</span>
<a href="#l2.35"></a><span id="l2.35">     folder.deleteMessages(children, msgWindow, true, false, null, false);</span>
<a href="#l2.36"></a><span id="l2.36">   },</span>
<a href="#l2.37"></a><span id="l2.37"> </span>
<a href="#l2.38"></a><span id="l2.38">   /**</span>
<a href="#l2.39"></a><span id="l2.39">    * Compacts either particular folder/s, or selected folders.</span>
<a href="#l2.40"></a><span id="l2.40">    *</span>
<a href="#l2.41"></a><span id="l2.41">    * @param aFolders (optional) the folders to compact, if different than the</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/base/content/multimessageview.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/base/content/multimessageview.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -500,17 +500,22 @@ ThreadSummarizer.prototype = {</span>
<a href="#l3.4"></a><span id="l3.4">    *</span>
<a href="#l3.5"></a><span id="l3.5">    * @param aMessages A LimitIterator of the messages to summarize.</span>
<a href="#l3.6"></a><span id="l3.6">    * @return An array of the messages actually summarized.</span>
<a href="#l3.7"></a><span id="l3.7">    */</span>
<a href="#l3.8"></a><span id="l3.8">   summarize: function(aMessages) {</span>
<a href="#l3.9"></a><span id="l3.9">     let messageList = document.getElementById(&quot;message_list&quot;);</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11">     // Remove all ignored messages from summarization.</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    let summarizedMessages = [msg for (msg of aMessages) if (!msg.isKilled)];</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+    let summarizedMessages = [];</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+    for (let message of aMessages) {</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+      if (!message.isKilled) {</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+        summarizedMessages.push(message);</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+      }</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+    }</span>
<a href="#l3.19"></a><span id="l3.19">     let ignoredCount = aMessages.trueLength - summarizedMessages.length;</span>
<a href="#l3.20"></a><span id="l3.20"> </span>
<a href="#l3.21"></a><span id="l3.21">     // Summarize the selected messages.</span>
<a href="#l3.22"></a><span id="l3.22">     let subject = null;</span>
<a href="#l3.23"></a><span id="l3.23">     let maxCountExceeded = false;</span>
<a href="#l3.24"></a><span id="l3.24">     for (let [i, msgHdr] in Iterator(summarizedMessages)) {</span>
<a href="#l3.25"></a><span id="l3.25">       if (i &gt; this.kMaxSummarizedMessages) {</span>
<a href="#l3.26"></a><span id="l3.26">         summarizedMessages.length = i;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/components/about-support/content/accounts.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/components/about-support/content/accounts.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -64,23 +64,23 @@ function populateAccountsSection() {</span>
<a href="#l4.4"></a><span id="l4.4"> </span>
<a href="#l4.5"></a><span id="l4.5">     return createElement(&quot;td&quot;, text, attributes, copyData);</span>
<a href="#l4.6"></a><span id="l4.6">   }</span>
<a href="#l4.7"></a><span id="l4.7"> </span>
<a href="#l4.8"></a><span id="l4.8">   for (let account of gAccountDetails) {</span>
<a href="#l4.9"></a><span id="l4.9">     // We want a minimum rowspan of 1</span>
<a href="#l4.10"></a><span id="l4.10">     let rowSpan = account.smtpServers.length || 1;</span>
<a href="#l4.11"></a><span id="l4.11">     // incomingTDs is an array of TDs</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-    let incomingTDs = [createTD(fn(account[prop]), rowSpan)</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-                       for ([prop, fn] of gIncomingDetails)];</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+    let incomingTDs = gIncomingDetails.map(([prop, fn]) =&gt;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+                        createTD(fn(account[prop]), rowSpan));</span>
<a href="#l4.16"></a><span id="l4.16">     // outgoingTDs is an array of arrays of TDs</span>
<a href="#l4.17"></a><span id="l4.17">     let outgoingTDs = [];</span>
<a href="#l4.18"></a><span id="l4.18">     for (let smtp of account.smtpServers) {</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineminus">-      outgoingTDs.push([createTD(fn(smtp[prop]), 1)</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineminus">-                       for ([prop, fn] of gOutgoingDetails)]);</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+      outgoingTDs.push(gOutgoingDetails.map(([prop, fn]) =&gt;</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+                        createTD(fn(smtp[prop]), 1)));</span>
<a href="#l4.23"></a><span id="l4.23">     }</span>
<a href="#l4.24"></a><span id="l4.24"> </span>
<a href="#l4.25"></a><span id="l4.25">     // If there are no SMTP servers, add a dummy element to make life easier below</span>
<a href="#l4.26"></a><span id="l4.26">     if (outgoingTDs.length == 0)</span>
<a href="#l4.27"></a><span id="l4.27">       outgoingTDs = [[]];</span>
<a href="#l4.28"></a><span id="l4.28"> </span>
<a href="#l4.29"></a><span id="l4.29">     // Add the first SMTP server to this tr.</span>
<a href="#l4.30"></a><span id="l4.30">     let tr = createParentElement(&quot;tr&quot;, incomingTDs.concat(outgoingTDs[0]));</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineat">@@ -107,25 +107,25 @@ function getAccountsText(aHidePrivateDat</span>
<a href="#l4.32"></a><span id="l4.32">     if (&quot;isPrivate&quot; in data &amp;&amp; (aHidePrivateData == data.isPrivate))</span>
<a href="#l4.33"></a><span id="l4.33">       return &quot;&quot;;</span>
<a href="#l4.34"></a><span id="l4.34">     return data.neutral;</span>
<a href="#l4.35"></a><span id="l4.35">   }</span>
<a href="#l4.36"></a><span id="l4.36"> </span>
<a href="#l4.37"></a><span id="l4.37">   for (let account of gAccountDetails) {</span>
<a href="#l4.38"></a><span id="l4.38">     accumulator.push(aIndent + account.key + &quot;:&quot;);</span>
<a href="#l4.39"></a><span id="l4.39">     // incomingData is an array of strings</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineminus">-    let incomingData = [neutralizer(fn(account[prop]))</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineminus">-                        for ([prop, fn] of gIncomingDetails)];</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+    let incomingData = gIncomingDetails.map(([prop, fn]) =&gt;</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+                        neutralizer(fn(account[prop])));</span>
<a href="#l4.44"></a><span id="l4.44">     accumulator.push(aIndent + &quot;  INCOMING: &quot; + incomingData.join(&quot;, &quot;));</span>
<a href="#l4.45"></a><span id="l4.45"> </span>
<a href="#l4.46"></a><span id="l4.46">     // outgoingData is an array of arrays of strings</span>
<a href="#l4.47"></a><span id="l4.47">     let outgoingData = [];</span>
<a href="#l4.48"></a><span id="l4.48">     for (let smtp of account.smtpServers) {</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineminus">-      outgoingData.push([neutralizer(fn(smtp[prop]))</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineminus">-                        for ([prop, fn] of gOutgoingDetails)]);</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+      outgoingData.push(gOutgoingDetails.map(([prop, fn]) =&gt;</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineplus">+                        neutralizer(fn(smtp[prop]))));</span>
<a href="#l4.53"></a><span id="l4.53">     }</span>
<a href="#l4.54"></a><span id="l4.54"> </span>
<a href="#l4.55"></a><span id="l4.55">     for (let data of outgoingData)</span>
<a href="#l4.56"></a><span id="l4.56">       accumulator.push(aIndent + &quot;  OUTGOING: &quot; + data.join(&quot;, &quot;));</span>
<a href="#l4.57"></a><span id="l4.57"> </span>
<a href="#l4.58"></a><span id="l4.58">     accumulator.push(&quot;&quot;);</span>
<a href="#l4.59"></a><span id="l4.59">   }</span>
<a href="#l4.60"></a><span id="l4.60"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/components/about-support/content/extensions.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/components/about-support/content/extensions.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -26,29 +26,28 @@ function populateExtensionsSection() {</span>
<a href="#l5.4"></a><span id="l5.4">         return a.version &gt; b.version ? 1 : -1;</span>
<a href="#l5.5"></a><span id="l5.5">       return 0;</span>
<a href="#l5.6"></a><span id="l5.6">     });</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8">     gExtensions = extensions;</span>
<a href="#l5.9"></a><span id="l5.9">     let trExtensions = [];</span>
<a href="#l5.10"></a><span id="l5.10">     for (let i = 0; i &lt; extensions.length; i++) {</span>
<a href="#l5.11"></a><span id="l5.11">       let extension = extensions[i];</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-      let extensionTDs = [createElement(&quot;td&quot;, extension[prop])</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-                          for (prop of gExtensionDetails)];</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+      let extensionTDs = gExtensionDetails.map(prop =&gt;</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+                          createElement(&quot;td&quot;, extension[prop]));</span>
<a href="#l5.16"></a><span id="l5.16">       let tr = createParentElement(&quot;tr&quot;, extensionTDs);</span>
<a href="#l5.17"></a><span id="l5.17">       trExtensions.push(tr);</span>
<a href="#l5.18"></a><span id="l5.18">     }</span>
<a href="#l5.19"></a><span id="l5.19">     appendChildren(document.getElementById(&quot;extensions-tbody&quot;), trExtensions);</span>
<a href="#l5.20"></a><span id="l5.20">   });</span>
<a href="#l5.21"></a><span id="l5.21"> }</span>
<a href="#l5.22"></a><span id="l5.22"> </span>
<a href="#l5.23"></a><span id="l5.23"> /**</span>
<a href="#l5.24"></a><span id="l5.24">  * Returns a plaintext representation of extension data.</span>
<a href="#l5.25"></a><span id="l5.25">  */</span>
<a href="#l5.26"></a><span id="l5.26"> function getExtensionsText(aHidePrivateData, aIndent) {</span>
<a href="#l5.27"></a><span id="l5.27">   let extensionData = [];</span>
<a href="#l5.28"></a><span id="l5.28">   for (let extension of gExtensions) {</span>
<a href="#l5.29"></a><span id="l5.29">     extensionData.push(aIndent +</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineminus">-                       [extension[prop]</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-                        for (prop of gExtensionDetails)].join(&quot;, &quot;));</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+                       gExtensionDetails.map(prop =&gt; extension[prop]).join(&quot;, &quot;));</span>
<a href="#l5.33"></a><span id="l5.33">   }</span>
<a href="#l5.34"></a><span id="l5.34">   return extensionData.join(&quot;\n&quot;);</span>
<a href="#l5.35"></a><span id="l5.35"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/components/about-support/content/prefs.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/components/about-support/content/prefs.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -106,20 +106,20 @@ function formatPrefValue(prefValue) {</span>
<a href="#l6.4"></a><span id="l6.4"> }</span>
<a href="#l6.5"></a><span id="l6.5"> </span>
<a href="#l6.6"></a><span id="l6.6"> function getModifiedPrefs() {</span>
<a href="#l6.7"></a><span id="l6.7">   // We use the low-level prefs API to identify prefs that have been</span>
<a href="#l6.8"></a><span id="l6.8">   // modified, rather that Application.prefs.all since the latter is</span>
<a href="#l6.9"></a><span id="l6.9">   // much, much slower.  Application.prefs.all also gets slower each</span>
<a href="#l6.10"></a><span id="l6.10">   // time it's called.  See bug 517312.</span>
<a href="#l6.11"></a><span id="l6.11">   let prefNames = getWhitelistedPrefNames();</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-  let prefs = [Application.prefs.get(prefName)</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-                      for (prefName of prefNames)</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-                          if (Services.prefs.prefHasUserValue(prefName)</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-                            &amp;&amp; !isBlacklisted(prefName))];</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+  let prefs = prefNames.filter(prefName =&gt;</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+                               Services.prefs.prefHasUserValue(prefName)</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+                               &amp;&amp; !isBlacklisted(prefName))</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+                       .map(prefName =&gt; Application.prefs.get(prefName));</span>
<a href="#l6.20"></a><span id="l6.20">   return prefs;</span>
<a href="#l6.21"></a><span id="l6.21"> }</span>
<a href="#l6.22"></a><span id="l6.22"> </span>
<a href="#l6.23"></a><span id="l6.23"> function getWhitelistedPrefNames() {</span>
<a href="#l6.24"></a><span id="l6.24">   let results = [];</span>
<a href="#l6.25"></a><span id="l6.25">   PREFS_WHITELIST.forEach(function (prefStem) {</span>
<a href="#l6.26"></a><span id="l6.26">     let prefNames = Services.prefs.getChildList(prefStem, {});</span>
<a href="#l6.27"></a><span id="l6.27">     results = results.concat(prefNames);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1410,18 +1410,18 @@ function attachToCloud(aProvider)</span>
<a href="#l7.4"></a><span id="l7.4">   let files = [];</span>
<a href="#l7.5"></a><span id="l7.5"> </span>
<a href="#l7.6"></a><span id="l7.6">   fp.appendFilters(nsIFilePicker.filterAll);</span>
<a href="#l7.7"></a><span id="l7.7">   if (fp.show() == nsIFilePicker.returnOK)</span>
<a href="#l7.8"></a><span id="l7.8">   {</span>
<a href="#l7.9"></a><span id="l7.9">     if (!fp.files)</span>
<a href="#l7.10"></a><span id="l7.10">       return;</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-    let files = [f for (f in fixIterator(fp.files,</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-                                         Components.interfaces.nsILocalFile))];</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+    let files = Array.from(fixIterator(fp.files,</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+                             Components.interfaces.nsILocalFile))</span>
<a href="#l7.16"></a><span id="l7.16">     let attachments = files.map(f =&gt; FileToAttachment(f));</span>
<a href="#l7.17"></a><span id="l7.17"> </span>
<a href="#l7.18"></a><span id="l7.18">     let i = 0;</span>
<a href="#l7.19"></a><span id="l7.19">     let items = AddAttachments(attachments, function(aItem) {</span>
<a href="#l7.20"></a><span id="l7.20">       let listener = new uploadListener(attachments[i], files[i], aProvider);</span>
<a href="#l7.21"></a><span id="l7.21">       try {</span>
<a href="#l7.22"></a><span id="l7.22">         aProvider.uploadFile(files[i], listener);</span>
<a href="#l7.23"></a><span id="l7.23">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/components/compose/content/addressingWidgetOverlay.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/components/compose/content/addressingWidgetOverlay.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -145,21 +145,20 @@ function Recipients2CompFields(msgCompFi</span>
<a href="#l8.4"></a><span id="l8.4">         switch (recipientType)</span>
<a href="#l8.5"></a><span id="l8.5">         {</span>
<a href="#l8.6"></a><span id="l8.6">           case &quot;addr_to&quot;    :</span>
<a href="#l8.7"></a><span id="l8.7">           case &quot;addr_cc&quot;    :</span>
<a href="#l8.8"></a><span id="l8.8">           case &quot;addr_bcc&quot;   :</span>
<a href="#l8.9"></a><span id="l8.9">           case &quot;addr_reply&quot; :</span>
<a href="#l8.10"></a><span id="l8.10">             try {</span>
<a href="#l8.11"></a><span id="l8.11">               let headerParser = MailServices.headerParser;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-              recipient = [headerParser.makeMimeAddress(fullValue.name,</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-                                                        fullValue.email) for</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-                  (fullValue of</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-                    headerParser.makeFromDisplayAddress(fieldValue, {}))]</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineminus">-                .join(&quot;, &quot;);</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+              recipient =</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+                headerParser.makeFromDisplayAddress(fieldValue, {}).map(fullValue =&gt;</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+                  headerParser.makeMimeAddress(fullValue.name, fullValue.email)</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+              ).join(&quot;, &quot;);</span>
<a href="#l8.21"></a><span id="l8.21">             } catch (ex) {recipient = fieldValue;}</span>
<a href="#l8.22"></a><span id="l8.22">             break;</span>
<a href="#l8.23"></a><span id="l8.23">         }</span>
<a href="#l8.24"></a><span id="l8.24"> </span>
<a href="#l8.25"></a><span id="l8.25">         switch (recipientType)</span>
<a href="#l8.26"></a><span id="l8.26">         {</span>
<a href="#l8.27"></a><span id="l8.27">           case &quot;addr_to&quot;          : addrTo += to_Sep + recipient; to_Sep = &quot;,&quot;;               break;</span>
<a href="#l8.28"></a><span id="l8.28">           case &quot;addr_cc&quot;          : addrCc += cc_Sep + recipient; cc_Sep = &quot;,&quot;;               break;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/components/devtools/modules/XULRootActor.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/components/devtools/modules/XULRootActor.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -167,17 +167,17 @@ XulTabList.prototype = {</span>
<a href="#l9.4"></a><span id="l9.4">               bo.width &gt; 0;</span>
<a href="#l9.5"></a><span id="l9.5">         }</span>
<a href="#l9.6"></a><span id="l9.6">       }</span>
<a href="#l9.7"></a><span id="l9.7">     }</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9">     this._mustNotify = true;</span>
<a href="#l9.10"></a><span id="l9.10">     this._checkListening();</span>
<a href="#l9.11"></a><span id="l9.11"> </span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    return Promise.resolve([actor for ([_, actor] of this._actorByBrowser)]);</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    return Promise.resolve(this._actorByBrowser.forEach(([_, actor]) =&gt; actor));</span>
<a href="#l9.14"></a><span id="l9.14">   },</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16">   onOpenWindow: DevToolsUtils.makeInfallible(function(aWindow) {</span>
<a href="#l9.17"></a><span id="l9.17">     let handleLoad = DevToolsUtils.makeInfallible(() =&gt; {</span>
<a href="#l9.18"></a><span id="l9.18">       aWindow.removeEventListener(&quot;load&quot;, handleLoad, false);</span>
<a href="#l9.19"></a><span id="l9.19"> </span>
<a href="#l9.20"></a><span id="l9.20">       if (this._checkedWindows.has(appShellDOMWindowType(aWindow))) {</span>
<a href="#l9.21"></a><span id="l9.21">         // This is one of our windows, we need to check for browser</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/components/test/unit/test_about_support.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/components/test/unit/test_about_support.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -106,18 +106,18 @@ function verify_account_details(aDetails</span>
<a href="#l10.4"></a><span id="l10.4">   let expectedDetails = gAccountMap[aDetails.key];</span>
<a href="#l10.5"></a><span id="l10.5">   // All our servers are at localhost</span>
<a href="#l10.6"></a><span id="l10.6">   let expectedHostDetails = &quot;(&quot; + expectedDetails.type + &quot;) localhost:&quot; +</span>
<a href="#l10.7"></a><span id="l10.7">     expectedDetails.port;</span>
<a href="#l10.8"></a><span id="l10.8">   do_check_eq(aDetails.hostDetails, expectedHostDetails);</span>
<a href="#l10.9"></a><span id="l10.9">   do_check_eq(aDetails.socketType, expectedDetails.socketType);</span>
<a href="#l10.10"></a><span id="l10.10">   do_check_eq(aDetails.authMethod, expectedDetails.authMethod);</span>
<a href="#l10.11"></a><span id="l10.11"> </span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-  let smtpToSee = [(&quot;localhost:&quot; + smtpDetails.port)</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-                   for ([, smtpDetails] in Iterator(expectedDetails.smtpServers))];</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+  let smtpToSee = expectedDetails.smtpServers.map(smtpDetails =&gt;</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+                    &quot;localhost:&quot; + smtpDetails.port);</span>
<a href="#l10.16"></a><span id="l10.16"> </span>
<a href="#l10.17"></a><span id="l10.17">   for (let [, smtpDetails] in Iterator(aDetails.smtpServers)) {</span>
<a href="#l10.18"></a><span id="l10.18">     // Check that we're expecting to see this server</span>
<a href="#l10.19"></a><span id="l10.19">     let toSeeIndex = smtpToSee.indexOf(smtpDetails.name);</span>
<a href="#l10.20"></a><span id="l10.20">     do_check_neq(toSeeIndex, -1);</span>
<a href="#l10.21"></a><span id="l10.21">     smtpToSee.splice(toSeeIndex, 1);</span>
<a href="#l10.22"></a><span id="l10.22"> </span>
<a href="#l10.23"></a><span id="l10.23">     let expectedSMTPDetails = gSMTPMap[smtpDetails.name];</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineat">@@ -148,17 +148,17 @@ function test_get_file_system_type() {</span>
<a href="#l10.25"></a><span id="l10.25"> </span>
<a href="#l10.26"></a><span id="l10.26"> /**</span>
<a href="#l10.27"></a><span id="l10.27">  * Test the getAccountDetails function.</span>
<a href="#l10.28"></a><span id="l10.28">  */</span>
<a href="#l10.29"></a><span id="l10.29"> function test_get_account_details() {</span>
<a href="#l10.30"></a><span id="l10.30">   let accountDetails = AboutSupport.getAccountDetails();</span>
<a href="#l10.31"></a><span id="l10.31">   let accountDetailsText = uneval(accountDetails);</span>
<a href="#l10.32"></a><span id="l10.32">   // The list of accounts we are looking for</span>
<a href="#l10.33"></a><span id="l10.33" class="difflineminus">-  let accountsToSee = [key for (key in Iterator(gAccountMap, true))];</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineplus">+  let accountsToSee = Object.keys(gAccountMap);</span>
<a href="#l10.35"></a><span id="l10.35"> </span>
<a href="#l10.36"></a><span id="l10.36">   // Our first check is to see that no sensitive data has crept in</span>
<a href="#l10.37"></a><span id="l10.37">   for (let [, data] in Iterator(gSensitiveData))</span>
<a href="#l10.38"></a><span id="l10.38">     do_check_false(accountDetailsText.includes(data));</span>
<a href="#l10.39"></a><span id="l10.39"> </span>
<a href="#l10.40"></a><span id="l10.40">   for (let [, details] in Iterator(accountDetails)) {</span>
<a href="#l10.41"></a><span id="l10.41">     // We're going to make one exception: for the local folders server. We don't</span>
<a href="#l10.42"></a><span id="l10.42">     // care too much about its details.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/components/wintaskbar/windowsJumpLists.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/components/wintaskbar/windowsJumpLists.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -151,18 +151,18 @@ var WinTaskbarJumpList = {</span>
<a href="#l11.4"></a><span id="l11.4">   _commitBuild: function WTBJL__commitBuild() {</span>
<a href="#l11.5"></a><span id="l11.5">     if (!this._builder.commitListBuild()) {</span>
<a href="#l11.6"></a><span id="l11.6">       this._builder.abortListBuild();</span>
<a href="#l11.7"></a><span id="l11.7">     }</span>
<a href="#l11.8"></a><span id="l11.8">   },</span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10">   _buildTasks: function WTBJL__buildTasks() {</span>
<a href="#l11.11"></a><span id="l11.11">     if (this._tasks.length &gt; 0) {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-      let items = toXPCOMArray([this._createHandlerAppItem(task)</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-                                for ([, task] in Iterator(this._tasks))],</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+      let items = toXPCOMArray(this._tasks.map(task =&gt;</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+                                 this._createHandlerAppItem(task)),</span>
<a href="#l11.16"></a><span id="l11.16">                                Ci.nsIMutableArray);</span>
<a href="#l11.17"></a><span id="l11.17">       this._builder.addListToBuild(this._builder.JUMPLIST_CATEGORY_TASKS, items);</span>
<a href="#l11.18"></a><span id="l11.18">     }</span>
<a href="#l11.19"></a><span id="l11.19">   },</span>
<a href="#l11.20"></a><span id="l11.20"> </span>
<a href="#l11.21"></a><span id="l11.21">   _deleteActiveJumpList: function WTBJL__deleteAJL() {</span>
<a href="#l11.22"></a><span id="l11.22">     this._builder.deleteActiveList();</span>
<a href="#l11.23"></a><span id="l11.23">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/test/mozmill/cloudfile/test-cloudfile-add-account-dialog.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/test/mozmill/cloudfile/test-cloudfile-add-account-dialog.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -60,18 +60,17 @@ function teardownModule(module) {</span>
<a href="#l12.4"></a><span id="l12.4"> </span>
<a href="#l12.5"></a><span id="l12.5"> /**</span>
<a href="#l12.6"></a><span id="l12.6">  * Helper function that ensures that we know the number of registered</span>
<a href="#l12.7"></a><span id="l12.7">  * Filelink service providers.</span>
<a href="#l12.8"></a><span id="l12.8">  *</span>
<a href="#l12.9"></a><span id="l12.9">  * @param aNum the number of expected registered Filelink service providers.</span>
<a href="#l12.10"></a><span id="l12.10">  */</span>
<a href="#l12.11"></a><span id="l12.11"> function assert_num_providers(aNum) {</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  let providers = [provider for</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-                   (provider in cloudFileAccounts.enumerateProviders())];</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+  let providers = Array.from(cloudFileAccounts.enumerateProviders());</span>
<a href="#l12.15"></a><span id="l12.15">   assert_equals(aNum, providers.length,</span>
<a href="#l12.16"></a><span id="l12.16">                 'Expected ' + aNum + ' providers to be available, but ' +</span>
<a href="#l12.17"></a><span id="l12.17">                 'found ' + providers.length + ' instead.');</span>
<a href="#l12.18"></a><span id="l12.18"> }</span>
<a href="#l12.19"></a><span id="l12.19"> </span>
<a href="#l12.20"></a><span id="l12.20"> /**</span>
<a href="#l12.21"></a><span id="l12.21">  * Helper function that takes a controller for an 'Add an Account' dialog, and</span>
<a href="#l12.22"></a><span id="l12.22">  * returns the 'Set up Account' button.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-pane-focus.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-pane-focus.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -29,19 +29,19 @@ function setupModule(module) {</span>
<a href="#l13.4"></a><span id="l13.4"> </span>
<a href="#l13.5"></a><span id="l13.5"> /**</span>
<a href="#l13.6"></a><span id="l13.6">  * Get the currently-focused pane in the 3pane. One of the folder pane, thread</span>
<a href="#l13.7"></a><span id="l13.7">  * pane, or message pane (single- or multi-message).</span>
<a href="#l13.8"></a><span id="l13.8">  *</span>
<a href="#l13.9"></a><span id="l13.9">  * @return the focused pane</span>
<a href="#l13.10"></a><span id="l13.10">  */</span>
<a href="#l13.11"></a><span id="l13.11"> function get_focused_pane() {</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-  let panes = [mc.e(id) for (id of [</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+  let panes = [</span>
<a href="#l13.14"></a><span id="l13.14">     &quot;threadTree&quot;, &quot;folderTree&quot;, &quot;messagepane&quot;, &quot;multimessage&quot;</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineminus">-  ])];</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineplus">+  ].map(id =&gt; mc.e(id));</span>
<a href="#l13.17"></a><span id="l13.17"> </span>
<a href="#l13.18"></a><span id="l13.18">   let currentNode = mc.window.top.document.activeElement;</span>
<a href="#l13.19"></a><span id="l13.19"> </span>
<a href="#l13.20"></a><span id="l13.20">   while (currentNode) {</span>
<a href="#l13.21"></a><span id="l13.21">     if (panes.includes(currentNode))</span>
<a href="#l13.22"></a><span id="l13.22">       return currentNode;</span>
<a href="#l13.23"></a><span id="l13.23"> </span>
<a href="#l13.24"></a><span id="l13.24">     currentNode = currentNode.parentNode;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mail/test/mozmill/newmailaccount/test-newmailaccount.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mail/test/mozmill/newmailaccount/test-newmailaccount.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -83,17 +83,17 @@ function teardownModule(module) {</span>
<a href="#l14.4"></a><span id="l14.4">   // And same with the user languages</span>
<a href="#l14.5"></a><span id="l14.5">   Services.prefs.setCharPref(kAcceptedLanguage, gOldAcceptLangs);</span>
<a href="#l14.6"></a><span id="l14.6"> }</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8"> /* Helper function that returns the number of accounts associated with the</span>
<a href="#l14.9"></a><span id="l14.9">  * current profile.</span>
<a href="#l14.10"></a><span id="l14.10">  */</span>
<a href="#l14.11"></a><span id="l14.11"> function nAccounts() {</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  return [x for (x in fixIterator(MailServices.accounts.accounts))].length;</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+  return MailServices.accounts.accounts.length;</span>
<a href="#l14.14"></a><span id="l14.14"> }</span>
<a href="#l14.15"></a><span id="l14.15"> </span>
<a href="#l14.16"></a><span id="l14.16"> /**</span>
<a href="#l14.17"></a><span id="l14.17">  * This tests the basic workflow for Account Provisioner - it spawns the</span>
<a href="#l14.18"></a><span id="l14.18">  * Provisioner window, fills in the search input, gets the results, clicks</span>
<a href="#l14.19"></a><span id="l14.19">  * on an address, completes a dummy form in a new tab for getting the account,</span>
<a href="#l14.20"></a><span id="l14.20">  * and then sets the provider as the default search engine.</span>
<a href="#l14.21"></a><span id="l14.21">  *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mail/test/mozmill/pref-window/test-font-chooser.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mail/test/mozmill/pref-window/test-font-chooser.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -112,18 +112,18 @@ function test_font_name_displayed() {</span>
<a href="#l15.4"></a><span id="l15.4">     // substituted with Courier New) by getting the standard (substituted) family</span>
<a href="#l15.5"></a><span id="l15.5">     // name for each font.</span>
<a href="#l15.6"></a><span id="l15.6">     let standardFamily = gFontEnumerator.getStandardFamilyName(fontList[0]);</span>
<a href="#l15.7"></a><span id="l15.7">     Services.prefs.setCharPref(&quot;font.name.&quot; + fontType + &quot;.&quot; + kLanguage,</span>
<a href="#l15.8"></a><span id="l15.8">                                standardFamily);</span>
<a href="#l15.9"></a><span id="l15.9">     expected[fontType] = standardFamily;</span>
<a href="#l15.10"></a><span id="l15.10">   }</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-  _verify_fonts_displayed.apply(null, [expected[k]</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-                                       for ([, k] in Iterator(kFontTypes))]);</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+  let fontTypes = kFontTypes.map(fontType =&gt; expected[fontType]);</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+  _verify_fonts_displayed.apply(null, fontTypes);</span>
<a href="#l15.16"></a><span id="l15.16"> }</span>
<a href="#l15.17"></a><span id="l15.17"> </span>
<a href="#l15.18"></a><span id="l15.18"> // Fonts definitely not present on a computer -- we simply use UUIDs. These</span>
<a href="#l15.19"></a><span id="l15.19"> // should be kept in sync with the ones in *-prefs.js.</span>
<a href="#l15.20"></a><span id="l15.20"> var kFakeFonts = {</span>
<a href="#l15.21"></a><span id="l15.21">   &quot;serif&quot;: &quot;bc7e8c62-0634-467f-a029-fe6abcdf1582&quot;,</span>
<a href="#l15.22"></a><span id="l15.22">   &quot;sans-serif&quot;: &quot;419129aa-43b7-40c4-b554-83d99b504b89&quot;,</span>
<a href="#l15.23"></a><span id="l15.23">   &quot;monospace&quot;: &quot;348df6e5-e874-4d21-ad4b-359b530a33b7&quot;,</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineat">@@ -140,17 +140,17 @@ function test_font_name_not_present() {</span>
<a href="#l15.25"></a><span id="l15.25">   // The fonts we're expecting to see selected in the font chooser for</span>
<a href="#l15.26"></a><span id="l15.26">   // test_font_name_not_present.</span>
<a href="#l15.27"></a><span id="l15.27">   let expected = {};</span>
<a href="#l15.28"></a><span id="l15.28">   for (let [fontType, fakeFont] in Iterator(kFakeFonts)) {</span>
<a href="#l15.29"></a><span id="l15.29">     // Look at the font.name-list. We need to verify that the first font is the</span>
<a href="#l15.30"></a><span id="l15.30">     // fake one, and that the second one is present on the user's computer.</span>
<a href="#l15.31"></a><span id="l15.31">     let listPref = &quot;font.name-list.&quot; + fontType + &quot;.&quot; + kLanguage;</span>
<a href="#l15.32"></a><span id="l15.32">     let fontList = Services.prefs.getCharPref(listPref);</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineminus">-    let fonts = [s.trim() for ([, s] in Iterator(fontList.split(&quot;,&quot;)))];</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineplus">+    let fonts = fontList.split(&quot;,&quot;).map(font =&gt; font.trim());</span>
<a href="#l15.35"></a><span id="l15.35">     if (fonts.length != 2)</span>
<a href="#l15.36"></a><span id="l15.36">       throw new Error(listPref + &quot; should have exactly two fonts, but it is &quot; +</span>
<a href="#l15.37"></a><span id="l15.37">                       fontList + &quot;.&quot;);</span>
<a href="#l15.38"></a><span id="l15.38"> </span>
<a href="#l15.39"></a><span id="l15.39">     if (fonts[0] != fakeFont)</span>
<a href="#l15.40"></a><span id="l15.40">       throw new Error(&quot;The first font in &quot; + listPref + &quot; should be &quot; + fakeFont +</span>
<a href="#l15.41"></a><span id="l15.41">                       &quot;, but is actually &quot; + fonts[0] + &quot;.&quot;);</span>
<a href="#l15.42"></a><span id="l15.42"> </span>
<a href="#l15.43"></a><span id="l15.43" class="difflineat">@@ -159,11 +159,11 @@ function test_font_name_not_present() {</span>
<a href="#l15.44"></a><span id="l15.44">                       &quot;) should be present on this computer, but isn't.&quot;);</span>
<a href="#l15.45"></a><span id="l15.45">     expected[fontType] = fonts[1];</span>
<a href="#l15.46"></a><span id="l15.46"> </span>
<a href="#l15.47"></a><span id="l15.47">     // Set font.name to be the fake font. font.name-list is handled by</span>
<a href="#l15.48"></a><span id="l15.48">     // wrapper.py.</span>
<a href="#l15.49"></a><span id="l15.49">     Services.prefs.setCharPref(&quot;font.name.&quot; + fontType + &quot;.&quot; + kLanguage, fakeFont);</span>
<a href="#l15.50"></a><span id="l15.50">   }</span>
<a href="#l15.51"></a><span id="l15.51"> </span>
<a href="#l15.52"></a><span id="l15.52" class="difflineminus">-  _verify_fonts_displayed.apply(null, [expected[k]</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineminus">-                                       for ([, k] in Iterator(kFontTypes))]);</span>
<a href="#l15.54"></a><span id="l15.54" class="difflineplus">+  let fontTypes = kFontTypes.map(fontType =&gt; expected[fontType]);</span>
<a href="#l15.55"></a><span id="l15.55" class="difflineplus">+  _verify_fonts_displayed.apply(null, fontTypes);</span>
<a href="#l15.56"></a><span id="l15.56"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-folder-display-helpers.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-folder-display-helpers.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -2086,18 +2086,18 @@ function archive_messages(aMsgHdrs) {</span>
<a href="#l16.4"></a><span id="l16.4">  * @param aSelectedMessages An array of nsIMsgDBHdrs for the selected messages.</span>
<a href="#l16.5"></a><span id="l16.5">  * @return true is aSelectedMessages and aSummarizedKeys refer to the same set</span>
<a href="#l16.6"></a><span id="l16.6">  *     of messages.</span>
<a href="#l16.7"></a><span id="l16.7">  */</span>
<a href="#l16.8"></a><span id="l16.8"> function _verify_summarized_message_set(aSummarizedKeys, aSelectedMessages) {</span>
<a href="#l16.9"></a><span id="l16.9">   let summarizedKeys = aSummarizedKeys.slice();</span>
<a href="#l16.10"></a><span id="l16.10">   summarizedKeys.sort();</span>
<a href="#l16.11"></a><span id="l16.11">   // We use the same key-generation as in multimessageview.js.</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-  let selectedKeys = [msgHdr.messageKey + msgHdr.folder.URI</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-                      for (msgHdr of aSelectedMessages)];</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+  let selectedKeys = aSelectedMessages.map(msgHdr =&gt;</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+                      msgHdr.messageKey + msgHdr.folder.URI);</span>
<a href="#l16.16"></a><span id="l16.16">   selectedKeys.sort();</span>
<a href="#l16.17"></a><span id="l16.17"> </span>
<a href="#l16.18"></a><span id="l16.18">   // Stringified versions should now be equal...</span>
<a href="#l16.19"></a><span id="l16.19">   return selectedKeys.toString() == summarizedKeys.toString();</span>
<a href="#l16.20"></a><span id="l16.20"> }</span>
<a href="#l16.21"></a><span id="l16.21"> </span>
<a href="#l16.22"></a><span id="l16.22"> /**</span>
<a href="#l16.23"></a><span id="l16.23">  * Asserts that the messages the controller's folder display widget thinks are</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

