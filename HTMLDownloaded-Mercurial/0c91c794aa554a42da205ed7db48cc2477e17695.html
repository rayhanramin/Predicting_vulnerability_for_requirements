<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 1830:0c91c794aa554a42da205ed7db48cc2477e17695</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 0c91c794aa554a42da205ed7db48cc2477e17695" />
<meta property="og:url" content="/comm-central/rev/0c91c794aa554a42da205ed7db48cc2477e17695" />
<meta property="og:description" content="First part of Bug 257942 - Interactive status bar and activity history manager. This is the backend, UI and mac theme menu option hidden until we have complete themes and users of activity manager. Patch by David Ascher and Emre Birol. r=Standard8" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 0c91c794aa554a42da205ed7db48cc2477e17695 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/0c91c794aa554a42da205ed7db48cc2477e17695">shortlog</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/0c91c794aa554a42da205ed7db48cc2477e17695">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695">files</a> |
changeset |
<a href="/comm-central/raw-rev/0c91c794aa554a42da205ed7db48cc2477e17695">raw</a>  | <a href="/comm-central/archive/0c91c794aa554a42da205ed7db48cc2477e17695.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
First part of <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=257942">Bug 257942</a> - Interactive status bar and activity history manager. This is the backend, UI and mac theme menu option hidden until we have complete themes and users of activity manager. Patch by David Ascher and Emre Birol. r=Standard8
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#68;&#97;&#118;&#105;&#100;&#32;&#65;&#115;&#99;&#104;&#101;&#114;&#32;&#60;&#100;&#97;&#118;&#105;&#100;&#46;&#97;&#115;&#99;&#104;&#101;&#114;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Mon, 02 Feb 2009 09:31:29 +0000</td></tr>

<tr>
 <td>changeset 1830</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/0c91c794aa554a42da205ed7db48cc2477e17695">0c91c794aa554a42da205ed7db48cc2477e17695</a></td>
</tr>



<tr>
<td>parent 1829</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/5991a745da3bc8e78e763177eb012d5ed9190db5">5991a745da3bc8e78e763177eb012d5ed9190db5</a>
</td>
</tr>

<tr>
<td>child 1831</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/f542811f5f33dd80359d4582462bd499ccb1e3af">f542811f5f33dd80359d4582462bd499ccb1e3af</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=0c91c794aa554a42da205ed7db48cc2477e17695">1472</a></td></tr>
<tr><td>push user</td><td>bugzilla@standard8.plus.com</td></tr>
<tr><td>push date</td><td class="date age">Mon, 02 Feb 2009 09:34:40 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@0c91c794aa55 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=0c91c794aa554a42da205ed7db48cc2477e17695">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=0c91c794aa554a42da205ed7db48cc2477e17695&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=0c91c794aa554a42da205ed7db48cc2477e17695&newProject=comm-central&newRevision=5991a745da3bc8e78e763177eb012d5ed9190db5&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=0c91c794aa554a42da205ed7db48cc2477e17695&newProject=comm-central&newRevision=5991a745da3bc8e78e763177eb012d5ed9190db5&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=0c91c794aa554a42da205ed7db48cc2477e17695&newProject=comm-central&newRevision=5991a745da3bc8e78e763177eb012d5ed9190db5&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Standard8%29&revcount=50">Standard8</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=257942">257942</a></td></tr>




</table></div>

<div class="page_body description">First part of <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=257942">Bug 257942</a> - Interactive status bar and activity history manager. This is the backend, UI and mac theme menu option hidden until we have complete themes and users of activity manager. Patch by David Ascher and Emre Birol. r=Standard8</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailCore.js">mail/base/content/mailCore.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailCore.js">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailCore.js">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailCore.js">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailCore.js">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailCore.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailWindowOverlay.xul">mail/base/content/mailWindowOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailWindowOverlay.xul">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailWindowOverlay.xul">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailWindowOverlay.xul">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailWindowOverlay.xul">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/base/content/mailWindowOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/Makefile.in">mail/components/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/Makefile.in">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/Makefile.in">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/Makefile.in">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/Makefile.in">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/Makefile.in">mail/components/activity/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/Makefile.in">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/Makefile.in">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/Makefile.in">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/Makefile.in">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.js">mail/components/activity/content/activity.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.js">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.js">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.js">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.js">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xml">mail/components/activity/content/activity.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xml">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xml">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xml">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xml">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xul">mail/components/activity/content/activity.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xul">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xul">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xul">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xul">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activity.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activityBinding.css">mail/components/activity/content/activityBinding.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activityBinding.css">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activityBinding.css">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activityBinding.css">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activityBinding.css">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/content/activityBinding.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/jar.mn">mail/components/activity/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/jar.mn">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/jar.mn">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/jar.mn">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/jar.mn">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivity.js">mail/components/activity/nsActivity.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivity.js">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivity.js">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivity.js">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivity.js">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivity.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManager.js">mail/components/activity/nsActivityManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManager.js">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManager.js">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManager.js">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManager.js">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManagerUI.js">mail/components/activity/nsActivityManagerUI.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManagerUI.js">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManagerUI.js">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManagerUI.js">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManagerUI.js">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsActivityManagerUI.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivity.idl">mail/components/activity/nsIActivity.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivity.idl">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivity.idl">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivity.idl">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivity.idl">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivity.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManager.idl">mail/components/activity/nsIActivityManager.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManager.idl">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManager.idl">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManager.idl">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManager.idl">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManager.idl">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManagerUI.idl">mail/components/activity/nsIActivityManagerUI.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManagerUI.idl">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManagerUI.idl">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManagerUI.idl">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManagerUI.idl">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/components/activity/nsIActivityManagerUI.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.dtd">mail/locales/en-US/chrome/messenger/activity.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.dtd">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.dtd">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.dtd">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.dtd">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.properties">mail/locales/en-US/chrome/messenger/activity.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.properties">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.properties">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.properties">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.properties">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/activity.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/messenger.dtd">mail/locales/en-US/chrome/messenger/messenger.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/messenger.dtd">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/messenger.dtd">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/messenger.dtd">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/messenger.dtd">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/en-US/chrome/messenger/messenger.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/jar.mn">mail/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/locales/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/jar.mn">mail/themes/pinstripe/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/jar.mn">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/jar.mn">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/jar.mn">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/jar.mn">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/mail/activity/activity.css">mail/themes/pinstripe/mail/activity/activity.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/mail/activity/activity.css">file</a> |
<a href="/comm-central/annotate/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/mail/activity/activity.css">annotate</a> |
<a href="/comm-central/diff/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/mail/activity/activity.css">diff</a> |
<a href="/comm-central/comparison/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/mail/activity/activity.css">comparison</a> |
<a href="/comm-central/log/0c91c794aa554a42da205ed7db48cc2477e17695/mail/themes/pinstripe/mail/activity/activity.css">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/mailCore.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/mailCore.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -245,16 +245,22 @@ function openAddonsMgr()</span>
<a href="#l1.4"></a><span id="l1.4">     return;</span>
<a href="#l1.5"></a><span id="l1.5">   }</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7">   const EMURL = &quot;chrome://mozapps/content/extensions/extensions.xul&quot;;</span>
<a href="#l1.8"></a><span id="l1.8">   const EMFEATURES = &quot;chrome,menubar,extra-chrome,toolbar,dialog=no,resizable&quot;;</span>
<a href="#l1.9"></a><span id="l1.9">   window.openDialog(EMURL, &quot;&quot;, EMFEATURES);</span>
<a href="#l1.10"></a><span id="l1.10"> }</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+function openActivityMgr()</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+{</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+  Components.classes['@mozilla.org/activity-manager-ui;1'].</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+    getService(Components.interfaces.nsIActivityManagerUI).show(window);</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineplus">+}</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineplus">+</span>
<a href="#l1.18"></a><span id="l1.18"> function SetBusyCursor(window, enable)</span>
<a href="#l1.19"></a><span id="l1.19"> {</span>
<a href="#l1.20"></a><span id="l1.20">     // setCursor() is only available for chrome windows.</span>
<a href="#l1.21"></a><span id="l1.21">     // However one of our frames is the start page which </span>
<a href="#l1.22"></a><span id="l1.22">     // is a non-chrome window, so check if this window has a</span>
<a href="#l1.23"></a><span id="l1.23">     // setCursor method</span>
<a href="#l1.24"></a><span id="l1.24">     if (&quot;setCursor&quot; in window) {</span>
<a href="#l1.25"></a><span id="l1.25">         if (enable)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1279,16 +1279,20 @@</span>
<a href="#l2.4"></a><span id="l2.4"> #ifndef XP_MACOSX</span>
<a href="#l2.5"></a><span id="l2.5">         &lt;menuitem hidden=&quot;true&quot; accesskey=&quot;&amp;messengerCmd.accesskey;&quot; label=&quot;&amp;messengerCmd.label;&quot;</span>
<a href="#l2.6"></a><span id="l2.6">                   key=&quot;key_mail&quot; oncommand=&quot;toMessengerWindow();&quot; id=&quot;tasksMenuMail&quot; class=&quot;menuitem-iconic menu-iconic&quot;/&gt;</span>
<a href="#l2.7"></a><span id="l2.7">         &lt;menuitem id=&quot;addressBook&quot; label=&quot;&amp;addressBookCmd.label;&quot; accesskey=&quot;&amp;addressBookCmd.accesskey;&quot; key=&quot;key_addressbook&quot;</span>
<a href="#l2.8"></a><span id="l2.8">                   oncommand=&quot;toOpenWindowByType('mail:addressbook', 'chrome://messenger/content/addressbook/addressbook.xul');&quot;/&gt;</span>
<a href="#l2.9"></a><span id="l2.9"> #endif</span>
<a href="#l2.10"></a><span id="l2.10">         &lt;menuitem id=&quot;addonsManager&quot; label=&quot;&amp;addons.label;&quot; accesskey=&quot;&amp;addons.accesskey;&quot;</span>
<a href="#l2.11"></a><span id="l2.11">                   oncommand=&quot;openAddonsMgr();&quot;/&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+        &lt;!--Commented out until we land some activities--&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        &lt;!--&lt;menuitem id=&quot;activityManager&quot; label=&quot;&amp;activitymanager.label;&quot;--&gt;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+        &lt;!--          accesskey=&quot;&amp;activitymanager.accesskey;&quot;--&gt;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+        &lt;!--          oncommand=&quot;openActivityMgr();&quot;/&gt;--&gt;</span>
<a href="#l2.16"></a><span id="l2.16">         &lt;menuseparator id=&quot;devToolsSeparator&quot;/&gt;</span>
<a href="#l2.17"></a><span id="l2.17">         &lt;menuitem id=&quot;filtersCmd&quot; label=&quot;&amp;filtersCmd.label;&quot;</span>
<a href="#l2.18"></a><span id="l2.18">                   accesskey=&quot;&amp;filtersCmd.accesskey;&quot;</span>
<a href="#l2.19"></a><span id="l2.19">                   oncommand=&quot;MsgFilters(null, null);&quot;/&gt;</span>
<a href="#l2.20"></a><span id="l2.20">         &lt;menuitem id=&quot;applyFilters&quot;</span>
<a href="#l2.21"></a><span id="l2.21">                   label=&quot;&amp;filtersApply.label;&quot;</span>
<a href="#l2.22"></a><span id="l2.22">                   accesskey=&quot;&amp;filtersApply.accesskey;&quot;</span>
<a href="#l2.23"></a><span id="l2.23">                   command=&quot;cmd_applyFilters&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/components/Makefile.in</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/components/Makefile.in</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -37,17 +37,17 @@</span>
<a href="#l3.4"></a><span id="l3.4"> </span>
<a href="#l3.5"></a><span id="l3.5"> DEPTH   = ../..</span>
<a href="#l3.6"></a><span id="l3.6"> topsrcdir = @top_srcdir@</span>
<a href="#l3.7"></a><span id="l3.7"> srcdir    = @srcdir@</span>
<a href="#l3.8"></a><span id="l3.8"> VPATH   = @srcdir@</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10"> include $(DEPTH)/config/autoconf.mk</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-DIRS    = compose preferences addrbook migration</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+DIRS    = compose preferences addrbook migration activity</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15"> ifneq (,$(filter windows gtk2 mac cocoa, $(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l3.16"></a><span id="l3.16"> DIRS += shell</span>
<a href="#l3.17"></a><span id="l3.17"> endif</span>
<a href="#l3.18"></a><span id="l3.18"> </span>
<a href="#l3.19"></a><span id="l3.19"> ifdef MOZ_SAFE_BROWSING</span>
<a href="#l3.20"></a><span id="l3.20"> DIRS += phishing </span>
<a href="#l3.21"></a><span id="l3.21"> endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1">new file mode 100644</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineminus">--- /dev/null</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineplus">+++ b/mail/components/activity/Makefile.in</span>
<a href="#l4.4"></a><span id="l4.4" class="difflineat">@@ -0,0 +1,59 @@</span>
<a href="#l4.5"></a><span id="l4.5" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l4.6"></a><span id="l4.6" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l4.7"></a><span id="l4.7" class="difflineplus">+#</span>
<a href="#l4.8"></a><span id="l4.8" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l4.10"></a><span id="l4.10" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+#</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+# License.</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+#</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+# The Original Code is mozilla.org code.</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+#</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+# Mozilla Foundation.</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2009</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineplus">+#</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+# Contributor(s):</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineplus">+#  Emre Birol &lt;emrebirol@gmail.com&gt;</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineplus">+#  David Ascher &lt;dascher@mozillamessaging.com&gt;</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+#</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+#</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+DEPTH		= ../../..</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+topsrcdir	= @top_srcdir@</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+srcdir		= @srcdir@</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineplus">+VPATH		= @srcdir@</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineplus">+</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+include $(DEPTH)/config/autoconf.mk</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineplus">+</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineplus">+MODULE    = activity</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineplus">+EXTRA_COMPONENTS = \</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineplus">+  nsActivity.js \</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineplus">+  nsActivityManager.js \</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineplus">+  nsActivityManagerUI.js \</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineplus">+  $(NULL)</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineplus">+</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineplus">+XPIDLSRCS = nsIActivity.idl \</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineplus">+            nsIActivityManager.idl \</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineplus">+            nsIActivityManagerUI.idl \</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineplus">+            $(NULL)</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineplus">+</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineplus">+include $(topsrcdir)/config/rules.mk</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1">new file mode 100644</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineminus">--- /dev/null</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineplus">+++ b/mail/components/activity/content/activity.js</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineat">@@ -0,0 +1,337 @@</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineplus">+/* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l5.6"></a><span id="l5.6" class="difflineplus">+ * ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l5.7"></a><span id="l5.7" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l5.8"></a><span id="l5.8" class="difflineplus">+ *</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+ *</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+ * License.</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+ *</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+ * The Original Code is Mozilla.org Code.</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+ *</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+ * Netscape Communications Corporation.</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2001</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+ *</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+ * Contributor(s):</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+ *   Blake Ross &lt;blakeross@telocity.com&gt; (Original Author of download mgr)</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineplus">+ *   Ben Goodger &lt;ben@bengoodger.com&gt; (v2.0)</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+ *   Dan Mosedale &lt;dmose@mozilla.org&gt;</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+ *   Fredrik Holmqvist &lt;thesuckiestemail@yahoo.se&gt;</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+ *   Josh Aas &lt;josh@mozilla.com&gt;</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+ *   Shawn Wilsher &lt;me@shawnwilsher.com&gt; (v3.0)</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+ *   Edward Lee &lt;edward.lee@engineering.uiuc.edu&gt;</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+ *   David Ascher &lt;dascher@mozillamessaging.com&gt; (activity manager version)</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+ *   Emre Birol &lt;emrebirol@gmail.com&gt;</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+ *</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineplus">+ *</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineplus">+</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineplus">+//// Globals</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineplus">+</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineplus">+Components.utils.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineplus">+</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineplus">+let gActivityMgrListener = null;</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineplus">+let gActivitiesView = null;</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineplus">+let gActivityLogger = Log4Moz.getConfiguredLogger(&quot;activitymgr&quot;);</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineplus">+</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineplus">+const nsActProcess = Components.Constructor(&quot;@mozilla.org/activity-process;1&quot;,</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineplus">+                                            &quot;nsIActivityProcess&quot;, &quot;init&quot;);</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineplus">+const nsActEvent = Components.Constructor(&quot;@mozilla.org/activity-event;1&quot;,</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineplus">+                                          &quot;nsIActivityEvent&quot;, &quot;init&quot;);</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineplus">+const nsActWarning = Components.Constructor(&quot;@mozilla.org/activity-warning;1&quot;,</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineplus">+                                            &quot;nsIActivityWarning&quot;, &quot;init&quot;);</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineplus">+</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineplus">+//// An object to monitor nsActivityManager operations. This class acts as</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineplus">+//// binding layer between nsActivityManager and nsActivityManagerUI objects.</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineplus">+</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineplus">+function ActivityMgrListener()</span>
<a href="#l5.74"></a><span id="l5.74" class="difflineplus">+{}</span>
<a href="#l5.75"></a><span id="l5.75" class="difflineplus">+</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineplus">+ActivityMgrListener.prototype = {</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineplus">+</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineplus">+  onAddedActivity: function(aID, aActivity) {</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineplus">+    gActivityLogger.info(&quot;added activity: &quot; + aID + &quot; &quot; + aActivity)</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineplus">+    addActivityBinding(aID, aActivity);</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineplus">+  },</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineplus">+  </span>
<a href="#l5.83"></a><span id="l5.83" class="difflineplus">+  onRemovedActivity: function(aID) {</span>
<a href="#l5.84"></a><span id="l5.84" class="difflineplus">+    removeActivityBinding(aID);</span>
<a href="#l5.85"></a><span id="l5.85" class="difflineplus">+  }</span>
<a href="#l5.86"></a><span id="l5.86" class="difflineplus">+};</span>
<a href="#l5.87"></a><span id="l5.87" class="difflineplus">+</span>
<a href="#l5.88"></a><span id="l5.88" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l5.89"></a><span id="l5.89" class="difflineplus">+//// Utility Functions for Activity binding management</span>
<a href="#l5.90"></a><span id="l5.90" class="difflineplus">+</span>
<a href="#l5.91"></a><span id="l5.91" class="difflineplus">+/**</span>
<a href="#l5.92"></a><span id="l5.92" class="difflineplus">+ * Creates the proper binding for the given activity</span>
<a href="#l5.93"></a><span id="l5.93" class="difflineplus">+ */</span>
<a href="#l5.94"></a><span id="l5.94" class="difflineplus">+function createActivityBinding(aActivity)</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineplus">+{</span>
<a href="#l5.96"></a><span id="l5.96" class="difflineplus">+  let bindingName = aActivity.bindingName;</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineplus">+  let binding = document.createElement(bindingName);</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineplus">+  </span>
<a href="#l5.99"></a><span id="l5.99" class="difflineplus">+  if (binding)</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineplus">+    binding.setAttribute('actID', aActivity.id);</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineplus">+    </span>
<a href="#l5.102"></a><span id="l5.102" class="difflineplus">+  return binding;</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineplus">+}</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineplus">+</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineplus">+/**</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineplus">+ * Returns the activity group binding that matches the context_type</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineplus">+ * and context of the given activity, if any.</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineplus">+ */</span>
<a href="#l5.109"></a><span id="l5.109" class="difflineplus">+function getActivityGroupBindingByContext(aContextType, aContextObj)</span>
<a href="#l5.110"></a><span id="l5.110" class="difflineplus">+{</span>
<a href="#l5.111"></a><span id="l5.111" class="difflineplus">+  for (let i = 0; i &lt; gActivitiesView.itemCount; i++) {</span>
<a href="#l5.112"></a><span id="l5.112" class="difflineplus">+    let item = gActivitiesView.getItemAtIndex(i)</span>
<a href="#l5.113"></a><span id="l5.113" class="difflineplus">+    if (item.isGroup &amp;&amp;</span>
<a href="#l5.114"></a><span id="l5.114" class="difflineplus">+        item.contextType == aContextType &amp;&amp;</span>
<a href="#l5.115"></a><span id="l5.115" class="difflineplus">+        item.contextObj == aContextObj) {</span>
<a href="#l5.116"></a><span id="l5.116" class="difflineplus">+      return item;</span>
<a href="#l5.117"></a><span id="l5.117" class="difflineplus">+    }</span>
<a href="#l5.118"></a><span id="l5.118" class="difflineplus">+  }</span>
<a href="#l5.119"></a><span id="l5.119" class="difflineplus">+  return null;</span>
<a href="#l5.120"></a><span id="l5.120" class="difflineplus">+}</span>
<a href="#l5.121"></a><span id="l5.121" class="difflineplus">+</span>
<a href="#l5.122"></a><span id="l5.122" class="difflineplus">+/**</span>
<a href="#l5.123"></a><span id="l5.123" class="difflineplus">+ * Inserts the given binding into the correct position on the</span>
<a href="#l5.124"></a><span id="l5.124" class="difflineplus">+ * activity manager window.</span>
<a href="#l5.125"></a><span id="l5.125" class="difflineplus">+ */</span>
<a href="#l5.126"></a><span id="l5.126" class="difflineplus">+function placeActivityBinding(aBinding)</span>
<a href="#l5.127"></a><span id="l5.127" class="difflineplus">+{</span>
<a href="#l5.128"></a><span id="l5.128" class="difflineplus">+  if (aBinding.isGroup || aBinding.isProcess)</span>
<a href="#l5.129"></a><span id="l5.129" class="difflineplus">+    gActivitiesView.insertBefore(aBinding, gActivitiesView.firstChild);</span>
<a href="#l5.130"></a><span id="l5.130" class="difflineplus">+  else {</span>
<a href="#l5.131"></a><span id="l5.131" class="difflineplus">+    let next = gActivitiesView.firstChild;</span>
<a href="#l5.132"></a><span id="l5.132" class="difflineplus">+    while (next &amp;&amp; (next.isWarning || next.isProcess || next.isGroup))</span>
<a href="#l5.133"></a><span id="l5.133" class="difflineplus">+      next = next.nextSibling;</span>
<a href="#l5.134"></a><span id="l5.134" class="difflineplus">+    if (next)</span>
<a href="#l5.135"></a><span id="l5.135" class="difflineplus">+      gActivitiesView.insertBefore(aBinding, next);</span>
<a href="#l5.136"></a><span id="l5.136" class="difflineplus">+    else</span>
<a href="#l5.137"></a><span id="l5.137" class="difflineplus">+      gActivitiesView.appendChild(aBinding);</span>
<a href="#l5.138"></a><span id="l5.138" class="difflineplus">+  }</span>
<a href="#l5.139"></a><span id="l5.139" class="difflineplus">+}</span>
<a href="#l5.140"></a><span id="l5.140" class="difflineplus">+</span>
<a href="#l5.141"></a><span id="l5.141" class="difflineplus">+/**</span>
<a href="#l5.142"></a><span id="l5.142" class="difflineplus">+ * Adds a new binding to activity manager window for the</span>
<a href="#l5.143"></a><span id="l5.143" class="difflineplus">+ * given activity. It is called by ActivityMgrListener when</span>
<a href="#l5.144"></a><span id="l5.144" class="difflineplus">+ * a new activity is added into the activity manager's internal</span>
<a href="#l5.145"></a><span id="l5.145" class="difflineplus">+ * list.</span>
<a href="#l5.146"></a><span id="l5.146" class="difflineplus">+ */</span>
<a href="#l5.147"></a><span id="l5.147" class="difflineplus">+function addActivityBinding(aID, aActivity)</span>
<a href="#l5.148"></a><span id="l5.148" class="difflineplus">+{</span>
<a href="#l5.149"></a><span id="l5.149" class="difflineplus">+  try {</span>
<a href="#l5.150"></a><span id="l5.150" class="difflineplus">+    gActivityLogger.info(&quot;Adding ActivityBinding: &quot; + aID + &quot;, &quot; + aActivity)</span>
<a href="#l5.151"></a><span id="l5.151" class="difflineplus">+    // get |groupingStyle| of the activity. Grouping style determines whether we</span>
<a href="#l5.152"></a><span id="l5.152" class="difflineplus">+    // show the activity standalone or grouped by context in the activity manager</span>
<a href="#l5.153"></a><span id="l5.153" class="difflineplus">+    // window.</span>
<a href="#l5.154"></a><span id="l5.154" class="difflineplus">+    let isGroupByContext = (aActivity.groupingStyle ==</span>
<a href="#l5.155"></a><span id="l5.155" class="difflineplus">+                            Components.interfaces.nsIActivity.GROUPING_STYLE_BYCONTEXT);</span>
<a href="#l5.156"></a><span id="l5.156" class="difflineplus">+  </span>
<a href="#l5.157"></a><span id="l5.157" class="difflineplus">+    // find out if an activity group has already been created for this context</span>
<a href="#l5.158"></a><span id="l5.158" class="difflineplus">+    let group = null;</span>
<a href="#l5.159"></a><span id="l5.159" class="difflineplus">+    if (isGroupByContext) {</span>
<a href="#l5.160"></a><span id="l5.160" class="difflineplus">+      group = getActivityGroupBindingByContext(aActivity.contextType,</span>
<a href="#l5.161"></a><span id="l5.161" class="difflineplus">+                                               aActivity.contextObj);</span>
<a href="#l5.162"></a><span id="l5.162" class="difflineplus">+      // create a group if it's not already created.</span>
<a href="#l5.163"></a><span id="l5.163" class="difflineplus">+      if (!group) {</span>
<a href="#l5.164"></a><span id="l5.164" class="difflineplus">+        group = document.createElement(&quot;activity-group&quot;);</span>
<a href="#l5.165"></a><span id="l5.165" class="difflineplus">+        gActivityLogger.info(&quot;created group element&quot;)</span>
<a href="#l5.166"></a><span id="l5.166" class="difflineplus">+        // Set the context type and object of the newly created group</span>
<a href="#l5.167"></a><span id="l5.167" class="difflineplus">+        group.contextType = aActivity.contextType;</span>
<a href="#l5.168"></a><span id="l5.168" class="difflineplus">+        group.contextObj = aActivity.contextObj;</span>
<a href="#l5.169"></a><span id="l5.169" class="difflineplus">+        group.contextDisplayText = aActivity.contextDisplayText;</span>
<a href="#l5.170"></a><span id="l5.170" class="difflineplus">+      </span>
<a href="#l5.171"></a><span id="l5.171" class="difflineplus">+        // add group into the list</span>
<a href="#l5.172"></a><span id="l5.172" class="difflineplus">+        placeActivityBinding(group);</span>
<a href="#l5.173"></a><span id="l5.173" class="difflineplus">+      }</span>
<a href="#l5.174"></a><span id="l5.174" class="difflineplus">+    }</span>
<a href="#l5.175"></a><span id="l5.175" class="difflineplus">+     </span>
<a href="#l5.176"></a><span id="l5.176" class="difflineplus">+    // create the appropriate binding for the activity</span>
<a href="#l5.177"></a><span id="l5.177" class="difflineplus">+    let actBinding = createActivityBinding(aActivity);</span>
<a href="#l5.178"></a><span id="l5.178" class="difflineplus">+    gActivityLogger.info(&quot;created activity binding&quot;)</span>
<a href="#l5.179"></a><span id="l5.179" class="difflineplus">+  </span>
<a href="#l5.180"></a><span id="l5.180" class="difflineplus">+    if (group) {</span>
<a href="#l5.181"></a><span id="l5.181" class="difflineplus">+      // get the inner list element of the group</span>
<a href="#l5.182"></a><span id="l5.182" class="difflineplus">+      let groupView = document.getAnonymousElementByAttribute(group, &quot;anonid&quot;,</span>
<a href="#l5.183"></a><span id="l5.183" class="difflineplus">+                                                             &quot;activityGroupView&quot;);</span>
<a href="#l5.184"></a><span id="l5.184" class="difflineplus">+      groupView.appendChild(actBinding);</span>
<a href="#l5.185"></a><span id="l5.185" class="difflineplus">+    }</span>
<a href="#l5.186"></a><span id="l5.186" class="difflineplus">+    else {</span>
<a href="#l5.187"></a><span id="l5.187" class="difflineplus">+      placeActivityBinding(actBinding);</span>
<a href="#l5.188"></a><span id="l5.188" class="difflineplus">+    }</span>
<a href="#l5.189"></a><span id="l5.189" class="difflineplus">+  } catch (e) {</span>
<a href="#l5.190"></a><span id="l5.190" class="difflineplus">+    log.error(&quot;addActivityBinding: &quot; + e);</span>
<a href="#l5.191"></a><span id="l5.191" class="difflineplus">+    throw(e);</span>
<a href="#l5.192"></a><span id="l5.192" class="difflineplus">+  }</span>
<a href="#l5.193"></a><span id="l5.193" class="difflineplus">+}</span>
<a href="#l5.194"></a><span id="l5.194" class="difflineplus">+</span>
<a href="#l5.195"></a><span id="l5.195" class="difflineplus">+/**</span>
<a href="#l5.196"></a><span id="l5.196" class="difflineplus">+ * Removes the activity binding from the activity manager window.</span>
<a href="#l5.197"></a><span id="l5.197" class="difflineplus">+ * It is called by ActivityMgrListener when the activity in question</span>
<a href="#l5.198"></a><span id="l5.198" class="difflineplus">+ * is removed from the activity manager's internal list.</span>
<a href="#l5.199"></a><span id="l5.199" class="difflineplus">+ */</span>
<a href="#l5.200"></a><span id="l5.200" class="difflineplus">+function removeActivityBinding(aID)</span>
<a href="#l5.201"></a><span id="l5.201" class="difflineplus">+{</span>
<a href="#l5.202"></a><span id="l5.202" class="difflineplus">+  // Note: document.getAnonymousNodes(gActivitiesView); didn't work</span>
<a href="#l5.203"></a><span id="l5.203" class="difflineplus">+  gActivityLogger.info(&quot;removing Activity ID: &quot; + aID);</span>
<a href="#l5.204"></a><span id="l5.204" class="difflineplus">+  for (let i = 0; i &lt; gActivitiesView.itemCount; i++) {</span>
<a href="#l5.205"></a><span id="l5.205" class="difflineplus">+    let item = gActivitiesView.getItemAtIndex(i);</span>
<a href="#l5.206"></a><span id="l5.206" class="difflineplus">+    if (!item) {</span>
<a href="#l5.207"></a><span id="l5.207" class="difflineplus">+      gActivityLogger.debug(&quot;returning as empty&quot;)</span>
<a href="#l5.208"></a><span id="l5.208" class="difflineplus">+      return;</span>
<a href="#l5.209"></a><span id="l5.209" class="difflineplus">+    }</span>
<a href="#l5.210"></a><span id="l5.210" class="difflineplus">+</span>
<a href="#l5.211"></a><span id="l5.211" class="difflineplus">+    if (!item.isGroup) {</span>
<a href="#l5.212"></a><span id="l5.212" class="difflineplus">+      gActivityLogger.debug(&quot;is not a group, &quot;)</span>
<a href="#l5.213"></a><span id="l5.213" class="difflineplus">+      if (item.getAttribute('actID') == aID) {</span>
<a href="#l5.214"></a><span id="l5.214" class="difflineplus">+        // since XBL dtors are not working properly when we remove the element,</span>
<a href="#l5.215"></a><span id="l5.215" class="difflineplus">+        // we have to explicitly remove the binding from activities' listeners</span>
<a href="#l5.216"></a><span id="l5.216" class="difflineplus">+        // list. See bug 230086 for details.</span>
<a href="#l5.217"></a><span id="l5.217" class="difflineplus">+        item.detachFromActivity();</span>
<a href="#l5.218"></a><span id="l5.218" class="difflineplus">+        gActivitiesView.removeChild(item);</span>
<a href="#l5.219"></a><span id="l5.219" class="difflineplus">+        break;</span>
<a href="#l5.220"></a><span id="l5.220" class="difflineplus">+      }</span>
<a href="#l5.221"></a><span id="l5.221" class="difflineplus">+    }</span>
<a href="#l5.222"></a><span id="l5.222" class="difflineplus">+    else {</span>
<a href="#l5.223"></a><span id="l5.223" class="difflineplus">+      let actbinding = document.getAnonymousElementByAttribute(item, 'actID',</span>
<a href="#l5.224"></a><span id="l5.224" class="difflineplus">+                                                               aID);</span>
<a href="#l5.225"></a><span id="l5.225" class="difflineplus">+      if (actbinding) {</span>
<a href="#l5.226"></a><span id="l5.226" class="difflineplus">+        let groupView = document.getAnonymousElementByAttribute(item, &quot;anonid&quot;,</span>
<a href="#l5.227"></a><span id="l5.227" class="difflineplus">+                                                           &quot;activityGroupView&quot;);</span>
<a href="#l5.228"></a><span id="l5.228" class="difflineplus">+        // since XBL dtors are not working properly when we remove the element,</span>
<a href="#l5.229"></a><span id="l5.229" class="difflineplus">+        // we have to explicitly remove the binding from activities' listeners</span>
<a href="#l5.230"></a><span id="l5.230" class="difflineplus">+        // list. See bug 230086 for details.</span>
<a href="#l5.231"></a><span id="l5.231" class="difflineplus">+        actbinding.detachFromActivity();</span>
<a href="#l5.232"></a><span id="l5.232" class="difflineplus">+        groupView.removeChild(actbinding);</span>
<a href="#l5.233"></a><span id="l5.233" class="difflineplus">+                </span>
<a href="#l5.234"></a><span id="l5.234" class="difflineplus">+        // if the group becomes empty after the removal,</span>
<a href="#l5.235"></a><span id="l5.235" class="difflineplus">+        // get rid of the group as well</span>
<a href="#l5.236"></a><span id="l5.236" class="difflineplus">+        if (groupView.getRowCount() == 0)</span>
<a href="#l5.237"></a><span id="l5.237" class="difflineplus">+          gActivitiesView.removeChild(item);</span>
<a href="#l5.238"></a><span id="l5.238" class="difflineplus">+        </span>
<a href="#l5.239"></a><span id="l5.239" class="difflineplus">+        break;</span>
<a href="#l5.240"></a><span id="l5.240" class="difflineplus">+      }</span>
<a href="#l5.241"></a><span id="l5.241" class="difflineplus">+    }</span>
<a href="#l5.242"></a><span id="l5.242" class="difflineplus">+  }</span>
<a href="#l5.243"></a><span id="l5.243" class="difflineplus">+}</span>
<a href="#l5.244"></a><span id="l5.244" class="difflineplus">+</span>
<a href="#l5.245"></a><span id="l5.245" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l5.246"></a><span id="l5.246" class="difflineplus">+//// Startup, Shutdown</span>
<a href="#l5.247"></a><span id="l5.247" class="difflineplus">+</span>
<a href="#l5.248"></a><span id="l5.248" class="difflineplus">+function Startup()</span>
<a href="#l5.249"></a><span id="l5.249" class="difflineplus">+{</span>
<a href="#l5.250"></a><span id="l5.250" class="difflineplus">+  try {</span>
<a href="#l5.251"></a><span id="l5.251" class="difflineplus">+    gActivitiesView = document.getElementById(&quot;activityView&quot;);</span>
<a href="#l5.252"></a><span id="l5.252" class="difflineplus">+</span>
<a href="#l5.253"></a><span id="l5.253" class="difflineplus">+    let activityManager = Components.classes[&quot;@mozilla.org/activity-manager;1&quot;]</span>
<a href="#l5.254"></a><span id="l5.254" class="difflineplus">+      .getService(Components.interfaces.nsIActivityManager);</span>
<a href="#l5.255"></a><span id="l5.255" class="difflineplus">+    let activities = activityManager.getActivities({});</span>
<a href="#l5.256"></a><span id="l5.256" class="difflineplus">+    for each (let [, activity] in Iterator(activities)) {</span>
<a href="#l5.257"></a><span id="l5.257" class="difflineplus">+      addActivityBinding(activity.id, activity);</span>
<a href="#l5.258"></a><span id="l5.258" class="difflineplus">+    }</span>
<a href="#l5.259"></a><span id="l5.259" class="difflineplus">+</span>
<a href="#l5.260"></a><span id="l5.260" class="difflineplus">+    // start listening changes in the activity manager's</span>
<a href="#l5.261"></a><span id="l5.261" class="difflineplus">+    // internal list</span>
<a href="#l5.262"></a><span id="l5.262" class="difflineplus">+    gActivityMgrListener = new ActivityMgrListener();</span>
<a href="#l5.263"></a><span id="l5.263" class="difflineplus">+    activityManager.addListener(gActivityMgrListener);</span>
<a href="#l5.264"></a><span id="l5.264" class="difflineplus">+</span>
<a href="#l5.265"></a><span id="l5.265" class="difflineplus">+  } catch (e) {</span>
<a href="#l5.266"></a><span id="l5.266" class="difflineplus">+    gActivityLogger.error(&quot;Exception: &quot; + e )</span>
<a href="#l5.267"></a><span id="l5.267" class="difflineplus">+  }</span>
<a href="#l5.268"></a><span id="l5.268" class="difflineplus">+}</span>
<a href="#l5.269"></a><span id="l5.269" class="difflineplus">+</span>
<a href="#l5.270"></a><span id="l5.270" class="difflineplus">+function Shutdown()</span>
<a href="#l5.271"></a><span id="l5.271" class="difflineplus">+{</span>
<a href="#l5.272"></a><span id="l5.272" class="difflineplus">+  let activityManager = Components.classes[&quot;@mozilla.org/activity-manager;1&quot;]</span>
<a href="#l5.273"></a><span id="l5.273" class="difflineplus">+    .getService(Components.interfaces.nsIActivityManager);</span>
<a href="#l5.274"></a><span id="l5.274" class="difflineplus">+  activityManager.removeListener(gActivityMgrListener);</span>
<a href="#l5.275"></a><span id="l5.275" class="difflineplus">+}</span>
<a href="#l5.276"></a><span id="l5.276" class="difflineplus">+</span>
<a href="#l5.277"></a><span id="l5.277" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l5.278"></a><span id="l5.278" class="difflineplus">+//// Utility Functions</span>
<a href="#l5.279"></a><span id="l5.279" class="difflineplus">+</span>
<a href="#l5.280"></a><span id="l5.280" class="difflineplus">+/**</span>
<a href="#l5.281"></a><span id="l5.281" class="difflineplus">+ * Helper function to replace a placeholder string with a real string</span>
<a href="#l5.282"></a><span id="l5.282" class="difflineplus">+ *</span>
<a href="#l5.283"></a><span id="l5.283" class="difflineplus">+ * @param aText</span>
<a href="#l5.284"></a><span id="l5.284" class="difflineplus">+ *        Source text containing placeholder (e.g., #1)</span>
<a href="#l5.285"></a><span id="l5.285" class="difflineplus">+ * @param aIndex</span>
<a href="#l5.286"></a><span id="l5.286" class="difflineplus">+ *        Index number of placeholder to replace</span>
<a href="#l5.287"></a><span id="l5.287" class="difflineplus">+ * @param aValue</span>
<a href="#l5.288"></a><span id="l5.288" class="difflineplus">+ *        New string to put in place of placeholder</span>
<a href="#l5.289"></a><span id="l5.289" class="difflineplus">+ * @return The string with placeholder replaced with the new string</span>
<a href="#l5.290"></a><span id="l5.290" class="difflineplus">+ */</span>
<a href="#l5.291"></a><span id="l5.291" class="difflineplus">+function replaceInsert(aText, aIndex, aValue)</span>
<a href="#l5.292"></a><span id="l5.292" class="difflineplus">+{</span>
<a href="#l5.293"></a><span id="l5.293" class="difflineplus">+  return aText.replace(&quot;#&quot; + aIndex, aValue);</span>
<a href="#l5.294"></a><span id="l5.294" class="difflineplus">+}</span>
<a href="#l5.295"></a><span id="l5.295" class="difflineplus">+</span>
<a href="#l5.296"></a><span id="l5.296" class="difflineplus">+/**</span>
<a href="#l5.297"></a><span id="l5.297" class="difflineplus">+ * Remove all activities not in-progress from the activity list.</span>
<a href="#l5.298"></a><span id="l5.298" class="difflineplus">+ */</span>
<a href="#l5.299"></a><span id="l5.299" class="difflineplus">+function clearActivityList()</span>
<a href="#l5.300"></a><span id="l5.300" class="difflineplus">+{</span>
<a href="#l5.301"></a><span id="l5.301" class="difflineplus">+  gActivityLogger.debug(&quot;clearActivityList&quot;);</span>
<a href="#l5.302"></a><span id="l5.302" class="difflineplus">+  // Remove each activity starting from the end until we hit a activity</span>
<a href="#l5.303"></a><span id="l5.303" class="difflineplus">+  // that is in progress or the end.</span>
<a href="#l5.304"></a><span id="l5.304" class="difflineplus">+  let item;</span>
<a href="#l5.305"></a><span id="l5.305" class="difflineplus">+  for (let i = gActivitiesView.itemCount-1; i &gt;= 0; i--) {</span>
<a href="#l5.306"></a><span id="l5.306" class="difflineplus">+    let child = gActivitiesView.getItemAtIndex(i);</span>
<a href="#l5.307"></a><span id="l5.307" class="difflineplus">+    if (child.inProgress)</span>
<a href="#l5.308"></a><span id="l5.308" class="difflineplus">+      continue;</span>
<a href="#l5.309"></a><span id="l5.309" class="difflineplus">+</span>
<a href="#l5.310"></a><span id="l5.310" class="difflineplus">+    if (!child)</span>
<a href="#l5.311"></a><span id="l5.311" class="difflineplus">+      break;</span>
<a href="#l5.312"></a><span id="l5.312" class="difflineplus">+    removeActivityBinding(child.getAttribute('actID'));</span>
<a href="#l5.313"></a><span id="l5.313" class="difflineplus">+  }</span>
<a href="#l5.314"></a><span id="l5.314" class="difflineplus">+</span>
<a href="#l5.315"></a><span id="l5.315" class="difflineplus">+  gActivitiesView.focus();</span>
<a href="#l5.316"></a><span id="l5.316" class="difflineplus">+}</span>
<a href="#l5.317"></a><span id="l5.317" class="difflineplus">+</span>
<a href="#l5.318"></a><span id="l5.318" class="difflineplus">+function processKeyEvent(event)</span>
<a href="#l5.319"></a><span id="l5.319" class="difflineplus">+{</span>
<a href="#l5.320"></a><span id="l5.320" class="difflineplus">+  switch (event.keyCode) {</span>
<a href="#l5.321"></a><span id="l5.321" class="difflineplus">+    case event.DOM_VK_RIGHT:</span>
<a href="#l5.322"></a><span id="l5.322" class="difflineplus">+      if (event.target.tagName == 'richlistbox') {</span>
<a href="#l5.323"></a><span id="l5.323" class="difflineplus">+        let richlistbox = event.target.selectedItem.processes;</span>
<a href="#l5.324"></a><span id="l5.324" class="difflineplus">+        if (richlistbox.tagName == 'xul:richlistbox') {</span>
<a href="#l5.325"></a><span id="l5.325" class="difflineplus">+          richlistbox.focus();</span>
<a href="#l5.326"></a><span id="l5.326" class="difflineplus">+          richlistbox.selectItem(richlistbox.getItemAtIndex(0));</span>
<a href="#l5.327"></a><span id="l5.327" class="difflineplus">+        }</span>
<a href="#l5.328"></a><span id="l5.328" class="difflineplus">+      }</span>
<a href="#l5.329"></a><span id="l5.329" class="difflineplus">+      break;</span>
<a href="#l5.330"></a><span id="l5.330" class="difflineplus">+    case event.DOM_VK_LEFT:</span>
<a href="#l5.331"></a><span id="l5.331" class="difflineplus">+      if (event.target.tagName == 'activity-group') {</span>
<a href="#l5.332"></a><span id="l5.332" class="difflineplus">+        var parent = event.target.parentNode;</span>
<a href="#l5.333"></a><span id="l5.333" class="difflineplus">+        if (parent.tagName == 'richlistbox') {</span>
<a href="#l5.334"></a><span id="l5.334" class="difflineplus">+          event.target.processes.clearSelection();</span>
<a href="#l5.335"></a><span id="l5.335" class="difflineplus">+          parent.selectItem(event.target);</span>
<a href="#l5.336"></a><span id="l5.336" class="difflineplus">+          parent.focus();</span>
<a href="#l5.337"></a><span id="l5.337" class="difflineplus">+        }</span>
<a href="#l5.338"></a><span id="l5.338" class="difflineplus">+      }</span>
<a href="#l5.339"></a><span id="l5.339" class="difflineplus">+      break;</span>
<a href="#l5.340"></a><span id="l5.340" class="difflineplus">+  }</span>
<a href="#l5.341"></a><span id="l5.341" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">new file mode 100644</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineminus">--- /dev/null</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineplus">+++ b/mail/components/activity/content/activity.xml</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineat">@@ -0,0 +1,836 @@</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l6.6"></a><span id="l6.6" class="difflineplus">+</span>
<a href="#l6.7"></a><span id="l6.7" class="difflineplus">+&lt;!--</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineplus">+ -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineplus">+ ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineplus">+ Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineplus">+</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+ The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+ 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+ the License. You may obtain a copy of the License at</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+ http://www.mozilla.org/MPL/</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+ Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+ WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+ for the specific language governing rights and limitations under the</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+ License.</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineplus">+</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+ The Original Code is Mozilla.org Code.</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineplus">+ The Initial Developer of the Original Code is</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineplus">+ Blake Ross.</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineplus">+ Portions created by the Initial Developer are Copyright (C) 2001</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineplus">+ the Initial Developer. All Rights Reserved.</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineplus">+</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineplus">+ Contributor(s):</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineplus">+   Ben Goodger &lt;ben@bengoodger.com&gt; (v2.0)</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineplus">+   Blake Ross &lt;blakeross@telocity.com&gt;</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+   Shawn Wilsher &lt;me@shawnwilsher.com&gt; (v3.0)</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineplus">+   Edward Lee &lt;edward.lee@engineering.uiuc.edu&gt;</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineplus">+   David Ascher &lt;dascher@mozillamessaging.com&gt; (activity manager)</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+   Emre Birol &lt;emrebirol@gmail.com&gt;</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+ Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineplus">+ either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineplus">+ the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineplus">+ in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineplus">+ of those above. If you wish to allow use of your version of this file only</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineplus">+ under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineplus">+ use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+ decision by deleting the provisions above and replace them with the notice</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineplus">+ and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineplus">+ the provisions above, a recipient may use your version of this file under</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineplus">+ the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineplus">+</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineplus">+ ***** END LICENSE BLOCK *****</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineplus">+--&gt;</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+&lt;!DOCTYPE bindings [</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineplus">+  &lt;!ENTITY % activityDTD SYSTEM &quot;chrome://messenger/locale/activity.dtd&quot; &gt;</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineplus">+  %activityDTD;</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineplus">+]&gt;</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineplus">+</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineplus">+&lt;bindings id=&quot;activityBindings&quot;</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineplus">+          xmlns=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l6.59"></a><span id="l6.59" class="difflineplus">+          xmlns:xul=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineplus">+          xmlns:xbl=&quot;http://www.mozilla.org/xbl&quot;&gt;</span>
<a href="#l6.61"></a><span id="l6.61" class="difflineplus">+</span>
<a href="#l6.62"></a><span id="l6.62" class="difflineplus">+  &lt;binding id=&quot;activity-group&quot;</span>
<a href="#l6.63"></a><span id="l6.63" class="difflineplus">+           extends=&quot;chrome://global/content/bindings/richlistbox.xml#richlistitem&quot;&gt;</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineplus">+    &lt;resources&gt;</span>
<a href="#l6.65"></a><span id="l6.65" class="difflineplus">+      &lt;stylesheet src=&quot;chrome://messenger/skin/activity.css&quot;/&gt;</span>
<a href="#l6.66"></a><span id="l6.66" class="difflineplus">+    &lt;/resources&gt;</span>
<a href="#l6.67"></a><span id="l6.67" class="difflineplus">+    &lt;implementation&gt;</span>
<a href="#l6.68"></a><span id="l6.68" class="difflineplus">+      &lt;constructor&gt;</span>
<a href="#l6.69"></a><span id="l6.69" class="difflineplus">+       &lt;![CDATA[</span>
<a href="#l6.70"></a><span id="l6.70" class="difflineplus">+          this.setAttribute('contextDisplayText', this.contextDisplayText);</span>
<a href="#l6.71"></a><span id="l6.71" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.72"></a><span id="l6.72" class="difflineplus">+      &lt;/constructor&gt;</span>
<a href="#l6.73"></a><span id="l6.73" class="difflineplus">+      &lt;field name=&quot;contextType&quot;&gt;</span>
<a href="#l6.74"></a><span id="l6.74" class="difflineplus">+       &quot;&quot;</span>
<a href="#l6.75"></a><span id="l6.75" class="difflineplus">+      &lt;/field&gt;</span>
<a href="#l6.76"></a><span id="l6.76" class="difflineplus">+      &lt;field name=&quot;contextObj&quot;&gt;</span>
<a href="#l6.77"></a><span id="l6.77" class="difflineplus">+       null</span>
<a href="#l6.78"></a><span id="l6.78" class="difflineplus">+      &lt;/field&gt;</span>
<a href="#l6.79"></a><span id="l6.79" class="difflineplus">+      &lt;field name=&quot;_contextDisplayText&quot;&gt;</span>
<a href="#l6.80"></a><span id="l6.80" class="difflineplus">+       null</span>
<a href="#l6.81"></a><span id="l6.81" class="difflineplus">+      &lt;/field&gt;</span>
<a href="#l6.82"></a><span id="l6.82" class="difflineplus">+      &lt;property name=&quot;contextDisplayText&quot;&gt;</span>
<a href="#l6.83"></a><span id="l6.83" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.84"></a><span id="l6.84" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.85"></a><span id="l6.85" class="difflineplus">+            return this._contextDisplayText;</span>
<a href="#l6.86"></a><span id="l6.86" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.87"></a><span id="l6.87" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.88"></a><span id="l6.88" class="difflineplus">+        &lt;setter&gt;</span>
<a href="#l6.89"></a><span id="l6.89" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.90"></a><span id="l6.90" class="difflineplus">+            this._contextDisplayText = val;</span>
<a href="#l6.91"></a><span id="l6.91" class="difflineplus">+            document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;contextlbl&quot;).setAttribute(&quot;value&quot;, val)</span>
<a href="#l6.92"></a><span id="l6.92" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.93"></a><span id="l6.93" class="difflineplus">+        &lt;/setter&gt;</span>
<a href="#l6.94"></a><span id="l6.94" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.95"></a><span id="l6.95" class="difflineplus">+      &lt;property name=&quot;isGroup&quot;&gt;</span>
<a href="#l6.96"></a><span id="l6.96" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.97"></a><span id="l6.97" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.98"></a><span id="l6.98" class="difflineplus">+          return true;</span>
<a href="#l6.99"></a><span id="l6.99" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.100"></a><span id="l6.100" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.101"></a><span id="l6.101" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.102"></a><span id="l6.102" class="difflineplus">+      &lt;property name=&quot;processes&quot;&gt;</span>
<a href="#l6.103"></a><span id="l6.103" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.104"></a><span id="l6.104" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.105"></a><span id="l6.105" class="difflineplus">+          return document.getAnonymousElementByAttribute(this, &quot;anonid&quot;,</span>
<a href="#l6.106"></a><span id="l6.106" class="difflineplus">+                                                         &quot;activityGroupView&quot;);</span>
<a href="#l6.107"></a><span id="l6.107" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.108"></a><span id="l6.108" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.109"></a><span id="l6.109" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.110"></a><span id="l6.110" class="difflineplus">+      &lt;method name=&quot;retry&quot;&gt;</span>
<a href="#l6.111"></a><span id="l6.111" class="difflineplus">+        &lt;body&gt;</span>
<a href="#l6.112"></a><span id="l6.112" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.113"></a><span id="l6.113" class="difflineplus">+            let activityManager = Components.classes[&quot;@mozilla.org/activity-manager;1&quot;]</span>
<a href="#l6.114"></a><span id="l6.114" class="difflineplus">+                                            .getService(Components.interfaces.nsIActivityManager);</span>
<a href="#l6.115"></a><span id="l6.115" class="difflineplus">+           </span>
<a href="#l6.116"></a><span id="l6.116" class="difflineplus">+            let processes = activityManager</span>
<a href="#l6.117"></a><span id="l6.117" class="difflineplus">+                                  .getProcessesByContext(this.contextType,</span>
<a href="#l6.118"></a><span id="l6.118" class="difflineplus">+                                                         this.contextObj, {});</span>
<a href="#l6.119"></a><span id="l6.119" class="difflineplus">+            for each (let [, process] in Iterator(processes)) {</span>
<a href="#l6.120"></a><span id="l6.120" class="difflineplus">+              if (process.retryHandler)</span>
<a href="#l6.121"></a><span id="l6.121" class="difflineplus">+                process.retryHandler.retry(process);</span>
<a href="#l6.122"></a><span id="l6.122" class="difflineplus">+            }</span>
<a href="#l6.123"></a><span id="l6.123" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.124"></a><span id="l6.124" class="difflineplus">+        &lt;/body&gt;</span>
<a href="#l6.125"></a><span id="l6.125" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l6.126"></a><span id="l6.126" class="difflineplus">+    &lt;/implementation&gt;</span>
<a href="#l6.127"></a><span id="l6.127" class="difflineplus">+    &lt;content&gt;</span>
<a href="#l6.128"></a><span id="l6.128" class="difflineplus">+     &lt;xul:vbox flex=&quot;1&quot;&gt;</span>
<a href="#l6.129"></a><span id="l6.129" class="difflineplus">+        &lt;xul:hbox&gt;</span>
<a href="#l6.130"></a><span id="l6.130" class="difflineplus">+        &lt;xul:vbox pack=&quot;start&quot;&gt;</span>
<a href="#l6.131"></a><span id="l6.131" class="difflineplus">+          &lt;xul:label xbl:inherits=&quot;value=contextDisplayText, tooltiptext=contextDisplayTextTip&quot;</span>
<a href="#l6.132"></a><span id="l6.132" class="difflineplus">+                     crop=&quot;left&quot; class=&quot;contextDisplayText&quot; anonid=&quot;contextlbl&quot;/&gt;</span>
<a href="#l6.133"></a><span id="l6.133" class="difflineplus">+        &lt;/xul:vbox&gt;</span>
<a href="#l6.134"></a><span id="l6.134" class="difflineplus">+        &lt;xul:vbox pack=&quot;center&quot; flex=&quot;2&quot;&gt;</span>
<a href="#l6.135"></a><span id="l6.135" class="difflineplus">+        &lt;!--instances can specify retry_enabled=&quot;true&quot; to show the retry button--&gt;</span>
<a href="#l6.136"></a><span id="l6.136" class="difflineplus">+        &lt;xul:button xbl:inherits=&quot;enabled=retry_enabled&quot; class=&quot;retry mini-button&quot; tooltiptext=&quot;&amp;cmd.retry.label;&quot;</span>
<a href="#l6.137"></a><span id="l6.137" class="difflineplus">+                        anonid=&quot;button_retry&quot; cmd=&quot;cmd_retry&quot;</span>
<a href="#l6.138"></a><span id="l6.138" class="difflineplus">+                        ondblclick=&quot;event.stopPropagation();&quot;</span>
<a href="#l6.139"></a><span id="l6.139" class="difflineplus">+                        oncommand=&quot;retry();&quot;/&gt;</span>
<a href="#l6.140"></a><span id="l6.140" class="difflineplus">+        &lt;/xul:vbox&gt;</span>
<a href="#l6.141"></a><span id="l6.141" class="difflineplus">+        &lt;/xul:hbox&gt;</span>
<a href="#l6.142"></a><span id="l6.142" class="difflineplus">+        &lt;xul:vbox pack=&quot;center&quot;&gt;</span>
<a href="#l6.143"></a><span id="l6.143" class="difflineplus">+         &lt;xul:richlistbox class=&quot;activitygroupbox activityview&quot; seltype=&quot;multiple&quot;</span>
<a href="#l6.144"></a><span id="l6.144" class="difflineplus">+                          flex=&quot;1&quot; anonid=&quot;activityGroupView&quot;/&gt;</span>
<a href="#l6.145"></a><span id="l6.145" class="difflineplus">+        &lt;/xul:vbox&gt;</span>
<a href="#l6.146"></a><span id="l6.146" class="difflineplus">+      &lt;/xul:vbox&gt;</span>
<a href="#l6.147"></a><span id="l6.147" class="difflineplus">+    &lt;/content&gt;</span>
<a href="#l6.148"></a><span id="l6.148" class="difflineplus">+  &lt;/binding&gt;</span>
<a href="#l6.149"></a><span id="l6.149" class="difflineplus">+</span>
<a href="#l6.150"></a><span id="l6.150" class="difflineplus">+  &lt;binding id=&quot;activity-base&quot; extends=&quot;chrome://global/content/bindings/richlistbox.xml#richlistitem&quot;&gt;</span>
<a href="#l6.151"></a><span id="l6.151" class="difflineplus">+    &lt;resources&gt;</span>
<a href="#l6.152"></a><span id="l6.152" class="difflineplus">+      &lt;stylesheet src=&quot;chrome://messenger/skin/activity.css&quot;/&gt;</span>
<a href="#l6.153"></a><span id="l6.153" class="difflineplus">+    &lt;/resources&gt;</span>
<a href="#l6.154"></a><span id="l6.154" class="difflineplus">+    &lt;implementation implements=&quot;nsIActivityListener&quot;&gt;</span>
<a href="#l6.155"></a><span id="l6.155" class="difflineplus">+      &lt;constructor&gt;</span>
<a href="#l6.156"></a><span id="l6.156" class="difflineplus">+       &lt;![CDATA[</span>
<a href="#l6.157"></a><span id="l6.157" class="difflineplus">+        try {</span>
<a href="#l6.158"></a><span id="l6.158" class="difflineplus">+          Components.utils.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l6.159"></a><span id="l6.159" class="difflineplus">+          let activityManager = Components.classes[&quot;@mozilla.org/activity-manager;1&quot;]</span>
<a href="#l6.160"></a><span id="l6.160" class="difflineplus">+                                          .getService(Components.interfaces.nsIActivityManager);</span>
<a href="#l6.161"></a><span id="l6.161" class="difflineplus">+</span>
<a href="#l6.162"></a><span id="l6.162" class="difflineplus">+          // fetch the activity and set the base attributes</span>
<a href="#l6.163"></a><span id="l6.163" class="difflineplus">+          let actID = this.getAttribute('actID');</span>
<a href="#l6.164"></a><span id="l6.164" class="difflineplus">+          this._activity = activityManager.getActivity(actID);</span>
<a href="#l6.165"></a><span id="l6.165" class="difflineplus">+          this._activity.addListener(this);</span>
<a href="#l6.166"></a><span id="l6.166" class="difflineplus">+          this.setAttribute('iconclass', this._activity.iconClass);</span>
<a href="#l6.167"></a><span id="l6.167" class="difflineplus">+          this.log = Log4Moz.getConfiguredLogger(&quot;activity-base&quot;);</span>
<a href="#l6.168"></a><span id="l6.168" class="difflineplus">+</span>
<a href="#l6.169"></a><span id="l6.169" class="difflineplus">+          this.text = {</span>
<a href="#l6.170"></a><span id="l6.170" class="difflineplus">+            paused: &quot;paused&quot;,</span>
<a href="#l6.171"></a><span id="l6.171" class="difflineplus">+            canceled: &quot;canceled&quot;,</span>
<a href="#l6.172"></a><span id="l6.172" class="difflineplus">+            failed: &quot;failed&quot;,</span>
<a href="#l6.173"></a><span id="l6.173" class="difflineplus">+            waitingforinput: &quot;waitingForInput&quot;,</span>
<a href="#l6.174"></a><span id="l6.174" class="difflineplus">+            waitingforretry: &quot;waitingForRetry&quot;,</span>
<a href="#l6.175"></a><span id="l6.175" class="difflineplus">+            yesterday: &quot;yesterday&quot;,</span>
<a href="#l6.176"></a><span id="l6.176" class="difflineplus">+            monthDate: &quot;monthDate&quot;</span>
<a href="#l6.177"></a><span id="l6.177" class="difflineplus">+          };</span>
<a href="#l6.178"></a><span id="l6.178" class="difflineplus">+</span>
<a href="#l6.179"></a><span id="l6.179" class="difflineplus">+          // convert strings to those in the string bundle</span>
<a href="#l6.180"></a><span id="l6.180" class="difflineplus">+          let (sb = document.getElementById(&quot;activityStrings&quot;)) {</span>
<a href="#l6.181"></a><span id="l6.181" class="difflineplus">+            let getStr = function(string) sb.getString(string);</span>
<a href="#l6.182"></a><span id="l6.182" class="difflineplus">+            for (let [name, value] in Iterator(this.text))</span>
<a href="#l6.183"></a><span id="l6.183" class="difflineplus">+                this.text[name] = typeof value == &quot;string&quot; ? getStr(value)</span>
<a href="#l6.184"></a><span id="l6.184" class="difflineplus">+                                                           : value.map(getStr);</span>
<a href="#l6.185"></a><span id="l6.185" class="difflineplus">+          }</span>
<a href="#l6.186"></a><span id="l6.186" class="difflineplus">+        } catch (e) {</span>
<a href="#l6.187"></a><span id="l6.187" class="difflineplus">+          this.log.error(&quot;Exception: &quot; + e);</span>
<a href="#l6.188"></a><span id="l6.188" class="difflineplus">+        }</span>
<a href="#l6.189"></a><span id="l6.189" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.190"></a><span id="l6.190" class="difflineplus">+      &lt;/constructor&gt;</span>
<a href="#l6.191"></a><span id="l6.191" class="difflineplus">+      &lt;destructor&gt;</span>
<a href="#l6.192"></a><span id="l6.192" class="difflineplus">+       &lt;![CDATA[</span>
<a href="#l6.193"></a><span id="l6.193" class="difflineplus">+        this.detachFromActivity();</span>
<a href="#l6.194"></a><span id="l6.194" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.195"></a><span id="l6.195" class="difflineplus">+      &lt;/destructor&gt;</span>
<a href="#l6.196"></a><span id="l6.196" class="difflineplus">+      &lt;method name=&quot;detachFromActivity&quot;&gt;</span>
<a href="#l6.197"></a><span id="l6.197" class="difflineplus">+        &lt;body&gt;</span>
<a href="#l6.198"></a><span id="l6.198" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.199"></a><span id="l6.199" class="difflineplus">+            this._activity.removeListener(this);</span>
<a href="#l6.200"></a><span id="l6.200" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.201"></a><span id="l6.201" class="difflineplus">+        &lt;/body&gt;</span>
<a href="#l6.202"></a><span id="l6.202" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l6.203"></a><span id="l6.203" class="difflineplus">+      &lt;property name=&quot;isProcess&quot;&gt;</span>
<a href="#l6.204"></a><span id="l6.204" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.205"></a><span id="l6.205" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.206"></a><span id="l6.206" class="difflineplus">+          return this._activity &amp;&amp; (this._activity instanceof</span>
<a href="#l6.207"></a><span id="l6.207" class="difflineplus">+                                    Components.interfaces.nsIActivityProcess);</span>
<a href="#l6.208"></a><span id="l6.208" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.209"></a><span id="l6.209" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.210"></a><span id="l6.210" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.211"></a><span id="l6.211" class="difflineplus">+      &lt;property name=&quot;isEvent&quot;&gt;</span>
<a href="#l6.212"></a><span id="l6.212" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.213"></a><span id="l6.213" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.214"></a><span id="l6.214" class="difflineplus">+          return this._activity &amp;&amp; (this._activity instanceof</span>
<a href="#l6.215"></a><span id="l6.215" class="difflineplus">+                                    Components.interfaces.nsIActivityEvent);</span>
<a href="#l6.216"></a><span id="l6.216" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.217"></a><span id="l6.217" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.218"></a><span id="l6.218" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.219"></a><span id="l6.219" class="difflineplus">+      &lt;property name=&quot;isWarning&quot;&gt;</span>
<a href="#l6.220"></a><span id="l6.220" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.221"></a><span id="l6.221" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.222"></a><span id="l6.222" class="difflineplus">+          return this._activity &amp;&amp; (this._activity instanceof</span>
<a href="#l6.223"></a><span id="l6.223" class="difflineplus">+                                    Components.interfaces.nsIActivityWarning);</span>
<a href="#l6.224"></a><span id="l6.224" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.225"></a><span id="l6.225" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.226"></a><span id="l6.226" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.227"></a><span id="l6.227" class="difflineplus">+      &lt;property name=&quot;isOrphan&quot;&gt;</span>
<a href="#l6.228"></a><span id="l6.228" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.229"></a><span id="l6.229" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.230"></a><span id="l6.230" class="difflineplus">+          try {</span>
<a href="#l6.231"></a><span id="l6.231" class="difflineplus">+           let activity = activityManager.getActivity(this._activity.id);</span>
<a href="#l6.232"></a><span id="l6.232" class="difflineplus">+           return false;</span>
<a href="#l6.233"></a><span id="l6.233" class="difflineplus">+          }</span>
<a href="#l6.234"></a><span id="l6.234" class="difflineplus">+          catch(e) {</span>
<a href="#l6.235"></a><span id="l6.235" class="difflineplus">+            // happens when the given activity is already removed form</span>
<a href="#l6.236"></a><span id="l6.236" class="difflineplus">+            //   the activity manager. Returning true indicates that the</span>
<a href="#l6.237"></a><span id="l6.237" class="difflineplus">+            //   XBL doesn't have any associated activity - orphan.</span>
<a href="#l6.238"></a><span id="l6.238" class="difflineplus">+          }</span>
<a href="#l6.239"></a><span id="l6.239" class="difflineplus">+          return true;</span>
<a href="#l6.240"></a><span id="l6.240" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.241"></a><span id="l6.241" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.242"></a><span id="l6.242" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.243"></a><span id="l6.243" class="difflineplus">+      &lt;property name=&quot;activity&quot;&gt;</span>
<a href="#l6.244"></a><span id="l6.244" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.245"></a><span id="l6.245" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.246"></a><span id="l6.246" class="difflineplus">+           return this._activity;</span>
<a href="#l6.247"></a><span id="l6.247" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.248"></a><span id="l6.248" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.249"></a><span id="l6.249" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.250"></a><span id="l6.250" class="difflineplus">+      &lt;property name=&quot;buttons&quot;&gt;</span>
<a href="#l6.251"></a><span id="l6.251" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.252"></a><span id="l6.252" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.253"></a><span id="l6.253" class="difflineplus">+          let startEl = document.getAnonymousNodes(this);</span>
<a href="#l6.254"></a><span id="l6.254" class="difflineplus">+          if (!startEl.length)</span>
<a href="#l6.255"></a><span id="l6.255" class="difflineplus">+            startEl = [this];</span>
<a href="#l6.256"></a><span id="l6.256" class="difflineplus">+</span>
<a href="#l6.257"></a><span id="l6.257" class="difflineplus">+          const XULNS = &quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;;</span>
<a href="#l6.258"></a><span id="l6.258" class="difflineplus">+          return startEl[0].getElementsByTagNameNS(XULNS, &quot;button&quot;);</span>
<a href="#l6.259"></a><span id="l6.259" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.260"></a><span id="l6.260" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.261"></a><span id="l6.261" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.262"></a><span id="l6.262" class="difflineplus">+      &lt;method name=&quot;setVisibility&quot;&gt;</span>
<a href="#l6.263"></a><span id="l6.263" class="difflineplus">+        &lt;parameter name=&quot;anonid&quot;/&gt;</span>
<a href="#l6.264"></a><span id="l6.264" class="difflineplus">+        &lt;parameter name=&quot;visible&quot;/&gt;</span>
<a href="#l6.265"></a><span id="l6.265" class="difflineplus">+        &lt;body&gt;</span>
<a href="#l6.266"></a><span id="l6.266" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.267"></a><span id="l6.267" class="difflineplus">+            document.getAnonymousElementByAttribute(this, &quot;anonid&quot;,</span>
<a href="#l6.268"></a><span id="l6.268" class="difflineplus">+             anonid).setAttribute('hidden', !visible);</span>
<a href="#l6.269"></a><span id="l6.269" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.270"></a><span id="l6.270" class="difflineplus">+        &lt;/body&gt;</span>
<a href="#l6.271"></a><span id="l6.271" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l6.272"></a><span id="l6.272" class="difflineplus">+      &lt;method name=&quot;formatTime&quot;&gt;</span>
<a href="#l6.273"></a><span id="l6.273" class="difflineplus">+        &lt;parameter name=&quot;time&quot;/&gt;</span>
<a href="#l6.274"></a><span id="l6.274" class="difflineplus">+        &lt;body&gt;</span>
<a href="#l6.275"></a><span id="l6.275" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.276"></a><span id="l6.276" class="difflineplus">+            let dts = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l6.277"></a><span id="l6.277" class="difflineplus">+                                .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l6.278"></a><span id="l6.278" class="difflineplus">+</span>
<a href="#l6.279"></a><span id="l6.279" class="difflineplus">+            // Figure out when today begins</span>
<a href="#l6.280"></a><span id="l6.280" class="difflineplus">+            let now = new Date();</span>
<a href="#l6.281"></a><span id="l6.281" class="difflineplus">+            let today = new Date(now.getFullYear(), now.getMonth(),</span>
<a href="#l6.282"></a><span id="l6.282" class="difflineplus">+                                 now.getDate());</span>
<a href="#l6.283"></a><span id="l6.283" class="difflineplus">+              </span>
<a href="#l6.284"></a><span id="l6.284" class="difflineplus">+            // Get the end time to display</span>
<a href="#l6.285"></a><span id="l6.285" class="difflineplus">+            let end = new Date(parseInt(time));</span>
<a href="#l6.286"></a><span id="l6.286" class="difflineplus">+              </span>
<a href="#l6.287"></a><span id="l6.287" class="difflineplus">+            // Figure out if the end time is from today, yesterday,</span>
<a href="#l6.288"></a><span id="l6.288" class="difflineplus">+            // this week, etc.</span>
<a href="#l6.289"></a><span id="l6.289" class="difflineplus">+            let dateTime;</span>
<a href="#l6.290"></a><span id="l6.290" class="difflineplus">+            let kDayInMsecs = 24 * 60 * 60 * 1000;</span>
<a href="#l6.291"></a><span id="l6.291" class="difflineplus">+            let k6DaysInMsecs = 6 * kDayInMsecs;</span>
<a href="#l6.292"></a><span id="l6.292" class="difflineplus">+            if (end &gt;= today) {</span>
<a href="#l6.293"></a><span id="l6.293" class="difflineplus">+              // activity finished after today started, show the time</span>
<a href="#l6.294"></a><span id="l6.294" class="difflineplus">+              dateTime = dts.FormatTime(&quot;&quot;, dts.timeFormatNoSeconds,</span>
<a href="#l6.295"></a><span id="l6.295" class="difflineplus">+                                            end.getHours(), end.getMinutes(),0);</span>
<a href="#l6.296"></a><span id="l6.296" class="difflineplus">+            } else if (today - end &lt; kDayInMsecs) {</span>
<a href="#l6.297"></a><span id="l6.297" class="difflineplus">+              // activity finished after yesterday started, show yesterday</span>
<a href="#l6.298"></a><span id="l6.298" class="difflineplus">+              dateTime = this.text.yesterday;</span>
<a href="#l6.299"></a><span id="l6.299" class="difflineplus">+            } else if (today - end &lt; k6DaysInMsecs) {</span>
<a href="#l6.300"></a><span id="l6.300" class="difflineplus">+              // activity finished after last week started, show day of week</span>
<a href="#l6.301"></a><span id="l6.301" class="difflineplus">+              dateTime = end.toLocaleFormat(&quot;%A&quot;);</span>
<a href="#l6.302"></a><span id="l6.302" class="difflineplus">+            } else {</span>
<a href="#l6.303"></a><span id="l6.303" class="difflineplus">+              // activity must have been from some time ago.. show month/day</span>
<a href="#l6.304"></a><span id="l6.304" class="difflineplus">+              let month = end.toLocaleFormat(&quot;%B&quot;);</span>
<a href="#l6.305"></a><span id="l6.305" class="difflineplus">+              // Remove leading 0 by converting the date string to a number</span>
<a href="#l6.306"></a><span id="l6.306" class="difflineplus">+              let date = Number(end.toLocaleFormat(&quot;%d&quot;));</span>
<a href="#l6.307"></a><span id="l6.307" class="difflineplus">+              dateTime = replaceInsert(this.text.monthDate, 1, month);</span>
<a href="#l6.308"></a><span id="l6.308" class="difflineplus">+              dateTime = replaceInsert(dateTime, 2, date);</span>
<a href="#l6.309"></a><span id="l6.309" class="difflineplus">+            }</span>
<a href="#l6.310"></a><span id="l6.310" class="difflineplus">+            return dateTime;</span>
<a href="#l6.311"></a><span id="l6.311" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.312"></a><span id="l6.312" class="difflineplus">+        &lt;/body&gt;</span>
<a href="#l6.313"></a><span id="l6.313" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l6.314"></a><span id="l6.314" class="difflineplus">+      &lt;method name=&quot;formatTimeTip&quot;&gt;</span>
<a href="#l6.315"></a><span id="l6.315" class="difflineplus">+        &lt;parameter name=&quot;time&quot;/&gt;</span>
<a href="#l6.316"></a><span id="l6.316" class="difflineplus">+        &lt;body&gt;</span>
<a href="#l6.317"></a><span id="l6.317" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.318"></a><span id="l6.318" class="difflineplus">+            let dts = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l6.319"></a><span id="l6.319" class="difflineplus">+                                .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l6.320"></a><span id="l6.320" class="difflineplus">+                                </span>
<a href="#l6.321"></a><span id="l6.321" class="difflineplus">+            // Get the end time to display</span>
<a href="#l6.322"></a><span id="l6.322" class="difflineplus">+            let end = new Date(parseInt(time));</span>
<a href="#l6.323"></a><span id="l6.323" class="difflineplus">+</span>
<a href="#l6.324"></a><span id="l6.324" class="difflineplus">+            // Set the tooltip to be the full date and time</span>
<a href="#l6.325"></a><span id="l6.325" class="difflineplus">+            let dateTimeTip = dts.FormatDateTime(&quot;&quot;,</span>
<a href="#l6.326"></a><span id="l6.326" class="difflineplus">+                                                dts.dateFormatLong,</span>
<a href="#l6.327"></a><span id="l6.327" class="difflineplus">+                                                dts.timeFormatNoSeconds,</span>
<a href="#l6.328"></a><span id="l6.328" class="difflineplus">+                                                end.getFullYear(),</span>
<a href="#l6.329"></a><span id="l6.329" class="difflineplus">+                                                end.getMonth() + 1,</span>
<a href="#l6.330"></a><span id="l6.330" class="difflineplus">+                                                end.getDate(),</span>
<a href="#l6.331"></a><span id="l6.331" class="difflineplus">+                                                end.getHours(),</span>
<a href="#l6.332"></a><span id="l6.332" class="difflineplus">+                                                end.getMinutes(),</span>
<a href="#l6.333"></a><span id="l6.333" class="difflineplus">+                                                0);</span>
<a href="#l6.334"></a><span id="l6.334" class="difflineplus">+            return dateTimeTip;</span>
<a href="#l6.335"></a><span id="l6.335" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.336"></a><span id="l6.336" class="difflineplus">+        &lt;/body&gt;</span>
<a href="#l6.337"></a><span id="l6.337" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l6.338"></a><span id="l6.338" class="difflineplus">+    &lt;/implementation&gt;</span>
<a href="#l6.339"></a><span id="l6.339" class="difflineplus">+  &lt;/binding&gt;</span>
<a href="#l6.340"></a><span id="l6.340" class="difflineplus">+  </span>
<a href="#l6.341"></a><span id="l6.341" class="difflineplus">+  &lt;binding id=&quot;activity-process&quot;</span>
<a href="#l6.342"></a><span id="l6.342" class="difflineplus">+           extends=&quot;chrome://messenger/content/activity.xml#activity-base&quot;&gt;</span>
<a href="#l6.343"></a><span id="l6.343" class="difflineplus">+    &lt;implementation&gt;</span>
<a href="#l6.344"></a><span id="l6.344" class="difflineplus">+      &lt;constructor&gt;</span>
<a href="#l6.345"></a><span id="l6.345" class="difflineplus">+       &lt;![CDATA[</span>
<a href="#l6.346"></a><span id="l6.346" class="difflineplus">+        // We need to make this casting here in order to access to nsIActivityProcess</span>
<a href="#l6.347"></a><span id="l6.347" class="difflineplus">+        // interface of the component from the the binding.</span>
<a href="#l6.348"></a><span id="l6.348" class="difflineplus">+        // We deliberately propogate the exceptions to the caller.</span>
<a href="#l6.349"></a><span id="l6.349" class="difflineplus">+        this._activity.QueryInterface(Components.interfaces.nsIActivityProcess);</span>
<a href="#l6.350"></a><span id="l6.350" class="difflineplus">+        </span>
<a href="#l6.351"></a><span id="l6.351" class="difflineplus">+        try {</span>
<a href="#l6.352"></a><span id="l6.352" class="difflineplus">+          this.displayText = this._activity.displayText;</span>
<a href="#l6.353"></a><span id="l6.353" class="difflineplus">+          // make sure that binding reflects the latest state of the process</span>
<a href="#l6.354"></a><span id="l6.354" class="difflineplus">+          this.onStateChanged(this._activity.state,</span>
<a href="#l6.355"></a><span id="l6.355" class="difflineplus">+                              Components.interfaces.nsIActivityProcess.STATE_NOTSTARTED);</span>
<a href="#l6.356"></a><span id="l6.356" class="difflineplus">+          this.onProgressChanged(this._activity, this._activity.percentComplete,</span>
<a href="#l6.357"></a><span id="l6.357" class="difflineplus">+                                 this._activity.lastStatusText,</span>
<a href="#l6.358"></a><span id="l6.358" class="difflineplus">+                                 this._activity.workUnitComplete,</span>
<a href="#l6.359"></a><span id="l6.359" class="difflineplus">+                                 this._activity.totalWorkUnits);</span>
<a href="#l6.360"></a><span id="l6.360" class="difflineplus">+         }</span>
<a href="#l6.361"></a><span id="l6.361" class="difflineplus">+         catch(e) {</span>
<a href="#l6.362"></a><span id="l6.362" class="difflineplus">+            this.log.error(&quot;Exception constructing activity-process: &quot; + e);</span>
<a href="#l6.363"></a><span id="l6.363" class="difflineplus">+            throw(e)</span>
<a href="#l6.364"></a><span id="l6.364" class="difflineplus">+         }</span>
<a href="#l6.365"></a><span id="l6.365" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.366"></a><span id="l6.366" class="difflineplus">+      &lt;/constructor&gt;</span>
<a href="#l6.367"></a><span id="l6.367" class="difflineplus">+      &lt;property name=&quot;displayText&quot;&gt;</span>
<a href="#l6.368"></a><span id="l6.368" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.369"></a><span id="l6.369" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.370"></a><span id="l6.370" class="difflineplus">+            return this.getAttribute('displayText');</span>
<a href="#l6.371"></a><span id="l6.371" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.372"></a><span id="l6.372" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.373"></a><span id="l6.373" class="difflineplus">+        &lt;setter&gt;</span>
<a href="#l6.374"></a><span id="l6.374" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.375"></a><span id="l6.375" class="difflineplus">+            this.setAttribute('displayText', val);</span>
<a href="#l6.376"></a><span id="l6.376" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.377"></a><span id="l6.377" class="difflineplus">+        &lt;/setter&gt;</span>
<a href="#l6.378"></a><span id="l6.378" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.379"></a><span id="l6.379" class="difflineplus">+      &lt;property name=&quot;statusText&quot;&gt;</span>
<a href="#l6.380"></a><span id="l6.380" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.381"></a><span id="l6.381" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.382"></a><span id="l6.382" class="difflineplus">+            return this.getAttribute('statusText');</span>
<a href="#l6.383"></a><span id="l6.383" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.384"></a><span id="l6.384" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.385"></a><span id="l6.385" class="difflineplus">+        &lt;setter&gt;</span>
<a href="#l6.386"></a><span id="l6.386" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.387"></a><span id="l6.387" class="difflineplus">+            this.setAttribute('statusText', val);</span>
<a href="#l6.388"></a><span id="l6.388" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.389"></a><span id="l6.389" class="difflineplus">+        &lt;/setter&gt;</span>
<a href="#l6.390"></a><span id="l6.390" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.391"></a><span id="l6.391" class="difflineplus">+      &lt;property name=&quot;inProgress&quot;&gt;</span>
<a href="#l6.392"></a><span id="l6.392" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.393"></a><span id="l6.393" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.394"></a><span id="l6.394" class="difflineplus">+           return (this._activity.state ==</span>
<a href="#l6.395"></a><span id="l6.395" class="difflineplus">+                   Components.interfaces.nsIActivityProcess.STATE_INPROGRESS);</span>
<a href="#l6.396"></a><span id="l6.396" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.397"></a><span id="l6.397" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.398"></a><span id="l6.398" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.399"></a><span id="l6.399" class="difflineplus">+      &lt;property name=&quot;isRemovable&quot;&gt;</span>
<a href="#l6.400"></a><span id="l6.400" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.401"></a><span id="l6.401" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.402"></a><span id="l6.402" class="difflineplus">+            return this._activity.state == Components.interfaces.nsIActivityProcess.STATE_COMPLETED || </span>
<a href="#l6.403"></a><span id="l6.403" class="difflineplus">+                   this._activity.state == Components.interfaces.nsIActivityProcess.STATE_CANCELED </span>
<a href="#l6.404"></a><span id="l6.404" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.405"></a><span id="l6.405" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.406"></a><span id="l6.406" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.407"></a><span id="l6.407" class="difflineplus">+      &lt;property name=&quot;canCancel&quot;&gt;</span>
<a href="#l6.408"></a><span id="l6.408" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.409"></a><span id="l6.409" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.410"></a><span id="l6.410" class="difflineplus">+          try {</span>
<a href="#l6.411"></a><span id="l6.411" class="difflineplus">+           return (this._activity.cancelHandler != null);</span>
<a href="#l6.412"></a><span id="l6.412" class="difflineplus">+          }</span>
<a href="#l6.413"></a><span id="l6.413" class="difflineplus">+          catch(e) {</span>
<a href="#l6.414"></a><span id="l6.414" class="difflineplus">+            // In normal conditions, we shouldn't endup here. This can only</span>
<a href="#l6.415"></a><span id="l6.415" class="difflineplus">+            // happen if the XBL is orphan - associated activity has been</span>
<a href="#l6.416"></a><span id="l6.416" class="difflineplus">+            // deleted but XBL stays alive.</span>
<a href="#l6.417"></a><span id="l6.417" class="difflineplus">+          }</span>
<a href="#l6.418"></a><span id="l6.418" class="difflineplus">+          return false;</span>
<a href="#l6.419"></a><span id="l6.419" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.420"></a><span id="l6.420" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.421"></a><span id="l6.421" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.422"></a><span id="l6.422" class="difflineplus">+      &lt;property name=&quot;canPause&quot;&gt;</span>
<a href="#l6.423"></a><span id="l6.423" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.424"></a><span id="l6.424" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.425"></a><span id="l6.425" class="difflineplus">+          try {</span>
<a href="#l6.426"></a><span id="l6.426" class="difflineplus">+           return (this._activity.pauseHandler != null);</span>
<a href="#l6.427"></a><span id="l6.427" class="difflineplus">+          }</span>
<a href="#l6.428"></a><span id="l6.428" class="difflineplus">+          catch(e) {</span>
<a href="#l6.429"></a><span id="l6.429" class="difflineplus">+            // In normal conditions, we shouldn't endup here. This can only</span>
<a href="#l6.430"></a><span id="l6.430" class="difflineplus">+            // happen if the XBL is orphan - associated activity has been</span>
<a href="#l6.431"></a><span id="l6.431" class="difflineplus">+            // deleted but XBL stays alive.</span>
<a href="#l6.432"></a><span id="l6.432" class="difflineplus">+          }</span>
<a href="#l6.433"></a><span id="l6.433" class="difflineplus">+          return false;</span>
<a href="#l6.434"></a><span id="l6.434" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.435"></a><span id="l6.435" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.436"></a><span id="l6.436" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.437"></a><span id="l6.437" class="difflineplus">+      &lt;property name=&quot;canRetry&quot;&gt;</span>
<a href="#l6.438"></a><span id="l6.438" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.439"></a><span id="l6.439" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.440"></a><span id="l6.440" class="difflineplus">+          try {</span>
<a href="#l6.441"></a><span id="l6.441" class="difflineplus">+           return (this._activity.retryHandler != null);</span>
<a href="#l6.442"></a><span id="l6.442" class="difflineplus">+          }</span>
<a href="#l6.443"></a><span id="l6.443" class="difflineplus">+          catch(e) {</span>
<a href="#l6.444"></a><span id="l6.444" class="difflineplus">+            // In normal conditions, we shouldn't endup here. This can only</span>
<a href="#l6.445"></a><span id="l6.445" class="difflineplus">+            // happen if the XBL is orphan - associated activity has been</span>
<a href="#l6.446"></a><span id="l6.446" class="difflineplus">+            // deleted but XBL stays alive.</span>
<a href="#l6.447"></a><span id="l6.447" class="difflineplus">+          }</span>
<a href="#l6.448"></a><span id="l6.448" class="difflineplus">+          return false;</span>
<a href="#l6.449"></a><span id="l6.449" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.450"></a><span id="l6.450" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.451"></a><span id="l6.451" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.452"></a><span id="l6.452" class="difflineplus">+      &lt;method name=&quot;onStateChanged&quot;&gt;</span>
<a href="#l6.453"></a><span id="l6.453" class="difflineplus">+        &lt;parameter name=&quot;aActivity&quot;/&gt;</span>
<a href="#l6.454"></a><span id="l6.454" class="difflineplus">+        &lt;parameter name=&quot;aOldState&quot;/&gt;</span>
<a href="#l6.455"></a><span id="l6.455" class="difflineplus">+        &lt;body&gt;</span>
<a href="#l6.456"></a><span id="l6.456" class="difflineplus">+         &lt;![CDATA[</span>
<a href="#l6.457"></a><span id="l6.457" class="difflineplus">+          // change the view of the binding according to the new state</span>
<a href="#l6.458"></a><span id="l6.458" class="difflineplus">+</span>
<a href="#l6.459"></a><span id="l6.459" class="difflineplus">+          // default states for each item</span>
<a href="#l6.460"></a><span id="l6.460" class="difflineplus">+          let hideCancelBut = true;</span>
<a href="#l6.461"></a><span id="l6.461" class="difflineplus">+          let hideRetryBut = true;</span>
<a href="#l6.462"></a><span id="l6.462" class="difflineplus">+          let hidePauseBut = true;</span>
<a href="#l6.463"></a><span id="l6.463" class="difflineplus">+          let hideResumeBut = true;</span>
<a href="#l6.464"></a><span id="l6.464" class="difflineplus">+          let hideProgressMeter = false;</span>
<a href="#l6.465"></a><span id="l6.465" class="difflineplus">+          let displayText = this.displayText;</span>
<a href="#l6.466"></a><span id="l6.466" class="difflineplus">+          let statusText = this.statusText;</span>
<a href="#l6.467"></a><span id="l6.467" class="difflineplus">+</span>
<a href="#l6.468"></a><span id="l6.468" class="difflineplus">+          switch(this._activity.state) {</span>
<a href="#l6.469"></a><span id="l6.469" class="difflineplus">+            case Components.interfaces.nsIActivityProcess.STATE_INPROGRESS:</span>
<a href="#l6.470"></a><span id="l6.470" class="difflineplus">+              hideCancelBut = !this.canCancel;</span>
<a href="#l6.471"></a><span id="l6.471" class="difflineplus">+              hidePauseBut = !this.canPause;</span>
<a href="#l6.472"></a><span id="l6.472" class="difflineplus">+               // status text is empty</span>
<a href="#l6.473"></a><span id="l6.473" class="difflineplus">+               statusText = &quot;&quot;;</span>
<a href="#l6.474"></a><span id="l6.474" class="difflineplus">+              break;</span>
<a href="#l6.475"></a><span id="l6.475" class="difflineplus">+            case Components.interfaces.nsIActivityProcess.STATE_COMPLETED:</span>
<a href="#l6.476"></a><span id="l6.476" class="difflineplus">+              // all buttons and progress meter are hidden</span>
<a href="#l6.477"></a><span id="l6.477" class="difflineplus">+              hideProgressMeter = true;</span>
<a href="#l6.478"></a><span id="l6.478" class="difflineplus">+              // status text is empty</span>
<a href="#l6.479"></a><span id="l6.479" class="difflineplus">+              statusText = &quot;&quot;;</span>
<a href="#l6.480"></a><span id="l6.480" class="difflineplus">+              break;</span>
<a href="#l6.481"></a><span id="l6.481" class="difflineplus">+            case Components.interfaces.nsIActivityProcess.STATE_CANCELED:</span>
<a href="#l6.482"></a><span id="l6.482" class="difflineplus">+              // all buttons and progress meter are hidden</span>
<a href="#l6.483"></a><span id="l6.483" class="difflineplus">+              hideProgressMeter = true;</span>
<a href="#l6.484"></a><span id="l6.484" class="difflineplus">+              statusText = this.text.canceled;</span>
<a href="#l6.485"></a><span id="l6.485" class="difflineplus">+              break;</span>
<a href="#l6.486"></a><span id="l6.486" class="difflineplus">+            case Components.interfaces.nsIActivityProcess.STATE_PAUSED:</span>
<a href="#l6.487"></a><span id="l6.487" class="difflineplus">+              hideCancelBut = !this.canCancel;</span>
<a href="#l6.488"></a><span id="l6.488" class="difflineplus">+              hideResumeBut = !this.canPause;</span>
<a href="#l6.489"></a><span id="l6.489" class="difflineplus">+              statusText = this.text.paused;</span>
<a href="#l6.490"></a><span id="l6.490" class="difflineplus">+              break;</span>
<a href="#l6.491"></a><span id="l6.491" class="difflineplus">+            case Components.interfaces.nsIActivityProcess.STATE_WAITINGFORINPUT:</span>
<a href="#l6.492"></a><span id="l6.492" class="difflineplus">+              hideCancelBut = !this.canCancel;</span>
<a href="#l6.493"></a><span id="l6.493" class="difflineplus">+              hideProgressMeter = true;</span>
<a href="#l6.494"></a><span id="l6.494" class="difflineplus">+              statusText = this.text.waitingforinput;</span>
<a href="#l6.495"></a><span id="l6.495" class="difflineplus">+              break;</span>
<a href="#l6.496"></a><span id="l6.496" class="difflineplus">+            case Components.interfaces.nsIActivityProcess.STATE_WAITINGFORRETRY:</span>
<a href="#l6.497"></a><span id="l6.497" class="difflineplus">+              hideCancelBut = !this.canCancel;</span>
<a href="#l6.498"></a><span id="l6.498" class="difflineplus">+              hideRetryBut = !this.canRetry;</span>
<a href="#l6.499"></a><span id="l6.499" class="difflineplus">+              hideProgressMeter = true;</span>
<a href="#l6.500"></a><span id="l6.500" class="difflineplus">+              statusText = this.text.waitingforretry;</span>
<a href="#l6.501"></a><span id="l6.501" class="difflineplus">+              break;</span>
<a href="#l6.502"></a><span id="l6.502" class="difflineplus">+          }</span>
<a href="#l6.503"></a><span id="l6.503" class="difflineplus">+</span>
<a href="#l6.504"></a><span id="l6.504" class="difflineplus">+          // Set the button visibility</span>
<a href="#l6.505"></a><span id="l6.505" class="difflineplus">+          this.setVisibility(&quot;button_cancel&quot;, !hideCancelBut);</span>
<a href="#l6.506"></a><span id="l6.506" class="difflineplus">+          this.setVisibility(&quot;button_retry&quot;, !hideRetryBut);</span>
<a href="#l6.507"></a><span id="l6.507" class="difflineplus">+          this.setVisibility(&quot;button_pause&quot;, !hidePauseBut);</span>
<a href="#l6.508"></a><span id="l6.508" class="difflineplus">+          this.setVisibility(&quot;button_resume&quot;, !hideResumeBut);</span>
<a href="#l6.509"></a><span id="l6.509" class="difflineplus">+          this.setVisibility(&quot;progressmeter&quot;, !hideProgressMeter);</span>
<a href="#l6.510"></a><span id="l6.510" class="difflineplus">+</span>
<a href="#l6.511"></a><span id="l6.511" class="difflineplus">+          // Update Status text and Display Text Areas</span>
<a href="#l6.512"></a><span id="l6.512" class="difflineplus">+          // In some states we need to modify Display Text area of</span>
<a href="#l6.513"></a><span id="l6.513" class="difflineplus">+          // the process (e.g. Failure).</span>
<a href="#l6.514"></a><span id="l6.514" class="difflineplus">+          this.displayText = displayText;</span>
<a href="#l6.515"></a><span id="l6.515" class="difflineplus">+          this.statusText = statusText;</span>
<a href="#l6.516"></a><span id="l6.516" class="difflineplus">+         ]]&gt;</span>
<a href="#l6.517"></a><span id="l6.517" class="difflineplus">+        &lt;/body&gt;</span>
<a href="#l6.518"></a><span id="l6.518" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l6.519"></a><span id="l6.519" class="difflineplus">+      &lt;method name=&quot;onProgressChanged&quot;&gt;</span>
<a href="#l6.520"></a><span id="l6.520" class="difflineplus">+        &lt;parameter name=&quot;aActivity&quot;/&gt;</span>
<a href="#l6.521"></a><span id="l6.521" class="difflineplus">+        &lt;parameter name=&quot;aStatusText&quot;/&gt;</span>
<a href="#l6.522"></a><span id="l6.522" class="difflineplus">+        &lt;parameter name=&quot;aWorkUnitsComplete&quot;/&gt;</span>
<a href="#l6.523"></a><span id="l6.523" class="difflineplus">+        &lt;parameter name=&quot;aTotalWorkUnits&quot;/&gt;</span>
<a href="#l6.524"></a><span id="l6.524" class="difflineplus">+        &lt;body&gt;</span>
<a href="#l6.525"></a><span id="l6.525" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.526"></a><span id="l6.526" class="difflineplus">+            let _percentComplete = 100.0 * aWorkUnitsComplete / aTotalWorkUnits;</span>
<a href="#l6.527"></a><span id="l6.527" class="difflineplus">+            document.getAnonymousElementByAttribute(this, &quot;anonid&quot;,&quot;progressmeter&quot;)</span>
<a href="#l6.528"></a><span id="l6.528" class="difflineplus">+                    .setAttribute('value', _percentComplete);</span>
<a href="#l6.529"></a><span id="l6.529" class="difflineplus">+            this.statusText = aStatusText;</span>
<a href="#l6.530"></a><span id="l6.530" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.531"></a><span id="l6.531" class="difflineplus">+        &lt;/body&gt;</span>
<a href="#l6.532"></a><span id="l6.532" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l6.533"></a><span id="l6.533" class="difflineplus">+      &lt;method name=&quot;onHandlerChanged&quot;&gt;</span>
<a href="#l6.534"></a><span id="l6.534" class="difflineplus">+        &lt;parameter name=&quot;aActivity&quot;/&gt;</span>
<a href="#l6.535"></a><span id="l6.535" class="difflineplus">+        &lt;body&gt;</span>
<a href="#l6.536"></a><span id="l6.536" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.537"></a><span id="l6.537" class="difflineplus">+            // update handler buttons' visibilities</span>
<a href="#l6.538"></a><span id="l6.538" class="difflineplus">+            let hideCancelBut = !this.canCancel;</span>
<a href="#l6.539"></a><span id="l6.539" class="difflineplus">+            let hidePauseBut = !this.canPause;</span>
<a href="#l6.540"></a><span id="l6.540" class="difflineplus">+            let hideRetryBut = !this.canRetry;</span>
<a href="#l6.541"></a><span id="l6.541" class="difflineplus">+</span>
<a href="#l6.542"></a><span id="l6.542" class="difflineplus">+            this.setVisibility(&quot;button_cancel&quot;, !hideCancelBut);</span>
<a href="#l6.543"></a><span id="l6.543" class="difflineplus">+            this.setVisibility(&quot;button_retry&quot;, !hideRetryBut);</span>
<a href="#l6.544"></a><span id="l6.544" class="difflineplus">+            if (hidePauseBut) {</span>
<a href="#l6.545"></a><span id="l6.545" class="difflineplus">+              this.setVisibility(&quot;button_pause&quot;, !hidePauseBut);</span>
<a href="#l6.546"></a><span id="l6.546" class="difflineplus">+              this.setVisibility(&quot;button_resume&quot;, !hideResumeBut);</span>
<a href="#l6.547"></a><span id="l6.547" class="difflineplus">+            }</span>
<a href="#l6.548"></a><span id="l6.548" class="difflineplus">+            else {</span>
<a href="#l6.549"></a><span id="l6.549" class="difflineplus">+              this.setVisibility(&quot;button_pause&quot;, this.paused);</span>
<a href="#l6.550"></a><span id="l6.550" class="difflineplus">+              this.setVisibility(&quot;button_resume&quot;, !this.paused);</span>
<a href="#l6.551"></a><span id="l6.551" class="difflineplus">+            }</span>
<a href="#l6.552"></a><span id="l6.552" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.553"></a><span id="l6.553" class="difflineplus">+        &lt;/body&gt;</span>
<a href="#l6.554"></a><span id="l6.554" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l6.555"></a><span id="l6.555" class="difflineplus">+      &lt;property name=&quot;paused&quot;&gt;</span>
<a href="#l6.556"></a><span id="l6.556" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.557"></a><span id="l6.557" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.558"></a><span id="l6.558" class="difflineplus">+          return parseInt(this.getAttribute(&quot;state&quot;)) ==</span>
<a href="#l6.559"></a><span id="l6.559" class="difflineplus">+            Components.interfaces.nsIActivityProcess.STATE_PAUSED;</span>
<a href="#l6.560"></a><span id="l6.560" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.561"></a><span id="l6.561" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.562"></a><span id="l6.562" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.563"></a><span id="l6.563" class="difflineplus">+      &lt;property name=&quot;waitingforinput&quot;&gt;</span>
<a href="#l6.564"></a><span id="l6.564" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.565"></a><span id="l6.565" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.566"></a><span id="l6.566" class="difflineplus">+          return parseInt(this.getAttribute(&quot;state&quot;)) ==</span>
<a href="#l6.567"></a><span id="l6.567" class="difflineplus">+            Components.interfaces.nsIActivityProcess.STATE_WAITINGFORINPUT;</span>
<a href="#l6.568"></a><span id="l6.568" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.569"></a><span id="l6.569" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.570"></a><span id="l6.570" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.571"></a><span id="l6.571" class="difflineplus">+      &lt;property name=&quot;waitingforretry&quot;&gt;</span>
<a href="#l6.572"></a><span id="l6.572" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.573"></a><span id="l6.573" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.574"></a><span id="l6.574" class="difflineplus">+          return parseInt(this.getAttribute(&quot;state&quot;)) ==</span>
<a href="#l6.575"></a><span id="l6.575" class="difflineplus">+            Components.interfaces.nsIActivityProcess.STATE_WAITINGFORRETRY;</span>
<a href="#l6.576"></a><span id="l6.576" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.577"></a><span id="l6.577" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.578"></a><span id="l6.578" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.579"></a><span id="l6.579" class="difflineplus">+    &lt;/implementation&gt;</span>
<a href="#l6.580"></a><span id="l6.580" class="difflineplus">+    &lt;content&gt;</span>
<a href="#l6.581"></a><span id="l6.581" class="difflineplus">+      &lt;xul:hbox flex=&quot;1&quot; class=&quot;activityContentBox&quot;&gt;</span>
<a href="#l6.582"></a><span id="l6.582" class="difflineplus">+        &lt;xul:vbox pack=&quot;center&quot; class=&quot;processIconBox&quot;&gt;</span>
<a href="#l6.583"></a><span id="l6.583" class="difflineplus">+          &lt;xul:image anonid=&quot;image&quot; xbl:inherits=&quot;class=iconclass&quot;/&gt;</span>
<a href="#l6.584"></a><span id="l6.584" class="difflineplus">+        &lt;/xul:vbox&gt;</span>
<a href="#l6.585"></a><span id="l6.585" class="difflineplus">+        &lt;xul:vbox flex=&quot;1&quot;&gt;</span>
<a href="#l6.586"></a><span id="l6.586" class="difflineplus">+          &lt;xul:label xbl:inherits=&quot;value=displayText,tooltiptext=displayTextTip&quot;</span>
<a href="#l6.587"></a><span id="l6.587" class="difflineplus">+                       crop=&quot;center&quot; flex=&quot;2&quot; class=&quot;displayText&quot;/&gt;</span>
<a href="#l6.588"></a><span id="l6.588" class="difflineplus">+          &lt;xul:hbox&gt;</span>
<a href="#l6.589"></a><span id="l6.589" class="difflineplus">+            &lt;xul:vbox flex=&quot;1&quot;&gt;</span>
<a href="#l6.590"></a><span id="l6.590" class="difflineplus">+              &lt;xul:progressmeter mode=&quot;normal&quot; value=&quot;0&quot; flex=&quot;1&quot;</span>
<a href="#l6.591"></a><span id="l6.591" class="difflineplus">+                                 anonid=&quot;progressmeter&quot;</span>
<a href="#l6.592"></a><span id="l6.592" class="difflineplus">+                                 xbl:inherits=&quot;value=progress,mode=progressmode&quot;/&gt;</span>
<a href="#l6.593"></a><span id="l6.593" class="difflineplus">+            &lt;/xul:vbox&gt;</span>
<a href="#l6.594"></a><span id="l6.594" class="difflineplus">+            &lt;xul:button class=&quot;resume mini-button&quot;</span>
<a href="#l6.595"></a><span id="l6.595" class="difflineplus">+                        tooltiptext=&quot;&amp;cmd.resume.label;&quot;</span>
<a href="#l6.596"></a><span id="l6.596" class="difflineplus">+                        anonid=&quot;button_resume&quot; cmd=&quot;cmd_resume&quot;</span>
<a href="#l6.597"></a><span id="l6.597" class="difflineplus">+                        ondblclick=&quot;event.stopPropagation();&quot;</span>
<a href="#l6.598"></a><span id="l6.598" class="difflineplus">+                        oncommand=&quot;activity.pauseHandler.resume(activity);&quot;/&gt;</span>
<a href="#l6.599"></a><span id="l6.599" class="difflineplus">+            &lt;xul:button class=&quot;pause mini-button&quot;</span>
<a href="#l6.600"></a><span id="l6.600" class="difflineplus">+                        tooltiptext=&quot;&amp;cmd.pause.label;&quot;</span>
<a href="#l6.601"></a><span id="l6.601" class="difflineplus">+                        anonid=&quot;button_pause&quot; cmd=&quot;cmd_pause&quot;</span>
<a href="#l6.602"></a><span id="l6.602" class="difflineplus">+                        ondblclick=&quot;event.stopPropagation();&quot;</span>
<a href="#l6.603"></a><span id="l6.603" class="difflineplus">+                        oncommand=&quot;activity.pauseHandler.pause(activity);&quot;/&gt;</span>
<a href="#l6.604"></a><span id="l6.604" class="difflineplus">+            &lt;xul:button class=&quot;retry mini-button&quot;</span>
<a href="#l6.605"></a><span id="l6.605" class="difflineplus">+                        tooltiptext=&quot;&amp;cmd.retry.label;&quot;</span>
<a href="#l6.606"></a><span id="l6.606" class="difflineplus">+                        anonid=&quot;button_retry&quot; cmd=&quot;cmd_retry&quot;</span>
<a href="#l6.607"></a><span id="l6.607" class="difflineplus">+                        ondblclick=&quot;event.stopPropagation();&quot;</span>
<a href="#l6.608"></a><span id="l6.608" class="difflineplus">+                        oncommand=&quot;activity.retryHandler.retry(activity);&quot;/&gt;</span>
<a href="#l6.609"></a><span id="l6.609" class="difflineplus">+            &lt;xul:button class=&quot;cancel mini-button&quot;</span>
<a href="#l6.610"></a><span id="l6.610" class="difflineplus">+                        tooltiptext=&quot;&amp;cmd.cancel.label;&quot;</span>
<a href="#l6.611"></a><span id="l6.611" class="difflineplus">+                        anonid=&quot;button_cancel&quot; cmd=&quot;cmd_cancel&quot;</span>
<a href="#l6.612"></a><span id="l6.612" class="difflineplus">+                        ondblclick=&quot;event.stopPropagation();&quot;</span>
<a href="#l6.613"></a><span id="l6.613" class="difflineplus">+                        oncommand=&quot;activity.cancelHandler.cancel(activity);&quot;/&gt;</span>
<a href="#l6.614"></a><span id="l6.614" class="difflineplus">+          &lt;/xul:hbox&gt;</span>
<a href="#l6.615"></a><span id="l6.615" class="difflineplus">+          &lt;xul:label xbl:inherits=&quot;value=statusText,tooltiptext=statusTextTip&quot;</span>
<a href="#l6.616"></a><span id="l6.616" class="difflineplus">+                     flex=&quot;1&quot; crop=&quot;right&quot; class=&quot;statusText&quot;/&gt;</span>
<a href="#l6.617"></a><span id="l6.617" class="difflineplus">+          &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l6.618"></a><span id="l6.618" class="difflineplus">+        &lt;/xul:vbox&gt;</span>
<a href="#l6.619"></a><span id="l6.619" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l6.620"></a><span id="l6.620" class="difflineplus">+    &lt;/content&gt;</span>
<a href="#l6.621"></a><span id="l6.621" class="difflineplus">+  &lt;/binding&gt;</span>
<a href="#l6.622"></a><span id="l6.622" class="difflineplus">+</span>
<a href="#l6.623"></a><span id="l6.623" class="difflineplus">+  &lt;binding id=&quot;activity-event&quot;</span>
<a href="#l6.624"></a><span id="l6.624" class="difflineplus">+           extends=&quot;chrome://messenger/content/activity.xml#activity-base&quot;&gt;</span>
<a href="#l6.625"></a><span id="l6.625" class="difflineplus">+    &lt;implementation&gt;</span>
<a href="#l6.626"></a><span id="l6.626" class="difflineplus">+      &lt;constructor&gt;</span>
<a href="#l6.627"></a><span id="l6.627" class="difflineplus">+       &lt;![CDATA[</span>
<a href="#l6.628"></a><span id="l6.628" class="difflineplus">+        // We need to make this casting here in order to access</span>
<a href="#l6.629"></a><span id="l6.629" class="difflineplus">+        // to nsIActivityEvent interface of the component from the the binding.</span>
<a href="#l6.630"></a><span id="l6.630" class="difflineplus">+        // We deliberately propogate the exceptions to the caller.</span>
<a href="#l6.631"></a><span id="l6.631" class="difflineplus">+        this._activity.QueryInterface(Components.interfaces.nsIActivityEvent);  </span>
<a href="#l6.632"></a><span id="l6.632" class="difflineplus">+</span>
<a href="#l6.633"></a><span id="l6.633" class="difflineplus">+        try {</span>
<a href="#l6.634"></a><span id="l6.634" class="difflineplus">+          this.displayText = this._activity.displayText;</span>
<a href="#l6.635"></a><span id="l6.635" class="difflineplus">+          this.statusText =  this._activity.statusText;</span>
<a href="#l6.636"></a><span id="l6.636" class="difflineplus">+          this.completionTime = this._activity.completionTime;</span>
<a href="#l6.637"></a><span id="l6.637" class="difflineplus">+          this.setVisibility(&quot;button_undo&quot;, this._activity.undoHandler);</span>
<a href="#l6.638"></a><span id="l6.638" class="difflineplus">+        }</span>
<a href="#l6.639"></a><span id="l6.639" class="difflineplus">+        catch(e) {</span>
<a href="#l6.640"></a><span id="l6.640" class="difflineplus">+          this.log.error(&quot;Exception constructing activity-event: &quot; + e);</span>
<a href="#l6.641"></a><span id="l6.641" class="difflineplus">+          throw(e)</span>
<a href="#l6.642"></a><span id="l6.642" class="difflineplus">+        }</span>
<a href="#l6.643"></a><span id="l6.643" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.644"></a><span id="l6.644" class="difflineplus">+      &lt;/constructor&gt;</span>
<a href="#l6.645"></a><span id="l6.645" class="difflineplus">+       &lt;property name=&quot;displayText&quot;&gt;</span>
<a href="#l6.646"></a><span id="l6.646" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.647"></a><span id="l6.647" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.648"></a><span id="l6.648" class="difflineplus">+            return this.getAttribute('displayText');</span>
<a href="#l6.649"></a><span id="l6.649" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.650"></a><span id="l6.650" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.651"></a><span id="l6.651" class="difflineplus">+        &lt;setter&gt;</span>
<a href="#l6.652"></a><span id="l6.652" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.653"></a><span id="l6.653" class="difflineplus">+            this.setAttribute('displayText', val);</span>
<a href="#l6.654"></a><span id="l6.654" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.655"></a><span id="l6.655" class="difflineplus">+        &lt;/setter&gt;</span>
<a href="#l6.656"></a><span id="l6.656" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.657"></a><span id="l6.657" class="difflineplus">+      &lt;property name=&quot;statusText&quot;&gt;</span>
<a href="#l6.658"></a><span id="l6.658" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.659"></a><span id="l6.659" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.660"></a><span id="l6.660" class="difflineplus">+            return this.getAttribute('statusText');</span>
<a href="#l6.661"></a><span id="l6.661" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.662"></a><span id="l6.662" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.663"></a><span id="l6.663" class="difflineplus">+        &lt;setter&gt;</span>
<a href="#l6.664"></a><span id="l6.664" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.665"></a><span id="l6.665" class="difflineplus">+            this.setAttribute('statusText', val);</span>
<a href="#l6.666"></a><span id="l6.666" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.667"></a><span id="l6.667" class="difflineplus">+        &lt;/setter&gt;</span>
<a href="#l6.668"></a><span id="l6.668" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.669"></a><span id="l6.669" class="difflineplus">+      &lt;property name=&quot;completionTime&quot;&gt;</span>
<a href="#l6.670"></a><span id="l6.670" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.671"></a><span id="l6.671" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.672"></a><span id="l6.672" class="difflineplus">+            return this.getAttribute('completionTime');</span>
<a href="#l6.673"></a><span id="l6.673" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.674"></a><span id="l6.674" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.675"></a><span id="l6.675" class="difflineplus">+        &lt;setter&gt;</span>
<a href="#l6.676"></a><span id="l6.676" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.677"></a><span id="l6.677" class="difflineplus">+            this.setAttribute(&quot;completionTime&quot;, this.formatTime(val));</span>
<a href="#l6.678"></a><span id="l6.678" class="difflineplus">+            this.setAttribute(&quot;completionTimeTip&quot;, this.formatTimeTip(val));</span>
<a href="#l6.679"></a><span id="l6.679" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.680"></a><span id="l6.680" class="difflineplus">+        &lt;/setter&gt;</span>
<a href="#l6.681"></a><span id="l6.681" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.682"></a><span id="l6.682" class="difflineplus">+      &lt;property name=&quot;canUndo&quot;&gt;</span>
<a href="#l6.683"></a><span id="l6.683" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.684"></a><span id="l6.684" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.685"></a><span id="l6.685" class="difflineplus">+          try {</span>
<a href="#l6.686"></a><span id="l6.686" class="difflineplus">+           return (this._activity.undoHandler != null);</span>
<a href="#l6.687"></a><span id="l6.687" class="difflineplus">+          }</span>
<a href="#l6.688"></a><span id="l6.688" class="difflineplus">+          catch(e) {</span>
<a href="#l6.689"></a><span id="l6.689" class="difflineplus">+            // In normal conditions, we shouldn't endup here. This can only</span>
<a href="#l6.690"></a><span id="l6.690" class="difflineplus">+            // happen if the XBL is orphan - associated activity has been</span>
<a href="#l6.691"></a><span id="l6.691" class="difflineplus">+            // deleted but XBL stays alive.</span>
<a href="#l6.692"></a><span id="l6.692" class="difflineplus">+          }</span>
<a href="#l6.693"></a><span id="l6.693" class="difflineplus">+          return false;</span>
<a href="#l6.694"></a><span id="l6.694" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.695"></a><span id="l6.695" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.696"></a><span id="l6.696" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.697"></a><span id="l6.697" class="difflineplus">+      &lt;method name=&quot;onHandlerChanged&quot;&gt;</span>
<a href="#l6.698"></a><span id="l6.698" class="difflineplus">+        &lt;parameter name=&quot;aActivity&quot;/&gt;</span>
<a href="#l6.699"></a><span id="l6.699" class="difflineplus">+        &lt;body&gt;</span>
<a href="#l6.700"></a><span id="l6.700" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.701"></a><span id="l6.701" class="difflineplus">+            // update handler button's visibility</span>
<a href="#l6.702"></a><span id="l6.702" class="difflineplus">+            this.setVisibility(&quot;button_undo&quot;, this.canUndo);</span>
<a href="#l6.703"></a><span id="l6.703" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.704"></a><span id="l6.704" class="difflineplus">+        &lt;/body&gt;</span>
<a href="#l6.705"></a><span id="l6.705" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l6.706"></a><span id="l6.706" class="difflineplus">+    &lt;/implementation&gt;</span>
<a href="#l6.707"></a><span id="l6.707" class="difflineplus">+    &lt;content&gt;</span>
<a href="#l6.708"></a><span id="l6.708" class="difflineplus">+      &lt;xul:hbox flex=&quot;1&quot;&gt;</span>
<a href="#l6.709"></a><span id="l6.709" class="difflineplus">+        &lt;xul:vbox pack=&quot;center&quot; class=&quot;eventIconBox&quot;&gt;</span>
<a href="#l6.710"></a><span id="l6.710" class="difflineplus">+          &lt;xul:image anonid=&quot;image&quot; xbl:inherits=&quot;class=iconclass&quot;/&gt;</span>
<a href="#l6.711"></a><span id="l6.711" class="difflineplus">+        &lt;/xul:vbox&gt;</span>
<a href="#l6.712"></a><span id="l6.712" class="difflineplus">+        &lt;xul:vbox pack=&quot;start&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l6.713"></a><span id="l6.713" class="difflineplus">+          &lt;xul:hbox align=&quot;center&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l6.714"></a><span id="l6.714" class="difflineplus">+            &lt;xul:label xbl:inherits=&quot;value=displayText,tooltiptext=displayTextTip&quot;</span>
<a href="#l6.715"></a><span id="l6.715" class="difflineplus">+                       crop=&quot;center&quot; flex=&quot;1&quot; class=&quot;displayText&quot;/&gt;</span>
<a href="#l6.716"></a><span id="l6.716" class="difflineplus">+            &lt;xul:label xbl:inherits=&quot;value=completionTime,tooltiptext=completionTimeTip&quot;</span>
<a href="#l6.717"></a><span id="l6.717" class="difflineplus">+                       class=&quot;dateTime&quot;/&gt;</span>
<a href="#l6.718"></a><span id="l6.718" class="difflineplus">+          &lt;/xul:hbox&gt;</span>
<a href="#l6.719"></a><span id="l6.719" class="difflineplus">+          &lt;xul:hbox align=&quot;center&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l6.720"></a><span id="l6.720" class="difflineplus">+            &lt;xul:label xbl:inherits=&quot;value=statusText,tooltiptext=statusTextTip&quot;</span>
<a href="#l6.721"></a><span id="l6.721" class="difflineplus">+                       crop=&quot;end&quot; flex=&quot;1&quot; class=&quot;statusText&quot;/&gt;</span>
<a href="#l6.722"></a><span id="l6.722" class="difflineplus">+            &lt;xul:button class=&quot;undo mini-button&quot; tooltiptext=&quot;&amp;cmd.undo.label;&quot;</span>
<a href="#l6.723"></a><span id="l6.723" class="difflineplus">+                        anonid=&quot;button_undo&quot; cmd=&quot;cmd_undo&quot;</span>
<a href="#l6.724"></a><span id="l6.724" class="difflineplus">+                        ondblclick=&quot;event.stopPropagation();&quot;</span>
<a href="#l6.725"></a><span id="l6.725" class="difflineplus">+                        oncommand=&quot;activity.undoHandler.undo(activity);&quot;/&gt;</span>
<a href="#l6.726"></a><span id="l6.726" class="difflineplus">+          &lt;/xul:hbox&gt;</span>
<a href="#l6.727"></a><span id="l6.727" class="difflineplus">+         &lt;/xul:vbox&gt;</span>
<a href="#l6.728"></a><span id="l6.728" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l6.729"></a><span id="l6.729" class="difflineplus">+    &lt;/content&gt;</span>
<a href="#l6.730"></a><span id="l6.730" class="difflineplus">+  &lt;/binding&gt;</span>
<a href="#l6.731"></a><span id="l6.731" class="difflineplus">+  </span>
<a href="#l6.732"></a><span id="l6.732" class="difflineplus">+  &lt;binding id=&quot;activity-warning&quot;</span>
<a href="#l6.733"></a><span id="l6.733" class="difflineplus">+           extends=&quot;chrome://messenger/content/activity.xml#activity-base&quot;&gt;</span>
<a href="#l6.734"></a><span id="l6.734" class="difflineplus">+    &lt;implementation&gt;</span>
<a href="#l6.735"></a><span id="l6.735" class="difflineplus">+      &lt;constructor&gt;</span>
<a href="#l6.736"></a><span id="l6.736" class="difflineplus">+       &lt;![CDATA[</span>
<a href="#l6.737"></a><span id="l6.737" class="difflineplus">+         </span>
<a href="#l6.738"></a><span id="l6.738" class="difflineplus">+        // We need to make this casting here in order to access to</span>
<a href="#l6.739"></a><span id="l6.739" class="difflineplus">+        // nsIActivityWarning interface of the component from the the binding.</span>
<a href="#l6.740"></a><span id="l6.740" class="difflineplus">+        // We deliberately propogate the exceptions to the caller.</span>
<a href="#l6.741"></a><span id="l6.741" class="difflineplus">+        this._activity.QueryInterface(Components.interfaces.nsIActivityWarning);</span>
<a href="#l6.742"></a><span id="l6.742" class="difflineplus">+         </span>
<a href="#l6.743"></a><span id="l6.743" class="difflineplus">+        try {</span>
<a href="#l6.744"></a><span id="l6.744" class="difflineplus">+          this.displayText = this._activity.displayText;</span>
<a href="#l6.745"></a><span id="l6.745" class="difflineplus">+          this.dateTime = this._activity.time;</span>
<a href="#l6.746"></a><span id="l6.746" class="difflineplus">+          this.recoveryTipText =  this._activity.recoveryTipText;</span>
<a href="#l6.747"></a><span id="l6.747" class="difflineplus">+          this.setVisibility(&quot;button_recover&quot;, this._activity.recoveryHandler);</span>
<a href="#l6.748"></a><span id="l6.748" class="difflineplus">+        }</span>
<a href="#l6.749"></a><span id="l6.749" class="difflineplus">+        catch(e) {</span>
<a href="#l6.750"></a><span id="l6.750" class="difflineplus">+          this.log.error(&quot;Exception constructing activity-warning: &quot; + e);</span>
<a href="#l6.751"></a><span id="l6.751" class="difflineplus">+          throw(e)</span>
<a href="#l6.752"></a><span id="l6.752" class="difflineplus">+        }</span>
<a href="#l6.753"></a><span id="l6.753" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.754"></a><span id="l6.754" class="difflineplus">+      &lt;/constructor&gt;</span>
<a href="#l6.755"></a><span id="l6.755" class="difflineplus">+       &lt;property name=&quot;displayText&quot;&gt;</span>
<a href="#l6.756"></a><span id="l6.756" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.757"></a><span id="l6.757" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.758"></a><span id="l6.758" class="difflineplus">+            return this.getAttribute('displayText');</span>
<a href="#l6.759"></a><span id="l6.759" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.760"></a><span id="l6.760" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.761"></a><span id="l6.761" class="difflineplus">+        &lt;setter&gt;</span>
<a href="#l6.762"></a><span id="l6.762" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.763"></a><span id="l6.763" class="difflineplus">+            this.setAttribute('displayText', val);</span>
<a href="#l6.764"></a><span id="l6.764" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.765"></a><span id="l6.765" class="difflineplus">+        &lt;/setter&gt;</span>
<a href="#l6.766"></a><span id="l6.766" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.767"></a><span id="l6.767" class="difflineplus">+      &lt;property name=&quot;recoveryTipText&quot;&gt;</span>
<a href="#l6.768"></a><span id="l6.768" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.769"></a><span id="l6.769" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.770"></a><span id="l6.770" class="difflineplus">+            return this.getAttribute('recoveryTipText');</span>
<a href="#l6.771"></a><span id="l6.771" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.772"></a><span id="l6.772" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.773"></a><span id="l6.773" class="difflineplus">+        &lt;setter&gt;</span>
<a href="#l6.774"></a><span id="l6.774" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.775"></a><span id="l6.775" class="difflineplus">+            this.setAttribute('recoveryTipText', val);</span>
<a href="#l6.776"></a><span id="l6.776" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.777"></a><span id="l6.777" class="difflineplus">+        &lt;/setter&gt;</span>
<a href="#l6.778"></a><span id="l6.778" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.779"></a><span id="l6.779" class="difflineplus">+      &lt;property name=&quot;dateTime&quot;&gt;</span>
<a href="#l6.780"></a><span id="l6.780" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.781"></a><span id="l6.781" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.782"></a><span id="l6.782" class="difflineplus">+            return this.getAttribute('dateTime');</span>
<a href="#l6.783"></a><span id="l6.783" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.784"></a><span id="l6.784" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.785"></a><span id="l6.785" class="difflineplus">+        &lt;setter&gt;</span>
<a href="#l6.786"></a><span id="l6.786" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.787"></a><span id="l6.787" class="difflineplus">+            this.setAttribute('dateTime', this.formatTime(val));</span>
<a href="#l6.788"></a><span id="l6.788" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.789"></a><span id="l6.789" class="difflineplus">+        &lt;/setter&gt;</span>
<a href="#l6.790"></a><span id="l6.790" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.791"></a><span id="l6.791" class="difflineplus">+      &lt;property name=&quot;canRecover&quot;&gt;</span>
<a href="#l6.792"></a><span id="l6.792" class="difflineplus">+        &lt;getter&gt;</span>
<a href="#l6.793"></a><span id="l6.793" class="difflineplus">+        &lt;![CDATA[</span>
<a href="#l6.794"></a><span id="l6.794" class="difflineplus">+          try {</span>
<a href="#l6.795"></a><span id="l6.795" class="difflineplus">+           return (this._activity.recoveryHandler != null);</span>
<a href="#l6.796"></a><span id="l6.796" class="difflineplus">+          }</span>
<a href="#l6.797"></a><span id="l6.797" class="difflineplus">+          catch(e) {</span>
<a href="#l6.798"></a><span id="l6.798" class="difflineplus">+            // In normal conditions, we shouldn't endup here. This can only</span>
<a href="#l6.799"></a><span id="l6.799" class="difflineplus">+            // happen if the XBL is orphan - associated activity has been</span>
<a href="#l6.800"></a><span id="l6.800" class="difflineplus">+            // deleted but XBL stays alive.</span>
<a href="#l6.801"></a><span id="l6.801" class="difflineplus">+          }</span>
<a href="#l6.802"></a><span id="l6.802" class="difflineplus">+          return false;</span>
<a href="#l6.803"></a><span id="l6.803" class="difflineplus">+        ]]&gt;</span>
<a href="#l6.804"></a><span id="l6.804" class="difflineplus">+        &lt;/getter&gt;</span>
<a href="#l6.805"></a><span id="l6.805" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l6.806"></a><span id="l6.806" class="difflineplus">+      &lt;method name=&quot;onHandlerChanged&quot;&gt;</span>
<a href="#l6.807"></a><span id="l6.807" class="difflineplus">+        &lt;parameter name=&quot;aActivity&quot;/&gt;</span>
<a href="#l6.808"></a><span id="l6.808" class="difflineplus">+        &lt;body&gt;</span>
<a href="#l6.809"></a><span id="l6.809" class="difflineplus">+          &lt;![CDATA[</span>
<a href="#l6.810"></a><span id="l6.810" class="difflineplus">+            // update handler button's visibility</span>
<a href="#l6.811"></a><span id="l6.811" class="difflineplus">+            this.setVisibility(&quot;button_recover&quot;, this.canRecover);</span>
<a href="#l6.812"></a><span id="l6.812" class="difflineplus">+          ]]&gt;</span>
<a href="#l6.813"></a><span id="l6.813" class="difflineplus">+        &lt;/body&gt;</span>
<a href="#l6.814"></a><span id="l6.814" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l6.815"></a><span id="l6.815" class="difflineplus">+    &lt;/implementation&gt;</span>
<a href="#l6.816"></a><span id="l6.816" class="difflineplus">+    &lt;content&gt;</span>
<a href="#l6.817"></a><span id="l6.817" class="difflineplus">+      &lt;xul:hbox flex=&quot;1&quot;&gt;</span>
<a href="#l6.818"></a><span id="l6.818" class="difflineplus">+        &lt;xul:vbox pack=&quot;center&quot; class=&quot;warningIconBox&quot;&gt;</span>
<a href="#l6.819"></a><span id="l6.819" class="difflineplus">+          &lt;xul:image anonid=&quot;image&quot;/&gt;</span>
<a href="#l6.820"></a><span id="l6.820" class="difflineplus">+        &lt;/xul:vbox&gt;</span>
<a href="#l6.821"></a><span id="l6.821" class="difflineplus">+        &lt;xul:vbox pack=&quot;start&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l6.822"></a><span id="l6.822" class="difflineplus">+          &lt;xul:hbox align=&quot;center&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l6.823"></a><span id="l6.823" class="difflineplus">+            &lt;xul:label xbl:inherits=&quot;value=displayText,tooltiptext=displayTextTip&quot;</span>
<a href="#l6.824"></a><span id="l6.824" class="difflineplus">+                       crop=&quot;center&quot; flex=&quot;1&quot; class=&quot;displayText&quot;/&gt;</span>
<a href="#l6.825"></a><span id="l6.825" class="difflineplus">+            &lt;xul:label xbl:inherits=&quot;value=dateTime,tooltiptext=dateTimeTip&quot;</span>
<a href="#l6.826"></a><span id="l6.826" class="difflineplus">+                       class=&quot;dateTime&quot;/&gt;</span>
<a href="#l6.827"></a><span id="l6.827" class="difflineplus">+            &lt;xul:button class=&quot;recover mini-button&quot; tooltiptext=&quot;&amp;cmd.recover.label;&quot;</span>
<a href="#l6.828"></a><span id="l6.828" class="difflineplus">+                        anonid=&quot;button_recover&quot; cmd=&quot;cmd_recover&quot;</span>
<a href="#l6.829"></a><span id="l6.829" class="difflineplus">+                        ondblclick=&quot;event.stopPropagation();&quot;</span>
<a href="#l6.830"></a><span id="l6.830" class="difflineplus">+                        oncommand=&quot;activity.recoveryHandler.recover(activity);&quot;/&gt;</span>
<a href="#l6.831"></a><span id="l6.831" class="difflineplus">+          &lt;/xul:hbox&gt;</span>
<a href="#l6.832"></a><span id="l6.832" class="difflineplus">+          &lt;xul:hbox align=&quot;center&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l6.833"></a><span id="l6.833" class="difflineplus">+            &lt;xul:label xbl:inherits=&quot;value=recoveryTipText,tooltiptext=recoveryTipTextTip&quot;</span>
<a href="#l6.834"></a><span id="l6.834" class="difflineplus">+                       crop=&quot;end&quot; flex=&quot;1&quot; class=&quot;statusText&quot;/&gt;</span>
<a href="#l6.835"></a><span id="l6.835" class="difflineplus">+          &lt;/xul:hbox&gt;</span>
<a href="#l6.836"></a><span id="l6.836" class="difflineplus">+        &lt;/xul:vbox&gt;</span>
<a href="#l6.837"></a><span id="l6.837" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l6.838"></a><span id="l6.838" class="difflineplus">+    &lt;/content&gt;</span>
<a href="#l6.839"></a><span id="l6.839" class="difflineplus">+  &lt;/binding&gt;</span>
<a href="#l6.840"></a><span id="l6.840" class="difflineplus">+&lt;/bindings&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">new file mode 100644</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineminus">--- /dev/null</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineplus">+++ b/mail/components/activity/content/activity.xul</span>
<a href="#l7.4"></a><span id="l7.4" class="difflineat">@@ -0,0 +1,139 @@</span>
<a href="#l7.5"></a><span id="l7.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l7.6"></a><span id="l7.6" class="difflineplus">+</span>
<a href="#l7.7"></a><span id="l7.7" class="difflineplus">+# -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l7.8"></a><span id="l7.8" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineplus">+#</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+#</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+# License.</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+#</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+# The Original Code is Mozilla.org Code.</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+#</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineplus">+# Netscape Communications Corporation.</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2001</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+#</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineplus">+# Contributor(s):</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineplus">+#   Ben Goodger &lt;ben@bengoodger.com&gt; (v2.0)</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineplus">+#   Blake Ross &lt;blakeross@telocity.com&gt;</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineplus">+#   Shawn Wilsher &lt;me@shawnwilsher.com&gt; (v3.0)</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+#   Edward Lee &lt;edward.lee@engineering.uiuc.edu&gt;</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineplus">+#   David Ascher &lt;dascher@mozillamessaging.com&gt; (activity mgr)</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+#   Emre Birol &lt;emrebirol@gmail.com&gt;</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineplus">+#</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l7.47"></a><span id="l7.47" class="difflineplus">+#</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineplus">+</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineplus">+#ifdef XP_UNIX</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineplus">+#ifndef XP_MACOSX</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineplus">+#define XP_GNOME 1</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineplus">+#endif</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineplus">+#endif</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineplus">+</span>
<a href="#l7.56"></a><span id="l7.56" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l7.57"></a><span id="l7.57" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/content/activityBinding.css&quot;?&gt;</span>
<a href="#l7.58"></a><span id="l7.58" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/activity/activity.css&quot;?&gt;</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineplus">+</span>
<a href="#l7.60"></a><span id="l7.60" class="difflineplus">+&lt;!DOCTYPE window [</span>
<a href="#l7.61"></a><span id="l7.61" class="difflineplus">+&lt;!ENTITY % activityManagerDTD SYSTEM &quot;chrome://messenger/locale/activity.dtd&quot;&gt;</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineplus">+%activityManagerDTD;</span>
<a href="#l7.63"></a><span id="l7.63" class="difflineplus">+&lt;!ENTITY % editMenuOverlayDTD SYSTEM</span>
<a href="#l7.64"></a><span id="l7.64" class="difflineplus">+&quot;chrome://global/locale/editMenuOverlay.dtd&quot;&gt;</span>
<a href="#l7.65"></a><span id="l7.65" class="difflineplus">+%editMenuOverlayDTD;</span>
<a href="#l7.66"></a><span id="l7.66" class="difflineplus">+]&gt;</span>
<a href="#l7.67"></a><span id="l7.67" class="difflineplus">+</span>
<a href="#l7.68"></a><span id="l7.68" class="difflineplus">+&lt;window xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l7.69"></a><span id="l7.69" class="difflineplus">+        id=&quot;activityManager&quot; windowtype=&quot;Activity:Manager&quot;</span>
<a href="#l7.70"></a><span id="l7.70" class="difflineplus">+        orient=&quot;vertical&quot; title=&quot;&amp;activity.title;&quot;</span>
<a href="#l7.71"></a><span id="l7.71" class="difflineplus">+        statictitle=&quot;&amp;activity.title;&quot;</span>
<a href="#l7.72"></a><span id="l7.72" class="difflineplus">+        width=&quot;&amp;window.width2;&quot; height=&quot;&amp;window.height;&quot;</span>
<a href="#l7.73"></a><span id="l7.73" class="difflineplus">+        screenX=&quot;10&quot; screenY=&quot;10&quot;</span>
<a href="#l7.74"></a><span id="l7.74" class="difflineplus">+        persist=&quot;width height screenX screenY sizemode&quot;</span>
<a href="#l7.75"></a><span id="l7.75" class="difflineplus">+        onload=&quot;Startup();&quot; onunload=&quot;Shutdown();&quot;</span>
<a href="#l7.76"></a><span id="l7.76" class="difflineplus">+        onclose=&quot;return closeWindow(false);&quot;&gt;</span>
<a href="#l7.77"></a><span id="l7.77" class="difflineplus">+      </span>
<a href="#l7.78"></a><span id="l7.78" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l7.79"></a><span id="l7.79" class="difflineplus">+          src=&quot;chrome://messenger/content/activity.js&quot;/&gt;</span>
<a href="#l7.80"></a><span id="l7.80" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l7.81"></a><span id="l7.81" class="difflineplus">+          src=&quot;chrome://global/content/contentAreaUtils.js&quot;/&gt;</span>
<a href="#l7.82"></a><span id="l7.82" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l7.83"></a><span id="l7.83" class="difflineplus">+          src=&quot;chrome://global/content/nsDragAndDrop.js&quot;/&gt;</span>
<a href="#l7.84"></a><span id="l7.84" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l7.85"></a><span id="l7.85" class="difflineplus">+          src=&quot;chrome://global/content/globalOverlay.js&quot;/&gt;</span>
<a href="#l7.86"></a><span id="l7.86" class="difflineplus">+  </span>
<a href="#l7.87"></a><span id="l7.87" class="difflineplus">+  &lt;stringbundleset id=&quot;activitySet&quot;&gt;</span>
<a href="#l7.88"></a><span id="l7.88" class="difflineplus">+    &lt;stringbundle id=&quot;brandStrings&quot;</span>
<a href="#l7.89"></a><span id="l7.89" class="difflineplus">+                  src=&quot;chrome://branding/locale/brand.properties&quot;/&gt;</span>
<a href="#l7.90"></a><span id="l7.90" class="difflineplus">+    &lt;stringbundle id=&quot;activityStrings&quot;</span>
<a href="#l7.91"></a><span id="l7.91" class="difflineplus">+                  src=&quot;chrome://messenger/locale/activity.properties&quot;/&gt;</span>
<a href="#l7.92"></a><span id="l7.92" class="difflineplus">+  &lt;/stringbundleset&gt;</span>
<a href="#l7.93"></a><span id="l7.93" class="difflineplus">+</span>
<a href="#l7.94"></a><span id="l7.94" class="difflineplus">+  &lt;!-- Use this commandset for command which do not depend on focus or</span>
<a href="#l7.95"></a><span id="l7.95" class="difflineplus">+       selection --&gt;</span>
<a href="#l7.96"></a><span id="l7.96" class="difflineplus">+  &lt;commandset id=&quot;generalCommands&quot;&gt;</span>
<a href="#l7.97"></a><span id="l7.97" class="difflineplus">+    &lt;command id=&quot;cmd_selectAllActivities&quot;</span>
<a href="#l7.98"></a><span id="l7.98" class="difflineplus">+             oncommand=&quot;gActivitiesView.selectAll();&quot;/&gt;</span>
<a href="#l7.99"></a><span id="l7.99" class="difflineplus">+    &lt;command id=&quot;cmd_clearList&quot; oncommand=&quot;clearActivityList();&quot;/&gt;</span>
<a href="#l7.100"></a><span id="l7.100" class="difflineplus">+  &lt;/commandset&gt;</span>
<a href="#l7.101"></a><span id="l7.101" class="difflineplus">+</span>
<a href="#l7.102"></a><span id="l7.102" class="difflineplus">+  &lt;keyset id=&quot;activityKeys&quot;&gt;</span>
<a href="#l7.103"></a><span id="l7.103" class="difflineplus">+    &lt;key id=&quot;key_removeFromList&quot;  keycode=&quot;VK_DELETE&quot;</span>
<a href="#l7.104"></a><span id="l7.104" class="difflineplus">+         oncommand=&quot;performCommand('cmd_removeFromList');&quot;/&gt;</span>
<a href="#l7.105"></a><span id="l7.105" class="difflineplus">+#ifdef XP_MACOSX</span>
<a href="#l7.106"></a><span id="l7.106" class="difflineplus">+    &lt;key id=&quot;key_removeFromList2&quot; keycode=&quot;VK_BACK&quot;</span>
<a href="#l7.107"></a><span id="l7.107" class="difflineplus">+         oncommand=&quot;performCommand('cmd_removeFromList');&quot;/&gt;</span>
<a href="#l7.108"></a><span id="l7.108" class="difflineplus">+#endif</span>
<a href="#l7.109"></a><span id="l7.109" class="difflineplus">+    &lt;key id=&quot;key_close&quot; key=&quot;&amp;cmd.close.commandkey;&quot;</span>
<a href="#l7.110"></a><span id="l7.110" class="difflineplus">+         oncommand=&quot;closeWindow(true);&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l7.111"></a><span id="l7.111" class="difflineplus">+#ifdef XP_GNOME</span>
<a href="#l7.112"></a><span id="l7.112" class="difflineplus">+    &lt;key id=&quot;key_close2&quot; key=&quot;&amp;cmd.close2Unix.commandkey;&quot;</span>
<a href="#l7.113"></a><span id="l7.113" class="difflineplus">+         oncommand=&quot;closeWindow(true);&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l7.114"></a><span id="l7.114" class="difflineplus">+#else</span>
<a href="#l7.115"></a><span id="l7.115" class="difflineplus">+    &lt;key id=&quot;key_close2&quot; key=&quot;&amp;cmd.close2.commandkey;&quot;</span>
<a href="#l7.116"></a><span id="l7.116" class="difflineplus">+         oncommand=&quot;closeWindow(true);&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l7.117"></a><span id="l7.117" class="difflineplus">+#endif</span>
<a href="#l7.118"></a><span id="l7.118" class="difflineplus">+    &lt;key keycode=&quot;VK_ESCAPE&quot; oncommand=&quot;closeWindow(true);&quot;/&gt;</span>
<a href="#l7.119"></a><span id="l7.119" class="difflineplus">+</span>
<a href="#l7.120"></a><span id="l7.120" class="difflineplus">+    &lt;key id=&quot;key_selectAllActivities&quot; key=&quot;&amp;selectAllCmd.key;&quot; modifiers=&quot;accel&quot;</span>
<a href="#l7.121"></a><span id="l7.121" class="difflineplus">+         command=&quot;cmd_selectAllActivities&quot;/&gt;</span>
<a href="#l7.122"></a><span id="l7.122" class="difflineplus">+  &lt;/keyset&gt;</span>
<a href="#l7.123"></a><span id="l7.123" class="difflineplus">+  </span>
<a href="#l7.124"></a><span id="l7.124" class="difflineplus">+  &lt;vbox id=&quot;contextMenuPalette&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l7.125"></a><span id="l7.125" class="difflineplus">+    &lt;menuitem id=&quot;menuitem_selectAll&quot; label=&quot;&amp;selectAllCmd.label;&quot;</span>
<a href="#l7.126"></a><span id="l7.126" class="difflineplus">+              accesskey=&quot;&amp;selectAllCmd.accesskey;&quot;</span>
<a href="#l7.127"></a><span id="l7.127" class="difflineplus">+              command=&quot;cmd_selectAllActivities&quot;/&gt;</span>
<a href="#l7.128"></a><span id="l7.128" class="difflineplus">+  &lt;/vbox&gt;</span>
<a href="#l7.129"></a><span id="l7.129" class="difflineplus">+  </span>
<a href="#l7.130"></a><span id="l7.130" class="difflineplus">+</span>
<a href="#l7.131"></a><span id="l7.131" class="difflineplus">+  &lt;richlistbox id=&quot;activityView&quot; class=&quot;activityview&quot; seltype=&quot;multiple&quot;</span>
<a href="#l7.132"></a><span id="l7.132" class="difflineplus">+               flex=&quot;1&quot; onkeypress=&quot;processKeyEvent(event)&quot;&gt;</span>
<a href="#l7.133"></a><span id="l7.133" class="difflineplus">+  &lt;/richlistbox&gt;</span>
<a href="#l7.134"></a><span id="l7.134" class="difflineplus">+</span>
<a href="#l7.135"></a><span id="l7.135" class="difflineplus">+  &lt;hbox id=&quot;search&quot; align=&quot;center&quot;&gt;</span>
<a href="#l7.136"></a><span id="l7.136" class="difflineplus">+    &lt;button id=&quot;clearListButton&quot; command=&quot;cmd_clearList&quot;</span>
<a href="#l7.137"></a><span id="l7.137" class="difflineplus">+            label=&quot;&amp;cmd.clearList.label;&quot;</span>
<a href="#l7.138"></a><span id="l7.138" class="difflineplus">+            accesskey=&quot;&amp;cmd.clearList.accesskey;&quot;</span>
<a href="#l7.139"></a><span id="l7.139" class="difflineplus">+            tooltiptext=&quot;&amp;cmd.clearList.tooltip;&quot;/&gt;</span>
<a href="#l7.140"></a><span id="l7.140" class="difflineplus">+    &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l7.141"></a><span id="l7.141" class="difflineplus">+  &lt;/hbox&gt;</span>
<a href="#l7.142"></a><span id="l7.142" class="difflineplus">+</span>
<a href="#l7.143"></a><span id="l7.143" class="difflineplus">+&lt;/window&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1">new file mode 100644</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineminus">--- /dev/null</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineplus">+++ b/mail/components/activity/content/activityBinding.css</span>
<a href="#l8.4"></a><span id="l8.4" class="difflineat">@@ -0,0 +1,60 @@</span>
<a href="#l8.5"></a><span id="l8.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l8.6"></a><span id="l8.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l8.7"></a><span id="l8.7" class="difflineplus">+ *</span>
<a href="#l8.8"></a><span id="l8.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l8.9"></a><span id="l8.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l8.11"></a><span id="l8.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+ *</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+ * License.</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+ *</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+ * The Original Code is mozilla.org code.</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+ *</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+ * The Initial Developer of the Original Code is Mozilla Messaging, Inc.</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+ *</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineplus">+ * Contributor(s):</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineplus">+ *  Emre Birol  &lt;ebirol@gmail.com&gt; (Original Author)</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineplus">+ *  David Ascher &lt;dascher@mozillamessaging.com&gt;</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineplus">+ *</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineplus">+ *</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineplus">+</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineplus">+/* Activity Management System Bindings */</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineplus">+</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineplus">+activity-group {</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineplus">+  -moz-binding: url('chrome://messenger/content/activity.xml#activity-group');</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineplus">+}</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineplus">+</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineplus">+activity-process {</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineplus">+  -moz-binding: url('chrome://messenger/content/activity.xml#activity-process');</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineplus">+}</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineplus">+activity-event {</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineplus">+  -moz-binding: url('chrome://messenger/content/activity.xml#activity-event');</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineplus">+}</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineplus">+</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineplus">+activity-warning {</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineplus">+  -moz-binding: url('chrome://messenger/content/activity.xml#activity-warning');</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineplus">+}</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineplus">+</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineplus">+/* Only focus buttons in the selected item */</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineplus">+</span>
<a href="#l8.62"></a><span id="l8.62" class="difflineplus">+activity-process:not([selected=&quot;true&quot;]) button {</span>
<a href="#l8.63"></a><span id="l8.63" class="difflineplus">+  -moz-user-focus: none;</span>
<a href="#l8.64"></a><span id="l8.64" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1">new file mode 100644</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineminus">--- /dev/null</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineplus">+++ b/mail/components/activity/jar.mn</span>
<a href="#l9.4"></a><span id="l9.4" class="difflineat">@@ -0,0 +1,6 @@</span>
<a href="#l9.5"></a><span id="l9.5" class="difflineplus">+messenger.jar:</span>
<a href="#l9.6"></a><span id="l9.6" class="difflineplus">+  content/messenger/activity.js (content/activity.js)</span>
<a href="#l9.7"></a><span id="l9.7" class="difflineplus">+* content/messenger/activity.xul (content/activity.xul)</span>
<a href="#l9.8"></a><span id="l9.8" class="difflineplus">+* content/messenger/activity.xml (content/activity.xml)</span>
<a href="#l9.9"></a><span id="l9.9" class="difflineplus">+  content/messenger/activityBinding.css (content/activityBinding.css)</span>
<a href="#l9.10"></a><span id="l9.10" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">new file mode 100644</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineminus">--- /dev/null</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineplus">+++ b/mail/components/activity/nsActivity.js</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineat">@@ -0,0 +1,388 @@</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l10.6"></a><span id="l10.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l10.7"></a><span id="l10.7" class="difflineplus">+ *</span>
<a href="#l10.8"></a><span id="l10.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+ *</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineplus">+ * License.</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineplus">+ *</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineplus">+ * The Original Code is mozilla.org code.</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineplus">+ *</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineplus">+ * Shawn Wilsher &lt;me@shawnwilsher.com&gt;.</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2007</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineplus">+ *</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineplus">+ *  Emre Birol &lt;ebirol@gmail.com&gt;</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineplus">+ *  David Ascher &lt;dascher@mozillamessaging.com&gt;</span>
<a href="#l10.28"></a><span id="l10.28" class="difflineplus">+ *</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l10.33"></a><span id="l10.33" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l10.35"></a><span id="l10.35" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l10.36"></a><span id="l10.36" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l10.37"></a><span id="l10.37" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l10.38"></a><span id="l10.38" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l10.39"></a><span id="l10.39" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l10.40"></a><span id="l10.40" class="difflineplus">+ *</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l10.42"></a><span id="l10.42" class="difflineplus">+</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineplus">+Components.utils.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineplus">+</span>
<a href="#l10.46"></a><span id="l10.46" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.47"></a><span id="l10.47" class="difflineplus">+//// Constants</span>
<a href="#l10.48"></a><span id="l10.48" class="difflineplus">+</span>
<a href="#l10.49"></a><span id="l10.49" class="difflineplus">+const Cc = Components.classes;</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineplus">+const Ci = Components.interfaces;</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineplus">+const Cr = Components.results;</span>
<a href="#l10.52"></a><span id="l10.52" class="difflineplus">+</span>
<a href="#l10.53"></a><span id="l10.53" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.54"></a><span id="l10.54" class="difflineplus">+//// Base class for nsActivityProcess and nsActivityEvent objects</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineplus">+</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineplus">+function nsActivity()</span>
<a href="#l10.57"></a><span id="l10.57" class="difflineplus">+{</span>
<a href="#l10.58"></a><span id="l10.58" class="difflineplus">+  this._initLogging();</span>
<a href="#l10.59"></a><span id="l10.59" class="difflineplus">+  this._listeners = [];</span>
<a href="#l10.60"></a><span id="l10.60" class="difflineplus">+  this._subjects = [];</span>
<a href="#l10.61"></a><span id="l10.61" class="difflineplus">+}</span>
<a href="#l10.62"></a><span id="l10.62" class="difflineplus">+</span>
<a href="#l10.63"></a><span id="l10.63" class="difflineplus">+nsActivity.prototype = {</span>
<a href="#l10.64"></a><span id="l10.64" class="difflineplus">+</span>
<a href="#l10.65"></a><span id="l10.65" class="difflineplus">+  id: -1,</span>
<a href="#l10.66"></a><span id="l10.66" class="difflineplus">+  bindingName: &quot;&quot;,</span>
<a href="#l10.67"></a><span id="l10.67" class="difflineplus">+  iconClass: &quot;&quot;,</span>
<a href="#l10.68"></a><span id="l10.68" class="difflineplus">+  groupingStyle: Ci.nsIActivity.GROUPING_STYLE_BYCONTEXT,</span>
<a href="#l10.69"></a><span id="l10.69" class="difflineplus">+  facet: &quot;&quot;,</span>
<a href="#l10.70"></a><span id="l10.70" class="difflineplus">+  displayText: &quot;&quot;,</span>
<a href="#l10.71"></a><span id="l10.71" class="difflineplus">+  initiator: null,</span>
<a href="#l10.72"></a><span id="l10.72" class="difflineplus">+  contextType: &quot;&quot;,</span>
<a href="#l10.73"></a><span id="l10.73" class="difflineplus">+  context: &quot;&quot;,</span>
<a href="#l10.74"></a><span id="l10.74" class="difflineplus">+  contextObj: null,</span>
<a href="#l10.75"></a><span id="l10.75" class="difflineplus">+</span>
<a href="#l10.76"></a><span id="l10.76" class="difflineplus">+  _initLogging: function () {</span>
<a href="#l10.77"></a><span id="l10.77" class="difflineplus">+    this.log = Log4Moz.getConfiguredLogger(&quot;nsActivity&quot;);</span>
<a href="#l10.78"></a><span id="l10.78" class="difflineplus">+  },</span>
<a href="#l10.79"></a><span id="l10.79" class="difflineplus">+</span>
<a href="#l10.80"></a><span id="l10.80" class="difflineplus">+  addListener: function(aListener) {</span>
<a href="#l10.81"></a><span id="l10.81" class="difflineplus">+    this._listeners.push(aListener);</span>
<a href="#l10.82"></a><span id="l10.82" class="difflineplus">+  },</span>
<a href="#l10.83"></a><span id="l10.83" class="difflineplus">+</span>
<a href="#l10.84"></a><span id="l10.84" class="difflineplus">+  removeListener: function(aListener) {</span>
<a href="#l10.85"></a><span id="l10.85" class="difflineplus">+    for (i = 0; i &lt; this._listeners.length; i++) {</span>
<a href="#l10.86"></a><span id="l10.86" class="difflineplus">+      if (this._listeners[i] == aListener) {</span>
<a href="#l10.87"></a><span id="l10.87" class="difflineplus">+        this._listeners.splice(i, 1);</span>
<a href="#l10.88"></a><span id="l10.88" class="difflineplus">+        break;</span>
<a href="#l10.89"></a><span id="l10.89" class="difflineplus">+      }</span>
<a href="#l10.90"></a><span id="l10.90" class="difflineplus">+    }</span>
<a href="#l10.91"></a><span id="l10.91" class="difflineplus">+  },</span>
<a href="#l10.92"></a><span id="l10.92" class="difflineplus">+</span>
<a href="#l10.93"></a><span id="l10.93" class="difflineplus">+  addSubject: function(aSubject) {</span>
<a href="#l10.94"></a><span id="l10.94" class="difflineplus">+    this._subjects.push(aSubject);</span>
<a href="#l10.95"></a><span id="l10.95" class="difflineplus">+  },</span>
<a href="#l10.96"></a><span id="l10.96" class="difflineplus">+</span>
<a href="#l10.97"></a><span id="l10.97" class="difflineplus">+  getSubjects: function(aCount) {</span>
<a href="#l10.98"></a><span id="l10.98" class="difflineplus">+    let list = [];</span>
<a href="#l10.99"></a><span id="l10.99" class="difflineplus">+    for each (let [, value] in Iterator(this._subjects))</span>
<a href="#l10.100"></a><span id="l10.100" class="difflineplus">+      list.push(value);</span>
<a href="#l10.101"></a><span id="l10.101" class="difflineplus">+</span>
<a href="#l10.102"></a><span id="l10.102" class="difflineplus">+    aCount.value = list.length;</span>
<a href="#l10.103"></a><span id="l10.103" class="difflineplus">+    return list;</span>
<a href="#l10.104"></a><span id="l10.104" class="difflineplus">+  },</span>
<a href="#l10.105"></a><span id="l10.105" class="difflineplus">+};</span>
<a href="#l10.106"></a><span id="l10.106" class="difflineplus">+</span>
<a href="#l10.107"></a><span id="l10.107" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.108"></a><span id="l10.108" class="difflineplus">+//// nsActivityProcess class</span>
<a href="#l10.109"></a><span id="l10.109" class="difflineplus">+</span>
<a href="#l10.110"></a><span id="l10.110" class="difflineplus">+function nsActivityProcess()</span>
<a href="#l10.111"></a><span id="l10.111" class="difflineplus">+{</span>
<a href="#l10.112"></a><span id="l10.112" class="difflineplus">+  nsActivity.call(this);</span>
<a href="#l10.113"></a><span id="l10.113" class="difflineplus">+  this.bindingName = &quot;activity-process&quot;;</span>
<a href="#l10.114"></a><span id="l10.114" class="difflineplus">+  this.groupingStyle = Ci.nsIActivity.GROUPING_STYLE_BYCONTEXT;</span>
<a href="#l10.115"></a><span id="l10.115" class="difflineplus">+}</span>
<a href="#l10.116"></a><span id="l10.116" class="difflineplus">+</span>
<a href="#l10.117"></a><span id="l10.117" class="difflineplus">+nsActivityProcess.prototype = {</span>
<a href="#l10.118"></a><span id="l10.118" class="difflineplus">+  __proto__: nsActivity.prototype,</span>
<a href="#l10.119"></a><span id="l10.119" class="difflineplus">+  classDescription: &quot;Activity:Process&quot;,</span>
<a href="#l10.120"></a><span id="l10.120" class="difflineplus">+  classID: Components.ID(&quot;B2C036A3-F7CE-401C-95EE-9C21505167FD&quot;),</span>
<a href="#l10.121"></a><span id="l10.121" class="difflineplus">+  contractID: &quot;@mozilla.org/activity-process;1&quot;,</span>
<a href="#l10.122"></a><span id="l10.122" class="difflineplus">+</span>
<a href="#l10.123"></a><span id="l10.123" class="difflineplus">+  //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.124"></a><span id="l10.124" class="difflineplus">+  //// nsIActivityProcess</span>
<a href="#l10.125"></a><span id="l10.125" class="difflineplus">+</span>
<a href="#l10.126"></a><span id="l10.126" class="difflineplus">+  percentComplete: -1,</span>
<a href="#l10.127"></a><span id="l10.127" class="difflineplus">+  lastStatusText: &quot;&quot;,</span>
<a href="#l10.128"></a><span id="l10.128" class="difflineplus">+  workUnitComplete: 0,</span>
<a href="#l10.129"></a><span id="l10.129" class="difflineplus">+  totalWorkUnits: 0,</span>
<a href="#l10.130"></a><span id="l10.130" class="difflineplus">+  startTime: Date.now(),</span>
<a href="#l10.131"></a><span id="l10.131" class="difflineplus">+  _cancelHandler: null,</span>
<a href="#l10.132"></a><span id="l10.132" class="difflineplus">+  _pauseHandler: null,</span>
<a href="#l10.133"></a><span id="l10.133" class="difflineplus">+  _retryHandler: null,</span>
<a href="#l10.134"></a><span id="l10.134" class="difflineplus">+  _state: Ci.nsIActivityProcess.STATE_INPROGRESS,</span>
<a href="#l10.135"></a><span id="l10.135" class="difflineplus">+</span>
<a href="#l10.136"></a><span id="l10.136" class="difflineplus">+  init: function(aDisplayText, aInitiator) {</span>
<a href="#l10.137"></a><span id="l10.137" class="difflineplus">+    this.displayText = aDisplayText;</span>
<a href="#l10.138"></a><span id="l10.138" class="difflineplus">+    this.initiator = aInitiator;</span>
<a href="#l10.139"></a><span id="l10.139" class="difflineplus">+  },</span>
<a href="#l10.140"></a><span id="l10.140" class="difflineplus">+</span>
<a href="#l10.141"></a><span id="l10.141" class="difflineplus">+  get state() {</span>
<a href="#l10.142"></a><span id="l10.142" class="difflineplus">+    return this._state;</span>
<a href="#l10.143"></a><span id="l10.143" class="difflineplus">+  },</span>
<a href="#l10.144"></a><span id="l10.144" class="difflineplus">+</span>
<a href="#l10.145"></a><span id="l10.145" class="difflineplus">+  set state(val) {</span>
<a href="#l10.146"></a><span id="l10.146" class="difflineplus">+    if (val == this._state)</span>
<a href="#l10.147"></a><span id="l10.147" class="difflineplus">+      return;</span>
<a href="#l10.148"></a><span id="l10.148" class="difflineplus">+</span>
<a href="#l10.149"></a><span id="l10.149" class="difflineplus">+    // test validity of the new state</span>
<a href="#l10.150"></a><span id="l10.150" class="difflineplus">+    //</span>
<a href="#l10.151"></a><span id="l10.151" class="difflineplus">+    if (this._state == Ci.nsIActivityProcess.STATE_INPROGRESS &amp;&amp;</span>
<a href="#l10.152"></a><span id="l10.152" class="difflineplus">+        !(val == Ci.nsIActivityProcess.STATE_COMPLETED ||</span>
<a href="#l10.153"></a><span id="l10.153" class="difflineplus">+          val == Ci.nsIActivityProcess.STATE_CANCELED ||</span>
<a href="#l10.154"></a><span id="l10.154" class="difflineplus">+          val == Ci.nsIActivityProcess.STATE_WAITINGFORRETRY ||</span>
<a href="#l10.155"></a><span id="l10.155" class="difflineplus">+          val == Ci.nsIActivityProcess.STATE_WAITINGFORINPUT ||</span>
<a href="#l10.156"></a><span id="l10.156" class="difflineplus">+          val == Ci.nsIActivityProcess.STATE_PAUSED)) {</span>
<a href="#l10.157"></a><span id="l10.157" class="difflineplus">+      throw Cr.NS_ERROR_ILLEGAL_VALUE;</span>
<a href="#l10.158"></a><span id="l10.158" class="difflineplus">+    }</span>
<a href="#l10.159"></a><span id="l10.159" class="difflineplus">+</span>
<a href="#l10.160"></a><span id="l10.160" class="difflineplus">+    // we cannot change the state after the activity is completed,</span>
<a href="#l10.161"></a><span id="l10.161" class="difflineplus">+    // or it is canceled.</span>
<a href="#l10.162"></a><span id="l10.162" class="difflineplus">+    if (this._state == Ci.nsIActivityProcess.STATE_COMPLETED ||</span>
<a href="#l10.163"></a><span id="l10.163" class="difflineplus">+        this._state == Ci.nsIActivityProcess.STATE_CANCELED)</span>
<a href="#l10.164"></a><span id="l10.164" class="difflineplus">+      throw Cr.NS_ERROR_ILLEGAL_VALUE;</span>
<a href="#l10.165"></a><span id="l10.165" class="difflineplus">+</span>
<a href="#l10.166"></a><span id="l10.166" class="difflineplus">+    if (this._state == Ci.nsIActivityProcess.STATE_PAUSED &amp;&amp;</span>
<a href="#l10.167"></a><span id="l10.167" class="difflineplus">+       !(val == Ci.nsIActivityProcess.STATE_COMPLETED ||</span>
<a href="#l10.168"></a><span id="l10.168" class="difflineplus">+         val == Ci.nsIActivityProcess.STATE_INPROGRESS ||</span>
<a href="#l10.169"></a><span id="l10.169" class="difflineplus">+         val == Ci.nsIActivityProcess.STATE_WAITINGFORRETRY ||</span>
<a href="#l10.170"></a><span id="l10.170" class="difflineplus">+         val == Ci.nsIActivityProcess.STATE_WAITINGFORINPUT ||</span>
<a href="#l10.171"></a><span id="l10.171" class="difflineplus">+         val == Ci.nsIActivityProcess.STATE_CANCELED)) {</span>
<a href="#l10.172"></a><span id="l10.172" class="difflineplus">+      throw Cr.NS_ERROR_ILLEGAL_VALUE;</span>
<a href="#l10.173"></a><span id="l10.173" class="difflineplus">+    }</span>
<a href="#l10.174"></a><span id="l10.174" class="difflineplus">+</span>
<a href="#l10.175"></a><span id="l10.175" class="difflineplus">+    if (this._state == Ci.nsIActivityProcess.STATE_WAITINGFORINPUT &amp;&amp;</span>
<a href="#l10.176"></a><span id="l10.176" class="difflineplus">+       !(val == Ci.nsIActivityProcess.STATE_INPROGRESS ||</span>
<a href="#l10.177"></a><span id="l10.177" class="difflineplus">+         val == Ci.nsIActivityProcess.STATE_CANCELED)) {</span>
<a href="#l10.178"></a><span id="l10.178" class="difflineplus">+      throw Cr.NS_ERROR_ILLEGAL_VALUE;</span>
<a href="#l10.179"></a><span id="l10.179" class="difflineplus">+    }</span>
<a href="#l10.180"></a><span id="l10.180" class="difflineplus">+</span>
<a href="#l10.181"></a><span id="l10.181" class="difflineplus">+    if (this._state == Ci.nsIActivityProcess.STATE_WAITINGFORRETRY &amp;&amp;</span>
<a href="#l10.182"></a><span id="l10.182" class="difflineplus">+       !(val == Ci.nsIActivityProcess.STATE_INPROGRESS ||</span>
<a href="#l10.183"></a><span id="l10.183" class="difflineplus">+         val == Ci.nsIActivityProcess.STATE_CANCELED)) {</span>
<a href="#l10.184"></a><span id="l10.184" class="difflineplus">+      throw Cr.NS_ERROR_ILLEGAL_VALUE;</span>
<a href="#l10.185"></a><span id="l10.185" class="difflineplus">+    }</span>
<a href="#l10.186"></a><span id="l10.186" class="difflineplus">+</span>
<a href="#l10.187"></a><span id="l10.187" class="difflineplus">+    let oldState = this._state;</span>
<a href="#l10.188"></a><span id="l10.188" class="difflineplus">+    this._state = val;</span>
<a href="#l10.189"></a><span id="l10.189" class="difflineplus">+</span>
<a href="#l10.190"></a><span id="l10.190" class="difflineplus">+    // let the listeners know about the change</span>
<a href="#l10.191"></a><span id="l10.191" class="difflineplus">+    this.log.debug(&quot;Notifying onStateChanged listeners&quot;);</span>
<a href="#l10.192"></a><span id="l10.192" class="difflineplus">+    for each (let [, value] in Iterator(this._listeners)) {</span>
<a href="#l10.193"></a><span id="l10.193" class="difflineplus">+      try {</span>
<a href="#l10.194"></a><span id="l10.194" class="difflineplus">+        value.onStateChanged(this, oldState);</span>
<a href="#l10.195"></a><span id="l10.195" class="difflineplus">+      }</span>
<a href="#l10.196"></a><span id="l10.196" class="difflineplus">+      catch(e) {</span>
<a href="#l10.197"></a><span id="l10.197" class="difflineplus">+        this.log.error(&quot;Exception thrown by onStateChanged listener: &quot;+ e);</span>
<a href="#l10.198"></a><span id="l10.198" class="difflineplus">+      }</span>
<a href="#l10.199"></a><span id="l10.199" class="difflineplus">+    }</span>
<a href="#l10.200"></a><span id="l10.200" class="difflineplus">+  },</span>
<a href="#l10.201"></a><span id="l10.201" class="difflineplus">+</span>
<a href="#l10.202"></a><span id="l10.202" class="difflineplus">+  setProgress: function(aStatusText, aWorkUnitsComplete, aTotalWorkUnits) {</span>
<a href="#l10.203"></a><span id="l10.203" class="difflineplus">+    this._percentComplete = 100.0 * aWorkUnitsComplete / aTotalWorkUnits;</span>
<a href="#l10.204"></a><span id="l10.204" class="difflineplus">+    this._workUnitComplete = aWorkUnitsComplete;</span>
<a href="#l10.205"></a><span id="l10.205" class="difflineplus">+    this._totalWorkUnits = aTotalWorkUnits;</span>
<a href="#l10.206"></a><span id="l10.206" class="difflineplus">+    this._lastStatusText = aStatusText;</span>
<a href="#l10.207"></a><span id="l10.207" class="difflineplus">+</span>
<a href="#l10.208"></a><span id="l10.208" class="difflineplus">+    // notify listeners</span>
<a href="#l10.209"></a><span id="l10.209" class="difflineplus">+    for each (let [, value] in Iterator(this._listeners)) {</span>
<a href="#l10.210"></a><span id="l10.210" class="difflineplus">+      try {</span>
<a href="#l10.211"></a><span id="l10.211" class="difflineplus">+        value.onProgressChanged(this, aStatusText, aWorkUnitsComplete,</span>
<a href="#l10.212"></a><span id="l10.212" class="difflineplus">+                                aTotalWorkUnits);</span>
<a href="#l10.213"></a><span id="l10.213" class="difflineplus">+      }</span>
<a href="#l10.214"></a><span id="l10.214" class="difflineplus">+      catch(e) {</span>
<a href="#l10.215"></a><span id="l10.215" class="difflineplus">+        this.log.error(&quot;Exception thrown by onProgressChanged listener: &quot; + e);</span>
<a href="#l10.216"></a><span id="l10.216" class="difflineplus">+      }</span>
<a href="#l10.217"></a><span id="l10.217" class="difflineplus">+    }</span>
<a href="#l10.218"></a><span id="l10.218" class="difflineplus">+  },</span>
<a href="#l10.219"></a><span id="l10.219" class="difflineplus">+</span>
<a href="#l10.220"></a><span id="l10.220" class="difflineplus">+  get cancelHandler() {</span>
<a href="#l10.221"></a><span id="l10.221" class="difflineplus">+    return this._cancelHandler;</span>
<a href="#l10.222"></a><span id="l10.222" class="difflineplus">+  },</span>
<a href="#l10.223"></a><span id="l10.223" class="difflineplus">+</span>
<a href="#l10.224"></a><span id="l10.224" class="difflineplus">+  set cancelHandler(val) {</span>
<a href="#l10.225"></a><span id="l10.225" class="difflineplus">+    this._cancelHandler = val;</span>
<a href="#l10.226"></a><span id="l10.226" class="difflineplus">+</span>
<a href="#l10.227"></a><span id="l10.227" class="difflineplus">+    // let the listeners know about the change</span>
<a href="#l10.228"></a><span id="l10.228" class="difflineplus">+    this.log.debug(&quot;Notifying onHandlerChanged listeners&quot;);</span>
<a href="#l10.229"></a><span id="l10.229" class="difflineplus">+    for each (let [, value] in Iterator(this._listeners)) {</span>
<a href="#l10.230"></a><span id="l10.230" class="difflineplus">+      try {</span>
<a href="#l10.231"></a><span id="l10.231" class="difflineplus">+        value.onHandlerChanged(this);</span>
<a href="#l10.232"></a><span id="l10.232" class="difflineplus">+      }</span>
<a href="#l10.233"></a><span id="l10.233" class="difflineplus">+      catch(e) {</span>
<a href="#l10.234"></a><span id="l10.234" class="difflineplus">+        this.log.error(&quot;Exception thrown by onHandlerChanged listener: &quot; + e);</span>
<a href="#l10.235"></a><span id="l10.235" class="difflineplus">+      }</span>
<a href="#l10.236"></a><span id="l10.236" class="difflineplus">+    }</span>
<a href="#l10.237"></a><span id="l10.237" class="difflineplus">+  },</span>
<a href="#l10.238"></a><span id="l10.238" class="difflineplus">+</span>
<a href="#l10.239"></a><span id="l10.239" class="difflineplus">+  get pauseHandler() {</span>
<a href="#l10.240"></a><span id="l10.240" class="difflineplus">+    return this._pauseHandler;</span>
<a href="#l10.241"></a><span id="l10.241" class="difflineplus">+  },</span>
<a href="#l10.242"></a><span id="l10.242" class="difflineplus">+</span>
<a href="#l10.243"></a><span id="l10.243" class="difflineplus">+  set pauseHandler(val) {</span>
<a href="#l10.244"></a><span id="l10.244" class="difflineplus">+    this._pauseHandler = val;</span>
<a href="#l10.245"></a><span id="l10.245" class="difflineplus">+</span>
<a href="#l10.246"></a><span id="l10.246" class="difflineplus">+    // let the listeners know about the change</span>
<a href="#l10.247"></a><span id="l10.247" class="difflineplus">+    this.log.debug(&quot;Notifying onHandlerChanged listeners&quot;);</span>
<a href="#l10.248"></a><span id="l10.248" class="difflineplus">+    for each (let [, value] in Iterator(this._listeners)) {</span>
<a href="#l10.249"></a><span id="l10.249" class="difflineplus">+      value.onHandlerChanged(this);</span>
<a href="#l10.250"></a><span id="l10.250" class="difflineplus">+    }</span>
<a href="#l10.251"></a><span id="l10.251" class="difflineplus">+  },</span>
<a href="#l10.252"></a><span id="l10.252" class="difflineplus">+</span>
<a href="#l10.253"></a><span id="l10.253" class="difflineplus">+  get retryHandler() {</span>
<a href="#l10.254"></a><span id="l10.254" class="difflineplus">+    return this._retryHandler;</span>
<a href="#l10.255"></a><span id="l10.255" class="difflineplus">+  },</span>
<a href="#l10.256"></a><span id="l10.256" class="difflineplus">+</span>
<a href="#l10.257"></a><span id="l10.257" class="difflineplus">+  set retryHandler(val) {</span>
<a href="#l10.258"></a><span id="l10.258" class="difflineplus">+    this._retryHandler = val;</span>
<a href="#l10.259"></a><span id="l10.259" class="difflineplus">+</span>
<a href="#l10.260"></a><span id="l10.260" class="difflineplus">+    // let the listeners know about the change</span>
<a href="#l10.261"></a><span id="l10.261" class="difflineplus">+    this.log.debug(&quot;Notifying onHandlerChanged listeners&quot;);</span>
<a href="#l10.262"></a><span id="l10.262" class="difflineplus">+    for each (let [, value] in Iterator(this._listeners)) {</span>
<a href="#l10.263"></a><span id="l10.263" class="difflineplus">+      value.onHandlerChanged(this);</span>
<a href="#l10.264"></a><span id="l10.264" class="difflineplus">+    }</span>
<a href="#l10.265"></a><span id="l10.265" class="difflineplus">+  },</span>
<a href="#l10.266"></a><span id="l10.266" class="difflineplus">+</span>
<a href="#l10.267"></a><span id="l10.267" class="difflineplus">+  //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.268"></a><span id="l10.268" class="difflineplus">+  //// nsISupports</span>
<a href="#l10.269"></a><span id="l10.269" class="difflineplus">+</span>
<a href="#l10.270"></a><span id="l10.270" class="difflineplus">+  QueryInterface: XPCOMUtils.generateQI([Ci.nsIActivityProcess, Ci.nsIActivity])</span>
<a href="#l10.271"></a><span id="l10.271" class="difflineplus">+};</span>
<a href="#l10.272"></a><span id="l10.272" class="difflineplus">+</span>
<a href="#l10.273"></a><span id="l10.273" class="difflineplus">+///////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.274"></a><span id="l10.274" class="difflineplus">+//// nsActivityEvent class</span>
<a href="#l10.275"></a><span id="l10.275" class="difflineplus">+</span>
<a href="#l10.276"></a><span id="l10.276" class="difflineplus">+function nsActivityEvent()</span>
<a href="#l10.277"></a><span id="l10.277" class="difflineplus">+{</span>
<a href="#l10.278"></a><span id="l10.278" class="difflineplus">+  nsActivity.call(this);</span>
<a href="#l10.279"></a><span id="l10.279" class="difflineplus">+  this.bindingName = &quot;activity-event&quot;;</span>
<a href="#l10.280"></a><span id="l10.280" class="difflineplus">+  this.groupingStyle = Ci.nsIActivity.GROUPING_STYLE_STANDALONE;</span>
<a href="#l10.281"></a><span id="l10.281" class="difflineplus">+}</span>
<a href="#l10.282"></a><span id="l10.282" class="difflineplus">+</span>
<a href="#l10.283"></a><span id="l10.283" class="difflineplus">+nsActivityEvent.prototype = {</span>
<a href="#l10.284"></a><span id="l10.284" class="difflineplus">+  __proto__: nsActivity.prototype,</span>
<a href="#l10.285"></a><span id="l10.285" class="difflineplus">+  classDescription: &quot;Activity:Event&quot;,</span>
<a href="#l10.286"></a><span id="l10.286" class="difflineplus">+  classID: Components.ID(&quot;87AAEB20-89D9-4B95-9542-3BF72405CAB2&quot;),</span>
<a href="#l10.287"></a><span id="l10.287" class="difflineplus">+  contractID: &quot;@mozilla.org/activity-event;1&quot;,</span>
<a href="#l10.288"></a><span id="l10.288" class="difflineplus">+</span>
<a href="#l10.289"></a><span id="l10.289" class="difflineplus">+  //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.290"></a><span id="l10.290" class="difflineplus">+  //// nsIActivityEvent</span>
<a href="#l10.291"></a><span id="l10.291" class="difflineplus">+</span>
<a href="#l10.292"></a><span id="l10.292" class="difflineplus">+  statusText: &quot;&quot;,</span>
<a href="#l10.293"></a><span id="l10.293" class="difflineplus">+  startTime: 0,</span>
<a href="#l10.294"></a><span id="l10.294" class="difflineplus">+  completionTime: 0,</span>
<a href="#l10.295"></a><span id="l10.295" class="difflineplus">+  _undoHandler: null,</span>
<a href="#l10.296"></a><span id="l10.296" class="difflineplus">+</span>
<a href="#l10.297"></a><span id="l10.297" class="difflineplus">+  init: function(aDisplayText, aInitiator, aStatusText, aStartTime,</span>
<a href="#l10.298"></a><span id="l10.298" class="difflineplus">+                 aCompletionTime) {</span>
<a href="#l10.299"></a><span id="l10.299" class="difflineplus">+    this.displayText = aDisplayText;</span>
<a href="#l10.300"></a><span id="l10.300" class="difflineplus">+    this.statusText = aStatusText;</span>
<a href="#l10.301"></a><span id="l10.301" class="difflineplus">+    this.startTime = aStartTime;</span>
<a href="#l10.302"></a><span id="l10.302" class="difflineplus">+    if (aCompletionTime)</span>
<a href="#l10.303"></a><span id="l10.303" class="difflineplus">+      this.completionTime = aCompletionTime;</span>
<a href="#l10.304"></a><span id="l10.304" class="difflineplus">+    else</span>
<a href="#l10.305"></a><span id="l10.305" class="difflineplus">+      this.completionTime = Date.now()</span>
<a href="#l10.306"></a><span id="l10.306" class="difflineplus">+    this.initiator = aInitiator;</span>
<a href="#l10.307"></a><span id="l10.307" class="difflineplus">+    this._completionTime = aCompletionTime;</span>
<a href="#l10.308"></a><span id="l10.308" class="difflineplus">+  },</span>
<a href="#l10.309"></a><span id="l10.309" class="difflineplus">+</span>
<a href="#l10.310"></a><span id="l10.310" class="difflineplus">+  get undoHandler() {</span>
<a href="#l10.311"></a><span id="l10.311" class="difflineplus">+    return this._undoHandler;</span>
<a href="#l10.312"></a><span id="l10.312" class="difflineplus">+  },</span>
<a href="#l10.313"></a><span id="l10.313" class="difflineplus">+</span>
<a href="#l10.314"></a><span id="l10.314" class="difflineplus">+  set undoHandler(val) {</span>
<a href="#l10.315"></a><span id="l10.315" class="difflineplus">+    this._undoHandler = val;</span>
<a href="#l10.316"></a><span id="l10.316" class="difflineplus">+</span>
<a href="#l10.317"></a><span id="l10.317" class="difflineplus">+    // let the listeners know about the change</span>
<a href="#l10.318"></a><span id="l10.318" class="difflineplus">+    this.log.debug(&quot;Notifying onHandlerChanged listeners&quot;);</span>
<a href="#l10.319"></a><span id="l10.319" class="difflineplus">+    for each (let [, value] in Iterator(this._listeners)) {</span>
<a href="#l10.320"></a><span id="l10.320" class="difflineplus">+      value.onHandlerChanged(this);</span>
<a href="#l10.321"></a><span id="l10.321" class="difflineplus">+    }</span>
<a href="#l10.322"></a><span id="l10.322" class="difflineplus">+  },</span>
<a href="#l10.323"></a><span id="l10.323" class="difflineplus">+</span>
<a href="#l10.324"></a><span id="l10.324" class="difflineplus">+  //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.325"></a><span id="l10.325" class="difflineplus">+  //// nsISupports</span>
<a href="#l10.326"></a><span id="l10.326" class="difflineplus">+</span>
<a href="#l10.327"></a><span id="l10.327" class="difflineplus">+  QueryInterface: XPCOMUtils.generateQI([Ci.nsIActivityEvent, Ci.nsIActivity])</span>
<a href="#l10.328"></a><span id="l10.328" class="difflineplus">+};</span>
<a href="#l10.329"></a><span id="l10.329" class="difflineplus">+</span>
<a href="#l10.330"></a><span id="l10.330" class="difflineplus">+///////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.331"></a><span id="l10.331" class="difflineplus">+//// nsActivityWarning class</span>
<a href="#l10.332"></a><span id="l10.332" class="difflineplus">+</span>
<a href="#l10.333"></a><span id="l10.333" class="difflineplus">+function nsActivityWarning()</span>
<a href="#l10.334"></a><span id="l10.334" class="difflineplus">+{</span>
<a href="#l10.335"></a><span id="l10.335" class="difflineplus">+  nsActivity.call(this);</span>
<a href="#l10.336"></a><span id="l10.336" class="difflineplus">+  this.bindingName = &quot;activity-warning&quot;;</span>
<a href="#l10.337"></a><span id="l10.337" class="difflineplus">+  this.groupingStyle = Ci.nsIActivity.GROUPING_STYLE_BYCONTEXT;</span>
<a href="#l10.338"></a><span id="l10.338" class="difflineplus">+}</span>
<a href="#l10.339"></a><span id="l10.339" class="difflineplus">+</span>
<a href="#l10.340"></a><span id="l10.340" class="difflineplus">+nsActivityWarning.prototype = {</span>
<a href="#l10.341"></a><span id="l10.341" class="difflineplus">+  __proto__: nsActivity.prototype,</span>
<a href="#l10.342"></a><span id="l10.342" class="difflineplus">+  classDescription: &quot;Activity:Warning&quot;,</span>
<a href="#l10.343"></a><span id="l10.343" class="difflineplus">+  classID: Components.ID(&quot;968BAC9E-798B-4952-B384-86B21B8CC71E&quot;),</span>
<a href="#l10.344"></a><span id="l10.344" class="difflineplus">+  contractID: &quot;@mozilla.org/activity-warning;1&quot;,</span>
<a href="#l10.345"></a><span id="l10.345" class="difflineplus">+</span>
<a href="#l10.346"></a><span id="l10.346" class="difflineplus">+  //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.347"></a><span id="l10.347" class="difflineplus">+  //// nsIActivityWarning</span>
<a href="#l10.348"></a><span id="l10.348" class="difflineplus">+  </span>
<a href="#l10.349"></a><span id="l10.349" class="difflineplus">+  recoveryTipText: &quot;&quot;,</span>
<a href="#l10.350"></a><span id="l10.350" class="difflineplus">+  _time: 0,</span>
<a href="#l10.351"></a><span id="l10.351" class="difflineplus">+  _recoveryHandler: null,</span>
<a href="#l10.352"></a><span id="l10.352" class="difflineplus">+  </span>
<a href="#l10.353"></a><span id="l10.353" class="difflineplus">+  init: function(aWarningText, aInitiator, aRecoveryTipText) {</span>
<a href="#l10.354"></a><span id="l10.354" class="difflineplus">+    this.displayText = aWarningText;</span>
<a href="#l10.355"></a><span id="l10.355" class="difflineplus">+    this.initiator = aInitiator;</span>
<a href="#l10.356"></a><span id="l10.356" class="difflineplus">+    this.recoveryTipText = aRecoveryTipText;</span>
<a href="#l10.357"></a><span id="l10.357" class="difflineplus">+    this._time = Date.now();</span>
<a href="#l10.358"></a><span id="l10.358" class="difflineplus">+  },</span>
<a href="#l10.359"></a><span id="l10.359" class="difflineplus">+</span>
<a href="#l10.360"></a><span id="l10.360" class="difflineplus">+  get recoveryHandler() {</span>
<a href="#l10.361"></a><span id="l10.361" class="difflineplus">+    return this._recoveryHandler;</span>
<a href="#l10.362"></a><span id="l10.362" class="difflineplus">+  },</span>
<a href="#l10.363"></a><span id="l10.363" class="difflineplus">+</span>
<a href="#l10.364"></a><span id="l10.364" class="difflineplus">+  set recoveryHandler(val) {</span>
<a href="#l10.365"></a><span id="l10.365" class="difflineplus">+    this._revoveryHandler = val;</span>
<a href="#l10.366"></a><span id="l10.366" class="difflineplus">+</span>
<a href="#l10.367"></a><span id="l10.367" class="difflineplus">+    // let the listeners know about the change</span>
<a href="#l10.368"></a><span id="l10.368" class="difflineplus">+    this.log.debug(&quot;Notifying onHandlerChanged listeners&quot;);</span>
<a href="#l10.369"></a><span id="l10.369" class="difflineplus">+    for each (let [, value] in Iterator(this._listeners)) {</span>
<a href="#l10.370"></a><span id="l10.370" class="difflineplus">+      value.onHandlerChanged(this);</span>
<a href="#l10.371"></a><span id="l10.371" class="difflineplus">+    }</span>
<a href="#l10.372"></a><span id="l10.372" class="difflineplus">+  },</span>
<a href="#l10.373"></a><span id="l10.373" class="difflineplus">+</span>
<a href="#l10.374"></a><span id="l10.374" class="difflineplus">+  get time() {</span>
<a href="#l10.375"></a><span id="l10.375" class="difflineplus">+    return this._time;</span>
<a href="#l10.376"></a><span id="l10.376" class="difflineplus">+  },</span>
<a href="#l10.377"></a><span id="l10.377" class="difflineplus">+</span>
<a href="#l10.378"></a><span id="l10.378" class="difflineplus">+  //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.379"></a><span id="l10.379" class="difflineplus">+  //// nsISupports</span>
<a href="#l10.380"></a><span id="l10.380" class="difflineplus">+</span>
<a href="#l10.381"></a><span id="l10.381" class="difflineplus">+  QueryInterface: XPCOMUtils.generateQI([Ci.nsIActivityWarning, Ci.nsIActivity])</span>
<a href="#l10.382"></a><span id="l10.382" class="difflineplus">+};</span>
<a href="#l10.383"></a><span id="l10.383" class="difflineplus">+</span>
<a href="#l10.384"></a><span id="l10.384" class="difflineplus">+///////////////////////////////////////////////////////////////////////////////</span>
<a href="#l10.385"></a><span id="l10.385" class="difflineplus">+//// Module</span>
<a href="#l10.386"></a><span id="l10.386" class="difflineplus">+</span>
<a href="#l10.387"></a><span id="l10.387" class="difflineplus">+let components = [nsActivityProcess, nsActivityEvent, nsActivityWarning];</span>
<a href="#l10.388"></a><span id="l10.388" class="difflineplus">+</span>
<a href="#l10.389"></a><span id="l10.389" class="difflineplus">+function NSGetModule(compMgr, fileSpec)</span>
<a href="#l10.390"></a><span id="l10.390" class="difflineplus">+{</span>
<a href="#l10.391"></a><span id="l10.391" class="difflineplus">+  return XPCOMUtils.generateModule(components);</span>
<a href="#l10.392"></a><span id="l10.392" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">new file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- /dev/null</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ b/mail/components/activity/nsActivityManager.js</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -0,0 +1,201 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineplus">+ *</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+ *</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+ * License.</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+ *</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+ * The Original Code is mozilla.org code.</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineplus">+ *</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineplus">+ * Shawn Wilsher &lt;me@shawnwilsher.com&gt;.</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2007</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l11.24"></a><span id="l11.24" class="difflineplus">+ *</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineplus">+ *  David Ascher &lt;dascher@mozillamessaging.com&gt;</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineplus">+ *  Emre Birol &lt;emrebirol@gmail.com&gt;</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+ *</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l11.30"></a><span id="l11.30" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineplus">+ *</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l11.42"></a><span id="l11.42" class="difflineplus">+</span>
<a href="#l11.43"></a><span id="l11.43" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l11.44"></a><span id="l11.44" class="difflineplus">+Components.utils.import(&quot;resource://app/modules/gloda/log4moz.js&quot;);</span>
<a href="#l11.45"></a><span id="l11.45" class="difflineplus">+</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l11.47"></a><span id="l11.47" class="difflineplus">+//// Constants</span>
<a href="#l11.48"></a><span id="l11.48" class="difflineplus">+</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineplus">+const Cc = Components.classes;</span>
<a href="#l11.50"></a><span id="l11.50" class="difflineplus">+const Ci = Components.interfaces;</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineplus">+const Cr = Components.results;</span>
<a href="#l11.52"></a><span id="l11.52" class="difflineplus">+</span>
<a href="#l11.53"></a><span id="l11.53" class="difflineplus">+</span>
<a href="#l11.54"></a><span id="l11.54" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineplus">+//// nsActivityManager class</span>
<a href="#l11.56"></a><span id="l11.56" class="difflineplus">+</span>
<a href="#l11.57"></a><span id="l11.57" class="difflineplus">+function nsActivityManager()</span>
<a href="#l11.58"></a><span id="l11.58" class="difflineplus">+{}</span>
<a href="#l11.59"></a><span id="l11.59" class="difflineplus">+</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineplus">+nsActivityManager.prototype = {</span>
<a href="#l11.61"></a><span id="l11.61" class="difflineplus">+  classDescription: &quot;Used to manage the activities&quot;,</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineplus">+  classID: Components.ID(&quot;8aa5972e-19cb-41cc-9696-645f8a8d1a06&quot;),</span>
<a href="#l11.63"></a><span id="l11.63" class="difflineplus">+  contractID: &quot;@mozilla.org/activity-manager;1&quot;,</span>
<a href="#l11.64"></a><span id="l11.64" class="difflineplus">+  </span>
<a href="#l11.65"></a><span id="l11.65" class="difflineplus">+  //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l11.66"></a><span id="l11.66" class="difflineplus">+  //// nsIActivityManager</span>
<a href="#l11.67"></a><span id="l11.67" class="difflineplus">+  log: Log4Moz.getConfiguredLogger(&quot;nsActivityManager&quot;),</span>
<a href="#l11.68"></a><span id="l11.68" class="difflineplus">+  _listeners: [],</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineplus">+  _processCount: 0,</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineplus">+  _db: null,</span>
<a href="#l11.71"></a><span id="l11.71" class="difflineplus">+  _idCounter: 1,</span>
<a href="#l11.72"></a><span id="l11.72" class="difflineplus">+  _activities: {},</span>
<a href="#l11.73"></a><span id="l11.73" class="difflineplus">+  </span>
<a href="#l11.74"></a><span id="l11.74" class="difflineplus">+  get processCount() {</span>
<a href="#l11.75"></a><span id="l11.75" class="difflineplus">+    let count = 0;</span>
<a href="#l11.76"></a><span id="l11.76" class="difflineplus">+    for each(let [, value] in Iterator(this._activities)) {</span>
<a href="#l11.77"></a><span id="l11.77" class="difflineplus">+      if (value instanceof Ci.nsIActivityProcess)</span>
<a href="#l11.78"></a><span id="l11.78" class="difflineplus">+        count++;</span>
<a href="#l11.79"></a><span id="l11.79" class="difflineplus">+    }</span>
<a href="#l11.80"></a><span id="l11.80" class="difflineplus">+    </span>
<a href="#l11.81"></a><span id="l11.81" class="difflineplus">+    return count;</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineplus">+  },</span>
<a href="#l11.83"></a><span id="l11.83" class="difflineplus">+  </span>
<a href="#l11.84"></a><span id="l11.84" class="difflineplus">+  getProcessesByContext: function(aContextType, aContextObj, aCount) {</span>
<a href="#l11.85"></a><span id="l11.85" class="difflineplus">+    let list = [];</span>
<a href="#l11.86"></a><span id="l11.86" class="difflineplus">+    for each (let [, activity] in Iterator(this._activities)) {</span>
<a href="#l11.87"></a><span id="l11.87" class="difflineplus">+      if (activity instanceof Ci.nsIActivityProcess &amp;&amp;</span>
<a href="#l11.88"></a><span id="l11.88" class="difflineplus">+          activity.contextType == aContextType &amp;&amp;</span>
<a href="#l11.89"></a><span id="l11.89" class="difflineplus">+          activity.contextObj == aContextObj) {</span>
<a href="#l11.90"></a><span id="l11.90" class="difflineplus">+        list.push(activity);</span>
<a href="#l11.91"></a><span id="l11.91" class="difflineplus">+      }</span>
<a href="#l11.92"></a><span id="l11.92" class="difflineplus">+    }</span>
<a href="#l11.93"></a><span id="l11.93" class="difflineplus">+    </span>
<a href="#l11.94"></a><span id="l11.94" class="difflineplus">+    aCount.value = list.length;</span>
<a href="#l11.95"></a><span id="l11.95" class="difflineplus">+    return list;</span>
<a href="#l11.96"></a><span id="l11.96" class="difflineplus">+  },</span>
<a href="#l11.97"></a><span id="l11.97" class="difflineplus">+  </span>
<a href="#l11.98"></a><span id="l11.98" class="difflineplus">+  get db() {</span>
<a href="#l11.99"></a><span id="l11.99" class="difflineplus">+    return null;</span>
<a href="#l11.100"></a><span id="l11.100" class="difflineplus">+  },</span>
<a href="#l11.101"></a><span id="l11.101" class="difflineplus">+  </span>
<a href="#l11.102"></a><span id="l11.102" class="difflineplus">+  get nextId() {</span>
<a href="#l11.103"></a><span id="l11.103" class="difflineplus">+    return this._idCounter++;</span>
<a href="#l11.104"></a><span id="l11.104" class="difflineplus">+  },</span>
<a href="#l11.105"></a><span id="l11.105" class="difflineplus">+    </span>
<a href="#l11.106"></a><span id="l11.106" class="difflineplus">+  addActivity: function (aActivity) {</span>
<a href="#l11.107"></a><span id="l11.107" class="difflineplus">+    try {</span>
<a href="#l11.108"></a><span id="l11.108" class="difflineplus">+      this.log.info(&quot;adding Activity&quot;);</span>
<a href="#l11.109"></a><span id="l11.109" class="difflineplus">+      // get the next valid id for this activity</span>
<a href="#l11.110"></a><span id="l11.110" class="difflineplus">+      let id = this.nextId;</span>
<a href="#l11.111"></a><span id="l11.111" class="difflineplus">+      aActivity.id = id;</span>
<a href="#l11.112"></a><span id="l11.112" class="difflineplus">+      </span>
<a href="#l11.113"></a><span id="l11.113" class="difflineplus">+      // add activity into the activities table</span>
<a href="#l11.114"></a><span id="l11.114" class="difflineplus">+      this._activities[id] = aActivity;</span>
<a href="#l11.115"></a><span id="l11.115" class="difflineplus">+      // notify all the listeners</span>
<a href="#l11.116"></a><span id="l11.116" class="difflineplus">+      for each (let [, value] in Iterator(this._listeners)) {</span>
<a href="#l11.117"></a><span id="l11.117" class="difflineplus">+        try {</span>
<a href="#l11.118"></a><span id="l11.118" class="difflineplus">+          value.onAddedActivity(id, aActivity);</span>
<a href="#l11.119"></a><span id="l11.119" class="difflineplus">+        }</span>
<a href="#l11.120"></a><span id="l11.120" class="difflineplus">+        catch(e) {</span>
<a href="#l11.121"></a><span id="l11.121" class="difflineplus">+          this.log.error(&quot;Exception calling onAddedActivity&quot; + e)</span>
<a href="#l11.122"></a><span id="l11.122" class="difflineplus">+        }</span>
<a href="#l11.123"></a><span id="l11.123" class="difflineplus">+      }</span>
<a href="#l11.124"></a><span id="l11.124" class="difflineplus">+      return id;</span>
<a href="#l11.125"></a><span id="l11.125" class="difflineplus">+    } catch (e) {</span>
<a href="#l11.126"></a><span id="l11.126" class="difflineplus">+      // for some reason exceptions don't end up on the console if we don't</span>
<a href="#l11.127"></a><span id="l11.127" class="difflineplus">+      // explicitly log them.</span>
<a href="#l11.128"></a><span id="l11.128" class="difflineplus">+      this.log.error(&quot;Exception: &quot; + e);</span>
<a href="#l11.129"></a><span id="l11.129" class="difflineplus">+      throw(e);</span>
<a href="#l11.130"></a><span id="l11.130" class="difflineplus">+    }</span>
<a href="#l11.131"></a><span id="l11.131" class="difflineplus">+  },</span>
<a href="#l11.132"></a><span id="l11.132" class="difflineplus">+  </span>
<a href="#l11.133"></a><span id="l11.133" class="difflineplus">+  removeActivity: function (aID) {</span>
<a href="#l11.134"></a><span id="l11.134" class="difflineplus">+    // make sure that the activity is not in-progress state</span>
<a href="#l11.135"></a><span id="l11.135" class="difflineplus">+    let activity = this._activities[aID];</span>
<a href="#l11.136"></a><span id="l11.136" class="difflineplus">+ </span>
<a href="#l11.137"></a><span id="l11.137" class="difflineplus">+    if (!activity)</span>
<a href="#l11.138"></a><span id="l11.138" class="difflineplus">+      throw Cr.NS_ERROR_NOT_AVAILABLE;</span>
<a href="#l11.139"></a><span id="l11.139" class="difflineplus">+    </span>
<a href="#l11.140"></a><span id="l11.140" class="difflineplus">+    if (activity instanceof Ci.nsIActivityProcess &amp;&amp;</span>
<a href="#l11.141"></a><span id="l11.141" class="difflineplus">+        activity.state == Ci.nsIActivityProcess.STATE_INPROGRESS)</span>
<a href="#l11.142"></a><span id="l11.142" class="difflineplus">+      throw Cr.NS_ERROR_FAILURE;</span>
<a href="#l11.143"></a><span id="l11.143" class="difflineplus">+    </span>
<a href="#l11.144"></a><span id="l11.144" class="difflineplus">+    // remove the activity</span>
<a href="#l11.145"></a><span id="l11.145" class="difflineplus">+    delete this._activities[aID];</span>
<a href="#l11.146"></a><span id="l11.146" class="difflineplus">+    </span>
<a href="#l11.147"></a><span id="l11.147" class="difflineplus">+    // notify all the listeners</span>
<a href="#l11.148"></a><span id="l11.148" class="difflineplus">+    for each (let [, value] in Iterator(this._listeners)) {</span>
<a href="#l11.149"></a><span id="l11.149" class="difflineplus">+      try {</span>
<a href="#l11.150"></a><span id="l11.150" class="difflineplus">+        value.onRemovedActivity(aID);</span>
<a href="#l11.151"></a><span id="l11.151" class="difflineplus">+      }</span>
<a href="#l11.152"></a><span id="l11.152" class="difflineplus">+      catch(e) {</span>
<a href="#l11.153"></a><span id="l11.153" class="difflineplus">+        // ignore the exception</span>
<a href="#l11.154"></a><span id="l11.154" class="difflineplus">+      }</span>
<a href="#l11.155"></a><span id="l11.155" class="difflineplus">+    }</span>
<a href="#l11.156"></a><span id="l11.156" class="difflineplus">+  },</span>
<a href="#l11.157"></a><span id="l11.157" class="difflineplus">+</span>
<a href="#l11.158"></a><span id="l11.158" class="difflineplus">+  getActivity: function(aID) {</span>
<a href="#l11.159"></a><span id="l11.159" class="difflineplus">+    if (!this._activities[aID])</span>
<a href="#l11.160"></a><span id="l11.160" class="difflineplus">+      throw Cr.NS_ERROR_NOT_AVAILABLE;</span>
<a href="#l11.161"></a><span id="l11.161" class="difflineplus">+    return this._activities[aID];</span>
<a href="#l11.162"></a><span id="l11.162" class="difflineplus">+  },</span>
<a href="#l11.163"></a><span id="l11.163" class="difflineplus">+</span>
<a href="#l11.164"></a><span id="l11.164" class="difflineplus">+  containsActivity: function (aID) {</span>
<a href="#l11.165"></a><span id="l11.165" class="difflineplus">+    return !!this._activities[aID];</span>
<a href="#l11.166"></a><span id="l11.166" class="difflineplus">+  },</span>
<a href="#l11.167"></a><span id="l11.167" class="difflineplus">+</span>
<a href="#l11.168"></a><span id="l11.168" class="difflineplus">+  getActivities: function(aCount) {</span>
<a href="#l11.169"></a><span id="l11.169" class="difflineplus">+    let list = [];</span>
<a href="#l11.170"></a><span id="l11.170" class="difflineplus">+    for each (let [, value] in Iterator(this._activities))</span>
<a href="#l11.171"></a><span id="l11.171" class="difflineplus">+      list.push(value);</span>
<a href="#l11.172"></a><span id="l11.172" class="difflineplus">+    </span>
<a href="#l11.173"></a><span id="l11.173" class="difflineplus">+    aCount.value = list.length;</span>
<a href="#l11.174"></a><span id="l11.174" class="difflineplus">+    return list;</span>
<a href="#l11.175"></a><span id="l11.175" class="difflineplus">+  },</span>
<a href="#l11.176"></a><span id="l11.176" class="difflineplus">+</span>
<a href="#l11.177"></a><span id="l11.177" class="difflineplus">+  addListener: function(aListener) {</span>
<a href="#l11.178"></a><span id="l11.178" class="difflineplus">+    this.log.info(&quot;addListener\n&quot;);</span>
<a href="#l11.179"></a><span id="l11.179" class="difflineplus">+    this._listeners.push(aListener);</span>
<a href="#l11.180"></a><span id="l11.180" class="difflineplus">+  },</span>
<a href="#l11.181"></a><span id="l11.181" class="difflineplus">+</span>
<a href="#l11.182"></a><span id="l11.182" class="difflineplus">+  removeListener: function(aListener) {</span>
<a href="#l11.183"></a><span id="l11.183" class="difflineplus">+    this.log.info(&quot;removeListener\n&quot;);</span>
<a href="#l11.184"></a><span id="l11.184" class="difflineplus">+    for (i = 0; i &lt; this._listeners.length; i++) {</span>
<a href="#l11.185"></a><span id="l11.185" class="difflineplus">+      if (this._listeners[i] == aListener)</span>
<a href="#l11.186"></a><span id="l11.186" class="difflineplus">+        this._listeners.splice(i, 1);</span>
<a href="#l11.187"></a><span id="l11.187" class="difflineplus">+    }</span>
<a href="#l11.188"></a><span id="l11.188" class="difflineplus">+  },</span>
<a href="#l11.189"></a><span id="l11.189" class="difflineplus">+  </span>
<a href="#l11.190"></a><span id="l11.190" class="difflineplus">+  //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l11.191"></a><span id="l11.191" class="difflineplus">+  //// nsISupports</span>
<a href="#l11.192"></a><span id="l11.192" class="difflineplus">+</span>
<a href="#l11.193"></a><span id="l11.193" class="difflineplus">+  QueryInterface: XPCOMUtils.generateQI([Ci.nsIActivityManager])</span>
<a href="#l11.194"></a><span id="l11.194" class="difflineplus">+};</span>
<a href="#l11.195"></a><span id="l11.195" class="difflineplus">+</span>
<a href="#l11.196"></a><span id="l11.196" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l11.197"></a><span id="l11.197" class="difflineplus">+//// Module</span>
<a href="#l11.198"></a><span id="l11.198" class="difflineplus">+</span>
<a href="#l11.199"></a><span id="l11.199" class="difflineplus">+let components = [nsActivityManager];</span>
<a href="#l11.200"></a><span id="l11.200" class="difflineplus">+</span>
<a href="#l11.201"></a><span id="l11.201" class="difflineplus">+function NSGetModule(compMgr, fileSpec)</span>
<a href="#l11.202"></a><span id="l11.202" class="difflineplus">+{</span>
<a href="#l11.203"></a><span id="l11.203" class="difflineplus">+  return XPCOMUtils.generateModule(components);</span>
<a href="#l11.204"></a><span id="l11.204" class="difflineplus">+}</span>
<a href="#l11.205"></a><span id="l11.205" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">new file mode 100644</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineminus">--- /dev/null</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineplus">+++ b/mail/components/activity/nsActivityManagerUI.js</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineat">@@ -0,0 +1,116 @@</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l12.6"></a><span id="l12.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l12.7"></a><span id="l12.7" class="difflineplus">+ *</span>
<a href="#l12.8"></a><span id="l12.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l12.11"></a><span id="l12.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+ *</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+ * License.</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+ *</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+ * The Original Code is mozilla.org code.</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+ *</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+ * Shawn Wilsher &lt;me@shawnwilsher.com&gt;.</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2007</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+ *</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineplus">+ *  David Ascher &lt;dascher@mozillamessaging.com&gt;</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineplus">+ *  Emre Birol &lt;emrebirol@gmail.com&gt;</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+ *</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineplus">+ *</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineplus">+</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineplus">+</span>
<a href="#l12.45"></a><span id="l12.45" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineplus">+//// Constants</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineplus">+</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineplus">+const Cc = Components.classes;</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineplus">+const Ci = Components.interfaces;</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineplus">+const Cr = Components.results;</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineplus">+</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineplus">+const ACTIVITY_MANAGER_URL = &quot;chrome://messenger/content/activity.xul&quot;;</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineplus">+const PREF_FLASH_COUNT = &quot;messenger.activity.manager.flashCount&quot;;</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineplus">+//// nsActivityManagerUI class</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineplus">+function nsActivityManagerUI()</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineplus">+{}</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineplus">+</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineplus">+nsActivityManagerUI.prototype = {</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineplus">+  classDescription: &quot;Used to show the Activity Manager's UI to the user&quot;,</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineplus">+  classID: Components.ID(&quot;5fa5974e-09cb-40cc-9696-643f8a8d9a06&quot;),</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineplus">+  contractID: &quot;@mozilla.org/activity-manager-ui;1&quot;,</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineplus">+</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineplus">+  //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineplus">+  //// nsIActivityManagerUI</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineplus">+</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineplus">+  show: function show(aWindowContext, aID) {</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineplus">+    // First we see if it is already visible</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineplus">+    let window = this.recentWindow;</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineplus">+    if (window) {</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineplus">+      window.focus();</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineplus">+      return;</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineplus">+    }</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineplus">+</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineplus">+    let parent = null;</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineplus">+    try {</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineplus">+      if (aWindowContext)</span>
<a href="#l12.80"></a><span id="l12.80" class="difflineplus">+        parent = aWindowContext.getInterface(Ci.nsIDOMWindow);</span>
<a href="#l12.81"></a><span id="l12.81" class="difflineplus">+    } catch (e) { /* it's OK to not have a parent window */ }</span>
<a href="#l12.82"></a><span id="l12.82" class="difflineplus">+</span>
<a href="#l12.83"></a><span id="l12.83" class="difflineplus">+    var ww = Cc[&quot;@mozilla.org/embedcomp/window-watcher;1&quot;].</span>
<a href="#l12.84"></a><span id="l12.84" class="difflineplus">+             getService(Ci.nsIWindowWatcher);</span>
<a href="#l12.85"></a><span id="l12.85" class="difflineplus">+    ww.openWindow(parent,</span>
<a href="#l12.86"></a><span id="l12.86" class="difflineplus">+                  ACTIVITY_MANAGER_URL,</span>
<a href="#l12.87"></a><span id="l12.87" class="difflineplus">+                  &quot;ActivityManager&quot;,</span>
<a href="#l12.88"></a><span id="l12.88" class="difflineplus">+                  &quot;chrome,dialog=no,resizable&quot;,</span>
<a href="#l12.89"></a><span id="l12.89" class="difflineplus">+                  {});</span>
<a href="#l12.90"></a><span id="l12.90" class="difflineplus">+  },</span>
<a href="#l12.91"></a><span id="l12.91" class="difflineplus">+</span>
<a href="#l12.92"></a><span id="l12.92" class="difflineplus">+  get visible() {</span>
<a href="#l12.93"></a><span id="l12.93" class="difflineplus">+    return (null != this.recentWindow);</span>
<a href="#l12.94"></a><span id="l12.94" class="difflineplus">+  },</span>
<a href="#l12.95"></a><span id="l12.95" class="difflineplus">+</span>
<a href="#l12.96"></a><span id="l12.96" class="difflineplus">+  //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l12.97"></a><span id="l12.97" class="difflineplus">+  //// nsActivityManagerUI</span>
<a href="#l12.98"></a><span id="l12.98" class="difflineplus">+</span>
<a href="#l12.99"></a><span id="l12.99" class="difflineplus">+  get recentWindow() {</span>
<a href="#l12.100"></a><span id="l12.100" class="difflineplus">+    var wm = Cc[&quot;@mozilla.org/appshell/window-mediator;1&quot;].</span>
<a href="#l12.101"></a><span id="l12.101" class="difflineplus">+             getService(Ci.nsIWindowMediator);</span>
<a href="#l12.102"></a><span id="l12.102" class="difflineplus">+    return wm.getMostRecentWindow(&quot;ActivityManager&quot;);</span>
<a href="#l12.103"></a><span id="l12.103" class="difflineplus">+  },</span>
<a href="#l12.104"></a><span id="l12.104" class="difflineplus">+</span>
<a href="#l12.105"></a><span id="l12.105" class="difflineplus">+  //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l12.106"></a><span id="l12.106" class="difflineplus">+  //// nsISupports</span>
<a href="#l12.107"></a><span id="l12.107" class="difflineplus">+</span>
<a href="#l12.108"></a><span id="l12.108" class="difflineplus">+  QueryInterface: XPCOMUtils.generateQI([Ci.nsIActivityManagerUI])</span>
<a href="#l12.109"></a><span id="l12.109" class="difflineplus">+};</span>
<a href="#l12.110"></a><span id="l12.110" class="difflineplus">+</span>
<a href="#l12.111"></a><span id="l12.111" class="difflineplus">+////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l12.112"></a><span id="l12.112" class="difflineplus">+//// Module</span>
<a href="#l12.113"></a><span id="l12.113" class="difflineplus">+</span>
<a href="#l12.114"></a><span id="l12.114" class="difflineplus">+let components = [nsActivityManagerUI];</span>
<a href="#l12.115"></a><span id="l12.115" class="difflineplus">+</span>
<a href="#l12.116"></a><span id="l12.116" class="difflineplus">+function NSGetModule(compMgr, fileSpec)</span>
<a href="#l12.117"></a><span id="l12.117" class="difflineplus">+{</span>
<a href="#l12.118"></a><span id="l12.118" class="difflineplus">+  return XPCOMUtils.generateModule(components);</span>
<a href="#l12.119"></a><span id="l12.119" class="difflineplus">+}</span>
<a href="#l12.120"></a><span id="l12.120" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1">new file mode 100644</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineminus">--- /dev/null</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineplus">+++ b/mail/components/activity/nsIActivity.idl</span>
<a href="#l13.4"></a><span id="l13.4" class="difflineat">@@ -0,0 +1,528 @@</span>
<a href="#l13.5"></a><span id="l13.5" class="difflineplus">+/* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l13.6"></a><span id="l13.6" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l13.7"></a><span id="l13.7" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l13.8"></a><span id="l13.8" class="difflineplus">+ *</span>
<a href="#l13.9"></a><span id="l13.9" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l13.10"></a><span id="l13.10" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l13.11"></a><span id="l13.11" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+ *</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineplus">+ * License.</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineplus">+ *</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineplus">+ * The Original Code is mozilla.org code.</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineplus">+ *</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineplus">+ * Mozilla Messaging</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineplus">+ *</span>
<a href="#l13.26"></a><span id="l13.26" class="difflineplus">+ * Contributor(s):</span>
<a href="#l13.27"></a><span id="l13.27" class="difflineplus">+ *   David Ascher &lt;dascher@mozillamessaging.com&gt;</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineplus">+ *   Emre Birol &lt;emrebirol@gmail.com&gt;</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineplus">+ *</span>
<a href="#l13.30"></a><span id="l13.30" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineplus">+ * either of the GNU General Public License Version 2 or later (the &quot;GPL&quot;),</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+ * or the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l13.33"></a><span id="l13.33" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l13.36"></a><span id="l13.36" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineplus">+ *</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineplus">+</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineplus">+#include &quot;nsISupports.idl&quot;</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineplus">+#include &quot;nsISupportsPrimitives.idl&quot;</span>
<a href="#l13.46"></a><span id="l13.46" class="difflineplus">+</span>
<a href="#l13.47"></a><span id="l13.47" class="difflineplus">+interface nsIActivityListener;</span>
<a href="#l13.48"></a><span id="l13.48" class="difflineplus">+interface nsIActivity;</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineplus">+interface nsIActivityProcess;</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineplus">+interface nsIActivityEvent;</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+interface nsIActivityWarning;</span>
<a href="#l13.52"></a><span id="l13.52" class="difflineplus">+interface nsIVariant;</span>
<a href="#l13.53"></a><span id="l13.53" class="difflineplus">+interface nsISupportsPRTime;</span>
<a href="#l13.54"></a><span id="l13.54" class="difflineplus">+</span>
<a href="#l13.55"></a><span id="l13.55" class="difflineplus">+/**</span>
<a href="#l13.56"></a><span id="l13.56" class="difflineplus">+ * See https://wiki.mozilla.org/Thunderbird:Activity_Manager/Developer for UML</span>
<a href="#l13.57"></a><span id="l13.57" class="difflineplus">+ * diagram and sample codes.</span>
<a href="#l13.58"></a><span id="l13.58" class="difflineplus">+ */</span>
<a href="#l13.59"></a><span id="l13.59" class="difflineplus">+</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineplus">+/**</span>
<a href="#l13.61"></a><span id="l13.61" class="difflineplus">+ * Background:</span>
<a href="#l13.62"></a><span id="l13.62" class="difflineplus">+ * Activity handlers define the behavioral capabilities of the activities. They</span>
<a href="#l13.63"></a><span id="l13.63" class="difflineplus">+ * are used by the Activity Manager to change the execution flow of the activity</span>
<a href="#l13.64"></a><span id="l13.64" class="difflineplus">+ * based on the user interaction. They are not mandatory, but when set, causes</span>
<a href="#l13.65"></a><span id="l13.65" class="difflineplus">+ * behavioral changes on the binding representing the activity, such as showing</span>
<a href="#l13.66"></a><span id="l13.66" class="difflineplus">+ * a cancel button, etc. The following handlers are currently supported;</span>
<a href="#l13.67"></a><span id="l13.67" class="difflineplus">+ */</span>
<a href="#l13.68"></a><span id="l13.68" class="difflineplus">+ </span>
<a href="#l13.69"></a><span id="l13.69" class="difflineplus">+/**</span>
<a href="#l13.70"></a><span id="l13.70" class="difflineplus">+ * The handler to invoke when the recover button is pressed. Used by a Warning</span>
<a href="#l13.71"></a><span id="l13.71" class="difflineplus">+ * to recover from the situation causing the warning. For instance, recovery</span>
<a href="#l13.72"></a><span id="l13.72" class="difflineplus">+ * action for a &quot;Over Quota Limit&quot; warning, would be to cleanup some disk space,</span>
<a href="#l13.73"></a><span id="l13.73" class="difflineplus">+ * and this operation can be implemented and set by the activity developer in</span>
<a href="#l13.74"></a><span id="l13.74" class="difflineplus">+ * form of nsIActivityRecoveryHandler component.</span>
<a href="#l13.75"></a><span id="l13.75" class="difflineplus">+ */</span>
<a href="#l13.76"></a><span id="l13.76" class="difflineplus">+[scriptable, uuid(30E0A76F-880A-4093-8F3C-AF2239977A3D)]</span>
<a href="#l13.77"></a><span id="l13.77" class="difflineplus">+interface nsIActivityRecoveryHandler : nsISupports {</span>
<a href="#l13.78"></a><span id="l13.78" class="difflineplus">+  nsresult recover(in nsIActivityWarning aActivity);</span>
<a href="#l13.79"></a><span id="l13.79" class="difflineplus">+};</span>
<a href="#l13.80"></a><span id="l13.80" class="difflineplus">+</span>
<a href="#l13.81"></a><span id="l13.81" class="difflineplus">+/**</span>
<a href="#l13.82"></a><span id="l13.82" class="difflineplus">+ * The handler to invoke when the cancel button is pressed. Used by a Process to</span>
<a href="#l13.83"></a><span id="l13.83" class="difflineplus">+ * cancel the operation.</span>
<a href="#l13.84"></a><span id="l13.84" class="difflineplus">+ */</span>
<a href="#l13.85"></a><span id="l13.85" class="difflineplus">+[scriptable, uuid(35ee2461-70db-4b3a-90d0-7a68c856e911)]</span>
<a href="#l13.86"></a><span id="l13.86" class="difflineplus">+interface nsIActivityCancelHandler : nsISupports {</span>
<a href="#l13.87"></a><span id="l13.87" class="difflineplus">+  nsresult cancel(in nsIActivityProcess aActivity);</span>
<a href="#l13.88"></a><span id="l13.88" class="difflineplus">+};</span>
<a href="#l13.89"></a><span id="l13.89" class="difflineplus">+</span>
<a href="#l13.90"></a><span id="l13.90" class="difflineplus">+/**</span>
<a href="#l13.91"></a><span id="l13.91" class="difflineplus">+ * The handler to invoke when the pause button is pressed. Used by a Process to</span>
<a href="#l13.92"></a><span id="l13.92" class="difflineplus">+ * pause/resume the operation.</span>
<a href="#l13.93"></a><span id="l13.93" class="difflineplus">+ */</span>
<a href="#l13.94"></a><span id="l13.94" class="difflineplus">+[scriptable, uuid(9eee22bf-5378-460e-83a7-781cdcc9050b)]</span>
<a href="#l13.95"></a><span id="l13.95" class="difflineplus">+interface nsIActivityPauseHandler : nsISupports {</span>
<a href="#l13.96"></a><span id="l13.96" class="difflineplus">+  nsresult pause(in nsIActivityProcess aActivity);</span>
<a href="#l13.97"></a><span id="l13.97" class="difflineplus">+  nsresult resume(in nsIActivityProcess aActivity);</span>
<a href="#l13.98"></a><span id="l13.98" class="difflineplus">+};</span>
<a href="#l13.99"></a><span id="l13.99" class="difflineplus">+</span>
<a href="#l13.100"></a><span id="l13.100" class="difflineplus">+/**</span>
<a href="#l13.101"></a><span id="l13.101" class="difflineplus">+ * The handler to invoke when the retry button is pressed. Used by a Process to</span>
<a href="#l13.102"></a><span id="l13.102" class="difflineplus">+ * retry the operation in case of failure.</span>
<a href="#l13.103"></a><span id="l13.103" class="difflineplus">+ */</span>
<a href="#l13.104"></a><span id="l13.104" class="difflineplus">+[scriptable, uuid(8ec42517-951f-4bc0-aba5-fde7258b1705)]</span>
<a href="#l13.105"></a><span id="l13.105" class="difflineplus">+interface nsIActivityRetryHandler : nsISupports {</span>
<a href="#l13.106"></a><span id="l13.106" class="difflineplus">+  nsresult retry(in nsIActivityProcess aActivity);</span>
<a href="#l13.107"></a><span id="l13.107" class="difflineplus">+};</span>
<a href="#l13.108"></a><span id="l13.108" class="difflineplus">+</span>
<a href="#l13.109"></a><span id="l13.109" class="difflineplus">+/**</span>
<a href="#l13.110"></a><span id="l13.110" class="difflineplus">+ * The handler to invoke when the undo button is pressed. Used by a Event to</span>
<a href="#l13.111"></a><span id="l13.111" class="difflineplus">+ * undo the operation generated the event.</span>
<a href="#l13.112"></a><span id="l13.112" class="difflineplus">+ */</span>
<a href="#l13.113"></a><span id="l13.113" class="difflineplus">+[scriptable, uuid(b8632ac7-9d8b-4341-a349-ef000e8c89ac)]</span>
<a href="#l13.114"></a><span id="l13.114" class="difflineplus">+interface nsIActivityUndoHandler : nsISupports {</span>
<a href="#l13.115"></a><span id="l13.115" class="difflineplus">+  nsresult undo(in nsIActivityEvent aActivity);</span>
<a href="#l13.116"></a><span id="l13.116" class="difflineplus">+};</span>
<a href="#l13.117"></a><span id="l13.117" class="difflineplus">+</span>
<a href="#l13.118"></a><span id="l13.118" class="difflineplus">+/**</span>
<a href="#l13.119"></a><span id="l13.119" class="difflineplus">+ * Base interface of all activity interfaces. It is abstract in a sense that</span>
<a href="#l13.120"></a><span id="l13.120" class="difflineplus">+ * there is no component in the activity management system that solely</span>
<a href="#l13.121"></a><span id="l13.121" class="difflineplus">+ * implements this interface.</span>
<a href="#l13.122"></a><span id="l13.122" class="difflineplus">+ */</span>
<a href="#l13.123"></a><span id="l13.123" class="difflineplus">+[scriptable, uuid(6CD33E65-B2D8-4634-9B6D-B80BF1273E99)]</span>
<a href="#l13.124"></a><span id="l13.124" class="difflineplus">+interface nsIActivity : nsISupports {</span>
<a href="#l13.125"></a><span id="l13.125" class="difflineplus">+  </span>
<a href="#l13.126"></a><span id="l13.126" class="difflineplus">+  /**</span>
<a href="#l13.127"></a><span id="l13.127" class="difflineplus">+   * Shows the activity as a standalone item.</span>
<a href="#l13.128"></a><span id="l13.128" class="difflineplus">+   */</span>
<a href="#l13.129"></a><span id="l13.129" class="difflineplus">+  const short GROUPING_STYLE_STANDALONE = 1;</span>
<a href="#l13.130"></a><span id="l13.130" class="difflineplus">+</span>
<a href="#l13.131"></a><span id="l13.131" class="difflineplus">+  /**</span>
<a href="#l13.132"></a><span id="l13.132" class="difflineplus">+   * Groups activity by its context.</span>
<a href="#l13.133"></a><span id="l13.133" class="difflineplus">+   */</span>
<a href="#l13.134"></a><span id="l13.134" class="difflineplus">+  const short GROUPING_STYLE_BYCONTEXT = 2;</span>
<a href="#l13.135"></a><span id="l13.135" class="difflineplus">+  </span>
<a href="#l13.136"></a><span id="l13.136" class="difflineplus">+  /**</span>
<a href="#l13.137"></a><span id="l13.137" class="difflineplus">+   * Internal ID given by the activity manager when</span>
<a href="#l13.138"></a><span id="l13.138" class="difflineplus">+   * added into the activity list.  Not readonly so that</span>
<a href="#l13.139"></a><span id="l13.139" class="difflineplus">+   * the activity manager can write to them, but not to be written to</span>
<a href="#l13.140"></a><span id="l13.140" class="difflineplus">+   * by anyone else.</span>
<a href="#l13.141"></a><span id="l13.141" class="difflineplus">+   */</span>
<a href="#l13.142"></a><span id="l13.142" class="difflineplus">+  attribute unsigned long id;</span>
<a href="#l13.143"></a><span id="l13.143" class="difflineplus">+  </span>
<a href="#l13.144"></a><span id="l13.144" class="difflineplus">+  // Following attributes change the UI characteristics of the activity</span>
<a href="#l13.145"></a><span id="l13.145" class="difflineplus">+  </span>
<a href="#l13.146"></a><span id="l13.146" class="difflineplus">+  /**</span>
<a href="#l13.147"></a><span id="l13.147" class="difflineplus">+   * A brief description of the activity, to be shown by the</span>
<a href="#l13.148"></a><span id="l13.148" class="difflineplus">+   * associated binding (XBL) in the Activity Manager window.</span>
<a href="#l13.149"></a><span id="l13.149" class="difflineplus">+   */</span>
<a href="#l13.150"></a><span id="l13.150" class="difflineplus">+  readonly attribute AString displayText;</span>
<a href="#l13.151"></a><span id="l13.151" class="difflineplus">+  </span>
<a href="#l13.152"></a><span id="l13.152" class="difflineplus">+  /**</span>
<a href="#l13.153"></a><span id="l13.153" class="difflineplus">+   * Changes the default icon associated with the activity. Core activity</span>
<a href="#l13.154"></a><span id="l13.154" class="difflineplus">+   * icons are declared in |mail/themes/pinstripe/mail/activity/activity.css|</span>
<a href="#l13.155"></a><span id="l13.155" class="difflineplus">+   * file.</span>
<a href="#l13.156"></a><span id="l13.156" class="difflineplus">+   *</span>
<a href="#l13.157"></a><span id="l13.157" class="difflineplus">+   * Extension developers can add and assign their own icons by setting</span>
<a href="#l13.158"></a><span id="l13.158" class="difflineplus">+   * this attribute.</span>
<a href="#l13.159"></a><span id="l13.159" class="difflineplus">+   */</span>
<a href="#l13.160"></a><span id="l13.160" class="difflineplus">+  attribute AString iconClass;</span>
<a href="#l13.161"></a><span id="l13.161" class="difflineplus">+  </span>
<a href="#l13.162"></a><span id="l13.162" class="difflineplus">+  /**</span>
<a href="#l13.163"></a><span id="l13.163" class="difflineplus">+   * Textual id of the XBL binding that will be used to represent the</span>
<a href="#l13.164"></a><span id="l13.164" class="difflineplus">+   * activity in the Activity Manager window.</span>
<a href="#l13.165"></a><span id="l13.165" class="difflineplus">+   *</span>
<a href="#l13.166"></a><span id="l13.166" class="difflineplus">+   * This attribute allows to associate default activity components</span>
<a href="#l13.167"></a><span id="l13.167" class="difflineplus">+   * with custom XBL bindings. See |activity.xml| file for default</span>
<a href="#l13.168"></a><span id="l13.168" class="difflineplus">+   * activity XBL bindings, and |activity.css| file for default binding</span>
<a href="#l13.169"></a><span id="l13.169" class="difflineplus">+   * associations.</span>
<a href="#l13.170"></a><span id="l13.170" class="difflineplus">+   */</span>
<a href="#l13.171"></a><span id="l13.171" class="difflineplus">+  attribute AString bindingName;</span>
<a href="#l13.172"></a><span id="l13.172" class="difflineplus">+  </span>
<a href="#l13.173"></a><span id="l13.173" class="difflineplus">+  /**</span>
<a href="#l13.174"></a><span id="l13.174" class="difflineplus">+   * Defines the grouping style of the activity when being shown in the</span>
<a href="#l13.175"></a><span id="l13.175" class="difflineplus">+   * activity manager window:</span>
<a href="#l13.176"></a><span id="l13.176" class="difflineplus">+   *  GROUPING_STYLE_STANDALONE or GROUPING_STYLE_BYCONTEXT</span>
<a href="#l13.177"></a><span id="l13.177" class="difflineplus">+   */</span>
<a href="#l13.178"></a><span id="l13.178" class="difflineplus">+  attribute short groupingStyle;</span>
<a href="#l13.179"></a><span id="l13.179" class="difflineplus">+  </span>
<a href="#l13.180"></a><span id="l13.180" class="difflineplus">+  /**</span>
<a href="#l13.181"></a><span id="l13.181" class="difflineplus">+   * A text value to associate a facet type with the activity. If empty,</span>
<a href="#l13.182"></a><span id="l13.182" class="difflineplus">+   * the activity will be shown in the 'Misc' section.</span>
<a href="#l13.183"></a><span id="l13.183" class="difflineplus">+   */</span>
<a href="#l13.184"></a><span id="l13.184" class="difflineplus">+  attribute AString facet;</span>
<a href="#l13.185"></a><span id="l13.185" class="difflineplus">+  </span>
<a href="#l13.186"></a><span id="l13.186" class="difflineplus">+  // UI related attributes end.</span>
<a href="#l13.187"></a><span id="l13.187" class="difflineplus">+  </span>
<a href="#l13.188"></a><span id="l13.188" class="difflineplus">+  /**</span>
<a href="#l13.189"></a><span id="l13.189" class="difflineplus">+   * Gets the initiator of the activity. An initiator represents an object</span>
<a href="#l13.190"></a><span id="l13.190" class="difflineplus">+   * that generates and controls the activity. For example, Copy Service can be</span>
<a href="#l13.191"></a><span id="l13.191" class="difflineplus">+   * the initiator of the copy, and move activities. Similarly Gloda can be the</span>
<a href="#l13.192"></a><span id="l13.192" class="difflineplus">+   * initiator of indexing activity, etc.</span>
<a href="#l13.193"></a><span id="l13.193" class="difflineplus">+   *</span>
<a href="#l13.194"></a><span id="l13.194" class="difflineplus">+   * This attribute is used mostly by handler components to change the execution</span>
<a href="#l13.195"></a><span id="l13.195" class="difflineplus">+   * flow of the activity such as canceling, pausing etc. Since not used by the</span>
<a href="#l13.196"></a><span id="l13.196" class="difflineplus">+   * Activity Manager, it is not mandatory to set it.</span>
<a href="#l13.197"></a><span id="l13.197" class="difflineplus">+   *</span>
<a href="#l13.198"></a><span id="l13.198" class="difflineplus">+   * An initiator can be any JS Object or an XPCOM component that provides an</span>
<a href="#l13.199"></a><span id="l13.199" class="difflineplus">+   * nsIVariant interface.</span>
<a href="#l13.200"></a><span id="l13.200" class="difflineplus">+   */</span>
<a href="#l13.201"></a><span id="l13.201" class="difflineplus">+  readonly attribute nsIVariant initiator;</span>
<a href="#l13.202"></a><span id="l13.202" class="difflineplus">+  </span>
<a href="#l13.203"></a><span id="l13.203" class="difflineplus">+  /**</span>
<a href="#l13.204"></a><span id="l13.204" class="difflineplus">+   * Adds an object to the activity's internal subject list. Subject list</span>
<a href="#l13.205"></a><span id="l13.205" class="difflineplus">+   * provides argument(s) to activity handlers to complete their operation.</span>
<a href="#l13.206"></a><span id="l13.206" class="difflineplus">+   * For example, nsIActivityUndoHandler needs the source and destination</span>
<a href="#l13.207"></a><span id="l13.207" class="difflineplus">+   * folders to undo a move operation.</span>
<a href="#l13.208"></a><span id="l13.208" class="difflineplus">+   *</span>
<a href="#l13.209"></a><span id="l13.209" class="difflineplus">+   * Since subjects are not used by the Activity Manager, it is up to the</span>
<a href="#l13.210"></a><span id="l13.210" class="difflineplus">+   * activity developer to provide these objects.</span>
<a href="#l13.211"></a><span id="l13.211" class="difflineplus">+   *</span>
<a href="#l13.212"></a><span id="l13.212" class="difflineplus">+   * A subject can be any JS object or XPCOM component that supports nsIVariant</span>
<a href="#l13.213"></a><span id="l13.213" class="difflineplus">+   * interface.</span>
<a href="#l13.214"></a><span id="l13.214" class="difflineplus">+   */</span>
<a href="#l13.215"></a><span id="l13.215" class="difflineplus">+  void addSubject(in nsIVariant aSubject);</span>
<a href="#l13.216"></a><span id="l13.216" class="difflineplus">+  </span>
<a href="#l13.217"></a><span id="l13.217" class="difflineplus">+  /**</span>
<a href="#l13.218"></a><span id="l13.218" class="difflineplus">+   * Retrieves all subjects associated with this activity.</span>
<a href="#l13.219"></a><span id="l13.219" class="difflineplus">+   *</span>
<a href="#l13.220"></a><span id="l13.220" class="difflineplus">+   * @return The list of subject objects associated by the activity.</span>
<a href="#l13.221"></a><span id="l13.221" class="difflineplus">+   */</span>
<a href="#l13.222"></a><span id="l13.222" class="difflineplus">+  void getSubjects(out unsigned long length, [retval, array,</span>
<a href="#l13.223"></a><span id="l13.223" class="difflineplus">+                   size_is(length)] out nsIVariant aSubjects);</span>
<a href="#l13.224"></a><span id="l13.224" class="difflineplus">+  </span>
<a href="#l13.225"></a><span id="l13.225" class="difflineplus">+  /*</span>
<a href="#l13.226"></a><span id="l13.226" class="difflineplus">+   * Background:</span>
<a href="#l13.227"></a><span id="l13.227" class="difflineplus">+   *  A context is a generic concept that is used to group the processes and</span>
<a href="#l13.228"></a><span id="l13.228" class="difflineplus">+   *  warnings having similar properties such as same imap server, same smtp</span>
<a href="#l13.229"></a><span id="l13.229" class="difflineplus">+   *  server etc.</span>
<a href="#l13.230"></a><span id="l13.230" class="difflineplus">+   *  A context is uniquely identified by its &quot;type&quot; and &quot;object&quot; attributes.</span>
<a href="#l13.231"></a><span id="l13.231" class="difflineplus">+   *  Each activity that has the same context type and object are considered</span>
<a href="#l13.232"></a><span id="l13.232" class="difflineplus">+   *  belong to the same logical group, context.</span>
<a href="#l13.233"></a><span id="l13.233" class="difflineplus">+   *</span>
<a href="#l13.234"></a><span id="l13.234" class="difflineplus">+   *  There are 4 predefined context types known by the Activity Manager:</span>
<a href="#l13.235"></a><span id="l13.235" class="difflineplus">+   *  Account, Smtp, Calendar, and Addressbook. The most common context type</span>
<a href="#l13.236"></a><span id="l13.236" class="difflineplus">+   *  for activities is the &quot;Account Context&quot; and when combined with an account</span>
<a href="#l13.237"></a><span id="l13.237" class="difflineplus">+   *  server instance, it allows to group different activities happening on the</span>
<a href="#l13.238"></a><span id="l13.238" class="difflineplus">+   *  the same account server.</span>
<a href="#l13.239"></a><span id="l13.239" class="difflineplus">+   */</span>
<a href="#l13.240"></a><span id="l13.240" class="difflineplus">+  </span>
<a href="#l13.241"></a><span id="l13.241" class="difflineplus">+  /**</span>
<a href="#l13.242"></a><span id="l13.242" class="difflineplus">+   * Sets and gets the context object of the activity. A context object can be</span>
<a href="#l13.243"></a><span id="l13.243" class="difflineplus">+   * any JS object or XPCOM component that supports nsIVariant interface.</span>
<a href="#l13.244"></a><span id="l13.244" class="difflineplus">+   */</span>
<a href="#l13.245"></a><span id="l13.245" class="difflineplus">+  attribute nsIVariant contextObj;</span>
<a href="#l13.246"></a><span id="l13.246" class="difflineplus">+  </span>
<a href="#l13.247"></a><span id="l13.247" class="difflineplus">+  /**</span>
<a href="#l13.248"></a><span id="l13.248" class="difflineplus">+   * Sets and gets the context type of the activity. The Activity Manager</span>
<a href="#l13.249"></a><span id="l13.249" class="difflineplus">+   * knows how to display a description for predefined context types.</span>
<a href="#l13.250"></a><span id="l13.250" class="difflineplus">+   *</span>
<a href="#l13.251"></a><span id="l13.251" class="difflineplus">+   * If the activity developer decides to introduce its own context type to</span>
<a href="#l13.252"></a><span id="l13.252" class="difflineplus">+   * Thunderbird, he/she _must_ implement contextDisplayText as well.</span>
<a href="#l13.253"></a><span id="l13.253" class="difflineplus">+   */</span>
<a href="#l13.254"></a><span id="l13.254" class="difflineplus">+  attribute AString contextType;</span>
<a href="#l13.255"></a><span id="l13.255" class="difflineplus">+</span>
<a href="#l13.256"></a><span id="l13.256" class="difflineplus">+  /**</span>
<a href="#l13.257"></a><span id="l13.257" class="difflineplus">+   * Return the displayText to be used for the context</span>
<a href="#l13.258"></a><span id="l13.258" class="difflineplus">+   **/</span>
<a href="#l13.259"></a><span id="l13.259" class="difflineplus">+  attribute AString contextDisplayText;</span>
<a href="#l13.260"></a><span id="l13.260" class="difflineplus">+</span>
<a href="#l13.261"></a><span id="l13.261" class="difflineplus">+  /**</span>
<a href="#l13.262"></a><span id="l13.262" class="difflineplus">+   * Adds a listener. See nsIActivityListener below.</span>
<a href="#l13.263"></a><span id="l13.263" class="difflineplus">+   */</span>
<a href="#l13.264"></a><span id="l13.264" class="difflineplus">+  void addListener(in nsIActivityListener aListener);</span>
<a href="#l13.265"></a><span id="l13.265" class="difflineplus">+</span>
<a href="#l13.266"></a><span id="l13.266" class="difflineplus">+  /**</span>
<a href="#l13.267"></a><span id="l13.267" class="difflineplus">+   * Removes the given listener. See nsIActivityListener below.</span>
<a href="#l13.268"></a><span id="l13.268" class="difflineplus">+   */</span>
<a href="#l13.269"></a><span id="l13.269" class="difflineplus">+  void removeListener(in nsIActivityListener aListener);</span>
<a href="#l13.270"></a><span id="l13.270" class="difflineplus">+};</span>
<a href="#l13.271"></a><span id="l13.271" class="difflineplus">+</span>
<a href="#l13.272"></a><span id="l13.272" class="difflineplus">+</span>
<a href="#l13.273"></a><span id="l13.273" class="difflineplus">+/**</span>
<a href="#l13.274"></a><span id="l13.274" class="difflineplus">+ * A Process represents an on-going activity.</span>
<a href="#l13.275"></a><span id="l13.275" class="difflineplus">+ */</span>
<a href="#l13.276"></a><span id="l13.276" class="difflineplus">+[scriptable, uuid(9DC7CA67-828D-4AFD-A5C6-3ECE091A98B8)]</span>
<a href="#l13.277"></a><span id="l13.277" class="difflineplus">+interface nsIActivityProcess : nsIActivity {</span>
<a href="#l13.278"></a><span id="l13.278" class="difflineplus">+  </span>
<a href="#l13.279"></a><span id="l13.279" class="difflineplus">+  /**</span>
<a href="#l13.280"></a><span id="l13.280" class="difflineplus">+   * Default state for uninitialized process activity</span>
<a href="#l13.281"></a><span id="l13.281" class="difflineplus">+   * object.</span>
<a href="#l13.282"></a><span id="l13.282" class="difflineplus">+   */</span>
<a href="#l13.283"></a><span id="l13.283" class="difflineplus">+  const short STATE_NOTSTARTED = -1;</span>
<a href="#l13.284"></a><span id="l13.284" class="difflineplus">+</span>
<a href="#l13.285"></a><span id="l13.285" class="difflineplus">+  /**</span>
<a href="#l13.286"></a><span id="l13.286" class="difflineplus">+   * Activity is currently in progress.</span>
<a href="#l13.287"></a><span id="l13.287" class="difflineplus">+   */</span>
<a href="#l13.288"></a><span id="l13.288" class="difflineplus">+  const short STATE_INPROGRESS = 0;</span>
<a href="#l13.289"></a><span id="l13.289" class="difflineplus">+</span>
<a href="#l13.290"></a><span id="l13.290" class="difflineplus">+  /**</span>
<a href="#l13.291"></a><span id="l13.291" class="difflineplus">+   * Activity is completed.</span>
<a href="#l13.292"></a><span id="l13.292" class="difflineplus">+   */</span>
<a href="#l13.293"></a><span id="l13.293" class="difflineplus">+  const short STATE_COMPLETED = 1;</span>
<a href="#l13.294"></a><span id="l13.294" class="difflineplus">+</span>
<a href="#l13.295"></a><span id="l13.295" class="difflineplus">+  /**</span>
<a href="#l13.296"></a><span id="l13.296" class="difflineplus">+   * Activity was canceled by the user.</span>
<a href="#l13.297"></a><span id="l13.297" class="difflineplus">+   * (same as completed)</span>
<a href="#l13.298"></a><span id="l13.298" class="difflineplus">+   */</span>
<a href="#l13.299"></a><span id="l13.299" class="difflineplus">+  const short STATE_CANCELED = 2;</span>
<a href="#l13.300"></a><span id="l13.300" class="difflineplus">+</span>
<a href="#l13.301"></a><span id="l13.301" class="difflineplus">+  /**</span>
<a href="#l13.302"></a><span id="l13.302" class="difflineplus">+   * Activity was paused by the user.</span>
<a href="#l13.303"></a><span id="l13.303" class="difflineplus">+   */</span>
<a href="#l13.304"></a><span id="l13.304" class="difflineplus">+  const short STATE_PAUSED = 3;</span>
<a href="#l13.305"></a><span id="l13.305" class="difflineplus">+  </span>
<a href="#l13.306"></a><span id="l13.306" class="difflineplus">+  /**</span>
<a href="#l13.307"></a><span id="l13.307" class="difflineplus">+   * Activity waits for the user input's to retry.</span>
<a href="#l13.308"></a><span id="l13.308" class="difflineplus">+   * (i.e. login password)</span>
<a href="#l13.309"></a><span id="l13.309" class="difflineplus">+   */</span>
<a href="#l13.310"></a><span id="l13.310" class="difflineplus">+  const short STATE_WAITINGFORINPUT = 4;</span>
<a href="#l13.311"></a><span id="l13.311" class="difflineplus">+</span>
<a href="#l13.312"></a><span id="l13.312" class="difflineplus">+  /**</span>
<a href="#l13.313"></a><span id="l13.313" class="difflineplus">+   * Activity is ready for an automatic or manual retry.</span>
<a href="#l13.314"></a><span id="l13.314" class="difflineplus">+   */</span>
<a href="#l13.315"></a><span id="l13.315" class="difflineplus">+  const short STATE_WAITINGFORRETRY = 5;</span>
<a href="#l13.316"></a><span id="l13.316" class="difflineplus">+  </span>
<a href="#l13.317"></a><span id="l13.317" class="difflineplus">+  /**</span>
<a href="#l13.318"></a><span id="l13.318" class="difflineplus">+   * The state of the activity.</span>
<a href="#l13.319"></a><span id="l13.319" class="difflineplus">+   * See above for possible values.</span>
<a href="#l13.320"></a><span id="l13.320" class="difflineplus">+   * @exception NS_ERROR_ILLEGAL_VALUE if the state isn't one of the states</span>
<a href="#l13.321"></a><span id="l13.321" class="difflineplus">+   *   defined above.</span>
<a href="#l13.322"></a><span id="l13.322" class="difflineplus">+   */</span>
<a href="#l13.323"></a><span id="l13.323" class="difflineplus">+  attribute short state;</span>
<a href="#l13.324"></a><span id="l13.324" class="difflineplus">+    </span>
<a href="#l13.325"></a><span id="l13.325" class="difflineplus">+  /**</span>
<a href="#l13.326"></a><span id="l13.326" class="difflineplus">+   * The percentage of activity completed.</span>
<a href="#l13.327"></a><span id="l13.327" class="difflineplus">+   * If the max value is unknown it'll be -1 here.</span>
<a href="#l13.328"></a><span id="l13.328" class="difflineplus">+   */</span>
<a href="#l13.329"></a><span id="l13.329" class="difflineplus">+  readonly attribute long percentComplete;</span>
<a href="#l13.330"></a><span id="l13.330" class="difflineplus">+  </span>
<a href="#l13.331"></a><span id="l13.331" class="difflineplus">+  /**</span>
<a href="#l13.332"></a><span id="l13.332" class="difflineplus">+   * A brief text about the process' status.</span>
<a href="#l13.333"></a><span id="l13.333" class="difflineplus">+   */</span>
<a href="#l13.334"></a><span id="l13.334" class="difflineplus">+  readonly attribute AString lastStatusText;</span>
<a href="#l13.335"></a><span id="l13.335" class="difflineplus">+  </span>
<a href="#l13.336"></a><span id="l13.336" class="difflineplus">+  /**</span>
<a href="#l13.337"></a><span id="l13.337" class="difflineplus">+   * The amount of work units completed so far.</span>
<a href="#l13.338"></a><span id="l13.338" class="difflineplus">+   */</span>
<a href="#l13.339"></a><span id="l13.339" class="difflineplus">+  readonly attribute unsigned long workUnitComplete;</span>
<a href="#l13.340"></a><span id="l13.340" class="difflineplus">+  </span>
<a href="#l13.341"></a><span id="l13.341" class="difflineplus">+  /**</span>
<a href="#l13.342"></a><span id="l13.342" class="difflineplus">+   * Total amount of work units.</span>
<a href="#l13.343"></a><span id="l13.343" class="difflineplus">+   */</span>
<a href="#l13.344"></a><span id="l13.344" class="difflineplus">+  readonly attribute unsigned long totalWorkUnits;</span>
<a href="#l13.345"></a><span id="l13.345" class="difflineplus">+</span>
<a href="#l13.346"></a><span id="l13.346" class="difflineplus">+  /**</span>
<a href="#l13.347"></a><span id="l13.347" class="difflineplus">+   * The starting time of the process.</span>
<a href="#l13.348"></a><span id="l13.348" class="difflineplus">+   * 64-bit signed integers relative to midnight (00:00:00), January 1, 1970</span>
<a href="#l13.349"></a><span id="l13.349" class="difflineplus">+   * Greenwich Mean Time (GMT). (GMT is also known as Coordinated Universal</span>
<a href="#l13.350"></a><span id="l13.350" class="difflineplus">+   * Time, UTC.). The units of time are in microseconds.</span>
<a href="#l13.351"></a><span id="l13.351" class="difflineplus">+   *</span>
<a href="#l13.352"></a><span id="l13.352" class="difflineplus">+   * In JS Date.now(), in C++ PR_Now() / PR_USEC_PER_MSEC can be used to set</span>
<a href="#l13.353"></a><span id="l13.353" class="difflineplus">+   * this value.</span>
<a href="#l13.354"></a><span id="l13.354" class="difflineplus">+   */</span>
<a href="#l13.355"></a><span id="l13.355" class="difflineplus">+  readonly attribute long long startTime;</span>
<a href="#l13.356"></a><span id="l13.356" class="difflineplus">+</span>
<a href="#l13.357"></a><span id="l13.357" class="difflineplus">+  /**</span>
<a href="#l13.358"></a><span id="l13.358" class="difflineplus">+   * The handler to invoke when the cancel button is pressed. If present</span>
<a href="#l13.359"></a><span id="l13.359" class="difflineplus">+   * (non-null), the activity can be canceled and a cancel button will be</span>
<a href="#l13.360"></a><span id="l13.360" class="difflineplus">+   * displayed to the user.  If null, it cannot be canceled and no button will</span>
<a href="#l13.361"></a><span id="l13.361" class="difflineplus">+   * be displayed.</span>
<a href="#l13.362"></a><span id="l13.362" class="difflineplus">+   */</span>
<a href="#l13.363"></a><span id="l13.363" class="difflineplus">+  attribute nsIActivityCancelHandler cancelHandler;</span>
<a href="#l13.364"></a><span id="l13.364" class="difflineplus">+  </span>
<a href="#l13.365"></a><span id="l13.365" class="difflineplus">+  /**</span>
<a href="#l13.366"></a><span id="l13.366" class="difflineplus">+   * The handler to invoke when the pause button is pressed. If present</span>
<a href="#l13.367"></a><span id="l13.367" class="difflineplus">+   * (non-null), the activity can be pauseable and a pause button will be</span>
<a href="#l13.368"></a><span id="l13.368" class="difflineplus">+   * displayed to the user.  If null, it cannot be paused and no button will</span>
<a href="#l13.369"></a><span id="l13.369" class="difflineplus">+   * be displayed.</span>
<a href="#l13.370"></a><span id="l13.370" class="difflineplus">+   */</span>
<a href="#l13.371"></a><span id="l13.371" class="difflineplus">+  attribute nsIActivityPauseHandler pauseHandler;</span>
<a href="#l13.372"></a><span id="l13.372" class="difflineplus">+  </span>
<a href="#l13.373"></a><span id="l13.373" class="difflineplus">+  /**</span>
<a href="#l13.374"></a><span id="l13.374" class="difflineplus">+   * The handler to invoke when the retry button is pressed. If present</span>
<a href="#l13.375"></a><span id="l13.375" class="difflineplus">+   * (non-null), the activity can be retryable and a retry button will be</span>
<a href="#l13.376"></a><span id="l13.376" class="difflineplus">+   * displayed to the user.  If null, it cannot be retried and no button will</span>
<a href="#l13.377"></a><span id="l13.377" class="difflineplus">+   * be displayed.</span>
<a href="#l13.378"></a><span id="l13.378" class="difflineplus">+   */</span>
<a href="#l13.379"></a><span id="l13.379" class="difflineplus">+  attribute nsIActivityRetryHandler retryHandler;</span>
<a href="#l13.380"></a><span id="l13.380" class="difflineplus">+  </span>
<a href="#l13.381"></a><span id="l13.381" class="difflineplus">+  /**</span>
<a href="#l13.382"></a><span id="l13.382" class="difflineplus">+   * Updates the activity progress info.</span>
<a href="#l13.383"></a><span id="l13.383" class="difflineplus">+   *</span>
<a href="#l13.384"></a><span id="l13.384" class="difflineplus">+   * @param aStatusText A localized text describing the current status of the</span>
<a href="#l13.385"></a><span id="l13.385" class="difflineplus">+   *                    process</span>
<a href="#l13.386"></a><span id="l13.386" class="difflineplus">+   * @param aWorkUnitComplete The amount of work units completed. Not used by</span>
<a href="#l13.387"></a><span id="l13.387" class="difflineplus">+   *                          Activity Manager or default binding for any</span>
<a href="#l13.388"></a><span id="l13.388" class="difflineplus">+   *                          purpose.</span>
<a href="#l13.389"></a><span id="l13.389" class="difflineplus">+   * @param aTotalWorkUnits Total amount of work units. Not used by</span>
<a href="#l13.390"></a><span id="l13.390" class="difflineplus">+   *                          Activity Manager or default binding for any</span>
<a href="#l13.391"></a><span id="l13.391" class="difflineplus">+   *                          purpose.</span>
<a href="#l13.392"></a><span id="l13.392" class="difflineplus">+   */</span>
<a href="#l13.393"></a><span id="l13.393" class="difflineplus">+  void setProgress(in AString aStatusText,</span>
<a href="#l13.394"></a><span id="l13.394" class="difflineplus">+                   in unsigned long aWorkUnitComplete,</span>
<a href="#l13.395"></a><span id="l13.395" class="difflineplus">+                   in unsigned long aTotalWorkUnits);</span>
<a href="#l13.396"></a><span id="l13.396" class="difflineplus">+  </span>
<a href="#l13.397"></a><span id="l13.397" class="difflineplus">+  /**</span>
<a href="#l13.398"></a><span id="l13.398" class="difflineplus">+   * Component initialization method.</span>
<a href="#l13.399"></a><span id="l13.399" class="difflineplus">+   *</span>
<a href="#l13.400"></a><span id="l13.400" class="difflineplus">+   * @param aDisplayText A localized text to be shown on the Activity Manager</span>
<a href="#l13.401"></a><span id="l13.401" class="difflineplus">+   *                     window</span>
<a href="#l13.402"></a><span id="l13.402" class="difflineplus">+   * @param aInitiator The initiator of the process</span>
<a href="#l13.403"></a><span id="l13.403" class="difflineplus">+   */</span>
<a href="#l13.404"></a><span id="l13.404" class="difflineplus">+  void init(in AString aDisplayText, in nsIVariant aInitiator);</span>
<a href="#l13.405"></a><span id="l13.405" class="difflineplus">+};</span>
<a href="#l13.406"></a><span id="l13.406" class="difflineplus">+</span>
<a href="#l13.407"></a><span id="l13.407" class="difflineplus">+/**</span>
<a href="#l13.408"></a><span id="l13.408" class="difflineplus">+ * Historical actions performed by the user, by extensions or by the system.</span>
<a href="#l13.409"></a><span id="l13.409" class="difflineplus">+ */</span>
<a href="#l13.410"></a><span id="l13.410" class="difflineplus">+[scriptable, uuid(5B1B0D03-2820-4E37-8BF8-102AFDE4FC45)]</span>
<a href="#l13.411"></a><span id="l13.411" class="difflineplus">+interface nsIActivityEvent : nsIActivity {</span>
<a href="#l13.412"></a><span id="l13.412" class="difflineplus">+  </span>
<a href="#l13.413"></a><span id="l13.413" class="difflineplus">+  /**</span>
<a href="#l13.414"></a><span id="l13.414" class="difflineplus">+   * Any localized textual information related to this event.</span>
<a href="#l13.415"></a><span id="l13.415" class="difflineplus">+   * It is shown at the bottom of the displayText area.</span>
<a href="#l13.416"></a><span id="l13.416" class="difflineplus">+   */</span>
<a href="#l13.417"></a><span id="l13.417" class="difflineplus">+  readonly attribute AString statusText;</span>
<a href="#l13.418"></a><span id="l13.418" class="difflineplus">+  </span>
<a href="#l13.419"></a><span id="l13.419" class="difflineplus">+  /**</span>
<a href="#l13.420"></a><span id="l13.420" class="difflineplus">+   * The starting time of the event.</span>
<a href="#l13.421"></a><span id="l13.421" class="difflineplus">+   * 64-bit signed integers relative to midnight (00:00:00), January 1, 1970</span>
<a href="#l13.422"></a><span id="l13.422" class="difflineplus">+   * Greenwich Mean Time (GMT). (GMT is also known as Coordinated Universal</span>
<a href="#l13.423"></a><span id="l13.423" class="difflineplus">+   * Time, UTC.). The units of time are in microseconds.</span>
<a href="#l13.424"></a><span id="l13.424" class="difflineplus">+   *</span>
<a href="#l13.425"></a><span id="l13.425" class="difflineplus">+   * In JS Date.now(), in C++ PR_Now() / PR_USEC_PER_MSEC can be used to set</span>
<a href="#l13.426"></a><span id="l13.426" class="difflineplus">+   * this value.</span>
<a href="#l13.427"></a><span id="l13.427" class="difflineplus">+   */</span>
<a href="#l13.428"></a><span id="l13.428" class="difflineplus">+  readonly attribute long long startTime;</span>
<a href="#l13.429"></a><span id="l13.429" class="difflineplus">+  </span>
<a href="#l13.430"></a><span id="l13.430" class="difflineplus">+  /**</span>
<a href="#l13.431"></a><span id="l13.431" class="difflineplus">+   * The completion time of the event in microseconds.</span>
<a href="#l13.432"></a><span id="l13.432" class="difflineplus">+   * 64-bit signed integers relative to midnight (00:00:00), January 1, 1970</span>
<a href="#l13.433"></a><span id="l13.433" class="difflineplus">+   * Greenwich Mean Time (GMT). (GMT is also known as Coordinated Universal</span>
<a href="#l13.434"></a><span id="l13.434" class="difflineplus">+   * Time, UTC.). The units of time are in microseconds.</span>
<a href="#l13.435"></a><span id="l13.435" class="difflineplus">+   *</span>
<a href="#l13.436"></a><span id="l13.436" class="difflineplus">+   * In JS Date.now(), in C++ PR_Now() / PR_USEC_PER_MSEC can be used to set</span>
<a href="#l13.437"></a><span id="l13.437" class="difflineplus">+   * this value.</span>
<a href="#l13.438"></a><span id="l13.438" class="difflineplus">+   */</span>
<a href="#l13.439"></a><span id="l13.439" class="difflineplus">+  readonly attribute long long completionTime;</span>
<a href="#l13.440"></a><span id="l13.440" class="difflineplus">+  </span>
<a href="#l13.441"></a><span id="l13.441" class="difflineplus">+  /**</span>
<a href="#l13.442"></a><span id="l13.442" class="difflineplus">+   * The handler to invoke when the undo button is pressed.  If present</span>
<a href="#l13.443"></a><span id="l13.443" class="difflineplus">+   * (non-null), the activity can be undoable and an undo button will be</span>
<a href="#l13.444"></a><span id="l13.444" class="difflineplus">+   * displayed to the user.  If null, it cannot be undone and no button will</span>
<a href="#l13.445"></a><span id="l13.445" class="difflineplus">+   * be displayed.</span>
<a href="#l13.446"></a><span id="l13.446" class="difflineplus">+   */</span>
<a href="#l13.447"></a><span id="l13.447" class="difflineplus">+  attribute nsIActivityUndoHandler undoHandler;</span>
<a href="#l13.448"></a><span id="l13.448" class="difflineplus">+  </span>
<a href="#l13.449"></a><span id="l13.449" class="difflineplus">+  /**</span>
<a href="#l13.450"></a><span id="l13.450" class="difflineplus">+   * Component initialization method.</span>
<a href="#l13.451"></a><span id="l13.451" class="difflineplus">+   *</span>
<a href="#l13.452"></a><span id="l13.452" class="difflineplus">+   * @param aDisplayText Any localized text describing the event and its context</span>
<a href="#l13.453"></a><span id="l13.453" class="difflineplus">+   * @param aInitiator The initiator of the event</span>
<a href="#l13.454"></a><span id="l13.454" class="difflineplus">+   * @param aStatusText Any localized additional information about the event</span>
<a href="#l13.455"></a><span id="l13.455" class="difflineplus">+   * @param aStartTime The starting time of the event</span>
<a href="#l13.456"></a><span id="l13.456" class="difflineplus">+   * @param aCompletionTime The completion time of the event</span>
<a href="#l13.457"></a><span id="l13.457" class="difflineplus">+   */</span>
<a href="#l13.458"></a><span id="l13.458" class="difflineplus">+  void init(in AString aDisplayText, in nsIVariant aInitiator,</span>
<a href="#l13.459"></a><span id="l13.459" class="difflineplus">+            in AString aStatusText, in long long aStartTime,</span>
<a href="#l13.460"></a><span id="l13.460" class="difflineplus">+            in long long aCompletionTime);</span>
<a href="#l13.461"></a><span id="l13.461" class="difflineplus">+};</span>
<a href="#l13.462"></a><span id="l13.462" class="difflineplus">+</span>
<a href="#l13.463"></a><span id="l13.463" class="difflineplus">+[scriptable, uuid(8265833e-c604-4585-a43c-a76bd8ed3a8c)]</span>
<a href="#l13.464"></a><span id="l13.464" class="difflineplus">+interface nsIActivityWarning : nsIActivity {</span>
<a href="#l13.465"></a><span id="l13.465" class="difflineplus">+  </span>
<a href="#l13.466"></a><span id="l13.466" class="difflineplus">+  /**</span>
<a href="#l13.467"></a><span id="l13.467" class="difflineplus">+   * Any localized textual information related to this warning.</span>
<a href="#l13.468"></a><span id="l13.468" class="difflineplus">+   */</span>
<a href="#l13.469"></a><span id="l13.469" class="difflineplus">+  readonly attribute AString warningText;</span>
<a href="#l13.470"></a><span id="l13.470" class="difflineplus">+  </span>
<a href="#l13.471"></a><span id="l13.471" class="difflineplus">+  /**</span>
<a href="#l13.472"></a><span id="l13.472" class="difflineplus">+   * The time of the warning.</span>
<a href="#l13.473"></a><span id="l13.473" class="difflineplus">+   * 64-bit signed integers relative to midnight (00:00:00), January 1, 1970</span>
<a href="#l13.474"></a><span id="l13.474" class="difflineplus">+   * Greenwich Mean Time (GMT). (GMT is also known as Coordinated Universal</span>
<a href="#l13.475"></a><span id="l13.475" class="difflineplus">+   * Time, UTC.). The units of time are in microseconds.</span>
<a href="#l13.476"></a><span id="l13.476" class="difflineplus">+   *</span>
<a href="#l13.477"></a><span id="l13.477" class="difflineplus">+   * In JS Date.now(), in C++ PR_Now() / PR_USEC_PER_MSEC can be used to set</span>
<a href="#l13.478"></a><span id="l13.478" class="difflineplus">+   * this value.</span>
<a href="#l13.479"></a><span id="l13.479" class="difflineplus">+   */</span>
<a href="#l13.480"></a><span id="l13.480" class="difflineplus">+  readonly attribute long long time;</span>
<a href="#l13.481"></a><span id="l13.481" class="difflineplus">+  </span>
<a href="#l13.482"></a><span id="l13.482" class="difflineplus">+  /**</span>
<a href="#l13.483"></a><span id="l13.483" class="difflineplus">+   * Recovery tip of the warning, localized.</span>
<a href="#l13.484"></a><span id="l13.484" class="difflineplus">+   */</span>
<a href="#l13.485"></a><span id="l13.485" class="difflineplus">+  readonly attribute AString recoveryTipText;</span>
<a href="#l13.486"></a><span id="l13.486" class="difflineplus">+  </span>
<a href="#l13.487"></a><span id="l13.487" class="difflineplus">+  /**</span>
<a href="#l13.488"></a><span id="l13.488" class="difflineplus">+   * The handler to invoke when the recover button is pressed.  If present</span>
<a href="#l13.489"></a><span id="l13.489" class="difflineplus">+   * (non-null), the activity can be recoverable and a recover button will be</span>
<a href="#l13.490"></a><span id="l13.490" class="difflineplus">+   * displayed to the user.  If null, it cannot be recovered and no button will</span>
<a href="#l13.491"></a><span id="l13.491" class="difflineplus">+   * be displayed.</span>
<a href="#l13.492"></a><span id="l13.492" class="difflineplus">+   */</span>
<a href="#l13.493"></a><span id="l13.493" class="difflineplus">+  attribute nsIActivityRecoveryHandler recoveryHandler;</span>
<a href="#l13.494"></a><span id="l13.494" class="difflineplus">+  </span>
<a href="#l13.495"></a><span id="l13.495" class="difflineplus">+  /**</span>
<a href="#l13.496"></a><span id="l13.496" class="difflineplus">+   * Component initialization method.</span>
<a href="#l13.497"></a><span id="l13.497" class="difflineplus">+   *</span>
<a href="#l13.498"></a><span id="l13.498" class="difflineplus">+   * @param aWarningText The localized text that will be shown on the display</span>
<a href="#l13.499"></a><span id="l13.499" class="difflineplus">+   *                     area</span>
<a href="#l13.500"></a><span id="l13.500" class="difflineplus">+   * @param aInitiator The initiator of the warning</span>
<a href="#l13.501"></a><span id="l13.501" class="difflineplus">+   * @param aRecoveryTip A localized textual information to guide the user in</span>
<a href="#l13.502"></a><span id="l13.502" class="difflineplus">+   *                     order to recover from the warning situation.</span>
<a href="#l13.503"></a><span id="l13.503" class="difflineplus">+   */</span>
<a href="#l13.504"></a><span id="l13.504" class="difflineplus">+  void init(in AString aWarningText, in nsIVariant aInitiator,</span>
<a href="#l13.505"></a><span id="l13.505" class="difflineplus">+            in AString aRecoveryTip);</span>
<a href="#l13.506"></a><span id="l13.506" class="difflineplus">+};</span>
<a href="#l13.507"></a><span id="l13.507" class="difflineplus">+</span>
<a href="#l13.508"></a><span id="l13.508" class="difflineplus">+[scriptable, uuid(abfcfa8a-c127-40dc-ac64-64b1ffc024ec)]</span>
<a href="#l13.509"></a><span id="l13.509" class="difflineplus">+interface nsIActivityListener : nsISupports {</span>
<a href="#l13.510"></a><span id="l13.510" class="difflineplus">+  /**</span>
<a href="#l13.511"></a><span id="l13.511" class="difflineplus">+   * Triggered after activity state is changed.</span>
<a href="#l13.512"></a><span id="l13.512" class="difflineplus">+   */</span>
<a href="#l13.513"></a><span id="l13.513" class="difflineplus">+  void onStateChanged(in nsIActivity aActivity, in short aOldState);</span>
<a href="#l13.514"></a><span id="l13.514" class="difflineplus">+  </span>
<a href="#l13.515"></a><span id="l13.515" class="difflineplus">+  /**</span>
<a href="#l13.516"></a><span id="l13.516" class="difflineplus">+   * Triggered after the progress of the process activity is changed.</span>
<a href="#l13.517"></a><span id="l13.517" class="difflineplus">+   */</span>
<a href="#l13.518"></a><span id="l13.518" class="difflineplus">+  void onProgressChanged(in nsIActivity aActivity, in long aPercentComplete,</span>
<a href="#l13.519"></a><span id="l13.519" class="difflineplus">+                         in AString aStatusText,</span>
<a href="#l13.520"></a><span id="l13.520" class="difflineplus">+                         in unsigned long aWorkUnitsCompleted,</span>
<a href="#l13.521"></a><span id="l13.521" class="difflineplus">+                         in unsigned long aTotalWorkUnits);</span>
<a href="#l13.522"></a><span id="l13.522" class="difflineplus">+  </span>
<a href="#l13.523"></a><span id="l13.523" class="difflineplus">+  /**</span>
<a href="#l13.524"></a><span id="l13.524" class="difflineplus">+   * Triggered after one of the activity handler is set.</span>
<a href="#l13.525"></a><span id="l13.525" class="difflineplus">+   *</span>
<a href="#l13.526"></a><span id="l13.526" class="difflineplus">+   * This is mostly used to update the UI of the activity when</span>
<a href="#l13.527"></a><span id="l13.527" class="difflineplus">+   * one of the handler is set to null after the operation is completed.</span>
<a href="#l13.528"></a><span id="l13.528" class="difflineplus">+   * For example after the activity is undoed, to make the undo button</span>
<a href="#l13.529"></a><span id="l13.529" class="difflineplus">+   * invisible.</span>
<a href="#l13.530"></a><span id="l13.530" class="difflineplus">+   */</span>
<a href="#l13.531"></a><span id="l13.531" class="difflineplus">+  void onHandlerChanged(in nsIActivity aActivity);</span>
<a href="#l13.532"></a><span id="l13.532" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1">new file mode 100644</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineminus">--- /dev/null</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineplus">+++ b/mail/components/activity/nsIActivityManager.idl</span>
<a href="#l14.4"></a><span id="l14.4" class="difflineat">@@ -0,0 +1,169 @@</span>
<a href="#l14.5"></a><span id="l14.5" class="difflineplus">+/* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l14.6"></a><span id="l14.6" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l14.7"></a><span id="l14.7" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l14.8"></a><span id="l14.8" class="difflineplus">+ *</span>
<a href="#l14.9"></a><span id="l14.9" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l14.10"></a><span id="l14.10" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l14.11"></a><span id="l14.11" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+ *</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+ * License.</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineplus">+ *</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineplus">+ * The Original Code is mozilla.org code.</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineplus">+ *</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineplus">+ * Netscape Communications Corporation.</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l14.25"></a><span id="l14.25" class="difflineplus">+ *</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineplus">+ * Contributor(s):</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineplus">+ *   David Ascher &lt;dascher@mozillamessaging.com&gt;</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineplus">+ *   Emre Birol &lt;ebirol@gmail.com&gt;</span>
<a href="#l14.29"></a><span id="l14.29" class="difflineplus">+ *</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l14.35"></a><span id="l14.35" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l14.36"></a><span id="l14.36" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l14.37"></a><span id="l14.37" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l14.38"></a><span id="l14.38" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l14.39"></a><span id="l14.39" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l14.40"></a><span id="l14.40" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineplus">+ *</span>
<a href="#l14.42"></a><span id="l14.42" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l14.43"></a><span id="l14.43" class="difflineplus">+</span>
<a href="#l14.44"></a><span id="l14.44" class="difflineplus">+#include &quot;nsISupports.idl&quot;</span>
<a href="#l14.45"></a><span id="l14.45" class="difflineplus">+</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineplus">+interface mozIStorageConnection;</span>
<a href="#l14.47"></a><span id="l14.47" class="difflineplus">+interface nsIActivity;</span>
<a href="#l14.48"></a><span id="l14.48" class="difflineplus">+interface nsIActivityProcess;</span>
<a href="#l14.49"></a><span id="l14.49" class="difflineplus">+interface nsIVariant;</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineplus">+</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+/**</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+ * See https://wiki.mozilla.org/Thunderbird:Activity_Manager/Developer for UML</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineplus">+ * diagram and sample codes.</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineplus">+ */</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineplus">+</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineplus">+/**</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineplus">+ * An interface to get notified by the major Activity Manager events.</span>
<a href="#l14.58"></a><span id="l14.58" class="difflineplus">+ * Mostly used by UI glue code in activity.js.</span>
<a href="#l14.59"></a><span id="l14.59" class="difflineplus">+ */</span>
<a href="#l14.60"></a><span id="l14.60" class="difflineplus">+[scriptable, uuid(8ed29f45-e0c4-4259-ad80-6ff177f87aa6)]</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineplus">+interface nsIActivityMgrListener : nsISupports {</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineplus">+  /**</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineplus">+   * Called _after_ activity manager adds an activity into</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineplus">+   * the managed list.</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineplus">+   */</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineplus">+  void onAddedActivity(in unsigned long aID, in nsIActivity aActivity);</span>
<a href="#l14.67"></a><span id="l14.67" class="difflineplus">+  </span>
<a href="#l14.68"></a><span id="l14.68" class="difflineplus">+  /**</span>
<a href="#l14.69"></a><span id="l14.69" class="difflineplus">+   * Called _after_ activity manager removes an activity from</span>
<a href="#l14.70"></a><span id="l14.70" class="difflineplus">+   * the managed list.</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineplus">+   */</span>
<a href="#l14.72"></a><span id="l14.72" class="difflineplus">+  void onRemovedActivity(in unsigned long aID);</span>
<a href="#l14.73"></a><span id="l14.73" class="difflineplus">+};</span>
<a href="#l14.74"></a><span id="l14.74" class="difflineplus">+</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineplus">+/**</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineplus">+ * Activity Manager is a simple component that understands how do display a</span>
<a href="#l14.77"></a><span id="l14.77" class="difflineplus">+ * combination of user activity and history. The activity manager works in</span>
<a href="#l14.78"></a><span id="l14.78" class="difflineplus">+ * conjunction with the 'Interactive Status Bar' to give the user the right</span>
<a href="#l14.79"></a><span id="l14.79" class="difflineplus">+ * level of notifications concerning what Thunderbird is doing on it's own and</span>
<a href="#l14.80"></a><span id="l14.80" class="difflineplus">+ * how Thunderbird has handled user requests.</span>
<a href="#l14.81"></a><span id="l14.81" class="difflineplus">+ *</span>
<a href="#l14.82"></a><span id="l14.82" class="difflineplus">+ * There are 3 different classifications of activity items which can be</span>
<a href="#l14.83"></a><span id="l14.83" class="difflineplus">+ * displayed in the Activity Manager Window:</span>
<a href="#l14.84"></a><span id="l14.84" class="difflineplus">+ *  o Process: Processes are transient in the display. They are not written to</span>
<a href="#l14.85"></a><span id="l14.85" class="difflineplus">+ *    disk as they are always acting on some data that already exists</span>
<a href="#l14.86"></a><span id="l14.86" class="difflineplus">+ *    locally or remotely. If a process has finished and needs to keep</span>
<a href="#l14.87"></a><span id="l14.87" class="difflineplus">+ *    some state for the user (like last sync time) it can convert</span>
<a href="#l14.88"></a><span id="l14.88" class="difflineplus">+ *    itself into an event.</span>
<a href="#l14.89"></a><span id="l14.89" class="difflineplus">+ * o Event: Historical actions performed by the user and created by a process</span>
<a href="#l14.90"></a><span id="l14.90" class="difflineplus">+ *   for the Activity Manager Window. Events can show up in the</span>
<a href="#l14.91"></a><span id="l14.91" class="difflineplus">+ *   'Interactive Status Bar' and be displayed to users as they are</span>
<a href="#l14.92"></a><span id="l14.92" class="difflineplus">+ *   created.</span>
<a href="#l14.93"></a><span id="l14.93" class="difflineplus">+ * o Warning: Alerts sent by Thunderbird or servers (i.e. imap server) that need</span>
<a href="#l14.94"></a><span id="l14.94" class="difflineplus">+ *   attention by the user. For example a Quota Alert from the imap</span>
<a href="#l14.95"></a><span id="l14.95" class="difflineplus">+ *   server can be represented as a Warning to the user. They are not</span>
<a href="#l14.96"></a><span id="l14.96" class="difflineplus">+ *   written to disk.</span>
<a href="#l14.97"></a><span id="l14.97" class="difflineplus">+ */</span>
<a href="#l14.98"></a><span id="l14.98" class="difflineplus">+[scriptable, uuid(9BFCC031-50E1-4D30-A35F-23509ABCB8D1)]</span>
<a href="#l14.99"></a><span id="l14.99" class="difflineplus">+interface nsIActivityManager : nsISupports {</span>
<a href="#l14.100"></a><span id="l14.100" class="difflineplus">+    </span>
<a href="#l14.101"></a><span id="l14.101" class="difflineplus">+  /**</span>
<a href="#l14.102"></a><span id="l14.102" class="difflineplus">+   * Adds the given activity into the managed activities list.</span>
<a href="#l14.103"></a><span id="l14.103" class="difflineplus">+   *</span>
<a href="#l14.104"></a><span id="l14.104" class="difflineplus">+   * @param aActivity The activity that will be added.</span>
<a href="#l14.105"></a><span id="l14.105" class="difflineplus">+   *</span>
<a href="#l14.106"></a><span id="l14.106" class="difflineplus">+   * @return Unique activity identifier.</span>
<a href="#l14.107"></a><span id="l14.107" class="difflineplus">+   */</span>
<a href="#l14.108"></a><span id="l14.108" class="difflineplus">+  unsigned long addActivity(in nsIActivity aActivity);</span>
<a href="#l14.109"></a><span id="l14.109" class="difflineplus">+  </span>
<a href="#l14.110"></a><span id="l14.110" class="difflineplus">+  /**</span>
<a href="#l14.111"></a><span id="l14.111" class="difflineplus">+   * Removes the activity with the given id if it's not currently</span>
<a href="#l14.112"></a><span id="l14.112" class="difflineplus">+   * in-progress.</span>
<a href="#l14.113"></a><span id="l14.113" class="difflineplus">+   *</span>
<a href="#l14.114"></a><span id="l14.114" class="difflineplus">+   * @param aID The unique ID of the activity.</span>
<a href="#l14.115"></a><span id="l14.115" class="difflineplus">+   *</span>
<a href="#l14.116"></a><span id="l14.116" class="difflineplus">+   * @throws NS_ERROR_FAILURE if the activity is in-progress.</span>
<a href="#l14.117"></a><span id="l14.117" class="difflineplus">+   * @throws NS_ERROR_NOT_AVAILABLE if the activity is not in the list.</span>
<a href="#l14.118"></a><span id="l14.118" class="difflineplus">+   */</span>
<a href="#l14.119"></a><span id="l14.119" class="difflineplus">+  void removeActivity(in unsigned long aID);</span>
<a href="#l14.120"></a><span id="l14.120" class="difflineplus">+</span>
<a href="#l14.121"></a><span id="l14.121" class="difflineplus">+  /**</span>
<a href="#l14.122"></a><span id="l14.122" class="difflineplus">+   * Retrieves an activity managed by the activity manager. This can be one that</span>
<a href="#l14.123"></a><span id="l14.123" class="difflineplus">+   * is in progress, or one that has completed in the past and is stored in the</span>
<a href="#l14.124"></a><span id="l14.124" class="difflineplus">+   * persistent store.</span>
<a href="#l14.125"></a><span id="l14.125" class="difflineplus">+   *</span>
<a href="#l14.126"></a><span id="l14.126" class="difflineplus">+   * @param aID The unique ID of the activity.</span>
<a href="#l14.127"></a><span id="l14.127" class="difflineplus">+   *</span>
<a href="#l14.128"></a><span id="l14.128" class="difflineplus">+   * @return The activity with the specified ID.</span>
<a href="#l14.129"></a><span id="l14.129" class="difflineplus">+   * @throws NS_ERROR_NOT_AVAILABLE if the activity is not in the list.</span>
<a href="#l14.130"></a><span id="l14.130" class="difflineplus">+   */</span>
<a href="#l14.131"></a><span id="l14.131" class="difflineplus">+  nsIActivity getActivity(in unsigned long aID);</span>
<a href="#l14.132"></a><span id="l14.132" class="difflineplus">+  </span>
<a href="#l14.133"></a><span id="l14.133" class="difflineplus">+  /**</span>
<a href="#l14.134"></a><span id="l14.134" class="difflineplus">+   * Tests wether the activity in question in the activity list or not.</span>
<a href="#l14.135"></a><span id="l14.135" class="difflineplus">+   */</span>
<a href="#l14.136"></a><span id="l14.136" class="difflineplus">+  boolean containsActivity(in unsigned long aID);</span>
<a href="#l14.137"></a><span id="l14.137" class="difflineplus">+  </span>
<a href="#l14.138"></a><span id="l14.138" class="difflineplus">+  /**</span>
<a href="#l14.139"></a><span id="l14.139" class="difflineplus">+   * Retrieves all activities managed by the activity manager. This can be one</span>
<a href="#l14.140"></a><span id="l14.140" class="difflineplus">+   * that is in progress (process), one that is represented as a warning, or one</span>
<a href="#l14.141"></a><span id="l14.141" class="difflineplus">+   * that has completed (event) in the past and is stored in the persistent</span>
<a href="#l14.142"></a><span id="l14.142" class="difflineplus">+   * store.</span>
<a href="#l14.143"></a><span id="l14.143" class="difflineplus">+   *</span>
<a href="#l14.144"></a><span id="l14.144" class="difflineplus">+   * @return A read-only list of activities managed by the activity manager.</span>
<a href="#l14.145"></a><span id="l14.145" class="difflineplus">+   */</span>
<a href="#l14.146"></a><span id="l14.146" class="difflineplus">+  void getActivities(out unsigned long length,</span>
<a href="#l14.147"></a><span id="l14.147" class="difflineplus">+                  [retval, array, size_is(length)] out nsIActivity aActivities);</span>
<a href="#l14.148"></a><span id="l14.148" class="difflineplus">+  </span>
<a href="#l14.149"></a><span id="l14.149" class="difflineplus">+  /**</span>
<a href="#l14.150"></a><span id="l14.150" class="difflineplus">+   * Retrieves processes with given context type and object.</span>
<a href="#l14.151"></a><span id="l14.151" class="difflineplus">+   *</span>
<a href="#l14.152"></a><span id="l14.152" class="difflineplus">+   * @return A read-only list of processes matching to given criteria.</span>
<a href="#l14.153"></a><span id="l14.153" class="difflineplus">+   */</span>
<a href="#l14.154"></a><span id="l14.154" class="difflineplus">+  void getProcessesByContext(in AString aContextType,</span>
<a href="#l14.155"></a><span id="l14.155" class="difflineplus">+                             in nsIVariant aContextObject,</span>
<a href="#l14.156"></a><span id="l14.156" class="difflineplus">+                             out unsigned long length,</span>
<a href="#l14.157"></a><span id="l14.157" class="difflineplus">+                             [retval, array, size_is(length)] out nsIActivityProcess aProcesses);</span>
<a href="#l14.158"></a><span id="l14.158" class="difflineplus">+</span>
<a href="#l14.159"></a><span id="l14.159" class="difflineplus">+  /**</span>
<a href="#l14.160"></a><span id="l14.160" class="difflineplus">+   * The number of processes in the activity list.</span>
<a href="#l14.161"></a><span id="l14.161" class="difflineplus">+   */</span>
<a href="#l14.162"></a><span id="l14.162" class="difflineplus">+  readonly attribute long processCount;</span>
<a href="#l14.163"></a><span id="l14.163" class="difflineplus">+  </span>
<a href="#l14.164"></a><span id="l14.164" class="difflineplus">+  /**</span>
<a href="#l14.165"></a><span id="l14.165" class="difflineplus">+   * Adds a listener.</span>
<a href="#l14.166"></a><span id="l14.166" class="difflineplus">+   */</span>
<a href="#l14.167"></a><span id="l14.167" class="difflineplus">+  void addListener(in nsIActivityMgrListener aListener);</span>
<a href="#l14.168"></a><span id="l14.168" class="difflineplus">+</span>
<a href="#l14.169"></a><span id="l14.169" class="difflineplus">+  /**</span>
<a href="#l14.170"></a><span id="l14.170" class="difflineplus">+   * Removes the given listener.</span>
<a href="#l14.171"></a><span id="l14.171" class="difflineplus">+   */</span>
<a href="#l14.172"></a><span id="l14.172" class="difflineplus">+  void removeListener(in nsIActivityMgrListener aListener);</span>
<a href="#l14.173"></a><span id="l14.173" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1">new file mode 100644</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineminus">--- /dev/null</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineplus">+++ b/mail/components/activity/nsIActivityManagerUI.idl</span>
<a href="#l15.4"></a><span id="l15.4" class="difflineat">@@ -0,0 +1,85 @@</span>
<a href="#l15.5"></a><span id="l15.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l15.6"></a><span id="l15.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l15.7"></a><span id="l15.7" class="difflineplus">+ *</span>
<a href="#l15.8"></a><span id="l15.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l15.9"></a><span id="l15.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l15.10"></a><span id="l15.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l15.11"></a><span id="l15.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineplus">+ *</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+ * License.</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineplus">+ *</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineplus">+ * The Original Code is mozilla.org code.</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+ *</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineplus">+ * Shawn Wilsher &lt;me@shawnwilsher.com&gt;.</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineplus">+ * David Ascher &lt;dascher@mozillamessaging.com&gt;</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+ *</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2007</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+ *</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineplus">+ * Contributor(s):</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineplus">+ *</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineplus">+ *</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineplus">+</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineplus">+#include &quot;nsISupports.idl&quot;</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineplus">+</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineplus">+interface nsIInterfaceRequestor;</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineplus">+</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineplus">+[scriptable, uuid(ae7853b0-2e1f-4dc1-89cd-f8bbfb745d4d)]</span>
<a href="#l15.48"></a><span id="l15.48" class="difflineplus">+interface nsIActivityManagerUI : nsISupports {</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineplus">+  /**</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineplus">+   * The reason that should be passed when the user requests to show the</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineplus">+   * activity manager's UI.</span>
<a href="#l15.52"></a><span id="l15.52" class="difflineplus">+   */</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineplus">+  const short REASON_USER_INTERACTED = 0;</span>
<a href="#l15.54"></a><span id="l15.54" class="difflineplus">+</span>
<a href="#l15.55"></a><span id="l15.55" class="difflineplus">+  /**</span>
<a href="#l15.56"></a><span id="l15.56" class="difflineplus">+   * The reason that should be passed to the show method when we are displaying</span>
<a href="#l15.57"></a><span id="l15.57" class="difflineplus">+   * the UI because a new activity is being added to it.</span>
<a href="#l15.58"></a><span id="l15.58" class="difflineplus">+   */</span>
<a href="#l15.59"></a><span id="l15.59" class="difflineplus">+  const short REASON_NEW_ACTIVITY = 1;</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineplus">+</span>
<a href="#l15.61"></a><span id="l15.61" class="difflineplus">+ /**</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineplus">+  * Shows the Activity Manager's UI to the user.</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineplus">+  *</span>
<a href="#l15.64"></a><span id="l15.64" class="difflineplus">+  * @param [optional] aWindowContext</span>
<a href="#l15.65"></a><span id="l15.65" class="difflineplus">+  *        The parent window context to show the UI.</span>
<a href="#l15.66"></a><span id="l15.66" class="difflineplus">+  * @param [optional] aID</span>
<a href="#l15.67"></a><span id="l15.67" class="difflineplus">+  *        The id of the activity to be preselected upon opening.</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineplus">+  * @param [optional] aReason</span>
<a href="#l15.69"></a><span id="l15.69" class="difflineplus">+  *        The reason to show the activity manager's UI.  This defaults to</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineplus">+  *        REASON_USER_INTERACTED, and should be one of the previously listed</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineplus">+  *        constants.</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineplus">+  */</span>
<a href="#l15.73"></a><span id="l15.73" class="difflineplus">+  void show([optional] in nsIInterfaceRequestor aWindowContext,</span>
<a href="#l15.74"></a><span id="l15.74" class="difflineplus">+            [optional] in unsigned long aID,</span>
<a href="#l15.75"></a><span id="l15.75" class="difflineplus">+            [optional] in short aReason);</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineplus">+</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineplus">+ /**</span>
<a href="#l15.78"></a><span id="l15.78" class="difflineplus">+  * Indicates if the UI is visible or not.</span>
<a href="#l15.79"></a><span id="l15.79" class="difflineplus">+  */</span>
<a href="#l15.80"></a><span id="l15.80" class="difflineplus">+  readonly attribute boolean visible;</span>
<a href="#l15.81"></a><span id="l15.81" class="difflineplus">+</span>
<a href="#l15.82"></a><span id="l15.82" class="difflineplus">+ /**</span>
<a href="#l15.83"></a><span id="l15.83" class="difflineplus">+  * Brings attention to the UI if it is already visible</span>
<a href="#l15.84"></a><span id="l15.84" class="difflineplus">+  *</span>
<a href="#l15.85"></a><span id="l15.85" class="difflineplus">+  * @throws NS_ERROR_UNEXPECTED if the UI is not visible.</span>
<a href="#l15.86"></a><span id="l15.86" class="difflineplus">+  */</span>
<a href="#l15.87"></a><span id="l15.87" class="difflineplus">+  void getAttention();</span>
<a href="#l15.88"></a><span id="l15.88" class="difflineplus">+};</span>
<a href="#l15.89"></a><span id="l15.89" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1">new file mode 100644</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineminus">--- /dev/null</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/activity.dtd</span>
<a href="#l16.4"></a><span id="l16.4" class="difflineat">@@ -0,0 +1,33 @@</span>
<a href="#l16.5"></a><span id="l16.5" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (window.width2, window.height): These values should be</span>
<a href="#l16.6"></a><span id="l16.6" class="difflineplus">+close to the golden ratio (1.618:1) while making sure it's wide enough for long</span>
<a href="#l16.7"></a><span id="l16.7" class="difflineplus">+file names and tall enough to hint that there are more activities in the list --&gt;</span>
<a href="#l16.8"></a><span id="l16.8" class="difflineplus">+&lt;!ENTITY window.width2                    &quot;485&quot;&gt;</span>
<a href="#l16.9"></a><span id="l16.9" class="difflineplus">+&lt;!ENTITY window.height                    &quot;300&quot;&gt;</span>
<a href="#l16.10"></a><span id="l16.10" class="difflineplus">+</span>
<a href="#l16.11"></a><span id="l16.11" class="difflineplus">+&lt;!ENTITY activity.title                  &quot;Activity Manager&quot;&gt;</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineplus">+</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+&lt;!ENTITY cmd.pause.label                  &quot;Pause&quot;&gt;</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+&lt;!ENTITY cmd.pause.accesskey              &quot;P&quot;&gt;</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+&lt;!ENTITY cmd.resume.label                 &quot;Resume&quot;&gt;</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineplus">+&lt;!ENTITY cmd.resume.accesskey             &quot;R&quot;&gt;</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineplus">+&lt;!ENTITY cmd.cancel.label                 &quot;Cancel&quot;&gt;</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineplus">+&lt;!ENTITY cmd.cancel.accesskey             &quot;C&quot;&gt;</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineplus">+&lt;!ENTITY cmd.undo.label                   &quot;Undo&quot;&gt;</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineplus">+&lt;!ENTITY cmd.undo.accesskey               &quot;U&quot;&gt;</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineplus">+&lt;!ENTITY cmd.recover.label                &quot;Recover&quot;&gt;</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineplus">+&lt;!ENTITY cmd.recover.accesskey            &quot;v&quot;&gt;</span>
<a href="#l16.23"></a><span id="l16.23" class="difflineplus">+&lt;!ENTITY cmd.retry.label                  &quot;Retry&quot;&gt;</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineplus">+&lt;!ENTITY cmd.retry.accesskey              &quot;R&quot;&gt;</span>
<a href="#l16.25"></a><span id="l16.25" class="difflineplus">+&lt;!ENTITY cmd.removeFromList.label         &quot;Remove From List&quot;&gt;</span>
<a href="#l16.26"></a><span id="l16.26" class="difflineplus">+&lt;!ENTITY cmd.removeFromList.accesskey     &quot;e&quot;&gt;</span>
<a href="#l16.27"></a><span id="l16.27" class="difflineplus">+</span>
<a href="#l16.28"></a><span id="l16.28" class="difflineplus">+&lt;!ENTITY cmd.close.commandkey             &quot;w&quot;&gt;</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineplus">+&lt;!ENTITY cmd.close2.commandkey            &quot;j&quot;&gt;</span>
<a href="#l16.30"></a><span id="l16.30" class="difflineplus">+&lt;!ENTITY cmd.close2Unix.commandkey        &quot;y&quot;&gt;</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineplus">+&lt;!ENTITY cmd.clearList.label              &quot;Clear List&quot;&gt;</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineplus">+&lt;!ENTITY cmd.clearList.tooltip            &quot;Removes completed, canceled, and failed items from the list&quot;&gt;</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineplus">+&lt;!ENTITY cmd.clearList.accesskey          &quot;C&quot;&gt;</span>
<a href="#l16.34"></a><span id="l16.34" class="difflineplus">+&lt;!ENTITY cmd.find.commandkey              &quot;f&quot;&gt;</span>
<a href="#l16.35"></a><span id="l16.35" class="difflineplus">+&lt;!ENTITY cmd.search.commandkey            &quot;k&quot;&gt;</span>
<a href="#l16.36"></a><span id="l16.36" class="difflineplus">+</span>
<a href="#l16.37"></a><span id="l16.37" class="difflineplus">+&lt;!ENTITY searchBox.label                  &quot;Search&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1">new file mode 100644</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineminus">--- /dev/null</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/activity.properties</span>
<a href="#l17.4"></a><span id="l17.4" class="difflineat">@@ -0,0 +1,23 @@</span>
<a href="#l17.5"></a><span id="l17.5" class="difflineplus">+# LOCALIZATION NOTE (seconds, minutes, hours, days): Semi-colon list of plural</span>
<a href="#l17.6"></a><span id="l17.6" class="difflineplus">+# forms. See: http://developer.mozilla.org/en/docs/Localization_and_Plurals</span>
<a href="#l17.7"></a><span id="l17.7" class="difflineplus">+seconds=second;seconds</span>
<a href="#l17.8"></a><span id="l17.8" class="difflineplus">+minutes=minute;minutes</span>
<a href="#l17.9"></a><span id="l17.9" class="difflineplus">+hours=hour;hours</span>
<a href="#l17.10"></a><span id="l17.10" class="difflineplus">+days=day;days</span>
<a href="#l17.11"></a><span id="l17.11" class="difflineplus">+</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+# Status Text</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+paused=Paused.</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+processing=Processing</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineplus">+notStarted=Not Started</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+failed=Failed</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineplus">+waitingForInput=Waiting for input</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineplus">+waitingForRetry=Waiting for retry</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineplus">+completed=Completed</span>
<a href="#l17.20"></a><span id="l17.20" class="difflineplus">+canceled=Canceled</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineplus">+cannotPause=This activity cannot be paused</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineplus">+autoRetry=Trying again in %S seconds</span>
<a href="#l17.23"></a><span id="l17.23" class="difflineplus">+</span>
<a href="#l17.24"></a><span id="l17.24" class="difflineplus">+# LOCALIZATION NOTE (yesterday): Displayed time for files finished yesterday</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineplus">+yesterday=Yesterday</span>
<a href="#l17.26"></a><span id="l17.26" class="difflineplus">+# LOCALIZATION NOTE (monthDate): #1 month name; #2 date number; e.g., January 22</span>
<a href="#l17.27"></a><span id="l17.27" class="difflineplus">+monthDate=#1 #2</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -404,16 +404,18 @@ you can use these alternative items. Oth</span>
<a href="#l18.4"></a><span id="l18.4"> &lt;!-- Windows Menu --&gt;</span>
<a href="#l18.5"></a><span id="l18.5"> &lt;!ENTITY windowMenu.label &quot;Window&quot;&gt;</span>
<a href="#l18.6"></a><span id="l18.6"> </span>
<a href="#l18.7"></a><span id="l18.7"> &lt;!-- Tools Menu --&gt;</span>
<a href="#l18.8"></a><span id="l18.8"> &lt;!ENTITY tasksMenu.label &quot;Tools&quot;&gt;</span>
<a href="#l18.9"></a><span id="l18.9"> &lt;!ENTITY tasksMenu.accesskey &quot;T&quot;&gt;</span>
<a href="#l18.10"></a><span id="l18.10"> &lt;!ENTITY addons.label &quot;Add-ons&quot;&gt;</span>
<a href="#l18.11"></a><span id="l18.11"> &lt;!ENTITY addons.accesskey &quot;d&quot;&gt;</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineplus">+&lt;!ENTITY activitymanager.label &quot;Activity Manager&quot;&gt;</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+&lt;!ENTITY activitymanager.accesskey &quot;a&quot;&gt;</span>
<a href="#l18.14"></a><span id="l18.14"> &lt;!ENTITY messengerCmd.label &quot;Mail &amp;amp; Newsgroups&quot;&gt;</span>
<a href="#l18.15"></a><span id="l18.15"> &lt;!ENTITY messengerCmd.accesskey &quot;m&quot;&gt;</span>
<a href="#l18.16"></a><span id="l18.16"> &lt;!ENTITY messengerCmd.commandkey &quot;1&quot;&gt;</span>
<a href="#l18.17"></a><span id="l18.17"> &lt;!ENTITY addressBookCmd.label &quot;Address Book&quot;&gt;</span>
<a href="#l18.18"></a><span id="l18.18"> &lt;!ENTITY addressBookCmd.accesskey &quot;a&quot;&gt;</span>
<a href="#l18.19"></a><span id="l18.19"> &lt;!ENTITY addressBookCmd.commandkey &quot;2&quot;&gt;</span>
<a href="#l18.20"></a><span id="l18.20"> &lt;!ENTITY runJunkControls.label &quot;Run Junk Mail Controls on Folder&quot;&gt;</span>
<a href="#l18.21"></a><span id="l18.21"> &lt;!ENTITY runJunkControls.accesskey &quot;u&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mail/locales/jar.mn</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mail/locales/jar.mn</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -123,16 +123,18 @@</span>
<a href="#l19.4"></a><span id="l19.4">   locale/@AB_CD@/messenger/preferences/changeaction.dtd                 (%chrome/messenger/preferences/changeaction.dtd)</span>
<a href="#l19.5"></a><span id="l19.5">   locale/@AB_CD@/messenger/preferences/fonts.dtd                        (%chrome/messenger/preferences/fonts.dtd)</span>
<a href="#l19.6"></a><span id="l19.6">   locale/@AB_CD@/messenger/preferences/offline.dtd                      (%chrome/messenger/preferences/offline.dtd)</span>
<a href="#l19.7"></a><span id="l19.7">   locale/@AB_CD@/messenger/preferences/notifications.dtd                (%chrome/messenger/preferences/notifications.dtd)</span>
<a href="#l19.8"></a><span id="l19.8">   locale/@AB_CD@/messenger/preferences/preferences.properties           (%chrome/messenger/preferences/preferences.properties)</span>
<a href="#l19.9"></a><span id="l19.9">   locale/@AB_CD@/messenger/migration/migration.dtd                      (%chrome/messenger/migration/migration.dtd)</span>
<a href="#l19.10"></a><span id="l19.10">   locale/@AB_CD@/messenger/migration/migration.properties               (%chrome/messenger/migration/migration.properties)</span>
<a href="#l19.11"></a><span id="l19.11">   locale/@AB_CD@/messenger/search/searchIntegrationDialogWin.dtd        (%chrome/messenger/search/searchIntegrationDialogWin.dtd)</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+  locale/@AB_CD@/messenger/activity.dtd                                 (%chrome/messenger/activity.dtd)</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+  locale/@AB_CD@/messenger/activity.properties                          (%chrome/messenger/activity.properties)</span>
<a href="#l19.14"></a><span id="l19.14"> % locale messenger-mapi @AB_CD@ %locale/@AB_CD@/messenger-mapi/</span>
<a href="#l19.15"></a><span id="l19.15">   locale/@AB_CD@/messenger-mapi/mapi.properties                         (%chrome/messenger-mapi/mapi.properties)</span>
<a href="#l19.16"></a><span id="l19.16"> % locale messenger-newsblog @AB_CD@ %locale/@AB_CD@/messenger-newsblog/</span>
<a href="#l19.17"></a><span id="l19.17">   locale/@AB_CD@/messenger-newsblog/newsblog.properties                 (%chrome/messenger-newsblog/newsblog.properties)</span>
<a href="#l19.18"></a><span id="l19.18">   locale/@AB_CD@/messenger-newsblog/feed-subscriptions.dtd              (%chrome/messenger-newsblog/feed-subscriptions.dtd)</span>
<a href="#l19.19"></a><span id="l19.19">   locale/@AB_CD@/messenger-newsblog/feed-properties.dtd                 (%chrome/messenger-newsblog/feed-properties.dtd)</span>
<a href="#l19.20"></a><span id="l19.20">   locale/@AB_CD@/messenger-newsblog/am-newsblog.properties              (%chrome/messenger-newsblog/am-newsblog.properties)</span>
<a href="#l19.21"></a><span id="l19.21">   locale/@AB_CD@/messenger-newsblog/am-newsblog.dtd                     (%chrome/messenger-newsblog/am-newsblog.dtd)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mail/themes/pinstripe/jar.mn</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mail/themes/pinstripe/jar.mn</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -20,16 +20,31 @@ classic.jar:</span>
<a href="#l20.4"></a><span id="l20.4">   skin/classic/messenger/virtualFolderListDialog.css             (mail/virtualFolderListDialog.css)</span>
<a href="#l20.5"></a><span id="l20.5">   skin/classic/messenger/searchDialog.css                        (mail/searchDialog.css)</span>
<a href="#l20.6"></a><span id="l20.6">   skin/classic/messenger/filterDialog.css                        (mail/filterDialog.css)</span>
<a href="#l20.7"></a><span id="l20.7"> * skin/classic/messenger/tabmailBindings.xml                     (mail/tabmailBindings.xml)</span>
<a href="#l20.8"></a><span id="l20.8">   skin/classic/messenger/tabmail.css                             (mail/tabmail.css)</span>
<a href="#l20.9"></a><span id="l20.9">   skin/classic/messenger/editContactOverlay.css                  (mail/editContactOverlay.css)</span>
<a href="#l20.10"></a><span id="l20.10">   skin/classic/messenger/starred48.png                           (mail/starred48.png)</span>
<a href="#l20.11"></a><span id="l20.11">   skin/classic/messenger/starIcons.png                           (mail/starIcons.png)</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineplus">+  skin/classic/messenger/activity/activity.css                   (mail/activity/activity.css)</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+  skin/classic/messenger/activity/buttons.png                    (mail/activity/buttons.png)  </span>
<a href="#l20.14"></a><span id="l20.14" class="difflineplus">+  skin/classic/messenger/activity/defaultProcessIcon.png         (mail/activity/defaultProcessIcon.png)</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineplus">+  skin/classic/messenger/activity/defaultEventIcon.png           (mail/activity/defaultEventIcon.png)</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineplus">+  skin/classic/messenger/activity/defaultWarningIcon.png         (mail/activity/defaultWarningIcon.png)</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineplus">+  skin/classic/messenger/activity/undoIcon.png                   (mail/activity/undoIcon.png)</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineplus">+  skin/classic/messenger/activity/syncMailIcon.png               (mail/activity/syncMailIcon.png)</span>
<a href="#l20.19"></a><span id="l20.19" class="difflineplus">+  skin/classic/messenger/activity/sendMailIcon.png               (mail/activity/sendMailIcon.png)</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineplus">+  skin/classic/messenger/activity/removeItemIcon.png             (mail/activity/removeItemIcon.png)</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineplus">+  skin/classic/messenger/activity/addItemIcon.png                (mail/activity/addItemIcon.png)</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineplus">+  skin/classic/messenger/activity/moveMailIcon.png               (mail/activity/moveMailIcon.png)</span>
<a href="#l20.23"></a><span id="l20.23" class="difflineplus">+  skin/classic/messenger/activity/copyMailIcon.png               (mail/activity/copyMailIcon.png)</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineplus">+  skin/classic/messenger/activity/deleteMailIcon.png             (mail/activity/deleteMailIcon.png)</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineplus">+  skin/classic/messenger/activity/compactMailIcon.png            (mail/activity/compactMailIcon.png)</span>
<a href="#l20.26"></a><span id="l20.26" class="difflineplus">+  skin/classic/messenger/activity/indexMailIcon.png              (mail/activity/indexMailIcon.png)</span>
<a href="#l20.27"></a><span id="l20.27">   skin/classic/messenger/hud-style-button-middle-background.png  (mail/hud-style-button-middle-background.png)</span>
<a href="#l20.28"></a><span id="l20.28">   skin/classic/messenger/addressbook/addressbook.css             (mail/addrbook/addressbook.css)</span>
<a href="#l20.29"></a><span id="l20.29">   skin/classic/messenger/addressbook/abContactsPanel.css         (mail/addrbook/abContactsPanel.css)</span>
<a href="#l20.30"></a><span id="l20.30">   skin/classic/messenger/addressbook/cardDialog.css              (mail/addrbook/cardDialog.css)</span>
<a href="#l20.31"></a><span id="l20.31">   skin/classic/messenger/addressbook/abResultsPane.css           (mail/addrbook/abResultsPane.css)</span>
<a href="#l20.32"></a><span id="l20.32">   skin/classic/messenger/addressbook/icons/abcard.png            (mail/addrbook/abcard.png)</span>
<a href="#l20.33"></a><span id="l20.33">   skin/classic/messenger/addressbook/icons/ablist.png            (mail/addrbook/ablist.png) </span>
<a href="#l20.34"></a><span id="l20.34">   skin/classic/messenger/addressbook/icons/addressbook-toolbar.png         (mail/addrbook/addressbook-toolbar.png)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1">new file mode 100644</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineminus">--- /dev/null</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineplus">+++ b/mail/themes/pinstripe/mail/activity/activity.css</span>
<a href="#l21.4"></a><span id="l21.4" class="difflineat">@@ -0,0 +1,359 @@</span>
<a href="#l21.5"></a><span id="l21.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l21.6"></a><span id="l21.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l21.7"></a><span id="l21.7" class="difflineplus">+ *</span>
<a href="#l21.8"></a><span id="l21.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l21.9"></a><span id="l21.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l21.10"></a><span id="l21.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l21.11"></a><span id="l21.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+ *</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineplus">+ * License.</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineplus">+ *</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineplus">+ * The Original Code is mozilla.org code.</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineplus">+ *</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l21.21"></a><span id="l21.21" class="difflineplus">+ * Netscape Communications Corporation.</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l21.23"></a><span id="l21.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l21.24"></a><span id="l21.24" class="difflineplus">+ *</span>
<a href="#l21.25"></a><span id="l21.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l21.26"></a><span id="l21.26" class="difflineplus">+ *   David Ascher &lt;dascher@mozillamessaging.com&gt;</span>
<a href="#l21.27"></a><span id="l21.27" class="difflineplus">+ *   Emre Birol &lt;ebirol@gmail.com&gt;</span>
<a href="#l21.28"></a><span id="l21.28" class="difflineplus">+ *</span>
<a href="#l21.29"></a><span id="l21.29" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l21.30"></a><span id="l21.30" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l21.31"></a><span id="l21.31" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l21.32"></a><span id="l21.32" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l21.33"></a><span id="l21.33" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l21.34"></a><span id="l21.34" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l21.35"></a><span id="l21.35" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l21.36"></a><span id="l21.36" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l21.37"></a><span id="l21.37" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l21.38"></a><span id="l21.38" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l21.39"></a><span id="l21.39" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l21.40"></a><span id="l21.40" class="difflineplus">+ *</span>
<a href="#l21.41"></a><span id="l21.41" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l21.42"></a><span id="l21.42" class="difflineplus">+</span>
<a href="#l21.43"></a><span id="l21.43" class="difflineplus">+.activityview {</span>
<a href="#l21.44"></a><span id="l21.44" class="difflineplus">+  -moz-appearance: none;</span>
<a href="#l21.45"></a><span id="l21.45" class="difflineplus">+  margin: 0;</span>
<a href="#l21.46"></a><span id="l21.46" class="difflineplus">+  padding: 0;</span>
<a href="#l21.47"></a><span id="l21.47" class="difflineplus">+  border-width: 0;</span>
<a href="#l21.48"></a><span id="l21.48" class="difflineplus">+}</span>
<a href="#l21.49"></a><span id="l21.49" class="difflineplus">+</span>
<a href="#l21.50"></a><span id="l21.50" class="difflineplus">+#search {</span>
<a href="#l21.51"></a><span id="l21.51" class="difflineplus">+  -moz-box-pack: end;</span>
<a href="#l21.52"></a><span id="l21.52" class="difflineplus">+  padding-top: 4px;</span>
<a href="#l21.53"></a><span id="l21.53" class="difflineplus">+  padding-right: 4px;</span>
<a href="#l21.54"></a><span id="l21.54" class="difflineplus">+  padding-bottom: 4px;</span>
<a href="#l21.55"></a><span id="l21.55" class="difflineplus">+  background-image: url(&quot;chrome://global/skin/toolbar/toolbar-background.gif&quot;);</span>
<a href="#l21.56"></a><span id="l21.56" class="difflineplus">+  background-color: #9f9f9f;</span>
<a href="#l21.57"></a><span id="l21.57" class="difflineplus">+  background-repeat: repeat-x;</span>
<a href="#l21.58"></a><span id="l21.58" class="difflineplus">+  background-position: top left;</span>
<a href="#l21.59"></a><span id="l21.59" class="difflineplus">+}</span>
<a href="#l21.60"></a><span id="l21.60" class="difflineplus">+</span>
<a href="#l21.61"></a><span id="l21.61" class="difflineplus">+#activityManager:not([active=&quot;true&quot;]) #search {</span>
<a href="#l21.62"></a><span id="l21.62" class="difflineplus">+  background-image: url(&quot;chrome://global/skin/toolbar/toolbar-background-inactive.png&quot;);</span>
<a href="#l21.63"></a><span id="l21.63" class="difflineplus">+  background-color: #cfcfcf;</span>
<a href="#l21.64"></a><span id="l21.64" class="difflineplus">+}</span>
<a href="#l21.65"></a><span id="l21.65" class="difflineplus">+</span>
<a href="#l21.66"></a><span id="l21.66" class="difflineplus">+#activityManager:not([active=&quot;true&quot;]) #search &gt; * {</span>
<a href="#l21.67"></a><span id="l21.67" class="difflineplus">+  opacity: 0.7;</span>
<a href="#l21.68"></a><span id="l21.68" class="difflineplus">+}</span>
<a href="#l21.69"></a><span id="l21.69" class="difflineplus">+</span>
<a href="#l21.70"></a><span id="l21.70" class="difflineplus">+#clearListButton {</span>
<a href="#l21.71"></a><span id="l21.71" class="difflineplus">+  -moz-appearance: none;</span>
<a href="#l21.72"></a><span id="l21.72" class="difflineplus">+  border: 1px solid #5F5F5F;</span>
<a href="#l21.73"></a><span id="l21.73" class="difflineplus">+  -moz-border-radius: 4px;</span>
<a href="#l21.74"></a><span id="l21.74" class="difflineplus">+  background: url(chrome://global/skin/icons/white-gray-gradient.gif) #A09E9D repeat-x top center;</span>
<a href="#l21.75"></a><span id="l21.75" class="difflineplus">+  min-height: 0;</span>
<a href="#l21.76"></a><span id="l21.76" class="difflineplus">+  min-width: 0;</span>
<a href="#l21.77"></a><span id="l21.77" class="difflineplus">+  padding: 2px;</span>
<a href="#l21.78"></a><span id="l21.78" class="difflineplus">+  margin: 0 6px;</span>
<a href="#l21.79"></a><span id="l21.79" class="difflineplus">+}</span>
<a href="#l21.80"></a><span id="l21.80" class="difflineplus">+</span>
<a href="#l21.81"></a><span id="l21.81" class="difflineplus">+#clearListButton:hover:active:not([disabled=&quot;true&quot;]) {</span>
<a href="#l21.82"></a><span id="l21.82" class="difflineplus">+  background: url(chrome://global/skin/icons/white-gray-gradient-active.gif);</span>
<a href="#l21.83"></a><span id="l21.83" class="difflineplus">+}</span>
<a href="#l21.84"></a><span id="l21.84" class="difflineplus">+</span>
<a href="#l21.85"></a><span id="l21.85" class="difflineplus">+/**</span>
<a href="#l21.86"></a><span id="l21.86" class="difflineplus">+ * Images for buttons in the interface</span>
<a href="#l21.87"></a><span id="l21.87" class="difflineplus">+ */</span>
<a href="#l21.88"></a><span id="l21.88" class="difflineplus">+</span>
<a href="#l21.89"></a><span id="l21.89" class="difflineplus">+activity-process button {</span>
<a href="#l21.90"></a><span id="l21.90" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/buttons.png);</span>
<a href="#l21.91"></a><span id="l21.91" class="difflineplus">+}</span>
<a href="#l21.92"></a><span id="l21.92" class="difflineplus">+.cancel {</span>
<a href="#l21.93"></a><span id="l21.93" class="difflineplus">+  -moz-image-region: rect(0px, 16px, 16px, 0px);</span>
<a href="#l21.94"></a><span id="l21.94" class="difflineplus">+}</span>
<a href="#l21.95"></a><span id="l21.95" class="difflineplus">+.cancel:hover {</span>
<a href="#l21.96"></a><span id="l21.96" class="difflineplus">+  -moz-image-region: rect(0px, 32px, 16px, 16px);</span>
<a href="#l21.97"></a><span id="l21.97" class="difflineplus">+}</span>
<a href="#l21.98"></a><span id="l21.98" class="difflineplus">+.cancel:hover:active {</span>
<a href="#l21.99"></a><span id="l21.99" class="difflineplus">+  -moz-image-region: rect(0px, 48px, 16px, 32px);</span>
<a href="#l21.100"></a><span id="l21.100" class="difflineplus">+}</span>
<a href="#l21.101"></a><span id="l21.101" class="difflineplus">+</span>
<a href="#l21.102"></a><span id="l21.102" class="difflineplus">+.pause {</span>
<a href="#l21.103"></a><span id="l21.103" class="difflineplus">+  -moz-image-region: rect(48px, 16px, 64px, 0px);</span>
<a href="#l21.104"></a><span id="l21.104" class="difflineplus">+}</span>
<a href="#l21.105"></a><span id="l21.105" class="difflineplus">+.pause:hover {</span>
<a href="#l21.106"></a><span id="l21.106" class="difflineplus">+  -moz-image-region: rect(48px, 32px, 64px, 16px);</span>
<a href="#l21.107"></a><span id="l21.107" class="difflineplus">+}</span>
<a href="#l21.108"></a><span id="l21.108" class="difflineplus">+.pause:not([disabled=&quot;true&quot;]):hover:active {</span>
<a href="#l21.109"></a><span id="l21.109" class="difflineplus">+  -moz-image-region: rect(48px, 48px, 64px, 32px);</span>
<a href="#l21.110"></a><span id="l21.110" class="difflineplus">+}</span>
<a href="#l21.111"></a><span id="l21.111" class="difflineplus">+.pause[disabled=&quot;true&quot;] {</span>
<a href="#l21.112"></a><span id="l21.112" class="difflineplus">+  -moz-image-region: rect(48px, 16px, 64px, 0px);</span>
<a href="#l21.113"></a><span id="l21.113" class="difflineplus">+}</span>
<a href="#l21.114"></a><span id="l21.114" class="difflineplus">+</span>
<a href="#l21.115"></a><span id="l21.115" class="difflineplus">+.resume {</span>
<a href="#l21.116"></a><span id="l21.116" class="difflineplus">+  -moz-image-region: rect(16px, 16px, 32px, 0px);</span>
<a href="#l21.117"></a><span id="l21.117" class="difflineplus">+}</span>
<a href="#l21.118"></a><span id="l21.118" class="difflineplus">+.resume:hover {</span>
<a href="#l21.119"></a><span id="l21.119" class="difflineplus">+  -moz-image-region: rect(16px, 32px, 32px, 16px);</span>
<a href="#l21.120"></a><span id="l21.120" class="difflineplus">+}</span>
<a href="#l21.121"></a><span id="l21.121" class="difflineplus">+.resume:hover:active {</span>
<a href="#l21.122"></a><span id="l21.122" class="difflineplus">+  -moz-image-region: rect(16px, 48px, 32px, 32px);</span>
<a href="#l21.123"></a><span id="l21.123" class="difflineplus">+}</span>
<a href="#l21.124"></a><span id="l21.124" class="difflineplus">+</span>
<a href="#l21.125"></a><span id="l21.125" class="difflineplus">+.retry {</span>
<a href="#l21.126"></a><span id="l21.126" class="difflineplus">+  -moz-image-region: rect(32px, 16px, 48px, 0px);</span>
<a href="#l21.127"></a><span id="l21.127" class="difflineplus">+  display: none;</span>
<a href="#l21.128"></a><span id="l21.128" class="difflineplus">+}</span>
<a href="#l21.129"></a><span id="l21.129" class="difflineplus">+.retry:hover {</span>
<a href="#l21.130"></a><span id="l21.130" class="difflineplus">+  -moz-image-region: rect(32px, 32px, 48px, 16px);</span>
<a href="#l21.131"></a><span id="l21.131" class="difflineplus">+}</span>
<a href="#l21.132"></a><span id="l21.132" class="difflineplus">+.retry:hover:active {</span>
<a href="#l21.133"></a><span id="l21.133" class="difflineplus">+  -moz-image-region: rect(32px, 48px, 48px, 32px);</span>
<a href="#l21.134"></a><span id="l21.134" class="difflineplus">+}</span>
<a href="#l21.135"></a><span id="l21.135" class="difflineplus">+.retry[enabled=&quot;true&quot;] {</span>
<a href="#l21.136"></a><span id="l21.136" class="difflineplus">+  display: inline;</span>
<a href="#l21.137"></a><span id="l21.137" class="difflineplus">+}</span>
<a href="#l21.138"></a><span id="l21.138" class="difflineplus">+</span>
<a href="#l21.139"></a><span id="l21.139" class="difflineplus">+.blockedIcon {</span>
<a href="#l21.140"></a><span id="l21.140" class="difflineplus">+  list-style-image: url(chrome://global/skin/icons/Error.png);</span>
<a href="#l21.141"></a><span id="l21.141" class="difflineplus">+}</span>
<a href="#l21.142"></a><span id="l21.142" class="difflineplus">+</span>
<a href="#l21.143"></a><span id="l21.143" class="difflineplus">+activity-process button {</span>
<a href="#l21.144"></a><span id="l21.144" class="difflineplus">+  -moz-appearance: none;</span>
<a href="#l21.145"></a><span id="l21.145" class="difflineplus">+  min-height: 16px;</span>
<a href="#l21.146"></a><span id="l21.146" class="difflineplus">+  min-width: 16px;</span>
<a href="#l21.147"></a><span id="l21.147" class="difflineplus">+  max-height: 16px;</span>
<a href="#l21.148"></a><span id="l21.148" class="difflineplus">+  max-width: 16px;</span>
<a href="#l21.149"></a><span id="l21.149" class="difflineplus">+  padding: 0;</span>
<a href="#l21.150"></a><span id="l21.150" class="difflineplus">+  margin: 0 1px 0 1px;</span>
<a href="#l21.151"></a><span id="l21.151" class="difflineplus">+}</span>
<a href="#l21.152"></a><span id="l21.152" class="difflineplus">+</span>
<a href="#l21.153"></a><span id="l21.153" class="difflineplus">+activity-event button {</span>
<a href="#l21.154"></a><span id="l21.154" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/buttons.png);</span>
<a href="#l21.155"></a><span id="l21.155" class="difflineplus">+}</span>
<a href="#l21.156"></a><span id="l21.156" class="difflineplus">+.undo {</span>
<a href="#l21.157"></a><span id="l21.157" class="difflineplus">+  -moz-image-region: rect(32px, 16px, 48px, 0px);</span>
<a href="#l21.158"></a><span id="l21.158" class="difflineplus">+}</span>
<a href="#l21.159"></a><span id="l21.159" class="difflineplus">+.undo:hover {</span>
<a href="#l21.160"></a><span id="l21.160" class="difflineplus">+  -moz-image-region: rect(32px, 32px, 48px, 16px);</span>
<a href="#l21.161"></a><span id="l21.161" class="difflineplus">+}</span>
<a href="#l21.162"></a><span id="l21.162" class="difflineplus">+.undo:hover:active {</span>
<a href="#l21.163"></a><span id="l21.163" class="difflineplus">+  -moz-image-region: rect(32px, 48px, 48px, 32px);</span>
<a href="#l21.164"></a><span id="l21.164" class="difflineplus">+}</span>
<a href="#l21.165"></a><span id="l21.165" class="difflineplus">+</span>
<a href="#l21.166"></a><span id="l21.166" class="difflineplus">+activity-event button {</span>
<a href="#l21.167"></a><span id="l21.167" class="difflineplus">+  -moz-appearance: none;</span>
<a href="#l21.168"></a><span id="l21.168" class="difflineplus">+  min-height: 16px;</span>
<a href="#l21.169"></a><span id="l21.169" class="difflineplus">+  min-width: 16px;</span>
<a href="#l21.170"></a><span id="l21.170" class="difflineplus">+  max-height: 16px;</span>
<a href="#l21.171"></a><span id="l21.171" class="difflineplus">+  max-width: 16px;</span>
<a href="#l21.172"></a><span id="l21.172" class="difflineplus">+  padding: 0;</span>
<a href="#l21.173"></a><span id="l21.173" class="difflineplus">+  margin: 0 1px 0 1px;</span>
<a href="#l21.174"></a><span id="l21.174" class="difflineplus">+}</span>
<a href="#l21.175"></a><span id="l21.175" class="difflineplus">+</span>
<a href="#l21.176"></a><span id="l21.176" class="difflineplus">+activity-warning button {</span>
<a href="#l21.177"></a><span id="l21.177" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/buttons.png);</span>
<a href="#l21.178"></a><span id="l21.178" class="difflineplus">+}</span>
<a href="#l21.179"></a><span id="l21.179" class="difflineplus">+.recover {</span>
<a href="#l21.180"></a><span id="l21.180" class="difflineplus">+  -moz-image-region: rect(32px, 16px, 48px, 0px);</span>
<a href="#l21.181"></a><span id="l21.181" class="difflineplus">+}</span>
<a href="#l21.182"></a><span id="l21.182" class="difflineplus">+.recover:hover {</span>
<a href="#l21.183"></a><span id="l21.183" class="difflineplus">+  -moz-image-region: rect(32px, 32px, 48px, 16px);</span>
<a href="#l21.184"></a><span id="l21.184" class="difflineplus">+}</span>
<a href="#l21.185"></a><span id="l21.185" class="difflineplus">+.recover:hover:active {</span>
<a href="#l21.186"></a><span id="l21.186" class="difflineplus">+  -moz-image-region: rect(32px, 48px, 48px, 32px);</span>
<a href="#l21.187"></a><span id="l21.187" class="difflineplus">+}</span>
<a href="#l21.188"></a><span id="l21.188" class="difflineplus">+</span>
<a href="#l21.189"></a><span id="l21.189" class="difflineplus">+activity-warning button {</span>
<a href="#l21.190"></a><span id="l21.190" class="difflineplus">+  -moz-appearance: none;</span>
<a href="#l21.191"></a><span id="l21.191" class="difflineplus">+  min-height: 16px;</span>
<a href="#l21.192"></a><span id="l21.192" class="difflineplus">+  min-width: 16px;</span>
<a href="#l21.193"></a><span id="l21.193" class="difflineplus">+  max-height: 16px;</span>
<a href="#l21.194"></a><span id="l21.194" class="difflineplus">+  max-width: 16px;</span>
<a href="#l21.195"></a><span id="l21.195" class="difflineplus">+  padding: 0;</span>
<a href="#l21.196"></a><span id="l21.196" class="difflineplus">+  margin: 0 1px 0 1px;</span>
<a href="#l21.197"></a><span id="l21.197" class="difflineplus">+}</span>
<a href="#l21.198"></a><span id="l21.198" class="difflineplus">+</span>
<a href="#l21.199"></a><span id="l21.199" class="difflineplus">+.activitygroupbox activity-event,</span>
<a href="#l21.200"></a><span id="l21.200" class="difflineplus">+.activitygroupbox activity-warning,</span>
<a href="#l21.201"></a><span id="l21.201" class="difflineplus">+.activitygroupbox activity-process {</span>
<a href="#l21.202"></a><span id="l21.202" class="difflineplus">+  padding-left: 2em;</span>
<a href="#l21.203"></a><span id="l21.203" class="difflineplus">+}</span>
<a href="#l21.204"></a><span id="l21.204" class="difflineplus">+</span>
<a href="#l21.205"></a><span id="l21.205" class="difflineplus">+activity-group button {</span>
<a href="#l21.206"></a><span id="l21.206" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/buttons.png);</span>
<a href="#l21.207"></a><span id="l21.207" class="difflineplus">+}</span>
<a href="#l21.208"></a><span id="l21.208" class="difflineplus">+.retry {</span>
<a href="#l21.209"></a><span id="l21.209" class="difflineplus">+  -moz-image-region: rect(32px, 16px, 48px, 0px);</span>
<a href="#l21.210"></a><span id="l21.210" class="difflineplus">+}</span>
<a href="#l21.211"></a><span id="l21.211" class="difflineplus">+.retry:hover {</span>
<a href="#l21.212"></a><span id="l21.212" class="difflineplus">+  -moz-image-region: rect(32px, 32px, 48px, 16px);</span>
<a href="#l21.213"></a><span id="l21.213" class="difflineplus">+}</span>
<a href="#l21.214"></a><span id="l21.214" class="difflineplus">+.retry:hover:active {</span>
<a href="#l21.215"></a><span id="l21.215" class="difflineplus">+  -moz-image-region: rect(32px, 48px, 48px, 32px);</span>
<a href="#l21.216"></a><span id="l21.216" class="difflineplus">+}</span>
<a href="#l21.217"></a><span id="l21.217" class="difflineplus">+</span>
<a href="#l21.218"></a><span id="l21.218" class="difflineplus">+activity-group button {</span>
<a href="#l21.219"></a><span id="l21.219" class="difflineplus">+  -moz-appearance: none;</span>
<a href="#l21.220"></a><span id="l21.220" class="difflineplus">+  min-height: 16px;</span>
<a href="#l21.221"></a><span id="l21.221" class="difflineplus">+  min-width: 16px;</span>
<a href="#l21.222"></a><span id="l21.222" class="difflineplus">+  max-height: 16px;</span>
<a href="#l21.223"></a><span id="l21.223" class="difflineplus">+  max-width: 16px;</span>
<a href="#l21.224"></a><span id="l21.224" class="difflineplus">+  padding: 0;</span>
<a href="#l21.225"></a><span id="l21.225" class="difflineplus">+  margin: 0 1px 0 1px;</span>
<a href="#l21.226"></a><span id="l21.226" class="difflineplus">+}</span>
<a href="#l21.227"></a><span id="l21.227" class="difflineplus">+</span>
<a href="#l21.228"></a><span id="l21.228" class="difflineplus">+/* Specialized Activity Bindings */</span>
<a href="#l21.229"></a><span id="l21.229" class="difflineplus">+</span>
<a href="#l21.230"></a><span id="l21.230" class="difflineplus">+activity-process {</span>
<a href="#l21.231"></a><span id="l21.231" class="difflineplus">+  padding: 3px 8px;</span>
<a href="#l21.232"></a><span id="l21.232" class="difflineplus">+  min-height: 40px !important;</span>
<a href="#l21.233"></a><span id="l21.233" class="difflineplus">+}</span>
<a href="#l21.234"></a><span id="l21.234" class="difflineplus">+</span>
<a href="#l21.235"></a><span id="l21.235" class="difflineplus">+activity-event[selected=&quot;true&quot;] {</span>
<a href="#l21.236"></a><span id="l21.236" class="difflineplus">+}</span>
<a href="#l21.237"></a><span id="l21.237" class="difflineplus">+</span>
<a href="#l21.238"></a><span id="l21.238" class="difflineplus">+activity-process .statusText {</span>
<a href="#l21.239"></a><span id="l21.239" class="difflineplus">+  font-size: smaller;</span>
<a href="#l21.240"></a><span id="l21.240" class="difflineplus">+  color: #555;</span>
<a href="#l21.241"></a><span id="l21.241" class="difflineplus">+}</span>
<a href="#l21.242"></a><span id="l21.242" class="difflineplus">+</span>
<a href="#l21.243"></a><span id="l21.243" class="difflineplus">+activity-event .dateTime,</span>
<a href="#l21.244"></a><span id="l21.244" class="difflineplus">+activity-event .statusText {</span>
<a href="#l21.245"></a><span id="l21.245" class="difflineplus">+  font-size: smaller;</span>
<a href="#l21.246"></a><span id="l21.246" class="difflineplus">+  color: #555;</span>
<a href="#l21.247"></a><span id="l21.247" class="difflineplus">+}</span>
<a href="#l21.248"></a><span id="l21.248" class="difflineplus">+</span>
<a href="#l21.249"></a><span id="l21.249" class="difflineplus">+activity-warning .dateTime,</span>
<a href="#l21.250"></a><span id="l21.250" class="difflineplus">+activity-warning .statusText {</span>
<a href="#l21.251"></a><span id="l21.251" class="difflineplus">+  font-size: smaller;</span>
<a href="#l21.252"></a><span id="l21.252" class="difflineplus">+  color: #555;</span>
<a href="#l21.253"></a><span id="l21.253" class="difflineplus">+}</span>
<a href="#l21.254"></a><span id="l21.254" class="difflineplus">+</span>
<a href="#l21.255"></a><span id="l21.255" class="difflineplus">+</span>
<a href="#l21.256"></a><span id="l21.256" class="difflineplus">+.processIconBox image {</span>
<a href="#l21.257"></a><span id="l21.257" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/defaultProcessIcon.png);</span>
<a href="#l21.258"></a><span id="l21.258" class="difflineplus">+}</span>
<a href="#l21.259"></a><span id="l21.259" class="difflineplus">+</span>
<a href="#l21.260"></a><span id="l21.260" class="difflineplus">+.eventIconBox image {</span>
<a href="#l21.261"></a><span id="l21.261" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/defaultEventIcon.png);</span>
<a href="#l21.262"></a><span id="l21.262" class="difflineplus">+}</span>
<a href="#l21.263"></a><span id="l21.263" class="difflineplus">+</span>
<a href="#l21.264"></a><span id="l21.264" class="difflineplus">+.warningIconBox image {</span>
<a href="#l21.265"></a><span id="l21.265" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/defaultWarningIcon.png);</span>
<a href="#l21.266"></a><span id="l21.266" class="difflineplus">+}</span>
<a href="#l21.267"></a><span id="l21.267" class="difflineplus">+</span>
<a href="#l21.268"></a><span id="l21.268" class="difflineplus">+image.syncMail {</span>
<a href="#l21.269"></a><span id="l21.269" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/syncMailIcon.png);</span>
<a href="#l21.270"></a><span id="l21.270" class="difflineplus">+}</span>
<a href="#l21.271"></a><span id="l21.271" class="difflineplus">+</span>
<a href="#l21.272"></a><span id="l21.272" class="difflineplus">+image.sendMail {</span>
<a href="#l21.273"></a><span id="l21.273" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/sendMailIcon.png);</span>
<a href="#l21.274"></a><span id="l21.274" class="difflineplus">+}</span>
<a href="#l21.275"></a><span id="l21.275" class="difflineplus">+</span>
<a href="#l21.276"></a><span id="l21.276" class="difflineplus">+image.copyMail {</span>
<a href="#l21.277"></a><span id="l21.277" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/copyMailIcon.png);</span>
<a href="#l21.278"></a><span id="l21.278" class="difflineplus">+}</span>
<a href="#l21.279"></a><span id="l21.279" class="difflineplus">+</span>
<a href="#l21.280"></a><span id="l21.280" class="difflineplus">+image.moveMail {</span>
<a href="#l21.281"></a><span id="l21.281" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/moveMailIcon.png);</span>
<a href="#l21.282"></a><span id="l21.282" class="difflineplus">+}</span>
<a href="#l21.283"></a><span id="l21.283" class="difflineplus">+</span>
<a href="#l21.284"></a><span id="l21.284" class="difflineplus">+image.deleteMail {</span>
<a href="#l21.285"></a><span id="l21.285" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/deleteMailIcon.png);</span>
<a href="#l21.286"></a><span id="l21.286" class="difflineplus">+}</span>
<a href="#l21.287"></a><span id="l21.287" class="difflineplus">+</span>
<a href="#l21.288"></a><span id="l21.288" class="difflineplus">+image.addItem {</span>
<a href="#l21.289"></a><span id="l21.289" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/addItemIcon.png);</span>
<a href="#l21.290"></a><span id="l21.290" class="difflineplus">+}</span>
<a href="#l21.291"></a><span id="l21.291" class="difflineplus">+</span>
<a href="#l21.292"></a><span id="l21.292" class="difflineplus">+image.removeItem {</span>
<a href="#l21.293"></a><span id="l21.293" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/removeItemIcon.png);</span>
<a href="#l21.294"></a><span id="l21.294" class="difflineplus">+}</span>
<a href="#l21.295"></a><span id="l21.295" class="difflineplus">+</span>
<a href="#l21.296"></a><span id="l21.296" class="difflineplus">+image.undo {</span>
<a href="#l21.297"></a><span id="l21.297" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/undoIcon.png);</span>
<a href="#l21.298"></a><span id="l21.298" class="difflineplus">+}</span>
<a href="#l21.299"></a><span id="l21.299" class="difflineplus">+</span>
<a href="#l21.300"></a><span id="l21.300" class="difflineplus">+image.indexMail {</span>
<a href="#l21.301"></a><span id="l21.301" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/indexMailIcon.png);</span>
<a href="#l21.302"></a><span id="l21.302" class="difflineplus">+}</span>
<a href="#l21.303"></a><span id="l21.303" class="difflineplus">+</span>
<a href="#l21.304"></a><span id="l21.304" class="difflineplus">+image.compactMail {</span>
<a href="#l21.305"></a><span id="l21.305" class="difflineplus">+  list-style-image: url(chrome://messenger/skin/activity/compactMailIcon.png);</span>
<a href="#l21.306"></a><span id="l21.306" class="difflineplus">+}</span>
<a href="#l21.307"></a><span id="l21.307" class="difflineplus">+</span>
<a href="#l21.308"></a><span id="l21.308" class="difflineplus">+/* prevent flickering when changing states */</span>
<a href="#l21.309"></a><span id="l21.309" class="difflineplus">+.activityTypeIcon {</span>
<a href="#l21.310"></a><span id="l21.310" class="difflineplus">+  min-height: 32px;</span>
<a href="#l21.311"></a><span id="l21.311" class="difflineplus">+  min-width: 32px;</span>
<a href="#l21.312"></a><span id="l21.312" class="difflineplus">+  -moz-padding-end: 2px;</span>
<a href="#l21.313"></a><span id="l21.313" class="difflineplus">+}</span>
<a href="#l21.314"></a><span id="l21.314" class="difflineplus">+</span>
<a href="#l21.315"></a><span id="l21.315" class="difflineplus">+</span>
<a href="#l21.316"></a><span id="l21.316" class="difflineplus">+/* these are copied from richlistbox.css, to give us a starting point on selection */</span>
<a href="#l21.317"></a><span id="l21.317" class="difflineplus">+</span>
<a href="#l21.318"></a><span id="l21.318" class="difflineplus">+activity-process, activity-warning, activity-event {</span>
<a href="#l21.319"></a><span id="l21.319" class="difflineplus">+  padding: 2px 4px;</span>
<a href="#l21.320"></a><span id="l21.320" class="difflineplus">+  background-color: -moz-Field;</span>
<a href="#l21.321"></a><span id="l21.321" class="difflineplus">+  color: -moz-FieldText;</span>
<a href="#l21.322"></a><span id="l21.322" class="difflineplus">+}</span>
<a href="#l21.323"></a><span id="l21.323" class="difflineplus">+</span>
<a href="#l21.324"></a><span id="l21.324" class="difflineplus">+activity-event[selected=&quot;true&quot;],activity-warning[selected=&quot;true&quot;],activity-process[selected=&quot;true&quot;]{</span>
<a href="#l21.325"></a><span id="l21.325" class="difflineplus">+  background-color: -moz-Dialog;</span>
<a href="#l21.326"></a><span id="l21.326" class="difflineplus">+  color: -moz-DialogText;</span>
<a href="#l21.327"></a><span id="l21.327" class="difflineplus">+}</span>
<a href="#l21.328"></a><span id="l21.328" class="difflineplus">+</span>
<a href="#l21.329"></a><span id="l21.329" class="difflineplus">+richlistbox.activitygroupbox:focus activity-process[selected=&quot;true&quot;]{</span>
<a href="#l21.330"></a><span id="l21.330" class="difflineplus">+  background-color: Highlight;</span>
<a href="#l21.331"></a><span id="l21.331" class="difflineplus">+  color: Highlight;</span>
<a href="#l21.332"></a><span id="l21.332" class="difflineplus">+}</span>
<a href="#l21.333"></a><span id="l21.333" class="difflineplus">+</span>
<a href="#l21.334"></a><span id="l21.334" class="difflineplus">+richlistbox:focus activity-event[selected=&quot;true&quot;],activity-warning[selected=&quot;true&quot;]{</span>
<a href="#l21.335"></a><span id="l21.335" class="difflineplus">+  background-color: Highlight;</span>
<a href="#l21.336"></a><span id="l21.336" class="difflineplus">+  color: Highlight;</span>
<a href="#l21.337"></a><span id="l21.337" class="difflineplus">+}</span>
<a href="#l21.338"></a><span id="l21.338" class="difflineplus">+</span>
<a href="#l21.339"></a><span id="l21.339" class="difflineplus">+richlistbox:focus activity-group[selected=&quot;true&quot;] {</span>
<a href="#l21.340"></a><span id="l21.340" class="difflineplus">+  background-color: Highlight;</span>
<a href="#l21.341"></a><span id="l21.341" class="difflineplus">+}</span>
<a href="#l21.342"></a><span id="l21.342" class="difflineplus">+</span>
<a href="#l21.343"></a><span id="l21.343" class="difflineplus">+</span>
<a href="#l21.344"></a><span id="l21.344" class="difflineplus">+richlistbox.activitygroupbox:focus activity-process[selected=&quot;true&quot;] .statusText,</span>
<a href="#l21.345"></a><span id="l21.345" class="difflineplus">+richlistbox.activitygroupbox:focus activity-process[selected=&quot;true&quot;] .dateTime,</span>
<a href="#l21.346"></a><span id="l21.346" class="difflineplus">+richlistbox.activitygroupbox:focus activity-process[selected=&quot;true&quot;] .displayText {</span>
<a href="#l21.347"></a><span id="l21.347" class="difflineplus">+  color: HighlightText;</span>
<a href="#l21.348"></a><span id="l21.348" class="difflineplus">+}</span>
<a href="#l21.349"></a><span id="l21.349" class="difflineplus">+</span>
<a href="#l21.350"></a><span id="l21.350" class="difflineplus">+richlistbox:focus activity-event[selected=&quot;true&quot;] .completionTime,</span>
<a href="#l21.351"></a><span id="l21.351" class="difflineplus">+richlistbox:focus activity-event[selected=&quot;true&quot;] .displayText,</span>
<a href="#l21.352"></a><span id="l21.352" class="difflineplus">+richlistbox:focus activity-event[selected=&quot;true&quot;] .dateTime,</span>
<a href="#l21.353"></a><span id="l21.353" class="difflineplus">+richlistbox:focus activity-event[selected=&quot;true&quot;] .statusText {</span>
<a href="#l21.354"></a><span id="l21.354" class="difflineplus">+  color: HighlightText;</span>
<a href="#l21.355"></a><span id="l21.355" class="difflineplus">+}</span>
<a href="#l21.356"></a><span id="l21.356" class="difflineplus">+</span>
<a href="#l21.357"></a><span id="l21.357" class="difflineplus">+richlistbox:focus activity-warning[selected=&quot;true&quot;] .dateTime,</span>
<a href="#l21.358"></a><span id="l21.358" class="difflineplus">+richlistbox:focus activity-warning[selected=&quot;true&quot;] .displayText,</span>
<a href="#l21.359"></a><span id="l21.359" class="difflineplus">+richlistbox:focus activity-warning[selected=&quot;true&quot;] .dateTime,</span>
<a href="#l21.360"></a><span id="l21.360" class="difflineplus">+richlistbox:focus activity-warning[selected=&quot;true&quot;] .statusText {</span>
<a href="#l21.361"></a><span id="l21.361" class="difflineplus">+  color: HighlightText;</span>
<a href="#l21.362"></a><span id="l21.362" class="difflineplus">+}</span>
<a href="#l21.363"></a><span id="l21.363" class="difflineplus">+</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

