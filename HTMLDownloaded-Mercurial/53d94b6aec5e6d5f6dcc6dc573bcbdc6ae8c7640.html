<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 15924:53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640" />
<meta property="og:url" content="/comm-central/rev/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640" />
<meta property="og:description" content="Bug 984917 - Remove Sunbird code Redux. r=Fallen" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640">shortlog</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640">files</a> |
changeset |
<a href="/comm-central/raw-rev/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640">raw</a>  | <a href="/comm-central/archive/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=984917">Bug 984917</a> - Remove Sunbird code Redux. r=Fallen
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#83;&#101;&#98;&#97;&#115;&#116;&#105;&#97;&#110;&#32;&#72;&#101;&#110;&#103;&#115;&#116;&#32;&#60;&#97;&#114;&#99;&#104;&#97;&#101;&#111;&#112;&#116;&#101;&#114;&#121;&#120;&#64;&#99;&#111;&#111;&#108;&#101;&#45;&#102;&#105;&#108;&#101;&#115;&#46;&#100;&#101;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 18 Mar 2014 15:27:00 +0100</td></tr>

<tr>
 <td>changeset 15924</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640">53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640</a></td>
</tr>



<tr>
<td>parent 15923</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/d6ee8f7c2fee84088600ce6a31f7bf1fad5ac6a3">d6ee8f7c2fee84088600ce6a31f7bf1fad5ac6a3</a>
</td>
</tr>

<tr>
<td>child 15925</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/1ba07b762e2e72e4f29ba0a467d03418104b79e4">1ba07b762e2e72e4f29ba0a467d03418104b79e4</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640">9983</a></td></tr>
<tr><td>push user</td><td>ryanvm@gmail.com</td></tr>
<tr><td>push date</td><td class="date age">Mon, 24 Mar 2014 13:20:53 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@1ba07b762e2e [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1ba07b762e2e72e4f29ba0a467d03418104b79e4">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1ba07b762e2e72e4f29ba0a467d03418104b79e4&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1ba07b762e2e72e4f29ba0a467d03418104b79e4&newProject=comm-central&newRevision=46881f948e10c5bdb2d65be69ef0250a164a5924&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1ba07b762e2e72e4f29ba0a467d03418104b79e4&newProject=comm-central&newRevision=46881f948e10c5bdb2d65be69ef0250a164a5924&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1ba07b762e2e72e4f29ba0a467d03418104b79e4&newProject=comm-central&newRevision=46881f948e10c5bdb2d65be69ef0250a164a5924&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Fallen%29&revcount=50">Fallen</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=984917">984917</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=984917">Bug 984917</a> - Remove Sunbird code Redux. r=Fallen</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-common-sets.js">calendar/base/content/calendar-common-sets.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-common-sets.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-common-sets.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-common-sets.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-common-sets.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-common-sets.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-task-tree.js">calendar/base/content/calendar-task-tree.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-task-tree.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-task-tree.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-task-tree.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-task-tree.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-task-tree.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-unifinder-todo.js">calendar/base/content/calendar-unifinder-todo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-unifinder-todo.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-unifinder-todo.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-unifinder-todo.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-unifinder-todo.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-unifinder-todo.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-views.js">calendar/base/content/calendar-views.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-views.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-views.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-views.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-views.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/calendar-views.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-alarm-dialog.js">calendar/base/content/dialogs/calendar-alarm-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-alarm-dialog.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-alarm-dialog.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-alarm-dialog.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-alarm-dialog.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-alarm-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.js">calendar/base/content/dialogs/calendar-event-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.xul">calendar/base/content/dialogs/calendar-event-dialog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.xul">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.xul">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.xul">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.xul">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-event-dialog.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-migration-dialog.js">calendar/base/content/dialogs/calendar-migration-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-migration-dialog.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-migration-dialog.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-migration-dialog.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-migration-dialog.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/content/dialogs/calendar-migration-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/jar.mn">calendar/base/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/jar.mn">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/jar.mn">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/jar.mn">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/jar.mn">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/modules/calProviderUtils.jsm">calendar/base/modules/calProviderUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/modules/calProviderUtils.jsm">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/modules/calProviderUtils.jsm">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/modules/calProviderUtils.jsm">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/modules/calProviderUtils.jsm">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/modules/calProviderUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calAlarmService.js">calendar/base/src/calAlarmService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calAlarmService.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calAlarmService.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calAlarmService.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calAlarmService.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calAlarmService.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calApplicationUtils.js">calendar/base/src/calApplicationUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calApplicationUtils.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calApplicationUtils.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calApplicationUtils.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calApplicationUtils.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calApplicationUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calCalendarManager.js">calendar/base/src/calCalendarManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calCalendarManager.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calCalendarManager.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calCalendarManager.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calCalendarManager.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calCalendarManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calUtils.js">calendar/base/src/calUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calUtils.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calUtils.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calUtils.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calUtils.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/base/src/calUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/lightning/content/messenger-overlay-sidebar.js">calendar/lightning/content/messenger-overlay-sidebar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/lightning/content/messenger-overlay-sidebar.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/lightning/content/messenger-overlay-sidebar.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/lightning/content/messenger-overlay-sidebar.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/lightning/content/messenger-overlay-sidebar.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/lightning/content/messenger-overlay-sidebar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/README.txt">calendar/locales/en-US/README.txt</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/README.txt">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/README.txt">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/README.txt">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/README.txt">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/README.txt">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/chrome/calendar/calendar.properties">calendar/locales/en-US/chrome/calendar/calendar.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/chrome/calendar/calendar.properties">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/chrome/calendar/calendar.properties">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/chrome/calendar/calendar.properties">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/chrome/calendar/calendar.properties">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/en-US/chrome/calendar/calendar.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/filter.py">calendar/locales/filter.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/filter.py">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/filter.py">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/filter.py">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/filter.py">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/filter.py">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/l10n-1.9.2.ini">calendar/locales/l10n-1.9.2.ini</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/l10n-1.9.2.ini">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/l10n-1.9.2.ini">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/l10n-1.9.2.ini">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/l10n.ini">calendar/locales/l10n.ini</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/l10n.ini">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/l10n.ini">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/l10n.ini">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/l10n.ini">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/locales/l10n.ini">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/content/gdata-migration.js">calendar/providers/gdata/content/gdata-migration.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/content/gdata-migration.js">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/content/gdata-migration.js">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/content/gdata-migration.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/content/gdata-migration.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/content/gdata-migration.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/install.rdf">calendar/providers/gdata/install.rdf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/install.rdf">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/install.rdf">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/install.rdf">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/install.rdf">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/install.rdf">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/jar.mn">calendar/providers/gdata/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/jar.mn">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/jar.mn">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/jar.mn">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/jar.mn">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/providers/gdata/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendar.js">calendar/resources/content/calendar.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendar.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendar.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendarService.js">calendar/resources/content/calendarService.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendarService.js">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendarService.js">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendarService.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendarService.manifest">calendar/resources/content/calendarService.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendarService.manifest">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendarService.manifest">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/content/calendarService.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/jar.mn">calendar/resources/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/jar.mn">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/jar.mn">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/jar.mn">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/jar.mn">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/moz.build">calendar/resources/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/moz.build">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/moz.build">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/moz.build">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/moz.build">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/resources/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/timezones/install.rdf">calendar/timezones/install.rdf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/timezones/install.rdf">file</a> |
<a href="/comm-central/annotate/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/timezones/install.rdf">annotate</a> |
<a href="/comm-central/diff/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/timezones/install.rdf">diff</a> |
<a href="/comm-central/comparison/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/timezones/install.rdf">comparison</a> |
<a href="/comm-central/log/53d94b6aec5e6d5f6dcc6dc573bcbdc6ae8c7640/calendar/timezones/install.rdf">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/calendar-common-sets.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/calendar-common-sets.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -233,19 +233,16 @@ var calendarController = {</span>
<a href="#l1.4"></a><span id="l1.4">                             } else if (focusedElement.className == &quot;calendar-task-tree&quot;) {</span>
<a href="#l1.5"></a><span id="l1.5">                                  return this.writable &amp;&amp;</span>
<a href="#l1.6"></a><span id="l1.6">                                         this.todo_items_selected &amp;&amp;</span>
<a href="#l1.7"></a><span id="l1.7">                                         this.todo_items_writable;</span>
<a href="#l1.8"></a><span id="l1.8">                             }</span>
<a href="#l1.9"></a><span id="l1.9">                         }</span>
<a href="#l1.10"></a><span id="l1.10">                     }</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-                    // If calendar is not in foreground, let the default controller take</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-                    // care. If we don't have a default controller (i.e sunbird), just</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-                    // continue.</span>
<a href="#l1.15"></a><span id="l1.15">                     if (this.defaultController.supportsCommand(aCommand)) {</span>
<a href="#l1.16"></a><span id="l1.16">                         return this.defaultController.isCommandEnabled(aCommand);</span>
<a href="#l1.17"></a><span id="l1.17">                     }</span>
<a href="#l1.18"></a><span id="l1.18">                 }</span>
<a href="#l1.19"></a><span id="l1.19">                 if (aCommand in this.commands) {</span>
<a href="#l1.20"></a><span id="l1.20">                     // All other commands we support should be enabled by default</span>
<a href="#l1.21"></a><span id="l1.21">                     return true;</span>
<a href="#l1.22"></a><span id="l1.22">                 }</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineat">@@ -414,43 +411,40 @@ var calendarController = {</span>
<a href="#l1.24"></a><span id="l1.24">                 } else {</span>
<a href="#l1.25"></a><span id="l1.25">                     selectAllItems();</span>
<a href="#l1.26"></a><span id="l1.26">                 }</span>
<a href="#l1.27"></a><span id="l1.27">                 break;</span>
<a href="#l1.28"></a><span id="l1.28"> </span>
<a href="#l1.29"></a><span id="l1.29">             default:</span>
<a href="#l1.30"></a><span id="l1.30">                 if (this.defaultController &amp;&amp; !this.isCalendarInForeground()) {</span>
<a href="#l1.31"></a><span id="l1.31">                     // If calendar is not in foreground, let the default controller take</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineminus">-                    // care. If we don't have a default controller (i.e sunbird), just</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineminus">-                    // continue.</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineplus">+                    // care. If we don't have a default controller, just continue.</span>
<a href="#l1.35"></a><span id="l1.35">                     this.defaultController.doCommand(aCommand);</span>
<a href="#l1.36"></a><span id="l1.36">                     return;</span>
<a href="#l1.37"></a><span id="l1.37">                 }</span>
<a href="#l1.38"></a><span id="l1.38"> </span>
<a href="#l1.39"></a><span id="l1.39">         }</span>
<a href="#l1.40"></a><span id="l1.40">         return;</span>
<a href="#l1.41"></a><span id="l1.41">     },</span>
<a href="#l1.42"></a><span id="l1.42"> </span>
<a href="#l1.43"></a><span id="l1.43">     onEvent: function cC_onEvent(aEvent) {</span>
<a href="#l1.44"></a><span id="l1.44">     },</span>
<a href="#l1.45"></a><span id="l1.45"> </span>
<a href="#l1.46"></a><span id="l1.46">     isCalendarInForeground: function cC_isCalendarInForeground() {</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineminus">-        // For sunbird, calendar is always in foreground. Otherwise check if</span>
<a href="#l1.48"></a><span id="l1.48" class="difflineminus">-        // we are in the correct mode.</span>
<a href="#l1.49"></a><span id="l1.49" class="difflineminus">-        return isSunbird() || (gCurrentMode &amp;&amp; gCurrentMode != &quot;mail&quot;);</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineplus">+        return gCurrentMode &amp;&amp; gCurrentMode != &quot;mail&quot;;</span>
<a href="#l1.51"></a><span id="l1.51">     },</span>
<a href="#l1.52"></a><span id="l1.52"> </span>
<a href="#l1.53"></a><span id="l1.53">     isInMode: function cC_isInMode(mode) {</span>
<a href="#l1.54"></a><span id="l1.54">         switch (mode) {</span>
<a href="#l1.55"></a><span id="l1.55">             case &quot;mail&quot;:</span>
<a href="#l1.56"></a><span id="l1.56">                 return !isCalendarInForeground();</span>
<a href="#l1.57"></a><span id="l1.57">             case &quot;calendar&quot;:</span>
<a href="#l1.58"></a><span id="l1.58" class="difflineminus">-                return isSunbird() || (gCurrentMode &amp;&amp; gCurrentMode == &quot;calendar&quot;);</span>
<a href="#l1.59"></a><span id="l1.59" class="difflineplus">+                return gCurrentMode &amp;&amp; gCurrentMode == &quot;calendar&quot;;</span>
<a href="#l1.60"></a><span id="l1.60">             case &quot;task&quot;:</span>
<a href="#l1.61"></a><span id="l1.61" class="difflineminus">-                return !isSunbird() &amp;&amp; (gCurrentMode &amp;&amp; gCurrentMode == &quot;task&quot;);</span>
<a href="#l1.62"></a><span id="l1.62" class="difflineplus">+                return gCurrentMode &amp;&amp; gCurrentMode == &quot;task&quot;;</span>
<a href="#l1.63"></a><span id="l1.63">         }</span>
<a href="#l1.64"></a><span id="l1.64">         return false;</span>
<a href="#l1.65"></a><span id="l1.65">     },</span>
<a href="#l1.66"></a><span id="l1.66"> </span>
<a href="#l1.67"></a><span id="l1.67">     onSelectionChanged: function cC_onSelectionChanged(aEvent) {</span>
<a href="#l1.68"></a><span id="l1.68">         var selectedItems = aEvent.detail;</span>
<a href="#l1.69"></a><span id="l1.69"> </span>
<a href="#l1.70"></a><span id="l1.70">         calendarUpdateDeleteCommand(selectedItems);</span>
<a href="#l1.71"></a><span id="l1.71" class="difflineat">@@ -490,19 +484,17 @@ var calendarController = {</span>
<a href="#l1.72"></a><span id="l1.72"> </span>
<a href="#l1.73"></a><span id="l1.73">         calendarController.selected_events_requires_network =</span>
<a href="#l1.74"></a><span id="l1.74">               (selected_events_requires_network == selLength);</span>
<a href="#l1.75"></a><span id="l1.75">         calendarController.selected_events_invitation =</span>
<a href="#l1.76"></a><span id="l1.76">               (selected_events_invitation == selLength);</span>
<a href="#l1.77"></a><span id="l1.77"> </span>
<a href="#l1.78"></a><span id="l1.78">         calendarController.updateCommands();</span>
<a href="#l1.79"></a><span id="l1.79">         calendarController2.updateCommands();</span>
<a href="#l1.80"></a><span id="l1.80" class="difflineminus">-        if(!isSunbird()) {</span>
<a href="#l1.81"></a><span id="l1.81" class="difflineminus">-            document.commandDispatcher.updateCommands('mail-toolbar');</span>
<a href="#l1.82"></a><span id="l1.82" class="difflineminus">-        }</span>
<a href="#l1.83"></a><span id="l1.83" class="difflineplus">+        document.commandDispatcher.updateCommands('mail-toolbar');</span>
<a href="#l1.84"></a><span id="l1.84">     },</span>
<a href="#l1.85"></a><span id="l1.85"> </span>
<a href="#l1.86"></a><span id="l1.86">     /**</span>
<a href="#l1.87"></a><span id="l1.87">      * Condition Helpers</span>
<a href="#l1.88"></a><span id="l1.88">      */</span>
<a href="#l1.89"></a><span id="l1.89"> </span>
<a href="#l1.90"></a><span id="l1.90">     // These attributes will be set up manually.</span>
<a href="#l1.91"></a><span id="l1.91">     item_selected: false,</span>
<a href="#l1.92"></a><span id="l1.92" class="difflineat">@@ -707,17 +699,16 @@ var calendarController2 = {</span>
<a href="#l1.93"></a><span id="l1.93">                 return calendarController.isInMode(&quot;task&quot;);</span>
<a href="#l1.94"></a><span id="l1.94">             default:</span>
<a href="#l1.95"></a><span id="l1.95">                 return true;</span>
<a href="#l1.96"></a><span id="l1.96">         }</span>
<a href="#l1.97"></a><span id="l1.97">     },</span>
<a href="#l1.98"></a><span id="l1.98"> </span>
<a href="#l1.99"></a><span id="l1.99">     doCommand: function doCommand(aCommand) {</span>
<a href="#l1.100"></a><span id="l1.100">         switch (aCommand) {</span>
<a href="#l1.101"></a><span id="l1.101" class="difflineminus">-            // These commands are overridden in lightning and native in sunbird.</span>
<a href="#l1.102"></a><span id="l1.102">             case &quot;cmd_cut&quot;:</span>
<a href="#l1.103"></a><span id="l1.103">                 cutToClipboard();</span>
<a href="#l1.104"></a><span id="l1.104">                 break;</span>
<a href="#l1.105"></a><span id="l1.105">             case &quot;cmd_copy&quot;:</span>
<a href="#l1.106"></a><span id="l1.106">                 copyToClipboard();</span>
<a href="#l1.107"></a><span id="l1.107">                 break;</span>
<a href="#l1.108"></a><span id="l1.108">             case &quot;cmd_paste&quot;:</span>
<a href="#l1.109"></a><span id="l1.109">                 pasteFromClipboard();</span>
<a href="#l1.110"></a><span id="l1.110" class="difflineat">@@ -765,39 +756,31 @@ var calendarController2 = {</span>
<a href="#l1.111"></a><span id="l1.111"> };</span>
<a href="#l1.112"></a><span id="l1.112"> </span>
<a href="#l1.113"></a><span id="l1.113"> /**</span>
<a href="#l1.114"></a><span id="l1.114">  * Inserts the command controller into the document. On Lightning, also make</span>
<a href="#l1.115"></a><span id="l1.115">  * sure that it is inserted before the conflicting thunderbird command</span>
<a href="#l1.116"></a><span id="l1.116">  * controller.</span>
<a href="#l1.117"></a><span id="l1.117">  */</span>
<a href="#l1.118"></a><span id="l1.118"> function injectCalendarCommandController() {</span>
<a href="#l1.119"></a><span id="l1.119" class="difflineminus">-    if (!isSunbird()) {</span>
<a href="#l1.120"></a><span id="l1.120" class="difflineminus">-        // We need to put our new command controller *before* the one that</span>
<a href="#l1.121"></a><span id="l1.121" class="difflineminus">-        // gets installed by thunderbird. Since we get called pretty early</span>
<a href="#l1.122"></a><span id="l1.122" class="difflineminus">-        // during startup we need to install the function below as a callback</span>
<a href="#l1.123"></a><span id="l1.123" class="difflineminus">-        // that periodically checks when the original thunderbird controller</span>
<a href="#l1.124"></a><span id="l1.124" class="difflineminus">-        // gets alive. Please note that setTimeout with a value of 0 means that</span>
<a href="#l1.125"></a><span id="l1.125" class="difflineminus">-        // we leave the current thread in order to re-enter the message loop.</span>
<a href="#l1.126"></a><span id="l1.126" class="difflineplus">+    // We need to put our new command controller *before* the one that</span>
<a href="#l1.127"></a><span id="l1.127" class="difflineplus">+    // gets installed by thunderbird. Since we get called pretty early</span>
<a href="#l1.128"></a><span id="l1.128" class="difflineplus">+    // during startup we need to install the function below as a callback</span>
<a href="#l1.129"></a><span id="l1.129" class="difflineplus">+    // that periodically checks when the original thunderbird controller</span>
<a href="#l1.130"></a><span id="l1.130" class="difflineplus">+    // gets alive. Please note that setTimeout with a value of 0 means that</span>
<a href="#l1.131"></a><span id="l1.131" class="difflineplus">+    // we leave the current thread in order to re-enter the message loop.</span>
<a href="#l1.132"></a><span id="l1.132"> </span>
<a href="#l1.133"></a><span id="l1.133" class="difflineminus">-        let tbController = top.controllers.getControllerForCommand(&quot;cmd_runJunkControls&quot;);</span>
<a href="#l1.134"></a><span id="l1.134" class="difflineminus">-        if (!tbController) {</span>
<a href="#l1.135"></a><span id="l1.135" class="difflineminus">-            setTimeout(injectCalendarCommandController, 0);</span>
<a href="#l1.136"></a><span id="l1.136" class="difflineminus">-            return;</span>
<a href="#l1.137"></a><span id="l1.137" class="difflineminus">-        } else {</span>
<a href="#l1.138"></a><span id="l1.138" class="difflineminus">-            calendarController.defaultController = tbController;</span>
<a href="#l1.139"></a><span id="l1.139" class="difflineminus">-        }</span>
<a href="#l1.140"></a><span id="l1.140" class="difflineplus">+    let tbController = top.controllers.getControllerForCommand(&quot;cmd_runJunkControls&quot;);</span>
<a href="#l1.141"></a><span id="l1.141" class="difflineplus">+    if (tbController) {</span>
<a href="#l1.142"></a><span id="l1.142" class="difflineplus">+        calendarController.defaultController = tbController;</span>
<a href="#l1.143"></a><span id="l1.143" class="difflineplus">+        top.controllers.insertControllerAt(0, calendarController);</span>
<a href="#l1.144"></a><span id="l1.144" class="difflineplus">+        document.commandDispatcher.updateCommands(&quot;calendar_commands&quot;);</span>
<a href="#l1.145"></a><span id="l1.145">     } else {</span>
<a href="#l1.146"></a><span id="l1.146" class="difflineminus">-        // On Sunbird, we also need to set up our hacky command controller.</span>
<a href="#l1.147"></a><span id="l1.147" class="difflineminus">-        top.controllers.insertControllerAt(0, calendarController2);</span>
<a href="#l1.148"></a><span id="l1.148" class="difflineplus">+        setTimeout(injectCalendarCommandController, 0);</span>
<a href="#l1.149"></a><span id="l1.149">     }</span>
<a href="#l1.150"></a><span id="l1.150" class="difflineminus">-</span>
<a href="#l1.151"></a><span id="l1.151" class="difflineminus">-    // This needs to be done for all applications</span>
<a href="#l1.152"></a><span id="l1.152" class="difflineminus">-    top.controllers.insertControllerAt(0, calendarController);</span>
<a href="#l1.153"></a><span id="l1.153" class="difflineminus">-    document.commandDispatcher.updateCommands(&quot;calendar_commands&quot;);</span>
<a href="#l1.154"></a><span id="l1.154"> }</span>
<a href="#l1.155"></a><span id="l1.155"> </span>
<a href="#l1.156"></a><span id="l1.156"> /**</span>
<a href="#l1.157"></a><span id="l1.157">  * Remove the calendar command controller from the document.</span>
<a href="#l1.158"></a><span id="l1.158">  */</span>
<a href="#l1.159"></a><span id="l1.159"> function removeCalendarCommandController() {</span>
<a href="#l1.160"></a><span id="l1.160">     top.controllers.removeController(calendarController);</span>
<a href="#l1.161"></a><span id="l1.161"> }</span>
<a href="#l1.162"></a><span id="l1.162" class="difflineat">@@ -844,23 +827,23 @@ function setupContextItemType(event, ite</span>
<a href="#l1.163"></a><span id="l1.163">  * Shows the given date in the current view, if in calendar mode.</span>
<a href="#l1.164"></a><span id="l1.164">  *</span>
<a href="#l1.165"></a><span id="l1.165">  * XXX This function is misplaced, should go to calendar-views.js or a minimonth</span>
<a href="#l1.166"></a><span id="l1.166">  * specific js file.</span>
<a href="#l1.167"></a><span id="l1.167">  *</span>
<a href="#l1.168"></a><span id="l1.168">  * @param aNewDate      The new date as a JSDate.</span>
<a href="#l1.169"></a><span id="l1.169">  */</span>
<a href="#l1.170"></a><span id="l1.170"> function minimonthPick(aNewDate) {</span>
<a href="#l1.171"></a><span id="l1.171" class="difflineminus">-  if (cal.isSunbird() || gCurrentMode == &quot;calendar&quot; || gCurrentMode == &quot;task&quot;) {</span>
<a href="#l1.172"></a><span id="l1.172" class="difflineplus">+  if (gCurrentMode == &quot;calendar&quot; || gCurrentMode == &quot;task&quot;) {</span>
<a href="#l1.173"></a><span id="l1.173">       let cdt = cal.jsDateToDateTime(aNewDate, currentView().timezone);</span>
<a href="#l1.174"></a><span id="l1.174">       cdt.isDate = true;</span>
<a href="#l1.175"></a><span id="l1.175">       currentView().goToDay(cdt);</span>
<a href="#l1.176"></a><span id="l1.176"> </span>
<a href="#l1.177"></a><span id="l1.177">       // update date filter for task tree</span>
<a href="#l1.178"></a><span id="l1.178" class="difflineminus">-      let tree = document.getElementById(cal.isSunbird() ? &quot;unifinder-todo-tree&quot; : &quot;calendar-task-tree&quot;);</span>
<a href="#l1.179"></a><span id="l1.179" class="difflineplus">+      let tree = document.getElementById(&quot;calendar-task-tree&quot;);</span>
<a href="#l1.180"></a><span id="l1.180">       tree.updateFilter();</span>
<a href="#l1.181"></a><span id="l1.181">   }</span>
<a href="#l1.182"></a><span id="l1.182"> }</span>
<a href="#l1.183"></a><span id="l1.183"> </span>
<a href="#l1.184"></a><span id="l1.184"> /**</span>
<a href="#l1.185"></a><span id="l1.185">  * Selects all items, based on which mode we are currently in and what task tree is focused</span>
<a href="#l1.186"></a><span id="l1.186">  */</span>
<a href="#l1.187"></a><span id="l1.187"> function selectAllItems() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/calendar-task-tree.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-tree.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -31,30 +31,29 @@ function addCalendarNames(aEvent) {</span>
<a href="#l2.4"></a><span id="l2.4">  * Change the opening context menu for the selected tasks.</span>
<a href="#l2.5"></a><span id="l2.5">  *</span>
<a href="#l2.6"></a><span id="l2.6">  * @param aEvent    The popupshowing event of the opening menu.</span>
<a href="#l2.7"></a><span id="l2.7">  */</span>
<a href="#l2.8"></a><span id="l2.8"> function changeContextMenuForTask(aEvent) {</span>
<a href="#l2.9"></a><span id="l2.9">     handleTaskContextMenuStateChange(aEvent);</span>
<a href="#l2.10"></a><span id="l2.10"> </span>
<a href="#l2.11"></a><span id="l2.11">     let idnode = document.popupNode.id;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-    let sunbird = cal.isSunbird();</span>
<a href="#l2.13"></a><span id="l2.13">     let items = getSelectedTasks(aEvent);</span>
<a href="#l2.14"></a><span id="l2.14">     document.getElementById(&quot;task-context-menu-new&quot;).hidden =</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineminus">-        (idnode == &quot;unifinder-todo-tree&quot; &amp;&amp; !sunbird);</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+        (idnode == &quot;unifinder-todo-tree&quot;);</span>
<a href="#l2.17"></a><span id="l2.17">     document.getElementById(&quot;task-context-menu-modify&quot;).hidden =</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineminus">-        (idnode == &quot;unifinder-todo-tree&quot; &amp;&amp; !sunbird);</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+        (idnode == &quot;unifinder-todo-tree&quot;);</span>
<a href="#l2.20"></a><span id="l2.20">     document.getElementById(&quot;task-context-menu-new-todaypane&quot;).hidden =</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineminus">-        (idnode == &quot;calendar-task-tree&quot; || sunbird);</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineplus">+        (idnode == &quot;calendar-task-tree&quot;);</span>
<a href="#l2.23"></a><span id="l2.23">     document.getElementById(&quot;task-context-menu-modify-todaypane&quot;).hidden =</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineminus">-        (idnode == &quot;calendar-task-tree&quot; || sunbird);</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineplus">+        (idnode == &quot;calendar-task-tree&quot;);</span>
<a href="#l2.26"></a><span id="l2.26">     document.getElementById(&quot;task-context-menu-filter-todaypane&quot;).hidden =</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineminus">-        (idnode == &quot;calendar-task-tree&quot; || sunbird);</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineplus">+        (idnode == &quot;calendar-task-tree&quot;);</span>
<a href="#l2.29"></a><span id="l2.29">     document.getElementById(&quot;task-context-menu-separator-filter&quot;).hidden =</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineminus">-        (idnode == &quot;calendar-task-tree&quot; || sunbird);</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+        (idnode == &quot;calendar-task-tree&quot;);</span>
<a href="#l2.32"></a><span id="l2.32"> </span>
<a href="#l2.33"></a><span id="l2.33">     let tasksSelected = (items.length &gt; 0);</span>
<a href="#l2.34"></a><span id="l2.34">     applyAttributeToMenuChildren(aEvent.target, &quot;disabled&quot;, (!tasksSelected));</span>
<a href="#l2.35"></a><span id="l2.35">     if (calendarController.isCommandEnabled(&quot;calendar_new_todo_command&quot;) &amp;&amp;</span>
<a href="#l2.36"></a><span id="l2.36">         calendarController.isCommandEnabled(&quot;calendar_new_todo_todaypane_command&quot;)) {</span>
<a href="#l2.37"></a><span id="l2.37">         document.getElementById(&quot;calendar_new_todo_command&quot;).removeAttribute(&quot;disabled&quot;);</span>
<a href="#l2.38"></a><span id="l2.38">         document.getElementById(&quot;calendar_new_todo_todaypane_command&quot;).removeAttribute(&quot;disabled&quot;);</span>
<a href="#l2.39"></a><span id="l2.39">     } else {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/calendar-unifinder-todo.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/calendar-unifinder-todo.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,20 +1,16 @@</span>
<a href="#l3.4"></a><span id="l3.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.5"></a><span id="l3.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.6"></a><span id="l3.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> /**</span>
<a href="#l3.9"></a><span id="l3.9">  * Called when the window is loaded to set up the unifinder-todo.</span>
<a href="#l3.10"></a><span id="l3.10">  */</span>
<a href="#l3.11"></a><span id="l3.11"> function prepareCalendarToDoUnifinder() {</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    if (isSunbird()) {</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-        document.getElementById(&quot;todo-label&quot;).removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-    }</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-</span>
<a href="#l3.16"></a><span id="l3.16">     // add listener to update the date filters</span>
<a href="#l3.17"></a><span id="l3.17">     getViewDeck().addEventListener(&quot;dayselect&quot;, updateCalendarToDoUnifinder, false);</span>
<a href="#l3.18"></a><span id="l3.18"> </span>
<a href="#l3.19"></a><span id="l3.19">     updateCalendarToDoUnifinder();</span>
<a href="#l3.20"></a><span id="l3.20"> }</span>
<a href="#l3.21"></a><span id="l3.21"> </span>
<a href="#l3.22"></a><span id="l3.22"> /**</span>
<a href="#l3.23"></a><span id="l3.23">  * Updates the applied filter and show completed view of the unifinder todo.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-views.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-views.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -236,32 +236,16 @@ var calendarViewController = {</span>
<a href="#l4.4"></a><span id="l4.4">                           ritem.oldItem,</span>
<a href="#l4.5"></a><span id="l4.5">                           null);</span>
<a href="#l4.6"></a><span id="l4.6">         }</span>
<a href="#l4.7"></a><span id="l4.7">         endBatchTransaction();</span>
<a href="#l4.8"></a><span id="l4.8">     }</span>
<a href="#l4.9"></a><span id="l4.9"> };</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11"> /**</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">- * This function provides a neutral way to switch between views.</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">- *</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">- * @param aType     The type of view to select.</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">- * @param aShow     If true, the calendar view is forced to be shown, i.e.</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">- *                    bringing the view to the front if the application is</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">- *                    showing other elements (Lightning).</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineminus">- */</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineminus">-function switchCalendarView(aType, aShow) {</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineminus">-    if (cal.isSunbird()) {</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineminus">-        sbSwitchToView(aType);</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineminus">-    } else {</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineminus">-        ltnSwitchCalendarView(aType, aShow);</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineminus">-    }</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineminus">-}</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineminus">-</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineminus">-/**</span>
<a href="#l4.28"></a><span id="l4.28">  * This function does the common steps to switch between views. Should be called</span>
<a href="#l4.29"></a><span id="l4.29">  * from app-specific view switching functions</span>
<a href="#l4.30"></a><span id="l4.30">  *</span>
<a href="#l4.31"></a><span id="l4.31">  * @param aViewType     The type of view to select.</span>
<a href="#l4.32"></a><span id="l4.32">  */</span>
<a href="#l4.33"></a><span id="l4.33"> function switchToView(aViewType) {</span>
<a href="#l4.34"></a><span id="l4.34">     var viewDeck = getViewDeck();</span>
<a href="#l4.35"></a><span id="l4.35">     var selectedDay;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-alarm-dialog.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-alarm-dialog.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -60,17 +60,17 @@ function onDismissAllAlarms() {</span>
<a href="#l5.4"></a><span id="l5.4">             parentItems[node.item.parentItem.hashId] = node.item.parentItem;</span>
<a href="#l5.5"></a><span id="l5.5">             getAlarmService().dismissAlarm(node.item, node.alarm);</span>
<a href="#l5.6"></a><span id="l5.6">         }</span>
<a href="#l5.7"></a><span id="l5.7">     }</span>
<a href="#l5.8"></a><span id="l5.8"> }</span>
<a href="#l5.9"></a><span id="l5.9"> </span>
<a href="#l5.10"></a><span id="l5.10"> /**</span>
<a href="#l5.11"></a><span id="l5.11">  * Event handler fired when the alarm widget's &quot;Details...&quot; label was clicked.</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">- * Open the event dialog in the most recent Sunbird or Thunderbird window</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+ * Open the event dialog in the most recent Thunderbird window.</span>
<a href="#l5.14"></a><span id="l5.14">  *</span>
<a href="#l5.15"></a><span id="l5.15">  * @param event     The itemdetails event.</span>
<a href="#l5.16"></a><span id="l5.16">  */</span>
<a href="#l5.17"></a><span id="l5.17"> function onItemDetails(event) {</span>
<a href="#l5.18"></a><span id="l5.18">     // We want this to happen in a calendar window if possible. Otherwise open</span>
<a href="#l5.19"></a><span id="l5.19">     // it using our window.</span>
<a href="#l5.20"></a><span id="l5.20">     let calWindow = cal.getCalendarWindow();</span>
<a href="#l5.21"></a><span id="l5.21">     if (calWindow) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1107,30 +1107,25 @@ function updateTitle() {</span>
<a href="#l6.4"></a><span id="l6.4"> }</span>
<a href="#l6.5"></a><span id="l6.5"> </span>
<a href="#l6.6"></a><span id="l6.6"> /**</span>
<a href="#l6.7"></a><span id="l6.7">  * Updates the stylesheet to add rules to hide certain aspects (i.e task only</span>
<a href="#l6.8"></a><span id="l6.8">  * elements when editing an event).</span>
<a href="#l6.9"></a><span id="l6.9">  *</span>
<a href="#l6.10"></a><span id="l6.10">  * TODO We can use general rules here, i.e</span>
<a href="#l6.11"></a><span id="l6.11">  *      dialog[itemType=&quot;task&quot;] .event-only,</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">- *      dialog[itemType=&quot;event&quot;] .task-only,</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">- *      dialog:not([product=&quot;lightning&quot;]) .lightning-only {</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+ *      dialog[itemType=&quot;event&quot;] .task-only {</span>
<a href="#l6.15"></a><span id="l6.15">  *          display: none;</span>
<a href="#l6.16"></a><span id="l6.16">  *      }</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineminus">- */</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+*/</span>
<a href="#l6.19"></a><span id="l6.19"> function updateStyle() {</span>
<a href="#l6.20"></a><span id="l6.20">     const kDialogStylesheet = &quot;chrome://calendar/skin/calendar-event-dialog.css&quot;;</span>
<a href="#l6.21"></a><span id="l6.21"> </span>
<a href="#l6.22"></a><span id="l6.22">     for each (let stylesheet in document.styleSheets) {</span>
<a href="#l6.23"></a><span id="l6.23">         if (stylesheet.href == kDialogStylesheet) {</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineminus">-            if (cal.isSunbird()) {</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineminus">-                stylesheet.insertRule(&quot;.lightning-only { display: none; }&quot;,</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineminus">-                                      stylesheet.cssRules.length);</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineminus">-            }</span>
<a href="#l6.28"></a><span id="l6.28">             if (cal.isEvent(window.calendarItem)) {</span>
<a href="#l6.29"></a><span id="l6.29">                 stylesheet.insertRule(&quot;.todo-only { display: none; }&quot;,</span>
<a href="#l6.30"></a><span id="l6.30">                                       stylesheet.cssRules.length);</span>
<a href="#l6.31"></a><span id="l6.31">             } else if (cal.isToDo(window.calendarItem)) {</span>
<a href="#l6.32"></a><span id="l6.32">                 stylesheet.insertRule(&quot;.event-only { display: none; }&quot;,</span>
<a href="#l6.33"></a><span id="l6.33">                                       stylesheet.cssRules.length);</span>
<a href="#l6.34"></a><span id="l6.34">             }</span>
<a href="#l6.35"></a><span id="l6.35">             return;</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineat">@@ -2959,33 +2954,26 @@ function onCommandCustomize() {</span>
<a href="#l6.37"></a><span id="l6.37">     for (var i = 0; i &lt; menubar.childNodes.length; ++i) {</span>
<a href="#l6.38"></a><span id="l6.38">         menubar.childNodes[i].setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l6.39"></a><span id="l6.39">     }</span>
<a href="#l6.40"></a><span id="l6.40"> </span>
<a href="#l6.41"></a><span id="l6.41">     // Disable the toolbar context menu items</span>
<a href="#l6.42"></a><span id="l6.42">     document.getElementById(&quot;cmd_customize&quot;).setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.43"></a><span id="l6.43"> </span>
<a href="#l6.44"></a><span id="l6.44">     var id = &quot;event-toolbox&quot;;</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineminus">-    if (isSunbird()) {</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineminus">-        window.openDialog(&quot;chrome://global/content/customizeToolbar.xul&quot;,</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineminus">-                          &quot;CustomizeToolbar&quot;,</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineminus">-                          &quot;chrome,all,dependent&quot;,</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineminus">-                          document.getElementById(id));</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-    } else {</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineminus">-        var wintype = document.documentElement.getAttribute(&quot;windowtype&quot;);</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineminus">-        wintype = wintype.replace(/:/g, &quot;&quot;);</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineminus">-</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineminus">-        window.openDialog(&quot;chrome://global/content/customizeToolbar.xul&quot;,</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineminus">-                          &quot;CustomizeToolbar&quot; + wintype,</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineminus">-                          &quot;chrome,all,dependent&quot;,</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineminus">-                          document.getElementById(id), // toolbar dom node</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineminus">-                          false,                       // is mode toolbar yes/no?</span>
<a href="#l6.59"></a><span id="l6.59" class="difflineminus">-                          null,                        // callback function</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineminus">-                          &quot;dialog&quot;);                   // name of this mode</span>
<a href="#l6.61"></a><span id="l6.61" class="difflineminus">-    }</span>
<a href="#l6.62"></a><span id="l6.62" class="difflineplus">+    var wintype = document.documentElement.getAttribute(&quot;windowtype&quot;);</span>
<a href="#l6.63"></a><span id="l6.63" class="difflineplus">+    wintype = wintype.replace(/:/g, &quot;&quot;);</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineplus">+</span>
<a href="#l6.65"></a><span id="l6.65" class="difflineplus">+    window.openDialog(&quot;chrome://global/content/customizeToolbar.xul&quot;,</span>
<a href="#l6.66"></a><span id="l6.66" class="difflineplus">+                      &quot;CustomizeToolbar&quot; + wintype,</span>
<a href="#l6.67"></a><span id="l6.67" class="difflineplus">+                      &quot;chrome,all,dependent&quot;,</span>
<a href="#l6.68"></a><span id="l6.68" class="difflineplus">+                      document.getElementById(id), // toolbar dom node</span>
<a href="#l6.69"></a><span id="l6.69" class="difflineplus">+                      false,                       // is mode toolbar yes/no?</span>
<a href="#l6.70"></a><span id="l6.70" class="difflineplus">+                      null,                        // callback function</span>
<a href="#l6.71"></a><span id="l6.71" class="difflineplus">+                      &quot;dialog&quot;);                   // name of this mode</span>
<a href="#l6.72"></a><span id="l6.72"> }</span>
<a href="#l6.73"></a><span id="l6.73"> </span>
<a href="#l6.74"></a><span id="l6.74"> /**</span>
<a href="#l6.75"></a><span id="l6.75">  * Prompts the user to change the start timezone.</span>
<a href="#l6.76"></a><span id="l6.76">  */</span>
<a href="#l6.77"></a><span id="l6.77"> function editStartTimezone() {</span>
<a href="#l6.78"></a><span id="l6.78">     editTimezone(&quot;timezone-starttime&quot;,</span>
<a href="#l6.79"></a><span id="l6.79">                  gStartTime.getInTimezone(gStartTimezone),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog.xul</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog.xul</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -286,38 +286,35 @@</span>
<a href="#l7.4"></a><span id="l7.4">                           label=&quot;&amp;event.menu.item.new.label;&quot;</span>
<a href="#l7.5"></a><span id="l7.5">                           accesskey=&quot;&amp;event.menu.item.new.accesskey;&quot;&gt;</span>
<a href="#l7.6"></a><span id="l7.6">                         &lt;menupopup id=&quot;item-new-menupopup&quot;&gt;</span>
<a href="#l7.7"></a><span id="l7.7">                             &lt;menuitem id=&quot;item-new-message-menuitem&quot;</span>
<a href="#l7.8"></a><span id="l7.8">                                       label=&quot;&amp;event.menu.item.new.message.label;&quot;</span>
<a href="#l7.9"></a><span id="l7.9">                                       accesskey=&quot;&amp;event.menu.item.new.message.accesskey;&quot;</span>
<a href="#l7.10"></a><span id="l7.10">                                       key=&quot;new-message-key&quot;</span>
<a href="#l7.11"></a><span id="l7.11">                                       command=&quot;cmd_item_new_message&quot;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-                                      disable-on-readonly=&quot;true&quot;</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-                                      class=&quot;lightning-only&quot;/&gt;</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+                                      disable-on-readonly=&quot;true&quot;/&gt;</span>
<a href="#l7.15"></a><span id="l7.15">                             &lt;menuitem id=&quot;item-new-event-menuitem&quot;</span>
<a href="#l7.16"></a><span id="l7.16">                                       label=&quot;&amp;event.menu.item.new.event.label;&quot;</span>
<a href="#l7.17"></a><span id="l7.17">                                       accesskey=&quot;&amp;event.menu.item.new.event.accesskey;&quot;</span>
<a href="#l7.18"></a><span id="l7.18">                                       key=&quot;new-event-key&quot;</span>
<a href="#l7.19"></a><span id="l7.19">                                       command=&quot;cmd_item_new_event&quot;</span>
<a href="#l7.20"></a><span id="l7.20">                                       disable-on-readonly=&quot;true&quot;/&gt;</span>
<a href="#l7.21"></a><span id="l7.21">                             &lt;menuitem id=&quot;item-new-task-menuitem&quot;</span>
<a href="#l7.22"></a><span id="l7.22">                                       label=&quot;&amp;event.menu.item.new.task.label;&quot;</span>
<a href="#l7.23"></a><span id="l7.23">                                       accesskey=&quot;&amp;event.menu.item.new.task.accesskey;&quot;</span>
<a href="#l7.24"></a><span id="l7.24">                                       key=&quot;new-task-key&quot;</span>
<a href="#l7.25"></a><span id="l7.25">                                       command=&quot;cmd_item_new_task&quot;</span>
<a href="#l7.26"></a><span id="l7.26">                                       disable-on-readonly=&quot;true&quot;/&gt;</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineminus">-                            &lt;menuseparator id=&quot;item-new-menuseparator1&quot;</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineminus">-                                           class=&quot;lightning-only&quot;/&gt;</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineplus">+                            &lt;menuseparator id=&quot;item-new-menuseparator1&quot;/&gt;</span>
<a href="#l7.30"></a><span id="l7.30">                             &lt;menuitem id=&quot;item-new-address-menuitem&quot;</span>
<a href="#l7.31"></a><span id="l7.31">                                       label=&quot;&amp;event.menu.item.new.contact.label;&quot;</span>
<a href="#l7.32"></a><span id="l7.32">                                       accesskey=&quot;&amp;event.menu.item.new.contact.accesskey;&quot;</span>
<a href="#l7.33"></a><span id="l7.33">                                       command=&quot;cmd_item_new_card&quot;</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineminus">-                                      disable-on-readonly=&quot;true&quot;</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineminus">-                                      class=&quot;lightning-only&quot;/&gt;</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+                                      disable-on-readonly=&quot;true&quot;/&gt;</span>
<a href="#l7.37"></a><span id="l7.37">                         &lt;/menupopup&gt;</span>
<a href="#l7.38"></a><span id="l7.38">                     &lt;/menu&gt;</span>
<a href="#l7.39"></a><span id="l7.39">                     &lt;menuseparator id=&quot;item-menuseparator1&quot;/&gt;</span>
<a href="#l7.40"></a><span id="l7.40">                     &lt;menuitem id=&quot;item-save-menuitem&quot;</span>
<a href="#l7.41"></a><span id="l7.41">                               label=&quot;&amp;event.menu.item.save.label;&quot;</span>
<a href="#l7.42"></a><span id="l7.42">                               accesskey=&quot;&amp;event.menu.item.save.accesskey;&quot;</span>
<a href="#l7.43"></a><span id="l7.43">                               key=&quot;save-key&quot;</span>
<a href="#l7.44"></a><span id="l7.44">                               command=&quot;cmd_save&quot;/&gt;</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineat">@@ -817,22 +814,20 @@</span>
<a href="#l7.46"></a><span id="l7.46">                        crop=&quot;right&quot;</span>
<a href="#l7.47"></a><span id="l7.47">                        tooltiptext=&quot;&quot;</span>
<a href="#l7.48"></a><span id="l7.48">                        onclick=&quot;showAttendeePopup(event)&quot;/&gt;</span>
<a href="#l7.49"></a><span id="l7.49">             &lt;/row&gt;</span>
<a href="#l7.50"></a><span id="l7.50">             &lt;row id=&quot;event-grid-attendee-row-2&quot;&gt;</span>
<a href="#l7.51"></a><span id="l7.51">                 &lt;spacer/&gt;</span>
<a href="#l7.52"></a><span id="l7.52">                 &lt;hbox id=&quot;notify-options-box&quot; align=&quot;center&quot;&gt;</span>
<a href="#l7.53"></a><span id="l7.53">                 &lt;checkbox id=&quot;notify-attendees-checkbox&quot;</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineminus">-                          class=&quot;lightning-only&quot;</span>
<a href="#l7.55"></a><span id="l7.55">                           label=&quot;&amp;event.attendees.notify.label;&quot;</span>
<a href="#l7.56"></a><span id="l7.56">                           oncommand=&quot;changeUndiscloseCheckboxStatus();&quot;</span>
<a href="#l7.57"></a><span id="l7.57">                           pack=&quot;start&quot;/&gt;</span>
<a href="#l7.58"></a><span id="l7.58">                 &lt;checkbox id=&quot;undisclose-attendees-checkbox&quot;</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineminus">-                          class=&quot;lightning-only&quot;</span>
<a href="#l7.60"></a><span id="l7.60">                           label=&quot;&amp;event.attendees.notifyundisclosed.label;&quot;</span>
<a href="#l7.61"></a><span id="l7.61">                           tooltiptext=&quot;&amp;event.attendees.notifyundisclosed.tooltip;&quot;</span>
<a href="#l7.62"></a><span id="l7.62">                           pack=&quot;start&quot;/&gt;</span>
<a href="#l7.63"></a><span id="l7.63">                 &lt;/hbox&gt;</span>
<a href="#l7.64"></a><span id="l7.64">             &lt;/row&gt;</span>
<a href="#l7.65"></a><span id="l7.65"> </span>
<a href="#l7.66"></a><span id="l7.66">             &lt;separator class=&quot;groove&quot; id=&quot;event-grid-basic-separator&quot;/&gt;</span>
<a href="#l7.67"></a><span id="l7.67"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-migration-dialog.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-migration-dialog.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -19,27 +19,25 @@ var gMigrateWizard = {</span>
<a href="#l8.4"></a><span id="l8.4">      * user can then check these off to migrate the data from those sources.</span>
<a href="#l8.5"></a><span id="l8.5">      */</span>
<a href="#l8.6"></a><span id="l8.6">     loadMigrators: function gmw_load() {</span>
<a href="#l8.7"></a><span id="l8.7">         var listbox = document.getElementById(&quot;datasource-list&quot;);</span>
<a href="#l8.8"></a><span id="l8.8"> </span>
<a href="#l8.9"></a><span id="l8.9">         //XXX Once we have branding for lightning, this hack can go away</span>
<a href="#l8.10"></a><span id="l8.10">         var props = Services.strings.createBundle(&quot;chrome://calendar/locale/migration.properties&quot;);</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-        if (!cal.isSunbird()) {</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-            var wizard = document.getElementById(&quot;migration-wizard&quot;);</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-            var desc = document.getElementById(&quot;wizard-desc&quot;);</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-            // Since we don't translate &quot;Lightning&quot;...</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineminus">-            wizard.title = props.formatStringFromName(&quot;migrationTitle&quot;,</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+        var wizard = document.getElementById(&quot;migration-wizard&quot;);</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+        var desc = document.getElementById(&quot;wizard-desc&quot;);</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+        // Since we don't translate &quot;Lightning&quot;...</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+        wizard.title = props.formatStringFromName(&quot;migrationTitle&quot;,</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineplus">+                                                  [&quot;Lightning&quot;],</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+                                                  1);</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+        desc.textContent = props.formatStringFromName(&quot;migrationDescription&quot;,</span>
<a href="#l8.24"></a><span id="l8.24">                                                       [&quot;Lightning&quot;],</span>
<a href="#l8.25"></a><span id="l8.25">                                                       1);</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineminus">-            desc.textContent = props.formatStringFromName(&quot;migrationDescription&quot;,</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineminus">-                                                          [&quot;Lightning&quot;],</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineminus">-                                                          1);</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineminus">-        }</span>
<a href="#l8.30"></a><span id="l8.30"> </span>
<a href="#l8.31"></a><span id="l8.31">         migLOG(&quot;migrators: &quot; + window.arguments.length);</span>
<a href="#l8.32"></a><span id="l8.32">         for each (var migrator in window.arguments[0]) {</span>
<a href="#l8.33"></a><span id="l8.33">             var listItem = document.createElement(&quot;listitem&quot;);</span>
<a href="#l8.34"></a><span id="l8.34">             listItem.setAttribute(&quot;type&quot;, &quot;checkbox&quot;);</span>
<a href="#l8.35"></a><span id="l8.35">             listItem.setAttribute(&quot;checked&quot;, true);</span>
<a href="#l8.36"></a><span id="l8.36">             listItem.setAttribute(&quot;label&quot;, migrator.title);</span>
<a href="#l8.37"></a><span id="l8.37">             listItem.migrator = migrator;</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineat">@@ -290,44 +288,32 @@ var gDataMigrator = {</span>
<a href="#l8.39"></a><span id="l8.39">         var migrators = [];</span>
<a href="#l8.40"></a><span id="l8.40"> </span>
<a href="#l8.41"></a><span id="l8.41">         // Look in our current profile directory, in case we're upgrading in</span>
<a href="#l8.42"></a><span id="l8.42">         // place</span>
<a href="#l8.43"></a><span id="l8.43">         var profileDir = this.dirService.get(&quot;ProfD&quot;, Components.interfaces.nsILocalFile);</span>
<a href="#l8.44"></a><span id="l8.44">         profileDir.append(&quot;Calendar&quot;);</span>
<a href="#l8.45"></a><span id="l8.45">         if (profileDir.exists()) {</span>
<a href="#l8.46"></a><span id="l8.46">             migLOG(&quot;Found old extension directory in current app&quot;);</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineminus">-            var title;</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineminus">-            if (!cal.isSunbird()) {</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineminus">-                title = &quot;Mozilla Calendar Extension&quot;;</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineminus">-            } else {</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineminus">-                title = &quot;Sunbird 0.2&quot;;</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineminus">-            }</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineplus">+            let title = &quot;Mozilla Calendar Extension&quot;;</span>
<a href="#l8.54"></a><span id="l8.54">             migrators.push(new dataMigrator(title, extMigrator, [profileDir]));</span>
<a href="#l8.55"></a><span id="l8.55">         }</span>
<a href="#l8.56"></a><span id="l8.56"> </span>
<a href="#l8.57"></a><span id="l8.57">         // Check the profiles of the various other moz-apps for calendar data</span>
<a href="#l8.58"></a><span id="l8.58">         var profiles = [];</span>
<a href="#l8.59"></a><span id="l8.59"> </span>
<a href="#l8.60"></a><span id="l8.60">         // Do they use Firefox?</span>
<a href="#l8.61"></a><span id="l8.61">         var ffProf, sbProf, tbProf;</span>
<a href="#l8.62"></a><span id="l8.62">         if ((ffProf = this.getFirefoxProfile())) {</span>
<a href="#l8.63"></a><span id="l8.63">             profiles.push(ffProf);</span>
<a href="#l8.64"></a><span id="l8.64">         }</span>
<a href="#l8.65"></a><span id="l8.65"> </span>
<a href="#l8.66"></a><span id="l8.66" class="difflineminus">-        if (!cal.isSunbird()) {</span>
<a href="#l8.67"></a><span id="l8.67" class="difflineminus">-            // If we're lightning, check Sunbird</span>
<a href="#l8.68"></a><span id="l8.68" class="difflineminus">-            if ((sbProf = this.getSunbirdProfile())) {</span>
<a href="#l8.69"></a><span id="l8.69" class="difflineminus">-                profiles.push(sbProf);</span>
<a href="#l8.70"></a><span id="l8.70" class="difflineminus">-            }</span>
<a href="#l8.71"></a><span id="l8.71" class="difflineminus">-        } else {</span>
<a href="#l8.72"></a><span id="l8.72" class="difflineminus">-            // Otherwise, check Thunderbird</span>
<a href="#l8.73"></a><span id="l8.73" class="difflineminus">-            if ((tbProf = this.getThunderbirdProfile())) {</span>
<a href="#l8.74"></a><span id="l8.74" class="difflineminus">-                profiles.push(tbProf);</span>
<a href="#l8.75"></a><span id="l8.75" class="difflineminus">-            }</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineplus">+        // We're lightning, check Sunbird</span>
<a href="#l8.77"></a><span id="l8.77" class="difflineplus">+        if ((sbProf = this.getSunbirdProfile())) {</span>
<a href="#l8.78"></a><span id="l8.78" class="difflineplus">+            profiles.push(sbProf);</span>
<a href="#l8.79"></a><span id="l8.79">         }</span>
<a href="#l8.80"></a><span id="l8.80"> </span>
<a href="#l8.81"></a><span id="l8.81">         // Now check all of the profiles in each of these folders for data</span>
<a href="#l8.82"></a><span id="l8.82">         for each (var prof in profiles) {</span>
<a href="#l8.83"></a><span id="l8.83">             var dirEnum = prof.directoryEntries;</span>
<a href="#l8.84"></a><span id="l8.84">             while (dirEnum.hasMoreElements()) {</span>
<a href="#l8.85"></a><span id="l8.85">                 var profile = dirEnum.getNext().QueryInterface(Components.interfaces.nsIFile);</span>
<a href="#l8.86"></a><span id="l8.86">                 if (profile.isFile()) {</span>
<a href="#l8.87"></a><span id="l8.87" class="difflineat">@@ -414,37 +400,25 @@ var gDataMigrator = {</span>
<a href="#l8.88"></a><span id="l8.88">                 calManager.registerCalendar(calendar);</span>
<a href="#l8.89"></a><span id="l8.89">                 getCompositeCalendar().addCalendar(calendar);</span>
<a href="#l8.90"></a><span id="l8.90">             }</span>
<a href="#l8.91"></a><span id="l8.91">             migLOG(&quot;icalMig making callback&quot;);</span>
<a href="#l8.92"></a><span id="l8.92">             aCallback();</span>
<a href="#l8.93"></a><span id="l8.93">         }</span>
<a href="#l8.94"></a><span id="l8.94">         var profileDir = this.dirService.get(&quot;ProfD&quot;, Components.interfaces.nsILocalFile);</span>
<a href="#l8.95"></a><span id="l8.95">         var icalSpec = profileDir.path;</span>
<a href="#l8.96"></a><span id="l8.96" class="difflineminus">-        var icalFile;</span>
<a href="#l8.97"></a><span id="l8.97" class="difflineminus">-        if (cal.isSunbird()) {</span>
<a href="#l8.98"></a><span id="l8.98" class="difflineminus">-            var diverge = icalSpec.indexOf(&quot;Sunbird&quot;);</span>
<a href="#l8.99"></a><span id="l8.99" class="difflineminus">-            if (diverge == -1) {</span>
<a href="#l8.100"></a><span id="l8.100" class="difflineminus">-                return [];</span>
<a href="#l8.101"></a><span id="l8.101" class="difflineminus">-            }</span>
<a href="#l8.102"></a><span id="l8.102" class="difflineminus">-            icalSpec = icalSpec.substr(0, diverge);</span>
<a href="#l8.103"></a><span id="l8.103" class="difflineminus">-            icalFile = Components.classes[&quot;@mozilla.org/file/local;1&quot;]</span>
<a href="#l8.104"></a><span id="l8.104" class="difflineminus">-                       .createInstance(Components.interfaces.nsILocalFile);</span>
<a href="#l8.105"></a><span id="l8.105" class="difflineminus">-            icalFile.initWithPath(icalSpec);</span>
<a href="#l8.106"></a><span id="l8.106" class="difflineminus">-        } else {</span>
<a href="#l8.107"></a><span id="l8.107" class="difflineminus">-            var diverge = icalSpec.indexOf(&quot;Thunderbird&quot;);</span>
<a href="#l8.108"></a><span id="l8.108" class="difflineminus">-            if (diverge == -1) {</span>
<a href="#l8.109"></a><span id="l8.109" class="difflineminus">-                return [];</span>
<a href="#l8.110"></a><span id="l8.110" class="difflineminus">-            }</span>
<a href="#l8.111"></a><span id="l8.111" class="difflineminus">-            icalSpec = icalSpec.substr(0, diverge);</span>
<a href="#l8.112"></a><span id="l8.112" class="difflineminus">-            icalFile = Components.classes[&quot;@mozilla.org/file/local;1&quot;]</span>
<a href="#l8.113"></a><span id="l8.113" class="difflineminus">-                       .createInstance(Components.interfaces.nsILocalFile);</span>
<a href="#l8.114"></a><span id="l8.114" class="difflineminus">-            icalFile.initWithPath(icalSpec);</span>
<a href="#l8.115"></a><span id="l8.115" class="difflineminus">-            icalFile.append(&quot;Application Support&quot;);</span>
<a href="#l8.116"></a><span id="l8.116" class="difflineplus">+        var diverge = icalSpec.indexOf(&quot;Thunderbird&quot;);</span>
<a href="#l8.117"></a><span id="l8.117" class="difflineplus">+        if (diverge == -1) {</span>
<a href="#l8.118"></a><span id="l8.118" class="difflineplus">+            return [];</span>
<a href="#l8.119"></a><span id="l8.119">         }</span>
<a href="#l8.120"></a><span id="l8.120" class="difflineplus">+        icalSpec = icalSpec.substr(0, diverge);</span>
<a href="#l8.121"></a><span id="l8.121" class="difflineplus">+        var icalFile = Components.classes[&quot;@mozilla.org/file/local;1&quot;]</span>
<a href="#l8.122"></a><span id="l8.122" class="difflineplus">+                   .createInstance(Components.interfaces.nsILocalFile);</span>
<a href="#l8.123"></a><span id="l8.123" class="difflineplus">+        icalFile.initWithPath(icalSpec);</span>
<a href="#l8.124"></a><span id="l8.124" class="difflineplus">+        icalFile.append(&quot;Application Support&quot;);</span>
<a href="#l8.125"></a><span id="l8.125"> </span>
<a href="#l8.126"></a><span id="l8.126">         icalFile.append(&quot;iCal&quot;);</span>
<a href="#l8.127"></a><span id="l8.127">         if (icalFile.exists()) {</span>
<a href="#l8.128"></a><span id="l8.128">             return [new dataMigrator(&quot;Apple iCal&quot;, icalMigrate, [icalFile])];</span>
<a href="#l8.129"></a><span id="l8.129">         }</span>
<a href="#l8.130"></a><span id="l8.130"> </span>
<a href="#l8.131"></a><span id="l8.131">         return [];</span>
<a href="#l8.132"></a><span id="l8.132">     },</span>
<a href="#l8.133"></a><span id="l8.133" class="difflineat">@@ -618,37 +592,19 @@ var gDataMigrator = {</span>
<a href="#l8.134"></a><span id="l8.134">     getFirefoxProfile: function gdm_getFF() {</span>
<a href="#l8.135"></a><span id="l8.135">         return this.getNormalProfile(&quot;Firefox&quot;);</span>
<a href="#l8.136"></a><span id="l8.136">     },</span>
<a href="#l8.137"></a><span id="l8.137"> </span>
<a href="#l8.138"></a><span id="l8.138">     /**</span>
<a href="#l8.139"></a><span id="l8.139">      * @see getFirefoxProfile</span>
<a href="#l8.140"></a><span id="l8.140">      */</span>
<a href="#l8.141"></a><span id="l8.141">     getThunderbirdProfile: function gdm_getTB() {</span>
<a href="#l8.142"></a><span id="l8.142" class="difflineminus">-        var localFile;</span>
<a href="#l8.143"></a><span id="l8.143" class="difflineminus">-        var profileRoot = this.dirService.get(&quot;DefProfRt&quot;, Components.interfaces.nsILocalFile);</span>
<a href="#l8.144"></a><span id="l8.144" class="difflineminus">-        migLOG(&quot;profileRoot = &quot; + profileRoot.path);</span>
<a href="#l8.145"></a><span id="l8.145" class="difflineminus">-        if (!cal.isSunbird()) {</span>
<a href="#l8.146"></a><span id="l8.146" class="difflineminus">-            localFile = profileRoot;</span>
<a href="#l8.147"></a><span id="l8.147" class="difflineminus">-        } else {</span>
<a href="#l8.148"></a><span id="l8.148" class="difflineminus">-            // Now it gets ugly</span>
<a href="#l8.149"></a><span id="l8.149" class="difflineminus">-            switch (this.mPlatform) {</span>
<a href="#l8.150"></a><span id="l8.150" class="difflineminus">-                case &quot;darwin&quot;: // Mac OS X</span>
<a href="#l8.151"></a><span id="l8.151" class="difflineminus">-                case &quot;winnt&quot;:</span>
<a href="#l8.152"></a><span id="l8.152" class="difflineminus">-                    localFile = profileRoot.parent.parent.parent;</span>
<a href="#l8.153"></a><span id="l8.153" class="difflineminus">-                    localFile.append(&quot;Thunderbird&quot;);</span>
<a href="#l8.154"></a><span id="l8.154" class="difflineminus">-                    localFile.append(&quot;Profiles&quot;);</span>
<a href="#l8.155"></a><span id="l8.155" class="difflineminus">-                    break;</span>
<a href="#l8.156"></a><span id="l8.156" class="difflineminus">-                default: // Unix</span>
<a href="#l8.157"></a><span id="l8.157" class="difflineminus">-                    localFile = profileRoot.parent.parent;</span>
<a href="#l8.158"></a><span id="l8.158" class="difflineminus">-                    localFile.append(&quot;.thunderbird&quot;);</span>
<a href="#l8.159"></a><span id="l8.159" class="difflineminus">-            }</span>
<a href="#l8.160"></a><span id="l8.160" class="difflineminus">-        }</span>
<a href="#l8.161"></a><span id="l8.161" class="difflineminus">-        migLOG(&quot;searching for Thunderbird in &quot; + localFile.path);</span>
<a href="#l8.162"></a><span id="l8.162" class="difflineminus">-        return localFile.exists() ? localFile : null;</span>
<a href="#l8.163"></a><span id="l8.163" class="difflineplus">+        let profileRoot = this.dirService.get(&quot;DefProfRt&quot;, Components.interfaces.nsILocalFile);</span>
<a href="#l8.164"></a><span id="l8.164" class="difflineplus">+        migLOG(&quot;searching for Thunderbird in &quot; + profileRoot.path);</span>
<a href="#l8.165"></a><span id="l8.165" class="difflineplus">+        return profileRoot.exists() ? profileRoot : null;</span>
<a href="#l8.166"></a><span id="l8.166">     },</span>
<a href="#l8.167"></a><span id="l8.167"> </span>
<a href="#l8.168"></a><span id="l8.168">     /**</span>
<a href="#l8.169"></a><span id="l8.169">      * @see getFirefoxProfile</span>
<a href="#l8.170"></a><span id="l8.170">      */</span>
<a href="#l8.171"></a><span id="l8.171">     getSunbirdProfile: function gdm_getSB() {</span>
<a href="#l8.172"></a><span id="l8.172">         return this.getNormalProfile(&quot;Sunbird&quot;);</span>
<a href="#l8.173"></a><span id="l8.173">     },</span>
<a href="#l8.174"></a><span id="l8.174" class="difflineat">@@ -657,51 +613,34 @@ var gDataMigrator = {</span>
<a href="#l8.175"></a><span id="l8.175">      * Common function to retrieve the profile directory for a given app.</span>
<a href="#l8.176"></a><span id="l8.176">      * @see getFirefoxProfile</span>
<a href="#l8.177"></a><span id="l8.177">      */</span>
<a href="#l8.178"></a><span id="l8.178">     getNormalProfile: function gdm_getNorm(aAppName) {</span>
<a href="#l8.179"></a><span id="l8.179">         var localFile;</span>
<a href="#l8.180"></a><span id="l8.180">         var profileRoot = this.dirService.get(&quot;DefProfRt&quot;, Components.interfaces.nsILocalFile);</span>
<a href="#l8.181"></a><span id="l8.181">         migLOG(&quot;profileRoot = &quot; + profileRoot.path);</span>
<a href="#l8.182"></a><span id="l8.182"> </span>
<a href="#l8.183"></a><span id="l8.183" class="difflineminus">-        if (!cal.isSunbird()) {  // We're in Thunderbird</span>
<a href="#l8.184"></a><span id="l8.184" class="difflineminus">-            switch (this.mPlatform) {</span>
<a href="#l8.185"></a><span id="l8.185" class="difflineminus">-                case &quot;darwin&quot;: // Mac OS X</span>
<a href="#l8.186"></a><span id="l8.186" class="difflineminus">-                    localFile = profileRoot.parent.parent;</span>
<a href="#l8.187"></a><span id="l8.187" class="difflineminus">-                    localFile.append(&quot;Application Support&quot;);</span>
<a href="#l8.188"></a><span id="l8.188" class="difflineminus">-                    localFile.append(aAppName);</span>
<a href="#l8.189"></a><span id="l8.189" class="difflineminus">-                    localFile.append(&quot;Profiles&quot;);</span>
<a href="#l8.190"></a><span id="l8.190" class="difflineminus">-                    break;</span>
<a href="#l8.191"></a><span id="l8.191" class="difflineminus">-                case &quot;winnt&quot;:</span>
<a href="#l8.192"></a><span id="l8.192" class="difflineminus">-                    localFile = profileRoot.parent.parent;</span>
<a href="#l8.193"></a><span id="l8.193" class="difflineminus">-                    localFile.append(&quot;Mozilla&quot;);</span>
<a href="#l8.194"></a><span id="l8.194" class="difflineminus">-                    localFile.append(aAppName);</span>
<a href="#l8.195"></a><span id="l8.195" class="difflineminus">-                    localFile.append(&quot;Profiles&quot;);</span>
<a href="#l8.196"></a><span id="l8.196" class="difflineminus">-                    break;</span>
<a href="#l8.197"></a><span id="l8.197" class="difflineminus">-                default: // Unix</span>
<a href="#l8.198"></a><span id="l8.198" class="difflineminus">-                    localFile = profileRoot.parent;</span>
<a href="#l8.199"></a><span id="l8.199" class="difflineminus">-                    localFile.append(&quot;.mozilla&quot;);</span>
<a href="#l8.200"></a><span id="l8.200" class="difflineminus">-                    localFile.append(aAppName.toLowerCase());</span>
<a href="#l8.201"></a><span id="l8.201" class="difflineminus">-                    break;</span>
<a href="#l8.202"></a><span id="l8.202" class="difflineminus">-            }</span>
<a href="#l8.203"></a><span id="l8.203" class="difflineminus">-        } else {</span>
<a href="#l8.204"></a><span id="l8.204" class="difflineminus">-            switch (this.mPlatform) {</span>
<a href="#l8.205"></a><span id="l8.205" class="difflineminus">-                // On Mac and Windows, we can just remove the &quot;Sunbird&quot; and</span>
<a href="#l8.206"></a><span id="l8.206" class="difflineminus">-                // replace it with &quot;Firefox&quot; to get to Firefox</span>
<a href="#l8.207"></a><span id="l8.207" class="difflineminus">-                case &quot;darwin&quot;: // Mac OS X</span>
<a href="#l8.208"></a><span id="l8.208" class="difflineminus">-                case &quot;winnt&quot;:</span>
<a href="#l8.209"></a><span id="l8.209" class="difflineminus">-                    localFile = profileRoot.parent.parent;</span>
<a href="#l8.210"></a><span id="l8.210" class="difflineminus">-                    localFile.append(aAppName);</span>
<a href="#l8.211"></a><span id="l8.211" class="difflineminus">-                    localFile.append(&quot;Profiles&quot;);</span>
<a href="#l8.212"></a><span id="l8.212" class="difflineminus">-                    break;</span>
<a href="#l8.213"></a><span id="l8.213" class="difflineminus">-                default: // Unix</span>
<a href="#l8.214"></a><span id="l8.214" class="difflineminus">-                    localFile = profileRoot.parent;</span>
<a href="#l8.215"></a><span id="l8.215" class="difflineminus">-                    localFile.append(aAppName.toLowerCase());</span>
<a href="#l8.216"></a><span id="l8.216" class="difflineminus">-                    break;</span>
<a href="#l8.217"></a><span id="l8.217" class="difflineminus">-            }</span>
<a href="#l8.218"></a><span id="l8.218" class="difflineplus">+        switch (this.mPlatform) {</span>
<a href="#l8.219"></a><span id="l8.219" class="difflineplus">+            case &quot;darwin&quot;: // Mac OS X</span>
<a href="#l8.220"></a><span id="l8.220" class="difflineplus">+                localFile = profileRoot.parent.parent;</span>
<a href="#l8.221"></a><span id="l8.221" class="difflineplus">+                localFile.append(&quot;Application Support&quot;);</span>
<a href="#l8.222"></a><span id="l8.222" class="difflineplus">+                localFile.append(aAppName);</span>
<a href="#l8.223"></a><span id="l8.223" class="difflineplus">+                localFile.append(&quot;Profiles&quot;);</span>
<a href="#l8.224"></a><span id="l8.224" class="difflineplus">+                break;</span>
<a href="#l8.225"></a><span id="l8.225" class="difflineplus">+            case &quot;winnt&quot;:</span>
<a href="#l8.226"></a><span id="l8.226" class="difflineplus">+                localFile = profileRoot.parent.parent;</span>
<a href="#l8.227"></a><span id="l8.227" class="difflineplus">+                localFile.append(&quot;Mozilla&quot;);</span>
<a href="#l8.228"></a><span id="l8.228" class="difflineplus">+                localFile.append(aAppName);</span>
<a href="#l8.229"></a><span id="l8.229" class="difflineplus">+                localFile.append(&quot;Profiles&quot;);</span>
<a href="#l8.230"></a><span id="l8.230" class="difflineplus">+                break;</span>
<a href="#l8.231"></a><span id="l8.231" class="difflineplus">+            default: // Unix</span>
<a href="#l8.232"></a><span id="l8.232" class="difflineplus">+                localFile = profileRoot.parent;</span>
<a href="#l8.233"></a><span id="l8.233" class="difflineplus">+                localFile.append(&quot;.mozilla&quot;);</span>
<a href="#l8.234"></a><span id="l8.234" class="difflineplus">+                localFile.append(aAppName.toLowerCase());</span>
<a href="#l8.235"></a><span id="l8.235" class="difflineplus">+                break;</span>
<a href="#l8.236"></a><span id="l8.236">         }</span>
<a href="#l8.237"></a><span id="l8.237">         migLOG(&quot;searching for &quot; + aAppName + &quot; in &quot; + localFile.path);</span>
<a href="#l8.238"></a><span id="l8.238">         return localFile.exists() ? localFile : null;</span>
<a href="#l8.239"></a><span id="l8.239">     }</span>
<a href="#l8.240"></a><span id="l8.240"> };</span>
<a href="#l8.241"></a><span id="l8.241"> </span>
<a href="#l8.242"></a><span id="l8.242"> /**</span>
<a href="#l8.243"></a><span id="l8.243">  * logs to system and error console, depending on the calendar.migration.log</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/jar.mn</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/jar.mn</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -96,17 +96,17 @@ calendar.jar:</span>
<a href="#l9.4"></a><span id="l9.4">     content/calendar/preferences/views.js                  (content/preferences/views.js)</span>
<a href="#l9.5"></a><span id="l9.5">     content/calendar/preferences/views.xul                 (content/preferences/views.xul)</span>
<a href="#l9.6"></a><span id="l9.6">     content/calendar/widgets/minimonth.xml                 (content/widgets/minimonth.xml)</span>
<a href="#l9.7"></a><span id="l9.7">     content/calendar/widgets/calendar-alarm-widget.xml     (content/widgets/calendar-alarm-widget.xml)</span>
<a href="#l9.8"></a><span id="l9.8">     content/calendar/widgets/calendar-widgets.xml          (content/widgets/calendar-widgets.xml)</span>
<a href="#l9.9"></a><span id="l9.9">     content/calendar/widgets/calendar-list-tree.xml        (content/widgets/calendar-list-tree.xml)</span>
<a href="#l9.10"></a><span id="l9.10">     content/calendar/calendar-subscriptions-list.xml       (content/widgets/calendar-subscriptions-list.xml)</span>
<a href="#l9.11"></a><span id="l9.11">     content/calendar/widgets/calendar-widget-bindings.css  (content/widgets/calendar-widget-bindings.css)</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-*   content/calendar/calApplicationUtils.js                (src/calApplicationUtils.js)</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    content/calendar/calApplicationUtils.js                (src/calApplicationUtils.js)</span>
<a href="#l9.14"></a><span id="l9.14">     content/calendar/calUtils.js                           (src/calUtils.js)</span>
<a href="#l9.15"></a><span id="l9.15">     content/calendar/calFilter.js                          (src/calFilter.js)</span>
<a href="#l9.16"></a><span id="l9.16">     content/calendar/WindowsNTToZoneInfoTZId.properties    (src/WindowsNTToZoneInfoTZId.properties)</span>
<a href="#l9.17"></a><span id="l9.17"> % skin calendar classic/1.0 chrome/skin/linux/calendar/ os=Linux</span>
<a href="#l9.18"></a><span id="l9.18"> % skin calendar classic/1.0 chrome/skin/osx/calendar/ os=Darwin</span>
<a href="#l9.19"></a><span id="l9.19"> % skin calendar classic/1.0 chrome/skin/windows/calendar/ os=WINNT</span>
<a href="#l9.20"></a><span id="l9.20"> % skin calendar-common classic/1.0 chrome/skin/common/</span>
<a href="#l9.21"></a><span id="l9.21"> % skin calendar-windows classic/1.0 chrome/skin/windows/calendar/win-classic/ os=WINNT osversion&lt;6</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/modules/calProviderUtils.jsm</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/modules/calProviderUtils.jsm</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -244,19 +244,16 @@ cal.getImipTransport = function calGetIm</span>
<a href="#l10.4"></a><span id="l10.4">  * Gets the configured identity and account of a particular calendar instance, or null.</span>
<a href="#l10.5"></a><span id="l10.5">  *</span>
<a href="#l10.6"></a><span id="l10.6">  * @param aCalendar     Calendar instance</span>
<a href="#l10.7"></a><span id="l10.7">  * @param outAccount    Optional out value for account</span>
<a href="#l10.8"></a><span id="l10.8">  * @return              The configured identity</span>
<a href="#l10.9"></a><span id="l10.9">  */</span>
<a href="#l10.10"></a><span id="l10.10"> cal.getEmailIdentityOfCalendar = function calGetEmailIdentityOfCalendar(aCalendar, outAccount) {</span>
<a href="#l10.11"></a><span id="l10.11">     cal.ASSERT(aCalendar, &quot;no calendar!&quot;, Components.results.NS_ERROR_INVALID_ARG);</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-    if (cal.isSunbird()) {</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-        return null;</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-    }</span>
<a href="#l10.15"></a><span id="l10.15">     let key = aCalendar.getProperty(&quot;imip.identity.key&quot;);</span>
<a href="#l10.16"></a><span id="l10.16">     if (key !== null) {</span>
<a href="#l10.17"></a><span id="l10.17">         if (key.length == 0) { // i.e. &quot;None&quot;</span>
<a href="#l10.18"></a><span id="l10.18">             return null;</span>
<a href="#l10.19"></a><span id="l10.19">         }</span>
<a href="#l10.20"></a><span id="l10.20">         let identity = null;</span>
<a href="#l10.21"></a><span id="l10.21">         cal.calIterateEmailIdentities(</span>
<a href="#l10.22"></a><span id="l10.22">             function(identity_, account) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/src/calAlarmService.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/src/calAlarmService.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -264,17 +264,17 @@ calAlarmService.prototype = {</span>
<a href="#l11.4"></a><span id="l11.4">         let timerCallback = {</span>
<a href="#l11.5"></a><span id="l11.5">             alarmService: this,</span>
<a href="#l11.6"></a><span id="l11.6">             notify: function timer_notify() {</span>
<a href="#l11.7"></a><span id="l11.7">                 let now = nowUTC();</span>
<a href="#l11.8"></a><span id="l11.8">                 let start;</span>
<a href="#l11.9"></a><span id="l11.9">                 if (!this.alarmService.mRangeEnd) {</span>
<a href="#l11.10"></a><span id="l11.10">                     // This is our first search for alarms.  We're going to look for</span>
<a href="#l11.11"></a><span id="l11.11">                     // alarms +/- 1 month from now.  If someone sets an alarm more than</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-                    // a month ahead of an event, or doesn't start Sunbird/Lightning</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+                    // a month ahead of an event, or doesn't start Lightning</span>
<a href="#l11.14"></a><span id="l11.14">                     // for a month, they'll miss some, but that's a slim chance</span>
<a href="#l11.15"></a><span id="l11.15">                     start = now.clone();</span>
<a href="#l11.16"></a><span id="l11.16">                     start.month -= 1;</span>
<a href="#l11.17"></a><span id="l11.17">                     this.alarmService.mRangeStart = start.clone();</span>
<a href="#l11.18"></a><span id="l11.18">                 } else {</span>
<a href="#l11.19"></a><span id="l11.19">                     // This is a subsequent search, so we got all the past alarms before</span>
<a href="#l11.20"></a><span id="l11.20">                     start = this.alarmService.mRangeEnd.clone();</span>
<a href="#l11.21"></a><span id="l11.21">                 }</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineat">@@ -575,17 +575,17 @@ calAlarmService.prototype = {</span>
<a href="#l11.23"></a><span id="l11.23">         // Purge out all alarm timers belonging to the refreshed/loaded calendar:</span>
<a href="#l11.24"></a><span id="l11.24">         this.disposeCalendarTimers(aCalendars);</span>
<a href="#l11.25"></a><span id="l11.25"> </span>
<a href="#l11.26"></a><span id="l11.26">         // Purge out all alarms from dialog belonging to the refreshed/loaded calendar:</span>
<a href="#l11.27"></a><span id="l11.27">         this.mObservers.notify(&quot;onRemoveAlarmsByCalendar&quot;, aCalendars);</span>
<a href="#l11.28"></a><span id="l11.28"> </span>
<a href="#l11.29"></a><span id="l11.29">         // Total refresh similar to startup.  We're going to look for</span>
<a href="#l11.30"></a><span id="l11.30">         // alarms +/- 1 month from now.  If someone sets an alarm more than</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-        // a month ahead of an event, or doesn't start Sunbird/Lightning</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+        // a month ahead of an event, or doesn't start Lightning</span>
<a href="#l11.33"></a><span id="l11.33">         // for a month, they'll miss some, but that's a slim chance</span>
<a href="#l11.34"></a><span id="l11.34">         let start = nowUTC();</span>
<a href="#l11.35"></a><span id="l11.35">         let until = start.clone();</span>
<a href="#l11.36"></a><span id="l11.36">         start.month -= 1;</span>
<a href="#l11.37"></a><span id="l11.37">         until.month += 1;</span>
<a href="#l11.38"></a><span id="l11.38">         this.findAlarms(aCalendars, start, until);</span>
<a href="#l11.39"></a><span id="l11.39">     },</span>
<a href="#l11.40"></a><span id="l11.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/src/calApplicationUtils.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/src/calApplicationUtils.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -1,94 +1,15 @@</span>
<a href="#l12.4"></a><span id="l12.4"> /* -*- Mode: javascript; tab-width: 20; indent-tabs-mode: nil; c-basic-offset: 4 -*-</span>
<a href="#l12.5"></a><span id="l12.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l12.6"></a><span id="l12.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l12.7"></a><span id="l12.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l12.8"></a><span id="l12.8"> </span>
<a href="#l12.9"></a><span id="l12.9"> Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l12.10"></a><span id="l12.10"> </span>
<a href="#l12.11"></a><span id="l12.11" class="difflineminus">-function openAboutDialog()</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-{</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-  const SUNBIRD_ID = &quot;{718e30fb-e89b-41dd-9da7-e25a45638b28}&quot;;</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-  var url = (Services.appinfo.ID == SUNBIRD_ID) ?</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-    &quot;chrome://sunbird/content/aboutDialog.xul&quot; :</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-    &quot;chrome://messenger/content/aboutDialog.xul&quot; ;</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-#ifdef XP_WIN</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-  var features = &quot;chrome,centerscreen,dependent&quot;;</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineminus">-#elifdef XP_MACOSX</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineminus">-  var features = &quot;chrome,resizable=no,minimizable=no&quot;;</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineminus">-#else</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineminus">-  var features = &quot;chrome,centerscreen,dependent,dialog=no&quot;;</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineminus">-#endif</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineminus">-  window.openDialog(url, &quot;About&quot;, features);</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineminus">-}</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineminus">-</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineminus">-/**</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineminus">- * Opens the release notes page for this version of the application.</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineminus">- */</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineminus">-function openReleaseNotes()</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-{</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineminus">-  const SUNBIRD_ID = &quot;{718e30fb-e89b-41dd-9da7-e25a45638b28}&quot;;</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineminus">-  if (Services.appinfo.ID == SUNBIRD_ID) {</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineminus">-    var bundle = Services.strings.createBundle(&quot;chrome://branding/locale/brand.properties&quot;);</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineminus">-    var relNotesURL = bundle.formatStringFromName(&quot;releaseNotesURL&quot;,[Services.appinfo.version],1)</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineminus">-    launchBrowser(relNotesURL);</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineminus">-  } else {</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineminus">-    openFormattedRegionURL('app.releaseNotesURL');</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineminus">-  }</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineminus">-}</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineminus">-</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineminus">-/**</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineminus">- * Opens region specific web pages for the application like the release notes, the help site, etc. </span>
<a href="#l12.44"></a><span id="l12.44" class="difflineminus">- *   aResourceName --&gt; the string resource ID in region.properties to load. </span>
<a href="#l12.45"></a><span id="l12.45" class="difflineminus">- */</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineminus">-function openRegionURL(aResourceName)</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineminus">-{</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineminus">-  try {</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineminus">-    var regionBundle = Services.strings.createBundle(&quot;chrome://messenger-region/locale/region.properties&quot;);</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineminus">-    // the release notes are special and need to be formatted with the app version</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineminus">-    var urlToOpen;</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineminus">-    if (aResourceName == &quot;releaseNotesURL&quot;)</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineminus">-      urlToOpen = regionBundle.formatStringFromName(aResourceName, [Services.appinfo.version], 1);</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineminus">-    else</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineminus">-      urlToOpen = regionBundle.GetStringFromName(aResourceName);</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineminus">-      </span>
<a href="#l12.57"></a><span id="l12.57" class="difflineminus">-    var protocolSvc = Components.classes[&quot;@mozilla.org/uriloader/external-protocol-service;1&quot;]</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineminus">-                      .getService(Components.interfaces.nsIExternalProtocolService);</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineminus">-    protocolSvc.loadUrl(Services.io.newURI(urlToOpen, null, null));</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineminus">-  } catch (ex) {}</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineminus">-}</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineminus">-</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineminus">-/**</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineminus">- *  Fetches the url for the passed in pref name, formats it and then loads it in the default</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineminus">- *  browser.</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineminus">- *</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineminus">- *  @param aPrefName - name of the pref that holds the url we want to format and open</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineminus">- */</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineminus">-function openFormattedRegionURL(aPrefName)</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineminus">-{</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineminus">-  var formattedUrl = getFormattedRegionURL(aPrefName);</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineminus">-  </span>
<a href="#l12.73"></a><span id="l12.73" class="difflineminus">-  var protocolSvc = Components.classes[&quot;@mozilla.org/uriloader/external-protocol-service;1&quot;].</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineminus">-                               getService(Components.interfaces.nsIExternalProtocolService);</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineminus">-  protocolSvc.loadUrl(Services.io.newURI(formattedUrl, null, null));</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineminus">-}</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineminus">-</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineminus">-/**</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineminus">- *  Fetches the url for the passed in pref name and uses the URL formatter service to </span>
<a href="#l12.80"></a><span id="l12.80" class="difflineminus">- *    process it.</span>
<a href="#l12.81"></a><span id="l12.81" class="difflineminus">- *</span>
<a href="#l12.82"></a><span id="l12.82" class="difflineminus">- *  @param aPrefName - name of the pref that holds the url we want to format and open</span>
<a href="#l12.83"></a><span id="l12.83" class="difflineminus">- *  @returns the formatted url string</span>
<a href="#l12.84"></a><span id="l12.84" class="difflineminus">- */</span>
<a href="#l12.85"></a><span id="l12.85" class="difflineminus">-function getFormattedRegionURL(aPrefName)</span>
<a href="#l12.86"></a><span id="l12.86" class="difflineminus">-{</span>
<a href="#l12.87"></a><span id="l12.87" class="difflineminus">-  return Services.urlFormatter.formatURLPref(aPrefName);</span>
<a href="#l12.88"></a><span id="l12.88" class="difflineminus">-}</span>
<a href="#l12.89"></a><span id="l12.89" class="difflineminus">-</span>
<a href="#l12.90"></a><span id="l12.90"> /**</span>
<a href="#l12.91"></a><span id="l12.91">  * Launch the given url (string) in the external browser. If an event is passed,</span>
<a href="#l12.92"></a><span id="l12.92">  * then this is only done on left click and the event propagation is stopped.</span>
<a href="#l12.93"></a><span id="l12.93">  *</span>
<a href="#l12.94"></a><span id="l12.94">  * @param url       The URL to open, as a string</span>
<a href="#l12.95"></a><span id="l12.95">  * @param event     (optional) The event that caused the URL to open</span>
<a href="#l12.96"></a><span id="l12.96">  */</span>
<a href="#l12.97"></a><span id="l12.97"> function launchBrowser(url, event)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/src/calCalendarManager.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/src/calCalendarManager.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -43,19 +43,16 @@ calCalendarManager.prototype = {</span>
<a href="#l13.4"></a><span id="l13.4">     // calIStartupService:</span>
<a href="#l13.5"></a><span id="l13.5">     startup: function ccm_startup(aCompleteListener) {</span>
<a href="#l13.6"></a><span id="l13.6">         AddonManager.addAddonListener(gCalendarManagerAddonListener);</span>
<a href="#l13.7"></a><span id="l13.7">         this.checkAndMigrateDB();</span>
<a href="#l13.8"></a><span id="l13.8">         this.mCache = null;</span>
<a href="#l13.9"></a><span id="l13.9">         this.mCalObservers = null;</span>
<a href="#l13.10"></a><span id="l13.10">         this.mRefreshTimer = {};</span>
<a href="#l13.11"></a><span id="l13.11">         this.setupOfflineObservers();</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-        if (cal.isSunbird()) {</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-            this.loginMasterPassword();</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-        }</span>
<a href="#l13.15"></a><span id="l13.15">         this.mNetworkCalendarCount = 0;</span>
<a href="#l13.16"></a><span id="l13.16">         this.mReadonlyCalendarCount = 0;</span>
<a href="#l13.17"></a><span id="l13.17">         this.mCalendarCount = 0;</span>
<a href="#l13.18"></a><span id="l13.18"> </span>
<a href="#l13.19"></a><span id="l13.19">         Services.obs.addObserver(this, &quot;http-on-modify-request&quot;, false);</span>
<a href="#l13.20"></a><span id="l13.20"> </span>
<a href="#l13.21"></a><span id="l13.21">         // We only add the observer if the pref is set and only check for the</span>
<a href="#l13.22"></a><span id="l13.22">         // pref on startup to avoid checking for every http request</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineat">@@ -91,34 +88,16 @@ calCalendarManager.prototype = {</span>
<a href="#l13.24"></a><span id="l13.24">     setupOfflineObservers: function ccm_setupOfflineObservers() {</span>
<a href="#l13.25"></a><span id="l13.25">         Services.obs.addObserver(this, &quot;network:offline-status-changed&quot;, false);</span>
<a href="#l13.26"></a><span id="l13.26">     },</span>
<a href="#l13.27"></a><span id="l13.27"> </span>
<a href="#l13.28"></a><span id="l13.28">     cleanupOfflineObservers: function ccm_cleanupOfflineObservers() {</span>
<a href="#l13.29"></a><span id="l13.29">         Services.obs.removeObserver(this, &quot;network:offline-status-changed&quot;);</span>
<a href="#l13.30"></a><span id="l13.30">     },</span>
<a href="#l13.31"></a><span id="l13.31"> </span>
<a href="#l13.32"></a><span id="l13.32" class="difflineminus">-    loginMasterPassword: function ccm_loginMasterPassword() {</span>
<a href="#l13.33"></a><span id="l13.33" class="difflineminus">-        // Try to avoid the multiple master password prompts on startup scenario</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineminus">-        // by prompting for the master password upfront.</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineminus">-        let token = Components.classes[&quot;@mozilla.org/security/pk11tokendb;1&quot;]</span>
<a href="#l13.36"></a><span id="l13.36" class="difflineminus">-                              .getService(Components.interfaces.nsIPK11TokenDB)</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineminus">-                              .getInternalKeyToken();</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineminus">-</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineminus">-        // Only log in to the internal token if it is already initialized,</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineminus">-        // otherwise we get a &quot;Change Master Password&quot; dialog.</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineminus">-        try {</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineminus">-            if (!token.needsUserInit) {</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineminus">-                token.login(false);</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineminus">-            }</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineminus">-        } catch (ex) {</span>
<a href="#l13.46"></a><span id="l13.46" class="difflineminus">-            // If user cancels an exception is expected.</span>
<a href="#l13.47"></a><span id="l13.47" class="difflineminus">-        }</span>
<a href="#l13.48"></a><span id="l13.48" class="difflineminus">-    },</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineminus">-</span>
<a href="#l13.50"></a><span id="l13.50">     observe: function ccm_observe(aSubject, aTopic, aData) {</span>
<a href="#l13.51"></a><span id="l13.51">         switch (aTopic) {</span>
<a href="#l13.52"></a><span id="l13.52">             case &quot;timer-callback&quot;:</span>
<a href="#l13.53"></a><span id="l13.53">                 // Refresh all the calendars that can be refreshed.</span>
<a href="#l13.54"></a><span id="l13.54">                 var cals = this.getCalendars({});</span>
<a href="#l13.55"></a><span id="l13.55">                 for each (var calendar in cals) {</span>
<a href="#l13.56"></a><span id="l13.56">                     if (!calendar.getProperty(&quot;disabled&quot;) &amp;&amp; calendar.canRefresh) {</span>
<a href="#l13.57"></a><span id="l13.57">                         calendar.refresh();</span>
<a href="#l13.58"></a><span id="l13.58" class="difflineat">@@ -411,32 +390,23 @@ calCalendarManager.prototype = {</span>
<a href="#l13.59"></a><span id="l13.59">         throw table + &quot; SELECT returned no results&quot;;</span>
<a href="#l13.60"></a><span id="l13.60">     },</span>
<a href="#l13.61"></a><span id="l13.61"> </span>
<a href="#l13.62"></a><span id="l13.62">     //</span>
<a href="#l13.63"></a><span id="l13.63">     // / DB migration code ends here</span>
<a href="#l13.64"></a><span id="l13.64">     //</span>
<a href="#l13.65"></a><span id="l13.65"> </span>
<a href="#l13.66"></a><span id="l13.66">     alertAndQuit: function cmgr_alertAndQuit() {</span>
<a href="#l13.67"></a><span id="l13.67" class="difflineminus">-        // If we're Lightning, we want to include the extension name</span>
<a href="#l13.68"></a><span id="l13.68" class="difflineminus">-        // in the error message rather than blaming Thunderbird.</span>
<a href="#l13.69"></a><span id="l13.69" class="difflineminus">-        var errorBoxTitle;</span>
<a href="#l13.70"></a><span id="l13.70" class="difflineminus">-        var errorBoxText;</span>
<a href="#l13.71"></a><span id="l13.71" class="difflineminus">-        var errorBoxButtonLabel;</span>
<a href="#l13.72"></a><span id="l13.72" class="difflineplus">+        // We want to include the extension name in the error message rather</span>
<a href="#l13.73"></a><span id="l13.73" class="difflineplus">+        // than blaming Thunderbird.</span>
<a href="#l13.74"></a><span id="l13.74">         var hostAppName = calGetString(&quot;brand&quot;, &quot;brandShortName&quot;, null, &quot;branding&quot;);</span>
<a href="#l13.75"></a><span id="l13.75" class="difflineminus">-        if (isSunbird()) {</span>
<a href="#l13.76"></a><span id="l13.76" class="difflineminus">-            errorBoxTitle = calGetString(&quot;calendar&quot;, &quot;tooNewSchemaErrorBoxTitle&quot;, [hostAppName]);</span>
<a href="#l13.77"></a><span id="l13.77" class="difflineminus">-            errorBoxText = calGetString(&quot;calendar&quot;, &quot;tooNewSchemaErrorBoxTextSunbird&quot;, [hostAppName]);</span>
<a href="#l13.78"></a><span id="l13.78" class="difflineminus">-            errorBoxButtonLabel = calGetString(&quot;calendar&quot;, &quot;tooNewSchemaButtonQuit&quot;, [hostAppName]);</span>
<a href="#l13.79"></a><span id="l13.79" class="difflineminus">-        } else {</span>
<a href="#l13.80"></a><span id="l13.80" class="difflineminus">-            var calAppName = calGetString(&quot;lightning&quot;, &quot;brandShortName&quot;, null, &quot;lightning&quot;);</span>
<a href="#l13.81"></a><span id="l13.81" class="difflineminus">-            errorBoxTitle = calGetString(&quot;calendar&quot;, &quot;tooNewSchemaErrorBoxTitle&quot;, [calAppName]);</span>
<a href="#l13.82"></a><span id="l13.82" class="difflineminus">-            errorBoxText = calGetString(&quot;calendar&quot;, &quot;tooNewSchemaErrorBoxTextLightning&quot;, [calAppName, hostAppName]);</span>
<a href="#l13.83"></a><span id="l13.83" class="difflineminus">-            errorBoxButtonLabel = calGetString(&quot;calendar&quot;, &quot;tooNewSchemaButtonRestart&quot;, [hostAppName]);</span>
<a href="#l13.84"></a><span id="l13.84" class="difflineminus">-        }</span>
<a href="#l13.85"></a><span id="l13.85" class="difflineplus">+        var calAppName = calGetString(&quot;lightning&quot;, &quot;brandShortName&quot;, null, &quot;lightning&quot;);</span>
<a href="#l13.86"></a><span id="l13.86" class="difflineplus">+        var errorBoxTitle = calGetString(&quot;calendar&quot;, &quot;tooNewSchemaErrorBoxTitle&quot;, [calAppName]);</span>
<a href="#l13.87"></a><span id="l13.87" class="difflineplus">+        var errorBoxText = calGetString(&quot;calendar&quot;, &quot;tooNewSchemaErrorBoxTextLightning&quot;, [calAppName, hostAppName]);</span>
<a href="#l13.88"></a><span id="l13.88" class="difflineplus">+        var errorBoxButtonLabel = calGetString(&quot;calendar&quot;, &quot;tooNewSchemaButtonRestart&quot;, [hostAppName]);</span>
<a href="#l13.89"></a><span id="l13.89"> </span>
<a href="#l13.90"></a><span id="l13.90">         var promptSvc = Services.prompt;</span>
<a href="#l13.91"></a><span id="l13.91"> </span>
<a href="#l13.92"></a><span id="l13.92">         var errorBoxButtonFlags = (promptSvc.BUTTON_POS_0 *</span>
<a href="#l13.93"></a><span id="l13.93">                                    promptSvc.BUTTON_TITLE_IS_STRING +</span>
<a href="#l13.94"></a><span id="l13.94">                                    promptSvc.BUTTON_POS_0_DEFAULT);</span>
<a href="#l13.95"></a><span id="l13.95"> </span>
<a href="#l13.96"></a><span id="l13.96">         var choice = promptSvc.confirmEx(null,</span>
<a href="#l13.97"></a><span id="l13.97" class="difflineat">@@ -444,26 +414,22 @@ calCalendarManager.prototype = {</span>
<a href="#l13.98"></a><span id="l13.98">                                          errorBoxText,</span>
<a href="#l13.99"></a><span id="l13.99">                                          errorBoxButtonFlags,</span>
<a href="#l13.100"></a><span id="l13.100">                                          errorBoxButtonLabel,</span>
<a href="#l13.101"></a><span id="l13.101">                                          null, // No second button text</span>
<a href="#l13.102"></a><span id="l13.102">                                          null, // No third button text</span>
<a href="#l13.103"></a><span id="l13.103">                                          null, // No checkbox</span>
<a href="#l13.104"></a><span id="l13.104">                                          { value: false }); // Unnecessary checkbox state</span>
<a href="#l13.105"></a><span id="l13.105"> </span>
<a href="#l13.106"></a><span id="l13.106" class="difflineminus">-        if (isSunbird()) {</span>
<a href="#l13.107"></a><span id="l13.107" class="difflineminus">-            Services.startup.quit(Components.interfaces.nsIAppStartup.eForceQuit);</span>
<a href="#l13.108"></a><span id="l13.108" class="difflineminus">-        } else {</span>
<a href="#l13.109"></a><span id="l13.109" class="difflineminus">-            // Disable Lightning</span>
<a href="#l13.110"></a><span id="l13.110" class="difflineminus">-            AddonManager.getAddonByID(&quot;{e2fda1a4-762b-4020-b5ad-a41df1933103}&quot;, function getLightningExt(aAddon) {</span>
<a href="#l13.111"></a><span id="l13.111" class="difflineminus">-                aAddon.userDisabled = true;</span>
<a href="#l13.112"></a><span id="l13.112" class="difflineminus">-                Services.startup.quit(Components.interfaces.nsIAppStartup.eRestart |</span>
<a href="#l13.113"></a><span id="l13.113" class="difflineminus">-                    Components.interfaces.nsIAppStartup.eForceQuit);</span>
<a href="#l13.114"></a><span id="l13.114" class="difflineminus">-            });</span>
<a href="#l13.115"></a><span id="l13.115" class="difflineminus">-        }</span>
<a href="#l13.116"></a><span id="l13.116" class="difflineplus">+        // Disable Lightning</span>
<a href="#l13.117"></a><span id="l13.117" class="difflineplus">+        AddonManager.getAddonByID(&quot;{e2fda1a4-762b-4020-b5ad-a41df1933103}&quot;, function getLightningExt(aAddon) {</span>
<a href="#l13.118"></a><span id="l13.118" class="difflineplus">+            aAddon.userDisabled = true;</span>
<a href="#l13.119"></a><span id="l13.119" class="difflineplus">+            Services.startup.quit(Components.interfaces.nsIAppStartup.eRestart |</span>
<a href="#l13.120"></a><span id="l13.120" class="difflineplus">+                Components.interfaces.nsIAppStartup.eForceQuit);</span>
<a href="#l13.121"></a><span id="l13.121" class="difflineplus">+        });</span>
<a href="#l13.122"></a><span id="l13.122">     },</span>
<a href="#l13.123"></a><span id="l13.123"> </span>
<a href="#l13.124"></a><span id="l13.124">     /**</span>
<a href="#l13.125"></a><span id="l13.125">      * calICalendarManager interface</span>
<a href="#l13.126"></a><span id="l13.126">      */</span>
<a href="#l13.127"></a><span id="l13.127">     createCalendar: function cmgr_createCalendar(type, uri) {</span>
<a href="#l13.128"></a><span id="l13.128">         try {</span>
<a href="#l13.129"></a><span id="l13.129">             if (!Components.classes[&quot;@mozilla.org/calendar/calendar;1?type=&quot; + type]) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/src/calUtils.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/src/calUtils.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -1144,31 +1144,16 @@ function getProgressAtom(aTask) {</span>
<a href="#l14.4"></a><span id="l14.4">     if (aTask.entryDate &amp;&amp; aTask.entryDate.isValid &amp;&amp;</span>
<a href="#l14.5"></a><span id="l14.5">         aTask.entryDate.jsDate.getTime() &lt; now.getTime()) {</span>
<a href="#l14.6"></a><span id="l14.6">         return &quot;inprogress&quot;;</span>
<a href="#l14.7"></a><span id="l14.7">     }</span>
<a href="#l14.8"></a><span id="l14.8"> </span>
<a href="#l14.9"></a><span id="l14.9">     return &quot;future&quot;;</span>
<a href="#l14.10"></a><span id="l14.10"> }</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-/**</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">- * Returns true if we are Sunbird (according to our UUID), false otherwise.</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">- */</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-function isSunbird() {</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineminus">-    if (isSunbird.mIsSunbird === undefined) {</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineminus">-        try {</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineminus">-            isSunbird.mIsSunbird = (Services.appinfo.ID == &quot;{718e30fb-e89b-41dd-9da7-e25a45638b28}&quot;);</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineminus">-        } catch (e) {</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineminus">-            dump(&quot;### Warning: Could not access appinfo, using unreliable check for Lightning\n&quot;);</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineminus">-            isSunbird.mIsSunbird = !(&quot;@mozilla.org/lightning/mime-converter;1&quot; in Components.classes);</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineminus">-        }</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineminus">-    }</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineminus">-    return isSunbird.mIsSunbird;</span>
<a href="#l14.25"></a><span id="l14.25" class="difflineminus">-}</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineminus">-</span>
<a href="#l14.27"></a><span id="l14.27"> function calInterfaceBag(iid) {</span>
<a href="#l14.28"></a><span id="l14.28">     this.init(iid);</span>
<a href="#l14.29"></a><span id="l14.29"> }</span>
<a href="#l14.30"></a><span id="l14.30"> calInterfaceBag.prototype = {</span>
<a href="#l14.31"></a><span id="l14.31">     mIid: null,</span>
<a href="#l14.32"></a><span id="l14.32">     mInterfaces: null,</span>
<a href="#l14.33"></a><span id="l14.33"> </span>
<a href="#l14.34"></a><span id="l14.34">     /// internal:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -220,17 +220,17 @@ function refreshUIBits() {</span>
<a href="#l15.4"></a><span id="l15.4"> </span>
<a href="#l15.5"></a><span id="l15.5"> /**</span>
<a href="#l15.6"></a><span id="l15.6">  * Switch the calendar view, and optionally switch to calendar mode.</span>
<a href="#l15.7"></a><span id="l15.7">  *</span>
<a href="#l15.8"></a><span id="l15.8">  * @param aType     The type of view to select.</span>
<a href="#l15.9"></a><span id="l15.9">  * @param aShow     If true, the mode will be switched to calendar if not</span>
<a href="#l15.10"></a><span id="l15.10">  *                    already there.</span>
<a href="#l15.11"></a><span id="l15.11">  */</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-function ltnSwitchCalendarView(aType, aShow) {</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+function switchCalendarView(aType, aShow) {</span>
<a href="#l15.14"></a><span id="l15.14">     gLastShownCalendarView = aType;</span>
<a href="#l15.15"></a><span id="l15.15"> </span>
<a href="#l15.16"></a><span id="l15.16">     if (aShow &amp;&amp; gCurrentMode != &quot;calendar&quot;) {</span>
<a href="#l15.17"></a><span id="l15.17">         // This function in turn calls switchToView(), so return afterwards.</span>
<a href="#l15.18"></a><span id="l15.18">         ltnSwitch2Calendar();</span>
<a href="#l15.19"></a><span id="l15.19">         return;</span>
<a href="#l15.20"></a><span id="l15.20">     }</span>
<a href="#l15.21"></a><span id="l15.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/locales/en-US/README.txt</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/locales/en-US/README.txt</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -1,3 +1,3 @@</span>
<a href="#l16.4"></a><span id="l16.4" class="difflineminus">-For information about installing, running and configuring Sunbird </span>
<a href="#l16.5"></a><span id="l16.5" class="difflineminus">-including a list of known issues and troubleshooting information, </span>
<a href="#l16.6"></a><span id="l16.6" class="difflineplus">+For information about installing, running and configuring Lightning</span>
<a href="#l16.7"></a><span id="l16.7" class="difflineplus">+including a list of known issues and troubleshooting information,</span>
<a href="#l16.8"></a><span id="l16.8"> refer to: http://www.mozilla.org/projects/calendar/</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/locales/en-US/chrome/calendar/calendar.properties</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/locales/en-US/chrome/calendar/calendar.properties</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -102,21 +102,16 @@ None=None</span>
<a href="#l17.4"></a><span id="l17.4"> ## @loc none</span>
<a href="#l17.5"></a><span id="l17.5"> tooNewSchemaErrorBoxTitle=Your calendar data isn't compatible with this version of %1$S</span>
<a href="#l17.6"></a><span id="l17.6"> </span>
<a href="#l17.7"></a><span id="l17.7"> # LOCALIZATION NOTE (tooNewSchemaErrorBoxTextLightning):</span>
<a href="#l17.8"></a><span id="l17.8"> #    %1$S will be replaced with the name of the calendar application e.g. 'Lightning'</span>
<a href="#l17.9"></a><span id="l17.9"> #    %2$S will be replaced with the name of the host application 'calendar'</span>
<a href="#l17.10"></a><span id="l17.10"> tooNewSchemaErrorBoxTextLightning=The calendar data in your profile was updated by a newer version of %1$S, and continuing will probably cause the information to be lost or corrupted. %1$S will now be disabled and %2$S restarted.</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-# LOCALIZATION NOTE (tooNewSchemaErrorBoxTextSunbird):</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineminus">-#    %1$S will be replaced with the name of the calendar application e.g. 'Sunbird'</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineminus">-#    %2$S will be replaced with the name of the host application 'calendar'</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineminus">-tooNewSchemaErrorBoxTextSunbird=The calendar data in your profile was updated by a newer version of %1$S, and continuing will probably cause the information to be lost or corrupted. %1$S will now quit.</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineminus">-</span>
<a href="#l17.17"></a><span id="l17.17"> # LOCALIZATION NOTE (tooNewSchemaButtonRestart):</span>
<a href="#l17.18"></a><span id="l17.18"> #    %1$S will be replaced with the name of the host application 'Calendar'</span>
<a href="#l17.19"></a><span id="l17.19"> tooNewSchemaButtonRestart=Restart %1$S</span>
<a href="#l17.20"></a><span id="l17.20"> </span>
<a href="#l17.21"></a><span id="l17.21"> # LOCALIZATION NOTE (tooNewSchemaButtonQuit):</span>
<a href="#l17.22"></a><span id="l17.22"> #    %1$S will be replaced with the name of the host application 'Calendar'</span>
<a href="#l17.23"></a><span id="l17.23"> tooNewSchemaButtonQuit=Quit %1$S</span>
<a href="#l17.24"></a><span id="l17.24"> </span>
<a href="#l17.25"></a><span id="l17.25" class="difflineat">@@ -334,31 +329,16 @@ go=Go</span>
<a href="#l17.26"></a><span id="l17.26"> # Some languages have different conjugations of 'next' and 'last'.  If yours</span>
<a href="#l17.27"></a><span id="l17.27"> # does not, simply repeat the value.  This will be used with day names, as in</span>
<a href="#l17.28"></a><span id="l17.28"> # 'next Sunday'.</span>
<a href="#l17.29"></a><span id="l17.29"> next1=next</span>
<a href="#l17.30"></a><span id="l17.30"> next2=next</span>
<a href="#l17.31"></a><span id="l17.31"> last1=last</span>
<a href="#l17.32"></a><span id="l17.32"> last2=last</span>
<a href="#l17.33"></a><span id="l17.33"> </span>
<a href="#l17.34"></a><span id="l17.34" class="difflineminus">-# Master Password</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineminus">-changeMasterPassword=Change Master Password</span>
<a href="#l17.36"></a><span id="l17.36" class="difflineminus">-pw_change2empty_in_fips_mode=You are currently in FIPS mode. FIPS requires a non-empty Master Password.</span>
<a href="#l17.37"></a><span id="l17.37" class="difflineminus">-pw_change_failed_title=Password Change Failed</span>
<a href="#l17.38"></a><span id="l17.38" class="difflineminus">-</span>
<a href="#l17.39"></a><span id="l17.39" class="difflineminus">-# Check for Updates     (SUNBIRD_ONLY)</span>
<a href="#l17.40"></a><span id="l17.40" class="difflineminus">-updatesItem_default=Check for Updates</span>
<a href="#l17.41"></a><span id="l17.41" class="difflineminus">-updatesItem_defaultFallback=Check for Updates</span>
<a href="#l17.42"></a><span id="l17.42" class="difflineminus">-updatesItem_downloading=Downloading %S</span>
<a href="#l17.43"></a><span id="l17.43" class="difflineminus">-updatesItem_downloadingFallback=Downloading Update</span>
<a href="#l17.44"></a><span id="l17.44" class="difflineminus">-updatesItem_resume=Resume Downloading %S</span>
<a href="#l17.45"></a><span id="l17.45" class="difflineminus">-updatesItem_resumeFallback=Resume Downloading Update</span>
<a href="#l17.46"></a><span id="l17.46" class="difflineminus">-updatesItem_pending=Apply Downloaded Update Now</span>
<a href="#l17.47"></a><span id="l17.47" class="difflineminus">-updatesItem_pendingFallback=Apply Downloaded Update Now</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineminus">-</span>
<a href="#l17.49"></a><span id="l17.49"> # Alarm Dialog</span>
<a href="#l17.50"></a><span id="l17.50"> # LOCALIZATION NOTE (alarmWindowTitle.label): Semi-colon list of plural</span>
<a href="#l17.51"></a><span id="l17.51"> # forms. See: http://developer.mozilla.org/en/Localization_and_Plurals</span>
<a href="#l17.52"></a><span id="l17.52"> alarmWindowTitle.label=#1 Reminder;#1 Reminders</span>
<a href="#l17.53"></a><span id="l17.53"> </span>
<a href="#l17.54"></a><span id="l17.54"> # LOCALIZATION NOTE (alarmStarts):</span>
<a href="#l17.55"></a><span id="l17.55"> # used for a display the start of an alarm like 'Starts:  Thu 2 Oct 2008 13:21'</span>
<a href="#l17.56"></a><span id="l17.56"> #    %1$S will be replaced with a date-time</span>
<a href="#l17.57"></a><span id="l17.57" class="difflineat">@@ -381,20 +361,16 @@ alarmYesterdayAt=Yesterday at %1$S</span>
<a href="#l17.58"></a><span id="l17.58"> </span>
<a href="#l17.59"></a><span id="l17.59"> # Alarm interface strings</span>
<a href="#l17.60"></a><span id="l17.60"> # LOCALIZATION NOTE: These strings do not get displayed. They are only visible</span>
<a href="#l17.61"></a><span id="l17.61"> # when exporting an item with i.e a DISPLAY alarm, that doesn't have a</span>
<a href="#l17.62"></a><span id="l17.62"> # description set, or an EMAIL alarm that doesn't have a summary set.</span>
<a href="#l17.63"></a><span id="l17.63"> alarmDefaultDescription=Default Mozilla Description</span>
<a href="#l17.64"></a><span id="l17.64"> alarmDefaultSummary=Default Mozilla Summary</span>
<a href="#l17.65"></a><span id="l17.65"> </span>
<a href="#l17.66"></a><span id="l17.66" class="difflineminus">-# offline support strings (SUNBIRD ONLY)</span>
<a href="#l17.67"></a><span id="l17.67" class="difflineminus">-offlineTooltip=You are currently offline.</span>
<a href="#l17.68"></a><span id="l17.68" class="difflineminus">-onlineTooltip=You are currently online.</span>
<a href="#l17.69"></a><span id="l17.69" class="difflineminus">-</span>
<a href="#l17.70"></a><span id="l17.70"> taskDetailsStatusNeedsAction=Needs Action</span>
<a href="#l17.71"></a><span id="l17.71"> </span>
<a href="#l17.72"></a><span id="l17.72"> # LOCALIZATION NOTE (taskDetailsStatusInProgress):</span>
<a href="#l17.73"></a><span id="l17.73"> # used for a display of how much of a task is completed '25% Complete'</span>
<a href="#l17.74"></a><span id="l17.74"> #    %1$S will be replaced with the number of percentage completed</span>
<a href="#l17.75"></a><span id="l17.75"> taskDetailsStatusInProgress=%1$S%% Complete</span>
<a href="#l17.76"></a><span id="l17.76"> taskDetailsStatusCompleted=Completed</span>
<a href="#l17.77"></a><span id="l17.77"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/locales/filter.py</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/locales/filter.py</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -1,28 +1,24 @@</span>
<a href="#l18.4"></a><span id="l18.4"> </span>
<a href="#l18.5"></a><span id="l18.5"> def test(mod, path, entity = None):</span>
<a href="#l18.6"></a><span id="l18.6">   import re</span>
<a href="#l18.7"></a><span id="l18.7"> </span>
<a href="#l18.8"></a><span id="l18.8">   # ignore anyhting but calendar stuff</span>
<a href="#l18.9"></a><span id="l18.9">   if mod not in (&quot;netwerk&quot;, &quot;dom&quot;, &quot;toolkit&quot;, &quot;security/manager&quot;,</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineminus">-                 &quot;calendar&quot;, &quot;other-licenses/branding/sunbird&quot;):</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineplus">+                 &quot;calendar&quot;):</span>
<a href="#l18.12"></a><span id="l18.12">     return False</span>
<a href="#l18.13"></a><span id="l18.13"> </span>
<a href="#l18.14"></a><span id="l18.14">   # Timezone properties don't have to be translated</span>
<a href="#l18.15"></a><span id="l18.15">   if path == &quot;chrome/calendar/timezones.properties&quot;:</span>
<a href="#l18.16"></a><span id="l18.16">     return &quot;report&quot;</span>
<a href="#l18.17"></a><span id="l18.17"> </span>
<a href="#l18.18"></a><span id="l18.18">   # Noun class entries do not have to be translated</span>
<a href="#l18.19"></a><span id="l18.19">   if path == &quot;chrome/calendar/calendar-event-dialog.properties&quot;:</span>
<a href="#l18.20"></a><span id="l18.20">     return not re.match(r&quot;.*Nounclass[1-9]&quot;, entity)</span>
<a href="#l18.21"></a><span id="l18.21"> </span>
<a href="#l18.22"></a><span id="l18.22">   # most extraction related strings are not required</span>
<a href="#l18.23"></a><span id="l18.23">   if path == &quot;chrome/calendar/calendar-extract.properties&quot;:</span>
<a href="#l18.24"></a><span id="l18.24">     if not re.match(r&quot;from.today&quot;, entity):</span>
<a href="#l18.25"></a><span id="l18.25">       return &quot;report&quot;</span>
<a href="#l18.26"></a><span id="l18.26"> </span>
<a href="#l18.27"></a><span id="l18.27" class="difflineminus">-  # Sunbird specific strings don't need translation</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineminus">-  if path.startswith(&quot;chrome/sunbird/&quot;):</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineminus">-    return False</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineminus">-</span>
<a href="#l18.31"></a><span id="l18.31">   # Everything else should be taken into account</span>
<a href="#l18.32"></a><span id="l18.32">   return True</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1">deleted file mode 100755</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineminus">--- a/calendar/locales/l10n-1.9.2.ini</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineplus">+++ /dev/null</span>
<a href="#l19.4"></a><span id="l19.4" class="difflineat">@@ -1,20 +0,0 @@</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineminus">-[general]</span>
<a href="#l19.6"></a><span id="l19.6" class="difflineminus">-depth = ../..</span>
<a href="#l19.7"></a><span id="l19.7" class="difflineminus">-all = calendar/locales/all-locales</span>
<a href="#l19.8"></a><span id="l19.8" class="difflineminus">-</span>
<a href="#l19.9"></a><span id="l19.9" class="difflineminus">-[compare]</span>
<a href="#l19.10"></a><span id="l19.10" class="difflineminus">-dirs = calendar</span>
<a href="#l19.11"></a><span id="l19.11" class="difflineminus">-       other-licenses/branding/sunbird</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-[includes]</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineminus">-# non-central apps might want to use %(topsrcdir)s here, or other vars</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineminus">-# RFE: that needs to be supported by compare-locales, too, though</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineminus">-toolkit = mozilla/toolkit/locales/l10n.ini</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineminus">-</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineminus">-[extras]</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineminus">-</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineminus">-[include_toolkit]</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineminus">-type = hg</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineminus">-mozilla = releases/mozilla-1.9.2</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineminus">-repo = http://hg.mozilla.org/</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineminus">-l10n.ini = toolkit/locales/l10n.ini</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/locales/l10n.ini</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/locales/l10n.ini</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -1,26 +1,12 @@</span>
<a href="#l20.4"></a><span id="l20.4"> [general]</span>
<a href="#l20.5"></a><span id="l20.5"> depth = ../..</span>
<a href="#l20.6"></a><span id="l20.6"> all = calendar/locales/all-locales</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8"> [compare]</span>
<a href="#l20.9"></a><span id="l20.9"> dirs = calendar</span>
<a href="#l20.10"></a><span id="l20.10" class="difflineminus">-# If you are comparing for Sunbird, you must also add:</span>
<a href="#l20.11"></a><span id="l20.11" class="difflineminus">-#       other-licenses/branding/sunbird</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineminus">-</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineminus">-# To avoid having localizers translate extra strings, the inclusion for toolkit</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineminus">-# has been commented out. If you would like to compare for Sunbird, you need to</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineminus">-# add these in again</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineminus">-#</span>
<a href="#l20.18"></a><span id="l20.18"> # [includes]</span>
<a href="#l20.19"></a><span id="l20.19"> # # non-central apps might want to use %(topsrcdir)s here, or other vars</span>
<a href="#l20.20"></a><span id="l20.20"> # # RFE: that needs to be supported by compare-locales, too, though</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineminus">-# toolkit = mozilla/toolkit/locales/l10n.ini</span>
<a href="#l20.22"></a><span id="l20.22"> #</span>
<a href="#l20.23"></a><span id="l20.23"> # [extras]</span>
<a href="#l20.24"></a><span id="l20.24"> #</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineminus">-# [include_toolkit]</span>
<a href="#l20.26"></a><span id="l20.26" class="difflineminus">-# type = hg</span>
<a href="#l20.27"></a><span id="l20.27" class="difflineminus">-# mozilla = mozilla-central</span>
<a href="#l20.28"></a><span id="l20.28" class="difflineminus">-# repo = http://hg.mozilla.org/</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineminus">-# l10n.ini = toolkit/locales/l10n.ini</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/providers/gdata/content/gdata-migration.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/providers/gdata/content/gdata-migration.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -57,17 +57,17 @@ function getMigratableCalendars() {</span>
<a href="#l21.4"></a><span id="l21.4">                             &quot;attendees-only|free-busy|basic)(\\.ics)?$&quot;);</span>
<a href="#l21.5"></a><span id="l21.5">         return c.type == &quot;ics&quot; &amp;&amp; c.uri.spec.match(re);</span>
<a href="#l21.6"></a><span id="l21.6">     }</span>
<a href="#l21.7"></a><span id="l21.7"> </span>
<a href="#l21.8"></a><span id="l21.8">     return getCalendarManager().getCalendars({}).filter(isMigratable);</span>
<a href="#l21.9"></a><span id="l21.9"> }</span>
<a href="#l21.10"></a><span id="l21.10"> </span>
<a href="#l21.11"></a><span id="l21.11"> /**</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">- * Load Handler for both the wizard and the Sunbird/Thunderbird main windows.</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+ * Load Handler for both the wizard and the Thunderbird main window.</span>
<a href="#l21.14"></a><span id="l21.14">  */</span>
<a href="#l21.15"></a><span id="l21.15"> function gdata_migration_loader() {</span>
<a href="#l21.16"></a><span id="l21.16">     // Only load once</span>
<a href="#l21.17"></a><span id="l21.17">     window.removeEventListener(&quot;load&quot;, gdata_migration_loader, false);</span>
<a href="#l21.18"></a><span id="l21.18"> </span>
<a href="#l21.19"></a><span id="l21.19">     if (document.documentElement.id == &quot;gdata-migration-wizard&quot;) {</span>
<a href="#l21.20"></a><span id="l21.20">         // This is the migration wizard, load the calendars neeeded.</span>
<a href="#l21.21"></a><span id="l21.21">         let listbox = document.getElementById(&quot;calendars-listbox&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/providers/gdata/install.rdf</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/providers/gdata/install.rdf</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -11,48 +11,31 @@</span>
<a href="#l22.4"></a><span id="l22.4">     &lt;em:id&gt;{a62ef8ec-5fdc-40c2-873c-223b8a6925cc}&lt;/em:id&gt;</span>
<a href="#l22.5"></a><span id="l22.5">     &lt;em:version&gt;@GDATA_VERSION@&lt;/em:version&gt;</span>
<a href="#l22.6"></a><span id="l22.6">     &lt;em:type&gt;2&lt;/em:type&gt;</span>
<a href="#l22.7"></a><span id="l22.7"> </span>
<a href="#l22.8"></a><span id="l22.8">     &lt;!-- Target Application this extension can install into,</span>
<a href="#l22.9"></a><span id="l22.9">          with minimum and maximum supported versions. --&gt;</span>
<a href="#l22.10"></a><span id="l22.10">     &lt;em:targetApplication&gt;</span>
<a href="#l22.11"></a><span id="l22.11">       &lt;Description&gt;</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-        &lt;!-- Sunbird --&gt;</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineminus">-        &lt;em:id&gt;{718e30fb-e89b-41dd-9da7-e25a45638b28}&lt;/em:id&gt;</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineminus">-        &lt;em:minVersion&gt;@CALENDAR_VERSION@&lt;/em:minVersion&gt;</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineminus">-        &lt;em:maxVersion&gt;@CALENDAR_VERSION@&lt;/em:maxVersion&gt;</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineminus">-      &lt;/Description&gt;</span>
<a href="#l22.17"></a><span id="l22.17" class="difflineminus">-    &lt;/em:targetApplication&gt;</span>
<a href="#l22.18"></a><span id="l22.18" class="difflineminus">-    &lt;em:targetApplication&gt;</span>
<a href="#l22.19"></a><span id="l22.19" class="difflineminus">-      &lt;Description&gt;</span>
<a href="#l22.20"></a><span id="l22.20">         &lt;!-- Thunderbird --&gt;</span>
<a href="#l22.21"></a><span id="l22.21">         &lt;em:id&gt;{3550f703-e582-4d05-9a08-453d09bdfdc6}&lt;/em:id&gt;</span>
<a href="#l22.22"></a><span id="l22.22">         &lt;em:minVersion&gt;17.0a1&lt;/em:minVersion&gt;</span>
<a href="#l22.23"></a><span id="l22.23">         &lt;em:maxVersion&gt;@THUNDERBIRD_VERSION@&lt;/em:maxVersion&gt;</span>
<a href="#l22.24"></a><span id="l22.24">       &lt;/Description&gt;</span>
<a href="#l22.25"></a><span id="l22.25">     &lt;/em:targetApplication&gt;</span>
<a href="#l22.26"></a><span id="l22.26">     &lt;em:targetApplication&gt;</span>
<a href="#l22.27"></a><span id="l22.27">       &lt;Description&gt;</span>
<a href="#l22.28"></a><span id="l22.28">         &lt;!-- SeaMonkey --&gt;</span>
<a href="#l22.29"></a><span id="l22.29">         &lt;em:id&gt;{92650c4d-4b8e-4d2a-b7eb-24ecf4f6b63a}&lt;/em:id&gt;</span>
<a href="#l22.30"></a><span id="l22.30">         &lt;em:minVersion&gt;2.14a1&lt;/em:minVersion&gt;</span>
<a href="#l22.31"></a><span id="l22.31">         &lt;em:maxVersion&gt;@SEAMONKEY_VERSION@&lt;/em:maxVersion&gt;</span>
<a href="#l22.32"></a><span id="l22.32">       &lt;/Description&gt;</span>
<a href="#l22.33"></a><span id="l22.33">     &lt;/em:targetApplication&gt;</span>
<a href="#l22.34"></a><span id="l22.34"> </span>
<a href="#l22.35"></a><span id="l22.35" class="difflineminus">-    &lt;em:requires&gt;</span>
<a href="#l22.36"></a><span id="l22.36" class="difflineminus">-      &lt;Description&gt;</span>
<a href="#l22.37"></a><span id="l22.37" class="difflineminus">-        &lt;!-- Lightning (also Sunbird via extension stub) --&gt;</span>
<a href="#l22.38"></a><span id="l22.38" class="difflineminus">-        &lt;em:id&gt;{e2fda1a4-762b-4020-b5ad-a41df1933103}&lt;/em:id&gt;</span>
<a href="#l22.39"></a><span id="l22.39" class="difflineminus">-        &lt;em:minVersion&gt;1.9a1&lt;/em:minVersion&gt;</span>
<a href="#l22.40"></a><span id="l22.40" class="difflineminus">-        &lt;em:maxVersion&gt;@CALENDAR_VERSION@&lt;/em:maxVersion&gt;</span>
<a href="#l22.41"></a><span id="l22.41" class="difflineminus">-      &lt;/Description&gt;</span>
<a href="#l22.42"></a><span id="l22.42" class="difflineminus">-    &lt;/em:requires&gt;</span>
<a href="#l22.43"></a><span id="l22.43" class="difflineminus">-</span>
<a href="#l22.44"></a><span id="l22.44">     &lt;em:name&gt;Provider for Google Calendar&lt;/em:name&gt;</span>
<a href="#l22.45"></a><span id="l22.45">     &lt;em:description&gt;Allows bidirectional access to Google Calendar&lt;/em:description&gt;</span>
<a href="#l22.46"></a><span id="l22.46">     &lt;em:creator&gt;Philipp Kewisch&lt;/em:creator&gt;</span>
<a href="#l22.47"></a><span id="l22.47">     &lt;em:contributor&gt;Mark James (http://www.famfamfam.com/lab/icons/silk/)&lt;/em:contributor&gt;</span>
<a href="#l22.48"></a><span id="l22.48">     &lt;em:homepageURL&gt;https://addons.mozilla.org/thunderbird/addon/4631&lt;/em:homepageURL&gt;</span>
<a href="#l22.49"></a><span id="l22.49">     &lt;em:iconURL&gt;chrome://gdata-provider/content/gcal.png&lt;/em:iconURL&gt;</span>
<a href="#l22.50"></a><span id="l22.50">     &lt;em:unpack&gt;true&lt;/em:unpack&gt;</span>
<a href="#l22.51"></a><span id="l22.51">   &lt;/Description&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/providers/gdata/jar.mn</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/providers/gdata/jar.mn</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -2,22 +2,20 @@</span>
<a href="#l23.4"></a><span id="l23.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.5"></a><span id="l23.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.6"></a><span id="l23.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l23.7"></a><span id="l23.7"> </span>
<a href="#l23.8"></a><span id="l23.8"> </span>
<a href="#l23.9"></a><span id="l23.9"> gdata-provider.jar:</span>
<a href="#l23.10"></a><span id="l23.10"> % content gdata-provider %content/</span>
<a href="#l23.11"></a><span id="l23.11"> % overlay chrome://calendar/content/calendarCreation.xul chrome://gdata-provider/content/calendarCreation.xul</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-% overlay chrome://sunbird/content/calendar.xul chrome://gdata-provider/content/gdata-migration-overlay.xul    application={718e30fb-e89b-41dd-9da7-e25a45638b28}</span>
<a href="#l23.13"></a><span id="l23.13"> % overlay chrome://messenger/content/messenger.xul chrome://gdata-provider/content/gdata-migration-overlay.xul  application={3550f703-e582-4d05-9a08-453d09bdfdc6}</span>
<a href="#l23.14"></a><span id="l23.14"> % overlay chrome://calendar/content/calendar-event-dialog.xul chrome://gdata-provider/content/gdata-calendar-event-dialog.xul</span>
<a href="#l23.15"></a><span id="l23.15"> % overlay chrome://calendar/content/calendar-event-dialog-reminder.xul chrome://gdata-provider/content/gdata-event-dialog-reminder.xul</span>
<a href="#l23.16"></a><span id="l23.16"> % style chrome://calendar/content/calendar-event-dialog.xul chrome://gdata-provider/skin/gdata-event-dialog-reminder.css</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineminus">-% style chrome://calendar/content/calendar.xul chrome://gdata-provider/skin/gdata-event-dialog-reminder.css     application={718e30fb-e89b-41dd-9da7-e25a45638b28}</span>
<a href="#l23.18"></a><span id="l23.18"> % style chrome://messenger/content/messenger.xul chrome://gdata-provider/skin/gdata-event-dialog-reminder.css   application={3550f703-e582-4d05-9a08-453d09bdfdc6}</span>
<a href="#l23.19"></a><span id="l23.19">     content/calendarCreation.xul                 (content/calendarCreation.xul)</span>
<a href="#l23.20"></a><span id="l23.20">     content/gdata-calendar-event-dialog.xul      (content/gdata-calendar-event-dialog.xul)</span>
<a href="#l23.21"></a><span id="l23.21">     content/gdata-event-dialog-reminder.xul      (content/gdata-event-dialog-reminder.xul)</span>
<a href="#l23.22"></a><span id="l23.22">     content/gdata-migration.js                   (content/gdata-migration.js)</span>
<a href="#l23.23"></a><span id="l23.23">     content/gdata-migration-overlay.xul          (content/gdata-migration-overlay.xul)</span>
<a href="#l23.24"></a><span id="l23.24">     content/gdata-migration-wizard.xul           (content/gdata-migration-wizard.xul)</span>
<a href="#l23.25"></a><span id="l23.25">     content/gcal.png                             (content/gcal.png)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1">deleted file mode 100644</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineminus">--- a/calendar/resources/content/calendar.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineplus">+++ /dev/null</span>
<a href="#l24.4"></a><span id="l24.4" class="difflineat">@@ -1,207 +0,0 @@</span>
<a href="#l24.5"></a><span id="l24.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l24.6"></a><span id="l24.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l24.7"></a><span id="l24.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l24.8"></a><span id="l24.8" class="difflineminus">-</span>
<a href="#l24.9"></a><span id="l24.9" class="difflineminus">-/**</span>
<a href="#l24.10"></a><span id="l24.10" class="difflineminus">- * Called from calendar.xul window onload.</span>
<a href="#l24.11"></a><span id="l24.11" class="difflineminus">- */</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineminus">-Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineminus">-Components.utils.import(&quot;resource://gre/modules/Preferences.jsm&quot;);</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineminus">-</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineminus">-function calendarInit() {</span>
<a href="#l24.17"></a><span id="l24.17" class="difflineminus">-    // Take care of common initialization</span>
<a href="#l24.18"></a><span id="l24.18" class="difflineminus">-    commonInitCalendar();</span>
<a href="#l24.19"></a><span id="l24.19" class="difflineminus">-</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineminus">-    var toolbox = document.getElementById(&quot;calendar-toolbox&quot;);</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineminus">-    toolbox.customizeDone = CalendarToolboxCustomizeDone;</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineminus">-</span>
<a href="#l24.23"></a><span id="l24.23" class="difflineminus">-    // Setup the offline manager</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineminus">-    calendarOfflineManager.init();</span>
<a href="#l24.25"></a><span id="l24.25" class="difflineminus">-</span>
<a href="#l24.26"></a><span id="l24.26" class="difflineminus">-    // Handle commandline args</span>
<a href="#l24.27"></a><span id="l24.27" class="difflineminus">-    for (var i = 0; i &lt; window.arguments.length; i++) {</span>
<a href="#l24.28"></a><span id="l24.28" class="difflineminus">-        try {</span>
<a href="#l24.29"></a><span id="l24.29" class="difflineminus">-            var cl = window.arguments[i].QueryInterface(Components.interfaces.nsICommandLine);</span>
<a href="#l24.30"></a><span id="l24.30" class="difflineminus">-        } catch (ex) {</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineminus">-            dump(&quot;unknown argument passed to main window\n&quot;);</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineminus">-            continue;</span>
<a href="#l24.33"></a><span id="l24.33" class="difflineminus">-        }</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineminus">-        handleCommandLine(cl);</span>
<a href="#l24.35"></a><span id="l24.35" class="difflineminus">-    }</span>
<a href="#l24.36"></a><span id="l24.36" class="difflineminus">-}</span>
<a href="#l24.37"></a><span id="l24.37" class="difflineminus">-</span>
<a href="#l24.38"></a><span id="l24.38" class="difflineminus">-function handleCommandLine(aComLine) {</span>
<a href="#l24.39"></a><span id="l24.39" class="difflineminus">-    var comLine = aComLine;</span>
<a href="#l24.40"></a><span id="l24.40" class="difflineminus">-    var calurl = [];</span>
<a href="#l24.41"></a><span id="l24.41" class="difflineminus">-</span>
<a href="#l24.42"></a><span id="l24.42" class="difflineminus">-    var validFlags = [&quot;showdate&quot;, &quot;subscribe&quot;, &quot;url&quot;];</span>
<a href="#l24.43"></a><span id="l24.43" class="difflineminus">-    var flagsToProcess = [];</span>
<a href="#l24.44"></a><span id="l24.44" class="difflineminus">-</span>
<a href="#l24.45"></a><span id="l24.45" class="difflineminus">-    for each (var flag in validFlags) {</span>
<a href="#l24.46"></a><span id="l24.46" class="difflineminus">-        if (comLine.findFlag(flag, false) &gt;= 0) {</span>
<a href="#l24.47"></a><span id="l24.47" class="difflineminus">-            flagsToProcess.push(flag);</span>
<a href="#l24.48"></a><span id="l24.48" class="difflineminus">-        }</span>
<a href="#l24.49"></a><span id="l24.49" class="difflineminus">-    }</span>
<a href="#l24.50"></a><span id="l24.50" class="difflineminus">-</span>
<a href="#l24.51"></a><span id="l24.51" class="difflineminus">-    for each (var flag in flagsToProcess) {</span>
<a href="#l24.52"></a><span id="l24.52" class="difflineminus">-        var param = comLine.handleFlagWithParam(flag, false);</span>
<a href="#l24.53"></a><span id="l24.53" class="difflineminus">-</span>
<a href="#l24.54"></a><span id="l24.54" class="difflineminus">-        switch (flag) {</span>
<a href="#l24.55"></a><span id="l24.55" class="difflineminus">-            case &quot;showdate&quot;:</span>
<a href="#l24.56"></a><span id="l24.56" class="difflineminus">-                currentView().goToDay(cal.jsDateToDateTime(new Date(param)));</span>
<a href="#l24.57"></a><span id="l24.57" class="difflineminus">-                break;</span>
<a href="#l24.58"></a><span id="l24.58" class="difflineminus">-            case &quot;subscribe&quot;:</span>
<a href="#l24.59"></a><span id="l24.59" class="difflineminus">-            case &quot;url&quot;:</span>
<a href="#l24.60"></a><span id="l24.60" class="difflineminus">-                // Double-clicking an .ics file on the Mac causes</span>
<a href="#l24.61"></a><span id="l24.61" class="difflineminus">-                // LaunchServices to launch Sunbird with the -url command line</span>
<a href="#l24.62"></a><span id="l24.62" class="difflineminus">-                // switch like so:</span>
<a href="#l24.63"></a><span id="l24.63" class="difflineminus">-                // sunbird-bin -url file://localhost/Users/foo/mycal.ics -foreground</span>
<a href="#l24.64"></a><span id="l24.64" class="difflineminus">-                calurl.push(param);</span>
<a href="#l24.65"></a><span id="l24.65" class="difflineminus">-                break;</span>
<a href="#l24.66"></a><span id="l24.66" class="difflineminus">-           default:</span>
<a href="#l24.67"></a><span id="l24.67" class="difflineminus">-                // no-op</span>
<a href="#l24.68"></a><span id="l24.68" class="difflineminus">-                break;</span>
<a href="#l24.69"></a><span id="l24.69" class="difflineminus">-        }</span>
<a href="#l24.70"></a><span id="l24.70" class="difflineminus">-    }</span>
<a href="#l24.71"></a><span id="l24.71" class="difflineminus">-</span>
<a href="#l24.72"></a><span id="l24.72" class="difflineminus">-    // Look for arguments without a flag.</span>
<a href="#l24.73"></a><span id="l24.73" class="difflineminus">-    // This is needed to handle double-click on Windows and Linux.</span>
<a href="#l24.74"></a><span id="l24.74" class="difflineminus">-    if (comLine.length &gt;= 1) {</span>
<a href="#l24.75"></a><span id="l24.75" class="difflineminus">-        for (var i = 0; i &lt; comLine.length; i++) {</span>
<a href="#l24.76"></a><span id="l24.76" class="difflineminus">-            if (!comLine.getArgument(i).match(/^-/) &amp;&amp;</span>
<a href="#l24.77"></a><span id="l24.77" class="difflineminus">-                !comLine.getArgument(i).match(/^\s/)) {</span>
<a href="#l24.78"></a><span id="l24.78" class="difflineminus">-                calurl.push( comLine.getArgument(i) );</span>
<a href="#l24.79"></a><span id="l24.79" class="difflineminus">-            } else {</span>
<a href="#l24.80"></a><span id="l24.80" class="difflineminus">-                comLine.removeArguments(i, i);</span>
<a href="#l24.81"></a><span id="l24.81" class="difflineminus">-            }</span>
<a href="#l24.82"></a><span id="l24.82" class="difflineminus">-        }</span>
<a href="#l24.83"></a><span id="l24.83" class="difflineminus">-    }</span>
<a href="#l24.84"></a><span id="l24.84" class="difflineminus">-</span>
<a href="#l24.85"></a><span id="l24.85" class="difflineminus">-    //subscribe to all files in the calurl array</span>
<a href="#l24.86"></a><span id="l24.86" class="difflineminus">-    for (var i = 0; i &lt; calurl.length; i++) {</span>
<a href="#l24.87"></a><span id="l24.87" class="difflineminus">-        var uri = comLine.resolveURI(calurl[i]);</span>
<a href="#l24.88"></a><span id="l24.88" class="difflineminus">-        var calendar = getCalendarManager().createCalendar(&quot;ics&quot;, uri);</span>
<a href="#l24.89"></a><span id="l24.89" class="difflineminus">-</span>
<a href="#l24.90"></a><span id="l24.90" class="difflineminus">-        // Strip &quot;.ics&quot; from filename for use as calendar name</span>
<a href="#l24.91"></a><span id="l24.91" class="difflineminus">-        var fullPathRegEx = new RegExp(&quot;([^/:]+)[.]ics$&quot;);</span>
<a href="#l24.92"></a><span id="l24.92" class="difflineminus">-        var path = uri.path;</span>
<a href="#l24.93"></a><span id="l24.93" class="difflineminus">-        var prettyName = path.match(fullPathRegEx);</span>
<a href="#l24.94"></a><span id="l24.94" class="difflineminus">-</span>
<a href="#l24.95"></a><span id="l24.95" class="difflineminus">-        var name;</span>
<a href="#l24.96"></a><span id="l24.96" class="difflineminus">-        if (prettyName &amp;&amp; prettyName.length &gt;= 1) {</span>
<a href="#l24.97"></a><span id="l24.97" class="difflineminus">-            name = decodeURIComponent(prettyName[1]);</span>
<a href="#l24.98"></a><span id="l24.98" class="difflineminus">-        } else {</span>
<a href="#l24.99"></a><span id="l24.99" class="difflineminus">-            name = calGetString(&quot;calendar&quot;, &quot;untitledCalendarName&quot;);</span>
<a href="#l24.100"></a><span id="l24.100" class="difflineminus">-        }</span>
<a href="#l24.101"></a><span id="l24.101" class="difflineminus">-        calendar.name = name;</span>
<a href="#l24.102"></a><span id="l24.102" class="difflineminus">-</span>
<a href="#l24.103"></a><span id="l24.103" class="difflineminus">-        getCalendarManager().registerCalendar(calendar);</span>
<a href="#l24.104"></a><span id="l24.104" class="difflineminus">-    }</span>
<a href="#l24.105"></a><span id="l24.105" class="difflineminus">-}</span>
<a href="#l24.106"></a><span id="l24.106" class="difflineminus">-</span>
<a href="#l24.107"></a><span id="l24.107" class="difflineminus">-/* Called at midnight to tell us to update the views and other ui bits */</span>
<a href="#l24.108"></a><span id="l24.108" class="difflineminus">-function refreshUIBits() {</span>
<a href="#l24.109"></a><span id="l24.109" class="difflineminus">-    try {</span>
<a href="#l24.110"></a><span id="l24.110" class="difflineminus">-        currentView().goToDay(now());</span>
<a href="#l24.111"></a><span id="l24.111" class="difflineminus">-        refreshEventTree();</span>
<a href="#l24.112"></a><span id="l24.112" class="difflineminus">-    } catch (exc) {</span>
<a href="#l24.113"></a><span id="l24.113" class="difflineminus">-        ASSERT(false, exc);</span>
<a href="#l24.114"></a><span id="l24.114" class="difflineminus">-    }</span>
<a href="#l24.115"></a><span id="l24.115" class="difflineminus">-</span>
<a href="#l24.116"></a><span id="l24.116" class="difflineminus">-    // and schedule again...</span>
<a href="#l24.117"></a><span id="l24.117" class="difflineminus">-    scheduleMidnightUpdate(refreshUIBits);</span>
<a href="#l24.118"></a><span id="l24.118" class="difflineminus">-}</span>
<a href="#l24.119"></a><span id="l24.119" class="difflineminus">-</span>
<a href="#l24.120"></a><span id="l24.120" class="difflineminus">-/**</span>
<a href="#l24.121"></a><span id="l24.121" class="difflineminus">- * Steps to be taken when the sunbird calendar window is unloaded.</span>
<a href="#l24.122"></a><span id="l24.122" class="difflineminus">- */</span>
<a href="#l24.123"></a><span id="l24.123" class="difflineminus">-function calendarFinish() {</span>
<a href="#l24.124"></a><span id="l24.124" class="difflineminus">-    // Workaround to make the selected tab persist. See bug 249552.</span>
<a href="#l24.125"></a><span id="l24.125" class="difflineminus">-    var tabbox = document.getElementById(&quot;tablist&quot;);</span>
<a href="#l24.126"></a><span id="l24.126" class="difflineminus">-    tabbox.setAttribute(&quot;selectedIndex&quot;, tabbox.selectedIndex);</span>
<a href="#l24.127"></a><span id="l24.127" class="difflineminus">-</span>
<a href="#l24.128"></a><span id="l24.128" class="difflineminus">-    // Finish the offline manager</span>
<a href="#l24.129"></a><span id="l24.129" class="difflineminus">-    calendarOfflineManager.uninit();</span>
<a href="#l24.130"></a><span id="l24.130" class="difflineminus">-</span>
<a href="#l24.131"></a><span id="l24.131" class="difflineminus">-    // Common finish steps</span>
<a href="#l24.132"></a><span id="l24.132" class="difflineminus">-    commonFinishCalendar();</span>
<a href="#l24.133"></a><span id="l24.133" class="difflineminus">-}</span>
<a href="#l24.134"></a><span id="l24.134" class="difflineminus">-</span>
<a href="#l24.135"></a><span id="l24.135" class="difflineminus">-function closeCalendar() {</span>
<a href="#l24.136"></a><span id="l24.136" class="difflineminus">-    self.close();</span>
<a href="#l24.137"></a><span id="l24.137" class="difflineminus">-}</span>
<a href="#l24.138"></a><span id="l24.138" class="difflineminus">-</span>
<a href="#l24.139"></a><span id="l24.139" class="difflineminus">-function openPreferences() {</span>
<a href="#l24.140"></a><span id="l24.140" class="difflineminus">-    // Check to see if the prefwindow is already open</span>
<a href="#l24.141"></a><span id="l24.141" class="difflineminus">-    var win = Services.wm.getMostRecentWindow(&quot;Calendar:Preferences&quot;);</span>
<a href="#l24.142"></a><span id="l24.142" class="difflineminus">-</span>
<a href="#l24.143"></a><span id="l24.143" class="difflineminus">-    if (win) {</span>
<a href="#l24.144"></a><span id="l24.144" class="difflineminus">-        win.focus();</span>
<a href="#l24.145"></a><span id="l24.145" class="difflineminus">-    } else {</span>
<a href="#l24.146"></a><span id="l24.146" class="difflineminus">-        // The prefwindow should only be modal on non-instant-apply platforms</span>
<a href="#l24.147"></a><span id="l24.147" class="difflineminus">-        var instApply = Preferences.get(&quot;browser.preferences.instantApply&quot;, false);</span>
<a href="#l24.148"></a><span id="l24.148" class="difflineminus">-</span>
<a href="#l24.149"></a><span id="l24.149" class="difflineminus">-        var features = &quot;chrome,titlebar,toolbar,centerscreen,&quot; +</span>
<a href="#l24.150"></a><span id="l24.150" class="difflineminus">-                       (instApply ? &quot;dialog=no&quot; : &quot;modal&quot;);</span>
<a href="#l24.151"></a><span id="l24.151" class="difflineminus">-</span>
<a href="#l24.152"></a><span id="l24.152" class="difflineminus">-        var url = &quot;chrome://calendar/content/preferences/preferences.xul&quot;;</span>
<a href="#l24.153"></a><span id="l24.153" class="difflineminus">-</span>
<a href="#l24.154"></a><span id="l24.154" class="difflineminus">-        openDialog(url, &quot;Preferences&quot;, features);</span>
<a href="#l24.155"></a><span id="l24.155" class="difflineminus">-    }</span>
<a href="#l24.156"></a><span id="l24.156" class="difflineminus">-}</span>
<a href="#l24.157"></a><span id="l24.157" class="difflineminus">-</span>
<a href="#l24.158"></a><span id="l24.158" class="difflineminus">-function CalendarCustomizeToolbar() {</span>
<a href="#l24.159"></a><span id="l24.159" class="difflineminus">-  // Disable the toolbar context menu items</span>
<a href="#l24.160"></a><span id="l24.160" class="difflineminus">-  var menubar = document.getElementById(&quot;main-menubar&quot;);</span>
<a href="#l24.161"></a><span id="l24.161" class="difflineminus">-  for (var i = 0; i &lt; menubar.childNodes.length; ++i) {</span>
<a href="#l24.162"></a><span id="l24.162" class="difflineminus">-    menubar.childNodes[i].setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l24.163"></a><span id="l24.163" class="difflineminus">-  }</span>
<a href="#l24.164"></a><span id="l24.164" class="difflineminus">-</span>
<a href="#l24.165"></a><span id="l24.165" class="difflineminus">-  var cmd = document.getElementById(&quot;cmd_CustomizeToolbars&quot;);</span>
<a href="#l24.166"></a><span id="l24.166" class="difflineminus">-  cmd.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l24.167"></a><span id="l24.167" class="difflineminus">-</span>
<a href="#l24.168"></a><span id="l24.168" class="difflineminus">-  window.openDialog(&quot;chrome://global/content/customizeToolbar.xul&quot;, &quot;CustomizeToolbar&quot;,</span>
<a href="#l24.169"></a><span id="l24.169" class="difflineminus">-                    &quot;chrome,all,dependent&quot;, document.getElementById(&quot;calendar-toolbox&quot;));</span>
<a href="#l24.170"></a><span id="l24.170" class="difflineminus">-}</span>
<a href="#l24.171"></a><span id="l24.171" class="difflineminus">-</span>
<a href="#l24.172"></a><span id="l24.172" class="difflineminus">-function CalendarToolboxCustomizeDone(aToolboxChanged) {</span>
<a href="#l24.173"></a><span id="l24.173" class="difflineminus">-  // Re-enable parts of the UI we disabled during the dialog</span>
<a href="#l24.174"></a><span id="l24.174" class="difflineminus">-  var menubar = document.getElementById(&quot;main-menubar&quot;);</span>
<a href="#l24.175"></a><span id="l24.175" class="difflineminus">-  for (var i = 0; i &lt; menubar.childNodes.length; ++i) {</span>
<a href="#l24.176"></a><span id="l24.176" class="difflineminus">-    menubar.childNodes[i].setAttribute(&quot;disabled&quot;, false);</span>
<a href="#l24.177"></a><span id="l24.177" class="difflineminus">-  }</span>
<a href="#l24.178"></a><span id="l24.178" class="difflineminus">-  var cmd = document.getElementById(&quot;cmd_CustomizeToolbars&quot;);</span>
<a href="#l24.179"></a><span id="l24.179" class="difflineminus">-  cmd.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l24.180"></a><span id="l24.180" class="difflineminus">-</span>
<a href="#l24.181"></a><span id="l24.181" class="difflineminus">-  // XXX Shouldn't have to do this, but I do</span>
<a href="#l24.182"></a><span id="l24.182" class="difflineminus">-  window.focus();</span>
<a href="#l24.183"></a><span id="l24.183" class="difflineminus">-}</span>
<a href="#l24.184"></a><span id="l24.184" class="difflineminus">-</span>
<a href="#l24.185"></a><span id="l24.185" class="difflineminus">-function changeNumberOfWeeks(menuitem) {</span>
<a href="#l24.186"></a><span id="l24.186" class="difflineminus">-  currentView().weeksInView = menuitem.value;</span>
<a href="#l24.187"></a><span id="l24.187" class="difflineminus">-}</span>
<a href="#l24.188"></a><span id="l24.188" class="difflineminus">-</span>
<a href="#l24.189"></a><span id="l24.189" class="difflineminus">-function pickAndGoToDate() {</span>
<a href="#l24.190"></a><span id="l24.190" class="difflineminus">-  var initialDate = currentView().selectedDay.getInTimezone(floating()).jsDate;</span>
<a href="#l24.191"></a><span id="l24.191" class="difflineminus">-  var callback = function receiveAndGoToDate(pickedDate) {</span>
<a href="#l24.192"></a><span id="l24.192" class="difflineminus">-    currentView().goToDay(cal.jsDateToDateTime(pickedDate));</span>
<a href="#l24.193"></a><span id="l24.193" class="difflineminus">-    getMinimonth().value = pickedDate;</span>
<a href="#l24.194"></a><span id="l24.194" class="difflineminus">-  };</span>
<a href="#l24.195"></a><span id="l24.195" class="difflineminus">-  openDialog(&quot;chrome://sunbird/content/calendar-gotodate-dialog.xul&quot;,</span>
<a href="#l24.196"></a><span id="l24.196" class="difflineminus">-             &quot;CalendarGoToDateDialog&quot;,</span>
<a href="#l24.197"></a><span id="l24.197" class="difflineminus">-             &quot;chrome,modal&quot;,</span>
<a href="#l24.198"></a><span id="l24.198" class="difflineminus">-             {callback: callback, date: initialDate});</span>
<a href="#l24.199"></a><span id="l24.199" class="difflineminus">-}</span>
<a href="#l24.200"></a><span id="l24.200" class="difflineminus">-</span>
<a href="#l24.201"></a><span id="l24.201" class="difflineminus">-function sbSwitchToView(newView) {</span>
<a href="#l24.202"></a><span id="l24.202" class="difflineminus">-  var mwWeeksCommand = document.getElementById(&quot;menu-numberofweeks-inview&quot;);</span>
<a href="#l24.203"></a><span id="l24.203" class="difflineminus">-  if (newView == &quot;multiweek&quot;) {</span>
<a href="#l24.204"></a><span id="l24.204" class="difflineminus">-      mwWeeksCommand.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l24.205"></a><span id="l24.205" class="difflineminus">-  } else {</span>
<a href="#l24.206"></a><span id="l24.206" class="difflineminus">-      mwWeeksCommand.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l24.207"></a><span id="l24.207" class="difflineminus">-  }</span>
<a href="#l24.208"></a><span id="l24.208" class="difflineminus">-</span>
<a href="#l24.209"></a><span id="l24.209" class="difflineminus">-  // Call the common view switching code in calendar-views.js</span>
<a href="#l24.210"></a><span id="l24.210" class="difflineminus">-  switchToView(newView);</span>
<a href="#l24.211"></a><span id="l24.211" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1">deleted file mode 100644</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineminus">--- a/calendar/resources/content/calendarService.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineplus">+++ /dev/null</span>
<a href="#l25.4"></a><span id="l25.4" class="difflineat">@@ -1,166 +0,0 @@</span>
<a href="#l25.5"></a><span id="l25.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l25.6"></a><span id="l25.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l25.7"></a><span id="l25.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l25.8"></a><span id="l25.8" class="difflineminus">-</span>
<a href="#l25.9"></a><span id="l25.9" class="difflineminus">-/*</span>
<a href="#l25.10"></a><span id="l25.10" class="difflineminus">- * This file contains the following calendar related components:</span>
<a href="#l25.11"></a><span id="l25.11" class="difflineminus">- * 1. Command line handler service, for responding to the -webcal command line</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">- *    option. (CLineHandler)</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">- * 2. Content handler for responding to content of type text/calendar</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineminus">- *    (ICALContentHandler)</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineminus">- * 3. Protocol handler for supplying a channel to the browser when an webcal://</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineminus">- *    link is clicked. (ICALProtocolHandler)</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineminus">- * 4. A (nearly empty) imeplementation of nsIChannel for telling the browser</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineminus">- *    that webcal:// links have the content type text/calendar (BogusChannel)</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineminus">- */</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineminus">-</span>
<a href="#l25.21"></a><span id="l25.21" class="difflineminus">-Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineminus">-Components.utils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l25.23"></a><span id="l25.23" class="difflineminus">-Components.utils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineminus">-</span>
<a href="#l25.25"></a><span id="l25.25" class="difflineminus">-/* Command Line handler service */</span>
<a href="#l25.26"></a><span id="l25.26" class="difflineminus">-function CLineService() {</span>
<a href="#l25.27"></a><span id="l25.27" class="difflineminus">-    this.wrappedJSObject = this;</span>
<a href="#l25.28"></a><span id="l25.28" class="difflineminus">-}</span>
<a href="#l25.29"></a><span id="l25.29" class="difflineminus">-const CLineServiceClassID = Components.ID(&quot;{65ef4b0b-d116-4b93-bf8a-84525992bf27}&quot;);</span>
<a href="#l25.30"></a><span id="l25.30" class="difflineminus">-const CLineServiceInterfaces = [Components.interfaces.nsICommandLineHandler];</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineminus">-CLineService.prototype = {</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineminus">-    classID: CLineServiceClassID,</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(CLineServiceInterfaces),</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineminus">-        classID: CLineServiceClassID,</span>
<a href="#l25.36"></a><span id="l25.36" class="difflineminus">-        contractID: &quot;@mozilla.org/commandlinehandler/general-startup;1?type=calendar&quot;,</span>
<a href="#l25.37"></a><span id="l25.37" class="difflineminus">-        classDescription: &quot;Calendar Commandline Handler&quot;,</span>
<a href="#l25.38"></a><span id="l25.38" class="difflineminus">-        interfaces: CLineServiceInterfaces,</span>
<a href="#l25.39"></a><span id="l25.39" class="difflineminus">-        flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l25.40"></a><span id="l25.40" class="difflineminus">-    }),</span>
<a href="#l25.41"></a><span id="l25.41" class="difflineminus">-</span>
<a href="#l25.42"></a><span id="l25.42" class="difflineminus">-    /* nsICommandLineHandler */</span>
<a href="#l25.43"></a><span id="l25.43" class="difflineminus">-    handle : function service_handle(cmdLine) {</span>
<a href="#l25.44"></a><span id="l25.44" class="difflineminus">-        if (!cmdLine.preventDefault) {</span>
<a href="#l25.45"></a><span id="l25.45" class="difflineminus">-            // just pass all arguments on to the Sunbird window</span>
<a href="#l25.46"></a><span id="l25.46" class="difflineminus">-            Services.ww.openWindow(null, &quot;chrome://sunbird/content/calendar.xul&quot;,</span>
<a href="#l25.47"></a><span id="l25.47" class="difflineminus">-                                   &quot;_blank&quot;, &quot;chrome,dialog=no,all&quot;, cmdLine);</span>
<a href="#l25.48"></a><span id="l25.48" class="difflineminus">-            cmdLine.preventDefault = true;</span>
<a href="#l25.49"></a><span id="l25.49" class="difflineminus">-        }</span>
<a href="#l25.50"></a><span id="l25.50" class="difflineminus">-    },</span>
<a href="#l25.51"></a><span id="l25.51" class="difflineminus">-</span>
<a href="#l25.52"></a><span id="l25.52" class="difflineminus">-    helpInfo : &quot;  -subscribe or -url   Pass in a path pointing to a calendar\n&quot; +</span>
<a href="#l25.53"></a><span id="l25.53" class="difflineminus">-               &quot;                       to subscribe to.\n&quot; +</span>
<a href="#l25.54"></a><span id="l25.54" class="difflineminus">-               &quot;  -showdate            Pass in a value for a javascript date\n&quot; +</span>
<a href="#l25.55"></a><span id="l25.55" class="difflineminus">-               &quot;                       to show this date on startup.\n&quot;</span>
<a href="#l25.56"></a><span id="l25.56" class="difflineminus">-};</span>
<a href="#l25.57"></a><span id="l25.57" class="difflineminus">-</span>
<a href="#l25.58"></a><span id="l25.58" class="difflineminus">-/* text/calendar content handler */</span>
<a href="#l25.59"></a><span id="l25.59" class="difflineminus">-function ICALContentHandler() {</span>
<a href="#l25.60"></a><span id="l25.60" class="difflineminus">-    this.wrappedJSObject = this;</span>
<a href="#l25.61"></a><span id="l25.61" class="difflineminus">-}</span>
<a href="#l25.62"></a><span id="l25.62" class="difflineminus">-const ICALContentHandlerClassID = Components.ID(&quot;{9ebf4c8a-7770-40a6-aeed-e1738129535a}&quot;);</span>
<a href="#l25.63"></a><span id="l25.63" class="difflineminus">-const ICALContentHandlerInterfaces = [Components.interfaces.nsIContentHandler];</span>
<a href="#l25.64"></a><span id="l25.64" class="difflineminus">-ICALContentHandler.prototype = {</span>
<a href="#l25.65"></a><span id="l25.65" class="difflineminus">-    classID: ICALContentHandlerClassID,</span>
<a href="#l25.66"></a><span id="l25.66" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(ICALContentHandlerInterfaces),</span>
<a href="#l25.67"></a><span id="l25.67" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l25.68"></a><span id="l25.68" class="difflineminus">-        classID: ICALContentHandlerClassID,</span>
<a href="#l25.69"></a><span id="l25.69" class="difflineminus">-        contractID: &quot;@mozilla.org/uriloader/content-handler;1?type=text/calendar&quot;,</span>
<a href="#l25.70"></a><span id="l25.70" class="difflineminus">-        classDescription: &quot;text/calendar Content Handler&quot;,</span>
<a href="#l25.71"></a><span id="l25.71" class="difflineminus">-        interfaces: ICALContentHandlerInterfaces</span>
<a href="#l25.72"></a><span id="l25.72" class="difflineminus">-    }),</span>
<a href="#l25.73"></a><span id="l25.73" class="difflineminus">-</span>
<a href="#l25.74"></a><span id="l25.74" class="difflineminus">-    handleContent: function handleContent(aContentType, aWindowTarget, aRequest) {</span>
<a href="#l25.75"></a><span id="l25.75" class="difflineminus">-        let channel = aRequest.QueryInterface(Components.interfaces.nsIChannel);</span>
<a href="#l25.76"></a><span id="l25.76" class="difflineminus">-</span>
<a href="#l25.77"></a><span id="l25.77" class="difflineminus">-        // Cancel the request ...</span>
<a href="#l25.78"></a><span id="l25.78" class="difflineminus">-        let uri = channel.URI;</span>
<a href="#l25.79"></a><span id="l25.79" class="difflineminus">-        const NS_BINDING_ABORTED = 0x804b0002 // from nsError.h</span>
<a href="#l25.80"></a><span id="l25.80" class="difflineminus">-        aRequest.cancel(NS_BINDING_ABORTED);</span>
<a href="#l25.81"></a><span id="l25.81" class="difflineminus">-</span>
<a href="#l25.82"></a><span id="l25.82" class="difflineminus">-        // ... Subscribe to the uri ...</span>
<a href="#l25.83"></a><span id="l25.83" class="difflineminus">-        let calendarManager = cal.getCalendarManager();</span>
<a href="#l25.84"></a><span id="l25.84" class="difflineminus">-        let newCalendar = calendarManager.createCalendar('ics', uri);</span>
<a href="#l25.85"></a><span id="l25.85" class="difflineminus">-</span>
<a href="#l25.86"></a><span id="l25.86" class="difflineminus">-        // XXX Come up with a better name, like the filename or X-WR-CALNAME</span>
<a href="#l25.87"></a><span id="l25.87" class="difflineminus">-        // XXX Also, make up a color</span>
<a href="#l25.88"></a><span id="l25.88" class="difflineminus">-        newCalendar.name = &quot;temp&quot;;</span>
<a href="#l25.89"></a><span id="l25.89" class="difflineminus">-</span>
<a href="#l25.90"></a><span id="l25.90" class="difflineminus">-        calendarManager.registerCalendar(newCalendar);</span>
<a href="#l25.91"></a><span id="l25.91" class="difflineminus">-</span>
<a href="#l25.92"></a><span id="l25.92" class="difflineminus">-        // ... and open or focus a calendar window.</span>
<a href="#l25.93"></a><span id="l25.93" class="difflineminus">-        let w = cal.getCalendarWindow();</span>
<a href="#l25.94"></a><span id="l25.94" class="difflineminus">-</span>
<a href="#l25.95"></a><span id="l25.95" class="difflineminus">-        if (w) {</span>
<a href="#l25.96"></a><span id="l25.96" class="difflineminus">-            w.focus();</span>
<a href="#l25.97"></a><span id="l25.97" class="difflineminus">-        } else {</span>
<a href="#l25.98"></a><span id="l25.98" class="difflineminus">-            w = Services.appShell.hiddenDOMWindow;</span>
<a href="#l25.99"></a><span id="l25.99" class="difflineminus">-</span>
<a href="#l25.100"></a><span id="l25.100" class="difflineminus">-            let args = {};</span>
<a href="#l25.101"></a><span id="l25.101" class="difflineminus">-            args.channel = channel;</span>
<a href="#l25.102"></a><span id="l25.102" class="difflineminus">-            w.openDialog(&quot;chrome://sunbird/content/calendar.xul&quot;,</span>
<a href="#l25.103"></a><span id="l25.103" class="difflineminus">-                         &quot;calendar&quot;,</span>
<a href="#l25.104"></a><span id="l25.104" class="difflineminus">-                         &quot;chrome,menubar,resizable,scrollbars,status,toolbar,dialog=no&quot;,</span>
<a href="#l25.105"></a><span id="l25.105" class="difflineminus">-                         args);</span>
<a href="#l25.106"></a><span id="l25.106" class="difflineminus">-        }</span>
<a href="#l25.107"></a><span id="l25.107" class="difflineminus">-    }</span>
<a href="#l25.108"></a><span id="l25.108" class="difflineminus">-};</span>
<a href="#l25.109"></a><span id="l25.109" class="difflineminus">-</span>
<a href="#l25.110"></a><span id="l25.110" class="difflineminus">-function NYI() {</span>
<a href="#l25.111"></a><span id="l25.111" class="difflineminus">-    throw Components.results.NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l25.112"></a><span id="l25.112" class="difflineminus">-}</span>
<a href="#l25.113"></a><span id="l25.113" class="difflineminus">-</span>
<a href="#l25.114"></a><span id="l25.114" class="difflineminus">-/* bogus webcal channel used by the ICALProtocolHandler */</span>
<a href="#l25.115"></a><span id="l25.115" class="difflineminus">-function BogusChannel(aURI) {</span>
<a href="#l25.116"></a><span id="l25.116" class="difflineminus">-    this.URI = aURI;</span>
<a href="#l25.117"></a><span id="l25.117" class="difflineminus">-    this.originalURI = aURI;</span>
<a href="#l25.118"></a><span id="l25.118" class="difflineminus">-}</span>
<a href="#l25.119"></a><span id="l25.119" class="difflineminus">-const BogusChannelClassID = Components.ID(&quot;{1e36ef5d-92d9-488f-ada6-9f15a1b57acf}&quot;);</span>
<a href="#l25.120"></a><span id="l25.120" class="difflineminus">-const BogusChannelInterfaces = [</span>
<a href="#l25.121"></a><span id="l25.121" class="difflineminus">-    Components.interfaces.nsIRequest,</span>
<a href="#l25.122"></a><span id="l25.122" class="difflineminus">-    Components.interfaces.nsIChannel</span>
<a href="#l25.123"></a><span id="l25.123" class="difflineminus">-];</span>
<a href="#l25.124"></a><span id="l25.124" class="difflineminus">-BogusChannel.prototype = {</span>
<a href="#l25.125"></a><span id="l25.125" class="difflineminus">-    classID: BogusChannelClassID,</span>
<a href="#l25.126"></a><span id="l25.126" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(BogusChannelInterfaces),</span>
<a href="#l25.127"></a><span id="l25.127" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l25.128"></a><span id="l25.128" class="difflineminus">-        classID: BogusChannelClassID,</span>
<a href="#l25.129"></a><span id="l25.129" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/webcal-channel;1&quot;,</span>
<a href="#l25.130"></a><span id="l25.130" class="difflineminus">-        classDescription: &quot;webcal bogus channel&quot;,</span>
<a href="#l25.131"></a><span id="l25.131" class="difflineminus">-        interfaces: BogusChannelInterfaces</span>
<a href="#l25.132"></a><span id="l25.132" class="difflineminus">-    }),</span>
<a href="#l25.133"></a><span id="l25.133" class="difflineminus">-</span>
<a href="#l25.134"></a><span id="l25.134" class="difflineminus">-    URI: null,</span>
<a href="#l25.135"></a><span id="l25.135" class="difflineminus">-    originalURI: null,</span>
<a href="#l25.136"></a><span id="l25.136" class="difflineminus">-</span>
<a href="#l25.137"></a><span id="l25.137" class="difflineminus">-    /* nsIChannel */</span>
<a href="#l25.138"></a><span id="l25.138" class="difflineminus">-    loadAttributes: null,</span>
<a href="#l25.139"></a><span id="l25.139" class="difflineminus">-    contentType: &quot;text/calendar&quot;,</span>
<a href="#l25.140"></a><span id="l25.140" class="difflineminus">-    contentLength: 0,</span>
<a href="#l25.141"></a><span id="l25.141" class="difflineminus">-    owner: null,</span>
<a href="#l25.142"></a><span id="l25.142" class="difflineminus">-    loadGroup: null,</span>
<a href="#l25.143"></a><span id="l25.143" class="difflineminus">-    notificationCallbacks: null,</span>
<a href="#l25.144"></a><span id="l25.144" class="difflineminus">-    securityInfo: null,</span>
<a href="#l25.145"></a><span id="l25.145" class="difflineminus">-</span>
<a href="#l25.146"></a><span id="l25.146" class="difflineminus">-    open: NYI,</span>
<a href="#l25.147"></a><span id="l25.147" class="difflineminus">-    asyncOpen: NYI,</span>
<a href="#l25.148"></a><span id="l25.148" class="difflineminus">-</span>
<a href="#l25.149"></a><span id="l25.149" class="difflineminus">-    asyncOpen: function asyncOpen(observer, ctxt) {</span>
<a href="#l25.150"></a><span id="l25.150" class="difflineminus">-        observer.onStartRequest(this, ctxt);</span>
<a href="#l25.151"></a><span id="l25.151" class="difflineminus">-    },</span>
<a href="#l25.152"></a><span id="l25.152" class="difflineminus">-</span>
<a href="#l25.153"></a><span id="l25.153" class="difflineminus">-    asyncRead: function asyncRead(listener, ctxt) {</span>
<a href="#l25.154"></a><span id="l25.154" class="difflineminus">-        return listener.onStartRequest(this, ctxt);</span>
<a href="#l25.155"></a><span id="l25.155" class="difflineminus">-    },</span>
<a href="#l25.156"></a><span id="l25.156" class="difflineminus">-</span>
<a href="#l25.157"></a><span id="l25.157" class="difflineminus">-    /* nsIRequest */</span>
<a href="#l25.158"></a><span id="l25.158" class="difflineminus">-    isPending: function() true,</span>
<a href="#l25.159"></a><span id="l25.159" class="difflineminus">-    status: Components.results.NS_OK,</span>
<a href="#l25.160"></a><span id="l25.160" class="difflineminus">-</span>
<a href="#l25.161"></a><span id="l25.161" class="difflineminus">-    cancel: function cancel(aStatus) {</span>
<a href="#l25.162"></a><span id="l25.162" class="difflineminus">-        this.status = aStatus;</span>
<a href="#l25.163"></a><span id="l25.163" class="difflineminus">-    },</span>
<a href="#l25.164"></a><span id="l25.164" class="difflineminus">-</span>
<a href="#l25.165"></a><span id="l25.165" class="difflineminus">-    suspend: NYI,</span>
<a href="#l25.166"></a><span id="l25.166" class="difflineminus">-    resume: NYI</span>
<a href="#l25.167"></a><span id="l25.167" class="difflineminus">-};</span>
<a href="#l25.168"></a><span id="l25.168" class="difflineminus">-</span>
<a href="#l25.169"></a><span id="l25.169" class="difflineminus">-var components = [CLineService, ICALContentHandler, BogusChannel];</span>
<a href="#l25.170"></a><span id="l25.170" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory(components);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1">deleted file mode 100644</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineminus">--- a/calendar/resources/content/calendarService.manifest</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineplus">+++ /dev/null</span>
<a href="#l26.4"></a><span id="l26.4" class="difflineat">@@ -1,9 +0,0 @@</span>
<a href="#l26.5"></a><span id="l26.5" class="difflineminus">-component {65ef4b0b-d116-4b93-bf8a-84525992bf27} calendarService.js</span>
<a href="#l26.6"></a><span id="l26.6" class="difflineminus">-contract @mozilla.org/commandlinehandler/general-startup;1?type=calendar {65ef4b0b-d116-4b93-bf8a-84525992bf27}</span>
<a href="#l26.7"></a><span id="l26.7" class="difflineminus">-category command-line-handler x-default @mozilla.org/commandlinehandler/general-startup;1?type=calendar</span>
<a href="#l26.8"></a><span id="l26.8" class="difflineminus">-</span>
<a href="#l26.9"></a><span id="l26.9" class="difflineminus">-component {9ebf4c8a-7770-40a6-aeed-e1738129535a} calendarService.js</span>
<a href="#l26.10"></a><span id="l26.10" class="difflineminus">-contract @mozilla.org/uriloader/content-handler;1?type=text/calendar {9ebf4c8a-7770-40a6-aeed-e1738129535a}</span>
<a href="#l26.11"></a><span id="l26.11" class="difflineminus">-</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-component {1e36ef5d-92d9-488f-ada6-9f15a1b57acf} calendarService.js</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineminus">-contract @mozilla.org/calendar/webcal-channel;1 {1e36ef5d-92d9-488f-ada6-9f15a1b57acf}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/resources/jar.mn</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/resources/jar.mn</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -1,16 +1,15 @@</span>
<a href="#l27.4"></a><span id="l27.4"> #filter substitution</span>
<a href="#l27.5"></a><span id="l27.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l27.6"></a><span id="l27.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l27.7"></a><span id="l27.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l27.8"></a><span id="l27.8"> </span>
<a href="#l27.9"></a><span id="l27.9"> calendar.jar:</span>
<a href="#l27.10"></a><span id="l27.10"> % content calendar %content/calendar/</span>
<a href="#l27.11"></a><span id="l27.11" class="difflineminus">-    content/calendar/calendar.js                           (content/calendar.js)</span>
<a href="#l27.12"></a><span id="l27.12">     content/calendar/calendarCreation.xul                  (content/calendarCreation.xul)</span>
<a href="#l27.13"></a><span id="l27.13">     content/calendar/calendarCreation.js                   (content/calendarCreation.js)</span>
<a href="#l27.14"></a><span id="l27.14">     content/calendar/publish.js                            (content/publish.js)</span>
<a href="#l27.15"></a><span id="l27.15">     content/calendar/publishDialog.js                      (content/publishDialog.js)    </span>
<a href="#l27.16"></a><span id="l27.16">     content/calendar/publishDialog.xul                     (content/publishDialog.xul)</span>
<a href="#l27.17"></a><span id="l27.17">     content/calendar/mouseoverPreviews.js                  (content/mouseoverPreviews.js)</span>
<a href="#l27.18"></a><span id="l27.18">     content/calendar/sound.wav                             (content/sound.wav)</span>
<a href="#l27.19"></a><span id="l27.19">     content/calendar/datetimepickers/datetimepickers.css   (content/datetimepickers/datetimepickers.css)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/resources/moz.build</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/resources/moz.build</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1,11 +1,6 @@</span>
<a href="#l28.4"></a><span id="l28.4"> # vim: set filetype=python:</span>
<a href="#l28.5"></a><span id="l28.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l28.6"></a><span id="l28.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l28.7"></a><span id="l28.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l28.8"></a><span id="l28.8"> </span>
<a href="#l28.9"></a><span id="l28.9" class="difflineminus">-EXTRA_COMPONENTS += [</span>
<a href="#l28.10"></a><span id="l28.10" class="difflineminus">-    'content/calendarService.js',</span>
<a href="#l28.11"></a><span id="l28.11" class="difflineminus">-    'content/calendarService.manifest',</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-]</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineminus">-</span>
<a href="#l28.14"></a><span id="l28.14"> JAR_MANIFESTS += ['jar.mn']</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/timezones/install.rdf</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/timezones/install.rdf</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -10,25 +10,16 @@</span>
<a href="#l29.4"></a><span id="l29.4">   &lt;Description about=&quot;urn:mozilla:install-manifest&quot;&gt;</span>
<a href="#l29.5"></a><span id="l29.5">     &lt;em:id&gt;calendar-timezones@mozilla.org&lt;/em:id&gt;</span>
<a href="#l29.6"></a><span id="l29.6">     &lt;em:version&gt;@TIMEZONES_VERSION@&lt;/em:version&gt;</span>
<a href="#l29.7"></a><span id="l29.7"> </span>
<a href="#l29.8"></a><span id="l29.8">     &lt;!-- Target Application this extension can install into,</span>
<a href="#l29.9"></a><span id="l29.9">          with minimum and maximum supported versions. --&gt;</span>
<a href="#l29.10"></a><span id="l29.10">     &lt;em:targetApplication&gt;</span>
<a href="#l29.11"></a><span id="l29.11">       &lt;Description&gt;</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-        &lt;!-- Sunbird; we define an upper limit, because we come</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineminus">-             with a top-notch calendar-timezones.xpi on every release --&gt;</span>
<a href="#l29.14"></a><span id="l29.14" class="difflineminus">-        &lt;em:id&gt;{718e30fb-e89b-41dd-9da7-e25a45638b28}&lt;/em:id&gt;</span>
<a href="#l29.15"></a><span id="l29.15" class="difflineminus">-        &lt;em:minVersion&gt;0.9&lt;/em:minVersion&gt;</span>
<a href="#l29.16"></a><span id="l29.16" class="difflineminus">-        &lt;em:maxVersion&gt;@CALENDAR_VERSION@&lt;/em:maxVersion&gt;</span>
<a href="#l29.17"></a><span id="l29.17" class="difflineminus">-      &lt;/Description&gt;</span>
<a href="#l29.18"></a><span id="l29.18" class="difflineminus">-    &lt;/em:targetApplication&gt;</span>
<a href="#l29.19"></a><span id="l29.19" class="difflineminus">-    &lt;em:targetApplication&gt;</span>
<a href="#l29.20"></a><span id="l29.20" class="difflineminus">-      &lt;Description&gt;</span>
<a href="#l29.21"></a><span id="l29.21">         &lt;!-- Thunderbird --&gt;</span>
<a href="#l29.22"></a><span id="l29.22">         &lt;em:id&gt;{3550f703-e582-4d05-9a08-453d09bdfdc6}&lt;/em:id&gt;</span>
<a href="#l29.23"></a><span id="l29.23">         &lt;em:minVersion&gt;2.0&lt;/em:minVersion&gt;</span>
<a href="#l29.24"></a><span id="l29.24">         &lt;em:maxVersion&gt;@THUNDERBIRD_VERSION@&lt;/em:maxVersion&gt;</span>
<a href="#l29.25"></a><span id="l29.25">       &lt;/Description&gt;</span>
<a href="#l29.26"></a><span id="l29.26">     &lt;/em:targetApplication&gt;</span>
<a href="#l29.27"></a><span id="l29.27">     &lt;em:targetApplication&gt;</span>
<a href="#l29.28"></a><span id="l29.28">       &lt;Description&gt;</span>
<a href="#l29.29"></a><span id="l29.29" class="difflineat">@@ -36,16 +27,16 @@</span>
<a href="#l29.30"></a><span id="l29.30">         &lt;em:id&gt;{92650c4d-4b8e-4d2a-b7eb-24ecf4f6b63a}&lt;/em:id&gt;</span>
<a href="#l29.31"></a><span id="l29.31">         &lt;em:minVersion&gt;2.0&lt;/em:minVersion&gt;</span>
<a href="#l29.32"></a><span id="l29.32">         &lt;em:maxVersion&gt;@SEAMONKEY_VERSION@&lt;/em:maxVersion&gt;</span>
<a href="#l29.33"></a><span id="l29.33">        &lt;/Description&gt;</span>
<a href="#l29.34"></a><span id="l29.34">      &lt;/em:targetApplication&gt;</span>
<a href="#l29.35"></a><span id="l29.35"> </span>
<a href="#l29.36"></a><span id="l29.36">     &lt;em:name&gt;Timezone Definitions for Mozilla Calendar&lt;/em:name&gt;</span>
<a href="#l29.37"></a><span id="l29.37">     &lt;em:unpack&gt;true&lt;/em:unpack&gt;</span>
<a href="#l29.38"></a><span id="l29.38" class="difflineminus">-    &lt;em:description&gt;Timezone definitions required by Sunbird and Lightning&lt;/em:description&gt;</span>
<a href="#l29.39"></a><span id="l29.39" class="difflineplus">+    &lt;em:description&gt;Timezone definitions required by Lightning&lt;/em:description&gt;</span>
<a href="#l29.40"></a><span id="l29.40">     &lt;em:creator&gt;Mozilla Calendar Project&lt;/em:creator&gt;</span>
<a href="#l29.41"></a><span id="l29.41">     &lt;em:iconURL&gt;chrome://calendar-timezones/skin/addon-icon32.png&lt;/em:iconURL&gt;</span>
<a href="#l29.42"></a><span id="l29.42"> #if 0</span>
<a href="#l29.43"></a><span id="l29.43">     &lt;em:homepageURL&gt;https://addons.mozilla.org/en-US/thunderbird/addon/xxx todo&lt;/em:homepageURL&gt;</span>
<a href="#l29.44"></a><span id="l29.44"> #endif</span>
<a href="#l29.45"></a><span id="l29.45">   &lt;/Description&gt;</span>
<a href="#l29.46"></a><span id="l29.46"> &lt;/RDF&gt;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

