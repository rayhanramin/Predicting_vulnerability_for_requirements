<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 20071:3d474ac6379c7c7278e3d41fb40437d95b9f7470</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 3d474ac6379c7c7278e3d41fb40437d95b9f7470" />
<meta property="og:url" content="/comm-central/rev/3d474ac6379c7c7278e3d41fb40437d95b9f7470" />
<meta property="og:description" content="Bug 1280898 - Set up eslint for calendar files - enable quotes rule. r=MakeMyDay" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 3d474ac6379c7c7278e3d41fb40437d95b9f7470 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/3d474ac6379c7c7278e3d41fb40437d95b9f7470">shortlog</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/3d474ac6379c7c7278e3d41fb40437d95b9f7470">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470">files</a> |
changeset |
<a href="/comm-central/raw-rev/3d474ac6379c7c7278e3d41fb40437d95b9f7470">raw</a>  | <a href="/comm-central/archive/3d474ac6379c7c7278e3d41fb40437d95b9f7470.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable quotes rule. r=MakeMyDay
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#101;&#115;&#108;&#105;&#110;&#116;&#32;&#60;&#101;&#115;&#108;&#105;&#110;&#116;&#64;&#98;&#117;&#103;&#122;&#105;&#108;&#108;&#97;&#46;&#107;&#101;&#119;&#105;&#115;&#46;&#99;&#104;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 08 Jul 2016 14:05:19 +0200</td></tr>

<tr>
 <td>changeset 20071</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/3d474ac6379c7c7278e3d41fb40437d95b9f7470">3d474ac6379c7c7278e3d41fb40437d95b9f7470</a></td>
</tr>



<tr>
<td>parent 20070</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/9bb63b34413f5bb8e13d909962b80a5181866d6b">9bb63b34413f5bb8e13d909962b80a5181866d6b</a>
</td>
</tr>

<tr>
<td>child 20072</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/ff506e40c3a28846acd5313c8c93fe45bf30db8f">ff506e40c3a28846acd5313c8c93fe45bf30db8f</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=3d474ac6379c7c7278e3d41fb40437d95b9f7470">12308</a></td></tr>
<tr><td>push user</td><td>mozilla@kewis.ch</td></tr>
<tr><td>push date</td><td class="date age">Sat, 17 Sep 2016 23:23:00 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@3795d24fc794 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=3795d24fc794dfd470961e3425aa3e056e2cd1e4">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=3795d24fc794dfd470961e3425aa3e056e2cd1e4&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=3795d24fc794dfd470961e3425aa3e056e2cd1e4&newProject=comm-central&newRevision=3d474ac6379c7c7278e3d41fb40437d95b9f7470&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=3795d24fc794dfd470961e3425aa3e056e2cd1e4&newProject=comm-central&newRevision=3d474ac6379c7c7278e3d41fb40437d95b9f7470&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=3795d24fc794dfd470961e3425aa3e056e2cd1e4&newProject=comm-central&newRevision=3d474ac6379c7c7278e3d41fb40437d95b9f7470&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28MakeMyDay%29&revcount=50">MakeMyDay</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">1280898</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable quotes rule. r=MakeMyDay

MozReview-Commit-ID: HCcoCsa0u71</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/.eslintrc">calendar/.eslintrc</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/.eslintrc">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/.eslintrc">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/.eslintrc">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/.eslintrc">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/.eslintrc">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calICSService.js">calendar/base/backend/icaljs/calICSService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calICSService.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calICSService.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calICSService.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calICSService.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calICSService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calRecurrenceRule.js">calendar/base/backend/icaljs/calRecurrenceRule.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calRecurrenceRule.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calRecurrenceRule.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calRecurrenceRule.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calRecurrenceRule.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/backend/icaljs/calRecurrenceRule.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.js">calendar/base/content/agenda-listbox.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.xml">calendar/base/content/agenda-listbox.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/agenda-listbox.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-base-view.xml">calendar/base/content/calendar-base-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-base-view.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-base-view.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-base-view.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-base-view.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-base-view.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-chrome-startup.js">calendar/base/content/calendar-chrome-startup.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-chrome-startup.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-chrome-startup.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-chrome-startup.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-chrome-startup.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-chrome-startup.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-clipboard.js">calendar/base/content/calendar-clipboard.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-clipboard.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-clipboard.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-clipboard.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-clipboard.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-clipboard.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-common-sets.js">calendar/base/content/calendar-common-sets.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-common-sets.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-common-sets.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-common-sets.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-common-sets.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-common-sets.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-daypicker.xml">calendar/base/content/calendar-daypicker.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-daypicker.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-daypicker.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-daypicker.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-daypicker.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-daypicker.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-invitations-manager.js">calendar/base/content/calendar-invitations-manager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-invitations-manager.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-invitations-manager.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-invitations-manager.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-invitations-manager.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-invitations-manager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-item-editing.js">calendar/base/content/calendar-item-editing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-item-editing.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-item-editing.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-item-editing.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-item-editing.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-item-editing.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-month-view.xml">calendar/base/content/calendar-month-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-month-view.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-month-view.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-month-view.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-month-view.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-month-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-multiday-view.xml">calendar/base/content/calendar-multiday-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-multiday-view.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-multiday-view.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-multiday-view.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-multiday-view.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-multiday-view.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-editing.js">calendar/base/content/calendar-task-editing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-editing.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-editing.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-editing.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-editing.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-editing.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.js">calendar/base/content/calendar-task-tree.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.xml">calendar/base/content/calendar-task-tree.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-tree.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-view.js">calendar/base/content/calendar-task-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-view.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-view.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-view.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-view.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-task-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-unifinder.js">calendar/base/content/calendar-unifinder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-unifinder.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-unifinder.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-unifinder.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-unifinder.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-unifinder.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-view-core.xml">calendar/base/content/calendar-view-core.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-view-core.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-view-core.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-view-core.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-view-core.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-view-core.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-views.js">calendar/base/content/calendar-views.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-views.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-views.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-views.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-views.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/calendar-views.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-dialog-utils.js">calendar/base/content/dialogs/calendar-dialog-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-dialog-utils.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-dialog-utils.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-dialog-utils.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-dialog-utils.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-dialog-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">calendar/base/content/dialogs/calendar-event-dialog-attendees.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-print-dialog.js">calendar/base/content/dialogs/calendar-print-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-print-dialog.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-print-dialog.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-print-dialog.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-print-dialog.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-print-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-properties-dialog.js">calendar/base/content/dialogs/calendar-properties-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-properties-dialog.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-properties-dialog.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-properties-dialog.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-properties-dialog.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/dialogs/calendar-properties-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/import-export.js">calendar/base/content/import-export.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/import-export.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/import-export.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/import-export.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/import-export.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/import-export.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/preferences/editCategory.js">calendar/base/content/preferences/editCategory.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/preferences/editCategory.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/preferences/editCategory.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/preferences/editCategory.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/preferences/editCategory.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/preferences/editCategory.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/today-pane.js">calendar/base/content/today-pane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/today-pane.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/today-pane.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/today-pane.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/today-pane.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/today-pane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-alarm-widget.xml">calendar/base/content/widgets/calendar-alarm-widget.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-alarm-widget.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-alarm-widget.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-alarm-widget.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-alarm-widget.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-alarm-widget.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-list-tree.xml">calendar/base/content/widgets/calendar-list-tree.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-list-tree.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-list-tree.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-list-tree.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-list-tree.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/calendar-list-tree.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/minimonth.xml">calendar/base/content/widgets/minimonth.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/minimonth.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/minimonth.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/minimonth.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/minimonth.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/content/widgets/minimonth.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calPrintUtils.jsm">calendar/base/modules/calPrintUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calPrintUtils.jsm">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calPrintUtils.jsm">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calPrintUtils.jsm">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calPrintUtils.jsm">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calPrintUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calRecurrenceUtils.jsm">calendar/base/modules/calRecurrenceUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calRecurrenceUtils.jsm">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calRecurrenceUtils.jsm">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calRecurrenceUtils.jsm">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calRecurrenceUtils.jsm">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calRecurrenceUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calUtils.jsm">calendar/base/modules/calUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calUtils.jsm">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calUtils.jsm">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calUtils.jsm">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calUtils.jsm">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calXMLUtils.jsm">calendar/base/modules/calXMLUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calXMLUtils.jsm">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calXMLUtils.jsm">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calXMLUtils.jsm">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calXMLUtils.jsm">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/modules/calXMLUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calCalendarManager.js">calendar/base/src/calCalendarManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calCalendarManager.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calCalendarManager.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calCalendarManager.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calCalendarManager.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calCalendarManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsParser.js">calendar/base/src/calIcsParser.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsParser.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsParser.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsParser.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsParser.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsParser.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsSerializer.js">calendar/base/src/calIcsSerializer.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsSerializer.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsSerializer.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsSerializer.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsSerializer.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calIcsSerializer.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTimezoneService.js">calendar/base/src/calTimezoneService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTimezoneService.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTimezoneService.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTimezoneService.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTimezoneService.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTimezoneService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTransactionManager.js">calendar/base/src/calTransactionManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTransactionManager.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTransactionManager.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTransactionManager.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTransactionManager.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calTransactionManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calUtils.js">calendar/base/src/calUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calUtils.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calUtils.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calUtils.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calUtils.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/base/src/calUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calHtmlExport.js">calendar/import-export/calHtmlExport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calHtmlExport.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calHtmlExport.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calHtmlExport.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calHtmlExport.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calHtmlExport.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calIcsImportExport.js">calendar/import-export/calIcsImportExport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calIcsImportExport.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calIcsImportExport.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calIcsImportExport.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calIcsImportExport.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calIcsImportExport.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calMonthGridPrinter.js">calendar/import-export/calMonthGridPrinter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calMonthGridPrinter.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calMonthGridPrinter.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calMonthGridPrinter.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calMonthGridPrinter.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calMonthGridPrinter.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calOutlookCSVImportExport.js">calendar/import-export/calOutlookCSVImportExport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calOutlookCSVImportExport.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calOutlookCSVImportExport.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calOutlookCSVImportExport.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calOutlookCSVImportExport.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calOutlookCSVImportExport.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calWeekPrinter.js">calendar/import-export/calWeekPrinter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calWeekPrinter.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calWeekPrinter.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calWeekPrinter.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calWeekPrinter.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/import-export/calWeekPrinter.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/itip/calItipEmailTransport.js">calendar/itip/calItipEmailTransport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/itip/calItipEmailTransport.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/itip/calItipEmailTransport.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/itip/calItipEmailTransport.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/itip/calItipEmailTransport.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/itip/calItipEmailTransport.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/components/lightningTextCalendarConverter.js">calendar/lightning/components/lightningTextCalendarConverter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/components/lightningTextCalendarConverter.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/components/lightningTextCalendarConverter.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/components/lightningTextCalendarConverter.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/components/lightningTextCalendarConverter.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/components/lightningTextCalendarConverter.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/html-item-editing/react-code.js">calendar/lightning/content/html-item-editing/react-code.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/html-item-editing/react-code.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/html-item-editing/react-code.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/html-item-editing/react-code.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/html-item-editing/react-code.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/html-item-editing/react-code.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/imip-bar.js">calendar/lightning/content/imip-bar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/imip-bar.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/imip-bar.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/imip-bar.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/imip-bar.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/imip-bar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/lightning-item-iframe.js">calendar/lightning/content/lightning-item-iframe.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/lightning-item-iframe.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/lightning-item-iframe.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/lightning-item-iframe.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/lightning-item-iframe.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/lightning-item-iframe.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/messenger-overlay-sidebar.js">calendar/lightning/content/messenger-overlay-sidebar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/messenger-overlay-sidebar.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/messenger-overlay-sidebar.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/messenger-overlay-sidebar.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/messenger-overlay-sidebar.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/content/messenger-overlay-sidebar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/modules/ltnInvitationUtils.jsm">calendar/lightning/modules/ltnInvitationUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/modules/ltnInvitationUtils.jsm">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/modules/ltnInvitationUtils.jsm">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/modules/ltnInvitationUtils.jsm">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/modules/ltnInvitationUtils.jsm">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/lightning/modules/ltnInvitationUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavCalendar.js">calendar/providers/caldav/calDavCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavCalendar.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavCalendar.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavCalendar.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavCalendar.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavRequestHandlers.js">calendar/providers/caldav/calDavRequestHandlers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavRequestHandlers.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavRequestHandlers.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavRequestHandlers.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavRequestHandlers.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/caldav/calDavRequestHandlers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/ics/calICSCalendar.js">calendar/providers/ics/calICSCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/ics/calICSCalendar.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/ics/calICSCalendar.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/ics/calICSCalendar.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/ics/calICSCalendar.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/ics/calICSCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageHelpers.jsm">calendar/providers/storage/calStorageHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageHelpers.jsm">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageHelpers.jsm">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageUpgrade.jsm">calendar/providers/storage/calStorageUpgrade.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageUpgrade.jsm">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageUpgrade.jsm">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageUpgrade.jsm">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageUpgrade.jsm">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/storage/calStorageUpgrade.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/wcap/calWcapSession.js">calendar/providers/wcap/calWcapSession.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/wcap/calWcapSession.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/wcap/calWcapSession.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/wcap/calWcapSession.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/wcap/calWcapSession.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/providers/wcap/calWcapSession.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/calendarCreation.js">calendar/resources/content/calendarCreation.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/calendarCreation.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/calendarCreation.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/calendarCreation.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/calendarCreation.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/calendarCreation.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/datetimepickers/datetimepickers.xml">calendar/resources/content/datetimepickers/datetimepickers.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/datetimepickers/datetimepickers.xml">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/datetimepickers/datetimepickers.xml">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/datetimepickers/datetimepickers.xml">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/datetimepickers/datetimepickers.xml">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/datetimepickers/datetimepickers.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/mouseoverPreviews.js">calendar/resources/content/mouseoverPreviews.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/mouseoverPreviews.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/mouseoverPreviews.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/mouseoverPreviews.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/mouseoverPreviews.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/mouseoverPreviews.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/publish.js">calendar/resources/content/publish.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/publish.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/publish.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/publish.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/publish.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/resources/content/publish.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialog.js">calendar/test/mozmill/eventDialog/testEventDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialog.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialog.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialog.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialog.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/calendar-utils.js">calendar/test/mozmill/shared-modules/calendar-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/calendar-utils.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/calendar-utils.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/calendar-utils.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/calendar-utils.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/calendar-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/timezone-utils.js">calendar/test/mozmill/shared-modules/timezone-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/timezone-utils.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/timezone-utils.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/timezone-utils.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/timezone-utils.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/shared-modules/timezone-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testBasicFunctionality.js">calendar/test/mozmill/testBasicFunctionality.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testBasicFunctionality.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testBasicFunctionality.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testBasicFunctionality.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testBasicFunctionality.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testBasicFunctionality.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testLocalICS.js">calendar/test/mozmill/testLocalICS.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testLocalICS.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testLocalICS.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testLocalICS.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testLocalICS.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testLocalICS.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testTodayPane.js">calendar/test/mozmill/testTodayPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testTodayPane.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testTodayPane.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testTodayPane.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testTodayPane.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/testTodayPane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testDayView.js">calendar/test/mozmill/views/testDayView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testDayView.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testDayView.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testDayView.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testDayView.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testDayView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMonthView.js">calendar/test/mozmill/views/testMonthView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMonthView.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMonthView.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMonthView.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMonthView.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMonthView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMultiweekView.js">calendar/test/mozmill/views/testMultiweekView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMultiweekView.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMultiweekView.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMultiweekView.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMultiweekView.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testMultiweekView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testTaskView.js">calendar/test/mozmill/views/testTaskView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testTaskView.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testTaskView.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testTaskView.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testTaskView.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testTaskView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testWeekView.js">calendar/test/mozmill/views/testWeekView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testWeekView.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testWeekView.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testWeekView.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testWeekView.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/mozmill/views/testWeekView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/head_consts.js">calendar/test/unit/head_consts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/head_consts.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/head_consts.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/head_consts.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/head_consts.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/head_consts.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_attendee.js">calendar/test/unit/test_attendee.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_attendee.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_attendee.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_attendee.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_attendee.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_attendee.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1204255.js">calendar/test/unit/test_bug1204255.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1204255.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1204255.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1204255.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1204255.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1204255.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1209399.js">calendar/test/unit/test_bug1209399.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1209399.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1209399.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1209399.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1209399.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_bug1209399.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_calutils.js">calendar/test/unit/test_calutils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_calutils.js">file</a> |
<a href="/comm-central/annotate/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_calutils.js">annotate</a> |
<a href="/comm-central/diff/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_calutils.js">diff</a> |
<a href="/comm-central/comparison/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_calutils.js">comparison</a> |
<a href="/comm-central/log/3d474ac6379c7c7278e3d41fb40437d95b9f7470/calendar/test/unit/test_calutils.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/.eslintrc</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/.eslintrc</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -355,16 +355,19 @@</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5">     // Operators always before the line break</span>
<a href="#l1.6"></a><span id="l1.6">     &quot;operator-linebreak&quot;: [2, &quot;after&quot;, { &quot;overrides&quot;: { &quot;:&quot;: &quot;before&quot;, &quot;?&quot;: &quot;ignore&quot;}}],</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8">     // Restricts the use of parentheses to only where they are necessary</span>
<a href="#l1.9"></a><span id="l1.9">     // Disabled for now since this also removes parens around assignments, e.g. let foo = bar == baz</span>
<a href="#l1.10"></a><span id="l1.10">     // &quot;no-extra-parens&quot;: [2, &quot;all&quot;, { &quot;conditionalAssign&quot;: false, &quot;returnAssign&quot;: false, &quot;nestedBinaryExpressions&quot;: false }],</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+    // Double quotes should be used.</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    &quot;quotes&quot;: [2, &quot;double&quot;, { &quot;avoidEscape&quot;: true }],</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+</span>
<a href="#l1.15"></a><span id="l1.15">     // Will enable these rules later</span>
<a href="#l1.16"></a><span id="l1.16">     &quot;block-spacing&quot;: 0,</span>
<a href="#l1.17"></a><span id="l1.17">     &quot;no-lonely-if&quot;: 0,</span>
<a href="#l1.18"></a><span id="l1.18">     &quot;computed-property-spacing&quot;: 0,</span>
<a href="#l1.19"></a><span id="l1.19"> </span>
<a href="#l1.20"></a><span id="l1.20">     // The following rules will not be enabled currently, but are kept here for</span>
<a href="#l1.21"></a><span id="l1.21">     // easier updates in the future.</span>
<a href="#l1.22"></a><span id="l1.22">     &quot;no-else-return&quot;: 0,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calICSService.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calICSService.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -157,17 +157,17 @@ calIcalProperty.prototype = {</span>
<a href="#l2.4"></a><span id="l2.4">     removeParameter: function(n) {</span>
<a href="#l2.5"></a><span id="l2.5">         // Again, VALUE needs special handling. Removing the value parameter is</span>
<a href="#l2.6"></a><span id="l2.6">         // kind of like resetting it to the default type. So find out the</span>
<a href="#l2.7"></a><span id="l2.7">         // default type and then set the value parameter to it.</span>
<a href="#l2.8"></a><span id="l2.8">         if (n == &quot;VALUE&quot;) {</span>
<a href="#l2.9"></a><span id="l2.9">             let propname = this.innerObject.name.toLowerCase();</span>
<a href="#l2.10"></a><span id="l2.10">             if (propname in ICAL.design.icalendar.property) {</span>
<a href="#l2.11"></a><span id="l2.11">                 let details = ICAL.design.icalendar.property[propname];</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-                if ('defaultType' in details) {</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+                if (&quot;defaultType&quot; in details) {</span>
<a href="#l2.14"></a><span id="l2.14">                     this.setParameter(&quot;VALUE&quot;, details.defaultType);</span>
<a href="#l2.15"></a><span id="l2.15">                 }</span>
<a href="#l2.16"></a><span id="l2.16">             }</span>
<a href="#l2.17"></a><span id="l2.17">         } else {</span>
<a href="#l2.18"></a><span id="l2.18">             this.innerObject.removeParameter(n.toLowerCase());</span>
<a href="#l2.19"></a><span id="l2.19">         }</span>
<a href="#l2.20"></a><span id="l2.20">     },</span>
<a href="#l2.21"></a><span id="l2.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calRecurrenceRule.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calRecurrenceRule.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -156,17 +156,17 @@ calRecurrenceRule.prototype = {</span>
<a href="#l3.4"></a><span id="l3.4">                     cal.ERROR(&quot;Malformed BYDAY rule\n&quot; + cal.STACK(10));</span>
<a href="#l3.5"></a><span id="l3.5">                     return [];</span>
<a href="#l3.6"></a><span id="l3.6">                 }</span>
<a href="#l3.7"></a><span id="l3.7">                 values[i] = ICAL.Recur.icalDayToNumericDay(match[3]);</span>
<a href="#l3.8"></a><span id="l3.8">                 if (match[2]) {</span>
<a href="#l3.9"></a><span id="l3.9">                     // match[2] is the week number for this value.</span>
<a href="#l3.10"></a><span id="l3.10">                     values[i] += 8 * match[2];</span>
<a href="#l3.11"></a><span id="l3.11">                 }</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-                if (match[1] == '-') {</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+                if (match[1] == &quot;-&quot;) {</span>
<a href="#l3.14"></a><span id="l3.14">                     // Week numbers are counted back from the end of the period.</span>
<a href="#l3.15"></a><span id="l3.15">                     values[i] *= -1;</span>
<a href="#l3.16"></a><span id="l3.16">                 }</span>
<a href="#l3.17"></a><span id="l3.17">             }</span>
<a href="#l3.18"></a><span id="l3.18">         }</span>
<a href="#l3.19"></a><span id="l3.19"> </span>
<a href="#l3.20"></a><span id="l3.20">         if (aCount) {</span>
<a href="#l3.21"></a><span id="l3.21">             aCount.value = values.length;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/agenda-listbox.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/agenda-listbox.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -186,20 +186,20 @@ function onBlur() {</span>
<a href="#l4.4"></a><span id="l4.4"> agendaListbox.onKeyPress =</span>
<a href="#l4.5"></a><span id="l4.5"> function onKeyPress(aEvent) {</span>
<a href="#l4.6"></a><span id="l4.6">     let listItem = aEvent.target;</span>
<a href="#l4.7"></a><span id="l4.7">     if (listItem.localName == &quot;richlistbox&quot;) {</span>
<a href="#l4.8"></a><span id="l4.8">         listItem = listItem.selectedItem;</span>
<a href="#l4.9"></a><span id="l4.9">     }</span>
<a href="#l4.10"></a><span id="l4.10">     switch (aEvent.keyCode) {</span>
<a href="#l4.11"></a><span id="l4.11">         case aEvent.DOM_VK_RETURN:</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-            document.getElementById('agenda_edit_event_command').doCommand();</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+            document.getElementById(&quot;agenda_edit_event_command&quot;).doCommand();</span>
<a href="#l4.14"></a><span id="l4.14">             break;</span>
<a href="#l4.15"></a><span id="l4.15">         case aEvent.DOM_VK_DELETE:</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">-            document.getElementById('agenda_delete_event_command').doCommand();</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+            document.getElementById(&quot;agenda_delete_event_command&quot;).doCommand();</span>
<a href="#l4.18"></a><span id="l4.18">             aEvent.stopPropagation();</span>
<a href="#l4.19"></a><span id="l4.19">             aEvent.preventDefault();</span>
<a href="#l4.20"></a><span id="l4.20">             break;</span>
<a href="#l4.21"></a><span id="l4.21">         case aEvent.DOM_VK_LEFT:</span>
<a href="#l4.22"></a><span id="l4.22">             if (!this.isEventListItem(listItem)) {</span>
<a href="#l4.23"></a><span id="l4.23">                 listItem.getCheckbox().setChecked(false);</span>
<a href="#l4.24"></a><span id="l4.24">             }</span>
<a href="#l4.25"></a><span id="l4.25">             break;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/agenda-listbox.xml</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/agenda-listbox.xml</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -20,17 +20,17 @@</span>
<a href="#l5.4"></a><span id="l5.4">       &lt;/property&gt;</span>
<a href="#l5.5"></a><span id="l5.5">     &lt;/implementation&gt;</span>
<a href="#l5.6"></a><span id="l5.6">     &lt;handlers&gt;</span>
<a href="#l5.7"></a><span id="l5.7">       &lt;handler event=&quot;click&quot; phase=&quot;capturing&quot;&gt;&lt;![CDATA[</span>
<a href="#l5.8"></a><span id="l5.8">         if (event.detail == 1) {</span>
<a href="#l5.9"></a><span id="l5.9">             agendaListbox.onSelect(this);</span>
<a href="#l5.10"></a><span id="l5.10">         } else if (event.button == 0) {</span>
<a href="#l5.11"></a><span id="l5.11">             // We only care about button 0 doubleclick events</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-            document.getElementById('agenda_edit_event_command').doCommand();</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+            document.getElementById(&quot;agenda_edit_event_command&quot;).doCommand();</span>
<a href="#l5.14"></a><span id="l5.14">             event.stopPropagation();</span>
<a href="#l5.15"></a><span id="l5.15">             event.preventDefault();</span>
<a href="#l5.16"></a><span id="l5.16">         }</span>
<a href="#l5.17"></a><span id="l5.17">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l5.18"></a><span id="l5.18">       &lt;handler event=&quot;mouseover&quot;&gt;&lt;![CDATA[</span>
<a href="#l5.19"></a><span id="l5.19">          event.stopPropagation();</span>
<a href="#l5.20"></a><span id="l5.20">          onMouseOverItem(event);</span>
<a href="#l5.21"></a><span id="l5.21">       ]]&gt;&lt;/handler&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/calendar-base-view.xml</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/calendar-base-view.xml</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -239,17 +239,17 @@</span>
<a href="#l6.4"></a><span id="l6.4">         this.tasksInView = (document.getElementById(kTasksInViewCommand)</span>
<a href="#l6.5"></a><span id="l6.5">                                 .getAttribute(&quot;checked&quot;) == &quot;true&quot;);</span>
<a href="#l6.6"></a><span id="l6.6">         this.rotated = (document.getElementById(kOrientation)</span>
<a href="#l6.7"></a><span id="l6.7">                                 .getAttribute(&quot;checked&quot;) == &quot;true&quot;);</span>
<a href="#l6.8"></a><span id="l6.8">         this.showCompleted = (document.getElementById(kShowCompleted)</span>
<a href="#l6.9"></a><span id="l6.9">                                 .getAttribute(&quot;checked&quot;) == &quot;true&quot;);</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11">         this.mTimezone = calendarDefaultTimezone();</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-        let alarmService = Components.classes['@mozilla.org/calendar/alarm-service;1']</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+        let alarmService = Components.classes[&quot;@mozilla.org/calendar/alarm-service;1&quot;]</span>
<a href="#l6.14"></a><span id="l6.14">                            .getService(Components.interfaces.calIAlarmService);</span>
<a href="#l6.15"></a><span id="l6.15">         alarmService.addObserver(this.mObserver);</span>
<a href="#l6.16"></a><span id="l6.16">         let self = this;</span>
<a href="#l6.17"></a><span id="l6.17">         this.setAttribute(&quot;type&quot;, this.type);</span>
<a href="#l6.18"></a><span id="l6.18">         this.mResizeHandler = function resizeHandler() {</span>
<a href="#l6.19"></a><span id="l6.19">             self.onResize(self);</span>
<a href="#l6.20"></a><span id="l6.20">         };</span>
<a href="#l6.21"></a><span id="l6.21">         this.viewBroadcaster.addEventListener(this.getAttribute(&quot;type&quot;) + &quot;viewresized&quot;, this.mResizeHandler, true);</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineat">@@ -263,17 +263,17 @@</span>
<a href="#l6.23"></a><span id="l6.23">       ]]&gt;&lt;/constructor&gt;</span>
<a href="#l6.24"></a><span id="l6.24"> </span>
<a href="#l6.25"></a><span id="l6.25">       &lt;destructor&gt;&lt;![CDATA[</span>
<a href="#l6.26"></a><span id="l6.26">         Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l6.27"></a><span id="l6.27"> </span>
<a href="#l6.28"></a><span id="l6.28">         if (this.mCalendar) {</span>
<a href="#l6.29"></a><span id="l6.29">             this.mCalendar.removeObserver(this.mObserver);</span>
<a href="#l6.30"></a><span id="l6.30">         }</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-        let alarmService = Components.classes['@mozilla.org/calendar/alarm-service;1']</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+        let alarmService = Components.classes[&quot;@mozilla.org/calendar/alarm-service;1&quot;]</span>
<a href="#l6.33"></a><span id="l6.33">                            .getService(Components.interfaces.calIAlarmService);</span>
<a href="#l6.34"></a><span id="l6.34">         alarmService.removeObserver(this.mObserver);</span>
<a href="#l6.35"></a><span id="l6.35">         this.viewBroadcaster.removeEventListener(this.getAttribute(&quot;type&quot;) + &quot;viewresized&quot;, this.mResizeHandler, true);</span>
<a href="#l6.36"></a><span id="l6.36">         Services.prefs.removeObserver(&quot;calendar.&quot;, this.mPrefObserver);</span>
<a href="#l6.37"></a><span id="l6.37">       ]]&gt;&lt;/destructor&gt;</span>
<a href="#l6.38"></a><span id="l6.38"> </span>
<a href="#l6.39"></a><span id="l6.39">       &lt;property name=&quot;type&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l6.40"></a><span id="l6.40">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineat">@@ -464,17 +464,17 @@</span>
<a href="#l6.42"></a><span id="l6.42">               onOperationComplete: function(aOpCalendar, aStatus, aOperationType, aId, aDateTime) {</span>
<a href="#l6.43"></a><span id="l6.43">                   this.calView.mLog.info(&quot;Refresh complete of calendar &quot; + this.calId);</span>
<a href="#l6.44"></a><span id="l6.44">                   if (this.calView.mPendingRefreshJobs.has(this.calId)) {</span>
<a href="#l6.45"></a><span id="l6.45">                       this.calView.mPendingRefreshJobs.delete(this.calId);</span>
<a href="#l6.46"></a><span id="l6.46">                   }</span>
<a href="#l6.47"></a><span id="l6.47"> </span>
<a href="#l6.48"></a><span id="l6.48">                   if (!this.cancelled) {</span>
<a href="#l6.49"></a><span id="l6.49">                       // Fire event</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-                      this.calView.fireEvent('viewloaded', aOperationType);</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+                      this.calView.fireEvent(&quot;viewloaded&quot;, aOperationType);</span>
<a href="#l6.52"></a><span id="l6.52">                   }</span>
<a href="#l6.53"></a><span id="l6.53">               },</span>
<a href="#l6.54"></a><span id="l6.54"> </span>
<a href="#l6.55"></a><span id="l6.55">               onGetResult: function(aOpCalendar, aStatus, aItemType, aDetail, aCount, aItems) {</span>
<a href="#l6.56"></a><span id="l6.56">                   if (this.cancelled || !Components.isSuccessCode(aStatus)) {</span>
<a href="#l6.57"></a><span id="l6.57">                       return;</span>
<a href="#l6.58"></a><span id="l6.58">                   }</span>
<a href="#l6.59"></a><span id="l6.59"> </span>
<a href="#l6.60"></a><span id="l6.60" class="difflineat">@@ -573,17 +573,17 @@</span>
<a href="#l6.61"></a><span id="l6.61">           return end;</span>
<a href="#l6.62"></a><span id="l6.62">         ]]&gt;&lt;/getter&gt;</span>
<a href="#l6.63"></a><span id="l6.63">       &lt;/property&gt;</span>
<a href="#l6.64"></a><span id="l6.64"> </span>
<a href="#l6.65"></a><span id="l6.65">       &lt;method name=&quot;fireEvent&quot;&gt;</span>
<a href="#l6.66"></a><span id="l6.66">         &lt;parameter name=&quot;aEventName&quot;/&gt;</span>
<a href="#l6.67"></a><span id="l6.67">         &lt;parameter name=&quot;aEventDetail&quot;/&gt;</span>
<a href="#l6.68"></a><span id="l6.68">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l6.69"></a><span id="l6.69" class="difflineminus">-          let event = document.createEvent('Events');</span>
<a href="#l6.70"></a><span id="l6.70" class="difflineplus">+          let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l6.71"></a><span id="l6.71">           event.initEvent(aEventName, true, false);</span>
<a href="#l6.72"></a><span id="l6.72">           event.detail = aEventDetail;</span>
<a href="#l6.73"></a><span id="l6.73">           this.dispatchEvent(event);</span>
<a href="#l6.74"></a><span id="l6.74">         ]]&gt;&lt;/body&gt;</span>
<a href="#l6.75"></a><span id="l6.75">       &lt;/method&gt;</span>
<a href="#l6.76"></a><span id="l6.76"> </span>
<a href="#l6.77"></a><span id="l6.77">       &lt;method name=&quot;removeDropShadows&quot;&gt;</span>
<a href="#l6.78"></a><span id="l6.78">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l6.79"></a><span id="l6.79" class="difflineat">@@ -775,17 +775,17 @@</span>
<a href="#l6.80"></a><span id="l6.80">                 break;</span>
<a href="#l6.81"></a><span id="l6.81">             case kKE.DOM_VK_PAGE_DOWN:</span>
<a href="#l6.82"></a><span id="l6.82">                 this.moveView(1);</span>
<a href="#l6.83"></a><span id="l6.83">                 break;</span>
<a href="#l6.84"></a><span id="l6.84">         }</span>
<a href="#l6.85"></a><span id="l6.85">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l6.86"></a><span id="l6.86">       &lt;handler event=&quot;wheel&quot;&gt;&lt;![CDATA[</span>
<a href="#l6.87"></a><span id="l6.87">         const pixelThreshold = 150;</span>
<a href="#l6.88"></a><span id="l6.88" class="difflineminus">-        if (event.shiftKey &amp;&amp; Preferences.get('calendar.view.mousescroll', true)) {</span>
<a href="#l6.89"></a><span id="l6.89" class="difflineplus">+        if (event.shiftKey &amp;&amp; Preferences.get(&quot;calendar.view.mousescroll&quot;, true)) {</span>
<a href="#l6.90"></a><span id="l6.90">             if (event.deltaMode == event.DOM_DELTA_LINE) {</span>
<a href="#l6.91"></a><span id="l6.91">                 if (event.deltaY != 0) {</span>
<a href="#l6.92"></a><span id="l6.92">                     deltaView = event.deltaY &lt; 0 ? -1 : 1;</span>
<a href="#l6.93"></a><span id="l6.93">                 }</span>
<a href="#l6.94"></a><span id="l6.94">             } else if (event.deltaMode == event.DOM_DELTA_PIXEL) {</span>
<a href="#l6.95"></a><span id="l6.95">                 this.mPixelScrollDelta += event.deltaY;</span>
<a href="#l6.96"></a><span id="l6.96">                 if (this.mPixelScrollDelta &gt; pixelThreshold) {</span>
<a href="#l6.97"></a><span id="l6.97">                     deltaView = 1;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/calendar-chrome-startup.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/calendar-chrome-startup.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -83,17 +83,17 @@ function commonFinishCalendar() {</span>
<a href="#l7.4"></a><span id="l7.4"> </span>
<a href="#l7.5"></a><span id="l7.5"> /**</span>
<a href="#l7.6"></a><span id="l7.6">  * Handler function to create |viewtype + &quot;viewresized&quot;| events that are</span>
<a href="#l7.7"></a><span id="l7.7">  * dispatched through the calendarviewBroadcaster.</span>
<a href="#l7.8"></a><span id="l7.8">  *</span>
<a href="#l7.9"></a><span id="l7.9">  * XXX this has nothing to do with startup, needs to go somewhere else.</span>
<a href="#l7.10"></a><span id="l7.10">  */</span>
<a href="#l7.11"></a><span id="l7.11"> function onCalendarViewResize(aEvent) {</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-    let event = document.createEvent('Events');</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+    let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l7.14"></a><span id="l7.14">     event.initEvent(currentView().type + &quot;viewresized&quot;, true, false);</span>
<a href="#l7.15"></a><span id="l7.15">     document.getElementById(&quot;calendarviewBroadcaster&quot;).dispatchEvent(event);</span>
<a href="#l7.16"></a><span id="l7.16"> }</span>
<a href="#l7.17"></a><span id="l7.17"> </span>
<a href="#l7.18"></a><span id="l7.18"> /**</span>
<a href="#l7.19"></a><span id="l7.19">  * TODO: The systemcolors pref observer really only needs to be set up once, so</span>
<a href="#l7.20"></a><span id="l7.20">  * ideally this code should go into a component. This should be taken care of when</span>
<a href="#l7.21"></a><span id="l7.21">  * there are more prefs that need to be observed on a global basis that don't fit</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/calendar-clipboard.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/calendar-clipboard.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -185,16 +185,16 @@ function pasteFromClipboard() {</span>
<a href="#l8.4"></a><span id="l8.4">             for (let item of items) {</span>
<a href="#l8.5"></a><span id="l8.5">                 let newItem = item.clone();</span>
<a href="#l8.6"></a><span id="l8.6">                 // Set new UID to allow multiple paste actions of the same</span>
<a href="#l8.7"></a><span id="l8.7">                 // clipboard content.</span>
<a href="#l8.8"></a><span id="l8.8">                 newItem.id = cal.getUUID();</span>
<a href="#l8.9"></a><span id="l8.9">                 if (offset) {</span>
<a href="#l8.10"></a><span id="l8.10">                     cal.shiftItem(newItem, offset);</span>
<a href="#l8.11"></a><span id="l8.11">                 }</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-                doTransaction('add', newItem, destCal, null, null);</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+                doTransaction(&quot;add&quot;, newItem, destCal, null, null);</span>
<a href="#l8.14"></a><span id="l8.14">             }</span>
<a href="#l8.15"></a><span id="l8.15">             endBatchTransaction();</span>
<a href="#l8.16"></a><span id="l8.16">             break;</span>
<a href="#l8.17"></a><span id="l8.17">         default:</span>
<a href="#l8.18"></a><span id="l8.18">             break;</span>
<a href="#l8.19"></a><span id="l8.19">     }</span>
<a href="#l8.20"></a><span id="l8.20"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/content/calendar-common-sets.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/content/calendar-common-sets.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -489,17 +489,17 @@ var calendarController = {</span>
<a href="#l9.4"></a><span id="l9.4"> </span>
<a href="#l9.5"></a><span id="l9.5">         calendarController.selected_events_requires_network =</span>
<a href="#l9.6"></a><span id="l9.6">               (selected_events_requires_network == selLength);</span>
<a href="#l9.7"></a><span id="l9.7">         calendarController.selected_events_invitation =</span>
<a href="#l9.8"></a><span id="l9.8">               (selected_events_invitation == selLength);</span>
<a href="#l9.9"></a><span id="l9.9"> </span>
<a href="#l9.10"></a><span id="l9.10">         calendarController.updateCommands();</span>
<a href="#l9.11"></a><span id="l9.11">         calendarController2.updateCommands();</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-        document.commandDispatcher.updateCommands('mail-toolbar');</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+        document.commandDispatcher.updateCommands(&quot;mail-toolbar&quot;);</span>
<a href="#l9.14"></a><span id="l9.14">     },</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16">     /**</span>
<a href="#l9.17"></a><span id="l9.17">      * Condition Helpers</span>
<a href="#l9.18"></a><span id="l9.18">      */</span>
<a href="#l9.19"></a><span id="l9.19"> </span>
<a href="#l9.20"></a><span id="l9.20">     // These attributes will be set up manually.</span>
<a href="#l9.21"></a><span id="l9.21">     item_selected: false,</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -679,20 +679,20 @@ var calendarController2 = {</span>
<a href="#l9.23"></a><span id="l9.23">             // Thunderbird Commands</span>
<a href="#l9.24"></a><span id="l9.24">             case &quot;cmd_cut&quot;:</span>
<a href="#l9.25"></a><span id="l9.25">                 return calendarController.selected_items_writable;</span>
<a href="#l9.26"></a><span id="l9.26">             case &quot;cmd_copy&quot;:</span>
<a href="#l9.27"></a><span id="l9.27">                 return calendarController.item_selected;</span>
<a href="#l9.28"></a><span id="l9.28">             case &quot;cmd_paste&quot;:</span>
<a href="#l9.29"></a><span id="l9.29">                 return canPaste();</span>
<a href="#l9.30"></a><span id="l9.30">             case &quot;cmd_undo&quot;:</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-                goSetMenuValue(aCommand, 'valueDefault');</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+                goSetMenuValue(aCommand, &quot;valueDefault&quot;);</span>
<a href="#l9.33"></a><span id="l9.33">                 return canUndo();</span>
<a href="#l9.34"></a><span id="l9.34">             case &quot;cmd_redo&quot;:</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineminus">-                goSetMenuValue(aCommand, 'valueDefault');</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+                goSetMenuValue(aCommand, &quot;valueDefault&quot;);</span>
<a href="#l9.37"></a><span id="l9.37">                 return canRedo();</span>
<a href="#l9.38"></a><span id="l9.38">             case &quot;button_delete&quot;:</span>
<a href="#l9.39"></a><span id="l9.39">             case &quot;cmd_delete&quot;:</span>
<a href="#l9.40"></a><span id="l9.40">                 return calendarController.isCommandEnabled(&quot;calendar_delete_focused_item_command&quot;);</span>
<a href="#l9.41"></a><span id="l9.41">             case &quot;cmd_fullZoomReduce&quot;:</span>
<a href="#l9.42"></a><span id="l9.42">             case &quot;cmd_fullZoomEnlarge&quot;:</span>
<a href="#l9.43"></a><span id="l9.43">             case &quot;cmd_fullZoomReset&quot;:</span>
<a href="#l9.44"></a><span id="l9.44">               return calendarController.isInMode(&quot;calendar&quot;) &amp;&amp;</span>
<a href="#l9.45"></a><span id="l9.45" class="difflineat">@@ -744,17 +744,17 @@ var calendarController2 = {</span>
<a href="#l9.46"></a><span id="l9.46">                 break;</span>
<a href="#l9.47"></a><span id="l9.47">             case &quot;cmd_fullZoomEnlarge&quot;:</span>
<a href="#l9.48"></a><span id="l9.48">                 currentView().zoomOut();</span>
<a href="#l9.49"></a><span id="l9.49">                 break;</span>
<a href="#l9.50"></a><span id="l9.50">             case &quot;cmd_fullZoomReset&quot;:</span>
<a href="#l9.51"></a><span id="l9.51">                 currentView().zoomReset();</span>
<a href="#l9.52"></a><span id="l9.52">                 break;</span>
<a href="#l9.53"></a><span id="l9.53">             case &quot;cmd_showQuickFilterBar&quot;:</span>
<a href="#l9.54"></a><span id="l9.54" class="difflineminus">-                document.getElementById('task-text-filter-field').select();</span>
<a href="#l9.55"></a><span id="l9.55" class="difflineplus">+                document.getElementById(&quot;task-text-filter-field&quot;).select();</span>
<a href="#l9.56"></a><span id="l9.56">                 break;</span>
<a href="#l9.57"></a><span id="l9.57"> </span>
<a href="#l9.58"></a><span id="l9.58">             case &quot;button_delete&quot;:</span>
<a href="#l9.59"></a><span id="l9.59">             case &quot;cmd_delete&quot;:</span>
<a href="#l9.60"></a><span id="l9.60">                 calendarController.doCommand(&quot;calendar_delete_focused_item_command&quot;);</span>
<a href="#l9.61"></a><span id="l9.61">                 break;</span>
<a href="#l9.62"></a><span id="l9.62">         }</span>
<a href="#l9.63"></a><span id="l9.63">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/content/calendar-daypicker.xml</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/content/calendar-daypicker.xml</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -27,18 +27,18 @@</span>
<a href="#l10.4"></a><span id="l10.4">       &lt;/xul:hbox&gt;</span>
<a href="#l10.5"></a><span id="l10.5">     &lt;/content&gt;</span>
<a href="#l10.6"></a><span id="l10.6">     &lt;implementation&gt;</span>
<a href="#l10.7"></a><span id="l10.7">       &lt;method name=&quot;onmodified&quot;&gt;</span>
<a href="#l10.8"></a><span id="l10.8">         &lt;parameter name=&quot;aEvent&quot;/&gt;</span>
<a href="#l10.9"></a><span id="l10.9">         &lt;body&gt;</span>
<a href="#l10.10"></a><span id="l10.10">           &lt;![CDATA[</span>
<a href="#l10.11"></a><span id="l10.11">             if (aEvent.attrName == &quot;checked&quot;) {</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-                let event = document.createEvent('Events');</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-                event.initEvent('select', true, true);</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+                let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+                event.initEvent(&quot;select&quot;, true, true);</span>
<a href="#l10.16"></a><span id="l10.16">                 this.calendar.dispatchEvent(event);</span>
<a href="#l10.17"></a><span id="l10.17">             }</span>
<a href="#l10.18"></a><span id="l10.18">           ]]&gt;</span>
<a href="#l10.19"></a><span id="l10.19">         &lt;/body&gt;</span>
<a href="#l10.20"></a><span id="l10.20">       &lt;/method&gt;</span>
<a href="#l10.21"></a><span id="l10.21">       &lt;constructor&gt;</span>
<a href="#l10.22"></a><span id="l10.22">         &lt;![CDATA[</span>
<a href="#l10.23"></a><span id="l10.23">           this.setAttribute(&quot;autoCheck&quot;, &quot;true&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/content/calendar-invitations-manager.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/content/calendar-invitations-manager.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -305,17 +305,17 @@ InvitationsManager.prototype = {</span>
<a href="#l11.4"></a><span id="l11.4">         };</span>
<a href="#l11.5"></a><span id="l11.5"> </span>
<a href="#l11.6"></a><span id="l11.6">         this.mJobsPending = 0;</span>
<a href="#l11.7"></a><span id="l11.7">         for (let i = 0; i &lt; queue.length; i++) {</span>
<a href="#l11.8"></a><span id="l11.8">             let job = queue[i];</span>
<a href="#l11.9"></a><span id="l11.9">             let oldItem = job.oldItem;</span>
<a href="#l11.10"></a><span id="l11.10">             let newItem = job.newItem;</span>
<a href="#l11.11"></a><span id="l11.11">             switch (job.action) {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-                case 'modify':</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+                case &quot;modify&quot;:</span>
<a href="#l11.14"></a><span id="l11.14">                     this.mJobsPending++;</span>
<a href="#l11.15"></a><span id="l11.15">                     newItem.calendar.modifyItem(newItem,</span>
<a href="#l11.16"></a><span id="l11.16">                                                 oldItem,</span>
<a href="#l11.17"></a><span id="l11.17">                                                 new operationListener(this, jobQueueFinishedCallBack, oldItem));</span>
<a href="#l11.18"></a><span id="l11.18">                     break;</span>
<a href="#l11.19"></a><span id="l11.19">                 default:</span>
<a href="#l11.20"></a><span id="l11.20">                     break;</span>
<a href="#l11.21"></a><span id="l11.21">             }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/content/calendar-item-editing.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/content/calendar-item-editing.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -226,20 +226,20 @@ function setDefaultItemValues(aItem, aCa</span>
<a href="#l12.4"></a><span id="l12.4">  * @param aForceAllDay  (optional) Make sure the event shown in the dialog is an</span>
<a href="#l12.5"></a><span id="l12.5">  *                                   allday event.</span>
<a href="#l12.6"></a><span id="l12.6">  */</span>
<a href="#l12.7"></a><span id="l12.7"> function createEventWithDialog(calendar, startDate, endDate, summary, event, aForceAllday) {</span>
<a href="#l12.8"></a><span id="l12.8">     let onNewEvent = function(item, opcalendar, originalItem, listener) {</span>
<a href="#l12.9"></a><span id="l12.9">         if (item.id) {</span>
<a href="#l12.10"></a><span id="l12.10">             // If the item already has an id, then this is the result of</span>
<a href="#l12.11"></a><span id="l12.11">             // saving the item without closing, and then saving again.</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-            doTransaction('modify', item, opcalendar, originalItem, listener);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+            doTransaction(&quot;modify&quot;, item, opcalendar, originalItem, listener);</span>
<a href="#l12.14"></a><span id="l12.14">         } else {</span>
<a href="#l12.15"></a><span id="l12.15">             // Otherwise, this is an addition</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-            doTransaction('add', item, opcalendar, null, listener);</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+            doTransaction(&quot;add&quot;, item, opcalendar, null, listener);</span>
<a href="#l12.18"></a><span id="l12.18">         }</span>
<a href="#l12.19"></a><span id="l12.19">     };</span>
<a href="#l12.20"></a><span id="l12.20"> </span>
<a href="#l12.21"></a><span id="l12.21">     if (event) {</span>
<a href="#l12.22"></a><span id="l12.22">         if (!event.isMutable) {</span>
<a href="#l12.23"></a><span id="l12.23">             event = event.clone();</span>
<a href="#l12.24"></a><span id="l12.24">         }</span>
<a href="#l12.25"></a><span id="l12.25">         // If the event should be created from a template, then make sure to</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineat">@@ -281,20 +281,20 @@ function createEventWithDialog(calendar,</span>
<a href="#l12.27"></a><span id="l12.27">  * @param todo          (optional) A template task to show in the dialog.</span>
<a href="#l12.28"></a><span id="l12.28">  * @param initialDate   (optional) The initial date for new task datepickers</span>
<a href="#l12.29"></a><span id="l12.29">  */</span>
<a href="#l12.30"></a><span id="l12.30"> function createTodoWithDialog(calendar, dueDate, summary, todo, initialDate) {</span>
<a href="#l12.31"></a><span id="l12.31">     let onNewItem = function(item, opcalendar, originalItem, listener) {</span>
<a href="#l12.32"></a><span id="l12.32">         if (item.id) {</span>
<a href="#l12.33"></a><span id="l12.33">             // If the item already has an id, then this is the result of</span>
<a href="#l12.34"></a><span id="l12.34">             // saving the item without closing, and then saving again.</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineminus">-            doTransaction('modify', item, opcalendar, originalItem, listener);</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineplus">+            doTransaction(&quot;modify&quot;, item, opcalendar, originalItem, listener);</span>
<a href="#l12.37"></a><span id="l12.37">         } else {</span>
<a href="#l12.38"></a><span id="l12.38">             // Otherwise, this is an addition</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineminus">-            doTransaction('add', item, opcalendar, null, listener);</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineplus">+            doTransaction(&quot;add&quot;, item, opcalendar, null, listener);</span>
<a href="#l12.41"></a><span id="l12.41">         }</span>
<a href="#l12.42"></a><span id="l12.42">     };</span>
<a href="#l12.43"></a><span id="l12.43"> </span>
<a href="#l12.44"></a><span id="l12.44">     if (todo) {</span>
<a href="#l12.45"></a><span id="l12.45">         // If the todo should be created from a template, then make sure to</span>
<a href="#l12.46"></a><span id="l12.46">         // remove the id so that the item obtains a new id when doing the</span>
<a href="#l12.47"></a><span id="l12.47">         // transaction</span>
<a href="#l12.48"></a><span id="l12.48">         if (todo.id) {</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineat">@@ -333,17 +333,17 @@ function modifyEventWithDialog(aItem, jo</span>
<a href="#l12.50"></a><span id="l12.50">     let dlg = cal.findItemWindow(aItem);</span>
<a href="#l12.51"></a><span id="l12.51">     if (dlg) {</span>
<a href="#l12.52"></a><span id="l12.52">         dlg.focus();</span>
<a href="#l12.53"></a><span id="l12.53">         disposeJob(job);</span>
<a href="#l12.54"></a><span id="l12.54">         return;</span>
<a href="#l12.55"></a><span id="l12.55">     }</span>
<a href="#l12.56"></a><span id="l12.56"> </span>
<a href="#l12.57"></a><span id="l12.57">     let onModifyItem = function(item, calendar, originalItem, listener) {</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineminus">-        doTransaction('modify', item, calendar, originalItem, listener);</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineplus">+        doTransaction(&quot;modify&quot;, item, calendar, originalItem, listener);</span>
<a href="#l12.60"></a><span id="l12.60">     };</span>
<a href="#l12.61"></a><span id="l12.61"> </span>
<a href="#l12.62"></a><span id="l12.62">     let item = aItem;</span>
<a href="#l12.63"></a><span id="l12.63">     let response;</span>
<a href="#l12.64"></a><span id="l12.64">     if (aPromptOccurrence !== false) {</span>
<a href="#l12.65"></a><span id="l12.65">         [item, , response] = promptOccurrenceModification(aItem, true, &quot;edit&quot;);</span>
<a href="#l12.66"></a><span id="l12.66">     }</span>
<a href="#l12.67"></a><span id="l12.67"> </span>
<a href="#l12.68"></a><span id="l12.68" class="difflineat">@@ -474,18 +474,18 @@ function openEventDialog(calendarItem, c</span>
<a href="#l12.69"></a><span id="l12.69">         url = &quot;chrome://calendar/content/calendar-summary-dialog.xul&quot;;</span>
<a href="#l12.70"></a><span id="l12.70">         args.inTab = false;</span>
<a href="#l12.71"></a><span id="l12.71">     }</span>
<a href="#l12.72"></a><span id="l12.72"> </span>
<a href="#l12.73"></a><span id="l12.73">     if (args.inTab) {</span>
<a href="#l12.74"></a><span id="l12.74">         // open in a tab, currently the read-only summary dialog is</span>
<a href="#l12.75"></a><span id="l12.75">         // never opened in a tab</span>
<a href="#l12.76"></a><span id="l12.76">         args.url = url;</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineminus">-        let tabmail = document.getElementById('tabmail');</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineminus">-        let tabtype = cal.isEvent(args.calendarEvent) ? 'calendarEvent' : 'calendarTask';</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineplus">+        let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l12.80"></a><span id="l12.80" class="difflineplus">+        let tabtype = cal.isEvent(args.calendarEvent) ? &quot;calendarEvent&quot; : &quot;calendarTask&quot;;</span>
<a href="#l12.81"></a><span id="l12.81">         tabmail.openTab(tabtype, args);</span>
<a href="#l12.82"></a><span id="l12.82">     } else {</span>
<a href="#l12.83"></a><span id="l12.83">         // open in a window</span>
<a href="#l12.84"></a><span id="l12.84"> </span>
<a href="#l12.85"></a><span id="l12.85">         // reminder: event dialog should not be modal (cf bug 122671)</span>
<a href="#l12.86"></a><span id="l12.86">         let features;</span>
<a href="#l12.87"></a><span id="l12.87">         // keyword &quot;dependent&quot; should not be used (cf bug 752206)</span>
<a href="#l12.88"></a><span id="l12.88">         if (Services.appinfo.OS == &quot;WINNT&quot;) {</span>
<a href="#l12.89"></a><span id="l12.89" class="difflineat">@@ -713,17 +713,17 @@ function setContextPartstat(value, scope</span>
<a href="#l12.90"></a><span id="l12.90">                 newAttendee.participationStatus = value;</span>
<a href="#l12.91"></a><span id="l12.91">                 if (newAttendee.isOrganizer) {</span>
<a href="#l12.92"></a><span id="l12.92">                     newItem.organizer = newAttendee;</span>
<a href="#l12.93"></a><span id="l12.93">                 } else {</span>
<a href="#l12.94"></a><span id="l12.94">                     newItem.removeAttendee(attendee);</span>
<a href="#l12.95"></a><span id="l12.95">                     newItem.addAttendee(newAttendee);</span>
<a href="#l12.96"></a><span id="l12.96">                 }</span>
<a href="#l12.97"></a><span id="l12.97"> </span>
<a href="#l12.98"></a><span id="l12.98" class="difflineminus">-                doTransaction('modify', newItem, newItem.calendar, oldItem, null);</span>
<a href="#l12.99"></a><span id="l12.99" class="difflineplus">+                doTransaction(&quot;modify&quot;, newItem, newItem.calendar, oldItem, null);</span>
<a href="#l12.100"></a><span id="l12.100">             }</span>
<a href="#l12.101"></a><span id="l12.101">         }</span>
<a href="#l12.102"></a><span id="l12.102">     } catch (e) {</span>
<a href="#l12.103"></a><span id="l12.103">         cal.ERROR(&quot;Error setting partstat: &quot; + e);</span>
<a href="#l12.104"></a><span id="l12.104">     } finally {</span>
<a href="#l12.105"></a><span id="l12.105">         endBatchTransaction();</span>
<a href="#l12.106"></a><span id="l12.106">     }</span>
<a href="#l12.107"></a><span id="l12.107"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/content/calendar-month-view.xml</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/content/calendar-month-view.xml</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -426,17 +426,17 @@</span>
<a href="#l13.4"></a><span id="l13.4">           for (let i = 0; i &lt; 7; i++) {</span>
<a href="#l13.5"></a><span id="l13.5">               let hdr = createXULElement(&quot;calendar-day-label&quot;);</span>
<a href="#l13.6"></a><span id="l13.6">               this.labeldaybox.appendChild(hdr);</span>
<a href="#l13.7"></a><span id="l13.7">               hdr.weekDay = (i + this.mWeekStartOffset) % 7;</span>
<a href="#l13.8"></a><span id="l13.8">               hdr.shortWeekNames = false;</span>
<a href="#l13.9"></a><span id="l13.9">           }</span>
<a href="#l13.10"></a><span id="l13.10"> </span>
<a href="#l13.11"></a><span id="l13.11">           // Set the preference for displaying the week number</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-          this.mShowWeekNumber = Preferences.get('calendar.view-minimonth.showWeekNumber', true);</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+          this.mShowWeekNumber = Preferences.get(&quot;calendar.view-minimonth.showWeekNumber&quot;, true);</span>
<a href="#l13.14"></a><span id="l13.14">       ]]&gt;&lt;/constructor&gt;</span>
<a href="#l13.15"></a><span id="l13.15"> </span>
<a href="#l13.16"></a><span id="l13.16">       &lt;!-- fields --&gt;</span>
<a href="#l13.17"></a><span id="l13.17"> </span>
<a href="#l13.18"></a><span id="l13.18">       &lt;field name=&quot;mDateBoxes&quot;&gt;null&lt;/field&gt;</span>
<a href="#l13.19"></a><span id="l13.19">       &lt;field name=&quot;mSelectedDayBox&quot;&gt;null&lt;/field&gt;</span>
<a href="#l13.20"></a><span id="l13.20"> </span>
<a href="#l13.21"></a><span id="l13.21">       &lt;field name=&quot;mShowDaysOutsideMonth&quot;&gt;true&lt;/field&gt;</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -1107,17 +1107,17 @@</span>
<a href="#l13.23"></a><span id="l13.23">           }</span>
<a href="#l13.24"></a><span id="l13.24">         ]]&gt;&lt;/body&gt;</span>
<a href="#l13.25"></a><span id="l13.25">       &lt;/method&gt;</span>
<a href="#l13.26"></a><span id="l13.26">     &lt;/implementation&gt;</span>
<a href="#l13.27"></a><span id="l13.27"> </span>
<a href="#l13.28"></a><span id="l13.28">     &lt;handlers&gt;</span>
<a href="#l13.29"></a><span id="l13.29">       &lt;handler event=&quot;wheel&quot;&gt;&lt;![CDATA[</span>
<a href="#l13.30"></a><span id="l13.30">         const pixelThreshold = 150;</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-        let scrollEnabled = Preferences.get('calendar.view.mousescroll', true);</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+        let scrollEnabled = Preferences.get(&quot;calendar.view.mousescroll&quot;, true);</span>
<a href="#l13.33"></a><span id="l13.33">         if (!event.ctrlKey &amp;&amp; !event.shiftKey &amp;&amp;</span>
<a href="#l13.34"></a><span id="l13.34">             !event.altKey &amp;&amp; !event.metaKey &amp;&amp; scrollEnabled) {</span>
<a href="#l13.35"></a><span id="l13.35">             // In the month view, the only thing that can be scrolled</span>
<a href="#l13.36"></a><span id="l13.36">             // is the month the user is in. calendar-base-view takes care</span>
<a href="#l13.37"></a><span id="l13.37">             // of the shift key, so only move the view when no modifier</span>
<a href="#l13.38"></a><span id="l13.38">             // is pressed.</span>
<a href="#l13.39"></a><span id="l13.39">             let deltaView = 0;</span>
<a href="#l13.40"></a><span id="l13.40">             if (event.deltaMode == event.DOM_DELTA_LINE) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -3215,19 +3215,19 @@</span>
<a href="#l14.4"></a><span id="l14.4">           let otherorient = (orient == &quot;vertical&quot; ? &quot;horizontal&quot; : &quot;vertical&quot;);</span>
<a href="#l14.5"></a><span id="l14.5"> </span>
<a href="#l14.6"></a><span id="l14.6">           if (orient == &quot;horizontal&quot;) {</span>
<a href="#l14.7"></a><span id="l14.7">               this.pixelsPerMinute = 1.5;</span>
<a href="#l14.8"></a><span id="l14.8">           } else {</span>
<a href="#l14.9"></a><span id="l14.9">               this.pixelsPerMinute = 0.6;</span>
<a href="#l14.10"></a><span id="l14.10">           }</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-          let normalelems = ['mainbox', 'timebar'];</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-          let otherelems = ['labelbox', 'labeldaybox', 'headertimespacer',</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-                            'headerbox', 'headerdaybox', 'scrollbox', 'daybox'];</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+          let normalelems = [&quot;mainbox&quot;, &quot;timebar&quot;];</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineplus">+          let otherelems = [&quot;labelbox&quot;, &quot;labeldaybox&quot;, &quot;headertimespacer&quot;,</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+                            &quot;headerbox&quot;, &quot;headerdaybox&quot;, &quot;scrollbox&quot;, &quot;daybox&quot;];</span>
<a href="#l14.18"></a><span id="l14.18"> </span>
<a href="#l14.19"></a><span id="l14.19">           for (let id of normalelems) {</span>
<a href="#l14.20"></a><span id="l14.20">               document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, id).setAttribute(&quot;orient&quot;, orient);</span>
<a href="#l14.21"></a><span id="l14.21">           }</span>
<a href="#l14.22"></a><span id="l14.22">           for (let id of otherelems) {</span>
<a href="#l14.23"></a><span id="l14.23">               document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, id).setAttribute(&quot;orient&quot;, otherorient);</span>
<a href="#l14.24"></a><span id="l14.24">           }</span>
<a href="#l14.25"></a><span id="l14.25"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/base/content/calendar-task-editing.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-editing.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -131,17 +131,17 @@ var taskEdit = {</span>
<a href="#l15.4"></a><span id="l15.4">         if (aEvent.keyCode == Components.interfaces.nsIDOMKeyEvent.DOM_VK_RETURN) {</span>
<a href="#l15.5"></a><span id="l15.5">             let edit = aEvent.target;</span>
<a href="#l15.6"></a><span id="l15.6">             if (edit.value &amp;&amp; edit.value.length &gt; 0) {</span>
<a href="#l15.7"></a><span id="l15.7">                 let item = cal.createTodo();</span>
<a href="#l15.8"></a><span id="l15.8">                 setDefaultItemValues(item);</span>
<a href="#l15.9"></a><span id="l15.9">                 item.title = edit.value;</span>
<a href="#l15.10"></a><span id="l15.10"> </span>
<a href="#l15.11"></a><span id="l15.11">                 edit.value = &quot;&quot;;</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-                doTransaction('add', item, item.calendar, null, null);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+                doTransaction(&quot;add&quot;, item, item.calendar, null, null);</span>
<a href="#l15.14"></a><span id="l15.14">             }</span>
<a href="#l15.15"></a><span id="l15.15">         }</span>
<a href="#l15.16"></a><span id="l15.16">     },</span>
<a href="#l15.17"></a><span id="l15.17"> </span>
<a href="#l15.18"></a><span id="l15.18">     /**</span>
<a href="#l15.19"></a><span id="l15.19">      * Window load function to set up all quick-add textboxes. The texbox must</span>
<a href="#l15.20"></a><span id="l15.20">      * have the class &quot;task-edit-field&quot;.</span>
<a href="#l15.21"></a><span id="l15.21">      */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/base/content/calendar-task-tree.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-tree.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -142,17 +142,17 @@ function contextChangeTaskProgress(aEven</span>
<a href="#l16.4"></a><span id="l16.4">                 case 100:</span>
<a href="#l16.5"></a><span id="l16.5">                     newTask.isCompleted = true;</span>
<a href="#l16.6"></a><span id="l16.6">                     break;</span>
<a href="#l16.7"></a><span id="l16.7">                 default:</span>
<a href="#l16.8"></a><span id="l16.8">                     newTask.status = &quot;IN-PROCESS&quot;;</span>
<a href="#l16.9"></a><span id="l16.9">                     newTask.completedDate = null;</span>
<a href="#l16.10"></a><span id="l16.10">                     break;</span>
<a href="#l16.11"></a><span id="l16.11">             }</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-            doTransaction('modify', newTask, newTask.calendar, task, null);</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+            doTransaction(&quot;modify&quot;, newTask, newTask.calendar, task, null);</span>
<a href="#l16.14"></a><span id="l16.14">         }</span>
<a href="#l16.15"></a><span id="l16.15">         endBatchTransaction();</span>
<a href="#l16.16"></a><span id="l16.16">     }</span>
<a href="#l16.17"></a><span id="l16.17"> }</span>
<a href="#l16.18"></a><span id="l16.18"> </span>
<a href="#l16.19"></a><span id="l16.19"> /**</span>
<a href="#l16.20"></a><span id="l16.20">  * Handler function to change the calendar of the selected tasks. The targeted</span>
<a href="#l16.21"></a><span id="l16.21">  * menuitem must have &quot;calendar&quot; property that implements calICalendar.</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineat">@@ -161,17 +161,17 @@ function contextChangeTaskProgress(aEven</span>
<a href="#l16.23"></a><span id="l16.23">  */</span>
<a href="#l16.24"></a><span id="l16.24"> function contextChangeTaskCalendar(aEvent) {</span>
<a href="#l16.25"></a><span id="l16.25">    startBatchTransaction();</span>
<a href="#l16.26"></a><span id="l16.26">    let tasks = getSelectedTasks(aEvent);</span>
<a href="#l16.27"></a><span id="l16.27">    for (let t = 0; t &lt; tasks.length; t++) {</span>
<a href="#l16.28"></a><span id="l16.28">        let task = tasks[t];</span>
<a href="#l16.29"></a><span id="l16.29">        let newTask = task.clone().QueryInterface(Components.interfaces.calITodo);</span>
<a href="#l16.30"></a><span id="l16.30">        newTask.calendar = aEvent.target.calendar;</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineminus">-       doTransaction('modify', newTask, newTask.calendar, task, null);</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineplus">+       doTransaction(&quot;modify&quot;, newTask, newTask.calendar, task, null);</span>
<a href="#l16.33"></a><span id="l16.33">     }</span>
<a href="#l16.34"></a><span id="l16.34">     endBatchTransaction();</span>
<a href="#l16.35"></a><span id="l16.35"> }</span>
<a href="#l16.36"></a><span id="l16.36"> </span>
<a href="#l16.37"></a><span id="l16.37"> /**</span>
<a href="#l16.38"></a><span id="l16.38">  * Handler function to change the priority of the selected tasks, or of</span>
<a href="#l16.39"></a><span id="l16.39">  * the task loaded in the current tab.</span>
<a href="#l16.40"></a><span id="l16.40">  *</span>
<a href="#l16.41"></a><span id="l16.41" class="difflineat">@@ -183,17 +183,17 @@ function contextChangeTaskPriority(aEven</span>
<a href="#l16.42"></a><span id="l16.42">     if (tabType == &quot;calendarTask&quot; || tabType == &quot;calendarEvent&quot;) {</span>
<a href="#l16.43"></a><span id="l16.43">         editConfigState({ priority: aPriority });</span>
<a href="#l16.44"></a><span id="l16.44">     } else {</span>
<a href="#l16.45"></a><span id="l16.45">         startBatchTransaction();</span>
<a href="#l16.46"></a><span id="l16.46">         let tasks = getSelectedTasks(aEvent);</span>
<a href="#l16.47"></a><span id="l16.47">         for (let task of tasks) {</span>
<a href="#l16.48"></a><span id="l16.48">             let newTask = task.clone().QueryInterface(Components.interfaces.calITodo);</span>
<a href="#l16.49"></a><span id="l16.49">             newTask.priority = aPriority;</span>
<a href="#l16.50"></a><span id="l16.50" class="difflineminus">-            doTransaction('modify', newTask, newTask.calendar, task, null);</span>
<a href="#l16.51"></a><span id="l16.51" class="difflineplus">+            doTransaction(&quot;modify&quot;, newTask, newTask.calendar, task, null);</span>
<a href="#l16.52"></a><span id="l16.52">         }</span>
<a href="#l16.53"></a><span id="l16.53">         endBatchTransaction();</span>
<a href="#l16.54"></a><span id="l16.54">     }</span>
<a href="#l16.55"></a><span id="l16.55"> }</span>
<a href="#l16.56"></a><span id="l16.56"> </span>
<a href="#l16.57"></a><span id="l16.57"> /**</span>
<a href="#l16.58"></a><span id="l16.58">  * Handler function to postpone the start and due dates of the selected</span>
<a href="#l16.59"></a><span id="l16.59">  * tasks, or of the task loaded in the current tab. ISO 8601 format:</span>
<a href="#l16.60"></a><span id="l16.60" class="difflineat">@@ -216,17 +216,17 @@ function contextPostponeTask(aEvent, aDu</span>
<a href="#l16.61"></a><span id="l16.61">     } else {</span>
<a href="#l16.62"></a><span id="l16.62">         startBatchTransaction();</span>
<a href="#l16.63"></a><span id="l16.63">         let tasks = getSelectedTasks(aEvent);</span>
<a href="#l16.64"></a><span id="l16.64"> </span>
<a href="#l16.65"></a><span id="l16.65">         tasks.forEach(function(task) {</span>
<a href="#l16.66"></a><span id="l16.66">             if (task.entryDate || task.dueDate) {</span>
<a href="#l16.67"></a><span id="l16.67">                 let newTask = task.clone();</span>
<a href="#l16.68"></a><span id="l16.68">                 cal.shiftItem(newTask, duration);</span>
<a href="#l16.69"></a><span id="l16.69" class="difflineminus">-                doTransaction('modify', newTask, newTask.calendar, task, null);</span>
<a href="#l16.70"></a><span id="l16.70" class="difflineplus">+                doTransaction(&quot;modify&quot;, newTask, newTask.calendar, task, null);</span>
<a href="#l16.71"></a><span id="l16.71">             }</span>
<a href="#l16.72"></a><span id="l16.72">         });</span>
<a href="#l16.73"></a><span id="l16.73"> </span>
<a href="#l16.74"></a><span id="l16.74">         endBatchTransaction();</span>
<a href="#l16.75"></a><span id="l16.75">     }</span>
<a href="#l16.76"></a><span id="l16.76"> }</span>
<a href="#l16.77"></a><span id="l16.77"> </span>
<a href="#l16.78"></a><span id="l16.78"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -136,19 +136,19 @@</span>
<a href="#l17.4"></a><span id="l17.4">         branch.addObserver(&quot;calendar.&quot;, this, false);</span>
<a href="#l17.5"></a><span id="l17.5"> </span>
<a href="#l17.6"></a><span id="l17.6"> </span>
<a href="#l17.7"></a><span id="l17.7">         // we want to make several attributes on the column</span>
<a href="#l17.8"></a><span id="l17.8">         // elements persistent, but unfortunately there's no</span>
<a href="#l17.9"></a><span id="l17.9">         // relyable way with the 'persist' feature.</span>
<a href="#l17.10"></a><span id="l17.10">         // that's why we need to store the necessary bits and</span>
<a href="#l17.11"></a><span id="l17.11">         // pieces at the element this binding is attached to.</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-        let names = this.getAttribute(&quot;visible-columns&quot;).split(' ');</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineminus">-        let ordinals = this.getAttribute(&quot;ordinals&quot;).split(' ');</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineminus">-        let widths = this.getAttribute(&quot;widths&quot;).split(' ');</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineplus">+        let names = this.getAttribute(&quot;visible-columns&quot;).split(&quot; &quot;);</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+        let ordinals = this.getAttribute(&quot;ordinals&quot;).split(&quot; &quot;);</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineplus">+        let widths = this.getAttribute(&quot;widths&quot;).split(&quot; &quot;);</span>
<a href="#l17.18"></a><span id="l17.18">         let sorted = this.getAttribute(&quot;sort-active&quot;);</span>
<a href="#l17.19"></a><span id="l17.19">         let sortDirection = this.getAttribute(&quot;sort-direction&quot;) || &quot;ascending&quot;;</span>
<a href="#l17.20"></a><span id="l17.20">         tree = document.getAnonymousNodes(this)[0];</span>
<a href="#l17.21"></a><span id="l17.21">         let treecols = tree.getElementsByTagNameNS(tree.namespaceURI, &quot;treecol&quot;);</span>
<a href="#l17.22"></a><span id="l17.22">         for (let i = 0; i &lt; treecols.length; i++) {</span>
<a href="#l17.23"></a><span id="l17.23">             let content = treecols[i].getAttribute(&quot;itemproperty&quot;);</span>
<a href="#l17.24"></a><span id="l17.24">             if (names.some(</span>
<a href="#l17.25"></a><span id="l17.25">                 function(element) {</span>
<a href="#l17.26"></a><span id="l17.26" class="difflineat">@@ -548,17 +548,17 @@</span>
<a href="#l17.27"></a><span id="l17.27">               if (!task || task.recurrenceInfo || task.calendar.readOnly) {</span>
<a href="#l17.28"></a><span id="l17.28">                   return;</span>
<a href="#l17.29"></a><span id="l17.29">               }</span>
<a href="#l17.30"></a><span id="l17.30">               if (aCol != null) {</span>
<a href="#l17.31"></a><span id="l17.31">                   let content = aCol.element.getAttribute(&quot;itemproperty&quot;);</span>
<a href="#l17.32"></a><span id="l17.32">                   if (content == &quot;completed&quot;) {</span>
<a href="#l17.33"></a><span id="l17.33">                       let newTask = task.clone().QueryInterface(Components.interfaces.calITodo);</span>
<a href="#l17.34"></a><span id="l17.34">                       newTask.isCompleted = !task.completedDate;</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineminus">-                      doTransaction('modify', newTask, newTask.calendar, task, null);</span>
<a href="#l17.36"></a><span id="l17.36" class="difflineplus">+                      doTransaction(&quot;modify&quot;, newTask, newTask.calendar, task, null);</span>
<a href="#l17.37"></a><span id="l17.37">                   }</span>
<a href="#l17.38"></a><span id="l17.38">               }</span>
<a href="#l17.39"></a><span id="l17.39">           },</span>
<a href="#l17.40"></a><span id="l17.40"> </span>
<a href="#l17.41"></a><span id="l17.41">           // Called on the view when a header is clicked.</span>
<a href="#l17.42"></a><span id="l17.42">           cycleHeader: function mTV_cycleHeader(aCol) {</span>
<a href="#l17.43"></a><span id="l17.43">               if (!this.selectedColumn) {</span>
<a href="#l17.44"></a><span id="l17.44">                   this.sortDirection = &quot;ascending&quot;;</span>
<a href="#l17.45"></a><span id="l17.45" class="difflineat">@@ -585,17 +585,17 @@</span>
<a href="#l17.46"></a><span id="l17.46">               let task = this.binding.mTaskArray[aRow];</span>
<a href="#l17.47"></a><span id="l17.47">               if (!task) {</span>
<a href="#l17.48"></a><span id="l17.48">                   return false;</span>
<a href="#l17.49"></a><span id="l17.49">               }</span>
<a href="#l17.50"></a><span id="l17.50"> </span>
<a href="#l17.51"></a><span id="l17.51">               switch (aCol.element.getAttribute(&quot;itemproperty&quot;)) {</span>
<a href="#l17.52"></a><span id="l17.52">                   case &quot;title&quot;:</span>
<a href="#l17.53"></a><span id="l17.53">                       // return title, or &quot;Untitled&quot; if empty/null</span>
<a href="#l17.54"></a><span id="l17.54" class="difflineminus">-                      return (task.title ? task.title.replace(/\n/g, ' ') : calGetString(&quot;calendar&quot;, &quot;eventUntitled&quot;));</span>
<a href="#l17.55"></a><span id="l17.55" class="difflineplus">+                      return (task.title ? task.title.replace(/\n/g, &quot; &quot;) : calGetString(&quot;calendar&quot;, &quot;eventUntitled&quot;));</span>
<a href="#l17.56"></a><span id="l17.56">                   case &quot;entryDate&quot;:</span>
<a href="#l17.57"></a><span id="l17.57">                       return task.recurrenceInfo ? calGetString(&quot;dateFormat&quot;, &quot;Repeating&quot;) : this._formatDateTime(task.entryDate);</span>
<a href="#l17.58"></a><span id="l17.58">                   case &quot;dueDate&quot;:</span>
<a href="#l17.59"></a><span id="l17.59">                       return task.recurrenceInfo ? calGetString(&quot;dateFormat&quot;, &quot;Repeating&quot;) : this._formatDateTime(task.dueDate);</span>
<a href="#l17.60"></a><span id="l17.60">                   case &quot;completedDate&quot;:</span>
<a href="#l17.61"></a><span id="l17.61">                       return task.recurrenceInfo ? calGetString(&quot;dateFormat&quot;, &quot;Repeating&quot;) : this._formatDateTime(task.completedDate);</span>
<a href="#l17.62"></a><span id="l17.62">                   case &quot;percentComplete&quot;:</span>
<a href="#l17.63"></a><span id="l17.63">                       return (task.percentComplete &gt; 0 ? task.percentComplete + &quot;%&quot; : &quot;&quot;);</span>
<a href="#l17.64"></a><span id="l17.64" class="difflineat">@@ -746,17 +746,17 @@</span>
<a href="#l17.65"></a><span id="l17.65">               }</span>
<a href="#l17.66"></a><span id="l17.66">           },</span>
<a href="#l17.67"></a><span id="l17.67"> </span>
<a href="#l17.68"></a><span id="l17.68">           onKeyPress: function tTV_onKeyPress(event) {</span>
<a href="#l17.69"></a><span id="l17.69">               const kKE = Components.interfaces.nsIDOMKeyEvent;</span>
<a href="#l17.70"></a><span id="l17.70">               switch (event.keyCode || event.which) {</span>
<a href="#l17.71"></a><span id="l17.71">                   case kKE.DOM_VK_DELETE:</span>
<a href="#l17.72"></a><span id="l17.72">                       document.popupNode = this.binding;</span>
<a href="#l17.73"></a><span id="l17.73" class="difflineminus">-                      document.getElementById('calendar_delete_todo_command').doCommand();</span>
<a href="#l17.74"></a><span id="l17.74" class="difflineplus">+                      document.getElementById(&quot;calendar_delete_todo_command&quot;).doCommand();</span>
<a href="#l17.75"></a><span id="l17.75">                       event.preventDefault();</span>
<a href="#l17.76"></a><span id="l17.76">                       event.stopPropagation();</span>
<a href="#l17.77"></a><span id="l17.77">                       break;</span>
<a href="#l17.78"></a><span id="l17.78">                   case kKE.DOM_VK_SPACE:</span>
<a href="#l17.79"></a><span id="l17.79">                       if (this.tree.currentIndex &gt; -1) {</span>
<a href="#l17.80"></a><span id="l17.80">                           let col = document.getAnonymousElementByAttribute(</span>
<a href="#l17.81"></a><span id="l17.81">                               this.binding, &quot;itemproperty&quot;, &quot;completed&quot;);</span>
<a href="#l17.82"></a><span id="l17.82">                           this.cycleCell(</span>
<a href="#l17.83"></a><span id="l17.83" class="difflineat">@@ -846,18 +846,18 @@</span>
<a href="#l17.84"></a><span id="l17.84">           },</span>
<a href="#l17.85"></a><span id="l17.85"> </span>
<a href="#l17.86"></a><span id="l17.86">           onModifyItem: function tTO_onModifyItem(aNewItem, aOldItem) {</span>
<a href="#l17.87"></a><span id="l17.87">               if ((cal.isToDo(aNewItem) || cal.isToDo(aOldItem))) {</span>
<a href="#l17.88"></a><span id="l17.88">                   this.binding.mTreeView.modifyItems(this.binding.mFilter.getOccurrences(aNewItem),</span>
<a href="#l17.89"></a><span id="l17.89">                                                      this.binding.mFilter.getOccurrences(aOldItem));</span>
<a href="#l17.90"></a><span id="l17.90"> </span>
<a href="#l17.91"></a><span id="l17.91">                   // we also need to notify potential listeners.</span>
<a href="#l17.92"></a><span id="l17.92" class="difflineminus">-                  let event = document.createEvent('Events');</span>
<a href="#l17.93"></a><span id="l17.93" class="difflineminus">-                  event.initEvent('select', true, false);</span>
<a href="#l17.94"></a><span id="l17.94" class="difflineplus">+                  let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l17.95"></a><span id="l17.95" class="difflineplus">+                  event.initEvent(&quot;select&quot;, true, false);</span>
<a href="#l17.96"></a><span id="l17.96">                   this.binding.dispatchEvent(event);</span>
<a href="#l17.97"></a><span id="l17.97">               }</span>
<a href="#l17.98"></a><span id="l17.98">           },</span>
<a href="#l17.99"></a><span id="l17.99"> </span>
<a href="#l17.100"></a><span id="l17.100">           onDeleteItem: function tTO_onDeleteItem(aDeletedItem) {</span>
<a href="#l17.101"></a><span id="l17.101">               if (cal.isToDo(aDeletedItem)) {</span>
<a href="#l17.102"></a><span id="l17.102">                   this.binding.mTreeView.removeItems(this.binding.mFilter.getOccurrences(aDeletedItem));</span>
<a href="#l17.103"></a><span id="l17.103">               }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/base/content/calendar-task-view.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-view.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -26,17 +26,17 @@ var taskDetailsView = {</span>
<a href="#l18.4"></a><span id="l18.4">             Components.classes[&quot;@mozilla.org/calendar/datetime-formatter;1&quot;]</span>
<a href="#l18.5"></a><span id="l18.5">             .getService(Components.interfaces.calIDateTimeFormatter);</span>
<a href="#l18.6"></a><span id="l18.6"> </span>
<a href="#l18.7"></a><span id="l18.7">         let item = document.getElementById(&quot;calendar-task-tree&quot;).currentTask;</span>
<a href="#l18.8"></a><span id="l18.8">         if (displayElement(&quot;calendar-task-details-container&quot;, item != null) &amp;&amp;</span>
<a href="#l18.9"></a><span id="l18.9">             displayElement(&quot;calendar-task-view-splitter&quot;, item != null)) {</span>
<a href="#l18.10"></a><span id="l18.10">             displayElement(&quot;calendar-task-details-title-row&quot;, true);</span>
<a href="#l18.11"></a><span id="l18.11">             document.getElementById(&quot;calendar-task-details-title&quot;).textContent =</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-                (item.title ? item.title.replace(/\n/g, ' ') : &quot;&quot;);</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+                (item.title ? item.title.replace(/\n/g, &quot; &quot;) : &quot;&quot;);</span>
<a href="#l18.14"></a><span id="l18.14"> </span>
<a href="#l18.15"></a><span id="l18.15">             let organizer = item.organizer;</span>
<a href="#l18.16"></a><span id="l18.16">             if (displayElement(&quot;calendar-task-details-organizer-row&quot;, organizer != null)) {</span>
<a href="#l18.17"></a><span id="l18.17">                 let name = organizer.commonName;</span>
<a href="#l18.18"></a><span id="l18.18">                 if (!name || name.length &lt;= 0) {</span>
<a href="#l18.19"></a><span id="l18.19">                   if (organizer.id &amp;&amp; organizer.id.length) {</span>
<a href="#l18.20"></a><span id="l18.20">                       name = organizer.id;</span>
<a href="#l18.21"></a><span id="l18.21">                       let re = new RegExp(&quot;^mailto:(.*)&quot;, &quot;i&quot;);</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineat">@@ -169,17 +169,17 @@ var taskDetailsView = {</span>
<a href="#l18.23"></a><span id="l18.23">                 categoriesMap[cat] = false;</span>
<a href="#l18.24"></a><span id="l18.24">             }</span>
<a href="#l18.25"></a><span id="l18.25">         }</span>
<a href="#l18.26"></a><span id="l18.26"> </span>
<a href="#l18.27"></a><span id="l18.27">         if (categoriesMap.toSource() != &quot;({})&quot;) {</span>
<a href="#l18.28"></a><span id="l18.28">             let newItem = item.clone();</span>
<a href="#l18.29"></a><span id="l18.29">             newItem.setCategories(panel.categories.length, panel.categories);</span>
<a href="#l18.30"></a><span id="l18.30"> </span>
<a href="#l18.31"></a><span id="l18.31" class="difflineminus">-            doTransaction('modify', newItem, newItem.calendar, item, null);</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineplus">+            doTransaction(&quot;modify&quot;, newItem, newItem.calendar, item, null);</span>
<a href="#l18.33"></a><span id="l18.33">         }</span>
<a href="#l18.34"></a><span id="l18.34">     }</span>
<a href="#l18.35"></a><span id="l18.35"> };</span>
<a href="#l18.36"></a><span id="l18.36"> </span>
<a href="#l18.37"></a><span id="l18.37"> </span>
<a href="#l18.38"></a><span id="l18.38"> /**</span>
<a href="#l18.39"></a><span id="l18.39">  * Updates the currently applied filter for the task view and refreshes the task</span>
<a href="#l18.40"></a><span id="l18.40">  * tree.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/base/content/calendar-unifinder.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/base/content/calendar-unifinder.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -757,17 +757,17 @@ var unifinderTreeView = {</span>
<a href="#l19.4"></a><span id="l19.4">         return null;</span>
<a href="#l19.5"></a><span id="l19.5">     },</span>
<a href="#l19.6"></a><span id="l19.6"> </span>
<a href="#l19.7"></a><span id="l19.7">     getCellText: function uTV_getCellText(row, column) {</span>
<a href="#l19.8"></a><span id="l19.8">         let calendarEvent = this.eventArray[row];</span>
<a href="#l19.9"></a><span id="l19.9"> </span>
<a href="#l19.10"></a><span id="l19.10">         switch (column.element.getAttribute(&quot;itemproperty&quot;)) {</span>
<a href="#l19.11"></a><span id="l19.11">             case &quot;title&quot;:</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-                return (calendarEvent.title ? calendarEvent.title.replace(/\n/g, ' ') : &quot;&quot;);</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+                return (calendarEvent.title ? calendarEvent.title.replace(/\n/g, &quot; &quot;) : &quot;&quot;);</span>
<a href="#l19.14"></a><span id="l19.14">             case &quot;startDate&quot;:</span>
<a href="#l19.15"></a><span id="l19.15">                 return formatUnifinderEventDateTime(calendarEvent.startDate);</span>
<a href="#l19.16"></a><span id="l19.16"> </span>
<a href="#l19.17"></a><span id="l19.17">             case &quot;endDate&quot;:</span>
<a href="#l19.18"></a><span id="l19.18">                 let eventEndDate = calendarEvent.endDate.clone();</span>
<a href="#l19.19"></a><span id="l19.19">                 // XXX reimplement</span>
<a href="#l19.20"></a><span id="l19.20">                 // let eventEndDate = getCurrentNextOrPreviousRecurrence(calendarEvent);</span>
<a href="#l19.21"></a><span id="l19.21">                 if (calendarEvent.startDate.isDate) {</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineat">@@ -940,18 +940,18 @@ function focusSearch() {</span>
<a href="#l19.23"></a><span id="l19.23">     document.getElementById(&quot;unifinder-search-field&quot;).focus();</span>
<a href="#l19.24"></a><span id="l19.24"> }</span>
<a href="#l19.25"></a><span id="l19.25"> </span>
<a href="#l19.26"></a><span id="l19.26"> /**</span>
<a href="#l19.27"></a><span id="l19.27">  * Toggles the hidden state of the unifinder.</span>
<a href="#l19.28"></a><span id="l19.28">  */</span>
<a href="#l19.29"></a><span id="l19.29"> function toggleUnifinder() {</span>
<a href="#l19.30"></a><span id="l19.30">     // Toggle the elements</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineminus">-    goToggleToolbar('bottom-events-box', 'calendar_show_unifinder_command');</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineminus">-    goToggleToolbar('calendar-view-splitter');</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineplus">+    goToggleToolbar(&quot;bottom-events-box&quot;, &quot;calendar_show_unifinder_command&quot;);</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineplus">+    goToggleToolbar(&quot;calendar-view-splitter&quot;);</span>
<a href="#l19.35"></a><span id="l19.35"> </span>
<a href="#l19.36"></a><span id="l19.36">     unifinderTreeView.treeElement.view = unifinderTreeView;</span>
<a href="#l19.37"></a><span id="l19.37"> </span>
<a href="#l19.38"></a><span id="l19.38">     // When the unifinder is hidden, refreshEventTree is not called. Make sure</span>
<a href="#l19.39"></a><span id="l19.39">     // the event tree is refreshed now.</span>
<a href="#l19.40"></a><span id="l19.40">     if (!isUnifinderHidden() &amp;&amp; gUnifinderNeedsRefresh) {</span>
<a href="#l19.41"></a><span id="l19.41">         gUnifinderNeedsRefresh = false;</span>
<a href="#l19.42"></a><span id="l19.42">         refreshEventTree();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/base/content/calendar-view-core.xml</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/base/content/calendar-view-core.xml</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -147,17 +147,17 @@</span>
<a href="#l20.4"></a><span id="l20.4">         onget=&quot;return document.getAnonymousElementByAttribute(this, 'anonid', 'event-name');&quot;/&gt;</span>
<a href="#l20.5"></a><span id="l20.5">       &lt;property name=&quot;eventNameTextbox&quot; readonly=&quot;true&quot;</span>
<a href="#l20.6"></a><span id="l20.6">         onget=&quot;return document.getAnonymousElementByAttribute(this, 'anonid', 'event-name-textbox');&quot;/&gt;</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8">       &lt;method name=&quot;setEditableLabel&quot;&gt;</span>
<a href="#l20.9"></a><span id="l20.9">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l20.10"></a><span id="l20.10">           let evl = this.eventNameLabel;</span>
<a href="#l20.11"></a><span id="l20.11">           let item = this.mOccurrence;</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-          evl.value = (item.title ? item.title.replace(/\n/g, ' ')</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+          evl.value = (item.title ? item.title.replace(/\n/g, &quot; &quot;)</span>
<a href="#l20.14"></a><span id="l20.14">                                   : cal.calGetString(&quot;calendar&quot;, &quot;eventUntitled&quot;));</span>
<a href="#l20.15"></a><span id="l20.15">         ]]&gt;&lt;/body&gt;</span>
<a href="#l20.16"></a><span id="l20.16">       &lt;/method&gt;</span>
<a href="#l20.17"></a><span id="l20.17"> </span>
<a href="#l20.18"></a><span id="l20.18">       &lt;method name=&quot;setCSSClasses&quot;&gt;</span>
<a href="#l20.19"></a><span id="l20.19">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l20.20"></a><span id="l20.20">           let item = this.mOccurrence;</span>
<a href="#l20.21"></a><span id="l20.21">           this.setAttribute(&quot;calendar-uri&quot;, item.calendar.uri.spec);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/base/content/calendar-views.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/base/content/calendar-views.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -34,17 +34,17 @@ var calendarViewController = {</span>
<a href="#l21.4"></a><span id="l21.4">      * @see calICalendarViewController</span>
<a href="#l21.5"></a><span id="l21.5">      */</span>
<a href="#l21.6"></a><span id="l21.6">     createNewEvent: function(aCalendar, aStartTime, aEndTime, aForceAllday) {</span>
<a href="#l21.7"></a><span id="l21.7">         // if we're given both times, skip the dialog</span>
<a href="#l21.8"></a><span id="l21.8">         if (aStartTime &amp;&amp; aEndTime &amp;&amp; !aStartTime.isDate &amp;&amp; !aEndTime.isDate) {</span>
<a href="#l21.9"></a><span id="l21.9">             let item = cal.createEvent();</span>
<a href="#l21.10"></a><span id="l21.10">             setDefaultItemValues(item, aCalendar, aStartTime, aEndTime);</span>
<a href="#l21.11"></a><span id="l21.11">             item.title = calGetString(&quot;calendar&quot;, &quot;newEvent&quot;);</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-            doTransaction('add', item, item.calendar, null, null);</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+            doTransaction(&quot;add&quot;, item, item.calendar, null, null);</span>
<a href="#l21.14"></a><span id="l21.14">         } else {</span>
<a href="#l21.15"></a><span id="l21.15">             createEventWithDialog(aCalendar, aStartTime, null, null, null, aForceAllday);</span>
<a href="#l21.16"></a><span id="l21.16">         }</span>
<a href="#l21.17"></a><span id="l21.17">     },</span>
<a href="#l21.18"></a><span id="l21.18"> </span>
<a href="#l21.19"></a><span id="l21.19">     /**</span>
<a href="#l21.20"></a><span id="l21.20">      * Modifies the given occurrence</span>
<a href="#l21.21"></a><span id="l21.21">      * @see calICalendarViewController</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineat">@@ -79,17 +79,17 @@ var calendarViewController = {</span>
<a href="#l21.23"></a><span id="l21.23">                         instance.entryDate = aNewStartTime;</span>
<a href="#l21.24"></a><span id="l21.24">                     }</span>
<a href="#l21.25"></a><span id="l21.25">                     if (aNewEndTime &amp;&amp; instance.dueDate) {</span>
<a href="#l21.26"></a><span id="l21.26">                         instance.dueDate = aNewEndTime;</span>
<a href="#l21.27"></a><span id="l21.27">                     }</span>
<a href="#l21.28"></a><span id="l21.28">                 }</span>
<a href="#l21.29"></a><span id="l21.29">             }</span>
<a href="#l21.30"></a><span id="l21.30"> </span>
<a href="#l21.31"></a><span id="l21.31" class="difflineminus">-            doTransaction('modify', instance, instance.calendar, aOccurrence, null);</span>
<a href="#l21.32"></a><span id="l21.32" class="difflineplus">+            doTransaction(&quot;modify&quot;, instance, instance.calendar, aOccurrence, null);</span>
<a href="#l21.33"></a><span id="l21.33">         } else {</span>
<a href="#l21.34"></a><span id="l21.34">             modifyEventWithDialog(aOccurrence, null, true);</span>
<a href="#l21.35"></a><span id="l21.35">         }</span>
<a href="#l21.36"></a><span id="l21.36">     },</span>
<a href="#l21.37"></a><span id="l21.37"> </span>
<a href="#l21.38"></a><span id="l21.38">     /**</span>
<a href="#l21.39"></a><span id="l21.39">      * Deletes the given occurrences</span>
<a href="#l21.40"></a><span id="l21.40">      * @see calICalendarViewController</span>
<a href="#l21.41"></a><span id="l21.41" class="difflineat">@@ -147,25 +147,25 @@ var calendarViewController = {</span>
<a href="#l21.42"></a><span id="l21.42">             // delete the whole item.</span>
<a href="#l21.43"></a><span id="l21.43">             if (itemToDelete.parentItem.hashId != itemToDelete.hashId) {</span>
<a href="#l21.44"></a><span id="l21.44">                 let savedItem = getSavedItem(itemToDelete);</span>
<a href="#l21.45"></a><span id="l21.45">                 savedItem.newItem.recurrenceInfo</span>
<a href="#l21.46"></a><span id="l21.46">                          .removeOccurrenceAt(itemToDelete.recurrenceId);</span>
<a href="#l21.47"></a><span id="l21.47">                 // Dont start the transaction yet. Do so later, in case the</span>
<a href="#l21.48"></a><span id="l21.48">                 // parent item gets modified more than once.</span>
<a href="#l21.49"></a><span id="l21.49">             } else {</span>
<a href="#l21.50"></a><span id="l21.50" class="difflineminus">-                doTransaction('delete', itemToDelete, itemToDelete.calendar, null, null);</span>
<a href="#l21.51"></a><span id="l21.51" class="difflineplus">+                doTransaction(&quot;delete&quot;, itemToDelete, itemToDelete.calendar, null, null);</span>
<a href="#l21.52"></a><span id="l21.52">             }</span>
<a href="#l21.53"></a><span id="l21.53">         }</span>
<a href="#l21.54"></a><span id="l21.54"> </span>
<a href="#l21.55"></a><span id="l21.55">         // Now handle recurring events. This makes sure that all occurrences</span>
<a href="#l21.56"></a><span id="l21.56">         // that have been passed are deleted.</span>
<a href="#l21.57"></a><span id="l21.57">         for (let hashVal in recurringItems) {</span>
<a href="#l21.58"></a><span id="l21.58">             let ritem = recurringItems[hashVal];</span>
<a href="#l21.59"></a><span id="l21.59" class="difflineminus">-            doTransaction('modify',</span>
<a href="#l21.60"></a><span id="l21.60" class="difflineplus">+            doTransaction(&quot;modify&quot;,</span>
<a href="#l21.61"></a><span id="l21.61">                           ritem.newItem,</span>
<a href="#l21.62"></a><span id="l21.62">                           ritem.newItem.calendar,</span>
<a href="#l21.63"></a><span id="l21.63">                           ritem.oldItem,</span>
<a href="#l21.64"></a><span id="l21.64">                           null);</span>
<a href="#l21.65"></a><span id="l21.65">         }</span>
<a href="#l21.66"></a><span id="l21.66">         endBatchTransaction();</span>
<a href="#l21.67"></a><span id="l21.67">     }</span>
<a href="#l21.68"></a><span id="l21.68"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -282,17 +282,17 @@ function loadReminders(reminders) {</span>
<a href="#l22.4"></a><span id="l22.4">         return;</span>
<a href="#l22.5"></a><span id="l22.5">     }</span>
<a href="#l22.6"></a><span id="l22.6"> </span>
<a href="#l22.7"></a><span id="l22.7">     if (reminders.length &gt; 1 ||</span>
<a href="#l22.8"></a><span id="l22.8">         !matchCustomReminderToMenuitem(reminders[0])) {</span>
<a href="#l22.9"></a><span id="l22.9">         // If more than one alarm is selected, or we didn't find a matching item</span>
<a href="#l22.10"></a><span id="l22.10">         // above, then select the &quot;custom&quot; item and attach the item's reminders to</span>
<a href="#l22.11"></a><span id="l22.11">         // it.</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-        reminderList.value = 'custom';</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+        reminderList.value = &quot;custom&quot;;</span>
<a href="#l22.14"></a><span id="l22.14">         customItem.reminders = reminders;</span>
<a href="#l22.15"></a><span id="l22.15">     }</span>
<a href="#l22.16"></a><span id="l22.16"> </span>
<a href="#l22.17"></a><span id="l22.17">     // remember the selected index</span>
<a href="#l22.18"></a><span id="l22.18">     gLastAlarmSelection = reminderList.selectedIndex;</span>
<a href="#l22.19"></a><span id="l22.19"> }</span>
<a href="#l22.20"></a><span id="l22.20"> </span>
<a href="#l22.21"></a><span id="l22.21"> /**</span>
<a href="#l22.22"></a><span id="l22.22" class="difflineat">@@ -307,17 +307,17 @@ function saveReminder(item) {</span>
<a href="#l22.23"></a><span id="l22.23">     for (let alarm of item.getAlarms({})) {</span>
<a href="#l22.24"></a><span id="l22.24">         oldAlarmMap[alarm.icalString] = true;</span>
<a href="#l22.25"></a><span id="l22.25">     }</span>
<a href="#l22.26"></a><span id="l22.26"> </span>
<a href="#l22.27"></a><span id="l22.27">     // Clear the alarms so we can add our new ones.</span>
<a href="#l22.28"></a><span id="l22.28">     item.clearAlarms();</span>
<a href="#l22.29"></a><span id="l22.29"> </span>
<a href="#l22.30"></a><span id="l22.30">     let reminderList = document.getElementById(&quot;item-alarm&quot;);</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-    if (reminderList.value != 'none') {</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineplus">+    if (reminderList.value != &quot;none&quot;) {</span>
<a href="#l22.33"></a><span id="l22.33">         let menuitem = reminderList.selectedItem;</span>
<a href="#l22.34"></a><span id="l22.34">         let reminders;</span>
<a href="#l22.35"></a><span id="l22.35"> </span>
<a href="#l22.36"></a><span id="l22.36">         if (menuitem.reminders) {</span>
<a href="#l22.37"></a><span id="l22.37">             // Custom reminder entries carry their own reminder object with</span>
<a href="#l22.38"></a><span id="l22.38">             // them. Make sure to clone in case these are the original item's</span>
<a href="#l22.39"></a><span id="l22.39">             // reminders.</span>
<a href="#l22.40"></a><span id="l22.40"> </span>
<a href="#l22.41"></a><span id="l22.41" class="difflineat">@@ -409,30 +409,30 @@ function getCurrentCalendar() {</span>
<a href="#l22.42"></a><span id="l22.42">  * @param aSuppressDialogs     If true, controls are updated without prompting</span>
<a href="#l22.43"></a><span id="l22.43">  *                               for changes with the dialog</span>
<a href="#l22.44"></a><span id="l22.44">  */</span>
<a href="#l22.45"></a><span id="l22.45"> function commonUpdateReminder(aSuppressDialogs) {</span>
<a href="#l22.46"></a><span id="l22.46">     // if a custom reminder has been selected, we show the appropriate</span>
<a href="#l22.47"></a><span id="l22.47">     // dialog in order to allow the user to specify the details.</span>
<a href="#l22.48"></a><span id="l22.48">     // the result will be placed in the 'reminder-custom-menuitem' tag.</span>
<a href="#l22.49"></a><span id="l22.49">     let reminderList = document.getElementById(&quot;item-alarm&quot;);</span>
<a href="#l22.50"></a><span id="l22.50" class="difflineminus">-    if (reminderList.value == 'custom') {</span>
<a href="#l22.51"></a><span id="l22.51" class="difflineplus">+    if (reminderList.value == &quot;custom&quot;) {</span>
<a href="#l22.52"></a><span id="l22.52">         // Clear the reminder icons first, this will make sure that while the</span>
<a href="#l22.53"></a><span id="l22.53">         // dialog is open the default reminder image is not shown which may</span>
<a href="#l22.54"></a><span id="l22.54">         // confuse users.</span>
<a href="#l22.55"></a><span id="l22.55">         removeChildren(&quot;reminder-icon-box&quot;);</span>
<a href="#l22.56"></a><span id="l22.56"> </span>
<a href="#l22.57"></a><span id="l22.57">         // show the dialog. This call blocks until the dialog is closed. Don't</span>
<a href="#l22.58"></a><span id="l22.58">         // pop up the dialog if aSuppressDialogs was specified or if this</span>
<a href="#l22.59"></a><span id="l22.59">         // happens during initialization of the dialog</span>
<a href="#l22.60"></a><span id="l22.60">         if (!aSuppressDialogs &amp;&amp; reminderList.hasAttribute(&quot;last-value&quot;)) {</span>
<a href="#l22.61"></a><span id="l22.61">             editReminder();</span>
<a href="#l22.62"></a><span id="l22.62">         }</span>
<a href="#l22.63"></a><span id="l22.63"> </span>
<a href="#l22.64"></a><span id="l22.64" class="difflineminus">-        if (reminderList.value == 'custom') {</span>
<a href="#l22.65"></a><span id="l22.65" class="difflineplus">+        if (reminderList.value == &quot;custom&quot;) {</span>
<a href="#l22.66"></a><span id="l22.66">             // Only do this if the 'custom' item is still selected. If the edit</span>
<a href="#l22.67"></a><span id="l22.67">             // reminder dialog was canceled then the previously selected</span>
<a href="#l22.68"></a><span id="l22.68">             // menuitem is selected, which may not be the custom menuitem.</span>
<a href="#l22.69"></a><span id="l22.69"> </span>
<a href="#l22.70"></a><span id="l22.70">             // If one or no reminders were selected, we have a chance of mapping</span>
<a href="#l22.71"></a><span id="l22.71">             // them to the existing elements in the dropdown.</span>
<a href="#l22.72"></a><span id="l22.72">             let customItem = reminderList.selectedItem;</span>
<a href="#l22.73"></a><span id="l22.73">             if (customItem.reminders.length == 0) {</span>
<a href="#l22.74"></a><span id="l22.74" class="difflineat">@@ -458,17 +458,17 @@ function commonUpdateReminder(aSuppressD</span>
<a href="#l22.75"></a><span id="l22.75">     // the checkbox. the same goes for end related reminder and the due date.</span>
<a href="#l22.76"></a><span id="l22.76">     if (isToDo(window.calendarItem)) {</span>
<a href="#l22.77"></a><span id="l22.77">         // In general, (re-)enable the due/entry checkboxes. This will be</span>
<a href="#l22.78"></a><span id="l22.78">         // changed in case the alarms are related to START/END below.</span>
<a href="#l22.79"></a><span id="l22.79">         enableElementWithLock(&quot;todo-has-duedate&quot;, &quot;reminder-lock&quot;);</span>
<a href="#l22.80"></a><span id="l22.80">         enableElementWithLock(&quot;todo-has-entrydate&quot;, &quot;reminder-lock&quot;);</span>
<a href="#l22.81"></a><span id="l22.81"> </span>
<a href="#l22.82"></a><span id="l22.82">         let menuitem = reminderList.selectedItem;</span>
<a href="#l22.83"></a><span id="l22.83" class="difflineminus">-        if (menuitem.value != 'none') {</span>
<a href="#l22.84"></a><span id="l22.84" class="difflineplus">+        if (menuitem.value != &quot;none&quot;) {</span>
<a href="#l22.85"></a><span id="l22.85">             // In case a reminder is selected, retrieve the array of alarms from</span>
<a href="#l22.86"></a><span id="l22.86">             // it, or create one from the currently selected menuitem.</span>
<a href="#l22.87"></a><span id="l22.87">             let reminders = menuitem.reminders || [createReminderFromMenuitem(menuitem)];</span>
<a href="#l22.88"></a><span id="l22.88"> </span>
<a href="#l22.89"></a><span id="l22.89">             // If a reminder is related to the entry date...</span>
<a href="#l22.90"></a><span id="l22.90">             if (reminders.some(x =&gt; x.related == x.ALARM_RELATED_START)) {</span>
<a href="#l22.91"></a><span id="l22.91">                 // ...automatically check 'has entrydate'.</span>
<a href="#l22.92"></a><span id="l22.92">                 if (!getElementValue(&quot;todo-has-entrydate&quot;, &quot;checked&quot;)) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-attendees.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-attendees.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -311,34 +311,34 @@ function updateTimezone() {</span>
<a href="#l23.4"></a><span id="l23.4">         if (startTimezone &amp;&amp; endTimezone &amp;&amp;</span>
<a href="#l23.5"></a><span id="l23.5">             (compareObjects(startTimezone, endTimezone) || endTimezone.isUTC)) {</span>
<a href="#l23.6"></a><span id="l23.6">             equalTimezones = true;</span>
<a href="#l23.7"></a><span id="l23.7">         }</span>
<a href="#l23.8"></a><span id="l23.8"> </span>
<a href="#l23.9"></a><span id="l23.9">         let tzStart = document.getElementById(&quot;timezone-starttime&quot;);</span>
<a href="#l23.10"></a><span id="l23.10">         let tzEnd = document.getElementById(&quot;timezone-endtime&quot;);</span>
<a href="#l23.11"></a><span id="l23.11">         if (startTimezone != null) {</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-            tzStart.removeAttribute('collapsed');</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+            tzStart.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l23.14"></a><span id="l23.14">             tzStart.value = startTimezone.displayName || startTimezone.tzid;</span>
<a href="#l23.15"></a><span id="l23.15">         } else {</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineminus">-            tzStart.setAttribute('collapsed', 'true');</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineplus">+            tzStart.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l23.18"></a><span id="l23.18">         }</span>
<a href="#l23.19"></a><span id="l23.19"> </span>
<a href="#l23.20"></a><span id="l23.20">         // we never display the second timezone if both are equal</span>
<a href="#l23.21"></a><span id="l23.21">         if (endTimezone != null &amp;&amp; !equalTimezones) {</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineminus">-            tzEnd.removeAttribute('collapsed');</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineplus">+            tzEnd.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l23.24"></a><span id="l23.24">             tzEnd.value = endTimezone.displayName || endTimezone.tzid;</span>
<a href="#l23.25"></a><span id="l23.25">         } else {</span>
<a href="#l23.26"></a><span id="l23.26" class="difflineminus">-            tzEnd.setAttribute('collapsed', 'true');</span>
<a href="#l23.27"></a><span id="l23.27" class="difflineplus">+            tzEnd.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l23.28"></a><span id="l23.28">         }</span>
<a href="#l23.29"></a><span id="l23.29">     } else {</span>
<a href="#l23.30"></a><span id="l23.30">         document.getElementById(&quot;timezone-starttime&quot;)</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineminus">-            .setAttribute('collapsed', 'true');</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineplus">+            .setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l23.33"></a><span id="l23.33">         document.getElementById(&quot;timezone-endtime&quot;)</span>
<a href="#l23.34"></a><span id="l23.34" class="difflineminus">-            .setAttribute('collapsed', 'true');</span>
<a href="#l23.35"></a><span id="l23.35" class="difflineplus">+            .setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l23.36"></a><span id="l23.36">     }</span>
<a href="#l23.37"></a><span id="l23.37"> </span>
<a href="#l23.38"></a><span id="l23.38">     gIgnoreUpdate = false;</span>
<a href="#l23.39"></a><span id="l23.39"> }</span>
<a href="#l23.40"></a><span id="l23.40"> </span>
<a href="#l23.41"></a><span id="l23.41"> /**</span>
<a href="#l23.42"></a><span id="l23.42">  * Updates gStartDate from the start time picker &quot;event-starttime&quot;</span>
<a href="#l23.43"></a><span id="l23.43">  */</span>
<a href="#l23.44"></a><span id="l23.44" class="difflineat">@@ -626,34 +626,34 @@ function onChangeCalendar(calendar) {</span>
<a href="#l23.45"></a><span id="l23.45">     gIsInvitation = false;</span>
<a href="#l23.46"></a><span id="l23.46">     calendar = cal.wrapInstance(args.item.calendar, Components.interfaces.calISchedulingSupport);</span>
<a href="#l23.47"></a><span id="l23.47">     if (calendar) {</span>
<a href="#l23.48"></a><span id="l23.48">         gIsInvitation = calendar.isInvitation(args.item);</span>
<a href="#l23.49"></a><span id="l23.49">     }</span>
<a href="#l23.50"></a><span id="l23.50"> </span>
<a href="#l23.51"></a><span id="l23.51">     if (gIsReadOnly || gIsInvitation) {</span>
<a href="#l23.52"></a><span id="l23.52">         document.getElementById(&quot;next-slot&quot;)</span>
<a href="#l23.53"></a><span id="l23.53" class="difflineminus">-            .setAttribute('disabled', 'true');</span>
<a href="#l23.54"></a><span id="l23.54" class="difflineplus">+            .setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l23.55"></a><span id="l23.55">         document.getElementById(&quot;previous-slot&quot;)</span>
<a href="#l23.56"></a><span id="l23.56" class="difflineminus">-            .setAttribute('disabled', 'true');</span>
<a href="#l23.57"></a><span id="l23.57" class="difflineplus">+            .setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l23.58"></a><span id="l23.58">     }</span>
<a href="#l23.59"></a><span id="l23.59"> </span>
<a href="#l23.60"></a><span id="l23.60">     let freebusy = document.getElementById(&quot;freebusy-grid&quot;);</span>
<a href="#l23.61"></a><span id="l23.61">     freebusy.onChangeCalendar(calendar);</span>
<a href="#l23.62"></a><span id="l23.62"> }</span>
<a href="#l23.63"></a><span id="l23.63"> </span>
<a href="#l23.64"></a><span id="l23.64"> /**</span>
<a href="#l23.65"></a><span id="l23.65">  * Updates the slot buttons.</span>
<a href="#l23.66"></a><span id="l23.66">  */</span>
<a href="#l23.67"></a><span id="l23.67"> function updateButtons() {</span>
<a href="#l23.68"></a><span id="l23.68">     let previousButton = document.getElementById(&quot;previous-slot&quot;);</span>
<a href="#l23.69"></a><span id="l23.69">     if (gUndoStack.length &gt; 0) {</span>
<a href="#l23.70"></a><span id="l23.70" class="difflineminus">-        previousButton.removeAttribute('disabled');</span>
<a href="#l23.71"></a><span id="l23.71" class="difflineplus">+        previousButton.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l23.72"></a><span id="l23.72">     } else {</span>
<a href="#l23.73"></a><span id="l23.73" class="difflineminus">-        previousButton.setAttribute('disabled', 'true');</span>
<a href="#l23.74"></a><span id="l23.74" class="difflineplus">+        previousButton.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l23.75"></a><span id="l23.75">     }</span>
<a href="#l23.76"></a><span id="l23.76"> }</span>
<a href="#l23.77"></a><span id="l23.77"> </span>
<a href="#l23.78"></a><span id="l23.78"> /**</span>
<a href="#l23.79"></a><span id="l23.79">  * Handler function called to advance to the next slot.</span>
<a href="#l23.80"></a><span id="l23.80">  */</span>
<a href="#l23.81"></a><span id="l23.81"> function onNextSlot() {</span>
<a href="#l23.82"></a><span id="l23.82">     // Store the current setting in the undo-stack.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -193,18 +193,18 @@</span>
<a href="#l24.4"></a><span id="l24.4">           // We always clone the first row. The problem is that the first row</span>
<a href="#l24.5"></a><span id="l24.5">           // could be focused. When we clone that row, we end up with a cloned</span>
<a href="#l24.6"></a><span id="l24.6">           // XUL textbox that has a focused attribute set.  Therefore we think</span>
<a href="#l24.7"></a><span id="l24.7">           // we're focused and don't properly refocus.  The best solution to this</span>
<a href="#l24.8"></a><span id="l24.8">           // would be to clone a template row that didn't really have any presentation,</span>
<a href="#l24.9"></a><span id="l24.9">           // rather than using the real visible first row of the listbox.</span>
<a href="#l24.10"></a><span id="l24.10">           // For now we'll just put in a hack that ensures the focused attribute</span>
<a href="#l24.11"></a><span id="l24.11">           // is never copied when the node is cloned.</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-          if (input.getAttribute('focused') != '') {</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineminus">-              input.removeAttribute('focused');</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineplus">+          if (input.getAttribute(&quot;focused&quot;) != &quot;&quot;) {</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineplus">+              input.removeAttribute(&quot;focused&quot;);</span>
<a href="#l24.16"></a><span id="l24.16">           }</span>
<a href="#l24.17"></a><span id="l24.17"> </span>
<a href="#l24.18"></a><span id="l24.18">           aParentNode.appendChild(newNode);</span>
<a href="#l24.19"></a><span id="l24.19"> </span>
<a href="#l24.20"></a><span id="l24.20">           // the template could have its fields disabled,</span>
<a href="#l24.21"></a><span id="l24.21">           // that's why we need to reset their status.</span>
<a href="#l24.22"></a><span id="l24.22">           input.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l24.23"></a><span id="l24.23">           userTypeIcon.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineat">@@ -238,17 +238,17 @@</span>
<a href="#l24.25"></a><span id="l24.25">           let cn = aAttendee.commonName || &quot;&quot;;</span>
<a href="#l24.26"></a><span id="l24.26">           let inputValue = cal.removeMailTo(aAttendee.id || &quot;&quot;);</span>
<a href="#l24.27"></a><span id="l24.27">           if (cn.length) {</span>
<a href="#l24.28"></a><span id="l24.28">               // Make the commonName appear in quotes if it contains a</span>
<a href="#l24.29"></a><span id="l24.29">               // character that could confuse the header parser</span>
<a href="#l24.30"></a><span id="l24.30">               if (cn.search(/[,;&lt;&gt;@]/) != -1) {</span>
<a href="#l24.31"></a><span id="l24.31">                   cn = '&quot;' + cn + '&quot;';</span>
<a href="#l24.32"></a><span id="l24.32">               }</span>
<a href="#l24.33"></a><span id="l24.33" class="difflineminus">-              inputValue = inputValue.length ? cn + ' &lt;' + inputValue + '&gt;' : cn;</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineplus">+              inputValue = inputValue.length ? cn + &quot; &lt;&quot; + inputValue + &quot;&gt;&quot; : cn;</span>
<a href="#l24.35"></a><span id="l24.35">           }</span>
<a href="#l24.36"></a><span id="l24.36"> </span>
<a href="#l24.37"></a><span id="l24.37">           // trim spaces if any</span>
<a href="#l24.38"></a><span id="l24.38">           inputValue = inputValue.trim();</span>
<a href="#l24.39"></a><span id="l24.39"> </span>
<a href="#l24.40"></a><span id="l24.40">           // don't set value with null, otherwise autocomplete stops working,</span>
<a href="#l24.41"></a><span id="l24.41">           // but make sure attendee and dirty are set</span>
<a href="#l24.42"></a><span id="l24.42">           if (inputValue.length) {</span>
<a href="#l24.43"></a><span id="l24.43" class="difflineat">@@ -347,18 +347,18 @@</span>
<a href="#l24.44"></a><span id="l24.44">               // We always clone the first row.  The problem is that the first row</span>
<a href="#l24.45"></a><span id="l24.45">               // could be focused.  When we clone that row, we end up with a cloned</span>
<a href="#l24.46"></a><span id="l24.46">               // XUL textbox that has a focused attribute set.  Therefore we think</span>
<a href="#l24.47"></a><span id="l24.47">               // we're focused and don't properly refocus.  The best solution to this</span>
<a href="#l24.48"></a><span id="l24.48">               // would be to clone a template row that didn't really have any presentation,</span>
<a href="#l24.49"></a><span id="l24.49">               // rather than using the real visible first row of the listbox.</span>
<a href="#l24.50"></a><span id="l24.50">               // For now we'll just put in a hack that ensures the focused attribute</span>
<a href="#l24.51"></a><span id="l24.51">               // is never copied when the node is cloned.</span>
<a href="#l24.52"></a><span id="l24.52" class="difflineminus">-              if (input.getAttribute('focused') != '') {</span>
<a href="#l24.53"></a><span id="l24.53" class="difflineminus">-                  input.removeAttribute('focused');</span>
<a href="#l24.54"></a><span id="l24.54" class="difflineplus">+              if (input.getAttribute(&quot;focused&quot;) != &quot;&quot;) {</span>
<a href="#l24.55"></a><span id="l24.55" class="difflineplus">+                  input.removeAttribute(&quot;focused&quot;);</span>
<a href="#l24.56"></a><span id="l24.56">               }</span>
<a href="#l24.57"></a><span id="l24.57"> </span>
<a href="#l24.58"></a><span id="l24.58">               // focus on new input widget</span>
<a href="#l24.59"></a><span id="l24.59">               if (aSetFocus) {</span>
<a href="#l24.60"></a><span id="l24.60">                   this.setFocus(newNode);</span>
<a href="#l24.61"></a><span id="l24.61">               }</span>
<a href="#l24.62"></a><span id="l24.62">           }</span>
<a href="#l24.63"></a><span id="l24.63">           return newNode;</span>
<a href="#l24.64"></a><span id="l24.64" class="difflineat">@@ -567,18 +567,18 @@</span>
<a href="#l24.65"></a><span id="l24.65">             let input = document.getAnonymousElementByAttribute(listitem, &quot;anonid&quot;, &quot;input&quot;);</span>
<a href="#l24.66"></a><span id="l24.66">             input.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l24.67"></a><span id="l24.67">             input.setAttribute(&quot;id&quot;, &quot;attendeeCol3#&quot; + rowNumber);</span>
<a href="#l24.68"></a><span id="l24.68"> </span>
<a href="#l24.69"></a><span id="l24.69">             input.attendee = newAttendee;</span>
<a href="#l24.70"></a><span id="l24.70">             input.value = entry;</span>
<a href="#l24.71"></a><span id="l24.71">             input.setAttribute(&quot;value&quot;, entry);</span>
<a href="#l24.72"></a><span id="l24.72">             input.setAttribute(&quot;dirty&quot;, &quot;true&quot;);</span>
<a href="#l24.73"></a><span id="l24.73" class="difflineminus">-            if (input.getAttribute('focused') != '') {</span>
<a href="#l24.74"></a><span id="l24.74" class="difflineminus">-                input.removeAttribute('focused');</span>
<a href="#l24.75"></a><span id="l24.75" class="difflineplus">+            if (input.getAttribute(&quot;focused&quot;) != &quot;&quot;) {</span>
<a href="#l24.76"></a><span id="l24.76" class="difflineplus">+                input.removeAttribute(&quot;focused&quot;);</span>
<a href="#l24.77"></a><span id="l24.77">             }</span>
<a href="#l24.78"></a><span id="l24.78"> </span>
<a href="#l24.79"></a><span id="l24.79">             let roleStatusIcon = document.getAnonymousElementByAttribute(listitem, &quot;anonid&quot;, &quot;rolestatus-icon&quot;);</span>
<a href="#l24.80"></a><span id="l24.80">             roleStatusIcon.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l24.81"></a><span id="l24.81">             roleStatusIcon.setAttribute(&quot;id&quot;, &quot;attendeeCol1#&quot; + rowNumber);</span>
<a href="#l24.82"></a><span id="l24.82">             roleStatusIcon.setAttribute(&quot;class&quot;, &quot;role-icon&quot;);</span>
<a href="#l24.83"></a><span id="l24.83">             roleStatusIcon.setAttribute(&quot;role&quot;, newAttendee.role);</span>
<a href="#l24.84"></a><span id="l24.84"> </span>
<a href="#l24.85"></a><span id="l24.85" class="difflineat">@@ -649,18 +649,18 @@</span>
<a href="#l24.86"></a><span id="l24.86">                   let entry = {</span>
<a href="#l24.87"></a><span id="l24.87">                       dirty: isdirty,</span>
<a href="#l24.88"></a><span id="l24.88">                       calid: email</span>
<a href="#l24.89"></a><span id="l24.89">                   };</span>
<a href="#l24.90"></a><span id="l24.90">                   list.push(entry);</span>
<a href="#l24.91"></a><span id="l24.91">               }</span>
<a href="#l24.92"></a><span id="l24.92">           }</span>
<a href="#l24.93"></a><span id="l24.93"> </span>
<a href="#l24.94"></a><span id="l24.94" class="difflineminus">-          let event = document.createEvent('Events');</span>
<a href="#l24.95"></a><span id="l24.95" class="difflineminus">-          event.initEvent('modify', true, false);</span>
<a href="#l24.96"></a><span id="l24.96" class="difflineplus">+          let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l24.97"></a><span id="l24.97" class="difflineplus">+          event.initEvent(&quot;modify&quot;, true, false);</span>
<a href="#l24.98"></a><span id="l24.98">           event.details = list;</span>
<a href="#l24.99"></a><span id="l24.99">           this.dispatchEvent(event);</span>
<a href="#l24.100"></a><span id="l24.100">         ]]&gt;&lt;/body&gt;</span>
<a href="#l24.101"></a><span id="l24.101">       &lt;/method&gt;</span>
<a href="#l24.102"></a><span id="l24.102"> </span>
<a href="#l24.103"></a><span id="l24.103">      &lt;method name=&quot;updateTooltip&quot;&gt;</span>
<a href="#l24.104"></a><span id="l24.104">       &lt;parameter name=&quot;targetIcon&quot;/&gt;</span>
<a href="#l24.105"></a><span id="l24.105">       &lt;body&gt;&lt;![CDATA[</span>
<a href="#l24.106"></a><span id="l24.106" class="difflineat">@@ -717,17 +717,17 @@</span>
<a href="#l24.107"></a><span id="l24.107">         ]]&gt;&lt;/body&gt;</span>
<a href="#l24.108"></a><span id="l24.108">       &lt;/method&gt;</span>
<a href="#l24.109"></a><span id="l24.109"> </span>
<a href="#l24.110"></a><span id="l24.110">       &lt;method name=&quot;calcContentHeight&quot;&gt;</span>
<a href="#l24.111"></a><span id="l24.111">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l24.112"></a><span id="l24.112">           let listbox =</span>
<a href="#l24.113"></a><span id="l24.113">               document.getAnonymousElementByAttribute(</span>
<a href="#l24.114"></a><span id="l24.114">                   this, &quot;anonid&quot;, &quot;listbox&quot;);</span>
<a href="#l24.115"></a><span id="l24.115" class="difflineminus">-          let items = listbox.getElementsByTagNameNS('*', 'listitem');</span>
<a href="#l24.116"></a><span id="l24.116" class="difflineplus">+          let items = listbox.getElementsByTagNameNS(&quot;*&quot;, &quot;listitem&quot;);</span>
<a href="#l24.117"></a><span id="l24.117">           this.mContentHeight = 0;</span>
<a href="#l24.118"></a><span id="l24.118">           if (items.length &gt; 0) {</span>
<a href="#l24.119"></a><span id="l24.119">               let i = 0;</span>
<a href="#l24.120"></a><span id="l24.120">               do {</span>
<a href="#l24.121"></a><span id="l24.121">                   this.mRowHeight = items[i].boxObject.height;</span>
<a href="#l24.122"></a><span id="l24.122">                   ++i;</span>
<a href="#l24.123"></a><span id="l24.123">               } while (i &lt; items.length &amp;&amp; !this.mRowHeight);</span>
<a href="#l24.124"></a><span id="l24.124">               this.mContentHeight = this.mRowHeight * items.length;</span>
<a href="#l24.125"></a><span id="l24.125" class="difflineat">@@ -808,17 +808,17 @@</span>
<a href="#l24.126"></a><span id="l24.126">       &lt;!-- This method returns the &lt;xul:listitem&gt; at row numer 'aRow' --&gt;</span>
<a href="#l24.127"></a><span id="l24.127">       &lt;method name=&quot;getListItem&quot;&gt;</span>
<a href="#l24.128"></a><span id="l24.128">         &lt;parameter name=&quot;aRow&quot;/&gt;</span>
<a href="#l24.129"></a><span id="l24.129">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l24.130"></a><span id="l24.130">           let listbox =</span>
<a href="#l24.131"></a><span id="l24.131">               document.getAnonymousElementByAttribute(</span>
<a href="#l24.132"></a><span id="l24.132">                   this, &quot;anonid&quot;, &quot;listbox&quot;);</span>
<a href="#l24.133"></a><span id="l24.133">           if (listbox &amp;&amp; aRow &gt; 0) {</span>
<a href="#l24.134"></a><span id="l24.134" class="difflineminus">-              let listitems = listbox.getElementsByTagNameNS('*', 'listitem');</span>
<a href="#l24.135"></a><span id="l24.135" class="difflineplus">+              let listitems = listbox.getElementsByTagNameNS(&quot;*&quot;, &quot;listitem&quot;);</span>
<a href="#l24.136"></a><span id="l24.136">               if (listitems &amp;&amp; listitems.length &gt;= aRow) {</span>
<a href="#l24.137"></a><span id="l24.137">                   return listitems[aRow - 1];</span>
<a href="#l24.138"></a><span id="l24.138">               }</span>
<a href="#l24.139"></a><span id="l24.139">           }</span>
<a href="#l24.140"></a><span id="l24.140">           return 0;</span>
<a href="#l24.141"></a><span id="l24.141">         ]]&gt;&lt;/body&gt;</span>
<a href="#l24.142"></a><span id="l24.142">       &lt;/method&gt;</span>
<a href="#l24.143"></a><span id="l24.143"> </span>
<a href="#l24.144"></a><span id="l24.144" class="difflineat">@@ -879,17 +879,17 @@</span>
<a href="#l24.145"></a><span id="l24.145">       &lt;/method&gt;</span>
<a href="#l24.146"></a><span id="l24.146"> </span>
<a href="#l24.147"></a><span id="l24.147">       &lt;method name=&quot;setFocus&quot;&gt;</span>
<a href="#l24.148"></a><span id="l24.148">         &lt;parameter name=&quot;aRow&quot;/&gt;</span>
<a href="#l24.149"></a><span id="l24.149">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l24.150"></a><span id="l24.150">           let self = this;</span>
<a href="#l24.151"></a><span id="l24.151">           let set_focus = function() {</span>
<a href="#l24.152"></a><span id="l24.152">               let node;</span>
<a href="#l24.153"></a><span id="l24.153" class="difflineminus">-              if (typeof aRow == 'number') {</span>
<a href="#l24.154"></a><span id="l24.154" class="difflineplus">+              if (typeof aRow == &quot;number&quot;) {</span>
<a href="#l24.155"></a><span id="l24.155">                 node = self.getListItem(aRow);</span>
<a href="#l24.156"></a><span id="l24.156">               } else {</span>
<a href="#l24.157"></a><span id="l24.157">                 node = aRow;</span>
<a href="#l24.158"></a><span id="l24.158">               }</span>
<a href="#l24.159"></a><span id="l24.159"> </span>
<a href="#l24.160"></a><span id="l24.160">               // do we need to scroll in order to see the selected row?</span>
<a href="#l24.161"></a><span id="l24.161">               let listbox =</span>
<a href="#l24.162"></a><span id="l24.162">                   document.getAnonymousElementByAttribute(</span>
<a href="#l24.163"></a><span id="l24.163" class="difflineat">@@ -933,17 +933,17 @@</span>
<a href="#l24.164"></a><span id="l24.164">       &lt;/method&gt;</span>
<a href="#l24.165"></a><span id="l24.165"> </span>
<a href="#l24.166"></a><span id="l24.166">       &lt;property name=&quot;numColumns&quot;&gt;</span>
<a href="#l24.167"></a><span id="l24.167">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l24.168"></a><span id="l24.168">           if (!this.mNumColumns) {</span>
<a href="#l24.169"></a><span id="l24.169">               let listbox =</span>
<a href="#l24.170"></a><span id="l24.170">                   document.getAnonymousElementByAttribute(</span>
<a href="#l24.171"></a><span id="l24.171">                       this, &quot;anonid&quot;, &quot;listbox&quot;);</span>
<a href="#l24.172"></a><span id="l24.172" class="difflineminus">-              let listCols = listbox.getElementsByTagNameNS('*', 'listcol');</span>
<a href="#l24.173"></a><span id="l24.173" class="difflineplus">+              let listCols = listbox.getElementsByTagNameNS(&quot;*&quot;, &quot;listcol&quot;);</span>
<a href="#l24.174"></a><span id="l24.174">               this.mNumColumns = listCols.length;</span>
<a href="#l24.175"></a><span id="l24.175">               if (!this.mNumColumns) {</span>
<a href="#l24.176"></a><span id="l24.176">                   this.mNumColumns = 1;</span>
<a href="#l24.177"></a><span id="l24.177">               }</span>
<a href="#l24.178"></a><span id="l24.178">           }</span>
<a href="#l24.179"></a><span id="l24.179">           return this.mNumColumns;</span>
<a href="#l24.180"></a><span id="l24.180">         ]]&gt;&lt;/getter&gt;</span>
<a href="#l24.181"></a><span id="l24.181">       &lt;/property&gt;</span>
<a href="#l24.182"></a><span id="l24.182" class="difflineat">@@ -964,17 +964,17 @@</span>
<a href="#l24.183"></a><span id="l24.183">         &lt;parameter name=&quot;noAdvance&quot;/&gt;</span>
<a href="#l24.184"></a><span id="l24.184">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l24.185"></a><span id="l24.185">           function parseHeaderValue(aMsgIAddressObject) {</span>
<a href="#l24.186"></a><span id="l24.186">               if (aMsgIAddressObject.name.match(/[&lt;&gt;@,]/)) {</span>
<a href="#l24.187"></a><span id="l24.187">                   // special handling only needed for a name with a comma which are not already quoted</span>
<a href="#l24.188"></a><span id="l24.188">                   return (aMsgIAddressObject.name.match(/^&quot;.*&quot;$/)</span>
<a href="#l24.189"></a><span id="l24.189">                           ? aMsgIAddressObject.name</span>
<a href="#l24.190"></a><span id="l24.190">                           : '&quot;' + aMsgIAddressObject.name + '&quot;'</span>
<a href="#l24.191"></a><span id="l24.191" class="difflineminus">-                         ) + ' &lt;' + aMsgIAddressObject.email + '&gt;';</span>
<a href="#l24.192"></a><span id="l24.192" class="difflineplus">+                         ) + &quot; &lt;&quot; + aMsgIAddressObject.email + &quot;&gt;&quot;;</span>
<a href="#l24.193"></a><span id="l24.193">               } else {</span>
<a href="#l24.194"></a><span id="l24.194">                   return aMsgIAddressObject.toString();</span>
<a href="#l24.195"></a><span id="l24.195">               }</span>
<a href="#l24.196"></a><span id="l24.196">           }</span>
<a href="#l24.197"></a><span id="l24.197"> </span>
<a href="#l24.198"></a><span id="l24.198">           let arrowLength = 1;</span>
<a href="#l24.199"></a><span id="l24.199">           if (element.value.includes(&quot;,&quot;) || element.value.match(/^[^&quot;].*[&lt;&gt;@,].*[^&quot;] &lt;.+@.+&gt;$/)) {</span>
<a href="#l24.200"></a><span id="l24.200">               let strippedAddresses = element.value.replace(/.* &gt;&gt; /, &quot;&quot;);</span>
<a href="#l24.201"></a><span id="l24.201" class="difflineat">@@ -1010,18 +1010,18 @@</span>
<a href="#l24.202"></a><span id="l24.202">                   this.appendNewRow(true);</span>
<a href="#l24.203"></a><span id="l24.203">               } else {</span>
<a href="#l24.204"></a><span id="l24.204">                   let input = this.getInputElement(row);</span>
<a href="#l24.205"></a><span id="l24.205">                   if (input.hasAttribute(&quot;disabled&quot;)) {</span>
<a href="#l24.206"></a><span id="l24.206">                       return;</span>
<a href="#l24.207"></a><span id="l24.207">                   }</span>
<a href="#l24.208"></a><span id="l24.208">                   this.setFocus(row);</span>
<a href="#l24.209"></a><span id="l24.209">               }</span>
<a href="#l24.210"></a><span id="l24.210" class="difflineminus">-              let event = document.createEvent('Events');</span>
<a href="#l24.211"></a><span id="l24.211" class="difflineminus">-              event.initEvent('rowchange', true, false);</span>
<a href="#l24.212"></a><span id="l24.212" class="difflineplus">+              let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l24.213"></a><span id="l24.213" class="difflineplus">+              event.initEvent(&quot;rowchange&quot;, true, false);</span>
<a href="#l24.214"></a><span id="l24.214">               event.details = row;</span>
<a href="#l24.215"></a><span id="l24.215">               this.dispatchEvent(event);</span>
<a href="#l24.216"></a><span id="l24.216">           }</span>
<a href="#l24.217"></a><span id="l24.217">         ]]&gt;&lt;/body&gt;</span>
<a href="#l24.218"></a><span id="l24.218">       &lt;/method&gt;</span>
<a href="#l24.219"></a><span id="l24.219"> </span>
<a href="#l24.220"></a><span id="l24.220">       &lt;method name=&quot;deleteHit&quot;&gt;</span>
<a href="#l24.221"></a><span id="l24.221">         &lt;parameter name=&quot;aElement&quot;/&gt;</span>
<a href="#l24.222"></a><span id="l24.222" class="difflineat">@@ -1034,18 +1034,18 @@</span>
<a href="#l24.223"></a><span id="l24.223">           let row = this.getRowByInputElement(aElement);</span>
<a href="#l24.224"></a><span id="l24.224">           this.deleteRow(row);</span>
<a href="#l24.225"></a><span id="l24.225">           if (row &gt; 0) {</span>
<a href="#l24.226"></a><span id="l24.226">               row = row - 1;</span>
<a href="#l24.227"></a><span id="l24.227">           }</span>
<a href="#l24.228"></a><span id="l24.228">           this.setFocus(row);</span>
<a href="#l24.229"></a><span id="l24.229">           this.onModify();</span>
<a href="#l24.230"></a><span id="l24.230"> </span>
<a href="#l24.231"></a><span id="l24.231" class="difflineminus">-          let event = document.createEvent('Events');</span>
<a href="#l24.232"></a><span id="l24.232" class="difflineminus">-          event.initEvent('rowchange', true, false);</span>
<a href="#l24.233"></a><span id="l24.233" class="difflineplus">+          let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l24.234"></a><span id="l24.234" class="difflineplus">+          event.initEvent(&quot;rowchange&quot;, true, false);</span>
<a href="#l24.235"></a><span id="l24.235">           event.details = row;</span>
<a href="#l24.236"></a><span id="l24.236">           this.dispatchEvent(event);</span>
<a href="#l24.237"></a><span id="l24.237">         ]]&gt;&lt;/body&gt;</span>
<a href="#l24.238"></a><span id="l24.238">       &lt;/method&gt;</span>
<a href="#l24.239"></a><span id="l24.239"> </span>
<a href="#l24.240"></a><span id="l24.240">       &lt;method name=&quot;deleteRow&quot;&gt;</span>
<a href="#l24.241"></a><span id="l24.241">         &lt;parameter name=&quot;aRow&quot;/&gt;</span>
<a href="#l24.242"></a><span id="l24.242">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l24.243"></a><span id="l24.243" class="difflineat">@@ -1433,18 +1433,18 @@</span>
<a href="#l24.244"></a><span id="l24.244">           this.mMargin -= offset;</span>
<a href="#l24.245"></a><span id="l24.245"> </span>
<a href="#l24.246"></a><span id="l24.246">           // Set the styles based on the calculations above for the 'selection-bar'.</span>
<a href="#l24.247"></a><span id="l24.247">           let style = &quot;width: &quot; + this.mWidth +</span>
<a href="#l24.248"></a><span id="l24.248">                       &quot;px; margin-inline-start: &quot; + this.mMargin +</span>
<a href="#l24.249"></a><span id="l24.249">                       &quot;px; margin-top: &quot; + this.mHeaderHeight + &quot;px;&quot;;</span>
<a href="#l24.250"></a><span id="l24.250">           this.mSelectionbar.setAttribute(&quot;style&quot;, style);</span>
<a href="#l24.251"></a><span id="l24.251"> </span>
<a href="#l24.252"></a><span id="l24.252" class="difflineminus">-          let event = document.createEvent('Events');</span>
<a href="#l24.253"></a><span id="l24.253" class="difflineminus">-          event.initEvent('timechange', true, false);</span>
<a href="#l24.254"></a><span id="l24.254" class="difflineplus">+          let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l24.255"></a><span id="l24.255" class="difflineplus">+          event.initEvent(&quot;timechange&quot;, true, false);</span>
<a href="#l24.256"></a><span id="l24.256">           event.startDate = this.mStartDate;</span>
<a href="#l24.257"></a><span id="l24.257">           event.endDate = this.mEndDate.clone();</span>
<a href="#l24.258"></a><span id="l24.258">           if (event.endDate.isDate) {</span>
<a href="#l24.259"></a><span id="l24.259">               event.endDate.day--;</span>
<a href="#l24.260"></a><span id="l24.260">           }</span>
<a href="#l24.261"></a><span id="l24.261">           event.endDate.makeImmutable();</span>
<a href="#l24.262"></a><span id="l24.262">           this.dispatchEvent(event);</span>
<a href="#l24.263"></a><span id="l24.263">         ]]&gt;&lt;/body&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -455,18 +455,18 @@</span>
<a href="#l25.4"></a><span id="l25.4">       &lt;/method&gt;</span>
<a href="#l25.5"></a><span id="l25.5"> </span>
<a href="#l25.6"></a><span id="l25.6">       &lt;method name=&quot;onLoad&quot;&gt;</span>
<a href="#l25.7"></a><span id="l25.7">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l25.8"></a><span id="l25.8">             this.initialize();</span>
<a href="#l25.9"></a><span id="l25.9">             let template =</span>
<a href="#l25.10"></a><span id="l25.10">                 document.getAnonymousElementByAttribute(</span>
<a href="#l25.11"></a><span id="l25.11">                     this, &quot;anonid&quot;, &quot;template&quot;);</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-            let event = document.createEvent('Events');</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">-            event.initEvent('timebar', true, false);</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+            let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+            event.initEvent(&quot;timebar&quot;, true, false);</span>
<a href="#l25.16"></a><span id="l25.16">             event.details = this.contentWidth;</span>
<a href="#l25.17"></a><span id="l25.17">             event.height = template.dayHeight;</span>
<a href="#l25.18"></a><span id="l25.18">             this.dispatchEvent(event);</span>
<a href="#l25.19"></a><span id="l25.19">         ]]&gt;&lt;/body&gt;</span>
<a href="#l25.20"></a><span id="l25.20">       &lt;/method&gt;</span>
<a href="#l25.21"></a><span id="l25.21"> </span>
<a href="#l25.22"></a><span id="l25.22">       &lt;method name=&quot;initialize&quot;&gt;</span>
<a href="#l25.23"></a><span id="l25.23">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineat">@@ -1195,18 +1195,18 @@</span>
<a href="#l25.25"></a><span id="l25.25">           // We always clone the first row.  The problem is that the first row</span>
<a href="#l25.26"></a><span id="l25.26">           // could be focused.  When we clone that row, we end up with a cloned</span>
<a href="#l25.27"></a><span id="l25.27">           // XUL textbox that has a focused attribute set.  Therefore we think</span>
<a href="#l25.28"></a><span id="l25.28">           // we're focused and don't properly refocus.  The best solution to this</span>
<a href="#l25.29"></a><span id="l25.29">           // would be to clone a template row that didn't really have any presentation,</span>
<a href="#l25.30"></a><span id="l25.30">           // rather than using the real visible first row of the listbox.</span>
<a href="#l25.31"></a><span id="l25.31">           // For now we'll just put in a hack that ensures the focused attribute</span>
<a href="#l25.32"></a><span id="l25.32">           // is never copied when the node is cloned.</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineminus">-          if (grid.getAttribute('focused') != '') {</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineminus">-              grid.removeAttribute('focused');</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineplus">+          if (grid.getAttribute(&quot;focused&quot;) != &quot;&quot;) {</span>
<a href="#l25.36"></a><span id="l25.36" class="difflineplus">+              grid.removeAttribute(&quot;focused&quot;);</span>
<a href="#l25.37"></a><span id="l25.37">           }</span>
<a href="#l25.38"></a><span id="l25.38">         ]]&gt;&lt;/body&gt;</span>
<a href="#l25.39"></a><span id="l25.39">       &lt;/method&gt;</span>
<a href="#l25.40"></a><span id="l25.40"> </span>
<a href="#l25.41"></a><span id="l25.41">       &lt;property name=&quot;scroll&quot;&gt;</span>
<a href="#l25.42"></a><span id="l25.42">         &lt;setter&gt;&lt;![CDATA[</span>
<a href="#l25.43"></a><span id="l25.43">           this.mScrollOffset = val;</span>
<a href="#l25.44"></a><span id="l25.44">           for (let i = 1; i &lt;= this.mMaxFreeBusy; i++) {</span>
<a href="#l25.45"></a><span id="l25.45" class="difflineat">@@ -1418,17 +1418,17 @@</span>
<a href="#l25.46"></a><span id="l25.46">       &lt;!-- This method returns the &lt;xul:listitem&gt; at row numer 'aRow' --&gt;</span>
<a href="#l25.47"></a><span id="l25.47">       &lt;method name=&quot;getListItem&quot;&gt;</span>
<a href="#l25.48"></a><span id="l25.48">         &lt;parameter name=&quot;aRow&quot;/&gt;</span>
<a href="#l25.49"></a><span id="l25.49">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l25.50"></a><span id="l25.50">           let listbox =</span>
<a href="#l25.51"></a><span id="l25.51">               document.getAnonymousElementByAttribute(</span>
<a href="#l25.52"></a><span id="l25.52">                   this, &quot;anonid&quot;, &quot;listbox&quot;);</span>
<a href="#l25.53"></a><span id="l25.53">           if (listbox &amp;&amp; aRow &gt; 0) {</span>
<a href="#l25.54"></a><span id="l25.54" class="difflineminus">-              let listitems = listbox.getElementsByTagNameNS('*', 'listitem');</span>
<a href="#l25.55"></a><span id="l25.55" class="difflineplus">+              let listitems = listbox.getElementsByTagNameNS(&quot;*&quot;, &quot;listitem&quot;);</span>
<a href="#l25.56"></a><span id="l25.56">               if (listitems &amp;&amp; listitems.length &gt;= aRow) {</span>
<a href="#l25.57"></a><span id="l25.57">                   return listitems[aRow - 1];</span>
<a href="#l25.58"></a><span id="l25.58">               }</span>
<a href="#l25.59"></a><span id="l25.59">           }</span>
<a href="#l25.60"></a><span id="l25.60">           return 0;</span>
<a href="#l25.61"></a><span id="l25.61">         ]]&gt;&lt;/body&gt;</span>
<a href="#l25.62"></a><span id="l25.62">       &lt;/method&gt;</span>
<a href="#l25.63"></a><span id="l25.63"> </span>
<a href="#l25.64"></a><span id="l25.64" class="difflineat">@@ -1497,17 +1497,17 @@</span>
<a href="#l25.65"></a><span id="l25.65">         ]]&gt;&lt;/body&gt;</span>
<a href="#l25.66"></a><span id="l25.66">       &lt;/method&gt;</span>
<a href="#l25.67"></a><span id="l25.67"> </span>
<a href="#l25.68"></a><span id="l25.68">       &lt;method name=&quot;calcContentHeight&quot;&gt;</span>
<a href="#l25.69"></a><span id="l25.69">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l25.70"></a><span id="l25.70">           let listbox =</span>
<a href="#l25.71"></a><span id="l25.71">               document.getAnonymousElementByAttribute(</span>
<a href="#l25.72"></a><span id="l25.72">                   this, &quot;anonid&quot;, &quot;listbox&quot;);</span>
<a href="#l25.73"></a><span id="l25.73" class="difflineminus">-          let items = listbox.getElementsByTagNameNS('*', 'listitem');</span>
<a href="#l25.74"></a><span id="l25.74" class="difflineplus">+          let items = listbox.getElementsByTagNameNS(&quot;*&quot;, &quot;listitem&quot;);</span>
<a href="#l25.75"></a><span id="l25.75">           this.mContentHeight = 0;</span>
<a href="#l25.76"></a><span id="l25.76">           if (items.length &gt; 0) {</span>
<a href="#l25.77"></a><span id="l25.77">               let i = 0;</span>
<a href="#l25.78"></a><span id="l25.78">               do {</span>
<a href="#l25.79"></a><span id="l25.79">                   this.mRowHeight = items[i].boxObject.height;</span>
<a href="#l25.80"></a><span id="l25.80">                   ++i;</span>
<a href="#l25.81"></a><span id="l25.81">               } while (i &lt; items.length &amp;&amp; !this.mRowHeight);</span>
<a href="#l25.82"></a><span id="l25.82">               this.mContentHeight = this.mRowHeight * items.length;</span>
<a href="#l25.83"></a><span id="l25.83" class="difflineat">@@ -1570,17 +1570,17 @@</span>
<a href="#l25.84"></a><span id="l25.84">       &lt;/method&gt;</span>
<a href="#l25.85"></a><span id="l25.85"> </span>
<a href="#l25.86"></a><span id="l25.86">       &lt;property name=&quot;numColumns&quot;&gt;</span>
<a href="#l25.87"></a><span id="l25.87">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l25.88"></a><span id="l25.88">           if (!this.mNumColumns) {</span>
<a href="#l25.89"></a><span id="l25.89">               let listbox =</span>
<a href="#l25.90"></a><span id="l25.90">                   document.getAnonymousElementByAttribute(</span>
<a href="#l25.91"></a><span id="l25.91">                       this, &quot;anonid&quot;, &quot;listbox&quot;);</span>
<a href="#l25.92"></a><span id="l25.92" class="difflineminus">-              let listCols = listbox.getElementsByTagNameNS('*', 'listcol');</span>
<a href="#l25.93"></a><span id="l25.93" class="difflineplus">+              let listCols = listbox.getElementsByTagNameNS(&quot;*&quot;, &quot;listcol&quot;);</span>
<a href="#l25.94"></a><span id="l25.94">               this.mNumColumns = listCols.length || 1;</span>
<a href="#l25.95"></a><span id="l25.95">           }</span>
<a href="#l25.96"></a><span id="l25.96">           return this.mNumColumns;</span>
<a href="#l25.97"></a><span id="l25.97">         ]]&gt;&lt;/getter&gt;</span>
<a href="#l25.98"></a><span id="l25.98">       &lt;/property&gt;</span>
<a href="#l25.99"></a><span id="l25.99"> </span>
<a href="#l25.100"></a><span id="l25.100">       &lt;method name=&quot;initTimeRange&quot;&gt;</span>
<a href="#l25.101"></a><span id="l25.101">         &lt;body&gt;&lt;![CDATA[</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -52,17 +52,17 @@ function onLoad() {</span>
<a href="#l26.4"></a><span id="l26.4">                 rule = cal.wrapInstance(rules[0], Components.interfaces.calIRecurrenceRule);</span>
<a href="#l26.5"></a><span id="l26.5">             }</span>
<a href="#l26.6"></a><span id="l26.6">         } catch (ex) {</span>
<a href="#l26.7"></a><span id="l26.7">             Components.utils.reportError(ex);</span>
<a href="#l26.8"></a><span id="l26.8">         }</span>
<a href="#l26.9"></a><span id="l26.9">     }</span>
<a href="#l26.10"></a><span id="l26.10">     if (!rule) {</span>
<a href="#l26.11"></a><span id="l26.11">         rule = createRecurrenceRule();</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-        rule.type = 'DAILY';</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+        rule.type = &quot;DAILY&quot;;</span>
<a href="#l26.14"></a><span id="l26.14">         rule.interval = 1;</span>
<a href="#l26.15"></a><span id="l26.15">         rule.count = -1;</span>
<a href="#l26.16"></a><span id="l26.16">     }</span>
<a href="#l26.17"></a><span id="l26.17">     initializeControls(rule);</span>
<a href="#l26.18"></a><span id="l26.18"> </span>
<a href="#l26.19"></a><span id="l26.19">     // Update controls</span>
<a href="#l26.20"></a><span id="l26.20">     updateRecurrenceDeck();</span>
<a href="#l26.21"></a><span id="l26.21"> </span>
<a href="#l26.22"></a><span id="l26.22" class="difflineat">@@ -476,30 +476,30 @@ function disableOrEnable(item) {</span>
<a href="#l26.23"></a><span id="l26.23">  * Disables all fields that have an attribute that matches the argument and is</span>
<a href="#l26.24"></a><span id="l26.24">  * set to &quot;true&quot;.</span>
<a href="#l26.25"></a><span id="l26.25">  *</span>
<a href="#l26.26"></a><span id="l26.26">  * @param aAttributeName    The attribute to search for.</span>
<a href="#l26.27"></a><span id="l26.27">  */</span>
<a href="#l26.28"></a><span id="l26.28"> function disableRecurrenceFields(aAttributeName) {</span>
<a href="#l26.29"></a><span id="l26.29">     let disableElements = document.getElementsByAttribute(aAttributeName, &quot;true&quot;);</span>
<a href="#l26.30"></a><span id="l26.30">     for (let i = 0; i &lt; disableElements.length; i++) {</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineminus">-        disableElements[i].setAttribute('disabled', 'true');</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineplus">+        disableElements[i].setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l26.33"></a><span id="l26.33">     }</span>
<a href="#l26.34"></a><span id="l26.34"> }</span>
<a href="#l26.35"></a><span id="l26.35"> </span>
<a href="#l26.36"></a><span id="l26.36"> /**</span>
<a href="#l26.37"></a><span id="l26.37">  * Enables all fields that have an attribute that matches the argument and is</span>
<a href="#l26.38"></a><span id="l26.38">  * set to &quot;true&quot;.</span>
<a href="#l26.39"></a><span id="l26.39">  *</span>
<a href="#l26.40"></a><span id="l26.40">  * @param aAttributeName    The attribute to search for.</span>
<a href="#l26.41"></a><span id="l26.41">  */</span>
<a href="#l26.42"></a><span id="l26.42"> function enableRecurrenceFields(aAttributeName) {</span>
<a href="#l26.43"></a><span id="l26.43">     let enableElements = document.getElementsByAttribute(aAttributeName, &quot;true&quot;);</span>
<a href="#l26.44"></a><span id="l26.44">     for (let i = 0; i &lt; enableElements.length; i++) {</span>
<a href="#l26.45"></a><span id="l26.45" class="difflineminus">-        enableElements[i].removeAttribute('disabled');</span>
<a href="#l26.46"></a><span id="l26.46" class="difflineplus">+        enableElements[i].removeAttribute(&quot;disabled&quot;);</span>
<a href="#l26.47"></a><span id="l26.47">     }</span>
<a href="#l26.48"></a><span id="l26.48"> }</span>
<a href="#l26.49"></a><span id="l26.49"> </span>
<a href="#l26.50"></a><span id="l26.50"> /**</span>
<a href="#l26.51"></a><span id="l26.51">  * Split rules into negative and positive rules.</span>
<a href="#l26.52"></a><span id="l26.52">  *</span>
<a href="#l26.53"></a><span id="l26.53">  * XXX This function is duplicate from calendar-dialog-utils.js, which we may</span>
<a href="#l26.54"></a><span id="l26.54">  * want to include in this dialog.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-print-dialog.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-print-dialog.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -80,25 +80,25 @@ function getPrintSettings(receiverFunc) </span>
<a href="#l27.4"></a><span id="l27.4">     settings.end = null;</span>
<a href="#l27.5"></a><span id="l27.5">     settings.eventList = [];</span>
<a href="#l27.6"></a><span id="l27.6">     settings.printEvents = document.getElementById(&quot;events&quot;).checked;</span>
<a href="#l27.7"></a><span id="l27.7">     settings.printTasks = document.getElementById(&quot;tasks&quot;).checked;</span>
<a href="#l27.8"></a><span id="l27.8">     settings.printCompletedTasks = document.getElementById(&quot;completed-tasks&quot;).checked;</span>
<a href="#l27.9"></a><span id="l27.9">     settings.printTasksWithNoDueDate = document.getElementById(&quot;tasks-with-no-due-date&quot;).checked;</span>
<a href="#l27.10"></a><span id="l27.10">     let theView = getCalendarView();</span>
<a href="#l27.11"></a><span id="l27.11">     switch (document.getElementById(&quot;view-field&quot;).selectedItem.value) {</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-    case 'currentView':</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineminus">-    case '': // just in case</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineplus">+    case &quot;currentView&quot;:</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineplus">+    case &quot;&quot;: // just in case</span>
<a href="#l27.16"></a><span id="l27.16">         settings.start = theView.startDay.clone();</span>
<a href="#l27.17"></a><span id="l27.17">         settings.end = theView.endDay.clone();</span>
<a href="#l27.18"></a><span id="l27.18">         settings.end.day += 1;</span>
<a href="#l27.19"></a><span id="l27.19">         settings.start.isDate = false;</span>
<a href="#l27.20"></a><span id="l27.20">         settings.end.isDate = false;</span>
<a href="#l27.21"></a><span id="l27.21">         break;</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineminus">-    case 'selected': {</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineplus">+    case &quot;selected&quot;: {</span>
<a href="#l27.24"></a><span id="l27.24">         let selectedItems = theView.getSelectedItems({});</span>
<a href="#l27.25"></a><span id="l27.25">         settings.eventList = selectedItems.filter(function(item) {</span>
<a href="#l27.26"></a><span id="l27.26">             if (cal.isEvent(item) &amp;&amp; !settings.printEvents) {</span>
<a href="#l27.27"></a><span id="l27.27">                 return false;</span>
<a href="#l27.28"></a><span id="l27.28">             }</span>
<a href="#l27.29"></a><span id="l27.29">             if (cal.isToDo(item) &amp;&amp; !settings.printTasks) {</span>
<a href="#l27.30"></a><span id="l27.30">                 return false;</span>
<a href="#l27.31"></a><span id="l27.31">             }</span>
<a href="#l27.32"></a><span id="l27.32" class="difflineat">@@ -113,17 +113,17 @@ function getPrintSettings(receiverFunc) </span>
<a href="#l27.33"></a><span id="l27.33">                 settings.eventList.push(task);</span>
<a href="#l27.34"></a><span id="l27.34">             }</span>
<a href="#l27.35"></a><span id="l27.35">         }</span>
<a href="#l27.36"></a><span id="l27.36"> </span>
<a href="#l27.37"></a><span id="l27.37">         // We've set the event list above, no need to fetch items below.</span>
<a href="#l27.38"></a><span id="l27.38">         requiresFetch = false;</span>
<a href="#l27.39"></a><span id="l27.39">         break;</span>
<a href="#l27.40"></a><span id="l27.40">     }</span>
<a href="#l27.41"></a><span id="l27.41" class="difflineminus">-    case 'custom':</span>
<a href="#l27.42"></a><span id="l27.42" class="difflineplus">+    case &quot;custom&quot;:</span>
<a href="#l27.43"></a><span id="l27.43">         // We return the time from the timepickers using the selected</span>
<a href="#l27.44"></a><span id="l27.44">         // timezone, as not doing so in timezones with a positive offset</span>
<a href="#l27.45"></a><span id="l27.45">         // from UTC may cause the printout to include the wrong days.</span>
<a href="#l27.46"></a><span id="l27.46">         let currentTimezone = cal.calendarDefaultTimezone();</span>
<a href="#l27.47"></a><span id="l27.47">         settings.start = cal.jsDateToDateTime(document.getElementById(&quot;start-date-picker&quot;).value);</span>
<a href="#l27.48"></a><span id="l27.48">         settings.start = settings.start.getInTimezone(currentTimezone);</span>
<a href="#l27.49"></a><span id="l27.49">         settings.end = cal.jsDateToDateTime(document.getElementById(&quot;end-date-picker&quot;).value);</span>
<a href="#l27.50"></a><span id="l27.50">         settings.end = settings.end.getInTimezone(currentTimezone);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-properties-dialog.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-properties-dialog.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -14,17 +14,17 @@ var gCalendar;</span>
<a href="#l28.4"></a><span id="l28.4"> </span>
<a href="#l28.5"></a><span id="l28.5"> /**</span>
<a href="#l28.6"></a><span id="l28.6">  * This function gets called when the calendar properties dialog gets opened. To</span>
<a href="#l28.7"></a><span id="l28.7">  * open the window, use an object as argument. The object needs a 'calendar'</span>
<a href="#l28.8"></a><span id="l28.8">  * attribute that passes the calendar in question.</span>
<a href="#l28.9"></a><span id="l28.9">  */</span>
<a href="#l28.10"></a><span id="l28.10"> function onLoad() {</span>
<a href="#l28.11"></a><span id="l28.11">     gCalendar = window.arguments[0].calendar;</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-    let calColor = gCalendar.getProperty('color');</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+    let calColor = gCalendar.getProperty(&quot;color&quot;);</span>
<a href="#l28.14"></a><span id="l28.14"> </span>
<a href="#l28.15"></a><span id="l28.15">     document.getElementById(&quot;calendar-name&quot;).value = gCalendar.name;</span>
<a href="#l28.16"></a><span id="l28.16">     document.getElementById(&quot;calendar-color&quot;).value = calColor || &quot;#A8C2E1&quot;;</span>
<a href="#l28.17"></a><span id="l28.17">     document.getElementById(&quot;calendar-uri&quot;).value = gCalendar.uri.spec;</span>
<a href="#l28.18"></a><span id="l28.18">     document.getElementById(&quot;read-only&quot;).checked = gCalendar.readOnly;</span>
<a href="#l28.19"></a><span id="l28.19"> </span>
<a href="#l28.20"></a><span id="l28.20">     // Set up refresh interval</span>
<a href="#l28.21"></a><span id="l28.21">     initRefreshInterval();</span>
<a href="#l28.22"></a><span id="l28.22" class="difflineat">@@ -37,17 +37,17 @@ function onLoad() {</span>
<a href="#l28.23"></a><span id="l28.23">         cacheBox.setAttribute(&quot;disable-capability&quot;, &quot;true&quot;);</span>
<a href="#l28.24"></a><span id="l28.24">         cacheBox.hidden = true;</span>
<a href="#l28.25"></a><span id="l28.25">         cacheBox.disabled = true;</span>
<a href="#l28.26"></a><span id="l28.26">     }</span>
<a href="#l28.27"></a><span id="l28.27">     cacheBox.checked = alwaysCache || (canCache &amp;&amp; gCalendar.getProperty(&quot;cache.enabled&quot;));</span>
<a href="#l28.28"></a><span id="l28.28"> </span>
<a href="#l28.29"></a><span id="l28.29">     // Set up the show alarms row and checkbox</span>
<a href="#l28.30"></a><span id="l28.30">     let suppressAlarmsRow = document.getElementById(&quot;calendar-suppressAlarms-row&quot;);</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineminus">-    let suppressAlarms = gCalendar.getProperty('suppressAlarms');</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineplus">+    let suppressAlarms = gCalendar.getProperty(&quot;suppressAlarms&quot;);</span>
<a href="#l28.33"></a><span id="l28.33">     document.getElementById(&quot;fire-alarms&quot;).checked = !suppressAlarms;</span>
<a href="#l28.34"></a><span id="l28.34"> </span>
<a href="#l28.35"></a><span id="l28.35">     suppressAlarmsRow.hidden =</span>
<a href="#l28.36"></a><span id="l28.36">         (gCalendar.getProperty(&quot;capabilities.alarms.popup.supported&quot;) === false);</span>
<a href="#l28.37"></a><span id="l28.37"> </span>
<a href="#l28.38"></a><span id="l28.38">     // Set up the disabled checkbox</span>
<a href="#l28.39"></a><span id="l28.39">     let calendarDisabled = false;</span>
<a href="#l28.40"></a><span id="l28.40">     if (gCalendar.getProperty(&quot;force-disabled&quot;)) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/base/content/import-export.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/base/content/import-export.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -27,23 +27,23 @@ function loadEventsFromFile(aCalendar) {</span>
<a href="#l29.4"></a><span id="l29.4">             calGetString(&quot;calendar&quot;, &quot;filepickerTitleImport&quot;),</span>
<a href="#l29.5"></a><span id="l29.5">             nsIFilePicker.modeOpen);</span>
<a href="#l29.6"></a><span id="l29.6">     fp.defaultExtension = &quot;ics&quot;;</span>
<a href="#l29.7"></a><span id="l29.7"> </span>
<a href="#l29.8"></a><span id="l29.8">     // Get a list of importers</span>
<a href="#l29.9"></a><span id="l29.9">     let contractids = [];</span>
<a href="#l29.10"></a><span id="l29.10">     let catman = Components.classes[&quot;@mozilla.org/categorymanager;1&quot;]</span>
<a href="#l29.11"></a><span id="l29.11">                            .getService(Components.interfaces.nsICategoryManager);</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-    let catenum = catman.enumerateCategory('cal-importers');</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+    let catenum = catman.enumerateCategory(&quot;cal-importers&quot;);</span>
<a href="#l29.14"></a><span id="l29.14">     let currentListLength = 0;</span>
<a href="#l29.15"></a><span id="l29.15">     let defaultCIDIndex = 0;</span>
<a href="#l29.16"></a><span id="l29.16">     while (catenum.hasMoreElements()) {</span>
<a href="#l29.17"></a><span id="l29.17">         let entry = catenum.getNext();</span>
<a href="#l29.18"></a><span id="l29.18">         entry = entry.QueryInterface(Components.interfaces.nsISupportsCString);</span>
<a href="#l29.19"></a><span id="l29.19" class="difflineminus">-        let contractid = catman.getCategoryEntry('cal-importers', entry);</span>
<a href="#l29.20"></a><span id="l29.20" class="difflineplus">+        let contractid = catman.getCategoryEntry(&quot;cal-importers&quot;, entry);</span>
<a href="#l29.21"></a><span id="l29.21">         let importer;</span>
<a href="#l29.22"></a><span id="l29.22">         try {</span>
<a href="#l29.23"></a><span id="l29.23">             importer = Components.classes[contractid]</span>
<a href="#l29.24"></a><span id="l29.24">                                  .getService(Components.interfaces.calIImporter);</span>
<a href="#l29.25"></a><span id="l29.25">         } catch (e) {</span>
<a href="#l29.26"></a><span id="l29.26">             cal.WARN(&quot;Could not initialize importer: &quot; + contractid + &quot;\nError: &quot; + e);</span>
<a href="#l29.27"></a><span id="l29.27">             continue;</span>
<a href="#l29.28"></a><span id="l29.28">         }</span>
<a href="#l29.29"></a><span id="l29.29" class="difflineat">@@ -223,23 +223,23 @@ function saveEventsToFile(calendarEventA</span>
<a href="#l29.30"></a><span id="l29.30">     }</span>
<a href="#l29.31"></a><span id="l29.31"> </span>
<a href="#l29.32"></a><span id="l29.32">     fp.defaultExtension = &quot;ics&quot;;</span>
<a href="#l29.33"></a><span id="l29.33"> </span>
<a href="#l29.34"></a><span id="l29.34">     // Get a list of exporters</span>
<a href="#l29.35"></a><span id="l29.35">     let contractids = [];</span>
<a href="#l29.36"></a><span id="l29.36">     let catman = Components.classes[&quot;@mozilla.org/categorymanager;1&quot;]</span>
<a href="#l29.37"></a><span id="l29.37">                            .getService(Components.interfaces.nsICategoryManager);</span>
<a href="#l29.38"></a><span id="l29.38" class="difflineminus">-    let catenum = catman.enumerateCategory('cal-exporters');</span>
<a href="#l29.39"></a><span id="l29.39" class="difflineplus">+    let catenum = catman.enumerateCategory(&quot;cal-exporters&quot;);</span>
<a href="#l29.40"></a><span id="l29.40">     let currentListLength = 0;</span>
<a href="#l29.41"></a><span id="l29.41">     let defaultCIDIndex = 0;</span>
<a href="#l29.42"></a><span id="l29.42">     while (catenum.hasMoreElements()) {</span>
<a href="#l29.43"></a><span id="l29.43">         let entry = catenum.getNext();</span>
<a href="#l29.44"></a><span id="l29.44">         entry = entry.QueryInterface(Components.interfaces.nsISupportsCString);</span>
<a href="#l29.45"></a><span id="l29.45" class="difflineminus">-        let contractid = catman.getCategoryEntry('cal-exporters', entry);</span>
<a href="#l29.46"></a><span id="l29.46" class="difflineplus">+        let contractid = catman.getCategoryEntry(&quot;cal-exporters&quot;, entry);</span>
<a href="#l29.47"></a><span id="l29.47">         let exporter;</span>
<a href="#l29.48"></a><span id="l29.48">         try {</span>
<a href="#l29.49"></a><span id="l29.49">             exporter = Components.classes[contractid]</span>
<a href="#l29.50"></a><span id="l29.50">                                  .getService(Components.interfaces.calIExporter);</span>
<a href="#l29.51"></a><span id="l29.51">         } catch (e) {</span>
<a href="#l29.52"></a><span id="l29.52">             cal.WARN(&quot;Could not initialize exporter: &quot; + contractid + &quot;\nError: &quot; + e);</span>
<a href="#l29.53"></a><span id="l29.53">             continue;</span>
<a href="#l29.54"></a><span id="l29.54">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/calendar/base/content/preferences/editCategory.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/calendar/base/content/preferences/editCategory.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -44,36 +44,36 @@ function doOK() {</span>
<a href="#l30.4"></a><span id="l30.4"> function categoryNameChanged() {</span>
<a href="#l30.5"></a><span id="l30.5">     let newValue = document.getElementById(&quot;categoryName&quot;).value;</span>
<a href="#l30.6"></a><span id="l30.6"> </span>
<a href="#l30.7"></a><span id="l30.7">     // The user removed the category name, assign the color automatically again.</span>
<a href="#l30.8"></a><span id="l30.8">     if (newValue == &quot;&quot;) {</span>
<a href="#l30.9"></a><span id="l30.9">         customColorSelected = false;</span>
<a href="#l30.10"></a><span id="l30.10">     }</span>
<a href="#l30.11"></a><span id="l30.11"> </span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-    if (!customColorSelected &amp;&amp; document.getElementById('useColor').checked) {</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+    if (!customColorSelected &amp;&amp; document.getElementById(&quot;useColor&quot;).checked) {</span>
<a href="#l30.14"></a><span id="l30.14">         // Color is wanted, choose the color based on the category name's hash.</span>
<a href="#l30.15"></a><span id="l30.15">         document.getElementById(&quot;categoryColor&quot;).value = cal.hashColor(newValue);</span>
<a href="#l30.16"></a><span id="l30.16">     }</span>
<a href="#l30.17"></a><span id="l30.17"> }</span>
<a href="#l30.18"></a><span id="l30.18"> </span>
<a href="#l30.19"></a><span id="l30.19"> /**</span>
<a href="#l30.20"></a><span id="l30.20">  * Handler function to be called when the color picker's color has been changed.</span>
<a href="#l30.21"></a><span id="l30.21">  */</span>
<a href="#l30.22"></a><span id="l30.22"> function colorPickerChanged() {</span>
<a href="#l30.23"></a><span id="l30.23" class="difflineminus">-    document.getElementById('useColor').checked = true;</span>
<a href="#l30.24"></a><span id="l30.24" class="difflineplus">+    document.getElementById(&quot;useColor&quot;).checked = true;</span>
<a href="#l30.25"></a><span id="l30.25">     customColorSelected = true;</span>
<a href="#l30.26"></a><span id="l30.26"> }</span>
<a href="#l30.27"></a><span id="l30.27"> </span>
<a href="#l30.28"></a><span id="l30.28"> /**</span>
<a href="#l30.29"></a><span id="l30.29">  * Handler called when the use color checkbox is toggled.</span>
<a href="#l30.30"></a><span id="l30.30">  */</span>
<a href="#l30.31"></a><span id="l30.31"> function toggleColor() {</span>
<a href="#l30.32"></a><span id="l30.32" class="difflineminus">-    let useColor = document.getElementById('useColor').checked;</span>
<a href="#l30.33"></a><span id="l30.33" class="difflineminus">-    let categoryColor = document.getElementById('categoryColor');</span>
<a href="#l30.34"></a><span id="l30.34" class="difflineplus">+    let useColor = document.getElementById(&quot;useColor&quot;).checked;</span>
<a href="#l30.35"></a><span id="l30.35" class="difflineplus">+    let categoryColor = document.getElementById(&quot;categoryColor&quot;);</span>
<a href="#l30.36"></a><span id="l30.36"> </span>
<a href="#l30.37"></a><span id="l30.37">     if (useColor) {</span>
<a href="#l30.38"></a><span id="l30.38">         categoryColor.setAttribute(&quot;type&quot;, &quot;color&quot;);</span>
<a href="#l30.39"></a><span id="l30.39">         if (toggleColor.lastColor) {</span>
<a href="#l30.40"></a><span id="l30.40">             categoryColor.value = toggleColor.lastColor;</span>
<a href="#l30.41"></a><span id="l30.41">         }</span>
<a href="#l30.42"></a><span id="l30.42">     } else {</span>
<a href="#l30.43"></a><span id="l30.43">         categoryColor.setAttribute(&quot;type&quot;, &quot;button&quot;);</span>
<a href="#l30.44"></a><span id="l30.44" class="difflineat">@@ -82,17 +82,17 @@ function toggleColor() {</span>
<a href="#l30.45"></a><span id="l30.45">     }</span>
<a href="#l30.46"></a><span id="l30.46"> }</span>
<a href="#l30.47"></a><span id="l30.47"> </span>
<a href="#l30.48"></a><span id="l30.48"> /**</span>
<a href="#l30.49"></a><span id="l30.49">  * Click handler for the color picker. Turns the button back into a colorpicker</span>
<a href="#l30.50"></a><span id="l30.50">  * when clicked.</span>
<a href="#l30.51"></a><span id="l30.51">  */</span>
<a href="#l30.52"></a><span id="l30.52"> function clickColor() {</span>
<a href="#l30.53"></a><span id="l30.53" class="difflineminus">-    let categoryColor = document.getElementById('categoryColor');</span>
<a href="#l30.54"></a><span id="l30.54" class="difflineplus">+    let categoryColor = document.getElementById(&quot;categoryColor&quot;);</span>
<a href="#l30.55"></a><span id="l30.55">     if (categoryColor.getAttribute(&quot;type&quot;) == &quot;button&quot;) {</span>
<a href="#l30.56"></a><span id="l30.56">         colorPickerChanged();</span>
<a href="#l30.57"></a><span id="l30.57">         toggleColor();</span>
<a href="#l30.58"></a><span id="l30.58">         categoryColor.click();</span>
<a href="#l30.59"></a><span id="l30.59">     }</span>
<a href="#l30.60"></a><span id="l30.60"> }</span>
<a href="#l30.61"></a><span id="l30.61"> </span>
<a href="#l30.62"></a><span id="l30.62"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/calendar/base/content/today-pane.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/calendar/base/content/today-pane.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -126,19 +126,19 @@ var TodayPane = {</span>
<a href="#l31.4"></a><span id="l31.4">                 switchCalendarView(&quot;day&quot;, true);</span>
<a href="#l31.5"></a><span id="l31.5">             } else if (aEvent.target.id == &quot;currentWeek-label&quot;) {</span>
<a href="#l31.6"></a><span id="l31.6">                 switchCalendarView(&quot;week&quot;, true);</span>
<a href="#l31.7"></a><span id="l31.7">             } else if (aEvent.target.parentNode.id == &quot;monthNameContainer&quot;) {</span>
<a href="#l31.8"></a><span id="l31.8">                 switchCalendarView(&quot;month&quot;, true);</span>
<a href="#l31.9"></a><span id="l31.9">             } else {</span>
<a href="#l31.10"></a><span id="l31.10">                 return;</span>
<a href="#l31.11"></a><span id="l31.11">             }</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-            let title = document.getElementById('calendar-tab-button')</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineminus">-                            .getAttribute('tooltiptext');</span>
<a href="#l31.14"></a><span id="l31.14" class="difflineminus">-            document.getElementById('tabmail').openTab('calendar', { title: title });</span>
<a href="#l31.15"></a><span id="l31.15" class="difflineplus">+            let title = document.getElementById(&quot;calendar-tab-button&quot;)</span>
<a href="#l31.16"></a><span id="l31.16" class="difflineplus">+                            .getAttribute(&quot;tooltiptext&quot;);</span>
<a href="#l31.17"></a><span id="l31.17" class="difflineplus">+            document.getElementById(&quot;tabmail&quot;).openTab(&quot;calendar&quot;, { title: title });</span>
<a href="#l31.18"></a><span id="l31.18">             currentView().goToDay(agendaListbox.today.start);</span>
<a href="#l31.19"></a><span id="l31.19">         }</span>
<a href="#l31.20"></a><span id="l31.20">     },</span>
<a href="#l31.21"></a><span id="l31.21"> </span>
<a href="#l31.22"></a><span id="l31.22">     /**</span>
<a href="#l31.23"></a><span id="l31.23">      * Set conditions about start dragging on day-label or start switching</span>
<a href="#l31.24"></a><span id="l31.24">      * with time on navigation buttons.</span>
<a href="#l31.25"></a><span id="l31.25">      */</span>
<a href="#l31.26"></a><span id="l31.26" class="difflineat">@@ -243,17 +243,17 @@ var TodayPane = {</span>
<a href="#l31.27"></a><span id="l31.27">             aEvent.type == &quot;mouseout&quot; &amp;&amp;</span>
<a href="#l31.28"></a><span id="l31.28">              element.id != &quot;messengerWindow&quot;) {</span>
<a href="#l31.29"></a><span id="l31.29">             return;</span>
<a href="#l31.30"></a><span id="l31.30">         }</span>
<a href="#l31.31"></a><span id="l31.31">         if (TodayPane.minidayTimer) {</span>
<a href="#l31.32"></a><span id="l31.32">             clearTimeout(TodayPane.minidayTimer);</span>
<a href="#l31.33"></a><span id="l31.33">             delete TodayPane.minidayTimer;</span>
<a href="#l31.34"></a><span id="l31.34">             if (TodayPane.switchCounter == 0 &amp;&amp; !TodayPane.minidayDrag.session) {</span>
<a href="#l31.35"></a><span id="l31.35" class="difflineminus">-                let dir = element.getAttribute('dir');</span>
<a href="#l31.36"></a><span id="l31.36" class="difflineplus">+                let dir = element.getAttribute(&quot;dir&quot;);</span>
<a href="#l31.37"></a><span id="l31.37">                 TodayPane.advance(parseInt(dir, 10));</span>
<a href="#l31.38"></a><span id="l31.38">             }</span>
<a href="#l31.39"></a><span id="l31.39">         }</span>
<a href="#l31.40"></a><span id="l31.40">         if (element.id == &quot;previous-day-button&quot; ||</span>
<a href="#l31.41"></a><span id="l31.41">              element.id == &quot;next-day-button&quot;) {</span>
<a href="#l31.42"></a><span id="l31.42">             TodayPane.switchCounter = 0;</span>
<a href="#l31.43"></a><span id="l31.43">             let button = document.getElementById(element.id);</span>
<a href="#l31.44"></a><span id="l31.44">             button.removeEventListener(&quot;mouseout&quot;, TodayPane.stopSwitching, false);</span>
<a href="#l31.45"></a><span id="l31.45" class="difflineat">@@ -457,18 +457,18 @@ var TodayPane = {</span>
<a href="#l31.46"></a><span id="l31.46">     },</span>
<a href="#l31.47"></a><span id="l31.47"> </span>
<a href="#l31.48"></a><span id="l31.48">     /**</span>
<a href="#l31.49"></a><span id="l31.49">      * Generates the todaypane toggle command when the today-splitter</span>
<a href="#l31.50"></a><span id="l31.50">      * is being collapsed or uncollapsed.</span>
<a href="#l31.51"></a><span id="l31.51">      */</span>
<a href="#l31.52"></a><span id="l31.52">     onCommandTodaySplitter: function onCommandTodaySplitter() {</span>
<a href="#l31.53"></a><span id="l31.53">         let todaypane = document.getElementById(&quot;today-pane-panel&quot;);</span>
<a href="#l31.54"></a><span id="l31.54" class="difflineminus">-        let splitterState = document.getElementById('today-splitter').getAttribute(&quot;state&quot;);</span>
<a href="#l31.55"></a><span id="l31.55" class="difflineplus">+        let splitterState = document.getElementById(&quot;today-splitter&quot;).getAttribute(&quot;state&quot;);</span>
<a href="#l31.56"></a><span id="l31.56">         if (splitterState == &quot;collapsed&quot; &amp;&amp; todaypane.isVisible() ||</span>
<a href="#l31.57"></a><span id="l31.57">             splitterState != &quot;collapsed&quot; &amp;&amp; !todaypane.isVisible()) {</span>
<a href="#l31.58"></a><span id="l31.58" class="difflineminus">-              document.getElementById('calendar_toggle_todaypane_command').doCommand();</span>
<a href="#l31.59"></a><span id="l31.59" class="difflineplus">+              document.getElementById(&quot;calendar_toggle_todaypane_command&quot;).doCommand();</span>
<a href="#l31.60"></a><span id="l31.60">         }</span>
<a href="#l31.61"></a><span id="l31.61">     }</span>
<a href="#l31.62"></a><span id="l31.62"> };</span>
<a href="#l31.63"></a><span id="l31.63"> </span>
<a href="#l31.64"></a><span id="l31.64"> window.addEventListener(&quot;load&quot;, TodayPane.onLoad, false);</span>
<a href="#l31.65"></a><span id="l31.65"> window.addEventListener(&quot;unload&quot;, TodayPane.onUnload, false);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-alarm-widget.xml</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-alarm-widget.xml</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -164,27 +164,27 @@</span>
<a href="#l32.4"></a><span id="l32.4">       &lt;/method&gt;</span>
<a href="#l32.5"></a><span id="l32.5"> </span>
<a href="#l32.6"></a><span id="l32.6">       &lt;method name=&quot;showDetails&quot;&gt;</span>
<a href="#l32.7"></a><span id="l32.7">         &lt;parameter name=&quot;event&quot;/&gt;</span>
<a href="#l32.8"></a><span id="l32.8">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l32.9"></a><span id="l32.9">           if (event.type == &quot;click&quot; ||</span>
<a href="#l32.10"></a><span id="l32.10">               (event.type == &quot;keypress&quot; &amp;&amp;</span>
<a href="#l32.11"></a><span id="l32.11">                event.keyCode == event.DOM_VK_RETURN)) {</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-              let detailsEvent = document.createEvent('Events');</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineminus">-              detailsEvent.initEvent('itemdetails', true, false);</span>
<a href="#l32.14"></a><span id="l32.14" class="difflineplus">+              let detailsEvent = document.createEvent(&quot;Events&quot;);</span>
<a href="#l32.15"></a><span id="l32.15" class="difflineplus">+              detailsEvent.initEvent(&quot;itemdetails&quot;, true, false);</span>
<a href="#l32.16"></a><span id="l32.16">               this.dispatchEvent(detailsEvent);</span>
<a href="#l32.17"></a><span id="l32.17">           }</span>
<a href="#l32.18"></a><span id="l32.18">         ]]&gt;&lt;/body&gt;</span>
<a href="#l32.19"></a><span id="l32.19">       &lt;/method&gt;</span>
<a href="#l32.20"></a><span id="l32.20"> </span>
<a href="#l32.21"></a><span id="l32.21">       &lt;method name=&quot;dismissAlarm&quot;&gt;</span>
<a href="#l32.22"></a><span id="l32.22">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l32.23"></a><span id="l32.23" class="difflineminus">-          let dismissEvent = document.createEvent('Events');</span>
<a href="#l32.24"></a><span id="l32.24" class="difflineminus">-          dismissEvent.initEvent('dismiss', true, false);</span>
<a href="#l32.25"></a><span id="l32.25" class="difflineplus">+          let dismissEvent = document.createEvent(&quot;Events&quot;);</span>
<a href="#l32.26"></a><span id="l32.26" class="difflineplus">+          dismissEvent.initEvent(&quot;dismiss&quot;, true, false);</span>
<a href="#l32.27"></a><span id="l32.27">           this.dispatchEvent(dismissEvent);</span>
<a href="#l32.28"></a><span id="l32.28">         ]]&gt;&lt;/body&gt;</span>
<a href="#l32.29"></a><span id="l32.29">       &lt;/method&gt;</span>
<a href="#l32.30"></a><span id="l32.30">     &lt;/implementation&gt;</span>
<a href="#l32.31"></a><span id="l32.31">   &lt;/binding&gt;</span>
<a href="#l32.32"></a><span id="l32.32"> </span>
<a href="#l32.33"></a><span id="l32.33">   &lt;binding id=&quot;calendar-snooze-popup&quot;&gt;</span>
<a href="#l32.34"></a><span id="l32.34">     &lt;content ignorekeys=&quot;true&quot;&gt;</span>
<a href="#l32.35"></a><span id="l32.35" class="difflineat">@@ -270,18 +270,18 @@</span>
<a href="#l32.36"></a><span id="l32.36">         unitValue.value = snoozePref;</span>
<a href="#l32.37"></a><span id="l32.37"> </span>
<a href="#l32.38"></a><span id="l32.38">         updateAccessibleName();</span>
<a href="#l32.39"></a><span id="l32.39">       ]]&gt;&lt;/constructor&gt;</span>
<a href="#l32.40"></a><span id="l32.40"> </span>
<a href="#l32.41"></a><span id="l32.41">       &lt;method name=&quot;snoozeAlarm&quot;&gt;</span>
<a href="#l32.42"></a><span id="l32.42">         &lt;parameter name=&quot;minutes&quot;/&gt;</span>
<a href="#l32.43"></a><span id="l32.43">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l32.44"></a><span id="l32.44" class="difflineminus">-          let snoozeEvent = document.createEvent('Events');</span>
<a href="#l32.45"></a><span id="l32.45" class="difflineminus">-          snoozeEvent.initEvent('snooze', true, false);</span>
<a href="#l32.46"></a><span id="l32.46" class="difflineplus">+          let snoozeEvent = document.createEvent(&quot;Events&quot;);</span>
<a href="#l32.47"></a><span id="l32.47" class="difflineplus">+          snoozeEvent.initEvent(&quot;snooze&quot;, true, false);</span>
<a href="#l32.48"></a><span id="l32.48">           snoozeEvent.detail = minutes;</span>
<a href="#l32.49"></a><span id="l32.49"> </span>
<a href="#l32.50"></a><span id="l32.50">           // The onsnooze attribute is set on the menupopup, this binding is</span>
<a href="#l32.51"></a><span id="l32.51">           // instanciated on the menupopup's arrowscrollbox. Therefore we need</span>
<a href="#l32.52"></a><span id="l32.52">           // to go up one node.</span>
<a href="#l32.53"></a><span id="l32.53">           let handler = this.parentNode.getAttribute(&quot;onsnooze&quot;);</span>
<a href="#l32.54"></a><span id="l32.54">           let cancel = false;</span>
<a href="#l32.55"></a><span id="l32.55">           if (handler) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-list-tree.xml</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-list-tree.xml</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -395,17 +395,17 @@</span>
<a href="#l33.4"></a><span id="l33.4">                 onset=&quot;return setBooleanAttribute(this, 'ignoredisabledstate', val);&quot;/&gt;</span>
<a href="#l33.5"></a><span id="l33.5"> </span>
<a href="#l33.6"></a><span id="l33.6">       &lt;method name=&quot;sortOrderChanged&quot;&gt;</span>
<a href="#l33.7"></a><span id="l33.7">         &lt;parameter name=&quot;&quot;/&gt;</span>
<a href="#l33.8"></a><span id="l33.8">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l33.9"></a><span id="l33.9">           if (this.mAddingFromComposite) {</span>
<a href="#l33.10"></a><span id="l33.10">               return;</span>
<a href="#l33.11"></a><span id="l33.11">           }</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-          let event = document.createEvent('Events');</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+          let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l33.14"></a><span id="l33.14">           event.initEvent(&quot;SortOrderChanged&quot;, true, false);</span>
<a href="#l33.15"></a><span id="l33.15">           event.sortOrder = this.sortOrder;</span>
<a href="#l33.16"></a><span id="l33.16">           this.dispatchEvent(event);</span>
<a href="#l33.17"></a><span id="l33.17"> </span>
<a href="#l33.18"></a><span id="l33.18">           let handler = this.getAttribute(&quot;onSortOrderChanged&quot;);</span>
<a href="#l33.19"></a><span id="l33.19">           if (handler) {</span>
<a href="#l33.20"></a><span id="l33.20">               // Call the given code in a function</span>
<a href="#l33.21"></a><span id="l33.21">               let func = new Function(&quot;event&quot;, handler);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/base/content/widgets/minimonth.xml</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/base/content/widgets/minimonth.xml</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -893,29 +893,29 @@</span>
<a href="#l34.4"></a><span id="l34.4"> </span>
<a href="#l34.5"></a><span id="l34.5">                     if (monthChanged) {</span>
<a href="#l34.6"></a><span id="l34.6">                         this.resetAttributesForDate(day.date);</span>
<a href="#l34.7"></a><span id="l34.7">                     }</span>
<a href="#l34.8"></a><span id="l34.8">                 }</span>
<a href="#l34.9"></a><span id="l34.9">             }</span>
<a href="#l34.10"></a><span id="l34.10"> </span>
<a href="#l34.11"></a><span id="l34.11">             if (monthChanged) {</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-                this.fireEvent('monthchange');</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+                this.fireEvent(&quot;monthchange&quot;);</span>
<a href="#l34.14"></a><span id="l34.14">             }</span>
<a href="#l34.15"></a><span id="l34.15"> </span>
<a href="#l34.16"></a><span id="l34.16">             if (this.getAttribute(&quot;freebusy&quot;) == &quot;true&quot;) {</span>
<a href="#l34.17"></a><span id="l34.17">                 this.getItems();</span>
<a href="#l34.18"></a><span id="l34.18">             }</span>
<a href="#l34.19"></a><span id="l34.19">         ]]&gt;&lt;/body&gt;</span>
<a href="#l34.20"></a><span id="l34.20">       &lt;/method&gt;</span>
<a href="#l34.21"></a><span id="l34.21">       &lt;!--Attention - duplicate!!!!--&gt;</span>
<a href="#l34.22"></a><span id="l34.22">       &lt;method name=&quot;fireEvent&quot;&gt;</span>
<a href="#l34.23"></a><span id="l34.23">         &lt;parameter name=&quot;aEventName&quot;/&gt;</span>
<a href="#l34.24"></a><span id="l34.24">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l34.25"></a><span id="l34.25" class="difflineminus">-            let event = document.createEvent('Events');</span>
<a href="#l34.26"></a><span id="l34.26" class="difflineplus">+            let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l34.27"></a><span id="l34.27">             event.initEvent(aEventName, true, true);</span>
<a href="#l34.28"></a><span id="l34.28">             this.dispatchEvent(event);</span>
<a href="#l34.29"></a><span id="l34.29">         ]]&gt;&lt;/body&gt;</span>
<a href="#l34.30"></a><span id="l34.30">       &lt;/method&gt;</span>
<a href="#l34.31"></a><span id="l34.31"> </span>
<a href="#l34.32"></a><span id="l34.32">       &lt;method name=&quot;getBoxForDate&quot;&gt;</span>
<a href="#l34.33"></a><span id="l34.33">         &lt;parameter name=&quot;aDate&quot;/&gt;</span>
<a href="#l34.34"></a><span id="l34.34">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l34.35"></a><span id="l34.35" class="difflineat">@@ -1030,26 +1030,26 @@</span>
<a href="#l34.36"></a><span id="l34.36">             if (this.mIsReadOnly) {</span>
<a href="#l34.37"></a><span id="l34.37">                return;</span>
<a href="#l34.38"></a><span id="l34.38">             }</span>
<a href="#l34.39"></a><span id="l34.39">             if (this.mSelected) {</span>
<a href="#l34.40"></a><span id="l34.40">               this.mSelected.removeAttribute(&quot;selected&quot;);</span>
<a href="#l34.41"></a><span id="l34.41">             }</span>
<a href="#l34.42"></a><span id="l34.42">             this.mSelected = aDayBox;</span>
<a href="#l34.43"></a><span id="l34.43">             this.value = aDayBox.date;</span>
<a href="#l34.44"></a><span id="l34.44" class="difflineminus">-            this.fireEvent('select');</span>
<a href="#l34.45"></a><span id="l34.45" class="difflineplus">+            this.fireEvent(&quot;select&quot;);</span>
<a href="#l34.46"></a><span id="l34.46">           ]]&gt;&lt;/body&gt;</span>
<a href="#l34.47"></a><span id="l34.47">       &lt;/method&gt;</span>
<a href="#l34.48"></a><span id="l34.48"> </span>
<a href="#l34.49"></a><span id="l34.49">       &lt;method name=&quot;update&quot;&gt;</span>
<a href="#l34.50"></a><span id="l34.50">         &lt;parameter name=&quot;aValue&quot;/&gt;</span>
<a href="#l34.51"></a><span id="l34.51">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l34.52"></a><span id="l34.52">           this.mValue = aValue;</span>
<a href="#l34.53"></a><span id="l34.53">           if (this.mValue) {</span>
<a href="#l34.54"></a><span id="l34.54" class="difflineminus">-            this.fireEvent('change');</span>
<a href="#l34.55"></a><span id="l34.55" class="difflineplus">+            this.fireEvent(&quot;change&quot;);</span>
<a href="#l34.56"></a><span id="l34.56">           }</span>
<a href="#l34.57"></a><span id="l34.57">           this.showMonth(aValue);</span>
<a href="#l34.58"></a><span id="l34.58">         ]]&gt;&lt;/body&gt;</span>
<a href="#l34.59"></a><span id="l34.59">       &lt;/method&gt;</span>
<a href="#l34.60"></a><span id="l34.60"> </span>
<a href="#l34.61"></a><span id="l34.61">       &lt;method name=&quot;hidePopupList&quot;&gt;</span>
<a href="#l34.62"></a><span id="l34.62">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l34.63"></a><span id="l34.63">           if (!this.mIsReadOnly) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/calendar/base/modules/calPrintUtils.jsm</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/calendar/base/modules/calPrintUtils.jsm</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -33,17 +33,17 @@ cal.print = {</span>
<a href="#l35.4"></a><span id="l35.4">         sheet.insertedCategoryRules = sheet.insertedCategoryRules || {};</span>
<a href="#l35.5"></a><span id="l35.5"> </span>
<a href="#l35.6"></a><span id="l35.6">         for (let category of categories) {</span>
<a href="#l35.7"></a><span id="l35.7">             let prefName = cal.formatStringForCSSRule(category);</span>
<a href="#l35.8"></a><span id="l35.8">             let color = Preferences.get(&quot;calendar.category.color.&quot; + prefName) || &quot;transparent&quot;;</span>
<a href="#l35.9"></a><span id="l35.9">             if (!(prefName in sheet.insertedCategoryRules)) {</span>
<a href="#l35.10"></a><span id="l35.10">                 sheet.insertedCategoryRules[prefName] = true;</span>
<a href="#l35.11"></a><span id="l35.11">                 let ruleAdd = ' .category-color-box[categories~=&quot;' + prefName + '&quot;] { ' +</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-                              ' border: 2px solid ' + color + '; }' + &quot;\n&quot;;</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+                              &quot; border: 2px solid &quot; + color + &quot;; }\n&quot;;</span>
<a href="#l35.14"></a><span id="l35.14">                 sheet.textContent += ruleAdd;</span>
<a href="#l35.15"></a><span id="l35.15">             }</span>
<a href="#l35.16"></a><span id="l35.16">         }</span>
<a href="#l35.17"></a><span id="l35.17">     },</span>
<a href="#l35.18"></a><span id="l35.18"> </span>
<a href="#l35.19"></a><span id="l35.19">     /**</span>
<a href="#l35.20"></a><span id="l35.20">      * Add calendar styles to the document's &quot;sheet&quot; element. This is needed</span>
<a href="#l35.21"></a><span id="l35.21">      * since the HTML created is serialized, so we can't dynamically set the</span>
<a href="#l35.22"></a><span id="l35.22" class="difflineat">@@ -57,18 +57,18 @@ cal.print = {</span>
<a href="#l35.23"></a><span id="l35.23">         let sheet = document.getElementById(&quot;sheet&quot;);</span>
<a href="#l35.24"></a><span id="l35.24">         let color = calendar.getProperty(&quot;color&quot;) || &quot;#A8C2E1&quot;;</span>
<a href="#l35.25"></a><span id="l35.25">         sheet.insertedCalendarRules = sheet.insertedCalendarRules || {};</span>
<a href="#l35.26"></a><span id="l35.26"> </span>
<a href="#l35.27"></a><span id="l35.27">         if (!(calendar.id in sheet.insertedCalendarRules)) {</span>
<a href="#l35.28"></a><span id="l35.28">             sheet.insertedCalendarRules[calendar.id] = true;</span>
<a href="#l35.29"></a><span id="l35.29">             let formattedId = cal.formatStringForCSSRule(calendar.id);</span>
<a href="#l35.30"></a><span id="l35.30">             let ruleAdd = ' .calendar-color-box[calendar-id=&quot;' + formattedId + '&quot;] { ' +</span>
<a href="#l35.31"></a><span id="l35.31" class="difflineminus">-                          ' background-color: ' + color + '; ' +</span>
<a href="#l35.32"></a><span id="l35.32" class="difflineminus">-                          ' color: ' + cal.getContrastingTextColor(color) + '; }' + &quot;\n&quot;;</span>
<a href="#l35.33"></a><span id="l35.33" class="difflineplus">+                          &quot; background-color: &quot; + color + &quot;; &quot; +</span>
<a href="#l35.34"></a><span id="l35.34" class="difflineplus">+                          &quot; color: &quot; + cal.getContrastingTextColor(color) + &quot;; }\n&quot;;</span>
<a href="#l35.35"></a><span id="l35.35">             sheet.textContent += ruleAdd;</span>
<a href="#l35.36"></a><span id="l35.36">         }</span>
<a href="#l35.37"></a><span id="l35.37">     },</span>
<a href="#l35.38"></a><span id="l35.38"> </span>
<a href="#l35.39"></a><span id="l35.39">     /**</span>
<a href="#l35.40"></a><span id="l35.40">      * Serializes the given item by setting marked nodes to the item's content.</span>
<a href="#l35.41"></a><span id="l35.41">      * Has some expectations about the DOM document (in CSS-selector-speak), all</span>
<a href="#l35.42"></a><span id="l35.42">      * following nodes MUST exist.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/calendar/base/modules/calRecurrenceUtils.jsm</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/calendar/base/modules/calRecurrenceUtils.jsm</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -50,29 +50,29 @@ function recurrenceRule2String(recurrenc</span>
<a href="#l36.4"></a><span id="l36.4">     // set recurrence info. Bail out if there's more</span>
<a href="#l36.5"></a><span id="l36.5">     // than a single rule or something other than a rule.</span>
<a href="#l36.6"></a><span id="l36.6">     recurrenceInfo = recurrenceInfo.clone();</span>
<a href="#l36.7"></a><span id="l36.7">     let rrules = splitRecurrenceRules(recurrenceInfo);</span>
<a href="#l36.8"></a><span id="l36.8">     if (rrules[0].length == 1) {</span>
<a href="#l36.9"></a><span id="l36.9">         let rule = cal.wrapInstance(rrules[0][0], Components.interfaces.calIRecurrenceRule);</span>
<a href="#l36.10"></a><span id="l36.10">         // Currently we allow only for BYDAY, BYMONTHDAY, BYMONTH rules.</span>
<a href="#l36.11"></a><span id="l36.11">         if (rule &amp;&amp;</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-            !checkRecurrenceRule(rule, ['BYSECOND',</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineminus">-                                        'BYMINUTE',</span>
<a href="#l36.14"></a><span id="l36.14" class="difflineminus">-                                        // 'BYDAY',</span>
<a href="#l36.15"></a><span id="l36.15" class="difflineminus">-                                        'BYHOUR',</span>
<a href="#l36.16"></a><span id="l36.16" class="difflineminus">-                                        // 'BYMONTHDAY',</span>
<a href="#l36.17"></a><span id="l36.17" class="difflineminus">-                                        'BYYEARDAY',</span>
<a href="#l36.18"></a><span id="l36.18" class="difflineminus">-                                        'BYWEEKNO',</span>
<a href="#l36.19"></a><span id="l36.19" class="difflineminus">-                                        // 'BYMONTH',</span>
<a href="#l36.20"></a><span id="l36.20" class="difflineminus">-                                        'BYSETPOS'])) {</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineplus">+            !checkRecurrenceRule(rule, [&quot;BYSECOND&quot;,</span>
<a href="#l36.22"></a><span id="l36.22" class="difflineplus">+                                        &quot;BYMINUTE&quot;,</span>
<a href="#l36.23"></a><span id="l36.23" class="difflineplus">+                                        // &quot;BYDAY&quot;,</span>
<a href="#l36.24"></a><span id="l36.24" class="difflineplus">+                                        &quot;BYHOUR&quot;,</span>
<a href="#l36.25"></a><span id="l36.25" class="difflineplus">+                                        // &quot;BYMONTHDAY&quot;,</span>
<a href="#l36.26"></a><span id="l36.26" class="difflineplus">+                                        &quot;BYYEARDAY&quot;,</span>
<a href="#l36.27"></a><span id="l36.27" class="difflineplus">+                                        &quot;BYWEEKNO&quot;,</span>
<a href="#l36.28"></a><span id="l36.28" class="difflineplus">+                                        // &quot;BYMONTH&quot;,</span>
<a href="#l36.29"></a><span id="l36.29" class="difflineplus">+                                        &quot;BYSETPOS&quot;])) {</span>
<a href="#l36.30"></a><span id="l36.30">             let dateFormatter = cal.getDateFormatter();</span>
<a href="#l36.31"></a><span id="l36.31">             let ruleString;</span>
<a href="#l36.32"></a><span id="l36.32" class="difflineminus">-            if (rule.type == 'DAILY') {</span>
<a href="#l36.33"></a><span id="l36.33" class="difflineminus">-                if (checkRecurrenceRule(rule, ['BYDAY'])) {</span>
<a href="#l36.34"></a><span id="l36.34" class="difflineplus">+            if (rule.type == &quot;DAILY&quot;) {</span>
<a href="#l36.35"></a><span id="l36.35" class="difflineplus">+                if (checkRecurrenceRule(rule, [&quot;BYDAY&quot;])) {</span>
<a href="#l36.36"></a><span id="l36.36">                     let days = rule.getComponent(&quot;BYDAY&quot;, {});</span>
<a href="#l36.37"></a><span id="l36.37">                     let weekdays = [2, 3, 4, 5, 6];</span>
<a href="#l36.38"></a><span id="l36.38">                     if (weekdays.length == days.length) {</span>
<a href="#l36.39"></a><span id="l36.39">                         let i;</span>
<a href="#l36.40"></a><span id="l36.40">                         for (i = 0; i &lt; weekdays.length; i++) {</span>
<a href="#l36.41"></a><span id="l36.41">                             if (weekdays[i] != days[i]) {</span>
<a href="#l36.42"></a><span id="l36.42">                                 break;</span>
<a href="#l36.43"></a><span id="l36.43">                             }</span>
<a href="#l36.44"></a><span id="l36.44" class="difflineat">@@ -83,49 +83,49 @@ function recurrenceRule2String(recurrenc</span>
<a href="#l36.45"></a><span id="l36.45">                     } else {</span>
<a href="#l36.46"></a><span id="l36.46">                         return null;</span>
<a href="#l36.47"></a><span id="l36.47">                     }</span>
<a href="#l36.48"></a><span id="l36.48">                 } else {</span>
<a href="#l36.49"></a><span id="l36.49">                     let dailyString = getRString(&quot;dailyEveryNth&quot;);</span>
<a href="#l36.50"></a><span id="l36.50">                     ruleString = PluralForm.get(rule.interval, dailyString)</span>
<a href="#l36.51"></a><span id="l36.51">                                            .replace(&quot;#1&quot;, rule.interval);</span>
<a href="#l36.52"></a><span id="l36.52">                 }</span>
<a href="#l36.53"></a><span id="l36.53" class="difflineminus">-            } else if (rule.type == 'WEEKLY') {</span>
<a href="#l36.54"></a><span id="l36.54" class="difflineplus">+            } else if (rule.type == &quot;WEEKLY&quot;) {</span>
<a href="#l36.55"></a><span id="l36.55">                 // weekly recurrence, currently we</span>
<a href="#l36.56"></a><span id="l36.56">                 // support a single 'BYDAY'-rule only.</span>
<a href="#l36.57"></a><span id="l36.57" class="difflineminus">-                if (checkRecurrenceRule(rule, ['BYDAY'])) {</span>
<a href="#l36.58"></a><span id="l36.58" class="difflineplus">+                if (checkRecurrenceRule(rule, [&quot;BYDAY&quot;])) {</span>
<a href="#l36.59"></a><span id="l36.59">                     // create a string like 'Monday, Tuesday and Wednesday'</span>
<a href="#l36.60"></a><span id="l36.60">                     let days = rule.getComponent(&quot;BYDAY&quot;, {});</span>
<a href="#l36.61"></a><span id="l36.61">                     let weekdays = &quot;&quot;;</span>
<a href="#l36.62"></a><span id="l36.62">                     // select noun class (grammatical gender) according to the</span>
<a href="#l36.63"></a><span id="l36.63">                     // first day of the list</span>
<a href="#l36.64"></a><span id="l36.64">                     let weeklyString = nounClass(&quot;repeatDetailsDay&quot; + days[0], &quot;weeklyNthOn&quot;);</span>
<a href="#l36.65"></a><span id="l36.65">                     for (let i = 0; i &lt; days.length; i++) {</span>
<a href="#l36.66"></a><span id="l36.66">                         if (rule.interval == 1) {</span>
<a href="#l36.67"></a><span id="l36.67">                             weekdays += getRString(pluralWeekday(&quot;repeatDetailsDay&quot; + days[i]));</span>
<a href="#l36.68"></a><span id="l36.68">                         } else {</span>
<a href="#l36.69"></a><span id="l36.69">                             weekdays += getRString(&quot;repeatDetailsDay&quot; + days[i]);</span>
<a href="#l36.70"></a><span id="l36.70">                         }</span>
<a href="#l36.71"></a><span id="l36.71">                         if (days.length &gt; 1 &amp;&amp; i == (days.length - 2)) {</span>
<a href="#l36.72"></a><span id="l36.72" class="difflineminus">-                            weekdays += ' ' + getRString(&quot;repeatDetailsAnd&quot;) + ' ';</span>
<a href="#l36.73"></a><span id="l36.73" class="difflineplus">+                            weekdays += &quot; &quot; + getRString(&quot;repeatDetailsAnd&quot;) + &quot; &quot;;</span>
<a href="#l36.74"></a><span id="l36.74">                         } else if (i &lt; days.length - 1) {</span>
<a href="#l36.75"></a><span id="l36.75" class="difflineminus">-                            weekdays += ', ';</span>
<a href="#l36.76"></a><span id="l36.76" class="difflineplus">+                            weekdays += &quot;, &quot;;</span>
<a href="#l36.77"></a><span id="l36.77">                         }</span>
<a href="#l36.78"></a><span id="l36.78">                     }</span>
<a href="#l36.79"></a><span id="l36.79"> </span>
<a href="#l36.80"></a><span id="l36.80">                     weeklyString = getRString(weeklyString, [weekdays]);</span>
<a href="#l36.81"></a><span id="l36.81">                     ruleString = PluralForm.get(rule.interval, weeklyString)</span>
<a href="#l36.82"></a><span id="l36.82">                                            .replace(&quot;#2&quot;, rule.interval);</span>
<a href="#l36.83"></a><span id="l36.83">                 } else {</span>
<a href="#l36.84"></a><span id="l36.84">                     let weeklyString = getRString(&quot;weeklyEveryNth&quot;);</span>
<a href="#l36.85"></a><span id="l36.85">                     ruleString = PluralForm.get(rule.interval, weeklyString)</span>
<a href="#l36.86"></a><span id="l36.86">                                            .replace(&quot;#1&quot;, rule.interval);</span>
<a href="#l36.87"></a><span id="l36.87">                 }</span>
<a href="#l36.88"></a><span id="l36.88" class="difflineminus">-            } else if (rule.type == 'MONTHLY') {</span>
<a href="#l36.89"></a><span id="l36.89" class="difflineminus">-                if (checkRecurrenceRule(rule, ['BYDAY'])) {</span>
<a href="#l36.90"></a><span id="l36.90" class="difflineplus">+            } else if (rule.type == &quot;MONTHLY&quot;) {</span>
<a href="#l36.91"></a><span id="l36.91" class="difflineplus">+                if (checkRecurrenceRule(rule, [&quot;BYDAY&quot;])) {</span>
<a href="#l36.92"></a><span id="l36.92">                     let byday = rule.getComponent(&quot;BYDAY&quot;, {});</span>
<a href="#l36.93"></a><span id="l36.93">                     if (everyWeekDay(byday)) {</span>
<a href="#l36.94"></a><span id="l36.94">                         // Rule every day of the month.</span>
<a href="#l36.95"></a><span id="l36.95">                         ruleString = getRString(&quot;monthlyEveryDayOfNth&quot;);</span>
<a href="#l36.96"></a><span id="l36.96">                         ruleString = PluralForm.get(rule.interval, ruleString)</span>
<a href="#l36.97"></a><span id="l36.97">                                                .replace(&quot;#2&quot;, rule.interval);</span>
<a href="#l36.98"></a><span id="l36.98">                     } else {</span>
<a href="#l36.99"></a><span id="l36.99">                         // For rules with generic number of weekdays with and</span>
<a href="#l36.100"></a><span id="l36.100" class="difflineat">@@ -164,25 +164,25 @@ function recurrenceRule2String(recurrenc</span>
<a href="#l36.101"></a><span id="l36.101">                                 let stringOrdinalWeekday = getRString(&quot;ordinalWeekdayOrder&quot;,</span>
<a href="#l36.102"></a><span id="l36.102">                                                                       [ordinalString, dayString]);</span>
<a href="#l36.103"></a><span id="l36.103">                                 weekdaysString_position += stringOrdinalWeekday + &quot;, &quot;;</span>
<a href="#l36.104"></a><span id="l36.104">                             }</span>
<a href="#l36.105"></a><span id="l36.105">                         }</span>
<a href="#l36.106"></a><span id="l36.106">                         let weekdaysString = weekdaysString_every + weekdaysString_position;</span>
<a href="#l36.107"></a><span id="l36.107">                         weekdaysString = weekdaysString.slice(0, -2)</span>
<a href="#l36.108"></a><span id="l36.108">                                                        .replace(/,(?= [^,]*$)/,</span>
<a href="#l36.109"></a><span id="l36.109" class="difflineminus">-                                                                ' ' + getRString(&quot;repeatDetailsAnd&quot;));</span>
<a href="#l36.110"></a><span id="l36.110" class="difflineplus">+                                                                &quot; &quot; + getRString(&quot;repeatDetailsAnd&quot;));</span>
<a href="#l36.111"></a><span id="l36.111"> </span>
<a href="#l36.112"></a><span id="l36.112">                         let monthlyString = weekdaysString_every ? &quot;monthlyEveryOfEvery&quot; : &quot;monthlyRuleNthOfEvery&quot;;</span>
<a href="#l36.113"></a><span id="l36.113">                         monthlyString = nounClass(&quot;repeatDetailsDay&quot; + day_of_week(firstDay), monthlyString);</span>
<a href="#l36.114"></a><span id="l36.114">                         monthlyString = getRString(monthlyString, [weekdaysString]);</span>
<a href="#l36.115"></a><span id="l36.115">                         ruleString = PluralForm.get(rule.interval, monthlyString)</span>
<a href="#l36.116"></a><span id="l36.116">                                                .replace(&quot;#2&quot;, rule.interval);</span>
<a href="#l36.117"></a><span id="l36.117">                     }</span>
<a href="#l36.118"></a><span id="l36.118" class="difflineminus">-                } else if (checkRecurrenceRule(rule, ['BYMONTHDAY'])) {</span>
<a href="#l36.119"></a><span id="l36.119" class="difflineplus">+                } else if (checkRecurrenceRule(rule, [&quot;BYMONTHDAY&quot;])) {</span>
<a href="#l36.120"></a><span id="l36.120">                     let component = rule.getComponent(&quot;BYMONTHDAY&quot;, {});</span>
<a href="#l36.121"></a><span id="l36.121"> </span>
<a href="#l36.122"></a><span id="l36.122">                     // First, find out if the 'BYMONTHDAY' component contains</span>
<a href="#l36.123"></a><span id="l36.123">                     // any elements with a negative value lesser than -1 (&quot;the</span>
<a href="#l36.124"></a><span id="l36.124">                     // last day&quot;). If so we currently don't support any rule</span>
<a href="#l36.125"></a><span id="l36.125">                     if (component.some(function(element, index, array) {</span>
<a href="#l36.126"></a><span id="l36.126">                                            return element &lt; -1;</span>
<a href="#l36.127"></a><span id="l36.127">                                        })) {</span>
<a href="#l36.128"></a><span id="l36.128" class="difflineat">@@ -207,62 +207,62 @@ function recurrenceRule2String(recurrenc</span>
<a href="#l36.129"></a><span id="l36.129">                                 }</span>
<a href="#l36.130"></a><span id="l36.130">                                 day_string += dateFormatter.formatDayWithOrdinal(component[i]) + &quot;, &quot;;</span>
<a href="#l36.131"></a><span id="l36.131">                             }</span>
<a href="#l36.132"></a><span id="l36.132">                             if (lastDay) {</span>
<a href="#l36.133"></a><span id="l36.133">                                 day_string += getRString(&quot;monthlyLastDay&quot;) + &quot;, &quot;;</span>
<a href="#l36.134"></a><span id="l36.134">                             }</span>
<a href="#l36.135"></a><span id="l36.135">                             day_string = day_string.slice(0, -2)</span>
<a href="#l36.136"></a><span id="l36.136">                                                    .replace(/,(?= [^,]*$)/,</span>
<a href="#l36.137"></a><span id="l36.137" class="difflineminus">-                                                            ' ' + getRString(&quot;repeatDetailsAnd&quot;));</span>
<a href="#l36.138"></a><span id="l36.138" class="difflineplus">+                                                            &quot; &quot; + getRString(&quot;repeatDetailsAnd&quot;));</span>
<a href="#l36.139"></a><span id="l36.139"> </span>
<a href="#l36.140"></a><span id="l36.140">                             // Add the word &quot;day&quot; in plural form to the list of days then</span>
<a href="#l36.141"></a><span id="l36.141">                             // compose the final string with the interval of months</span>
<a href="#l36.142"></a><span id="l36.142">                             let monthlyDayString = getRString(&quot;monthlyDaysOfNth_day&quot;, [day_string]);</span>
<a href="#l36.143"></a><span id="l36.143">                             monthlyDayString = PluralForm.get(component.length, monthlyDayString);</span>
<a href="#l36.144"></a><span id="l36.144">                             let monthlyString = getRString(&quot;monthlyDaysOfNth&quot;, [monthlyDayString]);</span>
<a href="#l36.145"></a><span id="l36.145">                             ruleString = PluralForm.get(rule.interval, monthlyString)</span>
<a href="#l36.146"></a><span id="l36.146">                                                    .replace(&quot;#2&quot;, rule.interval);</span>
<a href="#l36.147"></a><span id="l36.147">                         }</span>
<a href="#l36.148"></a><span id="l36.148">                     }</span>
<a href="#l36.149"></a><span id="l36.149">                 } else {</span>
<a href="#l36.150"></a><span id="l36.150">                     let monthlyString = getRString(&quot;monthlyDaysOfNth&quot;, [startDate.day]);</span>
<a href="#l36.151"></a><span id="l36.151">                     ruleString = PluralForm.get(rule.interval, monthlyString)</span>
<a href="#l36.152"></a><span id="l36.152">                                            .replace(&quot;#2&quot;, rule.interval);</span>
<a href="#l36.153"></a><span id="l36.153">                 }</span>
<a href="#l36.154"></a><span id="l36.154" class="difflineminus">-            } else if (rule.type == 'YEARLY') {</span>
<a href="#l36.155"></a><span id="l36.155" class="difflineplus">+            } else if (rule.type == &quot;YEARLY&quot;) {</span>
<a href="#l36.156"></a><span id="l36.156">                 let bymonthday = null;</span>
<a href="#l36.157"></a><span id="l36.157">                 let bymonth = null;</span>
<a href="#l36.158"></a><span id="l36.158" class="difflineminus">-                if (checkRecurrenceRule(rule, ['BYMONTHDAY'])) {</span>
<a href="#l36.159"></a><span id="l36.159" class="difflineplus">+                if (checkRecurrenceRule(rule, [&quot;BYMONTHDAY&quot;])) {</span>
<a href="#l36.160"></a><span id="l36.160">                     bymonthday = rule.getComponent(&quot;BYMONTHDAY&quot;, {});</span>
<a href="#l36.161"></a><span id="l36.161">                 }</span>
<a href="#l36.162"></a><span id="l36.162" class="difflineminus">-                if (checkRecurrenceRule(rule, ['BYMONTH'])) {</span>
<a href="#l36.163"></a><span id="l36.163" class="difflineplus">+                if (checkRecurrenceRule(rule, [&quot;BYMONTH&quot;])) {</span>
<a href="#l36.164"></a><span id="l36.164">                     bymonth = rule.getComponent(&quot;BYMONTH&quot;, {});</span>
<a href="#l36.165"></a><span id="l36.165">                 }</span>
<a href="#l36.166"></a><span id="l36.166">                 if (bymonth &amp;&amp; bymonth.length &gt; 1 ||</span>
<a href="#l36.167"></a><span id="l36.167">                     bymonthday &amp;&amp; (bymonthday.length &gt; 1 || bymonthday[0] &lt; -1)) {</span>
<a href="#l36.168"></a><span id="l36.168">                     // Don't build a string for a recurrence rule that the UI</span>
<a href="#l36.169"></a><span id="l36.169">                     // currently can't show completely (with more than one month</span>
<a href="#l36.170"></a><span id="l36.170">                     // or than one monthday, or bymonthdays lesser than -1).</span>
<a href="#l36.171"></a><span id="l36.171">                     return getRString(&quot;ruleTooComplex&quot;);</span>
<a href="#l36.172"></a><span id="l36.172">                 }</span>
<a href="#l36.173"></a><span id="l36.173"> </span>
<a href="#l36.174"></a><span id="l36.174" class="difflineminus">-                if (checkRecurrenceRule(rule, ['BYMONTHDAY']) &amp;&amp;</span>
<a href="#l36.175"></a><span id="l36.175" class="difflineminus">-                    (checkRecurrenceRule(rule, ['BYMONTH']) || !checkRecurrenceRule(rule, ['BYDAY']))) {</span>
<a href="#l36.176"></a><span id="l36.176" class="difflineplus">+                if (checkRecurrenceRule(rule, [&quot;BYMONTHDAY&quot;]) &amp;&amp;</span>
<a href="#l36.177"></a><span id="l36.177" class="difflineplus">+                    (checkRecurrenceRule(rule, [&quot;BYMONTH&quot;]) || !checkRecurrenceRule(rule, [&quot;BYDAY&quot;]))) {</span>
<a href="#l36.178"></a><span id="l36.178">                     // RRULE:FREQ=YEARLY;BYMONTH=x;BYMONTHDAY=y.</span>
<a href="#l36.179"></a><span id="l36.179">                     // RRULE:FREQ=YEARLY;BYMONTHDAY=x (takes the month from the start date).</span>
<a href="#l36.180"></a><span id="l36.180">                     let monthNumber = bymonth ? bymonth[0] : (startDate.month + 1);</span>
<a href="#l36.181"></a><span id="l36.181">                     let month = getRString(&quot;repeatDetailsMonth&quot; + monthNumber);</span>
<a href="#l36.182"></a><span id="l36.182">                     let monthDay = bymonthday[0] == -1 ? getRString(&quot;monthlyLastDay&quot;)</span>
<a href="#l36.183"></a><span id="l36.183">                                                        : dateFormatter.formatDayWithOrdinal(bymonthday[0]);</span>
<a href="#l36.184"></a><span id="l36.184">                     let yearlyString = getRString(&quot;yearlyNthOn&quot;, [month, monthDay]);</span>
<a href="#l36.185"></a><span id="l36.185">                     ruleString = PluralForm.get(rule.interval, yearlyString)</span>
<a href="#l36.186"></a><span id="l36.186">                                            .replace(&quot;#3&quot;, rule.interval);</span>
<a href="#l36.187"></a><span id="l36.187" class="difflineminus">-                } else if (checkRecurrenceRule(rule, ['BYMONTH']) &amp;&amp;</span>
<a href="#l36.188"></a><span id="l36.188" class="difflineminus">-                           checkRecurrenceRule(rule, ['BYDAY'])) {</span>
<a href="#l36.189"></a><span id="l36.189" class="difflineplus">+                } else if (checkRecurrenceRule(rule, [&quot;BYMONTH&quot;]) &amp;&amp;</span>
<a href="#l36.190"></a><span id="l36.190" class="difflineplus">+                           checkRecurrenceRule(rule, [&quot;BYDAY&quot;])) {</span>
<a href="#l36.191"></a><span id="l36.191">                     // RRULE:FREQ=YEARLY;BYMONTH=x;BYDAY=y1,y2,....</span>
<a href="#l36.192"></a><span id="l36.192">                     let byday = rule.getComponent(&quot;BYDAY&quot;, {});</span>
<a href="#l36.193"></a><span id="l36.193">                     let month = getRString(&quot;repeatDetailsMonth&quot; + bymonth[0]);</span>
<a href="#l36.194"></a><span id="l36.194">                     if (everyWeekDay(byday)) {</span>
<a href="#l36.195"></a><span id="l36.195">                         // Every day of the month.</span>
<a href="#l36.196"></a><span id="l36.196">                         let yearlyString = &quot;yearlyEveryDayOf&quot;;</span>
<a href="#l36.197"></a><span id="l36.197">                         yearlyString = getRString(yearlyString, [month]);</span>
<a href="#l36.198"></a><span id="l36.198">                         ruleString = PluralForm.get(rule.interval, yearlyString)</span>
<a href="#l36.199"></a><span id="l36.199" class="difflineat">@@ -293,17 +293,17 @@ function recurrenceRule2String(recurrenc</span>
<a href="#l36.200"></a><span id="l36.200">                             return getRString(&quot;ruleTooComplex&quot;);</span>
<a href="#l36.201"></a><span id="l36.201">                         }</span>
<a href="#l36.202"></a><span id="l36.202">                     } else {</span>
<a href="#l36.203"></a><span id="l36.203">                         // Currently we don't support yearly rules with</span>
<a href="#l36.204"></a><span id="l36.204">                         // more than one BYDAY element or exactly 7 elements</span>
<a href="#l36.205"></a><span id="l36.205">                         // with all the weekdays (the &quot;every day&quot; case).</span>
<a href="#l36.206"></a><span id="l36.206">                         return getRString(&quot;ruleTooComplex&quot;);</span>
<a href="#l36.207"></a><span id="l36.207">                     }</span>
<a href="#l36.208"></a><span id="l36.208" class="difflineminus">-                } else if (checkRecurrenceRule(rule, ['BYMONTH'])) {</span>
<a href="#l36.209"></a><span id="l36.209" class="difflineplus">+                } else if (checkRecurrenceRule(rule, [&quot;BYMONTH&quot;])) {</span>
<a href="#l36.210"></a><span id="l36.210">                     // RRULE:FREQ=YEARLY;BYMONTH=x (takes the day from the start date).</span>
<a href="#l36.211"></a><span id="l36.211">                     let month = getRString(&quot;repeatDetailsMonth&quot; + bymonth[0]);</span>
<a href="#l36.212"></a><span id="l36.212">                     let yearlyString = getRString(&quot;yearlyNthOn&quot;, [month, startDate.day]);</span>
<a href="#l36.213"></a><span id="l36.213">                     ruleString = PluralForm.get(rule.interval, yearlyString)</span>
<a href="#l36.214"></a><span id="l36.214">                                            .replace(&quot;#3&quot;, rule.interval);</span>
<a href="#l36.215"></a><span id="l36.215">                 } else {</span>
<a href="#l36.216"></a><span id="l36.216">                     let month = getRString(&quot;repeatDetailsMonth&quot; + (startDate.month + 1));</span>
<a href="#l36.217"></a><span id="l36.217">                     let yearlyString = getRString(&quot;yearlyNthOn&quot;, [month, startDate.day]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/calendar/base/modules/calUtils.jsm</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/calendar/base/modules/calUtils.jsm</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -433,17 +433,17 @@ var cal = {</span>
<a href="#l37.4"></a><span id="l37.4">             let email = cal.getAttendeeEmail(aVal, true);</span>
<a href="#l37.5"></a><span id="l37.5">             if (!email.length) {</span>
<a href="#l37.6"></a><span id="l37.6">                 cal.LOG(&quot;Dropping invalid recipient for email transport: &quot; + aVal.toString());</span>
<a href="#l37.7"></a><span id="l37.7">             }</span>
<a href="#l37.8"></a><span id="l37.8">             return email;</span>
<a href="#l37.9"></a><span id="l37.9">         };</span>
<a href="#l37.10"></a><span id="l37.10">         return aAttendees.map(cbEmail)</span>
<a href="#l37.11"></a><span id="l37.11">                          .filter(aVal =&gt; aVal.length &gt; 0)</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-                         .join(', ');</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+                         .join(&quot;, &quot;);</span>
<a href="#l37.14"></a><span id="l37.14">     },</span>
<a href="#l37.15"></a><span id="l37.15"> </span>
<a href="#l37.16"></a><span id="l37.16">     /**</span>
<a href="#l37.17"></a><span id="l37.17">      * Returns the default transparency to apply for an event depending on whether its an all-day event</span>
<a href="#l37.18"></a><span id="l37.18">      *</span>
<a href="#l37.19"></a><span id="l37.19">      * @param aIsAllDay      If true, the default transparency for all-day events is returned</span>
<a href="#l37.20"></a><span id="l37.20">      */</span>
<a href="#l37.21"></a><span id="l37.21">     getEventDefaultTransparency: function(aIsAllDay) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/calendar/base/modules/calXMLUtils.jsm</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/calendar/base/modules/calXMLUtils.jsm</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -130,17 +130,17 @@ cal.xml.parseString = function(str, docU</span>
<a href="#l38.4"></a><span id="l38.4">  *</span>
<a href="#l38.5"></a><span id="l38.5">  * @param uri       The URI to read.</span>
<a href="#l38.6"></a><span id="l38.6">  * @return          The DOM Document resulting from the file.</span>
<a href="#l38.7"></a><span id="l38.7">  */</span>
<a href="#l38.8"></a><span id="l38.8"> cal.xml.parseFile = function(uri) {</span>
<a href="#l38.9"></a><span id="l38.9">     let req = Components.classes[&quot;@mozilla.org/xmlextras/xmlhttprequest;1&quot;]</span>
<a href="#l38.10"></a><span id="l38.10">                         .createInstance(Components.interfaces.nsIXMLHttpRequest);</span>
<a href="#l38.11"></a><span id="l38.11"> </span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-    req.open('GET', uri, false);</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+    req.open(&quot;GET&quot;, uri, false);</span>
<a href="#l38.14"></a><span id="l38.14">     req.overrideMimeType(&quot;text/xml&quot;);</span>
<a href="#l38.15"></a><span id="l38.15">     req.send(null);</span>
<a href="#l38.16"></a><span id="l38.16">     return req.responseXML;</span>
<a href="#l38.17"></a><span id="l38.17"> };</span>
<a href="#l38.18"></a><span id="l38.18"> </span>
<a href="#l38.19"></a><span id="l38.19"> /**</span>
<a href="#l38.20"></a><span id="l38.20">  * Serialize the DOM tree into a string.</span>
<a href="#l38.21"></a><span id="l38.21">  *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/calendar/base/src/calCalendarManager.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/calendar/base/src/calCalendarManager.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -121,17 +121,17 @@ calCalendarManager.prototype = {</span>
<a href="#l39.4"></a><span id="l39.4">                         // from the calendar provider context.</span>
<a href="#l39.5"></a><span id="l39.5">                         let authHeader = channel.getResponseHeader(&quot;WWW-Authenticate&quot;);</span>
<a href="#l39.6"></a><span id="l39.6">                         let calendar = channel.notificationCallbacks</span>
<a href="#l39.7"></a><span id="l39.7">                                               .getInterface(Components.interfaces.calICalendar);</span>
<a href="#l39.8"></a><span id="l39.8">                         if (calendar &amp;&amp; !calendar.getProperty(&quot;capabilities.realmrewrite.disabled&quot;)) {</span>
<a href="#l39.9"></a><span id="l39.9">                             // The provider may choose to explicitly disable the</span>
<a href="#l39.10"></a><span id="l39.10">                             // rewriting, for example if all calendars on a</span>
<a href="#l39.11"></a><span id="l39.11">                             // domain have the same credentials</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-                            let escapedName = calendar.name.replace(/\\/g, '\\\\')</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+                            let escapedName = calendar.name.replace(/\\/g, &quot;\\\\&quot;)</span>
<a href="#l39.14"></a><span id="l39.14">                                                            .replace(/\&quot;/g, '\\&quot;');</span>
<a href="#l39.15"></a><span id="l39.15">                             authHeader = appendToRealm(authHeader, &quot;(&quot; + escapedName + &quot;)&quot;);</span>
<a href="#l39.16"></a><span id="l39.16">                             channel.setResponseHeader(&quot;WWW-Authenticate&quot;, authHeader, false);</span>
<a href="#l39.17"></a><span id="l39.17">                         }</span>
<a href="#l39.18"></a><span id="l39.18">                     }</span>
<a href="#l39.19"></a><span id="l39.19">                 } catch (e) {</span>
<a href="#l39.20"></a><span id="l39.20">                     if (e.result != Components.results.NS_NOINTERFACE &amp;&amp;</span>
<a href="#l39.21"></a><span id="l39.21">                         e.result != Components.results.NS_ERROR_NOT_AVAILABLE) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/calendar/base/src/calIcsParser.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/calendar/base/src/calIcsParser.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -27,20 +27,20 @@ calIcsParser.prototype = {</span>
<a href="#l40.4"></a><span id="l40.4">     }),</span>
<a href="#l40.5"></a><span id="l40.5"> </span>
<a href="#l40.6"></a><span id="l40.6">     processIcalComponent: function ip_processIcalComponent(rootComp, aAsyncParsing) {</span>
<a href="#l40.7"></a><span id="l40.7">         let calComp;</span>
<a href="#l40.8"></a><span id="l40.8">         // libical returns the vcalendar component if there is just one vcalendar.</span>
<a href="#l40.9"></a><span id="l40.9">         // If there are multiple vcalendars, it returns an xroot component, with</span>
<a href="#l40.10"></a><span id="l40.10">         // vcalendar children. We need to handle both cases.</span>
<a href="#l40.11"></a><span id="l40.11">         if (rootComp) {</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-            if (rootComp.componentType == 'VCALENDAR') {</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+            if (rootComp.componentType == &quot;VCALENDAR&quot;) {</span>
<a href="#l40.14"></a><span id="l40.14">                 calComp = rootComp;</span>
<a href="#l40.15"></a><span id="l40.15">             } else {</span>
<a href="#l40.16"></a><span id="l40.16" class="difflineminus">-                calComp = rootComp.getFirstSubcomponent('VCALENDAR');</span>
<a href="#l40.17"></a><span id="l40.17" class="difflineplus">+                calComp = rootComp.getFirstSubcomponent(&quot;VCALENDAR&quot;);</span>
<a href="#l40.18"></a><span id="l40.18">             }</span>
<a href="#l40.19"></a><span id="l40.19">         }</span>
<a href="#l40.20"></a><span id="l40.20"> </span>
<a href="#l40.21"></a><span id="l40.21">         if (!calComp) {</span>
<a href="#l40.22"></a><span id="l40.22">             cal.ERROR(&quot;Parser Error. Could not find 'VCALENDAR' component: \n&quot; +</span>
<a href="#l40.23"></a><span id="l40.23">                       rootComp + &quot;\nStack: \n&quot; + cal.STACK(10));</span>
<a href="#l40.24"></a><span id="l40.24">         }</span>
<a href="#l40.25"></a><span id="l40.25"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/calendar/base/src/calIcsSerializer.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/calendar/base/src/calIcsSerializer.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -49,17 +49,17 @@ calIcsSerializer.prototype = {</span>
<a href="#l41.4"></a><span id="l41.4"> </span>
<a href="#l41.5"></a><span id="l41.5">     serializeToStream: function is_serializeToStream(aStream) {</span>
<a href="#l41.6"></a><span id="l41.6">         let str = this.serializeToString();</span>
<a href="#l41.7"></a><span id="l41.7"> </span>
<a href="#l41.8"></a><span id="l41.8">         // Convert the javascript string to an array of bytes, using the</span>
<a href="#l41.9"></a><span id="l41.9">         // UTF8 encoder</span>
<a href="#l41.10"></a><span id="l41.10">         let convStream = Components.classes[&quot;@mozilla.org/intl/converter-output-stream;1&quot;]</span>
<a href="#l41.11"></a><span id="l41.11">                                    .createInstance(Components.interfaces.nsIConverterOutputStream);</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-        convStream.init(aStream, 'UTF-8', 0, 0x0000);</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+        convStream.init(aStream, &quot;UTF-8&quot;, 0, 0x0000);</span>
<a href="#l41.14"></a><span id="l41.14"> </span>
<a href="#l41.15"></a><span id="l41.15">         convStream.writeString(str);</span>
<a href="#l41.16"></a><span id="l41.16">         convStream.close();</span>
<a href="#l41.17"></a><span id="l41.17">     },</span>
<a href="#l41.18"></a><span id="l41.18"> </span>
<a href="#l41.19"></a><span id="l41.19">     getIcalComponent: function is_getIcalComponent() {</span>
<a href="#l41.20"></a><span id="l41.20">         let calComp = getIcsService().createIcalComponent(&quot;VCALENDAR&quot;);</span>
<a href="#l41.21"></a><span id="l41.21">         calSetProdidVersion(calComp);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/calendar/base/src/calTimezoneService.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/calendar/base/src/calTimezoneService.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -98,17 +98,17 @@ calTimezoneService.prototype = {</span>
<a href="#l42.4"></a><span id="l42.4">                         reject(ex);</span>
<a href="#l42.5"></a><span id="l42.5">                     }</span>
<a href="#l42.6"></a><span id="l42.6">                 });</span>
<a href="#l42.7"></a><span id="l42.7">             });</span>
<a href="#l42.8"></a><span id="l42.8">         }</span>
<a href="#l42.9"></a><span id="l42.9"> </span>
<a href="#l42.10"></a><span id="l42.10">         let resNamespace = &quot;calendar&quot;;</span>
<a href="#l42.11"></a><span id="l42.11">         // Check for presence of the calendar timezones add-on.</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-        let resProtocol = Services.io.getProtocolHandler('resource')</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+        let resProtocol = Services.io.getProtocolHandler(&quot;resource&quot;)</span>
<a href="#l42.14"></a><span id="l42.14">                                   .QueryInterface(Components.interfaces.nsIResProtocolHandler);</span>
<a href="#l42.15"></a><span id="l42.15">         if (resProtocol.hasSubstitution(&quot;calendar-timezones&quot;)) {</span>
<a href="#l42.16"></a><span id="l42.16">             resNamespace = &quot;calendar-timezones&quot;;</span>
<a href="#l42.17"></a><span id="l42.17">         }</span>
<a href="#l42.18"></a><span id="l42.18"> </span>
<a href="#l42.19"></a><span id="l42.19">         fetchJSON(&quot;resource://&quot; + resNamespace + &quot;/timezones/zones.json&quot;).then((tzData) =&gt; {</span>
<a href="#l42.20"></a><span id="l42.20">             for (let tzid of Object.keys(tzData.aliases)) {</span>
<a href="#l42.21"></a><span id="l42.21">                 let data = tzData.aliases[tzid];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/calendar/base/src/calTransactionManager.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/calendar/base/src/calTransactionManager.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -154,20 +154,20 @@ calTransaction.prototype = {</span>
<a href="#l43.4"></a><span id="l43.4">                                        aCount,</span>
<a href="#l43.5"></a><span id="l43.5">                                        aItems);</span>
<a href="#l43.6"></a><span id="l43.6">         }</span>
<a href="#l43.7"></a><span id="l43.7">     },</span>
<a href="#l43.8"></a><span id="l43.8"> </span>
<a href="#l43.9"></a><span id="l43.9">     doTransaction: function cT_doTransaction() {</span>
<a href="#l43.10"></a><span id="l43.10">         this.mIsDoTransaction = true;</span>
<a href="#l43.11"></a><span id="l43.11">         switch (this.mAction) {</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-            case 'add':</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+            case &quot;add&quot;:</span>
<a href="#l43.14"></a><span id="l43.14">                 this.mCalendar.addItem(this.mItem, this);</span>
<a href="#l43.15"></a><span id="l43.15">                 break;</span>
<a href="#l43.16"></a><span id="l43.16" class="difflineminus">-            case 'modify':</span>
<a href="#l43.17"></a><span id="l43.17" class="difflineplus">+            case &quot;modify&quot;:</span>
<a href="#l43.18"></a><span id="l43.18">                 if (this.mItem.calendar.id != this.mOldItem.calendar.id) {</span>
<a href="#l43.19"></a><span id="l43.19">                     let self = this;</span>
<a href="#l43.20"></a><span id="l43.20">                     let addListener = {</span>
<a href="#l43.21"></a><span id="l43.21">                         onOperationComplete: function cT_onOperationComplete(aCalendar,</span>
<a href="#l43.22"></a><span id="l43.22">                                                                              aStatus,</span>
<a href="#l43.23"></a><span id="l43.23">                                                                              aOperationType,</span>
<a href="#l43.24"></a><span id="l43.24">                                                                              aId,</span>
<a href="#l43.25"></a><span id="l43.25">                                                                              aDetail) {</span>
<a href="#l43.26"></a><span id="l43.26" class="difflineat">@@ -181,41 +181,41 @@ calTransaction.prototype = {</span>
<a href="#l43.27"></a><span id="l43.27">                     this.mOldCalendar = this.mOldItem.calendar;</span>
<a href="#l43.28"></a><span id="l43.28">                     this.mCalendar.addItem(this.mItem, addListener);</span>
<a href="#l43.29"></a><span id="l43.29">                 } else {</span>
<a href="#l43.30"></a><span id="l43.30">                     this.mCalendar.modifyItem(cal.itip.prepareSequence(this.mItem, this.mOldItem),</span>
<a href="#l43.31"></a><span id="l43.31">                                               this.mOldItem,</span>
<a href="#l43.32"></a><span id="l43.32">                                               this);</span>
<a href="#l43.33"></a><span id="l43.33">                 }</span>
<a href="#l43.34"></a><span id="l43.34">                 break;</span>
<a href="#l43.35"></a><span id="l43.35" class="difflineminus">-            case 'delete':</span>
<a href="#l43.36"></a><span id="l43.36" class="difflineplus">+            case &quot;delete&quot;:</span>
<a href="#l43.37"></a><span id="l43.37">                 this.mCalendar.deleteItem(this.mItem, this);</span>
<a href="#l43.38"></a><span id="l43.38">                 break;</span>
<a href="#l43.39"></a><span id="l43.39">             default:</span>
<a href="#l43.40"></a><span id="l43.40">                 throw new Components.Exception(&quot;Invalid action specified&quot;,</span>
<a href="#l43.41"></a><span id="l43.41">                                                Components.results.NS_ERROR_ILLEGAL_VALUE);</span>
<a href="#l43.42"></a><span id="l43.42">         }</span>
<a href="#l43.43"></a><span id="l43.43">     },</span>
<a href="#l43.44"></a><span id="l43.44"> </span>
<a href="#l43.45"></a><span id="l43.45">     undoTransaction: function cT_undoTransaction() {</span>
<a href="#l43.46"></a><span id="l43.46">         this.mIsDoTransaction = false;</span>
<a href="#l43.47"></a><span id="l43.47">         switch (this.mAction) {</span>
<a href="#l43.48"></a><span id="l43.48" class="difflineminus">-            case 'add':</span>
<a href="#l43.49"></a><span id="l43.49" class="difflineplus">+            case &quot;add&quot;:</span>
<a href="#l43.50"></a><span id="l43.50">                 this.mCalendar.deleteItem(this.mItem, this);</span>
<a href="#l43.51"></a><span id="l43.51">                 break;</span>
<a href="#l43.52"></a><span id="l43.52" class="difflineminus">-            case 'modify':</span>
<a href="#l43.53"></a><span id="l43.53" class="difflineplus">+            case &quot;modify&quot;:</span>
<a href="#l43.54"></a><span id="l43.54">                 if (this.mOldItem.calendar.id != this.mItem.calendar.id) {</span>
<a href="#l43.55"></a><span id="l43.55">                     this.mCalendar.deleteItem(this.mItem, this);</span>
<a href="#l43.56"></a><span id="l43.56">                     this.mOldCalendar.addItem(this.mOldItem, this);</span>
<a href="#l43.57"></a><span id="l43.57">                 } else {</span>
<a href="#l43.58"></a><span id="l43.58">                     this.mCalendar.modifyItem(cal.itip.prepareSequence(this.mOldItem, this.mItem),</span>
<a href="#l43.59"></a><span id="l43.59">                                               this.mItem, this);</span>
<a href="#l43.60"></a><span id="l43.60">                 }</span>
<a href="#l43.61"></a><span id="l43.61">                 break;</span>
<a href="#l43.62"></a><span id="l43.62" class="difflineminus">-            case 'delete':</span>
<a href="#l43.63"></a><span id="l43.63" class="difflineplus">+            case &quot;delete&quot;:</span>
<a href="#l43.64"></a><span id="l43.64">                 this.mCalendar.addItem(this.mItem, this);</span>
<a href="#l43.65"></a><span id="l43.65">                 break;</span>
<a href="#l43.66"></a><span id="l43.66">             default:</span>
<a href="#l43.67"></a><span id="l43.67">                 throw new Components.Exception(&quot;Invalid action specified&quot;,</span>
<a href="#l43.68"></a><span id="l43.68">                                                Components.results.NS_ERROR_ILLEGAL_VALUE);</span>
<a href="#l43.69"></a><span id="l43.69">         }</span>
<a href="#l43.70"></a><span id="l43.70">     },</span>
<a href="#l43.71"></a><span id="l43.71"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/calendar/base/src/calUtils.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/calendar/base/src/calUtils.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -710,17 +710,17 @@ function calGetString(aBundleName, aStri</span>
<a href="#l44.4"></a><span id="l44.4"> /**</span>
<a href="#l44.5"></a><span id="l44.5">  * Make a UUID using the UUIDGenerator service available, we'll use that.</span>
<a href="#l44.6"></a><span id="l44.6">  */</span>
<a href="#l44.7"></a><span id="l44.7"> function getUUID() {</span>
<a href="#l44.8"></a><span id="l44.8">     let uuidGen = Components.classes[&quot;@mozilla.org/uuid-generator;1&quot;]</span>
<a href="#l44.9"></a><span id="l44.9">                   .getService(Components.interfaces.nsIUUIDGenerator);</span>
<a href="#l44.10"></a><span id="l44.10">     // generate uuids without braces to avoid problems with</span>
<a href="#l44.11"></a><span id="l44.11">     // CalDAV servers that don't support filenames with {}</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-    return uuidGen.generateUUID().toString().replace(/[{}]/g, '');</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+    return uuidGen.generateUUID().toString().replace(/[{}]/g, &quot;&quot;);</span>
<a href="#l44.14"></a><span id="l44.14"> }</span>
<a href="#l44.15"></a><span id="l44.15"> </span>
<a href="#l44.16"></a><span id="l44.16"> /**</span>
<a href="#l44.17"></a><span id="l44.17">  * Due to a bug in js-wrapping, normal == comparison can fail when we</span>
<a href="#l44.18"></a><span id="l44.18">  * have 2 objects.  Use these functions to force them both to get wrapped</span>
<a href="#l44.19"></a><span id="l44.19">  * the same way, allowing for normal comparison.</span>
<a href="#l44.20"></a><span id="l44.20">  */</span>
<a href="#l44.21"></a><span id="l44.21"> </span>
<a href="#l44.22"></a><span id="l44.22" class="difflineat">@@ -943,42 +943,42 @@ function LOG(aArg) {</span>
<a href="#l44.23"></a><span id="l44.23">     }</span>
<a href="#l44.24"></a><span id="l44.24"> </span>
<a href="#l44.25"></a><span id="l44.25">     ASSERT(aArg, &quot;Bad log argument.&quot;, false);</span>
<a href="#l44.26"></a><span id="l44.26">     let string = aArg;</span>
<a href="#l44.27"></a><span id="l44.27">     // We should just dump() both String objects, and string primitives.</span>
<a href="#l44.28"></a><span id="l44.28">     if (!(aArg instanceof String) &amp;&amp; !(typeof aArg == &quot;string&quot;)) {</span>
<a href="#l44.29"></a><span id="l44.29">         string = &quot;Logging object...\n&quot;;</span>
<a href="#l44.30"></a><span id="l44.30">         for (let prop in aArg) {</span>
<a href="#l44.31"></a><span id="l44.31" class="difflineminus">-            string += prop + ': ' + aArg[prop] + '\n';</span>
<a href="#l44.32"></a><span id="l44.32" class="difflineplus">+            string += prop + &quot;: &quot; + aArg[prop] + &quot;\n&quot;;</span>
<a href="#l44.33"></a><span id="l44.33">         }</span>
<a href="#l44.34"></a><span id="l44.34">         string += &quot;End object\n&quot;;</span>
<a href="#l44.35"></a><span id="l44.35">     }</span>
<a href="#l44.36"></a><span id="l44.36"> </span>
<a href="#l44.37"></a><span id="l44.37" class="difflineminus">-    dump(string + '\n');</span>
<a href="#l44.38"></a><span id="l44.38" class="difflineplus">+    dump(string + &quot;\n&quot;);</span>
<a href="#l44.39"></a><span id="l44.39">     _log(string, Components.interfaces.nsIScriptError.infoFlag);</span>
<a href="#l44.40"></a><span id="l44.40"> }</span>
<a href="#l44.41"></a><span id="l44.41"> </span>
<a href="#l44.42"></a><span id="l44.42"> /**</span>
<a href="#l44.43"></a><span id="l44.43">  * Dumps a warning to both console and js console.</span>
<a href="#l44.44"></a><span id="l44.44">  *</span>
<a href="#l44.45"></a><span id="l44.45">  * @param aMessage warning message</span>
<a href="#l44.46"></a><span id="l44.46">  */</span>
<a href="#l44.47"></a><span id="l44.47"> function WARN(aMessage) {</span>
<a href="#l44.48"></a><span id="l44.48" class="difflineminus">-    dump(&quot;Warning: &quot; + aMessage + '\n');</span>
<a href="#l44.49"></a><span id="l44.49" class="difflineplus">+    dump(&quot;Warning: &quot; + aMessage + &quot;\n&quot;);</span>
<a href="#l44.50"></a><span id="l44.50">     _log(aMessage, Components.interfaces.nsIScriptError.warningFlag);</span>
<a href="#l44.51"></a><span id="l44.51"> }</span>
<a href="#l44.52"></a><span id="l44.52"> </span>
<a href="#l44.53"></a><span id="l44.53"> /**</span>
<a href="#l44.54"></a><span id="l44.54">  * Dumps an error to both console and js console.</span>
<a href="#l44.55"></a><span id="l44.55">  *</span>
<a href="#l44.56"></a><span id="l44.56">  * @param aMessage error message</span>
<a href="#l44.57"></a><span id="l44.57">  */</span>
<a href="#l44.58"></a><span id="l44.58"> function ERROR(aMessage) {</span>
<a href="#l44.59"></a><span id="l44.59" class="difflineminus">-    dump(&quot;Error: &quot; + aMessage + '\n');</span>
<a href="#l44.60"></a><span id="l44.60" class="difflineplus">+    dump(&quot;Error: &quot; + aMessage + &quot;\n&quot;);</span>
<a href="#l44.61"></a><span id="l44.61">     _log(aMessage, Components.interfaces.nsIScriptError.errorFlag);</span>
<a href="#l44.62"></a><span id="l44.62"> }</span>
<a href="#l44.63"></a><span id="l44.63"> </span>
<a href="#l44.64"></a><span id="l44.64"> /**</span>
<a href="#l44.65"></a><span id="l44.65">  * Returns a string describing the current js-stack with filename and line</span>
<a href="#l44.66"></a><span id="l44.66">  * numbers.</span>
<a href="#l44.67"></a><span id="l44.67">  *</span>
<a href="#l44.68"></a><span id="l44.68">  * @param aDepth (optional) The number of frames to include. Defaults to 5.</span>
<a href="#l44.69"></a><span id="l44.69" class="difflineat">@@ -1008,17 +1008,17 @@ function STACK(aDepth, aSkip) {</span>
<a href="#l44.70"></a><span id="l44.70">  *                    if false, code flow will continue</span>
<a href="#l44.71"></a><span id="l44.71">  *                    may be a result code</span>
<a href="#l44.72"></a><span id="l44.72">  */</span>
<a href="#l44.73"></a><span id="l44.73"> function ASSERT(aCondition, aMessage, aCritical) {</span>
<a href="#l44.74"></a><span id="l44.74">     if (aCondition) {</span>
<a href="#l44.75"></a><span id="l44.75">         return;</span>
<a href="#l44.76"></a><span id="l44.76">     }</span>
<a href="#l44.77"></a><span id="l44.77"> </span>
<a href="#l44.78"></a><span id="l44.78" class="difflineminus">-    let string = &quot;Assert failed: &quot; + aMessage + '\n' + STACK(0, 1);</span>
<a href="#l44.79"></a><span id="l44.79" class="difflineplus">+    let string = &quot;Assert failed: &quot; + aMessage + &quot;\n&quot; + STACK(0, 1);</span>
<a href="#l44.80"></a><span id="l44.80">     if (aCritical) {</span>
<a href="#l44.81"></a><span id="l44.81">         throw new Components.Exception(string,</span>
<a href="#l44.82"></a><span id="l44.82">                                        aCritical === true ? Components.results.NS_ERROR_UNEXPECTED : aCritical);</span>
<a href="#l44.83"></a><span id="l44.83">     } else {</span>
<a href="#l44.84"></a><span id="l44.84">         Components.utils.reportError(string);</span>
<a href="#l44.85"></a><span id="l44.85">     }</span>
<a href="#l44.86"></a><span id="l44.86"> }</span>
<a href="#l44.87"></a><span id="l44.87"> </span>
<a href="#l44.88"></a><span id="l44.88" class="difflineat">@@ -1866,17 +1866,17 @@ function binaryInsert(itemArray, item, c</span>
<a href="#l44.89"></a><span id="l44.89">  * which means there will be one instance per app. If called as</span>
<a href="#l44.90"></a><span id="l44.90">  * &quot;getCompositeCalendar()&quot; from chrome code, then it will get a window-specific</span>
<a href="#l44.91"></a><span id="l44.91">  * composite calendar, which is often what is wanted</span>
<a href="#l44.92"></a><span id="l44.92">  */</span>
<a href="#l44.93"></a><span id="l44.93"> function getCompositeCalendar() {</span>
<a href="#l44.94"></a><span id="l44.94">     if (getCompositeCalendar.mObject === undefined) {</span>
<a href="#l44.95"></a><span id="l44.95">         getCompositeCalendar.mObject = Components.classes[&quot;@mozilla.org/calendar/calendar;1?type=composite&quot;]</span>
<a href="#l44.96"></a><span id="l44.96">                                                  .createInstance(Components.interfaces.calICompositeCalendar);</span>
<a href="#l44.97"></a><span id="l44.97" class="difflineminus">-        getCompositeCalendar.mObject.prefPrefix = 'calendar-main';</span>
<a href="#l44.98"></a><span id="l44.98" class="difflineplus">+        getCompositeCalendar.mObject.prefPrefix = &quot;calendar-main&quot;;</span>
<a href="#l44.99"></a><span id="l44.99"> </span>
<a href="#l44.100"></a><span id="l44.100">         try {</span>
<a href="#l44.101"></a><span id="l44.101">             if (gCalendarStatusFeedback) {</span>
<a href="#l44.102"></a><span id="l44.102">                 // If we are in a window that has calendar status feedback, set up</span>
<a href="#l44.103"></a><span id="l44.103">                 // our status observer.</span>
<a href="#l44.104"></a><span id="l44.104">                 let chromeWindow = window.QueryInterface(Components.interfaces.nsIDOMChromeWindow);</span>
<a href="#l44.105"></a><span id="l44.105">                 getCompositeCalendar.mObject.setStatusObserver(gCalendarStatusFeedback, chromeWindow);</span>
<a href="#l44.106"></a><span id="l44.106">             }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/calendar/import-export/calHtmlExport.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/calendar/import-export/calHtmlExport.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -24,21 +24,21 @@ calHtmlExporter.prototype = {</span>
<a href="#l45.4"></a><span id="l45.4">         classID: calHtmlExporterClassID,</span>
<a href="#l45.5"></a><span id="l45.5">         contractID: &quot;@mozilla.org/calendar/export;1?type=html&quot;,</span>
<a href="#l45.6"></a><span id="l45.6">         classDescription: &quot;Calendar HTML Exporter&quot;,</span>
<a href="#l45.7"></a><span id="l45.7">         interfaces: calHtmlExporterInterfaces</span>
<a href="#l45.8"></a><span id="l45.8">     }),</span>
<a href="#l45.9"></a><span id="l45.9"> </span>
<a href="#l45.10"></a><span id="l45.10">     getFileTypes: function getFileTypes(aCount) {</span>
<a href="#l45.11"></a><span id="l45.11">         aCount.value = 1;</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-        let wildmat = '*.html; *.htm';</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineminus">-        let label = cal.calGetString(&quot;calendar&quot;, 'filterHtml', [wildmat]);</span>
<a href="#l45.14"></a><span id="l45.14" class="difflineplus">+        let wildmat = &quot;*.html; *.htm&quot;;</span>
<a href="#l45.15"></a><span id="l45.15" class="difflineplus">+        let label = cal.calGetString(&quot;calendar&quot;, &quot;filterHtml&quot;, [wildmat]);</span>
<a href="#l45.16"></a><span id="l45.16">         return [{</span>
<a href="#l45.17"></a><span id="l45.17">             QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIFileType]),</span>
<a href="#l45.18"></a><span id="l45.18" class="difflineminus">-            defaultExtension: 'html',</span>
<a href="#l45.19"></a><span id="l45.19" class="difflineplus">+            defaultExtension: &quot;html&quot;,</span>
<a href="#l45.20"></a><span id="l45.20">             extensionFilter: wildmat,</span>
<a href="#l45.21"></a><span id="l45.21">             description: label</span>
<a href="#l45.22"></a><span id="l45.22">         }];</span>
<a href="#l45.23"></a><span id="l45.23">     },</span>
<a href="#l45.24"></a><span id="l45.24"> </span>
<a href="#l45.25"></a><span id="l45.25">     exportToStream: function html_exportToStream(aStream, aCount, aItems, aTitle) {</span>
<a href="#l45.26"></a><span id="l45.26">         let document = cal.xml.parseFile(&quot;chrome://calendar-common/skin/printing/calHtmlExport.html&quot;);</span>
<a href="#l45.27"></a><span id="l45.27">         let itemContainer = document.getElementById(&quot;item-container&quot;);</span>
<a href="#l45.28"></a><span id="l45.28" class="difflineat">@@ -104,12 +104,12 @@ calHtmlExporter.prototype = {</span>
<a href="#l45.29"></a><span id="l45.29">         }</span>
<a href="#l45.30"></a><span id="l45.30"> </span>
<a href="#l45.31"></a><span id="l45.31">         let templates = document.getElementById(&quot;templates&quot;);</span>
<a href="#l45.32"></a><span id="l45.32">         templates.remove();</span>
<a href="#l45.33"></a><span id="l45.33"> </span>
<a href="#l45.34"></a><span id="l45.34">         // Convert the javascript string to an array of bytes, using the utf8 encoder</span>
<a href="#l45.35"></a><span id="l45.35">         let convStream = Components.classes[&quot;@mozilla.org/intl/converter-output-stream;1&quot;]</span>
<a href="#l45.36"></a><span id="l45.36">                                    .createInstance(Components.interfaces.nsIConverterOutputStream);</span>
<a href="#l45.37"></a><span id="l45.37" class="difflineminus">-        convStream.init(aStream, 'UTF-8', 0, 0x0000);</span>
<a href="#l45.38"></a><span id="l45.38" class="difflineplus">+        convStream.init(aStream, &quot;UTF-8&quot;, 0, 0x0000);</span>
<a href="#l45.39"></a><span id="l45.39">         convStream.writeString(cal.xml.serializeDOM(document));</span>
<a href="#l45.40"></a><span id="l45.40">     }</span>
<a href="#l45.41"></a><span id="l45.41"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/calendar/import-export/calIcsImportExport.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/calendar/import-export/calIcsImportExport.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -9,19 +9,19 @@ Components.utils.import(&quot;resource://cale</span>
<a href="#l46.4"></a><span id="l46.4">  * ICS Import and Export Plugin</span>
<a href="#l46.5"></a><span id="l46.5">  */</span>
<a href="#l46.6"></a><span id="l46.6"> </span>
<a href="#l46.7"></a><span id="l46.7"> // Shared functions</span>
<a href="#l46.8"></a><span id="l46.8"> function getIcsFileTypes(aCount) {</span>
<a href="#l46.9"></a><span id="l46.9">     aCount.value = 1;</span>
<a href="#l46.10"></a><span id="l46.10">     return [{</span>
<a href="#l46.11"></a><span id="l46.11">         QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIFileType]),</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-        defaultExtension: 'ics',</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineminus">-        extensionFilter: '*.ics',</span>
<a href="#l46.14"></a><span id="l46.14" class="difflineminus">-        description: cal.calGetString(&quot;calendar&quot;, 'filterIcs', ['*.ics'])</span>
<a href="#l46.15"></a><span id="l46.15" class="difflineplus">+        defaultExtension: &quot;ics&quot;,</span>
<a href="#l46.16"></a><span id="l46.16" class="difflineplus">+        extensionFilter: &quot;*.ics&quot;,</span>
<a href="#l46.17"></a><span id="l46.17" class="difflineplus">+        description: cal.calGetString(&quot;calendar&quot;, &quot;filterIcs&quot;, [&quot;*.ics&quot;])</span>
<a href="#l46.18"></a><span id="l46.18">     }];</span>
<a href="#l46.19"></a><span id="l46.19"> }</span>
<a href="#l46.20"></a><span id="l46.20"> </span>
<a href="#l46.21"></a><span id="l46.21"> // Importer</span>
<a href="#l46.22"></a><span id="l46.22"> function calIcsImporter() {</span>
<a href="#l46.23"></a><span id="l46.23">     this.wrappedJSObject = this;</span>
<a href="#l46.24"></a><span id="l46.24"> }</span>
<a href="#l46.25"></a><span id="l46.25"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/calendar/import-export/calMonthGridPrinter.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/calendar/import-export/calMonthGridPrinter.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -98,17 +98,17 @@ calMonthPrinter.prototype = {</span>
<a href="#l47.4"></a><span id="l47.4">         // Remove templates from HTML, no longer needed</span>
<a href="#l47.5"></a><span id="l47.5">         let templates = document.getElementById(&quot;templates&quot;);</span>
<a href="#l47.6"></a><span id="l47.6">         templates.remove();</span>
<a href="#l47.7"></a><span id="l47.7"> </span>
<a href="#l47.8"></a><span id="l47.8">         // Stream out the resulting HTML</span>
<a href="#l47.9"></a><span id="l47.9">         let html = cal.xml.serializeDOM(document);</span>
<a href="#l47.10"></a><span id="l47.10">         let convStream = Components.classes[&quot;@mozilla.org/intl/converter-output-stream;1&quot;]</span>
<a href="#l47.11"></a><span id="l47.11">                                    .createInstance(Components.interfaces.nsIConverterOutputStream);</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-        convStream.init(aStream, 'UTF-8', 0, 0x0000);</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineplus">+        convStream.init(aStream, &quot;UTF-8&quot;, 0, 0x0000);</span>
<a href="#l47.14"></a><span id="l47.14">         convStream.writeString(html);</span>
<a href="#l47.15"></a><span id="l47.15">     },</span>
<a href="#l47.16"></a><span id="l47.16"> </span>
<a href="#l47.17"></a><span id="l47.17">     normalizeStartDate: function monthPrint_normalizeStartDate(aStart) {</span>
<a href="#l47.18"></a><span id="l47.18">         // Make sure the start date is really a date.</span>
<a href="#l47.19"></a><span id="l47.19">         let startDate = aStart.clone();</span>
<a href="#l47.20"></a><span id="l47.20">         startDate.isDate = true;</span>
<a href="#l47.21"></a><span id="l47.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -75,19 +75,19 @@ var localeNl = {</span>
<a href="#l48.4"></a><span id="l48.4"> var locales = [localeEn, localeNl];</span>
<a href="#l48.5"></a><span id="l48.5"> </span>
<a href="#l48.6"></a><span id="l48.6"> // Windows line endings, CSV files with LF only can't be read by Outlook.</span>
<a href="#l48.7"></a><span id="l48.7"> var exportLineEnding = &quot;\r\n&quot;;</span>
<a href="#l48.8"></a><span id="l48.8"> </span>
<a href="#l48.9"></a><span id="l48.9"> // Shared functions</span>
<a href="#l48.10"></a><span id="l48.10"> function getOutlookCsvFileTypes(aCount) {</span>
<a href="#l48.11"></a><span id="l48.11">     aCount.value = 1;</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-    let wildmat = '*.csv';</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineminus">-    let label = cal.calGetString(&quot;calendar&quot;, 'filterOutlookCsv', [wildmat]);</span>
<a href="#l48.14"></a><span id="l48.14" class="difflineminus">-    return [{ defaultExtension: 'csv',</span>
<a href="#l48.15"></a><span id="l48.15" class="difflineplus">+    let wildmat = &quot;*.csv&quot;;</span>
<a href="#l48.16"></a><span id="l48.16" class="difflineplus">+    let label = cal.calGetString(&quot;calendar&quot;, &quot;filterOutlookCsv&quot;, [wildmat]);</span>
<a href="#l48.17"></a><span id="l48.17" class="difflineplus">+    return [{ defaultExtension: &quot;csv&quot;,</span>
<a href="#l48.18"></a><span id="l48.18">               extensionFilter: wildmat,</span>
<a href="#l48.19"></a><span id="l48.19">               description: label }];</span>
<a href="#l48.20"></a><span id="l48.20"> }</span>
<a href="#l48.21"></a><span id="l48.21"> </span>
<a href="#l48.22"></a><span id="l48.22"> // Importer</span>
<a href="#l48.23"></a><span id="l48.23"> function calOutlookCSVImporter() {</span>
<a href="#l48.24"></a><span id="l48.24">     this.wrappedJSObject = this;</span>
<a href="#l48.25"></a><span id="l48.25"> }</span>
<a href="#l48.26"></a><span id="l48.26" class="difflineat">@@ -432,33 +432,33 @@ calOutlookCSVExporter.prototype = {</span>
<a href="#l48.27"></a><span id="l48.27">         function dateString(aDateTime) { return cal.dateTimeToJsDate(aDateTime).toLocaleFormat(localeEn.dateFormat); }</span>
<a href="#l48.28"></a><span id="l48.28">         function timeString(aDateTime) { return cal.dateTimeToJsDate(aDateTime).toLocaleFormat(localeEn.timeFormat); }</span>
<a href="#l48.29"></a><span id="l48.29">         function txtString(aString) { return aString || &quot;&quot;; }</span>
<a href="#l48.30"></a><span id="l48.30"> </span>
<a href="#l48.31"></a><span id="l48.31">         let str = &quot;&quot;;</span>
<a href="#l48.32"></a><span id="l48.32">         let headers = [];</span>
<a href="#l48.33"></a><span id="l48.33">         // Not using a loop here, since we need to be sure the order here matches</span>
<a href="#l48.34"></a><span id="l48.34">         // with the orders the field data is added later on</span>
<a href="#l48.35"></a><span id="l48.35" class="difflineminus">-        headers.push(localeEn['headTitle']);</span>
<a href="#l48.36"></a><span id="l48.36" class="difflineminus">-        headers.push(localeEn['headStartDate']);</span>
<a href="#l48.37"></a><span id="l48.37" class="difflineminus">-        headers.push(localeEn['headStartTime']);</span>
<a href="#l48.38"></a><span id="l48.38" class="difflineminus">-        headers.push(localeEn['headEndDate']);</span>
<a href="#l48.39"></a><span id="l48.39" class="difflineminus">-        headers.push(localeEn['headEndTime']);</span>
<a href="#l48.40"></a><span id="l48.40" class="difflineminus">-        headers.push(localeEn['headAllDayEvent']);</span>
<a href="#l48.41"></a><span id="l48.41" class="difflineminus">-        headers.push(localeEn['headAlarm']);</span>
<a href="#l48.42"></a><span id="l48.42" class="difflineminus">-        headers.push(localeEn['headAlarmDate']);</span>
<a href="#l48.43"></a><span id="l48.43" class="difflineminus">-        headers.push(localeEn['headAlarmTime']);</span>
<a href="#l48.44"></a><span id="l48.44" class="difflineminus">-        headers.push(localeEn['headCategories']);</span>
<a href="#l48.45"></a><span id="l48.45" class="difflineminus">-        headers.push(localeEn['headDescription']);</span>
<a href="#l48.46"></a><span id="l48.46" class="difflineminus">-        headers.push(localeEn['headLocation']);</span>
<a href="#l48.47"></a><span id="l48.47" class="difflineminus">-        headers.push(localeEn['headPrivate']);</span>
<a href="#l48.48"></a><span id="l48.48" class="difflineplus">+        headers.push(localeEn[&quot;headTitle&quot;]);</span>
<a href="#l48.49"></a><span id="l48.49" class="difflineplus">+        headers.push(localeEn[&quot;headStartDate&quot;]);</span>
<a href="#l48.50"></a><span id="l48.50" class="difflineplus">+        headers.push(localeEn[&quot;headStartTime&quot;]);</span>
<a href="#l48.51"></a><span id="l48.51" class="difflineplus">+        headers.push(localeEn[&quot;headEndDate&quot;]);</span>
<a href="#l48.52"></a><span id="l48.52" class="difflineplus">+        headers.push(localeEn[&quot;headEndTime&quot;]);</span>
<a href="#l48.53"></a><span id="l48.53" class="difflineplus">+        headers.push(localeEn[&quot;headAllDayEvent&quot;]);</span>
<a href="#l48.54"></a><span id="l48.54" class="difflineplus">+        headers.push(localeEn[&quot;headAlarm&quot;]);</span>
<a href="#l48.55"></a><span id="l48.55" class="difflineplus">+        headers.push(localeEn[&quot;headAlarmDate&quot;]);</span>
<a href="#l48.56"></a><span id="l48.56" class="difflineplus">+        headers.push(localeEn[&quot;headAlarmTime&quot;]);</span>
<a href="#l48.57"></a><span id="l48.57" class="difflineplus">+        headers.push(localeEn[&quot;headCategories&quot;]);</span>
<a href="#l48.58"></a><span id="l48.58" class="difflineplus">+        headers.push(localeEn[&quot;headDescription&quot;]);</span>
<a href="#l48.59"></a><span id="l48.59" class="difflineplus">+        headers.push(localeEn[&quot;headLocation&quot;]);</span>
<a href="#l48.60"></a><span id="l48.60" class="difflineplus">+        headers.push(localeEn[&quot;headPrivate&quot;]);</span>
<a href="#l48.61"></a><span id="l48.61">         headers = headers.map(function(v) {</span>
<a href="#l48.62"></a><span id="l48.62">             return '&quot;' + v + '&quot;';</span>
<a href="#l48.63"></a><span id="l48.63">         });</span>
<a href="#l48.64"></a><span id="l48.64" class="difflineminus">-        str = headers.join(',');</span>
<a href="#l48.65"></a><span id="l48.65" class="difflineplus">+        str = headers.join(&quot;,&quot;);</span>
<a href="#l48.66"></a><span id="l48.66">         str += exportLineEnding;</span>
<a href="#l48.67"></a><span id="l48.67">         aStream.write(str, str.length);</span>
<a href="#l48.68"></a><span id="l48.68"> </span>
<a href="#l48.69"></a><span id="l48.69">         for (let item of aItems) {</span>
<a href="#l48.70"></a><span id="l48.70">             if (!cal.isEvent(item)) {</span>
<a href="#l48.71"></a><span id="l48.71">                 // XXX TODO: warn the user (once) that tasks are not supported</span>
<a href="#l48.72"></a><span id="l48.72">                 // (bug 336175)</span>
<a href="#l48.73"></a><span id="l48.73">                 continue;</span>
<a href="#l48.74"></a><span id="l48.74" class="difflineat">@@ -482,13 +482,13 @@ calOutlookCSVExporter.prototype = {</span>
<a href="#l48.75"></a><span id="l48.75">             line.push(txtString(item.getProperty(&quot;DESCRIPTION&quot;)));</span>
<a href="#l48.76"></a><span id="l48.76">             line.push(txtString(item.getProperty(&quot;LOCATION&quot;)));</span>
<a href="#l48.77"></a><span id="l48.77">             line.push(item.privacy == &quot;PRIVATE&quot; ? localeEn.valueTrue : localeEn.valueFalse);</span>
<a href="#l48.78"></a><span id="l48.78"> </span>
<a href="#l48.79"></a><span id="l48.79">             line = line.map(function(v) {</span>
<a href="#l48.80"></a><span id="l48.80">                 v = String(v).replace(/&quot;/g, '&quot;&quot;');</span>
<a href="#l48.81"></a><span id="l48.81">                 return '&quot;' + v + '&quot;';</span>
<a href="#l48.82"></a><span id="l48.82">             });</span>
<a href="#l48.83"></a><span id="l48.83" class="difflineminus">-            str = line.join(',') + exportLineEnding;</span>
<a href="#l48.84"></a><span id="l48.84" class="difflineplus">+            str = line.join(&quot;,&quot;) + exportLineEnding;</span>
<a href="#l48.85"></a><span id="l48.85">             aStream.write(str, str.length);</span>
<a href="#l48.86"></a><span id="l48.86">         }</span>
<a href="#l48.87"></a><span id="l48.87">     }</span>
<a href="#l48.88"></a><span id="l48.88"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/calendar/import-export/calWeekPrinter.js</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/calendar/import-export/calWeekPrinter.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -85,17 +85,17 @@ calWeekPrinter.prototype = {</span>
<a href="#l49.4"></a><span id="l49.4">         // Remove templates from HTML, no longer needed</span>
<a href="#l49.5"></a><span id="l49.5">         let templates = document.getElementById(&quot;templates&quot;);</span>
<a href="#l49.6"></a><span id="l49.6">         templates.remove();</span>
<a href="#l49.7"></a><span id="l49.7"> </span>
<a href="#l49.8"></a><span id="l49.8">         // Stream out the resulting HTML</span>
<a href="#l49.9"></a><span id="l49.9">         let html = cal.xml.serializeDOM(document);</span>
<a href="#l49.10"></a><span id="l49.10">         let convStream = Components.classes[&quot;@mozilla.org/intl/converter-output-stream;1&quot;]</span>
<a href="#l49.11"></a><span id="l49.11">                                    .createInstance(Components.interfaces.nsIConverterOutputStream);</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-        convStream.init(aStream, 'UTF-8', 0, 0x0000);</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineplus">+        convStream.init(aStream, &quot;UTF-8&quot;, 0, 0x0000);</span>
<a href="#l49.14"></a><span id="l49.14">         convStream.writeString(html);</span>
<a href="#l49.15"></a><span id="l49.15">     },</span>
<a href="#l49.16"></a><span id="l49.16"> </span>
<a href="#l49.17"></a><span id="l49.17">     setupWeek: function weekPrint_setupWeek(document, startOfWeek, dayTable) {</span>
<a href="#l49.18"></a><span id="l49.18">         const weekdayMap = [&quot;sunday&quot;, &quot;monday&quot;, &quot;tuesday&quot;, &quot;wednesday&quot;, &quot;thursday&quot;, &quot;friday&quot;, &quot;saturday&quot;];</span>
<a href="#l49.19"></a><span id="l49.19"> </span>
<a href="#l49.20"></a><span id="l49.20">         let weekTemplate = document.getElementById(&quot;week-template&quot;);</span>
<a href="#l49.21"></a><span id="l49.21">         let weekContainer = document.getElementById(&quot;week-container&quot;);</span>
<a href="#l49.22"></a><span id="l49.22" class="difflineat">@@ -105,17 +105,17 @@ calWeekPrinter.prototype = {</span>
<a href="#l49.23"></a><span id="l49.23">         let currentPage = weekTemplate.cloneNode(true);</span>
<a href="#l49.24"></a><span id="l49.24">         currentPage.removeAttribute(&quot;id&quot;);</span>
<a href="#l49.25"></a><span id="l49.25">         currentPage.item = startOfWeek.clone();</span>
<a href="#l49.26"></a><span id="l49.26"> </span>
<a href="#l49.27"></a><span id="l49.27">         // Set up the week number title</span>
<a href="#l49.28"></a><span id="l49.28">         let weekInfo = cal.getWeekInfoService();</span>
<a href="#l49.29"></a><span id="l49.29">         let dateFormatter = cal.getDateFormatter();</span>
<a href="#l49.30"></a><span id="l49.30">         let weekno = weekInfo.getWeekTitle(startOfWeek);</span>
<a href="#l49.31"></a><span id="l49.31" class="difflineminus">-        let weekTitle = cal.calGetString(&quot;calendar&quot;, 'WeekTitle', [weekno]);</span>
<a href="#l49.32"></a><span id="l49.32" class="difflineplus">+        let weekTitle = cal.calGetString(&quot;calendar&quot;, &quot;WeekTitle&quot;, [weekno]);</span>
<a href="#l49.33"></a><span id="l49.33">         currentPage.querySelector(&quot;.week-number&quot;).textContent = weekTitle;</span>
<a href="#l49.34"></a><span id="l49.34"> </span>
<a href="#l49.35"></a><span id="l49.35">         // Set up the day boxes</span>
<a href="#l49.36"></a><span id="l49.36">         let endOfWeek = weekInfo.getEndOfWeek(startOfWeek);</span>
<a href="#l49.37"></a><span id="l49.37">         for (let currentDate = startOfWeek.clone(); currentDate.compare(endOfWeek) &lt;= 0; currentDate.day++) {</span>
<a href="#l49.38"></a><span id="l49.38">             let weekday = currentDate.weekday;</span>
<a href="#l49.39"></a><span id="l49.39">             let weekdayName = weekdayMap[weekday];</span>
<a href="#l49.40"></a><span id="l49.40">             let dayOffPrefName = &quot;calendar.week.d&quot; + weekday + weekdayName + &quot;soff&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/calendar/itip/calItipEmailTransport.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/calendar/itip/calItipEmailTransport.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -257,17 +257,17 @@ calItipEmailTransport.prototype = {</span>
<a href="#l50.4"></a><span id="l50.4">                     }</span>
<a href="#l50.5"></a><span id="l50.5">                     return email;</span>
<a href="#l50.6"></a><span id="l50.6">                 };</span>
<a href="#l50.7"></a><span id="l50.7">                 let toMap = aToList.map(cbEmail).filter(v =&gt; v.length);</span>
<a href="#l50.8"></a><span id="l50.8">                 if (toMap.length &lt; aToList.length) {</span>
<a href="#l50.9"></a><span id="l50.9">                     // at least one invalid recipient, so we skip sending for this message</span>
<a href="#l50.10"></a><span id="l50.10">                     return false;</span>
<a href="#l50.11"></a><span id="l50.11">                 }</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-                let toList = toMap.join(', ');</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+                let toList = toMap.join(&quot;, &quot;);</span>
<a href="#l50.14"></a><span id="l50.14">                 let composeUtils = Components.classes[&quot;@mozilla.org/messengercompose/computils;1&quot;]</span>
<a href="#l50.15"></a><span id="l50.15">                                              .createInstance(Components.interfaces.nsIMsgCompUtils);</span>
<a href="#l50.16"></a><span id="l50.16">                 let messageId = composeUtils.msgGenerateMessageId(identity);</span>
<a href="#l50.17"></a><span id="l50.17">                 let mailFile = this._createTempImipFile(compatMode, toList, aSubject, aBody, aItem, identity, messageId);</span>
<a href="#l50.18"></a><span id="l50.18">                 if (mailFile) {</span>
<a href="#l50.19"></a><span id="l50.19">                     // compose fields for message: from/to etc need to be specified both here and in the file</span>
<a href="#l50.20"></a><span id="l50.20">                     let composeFields = Components.classes[&quot;@mozilla.org/messengercompose/composefields;1&quot;]</span>
<a href="#l50.21"></a><span id="l50.21">                                                   .createInstance(Components.interfaces.nsIMsgCompFields);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/calendar/lightning/components/lightningTextCalendarConverter.js</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/calendar/lightning/components/lightningTextCalendarConverter.js</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -43,21 +43,21 @@ ltnMimeConverter.prototype = {</span>
<a href="#l51.4"></a><span id="l51.4">                         item = exc;</span>
<a href="#l51.5"></a><span id="l51.5">                     }</span>
<a href="#l51.6"></a><span id="l51.6">                 }</span>
<a href="#l51.7"></a><span id="l51.7">                 event = item;</span>
<a href="#l51.8"></a><span id="l51.8">                 break;</span>
<a href="#l51.9"></a><span id="l51.9">             }</span>
<a href="#l51.10"></a><span id="l51.10">         }</span>
<a href="#l51.11"></a><span id="l51.11">         if (!event) {</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-            return '';</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineplus">+            return &quot;&quot;;</span>
<a href="#l51.14"></a><span id="l51.14">         }</span>
<a href="#l51.15"></a><span id="l51.15"> </span>
<a href="#l51.16"></a><span id="l51.16">         let itipItem = null;</span>
<a href="#l51.17"></a><span id="l51.17" class="difflineminus">-        let msgOverlay = '';</span>
<a href="#l51.18"></a><span id="l51.18" class="difflineplus">+        let msgOverlay = &quot;&quot;;</span>
<a href="#l51.19"></a><span id="l51.19"> </span>
<a href="#l51.20"></a><span id="l51.20">         try {</span>
<a href="#l51.21"></a><span id="l51.21">             itipItem = Components.classes[&quot;@mozilla.org/calendar/itip-item;1&quot;]</span>
<a href="#l51.22"></a><span id="l51.22">                                  .createInstance(Components.interfaces.calIItipItem);</span>
<a href="#l51.23"></a><span id="l51.23">             itipItem.init(data);</span>
<a href="#l51.24"></a><span id="l51.24">             let dom = ltn.invitation.createInvitationOverlay(event, itipItem);</span>
<a href="#l51.25"></a><span id="l51.25">             msgOverlay = cal.xml.serializeDOM(dom);</span>
<a href="#l51.26"></a><span id="l51.26"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/calendar/lightning/content/html-item-editing/react-code.js</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/calendar/lightning/content/html-item-editing/react-code.js</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -11,72 +11,72 @@ var gTopComponent = null;</span>
<a href="#l52.4"></a><span id="l52.4"> var Tabstrip = React.createClass({</span>
<a href="#l52.5"></a><span id="l52.5">     handleChange: function(index) {</span>
<a href="#l52.6"></a><span id="l52.6">         // The click handler will update the state with</span>
<a href="#l52.7"></a><span id="l52.7">         // the index of the focused menu entry</span>
<a href="#l52.8"></a><span id="l52.8">         this.props.onInput(this.props.keyprop, index);</span>
<a href="#l52.9"></a><span id="l52.9">     },</span>
<a href="#l52.10"></a><span id="l52.10">     render: function() {</span>
<a href="#l52.11"></a><span id="l52.11">         return React.DOM.ul(</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-            { id: 'tabstrip' },</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineplus">+            { id: &quot;tabstrip&quot; },</span>
<a href="#l52.14"></a><span id="l52.14">             this.props.tabs.map((tab, index) =&gt; {</span>
<a href="#l52.15"></a><span id="l52.15" class="difflineminus">-                let style = (this.props.activeTab == index) ? 'activeTab' : '';</span>
<a href="#l52.16"></a><span id="l52.16" class="difflineplus">+                let style = (this.props.activeTab == index) ? &quot;activeTab&quot; : &quot;&quot;;</span>
<a href="#l52.17"></a><span id="l52.17">                 // The bind() method makes the index</span>
<a href="#l52.18"></a><span id="l52.18">                 // available to the handleChange function:</span>
<a href="#l52.19"></a><span id="l52.19">                 return React.DOM.li({</span>
<a href="#l52.20"></a><span id="l52.20" class="difflineminus">-                        className: style + ' tab',</span>
<a href="#l52.21"></a><span id="l52.21" class="difflineminus">-                        key: 'tabkey' + index,</span>
<a href="#l52.22"></a><span id="l52.22" class="difflineplus">+                        className: style + &quot; tab&quot;,</span>
<a href="#l52.23"></a><span id="l52.23" class="difflineplus">+                        key: &quot;tabkey&quot; + index,</span>
<a href="#l52.24"></a><span id="l52.24">                         onClick: this.handleChange.bind(this, index)</span>
<a href="#l52.25"></a><span id="l52.25">                     },</span>
<a href="#l52.26"></a><span id="l52.26">                     tab</span>
<a href="#l52.27"></a><span id="l52.27">                     );</span>
<a href="#l52.28"></a><span id="l52.28">                 }</span>
<a href="#l52.29"></a><span id="l52.29">             )</span>
<a href="#l52.30"></a><span id="l52.30">         );</span>
<a href="#l52.31"></a><span id="l52.31">     }</span>
<a href="#l52.32"></a><span id="l52.32"> });</span>
<a href="#l52.33"></a><span id="l52.33"> </span>
<a href="#l52.34"></a><span id="l52.34"> var TextField = React.createClass({</span>
<a href="#l52.35"></a><span id="l52.35">     handleChange: function(event) {</span>
<a href="#l52.36"></a><span id="l52.36">         this.props.onInput(this.props.keyprop, event.target.value);</span>
<a href="#l52.37"></a><span id="l52.37">     },</span>
<a href="#l52.38"></a><span id="l52.38">     render: function() {</span>
<a href="#l52.39"></a><span id="l52.39">         return React.DOM.input({</span>
<a href="#l52.40"></a><span id="l52.40" class="difflineminus">-            type: 'text',</span>
<a href="#l52.41"></a><span id="l52.41" class="difflineminus">-            // placeholder: 'New Event'</span>
<a href="#l52.42"></a><span id="l52.42" class="difflineplus">+            type: &quot;text&quot;,</span>
<a href="#l52.43"></a><span id="l52.43" class="difflineplus">+            // placeholder: &quot;New Event&quot;</span>
<a href="#l52.44"></a><span id="l52.44">             value: this.props.value,</span>
<a href="#l52.45"></a><span id="l52.45">             onChange: this.handleChange</span>
<a href="#l52.46"></a><span id="l52.46">         });</span>
<a href="#l52.47"></a><span id="l52.47">     }</span>
<a href="#l52.48"></a><span id="l52.48"> });</span>
<a href="#l52.49"></a><span id="l52.49"> </span>
<a href="#l52.50"></a><span id="l52.50"> var TextArea = React.createClass({</span>
<a href="#l52.51"></a><span id="l52.51">     handleChange: function(event) {</span>
<a href="#l52.52"></a><span id="l52.52">         this.props.onInput(this.props.keyprop, event.target.value);</span>
<a href="#l52.53"></a><span id="l52.53">     },</span>
<a href="#l52.54"></a><span id="l52.54">     render: function() {</span>
<a href="#l52.55"></a><span id="l52.55">         return React.DOM.textarea({</span>
<a href="#l52.56"></a><span id="l52.56" class="difflineminus">-            type: 'text',</span>
<a href="#l52.57"></a><span id="l52.57" class="difflineminus">-            // placeholder: 'New Event'</span>
<a href="#l52.58"></a><span id="l52.58" class="difflineplus">+            type: &quot;text&quot;,</span>
<a href="#l52.59"></a><span id="l52.59" class="difflineplus">+            // placeholder: &quot;New Event&quot;</span>
<a href="#l52.60"></a><span id="l52.60">             value: this.props.value,</span>
<a href="#l52.61"></a><span id="l52.61">             onChange: this.handleChange,</span>
<a href="#l52.62"></a><span id="l52.62" class="difflineminus">-            placeholder: 'Description',</span>
<a href="#l52.63"></a><span id="l52.63" class="difflineplus">+            placeholder: &quot;Description&quot;,</span>
<a href="#l52.64"></a><span id="l52.64">             rows: 10,</span>
<a href="#l52.65"></a><span id="l52.65" class="difflineminus">-            id: 'descriptionTextArea'</span>
<a href="#l52.66"></a><span id="l52.66" class="difflineplus">+            id: &quot;descriptionTextArea&quot;</span>
<a href="#l52.67"></a><span id="l52.67">         });</span>
<a href="#l52.68"></a><span id="l52.68">     }</span>
<a href="#l52.69"></a><span id="l52.69"> });</span>
<a href="#l52.70"></a><span id="l52.70"> </span>
<a href="#l52.71"></a><span id="l52.71"> var Checkbox = React.createClass({</span>
<a href="#l52.72"></a><span id="l52.72">     handleChange: function(event) {</span>
<a href="#l52.73"></a><span id="l52.73">         this.props.onInput(this.props.keyprop, event.target.checked);</span>
<a href="#l52.74"></a><span id="l52.74">     },</span>
<a href="#l52.75"></a><span id="l52.75">     render: function() {</span>
<a href="#l52.76"></a><span id="l52.76">         return React.DOM.input({</span>
<a href="#l52.77"></a><span id="l52.77" class="difflineminus">-            type: 'checkbox',</span>
<a href="#l52.78"></a><span id="l52.78" class="difflineplus">+            type: &quot;checkbox&quot;,</span>
<a href="#l52.79"></a><span id="l52.79">             checked: this.props.checked,</span>
<a href="#l52.80"></a><span id="l52.80">             onChange: this.handleChange</span>
<a href="#l52.81"></a><span id="l52.81">         });</span>
<a href="#l52.82"></a><span id="l52.82">     }</span>
<a href="#l52.83"></a><span id="l52.83"> });</span>
<a href="#l52.84"></a><span id="l52.84"> </span>
<a href="#l52.85"></a><span id="l52.85"> var Dropdown = React.createClass({</span>
<a href="#l52.86"></a><span id="l52.86">     handleChange: function(event) {</span>
<a href="#l52.87"></a><span id="l52.87" class="difflineat">@@ -85,17 +85,17 @@ var Dropdown = React.createClass({</span>
<a href="#l52.88"></a><span id="l52.88">     render: function() {</span>
<a href="#l52.89"></a><span id="l52.89">         return React.DOM.select({</span>
<a href="#l52.90"></a><span id="l52.90">             value: this.props.value,</span>
<a href="#l52.91"></a><span id="l52.91">             onChange: this.handleChange</span>
<a href="#l52.92"></a><span id="l52.92">             },</span>
<a href="#l52.93"></a><span id="l52.93">             this.props.options.map((option, index) =&gt; {</span>
<a href="#l52.94"></a><span id="l52.94">                 return React.DOM.option({</span>
<a href="#l52.95"></a><span id="l52.95">                         // could use option[0] here instead of index...</span>
<a href="#l52.96"></a><span id="l52.96" class="difflineminus">-                        key: this.props.keyprop + 'Option' + index,</span>
<a href="#l52.97"></a><span id="l52.97" class="difflineplus">+                        key: this.props.keyprop + &quot;Option&quot; + index,</span>
<a href="#l52.98"></a><span id="l52.98">                         onChange: this.handleChange,</span>
<a href="#l52.99"></a><span id="l52.99">                         value: option[0],</span>
<a href="#l52.100"></a><span id="l52.100">                         disabled: this.props.disabled || false</span>
<a href="#l52.101"></a><span id="l52.101">                     },</span>
<a href="#l52.102"></a><span id="l52.102">                     option[1]</span>
<a href="#l52.103"></a><span id="l52.103">                     );</span>
<a href="#l52.104"></a><span id="l52.104">                 }</span>
<a href="#l52.105"></a><span id="l52.105">             )</span>
<a href="#l52.106"></a><span id="l52.106" class="difflineat">@@ -104,28 +104,28 @@ var Dropdown = React.createClass({</span>
<a href="#l52.107"></a><span id="l52.107"> });</span>
<a href="#l52.108"></a><span id="l52.108"> </span>
<a href="#l52.109"></a><span id="l52.109"> var Link = React.createClass({</span>
<a href="#l52.110"></a><span id="l52.110">     handleClick: function() {</span>
<a href="#l52.111"></a><span id="l52.111">         this.props.onInput(this.props.value);</span>
<a href="#l52.112"></a><span id="l52.112">     },</span>
<a href="#l52.113"></a><span id="l52.113">     render: function() {</span>
<a href="#l52.114"></a><span id="l52.114">         return React.DOM.a({</span>
<a href="#l52.115"></a><span id="l52.115" class="difflineminus">-            // href: '',</span>
<a href="#l52.116"></a><span id="l52.116" class="difflineplus">+            // href: &quot;&quot;,</span>
<a href="#l52.117"></a><span id="l52.117">             onClick: this.handleClick</span>
<a href="#l52.118"></a><span id="l52.118">         },</span>
<a href="#l52.119"></a><span id="l52.119">         this.props.value</span>
<a href="#l52.120"></a><span id="l52.120">         );</span>
<a href="#l52.121"></a><span id="l52.121">     }</span>
<a href="#l52.122"></a><span id="l52.122"> });</span>
<a href="#l52.123"></a><span id="l52.123"> </span>
<a href="#l52.124"></a><span id="l52.124"> var DatePicker = React.createClass({</span>
<a href="#l52.125"></a><span id="l52.125">     render: function() {</span>
<a href="#l52.126"></a><span id="l52.126">         return React.DOM.input({</span>
<a href="#l52.127"></a><span id="l52.127" class="difflineminus">-            type: 'date'</span>
<a href="#l52.128"></a><span id="l52.128" class="difflineplus">+            type: &quot;date&quot;</span>
<a href="#l52.129"></a><span id="l52.129">         });</span>
<a href="#l52.130"></a><span id="l52.130">     }</span>
<a href="#l52.131"></a><span id="l52.131"> });</span>
<a href="#l52.132"></a><span id="l52.132"> </span>
<a href="#l52.133"></a><span id="l52.133"> var Capsule = React.createClass({</span>
<a href="#l52.134"></a><span id="l52.134">     handleDelete: function() {</span>
<a href="#l52.135"></a><span id="l52.135">         this.props.onDelete(this.props.keyprop, this.props.value);</span>
<a href="#l52.136"></a><span id="l52.136">     },</span>
<a href="#l52.137"></a><span id="l52.137" class="difflineat">@@ -146,85 +146,85 @@ var Capsule = React.createClass({</span>
<a href="#l52.138"></a><span id="l52.138">     }</span>
<a href="#l52.139"></a><span id="l52.139"> });</span>
<a href="#l52.140"></a><span id="l52.140"> </span>
<a href="#l52.141"></a><span id="l52.141"> var TopComponent = React.createClass({</span>
<a href="#l52.142"></a><span id="l52.142">     getDefaultProps: function() {</span>
<a href="#l52.143"></a><span id="l52.143">         return {</span>
<a href="#l52.144"></a><span id="l52.144">             // these &quot;initial&quot; props are passed in as props but</span>
<a href="#l52.145"></a><span id="l52.145">             // immediately become state (state can change, props do not)</span>
<a href="#l52.146"></a><span id="l52.146" class="difflineminus">-            initialTitle: 'New Event',</span>
<a href="#l52.147"></a><span id="l52.147" class="difflineminus">-            initialLocation: '',</span>
<a href="#l52.148"></a><span id="l52.148" class="difflineplus">+            initialTitle: &quot;New Event&quot;,</span>
<a href="#l52.149"></a><span id="l52.149" class="difflineplus">+            initialLocation: &quot;&quot;,</span>
<a href="#l52.150"></a><span id="l52.150">             initialAllDay: false,</span>
<a href="#l52.151"></a><span id="l52.151" class="difflineminus">-            initialRepeat: 'none',</span>
<a href="#l52.152"></a><span id="l52.152" class="difflineminus">-            initialRepeatUntilDate: 'Forever',</span>
<a href="#l52.153"></a><span id="l52.153" class="difflineplus">+            initialRepeat: &quot;none&quot;,</span>
<a href="#l52.154"></a><span id="l52.154" class="difflineplus">+            initialRepeatUntilDate: &quot;Forever&quot;,</span>
<a href="#l52.155"></a><span id="l52.155">             initialReminders: 0,</span>
<a href="#l52.156"></a><span id="l52.156" class="difflineminus">-            initialDescription: '',</span>
<a href="#l52.157"></a><span id="l52.157" class="difflineminus">-            initialShowTimeAs: 'OPAQUE',</span>
<a href="#l52.158"></a><span id="l52.158" class="difflineplus">+            initialDescription: &quot;&quot;,</span>
<a href="#l52.159"></a><span id="l52.159" class="difflineplus">+            initialShowTimeAs: &quot;OPAQUE&quot;,</span>
<a href="#l52.160"></a><span id="l52.160">             initialCalendarId: 0,</span>
<a href="#l52.161"></a><span id="l52.161">             initialPrivacy: 0,</span>
<a href="#l52.162"></a><span id="l52.162">             initialStatus: 0,</span>
<a href="#l52.163"></a><span id="l52.163">             initialPriority: 0,</span>
<a href="#l52.164"></a><span id="l52.164" class="difflineminus">-            initialUrl: '',</span>
<a href="#l52.165"></a><span id="l52.165" class="difflineplus">+            initialUrl: &quot;&quot;,</span>
<a href="#l52.166"></a><span id="l52.166">             initialShowUrl: false,</span>
<a href="#l52.167"></a><span id="l52.167">             initialCategories: [],</span>
<a href="#l52.168"></a><span id="l52.168">             initialCategoriesList: [],</span>
<a href="#l52.169"></a><span id="l52.169">             initialAttachments: {},</span>
<a href="#l52.170"></a><span id="l52.170"> </span>
<a href="#l52.171"></a><span id="l52.171" class="difflineminus">-            tabs: ['Description', 'More', 'Reminders', 'Attachments', 'Attendees'],</span>
<a href="#l52.172"></a><span id="l52.172" class="difflineplus">+            tabs: [&quot;Description&quot;, &quot;More&quot;, &quot;Reminders&quot;, &quot;Attachments&quot;, &quot;Attendees&quot;],</span>
<a href="#l52.173"></a><span id="l52.173">             calendarList: [</span>
<a href="#l52.174"></a><span id="l52.174" class="difflineminus">-                [0, 'Home'],</span>
<a href="#l52.175"></a><span id="l52.175" class="difflineminus">-                [1, 'Work']</span>
<a href="#l52.176"></a><span id="l52.176" class="difflineplus">+                [0, &quot;Home&quot;],</span>
<a href="#l52.177"></a><span id="l52.177" class="difflineplus">+                [1, &quot;Work&quot;]</span>
<a href="#l52.178"></a><span id="l52.178">             ],</span>
<a href="#l52.179"></a><span id="l52.179">             privacyList: [</span>
<a href="#l52.180"></a><span id="l52.180" class="difflineminus">-                ['NONE', 'Not Specified'],</span>
<a href="#l52.181"></a><span id="l52.181" class="difflineminus">-                ['PUBLIC', 'Public Event'],</span>
<a href="#l52.182"></a><span id="l52.182" class="difflineminus">-                ['CONFIDENTIAL', 'Show Time and Date Only'],</span>
<a href="#l52.183"></a><span id="l52.183" class="difflineminus">-                ['PRIVATE', 'Private Event']</span>
<a href="#l52.184"></a><span id="l52.184" class="difflineplus">+                [&quot;NONE&quot;, &quot;Not Specified&quot;],</span>
<a href="#l52.185"></a><span id="l52.185" class="difflineplus">+                [&quot;PUBLIC&quot;, &quot;Public Event&quot;],</span>
<a href="#l52.186"></a><span id="l52.186" class="difflineplus">+                [&quot;CONFIDENTIAL&quot;, &quot;Show Time and Date Only&quot;],</span>
<a href="#l52.187"></a><span id="l52.187" class="difflineplus">+                [&quot;PRIVATE&quot;, &quot;Private Event&quot;]</span>
<a href="#l52.188"></a><span id="l52.188">             ],</span>
<a href="#l52.189"></a><span id="l52.189">             statusList: [</span>
<a href="#l52.190"></a><span id="l52.190" class="difflineminus">-                ['NONE', 'Not Specified'],</span>
<a href="#l52.191"></a><span id="l52.191" class="difflineminus">-                ['TENTATIVE', 'Tentative'],</span>
<a href="#l52.192"></a><span id="l52.192" class="difflineminus">-                ['CONFIRMED', 'Confirmed'],</span>
<a href="#l52.193"></a><span id="l52.193" class="difflineminus">-                ['CANCELLED', 'Canceled']</span>
<a href="#l52.194"></a><span id="l52.194" class="difflineplus">+                [&quot;NONE&quot;, &quot;Not Specified&quot;],</span>
<a href="#l52.195"></a><span id="l52.195" class="difflineplus">+                [&quot;TENTATIVE&quot;, &quot;Tentative&quot;],</span>
<a href="#l52.196"></a><span id="l52.196" class="difflineplus">+                [&quot;CONFIRMED&quot;, &quot;Confirmed&quot;],</span>
<a href="#l52.197"></a><span id="l52.197" class="difflineplus">+                [&quot;CANCELLED&quot;, &quot;Canceled&quot;]</span>
<a href="#l52.198"></a><span id="l52.198">             ],</span>
<a href="#l52.199"></a><span id="l52.199">             priorityList: [</span>
<a href="#l52.200"></a><span id="l52.200">                 // XXX what about other numbers?</span>
<a href="#l52.201"></a><span id="l52.201" class="difflineminus">-                [0, 'Not Specified'],</span>
<a href="#l52.202"></a><span id="l52.202" class="difflineminus">-                [9, 'Low'],</span>
<a href="#l52.203"></a><span id="l52.203" class="difflineminus">-                [5, 'Normal'],</span>
<a href="#l52.204"></a><span id="l52.204" class="difflineminus">-                [1, 'High']</span>
<a href="#l52.205"></a><span id="l52.205" class="difflineplus">+                [0, &quot;Not Specified&quot;],</span>
<a href="#l52.206"></a><span id="l52.206" class="difflineplus">+                [9, &quot;Low&quot;],</span>
<a href="#l52.207"></a><span id="l52.207" class="difflineplus">+                [5, &quot;Normal&quot;],</span>
<a href="#l52.208"></a><span id="l52.208" class="difflineplus">+                [1, &quot;High&quot;]</span>
<a href="#l52.209"></a><span id="l52.209">             ],</span>
<a href="#l52.210"></a><span id="l52.210">             showTimeAsList: [</span>
<a href="#l52.211"></a><span id="l52.211" class="difflineminus">-                ['OPAQUE', true],</span>
<a href="#l52.212"></a><span id="l52.212" class="difflineminus">-                ['TRANSPARENT', false]</span>
<a href="#l52.213"></a><span id="l52.213" class="difflineplus">+                [&quot;OPAQUE&quot;, true],</span>
<a href="#l52.214"></a><span id="l52.214" class="difflineplus">+                [&quot;TRANSPARENT&quot;, false]</span>
<a href="#l52.215"></a><span id="l52.215">             ],</span>
<a href="#l52.216"></a><span id="l52.216">             repeatList: [</span>
<a href="#l52.217"></a><span id="l52.217" class="difflineminus">-                ['none', 'Does Not Repeat'],</span>
<a href="#l52.218"></a><span id="l52.218" class="difflineminus">-                ['daily', 'Daily'],</span>
<a href="#l52.219"></a><span id="l52.219" class="difflineminus">-                ['weekly', 'Weekly'],</span>
<a href="#l52.220"></a><span id="l52.220" class="difflineminus">-                ['every.weekday', 'Every Weekday'],</span>
<a href="#l52.221"></a><span id="l52.221" class="difflineminus">-                ['bi.weekly', 'Bi-weekly'],</span>
<a href="#l52.222"></a><span id="l52.222" class="difflineminus">-                ['monthly', 'Monthly'],</span>
<a href="#l52.223"></a><span id="l52.223" class="difflineminus">-                ['yearly', 'Yearly'],</span>
<a href="#l52.224"></a><span id="l52.224" class="difflineminus">-                ['custom', 'Custom...']</span>
<a href="#l52.225"></a><span id="l52.225" class="difflineplus">+                [&quot;none&quot;, &quot;Does Not Repeat&quot;],</span>
<a href="#l52.226"></a><span id="l52.226" class="difflineplus">+                [&quot;daily&quot;, &quot;Daily&quot;],</span>
<a href="#l52.227"></a><span id="l52.227" class="difflineplus">+                [&quot;weekly&quot;, &quot;Weekly&quot;],</span>
<a href="#l52.228"></a><span id="l52.228" class="difflineplus">+                [&quot;every.weekday&quot;, &quot;Every Weekday&quot;],</span>
<a href="#l52.229"></a><span id="l52.229" class="difflineplus">+                [&quot;bi.weekly&quot;, &quot;Bi-weekly&quot;],</span>
<a href="#l52.230"></a><span id="l52.230" class="difflineplus">+                [&quot;monthly&quot;, &quot;Monthly&quot;],</span>
<a href="#l52.231"></a><span id="l52.231" class="difflineplus">+                [&quot;yearly&quot;, &quot;Yearly&quot;],</span>
<a href="#l52.232"></a><span id="l52.232" class="difflineplus">+                [&quot;custom&quot;, &quot;Custom...&quot;]</span>
<a href="#l52.233"></a><span id="l52.233">             ],</span>
<a href="#l52.234"></a><span id="l52.234">             remindersList: [</span>
<a href="#l52.235"></a><span id="l52.235" class="difflineminus">-                [0, 'No Reminder'],</span>
<a href="#l52.236"></a><span id="l52.236" class="difflineminus">-                [1, '0 Minutes Before'],</span>
<a href="#l52.237"></a><span id="l52.237" class="difflineminus">-                [2, '5 Minutes Before'],</span>
<a href="#l52.238"></a><span id="l52.238" class="difflineminus">-                [3, '15 Minutes Before'],</span>
<a href="#l52.239"></a><span id="l52.239" class="difflineminus">-                [4, '30 Minutes Before'],</span>
<a href="#l52.240"></a><span id="l52.240" class="difflineminus">-                [5, '1 Hour Before'],</span>
<a href="#l52.241"></a><span id="l52.241" class="difflineminus">-                [6, '2 Hours Before'],</span>
<a href="#l52.242"></a><span id="l52.242" class="difflineminus">-                [7, '12 Hours Before'],</span>
<a href="#l52.243"></a><span id="l52.243" class="difflineminus">-                [8, '1 Day Before'],</span>
<a href="#l52.244"></a><span id="l52.244" class="difflineminus">-                [9, '2 Days Before'],</span>
<a href="#l52.245"></a><span id="l52.245" class="difflineminus">-                [10, '1 Week Before'],</span>
<a href="#l52.246"></a><span id="l52.246" class="difflineminus">-                [11, 'Custom...']</span>
<a href="#l52.247"></a><span id="l52.247" class="difflineplus">+                [0, &quot;No Reminder&quot;],</span>
<a href="#l52.248"></a><span id="l52.248" class="difflineplus">+                [1, &quot;0 Minutes Before&quot;],</span>
<a href="#l52.249"></a><span id="l52.249" class="difflineplus">+                [2, &quot;5 Minutes Before&quot;],</span>
<a href="#l52.250"></a><span id="l52.250" class="difflineplus">+                [3, &quot;15 Minutes Before&quot;],</span>
<a href="#l52.251"></a><span id="l52.251" class="difflineplus">+                [4, &quot;30 Minutes Before&quot;],</span>
<a href="#l52.252"></a><span id="l52.252" class="difflineplus">+                [5, &quot;1 Hour Before&quot;],</span>
<a href="#l52.253"></a><span id="l52.253" class="difflineplus">+                [6, &quot;2 Hours Before&quot;],</span>
<a href="#l52.254"></a><span id="l52.254" class="difflineplus">+                [7, &quot;12 Hours Before&quot;],</span>
<a href="#l52.255"></a><span id="l52.255" class="difflineplus">+                [8, &quot;1 Day Before&quot;],</span>
<a href="#l52.256"></a><span id="l52.256" class="difflineplus">+                [9, &quot;2 Days Before&quot;],</span>
<a href="#l52.257"></a><span id="l52.257" class="difflineplus">+                [10, &quot;1 Week Before&quot;],</span>
<a href="#l52.258"></a><span id="l52.258" class="difflineplus">+                [11, &quot;Custom...&quot;]</span>
<a href="#l52.259"></a><span id="l52.259">             ],</span>
<a href="#l52.260"></a><span id="l52.260">             supportsPriority: false</span>
<a href="#l52.261"></a><span id="l52.261">         };</span>
<a href="#l52.262"></a><span id="l52.262">     },</span>
<a href="#l52.263"></a><span id="l52.263">     getInitialState: function() {</span>
<a href="#l52.264"></a><span id="l52.264">         // all the passed-in props that begin with 'initial' become state</span>
<a href="#l52.265"></a><span id="l52.265">         return {</span>
<a href="#l52.266"></a><span id="l52.266">             title: this.props.initialTitle,</span>
<a href="#l52.267"></a><span id="l52.267" class="difflineat">@@ -260,20 +260,20 @@ var TopComponent = React.createClass({</span>
<a href="#l52.268"></a><span id="l52.268">         if (wv != this.state.isWideview) {</span>
<a href="#l52.269"></a><span id="l52.269">             this.setState({ isWideview: wv });</span>
<a href="#l52.270"></a><span id="l52.270">         }</span>
<a href="#l52.271"></a><span id="l52.271">     },</span>
<a href="#l52.272"></a><span id="l52.272">     componentWillMount: function() {</span>
<a href="#l52.273"></a><span id="l52.273">         this.updateWideview();</span>
<a href="#l52.274"></a><span id="l52.274">     },</span>
<a href="#l52.275"></a><span id="l52.275">     componentDidMount: function() {</span>
<a href="#l52.276"></a><span id="l52.276" class="difflineminus">-        window.addEventListener('resize', this.updateWideview);</span>
<a href="#l52.277"></a><span id="l52.277" class="difflineplus">+        window.addEventListener(&quot;resize&quot;, this.updateWideview);</span>
<a href="#l52.278"></a><span id="l52.278">     },</span>
<a href="#l52.279"></a><span id="l52.279">     componentWillUnmount: function() {</span>
<a href="#l52.280"></a><span id="l52.280" class="difflineminus">-        window.removeEventListener('resize', this.updateWideview);</span>
<a href="#l52.281"></a><span id="l52.281" class="difflineplus">+        window.removeEventListener(&quot;resize&quot;, this.updateWideview);</span>
<a href="#l52.282"></a><span id="l52.282">     },</span>
<a href="#l52.283"></a><span id="l52.283">     exportState: function() {</span>
<a href="#l52.284"></a><span id="l52.284">         // Use this to access this component's state from above/outside</span>
<a href="#l52.285"></a><span id="l52.285">         // the react component hierarchy, for example, when saving changes.</span>
<a href="#l52.286"></a><span id="l52.286">         return this.state;</span>
<a href="#l52.287"></a><span id="l52.287">     },</span>
<a href="#l52.288"></a><span id="l52.288">     importState: function(aStateObj) {</span>
<a href="#l52.289"></a><span id="l52.289">         // Use this to impose state changes from above/outside of the</span>
<a href="#l52.290"></a><span id="l52.290" class="difflineat">@@ -300,284 +300,284 @@ var TopComponent = React.createClass({</span>
<a href="#l52.291"></a><span id="l52.291">         let index = a.indexOf(aValue);</span>
<a href="#l52.292"></a><span id="l52.292">         a.splice(index, 1);</span>
<a href="#l52.293"></a><span id="l52.293">         this.setState({ aKey: a });</span>
<a href="#l52.294"></a><span id="l52.294">     },</span>
<a href="#l52.295"></a><span id="l52.295">     render: function() {</span>
<a href="#l52.296"></a><span id="l52.296">         // 'key' doesn't seem to work as a prop name (presumably because</span>
<a href="#l52.297"></a><span id="l52.297">         // already used by react?), so using 'keyprop' instead for now.</span>
<a href="#l52.298"></a><span id="l52.298">         let titleDiv = React.DOM.div(</span>
<a href="#l52.299"></a><span id="l52.299" class="difflineminus">-            { id: 'titleDiv', className: 'box' },</span>
<a href="#l52.300"></a><span id="l52.300" class="difflineminus">-            'Title ',</span>
<a href="#l52.301"></a><span id="l52.301" class="difflineplus">+            { id: &quot;titleDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.302"></a><span id="l52.302" class="difflineplus">+            &quot;Title &quot;,</span>
<a href="#l52.303"></a><span id="l52.303">             React.createElement(TextField, {</span>
<a href="#l52.304"></a><span id="l52.304" class="difflineminus">-                keyprop: 'title',</span>
<a href="#l52.305"></a><span id="l52.305" class="difflineplus">+                keyprop: &quot;title&quot;,</span>
<a href="#l52.306"></a><span id="l52.306">                 value: this.state.title,</span>
<a href="#l52.307"></a><span id="l52.307">                 onInput: this.handleSimpleChange</span>
<a href="#l52.308"></a><span id="l52.308">             })</span>
<a href="#l52.309"></a><span id="l52.309">         );</span>
<a href="#l52.310"></a><span id="l52.310">         let locationDiv = React.DOM.div(</span>
<a href="#l52.311"></a><span id="l52.311" class="difflineminus">-            { id: 'locationDiv', className: 'box' },</span>
<a href="#l52.312"></a><span id="l52.312" class="difflineminus">-            'Location ',</span>
<a href="#l52.313"></a><span id="l52.313" class="difflineplus">+            { id: &quot;locationDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.314"></a><span id="l52.314" class="difflineplus">+            &quot;Location &quot;,</span>
<a href="#l52.315"></a><span id="l52.315">             React.createElement(TextField, {</span>
<a href="#l52.316"></a><span id="l52.316" class="difflineminus">-                keyprop: 'location',</span>
<a href="#l52.317"></a><span id="l52.317" class="difflineplus">+                keyprop: &quot;location&quot;,</span>
<a href="#l52.318"></a><span id="l52.318">                 value: this.state.location,</span>
<a href="#l52.319"></a><span id="l52.319">                 onInput: this.handleSimpleChange</span>
<a href="#l52.320"></a><span id="l52.320">             })</span>
<a href="#l52.321"></a><span id="l52.321">         );</span>
<a href="#l52.322"></a><span id="l52.322">         let startDiv = React.DOM.div(</span>
<a href="#l52.323"></a><span id="l52.323" class="difflineminus">-            { id: 'startDiv', className: 'box' },</span>
<a href="#l52.324"></a><span id="l52.324" class="difflineminus">-            'Start ',</span>
<a href="#l52.325"></a><span id="l52.325" class="difflineplus">+            { id: &quot;startDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.326"></a><span id="l52.326" class="difflineplus">+            &quot;Start &quot;,</span>
<a href="#l52.327"></a><span id="l52.327">             // React.createElement(DatePicker, { }),</span>
<a href="#l52.328"></a><span id="l52.328">             React.createElement(TextField, {</span>
<a href="#l52.329"></a><span id="l52.329" class="difflineminus">-                keyprop: 'startDate',</span>
<a href="#l52.330"></a><span id="l52.330" class="difflineplus">+                keyprop: &quot;startDate&quot;,</span>
<a href="#l52.331"></a><span id="l52.331">                 value: this.state.startDate,</span>
<a href="#l52.332"></a><span id="l52.332">                 onInput: this.handleSimpleChange</span>
<a href="#l52.333"></a><span id="l52.333">             }),</span>
<a href="#l52.334"></a><span id="l52.334">             React.createElement(TextField, {</span>
<a href="#l52.335"></a><span id="l52.335" class="difflineminus">-                keyprop: 'startTime',</span>
<a href="#l52.336"></a><span id="l52.336" class="difflineplus">+                keyprop: &quot;startTime&quot;,</span>
<a href="#l52.337"></a><span id="l52.337">                 value: this.state.startTime,</span>
<a href="#l52.338"></a><span id="l52.338">                 onInput: this.handleSimpleChange</span>
<a href="#l52.339"></a><span id="l52.339">             })</span>
<a href="#l52.340"></a><span id="l52.340">         );</span>
<a href="#l52.341"></a><span id="l52.341">         let endDiv = React.DOM.div(</span>
<a href="#l52.342"></a><span id="l52.342" class="difflineminus">-            { id: 'endDiv', className: 'box' },</span>
<a href="#l52.343"></a><span id="l52.343" class="difflineminus">-            'End ',</span>
<a href="#l52.344"></a><span id="l52.344" class="difflineplus">+            { id: &quot;endDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.345"></a><span id="l52.345" class="difflineplus">+            &quot;End &quot;,</span>
<a href="#l52.346"></a><span id="l52.346">             React.createElement(TextField, {</span>
<a href="#l52.347"></a><span id="l52.347" class="difflineminus">-                keyprop: 'endDate',</span>
<a href="#l52.348"></a><span id="l52.348" class="difflineplus">+                keyprop: &quot;endDate&quot;,</span>
<a href="#l52.349"></a><span id="l52.349">                 value: this.state.endDate,</span>
<a href="#l52.350"></a><span id="l52.350">                 onInput: this.handleSimpleChange</span>
<a href="#l52.351"></a><span id="l52.351">             }),</span>
<a href="#l52.352"></a><span id="l52.352">             React.createElement(TextField, {</span>
<a href="#l52.353"></a><span id="l52.353" class="difflineminus">-                keyprop: 'endTime',</span>
<a href="#l52.354"></a><span id="l52.354" class="difflineplus">+                keyprop: &quot;endTime&quot;,</span>
<a href="#l52.355"></a><span id="l52.355">                 value: this.state.endTime,</span>
<a href="#l52.356"></a><span id="l52.356">                 onInput: this.handleSimpleChange</span>
<a href="#l52.357"></a><span id="l52.357">             })</span>
<a href="#l52.358"></a><span id="l52.358">             // React.createElement(DatePicker, { }),</span>
<a href="#l52.359"></a><span id="l52.359">         );</span>
<a href="#l52.360"></a><span id="l52.360">         let allDayDiv = React.DOM.div(</span>
<a href="#l52.361"></a><span id="l52.361" class="difflineminus">-            { id: 'allDayDiv', className: 'box' },</span>
<a href="#l52.362"></a><span id="l52.362" class="difflineplus">+            { id: &quot;allDayDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.363"></a><span id="l52.363">             React.createElement(Checkbox, {</span>
<a href="#l52.364"></a><span id="l52.364" class="difflineminus">-                keyprop: 'allDay',</span>
<a href="#l52.365"></a><span id="l52.365" class="difflineplus">+                keyprop: &quot;allDay&quot;,</span>
<a href="#l52.366"></a><span id="l52.366">                 checked: this.state.allDay,</span>
<a href="#l52.367"></a><span id="l52.367">                 onInput: this.handleSimpleChange</span>
<a href="#l52.368"></a><span id="l52.368">             }),</span>
<a href="#l52.369"></a><span id="l52.369" class="difflineminus">-            'All day event'</span>
<a href="#l52.370"></a><span id="l52.370" class="difflineplus">+            &quot;All day event&quot;</span>
<a href="#l52.371"></a><span id="l52.371">         );</span>
<a href="#l52.372"></a><span id="l52.372">         let repeatDiv = React.DOM.div(</span>
<a href="#l52.373"></a><span id="l52.373" class="difflineminus">-            { id: 'repeatDiv', className: 'box' },</span>
<a href="#l52.374"></a><span id="l52.374" class="difflineminus">-            'Repeat ',</span>
<a href="#l52.375"></a><span id="l52.375" class="difflineplus">+            { id: &quot;repeatDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.376"></a><span id="l52.376" class="difflineplus">+            &quot;Repeat &quot;,</span>
<a href="#l52.377"></a><span id="l52.377">             React.createElement(Dropdown, {</span>
<a href="#l52.378"></a><span id="l52.378" class="difflineminus">-                keyprop: 'repeat',</span>
<a href="#l52.379"></a><span id="l52.379" class="difflineplus">+                keyprop: &quot;repeat&quot;,</span>
<a href="#l52.380"></a><span id="l52.380">                 value: this.state.repeat,</span>
<a href="#l52.381"></a><span id="l52.381">                 options: this.props.repeatList,</span>
<a href="#l52.382"></a><span id="l52.382">                 onInput: this.handleSimpleChange</span>
<a href="#l52.383"></a><span id="l52.383">             }),</span>
<a href="#l52.384"></a><span id="l52.384" class="difflineminus">-            (this.state.repeat != 'none' ? ' Until ' : null),</span>
<a href="#l52.385"></a><span id="l52.385" class="difflineminus">-            (this.state.repeat!= 'none' ?</span>
<a href="#l52.386"></a><span id="l52.386" class="difflineplus">+            (this.state.repeat != &quot;none&quot; ? &quot; Until &quot; : null),</span>
<a href="#l52.387"></a><span id="l52.387" class="difflineplus">+            (this.state.repeat!= &quot;none&quot; ?</span>
<a href="#l52.388"></a><span id="l52.388">                 React.createElement(TextField, {</span>
<a href="#l52.389"></a><span id="l52.389" class="difflineminus">-                    keyprop: 'repeatUntilDate',</span>
<a href="#l52.390"></a><span id="l52.390" class="difflineplus">+                    keyprop: &quot;repeatUntilDate&quot;,</span>
<a href="#l52.391"></a><span id="l52.391">                     value: this.state.repeatUntilDate,</span>
<a href="#l52.392"></a><span id="l52.392">                     onInput: this.handleSimpleChange</span>
<a href="#l52.393"></a><span id="l52.393">                 })</span>
<a href="#l52.394"></a><span id="l52.394">                 : null)</span>
<a href="#l52.395"></a><span id="l52.395">         );</span>
<a href="#l52.396"></a><span id="l52.396">         let calendarDiv = React.DOM.div(</span>
<a href="#l52.397"></a><span id="l52.397" class="difflineminus">-            { id: 'calendarDiv', className: 'box' },</span>
<a href="#l52.398"></a><span id="l52.398" class="difflineminus">-            'Calendar ',</span>
<a href="#l52.399"></a><span id="l52.399" class="difflineplus">+            { id: &quot;calendarDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.400"></a><span id="l52.400" class="difflineplus">+            &quot;Calendar &quot;,</span>
<a href="#l52.401"></a><span id="l52.401">             React.createElement(Dropdown, {</span>
<a href="#l52.402"></a><span id="l52.402" class="difflineminus">-                keyprop: 'calendarId',</span>
<a href="#l52.403"></a><span id="l52.403" class="difflineplus">+                keyprop: &quot;calendarId&quot;,</span>
<a href="#l52.404"></a><span id="l52.404">                 value: this.state.calendarId,</span>
<a href="#l52.405"></a><span id="l52.405">                 options: this.props.calendarList,</span>
<a href="#l52.406"></a><span id="l52.406">                 onInput: this.handleSimpleChange</span>
<a href="#l52.407"></a><span id="l52.407">             })</span>
<a href="#l52.408"></a><span id="l52.408">         );</span>
<a href="#l52.409"></a><span id="l52.409">         let categoriesCapsules;</span>
<a href="#l52.410"></a><span id="l52.410">         if (this.state.categories) {</span>
<a href="#l52.411"></a><span id="l52.411">             categoriesCapsules =</span>
<a href="#l52.412"></a><span id="l52.412">                 this.state.categories.map((cat, index) =&gt; {</span>
<a href="#l52.413"></a><span id="l52.413">                     return React.createElement(Capsule, {</span>
<a href="#l52.414"></a><span id="l52.414">                         // color: this.props.categoryList.color,</span>
<a href="#l52.415"></a><span id="l52.415">                         value: cat,</span>
<a href="#l52.416"></a><span id="l52.416" class="difflineminus">-                        key: cat + 'key',</span>
<a href="#l52.417"></a><span id="l52.417" class="difflineminus">-                        keyprop: 'categories',</span>
<a href="#l52.418"></a><span id="l52.418" class="difflineplus">+                        key: cat + &quot;key&quot;,</span>
<a href="#l52.419"></a><span id="l52.419" class="difflineplus">+                        keyprop: &quot;categories&quot;,</span>
<a href="#l52.420"></a><span id="l52.420">                         onDelete: this.onDeleteCapsule</span>
<a href="#l52.421"></a><span id="l52.421">                     });</span>
<a href="#l52.422"></a><span id="l52.422">                 });</span>
<a href="#l52.423"></a><span id="l52.423">         } else {</span>
<a href="#l52.424"></a><span id="l52.424">             categoriesCapsules = null;</span>
<a href="#l52.425"></a><span id="l52.425">         }</span>
<a href="#l52.426"></a><span id="l52.426">         let categoriesDiv = React.DOM.div(</span>
<a href="#l52.427"></a><span id="l52.427" class="difflineminus">-            { id: 'categoriesDiv', className: 'box' },</span>
<a href="#l52.428"></a><span id="l52.428" class="difflineminus">-            'Categories ',</span>
<a href="#l52.429"></a><span id="l52.429" class="difflineplus">+            { id: &quot;categoriesDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.430"></a><span id="l52.430" class="difflineplus">+            &quot;Categories &quot;,</span>
<a href="#l52.431"></a><span id="l52.431">             categoriesCapsules,</span>
<a href="#l52.432"></a><span id="l52.432">             React.createElement(Link, {</span>
<a href="#l52.433"></a><span id="l52.433" class="difflineminus">-                value: 'Add Categories',</span>
<a href="#l52.434"></a><span id="l52.434" class="difflineplus">+                value: &quot;Add Categories&quot;,</span>
<a href="#l52.435"></a><span id="l52.435">                 onInput: this.linkClicked</span>
<a href="#l52.436"></a><span id="l52.436">             })</span>
<a href="#l52.437"></a><span id="l52.437">         );</span>
<a href="#l52.438"></a><span id="l52.438">         let attendeesDiv = React.DOM.div(</span>
<a href="#l52.439"></a><span id="l52.439" class="difflineminus">-            { id: 'attendeesDiv', className: 'box' },</span>
<a href="#l52.440"></a><span id="l52.440" class="difflineminus">-            'Attendees ',</span>
<a href="#l52.441"></a><span id="l52.441" class="difflineplus">+            { id: &quot;attendeesDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.442"></a><span id="l52.442" class="difflineplus">+            &quot;Attendees &quot;,</span>
<a href="#l52.443"></a><span id="l52.443">             React.createElement(Link, {</span>
<a href="#l52.444"></a><span id="l52.444" class="difflineminus">-                value: 'Add Attendees',</span>
<a href="#l52.445"></a><span id="l52.445" class="difflineplus">+                value: &quot;Add Attendees&quot;,</span>
<a href="#l52.446"></a><span id="l52.446">                 onInput: this.linkClicked</span>
<a href="#l52.447"></a><span id="l52.447">             })</span>
<a href="#l52.448"></a><span id="l52.448">         );</span>
<a href="#l52.449"></a><span id="l52.449">         let remindersDiv = React.DOM.div(</span>
<a href="#l52.450"></a><span id="l52.450" class="difflineminus">-            { id: 'remindersDiv', className: 'box' },</span>
<a href="#l52.451"></a><span id="l52.451" class="difflineminus">-            'Reminders ',</span>
<a href="#l52.452"></a><span id="l52.452" class="difflineplus">+            { id: &quot;remindersDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.453"></a><span id="l52.453" class="difflineplus">+            &quot;Reminders &quot;,</span>
<a href="#l52.454"></a><span id="l52.454">             React.createElement(Dropdown, {</span>
<a href="#l52.455"></a><span id="l52.455" class="difflineminus">-                keyprop: 'reminders',</span>
<a href="#l52.456"></a><span id="l52.456" class="difflineplus">+                keyprop: &quot;reminders&quot;,</span>
<a href="#l52.457"></a><span id="l52.457">                 value: this.state.reminders,</span>
<a href="#l52.458"></a><span id="l52.458">                 options: this.props.remindersList,</span>
<a href="#l52.459"></a><span id="l52.459">                 onInput: this.handleSimpleChange</span>
<a href="#l52.460"></a><span id="l52.460">             })</span>
<a href="#l52.461"></a><span id="l52.461">         );</span>
<a href="#l52.462"></a><span id="l52.462">         let attachmentsDiv = React.DOM.div(</span>
<a href="#l52.463"></a><span id="l52.463" class="difflineminus">-            { id: 'attachmentsDiv', className: 'box' },</span>
<a href="#l52.464"></a><span id="l52.464" class="difflineminus">-            'Attachments ',</span>
<a href="#l52.465"></a><span id="l52.465" class="difflineplus">+            { id: &quot;attachmentsDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.466"></a><span id="l52.466" class="difflineplus">+            &quot;Attachments &quot;,</span>
<a href="#l52.467"></a><span id="l52.467">             React.createElement(Link, {</span>
<a href="#l52.468"></a><span id="l52.468" class="difflineminus">-                value: 'Add Attachments',</span>
<a href="#l52.469"></a><span id="l52.469" class="difflineplus">+                value: &quot;Add Attachments&quot;,</span>
<a href="#l52.470"></a><span id="l52.470">                 onInput: this.linkClicked</span>
<a href="#l52.471"></a><span id="l52.471">             })</span>
<a href="#l52.472"></a><span id="l52.472">         );</span>
<a href="#l52.473"></a><span id="l52.473">         let urlDiv = (this.state.showUrl ?</span>
<a href="#l52.474"></a><span id="l52.474">             React.DOM.div(</span>
<a href="#l52.475"></a><span id="l52.475" class="difflineminus">-            { id: 'urlDiv', className: 'box' },</span>
<a href="#l52.476"></a><span id="l52.476" class="difflineminus">-            'Event link ',</span>
<a href="#l52.477"></a><span id="l52.477" class="difflineplus">+            { id: &quot;urlDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.478"></a><span id="l52.478" class="difflineplus">+            &quot;Event link &quot;,</span>
<a href="#l52.479"></a><span id="l52.479">             React.createElement(Link, {</span>
<a href="#l52.480"></a><span id="l52.480">                 value: this.state.url,</span>
<a href="#l52.481"></a><span id="l52.481">                 onInput: this.linkClicked</span>
<a href="#l52.482"></a><span id="l52.482">             }))</span>
<a href="#l52.483"></a><span id="l52.483">             : null</span>
<a href="#l52.484"></a><span id="l52.484">         );</span>
<a href="#l52.485"></a><span id="l52.485"> </span>
<a href="#l52.486"></a><span id="l52.486">         let privacyDiv = React.DOM.div(</span>
<a href="#l52.487"></a><span id="l52.487" class="difflineminus">-            { id: 'privacyDiv', className: 'box' },</span>
<a href="#l52.488"></a><span id="l52.488" class="difflineminus">-            'Privacy ',</span>
<a href="#l52.489"></a><span id="l52.489" class="difflineplus">+            { id: &quot;privacyDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.490"></a><span id="l52.490" class="difflineplus">+            &quot;Privacy &quot;,</span>
<a href="#l52.491"></a><span id="l52.491">             React.createElement(Dropdown, {</span>
<a href="#l52.492"></a><span id="l52.492" class="difflineminus">-                keyprop: 'privacy',</span>
<a href="#l52.493"></a><span id="l52.493" class="difflineplus">+                keyprop: &quot;privacy&quot;,</span>
<a href="#l52.494"></a><span id="l52.494">                 value: this.state.privacy,</span>
<a href="#l52.495"></a><span id="l52.495">                 options: this.props.privacyList,</span>
<a href="#l52.496"></a><span id="l52.496">                 onInput: this.handleSimpleChange</span>
<a href="#l52.497"></a><span id="l52.497">             })</span>
<a href="#l52.498"></a><span id="l52.498">         );</span>
<a href="#l52.499"></a><span id="l52.499">         let statusDiv = React.DOM.div(</span>
<a href="#l52.500"></a><span id="l52.500" class="difflineminus">-            { id: 'statusDiv', className: 'box' },</span>
<a href="#l52.501"></a><span id="l52.501" class="difflineminus">-            'Status ',</span>
<a href="#l52.502"></a><span id="l52.502" class="difflineplus">+            { id: &quot;statusDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.503"></a><span id="l52.503" class="difflineplus">+            &quot;Status &quot;,</span>
<a href="#l52.504"></a><span id="l52.504">             React.createElement(Dropdown, {</span>
<a href="#l52.505"></a><span id="l52.505" class="difflineminus">-                keyprop: 'status',</span>
<a href="#l52.506"></a><span id="l52.506" class="difflineplus">+                keyprop: &quot;status&quot;,</span>
<a href="#l52.507"></a><span id="l52.507">                 value: this.state.status,</span>
<a href="#l52.508"></a><span id="l52.508">                 options: this.props.statusList,</span>
<a href="#l52.509"></a><span id="l52.509">                 onInput: this.handleSimpleChange</span>
<a href="#l52.510"></a><span id="l52.510">             })</span>
<a href="#l52.511"></a><span id="l52.511">         );</span>
<a href="#l52.512"></a><span id="l52.512">         let priorityDiv = React.DOM.div(</span>
<a href="#l52.513"></a><span id="l52.513" class="difflineminus">-            { id: 'priorityDiv', className: 'box' },</span>
<a href="#l52.514"></a><span id="l52.514" class="difflineminus">-            'Priority ',</span>
<a href="#l52.515"></a><span id="l52.515" class="difflineplus">+            { id: &quot;priorityDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.516"></a><span id="l52.516" class="difflineplus">+            &quot;Priority &quot;,</span>
<a href="#l52.517"></a><span id="l52.517">             React.createElement(Dropdown, {</span>
<a href="#l52.518"></a><span id="l52.518" class="difflineminus">-                keyprop: 'priority',</span>
<a href="#l52.519"></a><span id="l52.519" class="difflineplus">+                keyprop: &quot;priority&quot;,</span>
<a href="#l52.520"></a><span id="l52.520">                 value: this.state.priority,</span>
<a href="#l52.521"></a><span id="l52.521">                 options: this.props.priorityList,</span>
<a href="#l52.522"></a><span id="l52.522">                 onInput: this.handleSimpleChange,</span>
<a href="#l52.523"></a><span id="l52.523">                 disabled: !this.props.supportsPriority</span>
<a href="#l52.524"></a><span id="l52.524">             })</span>
<a href="#l52.525"></a><span id="l52.525">         );</span>
<a href="#l52.526"></a><span id="l52.526"> </span>
<a href="#l52.527"></a><span id="l52.527">         let tIndex = this.props.showTimeAsList.findIndex(</span>
<a href="#l52.528"></a><span id="l52.528">             (t) =&gt; (t[0] == this.state.showTimeAs));</span>
<a href="#l52.529"></a><span id="l52.529">         let showTimeAsDiv = React.DOM.div(</span>
<a href="#l52.530"></a><span id="l52.530" class="difflineminus">-            { id: 'showTimeAsDiv', className: 'box' },</span>
<a href="#l52.531"></a><span id="l52.531" class="difflineplus">+            { id: &quot;showTimeAsDiv&quot;, className: &quot;box&quot; },</span>
<a href="#l52.532"></a><span id="l52.532">             React.createElement(Checkbox, {</span>
<a href="#l52.533"></a><span id="l52.533" class="difflineminus">-                keyprop: 'showTimeAs',</span>
<a href="#l52.534"></a><span id="l52.534" class="difflineplus">+                keyprop: &quot;showTimeAs&quot;,</span>
<a href="#l52.535"></a><span id="l52.535">                 checked: (tIndex == -1 ? false : this.props.showTimeAsList[tIndex][1]),</span>
<a href="#l52.536"></a><span id="l52.536">                 onInput: this.handleShowTimeAsChange,</span>
<a href="#l52.537"></a><span id="l52.537">                 options: this.props.showTimeAsList</span>
<a href="#l52.538"></a><span id="l52.538">             }),</span>
<a href="#l52.539"></a><span id="l52.539" class="difflineminus">-            'Show Time As Busy'</span>
<a href="#l52.540"></a><span id="l52.540" class="difflineplus">+            &quot;Show Time As Busy&quot;</span>
<a href="#l52.541"></a><span id="l52.541">         );</span>
<a href="#l52.542"></a><span id="l52.542">         let descriptionDiv = React.DOM.div(</span>
<a href="#l52.543"></a><span id="l52.543" class="difflineminus">-            { id: 'description', value: 'Description' },</span>
<a href="#l52.544"></a><span id="l52.544" class="difflineplus">+            { id: &quot;description&quot;, value: &quot;Description&quot; },</span>
<a href="#l52.545"></a><span id="l52.545">             React.createElement(TextArea, {</span>
<a href="#l52.546"></a><span id="l52.546" class="difflineminus">-                keyprop: 'description',</span>
<a href="#l52.547"></a><span id="l52.547" class="difflineplus">+                keyprop: &quot;description&quot;,</span>
<a href="#l52.548"></a><span id="l52.548">                 value: this.state.description,</span>
<a href="#l52.549"></a><span id="l52.549">                 onInput: this.handleSimpleChange</span>
<a href="#l52.550"></a><span id="l52.550">             })</span>
<a href="#l52.551"></a><span id="l52.551">         );</span>
<a href="#l52.552"></a><span id="l52.552"> </span>
<a href="#l52.553"></a><span id="l52.553">         if (this.state.isWideview) {</span>
<a href="#l52.554"></a><span id="l52.554">             // wideview</span>
<a href="#l52.555"></a><span id="l52.555">             return React.DOM.div(</span>
<a href="#l52.556"></a><span id="l52.556" class="difflineminus">-                { id: 'topwrapper' },</span>
<a href="#l52.557"></a><span id="l52.557" class="difflineplus">+                { id: &quot;topwrapper&quot; },</span>
<a href="#l52.558"></a><span id="l52.558">                 React.DOM.div(</span>
<a href="#l52.559"></a><span id="l52.559" class="difflineminus">-                    { className: 'wrapper' },</span>
<a href="#l52.560"></a><span id="l52.560" class="difflineplus">+                    { className: &quot;wrapper&quot; },</span>
<a href="#l52.561"></a><span id="l52.561">                     titleDiv,</span>
<a href="#l52.562"></a><span id="l52.562">                     startDiv,</span>
<a href="#l52.563"></a><span id="l52.563">                     endDiv,</span>
<a href="#l52.564"></a><span id="l52.564">                     allDayDiv,</span>
<a href="#l52.565"></a><span id="l52.565">                     repeatDiv,</span>
<a href="#l52.566"></a><span id="l52.566">                     attendeesDiv,</span>
<a href="#l52.567"></a><span id="l52.567">                     locationDiv,</span>
<a href="#l52.568"></a><span id="l52.568">                     calendarDiv,</span>
<a href="#l52.569"></a><span id="l52.569">                     categoriesDiv,</span>
<a href="#l52.570"></a><span id="l52.570">                     remindersDiv,</span>
<a href="#l52.571"></a><span id="l52.571">                     attachmentsDiv,</span>
<a href="#l52.572"></a><span id="l52.572">                     urlDiv</span>
<a href="#l52.573"></a><span id="l52.573">                     ),</span>
<a href="#l52.574"></a><span id="l52.574">                 descriptionDiv,</span>
<a href="#l52.575"></a><span id="l52.575">                 React.DOM.div(</span>
<a href="#l52.576"></a><span id="l52.576" class="difflineminus">-                    { className: 'wrapper', id: 'wrapper2' },</span>
<a href="#l52.577"></a><span id="l52.577" class="difflineplus">+                    { className: &quot;wrapper&quot;, id: &quot;wrapper2&quot; },</span>
<a href="#l52.578"></a><span id="l52.578">                     privacyDiv,</span>
<a href="#l52.579"></a><span id="l52.579">                     statusDiv,</span>
<a href="#l52.580"></a><span id="l52.580">                     priorityDiv,</span>
<a href="#l52.581"></a><span id="l52.581">                     showTimeAsDiv</span>
<a href="#l52.582"></a><span id="l52.582">                 )</span>
<a href="#l52.583"></a><span id="l52.583">             );</span>
<a href="#l52.584"></a><span id="l52.584">         } else {</span>
<a href="#l52.585"></a><span id="l52.585">             // narrowview</span>
<a href="#l52.586"></a><span id="l52.586">             let tabpanelChildren = [</span>
<a href="#l52.587"></a><span id="l52.587">                 descriptionDiv,</span>
<a href="#l52.588"></a><span id="l52.588">                 React.DOM.div({</span>
<a href="#l52.589"></a><span id="l52.589" class="difflineminus">-                        className: 'wrapper',</span>
<a href="#l52.590"></a><span id="l52.590" class="difflineminus">-                        style: { flexDirection: 'column' },</span>
<a href="#l52.591"></a><span id="l52.591" class="difflineplus">+                        className: &quot;wrapper&quot;,</span>
<a href="#l52.592"></a><span id="l52.592" class="difflineplus">+                        style: { flexDirection: &quot;column&quot; },</span>
<a href="#l52.593"></a><span id="l52.593">                     },</span>
<a href="#l52.594"></a><span id="l52.594">                     statusDiv,</span>
<a href="#l52.595"></a><span id="l52.595">                     priorityDiv,</span>
<a href="#l52.596"></a><span id="l52.596">                     showTimeAsDiv</span>
<a href="#l52.597"></a><span id="l52.597">                 ),</span>
<a href="#l52.598"></a><span id="l52.598">                 remindersDiv,</span>
<a href="#l52.599"></a><span id="l52.599">                 attachmentsDiv,</span>
<a href="#l52.600"></a><span id="l52.600">                 attendeesDiv</span>
<a href="#l52.601"></a><span id="l52.601">             ];</span>
<a href="#l52.602"></a><span id="l52.602">             let tabpanels = this.props.tabs.map((m, index) =&gt; {</span>
<a href="#l52.603"></a><span id="l52.603">                 return React.DOM.div({</span>
<a href="#l52.604"></a><span id="l52.604" class="difflineminus">-                        className: 'box tabpanel ' + (this.state.activeTab == index ? '' : 'hidden'),</span>
<a href="#l52.605"></a><span id="l52.605" class="difflineminus">-                        key: 'tabpanelkey ' + index</span>
<a href="#l52.606"></a><span id="l52.606" class="difflineplus">+                        className: &quot;box tabpanel &quot; + (this.state.activeTab == index ? &quot;&quot; : &quot;hidden&quot;),</span>
<a href="#l52.607"></a><span id="l52.607" class="difflineplus">+                        key: &quot;tabpanelkey &quot; + index</span>
<a href="#l52.608"></a><span id="l52.608">                     },</span>
<a href="#l52.609"></a><span id="l52.609">                     tabpanelChildren[index]</span>
<a href="#l52.610"></a><span id="l52.610">                 );</span>
<a href="#l52.611"></a><span id="l52.611">             });</span>
<a href="#l52.612"></a><span id="l52.612" class="difflineminus">-            return React.DOM.div({ id: 'topwrapper' },</span>
<a href="#l52.613"></a><span id="l52.613" class="difflineminus">-                React.DOM.div({ className: 'wrapper' },</span>
<a href="#l52.614"></a><span id="l52.614" class="difflineplus">+            return React.DOM.div({ id: &quot;topwrapper&quot; },</span>
<a href="#l52.615"></a><span id="l52.615" class="difflineplus">+                React.DOM.div({ className: &quot;wrapper&quot; },</span>
<a href="#l52.616"></a><span id="l52.616">                     titleDiv,</span>
<a href="#l52.617"></a><span id="l52.617">                     locationDiv,</span>
<a href="#l52.618"></a><span id="l52.618">                     startDiv,</span>
<a href="#l52.619"></a><span id="l52.619">                     endDiv,</span>
<a href="#l52.620"></a><span id="l52.620">                     allDayDiv,</span>
<a href="#l52.621"></a><span id="l52.621">                     repeatDiv,</span>
<a href="#l52.622"></a><span id="l52.622">                     React.DOM.div(</span>
<a href="#l52.623"></a><span id="l52.623" class="difflineminus">-                        { style: { flexDirection: 'row', display: 'flex' } },</span>
<a href="#l52.624"></a><span id="l52.624" class="difflineplus">+                        { style: { flexDirection: &quot;row&quot;, display: &quot;flex&quot; } },</span>
<a href="#l52.625"></a><span id="l52.625">                         calendarDiv,</span>
<a href="#l52.626"></a><span id="l52.626">                         privacyDiv</span>
<a href="#l52.627"></a><span id="l52.627">                     ),</span>
<a href="#l52.628"></a><span id="l52.628">                     categoriesDiv,</span>
<a href="#l52.629"></a><span id="l52.629">                     React.createElement(</span>
<a href="#l52.630"></a><span id="l52.630">                         Tabstrip, {</span>
<a href="#l52.631"></a><span id="l52.631">                             tabs: this.props.tabs,</span>
<a href="#l52.632"></a><span id="l52.632" class="difflineminus">-                            keyprop: 'activeTab',</span>
<a href="#l52.633"></a><span id="l52.633" class="difflineplus">+                            keyprop: &quot;activeTab&quot;,</span>
<a href="#l52.634"></a><span id="l52.634">                             activeTab: this.state.activeTab,</span>
<a href="#l52.635"></a><span id="l52.635">                             onInput: this.handleSimpleChange</span>
<a href="#l52.636"></a><span id="l52.636">                         }),</span>
<a href="#l52.637"></a><span id="l52.637">                     tabpanels,</span>
<a href="#l52.638"></a><span id="l52.638">                     urlDiv</span>
<a href="#l52.639"></a><span id="l52.639">                 )</span>
<a href="#l52.640"></a><span id="l52.640">             );</span>
<a href="#l52.641"></a><span id="l52.641">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/calendar/lightning/content/imip-bar.js</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/calendar/lightning/content/imip-bar.js</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -255,33 +255,33 @@ var ltnImipBar = {</span>
<a href="#l53.4"></a><span id="l53.4">             !ltnImipBar.foundItems[0] || !ltnImipBar.itipItem) {</span>
<a href="#l53.5"></a><span id="l53.5">             return;</span>
<a href="#l53.6"></a><span id="l53.6">         }</span>
<a href="#l53.7"></a><span id="l53.7"> </span>
<a href="#l53.8"></a><span id="l53.8">         let msgOverlay = ltnImipBar.msgOverlay;</span>
<a href="#l53.9"></a><span id="l53.9">         let diff = cal.itip.compare(ltnImipBar.itipItem.getItemList({})[0], ltnImipBar.foundItems[0]);</span>
<a href="#l53.10"></a><span id="l53.10">         // displaying chnages is only needed if that is enabled, an item already exists and there are</span>
<a href="#l53.11"></a><span id="l53.11">         // differences</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-        if (diff != 0 &amp;&amp; Preferences.get('calendar.itip.displayInvitationChanges', false)) {</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineplus">+        if (diff != 0 &amp;&amp; Preferences.get(&quot;calendar.itip.displayInvitationChanges&quot;, false)) {</span>
<a href="#l53.14"></a><span id="l53.14">             let foundOverlay = ltn.invitation.createInvitationOverlay(ltnImipBar.foundItems[0],</span>
<a href="#l53.15"></a><span id="l53.15">                                                                       ltnImipBar.itipItem);</span>
<a href="#l53.16"></a><span id="l53.16">             let serializedOverlay = cal.xml.serializeDOM(foundOverlay);</span>
<a href="#l53.17"></a><span id="l53.17">             let organizerId = ltnImipBar.itipItem.targetCalendar.getProperty(&quot;organizerId&quot;);</span>
<a href="#l53.18"></a><span id="l53.18">             if (diff == 1) {</span>
<a href="#l53.19"></a><span id="l53.19">                 // this is an update to previously accepted invitation</span>
<a href="#l53.20"></a><span id="l53.20">                 msgOverlay = ltn.invitation.compareInvitationOverlay(serializedOverlay, msgOverlay,</span>
<a href="#l53.21"></a><span id="l53.21">                                                                      organizerId);</span>
<a href="#l53.22"></a><span id="l53.22">             } else {</span>
<a href="#l53.23"></a><span id="l53.23">                 // this is a copy of a previously sent out invitation or a previous revision of a</span>
<a href="#l53.24"></a><span id="l53.24">                 // meanwhile accepted invitation, so we flip comparison order</span>
<a href="#l53.25"></a><span id="l53.25">                 msgOverlay = ltn.invitation.compareInvitationOverlay(msgOverlay, serializedOverlay,</span>
<a href="#l53.26"></a><span id="l53.26">                                                                      organizerId);</span>
<a href="#l53.27"></a><span id="l53.27">             }</span>
<a href="#l53.28"></a><span id="l53.28">         }</span>
<a href="#l53.29"></a><span id="l53.29" class="difflineminus">-        msgWindow.displayHTMLInMessagePane('', msgOverlay, false);</span>
<a href="#l53.30"></a><span id="l53.30" class="difflineplus">+        msgWindow.displayHTMLInMessagePane(&quot;&quot;, msgOverlay, false);</span>
<a href="#l53.31"></a><span id="l53.31">     },</span>
<a href="#l53.32"></a><span id="l53.32"> </span>
<a href="#l53.33"></a><span id="l53.33">     executeAction: function ltnExecAction(partStat, extendResponse) {</span>
<a href="#l53.34"></a><span id="l53.34">         function _execAction(aActionFunc, aItipItem, aWindow, aPartStat) {</span>
<a href="#l53.35"></a><span id="l53.35">             if (cal.itip.promptCalendar(aActionFunc.method, aItipItem, aWindow)) {</span>
<a href="#l53.36"></a><span id="l53.36">                 // filter out fake partstats</span>
<a href="#l53.37"></a><span id="l53.37">                 if (aPartStat.startsWith(&quot;X-&quot;)) {</span>
<a href="#l53.38"></a><span id="l53.38">                     partstat = &quot;&quot;;</span>
<a href="#l53.39"></a><span id="l53.39" class="difflineat">@@ -322,17 +322,17 @@ var ltnImipBar = {</span>
<a href="#l53.40"></a><span id="l53.40">                     Components.utils.reportError(exc);</span>
<a href="#l53.41"></a><span id="l53.41">                 }</span>
<a href="#l53.42"></a><span id="l53.42">                 return true;</span>
<a href="#l53.43"></a><span id="l53.43">             }</span>
<a href="#l53.44"></a><span id="l53.44">             return false;</span>
<a href="#l53.45"></a><span id="l53.45">         }</span>
<a href="#l53.46"></a><span id="l53.46"> </span>
<a href="#l53.47"></a><span id="l53.47">         if (partStat == null) {</span>
<a href="#l53.48"></a><span id="l53.48" class="difflineminus">-            partStat = '';</span>
<a href="#l53.49"></a><span id="l53.49" class="difflineplus">+            partStat = &quot;&quot;;</span>
<a href="#l53.50"></a><span id="l53.50">         }</span>
<a href="#l53.51"></a><span id="l53.51">         if (partStat == &quot;X-SHOWDETAILS&quot;) {</span>
<a href="#l53.52"></a><span id="l53.52">             let items = ltnImipBar.foundItems;</span>
<a href="#l53.53"></a><span id="l53.53">             if (items &amp;&amp; items.length) {</span>
<a href="#l53.54"></a><span id="l53.54">                 let item = items[0].isMutable ? items[0] : items[0].clone();</span>
<a href="#l53.55"></a><span id="l53.55">                 modifyEventWithDialog(item);</span>
<a href="#l53.56"></a><span id="l53.56">             }</span>
<a href="#l53.57"></a><span id="l53.57">         } else {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -396,17 +396,17 @@ function onLoad() {</span>
<a href="#l54.4"></a><span id="l54.4">     eventDialogCalendarObserver.observe(item.calendar);</span>
<a href="#l54.5"></a><span id="l54.5"> </span>
<a href="#l54.6"></a><span id="l54.6">     onLoad.hasLoaded = true;</span>
<a href="#l54.7"></a><span id="l54.7"> }</span>
<a href="#l54.8"></a><span id="l54.8"> // Set a variable to allow or prevent actions before the dialog is done loading.</span>
<a href="#l54.9"></a><span id="l54.9"> onLoad.hasLoaded = false;</span>
<a href="#l54.10"></a><span id="l54.10"> </span>
<a href="#l54.11"></a><span id="l54.11"> function onEventDialogUnload() {</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-    if (typeof ToolbarIconColor !== 'undefined') {</span>
<a href="#l54.13"></a><span id="l54.13" class="difflineplus">+    if (typeof ToolbarIconColor !== &quot;undefined&quot;) {</span>
<a href="#l54.14"></a><span id="l54.14">         ToolbarIconColor.uninit();</span>
<a href="#l54.15"></a><span id="l54.15">     }</span>
<a href="#l54.16"></a><span id="l54.16">     Services.obs.removeObserver(eventDialogQuitObserver,</span>
<a href="#l54.17"></a><span id="l54.17">                                 &quot;quit-application-requested&quot;);</span>
<a href="#l54.18"></a><span id="l54.18">     eventDialogCalendarObserver.cancel();</span>
<a href="#l54.19"></a><span id="l54.19"> }</span>
<a href="#l54.20"></a><span id="l54.20"> </span>
<a href="#l54.21"></a><span id="l54.21"> /**</span>
<a href="#l54.22"></a><span id="l54.22" class="difflineat">@@ -540,17 +540,17 @@ function cancelItem() {</span>
<a href="#l54.23"></a><span id="l54.23"> function loadDialog(aItem) {</span>
<a href="#l54.24"></a><span id="l54.24">     loadDateTime(aItem);</span>
<a href="#l54.25"></a><span id="l54.25"> </span>
<a href="#l54.26"></a><span id="l54.26">     let itemProps;</span>
<a href="#l54.27"></a><span id="l54.27">     if (gNewItemUI) {</span>
<a href="#l54.28"></a><span id="l54.28">         // Properties for initializing the React component/UI.</span>
<a href="#l54.29"></a><span id="l54.29">         itemProps = {</span>
<a href="#l54.30"></a><span id="l54.30">             initialTitle: aItem.title,</span>
<a href="#l54.31"></a><span id="l54.31" class="difflineminus">-            initialLocation: aItem.getProperty('LOCATION'),</span>
<a href="#l54.32"></a><span id="l54.32" class="difflineplus">+            initialLocation: aItem.getProperty(&quot;LOCATION&quot;),</span>
<a href="#l54.33"></a><span id="l54.33">             initialStartTimezone: gStartTimezone,</span>
<a href="#l54.34"></a><span id="l54.34">             initialEndTimezone: gEndTimezone,</span>
<a href="#l54.35"></a><span id="l54.35">             initialStartTime: gStartTime,</span>
<a href="#l54.36"></a><span id="l54.36">             initialEndTime: gEndTime</span>
<a href="#l54.37"></a><span id="l54.37">         };</span>
<a href="#l54.38"></a><span id="l54.38">     } else {</span>
<a href="#l54.39"></a><span id="l54.39">         setElementValue(&quot;item-title&quot;, aItem.title);</span>
<a href="#l54.40"></a><span id="l54.40">         setElementValue(&quot;item-location&quot;, aItem.getProperty(&quot;LOCATION&quot;));</span>
<a href="#l54.41"></a><span id="l54.41" class="difflineat">@@ -590,17 +590,17 @@ function loadDialog(aItem) {</span>
<a href="#l54.42"></a><span id="l54.42"> </span>
<a href="#l54.43"></a><span id="l54.43">     // Categories</span>
<a href="#l54.44"></a><span id="l54.44">     if (gNewItemUI) {</span>
<a href="#l54.45"></a><span id="l54.45">         // XXX more to do here with localization, see loadCategories.</span>
<a href="#l54.46"></a><span id="l54.46">         itemProps.initialCategoriesList = cal.sortArrayByLocaleCollator(getPrefCategoriesArray());</span>
<a href="#l54.47"></a><span id="l54.47">         itemProps.initialCategories = aItem.getCategories({});</span>
<a href="#l54.48"></a><span id="l54.48"> </span>
<a href="#l54.49"></a><span id="l54.49">         // just to demo capsules component</span>
<a href="#l54.50"></a><span id="l54.50" class="difflineminus">-        itemProps.initialCategories = ['Some', 'Demo', 'Categories'];</span>
<a href="#l54.51"></a><span id="l54.51" class="difflineplus">+        itemProps.initialCategories = [&quot;Some&quot;, &quot;Demo&quot;, &quot;Categories&quot;];</span>
<a href="#l54.52"></a><span id="l54.52">     } else {</span>
<a href="#l54.53"></a><span id="l54.53">         loadCategories(aItem);</span>
<a href="#l54.54"></a><span id="l54.54">     }</span>
<a href="#l54.55"></a><span id="l54.55"> </span>
<a href="#l54.56"></a><span id="l54.56">     // Attachment</span>
<a href="#l54.57"></a><span id="l54.57">     if (!gNewItemUI) {</span>
<a href="#l54.58"></a><span id="l54.58">         loadCloudProviders();</span>
<a href="#l54.59"></a><span id="l54.59">     }</span>
<a href="#l54.60"></a><span id="l54.60" class="difflineat">@@ -2574,24 +2574,24 @@ function updateRepeat(aSuppressDialogs, </span>
<a href="#l54.61"></a><span id="l54.61">             disableElementWithLock(&quot;todo-has-entrydate&quot;, &quot;repeat-lock&quot;);</span>
<a href="#l54.62"></a><span id="l54.62">         }</span>
<a href="#l54.63"></a><span id="l54.63">     }</span>
<a href="#l54.64"></a><span id="l54.64"> </span>
<a href="#l54.65"></a><span id="l54.65">     let repeatMenu = document.getElementById(&quot;item-repeat&quot;);</span>
<a href="#l54.66"></a><span id="l54.66">     let repeatValue = repeatMenu.selectedItem.getAttribute(&quot;value&quot;);</span>
<a href="#l54.67"></a><span id="l54.67">     let repeatDeck = document.getElementById(&quot;repeat-deck&quot;);</span>
<a href="#l54.68"></a><span id="l54.68"> </span>
<a href="#l54.69"></a><span id="l54.69" class="difflineminus">-    if (repeatValue == 'none') {</span>
<a href="#l54.70"></a><span id="l54.70" class="difflineplus">+    if (repeatValue == &quot;none&quot;) {</span>
<a href="#l54.71"></a><span id="l54.71">         repeatDeck.selectedIndex = -1;</span>
<a href="#l54.72"></a><span id="l54.72">         window.recurrenceInfo = null;</span>
<a href="#l54.73"></a><span id="l54.73">         let item = window.calendarItem;</span>
<a href="#l54.74"></a><span id="l54.74">         if (isToDo(item)) {</span>
<a href="#l54.75"></a><span id="l54.75">             enableElementWithLock(&quot;todo-has-entrydate&quot;, &quot;repeat-lock&quot;);</span>
<a href="#l54.76"></a><span id="l54.76">         }</span>
<a href="#l54.77"></a><span id="l54.77" class="difflineminus">-    } else if (repeatValue == 'custom') {</span>
<a href="#l54.78"></a><span id="l54.78" class="difflineplus">+    } else if (repeatValue == &quot;custom&quot;) {</span>
<a href="#l54.79"></a><span id="l54.79">         let lastRepeatDeck = repeatDeck.selectedIndex;</span>
<a href="#l54.80"></a><span id="l54.80">         repeatDeck.selectedIndex = 1;</span>
<a href="#l54.81"></a><span id="l54.81">         // the user selected custom repeat pattern. we now need to bring</span>
<a href="#l54.82"></a><span id="l54.82">         // up the appropriate dialog in order to let the user specify the</span>
<a href="#l54.83"></a><span id="l54.83">         // new rule. First of all, retrieve the item we want to specify</span>
<a href="#l54.84"></a><span id="l54.84">         // the custom repeat pattern for.</span>
<a href="#l54.85"></a><span id="l54.85">         let item = window.calendarItem;</span>
<a href="#l54.86"></a><span id="l54.86"> </span>
<a href="#l54.87"></a><span id="l54.87" class="difflineat">@@ -2693,36 +2693,36 @@ function updateRepeat(aSuppressDialogs, </span>
<a href="#l54.88"></a><span id="l54.88">             setElementValue(&quot;repeat-until-datepicker&quot;, &quot;forever&quot;);</span>
<a href="#l54.89"></a><span id="l54.89">         }</span>
<a href="#l54.90"></a><span id="l54.90"> </span>
<a href="#l54.91"></a><span id="l54.91">         repeatDeck.selectedIndex = 0;</span>
<a href="#l54.92"></a><span id="l54.92"> </span>
<a href="#l54.93"></a><span id="l54.93">         let recRule = createRecurrenceRule();</span>
<a href="#l54.94"></a><span id="l54.94">         recRule.interval = 1;</span>
<a href="#l54.95"></a><span id="l54.95">         switch (repeatValue) {</span>
<a href="#l54.96"></a><span id="l54.96" class="difflineminus">-            case 'daily':</span>
<a href="#l54.97"></a><span id="l54.97" class="difflineminus">-              recRule.type = 'DAILY';</span>
<a href="#l54.98"></a><span id="l54.98" class="difflineplus">+            case &quot;daily&quot;:</span>
<a href="#l54.99"></a><span id="l54.99" class="difflineplus">+              recRule.type = &quot;DAILY&quot;;</span>
<a href="#l54.100"></a><span id="l54.100">               break;</span>
<a href="#l54.101"></a><span id="l54.101" class="difflineminus">-            case 'weekly':</span>
<a href="#l54.102"></a><span id="l54.102" class="difflineminus">-              recRule.type = 'WEEKLY';</span>
<a href="#l54.103"></a><span id="l54.103" class="difflineplus">+            case &quot;weekly&quot;:</span>
<a href="#l54.104"></a><span id="l54.104" class="difflineplus">+              recRule.type = &quot;WEEKLY&quot;;</span>
<a href="#l54.105"></a><span id="l54.105">               break;</span>
<a href="#l54.106"></a><span id="l54.106" class="difflineminus">-            case 'every.weekday':</span>
<a href="#l54.107"></a><span id="l54.107" class="difflineminus">-              recRule.type = 'DAILY';</span>
<a href="#l54.108"></a><span id="l54.108" class="difflineplus">+            case &quot;every.weekday&quot;:</span>
<a href="#l54.109"></a><span id="l54.109" class="difflineplus">+              recRule.type = &quot;DAILY&quot;;</span>
<a href="#l54.110"></a><span id="l54.110">               let onDays = [2, 3, 4, 5, 6];</span>
<a href="#l54.111"></a><span id="l54.111">               recRule.setComponent(&quot;BYDAY&quot;, onDays.length, onDays);</span>
<a href="#l54.112"></a><span id="l54.112">               break;</span>
<a href="#l54.113"></a><span id="l54.113" class="difflineminus">-            case 'bi.weekly':</span>
<a href="#l54.114"></a><span id="l54.114" class="difflineminus">-              recRule.type = 'WEEKLY';</span>
<a href="#l54.115"></a><span id="l54.115" class="difflineplus">+            case &quot;bi.weekly&quot;:</span>
<a href="#l54.116"></a><span id="l54.116" class="difflineplus">+              recRule.type = &quot;WEEKLY&quot;;</span>
<a href="#l54.117"></a><span id="l54.117">               recRule.interval = 2;</span>
<a href="#l54.118"></a><span id="l54.118">               break;</span>
<a href="#l54.119"></a><span id="l54.119" class="difflineminus">-            case 'monthly':</span>
<a href="#l54.120"></a><span id="l54.120" class="difflineminus">-              recRule.type = 'MONTHLY';</span>
<a href="#l54.121"></a><span id="l54.121" class="difflineplus">+            case &quot;monthly&quot;:</span>
<a href="#l54.122"></a><span id="l54.122" class="difflineplus">+              recRule.type = &quot;MONTHLY&quot;;</span>
<a href="#l54.123"></a><span id="l54.123">               break;</span>
<a href="#l54.124"></a><span id="l54.124" class="difflineminus">-            case 'yearly':</span>
<a href="#l54.125"></a><span id="l54.125" class="difflineminus">-              recRule.type = 'YEARLY';</span>
<a href="#l54.126"></a><span id="l54.126" class="difflineplus">+            case &quot;yearly&quot;:</span>
<a href="#l54.127"></a><span id="l54.127" class="difflineplus">+              recRule.type = &quot;YEARLY&quot;;</span>
<a href="#l54.128"></a><span id="l54.128">               break;</span>
<a href="#l54.129"></a><span id="l54.129">         }</span>
<a href="#l54.130"></a><span id="l54.130"> </span>
<a href="#l54.131"></a><span id="l54.131">         setUpEntrydateForTask(item);</span>
<a href="#l54.132"></a><span id="l54.132">         updateUntildateRecRule(recRule);</span>
<a href="#l54.133"></a><span id="l54.133"> </span>
<a href="#l54.134"></a><span id="l54.134">         recurrenceInfo.insertRecurrenceItemAt(recRule, 0);</span>
<a href="#l54.135"></a><span id="l54.135">         window.recurrenceInfo = recurrenceInfo;</span>
<a href="#l54.136"></a><span id="l54.136" class="difflineat">@@ -3402,63 +3402,63 @@ function updateDateTime() {</span>
<a href="#l54.137"></a><span id="l54.137"> function updateTimezone() {</span>
<a href="#l54.138"></a><span id="l54.138">     function updateTimezoneElement(aTimezone, aId, aDateTime) {</span>
<a href="#l54.139"></a><span id="l54.139">         let element = document.getElementById(aId);</span>
<a href="#l54.140"></a><span id="l54.140">         if (!element) {</span>
<a href="#l54.141"></a><span id="l54.141">             return;</span>
<a href="#l54.142"></a><span id="l54.142">         }</span>
<a href="#l54.143"></a><span id="l54.143"> </span>
<a href="#l54.144"></a><span id="l54.144">         if (aTimezone) {</span>
<a href="#l54.145"></a><span id="l54.145" class="difflineminus">-            element.removeAttribute('collapsed');</span>
<a href="#l54.146"></a><span id="l54.146" class="difflineplus">+            element.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l54.147"></a><span id="l54.147">             element.value = aTimezone.displayName || aTimezone.tzid;</span>
<a href="#l54.148"></a><span id="l54.148">             if (!aDateTime || !aDateTime.isValid || gIsReadOnly || aDateTime.isDate) {</span>
<a href="#l54.149"></a><span id="l54.149" class="difflineminus">-                if (element.hasAttribute('class')) {</span>
<a href="#l54.150"></a><span id="l54.150" class="difflineminus">-                    element.setAttribute('class-on-enabled',</span>
<a href="#l54.151"></a><span id="l54.151" class="difflineminus">-                                         element.getAttribute('class'));</span>
<a href="#l54.152"></a><span id="l54.152" class="difflineminus">-                    element.removeAttribute('class');</span>
<a href="#l54.153"></a><span id="l54.153" class="difflineplus">+                if (element.hasAttribute(&quot;class&quot;)) {</span>
<a href="#l54.154"></a><span id="l54.154" class="difflineplus">+                    element.setAttribute(&quot;class-on-enabled&quot;,</span>
<a href="#l54.155"></a><span id="l54.155" class="difflineplus">+                                         element.getAttribute(&quot;class&quot;));</span>
<a href="#l54.156"></a><span id="l54.156" class="difflineplus">+                    element.removeAttribute(&quot;class&quot;);</span>
<a href="#l54.157"></a><span id="l54.157">                 }</span>
<a href="#l54.158"></a><span id="l54.158" class="difflineminus">-                if (element.hasAttribute('onclick')) {</span>
<a href="#l54.159"></a><span id="l54.159" class="difflineminus">-                    element.setAttribute('onclick-on-enabled',</span>
<a href="#l54.160"></a><span id="l54.160" class="difflineminus">-                                         element.getAttribute('onclick'));</span>
<a href="#l54.161"></a><span id="l54.161" class="difflineminus">-                    element.removeAttribute('onclick');</span>
<a href="#l54.162"></a><span id="l54.162" class="difflineplus">+                if (element.hasAttribute(&quot;onclick&quot;)) {</span>
<a href="#l54.163"></a><span id="l54.163" class="difflineplus">+                    element.setAttribute(&quot;onclick-on-enabled&quot;,</span>
<a href="#l54.164"></a><span id="l54.164" class="difflineplus">+                                         element.getAttribute(&quot;onclick&quot;));</span>
<a href="#l54.165"></a><span id="l54.165" class="difflineplus">+                    element.removeAttribute(&quot;onclick&quot;);</span>
<a href="#l54.166"></a><span id="l54.166">                 }</span>
<a href="#l54.167"></a><span id="l54.167" class="difflineminus">-                element.setAttribute('disabled', 'true');</span>
<a href="#l54.168"></a><span id="l54.168" class="difflineplus">+                element.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l54.169"></a><span id="l54.169">             } else {</span>
<a href="#l54.170"></a><span id="l54.170" class="difflineminus">-                if (element.hasAttribute('class-on-enabled')) {</span>
<a href="#l54.171"></a><span id="l54.171" class="difflineminus">-                    element.setAttribute('class',</span>
<a href="#l54.172"></a><span id="l54.172" class="difflineminus">-                                         element.getAttribute('class-on-enabled'));</span>
<a href="#l54.173"></a><span id="l54.173" class="difflineminus">-                    element.removeAttribute('class-on-enabled');</span>
<a href="#l54.174"></a><span id="l54.174" class="difflineplus">+                if (element.hasAttribute(&quot;class-on-enabled&quot;)) {</span>
<a href="#l54.175"></a><span id="l54.175" class="difflineplus">+                    element.setAttribute(&quot;class&quot;,</span>
<a href="#l54.176"></a><span id="l54.176" class="difflineplus">+                                         element.getAttribute(&quot;class-on-enabled&quot;));</span>
<a href="#l54.177"></a><span id="l54.177" class="difflineplus">+                    element.removeAttribute(&quot;class-on-enabled&quot;);</span>
<a href="#l54.178"></a><span id="l54.178">                 }</span>
<a href="#l54.179"></a><span id="l54.179" class="difflineminus">-                if (element.hasAttribute('onclick-on-enabled')) {</span>
<a href="#l54.180"></a><span id="l54.180" class="difflineminus">-                    element.setAttribute('onclick',</span>
<a href="#l54.181"></a><span id="l54.181" class="difflineminus">-                                         element.getAttribute('onclick-on-enabled'));</span>
<a href="#l54.182"></a><span id="l54.182" class="difflineminus">-                    element.removeAttribute('onclick-on-enabled');</span>
<a href="#l54.183"></a><span id="l54.183" class="difflineplus">+                if (element.hasAttribute(&quot;onclick-on-enabled&quot;)) {</span>
<a href="#l54.184"></a><span id="l54.184" class="difflineplus">+                    element.setAttribute(&quot;onclick&quot;,</span>
<a href="#l54.185"></a><span id="l54.185" class="difflineplus">+                                         element.getAttribute(&quot;onclick-on-enabled&quot;));</span>
<a href="#l54.186"></a><span id="l54.186" class="difflineplus">+                    element.removeAttribute(&quot;onclick-on-enabled&quot;);</span>
<a href="#l54.187"></a><span id="l54.187">                 }</span>
<a href="#l54.188"></a><span id="l54.188" class="difflineminus">-                element.removeAttribute('disabled');</span>
<a href="#l54.189"></a><span id="l54.189" class="difflineplus">+                element.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l54.190"></a><span id="l54.190">             }</span>
<a href="#l54.191"></a><span id="l54.191">         } else {</span>
<a href="#l54.192"></a><span id="l54.192" class="difflineminus">-            element.setAttribute('collapsed', 'true');</span>
<a href="#l54.193"></a><span id="l54.193" class="difflineplus">+            element.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l54.194"></a><span id="l54.194">         }</span>
<a href="#l54.195"></a><span id="l54.195">     }</span>
<a href="#l54.196"></a><span id="l54.196"> </span>
<a href="#l54.197"></a><span id="l54.197">     // convert to default timezone if the timezone option</span>
<a href="#l54.198"></a><span id="l54.198">     // is *not* checked, otherwise keep the specific timezone</span>
<a href="#l54.199"></a><span id="l54.199">     // and display the labels in order to modify the timezone.</span>
<a href="#l54.200"></a><span id="l54.200">     if (gTimezonesEnabled) {</span>
<a href="#l54.201"></a><span id="l54.201">         updateTimezoneElement(gStartTimezone,</span>
<a href="#l54.202"></a><span id="l54.202" class="difflineminus">-                              'timezone-starttime',</span>
<a href="#l54.203"></a><span id="l54.203" class="difflineplus">+                              &quot;timezone-starttime&quot;,</span>
<a href="#l54.204"></a><span id="l54.204">                               gStartTime);</span>
<a href="#l54.205"></a><span id="l54.205">         updateTimezoneElement(gEndTimezone,</span>
<a href="#l54.206"></a><span id="l54.206" class="difflineminus">-                              'timezone-endtime',</span>
<a href="#l54.207"></a><span id="l54.207" class="difflineplus">+                              &quot;timezone-endtime&quot;,</span>
<a href="#l54.208"></a><span id="l54.208">                               gEndTime);</span>
<a href="#l54.209"></a><span id="l54.209">     } else {</span>
<a href="#l54.210"></a><span id="l54.210" class="difflineminus">-        document.getElementById('timezone-starttime')</span>
<a href="#l54.211"></a><span id="l54.211" class="difflineminus">-                .setAttribute('collapsed', 'true');</span>
<a href="#l54.212"></a><span id="l54.212" class="difflineminus">-        document.getElementById('timezone-endtime')</span>
<a href="#l54.213"></a><span id="l54.213" class="difflineminus">-                .setAttribute('collapsed', 'true');</span>
<a href="#l54.214"></a><span id="l54.214" class="difflineplus">+        document.getElementById(&quot;timezone-starttime&quot;)</span>
<a href="#l54.215"></a><span id="l54.215" class="difflineplus">+                .setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l54.216"></a><span id="l54.216" class="difflineplus">+        document.getElementById(&quot;timezone-endtime&quot;)</span>
<a href="#l54.217"></a><span id="l54.217" class="difflineplus">+                .setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l54.218"></a><span id="l54.218">     }</span>
<a href="#l54.219"></a><span id="l54.219"> }</span>
<a href="#l54.220"></a><span id="l54.220"> </span>
<a href="#l54.221"></a><span id="l54.221"> /**</span>
<a href="#l54.222"></a><span id="l54.222">  * Updates dialog controls related to item attachments</span>
<a href="#l54.223"></a><span id="l54.223">  */</span>
<a href="#l54.224"></a><span id="l54.224"> function updateAttachment() {</span>
<a href="#l54.225"></a><span id="l54.225">     let hasAttachments = capSupported(&quot;attachments&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -74,17 +74,17 @@ var calendarTabType = {</span>
<a href="#l55.4"></a><span id="l55.4">             // Since we do strange tab switching logic in ltnSwitch2Calendar,</span>
<a href="#l55.5"></a><span id="l55.5">             // we should store the current tab state ourselves.</span>
<a href="#l55.6"></a><span id="l55.6">             background: (aTab != tabmail.currentTabInfo)</span>
<a href="#l55.7"></a><span id="l55.7">         };</span>
<a href="#l55.8"></a><span id="l55.8">       },</span>
<a href="#l55.9"></a><span id="l55.9"> </span>
<a href="#l55.10"></a><span id="l55.10">       restoreTab: function(aTabmail, aState) {</span>
<a href="#l55.11"></a><span id="l55.11">         aState.title = ltnGetString(&quot;lightning&quot;, &quot;tabTitleCalendar&quot;);</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-        aTabmail.openTab('calendar', aState);</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineplus">+        aTabmail.openTab(&quot;calendar&quot;, aState);</span>
<a href="#l55.14"></a><span id="l55.14">       },</span>
<a href="#l55.15"></a><span id="l55.15"> </span>
<a href="#l55.16"></a><span id="l55.16">       onTitleChanged: function(aTab) {</span>
<a href="#l55.17"></a><span id="l55.17">         aTab.title = ltnGetString(&quot;lightning&quot;, &quot;tabTitleCalendar&quot;);</span>
<a href="#l55.18"></a><span id="l55.18">       },</span>
<a href="#l55.19"></a><span id="l55.19"> </span>
<a href="#l55.20"></a><span id="l55.20">       supportsCommand: (aCommand, aTab) =&gt; calendarController2.supportsCommand(aCommand),</span>
<a href="#l55.21"></a><span id="l55.21">       isCommandEnabled: (aCommand, aTab) =&gt; calendarController2.isCommandEnabled(aCommand),</span>
<a href="#l55.22"></a><span id="l55.22" class="difflineat">@@ -119,17 +119,17 @@ var calendarTabType = {</span>
<a href="#l55.23"></a><span id="l55.23">             // Since we do strange tab switching logic in ltnSwitch2Task,</span>
<a href="#l55.24"></a><span id="l55.24">             // we should store the current tab state ourselves.</span>
<a href="#l55.25"></a><span id="l55.25">             background: (aTab != tabmail.currentTabInfo)</span>
<a href="#l55.26"></a><span id="l55.26">         };</span>
<a href="#l55.27"></a><span id="l55.27">       },</span>
<a href="#l55.28"></a><span id="l55.28"> </span>
<a href="#l55.29"></a><span id="l55.29">       restoreTab: function(aTabmail, aState) {</span>
<a href="#l55.30"></a><span id="l55.30">         aState.title = ltnGetString(&quot;lightning&quot;, &quot;tabTitleTasks&quot;);</span>
<a href="#l55.31"></a><span id="l55.31" class="difflineminus">-        aTabmail.openTab('tasks', aState);</span>
<a href="#l55.32"></a><span id="l55.32" class="difflineplus">+        aTabmail.openTab(&quot;tasks&quot;, aState);</span>
<a href="#l55.33"></a><span id="l55.33">       },</span>
<a href="#l55.34"></a><span id="l55.34"> </span>
<a href="#l55.35"></a><span id="l55.35">       onTitleChanged: function(aTab) {</span>
<a href="#l55.36"></a><span id="l55.36">         aTab.title = ltnGetString(&quot;lightning&quot;, &quot;tabTitleTasks&quot;);</span>
<a href="#l55.37"></a><span id="l55.37">       },</span>
<a href="#l55.38"></a><span id="l55.38"> </span>
<a href="#l55.39"></a><span id="l55.39">       supportsCommand: (aCommand, aTab) =&gt; calendarController2.supportsCommand(aCommand),</span>
<a href="#l55.40"></a><span id="l55.40">       isCommandEnabled: (aCommand, aTab) =&gt; calendarController2.isCommandEnabled(aCommand),</span>
<a href="#l55.41"></a><span id="l55.41" class="difflineat">@@ -213,17 +213,17 @@ var calendarItemTabType = {</span>
<a href="#l55.42"></a><span id="l55.42">         // the user if they want to save any unsaved changes.</span>
<a href="#l55.43"></a><span id="l55.43">         aTab.allowTabClose = false;</span>
<a href="#l55.44"></a><span id="l55.44"> </span>
<a href="#l55.45"></a><span id="l55.45">         // Put the arguments where they can be accessed easily</span>
<a href="#l55.46"></a><span id="l55.46">         // from the iframe. (window.arguments[0])</span>
<a href="#l55.47"></a><span id="l55.47">         aTab.iframe.contentWindow.arguments = [aArgs];</span>
<a href="#l55.48"></a><span id="l55.48"> </span>
<a href="#l55.49"></a><span id="l55.49">         // activate or de-activate 'Events and Tasks' menu items</span>
<a href="#l55.50"></a><span id="l55.50" class="difflineminus">-        document.commandDispatcher.updateCommands('calendar_commands');</span>
<a href="#l55.51"></a><span id="l55.51" class="difflineplus">+        document.commandDispatcher.updateCommands(&quot;calendar_commands&quot;);</span>
<a href="#l55.52"></a><span id="l55.52"> </span>
<a href="#l55.53"></a><span id="l55.53">         onLoadLightningItemPanel(iframeId, aArgs.url);</span>
<a href="#l55.54"></a><span id="l55.54"> </span>
<a href="#l55.55"></a><span id="l55.55">         this.idNumber += 1;</span>
<a href="#l55.56"></a><span id="l55.56">     },</span>
<a href="#l55.57"></a><span id="l55.57">     /**</span>
<a href="#l55.58"></a><span id="l55.58">      * Saves a tab's state when it is deactivated / hidden.  The opposite of showTab.</span>
<a href="#l55.59"></a><span id="l55.59">      *</span>
<a href="#l55.60"></a><span id="l55.60" class="difflineat">@@ -251,17 +251,17 @@ var calendarItemTabType = {</span>
<a href="#l55.61"></a><span id="l55.61">      */</span>
<a href="#l55.62"></a><span id="l55.62">     showTab: function(aTab) {</span>
<a href="#l55.63"></a><span id="l55.63">         // move toolbox into place then load state</span>
<a href="#l55.64"></a><span id="l55.64">         moveEventToolbox(aTab.panel.firstChild);</span>
<a href="#l55.65"></a><span id="l55.65">         Object.assign(gConfig, aTab.itemTabConfig);</span>
<a href="#l55.66"></a><span id="l55.66">         updateItemTabState(gConfig);</span>
<a href="#l55.67"></a><span id="l55.67"> </span>
<a href="#l55.68"></a><span id="l55.68">         // activate or de-activate 'Events and Tasks' menu items</span>
<a href="#l55.69"></a><span id="l55.69" class="difflineminus">-        document.commandDispatcher.updateCommands('calendar_commands');</span>
<a href="#l55.70"></a><span id="l55.70" class="difflineplus">+        document.commandDispatcher.updateCommands(&quot;calendar_commands&quot;);</span>
<a href="#l55.71"></a><span id="l55.71">     },</span>
<a href="#l55.72"></a><span id="l55.72">     /**</span>
<a href="#l55.73"></a><span id="l55.73">      * Called when there is a request to close a tab.  Using aTab.allowTabClose</span>
<a href="#l55.74"></a><span id="l55.74">      * we first prevent the tab from closing so we can prompt the user</span>
<a href="#l55.75"></a><span id="l55.75">      * about saving changes, then we allow the tab to close.</span>
<a href="#l55.76"></a><span id="l55.76">      *</span>
<a href="#l55.77"></a><span id="l55.77">      * @param {Object} aTab  A tab info object</span>
<a href="#l55.78"></a><span id="l55.78">      */</span>
<a href="#l55.79"></a><span id="l55.79" class="difflineat">@@ -349,17 +349,17 @@ var calendarItemTabType = {</span>
<a href="#l55.80"></a><span id="l55.80">                     }</span>
<a href="#l55.81"></a><span id="l55.81">                 });</span>
<a href="#l55.82"></a><span id="l55.82">             }</span>
<a href="#l55.83"></a><span id="l55.83">         }</span>
<a href="#l55.84"></a><span id="l55.84">     }</span>
<a href="#l55.85"></a><span id="l55.85"> };</span>
<a href="#l55.86"></a><span id="l55.86"> </span>
<a href="#l55.87"></a><span id="l55.87"> window.addEventListener(&quot;load&quot;, function(e) {</span>
<a href="#l55.88"></a><span id="l55.88" class="difflineminus">-    let tabmail = document.getElementById('tabmail');</span>
<a href="#l55.89"></a><span id="l55.89" class="difflineplus">+    let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l55.90"></a><span id="l55.90">     tabmail.registerTabType(calendarTabType);</span>
<a href="#l55.91"></a><span id="l55.91">     tabmail.registerTabType(calendarItemTabType);</span>
<a href="#l55.92"></a><span id="l55.92">     tabmail.registerTabMonitor(calendarTabMonitor);</span>
<a href="#l55.93"></a><span id="l55.93"> }, false);</span>
<a href="#l55.94"></a><span id="l55.94"> </span>
<a href="#l55.95"></a><span id="l55.95"> </span>
<a href="#l55.96"></a><span id="l55.96"> function ltnOnLoad(event) {</span>
<a href="#l55.97"></a><span id="l55.97">     // nuke the onload, or we get called every time there's</span>
<a href="#l55.98"></a><span id="l55.98" class="difflineat">@@ -615,17 +615,17 @@ function LtnObserveDisplayDeckChange(eve</span>
<a href="#l55.99"></a><span id="l55.99">     }</span>
<a href="#l55.100"></a><span id="l55.100"> </span>
<a href="#l55.101"></a><span id="l55.101">     let id = deck.selectedPanel &amp;&amp; deck.selectedPanel.id;</span>
<a href="#l55.102"></a><span id="l55.102"> </span>
<a href="#l55.103"></a><span id="l55.103">     // Switch back to mail mode in case we find that this</span>
<a href="#l55.104"></a><span id="l55.104">     // notification has been fired but we're still in calendar or task mode.</span>
<a href="#l55.105"></a><span id="l55.105">     // Specifically, switch back if we're *not* in mail mode but the notification</span>
<a href="#l55.106"></a><span id="l55.106">     // did *not* come from either the &quot;calendar-view-box&quot; or the &quot;calendar-task-box&quot;.</span>
<a href="#l55.107"></a><span id="l55.107" class="difflineminus">-    if (gCurrentMode != 'mail') {</span>
<a href="#l55.108"></a><span id="l55.108" class="difflineplus">+    if (gCurrentMode != &quot;mail&quot;) {</span>
<a href="#l55.109"></a><span id="l55.109">         if (id != &quot;calendar-view-box&quot; &amp;&amp; id != &quot;calendar-task-box&quot;) {</span>
<a href="#l55.110"></a><span id="l55.110">             ltnSwitch2Mail();</span>
<a href="#l55.111"></a><span id="l55.111">         }</span>
<a href="#l55.112"></a><span id="l55.112">     }</span>
<a href="#l55.113"></a><span id="l55.113"> }</span>
<a href="#l55.114"></a><span id="l55.114"> </span>
<a href="#l55.115"></a><span id="l55.115"> function ltnFinish() {</span>
<a href="#l55.116"></a><span id="l55.116">     getCalendarManager().removeObserver(gInvitationsCalendarManagerObserver);</span>
<a href="#l55.117"></a><span id="l55.117" class="difflineat">@@ -719,70 +719,70 @@ function openInvitationsDialog() {</span>
<a href="#l55.118"></a><span id="l55.118"> </span>
<a href="#l55.119"></a><span id="l55.119"> /**</span>
<a href="#l55.120"></a><span id="l55.120">  * the current mode is set to a string defining the current</span>
<a href="#l55.121"></a><span id="l55.121">  * mode we're in. allowed values are:</span>
<a href="#l55.122"></a><span id="l55.122">  *  - 'mail'</span>
<a href="#l55.123"></a><span id="l55.123">  *  - 'calendar'</span>
<a href="#l55.124"></a><span id="l55.124">  *  - 'task'</span>
<a href="#l55.125"></a><span id="l55.125">  */</span>
<a href="#l55.126"></a><span id="l55.126" class="difflineminus">-var gCurrentMode = 'mail';</span>
<a href="#l55.127"></a><span id="l55.127" class="difflineplus">+var gCurrentMode = &quot;mail&quot;;</span>
<a href="#l55.128"></a><span id="l55.128"> </span>
<a href="#l55.129"></a><span id="l55.129"> /**</span>
<a href="#l55.130"></a><span id="l55.130">  * ltnSwitch2Mail() switches to the mail mode</span>
<a href="#l55.131"></a><span id="l55.131">  */</span>
<a href="#l55.132"></a><span id="l55.132"> </span>
<a href="#l55.133"></a><span id="l55.133"> function ltnSwitch2Mail() {</span>
<a href="#l55.134"></a><span id="l55.134" class="difflineminus">-  if (gCurrentMode != 'mail') {</span>
<a href="#l55.135"></a><span id="l55.135" class="difflineminus">-    gCurrentMode = 'mail';</span>
<a href="#l55.136"></a><span id="l55.136" class="difflineplus">+  if (gCurrentMode != &quot;mail&quot;) {</span>
<a href="#l55.137"></a><span id="l55.137" class="difflineplus">+    gCurrentMode = &quot;mail&quot;;</span>
<a href="#l55.138"></a><span id="l55.138">     document.getElementById(&quot;modeBroadcaster&quot;).setAttribute(&quot;mode&quot;, gCurrentMode);</span>
<a href="#l55.139"></a><span id="l55.139"> </span>
<a href="#l55.140"></a><span id="l55.140" class="difflineminus">-    document.commandDispatcher.updateCommands('calendar_commands');</span>
<a href="#l55.141"></a><span id="l55.141" class="difflineplus">+    document.commandDispatcher.updateCommands(&quot;calendar_commands&quot;);</span>
<a href="#l55.142"></a><span id="l55.142">     window.setCursor(&quot;auto&quot;);</span>
<a href="#l55.143"></a><span id="l55.143">   }</span>
<a href="#l55.144"></a><span id="l55.144"> }</span>
<a href="#l55.145"></a><span id="l55.145"> </span>
<a href="#l55.146"></a><span id="l55.146"> /**</span>
<a href="#l55.147"></a><span id="l55.147">  * ltnSwitch2Calendar() switches to the calendar mode</span>
<a href="#l55.148"></a><span id="l55.148">  */</span>
<a href="#l55.149"></a><span id="l55.149"> </span>
<a href="#l55.150"></a><span id="l55.150"> function ltnSwitch2Calendar() {</span>
<a href="#l55.151"></a><span id="l55.151" class="difflineminus">-  if (gCurrentMode != 'calendar') {</span>
<a href="#l55.152"></a><span id="l55.152" class="difflineminus">-    gCurrentMode = 'calendar';</span>
<a href="#l55.153"></a><span id="l55.153" class="difflineplus">+  if (gCurrentMode != &quot;calendar&quot;) {</span>
<a href="#l55.154"></a><span id="l55.154" class="difflineplus">+    gCurrentMode = &quot;calendar&quot;;</span>
<a href="#l55.155"></a><span id="l55.155">     document.getElementById(&quot;modeBroadcaster&quot;).setAttribute(&quot;mode&quot;, gCurrentMode);</span>
<a href="#l55.156"></a><span id="l55.156"> </span>
<a href="#l55.157"></a><span id="l55.157">     // display the calendar panel on the display deck</span>
<a href="#l55.158"></a><span id="l55.158">     let deck = document.getElementById(&quot;calendarDisplayDeck&quot;);</span>
<a href="#l55.159"></a><span id="l55.159">     deck.selectedPanel = document.getElementById(&quot;calendar-view-box&quot;);</span>
<a href="#l55.160"></a><span id="l55.160"> </span>
<a href="#l55.161"></a><span id="l55.161">     // show the last displayed type of calendar view</span>
<a href="#l55.162"></a><span id="l55.162">     switchToView(gLastShownCalendarView);</span>
<a href="#l55.163"></a><span id="l55.163"> </span>
<a href="#l55.164"></a><span id="l55.164" class="difflineminus">-    document.commandDispatcher.updateCommands('calendar_commands');</span>
<a href="#l55.165"></a><span id="l55.165" class="difflineplus">+    document.commandDispatcher.updateCommands(&quot;calendar_commands&quot;);</span>
<a href="#l55.166"></a><span id="l55.166">     window.setCursor(&quot;auto&quot;);</span>
<a href="#l55.167"></a><span id="l55.167"> </span>
<a href="#l55.168"></a><span id="l55.168">     // make sure the view is sized correctly</span>
<a href="#l55.169"></a><span id="l55.169">     onCalendarViewResize();</span>
<a href="#l55.170"></a><span id="l55.170">   }</span>
<a href="#l55.171"></a><span id="l55.171"> }</span>
<a href="#l55.172"></a><span id="l55.172"> </span>
<a href="#l55.173"></a><span id="l55.173"> /**</span>
<a href="#l55.174"></a><span id="l55.174">  * ltnSwitch2Task() switches to the task mode</span>
<a href="#l55.175"></a><span id="l55.175">  */</span>
<a href="#l55.176"></a><span id="l55.176"> </span>
<a href="#l55.177"></a><span id="l55.177"> function ltnSwitch2Task() {</span>
<a href="#l55.178"></a><span id="l55.178" class="difflineminus">-  if (gCurrentMode != 'task') {</span>
<a href="#l55.179"></a><span id="l55.179" class="difflineminus">-    gCurrentMode = 'task';</span>
<a href="#l55.180"></a><span id="l55.180" class="difflineplus">+  if (gCurrentMode != &quot;task&quot;) {</span>
<a href="#l55.181"></a><span id="l55.181" class="difflineplus">+    gCurrentMode = &quot;task&quot;;</span>
<a href="#l55.182"></a><span id="l55.182">     document.getElementById(&quot;modeBroadcaster&quot;).setAttribute(&quot;mode&quot;, gCurrentMode);</span>
<a href="#l55.183"></a><span id="l55.183"> </span>
<a href="#l55.184"></a><span id="l55.184">     // display the task panel on the display deck</span>
<a href="#l55.185"></a><span id="l55.185">     let deck = document.getElementById(&quot;calendarDisplayDeck&quot;);</span>
<a href="#l55.186"></a><span id="l55.186">     deck.selectedPanel = document.getElementById(&quot;calendar-task-box&quot;);</span>
<a href="#l55.187"></a><span id="l55.187"> </span>
<a href="#l55.188"></a><span id="l55.188" class="difflineminus">-    document.commandDispatcher.updateCommands('calendar_commands');</span>
<a href="#l55.189"></a><span id="l55.189" class="difflineplus">+    document.commandDispatcher.updateCommands(&quot;calendar_commands&quot;);</span>
<a href="#l55.190"></a><span id="l55.190">     window.setCursor(&quot;auto&quot;);</span>
<a href="#l55.191"></a><span id="l55.191">   }</span>
<a href="#l55.192"></a><span id="l55.192"> }</span>
<a href="#l55.193"></a><span id="l55.193"> </span>
<a href="#l55.194"></a><span id="l55.194"> var gCalSetupMailContext = {</span>
<a href="#l55.195"></a><span id="l55.195">     popup: function gCalSetupMailContext_popup() {</span>
<a href="#l55.196"></a><span id="l55.196">         let hasSelection = (gFolderDisplay.selectedMessage != null);</span>
<a href="#l55.197"></a><span id="l55.197">         // Disable the convert menu altogether.</span>
<a href="#l55.198"></a><span id="l55.198" class="difflineat">@@ -792,17 +792,17 @@ var gCalSetupMailContext = {</span>
<a href="#l55.199"></a><span id="l55.199"> };</span>
<a href="#l55.200"></a><span id="l55.200"> </span>
<a href="#l55.201"></a><span id="l55.201"> // Overwrite the InitMessageMenu function, since we never know in which order</span>
<a href="#l55.202"></a><span id="l55.202"> // the popupshowing event will be processed. This function takes care of</span>
<a href="#l55.203"></a><span id="l55.203"> // disabling the message menu when in calendar or task mode.</span>
<a href="#l55.204"></a><span id="l55.204"> function calInitMessageMenu() {</span>
<a href="#l55.205"></a><span id="l55.205">     calInitMessageMenu.origFunc();</span>
<a href="#l55.206"></a><span id="l55.206"> </span>
<a href="#l55.207"></a><span id="l55.207" class="difflineminus">-    document.getElementById(&quot;markMenu&quot;).disabled = (gCurrentMode != 'mail');</span>
<a href="#l55.208"></a><span id="l55.208" class="difflineplus">+    document.getElementById(&quot;markMenu&quot;).disabled = (gCurrentMode != &quot;mail&quot;);</span>
<a href="#l55.209"></a><span id="l55.209"> }</span>
<a href="#l55.210"></a><span id="l55.210"> calInitMessageMenu.origFunc = InitMessageMenu;</span>
<a href="#l55.211"></a><span id="l55.211"> InitMessageMenu = calInitMessageMenu;</span>
<a href="#l55.212"></a><span id="l55.212"> </span>
<a href="#l55.213"></a><span id="l55.213"> window.addEventListener(&quot;load&quot;, ltnOnLoad, false);</span>
<a href="#l55.214"></a><span id="l55.214"> </span>
<a href="#l55.215"></a><span id="l55.215"> /**</span>
<a href="#l55.216"></a><span id="l55.216">  * Get the toolbox id for the current tab type.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -271,136 +271,136 @@ ltn.invitation = {</span>
<a href="#l56.4"></a><span id="l56.4">     compareInvitationOverlay: function(aOldDoc, aNewDoc, aIgnoreId) {</span>
<a href="#l56.5"></a><span id="l56.5">         /**</span>
<a href="#l56.6"></a><span id="l56.6">          * Transforms text node content to formated child nodes. Decorations are defined in imip.css</span>
<a href="#l56.7"></a><span id="l56.7">          * @param {Node}    aToNode text node to change</span>
<a href="#l56.8"></a><span id="l56.8">          * @param {String}  aType   use 'newline' for the same, 'added' or 'removed' for decoration</span>
<a href="#l56.9"></a><span id="l56.9">          * @param {String}  aText   [optional]</span>
<a href="#l56.10"></a><span id="l56.10">          * @param {Boolean} aClear  [optional] for consecutive changes on the same node, set to false</span>
<a href="#l56.11"></a><span id="l56.11">          */</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-        function _content2Child(aToNode, aType, aText = '', aClear = true) {</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineplus">+        function _content2Child(aToNode, aType, aText = &quot;&quot;, aClear = true) {</span>
<a href="#l56.14"></a><span id="l56.14">             let nodeDoc = aToNode.ownerDocument;</span>
<a href="#l56.15"></a><span id="l56.15">             if (aClear &amp;&amp; aToNode.hasChildNodes()) {</span>
<a href="#l56.16"></a><span id="l56.16">                 aToNode.removeChild(aToNode.firstChild);</span>
<a href="#l56.17"></a><span id="l56.17">             }</span>
<a href="#l56.18"></a><span id="l56.18" class="difflineminus">-            let n = nodeDoc.createElement(aType.toLowerCase() == 'newline' ? 'br' : 'span');</span>
<a href="#l56.19"></a><span id="l56.19" class="difflineplus">+            let n = nodeDoc.createElement(aType.toLowerCase() == &quot;newline&quot; ? &quot;br&quot; : &quot;span&quot;);</span>
<a href="#l56.20"></a><span id="l56.20">             switch (aType) {</span>
<a href="#l56.21"></a><span id="l56.21" class="difflineminus">-                case 'added':</span>
<a href="#l56.22"></a><span id="l56.22" class="difflineminus">-                case 'modified':</span>
<a href="#l56.23"></a><span id="l56.23" class="difflineminus">-                case 'removed':</span>
<a href="#l56.24"></a><span id="l56.24" class="difflineplus">+                case &quot;added&quot;:</span>
<a href="#l56.25"></a><span id="l56.25" class="difflineplus">+                case &quot;modified&quot;:</span>
<a href="#l56.26"></a><span id="l56.26" class="difflineplus">+                case &quot;removed&quot;:</span>
<a href="#l56.27"></a><span id="l56.27">                     n.className = aType;</span>
<a href="#l56.28"></a><span id="l56.28" class="difflineminus">-                    if (Preferences.get('calendar.view.useSystemColors', false)) {</span>
<a href="#l56.29"></a><span id="l56.29" class="difflineminus">-                        n.setAttribute('systemcolors', true);</span>
<a href="#l56.30"></a><span id="l56.30" class="difflineplus">+                    if (Preferences.get(&quot;calendar.view.useSystemColors&quot;, false)) {</span>
<a href="#l56.31"></a><span id="l56.31" class="difflineplus">+                        n.setAttribute(&quot;systemcolors&quot;, true);</span>
<a href="#l56.32"></a><span id="l56.32">                     }</span>
<a href="#l56.33"></a><span id="l56.33">                     break;</span>
<a href="#l56.34"></a><span id="l56.34">             }</span>
<a href="#l56.35"></a><span id="l56.35">             n.textContent = aText;</span>
<a href="#l56.36"></a><span id="l56.36">             aToNode.appendChild(n);</span>
<a href="#l56.37"></a><span id="l56.37">         }</span>
<a href="#l56.38"></a><span id="l56.38">         /**</span>
<a href="#l56.39"></a><span id="l56.39">          * Extracts attendees from the given document</span>
<a href="#l56.40"></a><span id="l56.40">          * @param   {Node}   aDoc      document to search in</span>
<a href="#l56.41"></a><span id="l56.41">          * @param   {String} aElement  element name as used in _compareElement()</span>
<a href="#l56.42"></a><span id="l56.42">          * @returns {Array}            attendee nodes</span>
<a href="#l56.43"></a><span id="l56.43">          */</span>
<a href="#l56.44"></a><span id="l56.44">         function _getAttendees(aDoc, aElement) {</span>
<a href="#l56.45"></a><span id="l56.45">             let attendees = [];</span>
<a href="#l56.46"></a><span id="l56.46" class="difflineminus">-            for (let att of aDoc.getElementsByClassName('attendee-name')) {</span>
<a href="#l56.47"></a><span id="l56.47" class="difflineplus">+            for (let att of aDoc.getElementsByClassName(&quot;attendee-name&quot;)) {</span>
<a href="#l56.48"></a><span id="l56.48">                 if (!att.parentNode.hidden &amp;&amp;</span>
<a href="#l56.49"></a><span id="l56.49" class="difflineminus">-                    att.parentNode.parentNode.id == (aElement + '-table')) {</span>
<a href="#l56.50"></a><span id="l56.50" class="difflineplus">+                    att.parentNode.parentNode.id == (aElement + &quot;-table&quot;)) {</span>
<a href="#l56.51"></a><span id="l56.51">                     attendees[att.textContent] = att;</span>
<a href="#l56.52"></a><span id="l56.52">                 }</span>
<a href="#l56.53"></a><span id="l56.53">             }</span>
<a href="#l56.54"></a><span id="l56.54">             return attendees;</span>
<a href="#l56.55"></a><span id="l56.55">         }</span>
<a href="#l56.56"></a><span id="l56.56">         /**</span>
<a href="#l56.57"></a><span id="l56.57">          * Compares both documents for elements related to the given name</span>
<a href="#l56.58"></a><span id="l56.58">          * @param {String} aElement  part of the element id within the html template</span>
<a href="#l56.59"></a><span id="l56.59">          */</span>
<a href="#l56.60"></a><span id="l56.60">         function _compareElement(aElement) {</span>
<a href="#l56.61"></a><span id="l56.61" class="difflineminus">-            let element = aElement == 'attendee' ? aElement + 's' : aElement;</span>
<a href="#l56.62"></a><span id="l56.62" class="difflineminus">-            let oldRow = aOldDoc.getElementById('imipHtml-' + element + '-row');</span>
<a href="#l56.63"></a><span id="l56.63" class="difflineminus">-            let newRow = aNewDoc.getElementById('imipHtml-' + element + '-row');</span>
<a href="#l56.64"></a><span id="l56.64" class="difflineminus">-            let row = doc.getElementById('imipHtml-' + element + '-row');</span>
<a href="#l56.65"></a><span id="l56.65" class="difflineminus">-            let oldContent = aOldDoc.getElementById('imipHtml-' + aElement + '-content');</span>
<a href="#l56.66"></a><span id="l56.66" class="difflineminus">-            let content = doc.getElementById('imipHtml-' + aElement + '-content');</span>
<a href="#l56.67"></a><span id="l56.67" class="difflineplus">+            let element = aElement == &quot;attendee&quot; ? aElement + &quot;s&quot; : aElement;</span>
<a href="#l56.68"></a><span id="l56.68" class="difflineplus">+            let oldRow = aOldDoc.getElementById(&quot;imipHtml-&quot; + element + &quot;-row&quot;);</span>
<a href="#l56.69"></a><span id="l56.69" class="difflineplus">+            let newRow = aNewDoc.getElementById(&quot;imipHtml-&quot; + element + &quot;-row&quot;);</span>
<a href="#l56.70"></a><span id="l56.70" class="difflineplus">+            let row = doc.getElementById(&quot;imipHtml-&quot; + element + &quot;-row&quot;);</span>
<a href="#l56.71"></a><span id="l56.71" class="difflineplus">+            let oldContent = aOldDoc.getElementById(&quot;imipHtml-&quot; + aElement + &quot;-content&quot;);</span>
<a href="#l56.72"></a><span id="l56.72" class="difflineplus">+            let content = doc.getElementById(&quot;imipHtml-&quot; + aElement + &quot;-content&quot;);</span>
<a href="#l56.73"></a><span id="l56.73"> </span>
<a href="#l56.74"></a><span id="l56.74">             if (newRow.hidden &amp;&amp; !oldRow.hidden) {</span>
<a href="#l56.75"></a><span id="l56.75">                 // element was removed</span>
<a href="#l56.76"></a><span id="l56.76">                 // we only need to check for simple elements here: attendee or organizer row</span>
<a href="#l56.77"></a><span id="l56.77">                 // cannot be removed</span>
<a href="#l56.78"></a><span id="l56.78">                 if (oldContent) {</span>
<a href="#l56.79"></a><span id="l56.79" class="difflineminus">-                    _content2Child(content, 'removed', oldContent.textContent);</span>
<a href="#l56.80"></a><span id="l56.80" class="difflineplus">+                    _content2Child(content, &quot;removed&quot;, oldContent.textContent);</span>
<a href="#l56.81"></a><span id="l56.81">                     row.hidden = false;</span>
<a href="#l56.82"></a><span id="l56.82">                 }</span>
<a href="#l56.83"></a><span id="l56.83">             } else if (!newRow.hidden &amp;&amp; oldRow.hidden) {</span>
<a href="#l56.84"></a><span id="l56.84">                 // the element was added</span>
<a href="#l56.85"></a><span id="l56.85">                 // we only need to check for simple elements here: attendee or organizer row</span>
<a href="#l56.86"></a><span id="l56.86">                 // must have been there before</span>
<a href="#l56.87"></a><span id="l56.87">                 if (content) {</span>
<a href="#l56.88"></a><span id="l56.88" class="difflineminus">-                    _content2Child(content, 'added', content.textContent);</span>
<a href="#l56.89"></a><span id="l56.89" class="difflineplus">+                    _content2Child(content, &quot;added&quot;, content.textContent);</span>
<a href="#l56.90"></a><span id="l56.90">                 }</span>
<a href="#l56.91"></a><span id="l56.91">             } else if (!newRow.hidden &amp;&amp; !oldRow.hidden) {</span>
<a href="#l56.92"></a><span id="l56.92">                 // the element may have been modified</span>
<a href="#l56.93"></a><span id="l56.93">                 if (content) {</span>
<a href="#l56.94"></a><span id="l56.94">                     if (content.textContent != oldContent.textContent) {</span>
<a href="#l56.95"></a><span id="l56.95" class="difflineminus">-                        _content2Child(content, 'added', content.textContent);</span>
<a href="#l56.96"></a><span id="l56.96" class="difflineminus">-                        _content2Child(content, 'newline', null, false);</span>
<a href="#l56.97"></a><span id="l56.97" class="difflineminus">-                        _content2Child(content, 'removed', oldContent.textContent, false);</span>
<a href="#l56.98"></a><span id="l56.98" class="difflineplus">+                        _content2Child(content, &quot;added&quot;, content.textContent);</span>
<a href="#l56.99"></a><span id="l56.99" class="difflineplus">+                        _content2Child(content, &quot;newline&quot;, null, false);</span>
<a href="#l56.100"></a><span id="l56.100" class="difflineplus">+                        _content2Child(content, &quot;removed&quot;, oldContent.textContent, false);</span>
<a href="#l56.101"></a><span id="l56.101">                     }</span>
<a href="#l56.102"></a><span id="l56.102">                 } else {</span>
<a href="#l56.103"></a><span id="l56.103" class="difflineminus">-                    content = doc.getElementById(aElement + '-table');</span>
<a href="#l56.104"></a><span id="l56.104" class="difflineminus">-                    oldContent = aOldDoc.getElementById(aElement + '-table');</span>
<a href="#l56.105"></a><span id="l56.105" class="difflineplus">+                    content = doc.getElementById(aElement + &quot;-table&quot;);</span>
<a href="#l56.106"></a><span id="l56.106" class="difflineplus">+                    oldContent = aOldDoc.getElementById(aElement + &quot;-table&quot;);</span>
<a href="#l56.107"></a><span id="l56.107">                     let excludeAddress = cal.removeMailTo(aIgnoreId);</span>
<a href="#l56.108"></a><span id="l56.108">                     if (content &amp;&amp; oldContent &amp;&amp; !content.isEqualNode(oldContent)) {</span>
<a href="#l56.109"></a><span id="l56.109">                         // extract attendees</span>
<a href="#l56.110"></a><span id="l56.110">                         let attendees = _getAttendees(doc, aElement);</span>
<a href="#l56.111"></a><span id="l56.111">                         let oldAttendees = _getAttendees(aOldDoc, aElement);</span>
<a href="#l56.112"></a><span id="l56.112">                         // decorate newly added attendees</span>
<a href="#l56.113"></a><span id="l56.113">                         for (let att of Object.keys(attendees)) {</span>
<a href="#l56.114"></a><span id="l56.114">                             if (!(att in oldAttendees)) {</span>
<a href="#l56.115"></a><span id="l56.115" class="difflineminus">-                                _content2Child(attendees[att], 'added', att);</span>
<a href="#l56.116"></a><span id="l56.116" class="difflineplus">+                                _content2Child(attendees[att], &quot;added&quot;, att);</span>
<a href="#l56.117"></a><span id="l56.117">                             }</span>
<a href="#l56.118"></a><span id="l56.118">                         }</span>
<a href="#l56.119"></a><span id="l56.119">                         for (let att of Object.keys(oldAttendees)) {</span>
<a href="#l56.120"></a><span id="l56.120">                             // if att is the user his/herself, who accepted an invitation he/she was</span>
<a href="#l56.121"></a><span id="l56.121">                             // not invited to, we exclude him/her from decoration</span>
<a href="#l56.122"></a><span id="l56.122">                             let notExcluded = excludeAddress == &quot;&quot; ||</span>
<a href="#l56.123"></a><span id="l56.123">                                                !att.includes(excludeAddress);</span>
<a href="#l56.124"></a><span id="l56.124">                             // decorate removed attendees</span>
<a href="#l56.125"></a><span id="l56.125">                             if (!(att in attendees) &amp;&amp; notExcluded) {</span>
<a href="#l56.126"></a><span id="l56.126" class="difflineminus">-                                _content2Child(oldAttendees[att], 'removed', att);</span>
<a href="#l56.127"></a><span id="l56.127" class="difflineplus">+                                _content2Child(oldAttendees[att], &quot;removed&quot;, att);</span>
<a href="#l56.128"></a><span id="l56.128">                                 content.appendChild(oldAttendees[att].parentNode.cloneNode(true));</span>
<a href="#l56.129"></a><span id="l56.129">                             } else if ((att in attendees) &amp;&amp; notExcluded) {</span>
<a href="#l56.130"></a><span id="l56.130">                                 // highlight partstat, role or usertype changes</span>
<a href="#l56.131"></a><span id="l56.131">                                 let oldAtts = oldAttendees[att].parentNode</span>
<a href="#l56.132"></a><span id="l56.132">                                                                .getElementsByClassName(&quot;itip-icon&quot;)[0]</span>
<a href="#l56.133"></a><span id="l56.133">                                                                .attributes;</span>
<a href="#l56.134"></a><span id="l56.134">                                 let newAtts = attendees[att].parentNode</span>
<a href="#l56.135"></a><span id="l56.135">                                                             .getElementsByClassName(&quot;itip-icon&quot;)[0]</span>
<a href="#l56.136"></a><span id="l56.136">                                                             .attributes;</span>
<a href="#l56.137"></a><span id="l56.137">                                 let hasChanged = function(name) {</span>
<a href="#l56.138"></a><span id="l56.138">                                     return oldAtts.getNamedItem(name).value !=</span>
<a href="#l56.139"></a><span id="l56.139">                                            newAtts.getNamedItem(name).value;</span>
<a href="#l56.140"></a><span id="l56.140">                                 };</span>
<a href="#l56.141"></a><span id="l56.141">                                 if ([&quot;role&quot;, &quot;partstat&quot;, &quot;usertype&quot;].some(hasChanged)) {</span>
<a href="#l56.142"></a><span id="l56.142" class="difflineminus">-                                    _content2Child(attendees[att], 'modified', att);</span>
<a href="#l56.143"></a><span id="l56.143" class="difflineplus">+                                    _content2Child(attendees[att], &quot;modified&quot;, att);</span>
<a href="#l56.144"></a><span id="l56.144">                                 }</span>
<a href="#l56.145"></a><span id="l56.145">                             }</span>
<a href="#l56.146"></a><span id="l56.146">                         }</span>
<a href="#l56.147"></a><span id="l56.147">                     }</span>
<a href="#l56.148"></a><span id="l56.148">                 }</span>
<a href="#l56.149"></a><span id="l56.149">             }</span>
<a href="#l56.150"></a><span id="l56.150">         }</span>
<a href="#l56.151"></a><span id="l56.151">         aOldDoc = cal.xml.parseString(aOldDoc);</span>
<a href="#l56.152"></a><span id="l56.152">         aNewDoc = cal.xml.parseString(aNewDoc);</span>
<a href="#l56.153"></a><span id="l56.153">         let doc = aNewDoc.cloneNode(true);</span>
<a href="#l56.154"></a><span id="l56.154">         // elements to consider for comparison</span>
<a href="#l56.155"></a><span id="l56.155" class="difflineminus">-        ['summary', 'location', 'when', 'canceledOccurrences',</span>
<a href="#l56.156"></a><span id="l56.156" class="difflineminus">-         'modifiedOccurrences', 'organizer', 'attendee'].forEach(_compareElement);</span>
<a href="#l56.157"></a><span id="l56.157" class="difflineplus">+        [&quot;summary&quot;, &quot;location&quot;, &quot;when&quot;, &quot;canceledOccurrences&quot;,</span>
<a href="#l56.158"></a><span id="l56.158" class="difflineplus">+         &quot;modifiedOccurrences&quot;, &quot;organizer&quot;, &quot;attendee&quot;].forEach(_compareElement);</span>
<a href="#l56.159"></a><span id="l56.159">         return cal.xml.serializeDOM(doc);</span>
<a href="#l56.160"></a><span id="l56.160">     },</span>
<a href="#l56.161"></a><span id="l56.161"> </span>
<a href="#l56.162"></a><span id="l56.162">     /**</span>
<a href="#l56.163"></a><span id="l56.163">      * Returns the header section for an invitation email.</span>
<a href="#l56.164"></a><span id="l56.164">      * @param   {String}         aMessageId  the message id to use for that email</span>
<a href="#l56.165"></a><span id="l56.165">      * @param   {nsIMsgIdentity} aIdentity   the identity to use for that email</span>
<a href="#l56.166"></a><span id="l56.166">      * @returns {String}                     the source code of the header section of the email</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -427,38 +427,38 @@ calDavCalendar.prototype = {</span>
<a href="#l57.4"></a><span id="l57.4">     set uri(aUri) {</span>
<a href="#l57.5"></a><span id="l57.5">         this.mUri = aUri;</span>
<a href="#l57.6"></a><span id="l57.6"> </span>
<a href="#l57.7"></a><span id="l57.7">         return aUri;</span>
<a href="#l57.8"></a><span id="l57.8">     },</span>
<a href="#l57.9"></a><span id="l57.9"> </span>
<a href="#l57.10"></a><span id="l57.10">     get calendarUri() {</span>
<a href="#l57.11"></a><span id="l57.11">         let calUri = this.mUri.clone();</span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-        let parts = calUri.spec.split('?');</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineplus">+        let parts = calUri.spec.split(&quot;?&quot;);</span>
<a href="#l57.14"></a><span id="l57.14">         if (parts.length &gt; 1) {</span>
<a href="#l57.15"></a><span id="l57.15">             calUri.spec = parts.shift();</span>
<a href="#l57.16"></a><span id="l57.16" class="difflineminus">-            this.mUriParams = '?' + parts.join('?');</span>
<a href="#l57.17"></a><span id="l57.17" class="difflineplus">+            this.mUriParams = &quot;?&quot; + parts.join(&quot;?&quot;);</span>
<a href="#l57.18"></a><span id="l57.18">         }</span>
<a href="#l57.19"></a><span id="l57.19" class="difflineminus">-        if (calUri.spec.charAt(calUri.spec.length - 1) != '/') {</span>
<a href="#l57.20"></a><span id="l57.20" class="difflineplus">+        if (calUri.spec.charAt(calUri.spec.length - 1) != &quot;/&quot;) {</span>
<a href="#l57.21"></a><span id="l57.21">             calUri.spec += &quot;/&quot;;</span>
<a href="#l57.22"></a><span id="l57.22">         }</span>
<a href="#l57.23"></a><span id="l57.23">         return calUri;</span>
<a href="#l57.24"></a><span id="l57.24">     },</span>
<a href="#l57.25"></a><span id="l57.25"> </span>
<a href="#l57.26"></a><span id="l57.26">     setCalHomeSet: function caldav_setCalHomeSet(removeLastPathSegment) {</span>
<a href="#l57.27"></a><span id="l57.27">         if (removeLastPathSegment) {</span>
<a href="#l57.28"></a><span id="l57.28">             let calUri = this.mUri.clone();</span>
<a href="#l57.29"></a><span id="l57.29" class="difflineminus">-            let split1 = calUri.spec.split('?');</span>
<a href="#l57.30"></a><span id="l57.30" class="difflineplus">+            let split1 = calUri.spec.split(&quot;?&quot;);</span>
<a href="#l57.31"></a><span id="l57.31">             let baseUrl = split1[0];</span>
<a href="#l57.32"></a><span id="l57.32" class="difflineminus">-            if (baseUrl.charAt(baseUrl.length - 1) == '/') {</span>
<a href="#l57.33"></a><span id="l57.33" class="difflineplus">+            if (baseUrl.charAt(baseUrl.length - 1) == &quot;/&quot;) {</span>
<a href="#l57.34"></a><span id="l57.34">                 baseUrl = baseUrl.substring(0, baseUrl.length - 2);</span>
<a href="#l57.35"></a><span id="l57.35">             }</span>
<a href="#l57.36"></a><span id="l57.36" class="difflineminus">-            let split2 = baseUrl.split('/');</span>
<a href="#l57.37"></a><span id="l57.37" class="difflineplus">+            let split2 = baseUrl.split(&quot;/&quot;);</span>
<a href="#l57.38"></a><span id="l57.38">             split2.pop();</span>
<a href="#l57.39"></a><span id="l57.39" class="difflineminus">-            calUri.spec = split2.join('/') + '/';</span>
<a href="#l57.40"></a><span id="l57.40" class="difflineplus">+            calUri.spec = split2.join(&quot;/&quot;) + &quot;/&quot;;</span>
<a href="#l57.41"></a><span id="l57.41">             this.mCalHomeSet = calUri;</span>
<a href="#l57.42"></a><span id="l57.42">         } else {</span>
<a href="#l57.43"></a><span id="l57.43">             this.mCalHomeSet = this.calendarUri;</span>
<a href="#l57.44"></a><span id="l57.44">         }</span>
<a href="#l57.45"></a><span id="l57.45">     },</span>
<a href="#l57.46"></a><span id="l57.46"> </span>
<a href="#l57.47"></a><span id="l57.47">     mOutboxUrl:  null,</span>
<a href="#l57.48"></a><span id="l57.48">     get outboxUrl() {</span>
<a href="#l57.49"></a><span id="l57.49" class="difflineat">@@ -1378,20 +1378,20 @@ calDavCalendar.prototype = {</span>
<a href="#l57.50"></a><span id="l57.50">         if (!this.mCtag || !this.mFirstRefreshDone || this.mHasWebdavSyncSupport) {</span>
<a href="#l57.51"></a><span id="l57.51">             this.getUpdatedItems(this.calendarUri, aChangeLogListener);</span>
<a href="#l57.52"></a><span id="l57.52">             return;</span>
<a href="#l57.53"></a><span id="l57.53">         }</span>
<a href="#l57.54"></a><span id="l57.54">         let thisCalendar = this;</span>
<a href="#l57.55"></a><span id="l57.55">         let queryXml =</span>
<a href="#l57.56"></a><span id="l57.56">             xmlHeader +</span>
<a href="#l57.57"></a><span id="l57.57">             '&lt;D:propfind xmlns:D=&quot;DAV:&quot; xmlns:CS=&quot;http://calendarserver.org/ns/&quot;&gt;' +</span>
<a href="#l57.58"></a><span id="l57.58" class="difflineminus">-              '&lt;D:prop&gt;' +</span>
<a href="#l57.59"></a><span id="l57.59" class="difflineminus">-                '&lt;CS:getctag/&gt;' +</span>
<a href="#l57.60"></a><span id="l57.60" class="difflineminus">-              '&lt;/D:prop&gt;' +</span>
<a href="#l57.61"></a><span id="l57.61" class="difflineminus">-            '&lt;/D:propfind&gt;';</span>
<a href="#l57.62"></a><span id="l57.62" class="difflineplus">+              &quot;&lt;D:prop&gt;&quot; +</span>
<a href="#l57.63"></a><span id="l57.63" class="difflineplus">+                &quot;&lt;CS:getctag/&gt;&quot; +</span>
<a href="#l57.64"></a><span id="l57.64" class="difflineplus">+              &quot;&lt;/D:prop&gt;&quot; +</span>
<a href="#l57.65"></a><span id="l57.65" class="difflineplus">+            &quot;&lt;/D:propfind&gt;&quot;;</span>
<a href="#l57.66"></a><span id="l57.66"> </span>
<a href="#l57.67"></a><span id="l57.67">         if (this.verboseLogging()) {</span>
<a href="#l57.68"></a><span id="l57.68">             cal.LOG(&quot;CalDAV: send(&quot; + this.makeUri().spec + &quot;): &quot; + queryXml);</span>
<a href="#l57.69"></a><span id="l57.69">         }</span>
<a href="#l57.70"></a><span id="l57.70"> </span>
<a href="#l57.71"></a><span id="l57.71">         let streamListener = {};</span>
<a href="#l57.72"></a><span id="l57.72">         streamListener.onStreamComplete =</span>
<a href="#l57.73"></a><span id="l57.73">             function safeRefresh_safeRefresh_onStreamComplete(aLoader, aContext, aStatus, aResultLength, aResult) {</span>
<a href="#l57.74"></a><span id="l57.74" class="difflineat">@@ -1519,22 +1519,22 @@ calDavCalendar.prototype = {</span>
<a href="#l57.75"></a><span id="l57.75">             webDavSync = new webDavSyncHandler(this, aUri, aChangeLogListener);</span>
<a href="#l57.76"></a><span id="l57.76">             webDavSync.doWebDAVSync();</span>
<a href="#l57.77"></a><span id="l57.77">             return;</span>
<a href="#l57.78"></a><span id="l57.78">         }</span>
<a href="#l57.79"></a><span id="l57.79"> </span>
<a href="#l57.80"></a><span id="l57.80">         let queryXml =</span>
<a href="#l57.81"></a><span id="l57.81">             xmlHeader +</span>
<a href="#l57.82"></a><span id="l57.82">             '&lt;D:propfind xmlns:D=&quot;DAV:&quot;&gt;' +</span>
<a href="#l57.83"></a><span id="l57.83" class="difflineminus">-              '&lt;D:prop&gt;' +</span>
<a href="#l57.84"></a><span id="l57.84" class="difflineminus">-                '&lt;D:getcontenttype/&gt;' +</span>
<a href="#l57.85"></a><span id="l57.85" class="difflineminus">-                '&lt;D:resourcetype/&gt;' +</span>
<a href="#l57.86"></a><span id="l57.86" class="difflineminus">-                '&lt;D:getetag/&gt;' +</span>
<a href="#l57.87"></a><span id="l57.87" class="difflineminus">-              '&lt;/D:prop&gt;' +</span>
<a href="#l57.88"></a><span id="l57.88" class="difflineminus">-            '&lt;/D:propfind&gt;';</span>
<a href="#l57.89"></a><span id="l57.89" class="difflineplus">+              &quot;&lt;D:prop&gt;&quot; +</span>
<a href="#l57.90"></a><span id="l57.90" class="difflineplus">+                &quot;&lt;D:getcontenttype/&gt;&quot; +</span>
<a href="#l57.91"></a><span id="l57.91" class="difflineplus">+                &quot;&lt;D:resourcetype/&gt;&quot; +</span>
<a href="#l57.92"></a><span id="l57.92" class="difflineplus">+                &quot;&lt;D:getetag/&gt;&quot; +</span>
<a href="#l57.93"></a><span id="l57.93" class="difflineplus">+              &quot;&lt;/D:prop&gt;&quot; +</span>
<a href="#l57.94"></a><span id="l57.94" class="difflineplus">+            &quot;&lt;/D:propfind&gt;&quot;;</span>
<a href="#l57.95"></a><span id="l57.95"> </span>
<a href="#l57.96"></a><span id="l57.96">         let requestUri = this.makeUri(null, aUri);</span>
<a href="#l57.97"></a><span id="l57.97">         if (this.verboseLogging()) {</span>
<a href="#l57.98"></a><span id="l57.98">             cal.LOG(&quot;CalDAV: send(&quot; + requestUri.spec + &quot;): &quot; + queryXml);</span>
<a href="#l57.99"></a><span id="l57.99">         }</span>
<a href="#l57.100"></a><span id="l57.100"> </span>
<a href="#l57.101"></a><span id="l57.101">         this.sendHttpRequest(requestUri, queryXml, MIME_TEXT_XML, null, (channel) =&gt; {</span>
<a href="#l57.102"></a><span id="l57.102">             channel.requestMethod = &quot;PROPFIND&quot;;</span>
<a href="#l57.103"></a><span id="l57.103" class="difflineat">@@ -1683,25 +1683,25 @@ calDavCalendar.prototype = {</span>
<a href="#l57.104"></a><span id="l57.104">         this.ensureTargetCalendar();</span>
<a href="#l57.105"></a><span id="l57.105"> </span>
<a href="#l57.106"></a><span id="l57.106">         let resourceType = kDavResourceTypeNone;</span>
<a href="#l57.107"></a><span id="l57.107">         let thisCalendar = this;</span>
<a href="#l57.108"></a><span id="l57.108"> </span>
<a href="#l57.109"></a><span id="l57.109">         let queryXml =</span>
<a href="#l57.110"></a><span id="l57.110">             xmlHeader +</span>
<a href="#l57.111"></a><span id="l57.111">             '&lt;D:propfind xmlns:D=&quot;DAV:&quot; xmlns:CS=&quot;http://calendarserver.org/ns/&quot; xmlns:C=&quot;urn:ietf:params:xml:ns:caldav&quot;&gt;' +</span>
<a href="#l57.112"></a><span id="l57.112" class="difflineminus">-              '&lt;D:prop&gt;' +</span>
<a href="#l57.113"></a><span id="l57.113" class="difflineminus">-                '&lt;D:resourcetype/&gt;' +</span>
<a href="#l57.114"></a><span id="l57.114" class="difflineminus">-                '&lt;D:owner/&gt;' +</span>
<a href="#l57.115"></a><span id="l57.115" class="difflineminus">-                '&lt;D:current-user-principal/&gt;' +</span>
<a href="#l57.116"></a><span id="l57.116" class="difflineminus">-                '&lt;D:supported-report-set/&gt;' +</span>
<a href="#l57.117"></a><span id="l57.117" class="difflineminus">-                '&lt;C:supported-calendar-component-set/&gt;' +</span>
<a href="#l57.118"></a><span id="l57.118" class="difflineminus">-                '&lt;CS:getctag/&gt;' +</span>
<a href="#l57.119"></a><span id="l57.119" class="difflineminus">-              '&lt;/D:prop&gt;' +</span>
<a href="#l57.120"></a><span id="l57.120" class="difflineminus">-            '&lt;/D:propfind&gt;';</span>
<a href="#l57.121"></a><span id="l57.121" class="difflineplus">+              &quot;&lt;D:prop&gt;&quot; +</span>
<a href="#l57.122"></a><span id="l57.122" class="difflineplus">+                &quot;&lt;D:resourcetype/&gt;&quot; +</span>
<a href="#l57.123"></a><span id="l57.123" class="difflineplus">+                &quot;&lt;D:owner/&gt;&quot; +</span>
<a href="#l57.124"></a><span id="l57.124" class="difflineplus">+                &quot;&lt;D:current-user-principal/&gt;&quot; +</span>
<a href="#l57.125"></a><span id="l57.125" class="difflineplus">+                &quot;&lt;D:supported-report-set/&gt;&quot; +</span>
<a href="#l57.126"></a><span id="l57.126" class="difflineplus">+                &quot;&lt;C:supported-calendar-component-set/&gt;&quot; +</span>
<a href="#l57.127"></a><span id="l57.127" class="difflineplus">+                &quot;&lt;CS:getctag/&gt;&quot; +</span>
<a href="#l57.128"></a><span id="l57.128" class="difflineplus">+              &quot;&lt;/D:prop&gt;&quot; +</span>
<a href="#l57.129"></a><span id="l57.129" class="difflineplus">+            &quot;&lt;/D:propfind&gt;&quot;;</span>
<a href="#l57.130"></a><span id="l57.130"> </span>
<a href="#l57.131"></a><span id="l57.131">         if (this.verboseLogging()) {</span>
<a href="#l57.132"></a><span id="l57.132">             cal.LOG(&quot;CalDAV: send: &quot; + queryXml);</span>
<a href="#l57.133"></a><span id="l57.133">         }</span>
<a href="#l57.134"></a><span id="l57.134">         let streamListener = {};</span>
<a href="#l57.135"></a><span id="l57.135"> </span>
<a href="#l57.136"></a><span id="l57.136">         streamListener.onStreamComplete =</span>
<a href="#l57.137"></a><span id="l57.137">             function checkDavResourceType_oSC(aLoader, aContext, aStatus, aResultLength, aResult) {</span>
<a href="#l57.138"></a><span id="l57.138" class="difflineat">@@ -2037,20 +2037,20 @@ calDavCalendar.prototype = {</span>
<a href="#l57.139"></a><span id="l57.139">         }</span>
<a href="#l57.140"></a><span id="l57.140"> </span>
<a href="#l57.141"></a><span id="l57.141">         let homeSet = this.makeUri(null, this.mCalHomeSet);</span>
<a href="#l57.142"></a><span id="l57.142">         let thisCalendar = this;</span>
<a href="#l57.143"></a><span id="l57.143"> </span>
<a href="#l57.144"></a><span id="l57.144">         let queryXml =</span>
<a href="#l57.145"></a><span id="l57.145">             xmlHeader +</span>
<a href="#l57.146"></a><span id="l57.146">             '&lt;D:propfind xmlns:D=&quot;DAV:&quot;&gt;' +</span>
<a href="#l57.147"></a><span id="l57.147" class="difflineminus">-              '&lt;D:prop&gt;' +</span>
<a href="#l57.148"></a><span id="l57.148" class="difflineminus">-                '&lt;D:principal-collection-set/&gt;' +</span>
<a href="#l57.149"></a><span id="l57.149" class="difflineminus">-              '&lt;/D:prop&gt;' +</span>
<a href="#l57.150"></a><span id="l57.150" class="difflineminus">-            '&lt;/D:propfind&gt;';</span>
<a href="#l57.151"></a><span id="l57.151" class="difflineplus">+              &quot;&lt;D:prop&gt;&quot; +</span>
<a href="#l57.152"></a><span id="l57.152" class="difflineplus">+                &quot;&lt;D:principal-collection-set/&gt;&quot; +</span>
<a href="#l57.153"></a><span id="l57.153" class="difflineplus">+              &quot;&lt;/D:prop&gt;&quot; +</span>
<a href="#l57.154"></a><span id="l57.154" class="difflineplus">+            &quot;&lt;/D:propfind&gt;&quot;;</span>
<a href="#l57.155"></a><span id="l57.155"> </span>
<a href="#l57.156"></a><span id="l57.156">         if (this.verboseLogging()) {</span>
<a href="#l57.157"></a><span id="l57.157">             cal.LOG(&quot;CalDAV: send: &quot; + homeSet.spec + &quot;\n&quot; + queryXml);</span>
<a href="#l57.158"></a><span id="l57.158">         }</span>
<a href="#l57.159"></a><span id="l57.159">         let streamListener = {};</span>
<a href="#l57.160"></a><span id="l57.160">         streamListener.onStreamComplete =</span>
<a href="#l57.161"></a><span id="l57.161">             function findInOutboxes_oSC(aLoader, aContext, aStatus,</span>
<a href="#l57.162"></a><span id="l57.162">                                          aResultLength, aResult) {</span>
<a href="#l57.163"></a><span id="l57.163" class="difflineat">@@ -2134,42 +2134,42 @@ calDavCalendar.prototype = {</span>
<a href="#l57.164"></a><span id="l57.164"> </span>
<a href="#l57.165"></a><span id="l57.165">         // Remove trailing slash, if its there</span>
<a href="#l57.166"></a><span id="l57.166">         let homePath = this.ensureEncodedPath(this.mCalHomeSet.spec.replace(/\/$/, &quot;&quot;));</span>
<a href="#l57.167"></a><span id="l57.167">         let queryXml, queryMethod, queryDepth;</span>
<a href="#l57.168"></a><span id="l57.168">         if (this.mPrincipalUrl) {</span>
<a href="#l57.169"></a><span id="l57.169">             queryXml =</span>
<a href="#l57.170"></a><span id="l57.170">                 xmlHeader +</span>
<a href="#l57.171"></a><span id="l57.171">                 '&lt;D:propfind xmlns:D=&quot;DAV:&quot; xmlns:C=&quot;urn:ietf:params:xml:ns:caldav&quot;&gt;' +</span>
<a href="#l57.172"></a><span id="l57.172" class="difflineminus">-                  '&lt;D:prop&gt;' +</span>
<a href="#l57.173"></a><span id="l57.173" class="difflineminus">-                    '&lt;C:calendar-home-set/&gt;' +</span>
<a href="#l57.174"></a><span id="l57.174" class="difflineminus">-                    '&lt;C:calendar-user-address-set/&gt;' +</span>
<a href="#l57.175"></a><span id="l57.175" class="difflineminus">-                    '&lt;C:schedule-inbox-URL/&gt;' +</span>
<a href="#l57.176"></a><span id="l57.176" class="difflineminus">-                    '&lt;C:schedule-outbox-URL/&gt;' +</span>
<a href="#l57.177"></a><span id="l57.177" class="difflineminus">-                  '&lt;/D:prop&gt;' +</span>
<a href="#l57.178"></a><span id="l57.178" class="difflineminus">-                '&lt;/D:propfind&gt;';</span>
<a href="#l57.179"></a><span id="l57.179" class="difflineplus">+                  &quot;&lt;D:prop&gt;&quot; +</span>
<a href="#l57.180"></a><span id="l57.180" class="difflineplus">+                    &quot;&lt;C:calendar-home-set/&gt;&quot; +</span>
<a href="#l57.181"></a><span id="l57.181" class="difflineplus">+                    &quot;&lt;C:calendar-user-address-set/&gt;&quot; +</span>
<a href="#l57.182"></a><span id="l57.182" class="difflineplus">+                    &quot;&lt;C:schedule-inbox-URL/&gt;&quot; +</span>
<a href="#l57.183"></a><span id="l57.183" class="difflineplus">+                    &quot;&lt;C:schedule-outbox-URL/&gt;&quot; +</span>
<a href="#l57.184"></a><span id="l57.184" class="difflineplus">+                  &quot;&lt;/D:prop&gt;&quot; +</span>
<a href="#l57.185"></a><span id="l57.185" class="difflineplus">+                &quot;&lt;/D:propfind&gt;&quot;;</span>
<a href="#l57.186"></a><span id="l57.186">             queryMethod = &quot;PROPFIND&quot;;</span>
<a href="#l57.187"></a><span id="l57.187">             queryDepth = 0;</span>
<a href="#l57.188"></a><span id="l57.188">         } else {</span>
<a href="#l57.189"></a><span id="l57.189">             queryXml =</span>
<a href="#l57.190"></a><span id="l57.190">                 xmlHeader +</span>
<a href="#l57.191"></a><span id="l57.191">                 '&lt;D:principal-property-search xmlns:D=&quot;DAV:&quot; xmlns:C=&quot;urn:ietf:params:xml:ns:caldav&quot;&gt;' +</span>
<a href="#l57.192"></a><span id="l57.192" class="difflineminus">-                '&lt;D:property-search&gt;' +</span>
<a href="#l57.193"></a><span id="l57.193" class="difflineminus">-                    '&lt;D:prop&gt;' +</span>
<a href="#l57.194"></a><span id="l57.194" class="difflineminus">-                        '&lt;C:calendar-home-set/&gt;' +</span>
<a href="#l57.195"></a><span id="l57.195" class="difflineminus">-                    '&lt;/D:prop&gt;' +</span>
<a href="#l57.196"></a><span id="l57.196" class="difflineminus">-                    '&lt;D:match&gt;' + cal.xml.escapeString(homePath) + '&lt;/D:match&gt;' +</span>
<a href="#l57.197"></a><span id="l57.197" class="difflineminus">-                '&lt;/D:property-search&gt;' +</span>
<a href="#l57.198"></a><span id="l57.198" class="difflineminus">-                    '&lt;D:prop&gt;' +</span>
<a href="#l57.199"></a><span id="l57.199" class="difflineminus">-                        '&lt;C:calendar-home-set/&gt;' +</span>
<a href="#l57.200"></a><span id="l57.200" class="difflineminus">-                        '&lt;C:calendar-user-address-set/&gt;' +</span>
<a href="#l57.201"></a><span id="l57.201" class="difflineminus">-                        '&lt;C:schedule-inbox-URL/&gt;' +</span>
<a href="#l57.202"></a><span id="l57.202" class="difflineminus">-                        '&lt;C:schedule-outbox-URL/&gt;' +</span>
<a href="#l57.203"></a><span id="l57.203" class="difflineminus">-                    '&lt;/D:prop&gt;' +</span>
<a href="#l57.204"></a><span id="l57.204" class="difflineminus">-                '&lt;/D:principal-property-search&gt;';</span>
<a href="#l57.205"></a><span id="l57.205" class="difflineplus">+                &quot;&lt;D:property-search&gt;&quot; +</span>
<a href="#l57.206"></a><span id="l57.206" class="difflineplus">+                    &quot;&lt;D:prop&gt;&quot; +</span>
<a href="#l57.207"></a><span id="l57.207" class="difflineplus">+                        &quot;&lt;C:calendar-home-set/&gt;&quot; +</span>
<a href="#l57.208"></a><span id="l57.208" class="difflineplus">+                    &quot;&lt;/D:prop&gt;&quot; +</span>
<a href="#l57.209"></a><span id="l57.209" class="difflineplus">+                    &quot;&lt;D:match&gt;&quot; + cal.xml.escapeString(homePath) + &quot;&lt;/D:match&gt;&quot; +</span>
<a href="#l57.210"></a><span id="l57.210" class="difflineplus">+                &quot;&lt;/D:property-search&gt;&quot; +</span>
<a href="#l57.211"></a><span id="l57.211" class="difflineplus">+                    &quot;&lt;D:prop&gt;&quot; +</span>
<a href="#l57.212"></a><span id="l57.212" class="difflineplus">+                        &quot;&lt;C:calendar-home-set/&gt;&quot; +</span>
<a href="#l57.213"></a><span id="l57.213" class="difflineplus">+                        &quot;&lt;C:calendar-user-address-set/&gt;&quot; +</span>
<a href="#l57.214"></a><span id="l57.214" class="difflineplus">+                        &quot;&lt;C:schedule-inbox-URL/&gt;&quot; +</span>
<a href="#l57.215"></a><span id="l57.215" class="difflineplus">+                        &quot;&lt;C:schedule-outbox-URL/&gt;&quot; +</span>
<a href="#l57.216"></a><span id="l57.216" class="difflineplus">+                    &quot;&lt;/D:prop&gt;&quot; +</span>
<a href="#l57.217"></a><span id="l57.217" class="difflineplus">+                &quot;&lt;/D:principal-property-search&gt;&quot;;</span>
<a href="#l57.218"></a><span id="l57.218">             queryMethod = &quot;REPORT&quot;;</span>
<a href="#l57.219"></a><span id="l57.219">             queryDepth = 1;</span>
<a href="#l57.220"></a><span id="l57.220">         }</span>
<a href="#l57.221"></a><span id="l57.221"> </span>
<a href="#l57.222"></a><span id="l57.222">         // We want a trailing slash, ensure it.</span>
<a href="#l57.223"></a><span id="l57.223">         let nextNS = aNameSpaceList.pop().replace(/([^\/])$/, &quot;$1/&quot;);</span>
<a href="#l57.224"></a><span id="l57.224">         let requestUri = makeURL(this.calendarUri.prePath + this.ensureEncodedPath(nextNS));</span>
<a href="#l57.225"></a><span id="l57.225"> </span>
<a href="#l57.226"></a><span id="l57.226" class="difflineat">@@ -2212,17 +2212,17 @@ calDavCalendar.prototype = {</span>
<a href="#l57.227"></a><span id="l57.227">                 let normalized = homeSet.replace(/([^\/])$/, &quot;$1/&quot;);</span>
<a href="#l57.228"></a><span id="l57.228">                 let chs = thisCalendar.mCalHomeSet;</span>
<a href="#l57.229"></a><span id="l57.229">                 return normalized == chs.path || normalized == chs.spec;</span>
<a href="#l57.230"></a><span id="l57.230">             }</span>
<a href="#l57.231"></a><span id="l57.231">             function createBoxUrl(path) {</span>
<a href="#l57.232"></a><span id="l57.232">                 let url = thisCalendar.mUri.clone();</span>
<a href="#l57.233"></a><span id="l57.233">                 url.path = thisCalendar.ensureDecodedPath(path);</span>
<a href="#l57.234"></a><span id="l57.234">                 // Make sure the uri has a / at the end, as we do with the calendarUri.</span>
<a href="#l57.235"></a><span id="l57.235" class="difflineminus">-                if (url.path.charAt(url.path.length - 1) != '/') {</span>
<a href="#l57.236"></a><span id="l57.236" class="difflineplus">+                if (url.path.charAt(url.path.length - 1) != &quot;/&quot;) {</span>
<a href="#l57.237"></a><span id="l57.237">                     url.path += &quot;/&quot;;</span>
<a href="#l57.238"></a><span id="l57.238">                 }</span>
<a href="#l57.239"></a><span id="l57.239">                 return url;</span>
<a href="#l57.240"></a><span id="l57.240">             }</span>
<a href="#l57.241"></a><span id="l57.241"> </span>
<a href="#l57.242"></a><span id="l57.242">             // If there are multiple home sets, we need to match the email addresses for scheduling.</span>
<a href="#l57.243"></a><span id="l57.243">             // If there is only one, assume its the right one.</span>
<a href="#l57.244"></a><span id="l57.244">             // TODO with multiple address sets, we should just use the ACL manager.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/calendar/providers/caldav/calDavRequestHandlers.js</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavRequestHandlers.js</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -329,22 +329,22 @@ webDavSyncHandler.prototype = {</span>
<a href="#l58.4"></a><span id="l58.4">             let syncToken = cal.xml.escapeString(this.calendar.mWebdavSyncToken);</span>
<a href="#l58.5"></a><span id="l58.5">             syncTokenString = &quot;&lt;sync-token&gt;&quot; + syncToken + &quot;&lt;/sync-token&gt;&quot;;</span>
<a href="#l58.6"></a><span id="l58.6">         }</span>
<a href="#l58.7"></a><span id="l58.7"> </span>
<a href="#l58.8"></a><span id="l58.8">         let queryXml =</span>
<a href="#l58.9"></a><span id="l58.9">           xmlHeader +</span>
<a href="#l58.10"></a><span id="l58.10">           '&lt;sync-collection xmlns=&quot;DAV:&quot;&gt;' +</span>
<a href="#l58.11"></a><span id="l58.11">             syncTokenString +</span>
<a href="#l58.12"></a><span id="l58.12" class="difflineminus">-            '&lt;sync-level&gt;1&lt;/sync-level&gt;' +</span>
<a href="#l58.13"></a><span id="l58.13" class="difflineminus">-            '&lt;prop&gt;' +</span>
<a href="#l58.14"></a><span id="l58.14" class="difflineminus">-              '&lt;getcontenttype/&gt;' +</span>
<a href="#l58.15"></a><span id="l58.15" class="difflineminus">-              '&lt;getetag/&gt;' +</span>
<a href="#l58.16"></a><span id="l58.16" class="difflineminus">-            '&lt;/prop&gt;' +</span>
<a href="#l58.17"></a><span id="l58.17" class="difflineminus">-          '&lt;/sync-collection&gt;';</span>
<a href="#l58.18"></a><span id="l58.18" class="difflineplus">+            &quot;&lt;sync-level&gt;1&lt;/sync-level&gt;&quot; +</span>
<a href="#l58.19"></a><span id="l58.19" class="difflineplus">+            &quot;&lt;prop&gt;&quot; +</span>
<a href="#l58.20"></a><span id="l58.20" class="difflineplus">+              &quot;&lt;getcontenttype/&gt;&quot; +</span>
<a href="#l58.21"></a><span id="l58.21" class="difflineplus">+              &quot;&lt;getetag/&gt;&quot; +</span>
<a href="#l58.22"></a><span id="l58.22" class="difflineplus">+            &quot;&lt;/prop&gt;&quot; +</span>
<a href="#l58.23"></a><span id="l58.23" class="difflineplus">+          &quot;&lt;/sync-collection&gt;&quot;;</span>
<a href="#l58.24"></a><span id="l58.24"> </span>
<a href="#l58.25"></a><span id="l58.25">         let requestUri = this.calendar.makeUri(null, this.baseUri);</span>
<a href="#l58.26"></a><span id="l58.26"> </span>
<a href="#l58.27"></a><span id="l58.27">         if (this.calendar.verboseLogging()) {</span>
<a href="#l58.28"></a><span id="l58.28">             cal.LOG(&quot;CalDAV: send(&quot; + requestUri.spec + &quot;): &quot; + queryXml);</span>
<a href="#l58.29"></a><span id="l58.29">         }</span>
<a href="#l58.30"></a><span id="l58.30">         cal.LOG(&quot;CalDAV: webdav-sync Token: &quot; + this.calendar.mWebdavSyncToken);</span>
<a href="#l58.31"></a><span id="l58.31">         this.calendar.sendHttpRequest(requestUri, queryXml, MIME_TEXT_XML, null, (channel) =&gt; {</span>
<a href="#l58.32"></a><span id="l58.32" class="difflineat">@@ -515,17 +515,17 @@ webDavSyncHandler.prototype = {</span>
<a href="#l58.33"></a><span id="l58.33">                     this.tag = aLocalName;</span>
<a href="#l58.34"></a><span id="l58.34">                 }</span>
<a href="#l58.35"></a><span id="l58.35">                 this.currentResponse[this.tag] = &quot;&quot;;</span>
<a href="#l58.36"></a><span id="l58.36">                 break;</span>
<a href="#l58.37"></a><span id="l58.37">             case &quot;href&quot;:</span>
<a href="#l58.38"></a><span id="l58.38">             case &quot;getetag&quot;:</span>
<a href="#l58.39"></a><span id="l58.39">             case &quot;getcontenttype&quot;:</span>
<a href="#l58.40"></a><span id="l58.40">             case &quot;sync-token&quot;:</span>
<a href="#l58.41"></a><span id="l58.41" class="difflineminus">-                this.tag = aLocalName.replace(/-/g, '');</span>
<a href="#l58.42"></a><span id="l58.42" class="difflineplus">+                this.tag = aLocalName.replace(/-/g, &quot;&quot;);</span>
<a href="#l58.43"></a><span id="l58.43">                 this.currentResponse[this.tag ] = &quot;&quot;;</span>
<a href="#l58.44"></a><span id="l58.44">                 break;</span>
<a href="#l58.45"></a><span id="l58.45">         }</span>
<a href="#l58.46"></a><span id="l58.46">         if (this.calendar.verboseLogging()) {</span>
<a href="#l58.47"></a><span id="l58.47">             this.logXML += &quot;&lt;&quot; + aQName + &quot;&gt;&quot;;</span>
<a href="#l58.48"></a><span id="l58.48">         }</span>
<a href="#l58.49"></a><span id="l58.49">     },</span>
<a href="#l58.50"></a><span id="l58.50"> </span>
<a href="#l58.51"></a><span id="l58.51" class="difflineat">@@ -697,22 +697,22 @@ multigetSyncHandler.prototype = {</span>
<a href="#l58.52"></a><span id="l58.52">             // encodes it before it is sent to the server</span>
<a href="#l58.53"></a><span id="l58.53">             let locpath = this.calendar.ensureEncodedPath(this.itemsNeedFetching.pop());</span>
<a href="#l58.54"></a><span id="l58.54">             hrefString += &quot;&lt;D:href&gt;&quot; + cal.xml.escapeString(locpath) + &quot;&lt;/D:href&gt;&quot;;</span>
<a href="#l58.55"></a><span id="l58.55">         }</span>
<a href="#l58.56"></a><span id="l58.56"> </span>
<a href="#l58.57"></a><span id="l58.57">         let queryXml =</span>
<a href="#l58.58"></a><span id="l58.58">           xmlHeader +</span>
<a href="#l58.59"></a><span id="l58.59">           '&lt;C:calendar-multiget xmlns:D=&quot;DAV:&quot; xmlns:C=&quot;urn:ietf:params:xml:ns:caldav&quot;&gt;' +</span>
<a href="#l58.60"></a><span id="l58.60" class="difflineminus">-            '&lt;D:prop&gt;' +</span>
<a href="#l58.61"></a><span id="l58.61" class="difflineminus">-              '&lt;D:getetag/&gt;' +</span>
<a href="#l58.62"></a><span id="l58.62" class="difflineminus">-              '&lt;C:calendar-data/&gt;' +</span>
<a href="#l58.63"></a><span id="l58.63" class="difflineminus">-            '&lt;/D:prop&gt;' +</span>
<a href="#l58.64"></a><span id="l58.64" class="difflineplus">+            &quot;&lt;D:prop&gt;&quot; +</span>
<a href="#l58.65"></a><span id="l58.65" class="difflineplus">+              &quot;&lt;D:getetag/&gt;&quot; +</span>
<a href="#l58.66"></a><span id="l58.66" class="difflineplus">+              &quot;&lt;C:calendar-data/&gt;&quot; +</span>
<a href="#l58.67"></a><span id="l58.67" class="difflineplus">+            &quot;&lt;/D:prop&gt;&quot; +</span>
<a href="#l58.68"></a><span id="l58.68">             hrefString +</span>
<a href="#l58.69"></a><span id="l58.69" class="difflineminus">-          '&lt;/C:calendar-multiget&gt;';</span>
<a href="#l58.70"></a><span id="l58.70" class="difflineplus">+          &quot;&lt;/C:calendar-multiget&gt;&quot;;</span>
<a href="#l58.71"></a><span id="l58.71"> </span>
<a href="#l58.72"></a><span id="l58.72">         let requestUri = this.calendar.makeUri(null, this.baseUri);</span>
<a href="#l58.73"></a><span id="l58.73">         if (this.calendar.verboseLogging()) {</span>
<a href="#l58.74"></a><span id="l58.74">             cal.LOG(&quot;CalDAV: send(&quot; + requestUri.spec + &quot;): &quot; + queryXml);</span>
<a href="#l58.75"></a><span id="l58.75">         }</span>
<a href="#l58.76"></a><span id="l58.76">         this.calendar.sendHttpRequest(requestUri, queryXml, MIME_TEXT_XML, null, (channel) =&gt; {</span>
<a href="#l58.77"></a><span id="l58.77">             channel.requestMethod = &quot;REPORT&quot;;</span>
<a href="#l58.78"></a><span id="l58.78">             channel.setRequestHeader(&quot;Depth&quot;, &quot;1&quot;, false);</span>
<a href="#l58.79"></a><span id="l58.79" class="difflineat">@@ -869,17 +869,17 @@ multigetSyncHandler.prototype = {</span>
<a href="#l58.80"></a><span id="l58.80">                 } else {</span>
<a href="#l58.81"></a><span id="l58.81">                     this.tag = aLocalName;</span>
<a href="#l58.82"></a><span id="l58.82">                 }</span>
<a href="#l58.83"></a><span id="l58.83">                 this.currentResponse[this.tag] = &quot;&quot;;</span>
<a href="#l58.84"></a><span id="l58.84">                 break;</span>
<a href="#l58.85"></a><span id="l58.85">             case &quot;calendar-data&quot;:</span>
<a href="#l58.86"></a><span id="l58.86">             case &quot;href&quot;:</span>
<a href="#l58.87"></a><span id="l58.87">             case &quot;getetag&quot;:</span>
<a href="#l58.88"></a><span id="l58.88" class="difflineminus">-                this.tag = aLocalName.replace(/-/g, '');</span>
<a href="#l58.89"></a><span id="l58.89" class="difflineplus">+                this.tag = aLocalName.replace(/-/g, &quot;&quot;);</span>
<a href="#l58.90"></a><span id="l58.90">                 this.currentResponse[this.tag ] = &quot;&quot;;</span>
<a href="#l58.91"></a><span id="l58.91">                 break;</span>
<a href="#l58.92"></a><span id="l58.92">         }</span>
<a href="#l58.93"></a><span id="l58.93">         if (this.calendar.verboseLogging()) {</span>
<a href="#l58.94"></a><span id="l58.94">             this.logXML += &quot;&lt;&quot; + aQName + &quot;&gt;&quot;;</span>
<a href="#l58.95"></a><span id="l58.95">         }</span>
<a href="#l58.96"></a><span id="l58.96">     },</span>
<a href="#l58.97"></a><span id="l58.97"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -134,22 +134,22 @@ calICSCalendar.prototype = {</span>
<a href="#l59.4"></a><span id="l59.4">         switch (aName) {</span>
<a href="#l59.5"></a><span id="l59.5">             case &quot;requiresNetwork&quot;:</span>
<a href="#l59.6"></a><span id="l59.6">                 return !this.uri.schemeIs(&quot;file&quot;);</span>
<a href="#l59.7"></a><span id="l59.7">         }</span>
<a href="#l59.8"></a><span id="l59.8">         return this.__proto__.__proto__.getProperty.apply(this, arguments);</span>
<a href="#l59.9"></a><span id="l59.9">     },</span>
<a href="#l59.10"></a><span id="l59.10"> </span>
<a href="#l59.11"></a><span id="l59.11">     refresh: function calICSCalendar_refresh() {</span>
<a href="#l59.12"></a><span id="l59.12" class="difflineminus">-        this.queue.push({ action: 'refresh', forceRefresh: false });</span>
<a href="#l59.13"></a><span id="l59.13" class="difflineplus">+        this.queue.push({ action: &quot;refresh&quot;, forceRefresh: false });</span>
<a href="#l59.14"></a><span id="l59.14">         this.processQueue();</span>
<a href="#l59.15"></a><span id="l59.15">     },</span>
<a href="#l59.16"></a><span id="l59.16"> </span>
<a href="#l59.17"></a><span id="l59.17">     forceRefresh: function calICSCalendar_forceRefresh() {</span>
<a href="#l59.18"></a><span id="l59.18" class="difflineminus">-        this.queue.push({ action: 'refresh', forceRefresh: true });</span>
<a href="#l59.19"></a><span id="l59.19" class="difflineplus">+        this.queue.push({ action: &quot;refresh&quot;, forceRefresh: true });</span>
<a href="#l59.20"></a><span id="l59.20">         this.processQueue();</span>
<a href="#l59.21"></a><span id="l59.21">     },</span>
<a href="#l59.22"></a><span id="l59.22"> </span>
<a href="#l59.23"></a><span id="l59.23">     prepareChannel: function calICSCalendar_prepareChannel(aChannel, aForceRefresh) {</span>
<a href="#l59.24"></a><span id="l59.24">         aChannel.loadFlags |= Components.interfaces.nsIRequest.LOAD_BYPASS_CACHE;</span>
<a href="#l59.25"></a><span id="l59.25">         aChannel.notificationCallbacks = this;</span>
<a href="#l59.26"></a><span id="l59.26"> </span>
<a href="#l59.27"></a><span id="l59.27">         // Allow the hook to do its work, like a performing a quick check to</span>
<a href="#l59.28"></a><span id="l59.28" class="difflineat">@@ -458,44 +458,44 @@ calICSCalendar.prototype = {</span>
<a href="#l59.29"></a><span id="l59.29">     // copied code.</span>
<a href="#l59.30"></a><span id="l59.30">     addItem: function(aItem, aListener) {</span>
<a href="#l59.31"></a><span id="l59.31">         this.adoptItem(aItem.clone(), aListener);</span>
<a href="#l59.32"></a><span id="l59.32">     },</span>
<a href="#l59.33"></a><span id="l59.33">     adoptItem: function(aItem, aListener) {</span>
<a href="#l59.34"></a><span id="l59.34">         if (this.readOnly) {</span>
<a href="#l59.35"></a><span id="l59.35">             throw calIErrors.CAL_IS_READONLY;</span>
<a href="#l59.36"></a><span id="l59.36">         }</span>
<a href="#l59.37"></a><span id="l59.37" class="difflineminus">-        this.queue.push({ action: 'add', item: aItem, listener: aListener });</span>
<a href="#l59.38"></a><span id="l59.38" class="difflineplus">+        this.queue.push({ action: &quot;add&quot;, item: aItem, listener: aListener });</span>
<a href="#l59.39"></a><span id="l59.39">         this.processQueue();</span>
<a href="#l59.40"></a><span id="l59.40">     },</span>
<a href="#l59.41"></a><span id="l59.41"> </span>
<a href="#l59.42"></a><span id="l59.42">     modifyItem: function(aNewItem, aOldItem, aListener) {</span>
<a href="#l59.43"></a><span id="l59.43">         if (this.readOnly) {</span>
<a href="#l59.44"></a><span id="l59.44">             throw calIErrors.CAL_IS_READONLY;</span>
<a href="#l59.45"></a><span id="l59.45">         }</span>
<a href="#l59.46"></a><span id="l59.46" class="difflineminus">-        this.queue.push({ action: 'modify', oldItem: aOldItem,</span>
<a href="#l59.47"></a><span id="l59.47" class="difflineplus">+        this.queue.push({ action: &quot;modify&quot;, oldItem: aOldItem,</span>
<a href="#l59.48"></a><span id="l59.48">                           newItem: aNewItem, listener: aListener });</span>
<a href="#l59.49"></a><span id="l59.49">         this.processQueue();</span>
<a href="#l59.50"></a><span id="l59.50">     },</span>
<a href="#l59.51"></a><span id="l59.51"> </span>
<a href="#l59.52"></a><span id="l59.52">     deleteItem: function(aItem, aListener) {</span>
<a href="#l59.53"></a><span id="l59.53">         if (this.readOnly) {</span>
<a href="#l59.54"></a><span id="l59.54">             throw calIErrors.CAL_IS_READONLY;</span>
<a href="#l59.55"></a><span id="l59.55">         }</span>
<a href="#l59.56"></a><span id="l59.56" class="difflineminus">-        this.queue.push({ action: 'delete', item: aItem, listener: aListener });</span>
<a href="#l59.57"></a><span id="l59.57" class="difflineplus">+        this.queue.push({ action: &quot;delete&quot;, item: aItem, listener: aListener });</span>
<a href="#l59.58"></a><span id="l59.58">         this.processQueue();</span>
<a href="#l59.59"></a><span id="l59.59">     },</span>
<a href="#l59.60"></a><span id="l59.60"> </span>
<a href="#l59.61"></a><span id="l59.61">     getItem: function(aId, aListener) {</span>
<a href="#l59.62"></a><span id="l59.62" class="difflineminus">-        this.queue.push({ action: 'get_item', id: aId, listener: aListener });</span>
<a href="#l59.63"></a><span id="l59.63" class="difflineplus">+        this.queue.push({ action: &quot;get_item&quot;, id: aId, listener: aListener });</span>
<a href="#l59.64"></a><span id="l59.64">         this.processQueue();</span>
<a href="#l59.65"></a><span id="l59.65">     },</span>
<a href="#l59.66"></a><span id="l59.66"> </span>
<a href="#l59.67"></a><span id="l59.67">     getItems: function(aItemFilter, aCount, aRangeStart, aRangeEnd, aListener) {</span>
<a href="#l59.68"></a><span id="l59.68" class="difflineminus">-        this.queue.push({ action: 'get_items',</span>
<a href="#l59.69"></a><span id="l59.69" class="difflineplus">+        this.queue.push({ action: &quot;get_items&quot;,</span>
<a href="#l59.70"></a><span id="l59.70">                           itemFilter: aItemFilter, count: aCount,</span>
<a href="#l59.71"></a><span id="l59.71">                           rangeStart: aRangeStart, rangeEnd: aRangeEnd,</span>
<a href="#l59.72"></a><span id="l59.72">                           listener: aListener });</span>
<a href="#l59.73"></a><span id="l59.73">         this.processQueue();</span>
<a href="#l59.74"></a><span id="l59.74">     },</span>
<a href="#l59.75"></a><span id="l59.75"> </span>
<a href="#l59.76"></a><span id="l59.76">     processQueue: function() {</span>
<a href="#l59.77"></a><span id="l59.77">         if (this.isLocked()) {</span>
<a href="#l59.78"></a><span id="l59.78" class="difflineat">@@ -513,40 +513,40 @@ calICSCalendar.prototype = {</span>
<a href="#l59.79"></a><span id="l59.79">             }</span>
<a href="#l59.80"></a><span id="l59.80">         };</span>
<a href="#l59.81"></a><span id="l59.81"> </span>
<a href="#l59.82"></a><span id="l59.82">         let a;</span>
<a href="#l59.83"></a><span id="l59.83">         let writeICS = false;</span>
<a href="#l59.84"></a><span id="l59.84">         let refreshAction = null;</span>
<a href="#l59.85"></a><span id="l59.85">         while ((a = this.queue.shift())) {</span>
<a href="#l59.86"></a><span id="l59.86">             switch (a.action) {</span>
<a href="#l59.87"></a><span id="l59.87" class="difflineminus">-                case 'add':</span>
<a href="#l59.88"></a><span id="l59.88" class="difflineplus">+                case &quot;add&quot;:</span>
<a href="#l59.89"></a><span id="l59.89">                     this.mMemoryCalendar.addItem(a.item, new modListener(a));</span>
<a href="#l59.90"></a><span id="l59.90">                     this.mModificationActions.push(a);</span>
<a href="#l59.91"></a><span id="l59.91">                     writeICS = true;</span>
<a href="#l59.92"></a><span id="l59.92">                     break;</span>
<a href="#l59.93"></a><span id="l59.93" class="difflineminus">-                case 'modify':</span>
<a href="#l59.94"></a><span id="l59.94" class="difflineplus">+                case &quot;modify&quot;:</span>
<a href="#l59.95"></a><span id="l59.95">                     this.mMemoryCalendar.modifyItem(a.newItem, a.oldItem, new modListener(a));</span>
<a href="#l59.96"></a><span id="l59.96">                     this.mModificationActions.push(a);</span>
<a href="#l59.97"></a><span id="l59.97">                     writeICS = true;</span>
<a href="#l59.98"></a><span id="l59.98">                     break;</span>
<a href="#l59.99"></a><span id="l59.99" class="difflineminus">-                case 'delete':</span>
<a href="#l59.100"></a><span id="l59.100" class="difflineplus">+                case &quot;delete&quot;:</span>
<a href="#l59.101"></a><span id="l59.101">                     this.mMemoryCalendar.deleteItem(a.item, new modListener(a));</span>
<a href="#l59.102"></a><span id="l59.102">                     this.mModificationActions.push(a);</span>
<a href="#l59.103"></a><span id="l59.103">                     writeICS = true;</span>
<a href="#l59.104"></a><span id="l59.104">                     break;</span>
<a href="#l59.105"></a><span id="l59.105" class="difflineminus">-                case 'get_item':</span>
<a href="#l59.106"></a><span id="l59.106" class="difflineplus">+                case &quot;get_item&quot;:</span>
<a href="#l59.107"></a><span id="l59.107">                     this.mMemoryCalendar.getItem(a.id, a.listener);</span>
<a href="#l59.108"></a><span id="l59.108">                     break;</span>
<a href="#l59.109"></a><span id="l59.109" class="difflineminus">-                case 'get_items':</span>
<a href="#l59.110"></a><span id="l59.110" class="difflineplus">+                case &quot;get_items&quot;:</span>
<a href="#l59.111"></a><span id="l59.111">                     this.mMemoryCalendar.getItems(a.itemFilter, a.count,</span>
<a href="#l59.112"></a><span id="l59.112">                                                   a.rangeStart, a.rangeEnd,</span>
<a href="#l59.113"></a><span id="l59.113">                                                   a.listener);</span>
<a href="#l59.114"></a><span id="l59.114">                     break;</span>
<a href="#l59.115"></a><span id="l59.115" class="difflineminus">-                case 'refresh':</span>
<a href="#l59.116"></a><span id="l59.116" class="difflineplus">+                case &quot;refresh&quot;:</span>
<a href="#l59.117"></a><span id="l59.117">                     refreshAction = a;</span>
<a href="#l59.118"></a><span id="l59.118">                     break;</span>
<a href="#l59.119"></a><span id="l59.119">             }</span>
<a href="#l59.120"></a><span id="l59.120">             if (refreshAction) {</span>
<a href="#l59.121"></a><span id="l59.121">                 // break queue processing here and wait for refresh to finish</span>
<a href="#l59.122"></a><span id="l59.122">                 // before processing further operations</span>
<a href="#l59.123"></a><span id="l59.123">                 break;</span>
<a href="#l59.124"></a><span id="l59.124">             }</span>
<a href="#l59.125"></a><span id="l59.125" class="difflineat">@@ -635,17 +635,17 @@ calICSCalendar.prototype = {</span>
<a href="#l59.126"></a><span id="l59.126">         // This is a bit messy. createUnique creates an empty file,</span>
<a href="#l59.127"></a><span id="l59.127">         // but we don't use that file. All we want is a filename, to be used</span>
<a href="#l59.128"></a><span id="l59.128">         // in the call to copyTo later. So we create a file, get the filename,</span>
<a href="#l59.129"></a><span id="l59.129">         // and never use the file again, but write over it.</span>
<a href="#l59.130"></a><span id="l59.130">         // Using createUnique anyway, because I don't feel like</span>
<a href="#l59.131"></a><span id="l59.131">         // re-implementing it</span>
<a href="#l59.132"></a><span id="l59.132">         function makeDailyFileName() {</span>
<a href="#l59.133"></a><span id="l59.133">             let dailyBackupFile = backupDir.clone();</span>
<a href="#l59.134"></a><span id="l59.134" class="difflineminus">-            dailyBackupFile.append(makeName('day'));</span>
<a href="#l59.135"></a><span id="l59.135" class="difflineplus">+            dailyBackupFile.append(makeName(&quot;day&quot;));</span>
<a href="#l59.136"></a><span id="l59.136">             dailyBackupFile.createUnique(CI.nsIFile.NORMAL_FILE_TYPE,</span>
<a href="#l59.137"></a><span id="l59.137">                                          parseInt(&quot;0600&quot;, 8));</span>
<a href="#l59.138"></a><span id="l59.138">             dailyBackupFileName = dailyBackupFile.leafName;</span>
<a href="#l59.139"></a><span id="l59.139"> </span>
<a href="#l59.140"></a><span id="l59.140">             // Remove the reference to the nsIFile, because we need to</span>
<a href="#l59.141"></a><span id="l59.141">             // write over the file later, and you never know what happens</span>
<a href="#l59.142"></a><span id="l59.142">             // if something still has a reference.</span>
<a href="#l59.143"></a><span id="l59.143">             // Also makes it explicit that we don't need the file itself,</span>
<a href="#l59.144"></a><span id="l59.144" class="difflineat">@@ -686,19 +686,19 @@ calICSCalendar.prototype = {</span>
<a href="#l59.145"></a><span id="l59.145">             while (dirEnum.hasMoreElements()) {</span>
<a href="#l59.146"></a><span id="l59.146">                 let file = dirEnum.getNext().QueryInterface(CI.nsIFile);</span>
<a href="#l59.147"></a><span id="l59.147">                 if (file.isFile()) {</span>
<a href="#l59.148"></a><span id="l59.148">                     files.push({ name: file.leafName, lastmodified: file.lastModifiedTime });</span>
<a href="#l59.149"></a><span id="l59.149">                 }</span>
<a href="#l59.150"></a><span id="l59.150">             }</span>
<a href="#l59.151"></a><span id="l59.151"> </span>
<a href="#l59.152"></a><span id="l59.152">             if (doDailyBackup) {</span>
<a href="#l59.153"></a><span id="l59.153" class="difflineminus">-                purgeBackupsByType(files, 'day');</span>
<a href="#l59.154"></a><span id="l59.154" class="difflineplus">+                purgeBackupsByType(files, &quot;day&quot;);</span>
<a href="#l59.155"></a><span id="l59.155">             } else {</span>
<a href="#l59.156"></a><span id="l59.156" class="difflineminus">-                purgeBackupsByType(files, 'edit');</span>
<a href="#l59.157"></a><span id="l59.157" class="difflineplus">+                purgeBackupsByType(files, &quot;edit&quot;);</span>
<a href="#l59.158"></a><span id="l59.158">             }</span>
<a href="#l59.159"></a><span id="l59.159"> </span>
<a href="#l59.160"></a><span id="l59.160">             return;</span>
<a href="#l59.161"></a><span id="l59.161">         }</span>
<a href="#l59.162"></a><span id="l59.162"> </span>
<a href="#l59.163"></a><span id="l59.163">         function copyToOverwriting(oldFile, newParentDir, newName) {</span>
<a href="#l59.164"></a><span id="l59.164">             try {</span>
<a href="#l59.165"></a><span id="l59.165">                 let newFile = newParentDir.clone();</span>
<a href="#l59.166"></a><span id="l59.166" class="difflineat">@@ -745,37 +745,37 @@ calICSCalendar.prototype = {</span>
<a href="#l59.167"></a><span id="l59.167">             // xpcshell. Don't die, but continue the upload.</span>
<a href="#l59.168"></a><span id="l59.168">             cal.ERROR(&quot;[calICSCalendar] Backup failed, no calendarmanager:&quot; + e);</span>
<a href="#l59.169"></a><span id="l59.169">             aCallback.call(this);</span>
<a href="#l59.170"></a><span id="l59.170">             return;</span>
<a href="#l59.171"></a><span id="l59.171">         }</span>
<a href="#l59.172"></a><span id="l59.172"> </span>
<a href="#l59.173"></a><span id="l59.173">         let doInitialBackup = false;</span>
<a href="#l59.174"></a><span id="l59.174">         let initialBackupFile = backupDir.clone();</span>
<a href="#l59.175"></a><span id="l59.175" class="difflineminus">-        initialBackupFile.append(makeName('initial'));</span>
<a href="#l59.176"></a><span id="l59.176" class="difflineplus">+        initialBackupFile.append(makeName(&quot;initial&quot;));</span>
<a href="#l59.177"></a><span id="l59.177">         if (!initialBackupFile.exists()) {</span>
<a href="#l59.178"></a><span id="l59.178">             doInitialBackup = true;</span>
<a href="#l59.179"></a><span id="l59.179">         }</span>
<a href="#l59.180"></a><span id="l59.180"> </span>
<a href="#l59.181"></a><span id="l59.181">         let doDailyBackup = false;</span>
<a href="#l59.182"></a><span id="l59.182" class="difflineminus">-        let backupTime = this.getProperty('backup-time2');</span>
<a href="#l59.183"></a><span id="l59.183" class="difflineplus">+        let backupTime = this.getProperty(&quot;backup-time2&quot;);</span>
<a href="#l59.184"></a><span id="l59.184">         if (!backupTime ||</span>
<a href="#l59.185"></a><span id="l59.185">             (new Date().getTime() &gt; backupTime + backupDays * 24 * 60 * 60 * 1000)) {</span>
<a href="#l59.186"></a><span id="l59.186">             // It's time do to a daily backup</span>
<a href="#l59.187"></a><span id="l59.187">             doDailyBackup = true;</span>
<a href="#l59.188"></a><span id="l59.188" class="difflineminus">-            this.setProperty('backup-time2', new Date().getTime());</span>
<a href="#l59.189"></a><span id="l59.189" class="difflineplus">+            this.setProperty(&quot;backup-time2&quot;, new Date().getTime());</span>
<a href="#l59.190"></a><span id="l59.190">         }</span>
<a href="#l59.191"></a><span id="l59.191"> </span>
<a href="#l59.192"></a><span id="l59.192">         let dailyBackupFileName;</span>
<a href="#l59.193"></a><span id="l59.193">         if (doDailyBackup) {</span>
<a href="#l59.194"></a><span id="l59.194">             dailyBackupFileName = makeDailyFileName(backupDir);</span>
<a href="#l59.195"></a><span id="l59.195">         }</span>
<a href="#l59.196"></a><span id="l59.196"> </span>
<a href="#l59.197"></a><span id="l59.197">         let backupFile = backupDir.clone();</span>
<a href="#l59.198"></a><span id="l59.198" class="difflineminus">-        backupFile.append(makeName('edit'));</span>
<a href="#l59.199"></a><span id="l59.199" class="difflineplus">+        backupFile.append(makeName(&quot;edit&quot;));</span>
<a href="#l59.200"></a><span id="l59.200">         backupFile.createUnique(CI.nsIFile.NORMAL_FILE_TYPE, parseInt(&quot;0600&quot;, 8));</span>
<a href="#l59.201"></a><span id="l59.201"> </span>
<a href="#l59.202"></a><span id="l59.202">         purgeOldBackups();</span>
<a href="#l59.203"></a><span id="l59.203"> </span>
<a href="#l59.204"></a><span id="l59.204">         // Now go download the remote file, and store it somewhere local.</span>
<a href="#l59.205"></a><span id="l59.205">         let channel = Services.io.newChannelFromURI2(this.mUri,</span>
<a href="#l59.206"></a><span id="l59.206">                                                      null,</span>
<a href="#l59.207"></a><span id="l59.207">                                                      Services.scriptSecurityManager.getSystemPrincipal(),</span>
<a href="#l59.208"></a><span id="l59.208" class="difflineat">@@ -787,17 +787,17 @@ calICSCalendar.prototype = {</span>
<a href="#l59.209"></a><span id="l59.209"> </span>
<a href="#l59.210"></a><span id="l59.210">         let downloader = Components.classes[&quot;@mozilla.org/network/downloader;1&quot;]</span>
<a href="#l59.211"></a><span id="l59.211">                                    .createInstance(CI.nsIDownloader);</span>
<a href="#l59.212"></a><span id="l59.212"> </span>
<a href="#l59.213"></a><span id="l59.213">         let savedthis = this;</span>
<a href="#l59.214"></a><span id="l59.214">         let listener = {</span>
<a href="#l59.215"></a><span id="l59.215">             onDownloadComplete: function(opdownloader, request, ctxt, status, result) {</span>
<a href="#l59.216"></a><span id="l59.216">                 if (doInitialBackup) {</span>
<a href="#l59.217"></a><span id="l59.217" class="difflineminus">-                    copyToOverwriting(result, backupDir, makeName('initial'));</span>
<a href="#l59.218"></a><span id="l59.218" class="difflineplus">+                    copyToOverwriting(result, backupDir, makeName(&quot;initial&quot;));</span>
<a href="#l59.219"></a><span id="l59.219">                 }</span>
<a href="#l59.220"></a><span id="l59.220">                 if (doDailyBackup) {</span>
<a href="#l59.221"></a><span id="l59.221">                     copyToOverwriting(result, backupDir, dailyBackupFileName);</span>
<a href="#l59.222"></a><span id="l59.222">                 }</span>
<a href="#l59.223"></a><span id="l59.223"> </span>
<a href="#l59.224"></a><span id="l59.224">                 aCallback.call(savedthis);</span>
<a href="#l59.225"></a><span id="l59.225">             }</span>
<a href="#l59.226"></a><span id="l59.226">         };</span>
<a href="#l59.227"></a><span id="l59.227" class="difflineat">@@ -977,17 +977,17 @@ httpHooks.prototype = {</span>
<a href="#l59.228"></a><span id="l59.228">     },</span>
<a href="#l59.229"></a><span id="l59.229"> </span>
<a href="#l59.230"></a><span id="l59.230">     onBeforePut: function(aChannel) {</span>
<a href="#l59.231"></a><span id="l59.231">         if (this.mEtag) {</span>
<a href="#l59.232"></a><span id="l59.232">             let httpchannel = aChannel.QueryInterface(Components.interfaces.nsIHttpChannel);</span>
<a href="#l59.233"></a><span id="l59.233"> </span>
<a href="#l59.234"></a><span id="l59.234">             // Apache doesn't work correctly with if-match on a PUT method,</span>
<a href="#l59.235"></a><span id="l59.235">             // so use the webdav header</span>
<a href="#l59.236"></a><span id="l59.236" class="difflineminus">-            httpchannel.setRequestHeader(&quot;If&quot;, '([' + this.mEtag + '])', false);</span>
<a href="#l59.237"></a><span id="l59.237" class="difflineplus">+            httpchannel.setRequestHeader(&quot;If&quot;, &quot;([&quot; + this.mEtag + &quot;])&quot;, false);</span>
<a href="#l59.238"></a><span id="l59.238">         }</span>
<a href="#l59.239"></a><span id="l59.239">         return true;</span>
<a href="#l59.240"></a><span id="l59.240">     },</span>
<a href="#l59.241"></a><span id="l59.241"> </span>
<a href="#l59.242"></a><span id="l59.242">     onAfterPut: function(aChannel, aRespFunc) {</span>
<a href="#l59.243"></a><span id="l59.243">         let httpchannel = aChannel.QueryInterface(Components.interfaces.nsIHttpChannel);</span>
<a href="#l59.244"></a><span id="l59.244">         try {</span>
<a href="#l59.245"></a><span id="l59.245">             this.mEtag = httpchannel.getResponseHeader(&quot;ETag&quot;);</span>
<a href="#l59.246"></a><span id="l59.246" class="difflineat">@@ -1018,20 +1018,20 @@ httpHooks.prototype = {</span>
<a href="#l59.247"></a><span id="l59.247">                     cal.LOG(&quot;[calICSCalendar] Failed to fetch channel etag&quot;);</span>
<a href="#l59.248"></a><span id="l59.248">                 }</span>
<a href="#l59.249"></a><span id="l59.249"> </span>
<a href="#l59.250"></a><span id="l59.250">                 thisHook.mEtag = icsXPathFirst(multistatus, &quot;/D:propfind/D:response/D:propstat/D:prop/D:getetag&quot;);</span>
<a href="#l59.251"></a><span id="l59.251">                 aRespFunc();</span>
<a href="#l59.252"></a><span id="l59.252">             };</span>
<a href="#l59.253"></a><span id="l59.253">             let queryXml =</span>
<a href="#l59.254"></a><span id="l59.254">                 '&lt;D:propfind xmlns:D=&quot;DAV:&quot;&gt;' +</span>
<a href="#l59.255"></a><span id="l59.255" class="difflineminus">-                  '&lt;D:prop&gt;' +</span>
<a href="#l59.256"></a><span id="l59.256" class="difflineminus">-                    '&lt;D:getetag/&gt;' +</span>
<a href="#l59.257"></a><span id="l59.257" class="difflineminus">-                  '&lt;/D:prop&gt;' +</span>
<a href="#l59.258"></a><span id="l59.258" class="difflineminus">-                '&lt;/D:propfind&gt;';</span>
<a href="#l59.259"></a><span id="l59.259" class="difflineplus">+                  &quot;&lt;D:prop&gt;&quot; +</span>
<a href="#l59.260"></a><span id="l59.260" class="difflineplus">+                    &quot;&lt;D:getetag/&gt;&quot; +</span>
<a href="#l59.261"></a><span id="l59.261" class="difflineplus">+                  &quot;&lt;/D:prop&gt;&quot; +</span>
<a href="#l59.262"></a><span id="l59.262" class="difflineplus">+                &quot;&lt;/D:propfind&gt;&quot;;</span>
<a href="#l59.263"></a><span id="l59.263"> </span>
<a href="#l59.264"></a><span id="l59.264">             let etagChannel = cal.prepHttpChannel(aChannel.URI, queryXml,</span>
<a href="#l59.265"></a><span id="l59.265">                                                   &quot;text/xml; charset=utf-8&quot;,</span>
<a href="#l59.266"></a><span id="l59.266">                                                   this);</span>
<a href="#l59.267"></a><span id="l59.267">             etagChannel.setRequestHeader(&quot;Depth&quot;, &quot;0&quot;, false);</span>
<a href="#l59.268"></a><span id="l59.268">             etagChannel.requestMethod = &quot;PROPFIND&quot;;</span>
<a href="#l59.269"></a><span id="l59.269">             let streamLoader = Components.classes[&quot;@mozilla.org/network/stream-loader;1&quot;]</span>
<a href="#l59.270"></a><span id="l59.270">                                          .createInstance(Components.interfaces</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1" class="difflineminus">--- a/calendar/providers/storage/calStorageHelpers.jsm</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageHelpers.jsm</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineat">@@ -82,33 +82,33 @@ function dateToText(d) {</span>
<a href="#l60.4"></a><span id="l60.4">  *</span>
<a href="#l60.5"></a><span id="l60.5">  * @param d     The text to transform.</span>
<a href="#l60.6"></a><span id="l60.6">  * @return      The resulting calIDateTime.</span>
<a href="#l60.7"></a><span id="l60.7">  */</span>
<a href="#l60.8"></a><span id="l60.8"> function textToDate(d) {</span>
<a href="#l60.9"></a><span id="l60.9">     let dval;</span>
<a href="#l60.10"></a><span id="l60.10">     let tz = &quot;UTC&quot;;</span>
<a href="#l60.11"></a><span id="l60.11"> </span>
<a href="#l60.12"></a><span id="l60.12" class="difflineminus">-    if (d[0] == 'Z') {</span>
<a href="#l60.13"></a><span id="l60.13" class="difflineplus">+    if (d[0] == &quot;Z&quot;) {</span>
<a href="#l60.14"></a><span id="l60.14">         let strs = d.substr(2).split(&quot;:&quot;);</span>
<a href="#l60.15"></a><span id="l60.15">         dval = parseInt(strs[0], 10);</span>
<a href="#l60.16"></a><span id="l60.16">         tz = strs[1].replace(/%:/g, &quot;:&quot;).replace(/%%/g, &quot;%&quot;);</span>
<a href="#l60.17"></a><span id="l60.17">     } else {</span>
<a href="#l60.18"></a><span id="l60.18">         dval = parseInt(d.substr(2), 10);</span>
<a href="#l60.19"></a><span id="l60.19">     }</span>
<a href="#l60.20"></a><span id="l60.20"> </span>
<a href="#l60.21"></a><span id="l60.21">     let date;</span>
<a href="#l60.22"></a><span id="l60.22" class="difflineminus">-    if (d[0] == 'U' || d[0] == 'Z') {</span>
<a href="#l60.23"></a><span id="l60.23" class="difflineplus">+    if (d[0] == &quot;U&quot; || d[0] == &quot;Z&quot;) {</span>
<a href="#l60.24"></a><span id="l60.24">         date = newDateTime(dval, tz);</span>
<a href="#l60.25"></a><span id="l60.25" class="difflineminus">-    } else if (d[0] == 'L') {</span>
<a href="#l60.26"></a><span id="l60.26" class="difflineplus">+    } else if (d[0] == &quot;L&quot;) {</span>
<a href="#l60.27"></a><span id="l60.27">         // is local time</span>
<a href="#l60.28"></a><span id="l60.28">         date = newDateTime(dval, &quot;floating&quot;);</span>
<a href="#l60.29"></a><span id="l60.29">     }</span>
<a href="#l60.30"></a><span id="l60.30"> </span>
<a href="#l60.31"></a><span id="l60.31" class="difflineminus">-    if (d[1] == 'D') {</span>
<a href="#l60.32"></a><span id="l60.32" class="difflineplus">+    if (d[1] == &quot;D&quot;) {</span>
<a href="#l60.33"></a><span id="l60.33">         date.isDate = true;</span>
<a href="#l60.34"></a><span id="l60.34">     }</span>
<a href="#l60.35"></a><span id="l60.35">     return date;</span>
<a href="#l60.36"></a><span id="l60.36"> }</span>
<a href="#l60.37"></a><span id="l60.37"> </span>
<a href="#l60.38"></a><span id="l60.38"> //</span>
<a href="#l60.39"></a><span id="l60.39"> // other helpers</span>
<a href="#l60.40"></a><span id="l60.40"> //</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1" class="difflineminus">--- a/calendar/providers/storage/calStorageUpgrade.jsm</span>
<a href="#l61.2"></a><span id="l61.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageUpgrade.jsm</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineat">@@ -1369,44 +1369,44 @@ upgrade.v21 = function upgrade_v21(db, v</span>
<a href="#l61.4"></a><span id="l61.4">     beginTransaction(db);</span>
<a href="#l61.5"></a><span id="l61.5"> </span>
<a href="#l61.6"></a><span id="l61.6">     try {</span>
<a href="#l61.7"></a><span id="l61.7">         // The following operation is only important on a live DB, since we are</span>
<a href="#l61.8"></a><span id="l61.8">         // changing only the values on the DB, not the schema itself.</span>
<a href="#l61.9"></a><span id="l61.9">         if (db) {</span>
<a href="#l61.10"></a><span id="l61.10">             // Oh boy, here we go :-)</span>
<a href="#l61.11"></a><span id="l61.11">             // Insert a new row with the following columns...</span>
<a href="#l61.12"></a><span id="l61.12" class="difflineminus">-            let insertSQL = 'INSERT INTO cal_recurrence ' +</span>
<a href="#l61.13"></a><span id="l61.13" class="difflineminus">-                            '            (item_id, cal_id, recur_type, recur_index,' +</span>
<a href="#l61.14"></a><span id="l61.14" class="difflineminus">-                            '             is_negative, dates, end_date, count,' +</span>
<a href="#l61.15"></a><span id="l61.15" class="difflineminus">-                            '             interval, second, minute, hour, day,' +</span>
<a href="#l61.16"></a><span id="l61.16" class="difflineminus">-                            '             monthday, yearday, weekno,  month, setpos)' +</span>
<a href="#l61.17"></a><span id="l61.17" class="difflineplus">+            let insertSQL = &quot;INSERT INTO cal_recurrence &quot; +</span>
<a href="#l61.18"></a><span id="l61.18" class="difflineplus">+                            &quot;            (item_id, cal_id, recur_type, recur_index,&quot; +</span>
<a href="#l61.19"></a><span id="l61.19" class="difflineplus">+                            &quot;             is_negative, dates, end_date, count,&quot; +</span>
<a href="#l61.20"></a><span id="l61.20" class="difflineplus">+                            &quot;             interval, second, minute, hour, day,&quot; +</span>
<a href="#l61.21"></a><span id="l61.21" class="difflineplus">+                            &quot;             monthday, yearday, weekno,  month, setpos)&quot; +</span>
<a href="#l61.22"></a><span id="l61.22">                             // ... by selecting some columns from the existing table ...</span>
<a href="#l61.23"></a><span id="l61.23">                             '     SELECT item_id, cal_id, &quot;x-date&quot; AS recur_type, ' +</span>
<a href="#l61.24"></a><span id="l61.24">                             // ... like a new recur_index, we need it to be maximum for this item ...</span>
<a href="#l61.25"></a><span id="l61.25" class="difflineminus">-                            '            (SELECT MAX(recur_index)+1' +</span>
<a href="#l61.26"></a><span id="l61.26" class="difflineminus">-                            '               FROM cal_recurrence AS rinner ' +</span>
<a href="#l61.27"></a><span id="l61.27" class="difflineminus">-                            '              WHERE rinner.item_id = router.item_id' +</span>
<a href="#l61.28"></a><span id="l61.28" class="difflineminus">-                            '                AND rinner.cal_id = router.cal_id) AS recur_index,' +</span>
<a href="#l61.29"></a><span id="l61.29" class="difflineminus">-                            '            is_negative,' +</span>
<a href="#l61.30"></a><span id="l61.30" class="difflineplus">+                            &quot;            (SELECT MAX(recur_index)+1&quot; +</span>
<a href="#l61.31"></a><span id="l61.31" class="difflineplus">+                            &quot;               FROM cal_recurrence AS rinner &quot; +</span>
<a href="#l61.32"></a><span id="l61.32" class="difflineplus">+                            &quot;              WHERE rinner.item_id = router.item_id&quot; +</span>
<a href="#l61.33"></a><span id="l61.33" class="difflineplus">+                            &quot;                AND rinner.cal_id = router.cal_id) AS recur_index,&quot; +</span>
<a href="#l61.34"></a><span id="l61.34" class="difflineplus">+                            &quot;            is_negative,&quot; +</span>
<a href="#l61.35"></a><span id="l61.35">                             // ... the string until the first comma in the current dates field</span>
<a href="#l61.36"></a><span id="l61.36">                             '            SUBSTR(dates, 0, LENGTH(dates) - LENGTH(LTRIM(dates, REPLACE(dates, &quot;,&quot;, &quot;&quot;))) + 1) AS dates,' +</span>
<a href="#l61.37"></a><span id="l61.37" class="difflineminus">-                            '            end_date, count, interval, second, minute,' +</span>
<a href="#l61.38"></a><span id="l61.38" class="difflineminus">-                            '            hour, day, monthday, yearday, weekno, month,' +</span>
<a href="#l61.39"></a><span id="l61.39" class="difflineminus">-                            '            setpos' +</span>
<a href="#l61.40"></a><span id="l61.40" class="difflineplus">+                            &quot;            end_date, count, interval, second, minute,&quot; +</span>
<a href="#l61.41"></a><span id="l61.41" class="difflineplus">+                            &quot;            hour, day, monthday, yearday, weekno, month,&quot; +</span>
<a href="#l61.42"></a><span id="l61.42" class="difflineplus">+                            &quot;            setpos&quot; +</span>
<a href="#l61.43"></a><span id="l61.43">                             // ... from the recurrence table ...</span>
<a href="#l61.44"></a><span id="l61.44" class="difflineminus">-                            '       FROM cal_recurrence AS router ' +</span>
<a href="#l61.45"></a><span id="l61.45" class="difflineplus">+                            &quot;       FROM cal_recurrence AS router &quot; +</span>
<a href="#l61.46"></a><span id="l61.46">                             // ... but only on fields that are x-datesets ...</span>
<a href="#l61.47"></a><span id="l61.47">                             '      WHERE recur_type = &quot;x-dateset&quot; ' +</span>
<a href="#l61.48"></a><span id="l61.48">                             // ... and are not already empty.</span>
<a href="#l61.49"></a><span id="l61.49">                             '        AND dates != &quot;&quot;';</span>
<a href="#l61.50"></a><span id="l61.50">                             dump(insertSQL + &quot;\n&quot;);</span>
<a href="#l61.51"></a><span id="l61.51"> </span>
<a href="#l61.52"></a><span id="l61.52">             // Now we need to remove the first segment from the dates field</span>
<a href="#l61.53"></a><span id="l61.53" class="difflineminus">-            let updateSQL = 'UPDATE cal_recurrence' +</span>
<a href="#l61.54"></a><span id="l61.54" class="difflineplus">+            let updateSQL = &quot;UPDATE cal_recurrence&quot; +</span>
<a href="#l61.55"></a><span id="l61.55">                             '   SET dates = SUBSTR(dates, LENGTH(dates) - LENGTH(LTRIM(dates, REPLACE(dates, &quot;,&quot;, &quot;&quot;))) + 2)' +</span>
<a href="#l61.56"></a><span id="l61.56">                             ' WHERE recur_type = &quot;x-dateset&quot;' +</span>
<a href="#l61.57"></a><span id="l61.57">                             '   AND dates != &quot;&quot;';</span>
<a href="#l61.58"></a><span id="l61.58"> </span>
<a href="#l61.59"></a><span id="l61.59">             // Create the statements</span>
<a href="#l61.60"></a><span id="l61.60">             let insertStmt = createStatement(db, insertSQL);</span>
<a href="#l61.61"></a><span id="l61.61">             let updateStmt = createStatement(db, updateSQL);</span>
<a href="#l61.62"></a><span id="l61.62"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineat">@@ -500,20 +500,20 @@ calWcapSession.prototype = {</span>
<a href="#l62.4"></a><span id="l62.4">                     let defaultCal = this_.defaultCalendar;</span>
<a href="#l62.5"></a><span id="l62.5">                     if (defaultCal &amp;&amp; cals[defaultCal.calId] &amp;&amp; // default calendar is registered</span>
<a href="#l62.6"></a><span id="l62.6">                         getPref(&quot;calendar.wcap.subscriptions&quot;, true) &amp;&amp;</span>
<a href="#l62.7"></a><span id="l62.7">                         !defaultCal.getProperty(&quot;subscriptions_registered&quot;)) {</span>
<a href="#l62.8"></a><span id="l62.8">                         let hasSubscriptions = false;</span>
<a href="#l62.9"></a><span id="l62.9">                         // post register subscribed calendars:</span>
<a href="#l62.10"></a><span id="l62.10">                         let list = this_.getUserPreferences(&quot;X-NSCP-WCAP-PREF-icsSubscribed&quot;);</span>
<a href="#l62.11"></a><span id="l62.11">                         for (let item of list) {</span>
<a href="#l62.12"></a><span id="l62.12" class="difflineminus">-                            let ar = item.split(',');</span>
<a href="#l62.13"></a><span id="l62.13" class="difflineplus">+                            let ar = item.split(&quot;,&quot;);</span>
<a href="#l62.14"></a><span id="l62.14">                             // ',', '$' are not encoded. ',' can be handled here. WTF.</span>
<a href="#l62.15"></a><span id="l62.15">                             for (let a of ar) {</span>
<a href="#l62.16"></a><span id="l62.16" class="difflineminus">-                                let dollar = a.indexOf('$');</span>
<a href="#l62.17"></a><span id="l62.17" class="difflineplus">+                                let dollar = a.indexOf(&quot;$&quot;);</span>
<a href="#l62.18"></a><span id="l62.18">                                 if (dollar &gt;= 0) {</span>
<a href="#l62.19"></a><span id="l62.19">                                     let calId = a.substring(0, dollar);</span>
<a href="#l62.20"></a><span id="l62.20">                                     if (calId != this_.defaultCalId) {</span>
<a href="#l62.21"></a><span id="l62.21">                                         cals[calId] = null;</span>
<a href="#l62.22"></a><span id="l62.22">                                         hasSubscriptions = true;</span>
<a href="#l62.23"></a><span id="l62.23">                                     }</span>
<a href="#l62.24"></a><span id="l62.24">                                 }</span>
<a href="#l62.25"></a><span id="l62.25">                             }</span>
<a href="#l62.26"></a><span id="l62.26" class="difflineat">@@ -641,17 +641,17 @@ calWcapSession.prototype = {</span>
<a href="#l62.27"></a><span id="l62.27">                                 }</span>
<a href="#l62.28"></a><span id="l62.28">                             }</span>
<a href="#l62.29"></a><span id="l62.29">                         } catch (exc) { // ignore but log any errors on subscribed calendars:</span>
<a href="#l62.30"></a><span id="l62.30">                             logError(exc, this_);</span>
<a href="#l62.31"></a><span id="l62.31">                         }</span>
<a href="#l62.32"></a><span id="l62.32">                     }</span>
<a href="#l62.33"></a><span id="l62.33">                 };</span>
<a href="#l62.34"></a><span id="l62.34"> </span>
<a href="#l62.35"></a><span id="l62.35" class="difflineminus">-                let colon = calId.indexOf(':');</span>
<a href="#l62.36"></a><span id="l62.36" class="difflineplus">+                let colon = calId.indexOf(&quot;:&quot;);</span>
<a href="#l62.37"></a><span id="l62.37">                 if (colon &gt;= 0) { // searching for secondary calendars doesn't work. WTF.</span>
<a href="#l62.38"></a><span id="l62.38">                     calId = calId.substring(0, colon);</span>
<a href="#l62.39"></a><span id="l62.39">                 }</span>
<a href="#l62.40"></a><span id="l62.40">                 if (!issuedSearchRequests[calId]) {</span>
<a href="#l62.41"></a><span id="l62.41">                     issuedSearchRequests[calId] = true;</span>
<a href="#l62.42"></a><span id="l62.42">                     this.searchForCalendars(calId, calICalendarSearchProvider.HINT_EXACT_MATCH, 20, listener);</span>
<a href="#l62.43"></a><span id="l62.43">                 }</span>
<a href="#l62.44"></a><span id="l62.44">             }</span>
<a href="#l62.45"></a><span id="l62.45" class="difflineat">@@ -1016,17 +1016,17 @@ calWcapSession.prototype = {</span>
<a href="#l62.46"></a><span id="l62.46">                         for (let i = 0; i &lt; nodeList.length; ++i) {</span>
<a href="#l62.47"></a><span id="l62.47">                             let node = nodeList.item(i);</span>
<a href="#l62.48"></a><span id="l62.48">                             let fbType = fbTypeMap[node.attributes.getNamedItem(&quot;FBTYPE&quot;).nodeValue];</span>
<a href="#l62.49"></a><span id="l62.49">                             if (!fbType || (fbType &amp; busyTypes)) {</span>
<a href="#l62.50"></a><span id="l62.50">                                 if (!fbType) {</span>
<a href="#l62.51"></a><span id="l62.51">                                     fbType = calIFreeBusyInterval.UNKNOWN;</span>
<a href="#l62.52"></a><span id="l62.52">                                 }</span>
<a href="#l62.53"></a><span id="l62.53">                                 let str = node.textContent;</span>
<a href="#l62.54"></a><span id="l62.54" class="difflineminus">-                                let slash = str.indexOf('/');</span>
<a href="#l62.55"></a><span id="l62.55" class="difflineplus">+                                let slash = str.indexOf(&quot;/&quot;);</span>
<a href="#l62.56"></a><span id="l62.56">                                 let start = getDatetimeFromIcalString(str.substr(0, slash));</span>
<a href="#l62.57"></a><span id="l62.57">                                 let end = getDatetimeFromIcalString(str.substr(slash + 1));</span>
<a href="#l62.58"></a><span id="l62.58"> </span>
<a href="#l62.59"></a><span id="l62.59">                                 ret.push(new cal.FreeBusyInterval(calId, fbType, start, end));</span>
<a href="#l62.60"></a><span id="l62.60">                             }</span>
<a href="#l62.61"></a><span id="l62.61">                         }</span>
<a href="#l62.62"></a><span id="l62.62">                         request.execRespFunc(null, ret);</span>
<a href="#l62.63"></a><span id="l62.63">                     }</span>
<a href="#l62.64"></a><span id="l62.64" class="difflineat">@@ -1115,19 +1115,19 @@ calWcapSession.prototype = {</span>
<a href="#l62.65"></a><span id="l62.65">     onCalendarDeleting: function calWcapSession_onCalendarDeleting(aCalendar) {</span>
<a href="#l62.66"></a><span id="l62.66">     }</span>
<a href="#l62.67"></a><span id="l62.67"> };</span>
<a href="#l62.68"></a><span id="l62.68"> </span>
<a href="#l62.69"></a><span id="l62.69"> function confirmInsecureLogin(uri) {</span>
<a href="#l62.70"></a><span id="l62.70">     if (!confirmInsecureLogin.m_confirmedHttpLogins) {</span>
<a href="#l62.71"></a><span id="l62.71">         confirmInsecureLogin.m_confirmedHttpLogins = {};</span>
<a href="#l62.72"></a><span id="l62.72">         let confirmedHttpLogins = getPref(&quot;calendar.wcap.confirmed_http_logins&quot;, &quot;&quot;);</span>
<a href="#l62.73"></a><span id="l62.73" class="difflineminus">-        let tuples = confirmedHttpLogins.split(',');</span>
<a href="#l62.74"></a><span id="l62.74" class="difflineplus">+        let tuples = confirmedHttpLogins.split(&quot;,&quot;);</span>
<a href="#l62.75"></a><span id="l62.75">         for (let tuple of tuples) {</span>
<a href="#l62.76"></a><span id="l62.76" class="difflineminus">-            let ar = tuple.split(':');</span>
<a href="#l62.77"></a><span id="l62.77" class="difflineplus">+            let ar = tuple.split(&quot;:&quot;);</span>
<a href="#l62.78"></a><span id="l62.78">             confirmInsecureLogin.m_confirmedHttpLogins[ar[0]] = ar[1];</span>
<a href="#l62.79"></a><span id="l62.79">         }</span>
<a href="#l62.80"></a><span id="l62.80">     }</span>
<a href="#l62.81"></a><span id="l62.81"> </span>
<a href="#l62.82"></a><span id="l62.82">     let bConfirmed = false;</span>
<a href="#l62.83"></a><span id="l62.83"> </span>
<a href="#l62.84"></a><span id="l62.84">     let host = uri.hostPort;</span>
<a href="#l62.85"></a><span id="l62.85">     let encodedHost = encodeURIComponent(host);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1" class="difflineminus">--- a/calendar/resources/content/calendarCreation.js</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineplus">+++ b/calendar/resources/content/calendarCreation.js</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineat">@@ -97,68 +97,68 @@ function onSelectProvider(type) {</span>
<a href="#l63.4"></a><span id="l63.4"> }</span>
<a href="#l63.5"></a><span id="l63.5"> </span>
<a href="#l63.6"></a><span id="l63.6"> /**</span>
<a href="#l63.7"></a><span id="l63.7">  * Checks if the required information is set so that the wizard can advance. On</span>
<a href="#l63.8"></a><span id="l63.8">  * an error, notifications are shown and the wizard can not be advanced.</span>
<a href="#l63.9"></a><span id="l63.9">  */</span>
<a href="#l63.10"></a><span id="l63.10"> function checkRequired() {</span>
<a href="#l63.11"></a><span id="l63.11">     let canAdvance = true;</span>
<a href="#l63.12"></a><span id="l63.12" class="difflineminus">-    let curPage = document.getElementById('calendar-wizard').currentPage;</span>
<a href="#l63.13"></a><span id="l63.13" class="difflineplus">+    let curPage = document.getElementById(&quot;calendar-wizard&quot;).currentPage;</span>
<a href="#l63.14"></a><span id="l63.14">     if (curPage) {</span>
<a href="#l63.15"></a><span id="l63.15" class="difflineminus">-        let eList = curPage.getElementsByAttribute('required', 'true');</span>
<a href="#l63.16"></a><span id="l63.16" class="difflineplus">+        let eList = curPage.getElementsByAttribute(&quot;required&quot;, &quot;true&quot;);</span>
<a href="#l63.17"></a><span id="l63.17">         for (let i = 0; i &lt; eList.length &amp;&amp; canAdvance; ++i) {</span>
<a href="#l63.18"></a><span id="l63.18">             canAdvance = (eList[i].value != &quot;&quot;);</span>
<a href="#l63.19"></a><span id="l63.19">         }</span>
<a href="#l63.20"></a><span id="l63.20"> </span>
<a href="#l63.21"></a><span id="l63.21">         let notificationbox = document.getElementById(&quot;location-notifications&quot;);</span>
<a href="#l63.22"></a><span id="l63.22">         if (canAdvance &amp;&amp; document.getElementById(&quot;calendar-uri&quot;).value &amp;&amp;</span>
<a href="#l63.23"></a><span id="l63.23">                 curPage. pageid == &quot;locationPage&quot;) {</span>
<a href="#l63.24"></a><span id="l63.24">             // eslint-disable-next-line array-bracket-spacing</span>
<a href="#l63.25"></a><span id="l63.25">             let [reason, ] = parseUri(document.getElementById(&quot;calendar-uri&quot;).value);</span>
<a href="#l63.26"></a><span id="l63.26">             canAdvance = (reason == errorConstants.SUCCESS);</span>
<a href="#l63.27"></a><span id="l63.27">             setNotification(reason);</span>
<a href="#l63.28"></a><span id="l63.28">         } else {</span>
<a href="#l63.29"></a><span id="l63.29">             notificationbox.removeAllNotifications();</span>
<a href="#l63.30"></a><span id="l63.30">         }</span>
<a href="#l63.31"></a><span id="l63.31" class="difflineminus">-        document.getElementById('calendar-wizard').canAdvance = canAdvance;</span>
<a href="#l63.32"></a><span id="l63.32" class="difflineplus">+        document.getElementById(&quot;calendar-wizard&quot;).canAdvance = canAdvance;</span>
<a href="#l63.33"></a><span id="l63.33">     }</span>
<a href="#l63.34"></a><span id="l63.34"> }</span>
<a href="#l63.35"></a><span id="l63.35"> </span>
<a href="#l63.36"></a><span id="l63.36"> /**</span>
<a href="#l63.37"></a><span id="l63.37">  * Handler function called when the advance button is pressed on the initial</span>
<a href="#l63.38"></a><span id="l63.38">  * wizard page</span>
<a href="#l63.39"></a><span id="l63.39">  */</span>
<a href="#l63.40"></a><span id="l63.40"> function onInitialAdvance() {</span>
<a href="#l63.41"></a><span id="l63.41" class="difflineminus">-    let type = document.getElementById('calendar-type').selectedItem.value;</span>
<a href="#l63.42"></a><span id="l63.42" class="difflineminus">-    let page = document.getElementsByAttribute('pageid', 'initialPage')[0];</span>
<a href="#l63.43"></a><span id="l63.43" class="difflineminus">-    if (type == 'local') {</span>
<a href="#l63.44"></a><span id="l63.44" class="difflineplus">+    let type = document.getElementById(&quot;calendar-type&quot;).selectedItem.value;</span>
<a href="#l63.45"></a><span id="l63.45" class="difflineplus">+    let page = document.getElementsByAttribute(&quot;pageid&quot;, &quot;initialPage&quot;)[0];</span>
<a href="#l63.46"></a><span id="l63.46" class="difflineplus">+    if (type == &quot;local&quot;) {</span>
<a href="#l63.47"></a><span id="l63.47">         prepareCreateCalendar();</span>
<a href="#l63.48"></a><span id="l63.48" class="difflineminus">-        page.next = 'customizePage';</span>
<a href="#l63.49"></a><span id="l63.49" class="difflineplus">+        page.next = &quot;customizePage&quot;;</span>
<a href="#l63.50"></a><span id="l63.50">     } else {</span>
<a href="#l63.51"></a><span id="l63.51" class="difflineminus">-        page.next = 'locationPage';</span>
<a href="#l63.52"></a><span id="l63.52" class="difflineplus">+        page.next = &quot;locationPage&quot;;</span>
<a href="#l63.53"></a><span id="l63.53">     }</span>
<a href="#l63.54"></a><span id="l63.54"> }</span>
<a href="#l63.55"></a><span id="l63.55"> </span>
<a href="#l63.56"></a><span id="l63.56"> /**</span>
<a href="#l63.57"></a><span id="l63.57">  * Create the calendar, so that the customize page can already check for</span>
<a href="#l63.58"></a><span id="l63.58">  * calendar capabilities of the provider.</span>
<a href="#l63.59"></a><span id="l63.59">  */</span>
<a href="#l63.60"></a><span id="l63.60"> function prepareCreateCalendar() {</span>
<a href="#l63.61"></a><span id="l63.61">     gCalendar = null;</span>
<a href="#l63.62"></a><span id="l63.62"> </span>
<a href="#l63.63"></a><span id="l63.63">     let provider;</span>
<a href="#l63.64"></a><span id="l63.64">     let url;</span>
<a href="#l63.65"></a><span id="l63.65">     let reason;</span>
<a href="#l63.66"></a><span id="l63.66" class="difflineminus">-    let type = document.getElementById('calendar-type').selectedItem.value;</span>
<a href="#l63.67"></a><span id="l63.67" class="difflineminus">-    if (type == 'local') {</span>
<a href="#l63.68"></a><span id="l63.68" class="difflineminus">-        provider = 'storage';</span>
<a href="#l63.69"></a><span id="l63.69" class="difflineminus">-        [reason, url] = parseUri('moz-storage-calendar://');</span>
<a href="#l63.70"></a><span id="l63.70" class="difflineplus">+    let type = document.getElementById(&quot;calendar-type&quot;).selectedItem.value;</span>
<a href="#l63.71"></a><span id="l63.71" class="difflineplus">+    if (type == &quot;local&quot;) {</span>
<a href="#l63.72"></a><span id="l63.72" class="difflineplus">+        provider = &quot;storage&quot;;</span>
<a href="#l63.73"></a><span id="l63.73" class="difflineplus">+        [reason, url] = parseUri(&quot;moz-storage-calendar://&quot;);</span>
<a href="#l63.74"></a><span id="l63.74">     } else {</span>
<a href="#l63.75"></a><span id="l63.75" class="difflineminus">-        provider = document.getElementById('calendar-format').selectedItem.value;</span>
<a href="#l63.76"></a><span id="l63.76" class="difflineplus">+        provider = document.getElementById(&quot;calendar-format&quot;).selectedItem.value;</span>
<a href="#l63.77"></a><span id="l63.77">         [reason, url] = parseUri(document.getElementById(&quot;calendar-uri&quot;).value);</span>
<a href="#l63.78"></a><span id="l63.78">     }</span>
<a href="#l63.79"></a><span id="l63.79"> </span>
<a href="#l63.80"></a><span id="l63.80">     if (reason != errorConstants.SUCCESS || !url) {</span>
<a href="#l63.81"></a><span id="l63.81">         return false;</span>
<a href="#l63.82"></a><span id="l63.82">     }</span>
<a href="#l63.83"></a><span id="l63.83"> </span>
<a href="#l63.84"></a><span id="l63.84">     try {</span>
<a href="#l63.85"></a><span id="l63.85" class="difflineat">@@ -174,24 +174,24 @@ function prepareCreateCalendar() {</span>
<a href="#l63.86"></a><span id="l63.86"> /**</span>
<a href="#l63.87"></a><span id="l63.87">  * The actual process of registering the created calendar.</span>
<a href="#l63.88"></a><span id="l63.88">  */</span>
<a href="#l63.89"></a><span id="l63.89"> function doCreateCalendar() {</span>
<a href="#l63.90"></a><span id="l63.90">     let cal_name = document.getElementById(&quot;calendar-name&quot;).value;</span>
<a href="#l63.91"></a><span id="l63.91">     let cal_color = document.getElementById(&quot;calendar-color&quot;).value;</span>
<a href="#l63.92"></a><span id="l63.92"> </span>
<a href="#l63.93"></a><span id="l63.93">     gCalendar.name = cal_name;</span>
<a href="#l63.94"></a><span id="l63.94" class="difflineminus">-    gCalendar.setProperty('color', cal_color);</span>
<a href="#l63.95"></a><span id="l63.95" class="difflineplus">+    gCalendar.setProperty(&quot;color&quot;, cal_color);</span>
<a href="#l63.96"></a><span id="l63.96">     if (!gCalendar.getProperty(&quot;cache.always&quot;)) {</span>
<a href="#l63.97"></a><span id="l63.97">         gCalendar.setProperty(&quot;cache.enabled&quot;, gCalendar.getProperty(&quot;cache.supported&quot;) !== false ?</span>
<a href="#l63.98"></a><span id="l63.98">                                                document.getElementById(&quot;cache&quot;).checked : false);</span>
<a href="#l63.99"></a><span id="l63.99">     }</span>
<a href="#l63.100"></a><span id="l63.100"> </span>
<a href="#l63.101"></a><span id="l63.101">     if (!document.getElementById(&quot;fire-alarms&quot;).checked) {</span>
<a href="#l63.102"></a><span id="l63.102" class="difflineminus">-        gCalendar.setProperty('suppressAlarms', true);</span>
<a href="#l63.103"></a><span id="l63.103" class="difflineplus">+        gCalendar.setProperty(&quot;suppressAlarms&quot;, true);</span>
<a href="#l63.104"></a><span id="l63.104">     }</span>
<a href="#l63.105"></a><span id="l63.105"> </span>
<a href="#l63.106"></a><span id="l63.106">     cal.getCalendarManager().registerCalendar(gCalendar);</span>
<a href="#l63.107"></a><span id="l63.107">     return true;</span>
<a href="#l63.108"></a><span id="l63.108"> }</span>
<a href="#l63.109"></a><span id="l63.109"> </span>
<a href="#l63.110"></a><span id="l63.110"> /**</span>
<a href="#l63.111"></a><span id="l63.111">  * Initializes the calendar name from its uri</span>
<a href="#l63.112"></a><span id="l63.112" class="difflineat">@@ -224,26 +224,26 @@ function parseUri(aUri) {</span>
<a href="#l63.113"></a><span id="l63.113">         // Test if the entered uri can be parsed.</span>
<a href="#l63.114"></a><span id="l63.114">         uri = makeURL(aUri);</span>
<a href="#l63.115"></a><span id="l63.115">     } catch (ex) {</span>
<a href="#l63.116"></a><span id="l63.116">         return [errorConstants.INVALID_URI, null];</span>
<a href="#l63.117"></a><span id="l63.117">     }</span>
<a href="#l63.118"></a><span id="l63.118"> </span>
<a href="#l63.119"></a><span id="l63.119">     let calManager = cal.getCalendarManager();</span>
<a href="#l63.120"></a><span id="l63.120">     let cals = calManager.getCalendars({});</span>
<a href="#l63.121"></a><span id="l63.121" class="difflineminus">-    let type = document.getElementById('calendar-type').selectedItem.value;</span>
<a href="#l63.122"></a><span id="l63.122" class="difflineminus">-    if (type != 'local' &amp;&amp; cals.some(c =&gt; c.uri.spec == uri.spec)) {</span>
<a href="#l63.123"></a><span id="l63.123" class="difflineplus">+    let type = document.getElementById(&quot;calendar-type&quot;).selectedItem.value;</span>
<a href="#l63.124"></a><span id="l63.124" class="difflineplus">+    if (type != &quot;local&quot; &amp;&amp; cals.some(c =&gt; c.uri.spec == uri.spec)) {</span>
<a href="#l63.125"></a><span id="l63.125">         // If the calendar is not local, we check if there is already a calendar</span>
<a href="#l63.126"></a><span id="l63.126">         // with the same uri spec. Storage calendars all have the same uri, so</span>
<a href="#l63.127"></a><span id="l63.127">         // we have to specialcase them.</span>
<a href="#l63.128"></a><span id="l63.128">         return [errorConstants.ALREADY_EXISTS, null];</span>
<a href="#l63.129"></a><span id="l63.129">     }</span>
<a href="#l63.130"></a><span id="l63.130"> </span>
<a href="#l63.131"></a><span id="l63.131">     return [errorConstants.SUCCESS, uri];</span>
<a href="#l63.132"></a><span id="l63.132"> }</span>
<a href="#l63.133"></a><span id="l63.133"> </span>
<a href="#l63.134"></a><span id="l63.134"> /**</span>
<a href="#l63.135"></a><span id="l63.135">  * Disables the back button, in case we are far enough that its not possible to</span>
<a href="#l63.136"></a><span id="l63.136">  * undo.</span>
<a href="#l63.137"></a><span id="l63.137">  */</span>
<a href="#l63.138"></a><span id="l63.138"> function setCanRewindFalse() {</span>
<a href="#l63.139"></a><span id="l63.139" class="difflineminus">-   document.getElementById('calendar-wizard').canRewind = false;</span>
<a href="#l63.140"></a><span id="l63.140" class="difflineplus">+   document.getElementById(&quot;calendar-wizard&quot;).canRewind = false;</span>
<a href="#l63.141"></a><span id="l63.141"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1" class="difflineminus">--- a/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineplus">+++ b/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineat">@@ -154,43 +154,43 @@</span>
<a href="#l64.4"></a><span id="l64.4">                let offset = (i - today.weekday + 7) % 7;</span>
<a href="#l64.5"></a><span id="l64.5">                today.day = today.day + offset;</span>
<a href="#l64.6"></a><span id="l64.6">                return cal.dateTimeToJsDate(today);</span>
<a href="#l64.7"></a><span id="l64.7">              }</span>
<a href="#l64.8"></a><span id="l64.8">              return null;</span>
<a href="#l64.9"></a><span id="l64.9">            }</span>
<a href="#l64.10"></a><span id="l64.10"> </span>
<a href="#l64.11"></a><span id="l64.11">            // Remove commas</span>
<a href="#l64.12"></a><span id="l64.12" class="difflineminus">-           val = val.replace(',', '');</span>
<a href="#l64.13"></a><span id="l64.13" class="difflineplus">+           val = val.replace(&quot;,&quot;, &quot;&quot;);</span>
<a href="#l64.14"></a><span id="l64.14"> </span>
<a href="#l64.15"></a><span id="l64.15" class="difflineminus">-           if (!val.includes(' ')) {</span>
<a href="#l64.16"></a><span id="l64.16" class="difflineplus">+           if (!val.includes(&quot; &quot;)) {</span>
<a href="#l64.17"></a><span id="l64.17">              // Just a single word, or a single date.</span>
<a href="#l64.18"></a><span id="l64.18">              return getDateForDay(val);</span>
<a href="#l64.19"></a><span id="l64.19">            }</span>
<a href="#l64.20"></a><span id="l64.20"> </span>
<a href="#l64.21"></a><span id="l64.21">            // Replace month names with numbers</span>
<a href="#l64.22"></a><span id="l64.22">            for (let i in this.mMonthLongNames) {</span>
<a href="#l64.23"></a><span id="l64.23">              if (val.includes(this.mMonthLongNames[i])) {</span>
<a href="#l64.24"></a><span id="l64.24">                let newVal = val.replace(this.mMonthLongNames[i], Number(i) + 1);</span>
<a href="#l64.25"></a><span id="l64.25" class="difflineminus">-               newVal = newVal.replace(' ', '/');</span>
<a href="#l64.26"></a><span id="l64.26" class="difflineplus">+               newVal = newVal.replace(&quot; &quot;, &quot;/&quot;);</span>
<a href="#l64.27"></a><span id="l64.27">                return this.parseDateTime(newVal);</span>
<a href="#l64.28"></a><span id="l64.28">              }</span>
<a href="#l64.29"></a><span id="l64.29">           }</span>
<a href="#l64.30"></a><span id="l64.30"> </span>
<a href="#l64.31"></a><span id="l64.31">           // Same for short month names</span>
<a href="#l64.32"></a><span id="l64.32">            for (let i in this.mMonthShortNames) {</span>
<a href="#l64.33"></a><span id="l64.33">              if (val.includes(this.mMonthShortNames[i])) {</span>
<a href="#l64.34"></a><span id="l64.34">                let newVal = val.replace(this.mMonthShortNames[i], Number(i) + 1);</span>
<a href="#l64.35"></a><span id="l64.35" class="difflineminus">-               newVal = newVal.replace(' ', '/');</span>
<a href="#l64.36"></a><span id="l64.36" class="difflineplus">+               newVal = newVal.replace(&quot; &quot;, &quot;/&quot;);</span>
<a href="#l64.37"></a><span id="l64.37">                return this.parseDateTime(newVal);</span>
<a href="#l64.38"></a><span id="l64.38">              }</span>
<a href="#l64.39"></a><span id="l64.39">           }</span>
<a href="#l64.40"></a><span id="l64.40"> </span>
<a href="#l64.41"></a><span id="l64.41">           // Now for the cool 'next' and 'last'</span>
<a href="#l64.42"></a><span id="l64.42" class="difflineminus">-          let words = val.split(' ');</span>
<a href="#l64.43"></a><span id="l64.43" class="difflineplus">+          let words = val.split(&quot; &quot;);</span>
<a href="#l64.44"></a><span id="l64.44">           let offset, day;</span>
<a href="#l64.45"></a><span id="l64.45">           for (let word of words) {</span>
<a href="#l64.46"></a><span id="l64.46">             for (let rel of this.mRelationWords) {</span>
<a href="#l64.47"></a><span id="l64.47">               if (word == rel.word) {</span>
<a href="#l64.48"></a><span id="l64.48">                 offset = rel.offset;</span>
<a href="#l64.49"></a><span id="l64.49">                 break;</span>
<a href="#l64.50"></a><span id="l64.50">               }</span>
<a href="#l64.51"></a><span id="l64.51">             }</span>
<a href="#l64.52"></a><span id="l64.52" class="difflineat">@@ -615,17 +615,17 @@</span>
<a href="#l64.53"></a><span id="l64.53">                               this.mValue.getMinutes() != aValue.getMinutes();</span>
<a href="#l64.54"></a><span id="l64.54">               }</span>
<a href="#l64.55"></a><span id="l64.55">               this.mValue = aValue;</span>
<a href="#l64.56"></a><span id="l64.56">             }</span>
<a href="#l64.57"></a><span id="l64.57">             // set textBox.value property, not attribute</span>
<a href="#l64.58"></a><span id="l64.58">             this.kTextBox.value = this.formatTime(this.mValue);</span>
<a href="#l64.59"></a><span id="l64.59"> </span>
<a href="#l64.60"></a><span id="l64.60">             if (aValue != null &amp;&amp; aRefresh &amp;&amp; timeChanged) {</span>
<a href="#l64.61"></a><span id="l64.61" class="difflineminus">-              let event = document.createEvent('Events');</span>
<a href="#l64.62"></a><span id="l64.62" class="difflineplus">+              let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l64.63"></a><span id="l64.63">               event.initEvent(&quot;change&quot;, true, true);</span>
<a href="#l64.64"></a><span id="l64.64">               this.dispatchEvent(event);</span>
<a href="#l64.65"></a><span id="l64.65">             }</span>
<a href="#l64.66"></a><span id="l64.66">           ]]&gt;</span>
<a href="#l64.67"></a><span id="l64.67">         &lt;/body&gt;</span>
<a href="#l64.68"></a><span id="l64.68">       &lt;/method&gt;</span>
<a href="#l64.69"></a><span id="l64.69"> </span>
<a href="#l64.70"></a><span id="l64.70">       &lt;method name=&quot;parseTextBoxTime&quot;&gt;</span>
<a href="#l64.71"></a><span id="l64.71" class="difflineat">@@ -1320,17 +1320,17 @@</span>
<a href="#l64.72"></a><span id="l64.72"> </span>
<a href="#l64.73"></a><span id="l64.73">             let idPrefix = &quot;time-picker-one-minute-box-&quot;;</span>
<a href="#l64.74"></a><span id="l64.74"> </span>
<a href="#l64.75"></a><span id="l64.75">             // Everything above assumes that we are showing the one-minute-grid,</span>
<a href="#l64.76"></a><span id="l64.76">             // If not, we need to do these corrections;</span>
<a href="#l64.77"></a><span id="l64.77">             let fiveMinuteBox = document.getAnonymousElementByAttribute(</span>
<a href="#l64.78"></a><span id="l64.78">                                 this, &quot;anonid&quot;, &quot;time-picker-five-minute-grid-box&quot;);</span>
<a href="#l64.79"></a><span id="l64.79"> </span>
<a href="#l64.80"></a><span id="l64.80" class="difflineminus">-            if (fiveMinuteBox.getAttribute(&quot;hidden&quot;) == 'false') {</span>
<a href="#l64.81"></a><span id="l64.81" class="difflineplus">+            if (fiveMinuteBox.getAttribute(&quot;hidden&quot;) == &quot;false&quot;) {</span>
<a href="#l64.82"></a><span id="l64.82">               aNumber *= 5;</span>
<a href="#l64.83"></a><span id="l64.83">               idPrefix = &quot;time-picker-five-minute-box-&quot;;</span>
<a href="#l64.84"></a><span id="l64.84"> </span>
<a href="#l64.85"></a><span id="l64.85">               // If the detailed view was shown before, then mSelectedTime.getMinutes</span>
<a href="#l64.86"></a><span id="l64.86">               // might not be a multiple of 5.</span>
<a href="#l64.87"></a><span id="l64.87">               this.mSelectedTime.setMinutes(this.calcNearestFiveMinutes(this.mSelectedTime));</span>
<a href="#l64.88"></a><span id="l64.88">             }</span>
<a href="#l64.89"></a><span id="l64.89"> </span>
<a href="#l64.90"></a><span id="l64.90" class="difflineat">@@ -1577,17 +1577,17 @@</span>
<a href="#l64.91"></a><span id="l64.91">         &lt;/body&gt;</span>
<a href="#l64.92"></a><span id="l64.92">       &lt;/method&gt;</span>
<a href="#l64.93"></a><span id="l64.93"> </span>
<a href="#l64.94"></a><span id="l64.94">       &lt;method name=&quot;fireEvent&quot;&gt;</span>
<a href="#l64.95"></a><span id="l64.95">         &lt;parameter name=&quot;aEventName&quot;/&gt;</span>
<a href="#l64.96"></a><span id="l64.96">         &lt;parameter name=&quot;aDetail&quot;/&gt;</span>
<a href="#l64.97"></a><span id="l64.97">         &lt;body&gt;</span>
<a href="#l64.98"></a><span id="l64.98">           &lt;![CDATA[</span>
<a href="#l64.99"></a><span id="l64.99" class="difflineminus">-            let event = document.createEvent('Events');</span>
<a href="#l64.100"></a><span id="l64.100" class="difflineplus">+            let event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l64.101"></a><span id="l64.101">             event.initEvent(aEventName, true, true);</span>
<a href="#l64.102"></a><span id="l64.102">             event.detail = aDetail;</span>
<a href="#l64.103"></a><span id="l64.103">             this.dispatchEvent(event);</span>
<a href="#l64.104"></a><span id="l64.104">           ]]&gt;</span>
<a href="#l64.105"></a><span id="l64.105">         &lt;/body&gt;</span>
<a href="#l64.106"></a><span id="l64.106">       &lt;/method&gt;</span>
<a href="#l64.107"></a><span id="l64.107"> </span>
<a href="#l64.108"></a><span id="l64.108">       &lt;!-- Parameter aValue may be a date or a date time. Dates are</span>
<a href="#l64.109"></a><span id="l64.109" class="difflineat">@@ -1953,17 +1953,17 @@</span>
<a href="#l64.110"></a><span id="l64.110">             // matches the &quot;p&quot; character so only &quot;m&quot; is matched as ampm suffix.)</span>
<a href="#l64.111"></a><span id="l64.111">             //</span>
<a href="#l64.112"></a><span id="l64.112">             // digitsExpr has 6 captures, so index of first ampmExpr is 1, of last is 8.</span>
<a href="#l64.113"></a><span id="l64.113">             this.parseTimeRegExp =</span>
<a href="#l64.114"></a><span id="l64.114">               new RegExp(&quot;(&quot; + ampmExpr + &quot;)?\\s?&quot; + digitsExpr + &quot;(&quot; + ampmExpr + &quot;)?\\s*$&quot;);</span>
<a href="#l64.115"></a><span id="l64.115">             this.amRegExp = new RegExp(&quot;^(?:&quot; + amExpr + &quot;)$&quot;);</span>
<a href="#l64.116"></a><span id="l64.116">             this.pmRegExp = new RegExp(&quot;^(?:&quot; + pmExpr + &quot;)$&quot;);</span>
<a href="#l64.117"></a><span id="l64.117">             // build time display format that mimics &quot;%x&quot; format without seconds</span>
<a href="#l64.118"></a><span id="l64.118" class="difflineminus">-            let ampmSep = (pmProbeString.includes(' ') ? &quot; &quot; : &quot;&quot;);</span>
<a href="#l64.119"></a><span id="l64.119" class="difflineplus">+            let ampmSep = (pmProbeString.includes(&quot; &quot;) ? &quot; &quot; : &quot;&quot;);</span>
<a href="#l64.120"></a><span id="l64.120">             if (this.ampmIndex == PRE_INDEX) {</span>
<a href="#l64.121"></a><span id="l64.121">               this.kTimeFormatString = &quot;%p&quot; + ampmSep + &quot;%I:%M&quot;;</span>
<a href="#l64.122"></a><span id="l64.122">             } else if (this.ampmIndex == POST_INDEX) {</span>
<a href="#l64.123"></a><span id="l64.123">               this.kTimeFormatString = &quot;%I:%M&quot; + ampmSep + &quot;%p&quot;;</span>
<a href="#l64.124"></a><span id="l64.124">             } else {</span>
<a href="#l64.125"></a><span id="l64.125">               this.kTimeFormatString = &quot;%H:%M&quot;;</span>
<a href="#l64.126"></a><span id="l64.126">             }</span>
<a href="#l64.127"></a><span id="l64.127">           ]]&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1" class="difflineminus">--- a/calendar/resources/content/mouseoverPreviews.js</span>
<a href="#l65.2"></a><span id="l65.2" class="difflineplus">+++ b/calendar/resources/content/mouseoverPreviews.js</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineat">@@ -89,21 +89,21 @@ function getPreviewForTask(toDoItem) {</span>
<a href="#l65.4"></a><span id="l65.4">     }</span>
<a href="#l65.5"></a><span id="l65.5"> </span>
<a href="#l65.6"></a><span id="l65.6">     if (toDoItem.priority &amp;&amp; toDoItem.priority != 0) {</span>
<a href="#l65.7"></a><span id="l65.7">       let priorityInteger = parseInt(toDoItem.priority, 10);</span>
<a href="#l65.8"></a><span id="l65.8">       let priorityString;</span>
<a href="#l65.9"></a><span id="l65.9"> </span>
<a href="#l65.10"></a><span id="l65.10">       // These cut-offs should match calendar-event-dialog.js</span>
<a href="#l65.11"></a><span id="l65.11">       if (priorityInteger &gt;= 1 &amp;&amp; priorityInteger &lt;= 4) {</span>
<a href="#l65.12"></a><span id="l65.12" class="difflineminus">-           priorityString = calGetString('calendar', 'highPriority'); // high priority</span>
<a href="#l65.13"></a><span id="l65.13" class="difflineplus">+           priorityString = calGetString(&quot;calendar&quot;, &quot;highPriority&quot;); // high priority</span>
<a href="#l65.14"></a><span id="l65.14">       } else if (priorityInteger == 5) {</span>
<a href="#l65.15"></a><span id="l65.15" class="difflineminus">-          priorityString = calGetString('calendar', 'normalPriority'); // normal priority</span>
<a href="#l65.16"></a><span id="l65.16" class="difflineplus">+          priorityString = calGetString(&quot;calendar&quot;, &quot;normalPriority&quot;); // normal priority</span>
<a href="#l65.17"></a><span id="l65.17">       } else {</span>
<a href="#l65.18"></a><span id="l65.18" class="difflineminus">-          priorityString = calGetString('calendar', 'lowPriority'); // low priority</span>
<a href="#l65.19"></a><span id="l65.19" class="difflineplus">+          priorityString = calGetString(&quot;calendar&quot;, &quot;lowPriority&quot;); // low priority</span>
<a href="#l65.20"></a><span id="l65.20">       }</span>
<a href="#l65.21"></a><span id="l65.21">       boxAppendLabeledText(vbox, &quot;tooltipPriority&quot;, priorityString);</span>
<a href="#l65.22"></a><span id="l65.22">       hasHeader = true;</span>
<a href="#l65.23"></a><span id="l65.23">     }</span>
<a href="#l65.24"></a><span id="l65.24"> </span>
<a href="#l65.25"></a><span id="l65.25">     if (toDoItem.status &amp;&amp; toDoItem.status != &quot;NONE&quot;) {</span>
<a href="#l65.26"></a><span id="l65.26">       let status = getToDoStatusString(toDoItem);</span>
<a href="#l65.27"></a><span id="l65.27">       boxAppendLabeledText(vbox, &quot;tooltipStatus&quot;, status);</span>
<a href="#l65.28"></a><span id="l65.28" class="difflineat">@@ -198,38 +198,38 @@ function getPreviewForEvent(aEvent) {</span>
<a href="#l65.29"></a><span id="l65.29"> }</span>
<a href="#l65.30"></a><span id="l65.30"> </span>
<a href="#l65.31"></a><span id="l65.31"> </span>
<a href="#l65.32"></a><span id="l65.32"> /** String for event status: (none), Tentative, Confirmed, or Cancelled **/</span>
<a href="#l65.33"></a><span id="l65.33"> function getEventStatusString(calendarEvent) {</span>
<a href="#l65.34"></a><span id="l65.34">   switch (calendarEvent.status) {</span>
<a href="#l65.35"></a><span id="l65.35">     // Event status value keywords are specified in RFC2445sec4.8.1.11</span>
<a href="#l65.36"></a><span id="l65.36">     case &quot;TENTATIVE&quot;:</span>
<a href="#l65.37"></a><span id="l65.37" class="difflineminus">-      return calGetString('calendar', &quot;statusTentative&quot;);</span>
<a href="#l65.38"></a><span id="l65.38" class="difflineplus">+      return calGetString(&quot;calendar&quot;, &quot;statusTentative&quot;);</span>
<a href="#l65.39"></a><span id="l65.39">     case &quot;CONFIRMED&quot;:</span>
<a href="#l65.40"></a><span id="l65.40" class="difflineminus">-      return calGetString('calendar', &quot;statusConfirmed&quot;);</span>
<a href="#l65.41"></a><span id="l65.41" class="difflineplus">+      return calGetString(&quot;calendar&quot;, &quot;statusConfirmed&quot;);</span>
<a href="#l65.42"></a><span id="l65.42">     case &quot;CANCELLED&quot;:</span>
<a href="#l65.43"></a><span id="l65.43" class="difflineminus">-      return calGetString('calendar', &quot;eventStatusCancelled&quot;);</span>
<a href="#l65.44"></a><span id="l65.44" class="difflineplus">+      return calGetString(&quot;calendar&quot;, &quot;eventStatusCancelled&quot;);</span>
<a href="#l65.45"></a><span id="l65.45">      default:</span>
<a href="#l65.46"></a><span id="l65.46">         return &quot;&quot;;</span>
<a href="#l65.47"></a><span id="l65.47">   }</span>
<a href="#l65.48"></a><span id="l65.48"> }</span>
<a href="#l65.49"></a><span id="l65.49"> </span>
<a href="#l65.50"></a><span id="l65.50"> /** String for todo status: (none), NeedsAction, InProcess, Cancelled, or Completed **/</span>
<a href="#l65.51"></a><span id="l65.51"> function getToDoStatusString(iCalToDo) {</span>
<a href="#l65.52"></a><span id="l65.52">   switch (iCalToDo.status) {</span>
<a href="#l65.53"></a><span id="l65.53">     // Todo status keywords are specified in RFC2445sec4.8.1.11</span>
<a href="#l65.54"></a><span id="l65.54">     case &quot;NEEDS-ACTION&quot;:</span>
<a href="#l65.55"></a><span id="l65.55" class="difflineminus">-      return calGetString('calendar', &quot;statusNeedsAction&quot;);</span>
<a href="#l65.56"></a><span id="l65.56" class="difflineplus">+      return calGetString(&quot;calendar&quot;, &quot;statusNeedsAction&quot;);</span>
<a href="#l65.57"></a><span id="l65.57">     case &quot;IN-PROCESS&quot;:</span>
<a href="#l65.58"></a><span id="l65.58" class="difflineminus">-      return calGetString('calendar', &quot;statusInProcess&quot;);</span>
<a href="#l65.59"></a><span id="l65.59" class="difflineplus">+      return calGetString(&quot;calendar&quot;, &quot;statusInProcess&quot;);</span>
<a href="#l65.60"></a><span id="l65.60">     case &quot;CANCELLED&quot;:</span>
<a href="#l65.61"></a><span id="l65.61" class="difflineminus">-      return calGetString('calendar', &quot;todoStatusCancelled&quot;);</span>
<a href="#l65.62"></a><span id="l65.62" class="difflineplus">+      return calGetString(&quot;calendar&quot;, &quot;todoStatusCancelled&quot;);</span>
<a href="#l65.63"></a><span id="l65.63">     case &quot;COMPLETED&quot;:</span>
<a href="#l65.64"></a><span id="l65.64" class="difflineminus">-      return calGetString('calendar', &quot;statusCompleted&quot;);</span>
<a href="#l65.65"></a><span id="l65.65" class="difflineplus">+      return calGetString(&quot;calendar&quot;, &quot;statusCompleted&quot;);</span>
<a href="#l65.66"></a><span id="l65.66">      default:</span>
<a href="#l65.67"></a><span id="l65.67">         return &quot;&quot;;</span>
<a href="#l65.68"></a><span id="l65.68">   }</span>
<a href="#l65.69"></a><span id="l65.69"> }</span>
<a href="#l65.70"></a><span id="l65.70"> </span>
<a href="#l65.71"></a><span id="l65.71"> /**</span>
<a href="#l65.72"></a><span id="l65.72">  * PRIVATE: Append a separator, a thin space between header and body.</span>
<a href="#l65.73"></a><span id="l65.73">  *</span>
<a href="#l65.74"></a><span id="l65.74" class="difflineat">@@ -305,17 +305,17 @@ function boxInitializeHeaderGrid(box) {</span>
<a href="#l65.75"></a><span id="l65.75"> /**</span>
<a href="#l65.76"></a><span id="l65.76">  * PRIVATE: To headers grid, append a row containing Label: value,</span>
<a href="#l65.77"></a><span id="l65.77">  * where label is localized text for labelProperty.</span>
<a href="#l65.78"></a><span id="l65.78">  * @param box               box containing headers grid</span>
<a href="#l65.79"></a><span id="l65.79">  * @param labelProperty     name of property for localized name of header</span>
<a href="#l65.80"></a><span id="l65.80">  * @param textString        value of header field.</span>
<a href="#l65.81"></a><span id="l65.81">  */</span>
<a href="#l65.82"></a><span id="l65.82"> function boxAppendLabeledText(box, labelProperty, textString) {</span>
<a href="#l65.83"></a><span id="l65.83" class="difflineminus">-  let labelText = calGetString('calendar', labelProperty);</span>
<a href="#l65.84"></a><span id="l65.84" class="difflineplus">+  let labelText = calGetString(&quot;calendar&quot;, labelProperty);</span>
<a href="#l65.85"></a><span id="l65.85">   let rows = box.getElementsByTagNameNS(box.namespaceURI, &quot;rows&quot;)[0];</span>
<a href="#l65.86"></a><span id="l65.86">   {</span>
<a href="#l65.87"></a><span id="l65.87">     let row = document.createElement(&quot;row&quot;);</span>
<a href="#l65.88"></a><span id="l65.88">     {</span>
<a href="#l65.89"></a><span id="l65.89">       row.appendChild(createTooltipHeaderLabel(labelText));</span>
<a href="#l65.90"></a><span id="l65.90">       row.appendChild(createTooltipHeaderDescription(textString));</span>
<a href="#l65.91"></a><span id="l65.91">     }</span>
<a href="#l65.92"></a><span id="l65.92">     rows.appendChild(row);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l66.1"></a><span id="l66.1" class="difflineminus">--- a/calendar/resources/content/publish.js</span>
<a href="#l66.2"></a><span id="l66.2" class="difflineplus">+++ b/calendar/resources/content/publish.js</span>
<a href="#l66.3"></a><span id="l66.3" class="difflineat">@@ -126,32 +126,32 @@ function publishItemArray(aItemArray, aP</span>
<a href="#l66.4"></a><span id="l66.4">     let icsURL = makeURL(aPath);</span>
<a href="#l66.5"></a><span id="l66.5"> </span>
<a href="#l66.6"></a><span id="l66.6">     let channel = Services.io.newChannelFromURI2(icsURL,</span>
<a href="#l66.7"></a><span id="l66.7">                                                  null,</span>
<a href="#l66.8"></a><span id="l66.8">                                                  Services.scriptSecurityManager.getSystemPrincipal(),</span>
<a href="#l66.9"></a><span id="l66.9">                                                  null,</span>
<a href="#l66.10"></a><span id="l66.10">                                                  Components.interfaces.nsILoadInfo.SEC_NORMAL,</span>
<a href="#l66.11"></a><span id="l66.11">                                                  Components.interfaces.nsIContentPolicy.TYPE_OTHER);</span>
<a href="#l66.12"></a><span id="l66.12" class="difflineminus">-    if (icsURL.schemeIs('webcal')) {</span>
<a href="#l66.13"></a><span id="l66.13" class="difflineminus">-        icsURL.scheme = 'http';</span>
<a href="#l66.14"></a><span id="l66.14" class="difflineplus">+    if (icsURL.schemeIs(&quot;webcal&quot;)) {</span>
<a href="#l66.15"></a><span id="l66.15" class="difflineplus">+        icsURL.scheme = &quot;http&quot;;</span>
<a href="#l66.16"></a><span id="l66.16">     }</span>
<a href="#l66.17"></a><span id="l66.17" class="difflineminus">-    if (icsURL.schemeIs('webcals')) {</span>
<a href="#l66.18"></a><span id="l66.18" class="difflineminus">-        icsURL.scheme = 'https';</span>
<a href="#l66.19"></a><span id="l66.19" class="difflineplus">+    if (icsURL.schemeIs(&quot;webcals&quot;)) {</span>
<a href="#l66.20"></a><span id="l66.20" class="difflineplus">+        icsURL.scheme = &quot;https&quot;;</span>
<a href="#l66.21"></a><span id="l66.21">     }</span>
<a href="#l66.22"></a><span id="l66.22"> </span>
<a href="#l66.23"></a><span id="l66.23">     switch (icsURL.scheme) {</span>
<a href="#l66.24"></a><span id="l66.24" class="difflineminus">-        case 'http':</span>
<a href="#l66.25"></a><span id="l66.25" class="difflineminus">-        case 'https':</span>
<a href="#l66.26"></a><span id="l66.26" class="difflineplus">+        case &quot;http&quot;:</span>
<a href="#l66.27"></a><span id="l66.27" class="difflineplus">+        case &quot;https&quot;:</span>
<a href="#l66.28"></a><span id="l66.28">             channel = channel.QueryInterface(Components.interfaces.nsIHttpChannel);</span>
<a href="#l66.29"></a><span id="l66.29">             break;</span>
<a href="#l66.30"></a><span id="l66.30" class="difflineminus">-        case 'ftp':</span>
<a href="#l66.31"></a><span id="l66.31" class="difflineplus">+        case &quot;ftp&quot;:</span>
<a href="#l66.32"></a><span id="l66.32">             channel = channel.QueryInterface(Components.interfaces.nsIFTPChannel);</span>
<a href="#l66.33"></a><span id="l66.33">             break;</span>
<a href="#l66.34"></a><span id="l66.34" class="difflineminus">-        case 'file':</span>
<a href="#l66.35"></a><span id="l66.35" class="difflineplus">+        case &quot;file&quot;:</span>
<a href="#l66.36"></a><span id="l66.36">             channel = channel.QueryInterface(Components.interfaces.nsIFileChannel);</span>
<a href="#l66.37"></a><span id="l66.37">             break;</span>
<a href="#l66.38"></a><span id="l66.38">         default:</span>
<a href="#l66.39"></a><span id="l66.39">             dump(&quot;No such scheme\n&quot;);</span>
<a href="#l66.40"></a><span id="l66.40">             return;</span>
<a href="#l66.41"></a><span id="l66.41">     }</span>
<a href="#l66.42"></a><span id="l66.42"> </span>
<a href="#l66.43"></a><span id="l66.43">     let uploadChannel = channel.QueryInterface(Components.interfaces.nsIUploadChannel);</span>
<a href="#l66.44"></a><span id="l66.44" class="difflineat">@@ -176,17 +176,17 @@ function publishItemArray(aItemArray, aP</span>
<a href="#l66.45"></a><span id="l66.45"> </span>
<a href="#l66.46"></a><span id="l66.46">     uploadChannel.setUploadStream(inputStream,</span>
<a href="#l66.47"></a><span id="l66.47">                                   &quot;text/calendar&quot;, -1);</span>
<a href="#l66.48"></a><span id="l66.48">     try {</span>
<a href="#l66.49"></a><span id="l66.49">         channel.asyncOpen(publishingListener, aProgressDialog);</span>
<a href="#l66.50"></a><span id="l66.50">     } catch (e) {</span>
<a href="#l66.51"></a><span id="l66.51">         let props = Services.strings.createBundle(&quot;chrome://calendar/locale/calendar.properties&quot;);</span>
<a href="#l66.52"></a><span id="l66.52">         Services.prompt.alert(null, calGetString(&quot;calendar&quot;, &quot;genericErrorTitle&quot;),</span>
<a href="#l66.53"></a><span id="l66.53" class="difflineminus">-                              props.formatStringFromName('otherPutError', [e.message], 1));</span>
<a href="#l66.54"></a><span id="l66.54" class="difflineplus">+                              props.formatStringFromName(&quot;otherPutError&quot;, [e.message], 1));</span>
<a href="#l66.55"></a><span id="l66.55">     }</span>
<a href="#l66.56"></a><span id="l66.56"> }</span>
<a href="#l66.57"></a><span id="l66.57"> </span>
<a href="#l66.58"></a><span id="l66.58"> </span>
<a href="#l66.59"></a><span id="l66.59"> var notificationCallbacks =</span>
<a href="#l66.60"></a><span id="l66.60"> {</span>
<a href="#l66.61"></a><span id="l66.61">     // nsIInterfaceRequestor interface</span>
<a href="#l66.62"></a><span id="l66.62">     getInterface: function(iid, instance) {</span>
<a href="#l66.63"></a><span id="l66.63" class="difflineat">@@ -216,19 +216,19 @@ var publishingListener = {</span>
<a href="#l66.64"></a><span id="l66.64">             channel = request.QueryInterface(Components.interfaces.nsIHttpChannel);</span>
<a href="#l66.65"></a><span id="l66.65">             requestSucceeded = channel.requestSucceeded;</span>
<a href="#l66.66"></a><span id="l66.66">         } catch (e) {</span>
<a href="#l66.67"></a><span id="l66.67">             // Don't fail if it is not a http channel, will be handled below</span>
<a href="#l66.68"></a><span id="l66.68">         }</span>
<a href="#l66.69"></a><span id="l66.69"> </span>
<a href="#l66.70"></a><span id="l66.70">         if (channel &amp;&amp; !requestSucceeded) {</span>
<a href="#l66.71"></a><span id="l66.71">             Services.prompt.alert(null, calGetString(&quot;calendar&quot;, &quot;genericErrorTitle&quot;),</span>
<a href="#l66.72"></a><span id="l66.72" class="difflineminus">-                                  props.formatStringFromName('httpPutError', [channel.responseStatus, channel.responseStatusText], 2));</span>
<a href="#l66.73"></a><span id="l66.73" class="difflineplus">+                                  props.formatStringFromName(&quot;httpPutError&quot;, [channel.responseStatus, channel.responseStatusText], 2));</span>
<a href="#l66.74"></a><span id="l66.74">         } else if (!channel &amp;&amp; !Components.isSuccessCode(request.status)) {</span>
<a href="#l66.75"></a><span id="l66.75">             // XXX this should be made human-readable.</span>
<a href="#l66.76"></a><span id="l66.76">             Services.prompt.alert(null, calGetString(&quot;calendar&quot;, &quot;genericErrorTitle&quot;),</span>
<a href="#l66.77"></a><span id="l66.77" class="difflineminus">-                                  props.formatStringFromName('otherPutError', [request.status.toString(16)], 1));</span>
<a href="#l66.78"></a><span id="l66.78" class="difflineplus">+                                  props.formatStringFromName(&quot;otherPutError&quot;, [request.status.toString(16)], 1));</span>
<a href="#l66.79"></a><span id="l66.79">         }</span>
<a href="#l66.80"></a><span id="l66.80">     },</span>
<a href="#l66.81"></a><span id="l66.81"> </span>
<a href="#l66.82"></a><span id="l66.82">     onDataAvailable: function(request, ctxt, inStream, sourceOffset, count) {</span>
<a href="#l66.83"></a><span id="l66.83">     }</span>
<a href="#l66.84"></a><span id="l66.84"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l67.1"></a><span id="l67.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testEventDialog.js</span>
<a href="#l67.2"></a><span id="l67.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testEventDialog.js</span>
<a href="#l67.3"></a><span id="l67.3" class="difflineat">@@ -72,18 +72,18 @@ var testEventDialog = function() {</span>
<a href="#l67.4"></a><span id="l67.4">   if (now.toLocaleTimeString().match(/AM|PM/)) {</span>
<a href="#l67.5"></a><span id="l67.5">     ampm = (hour &gt;= 12 ? &quot; PM&quot; : &quot; AM&quot;);</span>
<a href="#l67.6"></a><span id="l67.6">     startHour = startHour % 12;</span>
<a href="#l67.7"></a><span id="l67.7">     if (startHour == 0) {</span>
<a href="#l67.8"></a><span id="l67.8">       startHour = 12;</span>
<a href="#l67.9"></a><span id="l67.9">     }</span>
<a href="#l67.10"></a><span id="l67.10">   }</span>
<a href="#l67.11"></a><span id="l67.11"> </span>
<a href="#l67.12"></a><span id="l67.12" class="difflineminus">-  let startTime = startHour + ':00' + ampm;</span>
<a href="#l67.13"></a><span id="l67.13" class="difflineminus">-  let endTime = ((startHour + 1) % 24) + ':00' + ampm;</span>
<a href="#l67.14"></a><span id="l67.14" class="difflineplus">+  let startTime = startHour + &quot;:00&quot; + ampm;</span>
<a href="#l67.15"></a><span id="l67.15" class="difflineplus">+  let endTime = ((startHour + 1) % 24) + &quot;:00&quot; + ampm;</span>
<a href="#l67.16"></a><span id="l67.16">   let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l67.17"></a><span id="l67.17">     'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l67.18"></a><span id="l67.18">     'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/' +</span>
<a href="#l67.19"></a><span id="l67.19">     'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/id(&quot;timepicker-text&quot;)/' +</span>
<a href="#l67.20"></a><span id="l67.20">     'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'</span>
<a href="#l67.21"></a><span id="l67.21">     );</span>
<a href="#l67.22"></a><span id="l67.22">   event.waitForElement(startTimeInput);</span>
<a href="#l67.23"></a><span id="l67.23">   event.assertValue(startTimeInput, startTime);</span>
<a href="#l67.24"></a><span id="l67.24" class="difflineat">@@ -103,17 +103,17 @@ var testEventDialog = function() {</span>
<a href="#l67.25"></a><span id="l67.25">     'anon({&quot;anonid&quot;:&quot;input&quot;})'), location);</span>
<a href="#l67.26"></a><span id="l67.26">   event.type(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l67.27"></a><span id="l67.27">     'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l67.28"></a><span id="l67.28">     'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l67.29"></a><span id="l67.29">     desc);</span>
<a href="#l67.30"></a><span id="l67.30"> </span>
<a href="#l67.31"></a><span id="l67.31">   // set category</span>
<a href="#l67.32"></a><span id="l67.32">   let categories = utils.getProperty(&quot;chrome://calendar/locale/categories.properties&quot;, &quot;categories2&quot;);</span>
<a href="#l67.33"></a><span id="l67.33" class="difflineminus">-  let category = categories.split(',')[4]; // pick 4th value in a comma-separated list</span>
<a href="#l67.34"></a><span id="l67.34" class="difflineplus">+  let category = categories.split(&quot;,&quot;)[4]; // pick 4th value in a comma-separated list</span>
<a href="#l67.35"></a><span id="l67.35">   event.select(new elementslib.ID(event.window.document, &quot;item-categories&quot;), null, category);</span>
<a href="#l67.36"></a><span id="l67.36"> </span>
<a href="#l67.37"></a><span id="l67.37">   // repeat daily</span>
<a href="#l67.38"></a><span id="l67.38">   event.click(new elementslib.ID(event.window.document, &quot;repeat-daily-menuitem&quot;));</span>
<a href="#l67.39"></a><span id="l67.39"> </span>
<a href="#l67.40"></a><span id="l67.40">   // add reminder</span>
<a href="#l67.41"></a><span id="l67.41">   event.click(new elementslib.ID(event.window.document, &quot;reminder-5minutes-menuitem&quot;));</span>
<a href="#l67.42"></a><span id="l67.42"> </span>
<a href="#l67.43"></a><span id="l67.43" class="difflineat">@@ -253,16 +253,16 @@ function checkTooltip(monthView, row, co</span>
<a href="#l67.44"></a><span id="l67.44">     '/id(&quot;messengerWindow&quot;)/id(&quot;calendar-popupset&quot;)/id(&quot;itemTooltip&quot;)/' +</span>
<a href="#l67.45"></a><span id="l67.45">     '{&quot;class&quot;:&quot;tooltipBox&quot;}/{&quot;class&quot;:&quot;tooltipHeaderGrid&quot;}/[1]/[0]/[1]');</span>
<a href="#l67.46"></a><span id="l67.46">   controller.assertJS(eventName.getNode().textContent == title);</span>
<a href="#l67.47"></a><span id="l67.47"> </span>
<a href="#l67.48"></a><span id="l67.48">   // check date and time</span>
<a href="#l67.49"></a><span id="l67.49">   // date-time string contains strings formatted in operating system language so check numeric values only</span>
<a href="#l67.50"></a><span id="l67.50">   let dateTime = new elementslib.Lookup(controller.window.document,</span>
<a href="#l67.51"></a><span id="l67.51">     '/id(&quot;messengerWindow&quot;)/id(&quot;calendar-popupset&quot;)/id(&quot;itemTooltip&quot;)/' +</span>
<a href="#l67.52"></a><span id="l67.52" class="difflineminus">-    '{&quot;class&quot;:&quot;tooltipBox&quot;}/{&quot;class&quot;:&quot;tooltipHeaderGrid&quot;}/[1]/[2]/[1]').getNode().textContent + '';</span>
<a href="#l67.53"></a><span id="l67.53" class="difflineplus">+    '{&quot;class&quot;:&quot;tooltipBox&quot;}/{&quot;class&quot;:&quot;tooltipHeaderGrid&quot;}/[1]/[2]/[1]').getNode().textContent;</span>
<a href="#l67.54"></a><span id="l67.54">   controller.assertJS(dateTime.includes(date) &amp;&amp; dateTime.includes(startTime) &amp;&amp;</span>
<a href="#l67.55"></a><span id="l67.55">     dateTime.includes(endTime));</span>
<a href="#l67.56"></a><span id="l67.56"> }</span>
<a href="#l67.57"></a><span id="l67.57"> </span>
<a href="#l67.58"></a><span id="l67.58"> var teardownTest = function(module) {</span>
<a href="#l67.59"></a><span id="l67.59">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l67.60"></a><span id="l67.60"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l68.1"></a><span id="l68.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</span>
<a href="#l68.2"></a><span id="l68.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</span>
<a href="#l68.3"></a><span id="l68.3" class="difflineat">@@ -25,17 +25,17 @@ var newlines = [{ title: &quot;title&quot;, descri</span>
<a href="#l68.4"></a><span id="l68.4">                 { title: &quot;title&quot;, description: &quot;\rtest \\r\r&quot; },</span>
<a href="#l68.5"></a><span id="l68.5">                 { title: &quot;title&quot;, description: &quot;\r\ntest \\r\\n\r\n&quot; },</span>
<a href="#l68.6"></a><span id="l68.6">                 { title: &quot;title&quot;, description: &quot;\ttest \\t\t&quot; }];</span>
<a href="#l68.7"></a><span id="l68.7"> </span>
<a href="#l68.8"></a><span id="l68.8"> var setupModule = function(module) {</span>
<a href="#l68.9"></a><span id="l68.9">   controller = mozmill.getMail3PaneController();</span>
<a href="#l68.10"></a><span id="l68.10">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l68.11"></a><span id="l68.11"> </span>
<a href="#l68.12"></a><span id="l68.12" class="difflineminus">-  let categories = prefs.preferences.getPref(&quot;calendar.categories.names&quot;, &quot;string&quot;).split(',');</span>
<a href="#l68.13"></a><span id="l68.13" class="difflineplus">+  let categories = prefs.preferences.getPref(&quot;calendar.categories.names&quot;, &quot;string&quot;).split(&quot;,&quot;);</span>
<a href="#l68.14"></a><span id="l68.14">   data[0].category = categories[0];</span>
<a href="#l68.15"></a><span id="l68.15">   data[1].category = categories[1];</span>
<a href="#l68.16"></a><span id="l68.16"> };</span>
<a href="#l68.17"></a><span id="l68.17"> </span>
<a href="#l68.18"></a><span id="l68.18"> // Test that closing an event dialog with no changes does not prompt for save</span>
<a href="#l68.19"></a><span id="l68.19"> var testEventDialogModificationPrompt = function() {</span>
<a href="#l68.20"></a><span id="l68.20">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l68.21"></a><span id="l68.21">   calUtils.switchToView(controller, &quot;day&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l69.1"></a><span id="l69.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l69.2"></a><span id="l69.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l69.3"></a><span id="l69.3" class="difflineat">@@ -257,21 +257,21 @@ function changeRecurrence(recurrence) {</span>
<a href="#l69.4"></a><span id="l69.4"> </span>
<a href="#l69.5"></a><span id="l69.5"> function checkMultiWeekView(view) {</span>
<a href="#l69.6"></a><span id="l69.6">   let startWeek = view == &quot;multiweek&quot; ? 1 : 2;</span>
<a href="#l69.7"></a><span id="l69.7"> </span>
<a href="#l69.8"></a><span id="l69.8">   let path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 2, hour);</span>
<a href="#l69.9"></a><span id="l69.9">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l69.10"></a><span id="l69.10">   // assert exactly two</span>
<a href="#l69.11"></a><span id="l69.11">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 3, hour);</span>
<a href="#l69.12"></a><span id="l69.12" class="difflineminus">-  controller.assertNode(new elementslib.Lookup(controller.window.document, path + '/[0]'));</span>
<a href="#l69.13"></a><span id="l69.13" class="difflineplus">+  controller.assertNode(new elementslib.Lookup(controller.window.document, path + &quot;/[0]&quot;));</span>
<a href="#l69.14"></a><span id="l69.14">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 3, hour);</span>
<a href="#l69.15"></a><span id="l69.15" class="difflineminus">-  controller.assertNode(new elementslib.Lookup(controller.window.document, path + '/[1]'));</span>
<a href="#l69.16"></a><span id="l69.16" class="difflineplus">+  controller.assertNode(new elementslib.Lookup(controller.window.document, path + &quot;/[1]&quot;));</span>
<a href="#l69.17"></a><span id="l69.17">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 3, hour);</span>
<a href="#l69.18"></a><span id="l69.18" class="difflineminus">-  controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + '/[2]'));</span>
<a href="#l69.19"></a><span id="l69.19" class="difflineplus">+  controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + &quot;/[2]&quot;));</span>
<a href="#l69.20"></a><span id="l69.20">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 4, hour);</span>
<a href="#l69.21"></a><span id="l69.21">   controller.assertNode(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l69.22"></a><span id="l69.22">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 5, hour);</span>
<a href="#l69.23"></a><span id="l69.23">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l69.24"></a><span id="l69.24">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 6, hour);</span>
<a href="#l69.25"></a><span id="l69.25">   controller.assertNode(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l69.26"></a><span id="l69.26">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 7, hour);</span>
<a href="#l69.27"></a><span id="l69.27">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l70.1"></a><span id="l70.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l70.2"></a><span id="l70.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l70.3"></a><span id="l70.3" class="difflineat">@@ -270,21 +270,21 @@ function changeRecurrence(recurrence) {</span>
<a href="#l70.4"></a><span id="l70.4"> </span>
<a href="#l70.5"></a><span id="l70.5"> function checkMultiWeekView(view) {</span>
<a href="#l70.6"></a><span id="l70.6">   let startWeek = view == &quot;multiweek&quot; ? 1 : 2;</span>
<a href="#l70.7"></a><span id="l70.7"> </span>
<a href="#l70.8"></a><span id="l70.8">   let path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 2, hour);</span>
<a href="#l70.9"></a><span id="l70.9">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l70.10"></a><span id="l70.10">   // assert exactly two</span>
<a href="#l70.11"></a><span id="l70.11">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 3, hour);</span>
<a href="#l70.12"></a><span id="l70.12" class="difflineminus">-  controller.assertNode(new elementslib.Lookup(controller.window.document, path + '/[0]'));</span>
<a href="#l70.13"></a><span id="l70.13" class="difflineplus">+  controller.assertNode(new elementslib.Lookup(controller.window.document, path + &quot;/[0]&quot;));</span>
<a href="#l70.14"></a><span id="l70.14">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 3, hour);</span>
<a href="#l70.15"></a><span id="l70.15" class="difflineminus">-  controller.assertNode(new elementslib.Lookup(controller.window.document, path + '/[1]'));</span>
<a href="#l70.16"></a><span id="l70.16" class="difflineplus">+  controller.assertNode(new elementslib.Lookup(controller.window.document, path + &quot;/[1]&quot;));</span>
<a href="#l70.17"></a><span id="l70.17">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 3, hour);</span>
<a href="#l70.18"></a><span id="l70.18" class="difflineminus">-  controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + '/[2]'));</span>
<a href="#l70.19"></a><span id="l70.19" class="difflineplus">+  controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + &quot;/[2]&quot;));</span>
<a href="#l70.20"></a><span id="l70.20">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 4, hour);</span>
<a href="#l70.21"></a><span id="l70.21">   controller.assertNode(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l70.22"></a><span id="l70.22">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 5, hour);</span>
<a href="#l70.23"></a><span id="l70.23">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l70.24"></a><span id="l70.24">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 6, hour);</span>
<a href="#l70.25"></a><span id="l70.25">   controller.assertNode(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l70.26"></a><span id="l70.26">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 7, hour);</span>
<a href="#l70.27"></a><span id="l70.27">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l71.1"></a><span id="l71.1" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l71.2"></a><span id="l71.2" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l71.3"></a><span id="l71.3" class="difflineat">@@ -1,19 +1,19 @@</span>
<a href="#l71.4"></a><span id="l71.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l71.5"></a><span id="l71.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l71.6"></a><span id="l71.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l71.7"></a><span id="l71.7"> </span>
<a href="#l71.8"></a><span id="l71.8"> var MODULE_NAME = &quot;calendar-utils&quot;;</span>
<a href="#l71.9"></a><span id="l71.9"> var MODULE_REQUIRES = [&quot;window-helpers&quot;];</span>
<a href="#l71.10"></a><span id="l71.10"> </span>
<a href="#l71.11"></a><span id="l71.11"> var os = {};</span>
<a href="#l71.12"></a><span id="l71.12" class="difflineminus">-Components.utils.import('resource://mozmill/stdlib/os.js', os);</span>
<a href="#l71.13"></a><span id="l71.13" class="difflineplus">+Components.utils.import(&quot;resource://mozmill/stdlib/os.js&quot;, os);</span>
<a href="#l71.14"></a><span id="l71.14"> var frame = {};</span>
<a href="#l71.15"></a><span id="l71.15" class="difflineminus">-Components.utils.import('resource://mozmill/modules/frame.js', frame);</span>
<a href="#l71.16"></a><span id="l71.16" class="difflineplus">+Components.utils.import(&quot;resource://mozmill/modules/frame.js&quot;, frame);</span>
<a href="#l71.17"></a><span id="l71.17"> </span>
<a href="#l71.18"></a><span id="l71.18"> var modalDialog = require(&quot;test-window-helpers&quot;);</span>
<a href="#l71.19"></a><span id="l71.19"> </span>
<a href="#l71.20"></a><span id="l71.20"> var sleep = 500;</span>
<a href="#l71.21"></a><span id="l71.21"> var EVENT_BOX = 0; // Use when you need an event box</span>
<a href="#l71.22"></a><span id="l71.22"> var CANVAS_BOX = 1; // Use when you need a calendar canvas box</span>
<a href="#l71.23"></a><span id="l71.23"> var ALLDAY = 2; // Use when you need an allday canvas or event box</span>
<a href="#l71.24"></a><span id="l71.24"> </span>
<a href="#l71.25"></a><span id="l71.25" class="difflineat">@@ -32,17 +32,17 @@ function acceptSendingNotificationMail(c</span>
<a href="#l71.26"></a><span id="l71.26"> }</span>
<a href="#l71.27"></a><span id="l71.27"> </span>
<a href="#l71.28"></a><span id="l71.28"> /**</span>
<a href="#l71.29"></a><span id="l71.29">  *  Add an attachment with url</span>
<a href="#l71.30"></a><span id="l71.30">  *  @param controller - Mozmill window controller</span>
<a href="#l71.31"></a><span id="l71.31">  */</span>
<a href="#l71.32"></a><span id="l71.32"> function handleAddingAttachment(controller, url) {</span>
<a href="#l71.33"></a><span id="l71.33">   modalDialog.plan_for_modal_dialog(&quot;commonDialog&quot;, function(attachment) {</span>
<a href="#l71.34"></a><span id="l71.34" class="difflineminus">-    let input = new elementslib.ID(attachment.window.document, 'loginTextbox');</span>
<a href="#l71.35"></a><span id="l71.35" class="difflineplus">+    let input = new elementslib.ID(attachment.window.document, &quot;loginTextbox&quot;);</span>
<a href="#l71.36"></a><span id="l71.36">     attachment.waitForElement(input);</span>
<a href="#l71.37"></a><span id="l71.37">     input.getNode().value = url;</span>
<a href="#l71.38"></a><span id="l71.38">     attachment.click(new elementslib.Lookup(attachment.window.document, '/id(&quot;commonDialog&quot;)/' +</span>
<a href="#l71.39"></a><span id="l71.39">       'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l71.40"></a><span id="l71.40">   });</span>
<a href="#l71.41"></a><span id="l71.41"> </span>
<a href="#l71.42"></a><span id="l71.42">   modalDialog.wait_for_modal_dialog(&quot;commonDialog&quot;);</span>
<a href="#l71.43"></a><span id="l71.43"> }</span>
<a href="#l71.44"></a><span id="l71.44" class="difflineat">@@ -184,32 +184,32 @@ function goToDate(controller, year, mont</span>
<a href="#l71.45"></a><span id="l71.45">       'anon({&quot;anonid&quot;:&quot;years-popup&quot;})/[0]/{&quot;value&quot;:&quot;' + year + '&quot;}'));</span>
<a href="#l71.46"></a><span id="l71.46">     controller.sleep(500);</span>
<a href="#l71.47"></a><span id="l71.47">   }</span>
<a href="#l71.48"></a><span id="l71.48"> </span>
<a href="#l71.49"></a><span id="l71.49">   if (monthDifference != 0) {</span>
<a href="#l71.50"></a><span id="l71.50">     // pick month</span>
<a href="#l71.51"></a><span id="l71.51">     controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l71.52"></a><span id="l71.52">       'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;monthheader&quot;})/[' + activeMonth +</span>
<a href="#l71.53"></a><span id="l71.53" class="difflineminus">-      ']'));</span>
<a href="#l71.54"></a><span id="l71.54" class="difflineplus">+      &quot;]&quot;));</span>
<a href="#l71.55"></a><span id="l71.55">     controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l71.56"></a><span id="l71.56">       'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/' +</span>
<a href="#l71.57"></a><span id="l71.57">       'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;' + (month - 1) + '&quot;}'));</span>
<a href="#l71.58"></a><span id="l71.58">     controller.sleep(500);</span>
<a href="#l71.59"></a><span id="l71.59">   }</span>
<a href="#l71.60"></a><span id="l71.60"> </span>
<a href="#l71.61"></a><span id="l71.61">   let lastDayInFirstRow = (new elementslib.Lookup(controller.window.document,</span>
<a href="#l71.62"></a><span id="l71.62">     miniMonth + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/[6]')).getNode().getAttribute(&quot;value&quot;);</span>
<a href="#l71.63"></a><span id="l71.63">   let positionOfFirst = 7 - lastDayInFirstRow;</span>
<a href="#l71.64"></a><span id="l71.64">   let dateColumn = (positionOfFirst + day - 1) % 7;</span>
<a href="#l71.65"></a><span id="l71.65">   let dateRow = Math.floor((positionOfFirst + day - 1) / 7);</span>
<a href="#l71.66"></a><span id="l71.66"> </span>
<a href="#l71.67"></a><span id="l71.67">   // pick day</span>
<a href="#l71.68"></a><span id="l71.68">   controller.click(new elementslib.Lookup(controller.window.document, miniMonth +</span>
<a href="#l71.69"></a><span id="l71.69" class="difflineminus">-    'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[' + (dateRow + 1) + ']/[' + dateColumn + ']'));</span>
<a href="#l71.70"></a><span id="l71.70" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[' + (dateRow + 1) + &quot;]/[&quot; + dateColumn + &quot;]&quot;));</span>
<a href="#l71.71"></a><span id="l71.71">   controller.sleep(500);</span>
<a href="#l71.72"></a><span id="l71.72"> }</span>
<a href="#l71.73"></a><span id="l71.73"> </span>
<a href="#l71.74"></a><span id="l71.74"> /**</span>
<a href="#l71.75"></a><span id="l71.75">  *  @param controller - main window controller</span>
<a href="#l71.76"></a><span id="l71.76">  *  @param view - day, week, multiweek or month</span>
<a href="#l71.77"></a><span id="l71.77">  *  @param option - bg for creating event, fg for checking</span>
<a href="#l71.78"></a><span id="l71.78">  *  @param row - only used in multiweek and month view, 1-based index of a row</span>
<a href="#l71.79"></a><span id="l71.79" class="difflineat">@@ -221,50 +221,50 @@ function getEventBoxPath(controller, vie</span>
<a href="#l71.80"></a><span id="l71.80">   let viewDeck = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/' +</span>
<a href="#l71.81"></a><span id="l71.81">     'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/' +</span>
<a href="#l71.82"></a><span id="l71.82">     'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)';</span>
<a href="#l71.83"></a><span id="l71.83">   let dayView = viewDeck + '/id(&quot;day-view&quot;)';</span>
<a href="#l71.84"></a><span id="l71.84">   let weekView = viewDeck + '/id(&quot;week-view&quot;)';</span>
<a href="#l71.85"></a><span id="l71.85">   let multiweekView = viewDeck + '/id(&quot;multiweek-view&quot;)';</span>
<a href="#l71.86"></a><span id="l71.86">   let monthView = viewDeck + '/id(&quot;month-view&quot;)';</span>
<a href="#l71.87"></a><span id="l71.87"> </span>
<a href="#l71.88"></a><span id="l71.88" class="difflineminus">-  let path = '';</span>
<a href="#l71.89"></a><span id="l71.89" class="difflineplus">+  let path = &quot;&quot;;</span>
<a href="#l71.90"></a><span id="l71.90">   switch (view) {</span>
<a href="#l71.91"></a><span id="l71.91">     case &quot;week&quot;:</span>
<a href="#l71.92"></a><span id="l71.92">       path += weekView;</span>
<a href="#l71.93"></a><span id="l71.93">       break;</span>
<a href="#l71.94"></a><span id="l71.94">     case &quot;multiweek&quot;:</span>
<a href="#l71.95"></a><span id="l71.95">       path += multiweekView;</span>
<a href="#l71.96"></a><span id="l71.96">       break;</span>
<a href="#l71.97"></a><span id="l71.97">     case &quot;month&quot;:</span>
<a href="#l71.98"></a><span id="l71.98">       path += monthView;</span>
<a href="#l71.99"></a><span id="l71.99">       break;</span>
<a href="#l71.100"></a><span id="l71.100">     default: path += dayView;</span>
<a href="#l71.101"></a><span id="l71.101">   }</span>
<a href="#l71.102"></a><span id="l71.102"> </span>
<a href="#l71.103"></a><span id="l71.103">   if ((view == &quot;day&quot; || view == &quot;week&quot;) &amp;&amp; option == ALLDAY) {</span>
<a href="#l71.104"></a><span id="l71.104">     path += '/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;headerbox&quot;})/anon({&quot;anonid&quot;:&quot;headerdaybox&quot;})';</span>
<a href="#l71.105"></a><span id="l71.105" class="difflineminus">-    path += '/[' + (column - 1) + ']';</span>
<a href="#l71.106"></a><span id="l71.106" class="difflineplus">+    path += &quot;/[&quot; + (column - 1) + &quot;]&quot;;</span>
<a href="#l71.107"></a><span id="l71.107"> </span>
<a href="#l71.108"></a><span id="l71.108">     return path;</span>
<a href="#l71.109"></a><span id="l71.109">   } else if (view == &quot;day&quot; || view == &quot;week&quot;) {</span>
<a href="#l71.110"></a><span id="l71.110">     path += '/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})';</span>
<a href="#l71.111"></a><span id="l71.111" class="difflineminus">-    path += '/[' + (column - 1) + ']';</span>
<a href="#l71.112"></a><span id="l71.112" class="difflineplus">+    path += &quot;/[&quot; + (column - 1) + &quot;]&quot;;</span>
<a href="#l71.113"></a><span id="l71.113">     path += '/anon({&quot;anonid&quot;:&quot;boxstack&quot;})';</span>
<a href="#l71.114"></a><span id="l71.114"> </span>
<a href="#l71.115"></a><span id="l71.115">     if (option == CANVAS_BOX) {</span>
<a href="#l71.116"></a><span id="l71.116" class="difflineminus">-      path += '/anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[' + hour + ']';</span>
<a href="#l71.117"></a><span id="l71.117" class="difflineplus">+      path += '/anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[' + hour + &quot;]&quot;;</span>
<a href="#l71.118"></a><span id="l71.118">     } else {</span>
<a href="#l71.119"></a><span id="l71.119">       path += '/anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}';</span>
<a href="#l71.120"></a><span id="l71.120">     }</span>
<a href="#l71.121"></a><span id="l71.121"> </span>
<a href="#l71.122"></a><span id="l71.122">     return path;</span>
<a href="#l71.123"></a><span id="l71.123">   } else {</span>
<a href="#l71.124"></a><span id="l71.124">     path += '/anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/' +</span>
<a href="#l71.125"></a><span id="l71.125" class="difflineminus">-      'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[' + (row - 1) + ']/[' + (column - 1) + ']';</span>
<a href="#l71.126"></a><span id="l71.126" class="difflineplus">+      'anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/[' + (row - 1) + &quot;]/[&quot; + (column - 1) + &quot;]&quot;;</span>
<a href="#l71.127"></a><span id="l71.127"> </span>
<a href="#l71.128"></a><span id="l71.128">     if (option == CANVAS_BOX) {</span>
<a href="#l71.129"></a><span id="l71.129">       path += '/anon({&quot;anonid&quot;:&quot;day-items&quot;})';</span>
<a href="#l71.130"></a><span id="l71.130">     }</span>
<a href="#l71.131"></a><span id="l71.131"> </span>
<a href="#l71.132"></a><span id="l71.132">     return path;</span>
<a href="#l71.133"></a><span id="l71.133">   }</span>
<a href="#l71.134"></a><span id="l71.134"> }</span>
<a href="#l71.135"></a><span id="l71.135" class="difflineat">@@ -430,34 +430,34 @@ function setData(controller, data) {</span>
<a href="#l71.136"></a><span id="l71.136">   controller.sleep(sleep);</span>
<a href="#l71.137"></a><span id="l71.137"> </span>
<a href="#l71.138"></a><span id="l71.138">   // title</span>
<a href="#l71.139"></a><span id="l71.139">   if (data.title != undefined) {</span>
<a href="#l71.140"></a><span id="l71.140">     if (!mac) {</span>
<a href="#l71.141"></a><span id="l71.141">       controller.keypress(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l71.142"></a><span id="l71.142">         'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l71.143"></a><span id="l71.143">         'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l71.144"></a><span id="l71.144" class="difflineminus">-        'a', { ctrlKey: true });</span>
<a href="#l71.145"></a><span id="l71.145" class="difflineplus">+        &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l71.146"></a><span id="l71.146">       controller.type(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l71.147"></a><span id="l71.147">         'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l71.148"></a><span id="l71.148">         'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l71.149"></a><span id="l71.149">         data.title);</span>
<a href="#l71.150"></a><span id="l71.150">     } else {</span>
<a href="#l71.151"></a><span id="l71.151">       let titleField = new elementslib.ID(controller.window.document, &quot;item-title&quot;);</span>
<a href="#l71.152"></a><span id="l71.152">       titleField.getNode().value = data.title;</span>
<a href="#l71.153"></a><span id="l71.153">     }</span>
<a href="#l71.154"></a><span id="l71.154">   }</span>
<a href="#l71.155"></a><span id="l71.155"> </span>
<a href="#l71.156"></a><span id="l71.156">   // location</span>
<a href="#l71.157"></a><span id="l71.157">   if (data.location != undefined) {</span>
<a href="#l71.158"></a><span id="l71.158">     if (!mac) {</span>
<a href="#l71.159"></a><span id="l71.159">       controller.keypress(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l71.160"></a><span id="l71.160">         'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l71.161"></a><span id="l71.161">         'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l71.162"></a><span id="l71.162" class="difflineminus">-        'a', { ctrlKey: true });</span>
<a href="#l71.163"></a><span id="l71.163" class="difflineplus">+        &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l71.164"></a><span id="l71.164">       controller.type(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l71.165"></a><span id="l71.165">         'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/' +</span>
<a href="#l71.166"></a><span id="l71.166">         'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l71.167"></a><span id="l71.167">         data.location);</span>
<a href="#l71.168"></a><span id="l71.168">     } else {</span>
<a href="#l71.169"></a><span id="l71.169">       let locationField = new elementslib.ID(controller.window.document, &quot;item-location&quot;);</span>
<a href="#l71.170"></a><span id="l71.170">       locationField.getNode().value = data.location;</span>
<a href="#l71.171"></a><span id="l71.171">     }</span>
<a href="#l71.172"></a><span id="l71.172" class="difflineat">@@ -478,64 +478,64 @@ function setData(controller, data) {</span>
<a href="#l71.173"></a><span id="l71.173">   // timezone</span>
<a href="#l71.174"></a><span id="l71.174">   if (data.timezone != undefined) {</span>
<a href="#l71.175"></a><span id="l71.175">     let menuitem = new elementslib.ID(controller.window.document, &quot;options-timezones-menuitem&quot;);</span>
<a href="#l71.176"></a><span id="l71.176">     menuitem.getNode().setAttribute(&quot;checked&quot;, data.timezone);</span>
<a href="#l71.177"></a><span id="l71.177">     controller.click(menuitem);</span>
<a href="#l71.178"></a><span id="l71.178">   }</span>
<a href="#l71.179"></a><span id="l71.179"> </span>
<a href="#l71.180"></a><span id="l71.180">   // startdate</span>
<a href="#l71.181"></a><span id="l71.181" class="difflineminus">-  if (data.startdate != undefined &amp;&amp; data.startdate.constructor.name == 'Date') {</span>
<a href="#l71.182"></a><span id="l71.182" class="difflineplus">+  if (data.startdate != undefined &amp;&amp; data.startdate.constructor.name == &quot;Date&quot;) {</span>
<a href="#l71.183"></a><span id="l71.183">     let startdate = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l71.184"></a><span id="l71.184">       data.startdate.getFullYear(), data.startdate.getMonth() + 1, data.startdate.getDate());</span>
<a href="#l71.185"></a><span id="l71.185">     if (!isEvent) {</span>
<a href="#l71.186"></a><span id="l71.186">       controller.check(new elementslib.ID(controller.window.document, &quot;todo-has-entrydate&quot;), true);</span>
<a href="#l71.187"></a><span id="l71.187">     }</span>
<a href="#l71.188"></a><span id="l71.188">     if (!mac) {</span>
<a href="#l71.189"></a><span id="l71.189" class="difflineminus">-      controller.keypress(startDateInput, 'a', { ctrlKey: true });</span>
<a href="#l71.190"></a><span id="l71.190" class="difflineplus">+      controller.keypress(startDateInput, &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l71.191"></a><span id="l71.191">       controller.type(startDateInput, startdate);</span>
<a href="#l71.192"></a><span id="l71.192">     } else {</span>
<a href="#l71.193"></a><span id="l71.193">       startDateInput.getNode().value = startdate;</span>
<a href="#l71.194"></a><span id="l71.194">     }</span>
<a href="#l71.195"></a><span id="l71.195">   }</span>
<a href="#l71.196"></a><span id="l71.196"> </span>
<a href="#l71.197"></a><span id="l71.197">   // starttime</span>
<a href="#l71.198"></a><span id="l71.198" class="difflineminus">-  if (data.starttime != undefined &amp;&amp; data.starttime.constructor.name == 'Date') {</span>
<a href="#l71.199"></a><span id="l71.199" class="difflineplus">+  if (data.starttime != undefined &amp;&amp; data.starttime.constructor.name == &quot;Date&quot;) {</span>
<a href="#l71.200"></a><span id="l71.200">     let starttime = dateService.FormatTime(&quot;&quot;, dateService.timeFormatNoSeconds,</span>
<a href="#l71.201"></a><span id="l71.201">       data.starttime.getHours(), data.starttime.getMinutes(), 0);</span>
<a href="#l71.202"></a><span id="l71.202">     if (!mac) {</span>
<a href="#l71.203"></a><span id="l71.203" class="difflineminus">-      controller.keypress(startTimeInput, 'a', { ctrlKey: true });</span>
<a href="#l71.204"></a><span id="l71.204" class="difflineplus">+      controller.keypress(startTimeInput, &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l71.205"></a><span id="l71.205">       controller.type(startTimeInput, starttime);</span>
<a href="#l71.206"></a><span id="l71.206">     } else {</span>
<a href="#l71.207"></a><span id="l71.207">       startTimeInput.getNode().value = starttime;</span>
<a href="#l71.208"></a><span id="l71.208">       controller.sleep(sleep);</span>
<a href="#l71.209"></a><span id="l71.209">     }</span>
<a href="#l71.210"></a><span id="l71.210">   }</span>
<a href="#l71.211"></a><span id="l71.211"> </span>
<a href="#l71.212"></a><span id="l71.212">   // enddate</span>
<a href="#l71.213"></a><span id="l71.213" class="difflineminus">-  if (data.enddate != undefined &amp;&amp; data.enddate.constructor.name == 'Date') {</span>
<a href="#l71.214"></a><span id="l71.214" class="difflineplus">+  if (data.enddate != undefined &amp;&amp; data.enddate.constructor.name == &quot;Date&quot;) {</span>
<a href="#l71.215"></a><span id="l71.215">     let enddate = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l71.216"></a><span id="l71.216">       data.enddate.getFullYear(), data.enddate.getMonth() + 1, data.enddate.getDate());</span>
<a href="#l71.217"></a><span id="l71.217">     if (!isEvent) {</span>
<a href="#l71.218"></a><span id="l71.218">       controller.check(new elementslib.ID(controller.window.document, &quot;todo-has-duedate&quot;), true);</span>
<a href="#l71.219"></a><span id="l71.219">     }</span>
<a href="#l71.220"></a><span id="l71.220">     if (!mac) {</span>
<a href="#l71.221"></a><span id="l71.221" class="difflineminus">-      controller.keypress(endDateInput, 'a', { ctrlKey: true });</span>
<a href="#l71.222"></a><span id="l71.222" class="difflineplus">+      controller.keypress(endDateInput, &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l71.223"></a><span id="l71.223">       controller.type(endDateInput, enddate);</span>
<a href="#l71.224"></a><span id="l71.224">     } else {</span>
<a href="#l71.225"></a><span id="l71.225">       endDateInput.getNode().value = enddate;</span>
<a href="#l71.226"></a><span id="l71.226">     }</span>
<a href="#l71.227"></a><span id="l71.227">   }</span>
<a href="#l71.228"></a><span id="l71.228"> </span>
<a href="#l71.229"></a><span id="l71.229">   // endttime</span>
<a href="#l71.230"></a><span id="l71.230" class="difflineminus">-  if (data.endtime != undefined &amp;&amp; data.endtime.constructor.name == 'Date') {</span>
<a href="#l71.231"></a><span id="l71.231" class="difflineplus">+  if (data.endtime != undefined &amp;&amp; data.endtime.constructor.name == &quot;Date&quot;) {</span>
<a href="#l71.232"></a><span id="l71.232">     let endtime = dateService.FormatTime(&quot;&quot;, dateService.timeFormatNoSeconds,</span>
<a href="#l71.233"></a><span id="l71.233">       data.endtime.getHours(), data.endtime.getMinutes(), 0);</span>
<a href="#l71.234"></a><span id="l71.234">     if (!mac) {</span>
<a href="#l71.235"></a><span id="l71.235" class="difflineminus">-      controller.keypress(endTimeInput, 'a', { ctrlKey: true });</span>
<a href="#l71.236"></a><span id="l71.236" class="difflineplus">+      controller.keypress(endTimeInput, &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l71.237"></a><span id="l71.237">       controller.type(endTimeInput, endtime);</span>
<a href="#l71.238"></a><span id="l71.238">     } else {</span>
<a href="#l71.239"></a><span id="l71.239">       endTimeInput.getNode().value = endtime;</span>
<a href="#l71.240"></a><span id="l71.240">       controller.sleep(sleep);</span>
<a href="#l71.241"></a><span id="l71.241">     }</span>
<a href="#l71.242"></a><span id="l71.242">   }</span>
<a href="#l71.243"></a><span id="l71.243"> </span>
<a href="#l71.244"></a><span id="l71.244">   // recurrence</span>
<a href="#l71.245"></a><span id="l71.245" class="difflineat">@@ -550,17 +550,17 @@ function setData(controller, data) {</span>
<a href="#l71.246"></a><span id="l71.246">   }</span>
<a href="#l71.247"></a><span id="l71.247"> </span>
<a href="#l71.248"></a><span id="l71.248">   // description</span>
<a href="#l71.249"></a><span id="l71.249">   if (data.description != undefined) {</span>
<a href="#l71.250"></a><span id="l71.250">     if (!mac) {</span>
<a href="#l71.251"></a><span id="l71.251">       controller.keypress(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l71.252"></a><span id="l71.252">         'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l71.253"></a><span id="l71.253">         'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l71.254"></a><span id="l71.254" class="difflineminus">-        'a', { ctrlKey: true });</span>
<a href="#l71.255"></a><span id="l71.255" class="difflineplus">+        &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l71.256"></a><span id="l71.256">       controller.type(new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l71.257"></a><span id="l71.257">         'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l71.258"></a><span id="l71.258">         'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l71.259"></a><span id="l71.259">         data.description);</span>
<a href="#l71.260"></a><span id="l71.260">     } else {</span>
<a href="#l71.261"></a><span id="l71.261">       let descField = new elementslib.Lookup(controller.window.document, dialog +</span>
<a href="#l71.262"></a><span id="l71.262">         'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/' +</span>
<a href="#l71.263"></a><span id="l71.263">         'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l71.264"></a><span id="l71.264" class="difflineat">@@ -587,24 +587,24 @@ function setData(controller, data) {</span>
<a href="#l71.265"></a><span id="l71.265">         undefined, data.status.toUpperCase());</span>
<a href="#l71.266"></a><span id="l71.266">       controller.sleep(sleep);</span>
<a href="#l71.267"></a><span id="l71.267">     }</span>
<a href="#l71.268"></a><span id="l71.268">   }</span>
<a href="#l71.269"></a><span id="l71.269"> </span>
<a href="#l71.270"></a><span id="l71.270">   let currentStatus = (new elementslib.ID(controller.window.document, &quot;todo-status&quot;)).getNode().value;</span>
<a href="#l71.271"></a><span id="l71.271"> </span>
<a href="#l71.272"></a><span id="l71.272">   // completed on</span>
<a href="#l71.273"></a><span id="l71.273" class="difflineminus">-  if (data.completed != undefined &amp;&amp; data.completed.constructor.name == 'Date' &amp;&amp; !isEvent) {</span>
<a href="#l71.274"></a><span id="l71.274" class="difflineplus">+  if (data.completed != undefined &amp;&amp; data.completed.constructor.name == &quot;Date&quot; &amp;&amp; !isEvent) {</span>
<a href="#l71.275"></a><span id="l71.275">     let completeddate = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l71.276"></a><span id="l71.276">       data.completed.getFullYear(), data.completed.getMonth() + 1,</span>
<a href="#l71.277"></a><span id="l71.277">       data.completed.getDate());</span>
<a href="#l71.278"></a><span id="l71.278"> </span>
<a href="#l71.279"></a><span id="l71.279">     if (currentStatus == &quot;COMPLETED&quot;) {</span>
<a href="#l71.280"></a><span id="l71.280">       if (!mac) {</span>
<a href="#l71.281"></a><span id="l71.281" class="difflineminus">-        controller.keypress(completedDateInput, 'a', { ctrlKey: true });</span>
<a href="#l71.282"></a><span id="l71.282" class="difflineplus">+        controller.keypress(completedDateInput, &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l71.283"></a><span id="l71.283">         controller.type(completedDateInput, completeddate);</span>
<a href="#l71.284"></a><span id="l71.284">       } else {</span>
<a href="#l71.285"></a><span id="l71.285">         completedDateInput.getNode().value = completeddate;</span>
<a href="#l71.286"></a><span id="l71.286">       }</span>
<a href="#l71.287"></a><span id="l71.287">     }</span>
<a href="#l71.288"></a><span id="l71.288">   }</span>
<a href="#l71.289"></a><span id="l71.289"> </span>
<a href="#l71.290"></a><span id="l71.290">   // percent complete</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l72.1"></a><span id="l72.1" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/timezone-utils.js</span>
<a href="#l72.2"></a><span id="l72.2" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/timezone-utils.js</span>
<a href="#l72.3"></a><span id="l72.3" class="difflineat">@@ -34,17 +34,17 @@ function verify(controller, dates, timez</span>
<a href="#l72.4"></a><span id="l72.4">     for (let tz = 0; tz &lt; timezones.length; tz++) {</span>
<a href="#l72.5"></a><span id="l72.5">       let found = false;</span>
<a href="#l72.6"></a><span id="l72.6"> </span>
<a href="#l72.7"></a><span id="l72.7">       let correctHour = times[date][tz][0];</span>
<a href="#l72.8"></a><span id="l72.8">       let minutes = times[date][tz][1];</span>
<a href="#l72.9"></a><span id="l72.9">       let day = times[date][tz][2];</span>
<a href="#l72.10"></a><span id="l72.10"> </span>
<a href="#l72.11"></a><span id="l72.11">       let timeNode = (new elementslib.Lookup(controller.window.document,</span>
<a href="#l72.12"></a><span id="l72.12" class="difflineminus">-                                             timeLine + '[' + correctHour + ']')).getNode();</span>
<a href="#l72.13"></a><span id="l72.13" class="difflineplus">+                                             timeLine + &quot;[&quot; + correctHour + &quot;]&quot;)).getNode();</span>
<a href="#l72.14"></a><span id="l72.14">       let timeY = timeNode.boxObject.y;</span>
<a href="#l72.15"></a><span id="l72.15">       timeY += timeNode.boxObject.height * (minutes / 60);</span>
<a href="#l72.16"></a><span id="l72.16"> </span>
<a href="#l72.17"></a><span id="l72.17">       let stackNode;</span>
<a href="#l72.18"></a><span id="l72.18">       let eventNodes = [];</span>
<a href="#l72.19"></a><span id="l72.19"> </span>
<a href="#l72.20"></a><span id="l72.20">       // same day</span>
<a href="#l72.21"></a><span id="l72.21">       if (day == undefined) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l73.1"></a><span id="l73.1" class="difflineminus">--- a/calendar/test/mozmill/testBasicFunctionality.js</span>
<a href="#l73.2"></a><span id="l73.2" class="difflineplus">+++ b/calendar/test/mozmill/testBasicFunctionality.js</span>
<a href="#l73.3"></a><span id="l73.3" class="difflineat">@@ -7,17 +7,17 @@ var RELATIVE_ROOT = &quot;./shared-modules&quot;;</span>
<a href="#l73.4"></a><span id="l73.4"> var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;window-helpers&quot;];</span>
<a href="#l73.5"></a><span id="l73.5"> </span>
<a href="#l73.6"></a><span id="l73.6"> var calUtils = require(&quot;shared-modules/calendar-utils&quot;);</span>
<a href="#l73.7"></a><span id="l73.7"> var TIMEOUT_MODAL_DIALOG = 30000;</span>
<a href="#l73.8"></a><span id="l73.8"> </span>
<a href="#l73.9"></a><span id="l73.9"> var modalDialog;</span>
<a href="#l73.10"></a><span id="l73.10"> var setupModule = function(module) {</span>
<a href="#l73.11"></a><span id="l73.11">   controller = mozmill.getMail3PaneController();</span>
<a href="#l73.12"></a><span id="l73.12" class="difflineminus">-  modalDialog = collector.getModule('window-helpers');</span>
<a href="#l73.13"></a><span id="l73.13" class="difflineplus">+  modalDialog = collector.getModule(&quot;window-helpers&quot;);</span>
<a href="#l73.14"></a><span id="l73.14"> };</span>
<a href="#l73.15"></a><span id="l73.15"> </span>
<a href="#l73.16"></a><span id="l73.16"> var testSmokeTest = function() {</span>
<a href="#l73.17"></a><span id="l73.17">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l73.18"></a><span id="l73.18">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l73.19"></a><span id="l73.19">   let path = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/' +</span>
<a href="#l73.20"></a><span id="l73.20">     'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/';</span>
<a href="#l73.21"></a><span id="l73.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l74.1"></a><span id="l74.1" class="difflineminus">--- a/calendar/test/mozmill/testLocalICS.js</span>
<a href="#l74.2"></a><span id="l74.2" class="difflineplus">+++ b/calendar/test/mozmill/testLocalICS.js</span>
<a href="#l74.3"></a><span id="l74.3" class="difflineat">@@ -16,21 +16,21 @@ var TIMEOUT_MODAL_DIALOG = 30000;</span>
<a href="#l74.4"></a><span id="l74.4"> var hour = 8;</span>
<a href="#l74.5"></a><span id="l74.5"> var calendar;</span>
<a href="#l74.6"></a><span id="l74.6"> var uri;</span>
<a href="#l74.7"></a><span id="l74.7"> var file;</span>
<a href="#l74.8"></a><span id="l74.8"> var title;</span>
<a href="#l74.9"></a><span id="l74.9"> </span>
<a href="#l74.10"></a><span id="l74.10"> var setupModule = function(module) {</span>
<a href="#l74.11"></a><span id="l74.11">   controller = mozmill.getMail3PaneController();</span>
<a href="#l74.12"></a><span id="l74.12" class="difflineminus">-  modalDialog = collector.getModule('window-helpers');</span>
<a href="#l74.13"></a><span id="l74.13" class="difflineplus">+  modalDialog = collector.getModule(&quot;window-helpers&quot;);</span>
<a href="#l74.14"></a><span id="l74.14"> </span>
<a href="#l74.15"></a><span id="l74.15">   // unique name needed as deleting a calendar only unsubscribes from it</span>
<a href="#l74.16"></a><span id="l74.16">   // and if same file were used on next testrun then previously created event would show up</span>
<a href="#l74.17"></a><span id="l74.17" class="difflineminus">-  let time = (new Date()).getTime() + '';</span>
<a href="#l74.18"></a><span id="l74.18" class="difflineplus">+  let time = (new Date()).getTime() + &quot;&quot;;</span>
<a href="#l74.19"></a><span id="l74.19">   calendar = time;</span>
<a href="#l74.20"></a><span id="l74.20">   title = time;</span>
<a href="#l74.21"></a><span id="l74.21"> </span>
<a href="#l74.22"></a><span id="l74.22">   file = Services.dirsvc.get(&quot;TmpD&quot;, Components.interfaces.nsIFile);</span>
<a href="#l74.23"></a><span id="l74.23">   file.append(calendar + &quot;.ics&quot;);</span>
<a href="#l74.24"></a><span id="l74.24">   let fileURI = Services.io.newFileURI(file);</span>
<a href="#l74.25"></a><span id="l74.25">   uri = fileURI.prePath + fileURI.path;</span>
<a href="#l74.26"></a><span id="l74.26"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l75.1"></a><span id="l75.1" class="difflineminus">--- a/calendar/test/mozmill/testTodayPane.js</span>
<a href="#l75.2"></a><span id="l75.2" class="difflineplus">+++ b/calendar/test/mozmill/testTodayPane.js</span>
<a href="#l75.3"></a><span id="l75.3" class="difflineat">@@ -53,17 +53,17 @@ var testTodayPane = function() {</span>
<a href="#l75.4"></a><span id="l75.4"> </span>
<a href="#l75.5"></a><span id="l75.5">   if (startHour &lt; 8 || startHour &gt; 16) {</span>
<a href="#l75.6"></a><span id="l75.6">     view.scrollToMinute(60 * startHour);</span>
<a href="#l75.7"></a><span id="l75.7">   }</span>
<a href="#l75.8"></a><span id="l75.8"> </span>
<a href="#l75.9"></a><span id="l75.9">   controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView +</span>
<a href="#l75.10"></a><span id="l75.10">     'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/' +</span>
<a href="#l75.11"></a><span id="l75.11">     '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/' +</span>
<a href="#l75.12"></a><span id="l75.12" class="difflineminus">-    'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[' + startHour + ']'), 1, 1);</span>
<a href="#l75.13"></a><span id="l75.13" class="difflineplus">+    'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[' + startHour + &quot;]&quot;), 1, 1);</span>
<a href="#l75.14"></a><span id="l75.14">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l75.15"></a><span id="l75.15">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l75.16"></a><span id="l75.16">   let iframe = event.window.document.getElementById(&quot;lightning-item-panel-iframe&quot;);</span>
<a href="#l75.17"></a><span id="l75.17">   event.waitFor(() =&gt; iframe.contentWindow.onLoad &amp;&amp; iframe.contentWindow.onLoad.hasLoaded == true);</span>
<a href="#l75.18"></a><span id="l75.18"> </span>
<a href="#l75.19"></a><span id="l75.19">   event.waitForElement(new elementslib.Lookup(iframe.contentDocument, eventName));</span>
<a href="#l75.20"></a><span id="l75.20">   event.type(new elementslib.Lookup(iframe.contentDocument, eventName), &quot;Today's Event&quot;);</span>
<a href="#l75.21"></a><span id="l75.21">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l75.22"></a><span id="l75.22" class="difflineat">@@ -237,17 +237,17 @@ var testTodayPane = function() {</span>
<a href="#l75.23"></a><span id="l75.23"> //    || tomorrow.getAttribute(&quot;checked&quot;) != &quot;true&quot;);</span>
<a href="#l75.24"></a><span id="l75.24">   controller.assertJS(!soon.hasAttribute(&quot;checked&quot;) ||</span>
<a href="#l75.25"></a><span id="l75.25">     soon.getAttribute(&quot;checked&quot;) != &quot;true&quot;);</span>
<a href="#l75.26"></a><span id="l75.26"> };</span>
<a href="#l75.27"></a><span id="l75.27"> </span>
<a href="#l75.28"></a><span id="l75.28"> var getIsoDate = function() {</span>
<a href="#l75.29"></a><span id="l75.29">   let date = new Date();</span>
<a href="#l75.30"></a><span id="l75.30">   let year = date.getFullYear();</span>
<a href="#l75.31"></a><span id="l75.31" class="difflineminus">-  let month = (date.getMonth() &lt; 9) ? '0' + (date.getMonth() + 1) : (date.getMonth() + 1);</span>
<a href="#l75.32"></a><span id="l75.32" class="difflineminus">-  let day = (date.getDate() &lt; 10) ? '0' + date.getDate() : date.getDate();</span>
<a href="#l75.33"></a><span id="l75.33" class="difflineminus">-  let isoDate = year + '' + month + '' + day;</span>
<a href="#l75.34"></a><span id="l75.34" class="difflineplus">+  let month = (date.getMonth() &lt; 9) ? &quot;0&quot; + (date.getMonth() + 1) : (date.getMonth() + 1);</span>
<a href="#l75.35"></a><span id="l75.35" class="difflineplus">+  let day = (date.getDate() &lt; 10) ? &quot;0&quot; + date.getDate() : date.getDate();</span>
<a href="#l75.36"></a><span id="l75.36" class="difflineplus">+  let isoDate = year + &quot;&quot; + month + &quot;&quot; + day;</span>
<a href="#l75.37"></a><span id="l75.37">   return isoDate;</span>
<a href="#l75.38"></a><span id="l75.38"> };</span>
<a href="#l75.39"></a><span id="l75.39"> </span>
<a href="#l75.40"></a><span id="l75.40"> var teardownTest = function(module) {</span>
<a href="#l75.41"></a><span id="l75.41">   calUtils.deleteCalendars(controller, MOZMILL_CALENDAR);</span>
<a href="#l75.42"></a><span id="l75.42"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l76.1"></a><span id="l76.1" class="difflineminus">--- a/calendar/test/mozmill/views/testDayView.js</span>
<a href="#l76.2"></a><span id="l76.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testDayView.js</span>
<a href="#l76.3"></a><span id="l76.3" class="difflineat">@@ -65,17 +65,17 @@ var testDayView = function() {</span>
<a href="#l76.4"></a><span id="l76.4"> </span>
<a href="#l76.5"></a><span id="l76.5">   // check that the start time is correct</span>
<a href="#l76.6"></a><span id="l76.6">   let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l76.7"></a><span id="l76.7">     'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l76.8"></a><span id="l76.8">     'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/' +</span>
<a href="#l76.9"></a><span id="l76.9">     'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/' +</span>
<a href="#l76.10"></a><span id="l76.10">     'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l76.11"></a><span id="l76.11">   event.waitForElement(startTimeInput);</span>
<a href="#l76.12"></a><span id="l76.12" class="difflineminus">-  event.assertValue(startTimeInput, '8:00');</span>
<a href="#l76.13"></a><span id="l76.13" class="difflineplus">+  event.assertValue(startTimeInput, &quot;8:00&quot;);</span>
<a href="#l76.14"></a><span id="l76.14">   let date = startdate = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l76.15"></a><span id="l76.15">     2009, 1, 1);</span>
<a href="#l76.16"></a><span id="l76.16">   event.assertValue(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l76.17"></a><span id="l76.17">     'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l76.18"></a><span id="l76.18">     'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' +</span>
<a href="#l76.19"></a><span id="l76.19">     'anon({&quot;flex&quot;:&quot;1&quot;,&quot;id&quot;:&quot;hbox&quot;,&quot;class&quot;:&quot;datepicker-box-class&quot;})/' +</span>
<a href="#l76.20"></a><span id="l76.20">     '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/' +</span>
<a href="#l76.21"></a><span id="l76.21">     'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l77.1"></a><span id="l77.1" class="difflineminus">--- a/calendar/test/mozmill/views/testMonthView.js</span>
<a href="#l77.2"></a><span id="l77.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testMonthView.js</span>
<a href="#l77.3"></a><span id="l77.3" class="difflineat">@@ -66,17 +66,17 @@ var testMonthView = function() {</span>
<a href="#l77.4"></a><span id="l77.4">     'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/' +</span>
<a href="#l77.5"></a><span id="l77.5">     '[0]/{&quot;selected&quot;:&quot;true&quot;}/anon({&quot;anonid&quot;:&quot;day-items&quot;})'));</span>
<a href="#l77.6"></a><span id="l77.6">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l77.7"></a><span id="l77.7">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l77.8"></a><span id="l77.8"> </span>
<a href="#l77.9"></a><span id="l77.9">   // check that the start time is correct</span>
<a href="#l77.10"></a><span id="l77.10">   // next full hour except last hour hour of the day</span>
<a href="#l77.11"></a><span id="l77.11">   let nextHour = (hour == 23) ? hour : (hour + 1) % 24;</span>
<a href="#l77.12"></a><span id="l77.12" class="difflineminus">-  let startTime = nextHour + ':00'; // next full hour</span>
<a href="#l77.13"></a><span id="l77.13" class="difflineplus">+  let startTime = nextHour + &quot;:00&quot;; // next full hour</span>
<a href="#l77.14"></a><span id="l77.14">   let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l77.15"></a><span id="l77.15">     'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l77.16"></a><span id="l77.16">     'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/' +</span>
<a href="#l77.17"></a><span id="l77.17">     'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/' +</span>
<a href="#l77.18"></a><span id="l77.18">     'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l77.19"></a><span id="l77.19">   event.waitForElement(startTimeInput);</span>
<a href="#l77.20"></a><span id="l77.20">   event.assertValue(startTimeInput, startTime);</span>
<a href="#l77.21"></a><span id="l77.21">   let date = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l78.1"></a><span id="l78.1" class="difflineminus">--- a/calendar/test/mozmill/views/testMultiweekView.js</span>
<a href="#l78.2"></a><span id="l78.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testMultiweekView.js</span>
<a href="#l78.3"></a><span id="l78.3" class="difflineat">@@ -66,17 +66,17 @@ var testMultiWeekView = function() {</span>
<a href="#l78.4"></a><span id="l78.4">     'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/' +</span>
<a href="#l78.5"></a><span id="l78.5">     '[0]/{&quot;selected&quot;:&quot;true&quot;}/anon({&quot;anonid&quot;:&quot;day-items&quot;})'));</span>
<a href="#l78.6"></a><span id="l78.6">   controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l78.7"></a><span id="l78.7">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l78.8"></a><span id="l78.8"> </span>
<a href="#l78.9"></a><span id="l78.9">   // check that the start time is correct</span>
<a href="#l78.10"></a><span id="l78.10">   // next full hour except last hour hour of the day</span>
<a href="#l78.11"></a><span id="l78.11">   let nextHour = (hour == 23) ? hour : (hour + 1) % 24;</span>
<a href="#l78.12"></a><span id="l78.12" class="difflineminus">-  let startTime = nextHour + ':00';</span>
<a href="#l78.13"></a><span id="l78.13" class="difflineplus">+  let startTime = nextHour + &quot;:00&quot;;</span>
<a href="#l78.14"></a><span id="l78.14">   let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l78.15"></a><span id="l78.15">     'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l78.16"></a><span id="l78.16">     'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/' +</span>
<a href="#l78.17"></a><span id="l78.17">     'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/' +</span>
<a href="#l78.18"></a><span id="l78.18">     'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l78.19"></a><span id="l78.19">   event.waitForElement(startTimeInput);</span>
<a href="#l78.20"></a><span id="l78.20">   event.assertValue(startTimeInput, startTime);</span>
<a href="#l78.21"></a><span id="l78.21">   let date = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l79.1"></a><span id="l79.1" class="difflineminus">--- a/calendar/test/mozmill/views/testTaskView.js</span>
<a href="#l79.2"></a><span id="l79.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testTaskView.js</span>
<a href="#l79.3"></a><span id="l79.3" class="difflineat">@@ -123,29 +123,29 @@ var testTaskView = function() {</span>
<a href="#l79.4"></a><span id="l79.4">   controller.sleep(sleep);</span>
<a href="#l79.5"></a><span id="l79.5">   let priorityNode = new elementslib.ID(controller.window.document, &quot;calendar-task-details-priority-high&quot;);</span>
<a href="#l79.6"></a><span id="l79.6">   controller.assertNotDOMProperty(priorityNode, &quot;hidden&quot;);</span>
<a href="#l79.7"></a><span id="l79.7"> </span>
<a href="#l79.8"></a><span id="l79.8">   // verify that tooltip shows status, priority and percent complete</span>
<a href="#l79.9"></a><span id="l79.9">   let toolTipNode = new elementslib.Lookup(controller.window.document, toolTip).getNode();</span>
<a href="#l79.10"></a><span id="l79.10">   toolTipNode.ownerDocument.defaultView.showToolTip(toolTipNode, taskTreeNode.getTaskAtRow(0));</span>
<a href="#l79.11"></a><span id="l79.11"> </span>
<a href="#l79.12"></a><span id="l79.12" class="difflineminus">-  let toolTipName = new elementslib.Lookup(controller.window.document, toolTipGrid + '[1]/[0]/[1]');</span>
<a href="#l79.13"></a><span id="l79.13" class="difflineminus">-  let toolTipCalendar = new elementslib.Lookup(controller.window.document, toolTipGrid + '[1]/[1]/[1]');</span>
<a href="#l79.14"></a><span id="l79.14" class="difflineminus">-  let toolTipPriority = new elementslib.Lookup(controller.window.document, toolTipGrid + '[1]/[2]/[1]');</span>
<a href="#l79.15"></a><span id="l79.15" class="difflineminus">-  let toolTipStatus = new elementslib.Lookup(controller.window.document, toolTipGrid + '[1]/[3]/[1]');</span>
<a href="#l79.16"></a><span id="l79.16" class="difflineminus">-  let toolTipComplete = new elementslib.Lookup(controller.window.document, toolTipGrid + '[1]/[4]/[1]');</span>
<a href="#l79.17"></a><span id="l79.17" class="difflineplus">+  let toolTipName = new elementslib.Lookup(controller.window.document, toolTipGrid + &quot;[1]/[0]/[1]&quot;);</span>
<a href="#l79.18"></a><span id="l79.18" class="difflineplus">+  let toolTipCalendar = new elementslib.Lookup(controller.window.document, toolTipGrid + &quot;[1]/[1]/[1]&quot;);</span>
<a href="#l79.19"></a><span id="l79.19" class="difflineplus">+  let toolTipPriority = new elementslib.Lookup(controller.window.document, toolTipGrid + &quot;[1]/[2]/[1]&quot;);</span>
<a href="#l79.20"></a><span id="l79.20" class="difflineplus">+  let toolTipStatus = new elementslib.Lookup(controller.window.document, toolTipGrid + &quot;[1]/[3]/[1]&quot;);</span>
<a href="#l79.21"></a><span id="l79.21" class="difflineplus">+  let toolTipComplete = new elementslib.Lookup(controller.window.document, toolTipGrid + &quot;[1]/[4]/[1]&quot;);</span>
<a href="#l79.22"></a><span id="l79.22">   let priority = utils.getProperty(&quot;chrome://calendar/locale/calendar.properties&quot;,</span>
<a href="#l79.23"></a><span id="l79.23">     &quot;highPriority&quot;);</span>
<a href="#l79.24"></a><span id="l79.24"> </span>
<a href="#l79.25"></a><span id="l79.25">   controller.assertJSProperty(toolTipName, &quot;textContent&quot;, title);</span>
<a href="#l79.26"></a><span id="l79.26">   controller.assertJSProperty(toolTipCalendar, &quot;textContent&quot;, calendar);</span>
<a href="#l79.27"></a><span id="l79.27">   controller.assertJSProperty(toolTipPriority, &quot;textContent&quot;, priority);</span>
<a href="#l79.28"></a><span id="l79.28">   controller.assertJS(toolTipStatus.getNode().textContent.toLowerCase() == status.toLowerCase());</span>
<a href="#l79.29"></a><span id="l79.29" class="difflineminus">-  controller.assertJSProperty(toolTipComplete, &quot;textContent&quot;, percentComplete + '%');</span>
<a href="#l79.30"></a><span id="l79.30" class="difflineplus">+  controller.assertJSProperty(toolTipComplete, &quot;textContent&quot;, percentComplete + &quot;%&quot;);</span>
<a href="#l79.31"></a><span id="l79.31"> </span>
<a href="#l79.32"></a><span id="l79.32">   // mark completed, verify</span>
<a href="#l79.33"></a><span id="l79.33">   controller.click(new elementslib.ID(controller.window.document,</span>
<a href="#l79.34"></a><span id="l79.34">                                       &quot;task-actions-markcompleted&quot;));</span>
<a href="#l79.35"></a><span id="l79.35">   controller.sleep(sleep);</span>
<a href="#l79.36"></a><span id="l79.36"> </span>
<a href="#l79.37"></a><span id="l79.37">   status = utils.getProperty(&quot;chrome://calendar/locale/calendar.properties&quot;,</span>
<a href="#l79.38"></a><span id="l79.38">     &quot;taskDetailsStatusCompleted&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l80.1"></a><span id="l80.1" class="difflineminus">--- a/calendar/test/mozmill/views/testWeekView.js</span>
<a href="#l80.2"></a><span id="l80.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testWeekView.js</span>
<a href="#l80.3"></a><span id="l80.3" class="difflineat">@@ -68,17 +68,17 @@ var testWeekView = function() {</span>
<a href="#l80.4"></a><span id="l80.4"> </span>
<a href="#l80.5"></a><span id="l80.5">   // check that the start time is correct</span>
<a href="#l80.6"></a><span id="l80.6">   let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l80.7"></a><span id="l80.7">     'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l80.8"></a><span id="l80.8">     'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/' +</span>
<a href="#l80.9"></a><span id="l80.9">     'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/' +</span>
<a href="#l80.10"></a><span id="l80.10">     'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l80.11"></a><span id="l80.11">   event.waitForElement(startTimeInput);</span>
<a href="#l80.12"></a><span id="l80.12" class="difflineminus">-  event.assertValue(startTimeInput, '8:00');</span>
<a href="#l80.13"></a><span id="l80.13" class="difflineplus">+  event.assertValue(startTimeInput, &quot;8:00&quot;);</span>
<a href="#l80.14"></a><span id="l80.14">   let date = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l80.15"></a><span id="l80.15">     2009, 1, 1);</span>
<a href="#l80.16"></a><span id="l80.16">   event.assertValue(new elementslib.Lookup(event.window.document, eventDialog +</span>
<a href="#l80.17"></a><span id="l80.17">     'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/' +</span>
<a href="#l80.18"></a><span id="l80.18">     'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' +</span>
<a href="#l80.19"></a><span id="l80.19">     'anon({&quot;flex&quot;:&quot;1&quot;,&quot;id&quot;:&quot;hbox&quot;,&quot;class&quot;:&quot;datepicker-box-class&quot;})/' +</span>
<a href="#l80.20"></a><span id="l80.20">     '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/' +</span>
<a href="#l80.21"></a><span id="l80.21">     'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l81.1"></a><span id="l81.1" class="difflineminus">--- a/calendar/test/unit/head_consts.js</span>
<a href="#l81.2"></a><span id="l81.2" class="difflineplus">+++ b/calendar/test/unit/head_consts.js</span>
<a href="#l81.3"></a><span id="l81.3" class="difflineat">@@ -230,17 +230,17 @@ function do_calendar_startup(callback) {</span>
<a href="#l81.4"></a><span id="l81.4">     let obs = {</span>
<a href="#l81.5"></a><span id="l81.5">       observe: function() {</span>
<a href="#l81.6"></a><span id="l81.6">         Services.obs.removeObserver(this, &quot;calendar-startup-done&quot;);</span>
<a href="#l81.7"></a><span id="l81.7">         do_test_finished();</span>
<a href="#l81.8"></a><span id="l81.8">         do_execute_soon(callback);</span>
<a href="#l81.9"></a><span id="l81.9">       }</span>
<a href="#l81.10"></a><span id="l81.10">     };</span>
<a href="#l81.11"></a><span id="l81.11"> </span>
<a href="#l81.12"></a><span id="l81.12" class="difflineminus">-    let ss = Components.classes['@mozilla.org/calendar/startup-service;1']</span>
<a href="#l81.13"></a><span id="l81.13" class="difflineplus">+    let ss = Components.classes[&quot;@mozilla.org/calendar/startup-service;1&quot;]</span>
<a href="#l81.14"></a><span id="l81.14">                        .getService(Components.interfaces.nsISupports).wrappedJSObject;</span>
<a href="#l81.15"></a><span id="l81.15"> </span>
<a href="#l81.16"></a><span id="l81.16">     if (ss.started) {</span>
<a href="#l81.17"></a><span id="l81.17">         callback();</span>
<a href="#l81.18"></a><span id="l81.18">     } else {</span>
<a href="#l81.19"></a><span id="l81.19">         do_test_pending();</span>
<a href="#l81.20"></a><span id="l81.20">         Services.obs.addObserver(obs, &quot;calendar-startup-done&quot;, false);</span>
<a href="#l81.21"></a><span id="l81.21">         if (_profileInitialized) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l82.1"></a><span id="l82.1" class="difflineminus">--- a/calendar/test/unit/test_attendee.js</span>
<a href="#l82.2"></a><span id="l82.2" class="difflineplus">+++ b/calendar/test/unit/test_attendee.js</span>
<a href="#l82.3"></a><span id="l82.3" class="difflineat">@@ -215,43 +215,43 @@ function test_doubleParameters() {</span>
<a href="#l82.4"></a><span id="l82.4">             }</span>
<a href="#l82.5"></a><span id="l82.5">             ok(parNames.length == aExpected[att_n].param.length,</span>
<a href="#l82.6"></a><span id="l82.6">                &quot;Each parameter has been considered for &quot; + att_n);</span>
<a href="#l82.7"></a><span id="l82.7">         }</span>
<a href="#l82.8"></a><span id="l82.8">     }</span>
<a href="#l82.9"></a><span id="l82.9"> </span>
<a href="#l82.10"></a><span id="l82.10">     // Event with attendees and organizer with one of the parameter duplicated.</span>
<a href="#l82.11"></a><span id="l82.11">     let ics = [</span>
<a href="#l82.12"></a><span id="l82.12" class="difflineminus">-        'BEGIN:VCALENDAR',</span>
<a href="#l82.13"></a><span id="l82.13" class="difflineminus">-        'VERSION:2.0',</span>
<a href="#l82.14"></a><span id="l82.14" class="difflineminus">-        'PRODID:-//Marketcircle Inc.//Daylite 4.0//EN',</span>
<a href="#l82.15"></a><span id="l82.15" class="difflineminus">-        'BEGIN:VEVENT',</span>
<a href="#l82.16"></a><span id="l82.16" class="difflineminus">-        'DTSTART:20130529T100000',</span>
<a href="#l82.17"></a><span id="l82.17" class="difflineminus">-        'DTEND:20130529T110000',</span>
<a href="#l82.18"></a><span id="l82.18" class="difflineminus">-        'SUMMARY:Summary',</span>
<a href="#l82.19"></a><span id="l82.19" class="difflineminus">-        'CREATED:20130514T124220Z',</span>
<a href="#l82.20"></a><span id="l82.20" class="difflineminus">-        'DTSTAMP:20130524T101307Z',</span>
<a href="#l82.21"></a><span id="l82.21" class="difflineminus">-        'UID:9482DDFA-07B4-44B9-8228-ED4BC17BA278',</span>
<a href="#l82.22"></a><span id="l82.22" class="difflineminus">-        'SEQUENCE:3',</span>
<a href="#l82.23"></a><span id="l82.23" class="difflineminus">-        'ORGANIZER;CN=CN_organizer;X-ORACLE-GUID=A5120D71D6193E11E04400144F;',</span>
<a href="#l82.24"></a><span id="l82.24" class="difflineminus">-        ' X-UW-AVAILABLE-APPOINTMENT-ROLE=OWNER;X-UW-AVAILABLE-APPOINTMENT',</span>
<a href="#l82.25"></a><span id="l82.25" class="difflineminus">-        ' -ROLE=OWNER:mailto:organizer@example.com',</span>
<a href="#l82.26"></a><span id="l82.26" class="difflineminus">-        'ATTENDEE;ROLE=REQ-PARTICIPANT;RSVP=TRUE;CUTYPE=INDIVIDUAL;RSVP=TRUE;',</span>
<a href="#l82.27"></a><span id="l82.27" class="difflineminus">-        ' PARTSTAT=NEEDS-ACTION;X-RECEIVED-DTSTAMP=',</span>
<a href="#l82.28"></a><span id="l82.28" class="difflineminus">-        ' 20130827T124944Z;CN=CN_attendee1:mailto:attendee1@example.com',</span>
<a href="#l82.29"></a><span id="l82.29" class="difflineminus">-        'ATTENDEE;ROLE=CHAIR;CN=CN_attendee2;CUTYPE=INDIVIDUAL;',</span>
<a href="#l82.30"></a><span id="l82.30" class="difflineminus">-        ' PARTSTAT=ACCEPTED;CN=CN_attendee2:mailto:attendee2@example.com',</span>
<a href="#l82.31"></a><span id="l82.31" class="difflineminus">-        'ATTENDEE;ROLE=REQ-PARTICIPANT;RSVP=TRUE;CUTYPE=RESOURCE;',</span>
<a href="#l82.32"></a><span id="l82.32" class="difflineminus">-        ' PARTSTAT=NEEDS-ACTION;ROLE=REQ-PARTICIPANT;CN=CN_attendee3',</span>
<a href="#l82.33"></a><span id="l82.33" class="difflineminus">-        ' :mailto:attendee3@example.com',</span>
<a href="#l82.34"></a><span id="l82.34" class="difflineplus">+        &quot;BEGIN:VCALENDAR&quot;,</span>
<a href="#l82.35"></a><span id="l82.35" class="difflineplus">+        &quot;VERSION:2.0&quot;,</span>
<a href="#l82.36"></a><span id="l82.36" class="difflineplus">+        &quot;PRODID:-//Marketcircle Inc.//Daylite 4.0//EN&quot;,</span>
<a href="#l82.37"></a><span id="l82.37" class="difflineplus">+        &quot;BEGIN:VEVENT&quot;,</span>
<a href="#l82.38"></a><span id="l82.38" class="difflineplus">+        &quot;DTSTART:20130529T100000&quot;,</span>
<a href="#l82.39"></a><span id="l82.39" class="difflineplus">+        &quot;DTEND:20130529T110000&quot;,</span>
<a href="#l82.40"></a><span id="l82.40" class="difflineplus">+        &quot;SUMMARY:Summary&quot;,</span>
<a href="#l82.41"></a><span id="l82.41" class="difflineplus">+        &quot;CREATED:20130514T124220Z&quot;,</span>
<a href="#l82.42"></a><span id="l82.42" class="difflineplus">+        &quot;DTSTAMP:20130524T101307Z&quot;,</span>
<a href="#l82.43"></a><span id="l82.43" class="difflineplus">+        &quot;UID:9482DDFA-07B4-44B9-8228-ED4BC17BA278&quot;,</span>
<a href="#l82.44"></a><span id="l82.44" class="difflineplus">+        &quot;SEQUENCE:3&quot;,</span>
<a href="#l82.45"></a><span id="l82.45" class="difflineplus">+        &quot;ORGANIZER;CN=CN_organizer;X-ORACLE-GUID=A5120D71D6193E11E04400144F;&quot;,</span>
<a href="#l82.46"></a><span id="l82.46" class="difflineplus">+        &quot; X-UW-AVAILABLE-APPOINTMENT-ROLE=OWNER;X-UW-AVAILABLE-APPOINTMENT&quot;,</span>
<a href="#l82.47"></a><span id="l82.47" class="difflineplus">+        &quot; -ROLE=OWNER:mailto:organizer@example.com&quot;,</span>
<a href="#l82.48"></a><span id="l82.48" class="difflineplus">+        &quot;ATTENDEE;ROLE=REQ-PARTICIPANT;RSVP=TRUE;CUTYPE=INDIVIDUAL;RSVP=TRUE;&quot;,</span>
<a href="#l82.49"></a><span id="l82.49" class="difflineplus">+        &quot; PARTSTAT=NEEDS-ACTION;X-RECEIVED-DTSTAMP=&quot;,</span>
<a href="#l82.50"></a><span id="l82.50" class="difflineplus">+        &quot; 20130827T124944Z;CN=CN_attendee1:mailto:attendee1@example.com&quot;,</span>
<a href="#l82.51"></a><span id="l82.51" class="difflineplus">+        &quot;ATTENDEE;ROLE=CHAIR;CN=CN_attendee2;CUTYPE=INDIVIDUAL;&quot;,</span>
<a href="#l82.52"></a><span id="l82.52" class="difflineplus">+        &quot; PARTSTAT=ACCEPTED;CN=CN_attendee2:mailto:attendee2@example.com&quot;,</span>
<a href="#l82.53"></a><span id="l82.53" class="difflineplus">+        &quot;ATTENDEE;ROLE=REQ-PARTICIPANT;RSVP=TRUE;CUTYPE=RESOURCE;&quot;,</span>
<a href="#l82.54"></a><span id="l82.54" class="difflineplus">+        &quot; PARTSTAT=NEEDS-ACTION;ROLE=REQ-PARTICIPANT;CN=CN_attendee3&quot;,</span>
<a href="#l82.55"></a><span id="l82.55" class="difflineplus">+        &quot; :mailto:attendee3@example.com&quot;,</span>
<a href="#l82.56"></a><span id="l82.56">         'ATTENDEE;CN=&quot;CN_attendee4&quot;;PARTSTAT=ACCEPTED;X-RECEIVED-DTSTAMP=',</span>
<a href="#l82.57"></a><span id="l82.57" class="difflineminus">-        ' 20130827T124944Z;X-RECEIVED-SEQUENCE=0;X-RECEIVED-SEQUENCE=0',</span>
<a href="#l82.58"></a><span id="l82.58" class="difflineminus">-        ' :mailto:attendee4@example.com',</span>
<a href="#l82.59"></a><span id="l82.59" class="difflineminus">-        'END:VEVENT',</span>
<a href="#l82.60"></a><span id="l82.60" class="difflineminus">-        'END:VCALENDAR'</span>
<a href="#l82.61"></a><span id="l82.61" class="difflineplus">+        &quot; 20130827T124944Z;X-RECEIVED-SEQUENCE=0;X-RECEIVED-SEQUENCE=0&quot;,</span>
<a href="#l82.62"></a><span id="l82.62" class="difflineplus">+        &quot; :mailto:attendee4@example.com&quot;,</span>
<a href="#l82.63"></a><span id="l82.63" class="difflineplus">+        &quot;END:VEVENT&quot;,</span>
<a href="#l82.64"></a><span id="l82.64" class="difflineplus">+        &quot;END:VCALENDAR&quot;</span>
<a href="#l82.65"></a><span id="l82.65">     ].join(&quot;\n&quot;);</span>
<a href="#l82.66"></a><span id="l82.66"> </span>
<a href="#l82.67"></a><span id="l82.67">     let expectedOrganizer = {</span>
<a href="#l82.68"></a><span id="l82.68">         organizer: {</span>
<a href="#l82.69"></a><span id="l82.69">             param:  [&quot;CN&quot;, &quot;X-ORACLE-GUID&quot;, &quot;X-UW-AVAILABLE-APPOINTMENT-ROLE&quot;],</span>
<a href="#l82.70"></a><span id="l82.70">             values: [&quot;CN_organizer&quot;, &quot;A5120D71D6193E11E04400144F&quot;, &quot;OWNER&quot;]</span>
<a href="#l82.71"></a><span id="l82.71">         }</span>
<a href="#l82.72"></a><span id="l82.72">     };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l83.1"></a><span id="l83.1" class="difflineminus">--- a/calendar/test/unit/test_bug1204255.js</span>
<a href="#l83.2"></a><span id="l83.2" class="difflineplus">+++ b/calendar/test/unit/test_bug1204255.js</span>
<a href="#l83.3"></a><span id="l83.3" class="difflineat">@@ -62,25 +62,25 @@ function test_newAttendee() {</span>
<a href="#l83.4"></a><span id="l83.4">         equal(readAttendee.id, test.expected.id);</span>
<a href="#l83.5"></a><span id="l83.5">         equal(readAttendee.participationStatus, test.expected.partstat, &quot;partstat matches for &quot; + test.expected.id);</span>
<a href="#l83.6"></a><span id="l83.6">         equal(readAttendee.commonName, test.expected.cn, &quot;cn matches for &quot; + test.expected.id);</span>
<a href="#l83.7"></a><span id="l83.7">     }</span>
<a href="#l83.8"></a><span id="l83.8"> }</span>
<a href="#l83.9"></a><span id="l83.9"> </span>
<a href="#l83.10"></a><span id="l83.10"> function test_fromICS() {</span>
<a href="#l83.11"></a><span id="l83.11">     let ics = [</span>
<a href="#l83.12"></a><span id="l83.12" class="difflineminus">-        'BEGIN:VCALENDAR',</span>
<a href="#l83.13"></a><span id="l83.13" class="difflineminus">-        'PRODID:-//Mozilla.org/NONSGML Mozilla Calendar V1.1//EN',</span>
<a href="#l83.14"></a><span id="l83.14" class="difflineminus">-        'VERSION:2.0',</span>
<a href="#l83.15"></a><span id="l83.15" class="difflineminus">-        'BEGIN:VEVENT',</span>
<a href="#l83.16"></a><span id="l83.16" class="difflineminus">-        'UID:a84c74d1-cfc6-4ddf-9d60-9e4afd8238cf',</span>
<a href="#l83.17"></a><span id="l83.17" class="difflineminus">-        'SUMMARY:New Event',</span>
<a href="#l83.18"></a><span id="l83.18" class="difflineminus">-        'DTSTART:20150729T103000Z',</span>
<a href="#l83.19"></a><span id="l83.19" class="difflineminus">-        'DTEND:20150729T113000Z',</span>
<a href="#l83.20"></a><span id="l83.20" class="difflineminus">-        'ORGANIZER;RSVP=TRUE;CN=Tester1;PARTSTAT=ACCEPTED;ROLE=CHAIR:mailto:user1@example.net',</span>
<a href="#l83.21"></a><span id="l83.21" class="difflineplus">+        &quot;BEGIN:VCALENDAR&quot;,</span>
<a href="#l83.22"></a><span id="l83.22" class="difflineplus">+        &quot;PRODID:-//Mozilla.org/NONSGML Mozilla Calendar V1.1//EN&quot;,</span>
<a href="#l83.23"></a><span id="l83.23" class="difflineplus">+        &quot;VERSION:2.0&quot;,</span>
<a href="#l83.24"></a><span id="l83.24" class="difflineplus">+        &quot;BEGIN:VEVENT&quot;,</span>
<a href="#l83.25"></a><span id="l83.25" class="difflineplus">+        &quot;UID:a84c74d1-cfc6-4ddf-9d60-9e4afd8238cf&quot;,</span>
<a href="#l83.26"></a><span id="l83.26" class="difflineplus">+        &quot;SUMMARY:New Event&quot;,</span>
<a href="#l83.27"></a><span id="l83.27" class="difflineplus">+        &quot;DTSTART:20150729T103000Z&quot;,</span>
<a href="#l83.28"></a><span id="l83.28" class="difflineplus">+        &quot;DTEND:20150729T113000Z&quot;,</span>
<a href="#l83.29"></a><span id="l83.29" class="difflineplus">+        &quot;ORGANIZER;RSVP=TRUE;CN=Tester1;PARTSTAT=ACCEPTED;ROLE=CHAIR:mailto:user1@example.net&quot;,</span>
<a href="#l83.30"></a><span id="l83.30"> </span>
<a href="#l83.31"></a><span id="l83.31">         'ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=&quot;NOT PREFIXED&quot;;ROLE=REQ-PARTICIPANT:user2@example.net',</span>
<a href="#l83.32"></a><span id="l83.32">         'ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=&quot;PREFIXED&quot;;ROLE=REQ-PARTICIPANT:mailto:user2@example.net',</span>
<a href="#l83.33"></a><span id="l83.33"> </span>
<a href="#l83.34"></a><span id="l83.34">         'ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=&quot;PREFIXED&quot;;ROLE=REQ-PARTICIPANT:mailto:user3@example.net',</span>
<a href="#l83.35"></a><span id="l83.35">         'ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=&quot;NOT PREFIXED&quot;;ROLE=REQ-PARTICIPANT:user3@example.net',</span>
<a href="#l83.36"></a><span id="l83.36"> </span>
<a href="#l83.37"></a><span id="l83.37">         'ATTENDEE;RSVP=TRUE;PARTSTAT=ACCEPTED;CN=&quot;PREFIXED&quot;;ROLE=REQ-PARTICIPANT:mailto:user4@example.net',</span>
<a href="#l83.38"></a><span id="l83.38" class="difflineat">@@ -89,18 +89,18 @@ function test_fromICS() {</span>
<a href="#l83.39"></a><span id="l83.39">         'ATTENDEE;RSVP=TRUE;PARTSTAT=TENTATIVE;CN=&quot;NOT PREFIXED&quot;;ROLE=REQ-PARTICIPANT:user5@example.net',</span>
<a href="#l83.40"></a><span id="l83.40">         'ATTENDEE;RSVP=TRUE;PARTSTAT=ACCEPTED;CN=&quot;PREFIXED&quot;;ROLE=REQ-PARTICIPANT:mailto:user5@example.net',</span>
<a href="#l83.41"></a><span id="l83.41"> </span>
<a href="#l83.42"></a><span id="l83.42">         'ATTENDEE;RSVP=TRUE;PARTSTAT=DECLINED;CN=&quot;NOT PREFIXED&quot;;ROLE=REQ-PARTICIPANT:user6@example.net',</span>
<a href="#l83.43"></a><span id="l83.43">         'ATTENDEE;RSVP=TRUE;PARTSTAT=TENTATIVE;CN=&quot;PREFIXED&quot;;ROLE=REQ-PARTICIPANT:mailto:user6@example.net',</span>
<a href="#l83.44"></a><span id="l83.44"> </span>
<a href="#l83.45"></a><span id="l83.45">         'ATTENDEE;RSVP=TRUE;PARTSTAT=TENTATIVE;CN=&quot;NOT PREFIXED&quot;;ROLE=REQ-PARTICIPANT:user7@example.net',</span>
<a href="#l83.46"></a><span id="l83.46">         'ATTENDEE;RSVP=TRUE;PARTSTAT=DECLINED;CN=&quot;PREFIXED&quot;;ROLE=REQ-PARTICIPANT:mailto:user7@example.net',</span>
<a href="#l83.47"></a><span id="l83.47" class="difflineminus">-        'END:VEVENT',</span>
<a href="#l83.48"></a><span id="l83.48" class="difflineminus">-        'END:VCALENDAR'</span>
<a href="#l83.49"></a><span id="l83.49" class="difflineplus">+        &quot;END:VEVENT&quot;,</span>
<a href="#l83.50"></a><span id="l83.50" class="difflineplus">+        &quot;END:VCALENDAR&quot;</span>
<a href="#l83.51"></a><span id="l83.51">     ].join(&quot;\n&quot;);</span>
<a href="#l83.52"></a><span id="l83.52"> </span>
<a href="#l83.53"></a><span id="l83.53">     let expected = [</span>
<a href="#l83.54"></a><span id="l83.54">         { id: &quot;mailto:user2@example.net&quot;, partstat: &quot;NEEDS-ACTION&quot;, cn: &quot;PREFIXED&quot; },</span>
<a href="#l83.55"></a><span id="l83.55">         { id: &quot;mailto:user3@example.net&quot;, partstat: &quot;NEEDS-ACTION&quot;, cn: &quot;NOT PREFIXED&quot; },</span>
<a href="#l83.56"></a><span id="l83.56">         { id: &quot;mailto:user4@example.net&quot;, partstat: &quot;ACCEPTED&quot;, cn: &quot;PREFIXED&quot; },</span>
<a href="#l83.57"></a><span id="l83.57">         { id: &quot;mailto:user5@example.net&quot;, partstat: &quot;TENTATIVE&quot;, cn: &quot;NOT PREFIXED&quot; },</span>
<a href="#l83.58"></a><span id="l83.58">         { id: &quot;mailto:user6@example.net&quot;, partstat: &quot;DECLINED&quot;, cn: &quot;NOT PREFIXED&quot; },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l84.1"></a><span id="l84.1" class="difflineminus">--- a/calendar/test/unit/test_bug1209399.js</span>
<a href="#l84.2"></a><span id="l84.2" class="difflineplus">+++ b/calendar/test/unit/test_bug1209399.js</span>
<a href="#l84.3"></a><span id="l84.3" class="difflineat">@@ -7,41 +7,41 @@ Components.utils.import(&quot;resource://cale</span>
<a href="#l84.4"></a><span id="l84.4"> function run_test() {</span>
<a href="#l84.5"></a><span id="l84.5">     // Test handling for multiple double quotes leading/trailing to attendee CN for bug 1209399</span>
<a href="#l84.6"></a><span id="l84.6">     test_newAttendee();</span>
<a href="#l84.7"></a><span id="l84.7">     test_fromICS();</span>
<a href="#l84.8"></a><span id="l84.8"> }</span>
<a href="#l84.9"></a><span id="l84.9"> </span>
<a href="#l84.10"></a><span id="l84.10"> function test_newAttendee() {</span>
<a href="#l84.11"></a><span id="l84.11">     let data = [{</span>
<a href="#l84.12"></a><span id="l84.12" class="difflineminus">-        input: { cn: null, id: 'mailto:user1@example.net' },</span>
<a href="#l84.13"></a><span id="l84.13" class="difflineplus">+        input: { cn: null, id: &quot;mailto:user1@example.net&quot; },</span>
<a href="#l84.14"></a><span id="l84.14">         expected: { cn: null }</span>
<a href="#l84.15"></a><span id="l84.15">     }, {</span>
<a href="#l84.16"></a><span id="l84.16" class="difflineminus">-        input: { cn: 'Test2', id: 'mailto:user2@example.net' },</span>
<a href="#l84.17"></a><span id="l84.17" class="difflineminus">-        expected: { cn: 'Test2' }</span>
<a href="#l84.18"></a><span id="l84.18" class="difflineplus">+        input: { cn: &quot;Test2&quot;, id: &quot;mailto:user2@example.net&quot; },</span>
<a href="#l84.19"></a><span id="l84.19" class="difflineplus">+        expected: { cn: &quot;Test2&quot; }</span>
<a href="#l84.20"></a><span id="l84.20">     }, {</span>
<a href="#l84.21"></a><span id="l84.21" class="difflineminus">-        input: { cn: '&quot;Test3&quot;', id: 'mailto:user3@example.net' },</span>
<a href="#l84.22"></a><span id="l84.22" class="difflineminus">-        expected: { cn: 'Test3' }</span>
<a href="#l84.23"></a><span id="l84.23" class="difflineplus">+        input: { cn: '&quot;Test3&quot;', id: &quot;mailto:user3@example.net&quot; },</span>
<a href="#l84.24"></a><span id="l84.24" class="difflineplus">+        expected: { cn: &quot;Test3&quot; }</span>
<a href="#l84.25"></a><span id="l84.25">     }, {</span>
<a href="#l84.26"></a><span id="l84.26" class="difflineminus">-        input: { cn: '&quot;&quot;Test4&quot;&quot;', id: 'mailto:user4@example.net' },</span>
<a href="#l84.27"></a><span id="l84.27" class="difflineminus">-        expected: { cn: 'Test4' }</span>
<a href="#l84.28"></a><span id="l84.28" class="difflineplus">+        input: { cn: '&quot;&quot;Test4&quot;&quot;', id: &quot;mailto:user4@example.net&quot; },</span>
<a href="#l84.29"></a><span id="l84.29" class="difflineplus">+        expected: { cn: &quot;Test4&quot; }</span>
<a href="#l84.30"></a><span id="l84.30">     }, {</span>
<a href="#l84.31"></a><span id="l84.31" class="difflineminus">-        input: { cn: '&quot;&quot;Test5&quot;', id: 'mailto:user5@example.net' },</span>
<a href="#l84.32"></a><span id="l84.32" class="difflineminus">-        expected: { cn: 'Test5' }</span>
<a href="#l84.33"></a><span id="l84.33" class="difflineplus">+        input: { cn: '&quot;&quot;Test5&quot;', id: &quot;mailto:user5@example.net&quot; },</span>
<a href="#l84.34"></a><span id="l84.34" class="difflineplus">+        expected: { cn: &quot;Test5&quot; }</span>
<a href="#l84.35"></a><span id="l84.35">     }, {</span>
<a href="#l84.36"></a><span id="l84.36" class="difflineminus">-        input: { cn: '&quot;Test6&quot;&quot;', id: 'mailto:user6@example.net' },</span>
<a href="#l84.37"></a><span id="l84.37" class="difflineminus">-        expected: { cn: 'Test6' }</span>
<a href="#l84.38"></a><span id="l84.38" class="difflineplus">+        input: { cn: '&quot;Test6&quot;&quot;', id: &quot;mailto:user6@example.net&quot; },</span>
<a href="#l84.39"></a><span id="l84.39" class="difflineplus">+        expected: { cn: &quot;Test6&quot; }</span>
<a href="#l84.40"></a><span id="l84.40">     }, {</span>
<a href="#l84.41"></a><span id="l84.41" class="difflineminus">-        input: { cn: '', id: 'mailto:user7@example.net' },</span>
<a href="#l84.42"></a><span id="l84.42" class="difflineminus">-        expected: { cn: '' }</span>
<a href="#l84.43"></a><span id="l84.43" class="difflineplus">+        input: { cn: &quot;&quot;, id: &quot;mailto:user7@example.net&quot; },</span>
<a href="#l84.44"></a><span id="l84.44" class="difflineplus">+        expected: { cn: &quot;&quot; }</span>
<a href="#l84.45"></a><span id="l84.45">     }, {</span>
<a href="#l84.46"></a><span id="l84.46" class="difflineminus">-        input: { cn: '&quot;&quot;', id: 'mailto:user8@example.net' },</span>
<a href="#l84.47"></a><span id="l84.47" class="difflineplus">+        input: { cn: '&quot;&quot;', id: &quot;mailto:user8@example.net&quot; },</span>
<a href="#l84.48"></a><span id="l84.48">         expected: { cn: null }</span>
<a href="#l84.49"></a><span id="l84.49">     }, {</span>
<a href="#l84.50"></a><span id="l84.50" class="difflineminus">-        input: { cn: '&quot;&quot;&quot;&quot;', id: 'mailto:user9@example.net' },</span>
<a href="#l84.51"></a><span id="l84.51" class="difflineplus">+        input: { cn: '&quot;&quot;&quot;&quot;', id: &quot;mailto:user9@example.net&quot; },</span>
<a href="#l84.52"></a><span id="l84.52">         expected: { cn: null }</span>
<a href="#l84.53"></a><span id="l84.53">     }];</span>
<a href="#l84.54"></a><span id="l84.54"> </span>
<a href="#l84.55"></a><span id="l84.55">     let i = 0;</span>
<a href="#l84.56"></a><span id="l84.56">     let event = cal.createEvent();</span>
<a href="#l84.57"></a><span id="l84.57">     for (let test of data) {</span>
<a href="#l84.58"></a><span id="l84.58">         i++;</span>
<a href="#l84.59"></a><span id="l84.59">         let attendee = cal.createAttendee();</span>
<a href="#l84.60"></a><span id="l84.60" class="difflineat">@@ -52,46 +52,46 @@ function test_newAttendee() {</span>
<a href="#l84.61"></a><span id="l84.61">         let readAttendee = event.getAttendeeById(test.input.id);</span>
<a href="#l84.62"></a><span id="l84.62">         equal(readAttendee.commonName, test.expected.cn,</span>
<a href="#l84.63"></a><span id="l84.63">               &quot;Test #&quot; + i + &quot; for cn matching of &quot; + test.input.id);</span>
<a href="#l84.64"></a><span id="l84.64">     }</span>
<a href="#l84.65"></a><span id="l84.65"> }</span>
<a href="#l84.66"></a><span id="l84.66"> </span>
<a href="#l84.67"></a><span id="l84.67"> function test_fromICS() {</span>
<a href="#l84.68"></a><span id="l84.68">     let ics = [</span>
<a href="#l84.69"></a><span id="l84.69" class="difflineminus">-        'BEGIN:VCALENDAR',</span>
<a href="#l84.70"></a><span id="l84.70" class="difflineminus">-        'PRODID:-//Mozilla.org/NONSGML Mozilla Calendar V1.1//EN',</span>
<a href="#l84.71"></a><span id="l84.71" class="difflineminus">-        'VERSION:2.0',</span>
<a href="#l84.72"></a><span id="l84.72" class="difflineminus">-        'BEGIN:VEVENT',</span>
<a href="#l84.73"></a><span id="l84.73" class="difflineminus">-        'UID:a84c74d1-cfc6-4ddf-9d60-9e4afd8238cf',</span>
<a href="#l84.74"></a><span id="l84.74" class="difflineminus">-        'SUMMARY:New Event',</span>
<a href="#l84.75"></a><span id="l84.75" class="difflineminus">-        'DTSTART:20150729T103000Z',</span>
<a href="#l84.76"></a><span id="l84.76" class="difflineminus">-        'DTEND:20150729T113000Z',</span>
<a href="#l84.77"></a><span id="l84.77" class="difflineminus">-        'ORGANIZER;RSVP=TRUE;CN=Tester1;PARTSTAT=ACCEPTED;ROLE=CHAIR:mailto:user1@example.net',</span>
<a href="#l84.78"></a><span id="l84.78" class="difflineplus">+        &quot;BEGIN:VCALENDAR&quot;,</span>
<a href="#l84.79"></a><span id="l84.79" class="difflineplus">+        &quot;PRODID:-//Mozilla.org/NONSGML Mozilla Calendar V1.1//EN&quot;,</span>
<a href="#l84.80"></a><span id="l84.80" class="difflineplus">+        &quot;VERSION:2.0&quot;,</span>
<a href="#l84.81"></a><span id="l84.81" class="difflineplus">+        &quot;BEGIN:VEVENT&quot;,</span>
<a href="#l84.82"></a><span id="l84.82" class="difflineplus">+        &quot;UID:a84c74d1-cfc6-4ddf-9d60-9e4afd8238cf&quot;,</span>
<a href="#l84.83"></a><span id="l84.83" class="difflineplus">+        &quot;SUMMARY:New Event&quot;,</span>
<a href="#l84.84"></a><span id="l84.84" class="difflineplus">+        &quot;DTSTART:20150729T103000Z&quot;,</span>
<a href="#l84.85"></a><span id="l84.85" class="difflineplus">+        &quot;DTEND:20150729T113000Z&quot;,</span>
<a href="#l84.86"></a><span id="l84.86" class="difflineplus">+        &quot;ORGANIZER;RSVP=TRUE;CN=Tester1;PARTSTAT=ACCEPTED;ROLE=CHAIR:mailto:user1@example.net&quot;,</span>
<a href="#l84.87"></a><span id="l84.87"> </span>
<a href="#l84.88"></a><span id="l84.88" class="difflineminus">-        'ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=Test2;ROLE=REQ-PARTICIPANT:mailto:user2@example.net',</span>
<a href="#l84.89"></a><span id="l84.89" class="difflineplus">+        &quot;ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=Test2;ROLE=REQ-PARTICIPANT:mailto:user2@example.net&quot;,</span>
<a href="#l84.90"></a><span id="l84.90">         'ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=&quot;Test3&quot;;ROLE=REQ-PARTICIPANT:mailto:user3@example.net',</span>
<a href="#l84.91"></a><span id="l84.91">         'ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=&quot;&quot;Test4&quot;&quot;;ROLE=REQ-PARTICIPANT:mailto:user4@example.net',</span>
<a href="#l84.92"></a><span id="l84.92" class="difflineminus">-        'ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=;ROLE=REQ-PARTICIPANT:mailto:user5@example.net',</span>
<a href="#l84.93"></a><span id="l84.93" class="difflineminus">-        'ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;ROLE=REQ-PARTICIPANT:mailto:user6@example.net',</span>
<a href="#l84.94"></a><span id="l84.94" class="difflineplus">+        &quot;ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=;ROLE=REQ-PARTICIPANT:mailto:user5@example.net&quot;,</span>
<a href="#l84.95"></a><span id="l84.95" class="difflineplus">+        &quot;ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;ROLE=REQ-PARTICIPANT:mailto:user6@example.net&quot;,</span>
<a href="#l84.96"></a><span id="l84.96">         'ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=&quot;&quot;;ROLE=REQ-PARTICIPANT:mailto:user7@example.net',</span>
<a href="#l84.97"></a><span id="l84.97">         'ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;CN=&quot;&quot;&quot;&quot;;ROLE=REQ-PARTICIPANT:mailto:user8@example.net',</span>
<a href="#l84.98"></a><span id="l84.98"> </span>
<a href="#l84.99"></a><span id="l84.99" class="difflineminus">-        'END:VEVENT',</span>
<a href="#l84.100"></a><span id="l84.100" class="difflineminus">-        'END:VCALENDAR'</span>
<a href="#l84.101"></a><span id="l84.101" class="difflineplus">+        &quot;END:VEVENT&quot;,</span>
<a href="#l84.102"></a><span id="l84.102" class="difflineplus">+        &quot;END:VCALENDAR&quot;</span>
<a href="#l84.103"></a><span id="l84.103">     ].join(&quot;\n&quot;);</span>
<a href="#l84.104"></a><span id="l84.104"> </span>
<a href="#l84.105"></a><span id="l84.105">     let expected = [</span>
<a href="#l84.106"></a><span id="l84.106" class="difflineminus">-        { id: 'mailto:user2@example.net', cn: 'Test2' },</span>
<a href="#l84.107"></a><span id="l84.107" class="difflineminus">-        { id: 'mailto:user3@example.net', cn: 'Test3' },</span>
<a href="#l84.108"></a><span id="l84.108" class="difflineminus">-        { id: 'mailto:user4@example.net', cn: '' },</span>
<a href="#l84.109"></a><span id="l84.109" class="difflineminus">-        { id: 'mailto:user5@example.net', cn: '' },</span>
<a href="#l84.110"></a><span id="l84.110" class="difflineminus">-        { id: 'mailto:user6@example.net', cn: null },</span>
<a href="#l84.111"></a><span id="l84.111" class="difflineminus">-        { id: 'mailto:user7@example.net', cn: '' },</span>
<a href="#l84.112"></a><span id="l84.112" class="difflineminus">-        { id: 'mailto:user8@example.net', cn: '' }</span>
<a href="#l84.113"></a><span id="l84.113" class="difflineplus">+        { id: &quot;mailto:user2@example.net&quot;, cn: &quot;Test2&quot; },</span>
<a href="#l84.114"></a><span id="l84.114" class="difflineplus">+        { id: &quot;mailto:user3@example.net&quot;, cn: &quot;Test3&quot; },</span>
<a href="#l84.115"></a><span id="l84.115" class="difflineplus">+        { id: &quot;mailto:user4@example.net&quot;, cn: &quot;&quot; },</span>
<a href="#l84.116"></a><span id="l84.116" class="difflineplus">+        { id: &quot;mailto:user5@example.net&quot;, cn: &quot;&quot; },</span>
<a href="#l84.117"></a><span id="l84.117" class="difflineplus">+        { id: &quot;mailto:user6@example.net&quot;, cn: null },</span>
<a href="#l84.118"></a><span id="l84.118" class="difflineplus">+        { id: &quot;mailto:user7@example.net&quot;, cn: &quot;&quot; },</span>
<a href="#l84.119"></a><span id="l84.119" class="difflineplus">+        { id: &quot;mailto:user8@example.net&quot;, cn: &quot;&quot; }</span>
<a href="#l84.120"></a><span id="l84.120">     ];</span>
<a href="#l84.121"></a><span id="l84.121">     let event = createEventFromIcalString(ics);</span>
<a href="#l84.122"></a><span id="l84.122"> </span>
<a href="#l84.123"></a><span id="l84.123">     equal(event.getAttendees({}).length, expected.length, &quot;Check test consistency&quot;);</span>
<a href="#l84.124"></a><span id="l84.124">     for (let exp of expected) {</span>
<a href="#l84.125"></a><span id="l84.125">         let attendee = event.getAttendeeById(exp.id);</span>
<a href="#l84.126"></a><span id="l84.126">         equal(attendee.commonName, exp.cn, &quot;Test for cn matching of &quot; + exp.id);</span>
<a href="#l84.127"></a><span id="l84.127">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l85.1"></a><span id="l85.1" class="difflineminus">--- a/calendar/test/unit/test_calutils.js</span>
<a href="#l85.2"></a><span id="l85.2" class="difflineplus">+++ b/calendar/test/unit/test_calutils.js</span>
<a href="#l85.3"></a><span id="l85.3" class="difflineat">@@ -132,98 +132,98 @@ function removeMailTo_test() {</span>
<a href="#l85.4"></a><span id="l85.4">     }</span>
<a href="#l85.5"></a><span id="l85.5"> }</span>
<a href="#l85.6"></a><span id="l85.6"> </span>
<a href="#l85.7"></a><span id="l85.7"> function resolveDelegation_test() {</span>
<a href="#l85.8"></a><span id="l85.8">     let data = [{</span>
<a href="#l85.9"></a><span id="l85.9">         input: {</span>
<a href="#l85.10"></a><span id="l85.10">             attendee:</span>
<a href="#l85.11"></a><span id="l85.11">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;;CN=&quot;Attendee 1&quot;:mailto:at' +</span>
<a href="#l85.12"></a><span id="l85.12" class="difflineminus">-                'tendee1@example.net',</span>
<a href="#l85.13"></a><span id="l85.13" class="difflineplus">+                &quot;tendee1@example.net&quot;,</span>
<a href="#l85.14"></a><span id="l85.14">             attendees: [</span>
<a href="#l85.15"></a><span id="l85.15">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;;CN=&quot;Attendee 1&quot;:mailto:at' +</span>
<a href="#l85.16"></a><span id="l85.16" class="difflineminus">-                'tendee1@example.net',</span>
<a href="#l85.17"></a><span id="l85.17" class="difflineplus">+                &quot;tendee1@example.net&quot;,</span>
<a href="#l85.18"></a><span id="l85.18">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee1@example.net&quot;;CN=&quot;Attendee 2&quot;:mailto:atte' +</span>
<a href="#l85.19"></a><span id="l85.19" class="difflineminus">-                'ndee2@example.net'</span>
<a href="#l85.20"></a><span id="l85.20" class="difflineplus">+                &quot;ndee2@example.net&quot;</span>
<a href="#l85.21"></a><span id="l85.21">             ]</span>
<a href="#l85.22"></a><span id="l85.22">         },</span>
<a href="#l85.23"></a><span id="l85.23">         expected: {</span>
<a href="#l85.24"></a><span id="l85.24" class="difflineminus">-            delegatees: '',</span>
<a href="#l85.25"></a><span id="l85.25" class="difflineminus">-            delegators: 'Attendee 2 &lt;attendee2@example.net&gt;'</span>
<a href="#l85.26"></a><span id="l85.26" class="difflineplus">+            delegatees: &quot;&quot;,</span>
<a href="#l85.27"></a><span id="l85.27" class="difflineplus">+            delegators: &quot;Attendee 2 &lt;attendee2@example.net&gt;&quot;</span>
<a href="#l85.28"></a><span id="l85.28">         }</span>
<a href="#l85.29"></a><span id="l85.29">     }, {</span>
<a href="#l85.30"></a><span id="l85.30">         input: {</span>
<a href="#l85.31"></a><span id="l85.31">             attendee:</span>
<a href="#l85.32"></a><span id="l85.32">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l85.33"></a><span id="l85.33">             attendees: [</span>
<a href="#l85.34"></a><span id="l85.34">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l85.35"></a><span id="l85.35">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee1@example.net&quot;:mailto:attendee2@example.net'</span>
<a href="#l85.36"></a><span id="l85.36">             ]</span>
<a href="#l85.37"></a><span id="l85.37">         },</span>
<a href="#l85.38"></a><span id="l85.38">         expected: {</span>
<a href="#l85.39"></a><span id="l85.39" class="difflineminus">-            delegatees: '',</span>
<a href="#l85.40"></a><span id="l85.40" class="difflineminus">-            delegators: 'attendee2@example.net'</span>
<a href="#l85.41"></a><span id="l85.41" class="difflineplus">+            delegatees: &quot;&quot;,</span>
<a href="#l85.42"></a><span id="l85.42" class="difflineplus">+            delegators: &quot;attendee2@example.net&quot;</span>
<a href="#l85.43"></a><span id="l85.43">         }</span>
<a href="#l85.44"></a><span id="l85.44">     }, {</span>
<a href="#l85.45"></a><span id="l85.45">         input: {</span>
<a href="#l85.46"></a><span id="l85.46">             attendee:</span>
<a href="#l85.47"></a><span id="l85.47">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee2@example.net&quot;;CN=&quot;Attendee 1&quot;:mailto:atte' +</span>
<a href="#l85.48"></a><span id="l85.48" class="difflineminus">-                'ndee1@example.net',</span>
<a href="#l85.49"></a><span id="l85.49" class="difflineplus">+                &quot;ndee1@example.net&quot;,</span>
<a href="#l85.50"></a><span id="l85.50">             attendees: [</span>
<a href="#l85.51"></a><span id="l85.51">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee2@example.net&quot;;CN=&quot;Attendee 1&quot;:mailto:atte' +</span>
<a href="#l85.52"></a><span id="l85.52" class="difflineminus">-                'ndee1@example.net',</span>
<a href="#l85.53"></a><span id="l85.53" class="difflineplus">+                &quot;ndee1@example.net&quot;,</span>
<a href="#l85.54"></a><span id="l85.54">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee1@example.net&quot;;CN=&quot;Attendee 2&quot;:mailto:at' +</span>
<a href="#l85.55"></a><span id="l85.55" class="difflineminus">-                'tendee2@example.net'</span>
<a href="#l85.56"></a><span id="l85.56" class="difflineplus">+                &quot;tendee2@example.net&quot;</span>
<a href="#l85.57"></a><span id="l85.57">             ]</span>
<a href="#l85.58"></a><span id="l85.58">         },</span>
<a href="#l85.59"></a><span id="l85.59">         expected: {</span>
<a href="#l85.60"></a><span id="l85.60" class="difflineminus">-            delegatees: 'Attendee 2 &lt;attendee2@example.net&gt;',</span>
<a href="#l85.61"></a><span id="l85.61" class="difflineminus">-            delegators: ''</span>
<a href="#l85.62"></a><span id="l85.62" class="difflineplus">+            delegatees: &quot;Attendee 2 &lt;attendee2@example.net&gt;&quot;,</span>
<a href="#l85.63"></a><span id="l85.63" class="difflineplus">+            delegators: &quot;&quot;</span>
<a href="#l85.64"></a><span id="l85.64">         }</span>
<a href="#l85.65"></a><span id="l85.65">     }, {</span>
<a href="#l85.66"></a><span id="l85.66">         input: {</span>
<a href="#l85.67"></a><span id="l85.67">             attendee:</span>
<a href="#l85.68"></a><span id="l85.68">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee2@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l85.69"></a><span id="l85.69">             attendees: [</span>
<a href="#l85.70"></a><span id="l85.70">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee2@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l85.71"></a><span id="l85.71">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee1@example.net&quot;:mailto:attendee2@example.net'</span>
<a href="#l85.72"></a><span id="l85.72">             ]</span>
<a href="#l85.73"></a><span id="l85.73">         },</span>
<a href="#l85.74"></a><span id="l85.74">         expected: {</span>
<a href="#l85.75"></a><span id="l85.75" class="difflineminus">-            delegatees: 'attendee2@example.net',</span>
<a href="#l85.76"></a><span id="l85.76" class="difflineminus">-            delegators: ''</span>
<a href="#l85.77"></a><span id="l85.77" class="difflineplus">+            delegatees: &quot;attendee2@example.net&quot;,</span>
<a href="#l85.78"></a><span id="l85.78" class="difflineplus">+            delegators: &quot;&quot;</span>
<a href="#l85.79"></a><span id="l85.79">         }</span>
<a href="#l85.80"></a><span id="l85.80">     }, {</span>
<a href="#l85.81"></a><span id="l85.81">         input: {</span>
<a href="#l85.82"></a><span id="l85.82">             attendee:</span>
<a href="#l85.83"></a><span id="l85.83" class="difflineminus">-                'ATTENDEE:mailto:attendee1@example.net',</span>
<a href="#l85.84"></a><span id="l85.84" class="difflineplus">+                &quot;ATTENDEE:mailto:attendee1@example.net&quot;,</span>
<a href="#l85.85"></a><span id="l85.85">             attendees: [</span>
<a href="#l85.86"></a><span id="l85.86" class="difflineminus">-                'ATTENDEE:mailto:attendee1@example.net',</span>
<a href="#l85.87"></a><span id="l85.87" class="difflineminus">-                'ATTENDEE:mailto:attendee2@example.net'</span>
<a href="#l85.88"></a><span id="l85.88" class="difflineplus">+                &quot;ATTENDEE:mailto:attendee1@example.net&quot;,</span>
<a href="#l85.89"></a><span id="l85.89" class="difflineplus">+                &quot;ATTENDEE:mailto:attendee2@example.net&quot;</span>
<a href="#l85.90"></a><span id="l85.90">             ]</span>
<a href="#l85.91"></a><span id="l85.91">         },</span>
<a href="#l85.92"></a><span id="l85.92">         expected: {</span>
<a href="#l85.93"></a><span id="l85.93" class="difflineminus">-            delegatees: '',</span>
<a href="#l85.94"></a><span id="l85.94" class="difflineminus">-            delegators: ''</span>
<a href="#l85.95"></a><span id="l85.95" class="difflineplus">+            delegatees: &quot;&quot;,</span>
<a href="#l85.96"></a><span id="l85.96" class="difflineplus">+            delegators: &quot;&quot;</span>
<a href="#l85.97"></a><span id="l85.97">         }</span>
<a href="#l85.98"></a><span id="l85.98">     }, {</span>
<a href="#l85.99"></a><span id="l85.99">         input: {</span>
<a href="#l85.100"></a><span id="l85.100">             attendee:</span>
<a href="#l85.101"></a><span id="l85.101">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;;DELEGATED-TO=&quot;mailto:atte' +</span>
<a href="#l85.102"></a><span id="l85.102">                 'ndee3@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l85.103"></a><span id="l85.103">             attendees: [</span>
<a href="#l85.104"></a><span id="l85.104">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;;DELEGATED-TO=&quot;mailto:atte' +</span>
<a href="#l85.105"></a><span id="l85.105">                 'ndee3@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l85.106"></a><span id="l85.106">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee1@example.net&quot;:mailto:attendee2@example.net',</span>
<a href="#l85.107"></a><span id="l85.107">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee1@example.net&quot;:mailto:attendee3@example.net'</span>
<a href="#l85.108"></a><span id="l85.108">             ]</span>
<a href="#l85.109"></a><span id="l85.109">         },</span>
<a href="#l85.110"></a><span id="l85.110">         expected: {</span>
<a href="#l85.111"></a><span id="l85.111" class="difflineminus">-            delegatees: 'attendee3@example.net',</span>
<a href="#l85.112"></a><span id="l85.112" class="difflineminus">-            delegators: 'attendee2@example.net'</span>
<a href="#l85.113"></a><span id="l85.113" class="difflineplus">+            delegatees: &quot;attendee3@example.net&quot;,</span>
<a href="#l85.114"></a><span id="l85.114" class="difflineplus">+            delegators: &quot;attendee2@example.net&quot;</span>
<a href="#l85.115"></a><span id="l85.115">         }</span>
<a href="#l85.116"></a><span id="l85.116">     }];</span>
<a href="#l85.117"></a><span id="l85.117">     let i = 0;</span>
<a href="#l85.118"></a><span id="l85.118">     for (let test of data) {</span>
<a href="#l85.119"></a><span id="l85.119">         i++;</span>
<a href="#l85.120"></a><span id="l85.120">         let attendees = [];</span>
<a href="#l85.121"></a><span id="l85.121">         for (let att of test.input.attendees) {</span>
<a href="#l85.122"></a><span id="l85.122">             let attendee = cal.createAttendee();</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

