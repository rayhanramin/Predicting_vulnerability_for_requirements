<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 29640:f8310228f5b2c75ff65bbb4e182eb6ce693c6e28</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ f8310228f5b2c75ff65bbb4e182eb6ce693c6e28" />
<meta property="og:url" content="/comm-central/rev/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28" />
<meta property="og:description" content="Bug 1637668 - Implement colour customization option for Folder Pane icons. r=mkmelin, ui-r=paenglab" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / f8310228f5b2c75ff65bbb4e182eb6ce693c6e28 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28">shortlog</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28">files</a> |
changeset |
<a href="/comm-central/raw-rev/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28">raw</a>  | <a href="/comm-central/archive/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1637668">Bug 1637668</a> - Implement colour customization option for Folder Pane icons. r=mkmelin, ui-r=paenglab
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#65;&#108;&#101;&#115;&#115;&#97;&#110;&#100;&#114;&#111;&#32;&#67;&#97;&#115;&#116;&#101;&#108;&#108;&#97;&#110;&#105;&#32;&#60;&#97;&#108;&#101;&#115;&#115;&#97;&#110;&#100;&#114;&#111;&#64;&#116;&#104;&#117;&#110;&#100;&#101;&#114;&#98;&#105;&#114;&#100;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 22 May 2020 12:53:51 +0300</td></tr>

<tr>
 <td>changeset 29640</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28">f8310228f5b2c75ff65bbb4e182eb6ce693c6e28</a></td>
</tr>



<tr>
<td>parent 29639</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/a15cee0df19fc84a95e32cb0e1ae1f438001c917">a15cee0df19fc84a95e32cb0e1ae1f438001c917</a>
</td>
</tr>

<tr>
<td>child 29641</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/6a077945683b32ef107dca9ceb7ed9959a5bc5c7">6a077945683b32ef107dca9ceb7ed9959a5bc5c7</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=f8310228f5b2c75ff65bbb4e182eb6ce693c6e28">17468</a></td></tr>
<tr><td>push user</td><td>mkmelin@iki.fi</td></tr>
<tr><td>push date</td><td class="date age">Fri, 22 May 2020 09:55:36 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@6a077945683b [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=6a077945683b32ef107dca9ceb7ed9959a5bc5c7">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=6a077945683b32ef107dca9ceb7ed9959a5bc5c7&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6a077945683b32ef107dca9ceb7ed9959a5bc5c7&newProject=comm-central&newRevision=f8310228f5b2c75ff65bbb4e182eb6ce693c6e28&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6a077945683b32ef107dca9ceb7ed9959a5bc5c7&newProject=comm-central&newRevision=f8310228f5b2c75ff65bbb4e182eb6ce693c6e28&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6a077945683b32ef107dca9ceb7ed9959a5bc5c7&newProject=comm-central&newRevision=f8310228f5b2c75ff65bbb4e182eb6ce693c6e28&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a>, <a href="/comm-central/log?rev=reviewer%28paenglab%29&revcount=50">paenglab</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1637668">1637668</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1637668">Bug 1637668</a> - Implement colour customization option for Folder Pane icons. r=mkmelin, ui-r=paenglab</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/folderPane.js">mail/base/content/folderPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/folderPane.js">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/folderPane.js">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/folderPane.js">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/folderPane.js">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/folderPane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/messenger.xhtml">mail/base/content/messenger.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/messenger.xhtml">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/messenger.xhtml">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/messenger.xhtml">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/messenger.xhtml">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/base/content/messenger.xhtml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/locales/en-US/chrome/messenger/folderProps.dtd">mail/locales/en-US/chrome/messenger/folderProps.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/locales/en-US/chrome/messenger/folderProps.dtd">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/locales/en-US/chrome/messenger/folderProps.dtd">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/locales/en-US/chrome/messenger/folderProps.dtd">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/locales/en-US/chrome/messenger/folderProps.dtd">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/locales/en-US/chrome/messenger/folderProps.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/jar.inc.mn">mail/themes/shared/jar.inc.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/jar.inc.mn">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/jar.inc.mn">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/jar.inc.mn">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/jar.inc.mn">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/jar.inc.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/folder.svg">mail/themes/shared/mail/icons/folder.svg</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/folder.svg">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/folder.svg">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/folder.svg">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/folder.svg">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/folder.svg">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/forget.svg">mail/themes/shared/mail/icons/forget.svg</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/forget.svg">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/forget.svg">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/forget.svg">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/forget.svg">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/icons/forget.svg">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/input-fields.css">mail/themes/shared/mail/input-fields.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/input-fields.css">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/input-fields.css">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/input-fields.css">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/input-fields.css">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mail/themes/shared/mail/input-fields.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.js">mailnews/base/content/folderProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.js">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.js">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.js">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.js">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.xhtml">mailnews/base/content/folderProps.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.xhtml">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.xhtml">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.xhtml">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.xhtml">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/folderProps.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/msgSelectOfflineFolders.xhtml">mailnews/base/content/msgSelectOfflineFolders.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/msgSelectOfflineFolders.xhtml">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/msgSelectOfflineFolders.xhtml">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/msgSelectOfflineFolders.xhtml">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/msgSelectOfflineFolders.xhtml">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/msgSelectOfflineFolders.xhtml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderListEdit.xhtml">mailnews/base/content/virtualFolderListEdit.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderListEdit.xhtml">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderListEdit.xhtml">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderListEdit.xhtml">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderListEdit.xhtml">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderListEdit.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.js">mailnews/base/content/virtualFolderProperties.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.js">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.js">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.js">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.js">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.xhtml">mailnews/base/content/virtualFolderProperties.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.xhtml">file</a> |
<a href="/comm-central/annotate/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.xhtml">annotate</a> |
<a href="/comm-central/diff/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.xhtml">diff</a> |
<a href="/comm-central/comparison/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.xhtml">comparison</a> |
<a href="/comm-central/log/f8310228f5b2c75ff65bbb4e182eb6ce693c6e28/mailnews/base/content/virtualFolderProperties.xhtml">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/folderPane.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/folderPane.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -145,16 +145,18 @@ var gFolderTreeView = {</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5">   /**</span>
<a href="#l1.6"></a><span id="l1.6">    * Called when the window is initially loaded. This function initializes the</span>
<a href="#l1.7"></a><span id="l1.7">    * folder-pane to the view last shown before the application was closed.</span>
<a href="#l1.8"></a><span id="l1.8">    */</span>
<a href="#l1.9"></a><span id="l1.9">   load(aTree, aJSONFile) {</span>
<a href="#l1.10"></a><span id="l1.10">     this._treeElement = aTree;</span>
<a href="#l1.11"></a><span id="l1.11">     this.messengerBundle = document.getElementById(&quot;bundle_messenger&quot;);</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+    this.inlineStyle = document.getElementById(&quot;inlineStyle&quot;);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    this.previewStyle = document.getElementById(&quot;previewStyle&quot;);</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15">     // The folder pane can be used for other trees which may not have these</span>
<a href="#l1.16"></a><span id="l1.16">     // elements. Collapse them if no account is currently available.</span>
<a href="#l1.17"></a><span id="l1.17">     let hasAccounts = MailServices.accounts.accounts.length &gt; 0;</span>
<a href="#l1.18"></a><span id="l1.18">     if (document.getElementById(&quot;folderpane_splitter&quot;)) {</span>
<a href="#l1.19"></a><span id="l1.19">       document.getElementById(&quot;folderpane_splitter&quot;).collapsed = !hasAccounts;</span>
<a href="#l1.20"></a><span id="l1.20">     }</span>
<a href="#l1.21"></a><span id="l1.21">     if (document.getElementById(&quot;folderPaneBox&quot;)) {</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineat">@@ -1679,16 +1681,42 @@ var gFolderTreeView = {</span>
<a href="#l1.23"></a><span id="l1.23">     for (let folder of selectedFolders) {</span>
<a href="#l1.24"></a><span id="l1.24">       if (folder) {</span>
<a href="#l1.25"></a><span id="l1.25">         let index = this.getIndexOfFolder(folder);</span>
<a href="#l1.26"></a><span id="l1.26">         if (index != null) {</span>
<a href="#l1.27"></a><span id="l1.27">           this.selection.toggleSelect(index);</span>
<a href="#l1.28"></a><span id="l1.28">         }</span>
<a href="#l1.29"></a><span id="l1.29">       }</span>
<a href="#l1.30"></a><span id="l1.30">     }</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineplus">+</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineplus">+    // Restore custom icon colors.</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineplus">+    for (let i = 0; i &lt; this._rowMap.length; i++) {</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineplus">+      let folder = this._rowMap[i]._folder;</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineplus">+      let msgDatabase;</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineplus">+      try {</span>
<a href="#l1.37"></a><span id="l1.37" class="difflineplus">+        // This will throw an exception if the .msf file is missing,</span>
<a href="#l1.38"></a><span id="l1.38" class="difflineplus">+        // out of date (e.g., the local folder has changed), or corrupted.</span>
<a href="#l1.39"></a><span id="l1.39" class="difflineplus">+        msgDatabase = folder.msgDatabase;</span>
<a href="#l1.40"></a><span id="l1.40" class="difflineplus">+      } catch (e) {}</span>
<a href="#l1.41"></a><span id="l1.41" class="difflineplus">+</span>
<a href="#l1.42"></a><span id="l1.42" class="difflineplus">+      if (msgDatabase) {</span>
<a href="#l1.43"></a><span id="l1.43" class="difflineplus">+        // Get the previously stored color from the Folder Database.</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineplus">+        let iconColor = folder.msgDatabase.dBFolderInfo.getCharProperty(</span>
<a href="#l1.45"></a><span id="l1.45" class="difflineplus">+          &quot;folderIconColor&quot;</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineplus">+        );</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineplus">+        // Store the color in the cache property so we can use this for</span>
<a href="#l1.48"></a><span id="l1.48" class="difflineplus">+        // properties changes and updates.</span>
<a href="#l1.49"></a><span id="l1.49" class="difflineplus">+        gFolderTreeView.setFolderCacheProperty(</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineplus">+          this._rowMap[i]._folder,</span>
<a href="#l1.51"></a><span id="l1.51" class="difflineplus">+          &quot;folderIconColor&quot;,</span>
<a href="#l1.52"></a><span id="l1.52" class="difflineplus">+          iconColor</span>
<a href="#l1.53"></a><span id="l1.53" class="difflineplus">+        );</span>
<a href="#l1.54"></a><span id="l1.54" class="difflineplus">+        this.appendColor(iconColor);</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineplus">+      }</span>
<a href="#l1.56"></a><span id="l1.56" class="difflineplus">+    }</span>
<a href="#l1.57"></a><span id="l1.57">   },</span>
<a href="#l1.58"></a><span id="l1.58"> </span>
<a href="#l1.59"></a><span id="l1.59">   _sortedAccounts() {</span>
<a href="#l1.60"></a><span id="l1.60">     let accounts = allAccountsSorted(true);</span>
<a href="#l1.61"></a><span id="l1.61"> </span>
<a href="#l1.62"></a><span id="l1.62">     // Don't show deferred pop accounts.</span>
<a href="#l1.63"></a><span id="l1.63">     accounts = accounts.filter(function(a) {</span>
<a href="#l1.64"></a><span id="l1.64">       let server = a.incomingServer;</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineat">@@ -2586,16 +2614,32 @@ var gFolderTreeView = {</span>
<a href="#l1.66"></a><span id="l1.66"> </span>
<a href="#l1.67"></a><span id="l1.67">   OnItemPropertyFlagChanged(aItem, aProperty, aOld, aNew) {},</span>
<a href="#l1.68"></a><span id="l1.68">   OnItemEvent(aFolder, aEvent) {</span>
<a href="#l1.69"></a><span id="l1.69">     let index = this.getIndexOfFolder(aFolder);</span>
<a href="#l1.70"></a><span id="l1.70">     if (index != null) {</span>
<a href="#l1.71"></a><span id="l1.71">       this._tree.invalidateRow(index);</span>
<a href="#l1.72"></a><span id="l1.72">     }</span>
<a href="#l1.73"></a><span id="l1.73">   },</span>
<a href="#l1.74"></a><span id="l1.74" class="difflineplus">+</span>
<a href="#l1.75"></a><span id="l1.75" class="difflineplus">+  /**</span>
<a href="#l1.76"></a><span id="l1.76" class="difflineplus">+   * Append inline CSS style for those icons where a custom color was defined.</span>
<a href="#l1.77"></a><span id="l1.77" class="difflineplus">+   *</span>
<a href="#l1.78"></a><span id="l1.78" class="difflineplus">+   * @param {string} iconColor - The hash color.</span>
<a href="#l1.79"></a><span id="l1.79" class="difflineplus">+   */</span>
<a href="#l1.80"></a><span id="l1.80" class="difflineplus">+  appendColor(iconColor) {</span>
<a href="#l1.81"></a><span id="l1.81" class="difflineplus">+    if (!this.inlineStyle || !iconColor) {</span>
<a href="#l1.82"></a><span id="l1.82" class="difflineplus">+      return;</span>
<a href="#l1.83"></a><span id="l1.83" class="difflineplus">+    }</span>
<a href="#l1.84"></a><span id="l1.84" class="difflineplus">+</span>
<a href="#l1.85"></a><span id="l1.85" class="difflineplus">+    let selector = `customColor-${iconColor.replace(&quot;#&quot;, &quot;&quot;)}`;</span>
<a href="#l1.86"></a><span id="l1.86" class="difflineplus">+</span>
<a href="#l1.87"></a><span id="l1.87" class="difflineplus">+    // Append the inline CSS styling.</span>
<a href="#l1.88"></a><span id="l1.88" class="difflineplus">+    this.inlineStyle.textContent += `treechildren::-moz-tree-image(folderNameCol, ${selector}) {fill: ${iconColor};}`;</span>
<a href="#l1.89"></a><span id="l1.89" class="difflineplus">+  },</span>
<a href="#l1.90"></a><span id="l1.90"> };</span>
<a href="#l1.91"></a><span id="l1.91"> </span>
<a href="#l1.92"></a><span id="l1.92"> /**</span>
<a href="#l1.93"></a><span id="l1.93">  * The ftvItem object represents a single row in the tree view. Because I'm lazy</span>
<a href="#l1.94"></a><span id="l1.94">  * I'm just going to define the expected interface here.  You are free to return</span>
<a href="#l1.95"></a><span id="l1.95">  * an alternative object, provided that it matches this interface:</span>
<a href="#l1.96"></a><span id="l1.96">  *</span>
<a href="#l1.97"></a><span id="l1.97">  * id (attribute) - a unique string for this object. Must persist over sessions</span>
<a href="#l1.98"></a><span id="l1.98" class="difflineat">@@ -2786,16 +2830,25 @@ ftvItem.prototype = {</span>
<a href="#l1.99"></a><span id="l1.99">       properties += &quot; specialFolder-&quot; + this._folder.name.replace(/\s+/g, &quot;&quot;);</span>
<a href="#l1.100"></a><span id="l1.100">     }</span>
<a href="#l1.101"></a><span id="l1.101">     // if there is a smartFolder name property, add it</span>
<a href="#l1.102"></a><span id="l1.102">     let smartFolderName = getSmartFolderName(this._folder);</span>
<a href="#l1.103"></a><span id="l1.103">     if (smartFolderName) {</span>
<a href="#l1.104"></a><span id="l1.104">       properties += &quot; specialFolder-&quot; + smartFolderName.replace(/\s+/g, &quot;&quot;);</span>
<a href="#l1.105"></a><span id="l1.105">     }</span>
<a href="#l1.106"></a><span id="l1.106"> </span>
<a href="#l1.107"></a><span id="l1.107" class="difflineplus">+    let customColor = gFolderTreeView.getFolderCacheProperty(</span>
<a href="#l1.108"></a><span id="l1.108" class="difflineplus">+      this._folder,</span>
<a href="#l1.109"></a><span id="l1.109" class="difflineplus">+      &quot;folderIconColor&quot;</span>
<a href="#l1.110"></a><span id="l1.110" class="difflineplus">+    );</span>
<a href="#l1.111"></a><span id="l1.111" class="difflineplus">+    // Add the property if a custom color was defined for this folder.</span>
<a href="#l1.112"></a><span id="l1.112" class="difflineplus">+    if (customColor) {</span>
<a href="#l1.113"></a><span id="l1.113" class="difflineplus">+      properties += ` customColor-${customColor.replace(&quot;#&quot;, &quot;&quot;)}`;</span>
<a href="#l1.114"></a><span id="l1.114" class="difflineplus">+    }</span>
<a href="#l1.115"></a><span id="l1.115" class="difflineplus">+</span>
<a href="#l1.116"></a><span id="l1.116">     if (FeedMessageHandler.isFeedFolder(this._folder)) {</span>
<a href="#l1.117"></a><span id="l1.117">       properties += FeedUtils.getFolderProperties(this._folder, null);</span>
<a href="#l1.118"></a><span id="l1.118">       gFolderTreeView.setFolderCacheProperty(</span>
<a href="#l1.119"></a><span id="l1.119">         this._folder,</span>
<a href="#l1.120"></a><span id="l1.120">         &quot;properties&quot;,</span>
<a href="#l1.121"></a><span id="l1.121">         properties</span>
<a href="#l1.122"></a><span id="l1.122">       );</span>
<a href="#l1.123"></a><span id="l1.123">     }</span>
<a href="#l1.124"></a><span id="l1.124" class="difflineat">@@ -2923,17 +2976,17 @@ var gFolderTreeController = {</span>
<a href="#l1.125"></a><span id="l1.125">       if (aNewName != aOldName) {</span>
<a href="#l1.126"></a><span id="l1.126">         folder.rename(aNewName, msgWindow);</span>
<a href="#l1.127"></a><span id="l1.127">       }</span>
<a href="#l1.128"></a><span id="l1.128">     }</span>
<a href="#l1.129"></a><span id="l1.129"> </span>
<a href="#l1.130"></a><span id="l1.130">     // xxx useless param</span>
<a href="#l1.131"></a><span id="l1.131">     function rebuildSummary(aFolder) {</span>
<a href="#l1.132"></a><span id="l1.132">       // folder is already introduced in our containing function and is</span>
<a href="#l1.133"></a><span id="l1.133" class="difflineminus">-      //  lexically captured and available to us.</span>
<a href="#l1.134"></a><span id="l1.134" class="difflineplus">+      // lexically captured and available to us.</span>
<a href="#l1.135"></a><span id="l1.135">       if (folder.locked) {</span>
<a href="#l1.136"></a><span id="l1.136">         folder.throwAlertMsg(&quot;operationFailedFolderBusy&quot;, msgWindow);</span>
<a href="#l1.137"></a><span id="l1.137">         return;</span>
<a href="#l1.138"></a><span id="l1.138">       }</span>
<a href="#l1.139"></a><span id="l1.139">       if (folder.supportsOffline) {</span>
<a href="#l1.140"></a><span id="l1.140">         // Remove the offline store, if any.</span>
<a href="#l1.141"></a><span id="l1.141">         let offlineStore = folder.filePath;</span>
<a href="#l1.142"></a><span id="l1.142">         // XXX todo: figure out how to delete a maildir directory async. This</span>
<a href="#l1.143"></a><span id="l1.143" class="difflineat">@@ -2974,23 +3027,29 @@ var gFolderTreeController = {</span>
<a href="#l1.144"></a><span id="l1.144">     }</span>
<a href="#l1.145"></a><span id="l1.145"> </span>
<a href="#l1.146"></a><span id="l1.146">     window.openDialog(</span>
<a href="#l1.147"></a><span id="l1.147">       &quot;chrome://messenger/content/folderProps.xhtml&quot;,</span>
<a href="#l1.148"></a><span id="l1.148">       &quot;&quot;,</span>
<a href="#l1.149"></a><span id="l1.149">       &quot;chrome,modal,centerscreen&quot;,</span>
<a href="#l1.150"></a><span id="l1.150">       {</span>
<a href="#l1.151"></a><span id="l1.151">         folder,</span>
<a href="#l1.152"></a><span id="l1.152" class="difflineplus">+        treeView: gFolderTreeView,</span>
<a href="#l1.153"></a><span id="l1.153">         serverType: folder.server.type,</span>
<a href="#l1.154"></a><span id="l1.154">         msgWindow,</span>
<a href="#l1.155"></a><span id="l1.155">         title,</span>
<a href="#l1.156"></a><span id="l1.156">         okCallback: editFolderCallback,</span>
<a href="#l1.157"></a><span id="l1.157">         tabID: aTabID,</span>
<a href="#l1.158"></a><span id="l1.158">         name: folder.prettyName,</span>
<a href="#l1.159"></a><span id="l1.159">         rebuildSummaryCallback: rebuildSummary,</span>
<a href="#l1.160"></a><span id="l1.160" class="difflineplus">+        previewSelectedColorCallback:</span>
<a href="#l1.161"></a><span id="l1.161" class="difflineplus">+          gFolderTreeController.previewSelectedColor,</span>
<a href="#l1.162"></a><span id="l1.162" class="difflineplus">+        clearFolderSelectionCallback:</span>
<a href="#l1.163"></a><span id="l1.163" class="difflineplus">+          gFolderTreeController.clearFolderSelection,</span>
<a href="#l1.164"></a><span id="l1.164" class="difflineplus">+        updateColorCallback: gFolderTreeController.updateColor,</span>
<a href="#l1.165"></a><span id="l1.165">       }</span>
<a href="#l1.166"></a><span id="l1.166">     );</span>
<a href="#l1.167"></a><span id="l1.167">   },</span>
<a href="#l1.168"></a><span id="l1.168"> </span>
<a href="#l1.169"></a><span id="l1.169">   /**</span>
<a href="#l1.170"></a><span id="l1.170">    * Opens the dialog to rename a particular folder, and does the renaming if</span>
<a href="#l1.171"></a><span id="l1.171">    * the user clicks OK in that dialog</span>
<a href="#l1.172"></a><span id="l1.172">    *</span>
<a href="#l1.173"></a><span id="l1.173" class="difflineat">@@ -3235,18 +3294,24 @@ var gFolderTreeController = {</span>
<a href="#l1.174"></a><span id="l1.174">       }</span>
<a href="#l1.175"></a><span id="l1.175">     }</span>
<a href="#l1.176"></a><span id="l1.176">     window.openDialog(</span>
<a href="#l1.177"></a><span id="l1.177">       &quot;chrome://messenger/content/virtualFolderProperties.xhtml&quot;,</span>
<a href="#l1.178"></a><span id="l1.178">       &quot;&quot;,</span>
<a href="#l1.179"></a><span id="l1.179">       &quot;chrome,modal,centerscreen&quot;,</span>
<a href="#l1.180"></a><span id="l1.180">       {</span>
<a href="#l1.181"></a><span id="l1.181">         folder,</span>
<a href="#l1.182"></a><span id="l1.182" class="difflineplus">+        treeView: gFolderTreeView,</span>
<a href="#l1.183"></a><span id="l1.183">         editExistingFolder: true,</span>
<a href="#l1.184"></a><span id="l1.184">         onOKCallback: editVirtualCallback,</span>
<a href="#l1.185"></a><span id="l1.185" class="difflineplus">+        previewSelectedColorCallback:</span>
<a href="#l1.186"></a><span id="l1.186" class="difflineplus">+          gFolderTreeController.previewSelectedColor,</span>
<a href="#l1.187"></a><span id="l1.187" class="difflineplus">+        clearFolderSelectionCallback:</span>
<a href="#l1.188"></a><span id="l1.188" class="difflineplus">+          gFolderTreeController.clearFolderSelection,</span>
<a href="#l1.189"></a><span id="l1.189" class="difflineplus">+        updateColorCallback: gFolderTreeController.updateColor,</span>
<a href="#l1.190"></a><span id="l1.190">         msgWindow,</span>
<a href="#l1.191"></a><span id="l1.191">       }</span>
<a href="#l1.192"></a><span id="l1.192">     );</span>
<a href="#l1.193"></a><span id="l1.193">   },</span>
<a href="#l1.194"></a><span id="l1.194"> </span>
<a href="#l1.195"></a><span id="l1.195">   /**</span>
<a href="#l1.196"></a><span id="l1.196">    * Opens a search window with the given folder, or the selected one if none</span>
<a href="#l1.197"></a><span id="l1.197">    * is given.</span>
<a href="#l1.198"></a><span id="l1.198" class="difflineat">@@ -3310,16 +3375,89 @@ var gFolderTreeController = {</span>
<a href="#l1.199"></a><span id="l1.199">     return true;</span>
<a href="#l1.200"></a><span id="l1.200">   },</span>
<a href="#l1.201"></a><span id="l1.201"> </span>
<a href="#l1.202"></a><span id="l1.202">   get _tree() {</span>
<a href="#l1.203"></a><span id="l1.203">     let tree = document.getElementById(&quot;folderTree&quot;);</span>
<a href="#l1.204"></a><span id="l1.204">     delete this._tree;</span>
<a href="#l1.205"></a><span id="l1.205">     return (this._tree = tree);</span>
<a href="#l1.206"></a><span id="l1.206">   },</span>
<a href="#l1.207"></a><span id="l1.207" class="difflineplus">+</span>
<a href="#l1.208"></a><span id="l1.208" class="difflineplus">+  /**</span>
<a href="#l1.209"></a><span id="l1.209" class="difflineplus">+   * Update the inline preview style in the messagener.xhtml file to show</span>
<a href="#l1.210"></a><span id="l1.210" class="difflineplus">+   * users a preview of the defined color.</span>
<a href="#l1.211"></a><span id="l1.211" class="difflineplus">+   *</span>
<a href="#l1.212"></a><span id="l1.212" class="difflineplus">+   * @param {ftvItem} folder - The folder where the color is defined.</span>
<a href="#l1.213"></a><span id="l1.213" class="difflineplus">+   * @param {string} newColor - The new hash color to preview.</span>
<a href="#l1.214"></a><span id="l1.214" class="difflineplus">+   */</span>
<a href="#l1.215"></a><span id="l1.215" class="difflineplus">+  previewSelectedColor(folder, newColor) {</span>
<a href="#l1.216"></a><span id="l1.216" class="difflineplus">+    // If the color is null, it measn we're resetting to the default value.</span>
<a href="#l1.217"></a><span id="l1.217" class="difflineplus">+    if (!newColor) {</span>
<a href="#l1.218"></a><span id="l1.218" class="difflineplus">+      gFolderTreeView.setFolderCacheProperty(folder, &quot;folderIconColor&quot;, &quot;&quot;);</span>
<a href="#l1.219"></a><span id="l1.219" class="difflineplus">+</span>
<a href="#l1.220"></a><span id="l1.220" class="difflineplus">+      // Clear the preview CSS.</span>
<a href="#l1.221"></a><span id="l1.221" class="difflineplus">+      gFolderTreeView.previewStyle.textContent = &quot;&quot;;</span>
<a href="#l1.222"></a><span id="l1.222" class="difflineplus">+</span>
<a href="#l1.223"></a><span id="l1.223" class="difflineplus">+      // Force the folder update to see the new color.</span>
<a href="#l1.224"></a><span id="l1.224" class="difflineplus">+      gFolderTreeView._tree.invalidateRow(</span>
<a href="#l1.225"></a><span id="l1.225" class="difflineplus">+        gFolderTreeView.getIndexOfFolder(folder)</span>
<a href="#l1.226"></a><span id="l1.226" class="difflineplus">+      );</span>
<a href="#l1.227"></a><span id="l1.227" class="difflineplus">+      return;</span>
<a href="#l1.228"></a><span id="l1.228" class="difflineplus">+    }</span>
<a href="#l1.229"></a><span id="l1.229" class="difflineplus">+</span>
<a href="#l1.230"></a><span id="l1.230" class="difflineplus">+    // Add the new color property.</span>
<a href="#l1.231"></a><span id="l1.231" class="difflineplus">+    gFolderTreeView.setFolderCacheProperty(folder, &quot;folderIconColor&quot;, newColor);</span>
<a href="#l1.232"></a><span id="l1.232" class="difflineplus">+</span>
<a href="#l1.233"></a><span id="l1.233" class="difflineplus">+    let selector = `customColor-${newColor.replace(&quot;#&quot;, &quot;&quot;)}`;</span>
<a href="#l1.234"></a><span id="l1.234" class="difflineplus">+    // Add the inline CSS styling.</span>
<a href="#l1.235"></a><span id="l1.235" class="difflineplus">+    gFolderTreeView.previewStyle.textContent = `treechildren::-moz-tree-image(folderNameCol, ${selector}) {fill: ${newColor};}`;</span>
<a href="#l1.236"></a><span id="l1.236" class="difflineplus">+</span>
<a href="#l1.237"></a><span id="l1.237" class="difflineplus">+    // Force the folder update to set the new color.</span>
<a href="#l1.238"></a><span id="l1.238" class="difflineplus">+    gFolderTreeView._tree.invalidateRow(</span>
<a href="#l1.239"></a><span id="l1.239" class="difflineplus">+      gFolderTreeView.getIndexOfFolder(folder)</span>
<a href="#l1.240"></a><span id="l1.240" class="difflineplus">+    );</span>
<a href="#l1.241"></a><span id="l1.241" class="difflineplus">+  },</span>
<a href="#l1.242"></a><span id="l1.242" class="difflineplus">+</span>
<a href="#l1.243"></a><span id="l1.243" class="difflineplus">+  /**</span>
<a href="#l1.244"></a><span id="l1.244" class="difflineplus">+   * Clear the preview style and add the new selected color to the persistent</span>
<a href="#l1.245"></a><span id="l1.245" class="difflineplus">+   * inline style in the messenger.xhtml file.</span>
<a href="#l1.246"></a><span id="l1.246" class="difflineplus">+   *</span>
<a href="#l1.247"></a><span id="l1.247" class="difflineplus">+   * @param {ftvItem} folder - The folder where the new color was defined.</span>
<a href="#l1.248"></a><span id="l1.248" class="difflineplus">+   */</span>
<a href="#l1.249"></a><span id="l1.249" class="difflineplus">+  updateColor(folder) {</span>
<a href="#l1.250"></a><span id="l1.250" class="difflineplus">+    // Clear the preview CSS.</span>
<a href="#l1.251"></a><span id="l1.251" class="difflineplus">+    gFolderTreeView.previewStyle.textContent = &quot;&quot;;</span>
<a href="#l1.252"></a><span id="l1.252" class="difflineplus">+</span>
<a href="#l1.253"></a><span id="l1.253" class="difflineplus">+    let newColor = gFolderTreeView.getFolderCacheProperty(</span>
<a href="#l1.254"></a><span id="l1.254" class="difflineplus">+      folder,</span>
<a href="#l1.255"></a><span id="l1.255" class="difflineplus">+      &quot;folderIconColor&quot;</span>
<a href="#l1.256"></a><span id="l1.256" class="difflineplus">+    );</span>
<a href="#l1.257"></a><span id="l1.257" class="difflineplus">+</span>
<a href="#l1.258"></a><span id="l1.258" class="difflineplus">+    // Append new incline color if defined.</span>
<a href="#l1.259"></a><span id="l1.259" class="difflineplus">+    gFolderTreeView.appendColor(newColor);</span>
<a href="#l1.260"></a><span id="l1.260" class="difflineplus">+</span>
<a href="#l1.261"></a><span id="l1.261" class="difflineplus">+    // Store the new color in the Folder database.</span>
<a href="#l1.262"></a><span id="l1.262" class="difflineplus">+    folder.msgDatabase.dBFolderInfo.setCharProperty(</span>
<a href="#l1.263"></a><span id="l1.263" class="difflineplus">+      &quot;folderIconColor&quot;,</span>
<a href="#l1.264"></a><span id="l1.264" class="difflineplus">+      newColor</span>
<a href="#l1.265"></a><span id="l1.265" class="difflineplus">+    );</span>
<a href="#l1.266"></a><span id="l1.266" class="difflineplus">+</span>
<a href="#l1.267"></a><span id="l1.267" class="difflineplus">+    // Force the folder update to set the new color.</span>
<a href="#l1.268"></a><span id="l1.268" class="difflineplus">+    gFolderTreeView._tree.invalidateRow(</span>
<a href="#l1.269"></a><span id="l1.269" class="difflineplus">+      gFolderTreeView.getIndexOfFolder(folder)</span>
<a href="#l1.270"></a><span id="l1.270" class="difflineplus">+    );</span>
<a href="#l1.271"></a><span id="l1.271" class="difflineplus">+  },</span>
<a href="#l1.272"></a><span id="l1.272" class="difflineplus">+</span>
<a href="#l1.273"></a><span id="l1.273" class="difflineplus">+  /**</span>
<a href="#l1.274"></a><span id="l1.274" class="difflineplus">+   * Force the clear of the selection when the color picker is opened to allow</span>
<a href="#l1.275"></a><span id="l1.275" class="difflineplus">+   * users to see the color preview.</span>
<a href="#l1.276"></a><span id="l1.276" class="difflineplus">+   */</span>
<a href="#l1.277"></a><span id="l1.277" class="difflineplus">+  clearFolderSelection() {</span>
<a href="#l1.278"></a><span id="l1.278" class="difflineplus">+    gFolderTreeView.selection.clearSelection();</span>
<a href="#l1.279"></a><span id="l1.279" class="difflineplus">+  },</span>
<a href="#l1.280"></a><span id="l1.280"> };</span>
<a href="#l1.281"></a><span id="l1.281"> </span>
<a href="#l1.282"></a><span id="l1.282"> /**</span>
<a href="#l1.283"></a><span id="l1.283">  * Constructor for ftv_SmartItem. This is a top level item in the &quot;smart&quot;</span>
<a href="#l1.284"></a><span id="l1.284">  * (a.k.a. &quot;Unified&quot;) folder mode.</span>
<a href="#l1.285"></a><span id="l1.285">  */</span>
<a href="#l1.286"></a><span id="l1.286"> function ftv_SmartItem(aFolder) {</span>
<a href="#l1.287"></a><span id="l1.287">   ftvItem.call(this, aFolder); // call super constructor</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/messenger.xhtml</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/messenger.xhtml</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -39,16 +39,20 @@</span>
<a href="#l2.4"></a><span id="l2.4"> </span>
<a href="#l2.5"></a><span id="l2.5"> &lt;?xml-stylesheet href=&quot;chrome://calendar/skin/calendar-views.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.6"></a><span id="l2.6"> &lt;?xml-stylesheet href=&quot;chrome://calendar/skin/shared/calendar-alarms.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.7"></a><span id="l2.7"> &lt;?xml-stylesheet href=&quot;chrome://calendar/skin/shared/widgets/minimonth.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.8"></a><span id="l2.8"> &lt;?xml-stylesheet href=&quot;chrome://calendar/skin/widgets/calendar-widgets.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.9"></a><span id="l2.9"> </span>
<a href="#l2.10"></a><span id="l2.10"> &lt;?xml-stylesheet href=&quot;chrome://calendar/skin/lightning-toolbar.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+&lt;!-- NEEDED FOR FOLDER COLOR CUSTOMIZATION --&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+&lt;?xml-stylesheet href=&quot;#inlineStyle&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+&lt;?xml-stylesheet href=&quot;#previewStyle&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+</span>
<a href="#l2.16"></a><span id="l2.16"> # All DTD information is stored in a separate file so that it can be shared by</span>
<a href="#l2.17"></a><span id="l2.17"> # hiddenWindowMac.xhtml.</span>
<a href="#l2.18"></a><span id="l2.18"> &lt;!DOCTYPE window [</span>
<a href="#l2.19"></a><span id="l2.19"> #include messenger-doctype.inc.dtd</span>
<a href="#l2.20"></a><span id="l2.20"> ]&gt;</span>
<a href="#l2.21"></a><span id="l2.21"> </span>
<a href="#l2.22"></a><span id="l2.22"> &lt;!--</span>
<a href="#l2.23"></a><span id="l2.23">   - The 'what you think of when you think of thunderbird' window;</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineat">@@ -244,16 +248,20 @@</span>
<a href="#l2.25"></a><span id="l2.25"> &lt;script src=&quot;chrome://calendar/content/calendar-menus.js&quot;/&gt;</span>
<a href="#l2.26"></a><span id="l2.26"> </span>
<a href="#l2.27"></a><span id="l2.27"> &lt;!-- NEEDED FOR CALENDAR VIEWS --&gt;</span>
<a href="#l2.28"></a><span id="l2.28"> &lt;script src=&quot;chrome://calendar/content/calendar-event-gripbar.js&quot;/&gt;</span>
<a href="#l2.29"></a><span id="l2.29"> </span>
<a href="#l2.30"></a><span id="l2.30"> &lt;!-- NEEDED FOR MIGRATION CHECK AT INSTALL --&gt;</span>
<a href="#l2.31"></a><span id="l2.31"> &lt;script src=&quot;chrome://calendar/content/calendar-migration.js&quot;/&gt;</span>
<a href="#l2.32"></a><span id="l2.32"> </span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+&lt;!-- NEEDED FOR FOLDER COLOR CUSTOMIZATION --&gt;</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+&lt;html:style type=&quot;text/css&quot; id=&quot;inlineStyle&quot;&gt;&lt;/html:style&gt;</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineplus">+&lt;html:style type=&quot;text/css&quot; id=&quot;previewStyle&quot;&gt;&lt;/html:style&gt;</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineplus">+</span>
<a href="#l2.37"></a><span id="l2.37"> &lt;commandset id=&quot;mailCommands&quot;&gt;</span>
<a href="#l2.38"></a><span id="l2.38"> #include mainCommandSet.inc.xhtml</span>
<a href="#l2.39"></a><span id="l2.39">   &lt;commandset id=&quot;mailSearchMenuItems&quot;/&gt;</span>
<a href="#l2.40"></a><span id="l2.40">   &lt;commandset id=&quot;globalEditMenuItems&quot;</span>
<a href="#l2.41"></a><span id="l2.41">               commandupdater=&quot;true&quot;</span>
<a href="#l2.42"></a><span id="l2.42">               events=&quot;create-menu-edit&quot;</span>
<a href="#l2.43"></a><span id="l2.43">               oncommandupdate=&quot;goUpdateGlobalEditMenuItems()&quot;/&gt;</span>
<a href="#l2.44"></a><span id="l2.44">   &lt;commandset id=&quot;selectEditMenuItems&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/folderProps.dtd</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/folderProps.dtd</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -44,16 +44,19 @@</span>
<a href="#l3.4"></a><span id="l3.4"> </span>
<a href="#l3.5"></a><span id="l3.5"> &lt;!ENTITY selectofflineNewsgroup.check.label      &quot;Select this newsgroup for offline use&quot;&gt;</span>
<a href="#l3.6"></a><span id="l3.6"> &lt;!ENTITY selectofflineNewsgroup.check.accesskey  &quot;o&quot;&gt;</span>
<a href="#l3.7"></a><span id="l3.7"> &lt;!ENTITY offlineNewsgroup.button.label           &quot;Download Now&quot;&gt;</span>
<a href="#l3.8"></a><span id="l3.8"> &lt;!ENTITY offlineNewsgroup.button.accesskey       &quot;D&quot;&gt;</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10"> &lt;!ENTITY folderProps.name.label                  &quot;Name:&quot;&gt;</span>
<a href="#l3.11"></a><span id="l3.11"> &lt;!ENTITY folderProps.name.accesskey              &quot;N&quot;&gt;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+&lt;!ENTITY folderProps.color.label                 &quot;Icon Color:&quot;&gt;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+&lt;!ENTITY folderProps.color.accesskey             &quot;I&quot;&gt;</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+&lt;!ENTITY folderProps.reset.tooltip               &quot;Restore default color&quot;&gt;</span>
<a href="#l3.15"></a><span id="l3.15"> &lt;!ENTITY folderProps.location.label              &quot;Location:&quot;&gt;</span>
<a href="#l3.16"></a><span id="l3.16"> &lt;!ENTITY folderProps.location.accesskey          &quot;L&quot;&gt;</span>
<a href="#l3.17"></a><span id="l3.17"> </span>
<a href="#l3.18"></a><span id="l3.18"> &lt;!ENTITY folderSharingTab.label                  &quot;Sharing&quot;&gt;</span>
<a href="#l3.19"></a><span id="l3.19"> &lt;!ENTITY privileges.button.label                 &quot;Privileges…&quot;&gt;</span>
<a href="#l3.20"></a><span id="l3.20"> &lt;!ENTITY privileges.button.accesskey             &quot;P&quot;&gt;</span>
<a href="#l3.21"></a><span id="l3.21"> &lt;!ENTITY permissionsDesc.label                   &quot;You have the following permissions:&quot;&gt;</span>
<a href="#l3.22"></a><span id="l3.22"> &lt;!ENTITY folderType.label                        &quot;Folder Type:&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/themes/shared/jar.inc.mn</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/themes/shared/jar.inc.mn</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -71,16 +71,17 @@</span>
<a href="#l4.4"></a><span id="l4.4">   skin/classic/messenger/icons/feeds-folder.svg               (../shared/mail/icons/feeds-folder.svg)</span>
<a href="#l4.5"></a><span id="l4.5">   skin/classic/messenger/icons/file.svg                       (../shared/mail/icons/file.svg)</span>
<a href="#l4.6"></a><span id="l4.6">   skin/classic/messenger/icons/file-item.svg                  (../shared/mail/icons/file-item.svg)</span>
<a href="#l4.7"></a><span id="l4.7">   skin/classic/messenger/icons/filter.svg                     (../shared/mail/icons/filter.svg)</span>
<a href="#l4.8"></a><span id="l4.8">   skin/classic/messenger/icons/flag-col.svg                   (../shared/mail/icons/flag-col.svg)</span>
<a href="#l4.9"></a><span id="l4.9">   skin/classic/messenger/icons/flagged.svg                    (../shared/mail/icons/flagged.svg)</span>
<a href="#l4.10"></a><span id="l4.10">   skin/classic/messenger/icons/folder.svg                     (../shared/mail/icons/folder.svg)</span>
<a href="#l4.11"></a><span id="l4.11">   skin/classic/messenger/icons/folder-local.svg               (../shared/mail/icons/folder-local.svg)</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+  skin/classic/messenger/icons/forget.svg                     (../shared/mail/icons/forget.svg)</span>
<a href="#l4.13"></a><span id="l4.13">   skin/classic/messenger/icons/forward.svg                    (../shared/mail/icons/forward.svg)</span>
<a href="#l4.14"></a><span id="l4.14">   skin/classic/messenger/icons/get-all.svg                    (../shared/mail/icons/get-all.svg)</span>
<a href="#l4.15"></a><span id="l4.15">   skin/classic/messenger/icons/getmsg.svg                     (../shared/mail/icons/getmsg.svg)</span>
<a href="#l4.16"></a><span id="l4.16">   skin/classic/messenger/icons/goback.svg                     (../shared/mail/icons/goback.svg)</span>
<a href="#l4.17"></a><span id="l4.17">   skin/classic/messenger/icons/goforward.svg                  (../shared/mail/icons/goforward.svg)</span>
<a href="#l4.18"></a><span id="l4.18">   skin/classic/messenger/icons/globe.svg                      (../shared/mail/icons/globe.svg)</span>
<a href="#l4.19"></a><span id="l4.19">   skin/classic/messenger/icons/globe-secure.svg               (../shared/mail/icons/globe-secure.svg)</span>
<a href="#l4.20"></a><span id="l4.20">   skin/classic/messenger/icons/help.svg                       (../shared/mail/icons/help.svg)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/themes/shared/mail/icons/folder.svg</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/themes/shared/mail/icons/folder.svg</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -1,4 +1,6 @@</span>
<a href="#l5.4"></a><span id="l5.4"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.5"></a><span id="l5.5">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.6"></a><span id="l5.6">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l5.7"></a><span id="l5.7" class="difflineminus">-&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot;&gt;&lt;path fill=&quot;context-fill&quot; d=&quot;M14 3H8.151L6.584 1.538A2 2 0 0 0 5.219 1H2a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zM5.219 3l1.072 1H2V3zM14 13H2V5h6v-.014c.05 0 .1.014.151.014H14z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;</span>
<a href="#l5.8"></a><span id="l5.8">\ No newline at end of file</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineplus">+&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot;&gt;</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineplus">+  &lt;path fill=&quot;context-fill&quot; d=&quot;M13 4H7.85L6.38 2.54A1.93 1.93 0 005.02 2H2a2 2 0 00-2 2v9c0 1.1.9 2 2 2h11a2 2 0 002-2V6a2 2 0 00-2-2zM5 4l1 1H2V4zm8 9H2V6h5.8v-.01c0-.05.1.01.15.01H13z&quot;/&gt;</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+&lt;/svg&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">new file mode 100644</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineminus">--- /dev/null</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineplus">+++ b/mail/themes/shared/mail/icons/forget.svg</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineat">@@ -0,0 +1,4 @@</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineplus">+&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.6"></a><span id="l6.6" class="difflineplus">+   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.7"></a><span id="l6.7" class="difflineplus">+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineplus">+&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot;&gt;&lt;path fill=&quot;context-fill&quot; d=&quot;M6.854 10.854l2-2A.5.5 0 0 0 9 8.5v-4a.5.5 0 0 0-1 0v3.793l-1.854 1.853a.5.5 0 1 0 .707.707zM8 0a8.011 8.011 0 0 0-7 4.184V1.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 .5.5h5a.5.5 0 0 0 0-1H2.344a.938.938 0 0 0 .056-.085 6 6 0 1 1 0 4.184 1 1 0 0 0-1.873.7A7.991 7.991 0 1 0 8 0z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;</span>
<a href="#l6.9"></a><span id="l6.9">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/themes/shared/mail/input-fields.css</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/themes/shared/mail/input-fields.css</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -55,8 +55,24 @@ html|input[type=&quot;number&quot;].input-number-i</span>
<a href="#l7.4"></a><span id="l7.4">   flex: 1 !important;</span>
<a href="#l7.5"></a><span id="l7.5">   padding: 2px 2px 3px;</span>
<a href="#l7.6"></a><span id="l7.6">   margin-inline-start: 2px;</span>
<a href="#l7.7"></a><span id="l7.7"> }</span>
<a href="#l7.8"></a><span id="l7.8"> </span>
<a href="#l7.9"></a><span id="l7.9"> html|input[type=&quot;number&quot;]::-moz-number-spin-box {</span>
<a href="#l7.10"></a><span id="l7.10">   margin-inline-start: 4px;</span>
<a href="#l7.11"></a><span id="l7.11"> }</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+/* Buttons */</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+.btn-reset {</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+  -moz-appearance: none;</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/icons/forget.svg&quot;);</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+  -moz-context-properties: fill;</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+  fill: currentColor;</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+  min-width: 16px;</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+  min-height: 16px;</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+  padding: 2px !important;</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+  margin-inline-end: 4px;</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineplus">+}</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineplus">+</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+.btn-reset .button-icon {</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineplus">+  margin-inline-end: 0;</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/base/content/folderProps.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/base/content/folderProps.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -2,20 +2,24 @@</span>
<a href="#l8.4"></a><span id="l8.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.5"></a><span id="l8.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l8.6"></a><span id="l8.6"> </span>
<a href="#l8.7"></a><span id="l8.7"> /* import-globals-from retention.js */</span>
<a href="#l8.8"></a><span id="l8.8"> </span>
<a href="#l8.9"></a><span id="l8.9"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l8.10"></a><span id="l8.10"> var { Gloda } = ChromeUtils.import(&quot;resource:///modules/gloda/Gloda.jsm&quot;);</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+var gFolderTreeView;</span>
<a href="#l8.13"></a><span id="l8.13"> var gMsgFolder;</span>
<a href="#l8.14"></a><span id="l8.14"> var gLockedPref = null;</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+var kCurrentColor = &quot;&quot;;</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+var kDefaultColor = &quot;#363959&quot;;</span>
<a href="#l8.17"></a><span id="l8.17"> </span>
<a href="#l8.18"></a><span id="l8.18"> document.addEventListener(&quot;dialogaccept&quot;, folderPropsOKButton);</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+document.addEventListener(&quot;dialogcancel&quot;, folderCancelButton);</span>
<a href="#l8.20"></a><span id="l8.20"> </span>
<a href="#l8.21"></a><span id="l8.21"> // The folderPropsSink is the class that gets notified of an imap folder's properties</span>
<a href="#l8.22"></a><span id="l8.22"> </span>
<a href="#l8.23"></a><span id="l8.23"> var gFolderPropsSink = {</span>
<a href="#l8.24"></a><span id="l8.24">   setFolderType(folderTypeString) {</span>
<a href="#l8.25"></a><span id="l8.25">     var typeLabel = document.getElementById(&quot;folderType.text&quot;);</span>
<a href="#l8.26"></a><span id="l8.26">     if (typeLabel) {</span>
<a href="#l8.27"></a><span id="l8.27">       typeLabel.setAttribute(&quot;value&quot;, folderTypeString);</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineat">@@ -109,16 +113,32 @@ var gFolderPropsSink = {</span>
<a href="#l8.29"></a><span id="l8.29"> </span>
<a href="#l8.30"></a><span id="l8.30"> function doEnabling() {</span>
<a href="#l8.31"></a><span id="l8.31">   var nameTextbox = document.getElementById(&quot;name&quot;);</span>
<a href="#l8.32"></a><span id="l8.32">   document</span>
<a href="#l8.33"></a><span id="l8.33">     .querySelector(&quot;dialog&quot;)</span>
<a href="#l8.34"></a><span id="l8.34">     .getButton(&quot;accept&quot;).disabled = !nameTextbox.value;</span>
<a href="#l8.35"></a><span id="l8.35"> }</span>
<a href="#l8.36"></a><span id="l8.36"> </span>
<a href="#l8.37"></a><span id="l8.37" class="difflineplus">+/**</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+ * Clear the tree selection if the user opens the color picker.</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineplus">+ */</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+function inputColorClicked() {</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineplus">+  window.arguments[0].clearFolderSelectionCallback();</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineplus">+}</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineplus">+</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineplus">+/**</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineplus">+ * Reset the folder color to the default value.</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineplus">+ */</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineplus">+function resetColor() {</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineplus">+  inputColorClicked();</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineplus">+  document.getElementById(&quot;color&quot;).value = kDefaultColor;</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineplus">+  window.arguments[0].previewSelectedColorCallback(gMsgFolder, null);</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+}</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineplus">+</span>
<a href="#l8.53"></a><span id="l8.53"> function folderPropsOKButton(event) {</span>
<a href="#l8.54"></a><span id="l8.54">   if (gMsgFolder) {</span>
<a href="#l8.55"></a><span id="l8.55">     // set charset attributes</span>
<a href="#l8.56"></a><span id="l8.56">     var folderCharsetList = document.getElementById(&quot;folderCharsetList&quot;);</span>
<a href="#l8.57"></a><span id="l8.57"> </span>
<a href="#l8.58"></a><span id="l8.58">     // Log to the Error Console the charset value for the folder</span>
<a href="#l8.59"></a><span id="l8.59">     // if it is unknown to us. Value will be preserved by the menu-item.</span>
<a href="#l8.60"></a><span id="l8.60">     if (folderCharsetList.selectedIndex == -1) {</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineat">@@ -166,44 +186,63 @@ function folderPropsOKButton(event) {</span>
<a href="#l8.62"></a><span id="l8.62"> </span>
<a href="#l8.63"></a><span id="l8.63">     var retentionSettings = saveCommonRetentionSettings(</span>
<a href="#l8.64"></a><span id="l8.64">       gMsgFolder.retentionSettings</span>
<a href="#l8.65"></a><span id="l8.65">     );</span>
<a href="#l8.66"></a><span id="l8.66">     retentionSettings.useServerDefaults = document.getElementById(</span>
<a href="#l8.67"></a><span id="l8.67">       &quot;retention.useDefault&quot;</span>
<a href="#l8.68"></a><span id="l8.68">     ).checked;</span>
<a href="#l8.69"></a><span id="l8.69">     gMsgFolder.retentionSettings = retentionSettings;</span>
<a href="#l8.70"></a><span id="l8.70" class="difflineplus">+</span>
<a href="#l8.71"></a><span id="l8.71" class="difflineplus">+    // Check if the icon color was updated.</span>
<a href="#l8.72"></a><span id="l8.72" class="difflineplus">+    if (</span>
<a href="#l8.73"></a><span id="l8.73" class="difflineplus">+      kCurrentColor !=</span>
<a href="#l8.74"></a><span id="l8.74" class="difflineplus">+      gFolderTreeView.getFolderCacheProperty(gMsgFolder, &quot;folderIconColor&quot;)</span>
<a href="#l8.75"></a><span id="l8.75" class="difflineplus">+    ) {</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineplus">+      window.arguments[0].updateColorCallback(gMsgFolder);</span>
<a href="#l8.77"></a><span id="l8.77" class="difflineplus">+    }</span>
<a href="#l8.78"></a><span id="l8.78">   }</span>
<a href="#l8.79"></a><span id="l8.79"> </span>
<a href="#l8.80"></a><span id="l8.80">   try {</span>
<a href="#l8.81"></a><span id="l8.81">     // This throws an exception when an illegal folder name was entered.</span>
<a href="#l8.82"></a><span id="l8.82">     top.okCallback(</span>
<a href="#l8.83"></a><span id="l8.83">       document.getElementById(&quot;name&quot;).value,</span>
<a href="#l8.84"></a><span id="l8.84">       window.arguments[0].name,</span>
<a href="#l8.85"></a><span id="l8.85">       gMsgFolder.URI</span>
<a href="#l8.86"></a><span id="l8.86">     );</span>
<a href="#l8.87"></a><span id="l8.87">   } catch (e) {</span>
<a href="#l8.88"></a><span id="l8.88">     event.preventDefault();</span>
<a href="#l8.89"></a><span id="l8.89">   }</span>
<a href="#l8.90"></a><span id="l8.90"> }</span>
<a href="#l8.91"></a><span id="l8.91"> </span>
<a href="#l8.92"></a><span id="l8.92" class="difflineplus">+function folderCancelButton(event) {</span>
<a href="#l8.93"></a><span id="l8.93" class="difflineplus">+  // Restore the icon to the previous color and discard edits.</span>
<a href="#l8.94"></a><span id="l8.94" class="difflineplus">+  window.arguments[0].previewSelectedColorCallback(gMsgFolder, kCurrentColor);</span>
<a href="#l8.95"></a><span id="l8.95" class="difflineplus">+}</span>
<a href="#l8.96"></a><span id="l8.96" class="difflineplus">+</span>
<a href="#l8.97"></a><span id="l8.97"> function folderPropsOnLoad() {</span>
<a href="#l8.98"></a><span id="l8.98">   // look in arguments[0] for parameters</span>
<a href="#l8.99"></a><span id="l8.99">   if (window.arguments &amp;&amp; window.arguments[0]) {</span>
<a href="#l8.100"></a><span id="l8.100">     if (window.arguments[0].title) {</span>
<a href="#l8.101"></a><span id="l8.101">       document.title = window.arguments[0].title;</span>
<a href="#l8.102"></a><span id="l8.102">     }</span>
<a href="#l8.103"></a><span id="l8.103">     if (window.arguments[0].okCallback) {</span>
<a href="#l8.104"></a><span id="l8.104">       top.okCallback = window.arguments[0].okCallback;</span>
<a href="#l8.105"></a><span id="l8.105">     }</span>
<a href="#l8.106"></a><span id="l8.106">   }</span>
<a href="#l8.107"></a><span id="l8.107"> </span>
<a href="#l8.108"></a><span id="l8.108" class="difflineminus">-  // fill in folder name, based on what they selected in the folder pane</span>
<a href="#l8.109"></a><span id="l8.109">   if (window.arguments[0].folder) {</span>
<a href="#l8.110"></a><span id="l8.110" class="difflineplus">+    // Fill in folder name, based on what they selected in the folder pane.</span>
<a href="#l8.111"></a><span id="l8.111">     gMsgFolder = window.arguments[0].folder;</span>
<a href="#l8.112"></a><span id="l8.112" class="difflineplus">+    gFolderTreeView = window.arguments[0].treeView;</span>
<a href="#l8.113"></a><span id="l8.113" class="difflineplus">+    // Store the current icon color to allow discarding edits.</span>
<a href="#l8.114"></a><span id="l8.114" class="difflineplus">+    kCurrentColor = gFolderTreeView.getFolderCacheProperty(</span>
<a href="#l8.115"></a><span id="l8.115" class="difflineplus">+      gMsgFolder,</span>
<a href="#l8.116"></a><span id="l8.116" class="difflineplus">+      &quot;folderIconColor&quot;</span>
<a href="#l8.117"></a><span id="l8.117" class="difflineplus">+    );</span>
<a href="#l8.118"></a><span id="l8.118">   } else {</span>
<a href="#l8.119"></a><span id="l8.119">     dump(&quot;passed null for folder, do nothing\n&quot;);</span>
<a href="#l8.120"></a><span id="l8.120">   }</span>
<a href="#l8.121"></a><span id="l8.121"> </span>
<a href="#l8.122"></a><span id="l8.122">   if (window.arguments[0].name) {</span>
<a href="#l8.123"></a><span id="l8.123">     // Initialize name textbox with the given name and remember this</span>
<a href="#l8.124"></a><span id="l8.124">     // value so we can tell whether the folder needs to be renamed</span>
<a href="#l8.125"></a><span id="l8.125">     // when the dialog is accepted.</span>
<a href="#l8.126"></a><span id="l8.126" class="difflineat">@@ -224,16 +263,25 @@ function folderPropsOnLoad() {</span>
<a href="#l8.127"></a><span id="l8.127">     // We really need a functioning database, so we'll detect problems</span>
<a href="#l8.128"></a><span id="l8.128">     // and create one if we have to.</span>
<a href="#l8.129"></a><span id="l8.129">     try {</span>
<a href="#l8.130"></a><span id="l8.130">       gMsgFolder.getDatabase(null);</span>
<a href="#l8.131"></a><span id="l8.131">     } catch (e) {</span>
<a href="#l8.132"></a><span id="l8.132">       gMsgFolder.updateFolder(window.arguments[0].msgWindow);</span>
<a href="#l8.133"></a><span id="l8.133">     }</span>
<a href="#l8.134"></a><span id="l8.134"> </span>
<a href="#l8.135"></a><span id="l8.135" class="difflineplus">+    let colorInput = document.getElementById(&quot;color&quot;);</span>
<a href="#l8.136"></a><span id="l8.136" class="difflineplus">+    colorInput.value = kCurrentColor ? kCurrentColor : kDefaultColor;</span>
<a href="#l8.137"></a><span id="l8.137" class="difflineplus">+    colorInput.addEventListener(&quot;input&quot;, event =&gt; {</span>
<a href="#l8.138"></a><span id="l8.138" class="difflineplus">+      window.arguments[0].previewSelectedColorCallback(</span>
<a href="#l8.139"></a><span id="l8.139" class="difflineplus">+        gMsgFolder,</span>
<a href="#l8.140"></a><span id="l8.140" class="difflineplus">+        event.target.value</span>
<a href="#l8.141"></a><span id="l8.141" class="difflineplus">+      );</span>
<a href="#l8.142"></a><span id="l8.142" class="difflineplus">+    });</span>
<a href="#l8.143"></a><span id="l8.143" class="difflineplus">+</span>
<a href="#l8.144"></a><span id="l8.144">     var locationTextbox = document.getElementById(&quot;location&quot;);</span>
<a href="#l8.145"></a><span id="l8.145"> </span>
<a href="#l8.146"></a><span id="l8.146">     // Decode the displayed mailbox:// URL as it's useful primarily for debugging,</span>
<a href="#l8.147"></a><span id="l8.147">     // whereas imap and news urls are sent around.</span>
<a href="#l8.148"></a><span id="l8.148">     locationTextbox.value =</span>
<a href="#l8.149"></a><span id="l8.149">       serverType == &quot;imap&quot; || serverType == &quot;nntp&quot;</span>
<a href="#l8.150"></a><span id="l8.150">         ? gMsgFolder.folderURL</span>
<a href="#l8.151"></a><span id="l8.151">         : decodeURI(gMsgFolder.folderURL);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/content/folderProps.xhtml</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/content/folderProps.xhtml</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -39,16 +39,28 @@</span>
<a href="#l9.4"></a><span id="l9.4">         &lt;label id=&quot;nameLabel&quot; value=&quot;&amp;folderProps.name.label;&quot; control=&quot;name&quot;</span>
<a href="#l9.5"></a><span id="l9.5">                accesskey=&quot;&amp;folderProps.name.accesskey;&quot;/&gt;</span>
<a href="#l9.6"></a><span id="l9.6">         &lt;html:input id=&quot;name&quot;</span>
<a href="#l9.7"></a><span id="l9.7">                     type=&quot;text&quot;</span>
<a href="#l9.8"></a><span id="l9.8">                     readonly=&quot;readonly&quot;</span>
<a href="#l9.9"></a><span id="l9.9">                     oninput=&quot;doEnabling();&quot;</span>
<a href="#l9.10"></a><span id="l9.10">                     class=&quot;input-inline&quot;</span>
<a href="#l9.11"></a><span id="l9.11">                     aria-labelledby=&quot;nameLabel&quot;/&gt;</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+        &lt;label id=&quot;colorLabel&quot; value=&quot;&amp;folderProps.color.label;&quot; control=&quot;color&quot;</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+               accesskey=&quot;&amp;folderProps.color.accesskey;&quot;/&gt;</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+        &lt;html:input id=&quot;color&quot;</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+                    type=&quot;color&quot;</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+                    value=&quot;&quot;</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+                    class=&quot;input-inline-color&quot;</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+                    onclick=&quot;inputColorClicked();&quot;</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+                    aria-labelledby=&quot;colorLabel&quot;/&gt;</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+        &lt;button id=&quot;resetColor&quot;</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineplus">+                tooltiptext=&quot;&amp;folderProps.reset.tooltip;&quot;</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineplus">+                class=&quot;toolbarbutton-1 btn-flat btn-reset&quot;</span>
<a href="#l9.23"></a><span id="l9.23" class="difflineplus">+                onclick=&quot;resetColor();&quot;/&gt;</span>
<a href="#l9.24"></a><span id="l9.24">       &lt;/hbox&gt;</span>
<a href="#l9.25"></a><span id="l9.25">       &lt;hbox align=&quot;center&quot; class=&quot;input-container&quot;&gt;</span>
<a href="#l9.26"></a><span id="l9.26">         &lt;label id=&quot;locationLabel&quot; value=&quot;&amp;folderProps.location.label;&quot;</span>
<a href="#l9.27"></a><span id="l9.27">                control=&quot;location&quot; accesskey=&quot;&amp;folderProps.location.accesskey;&quot;/&gt;</span>
<a href="#l9.28"></a><span id="l9.28">         &lt;html:input id=&quot;location&quot;</span>
<a href="#l9.29"></a><span id="l9.29">                     type=&quot;text&quot;</span>
<a href="#l9.30"></a><span id="l9.30">                     readonly=&quot;readonly&quot;</span>
<a href="#l9.31"></a><span id="l9.31">                     class=&quot;uri-element input-inline&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/base/content/msgSelectOfflineFolders.xhtml</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/base/content/msgSelectOfflineFolders.xhtml</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -1,30 +1,35 @@</span>
<a href="#l10.4"></a><span id="l10.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l10.5"></a><span id="l10.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l10.6"></a><span id="l10.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l10.7"></a><span id="l10.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l10.8"></a><span id="l10.8"> </span>
<a href="#l10.9"></a><span id="l10.9"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/msgSelectOffline.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineplus">+&lt;!-- NEEDED FOR FOLDER COLOR CUSTOMIZATION --&gt;</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineplus">+&lt;?xml-stylesheet href=&quot;#inlineStyle&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l10.12"></a><span id="l10.12"> </span>
<a href="#l10.13"></a><span id="l10.13"> &lt;!DOCTYPE window SYSTEM &quot;chrome://messenger/locale/msgSynchronize.dtd&quot; &gt;</span>
<a href="#l10.14"></a><span id="l10.14"> </span>
<a href="#l10.15"></a><span id="l10.15"> &lt;window xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot; xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l10.16"></a><span id="l10.16">         windowtype=&quot;mailnews:selectOffline&quot;</span>
<a href="#l10.17"></a><span id="l10.17">         title=&quot;&amp;MsgSelect.label;&quot;</span>
<a href="#l10.18"></a><span id="l10.18">         width=&quot;450&quot; height=&quot;400&quot;</span>
<a href="#l10.19"></a><span id="l10.19">         persist=&quot;width height&quot;</span>
<a href="#l10.20"></a><span id="l10.20">         onload=&quot;gSelectOffline.load();&quot;&gt;</span>
<a href="#l10.21"></a><span id="l10.21"> &lt;dialog id=&quot;select-offline&quot;&gt;</span>
<a href="#l10.22"></a><span id="l10.22">   &lt;stringbundle id=&quot;bundle_messenger&quot; src=&quot;chrome://messenger/locale/messenger.properties&quot;/&gt;</span>
<a href="#l10.23"></a><span id="l10.23">   &lt;stringbundle id=&quot;bundle_brand&quot; src=&quot;chrome://branding/locale/brand.properties&quot;/&gt;</span>
<a href="#l10.24"></a><span id="l10.24"> </span>
<a href="#l10.25"></a><span id="l10.25">   &lt;script src=&quot;chrome://messenger/content/msgSelectOfflineFolders.js&quot;/&gt;</span>
<a href="#l10.26"></a><span id="l10.26">   &lt;script src=&quot;chrome://messenger/content/folderPane.js&quot;/&gt;</span>
<a href="#l10.27"></a><span id="l10.27"> </span>
<a href="#l10.28"></a><span id="l10.28" class="difflineplus">+  &lt;!-- NEEDED FOR FOLDER COLOR CUSTOMIZATION --&gt;</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineplus">+  &lt;html:style type=&quot;text/css&quot; id=&quot;inlineStyle&quot;&gt;&lt;/html:style&gt;</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineplus">+</span>
<a href="#l10.31"></a><span id="l10.31">   &lt;label class=&quot;desc&quot; control=&quot;synchronizeTree&quot;&gt;&amp;MsgSelectDesc.label;&lt;/label&gt;</span>
<a href="#l10.32"></a><span id="l10.32"> </span>
<a href="#l10.33"></a><span id="l10.33">   &lt;tree id=&quot;synchronizeTree&quot;</span>
<a href="#l10.34"></a><span id="l10.34">         flex=&quot;1&quot;</span>
<a href="#l10.35"></a><span id="l10.35">         hidecolumnpicker=&quot;true&quot;</span>
<a href="#l10.36"></a><span id="l10.36">         seltype=&quot;multiple&quot;</span>
<a href="#l10.37"></a><span id="l10.37">         disableKeyNavigation=&quot;true&quot;</span>
<a href="#l10.38"></a><span id="l10.38">         simplelist=&quot;true&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/base/content/virtualFolderListEdit.xhtml</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/base/content/virtualFolderListEdit.xhtml</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1,28 +1,33 @@</span>
<a href="#l11.4"></a><span id="l11.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l11.5"></a><span id="l11.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.6"></a><span id="l11.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.7"></a><span id="l11.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l11.8"></a><span id="l11.8">    --&gt;</span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/mailWindow1.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineplus">+&lt;!-- NEEDED FOR FOLDER COLOR CUSTOMIZATION --&gt;</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+&lt;?xml-stylesheet href=&quot;#inlineStyle&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l11.13"></a><span id="l11.13"> </span>
<a href="#l11.14"></a><span id="l11.14"> &lt;!DOCTYPE window SYSTEM &quot;chrome://messenger/locale/virtualFolderListDialog.dtd&quot;&gt;</span>
<a href="#l11.15"></a><span id="l11.15"> </span>
<a href="#l11.16"></a><span id="l11.16"> &lt;window xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot; xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l11.17"></a><span id="l11.17">         title=&quot;&amp;virtualFolderListTitle.title;&quot;</span>
<a href="#l11.18"></a><span id="l11.18">         windowtype=&quot;mailnews:virtualFolderList&quot;</span>
<a href="#l11.19"></a><span id="l11.19">         style=&quot;width: 27em; height: 25em;&quot;</span>
<a href="#l11.20"></a><span id="l11.20">         persist=&quot;width height screenX screenY&quot;</span>
<a href="#l11.21"></a><span id="l11.21">         onload=&quot;gSelectVirtual.load();&quot;&gt;</span>
<a href="#l11.22"></a><span id="l11.22"> &lt;dialog id=&quot;searchFolderWindow&quot;&gt;</span>
<a href="#l11.23"></a><span id="l11.23">   &lt;script src=&quot;chrome://messenger/content/virtualFolderListEdit.js&quot;/&gt;</span>
<a href="#l11.24"></a><span id="l11.24">   &lt;script src=&quot;chrome://messenger/content/folderPane.js&quot;/&gt;</span>
<a href="#l11.25"></a><span id="l11.25"> </span>
<a href="#l11.26"></a><span id="l11.26" class="difflineplus">+  &lt;!-- NEEDED FOR FOLDER COLOR CUSTOMIZATION --&gt;</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineplus">+  &lt;html:style type=&quot;text/css&quot; id=&quot;inlineStyle&quot;&gt;&lt;/html:style&gt;</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+</span>
<a href="#l11.29"></a><span id="l11.29">   &lt;stringbundle id=&quot;bundle_messenger&quot; src=&quot;chrome://messenger/locale/messenger.properties&quot;/&gt;</span>
<a href="#l11.30"></a><span id="l11.30"> </span>
<a href="#l11.31"></a><span id="l11.31">   &lt;label control=&quot;folderPickerTree&quot;&gt;&amp;virtualFolderDesc.label;&lt;/label&gt;</span>
<a href="#l11.32"></a><span id="l11.32"> </span>
<a href="#l11.33"></a><span id="l11.33">     &lt;tree id=&quot;folderPickerTree&quot;</span>
<a href="#l11.34"></a><span id="l11.34">           flex=&quot;1&quot;</span>
<a href="#l11.35"></a><span id="l11.35">           hidecolumnpicker=&quot;true&quot;</span>
<a href="#l11.36"></a><span id="l11.36">           seltype=&quot;multiple&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/content/virtualFolderProperties.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/content/virtualFolderProperties.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -1,21 +1,24 @@</span>
<a href="#l12.4"></a><span id="l12.4"> /* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l12.5"></a><span id="l12.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l12.6"></a><span id="l12.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l12.7"></a><span id="l12.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l12.8"></a><span id="l12.8"> </span>
<a href="#l12.9"></a><span id="l12.9"> /* import-globals-from ../search/content/searchTerm.js */</span>
<a href="#l12.10"></a><span id="l12.10"> </span>
<a href="#l12.11"></a><span id="l12.11" class="difflineplus">+var gFolderTreeView;</span>
<a href="#l12.12"></a><span id="l12.12"> var gPickedFolder;</span>
<a href="#l12.13"></a><span id="l12.13"> var gMailView = null;</span>
<a href="#l12.14"></a><span id="l12.14"> var msgWindow; // important, don't change the name of this variable. it's really a global used by commandglue.js</span>
<a href="#l12.15"></a><span id="l12.15"> var gSearchTermSession; // really an in memory temporary filter we use to read in and write out the search terms</span>
<a href="#l12.16"></a><span id="l12.16"> var gSearchFolderURIs = &quot;&quot;;</span>
<a href="#l12.17"></a><span id="l12.17"> var gMessengerBundle = null;</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+var kCurrentColor = &quot;&quot;;</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+var kDefaultColor = &quot;#363959&quot;;</span>
<a href="#l12.20"></a><span id="l12.20"> </span>
<a href="#l12.21"></a><span id="l12.21"> var nsMsgSearchScope = Ci.nsMsgSearchScope;</span>
<a href="#l12.22"></a><span id="l12.22"> </span>
<a href="#l12.23"></a><span id="l12.23"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l12.24"></a><span id="l12.24"> var { PluralForm } = ChromeUtils.import(</span>
<a href="#l12.25"></a><span id="l12.25">   &quot;resource://gre/modules/PluralForm.jsm&quot;</span>
<a href="#l12.26"></a><span id="l12.26"> );</span>
<a href="#l12.27"></a><span id="l12.27"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineat">@@ -25,16 +28,17 @@ var { VirtualFolderHelper } = ChromeUtil</span>
<a href="#l12.29"></a><span id="l12.29">   &quot;resource:///modules/VirtualFolderWrapper.jsm&quot;</span>
<a href="#l12.30"></a><span id="l12.30"> );</span>
<a href="#l12.31"></a><span id="l12.31"> var { fixIterator } = ChromeUtils.import(</span>
<a href="#l12.32"></a><span id="l12.32">   &quot;resource:///modules/iteratorUtils.jsm&quot;</span>
<a href="#l12.33"></a><span id="l12.33"> );</span>
<a href="#l12.34"></a><span id="l12.34"> var { MailUtils } = ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l12.35"></a><span id="l12.35"> </span>
<a href="#l12.36"></a><span id="l12.36"> document.addEventListener(&quot;dialogaccept&quot;, onOK);</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineplus">+document.addEventListener(&quot;dialogcancel&quot;, onCancel);</span>
<a href="#l12.38"></a><span id="l12.38"> </span>
<a href="#l12.39"></a><span id="l12.39"> function onLoad() {</span>
<a href="#l12.40"></a><span id="l12.40">   var windowArgs = window.arguments[0];</span>
<a href="#l12.41"></a><span id="l12.41">   var acceptButton = document.querySelector(&quot;dialog&quot;).getButton(&quot;accept&quot;);</span>
<a href="#l12.42"></a><span id="l12.42"> </span>
<a href="#l12.43"></a><span id="l12.43">   gMessengerBundle = document.getElementById(&quot;bundle_messenger&quot;);</span>
<a href="#l12.44"></a><span id="l12.44"> </span>
<a href="#l12.45"></a><span id="l12.45">   // call this when OK is pressed</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineat">@@ -146,16 +150,34 @@ function InitDialogWithVirtualFolder(aVi</span>
<a href="#l12.47"></a><span id="l12.47">   );</span>
<a href="#l12.48"></a><span id="l12.48"> </span>
<a href="#l12.49"></a><span id="l12.49">   // when editing an existing folder, hide the folder picker that stores the parent location of the folder</span>
<a href="#l12.50"></a><span id="l12.50">   document.getElementById(&quot;msgNewFolderPicker&quot;).collapsed = true;</span>
<a href="#l12.51"></a><span id="l12.51">   document.getElementById(&quot;chooseFolderLocationLabel&quot;).collapsed = true;</span>
<a href="#l12.52"></a><span id="l12.52">   let folderNameField = document.getElementById(&quot;existingName&quot;);</span>
<a href="#l12.53"></a><span id="l12.53">   folderNameField.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l12.54"></a><span id="l12.54"> </span>
<a href="#l12.55"></a><span id="l12.55" class="difflineplus">+  // Show the icon color options.</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineplus">+  document.getElementById(&quot;iconColorContainer&quot;).collapsed = false;</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+  // Store the current icon color to allow discarding edits.</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineplus">+  gFolderTreeView = window.arguments[0].treeView;</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineplus">+  kCurrentColor = gFolderTreeView.getFolderCacheProperty(</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineplus">+    aVirtualFolder,</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineplus">+    &quot;folderIconColor&quot;</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineplus">+  );</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineplus">+</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineplus">+  let colorInput = document.getElementById(&quot;color&quot;);</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineplus">+  colorInput.value = kCurrentColor ? kCurrentColor : kDefaultColor;</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineplus">+  colorInput.addEventListener(&quot;input&quot;, event =&gt; {</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineplus">+    window.arguments[0].previewSelectedColorCallback(</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineplus">+      aVirtualFolder,</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineplus">+      event.target.value</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineplus">+    );</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineplus">+  });</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineplus">+</span>
<a href="#l12.73"></a><span id="l12.73">   gSearchFolderURIs = virtualFolderWrapper.searchFolderURIs;</span>
<a href="#l12.74"></a><span id="l12.74">   updateFoldersCount();</span>
<a href="#l12.75"></a><span id="l12.75">   document.getElementById(&quot;searchOnline&quot;).checked =</span>
<a href="#l12.76"></a><span id="l12.76">     virtualFolderWrapper.onlineSearch;</span>
<a href="#l12.77"></a><span id="l12.77">   gSearchTermSession = virtualFolderWrapper.searchTermsSession;</span>
<a href="#l12.78"></a><span id="l12.78"> </span>
<a href="#l12.79"></a><span id="l12.79">   setupSearchRows(gSearchTermSession.searchTerms);</span>
<a href="#l12.80"></a><span id="l12.80"> </span>
<a href="#l12.81"></a><span id="l12.81" class="difflineat">@@ -201,16 +223,27 @@ function onOK(event) {</span>
<a href="#l12.82"></a><span id="l12.82">     );</span>
<a href="#l12.83"></a><span id="l12.83">     virtualFolderWrapper.searchTerms = gSearchTermSession.searchTerms;</span>
<a href="#l12.84"></a><span id="l12.84">     virtualFolderWrapper.searchFolders = gSearchFolderURIs;</span>
<a href="#l12.85"></a><span id="l12.85">     virtualFolderWrapper.onlineSearch = searchOnline;</span>
<a href="#l12.86"></a><span id="l12.86">     virtualFolderWrapper.cleanUpMessageDatabase();</span>
<a href="#l12.87"></a><span id="l12.87"> </span>
<a href="#l12.88"></a><span id="l12.88">     MailServices.accounts.saveVirtualFolders();</span>
<a href="#l12.89"></a><span id="l12.89"> </span>
<a href="#l12.90"></a><span id="l12.90" class="difflineplus">+    // Check if the icon color was updated.</span>
<a href="#l12.91"></a><span id="l12.91" class="difflineplus">+    if (</span>
<a href="#l12.92"></a><span id="l12.92" class="difflineplus">+      kCurrentColor !=</span>
<a href="#l12.93"></a><span id="l12.93" class="difflineplus">+      gFolderTreeView.getFolderCacheProperty(</span>
<a href="#l12.94"></a><span id="l12.94" class="difflineplus">+        window.arguments[0].folder,</span>
<a href="#l12.95"></a><span id="l12.95" class="difflineplus">+        &quot;folderIconColor&quot;</span>
<a href="#l12.96"></a><span id="l12.96" class="difflineplus">+      )</span>
<a href="#l12.97"></a><span id="l12.97" class="difflineplus">+    ) {</span>
<a href="#l12.98"></a><span id="l12.98" class="difflineplus">+      window.arguments[0].updateColorCallback(window.arguments[0].folder);</span>
<a href="#l12.99"></a><span id="l12.99" class="difflineplus">+    }</span>
<a href="#l12.100"></a><span id="l12.100" class="difflineplus">+</span>
<a href="#l12.101"></a><span id="l12.101">     if (window.arguments[0].onOKCallback) {</span>
<a href="#l12.102"></a><span id="l12.102">       window.arguments[0].onOKCallback(virtualFolderWrapper.virtualFolder.URI);</span>
<a href="#l12.103"></a><span id="l12.103">     }</span>
<a href="#l12.104"></a><span id="l12.104">     return;</span>
<a href="#l12.105"></a><span id="l12.105">   }</span>
<a href="#l12.106"></a><span id="l12.106">   var uri = gPickedFolder.URI;</span>
<a href="#l12.107"></a><span id="l12.107">   if (name &amp;&amp; uri) {</span>
<a href="#l12.108"></a><span id="l12.108">     // create a new virtual folder</span>
<a href="#l12.109"></a><span id="l12.109" class="difflineat">@@ -243,16 +276,26 @@ function onOK(event) {</span>
<a href="#l12.110"></a><span id="l12.110">       parentFolder,</span>
<a href="#l12.111"></a><span id="l12.111">       gSearchFolderURIs,</span>
<a href="#l12.112"></a><span id="l12.112">       gSearchTermSession.searchTerms,</span>
<a href="#l12.113"></a><span id="l12.113">       searchOnline</span>
<a href="#l12.114"></a><span id="l12.114">     );</span>
<a href="#l12.115"></a><span id="l12.115">   }</span>
<a href="#l12.116"></a><span id="l12.116"> }</span>
<a href="#l12.117"></a><span id="l12.117"> </span>
<a href="#l12.118"></a><span id="l12.118" class="difflineplus">+function onCancel(event) {</span>
<a href="#l12.119"></a><span id="l12.119" class="difflineplus">+  if (window.arguments[0].folder) {</span>
<a href="#l12.120"></a><span id="l12.120" class="difflineplus">+    // Restore the icon to the previous color and discard edits.</span>
<a href="#l12.121"></a><span id="l12.121" class="difflineplus">+    window.arguments[0].previewSelectedColorCallback(</span>
<a href="#l12.122"></a><span id="l12.122" class="difflineplus">+      window.arguments[0].folder,</span>
<a href="#l12.123"></a><span id="l12.123" class="difflineplus">+      kCurrentColor</span>
<a href="#l12.124"></a><span id="l12.124" class="difflineplus">+    );</span>
<a href="#l12.125"></a><span id="l12.125" class="difflineplus">+  }</span>
<a href="#l12.126"></a><span id="l12.126" class="difflineplus">+}</span>
<a href="#l12.127"></a><span id="l12.127" class="difflineplus">+</span>
<a href="#l12.128"></a><span id="l12.128"> function doEnabling() {</span>
<a href="#l12.129"></a><span id="l12.129">   var acceptButton = document.querySelector(&quot;dialog&quot;).getButton(&quot;accept&quot;);</span>
<a href="#l12.130"></a><span id="l12.130">   acceptButton.disabled = !document.getElementById(&quot;name&quot;).value;</span>
<a href="#l12.131"></a><span id="l12.131"> }</span>
<a href="#l12.132"></a><span id="l12.132"> </span>
<a href="#l12.133"></a><span id="l12.133"> function chooseFoldersToSearch() {</span>
<a href="#l12.134"></a><span id="l12.134">   // if we have some search folders already, then root the folder picker dialog off the account</span>
<a href="#l12.135"></a><span id="l12.135">   // for those folders. Otherwise fall back to the preselectedfolderURI which is the parent folder</span>
<a href="#l12.136"></a><span id="l12.136" class="difflineat">@@ -298,8 +341,27 @@ function updateFoldersCount() {</span>
<a href="#l12.137"></a><span id="l12.137">     foldersList.removeAttribute(&quot;tooltiptext&quot;);</span>
<a href="#l12.138"></a><span id="l12.138">   }</span>
<a href="#l12.139"></a><span id="l12.139"> }</span>
<a href="#l12.140"></a><span id="l12.140"> </span>
<a href="#l12.141"></a><span id="l12.141"> function onEnterInSearchTerm() {</span>
<a href="#l12.142"></a><span id="l12.142">   // stub function called by the core search widget code...</span>
<a href="#l12.143"></a><span id="l12.143">   // nothing for us to do here</span>
<a href="#l12.144"></a><span id="l12.144"> }</span>
<a href="#l12.145"></a><span id="l12.145" class="difflineplus">+</span>
<a href="#l12.146"></a><span id="l12.146" class="difflineplus">+/**</span>
<a href="#l12.147"></a><span id="l12.147" class="difflineplus">+ * Clear the tree selection if the user opens the color picker.</span>
<a href="#l12.148"></a><span id="l12.148" class="difflineplus">+ */</span>
<a href="#l12.149"></a><span id="l12.149" class="difflineplus">+function inputColorClicked() {</span>
<a href="#l12.150"></a><span id="l12.150" class="difflineplus">+  window.arguments[0].clearFolderSelectionCallback();</span>
<a href="#l12.151"></a><span id="l12.151" class="difflineplus">+}</span>
<a href="#l12.152"></a><span id="l12.152" class="difflineplus">+</span>
<a href="#l12.153"></a><span id="l12.153" class="difflineplus">+/**</span>
<a href="#l12.154"></a><span id="l12.154" class="difflineplus">+ * Reset the folder color to the default value.</span>
<a href="#l12.155"></a><span id="l12.155" class="difflineplus">+ */</span>
<a href="#l12.156"></a><span id="l12.156" class="difflineplus">+function resetColor() {</span>
<a href="#l12.157"></a><span id="l12.157" class="difflineplus">+  inputColorClicked();</span>
<a href="#l12.158"></a><span id="l12.158" class="difflineplus">+  document.getElementById(&quot;color&quot;).value = kDefaultColor;</span>
<a href="#l12.159"></a><span id="l12.159" class="difflineplus">+  window.arguments[0].previewSelectedColorCallback(</span>
<a href="#l12.160"></a><span id="l12.160" class="difflineplus">+    window.arguments[0].folder,</span>
<a href="#l12.161"></a><span id="l12.161" class="difflineplus">+    null</span>
<a href="#l12.162"></a><span id="l12.162" class="difflineplus">+  );</span>
<a href="#l12.163"></a><span id="l12.163" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/content/virtualFolderProperties.xhtml</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/content/virtualFolderProperties.xhtml</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -6,16 +6,18 @@</span>
<a href="#l13.4"></a><span id="l13.4"> </span>
<a href="#l13.5"></a><span id="l13.5"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/searchDialog.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l13.6"></a><span id="l13.6"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/folderMenus.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l13.7"></a><span id="l13.7"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/input-fields.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l13.8"></a><span id="l13.8"> </span>
<a href="#l13.9"></a><span id="l13.9"> &lt;!DOCTYPE window [</span>
<a href="#l13.10"></a><span id="l13.10">   &lt;!ENTITY % folderDTD SYSTEM &quot;chrome://messenger/locale/virtualFolderProperties.dtd&quot;&gt;</span>
<a href="#l13.11"></a><span id="l13.11">   %folderDTD;</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+  &lt;!ENTITY % folderPropsDTD SYSTEM &quot;chrome://messenger/locale/folderProps.dtd&quot;&gt;</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+  %folderPropsDTD;</span>
<a href="#l13.14"></a><span id="l13.14">   &lt;!ENTITY % searchTermDTD SYSTEM &quot;chrome://messenger/locale/searchTermOverlay.dtd&quot;&gt;</span>
<a href="#l13.15"></a><span id="l13.15">   %searchTermDTD;</span>
<a href="#l13.16"></a><span id="l13.16"> ]&gt;</span>
<a href="#l13.17"></a><span id="l13.17"> </span>
<a href="#l13.18"></a><span id="l13.18"> &lt;window xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l13.19"></a><span id="l13.19">         xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l13.20"></a><span id="l13.20">         title=&quot;&amp;virtualFolderProperties.title;&quot;</span>
<a href="#l13.21"></a><span id="l13.21">         onload=&quot;onLoad();&quot;</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -50,26 +52,42 @@</span>
<a href="#l13.23"></a><span id="l13.23">         &lt;label value=&quot;&amp;description.label;&quot; accesskey=&quot;&amp;description.accesskey;&quot;</span>
<a href="#l13.24"></a><span id="l13.24">                control=&quot;msgNewFolderPicker&quot;/&gt;</span>
<a href="#l13.25"></a><span id="l13.25">       &lt;/hbox&gt;</span>
<a href="#l13.26"></a><span id="l13.26">       &lt;hbox flex=&quot;1&quot; align=&quot;center&quot;&gt;</span>
<a href="#l13.27"></a><span id="l13.27">         &lt;label value=&quot;&amp;folderSelectionCaption.label;&quot;/&gt;</span>
<a href="#l13.28"></a><span id="l13.28">       &lt;/hbox&gt;</span>
<a href="#l13.29"></a><span id="l13.29">     &lt;/vbox&gt;</span>
<a href="#l13.30"></a><span id="l13.30">     &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-      &lt;html:input id=&quot;name&quot;</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineminus">-                  hidden=&quot;true&quot;</span>
<a href="#l13.33"></a><span id="l13.33" class="difflineminus">-                  class=&quot;input-inline&quot;</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineminus">-                  aria-labelledby=&quot;nameLabel&quot;</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineminus">-                  oninput=&quot;doEnabling();&quot;/&gt;</span>
<a href="#l13.36"></a><span id="l13.36" class="difflineminus">-      &lt;html:input id=&quot;existingName&quot;</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineminus">-                  readonly=&quot;readonly&quot;</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineminus">-                  hidden=&quot;hidden&quot;</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineminus">-                  class=&quot;input-inline&quot;</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineminus">-                  tabindex=&quot;0&quot;/&gt;</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineplus">+      &lt;hbox class=&quot;input-container&quot;&gt;</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineplus">+        &lt;html:input id=&quot;name&quot;</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineplus">+                    hidden=&quot;hidden&quot;</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineplus">+                    class=&quot;input-inline&quot;</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineplus">+                    aria-labelledby=&quot;nameLabel&quot;</span>
<a href="#l13.46"></a><span id="l13.46" class="difflineplus">+                    oninput=&quot;doEnabling();&quot;/&gt;</span>
<a href="#l13.47"></a><span id="l13.47" class="difflineplus">+        &lt;html:input id=&quot;existingName&quot;</span>
<a href="#l13.48"></a><span id="l13.48" class="difflineplus">+                    readonly=&quot;readonly&quot;</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineplus">+                    hidden=&quot;hidden&quot;</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineplus">+                    class=&quot;input-inline&quot;</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+                    tabindex=&quot;0&quot;/&gt;</span>
<a href="#l13.52"></a><span id="l13.52" class="difflineplus">+        &lt;hbox id=&quot;iconColorContainer&quot; align=&quot;center&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l13.53"></a><span id="l13.53" class="difflineplus">+          &lt;label id=&quot;colorLabel&quot; value=&quot;&amp;folderProps.color.label;&quot; control=&quot;color&quot;</span>
<a href="#l13.54"></a><span id="l13.54" class="difflineplus">+                 accesskey=&quot;&amp;folderProps.color.accesskey;&quot;/&gt;</span>
<a href="#l13.55"></a><span id="l13.55" class="difflineplus">+          &lt;html:input id=&quot;color&quot;</span>
<a href="#l13.56"></a><span id="l13.56" class="difflineplus">+                      type=&quot;color&quot;</span>
<a href="#l13.57"></a><span id="l13.57" class="difflineplus">+                      value=&quot;&quot;</span>
<a href="#l13.58"></a><span id="l13.58" class="difflineplus">+                      class=&quot;input-inline-color&quot;</span>
<a href="#l13.59"></a><span id="l13.59" class="difflineplus">+                      onclick=&quot;inputColorClicked();&quot;</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineplus">+                      aria-labelledby=&quot;colorLabel&quot;/&gt;</span>
<a href="#l13.61"></a><span id="l13.61" class="difflineplus">+          &lt;button id=&quot;resetColor&quot;</span>
<a href="#l13.62"></a><span id="l13.62" class="difflineplus">+                  tooltiptext=&quot;&amp;folderProps.reset.tooltip;&quot;</span>
<a href="#l13.63"></a><span id="l13.63" class="difflineplus">+                  class=&quot;toolbarbutton-1 btn-flat btn-reset&quot;</span>
<a href="#l13.64"></a><span id="l13.64" class="difflineplus">+                  onclick=&quot;resetColor();&quot;/&gt;</span>
<a href="#l13.65"></a><span id="l13.65" class="difflineplus">+        &lt;/hbox&gt;</span>
<a href="#l13.66"></a><span id="l13.66" class="difflineplus">+      &lt;/hbox&gt;</span>
<a href="#l13.67"></a><span id="l13.67">       &lt;menulist id=&quot;msgNewFolderPicker&quot; class=&quot;folderMenuItem&quot; align=&quot;center&quot;</span>
<a href="#l13.68"></a><span id="l13.68">                 displayformat=&quot;verbose&quot;&gt;</span>
<a href="#l13.69"></a><span id="l13.69">         &lt;menupopup is=&quot;folder-menupopup&quot; id=&quot;msgNewFolderPopup&quot; class=&quot;menulist-menupopup&quot;</span>
<a href="#l13.70"></a><span id="l13.70">                    mode=&quot;newFolder&quot; showFileHereLabel=&quot;true&quot; oncommand=&quot;onFolderPick(event);&quot;/&gt;</span>
<a href="#l13.71"></a><span id="l13.71">       &lt;/menulist&gt;</span>
<a href="#l13.72"></a><span id="l13.72">       &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l13.73"></a><span id="l13.73">         &lt;label id=&quot;chosenFoldersCount&quot;/&gt;</span>
<a href="#l13.74"></a><span id="l13.74">         &lt;spacer flex=&quot;1&quot;/&gt;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

