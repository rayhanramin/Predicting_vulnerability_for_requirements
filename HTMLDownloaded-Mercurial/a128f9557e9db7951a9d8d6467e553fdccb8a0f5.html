<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 27920:a128f9557e9db7951a9d8d6467e553fdccb8a0f5</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ a128f9557e9db7951a9d8d6467e553fdccb8a0f5" />
<meta property="og:url" content="/comm-central/rev/a128f9557e9db7951a9d8d6467e553fdccb8a0f5" />
<meta property="og:description" content="Bug 1570954 - Port bug 1479125 to Thunderbird: Rewrite callers firstChild/lastChild/childNodes/previousSibling/nextSibling with firstElementChild/lastElementChild/children/previousElementSibling/nextElementSibling. r=pmorris" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / a128f9557e9db7951a9d8d6467e553fdccb8a0f5 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/a128f9557e9db7951a9d8d6467e553fdccb8a0f5">shortlog</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/a128f9557e9db7951a9d8d6467e553fdccb8a0f5">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5">files</a> |
changeset |
<a href="/comm-central/raw-rev/a128f9557e9db7951a9d8d6467e553fdccb8a0f5">raw</a>  | <a href="/comm-central/archive/a128f9557e9db7951a9d8d6467e553fdccb8a0f5.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1570954">Bug 1570954</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1479125">bug 1479125</a> to Thunderbird: Rewrite callers firstChild/lastChild/childNodes/previousSibling/nextSibling with firstElementChild/lastElementChild/children/previousElementSibling/nextElementSibling. r=pmorris
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#77;&#97;&#103;&#110;&#117;&#115;&#32;&#77;&#101;&#108;&#105;&#110;&#32;&#60;&#109;&#107;&#109;&#101;&#108;&#105;&#110;&#43;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#64;&#105;&#107;&#105;&#46;&#102;&#105;&#62;</td></tr>
<tr><td></td><td class="date age">Sun, 13 Oct 2019 21:42:57 +0300</td></tr>

<tr>
 <td>changeset 27920</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/a128f9557e9db7951a9d8d6467e553fdccb8a0f5">a128f9557e9db7951a9d8d6467e553fdccb8a0f5</a></td>
</tr>



<tr>
<td>parent 27919</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/f183f40dfbce173c852f63662eca4cdcfea7c1c7">f183f40dfbce173c852f63662eca4cdcfea7c1c7</a>
</td>
</tr>

<tr>
<td>child 27921</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/f8fca88b8f1e45a94ef62ddb21e711b7c43f8c83">f8fca88b8f1e45a94ef62ddb21e711b7c43f8c83</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=a128f9557e9db7951a9d8d6467e553fdccb8a0f5">16553</a></td></tr>
<tr><td>push user</td><td>mkmelin@iki.fi</td></tr>
<tr><td>push date</td><td class="date age">Sun, 13 Oct 2019 18:44:18 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@a128f9557e9d [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a128f9557e9db7951a9d8d6467e553fdccb8a0f5">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a128f9557e9db7951a9d8d6467e553fdccb8a0f5&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a128f9557e9db7951a9d8d6467e553fdccb8a0f5&newProject=comm-central&newRevision=f183f40dfbce173c852f63662eca4cdcfea7c1c7&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a128f9557e9db7951a9d8d6467e553fdccb8a0f5&newProject=comm-central&newRevision=f183f40dfbce173c852f63662eca4cdcfea7c1c7&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a128f9557e9db7951a9d8d6467e553fdccb8a0f5&newProject=comm-central&newRevision=f183f40dfbce173c852f63662eca4cdcfea7c1c7&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28pmorris%29&revcount=50">pmorris</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1570954">1570954</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1479125">1479125</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1570954">Bug 1570954</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1479125">bug 1479125</a> to Thunderbird: Rewrite callers firstChild/lastChild/childNodes/previousSibling/nextSibling with firstElementChild/lastElementChild/children/previousElementSibling/nextElementSibling. r=pmorris

This allows the JS to work in HTML documents, where whitespace is preserved. In XUL
documents, whitespace is ignored when parsing so text nodes are generally not returned.

The following changes were made, with manual cleanups as necessary (i.e. when firstChild actually refers to a text node, or when firstChild is used in a loop to empty out an element):

firstChild-&gt;firstElementChild
lastChild-&gt;lastElementChild
nextSibling-&gt;nextElementSibling
previousSibling-&gt;previousElementSibling
childNodes-&gt;children

 # firstChild -&gt; firstElementChild
grep -rl '\bfirstChild\b' --exclude-dir=.hg --exclude-dir=suite --exclude-dir=editor . | xargs sed -i 's/\bfirstChild\b/firstElementChild/g'

 # lastChild-&gt;lastElementChild
grep -rl '\lastChild\b' --exclude-dir=.hg --exclude-dir=suite --exclude-dir=editor . | xargs sed -i 's/\blastChild\b/lastElementChild/g'

 # nextSibling-&gt;nextElementSibling
grep -rl '\nextSibling\b' --exclude-dir=.hg --exclude-dir=suite --exclude-dir=editor . | xargs sed -i 's/\bnextSibling\b/nextElementSibling/g'

 # previousSibling-&gt;previousElementSibling
grep -rl '\previousSibling\b' --exclude-dir=.hg --exclude-dir=suite --exclude-dir=editor . | xargs sed -i 's/\bpreviousSibling\b/previousElementSibling/g'

 # childNodes-&gt;children
grep -rl '\childNodes\b' --exclude-dir=.hg --exclude-dir=suite --exclude-dir=editor . | xargs sed -i 's/\bchildNodes\b/children/g'

 # revert for clearning out. lastElementChild.remove() -&gt; lastChild.remove()
grep -rl '\lastElementChild.remove\b' --exclude-dir=.hg --exclude-dir=suite --exclude-dir=editor . | xargs sed -i 's/\lastElementChild.remove\b/lastChild.remove/g'

 # skip matches in cpp and other wrong changes
hg revert mailnews/base/src/nsSubscribableServer.cpp
hg revert mailnews/base/src/nsSubscribableServer.h
hg revert mailnews/mime/src/mimemsig.cpp
hg revert mail/test/mozmill/composition/test-signature-updating.js
hg revert mail/test/mozmill/shared-modules/DOMHelpers.jsm
hg revert mailnews/addrbook/jsaddrbook/AddrBookMailingList.jsm
hg revert mailnews/addrbook/public/nsIAbDirectory.idl
hg revert mailnews/addrbook/test/unit/test_basic_nsIAbDirectory.js
hg revert mailnews/addrbook/test/unit/test_jsaddrbook.js
hg revert mailnews/addrbook/test/unit/test_mailList1.js
hg revert mailnews/addrbook/test/unit/test_uid.js
hg revert mailnews/compose/src/nsMsgCompose.cpp
hg revert mail/test/mozmill/cloudfile/test-cloudfile-attachment-urls.js
hg revert mail/test/mozmill/composition/test-forward-headers.js

hg revert calendar/import-export/calHtmlExport.js
hg revert mail/components/compose/content/cloudAttachmentLinkManager.js
hg revert mail/components/compose/content/dialogs/EdConvertToTable.js
hg revert mail/components/compose/content/dialogs/EdDialogCommon.js
hg revert mail/components/compose/content/dialogs/EdInsertTOC.js
hg revert mail/components/customizableui/CustomizeMode.jsm
hg revert mail/components/customizableui/PanelMultiView.jsm
hg revert mail/test/mozmill/shared-modules/ComposeHelpers.jsm
hg revert mailnews/addrbook/jsaddrbook/AddrBookDirectory.jsm
hg revert mailnews/base/util/JXON.js
hg revert mailnews/base/util/errUtils.js
hg revert mailnews/extensions/newsblog/content/feed-parser.js

hg revert mail/components/compose/texzilla/TeXZilla.js

../mach eslint --fix</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/agenda-listbox-utils.js">calendar/base/content/agenda-listbox-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/agenda-listbox-utils.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/agenda-listbox-utils.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/agenda-listbox-utils.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/agenda-listbox-utils.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/agenda-listbox-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-base-view.js">calendar/base/content/calendar-base-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-base-view.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-base-view.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-base-view.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-base-view.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-base-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-event-column.js">calendar/base/content/calendar-event-column.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-event-column.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-event-column.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-event-column.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-event-column.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-event-column.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-management.js">calendar/base/content/calendar-management.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-management.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-management.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-management.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-management.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-management.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-month-base-view.js">calendar/base/content/calendar-month-base-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-month-base-view.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-month-base-view.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-month-base-view.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-month-base-view.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-month-base-view.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-multiday-base-view.js">calendar/base/content/calendar-multiday-base-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-multiday-base-view.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-multiday-base-view.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-multiday-base-view.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-multiday-base-view.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-multiday-base-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-tree-utils.js">calendar/base/content/calendar-task-tree-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-tree-utils.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-tree-utils.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-tree-utils.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-tree-utils.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-tree-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-view.js">calendar/base/content/calendar-task-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-view.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-view.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-view.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-view.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-task-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-ui-utils.js">calendar/base/content/calendar-ui-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-ui-utils.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-ui-utils.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-ui-utils.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-ui-utils.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-ui-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-views-utils.js">calendar/base/content/calendar-views-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-views-utils.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-views-utils.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-views-utils.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-views-utils.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/calendar-views-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-alarm-dialog.js">calendar/base/content/dialogs/calendar-alarm-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-alarm-dialog.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-alarm-dialog.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-alarm-dialog.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-alarm-dialog.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-alarm-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-dialog-utils.js">calendar/base/content/dialogs/calendar-dialog-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-dialog-utils.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-dialog-utils.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-dialog-utils.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-dialog-utils.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-dialog-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees-custom-elements.js">calendar/base/content/dialogs/calendar-event-dialog-attendees-custom-elements.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees-custom-elements.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees-custom-elements.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees-custom-elements.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees-custom-elements.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees-custom-elements.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">calendar/base/content/dialogs/calendar-event-dialog-attendees.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">calendar/base/content/dialogs/calendar-event-dialog-reminder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-timezone.js">calendar/base/content/dialogs/calendar-event-dialog-timezone.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-timezone.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-timezone.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-timezone.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-timezone.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-event-dialog-timezone.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-migration-dialog.js">calendar/base/content/dialogs/calendar-migration-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-migration-dialog.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-migration-dialog.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-migration-dialog.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-migration-dialog.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-migration-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-properties-dialog.js">calendar/base/content/dialogs/calendar-properties-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-properties-dialog.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-properties-dialog.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-properties-dialog.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-properties-dialog.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-properties-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-summary-dialog.js">calendar/base/content/dialogs/calendar-summary-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-summary-dialog.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-summary-dialog.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-summary-dialog.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-summary-dialog.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/dialogs/calendar-summary-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/categories.js">calendar/base/content/preferences/categories.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/categories.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/categories.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/categories.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/categories.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/categories.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/views.js">calendar/base/content/preferences/views.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/views.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/views.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/views.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/views.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/preferences/views.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.js">calendar/base/content/today-pane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.xul">calendar/base/content/today-pane.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.xul">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.xul">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.xul">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.xul">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/today-pane.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-dnd-widgets.js">calendar/base/content/widgets/calendar-dnd-widgets.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-dnd-widgets.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-dnd-widgets.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-dnd-widgets.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-dnd-widgets.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-dnd-widgets.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-minimonth.js">calendar/base/content/widgets/calendar-minimonth.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-minimonth.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-minimonth.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-minimonth.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-minimonth.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/content/widgets/calendar-minimonth.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calAlarmUtils.jsm">calendar/base/modules/utils/calAlarmUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calAlarmUtils.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calAlarmUtils.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calAlarmUtils.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calAlarmUtils.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calAlarmUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calDataUtils.jsm">calendar/base/modules/utils/calDataUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calDataUtils.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calDataUtils.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calDataUtils.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calDataUtils.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calDataUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calViewUtils.jsm">calendar/base/modules/utils/calViewUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calViewUtils.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calViewUtils.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calViewUtils.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calViewUtils.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/base/modules/utils/calViewUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-iframe.js">calendar/lightning/content/lightning-item-iframe.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-iframe.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-iframe.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-iframe.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-iframe.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-iframe.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-panel.js">calendar/lightning/content/lightning-item-panel.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-panel.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-panel.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-panel.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-panel.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/lightning-item-panel.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/messenger-overlay-sidebar.js">calendar/lightning/content/messenger-overlay-sidebar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/messenger-overlay-sidebar.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/messenger-overlay-sidebar.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/messenger-overlay-sidebar.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/messenger-overlay-sidebar.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/content/messenger-overlay-sidebar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/modules/ltnInvitationUtils.jsm">calendar/lightning/modules/ltnInvitationUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/modules/ltnInvitationUtils.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/modules/ltnInvitationUtils.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/modules/ltnInvitationUtils.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/modules/ltnInvitationUtils.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/lightning/modules/ltnInvitationUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/resources/content/datetimepickers/datetimepickers.js">calendar/resources/content/datetimepickers/datetimepickers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/resources/content/datetimepickers/datetimepickers.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/resources/content/datetimepickers/datetimepickers.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/resources/content/datetimepickers/datetimepickers.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/resources/content/datetimepickers/datetimepickers.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/resources/content/datetimepickers/datetimepickers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/modules/ItemEditingHelpers.jsm">calendar/test/modules/ItemEditingHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/modules/ItemEditingHelpers.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/modules/ItemEditingHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/modules/ItemEditingHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/modules/ItemEditingHelpers.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/modules/ItemEditingHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/unit/test_alarmutils.js">calendar/test/unit/test_alarmutils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/unit/test_alarmutils.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/unit/test_alarmutils.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/unit/test_alarmutils.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/unit/test_alarmutils.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/calendar/test/unit/test_alarmutils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/chat-tooltip.js">chat/content/chat-tooltip.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/chat-tooltip.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/chat-tooltip.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/chat-tooltip.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/chat-tooltip.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/chat-tooltip.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/conversation-browser.js">chat/content/conversation-browser.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/conversation-browser.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/conversation-browser.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/conversation-browser.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/conversation-browser.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/conversation-browser.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/otr-auth.js">chat/content/otr-auth.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/otr-auth.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/otr-auth.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/otr-auth.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/otr-auth.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/content/otr-auth.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imContentSink.jsm">chat/modules/imContentSink.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imContentSink.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imContentSink.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imContentSink.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imContentSink.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imContentSink.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imThemes.jsm">chat/modules/imThemes.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imThemes.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imThemes.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imThemes.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imThemes.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/chat/modules/imThemes.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/bindings/customizable-toolbar.js">common/bindings/customizable-toolbar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/bindings/customizable-toolbar.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/bindings/customizable-toolbar.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/bindings/customizable-toolbar.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/bindings/customizable-toolbar.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/bindings/customizable-toolbar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/Overlays.jsm">common/src/Overlays.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/Overlays.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/Overlays.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/Overlays.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/Overlays.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/Overlays.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/customizeToolbar.js">common/src/customizeToolbar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/customizeToolbar.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/customizeToolbar.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/customizeToolbar.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/customizeToolbar.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/customizeToolbar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/viewSource.js">common/src/viewSource.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/viewSource.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/viewSource.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/viewSource.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/viewSource.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/common/src/viewSource.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/ABSearchDialog.js">mail/base/content/ABSearchDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/ABSearchDialog.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/ABSearchDialog.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/ABSearchDialog.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/ABSearchDialog.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/ABSearchDialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/FilterListDialog.js">mail/base/content/FilterListDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/FilterListDialog.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/FilterListDialog.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/FilterListDialog.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/FilterListDialog.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/FilterListDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/SearchDialog.js">mail/base/content/SearchDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/SearchDialog.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/SearchDialog.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/SearchDialog.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/SearchDialog.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/SearchDialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/folderPane.js">mail/base/content/folderPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/folderPane.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/folderPane.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/folderPane.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/folderPane.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/folderPane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/glodaFacetTab.js">mail/base/content/glodaFacetTab.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/glodaFacetTab.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/glodaFacetTab.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/glodaFacetTab.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/glodaFacetTab.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/glodaFacetTab.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailContextMenus.js">mail/base/content/mailContextMenus.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailContextMenus.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailContextMenus.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailContextMenus.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailContextMenus.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailContextMenus.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailCore.js">mail/base/content/mailCore.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailCore.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailCore.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailCore.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailCore.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailCore.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWidgets.js">mail/base/content/mailWidgets.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWidgets.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWidgets.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWidgets.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWidgets.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWidgets.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWindowOverlay.js">mail/base/content/mailWindowOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWindowOverlay.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWindowOverlay.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWindowOverlay.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWindowOverlay.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/mailWindowOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgHdrView.js">mail/base/content/msgHdrView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgHdrView.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgHdrView.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgHdrView.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgHdrView.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgHdrView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgMail3PaneWindow.js">mail/base/content/msgMail3PaneWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgMail3PaneWindow.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgMail3PaneWindow.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgMail3PaneWindow.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgMail3PaneWindow.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/msgMail3PaneWindow.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/nsContextMenu.js">mail/base/content/nsContextMenu.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/nsContextMenu.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/nsContextMenu.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/nsContextMenu.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/nsContextMenu.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/nsContextMenu.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/protovis-r2.6-modded.js">mail/base/content/protovis-r2.6-modded.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/protovis-r2.6-modded.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/protovis-r2.6-modded.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/protovis-r2.6-modded.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/protovis-r2.6-modded.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/protovis-r2.6-modded.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/specialTabs.js">mail/base/content/specialTabs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/specialTabs.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/specialTabs.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/specialTabs.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/specialTabs.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/specialTabs.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail-tabs.js">mail/base/content/tabmail-tabs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail-tabs.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail-tabs.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail-tabs.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail-tabs.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail-tabs.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail.js">mail/base/content/tabmail.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/tabmail.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/threadPane.js">mail/base/content/threadPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/threadPane.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/threadPane.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/threadPane.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/threadPane.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/threadPane.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/utilityOverlay.js">mail/base/content/utilityOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/utilityOverlay.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/utilityOverlay.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/utilityOverlay.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/utilityOverlay.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/content/utilityOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/ExtensionsUI.jsm">mail/base/modules/ExtensionsUI.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/ExtensionsUI.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/ExtensionsUI.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/ExtensionsUI.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/ExtensionsUI.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/ExtensionsUI.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/QuickFilterManager.jsm">mail/base/modules/QuickFilterManager.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/QuickFilterManager.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/QuickFilterManager.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/QuickFilterManager.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/QuickFilterManager.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/base/modules/QuickFilterManager.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/accounts.js">mail/components/about-support/content/accounts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/accounts.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/accounts.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/accounts.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/accounts.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/accounts.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/export.js">mail/components/about-support/content/export.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/export.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/export.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/export.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/export.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/about-support/content/export.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/accountcreation/content/emailWizard.js">mail/components/accountcreation/content/emailWizard.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/accountcreation/content/emailWizard.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/accountcreation/content/emailWizard.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/accountcreation/content/emailWizard.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/accountcreation/content/emailWizard.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/accountcreation/content/emailWizard.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/activity/content/activity.js">mail/components/activity/content/activity.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/activity/content/activity.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/activity/content/activity.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/activity/content/activity.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/activity/content/activity.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/activity/content/activity.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/abCardView.js">mail/components/addrbook/content/abCardView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/abCardView.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/abCardView.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/abCardView.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/abCardView.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/abCardView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/addressbook.xul">mail/components/addrbook/content/addressbook.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/addressbook.xul">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/addressbook.xul">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/addressbook.xul">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/addressbook.xul">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/addressbook.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/menulist-addrbooks.js">mail/components/addrbook/content/menulist-addrbooks.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/menulist-addrbooks.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/menulist-addrbooks.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/menulist-addrbooks.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/menulist-addrbooks.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/addrbook/content/menulist-addrbooks.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/ComposerCommands.js">mail/components/compose/content/ComposerCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/ComposerCommands.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/ComposerCommands.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/ComposerCommands.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/ComposerCommands.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/ComposerCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/MsgComposeCommands.js">mail/components/compose/content/MsgComposeCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/MsgComposeCommands.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/MsgComposeCommands.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/MsgComposeCommands.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/MsgComposeCommands.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/MsgComposeCommands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/addressingWidgetOverlay.js">mail/components/compose/content/addressingWidgetOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/addressingWidgetOverlay.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/addressingWidgetOverlay.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/addressingWidgetOverlay.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/addressingWidgetOverlay.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/addressingWidgetOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAECSSAttributes.js">mail/components/compose/content/dialogs/EdAECSSAttributes.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAECSSAttributes.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAECSSAttributes.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAECSSAttributes.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAECSSAttributes.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAECSSAttributes.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEHTMLAttributes.js">mail/components/compose/content/dialogs/EdAEHTMLAttributes.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEHTMLAttributes.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEHTMLAttributes.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEHTMLAttributes.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEHTMLAttributes.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEHTMLAttributes.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEJSEAttributes.js">mail/components/compose/content/dialogs/EdAEJSEAttributes.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEJSEAttributes.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEJSEAttributes.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEJSEAttributes.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEJSEAttributes.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAEJSEAttributes.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAdvancedEdit.js">mail/components/compose/content/dialogs/EdAdvancedEdit.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAdvancedEdit.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAdvancedEdit.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAdvancedEdit.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAdvancedEdit.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdAdvancedEdit.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdDialogCommon.js">mail/components/compose/content/dialogs/EdDialogCommon.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdDialogCommon.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdDialogCommon.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdDialogCommon.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdDialogCommon.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdDialogCommon.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdImageDialog.js">mail/components/compose/content/dialogs/EdImageDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdImageDialog.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdImageDialog.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdImageDialog.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdImageDialog.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdImageDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertMath.js">mail/components/compose/content/dialogs/EdInsertMath.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertMath.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertMath.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertMath.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertMath.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertMath.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertTable.js">mail/components/compose/content/dialogs/EdInsertTable.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertTable.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertTable.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertTable.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertTable.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdInsertTable.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdLinkProps.js">mail/components/compose/content/dialogs/EdLinkProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdLinkProps.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdLinkProps.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdLinkProps.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdLinkProps.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdLinkProps.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdSpellCheck.js">mail/components/compose/content/dialogs/EdSpellCheck.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdSpellCheck.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdSpellCheck.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdSpellCheck.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdSpellCheck.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/dialogs/EdSpellCheck.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/editor.js">mail/components/compose/content/editor.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/editor.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/editor.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/editor.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/editor.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/compose/content/editor.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/CustomizableUI.jsm">mail/components/customizableui/CustomizableUI.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/CustomizableUI.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/CustomizableUI.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/CustomizableUI.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/CustomizableUI.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/CustomizableUI.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/content/panelUI.js">mail/components/customizableui/content/panelUI.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/content/panelUI.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/content/panelUI.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/content/panelUI.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/content/panelUI.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/customizableui/content/panelUI.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/downloads/content/aboutDownloads.js">mail/components/downloads/content/aboutDownloads.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/downloads/content/aboutDownloads.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/downloads/content/aboutDownloads.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/downloads/content/aboutDownloads.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/downloads/content/aboutDownloads.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/downloads/content/aboutDownloads.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/extensions/parent/ext-menus.js">mail/components/extensions/parent/ext-menus.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/extensions/parent/ext-menus.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/extensions/parent/ext-menus.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/extensions/parent/ext-menus.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/extensions/parent/ext-menus.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/extensions/parent/ext-menus.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-conversation.js">mail/components/im/content/chat-conversation.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-conversation.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-conversation.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-conversation.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-conversation.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-conversation.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-group.js">mail/components/im/content/chat-group.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-group.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-group.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-group.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-group.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-group.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-imconv.js">mail/components/im/content/chat-imconv.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-imconv.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-imconv.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-imconv.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-imconv.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-imconv.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-messenger.js">mail/components/im/content/chat-messenger.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-messenger.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-messenger.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-messenger.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-messenger.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/chat-messenger.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imAccounts.js">mail/components/im/content/imAccounts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imAccounts.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imAccounts.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imAccounts.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imAccounts.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imAccounts.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imContextMenu.js">mail/components/im/content/imContextMenu.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imContextMenu.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imContextMenu.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imContextMenu.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imContextMenu.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/content/imContextMenu.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/messages/bubbles/Footer.html">mail/components/im/messages/bubbles/Footer.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/messages/bubbles/Footer.html">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/messages/bubbles/Footer.html">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/messages/bubbles/Footer.html">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/messages/bubbles/Footer.html">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/im/messages/bubbles/Footer.html">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/migration/content/migration.js">mail/components/migration/content/migration.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/migration/content/migration.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/migration/content/migration.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/migration/content/migration.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/migration/content/migration.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/migration/content/migration.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/applicationManager.js">mail/components/preferences/applicationManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/applicationManager.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/applicationManager.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/applicationManager.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/applicationManager.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/applicationManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/general.js">mail/components/preferences/general.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/general.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/general.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/general.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/general.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/general.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/permissions.js">mail/components/preferences/permissions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/permissions.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/permissions.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/permissions.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/permissions.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/permissions.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/preferencesTab.js">mail/components/preferences/preferencesTab.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/preferencesTab.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/preferencesTab.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/preferencesTab.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/preferencesTab.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/preferencesTab.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/sendoptions.js">mail/components/preferences/sendoptions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/sendoptions.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/sendoptions.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/sendoptions.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/sendoptions.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/components/preferences/sendoptions.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-ab-whitelist.js">mail/test/mozmill/account/test-ab-whitelist.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-ab-whitelist.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-ab-whitelist.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-ab-whitelist.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-ab-whitelist.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-ab-whitelist.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-account-tree.js">mail/test/mozmill/account/test-account-tree.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-account-tree.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-account-tree.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-account-tree.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-account-tree.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/account/test-account-tree.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/attachment/test-attachment.js">mail/test/mozmill/attachment/test-attachment.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/attachment/test-attachment.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/attachment/test-attachment.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/attachment/test-attachment.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/attachment/test-attachment.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/attachment/test-attachment.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-image-display.js">mail/test/mozmill/composition/test-image-display.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-image-display.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-image-display.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-image-display.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-image-display.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-image-display.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-reply-addresses.js">mail/test/mozmill/composition/test-reply-addresses.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-reply-addresses.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-reply-addresses.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-reply-addresses.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-reply-addresses.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/composition/test-reply-addresses.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/content-tabs/test-content-tab.js">mail/test/mozmill/content-tabs/test-content-tab.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/content-tabs/test-content-tab.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/content-tabs/test-content-tab.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/content-tabs/test-content-tab.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/content-tabs/test-content-tab.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/content-tabs/test-content-tab.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/downloads/test-about-downloads.js">mail/test/mozmill/downloads/test-about-downloads.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/downloads/test-about-downloads.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/downloads/test-about-downloads.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/downloads/test-about-downloads.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/downloads/test-about-downloads.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/downloads/test-about-downloads.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-display/test-mail-views.js">mail/test/mozmill/folder-display/test-mail-views.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-display/test-mail-views.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-display/test-mail-views.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-display/test-mail-views.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-display/test-mail-views.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-display/test-mail-views.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-widget/test-message-filters.js">mail/test/mozmill/folder-widget/test-message-filters.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-widget/test-message-filters.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-widget/test-message-filters.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-widget/test-message-filters.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-widget/test-message-filters.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/folder-widget/test-message-filters.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/message-window/test-commands.js">mail/test/mozmill/message-window/test-commands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/message-window/test-commands.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/message-window/test-commands.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/message-window/test-commands.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/message-window/test-commands.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/message-window/test-commands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/search-window/test-search-window.js">mail/test/mozmill/search-window/test-search-window.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/search-window/test-search-window.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/search-window/test-search-window.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/search-window/test-search-window.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/search-window/test-search-window.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/search-window/test-search-window.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/tabmail/test-tabmail-customize.js">mail/test/mozmill/tabmail/test-tabmail-customize.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/tabmail/test-tabmail-customize.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/tabmail/test-tabmail-customize.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/tabmail/test-tabmail-customize.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/tabmail/test-tabmail-customize.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/mozmill/tabmail/test-tabmail-customize.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/controller.jsm">mail/test/resources/mozmill/mozmill/extension/content/modules/controller.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/controller.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/controller.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/controller.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/controller.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/controller.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/elementslib.jsm">mail/test/resources/mozmill/mozmill/extension/content/modules/elementslib.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/elementslib.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/elementslib.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/elementslib.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/elementslib.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mail/test/resources/mozmill/mozmill/extension/content/modules/elementslib.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/addrbook/content/abResultsPane.js">mailnews/addrbook/content/abResultsPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/addrbook/content/abResultsPane.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/addrbook/content/abResultsPane.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/addrbook/content/abResultsPane.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/addrbook/content/abResultsPane.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/addrbook/content/abResultsPane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/content/folder-menupopup.js">mailnews/base/content/folder-menupopup.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/content/folder-menupopup.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/content/folder-menupopup.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/content/folder-menupopup.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/content/folder-menupopup.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/content/folder-menupopup.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/AccountManager.js">mailnews/base/prefs/content/AccountManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/AccountManager.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/AccountManager.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/AccountManager.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/AccountManager.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/AccountManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-addressing.js">mailnews/base/prefs/content/am-addressing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-addressing.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-addressing.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-addressing.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-addressing.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-addressing.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-junk.js">mailnews/base/prefs/content/am-junk.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-junk.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-junk.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-junk.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-junk.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/am-junk.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-identity.js">mailnews/base/prefs/content/aw-identity.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-identity.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-identity.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-identity.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-identity.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-identity.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-outgoing.js">mailnews/base/prefs/content/aw-outgoing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-outgoing.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-outgoing.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-outgoing.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-outgoing.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/prefs/content/aw-outgoing.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/FilterEditor.js">mailnews/base/search/content/FilterEditor.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/FilterEditor.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/FilterEditor.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/FilterEditor.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/FilterEditor.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/FilterEditor.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchTerm.js">mailnews/base/search/content/searchTerm.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchTerm.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchTerm.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchTerm.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchTerm.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchTerm.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchWidgets.js">mailnews/base/search/content/searchWidgets.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchWidgets.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchWidgets.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchWidgets.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchWidgets.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/search/content/searchWidgets.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/test/unit/test_iteratorUtils.js">mailnews/base/test/unit/test_iteratorUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/test/unit/test_iteratorUtils.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/test/unit/test_iteratorUtils.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/test/unit/test_iteratorUtils.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/test/unit/test_iteratorUtils.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/test/unit/test_iteratorUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/util/iteratorUtils.jsm">mailnews/base/util/iteratorUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/util/iteratorUtils.jsm">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/util/iteratorUtils.jsm">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/util/iteratorUtils.jsm">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/util/iteratorUtils.jsm">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/base/util/iteratorUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/db/gloda/content/autocomplete-richlistitem.js">mailnews/db/gloda/content/autocomplete-richlistitem.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/db/gloda/content/autocomplete-richlistitem.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/db/gloda/content/autocomplete-richlistitem.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/db/gloda/content/autocomplete-richlistitem.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/db/gloda/content/autocomplete-richlistitem.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/db/gloda/content/autocomplete-richlistitem.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/extensions/smime/content/msgReadSecurityInfo.js">mailnews/extensions/smime/content/msgReadSecurityInfo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/extensions/smime/content/msgReadSecurityInfo.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/extensions/smime/content/msgReadSecurityInfo.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/extensions/smime/content/msgReadSecurityInfo.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/extensions/smime/content/msgReadSecurityInfo.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/extensions/smime/content/msgReadSecurityInfo.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/fieldMapImport.js">mailnews/import/content/fieldMapImport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/fieldMapImport.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/fieldMapImport.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/fieldMapImport.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/fieldMapImport.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/fieldMapImport.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/importDialog.js">mailnews/import/content/importDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/importDialog.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/importDialog.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/importDialog.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/importDialog.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/import/content/importDialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/news/content/downloadheaders.js">mailnews/news/content/downloadheaders.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/news/content/downloadheaders.js">file</a> |
<a href="/comm-central/annotate/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/news/content/downloadheaders.js">annotate</a> |
<a href="/comm-central/diff/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/news/content/downloadheaders.js">diff</a> |
<a href="/comm-central/comparison/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/news/content/downloadheaders.js">comparison</a> |
<a href="/comm-central/log/a128f9557e9db7951a9d8d6467e553fdccb8a0f5/mailnews/news/content/downloadheaders.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/agenda-listbox-utils.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/agenda-listbox-utils.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -134,22 +134,22 @@ agendaListbox.onCheckboxChange = functio</span>
<a href="#l1.4"></a><span id="l1.4">   // as the agenda-checkboxes are only transient we have to set the &quot;checked&quot;</span>
<a href="#l1.5"></a><span id="l1.5">   // attribute at their hidden origins to make that attribute persistent.</span>
<a href="#l1.6"></a><span id="l1.6">   document</span>
<a href="#l1.7"></a><span id="l1.7">     .getElementById(listItem.id)</span>
<a href="#l1.8"></a><span id="l1.8">     .setAttribute(&quot;checked&quot;, periodCheckbox.getAttribute(&quot;checked&quot;));</span>
<a href="#l1.9"></a><span id="l1.9">   if (lopen) {</span>
<a href="#l1.10"></a><span id="l1.10">     agendaListbox.refreshCalendarQuery(period.start, period.end);</span>
<a href="#l1.11"></a><span id="l1.11">   } else {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    listItem = listItem.nextSibling;</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    listItem = listItem.nextElementSibling;</span>
<a href="#l1.14"></a><span id="l1.14">     let leaveloop;</span>
<a href="#l1.15"></a><span id="l1.15">     do {</span>
<a href="#l1.16"></a><span id="l1.16">       leaveloop = listItem == null;</span>
<a href="#l1.17"></a><span id="l1.17">       if (!leaveloop) {</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-        let nextItemSibling = listItem.nextSibling;</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineplus">+        let nextItemSibling = listItem.nextElementSibling;</span>
<a href="#l1.20"></a><span id="l1.20">         leaveloop = !agendaListbox.isEventListItem(listItem);</span>
<a href="#l1.21"></a><span id="l1.21">         if (!leaveloop) {</span>
<a href="#l1.22"></a><span id="l1.22">           listItem.remove();</span>
<a href="#l1.23"></a><span id="l1.23">           listItem = nextItemSibling;</span>
<a href="#l1.24"></a><span id="l1.24">         }</span>
<a href="#l1.25"></a><span id="l1.25">       }</span>
<a href="#l1.26"></a><span id="l1.26">     } while (!leaveloop);</span>
<a href="#l1.27"></a><span id="l1.27">   }</span>
<a href="#l1.28"></a><span id="l1.28" class="difflineat">@@ -317,21 +317,21 @@ agendaListbox.addItem = function(aItem) </span>
<a href="#l1.29"></a><span id="l1.29">   }</span>
<a href="#l1.30"></a><span id="l1.30">   let newlistItem = null;</span>
<a href="#l1.31"></a><span id="l1.31">   for (let i = 0; i &lt; periods.length; i++) {</span>
<a href="#l1.32"></a><span id="l1.32">     let period = periods[i];</span>
<a href="#l1.33"></a><span id="l1.33">     let complistItem = period.listItem;</span>
<a href="#l1.34"></a><span id="l1.34">     let visible = complistItem.getCheckbox().checked;</span>
<a href="#l1.35"></a><span id="l1.35">     if (aItem.startDate.isDate &amp;&amp; period.duration == 1 &amp;&amp; aItem.duration.days == 1) {</span>
<a href="#l1.36"></a><span id="l1.36">       if (this.getListItems(aItem, period).length == 0) {</span>
<a href="#l1.37"></a><span id="l1.37" class="difflineminus">-        this.addItemBefore(aItem, period.listItem.nextSibling, period, visible);</span>
<a href="#l1.38"></a><span id="l1.38" class="difflineplus">+        this.addItemBefore(aItem, period.listItem.nextElementSibling, period, visible);</span>
<a href="#l1.39"></a><span id="l1.39">       }</span>
<a href="#l1.40"></a><span id="l1.40">     } else {</span>
<a href="#l1.41"></a><span id="l1.41">       do {</span>
<a href="#l1.42"></a><span id="l1.42" class="difflineminus">-        complistItem = complistItem.nextSibling;</span>
<a href="#l1.43"></a><span id="l1.43" class="difflineplus">+        complistItem = complistItem.nextElementSibling;</span>
<a href="#l1.44"></a><span id="l1.44">         if (this.isEventListItem(complistItem)) {</span>
<a href="#l1.45"></a><span id="l1.45">           let compitem = complistItem.occurrence;</span>
<a href="#l1.46"></a><span id="l1.46">           if (this.isSameEvent(aItem, compitem)) {</span>
<a href="#l1.47"></a><span id="l1.47">             // The same event occurs on several calendars but we only</span>
<a href="#l1.48"></a><span id="l1.48">             // display the first one.</span>
<a href="#l1.49"></a><span id="l1.49">             // TODO: find a way to display this special circumstance</span>
<a href="#l1.50"></a><span id="l1.50">             break;</span>
<a href="#l1.51"></a><span id="l1.51">           } else if (this.isBefore(aItem, compitem, period)) {</span>
<a href="#l1.52"></a><span id="l1.52" class="difflineat">@@ -458,17 +458,17 @@ agendaListbox.getListItems = function(aI</span>
<a href="#l1.53"></a><span id="l1.53">     periods = this.findPeriodsForItem(aItem);</span>
<a href="#l1.54"></a><span id="l1.54">   }</span>
<a href="#l1.55"></a><span id="l1.55">   if (periods.length &gt; 0) {</span>
<a href="#l1.56"></a><span id="l1.56">     for (let i = 0; i &lt; periods.length; i++) {</span>
<a href="#l1.57"></a><span id="l1.57">       let period = periods[i];</span>
<a href="#l1.58"></a><span id="l1.58">       let complistItem = period.listItem;</span>
<a href="#l1.59"></a><span id="l1.59">       let leaveloop;</span>
<a href="#l1.60"></a><span id="l1.60">       do {</span>
<a href="#l1.61"></a><span id="l1.61" class="difflineminus">-        complistItem = complistItem.nextSibling;</span>
<a href="#l1.62"></a><span id="l1.62" class="difflineplus">+        complistItem = complistItem.nextElementSibling;</span>
<a href="#l1.63"></a><span id="l1.63">         leaveloop = !this.isEventListItem(complistItem);</span>
<a href="#l1.64"></a><span id="l1.64">         if (!leaveloop) {</span>
<a href="#l1.65"></a><span id="l1.65">           if (this.isSameEvent(aItem, complistItem.occurrence)) {</span>
<a href="#l1.66"></a><span id="l1.66">             retlistItems.push(complistItem);</span>
<a href="#l1.67"></a><span id="l1.67">             break;</span>
<a href="#l1.68"></a><span id="l1.68">           }</span>
<a href="#l1.69"></a><span id="l1.69">         }</span>
<a href="#l1.70"></a><span id="l1.70">       } while (!leaveloop);</span>
<a href="#l1.71"></a><span id="l1.71" class="difflineat">@@ -505,18 +505,18 @@ agendaListbox.deleteItem = function(aIte</span>
<a href="#l1.72"></a><span id="l1.72"> };</span>
<a href="#l1.73"></a><span id="l1.73"> </span>
<a href="#l1.74"></a><span id="l1.74"> /**</span>
<a href="#l1.75"></a><span id="l1.75">  * Remove all items belonging to the specified calendar.</span>
<a href="#l1.76"></a><span id="l1.76">  *</span>
<a href="#l1.77"></a><span id="l1.77">  * @param aCalendar         The item to compare.</span>
<a href="#l1.78"></a><span id="l1.78">  */</span>
<a href="#l1.79"></a><span id="l1.79"> agendaListbox.deleteItemsFromCalendar = function(aCalendar) {</span>
<a href="#l1.80"></a><span id="l1.80" class="difflineminus">-  let childNodes = Array.from(this.agendaListboxControl.childNodes);</span>
<a href="#l1.81"></a><span id="l1.81" class="difflineminus">-  for (let childNode of childNodes) {</span>
<a href="#l1.82"></a><span id="l1.82" class="difflineplus">+  let children = Array.from(this.agendaListboxControl.children);</span>
<a href="#l1.83"></a><span id="l1.83" class="difflineplus">+  for (let childNode of children) {</span>
<a href="#l1.84"></a><span id="l1.84">     if (childNode &amp;&amp; childNode.occurrence &amp;&amp; childNode.occurrence.calendar.id == aCalendar.id) {</span>
<a href="#l1.85"></a><span id="l1.85">       childNode.remove();</span>
<a href="#l1.86"></a><span id="l1.86">     }</span>
<a href="#l1.87"></a><span id="l1.87">   }</span>
<a href="#l1.88"></a><span id="l1.88"> };</span>
<a href="#l1.89"></a><span id="l1.89"> </span>
<a href="#l1.90"></a><span id="l1.90"> /**</span>
<a href="#l1.91"></a><span id="l1.91">  * Compares two items to see if they have the same id and their start date</span>
<a href="#l1.92"></a><span id="l1.92" class="difflineat">@@ -586,17 +586,17 @@ agendaListbox.createNewEvent = function(</span>
<a href="#l1.93"></a><span id="l1.93"> /**</span>
<a href="#l1.94"></a><span id="l1.94">  * Sets up the context menu for the agenda listbox</span>
<a href="#l1.95"></a><span id="l1.95">  *</span>
<a href="#l1.96"></a><span id="l1.96">  * @param popup         The &lt;menupopup&gt; element to set up.</span>
<a href="#l1.97"></a><span id="l1.97">  */</span>
<a href="#l1.98"></a><span id="l1.98"> agendaListbox.setupContextMenu = function(popup) {</span>
<a href="#l1.99"></a><span id="l1.99">   let listItem = this.agendaListboxControl.selectedItem;</span>
<a href="#l1.100"></a><span id="l1.100">   let enabled = this.isEventListItem(listItem);</span>
<a href="#l1.101"></a><span id="l1.101" class="difflineminus">-  let menuitems = popup.childNodes;</span>
<a href="#l1.102"></a><span id="l1.102" class="difflineplus">+  let menuitems = popup.children;</span>
<a href="#l1.103"></a><span id="l1.103">   for (let i = 0; i &lt; menuitems.length; i++) {</span>
<a href="#l1.104"></a><span id="l1.104">     setBooleanAttribute(menuitems[i], &quot;disabled&quot;, !enabled);</span>
<a href="#l1.105"></a><span id="l1.105">   }</span>
<a href="#l1.106"></a><span id="l1.106"> </span>
<a href="#l1.107"></a><span id="l1.107">   let menu = document.getElementById(&quot;calendar-today-pane-menu-attendance-menu&quot;);</span>
<a href="#l1.108"></a><span id="l1.108">   setupAttendanceMenu(menu, agendaListbox.getSelectedItems({}));</span>
<a href="#l1.109"></a><span id="l1.109"> };</span>
<a href="#l1.110"></a><span id="l1.110"> </span>
<a href="#l1.111"></a><span id="l1.111" class="difflineat">@@ -764,17 +764,17 @@ agendaListbox.showsToday = function(aSta</span>
<a href="#l1.112"></a><span id="l1.112">   return lshowsToday;</span>
<a href="#l1.113"></a><span id="l1.113"> };</span>
<a href="#l1.114"></a><span id="l1.114"> </span>
<a href="#l1.115"></a><span id="l1.115"> /**</span>
<a href="#l1.116"></a><span id="l1.116">  * Moves the selection. Moves down unless the next item is a period item, in</span>
<a href="#l1.117"></a><span id="l1.117">  * which case the selection moves up.</span>
<a href="#l1.118"></a><span id="l1.118">  */</span>
<a href="#l1.119"></a><span id="l1.119"> agendaListbox.moveSelection = function() {</span>
<a href="#l1.120"></a><span id="l1.120" class="difflineminus">-  if (this.isEventListItem(this.agendaListboxControl.selectedItem.nextSibling)) {</span>
<a href="#l1.121"></a><span id="l1.121" class="difflineplus">+  if (this.isEventListItem(this.agendaListboxControl.selectedItem.nextElementSibling)) {</span>
<a href="#l1.122"></a><span id="l1.122">     this.agendaListboxControl.moveByOffset(-1);</span>
<a href="#l1.123"></a><span id="l1.123">   } else {</span>
<a href="#l1.124"></a><span id="l1.124">     this.agendaListboxControl.moveByOffset(1);</span>
<a href="#l1.125"></a><span id="l1.125">   }</span>
<a href="#l1.126"></a><span id="l1.126"> };</span>
<a href="#l1.127"></a><span id="l1.127"> </span>
<a href="#l1.128"></a><span id="l1.128"> /**</span>
<a href="#l1.129"></a><span id="l1.129">  * Gets an array of selected items. If a period node is selected, it is not</span>
<a href="#l1.130"></a><span id="l1.130" class="difflineat">@@ -807,53 +807,53 @@ agendaListbox.isEventListItem = function</span>
<a href="#l1.131"></a><span id="l1.131">   }</span>
<a href="#l1.132"></a><span id="l1.132">   return isListItem;</span>
<a href="#l1.133"></a><span id="l1.133"> };</span>
<a href="#l1.134"></a><span id="l1.134"> </span>
<a href="#l1.135"></a><span id="l1.135"> /**</span>
<a href="#l1.136"></a><span id="l1.136">  * Removes all Event items, keeping the period items intact.</span>
<a href="#l1.137"></a><span id="l1.137">  */</span>
<a href="#l1.138"></a><span id="l1.138"> agendaListbox.removeListItems = function() {</span>
<a href="#l1.139"></a><span id="l1.139" class="difflineminus">-  let listItem = this.agendaListboxControl.lastChild;</span>
<a href="#l1.140"></a><span id="l1.140" class="difflineplus">+  let listItem = this.agendaListboxControl.lastElementChild;</span>
<a href="#l1.141"></a><span id="l1.141">   if (listItem) {</span>
<a href="#l1.142"></a><span id="l1.142">     let leaveloop = false;</span>
<a href="#l1.143"></a><span id="l1.143">     do {</span>
<a href="#l1.144"></a><span id="l1.144">       let newlistItem = null;</span>
<a href="#l1.145"></a><span id="l1.145">       if (listItem) {</span>
<a href="#l1.146"></a><span id="l1.146" class="difflineminus">-        newlistItem = listItem.previousSibling;</span>
<a href="#l1.147"></a><span id="l1.147" class="difflineplus">+        newlistItem = listItem.previousElementSibling;</span>
<a href="#l1.148"></a><span id="l1.148">       } else {</span>
<a href="#l1.149"></a><span id="l1.149">         leaveloop = true;</span>
<a href="#l1.150"></a><span id="l1.150">       }</span>
<a href="#l1.151"></a><span id="l1.151">       if (this.isEventListItem(listItem)) {</span>
<a href="#l1.152"></a><span id="l1.152" class="difflineminus">-        if (listItem == this.agendaListboxControl.firstChild) {</span>
<a href="#l1.153"></a><span id="l1.153" class="difflineplus">+        if (listItem == this.agendaListboxControl.firstElementChild) {</span>
<a href="#l1.154"></a><span id="l1.154">           leaveloop = true;</span>
<a href="#l1.155"></a><span id="l1.155">         } else {</span>
<a href="#l1.156"></a><span id="l1.156">           listItem.remove();</span>
<a href="#l1.157"></a><span id="l1.157">         }</span>
<a href="#l1.158"></a><span id="l1.158">       }</span>
<a href="#l1.159"></a><span id="l1.159">       listItem = newlistItem;</span>
<a href="#l1.160"></a><span id="l1.160">     } while (!leaveloop);</span>
<a href="#l1.161"></a><span id="l1.161">   }</span>
<a href="#l1.162"></a><span id="l1.162"> };</span>
<a href="#l1.163"></a><span id="l1.163"> </span>
<a href="#l1.164"></a><span id="l1.164"> /**</span>
<a href="#l1.165"></a><span id="l1.165">  * Gets the list item node by its associated event's hashId.</span>
<a href="#l1.166"></a><span id="l1.166">  *</span>
<a href="#l1.167"></a><span id="l1.167">  * @return The XUL node if successful, otherwise null.</span>
<a href="#l1.168"></a><span id="l1.168">  */</span>
<a href="#l1.169"></a><span id="l1.169"> agendaListbox.getListItemByHashId = function(ahashId) {</span>
<a href="#l1.170"></a><span id="l1.170" class="difflineminus">-  let listItem = this.agendaListboxControl.firstChild;</span>
<a href="#l1.171"></a><span id="l1.171" class="difflineplus">+  let listItem = this.agendaListboxControl.firstElementChild;</span>
<a href="#l1.172"></a><span id="l1.172">   let leaveloop = false;</span>
<a href="#l1.173"></a><span id="l1.173">   do {</span>
<a href="#l1.174"></a><span id="l1.174">     if (this.isEventListItem(listItem)) {</span>
<a href="#l1.175"></a><span id="l1.175">       if (listItem.occurrence.hashId == ahashId) {</span>
<a href="#l1.176"></a><span id="l1.176">         return listItem;</span>
<a href="#l1.177"></a><span id="l1.177">       }</span>
<a href="#l1.178"></a><span id="l1.178">     }</span>
<a href="#l1.179"></a><span id="l1.179" class="difflineminus">-    listItem = listItem.nextSibling;</span>
<a href="#l1.180"></a><span id="l1.180" class="difflineplus">+    listItem = listItem.nextElementSibling;</span>
<a href="#l1.181"></a><span id="l1.181">     leaveloop = listItem == null;</span>
<a href="#l1.182"></a><span id="l1.182">   } while (!leaveloop);</span>
<a href="#l1.183"></a><span id="l1.183">   return null;</span>
<a href="#l1.184"></a><span id="l1.184"> };</span>
<a href="#l1.185"></a><span id="l1.185"> </span>
<a href="#l1.186"></a><span id="l1.186"> /**</span>
<a href="#l1.187"></a><span id="l1.187">  * The operation listener used for calendar queries.</span>
<a href="#l1.188"></a><span id="l1.188">  * Implements calIOperationListener.</span>
<a href="#l1.189"></a><span id="l1.189" class="difflineat">@@ -945,19 +945,19 @@ agendaListbox.calendarObserver.onError =</span>
<a href="#l1.190"></a><span id="l1.190"> </span>
<a href="#l1.191"></a><span id="l1.191"> agendaListbox.calendarObserver.onPropertyChanged = function(aCalendar, aName, aValue, aOldValue) {</span>
<a href="#l1.192"></a><span id="l1.192">   switch (aName) {</span>
<a href="#l1.193"></a><span id="l1.193">     case &quot;disabled&quot;:</span>
<a href="#l1.194"></a><span id="l1.194">       this.agendaListbox.refreshCalendarQuery();</span>
<a href="#l1.195"></a><span id="l1.195">       break;</span>
<a href="#l1.196"></a><span id="l1.196">     case &quot;color&quot;:</span>
<a href="#l1.197"></a><span id="l1.197">       for (</span>
<a href="#l1.198"></a><span id="l1.198" class="difflineminus">-        let node = agendaListbox.agendaListboxControl.firstChild;</span>
<a href="#l1.199"></a><span id="l1.199" class="difflineplus">+        let node = agendaListbox.agendaListboxControl.firstElementChild;</span>
<a href="#l1.200"></a><span id="l1.200">         node;</span>
<a href="#l1.201"></a><span id="l1.201" class="difflineminus">-        node = node.nextSibling</span>
<a href="#l1.202"></a><span id="l1.202" class="difflineplus">+        node = node.nextElementSibling</span>
<a href="#l1.203"></a><span id="l1.203">       ) {</span>
<a href="#l1.204"></a><span id="l1.204">         // Change color on all nodes that don't do so themselves, which</span>
<a href="#l1.205"></a><span id="l1.205">         // is currently only he agenda-richlist-item</span>
<a href="#l1.206"></a><span id="l1.206">         if (node.localName != &quot;agenda-richlist-item&quot;) {</span>
<a href="#l1.207"></a><span id="l1.207">           continue;</span>
<a href="#l1.208"></a><span id="l1.208">         }</span>
<a href="#l1.209"></a><span id="l1.209">         node.refreshColor();</span>
<a href="#l1.210"></a><span id="l1.210">       }</span>
<a href="#l1.211"></a><span id="l1.211" class="difflineat">@@ -1004,17 +1004,17 @@ agendaListbox.updateSoonSection = functi</span>
<a href="#l1.212"></a><span id="l1.212">  * @see scheduleNextCurrentEventUpdate</span>
<a href="#l1.213"></a><span id="l1.213">  */</span>
<a href="#l1.214"></a><span id="l1.214"> function setCurrentEvent() {</span>
<a href="#l1.215"></a><span id="l1.215">   if (!agendaListbox.showsToday() || !agendaListbox.today.open) {</span>
<a href="#l1.216"></a><span id="l1.216">     return;</span>
<a href="#l1.217"></a><span id="l1.217">   }</span>
<a href="#l1.218"></a><span id="l1.218"> </span>
<a href="#l1.219"></a><span id="l1.219">   let msScheduleTime = -1;</span>
<a href="#l1.220"></a><span id="l1.220" class="difflineminus">-  let complistItem = agendaListbox.tomorrow.listItem.previousSibling;</span>
<a href="#l1.221"></a><span id="l1.221" class="difflineplus">+  let complistItem = agendaListbox.tomorrow.listItem.previousElementSibling;</span>
<a href="#l1.222"></a><span id="l1.222">   let removelist = [];</span>
<a href="#l1.223"></a><span id="l1.223">   let anow = cal.dtz.now();</span>
<a href="#l1.224"></a><span id="l1.224">   let msuntillend = 0;</span>
<a href="#l1.225"></a><span id="l1.225">   let msuntillstart = 0;</span>
<a href="#l1.226"></a><span id="l1.226">   let leaveloop;</span>
<a href="#l1.227"></a><span id="l1.227">   do {</span>
<a href="#l1.228"></a><span id="l1.228">     leaveloop = !agendaListbox.isEventListItem(complistItem);</span>
<a href="#l1.229"></a><span id="l1.229">     if (!leaveloop) {</span>
<a href="#l1.230"></a><span id="l1.230" class="difflineat">@@ -1038,17 +1038,17 @@ function setCurrentEvent() {</span>
<a href="#l1.231"></a><span id="l1.231">       }</span>
<a href="#l1.232"></a><span id="l1.232">       if (msScheduleTime == -1 || msuntillstart &lt; msScheduleTime) {</span>
<a href="#l1.233"></a><span id="l1.233">         if (msuntillstart &gt; 0) {</span>
<a href="#l1.234"></a><span id="l1.234">           msScheduleTime = msuntillstart;</span>
<a href="#l1.235"></a><span id="l1.235">         }</span>
<a href="#l1.236"></a><span id="l1.236">       }</span>
<a href="#l1.237"></a><span id="l1.237">     }</span>
<a href="#l1.238"></a><span id="l1.238">     if (!leaveloop) {</span>
<a href="#l1.239"></a><span id="l1.239" class="difflineminus">-      complistItem = complistItem.previousSibling;</span>
<a href="#l1.240"></a><span id="l1.240" class="difflineplus">+      complistItem = complistItem.previousElementSibling;</span>
<a href="#l1.241"></a><span id="l1.241">     }</span>
<a href="#l1.242"></a><span id="l1.242">   } while (!leaveloop);</span>
<a href="#l1.243"></a><span id="l1.243"> </span>
<a href="#l1.244"></a><span id="l1.244">   if (msScheduleTime &gt; -1) {</span>
<a href="#l1.245"></a><span id="l1.245">     scheduleNextCurrentEventUpdate(setCurrentEvent, msScheduleTime * 1000);</span>
<a href="#l1.246"></a><span id="l1.246">   }</span>
<a href="#l1.247"></a><span id="l1.247"> </span>
<a href="#l1.248"></a><span id="l1.248">   if (removelist) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/calendar-base-view.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/calendar-base-view.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -722,17 +722,17 @@</span>
<a href="#l2.4"></a><span id="l2.4"> </span>
<a href="#l2.5"></a><span id="l2.5">     /**</span>
<a href="#l2.6"></a><span id="l2.6">      * Guarantee that the labels are clipped when an overflow occurs, to</span>
<a href="#l2.7"></a><span id="l2.7">      * prevent horizontal scrollbars from appearing briefly.</span>
<a href="#l2.8"></a><span id="l2.8">      *</span>
<a href="#l2.9"></a><span id="l2.9">      * @param {boolean} forceShortName  Whether to force the use of a short name.</span>
<a href="#l2.10"></a><span id="l2.10">      */</span>
<a href="#l2.11"></a><span id="l2.11">     adjustWeekdayLength(forceShortName) {</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-      const labelDayBoxKids = this.labeldaybox.childNodes;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+      const labelDayBoxKids = this.labeldaybox.children;</span>
<a href="#l2.14"></a><span id="l2.14">       let useShortNames = false;</span>
<a href="#l2.15"></a><span id="l2.15"> </span>
<a href="#l2.16"></a><span id="l2.16">       if (!labelDayBoxKids || !labelDayBoxKids[0] || forceShortName === true) {</span>
<a href="#l2.17"></a><span id="l2.17">         useShortNames = true;</span>
<a href="#l2.18"></a><span id="l2.18">       } else {</span>
<a href="#l2.19"></a><span id="l2.19">         const clientWidth = this.querySelector(&quot;.mainbox&quot;).clientWidth;</span>
<a href="#l2.20"></a><span id="l2.20">         const timespacer = this.querySelector(&quot;.headertimespacer&quot;);</span>
<a href="#l2.21"></a><span id="l2.21"> </span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -752,25 +752,25 @@</span>
<a href="#l2.23"></a><span id="l2.23">      * The width in pixels of the widest weekday label.</span>
<a href="#l2.24"></a><span id="l2.24">      *</span>
<a href="#l2.25"></a><span id="l2.25">      * @return {number}  A number of pixels.</span>
<a href="#l2.26"></a><span id="l2.26">      */</span>
<a href="#l2.27"></a><span id="l2.27">     get longWeekdayTotalPixels() {</span>
<a href="#l2.28"></a><span id="l2.28">       if (this.mLongWeekdayTotalPixels &lt;= 0) {</span>
<a href="#l2.29"></a><span id="l2.29">         let maxDayWidth = 0;</span>
<a href="#l2.30"></a><span id="l2.30"> </span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-        for (const label of this.labeldaybox.childNodes) {</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+        for (const label of this.labeldaybox.children) {</span>
<a href="#l2.33"></a><span id="l2.33">           if (label.localName == &quot;calendar-day-label&quot;) {</span>
<a href="#l2.34"></a><span id="l2.34">             label.shortWeekNames = false;</span>
<a href="#l2.35"></a><span id="l2.35">             const curPixelLength = label.getLongWeekdayPixels();</span>
<a href="#l2.36"></a><span id="l2.36">             maxDayWidth = Math.max(maxDayWidth, curPixelLength);</span>
<a href="#l2.37"></a><span id="l2.37">           }</span>
<a href="#l2.38"></a><span id="l2.38">         }</span>
<a href="#l2.39"></a><span id="l2.39">         if (maxDayWidth &gt; 0) {</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineminus">-          this.mLongWeekdayTotalPixels = maxDayWidth * this.labeldaybox.childNodes.length + 10;</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineplus">+          this.mLongWeekdayTotalPixels = maxDayWidth * this.labeldaybox.children.length + 10;</span>
<a href="#l2.42"></a><span id="l2.42">         }</span>
<a href="#l2.43"></a><span id="l2.43">       }</span>
<a href="#l2.44"></a><span id="l2.44">       return this.mLongWeekdayTotalPixels;</span>
<a href="#l2.45"></a><span id="l2.45">     }</span>
<a href="#l2.46"></a><span id="l2.46"> </span>
<a href="#l2.47"></a><span id="l2.47">     /**</span>
<a href="#l2.48"></a><span id="l2.48">      * Return a date object representing the current day.</span>
<a href="#l2.49"></a><span id="l2.49">      *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/calendar-event-column.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/calendar-event-column.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -207,24 +207,24 @@</span>
<a href="#l3.4"></a><span id="l3.4"> </span>
<a href="#l3.5"></a><span id="l3.5">     get pixelsPerMinute() {</span>
<a href="#l3.6"></a><span id="l3.6">       return this.mPixPerMin;</span>
<a href="#l3.7"></a><span id="l3.7">     }</span>
<a href="#l3.8"></a><span id="l3.8"> </span>
<a href="#l3.9"></a><span id="l3.9">     set selected(val) {</span>
<a href="#l3.10"></a><span id="l3.10">       this.mSelected = val;</span>
<a href="#l3.11"></a><span id="l3.11">       if (this.bgbox &amp;&amp; this.bgbox.hasChildNodes()) {</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-        let child = this.bgbox.firstChild;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+        let child = this.bgbox.firstElementChild;</span>
<a href="#l3.14"></a><span id="l3.14">         while (child) {</span>
<a href="#l3.15"></a><span id="l3.15">           if (val) {</span>
<a href="#l3.16"></a><span id="l3.16">             child.setAttribute(&quot;selected&quot;, &quot;true&quot;);</span>
<a href="#l3.17"></a><span id="l3.17">           } else {</span>
<a href="#l3.18"></a><span id="l3.18">             child.removeAttribute(&quot;selected&quot;);</span>
<a href="#l3.19"></a><span id="l3.19">           }</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineminus">-          child = child.nextSibling;</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+          child = child.nextElementSibling;</span>
<a href="#l3.22"></a><span id="l3.22">         }</span>
<a href="#l3.23"></a><span id="l3.23">       }</span>
<a href="#l3.24"></a><span id="l3.24">       return val;</span>
<a href="#l3.25"></a><span id="l3.25">     }</span>
<a href="#l3.26"></a><span id="l3.26"> </span>
<a href="#l3.27"></a><span id="l3.27">     get selected() {</span>
<a href="#l3.28"></a><span id="l3.28">       return this.mSelected;</span>
<a href="#l3.29"></a><span id="l3.29">     }</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineat">@@ -1114,23 +1114,23 @@</span>
<a href="#l3.31"></a><span id="l3.31">       };</span>
<a href="#l3.32"></a><span id="l3.32">     }</span>
<a href="#l3.33"></a><span id="l3.33"> </span>
<a href="#l3.34"></a><span id="l3.34">     firstLastShadowColumns(offset, shadows) {</span>
<a href="#l3.35"></a><span id="l3.35">       let firstCol = this; // eslint-disable-line consistent-this</span>
<a href="#l3.36"></a><span id="l3.36">       let lastCol = this; // eslint-disable-line consistent-this</span>
<a href="#l3.37"></a><span id="l3.37">       let firstIndex = offset == null ? this.mDragState.offset : offset;</span>
<a href="#l3.38"></a><span id="l3.38">       let lastIndex = firstIndex;</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineminus">-      while (firstCol.previousSibling &amp;&amp; firstIndex &gt; 0) {</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineminus">-        firstCol = firstCol.previousSibling;</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineplus">+      while (firstCol.previousElementSibling &amp;&amp; firstIndex &gt; 0) {</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineplus">+        firstCol = firstCol.previousElementSibling;</span>
<a href="#l3.43"></a><span id="l3.43">         firstIndex--;</span>
<a href="#l3.44"></a><span id="l3.44">       }</span>
<a href="#l3.45"></a><span id="l3.45">       let lastShadow = shadows == null ? this.mDragState.shadows : shadows;</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineminus">-      while (lastCol.nextSibling &amp;&amp; lastIndex &lt; lastShadow - 1) {</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineminus">-        lastCol = lastCol.nextSibling;</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineplus">+      while (lastCol.nextElementSibling &amp;&amp; lastIndex &lt; lastShadow - 1) {</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineplus">+        lastCol = lastCol.nextElementSibling;</span>
<a href="#l3.50"></a><span id="l3.50">         lastIndex++;</span>
<a href="#l3.51"></a><span id="l3.51">       }</span>
<a href="#l3.52"></a><span id="l3.52"> </span>
<a href="#l3.53"></a><span id="l3.53">       // Returns first and last column with shadows that are visible in the</span>
<a href="#l3.54"></a><span id="l3.54">       // week and the positions of these (visible) columns in the set of</span>
<a href="#l3.55"></a><span id="l3.55">       // columns shadows of the occurrence.</span>
<a href="#l3.56"></a><span id="l3.56">       return {</span>
<a href="#l3.57"></a><span id="l3.57">         firstCol: firstCol,</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineat">@@ -1146,27 +1146,27 @@</span>
<a href="#l3.59"></a><span id="l3.59">       let firstIndex = lateralColumns.firstIndex;</span>
<a href="#l3.60"></a><span id="l3.60">       let lastCol = lateralColumns.lastCol;</span>
<a href="#l3.61"></a><span id="l3.61">       let lastIndex = lateralColumns.lastIndex;</span>
<a href="#l3.62"></a><span id="l3.62"> </span>
<a href="#l3.63"></a><span id="l3.63">       // Remove the first/last shadow when start/end time goes in the</span>
<a href="#l3.64"></a><span id="l3.64">       // next/previous day. This happens when current offset is different</span>
<a href="#l3.65"></a><span id="l3.65">       // from offset stored in mDragState.</span>
<a href="#l3.66"></a><span id="l3.66">       if (aCurrentOffset != null) {</span>
<a href="#l3.67"></a><span id="l3.67" class="difflineminus">-        if (this.mDragState.offset &gt; aCurrentOffset &amp;&amp; firstCol.previousSibling) {</span>
<a href="#l3.68"></a><span id="l3.68" class="difflineminus">-          firstCol.previousSibling.fgboxes.dragbox.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.69"></a><span id="l3.69" class="difflineminus">-          firstCol.previousSibling.fgboxes.box.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.70"></a><span id="l3.70" class="difflineplus">+        if (this.mDragState.offset &gt; aCurrentOffset &amp;&amp; firstCol.previousElementSibling) {</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineplus">+          firstCol.previousElementSibling.fgboxes.dragbox.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.72"></a><span id="l3.72" class="difflineplus">+          firstCol.previousElementSibling.fgboxes.box.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.73"></a><span id="l3.73">         }</span>
<a href="#l3.74"></a><span id="l3.74">         let currentOffsetEndSide = aCurrentShadows - 1 - aCurrentOffset;</span>
<a href="#l3.75"></a><span id="l3.75">         if (</span>
<a href="#l3.76"></a><span id="l3.76">           this.mDragState.shadows - 1 - this.mDragState.offset &gt; currentOffsetEndSide &amp;&amp;</span>
<a href="#l3.77"></a><span id="l3.77" class="difflineminus">-          lastCol.nextSibling</span>
<a href="#l3.78"></a><span id="l3.78" class="difflineplus">+          lastCol.nextElementSibling</span>
<a href="#l3.79"></a><span id="l3.79">         ) {</span>
<a href="#l3.80"></a><span id="l3.80" class="difflineminus">-          lastCol.nextSibling.fgboxes.dragbox.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineminus">-          lastCol.nextSibling.fgboxes.box.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineplus">+          lastCol.nextElementSibling.fgboxes.dragbox.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineplus">+          lastCol.nextElementSibling.fgboxes.box.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.84"></a><span id="l3.84">         }</span>
<a href="#l3.85"></a><span id="l3.85">       }</span>
<a href="#l3.86"></a><span id="l3.86"> </span>
<a href="#l3.87"></a><span id="l3.87">       // Set shadow boxes size for every part of the occurrence.</span>
<a href="#l3.88"></a><span id="l3.88">       let firstShadowSize = (aCurrentShadows == 1 ? aEnd : this.mEndMin) - aStart;</span>
<a href="#l3.89"></a><span id="l3.89">       let column = firstCol;</span>
<a href="#l3.90"></a><span id="l3.90">       for (let i = firstIndex; column &amp;&amp; i &lt;= lastIndex; i++) {</span>
<a href="#l3.91"></a><span id="l3.91">         column.fgboxes.box.setAttribute(&quot;dragging&quot;, &quot;true&quot;);</span>
<a href="#l3.92"></a><span id="l3.92" class="difflineat">@@ -1179,34 +1179,34 @@</span>
<a href="#l3.93"></a><span id="l3.93">           // Last shadow.</span>
<a href="#l3.94"></a><span id="l3.94">           column.fgboxes.dragspacer.setAttribute(aSizeattr, 0);</span>
<a href="#l3.95"></a><span id="l3.95">           column.fgboxes.dragbox.setAttribute(aSizeattr, aEnd * column.mPixPerMin);</span>
<a href="#l3.96"></a><span id="l3.96">         } else {</span>
<a href="#l3.97"></a><span id="l3.97">           // An intermediate shadow (full day).</span>
<a href="#l3.98"></a><span id="l3.98">           column.fgboxes.dragspacer.setAttribute(aSizeattr, 0);</span>
<a href="#l3.99"></a><span id="l3.99">           column.fgboxes.dragbox.setAttribute(aSizeattr, this.mEndMin * column.mPixPerMin);</span>
<a href="#l3.100"></a><span id="l3.100">         }</span>
<a href="#l3.101"></a><span id="l3.101" class="difflineminus">-        column = column.nextSibling;</span>
<a href="#l3.102"></a><span id="l3.102" class="difflineplus">+        column = column.nextElementSibling;</span>
<a href="#l3.103"></a><span id="l3.103">       }</span>
<a href="#l3.104"></a><span id="l3.104">     }</span>
<a href="#l3.105"></a><span id="l3.105"> </span>
<a href="#l3.106"></a><span id="l3.106">     onEventSweepKeypress(event) {</span>
<a href="#l3.107"></a><span id="l3.107">       let col = document.calendarEventColumnDragging;</span>
<a href="#l3.108"></a><span id="l3.108">       if (col &amp;&amp; event.key == &quot;Escape&quot;) {</span>
<a href="#l3.109"></a><span id="l3.109">         window.removeEventListener(&quot;mousemove&quot;, col.onEventSweepMouseMove);</span>
<a href="#l3.110"></a><span id="l3.110">         window.removeEventListener(&quot;mouseup&quot;, col.onEventSweepMouseUp);</span>
<a href="#l3.111"></a><span id="l3.111">         window.removeEventListener(&quot;keypress&quot;, col.onEventSweepKeypress);</span>
<a href="#l3.112"></a><span id="l3.112"> </span>
<a href="#l3.113"></a><span id="l3.113">         let lateralColumns = col.firstLastShadowColumns();</span>
<a href="#l3.114"></a><span id="l3.114">         let column = lateralColumns.firstCol;</span>
<a href="#l3.115"></a><span id="l3.115">         let index = lateralColumns.firstIndex;</span>
<a href="#l3.116"></a><span id="l3.116">         while (column &amp;&amp; index &lt; col.mDragState.shadows) {</span>
<a href="#l3.117"></a><span id="l3.117">           column.fgboxes.dragbox.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.118"></a><span id="l3.118">           column.fgboxes.box.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.119"></a><span id="l3.119" class="difflineminus">-          column = column.nextSibling;</span>
<a href="#l3.120"></a><span id="l3.120" class="difflineplus">+          column = column.nextElementSibling;</span>
<a href="#l3.121"></a><span id="l3.121">           index++;</span>
<a href="#l3.122"></a><span id="l3.122">         }</span>
<a href="#l3.123"></a><span id="l3.123"> </span>
<a href="#l3.124"></a><span id="l3.124">         col.mDragState = null;</span>
<a href="#l3.125"></a><span id="l3.125">         document.calendarEventColumnDragging = null;</span>
<a href="#l3.126"></a><span id="l3.126">       }</span>
<a href="#l3.127"></a><span id="l3.127">     }</span>
<a href="#l3.128"></a><span id="l3.128"> </span>
<a href="#l3.129"></a><span id="l3.129" class="difflineat">@@ -1282,17 +1282,17 @@</span>
<a href="#l3.130"></a><span id="l3.130">         event.clientX &gt; boundingRect.x + boundingRect.width ||</span>
<a href="#l3.131"></a><span id="l3.131">         event.clientY &lt; boundingRect.y ||</span>
<a href="#l3.132"></a><span id="l3.132">         event.clientY &gt; boundingRect.y + boundingRect.height</span>
<a href="#l3.133"></a><span id="l3.133">       ) {</span>
<a href="#l3.134"></a><span id="l3.134">         // Remove the drag state.</span>
<a href="#l3.135"></a><span id="l3.135">         for (</span>
<a href="#l3.136"></a><span id="l3.136">           let column = firstCol, i = firstIndex;</span>
<a href="#l3.137"></a><span id="l3.137">           column &amp;&amp; i &lt; col.mDragState.shadows;</span>
<a href="#l3.138"></a><span id="l3.138" class="difflineminus">-          column = column.nextSibling, i++</span>
<a href="#l3.139"></a><span id="l3.139" class="difflineplus">+          column = column.nextElementSibling, i++</span>
<a href="#l3.140"></a><span id="l3.140">         ) {</span>
<a href="#l3.141"></a><span id="l3.141">           column.fgboxes.dragbox.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.142"></a><span id="l3.142">           column.fgboxes.box.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.143"></a><span id="l3.143">         }</span>
<a href="#l3.144"></a><span id="l3.144"> </span>
<a href="#l3.145"></a><span id="l3.145">         window.removeEventListener(&quot;mousemove&quot;, col.onEventSweepMouseMove);</span>
<a href="#l3.146"></a><span id="l3.146">         window.removeEventListener(&quot;mouseup&quot;, col.onEventSweepMouseUp);</span>
<a href="#l3.147"></a><span id="l3.147">         window.removeEventListener(&quot;keypress&quot;, col.onEventSweepKeypress);</span>
<a href="#l3.148"></a><span id="l3.148" class="difflineat">@@ -1344,17 +1344,17 @@</span>
<a href="#l3.149"></a><span id="l3.149">           dragState.limitEndMin -= minutesInDay * jumpedColumns;</span>
<a href="#l3.150"></a><span id="l3.150">           dragState.limitStartMin -= minutesInDay * jumpedColumns;</span>
<a href="#l3.151"></a><span id="l3.151">           dragState.jumpedColumns += jumpedColumns;</span>
<a href="#l3.152"></a><span id="l3.152">         }</span>
<a href="#l3.153"></a><span id="l3.153">         // Kill our drag state.</span>
<a href="#l3.154"></a><span id="l3.154">         for (</span>
<a href="#l3.155"></a><span id="l3.155">           let column = firstCol, i = firstIndex;</span>
<a href="#l3.156"></a><span id="l3.156">           column &amp;&amp; i &lt; col.mDragState.shadows;</span>
<a href="#l3.157"></a><span id="l3.157" class="difflineminus">-          column = column.nextSibling, i++</span>
<a href="#l3.158"></a><span id="l3.158" class="difflineplus">+          column = column.nextElementSibling, i++</span>
<a href="#l3.159"></a><span id="l3.159">         ) {</span>
<a href="#l3.160"></a><span id="l3.160">           column.fgboxes.dragbox.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.161"></a><span id="l3.161">           column.fgboxes.box.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.162"></a><span id="l3.162">         }</span>
<a href="#l3.163"></a><span id="l3.163"> </span>
<a href="#l3.164"></a><span id="l3.164">         // Jump ship.</span>
<a href="#l3.165"></a><span id="l3.165">         newcol.acceptInProgressSweep(dragState);</span>
<a href="#l3.166"></a><span id="l3.166"> </span>
<a href="#l3.167"></a><span id="l3.167" class="difflineat">@@ -1473,17 +1473,17 @@</span>
<a href="#l3.168"></a><span id="l3.168">       let dragState = col.mDragState;</span>
<a href="#l3.169"></a><span id="l3.169"> </span>
<a href="#l3.170"></a><span id="l3.170">       let lateralColumns = col.firstLastShadowColumns();</span>
<a href="#l3.171"></a><span id="l3.171">       let column = lateralColumns.firstCol;</span>
<a href="#l3.172"></a><span id="l3.172">       let index = lateralColumns.firstIndex;</span>
<a href="#l3.173"></a><span id="l3.173">       while (column &amp;&amp; index &lt; dragState.shadows) {</span>
<a href="#l3.174"></a><span id="l3.174">         column.fgboxes.dragbox.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.175"></a><span id="l3.175">         column.fgboxes.box.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l3.176"></a><span id="l3.176" class="difflineminus">-        column = column.nextSibling;</span>
<a href="#l3.177"></a><span id="l3.177" class="difflineplus">+        column = column.nextElementSibling;</span>
<a href="#l3.178"></a><span id="l3.178">         index++;</span>
<a href="#l3.179"></a><span id="l3.179">       }</span>
<a href="#l3.180"></a><span id="l3.180"> </span>
<a href="#l3.181"></a><span id="l3.181">       col.clearMagicScroll();</span>
<a href="#l3.182"></a><span id="l3.182"> </span>
<a href="#l3.183"></a><span id="l3.183">       window.removeEventListener(&quot;mousemove&quot;, col.onEventSweepMouseMove);</span>
<a href="#l3.184"></a><span id="l3.184">       window.removeEventListener(&quot;mouseup&quot;, col.onEventSweepMouseUp);</span>
<a href="#l3.185"></a><span id="l3.185">       window.removeEventListener(&quot;keypress&quot;, col.onEventSweepKeypress);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-management.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-management.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -237,24 +237,24 @@ function loadCalendarManager() {</span>
<a href="#l4.4"></a><span id="l4.4">     event.preventDefault();</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6">     let existing = calendarList.querySelector(&quot;[drop-on]&quot;);</span>
<a href="#l4.7"></a><span id="l4.7">     if (existing) {</span>
<a href="#l4.8"></a><span id="l4.8">       existing.removeAttribute(&quot;drop-on&quot;);</span>
<a href="#l4.9"></a><span id="l4.9">     }</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11">     if (event.target == calendarList) {</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-      calendarList.lastChild.setAttribute(&quot;drop-on&quot;, &quot;bottom&quot;);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+      calendarList.lastElementChild.setAttribute(&quot;drop-on&quot;, &quot;bottom&quot;);</span>
<a href="#l4.14"></a><span id="l4.14">       return;</span>
<a href="#l4.15"></a><span id="l4.15">     }</span>
<a href="#l4.16"></a><span id="l4.16"> </span>
<a href="#l4.17"></a><span id="l4.17">     let item = event.target.closest(&quot;richlistitem&quot;);</span>
<a href="#l4.18"></a><span id="l4.18">     if (item) {</span>
<a href="#l4.19"></a><span id="l4.19">       // If we're dragging/dropping in bottom half of attachmentitem,</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineminus">-      // adjust target to target.nextSibling (to show dropmarker above that).</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+      // adjust target to target.nextElementSibling (to show dropmarker above that).</span>
<a href="#l4.22"></a><span id="l4.22">       if ((event.screenY - item.screenY) / item.getBoundingClientRect().height &gt;= 0.5) {</span>
<a href="#l4.23"></a><span id="l4.23">         item = item.nextElementSibling;</span>
<a href="#l4.24"></a><span id="l4.24">       }</span>
<a href="#l4.25"></a><span id="l4.25">       if (item) {</span>
<a href="#l4.26"></a><span id="l4.26">         item.setAttribute(&quot;drop-on&quot;, &quot;top&quot;);</span>
<a href="#l4.27"></a><span id="l4.27">       } else {</span>
<a href="#l4.28"></a><span id="l4.28">         calendarList.lastElementChild.setAttribute(&quot;drop-on&quot;, &quot;bottom&quot;);</span>
<a href="#l4.29"></a><span id="l4.29">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/calendar-month-base-view.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/calendar-month-base-view.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -394,19 +394,19 @@ var { cal } = ChromeUtils.import(&quot;resour</span>
<a href="#l5.4"></a><span id="l5.4">       timeIndicator.cancel();</span>
<a href="#l5.5"></a><span id="l5.5">     }</span>
<a href="#l5.6"></a><span id="l5.6"> </span>
<a href="#l5.7"></a><span id="l5.7">     /**</span>
<a href="#l5.8"></a><span id="l5.8">      * Re-render the view.</span>
<a href="#l5.9"></a><span id="l5.9">      */</span>
<a href="#l5.10"></a><span id="l5.10">     relayout() {</span>
<a href="#l5.11"></a><span id="l5.11">       // Adjust headers based on the starting day of the week, if necessary.</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-      if (this.labeldaybox.firstChild.weekDay != this.weekStartOffset) {</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-        for (let i = 0; i &lt; this.labeldaybox.childNodes.length; i++) {</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-          this.labeldaybox.childNodes[i].weekDay = (i + this.weekStartOffset) % 7;</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+      if (this.labeldaybox.firstElementChild.weekDay != this.weekStartOffset) {</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+        for (let i = 0; i &lt; this.labeldaybox.children.length; i++) {</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+          this.labeldaybox.children[i].weekDay = (i + this.weekStartOffset) % 7;</span>
<a href="#l5.18"></a><span id="l5.18">         }</span>
<a href="#l5.19"></a><span id="l5.19">       }</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21">       if (this.mSelectedItems.length) {</span>
<a href="#l5.22"></a><span id="l5.22">         this.mSelectedItems = [];</span>
<a href="#l5.23"></a><span id="l5.23">       }</span>
<a href="#l5.24"></a><span id="l5.24"> </span>
<a href="#l5.25"></a><span id="l5.25">       if (!this.mStartDate || !this.mEndDate) {</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineat">@@ -431,36 +431,36 @@ var { cal } = ChromeUtils.import(&quot;resour</span>
<a href="#l5.27"></a><span id="l5.27"> </span>
<a href="#l5.28"></a><span id="l5.28">       // This allows finding the first column of dayboxes where to set the</span>
<a href="#l5.29"></a><span id="l5.29">       // week labels, taking into account whether days-off are displayed or not.</span>
<a href="#l5.30"></a><span id="l5.30">       let weekLabelColumnPos = -1;</span>
<a href="#l5.31"></a><span id="l5.31"> </span>
<a href="#l5.32"></a><span id="l5.32">       const rows = this.monthgrid.children;</span>
<a href="#l5.33"></a><span id="l5.33"> </span>
<a href="#l5.34"></a><span id="l5.34">       // Iterate through each monthgridrow and set up the day-boxes that</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineminus">-      // are its child nodes.  Remember, childNodes is not a normal array,</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+      // are its child nodes.  Remember, children is not a normal array,</span>
<a href="#l5.37"></a><span id="l5.37">       // so don't use the in operator if you don't want extra properties</span>
<a href="#l5.38"></a><span id="l5.38">       // coming out.</span>
<a href="#l5.39"></a><span id="l5.39">       for (let i = 0; i &lt; rows.length; i++) {</span>
<a href="#l5.40"></a><span id="l5.40">         const row = rows[i];</span>
<a href="#l5.41"></a><span id="l5.41">         // If we've already assigned all of the day-boxes that we need, just</span>
<a href="#l5.42"></a><span id="l5.42">         // collapse the rest of the rows, otherwise expand them if needed.</span>
<a href="#l5.43"></a><span id="l5.43">         row.toggleAttribute(&quot;hidden&quot;, finished);</span>
<a href="#l5.44"></a><span id="l5.44">         if (finished) {</span>
<a href="#l5.45"></a><span id="l5.45">           continue;</span>
<a href="#l5.46"></a><span id="l5.46">         }</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineminus">-        for (let j = 0; j &lt; row.childNodes.length; j++) {</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineminus">-          const daybox = row.childNodes[j].firstChild;</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineplus">+        for (let j = 0; j &lt; row.children.length; j++) {</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineplus">+          const daybox = row.children[j].firstElementChild;</span>
<a href="#l5.51"></a><span id="l5.51">           const date = dateList[dateBoxes.length];</span>
<a href="#l5.52"></a><span id="l5.52"> </span>
<a href="#l5.53"></a><span id="l5.53">           // Remove the attribute &quot;relation&quot; for all the column headers.</span>
<a href="#l5.54"></a><span id="l5.54">           // Consider only the first row index otherwise it will be</span>
<a href="#l5.55"></a><span id="l5.55">           // removed again afterwards the correct setting.</span>
<a href="#l5.56"></a><span id="l5.56">           if (i == 0) {</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineminus">-            this.labeldaybox.childNodes[j].removeAttribute(&quot;relation&quot;);</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineplus">+            this.labeldaybox.children[j].removeAttribute(&quot;relation&quot;);</span>
<a href="#l5.59"></a><span id="l5.59">           }</span>
<a href="#l5.60"></a><span id="l5.60"> </span>
<a href="#l5.61"></a><span id="l5.61">           daybox.setAttribute(&quot;context&quot;, this.getAttribute(&quot;context&quot;));</span>
<a href="#l5.62"></a><span id="l5.62"> </span>
<a href="#l5.63"></a><span id="l5.63">           daybox.setAttribute(</span>
<a href="#l5.64"></a><span id="l5.64">             &quot;item-context&quot;,</span>
<a href="#l5.65"></a><span id="l5.65">             this.getAttribute(&quot;item-context&quot;) || this.getAttribute(&quot;context&quot;)</span>
<a href="#l5.66"></a><span id="l5.66">           );</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineat">@@ -481,17 +481,17 @@ var { cal } = ChromeUtils.import(&quot;resour</span>
<a href="#l5.68"></a><span id="l5.68"> </span>
<a href="#l5.69"></a><span id="l5.69">           // Set up date relations.</span>
<a href="#l5.70"></a><span id="l5.70">           switch (date.compare(today)) {</span>
<a href="#l5.71"></a><span id="l5.71">             case -1:</span>
<a href="#l5.72"></a><span id="l5.72">               daybox.setAttribute(&quot;relation&quot;, &quot;past&quot;);</span>
<a href="#l5.73"></a><span id="l5.73">               break;</span>
<a href="#l5.74"></a><span id="l5.74">             case 0:</span>
<a href="#l5.75"></a><span id="l5.75">               daybox.setAttribute(&quot;relation&quot;, &quot;today&quot;);</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineminus">-              this.labeldaybox.childNodes[j].setAttribute(&quot;relation&quot;, &quot;today&quot;);</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineplus">+              this.labeldaybox.children[j].setAttribute(&quot;relation&quot;, &quot;today&quot;);</span>
<a href="#l5.78"></a><span id="l5.78">               break;</span>
<a href="#l5.79"></a><span id="l5.79">             case 1:</span>
<a href="#l5.80"></a><span id="l5.80">               daybox.setAttribute(&quot;relation&quot;, &quot;future&quot;);</span>
<a href="#l5.81"></a><span id="l5.81">               break;</span>
<a href="#l5.82"></a><span id="l5.82">           }</span>
<a href="#l5.83"></a><span id="l5.83"> </span>
<a href="#l5.84"></a><span id="l5.84">           // Set up label with the week number in the first day of the row.</span>
<a href="#l5.85"></a><span id="l5.85">           if (this.mShowWeekNumber) {</span>
<a href="#l5.86"></a><span id="l5.86" class="difflineat">@@ -570,29 +570,29 @@ var { cal } = ChromeUtils.import(&quot;resour</span>
<a href="#l5.87"></a><span id="l5.87"> </span>
<a href="#l5.88"></a><span id="l5.88">     /**</span>
<a href="#l5.89"></a><span id="l5.89">      * Hide the week numbers.</span>
<a href="#l5.90"></a><span id="l5.90">      */</span>
<a href="#l5.91"></a><span id="l5.91">     hideWeekNumbers() {</span>
<a href="#l5.92"></a><span id="l5.92">       const rows = this.monthgrid.children;</span>
<a href="#l5.93"></a><span id="l5.93">       for (let i = 0; i &lt; rows.length; i++) {</span>
<a href="#l5.94"></a><span id="l5.94">         const row = rows[i];</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineminus">-        for (let j = 0; j &lt; row.childNodes.length; j++) {</span>
<a href="#l5.96"></a><span id="l5.96" class="difflineminus">-          const daybox = row.childNodes[j].firstChild;</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineplus">+        for (let j = 0; j &lt; row.children.length; j++) {</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineplus">+          const daybox = row.children[j].firstElementChild;</span>
<a href="#l5.99"></a><span id="l5.99">           const weekLabel = daybox.querySelector(&quot;[data-label='week']&quot;);</span>
<a href="#l5.100"></a><span id="l5.100">           weekLabel.hidden = true;</span>
<a href="#l5.101"></a><span id="l5.101">         }</span>
<a href="#l5.102"></a><span id="l5.102">       }</span>
<a href="#l5.103"></a><span id="l5.103">     }</span>
<a href="#l5.104"></a><span id="l5.104"> </span>
<a href="#l5.105"></a><span id="l5.105">     /**</span>
<a href="#l5.106"></a><span id="l5.106">      * Hide the days off.</span>
<a href="#l5.107"></a><span id="l5.107">      */</span>
<a href="#l5.108"></a><span id="l5.108">     hideDaysOff() {</span>
<a href="#l5.109"></a><span id="l5.109" class="difflineminus">-      const headerkids = this.querySelector(&quot;.labeldaybox&quot;).childNodes;</span>
<a href="#l5.110"></a><span id="l5.110" class="difflineplus">+      const headerkids = this.querySelector(&quot;.labeldaybox&quot;).children;</span>
<a href="#l5.111"></a><span id="l5.111">       const rows = this.monthgrid.children;</span>
<a href="#l5.112"></a><span id="l5.112"> </span>
<a href="#l5.113"></a><span id="l5.113">       const lastColNum = rows[0].children.length - 1;</span>
<a href="#l5.114"></a><span id="l5.114">       for (let colNum = 0; colNum &lt;= lastColNum; colNum++) {</span>
<a href="#l5.115"></a><span id="l5.115">         const dayForColumn = (colNum + this.mWeekStartOffset) % 7;</span>
<a href="#l5.116"></a><span id="l5.116">         const dayOff = this.mDaysOffArray.includes(dayForColumn);</span>
<a href="#l5.117"></a><span id="l5.117">         headerkids[colNum].hidden = dayOff &amp;&amp; !this.mDisplayDaysOff;</span>
<a href="#l5.118"></a><span id="l5.118">         for (let row of rows) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-base-view.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-base-view.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -85,27 +85,27 @@</span>
<a href="#l6.4"></a><span id="l6.4">         throw Cr.NS_ERROR_INVALID_ARG;</span>
<a href="#l6.5"></a><span id="l6.5">       }</span>
<a href="#l6.6"></a><span id="l6.6"> </span>
<a href="#l6.7"></a><span id="l6.7">       if (this.mDayStartHour != dayStartHour || this.mDayEndHour != dayEndHour) {</span>
<a href="#l6.8"></a><span id="l6.8">         this.mDayEndHour = dayEndHour;</span>
<a href="#l6.9"></a><span id="l6.9">         this.mDayStartHour = dayStartHour;</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11">         const topbox = this.querySelector(&quot;.topbox&quot;);</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-        if (topbox.childNodes.length) {</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+        if (topbox.children.length) {</span>
<a href="#l6.14"></a><span id="l6.14">           // This only needs to be re-done if the initial relayout has already</span>
<a href="#l6.15"></a><span id="l6.15">           // happened.  (If it hasn't happened, this will be done when it does happen.)</span>
<a href="#l6.16"></a><span id="l6.16">           const start = this.mStartMin / 60;</span>
<a href="#l6.17"></a><span id="l6.17">           const end = this.mEndMin / 60;</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19">           for (let hour = start; hour &lt; end; hour++) {</span>
<a href="#l6.20"></a><span id="l6.20">             if (hour &lt; this.mDayStartHour || hour &gt;= this.mDayEndHour) {</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineminus">-              topbox.childNodes[hour].setAttribute(&quot;off-time&quot;, &quot;true&quot;);</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+              topbox.children[hour].setAttribute(&quot;off-time&quot;, &quot;true&quot;);</span>
<a href="#l6.23"></a><span id="l6.23">             } else {</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineminus">-              topbox.childNodes[hour].removeAttribute(&quot;off-time&quot;);</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineplus">+              topbox.children[hour].removeAttribute(&quot;off-time&quot;);</span>
<a href="#l6.26"></a><span id="l6.26">             }</span>
<a href="#l6.27"></a><span id="l6.27">           }</span>
<a href="#l6.28"></a><span id="l6.28">         }</span>
<a href="#l6.29"></a><span id="l6.29">       }</span>
<a href="#l6.30"></a><span id="l6.30">     }</span>
<a href="#l6.31"></a><span id="l6.31"> </span>
<a href="#l6.32"></a><span id="l6.32">     /**</span>
<a href="#l6.33"></a><span id="l6.33">      * Set an attribute on the time bar element, and do a relayout if needed.</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineat">@@ -450,17 +450,17 @@</span>
<a href="#l6.35"></a><span id="l6.35">       // TODO Make sure the selected day is valid.</span>
<a href="#l6.36"></a><span id="l6.36">       // TODO Select now if it is in the range?</span>
<a href="#l6.37"></a><span id="l6.37">       return selected;</span>
<a href="#l6.38"></a><span id="l6.38">     }</span>
<a href="#l6.39"></a><span id="l6.39"> </span>
<a href="#l6.40"></a><span id="l6.40">     // End calICalendarView Properties</span>
<a href="#l6.41"></a><span id="l6.41"> </span>
<a href="#l6.42"></a><span id="l6.42">     get daysInView() {</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineminus">-      return this.labeldaybox.childNodes &amp;&amp; this.labeldaybox.childNodes.length;</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+      return this.labeldaybox.children &amp;&amp; this.labeldaybox.children.length;</span>
<a href="#l6.45"></a><span id="l6.45">     }</span>
<a href="#l6.46"></a><span id="l6.46"> </span>
<a href="#l6.47"></a><span id="l6.47">     set selectedDateTime(dateTime) {</span>
<a href="#l6.48"></a><span id="l6.48">       this.mClickedTime = dateTime;</span>
<a href="#l6.49"></a><span id="l6.49">     }</span>
<a href="#l6.50"></a><span id="l6.50"> </span>
<a href="#l6.51"></a><span id="l6.51">     get selectedDateTime() {</span>
<a href="#l6.52"></a><span id="l6.52">       return this.mClickedTime;</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineat">@@ -1151,19 +1151,19 @@</span>
<a href="#l6.54"></a><span id="l6.54">         setBooleanAttribute(dayBox, &quot;rotated&quot;, orient == &quot;horizontal&quot;);</span>
<a href="#l6.55"></a><span id="l6.55">       };</span>
<a href="#l6.56"></a><span id="l6.56"> </span>
<a href="#l6.57"></a><span id="l6.57">       this.mDateColumns = [];</span>
<a href="#l6.58"></a><span id="l6.58"> </span>
<a href="#l6.59"></a><span id="l6.59">       // Get today's date.</span>
<a href="#l6.60"></a><span id="l6.60">       const today = this.today();</span>
<a href="#l6.61"></a><span id="l6.61">       let counter = 0;</span>
<a href="#l6.62"></a><span id="l6.62" class="difflineminus">-      const dayboxkids = daybox.childNodes;</span>
<a href="#l6.63"></a><span id="l6.63" class="difflineminus">-      const headerboxkids = headerdaybox.childNodes;</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineminus">-      const labelboxkids = this.labeldaybox.childNodes;</span>
<a href="#l6.65"></a><span id="l6.65" class="difflineplus">+      const dayboxkids = daybox.children;</span>
<a href="#l6.66"></a><span id="l6.66" class="difflineplus">+      const headerboxkids = headerdaybox.children;</span>
<a href="#l6.67"></a><span id="l6.67" class="difflineplus">+      const labelboxkids = this.labeldaybox.children;</span>
<a href="#l6.68"></a><span id="l6.68">       let updateTimeIndicator = false;</span>
<a href="#l6.69"></a><span id="l6.69"> </span>
<a href="#l6.70"></a><span id="l6.70">       for (const date of computedDateList) {</span>
<a href="#l6.71"></a><span id="l6.71">         let dayEventsBox;</span>
<a href="#l6.72"></a><span id="l6.72">         if (counter &lt; dayboxkids.length) {</span>
<a href="#l6.73"></a><span id="l6.73">           dayEventsBox = dayboxkids[counter];</span>
<a href="#l6.74"></a><span id="l6.74">           dayEventsBox.removeAttribute(&quot;relation&quot;);</span>
<a href="#l6.75"></a><span id="l6.75">           dayEventsBox.mEventInfos = [];</span>
<a href="#l6.76"></a><span id="l6.76" class="difflineat">@@ -1231,17 +1231,17 @@</span>
<a href="#l6.77"></a><span id="l6.77">             updateTimeIndicator = true;</span>
<a href="#l6.78"></a><span id="l6.78"> </span>
<a href="#l6.79"></a><span id="l6.79">             // Due to equalsize=always being set on the dayboxes</span>
<a href="#l6.80"></a><span id="l6.80">             // parent, there are a few issues showing the border of</span>
<a href="#l6.81"></a><span id="l6.81">             // the last daybox correctly. To work around this, we're</span>
<a href="#l6.82"></a><span id="l6.82">             // setting an attribute we can use in CSS. For more</span>
<a href="#l6.83"></a><span id="l6.83">             // information about this hack, see bug 455045.</span>
<a href="#l6.84"></a><span id="l6.84">             if (</span>
<a href="#l6.85"></a><span id="l6.85" class="difflineminus">-              dayHeaderBox == headerdaybox.childNodes[headerdaybox.childNodes.length - 1] &amp;&amp;</span>
<a href="#l6.86"></a><span id="l6.86" class="difflineplus">+              dayHeaderBox == headerdaybox.children[headerdaybox.children.length - 1] &amp;&amp;</span>
<a href="#l6.87"></a><span id="l6.87">               this.numVisibleDates &gt; 1</span>
<a href="#l6.88"></a><span id="l6.88">             ) {</span>
<a href="#l6.89"></a><span id="l6.89">               headerDayBox.setAttribute(&quot;todaylastinview&quot;, &quot;true&quot;);</span>
<a href="#l6.90"></a><span id="l6.90">             }</span>
<a href="#l6.91"></a><span id="l6.91">             break;</span>
<a href="#l6.92"></a><span id="l6.92">           }</span>
<a href="#l6.93"></a><span id="l6.93">           case 1: {</span>
<a href="#l6.94"></a><span id="l6.94">             dayHeaderBox.setAttribute(&quot;relation&quot;, &quot;future&quot;);</span>
<a href="#l6.95"></a><span id="l6.95" class="difflineat">@@ -1256,18 +1256,18 @@</span>
<a href="#l6.96"></a><span id="l6.96">         date2.isDate = true;</span>
<a href="#l6.97"></a><span id="l6.97">         date2.makeImmutable();</span>
<a href="#l6.98"></a><span id="l6.98">         this.mDateColumns.push({ date: date2, column: dayEventsBox, header: dayHeaderBox });</span>
<a href="#l6.99"></a><span id="l6.99">         counter++;</span>
<a href="#l6.100"></a><span id="l6.100">       }</span>
<a href="#l6.101"></a><span id="l6.101"> </span>
<a href="#l6.102"></a><span id="l6.102">       // Remove any extra columns that may have been hanging around.</span>
<a href="#l6.103"></a><span id="l6.103">       function removeExtraKids(elem) {</span>
<a href="#l6.104"></a><span id="l6.104" class="difflineminus">-        while (counter &lt; elem.childNodes.length) {</span>
<a href="#l6.105"></a><span id="l6.105" class="difflineminus">-          elem.childNodes[counter].remove();</span>
<a href="#l6.106"></a><span id="l6.106" class="difflineplus">+        while (counter &lt; elem.children.length) {</span>
<a href="#l6.107"></a><span id="l6.107" class="difflineplus">+          elem.children[counter].remove();</span>
<a href="#l6.108"></a><span id="l6.108">         }</span>
<a href="#l6.109"></a><span id="l6.109">       }</span>
<a href="#l6.110"></a><span id="l6.110">       removeExtraKids(daybox);</span>
<a href="#l6.111"></a><span id="l6.111">       removeExtraKids(headerdaybox);</span>
<a href="#l6.112"></a><span id="l6.112">       removeExtraKids(this.labeldaybox);</span>
<a href="#l6.113"></a><span id="l6.113"> </span>
<a href="#l6.114"></a><span id="l6.114">       if (updateTimeIndicator) {</span>
<a href="#l6.115"></a><span id="l6.115">         this.updateTimeIndicatorPosition();</span>
<a href="#l6.116"></a><span id="l6.116" class="difflineat">@@ -1335,24 +1335,24 @@</span>
<a href="#l6.117"></a><span id="l6.117">     }</span>
<a href="#l6.118"></a><span id="l6.118"> </span>
<a href="#l6.119"></a><span id="l6.119">     /**</span>
<a href="#l6.120"></a><span id="l6.120">      * Select the column header for a given date.</span>
<a href="#l6.121"></a><span id="l6.121">      *</span>
<a href="#l6.122"></a><span id="l6.122">      * @param {calIDateTime} date    A date.</span>
<a href="#l6.123"></a><span id="l6.123">      */</span>
<a href="#l6.124"></a><span id="l6.124">     selectColumnHeader(date) {</span>
<a href="#l6.125"></a><span id="l6.125" class="difflineminus">-      let child = this.labeldaybox.firstChild;</span>
<a href="#l6.126"></a><span id="l6.126" class="difflineplus">+      let child = this.labeldaybox.firstElementChild;</span>
<a href="#l6.127"></a><span id="l6.127">       while (child) {</span>
<a href="#l6.128"></a><span id="l6.128">         if (child.date.compare(date) == 0) {</span>
<a href="#l6.129"></a><span id="l6.129">           child.setAttribute(&quot;selected&quot;, &quot;true&quot;);</span>
<a href="#l6.130"></a><span id="l6.130">         } else {</span>
<a href="#l6.131"></a><span id="l6.131">           child.removeAttribute(&quot;selected&quot;);</span>
<a href="#l6.132"></a><span id="l6.132">         }</span>
<a href="#l6.133"></a><span id="l6.133" class="difflineminus">-        child = child.nextSibling;</span>
<a href="#l6.134"></a><span id="l6.134" class="difflineplus">+        child = child.nextElementSibling;</span>
<a href="#l6.135"></a><span id="l6.135">       }</span>
<a href="#l6.136"></a><span id="l6.136">     }</span>
<a href="#l6.137"></a><span id="l6.137"> </span>
<a href="#l6.138"></a><span id="l6.138">     /**</span>
<a href="#l6.139"></a><span id="l6.139">      * Return the column objects for a group of occurrences.</span>
<a href="#l6.140"></a><span id="l6.140">      *</span>
<a href="#l6.141"></a><span id="l6.141">      * @param {calIItemBase[]} occurrences    Array of calendar item occurrences.</span>
<a href="#l6.142"></a><span id="l6.142">      * @return {DateColumn[]}                 Array of column objects.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/calendar-task-tree-utils.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-tree-utils.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -34,17 +34,17 @@ function addCalendarNames(aEvent) {</span>
<a href="#l7.4"></a><span id="l7.4">   if (tasksSelected) {</span>
<a href="#l7.5"></a><span id="l7.5">     let selIndex = appendCalendarItems(</span>
<a href="#l7.6"></a><span id="l7.6">       tasks[0],</span>
<a href="#l7.7"></a><span id="l7.7">       calendarMenuPopup,</span>
<a href="#l7.8"></a><span id="l7.8">       null,</span>
<a href="#l7.9"></a><span id="l7.9">       &quot;contextChangeTaskCalendar(event);&quot;</span>
<a href="#l7.10"></a><span id="l7.10">     );</span>
<a href="#l7.11"></a><span id="l7.11">     if (tasks.every(task =&gt; task.calendar == tasks[0].calendar) &amp;&amp; selIndex &gt; -1) {</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-      calendarMenuPopup.childNodes[selIndex].setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+      calendarMenuPopup.children[selIndex].setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l7.14"></a><span id="l7.14">     }</span>
<a href="#l7.15"></a><span id="l7.15">   }</span>
<a href="#l7.16"></a><span id="l7.16"> }</span>
<a href="#l7.17"></a><span id="l7.17"> </span>
<a href="#l7.18"></a><span id="l7.18"> /**</span>
<a href="#l7.19"></a><span id="l7.19">  * For each child of an element (for example all menuitems in a menu), if it defines a command</span>
<a href="#l7.20"></a><span id="l7.20">  * set an attribute on the command, otherwise set it on the child node itself.</span>
<a href="#l7.21"></a><span id="l7.21">  *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/calendar-task-view.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-view.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -203,17 +203,17 @@ var taskDetailsView = {</span>
<a href="#l8.4"></a><span id="l8.4">         categoryList.push(cat);</span>
<a href="#l8.5"></a><span id="l8.5">       }</span>
<a href="#l8.6"></a><span id="l8.6">     }</span>
<a href="#l8.7"></a><span id="l8.7">     cal.l10n.sortArrayByLocaleCollator(categoryList);</span>
<a href="#l8.8"></a><span id="l8.8"> </span>
<a href="#l8.9"></a><span id="l8.9">     let maxCount = item.calendar.getProperty(&quot;capabilities.categories.maxCount&quot;);</span>
<a href="#l8.10"></a><span id="l8.10"> </span>
<a href="#l8.11"></a><span id="l8.11">     while (categoryPopup.childElementCount &gt; 2) {</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-      categoryPopup.lastElementChild.remove();</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+      categoryPopup.lastChild.remove();</span>
<a href="#l8.14"></a><span id="l8.14">     }</span>
<a href="#l8.15"></a><span id="l8.15">     if (maxCount == 1) {</span>
<a href="#l8.16"></a><span id="l8.16">       let menuitem = document.createXULElement(&quot;menuitem&quot;);</span>
<a href="#l8.17"></a><span id="l8.17">       menuitem.setAttribute(&quot;class&quot;, &quot;menuitem-iconic&quot;);</span>
<a href="#l8.18"></a><span id="l8.18">       menuitem.setAttribute(&quot;label&quot;, cal.l10n.getCalString(&quot;None&quot;));</span>
<a href="#l8.19"></a><span id="l8.19">       menuitem.setAttribute(&quot;type&quot;, &quot;radio&quot;);</span>
<a href="#l8.20"></a><span id="l8.20">       if (itemCategories.length === 0) {</span>
<a href="#l8.21"></a><span id="l8.21">         menuitem.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/content/calendar-ui-utils.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/content/calendar-ui-utils.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -172,17 +172,17 @@ function enableElementWithLock(elementId</span>
<a href="#l9.4"></a><span id="l9.4">  *</span>
<a href="#l9.5"></a><span id="l9.5">  * @param aElement  The Node (or its id) to remove children from</span>
<a href="#l9.6"></a><span id="l9.6">  */</span>
<a href="#l9.7"></a><span id="l9.7"> function removeChildren(aElement) {</span>
<a href="#l9.8"></a><span id="l9.8">   if (typeof aElement == &quot;string&quot;) {</span>
<a href="#l9.9"></a><span id="l9.9">     aElement = document.getElementById(aElement);</span>
<a href="#l9.10"></a><span id="l9.10">   }</span>
<a href="#l9.11"></a><span id="l9.11"> </span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-  while (aElement.firstChild) {</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+  while (aElement.lastChild) {</span>
<a href="#l9.14"></a><span id="l9.14">     aElement.lastChild.remove();</span>
<a href="#l9.15"></a><span id="l9.15">   }</span>
<a href="#l9.16"></a><span id="l9.16"> }</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18"> /**</span>
<a href="#l9.19"></a><span id="l9.19">  * Sorts a sorted array of calendars by pref |calendar.list.sortOrder|.</span>
<a href="#l9.20"></a><span id="l9.20">  * Repairs that pref if dangling entries exist.</span>
<a href="#l9.21"></a><span id="l9.21">  *</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -302,18 +302,18 @@ function addMenuItem(aParent, aLabel, aV</span>
<a href="#l9.23"></a><span id="l9.23">  * @param aFilterAttribute  (optional) The name of an attribute that the child nodes carry</span>
<a href="#l9.24"></a><span id="l9.24">  *                            and that is used to filter the childnodes.</span>
<a href="#l9.25"></a><span id="l9.25">  * @param aFilterValue      (optional) The value of the filterattribute. If set only those</span>
<a href="#l9.26"></a><span id="l9.26">  *                            childnodes are modified that have an attribute</span>
<a href="#l9.27"></a><span id="l9.27">  *                            'aFilterAttribute' with the given value</span>
<a href="#l9.28"></a><span id="l9.28">  *                            'aFilterValue' set.</span>
<a href="#l9.29"></a><span id="l9.29">  */</span>
<a href="#l9.30"></a><span id="l9.30"> function setAttributeToChildren(aParent, aAttribute, aValue, aFilterAttribute, aFilterValue) {</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-  for (let i = 0; i &lt; aParent.childNodes.length; i++) {</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineminus">-    let element = aParent.childNodes[i];</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineplus">+  for (let i = 0; i &lt; aParent.children.length; i++) {</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineplus">+    let element = aParent.children[i];</span>
<a href="#l9.35"></a><span id="l9.35">     if (aFilterAttribute == null) {</span>
<a href="#l9.36"></a><span id="l9.36">       setElementValue(element, aValue, aAttribute);</span>
<a href="#l9.37"></a><span id="l9.37">     } else if (element.hasAttribute(aFilterAttribute)) {</span>
<a href="#l9.38"></a><span id="l9.38">       let compValue = element.getAttribute(aFilterAttribute);</span>
<a href="#l9.39"></a><span id="l9.39">       if (compValue === aFilterValue) {</span>
<a href="#l9.40"></a><span id="l9.40">         setElementValue(element, aValue, aAttribute);</span>
<a href="#l9.41"></a><span id="l9.41">       }</span>
<a href="#l9.42"></a><span id="l9.42">     }</span>
<a href="#l9.43"></a><span id="l9.43" class="difflineat">@@ -401,17 +401,17 @@ function menuListSelectItem(menuListId, </span>
<a href="#l9.44"></a><span id="l9.44"> /**</span>
<a href="#l9.45"></a><span id="l9.45">  * Find index of menuitem with the given value, or return -1 if not found.</span>
<a href="#l9.46"></a><span id="l9.46">  *</span>
<a href="#l9.47"></a><span id="l9.47">  * @param menuListId    The XUL menulist node to check.</span>
<a href="#l9.48"></a><span id="l9.48">  * @param value         The value to look for.</span>
<a href="#l9.49"></a><span id="l9.49">  * @return              The child index of the node that matches, or -1.</span>
<a href="#l9.50"></a><span id="l9.50">  */</span>
<a href="#l9.51"></a><span id="l9.51"> function menuListIndexOf(menuList, value) {</span>
<a href="#l9.52"></a><span id="l9.52" class="difflineminus">-  let items = menuList.menupopup.childNodes;</span>
<a href="#l9.53"></a><span id="l9.53" class="difflineplus">+  let items = menuList.menupopup.children;</span>
<a href="#l9.54"></a><span id="l9.54">   let index = -1;</span>
<a href="#l9.55"></a><span id="l9.55">   for (let i = 0; i &lt; items.length; i++) {</span>
<a href="#l9.56"></a><span id="l9.56">     let element = items[i];</span>
<a href="#l9.57"></a><span id="l9.57">     if (element.nodeName == &quot;menuitem&quot;) {</span>
<a href="#l9.58"></a><span id="l9.58">       index++;</span>
<a href="#l9.59"></a><span id="l9.59">     }</span>
<a href="#l9.60"></a><span id="l9.60">     if (element.getAttribute(&quot;value&quot;) == value) {</span>
<a href="#l9.61"></a><span id="l9.61">       return index;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/content/calendar-views-utils.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/content/calendar-views-utils.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -198,17 +198,17 @@ var calendarViewController = {</span>
<a href="#l10.4"></a><span id="l10.4">  * @param viewType     The type of view to select.</span>
<a href="#l10.5"></a><span id="l10.5">  */</span>
<a href="#l10.6"></a><span id="l10.6"> function switchToView(viewType) {</span>
<a href="#l10.7"></a><span id="l10.7">   let viewDeck = getViewDeck();</span>
<a href="#l10.8"></a><span id="l10.8">   let selectedDay;</span>
<a href="#l10.9"></a><span id="l10.9">   let currentSelection = [];</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11">   // Set up the view commands</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-  let views = viewDeck.childNodes;</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+  let views = viewDeck.children;</span>
<a href="#l10.14"></a><span id="l10.14">   for (let i = 0; i &lt; views.length; i++) {</span>
<a href="#l10.15"></a><span id="l10.15">     let view = views[i];</span>
<a href="#l10.16"></a><span id="l10.16">     let commandId = &quot;calendar_&quot; + view.id + &quot;_command&quot;;</span>
<a href="#l10.17"></a><span id="l10.17">     let command = document.getElementById(commandId);</span>
<a href="#l10.18"></a><span id="l10.18">     if (view.id == viewType + &quot;-view&quot;) {</span>
<a href="#l10.19"></a><span id="l10.19">       command.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l10.20"></a><span id="l10.20">     } else {</span>
<a href="#l10.21"></a><span id="l10.21">       command.removeAttribute(&quot;checked&quot;);</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineat">@@ -424,17 +424,17 @@ function getMinimonth() {</span>
<a href="#l10.23"></a><span id="l10.23">  * Update the view orientation based on the checked state of the command</span>
<a href="#l10.24"></a><span id="l10.24">  */</span>
<a href="#l10.25"></a><span id="l10.25"> function toggleOrientation() {</span>
<a href="#l10.26"></a><span id="l10.26">   let cmd = document.getElementById(&quot;calendar_toggle_orientation_command&quot;);</span>
<a href="#l10.27"></a><span id="l10.27">   let newValue = cmd.getAttribute(&quot;checked&quot;) == &quot;true&quot; ? &quot;false&quot; : &quot;true&quot;;</span>
<a href="#l10.28"></a><span id="l10.28">   cmd.setAttribute(&quot;checked&quot;, newValue);</span>
<a href="#l10.29"></a><span id="l10.29"> </span>
<a href="#l10.30"></a><span id="l10.30">   let deck = getViewDeck();</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-  for (let view of deck.childNodes) {</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+  for (let view of deck.children) {</span>
<a href="#l10.33"></a><span id="l10.33">     view.rotated = newValue == &quot;true&quot;;</span>
<a href="#l10.34"></a><span id="l10.34">   }</span>
<a href="#l10.35"></a><span id="l10.35"> </span>
<a href="#l10.36"></a><span id="l10.36">   // orientation refreshes automatically</span>
<a href="#l10.37"></a><span id="l10.37"> }</span>
<a href="#l10.38"></a><span id="l10.38"> </span>
<a href="#l10.39"></a><span id="l10.39"> /**</span>
<a href="#l10.40"></a><span id="l10.40">  * Toggle the workdays only checkbox and refresh the current view</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineat">@@ -443,51 +443,51 @@ function toggleOrientation() {</span>
<a href="#l10.42"></a><span id="l10.42">  * should happen automatically.</span>
<a href="#l10.43"></a><span id="l10.43">  */</span>
<a href="#l10.44"></a><span id="l10.44"> function toggleWorkdaysOnly() {</span>
<a href="#l10.45"></a><span id="l10.45">   let cmd = document.getElementById(&quot;calendar_toggle_workdays_only_command&quot;);</span>
<a href="#l10.46"></a><span id="l10.46">   let newValue = cmd.getAttribute(&quot;checked&quot;) == &quot;true&quot; ? &quot;false&quot; : &quot;true&quot;;</span>
<a href="#l10.47"></a><span id="l10.47">   cmd.setAttribute(&quot;checked&quot;, newValue);</span>
<a href="#l10.48"></a><span id="l10.48"> </span>
<a href="#l10.49"></a><span id="l10.49">   let deck = getViewDeck();</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineminus">-  for (let view of deck.childNodes) {</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineplus">+  for (let view of deck.children) {</span>
<a href="#l10.52"></a><span id="l10.52">     view.workdaysOnly = newValue == &quot;true&quot;;</span>
<a href="#l10.53"></a><span id="l10.53">   }</span>
<a href="#l10.54"></a><span id="l10.54"> </span>
<a href="#l10.55"></a><span id="l10.55">   // Refresh the current view</span>
<a href="#l10.56"></a><span id="l10.56">   currentView().goToDay();</span>
<a href="#l10.57"></a><span id="l10.57"> }</span>
<a href="#l10.58"></a><span id="l10.58"> </span>
<a href="#l10.59"></a><span id="l10.59"> /**</span>
<a href="#l10.60"></a><span id="l10.60">  * Toggle the tasks in view checkbox and refresh the current view</span>
<a href="#l10.61"></a><span id="l10.61">  */</span>
<a href="#l10.62"></a><span id="l10.62"> function toggleTasksInView() {</span>
<a href="#l10.63"></a><span id="l10.63">   let cmd = document.getElementById(&quot;calendar_toggle_tasks_in_view_command&quot;);</span>
<a href="#l10.64"></a><span id="l10.64">   let newValue = cmd.getAttribute(&quot;checked&quot;) == &quot;true&quot; ? &quot;false&quot; : &quot;true&quot;;</span>
<a href="#l10.65"></a><span id="l10.65">   cmd.setAttribute(&quot;checked&quot;, newValue);</span>
<a href="#l10.66"></a><span id="l10.66"> </span>
<a href="#l10.67"></a><span id="l10.67">   let deck = getViewDeck();</span>
<a href="#l10.68"></a><span id="l10.68" class="difflineminus">-  for (let view of deck.childNodes) {</span>
<a href="#l10.69"></a><span id="l10.69" class="difflineplus">+  for (let view of deck.children) {</span>
<a href="#l10.70"></a><span id="l10.70">     view.tasksInView = newValue == &quot;true&quot;;</span>
<a href="#l10.71"></a><span id="l10.71">   }</span>
<a href="#l10.72"></a><span id="l10.72"> </span>
<a href="#l10.73"></a><span id="l10.73">   // Refresh the current view</span>
<a href="#l10.74"></a><span id="l10.74">   currentView().goToDay();</span>
<a href="#l10.75"></a><span id="l10.75"> }</span>
<a href="#l10.76"></a><span id="l10.76"> </span>
<a href="#l10.77"></a><span id="l10.77"> /**</span>
<a href="#l10.78"></a><span id="l10.78">  * Toggle the show completed in view checkbox and refresh the current view</span>
<a href="#l10.79"></a><span id="l10.79">  */</span>
<a href="#l10.80"></a><span id="l10.80"> function toggleShowCompletedInView() {</span>
<a href="#l10.81"></a><span id="l10.81">   let cmd = document.getElementById(&quot;calendar_toggle_show_completed_in_view_command&quot;);</span>
<a href="#l10.82"></a><span id="l10.82">   let newValue = cmd.getAttribute(&quot;checked&quot;) == &quot;true&quot; ? &quot;false&quot; : &quot;true&quot;;</span>
<a href="#l10.83"></a><span id="l10.83">   cmd.setAttribute(&quot;checked&quot;, newValue);</span>
<a href="#l10.84"></a><span id="l10.84"> </span>
<a href="#l10.85"></a><span id="l10.85">   let deck = getViewDeck();</span>
<a href="#l10.86"></a><span id="l10.86" class="difflineminus">-  for (let view of deck.childNodes) {</span>
<a href="#l10.87"></a><span id="l10.87" class="difflineplus">+  for (let view of deck.children) {</span>
<a href="#l10.88"></a><span id="l10.88">     view.showCompleted = newValue == &quot;true&quot;;</span>
<a href="#l10.89"></a><span id="l10.89">   }</span>
<a href="#l10.90"></a><span id="l10.90"> </span>
<a href="#l10.91"></a><span id="l10.91">   // Refresh the current view</span>
<a href="#l10.92"></a><span id="l10.92">   currentView().goToDay();</span>
<a href="#l10.93"></a><span id="l10.93"> }</span>
<a href="#l10.94"></a><span id="l10.94"> </span>
<a href="#l10.95"></a><span id="l10.95"> /**</span>
<a href="#l10.96"></a><span id="l10.96" class="difflineat">@@ -509,17 +509,17 @@ function goToDate(date) {</span>
<a href="#l10.97"></a><span id="l10.97"> function getLastCalendarView() {</span>
<a href="#l10.98"></a><span id="l10.98">   if (Services.xulStore.hasValue(document.location.href, &quot;view-deck&quot;, &quot;selectedIndex&quot;)) {</span>
<a href="#l10.99"></a><span id="l10.99">     let deck = getViewDeck();</span>
<a href="#l10.100"></a><span id="l10.100">     let selectedIndex = Services.xulStore.getValue(</span>
<a href="#l10.101"></a><span id="l10.101">       document.location.href,</span>
<a href="#l10.102"></a><span id="l10.102">       &quot;view-deck&quot;,</span>
<a href="#l10.103"></a><span id="l10.103">       &quot;selectedIndex&quot;</span>
<a href="#l10.104"></a><span id="l10.104">     );</span>
<a href="#l10.105"></a><span id="l10.105" class="difflineminus">-    let viewNode = deck.childNodes[selectedIndex];</span>
<a href="#l10.106"></a><span id="l10.106" class="difflineplus">+    let viewNode = deck.children[selectedIndex];</span>
<a href="#l10.107"></a><span id="l10.107">     return viewNode.id.replace(/-view/, &quot;&quot;);</span>
<a href="#l10.108"></a><span id="l10.108">   }</span>
<a href="#l10.109"></a><span id="l10.109"> </span>
<a href="#l10.110"></a><span id="l10.110">   // No deck item was selected beforehand, default to week view.</span>
<a href="#l10.111"></a><span id="l10.111">   return &quot;week&quot;;</span>
<a href="#l10.112"></a><span id="l10.112"> }</span>
<a href="#l10.113"></a><span id="l10.113"> </span>
<a href="#l10.114"></a><span id="l10.114"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-alarm-dialog.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-alarm-dialog.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -75,17 +75,17 @@ function onDismissAlarm(event) {</span>
<a href="#l11.4"></a><span id="l11.4">  */</span>
<a href="#l11.5"></a><span id="l11.5"> function onDismissAllAlarms() {</span>
<a href="#l11.6"></a><span id="l11.6">   // removes widgets on the fly:</span>
<a href="#l11.7"></a><span id="l11.7">   let alarmRichlist = document.getElementById(&quot;alarm-richlist&quot;);</span>
<a href="#l11.8"></a><span id="l11.8">   let parentItems = {};</span>
<a href="#l11.9"></a><span id="l11.9">   let widgets = [];</span>
<a href="#l11.10"></a><span id="l11.10"> </span>
<a href="#l11.11"></a><span id="l11.11">   // Make a copy of the child nodes as they get modified live</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-  for (let node of alarmRichlist.childNodes) {</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+  for (let node of alarmRichlist.children) {</span>
<a href="#l11.14"></a><span id="l11.14">     // Check if the node is a valid alarm and is still part of DOM</span>
<a href="#l11.15"></a><span id="l11.15">     if (</span>
<a href="#l11.16"></a><span id="l11.16">       node.parentNode &amp;&amp;</span>
<a href="#l11.17"></a><span id="l11.17">       node.item &amp;&amp;</span>
<a href="#l11.18"></a><span id="l11.18">       node.alarm &amp;&amp;</span>
<a href="#l11.19"></a><span id="l11.19">       !(node.item.parentItem.hashId in parentItems)</span>
<a href="#l11.20"></a><span id="l11.20">     ) {</span>
<a href="#l11.21"></a><span id="l11.21">       // We only need to acknowledge one occurrence for repeating items</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineat">@@ -139,17 +139,17 @@ function setupWindow() {</span>
<a href="#l11.23"></a><span id="l11.23"> </span>
<a href="#l11.24"></a><span id="l11.24"> /**</span>
<a href="#l11.25"></a><span id="l11.25">  * Unload function for the alarm dialog. If applicable, snooze the remaining</span>
<a href="#l11.26"></a><span id="l11.26">  * alarms and clean up the relative date update timer.</span>
<a href="#l11.27"></a><span id="l11.27">  */</span>
<a href="#l11.28"></a><span id="l11.28"> function finishWindow() {</span>
<a href="#l11.29"></a><span id="l11.29">   let alarmRichlist = document.getElementById(&quot;alarm-richlist&quot;);</span>
<a href="#l11.30"></a><span id="l11.30"> </span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-  if (alarmRichlist.childNodes.length &gt; 0) {</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+  if (alarmRichlist.children.length &gt; 0) {</span>
<a href="#l11.33"></a><span id="l11.33">     // If there are still items, the window wasn't closed using dismiss</span>
<a href="#l11.34"></a><span id="l11.34">     // all/snooze all. This can happen when the closer is clicked or escape</span>
<a href="#l11.35"></a><span id="l11.35">     // is pressed. Snooze all remaining items using the default snooze</span>
<a href="#l11.36"></a><span id="l11.36">     // property.</span>
<a href="#l11.37"></a><span id="l11.37">     let snoozePref = Services.prefs.getIntPref(&quot;calendar.alarms.defaultsnoozelength&quot;, 0);</span>
<a href="#l11.38"></a><span id="l11.38">     if (snoozePref &lt;= 0) {</span>
<a href="#l11.39"></a><span id="l11.39">       snoozePref = 5;</span>
<a href="#l11.40"></a><span id="l11.40">     }</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineat">@@ -170,17 +170,17 @@ function onFocusWindow() {</span>
<a href="#l11.42"></a><span id="l11.42">   }</span>
<a href="#l11.43"></a><span id="l11.43"> }</span>
<a href="#l11.44"></a><span id="l11.44"> </span>
<a href="#l11.45"></a><span id="l11.45"> /**</span>
<a href="#l11.46"></a><span id="l11.46">  * Timer callback to update all relative date labels</span>
<a href="#l11.47"></a><span id="l11.47">  */</span>
<a href="#l11.48"></a><span id="l11.48"> function updateRelativeDates() {</span>
<a href="#l11.49"></a><span id="l11.49">   let alarmRichlist = document.getElementById(&quot;alarm-richlist&quot;);</span>
<a href="#l11.50"></a><span id="l11.50" class="difflineminus">-  for (let node of alarmRichlist.childNodes) {</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineplus">+  for (let node of alarmRichlist.children) {</span>
<a href="#l11.52"></a><span id="l11.52">     if (node.item &amp;&amp; node.alarm) {</span>
<a href="#l11.53"></a><span id="l11.53">       node.updateRelativeDateLabel();</span>
<a href="#l11.54"></a><span id="l11.54">     }</span>
<a href="#l11.55"></a><span id="l11.55">   }</span>
<a href="#l11.56"></a><span id="l11.56"> }</span>
<a href="#l11.57"></a><span id="l11.57"> </span>
<a href="#l11.58"></a><span id="l11.58"> /**</span>
<a href="#l11.59"></a><span id="l11.59">  * Function to snooze all alarms the given number of minutes.</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineat">@@ -193,34 +193,34 @@ function snoozeAllItems(aDurationMinutes</span>
<a href="#l11.61"></a><span id="l11.61">     // we prevent snoozing too far if the alarm wouldn't be displayed</span>
<a href="#l11.62"></a><span id="l11.62">     return;</span>
<a href="#l11.63"></a><span id="l11.63">   }</span>
<a href="#l11.64"></a><span id="l11.64"> </span>
<a href="#l11.65"></a><span id="l11.65">   let alarmRichlist = document.getElementById(&quot;alarm-richlist&quot;);</span>
<a href="#l11.66"></a><span id="l11.66">   let parentItems = {};</span>
<a href="#l11.67"></a><span id="l11.67"> </span>
<a href="#l11.68"></a><span id="l11.68">   // Make a copy of the child nodes as they get modified live</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineminus">-  for (let node of alarmRichlist.childNodes) {</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineplus">+  for (let node of alarmRichlist.children) {</span>
<a href="#l11.71"></a><span id="l11.71">     // Check if the node is a valid alarm and is still part of DOM</span>
<a href="#l11.72"></a><span id="l11.72">     if (</span>
<a href="#l11.73"></a><span id="l11.73">       node.parentNode &amp;&amp;</span>
<a href="#l11.74"></a><span id="l11.74">       node.item &amp;&amp;</span>
<a href="#l11.75"></a><span id="l11.75">       node.alarm &amp;&amp;</span>
<a href="#l11.76"></a><span id="l11.76">       cal.acl.isCalendarWritable(node.item.calendar) &amp;&amp;</span>
<a href="#l11.77"></a><span id="l11.77">       cal.acl.userCanModifyItem(node.item) &amp;&amp;</span>
<a href="#l11.78"></a><span id="l11.78">       !(node.item.parentItem.hashId in parentItems)</span>
<a href="#l11.79"></a><span id="l11.79">     ) {</span>
<a href="#l11.80"></a><span id="l11.80">       // We only need to acknowledge one occurrence for repeating items</span>
<a href="#l11.81"></a><span id="l11.81">       parentItems[node.item.parentItem.hashId] = node.item.parentItem;</span>
<a href="#l11.82"></a><span id="l11.82">       getAlarmService().snoozeAlarm(node.item, node.alarm, duration);</span>
<a href="#l11.83"></a><span id="l11.83">     }</span>
<a href="#l11.84"></a><span id="l11.84">   }</span>
<a href="#l11.85"></a><span id="l11.85">   // we need to close the widget here explicitly because the dialog will stay</span>
<a href="#l11.86"></a><span id="l11.86">   // opened if there a still not snoozable alarms</span>
<a href="#l11.87"></a><span id="l11.87" class="difflineminus">-  document.getElementById(&quot;alarm-snooze-all-button&quot;).firstChild.hidePopup();</span>
<a href="#l11.88"></a><span id="l11.88" class="difflineplus">+  document.getElementById(&quot;alarm-snooze-all-button&quot;).firstElementChild.hidePopup();</span>
<a href="#l11.89"></a><span id="l11.89"> }</span>
<a href="#l11.90"></a><span id="l11.90"> </span>
<a href="#l11.91"></a><span id="l11.91"> /**</span>
<a href="#l11.92"></a><span id="l11.92">  * Receive a calIDuration object for a given number of minutes</span>
<a href="#l11.93"></a><span id="l11.93">  *</span>
<a href="#l11.94"></a><span id="l11.94">  * @param  {long}           aMinutes     The number of minutes</span>
<a href="#l11.95"></a><span id="l11.95">  * @return {calIDuration}</span>
<a href="#l11.96"></a><span id="l11.96">  */</span>
<a href="#l11.97"></a><span id="l11.97" class="difflineat">@@ -261,17 +261,17 @@ function aboveSnoozeLimit(aDuration) {</span>
<a href="#l11.98"></a><span id="l11.98">   return false;</span>
<a href="#l11.99"></a><span id="l11.99"> }</span>
<a href="#l11.100"></a><span id="l11.100"> </span>
<a href="#l11.101"></a><span id="l11.101"> /**</span>
<a href="#l11.102"></a><span id="l11.102">  * Sets up the window title, counting the number of alarms in the window.</span>
<a href="#l11.103"></a><span id="l11.103">  */</span>
<a href="#l11.104"></a><span id="l11.104"> function setupTitle() {</span>
<a href="#l11.105"></a><span id="l11.105">   let alarmRichlist = document.getElementById(&quot;alarm-richlist&quot;);</span>
<a href="#l11.106"></a><span id="l11.106" class="difflineminus">-  let reminders = alarmRichlist.childNodes.length;</span>
<a href="#l11.107"></a><span id="l11.107" class="difflineplus">+  let reminders = alarmRichlist.children.length;</span>
<a href="#l11.108"></a><span id="l11.108"> </span>
<a href="#l11.109"></a><span id="l11.109">   let title = PluralForm.get(reminders, cal.l10n.getCalString(&quot;alarmWindowTitle.label&quot;));</span>
<a href="#l11.110"></a><span id="l11.110">   document.title = title.replace(&quot;#1&quot;, reminders);</span>
<a href="#l11.111"></a><span id="l11.111"> }</span>
<a href="#l11.112"></a><span id="l11.112"> </span>
<a href="#l11.113"></a><span id="l11.113"> /**</span>
<a href="#l11.114"></a><span id="l11.114">  * Comparison function for the start date of a calendar item and</span>
<a href="#l11.115"></a><span id="l11.115">  * the start date of a calendar-alarm-widget.</span>
<a href="#l11.116"></a><span id="l11.116" class="difflineat">@@ -335,29 +335,29 @@ function addWidgetFor(aItem, aAlarm) {</span>
<a href="#l11.117"></a><span id="l11.117">  * Remove the alarm widget for the passed alarm and item.</span>
<a href="#l11.118"></a><span id="l11.118">  *</span>
<a href="#l11.119"></a><span id="l11.119">  * @param aItem       The calendar item to remove the alarm widget for.</span>
<a href="#l11.120"></a><span id="l11.120">  * @param aAlarm      The alarm to remove the widget for.</span>
<a href="#l11.121"></a><span id="l11.121">  */</span>
<a href="#l11.122"></a><span id="l11.122"> function removeWidgetFor(aItem, aAlarm) {</span>
<a href="#l11.123"></a><span id="l11.123">   let hashId = aItem.hashId;</span>
<a href="#l11.124"></a><span id="l11.124">   let alarmRichlist = document.getElementById(&quot;alarm-richlist&quot;);</span>
<a href="#l11.125"></a><span id="l11.125" class="difflineminus">-  let nodes = alarmRichlist.childNodes;</span>
<a href="#l11.126"></a><span id="l11.126" class="difflineplus">+  let nodes = alarmRichlist.children;</span>
<a href="#l11.127"></a><span id="l11.127">   let notfound = true;</span>
<a href="#l11.128"></a><span id="l11.128">   for (let i = nodes.length - 1; notfound &amp;&amp; i &gt;= 0; --i) {</span>
<a href="#l11.129"></a><span id="l11.129">     let widget = nodes[i];</span>
<a href="#l11.130"></a><span id="l11.130">     if (</span>
<a href="#l11.131"></a><span id="l11.131">       widget.item &amp;&amp;</span>
<a href="#l11.132"></a><span id="l11.132">       widget.item.hashId == hashId &amp;&amp;</span>
<a href="#l11.133"></a><span id="l11.133">       widget.alarm &amp;&amp;</span>
<a href="#l11.134"></a><span id="l11.134">       widget.alarm.icalString == aAlarm.icalString</span>
<a href="#l11.135"></a><span id="l11.135">     ) {</span>
<a href="#l11.136"></a><span id="l11.136">       if (widget.selected) {</span>
<a href="#l11.137"></a><span id="l11.137">         // Advance selection if needed</span>
<a href="#l11.138"></a><span id="l11.138" class="difflineminus">-        widget.control.selectedItem = widget.previousSibling || widget.nextSibling;</span>
<a href="#l11.139"></a><span id="l11.139" class="difflineplus">+        widget.control.selectedItem = widget.previousElementSibling || widget.nextElementSibling;</span>
<a href="#l11.140"></a><span id="l11.140">       }</span>
<a href="#l11.141"></a><span id="l11.141"> </span>
<a href="#l11.142"></a><span id="l11.142">       widget.removeEventListener(&quot;snooze&quot;, onSnoozeAlarm);</span>
<a href="#l11.143"></a><span id="l11.143">       widget.removeEventListener(&quot;dismiss&quot;, onDismissAlarm);</span>
<a href="#l11.144"></a><span id="l11.144">       widget.removeEventListener(&quot;itemdetails&quot;, onItemDetails);</span>
<a href="#l11.145"></a><span id="l11.145"> </span>
<a href="#l11.146"></a><span id="l11.146">       widget.remove();</span>
<a href="#l11.147"></a><span id="l11.147">       doReadOnlyChecks();</span>
<a href="#l11.148"></a><span id="l11.148" class="difflineat">@@ -374,25 +374,25 @@ function removeWidgetFor(aItem, aAlarm) </span>
<a href="#l11.149"></a><span id="l11.149"> /**</span>
<a href="#l11.150"></a><span id="l11.150">  * Enables/disables the 'snooze all' button and displays or removes a r/o</span>
<a href="#l11.151"></a><span id="l11.151">  * notification based on the readability of the calendars of the alarms visible</span>
<a href="#l11.152"></a><span id="l11.152">  * in the alarm list</span>
<a href="#l11.153"></a><span id="l11.153">  */</span>
<a href="#l11.154"></a><span id="l11.154"> function doReadOnlyChecks() {</span>
<a href="#l11.155"></a><span id="l11.155">   let countRO = 0;</span>
<a href="#l11.156"></a><span id="l11.156">   let alarmRichlist = document.getElementById(&quot;alarm-richlist&quot;);</span>
<a href="#l11.157"></a><span id="l11.157" class="difflineminus">-  for (let node of alarmRichlist.childNodes) {</span>
<a href="#l11.158"></a><span id="l11.158" class="difflineplus">+  for (let node of alarmRichlist.children) {</span>
<a href="#l11.159"></a><span id="l11.159">     if (!cal.acl.isCalendarWritable(node.item.calendar) || !cal.acl.userCanModifyItem(node.item)) {</span>
<a href="#l11.160"></a><span id="l11.160">       countRO++;</span>
<a href="#l11.161"></a><span id="l11.161">     }</span>
<a href="#l11.162"></a><span id="l11.162">   }</span>
<a href="#l11.163"></a><span id="l11.163"> </span>
<a href="#l11.164"></a><span id="l11.164">   // we disable the button if there are only alarms for not-writable items</span>
<a href="#l11.165"></a><span id="l11.165">   let snoozeAllButton = document.getElementById(&quot;alarm-snooze-all-button&quot;);</span>
<a href="#l11.166"></a><span id="l11.166" class="difflineminus">-  snoozeAllButton.disabled = countRO &amp;&amp; countRO == alarmRichlist.childNodes.length;</span>
<a href="#l11.167"></a><span id="l11.167" class="difflineplus">+  snoozeAllButton.disabled = countRO &amp;&amp; countRO == alarmRichlist.children.length;</span>
<a href="#l11.168"></a><span id="l11.168">   if (snoozeAllButton.disabled) {</span>
<a href="#l11.169"></a><span id="l11.169">     let tooltip = cal.l10n.getString(&quot;calendar-alarms&quot;, &quot;reminderDisabledSnoozeButtonTooltip&quot;);</span>
<a href="#l11.170"></a><span id="l11.170">     snoozeAllButton.setAttribute(&quot;tooltiptext&quot;, tooltip);</span>
<a href="#l11.171"></a><span id="l11.171">   } else {</span>
<a href="#l11.172"></a><span id="l11.172">     snoozeAllButton.removeAttribute(&quot;tooltiptext&quot;);</span>
<a href="#l11.173"></a><span id="l11.173">   }</span>
<a href="#l11.174"></a><span id="l11.174"> </span>
<a href="#l11.175"></a><span id="l11.175">   let notification = gNotification.notificationbox.getNotificationWithValue(&quot;calendar-readonly&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -237,17 +237,17 @@ function matchCustomReminderToMenuitem(r</span>
<a href="#l12.4"></a><span id="l12.4">     }</span>
<a href="#l12.5"></a><span id="l12.5"> </span>
<a href="#l12.6"></a><span id="l12.6">     let unitMap = {</span>
<a href="#l12.7"></a><span id="l12.7">       days: 86400,</span>
<a href="#l12.8"></a><span id="l12.8">       hours: 3600,</span>
<a href="#l12.9"></a><span id="l12.9">       minutes: 60,</span>
<a href="#l12.10"></a><span id="l12.10">     };</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-    for (let menuitem of reminderPopup.childNodes) {</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+    for (let menuitem of reminderPopup.children) {</span>
<a href="#l12.14"></a><span id="l12.14">       if (</span>
<a href="#l12.15"></a><span id="l12.15">         menuitem.localName == &quot;menuitem&quot; &amp;&amp;</span>
<a href="#l12.16"></a><span id="l12.16">         menuitem.hasAttribute(&quot;length&quot;) &amp;&amp;</span>
<a href="#l12.17"></a><span id="l12.17">         menuitem.getAttribute(&quot;origin&quot;) == origin &amp;&amp;</span>
<a href="#l12.18"></a><span id="l12.18">         menuitem.getAttribute(&quot;relation&quot;) == relation</span>
<a href="#l12.19"></a><span id="l12.19">       ) {</span>
<a href="#l12.20"></a><span id="l12.20">         let unitMult = unitMap[menuitem.getAttribute(&quot;unit&quot;)] || 1;</span>
<a href="#l12.21"></a><span id="l12.21">         let length = menuitem.getAttribute(&quot;length&quot;) * unitMult;</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineat">@@ -577,17 +577,17 @@ function setupAttendees() {</span>
<a href="#l12.23"></a><span id="l12.23">     let attCount = 0;</span>
<a href="#l12.24"></a><span id="l12.24">     while (attBox.getElementsByClassName(&quot;item-attendees-row&quot;).length &lt; maxRows) {</span>
<a href="#l12.25"></a><span id="l12.25">       let newRow = clonedRow.cloneNode(false);</span>
<a href="#l12.26"></a><span id="l12.26">       let row = attBox.appendChild(newRow);</span>
<a href="#l12.27"></a><span id="l12.27">       row.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l12.28"></a><span id="l12.28">       let rowCount = attBox.getElementsByClassName(&quot;item-attendees-row&quot;).length;</span>
<a href="#l12.29"></a><span id="l12.29">       let reqAtt = rowCount == maxRows ? inLastRow : inRow;</span>
<a href="#l12.30"></a><span id="l12.30">       // we add as many attendee cells as required</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-      while (row.childNodes.length &lt; reqAtt) {</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+      while (row.children.length &lt; reqAtt) {</span>
<a href="#l12.33"></a><span id="l12.33">         let newCell = clonedCell.cloneNode(true);</span>
<a href="#l12.34"></a><span id="l12.34">         let cell = row.appendChild(newCell);</span>
<a href="#l12.35"></a><span id="l12.35">         let icon = cell.getElementsByTagName(&quot;img&quot;)[0];</span>
<a href="#l12.36"></a><span id="l12.36">         let text = cell.getElementsByTagName(&quot;label&quot;)[0];</span>
<a href="#l12.37"></a><span id="l12.37">         let attendee = window.attendees[attCount];</span>
<a href="#l12.38"></a><span id="l12.38"> </span>
<a href="#l12.39"></a><span id="l12.39">         let label =</span>
<a href="#l12.40"></a><span id="l12.40">           attendee.commonName &amp;&amp; attendee.commonName.length</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineat">@@ -633,17 +633,17 @@ function setupAttendees() {</span>
<a href="#l12.42"></a><span id="l12.42">         }</span>
<a href="#l12.43"></a><span id="l12.43"> </span>
<a href="#l12.44"></a><span id="l12.44">         text.setAttribute(&quot;value&quot;, label);</span>
<a href="#l12.45"></a><span id="l12.45">         cell.setAttribute(&quot;tooltiptext&quot;, tooltip);</span>
<a href="#l12.46"></a><span id="l12.46">         attCount++;</span>
<a href="#l12.47"></a><span id="l12.47">       }</span>
<a href="#l12.48"></a><span id="l12.48">       // we fill the row with placeholders if required</span>
<a href="#l12.49"></a><span id="l12.49">       if (attBox.getElementsByClassName(&quot;item-attendees-row&quot;).length &gt; 1 &amp;&amp; inRow &gt; 1) {</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineminus">-        while (row.childNodes.length &lt; inRow) {</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineplus">+        while (row.children.length &lt; inRow) {</span>
<a href="#l12.52"></a><span id="l12.52">           let newSpacer = clonedSpacer.cloneNode(true);</span>
<a href="#l12.53"></a><span id="l12.53">           newSpacer.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l12.54"></a><span id="l12.54">           row.appendChild(newSpacer);</span>
<a href="#l12.55"></a><span id="l12.55">         }</span>
<a href="#l12.56"></a><span id="l12.56">       }</span>
<a href="#l12.57"></a><span id="l12.57">     }</span>
<a href="#l12.58"></a><span id="l12.58"> </span>
<a href="#l12.59"></a><span id="l12.59">     // determining of the max width of an attendee label - this needs to</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-attendees-custom-elements.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-attendees-custom-elements.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -40,17 +40,17 @@</span>
<a href="#l13.4"></a><span id="l13.4">      * @param {Number} val       New zoom factor</span>
<a href="#l13.5"></a><span id="l13.5">      * @returns {Number}         New zoom factor</span>
<a href="#l13.6"></a><span id="l13.6">      */</span>
<a href="#l13.7"></a><span id="l13.7">     set zoomFactor(val) {</span>
<a href="#l13.8"></a><span id="l13.8">       this.mZoomFactor = val;</span>
<a href="#l13.9"></a><span id="l13.9"> </span>
<a href="#l13.10"></a><span id="l13.10">       let template = this.getElementsByTagName(&quot;calendar-event-freebusy-day&quot;)[0];</span>
<a href="#l13.11"></a><span id="l13.11">       let parent = template.parentNode;</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-      while (parent.childNodes.length &gt; 1) {</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+      while (parent.children.length &gt; 1) {</span>
<a href="#l13.14"></a><span id="l13.14">         parent.lastChild.remove();</span>
<a href="#l13.15"></a><span id="l13.15">       }</span>
<a href="#l13.16"></a><span id="l13.16"> </span>
<a href="#l13.17"></a><span id="l13.17">       template.force24Hours = this.mForce24Hours;</span>
<a href="#l13.18"></a><span id="l13.18">       template.zoomFactor = this.mZoomFactor;</span>
<a href="#l13.19"></a><span id="l13.19"> </span>
<a href="#l13.20"></a><span id="l13.20">       return val;</span>
<a href="#l13.21"></a><span id="l13.21">     }</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -74,17 +74,17 @@</span>
<a href="#l13.23"></a><span id="l13.23">      */</span>
<a href="#l13.24"></a><span id="l13.24">     set force24Hours(val) {</span>
<a href="#l13.25"></a><span id="l13.25">       this.mForce24Hours = val;</span>
<a href="#l13.26"></a><span id="l13.26">       this.initTimeRange();</span>
<a href="#l13.27"></a><span id="l13.27"> </span>
<a href="#l13.28"></a><span id="l13.28">       let template = this.getElementsByTagName(&quot;calendar-event-freebusy-day&quot;)[0];</span>
<a href="#l13.29"></a><span id="l13.29"> </span>
<a href="#l13.30"></a><span id="l13.30">       let parent = template.parentNode;</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-      while (parent.childNodes.length &gt; 1) {</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+      while (parent.children.length &gt; 1) {</span>
<a href="#l13.33"></a><span id="l13.33">         parent.lastChild.remove();</span>
<a href="#l13.34"></a><span id="l13.34">       }</span>
<a href="#l13.35"></a><span id="l13.35"> </span>
<a href="#l13.36"></a><span id="l13.36">       template.force24Hours = this.mForce24Hours;</span>
<a href="#l13.37"></a><span id="l13.37">       template.zoomFactor = this.mZoomFactor;</span>
<a href="#l13.38"></a><span id="l13.38"> </span>
<a href="#l13.39"></a><span id="l13.39">       return val;</span>
<a href="#l13.40"></a><span id="l13.40">     }</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineat">@@ -100,17 +100,19 @@</span>
<a href="#l13.42"></a><span id="l13.42"> </span>
<a href="#l13.43"></a><span id="l13.43">     /**</span>
<a href="#l13.44"></a><span id="l13.44">      * Gets the difference between the x coordinate of the first two freebusy-day elements.</span>
<a href="#l13.45"></a><span id="l13.45">      *</span>
<a href="#l13.46"></a><span id="l13.46">      * @returns {Number}       X coordinate difference value</span>
<a href="#l13.47"></a><span id="l13.47">      */</span>
<a href="#l13.48"></a><span id="l13.48">     get contentWidth() {</span>
<a href="#l13.49"></a><span id="l13.49">       let template = this.getElementsByTagName(&quot;calendar-event-freebusy-day&quot;)[0];</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineminus">-      return template.nextSibling.getBoundingClientRect().x - template.getBoundingClientRect().x;</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+      return (</span>
<a href="#l13.52"></a><span id="l13.52" class="difflineplus">+        template.nextElementSibling.getBoundingClientRect().x - template.getBoundingClientRect().x</span>
<a href="#l13.53"></a><span id="l13.53" class="difflineplus">+      );</span>
<a href="#l13.54"></a><span id="l13.54">     }</span>
<a href="#l13.55"></a><span id="l13.55"> </span>
<a href="#l13.56"></a><span id="l13.56">     /**</span>
<a href="#l13.57"></a><span id="l13.57">      * Gets parent node's width.</span>
<a href="#l13.58"></a><span id="l13.58">      *</span>
<a href="#l13.59"></a><span id="l13.59">      * @returns {Number}       Parent node's width</span>
<a href="#l13.60"></a><span id="l13.60">      */</span>
<a href="#l13.61"></a><span id="l13.61">     get containerWidth() {</span>
<a href="#l13.62"></a><span id="l13.62" class="difflineat">@@ -165,19 +167,19 @@</span>
<a href="#l13.63"></a><span id="l13.63">      * @param {Number} val       New day offset</span>
<a href="#l13.64"></a><span id="l13.64">      * @returns {Number}         New day offset</span>
<a href="#l13.65"></a><span id="l13.65">      */</span>
<a href="#l13.66"></a><span id="l13.66">     set dayOffset(val) {</span>
<a href="#l13.67"></a><span id="l13.67">       this.mDayOffset = val;</span>
<a href="#l13.68"></a><span id="l13.68">       let container = this.getElementsByTagName(&quot;calendar-event-scroll-container&quot;)[0];</span>
<a href="#l13.69"></a><span id="l13.69">       let date = this.mStartDate.clone();</span>
<a href="#l13.70"></a><span id="l13.70">       date.day += val;</span>
<a href="#l13.71"></a><span id="l13.71" class="difflineminus">-      let numChilds = container.content.childNodes.length;</span>
<a href="#l13.72"></a><span id="l13.72" class="difflineplus">+      let numChilds = container.content.children.length;</span>
<a href="#l13.73"></a><span id="l13.73">       for (let i = 0; i &lt; numChilds; i++) {</span>
<a href="#l13.74"></a><span id="l13.74" class="difflineminus">-        let child = container.content.childNodes[i];</span>
<a href="#l13.75"></a><span id="l13.75" class="difflineplus">+        let child = container.content.children[i];</span>
<a href="#l13.76"></a><span id="l13.76">         child.date = date;</span>
<a href="#l13.77"></a><span id="l13.77">         date.day++;</span>
<a href="#l13.78"></a><span id="l13.78">       }</span>
<a href="#l13.79"></a><span id="l13.79">       return val;</span>
<a href="#l13.80"></a><span id="l13.80">     }</span>
<a href="#l13.81"></a><span id="l13.81"> </span>
<a href="#l13.82"></a><span id="l13.82">     /**</span>
<a href="#l13.83"></a><span id="l13.83">      * Gets the scale of the total shift needed to step one block further.</span>
<a href="#l13.84"></a><span id="l13.84" class="difflineat">@@ -200,17 +202,17 @@</span>
<a href="#l13.85"></a><span id="l13.85">     /**</span>
<a href="#l13.86"></a><span id="l13.86">      * Refreshes calendar-event-scroll-container's children. calendar-event-scroll-container</span>
<a href="#l13.87"></a><span id="l13.87">      * contains date and time labels with regular interval gap.</span>
<a href="#l13.88"></a><span id="l13.88">      */</span>
<a href="#l13.89"></a><span id="l13.89">     refresh() {</span>
<a href="#l13.90"></a><span id="l13.90">       let date = this.mStartDate.clone();</span>
<a href="#l13.91"></a><span id="l13.91">       let template = this.getElementsByTagName(&quot;calendar-event-freebusy-day&quot;)[0];</span>
<a href="#l13.92"></a><span id="l13.92">       let parent = template.parentNode;</span>
<a href="#l13.93"></a><span id="l13.93" class="difflineminus">-      for (let child of parent.childNodes) {</span>
<a href="#l13.94"></a><span id="l13.94" class="difflineplus">+      for (let child of parent.children) {</span>
<a href="#l13.95"></a><span id="l13.95">         child.startDate = this.mStartDate;</span>
<a href="#l13.96"></a><span id="l13.96">         child.endDate = this.mEndDate;</span>
<a href="#l13.97"></a><span id="l13.97">         child.date = date;</span>
<a href="#l13.98"></a><span id="l13.98">         date.day++;</span>
<a href="#l13.99"></a><span id="l13.99">       }</span>
<a href="#l13.100"></a><span id="l13.100">       let offset = this.mDayOffset;</span>
<a href="#l13.101"></a><span id="l13.101">       this.dayOffset = offset;</span>
<a href="#l13.102"></a><span id="l13.102">     }</span>
<a href="#l13.103"></a><span id="l13.103" class="difflineat">@@ -701,17 +703,17 @@</span>
<a href="#l13.104"></a><span id="l13.104">       let newNode = null;</span>
<a href="#l13.105"></a><span id="l13.105"> </span>
<a href="#l13.106"></a><span id="l13.106">       if (listitem1) {</span>
<a href="#l13.107"></a><span id="l13.107">         let newAttendee = this.createAttendee();</span>
<a href="#l13.108"></a><span id="l13.108">         let nextDummy = this.getNextDummyRow();</span>
<a href="#l13.109"></a><span id="l13.109">         newNode = listitem1.cloneNode(true);</span>
<a href="#l13.110"></a><span id="l13.110"> </span>
<a href="#l13.111"></a><span id="l13.111">         if (insertAfter) {</span>
<a href="#l13.112"></a><span id="l13.112" class="difflineminus">-          this.insertBefore(newNode, insertAfter.nextSibling);</span>
<a href="#l13.113"></a><span id="l13.113" class="difflineplus">+          this.insertBefore(newNode, insertAfter.nextElementSibling);</span>
<a href="#l13.114"></a><span id="l13.114">         } else if (nextDummy) {</span>
<a href="#l13.115"></a><span id="l13.115">           this.replaceChild(newNode, nextDummy);</span>
<a href="#l13.116"></a><span id="l13.116">         } else {</span>
<a href="#l13.117"></a><span id="l13.117">           this.appendChild(newNode);</span>
<a href="#l13.118"></a><span id="l13.118">         }</span>
<a href="#l13.119"></a><span id="l13.119"> </span>
<a href="#l13.120"></a><span id="l13.120">         let input = newNode.querySelector(&quot;.textbox-addressingWidget&quot;);</span>
<a href="#l13.121"></a><span id="l13.121">         let roleStatusIcon = newNode.querySelector(&quot;.status-icon&quot;);</span>
<a href="#l13.122"></a><span id="l13.122" class="difflineat">@@ -778,21 +780,21 @@</span>
<a href="#l13.123"></a><span id="l13.123">         let abDir = null;</span>
<a href="#l13.124"></a><span id="l13.124">         try {</span>
<a href="#l13.125"></a><span id="l13.125">           abDir = allAddressBooks.getNext().QueryInterface(Ci.nsIAbDirectory);</span>
<a href="#l13.126"></a><span id="l13.126">         } catch (ex) {</span>
<a href="#l13.127"></a><span id="l13.127">           cal.WARN(&quot;[eventDialog] Error Encountered&quot; + ex);</span>
<a href="#l13.128"></a><span id="l13.128">         }</span>
<a href="#l13.129"></a><span id="l13.129"> </span>
<a href="#l13.130"></a><span id="l13.130">         if (abDir != null &amp;&amp; abDir.supportsMailingLists) {</span>
<a href="#l13.131"></a><span id="l13.131" class="difflineminus">-          let childNodes = abDir.childNodes;</span>
<a href="#l13.132"></a><span id="l13.132" class="difflineminus">-          while (childNodes.hasMoreElements()) {</span>
<a href="#l13.133"></a><span id="l13.133" class="difflineplus">+          let dirs = abDir.childNodes;</span>
<a href="#l13.134"></a><span id="l13.134" class="difflineplus">+          while (dirs.hasMoreElements()) {</span>
<a href="#l13.135"></a><span id="l13.135">             let dir = null;</span>
<a href="#l13.136"></a><span id="l13.136">             try {</span>
<a href="#l13.137"></a><span id="l13.137" class="difflineminus">-              dir = childNodes.getNext().QueryInterface(Ci.nsIAbDirectory);</span>
<a href="#l13.138"></a><span id="l13.138" class="difflineplus">+              dir = dirs.getNext().QueryInterface(Ci.nsIAbDirectory);</span>
<a href="#l13.139"></a><span id="l13.139">             } catch (ex) {</span>
<a href="#l13.140"></a><span id="l13.140">               cal.WARN(&quot;[eventDialog] Error Encountered&quot; + ex);</span>
<a href="#l13.141"></a><span id="l13.141">             }</span>
<a href="#l13.142"></a><span id="l13.142"> </span>
<a href="#l13.143"></a><span id="l13.143">             if (dir &amp;&amp; dir.isMailList &amp;&amp; dir.dirName == entryname) {</span>
<a href="#l13.144"></a><span id="l13.144">               return dir;</span>
<a href="#l13.145"></a><span id="l13.145">             }</span>
<a href="#l13.146"></a><span id="l13.146">           }</span>
<a href="#l13.147"></a><span id="l13.147" class="difflineat">@@ -905,30 +907,30 @@</span>
<a href="#l13.148"></a><span id="l13.148">           if (entries.length &gt; 0) {</span>
<a href="#l13.149"></a><span id="l13.149">             // `mMaxAttendees` holds the count of non-dummy rows, that is, rows</span>
<a href="#l13.150"></a><span id="l13.150">             // which have and icon and an email address or are ready to receive</span>
<a href="#l13.151"></a><span id="l13.151">             // an email address. By the time we get here, a new non-dummy row has</span>
<a href="#l13.152"></a><span id="l13.152">             // already been added, so the mailing list we want to expand is in the</span>
<a href="#l13.153"></a><span id="l13.153">             // row before the last row.</span>
<a href="#l13.154"></a><span id="l13.154">             let currentIndex = this.mMaxAttendees - 2;</span>
<a href="#l13.155"></a><span id="l13.155">             let template = this.querySelector(&quot;.addressingWidgetItem&quot;);</span>
<a href="#l13.156"></a><span id="l13.156" class="difflineminus">-            let currentNode = template.parentNode.childNodes[currentIndex];</span>
<a href="#l13.157"></a><span id="l13.157" class="difflineplus">+            let currentNode = template.parentNode.children[currentIndex];</span>
<a href="#l13.158"></a><span id="l13.158">             this._fillListItemWithEntry(currentNode, entries[0], currentIndex);</span>
<a href="#l13.159"></a><span id="l13.159">             entries.shift();</span>
<a href="#l13.160"></a><span id="l13.160" class="difflineminus">-            let nextNode = template.parentNode.childNodes[currentIndex + 1];</span>
<a href="#l13.161"></a><span id="l13.161" class="difflineplus">+            let nextNode = template.parentNode.children[currentIndex + 1];</span>
<a href="#l13.162"></a><span id="l13.162">             currentIndex++;</span>
<a href="#l13.163"></a><span id="l13.163">             for (let entry of entries) {</span>
<a href="#l13.164"></a><span id="l13.164">               currentNode = template.cloneNode(true);</span>
<a href="#l13.165"></a><span id="l13.165">               template.parentNode.insertBefore(currentNode, nextNode);</span>
<a href="#l13.166"></a><span id="l13.166">               this._fillListItemWithEntry(currentNode, entry, currentIndex);</span>
<a href="#l13.167"></a><span id="l13.167">               currentIndex++;</span>
<a href="#l13.168"></a><span id="l13.168">             }</span>
<a href="#l13.169"></a><span id="l13.169">             this.mMaxAttendees += entries.length;</span>
<a href="#l13.170"></a><span id="l13.170">             for (let i = currentIndex; i &lt; this.mMaxAttendees; i++) {</span>
<a href="#l13.171"></a><span id="l13.171" class="difflineminus">-              let row = template.parentNode.childNodes[i];</span>
<a href="#l13.172"></a><span id="l13.172" class="difflineplus">+              let row = template.parentNode.children[i];</span>
<a href="#l13.173"></a><span id="l13.173">               let textboxInput = row.querySelector(&quot;.textbox-addressingWidget&quot;);</span>
<a href="#l13.174"></a><span id="l13.174">               textboxInput.setAttribute(&quot;dirty&quot;, &quot;true&quot;);</span>
<a href="#l13.175"></a><span id="l13.175">             }</span>
<a href="#l13.176"></a><span id="l13.176">           }</span>
<a href="#l13.177"></a><span id="l13.177">         }</span>
<a href="#l13.178"></a><span id="l13.178">       }</span>
<a href="#l13.179"></a><span id="l13.179">     }</span>
<a href="#l13.180"></a><span id="l13.180"> </span>
<a href="#l13.181"></a><span id="l13.181" class="difflineat">@@ -1037,17 +1039,17 @@</span>
<a href="#l13.182"></a><span id="l13.182"> </span>
<a href="#l13.183"></a><span id="l13.183">     /**</span>
<a href="#l13.184"></a><span id="l13.184">      * Creates or removes dummy rows from the calendar-event-attendees-list.</span>
<a href="#l13.185"></a><span id="l13.185">      */</span>
<a href="#l13.186"></a><span id="l13.186">     createOrRemoveDummyRows() {</span>
<a href="#l13.187"></a><span id="l13.187">       let listboxHeight = this.getBoundingClientRect().height;</span>
<a href="#l13.188"></a><span id="l13.188"> </span>
<a href="#l13.189"></a><span id="l13.189">       // Remove rows to remove scrollbar.</span>
<a href="#l13.190"></a><span id="l13.190" class="difflineminus">-      let kids = this.childNodes;</span>
<a href="#l13.191"></a><span id="l13.191" class="difflineplus">+      let kids = this.children;</span>
<a href="#l13.192"></a><span id="l13.192">       for (let i = kids.length - 1; this.mContentHeight &gt; listboxHeight &amp;&amp; i &gt;= 0; --i) {</span>
<a href="#l13.193"></a><span id="l13.193">         if (kids[i].hasAttribute(&quot;_isDummyRow&quot;)) {</span>
<a href="#l13.194"></a><span id="l13.194">           this.mContentHeight -= this.mRowHeight;</span>
<a href="#l13.195"></a><span id="l13.195">           kids[i].remove();</span>
<a href="#l13.196"></a><span id="l13.196">         }</span>
<a href="#l13.197"></a><span id="l13.197">       }</span>
<a href="#l13.198"></a><span id="l13.198"> </span>
<a href="#l13.199"></a><span id="l13.199">       // Add rows to fill space.</span>
<a href="#l13.200"></a><span id="l13.200" class="difflineat">@@ -1078,17 +1080,17 @@</span>
<a href="#l13.201"></a><span id="l13.201">     }</span>
<a href="#l13.202"></a><span id="l13.202"> </span>
<a href="#l13.203"></a><span id="l13.203">     /**</span>
<a href="#l13.204"></a><span id="l13.204">      * Returns the next dummy row from the top.</span>
<a href="#l13.205"></a><span id="l13.205">      *</span>
<a href="#l13.206"></a><span id="l13.206">      * @return {?Node}       Next row from the top down</span>
<a href="#l13.207"></a><span id="l13.207">      */</span>
<a href="#l13.208"></a><span id="l13.208">     getNextDummyRow() {</span>
<a href="#l13.209"></a><span id="l13.209" class="difflineminus">-      let kids = this.childNodes;</span>
<a href="#l13.210"></a><span id="l13.210" class="difflineplus">+      let kids = this.children;</span>
<a href="#l13.211"></a><span id="l13.211">       for (let i = 0; i &lt; kids.length; ++i) {</span>
<a href="#l13.212"></a><span id="l13.212">         if (kids[i].hasAttribute(&quot;_isDummyRow&quot;)) {</span>
<a href="#l13.213"></a><span id="l13.213">           return kids[i];</span>
<a href="#l13.214"></a><span id="l13.214">         }</span>
<a href="#l13.215"></a><span id="l13.215">       }</span>
<a href="#l13.216"></a><span id="l13.216">       return null;</span>
<a href="#l13.217"></a><span id="l13.217">     }</span>
<a href="#l13.218"></a><span id="l13.218"> </span>
<a href="#l13.219"></a><span id="l13.219" class="difflineat">@@ -1119,17 +1121,17 @@</span>
<a href="#l13.220"></a><span id="l13.220">     getRowByInputElement(element) {</span>
<a href="#l13.221"></a><span id="l13.221">       let row = 0;</span>
<a href="#l13.222"></a><span id="l13.222">       element = element.closest(&quot;richlistitem&quot;);</span>
<a href="#l13.223"></a><span id="l13.223">       if (element) {</span>
<a href="#l13.224"></a><span id="l13.224">         while (element) {</span>
<a href="#l13.225"></a><span id="l13.225">           if (element.localName == &quot;richlistitem&quot;) {</span>
<a href="#l13.226"></a><span id="l13.226">             ++row;</span>
<a href="#l13.227"></a><span id="l13.227">           }</span>
<a href="#l13.228"></a><span id="l13.228" class="difflineminus">-          element = element.previousSibling;</span>
<a href="#l13.229"></a><span id="l13.229" class="difflineplus">+          element = element.previousElementSibling;</span>
<a href="#l13.230"></a><span id="l13.230">         }</span>
<a href="#l13.231"></a><span id="l13.231">       }</span>
<a href="#l13.232"></a><span id="l13.232">       return row;</span>
<a href="#l13.233"></a><span id="l13.233">     }</span>
<a href="#l13.234"></a><span id="l13.234"> </span>
<a href="#l13.235"></a><span id="l13.235">     /**</span>
<a href="#l13.236"></a><span id="l13.236">      * Returns textbox that contains the name of the attendee at row number `row`.</span>
<a href="#l13.237"></a><span id="l13.237">      *</span>
<a href="#l13.238"></a><span id="l13.238" class="difflineat">@@ -1510,18 +1512,18 @@</span>
<a href="#l13.239"></a><span id="l13.239">     /**</span>
<a href="#l13.240"></a><span id="l13.240">      * Gets width of the content.</span>
<a href="#l13.241"></a><span id="l13.241">      *</span>
<a href="#l13.242"></a><span id="l13.242">      * @returns {Number}        Content width</span>
<a href="#l13.243"></a><span id="l13.243">      */</span>
<a href="#l13.244"></a><span id="l13.244">     get contentWidth() {</span>
<a href="#l13.245"></a><span id="l13.245">       // Difference between the x coordinate of first and second child of hours node</span>
<a href="#l13.246"></a><span id="l13.246">       const diffX =</span>
<a href="#l13.247"></a><span id="l13.247" class="difflineminus">-        this.hoursNode.childNodes[1].getBoundingClientRect().x -</span>
<a href="#l13.248"></a><span id="l13.248" class="difflineminus">-        this.hoursNode.childNodes[0].getBoundingClientRect().x;</span>
<a href="#l13.249"></a><span id="l13.249" class="difflineplus">+        this.hoursNode.children[1].getBoundingClientRect().x -</span>
<a href="#l13.250"></a><span id="l13.250" class="difflineplus">+        this.hoursNode.children[0].getBoundingClientRect().x;</span>
<a href="#l13.251"></a><span id="l13.251">       return diffX * this.numHours;</span>
<a href="#l13.252"></a><span id="l13.252">     }</span>
<a href="#l13.253"></a><span id="l13.253"> </span>
<a href="#l13.254"></a><span id="l13.254">     /**</span>
<a href="#l13.255"></a><span id="l13.255">      * Returns width of nearest listbox element.</span>
<a href="#l13.256"></a><span id="l13.256">      *</span>
<a href="#l13.257"></a><span id="l13.257">      * @returns {Number}        Nearest listbox width</span>
<a href="#l13.258"></a><span id="l13.258">      */</span>
<a href="#l13.259"></a><span id="l13.259" class="difflineat">@@ -1560,17 +1562,17 @@</span>
<a href="#l13.260"></a><span id="l13.260">       }</span>
<a href="#l13.261"></a><span id="l13.261">       let step_in_minutes = Math.floor((60 * this.zoomFactor) / 100);</span>
<a href="#l13.262"></a><span id="l13.262">       let formatter = Cc[&quot;@mozilla.org/calendar/datetime-formatter;1&quot;].getService(</span>
<a href="#l13.263"></a><span id="l13.263">         Ci.calIDateTimeFormatter</span>
<a href="#l13.264"></a><span id="l13.264">       );</span>
<a href="#l13.265"></a><span id="l13.265">       let date = cal.dtz.jsDateToDateTime(new Date());</span>
<a href="#l13.266"></a><span id="l13.266">       date.hour = this.startHour;</span>
<a href="#l13.267"></a><span id="l13.267">       date.minute = 0;</span>
<a href="#l13.268"></a><span id="l13.268" class="difflineminus">-      if (this.hoursNode.childNodes.length &lt;= 0) {</span>
<a href="#l13.269"></a><span id="l13.269" class="difflineplus">+      if (this.hoursNode.children.length &lt;= 0) {</span>
<a href="#l13.270"></a><span id="l13.270">         let template = document.createXULElement(&quot;text&quot;);</span>
<a href="#l13.271"></a><span id="l13.271">         template.className = &quot;freebusy-grid&quot;;</span>
<a href="#l13.272"></a><span id="l13.272">         // TODO: hardcoded value</span>
<a href="#l13.273"></a><span id="l13.273">         let num_days = Math.max(2, (4 * this.zoomFactor) / 100);</span>
<a href="#l13.274"></a><span id="l13.274">         let count = Math.ceil(((this.endHour - this.startHour) * 60) / step_in_minutes);</span>
<a href="#l13.275"></a><span id="l13.275">         let remain = count;</span>
<a href="#l13.276"></a><span id="l13.276">         for (let day = 1; day &lt;= num_days; day++) {</span>
<a href="#l13.277"></a><span id="l13.277">           let first = true;</span>
<a href="#l13.278"></a><span id="l13.278" class="difflineat">@@ -1703,18 +1705,18 @@</span>
<a href="#l13.279"></a><span id="l13.279">       }</span>
<a href="#l13.280"></a><span id="l13.280">       this.showState();</span>
<a href="#l13.281"></a><span id="l13.281">     }</span>
<a href="#l13.282"></a><span id="l13.282"> </span>
<a href="#l13.283"></a><span id="l13.283">     /**</span>
<a href="#l13.284"></a><span id="l13.284">      * Maps entries to the attributes of xul elements.</span>
<a href="#l13.285"></a><span id="l13.285">      */</span>
<a href="#l13.286"></a><span id="l13.286">     showState() {</span>
<a href="#l13.287"></a><span id="l13.287" class="difflineminus">-      for (let i = 0; i &lt; this.hoursNode.childNodes.length; i++) {</span>
<a href="#l13.288"></a><span id="l13.288" class="difflineminus">-        let hour = this.hoursNode.childNodes[i];</span>
<a href="#l13.289"></a><span id="l13.289" class="difflineplus">+      for (let i = 0; i &lt; this.hoursNode.children.length; i++) {</span>
<a href="#l13.290"></a><span id="l13.290" class="difflineplus">+        let hour = this.hoursNode.children[i];</span>
<a href="#l13.291"></a><span id="l13.291">         switch (this.state[i + this.offset]) {</span>
<a href="#l13.292"></a><span id="l13.292">           case Ci.calIFreeBusyInterval.FREE:</span>
<a href="#l13.293"></a><span id="l13.293">             hour.setAttribute(&quot;state&quot;, &quot;free&quot;);</span>
<a href="#l13.294"></a><span id="l13.294">             break;</span>
<a href="#l13.295"></a><span id="l13.295">           case Ci.calIFreeBusyInterval.BUSY:</span>
<a href="#l13.296"></a><span id="l13.296">             hour.setAttribute(&quot;state&quot;, &quot;busy&quot;);</span>
<a href="#l13.297"></a><span id="l13.297">             break;</span>
<a href="#l13.298"></a><span id="l13.298">           case Ci.calIFreeBusyInterval.BUSY_TENTATIVE:</span>
<a href="#l13.299"></a><span id="l13.299" class="difflineat">@@ -1955,17 +1957,17 @@</span>
<a href="#l13.300"></a><span id="l13.300">           ? this.dateFormatter.formatDateShort(date)</span>
<a href="#l13.301"></a><span id="l13.301">           : this.dateFormatter.formatDateLong(date);</span>
<a href="#l13.302"></a><span id="l13.302">       this.text.setAttribute(&quot;value&quot;, dateValue);</span>
<a href="#l13.303"></a><span id="l13.303"> </span>
<a href="#l13.304"></a><span id="l13.304">       // Now create as many 'hour' elements as needed</span>
<a href="#l13.305"></a><span id="l13.305">       let step_in_minutes = Math.floor((60 * this.zoomFactor) / 100);</span>
<a href="#l13.306"></a><span id="l13.306">       let hours = this.box;</span>
<a href="#l13.307"></a><span id="l13.307">       date.hour = this.startHour;</span>
<a href="#l13.308"></a><span id="l13.308" class="difflineminus">-      if (hours.childNodes.length &lt;= 0) {</span>
<a href="#l13.309"></a><span id="l13.309" class="difflineplus">+      if (hours.children.length &lt;= 0) {</span>
<a href="#l13.310"></a><span id="l13.310">         let template = document.createXULElement(&quot;text&quot;);</span>
<a href="#l13.311"></a><span id="l13.311">         template.className = &quot;freebusy-timebar-hour&quot;;</span>
<a href="#l13.312"></a><span id="l13.312">         let count = Math.ceil(((this.endHour - this.startHour) * 60) / step_in_minutes);</span>
<a href="#l13.313"></a><span id="l13.313">         let remain = count;</span>
<a href="#l13.314"></a><span id="l13.314">         let first = true;</span>
<a href="#l13.315"></a><span id="l13.315">         while (remain--) {</span>
<a href="#l13.316"></a><span id="l13.316">           let newNode = template.cloneNode(false);</span>
<a href="#l13.317"></a><span id="l13.317">           let value = this.dateFormatter.formatTime(date);</span>
<a href="#l13.318"></a><span id="l13.318" class="difflineat">@@ -2052,17 +2054,17 @@</span>
<a href="#l13.319"></a><span id="l13.319">     /**</span>
<a href="#l13.320"></a><span id="l13.320">      * Returns document fragment containing the children that were wrapped inside</span>
<a href="#l13.321"></a><span id="l13.321">      * calendar-event-scroll-container tag before the execution of connectedCallback.</span>
<a href="#l13.322"></a><span id="l13.322">      */</span>
<a href="#l13.323"></a><span id="l13.323">     _getChildrenFragment() {</span>
<a href="#l13.324"></a><span id="l13.324">       const frag = document.createDocumentFragment();</span>
<a href="#l13.325"></a><span id="l13.325"> </span>
<a href="#l13.326"></a><span id="l13.326">       while (this.hasChildNodes()) {</span>
<a href="#l13.327"></a><span id="l13.327" class="difflineminus">-        frag.appendChild(this.firstChild);</span>
<a href="#l13.328"></a><span id="l13.328" class="difflineplus">+        frag.appendChild(this.firstElementChild);</span>
<a href="#l13.329"></a><span id="l13.329">       }</span>
<a href="#l13.330"></a><span id="l13.330"> </span>
<a href="#l13.331"></a><span id="l13.331">       return frag;</span>
<a href="#l13.332"></a><span id="l13.332">     }</span>
<a href="#l13.333"></a><span id="l13.333"> </span>
<a href="#l13.334"></a><span id="l13.334">     /**</span>
<a href="#l13.335"></a><span id="l13.335">      * Gets inline start margin of calendar-event-scroll-container.</span>
<a href="#l13.336"></a><span id="l13.336">      *</span>
<a href="#l13.337"></a><span id="l13.337" class="difflineat">@@ -3086,17 +3088,17 @@</span>
<a href="#l13.338"></a><span id="l13.338">     }</span>
<a href="#l13.339"></a><span id="l13.339"> </span>
<a href="#l13.340"></a><span id="l13.340">     /**</span>
<a href="#l13.341"></a><span id="l13.341">      * Gets the next row from the top down.</span>
<a href="#l13.342"></a><span id="l13.342">      *</span>
<a href="#l13.343"></a><span id="l13.343">      * @returns {?Element}       Next dummy row or null if there isn't any</span>
<a href="#l13.344"></a><span id="l13.344">      */</span>
<a href="#l13.345"></a><span id="l13.345">     getNextDummyRow() {</span>
<a href="#l13.346"></a><span id="l13.346" class="difflineminus">-      for (let kid of this.childNodes) {</span>
<a href="#l13.347"></a><span id="l13.347" class="difflineplus">+      for (let kid of this.children) {</span>
<a href="#l13.348"></a><span id="l13.348">         if (kid.hasAttribute(&quot;_isDummyRow&quot;)) {</span>
<a href="#l13.349"></a><span id="l13.349">           return kid;</span>
<a href="#l13.350"></a><span id="l13.350">         }</span>
<a href="#l13.351"></a><span id="l13.351">       }</span>
<a href="#l13.352"></a><span id="l13.352">       return null;</span>
<a href="#l13.353"></a><span id="l13.353">     }</span>
<a href="#l13.354"></a><span id="l13.354"> </span>
<a href="#l13.355"></a><span id="l13.355">     /**</span>
<a href="#l13.356"></a><span id="l13.356" class="difflineat">@@ -3127,17 +3129,17 @@</span>
<a href="#l13.357"></a><span id="l13.357"> </span>
<a href="#l13.358"></a><span id="l13.358">     /**</span>
<a href="#l13.359"></a><span id="l13.359">      * Creates or removes dummy rows.</span>
<a href="#l13.360"></a><span id="l13.360">      */</span>
<a href="#l13.361"></a><span id="l13.361">     createOrRemoveDummyRows() {</span>
<a href="#l13.362"></a><span id="l13.362">       let listboxHeight = this.getBoundingClientRect().height;</span>
<a href="#l13.363"></a><span id="l13.363"> </span>
<a href="#l13.364"></a><span id="l13.364">       // Remove rows to remove scrollbar</span>
<a href="#l13.365"></a><span id="l13.365" class="difflineminus">-      let kids = this.childNodes;</span>
<a href="#l13.366"></a><span id="l13.366" class="difflineplus">+      let kids = this.children;</span>
<a href="#l13.367"></a><span id="l13.367">       for (let i = kids.length - 1; this.mContentHeight &gt; listboxHeight &amp;&amp; i &gt;= 0; --i) {</span>
<a href="#l13.368"></a><span id="l13.368">         if (kids[i].hasAttribute(&quot;_isDummyRow&quot;)) {</span>
<a href="#l13.369"></a><span id="l13.369">           this.mContentHeight -= this.mRowHeight;</span>
<a href="#l13.370"></a><span id="l13.370">           kids[i].remove();</span>
<a href="#l13.371"></a><span id="l13.371">         }</span>
<a href="#l13.372"></a><span id="l13.372">       }</span>
<a href="#l13.373"></a><span id="l13.373"> </span>
<a href="#l13.374"></a><span id="l13.374">       // Add rows to fill space</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-attendees.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-attendees.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -1015,17 +1015,17 @@ function onFreebusyTimebarInit() {</span>
<a href="#l14.4"></a><span id="l14.4">   let date = timebar.mStartDate.clone();</span>
<a href="#l14.5"></a><span id="l14.5">   let template = timebar.getElementsByTagName(&quot;calendar-event-freebusy-day&quot;)[0];</span>
<a href="#l14.6"></a><span id="l14.6">   template.force24Hours = timebar.mForce24Hours;</span>
<a href="#l14.7"></a><span id="l14.7">   template.zoomFactor = timebar.mZoomFactor;</span>
<a href="#l14.8"></a><span id="l14.8">   template.startDate = timebar.mStartDate;</span>
<a href="#l14.9"></a><span id="l14.9">   template.endDate = timebar.mEndDate;</span>
<a href="#l14.10"></a><span id="l14.10">   template.date = date;</span>
<a href="#l14.11"></a><span id="l14.11">   let parent = template.parentNode;</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  if (parent.childNodes.length &lt;= 1) {</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+  if (parent.children.length &lt;= 1) {</span>
<a href="#l14.14"></a><span id="l14.14">     let count = timebar.mNumDays - 1;</span>
<a href="#l14.15"></a><span id="l14.15">     if (count &gt; 0) {</span>
<a href="#l14.16"></a><span id="l14.16">       for (let i = 0; i &lt; count; i++) {</span>
<a href="#l14.17"></a><span id="l14.17">         date.day++;</span>
<a href="#l14.18"></a><span id="l14.18">         let newNode = template.cloneNode(false);</span>
<a href="#l14.19"></a><span id="l14.19">         parent.appendChild(newNode);</span>
<a href="#l14.20"></a><span id="l14.20">         newNode.force24Hours = timebar.mForce24Hours;</span>
<a href="#l14.21"></a><span id="l14.21">         newNode.zoomFactor = timebar.mZoomFactor;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -82,61 +82,61 @@ const RecurrencePreview = {</span>
<a href="#l15.4"></a><span id="l15.4">     // this is a simple division which always yields a positive integer value.</span>
<a href="#l15.5"></a><span id="l15.5">     let numVertical = (containerHeight - cHeight) / contentHeight;</span>
<a href="#l15.6"></a><span id="l15.6"> </span>
<a href="#l15.7"></a><span id="l15.7">     // Count the number of existing rows</span>
<a href="#l15.8"></a><span id="l15.8">     let numRows = 0;</span>
<a href="#l15.9"></a><span id="l15.9">     let hboxIterator = hbox;</span>
<a href="#l15.10"></a><span id="l15.10">     while (hboxIterator) {</span>
<a href="#l15.11"></a><span id="l15.11">       numRows++;</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-      hboxIterator = hboxIterator.nextSibling;</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+      hboxIterator = hboxIterator.nextElementSibling;</span>
<a href="#l15.14"></a><span id="l15.14">     }</span>
<a href="#l15.15"></a><span id="l15.15"> </span>
<a href="#l15.16"></a><span id="l15.16">     // Adjust rows</span>
<a href="#l15.17"></a><span id="l15.17">     while (numRows &lt; numVertical) {</span>
<a href="#l15.18"></a><span id="l15.18">       let newNode = hbox.cloneNode(true);</span>
<a href="#l15.19"></a><span id="l15.19">       vbox.appendChild(newNode);</span>
<a href="#l15.20"></a><span id="l15.20">       numRows++;</span>
<a href="#l15.21"></a><span id="l15.21">     }</span>
<a href="#l15.22"></a><span id="l15.22">     while (numRows &gt; numVertical) {</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineminus">-      vbox.firstChild.remove();</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineplus">+      vbox.firstElementChild.remove();</span>
<a href="#l15.25"></a><span id="l15.25">       numRows--;</span>
<a href="#l15.26"></a><span id="l15.26">     }</span>
<a href="#l15.27"></a><span id="l15.27"> </span>
<a href="#l15.28"></a><span id="l15.28">     // Walk all rows and adjust column elements</span>
<a href="#l15.29"></a><span id="l15.29">     hbox = this.node.querySelector(&quot;hbox&quot;);</span>
<a href="#l15.30"></a><span id="l15.30">     while (hbox) {</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-      let firstChild = hbox.firstChild;</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineminus">-      while (hbox.childNodes.length - 1 &lt; numHorizontal) {</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineminus">-        let newNode = firstChild.cloneNode(true);</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineminus">-        firstChild.parentNode.insertBefore(newNode, firstChild);</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineplus">+      let firstElementChild = hbox.firstElementChild;</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineplus">+      while (hbox.children.length - 1 &lt; numHorizontal) {</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+        let newNode = firstElementChild.cloneNode(true);</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+        firstElementChild.parentNode.insertBefore(newNode, firstElementChild);</span>
<a href="#l15.39"></a><span id="l15.39">       }</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineminus">-      while (hbox.childNodes.length - 1 &gt; numHorizontal) {</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineminus">-        hbox.firstChild.remove();</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineplus">+      while (hbox.children.length - 1 &gt; numHorizontal) {</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineplus">+        hbox.firstElementChild.remove();</span>
<a href="#l15.44"></a><span id="l15.44">       }</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineminus">-      hbox = hbox.nextSibling;</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineplus">+      hbox = hbox.nextElementSibling;</span>
<a href="#l15.47"></a><span id="l15.47">     }</span>
<a href="#l15.48"></a><span id="l15.48"> </span>
<a href="#l15.49"></a><span id="l15.49">     this.updateContent();</span>
<a href="#l15.50"></a><span id="l15.50">     this.updatePreview(this.mRecurrenceInfo);</span>
<a href="#l15.51"></a><span id="l15.51">   },</span>
<a href="#l15.52"></a><span id="l15.52">   /**</span>
<a href="#l15.53"></a><span id="l15.53">    * Updates content of #recurrence-preview node.</span>
<a href="#l15.54"></a><span id="l15.54">    */</span>
<a href="#l15.55"></a><span id="l15.55">   updateContent() {</span>
<a href="#l15.56"></a><span id="l15.56">     let date = cal.dtz.dateTimeToJsDate(this.dateTime);</span>
<a href="#l15.57"></a><span id="l15.57">     let hbox = this.node.querySelector(&quot;hbox&quot;);</span>
<a href="#l15.58"></a><span id="l15.58">     while (hbox) {</span>
<a href="#l15.59"></a><span id="l15.59" class="difflineminus">-      let numChilds = hbox.childNodes.length - 1;</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineplus">+      let numChilds = hbox.children.length - 1;</span>
<a href="#l15.61"></a><span id="l15.61">       for (let i = 0; i &lt; numChilds; i++) {</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineminus">-        let minimonth = hbox.childNodes[i];</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineplus">+        let minimonth = hbox.children[i];</span>
<a href="#l15.64"></a><span id="l15.64">         minimonth.showMonth(date);</span>
<a href="#l15.65"></a><span id="l15.65">         date.setMonth(date.getMonth() + 1);</span>
<a href="#l15.66"></a><span id="l15.66">       }</span>
<a href="#l15.67"></a><span id="l15.67" class="difflineminus">-      hbox = hbox.nextSibling;</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineplus">+      hbox = hbox.nextElementSibling;</span>
<a href="#l15.69"></a><span id="l15.69">     }</span>
<a href="#l15.70"></a><span id="l15.70">   },</span>
<a href="#l15.71"></a><span id="l15.71">   /**</span>
<a href="#l15.72"></a><span id="l15.72">    * Updates preview of #recurrence-preview node.</span>
<a href="#l15.73"></a><span id="l15.73">    */</span>
<a href="#l15.74"></a><span id="l15.74">   updatePreview(recurrenceInfo) {</span>
<a href="#l15.75"></a><span id="l15.75">     let minimonth = this.node.querySelector(&quot;calendar-minimonth&quot;);</span>
<a href="#l15.76"></a><span id="l15.76">     this.node.style.minHeight = minimonth.getBoundingClientRect().height + &quot;px&quot;;</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineat">@@ -151,21 +151,21 @@ const RecurrencePreview = {</span>
<a href="#l15.78"></a><span id="l15.78">     end.month++;</span>
<a href="#l15.79"></a><span id="l15.79"> </span>
<a href="#l15.80"></a><span id="l15.80">     // the 'minimonth' controls are arranged in a</span>
<a href="#l15.81"></a><span id="l15.81">     // grid, sorted by rows first -&gt; iterate the rows that may exist.</span>
<a href="#l15.82"></a><span id="l15.82">     let hbox = this.node.querySelector(&quot;hbox&quot;);</span>
<a href="#l15.83"></a><span id="l15.83">     while (hbox) {</span>
<a href="#l15.84"></a><span id="l15.84">       // now iterate all the child nodes of this row</span>
<a href="#l15.85"></a><span id="l15.85">       // in order to visit each minimonth in turn.</span>
<a href="#l15.86"></a><span id="l15.86" class="difflineminus">-      let numChilds = hbox.childNodes.length - 1;</span>
<a href="#l15.87"></a><span id="l15.87" class="difflineplus">+      let numChilds = hbox.children.length - 1;</span>
<a href="#l15.88"></a><span id="l15.88">       for (let i = 0; i &lt; numChilds; i++) {</span>
<a href="#l15.89"></a><span id="l15.89">         // we now have one of the minimonth controls while 'start'</span>
<a href="#l15.90"></a><span id="l15.90">         // and 'end' are set to the interval this minimonth shows.</span>
<a href="#l15.91"></a><span id="l15.91" class="difflineminus">-        minimonth = hbox.childNodes[i];</span>
<a href="#l15.92"></a><span id="l15.92" class="difflineplus">+        minimonth = hbox.children[i];</span>
<a href="#l15.93"></a><span id="l15.93">         minimonth.showMonth(cal.dtz.dateTimeToJsDate(start));</span>
<a href="#l15.94"></a><span id="l15.94">         if (recurrenceInfo) {</span>
<a href="#l15.95"></a><span id="l15.95">           // retrieve an array of dates that represents all occurrences</span>
<a href="#l15.96"></a><span id="l15.96">           // that fall into this time interval [start,end[.</span>
<a href="#l15.97"></a><span id="l15.97">           // note: the following loop assumes that this array contains</span>
<a href="#l15.98"></a><span id="l15.98">           // dates that are strictly monotonically increasing.</span>
<a href="#l15.99"></a><span id="l15.99">           // should getOccurrenceDates() not enforce this assumption we</span>
<a href="#l15.100"></a><span id="l15.100">           // need to fall back to some different algorithm.</span>
<a href="#l15.101"></a><span id="l15.101" class="difflineat">@@ -208,53 +208,53 @@ const RecurrencePreview = {</span>
<a href="#l15.102"></a><span id="l15.102">               }</span>
<a href="#l15.103"></a><span id="l15.103">             }</span>
<a href="#l15.104"></a><span id="l15.104">             current.day++;</span>
<a href="#l15.105"></a><span id="l15.105">           }</span>
<a href="#l15.106"></a><span id="l15.106">         }</span>
<a href="#l15.107"></a><span id="l15.107">         start.month++;</span>
<a href="#l15.108"></a><span id="l15.108">         end.month++;</span>
<a href="#l15.109"></a><span id="l15.109">       }</span>
<a href="#l15.110"></a><span id="l15.110" class="difflineminus">-      hbox = hbox.nextSibling;</span>
<a href="#l15.111"></a><span id="l15.111" class="difflineplus">+      hbox = hbox.nextElementSibling;</span>
<a href="#l15.112"></a><span id="l15.112">     }</span>
<a href="#l15.113"></a><span id="l15.113">   },</span>
<a href="#l15.114"></a><span id="l15.114"> };</span>
<a href="#l15.115"></a><span id="l15.115"> </span>
<a href="#l15.116"></a><span id="l15.116"> /**</span>
<a href="#l15.117"></a><span id="l15.117">  * An object containing the daypicker-weekday binding functionalities.</span>
<a href="#l15.118"></a><span id="l15.118">  */</span>
<a href="#l15.119"></a><span id="l15.119"> const DaypickerWeekday = {</span>
<a href="#l15.120"></a><span id="l15.120">   /**</span>
<a href="#l15.121"></a><span id="l15.121">    * Method intitializing DaypickerWeekday.</span>
<a href="#l15.122"></a><span id="l15.122">    */</span>
<a href="#l15.123"></a><span id="l15.123">   init() {</span>
<a href="#l15.124"></a><span id="l15.124">     this.weekStartOffset = Services.prefs.getIntPref(&quot;calendar.week.start&quot;, 0);</span>
<a href="#l15.125"></a><span id="l15.125"> </span>
<a href="#l15.126"></a><span id="l15.126">     let mainbox = document.getElementById(&quot;daypicker-weekday&quot;);</span>
<a href="#l15.127"></a><span id="l15.127" class="difflineminus">-    let numChilds = mainbox.childNodes.length;</span>
<a href="#l15.128"></a><span id="l15.128" class="difflineplus">+    let numChilds = mainbox.children.length;</span>
<a href="#l15.129"></a><span id="l15.129">     for (let i = 0; i &lt; numChilds; i++) {</span>
<a href="#l15.130"></a><span id="l15.130" class="difflineminus">-      let child = mainbox.childNodes[i];</span>
<a href="#l15.131"></a><span id="l15.131" class="difflineplus">+      let child = mainbox.children[i];</span>
<a href="#l15.132"></a><span id="l15.132">       let dow = i + this.weekStartOffset;</span>
<a href="#l15.133"></a><span id="l15.133">       if (dow &gt;= 7) {</span>
<a href="#l15.134"></a><span id="l15.134">         dow -= 7;</span>
<a href="#l15.135"></a><span id="l15.135">       }</span>
<a href="#l15.136"></a><span id="l15.136">       let day = cal.l10n.getString(&quot;dateFormat&quot;, `day.${dow + 1}.Mmm`);</span>
<a href="#l15.137"></a><span id="l15.137">       child.label = day;</span>
<a href="#l15.138"></a><span id="l15.138">       child.calendar = mainbox;</span>
<a href="#l15.139"></a><span id="l15.139">     }</span>
<a href="#l15.140"></a><span id="l15.140">   },</span>
<a href="#l15.141"></a><span id="l15.141">   /**</span>
<a href="#l15.142"></a><span id="l15.142">    * Getter for days property.</span>
<a href="#l15.143"></a><span id="l15.143">    */</span>
<a href="#l15.144"></a><span id="l15.144">   get days() {</span>
<a href="#l15.145"></a><span id="l15.145">     let mainbox = document.getElementById(&quot;daypicker-weekday&quot;);</span>
<a href="#l15.146"></a><span id="l15.146" class="difflineminus">-    let numChilds = mainbox.childNodes.length;</span>
<a href="#l15.147"></a><span id="l15.147" class="difflineplus">+    let numChilds = mainbox.children.length;</span>
<a href="#l15.148"></a><span id="l15.148">     let days = [];</span>
<a href="#l15.149"></a><span id="l15.149">     for (let i = 0; i &lt; numChilds; i++) {</span>
<a href="#l15.150"></a><span id="l15.150" class="difflineminus">-      let child = mainbox.childNodes[i];</span>
<a href="#l15.151"></a><span id="l15.151" class="difflineplus">+      let child = mainbox.children[i];</span>
<a href="#l15.152"></a><span id="l15.152">       if (child.getAttribute(&quot;checked&quot;) == &quot;true&quot;) {</span>
<a href="#l15.153"></a><span id="l15.153">         let index = i + this.weekStartOffset;</span>
<a href="#l15.154"></a><span id="l15.154">         if (index &gt;= 7) {</span>
<a href="#l15.155"></a><span id="l15.155">           index -= 7;</span>
<a href="#l15.156"></a><span id="l15.156">         }</span>
<a href="#l15.157"></a><span id="l15.157">         days.push(index + 1);</span>
<a href="#l15.158"></a><span id="l15.158">       }</span>
<a href="#l15.159"></a><span id="l15.159">     }</span>
<a href="#l15.160"></a><span id="l15.160" class="difflineat">@@ -263,59 +263,59 @@ const DaypickerWeekday = {</span>
<a href="#l15.161"></a><span id="l15.161">   /**</span>
<a href="#l15.162"></a><span id="l15.162">    * The weekday-picker manages an array of selected days of the week and</span>
<a href="#l15.163"></a><span id="l15.163">    * the 'days' property is the interface to this array. the expected argument is</span>
<a href="#l15.164"></a><span id="l15.164">    * an array containing integer elements, where each element represents a selected</span>
<a href="#l15.165"></a><span id="l15.165">    * day of the week, starting with SUNDAY=1.</span>
<a href="#l15.166"></a><span id="l15.166">    */</span>
<a href="#l15.167"></a><span id="l15.167">   set days(val) {</span>
<a href="#l15.168"></a><span id="l15.168">     let mainbox = document.getElementById(&quot;daypicker-weekday&quot;);</span>
<a href="#l15.169"></a><span id="l15.169" class="difflineminus">-    for (let child of mainbox.childNodes) {</span>
<a href="#l15.170"></a><span id="l15.170" class="difflineplus">+    for (let child of mainbox.children) {</span>
<a href="#l15.171"></a><span id="l15.171">       child.removeAttribute(&quot;checked&quot;);</span>
<a href="#l15.172"></a><span id="l15.172">     }</span>
<a href="#l15.173"></a><span id="l15.173">     for (let i in val) {</span>
<a href="#l15.174"></a><span id="l15.174">       let index = val[i] - 1 - this.weekStartOffset;</span>
<a href="#l15.175"></a><span id="l15.175">       if (index &lt; 0) {</span>
<a href="#l15.176"></a><span id="l15.176">         index += 7;</span>
<a href="#l15.177"></a><span id="l15.177">       }</span>
<a href="#l15.178"></a><span id="l15.178" class="difflineminus">-      mainbox.childNodes[index].setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l15.179"></a><span id="l15.179" class="difflineplus">+      mainbox.children[index].setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l15.180"></a><span id="l15.180">     }</span>
<a href="#l15.181"></a><span id="l15.181">     return val;</span>
<a href="#l15.182"></a><span id="l15.182">   },</span>
<a href="#l15.183"></a><span id="l15.183"> };</span>
<a href="#l15.184"></a><span id="l15.184"> </span>
<a href="#l15.185"></a><span id="l15.185"> /**</span>
<a href="#l15.186"></a><span id="l15.186">  * An object containing the daypicker-monthday binding functionalities.</span>
<a href="#l15.187"></a><span id="l15.187">  */</span>
<a href="#l15.188"></a><span id="l15.188"> const DaypickerMonthday = {</span>
<a href="#l15.189"></a><span id="l15.189">   /**</span>
<a href="#l15.190"></a><span id="l15.190">    * Method intitializing DaypickerMonthday.</span>
<a href="#l15.191"></a><span id="l15.191">    */</span>
<a href="#l15.192"></a><span id="l15.192">   init() {</span>
<a href="#l15.193"></a><span id="l15.193">     let mainbox = document.querySelector(&quot;.daypicker-monthday-mainbox&quot;);</span>
<a href="#l15.194"></a><span id="l15.194">     let child = null;</span>
<a href="#l15.195"></a><span id="l15.195" class="difflineminus">-    for (let row of mainbox.childNodes) {</span>
<a href="#l15.196"></a><span id="l15.196" class="difflineminus">-      for (child of row.childNodes) {</span>
<a href="#l15.197"></a><span id="l15.197" class="difflineplus">+    for (let row of mainbox.children) {</span>
<a href="#l15.198"></a><span id="l15.198" class="difflineplus">+      for (child of row.children) {</span>
<a href="#l15.199"></a><span id="l15.199">         child.calendar = mainbox;</span>
<a href="#l15.200"></a><span id="l15.200">       }</span>
<a href="#l15.201"></a><span id="l15.201">     }</span>
<a href="#l15.202"></a><span id="l15.202">     let labelLastDay = cal.l10n.getString(</span>
<a href="#l15.203"></a><span id="l15.203">       &quot;calendar-event-dialog&quot;,</span>
<a href="#l15.204"></a><span id="l15.204">       &quot;eventRecurrenceMonthlyLastDayLabel&quot;</span>
<a href="#l15.205"></a><span id="l15.205">     );</span>
<a href="#l15.206"></a><span id="l15.206">     child.setAttribute(&quot;label&quot;, labelLastDay);</span>
<a href="#l15.207"></a><span id="l15.207">   },</span>
<a href="#l15.208"></a><span id="l15.208">   /**</span>
<a href="#l15.209"></a><span id="l15.209">    * Setter for days property.</span>
<a href="#l15.210"></a><span id="l15.210">    */</span>
<a href="#l15.211"></a><span id="l15.211">   set days(val) {</span>
<a href="#l15.212"></a><span id="l15.212">     let mainbox = document.querySelector(&quot;.daypicker-monthday-mainbox&quot;);</span>
<a href="#l15.213"></a><span id="l15.213">     let days = [];</span>
<a href="#l15.214"></a><span id="l15.214" class="difflineminus">-    for (let row of mainbox.childNodes) {</span>
<a href="#l15.215"></a><span id="l15.215" class="difflineminus">-      for (let child of row.childNodes) {</span>
<a href="#l15.216"></a><span id="l15.216" class="difflineplus">+    for (let row of mainbox.children) {</span>
<a href="#l15.217"></a><span id="l15.217" class="difflineplus">+      for (let child of row.children) {</span>
<a href="#l15.218"></a><span id="l15.218">         child.removeAttribute(&quot;checked&quot;);</span>
<a href="#l15.219"></a><span id="l15.219">         days.push(child);</span>
<a href="#l15.220"></a><span id="l15.220">       }</span>
<a href="#l15.221"></a><span id="l15.221">     }</span>
<a href="#l15.222"></a><span id="l15.222">     for (let i in val) {</span>
<a href="#l15.223"></a><span id="l15.223">       let lastDayOffset = val[i] == -1 ? 0 : -1;</span>
<a href="#l15.224"></a><span id="l15.224">       let index = val[i] &lt; 0 ? val[i] + days.length + lastDayOffset : val[i] - 1;</span>
<a href="#l15.225"></a><span id="l15.225">       days[index].setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l15.226"></a><span id="l15.226" class="difflineat">@@ -323,43 +323,43 @@ const DaypickerMonthday = {</span>
<a href="#l15.227"></a><span id="l15.227">     return val;</span>
<a href="#l15.228"></a><span id="l15.228">   },</span>
<a href="#l15.229"></a><span id="l15.229">   /**</span>
<a href="#l15.230"></a><span id="l15.230">    * Getter for days property.</span>
<a href="#l15.231"></a><span id="l15.231">    */</span>
<a href="#l15.232"></a><span id="l15.232">   get days() {</span>
<a href="#l15.233"></a><span id="l15.233">     let mainbox = document.querySelector(&quot;.daypicker-monthday-mainbox&quot;);</span>
<a href="#l15.234"></a><span id="l15.234">     let days = [];</span>
<a href="#l15.235"></a><span id="l15.235" class="difflineminus">-    for (let row of mainbox.childNodes) {</span>
<a href="#l15.236"></a><span id="l15.236" class="difflineminus">-      for (let child of row.childNodes) {</span>
<a href="#l15.237"></a><span id="l15.237" class="difflineplus">+    for (let row of mainbox.children) {</span>
<a href="#l15.238"></a><span id="l15.238" class="difflineplus">+      for (let child of row.children) {</span>
<a href="#l15.239"></a><span id="l15.239">         if (child.getAttribute(&quot;checked&quot;) == &quot;true&quot;) {</span>
<a href="#l15.240"></a><span id="l15.240">           days.push(Number(child.label) ? Number(child.label) : -1);</span>
<a href="#l15.241"></a><span id="l15.241">         }</span>
<a href="#l15.242"></a><span id="l15.242">       }</span>
<a href="#l15.243"></a><span id="l15.243">     }</span>
<a href="#l15.244"></a><span id="l15.244">     return days;</span>
<a href="#l15.245"></a><span id="l15.245">   },</span>
<a href="#l15.246"></a><span id="l15.246">   /**</span>
<a href="#l15.247"></a><span id="l15.247">    * Disables daypicker elements.</span>
<a href="#l15.248"></a><span id="l15.248">    */</span>
<a href="#l15.249"></a><span id="l15.249">   disable() {</span>
<a href="#l15.250"></a><span id="l15.250">     let mainbox = document.querySelector(&quot;.daypicker-monthday-mainbox&quot;);</span>
<a href="#l15.251"></a><span id="l15.251" class="difflineminus">-    for (let row of mainbox.childNodes) {</span>
<a href="#l15.252"></a><span id="l15.252" class="difflineminus">-      for (let child of row.childNodes) {</span>
<a href="#l15.253"></a><span id="l15.253" class="difflineplus">+    for (let row of mainbox.children) {</span>
<a href="#l15.254"></a><span id="l15.254" class="difflineplus">+      for (let child of row.children) {</span>
<a href="#l15.255"></a><span id="l15.255">         child.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l15.256"></a><span id="l15.256">       }</span>
<a href="#l15.257"></a><span id="l15.257">     }</span>
<a href="#l15.258"></a><span id="l15.258">   },</span>
<a href="#l15.259"></a><span id="l15.259">   /**</span>
<a href="#l15.260"></a><span id="l15.260">    * Enables daypicker elements.</span>
<a href="#l15.261"></a><span id="l15.261">    */</span>
<a href="#l15.262"></a><span id="l15.262">   enable() {</span>
<a href="#l15.263"></a><span id="l15.263">     let mainbox = document.querySelector(&quot;.daypicker-monthday-mainbox&quot;);</span>
<a href="#l15.264"></a><span id="l15.264" class="difflineminus">-    for (let row of mainbox.childNodes) {</span>
<a href="#l15.265"></a><span id="l15.265" class="difflineminus">-      for (let child of row.childNodes) {</span>
<a href="#l15.266"></a><span id="l15.266" class="difflineplus">+    for (let row of mainbox.children) {</span>
<a href="#l15.267"></a><span id="l15.267" class="difflineplus">+      for (let child of row.children) {</span>
<a href="#l15.268"></a><span id="l15.268">         child.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l15.269"></a><span id="l15.269">       }</span>
<a href="#l15.270"></a><span id="l15.270">     }</span>
<a href="#l15.271"></a><span id="l15.271">   },</span>
<a href="#l15.272"></a><span id="l15.272"> };</span>
<a href="#l15.273"></a><span id="l15.273"> </span>
<a href="#l15.274"></a><span id="l15.274"> /**</span>
<a href="#l15.275"></a><span id="l15.275">  * Sets up the recurrence dialog from the window arguments. Takes care of filling</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-reminder.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-reminder.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -51,17 +51,17 @@ function onLoad() {</span>
<a href="#l16.4"></a><span id="l16.4">   // Set up the action map</span>
<a href="#l16.5"></a><span id="l16.5">   let supportedActions = calendar.getProperty(&quot;capabilities.alarms.actionValues&quot;) || [&quot;DISPLAY&quot;]; // TODO email support, &quot;EMAIL&quot;</span>
<a href="#l16.6"></a><span id="l16.6">   for (let action of supportedActions) {</span>
<a href="#l16.7"></a><span id="l16.7">     allowedActionsMap[action] = true;</span>
<a href="#l16.8"></a><span id="l16.8">   }</span>
<a href="#l16.9"></a><span id="l16.9"> </span>
<a href="#l16.10"></a><span id="l16.10">   // Hide all actions that are not supported by this provider</span>
<a href="#l16.11"></a><span id="l16.11">   let firstAvailableItem;</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-  let actionNodes = document.getElementById(&quot;reminder-actions-menupopup&quot;).childNodes;</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+  let actionNodes = document.getElementById(&quot;reminder-actions-menupopup&quot;).children;</span>
<a href="#l16.14"></a><span id="l16.14">   for (let actionNode of actionNodes) {</span>
<a href="#l16.15"></a><span id="l16.15">     let shouldHide =</span>
<a href="#l16.16"></a><span id="l16.16">       !(actionNode.value in allowedActionsMap) ||</span>
<a href="#l16.17"></a><span id="l16.17">       (actionNode.hasAttribute(&quot;provider&quot;) &amp;&amp; actionNode.getAttribute(&quot;provider&quot;) != calendar.type);</span>
<a href="#l16.18"></a><span id="l16.18">     setElementValue(actionNode, shouldHide &amp;&amp; &quot;true&quot;, &quot;hidden&quot;);</span>
<a href="#l16.19"></a><span id="l16.19">     if (!firstAvailableItem &amp;&amp; !shouldHide) {</span>
<a href="#l16.20"></a><span id="l16.20">       firstAvailableItem = actionNode;</span>
<a href="#l16.21"></a><span id="l16.21">     }</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineat">@@ -99,17 +99,17 @@ function loadReminders() {</span>
<a href="#l16.23"></a><span id="l16.23">     }</span>
<a href="#l16.24"></a><span id="l16.24">   }</span>
<a href="#l16.25"></a><span id="l16.25"> </span>
<a href="#l16.26"></a><span id="l16.26">   // Set up a default absolute date. This will be overridden if the selected</span>
<a href="#l16.27"></a><span id="l16.27">   // alarm is absolute.</span>
<a href="#l16.28"></a><span id="l16.28">   let absDate = document.getElementById(&quot;reminder-absolute-date&quot;);</span>
<a href="#l16.29"></a><span id="l16.29">   absDate.value = cal.dtz.dateTimeToJsDate(cal.dtz.getDefaultStartDate());</span>
<a href="#l16.30"></a><span id="l16.30"> </span>
<a href="#l16.31"></a><span id="l16.31" class="difflineminus">-  if (listbox.childNodes.length) {</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineplus">+  if (listbox.children.length) {</span>
<a href="#l16.33"></a><span id="l16.33">     // We have reminders, select the first by default. For some reason,</span>
<a href="#l16.34"></a><span id="l16.34">     // setting the selected index in a load handler makes the selection</span>
<a href="#l16.35"></a><span id="l16.35">     // break for the set item, therefore we need a setTimeout.</span>
<a href="#l16.36"></a><span id="l16.36">     setupMaxReminders();</span>
<a href="#l16.37"></a><span id="l16.37">     setTimeout(() =&gt; {</span>
<a href="#l16.38"></a><span id="l16.38">       listbox.selectedIndex = 0;</span>
<a href="#l16.39"></a><span id="l16.39">     }, 0);</span>
<a href="#l16.40"></a><span id="l16.40">   } else {</span>
<a href="#l16.41"></a><span id="l16.41" class="difflineat">@@ -165,17 +165,17 @@ function setupRadioEnabledState(aDisable</span>
<a href="#l16.42"></a><span id="l16.42">  */</span>
<a href="#l16.43"></a><span id="l16.43"> function setupMaxReminders() {</span>
<a href="#l16.44"></a><span id="l16.44">   let args = window.arguments[0];</span>
<a href="#l16.45"></a><span id="l16.45">   let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l16.46"></a><span id="l16.46">   let maxReminders = args.calendar.getProperty(&quot;capabilities.alarms.maxCount&quot;);</span>
<a href="#l16.47"></a><span id="l16.47"> </span>
<a href="#l16.48"></a><span id="l16.48">   // != null is needed here to ensure cond to be true/false, instead of</span>
<a href="#l16.49"></a><span id="l16.49">   // true/null. The former is needed for setElementValue.</span>
<a href="#l16.50"></a><span id="l16.50" class="difflineminus">-  let cond = maxReminders != null &amp;&amp; listbox.childNodes.length &gt;= maxReminders;</span>
<a href="#l16.51"></a><span id="l16.51" class="difflineplus">+  let cond = maxReminders != null &amp;&amp; listbox.children.length &gt;= maxReminders;</span>
<a href="#l16.52"></a><span id="l16.52"> </span>
<a href="#l16.53"></a><span id="l16.53">   // If we hit the maximum number of reminders, show the error box and</span>
<a href="#l16.54"></a><span id="l16.54">   // disable the new button.</span>
<a href="#l16.55"></a><span id="l16.55">   setElementValue(&quot;reminder-new-button&quot;, cond &amp;&amp; &quot;true&quot;, &quot;disabled&quot;);</span>
<a href="#l16.56"></a><span id="l16.56"> </span>
<a href="#l16.57"></a><span id="l16.57">   let localeErrorString = cal.l10n.getString(</span>
<a href="#l16.58"></a><span id="l16.58">     &quot;calendar-alarms&quot;,</span>
<a href="#l16.59"></a><span id="l16.59">     getItemBundleStringName(&quot;reminderErrorMaxCountReached&quot;),</span>
<a href="#l16.60"></a><span id="l16.60" class="difflineat">@@ -189,17 +189,17 @@ function setupMaxReminders() {</span>
<a href="#l16.61"></a><span id="l16.61">   if (cond) {</span>
<a href="#l16.62"></a><span id="l16.62">     let notification = gNotification.notificationbox.appendNotification(</span>
<a href="#l16.63"></a><span id="l16.63">       pluralErrorLabel,</span>
<a href="#l16.64"></a><span id="l16.64">       &quot;reminderNotification&quot;,</span>
<a href="#l16.65"></a><span id="l16.65">       null,</span>
<a href="#l16.66"></a><span id="l16.66">       gNotification.notificationbox.PRIORITY_WARNING_MEDIUM</span>
<a href="#l16.67"></a><span id="l16.67">     );</span>
<a href="#l16.68"></a><span id="l16.68"> </span>
<a href="#l16.69"></a><span id="l16.69" class="difflineminus">-    let closeButton = notification.messageDetails.nextSibling;</span>
<a href="#l16.70"></a><span id="l16.70" class="difflineplus">+    let closeButton = notification.messageDetails.nextElementSibling;</span>
<a href="#l16.71"></a><span id="l16.71">     closeButton.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l16.72"></a><span id="l16.72">   } else {</span>
<a href="#l16.73"></a><span id="l16.73">     gNotification.notificationbox.removeAllNotifications();</span>
<a href="#l16.74"></a><span id="l16.74">   }</span>
<a href="#l16.75"></a><span id="l16.75"> }</span>
<a href="#l16.76"></a><span id="l16.76"> </span>
<a href="#l16.77"></a><span id="l16.77"> /**</span>
<a href="#l16.78"></a><span id="l16.78">  * Sets up a reminder listitem for the list of reminders applied to this item.</span>
<a href="#l16.79"></a><span id="l16.79" class="difflineat">@@ -441,32 +441,34 @@ function onNewReminder() {</span>
<a href="#l16.80"></a><span id="l16.80"> </span>
<a href="#l16.81"></a><span id="l16.81"> /**</span>
<a href="#l16.82"></a><span id="l16.82">  * Handler function to be called when the &quot;remove&quot; button is pressed to remove</span>
<a href="#l16.83"></a><span id="l16.83">  * the selected reminder item and advance the selection.</span>
<a href="#l16.84"></a><span id="l16.84">  */</span>
<a href="#l16.85"></a><span id="l16.85"> function onRemoveReminder() {</span>
<a href="#l16.86"></a><span id="l16.86">   let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l16.87"></a><span id="l16.87">   let listitem = listbox.selectedItem;</span>
<a href="#l16.88"></a><span id="l16.88" class="difflineminus">-  let newSelection = listitem ? listitem.nextSibling || listitem.previousSibling : null;</span>
<a href="#l16.89"></a><span id="l16.89" class="difflineplus">+  let newSelection = listitem</span>
<a href="#l16.90"></a><span id="l16.90" class="difflineplus">+    ? listitem.nextElementSibling || listitem.previousElementSibling</span>
<a href="#l16.91"></a><span id="l16.91" class="difflineplus">+    : null;</span>
<a href="#l16.92"></a><span id="l16.92"> </span>
<a href="#l16.93"></a><span id="l16.93">   listbox.clearSelection();</span>
<a href="#l16.94"></a><span id="l16.94">   listitem.remove();</span>
<a href="#l16.95"></a><span id="l16.95">   listbox.selectItem(newSelection);</span>
<a href="#l16.96"></a><span id="l16.96"> </span>
<a href="#l16.97"></a><span id="l16.97" class="difflineminus">-  setElementValue(&quot;reminder-remove-button&quot;, listbox.childNodes.length &lt; 1 &amp;&amp; &quot;true&quot;, &quot;disabled&quot;);</span>
<a href="#l16.98"></a><span id="l16.98" class="difflineplus">+  setElementValue(&quot;reminder-remove-button&quot;, listbox.children.length &lt; 1 &amp;&amp; &quot;true&quot;, &quot;disabled&quot;);</span>
<a href="#l16.99"></a><span id="l16.99">   setupMaxReminders();</span>
<a href="#l16.100"></a><span id="l16.100"> }</span>
<a href="#l16.101"></a><span id="l16.101"> </span>
<a href="#l16.102"></a><span id="l16.102"> /**</span>
<a href="#l16.103"></a><span id="l16.103">  * Handler function to be called when the accept button is pressed.</span>
<a href="#l16.104"></a><span id="l16.104">  */</span>
<a href="#l16.105"></a><span id="l16.105"> document.addEventListener(&quot;dialogaccept&quot;, () =&gt; {</span>
<a href="#l16.106"></a><span id="l16.106">   let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l16.107"></a><span id="l16.107" class="difflineminus">-  let reminders = Array.from(listbox.childNodes).map(node =&gt; node.reminder);</span>
<a href="#l16.108"></a><span id="l16.108" class="difflineplus">+  let reminders = Array.from(listbox.children).map(node =&gt; node.reminder);</span>
<a href="#l16.109"></a><span id="l16.109">   if (window.arguments[0].onOk) {</span>
<a href="#l16.110"></a><span id="l16.110">     window.arguments[0].onOk(reminders);</span>
<a href="#l16.111"></a><span id="l16.111">   }</span>
<a href="#l16.112"></a><span id="l16.112"> });</span>
<a href="#l16.113"></a><span id="l16.113"> </span>
<a href="#l16.114"></a><span id="l16.114"> /**</span>
<a href="#l16.115"></a><span id="l16.115">  * Handler function to be called when the cancel button is pressed.</span>
<a href="#l16.116"></a><span id="l16.116">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-timezone.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-timezone.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -69,19 +69,19 @@ function onLoad() {</span>
<a href="#l17.4"></a><span id="l17.4">  * Find the index of the timezone menuitem corresponding to the given timezone.</span>
<a href="#l17.5"></a><span id="l17.5">  *</span>
<a href="#l17.6"></a><span id="l17.6">  * @param timezone      The calITimezone to look for.</span>
<a href="#l17.7"></a><span id="l17.7">  * @return              The index of the childnode below &quot;timezone-menulist&quot;</span>
<a href="#l17.8"></a><span id="l17.8">  */</span>
<a href="#l17.9"></a><span id="l17.9"> function findTimezone(timezone) {</span>
<a href="#l17.10"></a><span id="l17.10">   let tzid = timezone.tzid;</span>
<a href="#l17.11"></a><span id="l17.11">   let menulist = document.getElementById(&quot;timezone-menulist&quot;);</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-  let numChilds = menulist.childNodes[0].childNodes.length;</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+  let numChilds = menulist.children[0].children.length;</span>
<a href="#l17.14"></a><span id="l17.14">   for (let i = 0; i &lt; numChilds; i++) {</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineminus">-    let menuitem = menulist.childNodes[0].childNodes[i];</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+    let menuitem = menulist.children[0].children[i];</span>
<a href="#l17.17"></a><span id="l17.17">     if (menuitem.getAttribute(&quot;value&quot;) == tzid) {</span>
<a href="#l17.18"></a><span id="l17.18">       return i;</span>
<a href="#l17.19"></a><span id="l17.19">     }</span>
<a href="#l17.20"></a><span id="l17.20">   }</span>
<a href="#l17.21"></a><span id="l17.21">   return -1;</span>
<a href="#l17.22"></a><span id="l17.22"> }</span>
<a href="#l17.23"></a><span id="l17.23"> </span>
<a href="#l17.24"></a><span id="l17.24"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-migration-dialog.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-migration-dialog.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -49,19 +49,19 @@ var gMigrateWizard = {</span>
<a href="#l18.4"></a><span id="l18.4">    * that were checked and begins migrating their data.  Also controls the</span>
<a href="#l18.5"></a><span id="l18.5">    * progress dialog so the user can see what is happening. (somewhat)</span>
<a href="#l18.6"></a><span id="l18.6">    */</span>
<a href="#l18.7"></a><span id="l18.7">   migrateChecked: function() {</span>
<a href="#l18.8"></a><span id="l18.8">     let migrators = [];</span>
<a href="#l18.9"></a><span id="l18.9"> </span>
<a href="#l18.10"></a><span id="l18.10">     // Get all the checked migrators into an array</span>
<a href="#l18.11"></a><span id="l18.11">     let listbox = document.getElementById(&quot;datasource-list&quot;);</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-    for (let i = listbox.childNodes.length - 1; i &gt;= 0; i--) {</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">-      if (listbox.childNodes[i].getAttribute(&quot;checked&quot;)) {</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineminus">-        migrators.push(listbox.childNodes[i].migrator);</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineplus">+    for (let i = listbox.children.length - 1; i &gt;= 0; i--) {</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineplus">+      if (listbox.children[i].getAttribute(&quot;checked&quot;)) {</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineplus">+        migrators.push(listbox.children[i].migrator);</span>
<a href="#l18.18"></a><span id="l18.18">       }</span>
<a href="#l18.19"></a><span id="l18.19">     }</span>
<a href="#l18.20"></a><span id="l18.20"> </span>
<a href="#l18.21"></a><span id="l18.21">     // If no migrators were checked, then we're done</span>
<a href="#l18.22"></a><span id="l18.22">     if (migrators.length == 0) {</span>
<a href="#l18.23"></a><span id="l18.23">       window.close();</span>
<a href="#l18.24"></a><span id="l18.24">     }</span>
<a href="#l18.25"></a><span id="l18.25"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-properties-dialog.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-properties-dialog.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -185,13 +185,13 @@ function initRefreshInterval() {</span>
<a href="#l19.4"></a><span id="l19.4">     if (refreshInterval == 0) {</span>
<a href="#l19.5"></a><span id="l19.5">       menulist.selectedItem = document.getElementById(&quot;calendar-refreshInterval-manual&quot;);</span>
<a href="#l19.6"></a><span id="l19.6">       foundValue = true;</span>
<a href="#l19.7"></a><span id="l19.7">     }</span>
<a href="#l19.8"></a><span id="l19.8"> </span>
<a href="#l19.9"></a><span id="l19.9">     if (!foundValue) {</span>
<a href="#l19.10"></a><span id="l19.10">       // Special menuitem in case the user changed the value in the config editor.</span>
<a href="#l19.11"></a><span id="l19.11">       let menuitem = createMenuItem(refreshInterval);</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-      separator.parentNode.insertBefore(menuitem, separator.nextSibling);</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+      separator.parentNode.insertBefore(menuitem, separator.nextElementSibling);</span>
<a href="#l19.14"></a><span id="l19.14">       menulist.selectedItem = menuitem;</span>
<a href="#l19.15"></a><span id="l19.15">     }</span>
<a href="#l19.16"></a><span id="l19.16">   }</span>
<a href="#l19.17"></a><span id="l19.17"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -434,27 +434,27 @@ function updateRepeatDetails() {</span>
<a href="#l20.4"></a><span id="l20.4"> </span>
<a href="#l20.5"></a><span id="l20.5">   if (!detailsString) {</span>
<a href="#l20.6"></a><span id="l20.6">     detailsString = cal.l10n.getString(&quot;calendar-event-dialog&quot;, &quot;ruleTooComplexSummary&quot;);</span>
<a href="#l20.7"></a><span id="l20.7">   }</span>
<a href="#l20.8"></a><span id="l20.8"> </span>
<a href="#l20.9"></a><span id="l20.9">   // Now display the string...</span>
<a href="#l20.10"></a><span id="l20.10">   let lines = detailsString.split(&quot;\n&quot;);</span>
<a href="#l20.11"></a><span id="l20.11">   repeatDetails.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-  while (repeatDetails.childNodes.length &gt; lines.length) {</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+  while (repeatDetails.children.length &gt; lines.length) {</span>
<a href="#l20.14"></a><span id="l20.14">     repeatDetails.lastChild.remove();</span>
<a href="#l20.15"></a><span id="l20.15">   }</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineminus">-  let numChilds = repeatDetails.childNodes.length;</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineplus">+  let numChilds = repeatDetails.children.length;</span>
<a href="#l20.18"></a><span id="l20.18">   for (let i = 0; i &lt; lines.length; i++) {</span>
<a href="#l20.19"></a><span id="l20.19">     if (i &gt;= numChilds) {</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineminus">-      let newNode = repeatDetails.firstChild.cloneNode(true);</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineplus">+      let newNode = repeatDetails.firstElementChild.cloneNode(true);</span>
<a href="#l20.22"></a><span id="l20.22">       repeatDetails.appendChild(newNode);</span>
<a href="#l20.23"></a><span id="l20.23">     }</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineminus">-    repeatDetails.childNodes[i].value = lines[i];</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineminus">-    repeatDetails.childNodes[i].setAttribute(&quot;tooltiptext&quot;, detailsString);</span>
<a href="#l20.26"></a><span id="l20.26" class="difflineplus">+    repeatDetails.children[i].value = lines[i];</span>
<a href="#l20.27"></a><span id="l20.27" class="difflineplus">+    repeatDetails.children[i].setAttribute(&quot;tooltiptext&quot;, detailsString);</span>
<a href="#l20.28"></a><span id="l20.28">   }</span>
<a href="#l20.29"></a><span id="l20.29"> }</span>
<a href="#l20.30"></a><span id="l20.30"> </span>
<a href="#l20.31"></a><span id="l20.31"> /**</span>
<a href="#l20.32"></a><span id="l20.32">  * Updates the attendee listbox, displaying all attendees invited to the</span>
<a href="#l20.33"></a><span id="l20.33">  * window's item.</span>
<a href="#l20.34"></a><span id="l20.34">  */</span>
<a href="#l20.35"></a><span id="l20.35"> function updateAttendees() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/base/content/preferences/categories.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/base/content/preferences/categories.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -73,17 +73,17 @@ var gCategoriesPane = {</span>
<a href="#l21.4"></a><span id="l21.4"> </span>
<a href="#l21.5"></a><span id="l21.5">   updateCategoryList: function() {</span>
<a href="#l21.6"></a><span id="l21.6">     this.updatePrefs();</span>
<a href="#l21.7"></a><span id="l21.7">     let listbox = document.getElementById(&quot;categorieslist&quot;);</span>
<a href="#l21.8"></a><span id="l21.8"> </span>
<a href="#l21.9"></a><span id="l21.9">     listbox.clearSelection();</span>
<a href="#l21.10"></a><span id="l21.10">     this.updateButtons();</span>
<a href="#l21.11"></a><span id="l21.11"> </span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-    while (listbox.lastChild) {</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+    while (listbox.lastElementChild) {</span>
<a href="#l21.14"></a><span id="l21.14">       listbox.lastChild.remove();</span>
<a href="#l21.15"></a><span id="l21.15">     }</span>
<a href="#l21.16"></a><span id="l21.16"> </span>
<a href="#l21.17"></a><span id="l21.17">     for (let i = 0; i &lt; gCategoryList.length; i++) {</span>
<a href="#l21.18"></a><span id="l21.18">       let newListItem = document.createXULElement(&quot;richlistitem&quot;);</span>
<a href="#l21.19"></a><span id="l21.19">       let categoryName = document.createXULElement(&quot;label&quot;);</span>
<a href="#l21.20"></a><span id="l21.20">       categoryName.setAttribute(&quot;id&quot;, gCategoryList[i]);</span>
<a href="#l21.21"></a><span id="l21.21">       categoryName.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineat">@@ -153,22 +153,23 @@ var gCategoriesPane = {</span>
<a href="#l21.23"></a><span id="l21.23">     this.backupData(categoryNameFix);</span>
<a href="#l21.24"></a><span id="l21.24">     try {</span>
<a href="#l21.25"></a><span id="l21.25">       categoryPrefBranch.clearUserPref(categoryNameFix);</span>
<a href="#l21.26"></a><span id="l21.26">     } catch (ex) {</span>
<a href="#l21.27"></a><span id="l21.27">       // If the pref doesn't exist, don't bail out here.</span>
<a href="#l21.28"></a><span id="l21.28">     }</span>
<a href="#l21.29"></a><span id="l21.29"> </span>
<a href="#l21.30"></a><span id="l21.30">     // Remove category entry from listbox and gCategoryList.</span>
<a href="#l21.31"></a><span id="l21.31" class="difflineminus">-    let newSelection = list.selectedItem.nextSibling || list.selectedItem.previousSibling;</span>
<a href="#l21.32"></a><span id="l21.32" class="difflineplus">+    let newSelection =</span>
<a href="#l21.33"></a><span id="l21.33" class="difflineplus">+      list.selectedItem.nextElementSibling || list.selectedItem.previousElementSibling;</span>
<a href="#l21.34"></a><span id="l21.34">     let selectedItems = Array.from(list.selectedItems);</span>
<a href="#l21.35"></a><span id="l21.35">     for (let i = list.selectedCount - 1; i &gt;= 0; i--) {</span>
<a href="#l21.36"></a><span id="l21.36">       let item = selectedItems[i];</span>
<a href="#l21.37"></a><span id="l21.37">       if (item == newSelection) {</span>
<a href="#l21.38"></a><span id="l21.38" class="difflineminus">-        newSelection = newSelection.nextSibling || newSelection.previousSibling;</span>
<a href="#l21.39"></a><span id="l21.39" class="difflineplus">+        newSelection = newSelection.nextElementSibling || newSelection.previousElementSibling;</span>
<a href="#l21.40"></a><span id="l21.40">       }</span>
<a href="#l21.41"></a><span id="l21.41">       gCategoryList.splice(list.getIndexOfItem(item), 1);</span>
<a href="#l21.42"></a><span id="l21.42">       item.remove();</span>
<a href="#l21.43"></a><span id="l21.43">     }</span>
<a href="#l21.44"></a><span id="l21.44">     list.selectedItem = newSelection;</span>
<a href="#l21.45"></a><span id="l21.45">     this.updateButtons();</span>
<a href="#l21.46"></a><span id="l21.46"> </span>
<a href="#l21.47"></a><span id="l21.47">     // Update the prefs from gCategoryList</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/base/content/preferences/views.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/base/content/preferences/views.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -68,34 +68,34 @@ var gViewsPane = {</span>
<a href="#l22.4"></a><span id="l22.4"> </span>
<a href="#l22.5"></a><span id="l22.5">   /**</span>
<a href="#l22.6"></a><span id="l22.6">    * Updates the view end menu to only display hours after the selected view</span>
<a href="#l22.7"></a><span id="l22.7">    * start.</span>
<a href="#l22.8"></a><span id="l22.8">    *</span>
<a href="#l22.9"></a><span id="l22.9">    * @param aStartValue       The value selected for view start.</span>
<a href="#l22.10"></a><span id="l22.10">    */</span>
<a href="#l22.11"></a><span id="l22.11">   updateViewEndMenu: function(aStartValue) {</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-    let endMenuKids = document.getElementById(&quot;dayendhourpopup&quot;).childNodes;</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+    let endMenuKids = document.getElementById(&quot;dayendhourpopup&quot;).children;</span>
<a href="#l22.14"></a><span id="l22.14">     for (let i = 0; i &lt; endMenuKids.length; i++) {</span>
<a href="#l22.15"></a><span id="l22.15">       if (Number(endMenuKids[i].value) &lt;= Number(aStartValue)) {</span>
<a href="#l22.16"></a><span id="l22.16">         endMenuKids[i].setAttribute(&quot;hidden&quot;, true);</span>
<a href="#l22.17"></a><span id="l22.17">       } else {</span>
<a href="#l22.18"></a><span id="l22.18">         endMenuKids[i].removeAttribute(&quot;hidden&quot;);</span>
<a href="#l22.19"></a><span id="l22.19">       }</span>
<a href="#l22.20"></a><span id="l22.20">     }</span>
<a href="#l22.21"></a><span id="l22.21">   },</span>
<a href="#l22.22"></a><span id="l22.22"> </span>
<a href="#l22.23"></a><span id="l22.23">   /**</span>
<a href="#l22.24"></a><span id="l22.24">    * Updates the view start menu to only display hours before the selected view</span>
<a href="#l22.25"></a><span id="l22.25">    * end.</span>
<a href="#l22.26"></a><span id="l22.26">    *</span>
<a href="#l22.27"></a><span id="l22.27">    * @param aEndValue         The value selected for view end.</span>
<a href="#l22.28"></a><span id="l22.28">    */</span>
<a href="#l22.29"></a><span id="l22.29">   updateViewStartMenu: function(aEndValue) {</span>
<a href="#l22.30"></a><span id="l22.30" class="difflineminus">-    let startMenuKids = document.getElementById(&quot;daystarthourpopup&quot;).childNodes;</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineplus">+    let startMenuKids = document.getElementById(&quot;daystarthourpopup&quot;).children;</span>
<a href="#l22.32"></a><span id="l22.32">     for (let i = 0; i &lt; startMenuKids.length; i++) {</span>
<a href="#l22.33"></a><span id="l22.33">       if (Number(startMenuKids[i].value) &gt;= Number(aEndValue)) {</span>
<a href="#l22.34"></a><span id="l22.34">         startMenuKids[i].setAttribute(&quot;hidden&quot;, true);</span>
<a href="#l22.35"></a><span id="l22.35">       } else {</span>
<a href="#l22.36"></a><span id="l22.36">         startMenuKids[i].removeAttribute(&quot;hidden&quot;);</span>
<a href="#l22.37"></a><span id="l22.37">       }</span>
<a href="#l22.38"></a><span id="l22.38">     }</span>
<a href="#l22.39"></a><span id="l22.39">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/base/content/today-pane.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/base/content/today-pane.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -355,20 +355,20 @@ var TodayPane = {</span>
<a href="#l23.4"></a><span id="l23.4">     this.updateDisplay();</span>
<a href="#l23.5"></a><span id="l23.5">   },</span>
<a href="#l23.6"></a><span id="l23.6"> </span>
<a href="#l23.7"></a><span id="l23.7">   /**</span>
<a href="#l23.8"></a><span id="l23.8">    * Shows short weekday names in the weekdayNameContainer</span>
<a href="#l23.9"></a><span id="l23.9">    */</span>
<a href="#l23.10"></a><span id="l23.10">   setShortWeekdays: function() {</span>
<a href="#l23.11"></a><span id="l23.11">     let weekdisplaydeck = document.getElementById(&quot;weekdayNameContainer&quot;);</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-    let childNodes = weekdisplaydeck.childNodes;</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+    let children = weekdisplaydeck.children;</span>
<a href="#l23.14"></a><span id="l23.14"> </span>
<a href="#l23.15"></a><span id="l23.15" class="difflineminus">-    for (let i = 0; i &lt; childNodes.length; i++) {</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineminus">-      childNodes[i].setAttribute(&quot;value&quot;, cal.l10n.getDateFmtString(`day.${i + 1}.Mmm`));</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineplus">+    for (let i = 0; i &lt; children.length; i++) {</span>
<a href="#l23.18"></a><span id="l23.18" class="difflineplus">+      children[i].setAttribute(&quot;value&quot;, cal.l10n.getDateFmtString(`day.${i + 1}.Mmm`));</span>
<a href="#l23.19"></a><span id="l23.19">     }</span>
<a href="#l23.20"></a><span id="l23.20">   },</span>
<a href="#l23.21"></a><span id="l23.21"> </span>
<a href="#l23.22"></a><span id="l23.22">   /**</span>
<a href="#l23.23"></a><span id="l23.23">    * Sets the shown date from a JSDate.</span>
<a href="#l23.24"></a><span id="l23.24">    *</span>
<a href="#l23.25"></a><span id="l23.25">    * @param aNewDate      The date to show.</span>
<a href="#l23.26"></a><span id="l23.26">    */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/calendar/base/content/today-pane.xul</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/calendar/base/content/today-pane.xul</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -134,17 +134,17 @@</span>
<a href="#l24.4"></a><span id="l24.4">                          ondblclick=&quot;TodayPane.onDoubleClick(event);&quot;/&gt;</span>
<a href="#l24.5"></a><span id="l24.5">                   &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l24.6"></a><span id="l24.6">                 &lt;/hbox&gt;</span>
<a href="#l24.7"></a><span id="l24.7">               &lt;/vbox&gt;</span>
<a href="#l24.8"></a><span id="l24.8">               &lt;toolbarbutton id=&quot;miniday-dropdown-button&quot;</span>
<a href="#l24.9"></a><span id="l24.9">                              tooltiptext=&quot;&amp;showselectedday.tooltip;&quot;</span>
<a href="#l24.10"></a><span id="l24.10">                              type=&quot;menu&quot;&gt;</span>
<a href="#l24.11"></a><span id="l24.11">                 &lt;panel id=&quot;miniday-month-panel&quot; position=&quot;after_end&quot;</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-                       onpopupshown=&quot;this.firstChild.focusCalendar();&quot;&gt;</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+                       onpopupshown=&quot;this.firstElementChild.focusCalendar();&quot;&gt;</span>
<a href="#l24.14"></a><span id="l24.14">                   &lt;calendar-minimonth id=&quot;miniday-dropdown-minimonth&quot;</span>
<a href="#l24.15"></a><span id="l24.15">                                       flex=&quot;1&quot;</span>
<a href="#l24.16"></a><span id="l24.16">                                       onchange=&quot;TodayPane.setDaywithjsDate(this.value);</span>
<a href="#l24.17"></a><span id="l24.17">                                                 document.getElementById('miniday-month-panel').hidePopup();&quot;/&gt;</span>
<a href="#l24.18"></a><span id="l24.18">                 &lt;/panel&gt;</span>
<a href="#l24.19"></a><span id="l24.19">               &lt;/toolbarbutton&gt;</span>
<a href="#l24.20"></a><span id="l24.20">             &lt;/hbox&gt;</span>
<a href="#l24.21"></a><span id="l24.21">           &lt;/stack&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-dnd-widgets.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-dnd-widgets.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -82,20 +82,20 @@</span>
<a href="#l25.4"></a><span id="l25.4">           // Dragging to the end or beginning of a view.</span>
<a href="#l25.5"></a><span id="l25.5">           shadowStartDate.day += 1;</span>
<a href="#l25.6"></a><span id="l25.6">           continue;</span>
<a href="#l25.7"></a><span id="l25.7">         }</span>
<a href="#l25.8"></a><span id="l25.8">         let boxItems = box.querySelector(&quot;.calendar-day-items&quot;);</span>
<a href="#l25.9"></a><span id="l25.9">         let dropshadow = document.createXULElement(&quot;box&quot;);</span>
<a href="#l25.10"></a><span id="l25.10">         dropshadow.setAttribute(&quot;class&quot;, &quot;dropshadow&quot;);</span>
<a href="#l25.11"></a><span id="l25.11">         if (boxItems) {</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-          boxItems.insertBefore(dropshadow, boxItems.firstChild);</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+          boxItems.insertBefore(dropshadow, boxItems.firstElementChild);</span>
<a href="#l25.14"></a><span id="l25.14">           this.calendarView.mDropShadows.push(boxItems);</span>
<a href="#l25.15"></a><span id="l25.15">         } else {</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineminus">-          box.insertBefore(dropshadow, box.firstChild);</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineplus">+          box.insertBefore(dropshadow, box.firstElementChild);</span>
<a href="#l25.18"></a><span id="l25.18">           this.calendarView.mDropShadows.push(box);</span>
<a href="#l25.19"></a><span id="l25.19">         }</span>
<a href="#l25.20"></a><span id="l25.20">         shadowStartDate.day += 1;</span>
<a href="#l25.21"></a><span id="l25.21">       }</span>
<a href="#l25.22"></a><span id="l25.22">     }</span>
<a href="#l25.23"></a><span id="l25.23"> </span>
<a href="#l25.24"></a><span id="l25.24">     /**</span>
<a href="#l25.25"></a><span id="l25.25">      * Removes all dropShadows from the binding.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-minimonth.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-minimonth.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -900,17 +900,17 @@</span>
<a href="#l26.4"></a><span id="l26.4">       let firstWeekday = (7 + aMainDate.getDay() - this.weekStart) % 7;</span>
<a href="#l26.5"></a><span id="l26.5">       date.setDate(date.getDate() - firstWeekday);</span>
<a href="#l26.6"></a><span id="l26.6">       return date;</span>
<a href="#l26.7"></a><span id="l26.7">     }</span>
<a href="#l26.8"></a><span id="l26.8"> </span>
<a href="#l26.9"></a><span id="l26.9">     _getEndDate(aMainDate) {</span>
<a href="#l26.10"></a><span id="l26.10">       let date = this._getStartDate(aMainDate);</span>
<a href="#l26.11"></a><span id="l26.11">       let calbox = this.querySelector(&quot;.minimonth-calendar&quot;);</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-      let days = (calbox.childNodes.length - 1) * 7;</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+      let days = (calbox.children.length - 1) * 7;</span>
<a href="#l26.14"></a><span id="l26.14">       date.setDate(date.getDate() + days - 1);</span>
<a href="#l26.15"></a><span id="l26.15">       return date;</span>
<a href="#l26.16"></a><span id="l26.16">     }</span>
<a href="#l26.17"></a><span id="l26.17"> </span>
<a href="#l26.18"></a><span id="l26.18">     _sameDay(aDate1, aDate2) {</span>
<a href="#l26.19"></a><span id="l26.19">       if (</span>
<a href="#l26.20"></a><span id="l26.20">         aDate1 &amp;&amp;</span>
<a href="#l26.21"></a><span id="l26.21">         aDate2 &amp;&amp;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/base/modules/utils/calAlarmUtils.jsm</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/base/modules/utils/calAlarmUtils.jsm</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -138,35 +138,35 @@ var calalarms = {</span>
<a href="#l27.4"></a><span id="l27.4">       let image = node || aElement.ownerDocument.createXULElement(&quot;image&quot;);</span>
<a href="#l27.5"></a><span id="l27.5">       image.setAttribute(&quot;class&quot;, &quot;reminder-icon&quot;);</span>
<a href="#l27.6"></a><span id="l27.6">       image.setAttribute(&quot;value&quot;, reminder.action);</span>
<a href="#l27.7"></a><span id="l27.7">       return image;</span>
<a href="#l27.8"></a><span id="l27.8">     }</span>
<a href="#l27.9"></a><span id="l27.9"> </span>
<a href="#l27.10"></a><span id="l27.10">     // Fill up the icon box with the alarm icons, show max one icon per</span>
<a href="#l27.11"></a><span id="l27.11">     // alarm type.</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-    let countIconChildren = aElement.childNodes.length;</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+    let countIconChildren = aElement.children.length;</span>
<a href="#l27.14"></a><span id="l27.14">     let actionMap = {};</span>
<a href="#l27.15"></a><span id="l27.15">     let i, offset;</span>
<a href="#l27.16"></a><span id="l27.16">     for (i = 0, offset = 0; i &lt; aReminders.length; i++) {</span>
<a href="#l27.17"></a><span id="l27.17">       let reminder = aReminders[i];</span>
<a href="#l27.18"></a><span id="l27.18">       if (reminder.action in actionMap) {</span>
<a href="#l27.19"></a><span id="l27.19">         // Only show one icon of each type;</span>
<a href="#l27.20"></a><span id="l27.20">         offset++;</span>
<a href="#l27.21"></a><span id="l27.21">         continue;</span>
<a href="#l27.22"></a><span id="l27.22">       }</span>
<a href="#l27.23"></a><span id="l27.23">       actionMap[reminder.action] = true;</span>
<a href="#l27.24"></a><span id="l27.24"> </span>
<a href="#l27.25"></a><span id="l27.25">       if (i - offset &gt;= countIconChildren) {</span>
<a href="#l27.26"></a><span id="l27.26">         // Not enough nodes, append it.</span>
<a href="#l27.27"></a><span id="l27.27">         aElement.appendChild(setupActionImage(null, reminder));</span>
<a href="#l27.28"></a><span id="l27.28">       } else {</span>
<a href="#l27.29"></a><span id="l27.29">         // There is already a node there, change its properties</span>
<a href="#l27.30"></a><span id="l27.30" class="difflineminus">-        setupActionImage(aElement.childNodes[i - offset], reminder);</span>
<a href="#l27.31"></a><span id="l27.31" class="difflineplus">+        setupActionImage(aElement.children[i - offset], reminder);</span>
<a href="#l27.32"></a><span id="l27.32">       }</span>
<a href="#l27.33"></a><span id="l27.33">     }</span>
<a href="#l27.34"></a><span id="l27.34"> </span>
<a href="#l27.35"></a><span id="l27.35">     // Remove unused image nodes</span>
<a href="#l27.36"></a><span id="l27.36">     for (i -= offset; i &lt; countIconChildren; i++) {</span>
<a href="#l27.37"></a><span id="l27.37" class="difflineminus">-      aElement.childNodes[i].remove();</span>
<a href="#l27.38"></a><span id="l27.38" class="difflineplus">+      aElement.children[i].remove();</span>
<a href="#l27.39"></a><span id="l27.39">     }</span>
<a href="#l27.40"></a><span id="l27.40">   },</span>
<a href="#l27.41"></a><span id="l27.41"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/base/modules/utils/calDataUtils.jsm</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/base/modules/utils/calDataUtils.jsm</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -232,35 +232,31 @@ var caldata = {</span>
<a href="#l28.4"></a><span id="l28.4">     aItem,</span>
<a href="#l28.5"></a><span id="l28.5">     comptor,</span>
<a href="#l28.6"></a><span id="l28.6">     discardDuplicates,</span>
<a href="#l28.7"></a><span id="l28.7">     itemAccessor</span>
<a href="#l28.8"></a><span id="l28.8">   ) {</span>
<a href="#l28.9"></a><span id="l28.9">     let accessor = itemAccessor || caldata.binaryInsertNodeDefaultAccessor;</span>
<a href="#l28.10"></a><span id="l28.10"> </span>
<a href="#l28.11"></a><span id="l28.11">     // Get the index of the node before which the inserNode will be inserted</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-    let newIndex = caldata.binarySearch(</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineminus">-      Array.from(parentNode.childNodes, accessor),</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineminus">-      aItem,</span>
<a href="#l28.15"></a><span id="l28.15" class="difflineminus">-      comptor</span>
<a href="#l28.16"></a><span id="l28.16" class="difflineminus">-    );</span>
<a href="#l28.17"></a><span id="l28.17" class="difflineplus">+    let newIndex = caldata.binarySearch(Array.from(parentNode.children, accessor), aItem, comptor);</span>
<a href="#l28.18"></a><span id="l28.18"> </span>
<a href="#l28.19"></a><span id="l28.19">     if (newIndex &lt; 0) {</span>
<a href="#l28.20"></a><span id="l28.20">       parentNode.appendChild(insertNode);</span>
<a href="#l28.21"></a><span id="l28.21">       newIndex = 0;</span>
<a href="#l28.22"></a><span id="l28.22">     } else if (</span>
<a href="#l28.23"></a><span id="l28.23">       !discardDuplicates ||</span>
<a href="#l28.24"></a><span id="l28.24">       comptor(</span>
<a href="#l28.25"></a><span id="l28.25" class="difflineminus">-        accessor(parentNode.childNodes[Math.min(newIndex, parentNode.childNodes.length - 1)]),</span>
<a href="#l28.26"></a><span id="l28.26" class="difflineplus">+        accessor(parentNode.children[Math.min(newIndex, parentNode.children.length - 1)]),</span>
<a href="#l28.27"></a><span id="l28.27">         aItem</span>
<a href="#l28.28"></a><span id="l28.28">       ) &gt;= 0</span>
<a href="#l28.29"></a><span id="l28.29">     ) {</span>
<a href="#l28.30"></a><span id="l28.30">       // Only add the node if duplicates should not be discarded, or if</span>
<a href="#l28.31"></a><span id="l28.31">       // they should and the childNode[newIndex] == node.</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineminus">-      let node = parentNode.childNodes[newIndex];</span>
<a href="#l28.33"></a><span id="l28.33" class="difflineplus">+      let node = parentNode.children[newIndex];</span>
<a href="#l28.34"></a><span id="l28.34">       parentNode.insertBefore(insertNode, node);</span>
<a href="#l28.35"></a><span id="l28.35">     }</span>
<a href="#l28.36"></a><span id="l28.36">     return newIndex;</span>
<a href="#l28.37"></a><span id="l28.37">   },</span>
<a href="#l28.38"></a><span id="l28.38">   binaryInsertNodeDefaultAccessor: n =&gt; n.item,</span>
<a href="#l28.39"></a><span id="l28.39"> </span>
<a href="#l28.40"></a><span id="l28.40">   /**</span>
<a href="#l28.41"></a><span id="l28.41">    * Insert an item into the given array, using binary search. See binarySearch</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/base/modules/utils/calViewUtils.jsm</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/base/modules/utils/calViewUtils.jsm</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -42,19 +42,19 @@ var calview = {</span>
<a href="#l29.4"></a><span id="l29.4">    * Removes those childnodes from a node that contain a specified attribute</span>
<a href="#l29.5"></a><span id="l29.5">    * and where the value of this attribute matches a passed value</span>
<a href="#l29.6"></a><span id="l29.6">    *</span>
<a href="#l29.7"></a><span id="l29.7">    * @param aParentNode   The parent node that contains the child nodes in question</span>
<a href="#l29.8"></a><span id="l29.8">    * @param aAttribute    The name of the attribute</span>
<a href="#l29.9"></a><span id="l29.9">    * @param aAttribute    The value of the attribute</span>
<a href="#l29.10"></a><span id="l29.10">    */</span>
<a href="#l29.11"></a><span id="l29.11">   removeChildElementsByAttribute: function(aParentNode, aAttribute, aValue) {</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-    let childNode = aParentNode.lastChild;</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+    let childNode = aParentNode.lastElementChild;</span>
<a href="#l29.14"></a><span id="l29.14">     while (childNode) {</span>
<a href="#l29.15"></a><span id="l29.15" class="difflineminus">-      let prevChildNode = childNode.previousSibling;</span>
<a href="#l29.16"></a><span id="l29.16" class="difflineplus">+      let prevChildNode = childNode.previousElementSibling;</span>
<a href="#l29.17"></a><span id="l29.17">       if (!aAttribute || aAttribute === undefined) {</span>
<a href="#l29.18"></a><span id="l29.18">         childNode.remove();</span>
<a href="#l29.19"></a><span id="l29.19">       } else if (!aValue || aValue === undefined) {</span>
<a href="#l29.20"></a><span id="l29.20">         childNode.remove();</span>
<a href="#l29.21"></a><span id="l29.21">       } else if (</span>
<a href="#l29.22"></a><span id="l29.22">         childNode &amp;&amp;</span>
<a href="#l29.23"></a><span id="l29.23">         childNode.hasAttribute(aAttribute) &amp;&amp;</span>
<a href="#l29.24"></a><span id="l29.24">         childNode.getAttribute(aAttribute) == aValue</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -2482,21 +2482,19 @@ function deleteAllAttachments() {</span>
<a href="#l30.4"></a><span id="l30.4">       window,</span>
<a href="#l30.5"></a><span id="l30.5">       removeTitle,</span>
<a href="#l30.6"></a><span id="l30.6">       removeText.replace(&quot;#1&quot;, itemCount),</span>
<a href="#l30.7"></a><span id="l30.7">       {}</span>
<a href="#l30.8"></a><span id="l30.8">     );</span>
<a href="#l30.9"></a><span id="l30.9">   }</span>
<a href="#l30.10"></a><span id="l30.10"> </span>
<a href="#l30.11"></a><span id="l30.11">   if (canRemove) {</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-    let child;</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineminus">-    while (documentLink.hasChildNodes()) {</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineminus">-      child = documentLink.lastChild;</span>
<a href="#l30.15"></a><span id="l30.15" class="difflineminus">-      child.attachment = null;</span>
<a href="#l30.16"></a><span id="l30.16" class="difflineminus">-      child.remove();</span>
<a href="#l30.17"></a><span id="l30.17" class="difflineplus">+    while (documentLink.lastChild) {</span>
<a href="#l30.18"></a><span id="l30.18" class="difflineplus">+      documentLink.lastChild.attachment = null;</span>
<a href="#l30.19"></a><span id="l30.19" class="difflineplus">+      documentLink.lastChild.remove();</span>
<a href="#l30.20"></a><span id="l30.20">     }</span>
<a href="#l30.21"></a><span id="l30.21">     gAttachMap = {};</span>
<a href="#l30.22"></a><span id="l30.22">   }</span>
<a href="#l30.23"></a><span id="l30.23">   updateAttachment();</span>
<a href="#l30.24"></a><span id="l30.24"> }</span>
<a href="#l30.25"></a><span id="l30.25"> </span>
<a href="#l30.26"></a><span id="l30.26"> /**</span>
<a href="#l30.27"></a><span id="l30.27">  * Opens the selected attachment using the external protocol service.</span>
<a href="#l30.28"></a><span id="l30.28" class="difflineat">@@ -2711,19 +2709,19 @@ function updateCalendar() {</span>
<a href="#l30.29"></a><span id="l30.29">     }</span>
<a href="#l30.30"></a><span id="l30.30"> </span>
<a href="#l30.31"></a><span id="l30.31">     // disable repeat menupopup if this is an occurrence</span>
<a href="#l30.32"></a><span id="l30.32">     item = window.calendarItem;</span>
<a href="#l30.33"></a><span id="l30.33">     if (item.parentItem != item) {</span>
<a href="#l30.34"></a><span id="l30.34">       document.getElementById(&quot;item-repeat&quot;).setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l30.35"></a><span id="l30.35">       document.getElementById(&quot;repeat-until-datepicker&quot;).setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l30.36"></a><span id="l30.36">       let repeatDetails = document.getElementById(&quot;repeat-details&quot;);</span>
<a href="#l30.37"></a><span id="l30.37" class="difflineminus">-      let numChilds = repeatDetails.childNodes.length;</span>
<a href="#l30.38"></a><span id="l30.38" class="difflineplus">+      let numChilds = repeatDetails.children.length;</span>
<a href="#l30.39"></a><span id="l30.39">       for (let i = 0; i &lt; numChilds; i++) {</span>
<a href="#l30.40"></a><span id="l30.40" class="difflineminus">-        let node = repeatDetails.childNodes[i];</span>
<a href="#l30.41"></a><span id="l30.41" class="difflineplus">+        let node = repeatDetails.children[i];</span>
<a href="#l30.42"></a><span id="l30.42">         node.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l30.43"></a><span id="l30.43">         node.removeAttribute(&quot;class&quot;);</span>
<a href="#l30.44"></a><span id="l30.44">         node.removeAttribute(&quot;onclick&quot;);</span>
<a href="#l30.45"></a><span id="l30.45">       }</span>
<a href="#l30.46"></a><span id="l30.46">     }</span>
<a href="#l30.47"></a><span id="l30.47"> </span>
<a href="#l30.48"></a><span id="l30.48">     // If the item is a proxy occurrence/instance, a few things aren't</span>
<a href="#l30.49"></a><span id="l30.49">     // valid.</span>
<a href="#l30.50"></a><span id="l30.50" class="difflineat">@@ -3459,26 +3457,26 @@ function showTimezonePopup(event, dateTi</span>
<a href="#l30.51"></a><span id="l30.51">   timezonePopup.editTimezone = editFunc;</span>
<a href="#l30.52"></a><span id="l30.52">   timezonePopup.dateTime = dateTime;</span>
<a href="#l30.53"></a><span id="l30.53"> </span>
<a href="#l30.54"></a><span id="l30.54">   // Set up the default timezone item</span>
<a href="#l30.55"></a><span id="l30.55">   timezoneDefaultItem.value = defaultTimezone.tzid;</span>
<a href="#l30.56"></a><span id="l30.56">   timezoneDefaultItem.label = defaultTimezone.displayName;</span>
<a href="#l30.57"></a><span id="l30.57"> </span>
<a href="#l30.58"></a><span id="l30.58">   // Clear out any old recent timezones</span>
<a href="#l30.59"></a><span id="l30.59" class="difflineminus">-  while (timezoneDefaultItem.nextSibling != timezoneSeparator) {</span>
<a href="#l30.60"></a><span id="l30.60" class="difflineminus">-    timezoneDefaultItem.nextSibling.remove();</span>
<a href="#l30.61"></a><span id="l30.61" class="difflineplus">+  while (timezoneDefaultItem.nextElementSibling != timezoneSeparator) {</span>
<a href="#l30.62"></a><span id="l30.62" class="difflineplus">+    timezoneDefaultItem.nextElementSibling.remove();</span>
<a href="#l30.63"></a><span id="l30.63">   }</span>
<a href="#l30.64"></a><span id="l30.64"> </span>
<a href="#l30.65"></a><span id="l30.65">   // Fill in the new recent timezones</span>
<a href="#l30.66"></a><span id="l30.66">   for (let timezone of recentTimezones) {</span>
<a href="#l30.67"></a><span id="l30.67">     let menuItem = document.createXULElement(&quot;menuitem&quot;);</span>
<a href="#l30.68"></a><span id="l30.68">     menuItem.setAttribute(&quot;value&quot;, timezone.tzid);</span>
<a href="#l30.69"></a><span id="l30.69">     menuItem.setAttribute(&quot;label&quot;, timezone.displayName);</span>
<a href="#l30.70"></a><span id="l30.70" class="difflineminus">-    timezonePopup.insertBefore(menuItem, timezoneDefaultItem.nextSibling);</span>
<a href="#l30.71"></a><span id="l30.71" class="difflineplus">+    timezonePopup.insertBefore(menuItem, timezoneDefaultItem.nextElementSibling);</span>
<a href="#l30.72"></a><span id="l30.72">   }</span>
<a href="#l30.73"></a><span id="l30.73"> </span>
<a href="#l30.74"></a><span id="l30.74">   // Show the popup</span>
<a href="#l30.75"></a><span id="l30.75">   timezonePopup.openPopup(event.target, &quot;after_start&quot;, 0, 0, true);</span>
<a href="#l30.76"></a><span id="l30.76"> }</span>
<a href="#l30.77"></a><span id="l30.77"> </span>
<a href="#l30.78"></a><span id="l30.78"> /**</span>
<a href="#l30.79"></a><span id="l30.79">  * Common function of edit(Start|End)Timezone() to prompt the user for a</span>
<a href="#l30.80"></a><span id="l30.80" class="difflineat">@@ -3918,27 +3916,27 @@ function updateRepeatDetails() {</span>
<a href="#l30.81"></a><span id="l30.81"> </span>
<a href="#l30.82"></a><span id="l30.82">     if (!detailsString) {</span>
<a href="#l30.83"></a><span id="l30.83">       detailsString = cal.l10n.getString(&quot;calendar-event-dialog&quot;, &quot;ruleTooComplex&quot;);</span>
<a href="#l30.84"></a><span id="l30.84">     }</span>
<a href="#l30.85"></a><span id="l30.85"> </span>
<a href="#l30.86"></a><span id="l30.86">     // Now display the string...</span>
<a href="#l30.87"></a><span id="l30.87">     let lines = detailsString.split(&quot;\n&quot;);</span>
<a href="#l30.88"></a><span id="l30.88">     repeatDetails.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l30.89"></a><span id="l30.89" class="difflineminus">-    while (repeatDetails.childNodes.length &gt; lines.length) {</span>
<a href="#l30.90"></a><span id="l30.90" class="difflineplus">+    while (repeatDetails.children.length &gt; lines.length) {</span>
<a href="#l30.91"></a><span id="l30.91">       repeatDetails.lastChild.remove();</span>
<a href="#l30.92"></a><span id="l30.92">     }</span>
<a href="#l30.93"></a><span id="l30.93" class="difflineminus">-    let numChilds = repeatDetails.childNodes.length;</span>
<a href="#l30.94"></a><span id="l30.94" class="difflineplus">+    let numChilds = repeatDetails.children.length;</span>
<a href="#l30.95"></a><span id="l30.95">     for (let i = 0; i &lt; lines.length; i++) {</span>
<a href="#l30.96"></a><span id="l30.96">       if (i &gt;= numChilds) {</span>
<a href="#l30.97"></a><span id="l30.97" class="difflineminus">-        let newNode = repeatDetails.childNodes[0].cloneNode(true);</span>
<a href="#l30.98"></a><span id="l30.98" class="difflineplus">+        let newNode = repeatDetails.children[0].cloneNode(true);</span>
<a href="#l30.99"></a><span id="l30.99">         repeatDetails.appendChild(newNode);</span>
<a href="#l30.100"></a><span id="l30.100">       }</span>
<a href="#l30.101"></a><span id="l30.101" class="difflineminus">-      repeatDetails.childNodes[i].value = lines[i];</span>
<a href="#l30.102"></a><span id="l30.102" class="difflineminus">-      repeatDetails.childNodes[i].setAttribute(&quot;tooltiptext&quot;, detailsString);</span>
<a href="#l30.103"></a><span id="l30.103" class="difflineplus">+      repeatDetails.children[i].value = lines[i];</span>
<a href="#l30.104"></a><span id="l30.104" class="difflineplus">+      repeatDetails.children[i].setAttribute(&quot;tooltiptext&quot;, detailsString);</span>
<a href="#l30.105"></a><span id="l30.105">     }</span>
<a href="#l30.106"></a><span id="l30.106">   } else {</span>
<a href="#l30.107"></a><span id="l30.107">     let repeatDetails = document.getElementById(&quot;repeat-details&quot;);</span>
<a href="#l30.108"></a><span id="l30.108">     repeatDetails.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l30.109"></a><span id="l30.109">   }</span>
<a href="#l30.110"></a><span id="l30.110"> }</span>
<a href="#l30.111"></a><span id="l30.111"> </span>
<a href="#l30.112"></a><span id="l30.112"> /**</span>
<a href="#l30.113"></a><span id="l30.113" class="difflineat">@@ -3973,17 +3971,17 @@ function attendeeDblClick(aEvent) {</span>
<a href="#l30.114"></a><span id="l30.114">  *</span>
<a href="#l30.115"></a><span id="l30.115">  * @param aEvent         The popupshowing event</span>
<a href="#l30.116"></a><span id="l30.116">  */</span>
<a href="#l30.117"></a><span id="l30.117"> function setAttendeeContext(aEvent) {</span>
<a href="#l30.118"></a><span id="l30.118">   if (window.attendees.length == 0) {</span>
<a href="#l30.119"></a><span id="l30.119">     // we just need the option to open the attendee dialog in this case</span>
<a href="#l30.120"></a><span id="l30.120">     let popup = document.getElementById(&quot;attendee-popup&quot;);</span>
<a href="#l30.121"></a><span id="l30.121">     let invite = document.getElementById(&quot;attendee-popup-invite-menuitem&quot;);</span>
<a href="#l30.122"></a><span id="l30.122" class="difflineminus">-    for (let node of popup.childNodes) {</span>
<a href="#l30.123"></a><span id="l30.123" class="difflineplus">+    for (let node of popup.children) {</span>
<a href="#l30.124"></a><span id="l30.124">       if (node == invite) {</span>
<a href="#l30.125"></a><span id="l30.125">         node.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l30.126"></a><span id="l30.126">       } else {</span>
<a href="#l30.127"></a><span id="l30.127">         node.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l30.128"></a><span id="l30.128">       }</span>
<a href="#l30.129"></a><span id="l30.129">     }</span>
<a href="#l30.130"></a><span id="l30.130">   } else {</span>
<a href="#l30.131"></a><span id="l30.131">     if (window.attendees.length &gt; 1) {</span>
<a href="#l30.132"></a><span id="l30.132" class="difflineat">@@ -4191,23 +4189,23 @@ function displayCounterProposal() {</span>
<a href="#l30.133"></a><span id="l30.133">       if (proposal.proposed &amp;&amp; !proposal.original) {</span>
<a href="#l30.134"></a><span id="l30.134">         comment = proposal.proposed;</span>
<a href="#l30.135"></a><span id="l30.135">       }</span>
<a href="#l30.136"></a><span id="l30.136">     } else {</span>
<a href="#l30.137"></a><span id="l30.137">       let label = lookupCounterLabel(proposal);</span>
<a href="#l30.138"></a><span id="l30.138">       let value = formatCounterValue(proposal);</span>
<a href="#l30.139"></a><span id="l30.139">       if (label &amp;&amp; value) {</span>
<a href="#l30.140"></a><span id="l30.140">         // setup label node</span>
<a href="#l30.141"></a><span id="l30.141" class="difflineminus">-        let propLabel = propLabels.firstChild.cloneNode(false);</span>
<a href="#l30.142"></a><span id="l30.142" class="difflineplus">+        let propLabel = propLabels.firstElementChild.cloneNode(false);</span>
<a href="#l30.143"></a><span id="l30.143">         propLabel.id = propLabel.id + &quot;-&quot; + idCounter;</span>
<a href="#l30.144"></a><span id="l30.144">         propLabel.control = propLabel.control + &quot;-&quot; + idCounter;</span>
<a href="#l30.145"></a><span id="l30.145">         propLabel.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l30.146"></a><span id="l30.146">         propLabel.value = label;</span>
<a href="#l30.147"></a><span id="l30.147">         // setup value node</span>
<a href="#l30.148"></a><span id="l30.148" class="difflineminus">-        let propValue = propValues.firstChild.cloneNode(false);</span>
<a href="#l30.149"></a><span id="l30.149" class="difflineplus">+        let propValue = propValues.firstElementChild.cloneNode(false);</span>
<a href="#l30.150"></a><span id="l30.150">         propValue.id = propLabel.control;</span>
<a href="#l30.151"></a><span id="l30.151">         propValue.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l30.152"></a><span id="l30.152">         propValue.value = value;</span>
<a href="#l30.153"></a><span id="l30.153">         // append nodes</span>
<a href="#l30.154"></a><span id="l30.154">         propLabels.appendChild(propLabel);</span>
<a href="#l30.155"></a><span id="l30.155">         propValues.appendChild(propValue);</span>
<a href="#l30.156"></a><span id="l30.156">         idCounter++;</span>
<a href="#l30.157"></a><span id="l30.157">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-panel.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-panel.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -538,17 +538,17 @@ function editPrivacy(aTarget, aEvent) {</span>
<a href="#l31.4"></a><span id="l31.4">  * @param {string[]}  aArg.privacyValues  The possible privacy values</span>
<a href="#l31.5"></a><span id="l31.5">  */</span>
<a href="#l31.6"></a><span id="l31.6"> function updatePrivacy(aArg) {</span>
<a href="#l31.7"></a><span id="l31.7">   if (aArg.hasPrivacy) {</span>
<a href="#l31.8"></a><span id="l31.8">     // Update privacy capabilities (toolbar)</span>
<a href="#l31.9"></a><span id="l31.9">     let menupopup = document.getElementById(&quot;event-privacy-menupopup&quot;);</span>
<a href="#l31.10"></a><span id="l31.10">     if (menupopup) {</span>
<a href="#l31.11"></a><span id="l31.11">       // Only update the toolbar if the button is actually there</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-      for (let node of menupopup.childNodes) {</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+      for (let node of menupopup.children) {</span>
<a href="#l31.14"></a><span id="l31.14">         let currentProvider = node.getAttribute(&quot;provider&quot;);</span>
<a href="#l31.15"></a><span id="l31.15">         if (node.hasAttribute(&quot;privacy&quot;)) {</span>
<a href="#l31.16"></a><span id="l31.16">           let currentPrivacyValue = node.getAttribute(&quot;privacy&quot;);</span>
<a href="#l31.17"></a><span id="l31.17">           // Collapsed state</span>
<a href="#l31.18"></a><span id="l31.18"> </span>
<a href="#l31.19"></a><span id="l31.19">           // Hide the toolbar if the value is unsupported or is for a</span>
<a href="#l31.20"></a><span id="l31.20">           // specific provider and doesn't belong to the current provider.</span>
<a href="#l31.21"></a><span id="l31.21">           if (</span>
<a href="#l31.22"></a><span id="l31.22" class="difflineat">@@ -568,17 +568,17 @@ function updatePrivacy(aArg) {</span>
<a href="#l31.23"></a><span id="l31.23">           }</span>
<a href="#l31.24"></a><span id="l31.24">         }</span>
<a href="#l31.25"></a><span id="l31.25">       }</span>
<a href="#l31.26"></a><span id="l31.26">     }</span>
<a href="#l31.27"></a><span id="l31.27"> </span>
<a href="#l31.28"></a><span id="l31.28">     // Update privacy capabilities (menu) but only if we are not in a tab.</span>
<a href="#l31.29"></a><span id="l31.29">     if (!gTabmail) {</span>
<a href="#l31.30"></a><span id="l31.30">       menupopup = document.getElementById(&quot;options-privacy-menupopup&quot;);</span>
<a href="#l31.31"></a><span id="l31.31" class="difflineminus">-      for (let node of menupopup.childNodes) {</span>
<a href="#l31.32"></a><span id="l31.32" class="difflineplus">+      for (let node of menupopup.children) {</span>
<a href="#l31.33"></a><span id="l31.33">         let currentProvider = node.getAttribute(&quot;provider&quot;);</span>
<a href="#l31.34"></a><span id="l31.34">         if (node.hasAttribute(&quot;privacy&quot;)) {</span>
<a href="#l31.35"></a><span id="l31.35">           let currentPrivacyValue = node.getAttribute(&quot;privacy&quot;);</span>
<a href="#l31.36"></a><span id="l31.36">           // Collapsed state</span>
<a href="#l31.37"></a><span id="l31.37"> </span>
<a href="#l31.38"></a><span id="l31.38">           // Hide the menu if the value is unsupported or is for a</span>
<a href="#l31.39"></a><span id="l31.39">           // specific provider and doesn't belong to the current provider.</span>
<a href="#l31.40"></a><span id="l31.40">           if (</span>
<a href="#l31.41"></a><span id="l31.41" class="difflineat">@@ -598,17 +598,17 @@ function updatePrivacy(aArg) {</span>
<a href="#l31.42"></a><span id="l31.42">           }</span>
<a href="#l31.43"></a><span id="l31.43">         }</span>
<a href="#l31.44"></a><span id="l31.44">       }</span>
<a href="#l31.45"></a><span id="l31.45">     }</span>
<a href="#l31.46"></a><span id="l31.46"> </span>
<a href="#l31.47"></a><span id="l31.47">     // Update privacy capabilities (statusbar)</span>
<a href="#l31.48"></a><span id="l31.48">     let privacyPanel = document.getElementById(&quot;status-privacy&quot;);</span>
<a href="#l31.49"></a><span id="l31.49">     let hasAnyPrivacyValue = false;</span>
<a href="#l31.50"></a><span id="l31.50" class="difflineminus">-    for (let node of privacyPanel.childNodes) {</span>
<a href="#l31.51"></a><span id="l31.51" class="difflineplus">+    for (let node of privacyPanel.children) {</span>
<a href="#l31.52"></a><span id="l31.52">       let currentProvider = node.getAttribute(&quot;provider&quot;);</span>
<a href="#l31.53"></a><span id="l31.53">       if (node.hasAttribute(&quot;privacy&quot;)) {</span>
<a href="#l31.54"></a><span id="l31.54">         let currentPrivacyValue = node.getAttribute(&quot;privacy&quot;);</span>
<a href="#l31.55"></a><span id="l31.55"> </span>
<a href="#l31.56"></a><span id="l31.56">         // Hide the panel if the value is unsupported or is for a</span>
<a href="#l31.57"></a><span id="l31.57">         // specific provider and doesn't belong to the current provider,</span>
<a href="#l31.58"></a><span id="l31.58">         // or is not the items privacy value</span>
<a href="#l31.59"></a><span id="l31.59">         if (</span>
<a href="#l31.60"></a><span id="l31.60" class="difflineat">@@ -692,17 +692,17 @@ function updatePriority(aArg) {</span>
<a href="#l31.61"></a><span id="l31.61">     // Status bar panel</span>
<a href="#l31.62"></a><span id="l31.62">     let priorityPanel = document.getElementById(&quot;status-priority&quot;);</span>
<a href="#l31.63"></a><span id="l31.63">     if (priorityLevel == &quot;none&quot;) {</span>
<a href="#l31.64"></a><span id="l31.64">       // If the priority is none, don't show the status bar panel</span>
<a href="#l31.65"></a><span id="l31.65">       priorityPanel.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l31.66"></a><span id="l31.66">     } else {</span>
<a href="#l31.67"></a><span id="l31.67">       priorityPanel.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l31.68"></a><span id="l31.68">       let foundPriority = false;</span>
<a href="#l31.69"></a><span id="l31.69" class="difflineminus">-      for (let node of priorityPanel.childNodes) {</span>
<a href="#l31.70"></a><span id="l31.70" class="difflineplus">+      for (let node of priorityPanel.children) {</span>
<a href="#l31.71"></a><span id="l31.71">         if (foundPriority) {</span>
<a href="#l31.72"></a><span id="l31.72">           node.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l31.73"></a><span id="l31.73">         } else {</span>
<a href="#l31.74"></a><span id="l31.74">           node.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l31.75"></a><span id="l31.75">         }</span>
<a href="#l31.76"></a><span id="l31.76">         if (node.getAttribute(&quot;value&quot;) == priorityLevel) {</span>
<a href="#l31.77"></a><span id="l31.77">           foundPriority = true;</span>
<a href="#l31.78"></a><span id="l31.78">         }</span>
<a href="#l31.79"></a><span id="l31.79" class="difflineat">@@ -961,17 +961,17 @@ function onCommandViewToolbar(aToolbarId</span>
<a href="#l31.80"></a><span id="l31.80">  * all customizable toolbars.</span>
<a href="#l31.81"></a><span id="l31.81">  *</span>
<a href="#l31.82"></a><span id="l31.82">  * @param {boolean} aToolboxChanged  When true the toolbox has changed</span>
<a href="#l31.83"></a><span id="l31.83">  */</span>
<a href="#l31.84"></a><span id="l31.84"> function dialogToolboxCustomizeDone(aToolboxChanged) {</span>
<a href="#l31.85"></a><span id="l31.85">   // Re-enable menu items (disabled during toolbar customization).</span>
<a href="#l31.86"></a><span id="l31.86">   let menubarId = gTabmail ? &quot;mail-menubar&quot; : &quot;event-menubar&quot;;</span>
<a href="#l31.87"></a><span id="l31.87">   let menubar = document.getElementById(menubarId);</span>
<a href="#l31.88"></a><span id="l31.88" class="difflineminus">-  for (let menuitem of menubar.childNodes) {</span>
<a href="#l31.89"></a><span id="l31.89" class="difflineplus">+  for (let menuitem of menubar.children) {</span>
<a href="#l31.90"></a><span id="l31.90">     menuitem.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l31.91"></a><span id="l31.91">   }</span>
<a href="#l31.92"></a><span id="l31.92"> </span>
<a href="#l31.93"></a><span id="l31.93">   // make sure our toolbar buttons have the correct enabled state restored to them...</span>
<a href="#l31.94"></a><span id="l31.94">   document.commandDispatcher.updateCommands(&quot;itemCommands&quot;);</span>
<a href="#l31.95"></a><span id="l31.95"> </span>
<a href="#l31.96"></a><span id="l31.96">   // Enable the toolbar context menu items</span>
<a href="#l31.97"></a><span id="l31.97">   document.getElementById(&quot;cmd_customize&quot;).removeAttribute(&quot;disabled&quot;);</span>
<a href="#l31.98"></a><span id="l31.98" class="difflineat">@@ -990,17 +990,17 @@ function onCommandCustomize() {</span>
<a href="#l31.99"></a><span id="l31.99">   let toolboxId = &quot;event-toolbox&quot;;</span>
<a href="#l31.100"></a><span id="l31.100"> </span>
<a href="#l31.101"></a><span id="l31.101">   let toolbox = document.getElementById(toolboxId);</span>
<a href="#l31.102"></a><span id="l31.102">   toolbox.customizeDone = dialogToolboxCustomizeDone;</span>
<a href="#l31.103"></a><span id="l31.103"> </span>
<a href="#l31.104"></a><span id="l31.104">   // Disable menu items during toolbar customization.</span>
<a href="#l31.105"></a><span id="l31.105">   let menubarId = gTabmail ? &quot;mail-menubar&quot; : &quot;event-menubar&quot;;</span>
<a href="#l31.106"></a><span id="l31.106">   let menubar = document.getElementById(menubarId);</span>
<a href="#l31.107"></a><span id="l31.107" class="difflineminus">-  for (let menuitem of menubar.childNodes) {</span>
<a href="#l31.108"></a><span id="l31.108" class="difflineplus">+  for (let menuitem of menubar.children) {</span>
<a href="#l31.109"></a><span id="l31.109">     menuitem.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l31.110"></a><span id="l31.110">   }</span>
<a href="#l31.111"></a><span id="l31.111"> </span>
<a href="#l31.112"></a><span id="l31.112">   // Disable the toolbar context menu items</span>
<a href="#l31.113"></a><span id="l31.113">   document.getElementById(&quot;cmd_customize&quot;).setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l31.114"></a><span id="l31.114"> </span>
<a href="#l31.115"></a><span id="l31.115">   let wintype = document.documentElement.getAttribute(&quot;windowtype&quot;);</span>
<a href="#l31.116"></a><span id="l31.116">   wintype = wintype.replace(/:/g, &quot;&quot;);</span>
<a href="#l31.117"></a><span id="l31.117" class="difflineat">@@ -1025,17 +1025,17 @@ function onCommandCustomize() {</span>
<a href="#l31.118"></a><span id="l31.118"> function loadCloudProviders(aItemObjects) {</span>
<a href="#l31.119"></a><span id="l31.119">   /**</span>
<a href="#l31.120"></a><span id="l31.120">    * Deletes any existing menu items in aParentNode that have a</span>
<a href="#l31.121"></a><span id="l31.121">    * cloudProviderAccountKey attribute.</span>
<a href="#l31.122"></a><span id="l31.122">    *</span>
<a href="#l31.123"></a><span id="l31.123">    * @param {Node} aParentNode  A menupopup containing menu items</span>
<a href="#l31.124"></a><span id="l31.124">    */</span>
<a href="#l31.125"></a><span id="l31.125">   function deleteAlreadyExisting(aParentNode) {</span>
<a href="#l31.126"></a><span id="l31.126" class="difflineminus">-    for (let node of aParentNode.childNodes) {</span>
<a href="#l31.127"></a><span id="l31.127" class="difflineplus">+    for (let node of aParentNode.children) {</span>
<a href="#l31.128"></a><span id="l31.128">       if (node.cloudProviderAccountKey) {</span>
<a href="#l31.129"></a><span id="l31.129">         aParentNode.removeChild(node);</span>
<a href="#l31.130"></a><span id="l31.130">       }</span>
<a href="#l31.131"></a><span id="l31.131">     }</span>
<a href="#l31.132"></a><span id="l31.132">   }</span>
<a href="#l31.133"></a><span id="l31.133"> </span>
<a href="#l31.134"></a><span id="l31.134">   // Delete any existing menu items with a cloudProviderAccountKey,</span>
<a href="#l31.135"></a><span id="l31.135">   // needed for the tab case to prevent duplicate menu items, and</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -166,17 +166,17 @@ var calendarItemTabType = {</span>
<a href="#l32.4"></a><span id="l32.4">    *</span>
<a href="#l32.5"></a><span id="l32.5">    * @param {Object} aTab   A tab info object</span>
<a href="#l32.6"></a><span id="l32.6">    * @param {Object} aArgs  Contains data about the event/task</span>
<a href="#l32.7"></a><span id="l32.7">    */</span>
<a href="#l32.8"></a><span id="l32.8">   openTab: function(aTab, aArgs) {</span>
<a href="#l32.9"></a><span id="l32.9">     // Create a clone to use for this tab. Remove the cloned toolbox</span>
<a href="#l32.10"></a><span id="l32.10">     // and move the original toolbox into its place. There is only</span>
<a href="#l32.11"></a><span id="l32.11">     // one toolbox/toolbar so its settings are the same for all item tabs.</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-    let original = document.getElementById(&quot;lightningItemPanel&quot;).firstChild;</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+    let original = document.getElementById(&quot;lightningItemPanel&quot;).firstElementChild;</span>
<a href="#l32.14"></a><span id="l32.14">     let clone = original.cloneNode(true);</span>
<a href="#l32.15"></a><span id="l32.15"> </span>
<a href="#l32.16"></a><span id="l32.16">     clone.querySelector(&quot;toolbox&quot;).remove();</span>
<a href="#l32.17"></a><span id="l32.17">     moveEventToolbox(clone);</span>
<a href="#l32.18"></a><span id="l32.18">     clone.setAttribute(&quot;id&quot;, &quot;calendarItemTab&quot; + this.idNumber);</span>
<a href="#l32.19"></a><span id="l32.19"> </span>
<a href="#l32.20"></a><span id="l32.20">     if (aTab.mode.type == &quot;calendarTask&quot;) {</span>
<a href="#l32.21"></a><span id="l32.21">       // For task tabs, css class hides event-specific toolbar buttons.</span>
<a href="#l32.22"></a><span id="l32.22" class="difflineat">@@ -233,27 +233,27 @@ var calendarItemTabType = {</span>
<a href="#l32.23"></a><span id="l32.23"> </span>
<a href="#l32.24"></a><span id="l32.24">     // clear statusbar</span>
<a href="#l32.25"></a><span id="l32.25">     let statusbar = document.getElementById(&quot;status-bar&quot;);</span>
<a href="#l32.26"></a><span id="l32.26">     let items = statusbar.getElementsByClassName(&quot;event-dialog&quot;);</span>
<a href="#l32.27"></a><span id="l32.27">     for (let item of items) {</span>
<a href="#l32.28"></a><span id="l32.28">       item.setAttribute(&quot;collapsed&quot;, true);</span>
<a href="#l32.29"></a><span id="l32.29">     }</span>
<a href="#l32.30"></a><span id="l32.30">     // move toolbox to the place where it can be accessed later</span>
<a href="#l32.31"></a><span id="l32.31" class="difflineminus">-    let to = document.getElementById(&quot;lightningItemPanel&quot;).firstChild;</span>
<a href="#l32.32"></a><span id="l32.32" class="difflineplus">+    let to = document.getElementById(&quot;lightningItemPanel&quot;).firstElementChild;</span>
<a href="#l32.33"></a><span id="l32.33">     moveEventToolbox(to);</span>
<a href="#l32.34"></a><span id="l32.34">   },</span>
<a href="#l32.35"></a><span id="l32.35">   /**</span>
<a href="#l32.36"></a><span id="l32.36">    * Called when a tab is activated / shown.  The opposite of saveTabState.</span>
<a href="#l32.37"></a><span id="l32.37">    *</span>
<a href="#l32.38"></a><span id="l32.38">    * @param {Object} aTab  A tab info object</span>
<a href="#l32.39"></a><span id="l32.39">    */</span>
<a href="#l32.40"></a><span id="l32.40">   showTab: function(aTab) {</span>
<a href="#l32.41"></a><span id="l32.41">     // move toolbox into place then load state</span>
<a href="#l32.42"></a><span id="l32.42" class="difflineminus">-    moveEventToolbox(aTab.panel.firstChild);</span>
<a href="#l32.43"></a><span id="l32.43" class="difflineplus">+    moveEventToolbox(aTab.panel.firstElementChild);</span>
<a href="#l32.44"></a><span id="l32.44">     Object.assign(gConfig, aTab.itemTabConfig);</span>
<a href="#l32.45"></a><span id="l32.45">     updateItemTabState(gConfig);</span>
<a href="#l32.46"></a><span id="l32.46"> </span>
<a href="#l32.47"></a><span id="l32.47">     // activate or de-activate 'Events and Tasks' menu items</span>
<a href="#l32.48"></a><span id="l32.48">     document.commandDispatcher.updateCommands(&quot;calendar_commands&quot;);</span>
<a href="#l32.49"></a><span id="l32.49">   },</span>
<a href="#l32.50"></a><span id="l32.50">   /**</span>
<a href="#l32.51"></a><span id="l32.51">    * Called when there is a request to close a tab.  Using aTab.allowTabClose</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -297,19 +297,22 @@ ltn.invitation = {</span>
<a href="#l33.4"></a><span id="l33.4">      * Transforms text node content to formatted child nodes. Decorations are defined in imip.css</span>
<a href="#l33.5"></a><span id="l33.5">      * @param {Node}    aToNode text node to change</span>
<a href="#l33.6"></a><span id="l33.6">      * @param {String}  aType   use 'newline' for the same, 'added' or 'removed' for decoration</span>
<a href="#l33.7"></a><span id="l33.7">      * @param {String}  aText   [optional]</span>
<a href="#l33.8"></a><span id="l33.8">      * @param {Boolean} aClear  [optional] for consecutive changes on the same node, set to false</span>
<a href="#l33.9"></a><span id="l33.9">      */</span>
<a href="#l33.10"></a><span id="l33.10">     function _content2Child(aToNode, aType, aText = &quot;&quot;, aClear = true) {</span>
<a href="#l33.11"></a><span id="l33.11">       let nodeDoc = aToNode.ownerDocument;</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-      if (aClear &amp;&amp; aToNode.hasChildNodes()) {</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineminus">-        aToNode.firstChild.remove();</span>
<a href="#l33.14"></a><span id="l33.14" class="difflineplus">+      if (aClear) {</span>
<a href="#l33.15"></a><span id="l33.15" class="difflineplus">+        while (aToNode.lastChild) {</span>
<a href="#l33.16"></a><span id="l33.16" class="difflineplus">+          aToNode.lastChild.remove();</span>
<a href="#l33.17"></a><span id="l33.17" class="difflineplus">+        }</span>
<a href="#l33.18"></a><span id="l33.18">       }</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineplus">+</span>
<a href="#l33.20"></a><span id="l33.20">       let n = nodeDoc.createElement(aType.toLowerCase() == &quot;newline&quot; ? &quot;br&quot; : &quot;span&quot;);</span>
<a href="#l33.21"></a><span id="l33.21">       switch (aType) {</span>
<a href="#l33.22"></a><span id="l33.22">         case &quot;added&quot;:</span>
<a href="#l33.23"></a><span id="l33.23">         case &quot;modified&quot;:</span>
<a href="#l33.24"></a><span id="l33.24">         case &quot;removed&quot;:</span>
<a href="#l33.25"></a><span id="l33.25">           n.className = aType;</span>
<a href="#l33.26"></a><span id="l33.26">           if (Services.prefs.getBoolPref(&quot;calendar.view.useSystemColors&quot;, false)) {</span>
<a href="#l33.27"></a><span id="l33.27">             n.setAttribute(&quot;systemcolors&quot;, true);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/resources/content/datetimepickers/datetimepickers.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/resources/content/datetimepickers/datetimepickers.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -669,26 +669,26 @@</span>
<a href="#l34.4"></a><span id="l34.4"> </span>
<a href="#l34.5"></a><span id="l34.5">     /**</span>
<a href="#l34.6"></a><span id="l34.6">      * Changes to 12 hours format by showing am/pm label.</span>
<a href="#l34.7"></a><span id="l34.7">      *</span>
<a href="#l34.8"></a><span id="l34.8">      * @param {String} amLabel     amLabelBox value</span>
<a href="#l34.9"></a><span id="l34.9">      * @param {String} pmLabel     pmLabelBox value</span>
<a href="#l34.10"></a><span id="l34.10">      */</span>
<a href="#l34.11"></a><span id="l34.11">     changeTo12HoursFormat(amLabel, pmLabel) {</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-      if (!this.firstChild) {</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+      if (!this.firstElementChild) {</span>
<a href="#l34.14"></a><span id="l34.14">         this.appendChild(document.importNode(this.content, true));</span>
<a href="#l34.15"></a><span id="l34.15">       }</span>
<a href="#l34.16"></a><span id="l34.16"> </span>
<a href="#l34.17"></a><span id="l34.17">       let amLabelBox = this.querySelector(&quot;.amLabelBox&quot;);</span>
<a href="#l34.18"></a><span id="l34.18">       amLabelBox.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l34.19"></a><span id="l34.19" class="difflineminus">-      amLabelBox.firstChild.setAttribute(&quot;value&quot;, amLabel);</span>
<a href="#l34.20"></a><span id="l34.20" class="difflineplus">+      amLabelBox.firstElementChild.setAttribute(&quot;value&quot;, amLabel);</span>
<a href="#l34.21"></a><span id="l34.21">       let pmLabelBox = this.querySelector(&quot;.pmLabelBox&quot;);</span>
<a href="#l34.22"></a><span id="l34.22">       pmLabelBox.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l34.23"></a><span id="l34.23" class="difflineminus">-      pmLabelBox.firstChild.setAttribute(&quot;value&quot;, pmLabel);</span>
<a href="#l34.24"></a><span id="l34.24" class="difflineplus">+      pmLabelBox.firstElementChild.setAttribute(&quot;value&quot;, pmLabel);</span>
<a href="#l34.25"></a><span id="l34.25">       this.querySelector(&quot;.time-picker-hour-box-class[value='0']&quot;).setAttribute(&quot;label&quot;, &quot;12&quot;);</span>
<a href="#l34.26"></a><span id="l34.26">       for (let i = 13; i &lt; 24; i++) {</span>
<a href="#l34.27"></a><span id="l34.27">         this.querySelector(`.time-picker-hour-box-class[value=&quot;${i}&quot;]`).setAttribute(</span>
<a href="#l34.28"></a><span id="l34.28">           &quot;label&quot;,</span>
<a href="#l34.29"></a><span id="l34.29">           i - 12</span>
<a href="#l34.30"></a><span id="l34.30">         );</span>
<a href="#l34.31"></a><span id="l34.31">       }</span>
<a href="#l34.32"></a><span id="l34.32">       this.querySelector(&quot;.time-picker-hour-grid&quot;).setAttribute(&quot;format12hours&quot;, &quot;true&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/calendar/test/modules/ItemEditingHelpers.jsm</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/calendar/test/modules/ItemEditingHelpers.jsm</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -378,29 +378,22 @@ function setData(dialog, iframe, data) {</span>
<a href="#l35.4"></a><span id="l35.4">   // attachment</span>
<a href="#l35.5"></a><span id="l35.5">   if (data.attachment != undefined) {</span>
<a href="#l35.6"></a><span id="l35.6">     if (data.attachment.add != undefined) {</span>
<a href="#l35.7"></a><span id="l35.7">       handleAddingAttachment(dialog, data.attachment.add);</span>
<a href="#l35.8"></a><span id="l35.8">     }</span>
<a href="#l35.9"></a><span id="l35.9">     if (data.attachment.remove != undefined) {</span>
<a href="#l35.10"></a><span id="l35.10">       dialog.click(iframeid(&quot;event-grid-tab-attachments&quot;));</span>
<a href="#l35.11"></a><span id="l35.11">       let attachmentBox = iframeid(&quot;attachment-link&quot;);</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-      let attachments = attachmentBox.getNode().childNodes;</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineminus">-      if (attachments) {</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineminus">-        let attToDelete;</span>
<a href="#l35.15"></a><span id="l35.15" class="difflineminus">-        attachments.forEach(currentValue =&gt; {</span>
<a href="#l35.16"></a><span id="l35.16" class="difflineminus">-          if (currentValue.tooltipText.includes(data.attachment.remove)) {</span>
<a href="#l35.17"></a><span id="l35.17" class="difflineminus">-            attToDelete = currentValue;</span>
<a href="#l35.18"></a><span id="l35.18" class="difflineminus">-          }</span>
<a href="#l35.19"></a><span id="l35.19" class="difflineminus">-          if (attToDelete) {</span>
<a href="#l35.20"></a><span id="l35.20" class="difflineminus">-            dialog.click(new elementslib.Elem(attToDelete));</span>
<a href="#l35.21"></a><span id="l35.21" class="difflineminus">-            dialog.keypress(attachmentBox, &quot;VK_DELETE&quot;, {});</span>
<a href="#l35.22"></a><span id="l35.22" class="difflineminus">-            attToDelete = undefined;</span>
<a href="#l35.23"></a><span id="l35.23" class="difflineminus">-          }</span>
<a href="#l35.24"></a><span id="l35.24" class="difflineminus">-        });</span>
<a href="#l35.25"></a><span id="l35.25" class="difflineplus">+      let attachments = attachmentBox.getNode().children;</span>
<a href="#l35.26"></a><span id="l35.26" class="difflineplus">+      for (let attachment of attachments) {</span>
<a href="#l35.27"></a><span id="l35.27" class="difflineplus">+        if (attachment.tooltipText.includes(data.attachment.remove)) {</span>
<a href="#l35.28"></a><span id="l35.28" class="difflineplus">+          dialog.click(new elementslib.Elem(attachment));</span>
<a href="#l35.29"></a><span id="l35.29" class="difflineplus">+          dialog.keypress(attachmentBox, &quot;VK_DELETE&quot;, {});</span>
<a href="#l35.30"></a><span id="l35.30" class="difflineplus">+        }</span>
<a href="#l35.31"></a><span id="l35.31">       }</span>
<a href="#l35.32"></a><span id="l35.32">     }</span>
<a href="#l35.33"></a><span id="l35.33">   }</span>
<a href="#l35.34"></a><span id="l35.34"> </span>
<a href="#l35.35"></a><span id="l35.35">   // attendees</span>
<a href="#l35.36"></a><span id="l35.36">   if (data.attendees != undefined) {</span>
<a href="#l35.37"></a><span id="l35.37">     // Display attendees Tab.</span>
<a href="#l35.38"></a><span id="l35.38">     dialog.click(iframeid(&quot;event-grid-tab-attendees&quot;));</span>
<a href="#l35.39"></a><span id="l35.39" class="difflineat">@@ -456,17 +449,17 @@ function setCategories(dialog, iframe, c</span>
<a href="#l35.40"></a><span id="l35.40">   let categoryMenulist = iframeid(&quot;item-categories&quot;);</span>
<a href="#l35.41"></a><span id="l35.41">   let categoryList = iframeLookup(CATEGORY_LIST);</span>
<a href="#l35.42"></a><span id="l35.42">   dialog.click(categoryMenulist);</span>
<a href="#l35.43"></a><span id="l35.43">   dialog.waitFor(() =&gt; categoryMenulist.getNode().open);</span>
<a href="#l35.44"></a><span id="l35.44">   if (categoryMenulist.itemCount &gt; -1 &amp;&amp; categoryMenulist.itemCount &lt; categories.length) {</span>
<a href="#l35.45"></a><span id="l35.45">     mark_failure([&quot;more categories than supported by current calendar&quot;]);</span>
<a href="#l35.46"></a><span id="l35.46">   } else {</span>
<a href="#l35.47"></a><span id="l35.47">     // Iterate over categories and check if needed.</span>
<a href="#l35.48"></a><span id="l35.48" class="difflineminus">-    let listItems = categoryList.getNode().childNodes;</span>
<a href="#l35.49"></a><span id="l35.49" class="difflineplus">+    let listItems = categoryList.getNode().children;</span>
<a href="#l35.50"></a><span id="l35.50">     for (let item of listItems) {</span>
<a href="#l35.51"></a><span id="l35.51">       let set = false;</span>
<a href="#l35.52"></a><span id="l35.52">       if (categories.includes(item.label)) {</span>
<a href="#l35.53"></a><span id="l35.53">         set = true;</span>
<a href="#l35.54"></a><span id="l35.54">       }</span>
<a href="#l35.55"></a><span id="l35.55">       if (set &amp;&amp; !item.getAttribute(&quot;checked&quot;)) {</span>
<a href="#l35.56"></a><span id="l35.56">         item.setAttribute(&quot;checked&quot;, true);</span>
<a href="#l35.57"></a><span id="l35.57">       } else if (!set &amp;&amp; item.getAttribute(&quot;checked&quot;)) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/calendar/test/unit/test_alarmutils.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/calendar/test/unit/test_alarmutils.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -197,29 +197,29 @@ add_task(async function test_addReminder</span>
<a href="#l36.4"></a><span id="l36.4">       reminder.action = action;</span>
<a href="#l36.5"></a><span id="l36.5">       reminders.push(reminder);</span>
<a href="#l36.6"></a><span id="l36.6">     }</span>
<a href="#l36.7"></a><span id="l36.7">     return reminders;</span>
<a href="#l36.8"></a><span id="l36.8">   }</span>
<a href="#l36.9"></a><span id="l36.9"> </span>
<a href="#l36.10"></a><span id="l36.10">   function checkReminder(node, actions, msg) {</span>
<a href="#l36.11"></a><span id="l36.11">     let actionset = new Set(actions);</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-    equal(box.childNodes.length, actions.length);</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineminus">-    for (let i = 0, len = box.childNodes.length; i &lt; len; i++) {</span>
<a href="#l36.14"></a><span id="l36.14" class="difflineminus">-      let actionvalue = box.childNodes[i].getAttribute(&quot;value&quot;);</span>
<a href="#l36.15"></a><span id="l36.15" class="difflineminus">-      equal(box.childNodes[i].localName, &quot;image&quot;, msg + &quot; (is image)&quot;);</span>
<a href="#l36.16"></a><span id="l36.16" class="difflineplus">+    equal(box.children.length, actions.length);</span>
<a href="#l36.17"></a><span id="l36.17" class="difflineplus">+    for (let i = 0, len = box.children.length; i &lt; len; i++) {</span>
<a href="#l36.18"></a><span id="l36.18" class="difflineplus">+      let actionvalue = box.children[i].getAttribute(&quot;value&quot;);</span>
<a href="#l36.19"></a><span id="l36.19" class="difflineplus">+      equal(box.children[i].localName, &quot;image&quot;, msg + &quot; (is image)&quot;);</span>
<a href="#l36.20"></a><span id="l36.20">       ok(actionset.has(actionvalue), msg + &quot; (has action)&quot;);</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineminus">-      equal(box.childNodes[i].getAttribute(&quot;class&quot;), &quot;reminder-icon&quot;, msg + &quot; (has class)&quot;);</span>
<a href="#l36.22"></a><span id="l36.22" class="difflineplus">+      equal(box.children[i].getAttribute(&quot;class&quot;), &quot;reminder-icon&quot;, msg + &quot; (has class)&quot;);</span>
<a href="#l36.23"></a><span id="l36.23">       actionset.delete(actionvalue);</span>
<a href="#l36.24"></a><span id="l36.24">     }</span>
<a href="#l36.25"></a><span id="l36.25">   }</span>
<a href="#l36.26"></a><span id="l36.26"> </span>
<a href="#l36.27"></a><span id="l36.27">   let xul_ns = &quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;;</span>
<a href="#l36.28"></a><span id="l36.28">   let doc = cal.xml.parseString(&quot;&lt;window xmlns='&quot; + xul_ns + &quot;'&gt;&lt;box/&gt;&lt;/window&gt;&quot;);</span>
<a href="#l36.29"></a><span id="l36.29" class="difflineminus">-  let box = doc.documentElement.firstChild;</span>
<a href="#l36.30"></a><span id="l36.30" class="difflineplus">+  let box = doc.documentElement.firstElementChild;</span>
<a href="#l36.31"></a><span id="l36.31"> </span>
<a href="#l36.32"></a><span id="l36.32">   let actions = [&quot;DISPLAY&quot;];</span>
<a href="#l36.33"></a><span id="l36.33">   let reminders = createReminders(actions);</span>
<a href="#l36.34"></a><span id="l36.34">   cal.alarms.addReminderImages(box, reminders);</span>
<a href="#l36.35"></a><span id="l36.35">   checkReminder(box, actions, &quot;first addition&quot;);</span>
<a href="#l36.36"></a><span id="l36.36"> </span>
<a href="#l36.37"></a><span id="l36.37">   actions = [&quot;DISPLAY&quot;];</span>
<a href="#l36.38"></a><span id="l36.38">   reminders = createReminders(actions);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/chat/content/chat-tooltip.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/chat/content/chat-tooltip.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -298,17 +298,17 @@</span>
<a href="#l37.4"></a><span id="l37.4">         // Row with this label already exists - just update.</span>
<a href="#l37.5"></a><span id="l37.5">         description = row.querySelector(&quot;td&quot;);</span>
<a href="#l37.6"></a><span id="l37.6">       }</span>
<a href="#l37.7"></a><span id="l37.7">       description.textContent = aValue;</span>
<a href="#l37.8"></a><span id="l37.8">     }</span>
<a href="#l37.9"></a><span id="l37.9"> </span>
<a href="#l37.10"></a><span id="l37.10">     addSeparator() {</span>
<a href="#l37.11"></a><span id="l37.11">       if (this.table.hasChildNodes()) {</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-        let lastElement = this.table.lastChild;</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+        let lastElement = this.table.lastElementChild;</span>
<a href="#l37.14"></a><span id="l37.14">         lastElement.querySelector(&quot;th&quot;).classList.add(&quot;chatTooltipSeparator&quot;);</span>
<a href="#l37.15"></a><span id="l37.15">         lastElement.querySelector(&quot;td&quot;).classList.add(&quot;chatTooltipSeparator&quot;);</span>
<a href="#l37.16"></a><span id="l37.16">       }</span>
<a href="#l37.17"></a><span id="l37.17">     }</span>
<a href="#l37.18"></a><span id="l37.18"> </span>
<a href="#l37.19"></a><span id="l37.19">     requestBuddyInfo(aAccount, aObservedName) {</span>
<a href="#l37.20"></a><span id="l37.20">       // Libpurple prpls don't necessarily return data in response to</span>
<a href="#l37.21"></a><span id="l37.21">       // requestBuddyInfo that is suitable for displaying inside a</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/chat/content/conversation-browser.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/chat/content/conversation-browser.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -632,17 +632,17 @@</span>
<a href="#l38.4"></a><span id="l38.4">         // if that's not after the end-of-split-block element.</span>
<a href="#l38.5"></a><span id="l38.5">         insert = doc.getElementById(&quot;insert&quot;);</span>
<a href="#l38.6"></a><span id="l38.6">         if (insert) {</span>
<a href="#l38.7"></a><span id="l38.7">           marker = doc.createElement(&quot;div&quot;);</span>
<a href="#l38.8"></a><span id="l38.8">           marker.id = &quot;next-messages-start&quot;;</span>
<a href="#l38.9"></a><span id="l38.9">           insert.parentNode.insertBefore(marker, insert);</span>
<a href="#l38.10"></a><span id="l38.10">           marker = doc.createElement(&quot;div&quot;);</span>
<a href="#l38.11"></a><span id="l38.11">           marker.id = &quot;next-messages-end&quot;;</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-          insert.parentNode.insertBefore(marker, insert.nextSibling);</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+          insert.parentNode.insertBefore(marker, insert.nextElementSibling);</span>
<a href="#l38.14"></a><span id="l38.14">         }</span>
<a href="#l38.15"></a><span id="l38.15">       } else {</span>
<a href="#l38.16"></a><span id="l38.16">         let html = getHTMLForMessage(aMsg, this.theme, next, aContext);</span>
<a href="#l38.17"></a><span id="l38.17">         newElt = insertHTMLForMessage(aMsg, html, doc, next);</span>
<a href="#l38.18"></a><span id="l38.18">       }</span>
<a href="#l38.19"></a><span id="l38.19"> </span>
<a href="#l38.20"></a><span id="l38.20">       if (!aNoAutoScroll) {</span>
<a href="#l38.21"></a><span id="l38.21">         newElt.getBoundingClientRect(); // avoid ireflow bugs</span>
<a href="#l38.22"></a><span id="l38.22" class="difflineat">@@ -688,19 +688,19 @@</span>
<a href="#l38.23"></a><span id="l38.23">         let range = doc.createRange();</span>
<a href="#l38.24"></a><span id="l38.24">         let moveToParent = moveTo.parentNode;</span>
<a href="#l38.25"></a><span id="l38.25">         range.selectNode(moveToParent);</span>
<a href="#l38.26"></a><span id="l38.26">         // eslint-disable-next-line no-unsanitized/method</span>
<a href="#l38.27"></a><span id="l38.27">         let documentFragment = range.createContextualFragment(</span>
<a href="#l38.28"></a><span id="l38.28">           ruler.nextMsgHtml</span>
<a href="#l38.29"></a><span id="l38.29">         );</span>
<a href="#l38.30"></a><span id="l38.30">         for (</span>
<a href="#l38.31"></a><span id="l38.31" class="difflineminus">-          let root = documentFragment.firstChild;</span>
<a href="#l38.32"></a><span id="l38.32" class="difflineplus">+          let root = documentFragment.firstElementChild;</span>
<a href="#l38.33"></a><span id="l38.33">           root;</span>
<a href="#l38.34"></a><span id="l38.34" class="difflineminus">-          root = root.nextSibling</span>
<a href="#l38.35"></a><span id="l38.35" class="difflineplus">+          root = root.nextElementSibling</span>
<a href="#l38.36"></a><span id="l38.36">         ) {</span>
<a href="#l38.37"></a><span id="l38.37">           root._originalMsg = ruler._originalMsg;</span>
<a href="#l38.38"></a><span id="l38.38">         }</span>
<a href="#l38.39"></a><span id="l38.39">         moveToParent.insertBefore(documentFragment, moveTo);</span>
<a href="#l38.40"></a><span id="l38.40"> </span>
<a href="#l38.41"></a><span id="l38.41">         // If this added an insert node, insert the next messages there.</span>
<a href="#l38.42"></a><span id="l38.42">         let insert = doc.getElementById(&quot;insert&quot;);</span>
<a href="#l38.43"></a><span id="l38.43">         if (insert) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/chat/content/otr-auth.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/chat/content/otr-auth.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -49,17 +49,17 @@ async function populateFingers(context, </span>
<a href="#l39.4"></a><span id="l39.4">     their_name: context.username,</span>
<a href="#l39.5"></a><span id="l39.5">   });</span>
<a href="#l39.6"></a><span id="l39.6"> </span>
<a href="#l39.7"></a><span id="l39.7">   document.getElementById(&quot;yourFPValue&quot;).value = yours;</span>
<a href="#l39.8"></a><span id="l39.8">   document.getElementById(&quot;theirFPValue&quot;).value = theirs;</span>
<a href="#l39.9"></a><span id="l39.9"> </span>
<a href="#l39.10"></a><span id="l39.10">   let opts = document.getElementById(&quot;verifiedOption&quot;);</span>
<a href="#l39.11"></a><span id="l39.11">   let verified = trust ? &quot;yes&quot; : &quot;no&quot;;</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-  for (let item of opts.menupopup.childNodes) {</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+  for (let item of opts.menupopup.children) {</span>
<a href="#l39.14"></a><span id="l39.14">     if (verified === item.value) {</span>
<a href="#l39.15"></a><span id="l39.15">       opts.selectedItem = item;</span>
<a href="#l39.16"></a><span id="l39.16">       break;</span>
<a href="#l39.17"></a><span id="l39.17">     }</span>
<a href="#l39.18"></a><span id="l39.18">   }</span>
<a href="#l39.19"></a><span id="l39.19"> }</span>
<a href="#l39.20"></a><span id="l39.20"> </span>
<a href="#l39.21"></a><span id="l39.21"> var otrAuth = {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/chat/modules/imContentSink.jsm</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/chat/modules/imContentSink.jsm</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -234,33 +234,33 @@ function removeGlobalAllowedAttribute(aA</span>
<a href="#l40.4"></a><span id="l40.4"> function addGlobalAllowedStyleRule(aStyle, aRule = true) {</span>
<a href="#l40.5"></a><span id="l40.5">   gGlobalRuleset.styles[aStyle] = aRule;</span>
<a href="#l40.6"></a><span id="l40.6"> }</span>
<a href="#l40.7"></a><span id="l40.7"> function removeGlobalAllowedStyleRule(aStyle) {</span>
<a href="#l40.8"></a><span id="l40.8">   delete gGlobalRuleset.styles[aStyle];</span>
<a href="#l40.9"></a><span id="l40.9"> }</span>
<a href="#l40.10"></a><span id="l40.10"> </span>
<a href="#l40.11"></a><span id="l40.11"> function cleanupNode(aNode, aRules, aTextModifiers) {</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-  for (let i = 0; i &lt; aNode.childNodes.length; ++i) {</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineminus">-    let node = aNode.childNodes[i];</span>
<a href="#l40.14"></a><span id="l40.14" class="difflineplus">+  for (let i = 0; i &lt; aNode.children.length; ++i) {</span>
<a href="#l40.15"></a><span id="l40.15" class="difflineplus">+    let node = aNode.children[i];</span>
<a href="#l40.16"></a><span id="l40.16">     if (</span>
<a href="#l40.17"></a><span id="l40.17">       node.nodeType == node.ELEMENT_NODE &amp;&amp;</span>
<a href="#l40.18"></a><span id="l40.18">       node.namespaceURI == &quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l40.19"></a><span id="l40.19">     ) {</span>
<a href="#l40.20"></a><span id="l40.20">       // check if node allowed</span>
<a href="#l40.21"></a><span id="l40.21">       let nodeName = node.localName;</span>
<a href="#l40.22"></a><span id="l40.22">       if (!(nodeName in aRules.tags)) {</span>
<a href="#l40.23"></a><span id="l40.23">         if (nodeName in kForbiddenTags) {</span>
<a href="#l40.24"></a><span id="l40.24">           Cu.reportError(</span>
<a href="#l40.25"></a><span id="l40.25">             &quot;removing a &quot; + nodeName + &quot; tag from a message before display&quot;</span>
<a href="#l40.26"></a><span id="l40.26">           );</span>
<a href="#l40.27"></a><span id="l40.27">         } else {</span>
<a href="#l40.28"></a><span id="l40.28">           // this node is not allowed, replace it with its children</span>
<a href="#l40.29"></a><span id="l40.29">           while (node.hasChildNodes()) {</span>
<a href="#l40.30"></a><span id="l40.30" class="difflineminus">-            aNode.insertBefore(node.firstChild, node);</span>
<a href="#l40.31"></a><span id="l40.31" class="difflineplus">+            aNode.insertBefore(node.firstElementChild, node);</span>
<a href="#l40.32"></a><span id="l40.32">           }</span>
<a href="#l40.33"></a><span id="l40.33">         }</span>
<a href="#l40.34"></a><span id="l40.34">         aNode.removeChild(node);</span>
<a href="#l40.35"></a><span id="l40.35">         // We want to process again the node at the index i which is</span>
<a href="#l40.36"></a><span id="l40.36">         // now the first child of the node we removed</span>
<a href="#l40.37"></a><span id="l40.37">         --i;</span>
<a href="#l40.38"></a><span id="l40.38">         continue;</span>
<a href="#l40.39"></a><span id="l40.39">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/chat/modules/imThemes.jsm</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/chat/modules/imThemes.jsm</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -169,32 +169,32 @@ function plistToJSON(aElt) {</span>
<a href="#l41.4"></a><span id="l41.4">       return aElt.textContent;</span>
<a href="#l41.5"></a><span id="l41.5">     case &quot;real&quot;:</span>
<a href="#l41.6"></a><span id="l41.6">       return parseFloat(aElt.textContent);</span>
<a href="#l41.7"></a><span id="l41.7">     case &quot;integer&quot;:</span>
<a href="#l41.8"></a><span id="l41.8">       return parseInt(aElt.textContent, 10);</span>
<a href="#l41.9"></a><span id="l41.9"> </span>
<a href="#l41.10"></a><span id="l41.10">     case &quot;dict&quot;:</span>
<a href="#l41.11"></a><span id="l41.11">       let res = {};</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-      let nodes = aElt.childNodes;</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+      let nodes = aElt.children;</span>
<a href="#l41.14"></a><span id="l41.14">       for (let i = 0; i &lt; nodes.length; ++i) {</span>
<a href="#l41.15"></a><span id="l41.15">         if (nodes[i].nodeName == &quot;key&quot;) {</span>
<a href="#l41.16"></a><span id="l41.16">           let key = nodes[i].textContent;</span>
<a href="#l41.17"></a><span id="l41.17">           ++i;</span>
<a href="#l41.18"></a><span id="l41.18">           while (!Element.isInstance(nodes[i])) {</span>
<a href="#l41.19"></a><span id="l41.19">             ++i;</span>
<a href="#l41.20"></a><span id="l41.20">           }</span>
<a href="#l41.21"></a><span id="l41.21">           res[key] = plistToJSON(nodes[i]);</span>
<a href="#l41.22"></a><span id="l41.22">         }</span>
<a href="#l41.23"></a><span id="l41.23">       }</span>
<a href="#l41.24"></a><span id="l41.24">       return res;</span>
<a href="#l41.25"></a><span id="l41.25"> </span>
<a href="#l41.26"></a><span id="l41.26">     case &quot;array&quot;:</span>
<a href="#l41.27"></a><span id="l41.27">       let array = [];</span>
<a href="#l41.28"></a><span id="l41.28" class="difflineminus">-      nodes = aElt.childNodes;</span>
<a href="#l41.29"></a><span id="l41.29" class="difflineplus">+      nodes = aElt.children;</span>
<a href="#l41.30"></a><span id="l41.30">       for (let i = 0; i &lt; nodes.length; ++i) {</span>
<a href="#l41.31"></a><span id="l41.31">         if (Element.isInstance(nodes[i])) {</span>
<a href="#l41.32"></a><span id="l41.32">           array.push(plistToJSON(nodes[i]));</span>
<a href="#l41.33"></a><span id="l41.33">         }</span>
<a href="#l41.34"></a><span id="l41.34">       }</span>
<a href="#l41.35"></a><span id="l41.35">       return array;</span>
<a href="#l41.36"></a><span id="l41.36"> </span>
<a href="#l41.37"></a><span id="l41.37">     default:</span>
<a href="#l41.38"></a><span id="l41.38" class="difflineat">@@ -220,19 +220,19 @@ function getInfoPlistContent(aBaseURI) {</span>
<a href="#l41.39"></a><span id="l41.39">       stream,</span>
<a href="#l41.40"></a><span id="l41.40">       null,</span>
<a href="#l41.41"></a><span id="l41.41">       stream.available(),</span>
<a href="#l41.42"></a><span id="l41.42">       &quot;text/xml&quot;</span>
<a href="#l41.43"></a><span id="l41.43">     );</span>
<a href="#l41.44"></a><span id="l41.44">     if (doc.documentElement.localName != &quot;plist&quot;) {</span>
<a href="#l41.45"></a><span id="l41.45">       throw new Error(&quot;Invalid Info.plist file&quot;);</span>
<a href="#l41.46"></a><span id="l41.46">     }</span>
<a href="#l41.47"></a><span id="l41.47" class="difflineminus">-    let node = doc.documentElement.firstChild;</span>
<a href="#l41.48"></a><span id="l41.48" class="difflineplus">+    let node = doc.documentElement.firstElementChild;</span>
<a href="#l41.49"></a><span id="l41.49">     while (node &amp;&amp; !Element.isInstance(node)) {</span>
<a href="#l41.50"></a><span id="l41.50" class="difflineminus">-      node = node.nextSibling;</span>
<a href="#l41.51"></a><span id="l41.51" class="difflineplus">+      node = node.nextElementSibling;</span>
<a href="#l41.52"></a><span id="l41.52">     }</span>
<a href="#l41.53"></a><span id="l41.53">     if (!node || node.localName != &quot;dict&quot;) {</span>
<a href="#l41.54"></a><span id="l41.54">       throw new Error(&quot;Empty or invalid Info.plist file&quot;);</span>
<a href="#l41.55"></a><span id="l41.55">     }</span>
<a href="#l41.56"></a><span id="l41.56">     return plistToJSON(node);</span>
<a href="#l41.57"></a><span id="l41.57">   } catch (e) {</span>
<a href="#l41.58"></a><span id="l41.58">     Cu.reportError(e);</span>
<a href="#l41.59"></a><span id="l41.59">     return null;</span>
<a href="#l41.60"></a><span id="l41.60" class="difflineat">@@ -621,35 +621,35 @@ function insertHTMLForMessage(aMsg, aHTM</span>
<a href="#l41.61"></a><span id="l41.61">     insert = null;</span>
<a href="#l41.62"></a><span id="l41.62">   }</span>
<a href="#l41.63"></a><span id="l41.63"> </span>
<a href="#l41.64"></a><span id="l41.64">   let range = aDoc.createRange();</span>
<a href="#l41.65"></a><span id="l41.65">   let parent = insert ? insert.parentNode : aDoc.getElementById(&quot;Chat&quot;);</span>
<a href="#l41.66"></a><span id="l41.66">   range.selectNode(parent);</span>
<a href="#l41.67"></a><span id="l41.67">   // eslint-disable-next-line no-unsanitized/method</span>
<a href="#l41.68"></a><span id="l41.68">   let documentFragment = range.createContextualFragment(aHTML);</span>
<a href="#l41.69"></a><span id="l41.69" class="difflineminus">-  let result = documentFragment.firstChild;</span>
<a href="#l41.70"></a><span id="l41.70" class="difflineplus">+  let result = documentFragment.firstElementChild;</span>
<a href="#l41.71"></a><span id="l41.71"> </span>
<a href="#l41.72"></a><span id="l41.72">   // store the prplIMessage object in each of the &quot;root&quot; node that</span>
<a href="#l41.73"></a><span id="l41.73">   // will be inserted into the document, so that selection code can</span>
<a href="#l41.74"></a><span id="l41.74">   // retrieve the message by just looking at the parent node until it</span>
<a href="#l41.75"></a><span id="l41.75">   // finds something.</span>
<a href="#l41.76"></a><span id="l41.76" class="difflineminus">-  for (let root = result; root; root = root.nextSibling) {</span>
<a href="#l41.77"></a><span id="l41.77" class="difflineplus">+  for (let root = result; root; root = root.nextElementSibling) {</span>
<a href="#l41.78"></a><span id="l41.78">     root._originalMsg = aMsg;</span>
<a href="#l41.79"></a><span id="l41.79">   }</span>
<a href="#l41.80"></a><span id="l41.80"> </span>
<a href="#l41.81"></a><span id="l41.81">   // make sure the result is an HTMLElement and not some text (whitespace)...</span>
<a href="#l41.82"></a><span id="l41.82">   while (</span>
<a href="#l41.83"></a><span id="l41.83">     result &amp;&amp;</span>
<a href="#l41.84"></a><span id="l41.84">     !(</span>
<a href="#l41.85"></a><span id="l41.85">       result.nodeType == result.ELEMENT_NODE &amp;&amp;</span>
<a href="#l41.86"></a><span id="l41.86">       result.namespaceURI == &quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l41.87"></a><span id="l41.87">     )</span>
<a href="#l41.88"></a><span id="l41.88">   ) {</span>
<a href="#l41.89"></a><span id="l41.89" class="difflineminus">-    result = result.nextSibling;</span>
<a href="#l41.90"></a><span id="l41.90" class="difflineplus">+    result = result.nextElementSibling;</span>
<a href="#l41.91"></a><span id="l41.91">   }</span>
<a href="#l41.92"></a><span id="l41.92">   if (insert) {</span>
<a href="#l41.93"></a><span id="l41.93">     parent.replaceChild(documentFragment, insert);</span>
<a href="#l41.94"></a><span id="l41.94">   } else {</span>
<a href="#l41.95"></a><span id="l41.95">     parent.appendChild(documentFragment);</span>
<a href="#l41.96"></a><span id="l41.96">   }</span>
<a href="#l41.97"></a><span id="l41.97">   return result;</span>
<a href="#l41.98"></a><span id="l41.98"> }</span>
<a href="#l41.99"></a><span id="l41.99" class="difflineat">@@ -938,27 +938,24 @@ SelectedMessage.prototype = {</span>
<a href="#l41.100"></a><span id="l41.100">     if (!spanNode) {</span>
<a href="#l41.101"></a><span id="l41.101">       // can happen if the message text is under a separate root node</span>
<a href="#l41.102"></a><span id="l41.102">       // that isn't selected at all</span>
<a href="#l41.103"></a><span id="l41.103">       this._textSelected = false;</span>
<a href="#l41.104"></a><span id="l41.104">       this._otherSelected = true;</span>
<a href="#l41.105"></a><span id="l41.105">       return;</span>
<a href="#l41.106"></a><span id="l41.106">     }</span>
<a href="#l41.107"></a><span id="l41.107">     let startPoint = this._range.comparePoint(spanNode, 0);</span>
<a href="#l41.108"></a><span id="l41.108" class="difflineminus">-    let endPoint = this._range.comparePoint(</span>
<a href="#l41.109"></a><span id="l41.109" class="difflineminus">-      spanNode,</span>
<a href="#l41.110"></a><span id="l41.110" class="difflineminus">-      spanNode.childNodes.length</span>
<a href="#l41.111"></a><span id="l41.111" class="difflineminus">-    );</span>
<a href="#l41.112"></a><span id="l41.112" class="difflineplus">+    let endPoint = this._range.comparePoint(spanNode, spanNode.children.length);</span>
<a href="#l41.113"></a><span id="l41.113">     if (startPoint &lt;= 0 &amp;&amp; endPoint &gt;= 0) {</span>
<a href="#l41.114"></a><span id="l41.114">       let range = this._range.cloneRange();</span>
<a href="#l41.115"></a><span id="l41.115">       if (startPoint &gt;= 0) {</span>
<a href="#l41.116"></a><span id="l41.116">         range.setStart(spanNode, 0);</span>
<a href="#l41.117"></a><span id="l41.117">       }</span>
<a href="#l41.118"></a><span id="l41.118">       if (endPoint &lt;= 0) {</span>
<a href="#l41.119"></a><span id="l41.119" class="difflineminus">-        range.setEnd(spanNode, spanNode.childNodes.length);</span>
<a href="#l41.120"></a><span id="l41.120" class="difflineplus">+        range.setEnd(spanNode, spanNode.children.length);</span>
<a href="#l41.121"></a><span id="l41.121">       }</span>
<a href="#l41.122"></a><span id="l41.122">       this._selectedText = serializeRange(range);</span>
<a href="#l41.123"></a><span id="l41.123"> </span>
<a href="#l41.124"></a><span id="l41.124">       // if the selected text is empty, set _selectedText to false</span>
<a href="#l41.125"></a><span id="l41.125">       // this happens if the carret is at the offset 0 in the span node</span>
<a href="#l41.126"></a><span id="l41.126">       this._textSelected = this._selectedText != &quot;&quot;;</span>
<a href="#l41.127"></a><span id="l41.127">     } else {</span>
<a href="#l41.128"></a><span id="l41.128">       this._textSelected = false;</span>
<a href="#l41.129"></a><span id="l41.129" class="difflineat">@@ -975,17 +972,17 @@ SelectedMessage.prototype = {</span>
<a href="#l41.130"></a><span id="l41.130">         this._cutBegin = serializeRange(range) != &quot;&quot;;</span>
<a href="#l41.131"></a><span id="l41.131">       } else {</span>
<a href="#l41.132"></a><span id="l41.132">         this._cutBegin = false;</span>
<a href="#l41.133"></a><span id="l41.133">       }</span>
<a href="#l41.134"></a><span id="l41.134"> </span>
<a href="#l41.135"></a><span id="l41.135">       if (endPoint == 1) {</span>
<a href="#l41.136"></a><span id="l41.136">         let range = spanNode.ownerDocument.createRange();</span>
<a href="#l41.137"></a><span id="l41.137">         range.setStart(this._range.endContainer, this._range.endOffset);</span>
<a href="#l41.138"></a><span id="l41.138" class="difflineminus">-        range.setEnd(spanNode, spanNode.childNodes.length);</span>
<a href="#l41.139"></a><span id="l41.139" class="difflineplus">+        range.setEnd(spanNode, spanNode.children.length);</span>
<a href="#l41.140"></a><span id="l41.140">         this._cutEnd = !/^(\r?\n)?$/.test(serializeRange(range));</span>
<a href="#l41.141"></a><span id="l41.141">       } else {</span>
<a href="#l41.142"></a><span id="l41.142">         this._cutEnd = false;</span>
<a href="#l41.143"></a><span id="l41.143">       }</span>
<a href="#l41.144"></a><span id="l41.144">     }</span>
<a href="#l41.145"></a><span id="l41.145">     this._otherSelected =</span>
<a href="#l41.146"></a><span id="l41.146">       (startPoint &gt;= 0 || endPoint &lt;= 0) &amp;&amp; // eliminate most negative cases</span>
<a href="#l41.147"></a><span id="l41.147">       (!this._textSelected ||</span>
<a href="#l41.148"></a><span id="l41.148" class="difflineat">@@ -1110,18 +1107,18 @@ function getMessagesForRange(aRange) {</span>
<a href="#l41.149"></a><span id="l41.149">       return true;</span>
<a href="#l41.150"></a><span id="l41.150">     }</span>
<a href="#l41.151"></a><span id="l41.151"> </span>
<a href="#l41.152"></a><span id="l41.152">     // recurse through children</span>
<a href="#l41.153"></a><span id="l41.153">     if (</span>
<a href="#l41.154"></a><span id="l41.154">       aNode.nodeType == aNode.ELEMENT_NODE &amp;&amp;</span>
<a href="#l41.155"></a><span id="l41.155">       aNode.namespaceURI == &quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l41.156"></a><span id="l41.156">     ) {</span>
<a href="#l41.157"></a><span id="l41.157" class="difflineminus">-      for (let i = 0; i &lt; aNode.childNodes.length; ++i) {</span>
<a href="#l41.158"></a><span id="l41.158" class="difflineminus">-        if (processSubtree(aNode.childNodes[i])) {</span>
<a href="#l41.159"></a><span id="l41.159" class="difflineplus">+      for (let i = 0; i &lt; aNode.children.length; ++i) {</span>
<a href="#l41.160"></a><span id="l41.160" class="difflineplus">+        if (processSubtree(aNode.children[i])) {</span>
<a href="#l41.161"></a><span id="l41.161">           return true;</span>
<a href="#l41.162"></a><span id="l41.162">         }</span>
<a href="#l41.163"></a><span id="l41.163">       }</span>
<a href="#l41.164"></a><span id="l41.164">     }</span>
<a href="#l41.165"></a><span id="l41.165"> </span>
<a href="#l41.166"></a><span id="l41.166">     return false;</span>
<a href="#l41.167"></a><span id="l41.167">   };</span>
<a href="#l41.168"></a><span id="l41.168"> </span>
<a href="#l41.169"></a><span id="l41.169" class="difflineat">@@ -1143,21 +1140,21 @@ function getMessagesForRange(aRange) {</span>
<a href="#l41.170"></a><span id="l41.170">       while (startNode.parentNode != currentNode) {</span>
<a href="#l41.171"></a><span id="l41.171">         startNode = startNode.parentNode;</span>
<a href="#l41.172"></a><span id="l41.172">       }</span>
<a href="#l41.173"></a><span id="l41.173">     }</span>
<a href="#l41.174"></a><span id="l41.174">     let end;</span>
<a href="#l41.175"></a><span id="l41.175">     if (currentNode == endNode) {</span>
<a href="#l41.176"></a><span id="l41.176">       end = aRange.endOffset;</span>
<a href="#l41.177"></a><span id="l41.177">     } else {</span>
<a href="#l41.178"></a><span id="l41.178" class="difflineminus">-      end = currentNode.childNodes.length;</span>
<a href="#l41.179"></a><span id="l41.179" class="difflineplus">+      end = currentNode.children.length;</span>
<a href="#l41.180"></a><span id="l41.180">     }</span>
<a href="#l41.181"></a><span id="l41.181"> </span>
<a href="#l41.182"></a><span id="l41.182">     for (let i = start; i &lt; end; ++i) {</span>
<a href="#l41.183"></a><span id="l41.183" class="difflineminus">-      let node = currentNode.childNodes[i];</span>
<a href="#l41.184"></a><span id="l41.184" class="difflineplus">+      let node = currentNode.children[i];</span>
<a href="#l41.185"></a><span id="l41.185"> </span>
<a href="#l41.186"></a><span id="l41.186">       // don't do anything until we find the startNode</span>
<a href="#l41.187"></a><span id="l41.187">       found = found || node == startNode;</span>
<a href="#l41.188"></a><span id="l41.188">       if (!found) {</span>
<a href="#l41.189"></a><span id="l41.189">         continue;</span>
<a href="#l41.190"></a><span id="l41.190">       }</span>
<a href="#l41.191"></a><span id="l41.191"> </span>
<a href="#l41.192"></a><span id="l41.192">       if (processSubtree(node)) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/common/bindings/customizable-toolbar.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/common/bindings/customizable-toolbar.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -27,22 +27,22 @@</span>
<a href="#l42.4"></a><span id="l42.4">       // toolbars are constructed first.</span>
<a href="#l42.5"></a><span id="l42.5">       let toolbox = this.toolbox;</span>
<a href="#l42.6"></a><span id="l42.6">       if (!toolbox) {</span>
<a href="#l42.7"></a><span id="l42.7">         return;</span>
<a href="#l42.8"></a><span id="l42.8">       }</span>
<a href="#l42.9"></a><span id="l42.9"> </span>
<a href="#l42.10"></a><span id="l42.10">       if (!toolbox.palette) {</span>
<a href="#l42.11"></a><span id="l42.11">         // Look to see if there is a toolbarpalette.</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-        let node = toolbox.firstChild;</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+        let node = toolbox.firstElementChild;</span>
<a href="#l42.14"></a><span id="l42.14">         while (node) {</span>
<a href="#l42.15"></a><span id="l42.15">           if (node.localName == &quot;toolbarpalette&quot;) {</span>
<a href="#l42.16"></a><span id="l42.16">             break;</span>
<a href="#l42.17"></a><span id="l42.17">           }</span>
<a href="#l42.18"></a><span id="l42.18" class="difflineminus">-          node = node.nextSibling;</span>
<a href="#l42.19"></a><span id="l42.19" class="difflineplus">+          node = node.nextElementSibling;</span>
<a href="#l42.20"></a><span id="l42.20">         }</span>
<a href="#l42.21"></a><span id="l42.21"> </span>
<a href="#l42.22"></a><span id="l42.22">         if (!node) {</span>
<a href="#l42.23"></a><span id="l42.23">           return;</span>
<a href="#l42.24"></a><span id="l42.24">         }</span>
<a href="#l42.25"></a><span id="l42.25"> </span>
<a href="#l42.26"></a><span id="l42.26">         // Hold on to the palette but remove it from the document.</span>
<a href="#l42.27"></a><span id="l42.27">         toolbox.palette = node;</span>
<a href="#l42.28"></a><span id="l42.28" class="difflineat">@@ -102,26 +102,26 @@</span>
<a href="#l42.29"></a><span id="l42.29">      */</span>
<a href="#l42.30"></a><span id="l42.30">     set currentSet(val) {</span>
<a href="#l42.31"></a><span id="l42.31">       if (val == this.currentSet) {</span>
<a href="#l42.32"></a><span id="l42.32">         return val;</span>
<a href="#l42.33"></a><span id="l42.33">       }</span>
<a href="#l42.34"></a><span id="l42.34"> </span>
<a href="#l42.35"></a><span id="l42.35">       // Build a cache of items in the toolbarpalette.</span>
<a href="#l42.36"></a><span id="l42.36">       let palette = this.toolbox ? this.toolbox.palette : null;</span>
<a href="#l42.37"></a><span id="l42.37" class="difflineminus">-      let paletteChildren = palette ? palette.childNodes : [];</span>
<a href="#l42.38"></a><span id="l42.38" class="difflineplus">+      let paletteChildren = palette ? palette.children : [];</span>
<a href="#l42.39"></a><span id="l42.39"> </span>
<a href="#l42.40"></a><span id="l42.40">       let paletteItems = {};</span>
<a href="#l42.41"></a><span id="l42.41"> </span>
<a href="#l42.42"></a><span id="l42.42">       for (let item of paletteChildren) {</span>
<a href="#l42.43"></a><span id="l42.43">         paletteItems[item.id] = item;</span>
<a href="#l42.44"></a><span id="l42.44">       }</span>
<a href="#l42.45"></a><span id="l42.45"> </span>
<a href="#l42.46"></a><span id="l42.46">       let ids = val == &quot;__empty&quot; ? [] : val.split(&quot;,&quot;);</span>
<a href="#l42.47"></a><span id="l42.47" class="difflineminus">-      let children = this.childNodes;</span>
<a href="#l42.48"></a><span id="l42.48" class="difflineplus">+      let children = this.children;</span>
<a href="#l42.49"></a><span id="l42.49">       let nodeidx = 0;</span>
<a href="#l42.50"></a><span id="l42.50">       let added = {};</span>
<a href="#l42.51"></a><span id="l42.51"> </span>
<a href="#l42.52"></a><span id="l42.52">       // Iterate over the ids to use on the toolbar.</span>
<a href="#l42.53"></a><span id="l42.53">       for (let id of ids) {</span>
<a href="#l42.54"></a><span id="l42.54">         // Iterate over the existing nodes on the toolbar. nodeidx is the</span>
<a href="#l42.55"></a><span id="l42.55">         // spot where we want to insert items.</span>
<a href="#l42.56"></a><span id="l42.56">         let found = false;</span>
<a href="#l42.57"></a><span id="l42.57" class="difflineat">@@ -175,24 +175,24 @@</span>
<a href="#l42.58"></a><span id="l42.58">     }</span>
<a href="#l42.59"></a><span id="l42.59"> </span>
<a href="#l42.60"></a><span id="l42.60">     /**</span>
<a href="#l42.61"></a><span id="l42.61">      * Gets the current set of items in the toolbar.</span>
<a href="#l42.62"></a><span id="l42.62">      *</span>
<a href="#l42.63"></a><span id="l42.63">      * @return {string}  Comma-separated list of IDs or &quot;__empty&quot;.</span>
<a href="#l42.64"></a><span id="l42.64">      */</span>
<a href="#l42.65"></a><span id="l42.65">     get currentSet() {</span>
<a href="#l42.66"></a><span id="l42.66" class="difflineminus">-      let node = this.firstChild;</span>
<a href="#l42.67"></a><span id="l42.67" class="difflineplus">+      let node = this.firstElementChild;</span>
<a href="#l42.68"></a><span id="l42.68">       let currentSet = [];</span>
<a href="#l42.69"></a><span id="l42.69">       while (node) {</span>
<a href="#l42.70"></a><span id="l42.70">         let id = this._idFromNode(node);</span>
<a href="#l42.71"></a><span id="l42.71">         if (id) {</span>
<a href="#l42.72"></a><span id="l42.72">           currentSet.push(id);</span>
<a href="#l42.73"></a><span id="l42.73">         }</span>
<a href="#l42.74"></a><span id="l42.74" class="difflineminus">-        node = node.nextSibling;</span>
<a href="#l42.75"></a><span id="l42.75" class="difflineplus">+        node = node.nextElementSibling;</span>
<a href="#l42.76"></a><span id="l42.76">       }</span>
<a href="#l42.77"></a><span id="l42.77"> </span>
<a href="#l42.78"></a><span id="l42.78">       return currentSet.join(&quot;,&quot;) || &quot;__empty&quot;;</span>
<a href="#l42.79"></a><span id="l42.79">     }</span>
<a href="#l42.80"></a><span id="l42.80"> </span>
<a href="#l42.81"></a><span id="l42.81">     /**</span>
<a href="#l42.82"></a><span id="l42.82">      * Return the ID for a given toolbar item node, with special handling for</span>
<a href="#l42.83"></a><span id="l42.83">      * some cases.</span>
<a href="#l42.84"></a><span id="l42.84" class="difflineat">@@ -246,22 +246,22 @@</span>
<a href="#l42.85"></a><span id="l42.85">         item.parentNode.localName == &quot;toolbar&quot; &amp;&amp;</span>
<a href="#l42.86"></a><span id="l42.86">         item.parentNode.toolbox == toolbox</span>
<a href="#l42.87"></a><span id="l42.87">       ) {</span>
<a href="#l42.88"></a><span id="l42.88">         return item;</span>
<a href="#l42.89"></a><span id="l42.89">       }</span>
<a href="#l42.90"></a><span id="l42.90"> </span>
<a href="#l42.91"></a><span id="l42.91">       if (toolbox.palette) {</span>
<a href="#l42.92"></a><span id="l42.92">         // Attempt to locate an item with a matching ID within the palette.</span>
<a href="#l42.93"></a><span id="l42.93" class="difflineminus">-        let paletteItem = toolbox.palette.firstChild;</span>
<a href="#l42.94"></a><span id="l42.94" class="difflineplus">+        let paletteItem = toolbox.palette.firstElementChild;</span>
<a href="#l42.95"></a><span id="l42.95">         while (paletteItem) {</span>
<a href="#l42.96"></a><span id="l42.96">           if (paletteItem.id == id) {</span>
<a href="#l42.97"></a><span id="l42.97">             return paletteItem;</span>
<a href="#l42.98"></a><span id="l42.98">           }</span>
<a href="#l42.99"></a><span id="l42.99" class="difflineminus">-          paletteItem = paletteItem.nextSibling;</span>
<a href="#l42.100"></a><span id="l42.100" class="difflineplus">+          paletteItem = paletteItem.nextElementSibling;</span>
<a href="#l42.101"></a><span id="l42.101">         }</span>
<a href="#l42.102"></a><span id="l42.102">       }</span>
<a href="#l42.103"></a><span id="l42.103">       return null;</span>
<a href="#l42.104"></a><span id="l42.104">     }</span>
<a href="#l42.105"></a><span id="l42.105"> </span>
<a href="#l42.106"></a><span id="l42.106">     /**</span>
<a href="#l42.107"></a><span id="l42.107">      * Insert an item into the toolbar.</span>
<a href="#l42.108"></a><span id="l42.108">      *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/common/src/Overlays.jsm</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/common/src/Overlays.jsm</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -391,29 +391,29 @@ class Overlays {</span>
<a href="#l43.4"></a><span id="l43.4">     }</span>
<a href="#l43.5"></a><span id="l43.5"> </span>
<a href="#l43.6"></a><span id="l43.6">     if (pos) {</span>
<a href="#l43.7"></a><span id="l43.7">       for (let id of pos.split(&quot;,&quot;)) {</span>
<a href="#l43.8"></a><span id="l43.8">         let targetchild = this.document.getElementById(id);</span>
<a href="#l43.9"></a><span id="l43.9">         if (targetchild &amp;&amp; targetchild.parentNode == parent) {</span>
<a href="#l43.10"></a><span id="l43.10">           parent.insertBefore(</span>
<a href="#l43.11"></a><span id="l43.11">             node,</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-            after ? targetchild.nextSibling : targetchild</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+            after ? targetchild.nextElementSibling : targetchild</span>
<a href="#l43.14"></a><span id="l43.14">           );</span>
<a href="#l43.15"></a><span id="l43.15">           wasInserted = true;</span>
<a href="#l43.16"></a><span id="l43.16">           break;</span>
<a href="#l43.17"></a><span id="l43.17">         }</span>
<a href="#l43.18"></a><span id="l43.18">       }</span>
<a href="#l43.19"></a><span id="l43.19">     }</span>
<a href="#l43.20"></a><span id="l43.20"> </span>
<a href="#l43.21"></a><span id="l43.21">     if (!wasInserted) {</span>
<a href="#l43.22"></a><span id="l43.22">       // position is 1-based</span>
<a href="#l43.23"></a><span id="l43.23">       let position = parseInt(node.getAttribute(&quot;position&quot;), 10);</span>
<a href="#l43.24"></a><span id="l43.24" class="difflineminus">-      if (position &gt; 0 &amp;&amp; position - 1 &lt;= parent.childNodes.length) {</span>
<a href="#l43.25"></a><span id="l43.25" class="difflineminus">-        parent.insertBefore(node, parent.childNodes[position - 1]);</span>
<a href="#l43.26"></a><span id="l43.26" class="difflineplus">+      if (position &gt; 0 &amp;&amp; position - 1 &lt;= parent.children.length) {</span>
<a href="#l43.27"></a><span id="l43.27" class="difflineplus">+        parent.insertBefore(node, parent.children[position - 1]);</span>
<a href="#l43.28"></a><span id="l43.28">         wasInserted = true;</span>
<a href="#l43.29"></a><span id="l43.29">       }</span>
<a href="#l43.30"></a><span id="l43.30">     }</span>
<a href="#l43.31"></a><span id="l43.31"> </span>
<a href="#l43.32"></a><span id="l43.32">     if (!wasInserted) {</span>
<a href="#l43.33"></a><span id="l43.33">       parent.appendChild(node);</span>
<a href="#l43.34"></a><span id="l43.34">     }</span>
<a href="#l43.35"></a><span id="l43.35">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/common/src/customizeToolbar.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/common/src/customizeToolbar.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -178,19 +178,22 @@ function persistCurrentSets() {</span>
<a href="#l44.4"></a><span id="l44.4">   });</span>
<a href="#l44.5"></a><span id="l44.5"> }</span>
<a href="#l44.6"></a><span id="l44.6"> </span>
<a href="#l44.7"></a><span id="l44.7"> /**</span>
<a href="#l44.8"></a><span id="l44.8">  * Wraps all items in all customizable toolbars in a toolbox.</span>
<a href="#l44.9"></a><span id="l44.9">  */</span>
<a href="#l44.10"></a><span id="l44.10"> function wrapToolbarItems() {</span>
<a href="#l44.11"></a><span id="l44.11">   forEachCustomizableToolbar(function(toolbar) {</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-    for (let item of toolbar.childNodes) {</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+    for (let item of toolbar.children) {</span>
<a href="#l44.14"></a><span id="l44.14">       if (AppConstants.platform == &quot;macosx&quot;) {</span>
<a href="#l44.15"></a><span id="l44.15" class="difflineminus">-        if (item.firstChild &amp;&amp; item.firstChild.localName == &quot;menubar&quot;) {</span>
<a href="#l44.16"></a><span id="l44.16" class="difflineplus">+        if (</span>
<a href="#l44.17"></a><span id="l44.17" class="difflineplus">+          item.firstElementChild &amp;&amp;</span>
<a href="#l44.18"></a><span id="l44.18" class="difflineplus">+          item.firstElementChild.localName == &quot;menubar&quot;</span>
<a href="#l44.19"></a><span id="l44.19" class="difflineplus">+        ) {</span>
<a href="#l44.20"></a><span id="l44.20">           return;</span>
<a href="#l44.21"></a><span id="l44.21">         }</span>
<a href="#l44.22"></a><span id="l44.22">       }</span>
<a href="#l44.23"></a><span id="l44.23">       if (isToolbarItem(item)) {</span>
<a href="#l44.24"></a><span id="l44.24">         let wrapper = wrapToolbarItem(item);</span>
<a href="#l44.25"></a><span id="l44.25">         cleanupItemForToolbar(item, wrapper);</span>
<a href="#l44.26"></a><span id="l44.26">       }</span>
<a href="#l44.27"></a><span id="l44.27">     }</span>
<a href="#l44.28"></a><span id="l44.28" class="difflineat">@@ -211,17 +214,17 @@ function getRootElements() {</span>
<a href="#l44.29"></a><span id="l44.29">  * Unwraps all items in all customizable toolbars in a toolbox.</span>
<a href="#l44.30"></a><span id="l44.30">  */</span>
<a href="#l44.31"></a><span id="l44.31"> function unwrapToolbarItems() {</span>
<a href="#l44.32"></a><span id="l44.32">   let elts = getRootElements();</span>
<a href="#l44.33"></a><span id="l44.33">   for (let i = 0; i &lt; elts.length; i++) {</span>
<a href="#l44.34"></a><span id="l44.34">     let paletteItems = elts[i].getElementsByTagName(&quot;toolbarpaletteitem&quot;);</span>
<a href="#l44.35"></a><span id="l44.35">     let paletteItem;</span>
<a href="#l44.36"></a><span id="l44.36">     while ((paletteItem = paletteItems.item(0)) != null) {</span>
<a href="#l44.37"></a><span id="l44.37" class="difflineminus">-      let toolbarItem = paletteItem.firstChild;</span>
<a href="#l44.38"></a><span id="l44.38" class="difflineplus">+      let toolbarItem = paletteItem.firstElementChild;</span>
<a href="#l44.39"></a><span id="l44.39">       restoreItemForToolbar(toolbarItem, paletteItem);</span>
<a href="#l44.40"></a><span id="l44.40">       paletteItem.parentNode.replaceChild(toolbarItem, paletteItem);</span>
<a href="#l44.41"></a><span id="l44.41">     }</span>
<a href="#l44.42"></a><span id="l44.42">   }</span>
<a href="#l44.43"></a><span id="l44.43"> }</span>
<a href="#l44.44"></a><span id="l44.44"> </span>
<a href="#l44.45"></a><span id="l44.45"> /**</span>
<a href="#l44.46"></a><span id="l44.46">  * Creates a wrapper that can be used to contain a toolbaritem and prevent</span>
<a href="#l44.47"></a><span id="l44.47" class="difflineat">@@ -269,34 +272,34 @@ function wrapToolbarItem(aToolbarItem) {</span>
<a href="#l44.48"></a><span id="l44.48"> }</span>
<a href="#l44.49"></a><span id="l44.49"> </span>
<a href="#l44.50"></a><span id="l44.50"> /**</span>
<a href="#l44.51"></a><span id="l44.51">  * Get the list of ids for the current set of items on each toolbar.</span>
<a href="#l44.52"></a><span id="l44.52">  */</span>
<a href="#l44.53"></a><span id="l44.53"> function getCurrentItemIds() {</span>
<a href="#l44.54"></a><span id="l44.54">   var currentItems = {};</span>
<a href="#l44.55"></a><span id="l44.55">   forEachCustomizableToolbar(function(toolbar) {</span>
<a href="#l44.56"></a><span id="l44.56" class="difflineminus">-    var child = toolbar.firstChild;</span>
<a href="#l44.57"></a><span id="l44.57" class="difflineplus">+    var child = toolbar.firstElementChild;</span>
<a href="#l44.58"></a><span id="l44.58">     while (child) {</span>
<a href="#l44.59"></a><span id="l44.59">       if (isToolbarItem(child)) {</span>
<a href="#l44.60"></a><span id="l44.60">         currentItems[child.id] = 1;</span>
<a href="#l44.61"></a><span id="l44.61">       }</span>
<a href="#l44.62"></a><span id="l44.62" class="difflineminus">-      child = child.nextSibling;</span>
<a href="#l44.63"></a><span id="l44.63" class="difflineplus">+      child = child.nextElementSibling;</span>
<a href="#l44.64"></a><span id="l44.64">     }</span>
<a href="#l44.65"></a><span id="l44.65">   });</span>
<a href="#l44.66"></a><span id="l44.66">   return currentItems;</span>
<a href="#l44.67"></a><span id="l44.67"> }</span>
<a href="#l44.68"></a><span id="l44.68"> </span>
<a href="#l44.69"></a><span id="l44.69"> /**</span>
<a href="#l44.70"></a><span id="l44.70">  * Builds the palette of draggable items that are not yet in a toolbar.</span>
<a href="#l44.71"></a><span id="l44.71">  */</span>
<a href="#l44.72"></a><span id="l44.72"> function buildPalette() {</span>
<a href="#l44.73"></a><span id="l44.73">   // Empty the palette first.</span>
<a href="#l44.74"></a><span id="l44.74" class="difflineminus">-  while (gPaletteBox.lastChild) {</span>
<a href="#l44.75"></a><span id="l44.75" class="difflineminus">-    gPaletteBox.removeChild(gPaletteBox.lastChild);</span>
<a href="#l44.76"></a><span id="l44.76" class="difflineplus">+  while (gPaletteBox.lastElementChild) {</span>
<a href="#l44.77"></a><span id="l44.77" class="difflineplus">+    gPaletteBox.lastChild.remove();</span>
<a href="#l44.78"></a><span id="l44.78">   }</span>
<a href="#l44.79"></a><span id="l44.79"> </span>
<a href="#l44.80"></a><span id="l44.80">   // Add the toolbar separator item.</span>
<a href="#l44.81"></a><span id="l44.81">   var templateNode = document.createXULElement(&quot;toolbarseparator&quot;);</span>
<a href="#l44.82"></a><span id="l44.82">   templateNode.id = &quot;separator&quot;;</span>
<a href="#l44.83"></a><span id="l44.83">   wrapPaletteItem(templateNode);</span>
<a href="#l44.84"></a><span id="l44.84"> </span>
<a href="#l44.85"></a><span id="l44.85">   // Add the toolbar spring item.</span>
<a href="#l44.86"></a><span id="l44.86" class="difflineat">@@ -307,25 +310,25 @@ function buildPalette() {</span>
<a href="#l44.87"></a><span id="l44.87"> </span>
<a href="#l44.88"></a><span id="l44.88">   // Add the toolbar spacer item.</span>
<a href="#l44.89"></a><span id="l44.89">   templateNode = document.createXULElement(&quot;toolbarspacer&quot;);</span>
<a href="#l44.90"></a><span id="l44.90">   templateNode.id = &quot;spacer&quot;;</span>
<a href="#l44.91"></a><span id="l44.91">   templateNode.flex = 1;</span>
<a href="#l44.92"></a><span id="l44.92">   wrapPaletteItem(templateNode);</span>
<a href="#l44.93"></a><span id="l44.93"> </span>
<a href="#l44.94"></a><span id="l44.94">   var currentItems = getCurrentItemIds();</span>
<a href="#l44.95"></a><span id="l44.95" class="difflineminus">-  templateNode = gToolbox.palette.firstChild;</span>
<a href="#l44.96"></a><span id="l44.96" class="difflineplus">+  templateNode = gToolbox.palette.firstElementChild;</span>
<a href="#l44.97"></a><span id="l44.97">   while (templateNode) {</span>
<a href="#l44.98"></a><span id="l44.98">     // Check if the item is already in a toolbar before adding it to the palette.</span>
<a href="#l44.99"></a><span id="l44.99">     if (!(templateNode.id in currentItems)) {</span>
<a href="#l44.100"></a><span id="l44.100">       var paletteItem = document.importNode(templateNode, true);</span>
<a href="#l44.101"></a><span id="l44.101">       wrapPaletteItem(paletteItem);</span>
<a href="#l44.102"></a><span id="l44.102">     }</span>
<a href="#l44.103"></a><span id="l44.103"> </span>
<a href="#l44.104"></a><span id="l44.104" class="difflineminus">-    templateNode = templateNode.nextSibling;</span>
<a href="#l44.105"></a><span id="l44.105" class="difflineplus">+    templateNode = templateNode.nextElementSibling;</span>
<a href="#l44.106"></a><span id="l44.106">   }</span>
<a href="#l44.107"></a><span id="l44.107"> }</span>
<a href="#l44.108"></a><span id="l44.108"> </span>
<a href="#l44.109"></a><span id="l44.109"> /**</span>
<a href="#l44.110"></a><span id="l44.110">  * Makes sure that an item that has been cloned from a template</span>
<a href="#l44.111"></a><span id="l44.111">  * is stripped of any attributes that may adversely affect its</span>
<a href="#l44.112"></a><span id="l44.112">  * appearance in the palette.</span>
<a href="#l44.113"></a><span id="l44.113">  */</span>
<a href="#l44.114"></a><span id="l44.114" class="difflineat">@@ -408,27 +411,27 @@ function restoreItemForToolbar(aItem, aW</span>
<a href="#l44.115"></a><span id="l44.115"> </span>
<a href="#l44.116"></a><span id="l44.116"> function setWrapperType(aItem, aWrapper) {</span>
<a href="#l44.117"></a><span id="l44.117">   if (aItem.localName == &quot;toolbarseparator&quot;) {</span>
<a href="#l44.118"></a><span id="l44.118">     aWrapper.setAttribute(&quot;type&quot;, &quot;separator&quot;);</span>
<a href="#l44.119"></a><span id="l44.119">   } else if (aItem.localName == &quot;toolbarspring&quot;) {</span>
<a href="#l44.120"></a><span id="l44.120">     aWrapper.setAttribute(&quot;type&quot;, &quot;spring&quot;);</span>
<a href="#l44.121"></a><span id="l44.121">   } else if (aItem.localName == &quot;toolbarspacer&quot;) {</span>
<a href="#l44.122"></a><span id="l44.122">     aWrapper.setAttribute(&quot;type&quot;, &quot;spacer&quot;);</span>
<a href="#l44.123"></a><span id="l44.123" class="difflineminus">-  } else if (aItem.localName == &quot;toolbaritem&quot; &amp;&amp; aItem.firstChild) {</span>
<a href="#l44.124"></a><span id="l44.124" class="difflineminus">-    aWrapper.setAttribute(&quot;type&quot;, aItem.firstChild.localName);</span>
<a href="#l44.125"></a><span id="l44.125" class="difflineplus">+  } else if (aItem.localName == &quot;toolbaritem&quot; &amp;&amp; aItem.firstElementChild) {</span>
<a href="#l44.126"></a><span id="l44.126" class="difflineplus">+    aWrapper.setAttribute(&quot;type&quot;, aItem.firstElementChild.localName);</span>
<a href="#l44.127"></a><span id="l44.127">   }</span>
<a href="#l44.128"></a><span id="l44.128"> }</span>
<a href="#l44.129"></a><span id="l44.129"> </span>
<a href="#l44.130"></a><span id="l44.130"> function setDragActive(aItem, aValue) {</span>
<a href="#l44.131"></a><span id="l44.131">   var node = aItem;</span>
<a href="#l44.132"></a><span id="l44.132">   var direction = window.getComputedStyle(aItem).direction;</span>
<a href="#l44.133"></a><span id="l44.133">   var value = direction == &quot;ltr&quot; ? &quot;left&quot; : &quot;right&quot;;</span>
<a href="#l44.134"></a><span id="l44.134">   if (aItem.localName == &quot;toolbar&quot;) {</span>
<a href="#l44.135"></a><span id="l44.135" class="difflineminus">-    node = aItem.lastChild;</span>
<a href="#l44.136"></a><span id="l44.136" class="difflineplus">+    node = aItem.lastElementChild;</span>
<a href="#l44.137"></a><span id="l44.137">     value = direction == &quot;ltr&quot; ? &quot;right&quot; : &quot;left&quot;;</span>
<a href="#l44.138"></a><span id="l44.138">   }</span>
<a href="#l44.139"></a><span id="l44.139"> </span>
<a href="#l44.140"></a><span id="l44.140">   if (!node) {</span>
<a href="#l44.141"></a><span id="l44.141">     return;</span>
<a href="#l44.142"></a><span id="l44.142">   }</span>
<a href="#l44.143"></a><span id="l44.143"> </span>
<a href="#l44.144"></a><span id="l44.144">   if (aValue) {</span>
<a href="#l44.145"></a><span id="l44.145" class="difflineat">@@ -444,25 +447,25 @@ function setDragActive(aItem, aValue) {</span>
<a href="#l44.146"></a><span id="l44.146">  * Restore the default set of buttons to fixed toolbars,</span>
<a href="#l44.147"></a><span id="l44.147">  * remove all custom toolbars, and rebuild the palette.</span>
<a href="#l44.148"></a><span id="l44.148">  */</span>
<a href="#l44.149"></a><span id="l44.149"> function restoreDefaultSet() {</span>
<a href="#l44.150"></a><span id="l44.150">   // Unwrap the items on the toolbar.</span>
<a href="#l44.151"></a><span id="l44.151">   unwrapToolbarItems();</span>
<a href="#l44.152"></a><span id="l44.152"> </span>
<a href="#l44.153"></a><span id="l44.153">   // Remove all of the customized toolbars.</span>
<a href="#l44.154"></a><span id="l44.154" class="difflineminus">-  var child = gToolbox.lastChild;</span>
<a href="#l44.155"></a><span id="l44.155" class="difflineplus">+  var child = gToolbox.lastElementChild;</span>
<a href="#l44.156"></a><span id="l44.156">   while (child) {</span>
<a href="#l44.157"></a><span id="l44.157">     if (child.hasAttribute(&quot;customindex&quot;)) {</span>
<a href="#l44.158"></a><span id="l44.158">       var thisChild = child;</span>
<a href="#l44.159"></a><span id="l44.159" class="difflineminus">-      child = child.previousSibling;</span>
<a href="#l44.160"></a><span id="l44.160" class="difflineplus">+      child = child.previousElementSibling;</span>
<a href="#l44.161"></a><span id="l44.161">       thisChild.currentSet = &quot;__empty&quot;;</span>
<a href="#l44.162"></a><span id="l44.162">       gToolbox.removeChild(thisChild);</span>
<a href="#l44.163"></a><span id="l44.163">     } else {</span>
<a href="#l44.164"></a><span id="l44.164" class="difflineminus">-      child = child.previousSibling;</span>
<a href="#l44.165"></a><span id="l44.165" class="difflineplus">+      child = child.previousElementSibling;</span>
<a href="#l44.166"></a><span id="l44.166">     }</span>
<a href="#l44.167"></a><span id="l44.167">   }</span>
<a href="#l44.168"></a><span id="l44.168"> </span>
<a href="#l44.169"></a><span id="l44.169">   // Restore the defaultset for fixed toolbars.</span>
<a href="#l44.170"></a><span id="l44.170">   forEachCustomizableToolbar(function(toolbar) {</span>
<a href="#l44.171"></a><span id="l44.171">     var defaultSet = toolbar.getAttribute(&quot;defaultset&quot;);</span>
<a href="#l44.172"></a><span id="l44.172">     if (defaultSet) {</span>
<a href="#l44.173"></a><span id="l44.173">       toolbar.currentSet = defaultSet;</span>
<a href="#l44.174"></a><span id="l44.174" class="difflineat">@@ -550,17 +553,17 @@ function forEachCustomizableToolbar(call</span>
<a href="#l44.175"></a><span id="l44.175">     Array.from(window.frameElement.externalToolbars)</span>
<a href="#l44.176"></a><span id="l44.176">       .filter(isCustomizableToolbar)</span>
<a href="#l44.177"></a><span id="l44.177">       .forEach(callback);</span>
<a href="#l44.178"></a><span id="l44.178">   } else if (&quot;arguments&quot; in window &amp;&amp; window.arguments[1].length &gt; 0) {</span>
<a href="#l44.179"></a><span id="l44.179">     Array.from(window.arguments[1])</span>
<a href="#l44.180"></a><span id="l44.180">       .filter(isCustomizableToolbar)</span>
<a href="#l44.181"></a><span id="l44.181">       .forEach(callback);</span>
<a href="#l44.182"></a><span id="l44.182">   }</span>
<a href="#l44.183"></a><span id="l44.183" class="difflineminus">-  Array.from(gToolbox.childNodes)</span>
<a href="#l44.184"></a><span id="l44.184" class="difflineplus">+  Array.from(gToolbox.children)</span>
<a href="#l44.185"></a><span id="l44.185">     .filter(isCustomizableToolbar)</span>
<a href="#l44.186"></a><span id="l44.186">     .forEach(callback);</span>
<a href="#l44.187"></a><span id="l44.187"> }</span>
<a href="#l44.188"></a><span id="l44.188"> </span>
<a href="#l44.189"></a><span id="l44.189"> function isCustomizableToolbar(aElt) {</span>
<a href="#l44.190"></a><span id="l44.190">   return (</span>
<a href="#l44.191"></a><span id="l44.191">     aElt.localName == &quot;toolbar&quot; &amp;&amp; aElt.getAttribute(&quot;customizable&quot;) == &quot;true&quot;</span>
<a href="#l44.192"></a><span id="l44.192">   );</span>
<a href="#l44.193"></a><span id="l44.193" class="difflineat">@@ -604,17 +607,17 @@ function onToolbarDragStart(aEvent) {</span>
<a href="#l44.194"></a><span id="l44.194">     }</span>
<a href="#l44.195"></a><span id="l44.195">     item = item.parentNode;</span>
<a href="#l44.196"></a><span id="l44.196">   }</span>
<a href="#l44.197"></a><span id="l44.197"> </span>
<a href="#l44.198"></a><span id="l44.198">   item.setAttribute(&quot;dragactive&quot;, &quot;true&quot;);</span>
<a href="#l44.199"></a><span id="l44.199"> </span>
<a href="#l44.200"></a><span id="l44.200">   var dt = aEvent.dataTransfer;</span>
<a href="#l44.201"></a><span id="l44.201">   var documentId = gToolboxDocument.documentElement.id;</span>
<a href="#l44.202"></a><span id="l44.202" class="difflineminus">-  dt.setData(&quot;text/toolbarwrapper-id/&quot; + documentId, item.firstChild.id);</span>
<a href="#l44.203"></a><span id="l44.203" class="difflineplus">+  dt.setData(&quot;text/toolbarwrapper-id/&quot; + documentId, item.firstElementChild.id);</span>
<a href="#l44.204"></a><span id="l44.204">   dt.effectAllowed = &quot;move&quot;;</span>
<a href="#l44.205"></a><span id="l44.205"> }</span>
<a href="#l44.206"></a><span id="l44.206"> </span>
<a href="#l44.207"></a><span id="l44.207"> function onToolbarDragOver(aEvent) {</span>
<a href="#l44.208"></a><span id="l44.208">   if (isUnwantedDragEvent(aEvent)) {</span>
<a href="#l44.209"></a><span id="l44.209">     return;</span>
<a href="#l44.210"></a><span id="l44.210">   }</span>
<a href="#l44.211"></a><span id="l44.211"> </span>
<a href="#l44.212"></a><span id="l44.212" class="difflineat">@@ -653,17 +656,17 @@ function onToolbarDragOver(aEvent) {</span>
<a href="#l44.213"></a><span id="l44.213">     var dragAfter;</span>
<a href="#l44.214"></a><span id="l44.214">     if (direction == &quot;ltr&quot;) {</span>
<a href="#l44.215"></a><span id="l44.215">       dragAfter = aEvent.clientX &gt; dropTargetCenter;</span>
<a href="#l44.216"></a><span id="l44.216">     } else {</span>
<a href="#l44.217"></a><span id="l44.217">       dragAfter = aEvent.clientX &lt; dropTargetCenter;</span>
<a href="#l44.218"></a><span id="l44.218">     }</span>
<a href="#l44.219"></a><span id="l44.219"> </span>
<a href="#l44.220"></a><span id="l44.220">     if (dragAfter) {</span>
<a href="#l44.221"></a><span id="l44.221" class="difflineminus">-      gCurrentDragOverItem = dropTarget.nextSibling;</span>
<a href="#l44.222"></a><span id="l44.222" class="difflineplus">+      gCurrentDragOverItem = dropTarget.nextElementSibling;</span>
<a href="#l44.223"></a><span id="l44.223">       if (!gCurrentDragOverItem) {</span>
<a href="#l44.224"></a><span id="l44.224">         gCurrentDragOverItem = toolbar;</span>
<a href="#l44.225"></a><span id="l44.225">       }</span>
<a href="#l44.226"></a><span id="l44.226">     } else {</span>
<a href="#l44.227"></a><span id="l44.227">       gCurrentDragOverItem = dropTarget;</span>
<a href="#l44.228"></a><span id="l44.228">     }</span>
<a href="#l44.229"></a><span id="l44.229">   }</span>
<a href="#l44.230"></a><span id="l44.230"> </span>
<a href="#l44.231"></a><span id="l44.231" class="difflineat">@@ -709,17 +712,17 @@ function onToolbarDrop(aEvent) {</span>
<a href="#l44.232"></a><span id="l44.232">     // Get the wrapper from the toolbar document and make sure that</span>
<a href="#l44.233"></a><span id="l44.233">     // it isn't being dropped on itself.</span>
<a href="#l44.234"></a><span id="l44.234">     let wrapper = gToolboxDocument.getElementById(&quot;wrapper-&quot; + draggedItemId);</span>
<a href="#l44.235"></a><span id="l44.235">     if (wrapper == gCurrentDragOverItem) {</span>
<a href="#l44.236"></a><span id="l44.236">       return;</span>
<a href="#l44.237"></a><span id="l44.237">     }</span>
<a href="#l44.238"></a><span id="l44.238"> </span>
<a href="#l44.239"></a><span id="l44.239">     // Don't allow non-removable kids (e.g., the menubar) to move.</span>
<a href="#l44.240"></a><span id="l44.240" class="difflineminus">-    if (wrapper.firstChild.getAttribute(&quot;removable&quot;) != &quot;true&quot;) {</span>
<a href="#l44.241"></a><span id="l44.241" class="difflineplus">+    if (wrapper.firstElementChild.getAttribute(&quot;removable&quot;) != &quot;true&quot;) {</span>
<a href="#l44.242"></a><span id="l44.242">       return;</span>
<a href="#l44.243"></a><span id="l44.243">     }</span>
<a href="#l44.244"></a><span id="l44.244"> </span>
<a href="#l44.245"></a><span id="l44.245">     // Remove the item from its place in the toolbar.</span>
<a href="#l44.246"></a><span id="l44.246">     wrapper.remove();</span>
<a href="#l44.247"></a><span id="l44.247"> </span>
<a href="#l44.248"></a><span id="l44.248">     // Determine which toolbar we are dropping on.</span>
<a href="#l44.249"></a><span id="l44.249">     var dropToolbar = null;</span>
<a href="#l44.250"></a><span id="l44.250" class="difflineat">@@ -789,29 +792,29 @@ function onPaletteDrop(aEvent) {</span>
<a href="#l44.251"></a><span id="l44.251">   var documentId = gToolboxDocument.documentElement.id;</span>
<a href="#l44.252"></a><span id="l44.252">   var itemId = aEvent.dataTransfer.getData(</span>
<a href="#l44.253"></a><span id="l44.253">     &quot;text/toolbarwrapper-id/&quot; + documentId</span>
<a href="#l44.254"></a><span id="l44.254">   );</span>
<a href="#l44.255"></a><span id="l44.255"> </span>
<a href="#l44.256"></a><span id="l44.256">   var wrapper = gToolboxDocument.getElementById(&quot;wrapper-&quot; + itemId);</span>
<a href="#l44.257"></a><span id="l44.257">   if (wrapper) {</span>
<a href="#l44.258"></a><span id="l44.258">     // Don't allow non-removable kids (e.g., the menubar) to move.</span>
<a href="#l44.259"></a><span id="l44.259" class="difflineminus">-    if (wrapper.firstChild.getAttribute(&quot;removable&quot;) != &quot;true&quot;) {</span>
<a href="#l44.260"></a><span id="l44.260" class="difflineplus">+    if (wrapper.firstElementChild.getAttribute(&quot;removable&quot;) != &quot;true&quot;) {</span>
<a href="#l44.261"></a><span id="l44.261">       return;</span>
<a href="#l44.262"></a><span id="l44.262">     }</span>
<a href="#l44.263"></a><span id="l44.263"> </span>
<a href="#l44.264"></a><span id="l44.264">     var wrapperType = wrapper.getAttribute(&quot;type&quot;);</span>
<a href="#l44.265"></a><span id="l44.265">     if (</span>
<a href="#l44.266"></a><span id="l44.266">       wrapperType != &quot;separator&quot; &amp;&amp;</span>
<a href="#l44.267"></a><span id="l44.267">       wrapperType != &quot;spacer&quot; &amp;&amp;</span>
<a href="#l44.268"></a><span id="l44.268">       wrapperType != &quot;spring&quot;</span>
<a href="#l44.269"></a><span id="l44.269">     ) {</span>
<a href="#l44.270"></a><span id="l44.270" class="difflineminus">-      restoreItemForToolbar(wrapper.firstChild, wrapper);</span>
<a href="#l44.271"></a><span id="l44.271" class="difflineminus">-      wrapPaletteItem(document.importNode(wrapper.firstChild, true));</span>
<a href="#l44.272"></a><span id="l44.272" class="difflineminus">-      gToolbox.palette.appendChild(wrapper.firstChild);</span>
<a href="#l44.273"></a><span id="l44.273" class="difflineplus">+      restoreItemForToolbar(wrapper.firstElementChild, wrapper);</span>
<a href="#l44.274"></a><span id="l44.274" class="difflineplus">+      wrapPaletteItem(document.importNode(wrapper.firstElementChild, true));</span>
<a href="#l44.275"></a><span id="l44.275" class="difflineplus">+      gToolbox.palette.appendChild(wrapper.firstElementChild);</span>
<a href="#l44.276"></a><span id="l44.276">     }</span>
<a href="#l44.277"></a><span id="l44.277"> </span>
<a href="#l44.278"></a><span id="l44.278">     // The item was dragged out of the toolbar.</span>
<a href="#l44.279"></a><span id="l44.279">     wrapper.remove();</span>
<a href="#l44.280"></a><span id="l44.280">   }</span>
<a href="#l44.281"></a><span id="l44.281"> </span>
<a href="#l44.282"></a><span id="l44.282">   toolboxChanged();</span>
<a href="#l44.283"></a><span id="l44.283"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/common/src/viewSource.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/common/src/viewSource.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -678,17 +678,17 @@ ViewSourceChrome.prototype = {</span>
<a href="#l45.4"></a><span id="l45.4">     if (</span>
<a href="#l45.5"></a><span id="l45.5">       this.browser.isRemoteBrowser == shouldBeRemote &amp;&amp;</span>
<a href="#l45.6"></a><span id="l45.6">       this.browser.remoteType == remoteType</span>
<a href="#l45.7"></a><span id="l45.7">     ) {</span>
<a href="#l45.8"></a><span id="l45.8">       return;</span>
<a href="#l45.9"></a><span id="l45.9">     }</span>
<a href="#l45.10"></a><span id="l45.10"> </span>
<a href="#l45.11"></a><span id="l45.11">     let parentNode = this.browser.parentNode;</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-    let nextSibling = this.browser.nextSibling;</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+    let nextElementSibling = this.browser.nextElementSibling;</span>
<a href="#l45.14"></a><span id="l45.14"> </span>
<a href="#l45.15"></a><span id="l45.15">     // Removing and re-adding the browser from and to the DOM strips its XBL</span>
<a href="#l45.16"></a><span id="l45.16">     // properties. Save and restore sameProcessAsFrameLoader. Note that when we</span>
<a href="#l45.17"></a><span id="l45.17">     // restore sameProcessAsFrameLoader, there won't yet be a binding or</span>
<a href="#l45.18"></a><span id="l45.18">     // setter. This works in conjunction with the hack in &lt;xul:browser&gt;'s</span>
<a href="#l45.19"></a><span id="l45.19">     // constructor to re-get the weak reference to it.</span>
<a href="#l45.20"></a><span id="l45.20">     let sameProcessAsFrameLoader = this.browser.sameProcessAsFrameLoader;</span>
<a href="#l45.21"></a><span id="l45.21"> </span>
<a href="#l45.22"></a><span id="l45.22" class="difflineat">@@ -698,19 +698,19 @@ ViewSourceChrome.prototype = {</span>
<a href="#l45.23"></a><span id="l45.23">       this.browser.setAttribute(&quot;remoteType&quot;, remoteType);</span>
<a href="#l45.24"></a><span id="l45.24">     } else {</span>
<a href="#l45.25"></a><span id="l45.25">       this.browser.removeAttribute(&quot;remote&quot;);</span>
<a href="#l45.26"></a><span id="l45.26">       this.browser.removeAttribute(&quot;remoteType&quot;);</span>
<a href="#l45.27"></a><span id="l45.27">     }</span>
<a href="#l45.28"></a><span id="l45.28"> </span>
<a href="#l45.29"></a><span id="l45.29">     this.browser.sameProcessAsFrameLoader = sameProcessAsFrameLoader;</span>
<a href="#l45.30"></a><span id="l45.30"> </span>
<a href="#l45.31"></a><span id="l45.31" class="difflineminus">-    // If nextSibling was null, this will put the browser at</span>
<a href="#l45.32"></a><span id="l45.32" class="difflineplus">+    // If nextElementSibling was null, this will put the browser at</span>
<a href="#l45.33"></a><span id="l45.33">     // the end of the list.</span>
<a href="#l45.34"></a><span id="l45.34" class="difflineminus">-    parentNode.insertBefore(this.browser, nextSibling);</span>
<a href="#l45.35"></a><span id="l45.35" class="difflineplus">+    parentNode.insertBefore(this.browser, nextElementSibling);</span>
<a href="#l45.36"></a><span id="l45.36"> </span>
<a href="#l45.37"></a><span id="l45.37">     if (shouldBeRemote) {</span>
<a href="#l45.38"></a><span id="l45.38">       // We're going to send a message down to the remote browser</span>
<a href="#l45.39"></a><span id="l45.39">       // to load the source content - however, in order for the</span>
<a href="#l45.40"></a><span id="l45.40">       // contentWindowAsCPOW and contentDocumentAsCPOW values on</span>
<a href="#l45.41"></a><span id="l45.41">       // the remote browser to be set, we must set up the</span>
<a href="#l45.42"></a><span id="l45.42">       // RemoteWebProgress, which is lazily loaded. We only need</span>
<a href="#l45.43"></a><span id="l45.43">       // contentWindowAsCPOW for the printing support, and this</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/mail/base/content/ABSearchDialog.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/mail/base/content/ABSearchDialog.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -87,17 +87,17 @@ function searchOnLoad() {</span>
<a href="#l46.4"></a><span id="l46.4"> </span>
<a href="#l46.5"></a><span id="l46.5">   // Initialize globals, see abCommon.js , InitCommonJS()</span>
<a href="#l46.6"></a><span id="l46.6">   abList = document.getElementById(&quot;abPopup&quot;);</span>
<a href="#l46.7"></a><span id="l46.7"> </span>
<a href="#l46.8"></a><span id="l46.8">   if (window.arguments &amp;&amp; window.arguments[0]) {</span>
<a href="#l46.9"></a><span id="l46.9">     SelectDirectory(window.arguments[0].directory);</span>
<a href="#l46.10"></a><span id="l46.10">   } else {</span>
<a href="#l46.11"></a><span id="l46.11">     SelectDirectory(</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-      document.getElementById(&quot;abPopup-menupopup&quot;).firstChild.value</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineplus">+      document.getElementById(&quot;abPopup-menupopup&quot;).firstElementChild.value</span>
<a href="#l46.14"></a><span id="l46.14">     );</span>
<a href="#l46.15"></a><span id="l46.15">   }</span>
<a href="#l46.16"></a><span id="l46.16"> </span>
<a href="#l46.17"></a><span id="l46.17">   onMore(null);</span>
<a href="#l46.18"></a><span id="l46.18"> }</span>
<a href="#l46.19"></a><span id="l46.19"> </span>
<a href="#l46.20"></a><span id="l46.20"> function searchOnUnload() {</span>
<a href="#l46.21"></a><span id="l46.21">   CloseAbView();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/mail/base/content/FilterListDialog.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/mail/base/content/FilterListDialog.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -329,17 +329,17 @@ function toggleFilter(aFilterItem, aSetF</span>
<a href="#l47.4"></a><span id="l47.4">       ])</span>
<a href="#l47.5"></a><span id="l47.5">     );</span>
<a href="#l47.6"></a><span id="l47.6">     return;</span>
<a href="#l47.7"></a><span id="l47.7">   }</span>
<a href="#l47.8"></a><span id="l47.8">   filter.enabled = aSetForEvent === undefined ? !filter.enabled : aSetForEvent;</span>
<a href="#l47.9"></a><span id="l47.9"> </span>
<a href="#l47.10"></a><span id="l47.10">   // Now update the checkbox</span>
<a href="#l47.11"></a><span id="l47.11">   if (aSetForEvent === undefined) {</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-    aFilterItem.firstChild.nextSibling.checked = filter.enabled;</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineplus">+    aFilterItem.firstElementChild.nextElementSibling.checked = filter.enabled;</span>
<a href="#l47.14"></a><span id="l47.14">   }</span>
<a href="#l47.15"></a><span id="l47.15">   // For accessibility set the checked state on listitem</span>
<a href="#l47.16"></a><span id="l47.16">   aFilterItem.setAttribute(&quot;aria-checked&quot;, filter.enabled);</span>
<a href="#l47.17"></a><span id="l47.17"> }</span>
<a href="#l47.18"></a><span id="l47.18"> </span>
<a href="#l47.19"></a><span id="l47.19"> /**</span>
<a href="#l47.20"></a><span id="l47.20">  * Selects a specific filter in the filter list.</span>
<a href="#l47.21"></a><span id="l47.21">  * The listbox view is scrolled to the corresponding item.</span>
<a href="#l47.22"></a><span id="l47.22" class="difflineat">@@ -802,18 +802,18 @@ function rebuildFilterList() {</span>
<a href="#l47.23"></a><span id="l47.23">     if (aTempFilterList &amp;&amp; aTempFilterList[listitemIndex] != i) {</span>
<a href="#l47.24"></a><span id="l47.24">       continue;</span>
<a href="#l47.25"></a><span id="l47.25">     }</span>
<a href="#l47.26"></a><span id="l47.26"> </span>
<a href="#l47.27"></a><span id="l47.27">     if (listitemCount &gt; listitemIndex) {</span>
<a href="#l47.28"></a><span id="l47.28">       // If there is a free existing listitem, reuse it.</span>
<a href="#l47.29"></a><span id="l47.29">       // Use .itemChildren[] instead of .getItemAtIndex() as it is much faster.</span>
<a href="#l47.30"></a><span id="l47.30">       listitem = gFilterListbox.itemChildren[listitemIndex];</span>
<a href="#l47.31"></a><span id="l47.31" class="difflineminus">-      nameCell = listitem.firstChild;</span>
<a href="#l47.32"></a><span id="l47.32" class="difflineminus">-      enabledCell = nameCell.nextSibling;</span>
<a href="#l47.33"></a><span id="l47.33" class="difflineplus">+      nameCell = listitem.firstElementChild;</span>
<a href="#l47.34"></a><span id="l47.34" class="difflineplus">+      enabledCell = nameCell.nextElementSibling;</span>
<a href="#l47.35"></a><span id="l47.35">     } else {</span>
<a href="#l47.36"></a><span id="l47.36">       // If there are not enough listitems in the list, create a new one.</span>
<a href="#l47.37"></a><span id="l47.37">       listitem = document.createXULElement(&quot;richlistitem&quot;);</span>
<a href="#l47.38"></a><span id="l47.38">       listitem.setAttribute(&quot;align&quot;, &quot;center&quot;);</span>
<a href="#l47.39"></a><span id="l47.39">       listitem.setAttribute(&quot;role&quot;, &quot;checkbox&quot;);</span>
<a href="#l47.40"></a><span id="l47.40">       nameCell = document.createXULElement(&quot;label&quot;);</span>
<a href="#l47.41"></a><span id="l47.41">       nameCell.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l47.42"></a><span id="l47.42">       enabledCell = document.createXULElement(&quot;checkbox&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/mail/base/content/SearchDialog.js</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/mail/base/content/SearchDialog.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -542,18 +542,18 @@ function GetScopeForFolder(folder) {</span>
<a href="#l48.4"></a><span id="l48.4">       }</span>
<a href="#l48.5"></a><span id="l48.5">     // fall through to default</span>
<a href="#l48.6"></a><span id="l48.6">     default:</span>
<a href="#l48.7"></a><span id="l48.7">       return nsMsgSearchScope.offlineMail;</span>
<a href="#l48.8"></a><span id="l48.8">   }</span>
<a href="#l48.9"></a><span id="l48.9"> }</span>
<a href="#l48.10"></a><span id="l48.10"> </span>
<a href="#l48.11"></a><span id="l48.11"> function goUpdateSearchItems(commandset) {</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-  for (var i = 0; i &lt; commandset.childNodes.length; i++) {</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineminus">-    var commandID = commandset.childNodes[i].getAttribute(&quot;id&quot;);</span>
<a href="#l48.14"></a><span id="l48.14" class="difflineplus">+  for (var i = 0; i &lt; commandset.children.length; i++) {</span>
<a href="#l48.15"></a><span id="l48.15" class="difflineplus">+    var commandID = commandset.children[i].getAttribute(&quot;id&quot;);</span>
<a href="#l48.16"></a><span id="l48.16">     if (commandID) {</span>
<a href="#l48.17"></a><span id="l48.17">       goUpdateCommand(commandID);</span>
<a href="#l48.18"></a><span id="l48.18">     }</span>
<a href="#l48.19"></a><span id="l48.19">   }</span>
<a href="#l48.20"></a><span id="l48.20"> }</span>
<a href="#l48.21"></a><span id="l48.21"> </span>
<a href="#l48.22"></a><span id="l48.22"> // used to toggle functionality for Search/Stop button.</span>
<a href="#l48.23"></a><span id="l48.23"> function onSearchButton(event) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/mail/base/content/folderPane.js</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/mail/base/content/folderPane.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -511,17 +511,17 @@ var gFolderTreeView = {</span>
<a href="#l49.4"></a><span id="l49.4">     let fullModes = [];</span>
<a href="#l49.5"></a><span id="l49.5">     let compactModes = [];</span>
<a href="#l49.6"></a><span id="l49.6">     for (let mode of this._modeNames) {</span>
<a href="#l49.7"></a><span id="l49.7">       let array = mode.endsWith(&quot;_compact&quot;) ? compactModes : fullModes;</span>
<a href="#l49.8"></a><span id="l49.8">       array.push(mode);</span>
<a href="#l49.9"></a><span id="l49.9">     }</span>
<a href="#l49.10"></a><span id="l49.10"> </span>
<a href="#l49.11"></a><span id="l49.11">     let modeSelector = document.getElementById(&quot;folderpane-mode-selector&quot;)</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-      .firstChild;</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineplus">+      .firstElementChild;</span>
<a href="#l49.14"></a><span id="l49.14">     // Can't use modeSelector.removeAllItems() here as it would remove the menupopup too, with its attributes.</span>
<a href="#l49.15"></a><span id="l49.15">     while (modeSelector.menupopup.hasChildNodes()) {</span>
<a href="#l49.16"></a><span id="l49.16">       modeSelector.menupopup.lastChild.remove();</span>
<a href="#l49.17"></a><span id="l49.17">     }</span>
<a href="#l49.18"></a><span id="l49.18"> </span>
<a href="#l49.19"></a><span id="l49.19">     let currentMode = this.mode;</span>
<a href="#l49.20"></a><span id="l49.20">     let parent = this;</span>
<a href="#l49.21"></a><span id="l49.21"> </span>
<a href="#l49.22"></a><span id="l49.22" class="difflineat">@@ -559,17 +559,17 @@ var gFolderTreeView = {</span>
<a href="#l49.23"></a><span id="l49.23"> </span>
<a href="#l49.24"></a><span id="l49.24">   _selectModeInSelector(aMode) {</span>
<a href="#l49.25"></a><span id="l49.25">     // Show the mode in the mode selector, if it is on a toolbar.</span>
<a href="#l49.26"></a><span id="l49.26">     let modeSelector = document.getElementById(&quot;folderpane-mode-selector&quot;);</span>
<a href="#l49.27"></a><span id="l49.27">     if (modeSelector) {</span>
<a href="#l49.28"></a><span id="l49.28">       if (!modeSelector.querySelector('[value=&quot;' + aMode + '&quot;]')) {</span>
<a href="#l49.29"></a><span id="l49.29">         this._initFolderModeSelector();</span>
<a href="#l49.30"></a><span id="l49.30">       }</span>
<a href="#l49.31"></a><span id="l49.31" class="difflineminus">-      modeSelector.firstChild.value = aMode;</span>
<a href="#l49.32"></a><span id="l49.32" class="difflineplus">+      modeSelector.firstElementChild.value = aMode;</span>
<a href="#l49.33"></a><span id="l49.33">     }</span>
<a href="#l49.34"></a><span id="l49.34">   },</span>
<a href="#l49.35"></a><span id="l49.35"> </span>
<a href="#l49.36"></a><span id="l49.36">   /**</span>
<a href="#l49.37"></a><span id="l49.37">    * Selects a given nsIMsgFolder in the tree.  This function will also ensure</span>
<a href="#l49.38"></a><span id="l49.38">    * that the folder is actually being displayed (that is, that none of its</span>
<a href="#l49.39"></a><span id="l49.39">    * ancestors are collapsed.</span>
<a href="#l49.40"></a><span id="l49.40">    *</span>
<a href="#l49.41"></a><span id="l49.41" class="difflineat">@@ -2358,18 +2358,18 @@ var gFolderTreeView = {</span>
<a href="#l49.42"></a><span id="l49.42">         newChildIndex = Number(aParentIndex) + 1;</span>
<a href="#l49.43"></a><span id="l49.43">       } else if (newChildNum &lt; aParent._children.length - 1) {</span>
<a href="#l49.44"></a><span id="l49.44">         // if we're not the last child, insert ourselves before the next child.</span>
<a href="#l49.45"></a><span id="l49.45">         newChildIndex = this.getIndexOfFolder(</span>
<a href="#l49.46"></a><span id="l49.46">           aParent._children[Number(newChildNum) + 1]._folder</span>
<a href="#l49.47"></a><span id="l49.47">         );</span>
<a href="#l49.48"></a><span id="l49.48">       } else {</span>
<a href="#l49.49"></a><span id="l49.49">         // otherwise, go after the last child</span>
<a href="#l49.50"></a><span id="l49.50" class="difflineminus">-        let lastChild = aParent._children[newChildNum - 1];</span>
<a href="#l49.51"></a><span id="l49.51" class="difflineminus">-        let lastChildIndex = this.getIndexOfFolder(lastChild._folder);</span>
<a href="#l49.52"></a><span id="l49.52" class="difflineplus">+        let lastElementChild = aParent._children[newChildNum - 1];</span>
<a href="#l49.53"></a><span id="l49.53" class="difflineplus">+        let lastChildIndex = this.getIndexOfFolder(lastElementChild._folder);</span>
<a href="#l49.54"></a><span id="l49.54">         newChildIndex = Number(lastChildIndex) + 1;</span>
<a href="#l49.55"></a><span id="l49.55">         while (</span>
<a href="#l49.56"></a><span id="l49.56">           newChildIndex &lt; this.rowCount &amp;&amp;</span>
<a href="#l49.57"></a><span id="l49.57">           this._rowMap[newChildIndex].level &gt; this._rowMap[lastChildIndex].level</span>
<a href="#l49.58"></a><span id="l49.58">         ) {</span>
<a href="#l49.59"></a><span id="l49.59">           newChildIndex++;</span>
<a href="#l49.60"></a><span id="l49.60">         }</span>
<a href="#l49.61"></a><span id="l49.61">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/mail/base/content/glodaFacetTab.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/mail/base/content/glodaFacetTab.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -21,17 +21,19 @@ var glodaFacetTabType = {</span>
<a href="#l50.4"></a><span id="l50.4">       type: &quot;glodaSearch&quot;,</span>
<a href="#l50.5"></a><span id="l50.5">     },</span>
<a href="#l50.6"></a><span id="l50.6">   },</span>
<a href="#l50.7"></a><span id="l50.7">   openTab(aTab, aArgs) {</span>
<a href="#l50.8"></a><span id="l50.8">     // we have no browser until our XUL document loads</span>
<a href="#l50.9"></a><span id="l50.9">     aTab.browser = null;</span>
<a href="#l50.10"></a><span id="l50.10"> </span>
<a href="#l50.11"></a><span id="l50.11">     // First clone the page and set up the basics.</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-    let clone = document.getElementById(&quot;glodaTab&quot;).firstChild.cloneNode(true);</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+    let clone = document</span>
<a href="#l50.14"></a><span id="l50.14" class="difflineplus">+      .getElementById(&quot;glodaTab&quot;)</span>
<a href="#l50.15"></a><span id="l50.15" class="difflineplus">+      .firstElementChild.cloneNode(true);</span>
<a href="#l50.16"></a><span id="l50.16"> </span>
<a href="#l50.17"></a><span id="l50.17">     aTab.panel.setAttribute(&quot;id&quot;, &quot;glodaTab&quot; + this.lastTabId);</span>
<a href="#l50.18"></a><span id="l50.18">     aTab.panel.appendChild(clone);</span>
<a href="#l50.19"></a><span id="l50.19">     aTab.iframe = aTab.panel.querySelector(&quot;iframe&quot;);</span>
<a href="#l50.20"></a><span id="l50.20"> </span>
<a href="#l50.21"></a><span id="l50.21">     // Wire up the search input icon click event</span>
<a href="#l50.22"></a><span id="l50.22">     let searchInput = aTab.panel.querySelector(&quot;.remote-gloda-search&quot;);</span>
<a href="#l50.23"></a><span id="l50.23">     searchInput.focus();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/mail/base/content/mailContextMenus.js</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/mail/base/content/mailContextMenus.js</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -636,27 +636,27 @@ function fillFolderPaneContextMenu(aEven</span>
<a href="#l51.4"></a><span id="l51.4">     &quot;folderPaneContext-searchMessages&quot;,</span>
<a href="#l51.5"></a><span id="l51.5">     numSelected == 1 &amp;&amp; !haveAnyVirtualFolders</span>
<a href="#l51.6"></a><span id="l51.6">   );</span>
<a href="#l51.7"></a><span id="l51.7">   goUpdateCommand(&quot;cmd_search&quot;);</span>
<a href="#l51.8"></a><span id="l51.8"> </span>
<a href="#l51.9"></a><span id="l51.9">   // handle our separators</span>
<a href="#l51.10"></a><span id="l51.10">   function hideIfAppropriate(aID) {</span>
<a href="#l51.11"></a><span id="l51.11">     var separator = document.getElementById(aID);</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-    var sibling = separator.previousSibling;</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineplus">+    var sibling = separator.previousElementSibling;</span>
<a href="#l51.14"></a><span id="l51.14">     while (sibling) {</span>
<a href="#l51.15"></a><span id="l51.15">       if (sibling.getAttribute(&quot;hidden&quot;) != &quot;true&quot;) {</span>
<a href="#l51.16"></a><span id="l51.16">         ShowMenuItem(</span>
<a href="#l51.17"></a><span id="l51.17">           aID,</span>
<a href="#l51.18"></a><span id="l51.18">           sibling.localName != &quot;menuseparator&quot; &amp;&amp;</span>
<a href="#l51.19"></a><span id="l51.19">             hasAVisibleNextSibling(separator)</span>
<a href="#l51.20"></a><span id="l51.20">         );</span>
<a href="#l51.21"></a><span id="l51.21">         return;</span>
<a href="#l51.22"></a><span id="l51.22">       }</span>
<a href="#l51.23"></a><span id="l51.23" class="difflineminus">-      sibling = sibling.previousSibling;</span>
<a href="#l51.24"></a><span id="l51.24" class="difflineplus">+      sibling = sibling.previousElementSibling;</span>
<a href="#l51.25"></a><span id="l51.25">     }</span>
<a href="#l51.26"></a><span id="l51.26">     ShowMenuItem(aID, false);</span>
<a href="#l51.27"></a><span id="l51.27">   }</span>
<a href="#l51.28"></a><span id="l51.28"> </span>
<a href="#l51.29"></a><span id="l51.29">   // Hide / Show our menu separators based on the menu items we are showing.</span>
<a href="#l51.30"></a><span id="l51.30">   ShowMenuItem(&quot;folderPaneContext-sep1&quot;, selectedServers.length == 0);</span>
<a href="#l51.31"></a><span id="l51.31">   hideIfAppropriate(&quot;folderPaneContext-sep1&quot;);</span>
<a href="#l51.32"></a><span id="l51.32">   hideIfAppropriate(&quot;folderPaneContext-sep2&quot;);</span>
<a href="#l51.33"></a><span id="l51.33" class="difflineat">@@ -676,25 +676,25 @@ function EnableMenuItem(id, enableItem) </span>
<a href="#l51.34"></a><span id="l51.34"> }</span>
<a href="#l51.35"></a><span id="l51.35"> </span>
<a href="#l51.36"></a><span id="l51.36"> function SetMenuItemLabel(id, label) {</span>
<a href="#l51.37"></a><span id="l51.37">   document.getElementById(id).setAttribute(&quot;label&quot;, label);</span>
<a href="#l51.38"></a><span id="l51.38"> }</span>
<a href="#l51.39"></a><span id="l51.39"> </span>
<a href="#l51.40"></a><span id="l51.40"> // helper function used by shouldShowSeparator</span>
<a href="#l51.41"></a><span id="l51.41"> function hasAVisibleNextSibling(aNode) {</span>
<a href="#l51.42"></a><span id="l51.42" class="difflineminus">-  var sibling = aNode.nextSibling;</span>
<a href="#l51.43"></a><span id="l51.43" class="difflineplus">+  var sibling = aNode.nextElementSibling;</span>
<a href="#l51.44"></a><span id="l51.44">   while (sibling) {</span>
<a href="#l51.45"></a><span id="l51.45">     if (</span>
<a href="#l51.46"></a><span id="l51.46">       sibling.getAttribute(&quot;hidden&quot;) != &quot;true&quot; &amp;&amp;</span>
<a href="#l51.47"></a><span id="l51.47">       sibling.localName != &quot;menuseparator&quot;</span>
<a href="#l51.48"></a><span id="l51.48">     ) {</span>
<a href="#l51.49"></a><span id="l51.49">       return true;</span>
<a href="#l51.50"></a><span id="l51.50">     }</span>
<a href="#l51.51"></a><span id="l51.51" class="difflineminus">-    sibling = sibling.nextSibling;</span>
<a href="#l51.52"></a><span id="l51.52" class="difflineplus">+    sibling = sibling.nextElementSibling;</span>
<a href="#l51.53"></a><span id="l51.53">   }</span>
<a href="#l51.54"></a><span id="l51.54">   return false;</span>
<a href="#l51.55"></a><span id="l51.55"> }</span>
<a href="#l51.56"></a><span id="l51.56"> </span>
<a href="#l51.57"></a><span id="l51.57"> function IsMenuItemShowing(menuID) {</span>
<a href="#l51.58"></a><span id="l51.58">   var item = document.getElementById(menuID);</span>
<a href="#l51.59"></a><span id="l51.59">   if (item) {</span>
<a href="#l51.60"></a><span id="l51.60">     return item.hidden != &quot;true&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/mail/base/content/mailCore.js</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/mail/base/content/mailCore.js</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -211,18 +211,18 @@ function overlayRepositionDialog() {</span>
<a href="#l52.4"></a><span id="l52.4">   var nX = Math.max(Math.min(sX, sW - wW), sAL);</span>
<a href="#l52.5"></a><span id="l52.5">   var nY = Math.max(Math.min(sY, sH - wH), sAT);</span>
<a href="#l52.6"></a><span id="l52.6">   window.moveTo(nX, nY);</span>
<a href="#l52.7"></a><span id="l52.7"> }</span>
<a href="#l52.8"></a><span id="l52.8"> </span>
<a href="#l52.9"></a><span id="l52.9"> function CustomizeMailToolbar(toolboxId, customizePopupId) {</span>
<a href="#l52.10"></a><span id="l52.10">   // Disable the toolbar context menu items</span>
<a href="#l52.11"></a><span id="l52.11">   var menubar = document.getElementById(&quot;mail-menubar&quot;);</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-  for (var i = 0; i &lt; menubar.childNodes.length; ++i) {</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineminus">-    menubar.childNodes[i].setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l52.14"></a><span id="l52.14" class="difflineplus">+  for (var i = 0; i &lt; menubar.children.length; ++i) {</span>
<a href="#l52.15"></a><span id="l52.15" class="difflineplus">+    menubar.children[i].setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l52.16"></a><span id="l52.16">   }</span>
<a href="#l52.17"></a><span id="l52.17"> </span>
<a href="#l52.18"></a><span id="l52.18">   var customizePopup = document.getElementById(customizePopupId);</span>
<a href="#l52.19"></a><span id="l52.19">   customizePopup.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l52.20"></a><span id="l52.20"> </span>
<a href="#l52.21"></a><span id="l52.21">   var toolbox = document.getElementById(toolboxId);</span>
<a href="#l52.22"></a><span id="l52.22"> </span>
<a href="#l52.23"></a><span id="l52.23">   var customizeURL = &quot;chrome://messenger/content/customizeToolbar.xul&quot;;</span>
<a href="#l52.24"></a><span id="l52.24" class="difflineat">@@ -295,18 +295,18 @@ function MailToolboxCustomizeDone(aEvent</span>
<a href="#l52.25"></a><span id="l52.25">     document.getElementById(&quot;customizeToolbarSheetIFrame&quot;).hidden = true;</span>
<a href="#l52.26"></a><span id="l52.26">     document.getElementById(&quot;customizeToolbarSheetPopup&quot;).hidePopup();</span>
<a href="#l52.27"></a><span id="l52.27">   }</span>
<a href="#l52.28"></a><span id="l52.28"> </span>
<a href="#l52.29"></a><span id="l52.29">   // Update global UI elements that may have been added or removed</span>
<a href="#l52.30"></a><span id="l52.30"> </span>
<a href="#l52.31"></a><span id="l52.31">   // Re-enable parts of the UI we disabled during the dialog</span>
<a href="#l52.32"></a><span id="l52.32">   var menubar = document.getElementById(&quot;mail-menubar&quot;);</span>
<a href="#l52.33"></a><span id="l52.33" class="difflineminus">-  for (var i = 0; i &lt; menubar.childNodes.length; ++i) {</span>
<a href="#l52.34"></a><span id="l52.34" class="difflineminus">-    menubar.childNodes[i].setAttribute(&quot;disabled&quot;, false);</span>
<a href="#l52.35"></a><span id="l52.35" class="difflineplus">+  for (var i = 0; i &lt; menubar.children.length; ++i) {</span>
<a href="#l52.36"></a><span id="l52.36" class="difflineplus">+    menubar.children[i].setAttribute(&quot;disabled&quot;, false);</span>
<a href="#l52.37"></a><span id="l52.37">   }</span>
<a href="#l52.38"></a><span id="l52.38"> </span>
<a href="#l52.39"></a><span id="l52.39">   // make sure the mail views search box is initialized</span>
<a href="#l52.40"></a><span id="l52.40">   if (document.getElementById(&quot;mailviews-container&quot;)) {</span>
<a href="#l52.41"></a><span id="l52.41">     ViewPickerOnLoad();</span>
<a href="#l52.42"></a><span id="l52.42">   }</span>
<a href="#l52.43"></a><span id="l52.43"> </span>
<a href="#l52.44"></a><span id="l52.44">   // make sure the folder location picker is initialized</span>
<a href="#l52.45"></a><span id="l52.45" class="difflineat">@@ -347,18 +347,18 @@ function MailToolboxCustomizeDone(aEvent</span>
<a href="#l52.46"></a><span id="l52.46"> </span>
<a href="#l52.47"></a><span id="l52.47">       // .teardown() is only available here if the menu has its frame</span>
<a href="#l52.48"></a><span id="l52.48">       // otherwise the folderWidgets.xml::folder-menupopup binding is not</span>
<a href="#l52.49"></a><span id="l52.49">       // attached to the popup. So if it is not available, remove the items</span>
<a href="#l52.50"></a><span id="l52.50">       // explicitly. Only remove elements that were generated by the binding.</span>
<a href="#l52.51"></a><span id="l52.51">       if (&quot;_teardown&quot; in popup) {</span>
<a href="#l52.52"></a><span id="l52.52">         popup._teardown();</span>
<a href="#l52.53"></a><span id="l52.53">       } else {</span>
<a href="#l52.54"></a><span id="l52.54" class="difflineminus">-        for (let i = popup.childNodes.length - 1; i &gt;= 0; i--) {</span>
<a href="#l52.55"></a><span id="l52.55" class="difflineminus">-          let child = popup.childNodes[i];</span>
<a href="#l52.56"></a><span id="l52.56" class="difflineplus">+        for (let i = popup.children.length - 1; i &gt;= 0; i--) {</span>
<a href="#l52.57"></a><span id="l52.57" class="difflineplus">+          let child = popup.children[i];</span>
<a href="#l52.58"></a><span id="l52.58">           if (child.getAttribute(&quot;generated&quot;) != &quot;true&quot;) {</span>
<a href="#l52.59"></a><span id="l52.59">             continue;</span>
<a href="#l52.60"></a><span id="l52.60">           }</span>
<a href="#l52.61"></a><span id="l52.61">           if (&quot;_teardown&quot; in child) {</span>
<a href="#l52.62"></a><span id="l52.62">             child._teardown();</span>
<a href="#l52.63"></a><span id="l52.63">           }</span>
<a href="#l52.64"></a><span id="l52.64">           child.remove();</span>
<a href="#l52.65"></a><span id="l52.65">         }</span>
<a href="#l52.66"></a><span id="l52.66" class="difflineat">@@ -389,26 +389,26 @@ function onViewToolbarsPopupShowing(</span>
<a href="#l52.67"></a><span id="l52.67">   if (!Array.isArray(toolboxIds)) {</span>
<a href="#l52.68"></a><span id="l52.68">     toolboxIds = [toolboxIds];</span>
<a href="#l52.69"></a><span id="l52.69">   }</span>
<a href="#l52.70"></a><span id="l52.70"> </span>
<a href="#l52.71"></a><span id="l52.71">   const popup =</span>
<a href="#l52.72"></a><span id="l52.72">     event.target.querySelector(&quot;.panel-subview-body&quot;) || event.target;</span>
<a href="#l52.73"></a><span id="l52.73"> </span>
<a href="#l52.74"></a><span id="l52.74">   // Remove all collapsible nodes from the menu.</span>
<a href="#l52.75"></a><span id="l52.75" class="difflineminus">-  for (let i = popup.childNodes.length - 1; i &gt;= 0; --i) {</span>
<a href="#l52.76"></a><span id="l52.76" class="difflineminus">-    const deadItem = popup.childNodes[i];</span>
<a href="#l52.77"></a><span id="l52.77" class="difflineplus">+  for (let i = popup.children.length - 1; i &gt;= 0; --i) {</span>
<a href="#l52.78"></a><span id="l52.78" class="difflineplus">+    const deadItem = popup.children[i];</span>
<a href="#l52.79"></a><span id="l52.79"> </span>
<a href="#l52.80"></a><span id="l52.80">     if (deadItem.hasAttribute(&quot;iscollapsible&quot;)) {</span>
<a href="#l52.81"></a><span id="l52.81">       deadItem.remove();</span>
<a href="#l52.82"></a><span id="l52.82">     }</span>
<a href="#l52.83"></a><span id="l52.83">   }</span>
<a href="#l52.84"></a><span id="l52.84"> </span>
<a href="#l52.85"></a><span id="l52.85">   // We insert menuitems before the first child if no insert point is given.</span>
<a href="#l52.86"></a><span id="l52.86" class="difflineminus">-  const firstMenuItem = insertPoint || popup.firstChild;</span>
<a href="#l52.87"></a><span id="l52.87" class="difflineplus">+  const firstMenuItem = insertPoint || popup.firstElementChild;</span>
<a href="#l52.88"></a><span id="l52.88"> </span>
<a href="#l52.89"></a><span id="l52.89">   for (const toolboxId of toolboxIds) {</span>
<a href="#l52.90"></a><span id="l52.90">     const toolbox = document.getElementById(toolboxId);</span>
<a href="#l52.91"></a><span id="l52.91"> </span>
<a href="#l52.92"></a><span id="l52.92">     // We consider child nodes that have a toolbarname attribute.</span>
<a href="#l52.93"></a><span id="l52.93">     const toolbars = Array.from(toolbox.querySelectorAll(&quot;[toolbarname]&quot;));</span>
<a href="#l52.94"></a><span id="l52.94"> </span>
<a href="#l52.95"></a><span id="l52.95">     // Add the folder pane toolbar to the list of toolbars that can be shown and</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/mail/base/content/mailWidgets.js</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/mail/base/content/mailWidgets.js</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -225,52 +225,52 @@</span>
<a href="#l53.4"></a><span id="l53.4"> </span>
<a href="#l53.5"></a><span id="l53.5">       this.headerValue = document.createXULElement(&quot;hbox&quot;);</span>
<a href="#l53.6"></a><span id="l53.6">       this.headerValue.classList.add(&quot;headerValue&quot;);</span>
<a href="#l53.7"></a><span id="l53.7">       this.headerValue.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l53.8"></a><span id="l53.8">       this.appendChild(this.headerValue);</span>
<a href="#l53.9"></a><span id="l53.9">     }</span>
<a href="#l53.10"></a><span id="l53.10"> </span>
<a href="#l53.11"></a><span id="l53.11">     _toggleWrap() {</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-      for (let i = 0; i &lt; this.headerValue.childNodes.length; i += 2) {</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineplus">+      for (let i = 0; i &lt; this.headerValue.children.length; i += 2) {</span>
<a href="#l53.14"></a><span id="l53.14">         if (!this.showFullMessageIds) {</span>
<a href="#l53.15"></a><span id="l53.15">           this.toggleIcon.classList.add(&quot;open&quot;);</span>
<a href="#l53.16"></a><span id="l53.16" class="difflineminus">-          this.headerValue.childNodes[i].setAttribute(</span>
<a href="#l53.17"></a><span id="l53.17" class="difflineplus">+          this.headerValue.children[i].setAttribute(</span>
<a href="#l53.18"></a><span id="l53.18">             &quot;label&quot;,</span>
<a href="#l53.19"></a><span id="l53.19">             this.mMessageIds[i / 2]</span>
<a href="#l53.20"></a><span id="l53.20">           );</span>
<a href="#l53.21"></a><span id="l53.21" class="difflineminus">-          this.headerValue.childNodes[i].removeAttribute(&quot;tooltiptext&quot;);</span>
<a href="#l53.22"></a><span id="l53.22" class="difflineplus">+          this.headerValue.children[i].removeAttribute(&quot;tooltiptext&quot;);</span>
<a href="#l53.23"></a><span id="l53.23">           this.headerValue.removeAttribute(&quot;singleline&quot;);</span>
<a href="#l53.24"></a><span id="l53.24">         } else {</span>
<a href="#l53.25"></a><span id="l53.25">           this.toggleIcon.classList.remove(&quot;open&quot;);</span>
<a href="#l53.26"></a><span id="l53.26" class="difflineminus">-          this.headerValue.childNodes[i].setAttribute(&quot;label&quot;, i / 2 + 1);</span>
<a href="#l53.27"></a><span id="l53.27" class="difflineminus">-          this.headerValue.childNodes[i].setAttribute(</span>
<a href="#l53.28"></a><span id="l53.28" class="difflineplus">+          this.headerValue.children[i].setAttribute(&quot;label&quot;, i / 2 + 1);</span>
<a href="#l53.29"></a><span id="l53.29" class="difflineplus">+          this.headerValue.children[i].setAttribute(</span>
<a href="#l53.30"></a><span id="l53.30">             &quot;tooltiptext&quot;,</span>
<a href="#l53.31"></a><span id="l53.31">             this.mMessageIds[i / 2]</span>
<a href="#l53.32"></a><span id="l53.32">           );</span>
<a href="#l53.33"></a><span id="l53.33">         }</span>
<a href="#l53.34"></a><span id="l53.34">       }</span>
<a href="#l53.35"></a><span id="l53.35"> </span>
<a href="#l53.36"></a><span id="l53.36">       this.showFullMessageIds = !this.showFullMessageIds;</span>
<a href="#l53.37"></a><span id="l53.37">     }</span>
<a href="#l53.38"></a><span id="l53.38"> </span>
<a href="#l53.39"></a><span id="l53.39">     fillMessageIdNodes() {</span>
<a href="#l53.40"></a><span id="l53.40">       while (</span>
<a href="#l53.41"></a><span id="l53.41" class="difflineminus">-        this.headerValue.childNodes.length &gt;</span>
<a href="#l53.42"></a><span id="l53.42" class="difflineplus">+        this.headerValue.children.length &gt;</span>
<a href="#l53.43"></a><span id="l53.43">         this.mMessageIds.length * 2 - 1</span>
<a href="#l53.44"></a><span id="l53.44">       ) {</span>
<a href="#l53.45"></a><span id="l53.45" class="difflineminus">-        this.headerValue.lastChild.remove();</span>
<a href="#l53.46"></a><span id="l53.46" class="difflineplus">+        this.headerValue.lastElementChild.remove();</span>
<a href="#l53.47"></a><span id="l53.47">       }</span>
<a href="#l53.48"></a><span id="l53.48"> </span>
<a href="#l53.49"></a><span id="l53.49">       this.toggleIcon.hidden = this.mMessageIds.length &lt;= 1;</span>
<a href="#l53.50"></a><span id="l53.50"> </span>
<a href="#l53.51"></a><span id="l53.51">       for (let i = 0; i &lt; this.mMessageIds.length; i++) {</span>
<a href="#l53.52"></a><span id="l53.52" class="difflineminus">-        if (i * 2 &lt;= this.headerValue.childNodes.length - 1) {</span>
<a href="#l53.53"></a><span id="l53.53" class="difflineplus">+        if (i * 2 &lt;= this.headerValue.children.length - 1) {</span>
<a href="#l53.54"></a><span id="l53.54">           this._updateMessageIdNode(</span>
<a href="#l53.55"></a><span id="l53.55" class="difflineminus">-            this.headerValue.childNodes[i * 2],</span>
<a href="#l53.56"></a><span id="l53.56" class="difflineplus">+            this.headerValue.children[i * 2],</span>
<a href="#l53.57"></a><span id="l53.57">             i + 1,</span>
<a href="#l53.58"></a><span id="l53.58">             this.mMessageIds[i],</span>
<a href="#l53.59"></a><span id="l53.59">             this.mMessageIds.length</span>
<a href="#l53.60"></a><span id="l53.60">           );</span>
<a href="#l53.61"></a><span id="l53.61">         } else {</span>
<a href="#l53.62"></a><span id="l53.62">           let newMessageIdNode = document.createXULElement(&quot;mail-messageid&quot;);</span>
<a href="#l53.63"></a><span id="l53.63"> </span>
<a href="#l53.64"></a><span id="l53.64">           if (i &gt; 0) {</span>
<a href="#l53.65"></a><span id="l53.65" class="difflineat">@@ -965,17 +965,17 @@</span>
<a href="#l53.66"></a><span id="l53.66">      * Private method used to create email address nodes for either our short or long view.</span>
<a href="#l53.67"></a><span id="l53.67">      *</span>
<a href="#l53.68"></a><span id="l53.68">      * @param {Boolean} all   If false, show only a few addresses + &quot;more&quot;.</span>
<a href="#l53.69"></a><span id="l53.69">      * @return {Integer}      Number of addresses we have put into the list.</span>
<a href="#l53.70"></a><span id="l53.70">      */</span>
<a href="#l53.71"></a><span id="l53.71">     _fillAddressesNode(all) {</span>
<a href="#l53.72"></a><span id="l53.72">       // try to leverage any cached nodes before creating new ones</span>
<a href="#l53.73"></a><span id="l53.73">       // XXX look for possible perf win using heuristic for the 2nd param instead of hardcoding 1.</span>
<a href="#l53.74"></a><span id="l53.74" class="difflineminus">-      let cached = this.emailAddresses.childNodes.length;</span>
<a href="#l53.75"></a><span id="l53.75" class="difflineplus">+      let cached = this.emailAddresses.children.length;</span>
<a href="#l53.76"></a><span id="l53.76"> </span>
<a href="#l53.77"></a><span id="l53.77">       // XXXdmose one or more of the ancestor nodes could be collapsed, so this hack just undoes that</span>
<a href="#l53.78"></a><span id="l53.78">       // for all ancestors.  We should do better.  Observed causes include the message header pane</span>
<a href="#l53.79"></a><span id="l53.79">       // being collapsed before the first message has been read, as well as (more common), the &lt;row&gt;</span>
<a href="#l53.80"></a><span id="l53.80">       // containing this widget being collapsed because the previously displayed message didn't have</span>
<a href="#l53.81"></a><span id="l53.81">       // this header.</span>
<a href="#l53.82"></a><span id="l53.82">       for (let node = this.emailAddresses; node; node = node.parentNode) {</span>
<a href="#l53.83"></a><span id="l53.83">         node.collapsed = false;</span>
<a href="#l53.84"></a><span id="l53.84" class="difflineat">@@ -993,28 +993,28 @@</span>
<a href="#l53.85"></a><span id="l53.85">         i &lt; this.addresses.length &amp;&amp; (all || curLine &lt; this.maxLinesBeforeMore);</span>
<a href="#l53.86"></a><span id="l53.86">         i++</span>
<a href="#l53.87"></a><span id="l53.87">       ) {</span>
<a href="#l53.88"></a><span id="l53.88">         let newAddressNode;</span>
<a href="#l53.89"></a><span id="l53.89"> </span>
<a href="#l53.90"></a><span id="l53.90">         // First, add a comma as long as this isn't the first address.</span>
<a href="#l53.91"></a><span id="l53.91">         if (i &gt; 0) {</span>
<a href="#l53.92"></a><span id="l53.92">           if (cached-- &gt; 0) {</span>
<a href="#l53.93"></a><span id="l53.93" class="difflineminus">-            this.emailAddresses.childNodes[i * 2 - 1].hidden = false;</span>
<a href="#l53.94"></a><span id="l53.94" class="difflineplus">+            this.emailAddresses.children[i * 2 - 1].hidden = false;</span>
<a href="#l53.95"></a><span id="l53.95">           } else {</span>
<a href="#l53.96"></a><span id="l53.96">             this.appendComma();</span>
<a href="#l53.97"></a><span id="l53.97">             if (this.commaNodeWidth == 0) {</span>
<a href="#l53.98"></a><span id="l53.98" class="difflineminus">-              this.commaNodeWidth = this.emailAddresses.lastChild.clientWidth;</span>
<a href="#l53.99"></a><span id="l53.99" class="difflineplus">+              this.commaNodeWidth = this.emailAddresses.lastElementChild.clientWidth;</span>
<a href="#l53.100"></a><span id="l53.100">             }</span>
<a href="#l53.101"></a><span id="l53.101">           }</span>
<a href="#l53.102"></a><span id="l53.102">         }</span>
<a href="#l53.103"></a><span id="l53.103"> </span>
<a href="#l53.104"></a><span id="l53.104">         // Now add an email address.</span>
<a href="#l53.105"></a><span id="l53.105">         if (cached-- &gt; 0) {</span>
<a href="#l53.106"></a><span id="l53.106" class="difflineminus">-          newAddressNode = this.emailAddresses.childNodes[i * 2];</span>
<a href="#l53.107"></a><span id="l53.107" class="difflineplus">+          newAddressNode = this.emailAddresses.children[i * 2];</span>
<a href="#l53.108"></a><span id="l53.108">           newAddressNode.hidden = false;</span>
<a href="#l53.109"></a><span id="l53.109">         } else {</span>
<a href="#l53.110"></a><span id="l53.110">           newAddressNode = document.createXULElement(&quot;mail-emailaddress&quot;);</span>
<a href="#l53.111"></a><span id="l53.111"> </span>
<a href="#l53.112"></a><span id="l53.112">           // Stash the headerName somewhere that UpdateEmailNodeDetails will be able to find it.</span>
<a href="#l53.113"></a><span id="l53.113">           newAddressNode.setAttribute(&quot;headerName&quot;, this.headerName);</span>
<a href="#l53.114"></a><span id="l53.114"> </span>
<a href="#l53.115"></a><span id="l53.115">           newAddressNode = this.emailAddresses.appendChild(newAddressNode);</span>
<a href="#l53.116"></a><span id="l53.116" class="difflineat">@@ -1043,41 +1043,41 @@</span>
<a href="#l53.117"></a><span id="l53.117">           // also hide it if &lt;30px left after sliding the address (n=1)</span>
<a href="#l53.118"></a><span id="l53.118">           // or if the last address would be truncated without &quot;more&quot;</span>
<a href="#l53.119"></a><span id="l53.119">           if (</span>
<a href="#l53.120"></a><span id="l53.120">             curLine &gt;= this.maxLinesBeforeMore &amp;&amp;</span>
<a href="#l53.121"></a><span id="l53.121">             (this.maxLinesBeforeMore &gt; 1 ||</span>
<a href="#l53.122"></a><span id="l53.122">               (i + 1 == this.addresses.length &amp;&amp; overLineWidth &gt; 30) ||</span>
<a href="#l53.123"></a><span id="l53.123">               newLineWidth - overLineWidth &lt; 30)</span>
<a href="#l53.124"></a><span id="l53.124">           ) {</span>
<a href="#l53.125"></a><span id="l53.125" class="difflineminus">-            this.emailAddresses.lastChild.hidden = true;</span>
<a href="#l53.126"></a><span id="l53.126" class="difflineplus">+            this.emailAddresses.lastElementChild.hidden = true;</span>
<a href="#l53.127"></a><span id="l53.127">             i--;</span>
<a href="#l53.128"></a><span id="l53.128">           }</span>
<a href="#l53.129"></a><span id="l53.129">         }</span>
<a href="#l53.130"></a><span id="l53.130">       }</span>
<a href="#l53.131"></a><span id="l53.131"> </span>
<a href="#l53.132"></a><span id="l53.132">       // Update maxAddressesBeforeMore if we exceed the current cache estimate, but only if we aren't</span>
<a href="#l53.133"></a><span id="l53.133">       // supposed to show all addresses.</span>
<a href="#l53.134"></a><span id="l53.134">       if (!all &amp;&amp; this.maxAddressesBeforeMore &lt; i) {</span>
<a href="#l53.135"></a><span id="l53.135">         this.maxAddressesBeforeMore = i;</span>
<a href="#l53.136"></a><span id="l53.136">       }</span>
<a href="#l53.137"></a><span id="l53.137"> </span>
<a href="#l53.138"></a><span id="l53.138">       // Hide any extra nodes but keep them around for later.</span>
<a href="#l53.139"></a><span id="l53.139" class="difflineminus">-      cached = this.emailAddresses.childNodes.length;</span>
<a href="#l53.140"></a><span id="l53.140" class="difflineplus">+      cached = this.emailAddresses.children.length;</span>
<a href="#l53.141"></a><span id="l53.141">       for (let j = Math.max(i * 2 - 1, 0); j &lt; cached; j++) {</span>
<a href="#l53.142"></a><span id="l53.142" class="difflineminus">-        this.emailAddresses.childNodes[j].hidden = true;</span>
<a href="#l53.143"></a><span id="l53.143" class="difflineplus">+        this.emailAddresses.children[j].hidden = true;</span>
<a href="#l53.144"></a><span id="l53.144">       }</span>
<a href="#l53.145"></a><span id="l53.145"> </span>
<a href="#l53.146"></a><span id="l53.146">       // If we're not required to show all addresses, and there are still addresses remaining, add an</span>
<a href="#l53.147"></a><span id="l53.147">       // (N more) widget.</span>
<a href="#l53.148"></a><span id="l53.148">       if (!all) {</span>
<a href="#l53.149"></a><span id="l53.149">         let remainingAddresses = this.addresses.length - i;</span>
<a href="#l53.150"></a><span id="l53.150">         if (remainingAddresses &gt; 0) {</span>
<a href="#l53.151"></a><span id="l53.151" class="difflineminus">-          if (this.emailAddresses.childNodes.length % 2 == 0) {</span>
<a href="#l53.152"></a><span id="l53.152" class="difflineminus">-            this.emailAddresses.lastChild.hidden = false;</span>
<a href="#l53.153"></a><span id="l53.153" class="difflineplus">+          if (this.emailAddresses.children.length % 2 == 0) {</span>
<a href="#l53.154"></a><span id="l53.154" class="difflineplus">+            this.emailAddresses.lastElementChild.hidden = false;</span>
<a href="#l53.155"></a><span id="l53.155">           } else {</span>
<a href="#l53.156"></a><span id="l53.156">             this.appendComma();</span>
<a href="#l53.157"></a><span id="l53.157">           }</span>
<a href="#l53.158"></a><span id="l53.158"> </span>
<a href="#l53.159"></a><span id="l53.159">           this.addNMore(remainingAddresses);</span>
<a href="#l53.160"></a><span id="l53.160">           this.setNMoreTooltiptext(this.addresses.slice(-remainingAddresses));</span>
<a href="#l53.161"></a><span id="l53.161">         }</span>
<a href="#l53.162"></a><span id="l53.162">       }</span>
<a href="#l53.163"></a><span id="l53.163" class="difflineat">@@ -1173,21 +1173,21 @@</span>
<a href="#l53.164"></a><span id="l53.164">      * Updates the nodes of this field with a call to UpdateExtraAddressProcessing. The parameters are</span>
<a href="#l53.165"></a><span id="l53.165">      * optional fields that can contain extra information to be passed to</span>
<a href="#l53.166"></a><span id="l53.166">      * UpdateExtraAddressProcessing, the implementation of that function should be checked to</span>
<a href="#l53.167"></a><span id="l53.167">      * determine what it requires</span>
<a href="#l53.168"></a><span id="l53.168">      */</span>
<a href="#l53.169"></a><span id="l53.169">     updateExtraAddressProcessing(param1, param2, param3) {</span>
<a href="#l53.170"></a><span id="l53.170">       customElements.upgrade(this);</span>
<a href="#l53.171"></a><span id="l53.171">       if (UpdateExtraAddressProcessing) {</span>
<a href="#l53.172"></a><span id="l53.172" class="difflineminus">-        const childNodes = this.emailAddresses.childNodes;</span>
<a href="#l53.173"></a><span id="l53.173" class="difflineplus">+        const children = this.emailAddresses.children;</span>
<a href="#l53.174"></a><span id="l53.174">         for (let i = 0; i &lt; this.addresses.length; i++) {</span>
<a href="#l53.175"></a><span id="l53.175">           UpdateExtraAddressProcessing(</span>
<a href="#l53.176"></a><span id="l53.176">             this.addresses[i],</span>
<a href="#l53.177"></a><span id="l53.177" class="difflineminus">-            childNodes[i * 2],</span>
<a href="#l53.178"></a><span id="l53.178" class="difflineplus">+            children[i * 2],</span>
<a href="#l53.179"></a><span id="l53.179">             param1,</span>
<a href="#l53.180"></a><span id="l53.180">             param2,</span>
<a href="#l53.181"></a><span id="l53.181">             param3</span>
<a href="#l53.182"></a><span id="l53.182">           );</span>
<a href="#l53.183"></a><span id="l53.183">         }</span>
<a href="#l53.184"></a><span id="l53.184">       }</span>
<a href="#l53.185"></a><span id="l53.185">     }</span>
<a href="#l53.186"></a><span id="l53.186"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.js</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.js</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -148,18 +148,18 @@ function menu_new_init() {</span>
<a href="#l54.4"></a><span id="l54.4">       )</span>
<a href="#l54.5"></a><span id="l54.5">     );</span>
<a href="#l54.6"></a><span id="l54.6">   }</span>
<a href="#l54.7"></a><span id="l54.7"> </span>
<a href="#l54.8"></a><span id="l54.8">   goUpdateCommand(&quot;cmd_newMessage&quot;);</span>
<a href="#l54.9"></a><span id="l54.9"> }</span>
<a href="#l54.10"></a><span id="l54.10"> </span>
<a href="#l54.11"></a><span id="l54.11"> function goUpdateMailMenuItems(commandset) {</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-  for (var i = 0; i &lt; commandset.childNodes.length; i++) {</span>
<a href="#l54.13"></a><span id="l54.13" class="difflineminus">-    var commandID = commandset.childNodes[i].getAttribute(&quot;id&quot;);</span>
<a href="#l54.14"></a><span id="l54.14" class="difflineplus">+  for (var i = 0; i &lt; commandset.children.length; i++) {</span>
<a href="#l54.15"></a><span id="l54.15" class="difflineplus">+    var commandID = commandset.children[i].getAttribute(&quot;id&quot;);</span>
<a href="#l54.16"></a><span id="l54.16">     if (commandID) {</span>
<a href="#l54.17"></a><span id="l54.17">       goUpdateCommand(commandID);</span>
<a href="#l54.18"></a><span id="l54.18">     }</span>
<a href="#l54.19"></a><span id="l54.19">   }</span>
<a href="#l54.20"></a><span id="l54.20"> </span>
<a href="#l54.21"></a><span id="l54.21">   updateCheckedStateForIgnoreAndWatchThreadCmds();</span>
<a href="#l54.22"></a><span id="l54.22"> }</span>
<a href="#l54.23"></a><span id="l54.23"> </span>
<a href="#l54.24"></a><span id="l54.24" class="difflineat">@@ -396,17 +396,17 @@ function InitViewLayoutStyleMenu(event, </span>
<a href="#l54.25"></a><span id="l54.25">   // via bubbling of events.</span>
<a href="#l54.26"></a><span id="l54.26">   event.stopImmediatePropagation();</span>
<a href="#l54.27"></a><span id="l54.27">   let paneConfig = Services.prefs.getIntPref(&quot;mail.pane_config.dynamic&quot;);</span>
<a href="#l54.28"></a><span id="l54.28"> </span>
<a href="#l54.29"></a><span id="l54.29">   let parent = appmenu</span>
<a href="#l54.30"></a><span id="l54.30">     ? event.target.querySelector(&quot;.panel-subview-body&quot;)</span>
<a href="#l54.31"></a><span id="l54.31">     : event.target;</span>
<a href="#l54.32"></a><span id="l54.32"> </span>
<a href="#l54.33"></a><span id="l54.33" class="difflineminus">-  let layoutStyleMenuitem = parent.childNodes[paneConfig];</span>
<a href="#l54.34"></a><span id="l54.34" class="difflineplus">+  let layoutStyleMenuitem = parent.children[paneConfig];</span>
<a href="#l54.35"></a><span id="l54.35">   if (layoutStyleMenuitem) {</span>
<a href="#l54.36"></a><span id="l54.36">     layoutStyleMenuitem.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l54.37"></a><span id="l54.37">   }</span>
<a href="#l54.38"></a><span id="l54.38"> }</span>
<a href="#l54.39"></a><span id="l54.39"> </span>
<a href="#l54.40"></a><span id="l54.40"> /**</span>
<a href="#l54.41"></a><span id="l54.41">  * Initialize (check) appropriate folder mode under the View | Folder menu.</span>
<a href="#l54.42"></a><span id="l54.42">  */</span>
<a href="#l54.43"></a><span id="l54.43" class="difflineat">@@ -734,17 +734,17 @@ function InitMessageMenu() {</span>
<a href="#l54.44"></a><span id="l54.44">   if (winType == &quot;mail:3pane&quot;) {</span>
<a href="#l54.45"></a><span id="l54.45">     document.getElementById(&quot;openMessageWindowMenuitem&quot;).hidden = isFeed;</span>
<a href="#l54.46"></a><span id="l54.46">   }</span>
<a href="#l54.47"></a><span id="l54.47"> </span>
<a href="#l54.48"></a><span id="l54.48">   // Initialize the Open Feed Message handler menu</span>
<a href="#l54.49"></a><span id="l54.49">   let index = FeedMessageHandler.onOpenPref;</span>
<a href="#l54.50"></a><span id="l54.50">   document</span>
<a href="#l54.51"></a><span id="l54.51">     .getElementById(&quot;menu_openFeedMessage&quot;)</span>
<a href="#l54.52"></a><span id="l54.52" class="difflineminus">-    .childNodes[index].setAttribute(&quot;checked&quot;, true);</span>
<a href="#l54.53"></a><span id="l54.53" class="difflineplus">+    .children[index].setAttribute(&quot;checked&quot;, true);</span>
<a href="#l54.54"></a><span id="l54.54"> </span>
<a href="#l54.55"></a><span id="l54.55">   let openRssMenu = document.getElementById(&quot;openFeedMessage&quot;);</span>
<a href="#l54.56"></a><span id="l54.56">   openRssMenu.hidden = !isFeed;</span>
<a href="#l54.57"></a><span id="l54.57">   if (winType != &quot;mail:3pane&quot;) {</span>
<a href="#l54.58"></a><span id="l54.58">     openRssMenu.hidden = true;</span>
<a href="#l54.59"></a><span id="l54.59">   }</span>
<a href="#l54.60"></a><span id="l54.60"> </span>
<a href="#l54.61"></a><span id="l54.61">   // Disable mark menu when we're not in a folder.</span>
<a href="#l54.62"></a><span id="l54.62" class="difflineat">@@ -811,19 +811,19 @@ function InitAppMessageMenu() {</span>
<a href="#l54.63"></a><span id="l54.63">     ).hidden = isFeed;</span>
<a href="#l54.64"></a><span id="l54.64">   }</span>
<a href="#l54.65"></a><span id="l54.65"> </span>
<a href="#l54.66"></a><span id="l54.66">   // Initialize the Open Feed Message handler menu</span>
<a href="#l54.67"></a><span id="l54.67">   const openFeedView = document</span>
<a href="#l54.68"></a><span id="l54.68">     .getElementById(&quot;appMenu-messageOpenFeedView&quot;)</span>
<a href="#l54.69"></a><span id="l54.69">     .querySelector(&quot;.panel-subview-body&quot;);</span>
<a href="#l54.70"></a><span id="l54.70"> </span>
<a href="#l54.71"></a><span id="l54.71" class="difflineminus">-  openFeedView.childNodes.forEach(node =&gt; node.removeAttribute(&quot;checked&quot;));</span>
<a href="#l54.72"></a><span id="l54.72" class="difflineplus">+  openFeedView.children.forEach(node =&gt; node.removeAttribute(&quot;checked&quot;));</span>
<a href="#l54.73"></a><span id="l54.73">   let index = FeedMessageHandler.onOpenPref;</span>
<a href="#l54.74"></a><span id="l54.74" class="difflineminus">-  openFeedView.childNodes[index].setAttribute(&quot;checked&quot;, true);</span>
<a href="#l54.75"></a><span id="l54.75" class="difflineplus">+  openFeedView.children[index].setAttribute(&quot;checked&quot;, true);</span>
<a href="#l54.76"></a><span id="l54.76"> </span>
<a href="#l54.77"></a><span id="l54.77">   let openRssMenu = document.getElementById(&quot;appmenu_openFeedMessage&quot;);</span>
<a href="#l54.78"></a><span id="l54.78">   openRssMenu.hidden = !isFeed;</span>
<a href="#l54.79"></a><span id="l54.79">   if (winType != &quot;mail:3pane&quot;) {</span>
<a href="#l54.80"></a><span id="l54.80">     openRssMenu.hidden = true;</span>
<a href="#l54.81"></a><span id="l54.81">   }</span>
<a href="#l54.82"></a><span id="l54.82"> </span>
<a href="#l54.83"></a><span id="l54.83">   // Disable mark menu when we're not in a folder.</span>
<a href="#l54.84"></a><span id="l54.84" class="difflineat">@@ -1316,25 +1316,31 @@ function SetMessageTagLabel(menuitem, in</span>
<a href="#l54.85"></a><span id="l54.85">  */</span>
<a href="#l54.86"></a><span id="l54.86"> function InitMessageTags(parent, elementName = &quot;menuitem&quot;, classes) {</span>
<a href="#l54.87"></a><span id="l54.87">   const tagArray = MailServices.tags.getAllTags();</span>
<a href="#l54.88"></a><span id="l54.88">   const elementNameUpperCase = elementName.toUpperCase();</span>
<a href="#l54.89"></a><span id="l54.89"> </span>
<a href="#l54.90"></a><span id="l54.90">   // Remove any existing non-static items (clear tags list before rebuilding it).</span>
<a href="#l54.91"></a><span id="l54.91">   // There is a separator element above the dynamically added tag elements, so</span>
<a href="#l54.92"></a><span id="l54.92">   // remove dynamically added elements below the separator.</span>
<a href="#l54.93"></a><span id="l54.93" class="difflineminus">-  while (parent.lastChild.tagName.toUpperCase() == elementNameUpperCase) {</span>
<a href="#l54.94"></a><span id="l54.94" class="difflineplus">+  while (</span>
<a href="#l54.95"></a><span id="l54.95" class="difflineplus">+    parent.lastElementChild.tagName.toUpperCase() == elementNameUpperCase</span>
<a href="#l54.96"></a><span id="l54.96" class="difflineplus">+  ) {</span>
<a href="#l54.97"></a><span id="l54.97">     parent.lastChild.remove();</span>
<a href="#l54.98"></a><span id="l54.98">   }</span>
<a href="#l54.99"></a><span id="l54.99"> </span>
<a href="#l54.100"></a><span id="l54.100">   // Create label and accesskey for the static &quot;remove all tags&quot; item.</span>
<a href="#l54.101"></a><span id="l54.101">   const tagRemoveLabel = document</span>
<a href="#l54.102"></a><span id="l54.102">     .getElementById(&quot;bundle_messenger&quot;)</span>
<a href="#l54.103"></a><span id="l54.103">     .getString(&quot;mailnews.tags.remove&quot;);</span>
<a href="#l54.104"></a><span id="l54.104" class="difflineminus">-  SetMessageTagLabel(parent.lastChild.previousSibling, 0, tagRemoveLabel);</span>
<a href="#l54.105"></a><span id="l54.105" class="difflineplus">+  SetMessageTagLabel(</span>
<a href="#l54.106"></a><span id="l54.106" class="difflineplus">+    parent.lastElementChild.previousElementSibling,</span>
<a href="#l54.107"></a><span id="l54.107" class="difflineplus">+    0,</span>
<a href="#l54.108"></a><span id="l54.108" class="difflineplus">+    tagRemoveLabel</span>
<a href="#l54.109"></a><span id="l54.109" class="difflineplus">+  );</span>
<a href="#l54.110"></a><span id="l54.110"> </span>
<a href="#l54.111"></a><span id="l54.111">   // Rebuild the list.</span>
<a href="#l54.112"></a><span id="l54.112">   const msgHdr = gFolderDisplay.selectedMessage;</span>
<a href="#l54.113"></a><span id="l54.113">   const suffix = msgHdr.label ? &quot; $label&quot; + msgHdr.label : &quot;&quot;;</span>
<a href="#l54.114"></a><span id="l54.114">   const curKeys = msgHdr.getStringProperty(&quot;keywords&quot;) + suffix;</span>
<a href="#l54.115"></a><span id="l54.115"> </span>
<a href="#l54.116"></a><span id="l54.116">   tagArray.forEach((tagInfo, index) =&gt; {</span>
<a href="#l54.117"></a><span id="l54.117">     const removeKey = ` ${curKeys} `.includes(` ${tagInfo.key} `);</span>
<a href="#l54.118"></a><span id="l54.118" class="difflineat">@@ -3288,17 +3294,17 @@ var gMessageNotificationBar = {</span>
<a href="#l54.119"></a><span id="l54.119">       let notification = this.msgNotificationBar.appendNotification(</span>
<a href="#l54.120"></a><span id="l54.120">         remoteContentMsg,</span>
<a href="#l54.121"></a><span id="l54.121">         &quot;remoteContent&quot;,</span>
<a href="#l54.122"></a><span id="l54.122">         &quot;chrome://messenger/skin/icons/remote-blocked.svg&quot;,</span>
<a href="#l54.123"></a><span id="l54.123">         this.msgNotificationBar.PRIORITY_WARNING_MEDIUM,</span>
<a href="#l54.124"></a><span id="l54.124">         aCanOverride ? buttons : []</span>
<a href="#l54.125"></a><span id="l54.125">       );</span>
<a href="#l54.126"></a><span id="l54.126"> </span>
<a href="#l54.127"></a><span id="l54.127" class="difflineminus">-      let button = notification.spacer.nextSibling;</span>
<a href="#l54.128"></a><span id="l54.128" class="difflineplus">+      let button = notification.spacer.nextElementSibling;</span>
<a href="#l54.129"></a><span id="l54.129">       button.classList.add(&quot;button-menu-list&quot;);</span>
<a href="#l54.130"></a><span id="l54.130">     }</span>
<a href="#l54.131"></a><span id="l54.131">   },</span>
<a href="#l54.132"></a><span id="l54.132"> </span>
<a href="#l54.133"></a><span id="l54.133">   isShowingRemoteContentNotification() {</span>
<a href="#l54.134"></a><span id="l54.134">     return !!this.msgNotificationBar.getNotificationWithValue(&quot;remoteContent&quot;);</span>
<a href="#l54.135"></a><span id="l54.135">   },</span>
<a href="#l54.136"></a><span id="l54.136"> </span>
<a href="#l54.137"></a><span id="l54.137" class="difflineat">@@ -3329,17 +3335,17 @@ var gMessageNotificationBar = {</span>
<a href="#l54.138"></a><span id="l54.138">       let notification = this.msgNotificationBar.appendNotification(</span>
<a href="#l54.139"></a><span id="l54.139">         phishingMsgNote,</span>
<a href="#l54.140"></a><span id="l54.140">         &quot;maybeScam&quot;,</span>
<a href="#l54.141"></a><span id="l54.141">         &quot;chrome://messenger/skin/icons/phishing.png&quot;,</span>
<a href="#l54.142"></a><span id="l54.142">         this.msgNotificationBar.PRIORITY_CRITICAL_MEDIUM,</span>
<a href="#l54.143"></a><span id="l54.143">         buttons</span>
<a href="#l54.144"></a><span id="l54.144">       );</span>
<a href="#l54.145"></a><span id="l54.145"> </span>
<a href="#l54.146"></a><span id="l54.146" class="difflineminus">-      let button = notification.spacer.nextSibling;</span>
<a href="#l54.147"></a><span id="l54.147" class="difflineplus">+      let button = notification.spacer.nextElementSibling;</span>
<a href="#l54.148"></a><span id="l54.148">       button.classList.add(&quot;button-menu-list&quot;);</span>
<a href="#l54.149"></a><span id="l54.149">     }</span>
<a href="#l54.150"></a><span id="l54.150">   },</span>
<a href="#l54.151"></a><span id="l54.151"> </span>
<a href="#l54.152"></a><span id="l54.152">   isShowingPhishingNotification() {</span>
<a href="#l54.153"></a><span id="l54.153">     return !!this.msgNotificationBar.getNotificationWithValue(&quot;maybeScam&quot;);</span>
<a href="#l54.154"></a><span id="l54.154">   },</span>
<a href="#l54.155"></a><span id="l54.155"> </span>
<a href="#l54.156"></a><span id="l54.156" class="difflineat">@@ -3476,20 +3482,20 @@ function onRemoteContentOptionsShowing(a</span>
<a href="#l54.157"></a><span id="l54.157">       {}</span>
<a href="#l54.158"></a><span id="l54.158">     );</span>
<a href="#l54.159"></a><span id="l54.159">     origins.push(mailPrincipal.origin);</span>
<a href="#l54.160"></a><span id="l54.160">   }</span>
<a href="#l54.161"></a><span id="l54.161"> </span>
<a href="#l54.162"></a><span id="l54.162">   let messengerBundle = document.getElementById(&quot;bundle_messenger&quot;);</span>
<a href="#l54.163"></a><span id="l54.163"> </span>
<a href="#l54.164"></a><span id="l54.164">   // Out with the old...</span>
<a href="#l54.165"></a><span id="l54.165" class="difflineminus">-  let childNodes = aEvent.target.childNodes;</span>
<a href="#l54.166"></a><span id="l54.166" class="difflineminus">-  for (let i = childNodes.length - 1; i &gt;= 0; i--) {</span>
<a href="#l54.167"></a><span id="l54.167" class="difflineminus">-    if (childNodes[i].getAttribute(&quot;class&quot;) == &quot;allow-remote-uri&quot;) {</span>
<a href="#l54.168"></a><span id="l54.168" class="difflineminus">-      childNodes[i].remove();</span>
<a href="#l54.169"></a><span id="l54.169" class="difflineplus">+  let children = aEvent.target.children;</span>
<a href="#l54.170"></a><span id="l54.170" class="difflineplus">+  for (let i = children.length - 1; i &gt;= 0; i--) {</span>
<a href="#l54.171"></a><span id="l54.171" class="difflineplus">+    if (children[i].getAttribute(&quot;class&quot;) == &quot;allow-remote-uri&quot;) {</span>
<a href="#l54.172"></a><span id="l54.172" class="difflineplus">+      children[i].remove();</span>
<a href="#l54.173"></a><span id="l54.173">     }</span>
<a href="#l54.174"></a><span id="l54.174">   }</span>
<a href="#l54.175"></a><span id="l54.175"> </span>
<a href="#l54.176"></a><span id="l54.176">   let urlSepar = document.getElementById(&quot;remoteContentAllMenuSeparator&quot;);</span>
<a href="#l54.177"></a><span id="l54.177"> </span>
<a href="#l54.178"></a><span id="l54.178">   // ... and in with the new.</span>
<a href="#l54.179"></a><span id="l54.179">   for (let origin of origins) {</span>
<a href="#l54.180"></a><span id="l54.180">     let menuitem = document.createXULElement(&quot;menuitem&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/mail/base/content/msgHdrView.js</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/mail/base/content/msgHdrView.js</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -2969,18 +2969,18 @@ function FillAttachmentListPopup(aEvent,</span>
<a href="#l55.4"></a><span id="l55.4">   }</span>
<a href="#l55.5"></a><span id="l55.5"> </span>
<a href="#l55.6"></a><span id="l55.6">   goUpdateAttachmentCommands();</span>
<a href="#l55.7"></a><span id="l55.7"> }</span>
<a href="#l55.8"></a><span id="l55.8"> </span>
<a href="#l55.9"></a><span id="l55.9"> // Public method used to clear the file attachment menu</span>
<a href="#l55.10"></a><span id="l55.10"> function ClearAttachmentMenu(popup) {</span>
<a href="#l55.11"></a><span id="l55.11">   if (popup) {</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-    while (popup.firstChild.localName == &quot;menu&quot;) {</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineminus">-      popup.firstChild.remove();</span>
<a href="#l55.14"></a><span id="l55.14" class="difflineplus">+    while (popup.firstElementChild.localName == &quot;menu&quot;) {</span>
<a href="#l55.15"></a><span id="l55.15" class="difflineplus">+      popup.firstElementChild.remove();</span>
<a href="#l55.16"></a><span id="l55.16">     }</span>
<a href="#l55.17"></a><span id="l55.17">   }</span>
<a href="#l55.18"></a><span id="l55.18"> }</span>
<a href="#l55.19"></a><span id="l55.19"> </span>
<a href="#l55.20"></a><span id="l55.20"> /**</span>
<a href="#l55.21"></a><span id="l55.21">  * Create a menu for a single attachment.</span>
<a href="#l55.22"></a><span id="l55.22">  *</span>
<a href="#l55.23"></a><span id="l55.23">  * @param popup  the popup to add the menu to</span>
<a href="#l55.24"></a><span id="l55.24" class="difflineat">@@ -3003,17 +3003,17 @@ function addAttachmentToPopup(popup, att</span>
<a href="#l55.25"></a><span id="l55.25"> </span>
<a href="#l55.26"></a><span id="l55.26">   // Insert the item just before the separator. The separator is the 2nd to</span>
<a href="#l55.27"></a><span id="l55.27">   // last element in the popup.</span>
<a href="#l55.28"></a><span id="l55.28">   item.setAttribute(&quot;class&quot;, &quot;menu-iconic&quot;);</span>
<a href="#l55.29"></a><span id="l55.29">   item.setAttribute(&quot;image&quot;, getIconForAttachment(attachment));</span>
<a href="#l55.30"></a><span id="l55.30"> </span>
<a href="#l55.31"></a><span id="l55.31">   // find the separator</span>
<a href="#l55.32"></a><span id="l55.32">   var indexOfSeparator = 0;</span>
<a href="#l55.33"></a><span id="l55.33" class="difflineminus">-  while (popup.childNodes[indexOfSeparator].localName != &quot;menuseparator&quot;) {</span>
<a href="#l55.34"></a><span id="l55.34" class="difflineplus">+  while (popup.children[indexOfSeparator].localName != &quot;menuseparator&quot;) {</span>
<a href="#l55.35"></a><span id="l55.35">     indexOfSeparator++;</span>
<a href="#l55.36"></a><span id="l55.36">   }</span>
<a href="#l55.37"></a><span id="l55.37">   // We increment the attachmentIndex here since we only use it for the</span>
<a href="#l55.38"></a><span id="l55.38">   // label and accesskey attributes, and we want the accesskeys for the</span>
<a href="#l55.39"></a><span id="l55.39">   // attachments list in the menu to be 1-indexed.</span>
<a href="#l55.40"></a><span id="l55.40">   attachmentIndex++;</span>
<a href="#l55.41"></a><span id="l55.41">   var displayName = SanitizeAttachmentDisplayName(attachment);</span>
<a href="#l55.42"></a><span id="l55.42">   var label = document</span>
<a href="#l55.43"></a><span id="l55.43" class="difflineat">@@ -3032,17 +3032,17 @@ function addAttachmentToPopup(popup, att</span>
<a href="#l55.44"></a><span id="l55.44">   openpopup = item.appendChild(openpopup);</span>
<a href="#l55.45"></a><span id="l55.45">   openpopup.addEventListener(&quot;popupshowing&quot;, function(aEvent) {</span>
<a href="#l55.46"></a><span id="l55.46">     aEvent.stopPropagation();</span>
<a href="#l55.47"></a><span id="l55.47">   });</span>
<a href="#l55.48"></a><span id="l55.48"> </span>
<a href="#l55.49"></a><span id="l55.49">   // Due to Bug #314228, we must append our menupopup to the new attachment</span>
<a href="#l55.50"></a><span id="l55.50">   // menu item before we inserting the attachment menu into the popup. If we</span>
<a href="#l55.51"></a><span id="l55.51">   // don't, our attachment menu items will not show up.</span>
<a href="#l55.52"></a><span id="l55.52" class="difflineminus">-  item = popup.insertBefore(item, popup.childNodes[indexOfSeparator]);</span>
<a href="#l55.53"></a><span id="l55.53" class="difflineplus">+  item = popup.insertBefore(item, popup.children[indexOfSeparator]);</span>
<a href="#l55.54"></a><span id="l55.54"> </span>
<a href="#l55.55"></a><span id="l55.55">   if (attachment.isExternalAttachment) {</span>
<a href="#l55.56"></a><span id="l55.56">     if (!attachment.hasFile) {</span>
<a href="#l55.57"></a><span id="l55.57">       item.classList.add(&quot;notfound&quot;);</span>
<a href="#l55.58"></a><span id="l55.58">     } else {</span>
<a href="#l55.59"></a><span id="l55.59">       // The text-link class must be added to the &lt;label&gt; and have a &lt;menu&gt;</span>
<a href="#l55.60"></a><span id="l55.60">       // hover rule. Adding to &lt;menu&gt; makes hover overflow the underline to</span>
<a href="#l55.61"></a><span id="l55.61">       // the popup items.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -351,17 +351,17 @@ function UpdateMailPaneConfig(aMsgWindow</span>
<a href="#l56.4"></a><span id="l56.4">     }</span>
<a href="#l56.5"></a><span id="l56.5"> </span>
<a href="#l56.6"></a><span id="l56.6">     // See Bug 381992. The ctor for the browser element will fire again when we</span>
<a href="#l56.7"></a><span id="l56.7">     // re-insert the messagePaneBoxWrapper back into the document.  But the dtor</span>
<a href="#l56.8"></a><span id="l56.8">     // doesn't fire when the element is removed from the document.  Manually</span>
<a href="#l56.9"></a><span id="l56.9">     // call destroy here to avoid a nasty leak.</span>
<a href="#l56.10"></a><span id="l56.10">     document.getElementById(&quot;messagepane&quot;).destroy();</span>
<a href="#l56.11"></a><span id="l56.11">     document.getElementById(&quot;FindToolbar&quot;).destroy();</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-    let footerBox = desiredParent.lastChild;</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineplus">+    let footerBox = desiredParent.lastElementChild;</span>
<a href="#l56.14"></a><span id="l56.14">     if (footerBox &amp;&amp; footerBox.id == &quot;messenger-notification-footer&quot;) {</span>
<a href="#l56.15"></a><span id="l56.15">       desiredParent.insertBefore(messagePaneSplitter, footerBox);</span>
<a href="#l56.16"></a><span id="l56.16">       desiredParent.insertBefore(messagePaneBoxWrapper, footerBox);</span>
<a href="#l56.17"></a><span id="l56.17">     } else {</span>
<a href="#l56.18"></a><span id="l56.18">       desiredParent.appendChild(messagePaneSplitter);</span>
<a href="#l56.19"></a><span id="l56.19">       desiredParent.appendChild(messagePaneBoxWrapper);</span>
<a href="#l56.20"></a><span id="l56.20">     }</span>
<a href="#l56.21"></a><span id="l56.21">     hdrToolbox.palette = cloneToolboxPalette;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/mail/base/content/nsContextMenu.js</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/mail/base/content/nsContextMenu.js</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -1093,45 +1093,45 @@ nsContextMenu.prototype = {</span>
<a href="#l57.4"></a><span id="l57.4">    * there are any non-hidden items between it and the previous separator.</span>
<a href="#l57.5"></a><span id="l57.5">    * @param  aSeparatorID</span>
<a href="#l57.6"></a><span id="l57.6">    *         The id of the separator element</span>
<a href="#l57.7"></a><span id="l57.7">    * @return true if the separator should be shown, false if not</span>
<a href="#l57.8"></a><span id="l57.8">    */</span>
<a href="#l57.9"></a><span id="l57.9">   shouldShowSeparator(aSeparatorID) {</span>
<a href="#l57.10"></a><span id="l57.10">     var separator = document.getElementById(aSeparatorID);</span>
<a href="#l57.11"></a><span id="l57.11">     if (separator) {</span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-      var sibling = separator.previousSibling;</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineplus">+      var sibling = separator.previousElementSibling;</span>
<a href="#l57.14"></a><span id="l57.14">       while (sibling &amp;&amp; sibling.localName != &quot;menuseparator&quot;) {</span>
<a href="#l57.15"></a><span id="l57.15">         if (sibling.getAttribute(&quot;hidden&quot;) != &quot;true&quot;) {</span>
<a href="#l57.16"></a><span id="l57.16">           return true;</span>
<a href="#l57.17"></a><span id="l57.17">         }</span>
<a href="#l57.18"></a><span id="l57.18" class="difflineminus">-        sibling = sibling.previousSibling;</span>
<a href="#l57.19"></a><span id="l57.19" class="difflineplus">+        sibling = sibling.previousElementSibling;</span>
<a href="#l57.20"></a><span id="l57.20">       }</span>
<a href="#l57.21"></a><span id="l57.21">     }</span>
<a href="#l57.22"></a><span id="l57.22">     return false;</span>
<a href="#l57.23"></a><span id="l57.23">   },</span>
<a href="#l57.24"></a><span id="l57.24"> </span>
<a href="#l57.25"></a><span id="l57.25">   /**</span>
<a href="#l57.26"></a><span id="l57.26">    * Ensures that there isn't a separator shown at the bottom of the menu.</span>
<a href="#l57.27"></a><span id="l57.27">    *</span>
<a href="#l57.28"></a><span id="l57.28">    * @param aPopup  The menu to check.</span>
<a href="#l57.29"></a><span id="l57.29">    */</span>
<a href="#l57.30"></a><span id="l57.30">   checkLastSeparator(aPopup) {</span>
<a href="#l57.31"></a><span id="l57.31" class="difflineminus">-    let sibling = aPopup.lastChild;</span>
<a href="#l57.32"></a><span id="l57.32" class="difflineplus">+    let sibling = aPopup.lastElementChild;</span>
<a href="#l57.33"></a><span id="l57.33">     while (sibling) {</span>
<a href="#l57.34"></a><span id="l57.34">       if (sibling.getAttribute(&quot;hidden&quot;) != &quot;true&quot;) {</span>
<a href="#l57.35"></a><span id="l57.35">         if (sibling.localName == &quot;menuseparator&quot;) {</span>
<a href="#l57.36"></a><span id="l57.36">           // If we got here then the item is a menuseparator and everything</span>
<a href="#l57.37"></a><span id="l57.37">           // below it hidden.</span>
<a href="#l57.38"></a><span id="l57.38">           sibling.setAttribute(&quot;hidden&quot;, true);</span>
<a href="#l57.39"></a><span id="l57.39">           return;</span>
<a href="#l57.40"></a><span id="l57.40">         }</span>
<a href="#l57.41"></a><span id="l57.41">         return;</span>
<a href="#l57.42"></a><span id="l57.42">       }</span>
<a href="#l57.43"></a><span id="l57.43" class="difflineminus">-      sibling = sibling.previousSibling;</span>
<a href="#l57.44"></a><span id="l57.44" class="difflineplus">+      sibling = sibling.previousElementSibling;</span>
<a href="#l57.45"></a><span id="l57.45">     }</span>
<a href="#l57.46"></a><span id="l57.46">   },</span>
<a href="#l57.47"></a><span id="l57.47"> </span>
<a href="#l57.48"></a><span id="l57.48">   openInBrowser() {</span>
<a href="#l57.49"></a><span id="l57.49">     let url = this.target.ownerGlobal.top.location.href;</span>
<a href="#l57.50"></a><span id="l57.50">     PlacesUtils.history</span>
<a href="#l57.51"></a><span id="l57.51">       .insert({</span>
<a href="#l57.52"></a><span id="l57.52">         url,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/mail/base/content/protovis-r2.6-modded.js</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/mail/base/content/protovis-r2.6-modded.js</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -2939,17 +2939,17 @@ pv.Image.prototype.updateInstance = func</span>
<a href="#l58.4"></a><span id="l58.4">       delete v.$title;</span>
<a href="#l58.5"></a><span id="l58.5">     }</span>
<a href="#l58.6"></a><span id="l58.6"> </span>
<a href="#l58.7"></a><span id="l58.7">     /* Create the stroke svg:rect element, if necessary. */</span>
<a href="#l58.8"></a><span id="l58.8">     if (!f) {</span>
<a href="#l58.9"></a><span id="l58.9">       f = v.$stroke = document.createElementNS(pv.ns.svg, &quot;rect&quot;);</span>
<a href="#l58.10"></a><span id="l58.10">       f.setAttribute(&quot;fill&quot;, &quot;none&quot;);</span>
<a href="#l58.11"></a><span id="l58.11">       f.setAttribute(&quot;pointer-events&quot;, &quot;all&quot;);</span>
<a href="#l58.12"></a><span id="l58.12" class="difflineminus">-      v.parentNode.insertBefore(f, v.nextSibling);</span>
<a href="#l58.13"></a><span id="l58.13" class="difflineplus">+      v.parentNode.insertBefore(f, v.nextElementSibling);</span>
<a href="#l58.14"></a><span id="l58.14">     }</span>
<a href="#l58.15"></a><span id="l58.15">     position(f);</span>
<a href="#l58.16"></a><span id="l58.16">     var stroke = pv.color(s.strokeStyle);</span>
<a href="#l58.17"></a><span id="l58.17">     f.setAttribute(&quot;stroke&quot;, stroke.color);</span>
<a href="#l58.18"></a><span id="l58.18">     f.setAttribute(&quot;stroke-opacity&quot;, stroke.opacity);</span>
<a href="#l58.19"></a><span id="l58.19">     f.setAttribute(&quot;stroke-width&quot;, s.lineWidth);</span>
<a href="#l58.20"></a><span id="l58.20"> </span>
<a href="#l58.21"></a><span id="l58.21">     /* cursor, title, events, etc. */</span>
<a href="#l58.22"></a><span id="l58.22" class="difflineat">@@ -3469,18 +3469,18 @@ pv.Panel.prototype.createCanvas = functi</span>
<a href="#l58.23"></a><span id="l58.23"> </span>
<a href="#l58.24"></a><span id="l58.24">   /**</span>
<a href="#l58.25"></a><span id="l58.25">    * Returns the last element in the current document's body. The canvas element</span>
<a href="#l58.26"></a><span id="l58.26">    * is appended to this last element if another DOM element has not already</span>
<a href="#l58.27"></a><span id="l58.27">    * been specified via the &lt;tt&gt;$dom&lt;/tt&gt; field.</span>
<a href="#l58.28"></a><span id="l58.28">    */</span>
<a href="#l58.29"></a><span id="l58.29">   function lastElement() {</span>
<a href="#l58.30"></a><span id="l58.30">     var node = document.body;</span>
<a href="#l58.31"></a><span id="l58.31" class="difflineminus">-    while (node.lastChild &amp;&amp; node.lastChild.tagName) {</span>
<a href="#l58.32"></a><span id="l58.32" class="difflineminus">-      node = node.lastChild;</span>
<a href="#l58.33"></a><span id="l58.33" class="difflineplus">+    while (node.lastElementChild &amp;&amp; node.lastElementChild.tagName) {</span>
<a href="#l58.34"></a><span id="l58.34" class="difflineplus">+      node = node.lastElementChild;</span>
<a href="#l58.35"></a><span id="l58.35">     }</span>
<a href="#l58.36"></a><span id="l58.36">     return (node == document.body) ? node : node.parentNode;</span>
<a href="#l58.37"></a><span id="l58.37">   }</span>
<a href="#l58.38"></a><span id="l58.38"> </span>
<a href="#l58.39"></a><span id="l58.39">   /* Create the SVG element. */</span>
<a href="#l58.40"></a><span id="l58.40">   var c = document.createElementNS(pv.ns.svg, &quot;svg&quot;);</span>
<a href="#l58.41"></a><span id="l58.41">   c.setAttribute(&quot;width&quot;, w);</span>
<a href="#l58.42"></a><span id="l58.42">   c.setAttribute(&quot;height&quot;, h);</span>
<a href="#l58.43"></a><span id="l58.43" class="difflineat">@@ -3561,18 +3561,19 @@ pv.Panel.prototype.buildImplied = functi</span>
<a href="#l58.44"></a><span id="l58.44">     var c = s.canvas;</span>
<a href="#l58.45"></a><span id="l58.45">     if (c) {</span>
<a href="#l58.46"></a><span id="l58.46">       var d = (typeof c == &quot;string&quot;) ? document.getElementById(c) : c;</span>
<a href="#l58.47"></a><span id="l58.47"> </span>
<a href="#l58.48"></a><span id="l58.48">       /* Clear the container if it's not already associated with this panel. */</span>
<a href="#l58.49"></a><span id="l58.49">       if (!d.$panel || d.$panel != this) {</span>
<a href="#l58.50"></a><span id="l58.50">         d.$panel = this;</span>
<a href="#l58.51"></a><span id="l58.51">         delete d.$canvas;</span>
<a href="#l58.52"></a><span id="l58.52" class="difflineminus">-        while (d.lastChild)</span>
<a href="#l58.53"></a><span id="l58.53" class="difflineminus">-          d.removeChild(d.lastChild);</span>
<a href="#l58.54"></a><span id="l58.54" class="difflineplus">+        while (d.lastChild) {</span>
<a href="#l58.55"></a><span id="l58.55" class="difflineplus">+          d.lastChild.remove();</span>
<a href="#l58.56"></a><span id="l58.56" class="difflineplus">+        }</span>
<a href="#l58.57"></a><span id="l58.57">       }</span>
<a href="#l58.58"></a><span id="l58.58"> </span>
<a href="#l58.59"></a><span id="l58.59">       /* Construct the canvas if not already present. */</span>
<a href="#l58.60"></a><span id="l58.60">       if (!(c = d.$canvas)) {</span>
<a href="#l58.61"></a><span id="l58.61">         d.$canvas = c = document.createElementNS(pv.ns.svg, &quot;svg&quot;);</span>
<a href="#l58.62"></a><span id="l58.62">         d.appendChild(c);</span>
<a href="#l58.63"></a><span id="l58.63">       }</span>
<a href="#l58.64"></a><span id="l58.64"> </span>
<a href="#l58.65"></a><span id="l58.65" class="difflineat">@@ -3681,17 +3682,17 @@ pv.Panel.prototype.updateInstance = func</span>
<a href="#l58.66"></a><span id="l58.66">   }</span>
<a href="#l58.67"></a><span id="l58.67">   v.removeAttribute(&quot;display&quot;);</span>
<a href="#l58.68"></a><span id="l58.68"> </span>
<a href="#l58.69"></a><span id="l58.69">   /* fillStyle, strokeStyle */</span>
<a href="#l58.70"></a><span id="l58.70">   var r = v.$rect;</span>
<a href="#l58.71"></a><span id="l58.71">   if (s.fillStyle || s.strokeStyle) {</span>
<a href="#l58.72"></a><span id="l58.72">     if (!r) {</span>
<a href="#l58.73"></a><span id="l58.73">       r = v.$rect = document.createElementNS(pv.ns.svg, &quot;rect&quot;);</span>
<a href="#l58.74"></a><span id="l58.74" class="difflineminus">-      v.insertBefore(r, v.firstChild);</span>
<a href="#l58.75"></a><span id="l58.75" class="difflineplus">+      v.insertBefore(r, v.firstElementChild);</span>
<a href="#l58.76"></a><span id="l58.76">     }</span>
<a href="#l58.77"></a><span id="l58.77"> </span>
<a href="#l58.78"></a><span id="l58.78">     /* If width and height are exactly zero, the rect is not stroked! */</span>
<a href="#l58.79"></a><span id="l58.79">     r.setAttribute(&quot;width&quot;, Math.max(1E-10, s.width));</span>
<a href="#l58.80"></a><span id="l58.80">     r.setAttribute(&quot;height&quot;, Math.max(1E-10, s.height));</span>
<a href="#l58.81"></a><span id="l58.81"> </span>
<a href="#l58.82"></a><span id="l58.82">     /* fill, stroke TODO gradient, patterns */</span>
<a href="#l58.83"></a><span id="l58.83">     var fill = pv.color(s.fillStyle);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/mail/base/content/specialTabs.js</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/mail/base/content/specialTabs.js</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -827,34 +827,34 @@ var specialTabs = {</span>
<a href="#l59.4"></a><span id="l59.4">     openTab(aTab, aArgs) {</span>
<a href="#l59.5"></a><span id="l59.5">       if (!(&quot;contentPage&quot; in aArgs)) {</span>
<a href="#l59.6"></a><span id="l59.6">         throw new Error(&quot;contentPage must be specified&quot;);</span>
<a href="#l59.7"></a><span id="l59.7">       }</span>
<a href="#l59.8"></a><span id="l59.8"> </span>
<a href="#l59.9"></a><span id="l59.9">       // First clone the page and set up the basics.</span>
<a href="#l59.10"></a><span id="l59.10">       let clone = document</span>
<a href="#l59.11"></a><span id="l59.11">         .getElementById(&quot;contentTab&quot;)</span>
<a href="#l59.12"></a><span id="l59.12" class="difflineminus">-        .firstChild.cloneNode(true);</span>
<a href="#l59.13"></a><span id="l59.13" class="difflineplus">+        .firstElementChild.cloneNode(true);</span>
<a href="#l59.14"></a><span id="l59.14"> </span>
<a href="#l59.15"></a><span id="l59.15">       if (&quot;opener&quot; in aArgs &amp;&amp; aArgs.opener) {</span>
<a href="#l59.16"></a><span id="l59.16">         clone.querySelector(&quot;browser&quot;).presetOpenerWindow(aArgs.opener);</span>
<a href="#l59.17"></a><span id="l59.17">       }</span>
<a href="#l59.18"></a><span id="l59.18"> </span>
<a href="#l59.19"></a><span id="l59.19">       const findbar = document.createXULElement(&quot;findbar&quot;);</span>
<a href="#l59.20"></a><span id="l59.20">       // Adding browserid to findbar so that browser property can be set</span>
<a href="#l59.21"></a><span id="l59.21">       // in findbar custom element.</span>
<a href="#l59.22"></a><span id="l59.22">       findbar.setAttribute(&quot;browserid&quot;, &quot;dummycontentbrowser&quot;);</span>
<a href="#l59.23"></a><span id="l59.23">       clone.appendChild(findbar);</span>
<a href="#l59.24"></a><span id="l59.24"> </span>
<a href="#l59.25"></a><span id="l59.25">       clone.setAttribute(&quot;id&quot;, &quot;contentTab&quot; + this.lastBrowserId);</span>
<a href="#l59.26"></a><span id="l59.26">       clone.setAttribute(&quot;collapsed&quot;, false);</span>
<a href="#l59.27"></a><span id="l59.27"> </span>
<a href="#l59.28"></a><span id="l59.28" class="difflineminus">-      let toolbox = clone.firstChild;</span>
<a href="#l59.29"></a><span id="l59.29" class="difflineplus">+      let toolbox = clone.firstElementChild;</span>
<a href="#l59.30"></a><span id="l59.30">       toolbox.setAttribute(&quot;id&quot;, &quot;contentTabToolbox&quot; + this.lastBrowserId);</span>
<a href="#l59.31"></a><span id="l59.31" class="difflineminus">-      toolbox.firstChild.setAttribute(</span>
<a href="#l59.32"></a><span id="l59.32" class="difflineplus">+      toolbox.firstElementChild.setAttribute(</span>
<a href="#l59.33"></a><span id="l59.33">         &quot;id&quot;,</span>
<a href="#l59.34"></a><span id="l59.34">         &quot;contentTabToolbar&quot; + this.lastBrowserId</span>
<a href="#l59.35"></a><span id="l59.35">       );</span>
<a href="#l59.36"></a><span id="l59.36"> </span>
<a href="#l59.37"></a><span id="l59.37">       aTab.panel.setAttribute(&quot;id&quot;, &quot;contentTabWrapper&quot; + this.lastBrowserId);</span>
<a href="#l59.38"></a><span id="l59.38">       aTab.panel.appendChild(clone);</span>
<a href="#l59.39"></a><span id="l59.39">       aTab.root = clone;</span>
<a href="#l59.40"></a><span id="l59.40"> </span>
<a href="#l59.41"></a><span id="l59.41" class="difflineat">@@ -1382,24 +1382,24 @@ var specialTabs = {</span>
<a href="#l59.42"></a><span id="l59.42">     openTab(aTab, aArgs) {</span>
<a href="#l59.43"></a><span id="l59.43">       if (!(&quot;chromePage&quot; in aArgs)) {</span>
<a href="#l59.44"></a><span id="l59.44">         throw new Error(&quot;chromePage must be specified&quot;);</span>
<a href="#l59.45"></a><span id="l59.45">       }</span>
<a href="#l59.46"></a><span id="l59.46"> </span>
<a href="#l59.47"></a><span id="l59.47">       // First clone the page and set up the basics.</span>
<a href="#l59.48"></a><span id="l59.48">       let clone = document</span>
<a href="#l59.49"></a><span id="l59.49">         .getElementById(&quot;chromeTab&quot;)</span>
<a href="#l59.50"></a><span id="l59.50" class="difflineminus">-        .firstChild.cloneNode(true);</span>
<a href="#l59.51"></a><span id="l59.51" class="difflineplus">+        .firstElementChild.cloneNode(true);</span>
<a href="#l59.52"></a><span id="l59.52"> </span>
<a href="#l59.53"></a><span id="l59.53">       clone.setAttribute(&quot;id&quot;, &quot;chromeTab&quot; + this.lastBrowserId);</span>
<a href="#l59.54"></a><span id="l59.54">       clone.setAttribute(&quot;collapsed&quot;, false);</span>
<a href="#l59.55"></a><span id="l59.55"> </span>
<a href="#l59.56"></a><span id="l59.56" class="difflineminus">-      let toolbox = clone.firstChild;</span>
<a href="#l59.57"></a><span id="l59.57" class="difflineplus">+      let toolbox = clone.firstElementChild;</span>
<a href="#l59.58"></a><span id="l59.58">       toolbox.setAttribute(&quot;id&quot;, &quot;chromeTabToolbox&quot; + this.lastBrowserId);</span>
<a href="#l59.59"></a><span id="l59.59" class="difflineminus">-      toolbox.firstChild.setAttribute(</span>
<a href="#l59.60"></a><span id="l59.60" class="difflineplus">+      toolbox.firstElementChild.setAttribute(</span>
<a href="#l59.61"></a><span id="l59.61">         &quot;id&quot;,</span>
<a href="#l59.62"></a><span id="l59.62">         &quot;chromeTabToolbar&quot; + this.lastBrowserId</span>
<a href="#l59.63"></a><span id="l59.63">       );</span>
<a href="#l59.64"></a><span id="l59.64"> </span>
<a href="#l59.65"></a><span id="l59.65">       aTab.panel.setAttribute(&quot;id&quot;, &quot;chromeTabWrapper&quot; + this.lastBrowserId);</span>
<a href="#l59.66"></a><span id="l59.66">       aTab.panel.appendChild(clone);</span>
<a href="#l59.67"></a><span id="l59.67"> </span>
<a href="#l59.68"></a><span id="l59.68">       // Start setting up the browser.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1" class="difflineminus">--- a/mail/base/content/tabmail-tabs.js</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineplus">+++ b/mail/base/content/tabmail-tabs.js</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineat">@@ -116,18 +116,18 @@</span>
<a href="#l60.4"></a><span id="l60.4">             false,</span>
<a href="#l60.5"></a><span id="l60.5">             false,</span>
<a href="#l60.6"></a><span id="l60.6">             false,</span>
<a href="#l60.7"></a><span id="l60.7">             0,</span>
<a href="#l60.8"></a><span id="l60.8">             null,</span>
<a href="#l60.9"></a><span id="l60.9">             event.dataTransfer</span>
<a href="#l60.10"></a><span id="l60.10">           );</span>
<a href="#l60.11"></a><span id="l60.11"> </span>
<a href="#l60.12"></a><span id="l60.12" class="difflineminus">-          if (this.mToolbar.firstChild) {</span>
<a href="#l60.13"></a><span id="l60.13" class="difflineminus">-            this.mToolbar.firstChild.dispatchEvent(evt);</span>
<a href="#l60.14"></a><span id="l60.14" class="difflineplus">+          if (this.mToolbar.firstElementChild) {</span>
<a href="#l60.15"></a><span id="l60.15" class="difflineplus">+            this.mToolbar.firstElementChild.dispatchEvent(evt);</span>
<a href="#l60.16"></a><span id="l60.16">           } else {</span>
<a href="#l60.17"></a><span id="l60.17">             this.mToolbar.dispatchEvent(evt);</span>
<a href="#l60.18"></a><span id="l60.18">           }</span>
<a href="#l60.19"></a><span id="l60.19"> </span>
<a href="#l60.20"></a><span id="l60.20">           return;</span>
<a href="#l60.21"></a><span id="l60.21">         }</span>
<a href="#l60.22"></a><span id="l60.22"> </span>
<a href="#l60.23"></a><span id="l60.23">         // Bug 516247:</span>
<a href="#l60.24"></a><span id="l60.24" class="difflineat">@@ -301,18 +301,18 @@</span>
<a href="#l60.25"></a><span id="l60.25">             false,</span>
<a href="#l60.26"></a><span id="l60.26">             false,</span>
<a href="#l60.27"></a><span id="l60.27">             false,</span>
<a href="#l60.28"></a><span id="l60.28">             0,</span>
<a href="#l60.29"></a><span id="l60.29">             null,</span>
<a href="#l60.30"></a><span id="l60.30">             event.dataTransfer</span>
<a href="#l60.31"></a><span id="l60.31">           );</span>
<a href="#l60.32"></a><span id="l60.32"> </span>
<a href="#l60.33"></a><span id="l60.33" class="difflineminus">-          if (this.mToolbar.firstChild) {</span>
<a href="#l60.34"></a><span id="l60.34" class="difflineminus">-            this.mToolbar.firstChild.dispatchEvent(evt);</span>
<a href="#l60.35"></a><span id="l60.35" class="difflineplus">+          if (this.mToolbar.firstElementChild) {</span>
<a href="#l60.36"></a><span id="l60.36" class="difflineplus">+            this.mToolbar.firstElementChild.dispatchEvent(evt);</span>
<a href="#l60.37"></a><span id="l60.37">           } else {</span>
<a href="#l60.38"></a><span id="l60.38">             this.mToolbar.dispatchEvent(evt);</span>
<a href="#l60.39"></a><span id="l60.39">           }</span>
<a href="#l60.40"></a><span id="l60.40"> </span>
<a href="#l60.41"></a><span id="l60.41">           return;</span>
<a href="#l60.42"></a><span id="l60.42">         }</span>
<a href="#l60.43"></a><span id="l60.43"> </span>
<a href="#l60.44"></a><span id="l60.44">         let draggedTab = dt.mozGetDataAt(&quot;application/x-moz-tabmail-tab&quot;, 0);</span>
<a href="#l60.45"></a><span id="l60.45" class="difflineat">@@ -626,18 +626,18 @@</span>
<a href="#l60.46"></a><span id="l60.46">       this.mTabClipWidth = Services.prefs.getIntPref(&quot;mail.tabs.tabClipWidth&quot;);</span>
<a href="#l60.47"></a><span id="l60.47">       this.mCloseButtons = Services.prefs.getIntPref(&quot;mail.tabs.closeButtons&quot;);</span>
<a href="#l60.48"></a><span id="l60.48">       this.mAutoHide = Services.prefs.getBoolPref(&quot;mail.tabs.autoHide&quot;);</span>
<a href="#l60.49"></a><span id="l60.49"> </span>
<a href="#l60.50"></a><span id="l60.50">       if (this.mAutoHide) {</span>
<a href="#l60.51"></a><span id="l60.51">         this.mCollapseToolbar.collapsed = true;</span>
<a href="#l60.52"></a><span id="l60.52">       }</span>
<a href="#l60.53"></a><span id="l60.53"> </span>
<a href="#l60.54"></a><span id="l60.54" class="difflineminus">-      this.arrowScrollbox.firstChild.minWidth = this.mTabMinWidth;</span>
<a href="#l60.55"></a><span id="l60.55" class="difflineminus">-      this.arrowScrollbox.firstChild.maxWidth = this.mTabMaxWidth;</span>
<a href="#l60.56"></a><span id="l60.56" class="difflineplus">+      this.arrowScrollbox.firstElementChild.minWidth = this.mTabMinWidth;</span>
<a href="#l60.57"></a><span id="l60.57" class="difflineplus">+      this.arrowScrollbox.firstElementChild.maxWidth = this.mTabMaxWidth;</span>
<a href="#l60.58"></a><span id="l60.58">       this._updateCloseButtons();</span>
<a href="#l60.59"></a><span id="l60.59"> </span>
<a href="#l60.60"></a><span id="l60.60">       Services.prefs.addObserver(&quot;mail.tabs.&quot;, this._prefObserver);</span>
<a href="#l60.61"></a><span id="l60.61"> </span>
<a href="#l60.62"></a><span id="l60.62">       window.addEventListener(&quot;resize&quot;, this);</span>
<a href="#l60.63"></a><span id="l60.63"> </span>
<a href="#l60.64"></a><span id="l60.64">       // Listen to overflow/underflow events on the tabstrip,</span>
<a href="#l60.65"></a><span id="l60.65">       // we cannot put these as xbl handlers on the entire binding because</span>
<a href="#l60.66"></a><span id="l60.66" class="difflineat">@@ -739,17 +739,17 @@</span>
<a href="#l60.67"></a><span id="l60.67">       // 1 - alltabs    = close buttons on all tabs</span>
<a href="#l60.68"></a><span id="l60.68">       // 2 - noclose    = no close buttons at all</span>
<a href="#l60.69"></a><span id="l60.69">       // 3 - closeatend = close button at the end of the tabstrip</span>
<a href="#l60.70"></a><span id="l60.70">       switch (this.mCloseButtons) {</span>
<a href="#l60.71"></a><span id="l60.71">         case 0:</span>
<a href="#l60.72"></a><span id="l60.72">           this.setAttribute(&quot;closebuttons&quot;, &quot;activetab&quot;);</span>
<a href="#l60.73"></a><span id="l60.73">           break;</span>
<a href="#l60.74"></a><span id="l60.74">         case 1:</span>
<a href="#l60.75"></a><span id="l60.75" class="difflineminus">-          let width = this.arrowScrollbox.firstChild.getBoundingClientRect()</span>
<a href="#l60.76"></a><span id="l60.76" class="difflineplus">+          let width = this.arrowScrollbox.firstElementChild.getBoundingClientRect()</span>
<a href="#l60.77"></a><span id="l60.77">             .width;</span>
<a href="#l60.78"></a><span id="l60.78">           // 0 width is an invalid value and indicates</span>
<a href="#l60.79"></a><span id="l60.79">           // an item without display, so ignore.</span>
<a href="#l60.80"></a><span id="l60.80">           if (width &gt; this.mTabClipWidth || width == 0) {</span>
<a href="#l60.81"></a><span id="l60.81">             this.setAttribute(&quot;closebuttons&quot;, &quot;alltabs&quot;);</span>
<a href="#l60.82"></a><span id="l60.82">           } else {</span>
<a href="#l60.83"></a><span id="l60.83">             this.setAttribute(&quot;closebuttons&quot;, &quot;activetab&quot;);</span>
<a href="#l60.84"></a><span id="l60.84">           }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1" class="difflineminus">--- a/mail/base/content/tabmail.js</span>
<a href="#l61.2"></a><span id="l61.2" class="difflineplus">+++ b/mail/base/content/tabmail.js</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineat">@@ -65,17 +65,17 @@</span>
<a href="#l61.4"></a><span id="l61.4">           this._createTabMenuItem(tabs[i]);</span>
<a href="#l61.5"></a><span id="l61.5">         }</span>
<a href="#l61.6"></a><span id="l61.6">         this._updateTabsVisibilityStatus();</span>
<a href="#l61.7"></a><span id="l61.7">       });</span>
<a href="#l61.8"></a><span id="l61.8"> </span>
<a href="#l61.9"></a><span id="l61.9">       this.addEventListener(&quot;popuphiding&quot;, event =&gt; {</span>
<a href="#l61.10"></a><span id="l61.10">         // Clear out the menu popup and remove the listeners.</span>
<a href="#l61.11"></a><span id="l61.11">         while (this.hasChildNodes()) {</span>
<a href="#l61.12"></a><span id="l61.12" class="difflineminus">-          let menuItem = this.lastChild;</span>
<a href="#l61.13"></a><span id="l61.13" class="difflineplus">+          let menuItem = this.lastElementChild;</span>
<a href="#l61.14"></a><span id="l61.14">           menuItem.removeEventListener(&quot;command&quot;, this);</span>
<a href="#l61.15"></a><span id="l61.15">           menuItem.tab.removeEventListener(&quot;TabClose&quot;, this);</span>
<a href="#l61.16"></a><span id="l61.16">           menuItem.tab.mCorrespondingMenuitem = null;</span>
<a href="#l61.17"></a><span id="l61.17">           menuItem.remove();</span>
<a href="#l61.18"></a><span id="l61.18">         }</span>
<a href="#l61.19"></a><span id="l61.19">         this._mutationObserver.disconnect();</span>
<a href="#l61.20"></a><span id="l61.20"> </span>
<a href="#l61.21"></a><span id="l61.21">         this.tabmail.tabContainer.arrowScrollbox.removeEventListener(</span>
<a href="#l61.22"></a><span id="l61.22" class="difflineat">@@ -122,26 +122,26 @@</span>
<a href="#l61.23"></a><span id="l61.23">       let tabStrip = this.tabmail.tabContainer.arrowScrollbox;</span>
<a href="#l61.24"></a><span id="l61.24">       // We don't want menu item decoration unless there is overflow.</span>
<a href="#l61.25"></a><span id="l61.25">       if (tabStrip.getAttribute(&quot;overlfow&quot;) != &quot;true&quot;) {</span>
<a href="#l61.26"></a><span id="l61.26">         return;</span>
<a href="#l61.27"></a><span id="l61.27">       }</span>
<a href="#l61.28"></a><span id="l61.28"> </span>
<a href="#l61.29"></a><span id="l61.29">       let tabStripBox = tabStrip.getBoundingClientRect();</span>
<a href="#l61.30"></a><span id="l61.30"> </span>
<a href="#l61.31"></a><span id="l61.31" class="difflineminus">-      for (let i = 0; i &lt; this.childNodes.length; i++) {</span>
<a href="#l61.32"></a><span id="l61.32" class="difflineminus">-        let currentTabBox = this.childNodes[i].tab.getBoundingClientRect();</span>
<a href="#l61.33"></a><span id="l61.33" class="difflineplus">+      for (let i = 0; i &lt; this.children.length; i++) {</span>
<a href="#l61.34"></a><span id="l61.34" class="difflineplus">+        let currentTabBox = this.children[i].tab.getBoundingClientRect();</span>
<a href="#l61.35"></a><span id="l61.35"> </span>
<a href="#l61.36"></a><span id="l61.36">         if (</span>
<a href="#l61.37"></a><span id="l61.37">           currentTabBox.left &gt;= tabStripBox.left &amp;&amp;</span>
<a href="#l61.38"></a><span id="l61.38">           currentTabBox.right &lt;= tabStripBox.right</span>
<a href="#l61.39"></a><span id="l61.39">         ) {</span>
<a href="#l61.40"></a><span id="l61.40" class="difflineminus">-          this.childNodes[i].setAttribute(&quot;tabIsVisible&quot;, &quot;true&quot;);</span>
<a href="#l61.41"></a><span id="l61.41" class="difflineplus">+          this.children[i].setAttribute(&quot;tabIsVisible&quot;, &quot;true&quot;);</span>
<a href="#l61.42"></a><span id="l61.42">         } else {</span>
<a href="#l61.43"></a><span id="l61.43" class="difflineminus">-          this.childNodes[i].removeAttribute(&quot;tabIsVisible&quot;);</span>
<a href="#l61.44"></a><span id="l61.44" class="difflineplus">+          this.children[i].removeAttribute(&quot;tabIsVisible&quot;);</span>
<a href="#l61.45"></a><span id="l61.45">         }</span>
<a href="#l61.46"></a><span id="l61.46">       }</span>
<a href="#l61.47"></a><span id="l61.47">     }</span>
<a href="#l61.48"></a><span id="l61.48"> </span>
<a href="#l61.49"></a><span id="l61.49">     _createTabMenuItem(aTab) {</span>
<a href="#l61.50"></a><span id="l61.50">       let menuItem = document.createXULElement(&quot;menuitem&quot;);</span>
<a href="#l61.51"></a><span id="l61.51"> </span>
<a href="#l61.52"></a><span id="l61.52">       menuItem.setAttribute(</span>
<a href="#l61.53"></a><span id="l61.53" class="difflineat">@@ -687,17 +687,17 @@</span>
<a href="#l61.54"></a><span id="l61.54">       if (tab.localName != &quot;tab&quot; || this.tabContainer.draggedTab) {</span>
<a href="#l61.55"></a><span id="l61.55">         event.preventDefault();</span>
<a href="#l61.56"></a><span id="l61.56">         return;</span>
<a href="#l61.57"></a><span id="l61.57">       }</span>
<a href="#l61.58"></a><span id="l61.58"> </span>
<a href="#l61.59"></a><span id="l61.59">       event.target.setAttribute(</span>
<a href="#l61.60"></a><span id="l61.60">         &quot;label&quot;,</span>
<a href="#l61.61"></a><span id="l61.61">         tab.mOverCloseButton</span>
<a href="#l61.62"></a><span id="l61.62" class="difflineminus">-          ? tab.firstChild.getAttribute(&quot;closetabtext&quot;)</span>
<a href="#l61.63"></a><span id="l61.63" class="difflineplus">+          ? tab.firstElementChild.getAttribute(&quot;closetabtext&quot;)</span>
<a href="#l61.64"></a><span id="l61.64">           : tab.getAttribute(&quot;label&quot;)</span>
<a href="#l61.65"></a><span id="l61.65">       );</span>
<a href="#l61.66"></a><span id="l61.66">     }</span>
<a href="#l61.67"></a><span id="l61.67"> </span>
<a href="#l61.68"></a><span id="l61.68">     registerTabType(aTabType) {</span>
<a href="#l61.69"></a><span id="l61.69">       if (aTabType.name in this.tabTypes) {</span>
<a href="#l61.70"></a><span id="l61.70">         return;</span>
<a href="#l61.71"></a><span id="l61.71">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1" class="difflineminus">--- a/mail/base/content/threadPane.js</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineplus">+++ b/mail/base/content/threadPane.js</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineat">@@ -384,17 +384,17 @@ function MsgSortDescending() {</span>
<a href="#l62.4"></a><span id="l62.4"> </span>
<a href="#l62.5"></a><span id="l62.5">   gFolderDisplay.view.sortDescending();</span>
<a href="#l62.6"></a><span id="l62.6"> }</span>
<a href="#l62.7"></a><span id="l62.7"> </span>
<a href="#l62.8"></a><span id="l62.8"> // XXX this should probably migrate into FolderDisplayWidget, or whatever</span>
<a href="#l62.9"></a><span id="l62.9"> //  FolderDisplayWidget ends up using if it refactors column management out.</span>
<a href="#l62.10"></a><span id="l62.10"> function UpdateSortIndicators(sortType, sortOrder) {</span>
<a href="#l62.11"></a><span id="l62.11">   // Remove the sort indicator from all the columns</span>
<a href="#l62.12"></a><span id="l62.12" class="difflineminus">-  var treeColumns = document.getElementById(&quot;threadCols&quot;).childNodes;</span>
<a href="#l62.13"></a><span id="l62.13" class="difflineplus">+  var treeColumns = document.getElementById(&quot;threadCols&quot;).children;</span>
<a href="#l62.14"></a><span id="l62.14">   for (var i = 0; i &lt; treeColumns.length; i++) {</span>
<a href="#l62.15"></a><span id="l62.15">     treeColumns[i].removeAttribute(&quot;sortDirection&quot;);</span>
<a href="#l62.16"></a><span id="l62.16">   }</span>
<a href="#l62.17"></a><span id="l62.17"> </span>
<a href="#l62.18"></a><span id="l62.18">   // show the twisties if the view is threaded</span>
<a href="#l62.19"></a><span id="l62.19">   var threadCol = document.getElementById(&quot;threadCol&quot;);</span>
<a href="#l62.20"></a><span id="l62.20">   var subjectCol = document.getElementById(&quot;subjectCol&quot;);</span>
<a href="#l62.21"></a><span id="l62.21">   var sortedColumn;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1" class="difflineminus">--- a/mail/base/content/utilityOverlay.js</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineplus">+++ b/mail/base/content/utilityOverlay.js</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineat">@@ -68,17 +68,17 @@ function goCopyImage() {</span>
<a href="#l63.4"></a><span id="l63.4"> function goUpdateFindTypeMenuItems() {</span>
<a href="#l63.5"></a><span id="l63.5">   goUpdateCommand(&quot;cmd_findTypeText&quot;);</span>
<a href="#l63.6"></a><span id="l63.6">   goUpdateCommand(&quot;cmd_findTypeLinks&quot;);</span>
<a href="#l63.7"></a><span id="l63.7"> }</span>
<a href="#l63.8"></a><span id="l63.8"> </span>
<a href="#l63.9"></a><span id="l63.9"> // Gather all descendent text under given document node.</span>
<a href="#l63.10"></a><span id="l63.10"> function gatherTextUnder(root) {</span>
<a href="#l63.11"></a><span id="l63.11">   var text = &quot;&quot;;</span>
<a href="#l63.12"></a><span id="l63.12" class="difflineminus">-  var node = root.firstChild;</span>
<a href="#l63.13"></a><span id="l63.13" class="difflineplus">+  var node = root.firstElementChild;</span>
<a href="#l63.14"></a><span id="l63.14">   var depth = 1;</span>
<a href="#l63.15"></a><span id="l63.15">   while (node &amp;&amp; depth &gt; 0) {</span>
<a href="#l63.16"></a><span id="l63.16">     // See if this node is text.</span>
<a href="#l63.17"></a><span id="l63.17">     if (node.nodeType == Node.TEXT_NODE) {</span>
<a href="#l63.18"></a><span id="l63.18">       // Add this text to our collection.</span>
<a href="#l63.19"></a><span id="l63.19">       text += &quot; &quot; + node.data;</span>
<a href="#l63.20"></a><span id="l63.20">     } else if (node instanceof HTMLImageElement) {</span>
<a href="#l63.21"></a><span id="l63.21">       // If it has an alt= attribute, add that.</span>
<a href="#l63.22"></a><span id="l63.22" class="difflineat">@@ -86,28 +86,28 @@ function gatherTextUnder(root) {</span>
<a href="#l63.23"></a><span id="l63.23">       if (altText &amp;&amp; altText != &quot;&quot;) {</span>
<a href="#l63.24"></a><span id="l63.24">         text += &quot; &quot; + altText;</span>
<a href="#l63.25"></a><span id="l63.25">       }</span>
<a href="#l63.26"></a><span id="l63.26">     }</span>
<a href="#l63.27"></a><span id="l63.27">     // Find next node to test.</span>
<a href="#l63.28"></a><span id="l63.28">     // First, see if this node has children.</span>
<a href="#l63.29"></a><span id="l63.29">     if (node.hasChildNodes()) {</span>
<a href="#l63.30"></a><span id="l63.30">       // Go to first child.</span>
<a href="#l63.31"></a><span id="l63.31" class="difflineminus">-      node = node.firstChild;</span>
<a href="#l63.32"></a><span id="l63.32" class="difflineplus">+      node = node.firstElementChild;</span>
<a href="#l63.33"></a><span id="l63.33">       depth++;</span>
<a href="#l63.34"></a><span id="l63.34" class="difflineminus">-    } else if (node.nextSibling) {</span>
<a href="#l63.35"></a><span id="l63.35" class="difflineplus">+    } else if (node.nextElementSibling) {</span>
<a href="#l63.36"></a><span id="l63.36">       // No children, try next sibling.</span>
<a href="#l63.37"></a><span id="l63.37" class="difflineminus">-      node = node.nextSibling;</span>
<a href="#l63.38"></a><span id="l63.38" class="difflineplus">+      node = node.nextElementSibling;</span>
<a href="#l63.39"></a><span id="l63.39">     } else {</span>
<a href="#l63.40"></a><span id="l63.40">       // Last resort is a sibling of an ancestor.</span>
<a href="#l63.41"></a><span id="l63.41">       while (node &amp;&amp; depth &gt; 0) {</span>
<a href="#l63.42"></a><span id="l63.42">         node = node.parentNode;</span>
<a href="#l63.43"></a><span id="l63.43">         depth--;</span>
<a href="#l63.44"></a><span id="l63.44" class="difflineminus">-        if (node.nextSibling) {</span>
<a href="#l63.45"></a><span id="l63.45" class="difflineminus">-          node = node.nextSibling;</span>
<a href="#l63.46"></a><span id="l63.46" class="difflineplus">+        if (node.nextElementSibling) {</span>
<a href="#l63.47"></a><span id="l63.47" class="difflineplus">+          node = node.nextElementSibling;</span>
<a href="#l63.48"></a><span id="l63.48">           break;</span>
<a href="#l63.49"></a><span id="l63.49">         }</span>
<a href="#l63.50"></a><span id="l63.50">       }</span>
<a href="#l63.51"></a><span id="l63.51">     }</span>
<a href="#l63.52"></a><span id="l63.52">   }</span>
<a href="#l63.53"></a><span id="l63.53">   // Strip leading and trailing whitespace.</span>
<a href="#l63.54"></a><span id="l63.54">   text = text.trim();</span>
<a href="#l63.55"></a><span id="l63.55">   // Compress remaining whitespace.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1" class="difflineminus">--- a/mail/base/modules/ExtensionsUI.jsm</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineplus">+++ b/mail/base/modules/ExtensionsUI.jsm</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineat">@@ -162,18 +162,18 @@ var gXPInstallObserver = {</span>
<a href="#l64.4"></a><span id="l64.4">       switch (event) {</span>
<a href="#l64.5"></a><span id="l64.5">         case &quot;removed&quot;:</span>
<a href="#l64.6"></a><span id="l64.6">           cancelInstallation();</span>
<a href="#l64.7"></a><span id="l64.7">           break;</span>
<a href="#l64.8"></a><span id="l64.8">         case &quot;shown&quot;:</span>
<a href="#l64.9"></a><span id="l64.9">           let addonList = document.getElementById(</span>
<a href="#l64.10"></a><span id="l64.10">             &quot;addon-install-confirmation-content&quot;</span>
<a href="#l64.11"></a><span id="l64.11">           );</span>
<a href="#l64.12"></a><span id="l64.12" class="difflineminus">-          while (addonList.firstChild) {</span>
<a href="#l64.13"></a><span id="l64.13" class="difflineminus">-            addonList.firstChild.remove();</span>
<a href="#l64.14"></a><span id="l64.14" class="difflineplus">+          while (addonList.lastChild) {</span>
<a href="#l64.15"></a><span id="l64.15" class="difflineplus">+            addonList.lastChild.remove();</span>
<a href="#l64.16"></a><span id="l64.16">           }</span>
<a href="#l64.17"></a><span id="l64.17"> </span>
<a href="#l64.18"></a><span id="l64.18">           for (let install of installInfo.installs) {</span>
<a href="#l64.19"></a><span id="l64.19">             let container = document.createXULElement(&quot;hbox&quot;);</span>
<a href="#l64.20"></a><span id="l64.20"> </span>
<a href="#l64.21"></a><span id="l64.21">             let name = document.createXULElement(&quot;label&quot;);</span>
<a href="#l64.22"></a><span id="l64.22">             name.setAttribute(&quot;value&quot;, install.addon.name);</span>
<a href="#l64.23"></a><span id="l64.23">             name.setAttribute(&quot;class&quot;, &quot;addon-install-confirmation-name&quot;);</span>
<a href="#l64.24"></a><span id="l64.24" class="difflineat">@@ -249,18 +249,18 @@ var gXPInstallObserver = {</span>
<a href="#l64.25"></a><span id="l64.25">           textEl.textContent = strings.text;</span>
<a href="#l64.26"></a><span id="l64.26">           textEl.hidden = !strings.text;</span>
<a href="#l64.27"></a><span id="l64.27"> </span>
<a href="#l64.28"></a><span id="l64.28">           let listIntroEl = doc.getElementById(&quot;addon-webext-perm-intro&quot;);</span>
<a href="#l64.29"></a><span id="l64.29">           listIntroEl.textContent = strings.listIntro;</span>
<a href="#l64.30"></a><span id="l64.30">           listIntroEl.hidden = strings.msgs.length == 0;</span>
<a href="#l64.31"></a><span id="l64.31"> </span>
<a href="#l64.32"></a><span id="l64.32">           let list = doc.getElementById(&quot;addon-webext-perm-list&quot;);</span>
<a href="#l64.33"></a><span id="l64.33" class="difflineminus">-          while (list.firstChild) {</span>
<a href="#l64.34"></a><span id="l64.34" class="difflineminus">-            list.firstChild.remove();</span>
<a href="#l64.35"></a><span id="l64.35" class="difflineplus">+          while (list.lastChild) {</span>
<a href="#l64.36"></a><span id="l64.36" class="difflineplus">+            list.lastChild.remove();</span>
<a href="#l64.37"></a><span id="l64.37">           }</span>
<a href="#l64.38"></a><span id="l64.38"> </span>
<a href="#l64.39"></a><span id="l64.39">           for (let msg of strings.msgs) {</span>
<a href="#l64.40"></a><span id="l64.40">             let item = doc.createElementNS(HTML_NS, &quot;li&quot;);</span>
<a href="#l64.41"></a><span id="l64.41">             item.textContent = msg;</span>
<a href="#l64.42"></a><span id="l64.42">             list.appendChild(item);</span>
<a href="#l64.43"></a><span id="l64.43">           }</span>
<a href="#l64.44"></a><span id="l64.44">         } else if (topic == &quot;swapping&quot;) {</span>
<a href="#l64.45"></a><span id="l64.45" class="difflineat">@@ -856,18 +856,18 @@ var gXPInstallObserver = {</span>
<a href="#l64.46"></a><span id="l64.46"> </span>
<a href="#l64.47"></a><span id="l64.47">     let message = addonsBundle.getFormattedString(</span>
<a href="#l64.48"></a><span id="l64.48">       &quot;addonPostInstall.multiple.message&quot;,</span>
<a href="#l64.49"></a><span id="l64.49">       [appName]</span>
<a href="#l64.50"></a><span id="l64.50">     );</span>
<a href="#l64.51"></a><span id="l64.51"> </span>
<a href="#l64.52"></a><span id="l64.52">     let list = document.getElementById(&quot;addon-installed-list&quot;);</span>
<a href="#l64.53"></a><span id="l64.53">     list.hidden = false;</span>
<a href="#l64.54"></a><span id="l64.54" class="difflineminus">-    while (list.firstChild) {</span>
<a href="#l64.55"></a><span id="l64.55" class="difflineminus">-      list.firstChild.remove();</span>
<a href="#l64.56"></a><span id="l64.56" class="difflineplus">+    while (list.lastChild) {</span>
<a href="#l64.57"></a><span id="l64.57" class="difflineplus">+      list.lastChild.remove();</span>
<a href="#l64.58"></a><span id="l64.58">     }</span>
<a href="#l64.59"></a><span id="l64.59">     let textEl = document.getElementById(&quot;addon-installed-restart-text&quot;);</span>
<a href="#l64.60"></a><span id="l64.60">     textEl.textContent = addonsBundle.getFormattedString(</span>
<a href="#l64.61"></a><span id="l64.61">       &quot;addonPostInstall.restartRequired.message&quot;,</span>
<a href="#l64.62"></a><span id="l64.62">       [appName]</span>
<a href="#l64.63"></a><span id="l64.63">     );</span>
<a href="#l64.64"></a><span id="l64.64">     textEl.hidden = false;</span>
<a href="#l64.65"></a><span id="l64.65"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1" class="difflineminus">--- a/mail/base/modules/QuickFilterManager.jsm</span>
<a href="#l65.2"></a><span id="l65.2" class="difflineplus">+++ b/mail/base/modules/QuickFilterManager.jsm</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineat">@@ -912,18 +912,18 @@ var TagFacetingFilter = {</span>
<a href="#l65.4"></a><span id="l65.4">         }</span>
<a href="#l65.5"></a><span id="l65.5">         aMuxer.updateSearch();</span>
<a href="#l65.6"></a><span id="l65.6">         aEvent.stopPropagation();</span>
<a href="#l65.7"></a><span id="l65.7">         aEvent.preventDefault();</span>
<a href="#l65.8"></a><span id="l65.8">       }</span>
<a href="#l65.9"></a><span id="l65.9">     }</span>
<a href="#l65.10"></a><span id="l65.10"> </span>
<a href="#l65.11"></a><span id="l65.11">     // -- nuke existing exposed tags, but not the mode selector (which is first)</span>
<a href="#l65.12"></a><span id="l65.12" class="difflineminus">-    while (tagbar.childNodes.length &gt; 1) {</span>
<a href="#l65.13"></a><span id="l65.13" class="difflineminus">-      tagbar.lastChild.remove();</span>
<a href="#l65.14"></a><span id="l65.14" class="difflineplus">+    while (tagbar.children.length &gt; 1) {</span>
<a href="#l65.15"></a><span id="l65.15" class="difflineplus">+      tagbar.lastElementChild.remove();</span>
<a href="#l65.16"></a><span id="l65.16">     }</span>
<a href="#l65.17"></a><span id="l65.17"> </span>
<a href="#l65.18"></a><span id="l65.18">     let addCount = 0;</span>
<a href="#l65.19"></a><span id="l65.19"> </span>
<a href="#l65.20"></a><span id="l65.20">     // -- create an element for each tag</span>
<a href="#l65.21"></a><span id="l65.21">     let tags = MailServices.tags.getAllTags();</span>
<a href="#l65.22"></a><span id="l65.22">     let tagCount = tags.length;</span>
<a href="#l65.23"></a><span id="l65.23">     for (let iTag = 0; iTag &lt; tagCount; iTag++) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l66.1"></a><span id="l66.1" class="difflineminus">--- a/mail/components/about-support/content/accounts.js</span>
<a href="#l66.2"></a><span id="l66.2" class="difflineplus">+++ b/mail/components/about-support/content/accounts.js</span>
<a href="#l66.3"></a><span id="l66.3" class="difflineat">@@ -191,19 +191,19 @@ function createElement(tagName, textCont</span>
<a href="#l66.4"></a><span id="l66.4"> </span>
<a href="#l66.5"></a><span id="l66.5">   if (opt_copyData != null) {</span>
<a href="#l66.6"></a><span id="l66.6">     elem.dataset.copyData = opt_copyData;</span>
<a href="#l66.7"></a><span id="l66.7">   }</span>
<a href="#l66.8"></a><span id="l66.8"> </span>
<a href="#l66.9"></a><span id="l66.9">   return elem;</span>
<a href="#l66.10"></a><span id="l66.10"> }</span>
<a href="#l66.11"></a><span id="l66.11"> </span>
<a href="#l66.12"></a><span id="l66.12" class="difflineminus">-function appendChildren(parentElem, childNodes) {</span>
<a href="#l66.13"></a><span id="l66.13" class="difflineminus">-  for (let i = 0; i &lt; childNodes.length; i++) {</span>
<a href="#l66.14"></a><span id="l66.14" class="difflineminus">-    parentElem.appendChild(childNodes[i]);</span>
<a href="#l66.15"></a><span id="l66.15" class="difflineplus">+function appendChildren(parentElem, children) {</span>
<a href="#l66.16"></a><span id="l66.16" class="difflineplus">+  for (let i = 0; i &lt; children.length; i++) {</span>
<a href="#l66.17"></a><span id="l66.17" class="difflineplus">+    parentElem.appendChild(children[i]);</span>
<a href="#l66.18"></a><span id="l66.18">   }</span>
<a href="#l66.19"></a><span id="l66.19"> }</span>
<a href="#l66.20"></a><span id="l66.20"> </span>
<a href="#l66.21"></a><span id="l66.21"> /**</span>
<a href="#l66.22"></a><span id="l66.22">  * Coerces x into a string.</span>
<a href="#l66.23"></a><span id="l66.23">  */</span>
<a href="#l66.24"></a><span id="l66.24"> function toStr(x) {</span>
<a href="#l66.25"></a><span id="l66.25">   return &quot;&quot; + x;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l67.1"></a><span id="l67.1" class="difflineminus">--- a/mail/components/about-support/content/export.js</span>
<a href="#l67.2"></a><span id="l67.2" class="difflineplus">+++ b/mail/components/about-support/content/export.js</span>
<a href="#l67.3"></a><span id="l67.3" class="difflineat">@@ -125,18 +125,18 @@ function cleanUpText(aElem, aHidePrivate</span>
<a href="#l67.4"></a><span id="l67.4">   while (node) {</span>
<a href="#l67.5"></a><span id="l67.5">     let classList = &quot;classList&quot; in node &amp;&amp; node.classList;</span>
<a href="#l67.6"></a><span id="l67.6">     // Delete uionly and no-copy nodes.</span>
<a href="#l67.7"></a><span id="l67.7">     if (</span>
<a href="#l67.8"></a><span id="l67.8">       classList &amp;&amp;</span>
<a href="#l67.9"></a><span id="l67.9">       (classList.contains(CLASS_DATA_UIONLY) || classList.contains(&quot;no-copy&quot;))</span>
<a href="#l67.10"></a><span id="l67.10">     ) {</span>
<a href="#l67.11"></a><span id="l67.11">       // Advance to the next node before removing the current node, since</span>
<a href="#l67.12"></a><span id="l67.12" class="difflineminus">-      // node.nextSibling is null after remove()</span>
<a href="#l67.13"></a><span id="l67.13" class="difflineminus">-      let nextNode = node.nextSibling;</span>
<a href="#l67.14"></a><span id="l67.14" class="difflineplus">+      // node.nextElementSibling is null after remove()</span>
<a href="#l67.15"></a><span id="l67.15" class="difflineplus">+      let nextNode = node.nextElementSibling;</span>
<a href="#l67.16"></a><span id="l67.16">       node.remove();</span>
<a href="#l67.17"></a><span id="l67.17">       node = nextNode;</span>
<a href="#l67.18"></a><span id="l67.18">       continue;</span>
<a href="#l67.19"></a><span id="l67.19">     } else if (</span>
<a href="#l67.20"></a><span id="l67.20">       aHidePrivateData &amp;&amp;</span>
<a href="#l67.21"></a><span id="l67.21">       classList &amp;&amp;</span>
<a href="#l67.22"></a><span id="l67.22">       classList.contains(CLASS_DATA_PRIVATE)</span>
<a href="#l67.23"></a><span id="l67.23">     ) {</span>
<a href="#l67.24"></a><span id="l67.24" class="difflineat">@@ -274,15 +274,15 @@ function generateTextForTextNode(node, i</span>
<a href="#l67.25"></a><span id="l67.25"> </span>
<a href="#l67.26"></a><span id="l67.26"> function getCrashesText(aIndent) {</span>
<a href="#l67.27"></a><span id="l67.27">   let crashesData = &quot;&quot;;</span>
<a href="#l67.28"></a><span id="l67.28">   let recentCrashesSubmitted = document.querySelectorAll(&quot;#crashes-tbody &gt; tr&quot;);</span>
<a href="#l67.29"></a><span id="l67.29">   for (let i = 0; i &lt; recentCrashesSubmitted.length; i++) {</span>
<a href="#l67.30"></a><span id="l67.30">     let tds = recentCrashesSubmitted.item(i).querySelectorAll(&quot;td&quot;);</span>
<a href="#l67.31"></a><span id="l67.31">     crashesData +=</span>
<a href="#l67.32"></a><span id="l67.32">       aIndent.repeat(2) +</span>
<a href="#l67.33"></a><span id="l67.33" class="difflineminus">-      tds.item(0).firstChild.href +</span>
<a href="#l67.34"></a><span id="l67.34" class="difflineplus">+      tds.item(0).firstElementChild.href +</span>
<a href="#l67.35"></a><span id="l67.35">       &quot; (&quot; +</span>
<a href="#l67.36"></a><span id="l67.36">       tds.item(1).textContent +</span>
<a href="#l67.37"></a><span id="l67.37">       &quot;)\n&quot;;</span>
<a href="#l67.38"></a><span id="l67.38">   }</span>
<a href="#l67.39"></a><span id="l67.39">   return crashesData;</span>
<a href="#l67.40"></a><span id="l67.40"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l68.1"></a><span id="l68.1" class="difflineminus">--- a/mail/components/accountcreation/content/emailWizard.js</span>
<a href="#l68.2"></a><span id="l68.2" class="difflineplus">+++ b/mail/components/accountcreation/content/emailWizard.js</span>
<a href="#l68.3"></a><span id="l68.3" class="difflineat">@@ -1409,17 +1409,17 @@ EmailConfigWizard.prototype = {</span>
<a href="#l68.4"></a><span id="l68.4">       this._currentConfig.oauthSettings = config.oauthSettings;</span>
<a href="#l68.5"></a><span id="l68.5">     }</span>
<a href="#l68.6"></a><span id="l68.6"> </span>
<a href="#l68.7"></a><span id="l68.7">     // populate fields even if existingServerKey, in case user changes back</span>
<a href="#l68.8"></a><span id="l68.8">     if (config.outgoing.existingServerKey) {</span>
<a href="#l68.9"></a><span id="l68.9">       let menulist = e(&quot;outgoing_hostname&quot;);</span>
<a href="#l68.10"></a><span id="l68.10">       // We can't use menulist.value = config.outgoing.existingServerKey</span>
<a href="#l68.11"></a><span id="l68.11">       // because would overwrite the text field, so have to do it manually:</span>
<a href="#l68.12"></a><span id="l68.12" class="difflineminus">-      let menuitems = menulist.menupopup.childNodes;</span>
<a href="#l68.13"></a><span id="l68.13" class="difflineplus">+      let menuitems = menulist.menupopup.children;</span>
<a href="#l68.14"></a><span id="l68.14">       for (let menuitem of menuitems) {</span>
<a href="#l68.15"></a><span id="l68.15">         if (menuitem.serverKey == config.outgoing.existingServerKey) {</span>
<a href="#l68.16"></a><span id="l68.16">           menulist.selectedItem = menuitem;</span>
<a href="#l68.17"></a><span id="l68.17">           break;</span>
<a href="#l68.18"></a><span id="l68.18">         }</span>
<a href="#l68.19"></a><span id="l68.19">       }</span>
<a href="#l68.20"></a><span id="l68.20">     }</span>
<a href="#l68.21"></a><span id="l68.21">     this.onChangedOutgoingDropdown(); // show/hide outgoing port, SSL, ...</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l69.1"></a><span id="l69.1" class="difflineminus">--- a/mail/components/activity/content/activity.js</span>
<a href="#l69.2"></a><span id="l69.2" class="difflineplus">+++ b/mail/components/activity/content/activity.js</span>
<a href="#l69.3"></a><span id="l69.3" class="difflineat">@@ -50,38 +50,38 @@ var activityObject = {</span>
<a href="#l69.4"></a><span id="l69.4">   /**</span>
<a href="#l69.5"></a><span id="l69.5">    * Inserts the given element into the correct position on the</span>
<a href="#l69.6"></a><span id="l69.6">    * activity manager window.</span>
<a href="#l69.7"></a><span id="l69.7">    */</span>
<a href="#l69.8"></a><span id="l69.8">   placeActivityElement(element) {</span>
<a href="#l69.9"></a><span id="l69.9">     if (element.isGroup || element.isProcess) {</span>
<a href="#l69.10"></a><span id="l69.10">       this._activitiesView.insertBefore(</span>
<a href="#l69.11"></a><span id="l69.11">         element,</span>
<a href="#l69.12"></a><span id="l69.12" class="difflineminus">-        this._activitiesView.firstChild</span>
<a href="#l69.13"></a><span id="l69.13" class="difflineplus">+        this._activitiesView.firstElementChild</span>
<a href="#l69.14"></a><span id="l69.14">       );</span>
<a href="#l69.15"></a><span id="l69.15">     } else {</span>
<a href="#l69.16"></a><span id="l69.16" class="difflineminus">-      let next = this._activitiesView.firstChild;</span>
<a href="#l69.17"></a><span id="l69.17" class="difflineplus">+      let next = this._activitiesView.firstElementChild;</span>
<a href="#l69.18"></a><span id="l69.18">       while (next &amp;&amp; (next.isWarning || next.isProcess || next.isGroup)) {</span>
<a href="#l69.19"></a><span id="l69.19" class="difflineminus">-        next = next.nextSibling;</span>
<a href="#l69.20"></a><span id="l69.20" class="difflineplus">+        next = next.nextElementSibling;</span>
<a href="#l69.21"></a><span id="l69.21">       }</span>
<a href="#l69.22"></a><span id="l69.22">       if (next) {</span>
<a href="#l69.23"></a><span id="l69.23">         this._activitiesView.insertBefore(element, next);</span>
<a href="#l69.24"></a><span id="l69.24">       } else {</span>
<a href="#l69.25"></a><span id="l69.25">         this._activitiesView.appendChild(element);</span>
<a href="#l69.26"></a><span id="l69.26">       }</span>
<a href="#l69.27"></a><span id="l69.27">     }</span>
<a href="#l69.28"></a><span id="l69.28">     if (element.isGroup) {</span>
<a href="#l69.29"></a><span id="l69.29">       this._groupCache.set(</span>
<a href="#l69.30"></a><span id="l69.30">         element.contextType + &quot;:&quot; + element.contextObj,</span>
<a href="#l69.31"></a><span id="l69.31">         element</span>
<a href="#l69.32"></a><span id="l69.32">       );</span>
<a href="#l69.33"></a><span id="l69.33">     }</span>
<a href="#l69.34"></a><span id="l69.34" class="difflineminus">-    while (this._activitiesView.childNodes.length &gt; ACTIVITY_LIMIT) {</span>
<a href="#l69.35"></a><span id="l69.35" class="difflineplus">+    while (this._activitiesView.children.length &gt; ACTIVITY_LIMIT) {</span>
<a href="#l69.36"></a><span id="l69.36">       this.removeActivityElement(</span>
<a href="#l69.37"></a><span id="l69.37" class="difflineminus">-        this._activitiesView.lastChild.getAttribute(&quot;actID&quot;)</span>
<a href="#l69.38"></a><span id="l69.38" class="difflineplus">+        this._activitiesView.lastElementChild.getAttribute(&quot;actID&quot;)</span>
<a href="#l69.39"></a><span id="l69.39">       );</span>
<a href="#l69.40"></a><span id="l69.40">     }</span>
<a href="#l69.41"></a><span id="l69.41">   },</span>
<a href="#l69.42"></a><span id="l69.42"> </span>
<a href="#l69.43"></a><span id="l69.43">   /**</span>
<a href="#l69.44"></a><span id="l69.44">    * Adds a new element to activity manager window for the</span>
<a href="#l69.45"></a><span id="l69.45">    * given activity. It is called by ActivityMgrListener when</span>
<a href="#l69.46"></a><span id="l69.46">    * a new activity is added into the activity manager's internal</span>
<a href="#l69.47"></a><span id="l69.47" class="difflineat">@@ -139,17 +139,17 @@ var activityObject = {</span>
<a href="#l69.48"></a><span id="l69.48">   /**</span>
<a href="#l69.49"></a><span id="l69.49">    * Removes the activity element from the activity manager window.</span>
<a href="#l69.50"></a><span id="l69.50">    * It is called by ActivityMgrListener when the activity in question</span>
<a href="#l69.51"></a><span id="l69.51">    * is removed from the activity manager's internal list.</span>
<a href="#l69.52"></a><span id="l69.52">    */</span>
<a href="#l69.53"></a><span id="l69.53">   removeActivityElement(aID) {</span>
<a href="#l69.54"></a><span id="l69.54">     // Note: document.getAnonymousNodes(_activitiesView); didn't work</span>
<a href="#l69.55"></a><span id="l69.55">     this._activityLogger.info(&quot;removing Activity ID: &quot; + aID);</span>
<a href="#l69.56"></a><span id="l69.56" class="difflineminus">-    let activities = this._activitiesView.childNodes;</span>
<a href="#l69.57"></a><span id="l69.57" class="difflineplus">+    let activities = this._activitiesView.children;</span>
<a href="#l69.58"></a><span id="l69.58">     for (let i = 0; i &lt; activities.length; i++) {</span>
<a href="#l69.59"></a><span id="l69.59">       let item = activities[i];</span>
<a href="#l69.60"></a><span id="l69.60">       if (!item) {</span>
<a href="#l69.61"></a><span id="l69.61">         this._activityLogger.debug(&quot;returning as empty&quot;);</span>
<a href="#l69.62"></a><span id="l69.62">         return;</span>
<a href="#l69.63"></a><span id="l69.63">       }</span>
<a href="#l69.64"></a><span id="l69.64"> </span>
<a href="#l69.65"></a><span id="l69.65">       if (!item.isGroup) {</span>
<a href="#l69.66"></a><span id="l69.66" class="difflineat">@@ -225,17 +225,17 @@ var activityObject = {</span>
<a href="#l69.67"></a><span id="l69.67">     this._activityLogger.debug(&quot;clearActivityList&quot;);</span>
<a href="#l69.68"></a><span id="l69.68"> </span>
<a href="#l69.69"></a><span id="l69.69">     this._ignoreNotifications = true;</span>
<a href="#l69.70"></a><span id="l69.70">     // If/when we implement search, we'll want to remove just the items</span>
<a href="#l69.71"></a><span id="l69.71">     // that are on the search display, however for now, we'll just clear up</span>
<a href="#l69.72"></a><span id="l69.72">     // everything.</span>
<a href="#l69.73"></a><span id="l69.73">     activityManager.cleanUp();</span>
<a href="#l69.74"></a><span id="l69.74"> </span>
<a href="#l69.75"></a><span id="l69.75" class="difflineminus">-    let activities = this._activitiesView.childNodes;</span>
<a href="#l69.76"></a><span id="l69.76" class="difflineplus">+    let activities = this._activitiesView.children;</span>
<a href="#l69.77"></a><span id="l69.77">     for (let i = activities.length - 1; i &gt;= 0; i--) {</span>
<a href="#l69.78"></a><span id="l69.78">       let item = activities[i];</span>
<a href="#l69.79"></a><span id="l69.79">       if (!item.isGroup) {</span>
<a href="#l69.80"></a><span id="l69.80">         item.detachFromActivity();</span>
<a href="#l69.81"></a><span id="l69.81">       } else {</span>
<a href="#l69.82"></a><span id="l69.82">         item.querySelectorAll(&quot;[actID]&quot;).forEach(elem =&gt; {</span>
<a href="#l69.83"></a><span id="l69.83">           elem.detachFromActivity();</span>
<a href="#l69.84"></a><span id="l69.84">           elem.remove();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l70.1"></a><span id="l70.1" class="difflineminus">--- a/mail/components/addrbook/content/abCardView.js</span>
<a href="#l70.2"></a><span id="l70.2" class="difflineplus">+++ b/mail/components/addrbook/content/abCardView.js</span>
<a href="#l70.3"></a><span id="l70.3" class="difflineat">@@ -268,17 +268,17 @@ function DisplayCardViewPane(realCard) {</span>
<a href="#l70.4"></a><span id="l70.4">       data.cvHomeCityStZip,</span>
<a href="#l70.5"></a><span id="l70.5">       card.getProperty(&quot;HomeCity&quot;),</span>
<a href="#l70.6"></a><span id="l70.6">       card.getProperty(&quot;HomeState&quot;),</span>
<a href="#l70.7"></a><span id="l70.7">       card.getProperty(&quot;HomeZipCode&quot;)</span>
<a href="#l70.8"></a><span id="l70.8">     ) || visible;</span>
<a href="#l70.9"></a><span id="l70.9">   visible =</span>
<a href="#l70.10"></a><span id="l70.10">     cvSetNode(data.cvHomeCountry, card.getProperty(&quot;HomeCountry&quot;)) || visible;</span>
<a href="#l70.11"></a><span id="l70.11"> </span>
<a href="#l70.12"></a><span id="l70.12" class="difflineminus">-  let mapURLList = data.cvHomeMapIt.firstChild;</span>
<a href="#l70.13"></a><span id="l70.13" class="difflineplus">+  let mapURLList = data.cvHomeMapIt.firstElementChild;</span>
<a href="#l70.14"></a><span id="l70.14">   if (visible) {</span>
<a href="#l70.15"></a><span id="l70.15">     mapURLList.initMapAddressFromCard(card, &quot;Home&quot;);</span>
<a href="#l70.16"></a><span id="l70.16">   }</span>
<a href="#l70.17"></a><span id="l70.17"> </span>
<a href="#l70.18"></a><span id="l70.18">   cvSetVisible(data.cvbHomeMapItBox, visible &amp;&amp; !!mapURLList.mapURL);</span>
<a href="#l70.19"></a><span id="l70.19"> </span>
<a href="#l70.20"></a><span id="l70.20">   visible =</span>
<a href="#l70.21"></a><span id="l70.21">     HandleLink(</span>
<a href="#l70.22"></a><span id="l70.22" class="difflineat">@@ -451,17 +451,17 @@ function DisplayCardViewPane(realCard) {</span>
<a href="#l70.23"></a><span id="l70.23">       card.getProperty(&quot;WorkCity&quot;),</span>
<a href="#l70.24"></a><span id="l70.24">       card.getProperty(&quot;WorkState&quot;),</span>
<a href="#l70.25"></a><span id="l70.25">       card.getProperty(&quot;WorkZipCode&quot;)</span>
<a href="#l70.26"></a><span id="l70.26">     ) || addressVisible;</span>
<a href="#l70.27"></a><span id="l70.27">   addressVisible =</span>
<a href="#l70.28"></a><span id="l70.28">     cvSetNode(data.cvWorkCountry, card.getProperty(&quot;WorkCountry&quot;)) ||</span>
<a href="#l70.29"></a><span id="l70.29">     addressVisible;</span>
<a href="#l70.30"></a><span id="l70.30"> </span>
<a href="#l70.31"></a><span id="l70.31" class="difflineminus">-  mapURLList = data.cvWorkMapIt.firstChild;</span>
<a href="#l70.32"></a><span id="l70.32" class="difflineplus">+  mapURLList = data.cvWorkMapIt.firstElementChild;</span>
<a href="#l70.33"></a><span id="l70.33">   if (addressVisible) {</span>
<a href="#l70.34"></a><span id="l70.34">     mapURLList.initMapAddressFromCard(card, &quot;Work&quot;);</span>
<a href="#l70.35"></a><span id="l70.35">   }</span>
<a href="#l70.36"></a><span id="l70.36"> </span>
<a href="#l70.37"></a><span id="l70.37">   cvSetVisible(data.cvbWorkMapItBox, addressVisible &amp;&amp; !!mapURLList.mapURL);</span>
<a href="#l70.38"></a><span id="l70.38"> </span>
<a href="#l70.39"></a><span id="l70.39">   visible =</span>
<a href="#l70.40"></a><span id="l70.40">     HandleLink(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l71.1"></a><span id="l71.1" class="difflineminus">--- a/mail/components/addrbook/content/addressbook.xul</span>
<a href="#l71.2"></a><span id="l71.2" class="difflineplus">+++ b/mail/components/addrbook/content/addressbook.xul</span>
<a href="#l71.3"></a><span id="l71.3" class="difflineat">@@ -836,17 +836,17 @@</span>
<a href="#l71.4"></a><span id="l71.4">                         &lt;description class=&quot;CardViewText&quot; id=&quot;cvHomeAddress2&quot;/&gt;</span>
<a href="#l71.5"></a><span id="l71.5">                         &lt;description class=&quot;CardViewText&quot; id=&quot;cvHomeCityStZip&quot;/&gt;</span>
<a href="#l71.6"></a><span id="l71.6">                         &lt;description class=&quot;CardViewText&quot; id=&quot;cvHomeCountry&quot;/&gt;</span>
<a href="#l71.7"></a><span id="l71.7">                       &lt;/vbox&gt;</span>
<a href="#l71.8"></a><span id="l71.8">                       &lt;vbox id=&quot;cvbHomeMapItBox&quot; pack=&quot;end&quot;&gt;</span>
<a href="#l71.9"></a><span id="l71.9">                         &lt;button is=&quot;button-menu-button&quot; id=&quot;cvHomeMapIt&quot;</span>
<a href="#l71.10"></a><span id="l71.10">                                 label=&quot;&amp;mapItButton.label;&quot;</span>
<a href="#l71.11"></a><span id="l71.11">                                 type=&quot;menu-button&quot;</span>
<a href="#l71.12"></a><span id="l71.12" class="difflineminus">-                                oncommand=&quot;openLinkWithUrl(this.firstChild.mapURL);&quot;</span>
<a href="#l71.13"></a><span id="l71.13" class="difflineplus">+                                oncommand=&quot;openLinkWithUrl(this.firstElementChild.mapURL);&quot;</span>
<a href="#l71.14"></a><span id="l71.14">                                 tooltiptext=&quot;&amp;mapIt.tooltip;&quot;&gt;</span>
<a href="#l71.15"></a><span id="l71.15">                           &lt;menupopup is=&quot;map-list&quot;/&gt;</span>
<a href="#l71.16"></a><span id="l71.16">                         &lt;/button&gt;</span>
<a href="#l71.17"></a><span id="l71.17">                       &lt;/vbox&gt;</span>
<a href="#l71.18"></a><span id="l71.18">                     &lt;/hbox&gt;</span>
<a href="#l71.19"></a><span id="l71.19">                     &lt;description class=&quot;CardViewLink&quot; id=&quot;cvHomeWebPageBox&quot;&gt;</span>
<a href="#l71.20"></a><span id="l71.20">                       &lt;html:a onclick=&quot;return openLink('cvHomeWebPage');&quot; href=&quot;&quot; id=&quot;cvHomeWebPage&quot;/&gt;</span>
<a href="#l71.21"></a><span id="l71.21">                     &lt;/description&gt;</span>
<a href="#l71.22"></a><span id="l71.22" class="difflineat">@@ -905,17 +905,17 @@</span>
<a href="#l71.23"></a><span id="l71.23">                         &lt;description class=&quot;CardViewText&quot; id=&quot;cvWorkAddress2&quot;/&gt;</span>
<a href="#l71.24"></a><span id="l71.24">                         &lt;description class=&quot;CardViewText&quot; id=&quot;cvWorkCityStZip&quot;/&gt;</span>
<a href="#l71.25"></a><span id="l71.25">                         &lt;description class=&quot;CardViewText&quot; id=&quot;cvWorkCountry&quot;/&gt;</span>
<a href="#l71.26"></a><span id="l71.26">                       &lt;/vbox&gt;</span>
<a href="#l71.27"></a><span id="l71.27">                       &lt;vbox id=&quot;cvbWorkMapItBox&quot; pack=&quot;end&quot;&gt;</span>
<a href="#l71.28"></a><span id="l71.28">                         &lt;button is=&quot;button-menu-button&quot; id=&quot;cvWorkMapIt&quot;</span>
<a href="#l71.29"></a><span id="l71.29">                                 label=&quot;&amp;mapItButton.label;&quot;</span>
<a href="#l71.30"></a><span id="l71.30">                                 type=&quot;menu-button&quot;</span>
<a href="#l71.31"></a><span id="l71.31" class="difflineminus">-                                oncommand=&quot;openLinkWithUrl(this.firstChild.mapURL);&quot;</span>
<a href="#l71.32"></a><span id="l71.32" class="difflineplus">+                                oncommand=&quot;openLinkWithUrl(this.firstElementChild.mapURL);&quot;</span>
<a href="#l71.33"></a><span id="l71.33">                                 tooltiptext=&quot;&amp;mapIt.tooltip;&quot;&gt;</span>
<a href="#l71.34"></a><span id="l71.34">                           &lt;menupopup is=&quot;map-list&quot;/&gt;</span>
<a href="#l71.35"></a><span id="l71.35">                         &lt;/button&gt;</span>
<a href="#l71.36"></a><span id="l71.36">                       &lt;/vbox&gt;</span>
<a href="#l71.37"></a><span id="l71.37">                     &lt;/hbox&gt;</span>
<a href="#l71.38"></a><span id="l71.38">                     &lt;description class=&quot;CardViewLink&quot; id=&quot;cvWorkWebPageBox&quot;&gt;</span>
<a href="#l71.39"></a><span id="l71.39">                       &lt;html:a onclick=&quot;return openLink('cvWorkWebPage');&quot; href=&quot;&quot; id=&quot;cvWorkWebPage&quot;/&gt;</span>
<a href="#l71.40"></a><span id="l71.40">                     &lt;/description&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l72.1"></a><span id="l72.1" class="difflineminus">--- a/mail/components/addrbook/content/menulist-addrbooks.js</span>
<a href="#l72.2"></a><span id="l72.2" class="difflineplus">+++ b/mail/components/addrbook/content/menulist-addrbooks.js</span>
<a href="#l72.3"></a><span id="l72.3" class="difflineat">@@ -55,21 +55,21 @@ if (!customElements.get(&quot;menulist&quot;)) {</span>
<a href="#l72.4"></a><span id="l72.4">                 break;</span>
<a href="#l72.5"></a><span id="l72.5">               }</span>
<a href="#l72.6"></a><span id="l72.6">             }</span>
<a href="#l72.7"></a><span id="l72.7">             if (index != -1) {</span>
<a href="#l72.8"></a><span id="l72.8">               this._directories.splice(index, 1);</span>
<a href="#l72.9"></a><span id="l72.9">               // Are we removing the selected directory?</span>
<a href="#l72.10"></a><span id="l72.10">               if (</span>
<a href="#l72.11"></a><span id="l72.11">                 this.selectedItem ==</span>
<a href="#l72.12"></a><span id="l72.12" class="difflineminus">-                this.menupopup.removeChild(this.menupopup.childNodes[index])</span>
<a href="#l72.13"></a><span id="l72.13" class="difflineplus">+                this.menupopup.removeChild(this.menupopup.children[index])</span>
<a href="#l72.14"></a><span id="l72.14">               ) {</span>
<a href="#l72.15"></a><span id="l72.15">                 // If so, try to select the first directory, if available.</span>
<a href="#l72.16"></a><span id="l72.16">                 if (this.menupopup.hasChildNodes()) {</span>
<a href="#l72.17"></a><span id="l72.17" class="difflineminus">-                  this.menupopup.firstChild.doCommand();</span>
<a href="#l72.18"></a><span id="l72.18" class="difflineplus">+                  this.menupopup.firstElementChild.doCommand();</span>
<a href="#l72.19"></a><span id="l72.19">                 } else {</span>
<a href="#l72.20"></a><span id="l72.20">                   this.selectedItem = null;</span>
<a href="#l72.21"></a><span id="l72.21">                 }</span>
<a href="#l72.22"></a><span id="l72.22">               }</span>
<a href="#l72.23"></a><span id="l72.23">             }</span>
<a href="#l72.24"></a><span id="l72.24">           }</span>
<a href="#l72.25"></a><span id="l72.25">         },</span>
<a href="#l72.26"></a><span id="l72.26"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l73.1"></a><span id="l73.1" class="difflineminus">--- a/mail/components/compose/content/ComposerCommands.js</span>
<a href="#l73.2"></a><span id="l73.2" class="difflineplus">+++ b/mail/components/compose/content/ComposerCommands.js</span>
<a href="#l73.3"></a><span id="l73.3" class="difflineat">@@ -326,18 +326,18 @@ function goUpdateCommandState(command) {</span>
<a href="#l73.4"></a><span id="l73.4">   } catch (e) {</span>
<a href="#l73.5"></a><span id="l73.5">     Cu.reportError(e);</span>
<a href="#l73.6"></a><span id="l73.6">   }</span>
<a href="#l73.7"></a><span id="l73.7"> }</span>
<a href="#l73.8"></a><span id="l73.8"> /* eslint-enable complexity */</span>
<a href="#l73.9"></a><span id="l73.9"> </span>
<a href="#l73.10"></a><span id="l73.10"> function goUpdateComposerMenuItems(commandset) {</span>
<a href="#l73.11"></a><span id="l73.11">   // dump(&quot;Updating commands for &quot; + commandset.id + &quot;\n&quot;);</span>
<a href="#l73.12"></a><span id="l73.12" class="difflineminus">-  for (var i = 0; i &lt; commandset.childNodes.length; i++) {</span>
<a href="#l73.13"></a><span id="l73.13" class="difflineminus">-    var commandNode = commandset.childNodes[i];</span>
<a href="#l73.14"></a><span id="l73.14" class="difflineplus">+  for (var i = 0; i &lt; commandset.children.length; i++) {</span>
<a href="#l73.15"></a><span id="l73.15" class="difflineplus">+    var commandNode = commandset.children[i];</span>
<a href="#l73.16"></a><span id="l73.16">     var commandID = commandNode.id;</span>
<a href="#l73.17"></a><span id="l73.17">     if (commandID) {</span>
<a href="#l73.18"></a><span id="l73.18">       goUpdateCommand(commandID); // enable or disable</span>
<a href="#l73.19"></a><span id="l73.19">       if (commandNode.hasAttribute(&quot;state&quot;)) {</span>
<a href="#l73.20"></a><span id="l73.20">         goUpdateCommandState(commandID);</span>
<a href="#l73.21"></a><span id="l73.21">       }</span>
<a href="#l73.22"></a><span id="l73.22">     }</span>
<a href="#l73.23"></a><span id="l73.23">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l74.1"></a><span id="l74.1" class="difflineminus">--- a/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l74.2"></a><span id="l74.2" class="difflineplus">+++ b/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l74.3"></a><span id="l74.3" class="difflineat">@@ -456,20 +456,21 @@ var stateListener = {</span>
<a href="#l74.4"></a><span id="l74.4">       // Check for &quot;empty&quot; body before allowing paragraph to be inserted.</span>
<a href="#l74.5"></a><span id="l74.5">       // Non-empty bodies in a new message can occur when clicking on a</span>
<a href="#l74.6"></a><span id="l74.6">       // mailto link or when using the command line option -compose.</span>
<a href="#l74.7"></a><span id="l74.7">       // An &quot;empty&quot; body can be one of these two cases:</span>
<a href="#l74.8"></a><span id="l74.8">       // 1) &lt;br&gt; and nothing follows (no next sibling)</span>
<a href="#l74.9"></a><span id="l74.9">       // 2) &lt;div/pre class=&quot;moz-signature&quot;&gt;</span>
<a href="#l74.10"></a><span id="l74.10">       // Note that &lt;br&gt;&lt;div/pre class=&quot;moz-signature&quot;&gt; doesn't happen in</span>
<a href="#l74.11"></a><span id="l74.11">       // paragraph mode.</span>
<a href="#l74.12"></a><span id="l74.12" class="difflineminus">-      let firstChild = mailBody.firstChild;</span>
<a href="#l74.13"></a><span id="l74.13" class="difflineplus">+      let firstElementChild = mailBody.firstElementChild;</span>
<a href="#l74.14"></a><span id="l74.14">       if (</span>
<a href="#l74.15"></a><span id="l74.15" class="difflineminus">-        (firstChild.nodeName != &quot;BR&quot; || firstChild.nextSibling) &amp;&amp;</span>
<a href="#l74.16"></a><span id="l74.16" class="difflineminus">-        !isSignature(firstChild)</span>
<a href="#l74.17"></a><span id="l74.17" class="difflineplus">+        (firstElementChild.nodeName != &quot;BR&quot; ||</span>
<a href="#l74.18"></a><span id="l74.18" class="difflineplus">+          firstElementChild.nextElementSibling) &amp;&amp;</span>
<a href="#l74.19"></a><span id="l74.19" class="difflineplus">+        !isSignature(firstElementChild)</span>
<a href="#l74.20"></a><span id="l74.20">       ) {</span>
<a href="#l74.21"></a><span id="l74.21">         insertParagraph = false;</span>
<a href="#l74.22"></a><span id="l74.22">       }</span>
<a href="#l74.23"></a><span id="l74.23">     }</span>
<a href="#l74.24"></a><span id="l74.24"> </span>
<a href="#l74.25"></a><span id="l74.25">     // Control insertion of line breaks.</span>
<a href="#l74.26"></a><span id="l74.26">     if (insertParagraph) {</span>
<a href="#l74.27"></a><span id="l74.27">       let editor = GetCurrentEditor();</span>
<a href="#l74.28"></a><span id="l74.28" class="difflineat">@@ -496,17 +497,17 @@ var stateListener = {</span>
<a href="#l74.29"></a><span id="l74.29">       &quot;mail.compose.default_to_paragraph&quot;</span>
<a href="#l74.30"></a><span id="l74.30">     );</span>
<a href="#l74.31"></a><span id="l74.31">     if (gMsgCompose.composeHTML &amp;&amp; useParagraph) {</span>
<a href="#l74.32"></a><span id="l74.32">       let mailBody = getBrowser().contentDocument.querySelector(&quot;body&quot;);</span>
<a href="#l74.33"></a><span id="l74.33">       let editor = GetCurrentEditor();</span>
<a href="#l74.34"></a><span id="l74.34">       let selection = editor.selection;</span>
<a href="#l74.35"></a><span id="l74.35"> </span>
<a href="#l74.36"></a><span id="l74.36">       // Make sure the selection isn't inside the signature.</span>
<a href="#l74.37"></a><span id="l74.37" class="difflineminus">-      if (isSignature(mailBody.firstChild)) {</span>
<a href="#l74.38"></a><span id="l74.38" class="difflineplus">+      if (isSignature(mailBody.firstElementChild)) {</span>
<a href="#l74.39"></a><span id="l74.39">         selection.collapse(mailBody, 0);</span>
<a href="#l74.40"></a><span id="l74.40">       }</span>
<a href="#l74.41"></a><span id="l74.41"> </span>
<a href="#l74.42"></a><span id="l74.42">       let range = selection.getRangeAt(0);</span>
<a href="#l74.43"></a><span id="l74.43">       let start = range.startOffset;</span>
<a href="#l74.44"></a><span id="l74.44"> </span>
<a href="#l74.45"></a><span id="l74.45">       if (start != range.endOffset) {</span>
<a href="#l74.46"></a><span id="l74.46">         // The selection is not collapsed, most likely due to the</span>
<a href="#l74.47"></a><span id="l74.47" class="difflineat">@@ -1595,17 +1596,20 @@ function updateSendCommands(aHaveControl</span>
<a href="#l74.48"></a><span id="l74.48"> }</span>
<a href="#l74.49"></a><span id="l74.49"> </span>
<a href="#l74.50"></a><span id="l74.50"> function addAttachCloudMenuItems(aParentMenu) {</span>
<a href="#l74.51"></a><span id="l74.51">   while (aParentMenu.hasChildNodes()) {</span>
<a href="#l74.52"></a><span id="l74.52">     aParentMenu.lastChild.remove();</span>
<a href="#l74.53"></a><span id="l74.53">   }</span>
<a href="#l74.54"></a><span id="l74.54"> </span>
<a href="#l74.55"></a><span id="l74.55">   for (let account of cloudFileAccounts.configuredAccounts) {</span>
<a href="#l74.56"></a><span id="l74.56" class="difflineminus">-    if (aParentMenu.lastChild &amp;&amp; aParentMenu.lastChild.cloudFileUpload) {</span>
<a href="#l74.57"></a><span id="l74.57" class="difflineplus">+    if (</span>
<a href="#l74.58"></a><span id="l74.58" class="difflineplus">+      aParentMenu.lastElementChild &amp;&amp;</span>
<a href="#l74.59"></a><span id="l74.59" class="difflineplus">+      aParentMenu.lastElementChild.cloudFileUpload</span>
<a href="#l74.60"></a><span id="l74.60" class="difflineplus">+    ) {</span>
<a href="#l74.61"></a><span id="l74.61">       aParentMenu.appendChild(document.createXULElement(&quot;menuseparator&quot;));</span>
<a href="#l74.62"></a><span id="l74.62">     }</span>
<a href="#l74.63"></a><span id="l74.63"> </span>
<a href="#l74.64"></a><span id="l74.64">     let item = document.createXULElement(&quot;menuitem&quot;);</span>
<a href="#l74.65"></a><span id="l74.65">     let iconURL = account.iconURL;</span>
<a href="#l74.66"></a><span id="l74.66">     item.cloudFileAccount = account;</span>
<a href="#l74.67"></a><span id="l74.67">     item.setAttribute(</span>
<a href="#l74.68"></a><span id="l74.68">       &quot;label&quot;,</span>
<a href="#l74.69"></a><span id="l74.69" class="difflineat">@@ -1636,18 +1640,18 @@ function addAttachCloudMenuItems(aParent</span>
<a href="#l74.70"></a><span id="l74.70">       aParentMenu.appendChild(fileItem);</span>
<a href="#l74.71"></a><span id="l74.71">     }</span>
<a href="#l74.72"></a><span id="l74.72">   }</span>
<a href="#l74.73"></a><span id="l74.73"> }</span>
<a href="#l74.74"></a><span id="l74.74"> </span>
<a href="#l74.75"></a><span id="l74.75"> function addConvertCloudMenuItems(aParentMenu, aAfterNodeId, aRadioGroup) {</span>
<a href="#l74.76"></a><span id="l74.76">   let attachment = document.getElementById(&quot;attachmentBucket&quot;).selectedItem;</span>
<a href="#l74.77"></a><span id="l74.77">   let afterNode = document.getElementById(aAfterNodeId);</span>
<a href="#l74.78"></a><span id="l74.78" class="difflineminus">-  while (afterNode.nextSibling) {</span>
<a href="#l74.79"></a><span id="l74.79" class="difflineminus">-    afterNode.nextSibling.remove();</span>
<a href="#l74.80"></a><span id="l74.80" class="difflineplus">+  while (afterNode.nextElementSibling) {</span>
<a href="#l74.81"></a><span id="l74.81" class="difflineplus">+    afterNode.nextElementSibling.remove();</span>
<a href="#l74.82"></a><span id="l74.82">   }</span>
<a href="#l74.83"></a><span id="l74.83"> </span>
<a href="#l74.84"></a><span id="l74.84">   if (!attachment.sendViaCloud) {</span>
<a href="#l74.85"></a><span id="l74.85">     let item = document.getElementById(</span>
<a href="#l74.86"></a><span id="l74.86">       &quot;convertCloudMenuItems_popup_convertAttachment&quot;</span>
<a href="#l74.87"></a><span id="l74.87">     );</span>
<a href="#l74.88"></a><span id="l74.88">     item.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l74.89"></a><span id="l74.89">   }</span>
<a href="#l74.90"></a><span id="l74.90" class="difflineat">@@ -2814,18 +2818,24 @@ function ComposeStartup(aParams) {</span>
<a href="#l74.91"></a><span id="l74.91">       getComposeBundle().getString(&quot;replaceButton.tooltip&quot;)</span>
<a href="#l74.92"></a><span id="l74.92">     );</span>
<a href="#l74.93"></a><span id="l74.93">     replaceButton.setAttribute(&quot;oncommand&quot;, &quot;findbarFindReplace();&quot;);</span>
<a href="#l74.94"></a><span id="l74.94"> </span>
<a href="#l74.95"></a><span id="l74.95">     let findbar = document.getElementById(&quot;FindToolbar&quot;);</span>
<a href="#l74.96"></a><span id="l74.96">     let lastButton = findbar.getElement(&quot;find-entire-word&quot;);</span>
<a href="#l74.97"></a><span id="l74.97">     let tSeparator = document.createXULElement(&quot;toolbarseparator&quot;);</span>
<a href="#l74.98"></a><span id="l74.98">     tSeparator.setAttribute(&quot;id&quot;, &quot;findbar-beforeReplaceSeparator&quot;);</span>
<a href="#l74.99"></a><span id="l74.99" class="difflineminus">-    lastButton.parentNode.insertBefore(replaceButton, lastButton.nextSibling);</span>
<a href="#l74.100"></a><span id="l74.100" class="difflineminus">-    lastButton.parentNode.insertBefore(tSeparator, lastButton.nextSibling);</span>
<a href="#l74.101"></a><span id="l74.101" class="difflineplus">+    lastButton.parentNode.insertBefore(</span>
<a href="#l74.102"></a><span id="l74.102" class="difflineplus">+      replaceButton,</span>
<a href="#l74.103"></a><span id="l74.103" class="difflineplus">+      lastButton.nextElementSibling</span>
<a href="#l74.104"></a><span id="l74.104" class="difflineplus">+    );</span>
<a href="#l74.105"></a><span id="l74.105" class="difflineplus">+    lastButton.parentNode.insertBefore(</span>
<a href="#l74.106"></a><span id="l74.106" class="difflineplus">+      tSeparator,</span>
<a href="#l74.107"></a><span id="l74.107" class="difflineplus">+      lastButton.nextElementSibling</span>
<a href="#l74.108"></a><span id="l74.108" class="difflineplus">+    );</span>
<a href="#l74.109"></a><span id="l74.109">   }</span>
<a href="#l74.110"></a><span id="l74.110"> </span>
<a href="#l74.111"></a><span id="l74.111">   var params = null; // New way to pass parameters to the compose window as a nsIMsgComposeParameters object</span>
<a href="#l74.112"></a><span id="l74.112">   var args = null; // old way, parameters are passed as a string</span>
<a href="#l74.113"></a><span id="l74.113">   gBodyFromArgs = false;</span>
<a href="#l74.114"></a><span id="l74.114"> </span>
<a href="#l74.115"></a><span id="l74.115">   if (aParams) {</span>
<a href="#l74.116"></a><span id="l74.116">     params = aParams;</span>
<a href="#l74.117"></a><span id="l74.117" class="difflineat">@@ -4458,32 +4468,32 @@ function updateLanguageInStatusBar() {</span>
<a href="#l74.118"></a><span id="l74.118">   let languageMenuList = document.getElementById(&quot;languageMenuList&quot;);</span>
<a href="#l74.119"></a><span id="l74.119">   let spellCheckStatusPanel = document.getElementById(&quot;spellCheckStatusPanel&quot;);</span>
<a href="#l74.120"></a><span id="l74.120">   let languageStatusButton = document.getElementById(&quot;languageStatusButton&quot;);</span>
<a href="#l74.121"></a><span id="l74.121">   if (!languageMenuList || !spellCheckStatusPanel || !languageStatusButton) {</span>
<a href="#l74.122"></a><span id="l74.122">     return;</span>
<a href="#l74.123"></a><span id="l74.123">   }</span>
<a href="#l74.124"></a><span id="l74.124"> </span>
<a href="#l74.125"></a><span id="l74.125">   let language = document.documentElement.getAttribute(&quot;lang&quot;);</span>
<a href="#l74.126"></a><span id="l74.126" class="difflineminus">-  let item = languageMenuList.firstChild;</span>
<a href="#l74.127"></a><span id="l74.127" class="difflineplus">+  let item = languageMenuList.firstElementChild;</span>
<a href="#l74.128"></a><span id="l74.128"> </span>
<a href="#l74.129"></a><span id="l74.129">   // No status display, if there is only one or no spelling dictionary available.</span>
<a href="#l74.130"></a><span id="l74.130" class="difflineminus">-  if (item == languageMenuList.lastChild) {</span>
<a href="#l74.131"></a><span id="l74.131" class="difflineplus">+  if (item == languageMenuList.lastElementChild) {</span>
<a href="#l74.132"></a><span id="l74.132">     spellCheckStatusPanel.collapsed = true;</span>
<a href="#l74.133"></a><span id="l74.133">     languageStatusButton.label = &quot;&quot;;</span>
<a href="#l74.134"></a><span id="l74.134">     return;</span>
<a href="#l74.135"></a><span id="l74.135">   }</span>
<a href="#l74.136"></a><span id="l74.136"> </span>
<a href="#l74.137"></a><span id="l74.137">   spellCheckStatusPanel.collapsed = false;</span>
<a href="#l74.138"></a><span id="l74.138">   while (item) {</span>
<a href="#l74.139"></a><span id="l74.139">     if (item.getAttribute(&quot;value&quot;) == language) {</span>
<a href="#l74.140"></a><span id="l74.140">       languageStatusButton.label = item.getAttribute(&quot;label&quot;);</span>
<a href="#l74.141"></a><span id="l74.141">       break;</span>
<a href="#l74.142"></a><span id="l74.142">     }</span>
<a href="#l74.143"></a><span id="l74.143" class="difflineminus">-    item = item.nextSibling;</span>
<a href="#l74.144"></a><span id="l74.144" class="difflineplus">+    item = item.nextElementSibling;</span>
<a href="#l74.145"></a><span id="l74.145">   }</span>
<a href="#l74.146"></a><span id="l74.146"> }</span>
<a href="#l74.147"></a><span id="l74.147"> </span>
<a href="#l74.148"></a><span id="l74.148"> function updateEncodingInStatusBar() {</span>
<a href="#l74.149"></a><span id="l74.149">   let encodingUIString = GetCharsetUIString();</span>
<a href="#l74.150"></a><span id="l74.150">   let encodingStatusPanel = document.getElementById(&quot;encodingStatusPanel&quot;);</span>
<a href="#l74.151"></a><span id="l74.151">   if (!encodingStatusPanel) {</span>
<a href="#l74.152"></a><span id="l74.152">     return;</span>
<a href="#l74.153"></a><span id="l74.153" class="difflineat">@@ -5486,34 +5496,36 @@ function moveSelectedAttachments(aDirect</span>
<a href="#l74.154"></a><span id="l74.154">     case &quot;down&quot;:</span>
<a href="#l74.155"></a><span id="l74.155">       // Move selected attachments upwards/downwards.</span>
<a href="#l74.156"></a><span id="l74.156">       upwards = aDirection == &quot;up&quot;;</span>
<a href="#l74.157"></a><span id="l74.157">       let blockItems = [];</span>
<a href="#l74.158"></a><span id="l74.158"> </span>
<a href="#l74.159"></a><span id="l74.159">       for (let item of selItems) {</span>
<a href="#l74.160"></a><span id="l74.160">         // Handle adjacent selected items en block, via blockItems array.</span>
<a href="#l74.161"></a><span id="l74.161">         blockItems.push(item); // Add current selItem to blockItems.</span>
<a href="#l74.162"></a><span id="l74.162" class="difflineminus">-        let nextItem = item.nextSibling;</span>
<a href="#l74.163"></a><span id="l74.163" class="difflineplus">+        let nextItem = item.nextElementSibling;</span>
<a href="#l74.164"></a><span id="l74.164">         if (!nextItem || !nextItem.selected) {</span>
<a href="#l74.165"></a><span id="l74.165">           // If current selItem is the last blockItem, check out its adjacent</span>
<a href="#l74.166"></a><span id="l74.166">           // item in the intended direction to see if there's room for moving.</span>
<a href="#l74.167"></a><span id="l74.167">           // Note that the block might contain one or more items.</span>
<a href="#l74.168"></a><span id="l74.168" class="difflineminus">-          let checkItem = upwards ? blockItems[0].previousSibling : nextItem;</span>
<a href="#l74.169"></a><span id="l74.169" class="difflineplus">+          let checkItem = upwards</span>
<a href="#l74.170"></a><span id="l74.170" class="difflineplus">+            ? blockItems[0].previousElementSibling</span>
<a href="#l74.171"></a><span id="l74.171" class="difflineplus">+            : nextItem;</span>
<a href="#l74.172"></a><span id="l74.172">           // If block-adjacent checkItem exists (and is not selected because</span>
<a href="#l74.173"></a><span id="l74.173">           // then it would be part of the block), we can move the block to the</span>
<a href="#l74.174"></a><span id="l74.174">           // right position.</span>
<a href="#l74.175"></a><span id="l74.175">           if (checkItem) {</span>
<a href="#l74.176"></a><span id="l74.176">             targetItem = upwards</span>
<a href="#l74.177"></a><span id="l74.177">               ? // Upwards: Insert block items before checkItem,</span>
<a href="#l74.178"></a><span id="l74.178" class="difflineminus">-                // i.e. before previousSibling of block.</span>
<a href="#l74.179"></a><span id="l74.179" class="difflineplus">+                // i.e. before previousElementSibling of block.</span>
<a href="#l74.180"></a><span id="l74.180">                 checkItem</span>
<a href="#l74.181"></a><span id="l74.181">               : // Downwards: Insert block items *after* checkItem,</span>
<a href="#l74.182"></a><span id="l74.182" class="difflineminus">-                // i.e. *before* nextSibling.nextSibling of block,</span>
<a href="#l74.183"></a><span id="l74.183" class="difflineplus">+                // i.e. *before* nextElementSibling.nextElementSibling of block,</span>
<a href="#l74.184"></a><span id="l74.184">                 // which works according to spec even if that's null.</span>
<a href="#l74.185"></a><span id="l74.185" class="difflineminus">-                checkItem.nextSibling;</span>
<a href="#l74.186"></a><span id="l74.186" class="difflineplus">+                checkItem.nextElementSibling;</span>
<a href="#l74.187"></a><span id="l74.187">             // Move current blockItems.</span>
<a href="#l74.188"></a><span id="l74.188">             for (let blockItem of blockItems) {</span>
<a href="#l74.189"></a><span id="l74.189">               bucket.insertBefore(blockItem, targetItem);</span>
<a href="#l74.190"></a><span id="l74.190">             }</span>
<a href="#l74.191"></a><span id="l74.191">           }</span>
<a href="#l74.192"></a><span id="l74.192">           // Else if checkItem doesn't exist, the block is already at the edge</span>
<a href="#l74.193"></a><span id="l74.193">           // of the list, so we can't move it in the intended direction.</span>
<a href="#l74.194"></a><span id="l74.194">           blockItems.length = 0; // Either way, we're done with the current block.</span>
<a href="#l74.195"></a><span id="l74.195" class="difflineat">@@ -5530,20 +5542,22 @@ function moveSelectedAttachments(aDirect</span>
<a href="#l74.196"></a><span id="l74.196">       if (bucket.getIndexOfItem(selItems[0]) == 0) {</span>
<a href="#l74.197"></a><span id="l74.197">         visibleIndex = 0;</span>
<a href="#l74.198"></a><span id="l74.198">       } else if (</span>
<a href="#l74.199"></a><span id="l74.199">         bucket.getIndexOfItem(selItems[selItems.length - 1]) ==</span>
<a href="#l74.200"></a><span id="l74.200">         bucket.itemCount - 1</span>
<a href="#l74.201"></a><span id="l74.201">       ) {</span>
<a href="#l74.202"></a><span id="l74.202">         visibleIndex = bucket.itemCount - 1;</span>
<a href="#l74.203"></a><span id="l74.203">       } else if (upwards) {</span>
<a href="#l74.204"></a><span id="l74.204" class="difflineminus">-        visibleIndex = bucket.getIndexOfItem(selItems[0].previousSibling);</span>
<a href="#l74.205"></a><span id="l74.205" class="difflineplus">+        visibleIndex = bucket.getIndexOfItem(</span>
<a href="#l74.206"></a><span id="l74.206" class="difflineplus">+          selItems[0].previousElementSibling</span>
<a href="#l74.207"></a><span id="l74.207" class="difflineplus">+        );</span>
<a href="#l74.208"></a><span id="l74.208">       } else {</span>
<a href="#l74.209"></a><span id="l74.209">         visibleIndex = bucket.getIndexOfItem(</span>
<a href="#l74.210"></a><span id="l74.210" class="difflineminus">-          selItems[selItems.length - 1].nextSibling</span>
<a href="#l74.211"></a><span id="l74.211" class="difflineplus">+          selItems[selItems.length - 1].nextElementSibling</span>
<a href="#l74.212"></a><span id="l74.212">         );</span>
<a href="#l74.213"></a><span id="l74.213">       }</span>
<a href="#l74.214"></a><span id="l74.214">       break;</span>
<a href="#l74.215"></a><span id="l74.215"> </span>
<a href="#l74.216"></a><span id="l74.216">     case &quot;top&quot;:</span>
<a href="#l74.217"></a><span id="l74.217">     case &quot;bottom&quot;:</span>
<a href="#l74.218"></a><span id="l74.218">     case &quot;bundleUp&quot;:</span>
<a href="#l74.219"></a><span id="l74.219">     case &quot;bundleDown&quot;:</span>
<a href="#l74.220"></a><span id="l74.220" class="difflineat">@@ -5564,17 +5578,17 @@ function moveSelectedAttachments(aDirect</span>
<a href="#l74.221"></a><span id="l74.221">           // Top/Bottom: Move the first/last selected item to the edge of the list</span>
<a href="#l74.222"></a><span id="l74.222">           // so that we always have an initial anchor target block in the right</span>
<a href="#l74.223"></a><span id="l74.223">           // place, so we can use the same algorithm for top/bottom and</span>
<a href="#l74.224"></a><span id="l74.224">           // inner bundling.</span>
<a href="#l74.225"></a><span id="l74.225">           targetItem = upwards</span>
<a href="#l74.226"></a><span id="l74.226">             ? // Upwards: Insert before first list item.</span>
<a href="#l74.227"></a><span id="l74.227">               listEdgeItem</span>
<a href="#l74.228"></a><span id="l74.228">             : // Downwards: Insert after last list item, i.e.</span>
<a href="#l74.229"></a><span id="l74.229" class="difflineminus">-              // *before* non-existing listEdgeItem.nextSibling,</span>
<a href="#l74.230"></a><span id="l74.230" class="difflineplus">+              // *before* non-existing listEdgeItem.nextElementSibling,</span>
<a href="#l74.231"></a><span id="l74.231">               // which is null. It works because it's a feature.</span>
<a href="#l74.232"></a><span id="l74.232">               null;</span>
<a href="#l74.233"></a><span id="l74.233">           bucket.insertBefore(selEdgeItem, targetItem);</span>
<a href="#l74.234"></a><span id="l74.234">         }</span>
<a href="#l74.235"></a><span id="l74.235">       }</span>
<a href="#l74.236"></a><span id="l74.236">       // We now have a selected block (at least one item) at the target position.</span>
<a href="#l74.237"></a><span id="l74.237">       // Let's find the end (inner edge) of that block and move only the</span>
<a href="#l74.238"></a><span id="l74.238">       // remaining selected items to avoid unnecessary moves.</span>
<a href="#l74.239"></a><span id="l74.239" class="difflineat">@@ -5587,17 +5601,19 @@ function moveSelectedAttachments(aDirect</span>
<a href="#l74.240"></a><span id="l74.240">             // Downwards: As selItems are reversed, and there's no insertAfter()</span>
<a href="#l74.241"></a><span id="l74.241">             // method to insert *after* a stable target, we need to insert</span>
<a href="#l74.242"></a><span id="l74.242">             // *before* the first item of the target block at target position,</span>
<a href="#l74.243"></a><span id="l74.243">             // which is the current selItem which we've just moved onto the block.</span>
<a href="#l74.244"></a><span id="l74.244">             targetItem = item;</span>
<a href="#l74.245"></a><span id="l74.245">           }</span>
<a href="#l74.246"></a><span id="l74.246">         } else {</span>
<a href="#l74.247"></a><span id="l74.247">           // If there's no targetItem yet, find the inner edge of the target block.</span>
<a href="#l74.248"></a><span id="l74.248" class="difflineminus">-          let nextItem = upwards ? item.nextSibling : item.previousSibling;</span>
<a href="#l74.249"></a><span id="l74.249" class="difflineplus">+          let nextItem = upwards</span>
<a href="#l74.250"></a><span id="l74.250" class="difflineplus">+            ? item.nextElementSibling</span>
<a href="#l74.251"></a><span id="l74.251" class="difflineplus">+            : item.previousElementSibling;</span>
<a href="#l74.252"></a><span id="l74.252">           if (!nextItem.selected) {</span>
<a href="#l74.253"></a><span id="l74.253">             // If nextItem is not selected, current selItem is the inner edge of</span>
<a href="#l74.254"></a><span id="l74.254">             // the initial anchor target block, so we can set targetItem.</span>
<a href="#l74.255"></a><span id="l74.255">             targetItem = upwards</span>
<a href="#l74.256"></a><span id="l74.256">               ? // Upwards: set stable targetItem.</span>
<a href="#l74.257"></a><span id="l74.257">                 nextItem</span>
<a href="#l74.258"></a><span id="l74.258">               : // Downwards: set initial targetItem.</span>
<a href="#l74.259"></a><span id="l74.259">                 item;</span>
<a href="#l74.260"></a><span id="l74.260" class="difflineat">@@ -5626,27 +5642,27 @@ function moveSelectedAttachments(aDirect</span>
<a href="#l74.261"></a><span id="l74.261">         // Sort selected attachments only.</span>
<a href="#l74.262"></a><span id="l74.262">         sortSelection = true;</span>
<a href="#l74.263"></a><span id="l74.263">         sortItems = selItems;</span>
<a href="#l74.264"></a><span id="l74.264">         // Move selected attachments together before sorting as a block.</span>
<a href="#l74.265"></a><span id="l74.265">         goDoCommand(&quot;cmd_moveAttachmentBundleUp&quot;);</span>
<a href="#l74.266"></a><span id="l74.266"> </span>
<a href="#l74.267"></a><span id="l74.267">         // Find the end of the selected block to find our targetItem.</span>
<a href="#l74.268"></a><span id="l74.268">         for (let item of selItems) {</span>
<a href="#l74.269"></a><span id="l74.269" class="difflineminus">-          let nextItem = item.nextSibling;</span>
<a href="#l74.270"></a><span id="l74.270" class="difflineplus">+          let nextItem = item.nextElementSibling;</span>
<a href="#l74.271"></a><span id="l74.271">           if (!nextItem || !nextItem.selected) {</span>
<a href="#l74.272"></a><span id="l74.272">             // If there's no nextItem (block at list bottom), or nextItem is</span>
<a href="#l74.273"></a><span id="l74.273">             // not selected, we've reached the end of the block.</span>
<a href="#l74.274"></a><span id="l74.274" class="difflineminus">-            // Set the block's nextSibling as targetItem and exit loop.</span>
<a href="#l74.275"></a><span id="l74.275" class="difflineminus">-            // Works by definition even if nextSibling aka nextItem is null.</span>
<a href="#l74.276"></a><span id="l74.276" class="difflineplus">+            // Set the block's nextElementSibling as targetItem and exit loop.</span>
<a href="#l74.277"></a><span id="l74.277" class="difflineplus">+            // Works by definition even if nextElementSibling aka nextItem is null.</span>
<a href="#l74.278"></a><span id="l74.278">             targetItem = nextItem;</span>
<a href="#l74.279"></a><span id="l74.279">             break;</span>
<a href="#l74.280"></a><span id="l74.280">           }</span>
<a href="#l74.281"></a><span id="l74.281">           // else if (nextItem &amp;&amp; nextItem.selected), nextItem is still part of</span>
<a href="#l74.282"></a><span id="l74.282" class="difflineminus">-          // the block, so proceed with checking its nextSibling.</span>
<a href="#l74.283"></a><span id="l74.283" class="difflineplus">+          // the block, so proceed with checking its nextElementSibling.</span>
<a href="#l74.284"></a><span id="l74.284">         } // next selItem</span>
<a href="#l74.285"></a><span id="l74.285">       } else {</span>
<a href="#l74.286"></a><span id="l74.286">         // Sort all attachments.</span>
<a href="#l74.287"></a><span id="l74.287">         sortSelection = false;</span>
<a href="#l74.288"></a><span id="l74.288">         sortItems = attachmentsGetSortedArray();</span>
<a href="#l74.289"></a><span id="l74.289">         targetItem = null; // Insert at the end of the list.</span>
<a href="#l74.290"></a><span id="l74.290">       }</span>
<a href="#l74.291"></a><span id="l74.291">       // Now let's sort our sortItems according to sortDirection.</span>
<a href="#l74.292"></a><span id="l74.292" class="difflineat">@@ -5656,17 +5672,17 @@ function moveSelectedAttachments(aDirect</span>
<a href="#l74.293"></a><span id="l74.293">         );</span>
<a href="#l74.294"></a><span id="l74.294">       } else {</span>
<a href="#l74.295"></a><span id="l74.295">         // &quot;descending&quot;</span>
<a href="#l74.296"></a><span id="l74.296">         sortItems.sort((a, b) =&gt;</span>
<a href="#l74.297"></a><span id="l74.297">           b.attachment.name.localeCompare(a.attachment.name)</span>
<a href="#l74.298"></a><span id="l74.298">         );</span>
<a href="#l74.299"></a><span id="l74.299">       }</span>
<a href="#l74.300"></a><span id="l74.300"> </span>
<a href="#l74.301"></a><span id="l74.301" class="difflineminus">-      // Insert sortItems in new order before the nextSibling of the block.</span>
<a href="#l74.302"></a><span id="l74.302" class="difflineplus">+      // Insert sortItems in new order before the nextElementSibling of the block.</span>
<a href="#l74.303"></a><span id="l74.303">       for (let item of sortItems) {</span>
<a href="#l74.304"></a><span id="l74.304">         bucket.insertBefore(item, targetItem);</span>
<a href="#l74.305"></a><span id="l74.305">       }</span>
<a href="#l74.306"></a><span id="l74.306"> </span>
<a href="#l74.307"></a><span id="l74.307">       if (sortSelection) {</span>
<a href="#l74.308"></a><span id="l74.308">         // After sorting selection: Ensure visibility of first selected item.</span>
<a href="#l74.309"></a><span id="l74.309">         visibleIndex = bucket.getIndexOfItem(selItems[0]);</span>
<a href="#l74.310"></a><span id="l74.310">       } else {</span>
<a href="#l74.311"></a><span id="l74.311" class="difflineat">@@ -6477,64 +6493,64 @@ var envelopeDragObserver = {</span>
<a href="#l74.312"></a><span id="l74.312"> </span>
<a href="#l74.313"></a><span id="l74.313">     if (target == bucket) {</span>
<a href="#l74.314"></a><span id="l74.314">       // Dragging or dropping at top/bottom border of the listbox</span>
<a href="#l74.315"></a><span id="l74.315">       if (</span>
<a href="#l74.316"></a><span id="l74.316">         (aEvent.screenY - target.screenY) /</span>
<a href="#l74.317"></a><span id="l74.317">           target.getBoundingClientRect().height &lt;</span>
<a href="#l74.318"></a><span id="l74.318">         0.5</span>
<a href="#l74.319"></a><span id="l74.319">       ) {</span>
<a href="#l74.320"></a><span id="l74.320" class="difflineminus">-        target = bucket.firstChild;</span>
<a href="#l74.321"></a><span id="l74.321" class="difflineplus">+        target = bucket.firstElementChild;</span>
<a href="#l74.322"></a><span id="l74.322">       } else {</span>
<a href="#l74.323"></a><span id="l74.323" class="difflineminus">-        target = bucket.lastChild;</span>
<a href="#l74.324"></a><span id="l74.324" class="difflineplus">+        target = bucket.lastElementChild;</span>
<a href="#l74.325"></a><span id="l74.325">       }</span>
<a href="#l74.326"></a><span id="l74.326">       // We'll check below if this is a valid target.</span>
<a href="#l74.327"></a><span id="l74.327">     } else if (target.id == &quot;attachmentBucketCount&quot;) {</span>
<a href="#l74.328"></a><span id="l74.328">       // Dragging or dropping at top border of the listbox.</span>
<a href="#l74.329"></a><span id="l74.329">       // Allow bottom half of attachment list header as extended drop target</span>
<a href="#l74.330"></a><span id="l74.330">       // for top of list, because otherwise it would be too small.</span>
<a href="#l74.331"></a><span id="l74.331">       if (</span>
<a href="#l74.332"></a><span id="l74.332">         (aEvent.screenY - target.screenY) /</span>
<a href="#l74.333"></a><span id="l74.333">           target.getBoundingClientRect().height &gt;=</span>
<a href="#l74.334"></a><span id="l74.334">         0.5</span>
<a href="#l74.335"></a><span id="l74.335">       ) {</span>
<a href="#l74.336"></a><span id="l74.336" class="difflineminus">-        target = bucket.firstChild;</span>
<a href="#l74.337"></a><span id="l74.337" class="difflineplus">+        target = bucket.firstElementChild;</span>
<a href="#l74.338"></a><span id="l74.338">         // We'll check below if this is a valid target.</span>
<a href="#l74.339"></a><span id="l74.339">       } else {</span>
<a href="#l74.340"></a><span id="l74.340">         // Top half of attachment list header: sorry, can't drop here.</span>
<a href="#l74.341"></a><span id="l74.341">         return &quot;none&quot;;</span>
<a href="#l74.342"></a><span id="l74.342">       }</span>
<a href="#l74.343"></a><span id="l74.343">     }</span>
<a href="#l74.344"></a><span id="l74.344"> </span>
<a href="#l74.345"></a><span id="l74.345">     // Target is an attachmentitem.</span>
<a href="#l74.346"></a><span id="l74.346">     if (target.matches(&quot;richlistitem.attachmentItem&quot;)) {</span>
<a href="#l74.347"></a><span id="l74.347">       // If we're dragging/dropping in bottom half of attachmentitem,</span>
<a href="#l74.348"></a><span id="l74.348" class="difflineminus">-      // adjust target to target.nextSibling (to show dropmarker above that).</span>
<a href="#l74.349"></a><span id="l74.349" class="difflineplus">+      // adjust target to target.nextElementSibling (to show dropmarker above that).</span>
<a href="#l74.350"></a><span id="l74.350">       if (</span>
<a href="#l74.351"></a><span id="l74.351">         (aEvent.screenY - target.screenY) /</span>
<a href="#l74.352"></a><span id="l74.352">           target.getBoundingClientRect().height &gt;=</span>
<a href="#l74.353"></a><span id="l74.353">         0.5</span>
<a href="#l74.354"></a><span id="l74.354">       ) {</span>
<a href="#l74.355"></a><span id="l74.355" class="difflineminus">-        target = target.nextSibling;</span>
<a href="#l74.356"></a><span id="l74.356" class="difflineminus">-</span>
<a href="#l74.357"></a><span id="l74.357" class="difflineminus">-        // If there's no target.nextSibling, we're dragging/dropping</span>
<a href="#l74.358"></a><span id="l74.358" class="difflineplus">+        target = target.nextElementSibling;</span>
<a href="#l74.359"></a><span id="l74.359" class="difflineplus">+</span>
<a href="#l74.360"></a><span id="l74.360" class="difflineplus">+        // If there's no target.nextElementSibling, we're dragging/dropping</span>
<a href="#l74.361"></a><span id="l74.361">         // to the bottom of the list.</span>
<a href="#l74.362"></a><span id="l74.362">         if (!target) {</span>
<a href="#l74.363"></a><span id="l74.363">           // We can't move a bottom block selection to the bottom.</span>
<a href="#l74.364"></a><span id="l74.364">           if (attachmentsSelectionIsBlock(&quot;bottom&quot;)) {</span>
<a href="#l74.365"></a><span id="l74.365">             return &quot;none&quot;;</span>
<a href="#l74.366"></a><span id="l74.366">           }</span>
<a href="#l74.367"></a><span id="l74.367"> </span>
<a href="#l74.368"></a><span id="l74.368">           // Not a bottom block selection: Target is *after* the last item.</span>
<a href="#l74.369"></a><span id="l74.369">           return &quot;afterLastItem&quot;;</span>
<a href="#l74.370"></a><span id="l74.370">         }</span>
<a href="#l74.371"></a><span id="l74.371">       }</span>
<a href="#l74.372"></a><span id="l74.372">       // Check if the adjusted target attachmentitem is a valid target.</span>
<a href="#l74.373"></a><span id="l74.373">       let isBlock = attachmentsSelectionIsBlock();</span>
<a href="#l74.374"></a><span id="l74.374" class="difflineminus">-      let prevItem = target.previousSibling;</span>
<a href="#l74.375"></a><span id="l74.375" class="difflineplus">+      let prevItem = target.previousElementSibling;</span>
<a href="#l74.376"></a><span id="l74.376">       // If target is first list item, there's no previous sibling;</span>
<a href="#l74.377"></a><span id="l74.377">       // treat like unselected previous sibling.</span>
<a href="#l74.378"></a><span id="l74.378">       let prevSelected = prevItem ? prevItem.selected : false;</span>
<a href="#l74.379"></a><span id="l74.379">       if (</span>
<a href="#l74.380"></a><span id="l74.380">         (target.selected &amp;&amp; (isBlock || prevSelected)) ||</span>
<a href="#l74.381"></a><span id="l74.381">         // target at end of block selection</span>
<a href="#l74.382"></a><span id="l74.382">         (isBlock &amp;&amp; prevSelected)</span>
<a href="#l74.383"></a><span id="l74.383">       ) {</span>
<a href="#l74.384"></a><span id="l74.384" class="difflineat">@@ -6554,17 +6570,17 @@ var envelopeDragObserver = {</span>
<a href="#l74.385"></a><span id="l74.385">     let oldDropMarkerItem = bucket.querySelector(</span>
<a href="#l74.386"></a><span id="l74.386">       &quot;richlistitem.attachmentItem[dropOn]&quot;</span>
<a href="#l74.387"></a><span id="l74.387">     );</span>
<a href="#l74.388"></a><span id="l74.388">     if (oldDropMarkerItem) {</span>
<a href="#l74.389"></a><span id="l74.389">       oldDropMarkerItem.removeAttribute(&quot;dropOn&quot;);</span>
<a href="#l74.390"></a><span id="l74.390">     }</span>
<a href="#l74.391"></a><span id="l74.391"> </span>
<a href="#l74.392"></a><span id="l74.392">     if (targetItem == &quot;afterLastItem&quot;) {</span>
<a href="#l74.393"></a><span id="l74.393" class="difflineminus">-      targetItem = bucket.lastChild;</span>
<a href="#l74.394"></a><span id="l74.394" class="difflineplus">+      targetItem = bucket.lastElementChild;</span>
<a href="#l74.395"></a><span id="l74.395">       targetItem.setAttribute(&quot;dropOn&quot;, &quot;bottom&quot;);</span>
<a href="#l74.396"></a><span id="l74.396">     } else {</span>
<a href="#l74.397"></a><span id="l74.397">       targetItem.setAttribute(&quot;dropOn&quot;, &quot;top&quot;);</span>
<a href="#l74.398"></a><span id="l74.398">     }</span>
<a href="#l74.399"></a><span id="l74.399">   },</span>
<a href="#l74.400"></a><span id="l74.400"> </span>
<a href="#l74.401"></a><span id="l74.401">   _hideDropMarker() {</span>
<a href="#l74.402"></a><span id="l74.402">     let oldDropMarkerItem = document</span>
<a href="#l74.403"></a><span id="l74.403" class="difflineat">@@ -6605,17 +6621,17 @@ var envelopeDragObserver = {</span>
<a href="#l74.404"></a><span id="l74.404">           blockItems.push(item);</span>
<a href="#l74.405"></a><span id="l74.405">           if (target == &quot;afterLastItem&quot;) {</span>
<a href="#l74.406"></a><span id="l74.406">             // Original target is the end of the list; append all items there.</span>
<a href="#l74.407"></a><span id="l74.407">             bucket.appendChild(item);</span>
<a href="#l74.408"></a><span id="l74.408">           } else if (target == selItems[0]) {</span>
<a href="#l74.409"></a><span id="l74.409">             // Original target is first item of first selected block.</span>
<a href="#l74.410"></a><span id="l74.410">             if (blockItems.includes(target)) {</span>
<a href="#l74.411"></a><span id="l74.411">               // Item is in first block: do nothing, find the end of the block.</span>
<a href="#l74.412"></a><span id="l74.412" class="difflineminus">-              let nextItem = item.nextSibling;</span>
<a href="#l74.413"></a><span id="l74.413" class="difflineplus">+              let nextItem = item.nextElementSibling;</span>
<a href="#l74.414"></a><span id="l74.414">               if (!nextItem || !nextItem.selected) {</span>
<a href="#l74.415"></a><span id="l74.415">                 // We've reached the end of the first block.</span>
<a href="#l74.416"></a><span id="l74.416">                 blockItems.length = 0;</span>
<a href="#l74.417"></a><span id="l74.417">                 targetItem = nextItem;</span>
<a href="#l74.418"></a><span id="l74.418">               }</span>
<a href="#l74.419"></a><span id="l74.419">             } else {</span>
<a href="#l74.420"></a><span id="l74.420">               // Item is NOT in first block: insert before targetItem,</span>
<a href="#l74.421"></a><span id="l74.421">               // i.e. after end of first block.</span>
<a href="#l74.422"></a><span id="l74.422" class="difflineat">@@ -6625,17 +6641,17 @@ var envelopeDragObserver = {</span>
<a href="#l74.423"></a><span id="l74.423">             // Original target is not first item of first block,</span>
<a href="#l74.424"></a><span id="l74.424">             // but first item of another block.</span>
<a href="#l74.425"></a><span id="l74.425">             if (bucket.getIndexOfItem(item) &lt; bucket.getIndexOfItem(target)) {</span>
<a href="#l74.426"></a><span id="l74.426">               // Insert all items from preceding blocks before original target.</span>
<a href="#l74.427"></a><span id="l74.427">               bucket.insertBefore(item, target);</span>
<a href="#l74.428"></a><span id="l74.428">             } else if (blockItems.includes(target)) {</span>
<a href="#l74.429"></a><span id="l74.429">               // target is included in any selected block except first:</span>
<a href="#l74.430"></a><span id="l74.430">               // do nothing for that block, find its end.</span>
<a href="#l74.431"></a><span id="l74.431" class="difflineminus">-              let nextItem = item.nextSibling;</span>
<a href="#l74.432"></a><span id="l74.432" class="difflineplus">+              let nextItem = item.nextElementSibling;</span>
<a href="#l74.433"></a><span id="l74.433">               if (!nextItem || !nextItem.selected) {</span>
<a href="#l74.434"></a><span id="l74.434">                 // end of block containing target</span>
<a href="#l74.435"></a><span id="l74.435">                 blockItems.length = 0;</span>
<a href="#l74.436"></a><span id="l74.436">                 targetItem = nextItem;</span>
<a href="#l74.437"></a><span id="l74.437">               }</span>
<a href="#l74.438"></a><span id="l74.438">             } else {</span>
<a href="#l74.439"></a><span id="l74.439">               // Item from block after block containing target: insert before</span>
<a href="#l74.440"></a><span id="l74.440">               // targetItem, i.e. after end of block containing target.</span>
<a href="#l74.441"></a><span id="l74.441" class="difflineat">@@ -7739,18 +7755,18 @@ function UpdateFullZoomMenu() {</span>
<a href="#l74.442"></a><span id="l74.442">  * unfortunate; we need to maintain it since the zoom manager, view source and</span>
<a href="#l74.443"></a><span id="l74.443">  * other functions still rely on it.</span>
<a href="#l74.444"></a><span id="l74.444">  */</span>
<a href="#l74.445"></a><span id="l74.445"> function getBrowser() {</span>
<a href="#l74.446"></a><span id="l74.446">   return document.getElementById(&quot;content-frame&quot;);</span>
<a href="#l74.447"></a><span id="l74.447"> }</span>
<a href="#l74.448"></a><span id="l74.448"> </span>
<a href="#l74.449"></a><span id="l74.449"> function goUpdateMailMenuItems(commandset) {</span>
<a href="#l74.450"></a><span id="l74.450" class="difflineminus">-  for (let i = 0; i &lt; commandset.childNodes.length; i++) {</span>
<a href="#l74.451"></a><span id="l74.451" class="difflineminus">-    let commandID = commandset.childNodes[i].getAttribute(&quot;id&quot;);</span>
<a href="#l74.452"></a><span id="l74.452" class="difflineplus">+  for (let i = 0; i &lt; commandset.children.length; i++) {</span>
<a href="#l74.453"></a><span id="l74.453" class="difflineplus">+    let commandID = commandset.children[i].getAttribute(&quot;id&quot;);</span>
<a href="#l74.454"></a><span id="l74.454">     if (commandID) {</span>
<a href="#l74.455"></a><span id="l74.455">       goUpdateCommand(commandID);</span>
<a href="#l74.456"></a><span id="l74.456">     }</span>
<a href="#l74.457"></a><span id="l74.457">   }</span>
<a href="#l74.458"></a><span id="l74.458"> }</span>
<a href="#l74.459"></a><span id="l74.459"> </span>
<a href="#l74.460"></a><span id="l74.460"> /**</span>
<a href="#l74.461"></a><span id="l74.461">  * Object to handle message related notifications that are showing in a</span>
<a href="#l74.462"></a><span id="l74.462" class="difflineat">@@ -7838,17 +7854,19 @@ var gComposeNotificationBar = {</span>
<a href="#l74.463"></a><span id="l74.463">       let text = getComposeBundle()</span>
<a href="#l74.464"></a><span id="l74.464">         .getString(&quot;identityWarning&quot;)</span>
<a href="#l74.465"></a><span id="l74.465">         .split(&quot;%S&quot;);</span>
<a href="#l74.466"></a><span id="l74.466">       let label = new DocumentFragment();</span>
<a href="#l74.467"></a><span id="l74.467">       label.appendChild(document.createTextNode(text[0]));</span>
<a href="#l74.468"></a><span id="l74.468">       label.appendChild(</span>
<a href="#l74.469"></a><span id="l74.469">         document.createElementNS(&quot;http://www.w3.org/1999/xhtml&quot;, &quot;b&quot;)</span>
<a href="#l74.470"></a><span id="l74.470">       );</span>
<a href="#l74.471"></a><span id="l74.471" class="difflineminus">-      label.lastChild.appendChild(document.createTextNode(aIdentityName));</span>
<a href="#l74.472"></a><span id="l74.472" class="difflineplus">+      label.lastElementChild.appendChild(</span>
<a href="#l74.473"></a><span id="l74.473" class="difflineplus">+        document.createTextNode(aIdentityName)</span>
<a href="#l74.474"></a><span id="l74.474" class="difflineplus">+      );</span>
<a href="#l74.475"></a><span id="l74.475">       label.appendChild(document.createTextNode(text[1]));</span>
<a href="#l74.476"></a><span id="l74.476">       gNotification.notificationbox.appendNotification(</span>
<a href="#l74.477"></a><span id="l74.477">         label,</span>
<a href="#l74.478"></a><span id="l74.478">         &quot;identityWarning&quot;,</span>
<a href="#l74.479"></a><span id="l74.479">         null,</span>
<a href="#l74.480"></a><span id="l74.480">         gNotification.notificationbox.PRIORITY_WARNING_HIGH,</span>
<a href="#l74.481"></a><span id="l74.481">         null</span>
<a href="#l74.482"></a><span id="l74.482">       );</span>
<a href="#l74.483"></a><span id="l74.483" class="difflineat">@@ -7867,19 +7885,18 @@ var gComposeNotificationBar = {</span>
<a href="#l74.484"></a><span id="l74.484"> </span>
<a href="#l74.485"></a><span id="l74.485"> /**</span>
<a href="#l74.486"></a><span id="l74.486">  * Populate the menuitems of what blocked content to unblock.</span>
<a href="#l74.487"></a><span id="l74.487">  */</span>
<a href="#l74.488"></a><span id="l74.488"> function onBlockedContentOptionsShowing(aEvent) {</span>
<a href="#l74.489"></a><span id="l74.489">   let urls = aEvent.target.value ? aEvent.target.value.split(&quot; &quot;) : [];</span>
<a href="#l74.490"></a><span id="l74.490"> </span>
<a href="#l74.491"></a><span id="l74.491">   // Out with the old...</span>
<a href="#l74.492"></a><span id="l74.492" class="difflineminus">-  let childNodes = aEvent.target.childNodes;</span>
<a href="#l74.493"></a><span id="l74.493" class="difflineminus">-  for (let i = childNodes.length - 1; i &gt;= 0; i--) {</span>
<a href="#l74.494"></a><span id="l74.494" class="difflineminus">-    childNodes[i].remove();</span>
<a href="#l74.495"></a><span id="l74.495" class="difflineplus">+  while (aEvent.target.lastChild) {</span>
<a href="#l74.496"></a><span id="l74.496" class="difflineplus">+    aEvent.target.lastChild.remove();</span>
<a href="#l74.497"></a><span id="l74.497">   }</span>
<a href="#l74.498"></a><span id="l74.498"> </span>
<a href="#l74.499"></a><span id="l74.499">   // ... and in with the new.</span>
<a href="#l74.500"></a><span id="l74.500">   for (let url of urls) {</span>
<a href="#l74.501"></a><span id="l74.501">     let menuitem = document.createXULElement(&quot;menuitem&quot;);</span>
<a href="#l74.502"></a><span id="l74.502">     menuitem.setAttribute(</span>
<a href="#l74.503"></a><span id="l74.503">       &quot;label&quot;,</span>
<a href="#l74.504"></a><span id="l74.504">       getComposeBundle().getFormattedString(&quot;blockedAllowResource&quot;, [url])</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l75.1"></a><span id="l75.1" class="difflineminus">--- a/mail/components/compose/content/addressingWidgetOverlay.js</span>
<a href="#l75.2"></a><span id="l75.2" class="difflineplus">+++ b/mail/components/compose/content/addressingWidgetOverlay.js</span>
<a href="#l75.3"></a><span id="l75.3" class="difflineat">@@ -80,18 +80,18 @@ function awInitializeNumberOfRowsShown()</span>
<a href="#l75.4"></a><span id="l75.4"> }</span>
<a href="#l75.5"></a><span id="l75.5"> </span>
<a href="#l75.6"></a><span id="l75.6"> // TODO: replace awGetSelectItemIndex with recipient type index constants</span>
<a href="#l75.7"></a><span id="l75.7"> </span>
<a href="#l75.8"></a><span id="l75.8"> function awGetSelectItemIndex(itemData) {</span>
<a href="#l75.9"></a><span id="l75.9">   if (selectElementIndexTable == null) {</span>
<a href="#l75.10"></a><span id="l75.10">     selectElementIndexTable = {};</span>
<a href="#l75.11"></a><span id="l75.11">     var selectElem = document.getElementById(&quot;addressCol1#1&quot;);</span>
<a href="#l75.12"></a><span id="l75.12" class="difflineminus">-    for (var i = 0; i &lt; selectElem.menupopup.childNodes.length; i++) {</span>
<a href="#l75.13"></a><span id="l75.13" class="difflineminus">-      var aData = selectElem.menupopup.childNodes[i].getAttribute(&quot;value&quot;);</span>
<a href="#l75.14"></a><span id="l75.14" class="difflineplus">+    for (var i = 0; i &lt; selectElem.menupopup.children.length; i++) {</span>
<a href="#l75.15"></a><span id="l75.15" class="difflineplus">+      var aData = selectElem.menupopup.children[i].getAttribute(&quot;value&quot;);</span>
<a href="#l75.16"></a><span id="l75.16">       selectElementIndexTable[aData] = i;</span>
<a href="#l75.17"></a><span id="l75.17">     }</span>
<a href="#l75.18"></a><span id="l75.18">   }</span>
<a href="#l75.19"></a><span id="l75.19"> </span>
<a href="#l75.20"></a><span id="l75.20">   return selectElementIndexTable[itemData];</span>
<a href="#l75.21"></a><span id="l75.21"> }</span>
<a href="#l75.22"></a><span id="l75.22"> </span>
<a href="#l75.23"></a><span id="l75.23"> function Recipients2CompFields(msgCompFields) {</span>
<a href="#l75.24"></a><span id="l75.24" class="difflineat">@@ -288,17 +288,17 @@ function awSetInputAndPopupValue(</span>
<a href="#l75.25"></a><span id="l75.25">   popupElem,</span>
<a href="#l75.26"></a><span id="l75.26">   popupValue,</span>
<a href="#l75.27"></a><span id="l75.27">   rowNumber,</span>
<a href="#l75.28"></a><span id="l75.28">   aNotifyRecipientsChanged = true</span>
<a href="#l75.29"></a><span id="l75.29"> ) {</span>
<a href="#l75.30"></a><span id="l75.30">   inputElem.value = inputValue.trimLeft();</span>
<a href="#l75.31"></a><span id="l75.31"> </span>
<a href="#l75.32"></a><span id="l75.32">   popupElem.selectedItem =</span>
<a href="#l75.33"></a><span id="l75.33" class="difflineminus">-    popupElem.menupopup.childNodes[awGetSelectItemIndex(popupValue)];</span>
<a href="#l75.34"></a><span id="l75.34" class="difflineplus">+    popupElem.menupopup.children[awGetSelectItemIndex(popupValue)];</span>
<a href="#l75.35"></a><span id="l75.35">   // TODO: can there be a row without ID yet?</span>
<a href="#l75.36"></a><span id="l75.36">   if (rowNumber &gt;= 0) {</span>
<a href="#l75.37"></a><span id="l75.37">     awSetInputAndPopupId(inputElem, popupElem, rowNumber);</span>
<a href="#l75.38"></a><span id="l75.38">   }</span>
<a href="#l75.39"></a><span id="l75.39"> </span>
<a href="#l75.40"></a><span id="l75.40">   _awSetAutoComplete(popupElem, inputElem);</span>
<a href="#l75.41"></a><span id="l75.41"> </span>
<a href="#l75.42"></a><span id="l75.42">   if (aNotifyRecipientsChanged) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l76.1"></a><span id="l76.1" class="difflineminus">--- a/mail/components/compose/content/dialogs/EdAECSSAttributes.js</span>
<a href="#l76.2"></a><span id="l76.2" class="difflineplus">+++ b/mail/components/compose/content/dialogs/EdAECSSAttributes.js</span>
<a href="#l76.3"></a><span id="l76.3" class="difflineat">@@ -91,30 +91,30 @@ function editCSSAttributeValue(targetCel</span>
<a href="#l76.4"></a><span id="l76.4">   if (IsNotTreeHeader(targetCell)) {</span>
<a href="#l76.5"></a><span id="l76.5">     gDialog.AddCSSAttributeValueInput.select();</span>
<a href="#l76.6"></a><span id="l76.6">   }</span>
<a href="#l76.7"></a><span id="l76.7"> }</span>
<a href="#l76.8"></a><span id="l76.8"> </span>
<a href="#l76.9"></a><span id="l76.9"> function UpdateCSSAttributes() {</span>
<a href="#l76.10"></a><span id="l76.10">   var CSSAList = document.getElementById(&quot;CSSAList&quot;);</span>
<a href="#l76.11"></a><span id="l76.11">   var styleString = &quot;&quot;;</span>
<a href="#l76.12"></a><span id="l76.12" class="difflineminus">-  for (var i = 0; i &lt; CSSAList.childNodes.length; i++) {</span>
<a href="#l76.13"></a><span id="l76.13" class="difflineminus">-    var item = CSSAList.childNodes[i];</span>
<a href="#l76.14"></a><span id="l76.14" class="difflineplus">+  for (var i = 0; i &lt; CSSAList.children.length; i++) {</span>
<a href="#l76.15"></a><span id="l76.15" class="difflineplus">+    var item = CSSAList.children[i];</span>
<a href="#l76.16"></a><span id="l76.16">     var name = GetTreeItemAttributeStr(item);</span>
<a href="#l76.17"></a><span id="l76.17">     var value = GetTreeItemValueStr(item);</span>
<a href="#l76.18"></a><span id="l76.18">     // this code allows users to be sloppy in typing in values, and enter</span>
<a href="#l76.19"></a><span id="l76.19">     // things like &quot;foo: &quot; and &quot;bar;&quot;. This will trim off everything after the</span>
<a href="#l76.20"></a><span id="l76.20">     // respective character.</span>
<a href="#l76.21"></a><span id="l76.21">     if (name.includes(&quot;:&quot;)) {</span>
<a href="#l76.22"></a><span id="l76.22">       name = name.substring(0, name.lastIndexOf(&quot;:&quot;));</span>
<a href="#l76.23"></a><span id="l76.23">     }</span>
<a href="#l76.24"></a><span id="l76.24">     if (value.includes(&quot;;&quot;)) {</span>
<a href="#l76.25"></a><span id="l76.25">       value = value.substring(0, value.lastIndexOf(&quot;;&quot;));</span>
<a href="#l76.26"></a><span id="l76.26">     }</span>
<a href="#l76.27"></a><span id="l76.27" class="difflineminus">-    if (i == CSSAList.childNodes.length - 1) {</span>
<a href="#l76.28"></a><span id="l76.28" class="difflineplus">+    if (i == CSSAList.children.length - 1) {</span>
<a href="#l76.29"></a><span id="l76.29">       // Last property.</span>
<a href="#l76.30"></a><span id="l76.30">       styleString += name + &quot;: &quot; + value + &quot;;&quot;;</span>
<a href="#l76.31"></a><span id="l76.31">     } else {</span>
<a href="#l76.32"></a><span id="l76.32">       styleString += name + &quot;: &quot; + value + &quot;; &quot;;</span>
<a href="#l76.33"></a><span id="l76.33">     }</span>
<a href="#l76.34"></a><span id="l76.34">   }</span>
<a href="#l76.35"></a><span id="l76.35">   if (styleString) {</span>
<a href="#l76.36"></a><span id="l76.36">     // Use editor transactions if modifying the element directly in the document</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l77.1"></a><span id="l77.1" class="difflineminus">--- a/mail/components/compose/content/dialogs/EdAEHTMLAttributes.js</span>
<a href="#l77.2"></a><span id="l77.2" class="difflineplus">+++ b/mail/components/compose/content/dialogs/EdAEHTMLAttributes.js</span>
<a href="#l77.3"></a><span id="l77.3" class="difflineat">@@ -126,17 +126,19 @@ function onSelectHTMLTreeItem() {</span>
<a href="#l77.4"></a><span id="l77.4">   }</span>
<a href="#l77.5"></a><span id="l77.5"> </span>
<a href="#l77.6"></a><span id="l77.6">   var tree = gDialog.AddHTMLAttributeTree;</span>
<a href="#l77.7"></a><span id="l77.7">   if (tree &amp;&amp; tree.view.selection.count) {</span>
<a href="#l77.8"></a><span id="l77.8">     var inputName = TrimString(</span>
<a href="#l77.9"></a><span id="l77.9">       gDialog.AddHTMLAttributeNameInput.value</span>
<a href="#l77.10"></a><span id="l77.10">     ).toLowerCase();</span>
<a href="#l77.11"></a><span id="l77.11">     var selectedItem = getSelectedItem(tree);</span>
<a href="#l77.12"></a><span id="l77.12" class="difflineminus">-    var selectedName = selectedItem.firstChild.firstChild.getAttribute(&quot;label&quot;);</span>
<a href="#l77.13"></a><span id="l77.13" class="difflineplus">+    var selectedName = selectedItem.firstElementChild.firstElementChild.getAttribute(</span>
<a href="#l77.14"></a><span id="l77.14" class="difflineplus">+      &quot;label&quot;</span>
<a href="#l77.15"></a><span id="l77.15" class="difflineplus">+    );</span>
<a href="#l77.16"></a><span id="l77.16"> </span>
<a href="#l77.17"></a><span id="l77.17">     if (inputName == selectedName) {</span>
<a href="#l77.18"></a><span id="l77.18">       // Already editing selected name - just update the value input</span>
<a href="#l77.19"></a><span id="l77.19">       gDialog.AddHTMLAttributeValueInput.value = GetTreeItemValueStr(</span>
<a href="#l77.20"></a><span id="l77.20">         selectedItem</span>
<a href="#l77.21"></a><span id="l77.21">       );</span>
<a href="#l77.22"></a><span id="l77.22">     } else {</span>
<a href="#l77.23"></a><span id="l77.23">       gDialog.AddHTMLAttributeNameInput.value = selectedName;</span>
<a href="#l77.24"></a><span id="l77.24" class="difflineat">@@ -329,18 +331,18 @@ function UpdateHTMLAttributes() {</span>
<a href="#l77.25"></a><span id="l77.25">     var name = HTMLRAttrs[i];</span>
<a href="#l77.26"></a><span id="l77.26"> </span>
<a href="#l77.27"></a><span id="l77.27">     if (gElement.hasAttribute(name)) {</span>
<a href="#l77.28"></a><span id="l77.28">       doRemoveAttribute(name);</span>
<a href="#l77.29"></a><span id="l77.29">     }</span>
<a href="#l77.30"></a><span id="l77.30">   }</span>
<a href="#l77.31"></a><span id="l77.31"> </span>
<a href="#l77.32"></a><span id="l77.32">   // Set added or changed attributes</span>
<a href="#l77.33"></a><span id="l77.33" class="difflineminus">-  for (i = 0; i &lt; HTMLAList.childNodes.length; i++) {</span>
<a href="#l77.34"></a><span id="l77.34" class="difflineminus">-    var item = HTMLAList.childNodes[i];</span>
<a href="#l77.35"></a><span id="l77.35" class="difflineplus">+  for (i = 0; i &lt; HTMLAList.children.length; i++) {</span>
<a href="#l77.36"></a><span id="l77.36" class="difflineplus">+    var item = HTMLAList.children[i];</span>
<a href="#l77.37"></a><span id="l77.37">     doSetAttribute(GetTreeItemAttributeStr(item), GetTreeItemValueStr(item));</span>
<a href="#l77.38"></a><span id="l77.38">   }</span>
<a href="#l77.39"></a><span id="l77.39"> }</span>
<a href="#l77.40"></a><span id="l77.40"> </span>
<a href="#l77.41"></a><span id="l77.41"> function RemoveHTMLAttribute() {</span>
<a href="#l77.42"></a><span id="l77.42">   // We only allow 1 selected item</span>
<a href="#l77.43"></a><span id="l77.43">   if (gDialog.AddHTMLAttributeTree.view.selection.count) {</span>
<a href="#l77.44"></a><span id="l77.44">     var item = getSelectedItem(gDialog.AddHTMLAttributeTree);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l78.1"></a><span id="l78.1" class="difflineminus">--- a/mail/components/compose/content/dialogs/EdAEJSEAttributes.js</span>
<a href="#l78.2"></a><span id="l78.2" class="difflineplus">+++ b/mail/components/compose/content/dialogs/EdAEJSEAttributes.js</span>
<a href="#l78.3"></a><span id="l78.3" class="difflineat">@@ -28,31 +28,31 @@ function BuildJSEAttributeNameList() {</span>
<a href="#l78.4"></a><span id="l78.4"> </span>
<a href="#l78.5"></a><span id="l78.5">         return;</span>
<a href="#l78.6"></a><span id="l78.6">       }</span>
<a href="#l78.7"></a><span id="l78.7"> </span>
<a href="#l78.8"></a><span id="l78.8">       for (i = 0; i &lt; attNames.length; i++) {</span>
<a href="#l78.9"></a><span id="l78.9">         gDialog.AddJSEAttributeNameList.appendItem(attNames[i], attNames[i]);</span>
<a href="#l78.10"></a><span id="l78.10">       }</span>
<a href="#l78.11"></a><span id="l78.11"> </span>
<a href="#l78.12"></a><span id="l78.12" class="difflineminus">-      popup = gDialog.AddJSEAttributeNameList.firstChild;</span>
<a href="#l78.13"></a><span id="l78.13" class="difflineplus">+      popup = gDialog.AddJSEAttributeNameList.firstElementChild;</span>
<a href="#l78.14"></a><span id="l78.14">       if (popup) {</span>
<a href="#l78.15"></a><span id="l78.15">         sep = document.createXULElement(&quot;menuseparator&quot;);</span>
<a href="#l78.16"></a><span id="l78.16">         if (sep) {</span>
<a href="#l78.17"></a><span id="l78.17">           popup.appendChild(sep);</span>
<a href="#l78.18"></a><span id="l78.18">         }</span>
<a href="#l78.19"></a><span id="l78.19">       }</span>
<a href="#l78.20"></a><span id="l78.20">     }</span>
<a href="#l78.21"></a><span id="l78.21">   }</span>
<a href="#l78.22"></a><span id="l78.22"> </span>
<a href="#l78.23"></a><span id="l78.23">   // Always add core JS events unless we aborted above</span>
<a href="#l78.24"></a><span id="l78.24">   for (i = 0; i &lt; gCoreJSEvents.length; i++) {</span>
<a href="#l78.25"></a><span id="l78.25">     if (gCoreJSEvents[i] == &quot;-&quot;) {</span>
<a href="#l78.26"></a><span id="l78.26">       if (!popup) {</span>
<a href="#l78.27"></a><span id="l78.27" class="difflineminus">-        popup = gDialog.AddJSEAttributeNameList.firstChild;</span>
<a href="#l78.28"></a><span id="l78.28" class="difflineplus">+        popup = gDialog.AddJSEAttributeNameList.firstElementChild;</span>
<a href="#l78.29"></a><span id="l78.29">       }</span>
<a href="#l78.30"></a><span id="l78.30"> </span>
<a href="#l78.31"></a><span id="l78.31">       sep = document.createXULElement(&quot;menuseparator&quot;);</span>
<a href="#l78.32"></a><span id="l78.32"> </span>
<a href="#l78.33"></a><span id="l78.33">       if (popup &amp;&amp; sep) {</span>
<a href="#l78.34"></a><span id="l78.34">         popup.appendChild(sep);</span>
<a href="#l78.35"></a><span id="l78.35">       }</span>
<a href="#l78.36"></a><span id="l78.36">     } else {</span>
<a href="#l78.37"></a><span id="l78.37" class="difflineat">@@ -155,18 +155,18 @@ function UpdateJSEAttributes() {</span>
<a href="#l78.38"></a><span id="l78.38">     var name = JSERAttrs[i];</span>
<a href="#l78.39"></a><span id="l78.39"> </span>
<a href="#l78.40"></a><span id="l78.40">     if (gElement.hasAttribute(name)) {</span>
<a href="#l78.41"></a><span id="l78.41">       doRemoveAttribute(name);</span>
<a href="#l78.42"></a><span id="l78.42">     }</span>
<a href="#l78.43"></a><span id="l78.43">   }</span>
<a href="#l78.44"></a><span id="l78.44"> </span>
<a href="#l78.45"></a><span id="l78.45">   // Add events</span>
<a href="#l78.46"></a><span id="l78.46" class="difflineminus">-  for (i = 0; i &lt; JSEAList.childNodes.length; i++) {</span>
<a href="#l78.47"></a><span id="l78.47" class="difflineminus">-    var item = JSEAList.childNodes[i];</span>
<a href="#l78.48"></a><span id="l78.48" class="difflineplus">+  for (i = 0; i &lt; JSEAList.children.length; i++) {</span>
<a href="#l78.49"></a><span id="l78.49" class="difflineplus">+    var item = JSEAList.children[i];</span>
<a href="#l78.50"></a><span id="l78.50"> </span>
<a href="#l78.51"></a><span id="l78.51">     // set the event handler</span>
<a href="#l78.52"></a><span id="l78.52">     doSetAttribute(GetTreeItemAttributeStr(item), GetTreeItemValueStr(item));</span>
<a href="#l78.53"></a><span id="l78.53">   }</span>
<a href="#l78.54"></a><span id="l78.54"> }</span>
<a href="#l78.55"></a><span id="l78.55"> </span>
<a href="#l78.56"></a><span id="l78.56"> function RemoveJSEAttribute() {</span>
<a href="#l78.57"></a><span id="l78.57">   // This differs from HTML and CSS panels:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l79.1"></a><span id="l79.1" class="difflineminus">--- a/mail/components/compose/content/dialogs/EdAdvancedEdit.js</span>
<a href="#l79.2"></a><span id="l79.2" class="difflineplus">+++ b/mail/components/compose/content/dialogs/EdAdvancedEdit.js</span>
<a href="#l79.3"></a><span id="l79.3" class="difflineat">@@ -186,18 +186,18 @@ function UpdateExistingAttribute(attName</span>
<a href="#l79.4"></a><span id="l79.4">     return false;</span>
<a href="#l79.5"></a><span id="l79.5">   }</span>
<a href="#l79.6"></a><span id="l79.6"> </span>
<a href="#l79.7"></a><span id="l79.7">   var name;</span>
<a href="#l79.8"></a><span id="l79.8">   var i;</span>
<a href="#l79.9"></a><span id="l79.9">   attName = TrimString(attName).toLowerCase();</span>
<a href="#l79.10"></a><span id="l79.10">   attValue = TrimString(attValue);</span>
<a href="#l79.11"></a><span id="l79.11"> </span>
<a href="#l79.12"></a><span id="l79.12" class="difflineminus">-  for (i = 0; i &lt; treeChildren.childNodes.length; i++) {</span>
<a href="#l79.13"></a><span id="l79.13" class="difflineminus">-    var item = treeChildren.childNodes[i];</span>
<a href="#l79.14"></a><span id="l79.14" class="difflineplus">+  for (i = 0; i &lt; treeChildren.children.length; i++) {</span>
<a href="#l79.15"></a><span id="l79.15" class="difflineplus">+    var item = treeChildren.children[i];</span>
<a href="#l79.16"></a><span id="l79.16">     name = GetTreeItemAttributeStr(item);</span>
<a href="#l79.17"></a><span id="l79.17">     if (name.toLowerCase() == attName) {</span>
<a href="#l79.18"></a><span id="l79.18">       // Set the text in the &quot;value' column treecell</span>
<a href="#l79.19"></a><span id="l79.19">       SetTreeItemValueStr(item, attValue);</span>
<a href="#l79.20"></a><span id="l79.20"> </span>
<a href="#l79.21"></a><span id="l79.21">       // Select item just changed,</span>
<a href="#l79.22"></a><span id="l79.22">       //  but don't trigger the tree's onSelect handler</span>
<a href="#l79.23"></a><span id="l79.23">       gDoOnSelectTree = false;</span>
<a href="#l79.24"></a><span id="l79.24" class="difflineat">@@ -221,18 +221,18 @@ function GetAndSelectExistingAttributeVa</span>
<a href="#l79.25"></a><span id="l79.25">   if (!attName) {</span>
<a href="#l79.26"></a><span id="l79.26">     return &quot;&quot;;</span>
<a href="#l79.27"></a><span id="l79.27">   }</span>
<a href="#l79.28"></a><span id="l79.28"> </span>
<a href="#l79.29"></a><span id="l79.29">   var treeChildren = document.getElementById(treeChildrenId);</span>
<a href="#l79.30"></a><span id="l79.30">   var name;</span>
<a href="#l79.31"></a><span id="l79.31">   var i;</span>
<a href="#l79.32"></a><span id="l79.32"> </span>
<a href="#l79.33"></a><span id="l79.33" class="difflineminus">-  for (i = 0; i &lt; treeChildren.childNodes.length; i++) {</span>
<a href="#l79.34"></a><span id="l79.34" class="difflineminus">-    var item = treeChildren.childNodes[i];</span>
<a href="#l79.35"></a><span id="l79.35" class="difflineplus">+  for (i = 0; i &lt; treeChildren.children.length; i++) {</span>
<a href="#l79.36"></a><span id="l79.36" class="difflineplus">+    var item = treeChildren.children[i];</span>
<a href="#l79.37"></a><span id="l79.37">     name = GetTreeItemAttributeStr(item);</span>
<a href="#l79.38"></a><span id="l79.38">     if (name.toLowerCase() == attName.toLowerCase()) {</span>
<a href="#l79.39"></a><span id="l79.39">       // Select item in the tree</span>
<a href="#l79.40"></a><span id="l79.40">       //  but don't trigger the tree's onSelect handler</span>
<a href="#l79.41"></a><span id="l79.41">       gDoOnSelectTree = false;</span>
<a href="#l79.42"></a><span id="l79.42">       try {</span>
<a href="#l79.43"></a><span id="l79.43">         selectTreeItem(treeChildren, item);</span>
<a href="#l79.44"></a><span id="l79.44">       } catch (e) {}</span>
<a href="#l79.45"></a><span id="l79.45" class="difflineat">@@ -256,33 +256,37 @@ function GetAndSelectExistingAttributeVa</span>
<a href="#l79.46"></a><span id="l79.46"> /* Tree structure:</span>
<a href="#l79.47"></a><span id="l79.47">   &lt;treeItem&gt;</span>
<a href="#l79.48"></a><span id="l79.48">     &lt;treeRow&gt;</span>
<a href="#l79.49"></a><span id="l79.49">       &lt;treeCell&gt; // Name Cell</span>
<a href="#l79.50"></a><span id="l79.50">       &lt;treeCell  // Value Cell</span>
<a href="#l79.51"></a><span id="l79.51"> */</span>
<a href="#l79.52"></a><span id="l79.52"> function GetTreeItemAttributeStr(treeItem) {</span>
<a href="#l79.53"></a><span id="l79.53">   if (treeItem) {</span>
<a href="#l79.54"></a><span id="l79.54" class="difflineminus">-    return TrimString(treeItem.firstChild.firstChild.getAttribute(&quot;label&quot;));</span>
<a href="#l79.55"></a><span id="l79.55" class="difflineplus">+    return TrimString(</span>
<a href="#l79.56"></a><span id="l79.56" class="difflineplus">+      treeItem.firstElementChild.firstElementChild.getAttribute(&quot;label&quot;)</span>
<a href="#l79.57"></a><span id="l79.57" class="difflineplus">+    );</span>
<a href="#l79.58"></a><span id="l79.58">   }</span>
<a href="#l79.59"></a><span id="l79.59"> </span>
<a href="#l79.60"></a><span id="l79.60">   return &quot;&quot;;</span>
<a href="#l79.61"></a><span id="l79.61"> }</span>
<a href="#l79.62"></a><span id="l79.62"> </span>
<a href="#l79.63"></a><span id="l79.63"> function GetTreeItemValueStr(treeItem) {</span>
<a href="#l79.64"></a><span id="l79.64">   if (treeItem) {</span>
<a href="#l79.65"></a><span id="l79.65" class="difflineminus">-    return TrimString(treeItem.firstChild.lastChild.getAttribute(&quot;label&quot;));</span>
<a href="#l79.66"></a><span id="l79.66" class="difflineplus">+    return TrimString(</span>
<a href="#l79.67"></a><span id="l79.67" class="difflineplus">+      treeItem.firstElementChild.lastElementChild.getAttribute(&quot;label&quot;)</span>
<a href="#l79.68"></a><span id="l79.68" class="difflineplus">+    );</span>
<a href="#l79.69"></a><span id="l79.69">   }</span>
<a href="#l79.70"></a><span id="l79.70"> </span>
<a href="#l79.71"></a><span id="l79.71">   return &quot;&quot;;</span>
<a href="#l79.72"></a><span id="l79.72"> }</span>
<a href="#l79.73"></a><span id="l79.73"> </span>
<a href="#l79.74"></a><span id="l79.74"> function SetTreeItemValueStr(treeItem, value) {</span>
<a href="#l79.75"></a><span id="l79.75">   if (treeItem &amp;&amp; GetTreeItemValueStr(treeItem) != value) {</span>
<a href="#l79.76"></a><span id="l79.76" class="difflineminus">-    treeItem.firstChild.lastChild.setAttribute(&quot;label&quot;, value);</span>
<a href="#l79.77"></a><span id="l79.77" class="difflineplus">+    treeItem.firstElementChild.lastElementChild.setAttribute(&quot;label&quot;, value);</span>
<a href="#l79.78"></a><span id="l79.78">   }</span>
<a href="#l79.79"></a><span id="l79.79"> }</span>
<a href="#l79.80"></a><span id="l79.80"> </span>
<a href="#l79.81"></a><span id="l79.81"> function IsNotTreeHeader(treeCell) {</span>
<a href="#l79.82"></a><span id="l79.82">   if (treeCell) {</span>
<a href="#l79.83"></a><span id="l79.83">     return treeCell.parentNode.parentNode.nodeName != &quot;treehead&quot;;</span>
<a href="#l79.84"></a><span id="l79.84">   }</span>
<a href="#l79.85"></a><span id="l79.85"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l80.1"></a><span id="l80.1" class="difflineminus">--- a/mail/components/compose/content/dialogs/EdDialogCommon.js</span>
<a href="#l80.2"></a><span id="l80.2" class="difflineplus">+++ b/mail/components/compose/content/dialogs/EdDialogCommon.js</span>
<a href="#l80.3"></a><span id="l80.3" class="difflineat">@@ -891,17 +891,17 @@ function RemoveContainer(element) {</span>
<a href="#l80.4"></a><span id="l80.4">     // Now remove the element</span>
<a href="#l80.5"></a><span id="l80.5">     editor.deleteNode(element);</span>
<a href="#l80.6"></a><span id="l80.6">   } finally {</span>
<a href="#l80.7"></a><span id="l80.7">     editor.endTransaction();</span>
<a href="#l80.8"></a><span id="l80.8">   }</span>
<a href="#l80.9"></a><span id="l80.9"> }</span>
<a href="#l80.10"></a><span id="l80.10"> </span>
<a href="#l80.11"></a><span id="l80.11"> function FillLinkMenulist(linkMenulist, headingsArray) {</span>
<a href="#l80.12"></a><span id="l80.12" class="difflineminus">-  var menupopup = linkMenulist.firstChild;</span>
<a href="#l80.13"></a><span id="l80.13" class="difflineplus">+  var menupopup = linkMenulist.firstElementChild;</span>
<a href="#l80.14"></a><span id="l80.14">   var editor = GetCurrentEditor();</span>
<a href="#l80.15"></a><span id="l80.15">   try {</span>
<a href="#l80.16"></a><span id="l80.16">     var treeWalker = editor.document.createTreeWalker(</span>
<a href="#l80.17"></a><span id="l80.17">       editor.document,</span>
<a href="#l80.18"></a><span id="l80.18">       1,</span>
<a href="#l80.19"></a><span id="l80.19">       null,</span>
<a href="#l80.20"></a><span id="l80.20">       true</span>
<a href="#l80.21"></a><span id="l80.21">     );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l81.1"></a><span id="l81.1" class="difflineminus">--- a/mail/components/compose/content/dialogs/EdImageDialog.js</span>
<a href="#l81.2"></a><span id="l81.2" class="difflineplus">+++ b/mail/components/compose/content/dialogs/EdImageDialog.js</span>
<a href="#l81.3"></a><span id="l81.3" class="difflineat">@@ -307,17 +307,17 @@ function LoadPreviewImage() {</span>
<a href="#l81.4"></a><span id="l81.4">     }</span>
<a href="#l81.5"></a><span id="l81.5">   } catch (e) {}</span>
<a href="#l81.6"></a><span id="l81.6"> </span>
<a href="#l81.7"></a><span id="l81.7">   if (gDialog.PreviewImage) {</span>
<a href="#l81.8"></a><span id="l81.8">     removeEventListener(&quot;load&quot;, PreviewImageLoaded, true);</span>
<a href="#l81.9"></a><span id="l81.9">   }</span>
<a href="#l81.10"></a><span id="l81.10"> </span>
<a href="#l81.11"></a><span id="l81.11">   if (gDialog.ImageHolder.hasChildNodes()) {</span>
<a href="#l81.12"></a><span id="l81.12" class="difflineminus">-    gDialog.ImageHolder.firstChild.remove();</span>
<a href="#l81.13"></a><span id="l81.13" class="difflineplus">+    gDialog.ImageHolder.firstElementChild.remove();</span>
<a href="#l81.14"></a><span id="l81.14">   }</span>
<a href="#l81.15"></a><span id="l81.15"> </span>
<a href="#l81.16"></a><span id="l81.16">   gDialog.PreviewImage = document.createElementNS(</span>
<a href="#l81.17"></a><span id="l81.17">     &quot;http://www.w3.org/1999/xhtml&quot;,</span>
<a href="#l81.18"></a><span id="l81.18">     &quot;img&quot;</span>
<a href="#l81.19"></a><span id="l81.19">   );</span>
<a href="#l81.20"></a><span id="l81.20">   if (gDialog.PreviewImage) {</span>
<a href="#l81.21"></a><span id="l81.21">     // set the src before appending to the document -- see bug 198435 for why</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l82.1"></a><span id="l82.1" class="difflineminus">--- a/mail/components/compose/content/dialogs/EdInsertMath.js</span>
<a href="#l82.2"></a><span id="l82.2" class="difflineplus">+++ b/mail/components/compose/content/dialogs/EdInsertMath.js</span>
<a href="#l82.3"></a><span id="l82.3" class="difflineat">@@ -121,17 +121,17 @@ function insertLaTeXCommand(aButton) {</span>
<a href="#l82.4"></a><span id="l82.4">   if (aButton.label) {</span>
<a href="#l82.5"></a><span id="l82.5">     gDialog.input.editor</span>
<a href="#l82.6"></a><span id="l82.6">       .QueryInterface(Ci.nsIPlaintextEditor)</span>
<a href="#l82.7"></a><span id="l82.7">       .insertText(aButton.label);</span>
<a href="#l82.8"></a><span id="l82.8">     return;</span>
<a href="#l82.9"></a><span id="l82.9">   }</span>
<a href="#l82.10"></a><span id="l82.10"> </span>
<a href="#l82.11"></a><span id="l82.11">   // Otherwise, it's a LaTeX command with at least one argument...</span>
<a href="#l82.12"></a><span id="l82.12" class="difflineminus">-  var latex = TeXZilla.getTeXSource(aButton.firstChild);</span>
<a href="#l82.13"></a><span id="l82.13" class="difflineplus">+  var latex = TeXZilla.getTeXSource(aButton.firstElementChild);</span>
<a href="#l82.14"></a><span id="l82.14">   var selectionStart = gDialog.input.selectionStart;</span>
<a href="#l82.15"></a><span id="l82.15">   var selectionEnd = gDialog.input.selectionEnd;</span>
<a href="#l82.16"></a><span id="l82.16"> </span>
<a href="#l82.17"></a><span id="l82.17">   // If the selection is not empty, we replace the first argument of the LaTeX</span>
<a href="#l82.18"></a><span id="l82.18">   // command with the current selection.</span>
<a href="#l82.19"></a><span id="l82.19">   var selection = gDialog.input.value.substring(selectionStart, selectionEnd);</span>
<a href="#l82.20"></a><span id="l82.20">   if (selection != &quot;&quot;) {</span>
<a href="#l82.21"></a><span id="l82.21">     latex = latex.replace(&quot;&quot;, selection);</span>
<a href="#l82.22"></a><span id="l82.22" class="difflineat">@@ -245,22 +245,25 @@ function createSymbolPanels(aSymbolPanel</span>
<a href="#l82.23"></a><span id="l82.23">     gDialog.tabbox.tabs.appendChild(tab);</span>
<a href="#l82.24"></a><span id="l82.24"> </span>
<a href="#l82.25"></a><span id="l82.25">     // Append the new tab panel.</span>
<a href="#l82.26"></a><span id="l82.26">     gDialog.tabbox.tabpanels.appendChild(table);</span>
<a href="#l82.27"></a><span id="l82.27">   }</span>
<a href="#l82.28"></a><span id="l82.28"> }</span>
<a href="#l82.29"></a><span id="l82.29"> </span>
<a href="#l82.30"></a><span id="l82.30"> function onAccept(event) {</span>
<a href="#l82.31"></a><span id="l82.31" class="difflineminus">-  if (gDialog.output.firstChild) {</span>
<a href="#l82.32"></a><span id="l82.32" class="difflineplus">+  if (gDialog.output.firstElementChild) {</span>
<a href="#l82.33"></a><span id="l82.33">     var editor = GetCurrentEditor();</span>
<a href="#l82.34"></a><span id="l82.34">     editor.beginTransaction();</span>
<a href="#l82.35"></a><span id="l82.35"> </span>
<a href="#l82.36"></a><span id="l82.36">     try {</span>
<a href="#l82.37"></a><span id="l82.37" class="difflineminus">-      var newMath = editor.document.importNode(gDialog.output.firstChild, true);</span>
<a href="#l82.38"></a><span id="l82.38" class="difflineplus">+      var newMath = editor.document.importNode(</span>
<a href="#l82.39"></a><span id="l82.39" class="difflineplus">+        gDialog.output.firstElementChild,</span>
<a href="#l82.40"></a><span id="l82.40" class="difflineplus">+        true</span>
<a href="#l82.41"></a><span id="l82.41" class="difflineplus">+      );</span>
<a href="#l82.42"></a><span id="l82.42">       if (gDialog.oldMath) {</span>
<a href="#l82.43"></a><span id="l82.43">         // Replace the old &lt;math&gt; element with the new one.</span>
<a href="#l82.44"></a><span id="l82.44">         editor.selectElement(gDialog.oldMath);</span>
<a href="#l82.45"></a><span id="l82.45">         editor.insertElementAtSelection(newMath, true);</span>
<a href="#l82.46"></a><span id="l82.46">       } else {</span>
<a href="#l82.47"></a><span id="l82.47">         // Insert the new &lt;math&gt; element.</span>
<a href="#l82.48"></a><span id="l82.48">         editor.insertElementAtSelection(newMath, false);</span>
<a href="#l82.49"></a><span id="l82.49">       }</span>
<a href="#l82.50"></a><span id="l82.50" class="difflineat">@@ -271,46 +274,47 @@ function onAccept(event) {</span>
<a href="#l82.51"></a><span id="l82.51">     dump(&quot;Null value -- not inserting in MathML Source dialog\n&quot;);</span>
<a href="#l82.52"></a><span id="l82.52">     event.preventDefault();</span>
<a href="#l82.53"></a><span id="l82.53">   }</span>
<a href="#l82.54"></a><span id="l82.54">   SaveWindowLocation();</span>
<a href="#l82.55"></a><span id="l82.55"> }</span>
<a href="#l82.56"></a><span id="l82.56"> </span>
<a href="#l82.57"></a><span id="l82.57"> function updateMath() {</span>
<a href="#l82.58"></a><span id="l82.58">   // Remove the preview, if any.</span>
<a href="#l82.59"></a><span id="l82.59" class="difflineminus">-  if (gDialog.output.firstChild) {</span>
<a href="#l82.60"></a><span id="l82.60" class="difflineminus">-    gDialog.output.firstChild.remove();</span>
<a href="#l82.61"></a><span id="l82.61" class="difflineplus">+  if (gDialog.output.firstElementChild) {</span>
<a href="#l82.62"></a><span id="l82.62" class="difflineplus">+    gDialog.output.firstElementChild.remove();</span>
<a href="#l82.63"></a><span id="l82.63">   }</span>
<a href="#l82.64"></a><span id="l82.64"> </span>
<a href="#l82.65"></a><span id="l82.65">   // Try to convert the LaTeX source into MathML using TeXZilla.</span>
<a href="#l82.66"></a><span id="l82.66">   // We use the placeholder text if no input is provided.</span>
<a href="#l82.67"></a><span id="l82.67">   try {</span>
<a href="#l82.68"></a><span id="l82.68">     var input = gDialog.input.value || gDialog.input.placeholder;</span>
<a href="#l82.69"></a><span id="l82.69">     var newMath = TeXZilla.toMathML(</span>
<a href="#l82.70"></a><span id="l82.70">       input,</span>
<a href="#l82.71"></a><span id="l82.71">       gDialog.mode.selectedIndex,</span>
<a href="#l82.72"></a><span id="l82.72">       gDialog.direction.selectedIndex,</span>
<a href="#l82.73"></a><span id="l82.73">       true</span>
<a href="#l82.74"></a><span id="l82.74">     );</span>
<a href="#l82.75"></a><span id="l82.75">     gDialog.output.appendChild(document.importNode(newMath, true));</span>
<a href="#l82.76"></a><span id="l82.76">     gDialog.output.style.opacity = gDialog.input.value ? 1 : 0.5;</span>
<a href="#l82.77"></a><span id="l82.77">   } catch (e) {}</span>
<a href="#l82.78"></a><span id="l82.78">   // Disable the accept button if parsing fails or when the placeholder is used.</span>
<a href="#l82.79"></a><span id="l82.79" class="difflineminus">-  gDialog.accept.disabled = !gDialog.input.value || !gDialog.output.firstChild;</span>
<a href="#l82.80"></a><span id="l82.80" class="difflineplus">+  gDialog.accept.disabled =</span>
<a href="#l82.81"></a><span id="l82.81" class="difflineplus">+    !gDialog.input.value || !gDialog.output.firstElementChild;</span>
<a href="#l82.82"></a><span id="l82.82"> }</span>
<a href="#l82.83"></a><span id="l82.83"> </span>
<a href="#l82.84"></a><span id="l82.84"> function updateMode() {</span>
<a href="#l82.85"></a><span id="l82.85" class="difflineminus">-  if (gDialog.output.firstChild) {</span>
<a href="#l82.86"></a><span id="l82.86" class="difflineminus">-    gDialog.output.firstChild.setAttribute(</span>
<a href="#l82.87"></a><span id="l82.87" class="difflineplus">+  if (gDialog.output.firstElementChild) {</span>
<a href="#l82.88"></a><span id="l82.88" class="difflineplus">+    gDialog.output.firstElementChild.setAttribute(</span>
<a href="#l82.89"></a><span id="l82.89">       &quot;display&quot;,</span>
<a href="#l82.90"></a><span id="l82.90">       gDialog.mode.selectedIndex ? &quot;block&quot; : &quot;inline&quot;</span>
<a href="#l82.91"></a><span id="l82.91">     );</span>
<a href="#l82.92"></a><span id="l82.92">   }</span>
<a href="#l82.93"></a><span id="l82.93"> }</span>
<a href="#l82.94"></a><span id="l82.94"> </span>
<a href="#l82.95"></a><span id="l82.95"> function updateDirection() {</span>
<a href="#l82.96"></a><span id="l82.96" class="difflineminus">-  if (gDialog.output.firstChild) {</span>
<a href="#l82.97"></a><span id="l82.97" class="difflineminus">-    gDialog.output.firstChild.setAttribute(</span>
<a href="#l82.98"></a><span id="l82.98" class="difflineplus">+  if (gDialog.output.firstElementChild) {</span>
<a href="#l82.99"></a><span id="l82.99" class="difflineplus">+    gDialog.output.firstElementChild.setAttribute(</span>
<a href="#l82.100"></a><span id="l82.100">       &quot;dir&quot;,</span>
<a href="#l82.101"></a><span id="l82.101">       gDialog.direction.selectedIndex ? &quot;rtl&quot; : &quot;ltr&quot;</span>
<a href="#l82.102"></a><span id="l82.102">     );</span>
<a href="#l82.103"></a><span id="l82.103">   }</span>
<a href="#l82.104"></a><span id="l82.104"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l83.1"></a><span id="l83.1" class="difflineminus">--- a/mail/components/compose/content/dialogs/EdInsertTable.js</span>
<a href="#l83.2"></a><span id="l83.2" class="difflineplus">+++ b/mail/components/compose/content/dialogs/EdInsertTable.js</span>
<a href="#l83.3"></a><span id="l83.3" class="difflineat">@@ -234,19 +234,23 @@ function onAccept(event) {</span>
<a href="#l83.4"></a><span id="l83.4">             deletePlaceholder = true;</span>
<a href="#l83.5"></a><span id="l83.5">           }</span>
<a href="#l83.6"></a><span id="l83.6">         }</span>
<a href="#l83.7"></a><span id="l83.7">       }</span>
<a href="#l83.8"></a><span id="l83.8"> </span>
<a href="#l83.9"></a><span id="l83.9">       // true means delete selection when inserting</span>
<a href="#l83.10"></a><span id="l83.10">       gActiveEditor.insertElementAtSelection(gTableElement, true);</span>
<a href="#l83.11"></a><span id="l83.11"> </span>
<a href="#l83.12"></a><span id="l83.12" class="difflineminus">-      if (deletePlaceholder &amp;&amp; gTableElement &amp;&amp; gTableElement.nextSibling) {</span>
<a href="#l83.13"></a><span id="l83.13" class="difflineplus">+      if (</span>
<a href="#l83.14"></a><span id="l83.14" class="difflineplus">+        deletePlaceholder &amp;&amp;</span>
<a href="#l83.15"></a><span id="l83.15" class="difflineplus">+        gTableElement &amp;&amp;</span>
<a href="#l83.16"></a><span id="l83.16" class="difflineplus">+        gTableElement.nextElementSibling</span>
<a href="#l83.17"></a><span id="l83.17" class="difflineplus">+      ) {</span>
<a href="#l83.18"></a><span id="l83.18">         // Delete the placeholder &lt;br&gt;</span>
<a href="#l83.19"></a><span id="l83.19" class="difflineminus">-        gActiveEditor.deleteNode(gTableElement.nextSibling);</span>
<a href="#l83.20"></a><span id="l83.20" class="difflineplus">+        gActiveEditor.deleteNode(gTableElement.nextElementSibling);</span>
<a href="#l83.21"></a><span id="l83.21">       }</span>
<a href="#l83.22"></a><span id="l83.22">     } catch (e) {}</span>
<a href="#l83.23"></a><span id="l83.23"> </span>
<a href="#l83.24"></a><span id="l83.24">     gActiveEditor.endTransaction();</span>
<a href="#l83.25"></a><span id="l83.25"> </span>
<a href="#l83.26"></a><span id="l83.26">     SaveWindowLocation();</span>
<a href="#l83.27"></a><span id="l83.27">     return;</span>
<a href="#l83.28"></a><span id="l83.28">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l84.1"></a><span id="l84.1" class="difflineminus">--- a/mail/components/compose/content/dialogs/EdLinkProps.js</span>
<a href="#l84.2"></a><span id="l84.2" class="difflineplus">+++ b/mail/components/compose/content/dialogs/EdLinkProps.js</span>
<a href="#l84.3"></a><span id="l84.3" class="difflineat">@@ -49,17 +49,17 @@ function Startup() {</span>
<a href="#l84.4"></a><span id="l84.4"> </span>
<a href="#l84.5"></a><span id="l84.5">   if (imageElement) {</span>
<a href="#l84.6"></a><span id="l84.6">     // Get the parent link if it exists -- more efficient than GetSelectedElement()</span>
<a href="#l84.7"></a><span id="l84.7">     anchorElement = gActiveEditor.getElementOrParentByTagName(</span>
<a href="#l84.8"></a><span id="l84.8">       &quot;href&quot;,</span>
<a href="#l84.9"></a><span id="l84.9">       imageElement</span>
<a href="#l84.10"></a><span id="l84.10">     );</span>
<a href="#l84.11"></a><span id="l84.11">     if (anchorElement) {</span>
<a href="#l84.12"></a><span id="l84.12" class="difflineminus">-      if (anchorElement.childNodes.length &gt; 1) {</span>
<a href="#l84.13"></a><span id="l84.13" class="difflineplus">+      if (anchorElement.children.length &gt; 1) {</span>
<a href="#l84.14"></a><span id="l84.14">         // If there are other children, then we want to break</span>
<a href="#l84.15"></a><span id="l84.15">         //  this image away by inserting a new link around it,</span>
<a href="#l84.16"></a><span id="l84.16">         //  so make a new node and copy existing attributes</span>
<a href="#l84.17"></a><span id="l84.17">         anchorElement = anchorElement.cloneNode(false);</span>
<a href="#l84.18"></a><span id="l84.18">         // insertNew = true;</span>
<a href="#l84.19"></a><span id="l84.19">         replaceExistingLink = true;</span>
<a href="#l84.20"></a><span id="l84.20">       }</span>
<a href="#l84.21"></a><span id="l84.21">     }</span>
<a href="#l84.22"></a><span id="l84.22" class="difflineat">@@ -129,26 +129,17 @@ function Startup() {</span>
<a href="#l84.23"></a><span id="l84.23">     );</span>
<a href="#l84.24"></a><span id="l84.24">   } else {</span>
<a href="#l84.25"></a><span id="l84.25">     if (!imageElement) {</span>
<a href="#l84.26"></a><span id="l84.26">       // We get here if selection is exactly around a link node</span>
<a href="#l84.27"></a><span id="l84.27">       // Check if selection has some text - use that first</span>
<a href="#l84.28"></a><span id="l84.28">       selectedText = GetSelectionAsText();</span>
<a href="#l84.29"></a><span id="l84.29">       if (!selectedText) {</span>
<a href="#l84.30"></a><span id="l84.30">         // No text, look for first image in the selection</span>
<a href="#l84.31"></a><span id="l84.31" class="difflineminus">-        var children = anchorElement.childNodes;</span>
<a href="#l84.32"></a><span id="l84.32" class="difflineminus">-        if (children) {</span>
<a href="#l84.33"></a><span id="l84.33" class="difflineminus">-          for (var i = 0; i &lt; children.length; i++) {</span>
<a href="#l84.34"></a><span id="l84.34" class="difflineminus">-            var nodeName = children.item(i).nodeName.toLowerCase();</span>
<a href="#l84.35"></a><span id="l84.35" class="difflineminus">-            if (nodeName == &quot;img&quot;) {</span>
<a href="#l84.36"></a><span id="l84.36" class="difflineminus">-              imageElement = children.item(i);</span>
<a href="#l84.37"></a><span id="l84.37" class="difflineminus">-              break;</span>
<a href="#l84.38"></a><span id="l84.38" class="difflineminus">-            }</span>
<a href="#l84.39"></a><span id="l84.39" class="difflineminus">-          }</span>
<a href="#l84.40"></a><span id="l84.40" class="difflineminus">-        }</span>
<a href="#l84.41"></a><span id="l84.41" class="difflineplus">+        imageElement = anchorElement.querySelector(&quot;img&quot;);</span>
<a href="#l84.42"></a><span id="l84.42">       }</span>
<a href="#l84.43"></a><span id="l84.43">     }</span>
<a href="#l84.44"></a><span id="l84.44">     // Set &quot;caption&quot; for link source and the source text or image URL</span>
<a href="#l84.45"></a><span id="l84.45">     if (imageElement) {</span>
<a href="#l84.46"></a><span id="l84.46">       gDialog.linkTextCaption.setAttribute(&quot;label&quot;, GetString(&quot;LinkImage&quot;));</span>
<a href="#l84.47"></a><span id="l84.47">       // Link source string is the source URL of image</span>
<a href="#l84.48"></a><span id="l84.48">       // TODO: THIS DOESN'T HANDLE MULTIPLE SELECTED IMAGES!</span>
<a href="#l84.49"></a><span id="l84.49">       gDialog.linkTextMessage.setAttribute(&quot;value&quot;, imageElement.src);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l85.1"></a><span id="l85.1" class="difflineminus">--- a/mail/components/compose/content/dialogs/EdSpellCheck.js</span>
<a href="#l85.2"></a><span id="l85.2" class="difflineplus">+++ b/mail/components/compose/content/dialogs/EdSpellCheck.js</span>
<a href="#l85.3"></a><span id="l85.3" class="difflineat">@@ -134,18 +134,18 @@ function InitLanguageMenu(aCurLang) {</span>
<a href="#l85.4"></a><span id="l85.4">   // Store current dictionary count.</span>
<a href="#l85.5"></a><span id="l85.5">   gDictCount = dictList.length;</span>
<a href="#l85.6"></a><span id="l85.6"> </span>
<a href="#l85.7"></a><span id="l85.7">   var inlineSpellChecker = new InlineSpellChecker();</span>
<a href="#l85.8"></a><span id="l85.8">   var sortedList = inlineSpellChecker.sortDictionaryList(dictList);</span>
<a href="#l85.9"></a><span id="l85.9"> </span>
<a href="#l85.10"></a><span id="l85.10">   // Remove any languages from the list.</span>
<a href="#l85.11"></a><span id="l85.11">   var languageMenuPopup = gDialog.LanguageMenulist.menupopup;</span>
<a href="#l85.12"></a><span id="l85.12" class="difflineminus">-  while (languageMenuPopup.firstChild.localName != &quot;menuseparator&quot;) {</span>
<a href="#l85.13"></a><span id="l85.13" class="difflineminus">-    languageMenuPopup.firstChild.remove();</span>
<a href="#l85.14"></a><span id="l85.14" class="difflineplus">+  while (languageMenuPopup.firstElementChild.localName != &quot;menuseparator&quot;) {</span>
<a href="#l85.15"></a><span id="l85.15" class="difflineplus">+    languageMenuPopup.firstElementChild.remove();</span>
<a href="#l85.16"></a><span id="l85.16">   }</span>
<a href="#l85.17"></a><span id="l85.17"> </span>
<a href="#l85.18"></a><span id="l85.18">   var defaultItem = null;</span>
<a href="#l85.19"></a><span id="l85.19"> </span>
<a href="#l85.20"></a><span id="l85.20">   for (var i = 0; i &lt; gDictCount; i++) {</span>
<a href="#l85.21"></a><span id="l85.21">     let item = document.createXULElement(&quot;menuitem&quot;);</span>
<a href="#l85.22"></a><span id="l85.22">     item.setAttribute(&quot;label&quot;, sortedList[i].displayName);</span>
<a href="#l85.23"></a><span id="l85.23">     item.setAttribute(&quot;value&quot;, sortedList[i].localeCode);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l86.1"></a><span id="l86.1" class="difflineminus">--- a/mail/components/compose/content/editor.js</span>
<a href="#l86.2"></a><span id="l86.2" class="difflineplus">+++ b/mail/components/compose/content/editor.js</span>
<a href="#l86.3"></a><span id="l86.3" class="difflineat">@@ -101,26 +101,26 @@ var kEditorToolbarPrefs = &quot;editor.toolba</span>
<a href="#l86.4"></a><span id="l86.4"> var kUseCssPref = &quot;editor.use_css&quot;;</span>
<a href="#l86.5"></a><span id="l86.5"> var kCRInParagraphsPref = &quot;editor.CR_creates_new_p&quot;;</span>
<a href="#l86.6"></a><span id="l86.6"> </span>
<a href="#l86.7"></a><span id="l86.7"> function ShowHideToolbarSeparators(toolbar) {</span>
<a href="#l86.8"></a><span id="l86.8">   // Make sure the toolbar actually exists.</span>
<a href="#l86.9"></a><span id="l86.9">   if (!toolbar) {</span>
<a href="#l86.10"></a><span id="l86.10">     return;</span>
<a href="#l86.11"></a><span id="l86.11">   }</span>
<a href="#l86.12"></a><span id="l86.12" class="difflineminus">-  var childNodes = toolbar.childNodes;</span>
<a href="#l86.13"></a><span id="l86.13" class="difflineplus">+  var children = toolbar.children;</span>
<a href="#l86.14"></a><span id="l86.14">   var separator = null;</span>
<a href="#l86.15"></a><span id="l86.15">   var hideSeparator = true;</span>
<a href="#l86.16"></a><span id="l86.16" class="difflineminus">-  for (var i = 0; childNodes[i].localName != &quot;spacer&quot;; i++) {</span>
<a href="#l86.17"></a><span id="l86.17" class="difflineminus">-    if (childNodes[i].localName == &quot;toolbarseparator&quot;) {</span>
<a href="#l86.18"></a><span id="l86.18" class="difflineplus">+  for (var i = 0; children[i].localName != &quot;spacer&quot;; i++) {</span>
<a href="#l86.19"></a><span id="l86.19" class="difflineplus">+    if (children[i].localName == &quot;toolbarseparator&quot;) {</span>
<a href="#l86.20"></a><span id="l86.20">       if (separator) {</span>
<a href="#l86.21"></a><span id="l86.21">         separator.hidden = true;</span>
<a href="#l86.22"></a><span id="l86.22">       }</span>
<a href="#l86.23"></a><span id="l86.23" class="difflineminus">-      separator = childNodes[i];</span>
<a href="#l86.24"></a><span id="l86.24" class="difflineminus">-    } else if (!childNodes[i].hidden) {</span>
<a href="#l86.25"></a><span id="l86.25" class="difflineplus">+      separator = children[i];</span>
<a href="#l86.26"></a><span id="l86.26" class="difflineplus">+    } else if (!children[i].hidden) {</span>
<a href="#l86.27"></a><span id="l86.27">       if (separator) {</span>
<a href="#l86.28"></a><span id="l86.28">         separator.hidden = hideSeparator;</span>
<a href="#l86.29"></a><span id="l86.29">       }</span>
<a href="#l86.30"></a><span id="l86.30">       separator = null;</span>
<a href="#l86.31"></a><span id="l86.31">       hideSeparator = false;</span>
<a href="#l86.32"></a><span id="l86.32">     }</span>
<a href="#l86.33"></a><span id="l86.33">   }</span>
<a href="#l86.34"></a><span id="l86.34"> }</span>
<a href="#l86.35"></a><span id="l86.35" class="difflineat">@@ -707,17 +707,17 @@ function onParagraphFormatChange(paraMen</span>
<a href="#l86.36"></a><span id="l86.36">   }</span>
<a href="#l86.37"></a><span id="l86.37"> </span>
<a href="#l86.38"></a><span id="l86.38">   if (state == &quot;mixed&quot;) {</span>
<a href="#l86.39"></a><span id="l86.39">     // Selection is the &quot;mixed&quot; ( &gt; 1 style) state</span>
<a href="#l86.40"></a><span id="l86.40">     paraMenuList.selectedItem = null;</span>
<a href="#l86.41"></a><span id="l86.41">     paraMenuList.setAttribute(&quot;label&quot;, GetString(&quot;Mixed&quot;));</span>
<a href="#l86.42"></a><span id="l86.42">   } else {</span>
<a href="#l86.43"></a><span id="l86.43">     var menuPopup = document.getElementById(&quot;ParagraphPopup&quot;);</span>
<a href="#l86.44"></a><span id="l86.44" class="difflineminus">-    var menuItems = menuPopup.childNodes;</span>
<a href="#l86.45"></a><span id="l86.45" class="difflineplus">+    var menuItems = menuPopup.children;</span>
<a href="#l86.46"></a><span id="l86.46">     for (var i = 0; i &lt; menuItems.length; i++) {</span>
<a href="#l86.47"></a><span id="l86.47">       var menuItem = menuItems.item(i);</span>
<a href="#l86.48"></a><span id="l86.48">       if (&quot;value&quot; in menuItem &amp;&amp; menuItem.value == state) {</span>
<a href="#l86.49"></a><span id="l86.49">         paraMenuList.selectedItem = menuItem;</span>
<a href="#l86.50"></a><span id="l86.50">         break;</span>
<a href="#l86.51"></a><span id="l86.51">       }</span>
<a href="#l86.52"></a><span id="l86.52">     }</span>
<a href="#l86.53"></a><span id="l86.53">   }</span>
<a href="#l86.54"></a><span id="l86.54" class="difflineat">@@ -756,17 +756,17 @@ function onFontFaceChange(fontFaceMenuLi</span>
<a href="#l86.55"></a><span id="l86.55">     case &quot;monospace&quot;:</span>
<a href="#l86.56"></a><span id="l86.56">       // Generic fixed width.</span>
<a href="#l86.57"></a><span id="l86.57">       fontFaceMenuList.selectedIndex = 1;</span>
<a href="#l86.58"></a><span id="l86.58">       return;</span>
<a href="#l86.59"></a><span id="l86.59">     default:</span>
<a href="#l86.60"></a><span id="l86.60">   }</span>
<a href="#l86.61"></a><span id="l86.61"> </span>
<a href="#l86.62"></a><span id="l86.62">   let menuPopup = fontFaceMenuList.menupopup;</span>
<a href="#l86.63"></a><span id="l86.63" class="difflineminus">-  let menuItems = menuPopup.childNodes;</span>
<a href="#l86.64"></a><span id="l86.64" class="difflineplus">+  let menuItems = menuPopup.children;</span>
<a href="#l86.65"></a><span id="l86.65"> </span>
<a href="#l86.66"></a><span id="l86.66">   const genericFamilies = [</span>
<a href="#l86.67"></a><span id="l86.67">     &quot;serif&quot;,</span>
<a href="#l86.68"></a><span id="l86.68">     &quot;sans-serif&quot;,</span>
<a href="#l86.69"></a><span id="l86.69">     &quot;monospace&quot;,</span>
<a href="#l86.70"></a><span id="l86.70">     &quot;fantasy&quot;,</span>
<a href="#l86.71"></a><span id="l86.71">     &quot;cursive&quot;,</span>
<a href="#l86.72"></a><span id="l86.72">   ];</span>
<a href="#l86.73"></a><span id="l86.73" class="difflineat">@@ -851,17 +851,17 @@ function onFontFaceChange(fontFaceMenuLi</span>
<a href="#l86.74"></a><span id="l86.74">       &quot;menuseparator.fontFaceMenuAfterDefaultFonts&quot;</span>
<a href="#l86.75"></a><span id="l86.75">     );</span>
<a href="#l86.76"></a><span id="l86.76">     if (exactMatch) {</span>
<a href="#l86.77"></a><span id="l86.77">       if (afterUsedFontSection) {</span>
<a href="#l86.78"></a><span id="l86.78">         // Copy the matched font into the section of used fonts.</span>
<a href="#l86.79"></a><span id="l86.79">         // We insert after the separator following the default fonts,</span>
<a href="#l86.80"></a><span id="l86.80">         // so right at the beginning of the used fonts section.</span>
<a href="#l86.81"></a><span id="l86.81">         let copyItem = foundFont.cloneNode(true);</span>
<a href="#l86.82"></a><span id="l86.82" class="difflineminus">-        menuPopup.insertBefore(copyItem, defaultFontsSep.nextSibling);</span>
<a href="#l86.83"></a><span id="l86.83" class="difflineplus">+        menuPopup.insertBefore(copyItem, defaultFontsSep.nextElementSibling);</span>
<a href="#l86.84"></a><span id="l86.84">         usedFontsSep.hidden = false;</span>
<a href="#l86.85"></a><span id="l86.85">         foundFont = copyItem;</span>
<a href="#l86.86"></a><span id="l86.86">         foundFont.setAttribute(&quot;used&quot;, &quot;true&quot;);</span>
<a href="#l86.87"></a><span id="l86.87">       }</span>
<a href="#l86.88"></a><span id="l86.88">     } else {</span>
<a href="#l86.89"></a><span id="l86.89">       // Keep only the found font and generic families in the font string.</span>
<a href="#l86.90"></a><span id="l86.90">       editorFont = editorFont</span>
<a href="#l86.91"></a><span id="l86.91">         .replace(/, /g, &quot;,&quot;)</span>
<a href="#l86.92"></a><span id="l86.92" class="difflineat">@@ -896,17 +896,17 @@ function onFontFaceChange(fontFaceMenuLi</span>
<a href="#l86.93"></a><span id="l86.93">         &quot;value_cache&quot;,</span>
<a href="#l86.94"></a><span id="l86.94">         fontCache + &quot;|&quot; + editorFontToLower</span>
<a href="#l86.95"></a><span id="l86.95">       );</span>
<a href="#l86.96"></a><span id="l86.96"> </span>
<a href="#l86.97"></a><span id="l86.97">       // If we created a new item, set it up and insert.</span>
<a href="#l86.98"></a><span id="l86.98">       if (!foundFont.hasAttribute(&quot;used&quot;)) {</span>
<a href="#l86.99"></a><span id="l86.99">         foundFont.setAttribute(&quot;used&quot;, &quot;true&quot;);</span>
<a href="#l86.100"></a><span id="l86.100">         usedFontsSep.hidden = false;</span>
<a href="#l86.101"></a><span id="l86.101" class="difflineminus">-        menuPopup.insertBefore(foundFont, defaultFontsSep.nextSibling);</span>
<a href="#l86.102"></a><span id="l86.102" class="difflineplus">+        menuPopup.insertBefore(foundFont, defaultFontsSep.nextElementSibling);</span>
<a href="#l86.103"></a><span id="l86.103">       }</span>
<a href="#l86.104"></a><span id="l86.104">     }</span>
<a href="#l86.105"></a><span id="l86.105">   } else {</span>
<a href="#l86.106"></a><span id="l86.106">     // The editor encountered a font that is not installed on this system.</span>
<a href="#l86.107"></a><span id="l86.107">     // Add it to the font menu now, in the used-fonts section right at the</span>
<a href="#l86.108"></a><span id="l86.108">     // bottom before the separator of the section.</span>
<a href="#l86.109"></a><span id="l86.109">     let fontLabel = GetFormattedString(&quot;NotInstalled&quot;, editorFont);</span>
<a href="#l86.110"></a><span id="l86.110">     foundFont = createFontFaceMenuitem(fontLabel, editorFont, menuPopup);</span>
<a href="#l86.111"></a><span id="l86.111" class="difflineat">@@ -921,17 +921,17 @@ function onFontFaceChange(fontFaceMenuLi</span>
<a href="#l86.112"></a><span id="l86.112">  * Clears the used fonts list from all the font face menulists.</span>
<a href="#l86.113"></a><span id="l86.113">  */</span>
<a href="#l86.114"></a><span id="l86.114"> function ClearUsedFonts() {</span>
<a href="#l86.115"></a><span id="l86.115">   let userFontSeps = document.querySelectorAll(</span>
<a href="#l86.116"></a><span id="l86.116">     &quot;menuseparator.fontFaceMenuAfterDefaultFonts&quot;</span>
<a href="#l86.117"></a><span id="l86.117">   );</span>
<a href="#l86.118"></a><span id="l86.118">   for (let userFontSep of userFontSeps) {</span>
<a href="#l86.119"></a><span id="l86.119">     while (true) {</span>
<a href="#l86.120"></a><span id="l86.120" class="difflineminus">-      let nextNode = userFontSep.nextSibling;</span>
<a href="#l86.121"></a><span id="l86.121" class="difflineplus">+      let nextNode = userFontSep.nextElementSibling;</span>
<a href="#l86.122"></a><span id="l86.122">       if (nextNode.tagName != &quot;menuseparator&quot;) {</span>
<a href="#l86.123"></a><span id="l86.123">         nextNode.remove();</span>
<a href="#l86.124"></a><span id="l86.124">       } else if (nextNode.classList.contains(&quot;fontFaceMenuAfterUsedFonts&quot;)) {</span>
<a href="#l86.125"></a><span id="l86.125">         nextNode.hidden = true;</span>
<a href="#l86.126"></a><span id="l86.126">         break;</span>
<a href="#l86.127"></a><span id="l86.127">       }</span>
<a href="#l86.128"></a><span id="l86.128">     }</span>
<a href="#l86.129"></a><span id="l86.129">   }</span>
<a href="#l86.130"></a><span id="l86.130" class="difflineat">@@ -999,17 +999,17 @@ function EditorSetFontSize(size) {</span>
<a href="#l86.131"></a><span id="l86.131">   }</span>
<a href="#l86.132"></a><span id="l86.132">   gContentWindow.focus();</span>
<a href="#l86.133"></a><span id="l86.133"> }</span>
<a href="#l86.134"></a><span id="l86.134"> </span>
<a href="#l86.135"></a><span id="l86.135"> function initFontFaceMenu(menuPopup) {</span>
<a href="#l86.136"></a><span id="l86.136">   initLocalFontFaceMenu(menuPopup);</span>
<a href="#l86.137"></a><span id="l86.137"> </span>
<a href="#l86.138"></a><span id="l86.138">   if (menuPopup) {</span>
<a href="#l86.139"></a><span id="l86.139" class="difflineminus">-    var children = menuPopup.childNodes;</span>
<a href="#l86.140"></a><span id="l86.140" class="difflineplus">+    var children = menuPopup.children;</span>
<a href="#l86.141"></a><span id="l86.141">     if (!children) {</span>
<a href="#l86.142"></a><span id="l86.142">       return;</span>
<a href="#l86.143"></a><span id="l86.143">     }</span>
<a href="#l86.144"></a><span id="l86.144"> </span>
<a href="#l86.145"></a><span id="l86.145">     var mixed = { value: false };</span>
<a href="#l86.146"></a><span id="l86.146">     var editorFont = GetCurrentEditor().getFontFaceState(mixed);</span>
<a href="#l86.147"></a><span id="l86.147"> </span>
<a href="#l86.148"></a><span id="l86.148">     // Strip quotes in font names. Experiments have shown that we only</span>
<a href="#l86.149"></a><span id="l86.149" class="difflineat">@@ -1101,17 +1101,17 @@ function initLocalFontFaceMenu(menuPopup</span>
<a href="#l86.150"></a><span id="l86.150">       );</span>
<a href="#l86.151"></a><span id="l86.151">       gLocalFonts = enumerator.EnumerateAllFonts();</span>
<a href="#l86.152"></a><span id="l86.152">     } catch (e) {}</span>
<a href="#l86.153"></a><span id="l86.153">   }</span>
<a href="#l86.154"></a><span id="l86.154"> </span>
<a href="#l86.155"></a><span id="l86.155">   // Don't use radios for menulists.</span>
<a href="#l86.156"></a><span id="l86.156">   let useRadioMenuitems = menuPopup.parentNode.localName == &quot;menu&quot;;</span>
<a href="#l86.157"></a><span id="l86.157">   menuPopup.setAttribute(&quot;useRadios&quot;, useRadioMenuitems);</span>
<a href="#l86.158"></a><span id="l86.158" class="difflineminus">-  if (menuPopup.childNodes.length == kFixedFontFaceMenuItems) {</span>
<a href="#l86.159"></a><span id="l86.159" class="difflineplus">+  if (menuPopup.children.length == kFixedFontFaceMenuItems) {</span>
<a href="#l86.160"></a><span id="l86.160">     if (gLocalFonts.length == 0) {</span>
<a href="#l86.161"></a><span id="l86.161">       menuPopup.querySelector(&quot;.fontFaceMenuAfterDefaultFonts&quot;).hidden = true;</span>
<a href="#l86.162"></a><span id="l86.162">     }</span>
<a href="#l86.163"></a><span id="l86.163">     for (let i = 0; i &lt; gLocalFonts.length; ++i) {</span>
<a href="#l86.164"></a><span id="l86.164">       // Remove Linux system generic fonts that collide with CSS generic fonts.</span>
<a href="#l86.165"></a><span id="l86.165">       if (</span>
<a href="#l86.166"></a><span id="l86.166">         gLocalFonts[i] != &quot;&quot; &amp;&amp;</span>
<a href="#l86.167"></a><span id="l86.167">         gLocalFonts[i] != &quot;serif&quot; &amp;&amp;</span>
<a href="#l86.168"></a><span id="l86.168" class="difflineat">@@ -1217,17 +1217,17 @@ function getFontSizeIndex() {</span>
<a href="#l86.169"></a><span id="l86.169">   }</span>
<a href="#l86.170"></a><span id="l86.170"> </span>
<a href="#l86.171"></a><span id="l86.171">   // We shouldn't get here. All the selection has a value we don't understand.</span>
<a href="#l86.172"></a><span id="l86.172">   return -1;</span>
<a href="#l86.173"></a><span id="l86.173"> }</span>
<a href="#l86.174"></a><span id="l86.174"> </span>
<a href="#l86.175"></a><span id="l86.175"> function initFontSizeMenu(menuPopup, fullMenu) {</span>
<a href="#l86.176"></a><span id="l86.176">   if (menuPopup) {</span>
<a href="#l86.177"></a><span id="l86.177" class="difflineminus">-    var children = menuPopup.childNodes;</span>
<a href="#l86.178"></a><span id="l86.178" class="difflineplus">+    var children = menuPopup.children;</span>
<a href="#l86.179"></a><span id="l86.179">     if (!children) {</span>
<a href="#l86.180"></a><span id="l86.180">       return;</span>
<a href="#l86.181"></a><span id="l86.181">     }</span>
<a href="#l86.182"></a><span id="l86.182"> </span>
<a href="#l86.183"></a><span id="l86.183">     // Fixed size items start after menu separator depending on whether it is</span>
<a href="#l86.184"></a><span id="l86.184">     // a full menu.</span>
<a href="#l86.185"></a><span id="l86.185">     var menuIndex = fullMenu ? 3 : 0;</span>
<a href="#l86.186"></a><span id="l86.186"> </span>
<a href="#l86.187"></a><span id="l86.187" class="difflineat">@@ -1238,17 +1238,17 @@ function initFontSizeMenu(menuPopup, ful</span>
<a href="#l86.188"></a><span id="l86.188">       // In case of mixed, clear all items.</span>
<a href="#l86.189"></a><span id="l86.189">       for (var i = menuIndex; i &lt; children.length; i++) {</span>
<a href="#l86.190"></a><span id="l86.190">         children[i].setAttribute(&quot;checked&quot;, false);</span>
<a href="#l86.191"></a><span id="l86.191">       }</span>
<a href="#l86.192"></a><span id="l86.192">     }</span>
<a href="#l86.193"></a><span id="l86.193"> </span>
<a href="#l86.194"></a><span id="l86.194">     // Some configurations might not have the &quot;small/big&quot; indicator as</span>
<a href="#l86.195"></a><span id="l86.195">     // last item. If there is no indicator, we are done.</span>
<a href="#l86.196"></a><span id="l86.196" class="difflineminus">-    if (!menuPopup.lastChild.id.includes(&quot;smallBigInfo&quot;)) {</span>
<a href="#l86.197"></a><span id="l86.197" class="difflineplus">+    if (!menuPopup.lastElementChild.id.includes(&quot;smallBigInfo&quot;)) {</span>
<a href="#l86.198"></a><span id="l86.198">       return;</span>
<a href="#l86.199"></a><span id="l86.199">     }</span>
<a href="#l86.200"></a><span id="l86.200"> </span>
<a href="#l86.201"></a><span id="l86.201">     // While it would be better to show the number of levels,</span>
<a href="#l86.202"></a><span id="l86.202">     // at least this tells user if either of them are set.</span>
<a href="#l86.203"></a><span id="l86.203">     var firstHas = { value: false };</span>
<a href="#l86.204"></a><span id="l86.204">     var anyHas = { value: false };</span>
<a href="#l86.205"></a><span id="l86.205">     var allHas = { value: false };</span>
<a href="#l86.206"></a><span id="l86.206" class="difflineat">@@ -1260,21 +1260,21 @@ function initFontSizeMenu(menuPopup, ful</span>
<a href="#l86.207"></a><span id="l86.207">       htmlInfo = &quot;&lt;small&gt;&quot;;</span>
<a href="#l86.208"></a><span id="l86.208">     }</span>
<a href="#l86.209"></a><span id="l86.209">     EditorGetTextProperty(&quot;big&quot;, &quot;&quot;, &quot;&quot;, firstHas, anyHas, allHas);</span>
<a href="#l86.210"></a><span id="l86.210">     if (anyHas.value) {</span>
<a href="#l86.211"></a><span id="l86.211">       htmlInfo += &quot;&lt;big&gt;&quot;;</span>
<a href="#l86.212"></a><span id="l86.212">     }</span>
<a href="#l86.213"></a><span id="l86.213"> </span>
<a href="#l86.214"></a><span id="l86.214">     if (htmlInfo) {</span>
<a href="#l86.215"></a><span id="l86.215" class="difflineminus">-      menuPopup.lastChild.hidden = false;</span>
<a href="#l86.216"></a><span id="l86.216" class="difflineminus">-      menuPopup.lastChild.setAttribute(&quot;label&quot;, &quot;HTML: &quot; + htmlInfo);</span>
<a href="#l86.217"></a><span id="l86.217" class="difflineminus">-      menuPopup.lastChild.setAttribute(&quot;checked&quot;, true);</span>
<a href="#l86.218"></a><span id="l86.218" class="difflineplus">+      menuPopup.lastElementChild.hidden = false;</span>
<a href="#l86.219"></a><span id="l86.219" class="difflineplus">+      menuPopup.lastElementChild.setAttribute(&quot;label&quot;, &quot;HTML: &quot; + htmlInfo);</span>
<a href="#l86.220"></a><span id="l86.220" class="difflineplus">+      menuPopup.lastElementChild.setAttribute(&quot;checked&quot;, true);</span>
<a href="#l86.221"></a><span id="l86.221">     } else {</span>
<a href="#l86.222"></a><span id="l86.222" class="difflineminus">-      menuPopup.lastChild.hidden = true;</span>
<a href="#l86.223"></a><span id="l86.223" class="difflineplus">+      menuPopup.lastElementChild.hidden = true;</span>
<a href="#l86.224"></a><span id="l86.224">     }</span>
<a href="#l86.225"></a><span id="l86.225">   }</span>
<a href="#l86.226"></a><span id="l86.226"> }</span>
<a href="#l86.227"></a><span id="l86.227"> </span>
<a href="#l86.228"></a><span id="l86.228"> function onHighlightColorChange() {</span>
<a href="#l86.229"></a><span id="l86.229">   ChangeButtonColor(&quot;cmd_highlight&quot;, &quot;HighlightColorButton&quot;, &quot;transparent&quot;);</span>
<a href="#l86.230"></a><span id="l86.230"> }</span>
<a href="#l86.231"></a><span id="l86.231"> </span>
<a href="#l86.232"></a><span id="l86.232" class="difflineat">@@ -2431,19 +2431,17 @@ function EditorSetDefaultPrefsAndDoctype</span>
<a href="#l86.233"></a><span id="l86.233">       domdoc.insertBefore(newdoctype, domdoc.firstChild);</span>
<a href="#l86.234"></a><span id="l86.234">     }</span>
<a href="#l86.235"></a><span id="l86.235">   }</span>
<a href="#l86.236"></a><span id="l86.236"> </span>
<a href="#l86.237"></a><span id="l86.237">   // search for head; we'll need this for meta tag additions</span>
<a href="#l86.238"></a><span id="l86.238">   let headelement = domdoc.querySelector(&quot;head&quot;);</span>
<a href="#l86.239"></a><span id="l86.239">   if (!headelement) {</span>
<a href="#l86.240"></a><span id="l86.240">     headelement = domdoc.createElement(&quot;head&quot;);</span>
<a href="#l86.241"></a><span id="l86.241" class="difflineminus">-    if (headelement) {</span>
<a href="#l86.242"></a><span id="l86.242" class="difflineminus">-      domdoc.insertAfter(headelement, domdoc.firstChild);</span>
<a href="#l86.243"></a><span id="l86.243" class="difflineminus">-    }</span>
<a href="#l86.244"></a><span id="l86.244" class="difflineplus">+    domdoc.insertAfter(headelement, domdoc.firstChild);</span>
<a href="#l86.245"></a><span id="l86.245">   }</span>
<a href="#l86.246"></a><span id="l86.246"> </span>
<a href="#l86.247"></a><span id="l86.247">   /* only set default prefs for new documents */</span>
<a href="#l86.248"></a><span id="l86.248">   if (!IsUrlAboutBlank(GetDocumentUrl())) {</span>
<a href="#l86.249"></a><span id="l86.249">     return;</span>
<a href="#l86.250"></a><span id="l86.250">   }</span>
<a href="#l86.251"></a><span id="l86.251"> </span>
<a href="#l86.252"></a><span id="l86.252">   // search for author meta tag.</span>
<a href="#l86.253"></a><span id="l86.253" class="difflineat">@@ -2597,18 +2595,18 @@ function EditorSetSelectionFromOffsets(s</span>
<a href="#l86.254"></a><span id="l86.254"> </span>
<a href="#l86.255"></a><span id="l86.255">       selection.addRange(range);</span>
<a href="#l86.256"></a><span id="l86.256">     }</span>
<a href="#l86.257"></a><span id="l86.257">   } catch (e) {}</span>
<a href="#l86.258"></a><span id="l86.258"> }</span>
<a href="#l86.259"></a><span id="l86.259"> </span>
<a href="#l86.260"></a><span id="l86.260"> // --------------------------------------------------------------------</span>
<a href="#l86.261"></a><span id="l86.261"> function initFontStyleMenu(menuPopup) {</span>
<a href="#l86.262"></a><span id="l86.262" class="difflineminus">-  for (var i = 0; i &lt; menuPopup.childNodes.length; i++) {</span>
<a href="#l86.263"></a><span id="l86.263" class="difflineminus">-    var menuItem = menuPopup.childNodes[i];</span>
<a href="#l86.264"></a><span id="l86.264" class="difflineplus">+  for (var i = 0; i &lt; menuPopup.children.length; i++) {</span>
<a href="#l86.265"></a><span id="l86.265" class="difflineplus">+    var menuItem = menuPopup.children[i];</span>
<a href="#l86.266"></a><span id="l86.266">     var theStyle = menuItem.getAttribute(&quot;state&quot;);</span>
<a href="#l86.267"></a><span id="l86.267">     if (theStyle) {</span>
<a href="#l86.268"></a><span id="l86.268">       menuItem.setAttribute(&quot;checked&quot;, theStyle);</span>
<a href="#l86.269"></a><span id="l86.269">     }</span>
<a href="#l86.270"></a><span id="l86.270">   }</span>
<a href="#l86.271"></a><span id="l86.271"> }</span>
<a href="#l86.272"></a><span id="l86.272"> </span>
<a href="#l86.273"></a><span id="l86.273"> // --------------------------------------------------------------------</span>
<a href="#l86.274"></a><span id="l86.274" class="difflineat">@@ -2829,18 +2827,18 @@ function goUpdateTableMenuItems(commands</span>
<a href="#l86.275"></a><span id="l86.275">       enabledIfTable = true;</span>
<a href="#l86.276"></a><span id="l86.276"> </span>
<a href="#l86.277"></a><span id="l86.277">       // All others require being inside a cell or selected cell</span>
<a href="#l86.278"></a><span id="l86.278">       enabled = tagNameObj.value == &quot;td&quot;;</span>
<a href="#l86.279"></a><span id="l86.279">     }</span>
<a href="#l86.280"></a><span id="l86.280">   }</span>
<a href="#l86.281"></a><span id="l86.281"> </span>
<a href="#l86.282"></a><span id="l86.282">   // Loop through command nodes</span>
<a href="#l86.283"></a><span id="l86.283" class="difflineminus">-  for (var i = 0; i &lt; commandset.childNodes.length; i++) {</span>
<a href="#l86.284"></a><span id="l86.284" class="difflineminus">-    var commandID = commandset.childNodes[i].getAttribute(&quot;id&quot;);</span>
<a href="#l86.285"></a><span id="l86.285" class="difflineplus">+  for (var i = 0; i &lt; commandset.children.length; i++) {</span>
<a href="#l86.286"></a><span id="l86.286" class="difflineplus">+    var commandID = commandset.children[i].getAttribute(&quot;id&quot;);</span>
<a href="#l86.287"></a><span id="l86.287">     if (commandID) {</span>
<a href="#l86.288"></a><span id="l86.288">       if (</span>
<a href="#l86.289"></a><span id="l86.289">         commandID == &quot;cmd_InsertTable&quot; ||</span>
<a href="#l86.290"></a><span id="l86.290">         commandID == &quot;cmd_JoinTableCells&quot; ||</span>
<a href="#l86.291"></a><span id="l86.291">         commandID == &quot;cmd_SplitTableCell&quot; ||</span>
<a href="#l86.292"></a><span id="l86.292">         commandID == &quot;cmd_ConvertToTable&quot;</span>
<a href="#l86.293"></a><span id="l86.293">       ) {</span>
<a href="#l86.294"></a><span id="l86.294">         // Call the update method in the command class</span>
<a href="#l86.295"></a><span id="l86.295" class="difflineat">@@ -3235,17 +3233,17 @@ function UpdateStructToolbar() {</span>
<a href="#l86.296"></a><span id="l86.296">     tag = element.nodeName.toLowerCase();</span>
<a href="#l86.297"></a><span id="l86.297"> </span>
<a href="#l86.298"></a><span id="l86.298">     button = document.createXULElement(&quot;toolbarbutton&quot;);</span>
<a href="#l86.299"></a><span id="l86.299">     button.setAttribute(&quot;label&quot;, &quot;&lt;&quot; + tag + &quot;&gt;&quot;);</span>
<a href="#l86.300"></a><span id="l86.300">     button.setAttribute(&quot;value&quot;, tag);</span>
<a href="#l86.301"></a><span id="l86.301">     button.setAttribute(&quot;context&quot;, &quot;structToolbarContext&quot;);</span>
<a href="#l86.302"></a><span id="l86.302">     button.className = &quot;struct-button&quot;;</span>
<a href="#l86.303"></a><span id="l86.303"> </span>
<a href="#l86.304"></a><span id="l86.304" class="difflineminus">-    toolbar.insertBefore(button, toolbar.firstChild);</span>
<a href="#l86.305"></a><span id="l86.305" class="difflineplus">+    toolbar.insertBefore(button, toolbar.firstElementChild);</span>
<a href="#l86.306"></a><span id="l86.306"> </span>
<a href="#l86.307"></a><span id="l86.307">     button.addEventListener(&quot;command&quot;, newCommandListener(element));</span>
<a href="#l86.308"></a><span id="l86.308"> </span>
<a href="#l86.309"></a><span id="l86.309">     button.addEventListener(</span>
<a href="#l86.310"></a><span id="l86.310">       &quot;contextmenu&quot;,</span>
<a href="#l86.311"></a><span id="l86.311">       newContextmenuListener(button, element)</span>
<a href="#l86.312"></a><span id="l86.312">     );</span>
<a href="#l86.313"></a><span id="l86.313"> </span>
<a href="#l86.314"></a><span id="l86.314" class="difflineat">@@ -3303,18 +3301,18 @@ function GetSelectionContainer() {</span>
<a href="#l86.315"></a><span id="l86.315">       // last char of the style. Assume the style element is selected for</span>
<a href="#l86.316"></a><span id="l86.316">       // user's pleasure</span>
<a href="#l86.317"></a><span id="l86.317">       if (</span>
<a href="#l86.318"></a><span id="l86.318">         !result.node &amp;&amp;</span>
<a href="#l86.319"></a><span id="l86.319">         range.startContainer.nodeType == Node.TEXT_NODE &amp;&amp;</span>
<a href="#l86.320"></a><span id="l86.320">         range.startOffset == range.startContainer.length &amp;&amp;</span>
<a href="#l86.321"></a><span id="l86.321">         range.endContainer.nodeType == Node.TEXT_NODE &amp;&amp;</span>
<a href="#l86.322"></a><span id="l86.322">         range.endOffset == range.endContainer.length &amp;&amp;</span>
<a href="#l86.323"></a><span id="l86.323" class="difflineminus">-        range.endContainer.nextSibling == null &amp;&amp;</span>
<a href="#l86.324"></a><span id="l86.324" class="difflineminus">-        range.startContainer.nextSibling == range.endContainer.parentNode</span>
<a href="#l86.325"></a><span id="l86.325" class="difflineplus">+        range.endContainer.nextElementSibling == null &amp;&amp;</span>
<a href="#l86.326"></a><span id="l86.326" class="difflineplus">+        range.startContainer.nextElementSibling == range.endContainer.parentNode</span>
<a href="#l86.327"></a><span id="l86.327">       ) {</span>
<a href="#l86.328"></a><span id="l86.328">         result.node = range.endContainer.parentNode;</span>
<a href="#l86.329"></a><span id="l86.329">       }</span>
<a href="#l86.330"></a><span id="l86.330"> </span>
<a href="#l86.331"></a><span id="l86.331">       if (!result.node) {</span>
<a href="#l86.332"></a><span id="l86.332">         // let's rely on the common ancestor of the selection</span>
<a href="#l86.333"></a><span id="l86.333">         result.node = range.commonAncestorContainer;</span>
<a href="#l86.334"></a><span id="l86.334">       } else {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l87.1"></a><span id="l87.1" class="difflineminus">--- a/mail/components/customizableui/CustomizableUI.jsm</span>
<a href="#l87.2"></a><span id="l87.2" class="difflineplus">+++ b/mail/components/customizableui/CustomizableUI.jsm</span>
<a href="#l87.3"></a><span id="l87.3" class="difflineat">@@ -1016,17 +1016,17 @@ var CustomizableUIInternal = {</span>
<a href="#l87.4"></a><span id="l87.4">         }</span>
<a href="#l87.5"></a><span id="l87.5">       }</span>
<a href="#l87.6"></a><span id="l87.6"> </span>
<a href="#l87.7"></a><span id="l87.7">       if (currentNode) {</span>
<a href="#l87.8"></a><span id="l87.8">         let palette = window.gNavToolbox ? window.gNavToolbox.palette : null;</span>
<a href="#l87.9"></a><span id="l87.9">         let limit = currentNode.previousElementSibling;</span>
<a href="#l87.10"></a><span id="l87.10">         let node = container.lastElementChild;</span>
<a href="#l87.11"></a><span id="l87.11">         while (node &amp;&amp; node != limit) {</span>
<a href="#l87.12"></a><span id="l87.12" class="difflineminus">-          let previousSibling = node.previousElementSibling;</span>
<a href="#l87.13"></a><span id="l87.13" class="difflineplus">+          let previousElementSibling = node.previousElementSibling;</span>
<a href="#l87.14"></a><span id="l87.14">           // Nodes opt-in to removability. If they're removable, and we haven't</span>
<a href="#l87.15"></a><span id="l87.15">           // seen them in the placements array, then we toss them into the palette</span>
<a href="#l87.16"></a><span id="l87.16">           // if one exists. If no palette exists, we just remove the node. If the</span>
<a href="#l87.17"></a><span id="l87.17">           // node is not removable, we leave it where it is. However, we can only</span>
<a href="#l87.18"></a><span id="l87.18">           // safely touch elements that have an ID - both because we depend on</span>
<a href="#l87.19"></a><span id="l87.19">           // IDs (or are specials), and because such elements are not intended to</span>
<a href="#l87.20"></a><span id="l87.20">           // be widgets (eg, titlebar-spacer elements).</span>
<a href="#l87.21"></a><span id="l87.21">           if (</span>
<a href="#l87.22"></a><span id="l87.22" class="difflineat">@@ -1053,17 +1053,17 @@ var CustomizableUIInternal = {</span>
<a href="#l87.23"></a><span id="l87.23">                   aArea +</span>
<a href="#l87.24"></a><span id="l87.24">                   &quot;: &quot; +</span>
<a href="#l87.25"></a><span id="l87.25">                   node.id</span>
<a href="#l87.26"></a><span id="l87.26">               );</span>
<a href="#l87.27"></a><span id="l87.27">               gPlacements.get(aArea).push(node.id);</span>
<a href="#l87.28"></a><span id="l87.28">               gDirty = true;</span>
<a href="#l87.29"></a><span id="l87.29">             }</span>
<a href="#l87.30"></a><span id="l87.30">           }</span>
<a href="#l87.31"></a><span id="l87.31" class="difflineminus">-          node = previousSibling;</span>
<a href="#l87.32"></a><span id="l87.32" class="difflineplus">+          node = previousElementSibling;</span>
<a href="#l87.33"></a><span id="l87.33">         }</span>
<a href="#l87.34"></a><span id="l87.34">       }</span>
<a href="#l87.35"></a><span id="l87.35"> </span>
<a href="#l87.36"></a><span id="l87.36">       // If there are placements in here which aren't removable from their original area,</span>
<a href="#l87.37"></a><span id="l87.37">       // we remove them from this area's placement array. They will (have) be(en) added</span>
<a href="#l87.38"></a><span id="l87.38">       // to their original area's placements array in the block above this one.</span>
<a href="#l87.39"></a><span id="l87.39">       if (placementsToRemove.size) {</span>
<a href="#l87.40"></a><span id="l87.40">         let placementAry = gPlacements.get(aArea);</span>
<a href="#l87.41"></a><span id="l87.41" class="difflineat">@@ -4436,18 +4436,18 @@ var CustomizableUI = {</span>
<a href="#l87.42"></a><span id="l87.42">    * @param aSubview the subview to clear.</span>
<a href="#l87.43"></a><span id="l87.43">    */</span>
<a href="#l87.44"></a><span id="l87.44">   clearSubview(aSubview) {</span>
<a href="#l87.45"></a><span id="l87.45">     let parent = aSubview.parentNode;</span>
<a href="#l87.46"></a><span id="l87.46">     // We'll take the container out of the document before cleaning it out</span>
<a href="#l87.47"></a><span id="l87.47">     // to avoid reflowing each time we remove something.</span>
<a href="#l87.48"></a><span id="l87.48">     parent.removeChild(aSubview);</span>
<a href="#l87.49"></a><span id="l87.49"> </span>
<a href="#l87.50"></a><span id="l87.50" class="difflineminus">-    while (aSubview.firstChild) {</span>
<a href="#l87.51"></a><span id="l87.51" class="difflineminus">-      aSubview.firstChild.remove();</span>
<a href="#l87.52"></a><span id="l87.52" class="difflineplus">+    while (aSubview.firstElementChild) {</span>
<a href="#l87.53"></a><span id="l87.53" class="difflineplus">+      aSubview.firstElementChild.remove();</span>
<a href="#l87.54"></a><span id="l87.54">     }</span>
<a href="#l87.55"></a><span id="l87.55"> </span>
<a href="#l87.56"></a><span id="l87.56">     parent.appendChild(aSubview);</span>
<a href="#l87.57"></a><span id="l87.57">   },</span>
<a href="#l87.58"></a><span id="l87.58"> </span>
<a href="#l87.59"></a><span id="l87.59">   getCustomizationTarget(aElement) {</span>
<a href="#l87.60"></a><span id="l87.60">     return CustomizableUIInternal.getCustomizationTarget(aElement);</span>
<a href="#l87.61"></a><span id="l87.61">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l88.1"></a><span id="l88.1" class="difflineminus">--- a/mail/components/customizableui/content/panelUI.js</span>
<a href="#l88.2"></a><span id="l88.2" class="difflineplus">+++ b/mail/components/customizableui/content/panelUI.js</span>
<a href="#l88.3"></a><span id="l88.3" class="difflineat">@@ -693,18 +693,18 @@ const PanelUI = {</span>
<a href="#l88.4"></a><span id="l88.4">    * See similar function FillAttachmentListPopup.</span>
<a href="#l88.5"></a><span id="l88.5">    *</span>
<a href="#l88.6"></a><span id="l88.6">    * @param {ViewShowingEvent} event  The &quot;ViewShowing&quot; event.</span>
<a href="#l88.7"></a><span id="l88.7">    */</span>
<a href="#l88.8"></a><span id="l88.8">   _onAttachmentsViewShow(event) {</span>
<a href="#l88.9"></a><span id="l88.9">     const viewBody = event.target.querySelector(&quot;.panel-subview-body&quot;);</span>
<a href="#l88.10"></a><span id="l88.10"> </span>
<a href="#l88.11"></a><span id="l88.11">     // First clear out the old attachment items. They are above the separator.</span>
<a href="#l88.12"></a><span id="l88.12" class="difflineminus">-    while (viewBody.firstChild.localName == &quot;toolbarbutton&quot;) {</span>
<a href="#l88.13"></a><span id="l88.13" class="difflineminus">-      viewBody.firstChild.remove();</span>
<a href="#l88.14"></a><span id="l88.14" class="difflineplus">+    while (viewBody.firstElementChild.localName == &quot;toolbarbutton&quot;) {</span>
<a href="#l88.15"></a><span id="l88.15" class="difflineplus">+      viewBody.firstElementChild.remove();</span>
<a href="#l88.16"></a><span id="l88.16">     }</span>
<a href="#l88.17"></a><span id="l88.17"> </span>
<a href="#l88.18"></a><span id="l88.18">     for (const [attachmentIndex, attachment] of currentAttachments.entries()) {</span>
<a href="#l88.19"></a><span id="l88.19">       PanelUI._addAttachmentToAttachmentsView(</span>
<a href="#l88.20"></a><span id="l88.20">         viewBody,</span>
<a href="#l88.21"></a><span id="l88.21">         attachment,</span>
<a href="#l88.22"></a><span id="l88.22">         attachmentIndex + 1</span>
<a href="#l88.23"></a><span id="l88.23">       );</span>
<a href="#l88.24"></a><span id="l88.24" class="difflineat">@@ -736,19 +736,17 @@ const PanelUI = {</span>
<a href="#l88.25"></a><span id="l88.25">       &quot;class&quot;,</span>
<a href="#l88.26"></a><span id="l88.26">       &quot;subviewbutton subviewbutton-iconic subviewbutton-nav&quot;</span>
<a href="#l88.27"></a><span id="l88.27">     );</span>
<a href="#l88.28"></a><span id="l88.28">     item.setAttribute(&quot;image&quot;, getIconForAttachment(attachment));</span>
<a href="#l88.29"></a><span id="l88.29">     item.setAttribute(&quot;closemenu&quot;, &quot;none&quot;);</span>
<a href="#l88.30"></a><span id="l88.30"> </span>
<a href="#l88.31"></a><span id="l88.31">     // Find the separator index.</span>
<a href="#l88.32"></a><span id="l88.32">     let separatorIndex = 0;</span>
<a href="#l88.33"></a><span id="l88.33" class="difflineminus">-    while (</span>
<a href="#l88.34"></a><span id="l88.34" class="difflineminus">-      viewBody.childNodes[separatorIndex].localName != &quot;toolbarseparator&quot;</span>
<a href="#l88.35"></a><span id="l88.35" class="difflineminus">-    ) {</span>
<a href="#l88.36"></a><span id="l88.36" class="difflineplus">+    while (viewBody.children[separatorIndex].localName != &quot;toolbarseparator&quot;) {</span>
<a href="#l88.37"></a><span id="l88.37">       separatorIndex += 1;</span>
<a href="#l88.38"></a><span id="l88.38">     }</span>
<a href="#l88.39"></a><span id="l88.39"> </span>
<a href="#l88.40"></a><span id="l88.40">     // The accesskeys for the attachments in the menu start with 1 (not 0).</span>
<a href="#l88.41"></a><span id="l88.41">     const displayName = SanitizeAttachmentDisplayName(attachment);</span>
<a href="#l88.42"></a><span id="l88.42">     const label = document</span>
<a href="#l88.43"></a><span id="l88.43">       .getElementById(&quot;bundle_messenger&quot;)</span>
<a href="#l88.44"></a><span id="l88.44">       .getFormattedString(&quot;attachmentDisplayNameFormat&quot;, [</span>
<a href="#l88.45"></a><span id="l88.45" class="difflineat">@@ -772,17 +770,17 @@ const PanelUI = {</span>
<a href="#l88.46"></a><span id="l88.46">     if (attachment.isDeleted) {</span>
<a href="#l88.47"></a><span id="l88.47">       item.classList.add(&quot;notfound&quot;);</span>
<a href="#l88.48"></a><span id="l88.48">     }</span>
<a href="#l88.49"></a><span id="l88.49"> </span>
<a href="#l88.50"></a><span id="l88.50">     if (!attachment.hasFile) {</span>
<a href="#l88.51"></a><span id="l88.51">       item.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l88.52"></a><span id="l88.52">     }</span>
<a href="#l88.53"></a><span id="l88.53"> </span>
<a href="#l88.54"></a><span id="l88.54" class="difflineminus">-    viewBody.insertBefore(item, viewBody.childNodes[separatorIndex]);</span>
<a href="#l88.55"></a><span id="l88.55" class="difflineplus">+    viewBody.insertBefore(item, viewBody.children[separatorIndex]);</span>
<a href="#l88.56"></a><span id="l88.56">   },</span>
<a href="#l88.57"></a><span id="l88.57"> </span>
<a href="#l88.58"></a><span id="l88.58">   /**</span>
<a href="#l88.59"></a><span id="l88.59">    * Refreshes and populates the single attachment view (open, save, etc.) when it is shown.</span>
<a href="#l88.60"></a><span id="l88.60">    * See similar function addAttachmentToPopup.</span>
<a href="#l88.61"></a><span id="l88.61">    *</span>
<a href="#l88.62"></a><span id="l88.62">    * @param {ViewShowingEvent} event  The &quot;ViewShowing&quot; event.</span>
<a href="#l88.63"></a><span id="l88.63">    */</span>
<a href="#l88.64"></a><span id="l88.64" class="difflineat">@@ -795,18 +793,18 @@ const PanelUI = {</span>
<a href="#l88.65"></a><span id="l88.65">     const canDetach = CanDetachAttachments() &amp;&amp; !deleted &amp;&amp; !detached;</span>
<a href="#l88.66"></a><span id="l88.66"> </span>
<a href="#l88.67"></a><span id="l88.67">     const attachmentView = document.getElementById(&quot;appMenu-attachmentView&quot;);</span>
<a href="#l88.68"></a><span id="l88.68">     attachmentView.setAttribute(&quot;title&quot;, attachment.name);</span>
<a href="#l88.69"></a><span id="l88.69"> </span>
<a href="#l88.70"></a><span id="l88.70">     const viewBody = attachmentView.querySelector(&quot;.panel-subview-body&quot;);</span>
<a href="#l88.71"></a><span id="l88.71"> </span>
<a href="#l88.72"></a><span id="l88.72">     // Clear out old view items.</span>
<a href="#l88.73"></a><span id="l88.73" class="difflineminus">-    while (viewBody.firstChild) {</span>
<a href="#l88.74"></a><span id="l88.74" class="difflineminus">-      viewBody.firstChild.remove();</span>
<a href="#l88.75"></a><span id="l88.75" class="difflineplus">+    while (viewBody.firstElementChild) {</span>
<a href="#l88.76"></a><span id="l88.76" class="difflineplus">+      viewBody.firstElementChild.remove();</span>
<a href="#l88.77"></a><span id="l88.77">     }</span>
<a href="#l88.78"></a><span id="l88.78"> </span>
<a href="#l88.79"></a><span id="l88.79">     // Create the &quot;open&quot; item.</span>
<a href="#l88.80"></a><span id="l88.80">     const openButton = document.createXULElement(&quot;toolbarbutton&quot;);</span>
<a href="#l88.81"></a><span id="l88.81">     openButton.attachment = attachment;</span>
<a href="#l88.82"></a><span id="l88.82">     openButton.setAttribute(&quot;class&quot;, &quot;subviewbutton subviewbutton-iconic&quot;);</span>
<a href="#l88.83"></a><span id="l88.83">     openButton.setAttribute(&quot;oncommand&quot;, &quot;this.attachment.open();&quot;);</span>
<a href="#l88.84"></a><span id="l88.84">     openButton.setAttribute(&quot;label&quot;, bundle.getString(&quot;openLabel&quot;));</span>
<a href="#l88.85"></a><span id="l88.85" class="difflineat">@@ -936,18 +934,18 @@ const PanelUI = {</span>
<a href="#l88.86"></a><span id="l88.86">    */</span>
<a href="#l88.87"></a><span id="l88.87">   _onTextEncodingViewShow(event) {</span>
<a href="#l88.88"></a><span id="l88.88">     const panelView = event.target;</span>
<a href="#l88.89"></a><span id="l88.89">     const doc = panelView.ownerDocument;</span>
<a href="#l88.90"></a><span id="l88.90">     const parent = panelView.querySelector(&quot;.panel-subview-body&quot;);</span>
<a href="#l88.91"></a><span id="l88.91">     const showDetectors = panelView.getAttribute(&quot;detectors&quot;) != &quot;false&quot;;</span>
<a href="#l88.92"></a><span id="l88.92"> </span>
<a href="#l88.93"></a><span id="l88.93">     // Clear the view before recreating it.</span>
<a href="#l88.94"></a><span id="l88.94" class="difflineminus">-    while (parent.firstChild) {</span>
<a href="#l88.95"></a><span id="l88.95" class="difflineminus">-      parent.firstChild.remove();</span>
<a href="#l88.96"></a><span id="l88.96" class="difflineplus">+    while (parent.firstElementChild) {</span>
<a href="#l88.97"></a><span id="l88.97" class="difflineplus">+      parent.firstElementChild.remove();</span>
<a href="#l88.98"></a><span id="l88.98">     }</span>
<a href="#l88.99"></a><span id="l88.99"> </span>
<a href="#l88.100"></a><span id="l88.100">     if (showDetectors) {</span>
<a href="#l88.101"></a><span id="l88.101">       // Add toolbarbutton for detectors subview.</span>
<a href="#l88.102"></a><span id="l88.102">       const node = doc.createXULElement(&quot;toolbarbutton&quot;);</span>
<a href="#l88.103"></a><span id="l88.103">       node.setAttribute(&quot;class&quot;, &quot;subviewbutton subviewbutton-nav&quot;);</span>
<a href="#l88.104"></a><span id="l88.104">       node.setAttribute(&quot;closemenu&quot;, &quot;none&quot;);</span>
<a href="#l88.105"></a><span id="l88.105"> </span>
<a href="#l88.106"></a><span id="l88.106" class="difflineat">@@ -998,18 +996,18 @@ const PanelUI = {</span>
<a href="#l88.107"></a><span id="l88.107">    * @param {ViewShowingEvent} event  ViewShowing event.</span>
<a href="#l88.108"></a><span id="l88.108">    */</span>
<a href="#l88.109"></a><span id="l88.109">   _onTextEncodingDetectorsViewShow(event) {</span>
<a href="#l88.110"></a><span id="l88.110">     const panelView = event.target;</span>
<a href="#l88.111"></a><span id="l88.111">     const parent = panelView.querySelector(&quot;.panel-subview-body&quot;);</span>
<a href="#l88.112"></a><span id="l88.112">     const doc = parent.ownerDocument;</span>
<a href="#l88.113"></a><span id="l88.113"> </span>
<a href="#l88.114"></a><span id="l88.114">     // Clear the view before recreating it.</span>
<a href="#l88.115"></a><span id="l88.115" class="difflineminus">-    while (parent.firstChild) {</span>
<a href="#l88.116"></a><span id="l88.116" class="difflineminus">-      parent.firstChild.remove();</span>
<a href="#l88.117"></a><span id="l88.117" class="difflineplus">+    while (parent.firstElementChild) {</span>
<a href="#l88.118"></a><span id="l88.118" class="difflineplus">+      parent.firstElementChild.remove();</span>
<a href="#l88.119"></a><span id="l88.119">     }</span>
<a href="#l88.120"></a><span id="l88.120"> </span>
<a href="#l88.121"></a><span id="l88.121">     // Populate the view with toolbarbuttons.</span>
<a href="#l88.122"></a><span id="l88.122">     panelView.setAttribute(</span>
<a href="#l88.123"></a><span id="l88.123">       &quot;title&quot;,</span>
<a href="#l88.124"></a><span id="l88.124">       gBundle.GetStringFromName(&quot;charsetMenuAutodet&quot;)</span>
<a href="#l88.125"></a><span id="l88.125">     );</span>
<a href="#l88.126"></a><span id="l88.126"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l89.1"></a><span id="l89.1" class="difflineminus">--- a/mail/components/downloads/content/aboutDownloads.js</span>
<a href="#l89.2"></a><span id="l89.2" class="difflineplus">+++ b/mail/components/downloads/content/aboutDownloads.js</span>
<a href="#l89.3"></a><span id="l89.3" class="difflineat">@@ -44,17 +44,17 @@ var DownloadsView = {</span>
<a href="#l89.4"></a><span id="l89.4">       // active downloads always before stopped downloads</span>
<a href="#l89.5"></a><span id="l89.5">       if (a.stopped != b.stopped) {</span>
<a href="#l89.6"></a><span id="l89.6">         return b.stopped ? -1 : 1;</span>
<a href="#l89.7"></a><span id="l89.7">       }</span>
<a href="#l89.8"></a><span id="l89.8">       // most recent downloads first</span>
<a href="#l89.9"></a><span id="l89.9">       return b.startTime - a.startTime;</span>
<a href="#l89.10"></a><span id="l89.10">     };</span>
<a href="#l89.11"></a><span id="l89.11"> </span>
<a href="#l89.12"></a><span id="l89.12" class="difflineminus">-    let at = this.listElement.firstChild;</span>
<a href="#l89.13"></a><span id="l89.13" class="difflineplus">+    let at = this.listElement.firstElementChild;</span>
<a href="#l89.14"></a><span id="l89.14">     while (at &amp;&amp; compare(aItem.download, at.download) &gt; 0) {</span>
<a href="#l89.15"></a><span id="l89.15">       at = at.nextElementSibling;</span>
<a href="#l89.16"></a><span id="l89.16">     }</span>
<a href="#l89.17"></a><span id="l89.17">     this.listElement.insertBefore(aItem.element, at);</span>
<a href="#l89.18"></a><span id="l89.18">   },</span>
<a href="#l89.19"></a><span id="l89.19"> </span>
<a href="#l89.20"></a><span id="l89.20">   onDownloadAdded(aDownload) {</span>
<a href="#l89.21"></a><span id="l89.21">     let isPurgedFromDisk = download =&gt; {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l90.1"></a><span id="l90.1" class="difflineminus">--- a/mail/components/extensions/parent/ext-menus.js</span>
<a href="#l90.2"></a><span id="l90.2" class="difflineplus">+++ b/mail/components/extensions/parent/ext-menus.js</span>
<a href="#l90.3"></a><span id="l90.3" class="difflineat">@@ -90,32 +90,32 @@ var gMenuBuilder = {</span>
<a href="#l90.4"></a><span id="l90.4">         onTab: true,</span>
<a href="#l90.5"></a><span id="l90.5">       };</span>
<a href="#l90.6"></a><span id="l90.6">     }</span>
<a href="#l90.7"></a><span id="l90.7">     throw new Error(</span>
<a href="#l90.8"></a><span id="l90.8">       `Unexpected overrideContext: ${webExtContextData.overrideContext}`</span>
<a href="#l90.9"></a><span id="l90.9">     );</span>
<a href="#l90.10"></a><span id="l90.10">   },</span>
<a href="#l90.11"></a><span id="l90.11"> </span>
<a href="#l90.12"></a><span id="l90.12" class="difflineminus">-  createAndInsertTopLevelElements(root, contextData, nextSibling) {</span>
<a href="#l90.13"></a><span id="l90.13" class="difflineplus">+  createAndInsertTopLevelElements(root, contextData, nextElementSibling) {</span>
<a href="#l90.14"></a><span id="l90.14">     let rootElements;</span>
<a href="#l90.15"></a><span id="l90.15">     if (contextData.onBrowserAction || contextData.onPageAction) {</span>
<a href="#l90.16"></a><span id="l90.16">       if (contextData.extension.id !== root.extension.id) {</span>
<a href="#l90.17"></a><span id="l90.17">         return;</span>
<a href="#l90.18"></a><span id="l90.18">       }</span>
<a href="#l90.19"></a><span id="l90.19">       rootElements = this.buildTopLevelElements(</span>
<a href="#l90.20"></a><span id="l90.20">         root,</span>
<a href="#l90.21"></a><span id="l90.21">         contextData,</span>
<a href="#l90.22"></a><span id="l90.22">         ACTION_MENU_TOP_LEVEL_LIMIT,</span>
<a href="#l90.23"></a><span id="l90.23">         false</span>
<a href="#l90.24"></a><span id="l90.24">       );</span>
<a href="#l90.25"></a><span id="l90.25"> </span>
<a href="#l90.26"></a><span id="l90.26">       // Action menu items are prepended to the menu, followed by a separator.</span>
<a href="#l90.27"></a><span id="l90.27" class="difflineminus">-      nextSibling = nextSibling || this.xulMenu.firstElementChild;</span>
<a href="#l90.28"></a><span id="l90.28" class="difflineminus">-      if (rootElements.length &amp;&amp; !this.itemsToCleanUp.has(nextSibling)) {</span>
<a href="#l90.29"></a><span id="l90.29" class="difflineplus">+      nextElementSibling = nextElementSibling || this.xulMenu.firstElementChild;</span>
<a href="#l90.30"></a><span id="l90.30" class="difflineplus">+      if (rootElements.length &amp;&amp; !this.itemsToCleanUp.has(nextElementSibling)) {</span>
<a href="#l90.31"></a><span id="l90.31">         rootElements.push(</span>
<a href="#l90.32"></a><span id="l90.32">           this.xulMenu.ownerDocument.createXULElement(&quot;menuseparator&quot;)</span>
<a href="#l90.33"></a><span id="l90.33">         );</span>
<a href="#l90.34"></a><span id="l90.34">       }</span>
<a href="#l90.35"></a><span id="l90.35">     } else if (contextData.webExtContextData) {</span>
<a href="#l90.36"></a><span id="l90.36">       let {</span>
<a href="#l90.37"></a><span id="l90.37">         extensionId,</span>
<a href="#l90.38"></a><span id="l90.38">         showDefaults,</span>
<a href="#l90.39"></a><span id="l90.39" class="difflineat">@@ -124,23 +124,23 @@ var gMenuBuilder = {</span>
<a href="#l90.40"></a><span id="l90.40">       if (extensionId === root.extension.id) {</span>
<a href="#l90.41"></a><span id="l90.41">         rootElements = this.buildTopLevelElements(</span>
<a href="#l90.42"></a><span id="l90.42">           root,</span>
<a href="#l90.43"></a><span id="l90.43">           contextData,</span>
<a href="#l90.44"></a><span id="l90.44">           Infinity,</span>
<a href="#l90.45"></a><span id="l90.45">           false</span>
<a href="#l90.46"></a><span id="l90.46">         );</span>
<a href="#l90.47"></a><span id="l90.47">         // The extension menu should be rendered at the top, but after the navigation buttons.</span>
<a href="#l90.48"></a><span id="l90.48" class="difflineminus">-        nextSibling =</span>
<a href="#l90.49"></a><span id="l90.49" class="difflineminus">-          nextSibling ||</span>
<a href="#l90.50"></a><span id="l90.50" class="difflineplus">+        nextElementSibling =</span>
<a href="#l90.51"></a><span id="l90.51" class="difflineplus">+          nextElementSibling ||</span>
<a href="#l90.52"></a><span id="l90.52">           this.xulMenu.querySelector(&quot;:scope &gt; #context-sep-navigation + *&quot;);</span>
<a href="#l90.53"></a><span id="l90.53">         if (</span>
<a href="#l90.54"></a><span id="l90.54">           rootElements.length &amp;&amp;</span>
<a href="#l90.55"></a><span id="l90.55">           showDefaults &amp;&amp;</span>
<a href="#l90.56"></a><span id="l90.56" class="difflineminus">-          !this.itemsToCleanUp.has(nextSibling)</span>
<a href="#l90.57"></a><span id="l90.57" class="difflineplus">+          !this.itemsToCleanUp.has(nextElementSibling)</span>
<a href="#l90.58"></a><span id="l90.58">         ) {</span>
<a href="#l90.59"></a><span id="l90.59">           rootElements.push(</span>
<a href="#l90.60"></a><span id="l90.60">             this.xulMenu.ownerDocument.createXULElement(&quot;menuseparator&quot;)</span>
<a href="#l90.61"></a><span id="l90.61">           );</span>
<a href="#l90.62"></a><span id="l90.62">         }</span>
<a href="#l90.63"></a><span id="l90.63">       } else if (!showDefaults &amp;&amp; !overrideContext) {</span>
<a href="#l90.64"></a><span id="l90.64">         // When the default menu items should be hidden, menu items from other</span>
<a href="#l90.65"></a><span id="l90.65">         // extensions should be hidden too.</span>
<a href="#l90.66"></a><span id="l90.66" class="difflineat">@@ -161,18 +161,18 @@ var gMenuBuilder = {</span>
<a href="#l90.67"></a><span id="l90.67">         );</span>
<a href="#l90.68"></a><span id="l90.68">       }</span>
<a href="#l90.69"></a><span id="l90.69">     }</span>
<a href="#l90.70"></a><span id="l90.70"> </span>
<a href="#l90.71"></a><span id="l90.71">     if (!rootElements.length) {</span>
<a href="#l90.72"></a><span id="l90.72">       return;</span>
<a href="#l90.73"></a><span id="l90.73">     }</span>
<a href="#l90.74"></a><span id="l90.74"> </span>
<a href="#l90.75"></a><span id="l90.75" class="difflineminus">-    if (nextSibling) {</span>
<a href="#l90.76"></a><span id="l90.76" class="difflineminus">-      nextSibling.before(...rootElements);</span>
<a href="#l90.77"></a><span id="l90.77" class="difflineplus">+    if (nextElementSibling) {</span>
<a href="#l90.78"></a><span id="l90.78" class="difflineplus">+      nextElementSibling.before(...rootElements);</span>
<a href="#l90.79"></a><span id="l90.79">     } else {</span>
<a href="#l90.80"></a><span id="l90.80">       this.xulMenu.append(...rootElements);</span>
<a href="#l90.81"></a><span id="l90.81">     }</span>
<a href="#l90.82"></a><span id="l90.82">     for (let item of rootElements) {</span>
<a href="#l90.83"></a><span id="l90.83">       this.itemsToCleanUp.add(item);</span>
<a href="#l90.84"></a><span id="l90.84">     }</span>
<a href="#l90.85"></a><span id="l90.85">   },</span>
<a href="#l90.86"></a><span id="l90.86"> </span>
<a href="#l90.87"></a><span id="l90.87" class="difflineat">@@ -503,28 +503,32 @@ var gMenuBuilder = {</span>
<a href="#l90.88"></a><span id="l90.88">     if (!contextData) {</span>
<a href="#l90.89"></a><span id="l90.89">       // This happens if the menu is not visible.</span>
<a href="#l90.90"></a><span id="l90.90">       return;</span>
<a href="#l90.91"></a><span id="l90.91">     }</span>
<a href="#l90.92"></a><span id="l90.92"> </span>
<a href="#l90.93"></a><span id="l90.93">     // Find the group of existing top-level items (usually 0 or 1 items)</span>
<a href="#l90.94"></a><span id="l90.94">     // and remember its position for when the new items are inserted.</span>
<a href="#l90.95"></a><span id="l90.95">     let elementIdPrefix = `${makeWidgetId(extension.id)}-menuitem-`;</span>
<a href="#l90.96"></a><span id="l90.96" class="difflineminus">-    let nextSibling = null;</span>
<a href="#l90.97"></a><span id="l90.97" class="difflineplus">+    let nextElementSibling = null;</span>
<a href="#l90.98"></a><span id="l90.98">     for (let item of this.itemsToCleanUp) {</span>
<a href="#l90.99"></a><span id="l90.99">       if (item.id &amp;&amp; item.id.startsWith(elementIdPrefix)) {</span>
<a href="#l90.100"></a><span id="l90.100" class="difflineminus">-        nextSibling = item.nextSibling;</span>
<a href="#l90.101"></a><span id="l90.101" class="difflineplus">+        nextElementSibling = item.nextElementSibling;</span>
<a href="#l90.102"></a><span id="l90.102">         item.remove();</span>
<a href="#l90.103"></a><span id="l90.103">         this.itemsToCleanUp.delete(item);</span>
<a href="#l90.104"></a><span id="l90.104">       }</span>
<a href="#l90.105"></a><span id="l90.105">     }</span>
<a href="#l90.106"></a><span id="l90.106"> </span>
<a href="#l90.107"></a><span id="l90.107">     let root = gRootItems.get(extension);</span>
<a href="#l90.108"></a><span id="l90.108">     if (root) {</span>
<a href="#l90.109"></a><span id="l90.109" class="difflineminus">-      this.createAndInsertTopLevelElements(root, contextData, nextSibling);</span>
<a href="#l90.110"></a><span id="l90.110" class="difflineplus">+      this.createAndInsertTopLevelElements(</span>
<a href="#l90.111"></a><span id="l90.111" class="difflineplus">+        root,</span>
<a href="#l90.112"></a><span id="l90.112" class="difflineplus">+        contextData,</span>
<a href="#l90.113"></a><span id="l90.113" class="difflineplus">+        nextElementSibling</span>
<a href="#l90.114"></a><span id="l90.114" class="difflineplus">+      );</span>
<a href="#l90.115"></a><span id="l90.115">     }</span>
<a href="#l90.116"></a><span id="l90.116">     this.removeSeparatorIfNoTopLevelItems();</span>
<a href="#l90.117"></a><span id="l90.117">   },</span>
<a href="#l90.118"></a><span id="l90.118"> </span>
<a href="#l90.119"></a><span id="l90.119">   // This should be called once, after constructing the top-level menus, if any.</span>
<a href="#l90.120"></a><span id="l90.120">   afterBuildingMenu(contextData) {</span>
<a href="#l90.121"></a><span id="l90.121">     function dispatchOnShownEvent(extension) {</span>
<a href="#l90.122"></a><span id="l90.122">       // Note: gShownMenuItems is a DefaultMap, so .get(extension) causes the</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l91.1"></a><span id="l91.1" class="difflineminus">--- a/mail/components/im/content/chat-conversation.js</span>
<a href="#l91.2"></a><span id="l91.2" class="difflineplus">+++ b/mail/components/im/content/chat-conversation.js</span>
<a href="#l91.3"></a><span id="l91.3" class="difflineat">@@ -1282,22 +1282,22 @@</span>
<a href="#l91.4"></a><span id="l91.4">           image = &quot;half-operator&quot;;</span>
<a href="#l91.5"></a><span id="l91.5">         } else if (buddy.voiced) {</span>
<a href="#l91.6"></a><span id="l91.6">           image = &quot;voice&quot;;</span>
<a href="#l91.7"></a><span id="l91.7">         } else if (buddy.founder) {</span>
<a href="#l91.8"></a><span id="l91.8">           image = &quot;founder&quot;;</span>
<a href="#l91.9"></a><span id="l91.9">         }</span>
<a href="#l91.10"></a><span id="l91.10">       }</span>
<a href="#l91.11"></a><span id="l91.11">       if (image) {</span>
<a href="#l91.12"></a><span id="l91.12" class="difflineminus">-        aItem.firstChild.setAttribute(</span>
<a href="#l91.13"></a><span id="l91.13" class="difflineplus">+        aItem.firstElementChild.setAttribute(</span>
<a href="#l91.14"></a><span id="l91.14">           &quot;src&quot;,</span>
<a href="#l91.15"></a><span id="l91.15">           &quot;chrome://messenger/skin/&quot; + image + &quot;.png&quot;</span>
<a href="#l91.16"></a><span id="l91.16">         );</span>
<a href="#l91.17"></a><span id="l91.17">       } else {</span>
<a href="#l91.18"></a><span id="l91.18" class="difflineminus">-        aItem.firstChild.removeAttribute(&quot;src&quot;);</span>
<a href="#l91.19"></a><span id="l91.19" class="difflineplus">+        aItem.firstElementChild.removeAttribute(&quot;src&quot;);</span>
<a href="#l91.20"></a><span id="l91.20">       }</span>
<a href="#l91.21"></a><span id="l91.21">     }</span>
<a href="#l91.22"></a><span id="l91.22"> </span>
<a href="#l91.23"></a><span id="l91.23">     /**</span>
<a href="#l91.24"></a><span id="l91.24">      * Compute color for a nick</span>
<a href="#l91.25"></a><span id="l91.25">      *</span>
<a href="#l91.26"></a><span id="l91.26">      * @param {String} aName</span>
<a href="#l91.27"></a><span id="l91.27">      */</span>
<a href="#l91.28"></a><span id="l91.28" class="difflineat">@@ -1389,17 +1389,17 @@</span>
<a href="#l91.29"></a><span id="l91.29">       let start = 0;</span>
<a href="#l91.30"></a><span id="l91.30">       let end = nicklist.itemCount;</span>
<a href="#l91.31"></a><span id="l91.31">       while (start &lt; end) {</span>
<a href="#l91.32"></a><span id="l91.32">         let middle = start + Math.floor((end - start) / 2);</span>
<a href="#l91.33"></a><span id="l91.33">         if (</span>
<a href="#l91.34"></a><span id="l91.34">           nick &lt;</span>
<a href="#l91.35"></a><span id="l91.35">           nicklist</span>
<a href="#l91.36"></a><span id="l91.36">             .getItemAtIndex(middle)</span>
<a href="#l91.37"></a><span id="l91.37" class="difflineminus">-            .firstChild.nextSibling.getAttribute(&quot;value&quot;)</span>
<a href="#l91.38"></a><span id="l91.38" class="difflineplus">+            .firstElementChild.nextElementSibling.getAttribute(&quot;value&quot;)</span>
<a href="#l91.39"></a><span id="l91.39">             .toLowerCase()</span>
<a href="#l91.40"></a><span id="l91.40">         ) {</span>
<a href="#l91.41"></a><span id="l91.41">           end = middle;</span>
<a href="#l91.42"></a><span id="l91.42">         } else {</span>
<a href="#l91.43"></a><span id="l91.43">           start = middle + 1;</span>
<a href="#l91.44"></a><span id="l91.44">         }</span>
<a href="#l91.45"></a><span id="l91.45">       }</span>
<a href="#l91.46"></a><span id="l91.46"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l92.1"></a><span id="l92.1" class="difflineminus">--- a/mail/components/im/content/chat-group.js</span>
<a href="#l92.2"></a><span id="l92.2" class="difflineplus">+++ b/mail/components/im/content/chat-group.js</span>
<a href="#l92.3"></a><span id="l92.3" class="difflineat">@@ -116,17 +116,17 @@</span>
<a href="#l92.4"></a><span id="l92.4">           if (this.sortComparator(contact, this.contacts[middle].contact) &lt; 0) {</span>
<a href="#l92.5"></a><span id="l92.5">             end = middle;</span>
<a href="#l92.6"></a><span id="l92.6">           } else {</span>
<a href="#l92.7"></a><span id="l92.7">             start = middle + 1;</span>
<a href="#l92.8"></a><span id="l92.8">           }</span>
<a href="#l92.9"></a><span id="l92.9">         }</span>
<a href="#l92.10"></a><span id="l92.10">       }</span>
<a href="#l92.11"></a><span id="l92.11">       let last = end == 0 ? this : this.contacts[end - 1];</span>
<a href="#l92.12"></a><span id="l92.12" class="difflineminus">-      this.parentNode.insertBefore(contactElt, last.nextSibling);</span>
<a href="#l92.13"></a><span id="l92.13" class="difflineplus">+      this.parentNode.insertBefore(contactElt, last.nextElementSibling);</span>
<a href="#l92.14"></a><span id="l92.14">       contactElt.build(contact);</span>
<a href="#l92.15"></a><span id="l92.15">       contactElt.group = this;</span>
<a href="#l92.16"></a><span id="l92.16">       this.contacts.splice(end, 0, contactElt);</span>
<a href="#l92.17"></a><span id="l92.17">       this.contactsById[contact.id] = contactElt;</span>
<a href="#l92.18"></a><span id="l92.18">       this.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l92.19"></a><span id="l92.19">       this._updateGroupLabel();</span>
<a href="#l92.20"></a><span id="l92.20">       return contactElt;</span>
<a href="#l92.21"></a><span id="l92.21">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l93.1"></a><span id="l93.1" class="difflineminus">--- a/mail/components/im/content/chat-imconv.js</span>
<a href="#l93.2"></a><span id="l93.2" class="difflineplus">+++ b/mail/components/im/content/chat-imconv.js</span>
<a href="#l93.3"></a><span id="l93.3" class="difflineat">@@ -245,17 +245,17 @@</span>
<a href="#l93.4"></a><span id="l93.4">       // the listbox will choke while updating the Chat tab title if</span>
<a href="#l93.5"></a><span id="l93.5">       // there are conversation nodes associated with a conversation</span>
<a href="#l93.6"></a><span id="l93.6">       // that no longer exists from the chat core's point of view, so</span>
<a href="#l93.7"></a><span id="l93.7">       // we do the actual selection change only after this conversation</span>
<a href="#l93.8"></a><span id="l93.8">       // item is fully destroyed and removed from the list.</span>
<a href="#l93.9"></a><span id="l93.9">       let newSelectedItem;</span>
<a href="#l93.10"></a><span id="l93.10">       let list = this.parentNode;</span>
<a href="#l93.11"></a><span id="l93.11">       if (list.selectedItem == this) {</span>
<a href="#l93.12"></a><span id="l93.12" class="difflineminus">-        newSelectedItem = this.previousSibling;</span>
<a href="#l93.13"></a><span id="l93.13" class="difflineplus">+        newSelectedItem = this.previousElementSibling;</span>
<a href="#l93.14"></a><span id="l93.14">       }</span>
<a href="#l93.15"></a><span id="l93.15"> </span>
<a href="#l93.16"></a><span id="l93.16">       if (this.log) {</span>
<a href="#l93.17"></a><span id="l93.17">         this.hidden = true;</span>
<a href="#l93.18"></a><span id="l93.18">         delete this.log;</span>
<a href="#l93.19"></a><span id="l93.19">       } else {</span>
<a href="#l93.20"></a><span id="l93.20">         this.remove();</span>
<a href="#l93.21"></a><span id="l93.21">         delete this.conv;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l94.1"></a><span id="l94.1" class="difflineminus">--- a/mail/components/im/content/chat-messenger.js</span>
<a href="#l94.2"></a><span id="l94.2" class="difflineplus">+++ b/mail/components/im/content/chat-messenger.js</span>
<a href="#l94.3"></a><span id="l94.3" class="difflineat">@@ -417,18 +417,18 @@ var chatHandler = {</span>
<a href="#l94.4"></a><span id="l94.4">     let list = document.getElementById(&quot;contactlistbox&quot;);</span>
<a href="#l94.5"></a><span id="l94.5">     let convs = document.getElementById(&quot;conversationsGroup&quot;);</span>
<a href="#l94.6"></a><span id="l94.6">     let selectedItem = list.selectedItem;</span>
<a href="#l94.7"></a><span id="l94.7">     let shouldSelect =</span>
<a href="#l94.8"></a><span id="l94.8">       gChatTab &amp;&amp;</span>
<a href="#l94.9"></a><span id="l94.9">       gChatTab.tabNode.selected &amp;&amp;</span>
<a href="#l94.10"></a><span id="l94.10">       (!selectedItem ||</span>
<a href="#l94.11"></a><span id="l94.11">         (selectedItem == convs &amp;&amp;</span>
<a href="#l94.12"></a><span id="l94.12" class="difflineminus">-          convs.nextSibling.localName != &quot;richlistitem&quot; &amp;&amp;</span>
<a href="#l94.13"></a><span id="l94.13" class="difflineminus">-          convs.nextSibling.getAttribute(&quot;is&quot;) != &quot;chat-imconv&quot;));</span>
<a href="#l94.14"></a><span id="l94.14" class="difflineplus">+          convs.nextElementSibling.localName != &quot;richlistitem&quot; &amp;&amp;</span>
<a href="#l94.15"></a><span id="l94.15" class="difflineplus">+          convs.nextElementSibling.getAttribute(&quot;is&quot;) != &quot;chat-imconv&quot;));</span>
<a href="#l94.16"></a><span id="l94.16">     let elt = convs.addContact(aConv, &quot;imconv&quot;);</span>
<a href="#l94.17"></a><span id="l94.17">     if (shouldSelect) {</span>
<a href="#l94.18"></a><span id="l94.18">       list.selectedItem = elt;</span>
<a href="#l94.19"></a><span id="l94.19">     }</span>
<a href="#l94.20"></a><span id="l94.20"> </span>
<a href="#l94.21"></a><span id="l94.21">     if (aConv.isChat || !aConv.buddy) {</span>
<a href="#l94.22"></a><span id="l94.22">       return;</span>
<a href="#l94.23"></a><span id="l94.23">     }</span>
<a href="#l94.24"></a><span id="l94.24" class="difflineat">@@ -1156,27 +1156,27 @@ var chatHandler = {</span>
<a href="#l94.25"></a><span id="l94.25">       selectedItem.directedUnreadCount</span>
<a href="#l94.26"></a><span id="l94.26">     ) {</span>
<a href="#l94.27"></a><span id="l94.27">       selectedItem.update();</span>
<a href="#l94.28"></a><span id="l94.28">       return;</span>
<a href="#l94.29"></a><span id="l94.29">     }</span>
<a href="#l94.30"></a><span id="l94.30"> </span>
<a href="#l94.31"></a><span id="l94.31">     let firstConv;</span>
<a href="#l94.32"></a><span id="l94.32">     let convs = document.getElementById(&quot;conversationsGroup&quot;);</span>
<a href="#l94.33"></a><span id="l94.33" class="difflineminus">-    let conv = convs.nextSibling;</span>
<a href="#l94.34"></a><span id="l94.34" class="difflineplus">+    let conv = convs.nextElementSibling;</span>
<a href="#l94.35"></a><span id="l94.35">     while (conv.id != &quot;searchResultConv&quot;) {</span>
<a href="#l94.36"></a><span id="l94.36">       if (!firstConv) {</span>
<a href="#l94.37"></a><span id="l94.37">         firstConv = conv;</span>
<a href="#l94.38"></a><span id="l94.38">       }</span>
<a href="#l94.39"></a><span id="l94.39">       // If there is a conversation with unread messages, select it.</span>
<a href="#l94.40"></a><span id="l94.40">       if (conv.directedUnreadCount) {</span>
<a href="#l94.41"></a><span id="l94.41">         list.selectedItem = conv;</span>
<a href="#l94.42"></a><span id="l94.42">         return;</span>
<a href="#l94.43"></a><span id="l94.43">       }</span>
<a href="#l94.44"></a><span id="l94.44" class="difflineminus">-      conv = conv.nextSibling;</span>
<a href="#l94.45"></a><span id="l94.45" class="difflineplus">+      conv = conv.nextElementSibling;</span>
<a href="#l94.46"></a><span id="l94.46">     }</span>
<a href="#l94.47"></a><span id="l94.47"> </span>
<a href="#l94.48"></a><span id="l94.48">     // No unread messages, select the first conversation, but only if</span>
<a href="#l94.49"></a><span id="l94.49">     // the existing selection is uninteresting (a section header).</span>
<a href="#l94.50"></a><span id="l94.50">     if (firstConv) {</span>
<a href="#l94.51"></a><span id="l94.51">       if (</span>
<a href="#l94.52"></a><span id="l94.52">         !selectedItem ||</span>
<a href="#l94.53"></a><span id="l94.53">         (selectedItem.localName == &quot;richlistitem&quot; &amp;&amp;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l95.1"></a><span id="l95.1" class="difflineminus">--- a/mail/components/im/content/imAccounts.js</span>
<a href="#l95.2"></a><span id="l95.2" class="difflineplus">+++ b/mail/components/im/content/imAccounts.js</span>
<a href="#l95.3"></a><span id="l95.3" class="difflineat">@@ -722,17 +722,17 @@ var gAMDragAndDrop = {</span>
<a href="#l95.4"></a><span id="l95.4">     );</span>
<a href="#l95.5"></a><span id="l95.5">   },</span>
<a href="#l95.6"></a><span id="l95.6"> </span>
<a href="#l95.7"></a><span id="l95.7">   onDragOver(aEvent, aFlavour, aSession) {</span>
<a href="#l95.8"></a><span id="l95.8">     let accountElement = aEvent.explicitOriginalTarget;</span>
<a href="#l95.9"></a><span id="l95.9">     // We are dragging over the account manager, consider it is the same as</span>
<a href="#l95.10"></a><span id="l95.10">     // the last element.</span>
<a href="#l95.11"></a><span id="l95.11">     if (accountElement == gAccountManager.accountList) {</span>
<a href="#l95.12"></a><span id="l95.12" class="difflineminus">-      accountElement = gAccountManager.accountList.lastChild;</span>
<a href="#l95.13"></a><span id="l95.13" class="difflineplus">+      accountElement = gAccountManager.accountList.lastElementChild;</span>
<a href="#l95.14"></a><span id="l95.14">     }</span>
<a href="#l95.15"></a><span id="l95.15"> </span>
<a href="#l95.16"></a><span id="l95.16">     // Auto scroll the account list if we are dragging at the top/bottom</span>
<a href="#l95.17"></a><span id="l95.17">     this.checkForMagicScroll(aEvent.clientY);</span>
<a href="#l95.18"></a><span id="l95.18"> </span>
<a href="#l95.19"></a><span id="l95.19">     // The hovered element has changed, change the border too</span>
<a href="#l95.20"></a><span id="l95.20">     if (&quot;_accountElement&quot; in this &amp;&amp; this._accountElement != accountElement) {</span>
<a href="#l95.21"></a><span id="l95.21">       this.cleanBorders();</span>
<a href="#l95.22"></a><span id="l95.22" class="difflineat">@@ -745,17 +745,17 @@ var gAMDragAndDrop = {</span>
<a href="#l95.23"></a><span id="l95.23">     aEvent.dataTransfer.dropEffect = &quot;move&quot;;</span>
<a href="#l95.24"></a><span id="l95.24"> </span>
<a href="#l95.25"></a><span id="l95.25">     if (</span>
<a href="#l95.26"></a><span id="l95.26">       aEvent.clientY &lt;</span>
<a href="#l95.27"></a><span id="l95.27">       accountElement.getBoundingClientRect().top +</span>
<a href="#l95.28"></a><span id="l95.28">         accountElement.clientHeight / 2</span>
<a href="#l95.29"></a><span id="l95.29">     ) {</span>
<a href="#l95.30"></a><span id="l95.30">       // we don't want the previous item to show its default bottom-border</span>
<a href="#l95.31"></a><span id="l95.31" class="difflineminus">-      let previousItem = accountElement.previousSibling;</span>
<a href="#l95.32"></a><span id="l95.32" class="difflineplus">+      let previousItem = accountElement.previousElementSibling;</span>
<a href="#l95.33"></a><span id="l95.33">       if (previousItem) {</span>
<a href="#l95.34"></a><span id="l95.34">         previousItem.style.borderBottom = &quot;none&quot;;</span>
<a href="#l95.35"></a><span id="l95.35">       }</span>
<a href="#l95.36"></a><span id="l95.36">       accountElement.setAttribute(&quot;dragover&quot;, &quot;up&quot;);</span>
<a href="#l95.37"></a><span id="l95.37">     } else {</span>
<a href="#l95.38"></a><span id="l95.38">       if (</span>
<a href="#l95.39"></a><span id="l95.39">         &quot;_accountElement&quot; in this &amp;&amp;</span>
<a href="#l95.40"></a><span id="l95.40">         this._accountElement == accountElement &amp;&amp;</span>
<a href="#l95.41"></a><span id="l95.41" class="difflineat">@@ -771,37 +771,37 @@ var gAMDragAndDrop = {</span>
<a href="#l95.42"></a><span id="l95.42"> </span>
<a href="#l95.43"></a><span id="l95.43">   cleanBorders(aIsEnd) {</span>
<a href="#l95.44"></a><span id="l95.44">     if (!this._accountElement) {</span>
<a href="#l95.45"></a><span id="l95.45">       return;</span>
<a href="#l95.46"></a><span id="l95.46">     }</span>
<a href="#l95.47"></a><span id="l95.47"> </span>
<a href="#l95.48"></a><span id="l95.48">     this._accountElement.removeAttribute(&quot;dragover&quot;);</span>
<a href="#l95.49"></a><span id="l95.49">     // reset the border of the previous element</span>
<a href="#l95.50"></a><span id="l95.50" class="difflineminus">-    let previousItem = this._accountElement.previousSibling;</span>
<a href="#l95.51"></a><span id="l95.51" class="difflineplus">+    let previousItem = this._accountElement.previousElementSibling;</span>
<a href="#l95.52"></a><span id="l95.52">     if (previousItem) {</span>
<a href="#l95.53"></a><span id="l95.53">       if (</span>
<a href="#l95.54"></a><span id="l95.54">         aIsEnd &amp;&amp;</span>
<a href="#l95.55"></a><span id="l95.55">         !previousItem.style.borderBottom &amp;&amp;</span>
<a href="#l95.56"></a><span id="l95.56" class="difflineminus">-        previousItem.previousSibling</span>
<a href="#l95.57"></a><span id="l95.57" class="difflineplus">+        previousItem.previousElementSibling</span>
<a href="#l95.58"></a><span id="l95.58">       ) {</span>
<a href="#l95.59"></a><span id="l95.59" class="difflineminus">-        previousItem = previousItem.previousSibling;</span>
<a href="#l95.60"></a><span id="l95.60" class="difflineplus">+        previousItem = previousItem.previousElementSibling;</span>
<a href="#l95.61"></a><span id="l95.61">       }</span>
<a href="#l95.62"></a><span id="l95.62">       previousItem.style.borderBottom = &quot;&quot;;</span>
<a href="#l95.63"></a><span id="l95.63">     }</span>
<a href="#l95.64"></a><span id="l95.64"> </span>
<a href="#l95.65"></a><span id="l95.65">     if (aIsEnd) {</span>
<a href="#l95.66"></a><span id="l95.66">       delete this._accountElement;</span>
<a href="#l95.67"></a><span id="l95.67">     }</span>
<a href="#l95.68"></a><span id="l95.68">   },</span>
<a href="#l95.69"></a><span id="l95.69"> </span>
<a href="#l95.70"></a><span id="l95.70">   canDrop(aEvent, aSession) {</span>
<a href="#l95.71"></a><span id="l95.71">     let accountElement = aEvent.explicitOriginalTarget;</span>
<a href="#l95.72"></a><span id="l95.72">     if (accountElement == gAccountManager.accountList) {</span>
<a href="#l95.73"></a><span id="l95.73" class="difflineminus">-      accountElement = gAccountManager.accountList.lastChild;</span>
<a href="#l95.74"></a><span id="l95.74" class="difflineplus">+      accountElement = gAccountManager.accountList.lastElementChild;</span>
<a href="#l95.75"></a><span id="l95.75">     }</span>
<a href="#l95.76"></a><span id="l95.76">     return accountElement != gAccountManager.accountList.selectedItem;</span>
<a href="#l95.77"></a><span id="l95.77">   },</span>
<a href="#l95.78"></a><span id="l95.78"> </span>
<a href="#l95.79"></a><span id="l95.79">   checkForMagicScroll(aClientY) {</span>
<a href="#l95.80"></a><span id="l95.80">     let accountList = gAccountManager.accountList;</span>
<a href="#l95.81"></a><span id="l95.81">     let listSize = accountList.getBoundingClientRect();</span>
<a href="#l95.82"></a><span id="l95.82">     let direction = 1;</span>
<a href="#l95.83"></a><span id="l95.83" class="difflineat">@@ -813,17 +813,17 @@ var gAMDragAndDrop = {</span>
<a href="#l95.84"></a><span id="l95.84">     }</span>
<a href="#l95.85"></a><span id="l95.85"> </span>
<a href="#l95.86"></a><span id="l95.86">     accountList.scrollTop += direction * this.SCROLL_SPEED;</span>
<a href="#l95.87"></a><span id="l95.87">   },</span>
<a href="#l95.88"></a><span id="l95.88"> </span>
<a href="#l95.89"></a><span id="l95.89">   onDrop(aEvent, aTransferData, aSession) {</span>
<a href="#l95.90"></a><span id="l95.90">     let accountElement = aEvent.explicitOriginalTarget;</span>
<a href="#l95.91"></a><span id="l95.91">     if (accountElement == gAccountManager.accountList) {</span>
<a href="#l95.92"></a><span id="l95.92" class="difflineminus">-      accountElement = gAccountManager.accountList.lastChild;</span>
<a href="#l95.93"></a><span id="l95.93" class="difflineplus">+      accountElement = gAccountManager.accountList.lastElementChild;</span>
<a href="#l95.94"></a><span id="l95.94">     }</span>
<a href="#l95.95"></a><span id="l95.95"> </span>
<a href="#l95.96"></a><span id="l95.96">     if (!aSession.canDrop) {</span>
<a href="#l95.97"></a><span id="l95.97">       return;</span>
<a href="#l95.98"></a><span id="l95.98">     }</span>
<a href="#l95.99"></a><span id="l95.99"> </span>
<a href="#l95.100"></a><span id="l95.100">     // compute the destination</span>
<a href="#l95.101"></a><span id="l95.101">     let accountList = gAccountManager.accountList;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l96.1"></a><span id="l96.1" class="difflineminus">--- a/mail/components/im/content/imContextMenu.js</span>
<a href="#l96.2"></a><span id="l96.2" class="difflineplus">+++ b/mail/components/im/content/imContextMenu.js</span>
<a href="#l96.3"></a><span id="l96.3" class="difflineat">@@ -31,20 +31,21 @@ function imContextMenu(aXulMenu) {</span>
<a href="#l96.4"></a><span id="l96.4"> </span>
<a href="#l96.5"></a><span id="l96.5">   // Initialize new menu.</span>
<a href="#l96.6"></a><span id="l96.6">   this.initMenu(aXulMenu);</span>
<a href="#l96.7"></a><span id="l96.7"> }</span>
<a href="#l96.8"></a><span id="l96.8"> </span>
<a href="#l96.9"></a><span id="l96.9"> // Prototype for nsContextMenu &quot;class.&quot;</span>
<a href="#l96.10"></a><span id="l96.10"> imContextMenu.prototype = {</span>
<a href="#l96.11"></a><span id="l96.11">   cleanup() {</span>
<a href="#l96.12"></a><span id="l96.12" class="difflineminus">-    let elt = document.getElementById(&quot;context-sep-messageactions&quot;).nextSibling;</span>
<a href="#l96.13"></a><span id="l96.13" class="difflineplus">+    let elt = document.getElementById(&quot;context-sep-messageactions&quot;)</span>
<a href="#l96.14"></a><span id="l96.14" class="difflineplus">+      .nextElementSibling;</span>
<a href="#l96.15"></a><span id="l96.15">     // remove the action menuitems added last time we opened the popup</span>
<a href="#l96.16"></a><span id="l96.16">     while (elt &amp;&amp; elt.localName != &quot;menuseparator&quot;) {</span>
<a href="#l96.17"></a><span id="l96.17" class="difflineminus">-      let tmp = elt.nextSibling;</span>
<a href="#l96.18"></a><span id="l96.18" class="difflineplus">+      let tmp = elt.nextElementSibling;</span>
<a href="#l96.19"></a><span id="l96.19">       elt.remove();</span>
<a href="#l96.20"></a><span id="l96.20">       elt = tmp;</span>
<a href="#l96.21"></a><span id="l96.21">     }</span>
<a href="#l96.22"></a><span id="l96.22">   },</span>
<a href="#l96.23"></a><span id="l96.23"> </span>
<a href="#l96.24"></a><span id="l96.24">   // Initialize context menu.</span>
<a href="#l96.25"></a><span id="l96.25">   initMenu(aPopup) {</span>
<a href="#l96.26"></a><span id="l96.26">     this.menu = aPopup;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l97.1"></a><span id="l97.1" class="difflineminus">--- a/mail/components/im/messages/bubbles/Footer.html</span>
<a href="#l97.2"></a><span id="l97.2" class="difflineplus">+++ b/mail/components/im/messages/bubbles/Footer.html</span>
<a href="#l97.3"></a><span id="l97.3" class="difflineat">@@ -190,17 +190,17 @@ function checkNewText(target) {</span>
<a href="#l97.4"></a><span id="l97.4"> </span>
<a href="#l97.5"></a><span id="l97.5">   var msgTime = null;</span>
<a href="#l97.6"></a><span id="l97.6">   if (target._originalMsg) {</span>
<a href="#l97.7"></a><span id="l97.7">     msgTime = target._originalMsg.time;</span>
<a href="#l97.8"></a><span id="l97.8">   }</span>
<a href="#l97.9"></a><span id="l97.9">   if (target.tagName == &quot;DIV&quot; &amp;&amp; target.classList.contains(&quot;bubble&quot;)) {</span>
<a href="#l97.10"></a><span id="l97.10">     setColors(target);</span>
<a href="#l97.11"></a><span id="l97.11"> </span>
<a href="#l97.12"></a><span id="l97.12" class="difflineminus">-    var prev = target.previousSibling;</span>
<a href="#l97.13"></a><span id="l97.13" class="difflineplus">+    var prev = target.previousElementSibling;</span>
<a href="#l97.14"></a><span id="l97.14">     var shouldSetUnreadRuler = prev &amp;&amp; prev.id &amp;&amp; prev.id == &quot;unread-ruler&quot;;</span>
<a href="#l97.15"></a><span id="l97.15">     var shouldSetSessionRuler = prev &amp;&amp; prev.className &amp;&amp; prev.className == &quot;sessionstart-ruler&quot;;</span>
<a href="#l97.16"></a><span id="l97.16">     // We need an extra pixel of margin at the top to make the margins appear</span>
<a href="#l97.17"></a><span id="l97.17">     // to be of equal size, since the preceding bubble will have a shadow.</span>
<a href="#l97.18"></a><span id="l97.18">     var rulerMarginBottom = kRulerMarginTop - 1;</span>
<a href="#l97.19"></a><span id="l97.19"> </span>
<a href="#l97.20"></a><span id="l97.20">     if (lastMsgTime &amp;&amp; msgTime &gt;= lastMsgTime) {</span>
<a href="#l97.21"></a><span id="l97.21">       var interval = msgTime - lastMsgTime;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l98.1"></a><span id="l98.1" class="difflineminus">--- a/mail/components/migration/content/migration.js</span>
<a href="#l98.2"></a><span id="l98.2" class="difflineplus">+++ b/mail/components/migration/content/migration.js</span>
<a href="#l98.3"></a><span id="l98.3" class="difflineat">@@ -121,32 +121,32 @@ var MigrationWizard = {</span>
<a href="#l98.4"></a><span id="l98.4"> </span>
<a href="#l98.5"></a><span id="l98.5">   // 1 - Import Source</span>
<a href="#l98.6"></a><span id="l98.6">   onImportSourcePageShow() {</span>
<a href="#l98.7"></a><span id="l98.7">     this._wiz.canRewind = false;</span>
<a href="#l98.8"></a><span id="l98.8">     this._wiz.canAdvance = false;</span>
<a href="#l98.9"></a><span id="l98.9"> </span>
<a href="#l98.10"></a><span id="l98.10">     // Figure out what source apps are are available to import from:</span>
<a href="#l98.11"></a><span id="l98.11">     var group = document.getElementById(&quot;importSourceGroup&quot;);</span>
<a href="#l98.12"></a><span id="l98.12" class="difflineminus">-    for (let childNode of group.childNodes) {</span>
<a href="#l98.13"></a><span id="l98.13" class="difflineplus">+    for (let childNode of group.children) {</span>
<a href="#l98.14"></a><span id="l98.14">       let suffix = childNode.id;</span>
<a href="#l98.15"></a><span id="l98.15">       if (suffix != &quot;nothing&quot;) {</span>
<a href="#l98.16"></a><span id="l98.16">         var contractID = kProfileMigratorContractIDPrefix + suffix;</span>
<a href="#l98.17"></a><span id="l98.17">         var migrator = Cc[contractID].createInstance(kIMig);</span>
<a href="#l98.18"></a><span id="l98.18">         if (!migrator.sourceExists) {</span>
<a href="#l98.19"></a><span id="l98.19">           childNode.hidden = true;</span>
<a href="#l98.20"></a><span id="l98.20">           if (this._source == suffix) {</span>
<a href="#l98.21"></a><span id="l98.21">             this._source = null;</span>
<a href="#l98.22"></a><span id="l98.22">           }</span>
<a href="#l98.23"></a><span id="l98.23">         }</span>
<a href="#l98.24"></a><span id="l98.24">       }</span>
<a href="#l98.25"></a><span id="l98.25">     }</span>
<a href="#l98.26"></a><span id="l98.26"> </span>
<a href="#l98.27"></a><span id="l98.27">     var firstNonDisabled = null;</span>
<a href="#l98.28"></a><span id="l98.28" class="difflineminus">-    for (let childNode of group.childNodes) {</span>
<a href="#l98.29"></a><span id="l98.29" class="difflineplus">+    for (let childNode of group.children) {</span>
<a href="#l98.30"></a><span id="l98.30">       if (!childNode.hidden &amp;&amp; !childNode.disabled) {</span>
<a href="#l98.31"></a><span id="l98.31">         firstNonDisabled = childNode;</span>
<a href="#l98.32"></a><span id="l98.32">         break;</span>
<a href="#l98.33"></a><span id="l98.33">       }</span>
<a href="#l98.34"></a><span id="l98.34">     }</span>
<a href="#l98.35"></a><span id="l98.35">     group.selectedItem =</span>
<a href="#l98.36"></a><span id="l98.36">       this._source == &quot;&quot;</span>
<a href="#l98.37"></a><span id="l98.37">         ? firstNonDisabled</span>
<a href="#l98.38"></a><span id="l98.38" class="difflineat">@@ -220,17 +220,17 @@ var MigrationWizard = {</span>
<a href="#l98.39"></a><span id="l98.39">       var item = document.createXULElement(&quot;radio&quot;);</span>
<a href="#l98.40"></a><span id="l98.40">       item.id = sourceProfiles.queryElementAt(i, nsISupportsString).data;</span>
<a href="#l98.41"></a><span id="l98.41">       item.setAttribute(&quot;label&quot;, item.id);</span>
<a href="#l98.42"></a><span id="l98.42">       profiles.appendChild(item);</span>
<a href="#l98.43"></a><span id="l98.43">     }</span>
<a href="#l98.44"></a><span id="l98.44"> </span>
<a href="#l98.45"></a><span id="l98.45">     profiles.selectedItem = this._selectedProfile</span>
<a href="#l98.46"></a><span id="l98.46">       ? document.getElementById(this._selectedProfile)</span>
<a href="#l98.47"></a><span id="l98.47" class="difflineminus">-      : profiles.firstChild;</span>
<a href="#l98.48"></a><span id="l98.48" class="difflineplus">+      : profiles.firstElementChild;</span>
<a href="#l98.49"></a><span id="l98.49">   },</span>
<a href="#l98.50"></a><span id="l98.50"> </span>
<a href="#l98.51"></a><span id="l98.51">   onSelectProfilePageRewound() {</span>
<a href="#l98.52"></a><span id="l98.52">     var profiles = document.getElementById(&quot;profiles&quot;);</span>
<a href="#l98.53"></a><span id="l98.53">     this._selectedProfile = profiles.selectedItem.id;</span>
<a href="#l98.54"></a><span id="l98.54">   },</span>
<a href="#l98.55"></a><span id="l98.55"> </span>
<a href="#l98.56"></a><span id="l98.56">   onSelectProfilePageAdvanced() {</span>
<a href="#l98.57"></a><span id="l98.57" class="difflineat">@@ -271,18 +271,18 @@ var MigrationWizard = {</span>
<a href="#l98.58"></a><span id="l98.58">         }</span>
<a href="#l98.59"></a><span id="l98.59">       }</span>
<a href="#l98.60"></a><span id="l98.60">     }</span>
<a href="#l98.61"></a><span id="l98.61">   },</span>
<a href="#l98.62"></a><span id="l98.62"> </span>
<a href="#l98.63"></a><span id="l98.63">   onImportItemsPageAdvanced() {</span>
<a href="#l98.64"></a><span id="l98.64">     var dataSources = document.getElementById(&quot;dataSources&quot;);</span>
<a href="#l98.65"></a><span id="l98.65">     this._itemsFlags = 0;</span>
<a href="#l98.66"></a><span id="l98.66" class="difflineminus">-    for (var i = 0; i &lt; dataSources.childNodes.length; ++i) {</span>
<a href="#l98.67"></a><span id="l98.67" class="difflineminus">-      var checkbox = dataSources.childNodes[i];</span>
<a href="#l98.68"></a><span id="l98.68" class="difflineplus">+    for (var i = 0; i &lt; dataSources.children.length; ++i) {</span>
<a href="#l98.69"></a><span id="l98.69" class="difflineplus">+      var checkbox = dataSources.children[i];</span>
<a href="#l98.70"></a><span id="l98.70">       if (checkbox.localName == &quot;checkbox&quot; &amp;&amp; checkbox.checked) {</span>
<a href="#l98.71"></a><span id="l98.71">         this._itemsFlags |= parseInt(checkbox.id);</span>
<a href="#l98.72"></a><span id="l98.72">       }</span>
<a href="#l98.73"></a><span id="l98.73">     }</span>
<a href="#l98.74"></a><span id="l98.74">   },</span>
<a href="#l98.75"></a><span id="l98.75"> </span>
<a href="#l98.76"></a><span id="l98.76">   onImportItemCommand(aEvent) {</span>
<a href="#l98.77"></a><span id="l98.77">     var items = document.getElementById(&quot;dataSources&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l99.1"></a><span id="l99.1" class="difflineminus">--- a/mail/components/preferences/applicationManager.js</span>
<a href="#l99.2"></a><span id="l99.2" class="difflineplus">+++ b/mail/components/preferences/applicationManager.js</span>
<a href="#l99.3"></a><span id="l99.3" class="difflineat">@@ -31,17 +31,17 @@ var gAppManagerDialog = {</span>
<a href="#l99.4"></a><span id="l99.4">         continue;</span>
<a href="#l99.5"></a><span id="l99.5">       }</span>
<a href="#l99.6"></a><span id="l99.6"> </span>
<a href="#l99.7"></a><span id="l99.7">       app.QueryInterface(Ci.nsIHandlerApp);</span>
<a href="#l99.8"></a><span id="l99.8"> </span>
<a href="#l99.9"></a><span id="l99.9">       // Ensure the XBL binding is created eagerly.</span>
<a href="#l99.10"></a><span id="l99.10">       // eslint-disable-next-line no-undef</span>
<a href="#l99.11"></a><span id="l99.11">       list.appendChild(MozXULElement.parseXULToFragment(&quot;&lt;richlistitem/&gt;&quot;));</span>
<a href="#l99.12"></a><span id="l99.12" class="difflineminus">-      let item = list.lastChild;</span>
<a href="#l99.13"></a><span id="l99.13" class="difflineplus">+      let item = list.lastElementChild;</span>
<a href="#l99.14"></a><span id="l99.14">       item.app = app;</span>
<a href="#l99.15"></a><span id="l99.15"> </span>
<a href="#l99.16"></a><span id="l99.16">       let image = document.createXULElement(&quot;image&quot;);</span>
<a href="#l99.17"></a><span id="l99.17">       image.setAttribute(&quot;src&quot;, gGeneralPane._getIconURLForHandlerApp(app));</span>
<a href="#l99.18"></a><span id="l99.18">       item.appendChild(image);</span>
<a href="#l99.19"></a><span id="l99.19"> </span>
<a href="#l99.20"></a><span id="l99.20">       let label = document.createXULElement(&quot;label&quot;);</span>
<a href="#l99.21"></a><span id="l99.21">       label.setAttribute(&quot;value&quot;, app.name);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l100.1"></a><span id="l100.1" class="difflineminus">--- a/mail/components/preferences/general.js</span>
<a href="#l100.2"></a><span id="l100.2" class="difflineplus">+++ b/mail/components/preferences/general.js</span>
<a href="#l100.3"></a><span id="l100.3" class="difflineat">@@ -231,17 +231,20 @@ var gGeneralPane = {</span>
<a href="#l100.4"></a><span id="l100.4">     this._rebuildFonts();</span>
<a href="#l100.5"></a><span id="l100.5"> </span>
<a href="#l100.6"></a><span id="l100.6">     var menulist = document.getElementById(&quot;defaultFont&quot;);</span>
<a href="#l100.7"></a><span id="l100.7">     if (menulist.selectedIndex == -1) {</span>
<a href="#l100.8"></a><span id="l100.8">       // Prepend menuitem with empty name and value.</span>
<a href="#l100.9"></a><span id="l100.9">       let item = document.createXULElement(&quot;menuitem&quot;);</span>
<a href="#l100.10"></a><span id="l100.10">       item.setAttribute(&quot;label&quot;, &quot;&quot;);</span>
<a href="#l100.11"></a><span id="l100.11">       item.setAttribute(&quot;value&quot;, &quot;&quot;);</span>
<a href="#l100.12"></a><span id="l100.12" class="difflineminus">-      menulist.menupopup.insertBefore(item, menulist.menupopup.firstChild);</span>
<a href="#l100.13"></a><span id="l100.13" class="difflineplus">+      menulist.menupopup.insertBefore(</span>
<a href="#l100.14"></a><span id="l100.14" class="difflineplus">+        item,</span>
<a href="#l100.15"></a><span id="l100.15" class="difflineplus">+        menulist.menupopup.firstElementChild</span>
<a href="#l100.16"></a><span id="l100.16" class="difflineplus">+      );</span>
<a href="#l100.17"></a><span id="l100.17">       menulist.selectedIndex = 0;</span>
<a href="#l100.18"></a><span id="l100.18">     }</span>
<a href="#l100.19"></a><span id="l100.19"> </span>
<a href="#l100.20"></a><span id="l100.20">     this.formatLocaleSetLabels();</span>
<a href="#l100.21"></a><span id="l100.21"> </span>
<a href="#l100.22"></a><span id="l100.22">     if (Services.prefs.getBoolPref(&quot;intl.multilingual.enabled&quot;)) {</span>
<a href="#l100.23"></a><span id="l100.23">       this.initMessengerLocale();</span>
<a href="#l100.24"></a><span id="l100.24">     }</span>
<a href="#l100.25"></a><span id="l100.25" class="difflineat">@@ -900,17 +903,19 @@ var gGeneralPane = {</span>
<a href="#l100.26"></a><span id="l100.26">       );</span>
<a href="#l100.27"></a><span id="l100.27"> </span>
<a href="#l100.28"></a><span id="l100.28">       // There is a setting that actually is in the list. Respect it.</span>
<a href="#l100.29"></a><span id="l100.29">       if (fontItem) {</span>
<a href="#l100.30"></a><span id="l100.30">         return undefined;</span>
<a href="#l100.31"></a><span id="l100.31">       }</span>
<a href="#l100.32"></a><span id="l100.32">     }</span>
<a href="#l100.33"></a><span id="l100.33"> </span>
<a href="#l100.34"></a><span id="l100.34" class="difflineminus">-    let defaultValue = element.firstChild.firstChild.getAttribute(&quot;value&quot;);</span>
<a href="#l100.35"></a><span id="l100.35" class="difflineplus">+    let defaultValue = element.firstElementChild.firstElementChild.getAttribute(</span>
<a href="#l100.36"></a><span id="l100.36" class="difflineplus">+      &quot;value&quot;</span>
<a href="#l100.37"></a><span id="l100.37" class="difflineplus">+    );</span>
<a href="#l100.38"></a><span id="l100.38">     let languagePref = Preferences.get(&quot;font.language.group&quot;);</span>
<a href="#l100.39"></a><span id="l100.39">     let defaultType = this._readDefaultFontTypeForLanguage(languagePref.value);</span>
<a href="#l100.40"></a><span id="l100.40">     let listPref = Preferences.get(</span>
<a href="#l100.41"></a><span id="l100.41">       &quot;font.name-list.&quot; + defaultType + &quot;.&quot; + languagePref.value</span>
<a href="#l100.42"></a><span id="l100.42">     );</span>
<a href="#l100.43"></a><span id="l100.43">     if (!listPref) {</span>
<a href="#l100.44"></a><span id="l100.44">       return defaultValue;</span>
<a href="#l100.45"></a><span id="l100.45">     }</span>
<a href="#l100.46"></a><span id="l100.46" class="difflineat">@@ -2061,17 +2066,17 @@ var gGeneralPane = {</span>
<a href="#l100.47"></a><span id="l100.47">       // If they picked an app, we want to add the app to the menu and select it.</span>
<a href="#l100.48"></a><span id="l100.48">       // If they canceled, we want to go back to their previous selection.</span>
<a href="#l100.49"></a><span id="l100.49">       this.rebuildActionsMenu();</span>
<a href="#l100.50"></a><span id="l100.50"> </span>
<a href="#l100.51"></a><span id="l100.51">       // If the user picked a new app from the menu, select it.</span>
<a href="#l100.52"></a><span id="l100.52">       if (handlerApp) {</span>
<a href="#l100.53"></a><span id="l100.53">         let typeItem = this._list.selectedItem;</span>
<a href="#l100.54"></a><span id="l100.54">         let actionsMenu = typeItem.querySelector(&quot;.actionsMenu&quot;);</span>
<a href="#l100.55"></a><span id="l100.55" class="difflineminus">-        let menuItems = actionsMenu.menupopup.childNodes;</span>
<a href="#l100.56"></a><span id="l100.56" class="difflineplus">+        let menuItems = actionsMenu.menupopup.children;</span>
<a href="#l100.57"></a><span id="l100.57">         for (let i = 0; i &lt; menuItems.length; i++) {</span>
<a href="#l100.58"></a><span id="l100.58">           let menuItem = menuItems[i];</span>
<a href="#l100.59"></a><span id="l100.59">           if (menuItem.handlerApp &amp;&amp; menuItem.handlerApp.equals(handlerApp)) {</span>
<a href="#l100.60"></a><span id="l100.60">             actionsMenu.selectedIndex = i;</span>
<a href="#l100.61"></a><span id="l100.61">             this.onSelectAction(menuItem);</span>
<a href="#l100.62"></a><span id="l100.62">             break;</span>
<a href="#l100.63"></a><span id="l100.63">           }</span>
<a href="#l100.64"></a><span id="l100.64">         }</span>
<a href="#l100.65"></a><span id="l100.65" class="difflineat">@@ -2329,17 +2334,17 @@ class HandlerListItem {</span>
<a href="#l100.66"></a><span id="l100.66">       } else {</span>
<a href="#l100.67"></a><span id="l100.67">         node.removeAttribute(name);</span>
<a href="#l100.68"></a><span id="l100.68">       }</span>
<a href="#l100.69"></a><span id="l100.69">     }</span>
<a href="#l100.70"></a><span id="l100.70">   }</span>
<a href="#l100.71"></a><span id="l100.71"> </span>
<a href="#l100.72"></a><span id="l100.72">   connectAndAppendToList(list) {</span>
<a href="#l100.73"></a><span id="l100.73">     list.appendChild(document.importNode(gHandlerListItemFragment, true));</span>
<a href="#l100.74"></a><span id="l100.74" class="difflineminus">-    this.node = list.lastChild;</span>
<a href="#l100.75"></a><span id="l100.75" class="difflineplus">+    this.node = list.lastElementChild;</span>
<a href="#l100.76"></a><span id="l100.76">     gNodeToObjectMap.set(this.node, this);</span>
<a href="#l100.77"></a><span id="l100.77"> </span>
<a href="#l100.78"></a><span id="l100.78">     this.node</span>
<a href="#l100.79"></a><span id="l100.79">       .querySelector(&quot;.actionsMenu&quot;)</span>
<a href="#l100.80"></a><span id="l100.80">       .addEventListener(&quot;command&quot;, event =&gt;</span>
<a href="#l100.81"></a><span id="l100.81">         gGeneralPane.onSelectAction(event.originalTarget)</span>
<a href="#l100.82"></a><span id="l100.82">       );</span>
<a href="#l100.83"></a><span id="l100.83"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l101.1"></a><span id="l101.1" class="difflineminus">--- a/mail/components/preferences/permissions.js</span>
<a href="#l101.2"></a><span id="l101.2" class="difflineplus">+++ b/mail/components/preferences/permissions.js</span>
<a href="#l101.3"></a><span id="l101.3" class="difflineat">@@ -259,17 +259,17 @@ var gPermissionManager = {</span>
<a href="#l101.4"></a><span id="l101.4">       this.uninit();</span>
<a href="#l101.5"></a><span id="l101.5">     }</span>
<a href="#l101.6"></a><span id="l101.6"> </span>
<a href="#l101.7"></a><span id="l101.7">     this._type = aParams.permissionType;</span>
<a href="#l101.8"></a><span id="l101.8">     this._manageCapability = aParams.manageCapability;</span>
<a href="#l101.9"></a><span id="l101.9"> </span>
<a href="#l101.10"></a><span id="l101.10">     var permissionsText = document.getElementById(&quot;permissionsText&quot;);</span>
<a href="#l101.11"></a><span id="l101.11">     while (permissionsText.hasChildNodes()) {</span>
<a href="#l101.12"></a><span id="l101.12" class="difflineminus">-      permissionsText.firstChild.remove();</span>
<a href="#l101.13"></a><span id="l101.13" class="difflineplus">+      permissionsText.lastChild.remove();</span>
<a href="#l101.14"></a><span id="l101.14">     }</span>
<a href="#l101.15"></a><span id="l101.15">     permissionsText.appendChild(document.createTextNode(aParams.introText));</span>
<a href="#l101.16"></a><span id="l101.16"> </span>
<a href="#l101.17"></a><span id="l101.17">     document.title = aParams.windowTitle;</span>
<a href="#l101.18"></a><span id="l101.18"> </span>
<a href="#l101.19"></a><span id="l101.19">     document.getElementById(&quot;btnBlock&quot;).hidden = !aParams.blockVisible;</span>
<a href="#l101.20"></a><span id="l101.20">     document.getElementById(&quot;btnSession&quot;).hidden = !aParams.sessionVisible;</span>
<a href="#l101.21"></a><span id="l101.21">     document.getElementById(&quot;btnAllow&quot;).hidden = !aParams.allowVisible;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l102.1"></a><span id="l102.1" class="difflineminus">--- a/mail/components/preferences/preferencesTab.js</span>
<a href="#l102.2"></a><span id="l102.2" class="difflineplus">+++ b/mail/components/preferences/preferencesTab.js</span>
<a href="#l102.3"></a><span id="l102.3" class="difflineat">@@ -71,17 +71,17 @@ var preferencesTabType = {</span>
<a href="#l102.4"></a><span id="l102.4">   openTab(aTab, aArgs) {</span>
<a href="#l102.5"></a><span id="l102.5">     if (!(&quot;contentPage&quot; in aArgs)) {</span>
<a href="#l102.6"></a><span id="l102.6">       throw new Error(&quot;contentPage must be specified&quot;);</span>
<a href="#l102.7"></a><span id="l102.7">     }</span>
<a href="#l102.8"></a><span id="l102.8"> </span>
<a href="#l102.9"></a><span id="l102.9">     // First clone the page and set up the basics.</span>
<a href="#l102.10"></a><span id="l102.10">     let clone = document</span>
<a href="#l102.11"></a><span id="l102.11">       .getElementById(&quot;preferencesTab&quot;)</span>
<a href="#l102.12"></a><span id="l102.12" class="difflineminus">-      .firstChild.cloneNode(true);</span>
<a href="#l102.13"></a><span id="l102.13" class="difflineplus">+      .firstElementChild.cloneNode(true);</span>
<a href="#l102.14"></a><span id="l102.14"> </span>
<a href="#l102.15"></a><span id="l102.15">     clone.setAttribute(&quot;id&quot;, &quot;preferencesTab&quot; + this.lastBrowserId);</span>
<a href="#l102.16"></a><span id="l102.16">     clone.setAttribute(&quot;collapsed&quot;, false);</span>
<a href="#l102.17"></a><span id="l102.17"> </span>
<a href="#l102.18"></a><span id="l102.18">     aTab.panel.setAttribute(&quot;id&quot;, &quot;preferencesTabWrapper&quot; + this.lastBrowserId);</span>
<a href="#l102.19"></a><span id="l102.19">     aTab.panel.appendChild(clone);</span>
<a href="#l102.20"></a><span id="l102.20"> </span>
<a href="#l102.21"></a><span id="l102.21">     // Start setting up the browser.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l103.1"></a><span id="l103.1" class="difflineminus">--- a/mail/components/preferences/sendoptions.js</span>
<a href="#l103.2"></a><span id="l103.2" class="difflineplus">+++ b/mail/components/preferences/sendoptions.js</span>
<a href="#l103.3"></a><span id="l103.3" class="difflineat">@@ -43,18 +43,22 @@ var gSendOptionsDialog = {</span>
<a href="#l103.4"></a><span id="l103.4">     );</span>
<a href="#l103.5"></a><span id="l103.5">   },</span>
<a href="#l103.6"></a><span id="l103.6"> </span>
<a href="#l103.7"></a><span id="l103.7">   saveDomainPref(aHTML) {</span>
<a href="#l103.8"></a><span id="l103.8">     var listbox = aHTML ? this.mHTMLListBox : this.mPlainTextListBox;</span>
<a href="#l103.9"></a><span id="l103.9">     var num_domains = 0;</span>
<a href="#l103.10"></a><span id="l103.10">     var pref_string = &quot;&quot;;</span>
<a href="#l103.11"></a><span id="l103.11"> </span>
<a href="#l103.12"></a><span id="l103.12" class="difflineminus">-    for (let item = listbox.firstChild; item != null; item = item.nextSibling) {</span>
<a href="#l103.13"></a><span id="l103.13" class="difflineminus">-      var domainid = item.firstChild.getAttribute(&quot;value&quot;);</span>
<a href="#l103.14"></a><span id="l103.14" class="difflineplus">+    for (</span>
<a href="#l103.15"></a><span id="l103.15" class="difflineplus">+      let item = listbox.firstElementChild;</span>
<a href="#l103.16"></a><span id="l103.16" class="difflineplus">+      item != null;</span>
<a href="#l103.17"></a><span id="l103.17" class="difflineplus">+      item = item.nextElementSibling</span>
<a href="#l103.18"></a><span id="l103.18" class="difflineplus">+    ) {</span>
<a href="#l103.19"></a><span id="l103.19" class="difflineplus">+      var domainid = item.firstElementChild.getAttribute(&quot;value&quot;);</span>
<a href="#l103.20"></a><span id="l103.20">       if (domainid.length &gt; 1) {</span>
<a href="#l103.21"></a><span id="l103.21">         num_domains++;</span>
<a href="#l103.22"></a><span id="l103.22"> </span>
<a href="#l103.23"></a><span id="l103.23">         // Separate &gt;1 domains by commas.</span>
<a href="#l103.24"></a><span id="l103.24">         if (num_domains &gt; 1) {</span>
<a href="#l103.25"></a><span id="l103.25">           pref_string = pref_string + &quot;,&quot; + domainid;</span>
<a href="#l103.26"></a><span id="l103.26">         } else {</span>
<a href="#l103.27"></a><span id="l103.27">           pref_string = domainid;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l104.1"></a><span id="l104.1" class="difflineminus">--- a/mail/test/mozmill/account/test-ab-whitelist.js</span>
<a href="#l104.2"></a><span id="l104.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-ab-whitelist.js</span>
<a href="#l104.3"></a><span id="l104.3" class="difflineat">@@ -77,17 +77,17 @@ function subtest_check_whitelist_init_an</span>
<a href="#l104.4"></a><span id="l104.4">     2,</span>
<a href="#l104.5"></a><span id="l104.5">     list.getRowCount(),</span>
<a href="#l104.6"></a><span id="l104.6">     &quot;There was an unexpected number of address books&quot;</span>
<a href="#l104.7"></a><span id="l104.7">   );</span>
<a href="#l104.8"></a><span id="l104.8"> </span>
<a href="#l104.9"></a><span id="l104.9">   // Now we'll check both address books</span>
<a href="#l104.10"></a><span id="l104.10">   for (let i = 0; i &lt; list.getRowCount(); i++) {</span>
<a href="#l104.11"></a><span id="l104.11">     let abNode = list.getItemAtIndex(i);</span>
<a href="#l104.12"></a><span id="l104.12" class="difflineminus">-    amc.click(new elib.Elem(abNode.firstChild));</span>
<a href="#l104.13"></a><span id="l104.13" class="difflineplus">+    amc.click(new elib.Elem(abNode.firstElementChild));</span>
<a href="#l104.14"></a><span id="l104.14">   }</span>
<a href="#l104.15"></a><span id="l104.15"> </span>
<a href="#l104.16"></a><span id="l104.16">   // And close the dialog</span>
<a href="#l104.17"></a><span id="l104.17">   amc.window.document.getElementById(&quot;accountManager&quot;).acceptDialog();</span>
<a href="#l104.18"></a><span id="l104.18"> }</span>
<a href="#l104.19"></a><span id="l104.19"> </span>
<a href="#l104.20"></a><span id="l104.20"> /* Next, we'll make sure that the address books we checked in</span>
<a href="#l104.21"></a><span id="l104.21">  * subtest_check_whitelist_init_and_save were properly saved.</span>
<a href="#l104.22"></a><span id="l104.22" class="difflineat">@@ -100,24 +100,24 @@ function subtest_check_whitelist_load_an</span>
<a href="#l104.23"></a><span id="l104.23">   let doc = amc.window.document.getElementById(&quot;contentFrame&quot;).contentDocument;</span>
<a href="#l104.24"></a><span id="l104.24">   let list = doc.getElementById(&quot;whiteListAbURI&quot;);</span>
<a href="#l104.25"></a><span id="l104.25">   let whiteListURIs = Services.prefs.getCharPref(gKeyString).split(&quot; &quot;);</span>
<a href="#l104.26"></a><span id="l104.26"> </span>
<a href="#l104.27"></a><span id="l104.27">   for (let i = 0; i &lt; list.getRowCount(); i++) {</span>
<a href="#l104.28"></a><span id="l104.28">     let abNode = list.getItemAtIndex(i);</span>
<a href="#l104.29"></a><span id="l104.29">     assert_equals(</span>
<a href="#l104.30"></a><span id="l104.30">       &quot;true&quot;,</span>
<a href="#l104.31"></a><span id="l104.31" class="difflineminus">-      abNode.firstChild.getAttribute(&quot;checked&quot;),</span>
<a href="#l104.32"></a><span id="l104.32" class="difflineplus">+      abNode.firstElementChild.getAttribute(&quot;checked&quot;),</span>
<a href="#l104.33"></a><span id="l104.33">       &quot;Should have been checked&quot;</span>
<a href="#l104.34"></a><span id="l104.34">     );</span>
<a href="#l104.35"></a><span id="l104.35">     // Also ensure that the address book URI was properly saved in the</span>
<a href="#l104.36"></a><span id="l104.36">     // prefs</span>
<a href="#l104.37"></a><span id="l104.37">     assert_true(whiteListURIs.includes(abNode.getAttribute(&quot;value&quot;)));</span>
<a href="#l104.38"></a><span id="l104.38">     // Now un-check that address book</span>
<a href="#l104.39"></a><span id="l104.39" class="difflineminus">-    amc.click(new elib.Elem(abNode.firstChild));</span>
<a href="#l104.40"></a><span id="l104.40" class="difflineplus">+    amc.click(new elib.Elem(abNode.firstElementChild));</span>
<a href="#l104.41"></a><span id="l104.41">   }</span>
<a href="#l104.42"></a><span id="l104.42"> </span>
<a href="#l104.43"></a><span id="l104.43">   // And close the dialog</span>
<a href="#l104.44"></a><span id="l104.44">   amc.window.document.getElementById(&quot;accountManager&quot;).acceptDialog();</span>
<a href="#l104.45"></a><span id="l104.45"> }</span>
<a href="#l104.46"></a><span id="l104.46"> </span>
<a href="#l104.47"></a><span id="l104.47"> /* Finally, we'll make sure that the address books we cleared</span>
<a href="#l104.48"></a><span id="l104.48">  * were actually cleared.</span>
<a href="#l104.49"></a><span id="l104.49" class="difflineat">@@ -138,17 +138,17 @@ function subtest_check_whitelist_load_cl</span>
<a href="#l104.50"></a><span id="l104.50">       &quot;The whitelist preference for this server wasn't properly cleared.&quot;</span>
<a href="#l104.51"></a><span id="l104.51">     );</span>
<a href="#l104.52"></a><span id="l104.52">   } catch (e) {}</span>
<a href="#l104.53"></a><span id="l104.53"> </span>
<a href="#l104.54"></a><span id="l104.54">   for (let i = 0; i &lt; list.getRowCount(); i++) {</span>
<a href="#l104.55"></a><span id="l104.55">     let abNode = list.getItemAtIndex(i);</span>
<a href="#l104.56"></a><span id="l104.56">     assert_equals(</span>
<a href="#l104.57"></a><span id="l104.57">       &quot;false&quot;,</span>
<a href="#l104.58"></a><span id="l104.58" class="difflineminus">-      abNode.firstChild.getAttribute(&quot;checked&quot;),</span>
<a href="#l104.59"></a><span id="l104.59" class="difflineplus">+      abNode.firstElementChild.getAttribute(&quot;checked&quot;),</span>
<a href="#l104.60"></a><span id="l104.60">       &quot;Should not have been checked&quot;</span>
<a href="#l104.61"></a><span id="l104.61">     );</span>
<a href="#l104.62"></a><span id="l104.62">     // Also ensure that the address book URI was properly cleared in the</span>
<a href="#l104.63"></a><span id="l104.63">     // prefs</span>
<a href="#l104.64"></a><span id="l104.64">     assert_false(whiteListURIs.includes(abNode.getAttribute(&quot;value&quot;)));</span>
<a href="#l104.65"></a><span id="l104.65">   }</span>
<a href="#l104.66"></a><span id="l104.66"> </span>
<a href="#l104.67"></a><span id="l104.67">   // And close the dialog</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l105.1"></a><span id="l105.1" class="difflineminus">--- a/mail/test/mozmill/account/test-account-tree.js</span>
<a href="#l105.2"></a><span id="l105.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-account-tree.js</span>
<a href="#l105.3"></a><span id="l105.3" class="difflineat">@@ -125,17 +125,18 @@ function subtest_check_default_account_h</span>
<a href="#l105.4"></a><span id="l105.4">     MailServices.accounts.defaultAccount.key,</span>
<a href="#l105.5"></a><span id="l105.5">     null,</span>
<a href="#l105.6"></a><span id="l105.6">     amc</span>
<a href="#l105.7"></a><span id="l105.7">   );</span>
<a href="#l105.8"></a><span id="l105.8">   click_account_tree_row(amc, accountRow);</span>
<a href="#l105.9"></a><span id="l105.9"> </span>
<a href="#l105.10"></a><span id="l105.10">   let accountTree = amc.e(&quot;accounttree&quot;);</span>
<a href="#l105.11"></a><span id="l105.11">   assert_equals(accountRow, accountTree.view.selection.currentIndex);</span>
<a href="#l105.12"></a><span id="l105.12" class="difflineminus">-  let cell = accountTree.view.getItemAtIndex(accountRow).firstChild.firstChild;</span>
<a href="#l105.13"></a><span id="l105.13" class="difflineplus">+  let cell = accountTree.view.getItemAtIndex(accountRow).firstElementChild</span>
<a href="#l105.14"></a><span id="l105.14" class="difflineplus">+    .firstElementChild;</span>
<a href="#l105.15"></a><span id="l105.15">   assert_equals(cell.tagName, &quot;treecell&quot;);</span>
<a href="#l105.16"></a><span id="l105.16"> </span>
<a href="#l105.17"></a><span id="l105.17">   // We can't read the computed style of the tree cell directly, so at least see</span>
<a href="#l105.18"></a><span id="l105.18">   // if the isDefaultServer-true property is set on it. Hopefully the proper style</span>
<a href="#l105.19"></a><span id="l105.19">   // is attached to this property.</span>
<a href="#l105.20"></a><span id="l105.20">   let propArray = accountTree.view</span>
<a href="#l105.21"></a><span id="l105.21">     .getCellProperties(accountRow, accountTree.columns.getColumnAt(0))</span>
<a href="#l105.22"></a><span id="l105.22">     .split(&quot; &quot;);</span>
<a href="#l105.23"></a><span id="l105.23" class="difflineat">@@ -168,19 +169,19 @@ function test_selection_after_account_de</span>
<a href="#l105.24"></a><span id="l105.24">  * Check if after deleting an account the next one is selected.</span>
<a href="#l105.25"></a><span id="l105.25">  *</span>
<a href="#l105.26"></a><span id="l105.26">  * @param amc           The account options controller.</span>
<a href="#l105.27"></a><span id="l105.27">  */</span>
<a href="#l105.28"></a><span id="l105.28"> function subtest_check_selection_after_account_deletion(amc) {</span>
<a href="#l105.29"></a><span id="l105.29">   let accountList = [];</span>
<a href="#l105.30"></a><span id="l105.30">   let accountTreeNode = amc.e(&quot;account-tree-children&quot;);</span>
<a href="#l105.31"></a><span id="l105.31">   // Build the list of accounts in the account tree (order is important).</span>
<a href="#l105.32"></a><span id="l105.32" class="difflineminus">-  for (let i = 0; i &lt; accountTreeNode.childNodes.length; i++) {</span>
<a href="#l105.33"></a><span id="l105.33" class="difflineminus">-    if (&quot;_account&quot; in accountTreeNode.childNodes[i]) {</span>
<a href="#l105.34"></a><span id="l105.34" class="difflineminus">-      let curAccount = accountTreeNode.childNodes[i]._account;</span>
<a href="#l105.35"></a><span id="l105.35" class="difflineplus">+  for (let i = 0; i &lt; accountTreeNode.children.length; i++) {</span>
<a href="#l105.36"></a><span id="l105.36" class="difflineplus">+    if (&quot;_account&quot; in accountTreeNode.children[i]) {</span>
<a href="#l105.37"></a><span id="l105.37" class="difflineplus">+      let curAccount = accountTreeNode.children[i]._account;</span>
<a href="#l105.38"></a><span id="l105.38">       if (!accountList.includes(curAccount)) {</span>
<a href="#l105.39"></a><span id="l105.39">         accountList.push(curAccount);</span>
<a href="#l105.40"></a><span id="l105.40">       }</span>
<a href="#l105.41"></a><span id="l105.41">     }</span>
<a href="#l105.42"></a><span id="l105.42">   }</span>
<a href="#l105.43"></a><span id="l105.43"> </span>
<a href="#l105.44"></a><span id="l105.44">   // Get position of the current account in the account list.</span>
<a href="#l105.45"></a><span id="l105.45">   let accountIndex = accountList.indexOf(gPopAccount);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l106.1"></a><span id="l106.1" class="difflineminus">--- a/mail/test/mozmill/attachment/test-attachment.js</span>
<a href="#l106.2"></a><span id="l106.2" class="difflineplus">+++ b/mail/test/mozmill/attachment/test-attachment.js</span>
<a href="#l106.3"></a><span id="l106.3" class="difflineat">@@ -530,17 +530,17 @@ function test_delete_attachment_key() {</span>
<a href="#l106.4"></a><span id="l106.4"> </span>
<a href="#l106.5"></a><span id="l106.5">   // First, select the message with two attachments.</span>
<a href="#l106.6"></a><span id="l106.6">   select_none();</span>
<a href="#l106.7"></a><span id="l106.7">   select_click_row(3);</span>
<a href="#l106.8"></a><span id="l106.8"> </span>
<a href="#l106.9"></a><span id="l106.9">   // Expand the attachment list.</span>
<a href="#l106.10"></a><span id="l106.10">   mc.click(mc.eid(&quot;attachmentToggle&quot;));</span>
<a href="#l106.11"></a><span id="l106.11"> </span>
<a href="#l106.12"></a><span id="l106.12" class="difflineminus">-  let firstAttachment = new elib.Elem(mc.e(&quot;attachmentList&quot;).firstChild);</span>
<a href="#l106.13"></a><span id="l106.13" class="difflineplus">+  let firstAttachment = new elib.Elem(mc.e(&quot;attachmentList&quot;).firstElementChild);</span>
<a href="#l106.14"></a><span id="l106.14">   mc.click(firstAttachment, 5, 5);</span>
<a href="#l106.15"></a><span id="l106.15"> </span>
<a href="#l106.16"></a><span id="l106.16">   // Try deleting with the delete key</span>
<a href="#l106.17"></a><span id="l106.17">   plan_for_modal_dialog(&quot;commonDialog&quot;, function(cdc) {</span>
<a href="#l106.18"></a><span id="l106.18">     cdc.window.document.documentElement.cancelDialog();</span>
<a href="#l106.19"></a><span id="l106.19">   });</span>
<a href="#l106.20"></a><span id="l106.20">   mc.keypress(firstAttachment, &quot;VK_DELETE&quot;, {});</span>
<a href="#l106.21"></a><span id="l106.21">   wait_for_modal_dialog(&quot;commonDialog&quot;);</span>
<a href="#l106.22"></a><span id="l106.22" class="difflineat">@@ -642,17 +642,17 @@ function test_delete_from_toolbar() {</span>
<a href="#l106.23"></a><span id="l106.23"> </span>
<a href="#l106.24"></a><span id="l106.24">   // First, select the message with two attachments.</span>
<a href="#l106.25"></a><span id="l106.25">   select_none();</span>
<a href="#l106.26"></a><span id="l106.26">   select_click_row(3);</span>
<a href="#l106.27"></a><span id="l106.27"> </span>
<a href="#l106.28"></a><span id="l106.28">   // Expand the attachment list.</span>
<a href="#l106.29"></a><span id="l106.29">   mc.click(mc.eid(&quot;attachmentToggle&quot;));</span>
<a href="#l106.30"></a><span id="l106.30"> </span>
<a href="#l106.31"></a><span id="l106.31" class="difflineminus">-  let firstAttachment = new elib.Elem(mc.e(&quot;attachmentList&quot;).firstChild);</span>
<a href="#l106.32"></a><span id="l106.32" class="difflineplus">+  let firstAttachment = new elib.Elem(mc.e(&quot;attachmentList&quot;).firstElementChild);</span>
<a href="#l106.33"></a><span id="l106.33">   mc.click(firstAttachment, 5, 5);</span>
<a href="#l106.34"></a><span id="l106.34"> </span>
<a href="#l106.35"></a><span id="l106.35">   // Make sure clicking the &quot;Delete&quot; toolbar button with an attachment focused</span>
<a href="#l106.36"></a><span id="l106.36">   // deletes the *message*.</span>
<a href="#l106.37"></a><span id="l106.37">   plan_to_wait_for_folder_events(&quot;DeleteOrMoveMsgCompleted&quot;);</span>
<a href="#l106.38"></a><span id="l106.38">   mc.click(mc.eid(&quot;hdrTrashButton&quot;));</span>
<a href="#l106.39"></a><span id="l106.39">   wait_for_folder_events();</span>
<a href="#l106.40"></a><span id="l106.40"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l107.1"></a><span id="l107.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-image-display.js</span>
<a href="#l107.2"></a><span id="l107.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-image-display.js</span>
<a href="#l107.3"></a><span id="l107.3" class="difflineat">@@ -103,17 +103,17 @@ function test_cid_image_load() {</span>
<a href="#l107.4"></a><span id="l107.4">   let msgc = open_message_from_file(file);</span>
<a href="#l107.5"></a><span id="l107.5">   let messageDoc = msgc.e(&quot;messagepane&quot;).contentDocument;</span>
<a href="#l107.6"></a><span id="l107.6">   let image = messageDoc.getElementById(&quot;cidImage&quot;);</span>
<a href="#l107.7"></a><span id="l107.7">   check_image_size(msgc, image, &quot;mailbox://&quot;);</span>
<a href="#l107.8"></a><span id="l107.8">   image = messageDoc.getElementById(&quot;cidImageOrigin&quot;);</span>
<a href="#l107.9"></a><span id="l107.9">   check_image_size(msgc, image, &quot;mailbox://&quot;);</span>
<a href="#l107.10"></a><span id="l107.10"> </span>
<a href="#l107.11"></a><span id="l107.11">   // Copy the message to a folder.</span>
<a href="#l107.12"></a><span id="l107.12" class="difflineminus">-  let documentChild = messageDoc.firstChild;</span>
<a href="#l107.13"></a><span id="l107.13" class="difflineplus">+  let documentChild = messageDoc.firstElementChild;</span>
<a href="#l107.14"></a><span id="l107.14">   msgc.rightClick(new elib.Elem(documentChild));</span>
<a href="#l107.15"></a><span id="l107.15">   msgc.click_menus_in_sequence(msgc.e(&quot;mailContext&quot;), [</span>
<a href="#l107.16"></a><span id="l107.16">     { id: &quot;mailContext-copyMenu&quot; },</span>
<a href="#l107.17"></a><span id="l107.17">     { label: &quot;Local Folders&quot; },</span>
<a href="#l107.18"></a><span id="l107.18">     { label: gImageFolder.prettyName },</span>
<a href="#l107.19"></a><span id="l107.19">   ]);</span>
<a href="#l107.20"></a><span id="l107.20">   close_window(msgc);</span>
<a href="#l107.21"></a><span id="l107.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l108.1"></a><span id="l108.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-reply-addresses.js</span>
<a href="#l108.2"></a><span id="l108.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-reply-addresses.js</span>
<a href="#l108.3"></a><span id="l108.3" class="difflineat">@@ -90,17 +90,17 @@ function checkToAddresses(replyWinContro</span>
<a href="#l108.4"></a><span id="l108.4">   let obtainedFields = [];</span>
<a href="#l108.5"></a><span id="l108.5">   for (let i = 0; i &lt; addressingWidgetItems.length; i++) {</span>
<a href="#l108.6"></a><span id="l108.6">     let addrTypePopup = addressingWidgetItems[i].querySelector(&quot;menupopup&quot;);</span>
<a href="#l108.7"></a><span id="l108.7">     let addrTextbox = addressingWidgetItems[i].querySelector(</span>
<a href="#l108.8"></a><span id="l108.8">       `input[is=&quot;autocomplete-input&quot;]`</span>
<a href="#l108.9"></a><span id="l108.9">     );</span>
<a href="#l108.10"></a><span id="l108.10"> </span>
<a href="#l108.11"></a><span id="l108.11">     let selectedIndex = addrTypePopup.parentNode.selectedIndex;</span>
<a href="#l108.12"></a><span id="l108.12" class="difflineminus">-    let typeMenuitems = addrTypePopup.childNodes;</span>
<a href="#l108.13"></a><span id="l108.13" class="difflineplus">+    let typeMenuitems = addrTypePopup.children;</span>
<a href="#l108.14"></a><span id="l108.14">     let addrType =</span>
<a href="#l108.15"></a><span id="l108.15">       selectedIndex != -1</span>
<a href="#l108.16"></a><span id="l108.16">         ? typeMenuitems[selectedIndex].value</span>
<a href="#l108.17"></a><span id="l108.17">         : typeMenuitems[0].value;</span>
<a href="#l108.18"></a><span id="l108.18"> </span>
<a href="#l108.19"></a><span id="l108.19">     if (!addrTextbox.value) {</span>
<a href="#l108.20"></a><span id="l108.20">       continue;</span>
<a href="#l108.21"></a><span id="l108.21">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l109.1"></a><span id="l109.1" class="difflineminus">--- a/mail/test/mozmill/content-tabs/test-content-tab.js</span>
<a href="#l109.2"></a><span id="l109.2" class="difflineplus">+++ b/mail/test/mozmill/content-tabs/test-content-tab.js</span>
<a href="#l109.3"></a><span id="l109.3" class="difflineat">@@ -142,30 +142,30 @@ function test_content_tab_context_menu()</span>
<a href="#l109.4"></a><span id="l109.4">   EventUtils.synthesizeMouse(</span>
<a href="#l109.5"></a><span id="l109.5">     heading,</span>
<a href="#l109.6"></a><span id="l109.6">     5,</span>
<a href="#l109.7"></a><span id="l109.7">     5,</span>
<a href="#l109.8"></a><span id="l109.8">     { type: &quot;contextmenu&quot;, button: 2 },</span>
<a href="#l109.9"></a><span id="l109.9">     w</span>
<a href="#l109.10"></a><span id="l109.10">   );</span>
<a href="#l109.11"></a><span id="l109.11">   wait_for_popup_to_open(mailContext);</span>
<a href="#l109.12"></a><span id="l109.12" class="difflineminus">-  assert_equals(mailContext.firstChild.label, &quot;Click me!&quot;);</span>
<a href="#l109.13"></a><span id="l109.13" class="difflineplus">+  assert_equals(mailContext.firstElementChild.label, &quot;Click me!&quot;);</span>
<a href="#l109.14"></a><span id="l109.14">   assert_element_visible(&quot;page-menu-separator&quot;);</span>
<a href="#l109.15"></a><span id="l109.15">   close_popup(mc, new elementslib.Elem(mailContext));</span>
<a href="#l109.16"></a><span id="l109.16"> </span>
<a href="#l109.17"></a><span id="l109.17">   // Make sure the page's menu items are *not* added on shift-right-click.</span>
<a href="#l109.18"></a><span id="l109.18">   EventUtils.synthesizeMouse(</span>
<a href="#l109.19"></a><span id="l109.19">     heading,</span>
<a href="#l109.20"></a><span id="l109.20">     5,</span>
<a href="#l109.21"></a><span id="l109.21">     5,</span>
<a href="#l109.22"></a><span id="l109.22">     { type: &quot;contextmenu&quot;, button: 2, shiftKey: true },</span>
<a href="#l109.23"></a><span id="l109.23">     w</span>
<a href="#l109.24"></a><span id="l109.24">   );</span>
<a href="#l109.25"></a><span id="l109.25">   wait_for_popup_to_open(mailContext);</span>
<a href="#l109.26"></a><span id="l109.26" class="difflineminus">-  assert_not_equals(mailContext.firstChild.label, &quot;Click me!&quot;);</span>
<a href="#l109.27"></a><span id="l109.27" class="difflineplus">+  assert_not_equals(mailContext.firstElementChild.label, &quot;Click me!&quot;);</span>
<a href="#l109.28"></a><span id="l109.28">   assert_element_not_visible(&quot;page-menu-separator&quot;);</span>
<a href="#l109.29"></a><span id="l109.29">   close_popup(mc, new elementslib.Elem(mailContext));</span>
<a href="#l109.30"></a><span id="l109.30"> }</span>
<a href="#l109.31"></a><span id="l109.31"> </span>
<a href="#l109.32"></a><span id="l109.32"> /*</span>
<a href="#l109.33"></a><span id="l109.33">  // We don't have an UI to test openin content tabs twice anymore.</span>
<a href="#l109.34"></a><span id="l109.34"> function test_content_tab_open_same() {</span>
<a href="#l109.35"></a><span id="l109.35">   let preCount = mc.tabmail.tabContainer.allTabs.length;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l110.1"></a><span id="l110.1" class="difflineminus">--- a/mail/test/mozmill/downloads/test-about-downloads.js</span>
<a href="#l110.2"></a><span id="l110.2" class="difflineplus">+++ b/mail/test/mozmill/downloads/test-about-downloads.js</span>
<a href="#l110.3"></a><span id="l110.3" class="difflineat">@@ -198,42 +198,42 @@ function test_save_attachment_files_in_l</span>
<a href="#l110.4"></a><span id="l110.4">   mc.waitFor(</span>
<a href="#l110.5"></a><span id="l110.5">     () =&gt; downloadsView.count == length,</span>
<a href="#l110.6"></a><span id="l110.6">     () =&gt;</span>
<a href="#l110.7"></a><span id="l110.7">       &quot;Timeout waiting for saving three attachment files; &quot; +</span>
<a href="#l110.8"></a><span id="l110.8">       &quot;downloadsView.count=&quot; +</span>
<a href="#l110.9"></a><span id="l110.9">       downloadsView.count</span>
<a href="#l110.10"></a><span id="l110.10">   );</span>
<a href="#l110.11"></a><span id="l110.11"> </span>
<a href="#l110.12"></a><span id="l110.12" class="difflineminus">-  assert_equals(length, list.childNodes.length);</span>
<a href="#l110.13"></a><span id="l110.13" class="difflineminus">-  assert_equals(downloadsView.count, list.childNodes.length);</span>
<a href="#l110.14"></a><span id="l110.14" class="difflineplus">+  assert_equals(length, list.children.length);</span>
<a href="#l110.15"></a><span id="l110.15" class="difflineplus">+  assert_equals(downloadsView.count, list.children.length);</span>
<a href="#l110.16"></a><span id="l110.16"> </span>
<a href="#l110.17"></a><span id="l110.17">   let actualNames = [];</span>
<a href="#l110.18"></a><span id="l110.18" class="difflineminus">-  let child = list.firstChild;</span>
<a href="#l110.19"></a><span id="l110.19" class="difflineplus">+  let child = list.firstElementChild;</span>
<a href="#l110.20"></a><span id="l110.20">   dump(child.querySelector(&quot;.fileName&quot;).getAttribute(&quot;value&quot;));</span>
<a href="#l110.21"></a><span id="l110.21">   while (child) {</span>
<a href="#l110.22"></a><span id="l110.22">     actualNames.push(child.querySelector(&quot;.fileName&quot;).getAttribute(&quot;value&quot;));</span>
<a href="#l110.23"></a><span id="l110.23" class="difflineminus">-    child = child.nextSibling;</span>
<a href="#l110.24"></a><span id="l110.24" class="difflineplus">+    child = child.nextElementSibling;</span>
<a href="#l110.25"></a><span id="l110.25">   }</span>
<a href="#l110.26"></a><span id="l110.26">   actualNames.sort();</span>
<a href="#l110.27"></a><span id="l110.27"> </span>
<a href="#l110.28"></a><span id="l110.28">   for (let i = 0; i &lt; length; i++) {</span>
<a href="#l110.29"></a><span id="l110.29">     assert_equals(attachmentFileNames[i], actualNames[i]);</span>
<a href="#l110.30"></a><span id="l110.30">   }</span>
<a href="#l110.31"></a><span id="l110.31"> }</span>
<a href="#l110.32"></a><span id="l110.32"> </span>
<a href="#l110.33"></a><span id="l110.33"> /**</span>
<a href="#l110.34"></a><span id="l110.34">  * Test that 'remove' in context menu removes surely the target file from</span>
<a href="#l110.35"></a><span id="l110.35">  * the list.</span>
<a href="#l110.36"></a><span id="l110.36">  */</span>
<a href="#l110.37"></a><span id="l110.37"> function test_remove_file() {</span>
<a href="#l110.38"></a><span id="l110.38">   test_save_attachment_files_in_list();</span>
<a href="#l110.39"></a><span id="l110.39"> </span>
<a href="#l110.40"></a><span id="l110.40">   let list = content_tab_e(downloadsTab, &quot;msgDownloadsRichListBox&quot;);</span>
<a href="#l110.41"></a><span id="l110.41" class="difflineminus">-  let firstElement = list.firstChild;</span>
<a href="#l110.42"></a><span id="l110.42" class="difflineplus">+  let firstElement = list.firstElementChild;</span>
<a href="#l110.43"></a><span id="l110.43">   let removingFileName = firstElement</span>
<a href="#l110.44"></a><span id="l110.44">     .querySelector(&quot;.fileName&quot;)</span>
<a href="#l110.45"></a><span id="l110.45">     .getAttribute(&quot;value&quot;);</span>
<a href="#l110.46"></a><span id="l110.46"> </span>
<a href="#l110.47"></a><span id="l110.47">   // select first element</span>
<a href="#l110.48"></a><span id="l110.48">   mc.click(new elementslib.Elem(firstElement));</span>
<a href="#l110.49"></a><span id="l110.49">   mc.rightClick(new elementslib.Elem(firstElement));</span>
<a href="#l110.50"></a><span id="l110.50"> </span>
<a href="#l110.51"></a><span id="l110.51" class="difflineat">@@ -242,35 +242,35 @@ function test_remove_file() {</span>
<a href="#l110.52"></a><span id="l110.52">   mc.click_menus_in_sequence(contextMenu, [</span>
<a href="#l110.53"></a><span id="l110.53">     { command: &quot;msgDownloadsCmd_remove&quot; },</span>
<a href="#l110.54"></a><span id="l110.54">   ]);</span>
<a href="#l110.55"></a><span id="l110.55">   mc.waitFor(</span>
<a href="#l110.56"></a><span id="l110.56">     () =&gt; downloadsView.count == 2,</span>
<a href="#l110.57"></a><span id="l110.57">     &quot;Timeout waiting for removing a saved attachment file.&quot;</span>
<a href="#l110.58"></a><span id="l110.58">   );</span>
<a href="#l110.59"></a><span id="l110.59"> </span>
<a href="#l110.60"></a><span id="l110.60" class="difflineminus">-  let child = list.firstChild;</span>
<a href="#l110.61"></a><span id="l110.61" class="difflineplus">+  let child = list.firstElementChild;</span>
<a href="#l110.62"></a><span id="l110.62">   while (child) {</span>
<a href="#l110.63"></a><span id="l110.63">     assert_not_equals(</span>
<a href="#l110.64"></a><span id="l110.64">       removingFileName,</span>
<a href="#l110.65"></a><span id="l110.65">       child.querySelector(&quot;.fileName&quot;).getAttribute(&quot;value&quot;)</span>
<a href="#l110.66"></a><span id="l110.66">     );</span>
<a href="#l110.67"></a><span id="l110.67" class="difflineminus">-    child = child.nextSibling;</span>
<a href="#l110.68"></a><span id="l110.68" class="difflineplus">+    child = child.nextElementSibling;</span>
<a href="#l110.69"></a><span id="l110.69">   }</span>
<a href="#l110.70"></a><span id="l110.70"> }</span>
<a href="#l110.71"></a><span id="l110.71"> </span>
<a href="#l110.72"></a><span id="l110.72"> /**</span>
<a href="#l110.73"></a><span id="l110.73">  * Test that removing multiple files surely removes the files.</span>
<a href="#l110.74"></a><span id="l110.74">  */</span>
<a href="#l110.75"></a><span id="l110.75"> function test_remove_multiple_files() {</span>
<a href="#l110.76"></a><span id="l110.76">   test_save_attachment_files_in_list();</span>
<a href="#l110.77"></a><span id="l110.77"> </span>
<a href="#l110.78"></a><span id="l110.78">   let list = content_tab_e(downloadsTab, &quot;msgDownloadsRichListBox&quot;);</span>
<a href="#l110.79"></a><span id="l110.79" class="difflineminus">-  let firstElement = list.firstChild.nextSibling;</span>
<a href="#l110.80"></a><span id="l110.80" class="difflineminus">-  let secondElement = firstElement.nextSibling;</span>
<a href="#l110.81"></a><span id="l110.81" class="difflineplus">+  let firstElement = list.firstElementChild.nextElementSibling;</span>
<a href="#l110.82"></a><span id="l110.82" class="difflineplus">+  let secondElement = firstElement.nextElementSibling;</span>
<a href="#l110.83"></a><span id="l110.83">   let removingFileNames = [];</span>
<a href="#l110.84"></a><span id="l110.84"> </span>
<a href="#l110.85"></a><span id="l110.85">   removingFileNames.push(</span>
<a href="#l110.86"></a><span id="l110.86">     firstElement.querySelector(&quot;.fileName&quot;).getAttribute(&quot;value&quot;)</span>
<a href="#l110.87"></a><span id="l110.87">   );</span>
<a href="#l110.88"></a><span id="l110.88">   removingFileNames.push(</span>
<a href="#l110.89"></a><span id="l110.89">     secondElement.querySelector(&quot;.fileName&quot;).getAttribute(&quot;value&quot;)</span>
<a href="#l110.90"></a><span id="l110.90">   );</span>
<a href="#l110.91"></a><span id="l110.91" class="difflineat">@@ -285,25 +285,25 @@ function test_remove_multiple_files() {</span>
<a href="#l110.92"></a><span id="l110.92">   mc.click_menus_in_sequence(contextMenu, [</span>
<a href="#l110.93"></a><span id="l110.93">     { command: &quot;msgDownloadsCmd_remove&quot; },</span>
<a href="#l110.94"></a><span id="l110.94">   ]);</span>
<a href="#l110.95"></a><span id="l110.95">   mc.waitFor(</span>
<a href="#l110.96"></a><span id="l110.96">     () =&gt; downloadsView.count == 1,</span>
<a href="#l110.97"></a><span id="l110.97">     &quot;Timeout waiting for removing two saved attachment files.&quot;</span>
<a href="#l110.98"></a><span id="l110.98">   );</span>
<a href="#l110.99"></a><span id="l110.99"> </span>
<a href="#l110.100"></a><span id="l110.100" class="difflineminus">-  let child = list.firstChild;</span>
<a href="#l110.101"></a><span id="l110.101" class="difflineplus">+  let child = list.firstElementChild;</span>
<a href="#l110.102"></a><span id="l110.102">   while (child) {</span>
<a href="#l110.103"></a><span id="l110.103">     for (let name of removingFileNames) {</span>
<a href="#l110.104"></a><span id="l110.104">       assert_not_equals(</span>
<a href="#l110.105"></a><span id="l110.105">         name,</span>
<a href="#l110.106"></a><span id="l110.106">         child.querySelector(&quot;.fileName&quot;).getAttribute(&quot;value&quot;)</span>
<a href="#l110.107"></a><span id="l110.107">       );</span>
<a href="#l110.108"></a><span id="l110.108">     }</span>
<a href="#l110.109"></a><span id="l110.109" class="difflineminus">-    child = child.nextSibling;</span>
<a href="#l110.110"></a><span id="l110.110" class="difflineplus">+    child = child.nextElementSibling;</span>
<a href="#l110.111"></a><span id="l110.111">   }</span>
<a href="#l110.112"></a><span id="l110.112"> }</span>
<a href="#l110.113"></a><span id="l110.113"> </span>
<a href="#l110.114"></a><span id="l110.114"> /**</span>
<a href="#l110.115"></a><span id="l110.115">  * Test that 'clearDownloads&quot; in context menu purges all files in the list.</span>
<a href="#l110.116"></a><span id="l110.116">  */</span>
<a href="#l110.117"></a><span id="l110.117"> function test_clear_all_files() {</span>
<a href="#l110.118"></a><span id="l110.118">   test_save_attachment_files_in_list();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l111.1"></a><span id="l111.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-mail-views.js</span>
<a href="#l111.2"></a><span id="l111.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-mail-views.js</span>
<a href="#l111.3"></a><span id="l111.3" class="difflineat">@@ -75,17 +75,17 @@ function subtest_save_mail_view(savc) {</span>
<a href="#l111.4"></a><span id="l111.4"> </span>
<a href="#l111.5"></a><span id="l111.5">   let elem = savc.window.document.getElementById(&quot;searchVal0&quot;);</span>
<a href="#l111.6"></a><span id="l111.6">   let index = 0;</span>
<a href="#l111.7"></a><span id="l111.7"> </span>
<a href="#l111.8"></a><span id="l111.8">   if (elem.hasAttribute(&quot;selectedIndex&quot;)) {</span>
<a href="#l111.9"></a><span id="l111.9">     index = parseInt(elem.getAttribute(&quot;selectedIndex&quot;));</span>
<a href="#l111.10"></a><span id="l111.10">   }</span>
<a href="#l111.11"></a><span id="l111.11"> </span>
<a href="#l111.12"></a><span id="l111.12" class="difflineminus">-  elem = elem.childNodes[index];</span>
<a href="#l111.13"></a><span id="l111.13" class="difflineplus">+  elem = elem.children[index];</span>
<a href="#l111.14"></a><span id="l111.14"> </span>
<a href="#l111.15"></a><span id="l111.15">   // - make sure the constraint is right</span>
<a href="#l111.16"></a><span id="l111.16">   savc.assertValue(new elib.Elem(elem), &quot;$label1&quot;);</span>
<a href="#l111.17"></a><span id="l111.17"> </span>
<a href="#l111.18"></a><span id="l111.18">   // - save it</span>
<a href="#l111.19"></a><span id="l111.19">   savc.window.onOK();</span>
<a href="#l111.20"></a><span id="l111.20"> }</span>
<a href="#l111.21"></a><span id="l111.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l112.1"></a><span id="l112.1" class="difflineminus">--- a/mail/test/mozmill/folder-widget/test-message-filters.js</span>
<a href="#l112.2"></a><span id="l112.2" class="difflineplus">+++ b/mail/test/mozmill/folder-widget/test-message-filters.js</span>
<a href="#l112.3"></a><span id="l112.3" class="difflineat">@@ -163,23 +163,23 @@ function create_simple_filter() {</span>
<a href="#l112.4"></a><span id="l112.4">   // We'll assume that the filters dialog is already open from</span>
<a href="#l112.5"></a><span id="l112.5">   // the previous tests.</span>
<a href="#l112.6"></a><span id="l112.6">   let filterc = wait_for_existing_window(&quot;mailnews:filterlist&quot;);</span>
<a href="#l112.7"></a><span id="l112.7"> </span>
<a href="#l112.8"></a><span id="l112.8">   function fill_in_filter_fields(fec) {</span>
<a href="#l112.9"></a><span id="l112.9">     let filterName = fec.e(&quot;filterName&quot;);</span>
<a href="#l112.10"></a><span id="l112.10">     filterName.value = &quot;A Simple Filter&quot;;</span>
<a href="#l112.11"></a><span id="l112.11">     let searchAttr = fec.e(&quot;searchAttr0&quot;);</span>
<a href="#l112.12"></a><span id="l112.12" class="difflineminus">-    let attrList = searchAttr.childNodes[0];</span>
<a href="#l112.13"></a><span id="l112.13" class="difflineplus">+    let attrList = searchAttr.children[0];</span>
<a href="#l112.14"></a><span id="l112.14">     attrList.value = Ci.nsMsgSearchAttrib.To;</span>
<a href="#l112.15"></a><span id="l112.15">     let searchOp = fec.e(&quot;searchOp0&quot;);</span>
<a href="#l112.16"></a><span id="l112.16" class="difflineminus">-    let opList = searchOp.childNodes[0];</span>
<a href="#l112.17"></a><span id="l112.17" class="difflineplus">+    let opList = searchOp.children[0];</span>
<a href="#l112.18"></a><span id="l112.18">     opList.value = Ci.nsMsgSearchOp.Is;</span>
<a href="#l112.19"></a><span id="l112.19">     let searchValList = fec.e(&quot;searchVal0&quot;);</span>
<a href="#l112.20"></a><span id="l112.20" class="difflineminus">-    let searchVal = searchValList.childNodes[0];</span>
<a href="#l112.21"></a><span id="l112.21" class="difflineplus">+    let searchVal = searchValList.children[0];</span>
<a href="#l112.22"></a><span id="l112.22">     searchVal.setAttribute(&quot;value&quot;, &quot;test@foo.invalid&quot;);</span>
<a href="#l112.23"></a><span id="l112.23"> </span>
<a href="#l112.24"></a><span id="l112.24">     let filterActions = fec.e(&quot;filterActionList&quot;);</span>
<a href="#l112.25"></a><span id="l112.25">     let firstAction = filterActions.getItemAtIndex(0);</span>
<a href="#l112.26"></a><span id="l112.26">     firstAction.setAttribute(&quot;value&quot;, &quot;markasflagged&quot;);</span>
<a href="#l112.27"></a><span id="l112.27">     fec.e(&quot;FilterEditor&quot;).acceptDialog();</span>
<a href="#l112.28"></a><span id="l112.28">   }</span>
<a href="#l112.29"></a><span id="l112.29"> </span>
<a href="#l112.30"></a><span id="l112.30" class="difflineat">@@ -207,26 +207,26 @@ function test_address_books_appear_in_me</span>
<a href="#l112.31"></a><span id="l112.31">   // We'll assume that the filters dialog is already open from</span>
<a href="#l112.32"></a><span id="l112.32">   // the previous tests.</span>
<a href="#l112.33"></a><span id="l112.33">   let filterc = wait_for_existing_window(&quot;mailnews:filterlist&quot;);</span>
<a href="#l112.34"></a><span id="l112.34"> </span>
<a href="#l112.35"></a><span id="l112.35">   // Prepare a function to deal with the filter editor once it</span>
<a href="#l112.36"></a><span id="l112.36">   // has opened</span>
<a href="#l112.37"></a><span id="l112.37">   function filterEditorOpened(fec) {</span>
<a href="#l112.38"></a><span id="l112.38">     let searchAttr = fec.e(&quot;searchAttr0&quot;);</span>
<a href="#l112.39"></a><span id="l112.39" class="difflineminus">-    let attrList = searchAttr.childNodes[0];</span>
<a href="#l112.40"></a><span id="l112.40" class="difflineplus">+    let attrList = searchAttr.children[0];</span>
<a href="#l112.41"></a><span id="l112.41">     attrList.value = Ci.nsMsgSearchAttrib.To;</span>
<a href="#l112.42"></a><span id="l112.42">     let searchOp = fec.e(&quot;searchOp0&quot;);</span>
<a href="#l112.43"></a><span id="l112.43" class="difflineminus">-    let opList = searchOp.childNodes[0];</span>
<a href="#l112.44"></a><span id="l112.44" class="difflineplus">+    let opList = searchOp.children[0];</span>
<a href="#l112.45"></a><span id="l112.45">     opList.value = Ci.nsMsgSearchOp.IsInAB;</span>
<a href="#l112.46"></a><span id="l112.46">     let searchValue = fec.e(&quot;searchVal0&quot;);</span>
<a href="#l112.47"></a><span id="l112.47"> </span>
<a href="#l112.48"></a><span id="l112.48">     // The magic number &quot;4&quot; is because the address book list is the</span>
<a href="#l112.49"></a><span id="l112.49">     // 4th child node of the search-value widget.</span>
<a href="#l112.50"></a><span id="l112.50" class="difflineminus">-    let abList = searchValue.childNodes[4];</span>
<a href="#l112.51"></a><span id="l112.51" class="difflineplus">+    let abList = searchValue.children[4];</span>
<a href="#l112.52"></a><span id="l112.52"> </span>
<a href="#l112.53"></a><span id="l112.53">     // We should have 2 address books here - one for the Personal Address</span>
<a href="#l112.54"></a><span id="l112.54">     // Book, and one for Collected Addresses.  The LDAP address book should</span>
<a href="#l112.55"></a><span id="l112.55">     // not be shown, since it isn't a local address book.</span>
<a href="#l112.56"></a><span id="l112.56">     assert_equals(</span>
<a href="#l112.57"></a><span id="l112.57">       2,</span>
<a href="#l112.58"></a><span id="l112.58">       abList.itemCount,</span>
<a href="#l112.59"></a><span id="l112.59">       &quot;Did not display the correct number &quot; +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l113.1"></a><span id="l113.1" class="difflineminus">--- a/mail/test/mozmill/message-window/test-commands.js</span>
<a href="#l113.2"></a><span id="l113.2" class="difflineplus">+++ b/mail/test/mozmill/message-window/test-commands.js</span>
<a href="#l113.3"></a><span id="l113.3" class="difflineat">@@ -57,17 +57,17 @@ function test_copy_eml_message() {</span>
<a href="#l113.4"></a><span id="l113.4">   select_click_row(0);</span>
<a href="#l113.5"></a><span id="l113.5">   press_delete(mc);</span>
<a href="#l113.6"></a><span id="l113.6"> </span>
<a href="#l113.7"></a><span id="l113.7">   // Now, open a .eml file and copy it to our folder.</span>
<a href="#l113.8"></a><span id="l113.8">   let thisFilePath = os.getFileForPath(__file__);</span>
<a href="#l113.9"></a><span id="l113.9">   let file = os.getFileForPath(os.abspath(&quot;./evil.eml&quot;, thisFilePath));</span>
<a href="#l113.10"></a><span id="l113.10">   let msgc = open_message_from_file(file);</span>
<a href="#l113.11"></a><span id="l113.11"> </span>
<a href="#l113.12"></a><span id="l113.12" class="difflineminus">-  let documentChild = msgc.e(&quot;messagepane&quot;).contentDocument.firstChild;</span>
<a href="#l113.13"></a><span id="l113.13" class="difflineplus">+  let documentChild = msgc.e(&quot;messagepane&quot;).contentDocument.firstElementChild;</span>
<a href="#l113.14"></a><span id="l113.14">   msgc.rightClick(new elib.Elem(documentChild));</span>
<a href="#l113.15"></a><span id="l113.15">   msgc.click_menus_in_sequence(msgc.e(&quot;mailContext&quot;), [</span>
<a href="#l113.16"></a><span id="l113.16">     { id: &quot;mailContext-copyMenu&quot; },</span>
<a href="#l113.17"></a><span id="l113.17">     { label: &quot;Recent&quot; },</span>
<a href="#l113.18"></a><span id="l113.18">     { label: &quot;CopyToFolder&quot; },</span>
<a href="#l113.19"></a><span id="l113.19">   ]);</span>
<a href="#l113.20"></a><span id="l113.20">   close_window(msgc);</span>
<a href="#l113.21"></a><span id="l113.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l114.1"></a><span id="l114.1" class="difflineminus">--- a/mail/test/mozmill/search-window/test-search-window.js</span>
<a href="#l114.2"></a><span id="l114.2" class="difflineplus">+++ b/mail/test/mozmill/search-window/test-search-window.js</span>
<a href="#l114.3"></a><span id="l114.3" class="difflineat">@@ -104,32 +104,32 @@ function test_enter_some_stuff() {</span>
<a href="#l114.4"></a><span id="l114.4">   //  and swc.type.)</span>
<a href="#l114.5"></a><span id="l114.5">   let searchVal0 = swc.window.document.getElementById(&quot;searchVal0&quot;);</span>
<a href="#l114.6"></a><span id="l114.6">   let index = 0;</span>
<a href="#l114.7"></a><span id="l114.7"> </span>
<a href="#l114.8"></a><span id="l114.8">   if (searchVal0.hasAttribute(&quot;selectedIndex&quot;)) {</span>
<a href="#l114.9"></a><span id="l114.9">     index = parseInt(searchVal0.getAttribute(&quot;selectedIndex&quot;));</span>
<a href="#l114.10"></a><span id="l114.10">   }</span>
<a href="#l114.11"></a><span id="l114.11"> </span>
<a href="#l114.12"></a><span id="l114.12" class="difflineminus">-  searchVal0 = searchVal0.childNodes[index];</span>
<a href="#l114.13"></a><span id="l114.13" class="difflineplus">+  searchVal0 = searchVal0.children[index];</span>
<a href="#l114.14"></a><span id="l114.14">   searchVal0.value = &quot;foo&quot;;</span>
<a href="#l114.15"></a><span id="l114.15"> </span>
<a href="#l114.16"></a><span id="l114.16">   // - add another subject box</span>
<a href="#l114.17"></a><span id="l114.17">   let plusButton = swc.eid(&quot;searchRow0&quot;, { tagName: &quot;button&quot;, label: &quot;+&quot; });</span>
<a href="#l114.18"></a><span id="l114.18">   swc.click(plusButton);</span>
<a href="#l114.19"></a><span id="l114.19"> </span>
<a href="#l114.20"></a><span id="l114.20">   // - put &quot;bar&quot; in it</span>
<a href="#l114.21"></a><span id="l114.21">   let searchVal1 = swc.window.document.getElementById(&quot;searchVal1&quot;);</span>
<a href="#l114.22"></a><span id="l114.22">   index = 0;</span>
<a href="#l114.23"></a><span id="l114.23"> </span>
<a href="#l114.24"></a><span id="l114.24">   if (searchVal1.hasAttribute(&quot;selectedIndex&quot;)) {</span>
<a href="#l114.25"></a><span id="l114.25">     index = parseInt(searchVal1.getAttribute(&quot;selectedIndex&quot;));</span>
<a href="#l114.26"></a><span id="l114.26">   }</span>
<a href="#l114.27"></a><span id="l114.27"> </span>
<a href="#l114.28"></a><span id="l114.28" class="difflineminus">-  searchVal1 = searchVal1.childNodes[index];</span>
<a href="#l114.29"></a><span id="l114.29" class="difflineplus">+  searchVal1 = searchVal1.children[index];</span>
<a href="#l114.30"></a><span id="l114.30">   searchVal1.value = &quot;bar&quot;;</span>
<a href="#l114.31"></a><span id="l114.31"> }</span>
<a href="#l114.32"></a><span id="l114.32"> </span>
<a href="#l114.33"></a><span id="l114.33"> /**</span>
<a href="#l114.34"></a><span id="l114.34">  * Trigger the search, make sure the right results show up.</span>
<a href="#l114.35"></a><span id="l114.35">  */</span>
<a href="#l114.36"></a><span id="l114.36"> function test_go_search() {</span>
<a href="#l114.37"></a><span id="l114.37">   // - Trigger the search</span>
<a href="#l114.38"></a><span id="l114.38" class="difflineat">@@ -283,29 +283,29 @@ function subtest_save_search(savc) {</span>
<a href="#l114.39"></a><span id="l114.39">   //  we used to enter them, so it's very similar to check.</span>
<a href="#l114.40"></a><span id="l114.40">   let searchVal0 = swc.window.document.getElementById(&quot;searchVal0&quot;);</span>
<a href="#l114.41"></a><span id="l114.41">   let index = 0;</span>
<a href="#l114.42"></a><span id="l114.42"> </span>
<a href="#l114.43"></a><span id="l114.43">   if (searchVal0.hasAttribute(&quot;selectedIndex&quot;)) {</span>
<a href="#l114.44"></a><span id="l114.44">     index = parseInt(searchVal0.getAttribute(&quot;selectedIndex&quot;));</span>
<a href="#l114.45"></a><span id="l114.45">   }</span>
<a href="#l114.46"></a><span id="l114.46"> </span>
<a href="#l114.47"></a><span id="l114.47" class="difflineminus">-  searchVal0 = new elib.Elem(searchVal0.childNodes[index]);</span>
<a href="#l114.48"></a><span id="l114.48" class="difflineplus">+  searchVal0 = new elib.Elem(searchVal0.children[index]);</span>
<a href="#l114.49"></a><span id="l114.49"> </span>
<a href="#l114.50"></a><span id="l114.50">   savc.assertNode(searchVal0);</span>
<a href="#l114.51"></a><span id="l114.51">   savc.assertValue(searchVal0, &quot;foo&quot;);</span>
<a href="#l114.52"></a><span id="l114.52"> </span>
<a href="#l114.53"></a><span id="l114.53">   let searchVal1 = swc.window.document.getElementById(&quot;searchVal1&quot;);</span>
<a href="#l114.54"></a><span id="l114.54">   index = 0;</span>
<a href="#l114.55"></a><span id="l114.55"> </span>
<a href="#l114.56"></a><span id="l114.56">   if (searchVal1.hasAttribute(&quot;selectedIndex&quot;)) {</span>
<a href="#l114.57"></a><span id="l114.57">     index = parseInt(searchVal1.getAttribute(&quot;selectedIndex&quot;));</span>
<a href="#l114.58"></a><span id="l114.58">   }</span>
<a href="#l114.59"></a><span id="l114.59"> </span>
<a href="#l114.60"></a><span id="l114.60" class="difflineminus">-  searchVal1 = new elib.Elem(searchVal1.childNodes[index]);</span>
<a href="#l114.61"></a><span id="l114.61" class="difflineplus">+  searchVal1 = new elib.Elem(searchVal1.children[index]);</span>
<a href="#l114.62"></a><span id="l114.62"> </span>
<a href="#l114.63"></a><span id="l114.63">   savc.assertNode(searchVal1);</span>
<a href="#l114.64"></a><span id="l114.64">   savc.assertValue(searchVal1, &quot;bar&quot;);</span>
<a href="#l114.65"></a><span id="l114.65"> </span>
<a href="#l114.66"></a><span id="l114.66">   // - name the search</span>
<a href="#l114.67"></a><span id="l114.67">   savc.type(savc.eid(&quot;name&quot;), &quot;SearchSaved&quot;);</span>
<a href="#l114.68"></a><span id="l114.68"> </span>
<a href="#l114.69"></a><span id="l114.69">   // - save it!</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l115.1"></a><span id="l115.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm</span>
<a href="#l115.2"></a><span id="l115.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm</span>
<a href="#l115.3"></a><span id="l115.3" class="difflineat">@@ -108,19 +108,19 @@ function click_account_tree_row(controll</span>
<a href="#l115.4"></a><span id="l115.4">  *          Do not throw as callers may intentionally just check if a row exists.</span>
<a href="#l115.5"></a><span id="l115.5">  *          Just dump into the log so that a subsequent throw in</span>
<a href="#l115.6"></a><span id="l115.6">  *          click_account_tree_row has a useful context.</span>
<a href="#l115.7"></a><span id="l115.7">  */</span>
<a href="#l115.8"></a><span id="l115.8"> function get_account_tree_row(aAccountKey, aPaneId, aController) {</span>
<a href="#l115.9"></a><span id="l115.9">   let rowIndex = 0;</span>
<a href="#l115.10"></a><span id="l115.10">   let accountTreeNode = aController.e(&quot;account-tree-children&quot;);</span>
<a href="#l115.11"></a><span id="l115.11"> </span>
<a href="#l115.12"></a><span id="l115.12" class="difflineminus">-  for (let i = 0; i &lt; accountTreeNode.childNodes.length; i++) {</span>
<a href="#l115.13"></a><span id="l115.13" class="difflineminus">-    if (&quot;_account&quot; in accountTreeNode.childNodes[i]) {</span>
<a href="#l115.14"></a><span id="l115.14" class="difflineminus">-      let accountHead = accountTreeNode.childNodes[i];</span>
<a href="#l115.15"></a><span id="l115.15" class="difflineplus">+  for (let i = 0; i &lt; accountTreeNode.children.length; i++) {</span>
<a href="#l115.16"></a><span id="l115.16" class="difflineplus">+    if (&quot;_account&quot; in accountTreeNode.children[i]) {</span>
<a href="#l115.17"></a><span id="l115.17" class="difflineplus">+      let accountHead = accountTreeNode.children[i];</span>
<a href="#l115.18"></a><span id="l115.18">       if (aAccountKey == accountHead._account.key) {</span>
<a href="#l115.19"></a><span id="l115.19">         // If this is the wanted account, find the wanted settings pane.</span>
<a href="#l115.20"></a><span id="l115.20">         let accountBlock = accountHead.querySelectorAll(&quot;[PageTag]&quot;);</span>
<a href="#l115.21"></a><span id="l115.21">         // A null aPaneId means the main pane.</span>
<a href="#l115.22"></a><span id="l115.22">         if (!aPaneId) {</span>
<a href="#l115.23"></a><span id="l115.23">           return rowIndex;</span>
<a href="#l115.24"></a><span id="l115.24">         }</span>
<a href="#l115.25"></a><span id="l115.25"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l116.1"></a><span id="l116.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm</span>
<a href="#l116.2"></a><span id="l116.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm</span>
<a href="#l116.3"></a><span id="l116.3" class="difflineat">@@ -116,17 +116,17 @@ function assert_links_not_shown(aControl</span>
<a href="#l116.4"></a><span id="l116.4">     fdh.assert_equals(anchors.length, 0);</span>
<a href="#l116.5"></a><span id="l116.5">   });</span>
<a href="#l116.6"></a><span id="l116.6"> }</span>
<a href="#l116.7"></a><span id="l116.7"> </span>
<a href="#l116.8"></a><span id="l116.8"> /* Waits for account provisioner search results to come in.</span>
<a href="#l116.9"></a><span id="l116.9">  */</span>
<a href="#l116.10"></a><span id="l116.10"> function wait_for_search_results(w) {</span>
<a href="#l116.11"></a><span id="l116.11">   w.waitFor(</span>
<a href="#l116.12"></a><span id="l116.12" class="difflineminus">-    () =&gt; w.e(&quot;results&quot;).childNodes.length &gt; 0,</span>
<a href="#l116.13"></a><span id="l116.13" class="difflineplus">+    () =&gt; w.e(&quot;results&quot;).children.length &gt; 0,</span>
<a href="#l116.14"></a><span id="l116.14">     &quot;Timed out waiting for search results to arrive.&quot;</span>
<a href="#l116.15"></a><span id="l116.15">   );</span>
<a href="#l116.16"></a><span id="l116.16"> }</span>
<a href="#l116.17"></a><span id="l116.17"> </span>
<a href="#l116.18"></a><span id="l116.18"> /* Waits for the account provisioner to be displaying the offline</span>
<a href="#l116.19"></a><span id="l116.19">  * message.</span>
<a href="#l116.20"></a><span id="l116.20">  *</span>
<a href="#l116.21"></a><span id="l116.21">  * @param w  the controller parent of the element</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l117.1"></a><span id="l117.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm</span>
<a href="#l117.2"></a><span id="l117.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm</span>
<a href="#l117.3"></a><span id="l117.3" class="difflineat">@@ -126,17 +126,17 @@ function toggle_tag_mode() {</span>
<a href="#l117.4"></a><span id="l117.4">  *  provided variable argument list.  Ordering is significant.</span>
<a href="#l117.5"></a><span id="l117.5">  */</span>
<a href="#l117.6"></a><span id="l117.6"> function assert_tag_constraints_visible(...aArgs) {</span>
<a href="#l117.7"></a><span id="l117.7">   // the stupid bar should be visible if any arguments are specified</span>
<a href="#l117.8"></a><span id="l117.8">   if (aArgs.length &gt; 0 &amp;&amp; mc.e(&quot;quick-filter-bar-tab-bar&quot;).collapsed) {</span>
<a href="#l117.9"></a><span id="l117.9">     throw new Error(&quot;The tag bar should not be collapsed!&quot;);</span>
<a href="#l117.10"></a><span id="l117.10">   }</span>
<a href="#l117.11"></a><span id="l117.11"> </span>
<a href="#l117.12"></a><span id="l117.12" class="difflineminus">-  let kids = mc.e(&quot;quick-filter-bar-tab-bar&quot;).childNodes;</span>
<a href="#l117.13"></a><span id="l117.13" class="difflineplus">+  let kids = mc.e(&quot;quick-filter-bar-tab-bar&quot;).children;</span>
<a href="#l117.14"></a><span id="l117.14">   let tagLength = kids.length - 1; // -1 for the qfb-boolean-mode widget</span>
<a href="#l117.15"></a><span id="l117.15">   // this is bad error reporting in here for now.</span>
<a href="#l117.16"></a><span id="l117.16">   if (tagLength != aArgs.length) {</span>
<a href="#l117.17"></a><span id="l117.17">     throw new Error(</span>
<a href="#l117.18"></a><span id="l117.18">       &quot;Mismatch in expected tag count and actual. &quot; +</span>
<a href="#l117.19"></a><span id="l117.19">         &quot;Expected &quot; +</span>
<a href="#l117.20"></a><span id="l117.20">         aArgs.length +</span>
<a href="#l117.21"></a><span id="l117.21">         &quot; actual &quot; +</span>
<a href="#l117.22"></a><span id="l117.22" class="difflineat">@@ -164,17 +164,17 @@ function assert_tag_constraints_visible(</span>
<a href="#l117.23"></a><span id="l117.23">  */</span>
<a href="#l117.24"></a><span id="l117.24"> function assert_tag_constraints_checked(...aArgs) {</span>
<a href="#l117.25"></a><span id="l117.25">   let expected = {};</span>
<a href="#l117.26"></a><span id="l117.26">   for (let arg of aArgs) {</span>
<a href="#l117.27"></a><span id="l117.27">     let nodeId = &quot;qfb-tag-&quot; + arg;</span>
<a href="#l117.28"></a><span id="l117.28">     expected[nodeId] = true;</span>
<a href="#l117.29"></a><span id="l117.29">   }</span>
<a href="#l117.30"></a><span id="l117.30"> </span>
<a href="#l117.31"></a><span id="l117.31" class="difflineminus">-  let kids = mc.e(&quot;quick-filter-bar-tab-bar&quot;).childNodes;</span>
<a href="#l117.32"></a><span id="l117.32" class="difflineplus">+  let kids = mc.e(&quot;quick-filter-bar-tab-bar&quot;).children;</span>
<a href="#l117.33"></a><span id="l117.33">   for (let iNode = 0; iNode &lt; kids.length; iNode++) {</span>
<a href="#l117.34"></a><span id="l117.34">     let node = kids[iNode];</span>
<a href="#l117.35"></a><span id="l117.35">     if (node.checked != node.id in expected) {</span>
<a href="#l117.36"></a><span id="l117.36">       throw new Error(</span>
<a href="#l117.37"></a><span id="l117.37">         &quot;node &quot; +</span>
<a href="#l117.38"></a><span id="l117.38">           node.id +</span>
<a href="#l117.39"></a><span id="l117.39">           &quot; should &quot; +</span>
<a href="#l117.40"></a><span id="l117.40">           (node.id in expected ? &quot;be &quot; : &quot;not be &quot;) +</span>
<a href="#l117.41"></a><span id="l117.41" class="difflineat">@@ -202,17 +202,17 @@ function toggle_text_constraints(...aArg</span>
<a href="#l117.42"></a><span id="l117.42">  */</span>
<a href="#l117.43"></a><span id="l117.43"> function assert_text_constraints_checked(...aArgs) {</span>
<a href="#l117.44"></a><span id="l117.44">   let expected = {};</span>
<a href="#l117.45"></a><span id="l117.45">   for (let arg of aArgs) {</span>
<a href="#l117.46"></a><span id="l117.46">     let nodeId = nameToTextDomId[arg];</span>
<a href="#l117.47"></a><span id="l117.47">     expected[nodeId] = true;</span>
<a href="#l117.48"></a><span id="l117.48">   }</span>
<a href="#l117.49"></a><span id="l117.49"> </span>
<a href="#l117.50"></a><span id="l117.50" class="difflineminus">-  let kids = mc.e(&quot;quick-filter-bar-filter-text-bar&quot;).childNodes;</span>
<a href="#l117.51"></a><span id="l117.51" class="difflineplus">+  let kids = mc.e(&quot;quick-filter-bar-filter-text-bar&quot;).children;</span>
<a href="#l117.52"></a><span id="l117.52">   for (let iNode = 0; iNode &lt; kids.length; iNode++) {</span>
<a href="#l117.53"></a><span id="l117.53">     let node = kids[iNode];</span>
<a href="#l117.54"></a><span id="l117.54">     if (node.tagName == &quot;label&quot;) {</span>
<a href="#l117.55"></a><span id="l117.55">       continue;</span>
<a href="#l117.56"></a><span id="l117.56">     }</span>
<a href="#l117.57"></a><span id="l117.57">     if (node.checked != node.id in expected) {</span>
<a href="#l117.58"></a><span id="l117.58">       throw new Error(</span>
<a href="#l117.59"></a><span id="l117.59">         &quot;node &quot; +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l118.1"></a><span id="l118.1" class="difflineminus">--- a/mail/test/mozmill/tabmail/test-tabmail-customize.js</span>
<a href="#l118.2"></a><span id="l118.2" class="difflineplus">+++ b/mail/test/mozmill/tabmail/test-tabmail-customize.js</span>
<a href="#l118.3"></a><span id="l118.3" class="difflineat">@@ -90,17 +90,17 @@ function test_redirects_toolbarbutton_dr</span>
<a href="#l118.4"></a><span id="l118.4">       0.5,</span>
<a href="#l118.5"></a><span id="l118.5">       0.5,</span>
<a href="#l118.6"></a><span id="l118.6">       ctw.window</span>
<a href="#l118.7"></a><span id="l118.7">     );</span>
<a href="#l118.8"></a><span id="l118.8"> </span>
<a href="#l118.9"></a><span id="l118.9">     // Now let's check to make sure that this button is now the first</span>
<a href="#l118.10"></a><span id="l118.10">     // item in the tab bar toolbar.</span>
<a href="#l118.11"></a><span id="l118.11">     assert_equals(</span>
<a href="#l118.12"></a><span id="l118.12" class="difflineminus">-      toolbar.firstChild.id,</span>
<a href="#l118.13"></a><span id="l118.13" class="difflineplus">+      toolbar.firstElementChild.id,</span>
<a href="#l118.14"></a><span id="l118.14">       aButtonId,</span>
<a href="#l118.15"></a><span id="l118.15">       &quot;Button was not added as first child!&quot;</span>
<a href="#l118.16"></a><span id="l118.16">     );</span>
<a href="#l118.17"></a><span id="l118.17">   });</span>
<a href="#l118.18"></a><span id="l118.18"> </span>
<a href="#l118.19"></a><span id="l118.19">   // Ok, now let's try to grab some toolbar buttons from mail-bar3, and</span>
<a href="#l118.20"></a><span id="l118.20">   // make sure we can drop those on the tab bar too.</span>
<a href="#l118.21"></a><span id="l118.21">   [&quot;button-getmsg&quot;, &quot;button-newmsg&quot;, &quot;button-address&quot;, &quot;button-tag&quot;].forEach(</span>
<a href="#l118.22"></a><span id="l118.22" class="difflineat">@@ -115,17 +115,17 @@ function test_redirects_toolbarbutton_dr</span>
<a href="#l118.23"></a><span id="l118.23">         0.5,</span>
<a href="#l118.24"></a><span id="l118.24">         0.5,</span>
<a href="#l118.25"></a><span id="l118.25">         mc.window</span>
<a href="#l118.26"></a><span id="l118.26">       );</span>
<a href="#l118.27"></a><span id="l118.27"> </span>
<a href="#l118.28"></a><span id="l118.28">       // Now let's check to make sure that this button is now the first</span>
<a href="#l118.29"></a><span id="l118.29">       // item in the tab bar toolbar.</span>
<a href="#l118.30"></a><span id="l118.30">       assert_equals(</span>
<a href="#l118.31"></a><span id="l118.31" class="difflineminus">-        toolbar.firstChild.id,</span>
<a href="#l118.32"></a><span id="l118.32" class="difflineplus">+        toolbar.firstElementChild.id,</span>
<a href="#l118.33"></a><span id="l118.33">         &quot;wrapper-&quot; + aButtonId,</span>
<a href="#l118.34"></a><span id="l118.34">         &quot;Button was not added as first child!&quot;</span>
<a href="#l118.35"></a><span id="l118.35">       );</span>
<a href="#l118.36"></a><span id="l118.36">     }</span>
<a href="#l118.37"></a><span id="l118.37">   );</span>
<a href="#l118.38"></a><span id="l118.38"> </span>
<a href="#l118.39"></a><span id="l118.39">   gCDHelper.close(ctw);</span>
<a href="#l118.40"></a><span id="l118.40">   Services.prefs.clearUserPref(&quot;toolkit.customization.unsafe_drag_events&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l119.1"></a><span id="l119.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/content/modules/controller.jsm</span>
<a href="#l119.2"></a><span id="l119.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/content/modules/controller.jsm</span>
<a href="#l119.3"></a><span id="l119.3" class="difflineat">@@ -280,17 +280,17 @@ Menu.prototype = {</span>
<a href="#l119.4"></a><span id="l119.4">   /**</span>
<a href="#l119.5"></a><span id="l119.5">    * Recursive function which iterates through all menu elements and</span>
<a href="#l119.6"></a><span id="l119.6">    * populates the menus with dynamic menu entries.</span>
<a href="#l119.7"></a><span id="l119.7">    *</span>
<a href="#l119.8"></a><span id="l119.8">    * @param {node} menu</span>
<a href="#l119.9"></a><span id="l119.9">    *        Top menu node whose elements have to be populated</span>
<a href="#l119.10"></a><span id="l119.10">    */</span>
<a href="#l119.11"></a><span id="l119.11">   _buildMenu(menu) {</span>
<a href="#l119.12"></a><span id="l119.12" class="difflineminus">-    var items = menu ? menu.childNodes : [];</span>
<a href="#l119.13"></a><span id="l119.13" class="difflineplus">+    var items = menu ? menu.children : [];</span>
<a href="#l119.14"></a><span id="l119.14"> </span>
<a href="#l119.15"></a><span id="l119.15">     Array.from(items).forEach(function(item) {</span>
<a href="#l119.16"></a><span id="l119.16">       // When we have a menu node, fake a click onto it to populate</span>
<a href="#l119.17"></a><span id="l119.17">       // the sub menu with dynamic entries</span>
<a href="#l119.18"></a><span id="l119.18">       if (item.tagName == &quot;menu&quot;) {</span>
<a href="#l119.19"></a><span id="l119.19">         var popup = item.querySelector(&quot;menupopup&quot;);</span>
<a href="#l119.20"></a><span id="l119.20">         if (popup) {</span>
<a href="#l119.21"></a><span id="l119.21">           if (popup.allowevents) {</span>
<a href="#l119.22"></a><span id="l119.22" class="difflineat">@@ -302,17 +302,17 @@ Menu.prototype = {</span>
<a href="#l119.23"></a><span id="l119.23">     }, this);</span>
<a href="#l119.24"></a><span id="l119.24">   },</span>
<a href="#l119.25"></a><span id="l119.25"> };</span>
<a href="#l119.26"></a><span id="l119.26"> </span>
<a href="#l119.27"></a><span id="l119.27"> /**</span>
<a href="#l119.28"></a><span id="l119.28">  * Deprecated - Has to be removed with Mozmill 2.0</span>
<a href="#l119.29"></a><span id="l119.29">  */</span>
<a href="#l119.30"></a><span id="l119.30"> var MenuTree = function(aWindow, aMenu) {</span>
<a href="#l119.31"></a><span id="l119.31" class="difflineminus">-  var items = aMenu ? aMenu.childNodes : null;</span>
<a href="#l119.32"></a><span id="l119.32" class="difflineplus">+  var items = aMenu ? aMenu.children : null;</span>
<a href="#l119.33"></a><span id="l119.33">   if (!items) {</span>
<a href="#l119.34"></a><span id="l119.34">     return;</span>
<a href="#l119.35"></a><span id="l119.35">   }</span>
<a href="#l119.36"></a><span id="l119.36">   for (var node of items) {</span>
<a href="#l119.37"></a><span id="l119.37">     var entry = null;</span>
<a href="#l119.38"></a><span id="l119.38"> </span>
<a href="#l119.39"></a><span id="l119.39">     switch (node.tagName) {</span>
<a href="#l119.40"></a><span id="l119.40">       case &quot;menu&quot;:</span>
<a href="#l119.41"></a><span id="l119.41" class="difflineat">@@ -1474,18 +1474,18 @@ MozMillController.prototype.dragToElemen</span>
<a href="#l119.42"></a><span id="l119.42"> </span>
<a href="#l119.43"></a><span id="l119.43"> function preferencesAdditions(controller) {</span>
<a href="#l119.44"></a><span id="l119.44">   var mainTabs = controller.window.document.getAnonymousElementByAttribute(</span>
<a href="#l119.45"></a><span id="l119.45">     controller.window.document.documentElement,</span>
<a href="#l119.46"></a><span id="l119.46">     &quot;anonid&quot;,</span>
<a href="#l119.47"></a><span id="l119.47">     &quot;selector&quot;</span>
<a href="#l119.48"></a><span id="l119.48">   );</span>
<a href="#l119.49"></a><span id="l119.49">   controller.tabs = {};</span>
<a href="#l119.50"></a><span id="l119.50" class="difflineminus">-  for (var i = 0; i &lt; mainTabs.childNodes.length; i++) {</span>
<a href="#l119.51"></a><span id="l119.51" class="difflineminus">-    var node = mainTabs.childNodes[i];</span>
<a href="#l119.52"></a><span id="l119.52" class="difflineplus">+  for (var i = 0; i &lt; mainTabs.children.length; i++) {</span>
<a href="#l119.53"></a><span id="l119.53" class="difflineplus">+    var node = mainTabs.children[i];</span>
<a href="#l119.54"></a><span id="l119.54">     var obj = { button: node };</span>
<a href="#l119.55"></a><span id="l119.55">     controller.tabs[i] = obj;</span>
<a href="#l119.56"></a><span id="l119.56">     var label = node.attributes.item(&quot;label&quot;).value.replace(&quot;pane&quot;, &quot;&quot;);</span>
<a href="#l119.57"></a><span id="l119.57">     controller.tabs[label] = obj;</span>
<a href="#l119.58"></a><span id="l119.58">   }</span>
<a href="#l119.59"></a><span id="l119.59">   controller.prototype.__defineGetter__(&quot;activeTabButton&quot;, function() {</span>
<a href="#l119.60"></a><span id="l119.60">     return mainTabs.getElementsByAttribute(&quot;selected&quot;, true)[0];</span>
<a href="#l119.61"></a><span id="l119.61">   });</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l120.1"></a><span id="l120.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/content/modules/elementslib.jsm</span>
<a href="#l120.2"></a><span id="l120.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/content/modules/elementslib.jsm</span>
<a href="#l120.3"></a><span id="l120.3" class="difflineat">@@ -321,17 +321,17 @@ var _returnResult = function(results) {</span>
<a href="#l120.4"></a><span id="l120.4">     return null;</span>
<a href="#l120.5"></a><span id="l120.5">   } else if (results.length == 1) {</span>
<a href="#l120.6"></a><span id="l120.6">     return results[0];</span>
<a href="#l120.7"></a><span id="l120.7">   }</span>
<a href="#l120.8"></a><span id="l120.8">   return results;</span>
<a href="#l120.9"></a><span id="l120.9"> };</span>
<a href="#l120.10"></a><span id="l120.10"> var _forChildren = function(element, name, value) {</span>
<a href="#l120.11"></a><span id="l120.11">   var results = [];</span>
<a href="#l120.12"></a><span id="l120.12" class="difflineminus">-  var nodes = Array.from(element.childNodes).filter(e =&gt; e);</span>
<a href="#l120.13"></a><span id="l120.13" class="difflineplus">+  var nodes = Array.from(element.children).filter(e =&gt; e);</span>
<a href="#l120.14"></a><span id="l120.14">   for (var i in nodes) {</span>
<a href="#l120.15"></a><span id="l120.15">     var n = nodes[i];</span>
<a href="#l120.16"></a><span id="l120.16">     if (n[name] == value) {</span>
<a href="#l120.17"></a><span id="l120.17">       results.push(n);</span>
<a href="#l120.18"></a><span id="l120.18">     }</span>
<a href="#l120.19"></a><span id="l120.19">   }</span>
<a href="#l120.20"></a><span id="l120.20">   return results;</span>
<a href="#l120.21"></a><span id="l120.21"> };</span>
<a href="#l120.22"></a><span id="l120.22" class="difflineat">@@ -352,17 +352,17 @@ var _byID = function(_document, parent, </span>
<a href="#l120.23"></a><span id="l120.23">   return _returnResult(_forChildren(parent, &quot;id&quot;, value));</span>
<a href="#l120.24"></a><span id="l120.24"> };</span>
<a href="#l120.25"></a><span id="l120.25"> var _byName = function(_document, parent, value) {</span>
<a href="#l120.26"></a><span id="l120.26">   return _returnResult(_forChildren(parent, &quot;tagName&quot;, value));</span>
<a href="#l120.27"></a><span id="l120.27"> };</span>
<a href="#l120.28"></a><span id="l120.28"> var _byAttrib = function(parent, attributes) {</span>
<a href="#l120.29"></a><span id="l120.29">   var results = [];</span>
<a href="#l120.30"></a><span id="l120.30"> </span>
<a href="#l120.31"></a><span id="l120.31" class="difflineminus">-  var nodes = parent.childNodes;</span>
<a href="#l120.32"></a><span id="l120.32" class="difflineplus">+  var nodes = parent.children;</span>
<a href="#l120.33"></a><span id="l120.33">   for (var i in nodes) {</span>
<a href="#l120.34"></a><span id="l120.34">     var n = nodes[i];</span>
<a href="#l120.35"></a><span id="l120.35">     var requirementPass = 0;</span>
<a href="#l120.36"></a><span id="l120.36">     var requirementLength = 0;</span>
<a href="#l120.37"></a><span id="l120.37">     for (var a in attributes) {</span>
<a href="#l120.38"></a><span id="l120.38">       requirementLength++;</span>
<a href="#l120.39"></a><span id="l120.39">       try {</span>
<a href="#l120.40"></a><span id="l120.40">         if (</span>
<a href="#l120.41"></a><span id="l120.41" class="difflineat">@@ -411,25 +411,23 @@ var _byAnonAttrib = function(_document, </span>
<a href="#l120.42"></a><span id="l120.42">       if (requirementPass == requirementLength) {</span>
<a href="#l120.43"></a><span id="l120.43">         results.push(n);</span>
<a href="#l120.44"></a><span id="l120.44">       }</span>
<a href="#l120.45"></a><span id="l120.45">     }</span>
<a href="#l120.46"></a><span id="l120.46">   }</span>
<a href="#l120.47"></a><span id="l120.47">   resultsForNodes(nodes);</span>
<a href="#l120.48"></a><span id="l120.48">   if (results.length == 0) {</span>
<a href="#l120.49"></a><span id="l120.49">     resultsForNodes(</span>
<a href="#l120.50"></a><span id="l120.50" class="difflineminus">-      Array.from(parent.childNodes).filter(</span>
<a href="#l120.51"></a><span id="l120.51" class="difflineminus">-        n =&gt; n != undefined &amp;&amp; n.getAttribute</span>
<a href="#l120.52"></a><span id="l120.52" class="difflineminus">-      )</span>
<a href="#l120.53"></a><span id="l120.53" class="difflineplus">+      Array.from(parent.children).filter(n =&gt; n != undefined &amp;&amp; n.getAttribute)</span>
<a href="#l120.54"></a><span id="l120.54">     );</span>
<a href="#l120.55"></a><span id="l120.55">   }</span>
<a href="#l120.56"></a><span id="l120.56">   return _returnResult(results);</span>
<a href="#l120.57"></a><span id="l120.57"> };</span>
<a href="#l120.58"></a><span id="l120.58"> var _byIndex = function(_document, parent, i) {</span>
<a href="#l120.59"></a><span id="l120.59" class="difflineminus">-  return parent.childNodes[i];</span>
<a href="#l120.60"></a><span id="l120.60" class="difflineplus">+  return parent.children[i];</span>
<a href="#l120.61"></a><span id="l120.61"> };</span>
<a href="#l120.62"></a><span id="l120.62"> var _anonByName = function(_document, parent, value) {</span>
<a href="#l120.63"></a><span id="l120.63">   return _returnResult(_forAnonChildren(_document, parent, &quot;tagName&quot;, value));</span>
<a href="#l120.64"></a><span id="l120.64"> };</span>
<a href="#l120.65"></a><span id="l120.65"> var _anonByAttrib = function(_document, parent, value) {</span>
<a href="#l120.66"></a><span id="l120.66">   return _byAnonAttrib(_document, parent, value);</span>
<a href="#l120.67"></a><span id="l120.67"> };</span>
<a href="#l120.68"></a><span id="l120.68"> var _anonByIndex = function(_document, parent, i) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l121.1"></a><span id="l121.1" class="difflineminus">--- a/mailnews/addrbook/content/abResultsPane.js</span>
<a href="#l121.2"></a><span id="l121.2" class="difflineplus">+++ b/mailnews/addrbook/content/abResultsPane.js</span>
<a href="#l121.3"></a><span id="l121.3" class="difflineat">@@ -363,22 +363,22 @@ function UpdateSortIndicators(colID, sor</span>
<a href="#l121.4"></a><span id="l121.4">     if (sortedColumn) {</span>
<a href="#l121.5"></a><span id="l121.5">       sortedColumn.setAttribute(&quot;sortDirection&quot;, sortDirection);</span>
<a href="#l121.6"></a><span id="l121.6">       gAbResultsTree.setAttribute(&quot;sortCol&quot;, colID);</span>
<a href="#l121.7"></a><span id="l121.7">     }</span>
<a href="#l121.8"></a><span id="l121.8">   }</span>
<a href="#l121.9"></a><span id="l121.9"> </span>
<a href="#l121.10"></a><span id="l121.10">   // remove the sort indicator from all the columns</span>
<a href="#l121.11"></a><span id="l121.11">   // except the one we are sorted by</span>
<a href="#l121.12"></a><span id="l121.12" class="difflineminus">-  var currCol = gAbResultsTree.firstChild.firstChild;</span>
<a href="#l121.13"></a><span id="l121.13" class="difflineplus">+  var currCol = gAbResultsTree.firstElementChild.firstElementChild;</span>
<a href="#l121.14"></a><span id="l121.14">   while (currCol) {</span>
<a href="#l121.15"></a><span id="l121.15">     if (currCol != sortedColumn &amp;&amp; currCol.localName == &quot;treecol&quot;) {</span>
<a href="#l121.16"></a><span id="l121.16">       currCol.removeAttribute(&quot;sortDirection&quot;);</span>
<a href="#l121.17"></a><span id="l121.17">     }</span>
<a href="#l121.18"></a><span id="l121.18" class="difflineminus">-    currCol = currCol.nextSibling;</span>
<a href="#l121.19"></a><span id="l121.19" class="difflineplus">+    currCol = currCol.nextElementSibling;</span>
<a href="#l121.20"></a><span id="l121.20">   }</span>
<a href="#l121.21"></a><span id="l121.21"> }</span>
<a href="#l121.22"></a><span id="l121.22"> </span>
<a href="#l121.23"></a><span id="l121.23"> function InvalidateResultsPane() {</span>
<a href="#l121.24"></a><span id="l121.24">   if (gAbResultsTree) {</span>
<a href="#l121.25"></a><span id="l121.25">     gAbResultsTree.invalidate();</span>
<a href="#l121.26"></a><span id="l121.26">   }</span>
<a href="#l121.27"></a><span id="l121.27"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l122.1"></a><span id="l122.1" class="difflineminus">--- a/mailnews/base/content/folder-menupopup.js</span>
<a href="#l122.2"></a><span id="l122.2" class="difflineplus">+++ b/mailnews/base/content/folder-menupopup.js</span>
<a href="#l122.3"></a><span id="l122.3" class="difflineat">@@ -296,22 +296,22 @@</span>
<a href="#l122.4"></a><span id="l122.4">           },</span>
<a href="#l122.5"></a><span id="l122.5">           OnItemPropertyFlagChanged(item, property, old, newItem) {},</span>
<a href="#l122.6"></a><span id="l122.6"> </span>
<a href="#l122.7"></a><span id="l122.7">           OnItemEvent(folder, eventName) {</span>
<a href="#l122.8"></a><span id="l122.8">             if (eventName == &quot;MRMTimeChanged&quot;) {</span>
<a href="#l122.9"></a><span id="l122.9">               if (</span>
<a href="#l122.10"></a><span id="l122.10">                 this._menu.getAttribute(&quot;showRecent&quot;) != &quot;true&quot; ||</span>
<a href="#l122.11"></a><span id="l122.11">                 !this._menu._initializedSpecials.has(&quot;recent&quot;) ||</span>
<a href="#l122.12"></a><span id="l122.12" class="difflineminus">-                !this._menu.childWrapper.firstChild</span>
<a href="#l122.13"></a><span id="l122.13" class="difflineplus">+                !this._menu.childWrapper.firstElementChild</span>
<a href="#l122.14"></a><span id="l122.14">               ) {</span>
<a href="#l122.15"></a><span id="l122.15">                 return;</span>
<a href="#l122.16"></a><span id="l122.16">               }</span>
<a href="#l122.17"></a><span id="l122.17"> </span>
<a href="#l122.18"></a><span id="l122.18" class="difflineminus">-              const recentMenuItem = this._menu.childWrapper.firstChild;</span>
<a href="#l122.19"></a><span id="l122.19" class="difflineplus">+              const recentMenuItem = this._menu.childWrapper.firstElementChild;</span>
<a href="#l122.20"></a><span id="l122.20">               const recentSubMenu = this._menu._getSubMenuForMenuItem(</span>
<a href="#l122.21"></a><span id="l122.21">                 recentMenuItem</span>
<a href="#l122.22"></a><span id="l122.22">               );</span>
<a href="#l122.23"></a><span id="l122.23"> </span>
<a href="#l122.24"></a><span id="l122.24">               // If this folder is already in the recent menu, return.</span>
<a href="#l122.25"></a><span id="l122.25">               if (</span>
<a href="#l122.26"></a><span id="l122.26">                 !recentSubMenu ||</span>
<a href="#l122.27"></a><span id="l122.27">                 this._getChildForItem(folder, recentSubMenu)</span>
<a href="#l122.28"></a><span id="l122.28" class="difflineat">@@ -343,17 +343,17 @@</span>
<a href="#l122.29"></a><span id="l122.29">           _getChildForItem(item, menu = this._menu) {</span>
<a href="#l122.30"></a><span id="l122.30">             if (</span>
<a href="#l122.31"></a><span id="l122.31">               !menu ||</span>
<a href="#l122.32"></a><span id="l122.32">               !menu.childWrapper.hasChildNodes() ||</span>
<a href="#l122.33"></a><span id="l122.33">               !(item instanceof Ci.nsIMsgFolder)</span>
<a href="#l122.34"></a><span id="l122.34">             ) {</span>
<a href="#l122.35"></a><span id="l122.35">               return null;</span>
<a href="#l122.36"></a><span id="l122.36">             }</span>
<a href="#l122.37"></a><span id="l122.37" class="difflineminus">-            for (let child of menu.childWrapper.childNodes) {</span>
<a href="#l122.38"></a><span id="l122.38" class="difflineplus">+            for (let child of menu.childWrapper.children) {</span>
<a href="#l122.39"></a><span id="l122.39">               if (child._folder &amp;&amp; child._folder.URI == item.URI) {</span>
<a href="#l122.40"></a><span id="l122.40">                 return child;</span>
<a href="#l122.41"></a><span id="l122.41">               }</span>
<a href="#l122.42"></a><span id="l122.42">             }</span>
<a href="#l122.43"></a><span id="l122.43">             return null;</span>
<a href="#l122.44"></a><span id="l122.44">           },</span>
<a href="#l122.45"></a><span id="l122.45">         };</span>
<a href="#l122.46"></a><span id="l122.46"> </span>
<a href="#l122.47"></a><span id="l122.47" class="difflineat">@@ -971,17 +971,17 @@</span>
<a href="#l122.48"></a><span id="l122.48">           menulist.setAttribute(</span>
<a href="#l122.49"></a><span id="l122.49">             &quot;IsFeedFolder&quot;,</span>
<a href="#l122.50"></a><span id="l122.50">             Boolean(folder &amp;&amp; FeedUtils.getFeedUrlsInFolder(folder))</span>
<a href="#l122.51"></a><span id="l122.51">           );</span>
<a href="#l122.52"></a><span id="l122.52">         }</span>
<a href="#l122.53"></a><span id="l122.53"> </span>
<a href="#l122.54"></a><span id="l122.54">         let folder;</span>
<a href="#l122.55"></a><span id="l122.55">         if (inputFolder) {</span>
<a href="#l122.56"></a><span id="l122.56" class="difflineminus">-          for (let child of this.childNodes) {</span>
<a href="#l122.57"></a><span id="l122.57" class="difflineplus">+          for (let child of this.children) {</span>
<a href="#l122.58"></a><span id="l122.58">             if (</span>
<a href="#l122.59"></a><span id="l122.59">               child &amp;&amp;</span>
<a href="#l122.60"></a><span id="l122.60">               child._folder &amp;&amp;</span>
<a href="#l122.61"></a><span id="l122.61">               !child.disabled &amp;&amp;</span>
<a href="#l122.62"></a><span id="l122.62">               (child._folder.URI == inputFolder.URI ||</span>
<a href="#l122.63"></a><span id="l122.63">                 (child.tagName == &quot;menu&quot; &amp;&amp;</span>
<a href="#l122.64"></a><span id="l122.64">                   child._folder.isAncestorOf(inputFolder)))</span>
<a href="#l122.65"></a><span id="l122.65">             ) {</span>
<a href="#l122.66"></a><span id="l122.66" class="difflineat">@@ -1020,18 +1020,18 @@</span>
<a href="#l122.67"></a><span id="l122.67">        * `toolbarbutton` menu items), resets all fields, and removes the listener.</span>
<a href="#l122.68"></a><span id="l122.68">        * This function is called when a change that affects this menu is detected</span>
<a href="#l122.69"></a><span id="l122.69">        * by the listener.</span>
<a href="#l122.70"></a><span id="l122.70">        */</span>
<a href="#l122.71"></a><span id="l122.71">       _teardown() {</span>
<a href="#l122.72"></a><span id="l122.72">         if (!this._initialized) {</span>
<a href="#l122.73"></a><span id="l122.73">           return;</span>
<a href="#l122.74"></a><span id="l122.74">         }</span>
<a href="#l122.75"></a><span id="l122.75" class="difflineminus">-        const children = this.childWrapper.childNodes;</span>
<a href="#l122.76"></a><span id="l122.76" class="difflineminus">-        // We iterate in reverse order because childNodes is live so it changes</span>
<a href="#l122.77"></a><span id="l122.77" class="difflineplus">+        const children = this.childWrapper.children;</span>
<a href="#l122.78"></a><span id="l122.78" class="difflineplus">+        // We iterate in reverse order because children is live so it changes</span>
<a href="#l122.79"></a><span id="l122.79">         // as we remove child nodes.</span>
<a href="#l122.80"></a><span id="l122.80">         for (let i = children.length - 1; i &gt;= 0; i--) {</span>
<a href="#l122.81"></a><span id="l122.81">           const item = children[i];</span>
<a href="#l122.82"></a><span id="l122.82">           if (item.getAttribute(&quot;generated&quot;) != &quot;true&quot;) {</span>
<a href="#l122.83"></a><span id="l122.83">             continue;</span>
<a href="#l122.84"></a><span id="l122.84">           }</span>
<a href="#l122.85"></a><span id="l122.85">           const submenu = this._getSubMenuForMenuItem(item);</span>
<a href="#l122.86"></a><span id="l122.86"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l123.1"></a><span id="l123.1" class="difflineminus">--- a/mailnews/base/prefs/content/AccountManager.js</span>
<a href="#l123.2"></a><span id="l123.2" class="difflineplus">+++ b/mailnews/base/prefs/content/AccountManager.js</span>
<a href="#l123.3"></a><span id="l123.3" class="difflineat">@@ -160,24 +160,24 @@ function onLoad() {</span>
<a href="#l123.4"></a><span id="l123.4"> function onUnload() {</span>
<a href="#l123.5"></a><span id="l123.5">   gAccountTree.unload();</span>
<a href="#l123.6"></a><span id="l123.6"> }</span>
<a href="#l123.7"></a><span id="l123.7"> </span>
<a href="#l123.8"></a><span id="l123.8"> function selectServer(server, selectPageId) {</span>
<a href="#l123.9"></a><span id="l123.9">   let childrenNode = document.getElementById(&quot;account-tree-children&quot;);</span>
<a href="#l123.10"></a><span id="l123.10"> </span>
<a href="#l123.11"></a><span id="l123.11">   // Default to showing the first account.</span>
<a href="#l123.12"></a><span id="l123.12" class="difflineminus">-  let accountNode = childrenNode.firstChild;</span>
<a href="#l123.13"></a><span id="l123.13" class="difflineplus">+  let accountNode = childrenNode.firstElementChild;</span>
<a href="#l123.14"></a><span id="l123.14"> </span>
<a href="#l123.15"></a><span id="l123.15">   // Find the tree-node for the account we want to select</span>
<a href="#l123.16"></a><span id="l123.16">   if (server) {</span>
<a href="#l123.17"></a><span id="l123.17" class="difflineminus">-    for (let i = 0; i &lt; childrenNode.childNodes.length; i++) {</span>
<a href="#l123.18"></a><span id="l123.18" class="difflineminus">-      let account = childrenNode.childNodes[i]._account;</span>
<a href="#l123.19"></a><span id="l123.19" class="difflineplus">+    for (let i = 0; i &lt; childrenNode.children.length; i++) {</span>
<a href="#l123.20"></a><span id="l123.20" class="difflineplus">+      let account = childrenNode.children[i]._account;</span>
<a href="#l123.21"></a><span id="l123.21">       if (account &amp;&amp; server == account.incomingServer) {</span>
<a href="#l123.22"></a><span id="l123.22" class="difflineminus">-        accountNode = childrenNode.childNodes[i];</span>
<a href="#l123.23"></a><span id="l123.23" class="difflineplus">+        accountNode = childrenNode.children[i];</span>
<a href="#l123.24"></a><span id="l123.24">         // Make sure all the panes of the account to be selected are shown.</span>
<a href="#l123.25"></a><span id="l123.25">         accountNode.setAttribute(&quot;open&quot;, &quot;true&quot;);</span>
<a href="#l123.26"></a><span id="l123.26">         break;</span>
<a href="#l123.27"></a><span id="l123.27">       }</span>
<a href="#l123.28"></a><span id="l123.28">     }</span>
<a href="#l123.29"></a><span id="l123.29">   }</span>
<a href="#l123.30"></a><span id="l123.30"> </span>
<a href="#l123.31"></a><span id="l123.31">   let pageToSelect = accountNode;</span>
<a href="#l123.32"></a><span id="l123.32" class="difflineat">@@ -194,17 +194,17 @@ function selectServer(server, selectPage</span>
<a href="#l123.33"></a><span id="l123.33">     }</span>
<a href="#l123.34"></a><span id="l123.34">   }</span>
<a href="#l123.35"></a><span id="l123.35"> </span>
<a href="#l123.36"></a><span id="l123.36">   let accountTree = document.getElementById(&quot;accounttree&quot;);</span>
<a href="#l123.37"></a><span id="l123.37">   let index = accountTree.view.getIndexOfItem(pageToSelect);</span>
<a href="#l123.38"></a><span id="l123.38">   accountTree.view.selection.select(index);</span>
<a href="#l123.39"></a><span id="l123.39">   accountTree.ensureRowIsVisible(index);</span>
<a href="#l123.40"></a><span id="l123.40"> </span>
<a href="#l123.41"></a><span id="l123.41" class="difflineminus">-  let lastItem = accountNode.lastChild.lastChild;</span>
<a href="#l123.42"></a><span id="l123.42" class="difflineplus">+  let lastItem = accountNode.lastElementChild.lastElementChild;</span>
<a href="#l123.43"></a><span id="l123.43">   if (lastItem.localName == &quot;treeitem&quot;) {</span>
<a href="#l123.44"></a><span id="l123.44">     index = accountTree.view.getIndexOfItem(lastItem);</span>
<a href="#l123.45"></a><span id="l123.45">   }</span>
<a href="#l123.46"></a><span id="l123.46"> </span>
<a href="#l123.47"></a><span id="l123.47">   accountTree.ensureRowIsVisible(index);</span>
<a href="#l123.48"></a><span id="l123.48"> }</span>
<a href="#l123.49"></a><span id="l123.49"> </span>
<a href="#l123.50"></a><span id="l123.50"> function replaceWithDefaultSmtpServer(deletedSmtpServerKey) {</span>
<a href="#l123.51"></a><span id="l123.51" class="difflineat">@@ -793,28 +793,35 @@ function onAddAccount() {</span>
<a href="#l123.52"></a><span id="l123.52">  *                    Can be given as null if there was none.</span>
<a href="#l123.53"></a><span id="l123.53">  */</span>
<a href="#l123.54"></a><span id="l123.54"> function markDefaultServer(newDefault, oldDefault) {</span>
<a href="#l123.55"></a><span id="l123.55">   if (oldDefault == newDefault) {</span>
<a href="#l123.56"></a><span id="l123.56">     return;</span>
<a href="#l123.57"></a><span id="l123.57">   }</span>
<a href="#l123.58"></a><span id="l123.58"> </span>
<a href="#l123.59"></a><span id="l123.59">   let accountTree = document.getElementById(&quot;account-tree-children&quot;);</span>
<a href="#l123.60"></a><span id="l123.60" class="difflineminus">-  for (let accountNode of accountTree.childNodes) {</span>
<a href="#l123.61"></a><span id="l123.61" class="difflineplus">+  for (let accountNode of accountTree.children) {</span>
<a href="#l123.62"></a><span id="l123.62">     if (newDefault &amp;&amp; newDefault == accountNode._account) {</span>
<a href="#l123.63"></a><span id="l123.63" class="difflineminus">-      let props = accountNode.firstChild.firstChild.getAttribute(&quot;properties&quot;);</span>
<a href="#l123.64"></a><span id="l123.64" class="difflineminus">-      accountNode.firstChild.firstChild.setAttribute(</span>
<a href="#l123.65"></a><span id="l123.65" class="difflineplus">+      let props = accountNode.firstElementChild.firstElementChild.getAttribute(</span>
<a href="#l123.66"></a><span id="l123.66" class="difflineplus">+        &quot;properties&quot;</span>
<a href="#l123.67"></a><span id="l123.67" class="difflineplus">+      );</span>
<a href="#l123.68"></a><span id="l123.68" class="difflineplus">+      accountNode.firstElementChild.firstElementChild.setAttribute(</span>
<a href="#l123.69"></a><span id="l123.69">         &quot;properties&quot;,</span>
<a href="#l123.70"></a><span id="l123.70">         props + &quot; isDefaultServer-true&quot;</span>
<a href="#l123.71"></a><span id="l123.71">       );</span>
<a href="#l123.72"></a><span id="l123.72">     }</span>
<a href="#l123.73"></a><span id="l123.73">     if (oldDefault &amp;&amp; oldDefault == accountNode._account) {</span>
<a href="#l123.74"></a><span id="l123.74" class="difflineminus">-      let props = accountNode.firstChild.firstChild.getAttribute(&quot;properties&quot;);</span>
<a href="#l123.75"></a><span id="l123.75" class="difflineplus">+      let props = accountNode.firstElementChild.firstElementChild.getAttribute(</span>
<a href="#l123.76"></a><span id="l123.76" class="difflineplus">+        &quot;properties&quot;</span>
<a href="#l123.77"></a><span id="l123.77" class="difflineplus">+      );</span>
<a href="#l123.78"></a><span id="l123.78">       props = props.replace(/isDefaultServer-true/, &quot;&quot;);</span>
<a href="#l123.79"></a><span id="l123.79" class="difflineminus">-      accountNode.firstChild.firstChild.setAttribute(&quot;properties&quot;, props);</span>
<a href="#l123.80"></a><span id="l123.80" class="difflineplus">+      accountNode.firstElementChild.firstElementChild.setAttribute(</span>
<a href="#l123.81"></a><span id="l123.81" class="difflineplus">+        &quot;properties&quot;,</span>
<a href="#l123.82"></a><span id="l123.82" class="difflineplus">+        props</span>
<a href="#l123.83"></a><span id="l123.83" class="difflineplus">+      );</span>
<a href="#l123.84"></a><span id="l123.84">     }</span>
<a href="#l123.85"></a><span id="l123.85">   }</span>
<a href="#l123.86"></a><span id="l123.86"> }</span>
<a href="#l123.87"></a><span id="l123.87"> </span>
<a href="#l123.88"></a><span id="l123.88"> /**</span>
<a href="#l123.89"></a><span id="l123.89">  * Sets the name of the account rowitem in the tree pane.</span>
<a href="#l123.90"></a><span id="l123.90">  *</span>
<a href="#l123.91"></a><span id="l123.91">  * @param aAccountKey   the key of the account to change</span>
<a href="#l123.92"></a><span id="l123.92" class="difflineat">@@ -823,22 +830,22 @@ function markDefaultServer(newDefault, o</span>
<a href="#l123.93"></a><span id="l123.93">  */</span>
<a href="#l123.94"></a><span id="l123.94"> function setAccountLabel(aAccountKey, aAccountNode, aLabel) {</span>
<a href="#l123.95"></a><span id="l123.95">   if (!aAccountNode) {</span>
<a href="#l123.96"></a><span id="l123.96">     // We can't use the current tree selection to determine the current account,</span>
<a href="#l123.97"></a><span id="l123.97">     // because this function may be called when the selection</span>
<a href="#l123.98"></a><span id="l123.98">     // is already on another tree item (account) than the one we want to change.</span>
<a href="#l123.99"></a><span id="l123.99">     // So find the proper node using the account key.</span>
<a href="#l123.100"></a><span id="l123.100">     let accountTree = document.getElementById(&quot;account-tree-children&quot;);</span>
<a href="#l123.101"></a><span id="l123.101" class="difflineminus">-    for (let accountNode of accountTree.childNodes) {</span>
<a href="#l123.102"></a><span id="l123.102" class="difflineplus">+    for (let accountNode of accountTree.children) {</span>
<a href="#l123.103"></a><span id="l123.103">       if (</span>
<a href="#l123.104"></a><span id="l123.104">         &quot;_account&quot; in accountNode &amp;&amp;</span>
<a href="#l123.105"></a><span id="l123.105">         accountNode._account.key == aAccountKey</span>
<a href="#l123.106"></a><span id="l123.106">       ) {</span>
<a href="#l123.107"></a><span id="l123.107" class="difflineminus">-        aAccountNode = accountNode.firstChild.firstChild;</span>
<a href="#l123.108"></a><span id="l123.108" class="difflineplus">+        aAccountNode = accountNode.firstElementChild.firstElementChild;</span>
<a href="#l123.109"></a><span id="l123.109">         break;</span>
<a href="#l123.110"></a><span id="l123.110">       }</span>
<a href="#l123.111"></a><span id="l123.111">     }</span>
<a href="#l123.112"></a><span id="l123.112">   }</span>
<a href="#l123.113"></a><span id="l123.113">   aAccountNode.setAttribute(&quot;label&quot;, aLabel);</span>
<a href="#l123.114"></a><span id="l123.114"> }</span>
<a href="#l123.115"></a><span id="l123.115"> </span>
<a href="#l123.116"></a><span id="l123.116"> /**</span>
<a href="#l123.117"></a><span id="l123.117" class="difflineat">@@ -870,19 +877,19 @@ function onRemoveAccount(event) {</span>
<a href="#l123.118"></a><span id="l123.118">   let canDelete = server.protocolInfo.canDelete || server.canDelete;</span>
<a href="#l123.119"></a><span id="l123.119">   if (!canDelete) {</span>
<a href="#l123.120"></a><span id="l123.120">     return;</span>
<a href="#l123.121"></a><span id="l123.121">   }</span>
<a href="#l123.122"></a><span id="l123.122"> </span>
<a href="#l123.123"></a><span id="l123.123">   let serverList = [];</span>
<a href="#l123.124"></a><span id="l123.124">   let accountTreeNode = document.getElementById(&quot;account-tree-children&quot;);</span>
<a href="#l123.125"></a><span id="l123.125">   // build the list of servers in the account tree (order is important)</span>
<a href="#l123.126"></a><span id="l123.126" class="difflineminus">-  for (let i = 0; i &lt; accountTreeNode.childNodes.length; i++) {</span>
<a href="#l123.127"></a><span id="l123.127" class="difflineminus">-    if (&quot;_account&quot; in accountTreeNode.childNodes[i]) {</span>
<a href="#l123.128"></a><span id="l123.128" class="difflineminus">-      let curServer = accountTreeNode.childNodes[i]._account.incomingServer;</span>
<a href="#l123.129"></a><span id="l123.129" class="difflineplus">+  for (let i = 0; i &lt; accountTreeNode.children.length; i++) {</span>
<a href="#l123.130"></a><span id="l123.130" class="difflineplus">+    if (&quot;_account&quot; in accountTreeNode.children[i]) {</span>
<a href="#l123.131"></a><span id="l123.131" class="difflineplus">+      let curServer = accountTreeNode.children[i]._account.incomingServer;</span>
<a href="#l123.132"></a><span id="l123.132">       if (!serverList.includes(curServer)) {</span>
<a href="#l123.133"></a><span id="l123.133">         serverList.push(curServer);</span>
<a href="#l123.134"></a><span id="l123.134">       }</span>
<a href="#l123.135"></a><span id="l123.135">     }</span>
<a href="#l123.136"></a><span id="l123.136">   }</span>
<a href="#l123.137"></a><span id="l123.137"> </span>
<a href="#l123.138"></a><span id="l123.138">   // get position of the current server in the server list</span>
<a href="#l123.139"></a><span id="l123.139">   let serverIndex = serverList.indexOf(server);</span>
<a href="#l123.140"></a><span id="l123.140" class="difflineat">@@ -1094,17 +1101,17 @@ function initAccountActionsButtons(menup</span>
<a href="#l123.141"></a><span id="l123.141">   updateItems(</span>
<a href="#l123.142"></a><span id="l123.142">     document.getElementById(&quot;accounttree&quot;),</span>
<a href="#l123.143"></a><span id="l123.143">     getCurrentAccount(),</span>
<a href="#l123.144"></a><span id="l123.144">     document.getElementById(&quot;accountActionsAddMailAccount&quot;),</span>
<a href="#l123.145"></a><span id="l123.145">     document.getElementById(&quot;accountActionsDropdownSetDefault&quot;),</span>
<a href="#l123.146"></a><span id="l123.146">     document.getElementById(&quot;accountActionsDropdownRemove&quot;)</span>
<a href="#l123.147"></a><span id="l123.147">   );</span>
<a href="#l123.148"></a><span id="l123.148"> </span>
<a href="#l123.149"></a><span id="l123.149" class="difflineminus">-  updateBlockedItems(menupopup.childNodes, true);</span>
<a href="#l123.150"></a><span id="l123.150" class="difflineplus">+  updateBlockedItems(menupopup.children, true);</span>
<a href="#l123.151"></a><span id="l123.151"> }</span>
<a href="#l123.152"></a><span id="l123.152"> </span>
<a href="#l123.153"></a><span id="l123.153"> /**</span>
<a href="#l123.154"></a><span id="l123.154">  * Determine enabled/disabled state for the passed in elements</span>
<a href="#l123.155"></a><span id="l123.155">  * representing account actions.</span>
<a href="#l123.156"></a><span id="l123.156">  */</span>
<a href="#l123.157"></a><span id="l123.157"> function updateItems(</span>
<a href="#l123.158"></a><span id="l123.158">   tree,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l124.1"></a><span id="l124.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-addressing.js</span>
<a href="#l124.2"></a><span id="l124.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-addressing.js</span>
<a href="#l124.3"></a><span id="l124.3" class="difflineat">@@ -36,21 +36,21 @@ function LDAPenabling() {</span>
<a href="#l124.4"></a><span id="l124.4">   onCheckItem(&quot;identity.directoryServer&quot;, [&quot;directories&quot;]);</span>
<a href="#l124.5"></a><span id="l124.5">   onCheckItem(&quot;editButton&quot;, [&quot;directories&quot;]);</span>
<a href="#l124.6"></a><span id="l124.6"> }</span>
<a href="#l124.7"></a><span id="l124.7"> </span>
<a href="#l124.8"></a><span id="l124.8"> function quoteEnabling() {</span>
<a href="#l124.9"></a><span id="l124.9">   var placebox = document.getElementById(&quot;placeBox&quot;);</span>
<a href="#l124.10"></a><span id="l124.10"> </span>
<a href="#l124.11"></a><span id="l124.11">   if (document.getElementById(&quot;identity.replyOnTop&quot;).value == &quot;1&quot;) {</span>
<a href="#l124.12"></a><span id="l124.12" class="difflineminus">-    placebox.firstChild.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l124.13"></a><span id="l124.13" class="difflineminus">-    placebox.lastChild.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l124.14"></a><span id="l124.14" class="difflineplus">+    placebox.firstElementChild.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l124.15"></a><span id="l124.15" class="difflineplus">+    placebox.lastElementChild.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l124.16"></a><span id="l124.16">   } else {</span>
<a href="#l124.17"></a><span id="l124.17" class="difflineminus">-    placebox.firstChild.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l124.18"></a><span id="l124.18" class="difflineminus">-    placebox.lastChild.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l124.19"></a><span id="l124.19" class="difflineplus">+    placebox.firstElementChild.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l124.20"></a><span id="l124.20" class="difflineplus">+    placebox.lastElementChild.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l124.21"></a><span id="l124.21">   }</span>
<a href="#l124.22"></a><span id="l124.22"> }</span>
<a href="#l124.23"></a><span id="l124.23"> </span>
<a href="#l124.24"></a><span id="l124.24"> /**</span>
<a href="#l124.25"></a><span id="l124.25">  * Open the Preferences dialog on the tab with Addressing options.</span>
<a href="#l124.26"></a><span id="l124.26">  */</span>
<a href="#l124.27"></a><span id="l124.27"> function showGlobalAddressingPrefs() {</span>
<a href="#l124.28"></a><span id="l124.28">   openPrefsFromAccountManager(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l125.1"></a><span id="l125.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-junk.js</span>
<a href="#l125.2"></a><span id="l125.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-junk.js</span>
<a href="#l125.3"></a><span id="l125.3" class="difflineat">@@ -185,17 +185,17 @@ function onAdaptiveJunkToggle() {</span>
<a href="#l125.4"></a><span id="l125.4">   // Enable/disable individual listbox rows.</span>
<a href="#l125.5"></a><span id="l125.5">   // Setting enable/disable on the parent listbox does not seem to work.</span>
<a href="#l125.6"></a><span id="l125.6">   let wList = document.getElementById(&quot;whiteListAbURI&quot;);</span>
<a href="#l125.7"></a><span id="l125.7">   let wListDisabled = wList.disabled;</span>
<a href="#l125.8"></a><span id="l125.8"> </span>
<a href="#l125.9"></a><span id="l125.9">   for (let i = 0; i &lt; wList.getRowCount(); i++) {</span>
<a href="#l125.10"></a><span id="l125.10">     let item = wList.getItemAtIndex(i);</span>
<a href="#l125.11"></a><span id="l125.11">     item.setAttribute(&quot;disabled&quot;, wListDisabled);</span>
<a href="#l125.12"></a><span id="l125.12" class="difflineminus">-    item.firstChild.setAttribute(&quot;disabled&quot;, wListDisabled);</span>
<a href="#l125.13"></a><span id="l125.13" class="difflineplus">+    item.firstElementChild.setAttribute(&quot;disabled&quot;, wListDisabled);</span>
<a href="#l125.14"></a><span id="l125.14">   }</span>
<a href="#l125.15"></a><span id="l125.15"> }</span>
<a href="#l125.16"></a><span id="l125.16"> </span>
<a href="#l125.17"></a><span id="l125.17"> /**</span>
<a href="#l125.18"></a><span id="l125.18">  * Called when someone checks or unchecks the &quot;move new junk messages to&quot;</span>
<a href="#l125.19"></a><span id="l125.19">  * Enable/disable the radio group accordingly.</span>
<a href="#l125.20"></a><span id="l125.20">  */</span>
<a href="#l125.21"></a><span id="l125.21"> function updateJunkTargetsAndRetention() {</span>
<a href="#l125.22"></a><span id="l125.22" class="difflineat">@@ -239,17 +239,17 @@ function onSaveWhiteList() {</span>
<a href="#l125.23"></a><span id="l125.23">   var wList = document.getElementById(&quot;whiteListAbURI&quot;);</span>
<a href="#l125.24"></a><span id="l125.24">   var wlArray = [];</span>
<a href="#l125.25"></a><span id="l125.25"> </span>
<a href="#l125.26"></a><span id="l125.26">   for (let i = 0; i &lt; wList.getRowCount(); i++) {</span>
<a href="#l125.27"></a><span id="l125.27">     // Due to bug 448582, do not trust any properties of the listitems</span>
<a href="#l125.28"></a><span id="l125.28">     // as they may not return the right value or may even not exist.</span>
<a href="#l125.29"></a><span id="l125.29">     // Always get the attributes only.</span>
<a href="#l125.30"></a><span id="l125.30">     var wlNode = wList.getItemAtIndex(i);</span>
<a href="#l125.31"></a><span id="l125.31" class="difflineminus">-    if (wlNode.firstChild.getAttribute(&quot;checked&quot;) == &quot;true&quot;) {</span>
<a href="#l125.32"></a><span id="l125.32" class="difflineplus">+    if (wlNode.firstElementChild.getAttribute(&quot;checked&quot;) == &quot;true&quot;) {</span>
<a href="#l125.33"></a><span id="l125.33">       let abURI = wlNode.getAttribute(&quot;value&quot;);</span>
<a href="#l125.34"></a><span id="l125.34">       wlArray.push(abURI);</span>
<a href="#l125.35"></a><span id="l125.35">     }</span>
<a href="#l125.36"></a><span id="l125.36">   }</span>
<a href="#l125.37"></a><span id="l125.37">   var wlValue = wlArray.join(&quot; &quot;);</span>
<a href="#l125.38"></a><span id="l125.38">   document</span>
<a href="#l125.39"></a><span id="l125.39">     .getElementById(&quot;server.whiteListAbURI&quot;)</span>
<a href="#l125.40"></a><span id="l125.40">     .setAttribute(&quot;value&quot;, wlValue);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l126.1"></a><span id="l126.1" class="difflineminus">--- a/mailnews/base/prefs/content/aw-identity.js</span>
<a href="#l126.2"></a><span id="l126.2" class="difflineplus">+++ b/mailnews/base/prefs/content/aw-identity.js</span>
<a href="#l126.3"></a><span id="l126.3" class="difflineat">@@ -88,17 +88,17 @@ function identityPageInit() {</span>
<a href="#l126.4"></a><span id="l126.4">   fixPreFilledEmail();</span>
<a href="#l126.5"></a><span id="l126.5">   identityPageValidate();</span>
<a href="#l126.6"></a><span id="l126.6"> }</span>
<a href="#l126.7"></a><span id="l126.7"> </span>
<a href="#l126.8"></a><span id="l126.8"> function clearEmailTextItems() {</span>
<a href="#l126.9"></a><span id="l126.9">   var emailDescText = document.getElementById(&quot;emailDescText&quot;);</span>
<a href="#l126.10"></a><span id="l126.10"> </span>
<a href="#l126.11"></a><span id="l126.11">   if (emailDescText.hasChildNodes()) {</span>
<a href="#l126.12"></a><span id="l126.12" class="difflineminus">-    emailDescText.firstChild.remove();</span>
<a href="#l126.13"></a><span id="l126.13" class="difflineplus">+    emailDescText.lastChild.remove();</span>
<a href="#l126.14"></a><span id="l126.14">   }</span>
<a href="#l126.15"></a><span id="l126.15"> </span>
<a href="#l126.16"></a><span id="l126.16">   var postEmailText = document.getElementById(&quot;postEmailText&quot;);</span>
<a href="#l126.17"></a><span id="l126.17">   postEmailText.setAttribute(&quot;value&quot;, &quot;&quot;);</span>
<a href="#l126.18"></a><span id="l126.18">   postEmailText.hidden = true;</span>
<a href="#l126.19"></a><span id="l126.19"> }</span>
<a href="#l126.20"></a><span id="l126.20"> </span>
<a href="#l126.21"></a><span id="l126.21"> // Use email example data that ISP has provided. ISP data, if available</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l127.1"></a><span id="l127.1" class="difflineminus">--- a/mailnews/base/prefs/content/aw-outgoing.js</span>
<a href="#l127.2"></a><span id="l127.2" class="difflineplus">+++ b/mailnews/base/prefs/content/aw-outgoing.js</span>
<a href="#l127.3"></a><span id="l127.3" class="difflineat">@@ -112,17 +112,17 @@ function outgoingPageInit() {</span>
<a href="#l127.4"></a><span id="l127.4"> }</span>
<a href="#l127.5"></a><span id="l127.5"> </span>
<a href="#l127.6"></a><span id="l127.6"> function modifyStaticText(smtpMod, smtpBox) {</span>
<a href="#l127.7"></a><span id="l127.7">   // modify the value in the smtp display if we already have a</span>
<a href="#l127.8"></a><span id="l127.8">   // smtp server so that the single string displays the hostname</span>
<a href="#l127.9"></a><span id="l127.9">   // or username for the smtp server.</span>
<a href="#l127.10"></a><span id="l127.10">   var smtpStatic = document.getElementById(&quot;smtpStaticText&quot; + smtpBox);</span>
<a href="#l127.11"></a><span id="l127.11">   if (smtpStatic &amp;&amp; smtpStatic.hasChildNodes()) {</span>
<a href="#l127.12"></a><span id="l127.12" class="difflineminus">-    smtpStatic.childNodes[0].nodeValue =</span>
<a href="#l127.13"></a><span id="l127.13" class="difflineplus">+    smtpStatic.children[0].nodeValue =</span>
<a href="#l127.14"></a><span id="l127.14">       smtpStatic.getAttribute(&quot;prefix&quot;) +</span>
<a href="#l127.15"></a><span id="l127.15">       smtpMod +</span>
<a href="#l127.16"></a><span id="l127.16">       smtpStatic.getAttribute(&quot;suffix&quot;);</span>
<a href="#l127.17"></a><span id="l127.17">   }</span>
<a href="#l127.18"></a><span id="l127.18"> }</span>
<a href="#l127.19"></a><span id="l127.19"> </span>
<a href="#l127.20"></a><span id="l127.20"> function hideShowLoginSettings(aEle, bEle, cEle) {</span>
<a href="#l127.21"></a><span id="l127.21">   document.getElementById(&quot;loginSet&quot; + aEle).hidden = false;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l128.1"></a><span id="l128.1" class="difflineminus">--- a/mailnews/base/search/content/FilterEditor.js</span>
<a href="#l128.2"></a><span id="l128.2" class="difflineplus">+++ b/mailnews/base/search/content/FilterEditor.js</span>
<a href="#l128.3"></a><span id="l128.3" class="difflineat">@@ -644,29 +644,29 @@ function _checkActionsReorder() {</span>
<a href="#l128.4"></a><span id="l128.4">  * function to make that one more lightweight. The list is built only upon</span>
<a href="#l128.5"></a><span id="l128.5">  * user request.</span>
<a href="#l128.6"></a><span id="l128.6">  */</span>
<a href="#l128.7"></a><span id="l128.7"> function showActionsOrder() {</span>
<a href="#l128.8"></a><span id="l128.8">   // Fetch the actions and arguments as a string.</span>
<a href="#l128.9"></a><span id="l128.9">   let actionStrings = [];</span>
<a href="#l128.10"></a><span id="l128.10">   for (let i = 0; i &lt; gFilterActionList.itemCount; i++) {</span>
<a href="#l128.11"></a><span id="l128.11">     let ruleAction = gFilterActionList.getItemAtIndex(i);</span>
<a href="#l128.12"></a><span id="l128.12" class="difflineminus">-    let actionTarget = ruleAction.childNodes[1];</span>
<a href="#l128.13"></a><span id="l128.13" class="difflineplus">+    let actionTarget = ruleAction.children[1];</span>
<a href="#l128.14"></a><span id="l128.14">     let actionItem = actionTarget.ruleactiontargetElement;</span>
<a href="#l128.15"></a><span id="l128.15" class="difflineminus">-    let actionItemLabel = actionItem &amp;&amp; actionItem.childNodes[0].label;</span>
<a href="#l128.16"></a><span id="l128.16" class="difflineplus">+    let actionItemLabel = actionItem &amp;&amp; actionItem.children[0].label;</span>
<a href="#l128.17"></a><span id="l128.17"> </span>
<a href="#l128.18"></a><span id="l128.18">     let actionString = {</span>
<a href="#l128.19"></a><span id="l128.19">       label: ruleAction.mRuleActionType.label,</span>
<a href="#l128.20"></a><span id="l128.20">       argument: &quot;&quot;,</span>
<a href="#l128.21"></a><span id="l128.21">     };</span>
<a href="#l128.22"></a><span id="l128.22">     if (actionItem) {</span>
<a href="#l128.23"></a><span id="l128.23">       if (actionItemLabel) {</span>
<a href="#l128.24"></a><span id="l128.24">         actionString.argument = actionItemLabel;</span>
<a href="#l128.25"></a><span id="l128.25">       } else {</span>
<a href="#l128.26"></a><span id="l128.26" class="difflineminus">-        actionString.argument = actionItem.childNodes[0].value;</span>
<a href="#l128.27"></a><span id="l128.27" class="difflineplus">+        actionString.argument = actionItem.children[0].value;</span>
<a href="#l128.28"></a><span id="l128.28">       }</span>
<a href="#l128.29"></a><span id="l128.29">     }</span>
<a href="#l128.30"></a><span id="l128.30">     actionStrings.push(actionString);</span>
<a href="#l128.31"></a><span id="l128.31">   }</span>
<a href="#l128.32"></a><span id="l128.32"> </span>
<a href="#l128.33"></a><span id="l128.33">   // Present a nicely formatted list of action names and arguments.</span>
<a href="#l128.34"></a><span id="l128.34">   let actionList = gFilterBundle.getString(&quot;filterActionOrderExplanation&quot;);</span>
<a href="#l128.35"></a><span id="l128.35">   for (let i = 0; i &lt; gActionListOrdered.length; i++) {</span>
<a href="#l128.36"></a><span id="l128.36" class="difflineat">@@ -702,17 +702,17 @@ function AssignMeaningfulName() {</span>
<a href="#l128.37"></a><span id="l128.37"> </span>
<a href="#l128.38"></a><span id="l128.38">   // If this is a Match All Messages Filter, we already know the name to assign.</span>
<a href="#l128.39"></a><span id="l128.39">   if (termRoot.matchAll) {</span>
<a href="#l128.40"></a><span id="l128.40">     stub = gFilterBundle.getString(&quot;matchAllFilterName&quot;);</span>
<a href="#l128.41"></a><span id="l128.41">   } else {</span>
<a href="#l128.42"></a><span id="l128.42">     // Assign a name based on the first search term.</span>
<a href="#l128.43"></a><span id="l128.43">     let searchValue = termRoot.searchvalue;</span>
<a href="#l128.44"></a><span id="l128.44">     let selIndex = searchValue.getAttribute(&quot;selectedIndex&quot;);</span>
<a href="#l128.45"></a><span id="l128.45" class="difflineminus">-    let children = searchValue.childNodes;</span>
<a href="#l128.46"></a><span id="l128.46" class="difflineplus">+    let children = searchValue.children;</span>
<a href="#l128.47"></a><span id="l128.47">     let activeItem = children[selIndex];</span>
<a href="#l128.48"></a><span id="l128.48">     let attribs = Ci.nsMsgSearchAttrib;</span>
<a href="#l128.49"></a><span id="l128.49"> </span>
<a href="#l128.50"></a><span id="l128.50">     // Term, Operator and Value are the three parts of a filter match</span>
<a href="#l128.51"></a><span id="l128.51">     // Term and Operator are easy to retrieve</span>
<a href="#l128.52"></a><span id="l128.52">     let term = termRoot.searchattribute.label;</span>
<a href="#l128.53"></a><span id="l128.53">     let operator = termRoot.searchoperator.label;</span>
<a href="#l128.54"></a><span id="l128.54"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l129.1"></a><span id="l129.1" class="difflineminus">--- a/mailnews/base/search/content/searchTerm.js</span>
<a href="#l129.2"></a><span id="l129.2" class="difflineplus">+++ b/mailnews/base/search/content/searchTerm.js</span>
<a href="#l129.3"></a><span id="l129.3" class="difflineat">@@ -235,17 +235,17 @@ function updateSearchTermsListbox(matchA</span>
<a href="#l129.4"></a><span id="l129.4">     updateRemoveRowButton();</span>
<a href="#l129.5"></a><span id="l129.5">   }</span>
<a href="#l129.6"></a><span id="l129.6"> }</span>
<a href="#l129.7"></a><span id="l129.7"> </span>
<a href="#l129.8"></a><span id="l129.8"> // enables/disables the less button for the first row of search terms.</span>
<a href="#l129.9"></a><span id="l129.9"> function updateRemoveRowButton() {</span>
<a href="#l129.10"></a><span id="l129.10">   var firstListItem = gSearchTermList.getItemAtIndex(0);</span>
<a href="#l129.11"></a><span id="l129.11">   if (firstListItem) {</span>
<a href="#l129.12"></a><span id="l129.12" class="difflineminus">-    firstListItem.lastChild.lastChild.setAttribute(</span>
<a href="#l129.13"></a><span id="l129.13" class="difflineplus">+    firstListItem.lastElementChild.lastElementChild.setAttribute(</span>
<a href="#l129.14"></a><span id="l129.14">       &quot;disabled&quot;,</span>
<a href="#l129.15"></a><span id="l129.15">       gTotalSearchTerms == 1</span>
<a href="#l129.16"></a><span id="l129.16">     );</span>
<a href="#l129.17"></a><span id="l129.17">   }</span>
<a href="#l129.18"></a><span id="l129.18"> }</span>
<a href="#l129.19"></a><span id="l129.19"> </span>
<a href="#l129.20"></a><span id="l129.20"> // Returns the actual list item row index in the list of search rows</span>
<a href="#l129.21"></a><span id="l129.21"> // that contains the passed in element id.</span>
<a href="#l129.22"></a><span id="l129.22" class="difflineat">@@ -451,17 +451,17 @@ function initializeTermFromIndex(index) </span>
<a href="#l129.23"></a><span id="l129.23">  * Creates a &lt;richlistitem&gt; using the array children as the children</span>
<a href="#l129.24"></a><span id="l129.24">  * of each listcell.</span>
<a href="#l129.25"></a><span id="l129.25">  * @param aChildren  An array of XUL elements to put into the listitem.</span>
<a href="#l129.26"></a><span id="l129.26">  *                   Each array member is put into a separate listcell.</span>
<a href="#l129.27"></a><span id="l129.27">  *                   If the member itself is an array of elements,</span>
<a href="#l129.28"></a><span id="l129.28">  *                   all of them are put into the same listcell.</span>
<a href="#l129.29"></a><span id="l129.29">  */</span>
<a href="#l129.30"></a><span id="l129.30"> function constructRow(aChildren) {</span>
<a href="#l129.31"></a><span id="l129.31" class="difflineminus">-  let cols = gSearchTermList.firstChild.childNodes; // treecol elements</span>
<a href="#l129.32"></a><span id="l129.32" class="difflineplus">+  let cols = gSearchTermList.firstElementChild.children; // treecol elements</span>
<a href="#l129.33"></a><span id="l129.33">   let listitem = document.createXULElement(&quot;richlistitem&quot;);</span>
<a href="#l129.34"></a><span id="l129.34">   listitem.setAttribute(&quot;allowevents&quot;, &quot;true&quot;);</span>
<a href="#l129.35"></a><span id="l129.35">   for (let i = 0; i &lt; aChildren.length; i++) {</span>
<a href="#l129.36"></a><span id="l129.36">     let listcell = document.createXULElement(&quot;hbox&quot;);</span>
<a href="#l129.37"></a><span id="l129.37">     if (cols[i].hasAttribute(&quot;flex&quot;)) {</span>
<a href="#l129.38"></a><span id="l129.38">       listcell.setAttribute(&quot;flex&quot;, cols[i].getAttribute(&quot;flex&quot;));</span>
<a href="#l129.39"></a><span id="l129.39">     }</span>
<a href="#l129.40"></a><span id="l129.40">     let child = aChildren[i];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l130.1"></a><span id="l130.1" class="difflineminus">--- a/mailnews/base/search/content/searchWidgets.js</span>
<a href="#l130.2"></a><span id="l130.2" class="difflineplus">+++ b/mailnews/base/search/content/searchWidgets.js</span>
<a href="#l130.3"></a><span id="l130.3" class="difflineat">@@ -210,18 +210,18 @@</span>
<a href="#l130.4"></a><span id="l130.4"> </span>
<a href="#l130.5"></a><span id="l130.5">     _updateAttributes() {</span>
<a href="#l130.6"></a><span id="l130.6">       if (!this.hasAttribute(&quot;type&quot;)) {</span>
<a href="#l130.7"></a><span id="l130.7">         return;</span>
<a href="#l130.8"></a><span id="l130.8">       }</span>
<a href="#l130.9"></a><span id="l130.9"> </span>
<a href="#l130.10"></a><span id="l130.10">       const type = this.getAttribute(&quot;type&quot;);</span>
<a href="#l130.11"></a><span id="l130.11"> </span>
<a href="#l130.12"></a><span id="l130.12" class="difflineminus">-      while (this.firstChild) {</span>
<a href="#l130.13"></a><span id="l130.13" class="difflineminus">-        this.firstChild.remove();</span>
<a href="#l130.14"></a><span id="l130.14" class="difflineplus">+      while (this.lastChild) {</span>
<a href="#l130.15"></a><span id="l130.15" class="difflineplus">+        this.lastChild.remove();</span>
<a href="#l130.16"></a><span id="l130.16">       }</span>
<a href="#l130.17"></a><span id="l130.17"> </span>
<a href="#l130.18"></a><span id="l130.18">       if (type == null) {</span>
<a href="#l130.19"></a><span id="l130.19">         return;</span>
<a href="#l130.20"></a><span id="l130.20">       }</span>
<a href="#l130.21"></a><span id="l130.21"> </span>
<a href="#l130.22"></a><span id="l130.22">       this.node = this._getChildNode(type);</span>
<a href="#l130.23"></a><span id="l130.23"> </span>
<a href="#l130.24"></a><span id="l130.24" class="difflineat">@@ -804,53 +804,53 @@</span>
<a href="#l130.25"></a><span id="l130.25">             &lt;hbox flex=&quot;1&quot;</span>
<a href="#l130.26"></a><span id="l130.26">                   class=&quot;search-value-custom&quot;</span>
<a href="#l130.27"></a><span id="l130.27">                   inherits=&quot;disabled&quot;&gt;&lt;/hbox&gt;</span>
<a href="#l130.28"></a><span id="l130.28">           `)</span>
<a href="#l130.29"></a><span id="l130.29">         );</span>
<a href="#l130.30"></a><span id="l130.30"> </span>
<a href="#l130.31"></a><span id="l130.31">         // Initialize the priority picker.</span>
<a href="#l130.32"></a><span id="l130.32">         this.fillStringsForChildren(</span>
<a href="#l130.33"></a><span id="l130.33" class="difflineminus">-          this.childNodes[1].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.34"></a><span id="l130.34" class="difflineplus">+          this.children[1].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.35"></a><span id="l130.35">           bundle</span>
<a href="#l130.36"></a><span id="l130.36">         );</span>
<a href="#l130.37"></a><span id="l130.37"> </span>
<a href="#l130.38"></a><span id="l130.38">         // Initialize the status picker.</span>
<a href="#l130.39"></a><span id="l130.39">         this.fillStringsForChildren(</span>
<a href="#l130.40"></a><span id="l130.40" class="difflineminus">-          this.childNodes[2].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.41"></a><span id="l130.41" class="difflineplus">+          this.children[2].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.42"></a><span id="l130.42">           bundle</span>
<a href="#l130.43"></a><span id="l130.43">         );</span>
<a href="#l130.44"></a><span id="l130.44"> </span>
<a href="#l130.45"></a><span id="l130.45">         // initialize the address book picker</span>
<a href="#l130.46"></a><span id="l130.46">         this.fillStringsForChildren(</span>
<a href="#l130.47"></a><span id="l130.47" class="difflineminus">-          this.childNodes[4].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.48"></a><span id="l130.48" class="difflineplus">+          this.children[4].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.49"></a><span id="l130.49">           bundle</span>
<a href="#l130.50"></a><span id="l130.50">         );</span>
<a href="#l130.51"></a><span id="l130.51"> </span>
<a href="#l130.52"></a><span id="l130.52">         // initialize the junk status picker</span>
<a href="#l130.53"></a><span id="l130.53">         this.fillStringsForChildren(</span>
<a href="#l130.54"></a><span id="l130.54" class="difflineminus">-          this.childNodes[6].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.55"></a><span id="l130.55" class="difflineplus">+          this.children[6].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.56"></a><span id="l130.56">           bundle</span>
<a href="#l130.57"></a><span id="l130.57">         );</span>
<a href="#l130.58"></a><span id="l130.58"> </span>
<a href="#l130.59"></a><span id="l130.59">         // initialize the has attachment status picker</span>
<a href="#l130.60"></a><span id="l130.60">         this.fillStringsForChildren(</span>
<a href="#l130.61"></a><span id="l130.61" class="difflineminus">-          this.childNodes[7].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.62"></a><span id="l130.62" class="difflineplus">+          this.children[7].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.63"></a><span id="l130.63">           bundle</span>
<a href="#l130.64"></a><span id="l130.64">         );</span>
<a href="#l130.65"></a><span id="l130.65"> </span>
<a href="#l130.66"></a><span id="l130.66">         // initialize the junk score origin picker</span>
<a href="#l130.67"></a><span id="l130.67">         this.fillStringsForChildren(</span>
<a href="#l130.68"></a><span id="l130.68" class="difflineminus">-          this.childNodes[8].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.69"></a><span id="l130.69" class="difflineplus">+          this.children[8].querySelector(&quot;menupopup&quot;),</span>
<a href="#l130.70"></a><span id="l130.70">           bundle</span>
<a href="#l130.71"></a><span id="l130.71">         );</span>
<a href="#l130.72"></a><span id="l130.72">       }</span>
<a href="#l130.73"></a><span id="l130.73"> </span>
<a href="#l130.74"></a><span id="l130.74">       // Initialize the date picker.</span>
<a href="#l130.75"></a><span id="l130.75" class="difflineminus">-      const datePicker = this.childNodes[3];</span>
<a href="#l130.76"></a><span id="l130.76" class="difflineplus">+      const datePicker = this.children[3];</span>
<a href="#l130.77"></a><span id="l130.77">       const searchAttribute = this.searchAttribute;</span>
<a href="#l130.78"></a><span id="l130.78">       const time =</span>
<a href="#l130.79"></a><span id="l130.79">         searchAttribute == Ci.nsMsgSearchAttrib.Date</span>
<a href="#l130.80"></a><span id="l130.80">           ? datePicker.value</span>
<a href="#l130.81"></a><span id="l130.81">           : new Date();</span>
<a href="#l130.82"></a><span id="l130.82"> </span>
<a href="#l130.83"></a><span id="l130.83">       // The search-value widget has two textboxes one for text, one as a placeholder for a</span>
<a href="#l130.84"></a><span id="l130.84">       // date/calendar widget.</span>
<a href="#l130.85"></a><span id="l130.85" class="difflineat">@@ -917,17 +917,17 @@</span>
<a href="#l130.86"></a><span id="l130.86">         this.searchAttribute != Ci.nsMsgSearchAttrib.ToOrCC &amp;&amp;</span>
<a href="#l130.87"></a><span id="l130.87">         this.searchAttribute != Ci.nsMsgSearchAttrib.AllAddresses &amp;&amp;</span>
<a href="#l130.88"></a><span id="l130.88">         this.searchAttribute != Ci.nsMsgSearchAttrib.CC</span>
<a href="#l130.89"></a><span id="l130.89">       ) {</span>
<a href="#l130.90"></a><span id="l130.90">         this.internalOperator = val;</span>
<a href="#l130.91"></a><span id="l130.91">         return val;</span>
<a href="#l130.92"></a><span id="l130.92">       }</span>
<a href="#l130.93"></a><span id="l130.93"> </span>
<a href="#l130.94"></a><span id="l130.94" class="difflineminus">-      const children = this.childNodes;</span>
<a href="#l130.95"></a><span id="l130.95" class="difflineplus">+      const children = this.children;</span>
<a href="#l130.96"></a><span id="l130.96">       if (val == Ci.nsMsgSearchOp.IsntInAB || val == Ci.nsMsgSearchOp.IsInAB) {</span>
<a href="#l130.97"></a><span id="l130.97">         // If the old internalOperator was IsntInAB or IsInAB, and the new internalOperator is</span>
<a href="#l130.98"></a><span id="l130.98">         // IsntInAB or IsInAB, noop because the search value was an ab type, and it still is.</span>
<a href="#l130.99"></a><span id="l130.99">         // Otherwise, switch to the ab picker and select the PAB.</span>
<a href="#l130.100"></a><span id="l130.100">         if (</span>
<a href="#l130.101"></a><span id="l130.101">           this.internalOperator != Ci.nsMsgSearchOp.IsntInAB &amp;&amp;</span>
<a href="#l130.102"></a><span id="l130.102">           this.internalOperator != Ci.nsMsgSearchOp.IsInAB</span>
<a href="#l130.103"></a><span id="l130.103">         ) {</span>
<a href="#l130.104"></a><span id="l130.104" class="difflineat">@@ -975,17 +975,17 @@</span>
<a href="#l130.105"></a><span id="l130.105"> </span>
<a href="#l130.106"></a><span id="l130.106">       // If the searchAttribute changing, null out the internalOperator.</span>
<a href="#l130.107"></a><span id="l130.107">       this.internalOperator = null;</span>
<a href="#l130.108"></a><span id="l130.108"> </span>
<a href="#l130.109"></a><span id="l130.109">       // We inherit from a deck, so just use it's index attribute to hide/show widgets.</span>
<a href="#l130.110"></a><span id="l130.110">       if (isNaN(val)) {</span>
<a href="#l130.111"></a><span id="l130.111">         // Is this a custom attribute?</span>
<a href="#l130.112"></a><span id="l130.112">         this.setAttribute(&quot;selectedIndex&quot;, &quot;10&quot;);</span>
<a href="#l130.113"></a><span id="l130.113" class="difflineminus">-        let customHbox = this.childNodes[10];</span>
<a href="#l130.114"></a><span id="l130.114" class="difflineplus">+        let customHbox = this.children[10];</span>
<a href="#l130.115"></a><span id="l130.115">         if (this.internalValue) {</span>
<a href="#l130.116"></a><span id="l130.116">           customHbox.setAttribute(&quot;value&quot;, this.internalValue.str);</span>
<a href="#l130.117"></a><span id="l130.117">         }</span>
<a href="#l130.118"></a><span id="l130.118">         // the searchAttribute attribute is intended as a selector in</span>
<a href="#l130.119"></a><span id="l130.119">         // CSS for custom search terms to bind a custom value</span>
<a href="#l130.120"></a><span id="l130.120">         customHbox.setAttribute(&quot;searchAttribute&quot;, val);</span>
<a href="#l130.121"></a><span id="l130.121">       } else if (val == Ci.nsMsgSearchAttrib.Priority) {</span>
<a href="#l130.122"></a><span id="l130.122">         this.setAttribute(&quot;selectedIndex&quot;, &quot;1&quot;);</span>
<a href="#l130.123"></a><span id="l130.123" class="difflineat">@@ -1002,27 +1002,27 @@</span>
<a href="#l130.124"></a><span id="l130.124">         this.setAttribute(&quot;selectedIndex&quot;, &quot;5&quot;);</span>
<a href="#l130.125"></a><span id="l130.125">       } else if (val == Ci.nsMsgSearchAttrib.JunkStatus) {</span>
<a href="#l130.126"></a><span id="l130.126">         this.setAttribute(&quot;selectedIndex&quot;, &quot;6&quot;);</span>
<a href="#l130.127"></a><span id="l130.127">       } else if (val == Ci.nsMsgSearchAttrib.HasAttachmentStatus) {</span>
<a href="#l130.128"></a><span id="l130.128">         this.setAttribute(&quot;selectedIndex&quot;, &quot;7&quot;);</span>
<a href="#l130.129"></a><span id="l130.129">       } else if (val == Ci.nsMsgSearchAttrib.JunkScoreOrigin) {</span>
<a href="#l130.130"></a><span id="l130.130">         this.setAttribute(&quot;selectedIndex&quot;, &quot;8&quot;);</span>
<a href="#l130.131"></a><span id="l130.131">       } else if (val == Ci.nsMsgSearchAttrib.AgeInDays) {</span>
<a href="#l130.132"></a><span id="l130.132" class="difflineminus">-        let valueBox = this.childNodes[9];</span>
<a href="#l130.133"></a><span id="l130.133" class="difflineplus">+        let valueBox = this.children[9];</span>
<a href="#l130.134"></a><span id="l130.134">         valueBox.min = -40000; // ~-100 years</span>
<a href="#l130.135"></a><span id="l130.135">         valueBox.max = 40000; // ~100 years</span>
<a href="#l130.136"></a><span id="l130.136">         this.setAttribute(&quot;selectedIndex&quot;, &quot;9&quot;);</span>
<a href="#l130.137"></a><span id="l130.137">       } else if (val == Ci.nsMsgSearchAttrib.Size) {</span>
<a href="#l130.138"></a><span id="l130.138" class="difflineminus">-        let valueBox = this.childNodes[9];</span>
<a href="#l130.139"></a><span id="l130.139" class="difflineplus">+        let valueBox = this.children[9];</span>
<a href="#l130.140"></a><span id="l130.140">         valueBox.min = 0;</span>
<a href="#l130.141"></a><span id="l130.141">         valueBox.max = 1000000000;</span>
<a href="#l130.142"></a><span id="l130.142">         this.setAttribute(&quot;selectedIndex&quot;, &quot;9&quot;);</span>
<a href="#l130.143"></a><span id="l130.143">       } else if (val == Ci.nsMsgSearchAttrib.JunkPercent) {</span>
<a href="#l130.144"></a><span id="l130.144" class="difflineminus">-        let valueBox = this.childNodes[9];</span>
<a href="#l130.145"></a><span id="l130.145" class="difflineplus">+        let valueBox = this.children[9];</span>
<a href="#l130.146"></a><span id="l130.146">         valueBox.min = 0;</span>
<a href="#l130.147"></a><span id="l130.147">         valueBox.max = 100;</span>
<a href="#l130.148"></a><span id="l130.148">         this.setAttribute(&quot;selectedIndex&quot;, &quot;9&quot;);</span>
<a href="#l130.149"></a><span id="l130.149">       } else {</span>
<a href="#l130.150"></a><span id="l130.150">         // a normal text field</span>
<a href="#l130.151"></a><span id="l130.151">         this.setAttribute(&quot;selectedIndex&quot;, &quot;0&quot;);</span>
<a href="#l130.152"></a><span id="l130.152">       }</span>
<a href="#l130.153"></a><span id="l130.153">       return val;</span>
<a href="#l130.154"></a><span id="l130.154" class="difflineat">@@ -1031,21 +1031,21 @@</span>
<a href="#l130.155"></a><span id="l130.155">     get searchAttribute() {</span>
<a href="#l130.156"></a><span id="l130.156">       return this.internalAttribute;</span>
<a href="#l130.157"></a><span id="l130.157">     }</span>
<a href="#l130.158"></a><span id="l130.158"> </span>
<a href="#l130.159"></a><span id="l130.159">     set value(val) {</span>
<a href="#l130.160"></a><span id="l130.160">       // val is a nsIMsgSearchValue object</span>
<a href="#l130.161"></a><span id="l130.161">       this.internalValue = val;</span>
<a href="#l130.162"></a><span id="l130.162">       const attrib = this.internalAttribute;</span>
<a href="#l130.163"></a><span id="l130.163" class="difflineminus">-      const children = this.childNodes;</span>
<a href="#l130.164"></a><span id="l130.164" class="difflineplus">+      const children = this.children;</span>
<a href="#l130.165"></a><span id="l130.165">       this.searchAttribute = attrib;</span>
<a href="#l130.166"></a><span id="l130.166">       if (isNaN(attrib)) {</span>
<a href="#l130.167"></a><span id="l130.167">         // a custom term</span>
<a href="#l130.168"></a><span id="l130.168" class="difflineminus">-        let customHbox = this.childNodes[10];</span>
<a href="#l130.169"></a><span id="l130.169" class="difflineplus">+        let customHbox = this.children[10];</span>
<a href="#l130.170"></a><span id="l130.170">         customHbox.setAttribute(&quot;value&quot;, val.str);</span>
<a href="#l130.171"></a><span id="l130.171">         return val;</span>
<a href="#l130.172"></a><span id="l130.172">       }</span>
<a href="#l130.173"></a><span id="l130.173">       if (attrib == Ci.nsMsgSearchAttrib.Priority) {</span>
<a href="#l130.174"></a><span id="l130.174">         const matchingPriority = children[1].querySelector(</span>
<a href="#l130.175"></a><span id="l130.175">           `[value=&quot;${val.priority}&quot;]`</span>
<a href="#l130.176"></a><span id="l130.176">         );</span>
<a href="#l130.177"></a><span id="l130.177">         if (matchingPriority) {</span>
<a href="#l130.178"></a><span id="l130.178" class="difflineat">@@ -1119,17 +1119,17 @@</span>
<a href="#l130.179"></a><span id="l130.179"> </span>
<a href="#l130.180"></a><span id="l130.180">     get value() {</span>
<a href="#l130.181"></a><span id="l130.181">       return this.internalValue;</span>
<a href="#l130.182"></a><span id="l130.182">     }</span>
<a href="#l130.183"></a><span id="l130.183"> </span>
<a href="#l130.184"></a><span id="l130.184">     save() {</span>
<a href="#l130.185"></a><span id="l130.185">       const searchValue = this.value;</span>
<a href="#l130.186"></a><span id="l130.186">       const searchAttribute = this.searchAttribute;</span>
<a href="#l130.187"></a><span id="l130.187" class="difflineminus">-      const children = this.childNodes;</span>
<a href="#l130.188"></a><span id="l130.188" class="difflineplus">+      const children = this.children;</span>
<a href="#l130.189"></a><span id="l130.189"> </span>
<a href="#l130.190"></a><span id="l130.190">       searchValue.attrib = searchAttribute;</span>
<a href="#l130.191"></a><span id="l130.191">       if (searchAttribute == Ci.nsMsgSearchAttrib.Priority) {</span>
<a href="#l130.192"></a><span id="l130.192">         searchValue.priority = children[1].selectedItem.value;</span>
<a href="#l130.193"></a><span id="l130.193">       } else if (searchAttribute == Ci.nsMsgSearchAttrib.MsgStatus) {</span>
<a href="#l130.194"></a><span id="l130.194">         searchValue.status = children[2].value;</span>
<a href="#l130.195"></a><span id="l130.195">       } else if (searchAttribute == Ci.nsMsgSearchAttrib.AgeInDays) {</span>
<a href="#l130.196"></a><span id="l130.196">         searchValue.age = children[9].value;</span>
<a href="#l130.197"></a><span id="l130.197" class="difflineat">@@ -1172,31 +1172,31 @@</span>
<a href="#l130.198"></a><span id="l130.198">     }</span>
<a href="#l130.199"></a><span id="l130.199"> </span>
<a href="#l130.200"></a><span id="l130.200">     saveTo(searchValue) {</span>
<a href="#l130.201"></a><span id="l130.201">       this.internalValue = searchValue;</span>
<a href="#l130.202"></a><span id="l130.202">       this.save();</span>
<a href="#l130.203"></a><span id="l130.203">     }</span>
<a href="#l130.204"></a><span id="l130.204"> </span>
<a href="#l130.205"></a><span id="l130.205">     fillInTags() {</span>
<a href="#l130.206"></a><span id="l130.206" class="difflineminus">-      let menulist = this.childNodes[5];</span>
<a href="#l130.207"></a><span id="l130.207" class="difflineplus">+      let menulist = this.children[5];</span>
<a href="#l130.208"></a><span id="l130.208">       // Force initialization of the menulist custom element first.</span>
<a href="#l130.209"></a><span id="l130.209">       customElements.upgrade(menulist);</span>
<a href="#l130.210"></a><span id="l130.210">       let tagArray = MailServices.tags.getAllTags();</span>
<a href="#l130.211"></a><span id="l130.211">       for (let i = 0; i &lt; tagArray.length; i++) {</span>
<a href="#l130.212"></a><span id="l130.212">         const taginfo = tagArray[i];</span>
<a href="#l130.213"></a><span id="l130.213">         const newMenuItem = menulist.appendItem(taginfo.tag, taginfo.key);</span>
<a href="#l130.214"></a><span id="l130.214">         if (i == 0) {</span>
<a href="#l130.215"></a><span id="l130.215">           menulist.selectedItem = newMenuItem;</span>
<a href="#l130.216"></a><span id="l130.216">         }</span>
<a href="#l130.217"></a><span id="l130.217">       }</span>
<a href="#l130.218"></a><span id="l130.218">     }</span>
<a href="#l130.219"></a><span id="l130.219"> </span>
<a href="#l130.220"></a><span id="l130.220">     fillStringsForChildren(parentNode, bundle) {</span>
<a href="#l130.221"></a><span id="l130.221" class="difflineminus">-      for (let node of parentNode.childNodes) {</span>
<a href="#l130.222"></a><span id="l130.222" class="difflineplus">+      for (let node of parentNode.children) {</span>
<a href="#l130.223"></a><span id="l130.223">         const stringTag = node.getAttribute(&quot;stringTag&quot;);</span>
<a href="#l130.224"></a><span id="l130.224">         if (stringTag) {</span>
<a href="#l130.225"></a><span id="l130.225">           const attr = node.tagName == &quot;label&quot; ? &quot;value&quot; : &quot;label&quot;;</span>
<a href="#l130.226"></a><span id="l130.226">           node.setAttribute(attr, bundle.GetStringFromName(stringTag));</span>
<a href="#l130.227"></a><span id="l130.227">         }</span>
<a href="#l130.228"></a><span id="l130.228">       }</span>
<a href="#l130.229"></a><span id="l130.229"> </span>
<a href="#l130.230"></a><span id="l130.230">       // Force initialization of the menulist custom element.</span>
<a href="#l130.231"></a><span id="l130.231" class="difflineat">@@ -1578,24 +1578,24 @@</span>
<a href="#l130.232"></a><span id="l130.232">     clearInitialActionIndex() {</span>
<a href="#l130.233"></a><span id="l130.233">       if (this.mActionTypeInitialized &amp;&amp; this.mRuleActionTargetInitialized) {</span>
<a href="#l130.234"></a><span id="l130.234">         this.removeAttribute(&quot;initialActionIndex&quot;);</span>
<a href="#l130.235"></a><span id="l130.235">       }</span>
<a href="#l130.236"></a><span id="l130.236">     }</span>
<a href="#l130.237"></a><span id="l130.237"> </span>
<a href="#l130.238"></a><span id="l130.238">     initWithAction(aFilterAction) {</span>
<a href="#l130.239"></a><span id="l130.239">       let filterActionStr;</span>
<a href="#l130.240"></a><span id="l130.240" class="difflineminus">-      let actionTarget = this.childNodes[1];</span>
<a href="#l130.241"></a><span id="l130.241" class="difflineplus">+      let actionTarget = this.children[1];</span>
<a href="#l130.242"></a><span id="l130.242">       let actionItem = actionTarget.ruleactiontargetElement;</span>
<a href="#l130.243"></a><span id="l130.243">       let nsMsgFilterAction = Ci.nsMsgFilterAction;</span>
<a href="#l130.244"></a><span id="l130.244">       switch (aFilterAction.type) {</span>
<a href="#l130.245"></a><span id="l130.245">         case nsMsgFilterAction.Custom:</span>
<a href="#l130.246"></a><span id="l130.246">           filterActionStr = aFilterAction.customId;</span>
<a href="#l130.247"></a><span id="l130.247">           if (actionItem) {</span>
<a href="#l130.248"></a><span id="l130.248" class="difflineminus">-            actionItem.childNodes[0].value = aFilterAction.strValue;</span>
<a href="#l130.249"></a><span id="l130.249" class="difflineplus">+            actionItem.children[0].value = aFilterAction.strValue;</span>
<a href="#l130.250"></a><span id="l130.250">           }</span>
<a href="#l130.251"></a><span id="l130.251"> </span>
<a href="#l130.252"></a><span id="l130.252">           // Make sure the custom action has been added. If not, it</span>
<a href="#l130.253"></a><span id="l130.253">           // probably was from an extension that has been removed. We'll</span>
<a href="#l130.254"></a><span id="l130.254">           // show a dummy menuitem to warn the user.</span>
<a href="#l130.255"></a><span id="l130.255">           let needCustomLabel = true;</span>
<a href="#l130.256"></a><span id="l130.256">           for (let i = 0; i &lt; gCustomActions.length; i++) {</span>
<a href="#l130.257"></a><span id="l130.257">             if (gCustomActions[i].id == filterActionStr) {</span>
<a href="#l130.258"></a><span id="l130.258" class="difflineat">@@ -1624,33 +1624,33 @@</span>
<a href="#l130.259"></a><span id="l130.259">               Ci.nsIScriptError.errorFlag,</span>
<a href="#l130.260"></a><span id="l130.260">               &quot;component javascript&quot;</span>
<a href="#l130.261"></a><span id="l130.261">             );</span>
<a href="#l130.262"></a><span id="l130.262">             Services.console.logMessage(scriptError);</span>
<a href="#l130.263"></a><span id="l130.263">           }</span>
<a href="#l130.264"></a><span id="l130.264">           break;</span>
<a href="#l130.265"></a><span id="l130.265">         case nsMsgFilterAction.MoveToFolder:</span>
<a href="#l130.266"></a><span id="l130.266">         case nsMsgFilterAction.CopyToFolder:</span>
<a href="#l130.267"></a><span id="l130.267" class="difflineminus">-          actionItem.childNodes[0].value = aFilterAction.targetFolderUri;</span>
<a href="#l130.268"></a><span id="l130.268" class="difflineplus">+          actionItem.children[0].value = aFilterAction.targetFolderUri;</span>
<a href="#l130.269"></a><span id="l130.269">           break;</span>
<a href="#l130.270"></a><span id="l130.270">         case nsMsgFilterAction.Reply:</span>
<a href="#l130.271"></a><span id="l130.271">         case nsMsgFilterAction.Forward:</span>
<a href="#l130.272"></a><span id="l130.272" class="difflineminus">-          actionItem.childNodes[0].value = aFilterAction.strValue;</span>
<a href="#l130.273"></a><span id="l130.273" class="difflineplus">+          actionItem.children[0].value = aFilterAction.strValue;</span>
<a href="#l130.274"></a><span id="l130.274">           break;</span>
<a href="#l130.275"></a><span id="l130.275">         case nsMsgFilterAction.Label:</span>
<a href="#l130.276"></a><span id="l130.276" class="difflineminus">-          actionItem.childNodes[0].value = aFilterAction.label;</span>
<a href="#l130.277"></a><span id="l130.277" class="difflineplus">+          actionItem.children[0].value = aFilterAction.label;</span>
<a href="#l130.278"></a><span id="l130.278">           break;</span>
<a href="#l130.279"></a><span id="l130.279">         case nsMsgFilterAction.ChangePriority:</span>
<a href="#l130.280"></a><span id="l130.280" class="difflineminus">-          actionItem.childNodes[0].value = aFilterAction.priority;</span>
<a href="#l130.281"></a><span id="l130.281" class="difflineplus">+          actionItem.children[0].value = aFilterAction.priority;</span>
<a href="#l130.282"></a><span id="l130.282">           break;</span>
<a href="#l130.283"></a><span id="l130.283">         case nsMsgFilterAction.JunkScore:</span>
<a href="#l130.284"></a><span id="l130.284" class="difflineminus">-          actionItem.childNodes[0].value = aFilterAction.junkScore;</span>
<a href="#l130.285"></a><span id="l130.285" class="difflineplus">+          actionItem.children[0].value = aFilterAction.junkScore;</span>
<a href="#l130.286"></a><span id="l130.286">           break;</span>
<a href="#l130.287"></a><span id="l130.287">         case nsMsgFilterAction.AddTag:</span>
<a href="#l130.288"></a><span id="l130.288" class="difflineminus">-          actionItem.childNodes[0].value = aFilterAction.strValue;</span>
<a href="#l130.289"></a><span id="l130.289" class="difflineplus">+          actionItem.children[0].value = aFilterAction.strValue;</span>
<a href="#l130.290"></a><span id="l130.290">           break;</span>
<a href="#l130.291"></a><span id="l130.291">         default:</span>
<a href="#l130.292"></a><span id="l130.292">           break;</span>
<a href="#l130.293"></a><span id="l130.293">       }</span>
<a href="#l130.294"></a><span id="l130.294">       if (aFilterAction.type != nsMsgFilterAction.Custom) {</span>
<a href="#l130.295"></a><span id="l130.295">         filterActionStr = gFilterActionStrings[aFilterAction.type];</span>
<a href="#l130.296"></a><span id="l130.296">       }</span>
<a href="#l130.297"></a><span id="l130.297">       this.mRuleActionType.value = filterActionStr;</span>
<a href="#l130.298"></a><span id="l130.298" class="difflineat">@@ -1662,20 +1662,20 @@</span>
<a href="#l130.299"></a><span id="l130.299">     /**</span>
<a href="#l130.300"></a><span id="l130.300">      * Function is used to check if the filter is valid or not. This routine</span>
<a href="#l130.301"></a><span id="l130.301">      * also prompts the user.</span>
<a href="#l130.302"></a><span id="l130.302">      *</span>
<a href="#l130.303"></a><span id="l130.303">      * @return {boolean} - true if this row represents a valid filter action.</span>
<a href="#l130.304"></a><span id="l130.304">      */</span>
<a href="#l130.305"></a><span id="l130.305">     validateAction() {</span>
<a href="#l130.306"></a><span id="l130.306">       let filterActionString = this.getAttribute(&quot;value&quot;);</span>
<a href="#l130.307"></a><span id="l130.307" class="difflineminus">-      let actionTarget = this.childNodes[1];</span>
<a href="#l130.308"></a><span id="l130.308" class="difflineplus">+      let actionTarget = this.children[1];</span>
<a href="#l130.309"></a><span id="l130.309">       let actionTargetLabel =</span>
<a href="#l130.310"></a><span id="l130.310">         actionTarget.ruleactiontargetElement &amp;&amp;</span>
<a href="#l130.311"></a><span id="l130.311" class="difflineminus">-        actionTarget.ruleactiontargetElement.childNodes[0].value;</span>
<a href="#l130.312"></a><span id="l130.312" class="difflineplus">+        actionTarget.ruleactiontargetElement.children[0].value;</span>
<a href="#l130.313"></a><span id="l130.313">       let errorString, customError;</span>
<a href="#l130.314"></a><span id="l130.314"> </span>
<a href="#l130.315"></a><span id="l130.315">       switch (filterActionString) {</span>
<a href="#l130.316"></a><span id="l130.316">         case &quot;movemessage&quot;:</span>
<a href="#l130.317"></a><span id="l130.317">         case &quot;copymessage&quot;:</span>
<a href="#l130.318"></a><span id="l130.318">           let msgFolder = actionTargetLabel</span>
<a href="#l130.319"></a><span id="l130.319">             ? MailUtils.getOrCreateFolder(actionTargetLabel)</span>
<a href="#l130.320"></a><span id="l130.320">             : null;</span>
<a href="#l130.321"></a><span id="l130.321" class="difflineat">@@ -1687,19 +1687,17 @@</span>
<a href="#l130.322"></a><span id="l130.322">           if (</span>
<a href="#l130.323"></a><span id="l130.323">             actionTargetLabel.length &lt; 3 ||</span>
<a href="#l130.324"></a><span id="l130.324">             actionTargetLabel.indexOf(&quot;@&quot;) &lt; 1</span>
<a href="#l130.325"></a><span id="l130.325">           ) {</span>
<a href="#l130.326"></a><span id="l130.326">             errorString = &quot;enterValidEmailAddress&quot;;</span>
<a href="#l130.327"></a><span id="l130.327">           }</span>
<a href="#l130.328"></a><span id="l130.328">           break;</span>
<a href="#l130.329"></a><span id="l130.329">         case &quot;replytomessage&quot;:</span>
<a href="#l130.330"></a><span id="l130.330" class="difflineminus">-          if (</span>
<a href="#l130.331"></a><span id="l130.331" class="difflineminus">-            !actionTarget.ruleactiontargetElement.childNodes[0].selectedItem</span>
<a href="#l130.332"></a><span id="l130.332" class="difflineminus">-          ) {</span>
<a href="#l130.333"></a><span id="l130.333" class="difflineplus">+          if (!actionTarget.ruleactiontargetElement.children[0].selectedItem) {</span>
<a href="#l130.334"></a><span id="l130.334">             errorString = &quot;pickTemplateToReplyWith&quot;;</span>
<a href="#l130.335"></a><span id="l130.335">           }</span>
<a href="#l130.336"></a><span id="l130.336">           break;</span>
<a href="#l130.337"></a><span id="l130.337">         default:</span>
<a href="#l130.338"></a><span id="l130.338">           // Locate the correct custom action, and check validity.</span>
<a href="#l130.339"></a><span id="l130.339">           for (let i = 0; i &lt; gCustomActions.length; i++) {</span>
<a href="#l130.340"></a><span id="l130.340">             if (gCustomActions[i].id == filterActionString) {</span>
<a href="#l130.341"></a><span id="l130.341">               customError = gCustomActions[i].validateActionValue(</span>
<a href="#l130.342"></a><span id="l130.342" class="difflineat">@@ -1727,41 +1725,39 @@</span>
<a href="#l130.343"></a><span id="l130.343">      * Create a new filter action, fill it in, and then append it to the filter.</span>
<a href="#l130.344"></a><span id="l130.344">      *</span>
<a href="#l130.345"></a><span id="l130.345">      * @param {Object} aFilter - filter object to save.</span>
<a href="#l130.346"></a><span id="l130.346">      */</span>
<a href="#l130.347"></a><span id="l130.347">     saveToFilter(aFilter) {</span>
<a href="#l130.348"></a><span id="l130.348">       let filterAction = aFilter.createAction();</span>
<a href="#l130.349"></a><span id="l130.349">       let filterActionString = this.getAttribute(&quot;value&quot;);</span>
<a href="#l130.350"></a><span id="l130.350">       filterAction.type = gFilterActionStrings.indexOf(filterActionString);</span>
<a href="#l130.351"></a><span id="l130.351" class="difflineminus">-      let actionTarget = this.childNodes[1];</span>
<a href="#l130.352"></a><span id="l130.352" class="difflineplus">+      let actionTarget = this.children[1];</span>
<a href="#l130.353"></a><span id="l130.353">       let actionItem = actionTarget.ruleactiontargetElement;</span>
<a href="#l130.354"></a><span id="l130.354">       let nsMsgFilterAction = Ci.nsMsgFilterAction;</span>
<a href="#l130.355"></a><span id="l130.355">       switch (filterAction.type) {</span>
<a href="#l130.356"></a><span id="l130.356">         case nsMsgFilterAction.Label:</span>
<a href="#l130.357"></a><span id="l130.357" class="difflineminus">-          filterAction.label = actionItem.childNodes[0].getAttribute(&quot;value&quot;);</span>
<a href="#l130.358"></a><span id="l130.358" class="difflineplus">+          filterAction.label = actionItem.children[0].getAttribute(&quot;value&quot;);</span>
<a href="#l130.359"></a><span id="l130.359">           break;</span>
<a href="#l130.360"></a><span id="l130.360">         case nsMsgFilterAction.ChangePriority:</span>
<a href="#l130.361"></a><span id="l130.361" class="difflineminus">-          filterAction.priority = actionItem.childNodes[0].getAttribute(</span>
<a href="#l130.362"></a><span id="l130.362" class="difflineminus">-            &quot;value&quot;</span>
<a href="#l130.363"></a><span id="l130.363" class="difflineminus">-          );</span>
<a href="#l130.364"></a><span id="l130.364" class="difflineplus">+          filterAction.priority = actionItem.children[0].getAttribute(&quot;value&quot;);</span>
<a href="#l130.365"></a><span id="l130.365">           break;</span>
<a href="#l130.366"></a><span id="l130.366">         case nsMsgFilterAction.MoveToFolder:</span>
<a href="#l130.367"></a><span id="l130.367">         case nsMsgFilterAction.CopyToFolder:</span>
<a href="#l130.368"></a><span id="l130.368" class="difflineminus">-          filterAction.targetFolderUri = actionItem.childNodes[0].value;</span>
<a href="#l130.369"></a><span id="l130.369" class="difflineplus">+          filterAction.targetFolderUri = actionItem.children[0].value;</span>
<a href="#l130.370"></a><span id="l130.370">           break;</span>
<a href="#l130.371"></a><span id="l130.371">         case nsMsgFilterAction.JunkScore:</span>
<a href="#l130.372"></a><span id="l130.372" class="difflineminus">-          filterAction.junkScore = actionItem.childNodes[0].value;</span>
<a href="#l130.373"></a><span id="l130.373" class="difflineplus">+          filterAction.junkScore = actionItem.children[0].value;</span>
<a href="#l130.374"></a><span id="l130.374">           break;</span>
<a href="#l130.375"></a><span id="l130.375">         case nsMsgFilterAction.Custom:</span>
<a href="#l130.376"></a><span id="l130.376">           filterAction.customId = filterActionString;</span>
<a href="#l130.377"></a><span id="l130.377">         // Fall through to set the value.</span>
<a href="#l130.378"></a><span id="l130.378">         default:</span>
<a href="#l130.379"></a><span id="l130.379" class="difflineminus">-          if (actionItem &amp;&amp; actionItem.childNodes.length &gt; 0) {</span>
<a href="#l130.380"></a><span id="l130.380" class="difflineminus">-            filterAction.strValue = actionItem.childNodes[0].value;</span>
<a href="#l130.381"></a><span id="l130.381" class="difflineplus">+          if (actionItem &amp;&amp; actionItem.children.length &gt; 0) {</span>
<a href="#l130.382"></a><span id="l130.382" class="difflineplus">+            filterAction.strValue = actionItem.children[0].value;</span>
<a href="#l130.383"></a><span id="l130.383">           }</span>
<a href="#l130.384"></a><span id="l130.384">           break;</span>
<a href="#l130.385"></a><span id="l130.385">       }</span>
<a href="#l130.386"></a><span id="l130.386">       aFilter.appendAction(filterAction);</span>
<a href="#l130.387"></a><span id="l130.387">     }</span>
<a href="#l130.388"></a><span id="l130.388"> </span>
<a href="#l130.389"></a><span id="l130.389">     /**</span>
<a href="#l130.390"></a><span id="l130.390">      * If we only have one row of actions, then disable the remove button for that row.</span>
<a href="#l130.391"></a><span id="l130.391" class="difflineat">@@ -1772,17 +1768,17 @@</span>
<a href="#l130.392"></a><span id="l130.392">     }</span>
<a href="#l130.393"></a><span id="l130.393"> </span>
<a href="#l130.394"></a><span id="l130.394">     addRow() {</span>
<a href="#l130.395"></a><span id="l130.395">       let listItem = document.createXULElement(&quot;richlistitem&quot;, {</span>
<a href="#l130.396"></a><span id="l130.396">         is: &quot;ruleaction-richlistitem&quot;,</span>
<a href="#l130.397"></a><span id="l130.397">       });</span>
<a href="#l130.398"></a><span id="l130.398">       listItem.classList.add(&quot;ruleaction&quot;);</span>
<a href="#l130.399"></a><span id="l130.399">       listItem.setAttribute(&quot;onfocus&quot;, &quot;this.storeFocus();&quot;);</span>
<a href="#l130.400"></a><span id="l130.400" class="difflineminus">-      this.mListBox.insertBefore(listItem, this.nextSibling);</span>
<a href="#l130.401"></a><span id="l130.401" class="difflineplus">+      this.mListBox.insertBefore(listItem, this.nextElementSibling);</span>
<a href="#l130.402"></a><span id="l130.402">       this.mListBox.ensureElementIsVisible(listItem);</span>
<a href="#l130.403"></a><span id="l130.403"> </span>
<a href="#l130.404"></a><span id="l130.404">       // Make sure the first remove button is enabled.</span>
<a href="#l130.405"></a><span id="l130.405">       this.updateRemoveButton();</span>
<a href="#l130.406"></a><span id="l130.406">       checkActionsReorder();</span>
<a href="#l130.407"></a><span id="l130.407">     }</span>
<a href="#l130.408"></a><span id="l130.408"> </span>
<a href="#l130.409"></a><span id="l130.409">     removeRow() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l131.1"></a><span id="l131.1" class="difflineminus">--- a/mailnews/base/test/unit/test_iteratorUtils.js</span>
<a href="#l131.2"></a><span id="l131.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_iteratorUtils.js</span>
<a href="#l131.3"></a><span id="l131.3" class="difflineat">@@ -133,25 +133,25 @@ function test_fixIterator() {</span>
<a href="#l131.4"></a><span id="l131.4">   Assert.ok(thrown);</span>
<a href="#l131.5"></a><span id="l131.5"> }</span>
<a href="#l131.6"></a><span id="l131.6"> </span>
<a href="#l131.7"></a><span id="l131.7"> /**</span>
<a href="#l131.8"></a><span id="l131.8">  * Test that toArray works correctly with a NodeList.</span>
<a href="#l131.9"></a><span id="l131.9">  */</span>
<a href="#l131.10"></a><span id="l131.10"> function test_toArray_NodeList() {</span>
<a href="#l131.11"></a><span id="l131.11">   let xml = parse_xml_file(&quot;nodelist_test.xml&quot;);</span>
<a href="#l131.12"></a><span id="l131.12" class="difflineminus">-  let rootNode = xml.firstChild;</span>
<a href="#l131.13"></a><span id="l131.13" class="difflineplus">+  let rootNode = xml.firstElementChild;</span>
<a href="#l131.14"></a><span id="l131.14">   // Sanity check -- rootNode should have tag &quot;rootnode&quot;</span>
<a href="#l131.15"></a><span id="l131.15">   Assert.equal(rootNode.tagName, &quot;rootnode&quot;);</span>
<a href="#l131.16"></a><span id="l131.16" class="difflineminus">-  // childNodes is a NodeList</span>
<a href="#l131.17"></a><span id="l131.17" class="difflineminus">-  let childNodes = rootNode.childNodes;</span>
<a href="#l131.18"></a><span id="l131.18" class="difflineplus">+  // children is a NodeList</span>
<a href="#l131.19"></a><span id="l131.19" class="difflineplus">+  let children = rootNode.children;</span>
<a href="#l131.20"></a><span id="l131.20">   // Make sure we have at least one child node</span>
<a href="#l131.21"></a><span id="l131.21" class="difflineminus">-  Assert.ok(childNodes.length &gt; 0);</span>
<a href="#l131.22"></a><span id="l131.22" class="difflineminus">-  let childArray = iteratorUtils.toArray(childNodes);</span>
<a href="#l131.23"></a><span id="l131.23" class="difflineminus">-  Assert.equal(childNodes.length, childArray.length);</span>
<a href="#l131.24"></a><span id="l131.24" class="difflineplus">+  Assert.ok(children.length &gt; 0);</span>
<a href="#l131.25"></a><span id="l131.25" class="difflineplus">+  let childArray = iteratorUtils.toArray(children);</span>
<a href="#l131.26"></a><span id="l131.26" class="difflineplus">+  Assert.equal(children.length, childArray.length);</span>
<a href="#l131.27"></a><span id="l131.27">   for (let [i, node] of childArray.entries()) {</span>
<a href="#l131.28"></a><span id="l131.28">     Assert.equal(node, childArray[i]);</span>
<a href="#l131.29"></a><span id="l131.29">   }</span>
<a href="#l131.30"></a><span id="l131.30"> }</span>
<a href="#l131.31"></a><span id="l131.31"> </span>
<a href="#l131.32"></a><span id="l131.32"> /**</span>
<a href="#l131.33"></a><span id="l131.33">  * Test that toArray works correctly with the built-in generator construct.</span>
<a href="#l131.34"></a><span id="l131.34">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l132.1"></a><span id="l132.1" class="difflineminus">--- a/mailnews/base/util/iteratorUtils.jsm</span>
<a href="#l132.2"></a><span id="l132.2" class="difflineplus">+++ b/mailnews/base/util/iteratorUtils.jsm</span>
<a href="#l132.3"></a><span id="l132.3" class="difflineat">@@ -13,17 +13,17 @@ var JS_HAS_SYMBOLS = typeof Symbol === &quot;</span>
<a href="#l132.4"></a><span id="l132.4"> var ITERATOR_SYMBOL = JS_HAS_SYMBOLS ? Symbol.iterator : &quot;@@iterator&quot;;</span>
<a href="#l132.5"></a><span id="l132.5"> </span>
<a href="#l132.6"></a><span id="l132.6"> /**</span>
<a href="#l132.7"></a><span id="l132.7">  * This function will take a number of objects and convert them to an array.</span>
<a href="#l132.8"></a><span id="l132.8">  *</span>
<a href="#l132.9"></a><span id="l132.9">  * Currently, we support the following objects:</span>
<a href="#l132.10"></a><span id="l132.10">  *   Anything you can for (let x of aObj) on</span>
<a href="#l132.11"></a><span id="l132.11">  *                (e.g. toArray(fixIterator(enum))[4],</span>
<a href="#l132.12"></a><span id="l132.12" class="difflineminus">- *                 also a NodeList from element.childNodes)</span>
<a href="#l132.13"></a><span id="l132.13" class="difflineplus">+ *                 also a NodeList from element.children)</span>
<a href="#l132.14"></a><span id="l132.14">  *</span>
<a href="#l132.15"></a><span id="l132.15">  * @param aObj        The object to convert</span>
<a href="#l132.16"></a><span id="l132.16">  */</span>
<a href="#l132.17"></a><span id="l132.17"> function toArray(aObj) {</span>
<a href="#l132.18"></a><span id="l132.18">   // Iterable object</span>
<a href="#l132.19"></a><span id="l132.19">   if (ITERATOR_SYMBOL in aObj) {</span>
<a href="#l132.20"></a><span id="l132.20">     return Array.from(aObj);</span>
<a href="#l132.21"></a><span id="l132.21">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l133.1"></a><span id="l133.1" class="difflineminus">--- a/mailnews/db/gloda/content/autocomplete-richlistitem.js</span>
<a href="#l133.2"></a><span id="l133.2" class="difflineplus">+++ b/mailnews/db/gloda/content/autocomplete-richlistitem.js</span>
<a href="#l133.3"></a><span id="l133.3" class="difflineat">@@ -164,17 +164,17 @@</span>
<a href="#l133.4"></a><span id="l133.4">     }</span>
<a href="#l133.5"></a><span id="l133.5"> </span>
<a href="#l133.6"></a><span id="l133.6">     _setUpOverflow(aParentBox, aEllipsis) {</span>
<a href="#l133.7"></a><span id="l133.7">       // Hide the ellipsis in case there's just enough to not underflow.</span>
<a href="#l133.8"></a><span id="l133.8">       aEllipsis.hidden = true;</span>
<a href="#l133.9"></a><span id="l133.9"> </span>
<a href="#l133.10"></a><span id="l133.10">       // Start with the parent's width and subtract off its children.</span>
<a href="#l133.11"></a><span id="l133.11">       let tooltip = [];</span>
<a href="#l133.12"></a><span id="l133.12" class="difflineminus">-      let children = aParentBox.childNodes;</span>
<a href="#l133.13"></a><span id="l133.13" class="difflineplus">+      let children = aParentBox.children;</span>
<a href="#l133.14"></a><span id="l133.14">       let widthDiff = aParentBox.getBoundingClientRect().width;</span>
<a href="#l133.15"></a><span id="l133.15"> </span>
<a href="#l133.16"></a><span id="l133.16">       for (let i = 0; i &lt; children.length; i++) {</span>
<a href="#l133.17"></a><span id="l133.17">         // Only consider a child if it actually takes up space.</span>
<a href="#l133.18"></a><span id="l133.18">         let childWidth = children[i].getBoundingClientRect().width;</span>
<a href="#l133.19"></a><span id="l133.19">         if (childWidth &gt; 0) {</span>
<a href="#l133.20"></a><span id="l133.20">           // Subtract a little less to account for subpixel rounding.</span>
<a href="#l133.21"></a><span id="l133.21">           widthDiff -= childWidth - 0.5;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l134.1"></a><span id="l134.1" class="difflineminus">--- a/mailnews/extensions/smime/content/msgReadSecurityInfo.js</span>
<a href="#l134.2"></a><span id="l134.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/msgReadSecurityInfo.js</span>
<a href="#l134.3"></a><span id="l134.3" class="difflineat">@@ -18,17 +18,17 @@ var gSignatureStatus = -1;</span>
<a href="#l134.4"></a><span id="l134.4"> var gEncryptionStatus = -1;</span>
<a href="#l134.5"></a><span id="l134.5"> </span>
<a href="#l134.6"></a><span id="l134.6"> function setText(id, value) {</span>
<a href="#l134.7"></a><span id="l134.7">   var element = document.getElementById(id);</span>
<a href="#l134.8"></a><span id="l134.8">   if (!element) {</span>
<a href="#l134.9"></a><span id="l134.9">     return;</span>
<a href="#l134.10"></a><span id="l134.10">   }</span>
<a href="#l134.11"></a><span id="l134.11">   if (element.hasChildNodes()) {</span>
<a href="#l134.12"></a><span id="l134.12" class="difflineminus">-    element.firstChild.remove();</span>
<a href="#l134.13"></a><span id="l134.13" class="difflineplus">+    element.firstElementChild.remove();</span>
<a href="#l134.14"></a><span id="l134.14">   }</span>
<a href="#l134.15"></a><span id="l134.15">   var textNode = document.createTextNode(value);</span>
<a href="#l134.16"></a><span id="l134.16">   element.appendChild(textNode);</span>
<a href="#l134.17"></a><span id="l134.17"> }</span>
<a href="#l134.18"></a><span id="l134.18"> </span>
<a href="#l134.19"></a><span id="l134.19"> /* eslint-disable complexity */</span>
<a href="#l134.20"></a><span id="l134.20"> function onLoad() {</span>
<a href="#l134.21"></a><span id="l134.21">   var paramBlock = window.arguments[0].QueryInterface(nsIDialogParamBlock);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l135.1"></a><span id="l135.1" class="difflineminus">--- a/mailnews/import/content/fieldMapImport.js</span>
<a href="#l135.2"></a><span id="l135.2" class="difflineplus">+++ b/mailnews/import/content/fieldMapImport.js</span>
<a href="#l135.3"></a><span id="l135.3" class="difflineat">@@ -120,41 +120,44 @@ function AddFieldToList(name, index, on)</span>
<a href="#l135.4"></a><span id="l135.4"> // The &quot;Move Up/Move Down&quot; buttons should move the items in the left column</span>
<a href="#l135.5"></a><span id="l135.5"> // up/down but the values in the right column should not change.</span>
<a href="#l135.6"></a><span id="l135.6"> function moveItem(up) {</span>
<a href="#l135.7"></a><span id="l135.7">   var selectedItem = gListbox.selectedItem;</span>
<a href="#l135.8"></a><span id="l135.8">   var swapPartner = up</span>
<a href="#l135.9"></a><span id="l135.9">     ? gListbox.getPreviousItem(selectedItem, 1)</span>
<a href="#l135.10"></a><span id="l135.10">     : gListbox.getNextItem(selectedItem, 1);</span>
<a href="#l135.11"></a><span id="l135.11"> </span>
<a href="#l135.12"></a><span id="l135.12" class="difflineminus">-  var tmpLabel = swapPartner.lastChild.getAttribute(&quot;value&quot;);</span>
<a href="#l135.13"></a><span id="l135.13" class="difflineminus">-  swapPartner.lastChild.setAttribute(</span>
<a href="#l135.14"></a><span id="l135.14" class="difflineplus">+  var tmpLabel = swapPartner.lastElementChild.getAttribute(&quot;value&quot;);</span>
<a href="#l135.15"></a><span id="l135.15" class="difflineplus">+  swapPartner.lastElementChild.setAttribute(</span>
<a href="#l135.16"></a><span id="l135.16">     &quot;value&quot;,</span>
<a href="#l135.17"></a><span id="l135.17" class="difflineminus">-    selectedItem.lastChild.getAttribute(&quot;value&quot;)</span>
<a href="#l135.18"></a><span id="l135.18" class="difflineplus">+    selectedItem.lastElementChild.getAttribute(&quot;value&quot;)</span>
<a href="#l135.19"></a><span id="l135.19">   );</span>
<a href="#l135.20"></a><span id="l135.20" class="difflineminus">-  selectedItem.lastChild.setAttribute(&quot;value&quot;, tmpLabel);</span>
<a href="#l135.21"></a><span id="l135.21" class="difflineplus">+  selectedItem.lastElementChild.setAttribute(&quot;value&quot;, tmpLabel);</span>
<a href="#l135.22"></a><span id="l135.22"> </span>
<a href="#l135.23"></a><span id="l135.23" class="difflineminus">-  var newItemPosition = up ? selectedItem.nextSibling : selectedItem;</span>
<a href="#l135.24"></a><span id="l135.24" class="difflineplus">+  var newItemPosition = up ? selectedItem.nextElementSibling : selectedItem;</span>
<a href="#l135.25"></a><span id="l135.25">   gListbox.insertBefore(swapPartner, newItemPosition);</span>
<a href="#l135.26"></a><span id="l135.26">   gListbox.ensureElementIsVisible(selectedItem);</span>
<a href="#l135.27"></a><span id="l135.27">   disableMoveButtons();</span>
<a href="#l135.28"></a><span id="l135.28"> }</span>
<a href="#l135.29"></a><span id="l135.29"> </span>
<a href="#l135.30"></a><span id="l135.30"> function disableMoveButtons() {</span>
<a href="#l135.31"></a><span id="l135.31">   var selectedIndex = gListbox.selectedIndex;</span>
<a href="#l135.32"></a><span id="l135.32">   gMoveUpButton.disabled = selectedIndex == 0;</span>
<a href="#l135.33"></a><span id="l135.33">   gMoveDownButton.disabled = selectedIndex == gListbox.getRowCount() - 1;</span>
<a href="#l135.34"></a><span id="l135.34"> }</span>
<a href="#l135.35"></a><span id="l135.35"> </span>
<a href="#l135.36"></a><span id="l135.36"> function ShowSampleData(data) {</span>
<a href="#l135.37"></a><span id="l135.37">   var fields = data.split(&quot;\n&quot;);</span>
<a href="#l135.38"></a><span id="l135.38">   for (var i = 0; i &lt; gListbox.getRowCount(); i++) {</span>
<a href="#l135.39"></a><span id="l135.39">     gListbox</span>
<a href="#l135.40"></a><span id="l135.40">       .getItemAtIndex(i)</span>
<a href="#l135.41"></a><span id="l135.41" class="difflineminus">-      .lastChild.setAttribute(&quot;value&quot;, i &lt; fields.length ? fields[i] : &quot;&quot;);</span>
<a href="#l135.42"></a><span id="l135.42" class="difflineplus">+      .lastElementChild.setAttribute(</span>
<a href="#l135.43"></a><span id="l135.43" class="difflineplus">+        &quot;value&quot;,</span>
<a href="#l135.44"></a><span id="l135.44" class="difflineplus">+        i &lt; fields.length ? fields[i] : &quot;&quot;</span>
<a href="#l135.45"></a><span id="l135.45" class="difflineplus">+      );</span>
<a href="#l135.46"></a><span id="l135.46">   }</span>
<a href="#l135.47"></a><span id="l135.47"> }</span>
<a href="#l135.48"></a><span id="l135.48"> </span>
<a href="#l135.49"></a><span id="l135.49"> function FetchSampleData(num) {</span>
<a href="#l135.50"></a><span id="l135.50">   if (!top.addInterface) {</span>
<a href="#l135.51"></a><span id="l135.51">     return false;</span>
<a href="#l135.52"></a><span id="l135.52">   }</span>
<a href="#l135.53"></a><span id="l135.53"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l136.1"></a><span id="l136.1" class="difflineminus">--- a/mailnews/import/content/importDialog.js</span>
<a href="#l136.2"></a><span id="l136.2" class="difflineplus">+++ b/mailnews/import/content/importDialog.js</span>
<a href="#l136.3"></a><span id="l136.3" class="difflineat">@@ -102,17 +102,17 @@ function SetUpImportType() {</span>
<a href="#l136.4"></a><span id="l136.4"> function SetDivText(id, text) {</span>
<a href="#l136.5"></a><span id="l136.5">   var div = document.getElementById(id);</span>
<a href="#l136.6"></a><span id="l136.6"> </span>
<a href="#l136.7"></a><span id="l136.7">   if (div) {</span>
<a href="#l136.8"></a><span id="l136.8">     if (!div.hasChildNodes()) {</span>
<a href="#l136.9"></a><span id="l136.9">       var textNode = document.createTextNode(text);</span>
<a href="#l136.10"></a><span id="l136.10">       div.appendChild(textNode);</span>
<a href="#l136.11"></a><span id="l136.11">     } else if (div.childNodes.length == 1) {</span>
<a href="#l136.12"></a><span id="l136.12" class="difflineminus">-      div.childNodes[0].nodeValue = text;</span>
<a href="#l136.13"></a><span id="l136.13" class="difflineplus">+      div.firstChild.nodeValue = text;</span>
<a href="#l136.14"></a><span id="l136.14">     }</span>
<a href="#l136.15"></a><span id="l136.15">   }</span>
<a href="#l136.16"></a><span id="l136.16"> }</span>
<a href="#l136.17"></a><span id="l136.17"> </span>
<a href="#l136.18"></a><span id="l136.18"> function CheckIfLocalFolderExists() {</span>
<a href="#l136.19"></a><span id="l136.19">   try {</span>
<a href="#l136.20"></a><span id="l136.20">     if (MailServices.accounts.localFoldersServer) {</span>
<a href="#l136.21"></a><span id="l136.21">       gProgressInfo.localFolderExists = true;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l137.1"></a><span id="l137.1" class="difflineminus">--- a/mailnews/news/content/downloadheaders.js</span>
<a href="#l137.2"></a><span id="l137.2" class="difflineplus">+++ b/mailnews/news/content/downloadheaders.js</span>
<a href="#l137.3"></a><span id="l137.3" class="difflineat">@@ -53,18 +53,18 @@ function OnLoad() {</span>
<a href="#l137.4"></a><span id="l137.4"> }</span>
<a href="#l137.5"></a><span id="l137.5"> </span>
<a href="#l137.6"></a><span id="l137.6"> function setText(id, value) {</span>
<a href="#l137.7"></a><span id="l137.7">   let element = document.getElementById(id);</span>
<a href="#l137.8"></a><span id="l137.8">   if (!element) {</span>
<a href="#l137.9"></a><span id="l137.9">     return;</span>
<a href="#l137.10"></a><span id="l137.10">   }</span>
<a href="#l137.11"></a><span id="l137.11"> </span>
<a href="#l137.12"></a><span id="l137.12" class="difflineminus">-  if (element.hasChildNodes()) {</span>
<a href="#l137.13"></a><span id="l137.13" class="difflineminus">-    element.firstChild.remove();</span>
<a href="#l137.14"></a><span id="l137.14" class="difflineplus">+  while (element.lastChild) {</span>
<a href="#l137.15"></a><span id="l137.15" class="difflineplus">+    element.lastChild.remove();</span>
<a href="#l137.16"></a><span id="l137.16">   }</span>
<a href="#l137.17"></a><span id="l137.17">   let textNode = document.createTextNode(value);</span>
<a href="#l137.18"></a><span id="l137.18">   element.appendChild(textNode);</span>
<a href="#l137.19"></a><span id="l137.19"> }</span>
<a href="#l137.20"></a><span id="l137.20"> </span>
<a href="#l137.21"></a><span id="l137.21"> function OkButtonCallback() {</span>
<a href="#l137.22"></a><span id="l137.22">   nntpServer.maxArticles = numberElement.value;</span>
<a href="#l137.23"></a><span id="l137.23">   nntpServer.markOldRead = markreadElement.checked;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

