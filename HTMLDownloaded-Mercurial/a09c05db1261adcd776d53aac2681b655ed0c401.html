<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 19602:a09c05db1261adcd776d53aac2681b655ed0c401</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ a09c05db1261adcd776d53aac2681b655ed0c401" />
<meta property="og:url" content="/comm-central/rev/a09c05db1261adcd776d53aac2681b655ed0c401" />
<meta property="og:description" content="Bug 1288355 - Replace MOZ_UTF16(&quot;xxx&quot;) with u&quot;xxx&quot;. r=bustage-fix a=jorgk CLOSED TREE" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / a09c05db1261adcd776d53aac2681b655ed0c401 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/a09c05db1261adcd776d53aac2681b655ed0c401">shortlog</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/a09c05db1261adcd776d53aac2681b655ed0c401">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401">files</a> |
changeset |
<a href="/comm-central/raw-rev/a09c05db1261adcd776d53aac2681b655ed0c401">raw</a>  | <a href="/comm-central/archive/a09c05db1261adcd776d53aac2681b655ed0c401.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1288355">Bug 1288355</a> - Replace MOZ_UTF16(&quot;xxx&quot;) with u&quot;xxx&quot;. r=bustage-fix a=jorgk CLOSED TREE
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#114;&#103;&#32;&#75;&#32;&#60;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#64;&#106;&#111;&#114;&#103;&#107;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 22 Jul 2016 01:15:55 +0200</td></tr>

<tr>
 <td>changeset 19602</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/a09c05db1261adcd776d53aac2681b655ed0c401">a09c05db1261adcd776d53aac2681b655ed0c401</a></td>
</tr>



<tr>
<td>parent 19601</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/dd8fa7b8bd6578ac68ca36c7b93dbc9ab3b7cef7">dd8fa7b8bd6578ac68ca36c7b93dbc9ab3b7cef7</a>
</td>
</tr>

<tr>
<td>child 19603</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/66ffb3c065761c381f925728f30d42462a15a77c">66ffb3c065761c381f925728f30d42462a15a77c</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=a09c05db1261adcd776d53aac2681b655ed0c401">12094</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Thu, 21 Jul 2016 23:16:42 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@a09c05db1261 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a09c05db1261adcd776d53aac2681b655ed0c401">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a09c05db1261adcd776d53aac2681b655ed0c401&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a09c05db1261adcd776d53aac2681b655ed0c401&newProject=comm-central&newRevision=a09c05db1261adcd776d53aac2681b655ed0c401&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a09c05db1261adcd776d53aac2681b655ed0c401&newProject=comm-central&newRevision=a09c05db1261adcd776d53aac2681b655ed0c401&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a09c05db1261adcd776d53aac2681b655ed0c401&newProject=comm-central&newRevision=a09c05db1261adcd776d53aac2681b655ed0c401&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28bustage-fix%29&revcount=50">bustage-fix</a>, <a href="/comm-central/log?rev=reviewer%28jorgk%29&revcount=50">jorgk</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1288355">1288355</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1288355">Bug 1288355</a> - Replace MOZ_UTF16(&quot;xxx&quot;) with u&quot;xxx&quot;. r=bustage-fix a=jorgk CLOSED TREE</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mail/components/shell/nsMailGNOMEIntegration.cpp">mail/components/shell/nsMailGNOMEIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mail/components/shell/nsMailGNOMEIntegration.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mail/components/shell/nsMailGNOMEIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mail/components/shell/nsMailGNOMEIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mail/components/shell/nsMailGNOMEIntegration.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mail/components/shell/nsMailGNOMEIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbCardProperty.cpp">mailnews/addrbook/src/nsAbCardProperty.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbCardProperty.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbCardProperty.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbCardProperty.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbCardProperty.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbCardProperty.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPDirectory.cpp">mailnews/addrbook/src/nsAbLDAPDirectory.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPDirectory.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPDirectory.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPDirectory.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPDirectory.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPDirectory.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">mailnews/addrbook/src/nsAbLDAPListenerBase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbManager.cpp">mailnews/addrbook/src/nsAbManager.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbManager.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbManager.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbManager.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbManager.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbManager.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbView.cpp">mailnews/addrbook/src/nsAbView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbView.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbView.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbView.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbView.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAbView.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">mailnews/addrbook/src/nsAddbookProtocolHandler.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddrDatabase.cpp">mailnews/addrbook/src/nsAddrDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddrDatabase.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddrDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddrDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddrDatabase.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/addrbook/src/nsAddrDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilter.cpp">mailnews/base/search/src/nsMsgFilter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilter.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilter.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilter.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilter.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilter.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilterService.cpp">mailnews/base/search/src/nsMsgFilterService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilterService.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilterService.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilterService.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilterService.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgFilterService.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgSearchAdapter.cpp">mailnews/base/search/src/nsMsgSearchAdapter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgSearchAdapter.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgSearchAdapter.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgSearchAdapter.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgSearchAdapter.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/search/src/nsMsgSearchAdapter.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessenger.cpp">mailnews/base/src/nsMessenger.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessenger.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessenger.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessenger.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessenger.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessenger.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerUnixIntegration.cpp">mailnews/base/src/nsMessengerUnixIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerUnixIntegration.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerUnixIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerUnixIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerUnixIntegration.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerUnixIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerWinIntegration.cpp">mailnews/base/src/nsMessengerWinIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerWinIntegration.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerWinIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerWinIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerWinIntegration.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMessengerWinIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManager.cpp">mailnews/base/src/nsMsgAccountManager.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManager.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManager.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManager.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManager.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManager.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManagerDS.cpp">mailnews/base/src/nsMsgAccountManagerDS.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManagerDS.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManagerDS.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManagerDS.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManagerDS.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgAccountManagerDS.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgDBView.cpp">mailnews/base/src/nsMsgDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgDBView.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgDBView.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgDBView.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgDBView.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderCompactor.cpp">mailnews/base/src/nsMsgFolderCompactor.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderCompactor.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderCompactor.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderCompactor.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderCompactor.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderCompactor.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderDataSource.cpp">mailnews/base/src/nsMsgFolderDataSource.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderDataSource.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderDataSource.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderDataSource.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderDataSource.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgFolderDataSource.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgGroupView.cpp">mailnews/base/src/nsMsgGroupView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgGroupView.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgGroupView.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgGroupView.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgGroupView.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgGroupView.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgPrintEngine.cpp">mailnews/base/src/nsMsgPrintEngine.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgPrintEngine.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgPrintEngine.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgPrintEngine.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgPrintEngine.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgPrintEngine.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgStatusFeedback.cpp">mailnews/base/src/nsMsgStatusFeedback.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgStatusFeedback.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgStatusFeedback.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgStatusFeedback.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgStatusFeedback.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgStatusFeedback.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgWindow.cpp">mailnews/base/src/nsMsgWindow.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgWindow.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgWindow.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgWindow.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgWindow.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsMsgWindow.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSpamSettings.cpp">mailnews/base/src/nsSpamSettings.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSpamSettings.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSpamSettings.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSpamSettings.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSpamSettings.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSpamSettings.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribableServer.cpp">mailnews/base/src/nsSubscribableServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribableServer.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribableServer.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribableServer.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribableServer.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribableServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribeDataSource.cpp">mailnews/base/src/nsSubscribeDataSource.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribeDataSource.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribeDataSource.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribeDataSource.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribeDataSource.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/src/nsSubscribeDataSource.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgDBFolder.cpp">mailnews/base/util/nsMsgDBFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgDBFolder.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgDBFolder.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgDBFolder.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgDBFolder.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgDBFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgI18N.cpp">mailnews/base/util/nsMsgI18N.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgI18N.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgI18N.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgI18N.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgI18N.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgI18N.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgIncomingServer.cpp">mailnews/base/util/nsMsgIncomingServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgIncomingServer.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgIncomingServer.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgIncomingServer.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgIncomingServer.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgIncomingServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgProtocol.cpp">mailnews/base/util/nsMsgProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgProtocol.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgProtocol.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgUtils.cpp">mailnews/base/util/nsMsgUtils.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgUtils.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgUtils.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgUtils.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgUtils.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/base/util/nsMsgUtils.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsComposeStrings.cpp">mailnews/compose/src/nsComposeStrings.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsComposeStrings.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsComposeStrings.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsComposeStrings.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsComposeStrings.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsComposeStrings.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgAttachmentHandler.cpp">mailnews/compose/src/nsMsgAttachmentHandler.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgAttachmentHandler.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgAttachmentHandler.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgAttachmentHandler.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgAttachmentHandler.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgAttachmentHandler.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompUtils.cpp">mailnews/compose/src/nsMsgCompUtils.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompUtils.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompUtils.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompUtils.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompUtils.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompUtils.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompose.cpp">mailnews/compose/src/nsMsgCompose.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompose.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompose.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompose.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompose.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgCompose.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgComposeService.cpp">mailnews/compose/src/nsMsgComposeService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgComposeService.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgComposeService.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgComposeService.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgComposeService.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgComposeService.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgPrompts.cpp">mailnews/compose/src/nsMsgPrompts.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgPrompts.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgPrompts.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgPrompts.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgPrompts.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgPrompts.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSend.cpp">mailnews/compose/src/nsMsgSend.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSend.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSend.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSend.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSend.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSend.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendLater.cpp">mailnews/compose/src/nsMsgSendLater.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendLater.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendLater.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendLater.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendLater.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendLater.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendReport.cpp">mailnews/compose/src/nsMsgSendReport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendReport.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendReport.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendReport.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendReport.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsMsgSendReport.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsSmtpProtocol.cpp">mailnews/compose/src/nsSmtpProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsSmtpProtocol.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsSmtpProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsSmtpProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsSmtpProtocol.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/compose/src/nsSmtpProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapIncomingServer.cpp">mailnews/imap/src/nsImapIncomingServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapIncomingServer.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapIncomingServer.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapIncomingServer.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapIncomingServer.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapIncomingServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapMailFolder.cpp">mailnews/imap/src/nsImapMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapProtocol.cpp">mailnews/imap/src/nsImapProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapProtocol.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapProtocol.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapService.cpp">mailnews/imap/src/nsImapService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapService.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapService.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapService.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapService.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/imap/src/nsImapService.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/applemail/src/nsAppleMailImport.cpp">mailnews/import/applemail/src/nsAppleMailImport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/applemail/src/nsAppleMailImport.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/applemail/src/nsAppleMailImport.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/applemail/src/nsAppleMailImport.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/applemail/src/nsAppleMailImport.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/applemail/src/nsAppleMailImport.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">mailnews/import/becky/src/nsBeckyAddressBooks.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyFilters.cpp">mailnews/import/becky/src/nsBeckyFilters.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyFilters.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyFilters.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyFilters.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyFilters.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyFilters.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyImport.cpp">mailnews/import/becky/src/nsBeckyImport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyImport.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyImport.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyImport.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyImport.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyImport.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyMail.cpp">mailnews/import/becky/src/nsBeckyMail.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyMail.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyMail.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyMail.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyMail.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckyMail.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckySettings.cpp">mailnews/import/becky/src/nsBeckySettings.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckySettings.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckySettings.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckySettings.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckySettings.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/becky/src/nsBeckySettings.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/outlook/src/nsOutlookCompose.cpp">mailnews/import/outlook/src/nsOutlookCompose.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/outlook/src/nsOutlookCompose.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/outlook/src/nsOutlookCompose.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/outlook/src/nsOutlookCompose.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/outlook/src/nsOutlookCompose.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/outlook/src/nsOutlookCompose.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/src/nsImportMail.cpp">mailnews/import/src/nsImportMail.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/src/nsImportMail.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/src/nsImportMail.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/src/nsImportMail.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/src/nsImportMail.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/import/src/nsImportMail.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/intl/nsCharsetConverterManager.cpp">mailnews/intl/nsCharsetConverterManager.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/intl/nsCharsetConverterManager.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/intl/nsCharsetConverterManager.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/intl/nsCharsetConverterManager.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/intl/nsCharsetConverterManager.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/intl/nsCharsetConverterManager.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsLocalMailFolder.cpp">mailnews/local/src/nsLocalMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsLocalMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsLocalMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsLocalMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsLocalMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsLocalMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Protocol.cpp">mailnews/local/src/nsPop3Protocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Protocol.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Protocol.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Protocol.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Protocol.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Protocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Service.cpp">mailnews/local/src/nsPop3Service.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Service.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Service.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Service.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Service.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Service.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Sink.cpp">mailnews/local/src/nsPop3Sink.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Sink.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Sink.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Sink.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Sink.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/local/src/nsPop3Sink.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mapi/mapihook/src/msgMapiHook.cpp">mailnews/mapi/mapihook/src/msgMapiHook.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mapi/mapihook/src/msgMapiHook.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mapi/mapihook/src/msgMapiHook.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mapi/mapihook/src/msgMapiHook.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mapi/mapihook/src/msgMapiHook.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mapi/mapihook/src/msgMapiHook.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">mailnews/mime/emitters/nsMimeBaseEmitter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">mailnews/mime/emitters/nsMimeHtmlEmitter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/src/mimemsg.cpp">mailnews/mime/src/mimemsg.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/src/mimemsg.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/src/mimemsg.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/src/mimemsg.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/src/mimemsg.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/mime/src/mimemsg.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPNewsgroupList.cpp">mailnews/news/src/nsNNTPNewsgroupList.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPNewsgroupList.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPNewsgroupList.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPNewsgroupList.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPNewsgroupList.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPNewsgroupList.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPProtocol.cpp">mailnews/news/src/nsNNTPProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPProtocol.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPProtocol.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNNTPProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsDownloader.cpp">mailnews/news/src/nsNewsDownloader.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsDownloader.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsDownloader.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsDownloader.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsDownloader.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsDownloader.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsFolder.cpp">mailnews/news/src/nsNewsFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsFolder.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsFolder.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsFolder.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsFolder.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNewsFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNntpIncomingServer.cpp">mailnews/news/src/nsNntpIncomingServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNntpIncomingServer.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNntpIncomingServer.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNntpIncomingServer.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNntpIncomingServer.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/mailnews/news/src/nsNntpIncomingServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsGNOMEShellService.cpp">suite/shell/src/nsGNOMEShellService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsGNOMEShellService.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsGNOMEShellService.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsGNOMEShellService.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsGNOMEShellService.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsGNOMEShellService.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsWindowsShellService.cpp">suite/shell/src/nsWindowsShellService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsWindowsShellService.cpp">file</a> |
<a href="/comm-central/annotate/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsWindowsShellService.cpp">annotate</a> |
<a href="/comm-central/diff/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsWindowsShellService.cpp">diff</a> |
<a href="/comm-central/comparison/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsWindowsShellService.cpp">comparison</a> |
<a href="/comm-central/log/a09c05db1261adcd776d53aac2681b655ed0c401/suite/shell/src/nsWindowsShellService.cpp">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/components/shell/nsMailGNOMEIntegration.cpp</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/components/shell/nsMailGNOMEIntegration.cpp</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -304,17 +304,17 @@ nsMailGNOMEIntegration::MakeDefault(cons</span>
<a href="#l1.4"></a><span id="l1.4">       mozilla::services::GetStringBundleService();</span>
<a href="#l1.5"></a><span id="l1.5">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7">     nsCOMPtr&lt;nsIStringBundle&gt; brandBundle;</span>
<a href="#l1.8"></a><span id="l1.8">     rv = bundleService-&gt;CreateBundle(BRAND_PROPERTIES, getter_AddRefs(brandBundle));</span>
<a href="#l1.9"></a><span id="l1.9">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l1.10"></a><span id="l1.10"> </span>
<a href="#l1.11"></a><span id="l1.11">     nsString brandShortName;</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    brandBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;brandShortName&quot;),</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    brandBundle-&gt;GetStringFromName(u&quot;brandShortName&quot;,</span>
<a href="#l1.14"></a><span id="l1.14">                                    getter_Copies(brandShortName));</span>
<a href="#l1.15"></a><span id="l1.15"> </span>
<a href="#l1.16"></a><span id="l1.16">     // use brandShortName as the application id.</span>
<a href="#l1.17"></a><span id="l1.17">     NS_ConvertUTF16toUTF8 id(brandShortName);</span>
<a href="#l1.18"></a><span id="l1.18"> </span>
<a href="#l1.19"></a><span id="l1.19">     nsCOMPtr&lt;nsIGIOMimeApp&gt; app;</span>
<a href="#l1.20"></a><span id="l1.20">     rv = giovfs-&gt;CreateAppFromCommand(mAppPath, id, getter_AddRefs(app));</span>
<a href="#l1.21"></a><span id="l1.21">     NS_ENSURE_SUCCESS(rv, rv);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbCardProperty.cpp</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbCardProperty.cpp</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -676,29 +676,29 @@ nsresult nsAbCardProperty::ConvertToEsca</span>
<a href="#l2.4"></a><span id="l2.4">     if (NS_SUCCEEDED(rv) &amp;&amp; !str.IsEmpty())</span>
<a href="#l2.5"></a><span id="l2.5">     {</span>
<a href="#l2.6"></a><span id="l2.6">         myAddPropValue(vObj, VCNoteProp, str.get(), &amp;vCardHasData);</span>
<a href="#l2.7"></a><span id="l2.7">     }</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9">     uint32_t format;</span>
<a href="#l2.10"></a><span id="l2.10">     rv = GetPropertyAsUint32(kPreferMailFormatProperty, &amp;format);</span>
<a href="#l2.11"></a><span id="l2.11">     if (NS_SUCCEEDED(rv) &amp;&amp; format == nsIAbPreferMailFormat::html) {</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        myAddPropValue(vObj, VCUseHTML, MOZ_UTF16(&quot;TRUE&quot;), &amp;vCardHasData);</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        myAddPropValue(vObj, VCUseHTML, u&quot;TRUE&quot;, &amp;vCardHasData);</span>
<a href="#l2.14"></a><span id="l2.14">     }</span>
<a href="#l2.15"></a><span id="l2.15">     else if (NS_SUCCEEDED(rv) &amp;&amp; format == nsIAbPreferMailFormat::plaintext) {</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineminus">-        myAddPropValue(vObj, VCUseHTML, MOZ_UTF16(&quot;FALSE&quot;), &amp;vCardHasData);</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+        myAddPropValue(vObj, VCUseHTML, u&quot;FALSE&quot;, &amp;vCardHasData);</span>
<a href="#l2.18"></a><span id="l2.18">     }</span>
<a href="#l2.19"></a><span id="l2.19"> </span>
<a href="#l2.20"></a><span id="l2.20">     rv = GetPropertyAsAString(kWorkWebPageProperty, str);</span>
<a href="#l2.21"></a><span id="l2.21">     if (NS_SUCCEEDED(rv) &amp;&amp; !str.IsEmpty())</span>
<a href="#l2.22"></a><span id="l2.22">     {</span>
<a href="#l2.23"></a><span id="l2.23">         myAddPropValue(vObj, VCURLProp, str.get(), &amp;vCardHasData);</span>
<a href="#l2.24"></a><span id="l2.24">     }</span>
<a href="#l2.25"></a><span id="l2.25"> </span>
<a href="#l2.26"></a><span id="l2.26" class="difflineminus">-    myAddPropValue(vObj, VCVersionProp, MOZ_UTF16(&quot;2.1&quot;), nullptr);</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineplus">+    myAddPropValue(vObj, VCVersionProp, u&quot;2.1&quot;, nullptr);</span>
<a href="#l2.28"></a><span id="l2.28"> </span>
<a href="#l2.29"></a><span id="l2.29">     if (!vCardHasData) {</span>
<a href="#l2.30"></a><span id="l2.30">         aResult.Truncate();</span>
<a href="#l2.31"></a><span id="l2.31">         cleanVObject(vObj);</span>
<a href="#l2.32"></a><span id="l2.32">         return NS_OK;</span>
<a href="#l2.33"></a><span id="l2.33">     }</span>
<a href="#l2.34"></a><span id="l2.34"> </span>
<a href="#l2.35"></a><span id="l2.35">     int len = 0;</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineat">@@ -724,17 +724,17 @@ nsresult nsAbCardProperty::ConvertToBase</span>
<a href="#l2.37"></a><span id="l2.37">   // Get Address Book string and set it as title of XML document</span>
<a href="#l2.38"></a><span id="l2.38">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l2.39"></a><span id="l2.39">   nsCOMPtr&lt;nsIStringBundleService&gt; stringBundleService =</span>
<a href="#l2.40"></a><span id="l2.40">     mozilla::services::GetStringBundleService();</span>
<a href="#l2.41"></a><span id="l2.41">   if (stringBundleService) {</span>
<a href="#l2.42"></a><span id="l2.42">     rv = stringBundleService-&gt;CreateBundle(sAddrbookProperties, getter_AddRefs(bundle));</span>
<a href="#l2.43"></a><span id="l2.43">     if (NS_SUCCEEDED(rv)) {</span>
<a href="#l2.44"></a><span id="l2.44">       nsString addrBook;</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineminus">-      rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;addressBook&quot;), getter_Copies(addrBook));</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineplus">+      rv = bundle-&gt;GetStringFromName(u&quot;addressBook&quot;, getter_Copies(addrBook));</span>
<a href="#l2.47"></a><span id="l2.47">       if (NS_SUCCEEDED(rv)) {</span>
<a href="#l2.48"></a><span id="l2.48">         xmlStr.AppendLiteral(&quot;&lt;title xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;&quot;);</span>
<a href="#l2.49"></a><span id="l2.49">         xmlStr.Append(addrBook);</span>
<a href="#l2.50"></a><span id="l2.50">         xmlStr.AppendLiteral(&quot;&lt;/title&gt;\n&quot;);</span>
<a href="#l2.51"></a><span id="l2.51">       }</span>
<a href="#l2.52"></a><span id="l2.52">     }</span>
<a href="#l2.53"></a><span id="l2.53">   }</span>
<a href="#l2.54"></a><span id="l2.54"> </span>
<a href="#l2.55"></a><span id="l2.55" class="difflineat">@@ -816,17 +816,17 @@ nsresult nsAbCardProperty::ConvertToXMLP</span>
<a href="#l2.56"></a><span id="l2.56">   }</span>
<a href="#l2.57"></a><span id="l2.57">   else {</span>
<a href="#l2.58"></a><span id="l2.58">     rv = AppendSection(CUSTOM_ATTRS_ARRAY, sizeof(CUSTOM_ATTRS_ARRAY)/sizeof(AppendItem), NS_LITERAL_STRING(&quot;headingDescription&quot;),</span>
<a href="#l2.59"></a><span id="l2.59">          bundle, conv, xmlStr);</span>
<a href="#l2.60"></a><span id="l2.60"> </span>
<a href="#l2.61"></a><span id="l2.61">     xmlStr.AppendLiteral(&quot;&lt;section&gt;&lt;sectiontitle&gt;&quot;);</span>
<a href="#l2.62"></a><span id="l2.62"> </span>
<a href="#l2.63"></a><span id="l2.63">     nsString headingAddresses;</span>
<a href="#l2.64"></a><span id="l2.64" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;headingAddresses&quot;), getter_Copies(headingAddresses));</span>
<a href="#l2.65"></a><span id="l2.65" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(u&quot;headingAddresses&quot;, getter_Copies(headingAddresses));</span>
<a href="#l2.66"></a><span id="l2.66">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l2.67"></a><span id="l2.67"> </span>
<a href="#l2.68"></a><span id="l2.68">     xmlStr.Append(headingAddresses);</span>
<a href="#l2.69"></a><span id="l2.69">     xmlStr.AppendLiteral(&quot;&lt;/sectiontitle&gt;&quot;);</span>
<a href="#l2.70"></a><span id="l2.70"> </span>
<a href="#l2.71"></a><span id="l2.71">     nsCOMPtr&lt;nsIAbManager&gt; abManager = do_GetService(NS_ABMANAGER_CONTRACTID, &amp;rv);</span>
<a href="#l2.72"></a><span id="l2.72">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l2.73"></a><span id="l2.73"> </span>
<a href="#l2.74"></a><span id="l2.74" class="difflineat">@@ -1038,28 +1038,28 @@ nsresult nsAbCardProperty::AppendCitySta</span>
<a href="#l2.75"></a><span id="l2.75"> </span>
<a href="#l2.76"></a><span id="l2.76">   rv = AppendLine(item, aConv, zipResult);</span>
<a href="#l2.77"></a><span id="l2.77">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l2.78"></a><span id="l2.78"> </span>
<a href="#l2.79"></a><span id="l2.79">   nsString formattedString;</span>
<a href="#l2.80"></a><span id="l2.80"> </span>
<a href="#l2.81"></a><span id="l2.81">   if (!cityResult.IsEmpty() &amp;&amp; !stateResult.IsEmpty() &amp;&amp; !zipResult.IsEmpty()) {</span>
<a href="#l2.82"></a><span id="l2.82">     const char16_t *formatStrings[] = { cityResult.get(), stateResult.get(), zipResult.get() };</span>
<a href="#l2.83"></a><span id="l2.83" class="difflineminus">-    rv = aBundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;cityAndStateAndZip&quot;), formatStrings, ArrayLength(formatStrings), getter_Copies(formattedString));</span>
<a href="#l2.84"></a><span id="l2.84" class="difflineplus">+    rv = aBundle-&gt;FormatStringFromName(u&quot;cityAndStateAndZip&quot;, formatStrings, ArrayLength(formatStrings), getter_Copies(formattedString));</span>
<a href="#l2.85"></a><span id="l2.85">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l2.86"></a><span id="l2.86">   }</span>
<a href="#l2.87"></a><span id="l2.87">   else if (!cityResult.IsEmpty() &amp;&amp; !stateResult.IsEmpty() &amp;&amp; zipResult.IsEmpty()) {</span>
<a href="#l2.88"></a><span id="l2.88">     const char16_t *formatStrings[] = { cityResult.get(), stateResult.get() };</span>
<a href="#l2.89"></a><span id="l2.89" class="difflineminus">-    rv = aBundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;cityAndStateNoZip&quot;), formatStrings, ArrayLength(formatStrings), getter_Copies(formattedString));</span>
<a href="#l2.90"></a><span id="l2.90" class="difflineplus">+    rv = aBundle-&gt;FormatStringFromName(u&quot;cityAndStateNoZip&quot;, formatStrings, ArrayLength(formatStrings), getter_Copies(formattedString));</span>
<a href="#l2.91"></a><span id="l2.91">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l2.92"></a><span id="l2.92">   }</span>
<a href="#l2.93"></a><span id="l2.93">   else if ((!cityResult.IsEmpty() &amp;&amp; stateResult.IsEmpty() &amp;&amp; !zipResult.IsEmpty()) ||</span>
<a href="#l2.94"></a><span id="l2.94">           (cityResult.IsEmpty() &amp;&amp; !stateResult.IsEmpty() &amp;&amp; !zipResult.IsEmpty())) {</span>
<a href="#l2.95"></a><span id="l2.95">     const char16_t *formatStrings[] = { cityResult.IsEmpty() ? stateResult.get() : cityResult.get(), zipResult.get() };</span>
<a href="#l2.96"></a><span id="l2.96" class="difflineminus">-    rv = aBundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;cityOrStateAndZip&quot;), formatStrings, ArrayLength(formatStrings), getter_Copies(formattedString));</span>
<a href="#l2.97"></a><span id="l2.97" class="difflineplus">+    rv = aBundle-&gt;FormatStringFromName(u&quot;cityOrStateAndZip&quot;, formatStrings, ArrayLength(formatStrings), getter_Copies(formattedString));</span>
<a href="#l2.98"></a><span id="l2.98">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l2.99"></a><span id="l2.99">   }</span>
<a href="#l2.100"></a><span id="l2.100">   else {</span>
<a href="#l2.101"></a><span id="l2.101">     if (!cityResult.IsEmpty())</span>
<a href="#l2.102"></a><span id="l2.102">       formattedString = cityResult;</span>
<a href="#l2.103"></a><span id="l2.103">     else if (!stateResult.IsEmpty())</span>
<a href="#l2.104"></a><span id="l2.104">       formattedString = stateResult;</span>
<a href="#l2.105"></a><span id="l2.105">     else</span>
<a href="#l2.106"></a><span id="l2.106" class="difflineat">@@ -1103,23 +1103,23 @@ NS_IMETHODIMP nsAbCardProperty::Generate</span>
<a href="#l2.107"></a><span id="l2.107">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l2.108"></a><span id="l2.108">     }</span>
<a href="#l2.109"></a><span id="l2.109"> </span>
<a href="#l2.110"></a><span id="l2.110">     nsString result;</span>
<a href="#l2.111"></a><span id="l2.111"> </span>
<a href="#l2.112"></a><span id="l2.112">     if (aGenerateFormat == GENERATE_LAST_FIRST_ORDER) {</span>
<a href="#l2.113"></a><span id="l2.113">       const char16_t *stringParams[2] = {lastName.get(), firstName.get()};</span>
<a href="#l2.114"></a><span id="l2.114"> </span>
<a href="#l2.115"></a><span id="l2.115" class="difflineminus">-      rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;lastFirstFormat&quot;),</span>
<a href="#l2.116"></a><span id="l2.116" class="difflineplus">+      rv = bundle-&gt;FormatStringFromName(u&quot;lastFirstFormat&quot;,</span>
<a href="#l2.117"></a><span id="l2.117">                                         stringParams, 2, getter_Copies(result));</span>
<a href="#l2.118"></a><span id="l2.118">     }</span>
<a href="#l2.119"></a><span id="l2.119">     else {</span>
<a href="#l2.120"></a><span id="l2.120">       const char16_t *stringParams[2] = {firstName.get(), lastName.get()};</span>
<a href="#l2.121"></a><span id="l2.121"> </span>
<a href="#l2.122"></a><span id="l2.122" class="difflineminus">-      rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;firstLastFormat&quot;),</span>
<a href="#l2.123"></a><span id="l2.123" class="difflineplus">+      rv = bundle-&gt;FormatStringFromName(u&quot;firstLastFormat&quot;,</span>
<a href="#l2.124"></a><span id="l2.124">                                         stringParams, 2, getter_Copies(result));</span>
<a href="#l2.125"></a><span id="l2.125">     }</span>
<a href="#l2.126"></a><span id="l2.126">     NS_ENSURE_SUCCESS(rv, rv); </span>
<a href="#l2.127"></a><span id="l2.127"> </span>
<a href="#l2.128"></a><span id="l2.128">     aResult.Assign(result);</span>
<a href="#l2.129"></a><span id="l2.129">   }</span>
<a href="#l2.130"></a><span id="l2.130"> </span>
<a href="#l2.131"></a><span id="l2.131">   if (aResult.IsEmpty())</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -256,22 +256,22 @@ nsresult nsAbLDAPProcessChangeLogData::G</span>
<a href="#l3.4"></a><span id="l3.4">       mozilla::services::GetStringBundleService();</span>
<a href="#l3.5"></a><span id="l3.5">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l3.6"></a><span id="l3.6">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l3.7"></a><span id="l3.7">     rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/addressbook/addressBook.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l3.8"></a><span id="l3.8">     if (NS_FAILED (rv)) </span>
<a href="#l3.9"></a><span id="l3.9">         return rv ;</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11">     nsString title;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;AuthDlgTitle&quot;), getter_Copies(title));</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(u&quot;AuthDlgTitle&quot;, getter_Copies(title));</span>
<a href="#l3.14"></a><span id="l3.14">     if (NS_FAILED (rv)) </span>
<a href="#l3.15"></a><span id="l3.15">         return rv ;</span>
<a href="#l3.16"></a><span id="l3.16"> </span>
<a href="#l3.17"></a><span id="l3.17">     nsString desc;</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;AuthDlgDesc&quot;), getter_Copies(desc));</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(u&quot;AuthDlgDesc&quot;, getter_Copies(desc));</span>
<a href="#l3.20"></a><span id="l3.20">     if (NS_FAILED (rv)) </span>
<a href="#l3.21"></a><span id="l3.21">         return rv ;</span>
<a href="#l3.22"></a><span id="l3.22"> </span>
<a href="#l3.23"></a><span id="l3.23">     nsString username;</span>
<a href="#l3.24"></a><span id="l3.24">     nsString password;</span>
<a href="#l3.25"></a><span id="l3.25">     bool btnResult = false;</span>
<a href="#l3.26"></a><span id="l3.26"> 	rv = dialog-&gt;PromptUsernameAndPassword(title, desc, </span>
<a href="#l3.27"></a><span id="l3.27">                                             NS_ConvertUTF8toUTF16(serverUri).get(), </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbLDAPDirectory.cpp</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbLDAPDirectory.cpp</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -251,18 +251,18 @@ NS_IMETHODIMP nsAbLDAPDirectory::SetLDAP</span>
<a href="#l4.4"></a><span id="l4.4">   {</span>
<a href="#l4.5"></a><span id="l4.5">     // They don't so its time to send round an update.</span>
<a href="#l4.6"></a><span id="l4.6">     nsCOMPtr&lt;nsIAbManager&gt; abManager = do_GetService(NS_ABMANAGER_CONTRACTID, &amp;rv);</span>
<a href="#l4.7"></a><span id="l4.7">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l4.8"></a><span id="l4.8"> </span>
<a href="#l4.9"></a><span id="l4.9">     // We inherit from nsIAbDirectory, so this static cast should be safe.</span>
<a href="#l4.10"></a><span id="l4.10">     abManager-&gt;NotifyItemPropertyChanged(static_cast&lt;nsIAbDirectory*&gt;(this),</span>
<a href="#l4.11"></a><span id="l4.11">       &quot;IsSecure&quot;,</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-      (newIsNotSecure ? MOZ_UTF16(&quot;true&quot;) : MOZ_UTF16(&quot;false&quot;)),</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-      (newIsNotSecure ? MOZ_UTF16(&quot;false&quot;) : MOZ_UTF16(&quot;true&quot;)));</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+      (newIsNotSecure ? u&quot;true&quot; : u&quot;false&quot;),</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+      (newIsNotSecure ? u&quot;false&quot; : u&quot;true&quot;));</span>
<a href="#l4.16"></a><span id="l4.16">   }</span>
<a href="#l4.17"></a><span id="l4.17"> </span>
<a href="#l4.18"></a><span id="l4.18">   return NS_OK;</span>
<a href="#l4.19"></a><span id="l4.19"> }</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21"> /* </span>
<a href="#l4.22"></a><span id="l4.22">  *</span>
<a href="#l4.23"></a><span id="l4.23">  * nsIAbDirectorySearch methods</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -95,17 +95,17 @@ NS_IMETHODIMP nsAbLDAPListenerBase::OnLD</span>
<a href="#l5.4"></a><span id="l5.4">                &quot;bundle chrome://mozldap/locale/ldap.properties&quot;);</span>
<a href="#l5.5"></a><span id="l5.5">       InitFailed();</span>
<a href="#l5.6"></a><span id="l5.6">       return rv;</span>
<a href="#l5.7"></a><span id="l5.7">     }</span>
<a href="#l5.8"></a><span id="l5.8"> </span>
<a href="#l5.9"></a><span id="l5.9">     // get the title for the authentication prompt</span>
<a href="#l5.10"></a><span id="l5.10">     //</span>
<a href="#l5.11"></a><span id="l5.11">     nsString authPromptTitle;</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-    rv = ldapBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;authPromptTitle&quot;),</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+    rv = ldapBundle-&gt;GetStringFromName(u&quot;authPromptTitle&quot;,</span>
<a href="#l5.14"></a><span id="l5.14">                                        getter_Copies(authPromptTitle));</span>
<a href="#l5.15"></a><span id="l5.15">     if (NS_FAILED(rv))</span>
<a href="#l5.16"></a><span id="l5.16">     {</span>
<a href="#l5.17"></a><span id="l5.17">       NS_ERROR(&quot;nsAbLDAPListenerBase::OnLDAPInit(): error getting&quot;</span>
<a href="#l5.18"></a><span id="l5.18">                &quot;'authPromptTitle' string from bundle &quot;</span>
<a href="#l5.19"></a><span id="l5.19">                &quot;chrome://mozldap/locale/ldap.properties&quot;);</span>
<a href="#l5.20"></a><span id="l5.20">       InitFailed();</span>
<a href="#l5.21"></a><span id="l5.21">       return rv;</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineat">@@ -128,17 +128,17 @@ NS_IMETHODIMP nsAbLDAPListenerBase::OnLD</span>
<a href="#l5.23"></a><span id="l5.23">     // which is the default compiler for Mozilla on linux at the moment.</span>
<a href="#l5.24"></a><span id="l5.24">     //</span>
<a href="#l5.25"></a><span id="l5.25">     NS_ConvertASCIItoUTF16 hostTemp(host);</span>
<a href="#l5.26"></a><span id="l5.26">     const char16_t *hostArray[1] = { hostTemp.get() };</span>
<a href="#l5.27"></a><span id="l5.27"> </span>
<a href="#l5.28"></a><span id="l5.28">     // format the hostname into the authprompt text string</span>
<a href="#l5.29"></a><span id="l5.29">     //</span>
<a href="#l5.30"></a><span id="l5.30">     nsString authPromptText;</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-    rv = ldapBundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;authPromptText&quot;),</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+    rv = ldapBundle-&gt;FormatStringFromName(u&quot;authPromptText&quot;,</span>
<a href="#l5.33"></a><span id="l5.33">                                           hostArray,</span>
<a href="#l5.34"></a><span id="l5.34">                                           sizeof(hostArray) / sizeof(const char16_t *),</span>
<a href="#l5.35"></a><span id="l5.35">                                           getter_Copies(authPromptText));</span>
<a href="#l5.36"></a><span id="l5.36">     if (NS_FAILED(rv))</span>
<a href="#l5.37"></a><span id="l5.37">     {</span>
<a href="#l5.38"></a><span id="l5.38">       NS_ERROR(&quot;nsAbLDAPListenerBase::OnLDAPInit():&quot;</span>
<a href="#l5.39"></a><span id="l5.39">                &quot;error getting 'authPromptText' string from bundle &quot;</span>
<a href="#l5.40"></a><span id="l5.40">                &quot;chrome://mozldap/locale/ldap.properties&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbManager.cpp</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbManager.cpp</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -545,51 +545,51 @@ NS_IMETHODIMP nsAbManager::ExportAddress</span>
<a href="#l6.4"></a><span id="l6.4">   rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/addressbook/addressBook.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l6.5"></a><span id="l6.5">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.6"></a><span id="l6.6"> </span>
<a href="#l6.7"></a><span id="l6.7">   nsString dirName;</span>
<a href="#l6.8"></a><span id="l6.8">   aDirectory-&gt;GetDirName(dirName);</span>
<a href="#l6.9"></a><span id="l6.9">   const char16_t *formatStrings[] = { dirName.get() };</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11">   nsString title;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-  rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;ExportAddressBookNameTitle&quot;), formatStrings,</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+  rv = bundle-&gt;FormatStringFromName(u&quot;ExportAddressBookNameTitle&quot;, formatStrings,</span>
<a href="#l6.14"></a><span id="l6.14">                                     ArrayLength(formatStrings), getter_Copies(title));</span>
<a href="#l6.15"></a><span id="l6.15">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.16"></a><span id="l6.16"> </span>
<a href="#l6.17"></a><span id="l6.17">   rv = filePicker-&gt;Init(aParentWin, title, nsIFilePicker::modeSave);</span>
<a href="#l6.18"></a><span id="l6.18">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.19"></a><span id="l6.19"> </span>
<a href="#l6.20"></a><span id="l6.20">   nsString filterString;</span>
<a href="#l6.21"></a><span id="l6.21"> </span>
<a href="#l6.22"></a><span id="l6.22">   // CSV: System charset and UTF-8.</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;CSVFilesSysCharset&quot;), getter_Copies(filterString));</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(u&quot;CSVFilesSysCharset&quot;, getter_Copies(filterString));</span>
<a href="#l6.25"></a><span id="l6.25">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.26"></a><span id="l6.26">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.csv&quot;));</span>
<a href="#l6.27"></a><span id="l6.27">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;CSVFilesUTF8&quot;), getter_Copies(filterString));</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(u&quot;CSVFilesUTF8&quot;, getter_Copies(filterString));</span>
<a href="#l6.30"></a><span id="l6.30">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.31"></a><span id="l6.31">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.csv&quot;));</span>
<a href="#l6.32"></a><span id="l6.32">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.33"></a><span id="l6.33"> </span>
<a href="#l6.34"></a><span id="l6.34">   // Tab separated: System charset and UTF-8.</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;TABFilesSysCharset&quot;), getter_Copies(filterString));</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(u&quot;TABFilesSysCharset&quot;, getter_Copies(filterString));</span>
<a href="#l6.37"></a><span id="l6.37">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.38"></a><span id="l6.38">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.tab; *.txt&quot;));</span>
<a href="#l6.39"></a><span id="l6.39">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;TABFilesUTF8&quot;), getter_Copies(filterString));</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(u&quot;TABFilesUTF8&quot;, getter_Copies(filterString));</span>
<a href="#l6.42"></a><span id="l6.42">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.43"></a><span id="l6.43">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.tab; *.txt&quot;));</span>
<a href="#l6.44"></a><span id="l6.44">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.45"></a><span id="l6.45"> </span>
<a href="#l6.46"></a><span id="l6.46" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;VCFFiles&quot;), getter_Copies(filterString));</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(u&quot;VCFFiles&quot;, getter_Copies(filterString));</span>
<a href="#l6.48"></a><span id="l6.48">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.49"></a><span id="l6.49">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.vcf&quot;));</span>
<a href="#l6.50"></a><span id="l6.50">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.51"></a><span id="l6.51"> </span>
<a href="#l6.52"></a><span id="l6.52" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;LDIFFiles&quot;), getter_Copies(filterString));</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(u&quot;LDIFFiles&quot;, getter_Copies(filterString));</span>
<a href="#l6.54"></a><span id="l6.54">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.55"></a><span id="l6.55">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.ldi; *.ldif&quot;));</span>
<a href="#l6.56"></a><span id="l6.56">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.57"></a><span id="l6.57"> </span>
<a href="#l6.58"></a><span id="l6.58">   int16_t dialogResult;</span>
<a href="#l6.59"></a><span id="l6.59">   filePicker-&gt;Show(&amp;dialogResult);</span>
<a href="#l6.60"></a><span id="l6.60"> </span>
<a href="#l6.61"></a><span id="l6.61">   if (dialogResult == nsIFilePicker::returnCancel)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbView.cpp</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbView.cpp</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -470,17 +470,17 @@ nsresult nsAbView::GetCardValue(nsIAbCar</span>
<a href="#l7.4"></a><span id="l7.4">   // else, standard column (like PrimaryEmail and _AimScreenName)</span>
<a href="#l7.5"></a><span id="l7.5">   if (colID[0] == char16_t('G'))</span>
<a href="#l7.6"></a><span id="l7.6">     return card-&gt;GenerateName(mGeneratedNameFormat, mABBundle, _retval);</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8">   if (colID[0] == char16_t('_') &amp;&amp; colID[1] == char16_t('P'))</span>
<a href="#l7.9"></a><span id="l7.9">     // Use LN/FN order for the phonetic name</span>
<a href="#l7.10"></a><span id="l7.10">     return card-&gt;GeneratePhoneticName(true, _retval);</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-  if (!NS_strcmp(colID, MOZ_UTF16(&quot;ChatName&quot;)))</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+  if (!NS_strcmp(colID, u&quot;ChatName&quot;))</span>
<a href="#l7.14"></a><span id="l7.14">     return card-&gt;GenerateChatName(_retval);</span>
<a href="#l7.15"></a><span id="l7.15"> </span>
<a href="#l7.16"></a><span id="l7.16">   nsresult rv = card-&gt;GetPropertyAsAString(NS_ConvertUTF16toUTF8(colID).get(), _retval);</span>
<a href="#l7.17"></a><span id="l7.17">   if (rv == NS_ERROR_NOT_AVAILABLE) {</span>
<a href="#l7.18"></a><span id="l7.18">     rv = NS_OK;</span>
<a href="#l7.19"></a><span id="l7.19">     _retval.Truncate();</span>
<a href="#l7.20"></a><span id="l7.20">   }</span>
<a href="#l7.21"></a><span id="l7.21">   return rv;</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -659,17 +659,17 @@ inplaceSortCallback(const AbCard *card1,</span>
<a href="#l7.23"></a><span id="l7.23">       return closure-&gt;abView-&gt;CompareCollationKeys(card1-&gt;secondaryCollationKey,card1-&gt;secondaryCollationKeyLen,card2-&gt;secondaryCollationKey,card2-&gt;secondaryCollationKeyLen) * (closure-&gt;factor);</span>
<a href="#l7.24"></a><span id="l7.24">   }</span>
<a href="#l7.25"></a><span id="l7.25"> }</span>
<a href="#l7.26"></a><span id="l7.26"> </span>
<a href="#l7.27"></a><span id="l7.27"> static void SetSortClosure(const char16_t *sortColumn, const char16_t *sortDirection, nsAbView *abView, SortClosure *closure)</span>
<a href="#l7.28"></a><span id="l7.28"> {</span>
<a href="#l7.29"></a><span id="l7.29">   closure-&gt;colID = sortColumn;</span>
<a href="#l7.30"></a><span id="l7.30">   </span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-  if (sortDirection &amp;&amp; !NS_strcmp(sortDirection, MOZ_UTF16(&quot;descending&quot;)))</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+  if (sortDirection &amp;&amp; !NS_strcmp(sortDirection, u&quot;descending&quot;))</span>
<a href="#l7.33"></a><span id="l7.33">     closure-&gt;factor = DESCENDING_SORT_FACTOR;</span>
<a href="#l7.34"></a><span id="l7.34">   else </span>
<a href="#l7.35"></a><span id="l7.35">     closure-&gt;factor = ASCENDING_SORT_FACTOR;</span>
<a href="#l7.36"></a><span id="l7.36"> </span>
<a href="#l7.37"></a><span id="l7.37">   closure-&gt;abView = abView;</span>
<a href="#l7.38"></a><span id="l7.38">   return;</span>
<a href="#l7.39"></a><span id="l7.39"> }</span>
<a href="#l7.40"></a><span id="l7.40"> </span>
<a href="#l7.41"></a><span id="l7.41" class="difflineat">@@ -1314,18 +1314,18 @@ NS_IMETHODIMP nsAbView::SwapFirstNameLas</span>
<a href="#l7.42"></a><span id="l7.42">           {</span>
<a href="#l7.43"></a><span id="l7.43">             nsString dnLnFn;</span>
<a href="#l7.44"></a><span id="l7.44">             nsString dnFnLn;</span>
<a href="#l7.45"></a><span id="l7.45">             const char16_t *nameString[2];</span>
<a href="#l7.46"></a><span id="l7.46">             const char16_t *formatString;</span>
<a href="#l7.47"></a><span id="l7.47"> </span>
<a href="#l7.48"></a><span id="l7.48">             // The format should stays the same before/after we swap the names</span>
<a href="#l7.49"></a><span id="l7.49">             formatString = displayNameLastnamefirst ?</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineminus">-                              MOZ_UTF16(&quot;lastFirstFormat&quot;) :</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineminus">-                              MOZ_UTF16(&quot;firstLastFormat&quot;);</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineplus">+                              u&quot;lastFirstFormat&quot; :</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineplus">+                              u&quot;firstLastFormat&quot;;</span>
<a href="#l7.54"></a><span id="l7.54"> </span>
<a href="#l7.55"></a><span id="l7.55">             // Generate both ln/fn and fn/ln combination since we need both later</span>
<a href="#l7.56"></a><span id="l7.56">             // to check to see if the current display name was edited</span>
<a href="#l7.57"></a><span id="l7.57">             // note that fn/ln still hold the values before the swap</span>
<a href="#l7.58"></a><span id="l7.58">             nameString[0] = ln.get();</span>
<a href="#l7.59"></a><span id="l7.59">             nameString[1] = fn.get();</span>
<a href="#l7.60"></a><span id="l7.60">             rv = bundle-&gt;FormatStringFromName(formatString,</span>
<a href="#l7.61"></a><span id="l7.61">                                               nameString, 2, getter_Copies(dnLnFn));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -274,17 +274,17 @@ nsAddbookProtocolHandler::BuildDirectory</span>
<a href="#l8.4"></a><span id="l8.4">   // Get Address Book string and set it as title of XML document</span>
<a href="#l8.5"></a><span id="l8.5">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l8.6"></a><span id="l8.6">   nsCOMPtr&lt;nsIStringBundleService&gt; stringBundleService =</span>
<a href="#l8.7"></a><span id="l8.7">     mozilla::services::GetStringBundleService();</span>
<a href="#l8.8"></a><span id="l8.8">   if (stringBundleService) {</span>
<a href="#l8.9"></a><span id="l8.9">     rv = stringBundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/addressbook/addressBook.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l8.10"></a><span id="l8.10">     if (NS_SUCCEEDED(rv)) {</span>
<a href="#l8.11"></a><span id="l8.11">       nsString addrBook;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-      rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;addressBook&quot;), getter_Copies(addrBook));</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+      rv = bundle-&gt;GetStringFromName(u&quot;addressBook&quot;, getter_Copies(addrBook));</span>
<a href="#l8.14"></a><span id="l8.14">       if (NS_SUCCEEDED(rv)) {</span>
<a href="#l8.15"></a><span id="l8.15">         aOutput.AppendLiteral(&quot;&lt;title xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;&quot;);</span>
<a href="#l8.16"></a><span id="l8.16">         aOutput.Append(addrBook);</span>
<a href="#l8.17"></a><span id="l8.17">         aOutput.AppendLiteral(&quot;&lt;/title&gt;\n&quot;);</span>
<a href="#l8.18"></a><span id="l8.18">       }</span>
<a href="#l8.19"></a><span id="l8.19">     }</span>
<a href="#l8.20"></a><span id="l8.20">   }</span>
<a href="#l8.21"></a><span id="l8.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -424,25 +424,25 @@ nsresult nsAddrDatabase::DisplayAlert(co</span>
<a href="#l9.4"></a><span id="l9.4">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.5"></a><span id="l9.5"> </span>
<a href="#l9.6"></a><span id="l9.6">   return prompter-&gt;Alert(nullptr /* we don't know the parent window */, alertTitle.get(), alertMessage.get());</span>
<a href="#l9.7"></a><span id="l9.7"> }</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9"> nsresult nsAddrDatabase::AlertAboutCorruptMabFile(const char16_t *aOldFileName, const char16_t *aNewFileName)</span>
<a href="#l9.10"></a><span id="l9.10"> {</span>
<a href="#l9.11"></a><span id="l9.11">   const char16_t *formatStrings[] = { aOldFileName, aOldFileName, aNewFileName };</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-  return DisplayAlert(MOZ_UTF16(&quot;corruptMabFileTitle&quot;),</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-    MOZ_UTF16(&quot;corruptMabFileAlert&quot;), formatStrings, 3);</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+  return DisplayAlert(u&quot;corruptMabFileTitle&quot;,</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+    u&quot;corruptMabFileAlert&quot;, formatStrings, 3);</span>
<a href="#l9.16"></a><span id="l9.16"> }</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18"> nsresult nsAddrDatabase::AlertAboutLockedMabFile(const char16_t *aFileName)</span>
<a href="#l9.19"></a><span id="l9.19"> {</span>
<a href="#l9.20"></a><span id="l9.20">   const char16_t *formatStrings[] = { aFileName };</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineminus">-  return DisplayAlert(MOZ_UTF16(&quot;lockedMabFileTitle&quot;),</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineminus">-    MOZ_UTF16(&quot;lockedMabFileAlert&quot;), formatStrings, 1);</span>
<a href="#l9.23"></a><span id="l9.23" class="difflineplus">+  return DisplayAlert(u&quot;lockedMabFileTitle&quot;,</span>
<a href="#l9.24"></a><span id="l9.24" class="difflineplus">+    u&quot;lockedMabFileAlert&quot;, formatStrings, 1);</span>
<a href="#l9.25"></a><span id="l9.25"> }</span>
<a href="#l9.26"></a><span id="l9.26"> </span>
<a href="#l9.27"></a><span id="l9.27"> nsresult</span>
<a href="#l9.28"></a><span id="l9.28"> nsAddrDatabase::OpenInternal(nsIFile *aMabFile, bool aCreate, nsIAddrDatabase** pAddrDB)</span>
<a href="#l9.29"></a><span id="l9.29"> {</span>
<a href="#l9.30"></a><span id="l9.30">   nsAddrDatabase *pAddressBookDB = new nsAddrDatabase();</span>
<a href="#l9.31"></a><span id="l9.31">   if (!pAddressBookDB) {</span>
<a href="#l9.32"></a><span id="l9.32">     return NS_ERROR_OUT_OF_MEMORY;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgFilter.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgFilter.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -581,28 +581,28 @@ nsMsgFilter::LogRuleHitGeneric(nsIMsgRul</span>
<a href="#l10.4"></a><span id="l10.4">       PR_snprintf(tcode, sizeof(tcode), &quot;0x%08x&quot;, aRcode);</span>
<a href="#l10.5"></a><span id="l10.5"> </span>
<a href="#l10.6"></a><span id="l10.6">       NS_ConvertASCIItoUTF16 tcode16(tcode) ;</span>
<a href="#l10.7"></a><span id="l10.7">       NS_ConvertASCIItoUTF16 tErrmsg16(aErrmsg) ;</span>
<a href="#l10.8"></a><span id="l10.8"> </span>
<a href="#l10.9"></a><span id="l10.9">       const char16_t *logErrorFormatStrings[2] = { tErrmsg16.get(),  tcode16.get()};</span>
<a href="#l10.10"></a><span id="l10.10">       nsString filterFailureWarningPrefix;</span>
<a href="#l10.11"></a><span id="l10.11">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-                      MOZ_UTF16(&quot;filterFailureWarningPrefix&quot;),</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+                      u&quot;filterFailureWarningPrefix&quot;,</span>
<a href="#l10.14"></a><span id="l10.14">                       logErrorFormatStrings, 2,</span>
<a href="#l10.15"></a><span id="l10.15">                       getter_Copies(filterFailureWarningPrefix));</span>
<a href="#l10.16"></a><span id="l10.16">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l10.17"></a><span id="l10.17">       buffer += NS_ConvertUTF16toUTF8(filterFailureWarningPrefix);</span>
<a href="#l10.18"></a><span id="l10.18">       buffer += &quot;\n&quot;;</span>
<a href="#l10.19"></a><span id="l10.19">     }</span>
<a href="#l10.20"></a><span id="l10.20"> </span>
<a href="#l10.21"></a><span id="l10.21">     const char16_t *filterLogDetectFormatStrings[4] = { filterName.get(), authorValue.get(), subjectValue.get(), dateValue.get() };</span>
<a href="#l10.22"></a><span id="l10.22">     nsString filterLogDetectStr;</span>
<a href="#l10.23"></a><span id="l10.23">     rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineminus">-      MOZ_UTF16(&quot;filterLogDetectStr&quot;),</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineplus">+      u&quot;filterLogDetectStr&quot;,</span>
<a href="#l10.26"></a><span id="l10.26">       filterLogDetectFormatStrings, 4,</span>
<a href="#l10.27"></a><span id="l10.27">       getter_Copies(filterLogDetectStr));</span>
<a href="#l10.28"></a><span id="l10.28">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l10.29"></a><span id="l10.29"> </span>
<a href="#l10.30"></a><span id="l10.30">     buffer += NS_ConvertUTF16toUTF8(filterLogDetectStr);</span>
<a href="#l10.31"></a><span id="l10.31">     buffer +=  &quot;\n&quot;;</span>
<a href="#l10.32"></a><span id="l10.32"> </span>
<a href="#l10.33"></a><span id="l10.33">     if (actionType == nsMsgFilterAction::MoveToFolder ||</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineat">@@ -615,33 +615,33 @@ nsMsgFilter::LogRuleHitGeneric(nsIMsgRul</span>
<a href="#l10.35"></a><span id="l10.35">       nsCString msgId;</span>
<a href="#l10.36"></a><span id="l10.36">       aMsgHdr-&gt;GetMessageId(getter_Copies(msgId));</span>
<a href="#l10.37"></a><span id="l10.37">       NS_ConvertASCIItoUTF16 msgIdValue(msgId);</span>
<a href="#l10.38"></a><span id="l10.38"> </span>
<a href="#l10.39"></a><span id="l10.39">       const char16_t *logMoveFormatStrings[2] = { msgIdValue.get(), actionFolderUriValue.get() };</span>
<a href="#l10.40"></a><span id="l10.40">       nsString logMoveStr;</span>
<a href="#l10.41"></a><span id="l10.41">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l10.42"></a><span id="l10.42">         (actionType == nsMsgFilterAction::MoveToFolder) ?</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineminus">-          MOZ_UTF16(&quot;logMoveStr&quot;) : MOZ_UTF16(&quot;logCopyStr&quot;),</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineplus">+          u&quot;logMoveStr&quot; : u&quot;logCopyStr&quot;,</span>
<a href="#l10.45"></a><span id="l10.45">         logMoveFormatStrings, 2,</span>
<a href="#l10.46"></a><span id="l10.46">         getter_Copies(logMoveStr));</span>
<a href="#l10.47"></a><span id="l10.47">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l10.48"></a><span id="l10.48"> </span>
<a href="#l10.49"></a><span id="l10.49">       buffer += NS_ConvertUTF16toUTF8(logMoveStr);</span>
<a href="#l10.50"></a><span id="l10.50">     }</span>
<a href="#l10.51"></a><span id="l10.51">     else if (actionType == nsMsgFilterAction::Custom)</span>
<a href="#l10.52"></a><span id="l10.52">     {</span>
<a href="#l10.53"></a><span id="l10.53">       nsCOMPtr&lt;nsIMsgFilterCustomAction&gt; customAction;</span>
<a href="#l10.54"></a><span id="l10.54">       nsAutoString filterActionName;</span>
<a href="#l10.55"></a><span id="l10.55">       rv = aFilterAction-&gt;GetCustomAction(getter_AddRefs(customAction));</span>
<a href="#l10.56"></a><span id="l10.56">       if (NS_SUCCEEDED(rv) &amp;&amp; customAction)</span>
<a href="#l10.57"></a><span id="l10.57">         customAction-&gt;GetName(filterActionName);</span>
<a href="#l10.58"></a><span id="l10.58">       if (filterActionName.IsEmpty())</span>
<a href="#l10.59"></a><span id="l10.59">         bundle-&gt;GetStringFromName(</span>
<a href="#l10.60"></a><span id="l10.60" class="difflineminus">-                  MOZ_UTF16(&quot;filterMissingCustomAction&quot;),</span>
<a href="#l10.61"></a><span id="l10.61" class="difflineplus">+                  u&quot;filterMissingCustomAction&quot;,</span>
<a href="#l10.62"></a><span id="l10.62">                   getter_Copies(filterActionName));</span>
<a href="#l10.63"></a><span id="l10.63">       buffer += NS_ConvertUTF16toUTF8(filterActionName);</span>
<a href="#l10.64"></a><span id="l10.64">     }</span>
<a href="#l10.65"></a><span id="l10.65">     else</span>
<a href="#l10.66"></a><span id="l10.66">     {</span>
<a href="#l10.67"></a><span id="l10.67">       nsString actionValue;</span>
<a href="#l10.68"></a><span id="l10.68">       nsAutoString filterActionID;</span>
<a href="#l10.69"></a><span id="l10.69">       filterActionID = NS_LITERAL_STRING(&quot;filterAction&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgFilterService.cpp</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgFilterService.cpp</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1175,17 +1175,17 @@ bool nsMsgFilterAfterTheFact::ContinueEx</span>
<a href="#l11.4"></a><span id="l11.4">   nsString filterName;</span>
<a href="#l11.5"></a><span id="l11.5">   m_curFilter-&gt;GetFilterName(filterName);</span>
<a href="#l11.6"></a><span id="l11.6">   nsString formatString;</span>
<a href="#l11.7"></a><span id="l11.7">   nsString confirmText;</span>
<a href="#l11.8"></a><span id="l11.8">   const char16_t *formatStrings[] =</span>
<a href="#l11.9"></a><span id="l11.9">   {</span>
<a href="#l11.10"></a><span id="l11.10">     filterName.get()</span>
<a href="#l11.11"></a><span id="l11.11">   };</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-  nsresult rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;continueFilterExecution&quot;),</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+  nsresult rv = bundle-&gt;FormatStringFromName(u&quot;continueFilterExecution&quot;,</span>
<a href="#l11.14"></a><span id="l11.14">                                              formatStrings, 1, getter_Copies(confirmText));</span>
<a href="#l11.15"></a><span id="l11.15">   if (NS_FAILED(rv))</span>
<a href="#l11.16"></a><span id="l11.16">     return false;</span>
<a href="#l11.17"></a><span id="l11.17">   bool returnVal = false;</span>
<a href="#l11.18"></a><span id="l11.18">   (void) DisplayConfirmationPrompt(m_msgWindow, confirmText.get(), &amp;returnVal);</span>
<a href="#l11.19"></a><span id="l11.19">   return returnVal;</span>
<a href="#l11.20"></a><span id="l11.20"> }</span>
<a href="#l11.21"></a><span id="l11.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgSearchAdapter.cpp</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgSearchAdapter.cpp</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -149,17 +149,17 @@ NS_IMETHODIMP nsMsgSearchAdapter::AddHit</span>
<a href="#l12.4"></a><span id="l12.4"> </span>
<a href="#l12.5"></a><span id="l12.5"> </span>
<a href="#l12.6"></a><span id="l12.6"> char *</span>
<a href="#l12.7"></a><span id="l12.7"> nsMsgSearchAdapter::GetImapCharsetParam(const char16_t *destCharset)</span>
<a href="#l12.8"></a><span id="l12.8"> {</span>
<a href="#l12.9"></a><span id="l12.9">   char *result = nullptr;</span>
<a href="#l12.10"></a><span id="l12.10"> </span>
<a href="#l12.11"></a><span id="l12.11">   // Specify a character set unless we happen to be US-ASCII.</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  if (NS_strcmp(destCharset, MOZ_UTF16(&quot;us-ascii&quot;)))</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  if (NS_strcmp(destCharset, u&quot;us-ascii&quot;))</span>
<a href="#l12.14"></a><span id="l12.14">       result = PR_smprintf(&quot;%s%s&quot;, nsMsgSearchAdapter::m_kImapCharset, NS_ConvertUTF16toUTF8(destCharset).get());</span>
<a href="#l12.15"></a><span id="l12.15"> </span>
<a href="#l12.16"></a><span id="l12.16">   return result;</span>
<a href="#l12.17"></a><span id="l12.17"> }</span>
<a href="#l12.18"></a><span id="l12.18"> </span>
<a href="#l12.19"></a><span id="l12.19"> /*</span>
<a href="#l12.20"></a><span id="l12.20">    09/21/2000 - taka@netscape.com</span>
<a href="#l12.21"></a><span id="l12.21">    This method is bogus. Escape must be done against char * not char16_t *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -248,17 +248,17 @@ NS_IMETHODIMP nsMessenger::SetWindow(moz</span>
<a href="#l13.4"></a><span id="l13.4">     nsIDocShell *docShell = win-&gt;GetDocShell();</span>
<a href="#l13.5"></a><span id="l13.5">     nsCOMPtr&lt;nsIDocShellTreeItem&gt; docShellAsItem(do_QueryInterface(docShell));</span>
<a href="#l13.6"></a><span id="l13.6">     NS_ENSURE_TRUE(docShellAsItem, NS_ERROR_FAILURE);</span>
<a href="#l13.7"></a><span id="l13.7"> </span>
<a href="#l13.8"></a><span id="l13.8">     nsCOMPtr&lt;nsIDocShellTreeItem&gt; rootDocShellAsItem;</span>
<a href="#l13.9"></a><span id="l13.9">     docShellAsItem-&gt;GetSameTypeRootTreeItem(getter_AddRefs(rootDocShellAsItem));</span>
<a href="#l13.10"></a><span id="l13.10"> </span>
<a href="#l13.11"></a><span id="l13.11">     nsCOMPtr&lt;nsIDocShellTreeItem&gt; childAsItem;</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-    rv = rootDocShellAsItem-&gt;FindChildWithName(MOZ_UTF16(&quot;messagepane&quot;), true, false,</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+    rv = rootDocShellAsItem-&gt;FindChildWithName(u&quot;messagepane&quot;, true, false,</span>
<a href="#l13.14"></a><span id="l13.14">                                                nullptr, nullptr, getter_AddRefs(childAsItem));</span>
<a href="#l13.15"></a><span id="l13.15"> </span>
<a href="#l13.16"></a><span id="l13.16">     mDocShell = do_QueryInterface(childAsItem);</span>
<a href="#l13.17"></a><span id="l13.17">     if (NS_SUCCEEDED(rv) &amp;&amp; mDocShell) {</span>
<a href="#l13.18"></a><span id="l13.18">       mCurrentDisplayCharset = &quot;&quot;; // Important! Clear out mCurrentDisplayCharset so we reset a default charset on mDocshell the next time we try to load something into it.</span>
<a href="#l13.19"></a><span id="l13.19"> </span>
<a href="#l13.20"></a><span id="l13.20">       if (aMsgWindow)</span>
<a href="#l13.21"></a><span id="l13.21">         aMsgWindow-&gt;GetTransactionManager(getter_AddRefs(mTxnMgr));</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -321,17 +321,17 @@ nsMessenger::PromptIfFileExists(nsIFile </span>
<a href="#l13.23"></a><span id="l13.23">     file-&gt;GetPath(path);</span>
<a href="#l13.24"></a><span id="l13.24">     const char16_t *pathFormatStrings[] = { path.get() };</span>
<a href="#l13.25"></a><span id="l13.25"> </span>
<a href="#l13.26"></a><span id="l13.26">     if (!mStringBundle)</span>
<a href="#l13.27"></a><span id="l13.27">     {</span>
<a href="#l13.28"></a><span id="l13.28">       rv = InitStringBundle();</span>
<a href="#l13.29"></a><span id="l13.29">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l13.30"></a><span id="l13.30">     }</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-    rv = mStringBundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;fileExists&quot;),</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+    rv = mStringBundle-&gt;FormatStringFromName(u&quot;fileExists&quot;,</span>
<a href="#l13.33"></a><span id="l13.33">                                              pathFormatStrings, 1,</span>
<a href="#l13.34"></a><span id="l13.34">                                              getter_Copies(errorMessage));</span>
<a href="#l13.35"></a><span id="l13.35">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l13.36"></a><span id="l13.36">     rv = dialog-&gt;Confirm(nullptr, errorMessage.get(), &amp;dialogResult);</span>
<a href="#l13.37"></a><span id="l13.37">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l13.38"></a><span id="l13.38"> </span>
<a href="#l13.39"></a><span id="l13.39">     if (dialogResult)</span>
<a href="#l13.40"></a><span id="l13.40">     {</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineat">@@ -832,17 +832,17 @@ nsMessenger::SaveOneAttachment(const cha</span>
<a href="#l13.42"></a><span id="l13.42">     {</span>
<a href="#l13.43"></a><span id="l13.43">       rv = InitStringBundle();</span>
<a href="#l13.44"></a><span id="l13.44">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l13.45"></a><span id="l13.45">     }</span>
<a href="#l13.46"></a><span id="l13.46"> </span>
<a href="#l13.47"></a><span id="l13.47">     nsString filterName;</span>
<a href="#l13.48"></a><span id="l13.48">     const char16_t *extensionParam[] = { extension.get() };</span>
<a href="#l13.49"></a><span id="l13.49">     rv = mStringBundle-&gt;FormatStringFromName(</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineminus">-      MOZ_UTF16(&quot;saveAsType&quot;), extensionParam, 1, getter_Copies(filterName));</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+      u&quot;saveAsType&quot;, extensionParam, 1, getter_Copies(filterName));</span>
<a href="#l13.52"></a><span id="l13.52">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l13.53"></a><span id="l13.53"> </span>
<a href="#l13.54"></a><span id="l13.54">     extension.Insert(NS_LITERAL_STRING(&quot;*.&quot;), 0);</span>
<a href="#l13.55"></a><span id="l13.55">     filePicker-&gt;AppendFilter(filterName, extension);</span>
<a href="#l13.56"></a><span id="l13.56">   }</span>
<a href="#l13.57"></a><span id="l13.57"> </span>
<a href="#l13.58"></a><span id="l13.58">   filePicker-&gt;AppendFilters(nsIFilePicker::filterAll);</span>
<a href="#l13.59"></a><span id="l13.59"> </span>
<a href="#l13.60"></a><span id="l13.60" class="difflineat">@@ -3048,17 +3048,17 @@ nsMessenger::PromptIfDeleteAttachments(b</span>
<a href="#l13.61"></a><span id="l13.61">     attachmentList.Append(displayString);</span>
<a href="#l13.62"></a><span id="l13.62">     attachmentList.Append(char16_t('\n'));</span>
<a href="#l13.63"></a><span id="l13.63">   }</span>
<a href="#l13.64"></a><span id="l13.64">   const char16_t *formatStrings[] = { attachmentList.get() };</span>
<a href="#l13.65"></a><span id="l13.65"> </span>
<a href="#l13.66"></a><span id="l13.66">   // format the message and display</span>
<a href="#l13.67"></a><span id="l13.67">   nsString promptMessage;</span>
<a href="#l13.68"></a><span id="l13.68">   const char16_t * propertyName = aSaveFirst ?</span>
<a href="#l13.69"></a><span id="l13.69" class="difflineminus">-    MOZ_UTF16(&quot;detachAttachments&quot;) : MOZ_UTF16(&quot;deleteAttachments&quot;);</span>
<a href="#l13.70"></a><span id="l13.70" class="difflineplus">+    u&quot;detachAttachments&quot; : u&quot;deleteAttachments&quot;;</span>
<a href="#l13.71"></a><span id="l13.71">   rv = mStringBundle-&gt;FormatStringFromName(propertyName, formatStrings, 1,getter_Copies(promptMessage));</span>
<a href="#l13.72"></a><span id="l13.72">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l13.73"></a><span id="l13.73"> </span>
<a href="#l13.74"></a><span id="l13.74">   bool dialogResult = false;</span>
<a href="#l13.75"></a><span id="l13.75">   rv = dialog-&gt;Confirm(nullptr, promptMessage.get(), &amp;dialogResult);</span>
<a href="#l13.76"></a><span id="l13.76">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l13.77"></a><span id="l13.77"> </span>
<a href="#l13.78"></a><span id="l13.78">   return dialogResult ? NS_OK : NS_ERROR_FAILURE;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerUnixIntegration.cpp</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerUnixIntegration.cpp</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -171,18 +171,18 @@ nsMessengerUnixIntegration::BuildNotific</span>
<a href="#l14.4"></a><span id="l14.4">   numNewMsgsText.AppendInt(numNewMessages);</span>
<a href="#l14.5"></a><span id="l14.5"> </span>
<a href="#l14.6"></a><span id="l14.6">   const char16_t *formatStrings[] =</span>
<a href="#l14.7"></a><span id="l14.7">   {</span>
<a href="#l14.8"></a><span id="l14.8">     accountName.get(), numNewMsgsText.get()</span>
<a href="#l14.9"></a><span id="l14.9">   };</span>
<a href="#l14.10"></a><span id="l14.10"> </span>
<a href="#l14.11"></a><span id="l14.11">   aBundle-&gt;FormatStringFromName(numNewMessages == 1 ?</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-                                  MOZ_UTF16(&quot;newMailNotification_message&quot;) :</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-                                  MOZ_UTF16(&quot;newMailNotification_messages&quot;),</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+                                  u&quot;newMailNotification_message&quot; :</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+                                  u&quot;newMailNotification_messages&quot;,</span>
<a href="#l14.16"></a><span id="l14.16">                                 formatStrings, 2, getter_Copies(aTitle));</span>
<a href="#l14.17"></a><span id="l14.17">   return true;</span>
<a href="#l14.18"></a><span id="l14.18"> }</span>
<a href="#l14.19"></a><span id="l14.19"> </span>
<a href="#l14.20"></a><span id="l14.20"> /* This comparator lets us sort an nsCOMArray of nsIMsgDBHdr's by</span>
<a href="#l14.21"></a><span id="l14.21">  * their dateInSeconds attributes in ascending order.</span>
<a href="#l14.22"></a><span id="l14.22">  */</span>
<a href="#l14.23"></a><span id="l14.23"> static int</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineat">@@ -290,17 +290,17 @@ nsMessengerUnixIntegration::BuildNotific</span>
<a href="#l14.25"></a><span id="l14.25"> </span>
<a href="#l14.26"></a><span id="l14.26">   if (showSubject &amp;&amp; showSender)</span>
<a href="#l14.27"></a><span id="l14.27">   {</span>
<a href="#l14.28"></a><span id="l14.28">     nsString msgTitle;</span>
<a href="#l14.29"></a><span id="l14.29">     const char16_t *formatStrings[] =</span>
<a href="#l14.30"></a><span id="l14.30">     {</span>
<a href="#l14.31"></a><span id="l14.31">       subject.get(), author.get()</span>
<a href="#l14.32"></a><span id="l14.32">     };</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineminus">-    aBundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;newMailNotification_messagetitle&quot;),</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineplus">+    aBundle-&gt;FormatStringFromName(u&quot;newMailNotification_messagetitle&quot;,</span>
<a href="#l14.35"></a><span id="l14.35">         formatStrings, 2, getter_Copies(msgTitle));</span>
<a href="#l14.36"></a><span id="l14.36">     alertBody.Append(msgTitle);</span>
<a href="#l14.37"></a><span id="l14.37">   }</span>
<a href="#l14.38"></a><span id="l14.38">   else if (showSubject)</span>
<a href="#l14.39"></a><span id="l14.39">     alertBody.Append(subject);</span>
<a href="#l14.40"></a><span id="l14.40">   else if (showSender)</span>
<a href="#l14.41"></a><span id="l14.41">     alertBody.Append(author);</span>
<a href="#l14.42"></a><span id="l14.42"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerWinIntegration.cpp</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerWinIntegration.cpp</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -730,19 +730,19 @@ void nsMessengerWinIntegration::FillTool</span>
<a href="#l15.4"></a><span id="l15.4"> </span>
<a href="#l15.5"></a><span id="l15.5">         const char16_t *formatStrings[] =</span>
<a href="#l15.6"></a><span id="l15.6">         {</span>
<a href="#l15.7"></a><span id="l15.7">           numNewMsgsText.get(),</span>
<a href="#l15.8"></a><span id="l15.8">         };</span>
<a href="#l15.9"></a><span id="l15.9"> </span>
<a href="#l15.10"></a><span id="l15.10">         nsString finalText;</span>
<a href="#l15.11"></a><span id="l15.11">         if (numNewMessages == 1)</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-          bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;biffNotification_message&quot;), formatStrings, 1, getter_Copies(finalText));</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+          bundle-&gt;FormatStringFromName(u&quot;biffNotification_message&quot;, formatStrings, 1, getter_Copies(finalText));</span>
<a href="#l15.14"></a><span id="l15.14">         else</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-          bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;biffNotification_messages&quot;), formatStrings, 1, getter_Copies(finalText));</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+          bundle-&gt;FormatStringFromName(u&quot;biffNotification_messages&quot;, formatStrings, 1, getter_Copies(finalText));</span>
<a href="#l15.17"></a><span id="l15.17"> </span>
<a href="#l15.18"></a><span id="l15.18">         // the alert message is special...we actually only want to show the first account with</span>
<a href="#l15.19"></a><span id="l15.19">         // new mail in the alert.</span>
<a href="#l15.20"></a><span id="l15.20">         if (animatedAlertText.IsEmpty()) // if we haven't filled in the animated alert text yet</span>
<a href="#l15.21"></a><span id="l15.21">           animatedAlertText = finalText;</span>
<a href="#l15.22"></a><span id="l15.22"> </span>
<a href="#l15.23"></a><span id="l15.23">         toolTipLine.Append(accountName);</span>
<a href="#l15.24"></a><span id="l15.24">         toolTipLine.Append(' ');</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/base/src/nsMsgAccountManager.cpp</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgAccountManager.cpp</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -2294,17 +2294,17 @@ nsresult nsMsgAccountManager::GetLocalFo</span>
<a href="#l16.4"></a><span id="l16.4">   nsCOMPtr&lt;nsIStringBundleService&gt; sBundleService =</span>
<a href="#l16.5"></a><span id="l16.5">     mozilla::services::GetStringBundleService();</span>
<a href="#l16.6"></a><span id="l16.6">   NS_ENSURE_TRUE(sBundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l16.7"></a><span id="l16.7"> </span>
<a href="#l16.8"></a><span id="l16.8">   rv = sBundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/messenger.properties&quot;,</span>
<a href="#l16.9"></a><span id="l16.9">                                     getter_AddRefs(bundle));</span>
<a href="#l16.10"></a><span id="l16.10">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l16.11"></a><span id="l16.11"> </span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-  return bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;localFolders&quot;), getter_Copies(localFoldersName));</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+  return bundle-&gt;GetStringFromName(u&quot;localFolders&quot;, getter_Copies(localFoldersName));</span>
<a href="#l16.14"></a><span id="l16.14"> }</span>
<a href="#l16.15"></a><span id="l16.15"> </span>
<a href="#l16.16"></a><span id="l16.16"> NS_IMETHODIMP</span>
<a href="#l16.17"></a><span id="l16.17"> nsMsgAccountManager::CreateLocalMailAccount()</span>
<a href="#l16.18"></a><span id="l16.18"> {</span>
<a href="#l16.19"></a><span id="l16.19">   // create the server</span>
<a href="#l16.20"></a><span id="l16.20">   nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l16.21"></a><span id="l16.21">   nsresult rv = CreateIncomingServer(NS_LITERAL_CSTRING(&quot;nobody&quot;),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/base/src/nsMsgAccountManagerDS.cpp</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgAccountManagerDS.cpp</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -149,17 +149,17 @@ nsMsgAccountManagerDataSource::nsMsgAcco</span>
<a href="#l17.4"></a><span id="l17.4">     getRDFService()-&gt;GetResource(NS_LITERAL_CSTRING(NC_RDF_PAGETITLE_SMTP),</span>
<a href="#l17.5"></a><span id="l17.5">                                  &amp;kNC_PageTitleSMTP);</span>
<a href="#l17.6"></a><span id="l17.6">     getRDFService()-&gt;GetResource(NS_LITERAL_CSTRING(NC_RDF_PAGETITLE_JUNK),</span>
<a href="#l17.7"></a><span id="l17.7">                                  &amp;kNC_PageTitleJunk);</span>
<a href="#l17.8"></a><span id="l17.8"> </span>
<a href="#l17.9"></a><span id="l17.9">     getRDFService()-&gt;GetResource(NS_LITERAL_CSTRING(NC_RDF_ACCOUNTROOT),</span>
<a href="#l17.10"></a><span id="l17.10">                                  &amp;kNC_AccountRoot);</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-    getRDFService()-&gt;GetLiteral(MOZ_UTF16(&quot;true&quot;),</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+    getRDFService()-&gt;GetLiteral(u&quot;true&quot;,</span>
<a href="#l17.14"></a><span id="l17.14">                                 &amp;kTrueLiteral);</span>
<a href="#l17.15"></a><span id="l17.15"> </span>
<a href="#l17.16"></a><span id="l17.16">     // eventually these need to exist in some kind of array</span>
<a href="#l17.17"></a><span id="l17.17">     // that's easily extensible</span>
<a href="#l17.18"></a><span id="l17.18">     getRDFService()-&gt;GetResource(NS_LITERAL_CSTRING(NC_RDF_SETTINGS), &amp;kNC_Settings);</span>
<a href="#l17.19"></a><span id="l17.19"> </span>
<a href="#l17.20"></a><span id="l17.20">     kDefaultServerAtom = MsgNewAtom(&quot;DefaultServer&quot;).take();</span>
<a href="#l17.21"></a><span id="l17.21">   }</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineat">@@ -276,36 +276,36 @@ nsMsgAccountManagerDataSource::GetTarget</span>
<a href="#l17.23"></a><span id="l17.23">   if (property == kNC_Name || property == kNC_FolderTreeName ||</span>
<a href="#l17.24"></a><span id="l17.24">       property == kNC_FolderTreeSimpleName) </span>
<a href="#l17.25"></a><span id="l17.25">   {</span>
<a href="#l17.26"></a><span id="l17.26">     rv = getStringBundle();</span>
<a href="#l17.27"></a><span id="l17.27">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l17.28"></a><span id="l17.28"> </span>
<a href="#l17.29"></a><span id="l17.29">     nsString pageTitle;</span>
<a href="#l17.30"></a><span id="l17.30">     if (source == kNC_PageTitleServer)</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;prefPanel-server&quot;),</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(u&quot;prefPanel-server&quot;,</span>
<a href="#l17.33"></a><span id="l17.33">                                        getter_Copies(pageTitle));</span>
<a href="#l17.34"></a><span id="l17.34"> </span>
<a href="#l17.35"></a><span id="l17.35">     else if (source == kNC_PageTitleCopies)</span>
<a href="#l17.36"></a><span id="l17.36" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;prefPanel-copies&quot;),</span>
<a href="#l17.37"></a><span id="l17.37" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(u&quot;prefPanel-copies&quot;,</span>
<a href="#l17.38"></a><span id="l17.38">                                        getter_Copies(pageTitle));</span>
<a href="#l17.39"></a><span id="l17.39">     else if (source == kNC_PageTitleSynchronization)</span>
<a href="#l17.40"></a><span id="l17.40" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;prefPanel-synchronization&quot;),</span>
<a href="#l17.41"></a><span id="l17.41" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(u&quot;prefPanel-synchronization&quot;,</span>
<a href="#l17.42"></a><span id="l17.42">                                        getter_Copies(pageTitle));</span>
<a href="#l17.43"></a><span id="l17.43">     else if (source == kNC_PageTitleDiskSpace)</span>
<a href="#l17.44"></a><span id="l17.44" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;prefPanel-diskspace&quot;),</span>
<a href="#l17.45"></a><span id="l17.45" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(u&quot;prefPanel-diskspace&quot;,</span>
<a href="#l17.46"></a><span id="l17.46">                                        getter_Copies(pageTitle));</span>
<a href="#l17.47"></a><span id="l17.47">     else if (source == kNC_PageTitleAddressing)</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;prefPanel-addressing&quot;),</span>
<a href="#l17.49"></a><span id="l17.49" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(u&quot;prefPanel-addressing&quot;,</span>
<a href="#l17.50"></a><span id="l17.50">                                        getter_Copies(pageTitle));</span>
<a href="#l17.51"></a><span id="l17.51">     else if (source == kNC_PageTitleSMTP)</span>
<a href="#l17.52"></a><span id="l17.52" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;prefPanel-smtp&quot;),</span>
<a href="#l17.53"></a><span id="l17.53" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(u&quot;prefPanel-smtp&quot;,</span>
<a href="#l17.54"></a><span id="l17.54">                                        getter_Copies(pageTitle));</span>
<a href="#l17.55"></a><span id="l17.55">     else if (source == kNC_PageTitleJunk)</span>
<a href="#l17.56"></a><span id="l17.56" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;prefPanel-junk&quot;),</span>
<a href="#l17.57"></a><span id="l17.57" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(u&quot;prefPanel-junk&quot;,</span>
<a href="#l17.58"></a><span id="l17.58">                                        getter_Copies(pageTitle));</span>
<a href="#l17.59"></a><span id="l17.59"> </span>
<a href="#l17.60"></a><span id="l17.60">     else {</span>
<a href="#l17.61"></a><span id="l17.61">       // if it's a server, use the pretty name</span>
<a href="#l17.62"></a><span id="l17.62">       nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryInterface(source, &amp;rv);</span>
<a href="#l17.63"></a><span id="l17.63">       if (NS_SUCCEEDED(rv) &amp;&amp; folder) {</span>
<a href="#l17.64"></a><span id="l17.64">         bool isServer;</span>
<a href="#l17.65"></a><span id="l17.65">         rv = folder-&gt;GetIsServer(&amp;isServer);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -152,26 +152,26 @@ nsMsgDBView::nsMsgDBView()</span>
<a href="#l18.4"></a><span id="l18.4"> }</span>
<a href="#l18.5"></a><span id="l18.5"> </span>
<a href="#l18.6"></a><span id="l18.6"> void nsMsgDBView::InitializeAtomsAndLiterals()</span>
<a href="#l18.7"></a><span id="l18.7"> {</span>
<a href="#l18.8"></a><span id="l18.8">   kJunkMsgAtom = MsgNewAtom(&quot;junk&quot;).take();</span>
<a href="#l18.9"></a><span id="l18.9">   kNotJunkMsgAtom = MsgNewAtom(&quot;notjunk&quot;).take();</span>
<a href="#l18.10"></a><span id="l18.10"> </span>
<a href="#l18.11"></a><span id="l18.11">   // priority strings</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-  kHighestPriorityString = GetString(MOZ_UTF16(&quot;priorityHighest&quot;));</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">-  kHighPriorityString = GetString(MOZ_UTF16(&quot;priorityHigh&quot;));</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineminus">-  kLowestPriorityString = GetString(MOZ_UTF16(&quot;priorityLowest&quot;));</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineminus">-  kLowPriorityString = GetString(MOZ_UTF16(&quot;priorityLow&quot;));</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineminus">-  kNormalPriorityString = GetString(MOZ_UTF16(&quot;priorityNormal&quot;));</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineminus">-</span>
<a href="#l18.18"></a><span id="l18.18" class="difflineminus">-  kReadString = GetString(MOZ_UTF16(&quot;read&quot;));</span>
<a href="#l18.19"></a><span id="l18.19" class="difflineminus">-  kRepliedString = GetString(MOZ_UTF16(&quot;replied&quot;));</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineminus">-  kForwardedString = GetString(MOZ_UTF16(&quot;forwarded&quot;));</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineminus">-  kNewString = GetString(MOZ_UTF16(&quot;new&quot;));</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineplus">+  kHighestPriorityString = GetString(u&quot;priorityHighest&quot;);</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineplus">+  kHighPriorityString = GetString(u&quot;priorityHigh&quot;);</span>
<a href="#l18.24"></a><span id="l18.24" class="difflineplus">+  kLowestPriorityString = GetString(u&quot;priorityLowest&quot;);</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineplus">+  kLowPriorityString = GetString(u&quot;priorityLow&quot;);</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineplus">+  kNormalPriorityString = GetString(u&quot;priorityNormal&quot;);</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineplus">+</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineplus">+  kReadString = GetString(u&quot;read&quot;);</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineplus">+  kRepliedString = GetString(u&quot;replied&quot;);</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineplus">+  kForwardedString = GetString(u&quot;forwarded&quot;);</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+  kNewString = GetString(u&quot;new&quot;);</span>
<a href="#l18.32"></a><span id="l18.32"> }</span>
<a href="#l18.33"></a><span id="l18.33"> </span>
<a href="#l18.34"></a><span id="l18.34"> nsMsgDBView::~nsMsgDBView()</span>
<a href="#l18.35"></a><span id="l18.35"> {</span>
<a href="#l18.36"></a><span id="l18.36">   if (m_db)</span>
<a href="#l18.37"></a><span id="l18.37">     m_db-&gt;RemoveListener(this);</span>
<a href="#l18.38"></a><span id="l18.38"> </span>
<a href="#l18.39"></a><span id="l18.39">   gInstanceCount--;</span>
<a href="#l18.40"></a><span id="l18.40" class="difflineat">@@ -1725,24 +1725,24 @@ NS_IMETHODIMP nsMsgDBView::GetCellValue(</span>
<a href="#l18.41"></a><span id="l18.41">   aValue.Truncate();</span>
<a href="#l18.42"></a><span id="l18.42">   // provide a string &quot;value&quot; for cells that do not normally have text.</span>
<a href="#l18.43"></a><span id="l18.43">   // use empty string for the normal states &quot;Read&quot;, &quot;Not Starred&quot;, &quot;No Attachment&quot; and &quot;Not Junk&quot;</span>
<a href="#l18.44"></a><span id="l18.44">   switch (colID[0])</span>
<a href="#l18.45"></a><span id="l18.45">   {</span>
<a href="#l18.46"></a><span id="l18.46">     case 'a': // attachment column</span>
<a href="#l18.47"></a><span id="l18.47">       if (flags &amp; nsMsgMessageFlags::Attachment) {</span>
<a href="#l18.48"></a><span id="l18.48">         nsString tmp_str;</span>
<a href="#l18.49"></a><span id="l18.49" class="difflineminus">-        tmp_str.Adopt(GetString(MOZ_UTF16(&quot;messageHasAttachment&quot;)));</span>
<a href="#l18.50"></a><span id="l18.50" class="difflineplus">+        tmp_str.Adopt(GetString(u&quot;messageHasAttachment&quot;));</span>
<a href="#l18.51"></a><span id="l18.51">         aValue.Assign(tmp_str);</span>
<a href="#l18.52"></a><span id="l18.52">       }</span>
<a href="#l18.53"></a><span id="l18.53">       break;</span>
<a href="#l18.54"></a><span id="l18.54">     case 'f': // flagged (starred) column</span>
<a href="#l18.55"></a><span id="l18.55">       if (flags &amp; nsMsgMessageFlags::Marked) {</span>
<a href="#l18.56"></a><span id="l18.56">         nsString tmp_str;</span>
<a href="#l18.57"></a><span id="l18.57" class="difflineminus">-        tmp_str.Adopt(GetString(MOZ_UTF16(&quot;messageHasFlag&quot;)));</span>
<a href="#l18.58"></a><span id="l18.58" class="difflineplus">+        tmp_str.Adopt(GetString(u&quot;messageHasFlag&quot;));</span>
<a href="#l18.59"></a><span id="l18.59">         aValue.Assign(tmp_str);</span>
<a href="#l18.60"></a><span id="l18.60">       }</span>
<a href="#l18.61"></a><span id="l18.61">       break;</span>
<a href="#l18.62"></a><span id="l18.62">     case 'j': // junk column</span>
<a href="#l18.63"></a><span id="l18.63">       if (JunkControlsEnabled(aRow))</span>
<a href="#l18.64"></a><span id="l18.64">       {</span>
<a href="#l18.65"></a><span id="l18.65">         nsCString junkScoreStr;</span>
<a href="#l18.66"></a><span id="l18.66">         msgHdr-&gt;GetStringProperty(&quot;junkscore&quot;, getter_Copies(junkScoreStr));</span>
<a href="#l18.67"></a><span id="l18.67" class="difflineat">@@ -1764,27 +1764,27 @@ NS_IMETHODIMP nsMsgDBView::GetCellValue(</span>
<a href="#l18.68"></a><span id="l18.68">         {</span>
<a href="#l18.69"></a><span id="l18.69">           IsContainerEmpty(aRow, &amp;isContainerEmpty);</span>
<a href="#l18.70"></a><span id="l18.70">           if (!isContainerEmpty)</span>
<a href="#l18.71"></a><span id="l18.71">           {</span>
<a href="#l18.72"></a><span id="l18.72">             nsString tmp_str;</span>
<a href="#l18.73"></a><span id="l18.73"> </span>
<a href="#l18.74"></a><span id="l18.74">             IsContainerOpen(aRow, &amp;isContainerOpen);</span>
<a href="#l18.75"></a><span id="l18.75">             tmp_str.Adopt(GetString(isContainerOpen ?</span>
<a href="#l18.76"></a><span id="l18.76" class="difflineminus">-                            MOZ_UTF16(&quot;messageExpanded&quot;) :</span>
<a href="#l18.77"></a><span id="l18.77" class="difflineminus">-                            MOZ_UTF16(&quot;messageCollapsed&quot;)));</span>
<a href="#l18.78"></a><span id="l18.78" class="difflineplus">+                            u&quot;messageExpanded&quot; :</span>
<a href="#l18.79"></a><span id="l18.79" class="difflineplus">+                            u&quot;messageCollapsed&quot;));</span>
<a href="#l18.80"></a><span id="l18.80">             aValue.Assign(tmp_str);</span>
<a href="#l18.81"></a><span id="l18.81">           }</span>
<a href="#l18.82"></a><span id="l18.82">         }</span>
<a href="#l18.83"></a><span id="l18.83">       }</span>
<a href="#l18.84"></a><span id="l18.84">       break;</span>
<a href="#l18.85"></a><span id="l18.85">     case 'u': // read/unread column</span>
<a href="#l18.86"></a><span id="l18.86">       if (!(flags &amp; nsMsgMessageFlags::Read)) {</span>
<a href="#l18.87"></a><span id="l18.87">         nsString tmp_str;</span>
<a href="#l18.88"></a><span id="l18.88" class="difflineminus">-        tmp_str.Adopt(GetString(MOZ_UTF16(&quot;messageUnread&quot;)));</span>
<a href="#l18.89"></a><span id="l18.89" class="difflineplus">+        tmp_str.Adopt(GetString(u&quot;messageUnread&quot;));</span>
<a href="#l18.90"></a><span id="l18.90">         aValue.Assign(tmp_str);</span>
<a href="#l18.91"></a><span id="l18.91">       }</span>
<a href="#l18.92"></a><span id="l18.92">       break;</span>
<a href="#l18.93"></a><span id="l18.93">     default:</span>
<a href="#l18.94"></a><span id="l18.94">       aValue.Assign(colID);</span>
<a href="#l18.95"></a><span id="l18.95">       break;</span>
<a href="#l18.96"></a><span id="l18.96">   }</span>
<a href="#l18.97"></a><span id="l18.97">   return rv;</span>
<a href="#l18.98"></a><span id="l18.98" class="difflineat">@@ -3225,19 +3225,19 @@ nsresult nsMsgDBView::DeleteMessages(nsI</span>
<a href="#l18.99"></a><span id="l18.99">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l18.100"></a><span id="l18.100">     bool dontAsk = false; // &quot;Don't ask...&quot; - unchecked by default.</span>
<a href="#l18.101"></a><span id="l18.101">     int32_t buttonPressed = 0;</span>
<a href="#l18.102"></a><span id="l18.102"> </span>
<a href="#l18.103"></a><span id="l18.103">     nsString dialogTitle;</span>
<a href="#l18.104"></a><span id="l18.104">     nsString confirmString;</span>
<a href="#l18.105"></a><span id="l18.105">     nsString checkboxText;</span>
<a href="#l18.106"></a><span id="l18.106">     nsString buttonApplyNowText;</span>
<a href="#l18.107"></a><span id="l18.107" class="difflineminus">-    dialogTitle.Adopt(GetString(MOZ_UTF16(&quot;confirmMsgDelete.title&quot;)));</span>
<a href="#l18.108"></a><span id="l18.108" class="difflineminus">-    checkboxText.Adopt(GetString(MOZ_UTF16(&quot;confirmMsgDelete.dontAsk.label&quot;)));</span>
<a href="#l18.109"></a><span id="l18.109" class="difflineminus">-    buttonApplyNowText.Adopt(GetString(MOZ_UTF16(&quot;confirmMsgDelete.delete.label&quot;)));</span>
<a href="#l18.110"></a><span id="l18.110" class="difflineplus">+    dialogTitle.Adopt(GetString(u&quot;confirmMsgDelete.title&quot;));</span>
<a href="#l18.111"></a><span id="l18.111" class="difflineplus">+    checkboxText.Adopt(GetString(u&quot;confirmMsgDelete.dontAsk.label&quot;));</span>
<a href="#l18.112"></a><span id="l18.112" class="difflineplus">+    buttonApplyNowText.Adopt(GetString(u&quot;confirmMsgDelete.delete.label&quot;));</span>
<a href="#l18.113"></a><span id="l18.113"> </span>
<a href="#l18.114"></a><span id="l18.114">     confirmString.Adopt(GetString(warningName.get()));</span>
<a href="#l18.115"></a><span id="l18.115"> </span>
<a href="#l18.116"></a><span id="l18.116">     const uint32_t buttonFlags =</span>
<a href="#l18.117"></a><span id="l18.117">       (nsIPrompt::BUTTON_TITLE_IS_STRING * nsIPrompt::BUTTON_POS_0) +</span>
<a href="#l18.118"></a><span id="l18.118">       (nsIPrompt::BUTTON_TITLE_CANCEL * nsIPrompt::BUTTON_POS_1);</span>
<a href="#l18.119"></a><span id="l18.119">     rv = dialog-&gt;ConfirmEx(dialogTitle.get(), confirmString.get(), buttonFlags,</span>
<a href="#l18.120"></a><span id="l18.120">                            buttonApplyNowText.get(), nullptr, nullptr,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/base/src/nsMsgFolderCompactor.cpp</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgFolderCompactor.cpp</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -656,17 +656,17 @@ void nsFolderCompactState::ShowDoneStatu</span>
<a href="#l19.4"></a><span id="l19.4">   {</span>
<a href="#l19.5"></a><span id="l19.5">     nsString statusString;</span>
<a href="#l19.6"></a><span id="l19.6">     nsCOMPtr &lt;nsIStringBundle&gt; bundle;</span>
<a href="#l19.7"></a><span id="l19.7">     nsresult rv = GetBaseStringBundle(getter_AddRefs(bundle));</span>
<a href="#l19.8"></a><span id="l19.8">     NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l19.9"></a><span id="l19.9">     nsAutoString expungedAmount;</span>
<a href="#l19.10"></a><span id="l19.10">     FormatFileSize(m_totalExpungedBytes, true, expungedAmount);</span>
<a href="#l19.11"></a><span id="l19.11">     const char16_t* params[] = { expungedAmount.get() };</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-    rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;compactingDone&quot;),</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+    rv = bundle-&gt;FormatStringFromName(u&quot;compactingDone&quot;,</span>
<a href="#l19.14"></a><span id="l19.14">                                       params, 1, getter_Copies(statusString));</span>
<a href="#l19.15"></a><span id="l19.15"> </span>
<a href="#l19.16"></a><span id="l19.16">     if (!statusString.IsEmpty() &amp;&amp; NS_SUCCEEDED(rv))</span>
<a href="#l19.17"></a><span id="l19.17">       ShowStatusMsg(statusString);</span>
<a href="#l19.18"></a><span id="l19.18">   }</span>
<a href="#l19.19"></a><span id="l19.19"> }</span>
<a href="#l19.20"></a><span id="l19.20"> </span>
<a href="#l19.21"></a><span id="l19.21"> nsresult</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mailnews/base/src/nsMsgFolderDataSource.cpp</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgFolderDataSource.cpp</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -276,19 +276,19 @@ nsMsgFolderDataSource::~nsMsgFolderDataS</span>
<a href="#l20.4"></a><span id="l20.4">     NS_RELEASE(kIsSecureAtom);</span>
<a href="#l20.5"></a><span id="l20.5">     NS_RELEASE(kCanFileMessagesAtom);</span>
<a href="#l20.6"></a><span id="l20.6">     NS_RELEASE(kInVFEditSearchScopeAtom);</span>
<a href="#l20.7"></a><span id="l20.7">   }</span>
<a href="#l20.8"></a><span id="l20.8"> }</span>
<a href="#l20.9"></a><span id="l20.9"> </span>
<a href="#l20.10"></a><span id="l20.10"> nsresult nsMsgFolderDataSource::CreateLiterals(nsIRDFService *rdf)</span>
<a href="#l20.11"></a><span id="l20.11"> {</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-  createNode(MOZ_UTF16(&quot;true&quot;),</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+  createNode(u&quot;true&quot;,</span>
<a href="#l20.14"></a><span id="l20.14">     getter_AddRefs(kTrueLiteral), rdf);</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineminus">-  createNode(MOZ_UTF16(&quot;false&quot;),</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineplus">+  createNode(u&quot;false&quot;,</span>
<a href="#l20.17"></a><span id="l20.17">     getter_AddRefs(kFalseLiteral), rdf);</span>
<a href="#l20.18"></a><span id="l20.18"> </span>
<a href="#l20.19"></a><span id="l20.19">   return NS_OK;</span>
<a href="#l20.20"></a><span id="l20.20"> }</span>
<a href="#l20.21"></a><span id="l20.21"> </span>
<a href="#l20.22"></a><span id="l20.22"> nsresult nsMsgFolderDataSource::Init()</span>
<a href="#l20.23"></a><span id="l20.23"> {</span>
<a href="#l20.24"></a><span id="l20.24">   nsresult rv;</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineat">@@ -1036,17 +1036,17 @@ nsresult nsMsgFolderDataSource::createFo</span>
<a href="#l20.26"></a><span id="l20.26"> </span>
<a href="#l20.27"></a><span id="l20.27"> nsresult nsMsgFolderDataSource::CreateUnreadMessagesNameString(int32_t unreadMessages, nsAutoString &amp;nameString)</span>
<a href="#l20.28"></a><span id="l20.28"> {</span>
<a href="#l20.29"></a><span id="l20.29">   //Only do this if unread messages are positive</span>
<a href="#l20.30"></a><span id="l20.30">   if(unreadMessages &gt; 0)</span>
<a href="#l20.31"></a><span id="l20.31">   {</span>
<a href="#l20.32"></a><span id="l20.32">     nameString.Append(NS_LITERAL_STRING(&quot; (&quot;));</span>
<a href="#l20.33"></a><span id="l20.33">     nameString.AppendInt(unreadMessages);</span>
<a href="#l20.34"></a><span id="l20.34" class="difflineminus">-    nameString.Append(MOZ_UTF16(')'));</span>
<a href="#l20.35"></a><span id="l20.35" class="difflineplus">+    nameString.Append(u')');</span>
<a href="#l20.36"></a><span id="l20.36">   }</span>
<a href="#l20.37"></a><span id="l20.37">   return NS_OK;</span>
<a href="#l20.38"></a><span id="l20.38"> }</span>
<a href="#l20.39"></a><span id="l20.39"> </span>
<a href="#l20.40"></a><span id="l20.40"> nsresult</span>
<a href="#l20.41"></a><span id="l20.41"> nsMsgFolderDataSource::createFolderSpecialNode(nsIMsgFolder *folder,</span>
<a href="#l20.42"></a><span id="l20.42">                                                nsIRDFNode **target)</span>
<a href="#l20.43"></a><span id="l20.43"> {</span>
<a href="#l20.44"></a><span id="l20.44" class="difflineat">@@ -1498,23 +1498,23 @@ nsMsgFolderDataSource::createBiffStateNo</span>
<a href="#l20.45"></a><span id="l20.45"> </span>
<a href="#l20.46"></a><span id="l20.46"> nsresult</span>
<a href="#l20.47"></a><span id="l20.47"> nsMsgFolderDataSource::createBiffStateNodeFromFlag(uint32_t flag, nsIRDFNode **target)</span>
<a href="#l20.48"></a><span id="l20.48"> {</span>
<a href="#l20.49"></a><span id="l20.49">   const char16_t *biffStateStr;</span>
<a href="#l20.50"></a><span id="l20.50"> </span>
<a href="#l20.51"></a><span id="l20.51">   switch (flag) {</span>
<a href="#l20.52"></a><span id="l20.52">     case nsIMsgFolder::nsMsgBiffState_NewMail:</span>
<a href="#l20.53"></a><span id="l20.53" class="difflineminus">-      biffStateStr = MOZ_UTF16(&quot;NewMail&quot;);</span>
<a href="#l20.54"></a><span id="l20.54" class="difflineplus">+      biffStateStr = u&quot;NewMail&quot;;</span>
<a href="#l20.55"></a><span id="l20.55">       break;</span>
<a href="#l20.56"></a><span id="l20.56">     case nsIMsgFolder::nsMsgBiffState_NoMail:</span>
<a href="#l20.57"></a><span id="l20.57" class="difflineminus">-      biffStateStr = MOZ_UTF16(&quot;NoMail&quot;);</span>
<a href="#l20.58"></a><span id="l20.58" class="difflineplus">+      biffStateStr = u&quot;NoMail&quot;;</span>
<a href="#l20.59"></a><span id="l20.59">       break;</span>
<a href="#l20.60"></a><span id="l20.60">     default:</span>
<a href="#l20.61"></a><span id="l20.61" class="difflineminus">-      biffStateStr = MOZ_UTF16(&quot;UnknownMail&quot;);</span>
<a href="#l20.62"></a><span id="l20.62" class="difflineplus">+      biffStateStr = u&quot;UnknownMail&quot;;</span>
<a href="#l20.63"></a><span id="l20.63">       break;</span>
<a href="#l20.64"></a><span id="l20.64">   }</span>
<a href="#l20.65"></a><span id="l20.65"> </span>
<a href="#l20.66"></a><span id="l20.66">   createNode(biffStateStr, target, getRDFService());</span>
<a href="#l20.67"></a><span id="l20.67">   return NS_OK;</span>
<a href="#l20.68"></a><span id="l20.68"> }</span>
<a href="#l20.69"></a><span id="l20.69"> </span>
<a href="#l20.70"></a><span id="l20.70"> nsresult</span>
<a href="#l20.71"></a><span id="l20.71" class="difflineat">@@ -1777,32 +1777,32 @@ nsMsgFolderDataSource::OnTotalMessagePro</span>
<a href="#l20.72"></a><span id="l20.72">   return NS_OK;</span>
<a href="#l20.73"></a><span id="l20.73"> }</span>
<a href="#l20.74"></a><span id="l20.74"> </span>
<a href="#l20.75"></a><span id="l20.75"> nsresult</span>
<a href="#l20.76"></a><span id="l20.76"> nsMsgFolderDataSource::GetNumMessagesNode(int32_t aNumMessages, nsIRDFNode **node)</span>
<a href="#l20.77"></a><span id="l20.77"> {</span>
<a href="#l20.78"></a><span id="l20.78">   uint32_t numMessages = aNumMessages;</span>
<a href="#l20.79"></a><span id="l20.79">   if(numMessages == kDisplayQuestionCount)</span>
<a href="#l20.80"></a><span id="l20.80" class="difflineminus">-    createNode(MOZ_UTF16(&quot;???&quot;), node, getRDFService());</span>
<a href="#l20.81"></a><span id="l20.81" class="difflineplus">+    createNode(u&quot;???&quot;, node, getRDFService());</span>
<a href="#l20.82"></a><span id="l20.82">   else if (numMessages == kDisplayBlankCount || numMessages == 0)</span>
<a href="#l20.83"></a><span id="l20.83">     createNode(EmptyString().get(), node, getRDFService());</span>
<a href="#l20.84"></a><span id="l20.84">   else</span>
<a href="#l20.85"></a><span id="l20.85">     createIntNode(numMessages, node, getRDFService());</span>
<a href="#l20.86"></a><span id="l20.86">   return NS_OK;</span>
<a href="#l20.87"></a><span id="l20.87"> }</span>
<a href="#l20.88"></a><span id="l20.88"> </span>
<a href="#l20.89"></a><span id="l20.89"> nsresult</span>
<a href="#l20.90"></a><span id="l20.90"> nsMsgFolderDataSource::GetFolderSizeNode(int64_t aFolderSize, nsIRDFNode **aNode)</span>
<a href="#l20.91"></a><span id="l20.91"> {</span>
<a href="#l20.92"></a><span id="l20.92">   nsresult rv;</span>
<a href="#l20.93"></a><span id="l20.93">   if (aFolderSize == kDisplayBlankCount64 || aFolderSize == 0)</span>
<a href="#l20.94"></a><span id="l20.94">     createNode(EmptyString().get(), aNode, getRDFService());</span>
<a href="#l20.95"></a><span id="l20.95">   else if (aFolderSize == kDisplayQuestionCount64)</span>
<a href="#l20.96"></a><span id="l20.96" class="difflineminus">-    createNode(MOZ_UTF16(&quot;???&quot;), aNode, getRDFService());</span>
<a href="#l20.97"></a><span id="l20.97" class="difflineplus">+    createNode(u&quot;???&quot;, aNode, getRDFService());</span>
<a href="#l20.98"></a><span id="l20.98">   else</span>
<a href="#l20.99"></a><span id="l20.99">   {</span>
<a href="#l20.100"></a><span id="l20.100">     nsAutoString sizeString;</span>
<a href="#l20.101"></a><span id="l20.101">     rv = FormatFileSize(aFolderSize, true, sizeString);</span>
<a href="#l20.102"></a><span id="l20.102">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l20.103"></a><span id="l20.103"> </span>
<a href="#l20.104"></a><span id="l20.104">     createNode(sizeString.get(), aNode, getRDFService());</span>
<a href="#l20.105"></a><span id="l20.105">   }</span>
<a href="#l20.106"></a><span id="l20.106" class="difflineat">@@ -1967,17 +1967,17 @@ nsresult nsMsgFolderDataSource::DoDelete</span>
<a href="#l20.107"></a><span id="l20.107">         NS_ENSURE_ARG_POINTER(msgWindow);</span>
<a href="#l20.108"></a><span id="l20.108">         nsCOMPtr&lt;nsIStringBundleService&gt; sBundleService =</span>
<a href="#l20.109"></a><span id="l20.109">           mozilla::services::GetStringBundleService();</span>
<a href="#l20.110"></a><span id="l20.110">         NS_ENSURE_TRUE(sBundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l20.111"></a><span id="l20.111">         nsCOMPtr&lt;nsIStringBundle&gt; sMessengerStringBundle;</span>
<a href="#l20.112"></a><span id="l20.112">         nsString confirmMsg;</span>
<a href="#l20.113"></a><span id="l20.113">         rv = sBundleService-&gt;CreateBundle(MESSENGER_STRING_URL, getter_AddRefs(sMessengerStringBundle));</span>
<a href="#l20.114"></a><span id="l20.114">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l20.115"></a><span id="l20.115" class="difflineminus">-        sMessengerStringBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;confirmSavedSearchDeleteMessage&quot;), getter_Copies(confirmMsg));</span>
<a href="#l20.116"></a><span id="l20.116" class="difflineplus">+        sMessengerStringBundle-&gt;GetStringFromName(u&quot;confirmSavedSearchDeleteMessage&quot;, getter_Copies(confirmMsg));</span>
<a href="#l20.117"></a><span id="l20.117"> </span>
<a href="#l20.118"></a><span id="l20.118">         nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l20.119"></a><span id="l20.119">         rv = msgWindow-&gt;GetPromptDialog(getter_AddRefs(dialog));</span>
<a href="#l20.120"></a><span id="l20.120">         if (NS_SUCCEEDED(rv))</span>
<a href="#l20.121"></a><span id="l20.121">         {</span>
<a href="#l20.122"></a><span id="l20.122">           bool dialogResult;</span>
<a href="#l20.123"></a><span id="l20.123">           rv = dialog-&gt;Confirm(nullptr, confirmMsg.get(), &amp;dialogResult);</span>
<a href="#l20.124"></a><span id="l20.124">           if (!dialogResult)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mailnews/base/src/nsMsgGroupView.cpp</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgGroupView.cpp</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -800,89 +800,89 @@ NS_IMETHODIMP nsMsgGroupView::CellTextFo</span>
<a href="#l21.4"></a><span id="l21.4">         case nsMsgViewSortType::byDate:</span>
<a href="#l21.5"></a><span id="l21.5">         {</span>
<a href="#l21.6"></a><span id="l21.6">           uint32_t ageBucket = 0;</span>
<a href="#l21.7"></a><span id="l21.7">           GetAgeBucketValue(msgHdr, &amp;ageBucket, rcvDate);</span>
<a href="#l21.8"></a><span id="l21.8">           switch (ageBucket)</span>
<a href="#l21.9"></a><span id="l21.9">           {</span>
<a href="#l21.10"></a><span id="l21.10">           case 1:</span>
<a href="#l21.11"></a><span id="l21.11">             if (m_kTodayString.IsEmpty())</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-              m_kTodayString.Adopt(GetString(MOZ_UTF16(&quot;today&quot;)));</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+              m_kTodayString.Adopt(GetString(u&quot;today&quot;));</span>
<a href="#l21.14"></a><span id="l21.14">             aValue.Assign(m_kTodayString);</span>
<a href="#l21.15"></a><span id="l21.15">             break;</span>
<a href="#l21.16"></a><span id="l21.16">           case 2:</span>
<a href="#l21.17"></a><span id="l21.17">             if (m_kYesterdayString.IsEmpty())</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineminus">-              m_kYesterdayString.Adopt(GetString(MOZ_UTF16(&quot;yesterday&quot;)));</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineplus">+              m_kYesterdayString.Adopt(GetString(u&quot;yesterday&quot;));</span>
<a href="#l21.20"></a><span id="l21.20">             aValue.Assign(m_kYesterdayString);</span>
<a href="#l21.21"></a><span id="l21.21">             break;</span>
<a href="#l21.22"></a><span id="l21.22">           case 3:</span>
<a href="#l21.23"></a><span id="l21.23">             if (m_kLastWeekString.IsEmpty())</span>
<a href="#l21.24"></a><span id="l21.24" class="difflineminus">-              m_kLastWeekString.Adopt(GetString(MOZ_UTF16(&quot;lastWeek&quot;)));</span>
<a href="#l21.25"></a><span id="l21.25" class="difflineplus">+              m_kLastWeekString.Adopt(GetString(u&quot;lastWeek&quot;));</span>
<a href="#l21.26"></a><span id="l21.26">             aValue.Assign(m_kLastWeekString);</span>
<a href="#l21.27"></a><span id="l21.27">             break;</span>
<a href="#l21.28"></a><span id="l21.28">           case 4:</span>
<a href="#l21.29"></a><span id="l21.29">             if (m_kTwoWeeksAgoString.IsEmpty())</span>
<a href="#l21.30"></a><span id="l21.30" class="difflineminus">-              m_kTwoWeeksAgoString.Adopt(GetString(MOZ_UTF16(&quot;twoWeeksAgo&quot;)));</span>
<a href="#l21.31"></a><span id="l21.31" class="difflineplus">+              m_kTwoWeeksAgoString.Adopt(GetString(u&quot;twoWeeksAgo&quot;));</span>
<a href="#l21.32"></a><span id="l21.32">             aValue.Assign(m_kTwoWeeksAgoString);</span>
<a href="#l21.33"></a><span id="l21.33">             break;</span>
<a href="#l21.34"></a><span id="l21.34">           case 5:</span>
<a href="#l21.35"></a><span id="l21.35">             if (m_kOldMailString.IsEmpty())</span>
<a href="#l21.36"></a><span id="l21.36" class="difflineminus">-              m_kOldMailString.Adopt(GetString(MOZ_UTF16(&quot;older&quot;)));</span>
<a href="#l21.37"></a><span id="l21.37" class="difflineplus">+              m_kOldMailString.Adopt(GetString(u&quot;older&quot;));</span>
<a href="#l21.38"></a><span id="l21.38">             aValue.Assign(m_kOldMailString);</span>
<a href="#l21.39"></a><span id="l21.39">             break;</span>
<a href="#l21.40"></a><span id="l21.40">           default:</span>
<a href="#l21.41"></a><span id="l21.41">             // Future date, error/spoofed.</span>
<a href="#l21.42"></a><span id="l21.42">             if (m_kFutureDateString.IsEmpty())</span>
<a href="#l21.43"></a><span id="l21.43" class="difflineminus">-              m_kFutureDateString.Adopt(GetString(MOZ_UTF16(&quot;futureDate&quot;)));</span>
<a href="#l21.44"></a><span id="l21.44" class="difflineplus">+              m_kFutureDateString.Adopt(GetString(u&quot;futureDate&quot;));</span>
<a href="#l21.45"></a><span id="l21.45">             aValue.Assign(m_kFutureDateString);</span>
<a href="#l21.46"></a><span id="l21.46">             break;</span>
<a href="#l21.47"></a><span id="l21.47">           }</span>
<a href="#l21.48"></a><span id="l21.48">           break;</span>
<a href="#l21.49"></a><span id="l21.49">         }</span>
<a href="#l21.50"></a><span id="l21.50">         case nsMsgViewSortType::bySubject:</span>
<a href="#l21.51"></a><span id="l21.51">           FetchSubject(msgHdr, m_flags[aRow], aValue);</span>
<a href="#l21.52"></a><span id="l21.52">           break;</span>
<a href="#l21.53"></a><span id="l21.53">         case nsMsgViewSortType::byAuthor:</span>
<a href="#l21.54"></a><span id="l21.54">           FetchAuthor(msgHdr, aValue);</span>
<a href="#l21.55"></a><span id="l21.55">           break;</span>
<a href="#l21.56"></a><span id="l21.56">         case nsMsgViewSortType::byStatus:</span>
<a href="#l21.57"></a><span id="l21.57">           rv = FetchStatus(m_flags[aRow], aValue);</span>
<a href="#l21.58"></a><span id="l21.58">           if (aValue.IsEmpty()) {</span>
<a href="#l21.59"></a><span id="l21.59" class="difflineminus">-            tmp_str.Adopt(GetString(MOZ_UTF16(&quot;messagesWithNoStatus&quot;)));</span>
<a href="#l21.60"></a><span id="l21.60" class="difflineplus">+            tmp_str.Adopt(GetString(u&quot;messagesWithNoStatus&quot;));</span>
<a href="#l21.61"></a><span id="l21.61">             aValue.Assign(tmp_str);</span>
<a href="#l21.62"></a><span id="l21.62">           }</span>
<a href="#l21.63"></a><span id="l21.63">           break;</span>
<a href="#l21.64"></a><span id="l21.64">         case nsMsgViewSortType::byTags:</span>
<a href="#l21.65"></a><span id="l21.65">           rv = FetchTags(msgHdr, aValue);</span>
<a href="#l21.66"></a><span id="l21.66">           if (aValue.IsEmpty()) {</span>
<a href="#l21.67"></a><span id="l21.67" class="difflineminus">-            tmp_str.Adopt(GetString(MOZ_UTF16(&quot;untaggedMessages&quot;)));</span>
<a href="#l21.68"></a><span id="l21.68" class="difflineplus">+            tmp_str.Adopt(GetString(u&quot;untaggedMessages&quot;));</span>
<a href="#l21.69"></a><span id="l21.69">             aValue.Assign(tmp_str);</span>
<a href="#l21.70"></a><span id="l21.70">           }</span>
<a href="#l21.71"></a><span id="l21.71">           break;</span>
<a href="#l21.72"></a><span id="l21.72">         case nsMsgViewSortType::byPriority:</span>
<a href="#l21.73"></a><span id="l21.73">           FetchPriority(msgHdr, aValue);</span>
<a href="#l21.74"></a><span id="l21.74">           if (aValue.IsEmpty()) {</span>
<a href="#l21.75"></a><span id="l21.75" class="difflineminus">-            tmp_str.Adopt(GetString(MOZ_UTF16(&quot;noPriority&quot;)));</span>
<a href="#l21.76"></a><span id="l21.76" class="difflineplus">+            tmp_str.Adopt(GetString(u&quot;noPriority&quot;));</span>
<a href="#l21.77"></a><span id="l21.77">             aValue.Assign(tmp_str);</span>
<a href="#l21.78"></a><span id="l21.78">           }</span>
<a href="#l21.79"></a><span id="l21.79">           break;</span>
<a href="#l21.80"></a><span id="l21.80">         case nsMsgViewSortType::byAccount:</span>
<a href="#l21.81"></a><span id="l21.81">           FetchAccount(msgHdr, aValue);</span>
<a href="#l21.82"></a><span id="l21.82">           break;</span>
<a href="#l21.83"></a><span id="l21.83">         case nsMsgViewSortType::byRecipient:</span>
<a href="#l21.84"></a><span id="l21.84">           FetchRecipients(msgHdr, aValue);</span>
<a href="#l21.85"></a><span id="l21.85">           break;</span>
<a href="#l21.86"></a><span id="l21.86">         case nsMsgViewSortType::byAttachments:</span>
<a href="#l21.87"></a><span id="l21.87">           tmp_str.Adopt(GetString(flags &amp; nsMsgMessageFlags::Attachment ?</span>
<a href="#l21.88"></a><span id="l21.88" class="difflineminus">-            MOZ_UTF16(&quot;attachments&quot;) : MOZ_UTF16(&quot;noAttachments&quot;)));</span>
<a href="#l21.89"></a><span id="l21.89" class="difflineplus">+            u&quot;attachments&quot; : u&quot;noAttachments&quot;));</span>
<a href="#l21.90"></a><span id="l21.90">           aValue.Assign(tmp_str);</span>
<a href="#l21.91"></a><span id="l21.91">           break;</span>
<a href="#l21.92"></a><span id="l21.92">         case nsMsgViewSortType::byFlagged:</span>
<a href="#l21.93"></a><span id="l21.93">           tmp_str.Adopt(GetString(flags &amp; nsMsgMessageFlags::Marked ?</span>
<a href="#l21.94"></a><span id="l21.94" class="difflineminus">-            MOZ_UTF16(&quot;groupFlagged&quot;) : MOZ_UTF16(&quot;notFlagged&quot;)));</span>
<a href="#l21.95"></a><span id="l21.95" class="difflineplus">+            u&quot;groupFlagged&quot; : u&quot;notFlagged&quot;));</span>
<a href="#l21.96"></a><span id="l21.96">           aValue.Assign(tmp_str);</span>
<a href="#l21.97"></a><span id="l21.97">           break;</span>
<a href="#l21.98"></a><span id="l21.98">         // byLocation is a special case; we don't want to have duplicate</span>
<a href="#l21.99"></a><span id="l21.99">         //  all this logic in nsMsgSearchDBView, and its hash key is what we</span>
<a href="#l21.100"></a><span id="l21.100">         //  want anyways, so just copy it across.</span>
<a href="#l21.101"></a><span id="l21.101">         case nsMsgViewSortType::byLocation:</span>
<a href="#l21.102"></a><span id="l21.102">         case nsMsgViewSortType::byCorrespondent:</span>
<a href="#l21.103"></a><span id="l21.103">           aValue = hashKey;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mailnews/base/src/nsMsgPrintEngine.cpp</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgPrintEngine.cpp</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -73,17 +73,17 @@ nsMsgPrintEngine::OnStateChange(nsIWebPr</span>
<a href="#l22.4"></a><span id="l22.4"> {</span>
<a href="#l22.5"></a><span id="l22.5">   nsresult rv = NS_OK;</span>
<a href="#l22.6"></a><span id="l22.6"> </span>
<a href="#l22.7"></a><span id="l22.7">   // top-level document load data</span>
<a href="#l22.8"></a><span id="l22.8">   if (progressStateFlags &amp; nsIWebProgressListener::STATE_IS_DOCUMENT) {</span>
<a href="#l22.9"></a><span id="l22.9">     if (progressStateFlags &amp; nsIWebProgressListener::STATE_START) {</span>
<a href="#l22.10"></a><span id="l22.10">       // Tell the user we are loading...</span>
<a href="#l22.11"></a><span id="l22.11">       nsString msg;</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-      GetString(MOZ_UTF16(&quot;LoadingMessageToPrint&quot;), msg);</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+      GetString(u&quot;LoadingMessageToPrint&quot;, msg);</span>
<a href="#l22.14"></a><span id="l22.14">       SetStatusMessage(msg);</span>
<a href="#l22.15"></a><span id="l22.15">     }</span>
<a href="#l22.16"></a><span id="l22.16"> </span>
<a href="#l22.17"></a><span id="l22.17">     if (progressStateFlags &amp; nsIWebProgressListener::STATE_STOP) {</span>
<a href="#l22.18"></a><span id="l22.18">       nsCOMPtr&lt;nsIDocumentLoader&gt; docLoader(do_QueryInterface(aWebProgress));</span>
<a href="#l22.19"></a><span id="l22.19">       if (docLoader) </span>
<a href="#l22.20"></a><span id="l22.20">       {</span>
<a href="#l22.21"></a><span id="l22.21">         // Check to see if the document DOMWin that is finished loading is the same</span>
<a href="#l22.22"></a><span id="l22.22" class="difflineat">@@ -116,17 +116,17 @@ nsMsgPrintEngine::OnStateChange(nsIWebPr</span>
<a href="#l22.23"></a><span id="l22.23">         // loading the documents. If it is NULL (or not a DocLoader) then it </span>
<a href="#l22.24"></a><span id="l22.24">         // it coming from Printing</span>
<a href="#l22.25"></a><span id="l22.25">         if (docLoader) {</span>
<a href="#l22.26"></a><span id="l22.26">           // Now, fire off the print operation!</span>
<a href="#l22.27"></a><span id="l22.27">           rv = NS_ERROR_FAILURE;</span>
<a href="#l22.28"></a><span id="l22.28"> </span>
<a href="#l22.29"></a><span id="l22.29">           // Tell the user the message is loaded...</span>
<a href="#l22.30"></a><span id="l22.30">           nsString msg;</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-          GetString(MOZ_UTF16(&quot;MessageLoaded&quot;), msg);</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineplus">+          GetString(u&quot;MessageLoaded&quot;, msg);</span>
<a href="#l22.33"></a><span id="l22.33">           SetStatusMessage(msg);</span>
<a href="#l22.34"></a><span id="l22.34"> </span>
<a href="#l22.35"></a><span id="l22.35">           NS_ASSERTION(mDocShell,&quot;can't print, there is no docshell&quot;);</span>
<a href="#l22.36"></a><span id="l22.36">           if ( (!mDocShell) || (!aRequest) ) </span>
<a href="#l22.37"></a><span id="l22.37">           {</span>
<a href="#l22.38"></a><span id="l22.38">             return StartNextPrintOperation();</span>
<a href="#l22.39"></a><span id="l22.39">           }</span>
<a href="#l22.40"></a><span id="l22.40">           nsCOMPtr&lt;nsIChannel&gt; aChannel = do_QueryInterface(aRequest);</span>
<a href="#l22.41"></a><span id="l22.41" class="difflineat">@@ -232,17 +232,17 @@ nsMsgPrintEngine::SetWindow(mozIDOMWindo</span>
<a href="#l22.42"></a><span id="l22.42">   nsCOMPtr&lt;nsIDocShellTreeItem&gt; docShellAsItem =</span>
<a href="#l22.43"></a><span id="l22.43">     do_QueryInterface(window-&gt;GetDocShell());</span>
<a href="#l22.44"></a><span id="l22.44">   NS_ENSURE_TRUE(docShellAsItem, NS_ERROR_FAILURE);</span>
<a href="#l22.45"></a><span id="l22.45"> </span>
<a href="#l22.46"></a><span id="l22.46">   nsCOMPtr&lt;nsIDocShellTreeItem&gt; rootAsItem;</span>
<a href="#l22.47"></a><span id="l22.47">   docShellAsItem-&gt;GetSameTypeRootTreeItem(getter_AddRefs(rootAsItem));</span>
<a href="#l22.48"></a><span id="l22.48"> </span>
<a href="#l22.49"></a><span id="l22.49">   nsCOMPtr&lt;nsIDocShellTreeItem&gt; childItem;</span>
<a href="#l22.50"></a><span id="l22.50" class="difflineminus">-  rootAsItem-&gt;FindChildWithName(MOZ_UTF16(&quot;content&quot;), true,</span>
<a href="#l22.51"></a><span id="l22.51" class="difflineplus">+  rootAsItem-&gt;FindChildWithName(u&quot;content&quot;, true,</span>
<a href="#l22.52"></a><span id="l22.52"> 				false, nullptr, nullptr,</span>
<a href="#l22.53"></a><span id="l22.53"> 				getter_AddRefs(childItem));</span>
<a href="#l22.54"></a><span id="l22.54"> </span>
<a href="#l22.55"></a><span id="l22.55">   mDocShell = do_QueryInterface(childItem);</span>
<a href="#l22.56"></a><span id="l22.56"> </span>
<a href="#l22.57"></a><span id="l22.57">   if(mDocShell)</span>
<a href="#l22.58"></a><span id="l22.58">     SetupObserver();</span>
<a href="#l22.59"></a><span id="l22.59"> </span>
<a href="#l22.60"></a><span id="l22.60" class="difflineat">@@ -306,17 +306,17 @@ nsMsgPrintEngine::SetPrintURICount(int32</span>
<a href="#l22.61"></a><span id="l22.61"> </span>
<a href="#l22.62"></a><span id="l22.62"> NS_IMETHODIMP</span>
<a href="#l22.63"></a><span id="l22.63"> nsMsgPrintEngine::StartPrintOperation(nsIPrintSettings* aPS)</span>
<a href="#l22.64"></a><span id="l22.64"> {</span>
<a href="#l22.65"></a><span id="l22.65">   NS_ENSURE_ARG_POINTER(aPS);</span>
<a href="#l22.66"></a><span id="l22.66">   mPrintSettings = aPS;</span>
<a href="#l22.67"></a><span id="l22.67"> </span>
<a href="#l22.68"></a><span id="l22.68">   // Load the about:blank on the tail end...</span>
<a href="#l22.69"></a><span id="l22.69" class="difflineminus">-  nsresult rv = AddPrintURI(MOZ_UTF16(&quot;about:blank&quot;)); </span>
<a href="#l22.70"></a><span id="l22.70" class="difflineplus">+  nsresult rv = AddPrintURI(u&quot;about:blank&quot;); </span>
<a href="#l22.71"></a><span id="l22.71">   if (NS_FAILED(rv)) return rv; </span>
<a href="#l22.72"></a><span id="l22.72">   return StartNextPrintOperation();</span>
<a href="#l22.73"></a><span id="l22.73"> }</span>
<a href="#l22.74"></a><span id="l22.74"> </span>
<a href="#l22.75"></a><span id="l22.75"> //----------------------------------------------------------------------</span>
<a href="#l22.76"></a><span id="l22.76"> // Set up to use the &quot;pluggable&quot; Print Progress Dialog</span>
<a href="#l22.77"></a><span id="l22.77"> nsresult</span>
<a href="#l22.78"></a><span id="l22.78"> nsMsgPrintEngine::ShowProgressDialog(bool aIsForPrinting, bool&amp; aDoNotify)</span>
<a href="#l22.79"></a><span id="l22.79" class="difflineat">@@ -372,19 +372,19 @@ nsMsgPrintEngine::ShowProgressDialog(boo</span>
<a href="#l22.80"></a><span id="l22.80"> </span>
<a href="#l22.81"></a><span id="l22.81">         if (showProgressDialog) </span>
<a href="#l22.82"></a><span id="l22.82">         {</span>
<a href="#l22.83"></a><span id="l22.83">           nsIWebProgressListener* wpl = static_cast&lt;nsIWebProgressListener*&gt;(mPrintProgressListener.get());</span>
<a href="#l22.84"></a><span id="l22.84">           NS_ASSERTION(wpl, &quot;nsIWebProgressListener is NULL!&quot;);</span>
<a href="#l22.85"></a><span id="l22.85">           NS_ADDREF(wpl);</span>
<a href="#l22.86"></a><span id="l22.86">           nsString msg;</span>
<a href="#l22.87"></a><span id="l22.87">           if (mIsDoingPrintPreview) {</span>
<a href="#l22.88"></a><span id="l22.88" class="difflineminus">-            GetString(MOZ_UTF16(&quot;LoadingMailMsgForPrintPreview&quot;), msg);</span>
<a href="#l22.89"></a><span id="l22.89" class="difflineplus">+            GetString(u&quot;LoadingMailMsgForPrintPreview&quot;, msg);</span>
<a href="#l22.90"></a><span id="l22.90">           } else {</span>
<a href="#l22.91"></a><span id="l22.91" class="difflineminus">-            GetString(MOZ_UTF16(&quot;LoadingMailMsgForPrint&quot;), msg);</span>
<a href="#l22.92"></a><span id="l22.92" class="difflineplus">+            GetString(u&quot;LoadingMailMsgForPrint&quot;, msg);</span>
<a href="#l22.93"></a><span id="l22.93">           }</span>
<a href="#l22.94"></a><span id="l22.94">           if (!msg.IsEmpty()) </span>
<a href="#l22.95"></a><span id="l22.95">             mPrintProgressParams-&gt;SetDocTitle(msg.get());</span>
<a href="#l22.96"></a><span id="l22.96">         }</span>
<a href="#l22.97"></a><span id="l22.97">       }</span>
<a href="#l22.98"></a><span id="l22.98">     }</span>
<a href="#l22.99"></a><span id="l22.99">   }</span>
<a href="#l22.100"></a><span id="l22.100">   return rv;</span>
<a href="#l22.101"></a><span id="l22.101" class="difflineat">@@ -406,17 +406,17 @@ nsMsgPrintEngine::StartNextPrintOperatio</span>
<a href="#l22.102"></a><span id="l22.102">   if (mCurrentlyPrintingURI &gt;= (int32_t)mURIArray.Length())</span>
<a href="#l22.103"></a><span id="l22.103">   {</span>
<a href="#l22.104"></a><span id="l22.104">     // This is the end...dum, dum, dum....my only friend...the end</span>
<a href="#l22.105"></a><span id="l22.105">     NS_ENSURE_TRUE(mWindow, NS_ERROR_FAILURE);</span>
<a href="#l22.106"></a><span id="l22.106">     nsPIDOMWindowOuter::From(mWindow)-&gt;Close();</span>
<a href="#l22.107"></a><span id="l22.107"> </span>
<a href="#l22.108"></a><span id="l22.108">     // Tell the user we are done...</span>
<a href="#l22.109"></a><span id="l22.109">     nsString msg;</span>
<a href="#l22.110"></a><span id="l22.110" class="difflineminus">-    GetString(MOZ_UTF16(&quot;PrintingComplete&quot;), msg);</span>
<a href="#l22.111"></a><span id="l22.111" class="difflineplus">+    GetString(u&quot;PrintingComplete&quot;, msg);</span>
<a href="#l22.112"></a><span id="l22.112">     SetStatusMessage(msg);</span>
<a href="#l22.113"></a><span id="l22.113">     return NS_OK;</span>
<a href="#l22.114"></a><span id="l22.114">   }</span>
<a href="#l22.115"></a><span id="l22.115"> </span>
<a href="#l22.116"></a><span id="l22.116">   if (!mDocShell)</span>
<a href="#l22.117"></a><span id="l22.117">     return StartNextPrintOperation();</span>
<a href="#l22.118"></a><span id="l22.118"> </span>
<a href="#l22.119"></a><span id="l22.119">   const nsString &amp;uri = mURIArray[mCurrentlyPrintingURI];</span>
<a href="#l22.120"></a><span id="l22.120" class="difflineat">@@ -594,17 +594,17 @@ nsMsgPrintEngine::PrintMsgWindow()</span>
<a href="#l22.121"></a><span id="l22.121">         mWebBrowserPrint-&gt;GetGlobalPrintSettings(getter_AddRefs(mPrintSettings));</span>
<a href="#l22.122"></a><span id="l22.122">       }</span>
<a href="#l22.123"></a><span id="l22.123">       </span>
<a href="#l22.124"></a><span id="l22.124">       // fix for bug #118887 and bug #176016</span>
<a href="#l22.125"></a><span id="l22.125">       // don't show the actual url when printing mail messages or addressbook cards.</span>
<a href="#l22.126"></a><span id="l22.126">       // for mail, it can review the salt.  for addrbook, it's a data:// url, which</span>
<a href="#l22.127"></a><span id="l22.127">       // means nothing to the end user.</span>
<a href="#l22.128"></a><span id="l22.128">       // needs to be &quot; &quot; and not &quot;&quot; or nullptr, otherwise, we'll still print the url</span>
<a href="#l22.129"></a><span id="l22.129" class="difflineminus">-      mPrintSettings-&gt;SetDocURL(MOZ_UTF16(&quot; &quot;));</span>
<a href="#l22.130"></a><span id="l22.130" class="difflineplus">+      mPrintSettings-&gt;SetDocURL(u&quot; &quot;);</span>
<a href="#l22.131"></a><span id="l22.131"> </span>
<a href="#l22.132"></a><span id="l22.132">       nsresult rv = NS_ERROR_FAILURE;</span>
<a href="#l22.133"></a><span id="l22.133">       if (mIsDoingPrintPreview) </span>
<a href="#l22.134"></a><span id="l22.134">       {</span>
<a href="#l22.135"></a><span id="l22.135">         if (mStartupPPObs) {</span>
<a href="#l22.136"></a><span id="l22.136">           rv = mStartupPPObs-&gt;Observe(nullptr, nullptr, nullptr);</span>
<a href="#l22.137"></a><span id="l22.137">         }</span>
<a href="#l22.138"></a><span id="l22.138">       } </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mailnews/base/src/nsMsgStatusFeedback.cpp</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgStatusFeedback.cpp</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -82,17 +82,17 @@ nsMsgStatusFeedback::OnStateChange(nsIWe</span>
<a href="#l23.4"></a><span id="l23.4">   NS_ENSURE_TRUE(mBundle, NS_ERROR_NULL_POINTER);</span>
<a href="#l23.5"></a><span id="l23.5">   if (aProgressStateFlags &amp; STATE_IS_NETWORK)</span>
<a href="#l23.6"></a><span id="l23.6">   {</span>
<a href="#l23.7"></a><span id="l23.7">     if (aProgressStateFlags &amp; STATE_START)</span>
<a href="#l23.8"></a><span id="l23.8">     {</span>
<a href="#l23.9"></a><span id="l23.9">       m_lastPercent = 0;</span>
<a href="#l23.10"></a><span id="l23.10">       StartMeteors();</span>
<a href="#l23.11"></a><span id="l23.11">       nsString loadingDocument;</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-      rv = mBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;documentLoading&quot;),</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+      rv = mBundle-&gt;GetStringFromName(u&quot;documentLoading&quot;,</span>
<a href="#l23.14"></a><span id="l23.14">                                       getter_Copies(loadingDocument));</span>
<a href="#l23.15"></a><span id="l23.15">       if (NS_SUCCEEDED(rv))</span>
<a href="#l23.16"></a><span id="l23.16">         ShowStatusString(loadingDocument);</span>
<a href="#l23.17"></a><span id="l23.17">     }</span>
<a href="#l23.18"></a><span id="l23.18">     else if (aProgressStateFlags &amp; STATE_STOP)</span>
<a href="#l23.19"></a><span id="l23.19">     {</span>
<a href="#l23.20"></a><span id="l23.20">       // if we are loading message for display purposes, this STATE_STOP notification is </span>
<a href="#l23.21"></a><span id="l23.21">       // the only notification we get when layout is actually done rendering the message. We need</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineat">@@ -136,17 +136,17 @@ nsMsgStatusFeedback::OnStateChange(nsIWe</span>
<a href="#l23.23"></a><span id="l23.23">               if (msgFolder &amp;&amp; msgHdr)</span>
<a href="#l23.24"></a><span id="l23.24">                 msgFolder-&gt;NotifyPropertyFlagChanged(msgHdr, m_msgLoadedAtom, 0, 1);</span>
<a href="#l23.25"></a><span id="l23.25">             }</span>
<a href="#l23.26"></a><span id="l23.26">           }</span>
<a href="#l23.27"></a><span id="l23.27">         }</span>
<a href="#l23.28"></a><span id="l23.28">       }</span>
<a href="#l23.29"></a><span id="l23.29">       StopMeteors();</span>
<a href="#l23.30"></a><span id="l23.30">       nsString documentDone;</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineminus">-      rv = mBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;documentDone&quot;),</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineplus">+      rv = mBundle-&gt;GetStringFromName(u&quot;documentDone&quot;,</span>
<a href="#l23.33"></a><span id="l23.33">                                       getter_Copies(documentDone));</span>
<a href="#l23.34"></a><span id="l23.34">       if (NS_SUCCEEDED(rv))</span>
<a href="#l23.35"></a><span id="l23.35">         ShowStatusString(documentDone);</span>
<a href="#l23.36"></a><span id="l23.36">     }</span>
<a href="#l23.37"></a><span id="l23.37">   }</span>
<a href="#l23.38"></a><span id="l23.38">   return NS_OK;</span>
<a href="#l23.39"></a><span id="l23.39"> }</span>
<a href="#l23.40"></a><span id="l23.40"> </span>
<a href="#l23.41"></a><span id="l23.41" class="difflineat">@@ -286,17 +286,17 @@ NS_IMETHODIMP nsMsgStatusFeedback::OnSta</span>
<a href="#l23.42"></a><span id="l23.42">   nsString statusMessage;</span>
<a href="#l23.43"></a><span id="l23.43">   if (!str.IsEmpty() &amp;&amp; str.Find(accountName) == kNotFound)</span>
<a href="#l23.44"></a><span id="l23.44">   {</span>
<a href="#l23.45"></a><span id="l23.45">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l23.46"></a><span id="l23.46">     rv = sbs-&gt;CreateBundle(MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l23.47"></a><span id="l23.47">     const char16_t *params[] = { accountName.get(),</span>
<a href="#l23.48"></a><span id="l23.48">                                   str.get() };</span>
<a href="#l23.49"></a><span id="l23.49">     rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l23.50"></a><span id="l23.50" class="difflineminus">-      MOZ_UTF16(&quot;statusMessage&quot;),</span>
<a href="#l23.51"></a><span id="l23.51" class="difflineplus">+      u&quot;statusMessage&quot;,</span>
<a href="#l23.52"></a><span id="l23.52">       params, 2, getter_Copies(statusMessage));</span>
<a href="#l23.53"></a><span id="l23.53">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l23.54"></a><span id="l23.54">   }</span>
<a href="#l23.55"></a><span id="l23.55">   else</span>
<a href="#l23.56"></a><span id="l23.56">   {</span>
<a href="#l23.57"></a><span id="l23.57">     statusMessage.Assign(str);</span>
<a href="#l23.58"></a><span id="l23.58">   }</span>
<a href="#l23.59"></a><span id="l23.59">   return ShowStatusString(statusMessage);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mailnews/base/src/nsMsgWindow.cpp</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgWindow.cpp</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -81,17 +81,17 @@ NS_IMETHODIMP nsMsgWindow::GetMessageWin</span>
<a href="#l24.4"></a><span id="l24.4">   if (!docShell)</span>
<a href="#l24.5"></a><span id="l24.5">   {</span>
<a href="#l24.6"></a><span id="l24.6">     // if we don't have a docshell, then we need to look up the message pane docshell</span>
<a href="#l24.7"></a><span id="l24.7">     nsCOMPtr&lt;nsIDocShell&gt; rootShell(do_QueryReferent(mRootDocShellWeak));</span>
<a href="#l24.8"></a><span id="l24.8">     if (rootShell)</span>
<a href="#l24.9"></a><span id="l24.9">     {</span>
<a href="#l24.10"></a><span id="l24.10">       nsCOMPtr&lt;nsIDocShellTreeItem&gt; msgDocShellItem;</span>
<a href="#l24.11"></a><span id="l24.11">       if(rootShell)</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-         rootShell-&gt;FindChildWithName(MOZ_UTF16(&quot;messagepane&quot;),</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+         rootShell-&gt;FindChildWithName(u&quot;messagepane&quot;,</span>
<a href="#l24.14"></a><span id="l24.14">                                       true, false, nullptr, nullptr,</span>
<a href="#l24.15"></a><span id="l24.15">                                       getter_AddRefs(msgDocShellItem));</span>
<a href="#l24.16"></a><span id="l24.16">       NS_ENSURE_TRUE(msgDocShellItem, NS_ERROR_FAILURE);</span>
<a href="#l24.17"></a><span id="l24.17">       docShell = do_QueryInterface(msgDocShellItem);</span>
<a href="#l24.18"></a><span id="l24.18">       // we don't own mMessageWindowDocShell so don't try to keep a reference to it!</span>
<a href="#l24.19"></a><span id="l24.19">       mMessageWindowDocShellWeak = do_GetWeakReference(docShell);</span>
<a href="#l24.20"></a><span id="l24.20">     }</span>
<a href="#l24.21"></a><span id="l24.21">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mailnews/base/src/nsSpamSettings.cpp</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mailnews/base/src/nsSpamSettings.cpp</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -680,17 +680,17 @@ NS_IMETHODIMP nsSpamSettings::LogJunkHit</span>
<a href="#l25.4"></a><span id="l25.4">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l25.5"></a><span id="l25.5">   rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/filter.properties&quot;,</span>
<a href="#l25.6"></a><span id="l25.6">     getter_AddRefs(bundle));</span>
<a href="#l25.7"></a><span id="l25.7">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l25.8"></a><span id="l25.8"> </span>
<a href="#l25.9"></a><span id="l25.9">   const char16_t *junkLogDetectFormatStrings[3] = { authorValue.get(), subjectValue.get(), dateValue.get() };</span>
<a href="#l25.10"></a><span id="l25.10">   nsString junkLogDetectStr;</span>
<a href="#l25.11"></a><span id="l25.11">   rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-    MOZ_UTF16(&quot;junkLogDetectStr&quot;),</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+    u&quot;junkLogDetectStr&quot;,</span>
<a href="#l25.14"></a><span id="l25.14">     junkLogDetectFormatStrings, 3,</span>
<a href="#l25.15"></a><span id="l25.15">     getter_Copies(junkLogDetectStr));</span>
<a href="#l25.16"></a><span id="l25.16">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l25.17"></a><span id="l25.17"> </span>
<a href="#l25.18"></a><span id="l25.18">   buffer += NS_ConvertUTF16toUTF8(junkLogDetectStr);</span>
<a href="#l25.19"></a><span id="l25.19">   buffer +=  &quot;\n&quot;;</span>
<a href="#l25.20"></a><span id="l25.20"> </span>
<a href="#l25.21"></a><span id="l25.21">   if (aMoveMessage) {</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineat">@@ -702,17 +702,17 @@ NS_IMETHODIMP nsSpamSettings::LogJunkHit</span>
<a href="#l25.23"></a><span id="l25.23">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l25.24"></a><span id="l25.24"> </span>
<a href="#l25.25"></a><span id="l25.25">     NS_ConvertASCIItoUTF16 msgIdValue(msgId);</span>
<a href="#l25.26"></a><span id="l25.26">     NS_ConvertASCIItoUTF16 junkFolderURIValue(junkFolderURI);</span>
<a href="#l25.27"></a><span id="l25.27"> </span>
<a href="#l25.28"></a><span id="l25.28">     const char16_t *logMoveFormatStrings[2] = { msgIdValue.get(), junkFolderURIValue.get() };</span>
<a href="#l25.29"></a><span id="l25.29">     nsString logMoveStr;</span>
<a href="#l25.30"></a><span id="l25.30">     rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineminus">-      MOZ_UTF16(&quot;logMoveStr&quot;),</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineplus">+      u&quot;logMoveStr&quot;,</span>
<a href="#l25.33"></a><span id="l25.33">       logMoveFormatStrings, 2,</span>
<a href="#l25.34"></a><span id="l25.34">       getter_Copies(logMoveStr));</span>
<a href="#l25.35"></a><span id="l25.35">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l25.36"></a><span id="l25.36"> </span>
<a href="#l25.37"></a><span id="l25.37">     buffer += NS_ConvertUTF16toUTF8(logMoveStr);</span>
<a href="#l25.38"></a><span id="l25.38">     buffer += &quot;\n&quot;;</span>
<a href="#l25.39"></a><span id="l25.39">   }</span>
<a href="#l25.40"></a><span id="l25.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mailnews/base/src/nsSubscribableServer.cpp</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mailnews/base/src/nsSubscribableServer.cpp</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -35,20 +35,20 @@ nsSubscribableServer::Init()</span>
<a href="#l26.4"></a><span id="l26.4">     rv = mRDFService-&gt;GetResource(NS_LITERAL_CSTRING(NC_NAMESPACE_URI &quot;child&quot;),</span>
<a href="#l26.5"></a><span id="l26.5">                                   getter_AddRefs(kNC_Child));</span>
<a href="#l26.6"></a><span id="l26.6">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l26.7"></a><span id="l26.7"> </span>
<a href="#l26.8"></a><span id="l26.8">     rv = mRDFService-&gt;GetResource(NS_LITERAL_CSTRING(NC_NAMESPACE_URI &quot;Subscribed&quot;),</span>
<a href="#l26.9"></a><span id="l26.9">                                   getter_AddRefs(kNC_Subscribed));</span>
<a href="#l26.10"></a><span id="l26.10">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l26.11"></a><span id="l26.11"> </span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-    rv = mRDFService-&gt;GetLiteral(MOZ_UTF16(&quot;true&quot;), getter_AddRefs(kTrueLiteral));</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+    rv = mRDFService-&gt;GetLiteral(u&quot;true&quot;, getter_AddRefs(kTrueLiteral));</span>
<a href="#l26.14"></a><span id="l26.14">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l26.15"></a><span id="l26.15"> </span>
<a href="#l26.16"></a><span id="l26.16" class="difflineminus">-    rv = mRDFService-&gt;GetLiteral(MOZ_UTF16(&quot;false&quot;), getter_AddRefs(kFalseLiteral));</span>
<a href="#l26.17"></a><span id="l26.17" class="difflineplus">+    rv = mRDFService-&gt;GetLiteral(u&quot;false&quot;, getter_AddRefs(kFalseLiteral));</span>
<a href="#l26.18"></a><span id="l26.18">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l26.19"></a><span id="l26.19">     return NS_OK;</span>
<a href="#l26.20"></a><span id="l26.20"> }</span>
<a href="#l26.21"></a><span id="l26.21"> </span>
<a href="#l26.22"></a><span id="l26.22"> nsSubscribableServer::~nsSubscribableServer(void)</span>
<a href="#l26.23"></a><span id="l26.23"> {</span>
<a href="#l26.24"></a><span id="l26.24">   mozilla::DebugOnly&lt;nsresult&gt; rv = FreeSubtree(mTreeRoot);</span>
<a href="#l26.25"></a><span id="l26.25">   NS_ASSERTION(NS_SUCCEEDED(rv),&quot;failed to free tree&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mailnews/base/src/nsSubscribeDataSource.cpp</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mailnews/base/src/nsSubscribeDataSource.cpp</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -62,20 +62,20 @@ nsSubscribeDataSource::Init()</span>
<a href="#l27.4"></a><span id="l27.4">     rv = mRDFService-&gt;GetResource(NS_LITERAL_CSTRING(NC_NAMESPACE_URI &quot;Subscribable&quot;),</span>
<a href="#l27.5"></a><span id="l27.5">                                   getter_AddRefs(kNC_Subscribable));</span>
<a href="#l27.6"></a><span id="l27.6">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l27.7"></a><span id="l27.7"> </span>
<a href="#l27.8"></a><span id="l27.8">     rv = mRDFService-&gt;GetResource(NS_LITERAL_CSTRING(NC_NAMESPACE_URI &quot;ServerType&quot;),</span>
<a href="#l27.9"></a><span id="l27.9">                                   getter_AddRefs(kNC_ServerType));</span>
<a href="#l27.10"></a><span id="l27.10">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l27.11"></a><span id="l27.11"> </span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-    rv = mRDFService-&gt;GetLiteral(MOZ_UTF16(&quot;true&quot;), getter_AddRefs(kTrueLiteral));</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+    rv = mRDFService-&gt;GetLiteral(u&quot;true&quot;, getter_AddRefs(kTrueLiteral));</span>
<a href="#l27.14"></a><span id="l27.14">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l27.15"></a><span id="l27.15"> </span>
<a href="#l27.16"></a><span id="l27.16" class="difflineminus">-    rv = mRDFService-&gt;GetLiteral(MOZ_UTF16(&quot;false&quot;), getter_AddRefs(kFalseLiteral));</span>
<a href="#l27.17"></a><span id="l27.17" class="difflineplus">+    rv = mRDFService-&gt;GetLiteral(u&quot;false&quot;, getter_AddRefs(kFalseLiteral));</span>
<a href="#l27.18"></a><span id="l27.18">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l27.19"></a><span id="l27.19"> 	return NS_OK;</span>
<a href="#l27.20"></a><span id="l27.20"> }</span>
<a href="#l27.21"></a><span id="l27.21"> </span>
<a href="#l27.22"></a><span id="l27.22"> NS_IMETHODIMP </span>
<a href="#l27.23"></a><span id="l27.23"> nsSubscribeDataSource::GetURI(char * *aURI)</span>
<a href="#l27.24"></a><span id="l27.24"> {</span>
<a href="#l27.25"></a><span id="l27.25">   if ((*aURI = strdup(&quot;rdf:subscribe&quot;)) == nullptr)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1922,25 +1922,25 @@ nsresult nsMsgDBFolder::HandleAutoCompac</span>
<a href="#l28.4"></a><span id="l28.4">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l28.5"></a><span id="l28.5">           nsString dialogTitle;</span>
<a href="#l28.6"></a><span id="l28.6">           nsString confirmString;</span>
<a href="#l28.7"></a><span id="l28.7">           nsString checkboxText;</span>
<a href="#l28.8"></a><span id="l28.8">           nsString buttonCompactNowText;</span>
<a href="#l28.9"></a><span id="l28.9">           nsAutoString compactSize;</span>
<a href="#l28.10"></a><span id="l28.10">           FormatFileSize(totalExpungedBytes, true, compactSize);</span>
<a href="#l28.11"></a><span id="l28.11">           const char16_t* params[] = { compactSize.get() };</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-          rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;autoCompactAllFoldersTitle&quot;), getter_Copies(dialogTitle));</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+          rv = bundle-&gt;GetStringFromName(u&quot;autoCompactAllFoldersTitle&quot;, getter_Copies(dialogTitle));</span>
<a href="#l28.14"></a><span id="l28.14">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l28.15"></a><span id="l28.15" class="difflineminus">-          rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;autoCompactAllFoldersText&quot;),</span>
<a href="#l28.16"></a><span id="l28.16" class="difflineplus">+          rv = bundle-&gt;FormatStringFromName(u&quot;autoCompactAllFoldersText&quot;,</span>
<a href="#l28.17"></a><span id="l28.17">                                             params, 1, getter_Copies(confirmString));</span>
<a href="#l28.18"></a><span id="l28.18">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l28.19"></a><span id="l28.19" class="difflineminus">-          rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;autoCompactAlwaysAskCheckbox&quot;),</span>
<a href="#l28.20"></a><span id="l28.20" class="difflineplus">+          rv = bundle-&gt;GetStringFromName(u&quot;autoCompactAlwaysAskCheckbox&quot;,</span>
<a href="#l28.21"></a><span id="l28.21">                                          getter_Copies(checkboxText));</span>
<a href="#l28.22"></a><span id="l28.22">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l28.23"></a><span id="l28.23" class="difflineminus">-          rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;compactNowButton&quot;),</span>
<a href="#l28.24"></a><span id="l28.24" class="difflineplus">+          rv = bundle-&gt;GetStringFromName(u&quot;compactNowButton&quot;,</span>
<a href="#l28.25"></a><span id="l28.25">                                          getter_Copies(buttonCompactNowText));</span>
<a href="#l28.26"></a><span id="l28.26">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l28.27"></a><span id="l28.27">           bool alwaysAsk = true; // &quot;Always ask...&quot; - checked by default.</span>
<a href="#l28.28"></a><span id="l28.28">           int32_t buttonPressed = 0;</span>
<a href="#l28.29"></a><span id="l28.29"> </span>
<a href="#l28.30"></a><span id="l28.30">           nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l28.31"></a><span id="l28.31">           rv = aWindow-&gt;GetPromptDialog(getter_AddRefs(dialog));</span>
<a href="#l28.32"></a><span id="l28.32">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l28.33"></a><span id="l28.33" class="difflineat">@@ -2926,37 +2926,37 @@ nsMsgDBFolder::initializeStrings()</span>
<a href="#l28.34"></a><span id="l28.34">   nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l28.35"></a><span id="l28.35">     mozilla::services::GetStringBundleService();</span>
<a href="#l28.36"></a><span id="l28.36">   NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l28.37"></a><span id="l28.37">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l28.38"></a><span id="l28.38">   rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/messenger.properties&quot;,</span>
<a href="#l28.39"></a><span id="l28.39">                                    getter_AddRefs(bundle));</span>
<a href="#l28.40"></a><span id="l28.40">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l28.41"></a><span id="l28.41"> </span>
<a href="#l28.42"></a><span id="l28.42" class="difflineminus">-  bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;inboxFolderName&quot;),</span>
<a href="#l28.43"></a><span id="l28.43" class="difflineplus">+  bundle-&gt;GetStringFromName(u&quot;inboxFolderName&quot;,</span>
<a href="#l28.44"></a><span id="l28.44">                             &amp;kLocalizedInboxName);</span>
<a href="#l28.45"></a><span id="l28.45" class="difflineminus">-  bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;trashFolderName&quot;),</span>
<a href="#l28.46"></a><span id="l28.46" class="difflineplus">+  bundle-&gt;GetStringFromName(u&quot;trashFolderName&quot;,</span>
<a href="#l28.47"></a><span id="l28.47">                             &amp;kLocalizedTrashName);</span>
<a href="#l28.48"></a><span id="l28.48" class="difflineminus">-  bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;sentFolderName&quot;),</span>
<a href="#l28.49"></a><span id="l28.49" class="difflineplus">+  bundle-&gt;GetStringFromName(u&quot;sentFolderName&quot;,</span>
<a href="#l28.50"></a><span id="l28.50">                             &amp;kLocalizedSentName);</span>
<a href="#l28.51"></a><span id="l28.51" class="difflineminus">-  bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;draftsFolderName&quot;),</span>
<a href="#l28.52"></a><span id="l28.52" class="difflineplus">+  bundle-&gt;GetStringFromName(u&quot;draftsFolderName&quot;,</span>
<a href="#l28.53"></a><span id="l28.53">                             &amp;kLocalizedDraftsName);</span>
<a href="#l28.54"></a><span id="l28.54" class="difflineminus">-  bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;templatesFolderName&quot;),</span>
<a href="#l28.55"></a><span id="l28.55" class="difflineplus">+  bundle-&gt;GetStringFromName(u&quot;templatesFolderName&quot;,</span>
<a href="#l28.56"></a><span id="l28.56">                             &amp;kLocalizedTemplatesName);</span>
<a href="#l28.57"></a><span id="l28.57" class="difflineminus">-  bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;junkFolderName&quot;),</span>
<a href="#l28.58"></a><span id="l28.58" class="difflineplus">+  bundle-&gt;GetStringFromName(u&quot;junkFolderName&quot;,</span>
<a href="#l28.59"></a><span id="l28.59">                             &amp;kLocalizedJunkName);</span>
<a href="#l28.60"></a><span id="l28.60" class="difflineminus">-  bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;outboxFolderName&quot;),</span>
<a href="#l28.61"></a><span id="l28.61" class="difflineplus">+  bundle-&gt;GetStringFromName(u&quot;outboxFolderName&quot;,</span>
<a href="#l28.62"></a><span id="l28.62">                             &amp;kLocalizedUnsentName);</span>
<a href="#l28.63"></a><span id="l28.63" class="difflineminus">-  bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;archivesFolderName&quot;),</span>
<a href="#l28.64"></a><span id="l28.64" class="difflineplus">+  bundle-&gt;GetStringFromName(u&quot;archivesFolderName&quot;,</span>
<a href="#l28.65"></a><span id="l28.65">                             &amp;kLocalizedArchivesName);</span>
<a href="#l28.66"></a><span id="l28.66"> </span>
<a href="#l28.67"></a><span id="l28.67">   nsCOMPtr&lt;nsIStringBundle&gt; brandBundle;</span>
<a href="#l28.68"></a><span id="l28.68">   rv = bundleService-&gt;CreateBundle(&quot;chrome://branding/locale/brand.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l28.69"></a><span id="l28.69">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l28.70"></a><span id="l28.70" class="difflineminus">-  bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;brandShortName&quot;),</span>
<a href="#l28.71"></a><span id="l28.71" class="difflineplus">+  bundle-&gt;GetStringFromName(u&quot;brandShortName&quot;,</span>
<a href="#l28.72"></a><span id="l28.72">                             &amp;kLocalizedBrandShortName);</span>
<a href="#l28.73"></a><span id="l28.73">   return NS_OK;</span>
<a href="#l28.74"></a><span id="l28.74"> }</span>
<a href="#l28.75"></a><span id="l28.75"> </span>
<a href="#l28.76"></a><span id="l28.76"> nsresult</span>
<a href="#l28.77"></a><span id="l28.77"> nsMsgDBFolder::createCollationKeyGenerator()</span>
<a href="#l28.78"></a><span id="l28.78"> {</span>
<a href="#l28.79"></a><span id="l28.79">   nsresult rv = NS_OK;</span>
<a href="#l28.80"></a><span id="l28.80" class="difflineat">@@ -3846,17 +3846,17 @@ nsMsgDBFolder::ConfirmAutoFolderRename(n</span>
<a href="#l28.81"></a><span id="l28.81">   const char16_t *formatStrings[] =</span>
<a href="#l28.82"></a><span id="l28.82">   {</span>
<a href="#l28.83"></a><span id="l28.83">     aOldName.get(),</span>
<a href="#l28.84"></a><span id="l28.84">     folderName.get(),</span>
<a href="#l28.85"></a><span id="l28.85">     aNewName.get()</span>
<a href="#l28.86"></a><span id="l28.86">   };</span>
<a href="#l28.87"></a><span id="l28.87"> </span>
<a href="#l28.88"></a><span id="l28.88">   nsString confirmString;</span>
<a href="#l28.89"></a><span id="l28.89" class="difflineminus">-  rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;confirmDuplicateFolderRename&quot;),</span>
<a href="#l28.90"></a><span id="l28.90" class="difflineplus">+  rv = bundle-&gt;FormatStringFromName(u&quot;confirmDuplicateFolderRename&quot;,</span>
<a href="#l28.91"></a><span id="l28.91">                                     formatStrings, 3, getter_Copies(confirmString));</span>
<a href="#l28.92"></a><span id="l28.92">   if (NS_WARN_IF(NS_FAILED(rv))) {</span>
<a href="#l28.93"></a><span id="l28.93">     return false;</span>
<a href="#l28.94"></a><span id="l28.94">   }</span>
<a href="#l28.95"></a><span id="l28.95"> </span>
<a href="#l28.96"></a><span id="l28.96">   bool confirmed = false;</span>
<a href="#l28.97"></a><span id="l28.97">   rv = ThrowConfirmationPrompt(msgWindow, confirmString, &amp;confirmed);</span>
<a href="#l28.98"></a><span id="l28.98">   if (NS_WARN_IF(NS_FAILED(rv))) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mailnews/base/util/nsMsgI18N.cpp</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgI18N.cpp</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -253,17 +253,17 @@ bool nsMsgI18Nstateful_charset(const cha</span>
<a href="#l29.4"></a><span id="l29.4"> bool nsMsgI18Nmultibyte_charset(const char *charset)</span>
<a href="#l29.5"></a><span id="l29.5"> {</span>
<a href="#l29.6"></a><span id="l29.6">   nsresult res;</span>
<a href="#l29.7"></a><span id="l29.7">   nsCOMPtr &lt;nsICharsetConverterManager&gt; ccm = do_GetService(NS_CHARSETCONVERTERMANAGER_CONTRACTID, &amp;res);</span>
<a href="#l29.8"></a><span id="l29.8">   bool result = false;</span>
<a href="#l29.9"></a><span id="l29.9"> </span>
<a href="#l29.10"></a><span id="l29.10">   if (NS_SUCCEEDED(res)) {</span>
<a href="#l29.11"></a><span id="l29.11">     nsAutoString charsetData;</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-    res = ccm-&gt;GetCharsetData(charset, MOZ_UTF16(&quot;.isMultibyte&quot;), charsetData);</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+    res = ccm-&gt;GetCharsetData(charset, u&quot;.isMultibyte&quot;, charsetData);</span>
<a href="#l29.14"></a><span id="l29.14">     if (NS_SUCCEEDED(res)) {</span>
<a href="#l29.15"></a><span id="l29.15">       result = charsetData.LowerCaseEqualsLiteral(&quot;true&quot;);</span>
<a href="#l29.16"></a><span id="l29.16">     }</span>
<a href="#l29.17"></a><span id="l29.17">   }</span>
<a href="#l29.18"></a><span id="l29.18"> </span>
<a href="#l29.19"></a><span id="l29.19">   return result;</span>
<a href="#l29.20"></a><span id="l29.20"> }</span>
<a href="#l29.21"></a><span id="l29.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mailnews/base/util/nsMsgIncomingServer.cpp</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgIncomingServer.cpp</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -1614,18 +1614,18 @@ NS_IMETHODIMP nsMsgIncomingServer::Displ</span>
<a href="#l30.4"></a><span id="l30.4"> </span>
<a href="#l30.5"></a><span id="l30.5">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l30.6"></a><span id="l30.6">   nsresult rv = bundleService-&gt;CreateBundle(BASE_MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l30.7"></a><span id="l30.7">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l30.8"></a><span id="l30.8">   if (bundle)</span>
<a href="#l30.9"></a><span id="l30.9">   {</span>
<a href="#l30.10"></a><span id="l30.10">     nsString errorMsgTitle;</span>
<a href="#l30.11"></a><span id="l30.11">     nsString errorMsgBody;</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-    bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;nocachedbodybody2&quot;), getter_Copies(errorMsgBody));</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineminus">-    bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;nocachedbodytitle&quot;), getter_Copies(errorMsgTitle));</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineplus">+    bundle-&gt;GetStringFromName(u&quot;nocachedbodybody2&quot;, getter_Copies(errorMsgBody));</span>
<a href="#l30.15"></a><span id="l30.15" class="difflineplus">+    bundle-&gt;GetStringFromName(u&quot;nocachedbodytitle&quot;, getter_Copies(errorMsgTitle));</span>
<a href="#l30.16"></a><span id="l30.16">     aMsgWindow-&gt;DisplayHTMLInMessagePane(errorMsgTitle, errorMsgBody, true);</span>
<a href="#l30.17"></a><span id="l30.17">   }</span>
<a href="#l30.18"></a><span id="l30.18"> </span>
<a href="#l30.19"></a><span id="l30.19">   return NS_OK;</span>
<a href="#l30.20"></a><span id="l30.20"> }</span>
<a href="#l30.21"></a><span id="l30.21"> </span>
<a href="#l30.22"></a><span id="l30.22"> // Called only during the migration process. A unique name is generated for the</span>
<a href="#l30.23"></a><span id="l30.23"> // migrated account.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mailnews/base/util/nsMsgProtocol.cpp</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgProtocol.cpp</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -351,24 +351,24 @@ NS_IMETHODIMP nsMsgProtocol::OnStopReque</span>
<a href="#l31.4"></a><span id="l31.4">     if (!m_channelContext &amp;&amp; NS_FAILED(aStatus) &amp;&amp;</span>
<a href="#l31.5"></a><span id="l31.5">         (aStatus != NS_BINDING_ABORTED))</span>
<a href="#l31.6"></a><span id="l31.6">     {</span>
<a href="#l31.7"></a><span id="l31.7">       const char16_t* errorString = nullptr;</span>
<a href="#l31.8"></a><span id="l31.8">       switch (aStatus)</span>
<a href="#l31.9"></a><span id="l31.9">       {</span>
<a href="#l31.10"></a><span id="l31.10">           case NS_ERROR_UNKNOWN_HOST:</span>
<a href="#l31.11"></a><span id="l31.11">           case NS_ERROR_UNKNOWN_PROXY_HOST:</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-             errorString = MOZ_UTF16(&quot;unknownHostError&quot;);</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+             errorString = u&quot;unknownHostError&quot;;</span>
<a href="#l31.14"></a><span id="l31.14">              break;</span>
<a href="#l31.15"></a><span id="l31.15">           case NS_ERROR_CONNECTION_REFUSED:</span>
<a href="#l31.16"></a><span id="l31.16">           case NS_ERROR_PROXY_CONNECTION_REFUSED:</span>
<a href="#l31.17"></a><span id="l31.17" class="difflineminus">-             errorString = MOZ_UTF16(&quot;connectionRefusedError&quot;);</span>
<a href="#l31.18"></a><span id="l31.18" class="difflineplus">+             errorString = u&quot;connectionRefusedError&quot;;</span>
<a href="#l31.19"></a><span id="l31.19">              break;</span>
<a href="#l31.20"></a><span id="l31.20">           case NS_ERROR_NET_TIMEOUT:</span>
<a href="#l31.21"></a><span id="l31.21" class="difflineminus">-             errorString = MOZ_UTF16(&quot;netTimeoutError&quot;);</span>
<a href="#l31.22"></a><span id="l31.22" class="difflineplus">+             errorString = u&quot;netTimeoutError&quot;;</span>
<a href="#l31.23"></a><span id="l31.23">              break;</span>
<a href="#l31.24"></a><span id="l31.24">           default:</span>
<a href="#l31.25"></a><span id="l31.25">              // Leave the string as nullptr.</span>
<a href="#l31.26"></a><span id="l31.26">              break;</span>
<a href="#l31.27"></a><span id="l31.27">       }</span>
<a href="#l31.28"></a><span id="l31.28"> </span>
<a href="#l31.29"></a><span id="l31.29">       NS_ASSERTION(errorString, &quot;unknown error, but don't alert user.&quot;);</span>
<a href="#l31.30"></a><span id="l31.30">       if (errorString)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mailnews/base/util/nsMsgUtils.cpp</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgUtils.cpp</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -2158,35 +2158,35 @@ NS_MSG_BASE nsresult MsgPromptLoginFaile</span>
<a href="#l32.4"></a><span id="l32.4">   rv = bundleSvc-&gt;CreateBundle(&quot;chrome://messenger/locale/messenger.properties&quot;,</span>
<a href="#l32.5"></a><span id="l32.5">                                getter_AddRefs(bundle));</span>
<a href="#l32.6"></a><span id="l32.6">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l32.7"></a><span id="l32.7"> </span>
<a href="#l32.8"></a><span id="l32.8">   nsString message;</span>
<a href="#l32.9"></a><span id="l32.9">   NS_ConvertUTF8toUTF16 hostNameUTF16(aHostname);</span>
<a href="#l32.10"></a><span id="l32.10">   const char16_t *formatStrings[] = { hostNameUTF16.get() };</span>
<a href="#l32.11"></a><span id="l32.11"> </span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-  rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;mailServerLoginFailed&quot;),</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+  rv = bundle-&gt;FormatStringFromName(u&quot;mailServerLoginFailed&quot;,</span>
<a href="#l32.14"></a><span id="l32.14">                                     formatStrings, 1,</span>
<a href="#l32.15"></a><span id="l32.15">                                     getter_Copies(message));</span>
<a href="#l32.16"></a><span id="l32.16">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l32.17"></a><span id="l32.17"> </span>
<a href="#l32.18"></a><span id="l32.18">   nsString title;</span>
<a href="#l32.19"></a><span id="l32.19">   rv = bundle-&gt;GetStringFromName(</span>
<a href="#l32.20"></a><span id="l32.20" class="difflineminus">-    MOZ_UTF16(&quot;mailServerLoginFailedTitle&quot;), getter_Copies(title));</span>
<a href="#l32.21"></a><span id="l32.21" class="difflineplus">+    u&quot;mailServerLoginFailedTitle&quot;, getter_Copies(title));</span>
<a href="#l32.22"></a><span id="l32.22">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l32.23"></a><span id="l32.23"> </span>
<a href="#l32.24"></a><span id="l32.24">   nsString button0;</span>
<a href="#l32.25"></a><span id="l32.25">   rv = bundle-&gt;GetStringFromName(</span>
<a href="#l32.26"></a><span id="l32.26" class="difflineminus">-    MOZ_UTF16(&quot;mailServerLoginFailedRetryButton&quot;),</span>
<a href="#l32.27"></a><span id="l32.27" class="difflineplus">+    u&quot;mailServerLoginFailedRetryButton&quot;,</span>
<a href="#l32.28"></a><span id="l32.28">     getter_Copies(button0));</span>
<a href="#l32.29"></a><span id="l32.29">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l32.30"></a><span id="l32.30"> </span>
<a href="#l32.31"></a><span id="l32.31">   nsString button2;</span>
<a href="#l32.32"></a><span id="l32.32">   rv = bundle-&gt;GetStringFromName(</span>
<a href="#l32.33"></a><span id="l32.33" class="difflineminus">-    MOZ_UTF16(&quot;mailServerLoginFailedEnterNewPasswordButton&quot;),</span>
<a href="#l32.34"></a><span id="l32.34" class="difflineplus">+    u&quot;mailServerLoginFailedEnterNewPasswordButton&quot;,</span>
<a href="#l32.35"></a><span id="l32.35">     getter_Copies(button2));</span>
<a href="#l32.36"></a><span id="l32.36">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l32.37"></a><span id="l32.37"> </span>
<a href="#l32.38"></a><span id="l32.38">   bool dummyValue = false;</span>
<a href="#l32.39"></a><span id="l32.39">   return dialog-&gt;ConfirmEx(</span>
<a href="#l32.40"></a><span id="l32.40">     title.get(), message.get(),</span>
<a href="#l32.41"></a><span id="l32.41">     (nsIPrompt::BUTTON_TITLE_IS_STRING * nsIPrompt::BUTTON_POS_0) +</span>
<a href="#l32.42"></a><span id="l32.42">     (nsIPrompt::BUTTON_TITLE_CANCEL * nsIPrompt::BUTTON_POS_1) +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/mailnews/compose/src/nsComposeStrings.cpp</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/mailnews/compose/src/nsComposeStrings.cpp</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -4,105 +4,105 @@</span>
<a href="#l33.4"></a><span id="l33.4"> </span>
<a href="#l33.5"></a><span id="l33.5"> #include &quot;nsComposeStrings.h&quot;</span>
<a href="#l33.6"></a><span id="l33.6"> </span>
<a href="#l33.7"></a><span id="l33.7"> const char16_t* errorStringNameForErrorCode(nsresult aCode)</span>
<a href="#l33.8"></a><span id="l33.8"> {</span>
<a href="#l33.9"></a><span id="l33.9">   switch(aCode)</span>
<a href="#l33.10"></a><span id="l33.10">   {</span>
<a href="#l33.11"></a><span id="l33.11">     case NS_MSG_UNABLE_TO_OPEN_FILE:</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-      return MOZ_UTF16(&quot;unableToOpenFile&quot;);</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+      return u&quot;unableToOpenFile&quot;;</span>
<a href="#l33.14"></a><span id="l33.14">     case NS_MSG_UNABLE_TO_OPEN_TMP_FILE:</span>
<a href="#l33.15"></a><span id="l33.15" class="difflineminus">-      return MOZ_UTF16(&quot;unableToOpenTmpFile&quot;);</span>
<a href="#l33.16"></a><span id="l33.16" class="difflineplus">+      return u&quot;unableToOpenTmpFile&quot;;</span>
<a href="#l33.17"></a><span id="l33.17">     case NS_MSG_UNABLE_TO_SAVE_TEMPLATE:</span>
<a href="#l33.18"></a><span id="l33.18" class="difflineminus">-      return MOZ_UTF16(&quot;unableToSaveTemplate&quot;);</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineplus">+      return u&quot;unableToSaveTemplate&quot;;</span>
<a href="#l33.20"></a><span id="l33.20">     case NS_MSG_UNABLE_TO_SAVE_DRAFT:</span>
<a href="#l33.21"></a><span id="l33.21" class="difflineminus">-      return MOZ_UTF16(&quot;unableToSaveDraft&quot;);</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineplus">+      return u&quot;unableToSaveDraft&quot;;</span>
<a href="#l33.23"></a><span id="l33.23">     case NS_MSG_COULDNT_OPEN_FCC_FOLDER:</span>
<a href="#l33.24"></a><span id="l33.24" class="difflineminus">-      return MOZ_UTF16(&quot;couldntOpenFccFolder&quot;);</span>
<a href="#l33.25"></a><span id="l33.25" class="difflineplus">+      return u&quot;couldntOpenFccFolder&quot;;</span>
<a href="#l33.26"></a><span id="l33.26">     case NS_MSG_NO_SENDER:</span>
<a href="#l33.27"></a><span id="l33.27" class="difflineminus">-      return MOZ_UTF16(&quot;noSender&quot;);</span>
<a href="#l33.28"></a><span id="l33.28" class="difflineplus">+      return u&quot;noSender&quot;;</span>
<a href="#l33.29"></a><span id="l33.29">     case NS_MSG_NO_RECIPIENTS:</span>
<a href="#l33.30"></a><span id="l33.30" class="difflineminus">-      return MOZ_UTF16(&quot;noRecipients&quot;);</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineplus">+      return u&quot;noRecipients&quot;;</span>
<a href="#l33.32"></a><span id="l33.32">     case NS_MSG_ERROR_WRITING_FILE:</span>
<a href="#l33.33"></a><span id="l33.33" class="difflineminus">-      return MOZ_UTF16(&quot;errorWritingFile&quot;);</span>
<a href="#l33.34"></a><span id="l33.34" class="difflineplus">+      return u&quot;errorWritingFile&quot;;</span>
<a href="#l33.35"></a><span id="l33.35">     case NS_ERROR_SENDING_FROM_COMMAND:</span>
<a href="#l33.36"></a><span id="l33.36" class="difflineminus">-      return MOZ_UTF16(&quot;errorSendingFromCommand&quot;);</span>
<a href="#l33.37"></a><span id="l33.37" class="difflineplus">+      return u&quot;errorSendingFromCommand&quot;;</span>
<a href="#l33.38"></a><span id="l33.38">     case NS_ERROR_SENDING_DATA_COMMAND:</span>
<a href="#l33.39"></a><span id="l33.39" class="difflineminus">-      return MOZ_UTF16(&quot;errorSendingDataCommand&quot;);</span>
<a href="#l33.40"></a><span id="l33.40" class="difflineplus">+      return u&quot;errorSendingDataCommand&quot;;</span>
<a href="#l33.41"></a><span id="l33.41">     case NS_ERROR_SENDING_MESSAGE:</span>
<a href="#l33.42"></a><span id="l33.42" class="difflineminus">-      return MOZ_UTF16(&quot;errorSendingMessage&quot;);</span>
<a href="#l33.43"></a><span id="l33.43" class="difflineplus">+      return u&quot;errorSendingMessage&quot;;</span>
<a href="#l33.44"></a><span id="l33.44">     case NS_ERROR_POST_FAILED:</span>
<a href="#l33.45"></a><span id="l33.45" class="difflineminus">-      return MOZ_UTF16(&quot;postFailed&quot;);</span>
<a href="#l33.46"></a><span id="l33.46" class="difflineplus">+      return u&quot;postFailed&quot;;</span>
<a href="#l33.47"></a><span id="l33.47">     case NS_ERROR_QUEUED_DELIVERY_FAILED:</span>
<a href="#l33.48"></a><span id="l33.48" class="difflineminus">-      return MOZ_UTF16(&quot;errorQueuedDeliveryFailed&quot;);</span>
<a href="#l33.49"></a><span id="l33.49" class="difflineplus">+      return u&quot;errorQueuedDeliveryFailed&quot;;</span>
<a href="#l33.50"></a><span id="l33.50">     case NS_ERROR_SEND_FAILED:</span>
<a href="#l33.51"></a><span id="l33.51" class="difflineminus">-      return MOZ_UTF16(&quot;sendFailed&quot;);</span>
<a href="#l33.52"></a><span id="l33.52" class="difflineplus">+      return u&quot;sendFailed&quot;;</span>
<a href="#l33.53"></a><span id="l33.53">     case NS_ERROR_SMTP_SERVER_ERROR:</span>
<a href="#l33.54"></a><span id="l33.54" class="difflineminus">-      return MOZ_UTF16(&quot;smtpServerError&quot;);</span>
<a href="#l33.55"></a><span id="l33.55" class="difflineplus">+      return u&quot;smtpServerError&quot;;</span>
<a href="#l33.56"></a><span id="l33.56">     case NS_MSG_UNABLE_TO_SEND_LATER:</span>
<a href="#l33.57"></a><span id="l33.57" class="difflineminus">-      return MOZ_UTF16(&quot;unableToSendLater&quot;);</span>
<a href="#l33.58"></a><span id="l33.58" class="difflineplus">+      return u&quot;unableToSendLater&quot;;</span>
<a href="#l33.59"></a><span id="l33.59">     case NS_ERROR_COMMUNICATIONS_ERROR:</span>
<a href="#l33.60"></a><span id="l33.60" class="difflineminus">-      return MOZ_UTF16(&quot;communicationsError&quot;);</span>
<a href="#l33.61"></a><span id="l33.61" class="difflineplus">+      return u&quot;communicationsError&quot;;</span>
<a href="#l33.62"></a><span id="l33.62">     case NS_ERROR_BUT_DONT_SHOW_ALERT:</span>
<a href="#l33.63"></a><span id="l33.63" class="difflineminus">-      return MOZ_UTF16(&quot;dontShowAlert&quot;);</span>
<a href="#l33.64"></a><span id="l33.64" class="difflineplus">+      return u&quot;dontShowAlert&quot;;</span>
<a href="#l33.65"></a><span id="l33.65">     case NS_ERROR_TCP_READ_ERROR:</span>
<a href="#l33.66"></a><span id="l33.66" class="difflineminus">-      return MOZ_UTF16(&quot;tcpReadError&quot;);</span>
<a href="#l33.67"></a><span id="l33.67" class="difflineplus">+      return u&quot;tcpReadError&quot;;</span>
<a href="#l33.68"></a><span id="l33.68">     case NS_ERROR_COULD_NOT_GET_USERS_MAIL_ADDRESS:</span>
<a href="#l33.69"></a><span id="l33.69" class="difflineminus">-      return MOZ_UTF16(&quot;couldNotGetUsersMailAddress&quot;);</span>
<a href="#l33.70"></a><span id="l33.70" class="difflineplus">+      return u&quot;couldNotGetUsersMailAddress&quot;;</span>
<a href="#l33.71"></a><span id="l33.71">     case NS_ERROR_MIME_MPART_ATTACHMENT_ERROR:</span>
<a href="#l33.72"></a><span id="l33.72" class="difflineminus">-      return MOZ_UTF16(&quot;mimeMpartAttachmentError&quot;);</span>
<a href="#l33.73"></a><span id="l33.73" class="difflineplus">+      return u&quot;mimeMpartAttachmentError&quot;;</span>
<a href="#l33.74"></a><span id="l33.74">     case NS_MSG_FAILED_COPY_OPERATION:</span>
<a href="#l33.75"></a><span id="l33.75" class="difflineminus">-      return MOZ_UTF16(&quot;failedCopyOperation&quot;);</span>
<a href="#l33.76"></a><span id="l33.76" class="difflineplus">+      return u&quot;failedCopyOperation&quot;;</span>
<a href="#l33.77"></a><span id="l33.77">     case NS_ERROR_NNTP_NO_CROSS_POSTING:</span>
<a href="#l33.78"></a><span id="l33.78" class="difflineminus">-      return MOZ_UTF16(&quot;nntpNoCrossPosting&quot;);</span>
<a href="#l33.79"></a><span id="l33.79" class="difflineplus">+      return u&quot;nntpNoCrossPosting&quot;;</span>
<a href="#l33.80"></a><span id="l33.80">     case NS_MSG_CANCELLING:</span>
<a href="#l33.81"></a><span id="l33.81" class="difflineminus">-      return MOZ_UTF16(&quot;msgCancelling&quot;);</span>
<a href="#l33.82"></a><span id="l33.82" class="difflineplus">+      return u&quot;msgCancelling&quot;;</span>
<a href="#l33.83"></a><span id="l33.83">     case NS_ERROR_SEND_FAILED_BUT_NNTP_OK:</span>
<a href="#l33.84"></a><span id="l33.84" class="difflineminus">-      return MOZ_UTF16(&quot;sendFailedButNntpOk&quot;);</span>
<a href="#l33.85"></a><span id="l33.85" class="difflineplus">+      return u&quot;sendFailedButNntpOk&quot;;</span>
<a href="#l33.86"></a><span id="l33.86">     case NS_MSG_ERROR_READING_FILE:</span>
<a href="#l33.87"></a><span id="l33.87" class="difflineminus">-      return MOZ_UTF16(&quot;errorReadingFile&quot;);</span>
<a href="#l33.88"></a><span id="l33.88" class="difflineplus">+      return u&quot;errorReadingFile&quot;;</span>
<a href="#l33.89"></a><span id="l33.89">     case NS_MSG_ERROR_ATTACHING_FILE:</span>
<a href="#l33.90"></a><span id="l33.90" class="difflineminus">-      return MOZ_UTF16(&quot;errorAttachingFile&quot;);</span>
<a href="#l33.91"></a><span id="l33.91" class="difflineplus">+      return u&quot;errorAttachingFile&quot;;</span>
<a href="#l33.92"></a><span id="l33.92">     case NS_ERROR_SMTP_GREETING:</span>
<a href="#l33.93"></a><span id="l33.93" class="difflineminus">-      return MOZ_UTF16(&quot;incorrectSmtpGreeting&quot;);</span>
<a href="#l33.94"></a><span id="l33.94" class="difflineplus">+      return u&quot;incorrectSmtpGreeting&quot;;</span>
<a href="#l33.95"></a><span id="l33.95">     case NS_ERROR_SENDING_RCPT_COMMAND:</span>
<a href="#l33.96"></a><span id="l33.96" class="difflineminus">-      return MOZ_UTF16(&quot;errorSendingRcptCommand&quot;);</span>
<a href="#l33.97"></a><span id="l33.97" class="difflineplus">+      return u&quot;errorSendingRcptCommand&quot;;</span>
<a href="#l33.98"></a><span id="l33.98">     case NS_ERROR_STARTTLS_FAILED_EHLO_STARTTLS:</span>
<a href="#l33.99"></a><span id="l33.99" class="difflineminus">-      return MOZ_UTF16(&quot;startTlsFailed&quot;);</span>
<a href="#l33.100"></a><span id="l33.100" class="difflineplus">+      return u&quot;startTlsFailed&quot;;</span>
<a href="#l33.101"></a><span id="l33.101">     case NS_ERROR_SMTP_PASSWORD_UNDEFINED:</span>
<a href="#l33.102"></a><span id="l33.102" class="difflineminus">-      return MOZ_UTF16(&quot;smtpPasswordUndefined&quot;);</span>
<a href="#l33.103"></a><span id="l33.103" class="difflineplus">+      return u&quot;smtpPasswordUndefined&quot;;</span>
<a href="#l33.104"></a><span id="l33.104">     case NS_ERROR_SMTP_TEMP_SIZE_EXCEEDED:</span>
<a href="#l33.105"></a><span id="l33.105" class="difflineminus">-      return MOZ_UTF16(&quot;smtpTempSizeExceeded&quot;);</span>
<a href="#l33.106"></a><span id="l33.106" class="difflineplus">+      return u&quot;smtpTempSizeExceeded&quot;;</span>
<a href="#l33.107"></a><span id="l33.107">     case NS_ERROR_SMTP_PERM_SIZE_EXCEEDED_1:</span>
<a href="#l33.108"></a><span id="l33.108" class="difflineminus">-      return MOZ_UTF16(&quot;smtpPermSizeExceeded1&quot;);</span>
<a href="#l33.109"></a><span id="l33.109" class="difflineplus">+      return u&quot;smtpPermSizeExceeded1&quot;;</span>
<a href="#l33.110"></a><span id="l33.110">     case NS_ERROR_SMTP_PERM_SIZE_EXCEEDED_2:</span>
<a href="#l33.111"></a><span id="l33.111" class="difflineminus">-      return MOZ_UTF16(&quot;smtpPermSizeExceeded2&quot;);</span>
<a href="#l33.112"></a><span id="l33.112" class="difflineplus">+      return u&quot;smtpPermSizeExceeded2&quot;;</span>
<a href="#l33.113"></a><span id="l33.113">     case NS_ERROR_SMTP_SEND_FAILED_UNKNOWN_SERVER:</span>
<a href="#l33.114"></a><span id="l33.114" class="difflineminus">-      return MOZ_UTF16(&quot;smtpSendFailedUnknownServer&quot;);</span>
<a href="#l33.115"></a><span id="l33.115" class="difflineplus">+      return u&quot;smtpSendFailedUnknownServer&quot;;</span>
<a href="#l33.116"></a><span id="l33.116">     case NS_ERROR_SMTP_SEND_FAILED_REFUSED:</span>
<a href="#l33.117"></a><span id="l33.117" class="difflineminus">-      return MOZ_UTF16(&quot;smtpSendRequestRefused&quot;);</span>
<a href="#l33.118"></a><span id="l33.118" class="difflineplus">+      return u&quot;smtpSendRequestRefused&quot;;</span>
<a href="#l33.119"></a><span id="l33.119">     case NS_ERROR_SMTP_SEND_FAILED_INTERRUPTED:</span>
<a href="#l33.120"></a><span id="l33.120" class="difflineminus">-      return MOZ_UTF16(&quot;smtpSendInterrupted&quot;);</span>
<a href="#l33.121"></a><span id="l33.121" class="difflineplus">+      return u&quot;smtpSendInterrupted&quot;;</span>
<a href="#l33.122"></a><span id="l33.122">     case NS_ERROR_SMTP_SEND_FAILED_TIMEOUT:</span>
<a href="#l33.123"></a><span id="l33.123" class="difflineminus">-      return MOZ_UTF16(&quot;smtpSendTimeout&quot;);</span>
<a href="#l33.124"></a><span id="l33.124" class="difflineplus">+      return u&quot;smtpSendTimeout&quot;;</span>
<a href="#l33.125"></a><span id="l33.125">     case NS_ERROR_SMTP_SEND_FAILED_UNKNOWN_REASON:</span>
<a href="#l33.126"></a><span id="l33.126" class="difflineminus">-      return MOZ_UTF16(&quot;smtpSendFailedUnknownReason&quot;);</span>
<a href="#l33.127"></a><span id="l33.127" class="difflineplus">+      return u&quot;smtpSendFailedUnknownReason&quot;;</span>
<a href="#l33.128"></a><span id="l33.128">     case NS_ERROR_SMTP_AUTH_CHANGE_ENCRYPT_TO_PLAIN_NO_SSL:</span>
<a href="#l33.129"></a><span id="l33.129" class="difflineminus">-      return MOZ_UTF16(&quot;smtpHintAuthEncryptToPlainNoSsl&quot;);</span>
<a href="#l33.130"></a><span id="l33.130" class="difflineplus">+      return u&quot;smtpHintAuthEncryptToPlainNoSsl&quot;;</span>
<a href="#l33.131"></a><span id="l33.131">     case NS_ERROR_SMTP_AUTH_CHANGE_ENCRYPT_TO_PLAIN_SSL:</span>
<a href="#l33.132"></a><span id="l33.132" class="difflineminus">-      return MOZ_UTF16(&quot;smtpHintAuthEncryptToPlainSsl&quot;);</span>
<a href="#l33.133"></a><span id="l33.133" class="difflineplus">+      return u&quot;smtpHintAuthEncryptToPlainSsl&quot;;</span>
<a href="#l33.134"></a><span id="l33.134">     case NS_ERROR_SMTP_AUTH_CHANGE_PLAIN_TO_ENCRYPT:</span>
<a href="#l33.135"></a><span id="l33.135" class="difflineminus">-      return MOZ_UTF16(&quot;smtpHintAuthPlainToEncrypt&quot;);</span>
<a href="#l33.136"></a><span id="l33.136" class="difflineplus">+      return u&quot;smtpHintAuthPlainToEncrypt&quot;;</span>
<a href="#l33.137"></a><span id="l33.137">     case NS_ERROR_SMTP_AUTH_FAILURE:</span>
<a href="#l33.138"></a><span id="l33.138" class="difflineminus">-      return MOZ_UTF16(&quot;smtpAuthFailure&quot;);</span>
<a href="#l33.139"></a><span id="l33.139" class="difflineplus">+      return u&quot;smtpAuthFailure&quot;;</span>
<a href="#l33.140"></a><span id="l33.140">     case NS_ERROR_SMTP_AUTH_GSSAPI:</span>
<a href="#l33.141"></a><span id="l33.141" class="difflineminus">-      return MOZ_UTF16(&quot;smtpAuthGssapi&quot;);</span>
<a href="#l33.142"></a><span id="l33.142" class="difflineplus">+      return u&quot;smtpAuthGssapi&quot;;</span>
<a href="#l33.143"></a><span id="l33.143">     case NS_ERROR_SMTP_AUTH_MECH_NOT_SUPPORTED:</span>
<a href="#l33.144"></a><span id="l33.144" class="difflineminus">-      return MOZ_UTF16(&quot;smtpAuthMechNotSupported&quot;);</span>
<a href="#l33.145"></a><span id="l33.145" class="difflineplus">+      return u&quot;smtpAuthMechNotSupported&quot;;</span>
<a href="#l33.146"></a><span id="l33.146">     case NS_ERROR_SMTP_AUTH_NOT_SUPPORTED:</span>
<a href="#l33.147"></a><span id="l33.147" class="difflineminus">-      return MOZ_UTF16(&quot;smtpAuthenticationNotSupported&quot;);</span>
<a href="#l33.148"></a><span id="l33.148" class="difflineplus">+      return u&quot;smtpAuthenticationNotSupported&quot;;</span>
<a href="#l33.149"></a><span id="l33.149">     case NS_ERROR_ILLEGAL_LOCALPART:</span>
<a href="#l33.150"></a><span id="l33.150" class="difflineminus">-      return MOZ_UTF16(&quot;illegalLocalPart&quot;);</span>
<a href="#l33.151"></a><span id="l33.151" class="difflineplus">+      return u&quot;illegalLocalPart&quot;;</span>
<a href="#l33.152"></a><span id="l33.152">     default:</span>
<a href="#l33.153"></a><span id="l33.153" class="difflineminus">-      return MOZ_UTF16(&quot;sendFailed&quot;);</span>
<a href="#l33.154"></a><span id="l33.154" class="difflineplus">+      return u&quot;sendFailed&quot;;</span>
<a href="#l33.155"></a><span id="l33.155">   }</span>
<a href="#l33.156"></a><span id="l33.156"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgAttachmentHandler.cpp</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgAttachmentHandler.cpp</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -1164,20 +1164,20 @@ nsMsgAttachmentHandler::UrlExit(nsresult</span>
<a href="#l34.4"></a><span id="l34.4">         params = unescapedUrl;</span>
<a href="#l34.5"></a><span id="l34.5">     }</span>
<a href="#l34.6"></a><span id="l34.6">     else</span>
<a href="#l34.7"></a><span id="l34.7">       params.AssignLiteral(&quot;?&quot;);</span>
<a href="#l34.8"></a><span id="l34.8"> </span>
<a href="#l34.9"></a><span id="l34.9">     NS_ConvertUTF8toUTF16 UTF16params(params);</span>
<a href="#l34.10"></a><span id="l34.10">     const char16_t* formatParams[] = { UTF16params.get() };</span>
<a href="#l34.11"></a><span id="l34.11">     if (mode == nsIMsgSend::nsMsgSaveAsDraft || mode == nsIMsgSend::nsMsgSaveAsTemplate)</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-      bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;failureOnObjectEmbeddingWhileSaving&quot;),</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+      bundle-&gt;FormatStringFromName(u&quot;failureOnObjectEmbeddingWhileSaving&quot;,</span>
<a href="#l34.14"></a><span id="l34.14">                                    formatParams, 1, getter_Copies(msg));</span>
<a href="#l34.15"></a><span id="l34.15">     else</span>
<a href="#l34.16"></a><span id="l34.16" class="difflineminus">-      bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;failureOnObjectEmbeddingWhileSending&quot;),</span>
<a href="#l34.17"></a><span id="l34.17" class="difflineplus">+      bundle-&gt;FormatStringFromName(u&quot;failureOnObjectEmbeddingWhileSending&quot;,</span>
<a href="#l34.18"></a><span id="l34.18">                                    formatParams, 1, getter_Copies(msg));</span>
<a href="#l34.19"></a><span id="l34.19"> </span>
<a href="#l34.20"></a><span id="l34.20">     nsCOMPtr&lt;nsIPrompt&gt; aPrompt;</span>
<a href="#l34.21"></a><span id="l34.21">     if (m_mime_delivery_state)</span>
<a href="#l34.22"></a><span id="l34.22">       m_mime_delivery_state-&gt;GetDefaultPrompt(getter_AddRefs(aPrompt));</span>
<a href="#l34.23"></a><span id="l34.23">     nsMsgAskBooleanQuestionByString(aPrompt, msg.get(), &amp;keepOnGoing);</span>
<a href="#l34.24"></a><span id="l34.24"> </span>
<a href="#l34.25"></a><span id="l34.25">     if (keepOnGoing)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgCompUtils.cpp</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgCompUtils.cpp</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -440,17 +440,17 @@ nsresult mime_generate_headers(nsIMsgCom</span>
<a href="#l35.4"></a><span id="l35.4">           mozilla::services::GetStringBundleService();</span>
<a href="#l35.5"></a><span id="l35.5">         if (stringService)</span>
<a href="#l35.6"></a><span id="l35.6">         {</span>
<a href="#l35.7"></a><span id="l35.7">           nsCOMPtr&lt;nsIStringBundle&gt; composeStringBundle;</span>
<a href="#l35.8"></a><span id="l35.8">           rv = stringService-&gt;CreateBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;, getter_AddRefs(composeStringBundle));</span>
<a href="#l35.9"></a><span id="l35.9">           if (NS_SUCCEEDED(rv))</span>
<a href="#l35.10"></a><span id="l35.10">           {</span>
<a href="#l35.11"></a><span id="l35.11">             nsString undisclosedRecipients;</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-            rv = composeStringBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;undisclosedRecipients&quot;),</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+            rv = composeStringBundle-&gt;GetStringFromName(u&quot;undisclosedRecipients&quot;,</span>
<a href="#l35.14"></a><span id="l35.14">                                                         getter_Copies(undisclosedRecipients));</span>
<a href="#l35.15"></a><span id="l35.15">             if (NS_SUCCEEDED(rv) &amp;&amp; !undisclosedRecipients.IsEmpty())</span>
<a href="#l35.16"></a><span id="l35.16">             {</span>
<a href="#l35.17"></a><span id="l35.17">               nsCOMPtr&lt;nsIMsgHeaderParser&gt; headerParser(</span>
<a href="#l35.18"></a><span id="l35.18">                 mozilla::services::GetHeaderParser());</span>
<a href="#l35.19"></a><span id="l35.19">               nsCOMPtr&lt;msgIAddressObject&gt; group;</span>
<a href="#l35.20"></a><span id="l35.20">               headerParser-&gt;MakeGroupObject(undisclosedRecipients,</span>
<a href="#l35.21"></a><span id="l35.21">                 nullptr, 0, getter_AddRefs(group));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgCompose.cpp</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgCompose.cpp</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -1450,28 +1450,28 @@ NS_IMETHODIMP nsMsgCompose::SendMsg(MSG_</span>
<a href="#l36.4"></a><span id="l36.4">     else</span>
<a href="#l36.5"></a><span id="l36.5">     {</span>
<a href="#l36.6"></a><span id="l36.6">       /* If we come here it's because we got an error before we could intialize a</span>
<a href="#l36.7"></a><span id="l36.7">          send report! Let's try our best...</span>
<a href="#l36.8"></a><span id="l36.8">       */</span>
<a href="#l36.9"></a><span id="l36.9">       switch (deliverMode)</span>
<a href="#l36.10"></a><span id="l36.10">       {</span>
<a href="#l36.11"></a><span id="l36.11">         case nsIMsgCompDeliverMode::Later:</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-          nsMsgDisplayMessageByName(prompt, MOZ_UTF16(&quot;unableToSendLater&quot;));</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+          nsMsgDisplayMessageByName(prompt, u&quot;unableToSendLater&quot;);</span>
<a href="#l36.14"></a><span id="l36.14">           break;</span>
<a href="#l36.15"></a><span id="l36.15">         case nsIMsgCompDeliverMode::AutoSaveAsDraft:</span>
<a href="#l36.16"></a><span id="l36.16">         case nsIMsgCompDeliverMode::SaveAsDraft:</span>
<a href="#l36.17"></a><span id="l36.17" class="difflineminus">-          nsMsgDisplayMessageByName(prompt, MOZ_UTF16(&quot;unableToSaveDraft&quot;));</span>
<a href="#l36.18"></a><span id="l36.18" class="difflineplus">+          nsMsgDisplayMessageByName(prompt, u&quot;unableToSaveDraft&quot;);</span>
<a href="#l36.19"></a><span id="l36.19">           break;</span>
<a href="#l36.20"></a><span id="l36.20">         case nsIMsgCompDeliverMode::SaveAsTemplate:</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineminus">-          nsMsgDisplayMessageByName(prompt, MOZ_UTF16(&quot;unableToSaveTemplate&quot;));</span>
<a href="#l36.22"></a><span id="l36.22" class="difflineplus">+          nsMsgDisplayMessageByName(prompt, u&quot;unableToSaveTemplate&quot;);</span>
<a href="#l36.23"></a><span id="l36.23">           break;</span>
<a href="#l36.24"></a><span id="l36.24"> </span>
<a href="#l36.25"></a><span id="l36.25">         default:</span>
<a href="#l36.26"></a><span id="l36.26" class="difflineminus">-          nsMsgDisplayMessageByName(prompt, MOZ_UTF16(&quot;sendFailed&quot;));</span>
<a href="#l36.27"></a><span id="l36.27" class="difflineplus">+          nsMsgDisplayMessageByName(prompt, u&quot;sendFailed&quot;);</span>
<a href="#l36.28"></a><span id="l36.28">           break;</span>
<a href="#l36.29"></a><span id="l36.29">       }</span>
<a href="#l36.30"></a><span id="l36.30">     }</span>
<a href="#l36.31"></a><span id="l36.31"> </span>
<a href="#l36.32"></a><span id="l36.32">     if (progress)</span>
<a href="#l36.33"></a><span id="l36.33">       progress-&gt;CloseProgressDialog(true);</span>
<a href="#l36.34"></a><span id="l36.34">   }</span>
<a href="#l36.35"></a><span id="l36.35"> </span>
<a href="#l36.36"></a><span id="l36.36" class="difflineat">@@ -2104,17 +2104,17 @@ nsresult nsMsgCompose::CreateMessage(con</span>
<a href="#l36.37"></a><span id="l36.37">                 nsresult rv;</span>
<a href="#l36.38"></a><span id="l36.38">                 nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l36.39"></a><span id="l36.39">                   mozilla::services::GetStringBundleService();</span>
<a href="#l36.40"></a><span id="l36.40">                 NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l36.41"></a><span id="l36.41">                 nsCOMPtr&lt;nsIStringBundle&gt; composeBundle;</span>
<a href="#l36.42"></a><span id="l36.42">                 rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;,</span>
<a href="#l36.43"></a><span id="l36.43">                                                  getter_AddRefs(composeBundle));</span>
<a href="#l36.44"></a><span id="l36.44">                 NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l36.45"></a><span id="l36.45" class="difflineminus">-                composeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;messageAttachmentSafeName&quot;),</span>
<a href="#l36.46"></a><span id="l36.46" class="difflineplus">+                composeBundle-&gt;GetStringFromName(u&quot;messageAttachmentSafeName&quot;,</span>
<a href="#l36.47"></a><span id="l36.47">                                                  getter_Copies(sanitizedSubj));</span>
<a href="#l36.48"></a><span id="l36.48">               }</span>
<a href="#l36.49"></a><span id="l36.49">               else</span>
<a href="#l36.50"></a><span id="l36.50">                 sanitizedSubj.Assign(subject);</span>
<a href="#l36.51"></a><span id="l36.51"> </span>
<a href="#l36.52"></a><span id="l36.52">               // set the file size</span>
<a href="#l36.53"></a><span id="l36.53">               uint32_t messageSize;</span>
<a href="#l36.54"></a><span id="l36.54">               msgHdr-&gt;GetMessageSize(&amp;messageSize);</span>
<a href="#l36.55"></a><span id="l36.55" class="difflineat">@@ -2765,17 +2765,17 @@ NS_IMETHODIMP QuotingOutputStreamListene</span>
<a href="#l36.56"></a><span id="l36.56">         {</span>
<a href="#l36.57"></a><span id="l36.57">           nsCOMPtr&lt;mozIDOMWindowProxy&gt; domWindow;</span>
<a href="#l36.58"></a><span id="l36.58">           nsCOMPtr&lt;nsIPrompt&gt; prompt;</span>
<a href="#l36.59"></a><span id="l36.59">           compose-&gt;GetDomWindow(getter_AddRefs(domWindow));</span>
<a href="#l36.60"></a><span id="l36.60">           NS_ENSURE_TRUE(domWindow, NS_ERROR_FAILURE);</span>
<a href="#l36.61"></a><span id="l36.61">           nsCOMPtr&lt;nsPIDOMWindowOuter&gt; composeWindow = nsPIDOMWindowOuter::From(domWindow);</span>
<a href="#l36.62"></a><span id="l36.62">           if (composeWindow)</span>
<a href="#l36.63"></a><span id="l36.63">             composeWindow-&gt;GetPrompter(getter_AddRefs(prompt));</span>
<a href="#l36.64"></a><span id="l36.64" class="difflineminus">-          nsMsgDisplayMessageByName(prompt, MOZ_UTF16(&quot;followupToSenderMessage&quot;));</span>
<a href="#l36.65"></a><span id="l36.65" class="difflineplus">+          nsMsgDisplayMessageByName(prompt, u&quot;followupToSenderMessage&quot;);</span>
<a href="#l36.66"></a><span id="l36.66"> </span>
<a href="#l36.67"></a><span id="l36.67">           if (!replyTo.IsEmpty())</span>
<a href="#l36.68"></a><span id="l36.68">           {</span>
<a href="#l36.69"></a><span id="l36.69">             compFields-&gt;SetTo(replyTo);</span>
<a href="#l36.70"></a><span id="l36.70">           }</span>
<a href="#l36.71"></a><span id="l36.71">           else</span>
<a href="#l36.72"></a><span id="l36.72">           {</span>
<a href="#l36.73"></a><span id="l36.73">             // If reply-to is empty, use the From header to fetch the original</span>
<a href="#l36.74"></a><span id="l36.74" class="difflineat">@@ -4026,17 +4026,17 @@ NS_IMETHODIMP nsMsgComposeSendListener::</span>
<a href="#l36.75"></a><span id="l36.75">             mozilla::services::GetStringBundleService();</span>
<a href="#l36.76"></a><span id="l36.76">           NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l36.77"></a><span id="l36.77">           nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l36.78"></a><span id="l36.78">           rv = bundleService-&gt;CreateBundle(</span>
<a href="#l36.79"></a><span id="l36.79">             &quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;,</span>
<a href="#l36.80"></a><span id="l36.80">             getter_AddRefs(bundle));</span>
<a href="#l36.81"></a><span id="l36.81">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l36.82"></a><span id="l36.82">           nsString msg;</span>
<a href="#l36.83"></a><span id="l36.83" class="difflineminus">-          bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;msgCancelling&quot;), getter_Copies(msg));</span>
<a href="#l36.84"></a><span id="l36.84" class="difflineplus">+          bundle-&gt;GetStringFromName(u&quot;msgCancelling&quot;, getter_Copies(msg));</span>
<a href="#l36.85"></a><span id="l36.85">           progress-&gt;OnStatusChange(nullptr, nullptr, NS_OK, msg.get());</span>
<a href="#l36.86"></a><span id="l36.86">         }</span>
<a href="#l36.87"></a><span id="l36.87">       }</span>
<a href="#l36.88"></a><span id="l36.88"> </span>
<a href="#l36.89"></a><span id="l36.89">       nsCOMPtr&lt;nsIMsgSend&gt; msgSend;</span>
<a href="#l36.90"></a><span id="l36.90">       msgCompose-&gt;GetMessageSend(getter_AddRefs(msgSend));</span>
<a href="#l36.91"></a><span id="l36.91">       if (msgSend)</span>
<a href="#l36.92"></a><span id="l36.92">         msgSend-&gt;Abort();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgComposeService.cpp</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgComposeService.cpp</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -264,17 +264,17 @@ nsMsgComposeService::GetOrigWindowSelect</span>
<a href="#l37.4"></a><span id="l37.4">     return NS_ERROR_ABORT;</span>
<a href="#l37.5"></a><span id="l37.5"> </span>
<a href="#l37.6"></a><span id="l37.6">   // Now delve down in to the message to get the HTML representation of the selection</span>
<a href="#l37.7"></a><span id="l37.7">   nsCOMPtr&lt;nsIDocShell&gt; rootDocShell;</span>
<a href="#l37.8"></a><span id="l37.8">   rv = aMsgWindow-&gt;GetRootDocShell(getter_AddRefs(rootDocShell));</span>
<a href="#l37.9"></a><span id="l37.9">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l37.10"></a><span id="l37.10"> </span>
<a href="#l37.11"></a><span id="l37.11">   nsCOMPtr&lt;nsIDocShellTreeItem&gt; childAsItem;</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-  rv = rootDocShell-&gt;FindChildWithName(MOZ_UTF16(&quot;messagepane&quot;),</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+  rv = rootDocShell-&gt;FindChildWithName(u&quot;messagepane&quot;,</span>
<a href="#l37.14"></a><span id="l37.14">                                        true, false, nullptr, nullptr, getter_AddRefs(childAsItem));</span>
<a href="#l37.15"></a><span id="l37.15">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l37.16"></a><span id="l37.16"> </span>
<a href="#l37.17"></a><span id="l37.17">   nsCOMPtr&lt;nsIDocShell&gt; docShell(do_QueryInterface(childAsItem, &amp;rv));</span>
<a href="#l37.18"></a><span id="l37.18">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l37.19"></a><span id="l37.19"> </span>
<a href="#l37.20"></a><span id="l37.20">   nsCOMPtr&lt;mozIDOMWindowProxy&gt; domWindow(do_GetInterface(childAsItem));</span>
<a href="#l37.21"></a><span id="l37.21">   NS_ENSURE_TRUE(domWindow, NS_ERROR_FAILURE);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgPrompts.cpp</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgPrompts.cpp</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -49,23 +49,23 @@ nsMsgBuildMessageByName(const char16_t *</span>
<a href="#l38.4"></a><span id="l38.4"> </span>
<a href="#l38.5"></a><span id="l38.5">   const char16_t *params[1] = {path.get()};</span>
<a href="#l38.6"></a><span id="l38.6">   return bundle-&gt;FormatStringFromName(aName, params, 1, getter_Copies(aResult));</span>
<a href="#l38.7"></a><span id="l38.7"> }</span>
<a href="#l38.8"></a><span id="l38.8"> </span>
<a href="#l38.9"></a><span id="l38.9"> nsresult</span>
<a href="#l38.10"></a><span id="l38.10"> nsMsgBuildMessageWithFile(nsIFile *aFile, nsString&amp; aResult)</span>
<a href="#l38.11"></a><span id="l38.11"> {</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-  return nsMsgBuildMessageByName(MOZ_UTF16(&quot;unableToOpenFile&quot;), aFile, aResult);</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+  return nsMsgBuildMessageByName(u&quot;unableToOpenFile&quot;, aFile, aResult);</span>
<a href="#l38.14"></a><span id="l38.14"> }</span>
<a href="#l38.15"></a><span id="l38.15"> </span>
<a href="#l38.16"></a><span id="l38.16"> nsresult</span>
<a href="#l38.17"></a><span id="l38.17"> nsMsgBuildMessageWithTmpFile(nsIFile *aFile, nsString&amp; aResult)</span>
<a href="#l38.18"></a><span id="l38.18"> {</span>
<a href="#l38.19"></a><span id="l38.19" class="difflineminus">-  return nsMsgBuildMessageByName(MOZ_UTF16(&quot;unableToOpenTmpFile&quot;), aFile, aResult);</span>
<a href="#l38.20"></a><span id="l38.20" class="difflineplus">+  return nsMsgBuildMessageByName(u&quot;unableToOpenTmpFile&quot;, aFile, aResult);</span>
<a href="#l38.21"></a><span id="l38.21"> }</span>
<a href="#l38.22"></a><span id="l38.22"> </span>
<a href="#l38.23"></a><span id="l38.23"> nsresult</span>
<a href="#l38.24"></a><span id="l38.24"> nsMsgDisplayMessageByName(nsIPrompt *aPrompt, const char16_t* aName, const char16_t *windowTitle)</span>
<a href="#l38.25"></a><span id="l38.25"> {</span>
<a href="#l38.26"></a><span id="l38.26">   nsString msg;</span>
<a href="#l38.27"></a><span id="l38.27">   nsMsgGetMessageByName(aName, msg);</span>
<a href="#l38.28"></a><span id="l38.28">   return nsMsgDisplayMessageByString(aPrompt, msg.get(), windowTitle);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSend.cpp</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSend.cpp</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -556,17 +556,17 @@ nsMsgComposeAndSend::GatherMimeAttachmen</span>
<a href="#l39.4"></a><span id="l39.4"> </span>
<a href="#l39.5"></a><span id="l39.5">   /* Kludge to avoid having to allocate memory on the toy computers... */</span>
<a href="#l39.6"></a><span id="l39.6">   buffer = mime_get_stream_write_buffer();</span>
<a href="#l39.7"></a><span id="l39.7">   if (! buffer)</span>
<a href="#l39.8"></a><span id="l39.8">     goto FAILMEM;</span>
<a href="#l39.9"></a><span id="l39.9"> </span>
<a href="#l39.10"></a><span id="l39.10">   NS_ASSERTION (m_attachment_pending_count == 0, &quot;m_attachment_pending_count != 0&quot;);</span>
<a href="#l39.11"></a><span id="l39.11"> </span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-  mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;assemblingMessage&quot;),</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+  mComposeBundle-&gt;GetStringFromName(u&quot;assemblingMessage&quot;,</span>
<a href="#l39.14"></a><span id="l39.14">                                     getter_Copies(msg));</span>
<a href="#l39.15"></a><span id="l39.15">   SetStatusMessage( msg );</span>
<a href="#l39.16"></a><span id="l39.16"> </span>
<a href="#l39.17"></a><span id="l39.17">   /* First, open the message file.</span>
<a href="#l39.18"></a><span id="l39.18">   */</span>
<a href="#l39.19"></a><span id="l39.19">   rv = nsMsgCreateTempFile(&quot;nsemail.eml&quot;, getter_AddRefs(mTempFile));</span>
<a href="#l39.20"></a><span id="l39.20">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l39.21"></a><span id="l39.21"> </span>
<a href="#l39.22"></a><span id="l39.22" class="difflineat">@@ -923,17 +923,17 @@ nsMsgComposeAndSend::GatherMimeAttachmen</span>
<a href="#l39.23"></a><span id="l39.23">         if (m_attachments[i]-&gt;mMHTMLPart)</span>
<a href="#l39.24"></a><span id="l39.24">           PreProcessPart(m_attachments[i], m_related_part);</span>
<a href="#l39.25"></a><span id="l39.25">       }</span>
<a href="#l39.26"></a><span id="l39.26">     }</span>
<a href="#l39.27"></a><span id="l39.27"> </span>
<a href="#l39.28"></a><span id="l39.28">   }</span>
<a href="#l39.29"></a><span id="l39.29"> </span>
<a href="#l39.30"></a><span id="l39.30">   // Tell the user we are creating the message...</span>
<a href="#l39.31"></a><span id="l39.31" class="difflineminus">-  mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;creatingMailMessage&quot;),</span>
<a href="#l39.32"></a><span id="l39.32" class="difflineplus">+  mComposeBundle-&gt;GetStringFromName(u&quot;creatingMailMessage&quot;,</span>
<a href="#l39.33"></a><span id="l39.33">                                     getter_Copies(msg));</span>
<a href="#l39.34"></a><span id="l39.34">   SetStatusMessage( msg );</span>
<a href="#l39.35"></a><span id="l39.35"> </span>
<a href="#l39.36"></a><span id="l39.36">   // OK, now actually write the structure we've carefully built up.</span>
<a href="#l39.37"></a><span id="l39.37">   status = toppart-&gt;Write();</span>
<a href="#l39.38"></a><span id="l39.38">   if (NS_FAILED(status))</span>
<a href="#l39.39"></a><span id="l39.39">     goto FAIL;</span>
<a href="#l39.40"></a><span id="l39.40"> </span>
<a href="#l39.41"></a><span id="l39.41" class="difflineat">@@ -966,17 +966,17 @@ nsMsgComposeAndSend::GatherMimeAttachmen</span>
<a href="#l39.42"></a><span id="l39.42">     rv = mTempFile-&gt;GetFileSize(&amp;fileSize);</span>
<a href="#l39.43"></a><span id="l39.43">     if (NS_FAILED(rv) || fileSize == 0)</span>
<a href="#l39.44"></a><span id="l39.44">     {</span>
<a href="#l39.45"></a><span id="l39.45">       status = NS_MSG_ERROR_WRITING_FILE;</span>
<a href="#l39.46"></a><span id="l39.46">       goto FAIL;</span>
<a href="#l39.47"></a><span id="l39.47">     }</span>
<a href="#l39.48"></a><span id="l39.48">   }</span>
<a href="#l39.49"></a><span id="l39.49"> </span>
<a href="#l39.50"></a><span id="l39.50" class="difflineminus">-  mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;assemblingMessageDone&quot;),</span>
<a href="#l39.51"></a><span id="l39.51" class="difflineplus">+  mComposeBundle-&gt;GetStringFromName(u&quot;assemblingMessageDone&quot;,</span>
<a href="#l39.52"></a><span id="l39.52">                                     getter_Copies(msg));</span>
<a href="#l39.53"></a><span id="l39.53">   SetStatusMessage(msg);</span>
<a href="#l39.54"></a><span id="l39.54"> </span>
<a href="#l39.55"></a><span id="l39.55">   if (m_dont_deliver_p &amp;&amp; mListener)</span>
<a href="#l39.56"></a><span id="l39.56">   {</span>
<a href="#l39.57"></a><span id="l39.57">     //</span>
<a href="#l39.58"></a><span id="l39.58">     // Need to ditch the file spec here so that we don't delete the</span>
<a href="#l39.59"></a><span id="l39.59">     // file, since in this case, the caller wants the file</span>
<a href="#l39.60"></a><span id="l39.60" class="difflineat">@@ -2516,17 +2516,17 @@ nsMsgComposeAndSend::HackAttachments(nsI</span>
<a href="#l39.61"></a><span id="l39.61">       if (!params.IsEmpty()) {</span>
<a href="#l39.62"></a><span id="l39.62">         formatParams[0] = params.get();</span>
<a href="#l39.63"></a><span id="l39.63">       } else if (m_attachments[i]-&gt;mURL) {</span>
<a href="#l39.64"></a><span id="l39.64">         nsCString asciiSpec;</span>
<a href="#l39.65"></a><span id="l39.65">         m_attachments[i]-&gt;mURL-&gt;GetAsciiSpec(asciiSpec);</span>
<a href="#l39.66"></a><span id="l39.66">         attachmentFileName.AssignASCII(asciiSpec.get());</span>
<a href="#l39.67"></a><span id="l39.67">         formatParams[0] = attachmentFileName.get();</span>
<a href="#l39.68"></a><span id="l39.68">       }</span>
<a href="#l39.69"></a><span id="l39.69" class="difflineminus">-      mComposeBundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;gatheringAttachment&quot;),</span>
<a href="#l39.70"></a><span id="l39.70" class="difflineplus">+      mComposeBundle-&gt;FormatStringFromName(u&quot;gatheringAttachment&quot;,</span>
<a href="#l39.71"></a><span id="l39.71">                                            formatParams, 1, getter_Copies(msg));</span>
<a href="#l39.72"></a><span id="l39.72"> </span>
<a href="#l39.73"></a><span id="l39.73">       if (!msg.IsEmpty())</span>
<a href="#l39.74"></a><span id="l39.74">       {</span>
<a href="#l39.75"></a><span id="l39.75">         SetStatusMessage(msg);</span>
<a href="#l39.76"></a><span id="l39.76">       }</span>
<a href="#l39.77"></a><span id="l39.77"> </span>
<a href="#l39.78"></a><span id="l39.78">       /* As SnarfAttachment will call GatherMimeAttachments when it will be done (this is an async process),</span>
<a href="#l39.79"></a><span id="l39.79" class="difflineat">@@ -2544,17 +2544,17 @@ nsMsgComposeAndSend::HackAttachments(nsI</span>
<a href="#l39.80"></a><span id="l39.80">           m_attachments[i]-&gt;mURL-&gt;GetAsciiSpec(asciiSpec);</span>
<a href="#l39.81"></a><span id="l39.81">           attachmentFileName.AssignASCII(asciiSpec.get());</span>
<a href="#l39.82"></a><span id="l39.82">           rv = NS_OK;</span>
<a href="#l39.83"></a><span id="l39.83">         }</span>
<a href="#l39.84"></a><span id="l39.84">         if (NS_SUCCEEDED(rv))</span>
<a href="#l39.85"></a><span id="l39.85">         {</span>
<a href="#l39.86"></a><span id="l39.86">           nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l39.87"></a><span id="l39.87">           const char16_t *params[] = { attachmentFileName.get() };</span>
<a href="#l39.88"></a><span id="l39.88" class="difflineminus">-          mComposeBundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;errorAttachingFile&quot;),</span>
<a href="#l39.89"></a><span id="l39.89" class="difflineplus">+          mComposeBundle-&gt;FormatStringFromName(u&quot;errorAttachingFile&quot;,</span>
<a href="#l39.90"></a><span id="l39.90">                                                params, 1,</span>
<a href="#l39.91"></a><span id="l39.91">                                                getter_Copies(errorMsg));</span>
<a href="#l39.92"></a><span id="l39.92">           mSendReport-&gt;SetMessage(nsIMsgSendReport::process_Current, errorMsg.get(), false);</span>
<a href="#l39.93"></a><span id="l39.93">           mSendReport-&gt;SetError(nsIMsgSendReport::process_Current,</span>
<a href="#l39.94"></a><span id="l39.94">                                 NS_MSG_ERROR_ATTACHING_FILE,</span>
<a href="#l39.95"></a><span id="l39.95">                                 false);</span>
<a href="#l39.96"></a><span id="l39.96">         }</span>
<a href="#l39.97"></a><span id="l39.97">         return NS_MSG_ERROR_ATTACHING_FILE;</span>
<a href="#l39.98"></a><span id="l39.98" class="difflineat">@@ -3036,17 +3036,17 @@ nsMsgComposeAndSend::Init(</span>
<a href="#l39.99"></a><span id="l39.99">       mozilla::services::GetStringBundleService();</span>
<a href="#l39.100"></a><span id="l39.100">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l39.101"></a><span id="l39.101">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l39.102"></a><span id="l39.102">     rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;, getter_AddRefs(mComposeBundle));</span>
<a href="#l39.103"></a><span id="l39.103">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l39.104"></a><span id="l39.104">   }</span>
<a href="#l39.105"></a><span id="l39.105"> </span>
<a href="#l39.106"></a><span id="l39.106">   // Tell the user we are assembling the message...</span>
<a href="#l39.107"></a><span id="l39.107" class="difflineminus">-  mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;assemblingMailInformation&quot;), getter_Copies(msg));</span>
<a href="#l39.108"></a><span id="l39.108" class="difflineplus">+  mComposeBundle-&gt;GetStringFromName(u&quot;assemblingMailInformation&quot;, getter_Copies(msg));</span>
<a href="#l39.109"></a><span id="l39.109">   SetStatusMessage(msg);</span>
<a href="#l39.110"></a><span id="l39.110">   if (mSendReport)</span>
<a href="#l39.111"></a><span id="l39.111">     mSendReport-&gt;SetCurrentProcess(nsIMsgSendReport::process_BuildMessage);</span>
<a href="#l39.112"></a><span id="l39.112"> </span>
<a href="#l39.113"></a><span id="l39.113">   //</span>
<a href="#l39.114"></a><span id="l39.114">   // The Init() method should initialize a send operation for full</span>
<a href="#l39.115"></a><span id="l39.115">   // blown create and send operations as well as just the &quot;send a file&quot;</span>
<a href="#l39.116"></a><span id="l39.116">   // operations.</span>
<a href="#l39.117"></a><span id="l39.117" class="difflineat">@@ -3231,17 +3231,17 @@ nsMsgComposeAndSend::DeliverMessage()</span>
<a href="#l39.118"></a><span id="l39.118"> </span>
<a href="#l39.119"></a><span id="l39.119">   if ((mMessageWarningSize &gt; 0) &amp;&amp; (fileSize &gt; mMessageWarningSize) &amp;&amp; (mGUINotificationEnabled))</span>
<a href="#l39.120"></a><span id="l39.120">   {</span>
<a href="#l39.121"></a><span id="l39.121">     bool abortTheSend = false;</span>
<a href="#l39.122"></a><span id="l39.122">     nsString msg;</span>
<a href="#l39.123"></a><span id="l39.123">     nsAutoString formattedFileSize;</span>
<a href="#l39.124"></a><span id="l39.124">     FormatFileSize(fileSize, true, formattedFileSize);</span>
<a href="#l39.125"></a><span id="l39.125">     const char16_t* params[] = { formattedFileSize.get() };</span>
<a href="#l39.126"></a><span id="l39.126" class="difflineminus">-    mComposeBundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;largeMessageSendWarning&quot;),</span>
<a href="#l39.127"></a><span id="l39.127" class="difflineplus">+    mComposeBundle-&gt;FormatStringFromName(u&quot;largeMessageSendWarning&quot;,</span>
<a href="#l39.128"></a><span id="l39.128">                                          params, 1, getter_Copies(msg));</span>
<a href="#l39.129"></a><span id="l39.129"> </span>
<a href="#l39.130"></a><span id="l39.130">     if (!msg.IsEmpty())</span>
<a href="#l39.131"></a><span id="l39.131">     {</span>
<a href="#l39.132"></a><span id="l39.132">       nsCOMPtr&lt;nsIPrompt&gt; prompt;</span>
<a href="#l39.133"></a><span id="l39.133">       GetDefaultPrompt(getter_AddRefs(prompt));</span>
<a href="#l39.134"></a><span id="l39.134">       nsMsgAskBooleanQuestionByString(prompt, msg.get(), &amp;abortTheSend);</span>
<a href="#l39.135"></a><span id="l39.135">       if (!abortTheSend)</span>
<a href="#l39.136"></a><span id="l39.136" class="difflineat">@@ -3390,17 +3390,17 @@ nsMsgComposeAndSend::DeliverFileAsMail()</span>
<a href="#l39.137"></a><span id="l39.137">     // to the top most mail window...after all, that's where we are going to be sending status</span>
<a href="#l39.138"></a><span id="l39.138">     // update information too....</span>
<a href="#l39.139"></a><span id="l39.139"> </span>
<a href="#l39.140"></a><span id="l39.140">     nsCOMPtr&lt;nsIInterfaceRequestor&gt; callbacks;</span>
<a href="#l39.141"></a><span id="l39.141">     GetNotificationCallbacks(getter_AddRefs(callbacks));</span>
<a href="#l39.142"></a><span id="l39.142"> </span>
<a href="#l39.143"></a><span id="l39.143">     // Tell the user we are sending the message!</span>
<a href="#l39.144"></a><span id="l39.144">     nsString msg;</span>
<a href="#l39.145"></a><span id="l39.145" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;sendingMessage&quot;), getter_Copies(msg));</span>
<a href="#l39.146"></a><span id="l39.146" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(u&quot;sendingMessage&quot;, getter_Copies(msg));</span>
<a href="#l39.147"></a><span id="l39.147">     SetStatusMessage(msg);</span>
<a href="#l39.148"></a><span id="l39.148">     nsCOMPtr&lt;nsIMsgStatusFeedback&gt; msgStatus (do_QueryInterface(mSendProgress));</span>
<a href="#l39.149"></a><span id="l39.149">     // if the sendProgress isn't set, let's use the member variable.</span>
<a href="#l39.150"></a><span id="l39.150">     if (!msgStatus)</span>
<a href="#l39.151"></a><span id="l39.151">       msgStatus = do_QueryInterface(mStatusFeedback);</span>
<a href="#l39.152"></a><span id="l39.152"> </span>
<a href="#l39.153"></a><span id="l39.153">     nsCOMPtr&lt;nsIURI&gt; runningUrl;</span>
<a href="#l39.154"></a><span id="l39.154">     rv = smtpService-&gt;SendMailMessage(mTempFile, buf, mUserIdentity,</span>
<a href="#l39.155"></a><span id="l39.155" class="difflineat">@@ -3439,17 +3439,17 @@ nsMsgComposeAndSend::DeliverFileAsNews()</span>
<a href="#l39.156"></a><span id="l39.156">   if (NS_SUCCEEDED(rv) &amp;&amp; nntpService)</span>
<a href="#l39.157"></a><span id="l39.157">   {</span>
<a href="#l39.158"></a><span id="l39.158">     MsgDeliveryListener *deliveryListener = new MsgDeliveryListener(this, true);</span>
<a href="#l39.159"></a><span id="l39.159">     if (!deliveryListener)</span>
<a href="#l39.160"></a><span id="l39.160">       return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l39.161"></a><span id="l39.161"> </span>
<a href="#l39.162"></a><span id="l39.162">     // Tell the user we are posting the message!</span>
<a href="#l39.163"></a><span id="l39.163">     nsString msg;</span>
<a href="#l39.164"></a><span id="l39.164" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;postingMessage&quot;),</span>
<a href="#l39.165"></a><span id="l39.165" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(u&quot;postingMessage&quot;,</span>
<a href="#l39.166"></a><span id="l39.166">                                       getter_Copies(msg));</span>
<a href="#l39.167"></a><span id="l39.167">     SetStatusMessage(msg);</span>
<a href="#l39.168"></a><span id="l39.168"> </span>
<a href="#l39.169"></a><span id="l39.169">     nsCOMPtr &lt;nsIMsgMailSession&gt; mailSession = do_GetService(NS_MSGMAILSESSION_CONTRACTID, &amp;rv);</span>
<a href="#l39.170"></a><span id="l39.170">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l39.171"></a><span id="l39.171"> </span>
<a href="#l39.172"></a><span id="l39.172">     // JFD TODO: we should use GetDefaultPrompt instead</span>
<a href="#l39.173"></a><span id="l39.173">     nsCOMPtr&lt;nsIMsgWindow&gt; msgWindow;</span>
<a href="#l39.174"></a><span id="l39.174" class="difflineat">@@ -3489,17 +3489,17 @@ nsMsgComposeAndSend::Fail(nsresult aFail</span>
<a href="#l39.175"></a><span id="l39.175">       }</span>
<a href="#l39.176"></a><span id="l39.176">       mSendReport-&gt;SetError(nsIMsgSendReport::process_Current, aFailureCode, false);</span>
<a href="#l39.177"></a><span id="l39.177">       mSendReport-&gt;SetMessage(nsIMsgSendReport::process_Current, aErrorMsg, false);</span>
<a href="#l39.178"></a><span id="l39.178">       mSendReport-&gt;DisplayReport(prompt, true, true, aResult);</span>
<a href="#l39.179"></a><span id="l39.179">     }</span>
<a href="#l39.180"></a><span id="l39.180">     else</span>
<a href="#l39.181"></a><span id="l39.181">     {</span>
<a href="#l39.182"></a><span id="l39.182">       if (aFailureCode != NS_ERROR_BUT_DONT_SHOW_ALERT)</span>
<a href="#l39.183"></a><span id="l39.183" class="difflineminus">-        nsMsgDisplayMessageByName(prompt, MOZ_UTF16(&quot;sendFailed&quot;));</span>
<a href="#l39.184"></a><span id="l39.184" class="difflineplus">+        nsMsgDisplayMessageByName(prompt, u&quot;sendFailed&quot;);</span>
<a href="#l39.185"></a><span id="l39.185">     }</span>
<a href="#l39.186"></a><span id="l39.186">   }</span>
<a href="#l39.187"></a><span id="l39.187"> </span>
<a href="#l39.188"></a><span id="l39.188">   if (NS_SUCCEEDED(m_status))</span>
<a href="#l39.189"></a><span id="l39.189">     m_status = NS_ERROR_BUT_DONT_SHOW_ALERT;</span>
<a href="#l39.190"></a><span id="l39.190"> </span>
<a href="#l39.191"></a><span id="l39.191">   //Stop any pending process...</span>
<a href="#l39.192"></a><span id="l39.192">   Abort();</span>
<a href="#l39.193"></a><span id="l39.193" class="difflineat">@@ -3797,19 +3797,19 @@ NS_IMETHODIMP</span>
<a href="#l39.194"></a><span id="l39.194"> nsMsgComposeAndSend::NotifyListenerOnStopCopy(nsresult aStatus)</span>
<a href="#l39.195"></a><span id="l39.195"> {</span>
<a href="#l39.196"></a><span id="l39.196">   // This is one per copy so make sure we clean this up first.</span>
<a href="#l39.197"></a><span id="l39.197">   mCopyObj = nullptr;</span>
<a href="#l39.198"></a><span id="l39.198"> </span>
<a href="#l39.199"></a><span id="l39.199">   // Set a status message...</span>
<a href="#l39.200"></a><span id="l39.200">   nsString msg;</span>
<a href="#l39.201"></a><span id="l39.201">   if (NS_SUCCEEDED(aStatus))</span>
<a href="#l39.202"></a><span id="l39.202" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;copyMessageComplete&quot;), getter_Copies(msg));</span>
<a href="#l39.203"></a><span id="l39.203" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(u&quot;copyMessageComplete&quot;, getter_Copies(msg));</span>
<a href="#l39.204"></a><span id="l39.204">   else</span>
<a href="#l39.205"></a><span id="l39.205" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;copyMessageFailed&quot;), getter_Copies(msg));</span>
<a href="#l39.206"></a><span id="l39.206" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(u&quot;copyMessageFailed&quot;, getter_Copies(msg));</span>
<a href="#l39.207"></a><span id="l39.207"> </span>
<a href="#l39.208"></a><span id="l39.208">   SetStatusMessage(msg);</span>
<a href="#l39.209"></a><span id="l39.209">   nsCOMPtr&lt;nsIPrompt&gt; prompt;</span>
<a href="#l39.210"></a><span id="l39.210">   GetDefaultPrompt(getter_AddRefs(prompt));</span>
<a href="#l39.211"></a><span id="l39.211"> </span>
<a href="#l39.212"></a><span id="l39.212">   if (NS_FAILED(aStatus))</span>
<a href="#l39.213"></a><span id="l39.213">   {</span>
<a href="#l39.214"></a><span id="l39.214">     nsresult rv;</span>
<a href="#l39.215"></a><span id="l39.215" class="difflineat">@@ -3818,17 +3818,17 @@ nsMsgComposeAndSend::NotifyListenerOnSto</span>
<a href="#l39.216"></a><span id="l39.216">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l39.217"></a><span id="l39.217">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l39.218"></a><span id="l39.218">     rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l39.219"></a><span id="l39.219">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l39.220"></a><span id="l39.220"> </span>
<a href="#l39.221"></a><span id="l39.221">     nsString msg;</span>
<a href="#l39.222"></a><span id="l39.222">     const char16_t *formatStrings[] = { mSavedToFolderName.get() };</span>
<a href="#l39.223"></a><span id="l39.223"> </span>
<a href="#l39.224"></a><span id="l39.224" class="difflineminus">-    rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;errorSavingMsg&quot;),</span>
<a href="#l39.225"></a><span id="l39.225" class="difflineplus">+    rv = bundle-&gt;FormatStringFromName(u&quot;errorSavingMsg&quot;,</span>
<a href="#l39.226"></a><span id="l39.226">                                       formatStrings, 1,</span>
<a href="#l39.227"></a><span id="l39.227">                                       getter_Copies(msg));</span>
<a href="#l39.228"></a><span id="l39.228">     if (NS_SUCCEEDED(rv))</span>
<a href="#l39.229"></a><span id="l39.229">     {</span>
<a href="#l39.230"></a><span id="l39.230">       bool retry = false;</span>
<a href="#l39.231"></a><span id="l39.231">       nsMsgAskBooleanQuestionByString(prompt, msg.get(), &amp;retry, nullptr);</span>
<a href="#l39.232"></a><span id="l39.232">       if (retry)</span>
<a href="#l39.233"></a><span id="l39.233">       {</span>
<a href="#l39.234"></a><span id="l39.234" class="difflineat">@@ -3892,25 +3892,25 @@ nsMsgComposeAndSend::FilterSentMessage()</span>
<a href="#l39.235"></a><span id="l39.235"> }</span>
<a href="#l39.236"></a><span id="l39.236"> </span>
<a href="#l39.237"></a><span id="l39.237"> NS_IMETHODIMP</span>
<a href="#l39.238"></a><span id="l39.238"> nsMsgComposeAndSend::OnStopOperation(nsresult aStatus)</span>
<a href="#l39.239"></a><span id="l39.239"> {</span>
<a href="#l39.240"></a><span id="l39.240">   // Set a status message...</span>
<a href="#l39.241"></a><span id="l39.241">   nsString msg;</span>
<a href="#l39.242"></a><span id="l39.242">   if (NS_SUCCEEDED(aStatus))</span>
<a href="#l39.243"></a><span id="l39.243" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;filterMessageComplete&quot;), getter_Copies(msg));</span>
<a href="#l39.244"></a><span id="l39.244" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(u&quot;filterMessageComplete&quot;, getter_Copies(msg));</span>
<a href="#l39.245"></a><span id="l39.245">   else</span>
<a href="#l39.246"></a><span id="l39.246" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;filterMessageFailed&quot;), getter_Copies(msg));</span>
<a href="#l39.247"></a><span id="l39.247" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(u&quot;filterMessageFailed&quot;, getter_Copies(msg));</span>
<a href="#l39.248"></a><span id="l39.248"> </span>
<a href="#l39.249"></a><span id="l39.249">   SetStatusMessage(msg);</span>
<a href="#l39.250"></a><span id="l39.250"> </span>
<a href="#l39.251"></a><span id="l39.251">   if (NS_FAILED(aStatus))</span>
<a href="#l39.252"></a><span id="l39.252">   {</span>
<a href="#l39.253"></a><span id="l39.253" class="difflineminus">-    nsresult rv = mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;errorFilteringMsg&quot;), getter_Copies(msg));</span>
<a href="#l39.254"></a><span id="l39.254" class="difflineplus">+    nsresult rv = mComposeBundle-&gt;GetStringFromName(u&quot;errorFilteringMsg&quot;, getter_Copies(msg));</span>
<a href="#l39.255"></a><span id="l39.255">     if (NS_SUCCEEDED(rv))</span>
<a href="#l39.256"></a><span id="l39.256">     {</span>
<a href="#l39.257"></a><span id="l39.257">       nsCOMPtr&lt;nsIPrompt&gt; prompt;</span>
<a href="#l39.258"></a><span id="l39.258">       GetDefaultPrompt(getter_AddRefs(prompt));</span>
<a href="#l39.259"></a><span id="l39.259">       nsMsgDisplayMessageByString(prompt, msg.get(), nullptr);</span>
<a href="#l39.260"></a><span id="l39.260">     }</span>
<a href="#l39.261"></a><span id="l39.261"> </span>
<a href="#l39.262"></a><span id="l39.262">     // We failed, however, give Fail a success code so that it doesn't prompt</span>
<a href="#l39.263"></a><span id="l39.263" class="difflineat">@@ -4329,17 +4329,17 @@ nsMsgComposeAndSend::MimeDoFCC(nsIFile  </span>
<a href="#l39.264"></a><span id="l39.264">     turi = fcc_header;</span>
<a href="#l39.265"></a><span id="l39.265">   else</span>
<a href="#l39.266"></a><span id="l39.266">     GetFolderURIFromUserPrefs(mode, mUserIdentity, turi);</span>
<a href="#l39.267"></a><span id="l39.267">   status = MessageFolderIsLocal(mUserIdentity, mode, turi.get(), &amp;folderIsLocal);</span>
<a href="#l39.268"></a><span id="l39.268">   if (NS_FAILED(status))</span>
<a href="#l39.269"></a><span id="l39.269">     goto FAIL;</span>
<a href="#l39.270"></a><span id="l39.270"> </span>
<a href="#l39.271"></a><span id="l39.271">   // Tell the user we are copying the message...</span>
<a href="#l39.272"></a><span id="l39.272" class="difflineminus">-  mComposeBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;copyMessageStart&quot;),</span>
<a href="#l39.273"></a><span id="l39.273" class="difflineplus">+  mComposeBundle-&gt;GetStringFromName(u&quot;copyMessageStart&quot;,</span>
<a href="#l39.274"></a><span id="l39.274">                                     getter_Copies(msg));</span>
<a href="#l39.275"></a><span id="l39.275">   if (!msg.IsEmpty())</span>
<a href="#l39.276"></a><span id="l39.276">   {</span>
<a href="#l39.277"></a><span id="l39.277">     nsCOMPtr&lt;nsIRDFService&gt; rdfService = do_GetService(kRDFServiceCID);</span>
<a href="#l39.278"></a><span id="l39.278">     if (rdfService)</span>
<a href="#l39.279"></a><span id="l39.279">     {</span>
<a href="#l39.280"></a><span id="l39.280">       nsCOMPtr&lt;nsIRDFResource&gt; res;</span>
<a href="#l39.281"></a><span id="l39.281">       rdfService-&gt;GetResource(turi, getter_AddRefs(res));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSendLater.cpp</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSendLater.cpp</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -244,17 +244,17 @@ nsMsgSendLater::OnStopRequest(nsIRequest</span>
<a href="#l40.4"></a><span id="l40.4">     nsCOMPtr&lt;nsIPrompt&gt; promptObject;</span>
<a href="#l40.5"></a><span id="l40.5">     if (channel)</span>
<a href="#l40.6"></a><span id="l40.6">     {</span>
<a href="#l40.7"></a><span id="l40.7">       channel-&gt;GetURI(getter_AddRefs(uri));</span>
<a href="#l40.8"></a><span id="l40.8">       nsCOMPtr&lt;nsISmtpUrl&gt; smtpUrl (do_QueryInterface(uri));</span>
<a href="#l40.9"></a><span id="l40.9">       if (smtpUrl)</span>
<a href="#l40.10"></a><span id="l40.10">         smtpUrl-&gt;GetPrompt(getter_AddRefs(promptObject));</span>
<a href="#l40.11"></a><span id="l40.11">     }</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-    nsMsgDisplayMessageByName(promptObject, MOZ_UTF16(&quot;errorQueuedDeliveryFailed&quot;));</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+    nsMsgDisplayMessageByName(promptObject, u&quot;errorQueuedDeliveryFailed&quot;);</span>
<a href="#l40.14"></a><span id="l40.14"> </span>
<a href="#l40.15"></a><span id="l40.15">     // Getting the data failed, but we will still keep trying to send the rest...</span>
<a href="#l40.16"></a><span id="l40.16">     rv = StartNextMailFileSend(status);</span>
<a href="#l40.17"></a><span id="l40.17">     if (NS_FAILED(rv))</span>
<a href="#l40.18"></a><span id="l40.18">       EndSendMessages(rv, nullptr, mTotalSendCount, mTotalSentSuccessfully);</span>
<a href="#l40.19"></a><span id="l40.19">   }</span>
<a href="#l40.20"></a><span id="l40.20"> </span>
<a href="#l40.21"></a><span id="l40.21">   return rv;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSendReport.cpp</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSendReport.cpp</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -297,56 +297,56 @@ NS_IMETHODIMP nsMsgSendReport::DisplayRe</span>
<a href="#l41.4"></a><span id="l41.4">     // SMTP is taking care of it's own error message and will return NS_ERROR_BUT_DONT_SHOW_ALERT as error code.</span>
<a href="#l41.5"></a><span id="l41.5">     // In that case, we must not show an alert ourself.</span>
<a href="#l41.6"></a><span id="l41.6">     if (currError == NS_ERROR_BUT_DONT_SHOW_ALERT)</span>
<a href="#l41.7"></a><span id="l41.7">     {</span>
<a href="#l41.8"></a><span id="l41.8">       mAlreadyDisplayReport = true;</span>
<a href="#l41.9"></a><span id="l41.9">       return NS_OK;</span>
<a href="#l41.10"></a><span id="l41.10">     }</span>
<a href="#l41.11"></a><span id="l41.11"> </span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-    bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;sendMessageErrorTitle&quot;),</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+    bundle-&gt;GetStringFromName(u&quot;sendMessageErrorTitle&quot;,</span>
<a href="#l41.14"></a><span id="l41.14">                               getter_Copies(dialogTitle));</span>
<a href="#l41.15"></a><span id="l41.15"> </span>
<a href="#l41.16"></a><span id="l41.16" class="difflineminus">-    const char16_t* preStrName = MOZ_UTF16(&quot;sendFailed&quot;);</span>
<a href="#l41.17"></a><span id="l41.17" class="difflineplus">+    const char16_t* preStrName = u&quot;sendFailed&quot;;</span>
<a href="#l41.18"></a><span id="l41.18">     bool askToGoBackToCompose = false;</span>
<a href="#l41.19"></a><span id="l41.19">     switch (mCurrentProcess)</span>
<a href="#l41.20"></a><span id="l41.20">     {</span>
<a href="#l41.21"></a><span id="l41.21">       case process_BuildMessage :</span>
<a href="#l41.22"></a><span id="l41.22" class="difflineminus">-        preStrName = MOZ_UTF16(&quot;sendFailed&quot;);</span>
<a href="#l41.23"></a><span id="l41.23" class="difflineplus">+        preStrName = u&quot;sendFailed&quot;;</span>
<a href="#l41.24"></a><span id="l41.24">         askToGoBackToCompose = false;</span>
<a href="#l41.25"></a><span id="l41.25">         break;</span>
<a href="#l41.26"></a><span id="l41.26">       case process_NNTP :</span>
<a href="#l41.27"></a><span id="l41.27" class="difflineminus">-        preStrName = MOZ_UTF16(&quot;sendFailed&quot;);</span>
<a href="#l41.28"></a><span id="l41.28" class="difflineplus">+        preStrName = u&quot;sendFailed&quot;;</span>
<a href="#l41.29"></a><span id="l41.29">         askToGoBackToCompose = false;</span>
<a href="#l41.30"></a><span id="l41.30">         break;</span>
<a href="#l41.31"></a><span id="l41.31">       case process_SMTP :</span>
<a href="#l41.32"></a><span id="l41.32">         bool nntpProceeded;</span>
<a href="#l41.33"></a><span id="l41.33">         mProcessReport[process_NNTP]-&gt;GetProceeded(&amp;nntpProceeded);</span>
<a href="#l41.34"></a><span id="l41.34">         if (nntpProceeded)</span>
<a href="#l41.35"></a><span id="l41.35" class="difflineminus">-          preStrName = MOZ_UTF16(&quot;sendFailedButNntpOk&quot;);</span>
<a href="#l41.36"></a><span id="l41.36" class="difflineplus">+          preStrName = u&quot;sendFailedButNntpOk&quot;;</span>
<a href="#l41.37"></a><span id="l41.37">         else</span>
<a href="#l41.38"></a><span id="l41.38" class="difflineminus">-          preStrName = MOZ_UTF16(&quot;sendFailed&quot;);</span>
<a href="#l41.39"></a><span id="l41.39" class="difflineplus">+          preStrName = u&quot;sendFailed&quot;;</span>
<a href="#l41.40"></a><span id="l41.40">         askToGoBackToCompose = false;</span>
<a href="#l41.41"></a><span id="l41.41">         break;</span>
<a href="#l41.42"></a><span id="l41.42">       case process_Copy:</span>
<a href="#l41.43"></a><span id="l41.43" class="difflineminus">-        preStrName = MOZ_UTF16(&quot;failedCopyOperation&quot;);</span>
<a href="#l41.44"></a><span id="l41.44" class="difflineplus">+        preStrName = u&quot;failedCopyOperation&quot;;</span>
<a href="#l41.45"></a><span id="l41.45">         askToGoBackToCompose = (mDeliveryMode == nsIMsgCompDeliverMode::Now);</span>
<a href="#l41.46"></a><span id="l41.46">         break;</span>
<a href="#l41.47"></a><span id="l41.47">       case process_FCC:</span>
<a href="#l41.48"></a><span id="l41.48" class="difflineminus">-        preStrName = MOZ_UTF16(&quot;failedCopyOperation&quot;);</span>
<a href="#l41.49"></a><span id="l41.49" class="difflineplus">+        preStrName = u&quot;failedCopyOperation&quot;;</span>
<a href="#l41.50"></a><span id="l41.50">         askToGoBackToCompose = (mDeliveryMode == nsIMsgCompDeliverMode::Now);</span>
<a href="#l41.51"></a><span id="l41.51">         break;</span>
<a href="#l41.52"></a><span id="l41.52">     }</span>
<a href="#l41.53"></a><span id="l41.53">     bundle-&gt;GetStringFromName(preStrName, getter_Copies(dialogMessage));</span>
<a href="#l41.54"></a><span id="l41.54"> </span>
<a href="#l41.55"></a><span id="l41.55">     //Do we already have an error message?</span>
<a href="#l41.56"></a><span id="l41.56">     if (!askToGoBackToCompose &amp;&amp; currMessage.IsEmpty())</span>
<a href="#l41.57"></a><span id="l41.57">     {</span>
<a href="#l41.58"></a><span id="l41.58">       //we don't have an error description but we can put a generic explanation</span>
<a href="#l41.59"></a><span id="l41.59" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;genericFailureExplanation&quot;),</span>
<a href="#l41.60"></a><span id="l41.60" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;genericFailureExplanation&quot;,</span>
<a href="#l41.61"></a><span id="l41.61">                                 getter_Copies(currMessage));</span>
<a href="#l41.62"></a><span id="l41.62">     }</span>
<a href="#l41.63"></a><span id="l41.63"> </span>
<a href="#l41.64"></a><span id="l41.64">     if (!currMessage.IsEmpty())</span>
<a href="#l41.65"></a><span id="l41.65">     {</span>
<a href="#l41.66"></a><span id="l41.66">       //Don't need to repeat ourself!</span>
<a href="#l41.67"></a><span id="l41.67">       if (!currMessage.Equals(dialogMessage))</span>
<a href="#l41.68"></a><span id="l41.68">       {</span>
<a href="#l41.69"></a><span id="l41.69" class="difflineat">@@ -355,17 +355,17 @@ NS_IMETHODIMP nsMsgSendReport::DisplayRe</span>
<a href="#l41.70"></a><span id="l41.70">         dialogMessage.Append(currMessage);</span>
<a href="#l41.71"></a><span id="l41.71">       }</span>
<a href="#l41.72"></a><span id="l41.72">     }</span>
<a href="#l41.73"></a><span id="l41.73"> </span>
<a href="#l41.74"></a><span id="l41.74">     if (askToGoBackToCompose)</span>
<a href="#l41.75"></a><span id="l41.75">     {</span>
<a href="#l41.76"></a><span id="l41.76">       bool oopsGiveMeBackTheComposeWindow = true;</span>
<a href="#l41.77"></a><span id="l41.77">       nsString text1;</span>
<a href="#l41.78"></a><span id="l41.78" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;returnToComposeWindowQuestion&quot;),</span>
<a href="#l41.79"></a><span id="l41.79" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;returnToComposeWindowQuestion&quot;,</span>
<a href="#l41.80"></a><span id="l41.80">                                 getter_Copies(text1));</span>
<a href="#l41.81"></a><span id="l41.81">       if (!dialogMessage.IsEmpty())</span>
<a href="#l41.82"></a><span id="l41.82">         dialogMessage.AppendLiteral(&quot;\n&quot;);</span>
<a href="#l41.83"></a><span id="l41.83">       dialogMessage.Append(text1);</span>
<a href="#l41.84"></a><span id="l41.84">       nsMsgAskBooleanQuestionByString(prompt, dialogMessage.get(), &amp;oopsGiveMeBackTheComposeWindow, dialogTitle.get());</span>
<a href="#l41.85"></a><span id="l41.85">       if (!oopsGiveMeBackTheComposeWindow)</span>
<a href="#l41.86"></a><span id="l41.86">         *_retval = NS_OK;</span>
<a href="#l41.87"></a><span id="l41.87">     }</span>
<a href="#l41.88"></a><span id="l41.88" class="difflineat">@@ -375,47 +375,47 @@ NS_IMETHODIMP nsMsgSendReport::DisplayRe</span>
<a href="#l41.89"></a><span id="l41.89">   else</span>
<a href="#l41.90"></a><span id="l41.90">   {</span>
<a href="#l41.91"></a><span id="l41.91">     const char16_t* title;</span>
<a href="#l41.92"></a><span id="l41.92">     const char16_t* messageName;</span>
<a href="#l41.93"></a><span id="l41.93"> </span>
<a href="#l41.94"></a><span id="l41.94">     switch (mDeliveryMode)</span>
<a href="#l41.95"></a><span id="l41.95">     {</span>
<a href="#l41.96"></a><span id="l41.96">       case nsIMsgCompDeliverMode::Later:</span>
<a href="#l41.97"></a><span id="l41.97" class="difflineminus">-        title = MOZ_UTF16(&quot;sendLaterErrorTitle&quot;);</span>
<a href="#l41.98"></a><span id="l41.98" class="difflineminus">-        messageName = MOZ_UTF16(&quot;unableToSendLater&quot;);</span>
<a href="#l41.99"></a><span id="l41.99" class="difflineplus">+        title = u&quot;sendLaterErrorTitle&quot;;</span>
<a href="#l41.100"></a><span id="l41.100" class="difflineplus">+        messageName = u&quot;unableToSendLater&quot;;</span>
<a href="#l41.101"></a><span id="l41.101">         break;</span>
<a href="#l41.102"></a><span id="l41.102"> </span>
<a href="#l41.103"></a><span id="l41.103">       case nsIMsgCompDeliverMode::AutoSaveAsDraft:</span>
<a href="#l41.104"></a><span id="l41.104">       case nsIMsgCompDeliverMode::SaveAsDraft:</span>
<a href="#l41.105"></a><span id="l41.105" class="difflineminus">-        title = MOZ_UTF16(&quot;saveDraftErrorTitle&quot;);</span>
<a href="#l41.106"></a><span id="l41.106" class="difflineminus">-        messageName = MOZ_UTF16(&quot;unableToSaveDraft&quot;);</span>
<a href="#l41.107"></a><span id="l41.107" class="difflineplus">+        title = u&quot;saveDraftErrorTitle&quot;;</span>
<a href="#l41.108"></a><span id="l41.108" class="difflineplus">+        messageName = u&quot;unableToSaveDraft&quot;;</span>
<a href="#l41.109"></a><span id="l41.109">         break;</span>
<a href="#l41.110"></a><span id="l41.110"> </span>
<a href="#l41.111"></a><span id="l41.111">       case nsIMsgCompDeliverMode::SaveAsTemplate:</span>
<a href="#l41.112"></a><span id="l41.112" class="difflineminus">-        title = MOZ_UTF16(&quot;saveTemplateErrorTitle&quot;);</span>
<a href="#l41.113"></a><span id="l41.113" class="difflineminus">-        messageName = MOZ_UTF16(&quot;unableToSaveTemplate&quot;);</span>
<a href="#l41.114"></a><span id="l41.114" class="difflineplus">+        title = u&quot;saveTemplateErrorTitle&quot;;</span>
<a href="#l41.115"></a><span id="l41.115" class="difflineplus">+        messageName = u&quot;unableToSaveTemplate&quot;;</span>
<a href="#l41.116"></a><span id="l41.116">         break;</span>
<a href="#l41.117"></a><span id="l41.117"> </span>
<a href="#l41.118"></a><span id="l41.118">       default:</span>
<a href="#l41.119"></a><span id="l41.119">         /* This should never happen! */</span>
<a href="#l41.120"></a><span id="l41.120" class="difflineminus">-        title = MOZ_UTF16(&quot;sendMessageErrorTitle&quot;);</span>
<a href="#l41.121"></a><span id="l41.121" class="difflineminus">-        messageName = MOZ_UTF16(&quot;sendFailed&quot;);</span>
<a href="#l41.122"></a><span id="l41.122" class="difflineplus">+        title = u&quot;sendMessageErrorTitle&quot;;</span>
<a href="#l41.123"></a><span id="l41.123" class="difflineplus">+        messageName = u&quot;sendFailed&quot;;</span>
<a href="#l41.124"></a><span id="l41.124">         break;</span>
<a href="#l41.125"></a><span id="l41.125">     }</span>
<a href="#l41.126"></a><span id="l41.126"> </span>
<a href="#l41.127"></a><span id="l41.127">     bundle-&gt;GetStringFromName(title, getter_Copies(dialogTitle));</span>
<a href="#l41.128"></a><span id="l41.128">     bundle-&gt;GetStringFromName(messageName,</span>
<a href="#l41.129"></a><span id="l41.129">                               getter_Copies(dialogMessage));</span>
<a href="#l41.130"></a><span id="l41.130"> </span>
<a href="#l41.131"></a><span id="l41.131">     //Do we have an error message...</span>
<a href="#l41.132"></a><span id="l41.132">     if (currMessage.IsEmpty())</span>
<a href="#l41.133"></a><span id="l41.133">     {</span>
<a href="#l41.134"></a><span id="l41.134">       //we don't have an error description but we can put a generic explanation</span>
<a href="#l41.135"></a><span id="l41.135" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;genericFailureExplanation&quot;),</span>
<a href="#l41.136"></a><span id="l41.136" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;genericFailureExplanation&quot;,</span>
<a href="#l41.137"></a><span id="l41.137">                                 getter_Copies(currMessage));</span>
<a href="#l41.138"></a><span id="l41.138">     }</span>
<a href="#l41.139"></a><span id="l41.139"> </span>
<a href="#l41.140"></a><span id="l41.140">     if (!currMessage.IsEmpty())</span>
<a href="#l41.141"></a><span id="l41.141">     {</span>
<a href="#l41.142"></a><span id="l41.142">       if (!dialogMessage.IsEmpty())</span>
<a href="#l41.143"></a><span id="l41.143">         dialogMessage.Append(char16_t('\n'));</span>
<a href="#l41.144"></a><span id="l41.144">       dialogMessage.Append(currMessage);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mailnews/compose/src/nsSmtpProtocol.cpp</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mailnews/compose/src/nsSmtpProtocol.cpp</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -91,17 +91,17 @@ nsresult nsExplainErrorDetails(nsISmtpUr</span>
<a href="#l42.4"></a><span id="l42.4">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l42.5"></a><span id="l42.5"> </span>
<a href="#l42.6"></a><span id="l42.6">   va_start (args, aCode);</span>
<a href="#l42.7"></a><span id="l42.7"> </span>
<a href="#l42.8"></a><span id="l42.8">   const char16_t* exitString;</span>
<a href="#l42.9"></a><span id="l42.9">   switch (aCode)</span>
<a href="#l42.10"></a><span id="l42.10">   {</span>
<a href="#l42.11"></a><span id="l42.11">     case NS_ERROR_ILLEGAL_LOCALPART:</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;errorIllegalLocalPart&quot;),</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;errorIllegalLocalPart&quot;,</span>
<a href="#l42.14"></a><span id="l42.14">                                 getter_Copies(eMsg));</span>
<a href="#l42.15"></a><span id="l42.15">       msg = nsTextFormatter::vsmprintf(eMsg.get(), args);</span>
<a href="#l42.16"></a><span id="l42.16">       break;</span>
<a href="#l42.17"></a><span id="l42.17">     case NS_ERROR_SMTP_SERVER_ERROR:</span>
<a href="#l42.18"></a><span id="l42.18">     case NS_ERROR_TCP_READ_ERROR:</span>
<a href="#l42.19"></a><span id="l42.19">     case NS_ERROR_SMTP_TEMP_SIZE_EXCEEDED:</span>
<a href="#l42.20"></a><span id="l42.20">     case NS_ERROR_SMTP_PERM_SIZE_EXCEEDED_1:</span>
<a href="#l42.21"></a><span id="l42.21">     case NS_ERROR_SMTP_PERM_SIZE_EXCEEDED_2:</span>
<a href="#l42.22"></a><span id="l42.22" class="difflineat">@@ -111,17 +111,17 @@ nsresult nsExplainErrorDetails(nsISmtpUr</span>
<a href="#l42.23"></a><span id="l42.23">     case NS_ERROR_SENDING_MESSAGE:</span>
<a href="#l42.24"></a><span id="l42.24">     case NS_ERROR_SMTP_GREETING:</span>
<a href="#l42.25"></a><span id="l42.25">       exitString = errorStringNameForErrorCode(aCode);</span>
<a href="#l42.26"></a><span id="l42.26">       bundle-&gt;GetStringFromName(exitString, getter_Copies(eMsg));</span>
<a href="#l42.27"></a><span id="l42.27">       msg = nsTextFormatter::vsmprintf(eMsg.get(), args);</span>
<a href="#l42.28"></a><span id="l42.28">       break;</span>
<a href="#l42.29"></a><span id="l42.29">     default:</span>
<a href="#l42.30"></a><span id="l42.30">       NS_WARNING(&quot;falling to default error code&quot;);</span>
<a href="#l42.31"></a><span id="l42.31" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;communicationsError&quot;), getter_Copies(eMsg));</span>
<a href="#l42.32"></a><span id="l42.32" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;communicationsError&quot;, getter_Copies(eMsg));</span>
<a href="#l42.33"></a><span id="l42.33">       msg = nsTextFormatter::smprintf(eMsg.get(), aCode);</span>
<a href="#l42.34"></a><span id="l42.34">       break;</span>
<a href="#l42.35"></a><span id="l42.35">   }</span>
<a href="#l42.36"></a><span id="l42.36"> </span>
<a href="#l42.37"></a><span id="l42.37">   if (msg)</span>
<a href="#l42.38"></a><span id="l42.38">   {</span>
<a href="#l42.39"></a><span id="l42.39">     rv = dialog-&gt;Alert(nullptr, msg);</span>
<a href="#l42.40"></a><span id="l42.40">     nsTextFormatter::smprintf_free(msg);</span>
<a href="#l42.41"></a><span id="l42.41" class="difflineat">@@ -1706,17 +1706,17 @@ nsresult nsSmtpProtocol::SendDataRespons</span>
<a href="#l42.42"></a><span id="l42.42"> </span>
<a href="#l42.43"></a><span id="l42.43">     m_urlErrorState = NS_ERROR_BUT_DONT_SHOW_ALERT;</span>
<a href="#l42.44"></a><span id="l42.44">     return(NS_ERROR_SENDING_DATA_COMMAND);</span>
<a href="#l42.45"></a><span id="l42.45">   }</span>
<a href="#l42.46"></a><span id="l42.46"> </span>
<a href="#l42.47"></a><span id="l42.47">   m_nextState = SMTP_SEND_POST_DATA;</span>
<a href="#l42.48"></a><span id="l42.48">   ClearFlag(SMTP_PAUSE_FOR_READ);   /* send data directly */</span>
<a href="#l42.49"></a><span id="l42.49"> </span>
<a href="#l42.50"></a><span id="l42.50" class="difflineminus">-  UpdateStatus(MOZ_UTF16(&quot;smtpDeliveringMail&quot;));</span>
<a href="#l42.51"></a><span id="l42.51" class="difflineplus">+  UpdateStatus(u&quot;smtpDeliveringMail&quot;);</span>
<a href="#l42.52"></a><span id="l42.52"> </span>
<a href="#l42.53"></a><span id="l42.53">   {</span>
<a href="#l42.54"></a><span id="l42.54"> //      m_runningURL-&gt;GetBodySize(&amp;m_totalMessageSize);</span>
<a href="#l42.55"></a><span id="l42.55">   }</span>
<a href="#l42.56"></a><span id="l42.56">   return(status);</span>
<a href="#l42.57"></a><span id="l42.57"> }</span>
<a href="#l42.58"></a><span id="l42.58"> </span>
<a href="#l42.59"></a><span id="l42.59"> void nsSmtpProtocol::SendMessageInFile()</span>
<a href="#l42.60"></a><span id="l42.60" class="difflineat">@@ -1729,17 +1729,17 @@ void nsSmtpProtocol::SendMessageInFile()</span>
<a href="#l42.61"></a><span id="l42.61">     // in some windows header file</span>
<a href="#l42.62"></a><span id="l42.62">     nsMsgAsyncWriteProtocol::PostMessage(url, file);</span>
<a href="#l42.63"></a><span id="l42.63"> </span>
<a href="#l42.64"></a><span id="l42.64">   SetFlag(SMTP_PAUSE_FOR_READ);</span>
<a href="#l42.65"></a><span id="l42.65"> </span>
<a href="#l42.66"></a><span id="l42.66">   // for now, we are always done at this point..we aren't making multiple calls</span>
<a href="#l42.67"></a><span id="l42.67">   // to post data...</span>
<a href="#l42.68"></a><span id="l42.68"> </span>
<a href="#l42.69"></a><span id="l42.69" class="difflineminus">-  UpdateStatus(MOZ_UTF16(&quot;smtpDeliveringMail&quot;));</span>
<a href="#l42.70"></a><span id="l42.70" class="difflineplus">+  UpdateStatus(u&quot;smtpDeliveringMail&quot;);</span>
<a href="#l42.71"></a><span id="l42.71">   m_nextState = SMTP_RESPONSE;</span>
<a href="#l42.72"></a><span id="l42.72">   m_nextStateAfterResponse = SMTP_SEND_MESSAGE_RESPONSE;</span>
<a href="#l42.73"></a><span id="l42.73"> }</span>
<a href="#l42.74"></a><span id="l42.74"> </span>
<a href="#l42.75"></a><span id="l42.75"> void nsSmtpProtocol::SendPostData()</span>
<a href="#l42.76"></a><span id="l42.76"> {</span>
<a href="#l42.77"></a><span id="l42.77"> 	// mscott: as a first pass, I'm writing everything at once and am not</span>
<a href="#l42.78"></a><span id="l42.78"> 	// doing it in chunks...</span>
<a href="#l42.79"></a><span id="l42.79" class="difflineat">@@ -1774,17 +1774,17 @@ nsresult nsSmtpProtocol::SendMessageResp</span>
<a href="#l42.80"></a><span id="l42.80">                                                             NS_ERROR_SENDING_MESSAGE,</span>
<a href="#l42.81"></a><span id="l42.81">                                                             m_responseText.get());</span>
<a href="#l42.82"></a><span id="l42.82">     NS_ASSERTION(NS_SUCCEEDED(rv), &quot;failed to explain SMTP error&quot;);</span>
<a href="#l42.83"></a><span id="l42.83"> </span>
<a href="#l42.84"></a><span id="l42.84">     m_urlErrorState = NS_ERROR_BUT_DONT_SHOW_ALERT;</span>
<a href="#l42.85"></a><span id="l42.85">     return(NS_ERROR_SENDING_MESSAGE);</span>
<a href="#l42.86"></a><span id="l42.86">   }</span>
<a href="#l42.87"></a><span id="l42.87"> </span>
<a href="#l42.88"></a><span id="l42.88" class="difflineminus">-  UpdateStatus(MOZ_UTF16(&quot;smtpMailSent&quot;));</span>
<a href="#l42.89"></a><span id="l42.89" class="difflineplus">+  UpdateStatus(u&quot;smtpMailSent&quot;);</span>
<a href="#l42.90"></a><span id="l42.90"> </span>
<a href="#l42.91"></a><span id="l42.91">   /* else */</span>
<a href="#l42.92"></a><span id="l42.92">   return SendQuit();</span>
<a href="#l42.93"></a><span id="l42.93"> }</span>
<a href="#l42.94"></a><span id="l42.94"> </span>
<a href="#l42.95"></a><span id="l42.95"> nsresult nsSmtpProtocol::SendQuit(SmtpState aNextStateAfterResponse)</span>
<a href="#l42.96"></a><span id="l42.96"> {</span>
<a href="#l42.97"></a><span id="l42.97">   m_sendDone = true;</span>
<a href="#l42.98"></a><span id="l42.98" class="difflineat">@@ -2162,31 +2162,31 @@ nsSmtpProtocol::PromptForPassword(nsISmt</span>
<a href="#l42.99"></a><span id="l42.99"> </span>
<a href="#l42.100"></a><span id="l42.100">   nsCOMPtr&lt;nsIStringBundle&gt; composeStringBundle;</span>
<a href="#l42.101"></a><span id="l42.101">   nsresult rv = stringService-&gt;CreateBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;, getter_AddRefs(composeStringBundle));</span>
<a href="#l42.102"></a><span id="l42.102">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l42.103"></a><span id="l42.103"> </span>
<a href="#l42.104"></a><span id="l42.104">   nsString passwordPromptString;</span>
<a href="#l42.105"></a><span id="l42.105">   if(formatStrings[1])</span>
<a href="#l42.106"></a><span id="l42.106">     rv = composeStringBundle-&gt;FormatStringFromName(</span>
<a href="#l42.107"></a><span id="l42.107" class="difflineminus">-      MOZ_UTF16(&quot;smtpEnterPasswordPromptWithUsername&quot;),</span>
<a href="#l42.108"></a><span id="l42.108" class="difflineplus">+      u&quot;smtpEnterPasswordPromptWithUsername&quot;,</span>
<a href="#l42.109"></a><span id="l42.109">       formatStrings, 2, getter_Copies(passwordPromptString));</span>
<a href="#l42.110"></a><span id="l42.110">   else</span>
<a href="#l42.111"></a><span id="l42.111">     rv = composeStringBundle-&gt;FormatStringFromName(</span>
<a href="#l42.112"></a><span id="l42.112" class="difflineminus">-      MOZ_UTF16(&quot;smtpEnterPasswordPrompt&quot;),</span>
<a href="#l42.113"></a><span id="l42.113" class="difflineplus">+      u&quot;smtpEnterPasswordPrompt&quot;,</span>
<a href="#l42.114"></a><span id="l42.114">       formatStrings, 1, getter_Copies(passwordPromptString));</span>
<a href="#l42.115"></a><span id="l42.115">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l42.116"></a><span id="l42.116"> </span>
<a href="#l42.117"></a><span id="l42.117">   nsCOMPtr&lt;nsIAuthPrompt&gt; netPrompt;</span>
<a href="#l42.118"></a><span id="l42.118">   rv = aSmtpUrl-&gt;GetAuthPrompt(getter_AddRefs(netPrompt));</span>
<a href="#l42.119"></a><span id="l42.119">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l42.120"></a><span id="l42.120"> </span>
<a href="#l42.121"></a><span id="l42.121">   nsString passwordTitle;</span>
<a href="#l42.122"></a><span id="l42.122">   rv = composeStringBundle-&gt;GetStringFromName(</span>
<a href="#l42.123"></a><span id="l42.123" class="difflineminus">-    MOZ_UTF16(&quot;smtpEnterPasswordPromptTitle&quot;),</span>
<a href="#l42.124"></a><span id="l42.124" class="difflineplus">+    u&quot;smtpEnterPasswordPromptTitle&quot;,</span>
<a href="#l42.125"></a><span id="l42.125">     getter_Copies(passwordTitle));</span>
<a href="#l42.126"></a><span id="l42.126">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l42.127"></a><span id="l42.127"> </span>
<a href="#l42.128"></a><span id="l42.128">   rv = aSmtpServer-&gt;GetPasswordWithUI(passwordPromptString.get(), passwordTitle.get(),</span>
<a href="#l42.129"></a><span id="l42.129">     netPrompt, aPassword);</span>
<a href="#l42.130"></a><span id="l42.130">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l42.131"></a><span id="l42.131">   return rv;</span>
<a href="#l42.132"></a><span id="l42.132"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -66,25 +66,25 @@ NS_IMETHODIMP nsMsgMailView::GetPrettyNa</span>
<a href="#l43.4"></a><span id="l43.4">                                     getter_AddRefs(mBundle));</span>
<a href="#l43.5"></a><span id="l43.5">     }</span>
<a href="#l43.6"></a><span id="l43.6"> </span>
<a href="#l43.7"></a><span id="l43.7">     NS_ENSURE_TRUE(mBundle, NS_ERROR_FAILURE);</span>
<a href="#l43.8"></a><span id="l43.8"> </span>
<a href="#l43.9"></a><span id="l43.9">     // see if mName has an associated pretty name inside our string bundle and if so, use that as the pretty name</span>
<a href="#l43.10"></a><span id="l43.10">     // otherwise just return mName</span>
<a href="#l43.11"></a><span id="l43.11">     if (mName.EqualsLiteral(kDefaultViewPeopleIKnow))</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-        rv = mBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;mailViewPeopleIKnow&quot;), aMailViewName);</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+        rv = mBundle-&gt;GetStringFromName(u&quot;mailViewPeopleIKnow&quot;, aMailViewName);</span>
<a href="#l43.14"></a><span id="l43.14">     else if (mName.EqualsLiteral(kDefaultViewRecent))</span>
<a href="#l43.15"></a><span id="l43.15" class="difflineminus">-        rv = mBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;mailViewRecentMail&quot;), aMailViewName);</span>
<a href="#l43.16"></a><span id="l43.16" class="difflineplus">+        rv = mBundle-&gt;GetStringFromName(u&quot;mailViewRecentMail&quot;, aMailViewName);</span>
<a href="#l43.17"></a><span id="l43.17">     else if (mName.EqualsLiteral(kDefaultViewFiveDays))</span>
<a href="#l43.18"></a><span id="l43.18" class="difflineminus">-        rv = mBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;mailViewLastFiveDays&quot;), aMailViewName);</span>
<a href="#l43.19"></a><span id="l43.19" class="difflineplus">+        rv = mBundle-&gt;GetStringFromName(u&quot;mailViewLastFiveDays&quot;, aMailViewName);</span>
<a href="#l43.20"></a><span id="l43.20">     else if (mName.EqualsLiteral(kDefaultViewNotJunk))</span>
<a href="#l43.21"></a><span id="l43.21" class="difflineminus">-        rv = mBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;mailViewNotJunk&quot;), aMailViewName);</span>
<a href="#l43.22"></a><span id="l43.22" class="difflineplus">+        rv = mBundle-&gt;GetStringFromName(u&quot;mailViewNotJunk&quot;, aMailViewName);</span>
<a href="#l43.23"></a><span id="l43.23">     else if (mName.EqualsLiteral(kDefaultViewHasAttachments))</span>
<a href="#l43.24"></a><span id="l43.24" class="difflineminus">-        rv = mBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;mailViewHasAttachments&quot;), aMailViewName);</span>
<a href="#l43.25"></a><span id="l43.25" class="difflineplus">+        rv = mBundle-&gt;GetStringFromName(u&quot;mailViewHasAttachments&quot;, aMailViewName);</span>
<a href="#l43.26"></a><span id="l43.26">     else</span>
<a href="#l43.27"></a><span id="l43.27">         *aMailViewName = ToNewUnicode(mName);</span>
<a href="#l43.28"></a><span id="l43.28"> </span>
<a href="#l43.29"></a><span id="l43.29">     return rv;</span>
<a href="#l43.30"></a><span id="l43.30"> }</span>
<a href="#l43.31"></a><span id="l43.31"> </span>
<a href="#l43.32"></a><span id="l43.32"> NS_IMETHODIMP nsMsgMailView::GetSearchTerms(nsISupportsArray ** aSearchTerms)</span>
<a href="#l43.33"></a><span id="l43.33"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -466,17 +466,17 @@ nsresult nsMsgMdnGenerator::CreateFirstP</span>
<a href="#l44.4"></a><span id="l44.4">     // convert fullName to UTF8 before passing it to MakeMimeAddress</span>
<a href="#l44.5"></a><span id="l44.5">     MakeMimeAddress(NS_ConvertUTF16toUTF8(fullName), m_email, fullAddress);</span>
<a href="#l44.6"></a><span id="l44.6"> </span>
<a href="#l44.7"></a><span id="l44.7">     convbuf = nsMsgI18NEncodeMimePartIIStr(fullAddress.get(),</span>
<a href="#l44.8"></a><span id="l44.8">         true, m_charset.get(), 0, conformToStandard);</span>
<a href="#l44.9"></a><span id="l44.9"> </span>
<a href="#l44.10"></a><span id="l44.10">     parm = PR_smprintf(&quot;From: %s&quot; CRLF, convbuf ? convbuf : m_email.get());</span>
<a href="#l44.11"></a><span id="l44.11"> </span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-    rv = FormatStringFromName(MOZ_UTF16(&quot;MsgMdnMsgSentTo&quot;), NS_ConvertASCIItoUTF16(m_email).get(),</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+    rv = FormatStringFromName(u&quot;MsgMdnMsgSentTo&quot;, NS_ConvertASCIItoUTF16(m_email).get(),</span>
<a href="#l44.14"></a><span id="l44.14">                             getter_Copies(firstPart1));</span>
<a href="#l44.15"></a><span id="l44.15">     if (NS_FAILED(rv))</span>
<a href="#l44.16"></a><span id="l44.16">         return rv;</span>
<a href="#l44.17"></a><span id="l44.17"> </span>
<a href="#l44.18"></a><span id="l44.18">     PUSH_N_FREE_STRING (parm);</span>
<a href="#l44.19"></a><span id="l44.19"> </span>
<a href="#l44.20"></a><span id="l44.20">     PR_Free(convbuf);</span>
<a href="#l44.21"></a><span id="l44.21"> </span>
<a href="#l44.22"></a><span id="l44.22" class="difflineat">@@ -488,42 +488,42 @@ nsresult nsMsgMdnGenerator::CreateFirstP</span>
<a href="#l44.23"></a><span id="l44.23">       PUSH_N_FREE_STRING(tmpBuffer);</span>
<a href="#l44.24"></a><span id="l44.24">     }</span>
<a href="#l44.25"></a><span id="l44.25"> </span>
<a href="#l44.26"></a><span id="l44.26">     nsString receipt_string;</span>
<a href="#l44.27"></a><span id="l44.27">     switch (m_disposeType)</span>
<a href="#l44.28"></a><span id="l44.28">     {</span>
<a href="#l44.29"></a><span id="l44.29">     case nsIMsgMdnGenerator::eDisplayed:</span>
<a href="#l44.30"></a><span id="l44.30">         rv = GetStringFromName(</span>
<a href="#l44.31"></a><span id="l44.31" class="difflineminus">-            MOZ_UTF16(&quot;MdnDisplayedReceipt&quot;),</span>
<a href="#l44.32"></a><span id="l44.32" class="difflineplus">+            u&quot;MdnDisplayedReceipt&quot;,</span>
<a href="#l44.33"></a><span id="l44.33">             getter_Copies(receipt_string));</span>
<a href="#l44.34"></a><span id="l44.34">         break;</span>
<a href="#l44.35"></a><span id="l44.35">     case nsIMsgMdnGenerator::eDispatched:</span>
<a href="#l44.36"></a><span id="l44.36">         rv = GetStringFromName(</span>
<a href="#l44.37"></a><span id="l44.37" class="difflineminus">-            MOZ_UTF16(&quot;MdnDispatchedReceipt&quot;),</span>
<a href="#l44.38"></a><span id="l44.38" class="difflineplus">+            u&quot;MdnDispatchedReceipt&quot;,</span>
<a href="#l44.39"></a><span id="l44.39">             getter_Copies(receipt_string));</span>
<a href="#l44.40"></a><span id="l44.40">         break;</span>
<a href="#l44.41"></a><span id="l44.41">     case nsIMsgMdnGenerator::eProcessed:</span>
<a href="#l44.42"></a><span id="l44.42">         rv = GetStringFromName(</span>
<a href="#l44.43"></a><span id="l44.43" class="difflineminus">-            MOZ_UTF16(&quot;MdnProcessedReceipt&quot;),</span>
<a href="#l44.44"></a><span id="l44.44" class="difflineplus">+            u&quot;MdnProcessedReceipt&quot;,</span>
<a href="#l44.45"></a><span id="l44.45">             getter_Copies(receipt_string));</span>
<a href="#l44.46"></a><span id="l44.46">         break;</span>
<a href="#l44.47"></a><span id="l44.47">     case nsIMsgMdnGenerator::eDeleted:</span>
<a href="#l44.48"></a><span id="l44.48">         rv = GetStringFromName(</span>
<a href="#l44.49"></a><span id="l44.49" class="difflineminus">-            MOZ_UTF16(&quot;MdnDeletedReceipt&quot;),</span>
<a href="#l44.50"></a><span id="l44.50" class="difflineplus">+            u&quot;MdnDeletedReceipt&quot;,</span>
<a href="#l44.51"></a><span id="l44.51">             getter_Copies(receipt_string));</span>
<a href="#l44.52"></a><span id="l44.52">         break;</span>
<a href="#l44.53"></a><span id="l44.53">     case nsIMsgMdnGenerator::eDenied:</span>
<a href="#l44.54"></a><span id="l44.54">         rv = GetStringFromName(</span>
<a href="#l44.55"></a><span id="l44.55" class="difflineminus">-            MOZ_UTF16(&quot;MdnDeniedReceipt&quot;),</span>
<a href="#l44.56"></a><span id="l44.56" class="difflineplus">+            u&quot;MdnDeniedReceipt&quot;,</span>
<a href="#l44.57"></a><span id="l44.57">             getter_Copies(receipt_string));</span>
<a href="#l44.58"></a><span id="l44.58">         break;</span>
<a href="#l44.59"></a><span id="l44.59">     case nsIMsgMdnGenerator::eFailed:</span>
<a href="#l44.60"></a><span id="l44.60">         rv = GetStringFromName(</span>
<a href="#l44.61"></a><span id="l44.61" class="difflineminus">-            MOZ_UTF16(&quot;MdnFailedReceipt&quot;),</span>
<a href="#l44.62"></a><span id="l44.62" class="difflineplus">+            u&quot;MdnFailedReceipt&quot;,</span>
<a href="#l44.63"></a><span id="l44.63">             getter_Copies(receipt_string));</span>
<a href="#l44.64"></a><span id="l44.64">         break;</span>
<a href="#l44.65"></a><span id="l44.65">     default:</span>
<a href="#l44.66"></a><span id="l44.66">         rv = NS_ERROR_INVALID_ARG;</span>
<a href="#l44.67"></a><span id="l44.67">         break;</span>
<a href="#l44.68"></a><span id="l44.68">     }</span>
<a href="#l44.69"></a><span id="l44.69"> </span>
<a href="#l44.70"></a><span id="l44.70">     if (NS_FAILED(rv))</span>
<a href="#l44.71"></a><span id="l44.71" class="difflineat">@@ -589,42 +589,42 @@ report-type=disposition-notification;\r\</span>
<a href="#l44.72"></a><span id="l44.72">         tmpBuffer = PR_smprintf(&quot;%s&quot; CRLF CRLF, NS_ConvertUTF16toUTF8(firstPart1).get());</span>
<a href="#l44.73"></a><span id="l44.73">         PUSH_N_FREE_STRING(tmpBuffer);</span>
<a href="#l44.74"></a><span id="l44.74">     }</span>
<a href="#l44.75"></a><span id="l44.75"> </span>
<a href="#l44.76"></a><span id="l44.76">     switch (m_disposeType)</span>
<a href="#l44.77"></a><span id="l44.77">     {</span>
<a href="#l44.78"></a><span id="l44.78">     case nsIMsgMdnGenerator::eDisplayed:</span>
<a href="#l44.79"></a><span id="l44.79">         rv = GetStringFromName(</span>
<a href="#l44.80"></a><span id="l44.80" class="difflineminus">-            MOZ_UTF16(&quot;MsgMdnDisplayed&quot;),</span>
<a href="#l44.81"></a><span id="l44.81" class="difflineplus">+            u&quot;MsgMdnDisplayed&quot;,</span>
<a href="#l44.82"></a><span id="l44.82">             getter_Copies(firstPart2));</span>
<a href="#l44.83"></a><span id="l44.83">         break;</span>
<a href="#l44.84"></a><span id="l44.84">     case nsIMsgMdnGenerator::eDispatched:</span>
<a href="#l44.85"></a><span id="l44.85">         rv = GetStringFromName(</span>
<a href="#l44.86"></a><span id="l44.86" class="difflineminus">-            MOZ_UTF16(&quot;MsgMdnDispatched&quot;),</span>
<a href="#l44.87"></a><span id="l44.87" class="difflineplus">+            u&quot;MsgMdnDispatched&quot;,</span>
<a href="#l44.88"></a><span id="l44.88">             getter_Copies(firstPart2));</span>
<a href="#l44.89"></a><span id="l44.89">         break;</span>
<a href="#l44.90"></a><span id="l44.90">     case nsIMsgMdnGenerator::eProcessed:</span>
<a href="#l44.91"></a><span id="l44.91">         rv = GetStringFromName(</span>
<a href="#l44.92"></a><span id="l44.92" class="difflineminus">-            MOZ_UTF16(&quot;MsgMdnProcessed&quot;),</span>
<a href="#l44.93"></a><span id="l44.93" class="difflineplus">+            u&quot;MsgMdnProcessed&quot;,</span>
<a href="#l44.94"></a><span id="l44.94">             getter_Copies(firstPart2));</span>
<a href="#l44.95"></a><span id="l44.95">         break;</span>
<a href="#l44.96"></a><span id="l44.96">     case nsIMsgMdnGenerator::eDeleted:</span>
<a href="#l44.97"></a><span id="l44.97">         rv = GetStringFromName(</span>
<a href="#l44.98"></a><span id="l44.98" class="difflineminus">-            MOZ_UTF16(&quot;MsgMdnDeleted&quot;),</span>
<a href="#l44.99"></a><span id="l44.99" class="difflineplus">+            u&quot;MsgMdnDeleted&quot;,</span>
<a href="#l44.100"></a><span id="l44.100">             getter_Copies(firstPart2));</span>
<a href="#l44.101"></a><span id="l44.101">         break;</span>
<a href="#l44.102"></a><span id="l44.102">     case nsIMsgMdnGenerator::eDenied:</span>
<a href="#l44.103"></a><span id="l44.103">         rv = GetStringFromName(</span>
<a href="#l44.104"></a><span id="l44.104" class="difflineminus">-            MOZ_UTF16(&quot;MsgMdnDenied&quot;),</span>
<a href="#l44.105"></a><span id="l44.105" class="difflineplus">+            u&quot;MsgMdnDenied&quot;,</span>
<a href="#l44.106"></a><span id="l44.106">             getter_Copies(firstPart2));</span>
<a href="#l44.107"></a><span id="l44.107">         break;</span>
<a href="#l44.108"></a><span id="l44.108">     case nsIMsgMdnGenerator::eFailed:</span>
<a href="#l44.109"></a><span id="l44.109">         rv = GetStringFromName(</span>
<a href="#l44.110"></a><span id="l44.110" class="difflineminus">-            MOZ_UTF16(&quot;MsgMdnFailed&quot;),</span>
<a href="#l44.111"></a><span id="l44.111" class="difflineplus">+            u&quot;MsgMdnFailed&quot;,</span>
<a href="#l44.112"></a><span id="l44.112">             getter_Copies(firstPart2));</span>
<a href="#l44.113"></a><span id="l44.113">         break;</span>
<a href="#l44.114"></a><span id="l44.114">     default:</span>
<a href="#l44.115"></a><span id="l44.115">         rv = NS_ERROR_INVALID_ARG;</span>
<a href="#l44.116"></a><span id="l44.116">         break;</span>
<a href="#l44.117"></a><span id="l44.117">     }</span>
<a href="#l44.118"></a><span id="l44.118"> </span>
<a href="#l44.119"></a><span id="l44.119">     if (NS_FAILED(rv))</span>
<a href="#l44.120"></a><span id="l44.120" class="difflineat">@@ -1077,29 +1077,29 @@ NS_IMETHODIMP nsMsgMdnGenerator::OnStopR</span>
<a href="#l44.121"></a><span id="l44.121">       return NS_OK;</span>
<a href="#l44.122"></a><span id="l44.122"> </span>
<a href="#l44.123"></a><span id="l44.123">     const char16_t* exitString;</span>
<a href="#l44.124"></a><span id="l44.124"> </span>
<a href="#l44.125"></a><span id="l44.125">     switch (aExitCode)</span>
<a href="#l44.126"></a><span id="l44.126">     {</span>
<a href="#l44.127"></a><span id="l44.127">       case NS_ERROR_UNKNOWN_HOST:</span>
<a href="#l44.128"></a><span id="l44.128">       case NS_ERROR_UNKNOWN_PROXY_HOST:</span>
<a href="#l44.129"></a><span id="l44.129" class="difflineminus">-        exitString = MOZ_UTF16(&quot;smtpSendFailedUnknownServer&quot;);</span>
<a href="#l44.130"></a><span id="l44.130" class="difflineplus">+        exitString = u&quot;smtpSendFailedUnknownServer&quot;;</span>
<a href="#l44.131"></a><span id="l44.131">         break;</span>
<a href="#l44.132"></a><span id="l44.132">       case NS_ERROR_CONNECTION_REFUSED:</span>
<a href="#l44.133"></a><span id="l44.133">       case NS_ERROR_PROXY_CONNECTION_REFUSED:</span>
<a href="#l44.134"></a><span id="l44.134" class="difflineminus">-        exitString = MOZ_UTF16(&quot;smtpSendRequestRefused&quot;);</span>
<a href="#l44.135"></a><span id="l44.135" class="difflineplus">+        exitString = u&quot;smtpSendRequestRefused&quot;;</span>
<a href="#l44.136"></a><span id="l44.136">         break;</span>
<a href="#l44.137"></a><span id="l44.137">       case NS_ERROR_NET_INTERRUPT:</span>
<a href="#l44.138"></a><span id="l44.138">       case NS_ERROR_ABORT: // we have no proper string for error code NS_ERROR_ABORT in compose bundle</span>
<a href="#l44.139"></a><span id="l44.139" class="difflineminus">-        exitString = MOZ_UTF16(&quot;smtpSendInterrupted&quot;);</span>
<a href="#l44.140"></a><span id="l44.140" class="difflineplus">+        exitString = u&quot;smtpSendInterrupted&quot;;</span>
<a href="#l44.141"></a><span id="l44.141">         break;</span>
<a href="#l44.142"></a><span id="l44.142">       case NS_ERROR_NET_TIMEOUT:</span>
<a href="#l44.143"></a><span id="l44.143">       case NS_ERROR_NET_RESET:</span>
<a href="#l44.144"></a><span id="l44.144" class="difflineminus">-        exitString = MOZ_UTF16(&quot;smtpSendTimeout&quot;);</span>
<a href="#l44.145"></a><span id="l44.145" class="difflineplus">+        exitString = u&quot;smtpSendTimeout&quot;;</span>
<a href="#l44.146"></a><span id="l44.146">         break;</span>
<a href="#l44.147"></a><span id="l44.147">       default:</span>
<a href="#l44.148"></a><span id="l44.148">         exitString = errorStringNameForErrorCode(aExitCode);</span>
<a href="#l44.149"></a><span id="l44.149">         break;</span>
<a href="#l44.150"></a><span id="l44.150">     }</span>
<a href="#l44.151"></a><span id="l44.151"> </span>
<a href="#l44.152"></a><span id="l44.152">     nsCOMPtr&lt;nsISmtpService&gt; smtpService(do_GetService(NS_SMTPSERVICE_CONTRACTID, &amp;rv));</span>
<a href="#l44.153"></a><span id="l44.153">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l44.154"></a><span id="l44.154" class="difflineat">@@ -1123,17 +1123,17 @@ NS_IMETHODIMP nsMsgMdnGenerator::OnStopR</span>
<a href="#l44.155"></a><span id="l44.155">     rv = bundleService-&gt;CreateBundle(</span>
<a href="#l44.156"></a><span id="l44.156">       &quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;,</span>
<a href="#l44.157"></a><span id="l44.157">       getter_AddRefs(bundle));</span>
<a href="#l44.158"></a><span id="l44.158">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l44.159"></a><span id="l44.159"> </span>
<a href="#l44.160"></a><span id="l44.160">     nsString failed_msg, dialogTitle;</span>
<a href="#l44.161"></a><span id="l44.161"> </span>
<a href="#l44.162"></a><span id="l44.162">     bundle-&gt;FormatStringFromName(exitString, params, 1, getter_Copies(failed_msg));</span>
<a href="#l44.163"></a><span id="l44.163" class="difflineminus">-    bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;sendMessageErrorTitle&quot;), getter_Copies(dialogTitle));</span>
<a href="#l44.164"></a><span id="l44.164" class="difflineplus">+    bundle-&gt;GetStringFromName(u&quot;sendMessageErrorTitle&quot;, getter_Copies(dialogTitle));</span>
<a href="#l44.165"></a><span id="l44.165"> </span>
<a href="#l44.166"></a><span id="l44.166">     nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l44.167"></a><span id="l44.167">     rv = m_window-&gt;GetPromptDialog(getter_AddRefs(dialog));</span>
<a href="#l44.168"></a><span id="l44.168">     if (NS_SUCCEEDED(rv))</span>
<a href="#l44.169"></a><span id="l44.169">       dialog-&gt;Alert(dialogTitle.get(),failed_msg.get());</span>
<a href="#l44.170"></a><span id="l44.170"> </span>
<a href="#l44.171"></a><span id="l44.171">     return NS_OK;</span>
<a href="#l44.172"></a><span id="l44.172"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -556,17 +556,17 @@ nsresult nsMsgComposeSecure::MimeInitEnc</span>
<a href="#l45.4"></a><span id="l45.4">   nsCOMPtr&lt;nsIStringBundle&gt; sMIMEBundle;</span>
<a href="#l45.5"></a><span id="l45.5">   nsString mime_smime_enc_content_desc;</span>
<a href="#l45.6"></a><span id="l45.6"> </span>
<a href="#l45.7"></a><span id="l45.7">   bundleSvc-&gt;CreateBundle(SMIME_STRBUNDLE_URL, getter_AddRefs(sMIMEBundle));</span>
<a href="#l45.8"></a><span id="l45.8"> </span>
<a href="#l45.9"></a><span id="l45.9">   if (!sMIMEBundle)</span>
<a href="#l45.10"></a><span id="l45.10">     return NS_ERROR_FAILURE;</span>
<a href="#l45.11"></a><span id="l45.11"> </span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-  sMIMEBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;mime_smimeEncryptedContentDesc&quot;),</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+  sMIMEBundle-&gt;GetStringFromName(u&quot;mime_smimeEncryptedContentDesc&quot;,</span>
<a href="#l45.14"></a><span id="l45.14">                                  getter_Copies(mime_smime_enc_content_desc));</span>
<a href="#l45.15"></a><span id="l45.15">   NS_ConvertUTF16toUTF8 enc_content_desc_utf8(mime_smime_enc_content_desc);</span>
<a href="#l45.16"></a><span id="l45.16"> </span>
<a href="#l45.17"></a><span id="l45.17">   nsCOMPtr&lt;nsIMimeConverter&gt; mimeConverter =</span>
<a href="#l45.18"></a><span id="l45.18">      do_GetService(NS_MIME_CONVERTER_CONTRACTID, &amp;rv);</span>
<a href="#l45.19"></a><span id="l45.19">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l45.20"></a><span id="l45.20">   nsCString encodedContentDescription;</span>
<a href="#l45.21"></a><span id="l45.21">   mimeConverter-&gt;EncodeMimePartIIStr_UTF8(enc_content_desc_utf8, false, &quot;UTF-8&quot;,</span>
<a href="#l45.22"></a><span id="l45.22" class="difflineat">@@ -616,34 +616,34 @@ nsresult nsMsgComposeSecure::MimeInitEnc</span>
<a href="#l45.23"></a><span id="l45.23"> </span>
<a href="#l45.24"></a><span id="l45.24">   /* Initialize the encrypter (and add the sender's cert.) */</span>
<a href="#l45.25"></a><span id="l45.25">   PR_ASSERT(mSelfEncryptionCert);</span>
<a href="#l45.26"></a><span id="l45.26">   PR_SetError(0,0);</span>
<a href="#l45.27"></a><span id="l45.27">   mEncryptionCinfo = do_CreateInstance(NS_CMSMESSAGE_CONTRACTID, &amp;rv);</span>
<a href="#l45.28"></a><span id="l45.28">   if (NS_FAILED(rv)) return rv;</span>
<a href="#l45.29"></a><span id="l45.29">   rv = mEncryptionCinfo-&gt;CreateEncrypted(mCerts);</span>
<a href="#l45.30"></a><span id="l45.30">   if (NS_FAILED(rv)) {</span>
<a href="#l45.31"></a><span id="l45.31" class="difflineminus">-    SetError(sendReport, MOZ_UTF16(&quot;ErrorEncryptMail&quot;));</span>
<a href="#l45.32"></a><span id="l45.32" class="difflineplus">+    SetError(sendReport, u&quot;ErrorEncryptMail&quot;);</span>
<a href="#l45.33"></a><span id="l45.33">     goto FAIL;</span>
<a href="#l45.34"></a><span id="l45.34">   }</span>
<a href="#l45.35"></a><span id="l45.35"> </span>
<a href="#l45.36"></a><span id="l45.36">   mEncryptionContext = do_CreateInstance(NS_CMSENCODER_CONTRACTID, &amp;rv);</span>
<a href="#l45.37"></a><span id="l45.37">   if (NS_FAILED(rv)) return rv;</span>
<a href="#l45.38"></a><span id="l45.38"> </span>
<a href="#l45.39"></a><span id="l45.39">   if (!mBuffer) {</span>
<a href="#l45.40"></a><span id="l45.40">     mBuffer = new char[eBufferSize];</span>
<a href="#l45.41"></a><span id="l45.41">     if (!mBuffer)</span>
<a href="#l45.42"></a><span id="l45.42">       return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l45.43"></a><span id="l45.43">   }</span>
<a href="#l45.44"></a><span id="l45.44"> </span>
<a href="#l45.45"></a><span id="l45.45">   mBufferedBytes = 0;</span>
<a href="#l45.46"></a><span id="l45.46"> </span>
<a href="#l45.47"></a><span id="l45.47">   rv = mEncryptionContext-&gt;Start(mEncryptionCinfo, mime_crypto_write_base64, mCryptoEncoder);</span>
<a href="#l45.48"></a><span id="l45.48">   if (NS_FAILED(rv)) {</span>
<a href="#l45.49"></a><span id="l45.49" class="difflineminus">-    SetError(sendReport, MOZ_UTF16(&quot;ErrorEncryptMail&quot;));</span>
<a href="#l45.50"></a><span id="l45.50" class="difflineplus">+    SetError(sendReport, u&quot;ErrorEncryptMail&quot;);</span>
<a href="#l45.51"></a><span id="l45.51">     goto FAIL;</span>
<a href="#l45.52"></a><span id="l45.52">   }</span>
<a href="#l45.53"></a><span id="l45.53"> </span>
<a href="#l45.54"></a><span id="l45.54">   /* If we're signing, tack a multipart/signed header onto the front of</span>
<a href="#l45.55"></a><span id="l45.55">    the data to be encrypted, and initialize the sign-hashing code too.</span>
<a href="#l45.56"></a><span id="l45.56">    */</span>
<a href="#l45.57"></a><span id="l45.57">   if (aSign) {</span>
<a href="#l45.58"></a><span id="l45.58">     rv = MimeInitMultipartSigned(false, sendReport);</span>
<a href="#l45.59"></a><span id="l45.59" class="difflineat">@@ -672,17 +672,17 @@ nsresult nsMsgComposeSecure::MimeFinishM</span>
<a href="#l45.60"></a><span id="l45.60">   nsCOMPtr&lt;nsIStringBundle&gt; sMIMEBundle;</span>
<a href="#l45.61"></a><span id="l45.61">   nsString mime_smime_sig_content_desc;</span>
<a href="#l45.62"></a><span id="l45.62"> </span>
<a href="#l45.63"></a><span id="l45.63">   bundleSvc-&gt;CreateBundle(SMIME_STRBUNDLE_URL, getter_AddRefs(sMIMEBundle));</span>
<a href="#l45.64"></a><span id="l45.64"> </span>
<a href="#l45.65"></a><span id="l45.65">   if (!sMIMEBundle)</span>
<a href="#l45.66"></a><span id="l45.66">     return NS_ERROR_FAILURE;</span>
<a href="#l45.67"></a><span id="l45.67"> </span>
<a href="#l45.68"></a><span id="l45.68" class="difflineminus">-  sMIMEBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;mime_smimeSignatureContentDesc&quot;),</span>
<a href="#l45.69"></a><span id="l45.69" class="difflineplus">+  sMIMEBundle-&gt;GetStringFromName(u&quot;mime_smimeSignatureContentDesc&quot;,</span>
<a href="#l45.70"></a><span id="l45.70">                                  getter_Copies(mime_smime_sig_content_desc));</span>
<a href="#l45.71"></a><span id="l45.71"> </span>
<a href="#l45.72"></a><span id="l45.72">   NS_ConvertUTF16toUTF8 sig_content_desc_utf8(mime_smime_sig_content_desc);</span>
<a href="#l45.73"></a><span id="l45.73"> </span>
<a href="#l45.74"></a><span id="l45.74">   /* Compute the hash...</span>
<a href="#l45.75"></a><span id="l45.75">    */</span>
<a href="#l45.76"></a><span id="l45.76"> </span>
<a href="#l45.77"></a><span id="l45.77">   nsAutoCString hashString;</span>
<a href="#l45.78"></a><span id="l45.78" class="difflineat">@@ -736,38 +736,38 @@ nsresult nsMsgComposeSecure::MimeFinishM</span>
<a href="#l45.79"></a><span id="l45.79">   NS_ASSERTION(mHashType, &quot;Hash function for signature has not been set.&quot;);</span>
<a href="#l45.80"></a><span id="l45.80"> </span>
<a href="#l45.81"></a><span id="l45.81">   PR_ASSERT (mSelfSigningCert);</span>
<a href="#l45.82"></a><span id="l45.82">   PR_SetError(0,0);</span>
<a href="#l45.83"></a><span id="l45.83"> </span>
<a href="#l45.84"></a><span id="l45.84">   rv = cinfo-&gt;CreateSigned(mSelfSigningCert, mSelfEncryptionCert,</span>
<a href="#l45.85"></a><span id="l45.85">     (unsigned char*)hashString.get(), hashString.Length(), mHashType);</span>
<a href="#l45.86"></a><span id="l45.86">   if (NS_FAILED(rv))  {</span>
<a href="#l45.87"></a><span id="l45.87" class="difflineminus">-    SetError(sendReport, MOZ_UTF16(&quot;ErrorCanNotSignMail&quot;));</span>
<a href="#l45.88"></a><span id="l45.88" class="difflineplus">+    SetError(sendReport, u&quot;ErrorCanNotSignMail&quot;);</span>
<a href="#l45.89"></a><span id="l45.89">     goto FAIL;</span>
<a href="#l45.90"></a><span id="l45.90">   }</span>
<a href="#l45.91"></a><span id="l45.91"> </span>
<a href="#l45.92"></a><span id="l45.92">   // Initialize the base64 encoder for the signature data.</span>
<a href="#l45.93"></a><span id="l45.93">   MOZ_ASSERT(!mSigEncoder, &quot;Shouldn't already have a mSigEncoder&quot;);</span>
<a href="#l45.94"></a><span id="l45.94">   mSigEncoder = MimeEncoder::GetBase64Encoder(</span>
<a href="#l45.95"></a><span id="l45.95">     (aOuter ? mime_encoder_output_fn : mime_nested_encoder_output_fn), this);</span>
<a href="#l45.96"></a><span id="l45.96"> </span>
<a href="#l45.97"></a><span id="l45.97">   /* Write out the signature.</span>
<a href="#l45.98"></a><span id="l45.98">    */</span>
<a href="#l45.99"></a><span id="l45.99">   PR_SetError(0,0);</span>
<a href="#l45.100"></a><span id="l45.100">   rv = encoder-&gt;Start(cinfo, mime_crypto_write_base64, mSigEncoder);</span>
<a href="#l45.101"></a><span id="l45.101">   if (NS_FAILED(rv)) {</span>
<a href="#l45.102"></a><span id="l45.102" class="difflineminus">-    SetError(sendReport, MOZ_UTF16(&quot;ErrorCanNotSignMail&quot;));</span>
<a href="#l45.103"></a><span id="l45.103" class="difflineplus">+    SetError(sendReport, u&quot;ErrorCanNotSignMail&quot;);</span>
<a href="#l45.104"></a><span id="l45.104">     goto FAIL;</span>
<a href="#l45.105"></a><span id="l45.105">   }</span>
<a href="#l45.106"></a><span id="l45.106"> </span>
<a href="#l45.107"></a><span id="l45.107">   // We're not passing in any data, so no update needed.</span>
<a href="#l45.108"></a><span id="l45.108">   rv = encoder-&gt;Finish();</span>
<a href="#l45.109"></a><span id="l45.109">   if (NS_FAILED(rv)) {</span>
<a href="#l45.110"></a><span id="l45.110" class="difflineminus">-    SetError(sendReport, MOZ_UTF16(&quot;ErrorCanNotSignMail&quot;));</span>
<a href="#l45.111"></a><span id="l45.111" class="difflineplus">+    SetError(sendReport, u&quot;ErrorCanNotSignMail&quot;);</span>
<a href="#l45.112"></a><span id="l45.112">     goto FAIL;</span>
<a href="#l45.113"></a><span id="l45.113">   }</span>
<a href="#l45.114"></a><span id="l45.114"> </span>
<a href="#l45.115"></a><span id="l45.115">   // Shut down the sig's base64 encoder.</span>
<a href="#l45.116"></a><span id="l45.116">   rv = mSigEncoder-&gt;Flush();</span>
<a href="#l45.117"></a><span id="l45.117">   mSigEncoder = nullptr;</span>
<a href="#l45.118"></a><span id="l45.118">   if (NS_FAILED(rv)) {</span>
<a href="#l45.119"></a><span id="l45.119">     goto FAIL;</span>
<a href="#l45.120"></a><span id="l45.120" class="difflineat">@@ -831,17 +831,17 @@ nsresult nsMsgComposeSecure::MimeFinishE</span>
<a href="#l45.121"></a><span id="l45.121">     if (NS_FAILED(rv)) {</span>
<a href="#l45.122"></a><span id="l45.122">       PR_ASSERT(PR_GetError() &lt; 0);</span>
<a href="#l45.123"></a><span id="l45.123">       goto FAIL;</span>
<a href="#l45.124"></a><span id="l45.124">     }</span>
<a href="#l45.125"></a><span id="l45.125">   }</span>
<a href="#l45.126"></a><span id="l45.126"> </span>
<a href="#l45.127"></a><span id="l45.127">   rv = mEncryptionContext-&gt;Finish();</span>
<a href="#l45.128"></a><span id="l45.128">   if (NS_FAILED(rv)) {</span>
<a href="#l45.129"></a><span id="l45.129" class="difflineminus">-    SetError(sendReport, MOZ_UTF16(&quot;ErrorEncryptMail&quot;));</span>
<a href="#l45.130"></a><span id="l45.130" class="difflineplus">+    SetError(sendReport, u&quot;ErrorEncryptMail&quot;);</span>
<a href="#l45.131"></a><span id="l45.131">     goto FAIL;</span>
<a href="#l45.132"></a><span id="l45.132">   }</span>
<a href="#l45.133"></a><span id="l45.133"> </span>
<a href="#l45.134"></a><span id="l45.134">   mEncryptionContext = 0;</span>
<a href="#l45.135"></a><span id="l45.135"> </span>
<a href="#l45.136"></a><span id="l45.136">   PR_ASSERT(mEncryptionCinfo);</span>
<a href="#l45.137"></a><span id="l45.137">   if (!mEncryptionCinfo) {</span>
<a href="#l45.138"></a><span id="l45.138">     rv = NS_ERROR_FAILURE;</span>
<a href="#l45.139"></a><span id="l45.139" class="difflineat">@@ -938,22 +938,22 @@ nsresult nsMsgComposeSecure::MimeCryptoH</span>
<a href="#l45.140"></a><span id="l45.140">   }</span>
<a href="#l45.141"></a><span id="l45.141">   if (!mSelfSigningCert) {</span>
<a href="#l45.142"></a><span id="l45.142">     certdb-&gt;FindEmailSigningCert(mSigningCertName,</span>
<a href="#l45.143"></a><span id="l45.143">                                  getter_AddRefs(mSelfSigningCert));</span>
<a href="#l45.144"></a><span id="l45.144">   }</span>
<a href="#l45.145"></a><span id="l45.145"> </span>
<a href="#l45.146"></a><span id="l45.146">   // must have both the signing and encryption certs to sign</span>
<a href="#l45.147"></a><span id="l45.147">   if (!mSelfSigningCert &amp;&amp; aSign) {</span>
<a href="#l45.148"></a><span id="l45.148" class="difflineminus">-    SetError(sendReport, MOZ_UTF16(&quot;NoSenderSigningCert&quot;));</span>
<a href="#l45.149"></a><span id="l45.149" class="difflineplus">+    SetError(sendReport, u&quot;NoSenderSigningCert&quot;);</span>
<a href="#l45.150"></a><span id="l45.150">     return NS_ERROR_FAILURE;</span>
<a href="#l45.151"></a><span id="l45.151">   }</span>
<a href="#l45.152"></a><span id="l45.152"> </span>
<a href="#l45.153"></a><span id="l45.153">   if (!mSelfEncryptionCert &amp;&amp; aEncrypt) {</span>
<a href="#l45.154"></a><span id="l45.154" class="difflineminus">-    SetError(sendReport, MOZ_UTF16(&quot;NoSenderEncryptionCert&quot;));</span>
<a href="#l45.155"></a><span id="l45.155" class="difflineplus">+    SetError(sendReport, u&quot;NoSenderEncryptionCert&quot;);</span>
<a href="#l45.156"></a><span id="l45.156">     return NS_ERROR_FAILURE;</span>
<a href="#l45.157"></a><span id="l45.157">   }</span>
<a href="#l45.158"></a><span id="l45.158"> </span>
<a href="#l45.159"></a><span id="l45.159"> </span>
<a href="#l45.160"></a><span id="l45.160">   if (aEncrypt &amp;&amp; mSelfEncryptionCert) {</span>
<a href="#l45.161"></a><span id="l45.161">     // Make sure self's configured cert is prepared for being used</span>
<a href="#l45.162"></a><span id="l45.162">     // as an email recipient cert.</span>
<a href="#l45.163"></a><span id="l45.163">     mozilla::ScopedCERTCertificate nsscert(mSelfEncryptionCert-&gt;GetCert());</span>
<a href="#l45.164"></a><span id="l45.164" class="difflineat">@@ -980,17 +980,17 @@ nsresult nsMsgComposeSecure::MimeCryptoH</span>
<a href="#l45.165"></a><span id="l45.165">       ToLowerCase(mailboxes[i], mailbox_lowercase);</span>
<a href="#l45.166"></a><span id="l45.166">       nsCOMPtr&lt;nsIX509Cert&gt; cert;</span>
<a href="#l45.167"></a><span id="l45.167">       res = certdb-&gt;FindCertByEmailAddress(mailbox_lowercase.get(),</span>
<a href="#l45.168"></a><span id="l45.168">                                            getter_AddRefs(cert));</span>
<a href="#l45.169"></a><span id="l45.169">       if (NS_FAILED(res)) {</span>
<a href="#l45.170"></a><span id="l45.170">         // Failure to find a valid encryption cert is fatal.</span>
<a href="#l45.171"></a><span id="l45.171">         // Here I assume that mailbox is ascii rather than utf8.</span>
<a href="#l45.172"></a><span id="l45.172">         SetErrorWithParam(sendReport,</span>
<a href="#l45.173"></a><span id="l45.173" class="difflineminus">-                          MOZ_UTF16(&quot;MissingRecipientEncryptionCert&quot;),</span>
<a href="#l45.174"></a><span id="l45.174" class="difflineplus">+                          u&quot;MissingRecipientEncryptionCert&quot;,</span>
<a href="#l45.175"></a><span id="l45.175">                           mailboxes[i].get());</span>
<a href="#l45.176"></a><span id="l45.176"> </span>
<a href="#l45.177"></a><span id="l45.177">         return res;</span>
<a href="#l45.178"></a><span id="l45.178">       }</span>
<a href="#l45.179"></a><span id="l45.179"> </span>
<a href="#l45.180"></a><span id="l45.180">     /* #### see if recipient requests `signedData'.</span>
<a href="#l45.181"></a><span id="l45.181">      if (...) no_clearsigning_p = true;</span>
<a href="#l45.182"></a><span id="l45.182">      (This is the only reason we even bother looking up the certs</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/mailnews/imap/src/nsImapIncomingServer.cpp</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapIncomingServer.cpp</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -1852,17 +1852,17 @@ nsImapIncomingServer::FEAlert(const nsAS</span>
<a href="#l46.4"></a><span id="l46.4">     nsresult rv = GetPrettyName(hostName);</span>
<a href="#l46.5"></a><span id="l46.5">     if (NS_SUCCEEDED(rv))</span>
<a href="#l46.6"></a><span id="l46.6">     {</span>
<a href="#l46.7"></a><span id="l46.7">       nsString message;</span>
<a href="#l46.8"></a><span id="l46.8">       nsString tempString(aAlertString);</span>
<a href="#l46.9"></a><span id="l46.9">       const char16_t *params[] = { hostName.get(), tempString.get() };</span>
<a href="#l46.10"></a><span id="l46.10"> </span>
<a href="#l46.11"></a><span id="l46.11">       rv = m_stringBundle-&gt;FormatStringFromName(</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-        MOZ_UTF16(&quot;imapServerAlert&quot;),</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineplus">+        u&quot;imapServerAlert&quot;,</span>
<a href="#l46.14"></a><span id="l46.14">         params, 2, getter_Copies(message));</span>
<a href="#l46.15"></a><span id="l46.15">       if (NS_SUCCEEDED(rv))</span>
<a href="#l46.16"></a><span id="l46.16">         return AlertUser(message, aUrl);</span>
<a href="#l46.17"></a><span id="l46.17">     }</span>
<a href="#l46.18"></a><span id="l46.18">   }</span>
<a href="#l46.19"></a><span id="l46.19">   return AlertUser(aAlertString, aUrl);</span>
<a href="#l46.20"></a><span id="l46.20"> }</span>
<a href="#l46.21"></a><span id="l46.21"> </span>
<a href="#l46.22"></a><span id="l46.22" class="difflineat">@@ -2193,17 +2193,17 @@ nsImapIncomingServer::PromptPassword(nsI</span>
<a href="#l46.23"></a><span id="l46.23"> </span>
<a href="#l46.24"></a><span id="l46.24">   NS_ConvertASCIItoUTF16 finalUserName(userName);</span>
<a href="#l46.25"></a><span id="l46.25">   NS_ConvertASCIItoUTF16 finalHostName(hostName);</span>
<a href="#l46.26"></a><span id="l46.26"> </span>
<a href="#l46.27"></a><span id="l46.27">   const char16_t *formatStrings[] = { finalUserName.get(), finalHostName.get() };</span>
<a href="#l46.28"></a><span id="l46.28"> </span>
<a href="#l46.29"></a><span id="l46.29">   nsString passwordText;</span>
<a href="#l46.30"></a><span id="l46.30">   rv = m_stringBundle-&gt;FormatStringFromName(</span>
<a href="#l46.31"></a><span id="l46.31" class="difflineminus">-    MOZ_UTF16(&quot;imapEnterServerPasswordPrompt&quot;),</span>
<a href="#l46.32"></a><span id="l46.32" class="difflineplus">+    u&quot;imapEnterServerPasswordPrompt&quot;,</span>
<a href="#l46.33"></a><span id="l46.33">     formatStrings, 2, getter_Copies(passwordText));</span>
<a href="#l46.34"></a><span id="l46.34">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l46.35"></a><span id="l46.35"> </span>
<a href="#l46.36"></a><span id="l46.36">   rv = GetPasswordWithUI(passwordText, passwordTitle, aMsgWindow, aPassword);</span>
<a href="#l46.37"></a><span id="l46.37">   if (NS_SUCCEEDED(rv))</span>
<a href="#l46.38"></a><span id="l46.38">     m_password = aPassword;</span>
<a href="#l46.39"></a><span id="l46.39">   return rv;</span>
<a href="#l46.40"></a><span id="l46.40"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -1609,30 +1609,30 @@ NS_IMETHODIMP nsImapMailFolder::Rename (</span>
<a href="#l47.4"></a><span id="l47.4">       if (NS_SUCCEEDED(rv) &amp;&amp; bundle)</span>
<a href="#l47.5"></a><span id="l47.5">       {</span>
<a href="#l47.6"></a><span id="l47.6">         const char16_t *formatStrings[] =</span>
<a href="#l47.7"></a><span id="l47.7">         {</span>
<a href="#l47.8"></a><span id="l47.8">           (const char16_t*)(intptr_t)m_hierarchyDelimiter</span>
<a href="#l47.9"></a><span id="l47.9">         };</span>
<a href="#l47.10"></a><span id="l47.10">         nsString alertString;</span>
<a href="#l47.11"></a><span id="l47.11">         rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-          MOZ_UTF16(&quot;imapSpecialChar&quot;),</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineplus">+          u&quot;imapSpecialChar&quot;,</span>
<a href="#l47.14"></a><span id="l47.14">           formatStrings, 1, getter_Copies(alertString));</span>
<a href="#l47.15"></a><span id="l47.15">         nsCOMPtr&lt;nsIPrompt&gt; dialog(do_GetInterface(docShell));</span>
<a href="#l47.16"></a><span id="l47.16">         // setting up the dialog title</span>
<a href="#l47.17"></a><span id="l47.17">         nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l47.18"></a><span id="l47.18">         rv = GetServer(getter_AddRefs(server));</span>
<a href="#l47.19"></a><span id="l47.19">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l47.20"></a><span id="l47.20">         nsString dialogTitle;</span>
<a href="#l47.21"></a><span id="l47.21">         nsString accountName;</span>
<a href="#l47.22"></a><span id="l47.22">         rv = server-&gt;GetPrettyName(accountName);</span>
<a href="#l47.23"></a><span id="l47.23">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l47.24"></a><span id="l47.24">         const char16_t *titleParams[] = { accountName.get() };</span>
<a href="#l47.25"></a><span id="l47.25">         rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l47.26"></a><span id="l47.26" class="difflineminus">-          MOZ_UTF16(&quot;imapAlertDialogTitle&quot;),</span>
<a href="#l47.27"></a><span id="l47.27" class="difflineplus">+          u&quot;imapAlertDialogTitle&quot;,</span>
<a href="#l47.28"></a><span id="l47.28">           titleParams, 1, getter_Copies(dialogTitle));</span>
<a href="#l47.29"></a><span id="l47.29"> </span>
<a href="#l47.30"></a><span id="l47.30">         if (dialog &amp;&amp; !alertString.IsEmpty())</span>
<a href="#l47.31"></a><span id="l47.31">           dialog-&gt;Alert(dialogTitle.get(), alertString.get());</span>
<a href="#l47.32"></a><span id="l47.32">       }</span>
<a href="#l47.33"></a><span id="l47.33">     }</span>
<a href="#l47.34"></a><span id="l47.34">     return NS_ERROR_FAILURE;</span>
<a href="#l47.35"></a><span id="l47.35">   }</span>
<a href="#l47.36"></a><span id="l47.36" class="difflineat">@@ -2429,30 +2429,30 @@ nsImapMailFolder::DeleteSubFolders(nsIAr</span>
<a href="#l47.37"></a><span id="l47.37"> </span>
<a href="#l47.38"></a><span id="l47.38">     nsAutoString folderName;</span>
<a href="#l47.39"></a><span id="l47.39">     rv = curFolder-&gt;GetName(folderName);</span>
<a href="#l47.40"></a><span id="l47.40">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l47.41"></a><span id="l47.41">     const char16_t *formatStrings[1] = { folderName.get() };</span>
<a href="#l47.42"></a><span id="l47.42"> </span>
<a href="#l47.43"></a><span id="l47.43">     nsAutoString deleteFolderDialogTitle;</span>
<a href="#l47.44"></a><span id="l47.44">     rv = bundle-&gt;GetStringFromName(</span>
<a href="#l47.45"></a><span id="l47.45" class="difflineminus">-      MOZ_UTF16(&quot;imapDeleteFolderDialogTitle&quot;),</span>
<a href="#l47.46"></a><span id="l47.46" class="difflineplus">+      u&quot;imapDeleteFolderDialogTitle&quot;,</span>
<a href="#l47.47"></a><span id="l47.47">       getter_Copies(deleteFolderDialogTitle));</span>
<a href="#l47.48"></a><span id="l47.48">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l47.49"></a><span id="l47.49"> </span>
<a href="#l47.50"></a><span id="l47.50">     nsAutoString deleteFolderButtonLabel;</span>
<a href="#l47.51"></a><span id="l47.51">     rv = bundle-&gt;GetStringFromName(</span>
<a href="#l47.52"></a><span id="l47.52" class="difflineminus">-      MOZ_UTF16(&quot;imapDeleteFolderButtonLabel&quot;),</span>
<a href="#l47.53"></a><span id="l47.53" class="difflineplus">+      u&quot;imapDeleteFolderButtonLabel&quot;,</span>
<a href="#l47.54"></a><span id="l47.54">       getter_Copies(deleteFolderButtonLabel));</span>
<a href="#l47.55"></a><span id="l47.55">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l47.56"></a><span id="l47.56"> </span>
<a href="#l47.57"></a><span id="l47.57">     nsAutoString confirmationStr;</span>
<a href="#l47.58"></a><span id="l47.58">     rv = bundle-&gt;FormatStringFromName((deleteNoTrash) ?</span>
<a href="#l47.59"></a><span id="l47.59" class="difflineminus">-        MOZ_UTF16(&quot;imapDeleteNoTrash&quot;) :</span>
<a href="#l47.60"></a><span id="l47.60" class="difflineminus">-        MOZ_UTF16(&quot;imapMoveFolderToTrash&quot;),</span>
<a href="#l47.61"></a><span id="l47.61" class="difflineplus">+        u&quot;imapDeleteNoTrash&quot; :</span>
<a href="#l47.62"></a><span id="l47.62" class="difflineplus">+        u&quot;imapMoveFolderToTrash&quot;,</span>
<a href="#l47.63"></a><span id="l47.63">       formatStrings, 1, getter_Copies(confirmationStr));</span>
<a href="#l47.64"></a><span id="l47.64">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l47.65"></a><span id="l47.65">     if (!msgWindow)</span>
<a href="#l47.66"></a><span id="l47.66">       return NS_ERROR_NULL_POINTER;</span>
<a href="#l47.67"></a><span id="l47.67">     nsCOMPtr&lt;nsIDocShell&gt; docShell;</span>
<a href="#l47.68"></a><span id="l47.68">     msgWindow-&gt;GetRootDocShell(getter_AddRefs(docShell));</span>
<a href="#l47.69"></a><span id="l47.69">     nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l47.70"></a><span id="l47.70">     if (docShell)</span>
<a href="#l47.71"></a><span id="l47.71" class="difflineat">@@ -6063,17 +6063,17 @@ nsImapMailFolder::FillInFolderProps(nsIM</span>
<a href="#l47.72"></a><span id="l47.72">     }</span>
<a href="#l47.73"></a><span id="l47.73">     else</span>
<a href="#l47.74"></a><span id="l47.74">     {</span>
<a href="#l47.75"></a><span id="l47.75">       // is this right? It doesn't leak, does it?</span>
<a href="#l47.76"></a><span id="l47.76">       CopyASCIItoUTF16(owner, uniOwner);</span>
<a href="#l47.77"></a><span id="l47.77">     }</span>
<a href="#l47.78"></a><span id="l47.78">     const char16_t *params[] = { uniOwner.get() };</span>
<a href="#l47.79"></a><span id="l47.79">     rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l47.80"></a><span id="l47.80" class="difflineminus">-      MOZ_UTF16(&quot;imapOtherUsersFolderTypeDescription&quot;),</span>
<a href="#l47.81"></a><span id="l47.81" class="difflineplus">+      u&quot;imapOtherUsersFolderTypeDescription&quot;,</span>
<a href="#l47.82"></a><span id="l47.82">       params, 1, getter_Copies(folderTypeDesc));</span>
<a href="#l47.83"></a><span id="l47.83">   }</span>
<a href="#l47.84"></a><span id="l47.84">   else if (GetFolderACL()-&gt;GetIsFolderShared())</span>
<a href="#l47.85"></a><span id="l47.85">   {</span>
<a href="#l47.86"></a><span id="l47.86">     folderTypeStringID = &quot;imapPersonalSharedFolderTypeName&quot;;</span>
<a href="#l47.87"></a><span id="l47.87">     folderTypeDescStringID = &quot;imapPersonalSharedFolderTypeDescription&quot;;</span>
<a href="#l47.88"></a><span id="l47.88">   }</span>
<a href="#l47.89"></a><span id="l47.89">   else</span>
<a href="#l47.90"></a><span id="l47.90" class="difflineat">@@ -6594,90 +6594,90 @@ nsresult nsMsgIMAPFolderACL::CreateACLRi</span>
<a href="#l47.91"></a><span id="l47.91"> {</span>
<a href="#l47.92"></a><span id="l47.92">   nsString curRight;</span>
<a href="#l47.93"></a><span id="l47.93">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l47.94"></a><span id="l47.94">   nsresult rv = IMAPGetStringBundle(getter_AddRefs(bundle));</span>
<a href="#l47.95"></a><span id="l47.95">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l47.96"></a><span id="l47.96"> </span>
<a href="#l47.97"></a><span id="l47.97">   if (GetDoIHaveFullRightsForFolder()) {</span>
<a href="#l47.98"></a><span id="l47.98">     nsAutoString result;</span>
<a href="#l47.99"></a><span id="l47.99" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapAclFullRights&quot;),</span>
<a href="#l47.100"></a><span id="l47.100" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(u&quot;imapAclFullRights&quot;,</span>
<a href="#l47.101"></a><span id="l47.101">                                    getter_Copies(result));</span>
<a href="#l47.102"></a><span id="l47.102">     aRightsString.Assign(result);</span>
<a href="#l47.103"></a><span id="l47.103">     return rv;</span>
<a href="#l47.104"></a><span id="l47.104">   }</span>
<a href="#l47.105"></a><span id="l47.105">   else</span>
<a href="#l47.106"></a><span id="l47.106">   {</span>
<a href="#l47.107"></a><span id="l47.107">     if (GetCanIReadFolder())</span>
<a href="#l47.108"></a><span id="l47.108">     {</span>
<a href="#l47.109"></a><span id="l47.109" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapAclReadRight&quot;),</span>
<a href="#l47.110"></a><span id="l47.110" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;imapAclReadRight&quot;,</span>
<a href="#l47.111"></a><span id="l47.111">                                 getter_Copies(curRight));</span>
<a href="#l47.112"></a><span id="l47.112">       aRightsString.Append(curRight);</span>
<a href="#l47.113"></a><span id="l47.113">     }</span>
<a href="#l47.114"></a><span id="l47.114">     if (GetCanIWriteFolder())</span>
<a href="#l47.115"></a><span id="l47.115">     {</span>
<a href="#l47.116"></a><span id="l47.116">       if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l47.117"></a><span id="l47.117" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapAclWriteRight&quot;),</span>
<a href="#l47.118"></a><span id="l47.118" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;imapAclWriteRight&quot;,</span>
<a href="#l47.119"></a><span id="l47.119">                                 getter_Copies(curRight));</span>
<a href="#l47.120"></a><span id="l47.120">       aRightsString.Append(curRight);</span>
<a href="#l47.121"></a><span id="l47.121">     }</span>
<a href="#l47.122"></a><span id="l47.122">     if (GetCanIInsertInFolder())</span>
<a href="#l47.123"></a><span id="l47.123">     {</span>
<a href="#l47.124"></a><span id="l47.124">       if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l47.125"></a><span id="l47.125" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapAclInsertRight&quot;),</span>
<a href="#l47.126"></a><span id="l47.126" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;imapAclInsertRight&quot;,</span>
<a href="#l47.127"></a><span id="l47.127">                                 getter_Copies(curRight));</span>
<a href="#l47.128"></a><span id="l47.128">       aRightsString.Append(curRight);</span>
<a href="#l47.129"></a><span id="l47.129">     }</span>
<a href="#l47.130"></a><span id="l47.130">     if (GetCanILookupFolder())</span>
<a href="#l47.131"></a><span id="l47.131">     {</span>
<a href="#l47.132"></a><span id="l47.132">       if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l47.133"></a><span id="l47.133" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapAclLookupRight&quot;),</span>
<a href="#l47.134"></a><span id="l47.134" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;imapAclLookupRight&quot;,</span>
<a href="#l47.135"></a><span id="l47.135">                                 getter_Copies(curRight));</span>
<a href="#l47.136"></a><span id="l47.136">       aRightsString.Append(curRight);</span>
<a href="#l47.137"></a><span id="l47.137">     }</span>
<a href="#l47.138"></a><span id="l47.138">     if (GetCanIStoreSeenInFolder())</span>
<a href="#l47.139"></a><span id="l47.139">     {</span>
<a href="#l47.140"></a><span id="l47.140">       if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l47.141"></a><span id="l47.141" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapAclSeenRight&quot;),</span>
<a href="#l47.142"></a><span id="l47.142" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;imapAclSeenRight&quot;,</span>
<a href="#l47.143"></a><span id="l47.143">                                 getter_Copies(curRight));</span>
<a href="#l47.144"></a><span id="l47.144">       aRightsString.Append(curRight);</span>
<a href="#l47.145"></a><span id="l47.145">     }</span>
<a href="#l47.146"></a><span id="l47.146">     if (GetCanIDeleteInFolder())</span>
<a href="#l47.147"></a><span id="l47.147">     {</span>
<a href="#l47.148"></a><span id="l47.148">       if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l47.149"></a><span id="l47.149" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapAclDeleteRight&quot;),</span>
<a href="#l47.150"></a><span id="l47.150" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;imapAclDeleteRight&quot;,</span>
<a href="#l47.151"></a><span id="l47.151">                                 getter_Copies(curRight));</span>
<a href="#l47.152"></a><span id="l47.152">       aRightsString.Append(curRight);</span>
<a href="#l47.153"></a><span id="l47.153">     }</span>
<a href="#l47.154"></a><span id="l47.154">     if (GetCanIExpungeFolder())</span>
<a href="#l47.155"></a><span id="l47.155">     {</span>
<a href="#l47.156"></a><span id="l47.156">       if (!aRightsString.IsEmpty())</span>
<a href="#l47.157"></a><span id="l47.157">         aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l47.158"></a><span id="l47.158" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapAclExpungeRight&quot;),</span>
<a href="#l47.159"></a><span id="l47.159" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;imapAclExpungeRight&quot;,</span>
<a href="#l47.160"></a><span id="l47.160">                                 getter_Copies(curRight));</span>
<a href="#l47.161"></a><span id="l47.161">       aRightsString.Append(curRight);</span>
<a href="#l47.162"></a><span id="l47.162">     }</span>
<a href="#l47.163"></a><span id="l47.163">     if (GetCanICreateSubfolder())</span>
<a href="#l47.164"></a><span id="l47.164">     {</span>
<a href="#l47.165"></a><span id="l47.165">       if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l47.166"></a><span id="l47.166" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapAclCreateRight&quot;),</span>
<a href="#l47.167"></a><span id="l47.167" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;imapAclCreateRight&quot;,</span>
<a href="#l47.168"></a><span id="l47.168">                                 getter_Copies(curRight));</span>
<a href="#l47.169"></a><span id="l47.169">       aRightsString.Append(curRight);</span>
<a href="#l47.170"></a><span id="l47.170">     }</span>
<a href="#l47.171"></a><span id="l47.171">     if (GetCanIPostToFolder())</span>
<a href="#l47.172"></a><span id="l47.172">     {</span>
<a href="#l47.173"></a><span id="l47.173">       if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l47.174"></a><span id="l47.174" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapAclPostRight&quot;),</span>
<a href="#l47.175"></a><span id="l47.175" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;imapAclPostRight&quot;,</span>
<a href="#l47.176"></a><span id="l47.176">                                 getter_Copies(curRight));</span>
<a href="#l47.177"></a><span id="l47.177">       aRightsString.Append(curRight);</span>
<a href="#l47.178"></a><span id="l47.178">     }</span>
<a href="#l47.179"></a><span id="l47.179">     if (GetCanIAdministerFolder())</span>
<a href="#l47.180"></a><span id="l47.180">     {</span>
<a href="#l47.181"></a><span id="l47.181">       if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l47.182"></a><span id="l47.182" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapAclAdministerRight&quot;),</span>
<a href="#l47.183"></a><span id="l47.183" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;imapAclAdministerRight&quot;,</span>
<a href="#l47.184"></a><span id="l47.184">                                 getter_Copies(curRight));</span>
<a href="#l47.185"></a><span id="l47.185">       aRightsString.Append(curRight);</span>
<a href="#l47.186"></a><span id="l47.186">     }</span>
<a href="#l47.187"></a><span id="l47.187">   }</span>
<a href="#l47.188"></a><span id="l47.188">   return rv;</span>
<a href="#l47.189"></a><span id="l47.189"> }</span>
<a href="#l47.190"></a><span id="l47.190"> </span>
<a href="#l47.191"></a><span id="l47.191"> NS_IMETHODIMP nsImapMailFolder::GetFilePath(nsIFile ** aPathName)</span>
<a href="#l47.192"></a><span id="l47.192" class="difflineat">@@ -8212,17 +8212,17 @@ nsImapMailFolder::CopyStreamMessage(nsIM</span>
<a href="#l47.193"></a><span id="l47.193">                                             totalMsgString.get(),</span>
<a href="#l47.194"></a><span id="l47.194">                                             dstFolderName.get()</span>
<a href="#l47.195"></a><span id="l47.195">                                             };</span>
<a href="#l47.196"></a><span id="l47.196"> </span>
<a href="#l47.197"></a><span id="l47.197">       nsCOMPtr &lt;nsIStringBundle&gt; bundle;</span>
<a href="#l47.198"></a><span id="l47.198">       rv = IMAPGetStringBundle(getter_AddRefs(bundle));</span>
<a href="#l47.199"></a><span id="l47.199">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l47.200"></a><span id="l47.200">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l47.201"></a><span id="l47.201" class="difflineminus">-        MOZ_UTF16(&quot;imapCopyingMessageOf2&quot;),</span>
<a href="#l47.202"></a><span id="l47.202" class="difflineplus">+        u&quot;imapCopyingMessageOf2&quot;,</span>
<a href="#l47.203"></a><span id="l47.203">         formatStrings, 3, getter_Copies(progressText));</span>
<a href="#l47.204"></a><span id="l47.204">       nsCOMPtr &lt;nsIMsgStatusFeedback&gt; statusFeedback;</span>
<a href="#l47.205"></a><span id="l47.205">       if (m_copyState-&gt;m_msgWindow)</span>
<a href="#l47.206"></a><span id="l47.206">         m_copyState-&gt;m_msgWindow-&gt;GetStatusFeedback(getter_AddRefs(statusFeedback));</span>
<a href="#l47.207"></a><span id="l47.207">       if (statusFeedback)</span>
<a href="#l47.208"></a><span id="l47.208">       {</span>
<a href="#l47.209"></a><span id="l47.209">         statusFeedback-&gt;ShowStatusString(progressText);</span>
<a href="#l47.210"></a><span id="l47.210">         int32_t percent;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/mailnews/imap/src/nsImapProtocol.cpp</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapProtocol.cpp</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -546,17 +546,17 @@ nsImapProtocol::Initialize(nsIImapHostSe</span>
<a href="#l48.4"></a><span id="l48.4">   m_parser.SetHostSessionList(aHostSessionList);</span>
<a href="#l48.5"></a><span id="l48.5">   m_parser.SetFlagState(m_flagState);</span>
<a href="#l48.6"></a><span id="l48.6"> </span>
<a href="#l48.7"></a><span id="l48.7">   // Initialize the empty mime part string on the main thread.</span>
<a href="#l48.8"></a><span id="l48.8">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l48.9"></a><span id="l48.9">   rv = IMAPGetStringBundle(getter_AddRefs(bundle));</span>
<a href="#l48.10"></a><span id="l48.10">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l48.11"></a><span id="l48.11"> </span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;imapEmptyMimePart&quot;),</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(u&quot;imapEmptyMimePart&quot;,</span>
<a href="#l48.14"></a><span id="l48.14">     getter_Copies(m_emptyMimePartString));</span>
<a href="#l48.15"></a><span id="l48.15">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l48.16"></a><span id="l48.16"> </span>
<a href="#l48.17"></a><span id="l48.17">   // Now initialize the thread for the connection</span>
<a href="#l48.18"></a><span id="l48.18">   if (m_thread == nullptr)</span>
<a href="#l48.19"></a><span id="l48.19">   {</span>
<a href="#l48.20"></a><span id="l48.20">     nsresult rv = NS_NewThread(getter_AddRefs(m_iThread), this);</span>
<a href="#l48.21"></a><span id="l48.21">     if (NS_FAILED(rv))</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/mailnews/imap/src/nsImapService.cpp</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapService.cpp</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -2748,17 +2748,17 @@ NS_IMETHODIMP nsImapService::NewChannel2</span>
<a href="#l49.4"></a><span id="l49.4">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l49.5"></a><span id="l49.5">         // need to convert folder name from mod-utf7 to unicode</span>
<a href="#l49.6"></a><span id="l49.6">       nsAutoString unescapedName;</span>
<a href="#l49.7"></a><span id="l49.7">       if (NS_FAILED(CopyMUTF7toUTF16(fullFolderName, unescapedName)))</span>
<a href="#l49.8"></a><span id="l49.8">         CopyASCIItoUTF16(fullFolderName, unescapedName);</span>
<a href="#l49.9"></a><span id="l49.9">       const char16_t *formatStrings[1] = { unescapedName.get() };</span>
<a href="#l49.10"></a><span id="l49.10"> </span>
<a href="#l49.11"></a><span id="l49.11">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-        MOZ_UTF16(&quot;imapSubscribePrompt&quot;),</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineplus">+        u&quot;imapSubscribePrompt&quot;,</span>
<a href="#l49.14"></a><span id="l49.14">         formatStrings, 1, getter_Copies(confirmText));</span>
<a href="#l49.15"></a><span id="l49.15">       NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l49.16"></a><span id="l49.16"> </span>
<a href="#l49.17"></a><span id="l49.17">       bool confirmResult = false;</span>
<a href="#l49.18"></a><span id="l49.18">       rv = dialog-&gt;Confirm(nullptr, confirmText.get(), &amp;confirmResult);</span>
<a href="#l49.19"></a><span id="l49.19">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l49.20"></a><span id="l49.20"> </span>
<a href="#l49.21"></a><span id="l49.21">       if (confirmResult)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/mailnews/import/applemail/src/nsAppleMailImport.cpp</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/mailnews/import/applemail/src/nsAppleMailImport.cpp</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -58,23 +58,23 @@ nsAppleMailImportModule::~nsAppleMailImp</span>
<a href="#l50.4"></a><span id="l50.4"> </span>
<a href="#l50.5"></a><span id="l50.5"> </span>
<a href="#l50.6"></a><span id="l50.6"> NS_IMPL_ISUPPORTS(nsAppleMailImportModule, nsIImportModule)</span>
<a href="#l50.7"></a><span id="l50.7"> </span>
<a href="#l50.8"></a><span id="l50.8"> </span>
<a href="#l50.9"></a><span id="l50.9"> NS_IMETHODIMP nsAppleMailImportModule::GetName(char16_t **aName)</span>
<a href="#l50.10"></a><span id="l50.10"> {</span>
<a href="#l50.11"></a><span id="l50.11">   return mBundle ?</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-    mBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;ApplemailImportName&quot;), aName) : NS_ERROR_FAILURE;</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+    mBundle-&gt;GetStringFromName(u&quot;ApplemailImportName&quot;, aName) : NS_ERROR_FAILURE;</span>
<a href="#l50.14"></a><span id="l50.14"> }</span>
<a href="#l50.15"></a><span id="l50.15"> </span>
<a href="#l50.16"></a><span id="l50.16"> NS_IMETHODIMP nsAppleMailImportModule::GetDescription(char16_t **aName)</span>
<a href="#l50.17"></a><span id="l50.17"> {</span>
<a href="#l50.18"></a><span id="l50.18">   return mBundle ?</span>
<a href="#l50.19"></a><span id="l50.19" class="difflineminus">-    mBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;ApplemailImportDescription&quot;), aName) : NS_ERROR_FAILURE;</span>
<a href="#l50.20"></a><span id="l50.20" class="difflineplus">+    mBundle-&gt;GetStringFromName(u&quot;ApplemailImportDescription&quot;, aName) : NS_ERROR_FAILURE;</span>
<a href="#l50.21"></a><span id="l50.21"> }</span>
<a href="#l50.22"></a><span id="l50.22"> </span>
<a href="#l50.23"></a><span id="l50.23"> NS_IMETHODIMP nsAppleMailImportModule::GetSupports(char **aSupports)</span>
<a href="#l50.24"></a><span id="l50.24"> {</span>
<a href="#l50.25"></a><span id="l50.25">   NS_ENSURE_ARG_POINTER(aSupports);</span>
<a href="#l50.26"></a><span id="l50.26">   *aSupports = strdup(NS_IMPORT_MAIL_STR);</span>
<a href="#l50.27"></a><span id="l50.27">   return NS_OK;</span>
<a href="#l50.28"></a><span id="l50.28"> }</span>
<a href="#l50.29"></a><span id="l50.29" class="difflineat">@@ -97,17 +97,17 @@ NS_IMETHODIMP nsAppleMailImportModule::G</span>
<a href="#l50.30"></a><span id="l50.30">     nsCOMPtr&lt;nsIImportMail&gt; mail(do_CreateInstance(NS_APPLEMAILIMPL_CONTRACTID, &amp;rv));</span>
<a href="#l50.31"></a><span id="l50.31">     if (NS_SUCCEEDED(rv)) {</span>
<a href="#l50.32"></a><span id="l50.32">       nsCOMPtr&lt;nsIImportService&gt; impSvc(do_GetService(NS_IMPORTSERVICE_CONTRACTID, &amp;rv));</span>
<a href="#l50.33"></a><span id="l50.33">       if (NS_SUCCEEDED(rv)) {</span>
<a href="#l50.34"></a><span id="l50.34">         nsCOMPtr&lt;nsIImportGeneric&gt; generic;</span>
<a href="#l50.35"></a><span id="l50.35">         rv = impSvc-&gt;CreateNewGenericMail(getter_AddRefs(generic));</span>
<a href="#l50.36"></a><span id="l50.36">         if (NS_SUCCEEDED(rv)) {</span>
<a href="#l50.37"></a><span id="l50.37">           nsAutoString name;</span>
<a href="#l50.38"></a><span id="l50.38" class="difflineminus">-          rv = mBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;ApplemailImportName&quot;), getter_Copies(name));</span>
<a href="#l50.39"></a><span id="l50.39" class="difflineplus">+          rv = mBundle-&gt;GetStringFromName(u&quot;ApplemailImportName&quot;, getter_Copies(name));</span>
<a href="#l50.40"></a><span id="l50.40">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l50.41"></a><span id="l50.41"> </span>
<a href="#l50.42"></a><span id="l50.42">           nsCOMPtr&lt;nsISupportsString&gt; nameString(do_CreateInstance(NS_SUPPORTS_STRING_CONTRACTID, &amp;rv));</span>
<a href="#l50.43"></a><span id="l50.43">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l50.44"></a><span id="l50.44">           nameString-&gt;SetData(name);</span>
<a href="#l50.45"></a><span id="l50.45"> </span>
<a href="#l50.46"></a><span id="l50.46">           generic-&gt;SetData(&quot;name&quot;, nameString);</span>
<a href="#l50.47"></a><span id="l50.47">           generic-&gt;SetData(&quot;mailInterface&quot;, mail);</span>
<a href="#l50.48"></a><span id="l50.48" class="difflineat">@@ -470,17 +470,17 @@ nsAppleMailImportMail::ImportMailbox(nsI</span>
<a href="#l50.49"></a><span id="l50.49">   mProgress = 0;</span>
<a href="#l50.50"></a><span id="l50.50"> </span>
<a href="#l50.51"></a><span id="l50.51">   nsAutoString mailboxName;</span>
<a href="#l50.52"></a><span id="l50.52">   aMailbox-&gt;GetDisplayName(getter_Copies(mailboxName));</span>
<a href="#l50.53"></a><span id="l50.53"> </span>
<a href="#l50.54"></a><span id="l50.54">   nsCOMPtr&lt;nsIFile&gt; mboxFolder;</span>
<a href="#l50.55"></a><span id="l50.55">   nsresult rv = aMailbox-&gt;GetFile(getter_AddRefs(mboxFolder));</span>
<a href="#l50.56"></a><span id="l50.56">   if (NS_FAILED(rv) || !mboxFolder) {</span>
<a href="#l50.57"></a><span id="l50.57" class="difflineminus">-    ReportStatus(MOZ_UTF16(&quot;ApplemailImportMailboxConverterror&quot;), mailboxName, errorLog);</span>
<a href="#l50.58"></a><span id="l50.58" class="difflineplus">+    ReportStatus(u&quot;ApplemailImportMailboxConverterror&quot;, mailboxName, errorLog);</span>
<a href="#l50.59"></a><span id="l50.59">     SetLogs(successLog, errorLog, aSuccessLog, aErrorLog);</span>
<a href="#l50.60"></a><span id="l50.60">     return NS_ERROR_FAILURE;</span>
<a href="#l50.61"></a><span id="l50.61">   }</span>
<a href="#l50.62"></a><span id="l50.62"> </span>
<a href="#l50.63"></a><span id="l50.63">   // if we're an account mailbox, nothing do. if we're a real mbox</span>
<a href="#l50.64"></a><span id="l50.64">   // then we've got some messages to import!</span>
<a href="#l50.65"></a><span id="l50.65">   uint32_t mailboxIdentifier;</span>
<a href="#l50.66"></a><span id="l50.66">   aMailbox-&gt;GetIdentifier(&amp;mailboxIdentifier);</span>
<a href="#l50.67"></a><span id="l50.67" class="difflineat">@@ -496,35 +496,35 @@ nsAppleMailImportMail::ImportMailbox(nsI</span>
<a href="#l50.68"></a><span id="l50.68">       //</span>
<a href="#l50.69"></a><span id="l50.69">       // just indicate that we're done, using the same number that we used to estimate</span>
<a href="#l50.70"></a><span id="l50.70">       // number of messages earlier.</span>
<a href="#l50.71"></a><span id="l50.71">       uint32_t finalSize;</span>
<a href="#l50.72"></a><span id="l50.72">       aMailbox-&gt;GetSize(&amp;finalSize);</span>
<a href="#l50.73"></a><span id="l50.73">       mProgress = finalSize;</span>
<a href="#l50.74"></a><span id="l50.74"> </span>
<a href="#l50.75"></a><span id="l50.75">       // report that we successfully imported this mailbox</span>
<a href="#l50.76"></a><span id="l50.76" class="difflineminus">-      ReportStatus(MOZ_UTF16(&quot;ApplemailImportMailboxSuccess&quot;), mailboxName, successLog);</span>
<a href="#l50.77"></a><span id="l50.77" class="difflineplus">+      ReportStatus(u&quot;ApplemailImportMailboxSuccess&quot;, mailboxName, successLog);</span>
<a href="#l50.78"></a><span id="l50.78">       SetLogs(successLog, errorLog, aSuccessLog, aErrorLog);</span>
<a href="#l50.79"></a><span id="l50.79">       return NS_OK;</span>
<a href="#l50.80"></a><span id="l50.80">     }</span>
<a href="#l50.81"></a><span id="l50.81"> </span>
<a href="#l50.82"></a><span id="l50.82">     // let's import the messages!</span>
<a href="#l50.83"></a><span id="l50.83">     nsCOMPtr&lt;nsISimpleEnumerator&gt; directoryEnumerator;</span>
<a href="#l50.84"></a><span id="l50.84">     rv = messagesFolder-&gt;GetDirectoryEntries(getter_AddRefs(directoryEnumerator));</span>
<a href="#l50.85"></a><span id="l50.85">     if (NS_FAILED(rv)) {</span>
<a href="#l50.86"></a><span id="l50.86" class="difflineminus">-      ReportStatus(MOZ_UTF16(&quot;ApplemailImportMailboxConvertError&quot;), mailboxName, errorLog);</span>
<a href="#l50.87"></a><span id="l50.87" class="difflineplus">+      ReportStatus(u&quot;ApplemailImportMailboxConvertError&quot;, mailboxName, errorLog);</span>
<a href="#l50.88"></a><span id="l50.88">       SetLogs(successLog, errorLog, aSuccessLog, aErrorLog);</span>
<a href="#l50.89"></a><span id="l50.89">       return NS_ERROR_FAILURE;</span>
<a href="#l50.90"></a><span id="l50.90">     }</span>
<a href="#l50.91"></a><span id="l50.91"> </span>
<a href="#l50.92"></a><span id="l50.92">     // prepare an outstream to the destination file</span>
<a href="#l50.93"></a><span id="l50.93">     nsCOMPtr&lt;nsIMsgPluggableStore&gt; msgStore;</span>
<a href="#l50.94"></a><span id="l50.94">     rv = aDstFolder-&gt;GetMsgStore(getter_AddRefs(msgStore));</span>
<a href="#l50.95"></a><span id="l50.95">     if (!msgStore || NS_FAILED(rv)) {</span>
<a href="#l50.96"></a><span id="l50.96" class="difflineminus">-      ReportStatus(MOZ_UTF16(&quot;ApplemailImportMailboxConverterror&quot;), mailboxName, errorLog);</span>
<a href="#l50.97"></a><span id="l50.97" class="difflineplus">+      ReportStatus(u&quot;ApplemailImportMailboxConverterror&quot;, mailboxName, errorLog);</span>
<a href="#l50.98"></a><span id="l50.98">       SetLogs(successLog, errorLog, aSuccessLog, aErrorLog);</span>
<a href="#l50.99"></a><span id="l50.99">       return NS_ERROR_FAILURE;</span>
<a href="#l50.100"></a><span id="l50.100">     }</span>
<a href="#l50.101"></a><span id="l50.101"> </span>
<a href="#l50.102"></a><span id="l50.102">     bool hasMore = false;</span>
<a href="#l50.103"></a><span id="l50.103">     nsCOMPtr&lt;nsIOutputStream&gt; outStream;</span>
<a href="#l50.104"></a><span id="l50.104"> </span>
<a href="#l50.105"></a><span id="l50.105">     while (NS_SUCCEEDED(directoryEnumerator-&gt;HasMoreElements(&amp;hasMore)) &amp;&amp; hasMore) {</span>
<a href="#l50.106"></a><span id="l50.106" class="difflineat">@@ -576,17 +576,17 @@ nsAppleMailImportMail::ImportMailbox(nsI</span>
<a href="#l50.107"></a><span id="l50.107">   }</span>
<a href="#l50.108"></a><span id="l50.108">   // just indicate that we're done, using the same number that we used to estimate</span>
<a href="#l50.109"></a><span id="l50.109">   // number of messages earlier.</span>
<a href="#l50.110"></a><span id="l50.110">   uint32_t finalSize;</span>
<a href="#l50.111"></a><span id="l50.111">   aMailbox-&gt;GetSize(&amp;finalSize);</span>
<a href="#l50.112"></a><span id="l50.112">   mProgress = finalSize;</span>
<a href="#l50.113"></a><span id="l50.113"> </span>
<a href="#l50.114"></a><span id="l50.114">   // report that we successfully imported this mailbox</span>
<a href="#l50.115"></a><span id="l50.115" class="difflineminus">-  ReportStatus(MOZ_UTF16(&quot;ApplemailImportMailboxSuccess&quot;), mailboxName, successLog);</span>
<a href="#l50.116"></a><span id="l50.116" class="difflineplus">+  ReportStatus(u&quot;ApplemailImportMailboxSuccess&quot;, mailboxName, successLog);</span>
<a href="#l50.117"></a><span id="l50.117">   SetLogs(successLog, errorLog, aSuccessLog, aErrorLog);</span>
<a href="#l50.118"></a><span id="l50.118"> </span>
<a href="#l50.119"></a><span id="l50.119">   return NS_OK;</span>
<a href="#l50.120"></a><span id="l50.120"> }</span>
<a href="#l50.121"></a><span id="l50.121"> </span>
<a href="#l50.122"></a><span id="l50.122"> void nsAppleMailImportMail::ReportStatus(const char16_t* aErrorName, nsString &amp;aName,</span>
<a href="#l50.123"></a><span id="l50.123">                                          nsAString &amp;aStream)</span>
<a href="#l50.124"></a><span id="l50.124"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/mailnews/import/becky/src/nsBeckyAddressBooks.cpp</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/mailnews/import/becky/src/nsBeckyAddressBooks.cpp</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -56,17 +56,17 @@ nsBeckyAddressBooks::GetSupportsMultiple</span>
<a href="#l51.4"></a><span id="l51.4"> NS_IMETHODIMP</span>
<a href="#l51.5"></a><span id="l51.5"> nsBeckyAddressBooks::GetAutoFind(char16_t **aDescription,</span>
<a href="#l51.6"></a><span id="l51.6">                                  bool *_retval)</span>
<a href="#l51.7"></a><span id="l51.7"> {</span>
<a href="#l51.8"></a><span id="l51.8">   NS_ENSURE_ARG_POINTER(aDescription);</span>
<a href="#l51.9"></a><span id="l51.9">   NS_ENSURE_ARG_POINTER(_retval);</span>
<a href="#l51.10"></a><span id="l51.10"> </span>
<a href="#l51.11"></a><span id="l51.11">   *aDescription =</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-    nsBeckyStringBundle::GetStringByName(MOZ_UTF16(&quot;BeckyImportDescription&quot;));</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineplus">+    nsBeckyStringBundle::GetStringByName(u&quot;BeckyImportDescription&quot;);</span>
<a href="#l51.14"></a><span id="l51.14">   *_retval = false;</span>
<a href="#l51.15"></a><span id="l51.15"> </span>
<a href="#l51.16"></a><span id="l51.16">   return NS_OK;</span>
<a href="#l51.17"></a><span id="l51.17"> }</span>
<a href="#l51.18"></a><span id="l51.18"> </span>
<a href="#l51.19"></a><span id="l51.19"> NS_IMETHODIMP</span>
<a href="#l51.20"></a><span id="l51.20"> nsBeckyAddressBooks::GetNeedsFieldMap(nsIFile *aLocation, bool *_retval)</span>
<a href="#l51.21"></a><span id="l51.21"> {</span>
<a href="#l51.22"></a><span id="l51.22" class="difflineat">@@ -349,17 +349,17 @@ nsBeckyAddressBooks::ImportAddressBook(n</span>
<a href="#l51.23"></a><span id="l51.23">     if (NS_FAILED(rv)) {</span>
<a href="#l51.24"></a><span id="l51.24">       break;</span>
<a href="#l51.25"></a><span id="l51.25">     }</span>
<a href="#l51.26"></a><span id="l51.26">   }</span>
<a href="#l51.27"></a><span id="l51.27"> </span>
<a href="#l51.28"></a><span id="l51.28">   if (!error.IsEmpty())</span>
<a href="#l51.29"></a><span id="l51.29">     *aErrorLog = ToNewUnicode(error);</span>
<a href="#l51.30"></a><span id="l51.30">   else</span>
<a href="#l51.31"></a><span id="l51.31" class="difflineminus">-    *aSuccessLog = nsBeckyStringBundle::GetStringByName(MOZ_UTF16(&quot;BeckyImportAddressSuccess&quot;));</span>
<a href="#l51.32"></a><span id="l51.32" class="difflineplus">+    *aSuccessLog = nsBeckyStringBundle::GetStringByName(u&quot;BeckyImportAddressSuccess&quot;);</span>
<a href="#l51.33"></a><span id="l51.33"> </span>
<a href="#l51.34"></a><span id="l51.34">   return rv;</span>
<a href="#l51.35"></a><span id="l51.35"> }</span>
<a href="#l51.36"></a><span id="l51.36"> </span>
<a href="#l51.37"></a><span id="l51.37"> NS_IMETHODIMP</span>
<a href="#l51.38"></a><span id="l51.38"> nsBeckyAddressBooks::GetImportProgress(uint32_t *_retval)</span>
<a href="#l51.39"></a><span id="l51.39"> {</span>
<a href="#l51.40"></a><span id="l51.40">   NS_ENSURE_ARG_POINTER(_retval);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/mailnews/import/becky/src/nsBeckyFilters.cpp</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/mailnews/import/becky/src/nsBeckyFilters.cpp</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -95,17 +95,17 @@ nsBeckyFilters::AutoLocate(char16_t **aD</span>
<a href="#l52.4"></a><span id="l52.4">                            nsIFile **aLocation,</span>
<a href="#l52.5"></a><span id="l52.5">                            bool *_retval)</span>
<a href="#l52.6"></a><span id="l52.6"> {</span>
<a href="#l52.7"></a><span id="l52.7">   NS_ENSURE_ARG_POINTER(aLocation);</span>
<a href="#l52.8"></a><span id="l52.8">   NS_ENSURE_ARG_POINTER(_retval);</span>
<a href="#l52.9"></a><span id="l52.9"> </span>
<a href="#l52.10"></a><span id="l52.10">   if (aDescription) {</span>
<a href="#l52.11"></a><span id="l52.11">     *aDescription =</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-      nsBeckyStringBundle::GetStringByName(MOZ_UTF16(&quot;BeckyImportDescription&quot;));</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineplus">+      nsBeckyStringBundle::GetStringByName(u&quot;BeckyImportDescription&quot;);</span>
<a href="#l52.14"></a><span id="l52.14">   }</span>
<a href="#l52.15"></a><span id="l52.15">   *aLocation = nullptr;</span>
<a href="#l52.16"></a><span id="l52.16">   *_retval = false;</span>
<a href="#l52.17"></a><span id="l52.17"> </span>
<a href="#l52.18"></a><span id="l52.18">   nsresult rv;</span>
<a href="#l52.19"></a><span id="l52.19">   nsCOMPtr&lt;nsIFile&gt; location;</span>
<a href="#l52.20"></a><span id="l52.20">   rv = GetDefaultFilterLocation(getter_AddRefs(location));</span>
<a href="#l52.21"></a><span id="l52.21">   if (NS_FAILED(rv))</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/mailnews/import/becky/src/nsBeckyImport.cpp</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/mailnews/import/becky/src/nsBeckyImport.cpp</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -47,26 +47,26 @@ nsBeckyImport::~nsBeckyImport()</span>
<a href="#l53.4"></a><span id="l53.4"> </span>
<a href="#l53.5"></a><span id="l53.5"> NS_IMPL_ISUPPORTS(nsBeckyImport, nsIImportModule)</span>
<a href="#l53.6"></a><span id="l53.6"> </span>
<a href="#l53.7"></a><span id="l53.7"> NS_IMETHODIMP</span>
<a href="#l53.8"></a><span id="l53.8"> nsBeckyImport::GetName(char16_t **aName)</span>
<a href="#l53.9"></a><span id="l53.9"> {</span>
<a href="#l53.10"></a><span id="l53.10">   NS_ENSURE_ARG_POINTER(aName);</span>
<a href="#l53.11"></a><span id="l53.11">   *aName =</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-    nsBeckyStringBundle::GetStringByName(MOZ_UTF16(&quot;BeckyImportName&quot;));</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineplus">+    nsBeckyStringBundle::GetStringByName(u&quot;BeckyImportName&quot;);</span>
<a href="#l53.14"></a><span id="l53.14">   return NS_OK;</span>
<a href="#l53.15"></a><span id="l53.15"> }</span>
<a href="#l53.16"></a><span id="l53.16"> </span>
<a href="#l53.17"></a><span id="l53.17"> NS_IMETHODIMP</span>
<a href="#l53.18"></a><span id="l53.18"> nsBeckyImport::GetDescription(char16_t **aDescription)</span>
<a href="#l53.19"></a><span id="l53.19"> {</span>
<a href="#l53.20"></a><span id="l53.20">   NS_ENSURE_ARG_POINTER(aDescription);</span>
<a href="#l53.21"></a><span id="l53.21">   *aDescription =</span>
<a href="#l53.22"></a><span id="l53.22" class="difflineminus">-    nsBeckyStringBundle::GetStringByName(MOZ_UTF16(&quot;BeckyImportDescription&quot;));</span>
<a href="#l53.23"></a><span id="l53.23" class="difflineplus">+    nsBeckyStringBundle::GetStringByName(u&quot;BeckyImportDescription&quot;);</span>
<a href="#l53.24"></a><span id="l53.24">   return NS_OK;</span>
<a href="#l53.25"></a><span id="l53.25"> }</span>
<a href="#l53.26"></a><span id="l53.26"> </span>
<a href="#l53.27"></a><span id="l53.27"> NS_IMETHODIMP</span>
<a href="#l53.28"></a><span id="l53.28"> nsBeckyImport::GetSupports(char **aSupports)</span>
<a href="#l53.29"></a><span id="l53.29"> {</span>
<a href="#l53.30"></a><span id="l53.30">   NS_ENSURE_ARG_POINTER(aSupports);</span>
<a href="#l53.31"></a><span id="l53.31">   *aSupports = strdup(kBeckySupportsString);</span>
<a href="#l53.32"></a><span id="l53.32" class="difflineat">@@ -92,17 +92,17 @@ nsBeckyImport::GetMailImportInterface(ns</span>
<a href="#l53.33"></a><span id="l53.33">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l53.34"></a><span id="l53.34">   nsCOMPtr&lt;nsIImportGeneric&gt; generic;</span>
<a href="#l53.35"></a><span id="l53.35">   rv = importService-&gt;CreateNewGenericMail(getter_AddRefs(generic));</span>
<a href="#l53.36"></a><span id="l53.36">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l53.37"></a><span id="l53.37"> </span>
<a href="#l53.38"></a><span id="l53.38">   generic-&gt;SetData(&quot;mailInterface&quot;, importer);</span>
<a href="#l53.39"></a><span id="l53.39"> </span>
<a href="#l53.40"></a><span id="l53.40">   nsString name;</span>
<a href="#l53.41"></a><span id="l53.41" class="difflineminus">-  name.Adopt(nsBeckyStringBundle::GetStringByName(MOZ_UTF16(&quot;BeckyImportName&quot;)));</span>
<a href="#l53.42"></a><span id="l53.42" class="difflineplus">+  name.Adopt(nsBeckyStringBundle::GetStringByName(u&quot;BeckyImportName&quot;));</span>
<a href="#l53.43"></a><span id="l53.43"> </span>
<a href="#l53.44"></a><span id="l53.44">   nsCOMPtr&lt;nsISupportsString&gt; nameString(do_CreateInstance(NS_SUPPORTS_STRING_CONTRACTID, &amp;rv));</span>
<a href="#l53.45"></a><span id="l53.45">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l53.46"></a><span id="l53.46"> </span>
<a href="#l53.47"></a><span id="l53.47">   nameString-&gt;SetData(name);</span>
<a href="#l53.48"></a><span id="l53.48">   generic-&gt;SetData(&quot;name&quot;, nameString);</span>
<a href="#l53.49"></a><span id="l53.49"> </span>
<a href="#l53.50"></a><span id="l53.50">   return CallQueryInterface(generic, aInterface);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/mailnews/import/becky/src/nsBeckyMail.cpp</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/mailnews/import/becky/src/nsBeckyMail.cpp</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -609,17 +609,17 @@ nsBeckyMail::ImportMailbox(nsIImportMail</span>
<a href="#l54.4"></a><span id="l54.4">   mReadBytes = finalSize;</span>
<a href="#l54.5"></a><span id="l54.5"> </span>
<a href="#l54.6"></a><span id="l54.6">   nsAutoString name;</span>
<a href="#l54.7"></a><span id="l54.7">   aSource-&gt;GetDisplayName(getter_Copies(name));</span>
<a href="#l54.8"></a><span id="l54.8"> </span>
<a href="#l54.9"></a><span id="l54.9">   nsAutoString successMessage;</span>
<a href="#l54.10"></a><span id="l54.10">   const char16_t *format = { name.get() };</span>
<a href="#l54.11"></a><span id="l54.11">   rv =</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-      nsBeckyStringBundle::FormatStringFromName(MOZ_UTF16(&quot;BeckyImportMailboxSuccess&quot;),</span>
<a href="#l54.13"></a><span id="l54.13" class="difflineplus">+      nsBeckyStringBundle::FormatStringFromName(u&quot;BeckyImportMailboxSuccess&quot;,</span>
<a href="#l54.14"></a><span id="l54.14">                                                 &amp;format,</span>
<a href="#l54.15"></a><span id="l54.15">                                                 1,</span>
<a href="#l54.16"></a><span id="l54.16">                                                 getter_Copies(successMessage));</span>
<a href="#l54.17"></a><span id="l54.17">   successMessage.AppendLiteral(&quot;\n&quot;);</span>
<a href="#l54.18"></a><span id="l54.18">   *aSuccessLog = ToNewUnicode(successMessage);</span>
<a href="#l54.19"></a><span id="l54.19"> </span>
<a href="#l54.20"></a><span id="l54.20">   return rv;</span>
<a href="#l54.21"></a><span id="l54.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/mailnews/import/becky/src/nsBeckySettings.cpp</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/mailnews/import/becky/src/nsBeckySettings.cpp</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -50,17 +50,17 @@ nsBeckySettings::AutoLocate(char16_t **a</span>
<a href="#l55.4"></a><span id="l55.4">                             nsIFile **aLocation,</span>
<a href="#l55.5"></a><span id="l55.5">                             bool *_retval)</span>
<a href="#l55.6"></a><span id="l55.6"> {</span>
<a href="#l55.7"></a><span id="l55.7">   NS_ENSURE_ARG_POINTER(aDescription);</span>
<a href="#l55.8"></a><span id="l55.8">   NS_ENSURE_ARG_POINTER(aLocation);</span>
<a href="#l55.9"></a><span id="l55.9">   NS_ENSURE_ARG_POINTER(_retval);</span>
<a href="#l55.10"></a><span id="l55.10"> </span>
<a href="#l55.11"></a><span id="l55.11">   *aDescription =</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-    nsBeckyStringBundle::GetStringByName(MOZ_UTF16(&quot;BeckyImportName&quot;));</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineplus">+    nsBeckyStringBundle::GetStringByName(u&quot;BeckyImportName&quot;);</span>
<a href="#l55.14"></a><span id="l55.14">   *aLocation = nullptr;</span>
<a href="#l55.15"></a><span id="l55.15">   *_retval = false;</span>
<a href="#l55.16"></a><span id="l55.16"> </span>
<a href="#l55.17"></a><span id="l55.17">   nsCOMPtr&lt;nsIFile&gt; location;</span>
<a href="#l55.18"></a><span id="l55.18">   nsresult rv = nsBeckyUtils::GetDefaultMailboxINIFile(getter_AddRefs(location));</span>
<a href="#l55.19"></a><span id="l55.19">   if (NS_FAILED(rv))</span>
<a href="#l55.20"></a><span id="l55.20">     location = do_CreateInstance(NS_LOCAL_FILE_CONTRACTID, &amp;rv);</span>
<a href="#l55.21"></a><span id="l55.21">   else</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/mailnews/import/outlook/src/nsOutlookCompose.cpp</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/mailnews/import/outlook/src/nsOutlookCompose.cpp</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -174,23 +174,23 @@ nsresult OutlookSendListener::CreateSend</span>
<a href="#l56.4"></a><span id="l56.4"> }</span>
<a href="#l56.5"></a><span id="l56.5"> </span>
<a href="#l56.6"></a><span id="l56.6"> /////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l56.7"></a><span id="l56.7"> /////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l56.8"></a><span id="l56.8"> /////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l56.9"></a><span id="l56.9"> /////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l56.10"></a><span id="l56.10"> </span>
<a href="#l56.11"></a><span id="l56.11"> #define hackBeginA &quot;begin&quot;</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-#define hackBeginW MOZ_UTF16(hackBeginA)</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineplus">+#define hackBeginW u&quot;begin&quot;</span>
<a href="#l56.14"></a><span id="l56.14"> #define hackEndA &quot;\015\012end&quot;</span>
<a href="#l56.15"></a><span id="l56.15" class="difflineminus">-#define hackEndW MOZ_UTF16(hackEndA)</span>
<a href="#l56.16"></a><span id="l56.16" class="difflineplus">+#define hackEndW u&quot;\015\012end&quot;</span>
<a href="#l56.17"></a><span id="l56.17"> #define hackCRLFA &quot;crlf&quot;</span>
<a href="#l56.18"></a><span id="l56.18" class="difflineminus">-#define hackCRLFW MOZ_UTF16(hackCRLFA)</span>
<a href="#l56.19"></a><span id="l56.19" class="difflineplus">+#define hackCRLFW u&quot;crlf&quot;</span>
<a href="#l56.20"></a><span id="l56.20"> #define hackAmpersandA &quot;amp&quot;</span>
<a href="#l56.21"></a><span id="l56.21" class="difflineminus">-#define hackAmpersandW MOZ_UTF16(hackAmpersandA)</span>
<a href="#l56.22"></a><span id="l56.22" class="difflineplus">+#define hackAmpersandW u&quot;amp&quot;</span>
<a href="#l56.23"></a><span id="l56.23"> </span>
<a href="#l56.24"></a><span id="l56.24"> nsOutlookCompose::nsOutlookCompose()</span>
<a href="#l56.25"></a><span id="l56.25"> {</span>
<a href="#l56.26"></a><span id="l56.26">   m_pListener = nullptr;</span>
<a href="#l56.27"></a><span id="l56.27">   m_pMsgFields = nullptr;</span>
<a href="#l56.28"></a><span id="l56.28"> </span>
<a href="#l56.29"></a><span id="l56.29">   m_optimizationBufferSize = 16*1024;</span>
<a href="#l56.30"></a><span id="l56.30">   m_optimizationBuffer = new char[m_optimizationBufferSize];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/mailnews/import/src/nsImportMail.cpp</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/mailnews/import/src/nsImportMail.cpp</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -902,22 +902,22 @@ bool nsImportGenericMail::CreateFolder(n</span>
<a href="#l57.4"></a><span id="l57.4">   if (!bundleService)</span>
<a href="#l57.5"></a><span id="l57.5">       return false;</span>
<a href="#l57.6"></a><span id="l57.6">   rv = bundleService-&gt;CreateBundle(IMPORT_MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l57.7"></a><span id="l57.7">   if (NS_FAILED(rv))</span>
<a href="#l57.8"></a><span id="l57.8">       return false;</span>
<a href="#l57.9"></a><span id="l57.9">   nsString folderName;</span>
<a href="#l57.10"></a><span id="l57.10">   if (!m_pName.IsEmpty()) {</span>
<a href="#l57.11"></a><span id="l57.11">     const char16_t *moduleName[] = { m_pName.get() };</span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-    rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;ImportModuleFolderName&quot;),</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineplus">+    rv = bundle-&gt;FormatStringFromName(u&quot;ImportModuleFolderName&quot;,</span>
<a href="#l57.14"></a><span id="l57.14">                                       moduleName, 1,</span>
<a href="#l57.15"></a><span id="l57.15">                                       getter_Copies(folderName));</span>
<a href="#l57.16"></a><span id="l57.16">   }</span>
<a href="#l57.17"></a><span id="l57.17">   else {</span>
<a href="#l57.18"></a><span id="l57.18" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;DefaultFolderName&quot;),</span>
<a href="#l57.19"></a><span id="l57.19" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(u&quot;DefaultFolderName&quot;,</span>
<a href="#l57.20"></a><span id="l57.20">                                    getter_Copies(folderName));</span>
<a href="#l57.21"></a><span id="l57.21">   }</span>
<a href="#l57.22"></a><span id="l57.22">   if (NS_FAILED(rv)) {</span>
<a href="#l57.23"></a><span id="l57.23">       IMPORT_LOG0(&quot;*** Failed to get Folder Name!\n&quot;);</span>
<a href="#l57.24"></a><span id="l57.24">       return false;</span>
<a href="#l57.25"></a><span id="l57.25">   }</span>
<a href="#l57.26"></a><span id="l57.26">   nsCOMPtr &lt;nsIMsgAccountManager&gt; accMgr = do_GetService(NS_MSGACCOUNTMANAGER_CONTRACTID, &amp;rv);</span>
<a href="#l57.27"></a><span id="l57.27">   if (NS_FAILED(rv)) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/mailnews/intl/nsCharsetConverterManager.cpp</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/mailnews/intl/nsCharsetConverterManager.cpp</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -106,17 +106,17 @@ nsresult GetCharsetDataImpl(const char *</span>
<a href="#l58.4"></a><span id="l58.4"> }</span>
<a href="#l58.5"></a><span id="l58.5"> </span>
<a href="#l58.6"></a><span id="l58.6"> //static</span>
<a href="#l58.7"></a><span id="l58.7"> bool nsCharsetConverterManager::IsInternal(const nsACString&amp; aCharset)</span>
<a href="#l58.8"></a><span id="l58.8"> {</span>
<a href="#l58.9"></a><span id="l58.9">   nsAutoString str;</span>
<a href="#l58.10"></a><span id="l58.10">   // fully qualify to possibly avoid vtable call</span>
<a href="#l58.11"></a><span id="l58.11">   nsresult rv = GetCharsetDataImpl(PromiseFlatCString(aCharset).get(),</span>
<a href="#l58.12"></a><span id="l58.12" class="difflineminus">-                                   MOZ_UTF16(&quot;.isInternal&quot;),</span>
<a href="#l58.13"></a><span id="l58.13" class="difflineplus">+                                   u&quot;.isInternal&quot;,</span>
<a href="#l58.14"></a><span id="l58.14">                                    str);</span>
<a href="#l58.15"></a><span id="l58.15"> </span>
<a href="#l58.16"></a><span id="l58.16">   return NS_SUCCEEDED(rv);</span>
<a href="#l58.17"></a><span id="l58.17"> }</span>
<a href="#l58.18"></a><span id="l58.18"> </span>
<a href="#l58.19"></a><span id="l58.19"> </span>
<a href="#l58.20"></a><span id="l58.20"> //----------------------------------------------------------------------------//----------------------------------------------------------------------------</span>
<a href="#l58.21"></a><span id="l58.21"> // Interface nsICharsetConverterManager [implementation]</span>
<a href="#l58.22"></a><span id="l58.22" class="difflineat">@@ -340,17 +340,17 @@ NS_IMETHODIMP</span>
<a href="#l58.23"></a><span id="l58.23"> nsCharsetConverterManager::GetCharsetLangGroupRaw(const char * aCharset, </span>
<a href="#l58.24"></a><span id="l58.24">                                                   nsIAtom** aResult)</span>
<a href="#l58.25"></a><span id="l58.25"> {</span>
<a href="#l58.26"></a><span id="l58.26"> </span>
<a href="#l58.27"></a><span id="l58.27">   *aResult = nullptr;</span>
<a href="#l58.28"></a><span id="l58.28">   nsAutoString langGroup;</span>
<a href="#l58.29"></a><span id="l58.29">   // fully qualify to possibly avoid vtable call</span>
<a href="#l58.30"></a><span id="l58.30">   nsresult rv = nsCharsetConverterManager::GetCharsetData(</span>
<a href="#l58.31"></a><span id="l58.31" class="difflineminus">-      aCharset, MOZ_UTF16(&quot;.LangGroup&quot;), langGroup);</span>
<a href="#l58.32"></a><span id="l58.32" class="difflineplus">+      aCharset, u&quot;.LangGroup&quot;, langGroup);</span>
<a href="#l58.33"></a><span id="l58.33"> </span>
<a href="#l58.34"></a><span id="l58.34">   if (NS_SUCCEEDED(rv)) {</span>
<a href="#l58.35"></a><span id="l58.35">     ToLowerCase(langGroup); // use lowercase for all language atoms</span>
<a href="#l58.36"></a><span id="l58.36">     *aResult = NS_Atomize(langGroup).take();</span>
<a href="#l58.37"></a><span id="l58.37">   }</span>
<a href="#l58.38"></a><span id="l58.38"> </span>
<a href="#l58.39"></a><span id="l58.39">   return rv;</span>
<a href="#l58.40"></a><span id="l58.40"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/mailnews/local/src/nsLocalMailFolder.cpp</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/mailnews/local/src/nsLocalMailFolder.cpp</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -839,29 +839,29 @@ nsresult nsMsgLocalMailFolder::ConfirmFo</span>
<a href="#l59.4"></a><span id="l59.4"> </span>
<a href="#l59.5"></a><span id="l59.5">       nsAutoString folderName;</span>
<a href="#l59.6"></a><span id="l59.6">       rv = aFolder-&gt;GetName(folderName);</span>
<a href="#l59.7"></a><span id="l59.7">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l59.8"></a><span id="l59.8">       const char16_t *formatStrings[1] = { folderName.get() };</span>
<a href="#l59.9"></a><span id="l59.9"> </span>
<a href="#l59.10"></a><span id="l59.10">       nsAutoString deleteFolderDialogTitle;</span>
<a href="#l59.11"></a><span id="l59.11">       rv = bundle-&gt;GetStringFromName(</span>
<a href="#l59.12"></a><span id="l59.12" class="difflineminus">-        MOZ_UTF16(&quot;pop3DeleteFolderDialogTitle&quot;),</span>
<a href="#l59.13"></a><span id="l59.13" class="difflineplus">+        u&quot;pop3DeleteFolderDialogTitle&quot;,</span>
<a href="#l59.14"></a><span id="l59.14">         getter_Copies(deleteFolderDialogTitle));</span>
<a href="#l59.15"></a><span id="l59.15">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l59.16"></a><span id="l59.16"> </span>
<a href="#l59.17"></a><span id="l59.17">       nsAutoString deleteFolderButtonLabel;</span>
<a href="#l59.18"></a><span id="l59.18">       rv = bundle-&gt;GetStringFromName(</span>
<a href="#l59.19"></a><span id="l59.19" class="difflineminus">-        MOZ_UTF16(&quot;pop3DeleteFolderButtonLabel&quot;),</span>
<a href="#l59.20"></a><span id="l59.20" class="difflineplus">+        u&quot;pop3DeleteFolderButtonLabel&quot;,</span>
<a href="#l59.21"></a><span id="l59.21">         getter_Copies(deleteFolderButtonLabel));</span>
<a href="#l59.22"></a><span id="l59.22">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l59.23"></a><span id="l59.23"> </span>
<a href="#l59.24"></a><span id="l59.24">       nsAutoString confirmationStr;</span>
<a href="#l59.25"></a><span id="l59.25">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l59.26"></a><span id="l59.26" class="difflineminus">-        MOZ_UTF16(&quot;pop3MoveFolderToTrash&quot;), formatStrings, 1,</span>
<a href="#l59.27"></a><span id="l59.27" class="difflineplus">+        u&quot;pop3MoveFolderToTrash&quot;, formatStrings, 1,</span>
<a href="#l59.28"></a><span id="l59.28">         getter_Copies(confirmationStr));</span>
<a href="#l59.29"></a><span id="l59.29">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l59.30"></a><span id="l59.30"> </span>
<a href="#l59.31"></a><span id="l59.31">       nsCOMPtr&lt;nsIPrompt&gt; dialog(do_GetInterface(docShell));</span>
<a href="#l59.32"></a><span id="l59.32">       if (dialog)</span>
<a href="#l59.33"></a><span id="l59.33">       {</span>
<a href="#l59.34"></a><span id="l59.34">         int32_t buttonPressed = 0;</span>
<a href="#l59.35"></a><span id="l59.35">         // Default the dialog to &quot;cancel&quot;.</span>
<a href="#l59.36"></a><span id="l59.36" class="difflineat">@@ -3311,18 +3311,18 @@ nsresult nsMsgLocalMailFolder::DisplayMo</span>
<a href="#l59.37"></a><span id="l59.37">       numMsgSoFarString.AppendInt((mCopyState-&gt;m_copyingMultipleMessages) ? mCopyState-&gt;m_curCopyIndex : 1);</span>
<a href="#l59.38"></a><span id="l59.38"> </span>
<a href="#l59.39"></a><span id="l59.39">       nsAutoString totalMessagesString;</span>
<a href="#l59.40"></a><span id="l59.40">       totalMessagesString.AppendInt(mCopyState-&gt;m_totalMsgCount);</span>
<a href="#l59.41"></a><span id="l59.41">       nsString finalString;</span>
<a href="#l59.42"></a><span id="l59.42">       const char16_t * stringArray[] = { numMsgSoFarString.get(), totalMessagesString.get(), folderName.get() };</span>
<a href="#l59.43"></a><span id="l59.43">       rv = mCopyState-&gt;m_stringBundle-&gt;FormatStringFromName(</span>
<a href="#l59.44"></a><span id="l59.44">         (mCopyState-&gt;m_isMove) ?</span>
<a href="#l59.45"></a><span id="l59.45" class="difflineminus">-        MOZ_UTF16(&quot;movingMessagesStatus&quot;) :</span>
<a href="#l59.46"></a><span id="l59.46" class="difflineminus">-        MOZ_UTF16(&quot;copyingMessagesStatus&quot;),</span>
<a href="#l59.47"></a><span id="l59.47" class="difflineplus">+        u&quot;movingMessagesStatus&quot; :</span>
<a href="#l59.48"></a><span id="l59.48" class="difflineplus">+        u&quot;copyingMessagesStatus&quot;,</span>
<a href="#l59.49"></a><span id="l59.49">         stringArray, 3, getter_Copies(finalString));</span>
<a href="#l59.50"></a><span id="l59.50">       int64_t nowMS = PR_IntervalToMilliseconds(PR_IntervalNow());</span>
<a href="#l59.51"></a><span id="l59.51"> </span>
<a href="#l59.52"></a><span id="l59.52">       // only update status/progress every half second</span>
<a href="#l59.53"></a><span id="l59.53">       if (nowMS - mCopyState-&gt;m_lastProgressTime &lt; 500 &amp;&amp;</span>
<a href="#l59.54"></a><span id="l59.54">           mCopyState-&gt;m_curCopyIndex &lt; mCopyState-&gt;m_totalMsgCount)</span>
<a href="#l59.55"></a><span id="l59.55">         return NS_OK;</span>
<a href="#l59.56"></a><span id="l59.56"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1" class="difflineminus">--- a/mailnews/local/src/nsPop3Protocol.cpp</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineplus">+++ b/mailnews/local/src/nsPop3Protocol.cpp</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineat">@@ -855,29 +855,29 @@ NS_IMETHODIMP nsPop3Protocol::OnPromptSt</span>
<a href="#l60.4"></a><span id="l60.4">           // As we're async, calling ProcessProtocolState gets things going</span>
<a href="#l60.5"></a><span id="l60.5">           // again.</span>
<a href="#l60.6"></a><span id="l60.6">           ProcessProtocolState(nullptr, nullptr, 0, 0);</span>
<a href="#l60.7"></a><span id="l60.7">           return NS_OK;</span>
<a href="#l60.8"></a><span id="l60.8">         }</span>
<a href="#l60.9"></a><span id="l60.9">       }</span>
<a href="#l60.10"></a><span id="l60.10">     }</span>
<a href="#l60.11"></a><span id="l60.11">     mLocalBundle-&gt;FormatStringFromName(</span>
<a href="#l60.12"></a><span id="l60.12" class="difflineminus">-      MOZ_UTF16(&quot;pop3PreviouslyEnteredPasswordIsInvalidPrompt&quot;),</span>
<a href="#l60.13"></a><span id="l60.13" class="difflineplus">+      u&quot;pop3PreviouslyEnteredPasswordIsInvalidPrompt&quot;,</span>
<a href="#l60.14"></a><span id="l60.14">       passwordParams, 2, getter_Copies(passwordPrompt));</span>
<a href="#l60.15"></a><span id="l60.15">   }</span>
<a href="#l60.16"></a><span id="l60.16">   else</span>
<a href="#l60.17"></a><span id="l60.17">     // Otherwise this is the first time we've asked about the server's</span>
<a href="#l60.18"></a><span id="l60.18">     // password so show a first time prompt.</span>
<a href="#l60.19"></a><span id="l60.19">     mLocalBundle-&gt;FormatStringFromName(</span>
<a href="#l60.20"></a><span id="l60.20" class="difflineminus">-      MOZ_UTF16(&quot;pop3EnterPasswordPrompt&quot;),</span>
<a href="#l60.21"></a><span id="l60.21" class="difflineplus">+      u&quot;pop3EnterPasswordPrompt&quot;,</span>
<a href="#l60.22"></a><span id="l60.22">       passwordParams, 2, getter_Copies(passwordPrompt));</span>
<a href="#l60.23"></a><span id="l60.23"> </span>
<a href="#l60.24"></a><span id="l60.24">   nsString passwordTitle;</span>
<a href="#l60.25"></a><span id="l60.25">   mLocalBundle-&gt;GetStringFromName(</span>
<a href="#l60.26"></a><span id="l60.26" class="difflineminus">-    MOZ_UTF16(&quot;pop3EnterPasswordPromptTitle&quot;),</span>
<a href="#l60.27"></a><span id="l60.27" class="difflineplus">+    u&quot;pop3EnterPasswordPromptTitle&quot;,</span>
<a href="#l60.28"></a><span id="l60.28">     getter_Copies(passwordTitle));</span>
<a href="#l60.29"></a><span id="l60.29"> </span>
<a href="#l60.30"></a><span id="l60.30">   // Now go and get the password.</span>
<a href="#l60.31"></a><span id="l60.31">   if (!passwordPrompt.IsEmpty() &amp;&amp; !passwordTitle.IsEmpty())</span>
<a href="#l60.32"></a><span id="l60.32">     rv = server-&gt;GetPasswordWithUI(passwordPrompt, passwordTitle,</span>
<a href="#l60.33"></a><span id="l60.33">                                     msgWindow, passwordResult);</span>
<a href="#l60.34"></a><span id="l60.34">   ClearFlag(POP3_PASSWORD_FAILED|POP3_AUTH_FAILURE);</span>
<a href="#l60.35"></a><span id="l60.35"> </span>
<a href="#l60.36"></a><span id="l60.36" class="difflineat">@@ -1263,17 +1263,17 @@ nsPop3Protocol::Error(const char* err_co</span>
<a href="#l60.37"></a><span id="l60.37">     // so print out that error message!</span>
<a href="#l60.38"></a><span id="l60.38">     nsCOMPtr&lt;nsIMsgIncomingServer&gt; server = do_QueryInterface(m_pop3Server);</span>
<a href="#l60.39"></a><span id="l60.39">     nsString accountName;</span>
<a href="#l60.40"></a><span id="l60.40">     nsresult rv = server-&gt;GetPrettyName(accountName);</span>
<a href="#l60.41"></a><span id="l60.41">     NS_ENSURE_SUCCESS(rv, -1);</span>
<a href="#l60.42"></a><span id="l60.42">     const char16_t *titleParams[] = { accountName.get() };</span>
<a href="#l60.43"></a><span id="l60.43">     nsString dialogTitle;</span>
<a href="#l60.44"></a><span id="l60.44">     mLocalBundle-&gt;FormatStringFromName(</span>
<a href="#l60.45"></a><span id="l60.45" class="difflineminus">-      MOZ_UTF16(&quot;pop3ErrorDialogTitle&quot;),</span>
<a href="#l60.46"></a><span id="l60.46" class="difflineplus">+      u&quot;pop3ErrorDialogTitle&quot;,</span>
<a href="#l60.47"></a><span id="l60.47">       titleParams, 1, getter_Copies(dialogTitle));</span>
<a href="#l60.48"></a><span id="l60.48">     nsCOMPtr&lt;nsIMsgMailNewsUrl&gt; mailnewsUrl = do_QueryInterface(m_url, &amp;rv);</span>
<a href="#l60.49"></a><span id="l60.49">     // we handle &quot;pop3TmpDownloadError&quot; earlier...</span>
<a href="#l60.50"></a><span id="l60.50">     if (strcmp(err_code, &quot;pop3TmpDownloadError&quot;) &amp;&amp; NS_SUCCEEDED(rv))</span>
<a href="#l60.51"></a><span id="l60.51">     {</span>
<a href="#l60.52"></a><span id="l60.52">         nsCOMPtr&lt;nsIMsgWindow&gt; msgWindow;</span>
<a href="#l60.53"></a><span id="l60.53">         nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l60.54"></a><span id="l60.54">         rv = mailnewsUrl-&gt;GetMsgWindow(getter_AddRefs(msgWindow)); //it is ok to have null msgWindow, for example when biffing</span>
<a href="#l60.55"></a><span id="l60.55" class="difflineat">@@ -1301,17 +1301,17 @@ nsPop3Protocol::Error(const char* err_co</span>
<a href="#l60.56"></a><span id="l60.56">                 if (server)</span>
<a href="#l60.57"></a><span id="l60.57">                   rv = server-&gt;GetRealHostName(hostName);</span>
<a href="#l60.58"></a><span id="l60.58">                 if (NS_SUCCEEDED(rv))</span>
<a href="#l60.59"></a><span id="l60.59">                 {</span>
<a href="#l60.60"></a><span id="l60.60">                   nsAutoString hostStr;</span>
<a href="#l60.61"></a><span id="l60.61">                   CopyASCIItoUTF16(hostName, hostStr);</span>
<a href="#l60.62"></a><span id="l60.62">                   const char16_t *params[] = { hostStr.get() };</span>
<a href="#l60.63"></a><span id="l60.63">                   mLocalBundle-&gt;FormatStringFromName(</span>
<a href="#l60.64"></a><span id="l60.64" class="difflineminus">-                    MOZ_UTF16(&quot;pop3ServerSaid&quot;),</span>
<a href="#l60.65"></a><span id="l60.65" class="difflineplus">+                    u&quot;pop3ServerSaid&quot;,</span>
<a href="#l60.66"></a><span id="l60.66">                     params, 1, getter_Copies(serverSaidPrefix));</span>
<a href="#l60.67"></a><span id="l60.67">                 }</span>
<a href="#l60.68"></a><span id="l60.68"> </span>
<a href="#l60.69"></a><span id="l60.69">                 nsAutoString message(alertString);</span>
<a href="#l60.70"></a><span id="l60.70">                 message.AppendLiteral(&quot; &quot;);</span>
<a href="#l60.71"></a><span id="l60.71">                 message.Append(serverSaidPrefix);</span>
<a href="#l60.72"></a><span id="l60.72">                 message.AppendLiteral(&quot; &quot;);</span>
<a href="#l60.73"></a><span id="l60.73">                 message.Append(NS_ConvertASCIItoUTF16(m_commandResponse));</span>
<a href="#l60.74"></a><span id="l60.74" class="difflineat">@@ -3448,17 +3448,17 @@ nsPop3Protocol::TopResponse(nsIInputStre</span>
<a href="#l60.75"></a><span id="l60.75">   So just go download the whole thing, and warn the user.</span>
<a href="#l60.76"></a><span id="l60.76"> </span>
<a href="#l60.77"></a><span id="l60.77">     Note that the progress bar will not be accurate in this case.</span>
<a href="#l60.78"></a><span id="l60.78">     Oops. #### */</span>
<a href="#l60.79"></a><span id="l60.79">     m_pop3ConData-&gt;truncating_cur_msg = false;</span>
<a href="#l60.80"></a><span id="l60.80"> </span>
<a href="#l60.81"></a><span id="l60.81">     nsString statusTemplate;</span>
<a href="#l60.82"></a><span id="l60.82">     mLocalBundle-&gt;GetStringFromName(</span>
<a href="#l60.83"></a><span id="l60.83" class="difflineminus">-      MOZ_UTF16(&quot;pop3ServerDoesNotSupportTopCommand&quot;),</span>
<a href="#l60.84"></a><span id="l60.84" class="difflineplus">+      u&quot;pop3ServerDoesNotSupportTopCommand&quot;,</span>
<a href="#l60.85"></a><span id="l60.85">       getter_Copies(statusTemplate));</span>
<a href="#l60.86"></a><span id="l60.86">     if (!statusTemplate.IsEmpty())</span>
<a href="#l60.87"></a><span id="l60.87">     {</span>
<a href="#l60.88"></a><span id="l60.88">       nsAutoCString hostName;</span>
<a href="#l60.89"></a><span id="l60.89">       char16_t * statusString = nullptr;</span>
<a href="#l60.90"></a><span id="l60.90">       m_url-&gt;GetHost(hostName);</span>
<a href="#l60.91"></a><span id="l60.91"> </span>
<a href="#l60.92"></a><span id="l60.92">       statusString = nsTextFormatter::smprintf(statusTemplate.get(), hostName.get());</span>
<a href="#l60.93"></a><span id="l60.93" class="difflineat">@@ -3826,17 +3826,17 @@ nsresult nsPop3Protocol::ProcessProtocol</span>
<a href="#l60.94"></a><span id="l60.94">       status = AuthNtlmResponse();</span>
<a href="#l60.95"></a><span id="l60.95">       break;</span>
<a href="#l60.96"></a><span id="l60.96"> </span>
<a href="#l60.97"></a><span id="l60.97">     case POP3_AUTH_GSSAPI:</span>
<a href="#l60.98"></a><span id="l60.98">       status = AuthGSSAPI();</span>
<a href="#l60.99"></a><span id="l60.99">       break;</span>
<a href="#l60.100"></a><span id="l60.100"> </span>
<a href="#l60.101"></a><span id="l60.101">     case POP3_AUTH_GSSAPI_FIRST:</span>
<a href="#l60.102"></a><span id="l60.102" class="difflineminus">-      UpdateStatus(MOZ_UTF16(&quot;hostContact&quot;));</span>
<a href="#l60.103"></a><span id="l60.103" class="difflineplus">+      UpdateStatus(u&quot;hostContact&quot;);</span>
<a href="#l60.104"></a><span id="l60.104">       status = AuthGSSAPIResponse(true);</span>
<a href="#l60.105"></a><span id="l60.105">       break;</span>
<a href="#l60.106"></a><span id="l60.106"> </span>
<a href="#l60.107"></a><span id="l60.107">     case POP3_AUTH_GSSAPI_STEP:</span>
<a href="#l60.108"></a><span id="l60.108">       status = AuthGSSAPIResponse(false);</span>
<a href="#l60.109"></a><span id="l60.109">       break;</span>
<a href="#l60.110"></a><span id="l60.110"> </span>
<a href="#l60.111"></a><span id="l60.111">     case POP3_SEND_USERNAME:</span>
<a href="#l60.112"></a><span id="l60.112" class="difflineat">@@ -3844,17 +3844,17 @@ nsresult nsPop3Protocol::ProcessProtocol</span>
<a href="#l60.113"></a><span id="l60.113">         status = -1;</span>
<a href="#l60.114"></a><span id="l60.114">       break;</span>
<a href="#l60.115"></a><span id="l60.115"> </span>
<a href="#l60.116"></a><span id="l60.116">     case POP3_OBTAIN_PASSWORD_BEFORE_USERNAME:</span>
<a href="#l60.117"></a><span id="l60.117">       status = -1;</span>
<a href="#l60.118"></a><span id="l60.118">       break;</span>
<a href="#l60.119"></a><span id="l60.119"> </span>
<a href="#l60.120"></a><span id="l60.120">     case POP3_FINISH_OBTAIN_PASSWORD_BEFORE_USERNAME:</span>
<a href="#l60.121"></a><span id="l60.121" class="difflineminus">-      UpdateStatus(MOZ_UTF16(&quot;hostContact&quot;));</span>
<a href="#l60.122"></a><span id="l60.122" class="difflineplus">+      UpdateStatus(u&quot;hostContact&quot;);</span>
<a href="#l60.123"></a><span id="l60.123">       status = SendUsername();</span>
<a href="#l60.124"></a><span id="l60.124">       break;</span>
<a href="#l60.125"></a><span id="l60.125"> </span>
<a href="#l60.126"></a><span id="l60.126">     case POP3_SEND_PASSWORD:</span>
<a href="#l60.127"></a><span id="l60.127">       if (NS_FAILED(StartGetAsyncPassword(POP3_OBTAIN_PASSWORD_BEFORE_PASSWORD)))</span>
<a href="#l60.128"></a><span id="l60.128">         status = -1;</span>
<a href="#l60.129"></a><span id="l60.129">       break;</span>
<a href="#l60.130"></a><span id="l60.130"> </span>
<a href="#l60.131"></a><span id="l60.131" class="difflineat">@@ -3952,17 +3952,17 @@ nsresult nsPop3Protocol::ProcessProtocol</span>
<a href="#l60.132"></a><span id="l60.132">         bug 54116), so instead we put the &quot;no new messages&quot; or</span>
<a href="#l60.133"></a><span id="l60.133">         &quot;retrieved x new messages&quot;</span>
<a href="#l60.134"></a><span id="l60.134">         in the status line.  Unfortunately, this tends to be running</span>
<a href="#l60.135"></a><span id="l60.135">         in a progress pane, so we try to get the real pane and</span>
<a href="#l60.136"></a><span id="l60.136">           show the message there. */</span>
<a href="#l60.137"></a><span id="l60.137"> </span>
<a href="#l60.138"></a><span id="l60.138">           if (m_totalDownloadSize &lt;= 0)</span>
<a href="#l60.139"></a><span id="l60.139">           {</span>
<a href="#l60.140"></a><span id="l60.140" class="difflineminus">-            UpdateStatus(MOZ_UTF16(&quot;noNewMessages&quot;));</span>
<a href="#l60.141"></a><span id="l60.141" class="difflineplus">+            UpdateStatus(u&quot;noNewMessages&quot;);</span>
<a href="#l60.142"></a><span id="l60.142">             /* There are no new messages.  */</span>
<a href="#l60.143"></a><span id="l60.143">           }</span>
<a href="#l60.144"></a><span id="l60.144">           else</span>
<a href="#l60.145"></a><span id="l60.145">           {</span>
<a href="#l60.146"></a><span id="l60.146">             nsString statusString;</span>
<a href="#l60.147"></a><span id="l60.147">             nsresult rv = FormatCounterString(NS_LITERAL_STRING(&quot;receivedMsgs&quot;),</span>
<a href="#l60.148"></a><span id="l60.148">                                               m_pop3ConData-&gt;real_new_counter - 1,</span>
<a href="#l60.149"></a><span id="l60.149">                                               m_pop3ConData-&gt;really_new_messages,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1" class="difflineminus">--- a/mailnews/local/src/nsPop3Service.cpp</span>
<a href="#l61.2"></a><span id="l61.2" class="difflineplus">+++ b/mailnews/local/src/nsPop3Service.cpp</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineat">@@ -461,20 +461,20 @@ void nsPop3Service::AlertServerBusy(nsIM</span>
<a href="#l61.4"></a><span id="l61.4">   NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l61.5"></a><span id="l61.5">   rv = server-&gt;GetPrettyName(accountName);</span>
<a href="#l61.6"></a><span id="l61.6">   NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l61.7"></a><span id="l61.7"> </span>
<a href="#l61.8"></a><span id="l61.8">   const char16_t *params[] = { accountName.get() };</span>
<a href="#l61.9"></a><span id="l61.9">   nsString alertString;</span>
<a href="#l61.10"></a><span id="l61.10">   nsString dialogTitle;</span>
<a href="#l61.11"></a><span id="l61.11">   bundle-&gt;FormatStringFromName(</span>
<a href="#l61.12"></a><span id="l61.12" class="difflineminus">-    MOZ_UTF16(&quot;pop3ServerBusy&quot;),</span>
<a href="#l61.13"></a><span id="l61.13" class="difflineplus">+    u&quot;pop3ServerBusy&quot;,</span>
<a href="#l61.14"></a><span id="l61.14">     params, 1, getter_Copies(alertString));</span>
<a href="#l61.15"></a><span id="l61.15">   bundle-&gt;FormatStringFromName(</span>
<a href="#l61.16"></a><span id="l61.16" class="difflineminus">-    MOZ_UTF16(&quot;pop3ErrorDialogTitle&quot;),</span>
<a href="#l61.17"></a><span id="l61.17" class="difflineplus">+    u&quot;pop3ErrorDialogTitle&quot;,</span>
<a href="#l61.18"></a><span id="l61.18">     params, 1, getter_Copies(dialogTitle));</span>
<a href="#l61.19"></a><span id="l61.19">   if (!alertString.IsEmpty())</span>
<a href="#l61.20"></a><span id="l61.20">     dialog-&gt;Alert(dialogTitle.get(), alertString.get());</span>
<a href="#l61.21"></a><span id="l61.21"> }</span>
<a href="#l61.22"></a><span id="l61.22"> </span>
<a href="#l61.23"></a><span id="l61.23"> NS_IMETHODIMP nsPop3Service::NewChannel(nsIURI *aURI, nsIChannel **_retval)</span>
<a href="#l61.24"></a><span id="l61.24"> {</span>
<a href="#l61.25"></a><span id="l61.25">   return NewChannel2(aURI, nullptr, _retval);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1" class="difflineminus">--- a/mailnews/local/src/nsPop3Sink.cpp</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineplus">+++ b/mailnews/local/src/nsPop3Sink.cpp</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineat">@@ -685,17 +685,17 @@ nsresult nsPop3Sink::HandleTempDownloadF</span>
<a href="#l62.4"></a><span id="l62.4">   rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/localMsgs.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l62.5"></a><span id="l62.5">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l62.6"></a><span id="l62.6">   nsString fromStr, subjectStr, confirmString;</span>
<a href="#l62.7"></a><span id="l62.7"> </span>
<a href="#l62.8"></a><span id="l62.8">   m_newMailParser-&gt;m_newMsgHdr-&gt;GetMime2DecodedSubject(subjectStr);</span>
<a href="#l62.9"></a><span id="l62.9">   m_newMailParser-&gt;m_newMsgHdr-&gt;GetMime2DecodedAuthor(fromStr);</span>
<a href="#l62.10"></a><span id="l62.10">   const char16_t *params[] = { fromStr.get(), subjectStr.get() };</span>
<a href="#l62.11"></a><span id="l62.11">   bundle-&gt;FormatStringFromName(</span>
<a href="#l62.12"></a><span id="l62.12" class="difflineminus">-    MOZ_UTF16(&quot;pop3TmpDownloadError&quot;),</span>
<a href="#l62.13"></a><span id="l62.13" class="difflineplus">+    u&quot;pop3TmpDownloadError&quot;,</span>
<a href="#l62.14"></a><span id="l62.14">     params, 2, getter_Copies(confirmString));</span>
<a href="#l62.15"></a><span id="l62.15">   nsCOMPtr&lt;mozIDOMWindowProxy&gt; parentWindow;</span>
<a href="#l62.16"></a><span id="l62.16">   nsCOMPtr&lt;nsIPromptService&gt; promptService = do_GetService(NS_PROMPTSERVICE_CONTRACTID);</span>
<a href="#l62.17"></a><span id="l62.17">   nsCOMPtr&lt;nsIDocShell&gt; docShell;</span>
<a href="#l62.18"></a><span id="l62.18">   if (msgWindow)</span>
<a href="#l62.19"></a><span id="l62.19">   {</span>
<a href="#l62.20"></a><span id="l62.20">     (void) msgWindow-&gt;GetRootDocShell(getter_AddRefs(docShell));</span>
<a href="#l62.21"></a><span id="l62.21">     parentWindow = do_QueryInterface(docShell);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1" class="difflineminus">--- a/mailnews/mapi/mapihook/src/msgMapiHook.cpp</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineplus">+++ b/mailnews/mapi/mapihook/src/msgMapiHook.cpp</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineat">@@ -141,32 +141,32 @@ bool nsMapiHook::DisplayLoginDialog(bool</span>
<a href="#l63.4"></a><span id="l63.4">     nsCOMPtr&lt;nsIStringBundle&gt; brandBundle;</span>
<a href="#l63.5"></a><span id="l63.5">     rv = bundleService-&gt;CreateBundle(</span>
<a href="#l63.6"></a><span id="l63.6">                     &quot;chrome://branding/locale/brand.properties&quot;,</span>
<a href="#l63.7"></a><span id="l63.7">                     getter_AddRefs(brandBundle));</span>
<a href="#l63.8"></a><span id="l63.8">     if (NS_FAILED(rv)) return false;</span>
<a href="#l63.9"></a><span id="l63.9"> </span>
<a href="#l63.10"></a><span id="l63.10">     nsString brandName;</span>
<a href="#l63.11"></a><span id="l63.11">     rv = brandBundle-&gt;GetStringFromName(</span>
<a href="#l63.12"></a><span id="l63.12" class="difflineminus">-                       MOZ_UTF16(&quot;brandFullName&quot;),</span>
<a href="#l63.13"></a><span id="l63.13" class="difflineplus">+                       u&quot;brandFullName&quot;,</span>
<a href="#l63.14"></a><span id="l63.14">                        getter_Copies(brandName));</span>
<a href="#l63.15"></a><span id="l63.15">     if (NS_FAILED(rv)) return false;</span>
<a href="#l63.16"></a><span id="l63.16"> </span>
<a href="#l63.17"></a><span id="l63.17">     nsString loginTitle;</span>
<a href="#l63.18"></a><span id="l63.18">     const char16_t *brandStrings[] = { brandName.get() };</span>
<a href="#l63.19"></a><span id="l63.19">     NS_NAMED_LITERAL_STRING(loginTitlePropertyTag, &quot;loginTitle&quot;);</span>
<a href="#l63.20"></a><span id="l63.20">     const char16_t *dTitlePropertyTag = loginTitlePropertyTag.get();</span>
<a href="#l63.21"></a><span id="l63.21">     rv = bundle-&gt;FormatStringFromName(dTitlePropertyTag, brandStrings, 1,</span>
<a href="#l63.22"></a><span id="l63.22">                                       getter_Copies(loginTitle));</span>
<a href="#l63.23"></a><span id="l63.23">     if (NS_FAILED(rv)) return false;</span>
<a href="#l63.24"></a><span id="l63.24"> </span>
<a href="#l63.25"></a><span id="l63.25">     if (aLogin)</span>
<a href="#l63.26"></a><span id="l63.26">     {</span>
<a href="#l63.27"></a><span id="l63.27">       nsString loginText;</span>
<a href="#l63.28"></a><span id="l63.28" class="difflineminus">-      rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;loginTextwithName&quot;),</span>
<a href="#l63.29"></a><span id="l63.29" class="difflineplus">+      rv = bundle-&gt;GetStringFromName(u&quot;loginTextwithName&quot;,</span>
<a href="#l63.30"></a><span id="l63.30">                                      getter_Copies(loginText));</span>
<a href="#l63.31"></a><span id="l63.31">       if (NS_FAILED(rv) || loginText.IsEmpty()) return false;</span>
<a href="#l63.32"></a><span id="l63.32"> </span>
<a href="#l63.33"></a><span id="l63.33">       bool dummyValue = false;</span>
<a href="#l63.34"></a><span id="l63.34">       rv = dlgService-&gt;PromptUsernameAndPassword(nullptr, loginTitle.get(),</span>
<a href="#l63.35"></a><span id="l63.35">                                                  loginText.get(), aUsername, aPassword,</span>
<a href="#l63.36"></a><span id="l63.36">                                                  nullptr, &amp;dummyValue, &amp;btnResult);</span>
<a href="#l63.37"></a><span id="l63.37">     }</span>
<a href="#l63.38"></a><span id="l63.38" class="difflineat">@@ -250,22 +250,22 @@ nsMapiHook::IsBlindSendAllowed()</span>
<a href="#l63.39"></a><span id="l63.39">     mozilla::services::GetStringBundleService();</span>
<a href="#l63.40"></a><span id="l63.40">   if (!bundleService) return false;</span>
<a href="#l63.41"></a><span id="l63.41"> </span>
<a href="#l63.42"></a><span id="l63.42">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l63.43"></a><span id="l63.43">   rv = bundleService-&gt;CreateBundle(MAPI_PROPERTIES_CHROME, getter_AddRefs(bundle));</span>
<a href="#l63.44"></a><span id="l63.44">   if (NS_FAILED(rv) || !bundle) return false;</span>
<a href="#l63.45"></a><span id="l63.45"> </span>
<a href="#l63.46"></a><span id="l63.46">   nsString warningMsg;</span>
<a href="#l63.47"></a><span id="l63.47" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;mapiBlindSendWarning&quot;),</span>
<a href="#l63.48"></a><span id="l63.48" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(u&quot;mapiBlindSendWarning&quot;,</span>
<a href="#l63.49"></a><span id="l63.49">                                       getter_Copies(warningMsg));</span>
<a href="#l63.50"></a><span id="l63.50">   if (NS_FAILED(rv)) return false;</span>
<a href="#l63.51"></a><span id="l63.51"> </span>
<a href="#l63.52"></a><span id="l63.52">   nsString dontShowAgainMessage;</span>
<a href="#l63.53"></a><span id="l63.53" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;mapiBlindSendDontShowAgain&quot;),</span>
<a href="#l63.54"></a><span id="l63.54" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(u&quot;mapiBlindSendDontShowAgain&quot;,</span>
<a href="#l63.55"></a><span id="l63.55">                                       getter_Copies(dontShowAgainMessage));</span>
<a href="#l63.56"></a><span id="l63.56">   if (NS_FAILED(rv)) return false;</span>
<a href="#l63.57"></a><span id="l63.57"> </span>
<a href="#l63.58"></a><span id="l63.58">   nsCOMPtr&lt;nsIPromptService&gt; dlgService(do_GetService(NS_PROMPTSERVICE_CONTRACTID, &amp;rv));</span>
<a href="#l63.59"></a><span id="l63.59">   if (NS_FAILED(rv) || !dlgService) return false;</span>
<a href="#l63.60"></a><span id="l63.60"> </span>
<a href="#l63.61"></a><span id="l63.61">   bool continueToWarn = true;</span>
<a href="#l63.62"></a><span id="l63.62">   bool okayToContinue = false;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1" class="difflineminus">--- a/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineplus">+++ b/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineat">@@ -53,17 +53,17 @@ static void MimePgpe_free (void *);</span>
<a href="#l64.4"></a><span id="l64.4"> </span>
<a href="#l64.5"></a><span id="l64.5"> /* Returns a string describing the location of the part (like &quot;2.5.3&quot;).</span>
<a href="#l64.6"></a><span id="l64.6">    This is not a full URL, just a part-number.</span>
<a href="#l64.7"></a><span id="l64.7">  */</span>
<a href="#l64.8"></a><span id="l64.8"> static nsCString determineMimePart(MimeObject* obj);</span>
<a href="#l64.9"></a><span id="l64.9"> </span>
<a href="#l64.10"></a><span id="l64.10"> </span>
<a href="#l64.11"></a><span id="l64.11"> #define PGPMIME_PROPERTIES_URL        &quot;chrome://messenger/locale/pgpmime.properties&quot;</span>
<a href="#l64.12"></a><span id="l64.12" class="difflineminus">-#define PGPMIME_STR_NOT_SUPPORTED_ID  &quot;pgpMimeNeedsAddon&quot;</span>
<a href="#l64.13"></a><span id="l64.13" class="difflineplus">+#define PGPMIME_STR_NOT_SUPPORTED_ID  u&quot;pgpMimeNeedsAddon&quot;</span>
<a href="#l64.14"></a><span id="l64.14"> #define PGPMIME_URL_PREF              &quot;mail.pgpmime.addon_url&quot;</span>
<a href="#l64.15"></a><span id="l64.15"> </span>
<a href="#l64.16"></a><span id="l64.16"> static void PgpMimeGetNeedsAddonString(nsCString &amp;aResult)</span>
<a href="#l64.17"></a><span id="l64.17"> {</span>
<a href="#l64.18"></a><span id="l64.18">   aResult.AssignLiteral(&quot;???&quot;);</span>
<a href="#l64.19"></a><span id="l64.19"> </span>
<a href="#l64.20"></a><span id="l64.20">   nsCOMPtr&lt;nsIStringBundleService&gt; stringBundleService =</span>
<a href="#l64.21"></a><span id="l64.21">     mozilla::services::GetStringBundleService();</span>
<a href="#l64.22"></a><span id="l64.22" class="difflineat">@@ -82,17 +82,17 @@ static void PgpMimeGetNeedsAddonString(n</span>
<a href="#l64.23"></a><span id="l64.23">   if (NS_FAILED(prefs-&gt;GetCharPref(&quot;mail.pgpmime.addon_url&quot;,</span>
<a href="#l64.24"></a><span id="l64.24">                                    getter_Copies(url))))</span>
<a href="#l64.25"></a><span id="l64.25">     return;</span>
<a href="#l64.26"></a><span id="l64.26"> </span>
<a href="#l64.27"></a><span id="l64.27">   NS_ConvertUTF8toUTF16 url16(url);</span>
<a href="#l64.28"></a><span id="l64.28">   const char16_t *formatStrings[] = { url16.get() };</span>
<a href="#l64.29"></a><span id="l64.29"> </span>
<a href="#l64.30"></a><span id="l64.30">   nsString result;</span>
<a href="#l64.31"></a><span id="l64.31" class="difflineminus">-  rv = stringBundle-&gt;FormatStringFromName(MOZ_UTF16(PGPMIME_STR_NOT_SUPPORTED_ID),</span>
<a href="#l64.32"></a><span id="l64.32" class="difflineplus">+  rv = stringBundle-&gt;FormatStringFromName(PGPMIME_STR_NOT_SUPPORTED_ID,</span>
<a href="#l64.33"></a><span id="l64.33">                                           formatStrings, 1, getter_Copies(result));</span>
<a href="#l64.34"></a><span id="l64.34">   if (NS_FAILED(rv))</span>
<a href="#l64.35"></a><span id="l64.35">     return;</span>
<a href="#l64.36"></a><span id="l64.36">   aResult = NS_ConvertUTF16toUTF8(result);</span>
<a href="#l64.37"></a><span id="l64.37"> }</span>
<a href="#l64.38"></a><span id="l64.38"> </span>
<a href="#l64.39"></a><span id="l64.39"> static int</span>
<a href="#l64.40"></a><span id="l64.40"> MimeEncryptedPgpClassInitialize(MimeEncryptedPgpClass *clazz)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1" class="difflineminus">--- a/mailnews/mime/emitters/nsMimeBaseEmitter.cpp</span>
<a href="#l65.2"></a><span id="l65.2" class="difflineplus">+++ b/mailnews/mime/emitters/nsMimeBaseEmitter.cpp</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineat">@@ -735,17 +735,17 @@ nsMimeBaseEmitter::GenerateDateString(co</span>
<a href="#l65.4"></a><span id="l65.4">     {</span>
<a href="#l65.5"></a><span id="l65.5">       if (displaySenderTimezone)</span>
<a href="#l65.6"></a><span id="l65.6">       {</span>
<a href="#l65.7"></a><span id="l65.7">         // offset of local time from UTC in minutes</span>
<a href="#l65.8"></a><span id="l65.8">         int32_t senderoffset = (explodedMsgTime.tm_params.tp_gmt_offset +</span>
<a href="#l65.9"></a><span id="l65.9">                                 explodedMsgTime.tm_params.tp_dst_offset) / 60;</span>
<a href="#l65.10"></a><span id="l65.10">         // append offset to date string</span>
<a href="#l65.11"></a><span id="l65.11">         char16_t *tzstring =</span>
<a href="#l65.12"></a><span id="l65.12" class="difflineminus">-          nsTextFormatter::smprintf(MOZ_UTF16(&quot; %+05d&quot;),</span>
<a href="#l65.13"></a><span id="l65.13" class="difflineplus">+          nsTextFormatter::smprintf(u&quot; %+05d&quot;,</span>
<a href="#l65.14"></a><span id="l65.14">                                     (senderoffset / 60 * 100) +</span>
<a href="#l65.15"></a><span id="l65.15">                                     (senderoffset % 60));</span>
<a href="#l65.16"></a><span id="l65.16">         formattedDateString.Append(tzstring);</span>
<a href="#l65.17"></a><span id="l65.17">         nsTextFormatter::smprintf_free(tzstring);</span>
<a href="#l65.18"></a><span id="l65.18">       }</span>
<a href="#l65.19"></a><span id="l65.19"> </span>
<a href="#l65.20"></a><span id="l65.20">       CopyUTF16toUTF8(formattedDateString, formattedDate);</span>
<a href="#l65.21"></a><span id="l65.21">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l66.1"></a><span id="l66.1" class="difflineminus">--- a/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp</span>
<a href="#l66.2"></a><span id="l66.2" class="difflineplus">+++ b/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp</span>
<a href="#l66.3"></a><span id="l66.3" class="difflineat">@@ -414,17 +414,17 @@ nsMimeHtmlDisplayEmitter::StartAttachmen</span>
<a href="#l66.4"></a><span id="l66.4">       NS_ENSURE_TRUE(bundleSvc, NS_ERROR_UNEXPECTED);</span>
<a href="#l66.5"></a><span id="l66.5"> </span>
<a href="#l66.6"></a><span id="l66.6">       nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l66.7"></a><span id="l66.7">       rv = bundleSvc-&gt;CreateBundle(&quot;chrome://messenger/locale/messenger.properties&quot;,</span>
<a href="#l66.8"></a><span id="l66.8">                                    getter_AddRefs(bundle));</span>
<a href="#l66.9"></a><span id="l66.9">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l66.10"></a><span id="l66.10"> </span>
<a href="#l66.11"></a><span id="l66.11">       nsString attachmentsHeader;</span>
<a href="#l66.12"></a><span id="l66.12" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;attachmentsPrintHeader&quot;),</span>
<a href="#l66.13"></a><span id="l66.13" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;attachmentsPrintHeader&quot;,</span>
<a href="#l66.14"></a><span id="l66.14">                                 getter_Copies(attachmentsHeader)); </span>
<a href="#l66.15"></a><span id="l66.15"> </span>
<a href="#l66.16"></a><span id="l66.16">       UtilityWrite(&quot;&lt;legend class=\&quot;mimeAttachmentHeaderName\&quot;&gt;&quot;);</span>
<a href="#l66.17"></a><span id="l66.17">       nsCString escapedName;</span>
<a href="#l66.18"></a><span id="l66.18">       escapedName.Adopt(MsgEscapeHTML(NS_ConvertUTF16toUTF8(attachmentsHeader).get()));</span>
<a href="#l66.19"></a><span id="l66.19">       UtilityWrite(escapedName.get());</span>
<a href="#l66.20"></a><span id="l66.20">       UtilityWrite(&quot;&lt;/legend&gt;&quot;);</span>
<a href="#l66.21"></a><span id="l66.21">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l67.1"></a><span id="l67.1" class="difflineminus">--- a/mailnews/mime/src/mimemsg.cpp</span>
<a href="#l67.2"></a><span id="l67.2" class="difflineplus">+++ b/mailnews/mime/src/mimemsg.cpp</span>
<a href="#l67.3"></a><span id="l67.3" class="difflineat">@@ -861,26 +861,26 @@ MimeMessage_partial_message_html(const c</span>
<a href="#l67.4"></a><span id="l67.4">   nsCString partialMsgHtml;</span>
<a href="#l67.5"></a><span id="l67.5">   nsCString item;</span>
<a href="#l67.6"></a><span id="l67.6"> </span>
<a href="#l67.7"></a><span id="l67.7">   partialMsgHtml.AppendLiteral(&quot;&lt;div style=\&quot;margin: 1em auto; border: 1px solid black; width: 80%\&quot;&gt;&quot;);</span>
<a href="#l67.8"></a><span id="l67.8">   partialMsgHtml.AppendLiteral(&quot;&lt;div style=\&quot;margin: 5px; padding: 10px; border: 1px solid gray; font-weight: bold; text-align: center;\&quot;&gt;&quot;);</span>
<a href="#l67.9"></a><span id="l67.9"> </span>
<a href="#l67.10"></a><span id="l67.10">   partialMsgHtml.AppendLiteral(&quot;&lt;span style=\&quot;font-size: 120%;\&quot;&gt;&quot;);</span>
<a href="#l67.11"></a><span id="l67.11">   if (msgBaseTruncated)</span>
<a href="#l67.12"></a><span id="l67.12" class="difflineminus">-    item.Adopt(MimeGetStringByName(MOZ_UTF16(&quot;MIME_MSG_PARTIAL_TRUNCATED&quot;)));</span>
<a href="#l67.13"></a><span id="l67.13" class="difflineplus">+    item.Adopt(MimeGetStringByName(u&quot;MIME_MSG_PARTIAL_TRUNCATED&quot;));</span>
<a href="#l67.14"></a><span id="l67.14">   else</span>
<a href="#l67.15"></a><span id="l67.15" class="difflineminus">-    item.Adopt(MimeGetStringByName(MOZ_UTF16(&quot;MIME_MSG_PARTIAL_NOT_DOWNLOADED&quot;)));</span>
<a href="#l67.16"></a><span id="l67.16" class="difflineplus">+    item.Adopt(MimeGetStringByName(u&quot;MIME_MSG_PARTIAL_NOT_DOWNLOADED&quot;));</span>
<a href="#l67.17"></a><span id="l67.17">   partialMsgHtml += item;</span>
<a href="#l67.18"></a><span id="l67.18">   partialMsgHtml.AppendLiteral(&quot;&lt;/span&gt;&lt;hr&gt;&quot;);</span>
<a href="#l67.19"></a><span id="l67.19"> </span>
<a href="#l67.20"></a><span id="l67.20">   if (msgBaseTruncated)</span>
<a href="#l67.21"></a><span id="l67.21" class="difflineminus">-    item.Adopt(MimeGetStringByName(MOZ_UTF16(&quot;MIME_MSG_PARTIAL_TRUNCATED_EXPLANATION&quot;)));</span>
<a href="#l67.22"></a><span id="l67.22" class="difflineplus">+    item.Adopt(MimeGetStringByName(u&quot;MIME_MSG_PARTIAL_TRUNCATED_EXPLANATION&quot;));</span>
<a href="#l67.23"></a><span id="l67.23">   else</span>
<a href="#l67.24"></a><span id="l67.24" class="difflineminus">-    item.Adopt(MimeGetStringByName(MOZ_UTF16(&quot;MIME_MSG_PARTIAL_NOT_DOWNLOADED_EXPLANATION&quot;)));</span>
<a href="#l67.25"></a><span id="l67.25" class="difflineplus">+    item.Adopt(MimeGetStringByName(u&quot;MIME_MSG_PARTIAL_NOT_DOWNLOADED_EXPLANATION&quot;));</span>
<a href="#l67.26"></a><span id="l67.26">   partialMsgHtml += item;</span>
<a href="#l67.27"></a><span id="l67.27">   partialMsgHtml.AppendLiteral(&quot;&lt;br&gt;&lt;br&gt;&quot;);</span>
<a href="#l67.28"></a><span id="l67.28"> </span>
<a href="#l67.29"></a><span id="l67.29">   partialMsgHtml.AppendLiteral(&quot;&lt;a href=\&quot;&quot;);</span>
<a href="#l67.30"></a><span id="l67.30">   partialMsgHtml.Append(orig_url);</span>
<a href="#l67.31"></a><span id="l67.31"> </span>
<a href="#l67.32"></a><span id="l67.32">   if (msgIdPtr) {</span>
<a href="#l67.33"></a><span id="l67.33">     partialMsgHtml.AppendLiteral(&quot;&amp;messageid=&quot;);</span>
<a href="#l67.34"></a><span id="l67.34" class="difflineat">@@ -896,17 +896,17 @@ MimeMessage_partial_message_html(const c</span>
<a href="#l67.35"></a><span id="l67.35"> </span>
<a href="#l67.36"></a><span id="l67.36">     MsgEscapeString(nsDependentCString(uidl), nsINetUtil::ESCAPE_XALPHAS,</span>
<a href="#l67.37"></a><span id="l67.37">                     item);</span>
<a href="#l67.38"></a><span id="l67.38"> </span>
<a href="#l67.39"></a><span id="l67.39">     partialMsgHtml.Append(item);</span>
<a href="#l67.40"></a><span id="l67.40">   }</span>
<a href="#l67.41"></a><span id="l67.41"> </span>
<a href="#l67.42"></a><span id="l67.42">   partialMsgHtml.AppendLiteral(&quot;\&quot;&gt;&quot;);</span>
<a href="#l67.43"></a><span id="l67.43" class="difflineminus">-  item.Adopt(MimeGetStringByName(MOZ_UTF16(&quot;MIME_MSG_PARTIAL_CLICK_FOR_REST&quot;)));</span>
<a href="#l67.44"></a><span id="l67.44" class="difflineplus">+  item.Adopt(MimeGetStringByName(u&quot;MIME_MSG_PARTIAL_CLICK_FOR_REST&quot;));</span>
<a href="#l67.45"></a><span id="l67.45">   partialMsgHtml += item;</span>
<a href="#l67.46"></a><span id="l67.46">   partialMsgHtml.AppendLiteral(&quot;&lt;/a&gt;&quot;);</span>
<a href="#l67.47"></a><span id="l67.47"> </span>
<a href="#l67.48"></a><span id="l67.48">   partialMsgHtml.AppendLiteral(&quot;&lt;/div&gt;&lt;/div&gt;&quot;);</span>
<a href="#l67.49"></a><span id="l67.49"> </span>
<a href="#l67.50"></a><span id="l67.50">   return ToNewCString(partialMsgHtml);</span>
<a href="#l67.51"></a><span id="l67.51"> }</span>
<a href="#l67.52"></a><span id="l67.52"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l68.1"></a><span id="l68.1" class="difflineminus">--- a/mailnews/news/src/nsNNTPNewsgroupList.cpp</span>
<a href="#l68.2"></a><span id="l68.2" class="difflineplus">+++ b/mailnews/news/src/nsNNTPNewsgroupList.cpp</span>
<a href="#l68.3"></a><span id="l68.3" class="difflineat">@@ -311,17 +311,17 @@ nsNNTPNewsgroupList::GetRangeOfArtsToDow</span>
<a href="#l68.4"></a><span id="l68.4">     nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l68.5"></a><span id="l68.5">       mozilla::services::GetStringBundleService();</span>
<a href="#l68.6"></a><span id="l68.6">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l68.7"></a><span id="l68.7"> </span>
<a href="#l68.8"></a><span id="l68.8">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l68.9"></a><span id="l68.9">     rv = bundleService-&gt;CreateBundle(NEWS_MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l68.10"></a><span id="l68.10">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l68.11"></a><span id="l68.11"> </span>
<a href="#l68.12"></a><span id="l68.12" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;noNewMessages&quot;), getter_Copies(statusString));</span>
<a href="#l68.13"></a><span id="l68.13" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(u&quot;noNewMessages&quot;, getter_Copies(statusString));</span>
<a href="#l68.14"></a><span id="l68.14">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l68.15"></a><span id="l68.15"> </span>
<a href="#l68.16"></a><span id="l68.16">     SetProgressStatus(statusString.get());</span>
<a href="#l68.17"></a><span id="l68.17">   }</span>
<a href="#l68.18"></a><span id="l68.18"> </span>
<a href="#l68.19"></a><span id="l68.19">   if (maxextra &lt;= 0 || last_possible &lt; first_possible || last_possible &lt; 1)</span>
<a href="#l68.20"></a><span id="l68.20">   {</span>
<a href="#l68.21"></a><span id="l68.21">     *status=0;</span>
<a href="#l68.22"></a><span id="l68.22" class="difflineat">@@ -881,17 +881,17 @@ nsNNTPNewsgroupList::FinishXOVERLINE(int</span>
<a href="#l68.23"></a><span id="l68.23">         mozilla::services::GetStringBundleService();</span>
<a href="#l68.24"></a><span id="l68.24">       NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l68.25"></a><span id="l68.25"> </span>
<a href="#l68.26"></a><span id="l68.26">       nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l68.27"></a><span id="l68.27">       rv = bundleService-&gt;CreateBundle(NEWS_MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l68.28"></a><span id="l68.28">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l68.29"></a><span id="l68.29"> </span>
<a href="#l68.30"></a><span id="l68.30">       const char16_t *formatStrings[2] = { firstStr.get(), lastStr.get() };</span>
<a href="#l68.31"></a><span id="l68.31" class="difflineminus">-      rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;downloadingArticles&quot;), formatStrings, 2, getter_Copies(statusString));</span>
<a href="#l68.32"></a><span id="l68.32" class="difflineplus">+      rv = bundle-&gt;FormatStringFromName(u&quot;downloadingArticles&quot;, formatStrings, 2, getter_Copies(statusString));</span>
<a href="#l68.33"></a><span id="l68.33">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l68.34"></a><span id="l68.34"> </span>
<a href="#l68.35"></a><span id="l68.35">       SetProgressStatus(statusString.get());</span>
<a href="#l68.36"></a><span id="l68.36">     }</span>
<a href="#l68.37"></a><span id="l68.37">   }</span>
<a href="#l68.38"></a><span id="l68.38"> </span>
<a href="#l68.39"></a><span id="l68.39">   if (newstatus)</span>
<a href="#l68.40"></a><span id="l68.40">     *newstatus=0;</span>
<a href="#l68.41"></a><span id="l68.41" class="difflineat">@@ -1248,17 +1248,17 @@ nsNNTPNewsgroupList::SetProgressStatus(c</span>
<a href="#l68.42"></a><span id="l68.42">       nsString statusMessage;</span>
<a href="#l68.43"></a><span id="l68.43">       nsCOMPtr&lt;nsIStringBundleService&gt; sbs =</span>
<a href="#l68.44"></a><span id="l68.44">         mozilla::services::GetStringBundleService();</span>
<a href="#l68.45"></a><span id="l68.45">       nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l68.46"></a><span id="l68.46">       rv = sbs-&gt;CreateBundle(MSGS_URL,</span>
<a href="#l68.47"></a><span id="l68.47">                              getter_AddRefs(bundle));</span>
<a href="#l68.48"></a><span id="l68.48">       NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l68.49"></a><span id="l68.49">       const char16_t *params[] = { accountName.get(), aMessage };</span>
<a href="#l68.50"></a><span id="l68.50" class="difflineminus">-      bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;statusMessage&quot;),</span>
<a href="#l68.51"></a><span id="l68.51" class="difflineplus">+      bundle-&gt;FormatStringFromName(u&quot;statusMessage&quot;,</span>
<a href="#l68.52"></a><span id="l68.52">                                    params, 2, getter_Copies(statusMessage));</span>
<a href="#l68.53"></a><span id="l68.53"> </span>
<a href="#l68.54"></a><span id="l68.54">       feedback-&gt;ShowStatusString(statusMessage);</span>
<a href="#l68.55"></a><span id="l68.55">     }</span>
<a href="#l68.56"></a><span id="l68.56">   }</span>
<a href="#l68.57"></a><span id="l68.57"> }</span>
<a href="#l68.58"></a><span id="l68.58"> </span>
<a href="#l68.59"></a><span id="l68.59"> void</span>
<a href="#l68.60"></a><span id="l68.60" class="difflineat">@@ -1290,24 +1290,24 @@ nsNNTPNewsgroupList::UpdateStatus(bool f</span>
<a href="#l68.61"></a><span id="l68.61">   if (!NS_SUCCEEDED(rv))</span>
<a href="#l68.62"></a><span id="l68.62">     return;</span>
<a href="#l68.63"></a><span id="l68.63"> </span>
<a href="#l68.64"></a><span id="l68.64">   if (filtering)</span>
<a href="#l68.65"></a><span id="l68.65">   {</span>
<a href="#l68.66"></a><span id="l68.66">     NS_ConvertUTF8toUTF16 header(m_filterHeaders[m_currentXHDRIndex]);</span>
<a href="#l68.67"></a><span id="l68.67">     const char16_t *formatStrings[4] = { header.get(),</span>
<a href="#l68.68"></a><span id="l68.68">       numDownloadedStr.get(), totalToDownloadStr.get(), newsgroupName.get() };</span>
<a href="#l68.69"></a><span id="l68.69" class="difflineminus">-    rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;newNewsgroupFilteringHeaders&quot;),</span>
<a href="#l68.70"></a><span id="l68.70" class="difflineplus">+    rv = bundle-&gt;FormatStringFromName(u&quot;newNewsgroupFilteringHeaders&quot;,</span>
<a href="#l68.71"></a><span id="l68.71">       formatStrings, 4, getter_Copies(statusString));</span>
<a href="#l68.72"></a><span id="l68.72">   }</span>
<a href="#l68.73"></a><span id="l68.73">   else</span>
<a href="#l68.74"></a><span id="l68.74">   {</span>
<a href="#l68.75"></a><span id="l68.75">     const char16_t *formatStrings[3] = { numDownloadedStr.get(),</span>
<a href="#l68.76"></a><span id="l68.76">       totalToDownloadStr.get(), newsgroupName.get() };</span>
<a href="#l68.77"></a><span id="l68.77" class="difflineminus">-    rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;newNewsgroupHeaders&quot;),</span>
<a href="#l68.78"></a><span id="l68.78" class="difflineplus">+    rv = bundle-&gt;FormatStringFromName(u&quot;newNewsgroupHeaders&quot;,</span>
<a href="#l68.79"></a><span id="l68.79">       formatStrings, 3, getter_Copies(statusString));</span>
<a href="#l68.80"></a><span id="l68.80">   }</span>
<a href="#l68.81"></a><span id="l68.81">   if (!NS_SUCCEEDED(rv))</span>
<a href="#l68.82"></a><span id="l68.82">     return;</span>
<a href="#l68.83"></a><span id="l68.83"> </span>
<a href="#l68.84"></a><span id="l68.84">   SetProgressStatus(statusString.get());</span>
<a href="#l68.85"></a><span id="l68.85">   m_lastStatusUpdate = PR_Now();</span>
<a href="#l68.86"></a><span id="l68.86"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l69.1"></a><span id="l69.1" class="difflineminus">--- a/mailnews/news/src/nsNNTPProtocol.cpp</span>
<a href="#l69.2"></a><span id="l69.2" class="difflineplus">+++ b/mailnews/news/src/nsNNTPProtocol.cpp</span>
<a href="#l69.3"></a><span id="l69.3" class="difflineat">@@ -1036,17 +1036,17 @@ nsresult nsNNTPProtocol::LoadUrl(nsIURI </span>
<a href="#l69.4"></a><span id="l69.4">       nsAutoString unescapedName;</span>
<a href="#l69.5"></a><span id="l69.5">       rv = NS_MsgDecodeUnescapeURLPath(group, unescapedName);</span>
<a href="#l69.6"></a><span id="l69.6">       NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l69.7"></a><span id="l69.7"> </span>
<a href="#l69.8"></a><span id="l69.8">       bundleService-&gt;CreateBundle(NEWS_MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l69.9"></a><span id="l69.9">       const char16_t *formatStrings[1] = { unescapedName.get() };</span>
<a href="#l69.10"></a><span id="l69.10"> </span>
<a href="#l69.11"></a><span id="l69.11">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l69.12"></a><span id="l69.12" class="difflineminus">-        MOZ_UTF16(&quot;autoSubscribeText&quot;), formatStrings, 1,</span>
<a href="#l69.13"></a><span id="l69.13" class="difflineplus">+        u&quot;autoSubscribeText&quot;, formatStrings, 1,</span>
<a href="#l69.14"></a><span id="l69.14">         getter_Copies(confirmText));</span>
<a href="#l69.15"></a><span id="l69.15">       NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l69.16"></a><span id="l69.16"> </span>
<a href="#l69.17"></a><span id="l69.17">       bool confirmResult = false;</span>
<a href="#l69.18"></a><span id="l69.18">       rv = dialog-&gt;Confirm(nullptr, confirmText.get(), &amp;confirmResult);</span>
<a href="#l69.19"></a><span id="l69.19">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l69.20"></a><span id="l69.20"> </span>
<a href="#l69.21"></a><span id="l69.21">       if (confirmResult)</span>
<a href="#l69.22"></a><span id="l69.22" class="difflineat">@@ -2773,17 +2773,17 @@ nsresult nsNNTPProtocol::ReadNewsList(ns</span>
<a href="#l69.23"></a><span id="l69.23">       char rate_buf[RATE_STR_BUF_LEN];</span>
<a href="#l69.24"></a><span id="l69.24">       PR_snprintf(rate_buf,RATE_STR_BUF_LEN,&quot;%.1f&quot;, rate);</span>
<a href="#l69.25"></a><span id="l69.25"> </span>
<a href="#l69.26"></a><span id="l69.26">       nsAutoString numGroupsStr;</span>
<a href="#l69.27"></a><span id="l69.27">       numGroupsStr.AppendInt(mNumGroupsListed);</span>
<a href="#l69.28"></a><span id="l69.28">       NS_ConvertASCIItoUTF16 rateStr(rate_buf);</span>
<a href="#l69.29"></a><span id="l69.29"> </span>
<a href="#l69.30"></a><span id="l69.30">       const char16_t *formatStrings[3] = { numGroupsStr.get(), bytesStr.get(), rateStr.get()};</span>
<a href="#l69.31"></a><span id="l69.31" class="difflineminus">-      rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;bytesReceived&quot;),</span>
<a href="#l69.32"></a><span id="l69.32" class="difflineplus">+      rv = bundle-&gt;FormatStringFromName(u&quot;bytesReceived&quot;,</span>
<a href="#l69.33"></a><span id="l69.33">         formatStrings, 3,</span>
<a href="#l69.34"></a><span id="l69.34">         getter_Copies(statusString));</span>
<a href="#l69.35"></a><span id="l69.35"> </span>
<a href="#l69.36"></a><span id="l69.36">       rv = msgStatusFeedback-&gt;ShowStatusString(statusString);</span>
<a href="#l69.37"></a><span id="l69.37">       if (NS_FAILED(rv)) {</span>
<a href="#l69.38"></a><span id="l69.38">         PR_Free(lineToFree);</span>
<a href="#l69.39"></a><span id="l69.39">         return rv;</span>
<a href="#l69.40"></a><span id="l69.40">       }</span>
<a href="#l69.41"></a><span id="l69.41" class="difflineat">@@ -3540,17 +3540,17 @@ nsresult nsNNTPProtocol::DoCancel()</span>
<a href="#l69.42"></a><span id="l69.42">   NS_ENSURE_TRUE(bundleService, NS_ERROR_OUT_OF_MEMORY);</span>
<a href="#l69.43"></a><span id="l69.43"> </span>
<a href="#l69.44"></a><span id="l69.44">   nsCOMPtr&lt;nsIStringBundle&gt; brandBundle;</span>
<a href="#l69.45"></a><span id="l69.45">   bundleService-&gt;CreateBundle(&quot;chrome://branding/locale/brand.properties&quot;,</span>
<a href="#l69.46"></a><span id="l69.46">                               getter_AddRefs(brandBundle));</span>
<a href="#l69.47"></a><span id="l69.47">   NS_ENSURE_TRUE(brandBundle, NS_ERROR_FAILURE);</span>
<a href="#l69.48"></a><span id="l69.48"> </span>
<a href="#l69.49"></a><span id="l69.49">   nsString brandFullName;</span>
<a href="#l69.50"></a><span id="l69.50" class="difflineminus">-  rv = brandBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;brandFullName&quot;),</span>
<a href="#l69.51"></a><span id="l69.51" class="difflineplus">+  rv = brandBundle-&gt;GetStringFromName(u&quot;brandFullName&quot;,</span>
<a href="#l69.52"></a><span id="l69.52">                                       getter_Copies(brandFullName));</span>
<a href="#l69.53"></a><span id="l69.53">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l69.54"></a><span id="l69.54">   NS_ConvertUTF16toUTF8 appName(brandFullName);</span>
<a href="#l69.55"></a><span id="l69.55"> </span>
<a href="#l69.56"></a><span id="l69.56">   newsgroups = m_cancelNewsgroups;</span>
<a href="#l69.57"></a><span id="l69.57">   distribution = m_cancelDistribution;</span>
<a href="#l69.58"></a><span id="l69.58">   id = m_cancelID;</span>
<a href="#l69.59"></a><span id="l69.59">   nsCString oldFrom(m_cancelFromHdr);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l70.1"></a><span id="l70.1" class="difflineminus">--- a/mailnews/news/src/nsNewsDownloader.cpp</span>
<a href="#l70.2"></a><span id="l70.2" class="difflineplus">+++ b/mailnews/news/src/nsNewsDownloader.cpp</span>
<a href="#l70.3"></a><span id="l70.3" class="difflineat">@@ -192,17 +192,17 @@ bool nsNewsDownloader::GetNextHdrToRetri</span>
<a href="#l70.4"></a><span id="l70.4">     nsAutoString totalStr;</span>
<a href="#l70.5"></a><span id="l70.5">     totalStr.AppendInt(int(m_keysToDownload.Length()));</span>
<a href="#l70.6"></a><span id="l70.6">     nsString prettiestName;</span>
<a href="#l70.7"></a><span id="l70.7">     nsString statusString;</span>
<a href="#l70.8"></a><span id="l70.8"> </span>
<a href="#l70.9"></a><span id="l70.9">     m_folder-&gt;GetPrettiestName(prettiestName);</span>
<a href="#l70.10"></a><span id="l70.10"> </span>
<a href="#l70.11"></a><span id="l70.11">     const char16_t *formatStrings[3] = { firstStr.get(), totalStr.get(), prettiestName.get() };</span>
<a href="#l70.12"></a><span id="l70.12" class="difflineminus">-    rv = bundle-&gt;FormatStringFromName(MOZ_UTF16(&quot;downloadingArticlesForOffline&quot;),</span>
<a href="#l70.13"></a><span id="l70.13" class="difflineplus">+    rv = bundle-&gt;FormatStringFromName(u&quot;downloadingArticlesForOffline&quot;,</span>
<a href="#l70.14"></a><span id="l70.14">                                       formatStrings, 3, getter_Copies(statusString));</span>
<a href="#l70.15"></a><span id="l70.15">     NS_ENSURE_SUCCESS(rv, false);</span>
<a href="#l70.16"></a><span id="l70.16">     ShowProgress(statusString.get(), percent);</span>
<a href="#l70.17"></a><span id="l70.17">     return true;</span>
<a href="#l70.18"></a><span id="l70.18">   }</span>
<a href="#l70.19"></a><span id="l70.19">   NS_ASSERTION(false, &quot;shouldn't get here if we're not downloading from keys.&quot;);</span>
<a href="#l70.20"></a><span id="l70.20">   return false;  // shouldn't get here if we're not downloading from keys.</span>
<a href="#l70.21"></a><span id="l70.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l71.1"></a><span id="l71.1" class="difflineminus">--- a/mailnews/news/src/nsNewsFolder.cpp</span>
<a href="#l71.2"></a><span id="l71.2" class="difflineplus">+++ b/mailnews/news/src/nsNewsFolder.cpp</span>
<a href="#l71.3"></a><span id="l71.3" class="difflineat">@@ -1233,17 +1233,17 @@ nsMsgNewsFolder::GetAuthenticationCreden</span>
<a href="#l71.4"></a><span id="l71.4">       if (!dialog) return NS_ERROR_FAILURE;</span>
<a href="#l71.5"></a><span id="l71.5">     }</span>
<a href="#l71.6"></a><span id="l71.6"> </span>
<a href="#l71.7"></a><span id="l71.7">     NS_ASSERTION(dialog, &quot;We didn't get a net prompt&quot;);</span>
<a href="#l71.8"></a><span id="l71.8">     if (dialog)</span>
<a href="#l71.9"></a><span id="l71.9">     {</span>
<a href="#l71.10"></a><span id="l71.10">       // Format the prompt text strings</span>
<a href="#l71.11"></a><span id="l71.11">       nsString promptTitle, promptText;</span>
<a href="#l71.12"></a><span id="l71.12" class="difflineminus">-      bundle-&gt;GetStringFromName(MOZ_UTF16(&quot;enterUserPassTitle&quot;),</span>
<a href="#l71.13"></a><span id="l71.13" class="difflineplus">+      bundle-&gt;GetStringFromName(u&quot;enterUserPassTitle&quot;,</span>
<a href="#l71.14"></a><span id="l71.14">         getter_Copies(promptTitle));</span>
<a href="#l71.15"></a><span id="l71.15"> </span>
<a href="#l71.16"></a><span id="l71.16">       nsString serverName;</span>
<a href="#l71.17"></a><span id="l71.17">       nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l71.18"></a><span id="l71.18">       rv = GetServer(getter_AddRefs(server));</span>
<a href="#l71.19"></a><span id="l71.19">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l71.20"></a><span id="l71.20"> </span>
<a href="#l71.21"></a><span id="l71.21">       server-&gt;GetPrettyName(serverName);</span>
<a href="#l71.22"></a><span id="l71.22" class="difflineat">@@ -1255,21 +1255,21 @@ nsMsgNewsFolder::GetAuthenticationCreden</span>
<a href="#l71.23"></a><span id="l71.23">       bool singleSignon = true;</span>
<a href="#l71.24"></a><span id="l71.24">       nntpServer-&gt;GetSingleSignon(&amp;singleSignon);</span>
<a href="#l71.25"></a><span id="l71.25"> </span>
<a href="#l71.26"></a><span id="l71.26">       const char16_t *params[2];</span>
<a href="#l71.27"></a><span id="l71.27">       params[0] = mName.get();</span>
<a href="#l71.28"></a><span id="l71.28">       params[1] = serverName.get();</span>
<a href="#l71.29"></a><span id="l71.29">       if (singleSignon)</span>
<a href="#l71.30"></a><span id="l71.30">         bundle-&gt;FormatStringFromName(</span>
<a href="#l71.31"></a><span id="l71.31" class="difflineminus">-          MOZ_UTF16(&quot;enterUserPassServer&quot;),</span>
<a href="#l71.32"></a><span id="l71.32" class="difflineplus">+          u&quot;enterUserPassServer&quot;,</span>
<a href="#l71.33"></a><span id="l71.33">           &amp;params[1], 1, getter_Copies(promptText));</span>
<a href="#l71.34"></a><span id="l71.34">       else</span>
<a href="#l71.35"></a><span id="l71.35">         bundle-&gt;FormatStringFromName(</span>
<a href="#l71.36"></a><span id="l71.36" class="difflineminus">-          MOZ_UTF16(&quot;enterUserPassGroup&quot;),</span>
<a href="#l71.37"></a><span id="l71.37" class="difflineplus">+          u&quot;enterUserPassGroup&quot;,</span>
<a href="#l71.38"></a><span id="l71.38">           params, 2, getter_Copies(promptText));</span>
<a href="#l71.39"></a><span id="l71.39"> </span>
<a href="#l71.40"></a><span id="l71.40">       // Fill the signon url for the dialog</span>
<a href="#l71.41"></a><span id="l71.41">       nsString signonURL;</span>
<a href="#l71.42"></a><span id="l71.42">       rv = CreateNewsgroupUrlForSignon(nullptr, signonURL);</span>
<a href="#l71.43"></a><span id="l71.43">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l71.44"></a><span id="l71.44"> </span>
<a href="#l71.45"></a><span id="l71.45">       // Prefill saved username/password</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l72.1"></a><span id="l72.1" class="difflineminus">--- a/mailnews/news/src/nsNntpIncomingServer.cpp</span>
<a href="#l72.2"></a><span id="l72.2" class="difflineplus">+++ b/mailnews/news/src/nsNntpIncomingServer.cpp</span>
<a href="#l72.3"></a><span id="l72.3" class="difflineat">@@ -1579,17 +1579,17 @@ nsNntpIncomingServer::GroupNotFound(nsIM</span>
<a href="#l72.4"></a><span id="l72.4">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l72.5"></a><span id="l72.5"> </span>
<a href="#l72.6"></a><span id="l72.6">   NS_ConvertUTF8toUTF16 hostStr(hostname);</span>
<a href="#l72.7"></a><span id="l72.7"> </span>
<a href="#l72.8"></a><span id="l72.8">   nsString groupName(aName);</span>
<a href="#l72.9"></a><span id="l72.9">   const char16_t *formatStrings[2] = { groupName.get(), hostStr.get() };</span>
<a href="#l72.10"></a><span id="l72.10">   nsString confirmText;</span>
<a href="#l72.11"></a><span id="l72.11">   rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l72.12"></a><span id="l72.12" class="difflineminus">-                    MOZ_UTF16(&quot;autoUnsubscribeText&quot;),</span>
<a href="#l72.13"></a><span id="l72.13" class="difflineplus">+                    u&quot;autoUnsubscribeText&quot;,</span>
<a href="#l72.14"></a><span id="l72.14">                     formatStrings, 2,</span>
<a href="#l72.15"></a><span id="l72.15">                     getter_Copies(confirmText));</span>
<a href="#l72.16"></a><span id="l72.16">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l72.17"></a><span id="l72.17"> </span>
<a href="#l72.18"></a><span id="l72.18">   bool confirmResult = false;</span>
<a href="#l72.19"></a><span id="l72.19">   rv = prompt-&gt;Confirm(nullptr, confirmText.get(), &amp;confirmResult);</span>
<a href="#l72.20"></a><span id="l72.20">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l72.21"></a><span id="l72.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l73.1"></a><span id="l73.1" class="difflineminus">--- a/suite/shell/src/nsGNOMEShellService.cpp</span>
<a href="#l73.2"></a><span id="l73.2" class="difflineplus">+++ b/suite/shell/src/nsGNOMEShellService.cpp</span>
<a href="#l73.3"></a><span id="l73.3" class="difflineat">@@ -81,17 +81,17 @@ GetBrandName(nsACString&amp; aBrandName)</span>
<a href="#l73.4"></a><span id="l73.4">   nsCOMPtr&lt;nsIStringBundleService&gt; bundleService(do_GetService(&quot;@mozilla.org/intl/stringbundle;1&quot;, &amp;rv));</span>
<a href="#l73.5"></a><span id="l73.5">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l73.6"></a><span id="l73.6"> </span>
<a href="#l73.7"></a><span id="l73.7">   nsCOMPtr&lt;nsIStringBundle&gt; brandBundle;</span>
<a href="#l73.8"></a><span id="l73.8">   rv = bundleService-&gt;CreateBundle(BRAND_PROPERTIES, getter_AddRefs(brandBundle));</span>
<a href="#l73.9"></a><span id="l73.9">   NS_ENSURE_TRUE(brandBundle, rv);</span>
<a href="#l73.10"></a><span id="l73.10"> </span>
<a href="#l73.11"></a><span id="l73.11">   nsString brandName;</span>
<a href="#l73.12"></a><span id="l73.12" class="difflineminus">-  rv = brandBundle-&gt;GetStringFromName(MOZ_UTF16(&quot;brandShortName&quot;),</span>
<a href="#l73.13"></a><span id="l73.13" class="difflineplus">+  rv = brandBundle-&gt;GetStringFromName(u&quot;brandShortName&quot;,</span>
<a href="#l73.14"></a><span id="l73.14">                                       getter_Copies(brandName));</span>
<a href="#l73.15"></a><span id="l73.15">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l73.16"></a><span id="l73.16"> </span>
<a href="#l73.17"></a><span id="l73.17">   CopyUTF16toUTF8(brandName, aBrandName);</span>
<a href="#l73.18"></a><span id="l73.18">   return rv;</span>
<a href="#l73.19"></a><span id="l73.19"> }</span>
<a href="#l73.20"></a><span id="l73.20"> </span>
<a href="#l73.21"></a><span id="l73.21"> nsresult</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l74.1"></a><span id="l74.1" class="difflineminus">--- a/suite/shell/src/nsWindowsShellService.cpp</span>
<a href="#l74.2"></a><span id="l74.2" class="difflineplus">+++ b/suite/shell/src/nsWindowsShellService.cpp</span>
<a href="#l74.3"></a><span id="l74.3" class="difflineat">@@ -770,17 +770,17 @@ nsWindowsShellService::SetDesktopBackgro</span>
<a href="#l74.4"></a><span id="l74.4">   nsCOMPtr&lt;nsIStringBundle&gt; shellBundle;</span>
<a href="#l74.5"></a><span id="l74.5">   rv = bundleService-&gt;CreateBundle(SHELLSERVICE_PROPERTIES,</span>
<a href="#l74.6"></a><span id="l74.6">                                    getter_AddRefs(shellBundle));</span>
<a href="#l74.7"></a><span id="l74.7">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l74.8"></a><span id="l74.8"> </span>
<a href="#l74.9"></a><span id="l74.9">   // e.g. &quot;Desktop Background.bmp&quot;</span>
<a href="#l74.10"></a><span id="l74.10">   nsString fileLeafName;</span>
<a href="#l74.11"></a><span id="l74.11">   rv = shellBundle-&gt;GetStringFromName</span>
<a href="#l74.12"></a><span id="l74.12" class="difflineminus">-                      (MOZ_UTF16(&quot;desktopBackgroundLeafNameWin&quot;),</span>
<a href="#l74.13"></a><span id="l74.13" class="difflineplus">+                      (u&quot;desktopBackgroundLeafNameWin&quot;,</span>
<a href="#l74.14"></a><span id="l74.14">                        getter_Copies(fileLeafName));</span>
<a href="#l74.15"></a><span id="l74.15">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l74.16"></a><span id="l74.16"> </span>
<a href="#l74.17"></a><span id="l74.17">   // get the profile root directory</span>
<a href="#l74.18"></a><span id="l74.18">   nsCOMPtr&lt;nsIFile&gt; file;</span>
<a href="#l74.19"></a><span id="l74.19">   rv = NS_GetSpecialDirectory(NS_APP_APPLICATION_REGISTRY_DIR,</span>
<a href="#l74.20"></a><span id="l74.20">                               getter_AddRefs(file));</span>
<a href="#l74.21"></a><span id="l74.21">   NS_ENSURE_SUCCESS(rv, rv);</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

