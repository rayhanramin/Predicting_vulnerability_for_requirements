<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 28886:6a5938a9d3700b361629cffa6124520dfbb116ba</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 6a5938a9d3700b361629cffa6124520dfbb116ba" />
<meta property="og:url" content="/comm-central/rev/6a5938a9d3700b361629cffa6124520dfbb116ba" />
<meta property="og:description" content="Bug 1620043 - Make sure that langpacks are not included in notarization-part-3. r=darktrojan" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 6a5938a9d3700b361629cffa6124520dfbb116ba 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/6a5938a9d3700b361629cffa6124520dfbb116ba">shortlog</a> |
<a href="/comm-central/log/6a5938a9d3700b361629cffa6124520dfbb116ba">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/6a5938a9d3700b361629cffa6124520dfbb116ba">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/6a5938a9d3700b361629cffa6124520dfbb116ba">files</a> |
changeset |
<a href="/comm-central/raw-rev/6a5938a9d3700b361629cffa6124520dfbb116ba">raw</a>  | <a href="/comm-central/archive/6a5938a9d3700b361629cffa6124520dfbb116ba.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1620043">Bug 1620043</a> - Make sure that langpacks are not included in notarization-part-3. r=darktrojan
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#82;&#111;&#98;&#32;&#76;&#101;&#109;&#108;&#101;&#121;&#32;&#60;&#114;&#111;&#98;&#64;&#116;&#104;&#117;&#110;&#100;&#101;&#114;&#98;&#105;&#114;&#100;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Wed, 04 Mar 2020 14:51:49 -0500</td></tr>

<tr>
 <td>changeset 28886</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/6a5938a9d3700b361629cffa6124520dfbb116ba">6a5938a9d3700b361629cffa6124520dfbb116ba</a></td>
</tr>



<tr>
<td>parent 28885</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/4fdcb0fd8f42f07374ac5fdd7f013d19eff7102e">4fdcb0fd8f42f07374ac5fdd7f013d19eff7102e</a>
</td>
</tr>

<tr>
<td>child 28887</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/94362ea102baae7c78f1314aa1270823d257a244">94362ea102baae7c78f1314aa1270823d257a244</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=6a5938a9d3700b361629cffa6124520dfbb116ba">17096</a></td></tr>
<tr><td>push user</td><td>geoff@darktrojan.net</td></tr>
<tr><td>push date</td><td class="date age">Thu, 05 Mar 2020 05:32:55 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@94362ea102ba [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=94362ea102baae7c78f1314aa1270823d257a244">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=94362ea102baae7c78f1314aa1270823d257a244&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=94362ea102baae7c78f1314aa1270823d257a244&newProject=comm-central&newRevision=6a5938a9d3700b361629cffa6124520dfbb116ba&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=94362ea102baae7c78f1314aa1270823d257a244&newProject=comm-central&newRevision=6a5938a9d3700b361629cffa6124520dfbb116ba&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=94362ea102baae7c78f1314aa1270823d257a244&newProject=comm-central&newRevision=6a5938a9d3700b361629cffa6124520dfbb116ba&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28darktrojan%29&revcount=50">darktrojan</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1620043">1620043</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1620043">Bug 1620043</a> - Make sure that langpacks are not included in notarization-part-3. r=darktrojan

ja-JP-mac langpacks stick around in upstreamArtifacts because of some of the
special cases in the Firefox transforms to handle langpacks in general and this
locale in particular. Since Thunderbird langpacks are not signed for now, check
that there are no stray entries in upstreamArtifacts sent to signing servers.</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/6a5938a9d3700b361629cffa6124520dfbb116ba/taskcluster/comm_taskgraph/transforms/signing.py">taskcluster/comm_taskgraph/transforms/signing.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6a5938a9d3700b361629cffa6124520dfbb116ba/taskcluster/comm_taskgraph/transforms/signing.py">file</a> |
<a href="/comm-central/annotate/6a5938a9d3700b361629cffa6124520dfbb116ba/taskcluster/comm_taskgraph/transforms/signing.py">annotate</a> |
<a href="/comm-central/diff/6a5938a9d3700b361629cffa6124520dfbb116ba/taskcluster/comm_taskgraph/transforms/signing.py">diff</a> |
<a href="/comm-central/comparison/6a5938a9d3700b361629cffa6124520dfbb116ba/taskcluster/comm_taskgraph/transforms/signing.py">comparison</a> |
<a href="/comm-central/log/6a5938a9d3700b361629cffa6124520dfbb116ba/taskcluster/comm_taskgraph/transforms/signing.py">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/taskcluster/comm_taskgraph/transforms/signing.py</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/taskcluster/comm_taskgraph/transforms/signing.py</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -56,16 +56,20 @@ def no_sign_langpacks(config, jobs):</span>
<a href="#l1.4"></a><span id="l1.4">         task = job['task']</span>
<a href="#l1.5"></a><span id="l1.5">         payload = task['payload']</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7">         if 'upstreamArtifacts' in payload:</span>
<a href="#l1.8"></a><span id="l1.8">             for artifact in payload['upstreamArtifacts']:</span>
<a href="#l1.9"></a><span id="l1.9">                 if 'autograph_langpack' in artifact.get('formats', []):</span>
<a href="#l1.10"></a><span id="l1.10">                     artifact['formats'].remove('autograph_langpack')</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+                # Make sure that there are no .xpi files in the artifact list</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+                if all([p.endswith('target.langpack.xpi') for p in artifact['paths']]):</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+                    payload['upstreamArtifacts'].remove(artifact)</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+</span>
<a href="#l1.16"></a><span id="l1.16">         yield job</span>
<a href="#l1.17"></a><span id="l1.17"> </span>
<a href="#l1.18"></a><span id="l1.18"> </span>
<a href="#l1.19"></a><span id="l1.19"> @transforms.add</span>
<a href="#l1.20"></a><span id="l1.20"> def check_for_no_formats(config, jobs):</span>
<a href="#l1.21"></a><span id="l1.21">     &quot;&quot;&quot;</span>
<a href="#l1.22"></a><span id="l1.22">     Check for signed artifacts without signature formats and remove them to</span>
<a href="#l1.23"></a><span id="l1.23">     avoid scriptworker errors.</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

