<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 9481:71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b" />
<meta property="og:url" content="/comm-central/rev/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b" />
<meta property="og:description" content="Bug 716706 - Fix and enhance the feed Subscriptions dialog. r=bienvenu,ui-review=bwinton" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b">shortlog</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b">files</a> |
changeset |
<a href="/comm-central/raw-rev/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b">raw</a>  | <a href="/comm-central/archive/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=716706">Bug 716706</a> - Fix and enhance the feed Subscriptions dialog. r=bienvenu,ui-review=bwinton
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#97;&#108;&#116;&#97;&#56;&#56;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;</td></tr>
<tr><td></td><td class="date age">Fri, 24 Feb 2012 10:39:17 +0000</td></tr>

<tr>
 <td>changeset 9481</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b">71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b</a></td>
</tr>



<tr>
<td>parent 9480</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/55b232b17c4cda0429eb5147670064e99e02386a">55b232b17c4cda0429eb5147670064e99e02386a</a>
</td>
</tr>

<tr>
<td>child 9482</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/9bcb86fe84f6d5b78b336d7ca62da1f8aa9f307d">9bcb86fe84f6d5b78b336d7ca62da1f8aa9f307d</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b">7249</a></td></tr>
<tr><td>push user</td><td>bugzilla@standard8.plus.com</td></tr>
<tr><td>push date</td><td class="date age">Fri, 24 Feb 2012 10:41:53 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@2210f715d6df [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=2210f715d6dfc656356b18eb977abe693f0b6cee">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=2210f715d6dfc656356b18eb977abe693f0b6cee&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=2210f715d6dfc656356b18eb977abe693f0b6cee&newProject=comm-central&newRevision=220992a25bb9583ab8dd49d9fcd25b7e7a0d2e71&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=2210f715d6dfc656356b18eb977abe693f0b6cee&newProject=comm-central&newRevision=220992a25bb9583ab8dd49d9fcd25b7e7a0d2e71&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=2210f715d6dfc656356b18eb977abe693f0b6cee&newProject=comm-central&newRevision=220992a25bb9583ab8dd49d9fcd25b7e7a0d2e71&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28bienvenu%29&revcount=50">bienvenu</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=716706">716706</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=716706">Bug 716706</a> - Fix and enhance the feed Subscriptions dialog. r=bienvenu,ui-review=bwinton</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/am-newsblog.properties">mail/locales/en-US/chrome/messenger-newsblog/am-newsblog.properties</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/am-newsblog.properties">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/am-newsblog.properties">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/am-newsblog.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/feed-properties.dtd">mail/locales/en-US/chrome/messenger-newsblog/feed-properties.dtd</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/feed-properties.dtd">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/feed-properties.dtd">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/feed-properties.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/newsblog.properties">mail/locales/en-US/chrome/messenger-newsblog/newsblog.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/newsblog.properties">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/newsblog.properties">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/newsblog.properties">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/newsblog.properties">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/en-US/chrome/messenger-newsblog/newsblog.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/jar.mn">mail/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/locales/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/gnomestripe/mail/newsblog/feed-subscriptions.css">mail/themes/gnomestripe/mail/newsblog/feed-subscriptions.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/gnomestripe/mail/newsblog/feed-subscriptions.css">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/gnomestripe/mail/newsblog/feed-subscriptions.css">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/gnomestripe/mail/newsblog/feed-subscriptions.css">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/gnomestripe/mail/newsblog/feed-subscriptions.css">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/gnomestripe/mail/newsblog/feed-subscriptions.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/pinstripe/mail/newsblog/feed-subscriptions.css">mail/themes/pinstripe/mail/newsblog/feed-subscriptions.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/pinstripe/mail/newsblog/feed-subscriptions.css">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/pinstripe/mail/newsblog/feed-subscriptions.css">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/pinstripe/mail/newsblog/feed-subscriptions.css">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/pinstripe/mail/newsblog/feed-subscriptions.css">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/pinstripe/mail/newsblog/feed-subscriptions.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/qute/mail/newsblog/feed-subscriptions.css">mail/themes/qute/mail/newsblog/feed-subscriptions.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/qute/mail/newsblog/feed-subscriptions.css">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/qute/mail/newsblog/feed-subscriptions.css">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/qute/mail/newsblog/feed-subscriptions.css">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/qute/mail/newsblog/feed-subscriptions.css">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mail/themes/qute/mail/newsblog/feed-subscriptions.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/am-newsblog.xul">mailnews/extensions/newsblog/content/am-newsblog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/am-newsblog.xul">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/am-newsblog.xul">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/am-newsblog.xul">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/am-newsblog.xul">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/am-newsblog.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/edittree.xml">mailnews/extensions/newsblog/content/edittree.xml</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/edittree.xml">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/edittree.xml">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/edittree.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-properties.js">mailnews/extensions/newsblog/content/feed-properties.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-properties.js">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-properties.js">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-properties.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-properties.xul">mailnews/extensions/newsblog/content/feed-properties.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-properties.xul">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-properties.xul">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-properties.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.js">mailnews/extensions/newsblog/content/feed-subscriptions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.js">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.js">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.js">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.js">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.xul">mailnews/extensions/newsblog/content/feed-subscriptions.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.xul">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.xul">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.xul">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.xul">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/feed-subscriptions.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/newsblogOverlay.js">mailnews/extensions/newsblog/content/newsblogOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/newsblogOverlay.js">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/newsblogOverlay.js">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/newsblogOverlay.js">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/newsblogOverlay.js">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/content/newsblogOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/jar.mn">mailnews/extensions/newsblog/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/jar.mn">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/jar.mn">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/jar.mn">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/jar.mn">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/mailnews/extensions/newsblog/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/am-newsblog.properties">suite/locales/en-US/chrome/mailnews/newsblog/am-newsblog.properties</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/am-newsblog.properties">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/am-newsblog.properties">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/am-newsblog.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/feed-properties.dtd">suite/locales/en-US/chrome/mailnews/newsblog/feed-properties.dtd</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/feed-properties.dtd">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/feed-properties.dtd">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/feed-properties.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/newsblog.properties">suite/locales/en-US/chrome/mailnews/newsblog/newsblog.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/newsblog.properties">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/newsblog.properties">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/newsblog.properties">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/newsblog.properties">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/en-US/chrome/mailnews/newsblog/newsblog.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/jar.mn">suite/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/locales/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/classic/messenger/newsblog/feed-subscriptions.css">suite/themes/classic/messenger/newsblog/feed-subscriptions.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/classic/messenger/newsblog/feed-subscriptions.css">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/classic/messenger/newsblog/feed-subscriptions.css">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/classic/messenger/newsblog/feed-subscriptions.css">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/classic/messenger/newsblog/feed-subscriptions.css">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/classic/messenger/newsblog/feed-subscriptions.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/modern/messenger/newsblog/feed-subscriptions.css">suite/themes/modern/messenger/newsblog/feed-subscriptions.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/modern/messenger/newsblog/feed-subscriptions.css">file</a> |
<a href="/comm-central/annotate/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/modern/messenger/newsblog/feed-subscriptions.css">annotate</a> |
<a href="/comm-central/diff/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/modern/messenger/newsblog/feed-subscriptions.css">diff</a> |
<a href="/comm-central/comparison/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/modern/messenger/newsblog/feed-subscriptions.css">comparison</a> |
<a href="/comm-central/log/71e65bd6dbd50bcbbe0b3bd0480e347cc616f13b/suite/themes/modern/messenger/newsblog/feed-subscriptions.css">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1">deleted file mode 100644</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger-newsblog/am-newsblog.properties</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineplus">+++ /dev/null</span>
<a href="#l1.4"></a><span id="l1.4" class="difflineat">@@ -1,2 +0,0 @@</span>
<a href="#l1.5"></a><span id="l1.5" class="difflineminus">-## Strings used in the Account Manager</span>
<a href="#l1.6"></a><span id="l1.6" class="difflineminus">-prefPanel-newsblog=Feed Settings</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1">deleted file mode 100644</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger-newsblog/feed-properties.dtd</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineplus">+++ /dev/null</span>
<a href="#l2.4"></a><span id="l2.4" class="difflineat">@@ -1,19 +0,0 @@</span>
<a href="#l2.5"></a><span id="l2.5" class="difflineminus">-&lt;!-- Feed Properties Dialog --&gt;</span>
<a href="#l2.6"></a><span id="l2.6" class="difflineminus">-&lt;!ENTITY window.title             &quot;Feed Properties&quot;&gt;</span>
<a href="#l2.7"></a><span id="l2.7" class="difflineminus">-</span>
<a href="#l2.8"></a><span id="l2.8" class="difflineminus">-&lt;!ENTITY feedFolder.label         &quot;Store Articles in: &quot;&gt;</span>
<a href="#l2.9"></a><span id="l2.9" class="difflineminus">-&lt;!ENTITY feedFolder.accesskey     &quot;S&quot;&gt;</span>
<a href="#l2.10"></a><span id="l2.10" class="difflineminus">-</span>
<a href="#l2.11"></a><span id="l2.11" class="difflineminus">-&lt;!ENTITY feedLocation.label       &quot;Feed URL: &quot;&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-&lt;!ENTITY feedLocation.accesskey   &quot;F&quot;&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-&lt;!ENTITY choosethisfolder.label   &quot;choose this folder&quot;&gt;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineminus">-</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineminus">-&lt;!ENTITY quickMode.label          &quot;Show the article summary instead of loading the web page&quot;&gt;</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineminus">-&lt;!ENTITY quickMode.accesskey      &quot;h&quot;&gt;</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineminus">-</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineminus">-&lt;!ENTITY copyLinkCmd.label        &quot;Copy Link Location&quot;&gt;</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineminus">-&lt;!ENTITY copyLinkCmd.accesskey    &quot;C&quot;&gt;</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineminus">-</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineminus">-&lt;!ENTITY pasteLinkCmd.label       &quot;Paste&quot;&gt;</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineminus">-&lt;!ENTITY pasteLinkCmd.accesskey   &quot;P&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,18 +1,31 @@</span>
<a href="#l3.4"></a><span id="l3.4"> &lt;!-- Subscription Dialog --&gt;</span>
<a href="#l3.5"></a><span id="l3.5" class="difflineminus">-&lt;!ENTITY feedSubscriptions.label &quot;Feed Subscriptions&quot;&gt;</span>
<a href="#l3.6"></a><span id="l3.6" class="difflineminus">-&lt;!ENTITY subscriptionDesc.label &quot;Note: Removing or changing the folder for a feed will not affect previously downloaded articles.&quot;&gt;</span>
<a href="#l3.7"></a><span id="l3.7" class="difflineminus">-&lt;!ENTITY feedTitle.label &quot;Title:&quot;&gt;</span>
<a href="#l3.8"></a><span id="l3.8" class="difflineminus">-&lt;!ENTITY location.label  &quot;Location:&quot;&gt;</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineplus">+&lt;!ENTITY feedSubscriptions.label     &quot;Feed Subscriptions&quot;&gt;</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineplus">+&lt;!ENTITY subscriptionDesc.label      &quot;Note: Removing or changing the folder for a feed will not affect previously downloaded articles.&quot;&gt;</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineplus">+</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+&lt;!ENTITY feedTitle.label             &quot;Title:&quot;&gt;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+&lt;!ENTITY feedTitle.accesskey         &quot;T&quot;&gt;</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+&lt;!ENTITY feedLocation.label          &quot;Feed URL:&quot;&gt;</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+&lt;!ENTITY feedLocation.accesskey      &quot;U&quot;&gt;</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+&lt;!ENTITY feedLocation.placeholder    &quot;Enter a valid feed url to Add&quot;&gt;</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+&lt;!ENTITY feedFolder.label            &quot;Store Articles in:&quot;&gt;</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+&lt;!ENTITY feedFolder.accesskey        &quot;S&quot;&gt;</span>
<a href="#l3.21"></a><span id="l3.21"> </span>
<a href="#l3.22"></a><span id="l3.22" class="difflineminus">-&lt;!ENTITY button.addFeed.label       &quot;Add&quot;&gt;</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineminus">-&lt;!ENTITY button.addFeed.accesskey   &quot;A&quot;&gt;</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineminus">-&lt;!ENTITY button.editFeed.label      &quot;Edit&quot;&gt;</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineminus">-&lt;!ENTITY button.editFeed.accesskey  &quot;E&quot;&gt;</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineminus">-&lt;!ENTITY button.removeFeed.label &quot;Remove&quot;&gt;</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineminus">-&lt;!ENTITY button.removeFeed.accesskey   &quot;R&quot;&gt;</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineminus">-&lt;!ENTITY button.importOPML.label &quot;Import&quot;&gt;</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineminus">-&lt;!ENTITY button.importOPML.accesskey   &quot;I&quot;&gt;</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-&lt;!ENTITY button.exportOPML.label &quot;Export&quot;&gt;</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-&lt;!ENTITY button.exportOPML.accesskey   &quot;X&quot;&gt;</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+&lt;!ENTITY quickMode.label             &quot;Show the article summary instead of loading the web page&quot;&gt;</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+&lt;!ENTITY quickMode.accesskey         &quot;h&quot;&gt;</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineplus">+</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+&lt;!ENTITY validateText.label          &quot;Check validation and retrieve a valid url.&quot;&gt;</span>
<a href="#l3.36"></a><span id="l3.36"> </span>
<a href="#l3.37"></a><span id="l3.37" class="difflineminus">-&lt;!ENTITY cmd.close.commandKey             &quot;w&quot;&gt;</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+&lt;!ENTITY button.addFeed.label        &quot;Add&quot;&gt;</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineplus">+&lt;!ENTITY button.addFeed.accesskey    &quot;A&quot;&gt;</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineplus">+&lt;!ENTITY button.editFeed.label       &quot;Update&quot;&gt;</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineplus">+&lt;!ENTITY button.editFeed.accesskey   &quot;U&quot;&gt;</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineplus">+&lt;!ENTITY button.removeFeed.label     &quot;Remove&quot;&gt;</span>
<a href="#l3.43"></a><span id="l3.43" class="difflineplus">+&lt;!ENTITY button.removeFeed.accesskey &quot;R&quot;&gt;</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineplus">+&lt;!ENTITY button.importOPML.label     &quot;Import&quot;&gt;</span>
<a href="#l3.45"></a><span id="l3.45" class="difflineplus">+&lt;!ENTITY button.importOPML.accesskey &quot;I&quot;&gt;</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineplus">+&lt;!ENTITY button.exportOPML.label     &quot;Export&quot;&gt;</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineplus">+&lt;!ENTITY button.exportOPML.accesskey &quot;X&quot;&gt;</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineplus">+</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineplus">+&lt;!ENTITY cmd.close.commandKey        &quot;w&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger-newsblog/newsblog.properties</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger-newsblog/newsblog.properties</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -1,14 +1,19 @@</span>
<a href="#l4.4"></a><span id="l4.4"> subscribe-validating-feed=Verifying the feed…</span>
<a href="#l4.5"></a><span id="l4.5"> subscribe-cancelSubscription=Are you sure you wish to cancel subscribing to the current feed?</span>
<a href="#l4.6"></a><span id="l4.6"> subscribe-cancelSubscriptionTitle=Subscribing to a Feed…</span>
<a href="#l4.7"></a><span id="l4.7" class="difflineminus">-subscribe-noFeedIsSelected=&lt;no feed selected&gt;</span>
<a href="#l4.8"></a><span id="l4.8"> subscribe-feedAlreadySubscribed=You already have a subscription for this feed.</span>
<a href="#l4.9"></a><span id="l4.9"> subscribe-errorOpeningFile=Could not open the file.</span>
<a href="#l4.10"></a><span id="l4.10" class="difflineplus">+subscribe-feedAdded=Feed added.</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineplus">+subscribe-feedUpdated=Feed updated.</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+subscribe-feedMoved=Feed subscription moved.</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+subscribe-feedRemoved=Feed unsubscribed.</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+subscribe-feedNotValid=The Feed URL is not a valid feed.</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+subscribe-networkError=The Feed URL could not be found. Please check the name and try again.</span>
<a href="#l4.16"></a><span id="l4.16"> </span>
<a href="#l4.17"></a><span id="l4.17"> subscribe-OPMLImportTitle=Select OPML file to import</span>
<a href="#l4.18"></a><span id="l4.18"> subscribe-OPMLExportTitle=Export feeds as an OPML file</span>
<a href="#l4.19"></a><span id="l4.19"> ## LOCALIZATION NOTE(subscribe-OPMLExportFileDialogTitle): %S is the brandShortName</span>
<a href="#l4.20"></a><span id="l4.20"> subscribe-OPMLExportFileDialogTitle=%S OPML Export</span>
<a href="#l4.21"></a><span id="l4.21"> ## LOCALIZATION NOTE(subscribe-OPMLExportDefaultFileName): %S is the brandShortName</span>
<a href="#l4.22"></a><span id="l4.22"> subscribe-OPMLExportDefaultFileName=My%SFeeds.opml</span>
<a href="#l4.23"></a><span id="l4.23"> ## LOCALIZATION NOTE(subscribe-OPMLImportInvalidFile): %S is the name of the OPML file the user tried to import.</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineat">@@ -27,18 +32,16 @@ subscribe-confirmFeedDeletionTitle=Remov</span>
<a href="#l4.25"></a><span id="l4.25"> subscribe-confirmFeedDeletion=Are you sure you want to unsubscribe from the feed: \n %S?</span>
<a href="#l4.26"></a><span id="l4.26"> </span>
<a href="#l4.27"></a><span id="l4.27"> ## LOCALIZATION NOTE(subscribe-gettingFeedItems):</span>
<a href="#l4.28"></a><span id="l4.28"> ##  - The first %S is the number of articles processed so far;</span>
<a href="#l4.29"></a><span id="l4.29"> ##  - The second %S is the total number of items</span>
<a href="#l4.30"></a><span id="l4.30"> subscribe-gettingFeedItems=Downloading feed articles (%S of %S)…</span>
<a href="#l4.31"></a><span id="l4.31"> </span>
<a href="#l4.32"></a><span id="l4.32"> newsblog-noNewArticlesForFeed=There are no new articles for this feed.</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineminus">-newsblog-networkErrorTitle=Network Error</span>
<a href="#l4.34"></a><span id="l4.34"> ## LOCALIZATION NOTE(newsblog-networkError): %S is the feed URL</span>
<a href="#l4.35"></a><span id="l4.35"> newsblog-networkError=%S could not be found. Please check the name and try again.</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineminus">-newsblog-feedNotValidTitle=Invalid Feed</span>
<a href="#l4.37"></a><span id="l4.37"> ## LOCALIZATION NOTE(newsblog-feedNotValid): %S is the feed URL</span>
<a href="#l4.38"></a><span id="l4.38"> newsblog-feedNotValid=%S is not a valid feed.</span>
<a href="#l4.39"></a><span id="l4.39"> newsblog-getNewMsgsCheck=Checking feeds for new items…</span>
<a href="#l4.40"></a><span id="l4.40"> </span>
<a href="#l4.41"></a><span id="l4.41"> ## LOCALIZATION NOTE(feeds-accountname): This string should be the same as feeds.accountName in am-newsblog.dtd</span>
<a href="#l4.42"></a><span id="l4.42"> feeds-accountname=Blogs &amp; News Feeds</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/locales/jar.mn</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/locales/jar.mn</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -161,18 +161,16 @@</span>
<a href="#l5.4"></a><span id="l5.4">   locale/@AB_CD@/messenger/downloads/settingsChange.dtd                 (%chrome/overrides/settingsChange.dtd)</span>
<a href="#l5.5"></a><span id="l5.5">   locale/@AB_CD@/messenger/netError.dtd                                 (%chrome/overrides/netError.dtd)</span>
<a href="#l5.6"></a><span id="l5.6">   locale/@AB_CD@/messenger/downloadsOverlay.dtd                         (%chrome/messenger/downloadsOverlay.dtd)</span>
<a href="#l5.7"></a><span id="l5.7"> % locale messenger-mapi @AB_CD@ %locale/@AB_CD@/messenger-mapi/</span>
<a href="#l5.8"></a><span id="l5.8">   locale/@AB_CD@/messenger-mapi/mapi.properties                         (%chrome/messenger-mapi/mapi.properties)</span>
<a href="#l5.9"></a><span id="l5.9"> % locale messenger-newsblog @AB_CD@ %locale/@AB_CD@/messenger-newsblog/</span>
<a href="#l5.10"></a><span id="l5.10">   locale/@AB_CD@/messenger-newsblog/newsblog.properties                 (%chrome/messenger-newsblog/newsblog.properties)</span>
<a href="#l5.11"></a><span id="l5.11">   locale/@AB_CD@/messenger-newsblog/feed-subscriptions.dtd              (%chrome/messenger-newsblog/feed-subscriptions.dtd)</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-  locale/@AB_CD@/messenger-newsblog/feed-properties.dtd                 (%chrome/messenger-newsblog/feed-properties.dtd)</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-  locale/@AB_CD@/messenger-newsblog/am-newsblog.properties              (%chrome/messenger-newsblog/am-newsblog.properties)</span>
<a href="#l5.14"></a><span id="l5.14">   locale/@AB_CD@/messenger-newsblog/am-newsblog.dtd                     (%chrome/messenger-newsblog/am-newsblog.dtd)</span>
<a href="#l5.15"></a><span id="l5.15"> % locale messenger-smime @AB_CD@ %locale/@AB_CD@/messenger-smime/</span>
<a href="#l5.16"></a><span id="l5.16">   locale/@AB_CD@/messenger-smime/msgCompSMIMEOverlay.dtd                (%chrome/messenger-smime/msgCompSMIMEOverlay.dtd)</span>
<a href="#l5.17"></a><span id="l5.17">   locale/@AB_CD@/messenger-smime/msgCompSMIMEOverlay.properties         (%chrome/messenger-smime/msgCompSMIMEOverlay.properties)</span>
<a href="#l5.18"></a><span id="l5.18">   locale/@AB_CD@/messenger-smime/msgReadSMIMEOverlay.dtd                (%chrome/messenger-smime/msgReadSMIMEOverlay.dtd)</span>
<a href="#l5.19"></a><span id="l5.19">   locale/@AB_CD@/messenger-smime/msgReadSMIMEOverlay.properties         (%chrome/messenger-smime/msgReadSMIMEOverlay.properties)</span>
<a href="#l5.20"></a><span id="l5.20">   locale/@AB_CD@/messenger-smime/msgCompSecurityInfo.dtd                (%chrome/messenger-smime/msgCompSecurityInfo.dtd)</span>
<a href="#l5.21"></a><span id="l5.21">   locale/@AB_CD@/messenger-smime/msgCompSecurityInfo.properties         (%chrome/messenger-smime/msgCompSecurityInfo.properties)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/themes/gnomestripe/mail/newsblog/feed-subscriptions.css</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/themes/gnomestripe/mail/newsblog/feed-subscriptions.css</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -34,45 +34,28 @@</span>
<a href="#l6.4"></a><span id="l6.4">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l6.5"></a><span id="l6.5">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l6.6"></a><span id="l6.6">  *</span>
<a href="#l6.7"></a><span id="l6.7">  * ***** END LICENSE BLOCK ****** */</span>
<a href="#l6.8"></a><span id="l6.8"> </span>
<a href="#l6.9"></a><span id="l6.9"> /* ::::: Feed Subscription styling :::::: */</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11"> #subscriptionsDialog {</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+  width: 40em;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+  height: 30em;</span>
<a href="#l6.14"></a><span id="l6.14">   padding: 0px;</span>
<a href="#l6.15"></a><span id="l6.15"> }</span>
<a href="#l6.16"></a><span id="l6.16"> </span>
<a href="#l6.17"></a><span id="l6.17"> #contentPane {</span>
<a href="#l6.18"></a><span id="l6.18">   margin: 9px 8px 5px;</span>
<a href="#l6.19"></a><span id="l6.19"> }</span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol) {</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-pane.png&quot;);</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineminus">-  -moz-image-region: rect(128px 16px 144px 0px);</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineplus">+#rssFeedInfoBox {</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineplus">+  border: 1px solid ThreeDShadow;</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineplus">+  margin: 4px;</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineplus">+  padding-top: 4px;</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineplus">+  background-color: #EAE8E4;</span>
<a href="#l6.29"></a><span id="l6.29"> }</span>
<a href="#l6.30"></a><span id="l6.30"> </span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol, container) {</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineminus">-  background-position: center center;</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineminus">-  background-repeat: no-repeat;</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineminus">-  background-color: transparent;</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineminus">-  background-attachment: scroll;</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineminus">-  background-clip: border-box;</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineminus">-  -moz-background-inline-policy: continuous;</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineminus">-  -moz-background-origin: border;</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineminus">-  background-image: url(&quot;moz-icon://stock/gtk-directory?size=menu&quot;);</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-blank.png&quot;);</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineminus">-</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineminus">-  -moz-margin-end: 2px;</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineplus">+#statusContainerBox {</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+  height: 24px;</span>
<a href="#l6.45"></a><span id="l6.45"> }</span>
<a href="#l6.46"></a><span id="l6.46"> </span>
<a href="#l6.47"></a><span id="l6.47" class="difflineminus">-#rssFeedInfoBox {</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineminus">-  border: 1px solid ThreeDShadow;</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineminus">-  border-radius: 0px;</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-  margin: 4px;</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineminus">-  padding: 0px;</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineminus">-}</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineminus">-</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineminus">-#backgroundBox {</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineminus">-  background-color: #FFFFFF;</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineminus">-  opacity: 0.5;</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/themes/pinstripe/mail/newsblog/feed-subscriptions.css</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/themes/pinstripe/mail/newsblog/feed-subscriptions.css</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -31,34 +31,26 @@</span>
<a href="#l7.4"></a><span id="l7.4">  * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l7.5"></a><span id="l7.5">  * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l7.6"></a><span id="l7.6">  * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l7.7"></a><span id="l7.7">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l7.8"></a><span id="l7.8">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l7.9"></a><span id="l7.9">  *</span>
<a href="#l7.10"></a><span id="l7.10">  * ***** END LICENSE BLOCK ****** */</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-/* ::::: Feed Subscription UI icons :::::: */</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+/* ::::: Feed Subscription styling :::::: */</span>
<a href="#l7.14"></a><span id="l7.14"> </span>
<a href="#l7.15"></a><span id="l7.15"> #subscriptionsDialog { </span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+  width: 40em;</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+  height: 30em;</span>
<a href="#l7.18"></a><span id="l7.18">   padding: 14px;</span>
<a href="#l7.19"></a><span id="l7.19"> }</span>
<a href="#l7.20"></a><span id="l7.20"> </span>
<a href="#l7.21"></a><span id="l7.21" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol) {</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineminus">-  -moz-margin-end: 2px;</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-newsgroup.png&quot;);</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineminus">-}</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineminus">-</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol, container) {</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-closed.png&quot;);</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineminus">-}</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineminus">-</span>
<a href="#l7.30"></a><span id="l7.30"> #rssFeedInfoBox {</span>
<a href="#l7.31"></a><span id="l7.31">   border: 1px solid ThreeDShadow;</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineminus">-  border-radius: 0px;</span>
<a href="#l7.33"></a><span id="l7.33">   margin: 4px;</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineminus">-  padding: 0px;</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineplus">+  padding-top: 4px;</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+  background-color: #EAE8E4;</span>
<a href="#l7.37"></a><span id="l7.37"> }</span>
<a href="#l7.38"></a><span id="l7.38"> </span>
<a href="#l7.39"></a><span id="l7.39" class="difflineminus">-#backgroundBox {</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineminus">-  background-color: #FFFFFF; </span>
<a href="#l7.41"></a><span id="l7.41" class="difflineminus">-  opacity: 0.5;</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+#statusContainerBox {</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineplus">+  height: 24px;</span>
<a href="#l7.44"></a><span id="l7.44"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/themes/qute/mail/newsblog/feed-subscriptions.css</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/themes/qute/mail/newsblog/feed-subscriptions.css</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -31,44 +31,30 @@</span>
<a href="#l8.4"></a><span id="l8.4">  * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l8.5"></a><span id="l8.5">  * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l8.6"></a><span id="l8.6">  * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l8.7"></a><span id="l8.7">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l8.8"></a><span id="l8.8">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l8.9"></a><span id="l8.9">  *</span>
<a href="#l8.10"></a><span id="l8.10">  * ***** END LICENSE BLOCK ****** */</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-/* ::::: Feed Subscription UI icons :::::: */</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+/* ::::: Feed Subscription styling :::::: */</span>
<a href="#l8.14"></a><span id="l8.14"> </span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-#subscriptionsDialog { </span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+#subscriptionsDialog {</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+  width: 40em;</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+  height: 30em;</span>
<a href="#l8.19"></a><span id="l8.19">   padding: 0px;</span>
<a href="#l8.20"></a><span id="l8.20"> }</span>
<a href="#l8.21"></a><span id="l8.21"> </span>
<a href="#l8.22"></a><span id="l8.22"> #contentPane {</span>
<a href="#l8.23"></a><span id="l8.23">   margin: 9px 8px 5px;</span>
<a href="#l8.24"></a><span id="l8.24"> }</span>
<a href="#l8.25"></a><span id="l8.25"> </span>
<a href="#l8.26"></a><span id="l8.26" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol) {</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineminus">-  -moz-margin-end: 2px;</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger-newsblog/skin/icons/rss-feed.png&quot;);</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineminus">-  -moz-image-region: rect(0 16px 16px 0);</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineminus">-}</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol, container) {</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder.png&quot;);</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineminus">-  -moz-image-region: rect(0 16px 16px 0);</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineplus">+#rssFeedInfoBox {</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineplus">+  border: 1px solid ThreeDShadow;</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineplus">+  margin: 4px;</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+  padding-top: 4px;</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineplus">+  background-color: #EAE8E4;</span>
<a href="#l8.40"></a><span id="l8.40"> }</span>
<a href="#l8.41"></a><span id="l8.41"> </span>
<a href="#l8.42"></a><span id="l8.42" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol, container, open) {</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineminus">-  -moz-image-region: rect(0 32px 16px 16px);</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineplus">+#statusContainerBox {</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineplus">+  height: 24px;</span>
<a href="#l8.46"></a><span id="l8.46"> }</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineminus">-</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineminus">-#rssFeedInfoBox {</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineminus">-  border: 1px solid ThreeDShadow;</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineminus">-  border-radius: 0px;</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineminus">-  margin: 4px;</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineminus">-  padding: 0px;</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineminus">-}</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineminus">-</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineminus">-#backgroundBox {</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineminus">-  background-color: #FFFFFF; </span>
<a href="#l8.57"></a><span id="l8.57" class="difflineminus">-  opacity: 0.5;</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/extensions/newsblog/content/am-newsblog.xul</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/extensions/newsblog/content/am-newsblog.xul</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -111,11 +111,11 @@</span>
<a href="#l9.4"></a><span id="l9.4">               prefstring=&quot;mail.server.%serverkey%.empty_trash_on_exit&quot;/&gt;</span>
<a href="#l9.5"></a><span id="l9.5"> </span>
<a href="#l9.6"></a><span id="l9.6">     &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8">     &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l9.9"></a><span id="l9.9">       &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l9.10"></a><span id="l9.10">       &lt;button label=&quot;&amp;manageSubscriptions.label;&quot;</span>
<a href="#l9.11"></a><span id="l9.11">               accesskey=&quot;&amp;manageSubscriptions.accesskey;&quot;</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-              oncommand=&quot;openSubscriptionsDialog(null, gIncomingServer);&quot;/&gt;</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+              oncommand=&quot;openSubscriptionsDialog(gIncomingServer.rootFolder);&quot;/&gt;</span>
<a href="#l9.14"></a><span id="l9.14">     &lt;/hbox&gt;</span>
<a href="#l9.15"></a><span id="l9.15"> &lt;/page&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">deleted file mode 100644</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineminus">--- a/mailnews/extensions/newsblog/content/edittree.xml</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineplus">+++ /dev/null</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineat">@@ -1,177 +0,0 @@</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l10.6"></a><span id="l10.6" class="difflineminus">-</span>
<a href="#l10.7"></a><span id="l10.7" class="difflineminus">-&lt;bindings id=&quot;treeEditBindings&quot;</span>
<a href="#l10.8"></a><span id="l10.8" class="difflineminus">-   xmlns=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineminus">-   xmlns:xul=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineminus">-</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineminus">-  &lt;binding id=&quot;edittree&quot; extends=&quot;chrome://global/content/bindings/tree.xml#tree&quot;&gt;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-    &lt;content&gt;</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-      &lt;children includes=&quot;treecols&quot;/&gt;</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-      &lt;xul:stack flex=&quot;1&quot;&gt;</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineminus">-        &lt;xul:treerows class=&quot;tree-rows&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineminus">-          &lt;children/&gt;</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineminus">-        &lt;/xul:treerows&gt;</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineminus">-        &lt;xul:textbox ileattr=&quot;text&quot; left=&quot;0&quot; top=&quot;0&quot; hidden=&quot;true&quot;/&gt;</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineminus">-      &lt;/xul:stack&gt;</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineminus">-    &lt;/content&gt;</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineminus">-    &lt;implementation&gt;</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineminus">-      &lt;field name=&quot;_editOriginalValue&quot;&gt;0&lt;/field&gt;</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineminus">-      &lt;field name=&quot;_editRow&quot;&gt;-1&lt;/field&gt;</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineminus">-      &lt;field name=&quot;_editCol&quot;&gt;null&lt;/field&gt;</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineminus">-      &lt;field name=&quot;onAccept&quot;&gt;null&lt;/field&gt;</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineminus">-      &lt;method name=&quot;setEditMode&quot;&gt;</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineminus">-        &lt;parameter name=&quot;x&quot;/&gt;</span>
<a href="#l10.28"></a><span id="l10.28" class="difflineminus">-        &lt;parameter name=&quot;y&quot;/&gt;</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineminus">-        &lt;parameter name=&quot;val&quot;/&gt;</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineminus">-          var txt = document.getAnonymousElementByAttribute(this, &quot;ileattr&quot;, &quot;text&quot;);</span>
<a href="#l10.33"></a><span id="l10.33" class="difflineminus">-          if (val){</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineminus">-            if (x &lt; 0) return;</span>
<a href="#l10.35"></a><span id="l10.35" class="difflineminus">-</span>
<a href="#l10.36"></a><span id="l10.36" class="difflineminus">-            var originalValue = this.view.getCellText(x,y);</span>
<a href="#l10.37"></a><span id="l10.37" class="difflineminus">-            var cellnode = this.getCellNodeAt(x,y);</span>
<a href="#l10.38"></a><span id="l10.38" class="difflineminus">-            if (!(cellnode || this.view.isEditable(x,y))) return;</span>
<a href="#l10.39"></a><span id="l10.39" class="difflineminus">-</span>
<a href="#l10.40"></a><span id="l10.40" class="difflineminus">-            if (this._editRow &gt;= 0) this._assignValueToCell(txt.value,true);</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineminus">-</span>
<a href="#l10.42"></a><span id="l10.42" class="difflineminus">-            if (cellnode &amp;&amp; cellnode.getAttribute(&quot;readonly&quot;)) return;</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineminus">-            txt.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineminus">-</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineminus">-            var treeBox = this.treeBoxObject;</span>
<a href="#l10.46"></a><span id="l10.46" class="difflineminus">-            var outx = {}, outy = {}, outwidth = {}, outheight = {};</span>
<a href="#l10.47"></a><span id="l10.47" class="difflineminus">-            var coords = treeBox.getCoordsForCellItem(x,y,&quot;cell&quot;,outx,outy,outwidth,outheight);</span>
<a href="#l10.48"></a><span id="l10.48" class="difflineminus">-</span>
<a href="#l10.49"></a><span id="l10.49" class="difflineminus">-            this._editRow = x;</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineminus">-            this._editCol = y;</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineminus">-</span>
<a href="#l10.52"></a><span id="l10.52" class="difflineminus">-            txt.setAttribute(&quot;left&quot;,outx.value-3);</span>
<a href="#l10.53"></a><span id="l10.53" class="difflineminus">-            txt.setAttribute(&quot;top&quot;,outy.value-3);</span>
<a href="#l10.54"></a><span id="l10.54" class="difflineminus">-            txt.setAttribute(&quot;height&quot;,outheight.value);</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineminus">-</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineminus">-            txt.setAttribute(&quot;width&quot;,outwidth.value - outy.value);</span>
<a href="#l10.57"></a><span id="l10.57" class="difflineminus">-</span>
<a href="#l10.58"></a><span id="l10.58" class="difflineminus">-            this._editOriginalValue = originalValue;</span>
<a href="#l10.59"></a><span id="l10.59" class="difflineminus">-            if (cellnode) cellnode.setAttribute(&quot;label&quot;,&quot;&quot;);</span>
<a href="#l10.60"></a><span id="l10.60" class="difflineminus">-            this.view.setCellText(x,y,&quot;&quot;);</span>
<a href="#l10.61"></a><span id="l10.61" class="difflineminus">-</span>
<a href="#l10.62"></a><span id="l10.62" class="difflineminus">-            txt.value = originalValue;</span>
<a href="#l10.63"></a><span id="l10.63" class="difflineminus">-            txt.select();</span>
<a href="#l10.64"></a><span id="l10.64" class="difflineminus">-            this.setAttribute(&quot;editing&quot;,&quot;true&quot;);</span>
<a href="#l10.65"></a><span id="l10.65" class="difflineminus">-</span>
<a href="#l10.66"></a><span id="l10.66" class="difflineminus">-            txt.addEventListener(&quot;keypress&quot;, this.fieldKeyDown, false);</span>
<a href="#l10.67"></a><span id="l10.67" class="difflineminus">-            txt.addEventListener(&quot;blur&quot;, this.fieldChange, true);</span>
<a href="#l10.68"></a><span id="l10.68" class="difflineminus">-          }</span>
<a href="#l10.69"></a><span id="l10.69" class="difflineminus">-          else {</span>
<a href="#l10.70"></a><span id="l10.70" class="difflineminus">-            this.removeAttribute(&quot;editing&quot;);</span>
<a href="#l10.71"></a><span id="l10.71" class="difflineminus">-</span>
<a href="#l10.72"></a><span id="l10.72" class="difflineminus">-            txt.setAttribute(&quot;hidden&quot;,&quot;true&quot;);</span>
<a href="#l10.73"></a><span id="l10.73" class="difflineminus">-            txt.removeEventListener(&quot;keypress&quot;, this.fieldKeyDown, false);</span>
<a href="#l10.74"></a><span id="l10.74" class="difflineminus">-            txt.removeEventListener(&quot;blur&quot;, this.fieldChange, true);</span>
<a href="#l10.75"></a><span id="l10.75" class="difflineminus">-            txt.blur();</span>
<a href="#l10.76"></a><span id="l10.76" class="difflineminus">-          }</span>
<a href="#l10.77"></a><span id="l10.77" class="difflineminus">-        ]]&gt;</span>
<a href="#l10.78"></a><span id="l10.78" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l10.79"></a><span id="l10.79" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l10.80"></a><span id="l10.80" class="difflineminus">-      &lt;method name=&quot;getCellNodeAt&quot;&gt;</span>
<a href="#l10.81"></a><span id="l10.81" class="difflineminus">-        &lt;parameter name=&quot;row&quot;/&gt;</span>
<a href="#l10.82"></a><span id="l10.82" class="difflineminus">-        &lt;parameter name=&quot;col&quot;/&gt;</span>
<a href="#l10.83"></a><span id="l10.83" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l10.84"></a><span id="l10.84" class="difflineminus">-          var view;</span>
<a href="#l10.85"></a><span id="l10.85" class="difflineminus">-          try {</span>
<a href="#l10.86"></a><span id="l10.86" class="difflineminus">-            view = this.contentView;</span>
<a href="#l10.87"></a><span id="l10.87" class="difflineminus">-          } catch (ex){}</span>
<a href="#l10.88"></a><span id="l10.88" class="difflineminus">-          if (view){</span>
<a href="#l10.89"></a><span id="l10.89" class="difflineminus">-            var elem = view.getItemAtIndex(row);</span>
<a href="#l10.90"></a><span id="l10.90" class="difflineminus">-            if (elem){</span>
<a href="#l10.91"></a><span id="l10.91" class="difflineminus">-              var pos = ((document.getElementById(col).ordinal - 1) &gt;&gt; 1);</span>
<a href="#l10.92"></a><span id="l10.92" class="difflineminus">-              return elem.firstChild.childNodes[pos];</span>
<a href="#l10.93"></a><span id="l10.93" class="difflineminus">-            }</span>
<a href="#l10.94"></a><span id="l10.94" class="difflineminus">-          }</span>
<a href="#l10.95"></a><span id="l10.95" class="difflineminus">-          return null;</span>
<a href="#l10.96"></a><span id="l10.96" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l10.97"></a><span id="l10.97" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l10.98"></a><span id="l10.98" class="difflineminus">-      &lt;method name=&quot;fieldKeyDown&quot;&gt;</span>
<a href="#l10.99"></a><span id="l10.99" class="difflineminus">-        &lt;parameter name=&quot;aEvent&quot;/&gt;</span>
<a href="#l10.100"></a><span id="l10.100" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l10.101"></a><span id="l10.101" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l10.102"></a><span id="l10.102" class="difflineminus">-          var tree = aEvent.target;</span>
<a href="#l10.103"></a><span id="l10.103" class="difflineminus">-          while (tree &amp;&amp; tree.tagName != &quot;tree&quot;) tree = tree.parentNode;</span>
<a href="#l10.104"></a><span id="l10.104" class="difflineminus">-          if (aEvent.keyCode == 13){</span>
<a href="#l10.105"></a><span id="l10.105" class="difflineminus">-            tree._assignValueToCell(this.value,true);</span>
<a href="#l10.106"></a><span id="l10.106" class="difflineminus">-          }</span>
<a href="#l10.107"></a><span id="l10.107" class="difflineminus">-          if (aEvent.keyCode == 27){</span>
<a href="#l10.108"></a><span id="l10.108" class="difflineminus">-            tree._assignValueToCell(tree._editOriginalValue,false);</span>
<a href="#l10.109"></a><span id="l10.109" class="difflineminus">-          }</span>
<a href="#l10.110"></a><span id="l10.110" class="difflineminus">-          aEvent.stopPropagation();</span>
<a href="#l10.111"></a><span id="l10.111" class="difflineminus">-        ]]&gt;</span>
<a href="#l10.112"></a><span id="l10.112" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l10.113"></a><span id="l10.113" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l10.114"></a><span id="l10.114" class="difflineminus">-      &lt;method name=&quot;_assignValueToCell&quot;&gt;</span>
<a href="#l10.115"></a><span id="l10.115" class="difflineminus">-        &lt;parameter name=&quot;value&quot;/&gt;</span>
<a href="#l10.116"></a><span id="l10.116" class="difflineminus">-        &lt;parameter name=&quot;acceptMode&quot;/&gt;</span>
<a href="#l10.117"></a><span id="l10.117" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l10.118"></a><span id="l10.118" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l10.119"></a><span id="l10.119" class="difflineminus">-          var rdf = Components</span>
<a href="#l10.120"></a><span id="l10.120" class="difflineminus">-              .classes[&quot;@mozilla.org/rdf/rdf-service;1&quot;]</span>
<a href="#l10.121"></a><span id="l10.121" class="difflineminus">-                .getService(Components.interfaces.nsIRDFService);</span>
<a href="#l10.122"></a><span id="l10.122" class="difflineminus">-          if (this._editRow == -1) return;</span>
<a href="#l10.123"></a><span id="l10.123" class="difflineminus">-          if (acceptMode &amp;&amp; this.onAccept &amp;&amp;</span>
<a href="#l10.124"></a><span id="l10.124" class="difflineminus">-              this.onAccept(this._editRow,this._editCol,this._editOriginalValue,value))</span>
<a href="#l10.125"></a><span id="l10.125" class="difflineminus">-            return;</span>
<a href="#l10.126"></a><span id="l10.126" class="difflineminus">-</span>
<a href="#l10.127"></a><span id="l10.127" class="difflineminus">-          var cellnode = this.getCellNodeAt(this._editRow,this._editCol);</span>
<a href="#l10.128"></a><span id="l10.128" class="difflineminus">-          if (cellnode) {</span>
<a href="#l10.129"></a><span id="l10.129" class="difflineminus">-              cellnode.setAttribute(&quot;label&quot;, value);</span>
<a href="#l10.130"></a><span id="l10.130" class="difflineminus">-</span>
<a href="#l10.131"></a><span id="l10.131" class="difflineminus">-              var item = cellnode;</span>
<a href="#l10.132"></a><span id="l10.132" class="difflineminus">-              while (item &amp;&amp; item.tagName != &quot;treeitem&quot;)</span>
<a href="#l10.133"></a><span id="l10.133" class="difflineminus">-                  item = item.parentNode;</span>
<a href="#l10.134"></a><span id="l10.134" class="difflineminus">-  </span>
<a href="#l10.135"></a><span id="l10.135" class="difflineminus">-              if (this._editCol == &quot;subs-name-column&quot;) {</span>
<a href="#l10.136"></a><span id="l10.136" class="difflineminus">-                  updateTitle(item.id, value);</span>
<a href="#l10.137"></a><span id="l10.137" class="difflineminus">-              }</span>
<a href="#l10.138"></a><span id="l10.138" class="difflineminus">-              else if (this._editCol == &quot;subs-url-column&quot;) {</span>
<a href="#l10.139"></a><span id="l10.139" class="difflineminus">-                  updateURL(item.id, value);</span>
<a href="#l10.140"></a><span id="l10.140" class="difflineminus">-              }</span>
<a href="#l10.141"></a><span id="l10.141" class="difflineminus">-          }</span>
<a href="#l10.142"></a><span id="l10.142" class="difflineminus">-</span>
<a href="#l10.143"></a><span id="l10.143" class="difflineminus">-          this.view.setCellText(this._editRow,this._editCol,value);</span>
<a href="#l10.144"></a><span id="l10.144" class="difflineminus">-          this.treeBoxObject.invalidateCell(this._editRow,this._editCol);</span>
<a href="#l10.145"></a><span id="l10.145" class="difflineminus">-          this._editRow = -1;</span>
<a href="#l10.146"></a><span id="l10.146" class="difflineminus">-          this._editCol = null;</span>
<a href="#l10.147"></a><span id="l10.147" class="difflineminus">-          this.builder.rebuild();</span>
<a href="#l10.148"></a><span id="l10.148" class="difflineminus">-</span>
<a href="#l10.149"></a><span id="l10.149" class="difflineminus">-          this.setEditMode(&quot;normal&quot;);</span>
<a href="#l10.150"></a><span id="l10.150" class="difflineminus">-        ]]&gt;</span>
<a href="#l10.151"></a><span id="l10.151" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l10.152"></a><span id="l10.152" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l10.153"></a><span id="l10.153" class="difflineminus">-      &lt;method name=&quot;fieldChange&quot;&gt;</span>
<a href="#l10.154"></a><span id="l10.154" class="difflineminus">-        &lt;parameter name=&quot;aEvent&quot;/&gt;</span>
<a href="#l10.155"></a><span id="l10.155" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l10.156"></a><span id="l10.156" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l10.157"></a><span id="l10.157" class="difflineminus">-          var tree = aEvent.target;</span>
<a href="#l10.158"></a><span id="l10.158" class="difflineminus">-          while (tree &amp;&amp; tree.tagName != &quot;tree&quot;) tree = tree.parentNode;</span>
<a href="#l10.159"></a><span id="l10.159" class="difflineminus">-          tree._assignValueToCell(this.value,true);</span>
<a href="#l10.160"></a><span id="l10.160" class="difflineminus">-        ]]&gt;</span>
<a href="#l10.161"></a><span id="l10.161" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l10.162"></a><span id="l10.162" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l10.163"></a><span id="l10.163" class="difflineminus">-    &lt;/implementation&gt;</span>
<a href="#l10.164"></a><span id="l10.164" class="difflineminus">-    &lt;handlers&gt;</span>
<a href="#l10.165"></a><span id="l10.165" class="difflineminus">-      &lt;handler event=&quot;click&quot; clickcount=&quot;2&quot; phase=&quot;capturing&quot;&gt;</span>
<a href="#l10.166"></a><span id="l10.166" class="difflineminus">-      &lt;![CDATA[</span>
<a href="#l10.167"></a><span id="l10.167" class="difflineminus">-        var treeBox = this.treeBoxObject;</span>
<a href="#l10.168"></a><span id="l10.168" class="difflineminus">-        var row = {};</span>
<a href="#l10.169"></a><span id="l10.169" class="difflineminus">-        var col = {};</span>
<a href="#l10.170"></a><span id="l10.170" class="difflineminus">-        var obj = {};</span>
<a href="#l10.171"></a><span id="l10.171" class="difflineminus">-        if(row.value != -1) {</span>
<a href="#l10.172"></a><span id="l10.172" class="difflineminus">-          event.stopPropagation();</span>
<a href="#l10.173"></a><span id="l10.173" class="difflineminus">-          treeBox.getCellAt(event.clientX,event.clientY,row,col,obj);</span>
<a href="#l10.174"></a><span id="l10.174" class="difflineminus">-          this.setEditMode(row.value,col.value,true);</span>
<a href="#l10.175"></a><span id="l10.175" class="difflineminus">-        }</span>
<a href="#l10.176"></a><span id="l10.176" class="difflineminus">-      ]]&gt;</span>
<a href="#l10.177"></a><span id="l10.177" class="difflineminus">-      &lt;/handler&gt;</span>
<a href="#l10.178"></a><span id="l10.178" class="difflineminus">-    &lt;/handlers&gt;</span>
<a href="#l10.179"></a><span id="l10.179" class="difflineminus">-  &lt;/binding&gt;</span>
<a href="#l10.180"></a><span id="l10.180" class="difflineminus">-</span>
<a href="#l10.181"></a><span id="l10.181" class="difflineminus">-&lt;/bindings&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">deleted file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- a/mailnews/extensions/newsblog/content/feed-properties.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ /dev/null</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -1,112 +0,0 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineminus">-/* -*- Mode: Java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineminus">-/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineminus">- * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineminus">- *</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineminus">- * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineminus">- * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineminus">- * the License. You may obtain a copy of the License at</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">- * http://www.mozilla.org/MPL/</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">- *</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">- * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineminus">- * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineminus">- * for the specific language governing rights and limitations under the</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineminus">- * License.</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineminus">- *</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineminus">- * The Original Code is Mozilla Mail Code.</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineminus">- *</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineminus">- * The Initial Developer of the Original Code is</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineminus">- * The Mozilla Foundation.</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineminus">- * Portions created by the Initial Developer are Copyright (C) 2004</span>
<a href="#l11.24"></a><span id="l11.24" class="difflineminus">- * the Initial Developer. All Rights Reserved.</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineminus">- *</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineminus">- * Contributor(s):</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineminus">- *   Scott MacGregor &lt;mscott@mozilla.org&gt;</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineminus">- *</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineminus">- * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l11.30"></a><span id="l11.30" class="difflineminus">- * either of the GNU General Public License Version 2 or later (the &quot;GPL&quot;),</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">- * or the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineminus">- * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineminus">- * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineminus">- * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineminus">- * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineminus">- * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineminus">- * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineminus">- * the provisions above, a recipient may use your version of this file under</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineminus">- * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineminus">- *</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineminus">- * ***** END LICENSE BLOCK ***** */</span>
<a href="#l11.42"></a><span id="l11.42" class="difflineminus">-</span>
<a href="#l11.43"></a><span id="l11.43" class="difflineminus">-function onLoad()</span>
<a href="#l11.44"></a><span id="l11.44" class="difflineminus">-{ </span>
<a href="#l11.45"></a><span id="l11.45" class="difflineminus">-  var feedLocationEl = document.getElementById('feedLocation');</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineminus">-  var rssAccountMenuItem = document.getElementById('rssAccountMenuItem');</span>
<a href="#l11.47"></a><span id="l11.47" class="difflineminus">-</span>
<a href="#l11.48"></a><span id="l11.48" class="difflineminus">-  if (window.arguments[0].feedLocation)</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineminus">-    feedLocationEl.value = window.arguments[0].feedLocation;  </span>
<a href="#l11.50"></a><span id="l11.50" class="difflineminus">-</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineminus">-  // root the location picker to the news &amp; blogs server</span>
<a href="#l11.52"></a><span id="l11.52" class="difflineminus">-  document.getElementById('selectFolder').setAttribute('ref', window.arguments[0].serverURI);</span>
<a href="#l11.53"></a><span id="l11.53" class="difflineminus">-</span>
<a href="#l11.54"></a><span id="l11.54" class="difflineminus">-  document.getElementById('selectFolder').selectedIndex = -1;</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineminus">-  SetFolderPicker(window.arguments[0].folderURI ? window.arguments[0].folderURI : window.arguments[0].serverURI, 'selectFolder');</span>
<a href="#l11.56"></a><span id="l11.56" class="difflineminus">-</span>
<a href="#l11.57"></a><span id="l11.57" class="difflineminus">-  rssAccountMenuItem.label = window.arguments[0].serverPrettyName;</span>
<a href="#l11.58"></a><span id="l11.58" class="difflineminus">-  rssAccountMenuItem.value = window.arguments[0].serverURI;</span>
<a href="#l11.59"></a><span id="l11.59" class="difflineminus">-</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineminus">-  // set quick mode value</span>
<a href="#l11.61"></a><span id="l11.61" class="difflineminus">-  document.getElementById('quickMode').checked = window.arguments[0].quickMode;</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineminus">-</span>
<a href="#l11.63"></a><span id="l11.63" class="difflineminus">-  if (!window.arguments[0].newFeed)</span>
<a href="#l11.64"></a><span id="l11.64" class="difflineminus">-  {</span>
<a href="#l11.65"></a><span id="l11.65" class="difflineminus">-    // if we are editing an existing feed, disable the top level account</span>
<a href="#l11.66"></a><span id="l11.66" class="difflineminus">-    rssAccountMenuItem.setAttribute('disabled', 'true');</span>
<a href="#l11.67"></a><span id="l11.67" class="difflineminus">-    feedLocationEl.setAttribute('readonly', true);</span>
<a href="#l11.68"></a><span id="l11.68" class="difflineminus">-    feedLocationEl.setAttribute('context', 'copyUrlPopup');</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineminus">-  }</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineminus">-  else</span>
<a href="#l11.71"></a><span id="l11.71" class="difflineminus">-    feedLocationEl.setAttribute('context', 'pasteUrlPopup');</span>
<a href="#l11.72"></a><span id="l11.72" class="difflineminus">-}</span>
<a href="#l11.73"></a><span id="l11.73" class="difflineminus">-</span>
<a href="#l11.74"></a><span id="l11.74" class="difflineminus">-function onOk()</span>
<a href="#l11.75"></a><span id="l11.75" class="difflineminus">-{</span>
<a href="#l11.76"></a><span id="l11.76" class="difflineminus">-  var feedLocation = document.getElementById('feedLocation').value;</span>
<a href="#l11.77"></a><span id="l11.77" class="difflineminus">-  // trim leading and trailing white space from the url</span>
<a href="#l11.78"></a><span id="l11.78" class="difflineminus">-  feedLocation = feedLocation.trim();</span>
<a href="#l11.79"></a><span id="l11.79" class="difflineminus">-</span>
<a href="#l11.80"></a><span id="l11.80" class="difflineminus">-  window.arguments[0].feedLocation = feedLocation;</span>
<a href="#l11.81"></a><span id="l11.81" class="difflineminus">-  window.arguments[0].folderURI = document.getElementById('selectFolder').getAttribute(&quot;uri&quot;);</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineminus">-  window.arguments[0].quickMode = document.getElementById('quickMode').checked;</span>
<a href="#l11.83"></a><span id="l11.83" class="difflineminus">-  window.arguments[0].result = true;</span>
<a href="#l11.84"></a><span id="l11.84" class="difflineminus">-</span>
<a href="#l11.85"></a><span id="l11.85" class="difflineminus">-  return true;</span>
<a href="#l11.86"></a><span id="l11.86" class="difflineminus">-}</span>
<a href="#l11.87"></a><span id="l11.87" class="difflineminus">-</span>
<a href="#l11.88"></a><span id="l11.88" class="difflineminus">-function PickedMsgFolder(selection,pickerID)</span>
<a href="#l11.89"></a><span id="l11.89" class="difflineminus">-{</span>
<a href="#l11.90"></a><span id="l11.90" class="difflineminus">-  SetFolderPicker(selection.value, pickerID);</span>
<a href="#l11.91"></a><span id="l11.91" class="difflineminus">-}   </span>
<a href="#l11.92"></a><span id="l11.92" class="difflineminus">-</span>
<a href="#l11.93"></a><span id="l11.93" class="difflineminus">-function SetFolderPicker(uri,pickerID)</span>
<a href="#l11.94"></a><span id="l11.94" class="difflineminus">-{</span>
<a href="#l11.95"></a><span id="l11.95" class="difflineminus">-  var picker = document.getElementById(pickerID);</span>
<a href="#l11.96"></a><span id="l11.96" class="difflineminus">-  var msgfolder = GetMsgFolderFromUri(uri, true);</span>
<a href="#l11.97"></a><span id="l11.97" class="difflineminus">-  if (!msgfolder) </span>
<a href="#l11.98"></a><span id="l11.98" class="difflineminus">-    return;</span>
<a href="#l11.99"></a><span id="l11.99" class="difflineminus">-</span>
<a href="#l11.100"></a><span id="l11.100" class="difflineminus">-  picker.setAttribute(&quot;label&quot;,msgfolder.name);</span>
<a href="#l11.101"></a><span id="l11.101" class="difflineminus">-  picker.setAttribute(&quot;uri&quot;,uri);</span>
<a href="#l11.102"></a><span id="l11.102" class="difflineminus">-}</span>
<a href="#l11.103"></a><span id="l11.103" class="difflineminus">-</span>
<a href="#l11.104"></a><span id="l11.104" class="difflineminus">-// CopyWebsiteAddress takes the website address title button, extracts</span>
<a href="#l11.105"></a><span id="l11.105" class="difflineminus">-// the website address we stored in there and copies it to the clipboard</span>
<a href="#l11.106"></a><span id="l11.106" class="difflineminus">-function CopyWebsiteAddress(websiteAddressNode)</span>
<a href="#l11.107"></a><span id="l11.107" class="difflineminus">-{</span>
<a href="#l11.108"></a><span id="l11.108" class="difflineminus">-  if (websiteAddressNode)</span>
<a href="#l11.109"></a><span id="l11.109" class="difflineminus">-  {</span>
<a href="#l11.110"></a><span id="l11.110" class="difflineminus">-    var websiteAddress = websiteAddressNode.value;</span>
<a href="#l11.111"></a><span id="l11.111" class="difflineminus">-    var contractid = &quot;@mozilla.org/widget/clipboardhelper;1&quot;;</span>
<a href="#l11.112"></a><span id="l11.112" class="difflineminus">-    var iid = Components.interfaces.nsIClipboardHelper;</span>
<a href="#l11.113"></a><span id="l11.113" class="difflineminus">-    var clipboard = Components.classes[contractid].getService(iid);</span>
<a href="#l11.114"></a><span id="l11.114" class="difflineminus">-    clipboard.copyString(websiteAddress);</span>
<a href="#l11.115"></a><span id="l11.115" class="difflineminus">-  }</span>
<a href="#l11.116"></a><span id="l11.116" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">deleted file mode 100644</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineminus">--- a/mailnews/extensions/newsblog/content/feed-properties.xul</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineplus">+++ /dev/null</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineat">@@ -1,146 +0,0 @@</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l12.6"></a><span id="l12.6" class="difflineminus">-# -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l12.7"></a><span id="l12.7" class="difflineminus">-# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l12.8"></a><span id="l12.8" class="difflineminus">-# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineminus">-#</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineminus">-# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l12.11"></a><span id="l12.11" class="difflineminus">-# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-# the License. You may obtain a copy of the License at</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-# http://www.mozilla.org/MPL/</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-#</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-# for the specific language governing rights and limitations under the</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-# License.</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineminus">-#</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineminus">-# The Original Code is Thunderbird RSS Feed Properties UI</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineminus">-#</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineminus">-# The Initial Developer of the Original Code is</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineminus">-# The Mozilla Foundation.</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineminus">-# Portions created by the Initial Developer are Copyright (C) 2005</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineminus">-# the Initial Developer. All Rights Reserved.</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineminus">-#</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineminus">-# Contributor(s):</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineminus">-#  Scott MacGregor &lt;mscott@mozilla.org&gt;</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineminus">-#</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineminus">-# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineminus">-# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineminus">-# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineminus">-# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineminus">-# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineminus">-# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineminus">-# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineminus">-# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineminus">-# the provisions above, a recipient may use your version of this file under</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineminus">-# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineminus">-#</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineminus">-# ***** END LICENSE BLOCK ******</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineminus">-</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l12.45"></a><span id="l12.45" class="difflineminus">-</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineminus">-&lt;!DOCTYPE dialog SYSTEM &quot;chrome://messenger-newsblog/locale/feed-properties.dtd&quot;&gt;</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineminus">-</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineminus">-&lt;dialog id=&quot;feedPropertyDialog&quot;</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineminus">-  xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineminus">-  xmlns:nc=&quot;http://home.netscape.com/NC-rdf#&quot;</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineminus">-  xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineminus">-  title=&quot;&amp;window.title;&quot;</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineminus">-#ifdef XP_MACOSX</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineminus">-  style=&quot;width: 40em;&quot;</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineminus">-#else</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineminus">-  style=&quot;width: 33em;&quot;</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineminus">-#endif</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineminus">-  buttons=&quot;accept,cancel&quot;</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineminus">-  onload=&quot;onLoad();&quot;</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineminus">-  ondialogaccept=&quot;return onOk();&quot;&gt;</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineminus">-</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;feed-properties.js&quot;/&gt;</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/widgetglue.js&quot;/&gt;</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/globalOverlay.js&quot;/&gt;</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineminus">-</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineminus">-  &lt;menupopup id=&quot;copyUrlPopup&quot; popupanchor=&quot;bottomleft&quot;&gt;</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineminus">-    &lt;menuitem label=&quot;&amp;copyLinkCmd.label;&quot; accesskey=&quot;&amp;copyLinkCmd.accesskey;&quot;</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineminus">-              oncommand=&quot;CopyWebsiteAddress(document.popupNode)&quot;/&gt;</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineminus">-  &lt;/menupopup&gt;</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineminus">-</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineminus">-  &lt;menupopup id=&quot;pasteUrlPopup&quot; popupanchor=&quot;bottomleft&quot;&gt;</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineminus">-    &lt;menuitem label=&quot;&amp;pasteLinkCmd.label;&quot; accesskey=&quot;&amp;pasteLinkCmd.accesskey;&quot;</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineminus">-              oncommand=&quot;goDoCommand('cmd_paste')&quot;/&gt;</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineminus">-  &lt;/menupopup&gt;</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineminus">-</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineminus">-  &lt;grid flex=&quot;1&quot;&gt;</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineminus">-    &lt;columns&gt;</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineminus">-      &lt;column/&gt;</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineminus">-      &lt;column  flex=&quot;1&quot;/&gt;</span>
<a href="#l12.80"></a><span id="l12.80" class="difflineminus">-    &lt;/columns&gt;</span>
<a href="#l12.81"></a><span id="l12.81" class="difflineminus">-</span>
<a href="#l12.82"></a><span id="l12.82" class="difflineminus">-    &lt;rows&gt;</span>
<a href="#l12.83"></a><span id="l12.83" class="difflineminus">-      &lt;row&gt;</span>
<a href="#l12.84"></a><span id="l12.84" class="difflineminus">-        &lt;label value=&quot;&amp;feedLocation.label;&quot; accesskey=&quot;&amp;feedLocation.accesskey;&quot; control=&quot;feedLocation&quot;/&gt;</span>
<a href="#l12.85"></a><span id="l12.85" class="difflineminus">-        &lt;textbox id=&quot;feedLocation&quot; class=&quot;uri-element&quot;/&gt;</span>
<a href="#l12.86"></a><span id="l12.86" class="difflineminus">-      &lt;/row&gt;</span>
<a href="#l12.87"></a><span id="l12.87" class="difflineminus">-</span>
<a href="#l12.88"></a><span id="l12.88" class="difflineminus">-      &lt;row&gt;</span>
<a href="#l12.89"></a><span id="l12.89" class="difflineminus">-        &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l12.90"></a><span id="l12.90" class="difflineminus">-      &lt;/row&gt;</span>
<a href="#l12.91"></a><span id="l12.91" class="difflineminus">-</span>
<a href="#l12.92"></a><span id="l12.92" class="difflineminus">-      &lt;row&gt;</span>
<a href="#l12.93"></a><span id="l12.93" class="difflineminus">-        &lt;label value=&quot;&amp;feedFolder.label;&quot; accesskey=&quot;&amp;feedFolder.accesskey;&quot; control=&quot;selectFolder&quot;/&gt;</span>
<a href="#l12.94"></a><span id="l12.94" class="difflineminus">-        &lt;menulist id=&quot;selectFolder&quot;</span>
<a href="#l12.95"></a><span id="l12.95" class="difflineminus">-              containment=&quot;http://home.netscape.com/NC-rdf#child&quot;</span>
<a href="#l12.96"></a><span id="l12.96" class="difflineminus">-              sortResource=&quot;http://home.netscape.com/NC-rdf#FolderTreeName&quot;</span>
<a href="#l12.97"></a><span id="l12.97" class="difflineminus">-              sortDirection=&quot;ascending&quot;</span>
<a href="#l12.98"></a><span id="l12.98" class="difflineminus">-              datasources=&quot;rdf:msgaccountmanager rdf:mailnewsfolders&quot;</span>
<a href="#l12.99"></a><span id="l12.99" class="difflineminus">-              ref=&quot;...&quot;&gt;</span>
<a href="#l12.100"></a><span id="l12.100" class="difflineminus">-            &lt;menupopup&gt;</span>
<a href="#l12.101"></a><span id="l12.101" class="difflineminus">-              &lt;menuitem id=&quot;rssAccountMenuItem&quot;</span>
<a href="#l12.102"></a><span id="l12.102" class="difflineminus">-                        oncommand=&quot;PickedMsgFolder(event.target, 'selectFolder')&quot;/&gt;</span>
<a href="#l12.103"></a><span id="l12.103" class="difflineminus">-              &lt;menuseparator/&gt;</span>
<a href="#l12.104"></a><span id="l12.104" class="difflineminus">-            &lt;/menupopup&gt;</span>
<a href="#l12.105"></a><span id="l12.105" class="difflineminus">-</span>
<a href="#l12.106"></a><span id="l12.106" class="difflineminus">-            &lt;template&gt;</span>
<a href="#l12.107"></a><span id="l12.107" class="difflineminus">-              &lt;!-- cheat and use the CanRename property to make sure we don't list the Trash folder as a possible feed folder --&gt;</span>
<a href="#l12.108"></a><span id="l12.108" class="difflineminus">-              &lt;rule nc:CanFileMessages=&quot;true&quot; iscontainer=&quot;true&quot; isempty=&quot;false&quot; nc:CanRename=&quot;true&quot;&gt;</span>
<a href="#l12.109"></a><span id="l12.109" class="difflineminus">-                &lt;menupopup&gt;</span>
<a href="#l12.110"></a><span id="l12.110" class="difflineminus">-                  &lt;menu uri=&quot;...&quot;</span>
<a href="#l12.111"></a><span id="l12.111" class="difflineminus">-                        class=&quot;folderMenuItem menu-iconic&quot;</span>
<a href="#l12.112"></a><span id="l12.112" class="difflineminus">-                        oncommand=&quot;PickedMsgFolder(event.target, 'selectFolder')&quot;</span>
<a href="#l12.113"></a><span id="l12.113" class="difflineminus">-                        SpecialFolder=&quot;rdf:http://home.netscape.com/NC-rdf#SpecialFolder&quot;</span>
<a href="#l12.114"></a><span id="l12.114" class="difflineminus">-                        BiffState=&quot;rdf:http://home.netscape.com/NC-rdf#BiffState&quot;</span>
<a href="#l12.115"></a><span id="l12.115" class="difflineminus">-                        IsServer=&quot;rdf:http://home.netscape.com/NC-rdf#IsServer&quot;</span>
<a href="#l12.116"></a><span id="l12.116" class="difflineminus">-                        IsSecure=&quot;rdf:http://home.netscape.com/NC-rdf#IsSecure&quot;</span>
<a href="#l12.117"></a><span id="l12.117" class="difflineminus">-                        ServerType=&quot;rdf:http://home.netscape.com/NC-rdf#ServerType&quot;</span>
<a href="#l12.118"></a><span id="l12.118" class="difflineminus">-                        label=&quot;rdf:http://home.netscape.com/NC-rdf#Name&quot;&gt;</span>
<a href="#l12.119"></a><span id="l12.119" class="difflineminus">-                    &lt;menupopup class=&quot;menulist-menupopup&quot;&gt;</span>
<a href="#l12.120"></a><span id="l12.120" class="difflineminus">-                      &lt;menuitem label=&quot;&amp;choosethisfolder.label;&quot;</span>
<a href="#l12.121"></a><span id="l12.121" class="difflineminus">-                                oncommand=&quot;PickedMsgFolder(event.target.parentNode.parentNode,'selectFolder')&quot;/&gt;</span>
<a href="#l12.122"></a><span id="l12.122" class="difflineminus">-                      &lt;menuseparator/&gt;</span>
<a href="#l12.123"></a><span id="l12.123" class="difflineminus">-                    &lt;/menupopup&gt;</span>
<a href="#l12.124"></a><span id="l12.124" class="difflineminus">-                  &lt;/menu&gt;</span>
<a href="#l12.125"></a><span id="l12.125" class="difflineminus">-                &lt;/menupopup&gt;</span>
<a href="#l12.126"></a><span id="l12.126" class="difflineminus">-              &lt;/rule&gt;</span>
<a href="#l12.127"></a><span id="l12.127" class="difflineminus">-              &lt;rule nc:CanFileMessages=&quot;true&quot; nc:CanRename=&quot;true&quot;&gt;</span>
<a href="#l12.128"></a><span id="l12.128" class="difflineminus">-                &lt;menupopup&gt;</span>
<a href="#l12.129"></a><span id="l12.129" class="difflineminus">-                     &lt;menuitem uri=&quot;...&quot; value=&quot;...&quot;</span>
<a href="#l12.130"></a><span id="l12.130" class="difflineminus">-                      class=&quot;folderMenuItem menuitem-iconic&quot;</span>
<a href="#l12.131"></a><span id="l12.131" class="difflineminus">-                      oncommand=&quot;PickedMsgFolder(event.target,'selectFolder')&quot;</span>
<a href="#l12.132"></a><span id="l12.132" class="difflineminus">-                      SpecialFolder=&quot;rdf:http://home.netscape.com/NC-rdf#SpecialFolder&quot;</span>
<a href="#l12.133"></a><span id="l12.133" class="difflineminus">-                      BiffState=&quot;rdf:http://home.netscape.com/NC-rdf#BiffState&quot;</span>
<a href="#l12.134"></a><span id="l12.134" class="difflineminus">-                      IsServer=&quot;rdf:http://home.netscape.com/NC-rdf#IsServer&quot;</span>
<a href="#l12.135"></a><span id="l12.135" class="difflineminus">-                      IsSecure=&quot;rdf:http://home.netscape.com/NC-rdf#IsSecure&quot;</span>
<a href="#l12.136"></a><span id="l12.136" class="difflineminus">-                      ServerType=&quot;rdf:http://home.netscape.com/NC-rdf#ServerType&quot;</span>
<a href="#l12.137"></a><span id="l12.137" class="difflineminus">-                      label=&quot;rdf:http://home.netscape.com/NC-rdf#Name&quot;/&gt;</span>
<a href="#l12.138"></a><span id="l12.138" class="difflineminus">-                 &lt;/menupopup&gt;</span>
<a href="#l12.139"></a><span id="l12.139" class="difflineminus">-              &lt;/rule&gt;</span>
<a href="#l12.140"></a><span id="l12.140" class="difflineminus">-            &lt;/template&gt;</span>
<a href="#l12.141"></a><span id="l12.141" class="difflineminus">-        &lt;/menulist&gt;</span>
<a href="#l12.142"></a><span id="l12.142" class="difflineminus">-      &lt;/row&gt;</span>
<a href="#l12.143"></a><span id="l12.143" class="difflineminus">-    &lt;/rows&gt;</span>
<a href="#l12.144"></a><span id="l12.144" class="difflineminus">-  &lt;/grid&gt;</span>
<a href="#l12.145"></a><span id="l12.145" class="difflineminus">-</span>
<a href="#l12.146"></a><span id="l12.146" class="difflineminus">-  &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l12.147"></a><span id="l12.147" class="difflineminus">-</span>
<a href="#l12.148"></a><span id="l12.148" class="difflineminus">-  &lt;checkbox id=&quot;quickMode&quot; accesskey=&quot;&amp;quickMode.accesskey;&quot; label=&quot;&amp;quickMode.label;&quot;/&gt;</span>
<a href="#l12.149"></a><span id="l12.149" class="difflineminus">-</span>
<a href="#l12.150"></a><span id="l12.150" class="difflineminus">-&lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/extensions/newsblog/content/feed-subscriptions.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/extensions/newsblog/content/feed-subscriptions.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -32,354 +32,555 @@</span>
<a href="#l13.4"></a><span id="l13.4"> # use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l13.5"></a><span id="l13.5"> # decision by deleting the provisions above and replace them with the notice</span>
<a href="#l13.6"></a><span id="l13.6"> # and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l13.7"></a><span id="l13.7"> # the provisions above, a recipient may use your version of this file under</span>
<a href="#l13.8"></a><span id="l13.8"> # the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l13.9"></a><span id="l13.9"> #</span>
<a href="#l13.10"></a><span id="l13.10"> # ***** END LICENSE BLOCK ******</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-const IPS = Components.interfaces.nsIPromptService;</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-const nsIDragService = Components.interfaces.nsIDragService;</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-const kRowIndexUndefined = -1;</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineplus">+var gFeedSubscriptionsWindow = {</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineplus">+  get mTree() { return document.getElementById(&quot;rssSubscriptionsList&quot;); },</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineplus">+</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineplus">+  mFeedContainers: [],</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineplus">+  mRSSServer     : null,</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineplus">+  mActionMode    : null,</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineplus">+  kSubscribeMode : 1,</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineplus">+  kUpdateMode    : 2,</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineplus">+  kMoveMode      : 3,</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineplus">+</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineplus">+  onLoad: function ()</span>
<a href="#l13.26"></a><span id="l13.26" class="difflineplus">+  {</span>
<a href="#l13.27"></a><span id="l13.27" class="difflineplus">+    // Extract the folder argument.</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineplus">+    let folder;</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineplus">+    if (window.arguments &amp;&amp; window.arguments[0].folder)</span>
<a href="#l13.30"></a><span id="l13.30" class="difflineplus">+      folder = window.arguments[0].folder;</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineplus">+</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+    this.refreshSubscriptionView(folder)</span>
<a href="#l13.33"></a><span id="l13.33"> </span>
<a href="#l13.34"></a><span id="l13.34" class="difflineminus">-var gFeedSubscriptionsWindow = {</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineminus">-  mFeedContainers   : [],</span>
<a href="#l13.36"></a><span id="l13.36" class="difflineminus">-  mTree             : null,</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineminus">-  mBundle           : null,</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineminus">-  mRSSServer        : null,</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineplus">+    let win = Services.wm.getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineplus">+    if (win)</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineplus">+    {</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineplus">+      win.FeedFolderNotificationService =</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineplus">+        Cc[&quot;@mozilla.org/messenger/msgnotificationservice;1&quot;].</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineplus">+        getService(Ci.nsIMsgFolderNotificationService);</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineplus">+      win.FeedFolderNotificationService.addListener(this.FolderListener,</span>
<a href="#l13.46"></a><span id="l13.46" class="difflineplus">+        Ci.nsIMsgFolderNotificationService.folderAdded |</span>
<a href="#l13.47"></a><span id="l13.47" class="difflineplus">+        Ci.nsIMsgFolderNotificationService.folderDeleted |</span>
<a href="#l13.48"></a><span id="l13.48" class="difflineplus">+        Ci.nsIMsgFolderNotificationService.folderRenamed |</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineplus">+        Ci.nsIMsgFolderNotificationService.folderMoveCopyCompleted);</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineplus">+    }</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+  },</span>
<a href="#l13.52"></a><span id="l13.52" class="difflineplus">+</span>
<a href="#l13.53"></a><span id="l13.53" class="difflineplus">+  onUnload: function ()</span>
<a href="#l13.54"></a><span id="l13.54" class="difflineplus">+  {</span>
<a href="#l13.55"></a><span id="l13.55" class="difflineplus">+    let dismissDialog = true;</span>
<a href="#l13.56"></a><span id="l13.56" class="difflineplus">+</span>
<a href="#l13.57"></a><span id="l13.57" class="difflineplus">+    // If we are in the middle of subscribing to a feed, inform the user that</span>
<a href="#l13.58"></a><span id="l13.58" class="difflineplus">+    // dismissing the dialog right now will abort the feed subscription.</span>
<a href="#l13.59"></a><span id="l13.59" class="difflineplus">+    if (this.mActionMode == this.kSubscribeMode)</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineplus">+    {</span>
<a href="#l13.61"></a><span id="l13.61" class="difflineplus">+      let pTitle = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.62"></a><span id="l13.62" class="difflineplus">+                     &quot;subscribe-cancelSubscriptionTitle&quot;);</span>
<a href="#l13.63"></a><span id="l13.63" class="difflineplus">+      let pMessage = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.64"></a><span id="l13.64" class="difflineplus">+                       &quot;subscribe-cancelSubscription&quot;);</span>
<a href="#l13.65"></a><span id="l13.65" class="difflineplus">+      dismissDialog =</span>
<a href="#l13.66"></a><span id="l13.66" class="difflineplus">+        !(Services.prompt.confirmEx(window, pTitle, pMessage,</span>
<a href="#l13.67"></a><span id="l13.67" class="difflineplus">+                                    Ci.nsIPromptService.STD_YES_NO_BUTTONS,</span>
<a href="#l13.68"></a><span id="l13.68" class="difflineplus">+                                    null, null, null, null, { }));</span>
<a href="#l13.69"></a><span id="l13.69" class="difflineplus">+    }</span>
<a href="#l13.70"></a><span id="l13.70" class="difflineplus">+</span>
<a href="#l13.71"></a><span id="l13.71" class="difflineplus">+    if (dismissDialog)</span>
<a href="#l13.72"></a><span id="l13.72" class="difflineplus">+    {</span>
<a href="#l13.73"></a><span id="l13.73" class="difflineplus">+      let win = Services.wm.getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l13.74"></a><span id="l13.74" class="difflineplus">+      if (win)</span>
<a href="#l13.75"></a><span id="l13.75" class="difflineplus">+        delete win.FeedFolderNotificationService;</span>
<a href="#l13.76"></a><span id="l13.76" class="difflineplus">+    }</span>
<a href="#l13.77"></a><span id="l13.77"> </span>
<a href="#l13.78"></a><span id="l13.78" class="difflineminus">-  init: function ()</span>
<a href="#l13.79"></a><span id="l13.79" class="difflineminus">-  {  </span>
<a href="#l13.80"></a><span id="l13.80" class="difflineminus">-    // extract the server argument</span>
<a href="#l13.81"></a><span id="l13.81" class="difflineminus">-    if (window.arguments[0].server)</span>
<a href="#l13.82"></a><span id="l13.82" class="difflineminus">-      this.mRSSServer = window.arguments[0].server;</span>
<a href="#l13.83"></a><span id="l13.83" class="difflineplus">+    return dismissDialog;</span>
<a href="#l13.84"></a><span id="l13.84" class="difflineplus">+  },</span>
<a href="#l13.85"></a><span id="l13.85"> </span>
<a href="#l13.86"></a><span id="l13.86" class="difflineminus">-    var docshell = window.QueryInterface(Components.interfaces.nsIInterfaceRequestor)</span>
<a href="#l13.87"></a><span id="l13.87" class="difflineminus">-                        .getInterface(Components.interfaces.nsIWebNavigation)</span>
<a href="#l13.88"></a><span id="l13.88" class="difflineminus">-                        .QueryInterface(Components.interfaces.nsIDocShell);        </span>
<a href="#l13.89"></a><span id="l13.89" class="difflineminus">-    docshell.allowAuth = true;</span>
<a href="#l13.90"></a><span id="l13.90" class="difflineplus">+  refreshSubscriptionView: function(aSelectFolder)</span>
<a href="#l13.91"></a><span id="l13.91" class="difflineplus">+  {</span>
<a href="#l13.92"></a><span id="l13.92" class="difflineplus">+    let item = this.mView.currentItem;</span>
<a href="#l13.93"></a><span id="l13.93" class="difflineplus">+    let firstVisRow, lastVisRow, curFirstVisRow;</span>
<a href="#l13.94"></a><span id="l13.94" class="difflineplus">+    if (this.mView.treeBox)</span>
<a href="#l13.95"></a><span id="l13.95" class="difflineplus">+      firstVisRow = this.mView.treeBox.getFirstVisibleRow();</span>
<a href="#l13.96"></a><span id="l13.96" class="difflineplus">+    this.loadSubscriptions();</span>
<a href="#l13.97"></a><span id="l13.97" class="difflineplus">+    this.mTree.view = this.mView;</span>
<a href="#l13.98"></a><span id="l13.98" class="difflineplus">+    if (aSelectFolder)</span>
<a href="#l13.99"></a><span id="l13.99" class="difflineplus">+      // Ensure dialog is fully loaded before selecting, to get visible row.</span>
<a href="#l13.100"></a><span id="l13.100" class="difflineplus">+      setTimeout(function() {</span>
<a href="#l13.101"></a><span id="l13.101" class="difflineplus">+        gFeedSubscriptionsWindow.selectFolder(aSelectFolder);</span>
<a href="#l13.102"></a><span id="l13.102" class="difflineplus">+      }, 0);</span>
<a href="#l13.103"></a><span id="l13.103" class="difflineplus">+    else</span>
<a href="#l13.104"></a><span id="l13.104" class="difflineplus">+    {</span>
<a href="#l13.105"></a><span id="l13.105" class="difflineplus">+      // If no folder to select, try to select the pre rebuild selection, in</span>
<a href="#l13.106"></a><span id="l13.106" class="difflineplus">+      // an existing window.  For folderpane changes in a feed account.</span>
<a href="#l13.107"></a><span id="l13.107" class="difflineplus">+      if (item)</span>
<a href="#l13.108"></a><span id="l13.108" class="difflineplus">+      {</span>
<a href="#l13.109"></a><span id="l13.109" class="difflineplus">+        if (item.container)</span>
<a href="#l13.110"></a><span id="l13.110" class="difflineplus">+        {</span>
<a href="#l13.111"></a><span id="l13.111" class="difflineplus">+          if (!this.selectFolder(item.folder))</span>
<a href="#l13.112"></a><span id="l13.112" class="difflineplus">+            // The item no longer exists, an ancestor folder was deleted or</span>
<a href="#l13.113"></a><span id="l13.113" class="difflineplus">+            // renamed/moved.</span>
<a href="#l13.114"></a><span id="l13.114" class="difflineplus">+            this.selectFolder(item.folder.rootFolder);</span>
<a href="#l13.115"></a><span id="l13.115" class="difflineplus">+        }</span>
<a href="#l13.116"></a><span id="l13.116" class="difflineplus">+        else</span>
<a href="#l13.117"></a><span id="l13.117" class="difflineplus">+        {</span>
<a href="#l13.118"></a><span id="l13.118" class="difflineplus">+          // If selecting a prior selected feed, get its folder from the db</span>
<a href="#l13.119"></a><span id="l13.119" class="difflineplus">+          // in case an ancestor folder was renamed/moved.</span>
<a href="#l13.120"></a><span id="l13.120" class="difflineplus">+          let itemResource = rdf.GetResource(item.url);</span>
<a href="#l13.121"></a><span id="l13.121" class="difflineplus">+          let ds = getSubscriptionsDS(item.parentFolder.server);</span>
<a href="#l13.122"></a><span id="l13.122" class="difflineplus">+          let itemFolder = ds.GetTarget(itemResource, FZ_DESTFOLDER, true);</span>
<a href="#l13.123"></a><span id="l13.123" class="difflineplus">+          if (itemFolder)</span>
<a href="#l13.124"></a><span id="l13.124" class="difflineplus">+          {</span>
<a href="#l13.125"></a><span id="l13.125" class="difflineplus">+            itemFolder = itemFolder.QueryInterface(Ci.nsIMsgFolder);</span>
<a href="#l13.126"></a><span id="l13.126" class="difflineplus">+            this.selectFeed({folder: itemFolder, url: item.url}, null);</span>
<a href="#l13.127"></a><span id="l13.127" class="difflineplus">+          }</span>
<a href="#l13.128"></a><span id="l13.128" class="difflineplus">+          else</span>
<a href="#l13.129"></a><span id="l13.129" class="difflineplus">+            // The item no longer exists, an ancestor folder was deleted.</span>
<a href="#l13.130"></a><span id="l13.130" class="difflineplus">+            this.selectFolder(item.parentFolder.rootFolder);</span>
<a href="#l13.131"></a><span id="l13.131" class="difflineplus">+        }</span>
<a href="#l13.132"></a><span id="l13.132"> </span>
<a href="#l13.133"></a><span id="l13.133" class="difflineminus">-    this.mTree = document.getElementById(&quot;rssSubscriptionsList&quot;);</span>
<a href="#l13.134"></a><span id="l13.134" class="difflineminus">-    this.mBundle = document.getElementById(&quot;bundle_newsblog&quot;);</span>
<a href="#l13.135"></a><span id="l13.135" class="difflineminus">-</span>
<a href="#l13.136"></a><span id="l13.136" class="difflineminus">-    this.loadSubscriptions();</span>
<a href="#l13.137"></a><span id="l13.137" class="difflineminus">-    this.mTree.treeBoxObject.view = this.mView;</span>
<a href="#l13.138"></a><span id="l13.138" class="difflineminus">-</span>
<a href="#l13.139"></a><span id="l13.139" class="difflineminus">-    if (window.arguments[0].folder)</span>
<a href="#l13.140"></a><span id="l13.140" class="difflineminus">-      this.selectFolder(window.arguments[0].folder);</span>
<a href="#l13.141"></a><span id="l13.141" class="difflineplus">+        curFirstVisRow = this.mView.treeBox.getFirstVisibleRow();</span>
<a href="#l13.142"></a><span id="l13.142" class="difflineplus">+        lastVisRow = this.mView.treeBox.getLastVisibleRow();</span>
<a href="#l13.143"></a><span id="l13.143" class="difflineplus">+        if (firstVisRow &gt;= 0 &amp;&amp; //firstVisRow &gt;= curFirstVisRow &amp;&amp;</span>
<a href="#l13.144"></a><span id="l13.144" class="difflineplus">+            this.mView.rowCount - lastVisRow &gt; firstVisRow - curFirstVisRow)</span>
<a href="#l13.145"></a><span id="l13.145" class="difflineplus">+          this.mView.treeBox.scrollToRow(firstVisRow);</span>
<a href="#l13.146"></a><span id="l13.146" class="difflineplus">+        else</span>
<a href="#l13.147"></a><span id="l13.147" class="difflineplus">+          this.mView.treeBox.ensureRowIsVisible(this.mView.rowCount - 1);</span>
<a href="#l13.148"></a><span id="l13.148" class="difflineplus">+        FeedUtils.log.debug(&quot;refreshSubscriptionView: curIndex:curFirstVisRow:&quot; +</span>
<a href="#l13.149"></a><span id="l13.149" class="difflineplus">+                            &quot;firstVisRow:lastVisRow:rowCount - &quot; +</span>
<a href="#l13.150"></a><span id="l13.150" class="difflineplus">+                            this.mView.selection.currentIndex+&quot;:&quot;+</span>
<a href="#l13.151"></a><span id="l13.151" class="difflineplus">+                            curFirstVisRow+&quot;:&quot;+</span>
<a href="#l13.152"></a><span id="l13.152" class="difflineplus">+                            firstVisRow+&quot;:&quot;+lastVisRow+&quot;:&quot;+this.mView.rowCount);</span>
<a href="#l13.153"></a><span id="l13.153" class="difflineplus">+      }</span>
<a href="#l13.154"></a><span id="l13.154" class="difflineplus">+    }</span>
<a href="#l13.155"></a><span id="l13.155">   },</span>
<a href="#l13.156"></a><span id="l13.156"> </span>
<a href="#l13.157"></a><span id="l13.157" class="difflineminus">-  uninit: function ()</span>
<a href="#l13.158"></a><span id="l13.158" class="difflineplus">+  mView:</span>
<a href="#l13.159"></a><span id="l13.159">   {</span>
<a href="#l13.160"></a><span id="l13.160" class="difflineminus">-    var dismissDialog = true;</span>
<a href="#l13.161"></a><span id="l13.161" class="difflineplus">+    _atoms: [],</span>
<a href="#l13.162"></a><span id="l13.162" class="difflineplus">+    _getAtomFor: function(aName) {</span>
<a href="#l13.163"></a><span id="l13.163" class="difflineplus">+      if (!this._atoms[aName])</span>
<a href="#l13.164"></a><span id="l13.164" class="difflineplus">+        this._atoms[aName] = this._makeAtom(aName);</span>
<a href="#l13.165"></a><span id="l13.165" class="difflineplus">+      return this._atoms[aName];</span>
<a href="#l13.166"></a><span id="l13.166" class="difflineplus">+    },</span>
<a href="#l13.167"></a><span id="l13.167" class="difflineplus">+  </span>
<a href="#l13.168"></a><span id="l13.168" class="difflineplus">+    _makeAtom: function(aString) {</span>
<a href="#l13.169"></a><span id="l13.169" class="difflineplus">+      return Cc[&quot;@mozilla.org/atom-service;1&quot;].</span>
<a href="#l13.170"></a><span id="l13.170" class="difflineplus">+             getService(Ci.nsIAtomService).</span>
<a href="#l13.171"></a><span id="l13.171" class="difflineplus">+             getAtom(aString);</span>
<a href="#l13.172"></a><span id="l13.172" class="difflineplus">+    },</span>
<a href="#l13.173"></a><span id="l13.173"> </span>
<a href="#l13.174"></a><span id="l13.174" class="difflineminus">-    // if we are in the middle of subscribing to a feed, inform the user that </span>
<a href="#l13.175"></a><span id="l13.175" class="difflineminus">-    // dismissing the dialog right now will abort the feed subscription.</span>
<a href="#l13.176"></a><span id="l13.176" class="difflineminus">-    // cheat and look at the disabled state of the add button to determine if we are in the middle of a new subscription</span>
<a href="#l13.177"></a><span id="l13.177" class="difflineminus">-    if (document.getElementById('addFeed').getAttribute('disabled'))</span>
<a href="#l13.178"></a><span id="l13.178" class="difflineminus">-    {</span>
<a href="#l13.179"></a><span id="l13.179" class="difflineminus">-      var promptService = Components.classes[&quot;@mozilla.org/embedcomp/prompt-service;1&quot;].getService(IPS);</span>
<a href="#l13.180"></a><span id="l13.180" class="difflineminus">-      var newsBlogBundle = document.getElementById(&quot;bundle_newsblog&quot;);</span>
<a href="#l13.181"></a><span id="l13.181" class="difflineminus">-      dismissDialog = !(promptService.confirmEx(window, newsBlogBundle.getString('subscribe-cancelSubscriptionTitle'), </span>
<a href="#l13.182"></a><span id="l13.182" class="difflineminus">-                                       newsBlogBundle.getString('subscribe-cancelSubscription'), </span>
<a href="#l13.183"></a><span id="l13.183" class="difflineminus">-                                       IPS.STD_YES_NO_BUTTONS,</span>
<a href="#l13.184"></a><span id="l13.184" class="difflineminus">-                                       null, null, null, null, { }));    </span>
<a href="#l13.185"></a><span id="l13.185" class="difflineminus">-    }  </span>
<a href="#l13.186"></a><span id="l13.186" class="difflineminus">-    return dismissDialog;</span>
<a href="#l13.187"></a><span id="l13.187" class="difflineminus">-  },</span>
<a href="#l13.188"></a><span id="l13.188" class="difflineminus">-  </span>
<a href="#l13.189"></a><span id="l13.189" class="difflineminus">-  mView: </span>
<a href="#l13.190"></a><span id="l13.190" class="difflineminus">-  {</span>
<a href="#l13.191"></a><span id="l13.191" class="difflineminus">-    mRowCount   : 0,</span>
<a href="#l13.192"></a><span id="l13.192" class="difflineplus">+    kRowIndexUndefined: -1,</span>
<a href="#l13.193"></a><span id="l13.193"> </span>
<a href="#l13.194"></a><span id="l13.194" class="difflineminus">-    get rowCount() </span>
<a href="#l13.195"></a><span id="l13.195" class="difflineminus">-    { </span>
<a href="#l13.196"></a><span id="l13.196" class="difflineminus">-      return this.mRowCount; </span>
<a href="#l13.197"></a><span id="l13.197" class="difflineminus">-    },</span>
<a href="#l13.198"></a><span id="l13.198" class="difflineminus">-    </span>
<a href="#l13.199"></a><span id="l13.199" class="difflineminus">-    getItemAtIndex: function (aIndex)</span>
<a href="#l13.200"></a><span id="l13.200" class="difflineminus">-    {</span>
<a href="#l13.201"></a><span id="l13.201" class="difflineminus">-      if (aIndex &lt; 0 ||</span>
<a href="#l13.202"></a><span id="l13.202" class="difflineminus">-          aIndex &gt;= gFeedSubscriptionsWindow.mFeedContainers.length)</span>
<a href="#l13.203"></a><span id="l13.203" class="difflineminus">-        return null;</span>
<a href="#l13.204"></a><span id="l13.204" class="difflineminus">-      return gFeedSubscriptionsWindow.mFeedContainers[aIndex];</span>
<a href="#l13.205"></a><span id="l13.205" class="difflineplus">+    get currentItem() {</span>
<a href="#l13.206"></a><span id="l13.206" class="difflineplus">+      // Get the current selection, if any.</span>
<a href="#l13.207"></a><span id="l13.207" class="difflineplus">+      let seln = this.selection;</span>
<a href="#l13.208"></a><span id="l13.208" class="difflineplus">+      let currentSelectionIndex =  seln ? seln.currentIndex : null;</span>
<a href="#l13.209"></a><span id="l13.209" class="difflineplus">+      let item;</span>
<a href="#l13.210"></a><span id="l13.210" class="difflineplus">+      if (currentSelectionIndex)</span>
<a href="#l13.211"></a><span id="l13.211" class="difflineplus">+        item = this.getItemAtIndex(currentSelectionIndex);</span>
<a href="#l13.212"></a><span id="l13.212" class="difflineplus">+</span>
<a href="#l13.213"></a><span id="l13.213" class="difflineplus">+      return item;</span>
<a href="#l13.214"></a><span id="l13.214">     },</span>
<a href="#l13.215"></a><span id="l13.215"> </span>
<a href="#l13.216"></a><span id="l13.216" class="difflineminus">-    removeItemAtIndex: function (aIndex, aCount)</span>
<a href="#l13.217"></a><span id="l13.217" class="difflineplus">+    /* nsITreeView */</span>
<a href="#l13.218"></a><span id="l13.218" class="difflineplus">+    treeBox: null,</span>
<a href="#l13.219"></a><span id="l13.219" class="difflineplus">+</span>
<a href="#l13.220"></a><span id="l13.220" class="difflineplus">+    mRowCount: 0,</span>
<a href="#l13.221"></a><span id="l13.221" class="difflineplus">+    get rowCount()                         { return this.mRowCount; },</span>
<a href="#l13.222"></a><span id="l13.222" class="difflineplus">+</span>
<a href="#l13.223"></a><span id="l13.223" class="difflineplus">+    _selection: null,</span>
<a href="#l13.224"></a><span id="l13.224" class="difflineplus">+    get selection ()                       { return this._selection; },</span>
<a href="#l13.225"></a><span id="l13.225" class="difflineplus">+    set selection (val)                    { return this._selection = val; },</span>
<a href="#l13.226"></a><span id="l13.226" class="difflineplus">+</span>
<a href="#l13.227"></a><span id="l13.227" class="difflineplus">+    setTree: function(aTreebox)            { this.treeBox = aTreebox; },</span>
<a href="#l13.228"></a><span id="l13.228" class="difflineplus">+    isSeparator: function(aRow)            { return false; },</span>
<a href="#l13.229"></a><span id="l13.229" class="difflineplus">+    isSorted: function()                   { return false; },</span>
<a href="#l13.230"></a><span id="l13.230" class="difflineplus">+    isSelectable: function(aRow, aColumn)  { return false; },</span>
<a href="#l13.231"></a><span id="l13.231" class="difflineplus">+    isEditable: function (aRow, aColumn)   { return false; },</span>
<a href="#l13.232"></a><span id="l13.232" class="difflineplus">+</span>
<a href="#l13.233"></a><span id="l13.233" class="difflineplus">+    getImageSrc: function(aRow, aCol)      { return null; },</span>
<a href="#l13.234"></a><span id="l13.234" class="difflineplus">+    getProgressMode : function(aRow, aCol) {},</span>
<a href="#l13.235"></a><span id="l13.235" class="difflineplus">+    cycleHeader: function(aCol)            {},</span>
<a href="#l13.236"></a><span id="l13.236" class="difflineplus">+    cycleCell: function(aRow, aCol)        {},</span>
<a href="#l13.237"></a><span id="l13.237" class="difflineplus">+    selectionChanged: function()           {},</span>
<a href="#l13.238"></a><span id="l13.238" class="difflineplus">+    performAction: function(aAction)       {},</span>
<a href="#l13.239"></a><span id="l13.239" class="difflineplus">+    performActionOnRow: function (aAction, aRow)       {},</span>
<a href="#l13.240"></a><span id="l13.240" class="difflineplus">+    performActionOnCell: function(aAction, aRow, aCol) {},</span>
<a href="#l13.241"></a><span id="l13.241" class="difflineplus">+    getRowProperties: function(aRow, aProperties)      {},</span>
<a href="#l13.242"></a><span id="l13.242" class="difflineplus">+    getColumnProperties: function(aCol, aProperties)   {},</span>
<a href="#l13.243"></a><span id="l13.243" class="difflineplus">+    getCellValue: function (aRow, aColumn)             {},</span>
<a href="#l13.244"></a><span id="l13.244" class="difflineplus">+    setCellValue: function (aRow, aColumn, aValue)     {},</span>
<a href="#l13.245"></a><span id="l13.245" class="difflineplus">+    setCellText: function (aRow, aColumn, aValue)      {},</span>
<a href="#l13.246"></a><span id="l13.246" class="difflineplus">+</span>
<a href="#l13.247"></a><span id="l13.247" class="difflineplus">+    getCellProperties: function (aRow, aColumn, aProperties) {</span>
<a href="#l13.248"></a><span id="l13.248" class="difflineplus">+//      aProperties.AppendElement(this._getAtomFor(&quot;folderNameCol&quot;));</span>
<a href="#l13.249"></a><span id="l13.249" class="difflineplus">+      let item = this.getItemAtIndex(aRow);</span>
<a href="#l13.250"></a><span id="l13.250" class="difflineplus">+      let folder = item &amp;&amp; item.folder ? item.folder : null;</span>
<a href="#l13.251"></a><span id="l13.251" class="difflineplus">+      if (folder)</span>
<a href="#l13.252"></a><span id="l13.252" class="difflineplus">+      {</span>
<a href="#l13.253"></a><span id="l13.253" class="difflineplus">+        if (folder.isServer)</span>
<a href="#l13.254"></a><span id="l13.254" class="difflineplus">+        {</span>
<a href="#l13.255"></a><span id="l13.255" class="difflineplus">+          aProperties.AppendElement(this._getAtomFor(&quot;serverType-rss&quot;));</span>
<a href="#l13.256"></a><span id="l13.256" class="difflineplus">+          aProperties.AppendElement(this._getAtomFor(&quot;isServer-true&quot;));</span>
<a href="#l13.257"></a><span id="l13.257" class="difflineplus">+        }</span>
<a href="#l13.258"></a><span id="l13.258" class="difflineplus">+        else</span>
<a href="#l13.259"></a><span id="l13.259" class="difflineplus">+          // It's a feed folder.</span>
<a href="#l13.260"></a><span id="l13.260" class="difflineplus">+          aProperties.AppendElement(this._getAtomFor(&quot;livemark&quot;));</span>
<a href="#l13.261"></a><span id="l13.261" class="difflineplus">+      }</span>
<a href="#l13.262"></a><span id="l13.262" class="difflineplus">+      else</span>
<a href="#l13.263"></a><span id="l13.263" class="difflineplus">+        // It's a feed.</span>
<a href="#l13.264"></a><span id="l13.264" class="difflineplus">+        aProperties.AppendElement(this._getAtomFor(&quot;serverType-rss&quot;));</span>
<a href="#l13.265"></a><span id="l13.265" class="difflineplus">+    },</span>
<a href="#l13.266"></a><span id="l13.266" class="difflineplus">+</span>
<a href="#l13.267"></a><span id="l13.267" class="difflineplus">+    isContainer: function (aRow)</span>
<a href="#l13.268"></a><span id="l13.268">     {</span>
<a href="#l13.269"></a><span id="l13.269" class="difflineminus">-      var itemToRemove = this.getItemAtIndex(aIndex);</span>
<a href="#l13.270"></a><span id="l13.270" class="difflineminus">-      if (!itemToRemove) </span>
<a href="#l13.271"></a><span id="l13.271" class="difflineplus">+      let item = this.getItemAtIndex(aRow);</span>
<a href="#l13.272"></a><span id="l13.272" class="difflineplus">+      return item ? item.container : false;</span>
<a href="#l13.273"></a><span id="l13.273" class="difflineplus">+    },</span>
<a href="#l13.274"></a><span id="l13.274" class="difflineplus">+</span>
<a href="#l13.275"></a><span id="l13.275" class="difflineplus">+    isContainerOpen: function (aRow)</span>
<a href="#l13.276"></a><span id="l13.276" class="difflineplus">+    { </span>
<a href="#l13.277"></a><span id="l13.277" class="difflineplus">+      let item = this.getItemAtIndex(aRow);</span>
<a href="#l13.278"></a><span id="l13.278" class="difflineplus">+      return item ? item.open : false;</span>
<a href="#l13.279"></a><span id="l13.279" class="difflineplus">+    },</span>
<a href="#l13.280"></a><span id="l13.280" class="difflineplus">+</span>
<a href="#l13.281"></a><span id="l13.281" class="difflineplus">+    isContainerEmpty: function (aRow)</span>
<a href="#l13.282"></a><span id="l13.282" class="difflineplus">+    { </span>
<a href="#l13.283"></a><span id="l13.283" class="difflineplus">+      let item = this.getItemAtIndex(aRow);</span>
<a href="#l13.284"></a><span id="l13.284" class="difflineplus">+      if (!item) </span>
<a href="#l13.285"></a><span id="l13.285" class="difflineplus">+        return false;</span>
<a href="#l13.286"></a><span id="l13.286" class="difflineplus">+</span>
<a href="#l13.287"></a><span id="l13.287" class="difflineplus">+      return item.children.length == 0;</span>
<a href="#l13.288"></a><span id="l13.288" class="difflineplus">+    },</span>
<a href="#l13.289"></a><span id="l13.289" class="difflineplus">+</span>
<a href="#l13.290"></a><span id="l13.290" class="difflineplus">+    getItemAtIndex: function (aRow)</span>
<a href="#l13.291"></a><span id="l13.291" class="difflineplus">+    {</span>
<a href="#l13.292"></a><span id="l13.292" class="difflineplus">+      if (aRow &lt; 0 || aRow &gt;= gFeedSubscriptionsWindow.mFeedContainers.length)</span>
<a href="#l13.293"></a><span id="l13.293" class="difflineplus">+        return null;</span>
<a href="#l13.294"></a><span id="l13.294" class="difflineplus">+</span>
<a href="#l13.295"></a><span id="l13.295" class="difflineplus">+      return gFeedSubscriptionsWindow.mFeedContainers[aRow];</span>
<a href="#l13.296"></a><span id="l13.296" class="difflineplus">+    },</span>
<a href="#l13.297"></a><span id="l13.297" class="difflineplus">+</span>
<a href="#l13.298"></a><span id="l13.298" class="difflineplus">+    removeItemAtIndex: function (aRow, aNoSelect)</span>
<a href="#l13.299"></a><span id="l13.299" class="difflineplus">+    {</span>
<a href="#l13.300"></a><span id="l13.300" class="difflineplus">+      let itemToRemove = this.getItemAtIndex(aRow);</span>
<a href="#l13.301"></a><span id="l13.301" class="difflineplus">+      if (!itemToRemove)</span>
<a href="#l13.302"></a><span id="l13.302">         return;</span>
<a href="#l13.303"></a><span id="l13.303"> </span>
<a href="#l13.304"></a><span id="l13.304" class="difflineminus">-      var parentIndex = this.getParentIndex(aIndex);</span>
<a href="#l13.305"></a><span id="l13.305" class="difflineminus">-      if (parentIndex != kRowIndexUndefined)</span>
<a href="#l13.306"></a><span id="l13.306" class="difflineplus">+      let parentIndex = this.getParentIndex(aRow);</span>
<a href="#l13.307"></a><span id="l13.307" class="difflineplus">+      let hasNextSibling = this.hasNextSibling(aRow, aRow);</span>
<a href="#l13.308"></a><span id="l13.308" class="difflineplus">+      if (parentIndex != this.kRowIndexUndefined)</span>
<a href="#l13.309"></a><span id="l13.309">       {</span>
<a href="#l13.310"></a><span id="l13.310" class="difflineminus">-        var parent = this.getItemAtIndex(parentIndex);</span>
<a href="#l13.311"></a><span id="l13.311" class="difflineplus">+        let parent = this.getItemAtIndex(parentIndex);</span>
<a href="#l13.312"></a><span id="l13.312">         if (parent)</span>
<a href="#l13.313"></a><span id="l13.313">         {</span>
<a href="#l13.314"></a><span id="l13.314" class="difflineminus">-          for (var index = 0; index &lt; parent.children.length; index++)</span>
<a href="#l13.315"></a><span id="l13.315" class="difflineplus">+          for (let index = 0; index &lt; parent.children.length; index++)</span>
<a href="#l13.316"></a><span id="l13.316">             if (parent.children[index] == itemToRemove)</span>
<a href="#l13.317"></a><span id="l13.317">             {</span>
<a href="#l13.318"></a><span id="l13.318">               parent.children.splice(index, 1);</span>
<a href="#l13.319"></a><span id="l13.319">               break;</span>
<a href="#l13.320"></a><span id="l13.320">             }</span>
<a href="#l13.321"></a><span id="l13.321">         }</span>
<a href="#l13.322"></a><span id="l13.322">       }</span>
<a href="#l13.323"></a><span id="l13.323"> </span>
<a href="#l13.324"></a><span id="l13.324" class="difflineminus">-      // now remove it from our view</span>
<a href="#l13.325"></a><span id="l13.325" class="difflineminus">-      gFeedSubscriptionsWindow.mFeedContainers.splice(aIndex, 1);</span>
<a href="#l13.326"></a><span id="l13.326" class="difflineplus">+      // Now remove it from our view.</span>
<a href="#l13.327"></a><span id="l13.327" class="difflineplus">+      gFeedSubscriptionsWindow.mFeedContainers.splice(aRow, 1);</span>
<a href="#l13.328"></a><span id="l13.328"> </span>
<a href="#l13.329"></a><span id="l13.329" class="difflineminus">-      // now invalidate the correct tree rows</span>
<a href="#l13.330"></a><span id="l13.330" class="difflineminus">-      var tbo = gFeedSubscriptionsWindow.mTree.treeBoxObject;</span>
<a href="#l13.331"></a><span id="l13.331" class="difflineminus">-</span>
<a href="#l13.332"></a><span id="l13.332" class="difflineplus">+      // Now invalidate the correct tree rows.</span>
<a href="#l13.333"></a><span id="l13.333">       this.mRowCount--;</span>
<a href="#l13.334"></a><span id="l13.334" class="difflineminus">-      tbo.rowCountChanged(aIndex, -1);</span>
<a href="#l13.335"></a><span id="l13.335" class="difflineplus">+      this.treeBox.rowCountChanged(aRow, -1);</span>
<a href="#l13.336"></a><span id="l13.336"> </span>
<a href="#l13.337"></a><span id="l13.337" class="difflineminus">-      // now update the selection position</span>
<a href="#l13.338"></a><span id="l13.338" class="difflineminus">-      if (aIndex &lt; gFeedSubscriptionsWindow.mFeedContainers.length)</span>
<a href="#l13.339"></a><span id="l13.339" class="difflineminus">-        this.selection.select(aIndex);</span>
<a href="#l13.340"></a><span id="l13.340" class="difflineminus">-      else </span>
<a href="#l13.341"></a><span id="l13.341" class="difflineminus">-        this.selection.clearSelection();</span>
<a href="#l13.342"></a><span id="l13.342" class="difflineplus">+      // Now update the selection position, unless noSelect (selection is</span>
<a href="#l13.343"></a><span id="l13.343" class="difflineplus">+      // done later or not at all).  If the item is the last child, select the</span>
<a href="#l13.344"></a><span id="l13.344" class="difflineplus">+      // parent.  Otherwise select the next sibling.</span>
<a href="#l13.345"></a><span id="l13.345" class="difflineplus">+      if (!aNoSelect) {</span>
<a href="#l13.346"></a><span id="l13.346" class="difflineplus">+        if (aRow &lt;= gFeedSubscriptionsWindow.mFeedContainers.length)</span>
<a href="#l13.347"></a><span id="l13.347" class="difflineplus">+          this.selection.select(hasNextSibling ? aRow : aRow - 1);</span>
<a href="#l13.348"></a><span id="l13.348" class="difflineplus">+        else</span>
<a href="#l13.349"></a><span id="l13.349" class="difflineplus">+          this.selection.clearSelection();</span>
<a href="#l13.350"></a><span id="l13.350" class="difflineplus">+      }</span>
<a href="#l13.351"></a><span id="l13.351"> </span>
<a href="#l13.352"></a><span id="l13.352" class="difflineminus">-      // now refocus the tree</span>
<a href="#l13.353"></a><span id="l13.353" class="difflineplus">+      // Now refocus the tree.</span>
<a href="#l13.354"></a><span id="l13.354">       gFeedSubscriptionsWindow.mTree.focus();</span>
<a href="#l13.355"></a><span id="l13.355">     },</span>
<a href="#l13.356"></a><span id="l13.356" class="difflineminus">-    </span>
<a href="#l13.357"></a><span id="l13.357" class="difflineminus">-    getCellText: function (aIndex, aColumn)</span>
<a href="#l13.358"></a><span id="l13.358" class="difflineplus">+</span>
<a href="#l13.359"></a><span id="l13.359" class="difflineplus">+    getCellText: function (aRow, aColumn)</span>
<a href="#l13.360"></a><span id="l13.360">     {</span>
<a href="#l13.361"></a><span id="l13.361" class="difflineminus">-      var item = this.getItemAtIndex(aIndex);</span>
<a href="#l13.362"></a><span id="l13.362" class="difflineplus">+      let item = this.getItemAtIndex(aRow);</span>
<a href="#l13.363"></a><span id="l13.363">       return (item &amp;&amp; aColumn.id == &quot;folderNameCol&quot;) ? item.name : &quot;&quot;;</span>
<a href="#l13.364"></a><span id="l13.364">     },</span>
<a href="#l13.365"></a><span id="l13.365"> </span>
<a href="#l13.366"></a><span id="l13.366" class="difflineminus">-    _selection: null, </span>
<a href="#l13.367"></a><span id="l13.367" class="difflineminus">-    get selection () { return this._selection; },</span>
<a href="#l13.368"></a><span id="l13.368" class="difflineminus">-    set selection (val) { this._selection = val; return val; },</span>
<a href="#l13.369"></a><span id="l13.369" class="difflineminus">-    getRowProperties: function (aIndex, aProperties) {},</span>
<a href="#l13.370"></a><span id="l13.370" class="difflineminus">-    getCellProperties: function (aIndex, aColumn, aProperties) {},</span>
<a href="#l13.371"></a><span id="l13.371" class="difflineminus">-    getColumnProperties: function (aColumn, aProperties) {},</span>
<a href="#l13.372"></a><span id="l13.372" class="difflineminus">-</span>
<a href="#l13.373"></a><span id="l13.373" class="difflineminus">-    isContainer: function (aIndex)</span>
<a href="#l13.374"></a><span id="l13.374" class="difflineminus">-    {</span>
<a href="#l13.375"></a><span id="l13.375" class="difflineminus">-      var item = this.getItemAtIndex(aIndex);</span>
<a href="#l13.376"></a><span id="l13.376" class="difflineminus">-      return item ? item.container : false;</span>
<a href="#l13.377"></a><span id="l13.377" class="difflineminus">-    },</span>
<a href="#l13.378"></a><span id="l13.378" class="difflineminus">-</span>
<a href="#l13.379"></a><span id="l13.379" class="difflineminus">-    isContainerOpen: function (aIndex) </span>
<a href="#l13.380"></a><span id="l13.380" class="difflineplus">+    canDrop: function (aRow, aOrientation)</span>
<a href="#l13.381"></a><span id="l13.381">     { </span>
<a href="#l13.382"></a><span id="l13.382" class="difflineminus">-      var item = this.getItemAtIndex(aIndex);</span>
<a href="#l13.383"></a><span id="l13.383" class="difflineminus">-      return item ? item.open : false;</span>
<a href="#l13.384"></a><span id="l13.384" class="difflineplus">+      let dropResult = this.extractDragData();</span>
<a href="#l13.385"></a><span id="l13.385" class="difflineplus">+      return (aOrientation == Ci.nsITreeView.DROP_ON) &amp;&amp;</span>
<a href="#l13.386"></a><span id="l13.386" class="difflineplus">+             dropResult.canDrop &amp;&amp;</span>
<a href="#l13.387"></a><span id="l13.387" class="difflineplus">+             (dropResult.url || dropResult.index != this.kRowIndexUndefined);</span>
<a href="#l13.388"></a><span id="l13.388">     },</span>
<a href="#l13.389"></a><span id="l13.389"> </span>
<a href="#l13.390"></a><span id="l13.390" class="difflineminus">-    isContainerEmpty: function (aIndex) </span>
<a href="#l13.391"></a><span id="l13.391" class="difflineminus">-    { </span>
<a href="#l13.392"></a><span id="l13.392" class="difflineminus">-      var item = this.getItemAtIndex(aIndex);</span>
<a href="#l13.393"></a><span id="l13.393" class="difflineminus">-      if (!item) </span>
<a href="#l13.394"></a><span id="l13.394" class="difflineminus">-        return false;</span>
<a href="#l13.395"></a><span id="l13.395" class="difflineminus">-      return item.children.length == 0;</span>
<a href="#l13.396"></a><span id="l13.396" class="difflineminus">-    },</span>
<a href="#l13.397"></a><span id="l13.397" class="difflineminus">-</span>
<a href="#l13.398"></a><span id="l13.398" class="difflineminus">-    isSeparator: function (aIndex) { return false; },    </span>
<a href="#l13.399"></a><span id="l13.399" class="difflineminus">-    isSorted: function (aIndex) { return false; },    </span>
<a href="#l13.400"></a><span id="l13.400" class="difflineminus">-    </span>
<a href="#l13.401"></a><span id="l13.401" class="difflineminus">-    canDrop: function (aIndex, aOrientation) </span>
<a href="#l13.402"></a><span id="l13.402" class="difflineminus">-    { </span>
<a href="#l13.403"></a><span id="l13.403" class="difflineminus">-      var dropResult = this.extractDragData();</span>
<a href="#l13.404"></a><span id="l13.404" class="difflineminus">-      return (aOrientation == Components.interfaces.nsITreeView.DROP_ON) &amp;&amp; </span>
<a href="#l13.405"></a><span id="l13.405" class="difflineminus">-                              dropResult.canDrop &amp;&amp; (dropResult.url || (dropResult.index != kRowIndexUndefined)); </span>
<a href="#l13.406"></a><span id="l13.406" class="difflineminus">-    },</span>
<a href="#l13.407"></a><span id="l13.407" class="difflineminus">-    </span>
<a href="#l13.408"></a><span id="l13.408" class="difflineminus">-    mDropUrl: &quot;&quot;,</span>
<a href="#l13.409"></a><span id="l13.409" class="difflineminus">-    mDropFolderUrl: &quot;&quot;,</span>
<a href="#l13.410"></a><span id="l13.410" class="difflineminus">-    drop: function (aIndex, aOrientation) </span>
<a href="#l13.411"></a><span id="l13.411" class="difflineminus">-    {  </span>
<a href="#l13.412"></a><span id="l13.412" class="difflineminus">-      var results = this.extractDragData();</span>
<a href="#l13.413"></a><span id="l13.413" class="difflineplus">+    drop: function (aRow, aOrientation)</span>
<a href="#l13.414"></a><span id="l13.414" class="difflineplus">+    {</span>
<a href="#l13.415"></a><span id="l13.415" class="difflineplus">+      let win = gFeedSubscriptionsWindow;</span>
<a href="#l13.416"></a><span id="l13.416" class="difflineplus">+      let results = this.extractDragData();</span>
<a href="#l13.417"></a><span id="l13.417">       if (!results.canDrop)</span>
<a href="#l13.418"></a><span id="l13.418">         return;</span>
<a href="#l13.419"></a><span id="l13.419"> </span>
<a href="#l13.420"></a><span id="l13.420" class="difflineplus">+      // Preselect the drop folder.</span>
<a href="#l13.421"></a><span id="l13.421" class="difflineplus">+      this.selection.select(aRow);</span>
<a href="#l13.422"></a><span id="l13.422" class="difflineplus">+</span>
<a href="#l13.423"></a><span id="l13.423">       if (results.url)</span>
<a href="#l13.424"></a><span id="l13.424">       {</span>
<a href="#l13.425"></a><span id="l13.425" class="difflineminus">-        var folderItem = this.getItemAtIndex(aIndex);</span>
<a href="#l13.426"></a><span id="l13.426" class="difflineminus">-        // don't freeze the app that initiaed the drop just because we are in a loop waiting for the user</span>
<a href="#l13.427"></a><span id="l13.427" class="difflineminus">-        // to dimisss the add feed dialog....</span>
<a href="#l13.428"></a><span id="l13.428" class="difflineminus">-        this.mDropUrl = results.url;</span>
<a href="#l13.429"></a><span id="l13.429" class="difflineminus">-        this.mDropFolderUrl = folderItem.url;</span>
<a href="#l13.430"></a><span id="l13.430" class="difflineminus">-        setTimeout(processDrop, 0);</span>
<a href="#l13.431"></a><span id="l13.431" class="difflineminus">-      } </span>
<a href="#l13.432"></a><span id="l13.432" class="difflineminus">-      else if (results.index != kRowIndexUndefined)</span>
<a href="#l13.433"></a><span id="l13.433" class="difflineminus">-        gFeedSubscriptionsWindow.moveFeed(results.index, aIndex);</span>
<a href="#l13.434"></a><span id="l13.434" class="difflineplus">+        // Don't freeze the app that initiated the drop just because we are</span>
<a href="#l13.435"></a><span id="l13.435" class="difflineplus">+        // in a loop waiting for the user to dimisss the add feed dialog.</span>
<a href="#l13.436"></a><span id="l13.436" class="difflineplus">+        setTimeout(function() {</span>
<a href="#l13.437"></a><span id="l13.437" class="difflineplus">+          win.addFeed(results.url, null, true, win.kSubscribeMode);</span>
<a href="#l13.438"></a><span id="l13.438" class="difflineplus">+        }, 0);</span>
<a href="#l13.439"></a><span id="l13.439" class="difflineplus">+        let folderItem = this.getItemAtIndex(aRow);</span>
<a href="#l13.440"></a><span id="l13.440" class="difflineplus">+        FeedUtils.log.debug(&quot;drop: folder, url - &quot; +</span>
<a href="#l13.441"></a><span id="l13.441" class="difflineplus">+                            folderItem.folder.name+&quot;, &quot;+results.url);</span>
<a href="#l13.442"></a><span id="l13.442" class="difflineplus">+      }</span>
<a href="#l13.443"></a><span id="l13.443" class="difflineplus">+      else if (results.index != this.kRowIndexUndefined)</span>
<a href="#l13.444"></a><span id="l13.444" class="difflineplus">+      {</span>
<a href="#l13.445"></a><span id="l13.445" class="difflineplus">+        win.moveFeed(results.index, aRow);</span>
<a href="#l13.446"></a><span id="l13.446" class="difflineplus">+      }</span>
<a href="#l13.447"></a><span id="l13.447">     },</span>
<a href="#l13.448"></a><span id="l13.448" class="difflineminus">-    </span>
<a href="#l13.449"></a><span id="l13.449" class="difflineminus">-    //  helper function for drag and drop</span>
<a href="#l13.450"></a><span id="l13.450" class="difflineplus">+</span>
<a href="#l13.451"></a><span id="l13.451" class="difflineplus">+    // Helper function for drag and drop.</span>
<a href="#l13.452"></a><span id="l13.452">     extractDragData: function()</span>
<a href="#l13.453"></a><span id="l13.453">     {</span>
<a href="#l13.454"></a><span id="l13.454" class="difflineminus">-      var canDrop = false;</span>
<a href="#l13.455"></a><span id="l13.455" class="difflineminus">-      var urlToDrop, sourceUri;</span>
<a href="#l13.456"></a><span id="l13.456" class="difflineminus">-      var sourceIndex = kRowIndexUndefined;</span>
<a href="#l13.457"></a><span id="l13.457" class="difflineminus">-      var dragService = Components.classes[&quot;@mozilla.org/widget/dragservice;1&quot;].getService().QueryInterface(nsIDragService);</span>
<a href="#l13.458"></a><span id="l13.458" class="difflineminus">-      var dragSession = dragService.getCurrentSession();</span>
<a href="#l13.459"></a><span id="l13.459" class="difflineplus">+      let canDrop = false;</span>
<a href="#l13.460"></a><span id="l13.460" class="difflineplus">+      let urlToDrop, sourceUri;</span>
<a href="#l13.461"></a><span id="l13.461" class="difflineplus">+      let sourceIndex = this.kRowIndexUndefined;</span>
<a href="#l13.462"></a><span id="l13.462" class="difflineplus">+      let dragService = Cc[&quot;@mozilla.org/widget/dragservice;1&quot;].</span>
<a href="#l13.463"></a><span id="l13.463" class="difflineplus">+                        getService().QueryInterface(Ci.nsIDragService);</span>
<a href="#l13.464"></a><span id="l13.464" class="difflineplus">+      let dragSession = dragService.getCurrentSession();</span>
<a href="#l13.465"></a><span id="l13.465"> </span>
<a href="#l13.466"></a><span id="l13.466" class="difflineminus">-      var transfer = Components.classes[&quot;@mozilla.org/widget/transferable;1&quot;].createInstance(Components.interfaces.nsITransferable);</span>
<a href="#l13.467"></a><span id="l13.467" class="difflineplus">+      let transfer = Cc[&quot;@mozilla.org/widget/transferable;1&quot;].</span>
<a href="#l13.468"></a><span id="l13.468" class="difflineplus">+                     createInstance(Ci.nsITransferable);</span>
<a href="#l13.469"></a><span id="l13.469">       transfer.addDataFlavor(&quot;text/x-moz-url&quot;);</span>
<a href="#l13.470"></a><span id="l13.470">       transfer.addDataFlavor(&quot;text/x-moz-feed-index&quot;);</span>
<a href="#l13.471"></a><span id="l13.471" class="difflineminus">-    </span>
<a href="#l13.472"></a><span id="l13.472" class="difflineminus">-      dragSession.getData (transfer, 0);</span>
<a href="#l13.473"></a><span id="l13.473" class="difflineminus">-      var dataObj = new Object();</span>
<a href="#l13.474"></a><span id="l13.474" class="difflineminus">-      var flavor = new Object();</span>
<a href="#l13.475"></a><span id="l13.475" class="difflineminus">-      var len = new Object();</span>
<a href="#l13.476"></a><span id="l13.476" class="difflineplus">+</span>
<a href="#l13.477"></a><span id="l13.477" class="difflineplus">+      dragSession.getData(transfer, 0);</span>
<a href="#l13.478"></a><span id="l13.478" class="difflineplus">+      let dataObj = new Object();</span>
<a href="#l13.479"></a><span id="l13.479" class="difflineplus">+      let flavor = new Object();</span>
<a href="#l13.480"></a><span id="l13.480" class="difflineplus">+      let len = new Object();</span>
<a href="#l13.481"></a><span id="l13.481"> </span>
<a href="#l13.482"></a><span id="l13.482">       try {</span>
<a href="#l13.483"></a><span id="l13.483" class="difflineminus">-        transfer.getAnyTransferData(flavor, dataObj, len);   </span>
<a href="#l13.484"></a><span id="l13.484" class="difflineminus">-      } catch (ex) { return { canDrop: false, url: &quot;&quot; }; }</span>
<a href="#l13.485"></a><span id="l13.485" class="difflineplus">+        transfer.getAnyTransferData(flavor, dataObj, len);</span>
<a href="#l13.486"></a><span id="l13.486" class="difflineplus">+      }</span>
<a href="#l13.487"></a><span id="l13.487" class="difflineplus">+      catch (ex) {</span>
<a href="#l13.488"></a><span id="l13.488" class="difflineplus">+        return { canDrop: false, url: &quot;&quot; };</span>
<a href="#l13.489"></a><span id="l13.489" class="difflineplus">+      }</span>
<a href="#l13.490"></a><span id="l13.490"> </span>
<a href="#l13.491"></a><span id="l13.491">       if (dataObj.value)</span>
<a href="#l13.492"></a><span id="l13.492">       {</span>
<a href="#l13.493"></a><span id="l13.493" class="difflineminus">-        dataObj = dataObj.value.QueryInterface(Components.interfaces.nsISupportsString);      </span>
<a href="#l13.494"></a><span id="l13.494" class="difflineminus">-        sourceUri = dataObj.data.substring(0, len.value); // pull the URL out of the data object</span>
<a href="#l13.495"></a><span id="l13.495" class="difflineminus">-     </span>
<a href="#l13.496"></a><span id="l13.496" class="difflineminus">-        if (flavor.value == 'text/x-moz-url')</span>
<a href="#l13.497"></a><span id="l13.497" class="difflineplus">+        dataObj = dataObj.value.QueryInterface(Ci.nsISupportsString);</span>
<a href="#l13.498"></a><span id="l13.498" class="difflineplus">+        // Pull the URL out of the data object.</span>
<a href="#l13.499"></a><span id="l13.499" class="difflineplus">+        sourceUri = dataObj.data.substring(0, len.value);</span>
<a href="#l13.500"></a><span id="l13.500" class="difflineplus">+</span>
<a href="#l13.501"></a><span id="l13.501" class="difflineplus">+        if (flavor.value == &quot;text/x-moz-url&quot;)</span>
<a href="#l13.502"></a><span id="l13.502">         {</span>
<a href="#l13.503"></a><span id="l13.503" class="difflineminus">-          var uri = Components.classes[&quot;@mozilla.org/network/standard-url;1&quot;].createInstance(Components.interfaces.nsIURI);</span>
<a href="#l13.504"></a><span id="l13.504" class="difflineplus">+          let uri = Cc[&quot;@mozilla.org/network/standard-url;1&quot;].</span>
<a href="#l13.505"></a><span id="l13.505" class="difflineplus">+                    createInstance(Ci.nsIURI);</span>
<a href="#l13.506"></a><span id="l13.506">           uri.spec = sourceUri.split(&quot;\n&quot;)[0];</span>
<a href="#l13.507"></a><span id="l13.507" class="difflineminus">-            </span>
<a href="#l13.508"></a><span id="l13.508" class="difflineplus">+</span>
<a href="#l13.509"></a><span id="l13.509">           if (uri.schemeIs(&quot;http&quot;) || uri.schemeIs(&quot;https&quot;))</span>
<a href="#l13.510"></a><span id="l13.510">           {</span>
<a href="#l13.511"></a><span id="l13.511">             urlToDrop = uri.spec;</span>
<a href="#l13.512"></a><span id="l13.512">             canDrop = true;</span>
<a href="#l13.513"></a><span id="l13.513">           }</span>
<a href="#l13.514"></a><span id="l13.514" class="difflineminus">-        } </span>
<a href="#l13.515"></a><span id="l13.515" class="difflineminus">-        else if (flavor.value == 'text/x-moz-feed-index')</span>
<a href="#l13.516"></a><span id="l13.516" class="difflineplus">+        }</span>
<a href="#l13.517"></a><span id="l13.517" class="difflineplus">+        else if (flavor.value == &quot;text/x-moz-feed-index&quot;)</span>
<a href="#l13.518"></a><span id="l13.518">         {</span>
<a href="#l13.519"></a><span id="l13.519">           sourceIndex = parseInt(sourceUri);</span>
<a href="#l13.520"></a><span id="l13.520">           canDrop = true;</span>
<a href="#l13.521"></a><span id="l13.521">         }</span>
<a href="#l13.522"></a><span id="l13.522">       }  // if dataObj.value</span>
<a href="#l13.523"></a><span id="l13.523"> </span>
<a href="#l13.524"></a><span id="l13.524">       return { canDrop: canDrop, url: urlToDrop, index: sourceIndex };</span>
<a href="#l13.525"></a><span id="l13.525">     },</span>
<a href="#l13.526"></a><span id="l13.526"> </span>
<a href="#l13.527"></a><span id="l13.527" class="difflineminus">-    getParentIndex: function (aIndex) </span>
<a href="#l13.528"></a><span id="l13.528" class="difflineplus">+    getParentIndex: function (aRow)</span>
<a href="#l13.529"></a><span id="l13.529">     {</span>
<a href="#l13.530"></a><span id="l13.530" class="difflineminus">-      var item = this.getItemAtIndex(aIndex);</span>
<a href="#l13.531"></a><span id="l13.531" class="difflineplus">+      let item = this.getItemAtIndex(aRow);</span>
<a href="#l13.532"></a><span id="l13.532"> </span>
<a href="#l13.533"></a><span id="l13.533">       if (item)</span>
<a href="#l13.534"></a><span id="l13.534">       {</span>
<a href="#l13.535"></a><span id="l13.535" class="difflineminus">-        for (var index = aIndex; index &gt;= 0; index--)</span>
<a href="#l13.536"></a><span id="l13.536" class="difflineminus">-          if (gFeedSubscriptionsWindow.mFeedContainers[index].level &lt;  item.level)</span>
<a href="#l13.537"></a><span id="l13.537" class="difflineplus">+        for (let index = aRow; index &gt;= 0; index--)</span>
<a href="#l13.538"></a><span id="l13.538" class="difflineplus">+          if (gFeedSubscriptionsWindow.mFeedContainers[index].level &lt; item.level)</span>
<a href="#l13.539"></a><span id="l13.539">             return index;</span>
<a href="#l13.540"></a><span id="l13.540">       }</span>
<a href="#l13.541"></a><span id="l13.541" class="difflineminus">-   </span>
<a href="#l13.542"></a><span id="l13.542" class="difflineminus">-      return kRowIndexUndefined;</span>
<a href="#l13.543"></a><span id="l13.543" class="difflineminus">-    },    </span>
<a href="#l13.544"></a><span id="l13.544" class="difflineminus">-    hasNextSibling: function (aParentIndex, aIndex) </span>
<a href="#l13.545"></a><span id="l13.545" class="difflineminus">-    { </span>
<a href="#l13.546"></a><span id="l13.546" class="difflineminus">-      var item = this.getItemAtIndex(aIndex);</span>
<a href="#l13.547"></a><span id="l13.547" class="difflineminus">-      if (item) </span>
<a href="#l13.548"></a><span id="l13.548" class="difflineminus">-      {</span>
<a href="#l13.549"></a><span id="l13.549" class="difflineminus">-        // if the next node in the view has the same level as us, then we must have a next sibling...</span>
<a href="#l13.550"></a><span id="l13.550" class="difflineminus">-        if (aIndex + 1 &lt; gFeedSubscriptionsWindow.mFeedContainers.length )</span>
<a href="#l13.551"></a><span id="l13.551" class="difflineminus">-          return this.getItemAtIndex(aIndex + 1).level == item.level;</span>
<a href="#l13.552"></a><span id="l13.552" class="difflineplus">+</span>
<a href="#l13.553"></a><span id="l13.553" class="difflineplus">+      return this.kRowIndexUndefined;</span>
<a href="#l13.554"></a><span id="l13.554" class="difflineplus">+    },</span>
<a href="#l13.555"></a><span id="l13.555" class="difflineplus">+</span>
<a href="#l13.556"></a><span id="l13.556" class="difflineplus">+    hasNextSibling: function(aRow, aAfterIndex) {</span>
<a href="#l13.557"></a><span id="l13.557" class="difflineplus">+      let targetLevel = this.getItemAtIndex(aRow).level;</span>
<a href="#l13.558"></a><span id="l13.558" class="difflineplus">+      let rows = gFeedSubscriptionsWindow.mFeedContainers;</span>
<a href="#l13.559"></a><span id="l13.559" class="difflineplus">+      for (let i = aAfterIndex + 1; i &lt; rows.length; i++) {</span>
<a href="#l13.560"></a><span id="l13.560" class="difflineplus">+        if (this.getItemAtIndex(i).level == targetLevel)</span>
<a href="#l13.561"></a><span id="l13.561" class="difflineplus">+          return true;</span>
<a href="#l13.562"></a><span id="l13.562" class="difflineplus">+        if (this.getItemAtIndex(i).level &lt; targetLevel)</span>
<a href="#l13.563"></a><span id="l13.563" class="difflineplus">+          return false;</span>
<a href="#l13.564"></a><span id="l13.564">       }</span>
<a href="#l13.565"></a><span id="l13.565"> </span>
<a href="#l13.566"></a><span id="l13.566">       return false;</span>
<a href="#l13.567"></a><span id="l13.567">     },</span>
<a href="#l13.568"></a><span id="l13.568" class="difflineminus">-    hasPreviousSibling: function (aIndex)</span>
<a href="#l13.569"></a><span id="l13.569" class="difflineplus">+</span>
<a href="#l13.570"></a><span id="l13.570" class="difflineplus">+    hasPreviousSibling: function (aRow)</span>
<a href="#l13.571"></a><span id="l13.571">     {</span>
<a href="#l13.572"></a><span id="l13.572" class="difflineminus">-      var item = this.getItemAtIndex(aIndex);</span>
<a href="#l13.573"></a><span id="l13.573" class="difflineminus">-      if (item &amp;&amp; aIndex)</span>
<a href="#l13.574"></a><span id="l13.574" class="difflineminus">-        return this.getItemAtIndex(aIndex - 1).level == item.level;</span>
<a href="#l13.575"></a><span id="l13.575" class="difflineplus">+      let item = this.getItemAtIndex(aRow);</span>
<a href="#l13.576"></a><span id="l13.576" class="difflineplus">+      if (item &amp;&amp; aRow)</span>
<a href="#l13.577"></a><span id="l13.577" class="difflineplus">+        return this.getItemAtIndex(aRow - 1).level == item.level;</span>
<a href="#l13.578"></a><span id="l13.578">       else</span>
<a href="#l13.579"></a><span id="l13.579" class="difflineminus">-        return false;      </span>
<a href="#l13.580"></a><span id="l13.580" class="difflineplus">+        return false;</span>
<a href="#l13.581"></a><span id="l13.581">     },</span>
<a href="#l13.582"></a><span id="l13.582" class="difflineminus">-    getLevel: function (aIndex) </span>
<a href="#l13.583"></a><span id="l13.583" class="difflineplus">+</span>
<a href="#l13.584"></a><span id="l13.584" class="difflineplus">+    getLevel: function (aRow)</span>
<a href="#l13.585"></a><span id="l13.585">     {</span>
<a href="#l13.586"></a><span id="l13.586" class="difflineminus">-      var item = this.getItemAtIndex(aIndex);</span>
<a href="#l13.587"></a><span id="l13.587" class="difflineminus">-      if (!item) </span>
<a href="#l13.588"></a><span id="l13.588" class="difflineplus">+      let item = this.getItemAtIndex(aRow);</span>
<a href="#l13.589"></a><span id="l13.589" class="difflineplus">+      if (!item)</span>
<a href="#l13.590"></a><span id="l13.590">         return 0;</span>
<a href="#l13.591"></a><span id="l13.591" class="difflineplus">+</span>
<a href="#l13.592"></a><span id="l13.592">       return item.level;</span>
<a href="#l13.593"></a><span id="l13.593">     },</span>
<a href="#l13.594"></a><span id="l13.594" class="difflineminus">-    getImageSrc: function (aIndex, aColumn) {},    </span>
<a href="#l13.595"></a><span id="l13.595" class="difflineminus">-    getProgressMode: function (aIndex, aColumn) {},    </span>
<a href="#l13.596"></a><span id="l13.596" class="difflineminus">-    getCellValue: function (aIndex, aColumn) {},</span>
<a href="#l13.597"></a><span id="l13.597" class="difflineminus">-    setTree: function (aTree) {},    </span>
<a href="#l13.598"></a><span id="l13.598" class="difflineminus">-    toggleOpenState: function (aIndex) </span>
<a href="#l13.599"></a><span id="l13.599" class="difflineplus">+</span>
<a href="#l13.600"></a><span id="l13.600" class="difflineplus">+    toggleOpenState: function (aRow)</span>
<a href="#l13.601"></a><span id="l13.601" class="difflineplus">+    {</span>
<a href="#l13.602"></a><span id="l13.602" class="difflineplus">+      let item = this.getItemAtIndex(aRow);</span>
<a href="#l13.603"></a><span id="l13.603" class="difflineplus">+      if (!item)</span>
<a href="#l13.604"></a><span id="l13.604" class="difflineplus">+        return;</span>
<a href="#l13.605"></a><span id="l13.605" class="difflineplus">+</span>
<a href="#l13.606"></a><span id="l13.606" class="difflineplus">+      // Save off the current selection item.</span>
<a href="#l13.607"></a><span id="l13.607" class="difflineplus">+      let seln = this.selection;</span>
<a href="#l13.608"></a><span id="l13.608" class="difflineplus">+      let currentSelectionIndex = seln.currentIndex;</span>
<a href="#l13.609"></a><span id="l13.609" class="difflineplus">+</span>
<a href="#l13.610"></a><span id="l13.610" class="difflineplus">+      let rowsChanged = this.toggle(aRow)</span>
<a href="#l13.611"></a><span id="l13.611" class="difflineplus">+</span>
<a href="#l13.612"></a><span id="l13.612" class="difflineplus">+      // Now restore selection, ensuring selection is maintained on toggles.</span>
<a href="#l13.613"></a><span id="l13.613" class="difflineplus">+      if (currentSelectionIndex &gt; aRow)</span>
<a href="#l13.614"></a><span id="l13.614" class="difflineplus">+        seln.currentIndex = currentSelectionIndex + rowsChanged;</span>
<a href="#l13.615"></a><span id="l13.615" class="difflineplus">+      else</span>
<a href="#l13.616"></a><span id="l13.616" class="difflineplus">+        seln.select(currentSelectionIndex);</span>
<a href="#l13.617"></a><span id="l13.617" class="difflineplus">+</span>
<a href="#l13.618"></a><span id="l13.618" class="difflineplus">+      seln.selectEventsSuppressed = false;</span>
<a href="#l13.619"></a><span id="l13.619" class="difflineplus">+    },</span>
<a href="#l13.620"></a><span id="l13.620" class="difflineplus">+</span>
<a href="#l13.621"></a><span id="l13.621" class="difflineplus">+    toggle: function (aRow)</span>
<a href="#l13.622"></a><span id="l13.622">     {</span>
<a href="#l13.623"></a><span id="l13.623" class="difflineminus">-      var item = this.getItemAtIndex(aIndex);</span>
<a href="#l13.624"></a><span id="l13.624" class="difflineminus">-      if (!item) return;</span>
<a href="#l13.625"></a><span id="l13.625" class="difflineplus">+      // Collapse the row, or build sub rows based on open states in the map.</span>
<a href="#l13.626"></a><span id="l13.626" class="difflineplus">+      let item = this.getItemAtIndex(aRow);</span>
<a href="#l13.627"></a><span id="l13.627" class="difflineplus">+      if (!item)</span>
<a href="#l13.628"></a><span id="l13.628" class="difflineplus">+        return null;</span>
<a href="#l13.629"></a><span id="l13.629" class="difflineplus">+</span>
<a href="#l13.630"></a><span id="l13.630" class="difflineplus">+      let rows = gFeedSubscriptionsWindow.mFeedContainers;</span>
<a href="#l13.631"></a><span id="l13.631" class="difflineplus">+      let rowCount = 0;</span>
<a href="#l13.632"></a><span id="l13.632" class="difflineplus">+      let multiplier;</span>
<a href="#l13.633"></a><span id="l13.633" class="difflineplus">+</span>
<a href="#l13.634"></a><span id="l13.634" class="difflineplus">+      if (item.open)</span>
<a href="#l13.635"></a><span id="l13.635" class="difflineplus">+      {</span>
<a href="#l13.636"></a><span id="l13.636" class="difflineplus">+        // Close the container.  Add up all subfolders and their descendants</span>
<a href="#l13.637"></a><span id="l13.637" class="difflineplus">+        // who may be open.</span>
<a href="#l13.638"></a><span id="l13.638" class="difflineplus">+        multiplier = -1;</span>
<a href="#l13.639"></a><span id="l13.639" class="difflineplus">+        let nextRow = aRow + 1;</span>
<a href="#l13.640"></a><span id="l13.640" class="difflineplus">+        let nextItem = rows[nextRow];</span>
<a href="#l13.641"></a><span id="l13.641" class="difflineplus">+        while (nextItem &amp;&amp; nextItem.level &gt; item.level)</span>
<a href="#l13.642"></a><span id="l13.642" class="difflineplus">+        {</span>
<a href="#l13.643"></a><span id="l13.643" class="difflineplus">+          rowCount++;</span>
<a href="#l13.644"></a><span id="l13.644" class="difflineplus">+          nextItem = rows[++nextRow];</span>
<a href="#l13.645"></a><span id="l13.645" class="difflineplus">+        }</span>
<a href="#l13.646"></a><span id="l13.646"> </span>
<a href="#l13.647"></a><span id="l13.647" class="difflineminus">-      // save off the current selection item</span>
<a href="#l13.648"></a><span id="l13.648" class="difflineminus">-      var seln = this.selection;</span>
<a href="#l13.649"></a><span id="l13.649" class="difflineminus">-      var currentSelectionIndex = seln.currentIndex;</span>
<a href="#l13.650"></a><span id="l13.650" class="difflineplus">+        rows.splice(aRow + 1, rowCount);</span>
<a href="#l13.651"></a><span id="l13.651" class="difflineplus">+      }</span>
<a href="#l13.652"></a><span id="l13.652" class="difflineplus">+      else</span>
<a href="#l13.653"></a><span id="l13.653" class="difflineplus">+      {</span>
<a href="#l13.654"></a><span id="l13.654" class="difflineplus">+        // Open the container.  Restore the open state of all subfolder and</span>
<a href="#l13.655"></a><span id="l13.655" class="difflineplus">+        // their descendants.</span>
<a href="#l13.656"></a><span id="l13.656" class="difflineplus">+        multiplier = 1;</span>
<a href="#l13.657"></a><span id="l13.657" class="difflineplus">+        function addDescendants(aItem)</span>
<a href="#l13.658"></a><span id="l13.658" class="difflineplus">+        {</span>
<a href="#l13.659"></a><span id="l13.659" class="difflineplus">+          for (let i = 0; i &lt; aItem.children.length; i++)</span>
<a href="#l13.660"></a><span id="l13.660" class="difflineplus">+          {</span>
<a href="#l13.661"></a><span id="l13.661" class="difflineplus">+            rowCount++;</span>
<a href="#l13.662"></a><span id="l13.662" class="difflineplus">+            let child = aItem.children[i];</span>
<a href="#l13.663"></a><span id="l13.663" class="difflineplus">+            rows.splice(aRow + rowCount, 0, child);</span>
<a href="#l13.664"></a><span id="l13.664" class="difflineplus">+            if (child.open)</span>
<a href="#l13.665"></a><span id="l13.665" class="difflineplus">+              addDescendants(child);</span>
<a href="#l13.666"></a><span id="l13.666" class="difflineplus">+          }</span>
<a href="#l13.667"></a><span id="l13.667" class="difflineplus">+        }</span>
<a href="#l13.668"></a><span id="l13.668"> </span>
<a href="#l13.669"></a><span id="l13.669" class="difflineminus">-      var multiplier = item.open ? -1 : 1;</span>
<a href="#l13.670"></a><span id="l13.670" class="difflineminus">-      var delta = multiplier * item.children.length;</span>
<a href="#l13.671"></a><span id="l13.671" class="difflineplus">+        addDescendants(item);</span>
<a href="#l13.672"></a><span id="l13.672" class="difflineplus">+      }</span>
<a href="#l13.673"></a><span id="l13.673" class="difflineplus">+</span>
<a href="#l13.674"></a><span id="l13.674" class="difflineplus">+      let delta = multiplier * rowCount;</span>
<a href="#l13.675"></a><span id="l13.675">       this.mRowCount += delta;</span>
<a href="#l13.676"></a><span id="l13.676"> </span>
<a href="#l13.677"></a><span id="l13.677" class="difflineminus">-      if (multiplier &lt; 0)</span>
<a href="#l13.678"></a><span id="l13.678" class="difflineminus">-        gFeedSubscriptionsWindow.mFeedContainers.splice(aIndex + 1, item.children.length);</span>
<a href="#l13.679"></a><span id="l13.679" class="difflineminus">-      else</span>
<a href="#l13.680"></a><span id="l13.680" class="difflineminus">-        for (var i = 0; i &lt; item.children.length; i++)</span>
<a href="#l13.681"></a><span id="l13.681" class="difflineminus">-          gFeedSubscriptionsWindow.mFeedContainers.splice(aIndex + 1 + i, 0, item.children[i]);</span>
<a href="#l13.682"></a><span id="l13.682" class="difflineminus">-</span>
<a href="#l13.683"></a><span id="l13.683" class="difflineminus">-      // add or remove the children from our view</span>
<a href="#l13.684"></a><span id="l13.684">       item.open = !item.open;</span>
<a href="#l13.685"></a><span id="l13.685" class="difflineminus">-      gFeedSubscriptionsWindow.mTree.treeBoxObject.rowCountChanged(aIndex, delta);</span>
<a href="#l13.686"></a><span id="l13.686" class="difflineminus">-</span>
<a href="#l13.687"></a><span id="l13.687" class="difflineminus">-      // now restore selection</span>
<a href="#l13.688"></a><span id="l13.688" class="difflineminus">-      seln.select(currentSelectionIndex);</span>
<a href="#l13.689"></a><span id="l13.689" class="difflineminus">-      </span>
<a href="#l13.690"></a><span id="l13.690" class="difflineminus">-    },    </span>
<a href="#l13.691"></a><span id="l13.691" class="difflineminus">-    cycleHeader: function (aColumn) {},    </span>
<a href="#l13.692"></a><span id="l13.692" class="difflineminus">-    selectionChanged: function () {},    </span>
<a href="#l13.693"></a><span id="l13.693" class="difflineminus">-    cycleCell: function (aIndex, aColumn) {},    </span>
<a href="#l13.694"></a><span id="l13.694" class="difflineminus">-    isEditable: function (aIndex, aColumn) </span>
<a href="#l13.695"></a><span id="l13.695" class="difflineminus">-    { </span>
<a href="#l13.696"></a><span id="l13.696" class="difflineminus">-      return false; </span>
<a href="#l13.697"></a><span id="l13.697" class="difflineminus">-    },</span>
<a href="#l13.698"></a><span id="l13.698" class="difflineminus">-    isSelectable: function (aIndex, aColumn) </span>
<a href="#l13.699"></a><span id="l13.699" class="difflineminus">-    { </span>
<a href="#l13.700"></a><span id="l13.700" class="difflineminus">-      return false; </span>
<a href="#l13.701"></a><span id="l13.701" class="difflineminus">-    },</span>
<a href="#l13.702"></a><span id="l13.702" class="difflineminus">-    setCellValue: function (aIndex, aColumn, aValue) {},    </span>
<a href="#l13.703"></a><span id="l13.703" class="difflineminus">-    setCellText: function (aIndex, aColumn, aValue) {},    </span>
<a href="#l13.704"></a><span id="l13.704" class="difflineminus">-    performAction: function (aAction) {},  </span>
<a href="#l13.705"></a><span id="l13.705" class="difflineminus">-    performActionOnRow: function (aAction, aIndex) {},    </span>
<a href="#l13.706"></a><span id="l13.706" class="difflineminus">-    performActionOnCell: function (aAction, aindex, aColumn) {}</span>
<a href="#l13.707"></a><span id="l13.707" class="difflineplus">+      // Suppress the select event caused by rowCountChanged.</span>
<a href="#l13.708"></a><span id="l13.708" class="difflineplus">+      this.selection.selectEventsSuppressed = true;</span>
<a href="#l13.709"></a><span id="l13.709" class="difflineplus">+      // Add or remove the children from our view.</span>
<a href="#l13.710"></a><span id="l13.710" class="difflineplus">+      this.treeBox.rowCountChanged(aRow, delta);</span>
<a href="#l13.711"></a><span id="l13.711" class="difflineplus">+      return delta;</span>
<a href="#l13.712"></a><span id="l13.712" class="difflineplus">+    }</span>
<a href="#l13.713"></a><span id="l13.713">   },</span>
<a href="#l13.714"></a><span id="l13.714"> </span>
<a href="#l13.715"></a><span id="l13.715">   makeFolderObject: function (aFolder, aCurrentLevel)</span>
<a href="#l13.716"></a><span id="l13.716">   {</span>
<a href="#l13.717"></a><span id="l13.717" class="difflineminus">-    var folderObject =  { children : [],</span>
<a href="#l13.718"></a><span id="l13.718" class="difflineplus">+    let defaultQuickMode = aFolder.server.getBoolValue(&quot;quickMode&quot;);</span>
<a href="#l13.719"></a><span id="l13.719" class="difflineplus">+    let folderObject =  { children : [],</span>
<a href="#l13.720"></a><span id="l13.720" class="difflineplus">+                          folder   : aFolder,</span>
<a href="#l13.721"></a><span id="l13.721">                           name     : aFolder.prettiestName,</span>
<a href="#l13.722"></a><span id="l13.722">                           level    : aCurrentLevel,</span>
<a href="#l13.723"></a><span id="l13.723" class="difflineminus">-                          url      : aFolder.QueryInterface(Components.interfaces.nsIRDFResource).Value,</span>
<a href="#l13.724"></a><span id="l13.724" class="difflineplus">+                          url      : aFolder.URI,</span>
<a href="#l13.725"></a><span id="l13.725" class="difflineplus">+                          //QueryInterface(Ci.nsIRDFResource).Value,</span>
<a href="#l13.726"></a><span id="l13.726" class="difflineplus">+                          quickMode: defaultQuickMode,</span>
<a href="#l13.727"></a><span id="l13.727">                           open     : false,</span>
<a href="#l13.728"></a><span id="l13.728">                           container: true };</span>
<a href="#l13.729"></a><span id="l13.729"> </span>
<a href="#l13.730"></a><span id="l13.730" class="difflineminus">-    // If a feed has any sub folders, we should add them to the list of children.</span>
<a href="#l13.731"></a><span id="l13.731" class="difflineminus">-    var folderEnumerator = aFolder.subFolders;</span>
<a href="#l13.732"></a><span id="l13.732" class="difflineplus">+    // If a feed has any sub folders, add them to the list of children.</span>
<a href="#l13.733"></a><span id="l13.733" class="difflineplus">+    let folderEnumerator = aFolder.subFolders;</span>
<a href="#l13.734"></a><span id="l13.734"> </span>
<a href="#l13.735"></a><span id="l13.735">     while (folderEnumerator.hasMoreElements())</span>
<a href="#l13.736"></a><span id="l13.736">     {</span>
<a href="#l13.737"></a><span id="l13.737" class="difflineminus">-      var folder = folderEnumerator.getNext();</span>
<a href="#l13.738"></a><span id="l13.738" class="difflineminus">-      if ((folder instanceof Components.interfaces.nsIMsgFolder) &amp;&amp;</span>
<a href="#l13.739"></a><span id="l13.739" class="difflineminus">-          !folder.getFlag(Components.interfaces.nsMsgFolderFlags.Virtual))</span>
<a href="#l13.740"></a><span id="l13.740" class="difflineplus">+      let folder = folderEnumerator.getNext();</span>
<a href="#l13.741"></a><span id="l13.741" class="difflineplus">+      if ((folder instanceof Ci.nsIMsgFolder) &amp;&amp;</span>
<a href="#l13.742"></a><span id="l13.742" class="difflineplus">+          !folder.getFlag(Ci.nsMsgFolderFlags.Trash) &amp;&amp;</span>
<a href="#l13.743"></a><span id="l13.743" class="difflineplus">+          !folder.getFlag(Ci.nsMsgFolderFlags.Virtual))</span>
<a href="#l13.744"></a><span id="l13.744" class="difflineplus">+      {</span>
<a href="#l13.745"></a><span id="l13.745">         folderObject.children</span>
<a href="#l13.746"></a><span id="l13.746">                     .push(this.makeFolderObject(folder, aCurrentLevel + 1));</span>
<a href="#l13.747"></a><span id="l13.747" class="difflineplus">+      }</span>
<a href="#l13.748"></a><span id="l13.748">     }</span>
<a href="#l13.749"></a><span id="l13.749"> </span>
<a href="#l13.750"></a><span id="l13.750" class="difflineminus">-    var feeds = this.getFeedsInFolder(aFolder);</span>
<a href="#l13.751"></a><span id="l13.751" class="difflineplus">+    function sorter(a, b)</span>
<a href="#l13.752"></a><span id="l13.752" class="difflineplus">+    {</span>
<a href="#l13.753"></a><span id="l13.753" class="difflineplus">+      let sortKey = a.folder.compareSortKeys(b.folder);</span>
<a href="#l13.754"></a><span id="l13.754" class="difflineplus">+      if (sortKey)</span>
<a href="#l13.755"></a><span id="l13.755" class="difflineplus">+        return sortKey;</span>
<a href="#l13.756"></a><span id="l13.756" class="difflineplus">+      return a.name.toLowerCase() &gt; b.name.toLowerCase();</span>
<a href="#l13.757"></a><span id="l13.757" class="difflineplus">+    }</span>
<a href="#l13.758"></a><span id="l13.758" class="difflineplus">+ </span>
<a href="#l13.759"></a><span id="l13.759" class="difflineplus">+    folderObject.children.sort(sorter);</span>
<a href="#l13.760"></a><span id="l13.760"> </span>
<a href="#l13.761"></a><span id="l13.761" class="difflineplus">+    let feeds = this.getFeedsInFolder(aFolder);</span>
<a href="#l13.762"></a><span id="l13.762">     for (let feed in feeds)</span>
<a href="#l13.763"></a><span id="l13.763">     {</span>
<a href="#l13.764"></a><span id="l13.764" class="difflineminus">-      // Special case, if a folder only has a single feed associated with it, then just use the feed</span>
<a href="#l13.765"></a><span id="l13.765" class="difflineminus">-      // in the view and don't show the folder at all. </span>
<a href="#l13.766"></a><span id="l13.766" class="difflineminus">-//      if (feedUrlArray.length &lt;= 2 &amp;&amp; !aFolder.hasSubFolders) // Note: split always adds an empty element to the array...</span>
<a href="#l13.767"></a><span id="l13.767" class="difflineminus">-//        this.mFeedContainers[aCurrentLength] = this.makeFeedObject(feed, aCurrentLevel);</span>
<a href="#l13.768"></a><span id="l13.768" class="difflineminus">-//      else // now add any feed urls for the folder</span>
<a href="#l13.769"></a><span id="l13.769" class="difflineplus">+      // Special case, if a folder only has a single feed associated with it,</span>
<a href="#l13.770"></a><span id="l13.770" class="difflineplus">+      // then just use the feed in the view and don't show the folder at all.</span>
<a href="#l13.771"></a><span id="l13.771" class="difflineplus">+      // Note: split always adds an empty element to the array...</span>
<a href="#l13.772"></a><span id="l13.772" class="difflineplus">+//      if (feedUrlArray.length &lt;= 2 &amp;&amp; !aFolder.hasSubFolders)</span>
<a href="#l13.773"></a><span id="l13.773" class="difflineplus">+//        this.mFeedContainers[aCurrentLength] =</span>
<a href="#l13.774"></a><span id="l13.774" class="difflineplus">+//            this.makeFeedObject(feed, aCurrentLevel);</span>
<a href="#l13.775"></a><span id="l13.775" class="difflineplus">+//      else</span>
<a href="#l13.776"></a><span id="l13.776" class="difflineplus">+        // Now add any feed urls for the folder.</span>
<a href="#l13.777"></a><span id="l13.777">         folderObject.children.push(this.makeFeedObject(feeds[feed],</span>
<a href="#l13.778"></a><span id="l13.778">                                                        aFolder,</span>
<a href="#l13.779"></a><span id="l13.779">                                                        aCurrentLevel + 1));</span>
<a href="#l13.780"></a><span id="l13.780">     }</span>
<a href="#l13.781"></a><span id="l13.781"> </span>
<a href="#l13.782"></a><span id="l13.782">     return folderObject;</span>
<a href="#l13.783"></a><span id="l13.783">   },</span>
<a href="#l13.784"></a><span id="l13.784"> </span>
<a href="#l13.785"></a><span id="l13.785" class="difflineat">@@ -391,682 +592,1105 @@ var gFeedSubscriptionsWindow = {</span>
<a href="#l13.786"></a><span id="l13.786">       // No feedUrls in this folder.</span>
<a href="#l13.787"></a><span id="l13.787">       return;</span>
<a href="#l13.788"></a><span id="l13.788"> </span>
<a href="#l13.789"></a><span id="l13.789">     for (let url in feedUrlArray)</span>
<a href="#l13.790"></a><span id="l13.790">     {</span>
<a href="#l13.791"></a><span id="l13.791">       if (!feedUrlArray[url])</span>
<a href="#l13.792"></a><span id="l13.792">         continue;</span>
<a href="#l13.793"></a><span id="l13.793">       let feedResource = rdf.GetResource(feedUrlArray[url]);</span>
<a href="#l13.794"></a><span id="l13.794" class="difflineminus">-      let feed = new Feed(feedResource, this.mRSSServer);</span>
<a href="#l13.795"></a><span id="l13.795" class="difflineplus">+      let feed = new Feed(feedResource, aFolder.server);</span>
<a href="#l13.796"></a><span id="l13.796">       feeds.push(feed);</span>
<a href="#l13.797"></a><span id="l13.797">     }</span>
<a href="#l13.798"></a><span id="l13.798"> </span>
<a href="#l13.799"></a><span id="l13.799">     return feeds;</span>
<a href="#l13.800"></a><span id="l13.800">   },</span>
<a href="#l13.801"></a><span id="l13.801"> </span>
<a href="#l13.802"></a><span id="l13.802">   makeFeedObject: function (aFeed, aFolder, aLevel)</span>
<a href="#l13.803"></a><span id="l13.803">   {</span>
<a href="#l13.804"></a><span id="l13.804" class="difflineminus">-    // look inside the data source for the feed properties</span>
<a href="#l13.805"></a><span id="l13.805" class="difflineminus">-    var feed = { children    : [],</span>
<a href="#l13.806"></a><span id="l13.806" class="difflineplus">+    // Look inside the data source for the feed properties.</span>
<a href="#l13.807"></a><span id="l13.807" class="difflineplus">+    let feed = { children    : [],</span>
<a href="#l13.808"></a><span id="l13.808">                  parentFolder: aFolder,</span>
<a href="#l13.809"></a><span id="l13.809">                  name        : aFeed.title || aFeed.description || aFeed.url,</span>
<a href="#l13.810"></a><span id="l13.810">                  url         : aFeed.url,</span>
<a href="#l13.811"></a><span id="l13.811" class="difflineplus">+                 quickMode   : aFeed.quickMode,</span>
<a href="#l13.812"></a><span id="l13.812">                  level       : aLevel,</span>
<a href="#l13.813"></a><span id="l13.813">                  open        : false,</span>
<a href="#l13.814"></a><span id="l13.814">                  container   : false };</span>
<a href="#l13.815"></a><span id="l13.815">     return feed;</span>
<a href="#l13.816"></a><span id="l13.816">   },</span>
<a href="#l13.817"></a><span id="l13.817"> </span>
<a href="#l13.818"></a><span id="l13.818" class="difflineminus">-  loadSubscriptions: function () </span>
<a href="#l13.819"></a><span id="l13.819" class="difflineplus">+  loadSubscriptions: function ()</span>
<a href="#l13.820"></a><span id="l13.820">   {</span>
<a href="#l13.821"></a><span id="l13.821" class="difflineminus">-    // put together an array of folders</span>
<a href="#l13.822"></a><span id="l13.822" class="difflineminus">-    var numFolders = 0;</span>
<a href="#l13.823"></a><span id="l13.823" class="difflineminus">-    this.mFeedContainers = [];</span>
<a href="#l13.824"></a><span id="l13.824" class="difflineplus">+    // Put together an array of folders.  Each feed account level folder is</span>
<a href="#l13.825"></a><span id="l13.825" class="difflineplus">+    // included as the root.</span>
<a href="#l13.826"></a><span id="l13.826" class="difflineplus">+    let numFolders = 0;</span>
<a href="#l13.827"></a><span id="l13.827" class="difflineplus">+    let feedRootFolders = [];</span>
<a href="#l13.828"></a><span id="l13.828" class="difflineplus">+    let feedContainers = [];</span>
<a href="#l13.829"></a><span id="l13.829"> </span>
<a href="#l13.830"></a><span id="l13.830" class="difflineminus">-    var folderEnumerator = this.mRSSServer.rootFolder.subFolders;</span>
<a href="#l13.831"></a><span id="l13.831" class="difflineminus">-</span>
<a href="#l13.832"></a><span id="l13.832" class="difflineminus">-    while (folderEnumerator.hasMoreElements())</span>
<a href="#l13.833"></a><span id="l13.833" class="difflineplus">+    // Get all the feed account folders.</span>
<a href="#l13.834"></a><span id="l13.834" class="difflineplus">+    let allServers = MailServices.accounts.allServers;</span>
<a href="#l13.835"></a><span id="l13.835" class="difflineplus">+    for (let i = 0; i &lt; allServers.Count(); i++)</span>
<a href="#l13.836"></a><span id="l13.836">     {</span>
<a href="#l13.837"></a><span id="l13.837" class="difflineminus">-      var folder = folderEnumerator.getNext();</span>
<a href="#l13.838"></a><span id="l13.838" class="difflineminus">-      if ((folder instanceof Components.interfaces.nsIMsgFolder) &amp;&amp;</span>
<a href="#l13.839"></a><span id="l13.839" class="difflineminus">-          !folder.getFlag(Components.interfaces.nsMsgFolderFlags.Trash) &amp;&amp;</span>
<a href="#l13.840"></a><span id="l13.840" class="difflineminus">-          !folder.getFlag(Components.interfaces.nsMsgFolderFlags.Virtual))</span>
<a href="#l13.841"></a><span id="l13.841" class="difflineminus">-      {</span>
<a href="#l13.842"></a><span id="l13.842" class="difflineminus">-        this.mFeedContainers.push(this.makeFolderObject(folder, 0));</span>
<a href="#l13.843"></a><span id="l13.843" class="difflineminus">-        numFolders++;</span>
<a href="#l13.844"></a><span id="l13.844" class="difflineminus">-      }</span>
<a href="#l13.845"></a><span id="l13.845" class="difflineplus">+      let currentServer = allServers.QueryElementAt(i, Ci.nsIMsgIncomingServer);</span>
<a href="#l13.846"></a><span id="l13.846" class="difflineplus">+      if (currentServer &amp;&amp; currentServer.type == &quot;rss&quot;)</span>
<a href="#l13.847"></a><span id="l13.847" class="difflineplus">+        feedRootFolders.push(currentServer.rootFolder);</span>
<a href="#l13.848"></a><span id="l13.848">     }</span>
<a href="#l13.849"></a><span id="l13.849" class="difflineplus">+</span>
<a href="#l13.850"></a><span id="l13.850" class="difflineplus">+    feedRootFolders.forEach(function(rootFolder) {</span>
<a href="#l13.851"></a><span id="l13.851" class="difflineplus">+      feedContainers.push(this.makeFolderObject(rootFolder, 0));</span>
<a href="#l13.852"></a><span id="l13.852" class="difflineplus">+      numFolders++;</span>
<a href="#l13.853"></a><span id="l13.853" class="difflineplus">+    }, this);</span>
<a href="#l13.854"></a><span id="l13.854" class="difflineplus">+</span>
<a href="#l13.855"></a><span id="l13.855" class="difflineplus">+    this.mFeedContainers = feedContainers;</span>
<a href="#l13.856"></a><span id="l13.856">     this.mView.mRowCount = numFolders;</span>
<a href="#l13.857"></a><span id="l13.857"> </span>
<a href="#l13.858"></a><span id="l13.858">     gFeedSubscriptionsWindow.mTree.focus();</span>
<a href="#l13.859"></a><span id="l13.859">   },</span>
<a href="#l13.860"></a><span id="l13.860"> </span>
<a href="#l13.861"></a><span id="l13.861" class="difflineminus">-  selectFolder: function(aFolder)</span>
<a href="#l13.862"></a><span id="l13.862" class="difflineplus">+  /**</span>
<a href="#l13.863"></a><span id="l13.863" class="difflineplus">+   * Find the folder in the tree.  The search may be limited to subfolders of</span>
<a href="#l13.864"></a><span id="l13.864" class="difflineplus">+   * a known folder, or expanded to include the entire tree.  The first</span>
<a href="#l13.865"></a><span id="l13.865" class="difflineplus">+   * occurence of a folder URI will be selected.</span>
<a href="#l13.866"></a><span id="l13.866" class="difflineplus">+   * </span>
<a href="#l13.867"></a><span id="l13.867" class="difflineplus">+   * @param  aFolder nsIMsgFolder - the folder to find.</span>
<a href="#l13.868"></a><span id="l13.868" class="difflineplus">+   * @param  [aSelect] boolean    - if true (default) the folder's ancestors</span>
<a href="#l13.869"></a><span id="l13.869" class="difflineplus">+   *                                will be opened and the folder selected.</span>
<a href="#l13.870"></a><span id="l13.870" class="difflineplus">+   * @param  [aParentIndex] int   - index of folder to start the search.</span>
<a href="#l13.871"></a><span id="l13.871" class="difflineplus">+   * @param  [aOpen] boolean      - if true (default) the folder is opened.</span>
<a href="#l13.872"></a><span id="l13.872" class="difflineplus">+   * </span>
<a href="#l13.873"></a><span id="l13.873" class="difflineplus">+   * @return bool found - true if found, false if not.</span>
<a href="#l13.874"></a><span id="l13.874" class="difflineplus">+   */</span>
<a href="#l13.875"></a><span id="l13.875" class="difflineplus">+  selectFolder: function(aFolder, aSelect, aParentIndex, aOpen)</span>
<a href="#l13.876"></a><span id="l13.876">   {</span>
<a href="#l13.877"></a><span id="l13.877" class="difflineminus">-    if (aFolder.isServer)</span>
<a href="#l13.878"></a><span id="l13.878" class="difflineminus">-      return;</span>
<a href="#l13.879"></a><span id="l13.879" class="difflineplus">+    let folderURI = aFolder.URI;</span>
<a href="#l13.880"></a><span id="l13.880" class="difflineplus">+    let selectIt = aSelect == null ? true : aSelect;</span>
<a href="#l13.881"></a><span id="l13.881" class="difflineplus">+    let openIt = aOpen == null ? true : aOpen;</span>
<a href="#l13.882"></a><span id="l13.882" class="difflineplus">+    let startIndex, startItem;</span>
<a href="#l13.883"></a><span id="l13.883" class="difflineplus">+    let found = false;</span>
<a href="#l13.884"></a><span id="l13.884"> </span>
<a href="#l13.885"></a><span id="l13.885" class="difflineminus">-    var folderURI = aFolder.QueryInterface(Components.interfaces.nsIRDFResource)</span>
<a href="#l13.886"></a><span id="l13.886" class="difflineminus">-                           .Value;</span>
<a href="#l13.887"></a><span id="l13.887" class="difflineplus">+    if (aFolder.isServer || aParentIndex != null)</span>
<a href="#l13.888"></a><span id="l13.888" class="difflineplus">+      // For a server, the aParentIndex doesn't matter, they are always visible.</span>
<a href="#l13.889"></a><span id="l13.889" class="difflineplus">+      startIndex = aParentIndex;</span>
<a href="#l13.890"></a><span id="l13.890" class="difflineplus">+    else</span>
<a href="#l13.891"></a><span id="l13.891" class="difflineplus">+    {</span>
<a href="#l13.892"></a><span id="l13.892" class="difflineplus">+      // Get the folder's root parent index.</span>
<a href="#l13.893"></a><span id="l13.893" class="difflineplus">+      let index = 0;</span>
<a href="#l13.894"></a><span id="l13.894" class="difflineplus">+      for (index; index &lt; this.mView.rowCount; index++)</span>
<a href="#l13.895"></a><span id="l13.895" class="difflineplus">+      {</span>
<a href="#l13.896"></a><span id="l13.896" class="difflineplus">+        let item = this.mView.getItemAtIndex(index);</span>
<a href="#l13.897"></a><span id="l13.897" class="difflineplus">+        if (item.url == aFolder.server.rootFolder.URI)</span>
<a href="#l13.898"></a><span id="l13.898" class="difflineplus">+          break;</span>
<a href="#l13.899"></a><span id="l13.899" class="difflineplus">+      }</span>
<a href="#l13.900"></a><span id="l13.900" class="difflineplus">+      startIndex = index;</span>
<a href="#l13.901"></a><span id="l13.901" class="difflineplus">+    }</span>
<a href="#l13.902"></a><span id="l13.902" class="difflineplus">+</span>
<a href="#l13.903"></a><span id="l13.903" class="difflineplus">+    if (!aFolder.isServer)</span>
<a href="#l13.904"></a><span id="l13.904" class="difflineplus">+      startItem = this.mView.getItemAtIndex(startIndex);</span>
<a href="#l13.905"></a><span id="l13.905"> </span>
<a href="#l13.906"></a><span id="l13.906">     function containsFolder(aItem)</span>
<a href="#l13.907"></a><span id="l13.907">     {</span>
<a href="#l13.908"></a><span id="l13.908" class="difflineminus">-      var items = aItem ? aItem.children : this.mFeedContainers;</span>
<a href="#l13.909"></a><span id="l13.909" class="difflineminus">-      for (var i = 0; i &lt; items.length; i++) {</span>
<a href="#l13.910"></a><span id="l13.910" class="difflineminus">-        if (items[i].url == folderURI ||</span>
<a href="#l13.911"></a><span id="l13.911" class="difflineminus">-            item.container &amp;&amp; containsFolder(items[i]))</span>
<a href="#l13.912"></a><span id="l13.912" class="difflineminus">-          return true;</span>
<a href="#l13.913"></a><span id="l13.913" class="difflineplus">+      // Search for the folder.  If it's found, set the open state on all</span>
<a href="#l13.914"></a><span id="l13.914" class="difflineplus">+      // ancestor folders.  A toggle() rebuilds the view rows to match the map.</span>
<a href="#l13.915"></a><span id="l13.915" class="difflineplus">+      if (aItem.url == folderURI)</span>
<a href="#l13.916"></a><span id="l13.916" class="difflineplus">+        return true;</span>
<a href="#l13.917"></a><span id="l13.917" class="difflineplus">+</span>
<a href="#l13.918"></a><span id="l13.918" class="difflineplus">+      for (let i = 0; i &lt; aItem.children.length; i++) {</span>
<a href="#l13.919"></a><span id="l13.919" class="difflineplus">+        if (aItem.children[i].container &amp;&amp; containsFolder(aItem.children[i]))</span>
<a href="#l13.920"></a><span id="l13.920" class="difflineplus">+          return aItem.children[i].open = true;</span>
<a href="#l13.921"></a><span id="l13.921">       }</span>
<a href="#l13.922"></a><span id="l13.922" class="difflineplus">+</span>
<a href="#l13.923"></a><span id="l13.923">       return false;</span>
<a href="#l13.924"></a><span id="l13.924">     }</span>
<a href="#l13.925"></a><span id="l13.925"> </span>
<a href="#l13.926"></a><span id="l13.926" class="difflineminus">-    for (var index = 0; index &lt; this.mView.rowCount; index++)</span>
<a href="#l13.927"></a><span id="l13.927" class="difflineplus">+    if (startItem)</span>
<a href="#l13.928"></a><span id="l13.928">     {</span>
<a href="#l13.929"></a><span id="l13.929" class="difflineminus">-      var item = this.mView.getItemAtIndex(index);</span>
<a href="#l13.930"></a><span id="l13.930" class="difflineminus">-      if (item.url == folderURI || containsFolder(item))</span>
<a href="#l13.931"></a><span id="l13.931" class="difflineplus">+      // Find a folder with a specific parent.</span>
<a href="#l13.932"></a><span id="l13.932" class="difflineplus">+      found = containsFolder(startItem);</span>
<a href="#l13.933"></a><span id="l13.933" class="difflineplus">+      if (!found)</span>
<a href="#l13.934"></a><span id="l13.934" class="difflineplus">+        return false;</span>
<a href="#l13.935"></a><span id="l13.935" class="difflineplus">+</span>
<a href="#l13.936"></a><span id="l13.936" class="difflineplus">+      if (!selectIt)</span>
<a href="#l13.937"></a><span id="l13.937" class="difflineplus">+        return true;</span>
<a href="#l13.938"></a><span id="l13.938" class="difflineplus">+</span>
<a href="#l13.939"></a><span id="l13.939" class="difflineplus">+      if (startItem.open)</span>
<a href="#l13.940"></a><span id="l13.940" class="difflineplus">+        this.mView.toggle(startIndex);</span>
<a href="#l13.941"></a><span id="l13.941" class="difflineplus">+      this.mView.toggle(startIndex);</span>
<a href="#l13.942"></a><span id="l13.942" class="difflineplus">+    }</span>
<a href="#l13.943"></a><span id="l13.943" class="difflineplus">+</span>
<a href="#l13.944"></a><span id="l13.944" class="difflineplus">+    for (let index = 0; index &lt; this.mView.rowCount &amp;&amp; selectIt; index++)</span>
<a href="#l13.945"></a><span id="l13.945" class="difflineplus">+    {</span>
<a href="#l13.946"></a><span id="l13.946" class="difflineplus">+      // The desired folder is now in the view.</span>
<a href="#l13.947"></a><span id="l13.947" class="difflineplus">+      let item = this.mView.getItemAtIndex(index);</span>
<a href="#l13.948"></a><span id="l13.948" class="difflineplus">+      if (!item.container)</span>
<a href="#l13.949"></a><span id="l13.949" class="difflineplus">+        continue;</span>
<a href="#l13.950"></a><span id="l13.950" class="difflineplus">+      if (item.url == folderURI)</span>
<a href="#l13.951"></a><span id="l13.951">       {</span>
<a href="#l13.952"></a><span id="l13.952" class="difflineminus">-        if (!item.open)</span>
<a href="#l13.953"></a><span id="l13.953" class="difflineminus">-          this.mView.toggleOpenState(index);</span>
<a href="#l13.954"></a><span id="l13.954" class="difflineminus">-        if (item.url == folderURI) {</span>
<a href="#l13.955"></a><span id="l13.955" class="difflineminus">-          // we found the actual folder - not an ancestor</span>
<a href="#l13.956"></a><span id="l13.956" class="difflineminus">-          this.mTree.view.selection.select(index);</span>
<a href="#l13.957"></a><span id="l13.957" class="difflineminus">-          this.mTree.boxObject.ensureRowIsVisible(index);</span>
<a href="#l13.958"></a><span id="l13.958" class="difflineminus">-          break;</span>
<a href="#l13.959"></a><span id="l13.959" class="difflineplus">+        if (item.children.length &amp;&amp; !item.open &amp;&amp; openIt)</span>
<a href="#l13.960"></a><span id="l13.960" class="difflineplus">+          this.mView.toggle(index);</span>
<a href="#l13.961"></a><span id="l13.961" class="difflineplus">+        this.mView.selection.select(index);</span>
<a href="#l13.962"></a><span id="l13.962" class="difflineplus">+        this.mView.treeBox.ensureRowIsVisible(index);</span>
<a href="#l13.963"></a><span id="l13.963" class="difflineplus">+        found = true;</span>
<a href="#l13.964"></a><span id="l13.964" class="difflineplus">+        break;</span>
<a href="#l13.965"></a><span id="l13.965" class="difflineplus">+      }</span>
<a href="#l13.966"></a><span id="l13.966" class="difflineplus">+    }</span>
<a href="#l13.967"></a><span id="l13.967" class="difflineplus">+</span>
<a href="#l13.968"></a><span id="l13.968" class="difflineplus">+    if (this.mView.selection.selectEventsSuppressed)</span>
<a href="#l13.969"></a><span id="l13.969" class="difflineplus">+      this.mView.selection.selectEventsSuppressed = false;</span>
<a href="#l13.970"></a><span id="l13.970" class="difflineplus">+    return found;</span>
<a href="#l13.971"></a><span id="l13.971" class="difflineplus">+  },</span>
<a href="#l13.972"></a><span id="l13.972" class="difflineplus">+</span>
<a href="#l13.973"></a><span id="l13.973" class="difflineplus">+  /**</span>
<a href="#l13.974"></a><span id="l13.974" class="difflineplus">+   * Find the feed in the tree.  The search first gets the feed's folder,</span>
<a href="#l13.975"></a><span id="l13.975" class="difflineplus">+   * then selects the child feed.</span>
<a href="#l13.976"></a><span id="l13.976" class="difflineplus">+   * </span>
<a href="#l13.977"></a><span id="l13.977" class="difflineplus">+   * @param  aFeed {Feed object}    - the feed to find.</span>
<a href="#l13.978"></a><span id="l13.978" class="difflineplus">+   * @param  [aParentIndex] integer - index to start the folder search.</span>
<a href="#l13.979"></a><span id="l13.979" class="difflineplus">+   * </span>
<a href="#l13.980"></a><span id="l13.980" class="difflineplus">+   * @return found bool - true if found, false if not.</span>
<a href="#l13.981"></a><span id="l13.981" class="difflineplus">+   */</span>
<a href="#l13.982"></a><span id="l13.982" class="difflineplus">+  selectFeed: function(aFeed, aParentIndex)</span>
<a href="#l13.983"></a><span id="l13.983" class="difflineplus">+  {</span>
<a href="#l13.984"></a><span id="l13.984" class="difflineplus">+    let found = false;</span>
<a href="#l13.985"></a><span id="l13.985" class="difflineplus">+    if (this.selectFolder(aFeed.folder, true, aParentIndex))</span>
<a href="#l13.986"></a><span id="l13.986" class="difflineplus">+    {</span>
<a href="#l13.987"></a><span id="l13.987" class="difflineplus">+      let seln = this.mView.selection;</span>
<a href="#l13.988"></a><span id="l13.988" class="difflineplus">+      let item = this.mView.currentItem;</span>
<a href="#l13.989"></a><span id="l13.989" class="difflineplus">+      if (item) {</span>
<a href="#l13.990"></a><span id="l13.990" class="difflineplus">+        for (let i = seln.currentIndex + 1; i &lt; this.mView.rowCount; i++) {</span>
<a href="#l13.991"></a><span id="l13.991" class="difflineplus">+          if (this.mView.getItemAtIndex(i).url == aFeed.url) {</span>
<a href="#l13.992"></a><span id="l13.992" class="difflineplus">+            this.mView.selection.select(i);</span>
<a href="#l13.993"></a><span id="l13.993" class="difflineplus">+            this.mView.treeBox.ensureRowIsVisible(i);</span>
<a href="#l13.994"></a><span id="l13.994" class="difflineplus">+            found = true;</span>
<a href="#l13.995"></a><span id="l13.995" class="difflineplus">+            break;</span>
<a href="#l13.996"></a><span id="l13.996" class="difflineplus">+          }</span>
<a href="#l13.997"></a><span id="l13.997">         }</span>
<a href="#l13.998"></a><span id="l13.998">       }</span>
<a href="#l13.999"></a><span id="l13.999">     }</span>
<a href="#l13.1000"></a><span id="l13.1000" class="difflineminus">-  },</span>
<a href="#l13.1001"></a><span id="l13.1001"> </span>
<a href="#l13.1002"></a><span id="l13.1002" class="difflineminus">-  selectFeed: function(aFeed)</span>
<a href="#l13.1003"></a><span id="l13.1003" class="difflineminus">-  {</span>
<a href="#l13.1004"></a><span id="l13.1004" class="difflineminus">-    this.selectFolder(aFeed.folder);</span>
<a href="#l13.1005"></a><span id="l13.1005" class="difflineminus">-</span>
<a href="#l13.1006"></a><span id="l13.1006" class="difflineminus">-    var seln = this.mTree.view.selection;</span>
<a href="#l13.1007"></a><span id="l13.1007" class="difflineminus">-    var item = this.mView.getItemAtIndex(seln.currentIndex);</span>
<a href="#l13.1008"></a><span id="l13.1008" class="difflineminus">-    if (item) {</span>
<a href="#l13.1009"></a><span id="l13.1009" class="difflineminus">-      for (var i = 0; i &lt; item.children.length; i++) {</span>
<a href="#l13.1010"></a><span id="l13.1010" class="difflineminus">-        if (item.children[i].url == aFeed.url) {</span>
<a href="#l13.1011"></a><span id="l13.1011" class="difflineminus">-          var index = seln.currentIndex + i + 1;</span>
<a href="#l13.1012"></a><span id="l13.1012" class="difflineminus">-          this.mTree.view.selection.select(index);</span>
<a href="#l13.1013"></a><span id="l13.1013" class="difflineminus">-          this.mTree.boxObject.ensureRowIsVisible(index);</span>
<a href="#l13.1014"></a><span id="l13.1014" class="difflineminus">-          break;</span>
<a href="#l13.1015"></a><span id="l13.1015" class="difflineminus">-        }</span>
<a href="#l13.1016"></a><span id="l13.1016" class="difflineminus">-      }</span>
<a href="#l13.1017"></a><span id="l13.1017" class="difflineminus">-    }</span>
<a href="#l13.1018"></a><span id="l13.1018" class="difflineplus">+    return found;</span>
<a href="#l13.1019"></a><span id="l13.1019">   },</span>
<a href="#l13.1020"></a><span id="l13.1020"> </span>
<a href="#l13.1021"></a><span id="l13.1021">   updateFeedData: function (aItem)</span>
<a href="#l13.1022"></a><span id="l13.1022">   {</span>
<a href="#l13.1023"></a><span id="l13.1023" class="difflineminus">-    var ids = ['nameLabel', 'nameValue', 'locationLabel', 'locationValue'];</span>
<a href="#l13.1024"></a><span id="l13.1024" class="difflineminus">-    if (aItem &amp;&amp; !aItem.container) </span>
<a href="#l13.1025"></a><span id="l13.1025" class="difflineplus">+    if (!aItem)</span>
<a href="#l13.1026"></a><span id="l13.1026" class="difflineplus">+      return;</span>
<a href="#l13.1027"></a><span id="l13.1027" class="difflineplus">+</span>
<a href="#l13.1028"></a><span id="l13.1028" class="difflineplus">+    let nameValue = document.getElementById(&quot;nameValue&quot;);</span>
<a href="#l13.1029"></a><span id="l13.1029" class="difflineplus">+    let locationValue = document.getElementById(&quot;locationValue&quot;);</span>
<a href="#l13.1030"></a><span id="l13.1030" class="difflineplus">+    let selectFolder = document.getElementById(&quot;selectFolder&quot;);</span>
<a href="#l13.1031"></a><span id="l13.1031" class="difflineplus">+    let rssAccountMenuItem = document.getElementById(&quot;rssAccountMenuItem&quot;);</span>
<a href="#l13.1032"></a><span id="l13.1032" class="difflineplus">+    let server, rootFolder, displayFolder;</span>
<a href="#l13.1033"></a><span id="l13.1033" class="difflineplus">+</span>
<a href="#l13.1034"></a><span id="l13.1034" class="difflineplus">+    if (!aItem.container)</span>
<a href="#l13.1035"></a><span id="l13.1035">     {</span>
<a href="#l13.1036"></a><span id="l13.1036" class="difflineminus">-      // set the feed location and title info</span>
<a href="#l13.1037"></a><span id="l13.1037" class="difflineminus">-      document.getElementById('nameValue').value = aItem.name;</span>
<a href="#l13.1038"></a><span id="l13.1038" class="difflineminus">-      document.getElementById('locationValue').value = aItem.url;</span>
<a href="#l13.1039"></a><span id="l13.1039" class="difflineplus">+      // A feed item.  Set the feed location and title info.</span>
<a href="#l13.1040"></a><span id="l13.1040" class="difflineplus">+      nameValue.value = aItem.name;</span>
<a href="#l13.1041"></a><span id="l13.1041" class="difflineplus">+      locationValue.value = aItem.url;</span>
<a href="#l13.1042"></a><span id="l13.1042" class="difflineplus">+</span>
<a href="#l13.1043"></a><span id="l13.1043" class="difflineplus">+      // Root the location picker to the news &amp; blogs server.</span>
<a href="#l13.1044"></a><span id="l13.1044" class="difflineplus">+      server = aItem.parentFolder.server;</span>
<a href="#l13.1045"></a><span id="l13.1045" class="difflineplus">+      rootFolder = aItem.parentFolder.rootFolder;</span>
<a href="#l13.1046"></a><span id="l13.1046" class="difflineplus">+      displayFolder = aItem.parentFolder;</span>
<a href="#l13.1047"></a><span id="l13.1047">     }</span>
<a href="#l13.1048"></a><span id="l13.1048" class="difflineminus">-    else </span>
<a href="#l13.1049"></a><span id="l13.1049" class="difflineplus">+    else</span>
<a href="#l13.1050"></a><span id="l13.1050">     {</span>
<a href="#l13.1051"></a><span id="l13.1051" class="difflineminus">-      var noneSelected = this.mBundle.getString('subscribe-noFeedIsSelected');</span>
<a href="#l13.1052"></a><span id="l13.1052" class="difflineminus">-      document.getElementById('nameValue').value = noneSelected;</span>
<a href="#l13.1053"></a><span id="l13.1053" class="difflineminus">-      document.getElementById('locationValue').value = &quot;&quot;;</span>
<a href="#l13.1054"></a><span id="l13.1054" class="difflineplus">+      // A folder/container item.</span>
<a href="#l13.1055"></a><span id="l13.1055" class="difflineplus">+      nameValue.value = &quot;&quot;;</span>
<a href="#l13.1056"></a><span id="l13.1056" class="difflineplus">+      nameValue.disabled = true;</span>
<a href="#l13.1057"></a><span id="l13.1057" class="difflineplus">+      locationValue.value = &quot;&quot;;</span>
<a href="#l13.1058"></a><span id="l13.1058" class="difflineplus">+</span>
<a href="#l13.1059"></a><span id="l13.1059" class="difflineplus">+      server = aItem.folder.server;</span>
<a href="#l13.1060"></a><span id="l13.1060" class="difflineplus">+      rootFolder = aItem.folder.rootFolder;</span>
<a href="#l13.1061"></a><span id="l13.1061" class="difflineplus">+      displayFolder = aItem.folder;</span>
<a href="#l13.1062"></a><span id="l13.1062">     }</span>
<a href="#l13.1063"></a><span id="l13.1063"> </span>
<a href="#l13.1064"></a><span id="l13.1064" class="difflineminus">-    for (var i = 0; i &lt; ids.length; ++i)</span>
<a href="#l13.1065"></a><span id="l13.1065" class="difflineminus">-      document.getElementById(ids[i]).disabled = !aItem || aItem.container;</span>
<a href="#l13.1066"></a><span id="l13.1066" class="difflineplus">+    // Common to both folder and feed items.</span>
<a href="#l13.1067"></a><span id="l13.1067" class="difflineplus">+    nameValue.disabled = aItem.container;</span>
<a href="#l13.1068"></a><span id="l13.1068" class="difflineplus">+</span>
<a href="#l13.1069"></a><span id="l13.1069" class="difflineplus">+    selectFolder.setAttribute(&quot;ref&quot;, rootFolder.URI);</span>
<a href="#l13.1070"></a><span id="l13.1070" class="difflineplus">+    selectFolder.selectedIndex = -1;</span>
<a href="#l13.1071"></a><span id="l13.1071" class="difflineplus">+    selectFolder.disabled = aItem.container;</span>
<a href="#l13.1072"></a><span id="l13.1072" class="difflineplus">+    this.setFolderPicker(displayFolder.URI);</span>
<a href="#l13.1073"></a><span id="l13.1073" class="difflineplus">+</span>
<a href="#l13.1074"></a><span id="l13.1074" class="difflineplus">+    rssAccountMenuItem.label = server.prettyName;</span>
<a href="#l13.1075"></a><span id="l13.1075" class="difflineplus">+    rssAccountMenuItem.value = server.serverURI;</span>
<a href="#l13.1076"></a><span id="l13.1076" class="difflineplus">+    // A feed can't be added to the account folder.</span>
<a href="#l13.1077"></a><span id="l13.1077" class="difflineplus">+    rssAccountMenuItem.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l13.1078"></a><span id="l13.1078" class="difflineplus">+</span>
<a href="#l13.1079"></a><span id="l13.1079" class="difflineplus">+    // Set quick mode value.</span>
<a href="#l13.1080"></a><span id="l13.1080" class="difflineplus">+    document.getElementById(&quot;quickMode&quot;).checked = aItem.quickMode;</span>
<a href="#l13.1081"></a><span id="l13.1081" class="difflineplus">+  },</span>
<a href="#l13.1082"></a><span id="l13.1082" class="difflineplus">+</span>
<a href="#l13.1083"></a><span id="l13.1083" class="difflineplus">+  setFolderPicker: function(aFolderURI)</span>
<a href="#l13.1084"></a><span id="l13.1084" class="difflineplus">+  {</span>
<a href="#l13.1085"></a><span id="l13.1085" class="difflineplus">+    let selectFolder = document.getElementById(&quot;selectFolder&quot;);</span>
<a href="#l13.1086"></a><span id="l13.1086" class="difflineplus">+    let msgFolder = GetMsgFolderFromUri(aFolderURI, true);</span>
<a href="#l13.1087"></a><span id="l13.1087" class="difflineplus">+    if (!msgFolder)</span>
<a href="#l13.1088"></a><span id="l13.1088" class="difflineplus">+      return;</span>
<a href="#l13.1089"></a><span id="l13.1089" class="difflineplus">+</span>
<a href="#l13.1090"></a><span id="l13.1090" class="difflineplus">+    selectFolder.setAttribute(&quot;label&quot;, msgFolder.name);</span>
<a href="#l13.1091"></a><span id="l13.1091" class="difflineplus">+    selectFolder.setAttribute(&quot;uri&quot;, msgFolder.URI);</span>
<a href="#l13.1092"></a><span id="l13.1092">   },</span>
<a href="#l13.1093"></a><span id="l13.1093"> </span>
<a href="#l13.1094"></a><span id="l13.1094">   onKeyPress: function(aEvent)</span>
<a href="#l13.1095"></a><span id="l13.1095">   {</span>
<a href="#l13.1096"></a><span id="l13.1096" class="difflineminus">-    if (aEvent.keyCode == aEvent.DOM_VK_ENTER ||</span>
<a href="#l13.1097"></a><span id="l13.1097" class="difflineminus">-        aEvent.keyCode == aEvent.DOM_VK_RETURN)</span>
<a href="#l13.1098"></a><span id="l13.1098" class="difflineminus">-      this.editFeed();</span>
<a href="#l13.1099"></a><span id="l13.1099" class="difflineminus">-    else if (aEvent.keyCode == aEvent.DOM_VK_DELETE)</span>
<a href="#l13.1100"></a><span id="l13.1100" class="difflineminus">-      this.removeFeed();</span>
<a href="#l13.1101"></a><span id="l13.1101" class="difflineplus">+    if (aEvent.keyCode == aEvent.DOM_VK_DELETE)</span>
<a href="#l13.1102"></a><span id="l13.1102" class="difflineplus">+      this.removeFeed(true);</span>
<a href="#l13.1103"></a><span id="l13.1103" class="difflineplus">+</span>
<a href="#l13.1104"></a><span id="l13.1104" class="difflineplus">+    this.clearStatusInfo();</span>
<a href="#l13.1105"></a><span id="l13.1105">   },</span>
<a href="#l13.1106"></a><span id="l13.1106"> </span>
<a href="#l13.1107"></a><span id="l13.1107" class="difflineminus">-  onSelect: function () </span>
<a href="#l13.1108"></a><span id="l13.1108" class="difflineplus">+  onSelect: function ()</span>
<a href="#l13.1109"></a><span id="l13.1109">   {</span>
<a href="#l13.1110"></a><span id="l13.1110" class="difflineminus">-    var properties, item;</span>
<a href="#l13.1111"></a><span id="l13.1111" class="difflineminus">-    var seln = this.mTree.view.selection;</span>
<a href="#l13.1112"></a><span id="l13.1112" class="difflineminus">-    item = this.mView.getItemAtIndex(seln.currentIndex);</span>
<a href="#l13.1113"></a><span id="l13.1113" class="difflineplus">+    let item = this.mView.currentItem;</span>
<a href="#l13.1114"></a><span id="l13.1114" class="difflineplus">+    let isServer = item &amp;&amp; item.folder &amp;&amp; item.folder.isServer;</span>
<a href="#l13.1115"></a><span id="l13.1115" class="difflineplus">+    let disable;</span>
<a href="#l13.1116"></a><span id="l13.1116">     this.updateFeedData(item);</span>
<a href="#l13.1117"></a><span id="l13.1117" class="difflineminus">-    document.getElementById(&quot;removeFeed&quot;).disabled = !item || item.container;</span>
<a href="#l13.1118"></a><span id="l13.1118" class="difflineminus">-    document.getElementById(&quot;editFeed&quot;).disabled = !item || item.container;</span>
<a href="#l13.1119"></a><span id="l13.1119" class="difflineplus">+    disable = !item || (!item.container || this.mActionMode == this.kMoveMode);</span>
<a href="#l13.1120"></a><span id="l13.1120" class="difflineplus">+    document.getElementById(&quot;addFeed&quot;).disabled = disable;</span>
<a href="#l13.1121"></a><span id="l13.1121" class="difflineplus">+    disable = !item || (item.container &amp;&amp; this.mActionMode != this.kMoveMode);</span>
<a href="#l13.1122"></a><span id="l13.1122" class="difflineplus">+    document.getElementById(&quot;removeFeed&quot;).disabled = disable;</span>
<a href="#l13.1123"></a><span id="l13.1123" class="difflineplus">+    document.getElementById(&quot;editFeed&quot;).disabled = disable;</span>
<a href="#l13.1124"></a><span id="l13.1124" class="difflineplus">+    document.getElementById(&quot;importOPML&quot;).disabled = !item || !isServer;</span>
<a href="#l13.1125"></a><span id="l13.1125" class="difflineplus">+    document.getElementById(&quot;exportOPML&quot;).disabled = !item || !isServer;</span>
<a href="#l13.1126"></a><span id="l13.1126">   },</span>
<a href="#l13.1127"></a><span id="l13.1127"> </span>
<a href="#l13.1128"></a><span id="l13.1128" class="difflineminus">-  removeFeed: function ()</span>
<a href="#l13.1129"></a><span id="l13.1129" class="difflineplus">+  onClick: function (aEvent)</span>
<a href="#l13.1130"></a><span id="l13.1130">   {</span>
<a href="#l13.1131"></a><span id="l13.1131" class="difflineminus">-    var seln = this.mView.selection;</span>
<a href="#l13.1132"></a><span id="l13.1132" class="difflineplus">+    if (aEvent.button != 0)</span>
<a href="#l13.1133"></a><span id="l13.1133" class="difflineplus">+      return;</span>
<a href="#l13.1134"></a><span id="l13.1134" class="difflineplus">+</span>
<a href="#l13.1135"></a><span id="l13.1135" class="difflineplus">+    this.clearStatusInfo();</span>
<a href="#l13.1136"></a><span id="l13.1136" class="difflineplus">+  },</span>
<a href="#l13.1137"></a><span id="l13.1137" class="difflineplus">+</span>
<a href="#l13.1138"></a><span id="l13.1138" class="difflineplus">+  removeFeed: function (aPrompt)</span>
<a href="#l13.1139"></a><span id="l13.1139" class="difflineplus">+  {</span>
<a href="#l13.1140"></a><span id="l13.1140" class="difflineplus">+    let seln = this.mView.selection;</span>
<a href="#l13.1141"></a><span id="l13.1141">     if (seln.count != 1)</span>
<a href="#l13.1142"></a><span id="l13.1142">       return;</span>
<a href="#l13.1143"></a><span id="l13.1143"> </span>
<a href="#l13.1144"></a><span id="l13.1144" class="difflineminus">-    var itemToRemove = this.mView.getItemAtIndex(seln.currentIndex);</span>
<a href="#l13.1145"></a><span id="l13.1145" class="difflineplus">+    let itemToRemove = this.mView.getItemAtIndex(seln.currentIndex);</span>
<a href="#l13.1146"></a><span id="l13.1146"> </span>
<a href="#l13.1147"></a><span id="l13.1147">     if (!itemToRemove || itemToRemove.container)</span>
<a href="#l13.1148"></a><span id="l13.1148">       return;</span>
<a href="#l13.1149"></a><span id="l13.1149"> </span>
<a href="#l13.1150"></a><span id="l13.1150" class="difflineminus">-    // Confirm unsubscribe prompt.</span>
<a href="#l13.1151"></a><span id="l13.1151" class="difflineminus">-    var promptService = Components.classes[&quot;@mozilla.org/embedcomp/prompt-service;1&quot;]</span>
<a href="#l13.1152"></a><span id="l13.1152" class="difflineminus">-                                  .getService(IPS);</span>
<a href="#l13.1153"></a><span id="l13.1153" class="difflineminus">-    var pTitle = this.mBundle.getString('subscribe-confirmFeedDeletionTitle');</span>
<a href="#l13.1154"></a><span id="l13.1154" class="difflineminus">-    var pMessage = this.mBundle.getFormattedString('subscribe-confirmFeedDeletion',</span>
<a href="#l13.1155"></a><span id="l13.1155" class="difflineminus">-                                                   [itemToRemove.name], 1);</span>
<a href="#l13.1156"></a><span id="l13.1156" class="difflineminus">-    var abortRemoval = promptService.confirmEx(window, pTitle, pMessage,</span>
<a href="#l13.1157"></a><span id="l13.1157" class="difflineminus">-                                               IPS.STD_YES_NO_BUTTONS,</span>
<a href="#l13.1158"></a><span id="l13.1158" class="difflineminus">-                                               null, null, null, null, { });</span>
<a href="#l13.1159"></a><span id="l13.1159" class="difflineminus">-    if (abortRemoval)</span>
<a href="#l13.1160"></a><span id="l13.1160" class="difflineminus">-      return;</span>
<a href="#l13.1161"></a><span id="l13.1161" class="difflineplus">+    if (aPrompt)</span>
<a href="#l13.1162"></a><span id="l13.1162" class="difflineplus">+    {</span>
<a href="#l13.1163"></a><span id="l13.1163" class="difflineplus">+      // Confirm unsubscribe prompt.</span>
<a href="#l13.1164"></a><span id="l13.1164" class="difflineplus">+      let pTitle = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.1165"></a><span id="l13.1165" class="difflineplus">+                     &quot;subscribe-confirmFeedDeletionTitle&quot;);</span>
<a href="#l13.1166"></a><span id="l13.1166" class="difflineplus">+      let pMessage = FeedUtils.strings.formatStringFromName(</span>
<a href="#l13.1167"></a><span id="l13.1167" class="difflineplus">+                       &quot;subscribe-confirmFeedDeletion&quot;, [itemToRemove.name], 1);</span>
<a href="#l13.1168"></a><span id="l13.1168" class="difflineplus">+      if (Services.prompt.confirmEx(window, pTitle, pMessage,</span>
<a href="#l13.1169"></a><span id="l13.1169" class="difflineplus">+                                    Ci.nsIPromptService.STD_YES_NO_BUTTONS,</span>
<a href="#l13.1170"></a><span id="l13.1170" class="difflineplus">+                                    null, null, null, null, { }))</span>
<a href="#l13.1171"></a><span id="l13.1171" class="difflineplus">+        return;</span>
<a href="#l13.1172"></a><span id="l13.1172" class="difflineplus">+    }</span>
<a href="#l13.1173"></a><span id="l13.1173"> </span>
<a href="#l13.1174"></a><span id="l13.1174">     deleteFeed(rdf.GetResource(itemToRemove.url),</span>
<a href="#l13.1175"></a><span id="l13.1175" class="difflineminus">-                               this.mRSSServer,</span>
<a href="#l13.1176"></a><span id="l13.1176" class="difflineminus">-                               itemToRemove.parentFolder);</span>
<a href="#l13.1177"></a><span id="l13.1177" class="difflineplus">+               itemToRemove.parentFolder.server,</span>
<a href="#l13.1178"></a><span id="l13.1178" class="difflineplus">+               itemToRemove.parentFolder);</span>
<a href="#l13.1179"></a><span id="l13.1179"> </span>
<a href="#l13.1180"></a><span id="l13.1180">     // Now that we have removed the feed from the datasource, it is time to</span>
<a href="#l13.1181"></a><span id="l13.1181">     // update our view layer.  Start by removing the child from its parent</span>
<a href="#l13.1182"></a><span id="l13.1182">     // folder object.</span>
<a href="#l13.1183"></a><span id="l13.1183" class="difflineminus">-    this.mView.removeItemAtIndex(seln.currentIndex);</span>
<a href="#l13.1184"></a><span id="l13.1184" class="difflineplus">+    this.mView.removeItemAtIndex(seln.currentIndex, false);</span>
<a href="#l13.1185"></a><span id="l13.1185" class="difflineplus">+    let message = FeedUtils.strings.GetStringFromName(&quot;subscribe-feedRemoved&quot;);</span>
<a href="#l13.1186"></a><span id="l13.1186" class="difflineplus">+    this.updateStatusItem(&quot;statusText&quot;, message);</span>
<a href="#l13.1187"></a><span id="l13.1187">   },</span>
<a href="#l13.1188"></a><span id="l13.1188"> </span>
<a href="#l13.1189"></a><span id="l13.1189" class="difflineminus">-  // aRootFolderURI --&gt; optional argument.  The folder to initially create</span>
<a href="#l13.1190"></a><span id="l13.1190" class="difflineminus">-  // the new feed under.</span>
<a href="#l13.1191"></a><span id="l13.1191" class="difflineminus">-  addFeed: function(aFeedLocation, aRootFolderURI)</span>
<a href="#l13.1192"></a><span id="l13.1192" class="difflineplus">+</span>
<a href="#l13.1193"></a><span id="l13.1193" class="difflineplus">+  /**</span>
<a href="#l13.1194"></a><span id="l13.1194" class="difflineplus">+   * This addFeed is used by 1) Add button, 1) Update button, 3) Drop of a</span>
<a href="#l13.1195"></a><span id="l13.1195" class="difflineplus">+   * feed url on a folder (which can be an add or move).  If Update, the new</span>
<a href="#l13.1196"></a><span id="l13.1196" class="difflineplus">+   * url is added and the old removed; thus aParse is false and no new messages</span>
<a href="#l13.1197"></a><span id="l13.1197" class="difflineplus">+   * are downloaded, the feed is only validated and stored in the db.  If dnd,</span>
<a href="#l13.1198"></a><span id="l13.1198" class="difflineplus">+   * the drop folder is selected and the url is prefilled, so proceed just as</span>
<a href="#l13.1199"></a><span id="l13.1199" class="difflineplus">+   * though the url were entered manually.  This allows a user to see the dnd</span>
<a href="#l13.1200"></a><span id="l13.1200" class="difflineplus">+   * url better in case of errors.</span>
<a href="#l13.1201"></a><span id="l13.1201" class="difflineplus">+   * </span>
<a href="#l13.1202"></a><span id="l13.1202" class="difflineplus">+   * @param  [aFeedLocation] string    - the feed url; get the url from the</span>
<a href="#l13.1203"></a><span id="l13.1203" class="difflineplus">+   *                                     input field if null.</span>
<a href="#l13.1204"></a><span id="l13.1204" class="difflineplus">+   * @param  [aFolder] nsIMsgFolder    - folder to subscribe, current selected</span>
<a href="#l13.1205"></a><span id="l13.1205" class="difflineplus">+   *                                     folder if null.</span>
<a href="#l13.1206"></a><span id="l13.1206" class="difflineplus">+   * @param  [aParse] boolean          - if true (default) parse and download</span>
<a href="#l13.1207"></a><span id="l13.1207" class="difflineplus">+   *                                     the feed's articles.</span>
<a href="#l13.1208"></a><span id="l13.1208" class="difflineplus">+   * @param  [aMode] integer           - action mode (default is kSubscribeMode)</span>
<a href="#l13.1209"></a><span id="l13.1209" class="difflineplus">+   *                                     of the add.</span>
<a href="#l13.1210"></a><span id="l13.1210" class="difflineplus">+   * </span>
<a href="#l13.1211"></a><span id="l13.1211" class="difflineplus">+   * @return success boolean           - true if edit checks passed and an</span>
<a href="#l13.1212"></a><span id="l13.1212" class="difflineplus">+   *                                     async download has been initiated.</span>
<a href="#l13.1213"></a><span id="l13.1213" class="difflineplus">+   */</span>
<a href="#l13.1214"></a><span id="l13.1214" class="difflineplus">+  addFeed: function(aFeedLocation, aFolder, aParse, aMode)</span>
<a href="#l13.1215"></a><span id="l13.1215">   {</span>
<a href="#l13.1216"></a><span id="l13.1216" class="difflineminus">-    var userAddedFeed = false; </span>
<a href="#l13.1217"></a><span id="l13.1217" class="difflineminus">-    var defaultQuickMode = this.mRSSServer.getBoolValue('quickMode');</span>
<a href="#l13.1218"></a><span id="l13.1218" class="difflineminus">-    var feedProperties = { feedName: &quot;&quot;, feedLocation: aFeedLocation, </span>
<a href="#l13.1219"></a><span id="l13.1219" class="difflineminus">-                           serverURI: this.mRSSServer.serverURI, </span>
<a href="#l13.1220"></a><span id="l13.1220" class="difflineminus">-                           serverPrettyName: this.mRSSServer.prettyName,  </span>
<a href="#l13.1221"></a><span id="l13.1221" class="difflineminus">-                           quickMode: this.mRSSServer.getBoolValue('quickMode'),</span>
<a href="#l13.1222"></a><span id="l13.1222" class="difflineminus">-                           newFeed: true,</span>
<a href="#l13.1223"></a><span id="l13.1223" class="difflineminus">-                           result: userAddedFeed};</span>
<a href="#l13.1224"></a><span id="l13.1224" class="difflineplus">+    let message;</span>
<a href="#l13.1225"></a><span id="l13.1225" class="difflineplus">+    let parse = aParse == null ? true : aParse;</span>
<a href="#l13.1226"></a><span id="l13.1226" class="difflineplus">+    let mode = aMode == null ? this.kSubscribeMode : aMode;</span>
<a href="#l13.1227"></a><span id="l13.1227" class="difflineplus">+    let locationValue = document.getElementById(&quot;locationValue&quot;);</span>
<a href="#l13.1228"></a><span id="l13.1228"> </span>
<a href="#l13.1229"></a><span id="l13.1229" class="difflineminus">-    // unless another folder is specified, default to currently selected</span>
<a href="#l13.1230"></a><span id="l13.1230" class="difflineminus">-    if (aRootFolderURI) {</span>
<a href="#l13.1231"></a><span id="l13.1231" class="difflineminus">-      feedProperties.folderURI = aRootFolderURI;</span>
<a href="#l13.1232"></a><span id="l13.1232" class="difflineminus">-    } else {</span>
<a href="#l13.1233"></a><span id="l13.1233" class="difflineminus">-      var index = this.mTree.view.selection.currentIndex;</span>
<a href="#l13.1234"></a><span id="l13.1234" class="difflineminus">-      var item = this.mView.getItemAtIndex(index);</span>
<a href="#l13.1235"></a><span id="l13.1235" class="difflineminus">-      if (item) {</span>
<a href="#l13.1236"></a><span id="l13.1236" class="difflineminus">-        if (!item.container)</span>
<a href="#l13.1237"></a><span id="l13.1237" class="difflineminus">-          item = this.mView.getItemAtIndex(this.mView.getParentIndex(index));</span>
<a href="#l13.1238"></a><span id="l13.1238" class="difflineminus">-        feedProperties.folderURI = item.url;</span>
<a href="#l13.1239"></a><span id="l13.1239" class="difflineminus">-      }</span>
<a href="#l13.1240"></a><span id="l13.1240" class="difflineplus">+    if (aFeedLocation)</span>
<a href="#l13.1241"></a><span id="l13.1241" class="difflineplus">+      locationValue.value = aFeedLocation;</span>
<a href="#l13.1242"></a><span id="l13.1242" class="difflineplus">+    let feedLocation = locationValue.value.trim();</span>
<a href="#l13.1243"></a><span id="l13.1243" class="difflineplus">+</span>
<a href="#l13.1244"></a><span id="l13.1244" class="difflineplus">+    if (!feedLocation)</span>
<a href="#l13.1245"></a><span id="l13.1245" class="difflineplus">+    {</span>
<a href="#l13.1246"></a><span id="l13.1246" class="difflineplus">+      message = locationValue.getAttribute(&quot;placeholder&quot;);</span>
<a href="#l13.1247"></a><span id="l13.1247" class="difflineplus">+      this.updateStatusItem(&quot;statusText&quot;, message);</span>
<a href="#l13.1248"></a><span id="l13.1248" class="difflineplus">+      return false;</span>
<a href="#l13.1249"></a><span id="l13.1249">     }</span>
<a href="#l13.1250"></a><span id="l13.1250"> </span>
<a href="#l13.1251"></a><span id="l13.1251" class="difflineminus">-    feedProperties = openFeedEditor(feedProperties);</span>
<a href="#l13.1252"></a><span id="l13.1252" class="difflineminus">-</span>
<a href="#l13.1253"></a><span id="l13.1253" class="difflineminus">-    // if the user hit cancel, exit without doing anything</span>
<a href="#l13.1254"></a><span id="l13.1254" class="difflineminus">-    if (!feedProperties.result)</span>
<a href="#l13.1255"></a><span id="l13.1255" class="difflineminus">-      return;</span>
<a href="#l13.1256"></a><span id="l13.1256" class="difflineplus">+    let addFolder;</span>
<a href="#l13.1257"></a><span id="l13.1257" class="difflineplus">+    if (aFolder)</span>
<a href="#l13.1258"></a><span id="l13.1258" class="difflineplus">+    {</span>
<a href="#l13.1259"></a><span id="l13.1259" class="difflineplus">+      // For Update or if passed a folder.</span>
<a href="#l13.1260"></a><span id="l13.1260" class="difflineplus">+      if (aFolder instanceof Ci.nsIMsgFolder)</span>
<a href="#l13.1261"></a><span id="l13.1261" class="difflineplus">+        addFolder = aFolder;</span>
<a href="#l13.1262"></a><span id="l13.1262" class="difflineplus">+    }</span>
<a href="#l13.1263"></a><span id="l13.1263" class="difflineplus">+    else</span>
<a href="#l13.1264"></a><span id="l13.1264" class="difflineplus">+    {</span>
<a href="#l13.1265"></a><span id="l13.1265" class="difflineplus">+      // A folder must be selected for Add and Drop.</span>
<a href="#l13.1266"></a><span id="l13.1266" class="difflineplus">+      let index = this.mView.selection.currentIndex;</span>
<a href="#l13.1267"></a><span id="l13.1267" class="difflineplus">+      let item = this.mView.getItemAtIndex(index);</span>
<a href="#l13.1268"></a><span id="l13.1268" class="difflineplus">+      if (item &amp;&amp; item.container)</span>
<a href="#l13.1269"></a><span id="l13.1269" class="difflineplus">+        addFolder = item.folder;</span>
<a href="#l13.1270"></a><span id="l13.1270" class="difflineplus">+    }</span>
<a href="#l13.1271"></a><span id="l13.1271"> </span>
<a href="#l13.1272"></a><span id="l13.1272" class="difflineminus">-    if (!feedProperties.feedLocation)</span>
<a href="#l13.1273"></a><span id="l13.1273" class="difflineminus">-      return;</span>
<a href="#l13.1274"></a><span id="l13.1274" class="difflineplus">+    // Shouldn't happen.  Or else not passed an nsIMsgFolder.</span>
<a href="#l13.1275"></a><span id="l13.1275" class="difflineplus">+    if (!addFolder)</span>
<a href="#l13.1276"></a><span id="l13.1276" class="difflineplus">+      return false;</span>
<a href="#l13.1277"></a><span id="l13.1277"> </span>
<a href="#l13.1278"></a><span id="l13.1278" class="difflineminus">-    // before we go any further, make sure the user is not already subscribed to this feed.</span>
<a href="#l13.1279"></a><span id="l13.1279" class="difflineminus">-    if (feedAlreadyExists(feedProperties.feedLocation, this.mRSSServer))</span>
<a href="#l13.1280"></a><span id="l13.1280" class="difflineplus">+    // Before we go any further, make sure the user is not already subscribed</span>
<a href="#l13.1281"></a><span id="l13.1281" class="difflineplus">+    // to this feed.</span>
<a href="#l13.1282"></a><span id="l13.1282" class="difflineplus">+    if (feedAlreadyExists(feedLocation, addFolder.server))</span>
<a href="#l13.1283"></a><span id="l13.1283">     {</span>
<a href="#l13.1284"></a><span id="l13.1284" class="difflineminus">-      var promptService = Components.classes[&quot;@mozilla.org/embedcomp/prompt-service;1&quot;].getService(IPS);</span>
<a href="#l13.1285"></a><span id="l13.1285" class="difflineminus">-      promptService.alert(window, null, this.mBundle.getString(&quot;subscribe-feedAlreadySubscribed&quot;));            </span>
<a href="#l13.1286"></a><span id="l13.1286" class="difflineminus">-      return;</span>
<a href="#l13.1287"></a><span id="l13.1287" class="difflineplus">+      message = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.1288"></a><span id="l13.1288" class="difflineplus">+                  &quot;subscribe-feedAlreadySubscribed&quot;);</span>
<a href="#l13.1289"></a><span id="l13.1289" class="difflineplus">+      this.updateStatusItem(&quot;statusText&quot;, message);</span>
<a href="#l13.1290"></a><span id="l13.1290" class="difflineplus">+      return false;</span>
<a href="#l13.1291"></a><span id="l13.1291">     }</span>
<a href="#l13.1292"></a><span id="l13.1292"> </span>
<a href="#l13.1293"></a><span id="l13.1293" class="difflineminus">-    var feed = this.storeFeed(feedProperties);</span>
<a href="#l13.1294"></a><span id="l13.1294" class="difflineminus">-    if (!feed)</span>
<a href="#l13.1295"></a><span id="l13.1295" class="difflineminus">-      return;</span>
<a href="#l13.1296"></a><span id="l13.1296" class="difflineplus">+    let name = document.getElementById(&quot;nameValue&quot;).value;</span>
<a href="#l13.1297"></a><span id="l13.1297" class="difflineplus">+    let quickMode = document.getElementById(&quot;quickMode&quot;).checked;</span>
<a href="#l13.1298"></a><span id="l13.1298" class="difflineplus">+    let folderURI = addFolder.isServer ? null : addFolder.URI;</span>
<a href="#l13.1299"></a><span id="l13.1299" class="difflineplus">+    let feedProperties = { feedName     : name,</span>
<a href="#l13.1300"></a><span id="l13.1300" class="difflineplus">+                           feedLocation : feedLocation,</span>
<a href="#l13.1301"></a><span id="l13.1301" class="difflineplus">+                           folderURI    : folderURI,</span>
<a href="#l13.1302"></a><span id="l13.1302" class="difflineplus">+                           server       : addFolder.server,</span>
<a href="#l13.1303"></a><span id="l13.1303" class="difflineplus">+                           quickMode    : quickMode };</span>
<a href="#l13.1304"></a><span id="l13.1304"> </span>
<a href="#l13.1305"></a><span id="l13.1305" class="difflineminus">-    // Now validate and start downloadng the feed....</span>
<a href="#l13.1306"></a><span id="l13.1306" class="difflineminus">-    updateStatusItem('statusText', document.getElementById('bundle_newsblog')</span>
<a href="#l13.1307"></a><span id="l13.1307" class="difflineminus">-                                           .getString('subscribe-validating-feed'));</span>
<a href="#l13.1308"></a><span id="l13.1308" class="difflineminus">-    updateStatusItem('progressMeter', 0);</span>
<a href="#l13.1309"></a><span id="l13.1309" class="difflineminus">-    document.getElementById('addFeed').setAttribute('disabled', 'true');</span>
<a href="#l13.1310"></a><span id="l13.1310" class="difflineminus">-    feed.download(true, this.mFeedDownloadCallback);</span>
<a href="#l13.1311"></a><span id="l13.1311" class="difflineplus">+    let feed = this.storeFeed(feedProperties);</span>
<a href="#l13.1312"></a><span id="l13.1312" class="difflineplus">+    if (!feed)</span>
<a href="#l13.1313"></a><span id="l13.1313" class="difflineplus">+      return false;</span>
<a href="#l13.1314"></a><span id="l13.1314" class="difflineplus">+</span>
<a href="#l13.1315"></a><span id="l13.1315" class="difflineplus">+    // Now validate and start downloading the feed.</span>
<a href="#l13.1316"></a><span id="l13.1316" class="difflineplus">+    message = FeedUtils.strings.GetStringFromName(&quot;subscribe-validating-feed&quot;);</span>
<a href="#l13.1317"></a><span id="l13.1317" class="difflineplus">+    this.updateStatusItem(&quot;statusText&quot;, message);</span>
<a href="#l13.1318"></a><span id="l13.1318" class="difflineplus">+    this.updateStatusItem(&quot;progressMeter&quot;, 0);</span>
<a href="#l13.1319"></a><span id="l13.1319" class="difflineplus">+    document.getElementById(&quot;addFeed&quot;).setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l13.1320"></a><span id="l13.1320" class="difflineplus">+    this.mActionMode = mode;</span>
<a href="#l13.1321"></a><span id="l13.1321" class="difflineplus">+    feed.download(parse, this.mFeedDownloadCallback);</span>
<a href="#l13.1322"></a><span id="l13.1322" class="difflineplus">+    return true;</span>
<a href="#l13.1323"></a><span id="l13.1323">   },</span>
<a href="#l13.1324"></a><span id="l13.1324"> </span>
<a href="#l13.1325"></a><span id="l13.1325" class="difflineminus">-  // helper routine used by addFeed and importOPMLFile</span>
<a href="#l13.1326"></a><span id="l13.1326" class="difflineplus">+  // Helper routine used by addFeed and importOPMLFile.</span>
<a href="#l13.1327"></a><span id="l13.1327">   storeFeed: function(feedProperties)</span>
<a href="#l13.1328"></a><span id="l13.1328">   {</span>
<a href="#l13.1329"></a><span id="l13.1329" class="difflineminus">-    var itemResource = rdf.GetResource(feedProperties.feedLocation);</span>
<a href="#l13.1330"></a><span id="l13.1330" class="difflineminus">-    var feed = new Feed(itemResource, this.mRSSServer);</span>
<a href="#l13.1331"></a><span id="l13.1331" class="difflineplus">+    let itemResource = rdf.GetResource(feedProperties.feedLocation);</span>
<a href="#l13.1332"></a><span id="l13.1332" class="difflineplus">+    let feed = new Feed(itemResource, feedProperties.server);</span>
<a href="#l13.1333"></a><span id="l13.1333"> </span>
<a href="#l13.1334"></a><span id="l13.1334" class="difflineminus">-    // if the user specified a specific folder to add the feed too, then set it here</span>
<a href="#l13.1335"></a><span id="l13.1335" class="difflineplus">+    // If the user specified a folder to add the feed to, then set it here.</span>
<a href="#l13.1336"></a><span id="l13.1336">     if (feedProperties.folderURI)</span>
<a href="#l13.1337"></a><span id="l13.1337">     {</span>
<a href="#l13.1338"></a><span id="l13.1338" class="difflineminus">-      var folderResource = rdf.GetResource(feedProperties.folderURI);   </span>
<a href="#l13.1339"></a><span id="l13.1339" class="difflineplus">+      let folderResource = rdf.GetResource(feedProperties.folderURI);</span>
<a href="#l13.1340"></a><span id="l13.1340">       if (folderResource)</span>
<a href="#l13.1341"></a><span id="l13.1341">       {</span>
<a href="#l13.1342"></a><span id="l13.1342" class="difflineminus">-        var folder = folderResource.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l13.1343"></a><span id="l13.1343" class="difflineplus">+        let folder = folderResource.QueryInterface(Ci.nsIMsgFolder);</span>
<a href="#l13.1344"></a><span id="l13.1344">         if (folder &amp;&amp; !folder.isServer)</span>
<a href="#l13.1345"></a><span id="l13.1345">           feed.folder = folder;</span>
<a href="#l13.1346"></a><span id="l13.1346">       }</span>
<a href="#l13.1347"></a><span id="l13.1347">     }</span>
<a href="#l13.1348"></a><span id="l13.1348"> </span>
<a href="#l13.1349"></a><span id="l13.1349" class="difflineplus">+    feed.title = feedProperties.feedName;</span>
<a href="#l13.1350"></a><span id="l13.1350">     feed.quickMode = feedProperties.quickMode;</span>
<a href="#l13.1351"></a><span id="l13.1351">     return feed;</span>
<a href="#l13.1352"></a><span id="l13.1352">   },</span>
<a href="#l13.1353"></a><span id="l13.1353"> </span>
<a href="#l13.1354"></a><span id="l13.1354" class="difflineminus">-  editFeed: function() </span>
<a href="#l13.1355"></a><span id="l13.1355" class="difflineplus">+  editFeed: function()</span>
<a href="#l13.1356"></a><span id="l13.1356">   {</span>
<a href="#l13.1357"></a><span id="l13.1357" class="difflineminus">-    var seln = this.mView.selection;</span>
<a href="#l13.1358"></a><span id="l13.1358" class="difflineminus">-    if (seln.count != 1) </span>
<a href="#l13.1359"></a><span id="l13.1359" class="difflineplus">+    let seln = this.mView.selection;</span>
<a href="#l13.1360"></a><span id="l13.1360" class="difflineplus">+    if (seln.count != 1)</span>
<a href="#l13.1361"></a><span id="l13.1361">       return;</span>
<a href="#l13.1362"></a><span id="l13.1362"> </span>
<a href="#l13.1363"></a><span id="l13.1363" class="difflineminus">-    var itemToEdit = this.mView.getItemAtIndex(seln.currentIndex);</span>
<a href="#l13.1364"></a><span id="l13.1364" class="difflineminus">-    if (!itemToEdit || itemToEdit.container)</span>
<a href="#l13.1365"></a><span id="l13.1365" class="difflineplus">+    let itemToEdit = this.mView.getItemAtIndex(seln.currentIndex);</span>
<a href="#l13.1366"></a><span id="l13.1366" class="difflineplus">+    if (!itemToEdit || itemToEdit.container || !itemToEdit.parentFolder)</span>
<a href="#l13.1367"></a><span id="l13.1367">       return;</span>
<a href="#l13.1368"></a><span id="l13.1368"> </span>
<a href="#l13.1369"></a><span id="l13.1369" class="difflineminus">-    var resource = rdf.GetResource(itemToEdit.url);</span>
<a href="#l13.1370"></a><span id="l13.1370" class="difflineminus">-    var feed = new Feed(resource, this.mRSSServer);</span>
<a href="#l13.1371"></a><span id="l13.1371" class="difflineplus">+    let resource = rdf.GetResource(itemToEdit.url);</span>
<a href="#l13.1372"></a><span id="l13.1372" class="difflineplus">+    let currentFolderServer = itemToEdit.parentFolder.server;</span>
<a href="#l13.1373"></a><span id="l13.1373" class="difflineplus">+    let ds = getSubscriptionsDS(currentFolderServer);</span>
<a href="#l13.1374"></a><span id="l13.1374" class="difflineplus">+    let currentFolder = ds.GetTarget(resource, FZ_DESTFOLDER, true);</span>
<a href="#l13.1375"></a><span id="l13.1375" class="difflineplus">+    let currentFolderURI = currentFolder.QueryInterface(Ci.nsIRDFResource).Value;</span>
<a href="#l13.1376"></a><span id="l13.1376" class="difflineplus">+    let feed = new Feed(resource, currentFolderServer);</span>
<a href="#l13.1377"></a><span id="l13.1377"> </span>
<a href="#l13.1378"></a><span id="l13.1378" class="difflineminus">-    var ds = getSubscriptionsDS(this.mRSSServer);</span>
<a href="#l13.1379"></a><span id="l13.1379" class="difflineminus">-    var currentFolder = ds.GetTarget(resource, FZ_DESTFOLDER, true);</span>
<a href="#l13.1380"></a><span id="l13.1380" class="difflineminus">-    var currentFolderURI = currentFolder.QueryInterface(Components.interfaces.nsIRDFResource).Value;</span>
<a href="#l13.1381"></a><span id="l13.1381" class="difflineminus">-   </span>
<a href="#l13.1382"></a><span id="l13.1382" class="difflineminus">-    var userModifiedFeed = false; </span>
<a href="#l13.1383"></a><span id="l13.1383" class="difflineminus">-    var feedProperties = { feedLocation: itemToEdit.url, serverURI: this.mRSSServer.serverURI, </span>
<a href="#l13.1384"></a><span id="l13.1384" class="difflineminus">-                           serverPrettyName: this.mRSSServer.prettyName, folderURI: currentFolderURI, </span>
<a href="#l13.1385"></a><span id="l13.1385" class="difflineminus">-                           quickMode: feed.quickMode, newFeed: false, result: userModifiedFeed};</span>
<a href="#l13.1386"></a><span id="l13.1386" class="difflineplus">+    let editNameValue = document.getElementById(&quot;nameValue&quot;).value;</span>
<a href="#l13.1387"></a><span id="l13.1387" class="difflineplus">+    let editFeedLocation = document.getElementById(&quot;locationValue&quot;).value.trim();</span>
<a href="#l13.1388"></a><span id="l13.1388" class="difflineplus">+    let editQuickMode = document.getElementById(&quot;quickMode&quot;).checked;</span>
<a href="#l13.1389"></a><span id="l13.1389" class="difflineplus">+</span>
<a href="#l13.1390"></a><span id="l13.1390" class="difflineplus">+    if (feed.url != editFeedLocation)</span>
<a href="#l13.1391"></a><span id="l13.1391" class="difflineplus">+    {</span>
<a href="#l13.1392"></a><span id="l13.1392" class="difflineplus">+      // Updating a url.  We need to add the new url and delete the old, to</span>
<a href="#l13.1393"></a><span id="l13.1393" class="difflineplus">+      // ensure everything is cleaned up correctly.</span>
<a href="#l13.1394"></a><span id="l13.1394" class="difflineplus">+      this.addFeed(null, itemToEdit.parentFolder, false, this.kUpdateMode)</span>
<a href="#l13.1395"></a><span id="l13.1395" class="difflineplus">+      return;</span>
<a href="#l13.1396"></a><span id="l13.1396" class="difflineplus">+    }</span>
<a href="#l13.1397"></a><span id="l13.1397"> </span>
<a href="#l13.1398"></a><span id="l13.1398" class="difflineminus">-    feedProperties = openFeedEditor(feedProperties);</span>
<a href="#l13.1399"></a><span id="l13.1399" class="difflineminus">-    if (!feedProperties.result) // did the user cancel?</span>
<a href="#l13.1400"></a><span id="l13.1400" class="difflineminus">-      return;</span>
<a href="#l13.1401"></a><span id="l13.1401" class="difflineplus">+    let updated = false;</span>
<a href="#l13.1402"></a><span id="l13.1402" class="difflineplus">+    // Check to see if the title value changed.</span>
<a href="#l13.1403"></a><span id="l13.1403" class="difflineplus">+    if (feed.title != editNameValue)</span>
<a href="#l13.1404"></a><span id="l13.1404" class="difflineplus">+    {</span>
<a href="#l13.1405"></a><span id="l13.1405" class="difflineplus">+      feed.title = editNameValue;</span>
<a href="#l13.1406"></a><span id="l13.1406" class="difflineplus">+      itemToEdit.name = editNameValue;</span>
<a href="#l13.1407"></a><span id="l13.1407" class="difflineplus">+      updated = true;</span>
<a href="#l13.1408"></a><span id="l13.1408" class="difflineplus">+    }</span>
<a href="#l13.1409"></a><span id="l13.1409"> </span>
<a href="#l13.1410"></a><span id="l13.1410" class="difflineminus">-    // check to see if the quickMode value changed</span>
<a href="#l13.1411"></a><span id="l13.1411" class="difflineminus">-    if (feed.quickMode != feedProperties.quickMode)</span>
<a href="#l13.1412"></a><span id="l13.1412" class="difflineminus">-      feed.quickMode = feedProperties.quickMode;</span>
<a href="#l13.1413"></a><span id="l13.1413" class="difflineplus">+    // Check to see if the quickMode value changed.</span>
<a href="#l13.1414"></a><span id="l13.1414" class="difflineplus">+    if (feed.quickMode != editQuickMode)</span>
<a href="#l13.1415"></a><span id="l13.1415" class="difflineplus">+    {</span>
<a href="#l13.1416"></a><span id="l13.1416" class="difflineplus">+      feed.quickMode = editQuickMode;</span>
<a href="#l13.1417"></a><span id="l13.1417" class="difflineplus">+      itemToEdit.quickMode = editQuickMode;</span>
<a href="#l13.1418"></a><span id="l13.1418" class="difflineplus">+      updated = true;</span>
<a href="#l13.1419"></a><span id="l13.1419" class="difflineplus">+    }</span>
<a href="#l13.1420"></a><span id="l13.1420"> </span>
<a href="#l13.1421"></a><span id="l13.1421" class="difflineminus">-    // did the user change the folder URI for storing the feed?</span>
<a href="#l13.1422"></a><span id="l13.1422" class="difflineminus">-    if (feedProperties.folderURI &amp;&amp; feedProperties.folderURI != currentFolderURI)</span>
<a href="#l13.1423"></a><span id="l13.1423" class="difflineplus">+    // Did the user change the folder URI for storing the feed?</span>
<a href="#l13.1424"></a><span id="l13.1424" class="difflineplus">+    let editFolderURI =</span>
<a href="#l13.1425"></a><span id="l13.1425" class="difflineplus">+      document.getElementById(&quot;selectFolder&quot;).getAttribute(&quot;uri&quot;);</span>
<a href="#l13.1426"></a><span id="l13.1426" class="difflineplus">+    if (currentFolderURI != editFolderURI)</span>
<a href="#l13.1427"></a><span id="l13.1427">     {</span>
<a href="#l13.1428"></a><span id="l13.1428" class="difflineminus">-      // we need to find the index of the new parent folder...</span>
<a href="#l13.1429"></a><span id="l13.1429" class="difflineminus">-      var newParentIndex = kRowIndexUndefined;</span>
<a href="#l13.1430"></a><span id="l13.1430" class="difflineplus">+      // We need to find the index of the new parent folder.</span>
<a href="#l13.1431"></a><span id="l13.1431" class="difflineplus">+      let newParentIndex = this.mView.kRowIndexUndefined;</span>
<a href="#l13.1432"></a><span id="l13.1432">       for (let index = 0; index &lt; this.mView.rowCount; index++)</span>
<a href="#l13.1433"></a><span id="l13.1433">       {</span>
<a href="#l13.1434"></a><span id="l13.1434" class="difflineminus">-        var item = this.mView.getItemAtIndex(index);</span>
<a href="#l13.1435"></a><span id="l13.1435" class="difflineminus">-        if (item &amp;&amp; item.container &amp;&amp; item.url == feedProperties.folderURI)</span>
<a href="#l13.1436"></a><span id="l13.1436" class="difflineplus">+        let item = this.mView.getItemAtIndex(index);</span>
<a href="#l13.1437"></a><span id="l13.1437" class="difflineplus">+        if (item &amp;&amp; item.container &amp;&amp; item.url == editFolderURI)</span>
<a href="#l13.1438"></a><span id="l13.1438">         {</span>
<a href="#l13.1439"></a><span id="l13.1439">           newParentIndex = index;</span>
<a href="#l13.1440"></a><span id="l13.1440">           break;</span>
<a href="#l13.1441"></a><span id="l13.1441" class="difflineminus">-        }      </span>
<a href="#l13.1442"></a><span id="l13.1442" class="difflineplus">+        }</span>
<a href="#l13.1443"></a><span id="l13.1443">       }</span>
<a href="#l13.1444"></a><span id="l13.1444"> </span>
<a href="#l13.1445"></a><span id="l13.1445" class="difflineminus">-      if (newParentIndex != kRowIndexUndefined)</span>
<a href="#l13.1446"></a><span id="l13.1446" class="difflineplus">+      if (newParentIndex != this.mView.kRowIndexUndefined)</span>
<a href="#l13.1447"></a><span id="l13.1447">         this.moveFeed(seln.currentIndex, newParentIndex)</span>
<a href="#l13.1448"></a><span id="l13.1448" class="difflineplus">+</span>
<a href="#l13.1449"></a><span id="l13.1449" class="difflineplus">+      updated = true;</span>
<a href="#l13.1450"></a><span id="l13.1450">     }</span>
<a href="#l13.1451"></a><span id="l13.1451" class="difflineminus">-      </span>
<a href="#l13.1452"></a><span id="l13.1452" class="difflineminus">-    ds.QueryInterface(Components.interfaces.nsIRDFRemoteDataSource).Flush(); // flush any changes</span>
<a href="#l13.1453"></a><span id="l13.1453" class="difflineminus">-  }, </span>
<a href="#l13.1454"></a><span id="l13.1454"> </span>
<a href="#l13.1455"></a><span id="l13.1455" class="difflineminus">-  // moves the feed located at aOldFeedIndex to a child of aNewParentIndex</span>
<a href="#l13.1456"></a><span id="l13.1456" class="difflineminus">-  moveFeed: function(aOldFeedIndex, aNewParentIndex)</span>
<a href="#l13.1457"></a><span id="l13.1457" class="difflineminus">-  {</span>
<a href="#l13.1458"></a><span id="l13.1458" class="difflineminus">-    // if the new parent is the same as the current parent, then do nothing</span>
<a href="#l13.1459"></a><span id="l13.1459" class="difflineminus">-    if (this.mView.getParentIndex(aOldFeedIndex) == aNewParentIndex)</span>
<a href="#l13.1460"></a><span id="l13.1460" class="difflineplus">+    if (!updated)</span>
<a href="#l13.1461"></a><span id="l13.1461">       return;</span>
<a href="#l13.1462"></a><span id="l13.1462"> </span>
<a href="#l13.1463"></a><span id="l13.1463" class="difflineminus">-    var currentItem = this.mView.getItemAtIndex(aOldFeedIndex);</span>
<a href="#l13.1464"></a><span id="l13.1464" class="difflineminus">-    var currentParentItem = this.mView.getItemAtIndex(this.mView.getParentIndex(aOldFeedIndex));</span>
<a href="#l13.1465"></a><span id="l13.1465" class="difflineminus">-    var currentParentResource = rdf.GetResource(currentParentItem.url);</span>
<a href="#l13.1466"></a><span id="l13.1466" class="difflineplus">+    ds.QueryInterface(Ci.nsIRDFRemoteDataSource).Flush();</span>
<a href="#l13.1467"></a><span id="l13.1467" class="difflineplus">+</span>
<a href="#l13.1468"></a><span id="l13.1468" class="difflineplus">+    let message = FeedUtils.strings.GetStringFromName(&quot;subscribe-feedUpdated&quot;);</span>
<a href="#l13.1469"></a><span id="l13.1469" class="difflineplus">+    this.updateStatusItem(&quot;statusText&quot;, message);</span>
<a href="#l13.1470"></a><span id="l13.1470" class="difflineplus">+  },</span>
<a href="#l13.1471"></a><span id="l13.1471"> </span>
<a href="#l13.1472"></a><span id="l13.1472" class="difflineminus">-    var newParentItem = this.mView.getItemAtIndex(aNewParentIndex);</span>
<a href="#l13.1473"></a><span id="l13.1473" class="difflineminus">-    var newParentResource = rdf.GetResource(newParentItem.url);</span>
<a href="#l13.1474"></a><span id="l13.1474" class="difflineplus">+  // Moves the feed located at aOldFeedIndex to a child of aNewParentIndex.</span>
<a href="#l13.1475"></a><span id="l13.1475" class="difflineplus">+  moveFeed: function(aOldFeedIndex, aNewParentIndex)</span>
<a href="#l13.1476"></a><span id="l13.1476" class="difflineplus">+  {</span>
<a href="#l13.1477"></a><span id="l13.1477" class="difflineplus">+    let currentItem = this.mView.getItemAtIndex(aOldFeedIndex);</span>
<a href="#l13.1478"></a><span id="l13.1478" class="difflineplus">+    if (!currentItem ||</span>
<a href="#l13.1479"></a><span id="l13.1479" class="difflineplus">+        this.mView.getParentIndex(aOldFeedIndex) == aNewParentIndex)</span>
<a href="#l13.1480"></a><span id="l13.1480" class="difflineplus">+      // If the new parent is the same as the current parent, then do nothing.</span>
<a href="#l13.1481"></a><span id="l13.1481" class="difflineplus">+      return false;</span>
<a href="#l13.1482"></a><span id="l13.1482"> </span>
<a href="#l13.1483"></a><span id="l13.1483" class="difflineminus">-    var ds = getSubscriptionsDS(this.mRSSServer);</span>
<a href="#l13.1484"></a><span id="l13.1484" class="difflineminus">-    var resource = rdf.GetResource(currentItem.url);</span>
<a href="#l13.1485"></a><span id="l13.1485" class="difflineminus">-    var currentFolder = currentParentResource.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l13.1486"></a><span id="l13.1486" class="difflineplus">+    let currentParentIndex = this.mView.getParentIndex(aOldFeedIndex);</span>
<a href="#l13.1487"></a><span id="l13.1487" class="difflineplus">+    let currentParentItem = this.mView.getItemAtIndex(currentParentIndex);</span>
<a href="#l13.1488"></a><span id="l13.1488" class="difflineplus">+    let currentParentResource = rdf.GetResource(currentParentItem.url);</span>
<a href="#l13.1489"></a><span id="l13.1489" class="difflineplus">+    let currentFolder = currentParentResource.QueryInterface(Ci.nsIMsgFolder);</span>
<a href="#l13.1490"></a><span id="l13.1490" class="difflineplus">+</span>
<a href="#l13.1491"></a><span id="l13.1491" class="difflineplus">+    let newParentItem = this.mView.getItemAtIndex(aNewParentIndex);</span>
<a href="#l13.1492"></a><span id="l13.1492" class="difflineplus">+    let newParentResource = rdf.GetResource(newParentItem.url);</span>
<a href="#l13.1493"></a><span id="l13.1493" class="difflineplus">+    let newFolder = newParentResource.QueryInterface(Ci.nsIMsgFolder);</span>
<a href="#l13.1494"></a><span id="l13.1494" class="difflineplus">+</span>
<a href="#l13.1495"></a><span id="l13.1495" class="difflineplus">+    let ds = getSubscriptionsDS(currentItem.parentFolder.server);</span>
<a href="#l13.1496"></a><span id="l13.1496" class="difflineplus">+    let resource = rdf.GetResource(currentItem.url);</span>
<a href="#l13.1497"></a><span id="l13.1497"> </span>
<a href="#l13.1498"></a><span id="l13.1498" class="difflineminus">-    // unassert the older URI, add an assertion for the new parent URI...</span>
<a href="#l13.1499"></a><span id="l13.1499" class="difflineminus">-    ds.Change(resource, FZ_DESTFOLDER, currentParentResource, newParentResource);</span>
<a href="#l13.1500"></a><span id="l13.1500" class="difflineplus">+    let accountMove = false;</span>
<a href="#l13.1501"></a><span id="l13.1501" class="difflineplus">+    if (currentFolder.rootFolder.URI == newFolder.rootFolder.URI)</span>
<a href="#l13.1502"></a><span id="l13.1502" class="difflineplus">+    {</span>
<a href="#l13.1503"></a><span id="l13.1503" class="difflineplus">+      // Moving within the same account/feeds db.</span>
<a href="#l13.1504"></a><span id="l13.1504" class="difflineplus">+      if (newFolder.isServer)</span>
<a href="#l13.1505"></a><span id="l13.1505" class="difflineplus">+        // No moving to account folder if already in the account.</span>
<a href="#l13.1506"></a><span id="l13.1506" class="difflineplus">+        return false;</span>
<a href="#l13.1507"></a><span id="l13.1507"> </span>
<a href="#l13.1508"></a><span id="l13.1508" class="difflineminus">-    // we need to update the feed url attributes on the databases for each folder</span>
<a href="#l13.1509"></a><span id="l13.1509" class="difflineminus">-    updateFolderFeedUrl(currentParentResource.QueryInterface(Components.interfaces.nsIMsgFolder), </span>
<a href="#l13.1510"></a><span id="l13.1510" class="difflineminus">-                        currentItem.url, true); // remove our feed url property from the current folder</span>
<a href="#l13.1511"></a><span id="l13.1511" class="difflineminus">-    updateFolderFeedUrl(newParentResource.QueryInterface(Components.interfaces.nsIMsgFolder), </span>
<a href="#l13.1512"></a><span id="l13.1512" class="difflineminus">-                        currentItem.url, false);       // add our feed url property to the new folder</span>
<a href="#l13.1513"></a><span id="l13.1513" class="difflineplus">+      // Unassert the older URI, add an assertion for the new parent URI.</span>
<a href="#l13.1514"></a><span id="l13.1514" class="difflineplus">+      ds.Change(resource, FZ_DESTFOLDER,</span>
<a href="#l13.1515"></a><span id="l13.1515" class="difflineplus">+                currentParentResource, newParentResource);</span>
<a href="#l13.1516"></a><span id="l13.1516" class="difflineplus">+      ds.QueryInterface(Ci.nsIRDFRemoteDataSource).Flush();</span>
<a href="#l13.1517"></a><span id="l13.1517" class="difflineplus">+      // Update the feed url attributes on the databases for each folder:</span>
<a href="#l13.1518"></a><span id="l13.1518" class="difflineplus">+      // Remove our feed url property from the current folder.</span>
<a href="#l13.1519"></a><span id="l13.1519" class="difflineplus">+      updateFolderFeedUrl(currentFolder, currentItem.url, true);</span>
<a href="#l13.1520"></a><span id="l13.1520" class="difflineplus">+      // Add our feed url property to the new folder.</span>
<a href="#l13.1521"></a><span id="l13.1521" class="difflineplus">+      updateFolderFeedUrl(newFolder, currentItem.url, false);</span>
<a href="#l13.1522"></a><span id="l13.1522" class="difflineplus">+    }</span>
<a href="#l13.1523"></a><span id="l13.1523" class="difflineplus">+    else</span>
<a href="#l13.1524"></a><span id="l13.1524" class="difflineplus">+    {</span>
<a href="#l13.1525"></a><span id="l13.1525" class="difflineplus">+      // Moving to a new account.  If dropping on the account folder, a new</span>
<a href="#l13.1526"></a><span id="l13.1526" class="difflineplus">+      // subfolder is created if necessary.</span>
<a href="#l13.1527"></a><span id="l13.1527" class="difflineplus">+      accountMove = true;</span>
<a href="#l13.1528"></a><span id="l13.1528" class="difflineplus">+      // Subscribe to the new folder first.  If it already exists in the</span>
<a href="#l13.1529"></a><span id="l13.1529" class="difflineplus">+      // account or on error, return.</span>
<a href="#l13.1530"></a><span id="l13.1530" class="difflineplus">+      if (!this.addFeed(currentItem.url, newFolder, false, this.kMoveMode))</span>
<a href="#l13.1531"></a><span id="l13.1531" class="difflineplus">+        return;</span>
<a href="#l13.1532"></a><span id="l13.1532" class="difflineplus">+      // Unsubscribe the feed from the old folder, if add to the new folder</span>
<a href="#l13.1533"></a><span id="l13.1533" class="difflineplus">+      // is successfull.</span>
<a href="#l13.1534"></a><span id="l13.1534" class="difflineplus">+      deleteFeed(rdf.GetResource(currentItem.url),</span>
<a href="#l13.1535"></a><span id="l13.1535" class="difflineplus">+                 currentItem.parentFolder.server,</span>
<a href="#l13.1536"></a><span id="l13.1536" class="difflineplus">+                 currentItem.parentFolder);</span>
<a href="#l13.1537"></a><span id="l13.1537" class="difflineplus">+    }</span>
<a href="#l13.1538"></a><span id="l13.1538"> </span>
<a href="#l13.1539"></a><span id="l13.1539" class="difflineminus">-</span>
<a href="#l13.1540"></a><span id="l13.1540" class="difflineminus">-    // Finally, update our view layer</span>
<a href="#l13.1541"></a><span id="l13.1541" class="difflineminus">-    this.mView.removeItemAtIndex(aOldFeedIndex, 1);</span>
<a href="#l13.1542"></a><span id="l13.1542" class="difflineplus">+    // Finally, update our view layer.  Remove the old row.</span>
<a href="#l13.1543"></a><span id="l13.1543" class="difflineplus">+    this.mView.removeItemAtIndex(aOldFeedIndex, true);</span>
<a href="#l13.1544"></a><span id="l13.1544">     if (aNewParentIndex &gt; aOldFeedIndex)</span>
<a href="#l13.1545"></a><span id="l13.1545">       aNewParentIndex--;</span>
<a href="#l13.1546"></a><span id="l13.1546" class="difflineminus">-    </span>
<a href="#l13.1547"></a><span id="l13.1547" class="difflineminus">-    currentItem.level = newParentItem.level + 1;</span>
<a href="#l13.1548"></a><span id="l13.1548" class="difflineminus">-    newParentItem.children.push(currentItem);</span>
<a href="#l13.1549"></a><span id="l13.1549" class="difflineminus">-    var indexOfNewItem = aNewParentIndex + newParentItem.children.length;</span>
<a href="#l13.1550"></a><span id="l13.1550"> </span>
<a href="#l13.1551"></a><span id="l13.1551" class="difflineminus">-    if (!newParentItem.open) // force open the container</span>
<a href="#l13.1552"></a><span id="l13.1552" class="difflineminus">-      this.mView.toggleOpenState(aNewParentIndex);</span>
<a href="#l13.1553"></a><span id="l13.1553" class="difflineminus">-    else</span>
<a href="#l13.1554"></a><span id="l13.1554" class="difflineplus">+    if (accountMove)</span>
<a href="#l13.1555"></a><span id="l13.1555">     {</span>
<a href="#l13.1556"></a><span id="l13.1556" class="difflineminus">-      this.mFeedContainers.splice(indexOfNewItem, 0, currentItem);</span>
<a href="#l13.1557"></a><span id="l13.1557" class="difflineminus">-      this.mView.mRowCount++;</span>
<a href="#l13.1558"></a><span id="l13.1558" class="difflineminus">-      this.mTree.treeBoxObject.rowCountChanged(indexOfNewItem, 1);</span>
<a href="#l13.1559"></a><span id="l13.1559" class="difflineplus">+      // If a cross account move, download callback will update the view with</span>
<a href="#l13.1560"></a><span id="l13.1560" class="difflineplus">+      // the new location.  Preselect folder/mode for callback.</span>
<a href="#l13.1561"></a><span id="l13.1561" class="difflineplus">+      this.selectFolder(newFolder, true, aNewParentIndex);</span>
<a href="#l13.1562"></a><span id="l13.1562" class="difflineplus">+      return true;</span>
<a href="#l13.1563"></a><span id="l13.1563">     }</span>
<a href="#l13.1564"></a><span id="l13.1564"> </span>
<a href="#l13.1565"></a><span id="l13.1565" class="difflineminus">-    gFeedSubscriptionsWindow.mTree.view.selection.select(indexOfNewItem)</span>
<a href="#l13.1566"></a><span id="l13.1566" class="difflineplus">+    // Add the new row location to the view.</span>
<a href="#l13.1567"></a><span id="l13.1567" class="difflineplus">+    currentItem.level = newParentItem.level + 1;</span>
<a href="#l13.1568"></a><span id="l13.1568" class="difflineplus">+    currentItem.parentFolder = newFolder;</span>
<a href="#l13.1569"></a><span id="l13.1569" class="difflineplus">+    newParentItem.children.push(currentItem);</span>
<a href="#l13.1570"></a><span id="l13.1570" class="difflineplus">+</span>
<a href="#l13.1571"></a><span id="l13.1571" class="difflineplus">+    if (newParentItem.open)</span>
<a href="#l13.1572"></a><span id="l13.1572" class="difflineplus">+      // Close the container, selecting the feed will rebuild the view rows.</span>
<a href="#l13.1573"></a><span id="l13.1573" class="difflineplus">+      this.mView.toggle(aNewParentIndex);</span>
<a href="#l13.1574"></a><span id="l13.1574" class="difflineplus">+</span>
<a href="#l13.1575"></a><span id="l13.1575" class="difflineplus">+    this.selectFeed({folder: newParentItem.folder, url: currentItem.url},</span>
<a href="#l13.1576"></a><span id="l13.1576" class="difflineplus">+                    aNewParentIndex);</span>
<a href="#l13.1577"></a><span id="l13.1577" class="difflineplus">+</span>
<a href="#l13.1578"></a><span id="l13.1578" class="difflineplus">+    let message = FeedUtils.strings.GetStringFromName(&quot;subscribe-feedMoved&quot;);</span>
<a href="#l13.1579"></a><span id="l13.1579" class="difflineplus">+    this.updateStatusItem(&quot;statusText&quot;, message);</span>
<a href="#l13.1580"></a><span id="l13.1580">   },</span>
<a href="#l13.1581"></a><span id="l13.1581"> </span>
<a href="#l13.1582"></a><span id="l13.1582">   beginDrag: function (aEvent)</span>
<a href="#l13.1583"></a><span id="l13.1583">   {</span>
<a href="#l13.1584"></a><span id="l13.1584" class="difflineminus">-    // get the selected feed article (if there is one)</span>
<a href="#l13.1585"></a><span id="l13.1585" class="difflineminus">-    var seln = this.mView.selection;</span>
<a href="#l13.1586"></a><span id="l13.1586" class="difflineminus">-    if (seln.count != 1) </span>
<a href="#l13.1587"></a><span id="l13.1587" class="difflineplus">+    // Get the selected feed article (if there is one).</span>
<a href="#l13.1588"></a><span id="l13.1588" class="difflineplus">+    let seln = this.mView.selection;</span>
<a href="#l13.1589"></a><span id="l13.1589" class="difflineplus">+    if (seln.count != 1)</span>
<a href="#l13.1590"></a><span id="l13.1590">       return;</span>
<a href="#l13.1591"></a><span id="l13.1591"> </span>
<a href="#l13.1592"></a><span id="l13.1592" class="difflineminus">-    // only initiate a drag if the item is a feed (i.e. ignore folders/containers)</span>
<a href="#l13.1593"></a><span id="l13.1593" class="difflineminus">-    var item = this.mView.getItemAtIndex(seln.currentIndex);</span>
<a href="#l13.1594"></a><span id="l13.1594" class="difflineplus">+    // Only initiate a drag if the item is a feed (ignore folders/containers).</span>
<a href="#l13.1595"></a><span id="l13.1595" class="difflineplus">+    let item = this.mView.getItemAtIndex(seln.currentIndex);</span>
<a href="#l13.1596"></a><span id="l13.1596">     if (!item || item.container)</span>
<a href="#l13.1597"></a><span id="l13.1597">       return;</span>
<a href="#l13.1598"></a><span id="l13.1598"> </span>
<a href="#l13.1599"></a><span id="l13.1599" class="difflineminus">-    aEvent.dataTransfer.setData(&quot;text/x-moz-feed-index&quot;, seln.currentIndex.toString());</span>
<a href="#l13.1600"></a><span id="l13.1600" class="difflineplus">+    aEvent.dataTransfer.setData(&quot;text/x-moz-feed-index&quot;,</span>
<a href="#l13.1601"></a><span id="l13.1601" class="difflineplus">+                                seln.currentIndex.toString());</span>
<a href="#l13.1602"></a><span id="l13.1602">     aEvent.dataTransfer.effectAllowed = &quot;move&quot;;</span>
<a href="#l13.1603"></a><span id="l13.1603">   },</span>
<a href="#l13.1604"></a><span id="l13.1604"> </span>
<a href="#l13.1605"></a><span id="l13.1605">   mFeedDownloadCallback:</span>
<a href="#l13.1606"></a><span id="l13.1606">   {</span>
<a href="#l13.1607"></a><span id="l13.1607">     downloaded: function(feed, aErrorCode)</span>
<a href="#l13.1608"></a><span id="l13.1608">     {</span>
<a href="#l13.1609"></a><span id="l13.1609" class="difflineminus">-      var promptService = Components.classes[&quot;@mozilla.org/embedcomp/prompt-service;1&quot;]</span>
<a href="#l13.1610"></a><span id="l13.1610" class="difflineminus">-                                    .getService(Components.interfaces.nsIPromptService);</span>
<a href="#l13.1611"></a><span id="l13.1611" class="difflineplus">+      // Feed is null if our attempt to parse the feed failed.</span>
<a href="#l13.1612"></a><span id="l13.1612" class="difflineplus">+      let message = &quot;&quot;;</span>
<a href="#l13.1613"></a><span id="l13.1613" class="difflineplus">+      let win = gFeedSubscriptionsWindow;</span>
<a href="#l13.1614"></a><span id="l13.1614" class="difflineplus">+      if (aErrorCode == FeedUtils.kNewsBlogSuccess)</span>
<a href="#l13.1615"></a><span id="l13.1615" class="difflineplus">+      {</span>
<a href="#l13.1616"></a><span id="l13.1616" class="difflineplus">+        win.updateStatusItem(&quot;progressMeter&quot;, 100);</span>
<a href="#l13.1617"></a><span id="l13.1617"> </span>
<a href="#l13.1618"></a><span id="l13.1618" class="difflineminus">-      // feed is null if our attempt to parse the feed failed</span>
<a href="#l13.1619"></a><span id="l13.1619" class="difflineminus">-      if (aErrorCode == kNewsBlogSuccess)</span>
<a href="#l13.1620"></a><span id="l13.1620" class="difflineminus">-      {</span>
<a href="#l13.1621"></a><span id="l13.1621" class="difflineminus">-        updateStatusItem('progressMeter', 100);</span>
<a href="#l13.1622"></a><span id="l13.1622" class="difflineminus">-</span>
<a href="#l13.1623"></a><span id="l13.1623" class="difflineminus">-        // if we get here...we should always have a folder by now...either</span>
<a href="#l13.1624"></a><span id="l13.1624" class="difflineminus">-        // in feed.folder or FeedItems created the folder for us....</span>
<a href="#l13.1625"></a><span id="l13.1625" class="difflineplus">+        // If we get here we should always have a folder by now, either in</span>
<a href="#l13.1626"></a><span id="l13.1626" class="difflineplus">+        // feed.folder or FeedItems created the folder for us.</span>
<a href="#l13.1627"></a><span id="l13.1627">         updateFolderFeedUrl(feed.folder, feed.url, false);</span>
<a href="#l13.1628"></a><span id="l13.1628"> </span>
<a href="#l13.1629"></a><span id="l13.1629" class="difflineminus">-        // add feed just adds the feed we have validated and downloaded to our datasource</span>
<a href="#l13.1630"></a><span id="l13.1630" class="difflineminus">-        // it also flushes the subscription datasource</span>
<a href="#l13.1631"></a><span id="l13.1631" class="difflineplus">+        // Add feed adds the feed to the subscriptions db and flushes the</span>
<a href="#l13.1632"></a><span id="l13.1632" class="difflineplus">+        // datasource.</span>
<a href="#l13.1633"></a><span id="l13.1633">         addFeed(feed.url, feed.name, feed.folder); </span>
<a href="#l13.1634"></a><span id="l13.1634"> </span>
<a href="#l13.1635"></a><span id="l13.1635" class="difflineminus">-        // now add the feed to our view</span>
<a href="#l13.1636"></a><span id="l13.1636" class="difflineminus">-        refreshSubscriptionView();</span>
<a href="#l13.1637"></a><span id="l13.1637" class="difflineplus">+        // Now add the feed to our view.  If adding, the current selection will</span>
<a href="#l13.1638"></a><span id="l13.1638" class="difflineplus">+        // be a folder; if updating it will be a feed.  No need to rebuild the</span>
<a href="#l13.1639"></a><span id="l13.1639" class="difflineplus">+        // entire view, that is too jarring.</span>
<a href="#l13.1640"></a><span id="l13.1640" class="difflineplus">+        let curIndex = win.mView.selection.currentIndex;</span>
<a href="#l13.1641"></a><span id="l13.1641" class="difflineplus">+        let curItem = win.mView.getItemAtIndex(curIndex);</span>
<a href="#l13.1642"></a><span id="l13.1642" class="difflineplus">+        if (curItem)</span>
<a href="#l13.1643"></a><span id="l13.1643" class="difflineplus">+        {</span>
<a href="#l13.1644"></a><span id="l13.1644" class="difflineplus">+          let parentIndex, parentItem, newItem, level;</span>
<a href="#l13.1645"></a><span id="l13.1645" class="difflineplus">+          let rows = win.mFeedContainers;</span>
<a href="#l13.1646"></a><span id="l13.1646" class="difflineplus">+          if (curItem.container)</span>
<a href="#l13.1647"></a><span id="l13.1647" class="difflineplus">+          {</span>
<a href="#l13.1648"></a><span id="l13.1648" class="difflineplus">+            // Open the container, if it exists.</span>
<a href="#l13.1649"></a><span id="l13.1649" class="difflineplus">+            let folderExists = win.selectFolder(feed.folder, true, curIndex);</span>
<a href="#l13.1650"></a><span id="l13.1650" class="difflineplus">+            if (!folderExists) //curItem.folder.isServer &amp;&amp; </span>
<a href="#l13.1651"></a><span id="l13.1651" class="difflineplus">+            {</span>
<a href="#l13.1652"></a><span id="l13.1652" class="difflineplus">+              // This means a new folder was created.</span>
<a href="#l13.1653"></a><span id="l13.1653" class="difflineplus">+              parentIndex = curIndex;</span>
<a href="#l13.1654"></a><span id="l13.1654" class="difflineplus">+              parentItem = curItem;</span>
<a href="#l13.1655"></a><span id="l13.1655" class="difflineplus">+              level = curItem.level + 1;</span>
<a href="#l13.1656"></a><span id="l13.1656" class="difflineplus">+              newItem = win.makeFolderObject(feed.folder, level);</span>
<a href="#l13.1657"></a><span id="l13.1657" class="difflineplus">+            }</span>
<a href="#l13.1658"></a><span id="l13.1658" class="difflineplus">+            else</span>
<a href="#l13.1659"></a><span id="l13.1659" class="difflineplus">+            {</span>
<a href="#l13.1660"></a><span id="l13.1660" class="difflineplus">+              // If a folder happens to exist which matches one that would</span>
<a href="#l13.1661"></a><span id="l13.1661" class="difflineplus">+              // have been created, the feed system reuses it.  Get the</span>
<a href="#l13.1662"></a><span id="l13.1662" class="difflineplus">+              // current item again if reusing a previously unselected folder.</span>
<a href="#l13.1663"></a><span id="l13.1663" class="difflineplus">+              curIndex = win.mView.selection.currentIndex;</span>
<a href="#l13.1664"></a><span id="l13.1664" class="difflineplus">+              curItem = win.mView.getItemAtIndex(curIndex);</span>
<a href="#l13.1665"></a><span id="l13.1665" class="difflineplus">+              parentIndex = curIndex;</span>
<a href="#l13.1666"></a><span id="l13.1666" class="difflineplus">+              parentItem = curItem;</span>
<a href="#l13.1667"></a><span id="l13.1667" class="difflineplus">+              level = curItem.level + 1;</span>
<a href="#l13.1668"></a><span id="l13.1668" class="difflineplus">+              newItem = win.makeFeedObject(feed, feed.folder, level);</span>
<a href="#l13.1669"></a><span id="l13.1669" class="difflineplus">+            }</span>
<a href="#l13.1670"></a><span id="l13.1670" class="difflineplus">+          }</span>
<a href="#l13.1671"></a><span id="l13.1671" class="difflineplus">+          else</span>
<a href="#l13.1672"></a><span id="l13.1672" class="difflineplus">+          {</span>
<a href="#l13.1673"></a><span id="l13.1673" class="difflineplus">+            parentIndex = win.mView.getParentIndex(curIndex);</span>
<a href="#l13.1674"></a><span id="l13.1674" class="difflineplus">+            parentItem = win.mView.getItemAtIndex(parentIndex);</span>
<a href="#l13.1675"></a><span id="l13.1675" class="difflineplus">+            level = curItem.level;</span>
<a href="#l13.1676"></a><span id="l13.1676" class="difflineplus">+            newItem = win.makeFeedObject(feed, feed.folder, level);</span>
<a href="#l13.1677"></a><span id="l13.1677" class="difflineplus">+          }</span>
<a href="#l13.1678"></a><span id="l13.1678"> </span>
<a href="#l13.1679"></a><span id="l13.1679" class="difflineminus">-        gFeedSubscriptionsWindow.selectFeed(feed);</span>
<a href="#l13.1680"></a><span id="l13.1680" class="difflineplus">+          parentItem.children.push(newItem);</span>
<a href="#l13.1681"></a><span id="l13.1681" class="difflineplus">+</span>
<a href="#l13.1682"></a><span id="l13.1682" class="difflineplus">+          if (win.mActionMode == win.kSubscribeMode)</span>
<a href="#l13.1683"></a><span id="l13.1683" class="difflineplus">+            message = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.1684"></a><span id="l13.1684" class="difflineplus">+                        &quot;subscribe-feedAdded&quot;);</span>
<a href="#l13.1685"></a><span id="l13.1685" class="difflineplus">+          if (win.mActionMode == win.kUpdateMode)</span>
<a href="#l13.1686"></a><span id="l13.1686" class="difflineplus">+          {</span>
<a href="#l13.1687"></a><span id="l13.1687" class="difflineplus">+            win.removeFeed(false);</span>
<a href="#l13.1688"></a><span id="l13.1688" class="difflineplus">+            message = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.1689"></a><span id="l13.1689" class="difflineplus">+                        &quot;subscribe-feedUpdated&quot;);</span>
<a href="#l13.1690"></a><span id="l13.1690" class="difflineplus">+          }</span>
<a href="#l13.1691"></a><span id="l13.1691" class="difflineplus">+          if (win.mActionMode == win.kMoveMode)</span>
<a href="#l13.1692"></a><span id="l13.1692" class="difflineplus">+            message = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.1693"></a><span id="l13.1693" class="difflineplus">+                        &quot;subscribe-feedMoved&quot;);</span>
<a href="#l13.1694"></a><span id="l13.1694" class="difflineplus">+</span>
<a href="#l13.1695"></a><span id="l13.1695" class="difflineplus">+          win.selectFeed(feed, parentIndex);</span>
<a href="#l13.1696"></a><span id="l13.1696" class="difflineplus">+        }</span>
<a href="#l13.1697"></a><span id="l13.1697">       }</span>
<a href="#l13.1698"></a><span id="l13.1698" class="difflineminus">-      else if (aErrorCode == kNewsBlogInvalidFeed) //  the feed was bad...</span>
<a href="#l13.1699"></a><span id="l13.1699" class="difflineminus">-        promptService.alert(null,</span>
<a href="#l13.1700"></a><span id="l13.1700" class="difflineminus">-          gFeedSubscriptionsWindow.mBundle.getString('newsblog-feedNotValidTitle'),</span>
<a href="#l13.1701"></a><span id="l13.1701" class="difflineminus">-          gFeedSubscriptionsWindow.mBundle.getFormattedString('newsblog-feedNotValid', [feed.url]));</span>
<a href="#l13.1702"></a><span id="l13.1702" class="difflineminus">-      else if (aErrorCode == kNewsBlogRequestFailure)</span>
<a href="#l13.1703"></a><span id="l13.1703" class="difflineminus">-        promptService.alert(null,</span>
<a href="#l13.1704"></a><span id="l13.1704" class="difflineminus">-          gFeedSubscriptionsWindow.mBundle.getString('newsblog-networkErrorTitle'),</span>
<a href="#l13.1705"></a><span id="l13.1705" class="difflineminus">-          gFeedSubscriptionsWindow.mBundle.getFormattedString('newsblog-networkError', [feed.url]));</span>
<a href="#l13.1706"></a><span id="l13.1706" class="difflineplus">+      else</span>
<a href="#l13.1707"></a><span id="l13.1707" class="difflineplus">+      {</span>
<a href="#l13.1708"></a><span id="l13.1708" class="difflineplus">+        // Non success.  Remove intermediate traces from the feeds database.</span>
<a href="#l13.1709"></a><span id="l13.1709" class="difflineplus">+        if (feed &amp;&amp; feed.url &amp;&amp; feed.server)</span>
<a href="#l13.1710"></a><span id="l13.1710" class="difflineplus">+          deleteFeed(rdf.GetResource(feed.url),</span>
<a href="#l13.1711"></a><span id="l13.1711" class="difflineplus">+                     feed.server,</span>
<a href="#l13.1712"></a><span id="l13.1712" class="difflineplus">+                     feed.server.rootFolder);</span>
<a href="#l13.1713"></a><span id="l13.1713"> </span>
<a href="#l13.1714"></a><span id="l13.1714" class="difflineminus">-      // re-enable the add button now that we are done subscribing</span>
<a href="#l13.1715"></a><span id="l13.1715" class="difflineminus">-      document.getElementById('addFeed').removeAttribute('disabled');</span>
<a href="#l13.1716"></a><span id="l13.1716" class="difflineplus">+        if (aErrorCode == FeedUtils.kNewsBlogInvalidFeed)</span>
<a href="#l13.1717"></a><span id="l13.1717" class="difflineplus">+          message = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.1718"></a><span id="l13.1718" class="difflineplus">+                      &quot;subscribe-feedNotValid&quot;);</span>
<a href="#l13.1719"></a><span id="l13.1719" class="difflineplus">+        if (aErrorCode == FeedUtils.kNewsBlogRequestFailure)</span>
<a href="#l13.1720"></a><span id="l13.1720" class="difflineplus">+          message = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.1721"></a><span id="l13.1721" class="difflineplus">+                      &quot;subscribe-networkError&quot;);</span>
<a href="#l13.1722"></a><span id="l13.1722"> </span>
<a href="#l13.1723"></a><span id="l13.1723" class="difflineminus">-      // our operation is done...clear out the status text and progressmeter</span>
<a href="#l13.1724"></a><span id="l13.1724" class="difflineminus">-      setTimeout(clearStatusInfo, 1000);</span>
<a href="#l13.1725"></a><span id="l13.1725" class="difflineplus">+        if (win.mActionMode != win.kUpdateMode)</span>
<a href="#l13.1726"></a><span id="l13.1726" class="difflineplus">+          // Re-enable the add button if subscribe failed.</span>
<a href="#l13.1727"></a><span id="l13.1727" class="difflineplus">+          document.getElementById(&quot;addFeed&quot;).removeAttribute(&quot;disabled&quot;);</span>
<a href="#l13.1728"></a><span id="l13.1728" class="difflineplus">+      }</span>
<a href="#l13.1729"></a><span id="l13.1729" class="difflineplus">+</span>
<a href="#l13.1730"></a><span id="l13.1730" class="difflineplus">+      win.clearStatusInfo();</span>
<a href="#l13.1731"></a><span id="l13.1731" class="difflineplus">+      win.updateStatusItem(&quot;statusText&quot;, message, aErrorCode);</span>
<a href="#l13.1732"></a><span id="l13.1732">     },</span>
<a href="#l13.1733"></a><span id="l13.1733"> </span>
<a href="#l13.1734"></a><span id="l13.1734" class="difflineminus">-    // this gets called after the RSS parser finishes storing a feed item to disk</span>
<a href="#l13.1735"></a><span id="l13.1735" class="difflineminus">-    // aCurrentFeedItems is an integer corresponding to how many feed items have been downloaded so far</span>
<a href="#l13.1736"></a><span id="l13.1736" class="difflineminus">-    // aMaxFeedItems is an integer corresponding to the total number of feed items to download</span>
<a href="#l13.1737"></a><span id="l13.1737" class="difflineplus">+    // This gets called after the RSS parser finishes storing a feed item to</span>
<a href="#l13.1738"></a><span id="l13.1738" class="difflineplus">+    // disk.  aCurrentFeedItems is an integer corresponding to how many feed</span>
<a href="#l13.1739"></a><span id="l13.1739" class="difflineplus">+    // items have been downloaded so far.  aMaxFeedItems is an integer</span>
<a href="#l13.1740"></a><span id="l13.1740" class="difflineplus">+    // corresponding to the total number of feed items to download.</span>
<a href="#l13.1741"></a><span id="l13.1741">     onFeedItemStored: function (feed, aCurrentFeedItems, aMaxFeedItems)</span>
<a href="#l13.1742"></a><span id="l13.1742">     {</span>
<a href="#l13.1743"></a><span id="l13.1743" class="difflineminus">-      updateStatusItem('statusText', gFeedSubscriptionsWindow.mBundle.getFormattedString('subscribe-gettingFeedItems',</span>
<a href="#l13.1744"></a><span id="l13.1744" class="difflineminus">-                                                                                         [aCurrentFeedItems, aMaxFeedItems]));</span>
<a href="#l13.1745"></a><span id="l13.1745" class="difflineplus">+      let message = FeedUtils.strings.formatStringFromName(</span>
<a href="#l13.1746"></a><span id="l13.1746" class="difflineplus">+                      &quot;subscribe-gettingFeedItems&quot;,</span>
<a href="#l13.1747"></a><span id="l13.1747" class="difflineplus">+                      [aCurrentFeedItems, aMaxFeedItems], 2);</span>
<a href="#l13.1748"></a><span id="l13.1748" class="difflineplus">+      gFeedSubscriptionsWindow.updateStatusItem(&quot;statusText&quot;, message);</span>
<a href="#l13.1749"></a><span id="l13.1749">       this.onProgress(feed, aCurrentFeedItems, aMaxFeedItems);</span>
<a href="#l13.1750"></a><span id="l13.1750">     },</span>
<a href="#l13.1751"></a><span id="l13.1751"> </span>
<a href="#l13.1752"></a><span id="l13.1752">     onProgress: function(feed, aProgress, aProgressMax)</span>
<a href="#l13.1753"></a><span id="l13.1753">     {</span>
<a href="#l13.1754"></a><span id="l13.1754" class="difflineminus">-      updateStatusItem('progressMeter', (aProgress * 100) / aProgressMax);</span>
<a href="#l13.1755"></a><span id="l13.1755" class="difflineplus">+      gFeedSubscriptionsWindow.updateStatusItem(&quot;progressMeter&quot;,</span>
<a href="#l13.1756"></a><span id="l13.1756" class="difflineplus">+                                                (aProgress * 100) / aProgressMax);</span>
<a href="#l13.1757"></a><span id="l13.1757">     }</span>
<a href="#l13.1758"></a><span id="l13.1758">   },</span>
<a href="#l13.1759"></a><span id="l13.1759"> </span>
<a href="#l13.1760"></a><span id="l13.1760" class="difflineplus">+  // Status routines.</span>
<a href="#l13.1761"></a><span id="l13.1761" class="difflineplus">+  updateStatusItem: function(aID, aValue, aErrorCode)</span>
<a href="#l13.1762"></a><span id="l13.1762" class="difflineplus">+  {</span>
<a href="#l13.1763"></a><span id="l13.1763" class="difflineplus">+    let el = document.getElementById(aID);</span>
<a href="#l13.1764"></a><span id="l13.1764" class="difflineplus">+    if (el.getAttribute(&quot;collapsed&quot;))</span>
<a href="#l13.1765"></a><span id="l13.1765" class="difflineplus">+      el.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l13.1766"></a><span id="l13.1766" class="difflineplus">+</span>
<a href="#l13.1767"></a><span id="l13.1767" class="difflineplus">+    el.value = aValue;</span>
<a href="#l13.1768"></a><span id="l13.1768" class="difflineplus">+</span>
<a href="#l13.1769"></a><span id="l13.1769" class="difflineplus">+    el = document.getElementById(&quot;validationText&quot;);</span>
<a href="#l13.1770"></a><span id="l13.1770" class="difflineplus">+    if (aErrorCode == FeedUtils.kNewsBlogInvalidFeed)</span>
<a href="#l13.1771"></a><span id="l13.1771" class="difflineplus">+      el.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l13.1772"></a><span id="l13.1772" class="difflineplus">+    else</span>
<a href="#l13.1773"></a><span id="l13.1773" class="difflineplus">+      el.setAttribute(&quot;collapsed&quot;, true);</span>
<a href="#l13.1774"></a><span id="l13.1774" class="difflineplus">+  },</span>
<a href="#l13.1775"></a><span id="l13.1775" class="difflineplus">+</span>
<a href="#l13.1776"></a><span id="l13.1776" class="difflineplus">+  clearStatusInfo: function()</span>
<a href="#l13.1777"></a><span id="l13.1777" class="difflineplus">+  {</span>
<a href="#l13.1778"></a><span id="l13.1778" class="difflineplus">+    this.mActionMode = null;</span>
<a href="#l13.1779"></a><span id="l13.1779" class="difflineplus">+    document.getElementById(&quot;statusText&quot;).value = &quot;&quot;;</span>
<a href="#l13.1780"></a><span id="l13.1780" class="difflineplus">+    document.getElementById(&quot;progressMeter&quot;).collapsed = true;</span>
<a href="#l13.1781"></a><span id="l13.1781" class="difflineplus">+    document.getElementById(&quot;validationText&quot;).collapsed = true;</span>
<a href="#l13.1782"></a><span id="l13.1782" class="difflineplus">+  },</span>
<a href="#l13.1783"></a><span id="l13.1783" class="difflineplus">+</span>
<a href="#l13.1784"></a><span id="l13.1784" class="difflineplus">+  checkValidation: function(aEvent)</span>
<a href="#l13.1785"></a><span id="l13.1785" class="difflineplus">+  {</span>
<a href="#l13.1786"></a><span id="l13.1786" class="difflineplus">+    if (aEvent.button != 0)</span>
<a href="#l13.1787"></a><span id="l13.1787" class="difflineplus">+      return;</span>
<a href="#l13.1788"></a><span id="l13.1788" class="difflineplus">+</span>
<a href="#l13.1789"></a><span id="l13.1789" class="difflineplus">+    let validationSite = &quot;http://validator.w3.org&quot;;</span>
<a href="#l13.1790"></a><span id="l13.1790" class="difflineplus">+    let validationQuery = &quot;http://validator.w3.org/feed/check.cgi?url=&quot;;</span>
<a href="#l13.1791"></a><span id="l13.1791" class="difflineplus">+</span>
<a href="#l13.1792"></a><span id="l13.1792" class="difflineplus">+    let win = Services.wm.getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l13.1793"></a><span id="l13.1793" class="difflineplus">+    if (win &amp;&amp; win instanceof Ci.nsIDOMWindow)</span>
<a href="#l13.1794"></a><span id="l13.1794" class="difflineplus">+    {</span>
<a href="#l13.1795"></a><span id="l13.1795" class="difflineplus">+      let tabmail = win.document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l13.1796"></a><span id="l13.1796" class="difflineplus">+      if (tabmail)</span>
<a href="#l13.1797"></a><span id="l13.1797" class="difflineplus">+      {</span>
<a href="#l13.1798"></a><span id="l13.1798" class="difflineplus">+        let feedLocation = document.getElementById(&quot;locationValue&quot;).value;</span>
<a href="#l13.1799"></a><span id="l13.1799" class="difflineplus">+        let url = validationQuery + feedLocation;</span>
<a href="#l13.1800"></a><span id="l13.1800" class="difflineplus">+</span>
<a href="#l13.1801"></a><span id="l13.1801" class="difflineplus">+        win.focus();</span>
<a href="#l13.1802"></a><span id="l13.1802" class="difflineplus">+        win.openContentTab(url, &quot;tab&quot;, &quot;^&quot; + validationSite);</span>
<a href="#l13.1803"></a><span id="l13.1803" class="difflineplus">+        FeedUtils.log.debug(&quot;checkValidation: query url - &quot;+url);</span>
<a href="#l13.1804"></a><span id="l13.1804" class="difflineplus">+      }</span>
<a href="#l13.1805"></a><span id="l13.1805" class="difflineplus">+    }</span>
<a href="#l13.1806"></a><span id="l13.1806" class="difflineplus">+    aEvent.stopPropagation();</span>
<a href="#l13.1807"></a><span id="l13.1807" class="difflineplus">+  },</span>
<a href="#l13.1808"></a><span id="l13.1808" class="difflineplus">+</span>
<a href="#l13.1809"></a><span id="l13.1809" class="difflineplus">+  // Listener for folder pane changes.</span>
<a href="#l13.1810"></a><span id="l13.1810" class="difflineplus">+  FolderListener: {</span>
<a href="#l13.1811"></a><span id="l13.1811" class="difflineplus">+    get feedWindow() {</span>
<a href="#l13.1812"></a><span id="l13.1812" class="difflineplus">+      if (this._feedWindow)</span>
<a href="#l13.1813"></a><span id="l13.1813" class="difflineplus">+        return this._feedWindow;</span>
<a href="#l13.1814"></a><span id="l13.1814" class="difflineplus">+      let subscriptionsWindow =</span>
<a href="#l13.1815"></a><span id="l13.1815" class="difflineplus">+        Services.wm.getMostRecentWindow(&quot;Mail:News-BlogSubscriptions&quot;);</span>
<a href="#l13.1816"></a><span id="l13.1816" class="difflineplus">+      if (subscriptionsWindow)</span>
<a href="#l13.1817"></a><span id="l13.1817" class="difflineplus">+        return this._feedWindow = subscriptionsWindow.gFeedSubscriptionsWindow;</span>
<a href="#l13.1818"></a><span id="l13.1818" class="difflineplus">+      return null;</span>
<a href="#l13.1819"></a><span id="l13.1819" class="difflineplus">+    },</span>
<a href="#l13.1820"></a><span id="l13.1820" class="difflineplus">+</span>
<a href="#l13.1821"></a><span id="l13.1821" class="difflineplus">+    get currentSelectedItem() {</span>
<a href="#l13.1822"></a><span id="l13.1822" class="difflineplus">+      return this.feedWindow ? this.feedWindow.mView.currentItem : null;</span>
<a href="#l13.1823"></a><span id="l13.1823" class="difflineplus">+    },</span>
<a href="#l13.1824"></a><span id="l13.1824" class="difflineplus">+</span>
<a href="#l13.1825"></a><span id="l13.1825" class="difflineplus">+    folderAdded: function(aFolder)</span>
<a href="#l13.1826"></a><span id="l13.1826" class="difflineplus">+    {</span>
<a href="#l13.1827"></a><span id="l13.1827" class="difflineplus">+      if (aFolder.server.type != &quot;rss&quot;)</span>
<a href="#l13.1828"></a><span id="l13.1828" class="difflineplus">+        return;</span>
<a href="#l13.1829"></a><span id="l13.1829" class="difflineplus">+      FeedUtils.log.debug(&quot;folderAdded: folder - &quot;+ aFolder.name);</span>
<a href="#l13.1830"></a><span id="l13.1830" class="difflineplus">+      this.feedWindow.refreshSubscriptionView();</span>
<a href="#l13.1831"></a><span id="l13.1831" class="difflineplus">+    },</span>
<a href="#l13.1832"></a><span id="l13.1832" class="difflineplus">+</span>
<a href="#l13.1833"></a><span id="l13.1833" class="difflineplus">+    folderDeleted: function(aFolder)</span>
<a href="#l13.1834"></a><span id="l13.1834" class="difflineplus">+    {</span>
<a href="#l13.1835"></a><span id="l13.1835" class="difflineplus">+      if (aFolder.server.type != &quot;rss&quot;)</span>
<a href="#l13.1836"></a><span id="l13.1836" class="difflineplus">+        return;</span>
<a href="#l13.1837"></a><span id="l13.1837" class="difflineplus">+      FeedUtils.log.debug(&quot;folderDeleted: folder - &quot;+ aFolder.name);</span>
<a href="#l13.1838"></a><span id="l13.1838" class="difflineplus">+      let curSelItem = this.currentSelectedItem;</span>
<a href="#l13.1839"></a><span id="l13.1839" class="difflineplus">+      let feedWindow = this.feedWindow;</span>
<a href="#l13.1840"></a><span id="l13.1840" class="difflineplus">+      if (curSelItem &amp;&amp; curSelItem.container &amp;&amp; curSelItem.folder == aFolder)</span>
<a href="#l13.1841"></a><span id="l13.1841" class="difflineplus">+      {</span>
<a href="#l13.1842"></a><span id="l13.1842" class="difflineplus">+        let curSelIndex = this.feedWindow.mView.selection.currentIndex;</span>
<a href="#l13.1843"></a><span id="l13.1843" class="difflineplus">+        this.feedWindow.mView.removeItemAtIndex(curSelIndex);</span>
<a href="#l13.1844"></a><span id="l13.1844" class="difflineplus">+      }</span>
<a href="#l13.1845"></a><span id="l13.1845" class="difflineplus">+      else</span>
<a href="#l13.1846"></a><span id="l13.1846" class="difflineplus">+        setTimeout(function() {</span>
<a href="#l13.1847"></a><span id="l13.1847" class="difflineplus">+          feedWindow.refreshSubscriptionView();</span>
<a href="#l13.1848"></a><span id="l13.1848" class="difflineplus">+        }, 20);</span>
<a href="#l13.1849"></a><span id="l13.1849" class="difflineplus">+    },</span>
<a href="#l13.1850"></a><span id="l13.1850" class="difflineplus">+</span>
<a href="#l13.1851"></a><span id="l13.1851" class="difflineplus">+    folderRenamed: function(aOrigFolder, aNewFolder)</span>
<a href="#l13.1852"></a><span id="l13.1852" class="difflineplus">+    {</span>
<a href="#l13.1853"></a><span id="l13.1853" class="difflineplus">+      if (aNewFolder.server.type != &quot;rss&quot;)</span>
<a href="#l13.1854"></a><span id="l13.1854" class="difflineplus">+        return;</span>
<a href="#l13.1855"></a><span id="l13.1855" class="difflineplus">+      FeedUtils.log.debug(&quot;folderRenamed: old:new - &quot;+</span>
<a href="#l13.1856"></a><span id="l13.1856" class="difflineplus">+                          aOrigFolder.name+&quot;:&quot;+aNewFolder.name);</span>
<a href="#l13.1857"></a><span id="l13.1857" class="difflineplus">+      let curSelItem = this.currentSelectedItem;</span>
<a href="#l13.1858"></a><span id="l13.1858" class="difflineplus">+      let feedWindow = this.feedWindow;</span>
<a href="#l13.1859"></a><span id="l13.1859" class="difflineplus">+      setTimeout(function() {</span>
<a href="#l13.1860"></a><span id="l13.1860" class="difflineplus">+        feedWindow.refreshSubscriptionView();</span>
<a href="#l13.1861"></a><span id="l13.1861" class="difflineplus">+        if (curSelItem &amp;&amp; curSelItem.container &amp;&amp;</span>
<a href="#l13.1862"></a><span id="l13.1862" class="difflineplus">+            curSelItem.folder == aOrigFolder)</span>
<a href="#l13.1863"></a><span id="l13.1863" class="difflineplus">+          feedWindow.selectFolder(aNewFolder, true, null, false);</span>
<a href="#l13.1864"></a><span id="l13.1864" class="difflineplus">+      }, 20);</span>
<a href="#l13.1865"></a><span id="l13.1865" class="difflineplus">+    },</span>
<a href="#l13.1866"></a><span id="l13.1866" class="difflineplus">+</span>
<a href="#l13.1867"></a><span id="l13.1867" class="difflineplus">+    folderMoveCopyCompleted: function(aMove, aSrcFolder, aDestFolder)</span>
<a href="#l13.1868"></a><span id="l13.1868" class="difflineplus">+    {</span>
<a href="#l13.1869"></a><span id="l13.1869" class="difflineplus">+      if (aDestFolder.server.type != &quot;rss&quot;)</span>
<a href="#l13.1870"></a><span id="l13.1870" class="difflineplus">+        return;</span>
<a href="#l13.1871"></a><span id="l13.1871" class="difflineplus">+      FeedUtils.log.debug(&quot;folderMoveCopyCompleted: move:src:dest - &quot;+</span>
<a href="#l13.1872"></a><span id="l13.1872" class="difflineplus">+                          aMove+&quot;:&quot;+aSrcFolder.name+&quot;:&quot;+aDestFolder.name);</span>
<a href="#l13.1873"></a><span id="l13.1873" class="difflineplus">+      let curSelItem = this.currentSelectedItem;</span>
<a href="#l13.1874"></a><span id="l13.1874" class="difflineplus">+      let feedWindow = this.feedWindow;</span>
<a href="#l13.1875"></a><span id="l13.1875" class="difflineplus">+      if (aMove &amp;&amp; aDestFolder.getFlag(Ci.nsMsgFolderFlags.Trash))</span>
<a href="#l13.1876"></a><span id="l13.1876" class="difflineplus">+        return this.folderDeleted(aSrcFolder);</span>
<a href="#l13.1877"></a><span id="l13.1877" class="difflineplus">+</span>
<a href="#l13.1878"></a><span id="l13.1878" class="difflineplus">+      setTimeout(function() {</span>
<a href="#l13.1879"></a><span id="l13.1879" class="difflineplus">+        feedWindow.refreshSubscriptionView();</span>
<a href="#l13.1880"></a><span id="l13.1880" class="difflineplus">+        if (curSelItem &amp;&amp; curSelItem.container &amp;&amp;</span>
<a href="#l13.1881"></a><span id="l13.1881" class="difflineplus">+            curSelItem.folder == aSrcFolder)</span>
<a href="#l13.1882"></a><span id="l13.1882" class="difflineplus">+          feedWindow.selectFolder(aDestFolder);</span>
<a href="#l13.1883"></a><span id="l13.1883" class="difflineplus">+      }, 20);</span>
<a href="#l13.1884"></a><span id="l13.1884" class="difflineplus">+    }</span>
<a href="#l13.1885"></a><span id="l13.1885" class="difflineplus">+  },</span>
<a href="#l13.1886"></a><span id="l13.1886" class="difflineplus">+</span>
<a href="#l13.1887"></a><span id="l13.1887" class="difflineplus">+  /* *************************************************************** */</span>
<a href="#l13.1888"></a><span id="l13.1888" class="difflineplus">+  /* OPML Functions                                                  */</span>
<a href="#l13.1889"></a><span id="l13.1889" class="difflineplus">+  /* *************************************************************** */</span>
<a href="#l13.1890"></a><span id="l13.1890">   exportOPML: function()</span>
<a href="#l13.1891"></a><span id="l13.1891">   {</span>
<a href="#l13.1892"></a><span id="l13.1892" class="difflineplus">+    // Account folder must be selected.</span>
<a href="#l13.1893"></a><span id="l13.1893" class="difflineplus">+    let item = this.mView.currentItem;</span>
<a href="#l13.1894"></a><span id="l13.1894" class="difflineplus">+    if (!item || !item.folder || !item.folder.isServer)</span>
<a href="#l13.1895"></a><span id="l13.1895" class="difflineplus">+      return;</span>
<a href="#l13.1896"></a><span id="l13.1896" class="difflineplus">+</span>
<a href="#l13.1897"></a><span id="l13.1897" class="difflineplus">+    this.mRSSServer = item.folder.server;</span>
<a href="#l13.1898"></a><span id="l13.1898" class="difflineplus">+    let SPACES2 = &quot;  &quot;;</span>
<a href="#l13.1899"></a><span id="l13.1899" class="difflineplus">+    let SPACES4 = &quot;    &quot;;</span>
<a href="#l13.1900"></a><span id="l13.1900" class="difflineplus">+</span>
<a href="#l13.1901"></a><span id="l13.1901">     if (this.mRSSServer.rootFolder.hasSubFolders)</span>
<a href="#l13.1902"></a><span id="l13.1902">     {</span>
<a href="#l13.1903"></a><span id="l13.1903" class="difflineminus">-      var opmlDoc = document.implementation.createDocument(&quot;&quot;,&quot;opml&quot;,null);</span>
<a href="#l13.1904"></a><span id="l13.1904" class="difflineminus">-      var opmlRoot = opmlDoc.documentElement;</span>
<a href="#l13.1905"></a><span id="l13.1905" class="difflineplus">+      let opmlDoc = document.implementation.createDocument(&quot;&quot;, &quot;opml&quot;, null);</span>
<a href="#l13.1906"></a><span id="l13.1906" class="difflineplus">+      let opmlRoot = opmlDoc.documentElement;</span>
<a href="#l13.1907"></a><span id="l13.1907">       opmlRoot.setAttribute(&quot;version&quot;,&quot;1.0&quot;);</span>
<a href="#l13.1908"></a><span id="l13.1908"> </span>
<a href="#l13.1909"></a><span id="l13.1909" class="difflineminus">-      this.generatePPSpace(opmlRoot,&quot;  &quot;);</span>
<a href="#l13.1910"></a><span id="l13.1910" class="difflineplus">+      this.generatePPSpace(opmlRoot, SPACES2);</span>
<a href="#l13.1911"></a><span id="l13.1911"> </span>
<a href="#l13.1912"></a><span id="l13.1912" class="difflineminus">-      var brandBundle = document.getElementById(&quot;bundle_brand&quot;);</span>
<a href="#l13.1913"></a><span id="l13.1913" class="difflineplus">+      let brandBundle = document.getElementById(&quot;bundle_brand&quot;);</span>
<a href="#l13.1914"></a><span id="l13.1914"> </span>
<a href="#l13.1915"></a><span id="l13.1915" class="difflineminus">-      // Make the &lt;head&gt; element</span>
<a href="#l13.1916"></a><span id="l13.1916" class="difflineminus">-      var head = opmlDoc.createElement(&quot;head&quot;);</span>
<a href="#l13.1917"></a><span id="l13.1917" class="difflineminus">-      this.generatePPSpace(head, &quot;    &quot;);</span>
<a href="#l13.1918"></a><span id="l13.1918" class="difflineminus">-      var titleText = this.mBundle.getFormattedString(</span>
<a href="#l13.1919"></a><span id="l13.1919" class="difflineplus">+      // Make the &lt;head&gt; element.</span>
<a href="#l13.1920"></a><span id="l13.1920" class="difflineplus">+      let head = opmlDoc.createElement(&quot;head&quot;);</span>
<a href="#l13.1921"></a><span id="l13.1921" class="difflineplus">+      this.generatePPSpace(head, SPACES4);</span>
<a href="#l13.1922"></a><span id="l13.1922" class="difflineplus">+      let titleText = FeedUtils.strings.formatStringFromName(</span>
<a href="#l13.1923"></a><span id="l13.1923">                         &quot;subscribe-OPMLExportFileDialogTitle&quot;,</span>
<a href="#l13.1924"></a><span id="l13.1924">                         [brandBundle.getString(&quot;brandShortName&quot;)], 1);</span>
<a href="#l13.1925"></a><span id="l13.1925" class="difflineminus">-      var title = opmlDoc.createElement(&quot;title&quot;);</span>
<a href="#l13.1926"></a><span id="l13.1926" class="difflineplus">+      let title = opmlDoc.createElement(&quot;title&quot;);</span>
<a href="#l13.1927"></a><span id="l13.1927">       title.appendChild(opmlDoc.createTextNode(titleText));</span>
<a href="#l13.1928"></a><span id="l13.1928">       head.appendChild(title);</span>
<a href="#l13.1929"></a><span id="l13.1929" class="difflineminus">-      this.generatePPSpace(head, &quot;    &quot;);</span>
<a href="#l13.1930"></a><span id="l13.1930" class="difflineminus">-      var dt = opmlDoc.createElement(&quot;dateCreated&quot;);</span>
<a href="#l13.1931"></a><span id="l13.1931" class="difflineplus">+      this.generatePPSpace(head, SPACES4);</span>
<a href="#l13.1932"></a><span id="l13.1932" class="difflineplus">+      let dt = opmlDoc.createElement(&quot;dateCreated&quot;);</span>
<a href="#l13.1933"></a><span id="l13.1933">       dt.appendChild(opmlDoc.createTextNode((new Date()).toGMTString()));</span>
<a href="#l13.1934"></a><span id="l13.1934">       head.appendChild(dt);</span>
<a href="#l13.1935"></a><span id="l13.1935" class="difflineminus">-      this.generatePPSpace(head, &quot;  &quot;);</span>
<a href="#l13.1936"></a><span id="l13.1936" class="difflineplus">+      this.generatePPSpace(head, SPACES2);</span>
<a href="#l13.1937"></a><span id="l13.1937">       opmlRoot.appendChild(head);</span>
<a href="#l13.1938"></a><span id="l13.1938"> </span>
<a href="#l13.1939"></a><span id="l13.1939" class="difflineminus">-      this.generatePPSpace(opmlRoot, &quot;  &quot;);</span>
<a href="#l13.1940"></a><span id="l13.1940" class="difflineplus">+      this.generatePPSpace(opmlRoot, SPACES2);</span>
<a href="#l13.1941"></a><span id="l13.1941"> </span>
<a href="#l13.1942"></a><span id="l13.1942" class="difflineminus">-      //add &lt;outline&gt;s to the &lt;body&gt;</span>
<a href="#l13.1943"></a><span id="l13.1943" class="difflineminus">-      var body = opmlDoc.createElement(&quot;body&quot;);</span>
<a href="#l13.1944"></a><span id="l13.1944" class="difflineminus">-      this.generateOutline(this.mRSSServer.rootFolder, body, 4);</span>
<a href="#l13.1945"></a><span id="l13.1945" class="difflineminus">-      this.generatePPSpace(body, &quot;  &quot;);</span>
<a href="#l13.1946"></a><span id="l13.1946" class="difflineplus">+      // Add &lt;outline&gt;s to the &lt;body&gt;.</span>
<a href="#l13.1947"></a><span id="l13.1947" class="difflineplus">+      let body = opmlDoc.createElement(&quot;body&quot;);</span>
<a href="#l13.1948"></a><span id="l13.1948" class="difflineplus">+      this.generateOutline(this.mRSSServer.rootFolder, body, SPACES4.length);</span>
<a href="#l13.1949"></a><span id="l13.1949" class="difflineplus">+      this.generatePPSpace(body, SPACES2);</span>
<a href="#l13.1950"></a><span id="l13.1950">       opmlRoot.appendChild(body);</span>
<a href="#l13.1951"></a><span id="l13.1951"> </span>
<a href="#l13.1952"></a><span id="l13.1952">       this.generatePPSpace(opmlRoot, &quot;&quot;);</span>
<a href="#l13.1953"></a><span id="l13.1953"> </span>
<a href="#l13.1954"></a><span id="l13.1954" class="difflineminus">-      var serial=new XMLSerializer();</span>
<a href="#l13.1955"></a><span id="l13.1955" class="difflineminus">-      var omplFileName = this.mBundle.getFormattedString(</span>
<a href="#l13.1956"></a><span id="l13.1956" class="difflineplus">+      let serial=new XMLSerializer();</span>
<a href="#l13.1957"></a><span id="l13.1957" class="difflineplus">+      let omplFileName = FeedUtils.strings.formatStringFromName(</span>
<a href="#l13.1958"></a><span id="l13.1958">                            &quot;subscribe-OPMLExportDefaultFileName&quot;,</span>
<a href="#l13.1959"></a><span id="l13.1959">                            [brandBundle.getString(&quot;brandShortName&quot;)], 1);</span>
<a href="#l13.1960"></a><span id="l13.1960" class="difflineminus">-      var rv = pickSaveAs(this.mBundle.getString(&quot;subscribe-OPMLExportTitle&quot;),'$all',</span>
<a href="#l13.1961"></a><span id="l13.1961" class="difflineminus">-                          omplFileName);</span>
<a href="#l13.1962"></a><span id="l13.1962" class="difflineminus">-      if(rv.reason == PICK_CANCEL)</span>
<a href="#l13.1963"></a><span id="l13.1963" class="difflineplus">+      let pTitle = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.1964"></a><span id="l13.1964" class="difflineplus">+                     &quot;subscribe-OPMLExportTitle&quot;);</span>
<a href="#l13.1965"></a><span id="l13.1965" class="difflineplus">+      let rv = pickSaveAs(pTitle, &quot;$all&quot;, omplFileName);</span>
<a href="#l13.1966"></a><span id="l13.1966" class="difflineplus">+      if (rv.reason == PICK_CANCEL)</span>
<a href="#l13.1967"></a><span id="l13.1967">         return;</span>
<a href="#l13.1968"></a><span id="l13.1968" class="difflineminus">-      else if(rv)</span>
<a href="#l13.1969"></a><span id="l13.1969" class="difflineplus">+      else if (rv)</span>
<a href="#l13.1970"></a><span id="l13.1970">       {</span>
<a href="#l13.1971"></a><span id="l13.1971">         //debug(&quot;opml:\n&quot;+serial.serializeToString(opmlDoc)+&quot;\n&quot;);</span>
<a href="#l13.1972"></a><span id="l13.1972" class="difflineminus">-        var file = new LocalFile(rv.file, MODE_WRONLY | MODE_CREATE | MODE_TRUNCATE);</span>
<a href="#l13.1973"></a><span id="l13.1973" class="difflineminus">-        serial.serializeToStream(opmlDoc,file.outputStream,'utf-8');</span>
<a href="#l13.1974"></a><span id="l13.1974" class="difflineplus">+        let file = new LocalFile(rv.file,</span>
<a href="#l13.1975"></a><span id="l13.1975" class="difflineplus">+                                 MODE_WRONLY | MODE_CREATE | MODE_TRUNCATE);</span>
<a href="#l13.1976"></a><span id="l13.1976" class="difflineplus">+        serial.serializeToStream(opmlDoc,file.outputStream, &quot;utf-8&quot;);</span>
<a href="#l13.1977"></a><span id="l13.1977">         file.close();</span>
<a href="#l13.1978"></a><span id="l13.1978">       }</span>
<a href="#l13.1979"></a><span id="l13.1979">     }</span>
<a href="#l13.1980"></a><span id="l13.1980">   },</span>
<a href="#l13.1981"></a><span id="l13.1981"> </span>
<a href="#l13.1982"></a><span id="l13.1982">   generatePPSpace: function(aNode, indentString)</span>
<a href="#l13.1983"></a><span id="l13.1983">   {</span>
<a href="#l13.1984"></a><span id="l13.1984">     aNode.appendChild(aNode.ownerDocument.createTextNode(&quot;\n&quot;));</span>
<a href="#l13.1985"></a><span id="l13.1985">     aNode.appendChild(aNode.ownerDocument.createTextNode(indentString));</span>
<a href="#l13.1986"></a><span id="l13.1986">   },</span>
<a href="#l13.1987"></a><span id="l13.1987" class="difflineminus">-  </span>
<a href="#l13.1988"></a><span id="l13.1988" class="difflineplus">+</span>
<a href="#l13.1989"></a><span id="l13.1989">   generateOutline: function(baseFolder, parent, indentLevel)</span>
<a href="#l13.1990"></a><span id="l13.1990">   {</span>
<a href="#l13.1991"></a><span id="l13.1991" class="difflineminus">-    var folderEnumerator = baseFolder.subFolders;</span>
<a href="#l13.1992"></a><span id="l13.1992" class="difflineplus">+    let folderEnumerator = baseFolder.subFolders;</span>
<a href="#l13.1993"></a><span id="l13.1993"> </span>
<a href="#l13.1994"></a><span id="l13.1994" class="difflineminus">-    // pretty printing</span>
<a href="#l13.1995"></a><span id="l13.1995" class="difflineminus">-    var indentString = &quot;&quot;;</span>
<a href="#l13.1996"></a><span id="l13.1996" class="difflineplus">+    // Pretty printing.</span>
<a href="#l13.1997"></a><span id="l13.1997" class="difflineplus">+    let indentString = &quot;&quot;;</span>
<a href="#l13.1998"></a><span id="l13.1998">     for (let i = 0; i &lt; indentLevel; i++)</span>
<a href="#l13.1999"></a><span id="l13.1999">       indentString = indentString + &quot; &quot;;</span>
<a href="#l13.2000"></a><span id="l13.2000" class="difflineminus">- </span>
<a href="#l13.2001"></a><span id="l13.2001" class="difflineplus">+</span>
<a href="#l13.2002"></a><span id="l13.2002">     while (folderEnumerator.hasMoreElements())</span>
<a href="#l13.2003"></a><span id="l13.2003">     {</span>
<a href="#l13.2004"></a><span id="l13.2004" class="difflineminus">-      var folder = folderEnumerator.getNext();</span>
<a href="#l13.2005"></a><span id="l13.2005" class="difflineminus">-      if ((folder instanceof Components.interfaces.nsIMsgFolder) &amp;&amp;</span>
<a href="#l13.2006"></a><span id="l13.2006" class="difflineminus">-          !folder.getFlag(Components.interfaces.nsMsgFolderFlags.Trash) &amp;&amp;</span>
<a href="#l13.2007"></a><span id="l13.2007" class="difflineminus">-          !folder.getFlag(Components.interfaces.nsMsgFolderFlags.Virtual))</span>
<a href="#l13.2008"></a><span id="l13.2008" class="difflineplus">+      let folder = folderEnumerator.getNext();</span>
<a href="#l13.2009"></a><span id="l13.2009" class="difflineplus">+      if ((folder instanceof Ci.nsIMsgFolder) &amp;&amp;</span>
<a href="#l13.2010"></a><span id="l13.2010" class="difflineplus">+          !folder.getFlag(Ci.nsMsgFolderFlags.Trash) &amp;&amp;</span>
<a href="#l13.2011"></a><span id="l13.2011" class="difflineplus">+          !folder.getFlag(Ci.nsMsgFolderFlags.Virtual))</span>
<a href="#l13.2012"></a><span id="l13.2012">       {</span>
<a href="#l13.2013"></a><span id="l13.2013" class="difflineminus">-        var outline;</span>
<a href="#l13.2014"></a><span id="l13.2014" class="difflineplus">+        let outline;</span>
<a href="#l13.2015"></a><span id="l13.2015">         if (folder.hasSubFolders)</span>
<a href="#l13.2016"></a><span id="l13.2016">         {</span>
<a href="#l13.2017"></a><span id="l13.2017" class="difflineminus">-          // Make a mostly empty outline element</span>
<a href="#l13.2018"></a><span id="l13.2018" class="difflineplus">+          // Make a mostly empty outline element.</span>
<a href="#l13.2019"></a><span id="l13.2019">           outline = parent.ownerDocument.createElement(&quot;outline&quot;);</span>
<a href="#l13.2020"></a><span id="l13.2020" class="difflineminus">-          outline.setAttribute(&quot;text&quot;,folder.prettiestName);</span>
<a href="#l13.2021"></a><span id="l13.2021" class="difflineminus">-          this.generateOutline(folder, outline, indentLevel+2); // recurse</span>
<a href="#l13.2022"></a><span id="l13.2022" class="difflineplus">+          outline.setAttribute(&quot;text&quot;, folder.prettiestName);</span>
<a href="#l13.2023"></a><span id="l13.2023" class="difflineplus">+          // Recurse.</span>
<a href="#l13.2024"></a><span id="l13.2024" class="difflineplus">+          this.generateOutline(folder, outline, indentLevel + 2);</span>
<a href="#l13.2025"></a><span id="l13.2025">           this.generatePPSpace(parent, indentString);</span>
<a href="#l13.2026"></a><span id="l13.2026">           this.generatePPSpace(outline, indentString);</span>
<a href="#l13.2027"></a><span id="l13.2027">           parent.appendChild(outline);</span>
<a href="#l13.2028"></a><span id="l13.2028">         }</span>
<a href="#l13.2029"></a><span id="l13.2029">         else</span>
<a href="#l13.2030"></a><span id="l13.2030">         {</span>
<a href="#l13.2031"></a><span id="l13.2031" class="difflineminus">-          // Add outline elements with xmlUrls</span>
<a href="#l13.2032"></a><span id="l13.2032" class="difflineminus">-          var feeds = this.getFeedsInFolder(folder);</span>
<a href="#l13.2033"></a><span id="l13.2033" class="difflineplus">+          // Add outline elements with xmlUrls.</span>
<a href="#l13.2034"></a><span id="l13.2034" class="difflineplus">+          let feeds = this.getFeedsInFolder(folder);</span>
<a href="#l13.2035"></a><span id="l13.2035">           for (let feed in feeds)</span>
<a href="#l13.2036"></a><span id="l13.2036">           {</span>
<a href="#l13.2037"></a><span id="l13.2037" class="difflineminus">-            outline = this.opmlFeedToOutline(feeds[feed],parent.ownerDocument);</span>
<a href="#l13.2038"></a><span id="l13.2038" class="difflineplus">+            outline = this.opmlFeedToOutline(feeds[feed], parent.ownerDocument);</span>
<a href="#l13.2039"></a><span id="l13.2039">             this.generatePPSpace(parent, indentString);</span>
<a href="#l13.2040"></a><span id="l13.2040">             parent.appendChild(outline);</span>
<a href="#l13.2041"></a><span id="l13.2041">           }</span>
<a href="#l13.2042"></a><span id="l13.2042">         }</span>
<a href="#l13.2043"></a><span id="l13.2043">       }</span>
<a href="#l13.2044"></a><span id="l13.2044">     }</span>
<a href="#l13.2045"></a><span id="l13.2045">   },</span>
<a href="#l13.2046"></a><span id="l13.2046" class="difflineminus">-  </span>
<a href="#l13.2047"></a><span id="l13.2047" class="difflineminus">-  opmlFeedToOutline: function(aFeed,aDoc)</span>
<a href="#l13.2048"></a><span id="l13.2048" class="difflineplus">+</span>
<a href="#l13.2049"></a><span id="l13.2049" class="difflineplus">+  opmlFeedToOutline: function(aFeed, aDoc)</span>
<a href="#l13.2050"></a><span id="l13.2050">   {</span>
<a href="#l13.2051"></a><span id="l13.2051" class="difflineminus">-    var outRv = aDoc.createElement(&quot;outline&quot;);</span>
<a href="#l13.2052"></a><span id="l13.2052" class="difflineminus">-    outRv.setAttribute(&quot;title&quot;,aFeed.title);</span>
<a href="#l13.2053"></a><span id="l13.2053" class="difflineminus">-    outRv.setAttribute(&quot;text&quot;,aFeed.title);</span>
<a href="#l13.2054"></a><span id="l13.2054" class="difflineminus">-    outRv.setAttribute(&quot;type&quot;,&quot;rss&quot;);</span>
<a href="#l13.2055"></a><span id="l13.2055" class="difflineminus">-    outRv.setAttribute(&quot;version&quot;,&quot;RSS&quot;);</span>
<a href="#l13.2056"></a><span id="l13.2056" class="difflineminus">-    outRv.setAttribute(&quot;xmlUrl&quot;,aFeed.url);</span>
<a href="#l13.2057"></a><span id="l13.2057" class="difflineminus">-    outRv.setAttribute(&quot;htmlUrl&quot;,aFeed.link);</span>
<a href="#l13.2058"></a><span id="l13.2058" class="difflineplus">+    let outRv = aDoc.createElement(&quot;outline&quot;);</span>
<a href="#l13.2059"></a><span id="l13.2059" class="difflineplus">+    outRv.setAttribute(&quot;title&quot;, aFeed.title);</span>
<a href="#l13.2060"></a><span id="l13.2060" class="difflineplus">+    outRv.setAttribute(&quot;text&quot;, aFeed.title);</span>
<a href="#l13.2061"></a><span id="l13.2061" class="difflineplus">+    outRv.setAttribute(&quot;type&quot;, &quot;rss&quot;);</span>
<a href="#l13.2062"></a><span id="l13.2062" class="difflineplus">+    outRv.setAttribute(&quot;version&quot;, &quot;RSS&quot;);</span>
<a href="#l13.2063"></a><span id="l13.2063" class="difflineplus">+    outRv.setAttribute(&quot;xmlUrl&quot;, aFeed.url);</span>
<a href="#l13.2064"></a><span id="l13.2064" class="difflineplus">+    outRv.setAttribute(&quot;htmlUrl&quot;, aFeed.link);</span>
<a href="#l13.2065"></a><span id="l13.2065">     return outRv;</span>
<a href="#l13.2066"></a><span id="l13.2066">   },</span>
<a href="#l13.2067"></a><span id="l13.2067"> </span>
<a href="#l13.2068"></a><span id="l13.2068">   importOPML: function()</span>
<a href="#l13.2069"></a><span id="l13.2069">   {</span>
<a href="#l13.2070"></a><span id="l13.2070" class="difflineminus">-    var rv = pickOpen(this.mBundle.getString(&quot;subscribe-OPMLImportTitle&quot;), '$opml $xml $all');</span>
<a href="#l13.2071"></a><span id="l13.2071" class="difflineplus">+    // Account folder must be selected.</span>
<a href="#l13.2072"></a><span id="l13.2072" class="difflineplus">+    let item = this.mView.currentItem;</span>
<a href="#l13.2073"></a><span id="l13.2073" class="difflineplus">+    if (!item || !item.folder || !item.folder.isServer)</span>
<a href="#l13.2074"></a><span id="l13.2074" class="difflineplus">+      return;</span>
<a href="#l13.2075"></a><span id="l13.2075" class="difflineplus">+</span>
<a href="#l13.2076"></a><span id="l13.2076" class="difflineplus">+    this.mRSSServer = item.folder.server;</span>
<a href="#l13.2077"></a><span id="l13.2077" class="difflineplus">+</span>
<a href="#l13.2078"></a><span id="l13.2078" class="difflineplus">+    let pTitle = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.2079"></a><span id="l13.2079" class="difflineplus">+                   &quot;subscribe-OPMLImportTitle&quot;);</span>
<a href="#l13.2080"></a><span id="l13.2080" class="difflineplus">+    let rv = pickOpen(pTitle, &quot;$opml $xml $all&quot;);</span>
<a href="#l13.2081"></a><span id="l13.2081">     if(rv.reason == PICK_CANCEL)</span>
<a href="#l13.2082"></a><span id="l13.2082">       return;</span>
<a href="#l13.2083"></a><span id="l13.2083"> </span>
<a href="#l13.2084"></a><span id="l13.2084" class="difflineminus">-    var promptService = Components.classes[&quot;@mozilla.org/embedcomp/prompt-service;1&quot;].getService(IPS);</span>
<a href="#l13.2085"></a><span id="l13.2085" class="difflineminus">-    var stream = Components.classes[&quot;@mozilla.org/network/file-input-stream;1&quot;].createInstance(Components.interfaces.nsIFileInputStream);</span>
<a href="#l13.2086"></a><span id="l13.2086" class="difflineminus">-    var opmlDom = null;</span>
<a href="#l13.2087"></a><span id="l13.2087" class="difflineplus">+    let opmlDom = null;</span>
<a href="#l13.2088"></a><span id="l13.2088" class="difflineplus">+    let statusReport;</span>
<a href="#l13.2089"></a><span id="l13.2089" class="difflineplus">+    let feedsAdded = 0;</span>
<a href="#l13.2090"></a><span id="l13.2090" class="difflineplus">+    let stream = Cc[&quot;@mozilla.org/network/file-input-stream;1&quot;].</span>
<a href="#l13.2091"></a><span id="l13.2091" class="difflineplus">+                 createInstance(Ci.nsIFileInputStream);</span>
<a href="#l13.2092"></a><span id="l13.2092"> </span>
<a href="#l13.2093"></a><span id="l13.2093" class="difflineminus">-    // read in file as raw bytes, so Expat can do the decoding for us</span>
<a href="#l13.2094"></a><span id="l13.2094" class="difflineminus">-    try{</span>
<a href="#l13.2095"></a><span id="l13.2095" class="difflineplus">+    // Read in file as raw bytes, so Expat can do the decoding for us.</span>
<a href="#l13.2096"></a><span id="l13.2096" class="difflineplus">+    try {</span>
<a href="#l13.2097"></a><span id="l13.2097">       stream.init(rv.file, MODE_RDONLY, PERM_IROTH, 0);</span>
<a href="#l13.2098"></a><span id="l13.2098" class="difflineminus">-      var parser = new DOMParser();</span>
<a href="#l13.2099"></a><span id="l13.2099" class="difflineminus">-      opmlDom = parser.parseFromStream(stream, null, stream.available(), 'application/xml');</span>
<a href="#l13.2100"></a><span id="l13.2100" class="difflineminus">-    }catch(e){</span>
<a href="#l13.2101"></a><span id="l13.2101" class="difflineminus">-      promptService.alert(window, null, this.mBundle.getString(&quot;subscribe-errorOpeningFile&quot;));</span>
<a href="#l13.2102"></a><span id="l13.2102" class="difflineplus">+      let parser = new DOMParser();</span>
<a href="#l13.2103"></a><span id="l13.2103" class="difflineplus">+      opmlDom = parser.parseFromStream(stream, null, stream.available(),</span>
<a href="#l13.2104"></a><span id="l13.2104" class="difflineplus">+                                       &quot;application/xml&quot;);</span>
<a href="#l13.2105"></a><span id="l13.2105" class="difflineplus">+    }</span>
<a href="#l13.2106"></a><span id="l13.2106" class="difflineplus">+    catch(e) {</span>
<a href="#l13.2107"></a><span id="l13.2107" class="difflineplus">+      statusReport = FeedUtils.strings.GetStringFromName(</span>
<a href="#l13.2108"></a><span id="l13.2108" class="difflineplus">+                       &quot;subscribe-errorOpeningFile&quot;);</span>
<a href="#l13.2109"></a><span id="l13.2109" class="difflineplus">+      Services.prompt.alert(window, null, statusReport);</span>
<a href="#l13.2110"></a><span id="l13.2110">       return;</span>
<a href="#l13.2111"></a><span id="l13.2111" class="difflineminus">-    }finally{</span>
<a href="#l13.2112"></a><span id="l13.2112" class="difflineplus">+    }</span>
<a href="#l13.2113"></a><span id="l13.2113" class="difflineplus">+    finally {</span>
<a href="#l13.2114"></a><span id="l13.2114">       stream.close();</span>
<a href="#l13.2115"></a><span id="l13.2115">     }</span>
<a href="#l13.2116"></a><span id="l13.2116"> </span>
<a href="#l13.2117"></a><span id="l13.2117" class="difflineminus">-    var statusReport;</span>
<a href="#l13.2118"></a><span id="l13.2118" class="difflineminus">-    var feedsAdded = 0;</span>
<a href="#l13.2119"></a><span id="l13.2119" class="difflineminus">-</span>
<a href="#l13.2120"></a><span id="l13.2120" class="difflineminus">-    // return if the user didn't give us an OPML file</span>
<a href="#l13.2121"></a><span id="l13.2121" class="difflineminus">-    if(!opmlDom || !(opmlDom.documentElement.tagName == &quot;opml&quot;))</span>
<a href="#l13.2122"></a><span id="l13.2122" class="difflineplus">+    // Return if the user didn't give us an OPML file.</span>
<a href="#l13.2123"></a><span id="l13.2123" class="difflineplus">+    if(!opmlDom || opmlDom.documentElement.tagName != &quot;opml&quot;)</span>
<a href="#l13.2124"></a><span id="l13.2124">     {</span>
<a href="#l13.2125"></a><span id="l13.2125" class="difflineminus">-      statusReport = this.mBundle.getFormattedString(&quot;subscribe-OPMLImportInvalidFile&quot;, [rv.file.leafName]);</span>
<a href="#l13.2126"></a><span id="l13.2126" class="difflineplus">+      statusReport = FeedUtils.strings.formatStringFromName(</span>
<a href="#l13.2127"></a><span id="l13.2127" class="difflineplus">+                       &quot;subscribe-OPMLImportInvalidFile&quot;, [rv.file.leafName], 1);</span>
<a href="#l13.2128"></a><span id="l13.2128" class="difflineplus">+      Services.prompt.alert(window, null, statusReport);</span>
<a href="#l13.2129"></a><span id="l13.2129" class="difflineplus">+      return;</span>
<a href="#l13.2130"></a><span id="l13.2130">     }</span>
<a href="#l13.2131"></a><span id="l13.2131">     else</span>
<a href="#l13.2132"></a><span id="l13.2132">     {</span>
<a href="#l13.2133"></a><span id="l13.2133" class="difflineminus">-      let outlines = opmlDom.getElementsByTagName(&quot;body&quot;)[0].getElementsByTagName(&quot;outline&quot;);</span>
<a href="#l13.2134"></a><span id="l13.2134" class="difflineminus">-      // try to import records if there are any</span>
<a href="#l13.2135"></a><span id="l13.2135" class="difflineplus">+      let outlines = opmlDom.getElementsByTagName(&quot;body&quot;)[0].</span>
<a href="#l13.2136"></a><span id="l13.2136" class="difflineplus">+                             getElementsByTagName(&quot;outline&quot;);</span>
<a href="#l13.2137"></a><span id="l13.2137" class="difflineplus">+      // Try to import records if there are any.</span>
<a href="#l13.2138"></a><span id="l13.2138">       for (let index = 0; index &lt; outlines.length; index++)</span>
<a href="#l13.2139"></a><span id="l13.2139">       {</span>
<a href="#l13.2140"></a><span id="l13.2140">         if (this.importOutline(outlines[index]) == 1)</span>
<a href="#l13.2141"></a><span id="l13.2141">           feedsAdded++;</span>
<a href="#l13.2142"></a><span id="l13.2142">       }</span>
<a href="#l13.2143"></a><span id="l13.2143"> </span>
<a href="#l13.2144"></a><span id="l13.2144">       if (outlines.length &gt; feedsAdded)</span>
<a href="#l13.2145"></a><span id="l13.2145" class="difflineminus">-        statusReport = this.mBundle.getFormattedString(&quot;subscribe-OPMLImportTotalFeeds&quot;, [feedsAdded, outlines.length]);</span>
<a href="#l13.2146"></a><span id="l13.2146" class="difflineplus">+        statusReport = FeedUtils.strings.formatStringFromName(</span>
<a href="#l13.2147"></a><span id="l13.2147" class="difflineplus">+                         &quot;subscribe-OPMLImportTotalFeeds&quot;,</span>
<a href="#l13.2148"></a><span id="l13.2148" class="difflineplus">+                         [feedsAdded, outlines.length], 2);</span>
<a href="#l13.2149"></a><span id="l13.2149">       else</span>
<a href="#l13.2150"></a><span id="l13.2150" class="difflineminus">-        statusReport = this.mBundle.getFormattedString(&quot;subscribe-OPMLImportNewFeeds&quot;, [feedsAdded]);</span>
<a href="#l13.2151"></a><span id="l13.2151" class="difflineplus">+        statusReport = FeedUtils.strings.formatStringFromName(</span>
<a href="#l13.2152"></a><span id="l13.2152" class="difflineplus">+                         &quot;subscribe-OPMLImportNewFeeds&quot;, [feedsAdded], 1);</span>
<a href="#l13.2153"></a><span id="l13.2153">     }</span>
<a href="#l13.2154"></a><span id="l13.2154"> </span>
<a href="#l13.2155"></a><span id="l13.2155" class="difflineminus">-    promptService.alert(window, null, statusReport);</span>
<a href="#l13.2156"></a><span id="l13.2156" class="difflineplus">+    this.clearStatusInfo();</span>
<a href="#l13.2157"></a><span id="l13.2157" class="difflineplus">+    this.updateStatusItem(&quot;statusText&quot;, statusReport);</span>
<a href="#l13.2158"></a><span id="l13.2158"> </span>
<a href="#l13.2159"></a><span id="l13.2159" class="difflineminus">-    // add the new feeds to our view</span>
<a href="#l13.2160"></a><span id="l13.2160" class="difflineplus">+    // Add the new feeds to our view.</span>
<a href="#l13.2161"></a><span id="l13.2161">     if (feedsAdded)</span>
<a href="#l13.2162"></a><span id="l13.2162" class="difflineminus">-      refreshSubscriptionView();</span>
<a href="#l13.2163"></a><span id="l13.2163" class="difflineplus">+      this.refreshSubscriptionView(this.mRSSServer.rootFolder);</span>
<a href="#l13.2164"></a><span id="l13.2164">   },</span>
<a href="#l13.2165"></a><span id="l13.2165"> </span>
<a href="#l13.2166"></a><span id="l13.2166">   importOutline: function(aOutline)</span>
<a href="#l13.2167"></a><span id="l13.2167">   {</span>
<a href="#l13.2168"></a><span id="l13.2168">     // XXX only dealing with flat OPML files for now.</span>
<a href="#l13.2169"></a><span id="l13.2169">     // We still need to add support for grouped files.</span>
<a href="#l13.2170"></a><span id="l13.2170" class="difflineminus">-    var newFeedUrl = aOutline.getAttribute(&quot;xmlUrl&quot;) ||</span>
<a href="#l13.2171"></a><span id="l13.2171" class="difflineplus">+    let newFeedUrl = aOutline.getAttribute(&quot;xmlUrl&quot;) ||</span>
<a href="#l13.2172"></a><span id="l13.2172">                      aOutline.getAttribute(&quot;url&quot;);</span>
<a href="#l13.2173"></a><span id="l13.2173">     if (!newFeedUrl)</span>
<a href="#l13.2174"></a><span id="l13.2174">       return -1;</span>
<a href="#l13.2175"></a><span id="l13.2175"> </span>
<a href="#l13.2176"></a><span id="l13.2176" class="difflineminus">-    // Silently skip feeds that are already subscribed to.</span>
<a href="#l13.2177"></a><span id="l13.2177" class="difflineplus">+    // Silently skip feeds that are already subscribed.</span>
<a href="#l13.2178"></a><span id="l13.2178">     if (feedAlreadyExists(newFeedUrl, this.mRSSServer))</span>
<a href="#l13.2179"></a><span id="l13.2179" class="difflineplus">+    {</span>
<a href="#l13.2180"></a><span id="l13.2180" class="difflineplus">+      FeedUtils.log.debug(&quot;importOutline: already subscribed in account &quot;+</span>
<a href="#l13.2181"></a><span id="l13.2181" class="difflineplus">+                          this.mRSSServer.prettyName+&quot;, url - &quot;+ newFeedUrl);</span>
<a href="#l13.2182"></a><span id="l13.2182">       return 0;</span>
<a href="#l13.2183"></a><span id="l13.2183" class="difflineplus">+    }</span>
<a href="#l13.2184"></a><span id="l13.2184"> </span>
<a href="#l13.2185"></a><span id="l13.2185" class="difflineminus">-    var feedName = aOutline.getAttribute(&quot;text&quot;) ||</span>
<a href="#l13.2186"></a><span id="l13.2186" class="difflineplus">+    let feedName = aOutline.getAttribute(&quot;text&quot;) ||</span>
<a href="#l13.2187"></a><span id="l13.2187">                    aOutline.getAttribute(&quot;title&quot;) ||</span>
<a href="#l13.2188"></a><span id="l13.2188">                    aOutline.getAttribute(&quot;xmlUrl&quot;);</span>
<a href="#l13.2189"></a><span id="l13.2189"> </span>
<a href="#l13.2190"></a><span id="l13.2190" class="difflineminus">-    var defaultQuickMode = this.mRSSServer.getBoolValue('quickMode');</span>
<a href="#l13.2191"></a><span id="l13.2191" class="difflineminus">-    var feedProperties = { feedName: feedName,</span>
<a href="#l13.2192"></a><span id="l13.2192" class="difflineminus">-                           feedLocation: newFeedUrl,</span>
<a href="#l13.2193"></a><span id="l13.2193" class="difflineminus">-                           serverURI: this.mRSSServer.serverURI,</span>
<a href="#l13.2194"></a><span id="l13.2194" class="difflineminus">-                           serverPrettyName: this.mRSSServer.prettyName,</span>
<a href="#l13.2195"></a><span id="l13.2195" class="difflineminus">-                           folderURI: &quot;&quot;,</span>
<a href="#l13.2196"></a><span id="l13.2196" class="difflineminus">-                           quickMode: defaultQuickMode};</span>
<a href="#l13.2197"></a><span id="l13.2197" class="difflineplus">+    let defaultQuickMode = this.mRSSServer.getBoolValue(&quot;quickMode&quot;);</span>
<a href="#l13.2198"></a><span id="l13.2198" class="difflineplus">+    let feedProperties = { feedName     : feedName,</span>
<a href="#l13.2199"></a><span id="l13.2199" class="difflineplus">+                           feedLocation : newFeedUrl,</span>
<a href="#l13.2200"></a><span id="l13.2200" class="difflineplus">+                           server       : this.mRSSServer,</span>
<a href="#l13.2201"></a><span id="l13.2201" class="difflineplus">+                           folderURI    : &quot;&quot;,</span>
<a href="#l13.2202"></a><span id="l13.2202" class="difflineplus">+                           quickMode    : defaultQuickMode};</span>
<a href="#l13.2203"></a><span id="l13.2203"> </span>
<a href="#l13.2204"></a><span id="l13.2204" class="difflineminus">-    debug(&quot;importing feed: &quot;+ feedProperties.feedName);</span>
<a href="#l13.2205"></a><span id="l13.2205" class="difflineplus">+    FeedUtils.log.debug(&quot;importOutline: importing feed: name, url - &quot;+</span>
<a href="#l13.2206"></a><span id="l13.2206" class="difflineplus">+                        feedName+&quot;, &quot;+newFeedUrl);</span>
<a href="#l13.2207"></a><span id="l13.2207"> </span>
<a href="#l13.2208"></a><span id="l13.2208" class="difflineminus">-    var feed = this.storeFeed(feedProperties);</span>
<a href="#l13.2209"></a><span id="l13.2209" class="difflineplus">+    let feed = this.storeFeed(feedProperties);</span>
<a href="#l13.2210"></a><span id="l13.2210">     feed.title = feedProperties.feedName;</span>
<a href="#l13.2211"></a><span id="l13.2211">     if (aOutline.hasAttribute(&quot;htmlUrl&quot;))</span>
<a href="#l13.2212"></a><span id="l13.2212">       feed.link = aOutline.getAttribute(&quot;htmlUrl&quot;);</span>
<a href="#l13.2213"></a><span id="l13.2213"> </span>
<a href="#l13.2214"></a><span id="l13.2214">     feed.createFolder();</span>
<a href="#l13.2215"></a><span id="l13.2215">     updateFolderFeedUrl(feed.folder, feed.url, false);</span>
<a href="#l13.2216"></a><span id="l13.2216"> </span>
<a href="#l13.2217"></a><span id="l13.2217">     // addFeed adds the feed we have validated and downloaded to</span>
<a href="#l13.2218"></a><span id="l13.2218">     // our datasource, it also flushes the subscription datasource.</span>
<a href="#l13.2219"></a><span id="l13.2219">     addFeed(feed.url, feed.name, feed.folder);</span>
<a href="#l13.2220"></a><span id="l13.2220" class="difflineminus">-    return 1; // feed correctly added</span>
<a href="#l13.2221"></a><span id="l13.2221" class="difflineplus">+    // Feed correctly added.</span>
<a href="#l13.2222"></a><span id="l13.2222" class="difflineplus">+    return 1;</span>
<a href="#l13.2223"></a><span id="l13.2223">   }</span>
<a href="#l13.2224"></a><span id="l13.2224"> };</span>
<a href="#l13.2225"></a><span id="l13.2225" class="difflineminus">-</span>
<a href="#l13.2226"></a><span id="l13.2226" class="difflineminus">-// opens the feed properties dialog</span>
<a href="#l13.2227"></a><span id="l13.2227" class="difflineminus">-function openFeedEditor(aFeedProperties)</span>
<a href="#l13.2228"></a><span id="l13.2228" class="difflineminus">-{</span>
<a href="#l13.2229"></a><span id="l13.2229" class="difflineminus">-  window.openDialog('chrome://messenger-newsblog/content/feed-properties.xul',</span>
<a href="#l13.2230"></a><span id="l13.2230" class="difflineminus">-                    'feedproperties', 'modal,titlebar,chrome,centerscreen',</span>
<a href="#l13.2231"></a><span id="l13.2231" class="difflineminus">-                    aFeedProperties);</span>
<a href="#l13.2232"></a><span id="l13.2232" class="difflineminus">-  return aFeedProperties;</span>
<a href="#l13.2233"></a><span id="l13.2233" class="difflineminus">-} </span>
<a href="#l13.2234"></a><span id="l13.2234" class="difflineminus">-</span>
<a href="#l13.2235"></a><span id="l13.2235" class="difflineminus">-function refreshSubscriptionView()</span>
<a href="#l13.2236"></a><span id="l13.2236" class="difflineminus">-{</span>
<a href="#l13.2237"></a><span id="l13.2237" class="difflineminus">-  gFeedSubscriptionsWindow.loadSubscriptions();</span>
<a href="#l13.2238"></a><span id="l13.2238" class="difflineminus">-  gFeedSubscriptionsWindow.mTree.treeBoxObject.invalidate();</span>
<a href="#l13.2239"></a><span id="l13.2239" class="difflineminus">-  gFeedSubscriptionsWindow.mTree.treeBoxObject.view = gFeedSubscriptionsWindow.mView;</span>
<a href="#l13.2240"></a><span id="l13.2240" class="difflineminus">-  if (gFeedSubscriptionsWindow.mView.rowCount &gt; 0) </span>
<a href="#l13.2241"></a><span id="l13.2241" class="difflineminus">-    gFeedSubscriptionsWindow.mTree.view.selection.select(0);</span>
<a href="#l13.2242"></a><span id="l13.2242" class="difflineminus">-}</span>
<a href="#l13.2243"></a><span id="l13.2243" class="difflineminus">-</span>
<a href="#l13.2244"></a><span id="l13.2244" class="difflineminus">-function processDrop()</span>
<a href="#l13.2245"></a><span id="l13.2245" class="difflineminus">-{</span>
<a href="#l13.2246"></a><span id="l13.2246" class="difflineminus">-  gFeedSubscriptionsWindow.addFeed(gFeedSubscriptionsWindow.mView.mDropUrl, gFeedSubscriptionsWindow.mView.mDropFolderUrl);</span>
<a href="#l13.2247"></a><span id="l13.2247" class="difflineminus">-}</span>
<a href="#l13.2248"></a><span id="l13.2248" class="difflineminus">-</span>
<a href="#l13.2249"></a><span id="l13.2249" class="difflineminus">-// status helper routines</span>
<a href="#l13.2250"></a><span id="l13.2250" class="difflineminus">-</span>
<a href="#l13.2251"></a><span id="l13.2251" class="difflineminus">-function updateStatusItem(aID, aValue)</span>
<a href="#l13.2252"></a><span id="l13.2252" class="difflineminus">-{</span>
<a href="#l13.2253"></a><span id="l13.2253" class="difflineminus">-  var el = document.getElementById(aID);</span>
<a href="#l13.2254"></a><span id="l13.2254" class="difflineminus">-  if (el.getAttribute('collapsed'))</span>
<a href="#l13.2255"></a><span id="l13.2255" class="difflineminus">-    el.removeAttribute('collapsed');</span>
<a href="#l13.2256"></a><span id="l13.2256" class="difflineminus">-</span>
<a href="#l13.2257"></a><span id="l13.2257" class="difflineminus">-  el.value = aValue;</span>
<a href="#l13.2258"></a><span id="l13.2258" class="difflineminus">-}</span>
<a href="#l13.2259"></a><span id="l13.2259" class="difflineminus">-</span>
<a href="#l13.2260"></a><span id="l13.2260" class="difflineminus">-function clearStatusInfo()</span>
<a href="#l13.2261"></a><span id="l13.2261" class="difflineminus">-{</span>
<a href="#l13.2262"></a><span id="l13.2262" class="difflineminus">-  document.getElementById('statusText').value = &quot;&quot;;</span>
<a href="#l13.2263"></a><span id="l13.2263" class="difflineminus">-  document.getElementById('progressMeter').collapsed = true;</span>
<a href="#l13.2264"></a><span id="l13.2264" class="difflineminus">-}</span>
<a href="#l13.2265"></a><span id="l13.2265" class="difflineminus">-</span>
<a href="#l13.2266"></a><span id="l13.2266" class="difflineminus">-</span>
<a href="#l13.2267"></a><span id="l13.2267" class="difflineminus">-</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/extensions/newsblog/content/feed-subscriptions.xul</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/extensions/newsblog/content/feed-subscriptions.xul</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -33,123 +33,227 @@</span>
<a href="#l14.4"></a><span id="l14.4"> # decision by deleting the provisions above and replace them with the notice</span>
<a href="#l14.5"></a><span id="l14.5"> # and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l14.6"></a><span id="l14.6"> # the provisions above, a recipient may use your version of this file under</span>
<a href="#l14.7"></a><span id="l14.7"> # the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l14.8"></a><span id="l14.8"> #</span>
<a href="#l14.9"></a><span id="l14.9"> # ***** END LICENSE BLOCK ******</span>
<a href="#l14.10"></a><span id="l14.10"> </span>
<a href="#l14.11"></a><span id="l14.11"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/folderPane.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l14.13"></a><span id="l14.13"> &lt;?xml-stylesheet href=&quot;chrome://messenger-newsblog/skin/feed-subscriptions.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l14.14"></a><span id="l14.14"> </span>
<a href="#l14.15"></a><span id="l14.15"> &lt;!DOCTYPE window SYSTEM &quot;chrome://messenger-newsblog/locale/feed-subscriptions.dtd&quot;&gt;</span>
<a href="#l14.16"></a><span id="l14.16"> </span>
<a href="#l14.17"></a><span id="l14.17"> &lt;window id=&quot;subscriptionsDialog&quot;</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineplus">+        flex=&quot;1&quot;</span>
<a href="#l14.19"></a><span id="l14.19">         title=&quot;&amp;feedSubscriptions.label;&quot;</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineplus">+        windowtype=&quot;Mail:News-BlogSubscriptions&quot;</span>
<a href="#l14.21"></a><span id="l14.21">         xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineminus">-#ifdef XP_MACOSX</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineminus">-        style=&quot;width: 40em; height: 30em;&quot;</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineminus">-#else</span>
<a href="#l14.25"></a><span id="l14.25" class="difflineminus">-        style=&quot;width: 30em; height: 25em;&quot;</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineminus">-#endif</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineplus">+        xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineplus">+        xmlns:nc=&quot;http://home.netscape.com/NC-rdf#&quot;</span>
<a href="#l14.29"></a><span id="l14.29">         persist=&quot;width height screenX screenY sizemode&quot;</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineminus">-        onload=&quot;gFeedSubscriptionsWindow.init();&quot;</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-        onunload=&quot;return gFeedSubscriptionsWindow.uninit();&quot;</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineminus">-        windowtype=&quot;Mail:News-BlogSubscriptions&quot;</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineminus">-        flex=&quot;1&quot;&gt;</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineplus">+        onload=&quot;gFeedSubscriptionsWindow.onLoad();&quot;</span>
<a href="#l14.35"></a><span id="l14.35" class="difflineplus">+        onunload=&quot;return gFeedSubscriptionsWindow.onUnload();&quot;</span>
<a href="#l14.36"></a><span id="l14.36" class="difflineplus">+        onclick=&quot;gFeedSubscriptionsWindow.onClick(event);&quot;&gt;</span>
<a href="#l14.37"></a><span id="l14.37"> </span>
<a href="#l14.38"></a><span id="l14.38">   &lt;script type=&quot;application/javascript&quot; src=&quot;utils.js&quot;/&gt;</span>
<a href="#l14.39"></a><span id="l14.39">   &lt;script type=&quot;application/javascript&quot; src=&quot;file-utils.js&quot;/&gt;</span>
<a href="#l14.40"></a><span id="l14.40">   &lt;script type=&quot;application/javascript&quot; src=&quot;debug-utils.js&quot;/&gt;</span>
<a href="#l14.41"></a><span id="l14.41">   &lt;script type=&quot;application/javascript&quot; src=&quot;feed-subscriptions.js&quot;/&gt;</span>
<a href="#l14.42"></a><span id="l14.42">   &lt;script type=&quot;application/javascript&quot; src=&quot;Feed.js&quot;/&gt;</span>
<a href="#l14.43"></a><span id="l14.43">   &lt;script type=&quot;application/javascript&quot; src=&quot;FeedItem.js&quot;/&gt;</span>
<a href="#l14.44"></a><span id="l14.44">   &lt;script type=&quot;application/javascript&quot; src=&quot;feed-parser.js&quot;/&gt;</span>
<a href="#l14.45"></a><span id="l14.45">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/nsDragAndDrop.js&quot;/&gt;</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/widgetglue.js&quot;/&gt;</span>
<a href="#l14.47"></a><span id="l14.47"> </span>
<a href="#l14.48"></a><span id="l14.48">   &lt;keyset id=&quot;extensionsKeys&quot;&gt;</span>
<a href="#l14.49"></a><span id="l14.49" class="difflineminus">-    &lt;key id=&quot;key_close&quot;   key=&quot;&amp;cmd.close.commandKey;&quot; modifiers=&quot;accel&quot; oncommand=&quot;window.close();&quot;/&gt;</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineminus">-    &lt;key id=&quot;key_close2&quot;  keycode=&quot;VK_ESCAPE&quot; oncommand=&quot;window.close();&quot;/&gt;</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+    &lt;key id=&quot;key_close&quot;</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+         key=&quot;&amp;cmd.close.commandKey;&quot;</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineplus">+         modifiers=&quot;accel&quot;</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineplus">+         oncommand=&quot;window.close();&quot;/&gt;</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineplus">+    &lt;key id=&quot;key_close2&quot;</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineplus">+         keycode=&quot;VK_ESCAPE&quot;</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineplus">+         oncommand=&quot;window.close();&quot;/&gt;</span>
<a href="#l14.58"></a><span id="l14.58">   &lt;/keyset&gt;</span>
<a href="#l14.59"></a><span id="l14.59"> </span>
<a href="#l14.60"></a><span id="l14.60" class="difflineminus">-  &lt;stringbundle id=&quot;bundle_newsblog&quot; src=&quot;chrome://messenger-newsblog/locale/newsblog.properties&quot;/&gt;</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineminus">-  &lt;stringbundle id=&quot;bundle_brand&quot; src=&quot;chrome://branding/locale/brand.properties&quot;/&gt;</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineplus">+  &lt;stringbundle id=&quot;bundle_newsblog&quot;</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineplus">+                src=&quot;chrome://messenger-newsblog/locale/newsblog.properties&quot;/&gt;</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineplus">+  &lt;stringbundle id=&quot;bundle_brand&quot;</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineplus">+                src=&quot;chrome://branding/locale/brand.properties&quot;/&gt;</span>
<a href="#l14.66"></a><span id="l14.66"> </span>
<a href="#l14.67"></a><span id="l14.67">   &lt;vbox flex=&quot;1&quot; id=&quot;contentPane&quot;&gt;</span>
<a href="#l14.68"></a><span id="l14.68">     &lt;description control=&quot;rssSubscriptionsList&quot;&gt;&amp;subscriptionDesc.label;&lt;/description&gt;</span>
<a href="#l14.69"></a><span id="l14.69"> </span>
<a href="#l14.70"></a><span id="l14.70">     &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l14.71"></a><span id="l14.71"> </span>
<a href="#l14.72"></a><span id="l14.72">     &lt;tree id=&quot;rssSubscriptionsList&quot;</span>
<a href="#l14.73"></a><span id="l14.73">           treelines=&quot;true&quot;</span>
<a href="#l14.74"></a><span id="l14.74">           flex=&quot;1&quot;</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineminus">-          style=&quot;height: 10em;&quot;</span>
<a href="#l14.76"></a><span id="l14.76">           hidecolumnpicker=&quot;true&quot;</span>
<a href="#l14.77"></a><span id="l14.77">           onselect=&quot;gFeedSubscriptionsWindow.onSelect();&quot;</span>
<a href="#l14.78"></a><span id="l14.78">           onkeypress=&quot;gFeedSubscriptionsWindow.onKeyPress(event);&quot;</span>
<a href="#l14.79"></a><span id="l14.79">           seltype=&quot;single&quot;&gt;</span>
<a href="#l14.80"></a><span id="l14.80">       &lt;treecols&gt;</span>
<a href="#l14.81"></a><span id="l14.81" class="difflineminus">-        &lt;treecol id=&quot;folderNameCol&quot; flex=&quot;2&quot; primary=&quot;true&quot; hideheader=&quot;true&quot;/&gt;</span>
<a href="#l14.82"></a><span id="l14.82" class="difflineplus">+        &lt;treecol id=&quot;folderNameCol&quot;</span>
<a href="#l14.83"></a><span id="l14.83" class="difflineplus">+                 flex=&quot;2&quot;</span>
<a href="#l14.84"></a><span id="l14.84" class="difflineplus">+                 primary=&quot;true&quot;</span>
<a href="#l14.85"></a><span id="l14.85" class="difflineplus">+                 hideheader=&quot;true&quot;/&gt;</span>
<a href="#l14.86"></a><span id="l14.86">       &lt;/treecols&gt;</span>
<a href="#l14.87"></a><span id="l14.87">       &lt;treechildren id=&quot;subscriptionChildren&quot;</span>
<a href="#l14.88"></a><span id="l14.88" class="difflineminus">-                    ondblclick=&quot;if (event.button == 0) gFeedSubscriptionsWindow.editFeed();&quot;</span>
<a href="#l14.89"></a><span id="l14.89">                     ondraggesture=&quot;gFeedSubscriptionsWindow.beginDrag(event);&quot;/&gt;</span>
<a href="#l14.90"></a><span id="l14.90">     &lt;/tree&gt;</span>
<a href="#l14.91"></a><span id="l14.91"> </span>
<a href="#l14.92"></a><span id="l14.92">     &lt;hbox id=&quot;rssFeedInfoBox&quot;&gt;</span>
<a href="#l14.93"></a><span id="l14.93" class="difflineminus">-      &lt;stack flex=&quot;1&quot;&gt;</span>
<a href="#l14.94"></a><span id="l14.94" class="difflineminus">-        &lt;hbox id=&quot;backgroundBox&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l14.95"></a><span id="l14.95" class="difflineplus">+      &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l14.96"></a><span id="l14.96">         &lt;grid flex=&quot;1&quot;&gt;</span>
<a href="#l14.97"></a><span id="l14.97">           &lt;columns&gt;</span>
<a href="#l14.98"></a><span id="l14.98">             &lt;column/&gt;</span>
<a href="#l14.99"></a><span id="l14.99">             &lt;column flex=&quot;1&quot;/&gt;</span>
<a href="#l14.100"></a><span id="l14.100">           &lt;/columns&gt;</span>
<a href="#l14.101"></a><span id="l14.101">           &lt;rows&gt;</span>
<a href="#l14.102"></a><span id="l14.102" class="difflineminus">-            &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l14.103"></a><span id="l14.103" class="difflineminus">-              &lt;hbox pack=&quot;end&quot;&gt;&lt;label id=&quot;nameLabel&quot; control=&quot;nameValue&quot; value=&quot;&amp;feedTitle.label;&quot;/&gt;&lt;/hbox&gt;</span>
<a href="#l14.104"></a><span id="l14.104" class="difflineminus">-              &lt;textbox id=&quot;nameValue&quot; readonly=&quot;true&quot; class=&quot;plain&quot;/&gt;</span>
<a href="#l14.105"></a><span id="l14.105" class="difflineplus">+            &lt;row&gt;</span>
<a href="#l14.106"></a><span id="l14.106" class="difflineplus">+              &lt;hbox align=&quot;right&quot; valign=&quot;middle&quot;&gt;</span>
<a href="#l14.107"></a><span id="l14.107" class="difflineplus">+                &lt;label id=&quot;nameLabel&quot;</span>
<a href="#l14.108"></a><span id="l14.108" class="difflineplus">+                       accesskey=&quot;&amp;feedTitle.accesskey;&quot;</span>
<a href="#l14.109"></a><span id="l14.109" class="difflineplus">+                       control=&quot;nameValue&quot;</span>
<a href="#l14.110"></a><span id="l14.110" class="difflineplus">+                       value=&quot;&amp;feedTitle.label;&quot;/&gt;</span>
<a href="#l14.111"></a><span id="l14.111" class="difflineplus">+              &lt;/hbox&gt;</span>
<a href="#l14.112"></a><span id="l14.112" class="difflineplus">+              &lt;textbox id=&quot;nameValue&quot;</span>
<a href="#l14.113"></a><span id="l14.113" class="difflineplus">+                       clickSelectsAll=&quot;true&quot;/&gt;</span>
<a href="#l14.114"></a><span id="l14.114" class="difflineplus">+            &lt;/row&gt;</span>
<a href="#l14.115"></a><span id="l14.115" class="difflineplus">+            &lt;row&gt;</span>
<a href="#l14.116"></a><span id="l14.116" class="difflineplus">+              &lt;hbox align=&quot;right&quot; valign=&quot;middle&quot;&gt;</span>
<a href="#l14.117"></a><span id="l14.117" class="difflineplus">+                &lt;label id=&quot;locationLabel&quot;</span>
<a href="#l14.118"></a><span id="l14.118" class="difflineplus">+                       accesskey=&quot;&amp;feedLocation.accesskey;&quot;</span>
<a href="#l14.119"></a><span id="l14.119" class="difflineplus">+                       control=&quot;locationValue&quot;</span>
<a href="#l14.120"></a><span id="l14.120" class="difflineplus">+                       value=&quot;&amp;feedLocation.label;&quot;/&gt;</span>
<a href="#l14.121"></a><span id="l14.121" class="difflineplus">+              &lt;/hbox&gt;</span>
<a href="#l14.122"></a><span id="l14.122" class="difflineplus">+              &lt;textbox id=&quot;locationValue&quot;</span>
<a href="#l14.123"></a><span id="l14.123" class="difflineplus">+                       class=&quot;uri-element&quot;</span>
<a href="#l14.124"></a><span id="l14.124" class="difflineplus">+                       placeholder=&quot;&amp;feedLocation.placeholder;&quot;</span>
<a href="#l14.125"></a><span id="l14.125" class="difflineplus">+                       clickSelectsAll=&quot;true&quot;/&gt;</span>
<a href="#l14.126"></a><span id="l14.126">             &lt;/row&gt;</span>
<a href="#l14.127"></a><span id="l14.127" class="difflineminus">-            &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l14.128"></a><span id="l14.128" class="difflineminus">-              &lt;hbox pack=&quot;end&quot;&gt;&lt;label id=&quot;locationLabel&quot; control=&quot;locationValue&quot; value=&quot;&amp;location.label;&quot;/&gt;&lt;/hbox&gt;</span>
<a href="#l14.129"></a><span id="l14.129" class="difflineminus">-              &lt;textbox id=&quot;locationValue&quot; readonly=&quot;true&quot; class=&quot;plain uri-element&quot;/&gt;</span>
<a href="#l14.130"></a><span id="l14.130" class="difflineplus">+            &lt;row&gt;</span>
<a href="#l14.131"></a><span id="l14.131" class="difflineplus">+              &lt;hbox align=&quot;right&quot; valign=&quot;middle&quot;&gt;</span>
<a href="#l14.132"></a><span id="l14.132" class="difflineplus">+                &lt;label id=&quot;feedFolderLabel&quot;</span>
<a href="#l14.133"></a><span id="l14.133" class="difflineplus">+                       value=&quot;&amp;feedFolder.label;&quot;</span>
<a href="#l14.134"></a><span id="l14.134" class="difflineplus">+                       accesskey=&quot;&amp;feedFolder.accesskey;&quot;</span>
<a href="#l14.135"></a><span id="l14.135" class="difflineplus">+                       control=&quot;selectFolder&quot;/&gt;</span>
<a href="#l14.136"></a><span id="l14.136" class="difflineplus">+              &lt;/hbox&gt;</span>
<a href="#l14.137"></a><span id="l14.137" class="difflineplus">+              &lt;menulist id=&quot;selectFolder&quot;</span>
<a href="#l14.138"></a><span id="l14.138" class="difflineplus">+                    disabled=&quot;true&quot;</span>
<a href="#l14.139"></a><span id="l14.139" class="difflineplus">+                    containment=&quot;http://home.netscape.com/NC-rdf#child&quot;</span>
<a href="#l14.140"></a><span id="l14.140" class="difflineplus">+                    sortResource=&quot;http://home.netscape.com/NC-rdf#FolderTreeName&quot;</span>
<a href="#l14.141"></a><span id="l14.141" class="difflineplus">+                    sortDirection=&quot;ascending&quot;</span>
<a href="#l14.142"></a><span id="l14.142" class="difflineplus">+                    datasources=&quot;rdf:msgaccountmanager rdf:mailnewsfolders&quot;</span>
<a href="#l14.143"></a><span id="l14.143" class="difflineplus">+                    ref=&quot;...&quot;&gt;</span>
<a href="#l14.144"></a><span id="l14.144" class="difflineplus">+                  &lt;menupopup&gt;</span>
<a href="#l14.145"></a><span id="l14.145" class="difflineplus">+                    &lt;menuitem id=&quot;rssAccountMenuItem&quot;</span>
<a href="#l14.146"></a><span id="l14.146" class="difflineplus">+                              oncommand=&quot;gFeedSubscriptionsWindow.setFolderPicker(event.target.id)&quot;/&gt;</span>
<a href="#l14.147"></a><span id="l14.147" class="difflineplus">+                    &lt;menuseparator/&gt;</span>
<a href="#l14.148"></a><span id="l14.148" class="difflineplus">+                  &lt;/menupopup&gt;</span>
<a href="#l14.149"></a><span id="l14.149" class="difflineplus">+</span>
<a href="#l14.150"></a><span id="l14.150" class="difflineplus">+                  &lt;template&gt;</span>
<a href="#l14.151"></a><span id="l14.151" class="difflineplus">+                    &lt;!-- Cheat and use the CanRename property to make sure we</span>
<a href="#l14.152"></a><span id="l14.152" class="difflineplus">+                         don't list the Trash folder as a possible feed folder. --&gt;</span>
<a href="#l14.153"></a><span id="l14.153" class="difflineplus">+                    &lt;rule nc:CanFileMessages=&quot;true&quot;</span>
<a href="#l14.154"></a><span id="l14.154" class="difflineplus">+                          iscontainer=&quot;true&quot;</span>
<a href="#l14.155"></a><span id="l14.155" class="difflineplus">+                          isempty=&quot;false&quot;</span>
<a href="#l14.156"></a><span id="l14.156" class="difflineplus">+                          nc:CanRename=&quot;true&quot;&gt;</span>
<a href="#l14.157"></a><span id="l14.157" class="difflineplus">+                      &lt;menupopup&gt;</span>
<a href="#l14.158"></a><span id="l14.158" class="difflineplus">+                        &lt;menu uri=&quot;...&quot;</span>
<a href="#l14.159"></a><span id="l14.159" class="difflineplus">+                              class=&quot;folderMenuItem menu-iconic&quot;</span>
<a href="#l14.160"></a><span id="l14.160" class="difflineplus">+                              oncommand=&quot;gFeedSubscriptionsWindow.setFolderPicker(event.target.id)&quot;</span>
<a href="#l14.161"></a><span id="l14.161" class="difflineplus">+                              SpecialFolder=&quot;rdf:http://home.netscape.com/NC-rdf#SpecialFolder&quot;</span>
<a href="#l14.162"></a><span id="l14.162" class="difflineplus">+                              BiffState=&quot;rdf:http://home.netscape.com/NC-rdf#BiffState&quot;</span>
<a href="#l14.163"></a><span id="l14.163" class="difflineplus">+                              IsServer=&quot;rdf:http://home.netscape.com/NC-rdf#IsServer&quot;</span>
<a href="#l14.164"></a><span id="l14.164" class="difflineplus">+                              IsSecure=&quot;rdf:http://home.netscape.com/NC-rdf#IsSecure&quot;</span>
<a href="#l14.165"></a><span id="l14.165" class="difflineplus">+                              ServerType=&quot;rdf:http://home.netscape.com/NC-rdf#ServerType&quot;</span>
<a href="#l14.166"></a><span id="l14.166" class="difflineplus">+                              label=&quot;rdf:http://home.netscape.com/NC-rdf#Name&quot;&gt;</span>
<a href="#l14.167"></a><span id="l14.167" class="difflineplus">+                          &lt;menupopup class=&quot;menulist-menupopup&quot;&gt;</span>
<a href="#l14.168"></a><span id="l14.168" class="difflineplus">+                            &lt;menuitem label=&quot;rdf:http://home.netscape.com/NC-rdf#Name&quot;</span>
<a href="#l14.169"></a><span id="l14.169" class="difflineplus">+                                      oncommand=&quot;gFeedSubscriptionsWindow.setFolderPicker(event.target.parentNode.parentNode.id)&quot;/&gt;</span>
<a href="#l14.170"></a><span id="l14.170" class="difflineplus">+                            &lt;menuseparator/&gt;</span>
<a href="#l14.171"></a><span id="l14.171" class="difflineplus">+                          &lt;/menupopup&gt;</span>
<a href="#l14.172"></a><span id="l14.172" class="difflineplus">+                        &lt;/menu&gt;</span>
<a href="#l14.173"></a><span id="l14.173" class="difflineplus">+                      &lt;/menupopup&gt;</span>
<a href="#l14.174"></a><span id="l14.174" class="difflineplus">+                    &lt;/rule&gt;</span>
<a href="#l14.175"></a><span id="l14.175" class="difflineplus">+                    &lt;rule nc:CanFileMessages=&quot;true&quot;</span>
<a href="#l14.176"></a><span id="l14.176" class="difflineplus">+                          nc:CanRename=&quot;true&quot;&gt;</span>
<a href="#l14.177"></a><span id="l14.177" class="difflineplus">+                      &lt;menupopup&gt;</span>
<a href="#l14.178"></a><span id="l14.178" class="difflineplus">+                        &lt;menuitem uri=&quot;...&quot;</span>
<a href="#l14.179"></a><span id="l14.179" class="difflineplus">+                                  value=&quot;...&quot;</span>
<a href="#l14.180"></a><span id="l14.180" class="difflineplus">+                                  class=&quot;folderMenuItem menuitem-iconic&quot;</span>
<a href="#l14.181"></a><span id="l14.181" class="difflineplus">+                                  oncommand=&quot;gFeedSubscriptionsWindow.setFolderPicker(event.target.id)&quot;</span>
<a href="#l14.182"></a><span id="l14.182" class="difflineplus">+                                  SpecialFolder=&quot;rdf:http://home.netscape.com/NC-rdf#SpecialFolder&quot;</span>
<a href="#l14.183"></a><span id="l14.183" class="difflineplus">+                                  BiffState=&quot;rdf:http://home.netscape.com/NC-rdf#BiffState&quot;</span>
<a href="#l14.184"></a><span id="l14.184" class="difflineplus">+                                  IsServer=&quot;rdf:http://home.netscape.com/NC-rdf#IsServer&quot;</span>
<a href="#l14.185"></a><span id="l14.185" class="difflineplus">+                                  IsSecure=&quot;rdf:http://home.netscape.com/NC-rdf#IsSecure&quot;</span>
<a href="#l14.186"></a><span id="l14.186" class="difflineplus">+                                  ServerType=&quot;rdf:http://home.netscape.com/NC-rdf#ServerType&quot;</span>
<a href="#l14.187"></a><span id="l14.187" class="difflineplus">+                                  label=&quot;rdf:http://home.netscape.com/NC-rdf#Name&quot;/&gt;</span>
<a href="#l14.188"></a><span id="l14.188" class="difflineplus">+                       &lt;/menupopup&gt;</span>
<a href="#l14.189"></a><span id="l14.189" class="difflineplus">+                    &lt;/rule&gt;</span>
<a href="#l14.190"></a><span id="l14.190" class="difflineplus">+                  &lt;/template&gt;</span>
<a href="#l14.191"></a><span id="l14.191" class="difflineplus">+              &lt;/menulist&gt;</span>
<a href="#l14.192"></a><span id="l14.192">             &lt;/row&gt;</span>
<a href="#l14.193"></a><span id="l14.193">           &lt;/rows&gt;</span>
<a href="#l14.194"></a><span id="l14.194">         &lt;/grid&gt;</span>
<a href="#l14.195"></a><span id="l14.195" class="difflineminus">-      &lt;/stack&gt;</span>
<a href="#l14.196"></a><span id="l14.196" class="difflineplus">+        &lt;checkbox id=&quot;quickMode&quot;</span>
<a href="#l14.197"></a><span id="l14.197" class="difflineplus">+                  accesskey=&quot;&amp;quickMode.accesskey;&quot;</span>
<a href="#l14.198"></a><span id="l14.198" class="difflineplus">+                  label=&quot;&amp;quickMode.label;&quot;/&gt;</span>
<a href="#l14.199"></a><span id="l14.199" class="difflineplus">+      &lt;/vbox&gt;</span>
<a href="#l14.200"></a><span id="l14.200">     &lt;/hbox&gt;</span>
<a href="#l14.201"></a><span id="l14.201"> </span>
<a href="#l14.202"></a><span id="l14.202" class="difflineminus">-    &lt;hbox id=&quot;statusContainerBox&quot; align=&quot;center&quot;&gt;</span>
<a href="#l14.203"></a><span id="l14.203" class="difflineminus">-      &lt;label id=&quot;statusText&quot; class=&quot;statusbarpanel-text&quot; crop=&quot;right&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l14.204"></a><span id="l14.204" class="difflineminus">-      &lt;progressmeter id=&quot;progressMeter&quot; collapsed=&quot;true&quot; class=&quot;progressmeter-statusbar&quot; style=&quot;-moz-margin-end: 5px;&quot; mode=&quot;normal&quot; value=&quot;0&quot;/&gt;</span>
<a href="#l14.205"></a><span id="l14.205" class="difflineplus">+    &lt;hbox id=&quot;statusContainerBox&quot;</span>
<a href="#l14.206"></a><span id="l14.206" class="difflineplus">+          align=&quot;center&quot;</span>
<a href="#l14.207"></a><span id="l14.207" class="difflineplus">+          valign=&quot;middle&quot;&gt;</span>
<a href="#l14.208"></a><span id="l14.208" class="difflineplus">+      &lt;label id=&quot;statusText&quot;</span>
<a href="#l14.209"></a><span id="l14.209" class="difflineplus">+             class=&quot;statusbarpanel-text&quot;</span>
<a href="#l14.210"></a><span id="l14.210" class="difflineplus">+             crop=&quot;end&quot;</span>
<a href="#l14.211"></a><span id="l14.211" class="difflineplus">+             value=&quot;&quot;/&gt;</span>
<a href="#l14.212"></a><span id="l14.212" class="difflineplus">+      &lt;label id=&quot;validationText&quot;</span>
<a href="#l14.213"></a><span id="l14.213" class="difflineplus">+             collapsed=&quot;true&quot;</span>
<a href="#l14.214"></a><span id="l14.214" class="difflineplus">+             class=&quot;text-link&quot;</span>
<a href="#l14.215"></a><span id="l14.215" class="difflineplus">+             crop=&quot;end&quot;</span>
<a href="#l14.216"></a><span id="l14.216" class="difflineplus">+             value=&quot;&amp;validateText.label;&quot;</span>
<a href="#l14.217"></a><span id="l14.217" class="difflineplus">+             onclick=&quot;gFeedSubscriptionsWindow.checkValidation(event);&quot;/&gt;</span>
<a href="#l14.218"></a><span id="l14.218" class="difflineplus">+      &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l14.219"></a><span id="l14.219" class="difflineplus">+      &lt;progressmeter id=&quot;progressMeter&quot;</span>
<a href="#l14.220"></a><span id="l14.220" class="difflineplus">+                     collapsed=&quot;true&quot;</span>
<a href="#l14.221"></a><span id="l14.221" class="difflineplus">+                     mode=&quot;normal&quot;</span>
<a href="#l14.222"></a><span id="l14.222" class="difflineplus">+                     value=&quot;0&quot;/&gt;</span>
<a href="#l14.223"></a><span id="l14.223">     &lt;/hbox&gt;</span>
<a href="#l14.224"></a><span id="l14.224"> </span>
<a href="#l14.225"></a><span id="l14.225">     &lt;hbox align=&quot;end&quot;&gt;</span>
<a href="#l14.226"></a><span id="l14.226">       &lt;hbox class=&quot;actionButtons&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l14.227"></a><span id="l14.227">         &lt;button id=&quot;addFeed&quot;</span>
<a href="#l14.228"></a><span id="l14.228" class="difflineminus">-                label=&quot;&amp;button.addFeed.label;&quot; accesskey=&quot;&amp;button.addFeed.accesskey;&quot;</span>
<a href="#l14.229"></a><span id="l14.229" class="difflineplus">+                label=&quot;&amp;button.addFeed.label;&quot;</span>
<a href="#l14.230"></a><span id="l14.230" class="difflineplus">+                accesskey=&quot;&amp;button.addFeed.accesskey;&quot;</span>
<a href="#l14.231"></a><span id="l14.231">                 oncommand=&quot;gFeedSubscriptionsWindow.addFeed();&quot;/&gt;</span>
<a href="#l14.232"></a><span id="l14.232"> </span>
<a href="#l14.233"></a><span id="l14.233" class="difflineminus">-        &lt;button id=&quot;editFeed&quot; disabled=&quot;true&quot; default=&quot;true&quot;</span>
<a href="#l14.234"></a><span id="l14.234" class="difflineminus">-                label=&quot;&amp;button.editFeed.label;&quot; accesskey=&quot;&amp;button.editFeed.accesskey;&quot;</span>
<a href="#l14.235"></a><span id="l14.235" class="difflineplus">+        &lt;button id=&quot;editFeed&quot;</span>
<a href="#l14.236"></a><span id="l14.236" class="difflineplus">+                disabled=&quot;true&quot;</span>
<a href="#l14.237"></a><span id="l14.237" class="difflineplus">+                label=&quot;&amp;button.editFeed.label;&quot;</span>
<a href="#l14.238"></a><span id="l14.238" class="difflineplus">+                accesskey=&quot;&amp;button.editFeed.accesskey;&quot;</span>
<a href="#l14.239"></a><span id="l14.239">                 oncommand=&quot;gFeedSubscriptionsWindow.editFeed();&quot;/&gt;</span>
<a href="#l14.240"></a><span id="l14.240"> </span>
<a href="#l14.241"></a><span id="l14.241" class="difflineminus">-        &lt;button id=&quot;removeFeed&quot; disabled=&quot;true&quot;</span>
<a href="#l14.242"></a><span id="l14.242" class="difflineminus">-                label=&quot;&amp;button.removeFeed.label;&quot; accesskey=&quot;&amp;button.removeFeed.accesskey;&quot;</span>
<a href="#l14.243"></a><span id="l14.243" class="difflineminus">-                oncommand=&quot;gFeedSubscriptionsWindow.removeFeed();&quot;/&gt;</span>
<a href="#l14.244"></a><span id="l14.244" class="difflineplus">+        &lt;button id=&quot;removeFeed&quot;</span>
<a href="#l14.245"></a><span id="l14.245" class="difflineplus">+                disabled=&quot;true&quot;</span>
<a href="#l14.246"></a><span id="l14.246" class="difflineplus">+                label=&quot;&amp;button.removeFeed.label;&quot;</span>
<a href="#l14.247"></a><span id="l14.247" class="difflineplus">+                accesskey=&quot;&amp;button.removeFeed.accesskey;&quot;</span>
<a href="#l14.248"></a><span id="l14.248" class="difflineplus">+                oncommand=&quot;gFeedSubscriptionsWindow.removeFeed(true);&quot;/&gt;</span>
<a href="#l14.249"></a><span id="l14.249" class="difflineplus">+</span>
<a href="#l14.250"></a><span id="l14.250" class="difflineplus">+        &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l14.251"></a><span id="l14.251"> </span>
<a href="#l14.252"></a><span id="l14.252">         &lt;button id=&quot;importOPML&quot;</span>
<a href="#l14.253"></a><span id="l14.253" class="difflineminus">-                label=&quot;&amp;button.importOPML.label;&quot; accesskey=&quot;&amp;button.importOPML.accesskey;&quot;</span>
<a href="#l14.254"></a><span id="l14.254" class="difflineplus">+                label=&quot;&amp;button.importOPML.label;&quot;</span>
<a href="#l14.255"></a><span id="l14.255" class="difflineplus">+                accesskey=&quot;&amp;button.importOPML.accesskey;&quot;</span>
<a href="#l14.256"></a><span id="l14.256">                 oncommand=&quot;gFeedSubscriptionsWindow.importOPML();&quot;/&gt;</span>
<a href="#l14.257"></a><span id="l14.257"> </span>
<a href="#l14.258"></a><span id="l14.258">         &lt;button id=&quot;exportOPML&quot;</span>
<a href="#l14.259"></a><span id="l14.259" class="difflineminus">-                label=&quot;&amp;button.exportOPML.label;&quot; accesskey=&quot;&amp;button.exportOPML.accesskey;&quot;</span>
<a href="#l14.260"></a><span id="l14.260" class="difflineplus">+                label=&quot;&amp;button.exportOPML.label;&quot;</span>
<a href="#l14.261"></a><span id="l14.261" class="difflineplus">+                accesskey=&quot;&amp;button.exportOPML.accesskey;&quot;</span>
<a href="#l14.262"></a><span id="l14.262">                 oncommand=&quot;gFeedSubscriptionsWindow.exportOPML();&quot;/&gt;</span>
<a href="#l14.263"></a><span id="l14.263" class="difflineminus">-</span>
<a href="#l14.264"></a><span id="l14.264" class="difflineminus">-        &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l14.265"></a><span id="l14.265">       &lt;/hbox&gt;</span>
<a href="#l14.266"></a><span id="l14.266">     &lt;/hbox&gt;</span>
<a href="#l14.267"></a><span id="l14.267">   &lt;/vbox&gt;</span>
<a href="#l14.268"></a><span id="l14.268" class="difflineminus">-</span>
<a href="#l14.269"></a><span id="l14.269" class="difflineminus">-  &lt;hbox&gt;</span>
<a href="#l14.270"></a><span id="l14.270" class="difflineminus">-    &lt;spring flex=&quot;1&quot;/&gt;</span>
<a href="#l14.271"></a><span id="l14.271" class="difflineminus">-    &lt;resizer dir=&quot;bottomright&quot;/&gt;</span>
<a href="#l14.272"></a><span id="l14.272" class="difflineminus">-  &lt;/hbox&gt;</span>
<a href="#l14.273"></a><span id="l14.273"> &lt;/window&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/extensions/newsblog/content/newsblogOverlay.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/extensions/newsblog/content/newsblogOverlay.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -32,39 +32,35 @@</span>
<a href="#l15.4"></a><span id="l15.4"> # use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l15.5"></a><span id="l15.5"> # decision by deleting the provisions above and replace them with the notice</span>
<a href="#l15.6"></a><span id="l15.6"> # and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l15.7"></a><span id="l15.7"> # the provisions above, a recipient may use your version of this file under</span>
<a href="#l15.8"></a><span id="l15.8"> # the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l15.9"></a><span id="l15.9"> #</span>
<a href="#l15.10"></a><span id="l15.10"> # ***** END LICENSE BLOCK ******</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-function openSubscriptionsDialog(aFolder, aServer)</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+function openSubscriptionsDialog(aFolder)</span>
<a href="#l15.16"></a><span id="l15.16"> {</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineminus">-  if (!aServer)</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineminus">-    aServer = aFolder.server;</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineminus">-  //check for an existing subscriptions window and focus it.</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineminus">-  const kWindowMediatorContractID = &quot;@mozilla.org/appshell/window-mediator;1&quot;;</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineminus">-  const kWindowMediatorIID = Components.interfaces.nsIWindowMediator;</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineminus">-  const kWindowMediator = Components.classes[kWindowMediatorContractID]</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineminus">-                                    .getService(kWindowMediatorIID);</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineminus">-  var lastSubscriptionWindow =</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineminus">-    kWindowMediator.getMostRecentWindow(&quot;Mail:News-BlogSubscriptions&quot;);</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineminus">-  </span>
<a href="#l15.27"></a><span id="l15.27" class="difflineminus">-  if (lastSubscriptionWindow)</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineplus">+  // Check for an existing feed subscriptions window and focus it.</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineplus">+  let subscriptionsWindow =</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineplus">+    Services.wm.getMostRecentWindow(&quot;Mail:News-BlogSubscriptions&quot;);</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineplus">+</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+  if (subscriptionsWindow)</span>
<a href="#l15.33"></a><span id="l15.33">   {</span>
<a href="#l15.34"></a><span id="l15.34">     if (aFolder)</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineminus">-      lastSubscriptionWindow.gFeedSubscriptionsWindow.selectFolder(aFolder);</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineminus">-    lastSubscriptionWindow.focus();</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+      subscriptionsWindow.gFeedSubscriptionsWindow.selectFolder(aFolder);</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+    subscriptionsWindow.focus();</span>
<a href="#l15.39"></a><span id="l15.39">   }</span>
<a href="#l15.40"></a><span id="l15.40">   else</span>
<a href="#l15.41"></a><span id="l15.41">   {</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineminus">-    window.openDialog(&quot;chrome://messenger-newsblog/content/feed-subscriptions.xul&quot;, &quot;&quot;,</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineminus">-                      &quot;centerscreen,chrome,dialog=no,resizable&quot;,</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineminus">-                      { server: aServer, folder: aFolder});</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineplus">+    window.openDialog(&quot;chrome://messenger-newsblog/content/feed-subscriptions.xul&quot;,</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineplus">+                      &quot;&quot;, &quot;centerscreen,chrome,dialog=no,resizable&quot;,</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineplus">+                      { folder: aFolder});</span>
<a href="#l15.48"></a><span id="l15.48">   }</span>
<a href="#l15.49"></a><span id="l15.49"> }</span>
<a href="#l15.50"></a><span id="l15.50"> </span>
<a href="#l15.51"></a><span id="l15.51"> // Special case attempts to reply/forward/edit as new RSS arrticles</span>
<a href="#l15.52"></a><span id="l15.52"> // Send the feed article URL instead of trying to load the feed inside of</span>
<a href="#l15.53"></a><span id="l15.53"> // an iframe. Bug #258278.</span>
<a href="#l15.54"></a><span id="l15.54"> function openComposeWindowForRSSArticle(msgHdr, type)</span>
<a href="#l15.55"></a><span id="l15.55"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/extensions/newsblog/jar.mn</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/extensions/newsblog/jar.mn</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -1,16 +1,13 @@</span>
<a href="#l16.4"></a><span id="l16.4"> newsblog.jar:</span>
<a href="#l16.5"></a><span id="l16.5"> % content messenger-newsblog %content/messenger-newsblog/</span>
<a href="#l16.6"></a><span id="l16.6"> *  content/messenger-newsblog/newsblogOverlay.js                (content/newsblogOverlay.js)</span>
<a href="#l16.7"></a><span id="l16.7" class="difflineminus">-*  content/messenger-newsblog/edittree.xml                      (content/edittree.xml)</span>
<a href="#l16.8"></a><span id="l16.8"> *  content/messenger-newsblog/debug-utils.js                    (content/debug-utils.js)</span>
<a href="#l16.9"></a><span id="l16.9"> *  content/messenger-newsblog/Feed.js                           (content/Feed.js)</span>
<a href="#l16.10"></a><span id="l16.10"> *  content/messenger-newsblog/FeedItem.js                       (content/FeedItem.js)</span>
<a href="#l16.11"></a><span id="l16.11"> *  content/messenger-newsblog/feed-parser.js                    (content/feed-parser.js)</span>
<a href="#l16.12"></a><span id="l16.12"> *  content/messenger-newsblog/file-utils.js                     (content/file-utils.js)</span>
<a href="#l16.13"></a><span id="l16.13"> *  content/messenger-newsblog/utils.js                          (content/utils.js)</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineminus">-*  content/messenger-newsblog/feed-properties.xul               (content/feed-properties.xul)</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineminus">-*  content/messenger-newsblog/feed-properties.js                (content/feed-properties.js) </span>
<a href="#l16.16"></a><span id="l16.16"> *  content/messenger-newsblog/feed-subscriptions.js             (content/feed-subscriptions.js)</span>
<a href="#l16.17"></a><span id="l16.17"> *  content/messenger-newsblog/feed-subscriptions.xul            (content/feed-subscriptions.xul)</span>
<a href="#l16.18"></a><span id="l16.18"> *  content/messenger-newsblog/am-newsblog.xul                   (content/am-newsblog.xul)</span>
<a href="#l16.19"></a><span id="l16.19"> *  content/messenger-newsblog/am-newsblog.js                    (content/am-newsblog.js)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1">deleted file mode 100644</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/newsblog/am-newsblog.properties</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineplus">+++ /dev/null</span>
<a href="#l17.4"></a><span id="l17.4" class="difflineat">@@ -1,2 +0,0 @@</span>
<a href="#l17.5"></a><span id="l17.5" class="difflineminus">-## Strings used in the Account Manager</span>
<a href="#l17.6"></a><span id="l17.6" class="difflineminus">-prefPanel-newsblog=Feed Settings</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1">deleted file mode 100644</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/newsblog/feed-properties.dtd</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineplus">+++ /dev/null</span>
<a href="#l18.4"></a><span id="l18.4" class="difflineat">@@ -1,19 +0,0 @@</span>
<a href="#l18.5"></a><span id="l18.5" class="difflineminus">-&lt;!-- Feed Properties Dialog --&gt;</span>
<a href="#l18.6"></a><span id="l18.6" class="difflineminus">-&lt;!ENTITY window.title             &quot;Feed Properties&quot;&gt;</span>
<a href="#l18.7"></a><span id="l18.7" class="difflineminus">-</span>
<a href="#l18.8"></a><span id="l18.8" class="difflineminus">-&lt;!ENTITY feedFolder.label         &quot;Store Articles in: &quot;&gt;</span>
<a href="#l18.9"></a><span id="l18.9" class="difflineminus">-&lt;!ENTITY feedFolder.accesskey     &quot;S&quot;&gt;</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineminus">-</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineminus">-&lt;!ENTITY feedLocation.label       &quot;Feed URL: &quot;&gt;</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-&lt;!ENTITY feedLocation.accesskey   &quot;F&quot;&gt;</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">-</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineminus">-&lt;!ENTITY choosethisfolder.label   &quot;choose this folder&quot;&gt;</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineminus">-</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineminus">-&lt;!ENTITY quickMode.label          &quot;Show the article summary instead of loading the web page&quot;&gt;</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineminus">-&lt;!ENTITY quickMode.accesskey      &quot;h&quot;&gt;</span>
<a href="#l18.18"></a><span id="l18.18" class="difflineminus">-</span>
<a href="#l18.19"></a><span id="l18.19" class="difflineminus">-&lt;!ENTITY copyLinkCmd.label        &quot;Copy Link Location&quot;&gt;</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineminus">-&lt;!ENTITY copyLinkCmd.accesskey    &quot;C&quot;&gt;</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineminus">-</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineminus">-&lt;!ENTITY pasteLinkCmd.label       &quot;Paste&quot;&gt;</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineminus">-&lt;!ENTITY pasteLinkCmd.accesskey   &quot;P&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -1,18 +1,31 @@</span>
<a href="#l19.4"></a><span id="l19.4"> &lt;!-- Subscription Dialog --&gt;</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineminus">-&lt;!ENTITY feedSubscriptions.label &quot;Feed Subscriptions&quot;&gt;</span>
<a href="#l19.6"></a><span id="l19.6" class="difflineminus">-&lt;!ENTITY subscriptionDesc.label &quot;Note: Removing or changing the folder for a feed will not affect previously downloaded articles.&quot;&gt;</span>
<a href="#l19.7"></a><span id="l19.7" class="difflineminus">-&lt;!ENTITY feedTitle.label &quot;Title:&quot;&gt;</span>
<a href="#l19.8"></a><span id="l19.8" class="difflineminus">-&lt;!ENTITY location.label  &quot;Location:&quot;&gt;</span>
<a href="#l19.9"></a><span id="l19.9" class="difflineplus">+&lt;!ENTITY feedSubscriptions.label     &quot;Feed Subscriptions&quot;&gt;</span>
<a href="#l19.10"></a><span id="l19.10" class="difflineplus">+&lt;!ENTITY subscriptionDesc.label      &quot;Note: Removing or changing the folder for a feed will not affect previously downloaded articles.&quot;&gt;</span>
<a href="#l19.11"></a><span id="l19.11" class="difflineplus">+</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+&lt;!ENTITY feedTitle.label             &quot;Title:&quot;&gt;</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+&lt;!ENTITY feedTitle.accesskey         &quot;T&quot;&gt;</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+&lt;!ENTITY feedLocation.label          &quot;Feed URL:&quot;&gt;</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineplus">+&lt;!ENTITY feedLocation.accesskey      &quot;U&quot;&gt;</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+&lt;!ENTITY feedLocation.placeholder    &quot;Enter a valid feed url to Add&quot;&gt;</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineplus">+</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineplus">+&lt;!ENTITY feedFolder.label            &quot;Store Articles in:&quot;&gt;</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineplus">+&lt;!ENTITY feedFolder.accesskey        &quot;S&quot;&gt;</span>
<a href="#l19.21"></a><span id="l19.21"> </span>
<a href="#l19.22"></a><span id="l19.22" class="difflineminus">-&lt;!ENTITY button.addFeed.label       &quot;Add&quot;&gt;</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineminus">-&lt;!ENTITY button.addFeed.accesskey   &quot;A&quot;&gt;</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineminus">-&lt;!ENTITY button.editFeed.label      &quot;Edit&quot;&gt;</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineminus">-&lt;!ENTITY button.editFeed.accesskey  &quot;E&quot;&gt;</span>
<a href="#l19.26"></a><span id="l19.26" class="difflineminus">-&lt;!ENTITY button.removeFeed.label &quot;Remove&quot;&gt;</span>
<a href="#l19.27"></a><span id="l19.27" class="difflineminus">-&lt;!ENTITY button.removeFeed.accesskey   &quot;R&quot;&gt;</span>
<a href="#l19.28"></a><span id="l19.28" class="difflineminus">-&lt;!ENTITY button.importOPML.label &quot;Import&quot;&gt;</span>
<a href="#l19.29"></a><span id="l19.29" class="difflineminus">-&lt;!ENTITY button.importOPML.accesskey   &quot;I&quot;&gt;</span>
<a href="#l19.30"></a><span id="l19.30" class="difflineminus">-&lt;!ENTITY button.exportOPML.label &quot;Export&quot;&gt;</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineminus">-&lt;!ENTITY button.exportOPML.accesskey   &quot;X&quot;&gt;</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineplus">+&lt;!ENTITY quickMode.label             &quot;Show the article summary instead of loading the web page&quot;&gt;</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineplus">+&lt;!ENTITY quickMode.accesskey         &quot;h&quot;&gt;</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineplus">+</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineplus">+&lt;!ENTITY validateText.label          &quot;Check validation and retrieve a valid url.&quot;&gt;</span>
<a href="#l19.36"></a><span id="l19.36"> </span>
<a href="#l19.37"></a><span id="l19.37" class="difflineminus">-&lt;!ENTITY cmd.close.commandKey             &quot;w&quot;&gt;</span>
<a href="#l19.38"></a><span id="l19.38" class="difflineplus">+&lt;!ENTITY button.addFeed.label        &quot;Add&quot;&gt;</span>
<a href="#l19.39"></a><span id="l19.39" class="difflineplus">+&lt;!ENTITY button.addFeed.accesskey    &quot;A&quot;&gt;</span>
<a href="#l19.40"></a><span id="l19.40" class="difflineplus">+&lt;!ENTITY button.editFeed.label       &quot;Update&quot;&gt;</span>
<a href="#l19.41"></a><span id="l19.41" class="difflineplus">+&lt;!ENTITY button.editFeed.accesskey   &quot;U&quot;&gt;</span>
<a href="#l19.42"></a><span id="l19.42" class="difflineplus">+&lt;!ENTITY button.removeFeed.label     &quot;Remove&quot;&gt;</span>
<a href="#l19.43"></a><span id="l19.43" class="difflineplus">+&lt;!ENTITY button.removeFeed.accesskey &quot;R&quot;&gt;</span>
<a href="#l19.44"></a><span id="l19.44" class="difflineplus">+&lt;!ENTITY button.importOPML.label     &quot;Import&quot;&gt;</span>
<a href="#l19.45"></a><span id="l19.45" class="difflineplus">+&lt;!ENTITY button.importOPML.accesskey &quot;I&quot;&gt;</span>
<a href="#l19.46"></a><span id="l19.46" class="difflineplus">+&lt;!ENTITY button.exportOPML.label     &quot;Export&quot;&gt;</span>
<a href="#l19.47"></a><span id="l19.47" class="difflineplus">+&lt;!ENTITY button.exportOPML.accesskey &quot;X&quot;&gt;</span>
<a href="#l19.48"></a><span id="l19.48" class="difflineplus">+</span>
<a href="#l19.49"></a><span id="l19.49" class="difflineplus">+&lt;!ENTITY cmd.close.commandKey        &quot;w&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/newsblog/newsblog.properties</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/newsblog/newsblog.properties</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -1,14 +1,19 @@</span>
<a href="#l20.4"></a><span id="l20.4"> subscribe-validating-feed=Verifying the feed…</span>
<a href="#l20.5"></a><span id="l20.5"> subscribe-cancelSubscription=Are you sure you wish to cancel subscribing to the current feed?</span>
<a href="#l20.6"></a><span id="l20.6"> subscribe-cancelSubscriptionTitle=Subscribing to a Feed…</span>
<a href="#l20.7"></a><span id="l20.7" class="difflineminus">-subscribe-noFeedIsSelected=&lt;no feed selected&gt;</span>
<a href="#l20.8"></a><span id="l20.8"> subscribe-feedAlreadySubscribed=You already have a subscription for this feed.</span>
<a href="#l20.9"></a><span id="l20.9"> subscribe-errorOpeningFile=Could not open the file.</span>
<a href="#l20.10"></a><span id="l20.10" class="difflineplus">+subscribe-feedAdded=Feed added.</span>
<a href="#l20.11"></a><span id="l20.11" class="difflineplus">+subscribe-feedUpdated=Feed updated.</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineplus">+subscribe-feedMoved=Feed subscription moved.</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+subscribe-feedRemoved=Feed unsubscribed.</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineplus">+subscribe-feedNotValid=The Feed URL is not a valid feed.</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineplus">+subscribe-networkError=The Feed URL could not be found. Please check the name and try again.</span>
<a href="#l20.16"></a><span id="l20.16"> </span>
<a href="#l20.17"></a><span id="l20.17"> subscribe-OPMLImportTitle=Select OPML file to import</span>
<a href="#l20.18"></a><span id="l20.18"> subscribe-OPMLExportTitle=Export feeds as an OPML file</span>
<a href="#l20.19"></a><span id="l20.19"> ## LOCALIZATION NOTE(subscribe-OPMLExportFileDialogTitle): %S is the brandShortName</span>
<a href="#l20.20"></a><span id="l20.20"> subscribe-OPMLExportFileDialogTitle=%S OPML Export</span>
<a href="#l20.21"></a><span id="l20.21"> ## LOCALIZATION NOTE(subscribe-OPMLExportDefaultFileName): %S is the brandShortName</span>
<a href="#l20.22"></a><span id="l20.22"> subscribe-OPMLExportDefaultFileName=My%SFeeds.opml</span>
<a href="#l20.23"></a><span id="l20.23"> ## LOCALIZATION NOTE(subscribe-OPMLImportInvalidFile): %S is the name of the OPML file the user tried to import.</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineat">@@ -27,18 +32,16 @@ subscribe-confirmFeedDeletionTitle=Remov</span>
<a href="#l20.25"></a><span id="l20.25"> subscribe-confirmFeedDeletion=Are you sure you want to unsubscribe from the feed: \n %S?</span>
<a href="#l20.26"></a><span id="l20.26"> </span>
<a href="#l20.27"></a><span id="l20.27"> ## LOCALIZATION NOTE(subscribe-gettingFeedItems):</span>
<a href="#l20.28"></a><span id="l20.28"> ##  - The first %S is the number of articles processed so far;</span>
<a href="#l20.29"></a><span id="l20.29"> ##  - The second %S is the total number of items</span>
<a href="#l20.30"></a><span id="l20.30"> subscribe-gettingFeedItems=Downloading feed articles (%S of %S)…</span>
<a href="#l20.31"></a><span id="l20.31"> </span>
<a href="#l20.32"></a><span id="l20.32"> newsblog-noNewArticlesForFeed=There are no new articles for this feed.</span>
<a href="#l20.33"></a><span id="l20.33" class="difflineminus">-newsblog-networkErrorTitle=Network Error</span>
<a href="#l20.34"></a><span id="l20.34"> ## LOCALIZATION NOTE(newsblog-networkError): %S is the feed URL</span>
<a href="#l20.35"></a><span id="l20.35"> newsblog-networkError=%S could not be found. Please check the name and try again.</span>
<a href="#l20.36"></a><span id="l20.36" class="difflineminus">-newsblog-feedNotValidTitle=Invalid Feed</span>
<a href="#l20.37"></a><span id="l20.37"> ## LOCALIZATION NOTE(newsblog-feedNotValid): %S is the feed URL</span>
<a href="#l20.38"></a><span id="l20.38"> newsblog-feedNotValid=%S is not a valid feed.</span>
<a href="#l20.39"></a><span id="l20.39"> newsblog-getNewMsgsCheck=Checking feeds for new items…</span>
<a href="#l20.40"></a><span id="l20.40"> </span>
<a href="#l20.41"></a><span id="l20.41"> ## LOCALIZATION NOTE(feeds-accountname): This string should be the same as feeds.accountName in am-newsblog.dtd</span>
<a href="#l20.42"></a><span id="l20.42"> feeds-accountname=Blogs &amp; News Feeds</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/suite/locales/jar.mn</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/suite/locales/jar.mn</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -334,18 +334,16 @@</span>
<a href="#l21.4"></a><span id="l21.4">   locale/@AB_CD@/messenger-smime/msgCompSMIMEOverlay.properties             (%chrome/mailnews/smime/msgCompSMIMEOverlay.properties)</span>
<a href="#l21.5"></a><span id="l21.5">   locale/@AB_CD@/messenger-smime/msgReadSecurityInfo.dtd                    (%chrome/mailnews/smime/msgReadSecurityInfo.dtd)</span>
<a href="#l21.6"></a><span id="l21.6">   locale/@AB_CD@/messenger-smime/msgReadSMIMEOverlay.dtd                    (%chrome/mailnews/smime/msgReadSMIMEOverlay.dtd)</span>
<a href="#l21.7"></a><span id="l21.7">   locale/@AB_CD@/messenger-smime/msgReadSMIMEOverlay.properties             (%chrome/mailnews/smime/msgReadSMIMEOverlay.properties)</span>
<a href="#l21.8"></a><span id="l21.8">   locale/@AB_CD@/messenger-smime/msgSecurityInfo.properties                 (%chrome/mailnews/smime/msgSecurityInfo.properties)</span>
<a href="#l21.9"></a><span id="l21.9"> #endif</span>
<a href="#l21.10"></a><span id="l21.10">   locale/@AB_CD@/messenger-newsblog/newsblog.properties                     (%chrome/mailnews/newsblog/newsblog.properties)</span>
<a href="#l21.11"></a><span id="l21.11">   locale/@AB_CD@/messenger-newsblog/feed-subscriptions.dtd                  (%chrome/mailnews/newsblog/feed-subscriptions.dtd)</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-  locale/@AB_CD@/messenger-newsblog/feed-properties.dtd                     (%chrome/mailnews/newsblog/feed-properties.dtd)</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineminus">-  locale/@AB_CD@/messenger-newsblog/am-newsblog.properties                  (%chrome/mailnews/newsblog/am-newsblog.properties)</span>
<a href="#l21.14"></a><span id="l21.14">   locale/@AB_CD@/messenger-newsblog/am-newsblog.dtd                         (%chrome/mailnews/newsblog/am-newsblog.dtd)</span>
<a href="#l21.15"></a><span id="l21.15">   locale/@AB_CD@/mozldap/ldap.properties                                    (%chrome/mozldap/ldap.properties)</span>
<a href="#l21.16"></a><span id="l21.16">   locale/@AB_CD@/navigator/linkToolbar.dtd                                  (%chrome/browser/linkToolbar.dtd)</span>
<a href="#l21.17"></a><span id="l21.17">   locale/@AB_CD@/navigator/mailNavigatorOverlay.dtd                         (%chrome/browser/mailNavigatorOverlay.dtd)</span>
<a href="#l21.18"></a><span id="l21.18">   locale/@AB_CD@/navigator/metadata.dtd                                     (%chrome/browser/metadata.dtd)</span>
<a href="#l21.19"></a><span id="l21.19">   locale/@AB_CD@/navigator/metadata.properties                              (%chrome/browser/metadata.properties)</span>
<a href="#l21.20"></a><span id="l21.20">   locale/@AB_CD@/navigator/navigator.dtd                                    (%chrome/browser/navigator.dtd)</span>
<a href="#l21.21"></a><span id="l21.21">   locale/@AB_CD@/navigator/navigator.properties                             (%chrome/browser/navigator.properties)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/suite/themes/classic/messenger/newsblog/feed-subscriptions.css</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/suite/themes/classic/messenger/newsblog/feed-subscriptions.css</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -31,37 +31,29 @@</span>
<a href="#l22.4"></a><span id="l22.4">  * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l22.5"></a><span id="l22.5">  * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l22.6"></a><span id="l22.6">  * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l22.7"></a><span id="l22.7">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l22.8"></a><span id="l22.8">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l22.9"></a><span id="l22.9">  *</span>
<a href="#l22.10"></a><span id="l22.10">  * ***** END LICENSE BLOCK ****** */</span>
<a href="#l22.11"></a><span id="l22.11"> </span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-/* ::::: Feed Subscription UI icons :::::: */</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+/* ::::: Feed Subscription styling :::::: */</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineplus">+</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineplus">+#subscriptionsDialog {</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineplus">+  width: 40em;</span>
<a href="#l22.17"></a><span id="l22.17" class="difflineplus">+  height: 30em;</span>
<a href="#l22.18"></a><span id="l22.18" class="difflineplus">+}</span>
<a href="#l22.19"></a><span id="l22.19"> </span>
<a href="#l22.20"></a><span id="l22.20"> #contentPane {</span>
<a href="#l22.21"></a><span id="l22.21">   padding: 14px;</span>
<a href="#l22.22"></a><span id="l22.22"> }</span>
<a href="#l22.23"></a><span id="l22.23"> </span>
<a href="#l22.24"></a><span id="l22.24" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol) {</span>
<a href="#l22.25"></a><span id="l22.25" class="difflineminus">-  -moz-margin-end: 2px;</span>
<a href="#l22.26"></a><span id="l22.26" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-newsgroup.png&quot;);</span>
<a href="#l22.27"></a><span id="l22.27" class="difflineminus">-}</span>
<a href="#l22.28"></a><span id="l22.28" class="difflineminus">-</span>
<a href="#l22.29"></a><span id="l22.29" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol, container) {</span>
<a href="#l22.30"></a><span id="l22.30" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-closed.png&quot;);</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineplus">+#rssFeedInfoBox {</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineplus">+  border: 1px solid ThreeDShadow;</span>
<a href="#l22.33"></a><span id="l22.33" class="difflineplus">+  margin: 4px;</span>
<a href="#l22.34"></a><span id="l22.34" class="difflineplus">+  padding-top: 4px;</span>
<a href="#l22.35"></a><span id="l22.35" class="difflineplus">+  background-color: ThreeDLightShadow;</span>
<a href="#l22.36"></a><span id="l22.36"> }</span>
<a href="#l22.37"></a><span id="l22.37"> </span>
<a href="#l22.38"></a><span id="l22.38" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol, container, open) {</span>
<a href="#l22.39"></a><span id="l22.39" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-open.png&quot;);</span>
<a href="#l22.40"></a><span id="l22.40" class="difflineplus">+#statusContainerBox {</span>
<a href="#l22.41"></a><span id="l22.41" class="difflineplus">+  height: 24px;</span>
<a href="#l22.42"></a><span id="l22.42"> }</span>
<a href="#l22.43"></a><span id="l22.43" class="difflineminus">-</span>
<a href="#l22.44"></a><span id="l22.44" class="difflineminus">-#rssFeedInfoBox {</span>
<a href="#l22.45"></a><span id="l22.45" class="difflineminus">-  border: 1px solid ThreeDShadow;</span>
<a href="#l22.46"></a><span id="l22.46" class="difflineminus">-  border-radius: 0px;</span>
<a href="#l22.47"></a><span id="l22.47" class="difflineminus">-  margin: 4px;</span>
<a href="#l22.48"></a><span id="l22.48" class="difflineminus">-  padding: 0px;</span>
<a href="#l22.49"></a><span id="l22.49" class="difflineminus">-}</span>
<a href="#l22.50"></a><span id="l22.50" class="difflineminus">-</span>
<a href="#l22.51"></a><span id="l22.51" class="difflineminus">-#backgroundBox {</span>
<a href="#l22.52"></a><span id="l22.52" class="difflineminus">-  background-color: ThreeDLightShadow;</span>
<a href="#l22.53"></a><span id="l22.53" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/suite/themes/modern/messenger/newsblog/feed-subscriptions.css</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/suite/themes/modern/messenger/newsblog/feed-subscriptions.css</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -31,37 +31,29 @@</span>
<a href="#l23.4"></a><span id="l23.4">  * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l23.5"></a><span id="l23.5">  * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l23.6"></a><span id="l23.6">  * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l23.7"></a><span id="l23.7">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l23.8"></a><span id="l23.8">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l23.9"></a><span id="l23.9">  *</span>
<a href="#l23.10"></a><span id="l23.10">  * ***** END LICENSE BLOCK ****** */</span>
<a href="#l23.11"></a><span id="l23.11"> </span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-/* ::::: Feed Subscription UI icons :::::: */</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+/* ::::: Feed Subscription styling :::::: */</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineplus">+</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineplus">+#subscriptionsDialog {</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineplus">+  width: 40em;</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineplus">+  height: 30em;</span>
<a href="#l23.18"></a><span id="l23.18" class="difflineplus">+}</span>
<a href="#l23.19"></a><span id="l23.19"> </span>
<a href="#l23.20"></a><span id="l23.20"> #contentPane {</span>
<a href="#l23.21"></a><span id="l23.21">   padding: 14px;</span>
<a href="#l23.22"></a><span id="l23.22"> }</span>
<a href="#l23.23"></a><span id="l23.23"> </span>
<a href="#l23.24"></a><span id="l23.24" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol) {</span>
<a href="#l23.25"></a><span id="l23.25" class="difflineminus">-  -moz-margin-end: 2px;</span>
<a href="#l23.26"></a><span id="l23.26" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-newsgroup.gif&quot;);</span>
<a href="#l23.27"></a><span id="l23.27" class="difflineminus">-}</span>
<a href="#l23.28"></a><span id="l23.28" class="difflineminus">-</span>
<a href="#l23.29"></a><span id="l23.29" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol, container) {</span>
<a href="#l23.30"></a><span id="l23.30" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-closed.gif&quot;);</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineplus">+#rssFeedInfoBox {</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineplus">+  border: 1px solid #2D3B49;</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineplus">+  margin: 4px;</span>
<a href="#l23.34"></a><span id="l23.34" class="difflineplus">+  padding-top: 4px;</span>
<a href="#l23.35"></a><span id="l23.35" class="difflineplus">+  background-color: #BBC6D1;</span>
<a href="#l23.36"></a><span id="l23.36"> }</span>
<a href="#l23.37"></a><span id="l23.37"> </span>
<a href="#l23.38"></a><span id="l23.38" class="difflineminus">-#subscriptionChildren::-moz-tree-image(folderNameCol, container, open) {</span>
<a href="#l23.39"></a><span id="l23.39" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-open.gif&quot;);</span>
<a href="#l23.40"></a><span id="l23.40" class="difflineplus">+#statusContainerBox {</span>
<a href="#l23.41"></a><span id="l23.41" class="difflineplus">+  height: 24px;</span>
<a href="#l23.42"></a><span id="l23.42"> }</span>
<a href="#l23.43"></a><span id="l23.43" class="difflineminus">-</span>
<a href="#l23.44"></a><span id="l23.44" class="difflineminus">-#rssFeedInfoBox {</span>
<a href="#l23.45"></a><span id="l23.45" class="difflineminus">-  border: 1px solid #2D3B49;</span>
<a href="#l23.46"></a><span id="l23.46" class="difflineminus">-  border-radius: 0px;</span>
<a href="#l23.47"></a><span id="l23.47" class="difflineminus">-  margin: 4px;</span>
<a href="#l23.48"></a><span id="l23.48" class="difflineminus">-  padding: 0px;</span>
<a href="#l23.49"></a><span id="l23.49" class="difflineminus">-}</span>
<a href="#l23.50"></a><span id="l23.50" class="difflineminus">-</span>
<a href="#l23.51"></a><span id="l23.51" class="difflineminus">-#backgroundBox {</span>
<a href="#l23.52"></a><span id="l23.52" class="difflineminus">-  background-color: #BBC6D1;</span>
<a href="#l23.53"></a><span id="l23.53" class="difflineminus">-}</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

