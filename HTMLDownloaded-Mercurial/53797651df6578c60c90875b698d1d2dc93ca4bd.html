<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 23992:53797651df6578c60c90875b698d1d2dc93ca4bd</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 53797651df6578c60c90875b698d1d2dc93ca4bd" />
<meta property="og:url" content="/comm-central/rev/53797651df6578c60c90875b698d1d2dc93ca4bd" />
<meta property="og:description" content="Bug 1463266 - replace tabs with spaces in mailnews/db. rs=white-space-only" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 53797651df6578c60c90875b698d1d2dc93ca4bd 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/53797651df6578c60c90875b698d1d2dc93ca4bd">shortlog</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/53797651df6578c60c90875b698d1d2dc93ca4bd">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd">files</a> |
changeset |
<a href="/comm-central/raw-rev/53797651df6578c60c90875b698d1d2dc93ca4bd">raw</a>  | <a href="/comm-central/archive/53797651df6578c60c90875b698d1d2dc93ca4bd.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1463266">Bug 1463266</a> - replace tabs with spaces in mailnews/db. rs=white-space-only
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#114;&#103;&#32;&#75;&#32;&#60;&#106;&#111;&#114;&#103;&#107;&#64;&#106;&#111;&#114;&#103;&#107;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 29 May 2018 20:43:34 +0200</td></tr>

<tr>
 <td>changeset 23992</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/53797651df6578c60c90875b698d1d2dc93ca4bd">53797651df6578c60c90875b698d1d2dc93ca4bd</a></td>
</tr>



<tr>
<td>parent 23991</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/d6ef5265865e761f94b4fcc59ed061be3aa5ee52">d6ef5265865e761f94b4fcc59ed061be3aa5ee52</a>
</td>
</tr>

<tr>
<td>child 23993</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/62ddd3d9af03d0d66e3ce80c3565bbac2cbc6be8">62ddd3d9af03d0d66e3ce80c3565bbac2cbc6be8</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=53797651df6578c60c90875b698d1d2dc93ca4bd">14470</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Tue, 29 May 2018 21:55:55 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@62ddd3d9af03 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=62ddd3d9af03d0d66e3ce80c3565bbac2cbc6be8">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=62ddd3d9af03d0d66e3ce80c3565bbac2cbc6be8&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=62ddd3d9af03d0d66e3ce80c3565bbac2cbc6be8&newProject=comm-central&newRevision=53797651df6578c60c90875b698d1d2dc93ca4bd&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=62ddd3d9af03d0d66e3ce80c3565bbac2cbc6be8&newProject=comm-central&newRevision=53797651df6578c60c90875b698d1d2dc93ca4bd&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=62ddd3d9af03d0d66e3ce80c3565bbac2cbc6be8&newProject=comm-central&newRevision=53797651df6578c60c90875b698d1d2dc93ca4bd&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28white-space-only%29&revcount=50">white-space-only</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1463266">1463266</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1463266">Bug 1463266</a> - replace tabs with spaces in mailnews/db. rs=white-space-only
[skip-blame]</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/components/glautocomp.js">mailnews/db/gloda/components/glautocomp.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/components/glautocomp.js">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/components/glautocomp.js">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/components/glautocomp.js">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/components/glautocomp.js">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/components/glautocomp.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/modules/mimemsg.js">mailnews/db/gloda/modules/mimemsg.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/modules/mimemsg.js">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/modules/mimemsg.js">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/modules/mimemsg.js">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/modules/mimemsg.js">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/gloda/modules/mimemsg.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsDBFolderInfo.h">mailnews/db/msgdb/public/nsDBFolderInfo.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsDBFolderInfo.h">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsDBFolderInfo.h">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsDBFolderInfo.h">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsDBFolderInfo.h">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsDBFolderInfo.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMailDatabase.h">mailnews/db/msgdb/public/nsMailDatabase.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMailDatabase.h">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMailDatabase.h">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMailDatabase.h">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMailDatabase.h">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMailDatabase.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgDBCID.h">mailnews/db/msgdb/public/nsMsgDBCID.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgDBCID.h">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgDBCID.h">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgDBCID.h">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgDBCID.h">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgDBCID.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgHdr.h">mailnews/db/msgdb/public/nsMsgHdr.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgHdr.h">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgHdr.h">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgHdr.h">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgHdr.h">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/public/nsMsgHdr.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsDBFolderInfo.cpp">mailnews/db/msgdb/src/nsDBFolderInfo.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsDBFolderInfo.cpp">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsDBFolderInfo.cpp">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsDBFolderInfo.cpp">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsDBFolderInfo.cpp">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsDBFolderInfo.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsImapMailDatabase.cpp">mailnews/db/msgdb/src/nsImapMailDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsImapMailDatabase.cpp">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsImapMailDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsImapMailDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsImapMailDatabase.cpp">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsImapMailDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMailDatabase.cpp">mailnews/db/msgdb/src/nsMailDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMailDatabase.cpp">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMailDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMailDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMailDatabase.cpp">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMailDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">mailnews/db/msgdb/src/nsMsgDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgHdr.cpp">mailnews/db/msgdb/src/nsMsgHdr.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgHdr.cpp">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgHdr.cpp">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgHdr.cpp">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgHdr.cpp">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgHdr.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgThread.cpp">mailnews/db/msgdb/src/nsMsgThread.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgThread.cpp">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgThread.cpp">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgThread.cpp">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgThread.cpp">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsMsgThread.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsNewsDatabase.cpp">mailnews/db/msgdb/src/nsNewsDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsNewsDatabase.cpp">file</a> |
<a href="/comm-central/annotate/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsNewsDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsNewsDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsNewsDatabase.cpp">comparison</a> |
<a href="/comm-central/log/53797651df6578c60c90875b698d1d2dc93ca4bd/mailnews/db/msgdb/src/nsNewsDatabase.cpp">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mailnews/db/gloda/components/glautocomp.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mailnews/db/gloda/components/glautocomp.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -221,17 +221,17 @@ ContactIdentityCompleter.prototype = {</span>
<a href="#l1.4"></a><span id="l1.4">       map(match =&gt; new ResultRowSingle(match, &quot;text&quot;, aResult.searchString));</span>
<a href="#l1.5"></a><span id="l1.5">     aResult.addRows(rows);</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7">     // - match against database contacts / identities</span>
<a href="#l1.8"></a><span id="l1.8">     let pending = {contactToThing: contactToThing, pendingCount: 2};</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10">     let contactQuery = Gloda.newQuery(Gloda.NOUN_CONTACT);</span>
<a href="#l1.11"></a><span id="l1.11">     contactQuery.nameLike(contactQuery.WILDCARD, aString,</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-	contactQuery.WILDCARD);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+                          contactQuery.WILDCARD);</span>
<a href="#l1.14"></a><span id="l1.14">     pending.contactColl = contactQuery.getCollection(this, aResult);</span>
<a href="#l1.15"></a><span id="l1.15">     pending.contactColl.becomeExplicit();</span>
<a href="#l1.16"></a><span id="l1.16"> </span>
<a href="#l1.17"></a><span id="l1.17">     let identityQuery = Gloda.newQuery(Gloda.NOUN_IDENTITY);</span>
<a href="#l1.18"></a><span id="l1.18">     identityQuery.kind(&quot;email&quot;).valueLike(identityQuery.WILDCARD, aString,</span>
<a href="#l1.19"></a><span id="l1.19">         identityQuery.WILDCARD);</span>
<a href="#l1.20"></a><span id="l1.20">     pending.identityColl = identityQuery.getCollection(this, aResult);</span>
<a href="#l1.21"></a><span id="l1.21">     pending.identityColl.becomeExplicit();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mailnews/db/gloda/modules/mimemsg.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/mimemsg.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -504,17 +504,17 @@ MimeContainer.prototype = {</span>
<a href="#l2.4"></a><span id="l2.4">       for (let part of this.parts) {</span>
<a href="#l2.5"></a><span id="l2.5">         if (part.contentType == &quot;text/plain&quot;)</span>
<a href="#l2.6"></a><span id="l2.6">           return part.body;</span>
<a href="#l2.7"></a><span id="l2.7">         if (part.contentType == &quot;text/html&quot;)</span>
<a href="#l2.8"></a><span id="l2.8">           htmlPart = part;</span>
<a href="#l2.9"></a><span id="l2.9">         // text/enriched gets transformed into HTML, use it if we don't already</span>
<a href="#l2.10"></a><span id="l2.10">         //  have an HTML part.</span>
<a href="#l2.11"></a><span id="l2.11">         else if (!htmlPart &amp;&amp; part.contentType == &quot;text/enriched&quot;)</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-	  htmlPart = part;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+          htmlPart = part;</span>
<a href="#l2.14"></a><span id="l2.14">       }</span>
<a href="#l2.15"></a><span id="l2.15">       // convert the HTML part if we have one</span>
<a href="#l2.16"></a><span id="l2.16">       if (htmlPart)</span>
<a href="#l2.17"></a><span id="l2.17">         return aMsgFolder.convertMsgSnippetToPlainText(htmlPart.body);</span>
<a href="#l2.18"></a><span id="l2.18">     }</span>
<a href="#l2.19"></a><span id="l2.19">     // if it's not alternative, recurse/aggregate using MimeMessage logic</span>
<a href="#l2.20"></a><span id="l2.20">     return MimeMessage.prototype.coerceBodyToPlaintext.call(this, aMsgFolder);</span>
<a href="#l2.21"></a><span id="l2.21">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/db/msgdb/public/nsDBFolderInfo.h</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/db/msgdb/public/nsDBFolderInfo.h</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,15 +1,15 @@</span>
<a href="#l3.4"></a><span id="l3.4"> /* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */</span>
<a href="#l3.5"></a><span id="l3.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.6"></a><span id="l3.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.7"></a><span id="l3.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l3.8"></a><span id="l3.8"> </span>
<a href="#l3.9"></a><span id="l3.9"> /* This class encapsulates the global information about a folder stored in the</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineminus">-	summary file.</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineplus">+   summary file.</span>
<a href="#l3.12"></a><span id="l3.12"> */</span>
<a href="#l3.13"></a><span id="l3.13"> #ifndef _nsDBFolderInfo_H</span>
<a href="#l3.14"></a><span id="l3.14"> #define _nsDBFolderInfo_H</span>
<a href="#l3.15"></a><span id="l3.15"> </span>
<a href="#l3.16"></a><span id="l3.16"> #include &quot;mozilla/MemoryReporting.h&quot;</span>
<a href="#l3.17"></a><span id="l3.17"> #include &quot;nsString.h&quot;</span>
<a href="#l3.18"></a><span id="l3.18"> #include &quot;MailNewsTypes.h&quot;</span>
<a href="#l3.19"></a><span id="l3.19"> #include &quot;mdb.h&quot;</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineat">@@ -32,17 +32,17 @@ public:</span>
<a href="#l3.21"></a><span id="l3.21">   friend class nsMsgDatabase;</span>
<a href="#l3.22"></a><span id="l3.22"> </span>
<a href="#l3.23"></a><span id="l3.23">   nsDBFolderInfo(nsMsgDatabase *mdb);</span>
<a href="#l3.24"></a><span id="l3.24"> </span>
<a href="#l3.25"></a><span id="l3.25">   NS_DECL_ISUPPORTS</span>
<a href="#l3.26"></a><span id="l3.26">     // interface methods.</span>
<a href="#l3.27"></a><span id="l3.27">     NS_DECL_NSIDBFOLDERINFO</span>
<a href="#l3.28"></a><span id="l3.28">     // create the appropriate table and row in a new db.</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineminus">-    nsresult			AddToNewMDB();</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+    nsresult AddToNewMDB();</span>
<a href="#l3.31"></a><span id="l3.31">   // accessor methods.</span>
<a href="#l3.32"></a><span id="l3.32"> </span>
<a href="#l3.33"></a><span id="l3.33">   bool      TestFlag(int32_t flags);</span>
<a href="#l3.34"></a><span id="l3.34">   int16_t   GetIMAPHierarchySeparator() ;</span>
<a href="#l3.35"></a><span id="l3.35">   void      SetIMAPHierarchySeparator(int16_t hierarchyDelimiter) ;</span>
<a href="#l3.36"></a><span id="l3.36">   void      ChangeImapTotalPendingMessages(int32_t delta);</span>
<a href="#l3.37"></a><span id="l3.37">   void      ChangeImapUnreadPendingMessages(int32_t delta) ;</span>
<a href="#l3.38"></a><span id="l3.38"> </span>
<a href="#l3.39"></a><span id="l3.39" class="difflineat">@@ -87,32 +87,32 @@ protected:</span>
<a href="#l3.40"></a><span id="l3.40">   //  m_numUnreadMessages and m_numMessages can never be negative. 0 means 'no msgs'.</span>
<a href="#l3.41"></a><span id="l3.41">   int32_t   m_numUnreadMessages;</span>
<a href="#l3.42"></a><span id="l3.42">   int32_t   m_numMessages;    // includes expunged and ignored messages</span>
<a href="#l3.43"></a><span id="l3.43"> </span>
<a href="#l3.44"></a><span id="l3.44">   int32_t   m_flags;  // folder specific flags. This holds things like re-use thread pane,</span>
<a href="#l3.45"></a><span id="l3.45">   // configured for off-line use, use default retrieval, purge article/header options</span>
<a href="#l3.46"></a><span id="l3.46"> </span>
<a href="#l3.47"></a><span id="l3.47">   uint16_t    m_version;                // for upgrading...</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineminus">-  int16_t     m_IMAPHierarchySeparator;	// imap path separator</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineplus">+  int16_t     m_IMAPHierarchySeparator; // imap path separator</span>
<a href="#l3.50"></a><span id="l3.50"> </span>
<a href="#l3.51"></a><span id="l3.51">   // mail only (for now)</span>
<a href="#l3.52"></a><span id="l3.52"> </span>
<a href="#l3.53"></a><span id="l3.53">   // IMAP only</span>
<a href="#l3.54"></a><span id="l3.54">   int32_t     m_ImapUidValidity;</span>
<a href="#l3.55"></a><span id="l3.55">   int32_t     m_totalPendingMessages;</span>
<a href="#l3.56"></a><span id="l3.56">   int32_t     m_unreadPendingMessages;</span>
<a href="#l3.57"></a><span id="l3.57"> </span>
<a href="#l3.58"></a><span id="l3.58">   // news only (for now)</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-  nsMsgKey    m_expiredMark;		// Highest invalid article number in group - for expiring</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineplus">+  nsMsgKey    m_expiredMark;  // Highest invalid article number in group - for expiring</span>
<a href="#l3.61"></a><span id="l3.61">   // the db folder info will have to know what db and row it belongs to, since it is really</span>
<a href="#l3.62"></a><span id="l3.62">   // just a wrapper around the singleton folder info row in the mdb.</span>
<a href="#l3.63"></a><span id="l3.63">   nsMsgDatabase *m_mdb;</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineminus">-  nsIMdbTable   *m_mdbTable;	// singleton table in db</span>
<a href="#l3.65"></a><span id="l3.65" class="difflineminus">-  nsIMdbRow     *m_mdbRow;	// singleton row in table;</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineplus">+  nsIMdbTable   *m_mdbTable;  // singleton table in db</span>
<a href="#l3.67"></a><span id="l3.67" class="difflineplus">+  nsIMdbRow     *m_mdbRow;    // singleton row in table;</span>
<a href="#l3.68"></a><span id="l3.68"> </span>
<a href="#l3.69"></a><span id="l3.69">   nsCString     m_charSet;</span>
<a href="#l3.70"></a><span id="l3.70">   bool          m_charSetOverride;</span>
<a href="#l3.71"></a><span id="l3.71">   bool          m_mdbTokensInitialized;</span>
<a href="#l3.72"></a><span id="l3.72"> </span>
<a href="#l3.73"></a><span id="l3.73">   mdb_token     m_rowScopeToken;</span>
<a href="#l3.74"></a><span id="l3.74">   mdb_token     m_tableKindToken;</span>
<a href="#l3.75"></a><span id="l3.75">   // tokens for the pre-set columns - we cache these for speed, which may be silly</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/db/msgdb/public/nsMailDatabase.h</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/db/msgdb/public/nsMailDatabase.h</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -33,17 +33,17 @@ public:</span>
<a href="#l4.4"></a><span id="l4.4">   virtual uint32_t  GetCurVersion() override {return kMsgDBVersion;}</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6">   NS_IMETHOD  GetOfflineOpForKey(nsMsgKey opKey, bool create,</span>
<a href="#l4.7"></a><span id="l4.7">                                  nsIMsgOfflineImapOperation **op) override;</span>
<a href="#l4.8"></a><span id="l4.8">   NS_IMETHOD  RemoveOfflineOp(nsIMsgOfflineImapOperation *op) override;</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10">   NS_IMETHOD  SetSummaryValid(bool valid) override;</span>
<a href="#l4.11"></a><span id="l4.11">   NS_IMETHOD  GetSummaryValid(bool *valid) override;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-	</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+</span>
<a href="#l4.14"></a><span id="l4.14">   NS_IMETHOD    EnumerateOfflineOps(nsISimpleEnumerator **enumerator) override;</span>
<a href="#l4.15"></a><span id="l4.15">   NS_IMETHOD    ListAllOfflineOpIds(nsTArray&lt;nsMsgKey&gt; *offlineOpIds) override;</span>
<a href="#l4.16"></a><span id="l4.16">   NS_IMETHOD    ListAllOfflineDeletes(nsTArray&lt;nsMsgKey&gt; *offlineDeletes) override;</span>
<a href="#l4.17"></a><span id="l4.17"> </span>
<a href="#l4.18"></a><span id="l4.18">   friend class nsMsgOfflineOpEnumerator;</span>
<a href="#l4.19"></a><span id="l4.19"> protected:</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21">   nsresult        GetAllOfflineOpsTable(); // get this on demand</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/db/msgdb/public/nsMsgDBCID.h</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/db/msgdb/public/nsMsgDBCID.h</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -19,17 +19,17 @@</span>
<a href="#l5.4"></a><span id="l5.4">   &quot;@mozilla.org/msgDatabase/msgDBService;1&quot;</span>
<a href="#l5.5"></a><span id="l5.5"> </span>
<a href="#l5.6"></a><span id="l5.6"> #define NS_MSGDB_CONTRACTID \</span>
<a href="#l5.7"></a><span id="l5.7">   &quot;@mozilla.org/nsMsgDatabase/msgDB-&quot;</span>
<a href="#l5.8"></a><span id="l5.8"> </span>
<a href="#l5.9"></a><span id="l5.9"> #define NS_MAILBOXDB_CONTRACTID \</span>
<a href="#l5.10"></a><span id="l5.10">   NS_MSGDB_CONTRACTID&quot;mailbox&quot;</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-//	a86c86ae-e97f-11d2-a506-0060b0fc04b7</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+// a86c86ae-e97f-11d2-a506-0060b0fc04b7</span>
<a href="#l5.14"></a><span id="l5.14"> #define NS_MAILDB_CID                      \</span>
<a href="#l5.15"></a><span id="l5.15"> { 0xa86c86ae, 0xe97f, 0x11d2,                   \</span>
<a href="#l5.16"></a><span id="l5.16">     { 0xa5, 0x06, 0x00, 0x60, 0xb0, 0xfc, 0x04, 0xb7 } }</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18"> #define NS_NEWSDB_CONTRACTID \</span>
<a href="#l5.19"></a><span id="l5.19">   NS_MSGDB_CONTRACTID&quot;news&quot;</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21"> // 36414aa0-e980-11d2-a506-0060b0fc04b7</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/db/msgdb/public/nsMsgHdr.h</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/db/msgdb/public/nsMsgHdr.h</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -14,17 +14,17 @@</span>
<a href="#l6.4"></a><span id="l6.4"> #include &quot;nsTArray.h&quot;</span>
<a href="#l6.5"></a><span id="l6.5"> </span>
<a href="#l6.6"></a><span id="l6.6"> class nsMsgDatabase;</span>
<a href="#l6.7"></a><span id="l6.7"> class nsIMsgThread;</span>
<a href="#l6.8"></a><span id="l6.8"> </span>
<a href="#l6.9"></a><span id="l6.9"> class nsMsgHdr : public nsIMsgDBHdr {</span>
<a href="#l6.10"></a><span id="l6.10"> public:</span>
<a href="#l6.11"></a><span id="l6.11">     NS_DECL_NSIMSGDBHDR</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-	friend class nsMsgDatabase;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+    friend class nsMsgDatabase;</span>
<a href="#l6.14"></a><span id="l6.14">     friend class nsMsgPropertyEnumerator; // accesses m_mdb</span>
<a href="#l6.15"></a><span id="l6.15">     ////////////////////////////////////////////////////////////////////////////</span>
<a href="#l6.16"></a><span id="l6.16">     ////////////////////////////////////////////////////////////////////////////</span>
<a href="#l6.17"></a><span id="l6.17">     // nsMsgHdr methods:</span>
<a href="#l6.18"></a><span id="l6.18">     nsMsgHdr(nsMsgDatabase *db, nsIMdbRow *dbRow);</span>
<a href="#l6.19"></a><span id="l6.19"> </span>
<a href="#l6.20"></a><span id="l6.20">     virtual nsresult    GetRawFlags(uint32_t *result);</span>
<a href="#l6.21"></a><span id="l6.21">     void                Init();</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineat">@@ -53,26 +53,26 @@ protected:</span>
<a href="#l6.23"></a><span id="l6.23">   virtual ~nsMsgHdr();</span>
<a href="#l6.24"></a><span id="l6.24">     nsresult SetStringColumn(const char *str, mdb_token token);</span>
<a href="#l6.25"></a><span id="l6.25">     nsresult SetUInt32Column(uint32_t value, mdb_token token);</span>
<a href="#l6.26"></a><span id="l6.26">     nsresult GetUInt32Column(mdb_token token, uint32_t *pvalue, uint32_t defaultValue = 0);</span>
<a href="#l6.27"></a><span id="l6.27">     nsresult SetUInt64Column(uint64_t value, mdb_token token);</span>
<a href="#l6.28"></a><span id="l6.28">     nsresult GetUInt64Column(mdb_token token, uint64_t *pvalue, uint64_t defaultValue = 0);</span>
<a href="#l6.29"></a><span id="l6.29"> </span>
<a href="#l6.30"></a><span id="l6.30">     // reference and threading stuff.</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-    nsresult	ParseReferences(const char *references);</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+    nsresult ParseReferences(const char *references);</span>
<a href="#l6.33"></a><span id="l6.33">     const char* GetNextReference(const char *startNextRef, nsCString &amp;reference,</span>
<a href="#l6.34"></a><span id="l6.34">                                  bool acceptNonDelimitedReferences);</span>
<a href="#l6.35"></a><span id="l6.35"> </span>
<a href="#l6.36"></a><span id="l6.36" class="difflineminus">-    nsMsgKey	m_threadId;</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineminus">-    nsMsgKey	m_messageKey; 	//news: article number, mail mbox offset, imap uid...</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineminus">-    nsMsgKey	m_threadParent;	// message this is a reply to, in thread.</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineplus">+    nsMsgKey    m_threadId;</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineplus">+    nsMsgKey    m_messageKey;   // news: article number, mail mbox offset, imap uid...</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineplus">+    nsMsgKey    m_threadParent; // message this is a reply to, in thread.</span>
<a href="#l6.42"></a><span id="l6.42">     PRTime      m_date;</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineminus">-    uint32_t    m_messageSize;	// lines for news articles, bytes for mail messages</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineminus">-    uint32_t    m_statusOffset;	// offset in a local mail message of the mozilla status hdr</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineplus">+    uint32_t    m_messageSize;  // lines for news articles, bytes for mail messages</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineplus">+    uint32_t    m_statusOffset; // offset in a local mail message of the mozilla status hdr</span>
<a href="#l6.47"></a><span id="l6.47">     uint32_t    m_flags;</span>
<a href="#l6.48"></a><span id="l6.48">     // avoid parsing references every time we want one</span>
<a href="#l6.49"></a><span id="l6.49">     nsTArray&lt;nsCString&gt; m_references;</span>
<a href="#l6.50"></a><span id="l6.50">     nsMsgPriorityValue  m_priority;</span>
<a href="#l6.51"></a><span id="l6.51"> </span>
<a href="#l6.52"></a><span id="l6.52">     // nsMsgHdrs will have to know what db and row they belong to, since they are really</span>
<a href="#l6.53"></a><span id="l6.53">     // just a wrapper around the msg row in the mdb. This could cause problems,</span>
<a href="#l6.54"></a><span id="l6.54">     // though I hope not.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsDBFolderInfo.cpp</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsDBFolderInfo.cpp</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -265,36 +265,36 @@ nsresult nsDBFolderInfo::AddToNewMDB()</span>
<a href="#l7.4"></a><span id="l7.4">     // create the singleton row for the dbFolderInfo.</span>
<a href="#l7.5"></a><span id="l7.5">     err  = store-&gt;NewRowWithOid(m_mdb-&gt;GetEnv(),</span>
<a href="#l7.6"></a><span id="l7.6">       &amp;gDBFolderInfoOID, &amp;m_mdbRow);</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8">     // add the row to the singleton table.</span>
<a href="#l7.9"></a><span id="l7.9">     if (m_mdbRow &amp;&amp; NS_SUCCEEDED(err))</span>
<a href="#l7.10"></a><span id="l7.10">       err = m_mdbTable-&gt;AddRow(m_mdb-&gt;GetEnv(), m_mdbRow);</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-    ret = err;	// what are we going to do about nsresult's?</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+    ret = err;  // what are we going to do about nsresult's?</span>
<a href="#l7.14"></a><span id="l7.14">   }</span>
<a href="#l7.15"></a><span id="l7.15">   return ret;</span>
<a href="#l7.16"></a><span id="l7.16"> }</span>
<a href="#l7.17"></a><span id="l7.17"> </span>
<a href="#l7.18"></a><span id="l7.18"> nsresult nsDBFolderInfo::InitFromExistingDB()</span>
<a href="#l7.19"></a><span id="l7.19"> {</span>
<a href="#l7.20"></a><span id="l7.20">   nsresult ret = NS_OK;</span>
<a href="#l7.21"></a><span id="l7.21">   if (m_mdb &amp;&amp; m_mdb-&gt;GetStore())</span>
<a href="#l7.22"></a><span id="l7.22">   {</span>
<a href="#l7.23"></a><span id="l7.23">     nsIMdbStore *store = m_mdb-&gt;GetStore();</span>
<a href="#l7.24"></a><span id="l7.24">     if (store)</span>
<a href="#l7.25"></a><span id="l7.25">     {</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineminus">-      mdb_pos		rowPos;</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+      mdb_pos rowPos;</span>
<a href="#l7.28"></a><span id="l7.28">       mdb_count outTableCount; // current number of such tables</span>
<a href="#l7.29"></a><span id="l7.29">       mdb_bool mustBeUnique; // whether port can hold only one of these</span>
<a href="#l7.30"></a><span id="l7.30">       mdb_bool hasOid;</span>
<a href="#l7.31"></a><span id="l7.31">       ret = store-&gt;GetTableKind(m_mdb-&gt;GetEnv(), m_rowScopeToken, m_tableKindToken, &amp;outTableCount,</span>
<a href="#l7.32"></a><span id="l7.32">         &amp;mustBeUnique, &amp;m_mdbTable);</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineminus">-      //			NS_ASSERTION(mustBeUnique &amp;&amp; outTableCount == 1, &quot;only one global db info allowed&quot;);</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+      // NS_ASSERTION(mustBeUnique &amp;&amp; outTableCount == 1, &quot;only one global db info allowed&quot;);</span>
<a href="#l7.35"></a><span id="l7.35"> </span>
<a href="#l7.36"></a><span id="l7.36">       if (m_mdbTable)</span>
<a href="#l7.37"></a><span id="l7.37">       {</span>
<a href="#l7.38"></a><span id="l7.38">         // find singleton row for global info.</span>
<a href="#l7.39"></a><span id="l7.39">         ret = m_mdbTable-&gt;HasOid(m_mdb-&gt;GetEnv(), &amp;gDBFolderInfoOID, &amp;hasOid);</span>
<a href="#l7.40"></a><span id="l7.40">         if (NS_SUCCEEDED(ret))</span>
<a href="#l7.41"></a><span id="l7.41">         {</span>
<a href="#l7.42"></a><span id="l7.42">           nsIMdbTableRowCursor *rowCursor;</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineat">@@ -319,17 +319,17 @@ nsresult nsDBFolderInfo::InitFromExistin</span>
<a href="#l7.44"></a><span id="l7.44"> }</span>
<a href="#l7.45"></a><span id="l7.45"> </span>
<a href="#l7.46"></a><span id="l7.46"> nsresult nsDBFolderInfo::InitMDBInfo()</span>
<a href="#l7.47"></a><span id="l7.47"> {</span>
<a href="#l7.48"></a><span id="l7.48">   nsresult ret = NS_OK;</span>
<a href="#l7.49"></a><span id="l7.49">   if (!m_mdbTokensInitialized &amp;&amp; m_mdb &amp;&amp; m_mdb-&gt;GetStore())</span>
<a href="#l7.50"></a><span id="l7.50">   {</span>
<a href="#l7.51"></a><span id="l7.51">     nsIMdbStore *store = m_mdb-&gt;GetStore();</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineminus">-    nsIMdbEnv	*env = m_mdb-&gt;GetEnv();</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineplus">+    nsIMdbEnv *env = m_mdb-&gt;GetEnv();</span>
<a href="#l7.54"></a><span id="l7.54"> </span>
<a href="#l7.55"></a><span id="l7.55">     store-&gt;StringToToken(env,  kNumMessagesColumnName, &amp;m_numMessagesColumnToken);</span>
<a href="#l7.56"></a><span id="l7.56">     store-&gt;StringToToken(env,  kNumUnreadMessagesColumnName, &amp;m_numUnreadMessagesColumnToken);</span>
<a href="#l7.57"></a><span id="l7.57">     store-&gt;StringToToken(env,  kFlagsColumnName, &amp;m_flagsColumnToken);</span>
<a href="#l7.58"></a><span id="l7.58">     store-&gt;StringToToken(env,  kFolderSizeColumnName, &amp;m_folderSizeColumnToken);</span>
<a href="#l7.59"></a><span id="l7.59">     store-&gt;StringToToken(env,  kExpungedBytesColumnName, &amp;m_expungedBytesColumnToken);</span>
<a href="#l7.60"></a><span id="l7.60">     store-&gt;StringToToken(env,  kFolderDateColumnName, &amp;m_folderDateColumnToken);</span>
<a href="#l7.61"></a><span id="l7.61"> </span>
<a href="#l7.62"></a><span id="l7.62" class="difflineat">@@ -595,17 +595,17 @@ NS_IMETHODIMP nsDBFolderInfo::OrFlags(in</span>
<a href="#l7.63"></a><span id="l7.63"> </span>
<a href="#l7.64"></a><span id="l7.64"> NS_IMETHODIMP nsDBFolderInfo::AndFlags(int32_t flags, int32_t *result)</span>
<a href="#l7.65"></a><span id="l7.65"> {</span>
<a href="#l7.66"></a><span id="l7.66">   m_flags &amp;= flags;</span>
<a href="#l7.67"></a><span id="l7.67">   *result = m_flags;</span>
<a href="#l7.68"></a><span id="l7.68">   return SetInt32PropertyWithToken(m_flagsColumnToken, m_flags);</span>
<a href="#l7.69"></a><span id="l7.69"> }</span>
<a href="#l7.70"></a><span id="l7.70"> </span>
<a href="#l7.71"></a><span id="l7.71" class="difflineminus">-NS_IMETHODIMP	nsDBFolderInfo::GetImapUidValidity(int32_t *result)</span>
<a href="#l7.72"></a><span id="l7.72" class="difflineplus">+NS_IMETHODIMP nsDBFolderInfo::GetImapUidValidity(int32_t *result)</span>
<a href="#l7.73"></a><span id="l7.73"> {</span>
<a href="#l7.74"></a><span id="l7.74">   *result = m_ImapUidValidity;</span>
<a href="#l7.75"></a><span id="l7.75">   return NS_OK;</span>
<a href="#l7.76"></a><span id="l7.76"> }</span>
<a href="#l7.77"></a><span id="l7.77"> </span>
<a href="#l7.78"></a><span id="l7.78"> NS_IMETHODIMP nsDBFolderInfo::SetImapUidValidity(int32_t uidValidity)</span>
<a href="#l7.79"></a><span id="l7.79"> {</span>
<a href="#l7.80"></a><span id="l7.80">   m_ImapUidValidity = uidValidity;</span>
<a href="#l7.81"></a><span id="l7.81" class="difflineat">@@ -882,17 +882,17 @@ nsresult nsDBFolderInfo::GetInt64Propert</span>
<a href="#l7.82"></a><span id="l7.82"> NS_IMETHODIMP nsDBFolderInfo::GetBooleanProperty(const char *propertyName, bool defaultValue, bool *propertyValue)</span>
<a href="#l7.83"></a><span id="l7.83"> {</span>
<a href="#l7.84"></a><span id="l7.84">   uint32_t defaultUint32Value = (defaultValue) ? 1 : 0;</span>
<a href="#l7.85"></a><span id="l7.85">   uint32_t returnValue;</span>
<a href="#l7.86"></a><span id="l7.86">   nsresult rv = m_mdb-&gt;GetUint32Property(m_mdbRow, propertyName, &amp;returnValue, defaultUint32Value);</span>
<a href="#l7.87"></a><span id="l7.87">   *propertyValue = (returnValue != 0);</span>
<a href="#l7.88"></a><span id="l7.88">   return rv;</span>
<a href="#l7.89"></a><span id="l7.89"> }</span>
<a href="#l7.90"></a><span id="l7.90" class="difflineminus">-NS_IMETHODIMP	nsDBFolderInfo::SetBooleanProperty(const char *propertyName, bool propertyValue)</span>
<a href="#l7.91"></a><span id="l7.91" class="difflineplus">+NS_IMETHODIMP nsDBFolderInfo::SetBooleanProperty(const char *propertyName, bool propertyValue)</span>
<a href="#l7.92"></a><span id="l7.92"> {</span>
<a href="#l7.93"></a><span id="l7.93">   return m_mdb-&gt;SetUint32Property(m_mdbRow, propertyName, propertyValue ? 1 : 0);</span>
<a href="#l7.94"></a><span id="l7.94"> }</span>
<a href="#l7.95"></a><span id="l7.95"> </span>
<a href="#l7.96"></a><span id="l7.96"> NS_IMETHODIMP nsDBFolderInfo::GetFolderName(nsACString &amp;folderName)</span>
<a href="#l7.97"></a><span id="l7.97"> {</span>
<a href="#l7.98"></a><span id="l7.98">   return GetCharProperty(&quot;folderName&quot;, folderName);</span>
<a href="#l7.99"></a><span id="l7.99"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsImapMailDatabase.cpp</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsImapMailDatabase.cpp</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -4,45 +4,45 @@</span>
<a href="#l8.4"></a><span id="l8.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6"> #include &lt;sys/stat.h&gt;</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8"> #include &quot;msgCore.h&quot;</span>
<a href="#l8.9"></a><span id="l8.9"> #include &quot;nsImapMailDatabase.h&quot;</span>
<a href="#l8.10"></a><span id="l8.10"> #include &quot;nsDBFolderInfo.h&quot;</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-const char *kPendingHdrsScope = &quot;ns:msg:db:row:scope:pending:all&quot;;	// scope for all offine ops table</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+const char *kPendingHdrsScope = &quot;ns:msg:db:row:scope:pending:all&quot;;  // scope for all offine ops table</span>
<a href="#l8.14"></a><span id="l8.14"> const char *kPendingHdrsTableKind = &quot;ns:msg:db:table:kind:pending&quot;;</span>
<a href="#l8.15"></a><span id="l8.15"> struct mdbOid gAllPendingHdrsTableOID;</span>
<a href="#l8.16"></a><span id="l8.16"> </span>
<a href="#l8.17"></a><span id="l8.17"> nsImapMailDatabase::nsImapMailDatabase()</span>
<a href="#l8.18"></a><span id="l8.18"> {</span>
<a href="#l8.19"></a><span id="l8.19">   m_mdbAllPendingHdrsTable = nullptr;</span>
<a href="#l8.20"></a><span id="l8.20"> }</span>
<a href="#l8.21"></a><span id="l8.21"> </span>
<a href="#l8.22"></a><span id="l8.22"> nsImapMailDatabase::~nsImapMailDatabase()</span>
<a href="#l8.23"></a><span id="l8.23"> {</span>
<a href="#l8.24"></a><span id="l8.24"> }</span>
<a href="#l8.25"></a><span id="l8.25"> </span>
<a href="#l8.26"></a><span id="l8.26" class="difflineminus">-NS_IMETHODIMP	nsImapMailDatabase::GetSummaryValid(bool *aResult)</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineplus">+NS_IMETHODIMP nsImapMailDatabase::GetSummaryValid(bool *aResult)</span>
<a href="#l8.28"></a><span id="l8.28"> {</span>
<a href="#l8.29"></a><span id="l8.29">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l8.30"></a><span id="l8.30">   if (m_dbFolderInfo)</span>
<a href="#l8.31"></a><span id="l8.31">   {</span>
<a href="#l8.32"></a><span id="l8.32">     uint32_t version;</span>
<a href="#l8.33"></a><span id="l8.33">     m_dbFolderInfo-&gt;GetVersion(&amp;version);</span>
<a href="#l8.34"></a><span id="l8.34">     *aResult = (GetCurVersion() == version);</span>
<a href="#l8.35"></a><span id="l8.35">   }</span>
<a href="#l8.36"></a><span id="l8.36">   else</span>
<a href="#l8.37"></a><span id="l8.37">       *aResult = false;</span>
<a href="#l8.38"></a><span id="l8.38"> </span>
<a href="#l8.39"></a><span id="l8.39">   return NS_OK;</span>
<a href="#l8.40"></a><span id="l8.40"> }</span>
<a href="#l8.41"></a><span id="l8.41"> </span>
<a href="#l8.42"></a><span id="l8.42" class="difflineminus">-NS_IMETHODIMP	nsImapMailDatabase::SetSummaryValid(bool valid)</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineplus">+NS_IMETHODIMP nsImapMailDatabase::SetSummaryValid(bool valid)</span>
<a href="#l8.44"></a><span id="l8.44"> {</span>
<a href="#l8.45"></a><span id="l8.45">   if (m_dbFolderInfo)</span>
<a href="#l8.46"></a><span id="l8.46">   {</span>
<a href="#l8.47"></a><span id="l8.47">     m_dbFolderInfo-&gt;SetVersion(valid ? GetCurVersion() : 0);</span>
<a href="#l8.48"></a><span id="l8.48">     Commit(nsMsgDBCommitType::kLargeCommit);</span>
<a href="#l8.49"></a><span id="l8.49">   }</span>
<a href="#l8.50"></a><span id="l8.50">   return NS_OK;</span>
<a href="#l8.51"></a><span id="l8.51"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsMailDatabase.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsMailDatabase.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -145,18 +145,18 @@ NS_IMETHODIMP  nsMailDatabase::RemoveOff</span>
<a href="#l9.4"></a><span id="l9.4">   nsIMdbRow* row = offlineOp-&gt;GetMDBRow();</span>
<a href="#l9.5"></a><span id="l9.5">   rv = m_mdbAllOfflineOpsTable-&gt;CutRow(GetEnv(), row);</span>
<a href="#l9.6"></a><span id="l9.6">   row-&gt;CutAllColumns(GetEnv());</span>
<a href="#l9.7"></a><span id="l9.7">   return rv;</span>
<a href="#l9.8"></a><span id="l9.8"> }</span>
<a href="#l9.9"></a><span id="l9.9"> </span>
<a href="#l9.10"></a><span id="l9.10"> NS_IMETHODIMP nsMailDatabase::GetOfflineOpForKey(nsMsgKey msgKey, bool create, nsIMsgOfflineImapOperation **offlineOp)</span>
<a href="#l9.11"></a><span id="l9.11"> {</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-  mdb_bool	hasOid;</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-  mdbOid		rowObjectId;</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+  mdb_bool hasOid;</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+  mdbOid rowObjectId;</span>
<a href="#l9.16"></a><span id="l9.16">   nsresult err;</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18">   nsresult rv = GetAllOfflineOpsTable();</span>
<a href="#l9.19"></a><span id="l9.19">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.20"></a><span id="l9.20"> </span>
<a href="#l9.21"></a><span id="l9.21">   if (!offlineOp || !m_mdbAllOfflineOpsTable)</span>
<a href="#l9.22"></a><span id="l9.22">     return NS_ERROR_NULL_POINTER;</span>
<a href="#l9.23"></a><span id="l9.23"> </span>
<a href="#l9.24"></a><span id="l9.24" class="difflineat">@@ -220,17 +220,17 @@ NS_IMETHODIMP nsMailDatabase::ListAllOff</span>
<a href="#l9.25"></a><span id="l9.25">   nsIMdbTableRowCursor *rowCursor;</span>
<a href="#l9.26"></a><span id="l9.26"> </span>
<a href="#l9.27"></a><span id="l9.27">   if (m_mdbAllOfflineOpsTable)</span>
<a href="#l9.28"></a><span id="l9.28">   {</span>
<a href="#l9.29"></a><span id="l9.29">     nsresult err = m_mdbAllOfflineOpsTable-&gt;GetTableRowCursor(GetEnv(), -1, &amp;rowCursor);</span>
<a href="#l9.30"></a><span id="l9.30">     while (NS_SUCCEEDED(err) &amp;&amp; rowCursor)</span>
<a href="#l9.31"></a><span id="l9.31">     {</span>
<a href="#l9.32"></a><span id="l9.32">       mdbOid outOid;</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineminus">-      mdb_pos	outPos;</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineplus">+      mdb_pos outPos;</span>
<a href="#l9.35"></a><span id="l9.35"> </span>
<a href="#l9.36"></a><span id="l9.36">       err = rowCursor-&gt;NextRowOid(GetEnv(), &amp;outOid, &amp;outPos);</span>
<a href="#l9.37"></a><span id="l9.37">       // is this right? Mork is returning a 0 id, but that should valid.</span>
<a href="#l9.38"></a><span id="l9.38">       if (outPos &lt; 0 || outOid.mOid_Id == (mdb_id) -1)</span>
<a href="#l9.39"></a><span id="l9.39">         break;</span>
<a href="#l9.40"></a><span id="l9.40">       if (NS_SUCCEEDED(err))</span>
<a href="#l9.41"></a><span id="l9.41">       {</span>
<a href="#l9.42"></a><span id="l9.42">         offlineOpIds-&gt;AppendElement(outOid.mOid_Id);</span>
<a href="#l9.43"></a><span id="l9.43" class="difflineat">@@ -314,23 +314,23 @@ public:</span>
<a href="#l9.44"></a><span id="l9.44"> </span>
<a href="#l9.45"></a><span id="l9.45">   // nsISimpleEnumerator methods:</span>
<a href="#l9.46"></a><span id="l9.46">   NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l9.47"></a><span id="l9.47"> </span>
<a href="#l9.48"></a><span id="l9.48">   nsMsgOfflineOpEnumerator(nsMailDatabase* db);</span>
<a href="#l9.49"></a><span id="l9.49"> </span>
<a href="#l9.50"></a><span id="l9.50"> protected:</span>
<a href="#l9.51"></a><span id="l9.51">   virtual ~nsMsgOfflineOpEnumerator();</span>
<a href="#l9.52"></a><span id="l9.52" class="difflineminus">-  nsresult					GetRowCursor();</span>
<a href="#l9.53"></a><span id="l9.53" class="difflineminus">-  nsresult					PrefetchNext();</span>
<a href="#l9.54"></a><span id="l9.54" class="difflineminus">-  nsMailDatabase*              mDB;</span>
<a href="#l9.55"></a><span id="l9.55" class="difflineminus">-  nsIMdbTableRowCursor*       mRowCursor;</span>
<a href="#l9.56"></a><span id="l9.56" class="difflineplus">+  nsresult GetRowCursor();</span>
<a href="#l9.57"></a><span id="l9.57" class="difflineplus">+  nsresult PrefetchNext();</span>
<a href="#l9.58"></a><span id="l9.58" class="difflineplus">+  nsMailDatabase* mDB;</span>
<a href="#l9.59"></a><span id="l9.59" class="difflineplus">+  nsIMdbTableRowCursor* mRowCursor;</span>
<a href="#l9.60"></a><span id="l9.60">   nsCOMPtr &lt;nsIMsgOfflineImapOperation&gt; mResultOp;</span>
<a href="#l9.61"></a><span id="l9.61" class="difflineminus">-  bool              mDone;</span>
<a href="#l9.62"></a><span id="l9.62" class="difflineminus">-  bool						mNextPrefetched;</span>
<a href="#l9.63"></a><span id="l9.63" class="difflineplus">+  bool  mDone;</span>
<a href="#l9.64"></a><span id="l9.64" class="difflineplus">+  bool mNextPrefetched;</span>
<a href="#l9.65"></a><span id="l9.65"> };</span>
<a href="#l9.66"></a><span id="l9.66"> </span>
<a href="#l9.67"></a><span id="l9.67"> nsMsgOfflineOpEnumerator::nsMsgOfflineOpEnumerator(nsMailDatabase* db)</span>
<a href="#l9.68"></a><span id="l9.68">     : mDB(db), mRowCursor(nullptr), mDone(false)</span>
<a href="#l9.69"></a><span id="l9.69"> {</span>
<a href="#l9.70"></a><span id="l9.70">   NS_ADDREF(mDB);</span>
<a href="#l9.71"></a><span id="l9.71">   mNextPrefetched = false;</span>
<a href="#l9.72"></a><span id="l9.72"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsMsgDatabase.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsMsgDatabase.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -4353,18 +4353,18 @@ nsIMsgThread *nsMsgDatabase::GetThreadFo</span>
<a href="#l10.4"></a><span id="l10.4">     if (pMsgHdr)</span>
<a href="#l10.5"></a><span id="l10.5">       *pMsgHdr = msgHdr;</span>
<a href="#l10.6"></a><span id="l10.6">     else</span>
<a href="#l10.7"></a><span id="l10.7">       msgHdr-&gt;Release();</span>
<a href="#l10.8"></a><span id="l10.8">   }</span>
<a href="#l10.9"></a><span id="l10.9">   // Referenced message not found, check if there are messages that reference same message</span>
<a href="#l10.10"></a><span id="l10.10">   else if (UseCorrectThreading())</span>
<a href="#l10.11"></a><span id="l10.11">   {</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-	if (NS_SUCCEEDED(GetRefFromHash(msgID, &amp;threadId)))</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-	  thread = GetThreadForThreadId(threadId);</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+    if (NS_SUCCEEDED(GetRefFromHash(msgID, &amp;threadId)))</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+      thread = GetThreadForThreadId(threadId);</span>
<a href="#l10.16"></a><span id="l10.16">   }</span>
<a href="#l10.17"></a><span id="l10.17"> </span>
<a href="#l10.18"></a><span id="l10.18">   return thread;</span>
<a href="#l10.19"></a><span id="l10.19"> }</span>
<a href="#l10.20"></a><span id="l10.20"> </span>
<a href="#l10.21"></a><span id="l10.21"> nsIMsgThread *  nsMsgDatabase::GetThreadForSubject(nsCString &amp;subject)</span>
<a href="#l10.22"></a><span id="l10.22"> {</span>
<a href="#l10.23"></a><span id="l10.23">   nsIMsgThread *thread = nullptr;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsMsgHdr.cpp</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsMsgHdr.cpp</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -369,22 +369,22 @@ NS_IMETHODIMP nsMsgHdr::SetMessageId(con</span>
<a href="#l11.4"></a><span id="l11.4">       tempMessageID.SetLength(tempMessageID.Length() - 1);</span>
<a href="#l11.5"></a><span id="l11.5">     return SetStringColumn(tempMessageID.get(), m_mdb-&gt;m_messageIdColumnToken);</span>
<a href="#l11.6"></a><span id="l11.6">   }</span>
<a href="#l11.7"></a><span id="l11.7">   return SetStringColumn(messageId, m_mdb-&gt;m_messageIdColumnToken);</span>
<a href="#l11.8"></a><span id="l11.8"> }</span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10"> NS_IMETHODIMP nsMsgHdr::SetSubject(const char *subject)</span>
<a href="#l11.11"></a><span id="l11.11"> {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-	return SetStringColumn(subject, m_mdb-&gt;m_subjectColumnToken);</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+  return SetStringColumn(subject, m_mdb-&gt;m_subjectColumnToken);</span>
<a href="#l11.14"></a><span id="l11.14"> }</span>
<a href="#l11.15"></a><span id="l11.15"> </span>
<a href="#l11.16"></a><span id="l11.16"> NS_IMETHODIMP nsMsgHdr::SetAuthor(const char *author)</span>
<a href="#l11.17"></a><span id="l11.17"> {</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineminus">-	return SetStringColumn(author, m_mdb-&gt;m_senderColumnToken);</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineplus">+  return SetStringColumn(author, m_mdb-&gt;m_senderColumnToken);</span>
<a href="#l11.20"></a><span id="l11.20"> }</span>
<a href="#l11.21"></a><span id="l11.21"> </span>
<a href="#l11.22"></a><span id="l11.22"> NS_IMETHODIMP nsMsgHdr::SetReferences(const char *references)</span>
<a href="#l11.23"></a><span id="l11.23"> {</span>
<a href="#l11.24"></a><span id="l11.24">   NS_ENSURE_ARG_POINTER(references);</span>
<a href="#l11.25"></a><span id="l11.25">   m_references.Clear();</span>
<a href="#l11.26"></a><span id="l11.26">   ParseReferences(references);</span>
<a href="#l11.27"></a><span id="l11.27"> </span>
<a href="#l11.28"></a><span id="l11.28" class="difflineat">@@ -396,17 +396,17 @@ NS_IMETHODIMP nsMsgHdr::SetReferences(co</span>
<a href="#l11.29"></a><span id="l11.29"> NS_IMETHODIMP nsMsgHdr::SetRecipients(const char *recipients)</span>
<a href="#l11.30"></a><span id="l11.30"> {</span>
<a href="#l11.31"></a><span id="l11.31">   // need to put in rfc822 address parsing code here (or make caller do it...)</span>
<a href="#l11.32"></a><span id="l11.32">   return SetStringColumn(recipients, m_mdb-&gt;m_recipientsColumnToken);</span>
<a href="#l11.33"></a><span id="l11.33"> }</span>
<a href="#l11.34"></a><span id="l11.34"> </span>
<a href="#l11.35"></a><span id="l11.35"> NS_IMETHODIMP nsMsgHdr::SetCcList(const char *ccList)</span>
<a href="#l11.36"></a><span id="l11.36"> {</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineminus">-	return SetStringColumn(ccList, m_mdb-&gt;m_ccListColumnToken);</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineplus">+  return SetStringColumn(ccList, m_mdb-&gt;m_ccListColumnToken);</span>
<a href="#l11.39"></a><span id="l11.39"> }</span>
<a href="#l11.40"></a><span id="l11.40"> </span>
<a href="#l11.41"></a><span id="l11.41"> NS_IMETHODIMP nsMsgHdr::SetBccList(const char *bccList)</span>
<a href="#l11.42"></a><span id="l11.42"> {</span>
<a href="#l11.43"></a><span id="l11.43">   return SetStringColumn(bccList, m_mdb-&gt;m_bccListColumnToken);</span>
<a href="#l11.44"></a><span id="l11.44"> }</span>
<a href="#l11.45"></a><span id="l11.45"> </span>
<a href="#l11.46"></a><span id="l11.46"> NS_IMETHODIMP nsMsgHdr::SetMessageSize(uint32_t messageSize)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsMsgThread.cpp</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsMsgThread.cpp</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -689,18 +689,18 @@ nsMsgThreadEnumerator::nsMsgThreadEnumer</span>
<a href="#l12.4"></a><span id="l12.4"> nsMsgThreadEnumerator::~nsMsgThreadEnumerator()</span>
<a href="#l12.5"></a><span id="l12.5"> {</span>
<a href="#l12.6"></a><span id="l12.6"> }</span>
<a href="#l12.7"></a><span id="l12.7"> </span>
<a href="#l12.8"></a><span id="l12.8"> NS_IMPL_ISUPPORTS(nsMsgThreadEnumerator, nsISimpleEnumerator)</span>
<a href="#l12.9"></a><span id="l12.9"> </span>
<a href="#l12.10"></a><span id="l12.10"> int32_t nsMsgThreadEnumerator::MsgKeyFirstChildIndex(nsMsgKey inMsgKey)</span>
<a href="#l12.11"></a><span id="l12.11"> {</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  //	if (msgKey != mThreadParentKey)</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-  //		mDone = true;</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+  // if (msgKey != mThreadParentKey)</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+  //   mDone = true;</span>
<a href="#l12.16"></a><span id="l12.16">   // look through rest of thread looking for a child of this message.</span>
<a href="#l12.17"></a><span id="l12.17">   // If the inMsgKey is the first message in the thread, then all children</span>
<a href="#l12.18"></a><span id="l12.18">   // without parents are considered to be children of inMsgKey.</span>
<a href="#l12.19"></a><span id="l12.19">   // Otherwise, only true children qualify.</span>
<a href="#l12.20"></a><span id="l12.20"> </span>
<a href="#l12.21"></a><span id="l12.21">   int32_t firstChildIndex = -1;</span>
<a href="#l12.22"></a><span id="l12.22">   uint32_t numChildren = 0;</span>
<a href="#l12.23"></a><span id="l12.23">   mThread-&gt;GetNumChildren(&amp;numChildren);</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineat">@@ -806,19 +806,19 @@ nsresult nsMsgThreadEnumerator::Prefetch</span>
<a href="#l12.25"></a><span id="l12.25">     mDone = true;</span>
<a href="#l12.26"></a><span id="l12.26">     return rv;</span>
<a href="#l12.27"></a><span id="l12.27">   }</span>
<a href="#l12.28"></a><span id="l12.28">   else</span>
<a href="#l12.29"></a><span id="l12.29">     mNeedToPrefetch = false;</span>
<a href="#l12.30"></a><span id="l12.30">   mFoundChildren = true;</span>
<a href="#l12.31"></a><span id="l12.31"> </span>
<a href="#l12.32"></a><span id="l12.32"> #ifdef DEBUG_bienvenu1</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineminus">-	nsMsgKey debugMsgKey;</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineminus">-	mResultHdr-&gt;GetMessageKey(&amp;debugMsgKey);</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineminus">-	printf(&quot;next for %ld = %ld\n&quot;, mThreadParentKey, debugMsgKey);</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineplus">+  nsMsgKey debugMsgKey;</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineplus">+  mResultHdr-&gt;GetMessageKey(&amp;debugMsgKey);</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineplus">+  printf(&quot;next for %ld = %ld\n&quot;, mThreadParentKey, debugMsgKey);</span>
<a href="#l12.39"></a><span id="l12.39"> #endif</span>
<a href="#l12.40"></a><span id="l12.40"> </span>
<a href="#l12.41"></a><span id="l12.41">   return rv;</span>
<a href="#l12.42"></a><span id="l12.42"> }</span>
<a href="#l12.43"></a><span id="l12.43"> </span>
<a href="#l12.44"></a><span id="l12.44"> NS_IMETHODIMP nsMsgThreadEnumerator::HasMoreElements(bool *aResult)</span>
<a href="#l12.45"></a><span id="l12.45"> {</span>
<a href="#l12.46"></a><span id="l12.46">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineat">@@ -950,17 +950,17 @@ nsresult nsMsgThread::ChangeChildCount(i</span>
<a href="#l12.48"></a><span id="l12.48"> </span>
<a href="#l12.49"></a><span id="l12.49">   uint32_t childCount = 0;</span>
<a href="#l12.50"></a><span id="l12.50">   m_mdbDB-&gt;RowCellColumnToUInt32(m_metaRow, m_mdbDB-&gt;m_threadChildrenColumnToken, childCount);</span>
<a href="#l12.51"></a><span id="l12.51"> </span>
<a href="#l12.52"></a><span id="l12.52">   NS_WARNING_ASSERTION(childCount != 0 || delta &gt; 0, &quot;child count gone negative&quot;);</span>
<a href="#l12.53"></a><span id="l12.53">   childCount += delta;</span>
<a href="#l12.54"></a><span id="l12.54"> </span>
<a href="#l12.55"></a><span id="l12.55">   NS_WARNING_ASSERTION((int32_t) childCount &gt;= 0, &quot;child count gone to 0 or below&quot;);</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineminus">-  if ((int32_t) childCount &lt; 0)	// force child count to &gt;= 0</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+  if ((int32_t) childCount &lt; 0)  // force child count to &gt;= 0</span>
<a href="#l12.58"></a><span id="l12.58">     childCount = 0;</span>
<a href="#l12.59"></a><span id="l12.59"> </span>
<a href="#l12.60"></a><span id="l12.60">   rv = m_mdbDB-&gt;UInt32ToRowCellColumn(m_metaRow, m_mdbDB-&gt;m_threadChildrenColumnToken, childCount);</span>
<a href="#l12.61"></a><span id="l12.61">   m_numChildren = childCount;</span>
<a href="#l12.62"></a><span id="l12.62">   return rv;</span>
<a href="#l12.63"></a><span id="l12.63"> }</span>
<a href="#l12.64"></a><span id="l12.64"> </span>
<a href="#l12.65"></a><span id="l12.65"> nsresult nsMsgThread::ChangeUnreadChildCount(int32_t delta)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsNewsDatabase.cpp</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsNewsDatabase.cpp</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -134,17 +134,17 @@ NS_IMETHODIMP nsNewsDatabase::GetLowWate</span>
<a href="#l13.4"></a><span id="l13.4"> </span>
<a href="#l13.5"></a><span id="l13.5">   return pHeader-&gt;GetMessageKey(key);</span>
<a href="#l13.6"></a><span id="l13.6"> }</span>
<a href="#l13.7"></a><span id="l13.7"> </span>
<a href="#l13.8"></a><span id="l13.8"> nsresult  nsNewsDatabase::ExpireUpTo(nsMsgKey expireKey)</span>
<a href="#l13.9"></a><span id="l13.9"> {</span>
<a href="#l13.10"></a><span id="l13.10">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l13.11"></a><span id="l13.11"> }</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-nsresult		nsNewsDatabase::ExpireRange(nsMsgKey startRange, nsMsgKey endRange)</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+nsresult nsNewsDatabase::ExpireRange(nsMsgKey startRange, nsMsgKey endRange)</span>
<a href="#l13.14"></a><span id="l13.14"> {</span>
<a href="#l13.15"></a><span id="l13.15">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l13.16"></a><span id="l13.16"> }</span>
<a href="#l13.17"></a><span id="l13.17"> </span>
<a href="#l13.18"></a><span id="l13.18"> </span>
<a href="#l13.19"></a><span id="l13.19"> NS_IMETHODIMP nsNewsDatabase::GetReadSet(nsMsgKeySet **pSet)</span>
<a href="#l13.20"></a><span id="l13.20"> {</span>
<a href="#l13.21"></a><span id="l13.21">     if (!pSet) return NS_ERROR_NULL_POINTER;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

