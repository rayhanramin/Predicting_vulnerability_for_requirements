<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 27716:284f2743822fb496e79f927afcfa23dc4ee7c5cb</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 284f2743822fb496e79f927afcfa23dc4ee7c5cb" />
<meta property="og:url" content="/comm-central/rev/284f2743822fb496e79f927afcfa23dc4ee7c5cb" />
<meta property="og:description" content="Bug 1582056 part 3 - Convert all remaining Mozmill helper modules to JSMs; r=mkmelin DONTBUILD" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 284f2743822fb496e79f927afcfa23dc4ee7c5cb 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/284f2743822fb496e79f927afcfa23dc4ee7c5cb">shortlog</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/284f2743822fb496e79f927afcfa23dc4ee7c5cb">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb">files</a> |
changeset |
<a href="/comm-central/raw-rev/284f2743822fb496e79f927afcfa23dc4ee7c5cb">raw</a>  | <a href="/comm-central/archive/284f2743822fb496e79f927afcfa23dc4ee7c5cb.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1582056">Bug 1582056</a> part 3 - Convert all remaining Mozmill helper modules to JSMs; r=mkmelin DONTBUILD
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#71;&#101;&#111;&#102;&#102;&#32;&#76;&#97;&#110;&#107;&#111;&#119;&#32;&#60;&#103;&#101;&#111;&#102;&#102;&#64;&#100;&#97;&#114;&#107;&#116;&#114;&#111;&#106;&#97;&#110;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Wed, 25 Sep 2019 21:00:53 +1200</td></tr>

<tr>
 <td>changeset 27716</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/284f2743822fb496e79f927afcfa23dc4ee7c5cb">284f2743822fb496e79f927afcfa23dc4ee7c5cb</a></td>
</tr>



<tr>
<td>parent 27715</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/19ae7a021b57cc3d81b5f95a8aa3f911c4301348">19ae7a021b57cc3d81b5f95a8aa3f911c4301348</a>
</td>
</tr>

<tr>
<td>child 27717</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/7eda6c6992b84826ff26188e3a7f0341404402f4">7eda6c6992b84826ff26188e3a7f0341404402f4</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=284f2743822fb496e79f927afcfa23dc4ee7c5cb">16458</a></td></tr>
<tr><td>push user</td><td>geoff@darktrojan.net</td></tr>
<tr><td>push date</td><td class="date age">Wed, 25 Sep 2019 09:03:47 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@284f2743822f [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=284f2743822fb496e79f927afcfa23dc4ee7c5cb">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=284f2743822fb496e79f927afcfa23dc4ee7c5cb&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=284f2743822fb496e79f927afcfa23dc4ee7c5cb&newProject=comm-central&newRevision=0ee0e21ccb1b19e9b54f2d50c1e1895a2d711187&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=284f2743822fb496e79f927afcfa23dc4ee7c5cb&newProject=comm-central&newRevision=0ee0e21ccb1b19e9b54f2d50c1e1895a2d711187&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=284f2743822fb496e79f927afcfa23dc4ee7c5cb&newProject=comm-central&newRevision=0ee0e21ccb1b19e9b54f2d50c1e1895a2d711187&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1582056">1582056</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1582056">Bug 1582056</a> part 3 - Convert all remaining Mozmill helper modules to JSMs; r=mkmelin DONTBUILD</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testAnnualRecurrence.js">calendar/test/mozmill/cal-recurrence/testAnnualRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testAnnualRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testAnnualRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testAnnualRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testAnnualRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testAnnualRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testBiweeklyRecurrence.js">calendar/test/mozmill/cal-recurrence/testBiweeklyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testBiweeklyRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testBiweeklyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testBiweeklyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testBiweeklyRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testBiweeklyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testDailyRecurrence.js">calendar/test/mozmill/cal-recurrence/testDailyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testDailyRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testDailyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testDailyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testDailyRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testDailyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testLastDayOfMonthRecurrence.js">calendar/test/mozmill/cal-recurrence/testLastDayOfMonthRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testLastDayOfMonthRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testLastDayOfMonthRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testLastDayOfMonthRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testLastDayOfMonthRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testLastDayOfMonthRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyNRecurrence.js">calendar/test/mozmill/cal-recurrence/testWeeklyNRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyNRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyNRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyNRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyNRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyNRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyUntilRecurrence.js">calendar/test/mozmill/cal-recurrence/testWeeklyUntilRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyUntilRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyUntilRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyUntilRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyUntilRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyUntilRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyWithExceptionRecurrence.js">calendar/test/mozmill/cal-recurrence/testWeeklyWithExceptionRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyWithExceptionRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyWithExceptionRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyWithExceptionRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyWithExceptionRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/cal-recurrence/testWeeklyWithExceptionRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testAlarmDialog.js">calendar/test/mozmill/eventDialog/testAlarmDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testAlarmDialog.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testAlarmDialog.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testAlarmDialog.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testAlarmDialog.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testAlarmDialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialog.js">calendar/test/mozmill/eventDialog/testEventDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialog.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialog.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialog.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialog.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogSize.js">calendar/test/mozmill/eventDialog/testEventDialogSize.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogSize.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogSize.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogSize.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogSize.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testEventDialogSize.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testUTF8.js">calendar/test/mozmill/eventDialog/testUTF8.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testUTF8.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testUTF8.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testUTF8.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testUTF8.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/eventDialog/testUTF8.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/invitations/test-imip-bar-eml.js">calendar/test/mozmill/invitations/test-imip-bar-eml.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/invitations/test-imip-bar-eml.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/invitations/test-imip-bar-eml.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/invitations/test-imip-bar-eml.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/invitations/test-imip-bar-eml.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/invitations/test-imip-bar-eml.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testAlarmDefaultValue.js">calendar/test/mozmill/preferences/testAlarmDefaultValue.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testAlarmDefaultValue.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testAlarmDefaultValue.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testAlarmDefaultValue.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testAlarmDefaultValue.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testAlarmDefaultValue.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testCategoryColors.js">calendar/test/mozmill/preferences/testCategoryColors.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testCategoryColors.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testCategoryColors.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testCategoryColors.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testCategoryColors.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/preferences/testCategoryColors.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/CalendarUtils.jsm">calendar/test/mozmill/shared-modules/CalendarUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/CalendarUtils.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/CalendarUtils.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/CalendarUtils.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/CalendarUtils.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/CalendarUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/ItemEditingHelpers.jsm">calendar/test/mozmill/shared-modules/ItemEditingHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/ItemEditingHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/ItemEditingHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/ItemEditingHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/ItemEditingHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/ItemEditingHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/moz.build">calendar/test/mozmill/shared-modules/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/moz.build">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/moz.build">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/moz.build">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/moz.build">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/test-calendar-utils.js">calendar/test/mozmill/shared-modules/test-calendar-utils.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/test-calendar-utils.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/test-calendar-utils.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/test-calendar-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/test-item-editing-helpers.js">calendar/test/mozmill/shared-modules/test-item-editing-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/test-item-editing-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/test-item-editing-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/shared-modules/test-item-editing-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testBasicFunctionality.js">calendar/test/mozmill/testBasicFunctionality.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testBasicFunctionality.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testBasicFunctionality.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testBasicFunctionality.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testBasicFunctionality.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testBasicFunctionality.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testLocalICS.js">calendar/test/mozmill/testLocalICS.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testLocalICS.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testLocalICS.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testLocalICS.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testLocalICS.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testLocalICS.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTimezones.js">calendar/test/mozmill/testTimezones.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTimezones.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTimezones.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTimezones.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTimezones.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTimezones.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTodayPane.js">calendar/test/mozmill/testTodayPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTodayPane.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTodayPane.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTodayPane.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTodayPane.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/testTodayPane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testDayView.js">calendar/test/mozmill/views/testDayView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testDayView.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testDayView.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testDayView.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testDayView.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testDayView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMonthView.js">calendar/test/mozmill/views/testMonthView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMonthView.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMonthView.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMonthView.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMonthView.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMonthView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMultiweekView.js">calendar/test/mozmill/views/testMultiweekView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMultiweekView.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMultiweekView.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMultiweekView.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMultiweekView.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testMultiweekView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testTaskView.js">calendar/test/mozmill/views/testTaskView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testTaskView.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testTaskView.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testTaskView.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testTaskView.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testTaskView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testWeekView.js">calendar/test/mozmill/views/testWeekView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testWeekView.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testWeekView.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testWeekView.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testWeekView.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/calendar/test/mozmill/views/testWeekView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-ab-whitelist.js">mail/test/mozmill/account/test-ab-whitelist.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-ab-whitelist.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-ab-whitelist.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-ab-whitelist.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-ab-whitelist.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-ab-whitelist.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-actions.js">mail/test/mozmill/account/test-account-actions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-actions.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-actions.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-actions.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-actions.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-actions.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-deletion.js">mail/test/mozmill/account/test-account-deletion.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-deletion.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-deletion.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-deletion.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-deletion.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-deletion.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-port-setting.js">mail/test/mozmill/account/test-account-port-setting.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-port-setting.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-port-setting.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-port-setting.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-port-setting.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-port-setting.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-settings-infrastructure.js">mail/test/mozmill/account/test-account-settings-infrastructure.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-settings-infrastructure.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-settings-infrastructure.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-settings-infrastructure.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-settings-infrastructure.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-settings-infrastructure.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-tree.js">mail/test/mozmill/account/test-account-tree.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-tree.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-tree.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-tree.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-tree.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-tree.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-values.js">mail/test/mozmill/account/test-account-values.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-values.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-values.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-values.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-values.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-account-values.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-archive-options.js">mail/test/mozmill/account/test-archive-options.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-archive-options.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-archive-options.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-archive-options.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-archive-options.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-archive-options.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-mail-account-setup-wizard.js">mail/test/mozmill/account/test-mail-account-setup-wizard.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-mail-account-setup-wizard.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-mail-account-setup-wizard.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-mail-account-setup-wizard.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-mail-account-setup-wizard.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-mail-account-setup-wizard.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-retest-config.js">mail/test/mozmill/account/test-retest-config.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-retest-config.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-retest-config.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-retest-config.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-retest-config.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/account/test-retest-config.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book-panes.js">mail/test/mozmill/addrbook/test-address-book-panes.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book-panes.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book-panes.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book-panes.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book-panes.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book-panes.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book.js">mail/test/mozmill/addrbook/test-address-book.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-address-book.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-update-mailing-list.js">mail/test/mozmill/addrbook/test-update-mailing-list.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-update-mailing-list.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-update-mailing-list.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-update-mailing-list.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-update-mailing-list.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/addrbook/test-update-mailing-list.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-events.js">mail/test/mozmill/attachment/test-attachment-events.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-events.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-events.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-events.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-events.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-events.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-in-plain-msg.js">mail/test/mozmill/attachment/test-attachment-in-plain-msg.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-in-plain-msg.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-in-plain-msg.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-in-plain-msg.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-in-plain-msg.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-in-plain-msg.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-menus.js">mail/test/mozmill/attachment/test-attachment-menus.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-menus.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-menus.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-menus.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-menus.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-menus.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-size.js">mail/test/mozmill/attachment/test-attachment-size.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-size.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-size.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-size.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-size.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment-size.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment.js">mail/test/mozmill/attachment/test-attachment.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/attachment/test-attachment.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-item.js">mail/test/mozmill/cloudfile/test-cloudfile-attachment-item.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-item.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-item.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-item.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-item.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-item.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-urls.js">mail/test/mozmill/cloudfile/test-cloudfile-attachment-urls.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-urls.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-urls.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-urls.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-urls.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-attachment-urls.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-manager.js">mail/test/mozmill/cloudfile/test-cloudfile-manager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-manager.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-manager.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-manager.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-manager.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-manager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">mail/test/mozmill/cloudfile/test-cloudfile-notifications.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-address-widgets.js">mail/test/mozmill/composition/test-address-widgets.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-address-widgets.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-address-widgets.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-address-widgets.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-address-widgets.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-address-widgets.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment-reminder.js">mail/test/mozmill/composition/test-attachment-reminder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment-reminder.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment-reminder.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment-reminder.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment-reminder.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment-reminder.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment.js">mail/test/mozmill/composition/test-attachment.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-attachment.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-base64-display.js">mail/test/mozmill/composition/test-base64-display.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-base64-display.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-base64-display.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-base64-display.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-base64-display.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-base64-display.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-blocked-content.js">mail/test/mozmill/composition/test-blocked-content.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-blocked-content.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-blocked-content.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-blocked-content.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-blocked-content.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-blocked-content.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-edit.js">mail/test/mozmill/composition/test-charset-edit.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-edit.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-edit.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-edit.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-edit.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-edit.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-upgrade.js">mail/test/mozmill/composition/test-charset-upgrade.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-upgrade.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-upgrade.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-upgrade.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-upgrade.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-charset-upgrade.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-cp932-display.js">mail/test/mozmill/composition/test-cp932-display.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-cp932-display.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-cp932-display.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-cp932-display.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-cp932-display.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-cp932-display.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-draft-identity.js">mail/test/mozmill/composition/test-draft-identity.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-draft-identity.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-draft-identity.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-draft-identity.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-draft-identity.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-draft-identity.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-drafts.js">mail/test/mozmill/composition/test-drafts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-drafts.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-drafts.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-drafts.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-drafts.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-drafts.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-eml-actions.js">mail/test/mozmill/composition/test-eml-actions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-eml-actions.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-eml-actions.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-eml-actions.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-eml-actions.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-eml-actions.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-focus.js">mail/test/mozmill/composition/test-focus.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-focus.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-focus.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-focus.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-focus.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-focus.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-headers.js">mail/test/mozmill/composition/test-forward-headers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-headers.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-headers.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-headers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-headers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-headers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-rfc822-attach.js">mail/test/mozmill/composition/test-forward-rfc822-attach.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-rfc822-attach.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-rfc822-attach.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-rfc822-attach.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-rfc822-attach.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-rfc822-attach.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-utf8.js">mail/test/mozmill/composition/test-forward-utf8.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-utf8.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-utf8.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-utf8.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-utf8.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forward-utf8.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-content.js">mail/test/mozmill/composition/test-forwarded-content.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-content.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-content.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-content.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-content.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-content.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-eml-actions.js">mail/test/mozmill/composition/test-forwarded-eml-actions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-eml-actions.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-eml-actions.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-eml-actions.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-eml-actions.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-forwarded-eml-actions.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-display.js">mail/test/mozmill/composition/test-image-display.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-display.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-display.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-display.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-display.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-display.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-insertion-dialog.js">mail/test/mozmill/composition/test-image-insertion-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-insertion-dialog.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-insertion-dialog.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-insertion-dialog.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-insertion-dialog.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-image-insertion-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-multipart-related.js">mail/test/mozmill/composition/test-multipart-related.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-multipart-related.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-multipart-related.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-multipart-related.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-multipart-related.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-multipart-related.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-newmsg-compose-identity.js">mail/test/mozmill/composition/test-newmsg-compose-identity.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-newmsg-compose-identity.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-newmsg-compose-identity.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-newmsg-compose-identity.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-newmsg-compose-identity.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-newmsg-compose-identity.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-addresses.js">mail/test/mozmill/composition/test-reply-addresses.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-addresses.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-addresses.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-addresses.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-addresses.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-addresses.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-format-flowed.js">mail/test/mozmill/composition/test-reply-format-flowed.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-format-flowed.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-format-flowed.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-format-flowed.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-format-flowed.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-format-flowed.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-multipart-charset.js">mail/test/mozmill/composition/test-reply-multipart-charset.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-multipart-charset.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-multipart-charset.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-multipart-charset.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-multipart-charset.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-multipart-charset.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-signature.js">mail/test/mozmill/composition/test-reply-signature.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-signature.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-signature.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-signature.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-signature.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-reply-signature.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-save-changes-on-quit.js">mail/test/mozmill/composition/test-save-changes-on-quit.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-save-changes-on-quit.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-save-changes-on-quit.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-save-changes-on-quit.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-save-changes-on-quit.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-save-changes-on-quit.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-button.js">mail/test/mozmill/composition/test-send-button.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-button.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-button.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-button.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-button.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-button.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-format.js">mail/test/mozmill/composition/test-send-format.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-format.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-format.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-format.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-format.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-send-format.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-init.js">mail/test/mozmill/composition/test-signature-init.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-init.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-init.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-init.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-init.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-init.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-updating.js">mail/test/mozmill/composition/test-signature-updating.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-updating.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-updating.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-updating.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-updating.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/composition/test-signature-updating.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-compose-mailto.js">mail/test/mozmill/content-policy/test-compose-mailto.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-compose-mailto.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-compose-mailto.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-compose-mailto.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-compose-mailto.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-compose-mailto.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-dns-prefetch.js">mail/test/mozmill/content-policy/test-dns-prefetch.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-dns-prefetch.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-dns-prefetch.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-dns-prefetch.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-dns-prefetch.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-dns-prefetch.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-exposed-in-content-tabs.js">mail/test/mozmill/content-policy/test-exposed-in-content-tabs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-exposed-in-content-tabs.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-exposed-in-content-tabs.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-exposed-in-content-tabs.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-exposed-in-content-tabs.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-exposed-in-content-tabs.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-general-content-policy.js">mail/test/mozmill/content-policy/test-general-content-policy.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-general-content-policy.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-general-content-policy.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-general-content-policy.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-general-content-policy.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-general-content-policy.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-js-content-policy.js">mail/test/mozmill/content-policy/test-js-content-policy.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-js-content-policy.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-js-content-policy.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-js-content-policy.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-js-content-policy.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-js-content-policy.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-plugins-policy.js">mail/test/mozmill/content-policy/test-plugins-policy.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-plugins-policy.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-plugins-policy.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-plugins-policy.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-plugins-policy.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-plugins-policy.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-view-source.js">mail/test/mozmill/content-policy/test-view-source.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-view-source.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-view-source.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-view-source.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-view-source.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-policy/test-view-source.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-about-support.js">mail/test/mozmill/content-tabs/test-about-support.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-about-support.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-about-support.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-about-support.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-about-support.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-about-support.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-addons-mgr.js">mail/test/mozmill/content-tabs/test-addons-mgr.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-addons-mgr.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-addons-mgr.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-addons-mgr.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-addons-mgr.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-addons-mgr.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-content-tab.js">mail/test/mozmill/content-tabs/test-content-tab.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-content-tab.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-content-tab.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-content-tab.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-content-tab.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-content-tab.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-install-xpi.js">mail/test/mozmill/content-tabs/test-install-xpi.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-install-xpi.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-install-xpi.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-install-xpi.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-install-xpi.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/content-tabs/test-install-xpi.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cookies/test-cookies.js">mail/test/mozmill/cookies/test-cookies.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cookies/test-cookies.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cookies/test-cookies.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cookies/test-cookies.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cookies/test-cookies.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/cookies/test-cookies.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/downloads/test-about-downloads.js">mail/test/mozmill/downloads/test-about-downloads.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/downloads/test-about-downloads.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/downloads/test-about-downloads.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/downloads/test-about-downloads.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/downloads/test-about-downloads.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/downloads/test-about-downloads.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-archive-messages.js">mail/test/mozmill/folder-display/test-archive-messages.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-archive-messages.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-archive-messages.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-archive-messages.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-archive-messages.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-archive-messages.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-close-window-on-delete.js">mail/test/mozmill/folder-display/test-close-window-on-delete.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-close-window-on-delete.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-close-window-on-delete.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-close-window-on-delete.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-close-window-on-delete.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-close-window-on-delete.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-columns.js">mail/test/mozmill/folder-display/test-columns.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-columns.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-columns.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-columns.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-columns.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-columns.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-from-virtual-folders.js">mail/test/mozmill/folder-display/test-deletion-from-virtual-folders.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-from-virtual-folders.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-from-virtual-folders.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-from-virtual-folders.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-from-virtual-folders.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-from-virtual-folders.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-with-multiple-displays.js">mail/test/mozmill/folder-display/test-deletion-with-multiple-displays.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-with-multiple-displays.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-with-multiple-displays.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-with-multiple-displays.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-with-multiple-displays.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-deletion-with-multiple-displays.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-display-name.js">mail/test/mozmill/folder-display/test-display-name.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-display-name.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-display-name.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-display-name.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-display-name.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-display-name.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-displaying-messages-in-folder-tabs.js">mail/test/mozmill/folder-display/test-displaying-messages-in-folder-tabs.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-displaying-messages-in-folder-tabs.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-displaying-messages-in-folder-tabs.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-displaying-messages-in-folder-tabs.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-pane-visibility.js">mail/test/mozmill/folder-display/test-folder-pane-visibility.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-pane-visibility.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-pane-visibility.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-pane-visibility.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-pane-visibility.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-pane-visibility.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-toolbar.js">mail/test/mozmill/folder-display/test-folder-toolbar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-toolbar.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-toolbar.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-toolbar.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-toolbar.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-folder-toolbar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-invalid-db-folder-load.js">mail/test/mozmill/folder-display/test-invalid-db-folder-load.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-invalid-db-folder-load.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-invalid-db-folder-load.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-invalid-db-folder-load.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-invalid-db-folder-load.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-invalid-db-folder-load.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-mail-views.js">mail/test/mozmill/folder-display/test-mail-views.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-mail-views.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-mail-views.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-mail-views.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-mail-views.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-mail-views.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands-on-msgstore.js">mail/test/mozmill/folder-display/test-message-commands-on-msgstore.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands-on-msgstore.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands-on-msgstore.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands-on-msgstore.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands-on-msgstore.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands-on-msgstore.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands.js">mail/test/mozmill/folder-display/test-message-commands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-commands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-pane-visibility.js">mail/test/mozmill/folder-display/test-message-pane-visibility.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-pane-visibility.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-pane-visibility.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-pane-visibility.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-pane-visibility.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-pane-visibility.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-reloads.js">mail/test/mozmill/folder-display/test-message-reloads.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-reloads.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-reloads.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-reloads.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-reloads.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-reloads.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-size.js">mail/test/mozmill/folder-display/test-message-size.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-size.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-size.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-size.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-size.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-size.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-window.js">mail/test/mozmill/folder-display/test-message-window.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-window.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-window.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-window.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-window.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-message-window.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages.js">mail/test/mozmill/folder-display/test-opening-messages.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-opening-messages.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-pane-focus.js">mail/test/mozmill/folder-display/test-pane-focus.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-pane-focus.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-pane-focus.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-pane-focus.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-pane-focus.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-pane-focus.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-recent-menu.js">mail/test/mozmill/folder-display/test-recent-menu.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-recent-menu.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-recent-menu.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-recent-menu.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-recent-menu.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-recent-menu.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-folders.js">mail/test/mozmill/folder-display/test-right-click-middle-click-folders.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-folders.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-folders.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-folders.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-folders.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-folders.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-messages.js">mail/test/mozmill/folder-display/test-right-click-middle-click-messages.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-messages.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-messages.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-messages.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-messages.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-right-click-middle-click-messages.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-savedsearch-reload-after-compact.js">mail/test/mozmill/folder-display/test-savedsearch-reload-after-compact.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-savedsearch-reload-after-compact.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-savedsearch-reload-after-compact.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-savedsearch-reload-after-compact.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-savedsearch-reload-after-compact.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-savedsearch-reload-after-compact.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-selection.js">mail/test/mozmill/folder-display/test-selection.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-selection.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-selection.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-selection.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-selection.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-selection.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-summarization.js">mail/test/mozmill/folder-display/test-summarization.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-summarization.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-summarization.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-summarization.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-summarization.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-summarization.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-tabs-simple.js">mail/test/mozmill/folder-display/test-tabs-simple.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-tabs-simple.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-tabs-simple.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-tabs-simple.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-tabs-simple.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-tabs-simple.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-virtual-folder-commands.js">mail/test/mozmill/folder-display/test-virtual-folder-commands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-virtual-folder-commands.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-virtual-folder-commands.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-virtual-folder-commands.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-virtual-folder-commands.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-virtual-folder-commands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-watch-ignore-thread.js">mail/test/mozmill/folder-display/test-watch-ignore-thread.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-watch-ignore-thread.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-watch-ignore-thread.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-watch-ignore-thread.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-watch-ignore-thread.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-display/test-watch-ignore-thread.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-display-message-with-folder-modes.js">mail/test/mozmill/folder-pane/test-display-message-with-folder-modes.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-display-message-with-folder-modes.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-display-message-with-folder-modes.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-display-message-with-folder-modes.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-display-message-with-folder-modes.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-display-message-with-folder-modes.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-names-in-recent-mode.js">mail/test/mozmill/folder-pane/test-folder-names-in-recent-mode.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-names-in-recent-mode.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-names-in-recent-mode.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-names-in-recent-mode.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-names-in-recent-mode.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-names-in-recent-mode.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane-consumers.js">mail/test/mozmill/folder-pane/test-folder-pane-consumers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane-consumers.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane-consumers.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane-consumers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane-consumers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane-consumers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane.js">mail/test/mozmill/folder-pane/test-folder-pane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-pane/test-folder-pane.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-folder-tree-mode.js">mail/test/mozmill/folder-tree-modes/test-custom-folder-tree-mode.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-folder-tree-mode.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-folder-tree-mode.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-folder-tree-mode.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-folder-tree-mode.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-folder-tree-mode.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-smart-folder.js">mail/test/mozmill/folder-tree-modes/test-custom-smart-folder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-smart-folder.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-smart-folder.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-smart-folder.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-smart-folder.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-custom-smart-folder.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-mode-switching.js">mail/test/mozmill/folder-tree-modes/test-mode-switching.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-mode-switching.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-mode-switching.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-mode-switching.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-mode-switching.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-mode-switching.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-smart-folders.js">mail/test/mozmill/folder-tree-modes/test-smart-folders.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-smart-folders.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-smart-folders.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-smart-folders.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-smart-folders.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-smart-folders.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-unread-folders.js">mail/test/mozmill/folder-tree-modes/test-unread-folders.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-unread-folders.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-unread-folders.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-unread-folders.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-unread-folders.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-tree-modes/test-unread-folders.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-widget/test-message-filters.js">mail/test/mozmill/folder-widget/test-message-filters.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-widget/test-message-filters.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-widget/test-message-filters.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-widget/test-message-filters.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-widget/test-message-filters.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/folder-widget/test-message-filters.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-chat-tab-restore.js">mail/test/mozmill/im/test-chat-tab-restore.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-chat-tab-restore.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-chat-tab-restore.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-chat-tab-restore.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-chat-tab-restore.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-chat-tab-restore.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-toolbar-buttons.js">mail/test/mozmill/im/test-toolbar-buttons.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-toolbar-buttons.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-toolbar-buttons.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-toolbar-buttons.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-toolbar-buttons.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/im/test-toolbar-buttons.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/instrumentation/test-instrument-setup.js">mail/test/mozmill/instrumentation/test-instrument-setup.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/instrumentation/test-instrument-setup.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/instrumentation/test-instrument-setup.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/instrumentation/test-instrument-setup.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/instrumentation/test-instrument-setup.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/instrumentation/test-instrument-setup.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/junk-commands/test-junk-commands.js">mail/test/mozmill/junk-commands/test-junk-commands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/junk-commands/test-junk-commands.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/junk-commands/test-junk-commands.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/junk-commands/test-junk-commands.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/junk-commands/test-junk-commands.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/junk-commands/test-junk-commands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/keyboard/test-spacehit.js">mail/test/mozmill/keyboard/test-spacehit.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/keyboard/test-spacehit.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/keyboard/test-spacehit.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/keyboard/test-spacehit.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/keyboard/test-spacehit.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/keyboard/test-spacehit.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-message-header.js">mail/test/mozmill/message-header/test-message-header.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-message-header.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-message-header.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-message-header.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-message-header.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-message-header.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-phishing-bar.js">mail/test/mozmill/message-header/test-phishing-bar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-phishing-bar.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-phishing-bar.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-phishing-bar.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-phishing-bar.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-phishing-bar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-identity.js">mail/test/mozmill/message-header/test-reply-identity.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-identity.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-identity.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-identity.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-identity.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-identity.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-to-list-from-address-selection.js">mail/test/mozmill/message-header/test-reply-to-list-from-address-selection.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-to-list-from-address-selection.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-to-list-from-address-selection.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-to-list-from-address-selection.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-to-list-from-address-selection.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-reply-to-list-from-address-selection.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-return-receipt.js">mail/test/mozmill/message-header/test-return-receipt.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-return-receipt.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-return-receipt.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-return-receipt.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-return-receipt.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-header/test-return-receipt.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-reader/test-bug594646.js">mail/test/mozmill/message-reader/test-bug594646.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-reader/test-bug594646.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-reader/test-bug594646.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-reader/test-bug594646.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-reader/test-bug594646.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-reader/test-bug594646.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-autohide-menubar.js">mail/test/mozmill/message-window/test-autohide-menubar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-autohide-menubar.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-autohide-menubar.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-autohide-menubar.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-autohide-menubar.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-autohide-menubar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-commands.js">mail/test/mozmill/message-window/test-commands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-commands.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-commands.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-commands.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-commands.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-commands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-eml-subject.js">mail/test/mozmill/message-window/test-eml-subject.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-eml-subject.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-eml-subject.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-eml-subject.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-eml-subject.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-eml-subject.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-message-sidebar.js">mail/test/mozmill/message-window/test-message-sidebar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-message-sidebar.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-message-sidebar.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-message-sidebar.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-message-sidebar.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-message-sidebar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-vcard-actions.js">mail/test/mozmill/message-window/test-vcard-actions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-vcard-actions.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-vcard-actions.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-vcard-actions.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-vcard-actions.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-vcard-actions.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-view-plaintext.js">mail/test/mozmill/message-window/test-view-plaintext.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-view-plaintext.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-view-plaintext.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-view-plaintext.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-view-plaintext.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/message-window/test-view-plaintext.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/multiple-identities/test-display-names.js">mail/test/mozmill/multiple-identities/test-display-names.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/multiple-identities/test-display-names.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/multiple-identities/test-display-names.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/multiple-identities/test-display-names.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/multiple-identities/test-display-names.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/multiple-identities/test-display-names.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/newmailaccount/test-newmailaccount.js">mail/test/mozmill/newmailaccount/test-newmailaccount.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/newmailaccount/test-newmailaccount.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/newmailaccount/test-newmailaccount.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/newmailaccount/test-newmailaccount.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/newmailaccount/test-newmailaccount.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/newmailaccount/test-newmailaccount.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/notification/test-notification.js">mail/test/mozmill/notification/test-notification.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/notification/test-notification.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/notification/test-notification.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/notification/test-notification.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/notification/test-notification.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/notification/test-notification.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/override-main-menu-collapse/test-override-mainmenu-collapse.js">mail/test/mozmill/override-main-menu-collapse/test-override-mainmenu-collapse.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/override-main-menu-collapse/test-override-mainmenu-collapse.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/override-main-menu-collapse/test-override-mainmenu-collapse.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/override-main-menu-collapse/test-override-mainmenu-collapse.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/override-main-menu-collapse/test-override-mainmenu-collapse.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/override-main-menu-collapse/test-override-mainmenu-collapse.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/pref-window/test-font-chooser.js">mail/test/mozmill/pref-window/test-font-chooser.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/pref-window/test-font-chooser.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/pref-window/test-font-chooser.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/pref-window/test-font-chooser.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/pref-window/test-font-chooser.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/pref-window/test-font-chooser.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-display-issues.js">mail/test/mozmill/quick-filter-bar/test-display-issues.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-display-issues.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-display-issues.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-display-issues.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-display-issues.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-display-issues.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-filter-logic.js">mail/test/mozmill/quick-filter-bar/test-filter-logic.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-filter-logic.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-filter-logic.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-filter-logic.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-filter-logic.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-filter-logic.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-keyboard-interface.js">mail/test/mozmill/quick-filter-bar/test-keyboard-interface.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-keyboard-interface.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-keyboard-interface.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-keyboard-interface.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-keyboard-interface.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-keyboard-interface.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-sticky-filter-logic.js">mail/test/mozmill/quick-filter-bar/test-sticky-filter-logic.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-sticky-filter-logic.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-sticky-filter-logic.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-sticky-filter-logic.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-sticky-filter-logic.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-sticky-filter-logic.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-toggle-bar.js">mail/test/mozmill/quick-filter-bar/test-toggle-bar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-toggle-bar.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-toggle-bar.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-toggle-bar.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-toggle-bar.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/quick-filter-bar/test-toggle-bar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/runtest.py">mail/test/mozmill/runtest.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/runtest.py">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/runtest.py">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/runtest.py">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/runtest.py">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/runtest.py">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-multiple-search-windows.js">mail/test/mozmill/search-window/test-multiple-search-windows.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-multiple-search-windows.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-multiple-search-windows.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-multiple-search-windows.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-multiple-search-windows.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-multiple-search-windows.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-right-click-to-open-search-window.js">mail/test/mozmill/search-window/test-right-click-to-open-search-window.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-right-click-to-open-search-window.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-right-click-to-open-search-window.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-right-click-to-open-search-window.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-right-click-to-open-search-window.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-right-click-to-open-search-window.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-search-window.js">mail/test/mozmill/search-window/test-search-window.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-search-window.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-search-window.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-search-window.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-search-window.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/search-window/test-search-window.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/session-store/test-session-store.js">mail/test/mozmill/session-store/test-session-store.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/session-store/test-session-store.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/session-store/test-session-store.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/session-store/test-session-store.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/session-store/test-session-store.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/session-store/test-session-store.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AddressBookHelpers.jsm">mail/test/mozmill/shared-modules/AddressBookHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AddressBookHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AddressBookHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AddressBookHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AddressBookHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/AddressBookHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CloudfileHelpers.jsm">mail/test/mozmill/shared-modules/CloudfileHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CloudfileHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CloudfileHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CloudfileHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CloudfileHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CloudfileHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ComposeHelpers.jsm">mail/test/mozmill/shared-modules/ComposeHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ComposeHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ComposeHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ComposeHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ComposeHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ComposeHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ContentTabHelpers.jsm">mail/test/mozmill/shared-modules/ContentTabHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ContentTabHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ContentTabHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ContentTabHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ContentTabHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/ContentTabHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CustomizationHelpers.jsm">mail/test/mozmill/shared-modules/CustomizationHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CustomizationHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CustomizationHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CustomizationHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CustomizationHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/CustomizationHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/DOMHelpers.jsm">mail/test/mozmill/shared-modules/DOMHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/DOMHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/DOMHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/DOMHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/DOMHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/DOMHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/FolderDisplayHelpers.jsm">mail/test/mozmill/shared-modules/FolderDisplayHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/FolderDisplayHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/FolderDisplayHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/FolderDisplayHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/FolderDisplayHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/FolderDisplayHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/JunkHelpers.jsm">mail/test/mozmill/shared-modules/JunkHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/JunkHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/JunkHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/JunkHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/JunkHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/JunkHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/MouseEventHelpers.jsm">mail/test/mozmill/shared-modules/MouseEventHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/MouseEventHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/MouseEventHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/MouseEventHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/MouseEventHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/MouseEventHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NNTPHelpers.jsm">mail/test/mozmill/shared-modules/NNTPHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NNTPHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NNTPHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NNTPHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NNTPHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NNTPHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/PrefTabHelpers.jsm">mail/test/mozmill/shared-modules/PrefTabHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/PrefTabHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/PrefTabHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/PrefTabHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/PrefTabHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/PrefTabHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SearchWindowHelpers.jsm">mail/test/mozmill/shared-modules/SearchWindowHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SearchWindowHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SearchWindowHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SearchWindowHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SearchWindowHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SearchWindowHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SubscribeWindowHelpers.jsm">mail/test/mozmill/shared-modules/SubscribeWindowHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SubscribeWindowHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SubscribeWindowHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SubscribeWindowHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SubscribeWindowHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/SubscribeWindowHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/WindowHelpers.jsm">mail/test/mozmill/shared-modules/WindowHelpers.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/WindowHelpers.jsm">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/WindowHelpers.jsm">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/WindowHelpers.jsm">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/WindowHelpers.jsm">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/WindowHelpers.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/moz.build">mail/test/mozmill/shared-modules/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/moz.build">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/moz.build">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/moz.build">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/moz.build">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-account-manager-helpers.js">mail/test/mozmill/shared-modules/test-account-manager-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-account-manager-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-account-manager-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-account-manager-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-address-book-helpers.js">mail/test/mozmill/shared-modules/test-address-book-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-address-book-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-address-book-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-address-book-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-cloudfile-backend-helpers.js">mail/test/mozmill/shared-modules/test-cloudfile-backend-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-cloudfile-backend-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-cloudfile-backend-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-cloudfile-backend-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-cloudfile-helpers.js">mail/test/mozmill/shared-modules/test-cloudfile-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-cloudfile-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-cloudfile-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-cloudfile-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-compose-helpers.js">mail/test/mozmill/shared-modules/test-compose-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-compose-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-compose-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-compose-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-content-tab-helpers.js">mail/test/mozmill/shared-modules/test-content-tab-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-content-tab-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-content-tab-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-content-tab-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-customization-helpers.js">mail/test/mozmill/shared-modules/test-customization-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-customization-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-customization-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-customization-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-dom-helpers.js">mail/test/mozmill/shared-modules/test-dom-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-dom-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-dom-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-dom-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">mail/test/mozmill/shared-modules/test-folder-display-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-junk-helpers.js">mail/test/mozmill/shared-modules/test-junk-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-junk-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-junk-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-junk-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js">mail/test/mozmill/shared-modules/test-mouse-event-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-newmailaccount-helpers.js">mail/test/mozmill/shared-modules/test-newmailaccount-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-newmailaccount-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-newmailaccount-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-newmailaccount-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-nntp-helpers.js">mail/test/mozmill/shared-modules/test-nntp-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-nntp-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-nntp-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-nntp-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-pref-window-helpers.js">mail/test/mozmill/shared-modules/test-pref-window-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-pref-window-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-pref-window-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-pref-window-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-quick-filter-bar-helpers.js">mail/test/mozmill/shared-modules/test-quick-filter-bar-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-quick-filter-bar-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-quick-filter-bar-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-quick-filter-bar-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-search-window-helpers.js">mail/test/mozmill/shared-modules/test-search-window-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-search-window-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-search-window-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-search-window-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-subscribe-window-helpers.js">mail/test/mozmill/shared-modules/test-subscribe-window-helpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-subscribe-window-helpers.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-subscribe-window-helpers.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/shared-modules/test-subscribe-window-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/smime/test-smime-multipart-alternative.js">mail/test/mozmill/smime/test-smime-multipart-alternative.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/smime/test-smime-multipart-alternative.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/smime/test-smime-multipart-alternative.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/smime/test-smime-multipart-alternative.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/smime/test-smime-multipart-alternative.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/smime/test-smime-multipart-alternative.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/startup-firstrun/test-menubar-collapsed.js">mail/test/mozmill/startup-firstrun/test-menubar-collapsed.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/startup-firstrun/test-menubar-collapsed.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/startup-firstrun/test-menubar-collapsed.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/startup-firstrun/test-menubar-collapsed.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/startup-firstrun/test-menubar-collapsed.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/startup-firstrun/test-menubar-collapsed.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/subscribe/test-subscribe-news-filter.js">mail/test/mozmill/subscribe/test-subscribe-news-filter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/subscribe/test-subscribe-news-filter.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/subscribe/test-subscribe-news-filter.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/subscribe/test-subscribe-news-filter.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/subscribe/test-subscribe-news-filter.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/subscribe/test-subscribe-news-filter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-closing.js">mail/test/mozmill/tabmail/test-tabmail-closing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-closing.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-closing.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-closing.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-closing.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-closing.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-customize.js">mail/test/mozmill/tabmail/test-tabmail-customize.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-customize.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-customize.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-customize.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-customize.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-customize.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">mail/test/mozmill/tabmail/test-tabmail-dragndrop.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-extensionSupport.js">mail/test/mozmill/utils/test-extensionSupport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-extensionSupport.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-extensionSupport.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-extensionSupport.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-extensionSupport.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-extensionSupport.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-iteratorUtils.js">mail/test/mozmill/utils/test-iteratorUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-iteratorUtils.js">file</a> |
<a href="/comm-central/annotate/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-iteratorUtils.js">annotate</a> |
<a href="/comm-central/diff/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-iteratorUtils.js">diff</a> |
<a href="/comm-central/comparison/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-iteratorUtils.js">comparison</a> |
<a href="/comm-central/log/284f2743822fb496e79f927afcfa23dc4ee7c5cb/mail/test/mozmill/utils/test-iteratorUtils.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/test/mozmill/cal-recurrence/testAnnualRecurrence.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/test/mozmill/cal-recurrence/testAnnualRecurrence.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l1.4"></a><span id="l1.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l1.5"></a><span id="l1.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l1.6"></a><span id="l1.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8" class="difflineminus">-var MODULE_NAME = &quot;testAnnualRecurrence&quot;;</span>
<a href="#l1.9"></a><span id="l1.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l1.10"></a><span id="l1.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;];</span>
<a href="#l1.11"></a><span id="l1.11" class="difflineminus">-</span>
<a href="#l1.12"></a><span id="l1.12"> var CALENDARNAME, EVENTPATH, CANVAS_BOX, ALLDAY;</span>
<a href="#l1.13"></a><span id="l1.13"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate, invokeEventDialog;</span>
<a href="#l1.14"></a><span id="l1.14"> var closeAllEventDialogs, deleteCalendars, createCalendar, menulistSelect;</span>
<a href="#l1.15"></a><span id="l1.15"> </span>
<a href="#l1.16"></a><span id="l1.16"> const STARTYEAR = 1950;</span>
<a href="#l1.17"></a><span id="l1.17"> const EPOCH = 1970;</span>
<a href="#l1.18"></a><span id="l1.18"> </span>
<a href="#l1.19"></a><span id="l1.19"> function setupModule(module) {</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineat">@@ -24,20 +20,20 @@ function setupModule(module) {</span>
<a href="#l1.21"></a><span id="l1.21">     handleOccurrencePrompt,</span>
<a href="#l1.22"></a><span id="l1.22">     switchToView,</span>
<a href="#l1.23"></a><span id="l1.23">     goToDate,</span>
<a href="#l1.24"></a><span id="l1.24">     invokeEventDialog,</span>
<a href="#l1.25"></a><span id="l1.25">     closeAllEventDialogs,</span>
<a href="#l1.26"></a><span id="l1.26">     deleteCalendars,</span>
<a href="#l1.27"></a><span id="l1.27">     createCalendar,</span>
<a href="#l1.28"></a><span id="l1.28">     menulistSelect,</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l1.30"></a><span id="l1.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l1.32"></a><span id="l1.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l1.33"></a><span id="l1.33"> </span>
<a href="#l1.34"></a><span id="l1.34" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l1.35"></a><span id="l1.35">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l1.36"></a><span id="l1.36"> }</span>
<a href="#l1.37"></a><span id="l1.37"> </span>
<a href="#l1.38"></a><span id="l1.38"> function testAnnualRecurrence() {</span>
<a href="#l1.39"></a><span id="l1.39">   goToDate(controller, STARTYEAR, 1, 1);</span>
<a href="#l1.40"></a><span id="l1.40"> </span>
<a href="#l1.41"></a><span id="l1.41">   // Create yearly recurring all-day event.</span>
<a href="#l1.42"></a><span id="l1.42">   let eventBox = lookupEventBox(&quot;day&quot;, ALLDAY, null, 1, null);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/test/mozmill/cal-recurrence/testBiweeklyRecurrence.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/test/mozmill/cal-recurrence/testBiweeklyRecurrence.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l2.4"></a><span id="l2.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l2.5"></a><span id="l2.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.6"></a><span id="l2.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8" class="difflineminus">-var MODULE_NAME = &quot;testBiweeklyRecurrence&quot;;</span>
<a href="#l2.9"></a><span id="l2.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l2.10"></a><span id="l2.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;];</span>
<a href="#l2.11"></a><span id="l2.11" class="difflineminus">-</span>
<a href="#l2.12"></a><span id="l2.12"> var CALENDARNAME, EVENTPATH, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l2.13"></a><span id="l2.13"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate, invokeEventDialog;</span>
<a href="#l2.14"></a><span id="l2.14"> var viewForward, closeAllEventDialogs, deleteCalendars, createCalendar, menulistSelect;</span>
<a href="#l2.15"></a><span id="l2.15"> </span>
<a href="#l2.16"></a><span id="l2.16"> const HOUR = 8;</span>
<a href="#l2.17"></a><span id="l2.17"> </span>
<a href="#l2.18"></a><span id="l2.18"> function setupModule(module) {</span>
<a href="#l2.19"></a><span id="l2.19">   controller = mozmill.getMail3PaneController();</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineat">@@ -24,20 +20,20 @@ function setupModule(module) {</span>
<a href="#l2.21"></a><span id="l2.21">     switchToView,</span>
<a href="#l2.22"></a><span id="l2.22">     goToDate,</span>
<a href="#l2.23"></a><span id="l2.23">     invokeEventDialog,</span>
<a href="#l2.24"></a><span id="l2.24">     viewForward,</span>
<a href="#l2.25"></a><span id="l2.25">     closeAllEventDialogs,</span>
<a href="#l2.26"></a><span id="l2.26">     deleteCalendars,</span>
<a href="#l2.27"></a><span id="l2.27">     createCalendar,</span>
<a href="#l2.28"></a><span id="l2.28">     menulistSelect,</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l2.32"></a><span id="l2.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l2.33"></a><span id="l2.33"> </span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l2.35"></a><span id="l2.35">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l2.36"></a><span id="l2.36"> }</span>
<a href="#l2.37"></a><span id="l2.37"> </span>
<a href="#l2.38"></a><span id="l2.38"> function testBiweeklyRecurrence() {</span>
<a href="#l2.39"></a><span id="l2.39">   goToDate(controller, 2009, 1, 31);</span>
<a href="#l2.40"></a><span id="l2.40"> </span>
<a href="#l2.41"></a><span id="l2.41">   // Create biweekly event.</span>
<a href="#l2.42"></a><span id="l2.42">   let eventBox = lookupEventBox(&quot;day&quot;, CANVAS_BOX, null, 1, HOUR);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/test/mozmill/cal-recurrence/testDailyRecurrence.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/test/mozmill/cal-recurrence/testDailyRecurrence.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l3.4"></a><span id="l3.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.5"></a><span id="l3.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.6"></a><span id="l3.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8" class="difflineminus">-var MODULE_NAME = &quot;testDailyRecurrence&quot;;</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineminus">-</span>
<a href="#l3.12"></a><span id="l3.12"> var CALENDARNAME, EVENTPATH, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l3.13"></a><span id="l3.13"> var helpersForController, handleOccurrencePrompt, invokeEventDialog, switchToView, goToDate;</span>
<a href="#l3.14"></a><span id="l3.14"> var viewForward, viewBack, closeAllEventDialogs, createCalendar, deleteCalendars, menulistSelect;</span>
<a href="#l3.15"></a><span id="l3.15"> var setData;</span>
<a href="#l3.16"></a><span id="l3.16"> </span>
<a href="#l3.17"></a><span id="l3.17"> const HOUR = 8;</span>
<a href="#l3.18"></a><span id="l3.18"> </span>
<a href="#l3.19"></a><span id="l3.19"> function setupModule(module) {</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineat">@@ -26,23 +22,22 @@ function setupModule(module) {</span>
<a href="#l3.21"></a><span id="l3.21">     goToDate,</span>
<a href="#l3.22"></a><span id="l3.22">     invokeEventDialog,</span>
<a href="#l3.23"></a><span id="l3.23">     viewForward,</span>
<a href="#l3.24"></a><span id="l3.24">     viewBack,</span>
<a href="#l3.25"></a><span id="l3.25">     closeAllEventDialogs,</span>
<a href="#l3.26"></a><span id="l3.26">     deleteCalendars,</span>
<a href="#l3.27"></a><span id="l3.27">     createCalendar,</span>
<a href="#l3.28"></a><span id="l3.28">     menulistSelect,</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l3.32"></a><span id="l3.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l3.33"></a><span id="l3.33"> </span>
<a href="#l3.34"></a><span id="l3.34" class="difflineminus">-  ({ setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineplus">+  ({ setData } = ChromeUtils.import(&quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;));</span>
<a href="#l3.37"></a><span id="l3.37"> </span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l3.39"></a><span id="l3.39">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l3.40"></a><span id="l3.40"> }</span>
<a href="#l3.41"></a><span id="l3.41"> </span>
<a href="#l3.42"></a><span id="l3.42"> function testDailyRecurrence() {</span>
<a href="#l3.43"></a><span id="l3.43">   goToDate(controller, 2009, 1, 1);</span>
<a href="#l3.44"></a><span id="l3.44"> </span>
<a href="#l3.45"></a><span id="l3.45">   // Create daily event.</span>
<a href="#l3.46"></a><span id="l3.46">   let eventBox = lookupEventBox(&quot;day&quot;, CANVAS_BOX, null, 1, HOUR);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/test/mozmill/cal-recurrence/testLastDayOfMonthRecurrence.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/test/mozmill/cal-recurrence/testLastDayOfMonthRecurrence.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l4.4"></a><span id="l4.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l4.5"></a><span id="l4.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l4.6"></a><span id="l4.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l4.7"></a><span id="l4.7"> </span>
<a href="#l4.8"></a><span id="l4.8" class="difflineminus">-var MODULE_NAME = &quot;testLastDayOfMonthRecurrence&quot;;</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l4.10"></a><span id="l4.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineminus">-</span>
<a href="#l4.12"></a><span id="l4.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l4.13"></a><span id="l4.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l4.14"></a><span id="l4.14"> );</span>
<a href="#l4.15"></a><span id="l4.15"> </span>
<a href="#l4.16"></a><span id="l4.16"> var TIMEOUT_MODAL_DIALOG, CALENDARNAME, EVENTPATH, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l4.17"></a><span id="l4.17"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate;</span>
<a href="#l4.18"></a><span id="l4.18"> var invokeEventDialog, closeAllEventDialogs, deleteCalendars, createCalendar, menulistSelect;</span>
<a href="#l4.19"></a><span id="l4.19"> var REC_DLG_ACCEPT;</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineat">@@ -29,23 +25,24 @@ function setupModule(module) {</span>
<a href="#l4.21"></a><span id="l4.21">     handleOccurrencePrompt,</span>
<a href="#l4.22"></a><span id="l4.22">     switchToView,</span>
<a href="#l4.23"></a><span id="l4.23">     goToDate,</span>
<a href="#l4.24"></a><span id="l4.24">     invokeEventDialog,</span>
<a href="#l4.25"></a><span id="l4.25">     closeAllEventDialogs,</span>
<a href="#l4.26"></a><span id="l4.26">     deleteCalendars,</span>
<a href="#l4.27"></a><span id="l4.27">     createCalendar,</span>
<a href="#l4.28"></a><span id="l4.28">     menulistSelect,</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l4.32"></a><span id="l4.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l4.33"></a><span id="l4.33"> </span>
<a href="#l4.34"></a><span id="l4.34" class="difflineminus">-  ({ REC_DLG_ACCEPT } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+  ({ REC_DLG_ACCEPT } = ChromeUtils.import(</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+  ));</span>
<a href="#l4.39"></a><span id="l4.39"> </span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l4.41"></a><span id="l4.41">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l4.42"></a><span id="l4.42"> }</span>
<a href="#l4.43"></a><span id="l4.43"> </span>
<a href="#l4.44"></a><span id="l4.44"> function testLastDayOfMonthRecurrence() {</span>
<a href="#l4.45"></a><span id="l4.45">   goToDate(controller, 2008, 1, 31); // Start with a leap year.</span>
<a href="#l4.46"></a><span id="l4.46"> </span>
<a href="#l4.47"></a><span id="l4.47">   // Create monthly recurring event.</span>
<a href="#l4.48"></a><span id="l4.48">   let eventBox = lookupEventBox(&quot;day&quot;, CANVAS_BOX, null, 1, HOUR);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/test/mozmill/cal-recurrence/testWeeklyNRecurrence.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/test/mozmill/cal-recurrence/testWeeklyNRecurrence.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l5.4"></a><span id="l5.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.5"></a><span id="l5.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.6"></a><span id="l5.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8" class="difflineminus">-var MODULE_NAME = &quot;testWeeklyNRecurrence&quot;;</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineminus">-</span>
<a href="#l5.12"></a><span id="l5.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l5.13"></a><span id="l5.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l5.14"></a><span id="l5.14"> );</span>
<a href="#l5.15"></a><span id="l5.15"> </span>
<a href="#l5.16"></a><span id="l5.16"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18"> var TIMEOUT_MODAL_DIALOG, CALENDARNAME, EVENTPATH, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l5.19"></a><span id="l5.19"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate, invokeEventDialog;</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineat">@@ -32,23 +28,24 @@ function setupModule(module) {</span>
<a href="#l5.21"></a><span id="l5.21">     switchToView,</span>
<a href="#l5.22"></a><span id="l5.22">     goToDate,</span>
<a href="#l5.23"></a><span id="l5.23">     invokeEventDialog,</span>
<a href="#l5.24"></a><span id="l5.24">     viewForward,</span>
<a href="#l5.25"></a><span id="l5.25">     deleteCalendars,</span>
<a href="#l5.26"></a><span id="l5.26">     closeAllEventDialogs,</span>
<a href="#l5.27"></a><span id="l5.27">     createCalendar,</span>
<a href="#l5.28"></a><span id="l5.28">     menulistSelect,</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l5.32"></a><span id="l5.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l5.33"></a><span id="l5.33"> </span>
<a href="#l5.34"></a><span id="l5.34" class="difflineminus">-  ({ REC_DLG_ACCEPT, REC_DLG_DAYS } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+  ({ REC_DLG_ACCEPT, REC_DLG_DAYS } = ChromeUtils.import(</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+  ));</span>
<a href="#l5.39"></a><span id="l5.39"> </span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l5.41"></a><span id="l5.41">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l5.42"></a><span id="l5.42"> }</span>
<a href="#l5.43"></a><span id="l5.43"> </span>
<a href="#l5.44"></a><span id="l5.44"> function testWeeklyNRecurrence() {</span>
<a href="#l5.45"></a><span id="l5.45">   goToDate(controller, 2009, 1, 5);</span>
<a href="#l5.46"></a><span id="l5.46"> </span>
<a href="#l5.47"></a><span id="l5.47">   // Create weekly recurring event.</span>
<a href="#l5.48"></a><span id="l5.48">   let eventBox = lookupEventBox(&quot;day&quot;, CANVAS_BOX, null, 1, HOUR);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/test/mozmill/cal-recurrence/testWeeklyUntilRecurrence.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/test/mozmill/cal-recurrence/testWeeklyUntilRecurrence.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l6.4"></a><span id="l6.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.5"></a><span id="l6.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.6"></a><span id="l6.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l6.7"></a><span id="l6.7"> </span>
<a href="#l6.8"></a><span id="l6.8" class="difflineminus">-var MODULE_NAME = &quot;testWeeklyUntilRecurrence&quot;;</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineminus">-</span>
<a href="#l6.12"></a><span id="l6.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l6.13"></a><span id="l6.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l6.14"></a><span id="l6.14"> );</span>
<a href="#l6.15"></a><span id="l6.15"> </span>
<a href="#l6.16"></a><span id="l6.16"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l6.17"></a><span id="l6.17"> </span>
<a href="#l6.18"></a><span id="l6.18"> var SHORT_SLEEP, TIMEOUT_MODAL_DIALOG, CALENDARNAME, EVENTPATH, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l6.19"></a><span id="l6.19"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate, invokeEventDialog;</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineat">@@ -34,25 +30,24 @@ function setupModule(module) {</span>
<a href="#l6.21"></a><span id="l6.21">     switchToView,</span>
<a href="#l6.22"></a><span id="l6.22">     goToDate,</span>
<a href="#l6.23"></a><span id="l6.23">     invokeEventDialog,</span>
<a href="#l6.24"></a><span id="l6.24">     viewForward,</span>
<a href="#l6.25"></a><span id="l6.25">     closeAllEventDialogs,</span>
<a href="#l6.26"></a><span id="l6.26">     deleteCalendars,</span>
<a href="#l6.27"></a><span id="l6.27">     createCalendar,</span>
<a href="#l6.28"></a><span id="l6.28">     menulistSelect,</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l6.32"></a><span id="l6.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l6.33"></a><span id="l6.33"> </span>
<a href="#l6.34"></a><span id="l6.34" class="difflineminus">-  ({ REC_DLG_DAYS, REC_DLG_ACCEPT, REC_DLG_UNTIL_INPUT } = collector.getModule(</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineminus">-    &quot;item-editing-helpers&quot;</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+  ({ REC_DLG_DAYS, REC_DLG_ACCEPT, REC_DLG_UNTIL_INPUT } = ChromeUtils.import(</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l6.38"></a><span id="l6.38">   ));</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l6.40"></a><span id="l6.40"> </span>
<a href="#l6.41"></a><span id="l6.41" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l6.42"></a><span id="l6.42">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l6.43"></a><span id="l6.43"> }</span>
<a href="#l6.44"></a><span id="l6.44"> </span>
<a href="#l6.45"></a><span id="l6.45"> function testWeeklyUntilRecurrence() {</span>
<a href="#l6.46"></a><span id="l6.46">   goToDate(controller, 2009, 1, 5); // Monday</span>
<a href="#l6.47"></a><span id="l6.47"> </span>
<a href="#l6.48"></a><span id="l6.48">   // Create weekly recurring event.</span>
<a href="#l6.49"></a><span id="l6.49">   let eventBox = lookupEventBox(&quot;day&quot;, CANVAS_BOX, null, 1, HOUR);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/test/mozmill/cal-recurrence/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/test/mozmill/cal-recurrence/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l7.4"></a><span id="l7.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l7.5"></a><span id="l7.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l7.6"></a><span id="l7.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8" class="difflineminus">-var MODULE_NAME = &quot;testWeeklyWithExceptionRecurrence&quot;;</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineminus">-</span>
<a href="#l7.12"></a><span id="l7.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l7.13"></a><span id="l7.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l7.14"></a><span id="l7.14"> );</span>
<a href="#l7.15"></a><span id="l7.15"> </span>
<a href="#l7.16"></a><span id="l7.16"> var TIMEOUT_MODAL_DIALOG, CALENDARNAME, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l7.17"></a><span id="l7.17"> var DAY_VIEW, WEEK_VIEW, EVENTPATH;</span>
<a href="#l7.18"></a><span id="l7.18"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate;</span>
<a href="#l7.19"></a><span id="l7.19"> var invokeEventDialog, viewForward, closeAllEventDialogs, deleteCalendars, createCalendar;</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineat">@@ -38,29 +34,24 @@ function setupModule(module) {</span>
<a href="#l7.21"></a><span id="l7.21">     switchToView,</span>
<a href="#l7.22"></a><span id="l7.22">     goToDate,</span>
<a href="#l7.23"></a><span id="l7.23">     invokeEventDialog,</span>
<a href="#l7.24"></a><span id="l7.24">     viewForward,</span>
<a href="#l7.25"></a><span id="l7.25">     closeAllEventDialogs,</span>
<a href="#l7.26"></a><span id="l7.26">     deleteCalendars,</span>
<a href="#l7.27"></a><span id="l7.27">     createCalendar,</span>
<a href="#l7.28"></a><span id="l7.28">     menulistSelect,</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l7.32"></a><span id="l7.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l7.33"></a><span id="l7.33"> </span>
<a href="#l7.34"></a><span id="l7.34" class="difflineminus">-  ({</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineminus">-    REPEAT_DETAILS,</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineminus">-    REC_DLG_ACCEPT,</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineminus">-    REC_DLG_DAYS,</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineminus">-    helpersForEditUI,</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineminus">-    setData,</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineminus">-  } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+  ({ REPEAT_DETAILS, REC_DLG_ACCEPT, REC_DLG_DAYS, helpersForEditUI, setData } = ChromeUtils.import(</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineplus">+  ));</span>
<a href="#l7.45"></a><span id="l7.45"> </span>
<a href="#l7.46"></a><span id="l7.46" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l7.47"></a><span id="l7.47">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l7.48"></a><span id="l7.48"> }</span>
<a href="#l7.49"></a><span id="l7.49"> </span>
<a href="#l7.50"></a><span id="l7.50"> function testWeeklyWithExceptionRecurrence() {</span>
<a href="#l7.51"></a><span id="l7.51">   goToDate(controller, 2009, 1, 5);</span>
<a href="#l7.52"></a><span id="l7.52"> </span>
<a href="#l7.53"></a><span id="l7.53">   // Create weekly recurring event.</span>
<a href="#l7.54"></a><span id="l7.54">   let eventBox = lookupEventBox(&quot;day&quot;, CANVAS_BOX, null, 1, HOUR);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testAlarmDialog.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testAlarmDialog.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l8.4"></a><span id="l8.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.5"></a><span id="l8.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.6"></a><span id="l8.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8" class="difflineminus">-var MODULE_NAME = &quot;testAlarmDialog&quot;;</span>
<a href="#l8.9"></a><span id="l8.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l8.11"></a><span id="l8.11" class="difflineminus">-</span>
<a href="#l8.12"></a><span id="l8.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l8.13"></a><span id="l8.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l8.14"></a><span id="l8.14"> );</span>
<a href="#l8.15"></a><span id="l8.15"> </span>
<a href="#l8.16"></a><span id="l8.16"> var TIMEOUT_MODAL_DIALOG, CALENDARNAME, EVENTPATH, ALLDAY;</span>
<a href="#l8.17"></a><span id="l8.17"> var helpersForController, switchToView, goToDate, lookupEventBox;</span>
<a href="#l8.18"></a><span id="l8.18"> var invokeEventDialog, viewForward, closeAllEventDialogs, deleteCalendars;</span>
<a href="#l8.19"></a><span id="l8.19"> var createCalendar;</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineat">@@ -27,23 +23,20 @@ function setupModule(module) {</span>
<a href="#l8.21"></a><span id="l8.21">     switchToView,</span>
<a href="#l8.22"></a><span id="l8.22">     goToDate,</span>
<a href="#l8.23"></a><span id="l8.23">     lookupEventBox,</span>
<a href="#l8.24"></a><span id="l8.24">     invokeEventDialog,</span>
<a href="#l8.25"></a><span id="l8.25">     viewForward,</span>
<a href="#l8.26"></a><span id="l8.26">     closeAllEventDialogs,</span>
<a href="#l8.27"></a><span id="l8.27">     deleteCalendars,</span>
<a href="#l8.28"></a><span id="l8.28">     createCalendar,</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l8.32"></a><span id="l8.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l8.33"></a><span id="l8.33"> </span>
<a href="#l8.34"></a><span id="l8.34" class="difflineminus">-  ({ setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineminus">-</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineplus">+  ({ setData } = ChromeUtils.import(&quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;));</span>
<a href="#l8.38"></a><span id="l8.38">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l8.39"></a><span id="l8.39"> }</span>
<a href="#l8.40"></a><span id="l8.40"> </span>
<a href="#l8.41"></a><span id="l8.41"> function testAlarmDialog() {</span>
<a href="#l8.42"></a><span id="l8.42">   let now = new Date();</span>
<a href="#l8.43"></a><span id="l8.43"> </span>
<a href="#l8.44"></a><span id="l8.44">   switchToView(controller, &quot;day&quot;);</span>
<a href="#l8.45"></a><span id="l8.45">   goToDate(controller, now.getFullYear(), now.getMonth() + 1, now.getDate());</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testEventDialog.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testEventDialog.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l9.4"></a><span id="l9.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l9.5"></a><span id="l9.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l9.6"></a><span id="l9.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8" class="difflineminus">-var MODULE_NAME = &quot;testEventDialog&quot;;</span>
<a href="#l9.9"></a><span id="l9.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l9.10"></a><span id="l9.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l9.11"></a><span id="l9.11" class="difflineminus">-</span>
<a href="#l9.12"></a><span id="l9.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l9.13"></a><span id="l9.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l9.14"></a><span id="l9.14"> );</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18"> var TIMEOUT_MODAL_DIALOG, CALENDARNAME, EVENTPATH, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l9.19"></a><span id="l9.19"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate, lookupEventBox;</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineat">@@ -40,24 +36,22 @@ function setupModule(module) {</span>
<a href="#l9.21"></a><span id="l9.21">     goToDate,</span>
<a href="#l9.22"></a><span id="l9.22">     lookupEventBox,</span>
<a href="#l9.23"></a><span id="l9.23">     invokeEventDialog,</span>
<a href="#l9.24"></a><span id="l9.24">     checkAlarmIcon,</span>
<a href="#l9.25"></a><span id="l9.25">     viewBack,</span>
<a href="#l9.26"></a><span id="l9.26">     closeAllEventDialogs,</span>
<a href="#l9.27"></a><span id="l9.27">     deleteCalendars,</span>
<a href="#l9.28"></a><span id="l9.28">     createCalendar,</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l9.32"></a><span id="l9.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l9.33"></a><span id="l9.33"> </span>
<a href="#l9.34"></a><span id="l9.34" class="difflineminus">-  ({ EVENT_TABPANELS, ATTENDEES_ROW, helpersForEditUI, setData } = collector.getModule(</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineminus">-    &quot;item-editing-helpers&quot;</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+  ({ EVENT_TABPANELS, ATTENDEES_ROW, helpersForEditUI, setData } = ChromeUtils.import(</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l9.38"></a><span id="l9.38">   ));</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l9.40"></a><span id="l9.40"> </span>
<a href="#l9.41"></a><span id="l9.41">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l9.42"></a><span id="l9.42"> }</span>
<a href="#l9.43"></a><span id="l9.43"> </span>
<a href="#l9.44"></a><span id="l9.44"> function testEventDialog() {</span>
<a href="#l9.45"></a><span id="l9.45">   let dateFormatter = cal.getDateFormatter();</span>
<a href="#l9.46"></a><span id="l9.46">   let now = new Date();</span>
<a href="#l9.47"></a><span id="l9.47"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -1,24 +1,25 @@</span>
<a href="#l10.4"></a><span id="l10.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l10.5"></a><span id="l10.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l10.6"></a><span id="l10.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l10.7"></a><span id="l10.7"> </span>
<a href="#l10.8"></a><span id="l10.8" class="difflineminus">-var MODULE_NAME = &quot;testEventDialogModificationPrompt&quot;;</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;, &quot;folder-display-helpers&quot;];</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineminus">-</span>
<a href="#l10.12"></a><span id="l10.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l10.13"></a><span id="l10.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l10.14"></a><span id="l10.14"> );</span>
<a href="#l10.15"></a><span id="l10.15"> </span>
<a href="#l10.16"></a><span id="l10.16"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l10.17"></a><span id="l10.17"> </span>
<a href="#l10.18"></a><span id="l10.18"> var CALENDARNAME, EVENT_BOX, CANVAS_BOX, EVENTPATH;</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineminus">-var helpersForController, invokeEventDialog, createCalendar, closeAllEventDialogs, deleteCalendars;</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineplus">+var helpersForController,</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineplus">+  switchToView,</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineplus">+  invokeEventDialog,</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineplus">+  createCalendar,</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineplus">+  closeAllEventDialogs,</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineplus">+  deleteCalendars;</span>
<a href="#l10.26"></a><span id="l10.26"> var goToDate;</span>
<a href="#l10.27"></a><span id="l10.27"> var setData;</span>
<a href="#l10.28"></a><span id="l10.28"> var mark_failure;</span>
<a href="#l10.29"></a><span id="l10.29"> </span>
<a href="#l10.30"></a><span id="l10.30"> const TIMEOUT_COMMON_DIALOG = 3000;</span>
<a href="#l10.31"></a><span id="l10.31"> var savePromptAppeared = false;</span>
<a href="#l10.32"></a><span id="l10.32"> var failPoints = {</span>
<a href="#l10.33"></a><span id="l10.33">   first: &quot;no change&quot;,</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineat">@@ -31,30 +32,31 @@ var { date1, date2, date3, data, newline</span>
<a href="#l10.35"></a><span id="l10.35"> function setupModule(module) {</span>
<a href="#l10.36"></a><span id="l10.36">   controller = mozmill.getMail3PaneController();</span>
<a href="#l10.37"></a><span id="l10.37">   ({</span>
<a href="#l10.38"></a><span id="l10.38">     CALENDARNAME,</span>
<a href="#l10.39"></a><span id="l10.39">     EVENT_BOX,</span>
<a href="#l10.40"></a><span id="l10.40">     CANVAS_BOX,</span>
<a href="#l10.41"></a><span id="l10.41">     EVENTPATH,</span>
<a href="#l10.42"></a><span id="l10.42">     helpersForController,</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineplus">+    switchToView,</span>
<a href="#l10.44"></a><span id="l10.44">     invokeEventDialog,</span>
<a href="#l10.45"></a><span id="l10.45">     createCalendar,</span>
<a href="#l10.46"></a><span id="l10.46">     closeAllEventDialogs,</span>
<a href="#l10.47"></a><span id="l10.47">     deleteCalendars,</span>
<a href="#l10.48"></a><span id="l10.48">     goToDate,</span>
<a href="#l10.49"></a><span id="l10.49" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l10.52"></a><span id="l10.52">   Object.assign(module, helpersForController(controller));</span>
<a href="#l10.53"></a><span id="l10.53"> </span>
<a href="#l10.54"></a><span id="l10.54" class="difflineminus">-  ({ setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineplus">+  ({ setData } = ChromeUtils.import(&quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;));</span>
<a href="#l10.57"></a><span id="l10.57" class="difflineplus">+  ({ mark_failure } = ChromeUtils.import(</span>
<a href="#l10.58"></a><span id="l10.58" class="difflineplus">+    &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l10.59"></a><span id="l10.59" class="difflineplus">+  ));</span>
<a href="#l10.60"></a><span id="l10.60"> </span>
<a href="#l10.61"></a><span id="l10.61" class="difflineminus">-  ({ mark_failure } = collector.getModule(&quot;folder-display-helpers&quot;));</span>
<a href="#l10.62"></a><span id="l10.62" class="difflineminus">-</span>
<a href="#l10.63"></a><span id="l10.63" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l10.64"></a><span id="l10.64">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l10.65"></a><span id="l10.65"> }</span>
<a href="#l10.66"></a><span id="l10.66"> </span>
<a href="#l10.67"></a><span id="l10.67"> // Test that closing an event dialog with no changes does not prompt for save.</span>
<a href="#l10.68"></a><span id="l10.68"> function testEventDialogModificationPrompt() {</span>
<a href="#l10.69"></a><span id="l10.69">   goToDate(controller, 2009, 1, 1);</span>
<a href="#l10.70"></a><span id="l10.70"> </span>
<a href="#l10.71"></a><span id="l10.71">   let createbox = lookupEventBox(&quot;day&quot;, CANVAS_BOX, null, 1, 8);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testEventDialogSize.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testEventDialogSize.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l11.4"></a><span id="l11.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.5"></a><span id="l11.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.6"></a><span id="l11.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l11.7"></a><span id="l11.7"> </span>
<a href="#l11.8"></a><span id="l11.8" class="difflineminus">-var MODULE_NAME = &quot;testEventDialogSize&quot;;</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;];</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineminus">-</span>
<a href="#l11.12"></a><span id="l11.12"> var helpersForController, invokeEventDialog, createCalendar, closeAllEventDialogs, deleteCalendars;</span>
<a href="#l11.13"></a><span id="l11.13"> var CALENDARNAME;</span>
<a href="#l11.14"></a><span id="l11.14"> </span>
<a href="#l11.15"></a><span id="l11.15"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l11.16"></a><span id="l11.16"> </span>
<a href="#l11.17"></a><span id="l11.17"> const SMALL_TOLERANCE = 5;</span>
<a href="#l11.18"></a><span id="l11.18"> const LARGE_TOLERANCE = 10;</span>
<a href="#l11.19"></a><span id="l11.19"> </span>
<a href="#l11.20"></a><span id="l11.20" class="difflineat">@@ -18,18 +14,17 @@ function setupModule(module) {</span>
<a href="#l11.21"></a><span id="l11.21">   controller = mozmill.getMail3PaneController();</span>
<a href="#l11.22"></a><span id="l11.22">   ({</span>
<a href="#l11.23"></a><span id="l11.23">     helpersForController,</span>
<a href="#l11.24"></a><span id="l11.24">     invokeEventDialog,</span>
<a href="#l11.25"></a><span id="l11.25">     createCalendar,</span>
<a href="#l11.26"></a><span id="l11.26">     closeAllEventDialogs,</span>
<a href="#l11.27"></a><span id="l11.27">     deleteCalendars,</span>
<a href="#l11.28"></a><span id="l11.28">     CALENDARNAME,</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l11.30"></a><span id="l11.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l11.32"></a><span id="l11.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l11.33"></a><span id="l11.33"> </span>
<a href="#l11.34"></a><span id="l11.34">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l11.35"></a><span id="l11.35"> }</span>
<a href="#l11.36"></a><span id="l11.36"> </span>
<a href="#l11.37"></a><span id="l11.37"> function testEventDialog() {</span>
<a href="#l11.38"></a><span id="l11.38">   dump(&quot;#ltnNewEvent click\n&quot;);</span>
<a href="#l11.39"></a><span id="l11.39">   controller.mainMenu.click(&quot;#ltnNewEvent&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testUTF8.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testUTF8.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -1,41 +1,42 @@</span>
<a href="#l12.4"></a><span id="l12.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l12.5"></a><span id="l12.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l12.6"></a><span id="l12.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l12.7"></a><span id="l12.7"> </span>
<a href="#l12.8"></a><span id="l12.8" class="difflineminus">-var MODULE_NAME = &quot;testUTF8&quot;;</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l12.11"></a><span id="l12.11" class="difflineminus">-</span>
<a href="#l12.12"></a><span id="l12.12"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l12.13"></a><span id="l12.13"> </span>
<a href="#l12.14"></a><span id="l12.14"> var EVENT_BOX, CANVAS_BOX;</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-var helpersForController, invokeEventDialog, closeAllEventDialogs, createCalendar, deleteCalendars;</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+var helpersForController,</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+  switchToView,</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+  invokeEventDialog,</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+  closeAllEventDialogs,</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+  createCalendar,</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+  deleteCalendars;</span>
<a href="#l12.22"></a><span id="l12.22"> var setData;</span>
<a href="#l12.23"></a><span id="l12.23"> </span>
<a href="#l12.24"></a><span id="l12.24"> var UTF8STRING = &quot; 💣 💥  ☣  &quot;;</span>
<a href="#l12.25"></a><span id="l12.25"> </span>
<a href="#l12.26"></a><span id="l12.26"> function setupModule(module) {</span>
<a href="#l12.27"></a><span id="l12.27">   controller = mozmill.getMail3PaneController();</span>
<a href="#l12.28"></a><span id="l12.28">   ({</span>
<a href="#l12.29"></a><span id="l12.29">     EVENT_BOX,</span>
<a href="#l12.30"></a><span id="l12.30">     CANVAS_BOX,</span>
<a href="#l12.31"></a><span id="l12.31">     helpersForController,</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+    switchToView,</span>
<a href="#l12.33"></a><span id="l12.33">     invokeEventDialog,</span>
<a href="#l12.34"></a><span id="l12.34">     closeAllEventDialogs,</span>
<a href="#l12.35"></a><span id="l12.35">     createCalendar,</span>
<a href="#l12.36"></a><span id="l12.36">     deleteCalendars,</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l12.40"></a><span id="l12.40">   Object.assign(module, helpersForController(controller));</span>
<a href="#l12.41"></a><span id="l12.41"> </span>
<a href="#l12.42"></a><span id="l12.42" class="difflineminus">-  ({ setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineplus">+  ({ setData } = ChromeUtils.import(&quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;));</span>
<a href="#l12.45"></a><span id="l12.45"> </span>
<a href="#l12.46"></a><span id="l12.46" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l12.47"></a><span id="l12.47">   createCalendar(controller, UTF8STRING);</span>
<a href="#l12.48"></a><span id="l12.48">   Services.prefs.setStringPref(&quot;calendar.categories.names&quot;, UTF8STRING);</span>
<a href="#l12.49"></a><span id="l12.49"> }</span>
<a href="#l12.50"></a><span id="l12.50"> </span>
<a href="#l12.51"></a><span id="l12.51"> function testUTF8() {</span>
<a href="#l12.52"></a><span id="l12.52">   // Create new event.</span>
<a href="#l12.53"></a><span id="l12.53">   let eventBox = lookupEventBox(&quot;day&quot;, CANVAS_BOX, null, 1, 8);</span>
<a href="#l12.54"></a><span id="l12.54">   invokeEventDialog(controller, eventBox, (event, iframe) =&gt; {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/test/mozmill/invitations/test-imip-bar-eml.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/test/mozmill/invitations/test-imip-bar-eml.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -1,32 +1,23 @@</span>
<a href="#l13.4"></a><span id="l13.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l13.5"></a><span id="l13.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l13.6"></a><span id="l13.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l13.7"></a><span id="l13.7"> </span>
<a href="#l13.8"></a><span id="l13.8"> /**</span>
<a href="#l13.9"></a><span id="l13.9">  * Test that the IMIP bar behaves properly for eml files.</span>
<a href="#l13.10"></a><span id="l13.10">  */</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-/* import-globals-from ../../../../mail/test/mozmill/shared-modules/test-folder-display-helpers.js */</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-var MODULE_NAME = &quot;testInvitations&quot;;</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineminus">-</span>
<a href="#l13.18"></a><span id="l13.18"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l13.19"></a><span id="l13.19"> </span>
<a href="#l13.20"></a><span id="l13.20" class="difflineplus">+var { open_message_from_file } = ChromeUtils.import(</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineplus">+);</span>
<a href="#l13.23"></a><span id="l13.23"> var { close_window } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l13.24"></a><span id="l13.24"> </span>
<a href="#l13.25"></a><span id="l13.25" class="difflineminus">-function setupModule(module) {</span>
<a href="#l13.26"></a><span id="l13.26" class="difflineminus">-  for (let dep of MODULE_REQUIRES) {</span>
<a href="#l13.27"></a><span id="l13.27" class="difflineminus">-    collector.getModule(dep).installInto(module);</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineminus">-  }</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineminus">-}</span>
<a href="#l13.30"></a><span id="l13.30" class="difflineminus">-</span>
<a href="#l13.31"></a><span id="l13.31"> /**</span>
<a href="#l13.32"></a><span id="l13.32">  * Test that when opening a message containing an event, the IMIP bar shows.</span>
<a href="#l13.33"></a><span id="l13.33">  */</span>
<a href="#l13.34"></a><span id="l13.34"> function test_event_from_eml() {</span>
<a href="#l13.35"></a><span id="l13.35">   let thisFilePath = os.getFileForPath(__file__);</span>
<a href="#l13.36"></a><span id="l13.36">   let file = os.getFileForPath(os.abspath(&quot;./message-containing-event.eml&quot;, thisFilePath));</span>
<a href="#l13.37"></a><span id="l13.37"> </span>
<a href="#l13.38"></a><span id="l13.38">   let msgc = open_message_from_file(file);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/test/mozmill/preferences/testAlarmDefaultValue.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/test/mozmill/preferences/testAlarmDefaultValue.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -1,20 +1,16 @@</span>
<a href="#l14.4"></a><span id="l14.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l14.5"></a><span id="l14.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l14.6"></a><span id="l14.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8"> /**</span>
<a href="#l14.9"></a><span id="l14.9">  * Test default alarm settings for events and tasks</span>
<a href="#l14.10"></a><span id="l14.10">  */</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-var MODULE_NAME = &quot;testAlarmDefaultValue&quot;;</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;content-tab-helpers&quot;];</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-</span>
<a href="#l14.16"></a><span id="l14.16"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l14.17"></a><span id="l14.17">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l14.18"></a><span id="l14.18"> );</span>
<a href="#l14.19"></a><span id="l14.19"> </span>
<a href="#l14.20"></a><span id="l14.20"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l14.21"></a><span id="l14.21"> var { PluralForm } = ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l14.22"></a><span id="l14.22"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l14.23"></a><span id="l14.23"> </span>
<a href="#l14.24"></a><span id="l14.24" class="difflineat">@@ -29,21 +25,21 @@ var prefTab = null;</span>
<a href="#l14.25"></a><span id="l14.25"> function setupModule(module) {</span>
<a href="#l14.26"></a><span id="l14.26">   controller = mozmill.getMail3PaneController();</span>
<a href="#l14.27"></a><span id="l14.27">   ({</span>
<a href="#l14.28"></a><span id="l14.28">     helpersForController,</span>
<a href="#l14.29"></a><span id="l14.29">     invokeEventDialog,</span>
<a href="#l14.30"></a><span id="l14.30">     openLightningPrefs,</span>
<a href="#l14.31"></a><span id="l14.31">     closeLightningPrefs,</span>
<a href="#l14.32"></a><span id="l14.32">     menulistSelect,</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l14.35"></a><span id="l14.35" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l14.36"></a><span id="l14.36"> </span>
<a href="#l14.37"></a><span id="l14.37" class="difflineminus">-  ({ content_tab_e, content_tab_eid } = collector.getModule(&quot;content-tab-helpers&quot;));</span>
<a href="#l14.38"></a><span id="l14.38" class="difflineminus">-  collector.getModule(&quot;content-tab-helpers&quot;).setupModule();</span>
<a href="#l14.39"></a><span id="l14.39" class="difflineplus">+  ({ content_tab_e, content_tab_eid } = ChromeUtils.import(</span>
<a href="#l14.40"></a><span id="l14.40" class="difflineplus">+    &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineplus">+  ));</span>
<a href="#l14.42"></a><span id="l14.42"> }</span>
<a href="#l14.43"></a><span id="l14.43"> </span>
<a href="#l14.44"></a><span id="l14.44"> function testDefaultAlarms() {</span>
<a href="#l14.45"></a><span id="l14.45">   let localeUnitString = cal.l10n.getCalString(&quot;unitDays&quot;);</span>
<a href="#l14.46"></a><span id="l14.46">   let unitString = PluralForm.get(DEFVALUE, localeUnitString).replace(&quot;#1&quot;, DEFVALUE);</span>
<a href="#l14.47"></a><span id="l14.47">   let alarmString = (...args) =&gt; cal.l10n.getString(&quot;calendar-alarms&quot;, ...args);</span>
<a href="#l14.48"></a><span id="l14.48">   let originStringEvent = alarmString(&quot;reminderCustomOriginBeginBeforeEvent&quot;);</span>
<a href="#l14.49"></a><span id="l14.49">   let originStringTask = alarmString(&quot;reminderCustomOriginBeginBeforeTask&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/test/mozmill/preferences/testCategoryColors.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/test/mozmill/preferences/testCategoryColors.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -1,34 +1,30 @@</span>
<a href="#l15.4"></a><span id="l15.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l15.5"></a><span id="l15.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l15.6"></a><span id="l15.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l15.7"></a><span id="l15.7"> </span>
<a href="#l15.8"></a><span id="l15.8" class="difflineminus">-var MODULE_NAME = &quot;testCategoryColors&quot;;</span>
<a href="#l15.9"></a><span id="l15.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l15.10"></a><span id="l15.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;content-tab-helpers&quot;];</span>
<a href="#l15.11"></a><span id="l15.11" class="difflineminus">-</span>
<a href="#l15.12"></a><span id="l15.12"> var { wait_for_frame_load } = ChromeUtils.import(</span>
<a href="#l15.13"></a><span id="l15.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l15.14"></a><span id="l15.14"> );</span>
<a href="#l15.15"></a><span id="l15.15"> </span>
<a href="#l15.16"></a><span id="l15.16"> var helpersForController, openLightningPrefs, closeLightningPrefs;</span>
<a href="#l15.17"></a><span id="l15.17"> var content_tab_e, content_tab_eid;</span>
<a href="#l15.18"></a><span id="l15.18"> </span>
<a href="#l15.19"></a><span id="l15.19"> var prefTab = null;</span>
<a href="#l15.20"></a><span id="l15.20"> </span>
<a href="#l15.21"></a><span id="l15.21"> function setupModule(module) {</span>
<a href="#l15.22"></a><span id="l15.22">   controller = mozmill.getMail3PaneController();</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineminus">-  ({ helpersForController, openLightningPrefs, closeLightningPrefs } = collector.getModule(</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineminus">-    &quot;calendar-utils&quot;</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+  ({ helpersForController, openLightningPrefs, closeLightningPrefs } = ChromeUtils.import(</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+    &quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;</span>
<a href="#l15.27"></a><span id="l15.27">   ));</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l15.29"></a><span id="l15.29"> </span>
<a href="#l15.30"></a><span id="l15.30" class="difflineminus">-  ({ content_tab_e, content_tab_eid } = collector.getModule(&quot;content-tab-helpers&quot;));</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-  collector.getModule(&quot;content-tab-helpers&quot;).setupModule();</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+  ({ content_tab_e, content_tab_eid } = ChromeUtils.import(</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineplus">+    &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineplus">+  ));</span>
<a href="#l15.35"></a><span id="l15.35"> }</span>
<a href="#l15.36"></a><span id="l15.36"> </span>
<a href="#l15.37"></a><span id="l15.37"> function testCategoryColors() {</span>
<a href="#l15.38"></a><span id="l15.38">   openLightningPrefs(tab =&gt; {</span>
<a href="#l15.39"></a><span id="l15.39">     prefTab = tab;</span>
<a href="#l15.40"></a><span id="l15.40"> </span>
<a href="#l15.41"></a><span id="l15.41">     let listBox = content_tab_e(tab, &quot;categorieslist&quot;);</span>
<a href="#l15.42"></a><span id="l15.42">     listBox.scrollIntoView();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l16.4"></a><span id="l16.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l16.5"></a><span id="l16.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l16.6"></a><span id="l16.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l16.7"></a><span id="l16.7"> </span>
<a href="#l16.8"></a><span id="l16.8" class="difflineminus">-var MODULE_NAME = &quot;testAnnualRecurrenceRotated&quot;;</span>
<a href="#l16.9"></a><span id="l16.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l16.10"></a><span id="l16.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;];</span>
<a href="#l16.11"></a><span id="l16.11" class="difflineminus">-</span>
<a href="#l16.12"></a><span id="l16.12"> var CALENDARNAME, EVENTPATH, CANVAS_BOX, ALLDAY;</span>
<a href="#l16.13"></a><span id="l16.13"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate;</span>
<a href="#l16.14"></a><span id="l16.14"> var invokeEventDialog, closeAllEventDialogs, deleteCalendars, createCalendar, menulistSelect;</span>
<a href="#l16.15"></a><span id="l16.15"> </span>
<a href="#l16.16"></a><span id="l16.16"> const STARTYEAR = 1950;</span>
<a href="#l16.17"></a><span id="l16.17"> const EPOCH = 1970;</span>
<a href="#l16.18"></a><span id="l16.18"> </span>
<a href="#l16.19"></a><span id="l16.19"> function setupModule(module) {</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineat">@@ -24,20 +20,20 @@ function setupModule(module) {</span>
<a href="#l16.21"></a><span id="l16.21">     handleOccurrencePrompt,</span>
<a href="#l16.22"></a><span id="l16.22">     switchToView,</span>
<a href="#l16.23"></a><span id="l16.23">     goToDate,</span>
<a href="#l16.24"></a><span id="l16.24">     invokeEventDialog,</span>
<a href="#l16.25"></a><span id="l16.25">     closeAllEventDialogs,</span>
<a href="#l16.26"></a><span id="l16.26">     deleteCalendars,</span>
<a href="#l16.27"></a><span id="l16.27">     createCalendar,</span>
<a href="#l16.28"></a><span id="l16.28">     menulistSelect,</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l16.30"></a><span id="l16.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l16.32"></a><span id="l16.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l16.33"></a><span id="l16.33"> </span>
<a href="#l16.34"></a><span id="l16.34" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l16.35"></a><span id="l16.35">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l16.36"></a><span id="l16.36">   // Rotate view.</span>
<a href="#l16.37"></a><span id="l16.37">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l16.38"></a><span id="l16.38">   controller.waitFor(() =&gt; eid(&quot;day-view&quot;).getNode().orient == &quot;horizontal&quot;);</span>
<a href="#l16.39"></a><span id="l16.39"> }</span>
<a href="#l16.40"></a><span id="l16.40"> </span>
<a href="#l16.41"></a><span id="l16.41"> function testAnnualRecurrence() {</span>
<a href="#l16.42"></a><span id="l16.42">   goToDate(controller, STARTYEAR, 1, 1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l17.4"></a><span id="l17.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l17.5"></a><span id="l17.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l17.6"></a><span id="l17.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l17.7"></a><span id="l17.7"> </span>
<a href="#l17.8"></a><span id="l17.8" class="difflineminus">-var MODULE_NAME = &quot;testBiweeklyRecurrenceRotated&quot;;</span>
<a href="#l17.9"></a><span id="l17.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l17.10"></a><span id="l17.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;];</span>
<a href="#l17.11"></a><span id="l17.11" class="difflineminus">-</span>
<a href="#l17.12"></a><span id="l17.12"> var CALENDARNAME, EVENTPATH, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l17.13"></a><span id="l17.13"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate;</span>
<a href="#l17.14"></a><span id="l17.14"> var invokeEventDialog,</span>
<a href="#l17.15"></a><span id="l17.15">   viewForward,</span>
<a href="#l17.16"></a><span id="l17.16">   createCalendar,</span>
<a href="#l17.17"></a><span id="l17.17">   closeAllEventDialogs,</span>
<a href="#l17.18"></a><span id="l17.18">   deleteCalendars,</span>
<a href="#l17.19"></a><span id="l17.19">   menulistSelect;</span>
<a href="#l17.20"></a><span id="l17.20" class="difflineat">@@ -29,20 +25,20 @@ function setupModule(module) {</span>
<a href="#l17.21"></a><span id="l17.21">     switchToView,</span>
<a href="#l17.22"></a><span id="l17.22">     goToDate,</span>
<a href="#l17.23"></a><span id="l17.23">     invokeEventDialog,</span>
<a href="#l17.24"></a><span id="l17.24">     viewForward,</span>
<a href="#l17.25"></a><span id="l17.25">     closeAllEventDialogs,</span>
<a href="#l17.26"></a><span id="l17.26">     deleteCalendars,</span>
<a href="#l17.27"></a><span id="l17.27">     createCalendar,</span>
<a href="#l17.28"></a><span id="l17.28">     menulistSelect,</span>
<a href="#l17.29"></a><span id="l17.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l17.30"></a><span id="l17.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l17.32"></a><span id="l17.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l17.33"></a><span id="l17.33"> </span>
<a href="#l17.34"></a><span id="l17.34" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l17.35"></a><span id="l17.35">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l17.36"></a><span id="l17.36">   // rotate view</span>
<a href="#l17.37"></a><span id="l17.37">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l17.38"></a><span id="l17.38">   controller.waitFor(() =&gt; eid(&quot;day-view&quot;).getNode().orient == &quot;horizontal&quot;);</span>
<a href="#l17.39"></a><span id="l17.39"> }</span>
<a href="#l17.40"></a><span id="l17.40"> </span>
<a href="#l17.41"></a><span id="l17.41"> function testBiweeklyRecurrence() {</span>
<a href="#l17.42"></a><span id="l17.42">   goToDate(controller, 2009, 1, 31);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l18.4"></a><span id="l18.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l18.5"></a><span id="l18.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l18.6"></a><span id="l18.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l18.7"></a><span id="l18.7"> </span>
<a href="#l18.8"></a><span id="l18.8" class="difflineminus">-var MODULE_NAME = &quot;testDailyRecurrenceRotated&quot;;</span>
<a href="#l18.9"></a><span id="l18.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineminus">-</span>
<a href="#l18.12"></a><span id="l18.12"> var CALENDARNAME, EVENTPATH, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l18.13"></a><span id="l18.13"> var helpersForController, invokeEventDialog, createCalendar, closeAllEventDialogs, deleteCalendars;</span>
<a href="#l18.14"></a><span id="l18.14"> var switchToView, goToDate, viewForward, viewBack, handleOccurrencePrompt;</span>
<a href="#l18.15"></a><span id="l18.15"> var menulistSelect;</span>
<a href="#l18.16"></a><span id="l18.16"> var setData;</span>
<a href="#l18.17"></a><span id="l18.17"> </span>
<a href="#l18.18"></a><span id="l18.18"> const HOUR = 8;</span>
<a href="#l18.19"></a><span id="l18.19"> </span>
<a href="#l18.20"></a><span id="l18.20" class="difflineat">@@ -27,23 +23,22 @@ function setupModule(module) {</span>
<a href="#l18.21"></a><span id="l18.21">     goToDate,</span>
<a href="#l18.22"></a><span id="l18.22">     invokeEventDialog,</span>
<a href="#l18.23"></a><span id="l18.23">     viewForward,</span>
<a href="#l18.24"></a><span id="l18.24">     viewBack,</span>
<a href="#l18.25"></a><span id="l18.25">     closeAllEventDialogs,</span>
<a href="#l18.26"></a><span id="l18.26">     deleteCalendars,</span>
<a href="#l18.27"></a><span id="l18.27">     createCalendar,</span>
<a href="#l18.28"></a><span id="l18.28">     menulistSelect,</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l18.32"></a><span id="l18.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l18.33"></a><span id="l18.33"> </span>
<a href="#l18.34"></a><span id="l18.34" class="difflineminus">-  ({ setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineplus">+  ({ setData } = ChromeUtils.import(&quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;));</span>
<a href="#l18.37"></a><span id="l18.37"> </span>
<a href="#l18.38"></a><span id="l18.38" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l18.39"></a><span id="l18.39">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l18.40"></a><span id="l18.40"> </span>
<a href="#l18.41"></a><span id="l18.41">   // Rotate view.</span>
<a href="#l18.42"></a><span id="l18.42">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l18.43"></a><span id="l18.43">   controller.waitFor(() =&gt; eid(&quot;day-view&quot;).getNode().orient == &quot;horizontal&quot;);</span>
<a href="#l18.44"></a><span id="l18.44"> }</span>
<a href="#l18.45"></a><span id="l18.45"> </span>
<a href="#l18.46"></a><span id="l18.46"> function testDailyRecurrence() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l19.4"></a><span id="l19.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l19.5"></a><span id="l19.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l19.6"></a><span id="l19.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l19.7"></a><span id="l19.7"> </span>
<a href="#l19.8"></a><span id="l19.8" class="difflineminus">-var MODULE_NAME = &quot;testLastDayOfMonthRecurrenceRotated&quot;;</span>
<a href="#l19.9"></a><span id="l19.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l19.10"></a><span id="l19.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l19.11"></a><span id="l19.11" class="difflineminus">-</span>
<a href="#l19.12"></a><span id="l19.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l19.13"></a><span id="l19.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l19.14"></a><span id="l19.14"> );</span>
<a href="#l19.15"></a><span id="l19.15"> </span>
<a href="#l19.16"></a><span id="l19.16"> var TIMEOUT_MODAL_DIALOG, CALENDARNAME, EVENTPATH, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l19.17"></a><span id="l19.17"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate;</span>
<a href="#l19.18"></a><span id="l19.18"> var invokeEventDialog, closeAllEventDialogs, deleteCalendars, createCalendar, menulistSelect;</span>
<a href="#l19.19"></a><span id="l19.19"> var REC_DLG_ACCEPT;</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineat">@@ -29,23 +25,24 @@ function setupModule(module) {</span>
<a href="#l19.21"></a><span id="l19.21">     invokeEventDialog,</span>
<a href="#l19.22"></a><span id="l19.22">     createCalendar,</span>
<a href="#l19.23"></a><span id="l19.23">     closeAllEventDialogs,</span>
<a href="#l19.24"></a><span id="l19.24">     deleteCalendars,</span>
<a href="#l19.25"></a><span id="l19.25">     switchToView,</span>
<a href="#l19.26"></a><span id="l19.26">     goToDate,</span>
<a href="#l19.27"></a><span id="l19.27">     handleOccurrencePrompt,</span>
<a href="#l19.28"></a><span id="l19.28">     menulistSelect,</span>
<a href="#l19.29"></a><span id="l19.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l19.30"></a><span id="l19.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l19.32"></a><span id="l19.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l19.33"></a><span id="l19.33"> </span>
<a href="#l19.34"></a><span id="l19.34" class="difflineminus">-  ({ REC_DLG_ACCEPT } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineplus">+  ({ REC_DLG_ACCEPT } = ChromeUtils.import(</span>
<a href="#l19.37"></a><span id="l19.37" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l19.38"></a><span id="l19.38" class="difflineplus">+  ));</span>
<a href="#l19.39"></a><span id="l19.39"> </span>
<a href="#l19.40"></a><span id="l19.40" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l19.41"></a><span id="l19.41">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l19.42"></a><span id="l19.42">   // Rotate view.</span>
<a href="#l19.43"></a><span id="l19.43">   switchToView(controller, &quot;day&quot;);</span>
<a href="#l19.44"></a><span id="l19.44">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l19.45"></a><span id="l19.45">   controller.waitFor(() =&gt; eid(&quot;day-view&quot;).getNode().orient == &quot;horizontal&quot;);</span>
<a href="#l19.46"></a><span id="l19.46"> }</span>
<a href="#l19.47"></a><span id="l19.47"> </span>
<a href="#l19.48"></a><span id="l19.48"> function testLastDayOfMonthRecurrence() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l20.4"></a><span id="l20.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l20.5"></a><span id="l20.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l20.6"></a><span id="l20.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8" class="difflineminus">-var MODULE_NAME = &quot;testWeeklyNRecurrenceRotated&quot;;</span>
<a href="#l20.9"></a><span id="l20.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l20.10"></a><span id="l20.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l20.11"></a><span id="l20.11" class="difflineminus">-</span>
<a href="#l20.12"></a><span id="l20.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l20.13"></a><span id="l20.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l20.14"></a><span id="l20.14"> );</span>
<a href="#l20.15"></a><span id="l20.15"> </span>
<a href="#l20.16"></a><span id="l20.16"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l20.17"></a><span id="l20.17"> </span>
<a href="#l20.18"></a><span id="l20.18"> var TIMEOUT_MODAL_DIALOG, CALENDARNAME, EVENTPATH, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l20.19"></a><span id="l20.19"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate;</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineat">@@ -37,23 +33,24 @@ function setupModule(module) {</span>
<a href="#l20.21"></a><span id="l20.21">     switchToView,</span>
<a href="#l20.22"></a><span id="l20.22">     goToDate,</span>
<a href="#l20.23"></a><span id="l20.23">     invokeEventDialog,</span>
<a href="#l20.24"></a><span id="l20.24">     viewForward,</span>
<a href="#l20.25"></a><span id="l20.25">     closeAllEventDialogs,</span>
<a href="#l20.26"></a><span id="l20.26">     deleteCalendars,</span>
<a href="#l20.27"></a><span id="l20.27">     createCalendar,</span>
<a href="#l20.28"></a><span id="l20.28">     menulistSelect,</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l20.30"></a><span id="l20.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l20.32"></a><span id="l20.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l20.33"></a><span id="l20.33"> </span>
<a href="#l20.34"></a><span id="l20.34" class="difflineminus">-  ({ REC_DLG_ACCEPT, REC_DLG_DAYS } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l20.35"></a><span id="l20.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l20.36"></a><span id="l20.36" class="difflineplus">+  ({ REC_DLG_ACCEPT, REC_DLG_DAYS } = ChromeUtils.import(</span>
<a href="#l20.37"></a><span id="l20.37" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l20.38"></a><span id="l20.38" class="difflineplus">+  ));</span>
<a href="#l20.39"></a><span id="l20.39"> </span>
<a href="#l20.40"></a><span id="l20.40" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l20.41"></a><span id="l20.41">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l20.42"></a><span id="l20.42">   // Rotate view.</span>
<a href="#l20.43"></a><span id="l20.43">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l20.44"></a><span id="l20.44">   controller.waitFor(() =&gt; eid(&quot;day-view&quot;).getNode().orient == &quot;horizontal&quot;);</span>
<a href="#l20.45"></a><span id="l20.45"> }</span>
<a href="#l20.46"></a><span id="l20.46"> </span>
<a href="#l20.47"></a><span id="l20.47"> function testWeeklyNRecurrence() {</span>
<a href="#l20.48"></a><span id="l20.48">   goToDate(controller, 2009, 1, 5);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l21.4"></a><span id="l21.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l21.5"></a><span id="l21.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l21.6"></a><span id="l21.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l21.7"></a><span id="l21.7"> </span>
<a href="#l21.8"></a><span id="l21.8" class="difflineminus">-var MODULE_NAME = &quot;testWeeklyUntilRecurrenceRotated&quot;;</span>
<a href="#l21.9"></a><span id="l21.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l21.10"></a><span id="l21.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l21.11"></a><span id="l21.11" class="difflineminus">-</span>
<a href="#l21.12"></a><span id="l21.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l21.13"></a><span id="l21.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l21.14"></a><span id="l21.14"> );</span>
<a href="#l21.15"></a><span id="l21.15"> </span>
<a href="#l21.16"></a><span id="l21.16"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l21.17"></a><span id="l21.17"> </span>
<a href="#l21.18"></a><span id="l21.18"> var SHORT_SLEEP, TIMEOUT_MODAL_DIALOG, CALENDARNAME, EVENTPATH, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l21.19"></a><span id="l21.19"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate;</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineat">@@ -39,25 +35,24 @@ function setupModule(module) {</span>
<a href="#l21.21"></a><span id="l21.21">     switchToView,</span>
<a href="#l21.22"></a><span id="l21.22">     goToDate,</span>
<a href="#l21.23"></a><span id="l21.23">     invokeEventDialog,</span>
<a href="#l21.24"></a><span id="l21.24">     viewForward,</span>
<a href="#l21.25"></a><span id="l21.25">     closeAllEventDialogs,</span>
<a href="#l21.26"></a><span id="l21.26">     deleteCalendars,</span>
<a href="#l21.27"></a><span id="l21.27">     createCalendar,</span>
<a href="#l21.28"></a><span id="l21.28">     menulistSelect,</span>
<a href="#l21.29"></a><span id="l21.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l21.30"></a><span id="l21.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l21.31"></a><span id="l21.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l21.32"></a><span id="l21.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l21.33"></a><span id="l21.33"> </span>
<a href="#l21.34"></a><span id="l21.34" class="difflineminus">-  ({ REC_DLG_DAYS, REC_DLG_ACCEPT, REC_DLG_UNTIL_INPUT } = collector.getModule(</span>
<a href="#l21.35"></a><span id="l21.35" class="difflineminus">-    &quot;item-editing-helpers&quot;</span>
<a href="#l21.36"></a><span id="l21.36" class="difflineplus">+  ({ REC_DLG_DAYS, REC_DLG_ACCEPT, REC_DLG_UNTIL_INPUT } = ChromeUtils.import(</span>
<a href="#l21.37"></a><span id="l21.37" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l21.38"></a><span id="l21.38">   ));</span>
<a href="#l21.39"></a><span id="l21.39" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l21.40"></a><span id="l21.40"> </span>
<a href="#l21.41"></a><span id="l21.41" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l21.42"></a><span id="l21.42">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l21.43"></a><span id="l21.43">   // Rotate view.</span>
<a href="#l21.44"></a><span id="l21.44">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l21.45"></a><span id="l21.45">   controller.waitFor(() =&gt; eid(&quot;day-view&quot;).getNode().orient == &quot;horizontal&quot;);</span>
<a href="#l21.46"></a><span id="l21.46"> }</span>
<a href="#l21.47"></a><span id="l21.47"> </span>
<a href="#l21.48"></a><span id="l21.48"> function testWeeklyUntilRecurrence() {</span>
<a href="#l21.49"></a><span id="l21.49">   goToDate(controller, 2009, 1, 5); // Monday</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l22.4"></a><span id="l22.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l22.5"></a><span id="l22.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l22.6"></a><span id="l22.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l22.7"></a><span id="l22.7"> </span>
<a href="#l22.8"></a><span id="l22.8" class="difflineminus">-var MODULE_NAME = &quot;testWeeklyWithExceptionRecurrenceRotated&quot;;</span>
<a href="#l22.9"></a><span id="l22.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l22.10"></a><span id="l22.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l22.11"></a><span id="l22.11" class="difflineminus">-</span>
<a href="#l22.12"></a><span id="l22.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l22.13"></a><span id="l22.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l22.14"></a><span id="l22.14"> );</span>
<a href="#l22.15"></a><span id="l22.15"> </span>
<a href="#l22.16"></a><span id="l22.16"> var TIMEOUT_MODAL_DIALOG, CALENDARNAME, EVENT_BOX, CANVAS_BOX;</span>
<a href="#l22.17"></a><span id="l22.17"> var DAY_VIEW, WEEK_VIEW, EVENTPATH;</span>
<a href="#l22.18"></a><span id="l22.18"> var helpersForController, handleOccurrencePrompt, switchToView, goToDate;</span>
<a href="#l22.19"></a><span id="l22.19"> var invokeEventDialog, viewForward, closeAllEventDialogs, deleteCalendars, createCalendar;</span>
<a href="#l22.20"></a><span id="l22.20" class="difflineat">@@ -38,29 +34,24 @@ function setupModule(module) {</span>
<a href="#l22.21"></a><span id="l22.21">     switchToView,</span>
<a href="#l22.22"></a><span id="l22.22">     goToDate,</span>
<a href="#l22.23"></a><span id="l22.23">     invokeEventDialog,</span>
<a href="#l22.24"></a><span id="l22.24">     viewForward,</span>
<a href="#l22.25"></a><span id="l22.25">     closeAllEventDialogs,</span>
<a href="#l22.26"></a><span id="l22.26">     deleteCalendars,</span>
<a href="#l22.27"></a><span id="l22.27">     createCalendar,</span>
<a href="#l22.28"></a><span id="l22.28">     menulistSelect,</span>
<a href="#l22.29"></a><span id="l22.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l22.30"></a><span id="l22.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l22.32"></a><span id="l22.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l22.33"></a><span id="l22.33"> </span>
<a href="#l22.34"></a><span id="l22.34" class="difflineminus">-  ({</span>
<a href="#l22.35"></a><span id="l22.35" class="difflineminus">-    REPEAT_DETAILS,</span>
<a href="#l22.36"></a><span id="l22.36" class="difflineminus">-    REC_DLG_ACCEPT,</span>
<a href="#l22.37"></a><span id="l22.37" class="difflineminus">-    REC_DLG_DAYS,</span>
<a href="#l22.38"></a><span id="l22.38" class="difflineminus">-    helpersForEditUI,</span>
<a href="#l22.39"></a><span id="l22.39" class="difflineminus">-    setData,</span>
<a href="#l22.40"></a><span id="l22.40" class="difflineminus">-  } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l22.41"></a><span id="l22.41" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l22.42"></a><span id="l22.42" class="difflineplus">+  ({ REPEAT_DETAILS, REC_DLG_ACCEPT, REC_DLG_DAYS, helpersForEditUI, setData } = ChromeUtils.import(</span>
<a href="#l22.43"></a><span id="l22.43" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l22.44"></a><span id="l22.44" class="difflineplus">+  ));</span>
<a href="#l22.45"></a><span id="l22.45"> </span>
<a href="#l22.46"></a><span id="l22.46" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l22.47"></a><span id="l22.47">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l22.48"></a><span id="l22.48">   // Rotate view.</span>
<a href="#l22.49"></a><span id="l22.49">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l22.50"></a><span id="l22.50">   controller.waitFor(() =&gt; eid(&quot;day-view&quot;).getNode().orient == &quot;horizontal&quot;);</span>
<a href="#l22.51"></a><span id="l22.51"> }</span>
<a href="#l22.52"></a><span id="l22.52"> </span>
<a href="#l22.53"></a><span id="l22.53"> function testWeeklyWithExceptionRecurrence() {</span>
<a href="#l22.54"></a><span id="l22.54">   goToDate(controller, 2009, 1, 5);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1">rename from calendar/test/mozmill/shared-modules/test-calendar-utils.js</span>
<a href="#l23.2"></a><span id="l23.2">rename to calendar/test/mozmill/shared-modules/CalendarUtils.jsm</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/test-calendar-utils.js</span>
<a href="#l23.4"></a><span id="l23.4" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/CalendarUtils.jsm</span>
<a href="#l23.5"></a><span id="l23.5" class="difflineat">@@ -1,22 +1,68 @@</span>
<a href="#l23.6"></a><span id="l23.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.7"></a><span id="l23.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.8"></a><span id="l23.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l23.9"></a><span id="l23.9"> </span>
<a href="#l23.10"></a><span id="l23.10" class="difflineminus">-var MODULE_NAME = &quot;calendar-utils&quot;;</span>
<a href="#l23.11"></a><span id="l23.11" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;pref-window-helpers&quot;];</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineplus">+  &quot;SHORT_SLEEP&quot;,</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineplus">+  &quot;MID_SLEEP&quot;,</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineplus">+  &quot;TIMEOUT_MODAL_DIALOG&quot;,</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineplus">+  &quot;CALENDARNAME&quot;,</span>
<a href="#l23.18"></a><span id="l23.18" class="difflineplus">+  &quot;CALENDAR_PANEL&quot;,</span>
<a href="#l23.19"></a><span id="l23.19" class="difflineplus">+  &quot;VIEWDECK&quot;,</span>
<a href="#l23.20"></a><span id="l23.20" class="difflineplus">+  &quot;DAY_VIEW&quot;,</span>
<a href="#l23.21"></a><span id="l23.21" class="difflineplus">+  &quot;WEEK_VIEW&quot;,</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineplus">+  &quot;DAYBOX&quot;,</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineplus">+  &quot;LABELDAYBOX&quot;,</span>
<a href="#l23.24"></a><span id="l23.24" class="difflineplus">+  &quot;MULTIWEEK_VIEW&quot;,</span>
<a href="#l23.25"></a><span id="l23.25" class="difflineplus">+  &quot;MONTH_VIEW&quot;,</span>
<a href="#l23.26"></a><span id="l23.26" class="difflineplus">+  &quot;TASK_VIEW&quot;,</span>
<a href="#l23.27"></a><span id="l23.27" class="difflineplus">+  &quot;MINIMONTH&quot;,</span>
<a href="#l23.28"></a><span id="l23.28" class="difflineplus">+  &quot;TODAY_BUTTON&quot;,</span>
<a href="#l23.29"></a><span id="l23.29" class="difflineplus">+  &quot;CALENDARLIST&quot;,</span>
<a href="#l23.30"></a><span id="l23.30" class="difflineplus">+  &quot;TODAY_PANE&quot;,</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineplus">+  &quot;AGENDA_LISTBOX&quot;,</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineplus">+  &quot;EVENTPATH&quot;,</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineplus">+  &quot;ALARM_ICON_PATH&quot;,</span>
<a href="#l23.34"></a><span id="l23.34" class="difflineplus">+  &quot;EVENT_BOX&quot;,</span>
<a href="#l23.35"></a><span id="l23.35" class="difflineplus">+  &quot;CANVAS_BOX&quot;,</span>
<a href="#l23.36"></a><span id="l23.36" class="difflineplus">+  &quot;ALLDAY&quot;,</span>
<a href="#l23.37"></a><span id="l23.37" class="difflineplus">+  &quot;helpersForController&quot;,</span>
<a href="#l23.38"></a><span id="l23.38" class="difflineplus">+  &quot;handleOccurrencePrompt&quot;,</span>
<a href="#l23.39"></a><span id="l23.39" class="difflineplus">+  &quot;switchToView&quot;,</span>
<a href="#l23.40"></a><span id="l23.40" class="difflineplus">+  &quot;goToDate&quot;,</span>
<a href="#l23.41"></a><span id="l23.41" class="difflineplus">+  &quot;invokeEventDialog&quot;,</span>
<a href="#l23.42"></a><span id="l23.42" class="difflineplus">+  &quot;getEventBoxPath&quot;,</span>
<a href="#l23.43"></a><span id="l23.43" class="difflineplus">+  &quot;getEventDetails&quot;,</span>
<a href="#l23.44"></a><span id="l23.44" class="difflineplus">+  &quot;checkAlarmIcon&quot;,</span>
<a href="#l23.45"></a><span id="l23.45" class="difflineplus">+  &quot;viewForward&quot;,</span>
<a href="#l23.46"></a><span id="l23.46" class="difflineplus">+  &quot;viewBack&quot;,</span>
<a href="#l23.47"></a><span id="l23.47" class="difflineplus">+  &quot;closeAllEventDialogs&quot;,</span>
<a href="#l23.48"></a><span id="l23.48" class="difflineplus">+  &quot;deleteCalendars&quot;,</span>
<a href="#l23.49"></a><span id="l23.49" class="difflineplus">+  &quot;createCalendar&quot;,</span>
<a href="#l23.50"></a><span id="l23.50" class="difflineplus">+  &quot;handleNewCalendarWizard&quot;,</span>
<a href="#l23.51"></a><span id="l23.51" class="difflineplus">+  &quot;findEventsInNode&quot;,</span>
<a href="#l23.52"></a><span id="l23.52" class="difflineplus">+  &quot;openLightningPrefs&quot;,</span>
<a href="#l23.53"></a><span id="l23.53" class="difflineplus">+  &quot;closeLightningPrefs&quot;,</span>
<a href="#l23.54"></a><span id="l23.54" class="difflineplus">+  &quot;menulistSelect&quot;,</span>
<a href="#l23.55"></a><span id="l23.55" class="difflineplus">+];</span>
<a href="#l23.56"></a><span id="l23.56"> </span>
<a href="#l23.57"></a><span id="l23.57" class="difflineplus">+var elementslib = ChromeUtils.import(&quot;chrome://mozmill/content/modules/elementslib.jsm&quot;);</span>
<a href="#l23.58"></a><span id="l23.58" class="difflineplus">+var mozmill = ChromeUtils.import(&quot;chrome://mozmill/content/modules/mozmill.jsm&quot;);</span>
<a href="#l23.59"></a><span id="l23.59" class="difflineplus">+var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l23.60"></a><span id="l23.60" class="difflineplus">+</span>
<a href="#l23.61"></a><span id="l23.61" class="difflineplus">+var { close_pref_tab, open_pref_tab } = ChromeUtils.import(</span>
<a href="#l23.62"></a><span id="l23.62" class="difflineplus">+  &quot;resource://testing-common/mozmill/PrefTabHelpers.jsm&quot;</span>
<a href="#l23.63"></a><span id="l23.63" class="difflineplus">+);</span>
<a href="#l23.64"></a><span id="l23.64"> var { close_window, plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l23.65"></a><span id="l23.65">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l23.66"></a><span id="l23.66"> );</span>
<a href="#l23.67"></a><span id="l23.67"> </span>
<a href="#l23.68"></a><span id="l23.68"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l23.69"></a><span id="l23.69" class="difflineminus">-var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l23.70"></a><span id="l23.70"> </span>
<a href="#l23.71"></a><span id="l23.71"> var SHORT_SLEEP = 100;</span>
<a href="#l23.72"></a><span id="l23.72"> var MID_SLEEP = 500;</span>
<a href="#l23.73"></a><span id="l23.73"> var TIMEOUT_MODAL_DIALOG = 30000;</span>
<a href="#l23.74"></a><span id="l23.74"> var CALENDARNAME = &quot;Mozmill&quot;;</span>
<a href="#l23.75"></a><span id="l23.75"> </span>
<a href="#l23.76"></a><span id="l23.76"> // These are used in EventBox lookup.</span>
<a href="#l23.77"></a><span id="l23.77"> var EVENT_BOX = 0; // Use when you need an event box.</span>
<a href="#l23.78"></a><span id="l23.78" class="difflineat">@@ -69,81 +115,27 @@ var EVENTPATH = `</span>
<a href="#l23.79"></a><span id="l23.79">     /{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;${CALENDARNAME.toLowerCase()}&quot;}</span>
<a href="#l23.80"></a><span id="l23.80"> `;</span>
<a href="#l23.81"></a><span id="l23.81"> // Used after &quot;${EVENTPATH}/${getEventDetails([view])}/&quot;.</span>
<a href="#l23.82"></a><span id="l23.82"> var ALARM_ICON_PATH = `</span>
<a href="#l23.83"></a><span id="l23.83">     anon({&quot;class&quot;:&quot;category-box-stack&quot;})/anon({&quot;align&quot;:&quot;center&quot;})/</span>
<a href="#l23.84"></a><span id="l23.84">     anon({&quot;class&quot;:&quot;alarm-icons-box&quot;})/anon({&quot;class&quot;:&quot;reminder-icon&quot;})</span>
<a href="#l23.85"></a><span id="l23.85"> `;</span>
<a href="#l23.86"></a><span id="l23.86"> </span>
<a href="#l23.87"></a><span id="l23.87" class="difflineminus">-var open_pref_tab, close_pref_tab;</span>
<a href="#l23.88"></a><span id="l23.88" class="difflineminus">-</span>
<a href="#l23.89"></a><span id="l23.89" class="difflineminus">-function setupModule(controller) {</span>
<a href="#l23.90"></a><span id="l23.90" class="difflineminus">-  // This setup is needed for pref-win-helpers. For some reason, the automatic</span>
<a href="#l23.91"></a><span id="l23.91" class="difflineminus">-  // loading of modules in shared modules does not setup the module correctly.</span>
<a href="#l23.92"></a><span id="l23.92" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).setupModule();</span>
<a href="#l23.93"></a><span id="l23.93" class="difflineminus">-</span>
<a href="#l23.94"></a><span id="l23.94" class="difflineminus">-  ({ open_pref_tab, close_pref_tab } = collector.getModule(&quot;pref-window-helpers&quot;));</span>
<a href="#l23.95"></a><span id="l23.95" class="difflineminus">-  collector.getModule(&quot;pref-window-helpers&quot;).setupModule();</span>
<a href="#l23.96"></a><span id="l23.96" class="difflineminus">-</span>
<a href="#l23.97"></a><span id="l23.97" class="difflineplus">+function setupModule() {</span>
<a href="#l23.98"></a><span id="l23.98">   // For our tests, we assume that Sunday is start of week.</span>
<a href="#l23.99"></a><span id="l23.99">   Services.prefs.setIntPref(&quot;calendar.week.start&quot;, 0);</span>
<a href="#l23.100"></a><span id="l23.100"> </span>
<a href="#l23.101"></a><span id="l23.101">   // We are in calendarTests, so we make sure, calendar-tab with day-view is displayed.</span>
<a href="#l23.102"></a><span id="l23.102" class="difflineplus">+  let controller = mozmill.getMail3PaneController();</span>
<a href="#l23.103"></a><span id="l23.103">   let { eid } = helpersForController(controller);</span>
<a href="#l23.104"></a><span id="l23.104">   controller.click(eid(&quot;calendar-tab-button&quot;));</span>
<a href="#l23.105"></a><span id="l23.105">   switchToView(controller, &quot;day&quot;);</span>
<a href="#l23.106"></a><span id="l23.106"> }</span>
<a href="#l23.107"></a><span id="l23.107" class="difflineminus">-</span>
<a href="#l23.108"></a><span id="l23.108" class="difflineminus">-function installInto(module) {</span>
<a href="#l23.109"></a><span id="l23.109" class="difflineminus">-  // Copy constants into module.</span>
<a href="#l23.110"></a><span id="l23.110" class="difflineminus">-  module.SHORT_SLEEP = SHORT_SLEEP;</span>
<a href="#l23.111"></a><span id="l23.111" class="difflineminus">-  module.MID_SLEEP = MID_SLEEP;</span>
<a href="#l23.112"></a><span id="l23.112" class="difflineminus">-  module.TIMEOUT_MODAL_DIALOG = TIMEOUT_MODAL_DIALOG;</span>
<a href="#l23.113"></a><span id="l23.113" class="difflineminus">-  module.CALENDARNAME = CALENDARNAME;</span>
<a href="#l23.114"></a><span id="l23.114" class="difflineminus">-  module.CALENDAR_PANEL = CALENDAR_PANEL;</span>
<a href="#l23.115"></a><span id="l23.115" class="difflineminus">-  module.VIEWDECK = VIEWDECK;</span>
<a href="#l23.116"></a><span id="l23.116" class="difflineminus">-  module.DAY_VIEW = DAY_VIEW;</span>
<a href="#l23.117"></a><span id="l23.117" class="difflineminus">-  module.WEEK_VIEW = WEEK_VIEW;</span>
<a href="#l23.118"></a><span id="l23.118" class="difflineminus">-  module.DAYBOX = DAYBOX;</span>
<a href="#l23.119"></a><span id="l23.119" class="difflineminus">-  module.LABELDAYBOX = LABELDAYBOX;</span>
<a href="#l23.120"></a><span id="l23.120" class="difflineminus">-  module.MULTIWEEK_VIEW = MULTIWEEK_VIEW;</span>
<a href="#l23.121"></a><span id="l23.121" class="difflineminus">-  module.MONTH_VIEW = MONTH_VIEW;</span>
<a href="#l23.122"></a><span id="l23.122" class="difflineminus">-  module.TASK_VIEW = TASK_VIEW;</span>
<a href="#l23.123"></a><span id="l23.123" class="difflineminus">-  module.MINIMONTH = MINIMONTH;</span>
<a href="#l23.124"></a><span id="l23.124" class="difflineminus">-  module.TODAY_BUTTON = TODAY_BUTTON;</span>
<a href="#l23.125"></a><span id="l23.125" class="difflineminus">-  module.CALENDARLIST = CALENDARLIST;</span>
<a href="#l23.126"></a><span id="l23.126" class="difflineminus">-  module.TODAY_PANE = TODAY_PANE;</span>
<a href="#l23.127"></a><span id="l23.127" class="difflineminus">-  module.AGENDA_LISTBOX = AGENDA_LISTBOX;</span>
<a href="#l23.128"></a><span id="l23.128" class="difflineminus">-  module.EVENTPATH = EVENTPATH;</span>
<a href="#l23.129"></a><span id="l23.129" class="difflineminus">-  module.ALARM_ICON_PATH = ALARM_ICON_PATH;</span>
<a href="#l23.130"></a><span id="l23.130" class="difflineminus">-  module.EVENT_BOX = EVENT_BOX;</span>
<a href="#l23.131"></a><span id="l23.131" class="difflineminus">-  module.CANVAS_BOX = CANVAS_BOX;</span>
<a href="#l23.132"></a><span id="l23.132" class="difflineminus">-  module.ALLDAY = ALLDAY;</span>
<a href="#l23.133"></a><span id="l23.133" class="difflineminus">-</span>
<a href="#l23.134"></a><span id="l23.134" class="difflineminus">-  // Now copy helper functions.</span>
<a href="#l23.135"></a><span id="l23.135" class="difflineminus">-  module.helpersForController = helpersForController;</span>
<a href="#l23.136"></a><span id="l23.136" class="difflineminus">-  module.handleOccurrencePrompt = handleOccurrencePrompt;</span>
<a href="#l23.137"></a><span id="l23.137" class="difflineminus">-  module.switchToView = switchToView;</span>
<a href="#l23.138"></a><span id="l23.138" class="difflineminus">-  module.goToDate = goToDate;</span>
<a href="#l23.139"></a><span id="l23.139" class="difflineminus">-  module.invokeEventDialog = invokeEventDialog;</span>
<a href="#l23.140"></a><span id="l23.140" class="difflineminus">-  module.getEventBoxPath = getEventBoxPath;</span>
<a href="#l23.141"></a><span id="l23.141" class="difflineminus">-  module.getEventDetails = getEventDetails;</span>
<a href="#l23.142"></a><span id="l23.142" class="difflineminus">-  module.checkAlarmIcon = checkAlarmIcon;</span>
<a href="#l23.143"></a><span id="l23.143" class="difflineminus">-  module.viewForward = viewForward;</span>
<a href="#l23.144"></a><span id="l23.144" class="difflineminus">-  module.viewBack = viewBack;</span>
<a href="#l23.145"></a><span id="l23.145" class="difflineminus">-  module.closeAllEventDialogs = closeAllEventDialogs;</span>
<a href="#l23.146"></a><span id="l23.146" class="difflineminus">-  module.deleteCalendars = deleteCalendars;</span>
<a href="#l23.147"></a><span id="l23.147" class="difflineminus">-  module.createCalendar = createCalendar;</span>
<a href="#l23.148"></a><span id="l23.148" class="difflineminus">-  module.handleNewCalendarWizard = handleNewCalendarWizard;</span>
<a href="#l23.149"></a><span id="l23.149" class="difflineminus">-  module.findEventsInNode = findEventsInNode;</span>
<a href="#l23.150"></a><span id="l23.150" class="difflineminus">-  module.openLightningPrefs = openLightningPrefs;</span>
<a href="#l23.151"></a><span id="l23.151" class="difflineminus">-  module.closeLightningPrefs = closeLightningPrefs;</span>
<a href="#l23.152"></a><span id="l23.152" class="difflineminus">-  module.menulistSelect = menulistSelect;</span>
<a href="#l23.153"></a><span id="l23.153" class="difflineminus">-}</span>
<a href="#l23.154"></a><span id="l23.154" class="difflineplus">+setupModule();</span>
<a href="#l23.155"></a><span id="l23.155"> </span>
<a href="#l23.156"></a><span id="l23.156"> function helpersForController(controller) {</span>
<a href="#l23.157"></a><span id="l23.157">   function selector(sel) {</span>
<a href="#l23.158"></a><span id="l23.158">     return sel.trim().replace(/\n(\s*)/g, &quot;&quot;);</span>
<a href="#l23.159"></a><span id="l23.159">   }</span>
<a href="#l23.160"></a><span id="l23.160"> </span>
<a href="#l23.161"></a><span id="l23.161">   return {</span>
<a href="#l23.162"></a><span id="l23.162">     lookup: sel =&gt; new elementslib.Lookup(controller.window.document, selector(sel)),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1">rename from calendar/test/mozmill/shared-modules/test-item-editing-helpers.js</span>
<a href="#l24.2"></a><span id="l24.2">rename to calendar/test/mozmill/shared-modules/ItemEditingHelpers.jsm</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/test-item-editing-helpers.js</span>
<a href="#l24.4"></a><span id="l24.4" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/ItemEditingHelpers.jsm</span>
<a href="#l24.5"></a><span id="l24.5" class="difflineat">@@ -1,38 +1,49 @@</span>
<a href="#l24.6"></a><span id="l24.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l24.7"></a><span id="l24.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l24.8"></a><span id="l24.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l24.9"></a><span id="l24.9"> </span>
<a href="#l24.10"></a><span id="l24.10" class="difflineminus">-var MODULE_NAME = &quot;item-editing-helpers&quot;;</span>
<a href="#l24.11"></a><span id="l24.11" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;];</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineplus">+  &quot;CATEGORY_LIST&quot;,</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineplus">+  &quot;REPEAT_DETAILS&quot;,</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineplus">+  &quot;EVENT_TABPANELS&quot;,</span>
<a href="#l24.17"></a><span id="l24.17" class="difflineplus">+  &quot;DESCRIPTION_TEXTBOX&quot;,</span>
<a href="#l24.18"></a><span id="l24.18" class="difflineplus">+  &quot;ATTENDEES_ROW&quot;,</span>
<a href="#l24.19"></a><span id="l24.19" class="difflineplus">+  &quot;PERCENT_COMPLETE_INPUT&quot;,</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineplus">+  &quot;DATE_INPUT&quot;,</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineplus">+  &quot;TIME_INPUT&quot;,</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineplus">+  &quot;REC_DLG_ACCEPT&quot;,</span>
<a href="#l24.23"></a><span id="l24.23" class="difflineplus">+  &quot;REC_DLG_DAYS&quot;,</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineplus">+  &quot;REC_DLG_UNTIL_INPUT&quot;,</span>
<a href="#l24.25"></a><span id="l24.25" class="difflineplus">+  &quot;helpersForEditUI&quot;,</span>
<a href="#l24.26"></a><span id="l24.26" class="difflineplus">+  &quot;setData&quot;,</span>
<a href="#l24.27"></a><span id="l24.27" class="difflineplus">+  &quot;setReminderMenulist&quot;,</span>
<a href="#l24.28"></a><span id="l24.28" class="difflineplus">+  &quot;setCategories&quot;,</span>
<a href="#l24.29"></a><span id="l24.29" class="difflineplus">+  &quot;handleAddingAttachment&quot;,</span>
<a href="#l24.30"></a><span id="l24.30" class="difflineplus">+  &quot;setTimezone&quot;,</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineplus">+];</span>
<a href="#l24.32"></a><span id="l24.32"> </span>
<a href="#l24.33"></a><span id="l24.33" class="difflineplus">+var elementslib = ChromeUtils.import(&quot;chrome://mozmill/content/modules/elementslib.jsm&quot;);</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineplus">+</span>
<a href="#l24.35"></a><span id="l24.35" class="difflineplus">+var {</span>
<a href="#l24.36"></a><span id="l24.36" class="difflineplus">+  helpersForController,</span>
<a href="#l24.37"></a><span id="l24.37" class="difflineplus">+  menulistSelect,</span>
<a href="#l24.38"></a><span id="l24.38" class="difflineplus">+  SHORT_SLEEP,</span>
<a href="#l24.39"></a><span id="l24.39" class="difflineplus">+  TIMEOUT_MODAL_DIALOG,</span>
<a href="#l24.40"></a><span id="l24.40" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;);</span>
<a href="#l24.41"></a><span id="l24.41" class="difflineplus">+var { mark_failure } = ChromeUtils.import(</span>
<a href="#l24.42"></a><span id="l24.42" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l24.43"></a><span id="l24.43" class="difflineplus">+);</span>
<a href="#l24.44"></a><span id="l24.44"> var { augment_controller, plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l24.45"></a><span id="l24.45">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l24.46"></a><span id="l24.46"> );</span>
<a href="#l24.47"></a><span id="l24.47"> </span>
<a href="#l24.48"></a><span id="l24.48"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l24.49"></a><span id="l24.49"> </span>
<a href="#l24.50"></a><span id="l24.50" class="difflineminus">-var SHORT_SLEEP, TIMEOUT_MODAL_DIALOG;</span>
<a href="#l24.51"></a><span id="l24.51" class="difflineminus">-var helpersForController, menulistSelect;</span>
<a href="#l24.52"></a><span id="l24.52" class="difflineminus">-var mark_failure;</span>
<a href="#l24.53"></a><span id="l24.53" class="difflineminus">-</span>
<a href="#l24.54"></a><span id="l24.54" class="difflineminus">-function setupModule(module) {</span>
<a href="#l24.55"></a><span id="l24.55" class="difflineminus">-  controller = mozmill.getMail3PaneController();</span>
<a href="#l24.56"></a><span id="l24.56" class="difflineminus">-  ({</span>
<a href="#l24.57"></a><span id="l24.57" class="difflineminus">-    SHORT_SLEEP,</span>
<a href="#l24.58"></a><span id="l24.58" class="difflineminus">-    TIMEOUT_MODAL_DIALOG,</span>
<a href="#l24.59"></a><span id="l24.59" class="difflineminus">-    helpersForController,</span>
<a href="#l24.60"></a><span id="l24.60" class="difflineminus">-    menulistSelect,</span>
<a href="#l24.61"></a><span id="l24.61" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l24.62"></a><span id="l24.62" class="difflineminus">-  Object.assign(module, helpersForController(controller));</span>
<a href="#l24.63"></a><span id="l24.63" class="difflineminus">-</span>
<a href="#l24.64"></a><span id="l24.64" class="difflineminus">-  ({ mark_failure } = collector.getModule(&quot;folder-display-helpers&quot;));</span>
<a href="#l24.65"></a><span id="l24.65" class="difflineminus">-}</span>
<a href="#l24.66"></a><span id="l24.66"> // Lookup paths and path-snippets.</span>
<a href="#l24.67"></a><span id="l24.67"> // These 5 have to be used with itemEditLookup().</span>
<a href="#l24.68"></a><span id="l24.68"> var CATEGORY_LIST = `</span>
<a href="#l24.69"></a><span id="l24.69">     id(&quot;event-grid&quot;)/id(&quot;event-grid-category-color-row&quot;)/id(&quot;event-grid-category-color-td&quot;)</span>
<a href="#l24.70"></a><span id="l24.70">     /id(&quot;item-categories&quot;)/id(&quot;item-categories-popup&quot;)</span>
<a href="#l24.71"></a><span id="l24.71"> `;</span>
<a href="#l24.72"></a><span id="l24.72"> var REPEAT_DETAILS = `</span>
<a href="#l24.73"></a><span id="l24.73">     id(&quot;event-grid&quot;)/id(&quot;event-grid-recurrence-row&quot;)/id(&quot;event-grid-recurrence-td&quot;)/id(&quot;event-grid-recurrence-picker-box&quot;)/</span>
<a href="#l24.74"></a><span id="l24.74" class="difflineat">@@ -73,38 +84,16 @@ var REC_DLG_DAYS = `</span>
<a href="#l24.75"></a><span id="l24.75">     {&quot;flex&quot;:&quot;1&quot;}/[1]/id(&quot;period-deck&quot;)/id(&quot;period-deck-weekly-box&quot;)/[1]/id(&quot;daypicker-weekday&quot;)</span>
<a href="#l24.76"></a><span id="l24.76"> `;</span>
<a href="#l24.77"></a><span id="l24.77"> var REC_DLG_UNTIL_INPUT = `</span>
<a href="#l24.78"></a><span id="l24.78">     /id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/</span>
<a href="#l24.79"></a><span id="l24.79">     id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-until-box&quot;)/id(&quot;repeat-until-date&quot;)/</span>
<a href="#l24.80"></a><span id="l24.80">     anon({&quot;class&quot;:&quot;datepicker-menulist&quot;})/{&quot;class&quot;:&quot;menulist-input&quot;}</span>
<a href="#l24.81"></a><span id="l24.81"> `;</span>
<a href="#l24.82"></a><span id="l24.82"> </span>
<a href="#l24.83"></a><span id="l24.83" class="difflineminus">-function installInto(module) {</span>
<a href="#l24.84"></a><span id="l24.84" class="difflineminus">-  // Copy constants into module.</span>
<a href="#l24.85"></a><span id="l24.85" class="difflineminus">-  module.CATEGORY_LIST = CATEGORY_LIST;</span>
<a href="#l24.86"></a><span id="l24.86" class="difflineminus">-  module.REPEAT_DETAILS = REPEAT_DETAILS;</span>
<a href="#l24.87"></a><span id="l24.87" class="difflineminus">-  module.EVENT_TABPANELS = EVENT_TABPANELS;</span>
<a href="#l24.88"></a><span id="l24.88" class="difflineminus">-  module.DESCRIPTION_TEXTBOX = DESCRIPTION_TEXTBOX;</span>
<a href="#l24.89"></a><span id="l24.89" class="difflineminus">-  module.ATTENDEES_ROW = ATTENDEES_ROW;</span>
<a href="#l24.90"></a><span id="l24.90" class="difflineminus">-  module.PERCENT_COMPLETE_INPUT = PERCENT_COMPLETE_INPUT;</span>
<a href="#l24.91"></a><span id="l24.91" class="difflineminus">-  module.DATE_INPUT = DATE_INPUT;</span>
<a href="#l24.92"></a><span id="l24.92" class="difflineminus">-  module.TIME_INPUT = TIME_INPUT;</span>
<a href="#l24.93"></a><span id="l24.93" class="difflineminus">-  module.REC_DLG_ACCEPT = REC_DLG_ACCEPT;</span>
<a href="#l24.94"></a><span id="l24.94" class="difflineminus">-  module.REC_DLG_DAYS = REC_DLG_DAYS;</span>
<a href="#l24.95"></a><span id="l24.95" class="difflineminus">-  module.REC_DLG_UNTIL_INPUT = REC_DLG_UNTIL_INPUT;</span>
<a href="#l24.96"></a><span id="l24.96" class="difflineminus">-  // Now copy helper functions.</span>
<a href="#l24.97"></a><span id="l24.97" class="difflineminus">-  module.helpersForEditUI = helpersForEditUI;</span>
<a href="#l24.98"></a><span id="l24.98" class="difflineminus">-  module.setData = setData;</span>
<a href="#l24.99"></a><span id="l24.99" class="difflineminus">-  module.setReminderMenulist = setReminderMenulist;</span>
<a href="#l24.100"></a><span id="l24.100" class="difflineminus">-  module.setCategories = setCategories;</span>
<a href="#l24.101"></a><span id="l24.101" class="difflineminus">-  module.handleAddingAttachment = handleAddingAttachment;</span>
<a href="#l24.102"></a><span id="l24.102" class="difflineminus">-  module.setTimezone = setTimezone;</span>
<a href="#l24.103"></a><span id="l24.103" class="difflineminus">-}</span>
<a href="#l24.104"></a><span id="l24.104" class="difflineminus">-</span>
<a href="#l24.105"></a><span id="l24.105"> function helpersForEditUI(controller) {</span>
<a href="#l24.106"></a><span id="l24.106">   function selector(sel) {</span>
<a href="#l24.107"></a><span id="l24.107">     return sel.trim().replace(/\n(\s*)/g, &quot;&quot;);</span>
<a href="#l24.108"></a><span id="l24.108">   }</span>
<a href="#l24.109"></a><span id="l24.109"> </span>
<a href="#l24.110"></a><span id="l24.110">   let isEvent = cal.item.isEvent(controller.window.calendarItem);</span>
<a href="#l24.111"></a><span id="l24.111"> </span>
<a href="#l24.112"></a><span id="l24.112">   let obj = {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/moz.build</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/moz.build</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -1,13 +1,9 @@</span>
<a href="#l25.4"></a><span id="l25.4"> # vim: set filetype=python:</span>
<a href="#l25.5"></a><span id="l25.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l25.6"></a><span id="l25.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l25.7"></a><span id="l25.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l25.8"></a><span id="l25.8"> </span>
<a href="#l25.9"></a><span id="l25.9" class="difflineminus">-# Copies the files in this folder to a staging directory in the objdir.</span>
<a href="#l25.10"></a><span id="l25.10" class="difflineminus">-# Files from mail/test/mozmill/shared-modules are copied into the same</span>
<a href="#l25.11"></a><span id="l25.11" class="difflineminus">-# directory to allow calendar tests to run. Due to an oddity in the</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-# build system, we can't use the same wildcard twice for a destination.</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">-TEST_HARNESS_FILES.mozmill.stage['shared-modules'] += [</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineminus">-    'test-calendar-utils.js',</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineminus">-    'test-item-editing-helpers.js',</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineplus">+TESTING_JS_MODULES.mozmill += [</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineplus">+    'CalendarUtils.jsm',</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineplus">+    'ItemEditingHelpers.jsm',</span>
<a href="#l25.19"></a><span id="l25.19"> ]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/calendar/test/mozmill/testBasicFunctionality.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/calendar/test/mozmill/testBasicFunctionality.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l26.4"></a><span id="l26.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l26.5"></a><span id="l26.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l26.6"></a><span id="l26.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l26.7"></a><span id="l26.7"> </span>
<a href="#l26.8"></a><span id="l26.8" class="difflineminus">-var MODULE_NAME = &quot;testBasicFunctionality&quot;;</span>
<a href="#l26.9"></a><span id="l26.9" class="difflineminus">-var RELATIVE_ROOT = &quot;./shared-modules&quot;;</span>
<a href="#l26.10"></a><span id="l26.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;];</span>
<a href="#l26.11"></a><span id="l26.11" class="difflineminus">-</span>
<a href="#l26.12"></a><span id="l26.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l26.13"></a><span id="l26.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l26.14"></a><span id="l26.14"> );</span>
<a href="#l26.15"></a><span id="l26.15"> </span>
<a href="#l26.16"></a><span id="l26.16"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l26.17"></a><span id="l26.17"> </span>
<a href="#l26.18"></a><span id="l26.18"> var TIMEOUT_MODAL_DIALOG, CALENDARNAME, CALENDAR_PANEL, DAY_VIEW, DAYBOX, MINIMONTH, CALENDARLIST;</span>
<a href="#l26.19"></a><span id="l26.19"> var helpersForController, switchToView, deleteCalendars, handleNewCalendarWizard;</span>
<a href="#l26.20"></a><span id="l26.20" class="difflineat">@@ -24,18 +20,17 @@ function setupModule(module) {</span>
<a href="#l26.21"></a><span id="l26.21">     DAY_VIEW,</span>
<a href="#l26.22"></a><span id="l26.22">     DAYBOX,</span>
<a href="#l26.23"></a><span id="l26.23">     MINIMONTH,</span>
<a href="#l26.24"></a><span id="l26.24">     CALENDARLIST,</span>
<a href="#l26.25"></a><span id="l26.25">     helpersForController,</span>
<a href="#l26.26"></a><span id="l26.26">     switchToView,</span>
<a href="#l26.27"></a><span id="l26.27">     deleteCalendars,</span>
<a href="#l26.28"></a><span id="l26.28">     handleNewCalendarWizard,</span>
<a href="#l26.29"></a><span id="l26.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l26.30"></a><span id="l26.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l26.32"></a><span id="l26.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l26.33"></a><span id="l26.33"> }</span>
<a href="#l26.34"></a><span id="l26.34"> </span>
<a href="#l26.35"></a><span id="l26.35"> function testSmokeTest() {</span>
<a href="#l26.36"></a><span id="l26.36">   let dateFormatter = cal.getDateFormatter();</span>
<a href="#l26.37"></a><span id="l26.37"> </span>
<a href="#l26.38"></a><span id="l26.38">   // Check for minimonth.</span>
<a href="#l26.39"></a><span id="l26.39">   controller.waitForElement(eid(&quot;calMinimonth&quot;));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/test/mozmill/testLocalICS.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/test/mozmill/testLocalICS.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l27.4"></a><span id="l27.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l27.5"></a><span id="l27.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l27.6"></a><span id="l27.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l27.7"></a><span id="l27.7"> </span>
<a href="#l27.8"></a><span id="l27.8" class="difflineminus">-var MODULE_NAME = &quot;testLocalICS&quot;;</span>
<a href="#l27.9"></a><span id="l27.9" class="difflineminus">-var RELATIVE_ROOT = &quot;./shared-modules&quot;;</span>
<a href="#l27.10"></a><span id="l27.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l27.11"></a><span id="l27.11" class="difflineminus">-</span>
<a href="#l27.12"></a><span id="l27.12"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l27.13"></a><span id="l27.13">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l27.14"></a><span id="l27.14"> );</span>
<a href="#l27.15"></a><span id="l27.15"> </span>
<a href="#l27.16"></a><span id="l27.16"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l27.17"></a><span id="l27.17"> </span>
<a href="#l27.18"></a><span id="l27.18"> var TIMEOUT_MODAL_DIALOG, CANVAS_BOX, EVENT_BOX;</span>
<a href="#l27.19"></a><span id="l27.19"> var helpersForController, invokeEventDialog, deleteCalendars, handleNewCalendarWizard;</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineat">@@ -25,23 +21,20 @@ function setupModule(module) {</span>
<a href="#l27.21"></a><span id="l27.21">   ({</span>
<a href="#l27.22"></a><span id="l27.22">     TIMEOUT_MODAL_DIALOG,</span>
<a href="#l27.23"></a><span id="l27.23">     CANVAS_BOX,</span>
<a href="#l27.24"></a><span id="l27.24">     EVENT_BOX,</span>
<a href="#l27.25"></a><span id="l27.25">     helpersForController,</span>
<a href="#l27.26"></a><span id="l27.26">     invokeEventDialog,</span>
<a href="#l27.27"></a><span id="l27.27">     deleteCalendars,</span>
<a href="#l27.28"></a><span id="l27.28">     handleNewCalendarWizard,</span>
<a href="#l27.29"></a><span id="l27.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l27.30"></a><span id="l27.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l27.31"></a><span id="l27.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l27.32"></a><span id="l27.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l27.33"></a><span id="l27.33"> </span>
<a href="#l27.34"></a><span id="l27.34" class="difflineminus">-  ({ setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l27.35"></a><span id="l27.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l27.36"></a><span id="l27.36" class="difflineminus">-</span>
<a href="#l27.37"></a><span id="l27.37" class="difflineplus">+  ({ setData } = ChromeUtils.import(&quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;));</span>
<a href="#l27.38"></a><span id="l27.38">   // Unique name needed as deleting a calendar only unsubscribes from it and</span>
<a href="#l27.39"></a><span id="l27.39">   // if same file were used on next testrun then previously created event</span>
<a href="#l27.40"></a><span id="l27.40">   // would show up.</span>
<a href="#l27.41"></a><span id="l27.41">   calendarName = calendarTitle = new Date().getTime() + &quot;&quot;;</span>
<a href="#l27.42"></a><span id="l27.42">   calendarFile = Services.dirsvc.get(&quot;TmpD&quot;, Ci.nsIFile);</span>
<a href="#l27.43"></a><span id="l27.43">   calendarFile.append(calendarName + &quot;.ics&quot;);</span>
<a href="#l27.44"></a><span id="l27.44"> }</span>
<a href="#l27.45"></a><span id="l27.45"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/test/mozmill/testTimezones.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/test/mozmill/testTimezones.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l28.4"></a><span id="l28.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l28.5"></a><span id="l28.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l28.6"></a><span id="l28.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l28.7"></a><span id="l28.7"> </span>
<a href="#l28.8"></a><span id="l28.8" class="difflineminus">-var MODULE_NAME = &quot;testTimezones&quot;;</span>
<a href="#l28.9"></a><span id="l28.9" class="difflineminus">-var RELATIVE_ROOT = &quot;./shared-modules&quot;;</span>
<a href="#l28.10"></a><span id="l28.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l28.11"></a><span id="l28.11" class="difflineminus">-</span>
<a href="#l28.12"></a><span id="l28.12"> var CANVAS_BOX, DAY_VIEW;</span>
<a href="#l28.13"></a><span id="l28.13"> var helpersForController, invokeEventDialog, switchToView, goToDate;</span>
<a href="#l28.14"></a><span id="l28.14"> var findEventsInNode, viewForward, viewBack;</span>
<a href="#l28.15"></a><span id="l28.15"> var setData;</span>
<a href="#l28.16"></a><span id="l28.16"> </span>
<a href="#l28.17"></a><span id="l28.17"> var DATES = [</span>
<a href="#l28.18"></a><span id="l28.18">   [2009, 1, 1],</span>
<a href="#l28.19"></a><span id="l28.19">   [2009, 4, 2],</span>
<a href="#l28.20"></a><span id="l28.20" class="difflineat">@@ -42,22 +38,20 @@ function setupModule(module) {</span>
<a href="#l28.21"></a><span id="l28.21">     DAY_VIEW,</span>
<a href="#l28.22"></a><span id="l28.22">     helpersForController,</span>
<a href="#l28.23"></a><span id="l28.23">     invokeEventDialog,</span>
<a href="#l28.24"></a><span id="l28.24">     switchToView,</span>
<a href="#l28.25"></a><span id="l28.25">     goToDate,</span>
<a href="#l28.26"></a><span id="l28.26">     findEventsInNode,</span>
<a href="#l28.27"></a><span id="l28.27">     viewForward,</span>
<a href="#l28.28"></a><span id="l28.28">     viewBack,</span>
<a href="#l28.29"></a><span id="l28.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l28.30"></a><span id="l28.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l28.32"></a><span id="l28.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l28.33"></a><span id="l28.33"> </span>
<a href="#l28.34"></a><span id="l28.34" class="difflineminus">-  ({ setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l28.35"></a><span id="l28.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l28.36"></a><span id="l28.36" class="difflineplus">+  ({ setData } = ChromeUtils.import(&quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;));</span>
<a href="#l28.37"></a><span id="l28.37"> }</span>
<a href="#l28.38"></a><span id="l28.38"> </span>
<a href="#l28.39"></a><span id="l28.39"> function testTimezones1_SetGMT() {</span>
<a href="#l28.40"></a><span id="l28.40">   Services.prefs.setStringPref(&quot;calendar.timezone.local&quot;, &quot;Europe/London&quot;);</span>
<a href="#l28.41"></a><span id="l28.41"> }</span>
<a href="#l28.42"></a><span id="l28.42"> </span>
<a href="#l28.43"></a><span id="l28.43"> function testTimezones2_CreateEvents() {</span>
<a href="#l28.44"></a><span id="l28.44">   goToDate(controller, 2009, 1, 1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/test/mozmill/testTodayPane.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/test/mozmill/testTodayPane.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l29.4"></a><span id="l29.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l29.5"></a><span id="l29.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l29.6"></a><span id="l29.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l29.7"></a><span id="l29.7"> </span>
<a href="#l29.8"></a><span id="l29.8" class="difflineminus">-var MODULE_NAME = &quot;testTodayPane&quot;;</span>
<a href="#l29.9"></a><span id="l29.9" class="difflineminus">-var RELATIVE_ROOT = &quot;./shared-modules&quot;;</span>
<a href="#l29.10"></a><span id="l29.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l29.11"></a><span id="l29.11" class="difflineminus">-</span>
<a href="#l29.12"></a><span id="l29.12"> var CALENDARNAME, CANVAS_BOX, DAY_VIEW, LABELDAYBOX, TODAY_BUTTON, TODAY_PANE, AGENDA_LISTBOX;</span>
<a href="#l29.13"></a><span id="l29.13"> var helpersForController, invokeEventDialog, viewForward, createCalendar;</span>
<a href="#l29.14"></a><span id="l29.14"> var deleteCalendars;</span>
<a href="#l29.15"></a><span id="l29.15"> var setData;</span>
<a href="#l29.16"></a><span id="l29.16"> </span>
<a href="#l29.17"></a><span id="l29.17"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l29.18"></a><span id="l29.18"> </span>
<a href="#l29.19"></a><span id="l29.19"> function setupModule(module) {</span>
<a href="#l29.20"></a><span id="l29.20" class="difflineat">@@ -23,23 +19,20 @@ function setupModule(module) {</span>
<a href="#l29.21"></a><span id="l29.21">     TODAY_BUTTON,</span>
<a href="#l29.22"></a><span id="l29.22">     TODAY_PANE,</span>
<a href="#l29.23"></a><span id="l29.23">     AGENDA_LISTBOX,</span>
<a href="#l29.24"></a><span id="l29.24">     helpersForController,</span>
<a href="#l29.25"></a><span id="l29.25">     invokeEventDialog,</span>
<a href="#l29.26"></a><span id="l29.26">     viewForward,</span>
<a href="#l29.27"></a><span id="l29.27">     createCalendar,</span>
<a href="#l29.28"></a><span id="l29.28">     deleteCalendars,</span>
<a href="#l29.29"></a><span id="l29.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l29.30"></a><span id="l29.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l29.31"></a><span id="l29.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l29.32"></a><span id="l29.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l29.33"></a><span id="l29.33"> </span>
<a href="#l29.34"></a><span id="l29.34" class="difflineminus">-  ({ setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l29.35"></a><span id="l29.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l29.36"></a><span id="l29.36" class="difflineminus">-</span>
<a href="#l29.37"></a><span id="l29.37" class="difflineplus">+  ({ setData } = ChromeUtils.import(&quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;));</span>
<a href="#l29.38"></a><span id="l29.38">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l29.39"></a><span id="l29.39"> }</span>
<a href="#l29.40"></a><span id="l29.40"> </span>
<a href="#l29.41"></a><span id="l29.41"> function testTodayPane() {</span>
<a href="#l29.42"></a><span id="l29.42">   let createEvent = (hour, name) =&gt; {</span>
<a href="#l29.43"></a><span id="l29.43">     let eventBox = lookupEventBox(&quot;day&quot;, CANVAS_BOX, null, 1, hour);</span>
<a href="#l29.44"></a><span id="l29.44">     invokeEventDialog(controller, eventBox, (event, iframe) =&gt; {</span>
<a href="#l29.45"></a><span id="l29.45">       let { eid: eventid } = helpersForController(event);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/calendar/test/mozmill/views/testDayView.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testDayView.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -1,20 +1,16 @@</span>
<a href="#l30.4"></a><span id="l30.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l30.5"></a><span id="l30.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l30.6"></a><span id="l30.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l30.7"></a><span id="l30.7"> </span>
<a href="#l30.8"></a><span id="l30.8" class="difflineminus">-var MODULE_NAME = &quot;testDayView&quot;;</span>
<a href="#l30.9"></a><span id="l30.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l30.10"></a><span id="l30.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l30.11"></a><span id="l30.11" class="difflineminus">-</span>
<a href="#l30.12"></a><span id="l30.12"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l30.13"></a><span id="l30.13"> </span>
<a href="#l30.14"></a><span id="l30.14"> var CALENDARNAME, CANVAS_BOX, EVENT_BOX, DAY_VIEW, LABELDAYBOX, EVENTPATH;</span>
<a href="#l30.15"></a><span id="l30.15" class="difflineminus">-var helpersForController, invokeEventDialog, getEventDetails, createCalendar;</span>
<a href="#l30.16"></a><span id="l30.16" class="difflineplus">+var helpersForController, switchToView, invokeEventDialog, getEventDetails, createCalendar;</span>
<a href="#l30.17"></a><span id="l30.17"> var closeAllEventDialogs, deleteCalendars, goToDate, lookupEventBox;</span>
<a href="#l30.18"></a><span id="l30.18"> var helpersForEditUI, setData;</span>
<a href="#l30.19"></a><span id="l30.19"> </span>
<a href="#l30.20"></a><span id="l30.20"> const TITLE1 = &quot;Day View Event&quot;;</span>
<a href="#l30.21"></a><span id="l30.21"> const TITLE2 = &quot;Day View Event Changed&quot;;</span>
<a href="#l30.22"></a><span id="l30.22"> const DESC = &quot;Day View Event Description&quot;;</span>
<a href="#l30.23"></a><span id="l30.23"> </span>
<a href="#l30.24"></a><span id="l30.24"> function setupModule(module) {</span>
<a href="#l30.25"></a><span id="l30.25" class="difflineat">@@ -22,36 +18,38 @@ function setupModule(module) {</span>
<a href="#l30.26"></a><span id="l30.26">   ({</span>
<a href="#l30.27"></a><span id="l30.27">     CALENDARNAME,</span>
<a href="#l30.28"></a><span id="l30.28">     CANVAS_BOX,</span>
<a href="#l30.29"></a><span id="l30.29">     EVENT_BOX,</span>
<a href="#l30.30"></a><span id="l30.30">     DAY_VIEW,</span>
<a href="#l30.31"></a><span id="l30.31">     LABELDAYBOX,</span>
<a href="#l30.32"></a><span id="l30.32">     EVENTPATH,</span>
<a href="#l30.33"></a><span id="l30.33">     helpersForController,</span>
<a href="#l30.34"></a><span id="l30.34" class="difflineplus">+    switchToView,</span>
<a href="#l30.35"></a><span id="l30.35">     invokeEventDialog,</span>
<a href="#l30.36"></a><span id="l30.36">     getEventDetails,</span>
<a href="#l30.37"></a><span id="l30.37">     createCalendar,</span>
<a href="#l30.38"></a><span id="l30.38">     closeAllEventDialogs,</span>
<a href="#l30.39"></a><span id="l30.39">     deleteCalendars,</span>
<a href="#l30.40"></a><span id="l30.40">     goToDate,</span>
<a href="#l30.41"></a><span id="l30.41">     lookupEventBox,</span>
<a href="#l30.42"></a><span id="l30.42" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l30.43"></a><span id="l30.43" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l30.44"></a><span id="l30.44" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l30.45"></a><span id="l30.45">   Object.assign(module, helpersForController(controller));</span>
<a href="#l30.46"></a><span id="l30.46"> </span>
<a href="#l30.47"></a><span id="l30.47" class="difflineminus">-  ({ helpersForEditUI, setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l30.48"></a><span id="l30.48" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l30.49"></a><span id="l30.49" class="difflineplus">+  ({ helpersForEditUI, setData } = ChromeUtils.import(</span>
<a href="#l30.50"></a><span id="l30.50" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l30.51"></a><span id="l30.51" class="difflineplus">+  ));</span>
<a href="#l30.52"></a><span id="l30.52"> </span>
<a href="#l30.53"></a><span id="l30.53">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l30.54"></a><span id="l30.54"> }</span>
<a href="#l30.55"></a><span id="l30.55"> </span>
<a href="#l30.56"></a><span id="l30.56"> function testDayView() {</span>
<a href="#l30.57"></a><span id="l30.57">   let dateFormatter = cal.getDateFormatter();</span>
<a href="#l30.58"></a><span id="l30.58"> </span>
<a href="#l30.59"></a><span id="l30.59" class="difflineplus">+  switchToView(controller, &quot;day&quot;);</span>
<a href="#l30.60"></a><span id="l30.60">   goToDate(controller, 2009, 1, 1);</span>
<a href="#l30.61"></a><span id="l30.61"> </span>
<a href="#l30.62"></a><span id="l30.62">   // Verify date in view.</span>
<a href="#l30.63"></a><span id="l30.63">   let day = lookup(`${DAY_VIEW}/${LABELDAYBOX}/{&quot;flex&quot;:&quot;1&quot;}`);</span>
<a href="#l30.64"></a><span id="l30.64">   controller.waitFor(() =&gt; day.getNode().mDate.icalString == &quot;20090101&quot;);</span>
<a href="#l30.65"></a><span id="l30.65"> </span>
<a href="#l30.66"></a><span id="l30.66">   // Create event at 8 AM.</span>
<a href="#l30.67"></a><span id="l30.67">   let eventBox = lookupEventBox(&quot;day&quot;, CANVAS_BOX, null, 1, 8);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/calendar/test/mozmill/views/testMonthView.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testMonthView.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l31.4"></a><span id="l31.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l31.5"></a><span id="l31.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l31.6"></a><span id="l31.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l31.7"></a><span id="l31.7"> </span>
<a href="#l31.8"></a><span id="l31.8" class="difflineminus">-var MODULE_NAME = &quot;testMonthView&quot;;</span>
<a href="#l31.9"></a><span id="l31.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l31.10"></a><span id="l31.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l31.11"></a><span id="l31.11" class="difflineminus">-</span>
<a href="#l31.12"></a><span id="l31.12"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l31.13"></a><span id="l31.13"> </span>
<a href="#l31.14"></a><span id="l31.14"> var CALENDARNAME, CANVAS_BOX, MONTH_VIEW, EVENTPATH;</span>
<a href="#l31.15"></a><span id="l31.15"> var helpersForController, switchToView, invokeEventDialog, getEventDetails, createCalendar;</span>
<a href="#l31.16"></a><span id="l31.16"> var closeAllEventDialogs, deleteCalendars, goToDate, lookupEventBox;</span>
<a href="#l31.17"></a><span id="l31.17"> var helpersForEditUI, setData;</span>
<a href="#l31.18"></a><span id="l31.18"> </span>
<a href="#l31.19"></a><span id="l31.19"> const TITLE1 = &quot;Month View Event&quot;;</span>
<a href="#l31.20"></a><span id="l31.20" class="difflineat">@@ -28,23 +24,22 @@ function setupModule(module) {</span>
<a href="#l31.21"></a><span id="l31.21">     switchToView,</span>
<a href="#l31.22"></a><span id="l31.22">     invokeEventDialog,</span>
<a href="#l31.23"></a><span id="l31.23">     getEventDetails,</span>
<a href="#l31.24"></a><span id="l31.24">     createCalendar,</span>
<a href="#l31.25"></a><span id="l31.25">     closeAllEventDialogs,</span>
<a href="#l31.26"></a><span id="l31.26">     deleteCalendars,</span>
<a href="#l31.27"></a><span id="l31.27">     goToDate,</span>
<a href="#l31.28"></a><span id="l31.28">     lookupEventBox,</span>
<a href="#l31.29"></a><span id="l31.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l31.30"></a><span id="l31.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l31.31"></a><span id="l31.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l31.32"></a><span id="l31.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l31.33"></a><span id="l31.33"> </span>
<a href="#l31.34"></a><span id="l31.34" class="difflineminus">-  ({ helpersForEditUI, setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l31.35"></a><span id="l31.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l31.36"></a><span id="l31.36" class="difflineminus">-</span>
<a href="#l31.37"></a><span id="l31.37" class="difflineplus">+  ({ helpersForEditUI, setData } = ChromeUtils.import(</span>
<a href="#l31.38"></a><span id="l31.38" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l31.39"></a><span id="l31.39" class="difflineplus">+  ));</span>
<a href="#l31.40"></a><span id="l31.40">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l31.41"></a><span id="l31.41"> }</span>
<a href="#l31.42"></a><span id="l31.42"> </span>
<a href="#l31.43"></a><span id="l31.43"> function testMonthView() {</span>
<a href="#l31.44"></a><span id="l31.44">   let dateFormatter = cal.getDateFormatter();</span>
<a href="#l31.45"></a><span id="l31.45"> </span>
<a href="#l31.46"></a><span id="l31.46">   switchToView(controller, &quot;month&quot;);</span>
<a href="#l31.47"></a><span id="l31.47">   goToDate(controller, 2009, 1, 1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/calendar/test/mozmill/views/testMultiweekView.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testMultiweekView.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l32.4"></a><span id="l32.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l32.5"></a><span id="l32.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l32.6"></a><span id="l32.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l32.7"></a><span id="l32.7"> </span>
<a href="#l32.8"></a><span id="l32.8" class="difflineminus">-var MODULE_NAME = &quot;testMultiweekView&quot;;</span>
<a href="#l32.9"></a><span id="l32.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l32.10"></a><span id="l32.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l32.11"></a><span id="l32.11" class="difflineminus">-</span>
<a href="#l32.12"></a><span id="l32.12"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l32.13"></a><span id="l32.13"> </span>
<a href="#l32.14"></a><span id="l32.14"> var CALENDARNAME, CANVAS_BOX, MULTIWEEK_VIEW, EVENTPATH;</span>
<a href="#l32.15"></a><span id="l32.15"> var helpersForController, switchToView, invokeEventDialog, getEventDetails, createCalendar;</span>
<a href="#l32.16"></a><span id="l32.16"> var closeAllEventDialogs, deleteCalendars, goToDate, lookupEventBox;</span>
<a href="#l32.17"></a><span id="l32.17"> var helpersForEditUI, setData;</span>
<a href="#l32.18"></a><span id="l32.18"> </span>
<a href="#l32.19"></a><span id="l32.19"> const TITLE1 = &quot;Multiweek View Event&quot;;</span>
<a href="#l32.20"></a><span id="l32.20" class="difflineat">@@ -28,23 +24,22 @@ function setupModule(module) {</span>
<a href="#l32.21"></a><span id="l32.21">     switchToView,</span>
<a href="#l32.22"></a><span id="l32.22">     invokeEventDialog,</span>
<a href="#l32.23"></a><span id="l32.23">     getEventDetails,</span>
<a href="#l32.24"></a><span id="l32.24">     createCalendar,</span>
<a href="#l32.25"></a><span id="l32.25">     closeAllEventDialogs,</span>
<a href="#l32.26"></a><span id="l32.26">     deleteCalendars,</span>
<a href="#l32.27"></a><span id="l32.27">     goToDate,</span>
<a href="#l32.28"></a><span id="l32.28">     lookupEventBox,</span>
<a href="#l32.29"></a><span id="l32.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l32.30"></a><span id="l32.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l32.31"></a><span id="l32.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l32.32"></a><span id="l32.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l32.33"></a><span id="l32.33"> </span>
<a href="#l32.34"></a><span id="l32.34" class="difflineminus">-  ({ helpersForEditUI, setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l32.35"></a><span id="l32.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l32.36"></a><span id="l32.36" class="difflineminus">-</span>
<a href="#l32.37"></a><span id="l32.37" class="difflineplus">+  ({ helpersForEditUI, setData } = ChromeUtils.import(</span>
<a href="#l32.38"></a><span id="l32.38" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l32.39"></a><span id="l32.39" class="difflineplus">+  ));</span>
<a href="#l32.40"></a><span id="l32.40">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l32.41"></a><span id="l32.41"> }</span>
<a href="#l32.42"></a><span id="l32.42"> </span>
<a href="#l32.43"></a><span id="l32.43"> function testMultiWeekView() {</span>
<a href="#l32.44"></a><span id="l32.44">   let dateFormatter = cal.getDateFormatter();</span>
<a href="#l32.45"></a><span id="l32.45"> </span>
<a href="#l32.46"></a><span id="l32.46">   switchToView(controller, &quot;multiweek&quot;);</span>
<a href="#l32.47"></a><span id="l32.47">   goToDate(controller, 2009, 1, 1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/test/mozmill/views/testTaskView.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testTaskView.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l33.4"></a><span id="l33.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l33.5"></a><span id="l33.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l33.6"></a><span id="l33.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l33.7"></a><span id="l33.7"> </span>
<a href="#l33.8"></a><span id="l33.8" class="difflineminus">-var MODULE_NAME = &quot;testTaskView&quot;;</span>
<a href="#l33.9"></a><span id="l33.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l33.10"></a><span id="l33.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;];</span>
<a href="#l33.11"></a><span id="l33.11" class="difflineminus">-</span>
<a href="#l33.12"></a><span id="l33.12"> var CALENDARNAME, CALENDARLIST, TASK_VIEW;</span>
<a href="#l33.13"></a><span id="l33.13"> var helpersForController, invokeEventDialog, createCalendar, closeAllEventDialogs, deleteCalendars;</span>
<a href="#l33.14"></a><span id="l33.14"> var setData;</span>
<a href="#l33.15"></a><span id="l33.15"> </span>
<a href="#l33.16"></a><span id="l33.16"> const TITLE = &quot;Task&quot;;</span>
<a href="#l33.17"></a><span id="l33.17"> const DESCRIPTION = &quot;1. Do A\n2. Do B&quot;;</span>
<a href="#l33.18"></a><span id="l33.18"> const PERCENTCOMPLETE = &quot;50&quot;;</span>
<a href="#l33.19"></a><span id="l33.19"> var CALENDARID;</span>
<a href="#l33.20"></a><span id="l33.20" class="difflineat">@@ -21,23 +17,20 @@ function setupModule(module) {</span>
<a href="#l33.21"></a><span id="l33.21">     CALENDARNAME,</span>
<a href="#l33.22"></a><span id="l33.22">     CALENDARLIST,</span>
<a href="#l33.23"></a><span id="l33.23">     TASK_VIEW,</span>
<a href="#l33.24"></a><span id="l33.24">     helpersForController,</span>
<a href="#l33.25"></a><span id="l33.25">     invokeEventDialog,</span>
<a href="#l33.26"></a><span id="l33.26">     createCalendar,</span>
<a href="#l33.27"></a><span id="l33.27">     closeAllEventDialogs,</span>
<a href="#l33.28"></a><span id="l33.28">     deleteCalendars,</span>
<a href="#l33.29"></a><span id="l33.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l33.30"></a><span id="l33.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l33.32"></a><span id="l33.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l33.33"></a><span id="l33.33"> </span>
<a href="#l33.34"></a><span id="l33.34" class="difflineminus">-  ({ setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l33.35"></a><span id="l33.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l33.36"></a><span id="l33.36" class="difflineminus">-</span>
<a href="#l33.37"></a><span id="l33.37" class="difflineplus">+  ({ setData } = ChromeUtils.import(&quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;));</span>
<a href="#l33.38"></a><span id="l33.38">   CALENDARID = createCalendar(controller, CALENDARNAME);</span>
<a href="#l33.39"></a><span id="l33.39"> }</span>
<a href="#l33.40"></a><span id="l33.40"> </span>
<a href="#l33.41"></a><span id="l33.41"> // Mozmill doesn't support trees yet, therefore completed checkbox and line-through style are not</span>
<a href="#l33.42"></a><span id="l33.42"> // checked.</span>
<a href="#l33.43"></a><span id="l33.43"> function testTaskView() {</span>
<a href="#l33.44"></a><span id="l33.44">   // paths</span>
<a href="#l33.45"></a><span id="l33.45">   let treeChildren = `${TASK_VIEW}/[1]/id(&quot;calendar-task-tree&quot;)/{&quot;class&quot;:&quot;calendar-task-treechildren&quot;}`;</span>
<a href="#l33.46"></a><span id="l33.46" class="difflineat">@@ -148,14 +141,17 @@ function testTaskView() {</span>
<a href="#l33.47"></a><span id="l33.47">   sleep();</span>
<a href="#l33.48"></a><span id="l33.48"> </span>
<a href="#l33.49"></a><span id="l33.49">   toolTipNode.ownerGlobal.showToolTip(toolTipNode, taskTreeNode.getTaskAtRow(0));</span>
<a href="#l33.50"></a><span id="l33.50">   controller.assertJSProperty(toolTipStatus, &quot;textContent&quot;, &quot;Completed&quot;);</span>
<a href="#l33.51"></a><span id="l33.51"> </span>
<a href="#l33.52"></a><span id="l33.52">   // Delete task and verify.</span>
<a href="#l33.53"></a><span id="l33.53">   controller.click(eid(&quot;calendar-delete-task-button&quot;));</span>
<a href="#l33.54"></a><span id="l33.54">   controller.waitFor(() =&gt; taskTreeNode.mTaskArray.length == 0, &quot;Task did not delete&quot;);</span>
<a href="#l33.55"></a><span id="l33.55" class="difflineplus">+</span>
<a href="#l33.56"></a><span id="l33.56" class="difflineplus">+  let tabmail = controller.window.document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l33.57"></a><span id="l33.57" class="difflineplus">+  tabmail.closeTab(tabmail.currentTabInfo);</span>
<a href="#l33.58"></a><span id="l33.58"> }</span>
<a href="#l33.59"></a><span id="l33.59"> </span>
<a href="#l33.60"></a><span id="l33.60"> function teardownModule(module) {</span>
<a href="#l33.61"></a><span id="l33.61">   deleteCalendars(controller, CALENDARNAME);</span>
<a href="#l33.62"></a><span id="l33.62">   closeAllEventDialogs();</span>
<a href="#l33.63"></a><span id="l33.63"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/test/mozmill/views/testWeekView.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testWeekView.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -1,16 +1,12 @@</span>
<a href="#l34.4"></a><span id="l34.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l34.5"></a><span id="l34.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l34.6"></a><span id="l34.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l34.7"></a><span id="l34.7"> </span>
<a href="#l34.8"></a><span id="l34.8" class="difflineminus">-var MODULE_NAME = &quot;testWeekView&quot;;</span>
<a href="#l34.9"></a><span id="l34.9" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l34.10"></a><span id="l34.10" class="difflineminus">-var MODULE_REQUIRES = [&quot;calendar-utils&quot;, &quot;item-editing-helpers&quot;];</span>
<a href="#l34.11"></a><span id="l34.11" class="difflineminus">-</span>
<a href="#l34.12"></a><span id="l34.12"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l34.13"></a><span id="l34.13"> </span>
<a href="#l34.14"></a><span id="l34.14"> var CALENDARNAME, CANVAS_BOX, EVENT_BOX, WEEK_VIEW, EVENTPATH;</span>
<a href="#l34.15"></a><span id="l34.15"> var helpersForController, switchToView, invokeEventDialog, getEventDetails, createCalendar;</span>
<a href="#l34.16"></a><span id="l34.16"> var closeAllEventDialogs, deleteCalendars, goToDate, lookupEventBox;</span>
<a href="#l34.17"></a><span id="l34.17"> var helpersForEditUI, setData;</span>
<a href="#l34.18"></a><span id="l34.18"> </span>
<a href="#l34.19"></a><span id="l34.19"> var TITLE1 = &quot;Week View Event&quot;;</span>
<a href="#l34.20"></a><span id="l34.20" class="difflineat">@@ -29,23 +25,22 @@ function setupModule(module) {</span>
<a href="#l34.21"></a><span id="l34.21">     switchToView,</span>
<a href="#l34.22"></a><span id="l34.22">     invokeEventDialog,</span>
<a href="#l34.23"></a><span id="l34.23">     getEventDetails,</span>
<a href="#l34.24"></a><span id="l34.24">     createCalendar,</span>
<a href="#l34.25"></a><span id="l34.25">     closeAllEventDialogs,</span>
<a href="#l34.26"></a><span id="l34.26">     deleteCalendars,</span>
<a href="#l34.27"></a><span id="l34.27">     goToDate,</span>
<a href="#l34.28"></a><span id="l34.28">     lookupEventBox,</span>
<a href="#l34.29"></a><span id="l34.29" class="difflineminus">-  } = collector.getModule(&quot;calendar-utils&quot;));</span>
<a href="#l34.30"></a><span id="l34.30" class="difflineminus">-  collector.getModule(&quot;calendar-utils&quot;).setupModule(controller);</span>
<a href="#l34.31"></a><span id="l34.31" class="difflineplus">+  } = ChromeUtils.import(&quot;resource://testing-common/mozmill/CalendarUtils.jsm&quot;));</span>
<a href="#l34.32"></a><span id="l34.32">   Object.assign(module, helpersForController(controller));</span>
<a href="#l34.33"></a><span id="l34.33"> </span>
<a href="#l34.34"></a><span id="l34.34" class="difflineminus">-  ({ helpersForEditUI, setData } = collector.getModule(&quot;item-editing-helpers&quot;));</span>
<a href="#l34.35"></a><span id="l34.35" class="difflineminus">-  collector.getModule(&quot;item-editing-helpers&quot;).setupModule(module);</span>
<a href="#l34.36"></a><span id="l34.36" class="difflineminus">-</span>
<a href="#l34.37"></a><span id="l34.37" class="difflineplus">+  ({ helpersForEditUI, setData } = ChromeUtils.import(</span>
<a href="#l34.38"></a><span id="l34.38" class="difflineplus">+    &quot;resource://testing-common/mozmill/ItemEditingHelpers.jsm&quot;</span>
<a href="#l34.39"></a><span id="l34.39" class="difflineplus">+  ));</span>
<a href="#l34.40"></a><span id="l34.40">   createCalendar(controller, CALENDARNAME);</span>
<a href="#l34.41"></a><span id="l34.41"> }</span>
<a href="#l34.42"></a><span id="l34.42"> </span>
<a href="#l34.43"></a><span id="l34.43"> function testWeekView() {</span>
<a href="#l34.44"></a><span id="l34.44">   let dateFormatter = cal.getDateFormatter();</span>
<a href="#l34.45"></a><span id="l34.45"> </span>
<a href="#l34.46"></a><span id="l34.46">   switchToView(controller, &quot;week&quot;);</span>
<a href="#l34.47"></a><span id="l34.47">   goToDate(controller, 2009, 1, 1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mail/test/mozmill/account/test-ab-whitelist.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-ab-whitelist.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -1,42 +1,51 @@</span>
<a href="#l35.4"></a><span id="l35.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l35.5"></a><span id="l35.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l35.6"></a><span id="l35.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l35.7"></a><span id="l35.7"> </span>
<a href="#l35.8"></a><span id="l35.8"> &quot;use strict&quot;;</span>
<a href="#l35.9"></a><span id="l35.9"> </span>
<a href="#l35.10"></a><span id="l35.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-account-manager-helpers.js */</span>
<a href="#l35.11"></a><span id="l35.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineminus">-var MODULE_NAME = &quot;test-ab-whitelist&quot;;</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l35.15"></a><span id="l35.15" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;account-manager-helpers&quot;];</span>
<a href="#l35.16"></a><span id="l35.16" class="difflineminus">-</span>
<a href="#l35.17"></a><span id="l35.17"> var mozmill = ChromeUtils.import(</span>
<a href="#l35.18"></a><span id="l35.18">   &quot;chrome://mozmill/content/modules/mozmill.jsm&quot;</span>
<a href="#l35.19"></a><span id="l35.19"> );</span>
<a href="#l35.20"></a><span id="l35.20"> var controller = ChromeUtils.import(</span>
<a href="#l35.21"></a><span id="l35.21">   &quot;chrome://mozmill/content/modules/controller.jsm&quot;</span>
<a href="#l35.22"></a><span id="l35.22"> );</span>
<a href="#l35.23"></a><span id="l35.23"> var elib = ChromeUtils.import(</span>
<a href="#l35.24"></a><span id="l35.24">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l35.25"></a><span id="l35.25"> );</span>
<a href="#l35.26"></a><span id="l35.26"> </span>
<a href="#l35.27"></a><span id="l35.27" class="difflineplus">+var {</span>
<a href="#l35.28"></a><span id="l35.28" class="difflineplus">+  click_account_tree_row,</span>
<a href="#l35.29"></a><span id="l35.29" class="difflineplus">+  get_account_tree_row,</span>
<a href="#l35.30"></a><span id="l35.30" class="difflineplus">+  open_advanced_settings,</span>
<a href="#l35.31"></a><span id="l35.31" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l35.32"></a><span id="l35.32" class="difflineplus">+  &quot;resource://testing-common/mozmill/AccountManagerHelpers.jsm&quot;</span>
<a href="#l35.33"></a><span id="l35.33" class="difflineplus">+);</span>
<a href="#l35.34"></a><span id="l35.34" class="difflineplus">+var {</span>
<a href="#l35.35"></a><span id="l35.35" class="difflineplus">+  assert_equals,</span>
<a href="#l35.36"></a><span id="l35.36" class="difflineplus">+  assert_false,</span>
<a href="#l35.37"></a><span id="l35.37" class="difflineplus">+  assert_true,</span>
<a href="#l35.38"></a><span id="l35.38" class="difflineplus">+  FAKE_SERVER_HOSTNAME,</span>
<a href="#l35.39"></a><span id="l35.39" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l35.40"></a><span id="l35.40" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l35.41"></a><span id="l35.41" class="difflineplus">+);</span>
<a href="#l35.42"></a><span id="l35.42" class="difflineplus">+</span>
<a href="#l35.43"></a><span id="l35.43" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l35.44"></a><span id="l35.44" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l35.45"></a><span id="l35.45" class="difflineplus">+);</span>
<a href="#l35.46"></a><span id="l35.46" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l35.47"></a><span id="l35.47" class="difflineplus">+</span>
<a href="#l35.48"></a><span id="l35.48"> var gOldWhiteList = null;</span>
<a href="#l35.49"></a><span id="l35.49"> var gKeyString = null;</span>
<a href="#l35.50"></a><span id="l35.50"> </span>
<a href="#l35.51"></a><span id="l35.51"> var gAccount = null;</span>
<a href="#l35.52"></a><span id="l35.52"> </span>
<a href="#l35.53"></a><span id="l35.53"> function setupModule(module) {</span>
<a href="#l35.54"></a><span id="l35.54" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l35.55"></a><span id="l35.55" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l35.56"></a><span id="l35.56" class="difflineminus">-  let amh = collector.getModule(&quot;account-manager-helpers&quot;);</span>
<a href="#l35.57"></a><span id="l35.57" class="difflineminus">-  amh.installInto(module);</span>
<a href="#l35.58"></a><span id="l35.58" class="difflineminus">-</span>
<a href="#l35.59"></a><span id="l35.59">   let server = MailServices.accounts.FindServer(</span>
<a href="#l35.60"></a><span id="l35.60">     &quot;tinderbox&quot;,</span>
<a href="#l35.61"></a><span id="l35.61">     FAKE_SERVER_HOSTNAME,</span>
<a href="#l35.62"></a><span id="l35.62">     &quot;pop3&quot;</span>
<a href="#l35.63"></a><span id="l35.63">   );</span>
<a href="#l35.64"></a><span id="l35.64">   gAccount = MailServices.accounts.FindAccountForServer(server);</span>
<a href="#l35.65"></a><span id="l35.65">   let serverKey = server.key;</span>
<a href="#l35.66"></a><span id="l35.66"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mail/test/mozmill/account/test-account-actions.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-account-actions.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -1,27 +1,39 @@</span>
<a href="#l36.4"></a><span id="l36.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l36.5"></a><span id="l36.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l36.6"></a><span id="l36.6">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l36.7"></a><span id="l36.7"> </span>
<a href="#l36.8"></a><span id="l36.8"> &quot;use strict&quot;;</span>
<a href="#l36.9"></a><span id="l36.9"> </span>
<a href="#l36.10"></a><span id="l36.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-account-manager-helpers.js */</span>
<a href="#l36.11"></a><span id="l36.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineplus">+var {</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+  click_account_tree_row,</span>
<a href="#l36.14"></a><span id="l36.14" class="difflineplus">+  get_account_tree_row,</span>
<a href="#l36.15"></a><span id="l36.15" class="difflineplus">+  open_advanced_settings,</span>
<a href="#l36.16"></a><span id="l36.16" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l36.17"></a><span id="l36.17" class="difflineplus">+  &quot;resource://testing-common/mozmill/AccountManagerHelpers.jsm&quot;</span>
<a href="#l36.18"></a><span id="l36.18" class="difflineplus">+);</span>
<a href="#l36.19"></a><span id="l36.19" class="difflineplus">+var {</span>
<a href="#l36.20"></a><span id="l36.20" class="difflineplus">+  assert_equals,</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineplus">+  assert_not_equals,</span>
<a href="#l36.22"></a><span id="l36.22" class="difflineplus">+  assert_true,</span>
<a href="#l36.23"></a><span id="l36.23" class="difflineplus">+  close_popup,</span>
<a href="#l36.24"></a><span id="l36.24" class="difflineplus">+  wait_for_popup_to_open,</span>
<a href="#l36.25"></a><span id="l36.25" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l36.26"></a><span id="l36.26" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l36.27"></a><span id="l36.27" class="difflineplus">+);</span>
<a href="#l36.28"></a><span id="l36.28"> </span>
<a href="#l36.29"></a><span id="l36.29" class="difflineminus">-var MODULE_NAME = &quot;test-account-actions&quot;;</span>
<a href="#l36.30"></a><span id="l36.30" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l36.31"></a><span id="l36.31" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;account-manager-helpers&quot;];</span>
<a href="#l36.32"></a><span id="l36.32" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l36.33"></a><span id="l36.33" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l36.34"></a><span id="l36.34" class="difflineplus">+);</span>
<a href="#l36.35"></a><span id="l36.35" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l36.36"></a><span id="l36.36"> </span>
<a href="#l36.37"></a><span id="l36.37"> var imapAccount, nntpAccount, originalAccountCount;</span>
<a href="#l36.38"></a><span id="l36.38"> </span>
<a href="#l36.39"></a><span id="l36.39"> function setupModule(module) {</span>
<a href="#l36.40"></a><span id="l36.40" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l36.41"></a><span id="l36.41" class="difflineminus">-  collector.getModule(&quot;account-manager-helpers&quot;).installInto(module);</span>
<a href="#l36.42"></a><span id="l36.42" class="difflineminus">-</span>
<a href="#l36.43"></a><span id="l36.43">   // There may be pre-existing accounts from other tests.</span>
<a href="#l36.44"></a><span id="l36.44">   originalAccountCount = MailServices.accounts.allServers.length;</span>
<a href="#l36.45"></a><span id="l36.45">   // There already should be a Local Folders account created.</span>
<a href="#l36.46"></a><span id="l36.46">   // It is needed for this test.</span>
<a href="#l36.47"></a><span id="l36.47">   assert_true(MailServices.accounts.localFoldersServer);</span>
<a href="#l36.48"></a><span id="l36.48"> </span>
<a href="#l36.49"></a><span id="l36.49">   // Create an IMAP server</span>
<a href="#l36.50"></a><span id="l36.50">   let imapServer = MailServices.accounts</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mail/test/mozmill/account/test-account-deletion.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-account-deletion.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -3,30 +3,30 @@</span>
<a href="#l37.4"></a><span id="l37.4">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l37.5"></a><span id="l37.5"> </span>
<a href="#l37.6"></a><span id="l37.6"> /**</span>
<a href="#l37.7"></a><span id="l37.7">  * This test checks proper deletion of an account from the Account manager.</span>
<a href="#l37.8"></a><span id="l37.8">  */</span>
<a href="#l37.9"></a><span id="l37.9"> </span>
<a href="#l37.10"></a><span id="l37.10"> &quot;use strict&quot;;</span>
<a href="#l37.11"></a><span id="l37.11"> </span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-account-manager-helpers.js */</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l37.14"></a><span id="l37.14" class="difflineplus">+var { open_advanced_settings, remove_account } = ChromeUtils.import(</span>
<a href="#l37.15"></a><span id="l37.15" class="difflineplus">+  &quot;resource://testing-common/mozmill/AccountManagerHelpers.jsm&quot;</span>
<a href="#l37.16"></a><span id="l37.16" class="difflineplus">+);</span>
<a href="#l37.17"></a><span id="l37.17" class="difflineplus">+var { assert_equals, assert_false, assert_true } = ChromeUtils.import(</span>
<a href="#l37.18"></a><span id="l37.18" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l37.19"></a><span id="l37.19" class="difflineplus">+);</span>
<a href="#l37.20"></a><span id="l37.20"> </span>
<a href="#l37.21"></a><span id="l37.21" class="difflineminus">-var MODULE_NAME = &quot;test-account-deletion&quot;;</span>
<a href="#l37.22"></a><span id="l37.22" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l37.23"></a><span id="l37.23" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;account-manager-helpers&quot;];</span>
<a href="#l37.24"></a><span id="l37.24" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l37.25"></a><span id="l37.25" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l37.26"></a><span id="l37.26" class="difflineplus">+);</span>
<a href="#l37.27"></a><span id="l37.27"> </span>
<a href="#l37.28"></a><span id="l37.28"> var gPopAccount, gImapAccount, gOriginalAccountCount;</span>
<a href="#l37.29"></a><span id="l37.29"> </span>
<a href="#l37.30"></a><span id="l37.30"> function setupModule(module) {</span>
<a href="#l37.31"></a><span id="l37.31" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l37.32"></a><span id="l37.32" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l37.33"></a><span id="l37.33" class="difflineminus">-  }</span>
<a href="#l37.34"></a><span id="l37.34" class="difflineminus">-</span>
<a href="#l37.35"></a><span id="l37.35">   // There may be pre-existing accounts from other tests.</span>
<a href="#l37.36"></a><span id="l37.36">   gOriginalAccountCount = MailServices.accounts.allServers.length;</span>
<a href="#l37.37"></a><span id="l37.37"> </span>
<a href="#l37.38"></a><span id="l37.38">   // Create a POP server</span>
<a href="#l37.39"></a><span id="l37.39">   let popServer = MailServices.accounts</span>
<a href="#l37.40"></a><span id="l37.40">     .createIncomingServer(&quot;nobody&quot;, &quot;pop.foo.invalid&quot;, &quot;pop3&quot;)</span>
<a href="#l37.41"></a><span id="l37.41">     .QueryInterface(Ci.nsIPop3IncomingServer);</span>
<a href="#l37.42"></a><span id="l37.42"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mail/test/mozmill/account/test-account-port-setting.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-account-port-setting.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -1,29 +1,36 @@</span>
<a href="#l38.4"></a><span id="l38.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l38.5"></a><span id="l38.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l38.6"></a><span id="l38.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l38.7"></a><span id="l38.7"> </span>
<a href="#l38.8"></a><span id="l38.8"> &quot;use strict&quot;;</span>
<a href="#l38.9"></a><span id="l38.9"> </span>
<a href="#l38.10"></a><span id="l38.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-account-manager-helpers.js */</span>
<a href="#l38.11"></a><span id="l38.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineminus">-var MODULE_NAME = &quot;test-account-port-setting&quot;;</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l38.15"></a><span id="l38.15" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;account-manager-helpers&quot;];</span>
<a href="#l38.16"></a><span id="l38.16" class="difflineminus">-</span>
<a href="#l38.17"></a><span id="l38.17"> var elib = ChromeUtils.import(</span>
<a href="#l38.18"></a><span id="l38.18">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l38.19"></a><span id="l38.19"> );</span>
<a href="#l38.20"></a><span id="l38.20"> </span>
<a href="#l38.21"></a><span id="l38.21" class="difflineplus">+var {</span>
<a href="#l38.22"></a><span id="l38.22" class="difflineplus">+  click_account_tree_row,</span>
<a href="#l38.23"></a><span id="l38.23" class="difflineplus">+  get_account_tree_row,</span>
<a href="#l38.24"></a><span id="l38.24" class="difflineplus">+  open_advanced_settings,</span>
<a href="#l38.25"></a><span id="l38.25" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l38.26"></a><span id="l38.26" class="difflineplus">+  &quot;resource://testing-common/mozmill/AccountManagerHelpers.jsm&quot;</span>
<a href="#l38.27"></a><span id="l38.27" class="difflineplus">+);</span>
<a href="#l38.28"></a><span id="l38.28" class="difflineplus">+var { FAKE_SERVER_HOSTNAME, mc } = ChromeUtils.import(</span>
<a href="#l38.29"></a><span id="l38.29" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l38.30"></a><span id="l38.30" class="difflineplus">+);</span>
<a href="#l38.31"></a><span id="l38.31"> var { input_value, delete_all_existing } = ChromeUtils.import(</span>
<a href="#l38.32"></a><span id="l38.32">   &quot;resource://testing-common/mozmill/KeyboardHelpers.jsm&quot;</span>
<a href="#l38.33"></a><span id="l38.33"> );</span>
<a href="#l38.34"></a><span id="l38.34"> </span>
<a href="#l38.35"></a><span id="l38.35" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l38.36"></a><span id="l38.36" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l38.37"></a><span id="l38.37" class="difflineplus">+);</span>
<a href="#l38.38"></a><span id="l38.38" class="difflineplus">+</span>
<a href="#l38.39"></a><span id="l38.39"> var PORT_NUMBERS_TO_TEST = [</span>
<a href="#l38.40"></a><span id="l38.40">   &quot;110&quot;, // The original port number. We don't input this though.</span>
<a href="#l38.41"></a><span id="l38.41">   &quot;456&quot;, // Random port number.</span>
<a href="#l38.42"></a><span id="l38.42">   &quot;995&quot;, // The SSL port number.</span>
<a href="#l38.43"></a><span id="l38.43">   &quot;110&quot;, // Back to the original.</span>
<a href="#l38.44"></a><span id="l38.44"> ];</span>
<a href="#l38.45"></a><span id="l38.45"> </span>
<a href="#l38.46"></a><span id="l38.46"> var gTestNumber;</span>
<a href="#l38.47"></a><span id="l38.47" class="difflineat">@@ -67,22 +74,16 @@ function subtest_check_set_port_number(a</span>
<a href="#l38.48"></a><span id="l38.48">     )</span>
<a href="#l38.49"></a><span id="l38.49">   );</span>
<a href="#l38.50"></a><span id="l38.50"> }</span>
<a href="#l38.51"></a><span id="l38.51"> </span>
<a href="#l38.52"></a><span id="l38.52"> function subtest_check_port_number(amc) {</span>
<a href="#l38.53"></a><span id="l38.53">   subtest_check_set_port_number(amc, true);</span>
<a href="#l38.54"></a><span id="l38.54"> }</span>
<a href="#l38.55"></a><span id="l38.55"> </span>
<a href="#l38.56"></a><span id="l38.56" class="difflineminus">-function setupModule(module) {</span>
<a href="#l38.57"></a><span id="l38.57" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l38.58"></a><span id="l38.58" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l38.59"></a><span id="l38.59" class="difflineminus">-  }</span>
<a href="#l38.60"></a><span id="l38.60" class="difflineminus">-}</span>
<a href="#l38.61"></a><span id="l38.61" class="difflineminus">-</span>
<a href="#l38.62"></a><span id="l38.62"> function test_account_port_setting() {</span>
<a href="#l38.63"></a><span id="l38.63">   for (</span>
<a href="#l38.64"></a><span id="l38.64">     gTestNumber = 1;</span>
<a href="#l38.65"></a><span id="l38.65">     gTestNumber &lt; PORT_NUMBERS_TO_TEST.length;</span>
<a href="#l38.66"></a><span id="l38.66">     ++gTestNumber</span>
<a href="#l38.67"></a><span id="l38.67">   ) {</span>
<a href="#l38.68"></a><span id="l38.68">     open_advanced_settings(subtest_check_set_port_number);</span>
<a href="#l38.69"></a><span id="l38.69">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mail/test/mozmill/account/test-account-settings-infrastructure.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-account-settings-infrastructure.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -7,33 +7,44 @@</span>
<a href="#l39.4"></a><span id="l39.4">  * in the Account manager. E.g. if the values of elements are properly stored when</span>
<a href="#l39.5"></a><span id="l39.5">  * panes are switched.</span>
<a href="#l39.6"></a><span id="l39.6">  *</span>
<a href="#l39.7"></a><span id="l39.7">  * New checks can be added to it as needed.</span>
<a href="#l39.8"></a><span id="l39.8">  */</span>
<a href="#l39.9"></a><span id="l39.9"> </span>
<a href="#l39.10"></a><span id="l39.10"> &quot;use strict&quot;;</span>
<a href="#l39.11"></a><span id="l39.11"> </span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-account-manager-helpers.js */</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l39.14"></a><span id="l39.14" class="difflineminus">-</span>
<a href="#l39.15"></a><span id="l39.15" class="difflineminus">-var MODULE_NAME = &quot;test-account-settings-infrastructure&quot;;</span>
<a href="#l39.16"></a><span id="l39.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l39.17"></a><span id="l39.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;account-manager-helpers&quot;];</span>
<a href="#l39.18"></a><span id="l39.18" class="difflineminus">-</span>
<a href="#l39.19"></a><span id="l39.19"> var elib = ChromeUtils.import(</span>
<a href="#l39.20"></a><span id="l39.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l39.21"></a><span id="l39.21"> );</span>
<a href="#l39.22"></a><span id="l39.22"> </span>
<a href="#l39.23"></a><span id="l39.23" class="difflineplus">+var {</span>
<a href="#l39.24"></a><span id="l39.24" class="difflineplus">+  click_account_tree_row,</span>
<a href="#l39.25"></a><span id="l39.25" class="difflineplus">+  get_account_tree_row,</span>
<a href="#l39.26"></a><span id="l39.26" class="difflineplus">+  open_advanced_settings,</span>
<a href="#l39.27"></a><span id="l39.27" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l39.28"></a><span id="l39.28" class="difflineplus">+  &quot;resource://testing-common/mozmill/AccountManagerHelpers.jsm&quot;</span>
<a href="#l39.29"></a><span id="l39.29" class="difflineplus">+);</span>
<a href="#l39.30"></a><span id="l39.30" class="difflineplus">+var {</span>
<a href="#l39.31"></a><span id="l39.31" class="difflineplus">+  assert_equals,</span>
<a href="#l39.32"></a><span id="l39.32" class="difflineplus">+  assert_false,</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineplus">+  assert_true,</span>
<a href="#l39.34"></a><span id="l39.34" class="difflineplus">+  FAKE_SERVER_HOSTNAME,</span>
<a href="#l39.35"></a><span id="l39.35" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l39.36"></a><span id="l39.36" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l39.37"></a><span id="l39.37" class="difflineplus">+);</span>
<a href="#l39.38"></a><span id="l39.38" class="difflineplus">+</span>
<a href="#l39.39"></a><span id="l39.39" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l39.40"></a><span id="l39.40" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l39.41"></a><span id="l39.41" class="difflineplus">+);</span>
<a href="#l39.42"></a><span id="l39.42" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l39.43"></a><span id="l39.43" class="difflineplus">+</span>
<a href="#l39.44"></a><span id="l39.44"> var gPopAccount, gImapAccount, gOriginalAccountCount;</span>
<a href="#l39.45"></a><span id="l39.45"> </span>
<a href="#l39.46"></a><span id="l39.46"> function setupModule(module) {</span>
<a href="#l39.47"></a><span id="l39.47" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l39.48"></a><span id="l39.48" class="difflineminus">-  collector.getModule(&quot;account-manager-helpers&quot;).installInto(module);</span>
<a href="#l39.49"></a><span id="l39.49" class="difflineminus">-</span>
<a href="#l39.50"></a><span id="l39.50">   // There may be pre-existing accounts from other tests.</span>
<a href="#l39.51"></a><span id="l39.51">   gOriginalAccountCount = MailServices.accounts.allServers.length;</span>
<a href="#l39.52"></a><span id="l39.52"> </span>
<a href="#l39.53"></a><span id="l39.53">   // Create a POP server</span>
<a href="#l39.54"></a><span id="l39.54">   let popServer = MailServices.accounts</span>
<a href="#l39.55"></a><span id="l39.55">     .createIncomingServer(&quot;nobody&quot;, &quot;pop.invalid&quot;, &quot;pop3&quot;)</span>
<a href="#l39.56"></a><span id="l39.56">     .QueryInterface(Ci.nsIPop3IncomingServer);</span>
<a href="#l39.57"></a><span id="l39.57"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mail/test/mozmill/account/test-account-tree.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-account-tree.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -3,29 +3,35 @@</span>
<a href="#l40.4"></a><span id="l40.4">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l40.5"></a><span id="l40.5"> </span>
<a href="#l40.6"></a><span id="l40.6"> /**</span>
<a href="#l40.7"></a><span id="l40.7">  * This test checks proper operation of the account tree in the Account manager.</span>
<a href="#l40.8"></a><span id="l40.8">  */</span>
<a href="#l40.9"></a><span id="l40.9"> </span>
<a href="#l40.10"></a><span id="l40.10"> &quot;use strict&quot;;</span>
<a href="#l40.11"></a><span id="l40.11"> </span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-account-manager-helpers.js */</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l40.14"></a><span id="l40.14" class="difflineplus">+var {</span>
<a href="#l40.15"></a><span id="l40.15" class="difflineplus">+  click_account_tree_row,</span>
<a href="#l40.16"></a><span id="l40.16" class="difflineplus">+  get_account_tree_row,</span>
<a href="#l40.17"></a><span id="l40.17" class="difflineplus">+  open_advanced_settings,</span>
<a href="#l40.18"></a><span id="l40.18" class="difflineplus">+  remove_account,</span>
<a href="#l40.19"></a><span id="l40.19" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l40.20"></a><span id="l40.20" class="difflineplus">+  &quot;resource://testing-common/mozmill/AccountManagerHelpers.jsm&quot;</span>
<a href="#l40.21"></a><span id="l40.21" class="difflineplus">+);</span>
<a href="#l40.22"></a><span id="l40.22" class="difflineplus">+var { assert_equals, assert_false, assert_true } = ChromeUtils.import(</span>
<a href="#l40.23"></a><span id="l40.23" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l40.24"></a><span id="l40.24" class="difflineplus">+);</span>
<a href="#l40.25"></a><span id="l40.25"> </span>
<a href="#l40.26"></a><span id="l40.26" class="difflineminus">-var MODULE_NAME = &quot;test-account-tree&quot;;</span>
<a href="#l40.27"></a><span id="l40.27" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l40.28"></a><span id="l40.28" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;account-manager-helpers&quot;];</span>
<a href="#l40.29"></a><span id="l40.29" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l40.30"></a><span id="l40.30" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l40.31"></a><span id="l40.31" class="difflineplus">+);</span>
<a href="#l40.32"></a><span id="l40.32"> </span>
<a href="#l40.33"></a><span id="l40.33"> var gPopAccount, gOriginalAccountCount;</span>
<a href="#l40.34"></a><span id="l40.34"> </span>
<a href="#l40.35"></a><span id="l40.35"> function setupModule(module) {</span>
<a href="#l40.36"></a><span id="l40.36" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l40.37"></a><span id="l40.37" class="difflineminus">-  collector.getModule(&quot;account-manager-helpers&quot;).installInto(module);</span>
<a href="#l40.38"></a><span id="l40.38" class="difflineminus">-</span>
<a href="#l40.39"></a><span id="l40.39">   // There may be pre-existing accounts from other tests.</span>
<a href="#l40.40"></a><span id="l40.40">   gOriginalAccountCount = MailServices.accounts.allServers.length;</span>
<a href="#l40.41"></a><span id="l40.41"> </span>
<a href="#l40.42"></a><span id="l40.42">   // Create a POP server</span>
<a href="#l40.43"></a><span id="l40.43">   let popServer = MailServices.accounts</span>
<a href="#l40.44"></a><span id="l40.44">     .createIncomingServer(&quot;nobody&quot;, &quot;foo.invalid&quot;, &quot;pop3&quot;)</span>
<a href="#l40.45"></a><span id="l40.45">     .QueryInterface(Ci.nsIPop3IncomingServer);</span>
<a href="#l40.46"></a><span id="l40.46"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mail/test/mozmill/account/test-account-values.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-account-values.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -4,41 +4,45 @@</span>
<a href="#l41.4"></a><span id="l41.4"> </span>
<a href="#l41.5"></a><span id="l41.5"> /**</span>
<a href="#l41.6"></a><span id="l41.6">  * This test checks proper operation of the account settings panes</span>
<a href="#l41.7"></a><span id="l41.7">  * when certain special or invalid values are entered into the fields.</span>
<a href="#l41.8"></a><span id="l41.8">  */</span>
<a href="#l41.9"></a><span id="l41.9"> </span>
<a href="#l41.10"></a><span id="l41.10"> &quot;use strict&quot;;</span>
<a href="#l41.11"></a><span id="l41.11"> </span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-account-manager-helpers.js */</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l41.14"></a><span id="l41.14" class="difflineminus">-</span>
<a href="#l41.15"></a><span id="l41.15" class="difflineminus">-var MODULE_NAME = &quot;test-account-values&quot;;</span>
<a href="#l41.16"></a><span id="l41.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l41.17"></a><span id="l41.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;account-manager-helpers&quot;];</span>
<a href="#l41.18"></a><span id="l41.18" class="difflineminus">-</span>
<a href="#l41.19"></a><span id="l41.19"> var elib = ChromeUtils.import(</span>
<a href="#l41.20"></a><span id="l41.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l41.21"></a><span id="l41.21"> );</span>
<a href="#l41.22"></a><span id="l41.22"> </span>
<a href="#l41.23"></a><span id="l41.23" class="difflineplus">+var {</span>
<a href="#l41.24"></a><span id="l41.24" class="difflineplus">+  click_account_tree_row,</span>
<a href="#l41.25"></a><span id="l41.25" class="difflineplus">+  get_account_tree_row,</span>
<a href="#l41.26"></a><span id="l41.26" class="difflineplus">+  open_advanced_settings,</span>
<a href="#l41.27"></a><span id="l41.27" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l41.28"></a><span id="l41.28" class="difflineplus">+  &quot;resource://testing-common/mozmill/AccountManagerHelpers.jsm&quot;</span>
<a href="#l41.29"></a><span id="l41.29" class="difflineplus">+);</span>
<a href="#l41.30"></a><span id="l41.30" class="difflineplus">+var { assert_equals, assert_false } = ChromeUtils.import(</span>
<a href="#l41.31"></a><span id="l41.31" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l41.32"></a><span id="l41.32" class="difflineplus">+);</span>
<a href="#l41.33"></a><span id="l41.33"> var { input_value, delete_all_existing } = ChromeUtils.import(</span>
<a href="#l41.34"></a><span id="l41.34">   &quot;resource://testing-common/mozmill/KeyboardHelpers.jsm&quot;</span>
<a href="#l41.35"></a><span id="l41.35"> );</span>
<a href="#l41.36"></a><span id="l41.36"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l41.37"></a><span id="l41.37">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l41.38"></a><span id="l41.38"> );</span>
<a href="#l41.39"></a><span id="l41.39"> </span>
<a href="#l41.40"></a><span id="l41.40" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l41.41"></a><span id="l41.41" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l41.42"></a><span id="l41.42" class="difflineplus">+);</span>
<a href="#l41.43"></a><span id="l41.43" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l41.44"></a><span id="l41.44" class="difflineplus">+</span>
<a href="#l41.45"></a><span id="l41.45"> var gPopAccount, gOriginalAccountCount;</span>
<a href="#l41.46"></a><span id="l41.46"> </span>
<a href="#l41.47"></a><span id="l41.47"> function setupModule(module) {</span>
<a href="#l41.48"></a><span id="l41.48" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l41.49"></a><span id="l41.49" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l41.50"></a><span id="l41.50" class="difflineminus">-  }</span>
<a href="#l41.51"></a><span id="l41.51" class="difflineminus">-</span>
<a href="#l41.52"></a><span id="l41.52">   // There may be pre-existing accounts from other tests.</span>
<a href="#l41.53"></a><span id="l41.53">   gOriginalAccountCount = MailServices.accounts.allServers.length;</span>
<a href="#l41.54"></a><span id="l41.54"> </span>
<a href="#l41.55"></a><span id="l41.55">   // Create a POP server</span>
<a href="#l41.56"></a><span id="l41.56">   let popServer = MailServices.accounts</span>
<a href="#l41.57"></a><span id="l41.57">     .createIncomingServer(&quot;nobody&quot;, &quot;example.invalid&quot;, &quot;pop3&quot;)</span>
<a href="#l41.58"></a><span id="l41.58">     .QueryInterface(Ci.nsIPop3IncomingServer);</span>
<a href="#l41.59"></a><span id="l41.59"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mail/test/mozmill/account/test-archive-options.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-archive-options.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -1,46 +1,49 @@</span>
<a href="#l42.4"></a><span id="l42.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l42.5"></a><span id="l42.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l42.6"></a><span id="l42.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l42.7"></a><span id="l42.7"> </span>
<a href="#l42.8"></a><span id="l42.8"> &quot;use strict&quot;;</span>
<a href="#l42.9"></a><span id="l42.9"> </span>
<a href="#l42.10"></a><span id="l42.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-account-manager-helpers.js */</span>
<a href="#l42.11"></a><span id="l42.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineminus">-var MODULE_NAME = &quot;test-archive-options&quot;;</span>
<a href="#l42.14"></a><span id="l42.14" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l42.15"></a><span id="l42.15" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;account-manager-helpers&quot;];</span>
<a href="#l42.16"></a><span id="l42.16" class="difflineminus">-</span>
<a href="#l42.17"></a><span id="l42.17"> var mozmill = ChromeUtils.import(</span>
<a href="#l42.18"></a><span id="l42.18">   &quot;chrome://mozmill/content/modules/mozmill.jsm&quot;</span>
<a href="#l42.19"></a><span id="l42.19"> );</span>
<a href="#l42.20"></a><span id="l42.20"> var controller = ChromeUtils.import(</span>
<a href="#l42.21"></a><span id="l42.21">   &quot;chrome://mozmill/content/modules/controller.jsm&quot;</span>
<a href="#l42.22"></a><span id="l42.22"> );</span>
<a href="#l42.23"></a><span id="l42.23"> var elib = ChromeUtils.import(</span>
<a href="#l42.24"></a><span id="l42.24">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l42.25"></a><span id="l42.25"> );</span>
<a href="#l42.26"></a><span id="l42.26" class="difflineplus">+var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l42.27"></a><span id="l42.27"> </span>
<a href="#l42.28"></a><span id="l42.28"> var {</span>
<a href="#l42.29"></a><span id="l42.29" class="difflineplus">+  click_account_tree_row,</span>
<a href="#l42.30"></a><span id="l42.30" class="difflineplus">+  get_account_tree_row,</span>
<a href="#l42.31"></a><span id="l42.31" class="difflineplus">+  open_advanced_settings,</span>
<a href="#l42.32"></a><span id="l42.32" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l42.33"></a><span id="l42.33" class="difflineplus">+  &quot;resource://testing-common/mozmill/AccountManagerHelpers.jsm&quot;</span>
<a href="#l42.34"></a><span id="l42.34" class="difflineplus">+);</span>
<a href="#l42.35"></a><span id="l42.35" class="difflineplus">+var { assert_equals, assert_false, assert_true, mc } = ChromeUtils.import(</span>
<a href="#l42.36"></a><span id="l42.36" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l42.37"></a><span id="l42.37" class="difflineplus">+);</span>
<a href="#l42.38"></a><span id="l42.38" class="difflineplus">+var {</span>
<a href="#l42.39"></a><span id="l42.39">   plan_for_modal_dialog,</span>
<a href="#l42.40"></a><span id="l42.40">   plan_for_window_close,</span>
<a href="#l42.41"></a><span id="l42.41">   wait_for_modal_dialog,</span>
<a href="#l42.42"></a><span id="l42.42">   wait_for_window_close,</span>
<a href="#l42.43"></a><span id="l42.43"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l42.44"></a><span id="l42.44"> </span>
<a href="#l42.45"></a><span id="l42.45" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l42.46"></a><span id="l42.46" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l42.47"></a><span id="l42.47" class="difflineplus">+);</span>
<a href="#l42.48"></a><span id="l42.48" class="difflineplus">+</span>
<a href="#l42.49"></a><span id="l42.49"> var defaultIdentity;</span>
<a href="#l42.50"></a><span id="l42.50"> </span>
<a href="#l42.51"></a><span id="l42.51"> function setupModule(module) {</span>
<a href="#l42.52"></a><span id="l42.52" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l42.53"></a><span id="l42.53" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l42.54"></a><span id="l42.54" class="difflineminus">-  let amh = collector.getModule(&quot;account-manager-helpers&quot;);</span>
<a href="#l42.55"></a><span id="l42.55" class="difflineminus">-  amh.installInto(module);</span>
<a href="#l42.56"></a><span id="l42.56" class="difflineminus">-</span>
<a href="#l42.57"></a><span id="l42.57">   defaultIdentity = MailServices.accounts.defaultAccount.defaultIdentity;</span>
<a href="#l42.58"></a><span id="l42.58"> }</span>
<a href="#l42.59"></a><span id="l42.59"> </span>
<a href="#l42.60"></a><span id="l42.60"> /**</span>
<a href="#l42.61"></a><span id="l42.61">  * Check that the archive options button is enabled or disabled appropriately.</span>
<a href="#l42.62"></a><span id="l42.62">  *</span>
<a href="#l42.63"></a><span id="l42.63">  * @param amc          the account options controller</span>
<a href="#l42.64"></a><span id="l42.64">  * @param aAccountKey  key of the account the check</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mail/test/mozmill/account/test-mail-account-setup-wizard.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-mail-account-setup-wizard.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -1,25 +1,27 @@</span>
<a href="#l43.4"></a><span id="l43.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l43.5"></a><span id="l43.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l43.6"></a><span id="l43.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l43.7"></a><span id="l43.7"> </span>
<a href="#l43.8"></a><span id="l43.8"> &quot;use strict&quot;;</span>
<a href="#l43.9"></a><span id="l43.9"> </span>
<a href="#l43.10"></a><span id="l43.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-account-manager-helpers.js */</span>
<a href="#l43.11"></a><span id="l43.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineminus">-var MODULE_NAME = &quot;test-mail-account-setup-wizard&quot;;</span>
<a href="#l43.14"></a><span id="l43.14" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l43.15"></a><span id="l43.15" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;account-manager-helpers&quot;];</span>
<a href="#l43.16"></a><span id="l43.16" class="difflineminus">-</span>
<a href="#l43.17"></a><span id="l43.17"> var elib = ChromeUtils.import(</span>
<a href="#l43.18"></a><span id="l43.18">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l43.19"></a><span id="l43.19"> );</span>
<a href="#l43.20"></a><span id="l43.20"> </span>
<a href="#l43.21"></a><span id="l43.21" class="difflineplus">+var {</span>
<a href="#l43.22"></a><span id="l43.22" class="difflineplus">+  open_advanced_settings_from_account_wizard,</span>
<a href="#l43.23"></a><span id="l43.23" class="difflineplus">+  open_mail_account_setup_wizard,</span>
<a href="#l43.24"></a><span id="l43.24" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l43.25"></a><span id="l43.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/AccountManagerHelpers.jsm&quot;</span>
<a href="#l43.26"></a><span id="l43.26" class="difflineplus">+);</span>
<a href="#l43.27"></a><span id="l43.27" class="difflineplus">+var { assert_equals, mc } = ChromeUtils.import(</span>
<a href="#l43.28"></a><span id="l43.28" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l43.29"></a><span id="l43.29" class="difflineplus">+);</span>
<a href="#l43.30"></a><span id="l43.30"> var { input_value, delete_all_existing } = ChromeUtils.import(</span>
<a href="#l43.31"></a><span id="l43.31">   &quot;resource://testing-common/mozmill/KeyboardHelpers.jsm&quot;</span>
<a href="#l43.32"></a><span id="l43.32"> );</span>
<a href="#l43.33"></a><span id="l43.33"> var { gMockPromptService } = ChromeUtils.import(</span>
<a href="#l43.34"></a><span id="l43.34">   &quot;resource://testing-common/mozmill/PromptHelpers.jsm&quot;</span>
<a href="#l43.35"></a><span id="l43.35"> );</span>
<a href="#l43.36"></a><span id="l43.36"> </span>
<a href="#l43.37"></a><span id="l43.37"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l43.38"></a><span id="l43.38" class="difflineat">@@ -30,22 +32,16 @@ var { MailServices } = ChromeUtils.impor</span>
<a href="#l43.39"></a><span id="l43.39"> var user = {</span>
<a href="#l43.40"></a><span id="l43.40">   name: &quot;Yamato Nadeshiko&quot;,</span>
<a href="#l43.41"></a><span id="l43.41">   email: &quot;yamato.nadeshiko@example.com&quot;,</span>
<a href="#l43.42"></a><span id="l43.42">   password: &quot;abc12345&quot;,</span>
<a href="#l43.43"></a><span id="l43.43">   incomingHost: &quot;testin.example.com&quot;,</span>
<a href="#l43.44"></a><span id="l43.44">   outgoingHost: &quot;testout.example.com&quot;,</span>
<a href="#l43.45"></a><span id="l43.45"> };</span>
<a href="#l43.46"></a><span id="l43.46"> </span>
<a href="#l43.47"></a><span id="l43.47" class="difflineminus">-function setupModule(module) {</span>
<a href="#l43.48"></a><span id="l43.48" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l43.49"></a><span id="l43.49" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l43.50"></a><span id="l43.50" class="difflineminus">-  }</span>
<a href="#l43.51"></a><span id="l43.51" class="difflineminus">-}</span>
<a href="#l43.52"></a><span id="l43.52" class="difflineminus">-</span>
<a href="#l43.53"></a><span id="l43.53"> // Remove an account in the Account Manager, but not via the UI.</span>
<a href="#l43.54"></a><span id="l43.54"> function remove_account_internal(amc, aAccount, aOutgoing) {</span>
<a href="#l43.55"></a><span id="l43.55">   let win = amc.window;</span>
<a href="#l43.56"></a><span id="l43.56"> </span>
<a href="#l43.57"></a><span id="l43.57">   try {</span>
<a href="#l43.58"></a><span id="l43.58">     // Remove the account and incoming server</span>
<a href="#l43.59"></a><span id="l43.59">     let serverId = aAccount.incomingServer.serverURI;</span>
<a href="#l43.60"></a><span id="l43.60">     MailServices.accounts.removeAccount(aAccount);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/mail/test/mozmill/account/test-retest-config.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-retest-config.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -1,44 +1,40 @@</span>
<a href="#l44.4"></a><span id="l44.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l44.5"></a><span id="l44.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l44.6"></a><span id="l44.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l44.7"></a><span id="l44.7"> </span>
<a href="#l44.8"></a><span id="l44.8"> &quot;use strict&quot;;</span>
<a href="#l44.9"></a><span id="l44.9"> </span>
<a href="#l44.10"></a><span id="l44.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-account-manager-helpers.js */</span>
<a href="#l44.11"></a><span id="l44.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineminus">-var MODULE_NAME = &quot;test-retest-config&quot;;</span>
<a href="#l44.14"></a><span id="l44.14" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l44.15"></a><span id="l44.15" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;account-manager-helpers&quot;];</span>
<a href="#l44.16"></a><span id="l44.16" class="difflineminus">-</span>
<a href="#l44.17"></a><span id="l44.17"> var elib = ChromeUtils.import(</span>
<a href="#l44.18"></a><span id="l44.18">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l44.19"></a><span id="l44.19"> );</span>
<a href="#l44.20"></a><span id="l44.20"> </span>
<a href="#l44.21"></a><span id="l44.21" class="difflineplus">+var { open_mail_account_setup_wizard } = ChromeUtils.import(</span>
<a href="#l44.22"></a><span id="l44.22" class="difflineplus">+  &quot;resource://testing-common/mozmill/AccountManagerHelpers.jsm&quot;</span>
<a href="#l44.23"></a><span id="l44.23" class="difflineplus">+);</span>
<a href="#l44.24"></a><span id="l44.24" class="difflineplus">+var { assert_true, mc } = ChromeUtils.import(</span>
<a href="#l44.25"></a><span id="l44.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l44.26"></a><span id="l44.26" class="difflineplus">+);</span>
<a href="#l44.27"></a><span id="l44.27"> var { input_value, delete_all_existing } = ChromeUtils.import(</span>
<a href="#l44.28"></a><span id="l44.28">   &quot;resource://testing-common/mozmill/KeyboardHelpers.jsm&quot;</span>
<a href="#l44.29"></a><span id="l44.29"> );</span>
<a href="#l44.30"></a><span id="l44.30"> var { close_window } = ChromeUtils.import(</span>
<a href="#l44.31"></a><span id="l44.31">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l44.32"></a><span id="l44.32"> );</span>
<a href="#l44.33"></a><span id="l44.33"> </span>
<a href="#l44.34"></a><span id="l44.34"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l44.35"></a><span id="l44.35"> </span>
<a href="#l44.36"></a><span id="l44.36"> var user = {</span>
<a href="#l44.37"></a><span id="l44.37">   name: &quot;test&quot;,</span>
<a href="#l44.38"></a><span id="l44.38">   email: &quot;test@momo.invalid&quot;,</span>
<a href="#l44.39"></a><span id="l44.39">   altEmail: &quot;test2@momo.invalid&quot;,</span>
<a href="#l44.40"></a><span id="l44.40"> };</span>
<a href="#l44.41"></a><span id="l44.41"> </span>
<a href="#l44.42"></a><span id="l44.42"> function setupModule(module) {</span>
<a href="#l44.43"></a><span id="l44.43" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l44.44"></a><span id="l44.44" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l44.45"></a><span id="l44.45" class="difflineminus">-  }</span>
<a href="#l44.46"></a><span id="l44.46">   Services.prefs.setCharPref(&quot;mail.wizard.logging.dump&quot;, &quot;All&quot;);</span>
<a href="#l44.47"></a><span id="l44.47"> </span>
<a href="#l44.48"></a><span id="l44.48">   let url = collector.addHttpResource(&quot;../account/xml&quot;, &quot;accountconfig&quot;);</span>
<a href="#l44.49"></a><span id="l44.49">   Services.prefs.setCharPref(&quot;mailnews.auto_config_url&quot;, url);</span>
<a href="#l44.50"></a><span id="l44.50">   collector.httpd.registerContentType(&quot;invalid&quot;, &quot;text/xml&quot;);</span>
<a href="#l44.51"></a><span id="l44.51"> }</span>
<a href="#l44.52"></a><span id="l44.52"> </span>
<a href="#l44.53"></a><span id="l44.53"> function tearDownModule(module) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/mail/test/mozmill/addrbook/test-address-book-panes.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/mail/test/mozmill/addrbook/test-address-book-panes.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -3,44 +3,40 @@</span>
<a href="#l45.4"></a><span id="l45.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l45.5"></a><span id="l45.5"> </span>
<a href="#l45.6"></a><span id="l45.6"> /*</span>
<a href="#l45.7"></a><span id="l45.7">  * Tests for the address book.</span>
<a href="#l45.8"></a><span id="l45.8">  */</span>
<a href="#l45.9"></a><span id="l45.9"> </span>
<a href="#l45.10"></a><span id="l45.10"> &quot;use strict&quot;;</span>
<a href="#l45.11"></a><span id="l45.11"> </span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l45.14"></a><span id="l45.14" class="difflineminus">-</span>
<a href="#l45.15"></a><span id="l45.15" class="difflineminus">-var MODULE_NAME = &quot;test-address-book-panes&quot;;</span>
<a href="#l45.16"></a><span id="l45.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l45.17"></a><span id="l45.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;address-book-helpers&quot;, &quot;folder-display-helpers&quot;];</span>
<a href="#l45.18"></a><span id="l45.18" class="difflineplus">+var {</span>
<a href="#l45.19"></a><span id="l45.19" class="difflineplus">+  close_address_book_window,</span>
<a href="#l45.20"></a><span id="l45.20" class="difflineplus">+  open_address_book_window,</span>
<a href="#l45.21"></a><span id="l45.21" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l45.22"></a><span id="l45.22" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l45.23"></a><span id="l45.23" class="difflineplus">+);</span>
<a href="#l45.24"></a><span id="l45.24"> </span>
<a href="#l45.25"></a><span id="l45.25"> var abController;</span>
<a href="#l45.26"></a><span id="l45.26"> </span>
<a href="#l45.27"></a><span id="l45.27"> function setupModule(module) {</span>
<a href="#l45.28"></a><span id="l45.28" class="difflineminus">-  // We need this to get mc which is needed in open_address_book_window.</span>
<a href="#l45.29"></a><span id="l45.29" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l45.30"></a><span id="l45.30" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l45.31"></a><span id="l45.31" class="difflineminus">-  let abh = collector.getModule(&quot;address-book-helpers&quot;);</span>
<a href="#l45.32"></a><span id="l45.32" class="difflineminus">-  abh.installInto(module);</span>
<a href="#l45.33"></a><span id="l45.33" class="difflineminus">-</span>
<a href="#l45.34"></a><span id="l45.34">   // Open the address book main window</span>
<a href="#l45.35"></a><span id="l45.35">   abController = open_address_book_window();</span>
<a href="#l45.36"></a><span id="l45.36"> }</span>
<a href="#l45.37"></a><span id="l45.37"> </span>
<a href="#l45.38"></a><span id="l45.38"> function teardownModule(module) {</span>
<a href="#l45.39"></a><span id="l45.39">   // Make sure the panes are all visible now that we're</span>
<a href="#l45.40"></a><span id="l45.40">   // done these tests.</span>
<a href="#l45.41"></a><span id="l45.41">   toggle_directory_pane();</span>
<a href="#l45.42"></a><span id="l45.42">   toggle_contact_pane();</span>
<a href="#l45.43"></a><span id="l45.43"> </span>
<a href="#l45.44"></a><span id="l45.44">   assert_directory_pane_visibility(true);</span>
<a href="#l45.45"></a><span id="l45.45">   assert_contact_pane_visibility(true);</span>
<a href="#l45.46"></a><span id="l45.46" class="difflineplus">+</span>
<a href="#l45.47"></a><span id="l45.47" class="difflineplus">+  close_address_book_window(abController);</span>
<a href="#l45.48"></a><span id="l45.48"> }</span>
<a href="#l45.49"></a><span id="l45.49"> </span>
<a href="#l45.50"></a><span id="l45.50"> /**</span>
<a href="#l45.51"></a><span id="l45.51">  * Helper function to toggle a pane.</span>
<a href="#l45.52"></a><span id="l45.52">  *</span>
<a href="#l45.53"></a><span id="l45.53">  * @param splitterId the id of the splitter to toggle</span>
<a href="#l45.54"></a><span id="l45.54">  */</span>
<a href="#l45.55"></a><span id="l45.55"> function _help_toggle_pane(splitterId) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/mail/test/mozmill/addrbook/test-address-book.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/mail/test/mozmill/addrbook/test-address-book.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -3,28 +3,45 @@</span>
<a href="#l46.4"></a><span id="l46.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l46.5"></a><span id="l46.5"> </span>
<a href="#l46.6"></a><span id="l46.6"> /*</span>
<a href="#l46.7"></a><span id="l46.7">  * Tests for the address book.</span>
<a href="#l46.8"></a><span id="l46.8">  */</span>
<a href="#l46.9"></a><span id="l46.9"> </span>
<a href="#l46.10"></a><span id="l46.10"> &quot;use strict&quot;;</span>
<a href="#l46.11"></a><span id="l46.11"> </span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l46.14"></a><span id="l46.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l46.15"></a><span id="l46.15" class="difflineminus">-</span>
<a href="#l46.16"></a><span id="l46.16" class="difflineminus">-var MODULE_NAME = &quot;test-address-book&quot;;</span>
<a href="#l46.17"></a><span id="l46.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l46.18"></a><span id="l46.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l46.19"></a><span id="l46.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l46.20"></a><span id="l46.20" class="difflineminus">-  &quot;address-book-helpers&quot;,</span>
<a href="#l46.21"></a><span id="l46.21" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l46.22"></a><span id="l46.22" class="difflineminus">-];</span>
<a href="#l46.23"></a><span id="l46.23" class="difflineminus">-</span>
<a href="#l46.24"></a><span id="l46.24" class="difflineplus">+var {</span>
<a href="#l46.25"></a><span id="l46.25" class="difflineplus">+  close_address_book_window,</span>
<a href="#l46.26"></a><span id="l46.26" class="difflineplus">+  create_address_book,</span>
<a href="#l46.27"></a><span id="l46.27" class="difflineplus">+  create_contact,</span>
<a href="#l46.28"></a><span id="l46.28" class="difflineplus">+  create_ldap_address_book,</span>
<a href="#l46.29"></a><span id="l46.29" class="difflineplus">+  create_mailing_list,</span>
<a href="#l46.30"></a><span id="l46.30" class="difflineplus">+  get_name_of_address_book_element_at,</span>
<a href="#l46.31"></a><span id="l46.31" class="difflineplus">+  is_address_book_collapsed,</span>
<a href="#l46.32"></a><span id="l46.32" class="difflineplus">+  load_contacts_into_address_book,</span>
<a href="#l46.33"></a><span id="l46.33" class="difflineplus">+  load_contacts_into_mailing_list,</span>
<a href="#l46.34"></a><span id="l46.34" class="difflineplus">+  open_address_book_window,</span>
<a href="#l46.35"></a><span id="l46.35" class="difflineplus">+  select_address_book,</span>
<a href="#l46.36"></a><span id="l46.36" class="difflineplus">+  select_contacts,</span>
<a href="#l46.37"></a><span id="l46.37" class="difflineplus">+  set_address_books_collapsed,</span>
<a href="#l46.38"></a><span id="l46.38" class="difflineplus">+  set_address_books_expanded,</span>
<a href="#l46.39"></a><span id="l46.39" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l46.40"></a><span id="l46.40" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l46.41"></a><span id="l46.41" class="difflineplus">+);</span>
<a href="#l46.42"></a><span id="l46.42" class="difflineplus">+var { wait_for_compose_window } = ChromeUtils.import(</span>
<a href="#l46.43"></a><span id="l46.43" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l46.44"></a><span id="l46.44" class="difflineplus">+);</span>
<a href="#l46.45"></a><span id="l46.45" class="difflineplus">+var {</span>
<a href="#l46.46"></a><span id="l46.46" class="difflineplus">+  assert_equals,</span>
<a href="#l46.47"></a><span id="l46.47" class="difflineplus">+  assert_false,</span>
<a href="#l46.48"></a><span id="l46.48" class="difflineplus">+  assert_not_equals,</span>
<a href="#l46.49"></a><span id="l46.49" class="difflineplus">+  assert_true,</span>
<a href="#l46.50"></a><span id="l46.50" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l46.51"></a><span id="l46.51" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l46.52"></a><span id="l46.52" class="difflineplus">+);</span>
<a href="#l46.53"></a><span id="l46.53"> var { gMockPromptService } = ChromeUtils.import(</span>
<a href="#l46.54"></a><span id="l46.54">   &quot;resource://testing-common/mozmill/PromptHelpers.jsm&quot;</span>
<a href="#l46.55"></a><span id="l46.55"> );</span>
<a href="#l46.56"></a><span id="l46.56"> var { plan_for_new_window } = ChromeUtils.import(</span>
<a href="#l46.57"></a><span id="l46.57">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l46.58"></a><span id="l46.58"> );</span>
<a href="#l46.59"></a><span id="l46.59"> </span>
<a href="#l46.60"></a><span id="l46.60"> var { XPCOMUtils } = ChromeUtils.import(</span>
<a href="#l46.61"></a><span id="l46.61" class="difflineat">@@ -35,20 +52,16 @@ var { MailServices } = ChromeUtils.impor</span>
<a href="#l46.62"></a><span id="l46.62">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l46.63"></a><span id="l46.63"> );</span>
<a href="#l46.64"></a><span id="l46.64"> </span>
<a href="#l46.65"></a><span id="l46.65"> var abController = null;</span>
<a href="#l46.66"></a><span id="l46.66"> var addrBook1, addrBook2, addrBook3, addrBook4, ldapBook;</span>
<a href="#l46.67"></a><span id="l46.67"> var mListA, mListB, mListC, mListD, mListE;</span>
<a href="#l46.68"></a><span id="l46.68"> </span>
<a href="#l46.69"></a><span id="l46.69"> function setupModule(module) {</span>
<a href="#l46.70"></a><span id="l46.70" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l46.71"></a><span id="l46.71" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l46.72"></a><span id="l46.72" class="difflineminus">-  }</span>
<a href="#l46.73"></a><span id="l46.73" class="difflineminus">-</span>
<a href="#l46.74"></a><span id="l46.74">   // Open the address book main window</span>
<a href="#l46.75"></a><span id="l46.75">   abController = open_address_book_window();</span>
<a href="#l46.76"></a><span id="l46.76"> </span>
<a href="#l46.77"></a><span id="l46.77">   // Let's add some new address books.  I'll add them</span>
<a href="#l46.78"></a><span id="l46.78">   // out of order to properly test the alphabetical</span>
<a href="#l46.79"></a><span id="l46.79">   // ordering of the address books.</span>
<a href="#l46.80"></a><span id="l46.80">   ldapBook = create_ldap_address_book(&quot;LDAP Book&quot;);</span>
<a href="#l46.81"></a><span id="l46.81">   addrBook3 = create_address_book(&quot;AB 3&quot;);</span>
<a href="#l46.82"></a><span id="l46.82" class="difflineat">@@ -74,16 +87,20 @@ function setupModule(module) {</span>
<a href="#l46.83"></a><span id="l46.83">   abController.waitFor(</span>
<a href="#l46.84"></a><span id="l46.84">     () =&gt; abController.window.gDirectoryTreeView.rowCount == 8,</span>
<a href="#l46.85"></a><span id="l46.85">     &quot;Timeout waiting for all 8 rows in address books list to show up in the tree view&quot;,</span>
<a href="#l46.86"></a><span id="l46.86">     1000,</span>
<a href="#l46.87"></a><span id="l46.87">     10</span>
<a href="#l46.88"></a><span id="l46.88">   );</span>
<a href="#l46.89"></a><span id="l46.89"> }</span>
<a href="#l46.90"></a><span id="l46.90"> </span>
<a href="#l46.91"></a><span id="l46.91" class="difflineplus">+function teardownModule(module) {</span>
<a href="#l46.92"></a><span id="l46.92" class="difflineplus">+  close_address_book_window(abController);</span>
<a href="#l46.93"></a><span id="l46.93" class="difflineplus">+}</span>
<a href="#l46.94"></a><span id="l46.94" class="difflineplus">+</span>
<a href="#l46.95"></a><span id="l46.95"> /* Test that the address book manager automatically sorts</span>
<a href="#l46.96"></a><span id="l46.96">  * address books.</span>
<a href="#l46.97"></a><span id="l46.97">  *</span>
<a href="#l46.98"></a><span id="l46.98">  * Currently, we sort address books as follows:</span>
<a href="#l46.99"></a><span id="l46.99">  * 1. All Address Books</span>
<a href="#l46.100"></a><span id="l46.100">  * 2. Personal Address Book</span>
<a href="#l46.101"></a><span id="l46.101">  * 3. Mork Address Books</span>
<a href="#l46.102"></a><span id="l46.102">  * 4. LDAP / Other Address Books</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/mail/test/mozmill/addrbook/test-update-mailing-list.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/mail/test/mozmill/addrbook/test-update-mailing-list.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -4,32 +4,38 @@</span>
<a href="#l47.4"></a><span id="l47.4"> </span>
<a href="#l47.5"></a><span id="l47.5"> /**</span>
<a href="#l47.6"></a><span id="l47.6">  * Tests that if a contact's address is updated, then the address is also</span>
<a href="#l47.7"></a><span id="l47.7">  * updated in mailing lists that that contact belongs to.</span>
<a href="#l47.8"></a><span id="l47.8">  */</span>
<a href="#l47.9"></a><span id="l47.9"> </span>
<a href="#l47.10"></a><span id="l47.10"> &quot;use strict&quot;;</span>
<a href="#l47.11"></a><span id="l47.11"> </span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l47.14"></a><span id="l47.14" class="difflineminus">-</span>
<a href="#l47.15"></a><span id="l47.15" class="difflineminus">-var MODULE_NAME = &quot;test-update-mailing-list&quot;;</span>
<a href="#l47.16"></a><span id="l47.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l47.17"></a><span id="l47.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;address-book-helpers&quot;, &quot;folder-display-helpers&quot;];</span>
<a href="#l47.18"></a><span id="l47.18" class="difflineplus">+var {</span>
<a href="#l47.19"></a><span id="l47.19" class="difflineplus">+  accept_contact_changes,</span>
<a href="#l47.20"></a><span id="l47.20" class="difflineplus">+  close_address_book_window,</span>
<a href="#l47.21"></a><span id="l47.21" class="difflineplus">+  create_address_book,</span>
<a href="#l47.22"></a><span id="l47.22" class="difflineplus">+  create_contact,</span>
<a href="#l47.23"></a><span id="l47.23" class="difflineplus">+  create_mailing_list,</span>
<a href="#l47.24"></a><span id="l47.24" class="difflineplus">+  delete_address_book,</span>
<a href="#l47.25"></a><span id="l47.25" class="difflineplus">+  edit_selected_contact,</span>
<a href="#l47.26"></a><span id="l47.26" class="difflineplus">+  open_address_book_window,</span>
<a href="#l47.27"></a><span id="l47.27" class="difflineplus">+  select_address_book,</span>
<a href="#l47.28"></a><span id="l47.28" class="difflineplus">+  select_contacts,</span>
<a href="#l47.29"></a><span id="l47.29" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l47.30"></a><span id="l47.30" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l47.31"></a><span id="l47.31" class="difflineplus">+);</span>
<a href="#l47.32"></a><span id="l47.32" class="difflineplus">+var { assert_equals, mc } = ChromeUtils.import(</span>
<a href="#l47.33"></a><span id="l47.33" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l47.34"></a><span id="l47.34" class="difflineplus">+);</span>
<a href="#l47.35"></a><span id="l47.35"> </span>
<a href="#l47.36"></a><span id="l47.36"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l47.37"></a><span id="l47.37">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l47.38"></a><span id="l47.38"> );</span>
<a href="#l47.39"></a><span id="l47.39"> </span>
<a href="#l47.40"></a><span id="l47.40" class="difflineminus">-function setupModule(module) {</span>
<a href="#l47.41"></a><span id="l47.41" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l47.42"></a><span id="l47.42" class="difflineminus">-  collector.getModule(&quot;address-book-helpers&quot;).installInto(module);</span>
<a href="#l47.43"></a><span id="l47.43" class="difflineminus">-}</span>
<a href="#l47.44"></a><span id="l47.44" class="difflineminus">-</span>
<a href="#l47.45"></a><span id="l47.45"> function test_contact_in_mailing_list_updated() {</span>
<a href="#l47.46"></a><span id="l47.46">   const kOldAddress = &quot;before@example.com&quot;;</span>
<a href="#l47.47"></a><span id="l47.47">   const kNewAddress = &quot;after@example.com&quot;;</span>
<a href="#l47.48"></a><span id="l47.48"> </span>
<a href="#l47.49"></a><span id="l47.49">   // Create some address book to work with...</span>
<a href="#l47.50"></a><span id="l47.50">   let ab = create_address_book(&quot;Some Address Book&quot;);</span>
<a href="#l47.51"></a><span id="l47.51">   // And a contact...</span>
<a href="#l47.52"></a><span id="l47.52">   let contact = create_contact(kOldAddress, &quot;Some Contact&quot;, true);</span>
<a href="#l47.53"></a><span id="l47.53" class="difflineat">@@ -64,9 +70,11 @@ function test_contact_in_mailing_list_up</span>
<a href="#l47.54"></a><span id="l47.54">     ml.addressLists.length,</span>
<a href="#l47.55"></a><span id="l47.55">     &quot;There should only be one contact in the mailing list&quot;</span>
<a href="#l47.56"></a><span id="l47.56">   );</span>
<a href="#l47.57"></a><span id="l47.57">   let mlContact = ml.addressLists.queryElementAt(0, Ci.nsIAbCard);</span>
<a href="#l47.58"></a><span id="l47.58">   assert_equals(kNewAddress, mlContact.primaryEmail);</span>
<a href="#l47.59"></a><span id="l47.59"> </span>
<a href="#l47.60"></a><span id="l47.60">   // Destroy the address book that we created.</span>
<a href="#l47.61"></a><span id="l47.61">   delete_address_book(ab);</span>
<a href="#l47.62"></a><span id="l47.62" class="difflineplus">+</span>
<a href="#l47.63"></a><span id="l47.63" class="difflineplus">+  close_address_book_window(abw);</span>
<a href="#l47.64"></a><span id="l47.64"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/mail/test/mozmill/attachment/test-attachment-events.js</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/mail/test/mozmill/attachment/test-attachment-events.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -3,48 +3,45 @@</span>
<a href="#l48.4"></a><span id="l48.4">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l48.5"></a><span id="l48.5"> </span>
<a href="#l48.6"></a><span id="l48.6"> /**</span>
<a href="#l48.7"></a><span id="l48.7">  * Ensures that attachment events are fired properly</span>
<a href="#l48.8"></a><span id="l48.8">  */</span>
<a href="#l48.9"></a><span id="l48.9"> </span>
<a href="#l48.10"></a><span id="l48.10"> &quot;use strict&quot;;</span>
<a href="#l48.11"></a><span id="l48.11"> </span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l48.14"></a><span id="l48.14" class="difflineminus">-</span>
<a href="#l48.15"></a><span id="l48.15" class="difflineminus">-var MODULE_NAME = &quot;test-attachment-events&quot;;</span>
<a href="#l48.16"></a><span id="l48.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l48.17"></a><span id="l48.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l48.18"></a><span id="l48.18" class="difflineminus">-</span>
<a href="#l48.19"></a><span id="l48.19"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l48.20"></a><span id="l48.20"> </span>
<a href="#l48.21"></a><span id="l48.21"> var { select_attachments } = ChromeUtils.import(</span>
<a href="#l48.22"></a><span id="l48.22">   &quot;resource://testing-common/mozmill/AttachmentHelpers.jsm&quot;</span>
<a href="#l48.23"></a><span id="l48.23"> );</span>
<a href="#l48.24"></a><span id="l48.24" class="difflineplus">+var { assert_equals, assert_true, mc } = ChromeUtils.import(</span>
<a href="#l48.25"></a><span id="l48.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l48.26"></a><span id="l48.26" class="difflineplus">+);</span>
<a href="#l48.27"></a><span id="l48.27" class="difflineplus">+var {</span>
<a href="#l48.28"></a><span id="l48.28" class="difflineplus">+  add_attachments,</span>
<a href="#l48.29"></a><span id="l48.29" class="difflineplus">+  close_compose_window,</span>
<a href="#l48.30"></a><span id="l48.30" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l48.31"></a><span id="l48.31" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l48.32"></a><span id="l48.32"> var { gMockPromptService } = ChromeUtils.import(</span>
<a href="#l48.33"></a><span id="l48.33">   &quot;resource://testing-common/mozmill/PromptHelpers.jsm&quot;</span>
<a href="#l48.34"></a><span id="l48.34"> );</span>
<a href="#l48.35"></a><span id="l48.35"> </span>
<a href="#l48.36"></a><span id="l48.36"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l48.37"></a><span id="l48.37"> var { fixIterator } = ChromeUtils.import(</span>
<a href="#l48.38"></a><span id="l48.38">   &quot;resource:///modules/iteratorUtils.jsm&quot;</span>
<a href="#l48.39"></a><span id="l48.39"> );</span>
<a href="#l48.40"></a><span id="l48.40"> </span>
<a href="#l48.41"></a><span id="l48.41"> var kAttachmentsAdded = &quot;attachments-added&quot;;</span>
<a href="#l48.42"></a><span id="l48.42"> var kAttachmentsRemoved = &quot;attachments-removed&quot;;</span>
<a href="#l48.43"></a><span id="l48.43"> var kAttachmentRenamed = &quot;attachment-renamed&quot;;</span>
<a href="#l48.44"></a><span id="l48.44"> </span>
<a href="#l48.45"></a><span id="l48.45"> var gPath;</span>
<a href="#l48.46"></a><span id="l48.46"> </span>
<a href="#l48.47"></a><span id="l48.47"> function setupModule(module) {</span>
<a href="#l48.48"></a><span id="l48.48" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l48.49"></a><span id="l48.49" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l48.50"></a><span id="l48.50" class="difflineminus">-  }</span>
<a href="#l48.51"></a><span id="l48.51" class="difflineminus">-</span>
<a href="#l48.52"></a><span id="l48.52">   gPath = os.getFileForPath(__file__);</span>
<a href="#l48.53"></a><span id="l48.53"> }</span>
<a href="#l48.54"></a><span id="l48.54"> </span>
<a href="#l48.55"></a><span id="l48.55"> /**</span>
<a href="#l48.56"></a><span id="l48.56">  * Test that the attachments-added event is fired when we add a single</span>
<a href="#l48.57"></a><span id="l48.57">  * attachment.</span>
<a href="#l48.58"></a><span id="l48.58">  */</span>
<a href="#l48.59"></a><span id="l48.59"> function test_attachments_added_on_single() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/mail/test/mozmill/attachment/test-attachment-in-plain-msg.js</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/mail/test/mozmill/attachment/test-attachment-in-plain-msg.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -1,32 +1,32 @@</span>
<a href="#l49.4"></a><span id="l49.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l49.5"></a><span id="l49.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l49.6"></a><span id="l49.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l49.7"></a><span id="l49.7"> </span>
<a href="#l49.8"></a><span id="l49.8"> &quot;use strict&quot;;</span>
<a href="#l49.9"></a><span id="l49.9"> </span>
<a href="#l49.10"></a><span id="l49.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-dom-helpers.js */</span>
<a href="#l49.11"></a><span id="l49.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineminus">-var MODULE_NAME = &quot;test-attachment-in-plain-msg&quot;;</span>
<a href="#l49.14"></a><span id="l49.14" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l49.15"></a><span id="l49.15" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;dom-helpers&quot;];</span>
<a href="#l49.16"></a><span id="l49.16" class="difflineminus">-</span>
<a href="#l49.17"></a><span id="l49.17"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l49.18"></a><span id="l49.18"> </span>
<a href="#l49.19"></a><span id="l49.19" class="difflineplus">+var { wait_for_element_visible } = ChromeUtils.import(</span>
<a href="#l49.20"></a><span id="l49.20" class="difflineplus">+  &quot;resource://testing-common/mozmill/DOMHelpers.jsm&quot;</span>
<a href="#l49.21"></a><span id="l49.21" class="difflineplus">+);</span>
<a href="#l49.22"></a><span id="l49.22" class="difflineplus">+var {</span>
<a href="#l49.23"></a><span id="l49.23" class="difflineplus">+  assert_equals,</span>
<a href="#l49.24"></a><span id="l49.24" class="difflineplus">+  assert_false,</span>
<a href="#l49.25"></a><span id="l49.25" class="difflineplus">+  assert_true,</span>
<a href="#l49.26"></a><span id="l49.26" class="difflineplus">+  open_message_from_file,</span>
<a href="#l49.27"></a><span id="l49.27" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l49.28"></a><span id="l49.28" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l49.29"></a><span id="l49.29" class="difflineplus">+);</span>
<a href="#l49.30"></a><span id="l49.30"> var { close_window } = ChromeUtils.import(</span>
<a href="#l49.31"></a><span id="l49.31">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l49.32"></a><span id="l49.32"> );</span>
<a href="#l49.33"></a><span id="l49.33"> </span>
<a href="#l49.34"></a><span id="l49.34" class="difflineminus">-function setupModule(module) {</span>
<a href="#l49.35"></a><span id="l49.35" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l49.36"></a><span id="l49.36" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l49.37"></a><span id="l49.37" class="difflineminus">-  }</span>
<a href="#l49.38"></a><span id="l49.38" class="difflineminus">-}</span>
<a href="#l49.39"></a><span id="l49.39" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l49.40"></a><span id="l49.40"> </span>
<a href="#l49.41"></a><span id="l49.41"> /**</span>
<a href="#l49.42"></a><span id="l49.42">  * Bug 1358565</span>
<a href="#l49.43"></a><span id="l49.43">  * Check that a non-empty image is shown as attachment and is detected as non-empty</span>
<a href="#l49.44"></a><span id="l49.44">  * when message is viewed as plain text.</span>
<a href="#l49.45"></a><span id="l49.45">  */</span>
<a href="#l49.46"></a><span id="l49.46"> async function test_attachment_not_empty() {</span>
<a href="#l49.47"></a><span id="l49.47">   Services.prefs.setBoolPref(&quot;mailnews.display.prefer_plaintext&quot;, true);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/mail/test/mozmill/attachment/test-attachment-menus.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/mail/test/mozmill/attachment/test-attachment-menus.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -1,20 +1,14 @@</span>
<a href="#l50.4"></a><span id="l50.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l50.5"></a><span id="l50.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l50.6"></a><span id="l50.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l50.7"></a><span id="l50.7"> </span>
<a href="#l50.8"></a><span id="l50.8"> &quot;use strict&quot;;</span>
<a href="#l50.9"></a><span id="l50.9"> </span>
<a href="#l50.10"></a><span id="l50.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l50.11"></a><span id="l50.11" class="difflineminus">-</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-var MODULE_NAME = &quot;test-attachment-menus&quot;;</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l50.14"></a><span id="l50.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l50.15"></a><span id="l50.15" class="difflineminus">-</span>
<a href="#l50.16"></a><span id="l50.16"> var folder;</span>
<a href="#l50.17"></a><span id="l50.17"> var messenger;</span>
<a href="#l50.18"></a><span id="l50.18"> var epsilon;</span>
<a href="#l50.19"></a><span id="l50.19"> </span>
<a href="#l50.20"></a><span id="l50.20"> var elib = ChromeUtils.import(</span>
<a href="#l50.21"></a><span id="l50.21">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l50.22"></a><span id="l50.22"> );</span>
<a href="#l50.23"></a><span id="l50.23"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l50.24"></a><span id="l50.24" class="difflineat">@@ -25,16 +19,28 @@ var controller = ChromeUtils.import(</span>
<a href="#l50.25"></a><span id="l50.25"> var {</span>
<a href="#l50.26"></a><span id="l50.26">   create_body_part,</span>
<a href="#l50.27"></a><span id="l50.27">   create_deleted_attachment,</span>
<a href="#l50.28"></a><span id="l50.28">   create_detached_attachment,</span>
<a href="#l50.29"></a><span id="l50.29">   create_enclosure_attachment,</span>
<a href="#l50.30"></a><span id="l50.30"> } = ChromeUtils.import(</span>
<a href="#l50.31"></a><span id="l50.31">   &quot;resource://testing-common/mozmill/AttachmentHelpers.jsm&quot;</span>
<a href="#l50.32"></a><span id="l50.32"> );</span>
<a href="#l50.33"></a><span id="l50.33" class="difflineplus">+var {</span>
<a href="#l50.34"></a><span id="l50.34" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l50.35"></a><span id="l50.35" class="difflineplus">+  be_in_folder,</span>
<a href="#l50.36"></a><span id="l50.36" class="difflineplus">+  close_popup,</span>
<a href="#l50.37"></a><span id="l50.37" class="difflineplus">+  create_folder,</span>
<a href="#l50.38"></a><span id="l50.38" class="difflineplus">+  create_message,</span>
<a href="#l50.39"></a><span id="l50.39" class="difflineplus">+  mc,</span>
<a href="#l50.40"></a><span id="l50.40" class="difflineplus">+  select_click_row,</span>
<a href="#l50.41"></a><span id="l50.41" class="difflineplus">+  wait_for_popup_to_open,</span>
<a href="#l50.42"></a><span id="l50.42" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l50.43"></a><span id="l50.43" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l50.44"></a><span id="l50.44" class="difflineplus">+);</span>
<a href="#l50.45"></a><span id="l50.45"> </span>
<a href="#l50.46"></a><span id="l50.46"> var textAttachment =</span>
<a href="#l50.47"></a><span id="l50.47">   &quot;Can't make the frug contest, Helen; stomach's upset. I'll fix you, &quot; +</span>
<a href="#l50.48"></a><span id="l50.48">   &quot;Ubik! Ubik drops you back in the thick of things fast. Taken as &quot; +</span>
<a href="#l50.49"></a><span id="l50.49">   &quot;directed, Ubik speeds relief to head and stomach. Remember: Ubik is &quot; +</span>
<a href="#l50.50"></a><span id="l50.50">   &quot;only seconds away. Avoid prolonged use.&quot;;</span>
<a href="#l50.51"></a><span id="l50.51"> </span>
<a href="#l50.52"></a><span id="l50.52"> var detachedName = &quot;./attachment.txt&quot;;</span>
<a href="#l50.53"></a><span id="l50.53" class="difflineat">@@ -173,19 +179,16 @@ var messages = [</span>
<a href="#l50.54"></a><span id="l50.54">       { open: false, save: false, detach: false, delete_: false },</span>
<a href="#l50.55"></a><span id="l50.55">       { open: false, save: false, detach: false, delete_: false },</span>
<a href="#l50.56"></a><span id="l50.56">     ],</span>
<a href="#l50.57"></a><span id="l50.57">     allMenuStates: { open: false, save: false, detach: false, delete_: false },</span>
<a href="#l50.58"></a><span id="l50.58">   },</span>
<a href="#l50.59"></a><span id="l50.59"> ];</span>
<a href="#l50.60"></a><span id="l50.60"> </span>
<a href="#l50.61"></a><span id="l50.61"> function setupModule(module) {</span>
<a href="#l50.62"></a><span id="l50.62" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l50.63"></a><span id="l50.63" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l50.64"></a><span id="l50.64" class="difflineminus">-</span>
<a href="#l50.65"></a><span id="l50.65">   messenger = Cc[&quot;@mozilla.org/messenger;1&quot;].createInstance(Ci.nsIMessenger);</span>
<a href="#l50.66"></a><span id="l50.66"> </span>
<a href="#l50.67"></a><span id="l50.67">   /* Today's gory details (thanks to Jonathan Protzenko): libmime somehow</span>
<a href="#l50.68"></a><span id="l50.68">    * counts the trailing newline for an attachment MIME part. Most of the time,</span>
<a href="#l50.69"></a><span id="l50.69">    * assuming attachment has N bytes (no matter what's inside, newlines or</span>
<a href="#l50.70"></a><span id="l50.70">    * not), libmime will return N + 1 bytes. On Linux and Mac, this always</span>
<a href="#l50.71"></a><span id="l50.71">    * holds. However, on Windows, if the attachment is not encoded (that is, is</span>
<a href="#l50.72"></a><span id="l50.72">    * inline text), libmime will return N + 2 bytes.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/mail/test/mozmill/attachment/test-attachment-size.js</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/mail/test/mozmill/attachment/test-attachment-size.js</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -1,36 +1,43 @@</span>
<a href="#l51.4"></a><span id="l51.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l51.5"></a><span id="l51.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l51.6"></a><span id="l51.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l51.7"></a><span id="l51.7"> </span>
<a href="#l51.8"></a><span id="l51.8"> &quot;use strict&quot;;</span>
<a href="#l51.9"></a><span id="l51.9"> </span>
<a href="#l51.10"></a><span id="l51.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l51.11"></a><span id="l51.11" class="difflineminus">-</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-var MODULE_NAME = &quot;test-attachment-size&quot;;</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l51.14"></a><span id="l51.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l51.15"></a><span id="l51.15" class="difflineminus">-</span>
<a href="#l51.16"></a><span id="l51.16"> var folder;</span>
<a href="#l51.17"></a><span id="l51.17"> var messenger;</span>
<a href="#l51.18"></a><span id="l51.18"> var epsilon;</span>
<a href="#l51.19"></a><span id="l51.19"> </span>
<a href="#l51.20"></a><span id="l51.20"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l51.21"></a><span id="l51.21"> var controller = ChromeUtils.import(</span>
<a href="#l51.22"></a><span id="l51.22">   &quot;chrome://mozmill/content/modules/controller.jsm&quot;</span>
<a href="#l51.23"></a><span id="l51.23"> );</span>
<a href="#l51.24"></a><span id="l51.24"> </span>
<a href="#l51.25"></a><span id="l51.25"> var {</span>
<a href="#l51.26"></a><span id="l51.26">   create_body_part,</span>
<a href="#l51.27"></a><span id="l51.27">   create_deleted_attachment,</span>
<a href="#l51.28"></a><span id="l51.28">   create_detached_attachment,</span>
<a href="#l51.29"></a><span id="l51.29"> } = ChromeUtils.import(</span>
<a href="#l51.30"></a><span id="l51.30">   &quot;resource://testing-common/mozmill/AttachmentHelpers.jsm&quot;</span>
<a href="#l51.31"></a><span id="l51.31"> );</span>
<a href="#l51.32"></a><span id="l51.32" class="difflineplus">+var {</span>
<a href="#l51.33"></a><span id="l51.33" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l51.34"></a><span id="l51.34" class="difflineplus">+  be_in_folder,</span>
<a href="#l51.35"></a><span id="l51.35" class="difflineplus">+  create_folder,</span>
<a href="#l51.36"></a><span id="l51.36" class="difflineplus">+  create_message,</span>
<a href="#l51.37"></a><span id="l51.37" class="difflineplus">+  mc,</span>
<a href="#l51.38"></a><span id="l51.38" class="difflineplus">+  msgGen,</span>
<a href="#l51.39"></a><span id="l51.39" class="difflineplus">+  select_click_row,</span>
<a href="#l51.40"></a><span id="l51.40" class="difflineplus">+  SyntheticPartLeaf,</span>
<a href="#l51.41"></a><span id="l51.41" class="difflineplus">+  SyntheticPartMultiMixed,</span>
<a href="#l51.42"></a><span id="l51.42" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l51.43"></a><span id="l51.43" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l51.44"></a><span id="l51.44" class="difflineplus">+);</span>
<a href="#l51.45"></a><span id="l51.45"> </span>
<a href="#l51.46"></a><span id="l51.46"> var textAttachment =</span>
<a href="#l51.47"></a><span id="l51.47">   &quot;Can't make the frug contest, Helen; stomach's upset. I'll fix you, &quot; +</span>
<a href="#l51.48"></a><span id="l51.48">   &quot;Ubik! Ubik drops you back in the thick of things fast. Taken as &quot; +</span>
<a href="#l51.49"></a><span id="l51.49">   &quot;directed, Ubik speeds relief to head and stomach. Remember: Ubik is &quot; +</span>
<a href="#l51.50"></a><span id="l51.50">   &quot;only seconds away. Avoid prolonged use.&quot;;</span>
<a href="#l51.51"></a><span id="l51.51"> </span>
<a href="#l51.52"></a><span id="l51.52"> var binaryAttachment = textAttachment;</span>
<a href="#l51.53"></a><span id="l51.53" class="difflineat">@@ -164,20 +171,16 @@ var messages = [</span>
<a href="#l51.54"></a><span id="l51.54">     name: &quot;attached_message_with_attachment&quot;,</span>
<a href="#l51.55"></a><span id="l51.55">     bodyPart: null,</span>
<a href="#l51.56"></a><span id="l51.56">     attachmentSizes: [-1, textAttachment.length],</span>
<a href="#l51.57"></a><span id="l51.57">     attachmentTotalSize: { size: 0, exact: true },</span>
<a href="#l51.58"></a><span id="l51.58">   },</span>
<a href="#l51.59"></a><span id="l51.59"> ];</span>
<a href="#l51.60"></a><span id="l51.60"> </span>
<a href="#l51.61"></a><span id="l51.61"> function setupModule(module) {</span>
<a href="#l51.62"></a><span id="l51.62" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l51.63"></a><span id="l51.63" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l51.64"></a><span id="l51.64" class="difflineminus">-  }</span>
<a href="#l51.65"></a><span id="l51.65" class="difflineminus">-</span>
<a href="#l51.66"></a><span id="l51.66">   messenger = Cc[&quot;@mozilla.org/messenger;1&quot;].createInstance(Ci.nsIMessenger);</span>
<a href="#l51.67"></a><span id="l51.67"> </span>
<a href="#l51.68"></a><span id="l51.68">   /* Today's gory details (thanks to Jonathan Protzenko): libmime somehow</span>
<a href="#l51.69"></a><span id="l51.69">    * counts the trailing newline for an attachment MIME part. Most of the time,</span>
<a href="#l51.70"></a><span id="l51.70">    * assuming attachment has N bytes (no matter what's inside, newlines or</span>
<a href="#l51.71"></a><span id="l51.71">    * not), libmime will return N + 1 bytes. On Linux and Mac, this always</span>
<a href="#l51.72"></a><span id="l51.72">    * holds. However, on Windows, if the attachment is not encoded (that is, is</span>
<a href="#l51.73"></a><span id="l51.73">    * inline text), libmime will return N + 2 bytes.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/mail/test/mozmill/attachment/test-attachment.js</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/mail/test/mozmill/attachment/test-attachment.js</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -3,30 +3,50 @@</span>
<a href="#l52.4"></a><span id="l52.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l52.5"></a><span id="l52.5"> </span>
<a href="#l52.6"></a><span id="l52.6"> /**</span>
<a href="#l52.7"></a><span id="l52.7">  * Checks various attachments display correctly</span>
<a href="#l52.8"></a><span id="l52.8">  */</span>
<a href="#l52.9"></a><span id="l52.9"> </span>
<a href="#l52.10"></a><span id="l52.10"> &quot;use strict&quot;;</span>
<a href="#l52.11"></a><span id="l52.11"> </span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l52.14"></a><span id="l52.14" class="difflineminus">-</span>
<a href="#l52.15"></a><span id="l52.15" class="difflineminus">-var MODULE_NAME = &quot;test-attachment&quot;;</span>
<a href="#l52.16"></a><span id="l52.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l52.17"></a><span id="l52.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l52.18"></a><span id="l52.18" class="difflineminus">-</span>
<a href="#l52.19"></a><span id="l52.19"> var elib = ChromeUtils.import(</span>
<a href="#l52.20"></a><span id="l52.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l52.21"></a><span id="l52.21"> );</span>
<a href="#l52.22"></a><span id="l52.22"> var EventUtils = ChromeUtils.import(</span>
<a href="#l52.23"></a><span id="l52.23">   &quot;chrome://mozmill/content/stdlib/EventUtils.jsm&quot;</span>
<a href="#l52.24"></a><span id="l52.24"> );</span>
<a href="#l52.25"></a><span id="l52.25"> </span>
<a href="#l52.26"></a><span id="l52.26" class="difflineplus">+var { close_compose_window, open_compose_with_forward } = ChromeUtils.import(</span>
<a href="#l52.27"></a><span id="l52.27" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l52.28"></a><span id="l52.28" class="difflineplus">+);</span>
<a href="#l52.29"></a><span id="l52.29" class="difflineplus">+var {</span>
<a href="#l52.30"></a><span id="l52.30" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l52.31"></a><span id="l52.31" class="difflineplus">+  assert_attachment_list_focused,</span>
<a href="#l52.32"></a><span id="l52.32" class="difflineplus">+  assert_equals,</span>
<a href="#l52.33"></a><span id="l52.33" class="difflineplus">+  assert_message_pane_focused,</span>
<a href="#l52.34"></a><span id="l52.34" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l52.35"></a><span id="l52.35" class="difflineplus">+  assert_true,</span>
<a href="#l52.36"></a><span id="l52.36" class="difflineplus">+  be_in_folder,</span>
<a href="#l52.37"></a><span id="l52.37" class="difflineplus">+  close_popup,</span>
<a href="#l52.38"></a><span id="l52.38" class="difflineplus">+  create_folder,</span>
<a href="#l52.39"></a><span id="l52.39" class="difflineplus">+  create_message,</span>
<a href="#l52.40"></a><span id="l52.40" class="difflineplus">+  mc,</span>
<a href="#l52.41"></a><span id="l52.41" class="difflineplus">+  msgGen,</span>
<a href="#l52.42"></a><span id="l52.42" class="difflineplus">+  plan_to_wait_for_folder_events,</span>
<a href="#l52.43"></a><span id="l52.43" class="difflineplus">+  select_click_row,</span>
<a href="#l52.44"></a><span id="l52.44" class="difflineplus">+  select_none,</span>
<a href="#l52.45"></a><span id="l52.45" class="difflineplus">+  SyntheticPartLeaf,</span>
<a href="#l52.46"></a><span id="l52.46" class="difflineplus">+  SyntheticPartMultiMixed,</span>
<a href="#l52.47"></a><span id="l52.47" class="difflineplus">+  wait_for_folder_events,</span>
<a href="#l52.48"></a><span id="l52.48" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l52.49"></a><span id="l52.49" class="difflineplus">+  wait_for_popup_to_open,</span>
<a href="#l52.50"></a><span id="l52.50" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l52.51"></a><span id="l52.51" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l52.52"></a><span id="l52.52" class="difflineplus">+);</span>
<a href="#l52.53"></a><span id="l52.53"> var {</span>
<a href="#l52.54"></a><span id="l52.54">   close_window,</span>
<a href="#l52.55"></a><span id="l52.55">   plan_for_modal_dialog,</span>
<a href="#l52.56"></a><span id="l52.56">   plan_for_new_window,</span>
<a href="#l52.57"></a><span id="l52.57">   wait_for_modal_dialog,</span>
<a href="#l52.58"></a><span id="l52.58">   wait_for_new_window,</span>
<a href="#l52.59"></a><span id="l52.59"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l52.60"></a><span id="l52.60"> </span>
<a href="#l52.61"></a><span id="l52.61" class="difflineat">@@ -42,20 +62,16 @@ var textAttachment =</span>
<a href="#l52.62"></a><span id="l52.62">   &quot;that happens someone like myself who has gone through an ordeal and who &quot; +</span>
<a href="#l52.63"></a><span id="l52.63">   &quot;genuinely needs hot coffee to pick him up and keep him functioning when &quot; +</span>
<a href="#l52.64"></a><span id="l52.64">   &quot;he has to function will get the hot coffee whether he happens to have a &quot; +</span>
<a href="#l52.65"></a><span id="l52.65">   &quot;poscred readily available or not.&quot;;</span>
<a href="#l52.66"></a><span id="l52.66"> </span>
<a href="#l52.67"></a><span id="l52.67"> var binaryAttachment = textAttachment;</span>
<a href="#l52.68"></a><span id="l52.68"> </span>
<a href="#l52.69"></a><span id="l52.69"> function setupModule(module) {</span>
<a href="#l52.70"></a><span id="l52.70" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l52.71"></a><span id="l52.71" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l52.72"></a><span id="l52.72" class="difflineminus">-  }</span>
<a href="#l52.73"></a><span id="l52.73" class="difflineminus">-</span>
<a href="#l52.74"></a><span id="l52.74">   folder = create_folder(&quot;AttachmentA&quot;);</span>
<a href="#l52.75"></a><span id="l52.75"> </span>
<a href="#l52.76"></a><span id="l52.76">   var attachedMessage = msgGen.makeMessage({</span>
<a href="#l52.77"></a><span id="l52.77">     body: { body: &quot;I'm an attached email!&quot; },</span>
<a href="#l52.78"></a><span id="l52.78">     attachments: [</span>
<a href="#l52.79"></a><span id="l52.79">       { body: textAttachment, filename: &quot;inner attachment.txt&quot;, format: &quot;&quot; },</span>
<a href="#l52.80"></a><span id="l52.80">     ],</span>
<a href="#l52.81"></a><span id="l52.81">   });</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/mail/test/mozmill/cloudfile/test-cloudfile-attachment-item.js</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/mail/test/mozmill/cloudfile/test-cloudfile-attachment-item.js</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -3,47 +3,47 @@</span>
<a href="#l53.4"></a><span id="l53.4">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l53.5"></a><span id="l53.5"> </span>
<a href="#l53.6"></a><span id="l53.6"> /**</span>
<a href="#l53.7"></a><span id="l53.7">  * Tests Filelink attachment item behaviour.</span>
<a href="#l53.8"></a><span id="l53.8">  */</span>
<a href="#l53.9"></a><span id="l53.9"> </span>
<a href="#l53.10"></a><span id="l53.10"> &quot;use strict&quot;;</span>
<a href="#l53.11"></a><span id="l53.11"> </span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l53.14"></a><span id="l53.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-cloudfile-helpers.js */</span>
<a href="#l53.15"></a><span id="l53.15" class="difflineminus">-</span>
<a href="#l53.16"></a><span id="l53.16" class="difflineminus">-var MODULE_NAME = &quot;test-cloudfile-attachment-item&quot;;</span>
<a href="#l53.17"></a><span id="l53.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l53.18"></a><span id="l53.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l53.19"></a><span id="l53.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l53.20"></a><span id="l53.20" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l53.21"></a><span id="l53.21" class="difflineminus">-  &quot;cloudfile-helpers&quot;,</span>
<a href="#l53.22"></a><span id="l53.22" class="difflineminus">-];</span>
<a href="#l53.23"></a><span id="l53.23" class="difflineminus">-</span>
<a href="#l53.24"></a><span id="l53.24"> var {</span>
<a href="#l53.25"></a><span id="l53.25">   gMockFilePicker,</span>
<a href="#l53.26"></a><span id="l53.26">   gMockFilePickReg,</span>
<a href="#l53.27"></a><span id="l53.27">   select_attachments,</span>
<a href="#l53.28"></a><span id="l53.28"> } = ChromeUtils.import(</span>
<a href="#l53.29"></a><span id="l53.29">   &quot;resource://testing-common/mozmill/AttachmentHelpers.jsm&quot;</span>
<a href="#l53.30"></a><span id="l53.30"> );</span>
<a href="#l53.31"></a><span id="l53.31" class="difflineplus">+var {</span>
<a href="#l53.32"></a><span id="l53.32" class="difflineplus">+  collectFiles,</span>
<a href="#l53.33"></a><span id="l53.33" class="difflineplus">+  getFile,</span>
<a href="#l53.34"></a><span id="l53.34" class="difflineplus">+  gMockCloudfileManager,</span>
<a href="#l53.35"></a><span id="l53.35" class="difflineplus">+  MockCloudfileAccount,</span>
<a href="#l53.36"></a><span id="l53.36" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l53.37"></a><span id="l53.37" class="difflineplus">+  &quot;resource://testing-common/mozmill/CloudfileHelpers.jsm&quot;</span>
<a href="#l53.38"></a><span id="l53.38" class="difflineplus">+);</span>
<a href="#l53.39"></a><span id="l53.39" class="difflineplus">+var {</span>
<a href="#l53.40"></a><span id="l53.40" class="difflineplus">+  add_cloud_attachments,</span>
<a href="#l53.41"></a><span id="l53.41" class="difflineplus">+  close_compose_window,</span>
<a href="#l53.42"></a><span id="l53.42" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l53.43"></a><span id="l53.43" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l53.44"></a><span id="l53.44" class="difflineplus">+var { assert_false, close_popup } = ChromeUtils.import(</span>
<a href="#l53.45"></a><span id="l53.45" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l53.46"></a><span id="l53.46" class="difflineplus">+);</span>
<a href="#l53.47"></a><span id="l53.47"> </span>
<a href="#l53.48"></a><span id="l53.48"> var kAttachmentItemContextID = &quot;msgComposeAttachmentItemContext&quot;;</span>
<a href="#l53.49"></a><span id="l53.49"> </span>
<a href="#l53.50"></a><span id="l53.50"> var { cloudFileAccounts } = ChromeUtils.import(</span>
<a href="#l53.51"></a><span id="l53.51">   &quot;resource:///modules/cloudFileAccounts.jsm&quot;</span>
<a href="#l53.52"></a><span id="l53.52"> );</span>
<a href="#l53.53"></a><span id="l53.53"> </span>
<a href="#l53.54"></a><span id="l53.54"> function setupModule(module) {</span>
<a href="#l53.55"></a><span id="l53.55" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l53.56"></a><span id="l53.56" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l53.57"></a><span id="l53.57" class="difflineminus">-  }</span>
<a href="#l53.58"></a><span id="l53.58" class="difflineminus">-</span>
<a href="#l53.59"></a><span id="l53.59">   gMockFilePickReg.register();</span>
<a href="#l53.60"></a><span id="l53.60">   gMockCloudfileManager.register();</span>
<a href="#l53.61"></a><span id="l53.61"> }</span>
<a href="#l53.62"></a><span id="l53.62"> </span>
<a href="#l53.63"></a><span id="l53.63"> function teardownModule(module) {</span>
<a href="#l53.64"></a><span id="l53.64">   gMockCloudfileManager.unregister();</span>
<a href="#l53.65"></a><span id="l53.65">   gMockFilePickReg.unregister();</span>
<a href="#l53.66"></a><span id="l53.66"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/mail/test/mozmill/cloudfile/test-cloudfile-attachment-urls.js</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/mail/test/mozmill/cloudfile/test-cloudfile-attachment-urls.js</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -3,37 +3,59 @@</span>
<a href="#l54.4"></a><span id="l54.4">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l54.5"></a><span id="l54.5"> </span>
<a href="#l54.6"></a><span id="l54.6"> /**</span>
<a href="#l54.7"></a><span id="l54.7">  * Tests Filelink URL insertion behaviours in compose windows.</span>
<a href="#l54.8"></a><span id="l54.8">  */</span>
<a href="#l54.9"></a><span id="l54.9"> </span>
<a href="#l54.10"></a><span id="l54.10"> &quot;use strict&quot;;</span>
<a href="#l54.11"></a><span id="l54.11"> </span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l54.13"></a><span id="l54.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l54.14"></a><span id="l54.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-cloudfile-helpers.js */</span>
<a href="#l54.15"></a><span id="l54.15" class="difflineminus">-/* import-globals-from ../shared-modules/test-dom-helpers.js */</span>
<a href="#l54.16"></a><span id="l54.16" class="difflineminus">-</span>
<a href="#l54.17"></a><span id="l54.17" class="difflineminus">-var MODULE_NAME = &quot;test-cloudfile-attachment-urls&quot;;</span>
<a href="#l54.18"></a><span id="l54.18" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l54.19"></a><span id="l54.19" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l54.20"></a><span id="l54.20" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l54.21"></a><span id="l54.21" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l54.22"></a><span id="l54.22" class="difflineminus">-  &quot;cloudfile-helpers&quot;,</span>
<a href="#l54.23"></a><span id="l54.23" class="difflineminus">-  &quot;dom-helpers&quot;,</span>
<a href="#l54.24"></a><span id="l54.24" class="difflineminus">-];</span>
<a href="#l54.25"></a><span id="l54.25" class="difflineminus">-</span>
<a href="#l54.26"></a><span id="l54.26"> var {</span>
<a href="#l54.27"></a><span id="l54.27">   gMockFilePicker,</span>
<a href="#l54.28"></a><span id="l54.28">   gMockFilePickReg,</span>
<a href="#l54.29"></a><span id="l54.29">   select_attachments,</span>
<a href="#l54.30"></a><span id="l54.30"> } = ChromeUtils.import(</span>
<a href="#l54.31"></a><span id="l54.31">   &quot;resource://testing-common/mozmill/AttachmentHelpers.jsm&quot;</span>
<a href="#l54.32"></a><span id="l54.32"> );</span>
<a href="#l54.33"></a><span id="l54.33" class="difflineplus">+var {</span>
<a href="#l54.34"></a><span id="l54.34" class="difflineplus">+  collectFiles,</span>
<a href="#l54.35"></a><span id="l54.35" class="difflineplus">+  gMockCloudfileManager,</span>
<a href="#l54.36"></a><span id="l54.36" class="difflineplus">+  MockCloudfileAccount,</span>
<a href="#l54.37"></a><span id="l54.37" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l54.38"></a><span id="l54.38" class="difflineplus">+  &quot;resource://testing-common/mozmill/CloudfileHelpers.jsm&quot;</span>
<a href="#l54.39"></a><span id="l54.39" class="difflineplus">+);</span>
<a href="#l54.40"></a><span id="l54.40" class="difflineplus">+var {</span>
<a href="#l54.41"></a><span id="l54.41" class="difflineplus">+  add_cloud_attachments,</span>
<a href="#l54.42"></a><span id="l54.42" class="difflineplus">+  assert_previous_text,</span>
<a href="#l54.43"></a><span id="l54.43" class="difflineplus">+  get_compose_body,</span>
<a href="#l54.44"></a><span id="l54.44" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l54.45"></a><span id="l54.45" class="difflineplus">+  open_compose_with_forward,</span>
<a href="#l54.46"></a><span id="l54.46" class="difflineplus">+  open_compose_with_reply,</span>
<a href="#l54.47"></a><span id="l54.47" class="difflineplus">+  type_in_composer,</span>
<a href="#l54.48"></a><span id="l54.48" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l54.49"></a><span id="l54.49" class="difflineplus">+var {</span>
<a href="#l54.50"></a><span id="l54.50" class="difflineplus">+  assert_next_nodes,</span>
<a href="#l54.51"></a><span id="l54.51" class="difflineplus">+  assert_previous_nodes,</span>
<a href="#l54.52"></a><span id="l54.52" class="difflineplus">+  wait_for_element,</span>
<a href="#l54.53"></a><span id="l54.53" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/DOMHelpers.jsm&quot;);</span>
<a href="#l54.54"></a><span id="l54.54" class="difflineplus">+var {</span>
<a href="#l54.55"></a><span id="l54.55" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l54.56"></a><span id="l54.56" class="difflineplus">+  assert_equals,</span>
<a href="#l54.57"></a><span id="l54.57" class="difflineplus">+  assert_not_equals,</span>
<a href="#l54.58"></a><span id="l54.58" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l54.59"></a><span id="l54.59" class="difflineplus">+  assert_true,</span>
<a href="#l54.60"></a><span id="l54.60" class="difflineplus">+  be_in_folder,</span>
<a href="#l54.61"></a><span id="l54.61" class="difflineplus">+  create_message,</span>
<a href="#l54.62"></a><span id="l54.62" class="difflineplus">+  FAKE_SERVER_HOSTNAME,</span>
<a href="#l54.63"></a><span id="l54.63" class="difflineplus">+  get_special_folder,</span>
<a href="#l54.64"></a><span id="l54.64" class="difflineplus">+  mc,</span>
<a href="#l54.65"></a><span id="l54.65" class="difflineplus">+  select_click_row,</span>
<a href="#l54.66"></a><span id="l54.66" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l54.67"></a><span id="l54.67" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l54.68"></a><span id="l54.68" class="difflineplus">+);</span>
<a href="#l54.69"></a><span id="l54.69"> var { close_window } = ChromeUtils.import(</span>
<a href="#l54.70"></a><span id="l54.70">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l54.71"></a><span id="l54.71"> );</span>
<a href="#l54.72"></a><span id="l54.72"> </span>
<a href="#l54.73"></a><span id="l54.73"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l54.74"></a><span id="l54.74"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l54.75"></a><span id="l54.75">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l54.76"></a><span id="l54.76"> );</span>
<a href="#l54.77"></a><span id="l54.77" class="difflineat">@@ -50,20 +72,16 @@ var kSigOnForwardKey = &quot;mail.identity.de</span>
<a href="#l54.78"></a><span id="l54.78"> var kDefaultSigKey = &quot;mail.identity.id1.htmlSigText&quot;;</span>
<a href="#l54.79"></a><span id="l54.79"> var kDefaultSig = &quot;This is my signature.\n\nCheck out my website sometime!&quot;;</span>
<a href="#l54.80"></a><span id="l54.80"> var kFiles = [&quot;./data/testFile1&quot;, &quot;./data/testFile2&quot;];</span>
<a href="#l54.81"></a><span id="l54.81"> var kLines = [&quot;This is a line of text&quot;, &quot;and here's another!&quot;];</span>
<a href="#l54.82"></a><span id="l54.82"> </span>
<a href="#l54.83"></a><span id="l54.83"> var gInbox, gOldHtmlPref, gOldSigPref;</span>
<a href="#l54.84"></a><span id="l54.84"> </span>
<a href="#l54.85"></a><span id="l54.85"> function setupModule(module) {</span>
<a href="#l54.86"></a><span id="l54.86" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l54.87"></a><span id="l54.87" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l54.88"></a><span id="l54.88" class="difflineminus">-  }</span>
<a href="#l54.89"></a><span id="l54.89" class="difflineminus">-</span>
<a href="#l54.90"></a><span id="l54.90">   // For replies and forwards, we'll work off a message in the Inbox folder</span>
<a href="#l54.91"></a><span id="l54.91">   // of the fake &quot;tinderbox&quot; account.</span>
<a href="#l54.92"></a><span id="l54.92">   let server = MailServices.accounts.FindServer(</span>
<a href="#l54.93"></a><span id="l54.93">     &quot;tinderbox&quot;,</span>
<a href="#l54.94"></a><span id="l54.94">     FAKE_SERVER_HOSTNAME,</span>
<a href="#l54.95"></a><span id="l54.95">     &quot;pop3&quot;</span>
<a href="#l54.96"></a><span id="l54.96">   );</span>
<a href="#l54.97"></a><span id="l54.97">   gInbox = get_special_folder(Ci.nsMsgFolderFlags.Inbox, false, server);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/mail/test/mozmill/cloudfile/test-cloudfile-manager.js</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/mail/test/mozmill/cloudfile/test-cloudfile-manager.js</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -4,45 +4,39 @@</span>
<a href="#l55.4"></a><span id="l55.4"> </span>
<a href="#l55.5"></a><span id="l55.5"> /**</span>
<a href="#l55.6"></a><span id="l55.6">  * Tests the richlistbox in the manager for attachment storage</span>
<a href="#l55.7"></a><span id="l55.7">  * services</span>
<a href="#l55.8"></a><span id="l55.8">  */</span>
<a href="#l55.9"></a><span id="l55.9"> </span>
<a href="#l55.10"></a><span id="l55.10"> &quot;use strict&quot;;</span>
<a href="#l55.11"></a><span id="l55.11"> </span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-cloudfile-helpers.js */</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l55.14"></a><span id="l55.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l55.15"></a><span id="l55.15" class="difflineminus">-/* import-globals-from ../shared-modules/test-pref-window-helpers.js */</span>
<a href="#l55.16"></a><span id="l55.16" class="difflineminus">-</span>
<a href="#l55.17"></a><span id="l55.17" class="difflineminus">-var MODULE_NAME = &quot;test-cloudfile-manager&quot;;</span>
<a href="#l55.18"></a><span id="l55.18" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l55.19"></a><span id="l55.19" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l55.20"></a><span id="l55.20" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l55.21"></a><span id="l55.21" class="difflineminus">-  &quot;pref-window-helpers&quot;,</span>
<a href="#l55.22"></a><span id="l55.22" class="difflineminus">-  &quot;content-tab-helpers&quot;,</span>
<a href="#l55.23"></a><span id="l55.23" class="difflineminus">-  &quot;cloudfile-helpers&quot;,</span>
<a href="#l55.24"></a><span id="l55.24" class="difflineminus">-];</span>
<a href="#l55.25"></a><span id="l55.25" class="difflineminus">-</span>
<a href="#l55.26"></a><span id="l55.26" class="difflineplus">+var { gMockCloudfileManager } = ChromeUtils.import(</span>
<a href="#l55.27"></a><span id="l55.27" class="difflineplus">+  &quot;resource://testing-common/mozmill/CloudfileHelpers.jsm&quot;</span>
<a href="#l55.28"></a><span id="l55.28" class="difflineplus">+);</span>
<a href="#l55.29"></a><span id="l55.29" class="difflineplus">+var { content_tab_e, gMockExtProtSvc, gMockExtProtSvcReg } = ChromeUtils.import(</span>
<a href="#l55.30"></a><span id="l55.30" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l55.31"></a><span id="l55.31" class="difflineplus">+);</span>
<a href="#l55.32"></a><span id="l55.32" class="difflineplus">+var { assert_equals, mc } = ChromeUtils.import(</span>
<a href="#l55.33"></a><span id="l55.33" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l55.34"></a><span id="l55.34" class="difflineplus">+);</span>
<a href="#l55.35"></a><span id="l55.35" class="difflineplus">+var { close_pref_tab, open_pref_tab } = ChromeUtils.import(</span>
<a href="#l55.36"></a><span id="l55.36" class="difflineplus">+  &quot;resource://testing-common/mozmill/PrefTabHelpers.jsm&quot;</span>
<a href="#l55.37"></a><span id="l55.37" class="difflineplus">+);</span>
<a href="#l55.38"></a><span id="l55.38"> var { wait_for_frame_load } = ChromeUtils.import(</span>
<a href="#l55.39"></a><span id="l55.39">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l55.40"></a><span id="l55.40"> );</span>
<a href="#l55.41"></a><span id="l55.41"> </span>
<a href="#l55.42"></a><span id="l55.42"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l55.43"></a><span id="l55.43"> </span>
<a href="#l55.44"></a><span id="l55.44"> var kTestAccountType = &quot;mock&quot;;</span>
<a href="#l55.45"></a><span id="l55.45"> var kRootURL = collector.addHttpResource(&quot;../cloudfile/html&quot;, &quot;&quot;);</span>
<a href="#l55.46"></a><span id="l55.46"> var kSettingsWithLink = kRootURL + &quot;settings-with-link.xhtml&quot;;</span>
<a href="#l55.47"></a><span id="l55.47"> </span>
<a href="#l55.48"></a><span id="l55.48"> function setupModule(module) {</span>
<a href="#l55.49"></a><span id="l55.49" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l55.50"></a><span id="l55.50" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l55.51"></a><span id="l55.51" class="difflineminus">-  }</span>
<a href="#l55.52"></a><span id="l55.52" class="difflineminus">-</span>
<a href="#l55.53"></a><span id="l55.53">   gMockCloudfileManager.register(kTestAccountType, {</span>
<a href="#l55.54"></a><span id="l55.54">     managementURL: kSettingsWithLink,</span>
<a href="#l55.55"></a><span id="l55.55">   });</span>
<a href="#l55.56"></a><span id="l55.56"> </span>
<a href="#l55.57"></a><span id="l55.57">   // Let's set up a few dummy accounts;</span>
<a href="#l55.58"></a><span id="l55.58">   create_dummy_account(&quot;someKey1&quot;, kTestAccountType, &quot;carl's Account&quot;);</span>
<a href="#l55.59"></a><span id="l55.59">   create_dummy_account(&quot;someKey2&quot;, kTestAccountType, &quot;Amber's Account&quot;);</span>
<a href="#l55.60"></a><span id="l55.60">   create_dummy_account(&quot;someKey3&quot;, kTestAccountType, &quot;alice's Account&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -3,36 +3,40 @@</span>
<a href="#l56.4"></a><span id="l56.4">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l56.5"></a><span id="l56.5"> </span>
<a href="#l56.6"></a><span id="l56.6"> /**</span>
<a href="#l56.7"></a><span id="l56.7">  * Tests that the cloudfile notifications work as they should.</span>
<a href="#l56.8"></a><span id="l56.8">  */</span>
<a href="#l56.9"></a><span id="l56.9"> </span>
<a href="#l56.10"></a><span id="l56.10"> &quot;use strict&quot;;</span>
<a href="#l56.11"></a><span id="l56.11"> </span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l56.14"></a><span id="l56.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-cloudfile-helpers.js */</span>
<a href="#l56.15"></a><span id="l56.15" class="difflineminus">-</span>
<a href="#l56.16"></a><span id="l56.16" class="difflineminus">-var MODULE_NAME = &quot;test-cloudfile-notifications&quot;;</span>
<a href="#l56.17"></a><span id="l56.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l56.18"></a><span id="l56.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l56.19"></a><span id="l56.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l56.20"></a><span id="l56.20" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l56.21"></a><span id="l56.21" class="difflineminus">-  &quot;cloudfile-helpers&quot;,</span>
<a href="#l56.22"></a><span id="l56.22" class="difflineminus">-];</span>
<a href="#l56.23"></a><span id="l56.23" class="difflineminus">-</span>
<a href="#l56.24"></a><span id="l56.24"> var {</span>
<a href="#l56.25"></a><span id="l56.25">   gMockFilePicker,</span>
<a href="#l56.26"></a><span id="l56.26">   gMockFilePickReg,</span>
<a href="#l56.27"></a><span id="l56.27">   select_attachments,</span>
<a href="#l56.28"></a><span id="l56.28"> } = ChromeUtils.import(</span>
<a href="#l56.29"></a><span id="l56.29">   &quot;resource://testing-common/mozmill/AttachmentHelpers.jsm&quot;</span>
<a href="#l56.30"></a><span id="l56.30"> );</span>
<a href="#l56.31"></a><span id="l56.31"> var {</span>
<a href="#l56.32"></a><span id="l56.32" class="difflineplus">+  collectFiles,</span>
<a href="#l56.33"></a><span id="l56.33" class="difflineplus">+  gMockCloudfileManager,</span>
<a href="#l56.34"></a><span id="l56.34" class="difflineplus">+  MockCloudfileAccount,</span>
<a href="#l56.35"></a><span id="l56.35" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l56.36"></a><span id="l56.36" class="difflineplus">+  &quot;resource://testing-common/mozmill/CloudfileHelpers.jsm&quot;</span>
<a href="#l56.37"></a><span id="l56.37" class="difflineplus">+);</span>
<a href="#l56.38"></a><span id="l56.38" class="difflineplus">+var {</span>
<a href="#l56.39"></a><span id="l56.39" class="difflineplus">+  add_attachments,</span>
<a href="#l56.40"></a><span id="l56.40" class="difflineplus">+  add_cloud_attachments,</span>
<a href="#l56.41"></a><span id="l56.41" class="difflineplus">+  close_compose_window,</span>
<a href="#l56.42"></a><span id="l56.42" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l56.43"></a><span id="l56.43" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l56.44"></a><span id="l56.44" class="difflineplus">+var { mc } = ChromeUtils.import(</span>
<a href="#l56.45"></a><span id="l56.45" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l56.46"></a><span id="l56.46" class="difflineplus">+);</span>
<a href="#l56.47"></a><span id="l56.47" class="difflineplus">+var {</span>
<a href="#l56.48"></a><span id="l56.48">   assert_notification_displayed,</span>
<a href="#l56.49"></a><span id="l56.49">   close_notification,</span>
<a href="#l56.50"></a><span id="l56.50">   wait_for_notification_to_stop,</span>
<a href="#l56.51"></a><span id="l56.51"> } = ChromeUtils.import(</span>
<a href="#l56.52"></a><span id="l56.52">   &quot;resource://testing-common/mozmill/NotificationBoxHelpers.jsm&quot;</span>
<a href="#l56.53"></a><span id="l56.53"> );</span>
<a href="#l56.54"></a><span id="l56.54"> var { gMockPromptService } = ChromeUtils.import(</span>
<a href="#l56.55"></a><span id="l56.55">   &quot;resource://testing-common/mozmill/PromptHelpers.jsm&quot;</span>
<a href="#l56.56"></a><span id="l56.56" class="difflineat">@@ -47,20 +51,16 @@ var maxSize, oldInsertNotificationPref;</span>
<a href="#l56.57"></a><span id="l56.57"> </span>
<a href="#l56.58"></a><span id="l56.58"> var kOfferThreshold = &quot;mail.compose.big_attachments.threshold_kb&quot;;</span>
<a href="#l56.59"></a><span id="l56.59"> var kInsertNotificationPref =</span>
<a href="#l56.60"></a><span id="l56.60">   &quot;mail.compose.big_attachments.insert_notification&quot;;</span>
<a href="#l56.61"></a><span id="l56.61"> </span>
<a href="#l56.62"></a><span id="l56.62"> var kBoxId = &quot;compose-notification-bottom&quot;;</span>
<a href="#l56.63"></a><span id="l56.63"> </span>
<a href="#l56.64"></a><span id="l56.64"> function setupModule(module) {</span>
<a href="#l56.65"></a><span id="l56.65" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l56.66"></a><span id="l56.66" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l56.67"></a><span id="l56.67" class="difflineminus">-  }</span>
<a href="#l56.68"></a><span id="l56.68" class="difflineminus">-</span>
<a href="#l56.69"></a><span id="l56.69">   gMockCloudfileManager.register();</span>
<a href="#l56.70"></a><span id="l56.70">   gMockFilePickReg.register();</span>
<a href="#l56.71"></a><span id="l56.71"> </span>
<a href="#l56.72"></a><span id="l56.72">   maxSize = Services.prefs.getIntPref(kOfferThreshold, 0) * 1024;</span>
<a href="#l56.73"></a><span id="l56.73">   oldInsertNotificationPref = Services.prefs.getBoolPref(</span>
<a href="#l56.74"></a><span id="l56.74">     kInsertNotificationPref</span>
<a href="#l56.75"></a><span id="l56.75">   );</span>
<a href="#l56.76"></a><span id="l56.76">   Services.prefs.setBoolPref(kInsertNotificationPref, true);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-address-widgets.js</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-address-widgets.js</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -3,37 +3,43 @@</span>
<a href="#l57.4"></a><span id="l57.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l57.5"></a><span id="l57.5"> </span>
<a href="#l57.6"></a><span id="l57.6"> /**</span>
<a href="#l57.7"></a><span id="l57.7">  * Tests proper enabling of addressing widgets.</span>
<a href="#l57.8"></a><span id="l57.8">  */</span>
<a href="#l57.9"></a><span id="l57.9"> </span>
<a href="#l57.10"></a><span id="l57.10"> &quot;use strict&quot;;</span>
<a href="#l57.11"></a><span id="l57.11"> </span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l57.14"></a><span id="l57.14" class="difflineminus">-</span>
<a href="#l57.15"></a><span id="l57.15" class="difflineminus">-var MODULE_NAME = &quot;test-address-widgets&quot;;</span>
<a href="#l57.16"></a><span id="l57.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l57.17"></a><span id="l57.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l57.18"></a><span id="l57.18" class="difflineplus">+var { close_compose_window, open_compose_new_mail } = ChromeUtils.import(</span>
<a href="#l57.19"></a><span id="l57.19" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l57.20"></a><span id="l57.20" class="difflineplus">+);</span>
<a href="#l57.21"></a><span id="l57.21" class="difflineplus">+var {</span>
<a href="#l57.22"></a><span id="l57.22" class="difflineplus">+  assert_equals,</span>
<a href="#l57.23"></a><span id="l57.23" class="difflineplus">+  assert_false,</span>
<a href="#l57.24"></a><span id="l57.24" class="difflineplus">+  assert_not_equals,</span>
<a href="#l57.25"></a><span id="l57.25" class="difflineplus">+  assert_true,</span>
<a href="#l57.26"></a><span id="l57.26" class="difflineplus">+  be_in_folder,</span>
<a href="#l57.27"></a><span id="l57.27" class="difflineplus">+  FAKE_SERVER_HOSTNAME,</span>
<a href="#l57.28"></a><span id="l57.28" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l57.29"></a><span id="l57.29" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l57.30"></a><span id="l57.30" class="difflineplus">+);</span>
<a href="#l57.31"></a><span id="l57.31"> </span>
<a href="#l57.32"></a><span id="l57.32"> var { fixIterator } = ChromeUtils.import(</span>
<a href="#l57.33"></a><span id="l57.33">   &quot;resource:///modules/iteratorUtils.jsm&quot;</span>
<a href="#l57.34"></a><span id="l57.34"> );</span>
<a href="#l57.35"></a><span id="l57.35" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l57.36"></a><span id="l57.36" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l57.37"></a><span id="l57.37" class="difflineplus">+);</span>
<a href="#l57.38"></a><span id="l57.38"> </span>
<a href="#l57.39"></a><span id="l57.39"> var cwc = null; // compose window controller</span>
<a href="#l57.40"></a><span id="l57.40"> var accountPOP3 = null;</span>
<a href="#l57.41"></a><span id="l57.41"> var accountNNTP = null;</span>
<a href="#l57.42"></a><span id="l57.42"> var originalAccountCount;</span>
<a href="#l57.43"></a><span id="l57.43"> </span>
<a href="#l57.44"></a><span id="l57.44"> function setupModule(module) {</span>
<a href="#l57.45"></a><span id="l57.45" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l57.46"></a><span id="l57.46" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l57.47"></a><span id="l57.47" class="difflineminus">-  }</span>
<a href="#l57.48"></a><span id="l57.48" class="difflineminus">-</span>
<a href="#l57.49"></a><span id="l57.49">   // Ensure we're in the tinderbox account as that has the right identities set</span>
<a href="#l57.50"></a><span id="l57.50">   // up for this test.</span>
<a href="#l57.51"></a><span id="l57.51">   let server = MailServices.accounts.FindServer(</span>
<a href="#l57.52"></a><span id="l57.52">     &quot;tinderbox&quot;,</span>
<a href="#l57.53"></a><span id="l57.53">     FAKE_SERVER_HOSTNAME,</span>
<a href="#l57.54"></a><span id="l57.54">     &quot;pop3&quot;</span>
<a href="#l57.55"></a><span id="l57.55">   );</span>
<a href="#l57.56"></a><span id="l57.56">   accountPOP3 = MailServices.accounts.FindAccountForServer(server);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-attachment-reminder.js</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-attachment-reminder.js</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -3,23 +3,34 @@</span>
<a href="#l58.4"></a><span id="l58.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l58.5"></a><span id="l58.5"> </span>
<a href="#l58.6"></a><span id="l58.6"> /**</span>
<a href="#l58.7"></a><span id="l58.7">  * Tests that the attachment reminder works properly.</span>
<a href="#l58.8"></a><span id="l58.8">  */</span>
<a href="#l58.9"></a><span id="l58.9"> </span>
<a href="#l58.10"></a><span id="l58.10"> &quot;use strict&quot;;</span>
<a href="#l58.11"></a><span id="l58.11"> </span>
<a href="#l58.12"></a><span id="l58.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l58.13"></a><span id="l58.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l58.14"></a><span id="l58.14" class="difflineminus">-</span>
<a href="#l58.15"></a><span id="l58.15" class="difflineminus">-var MODULE_NAME = &quot;test-attachment-reminder&quot;;</span>
<a href="#l58.16"></a><span id="l58.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l58.17"></a><span id="l58.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l58.18"></a><span id="l58.18" class="difflineminus">-</span>
<a href="#l58.19"></a><span id="l58.19" class="difflineplus">+var {</span>
<a href="#l58.20"></a><span id="l58.20" class="difflineplus">+  add_attachments,</span>
<a href="#l58.21"></a><span id="l58.21" class="difflineplus">+  close_compose_window,</span>
<a href="#l58.22"></a><span id="l58.22" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l58.23"></a><span id="l58.23" class="difflineplus">+  setup_msg_contents,</span>
<a href="#l58.24"></a><span id="l58.24" class="difflineplus">+  wait_for_compose_window,</span>
<a href="#l58.25"></a><span id="l58.25" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l58.26"></a><span id="l58.26" class="difflineplus">+var {</span>
<a href="#l58.27"></a><span id="l58.27" class="difflineplus">+  assert_equals,</span>
<a href="#l58.28"></a><span id="l58.28" class="difflineplus">+  assert_true,</span>
<a href="#l58.29"></a><span id="l58.29" class="difflineplus">+  be_in_folder,</span>
<a href="#l58.30"></a><span id="l58.30" class="difflineplus">+  get_special_folder,</span>
<a href="#l58.31"></a><span id="l58.31" class="difflineplus">+  mc,</span>
<a href="#l58.32"></a><span id="l58.32" class="difflineplus">+  press_delete,</span>
<a href="#l58.33"></a><span id="l58.33" class="difflineplus">+  select_click_row,</span>
<a href="#l58.34"></a><span id="l58.34" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l58.35"></a><span id="l58.35" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l58.36"></a><span id="l58.36" class="difflineplus">+);</span>
<a href="#l58.37"></a><span id="l58.37"> var { delete_all_existing } = ChromeUtils.import(</span>
<a href="#l58.38"></a><span id="l58.38">   &quot;resource://testing-common/mozmill/KeyboardHelpers.jsm&quot;</span>
<a href="#l58.39"></a><span id="l58.39"> );</span>
<a href="#l58.40"></a><span id="l58.40"> var {</span>
<a href="#l58.41"></a><span id="l58.41">   assert_notification_displayed,</span>
<a href="#l58.42"></a><span id="l58.42">   check_notification_displayed,</span>
<a href="#l58.43"></a><span id="l58.43">   get_notification_button,</span>
<a href="#l58.44"></a><span id="l58.44">   wait_for_notification_to_show,</span>
<a href="#l58.45"></a><span id="l58.45" class="difflineat">@@ -44,20 +55,16 @@ var { MailServices } = ChromeUtils.impor</span>
<a href="#l58.46"></a><span id="l58.46"> </span>
<a href="#l58.47"></a><span id="l58.47"> var kBoxId = &quot;compose-notification-bottom&quot;;</span>
<a href="#l58.48"></a><span id="l58.48"> var kNotificationId = &quot;attachmentReminder&quot;;</span>
<a href="#l58.49"></a><span id="l58.49"> var kReminderPref = &quot;mail.compose.attachment_reminder&quot;;</span>
<a href="#l58.50"></a><span id="l58.50"> var gDrafts;</span>
<a href="#l58.51"></a><span id="l58.51"> var gOutbox;</span>
<a href="#l58.52"></a><span id="l58.52"> </span>
<a href="#l58.53"></a><span id="l58.53"> function setupModule(module) {</span>
<a href="#l58.54"></a><span id="l58.54" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l58.55"></a><span id="l58.55" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l58.56"></a><span id="l58.56" class="difflineminus">-  }</span>
<a href="#l58.57"></a><span id="l58.57" class="difflineminus">-</span>
<a href="#l58.58"></a><span id="l58.58">   gDrafts = get_special_folder(Ci.nsMsgFolderFlags.Drafts, true);</span>
<a href="#l58.59"></a><span id="l58.59">   gOutbox = get_special_folder(Ci.nsMsgFolderFlags.Queue);</span>
<a href="#l58.60"></a><span id="l58.60"> </span>
<a href="#l58.61"></a><span id="l58.61">   assert_true(Services.prefs.getBoolPref(kReminderPref));</span>
<a href="#l58.62"></a><span id="l58.62"> }</span>
<a href="#l58.63"></a><span id="l58.63"> </span>
<a href="#l58.64"></a><span id="l58.64"> /**</span>
<a href="#l58.65"></a><span id="l58.65">  * Check if the attachment reminder bar is in the wished state.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-attachment.js</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-attachment.js</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -3,35 +3,49 @@</span>
<a href="#l59.4"></a><span id="l59.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l59.5"></a><span id="l59.5"> </span>
<a href="#l59.6"></a><span id="l59.6"> /**</span>
<a href="#l59.7"></a><span id="l59.7">  * Tests attachment handling functionality of the message compose window.</span>
<a href="#l59.8"></a><span id="l59.8">  */</span>
<a href="#l59.9"></a><span id="l59.9"> </span>
<a href="#l59.10"></a><span id="l59.10"> &quot;use strict&quot;;</span>
<a href="#l59.11"></a><span id="l59.11"> </span>
<a href="#l59.12"></a><span id="l59.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l59.13"></a><span id="l59.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l59.14"></a><span id="l59.14" class="difflineminus">-</span>
<a href="#l59.15"></a><span id="l59.15" class="difflineminus">-var MODULE_NAME = &quot;test-attachment&quot;;</span>
<a href="#l59.16"></a><span id="l59.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l59.17"></a><span id="l59.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l59.18"></a><span id="l59.18" class="difflineminus">-</span>
<a href="#l59.19"></a><span id="l59.19"> var elib = ChromeUtils.import(</span>
<a href="#l59.20"></a><span id="l59.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l59.21"></a><span id="l59.21"> );</span>
<a href="#l59.22"></a><span id="l59.22"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l59.23"></a><span id="l59.23"> </span>
<a href="#l59.24"></a><span id="l59.24" class="difflineplus">+var {</span>
<a href="#l59.25"></a><span id="l59.25" class="difflineplus">+  add_attachments,</span>
<a href="#l59.26"></a><span id="l59.26" class="difflineplus">+  close_compose_window,</span>
<a href="#l59.27"></a><span id="l59.27" class="difflineplus">+  delete_attachment,</span>
<a href="#l59.28"></a><span id="l59.28" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l59.29"></a><span id="l59.29" class="difflineplus">+  open_compose_with_forward,</span>
<a href="#l59.30"></a><span id="l59.30" class="difflineplus">+  open_compose_with_forward_as_attachments,</span>
<a href="#l59.31"></a><span id="l59.31" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l59.32"></a><span id="l59.32" class="difflineplus">+var {</span>
<a href="#l59.33"></a><span id="l59.33" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l59.34"></a><span id="l59.34" class="difflineplus">+  assert_equals,</span>
<a href="#l59.35"></a><span id="l59.35" class="difflineplus">+  be_in_folder,</span>
<a href="#l59.36"></a><span id="l59.36" class="difflineplus">+  create_folder,</span>
<a href="#l59.37"></a><span id="l59.37" class="difflineplus">+  create_message,</span>
<a href="#l59.38"></a><span id="l59.38" class="difflineplus">+  select_click_row,</span>
<a href="#l59.39"></a><span id="l59.39" class="difflineplus">+</span>
<a href="#l59.40"></a><span id="l59.40" class="difflineplus">+  wait_for_popup_to_open,</span>
<a href="#l59.41"></a><span id="l59.41" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l59.42"></a><span id="l59.42" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l59.43"></a><span id="l59.43" class="difflineplus">+);</span>
<a href="#l59.44"></a><span id="l59.44"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l59.45"></a><span id="l59.45">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l59.46"></a><span id="l59.46"> );</span>
<a href="#l59.47"></a><span id="l59.47"> </span>
<a href="#l59.48"></a><span id="l59.48"> var { AppConstants } = ChromeUtils.import(</span>
<a href="#l59.49"></a><span id="l59.49">   &quot;resource://gre/modules/AppConstants.jsm&quot;</span>
<a href="#l59.50"></a><span id="l59.50"> );</span>
<a href="#l59.51"></a><span id="l59.51" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l59.52"></a><span id="l59.52"> </span>
<a href="#l59.53"></a><span id="l59.53"> var messenger;</span>
<a href="#l59.54"></a><span id="l59.54"> var folder;</span>
<a href="#l59.55"></a><span id="l59.55"> var epsilon;</span>
<a href="#l59.56"></a><span id="l59.56"> var isWindows;</span>
<a href="#l59.57"></a><span id="l59.57"> var filePrefix;</span>
<a href="#l59.58"></a><span id="l59.58"> </span>
<a href="#l59.59"></a><span id="l59.59"> var rawAttachment =</span>
<a href="#l59.60"></a><span id="l59.60" class="difflineat">@@ -43,20 +57,16 @@ var rawAttachment =</span>
<a href="#l59.61"></a><span id="l59.61"> var b64Attachment =</span>
<a href="#l59.62"></a><span id="l59.62">   &quot;iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwS&quot; +</span>
<a href="#l59.63"></a><span id="l59.63">   &quot;FlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAA&quot; +</span>
<a href="#l59.64"></a><span id="l59.64">   &quot;A5SURBVCiRY/z//z8DKYCJJNXkaGBgYGD4D8NQ5zUgiTVAxeBqSLaBkVRPM0KtIhrQ3km0jwe&quot; +</span>
<a href="#l59.65"></a><span id="l59.65">   &quot;SNQAAlmAY+71EgFoAAAAASUVORK5CYII=&quot;;</span>
<a href="#l59.66"></a><span id="l59.66"> var b64Size = 188;</span>
<a href="#l59.67"></a><span id="l59.67"> </span>
<a href="#l59.68"></a><span id="l59.68"> function setupModule(module) {</span>
<a href="#l59.69"></a><span id="l59.69" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l59.70"></a><span id="l59.70" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l59.71"></a><span id="l59.71" class="difflineminus">-  }</span>
<a href="#l59.72"></a><span id="l59.72" class="difflineminus">-</span>
<a href="#l59.73"></a><span id="l59.73">   folder = create_folder(&quot;ComposeAttachmentA&quot;);</span>
<a href="#l59.74"></a><span id="l59.74"> </span>
<a href="#l59.75"></a><span id="l59.75">   messenger = Cc[&quot;@mozilla.org/messenger;1&quot;].createInstance(Ci.nsIMessenger);</span>
<a href="#l59.76"></a><span id="l59.76"> </span>
<a href="#l59.77"></a><span id="l59.77">   isWindows = &quot;@mozilla.org/windows-registry-key;1&quot; in Cc;</span>
<a href="#l59.78"></a><span id="l59.78"> </span>
<a href="#l59.79"></a><span id="l59.79">   /* Today's gory details (thanks to Jonathan Protzenko): libmime somehow</span>
<a href="#l59.80"></a><span id="l59.80">    * counts the trailing newline for an attachment MIME part. Most of the time,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-base64-display.js</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-base64-display.js</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineat">@@ -3,34 +3,25 @@</span>
<a href="#l60.4"></a><span id="l60.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l60.5"></a><span id="l60.5"> </span>
<a href="#l60.6"></a><span id="l60.6"> /**</span>
<a href="#l60.7"></a><span id="l60.7">  * Tests that messages with &quot;broken&quot; base64 are correctly displayed.</span>
<a href="#l60.8"></a><span id="l60.8">  */</span>
<a href="#l60.9"></a><span id="l60.9"> </span>
<a href="#l60.10"></a><span id="l60.10"> &quot;use strict&quot;;</span>
<a href="#l60.11"></a><span id="l60.11"> </span>
<a href="#l60.12"></a><span id="l60.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l60.13"></a><span id="l60.13" class="difflineminus">-</span>
<a href="#l60.14"></a><span id="l60.14" class="difflineminus">-var MODULE_NAME = &quot;test-base64-display.js&quot;;</span>
<a href="#l60.15"></a><span id="l60.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l60.16"></a><span id="l60.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l60.17"></a><span id="l60.17" class="difflineminus">-</span>
<a href="#l60.18"></a><span id="l60.18"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l60.19"></a><span id="l60.19"> </span>
<a href="#l60.20"></a><span id="l60.20" class="difflineplus">+var { assert_true, open_message_from_file } = ChromeUtils.import(</span>
<a href="#l60.21"></a><span id="l60.21" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l60.22"></a><span id="l60.22" class="difflineplus">+);</span>
<a href="#l60.23"></a><span id="l60.23"> var { close_window } = ChromeUtils.import(</span>
<a href="#l60.24"></a><span id="l60.24">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l60.25"></a><span id="l60.25"> );</span>
<a href="#l60.26"></a><span id="l60.26"> </span>
<a href="#l60.27"></a><span id="l60.27" class="difflineminus">-function setupModule(module) {</span>
<a href="#l60.28"></a><span id="l60.28" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l60.29"></a><span id="l60.29" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l60.30"></a><span id="l60.30" class="difflineminus">-  }</span>
<a href="#l60.31"></a><span id="l60.31" class="difflineminus">-}</span>
<a href="#l60.32"></a><span id="l60.32" class="difflineminus">-</span>
<a href="#l60.33"></a><span id="l60.33"> function test_base64_display() {</span>
<a href="#l60.34"></a><span id="l60.34">   let file = os.getFileForPath(</span>
<a href="#l60.35"></a><span id="l60.35">     os.abspath(&quot;./base64-with-whitespace.eml&quot;, os.getFileForPath(__file__))</span>
<a href="#l60.36"></a><span id="l60.36">   );</span>
<a href="#l60.37"></a><span id="l60.37">   let msgc = open_message_from_file(file);</span>
<a href="#l60.38"></a><span id="l60.38">   let bodyText = msgc.e(&quot;messagepane&quot;).contentDocument.querySelector(&quot;body&quot;)</span>
<a href="#l60.39"></a><span id="l60.39">     .textContent;</span>
<a href="#l60.40"></a><span id="l60.40">   close_window(msgc);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-blocked-content.js</span>
<a href="#l61.2"></a><span id="l61.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-blocked-content.js</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineat">@@ -3,25 +3,33 @@</span>
<a href="#l61.4"></a><span id="l61.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l61.5"></a><span id="l61.5"> </span>
<a href="#l61.6"></a><span id="l61.6"> /**</span>
<a href="#l61.7"></a><span id="l61.7">  * Tests that we do the right thing wrt. blocked resources during composition.</span>
<a href="#l61.8"></a><span id="l61.8">  */</span>
<a href="#l61.9"></a><span id="l61.9"> </span>
<a href="#l61.10"></a><span id="l61.10"> &quot;use strict&quot;;</span>
<a href="#l61.11"></a><span id="l61.11"> </span>
<a href="#l61.12"></a><span id="l61.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l61.13"></a><span id="l61.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l61.14"></a><span id="l61.14" class="difflineminus">-</span>
<a href="#l61.15"></a><span id="l61.15" class="difflineminus">-var MODULE_NAME = &quot;test-blocked-content&quot;;</span>
<a href="#l61.16"></a><span id="l61.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l61.17"></a><span id="l61.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l61.18"></a><span id="l61.18" class="difflineminus">-</span>
<a href="#l61.19"></a><span id="l61.19"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l61.20"></a><span id="l61.20"> </span>
<a href="#l61.21"></a><span id="l61.21" class="difflineplus">+var {</span>
<a href="#l61.22"></a><span id="l61.22" class="difflineplus">+  get_msg_source,</span>
<a href="#l61.23"></a><span id="l61.23" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l61.24"></a><span id="l61.24" class="difflineplus">+  setup_msg_contents,</span>
<a href="#l61.25"></a><span id="l61.25" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l61.26"></a><span id="l61.26" class="difflineplus">+var {</span>
<a href="#l61.27"></a><span id="l61.27" class="difflineplus">+  assert_false,</span>
<a href="#l61.28"></a><span id="l61.28" class="difflineplus">+  assert_true,</span>
<a href="#l61.29"></a><span id="l61.29" class="difflineplus">+  be_in_folder,</span>
<a href="#l61.30"></a><span id="l61.30" class="difflineplus">+  get_special_folder,</span>
<a href="#l61.31"></a><span id="l61.31" class="difflineplus">+  press_delete,</span>
<a href="#l61.32"></a><span id="l61.32" class="difflineplus">+  select_click_row,</span>
<a href="#l61.33"></a><span id="l61.33" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l61.34"></a><span id="l61.34" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l61.35"></a><span id="l61.35" class="difflineplus">+);</span>
<a href="#l61.36"></a><span id="l61.36"> var { wait_for_notification_to_show } = ChromeUtils.import(</span>
<a href="#l61.37"></a><span id="l61.37">   &quot;resource://testing-common/mozmill/NotificationBoxHelpers.jsm&quot;</span>
<a href="#l61.38"></a><span id="l61.38"> );</span>
<a href="#l61.39"></a><span id="l61.39"> var { plan_for_window_close, wait_for_window_close } = ChromeUtils.import(</span>
<a href="#l61.40"></a><span id="l61.40">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l61.41"></a><span id="l61.41"> );</span>
<a href="#l61.42"></a><span id="l61.42"> </span>
<a href="#l61.43"></a><span id="l61.43"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l61.44"></a><span id="l61.44" class="difflineat">@@ -31,19 +39,16 @@ var { MailServices } = ChromeUtils.impor</span>
<a href="#l61.45"></a><span id="l61.45"> var { OS } = ChromeUtils.import(&quot;resource://gre/modules/osfile.jsm&quot;);</span>
<a href="#l61.46"></a><span id="l61.46"> </span>
<a href="#l61.47"></a><span id="l61.47"> var gOutboxFolder;</span>
<a href="#l61.48"></a><span id="l61.48"> </span>
<a href="#l61.49"></a><span id="l61.49"> var kBoxId = &quot;compose-notification-bottom&quot;;</span>
<a href="#l61.50"></a><span id="l61.50"> var kNotificationId = &quot;blockedContent&quot;;</span>
<a href="#l61.51"></a><span id="l61.51"> </span>
<a href="#l61.52"></a><span id="l61.52"> function setupModule(module) {</span>
<a href="#l61.53"></a><span id="l61.53" class="difflineminus">-  for (let req of MODULE_REQUIRES) {</span>
<a href="#l61.54"></a><span id="l61.54" class="difflineminus">-    collector.getModule(req).installInto(module);</span>
<a href="#l61.55"></a><span id="l61.55" class="difflineminus">-  }</span>
<a href="#l61.56"></a><span id="l61.56">   gOutboxFolder = get_special_folder(Ci.nsMsgFolderFlags.Queue);</span>
<a href="#l61.57"></a><span id="l61.57"> }</span>
<a href="#l61.58"></a><span id="l61.58"> </span>
<a href="#l61.59"></a><span id="l61.59"> function putHTMLOnClipboard(html) {</span>
<a href="#l61.60"></a><span id="l61.60">   let trans = Cc[&quot;@mozilla.org/widget/transferable;1&quot;].createInstance(</span>
<a href="#l61.61"></a><span id="l61.61">     Ci.nsITransferable</span>
<a href="#l61.62"></a><span id="l61.62">   );</span>
<a href="#l61.63"></a><span id="l61.63"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-charset-edit.js</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-charset-edit.js</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineat">@@ -4,49 +4,57 @@</span>
<a href="#l62.4"></a><span id="l62.4"> </span>
<a href="#l62.5"></a><span id="l62.5"> /**</span>
<a href="#l62.6"></a><span id="l62.6">  * Tests that we do the right thing wrt. message encoding when editing or</span>
<a href="#l62.7"></a><span id="l62.7">  * replying to messages.</span>
<a href="#l62.8"></a><span id="l62.8">  */</span>
<a href="#l62.9"></a><span id="l62.9"> </span>
<a href="#l62.10"></a><span id="l62.10"> &quot;use strict&quot;;</span>
<a href="#l62.11"></a><span id="l62.11"> </span>
<a href="#l62.12"></a><span id="l62.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l62.13"></a><span id="l62.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l62.14"></a><span id="l62.14" class="difflineminus">-</span>
<a href="#l62.15"></a><span id="l62.15" class="difflineminus">-var MODULE_NAME = &quot;test-charset-edit&quot;;</span>
<a href="#l62.16"></a><span id="l62.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l62.17"></a><span id="l62.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l62.18"></a><span id="l62.18" class="difflineminus">-</span>
<a href="#l62.19"></a><span id="l62.19"> var elib = ChromeUtils.import(</span>
<a href="#l62.20"></a><span id="l62.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l62.21"></a><span id="l62.21"> );</span>
<a href="#l62.22"></a><span id="l62.22"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l62.23"></a><span id="l62.23"> var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l62.24"></a><span id="l62.24"> </span>
<a href="#l62.25"></a><span id="l62.25" class="difflineplus">+var {</span>
<a href="#l62.26"></a><span id="l62.26" class="difflineplus">+  close_compose_window,</span>
<a href="#l62.27"></a><span id="l62.27" class="difflineplus">+  open_compose_with_reply,</span>
<a href="#l62.28"></a><span id="l62.28" class="difflineplus">+  wait_for_compose_window,</span>
<a href="#l62.29"></a><span id="l62.29" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l62.30"></a><span id="l62.30" class="difflineplus">+var {</span>
<a href="#l62.31"></a><span id="l62.31" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l62.32"></a><span id="l62.32" class="difflineplus">+  assert_equals,</span>
<a href="#l62.33"></a><span id="l62.33" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l62.34"></a><span id="l62.34" class="difflineplus">+  be_in_folder,</span>
<a href="#l62.35"></a><span id="l62.35" class="difflineplus">+  create_message,</span>
<a href="#l62.36"></a><span id="l62.36" class="difflineplus">+  get_special_folder,</span>
<a href="#l62.37"></a><span id="l62.37" class="difflineplus">+  mc,</span>
<a href="#l62.38"></a><span id="l62.38" class="difflineplus">+  press_delete,</span>
<a href="#l62.39"></a><span id="l62.39" class="difflineplus">+  select_click_row,</span>
<a href="#l62.40"></a><span id="l62.40" class="difflineplus">+  SyntheticPartLeaf,</span>
<a href="#l62.41"></a><span id="l62.41" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l62.42"></a><span id="l62.42" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l62.43"></a><span id="l62.43" class="difflineplus">+);</span>
<a href="#l62.44"></a><span id="l62.44"> var { wait_for_notification_to_show } = ChromeUtils.import(</span>
<a href="#l62.45"></a><span id="l62.45">   &quot;resource://testing-common/mozmill/NotificationBoxHelpers.jsm&quot;</span>
<a href="#l62.46"></a><span id="l62.46"> );</span>
<a href="#l62.47"></a><span id="l62.47"> var { plan_for_new_window } = ChromeUtils.import(</span>
<a href="#l62.48"></a><span id="l62.48">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l62.49"></a><span id="l62.49"> );</span>
<a href="#l62.50"></a><span id="l62.50"> </span>
<a href="#l62.51"></a><span id="l62.51"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l62.52"></a><span id="l62.52"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l62.53"></a><span id="l62.53">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l62.54"></a><span id="l62.54"> );</span>
<a href="#l62.55"></a><span id="l62.55"> var { MimeParser } = ChromeUtils.import(&quot;resource:///modules/mimeParser.jsm&quot;);</span>
<a href="#l62.56"></a><span id="l62.56"> </span>
<a href="#l62.57"></a><span id="l62.57"> var gDrafts;</span>
<a href="#l62.58"></a><span id="l62.58"> </span>
<a href="#l62.59"></a><span id="l62.59"> function setupModule(module) {</span>
<a href="#l62.60"></a><span id="l62.60" class="difflineminus">-  for (let req of MODULE_REQUIRES) {</span>
<a href="#l62.61"></a><span id="l62.61" class="difflineminus">-    collector.getModule(req).installInto(module);</span>
<a href="#l62.62"></a><span id="l62.62" class="difflineminus">-  }</span>
<a href="#l62.63"></a><span id="l62.63" class="difflineminus">-</span>
<a href="#l62.64"></a><span id="l62.64">   gDrafts = get_special_folder(Ci.nsMsgFolderFlags.Drafts, true);</span>
<a href="#l62.65"></a><span id="l62.65"> </span>
<a href="#l62.66"></a><span id="l62.66">   // Ensure reply charset isn't UTF-8, otherwise there's no need to upgrade,</span>
<a href="#l62.67"></a><span id="l62.67">   // which is what this test tests.</span>
<a href="#l62.68"></a><span id="l62.68">   let str = Cc[&quot;@mozilla.org/pref-localizedstring;1&quot;].createInstance(</span>
<a href="#l62.69"></a><span id="l62.69">     Ci.nsIPrefLocalizedString</span>
<a href="#l62.70"></a><span id="l62.70">   );</span>
<a href="#l62.71"></a><span id="l62.71">   str.data = &quot;windows-1252&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-charset-upgrade.js</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-charset-upgrade.js</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineat">@@ -4,39 +4,45 @@</span>
<a href="#l63.4"></a><span id="l63.4"> </span>
<a href="#l63.5"></a><span id="l63.5"> /**</span>
<a href="#l63.6"></a><span id="l63.6">  * Tests that we do the right thing wrt. message encoding, especially when</span>
<a href="#l63.7"></a><span id="l63.7">  * all characters doesn't fit the selected charset.</span>
<a href="#l63.8"></a><span id="l63.8">  */</span>
<a href="#l63.9"></a><span id="l63.9"> </span>
<a href="#l63.10"></a><span id="l63.10"> &quot;use strict&quot;;</span>
<a href="#l63.11"></a><span id="l63.11"> </span>
<a href="#l63.12"></a><span id="l63.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l63.13"></a><span id="l63.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l63.14"></a><span id="l63.14" class="difflineminus">-</span>
<a href="#l63.15"></a><span id="l63.15" class="difflineminus">-var MODULE_NAME = &quot;test-charset-upgrade&quot;;</span>
<a href="#l63.16"></a><span id="l63.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l63.17"></a><span id="l63.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l63.18"></a><span id="l63.18" class="difflineminus">-</span>
<a href="#l63.19"></a><span id="l63.19" class="difflineplus">+var {</span>
<a href="#l63.20"></a><span id="l63.20" class="difflineplus">+  get_msg_source,</span>
<a href="#l63.21"></a><span id="l63.21" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l63.22"></a><span id="l63.22" class="difflineplus">+  setup_msg_contents,</span>
<a href="#l63.23"></a><span id="l63.23" class="difflineplus">+  type_in_composer,</span>
<a href="#l63.24"></a><span id="l63.24" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l63.25"></a><span id="l63.25" class="difflineplus">+var {</span>
<a href="#l63.26"></a><span id="l63.26" class="difflineplus">+  assert_equals,</span>
<a href="#l63.27"></a><span id="l63.27" class="difflineplus">+  assert_true,</span>
<a href="#l63.28"></a><span id="l63.28" class="difflineplus">+  be_in_folder,</span>
<a href="#l63.29"></a><span id="l63.29" class="difflineplus">+  get_special_folder,</span>
<a href="#l63.30"></a><span id="l63.30" class="difflineplus">+  press_delete,</span>
<a href="#l63.31"></a><span id="l63.31" class="difflineplus">+  select_click_row,</span>
<a href="#l63.32"></a><span id="l63.32" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l63.33"></a><span id="l63.33" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l63.34"></a><span id="l63.34" class="difflineplus">+);</span>
<a href="#l63.35"></a><span id="l63.35"> var { plan_for_window_close, wait_for_window_close } = ChromeUtils.import(</span>
<a href="#l63.36"></a><span id="l63.36">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l63.37"></a><span id="l63.37"> );</span>
<a href="#l63.38"></a><span id="l63.38"> </span>
<a href="#l63.39"></a><span id="l63.39"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l63.40"></a><span id="l63.40"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l63.41"></a><span id="l63.41">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l63.42"></a><span id="l63.42"> );</span>
<a href="#l63.43"></a><span id="l63.43"> </span>
<a href="#l63.44"></a><span id="l63.44"> var gDrafts;</span>
<a href="#l63.45"></a><span id="l63.45"> var gOutbox;</span>
<a href="#l63.46"></a><span id="l63.46"> </span>
<a href="#l63.47"></a><span id="l63.47"> function setupModule(module) {</span>
<a href="#l63.48"></a><span id="l63.48" class="difflineminus">-  for (let req of MODULE_REQUIRES) {</span>
<a href="#l63.49"></a><span id="l63.49" class="difflineminus">-    collector.getModule(req).installInto(module);</span>
<a href="#l63.50"></a><span id="l63.50" class="difflineminus">-  }</span>
<a href="#l63.51"></a><span id="l63.51">   gDrafts = get_special_folder(Ci.nsMsgFolderFlags.Drafts, true);</span>
<a href="#l63.52"></a><span id="l63.52">   gOutbox = get_special_folder(Ci.nsMsgFolderFlags.Queue);</span>
<a href="#l63.53"></a><span id="l63.53"> </span>
<a href="#l63.54"></a><span id="l63.54">   // Ensure reply charset isn't UTF-8, otherwise there's no need to upgrade,</span>
<a href="#l63.55"></a><span id="l63.55">   //  which is what this test tests.</span>
<a href="#l63.56"></a><span id="l63.56">   let str = Cc[&quot;@mozilla.org/pref-localizedstring;1&quot;].createInstance(</span>
<a href="#l63.57"></a><span id="l63.57">     Ci.nsIPrefLocalizedString</span>
<a href="#l63.58"></a><span id="l63.58">   );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-cp932-display.js</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-cp932-display.js</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineat">@@ -3,34 +3,25 @@</span>
<a href="#l64.4"></a><span id="l64.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l64.5"></a><span id="l64.5"> </span>
<a href="#l64.6"></a><span id="l64.6"> /**</span>
<a href="#l64.7"></a><span id="l64.7">  * Tests that messages in cp932, Thunderbirds alias for Shift_JIS, are correctly displayed.</span>
<a href="#l64.8"></a><span id="l64.8">  */</span>
<a href="#l64.9"></a><span id="l64.9"> </span>
<a href="#l64.10"></a><span id="l64.10"> &quot;use strict&quot;;</span>
<a href="#l64.11"></a><span id="l64.11"> </span>
<a href="#l64.12"></a><span id="l64.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l64.13"></a><span id="l64.13" class="difflineminus">-</span>
<a href="#l64.14"></a><span id="l64.14" class="difflineminus">-var MODULE_NAME = &quot;test-cp932-display.js&quot;;</span>
<a href="#l64.15"></a><span id="l64.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l64.16"></a><span id="l64.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l64.17"></a><span id="l64.17" class="difflineminus">-</span>
<a href="#l64.18"></a><span id="l64.18"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l64.19"></a><span id="l64.19"> </span>
<a href="#l64.20"></a><span id="l64.20" class="difflineplus">+var { assert_true, open_message_from_file } = ChromeUtils.import(</span>
<a href="#l64.21"></a><span id="l64.21" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l64.22"></a><span id="l64.22" class="difflineplus">+);</span>
<a href="#l64.23"></a><span id="l64.23"> var { close_window } = ChromeUtils.import(</span>
<a href="#l64.24"></a><span id="l64.24">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l64.25"></a><span id="l64.25"> );</span>
<a href="#l64.26"></a><span id="l64.26"> </span>
<a href="#l64.27"></a><span id="l64.27" class="difflineminus">-function setupModule(module) {</span>
<a href="#l64.28"></a><span id="l64.28" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l64.29"></a><span id="l64.29" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l64.30"></a><span id="l64.30" class="difflineminus">-  }</span>
<a href="#l64.31"></a><span id="l64.31" class="difflineminus">-}</span>
<a href="#l64.32"></a><span id="l64.32" class="difflineminus">-</span>
<a href="#l64.33"></a><span id="l64.33"> function test_cp932_display() {</span>
<a href="#l64.34"></a><span id="l64.34">   let file = os.getFileForPath(</span>
<a href="#l64.35"></a><span id="l64.35">     os.abspath(&quot;./charset-cp932.eml&quot;, os.getFileForPath(__file__))</span>
<a href="#l64.36"></a><span id="l64.36">   );</span>
<a href="#l64.37"></a><span id="l64.37">   let msgc = open_message_from_file(file);</span>
<a href="#l64.38"></a><span id="l64.38">   let subjectText = msgc.e(&quot;expandedsubjectBox&quot;).textContent;</span>
<a href="#l64.39"></a><span id="l64.39">   let bodyText = msgc.e(&quot;messagepane&quot;).contentDocument.querySelector(&quot;body&quot;)</span>
<a href="#l64.40"></a><span id="l64.40">     .textContent;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-draft-identity.js</span>
<a href="#l65.2"></a><span id="l65.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-draft-identity.js</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineat">@@ -4,23 +4,29 @@</span>
<a href="#l65.4"></a><span id="l65.4"> </span>
<a href="#l65.5"></a><span id="l65.5"> /**</span>
<a href="#l65.6"></a><span id="l65.6">  * Tests that compose new message chooses the correct initial identity when</span>
<a href="#l65.7"></a><span id="l65.7">  * called from the context of an open composer.</span>
<a href="#l65.8"></a><span id="l65.8">  */</span>
<a href="#l65.9"></a><span id="l65.9"> </span>
<a href="#l65.10"></a><span id="l65.10"> &quot;use strict&quot;;</span>
<a href="#l65.11"></a><span id="l65.11"> </span>
<a href="#l65.12"></a><span id="l65.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l65.13"></a><span id="l65.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l65.14"></a><span id="l65.14" class="difflineminus">-</span>
<a href="#l65.15"></a><span id="l65.15" class="difflineminus">-var MODULE_NAME = &quot;test-draft-identity&quot;;</span>
<a href="#l65.16"></a><span id="l65.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l65.17"></a><span id="l65.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l65.18"></a><span id="l65.18" class="difflineminus">-</span>
<a href="#l65.19"></a><span id="l65.19" class="difflineplus">+var { close_compose_window, open_compose_from_draft } = ChromeUtils.import(</span>
<a href="#l65.20"></a><span id="l65.20" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l65.21"></a><span id="l65.21" class="difflineplus">+);</span>
<a href="#l65.22"></a><span id="l65.22" class="difflineplus">+var {</span>
<a href="#l65.23"></a><span id="l65.23" class="difflineplus">+  assert_equals,</span>
<a href="#l65.24"></a><span id="l65.24" class="difflineplus">+  be_in_folder,</span>
<a href="#l65.25"></a><span id="l65.25" class="difflineplus">+  get_special_folder,</span>
<a href="#l65.26"></a><span id="l65.26" class="difflineplus">+  mc,</span>
<a href="#l65.27"></a><span id="l65.27" class="difflineplus">+  press_delete,</span>
<a href="#l65.28"></a><span id="l65.28" class="difflineplus">+  select_click_row,</span>
<a href="#l65.29"></a><span id="l65.29" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l65.30"></a><span id="l65.30" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l65.31"></a><span id="l65.31" class="difflineplus">+);</span>
<a href="#l65.32"></a><span id="l65.32"> var {</span>
<a href="#l65.33"></a><span id="l65.33">   assert_notification_displayed,</span>
<a href="#l65.34"></a><span id="l65.34">   wait_for_notification_to_show,</span>
<a href="#l65.35"></a><span id="l65.35"> } = ChromeUtils.import(</span>
<a href="#l65.36"></a><span id="l65.36">   &quot;resource://testing-common/mozmill/NotificationBoxHelpers.jsm&quot;</span>
<a href="#l65.37"></a><span id="l65.37"> );</span>
<a href="#l65.38"></a><span id="l65.38"> </span>
<a href="#l65.39"></a><span id="l65.39"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l65.40"></a><span id="l65.40" class="difflineat">@@ -36,20 +42,16 @@ var gIdentities = [</span>
<a href="#l65.41"></a><span id="l65.41">   { email: &quot;y@example.invalid&quot;, fullname: &quot;User Y&quot; },</span>
<a href="#l65.42"></a><span id="l65.42">   { email: &quot;y@example.invalid&quot;, fullname: &quot;User YY&quot;, label: &quot;YY&quot; },</span>
<a href="#l65.43"></a><span id="l65.43">   { email: &quot;y+y@example.invalid&quot;, fullname: &quot;User Y&quot; },</span>
<a href="#l65.44"></a><span id="l65.44">   { email: &quot;z@example.invalid&quot;, fullname: &quot;User Z&quot;, label: &quot;Label Z&quot; },</span>
<a href="#l65.45"></a><span id="l65.45">   { email: &quot;a+b@example.invalid&quot;, fullname: &quot;User A&quot; },</span>
<a href="#l65.46"></a><span id="l65.46"> ];</span>
<a href="#l65.47"></a><span id="l65.47"> </span>
<a href="#l65.48"></a><span id="l65.48"> function setupModule(module) {</span>
<a href="#l65.49"></a><span id="l65.49" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l65.50"></a><span id="l65.50" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l65.51"></a><span id="l65.51" class="difflineminus">-  }</span>
<a href="#l65.52"></a><span id="l65.52" class="difflineminus">-</span>
<a href="#l65.53"></a><span id="l65.53">   // Now set up an account with some identities.</span>
<a href="#l65.54"></a><span id="l65.54">   let acctMgr = MailServices.accounts;</span>
<a href="#l65.55"></a><span id="l65.55">   gAccount = acctMgr.createAccount();</span>
<a href="#l65.56"></a><span id="l65.56">   gAccount.incomingServer = acctMgr.createIncomingServer(</span>
<a href="#l65.57"></a><span id="l65.57">     &quot;nobody&quot;,</span>
<a href="#l65.58"></a><span id="l65.58">     &quot;Draft Identity Testing&quot;,</span>
<a href="#l65.59"></a><span id="l65.59">     &quot;pop3&quot;</span>
<a href="#l65.60"></a><span id="l65.60">   );</span>
<a href="#l65.61"></a><span id="l65.61" class="difflineat">@@ -225,17 +227,17 @@ function test_draft_identity_selection()</span>
<a href="#l65.62"></a><span id="l65.62">     },</span>
<a href="#l65.63"></a><span id="l65.63">   ];</span>
<a href="#l65.64"></a><span id="l65.64"> </span>
<a href="#l65.65"></a><span id="l65.65">   for (let test of tests) {</span>
<a href="#l65.66"></a><span id="l65.66">     test.draftIndex = create_draft(test.draftFrom, test.draftIdKey);</span>
<a href="#l65.67"></a><span id="l65.67">   }</span>
<a href="#l65.68"></a><span id="l65.68"> </span>
<a href="#l65.69"></a><span id="l65.69">   for (let test of tests) {</span>
<a href="#l65.70"></a><span id="l65.70" class="difflineminus">-    dump(&quot;Running draft identity test&quot; + tests.indexOf(test));</span>
<a href="#l65.71"></a><span id="l65.71" class="difflineplus">+    dump(&quot;Running draft identity test&quot; + tests.indexOf(test) + &quot;\n&quot;);</span>
<a href="#l65.72"></a><span id="l65.72">     be_in_folder(gDrafts);</span>
<a href="#l65.73"></a><span id="l65.73">     select_click_row(test.draftIndex);</span>
<a href="#l65.74"></a><span id="l65.74"> </span>
<a href="#l65.75"></a><span id="l65.75">     let cwc = open_compose_from_draft();</span>
<a href="#l65.76"></a><span id="l65.76">     checkCompIdentity(</span>
<a href="#l65.77"></a><span id="l65.77">       cwc,</span>
<a href="#l65.78"></a><span id="l65.78">       gIdentities[test.idIndex].key,</span>
<a href="#l65.79"></a><span id="l65.79">       test.from ? test.from : test.draftFrom</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l66.1"></a><span id="l66.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-drafts.js</span>
<a href="#l66.2"></a><span id="l66.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-drafts.js</span>
<a href="#l66.3"></a><span id="l66.3" class="difflineat">@@ -4,43 +4,54 @@</span>
<a href="#l66.4"></a><span id="l66.4"> </span>
<a href="#l66.5"></a><span id="l66.5"> /**</span>
<a href="#l66.6"></a><span id="l66.6">  * Tests draft related functionality:</span>
<a href="#l66.7"></a><span id="l66.7">  * - that we don't allow opening multiple copies of a draft.</span>
<a href="#l66.8"></a><span id="l66.8">  */</span>
<a href="#l66.9"></a><span id="l66.9"> </span>
<a href="#l66.10"></a><span id="l66.10"> &quot;use strict&quot;;</span>
<a href="#l66.11"></a><span id="l66.11"> </span>
<a href="#l66.12"></a><span id="l66.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l66.13"></a><span id="l66.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l66.14"></a><span id="l66.14" class="difflineplus">+var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l66.15"></a><span id="l66.15"> </span>
<a href="#l66.16"></a><span id="l66.16" class="difflineminus">-var MODULE_NAME = &quot;test-drafts&quot;;</span>
<a href="#l66.17"></a><span id="l66.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l66.18"></a><span id="l66.18" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l66.19"></a><span id="l66.19" class="difflineminus">-</span>
<a href="#l66.20"></a><span id="l66.20" class="difflineplus">+var {</span>
<a href="#l66.21"></a><span id="l66.21" class="difflineplus">+  close_compose_window,</span>
<a href="#l66.22"></a><span id="l66.22" class="difflineplus">+  get_compose_body,</span>
<a href="#l66.23"></a><span id="l66.23" class="difflineplus">+  get_msg_source,</span>
<a href="#l66.24"></a><span id="l66.24" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l66.25"></a><span id="l66.25" class="difflineplus">+  setup_msg_contents,</span>
<a href="#l66.26"></a><span id="l66.26" class="difflineplus">+  wait_for_compose_window,</span>
<a href="#l66.27"></a><span id="l66.27" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l66.28"></a><span id="l66.28" class="difflineplus">+var {</span>
<a href="#l66.29"></a><span id="l66.29" class="difflineplus">+  assert_equals,</span>
<a href="#l66.30"></a><span id="l66.30" class="difflineplus">+  assert_true,</span>
<a href="#l66.31"></a><span id="l66.31" class="difflineplus">+  be_in_folder,</span>
<a href="#l66.32"></a><span id="l66.32" class="difflineplus">+  get_special_folder,</span>
<a href="#l66.33"></a><span id="l66.33" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l66.34"></a><span id="l66.34" class="difflineplus">+  mc,</span>
<a href="#l66.35"></a><span id="l66.35" class="difflineplus">+  press_delete,</span>
<a href="#l66.36"></a><span id="l66.36" class="difflineplus">+  select_click_row,</span>
<a href="#l66.37"></a><span id="l66.37" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l66.38"></a><span id="l66.38" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l66.39"></a><span id="l66.39" class="difflineplus">+);</span>
<a href="#l66.40"></a><span id="l66.40"> var { wait_for_notification_to_show } = ChromeUtils.import(</span>
<a href="#l66.41"></a><span id="l66.41">   &quot;resource://testing-common/mozmill/NotificationBoxHelpers.jsm&quot;</span>
<a href="#l66.42"></a><span id="l66.42"> );</span>
<a href="#l66.43"></a><span id="l66.43"> var { plan_for_new_window, wait_for_window_focused } = ChromeUtils.import(</span>
<a href="#l66.44"></a><span id="l66.44">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l66.45"></a><span id="l66.45"> );</span>
<a href="#l66.46"></a><span id="l66.46"> </span>
<a href="#l66.47"></a><span id="l66.47"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l66.48"></a><span id="l66.48"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l66.49"></a><span id="l66.49">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l66.50"></a><span id="l66.50"> );</span>
<a href="#l66.51"></a><span id="l66.51"> </span>
<a href="#l66.52"></a><span id="l66.52"> var kBoxId = &quot;mail-notification-top&quot;;</span>
<a href="#l66.53"></a><span id="l66.53"> var draftsFolder;</span>
<a href="#l66.54"></a><span id="l66.54"> </span>
<a href="#l66.55"></a><span id="l66.55"> function setupModule(module) {</span>
<a href="#l66.56"></a><span id="l66.56" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l66.57"></a><span id="l66.57" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l66.58"></a><span id="l66.58" class="difflineminus">-  }</span>
<a href="#l66.59"></a><span id="l66.59" class="difflineminus">-</span>
<a href="#l66.60"></a><span id="l66.60">   draftsFolder = get_special_folder(Ci.nsMsgFolderFlags.Drafts, true);</span>
<a href="#l66.61"></a><span id="l66.61"> }</span>
<a href="#l66.62"></a><span id="l66.62"> </span>
<a href="#l66.63"></a><span id="l66.63"> /**</span>
<a href="#l66.64"></a><span id="l66.64">  * Bug 349547.</span>
<a href="#l66.65"></a><span id="l66.65">  * Tests that we only open one compose window for one instance of a draft.</span>
<a href="#l66.66"></a><span id="l66.66">  */</span>
<a href="#l66.67"></a><span id="l66.67"> function test_open_draft_again() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l67.1"></a><span id="l67.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-eml-actions.js</span>
<a href="#l67.2"></a><span id="l67.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-eml-actions.js</span>
<a href="#l67.3"></a><span id="l67.3" class="difflineat">@@ -3,43 +3,48 @@</span>
<a href="#l67.4"></a><span id="l67.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l67.5"></a><span id="l67.5"> </span>
<a href="#l67.6"></a><span id="l67.6"> /**</span>
<a href="#l67.7"></a><span id="l67.7">  * Tests that actions such as replying to an .eml works properly.</span>
<a href="#l67.8"></a><span id="l67.8">  */</span>
<a href="#l67.9"></a><span id="l67.9"> </span>
<a href="#l67.10"></a><span id="l67.10"> &quot;use strict&quot;;</span>
<a href="#l67.11"></a><span id="l67.11"> </span>
<a href="#l67.12"></a><span id="l67.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l67.13"></a><span id="l67.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l67.14"></a><span id="l67.14" class="difflineminus">-</span>
<a href="#l67.15"></a><span id="l67.15" class="difflineminus">-var MODULE_NAME = &quot;test-eml-actions&quot;;</span>
<a href="#l67.16"></a><span id="l67.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l67.17"></a><span id="l67.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l67.18"></a><span id="l67.18" class="difflineminus">-</span>
<a href="#l67.19"></a><span id="l67.19"> var elib = ChromeUtils.import(</span>
<a href="#l67.20"></a><span id="l67.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l67.21"></a><span id="l67.21"> );</span>
<a href="#l67.22"></a><span id="l67.22"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l67.23"></a><span id="l67.23"> </span>
<a href="#l67.24"></a><span id="l67.24" class="difflineplus">+var {</span>
<a href="#l67.25"></a><span id="l67.25" class="difflineplus">+  close_compose_window,</span>
<a href="#l67.26"></a><span id="l67.26" class="difflineplus">+  get_compose_body,</span>
<a href="#l67.27"></a><span id="l67.27" class="difflineplus">+  open_compose_with_forward,</span>
<a href="#l67.28"></a><span id="l67.28" class="difflineplus">+  open_compose_with_reply,</span>
<a href="#l67.29"></a><span id="l67.29" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l67.30"></a><span id="l67.30" class="difflineplus">+var {</span>
<a href="#l67.31"></a><span id="l67.31" class="difflineplus">+  assert_equals,</span>
<a href="#l67.32"></a><span id="l67.32" class="difflineplus">+  be_in_folder,</span>
<a href="#l67.33"></a><span id="l67.33" class="difflineplus">+  get_special_folder,</span>
<a href="#l67.34"></a><span id="l67.34" class="difflineplus">+  open_message_from_file,</span>
<a href="#l67.35"></a><span id="l67.35" class="difflineplus">+  press_delete,</span>
<a href="#l67.36"></a><span id="l67.36" class="difflineplus">+  select_click_row,</span>
<a href="#l67.37"></a><span id="l67.37" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l67.38"></a><span id="l67.38" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l67.39"></a><span id="l67.39" class="difflineplus">+);</span>
<a href="#l67.40"></a><span id="l67.40"> var { close_window } = ChromeUtils.import(</span>
<a href="#l67.41"></a><span id="l67.41">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l67.42"></a><span id="l67.42"> );</span>
<a href="#l67.43"></a><span id="l67.43"> </span>
<a href="#l67.44"></a><span id="l67.44"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l67.45"></a><span id="l67.45">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l67.46"></a><span id="l67.46"> );</span>
<a href="#l67.47"></a><span id="l67.47"> </span>
<a href="#l67.48"></a><span id="l67.48"> var gDrafts;</span>
<a href="#l67.49"></a><span id="l67.49"> </span>
<a href="#l67.50"></a><span id="l67.50"> function setupModule(module) {</span>
<a href="#l67.51"></a><span id="l67.51" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l67.52"></a><span id="l67.52" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l67.53"></a><span id="l67.53" class="difflineminus">-  }</span>
<a href="#l67.54"></a><span id="l67.54" class="difflineminus">-</span>
<a href="#l67.55"></a><span id="l67.55">   gDrafts = get_special_folder(Ci.nsMsgFolderFlags.Drafts, true);</span>
<a href="#l67.56"></a><span id="l67.56"> }</span>
<a href="#l67.57"></a><span id="l67.57"> </span>
<a href="#l67.58"></a><span id="l67.58"> /**</span>
<a href="#l67.59"></a><span id="l67.59">  * Test that replying to an opened .eml message works, and that the reply can</span>
<a href="#l67.60"></a><span id="l67.60">  * be saved as a draft.</span>
<a href="#l67.61"></a><span id="l67.61">  */</span>
<a href="#l67.62"></a><span id="l67.62"> function test_reply_to_eml_save_as_draft() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l68.1"></a><span id="l68.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-focus.js</span>
<a href="#l68.2"></a><span id="l68.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-focus.js</span>
<a href="#l68.3"></a><span id="l68.3" class="difflineat">@@ -3,28 +3,24 @@</span>
<a href="#l68.4"></a><span id="l68.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l68.5"></a><span id="l68.5"> </span>
<a href="#l68.6"></a><span id="l68.6"> /*</span>
<a href="#l68.7"></a><span id="l68.7">  * Test that cycling through the focus of the 3pane's panes works correctly.</span>
<a href="#l68.8"></a><span id="l68.8">  */</span>
<a href="#l68.9"></a><span id="l68.9"> </span>
<a href="#l68.10"></a><span id="l68.10"> &quot;use strict&quot;;</span>
<a href="#l68.11"></a><span id="l68.11"> </span>
<a href="#l68.12"></a><span id="l68.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l68.13"></a><span id="l68.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l68.14"></a><span id="l68.14" class="difflineminus">-</span>
<a href="#l68.15"></a><span id="l68.15" class="difflineminus">-var MODULE_NAME = &quot;test-focus&quot;;</span>
<a href="#l68.16"></a><span id="l68.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l68.17"></a><span id="l68.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l68.18"></a><span id="l68.18" class="difflineminus">-</span>
<a href="#l68.19"></a><span id="l68.19" class="difflineminus">-function setupModule(module) {</span>
<a href="#l68.20"></a><span id="l68.20" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l68.21"></a><span id="l68.21" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l68.22"></a><span id="l68.22" class="difflineminus">-  }</span>
<a href="#l68.23"></a><span id="l68.23" class="difflineminus">-}</span>
<a href="#l68.24"></a><span id="l68.24" class="difflineplus">+var {</span>
<a href="#l68.25"></a><span id="l68.25" class="difflineplus">+  add_attachments,</span>
<a href="#l68.26"></a><span id="l68.26" class="difflineplus">+  close_compose_window,</span>
<a href="#l68.27"></a><span id="l68.27" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l68.28"></a><span id="l68.28" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l68.29"></a><span id="l68.29" class="difflineplus">+var { assert_equals, mc } = ChromeUtils.import(</span>
<a href="#l68.30"></a><span id="l68.30" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l68.31"></a><span id="l68.31" class="difflineplus">+);</span>
<a href="#l68.32"></a><span id="l68.32"> </span>
<a href="#l68.33"></a><span id="l68.33"> /**</span>
<a href="#l68.34"></a><span id="l68.34">  * Check that it's possible to cycle through the compose window's important</span>
<a href="#l68.35"></a><span id="l68.35">  * elements forward and backward.</span>
<a href="#l68.36"></a><span id="l68.36">  *</span>
<a href="#l68.37"></a><span id="l68.37">  * @param controller the compose window controller</span>
<a href="#l68.38"></a><span id="l68.38">  * @param attachmentsExpanded true if the attachment pane is expanded</span>
<a href="#l68.39"></a><span id="l68.39">  * @param ctrlTab true if we should use Ctrl+Tab to cycle, false if we should</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l69.1"></a><span id="l69.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-forward-headers.js</span>
<a href="#l69.2"></a><span id="l69.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-forward-headers.js</span>
<a href="#l69.3"></a><span id="l69.3" class="difflineat">@@ -4,23 +4,37 @@</span>
<a href="#l69.4"></a><span id="l69.4"> </span>
<a href="#l69.5"></a><span id="l69.5"> /**</span>
<a href="#l69.6"></a><span id="l69.6">  * Tests that headers like References and X-Forwarded-Message-Id are</span>
<a href="#l69.7"></a><span id="l69.7">  * set properly when forwarding messages.</span>
<a href="#l69.8"></a><span id="l69.8">  */</span>
<a href="#l69.9"></a><span id="l69.9"> </span>
<a href="#l69.10"></a><span id="l69.10"> &quot;use strict&quot;;</span>
<a href="#l69.11"></a><span id="l69.11"> </span>
<a href="#l69.12"></a><span id="l69.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l69.13"></a><span id="l69.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l69.14"></a><span id="l69.14" class="difflineminus">-</span>
<a href="#l69.15"></a><span id="l69.15" class="difflineminus">-var MODULE_NAME = &quot;test-forward-headers&quot;;</span>
<a href="#l69.16"></a><span id="l69.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l69.17"></a><span id="l69.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l69.18"></a><span id="l69.18" class="difflineminus">-</span>
<a href="#l69.19"></a><span id="l69.19" class="difflineplus">+var {</span>
<a href="#l69.20"></a><span id="l69.20" class="difflineplus">+  assert_previous_text,</span>
<a href="#l69.21"></a><span id="l69.21" class="difflineplus">+  get_compose_body,</span>
<a href="#l69.22"></a><span id="l69.22" class="difflineplus">+  open_compose_with_forward,</span>
<a href="#l69.23"></a><span id="l69.23" class="difflineplus">+  open_compose_with_forward_as_attachments,</span>
<a href="#l69.24"></a><span id="l69.24" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l69.25"></a><span id="l69.25" class="difflineplus">+var {</span>
<a href="#l69.26"></a><span id="l69.26" class="difflineplus">+  add_sets_to_folders,</span>
<a href="#l69.27"></a><span id="l69.27" class="difflineplus">+  assert_equals,</span>
<a href="#l69.28"></a><span id="l69.28" class="difflineplus">+  assert_true,</span>
<a href="#l69.29"></a><span id="l69.29" class="difflineplus">+  be_in_folder,</span>
<a href="#l69.30"></a><span id="l69.30" class="difflineplus">+  create_folder,</span>
<a href="#l69.31"></a><span id="l69.31" class="difflineplus">+  create_thread,</span>
<a href="#l69.32"></a><span id="l69.32" class="difflineplus">+  get_special_folder,</span>
<a href="#l69.33"></a><span id="l69.33" class="difflineplus">+  mc,</span>
<a href="#l69.34"></a><span id="l69.34" class="difflineplus">+  press_delete,</span>
<a href="#l69.35"></a><span id="l69.35" class="difflineplus">+  select_click_row,</span>
<a href="#l69.36"></a><span id="l69.36" class="difflineplus">+  select_shift_click_row,</span>
<a href="#l69.37"></a><span id="l69.37" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l69.38"></a><span id="l69.38" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l69.39"></a><span id="l69.39" class="difflineplus">+);</span>
<a href="#l69.40"></a><span id="l69.40"> var { to_mime_message } = ChromeUtils.import(</span>
<a href="#l69.41"></a><span id="l69.41">   &quot;resource://testing-common/mozmill/MessageHelpers.jsm&quot;</span>
<a href="#l69.42"></a><span id="l69.42"> );</span>
<a href="#l69.43"></a><span id="l69.43"> var {</span>
<a href="#l69.44"></a><span id="l69.44">   plan_for_modal_dialog,</span>
<a href="#l69.45"></a><span id="l69.45">   plan_for_window_close,</span>
<a href="#l69.46"></a><span id="l69.46">   wait_for_modal_dialog,</span>
<a href="#l69.47"></a><span id="l69.47">   wait_for_window_close,</span>
<a href="#l69.48"></a><span id="l69.48" class="difflineat">@@ -28,21 +42,16 @@ var {</span>
<a href="#l69.49"></a><span id="l69.49"> </span>
<a href="#l69.50"></a><span id="l69.50"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l69.51"></a><span id="l69.51"> </span>
<a href="#l69.52"></a><span id="l69.52"> var cwc = null; // compose window controller</span>
<a href="#l69.53"></a><span id="l69.53"> var folder;</span>
<a href="#l69.54"></a><span id="l69.54"> var gDrafts;</span>
<a href="#l69.55"></a><span id="l69.55"> </span>
<a href="#l69.56"></a><span id="l69.56"> function setupModule(module) {</span>
<a href="#l69.57"></a><span id="l69.57" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l69.58"></a><span id="l69.58" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l69.59"></a><span id="l69.59" class="difflineminus">-  let composeHelper = collector.getModule(&quot;compose-helpers&quot;);</span>
<a href="#l69.60"></a><span id="l69.60" class="difflineminus">-  composeHelper.installInto(module);</span>
<a href="#l69.61"></a><span id="l69.61" class="difflineminus">-</span>
<a href="#l69.62"></a><span id="l69.62">   folder = create_folder(&quot;Test&quot;);</span>
<a href="#l69.63"></a><span id="l69.63">   let thread1 = create_thread(10);</span>
<a href="#l69.64"></a><span id="l69.64">   add_sets_to_folders([folder], [thread1]);</span>
<a href="#l69.65"></a><span id="l69.65"> </span>
<a href="#l69.66"></a><span id="l69.66">   gDrafts = get_special_folder(Ci.nsMsgFolderFlags.Drafts, true);</span>
<a href="#l69.67"></a><span id="l69.67"> </span>
<a href="#l69.68"></a><span id="l69.68">   // Don't create paragraphs in the test.</span>
<a href="#l69.69"></a><span id="l69.69">   // The test checks for the first DOM node and expects a text and not</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l70.1"></a><span id="l70.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-forward-rfc822-attach.js</span>
<a href="#l70.2"></a><span id="l70.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-forward-rfc822-attach.js</span>
<a href="#l70.3"></a><span id="l70.3" class="difflineat">@@ -4,41 +4,46 @@</span>
<a href="#l70.4"></a><span id="l70.4"> </span>
<a href="#l70.5"></a><span id="l70.5"> /**</span>
<a href="#l70.6"></a><span id="l70.6">  * Tests that attached messages (message/rfc822) are correctly sent.</span>
<a href="#l70.7"></a><span id="l70.7">  * It's easiest to test the forward case.</span>
<a href="#l70.8"></a><span id="l70.8">  */</span>
<a href="#l70.9"></a><span id="l70.9"> </span>
<a href="#l70.10"></a><span id="l70.10"> &quot;use strict&quot;;</span>
<a href="#l70.11"></a><span id="l70.11"> </span>
<a href="#l70.12"></a><span id="l70.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l70.13"></a><span id="l70.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l70.14"></a><span id="l70.14" class="difflineminus">-</span>
<a href="#l70.15"></a><span id="l70.15" class="difflineminus">-var MODULE_NAME = &quot;test-forward-rfc822-attach&quot;;</span>
<a href="#l70.16"></a><span id="l70.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l70.17"></a><span id="l70.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l70.18"></a><span id="l70.18" class="difflineminus">-</span>
<a href="#l70.19"></a><span id="l70.19"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l70.20"></a><span id="l70.20"> </span>
<a href="#l70.21"></a><span id="l70.21" class="difflineplus">+var {</span>
<a href="#l70.22"></a><span id="l70.22" class="difflineplus">+  close_compose_window,</span>
<a href="#l70.23"></a><span id="l70.23" class="difflineplus">+  get_msg_source,</span>
<a href="#l70.24"></a><span id="l70.24" class="difflineplus">+  open_compose_with_forward_as_attachments,</span>
<a href="#l70.25"></a><span id="l70.25" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l70.26"></a><span id="l70.26" class="difflineplus">+var {</span>
<a href="#l70.27"></a><span id="l70.27" class="difflineplus">+  assert_true,</span>
<a href="#l70.28"></a><span id="l70.28" class="difflineplus">+  be_in_folder,</span>
<a href="#l70.29"></a><span id="l70.29" class="difflineplus">+  get_special_folder,</span>
<a href="#l70.30"></a><span id="l70.30" class="difflineplus">+  mc,</span>
<a href="#l70.31"></a><span id="l70.31" class="difflineplus">+  open_message_from_file,</span>
<a href="#l70.32"></a><span id="l70.32" class="difflineplus">+  press_delete,</span>
<a href="#l70.33"></a><span id="l70.33" class="difflineplus">+  select_click_row,</span>
<a href="#l70.34"></a><span id="l70.34" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l70.35"></a><span id="l70.35" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l70.36"></a><span id="l70.36" class="difflineplus">+);</span>
<a href="#l70.37"></a><span id="l70.37"> var { close_window } = ChromeUtils.import(</span>
<a href="#l70.38"></a><span id="l70.38">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l70.39"></a><span id="l70.39"> );</span>
<a href="#l70.40"></a><span id="l70.40"> </span>
<a href="#l70.41"></a><span id="l70.41"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l70.42"></a><span id="l70.42"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l70.43"></a><span id="l70.43">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l70.44"></a><span id="l70.44"> );</span>
<a href="#l70.45"></a><span id="l70.45"> </span>
<a href="#l70.46"></a><span id="l70.46"> var gDrafts;</span>
<a href="#l70.47"></a><span id="l70.47"> </span>
<a href="#l70.48"></a><span id="l70.48"> function setupModule(module) {</span>
<a href="#l70.49"></a><span id="l70.49" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l70.50"></a><span id="l70.50" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l70.51"></a><span id="l70.51" class="difflineminus">-  }</span>
<a href="#l70.52"></a><span id="l70.52" class="difflineminus">-</span>
<a href="#l70.53"></a><span id="l70.53">   gDrafts = get_special_folder(Ci.nsMsgFolderFlags.Drafts, true);</span>
<a href="#l70.54"></a><span id="l70.54"> }</span>
<a href="#l70.55"></a><span id="l70.55"> </span>
<a href="#l70.56"></a><span id="l70.56"> function forwardDirect(aFilePath, aExpectedText) {</span>
<a href="#l70.57"></a><span id="l70.57">   let file = os.getFileForPath(</span>
<a href="#l70.58"></a><span id="l70.58">     os.abspath(aFilePath, os.getFileForPath(__file__))</span>
<a href="#l70.59"></a><span id="l70.59">   );</span>
<a href="#l70.60"></a><span id="l70.60">   let msgc = open_message_from_file(file);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l71.1"></a><span id="l71.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-forward-utf8.js</span>
<a href="#l71.2"></a><span id="l71.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-forward-utf8.js</span>
<a href="#l71.3"></a><span id="l71.3" class="difflineat">@@ -3,44 +3,50 @@</span>
<a href="#l71.4"></a><span id="l71.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l71.5"></a><span id="l71.5"> </span>
<a href="#l71.6"></a><span id="l71.6"> /**</span>
<a href="#l71.7"></a><span id="l71.7">  * Tests that UTF-8 messages are correctly forwarded.</span>
<a href="#l71.8"></a><span id="l71.8">  */</span>
<a href="#l71.9"></a><span id="l71.9"> </span>
<a href="#l71.10"></a><span id="l71.10"> &quot;use strict&quot;;</span>
<a href="#l71.11"></a><span id="l71.11"> </span>
<a href="#l71.12"></a><span id="l71.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l71.13"></a><span id="l71.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l71.14"></a><span id="l71.14" class="difflineminus">-</span>
<a href="#l71.15"></a><span id="l71.15" class="difflineminus">-var MODULE_NAME = &quot;test-forward-utf8&quot;;</span>
<a href="#l71.16"></a><span id="l71.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l71.17"></a><span id="l71.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l71.18"></a><span id="l71.18" class="difflineminus">-</span>
<a href="#l71.19"></a><span id="l71.19"> var elib = ChromeUtils.import(</span>
<a href="#l71.20"></a><span id="l71.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l71.21"></a><span id="l71.21"> );</span>
<a href="#l71.22"></a><span id="l71.22"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l71.23"></a><span id="l71.23"> </span>
<a href="#l71.24"></a><span id="l71.24" class="difflineplus">+var {</span>
<a href="#l71.25"></a><span id="l71.25" class="difflineplus">+  close_compose_window,</span>
<a href="#l71.26"></a><span id="l71.26" class="difflineplus">+  get_compose_body,</span>
<a href="#l71.27"></a><span id="l71.27" class="difflineplus">+  open_compose_with_forward,</span>
<a href="#l71.28"></a><span id="l71.28" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l71.29"></a><span id="l71.29" class="difflineplus">+var {</span>
<a href="#l71.30"></a><span id="l71.30" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l71.31"></a><span id="l71.31" class="difflineplus">+  assert_true,</span>
<a href="#l71.32"></a><span id="l71.32" class="difflineplus">+  be_in_folder,</span>
<a href="#l71.33"></a><span id="l71.33" class="difflineplus">+  create_folder,</span>
<a href="#l71.34"></a><span id="l71.34" class="difflineplus">+  mc,</span>
<a href="#l71.35"></a><span id="l71.35" class="difflineplus">+  open_message_from_file,</span>
<a href="#l71.36"></a><span id="l71.36" class="difflineplus">+  press_delete,</span>
<a href="#l71.37"></a><span id="l71.37" class="difflineplus">+  select_click_row,</span>
<a href="#l71.38"></a><span id="l71.38" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l71.39"></a><span id="l71.39" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l71.40"></a><span id="l71.40" class="difflineplus">+);</span>
<a href="#l71.41"></a><span id="l71.41"> var { close_window } = ChromeUtils.import(</span>
<a href="#l71.42"></a><span id="l71.42">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l71.43"></a><span id="l71.43"> );</span>
<a href="#l71.44"></a><span id="l71.44"> </span>
<a href="#l71.45"></a><span id="l71.45"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l71.46"></a><span id="l71.46"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l71.47"></a><span id="l71.47">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l71.48"></a><span id="l71.48"> );</span>
<a href="#l71.49"></a><span id="l71.49"> </span>
<a href="#l71.50"></a><span id="l71.50"> var folderToSendFrom;</span>
<a href="#l71.51"></a><span id="l71.51"> </span>
<a href="#l71.52"></a><span id="l71.52"> function setupModule(module) {</span>
<a href="#l71.53"></a><span id="l71.53" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l71.54"></a><span id="l71.54" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l71.55"></a><span id="l71.55" class="difflineminus">-  }</span>
<a href="#l71.56"></a><span id="l71.56" class="difflineminus">-</span>
<a href="#l71.57"></a><span id="l71.57">   folderToSendFrom = create_folder(&quot;FolderWithUTF8&quot;);</span>
<a href="#l71.58"></a><span id="l71.58"> }</span>
<a href="#l71.59"></a><span id="l71.59"> </span>
<a href="#l71.60"></a><span id="l71.60"> function check_content(window) {</span>
<a href="#l71.61"></a><span id="l71.61">   let mailBody = get_compose_body(window);</span>
<a href="#l71.62"></a><span id="l71.62"> </span>
<a href="#l71.63"></a><span id="l71.63">   let node = mailBody.firstChild;</span>
<a href="#l71.64"></a><span id="l71.64">   while (node) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l72.1"></a><span id="l72.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-forwarded-content.js</span>
<a href="#l72.2"></a><span id="l72.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-forwarded-content.js</span>
<a href="#l72.3"></a><span id="l72.3" class="difflineat">@@ -3,30 +3,34 @@</span>
<a href="#l72.4"></a><span id="l72.4">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l72.5"></a><span id="l72.5"> </span>
<a href="#l72.6"></a><span id="l72.6"> /**</span>
<a href="#l72.7"></a><span id="l72.7">  * Tests that forwarded content is ok.</span>
<a href="#l72.8"></a><span id="l72.8">  */</span>
<a href="#l72.9"></a><span id="l72.9"> </span>
<a href="#l72.10"></a><span id="l72.10"> &quot;use strict&quot;;</span>
<a href="#l72.11"></a><span id="l72.11"> </span>
<a href="#l72.12"></a><span id="l72.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l72.13"></a><span id="l72.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l72.14"></a><span id="l72.14" class="difflineminus">-</span>
<a href="#l72.15"></a><span id="l72.15" class="difflineminus">-var MODULE_NAME = &quot;test-forwarded-content&quot;;</span>
<a href="#l72.16"></a><span id="l72.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l72.17"></a><span id="l72.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l72.18"></a><span id="l72.18" class="difflineplus">+var { close_compose_window, open_compose_with_forward } = ChromeUtils.import(</span>
<a href="#l72.19"></a><span id="l72.19" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l72.20"></a><span id="l72.20" class="difflineplus">+);</span>
<a href="#l72.21"></a><span id="l72.21" class="difflineplus">+var {</span>
<a href="#l72.22"></a><span id="l72.22" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l72.23"></a><span id="l72.23" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l72.24"></a><span id="l72.24" class="difflineplus">+  be_in_folder,</span>
<a href="#l72.25"></a><span id="l72.25" class="difflineplus">+  create_folder,</span>
<a href="#l72.26"></a><span id="l72.26" class="difflineplus">+  create_message,</span>
<a href="#l72.27"></a><span id="l72.27" class="difflineplus">+  mc,</span>
<a href="#l72.28"></a><span id="l72.28" class="difflineplus">+  select_click_row,</span>
<a href="#l72.29"></a><span id="l72.29" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l72.30"></a><span id="l72.30" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l72.31"></a><span id="l72.31" class="difflineplus">+);</span>
<a href="#l72.32"></a><span id="l72.32"> </span>
<a href="#l72.33"></a><span id="l72.33"> var folder = null;</span>
<a href="#l72.34"></a><span id="l72.34"> </span>
<a href="#l72.35"></a><span id="l72.35"> function setupModule(module) {</span>
<a href="#l72.36"></a><span id="l72.36" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l72.37"></a><span id="l72.37" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l72.38"></a><span id="l72.38" class="difflineminus">-  }</span>
<a href="#l72.39"></a><span id="l72.39" class="difflineminus">-</span>
<a href="#l72.40"></a><span id="l72.40">   folder = create_folder(&quot;Forward Content Testing&quot;);</span>
<a href="#l72.41"></a><span id="l72.41">   add_message_to_folder(</span>
<a href="#l72.42"></a><span id="l72.42">     folder,</span>
<a href="#l72.43"></a><span id="l72.43">     create_message({</span>
<a href="#l72.44"></a><span id="l72.44">       subject: &quot;something like &lt;foo@example&gt;&quot;,</span>
<a href="#l72.45"></a><span id="l72.45">       body: { body: &quot;Testing bug 397021!&quot; },</span>
<a href="#l72.46"></a><span id="l72.46">     })</span>
<a href="#l72.47"></a><span id="l72.47">   );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l73.1"></a><span id="l73.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-forwarded-eml-actions.js</span>
<a href="#l73.2"></a><span id="l73.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-forwarded-eml-actions.js</span>
<a href="#l73.3"></a><span id="l73.3" class="difflineat">@@ -4,47 +4,52 @@</span>
<a href="#l73.4"></a><span id="l73.4"> </span>
<a href="#l73.5"></a><span id="l73.5"> /**</span>
<a href="#l73.6"></a><span id="l73.6">  * Tests that actions such as replying and forwarding works correctly from</span>
<a href="#l73.7"></a><span id="l73.7">  * an .eml message that's attached to another mail.</span>
<a href="#l73.8"></a><span id="l73.8">  */</span>
<a href="#l73.9"></a><span id="l73.9"> </span>
<a href="#l73.10"></a><span id="l73.10"> &quot;use strict&quot;;</span>
<a href="#l73.11"></a><span id="l73.11"> </span>
<a href="#l73.12"></a><span id="l73.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l73.13"></a><span id="l73.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l73.14"></a><span id="l73.14" class="difflineminus">-</span>
<a href="#l73.15"></a><span id="l73.15" class="difflineminus">-var MODULE_NAME = &quot;test-forwarded-eml-actions&quot;;</span>
<a href="#l73.16"></a><span id="l73.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l73.17"></a><span id="l73.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l73.18"></a><span id="l73.18" class="difflineminus">-</span>
<a href="#l73.19"></a><span id="l73.19"> var elib = ChromeUtils.import(</span>
<a href="#l73.20"></a><span id="l73.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l73.21"></a><span id="l73.21"> );</span>
<a href="#l73.22"></a><span id="l73.22"> </span>
<a href="#l73.23"></a><span id="l73.23"> var {</span>
<a href="#l73.24"></a><span id="l73.24" class="difflineplus">+  close_compose_window,</span>
<a href="#l73.25"></a><span id="l73.25" class="difflineplus">+  get_compose_body,</span>
<a href="#l73.26"></a><span id="l73.26" class="difflineplus">+  wait_for_compose_window,</span>
<a href="#l73.27"></a><span id="l73.27" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l73.28"></a><span id="l73.28" class="difflineplus">+var {</span>
<a href="#l73.29"></a><span id="l73.29" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l73.30"></a><span id="l73.30" class="difflineplus">+  be_in_folder,</span>
<a href="#l73.31"></a><span id="l73.31" class="difflineplus">+  create_folder,</span>
<a href="#l73.32"></a><span id="l73.32" class="difflineplus">+  mc,</span>
<a href="#l73.33"></a><span id="l73.33" class="difflineplus">+  select_click_row,</span>
<a href="#l73.34"></a><span id="l73.34" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l73.35"></a><span id="l73.35" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l73.36"></a><span id="l73.36" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l73.37"></a><span id="l73.37" class="difflineplus">+);</span>
<a href="#l73.38"></a><span id="l73.38" class="difflineplus">+var {</span>
<a href="#l73.39"></a><span id="l73.39">   close_window,</span>
<a href="#l73.40"></a><span id="l73.40">   plan_for_new_window,</span>
<a href="#l73.41"></a><span id="l73.41">   wait_for_new_window,</span>
<a href="#l73.42"></a><span id="l73.42"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l73.43"></a><span id="l73.43"> </span>
<a href="#l73.44"></a><span id="l73.44"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l73.45"></a><span id="l73.45">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l73.46"></a><span id="l73.46"> );</span>
<a href="#l73.47"></a><span id="l73.47"> </span>
<a href="#l73.48"></a><span id="l73.48"> var folder;</span>
<a href="#l73.49"></a><span id="l73.49"> </span>
<a href="#l73.50"></a><span id="l73.50"> var msgsubject = &quot;mail client suggestions&quot;;</span>
<a href="#l73.51"></a><span id="l73.51"> var msgbodyA = &quot;know of a good email client?&quot;;</span>
<a href="#l73.52"></a><span id="l73.52"> var msgbodyB = &quot;hi, i think you may know of an email client to recommend?&quot;;</span>
<a href="#l73.53"></a><span id="l73.53"> </span>
<a href="#l73.54"></a><span id="l73.54"> var setupModule = function(module) {</span>
<a href="#l73.55"></a><span id="l73.55" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l73.56"></a><span id="l73.56" class="difflineminus">-  collector.getModule(&quot;compose-helpers&quot;).installInto(module);</span>
<a href="#l73.57"></a><span id="l73.57" class="difflineminus">-</span>
<a href="#l73.58"></a><span id="l73.58">   folder = create_folder(&quot;FwdedEmlTest&quot;);</span>
<a href="#l73.59"></a><span id="l73.59"> </span>
<a href="#l73.60"></a><span id="l73.60">   let source =</span>
<a href="#l73.61"></a><span id="l73.61">     &quot;From - Mon Apr  16 22:55:33 2012\n&quot; +</span>
<a href="#l73.62"></a><span id="l73.62">     &quot;Date: Mon, 16 Apr 2012 22:55:33 +0300\n&quot; +</span>
<a href="#l73.63"></a><span id="l73.63">     &quot;From: Mr Example &lt;example@invalid&gt;\n&quot; +</span>
<a href="#l73.64"></a><span id="l73.64">     &quot;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:14.0) Gecko/20120331 Thunderbird/14.0a1\n&quot; +</span>
<a href="#l73.65"></a><span id="l73.65">     &quot;MIME-Version: 1.0\n&quot; +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l74.1"></a><span id="l74.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-image-display.js</span>
<a href="#l74.2"></a><span id="l74.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-image-display.js</span>
<a href="#l74.3"></a><span id="l74.3" class="difflineat">@@ -3,40 +3,48 @@</span>
<a href="#l74.4"></a><span id="l74.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l74.5"></a><span id="l74.5"> </span>
<a href="#l74.6"></a><span id="l74.6"> /**</span>
<a href="#l74.7"></a><span id="l74.7">  * Tests that we load and display embedded images in messages.</span>
<a href="#l74.8"></a><span id="l74.8">  */</span>
<a href="#l74.9"></a><span id="l74.9"> </span>
<a href="#l74.10"></a><span id="l74.10"> &quot;use strict&quot;;</span>
<a href="#l74.11"></a><span id="l74.11"> </span>
<a href="#l74.12"></a><span id="l74.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l74.13"></a><span id="l74.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l74.14"></a><span id="l74.14" class="difflineminus">-</span>
<a href="#l74.15"></a><span id="l74.15" class="difflineminus">-var MODULE_NAME = &quot;test-image-display&quot;;</span>
<a href="#l74.16"></a><span id="l74.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l74.17"></a><span id="l74.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l74.18"></a><span id="l74.18" class="difflineminus">-</span>
<a href="#l74.19"></a><span id="l74.19"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l74.20"></a><span id="l74.20"> var elib = ChromeUtils.import(</span>
<a href="#l74.21"></a><span id="l74.21">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l74.22"></a><span id="l74.22"> );</span>
<a href="#l74.23"></a><span id="l74.23"> </span>
<a href="#l74.24"></a><span id="l74.24" class="difflineplus">+var {</span>
<a href="#l74.25"></a><span id="l74.25" class="difflineplus">+  close_compose_window,</span>
<a href="#l74.26"></a><span id="l74.26" class="difflineplus">+  open_compose_with_forward,</span>
<a href="#l74.27"></a><span id="l74.27" class="difflineplus">+  open_compose_with_reply,</span>
<a href="#l74.28"></a><span id="l74.28" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l74.29"></a><span id="l74.29" class="difflineplus">+var {</span>
<a href="#l74.30"></a><span id="l74.30" class="difflineplus">+  assert_false,</span>
<a href="#l74.31"></a><span id="l74.31" class="difflineplus">+  assert_not_equals,</span>
<a href="#l74.32"></a><span id="l74.32" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l74.33"></a><span id="l74.33" class="difflineplus">+  assert_true,</span>
<a href="#l74.34"></a><span id="l74.34" class="difflineplus">+  be_in_folder,</span>
<a href="#l74.35"></a><span id="l74.35" class="difflineplus">+  create_folder,</span>
<a href="#l74.36"></a><span id="l74.36" class="difflineplus">+  mc,</span>
<a href="#l74.37"></a><span id="l74.37" class="difflineplus">+  open_message_from_file,</span>
<a href="#l74.38"></a><span id="l74.38" class="difflineplus">+  select_click_row,</span>
<a href="#l74.39"></a><span id="l74.39" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l74.40"></a><span id="l74.40" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l74.41"></a><span id="l74.41" class="difflineplus">+);</span>
<a href="#l74.42"></a><span id="l74.42"> var { close_window } = ChromeUtils.import(</span>
<a href="#l74.43"></a><span id="l74.43">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l74.44"></a><span id="l74.44"> );</span>
<a href="#l74.45"></a><span id="l74.45"> </span>
<a href="#l74.46"></a><span id="l74.46"> var { IOUtils } = ChromeUtils.import(&quot;resource:///modules/IOUtils.js&quot;);</span>
<a href="#l74.47"></a><span id="l74.47"> </span>
<a href="#l74.48"></a><span id="l74.48"> var gImageFolder;</span>
<a href="#l74.49"></a><span id="l74.49"> </span>
<a href="#l74.50"></a><span id="l74.50"> function setupModule(module) {</span>
<a href="#l74.51"></a><span id="l74.51" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l74.52"></a><span id="l74.52" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l74.53"></a><span id="l74.53" class="difflineminus">-  }</span>
<a href="#l74.54"></a><span id="l74.54">   gImageFolder = create_folder(&quot;ImageFolder&quot;);</span>
<a href="#l74.55"></a><span id="l74.55"> }</span>
<a href="#l74.56"></a><span id="l74.56"> </span>
<a href="#l74.57"></a><span id="l74.57"> /**</span>
<a href="#l74.58"></a><span id="l74.58">  * Check dimensions of the embedded image and whether it could be loaded.</span>
<a href="#l74.59"></a><span id="l74.59">  */</span>
<a href="#l74.60"></a><span id="l74.60"> function check_image_size(aController, aImage, aSrcStart) {</span>
<a href="#l74.61"></a><span id="l74.61">   assert_not_equals(null, aImage);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l75.1"></a><span id="l75.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-image-insertion-dialog.js</span>
<a href="#l75.2"></a><span id="l75.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-image-insertion-dialog.js</span>
<a href="#l75.3"></a><span id="l75.3" class="difflineat">@@ -3,43 +3,33 @@</span>
<a href="#l75.4"></a><span id="l75.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l75.5"></a><span id="l75.5"> </span>
<a href="#l75.6"></a><span id="l75.6"> /**</span>
<a href="#l75.7"></a><span id="l75.7">  * Tests the image insertion dialog functionality.</span>
<a href="#l75.8"></a><span id="l75.8">  */</span>
<a href="#l75.9"></a><span id="l75.9"> </span>
<a href="#l75.10"></a><span id="l75.10"> &quot;use strict&quot;;</span>
<a href="#l75.11"></a><span id="l75.11"> </span>
<a href="#l75.12"></a><span id="l75.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l75.13"></a><span id="l75.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l75.14"></a><span id="l75.14" class="difflineminus">-</span>
<a href="#l75.15"></a><span id="l75.15" class="difflineminus">-var MODULE_NAME = &quot;test-image-insertion-dialog&quot;;</span>
<a href="#l75.16"></a><span id="l75.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l75.17"></a><span id="l75.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l75.18"></a><span id="l75.18" class="difflineminus">-</span>
<a href="#l75.19"></a><span id="l75.19"> var elib = ChromeUtils.import(</span>
<a href="#l75.20"></a><span id="l75.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l75.21"></a><span id="l75.21"> );</span>
<a href="#l75.22"></a><span id="l75.22"> </span>
<a href="#l75.23"></a><span id="l75.23" class="difflineplus">+var { close_compose_window, open_compose_new_mail } = ChromeUtils.import(</span>
<a href="#l75.24"></a><span id="l75.24" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l75.25"></a><span id="l75.25" class="difflineplus">+);</span>
<a href="#l75.26"></a><span id="l75.26" class="difflineplus">+var { assert_true } = ChromeUtils.import(</span>
<a href="#l75.27"></a><span id="l75.27" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l75.28"></a><span id="l75.28" class="difflineplus">+);</span>
<a href="#l75.29"></a><span id="l75.29"> var { input_value } = ChromeUtils.import(</span>
<a href="#l75.30"></a><span id="l75.30">   &quot;resource://testing-common/mozmill/KeyboardHelpers.jsm&quot;</span>
<a href="#l75.31"></a><span id="l75.31"> );</span>
<a href="#l75.32"></a><span id="l75.32"> var wh = ChromeUtils.import(</span>
<a href="#l75.33"></a><span id="l75.33">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l75.34"></a><span id="l75.34"> );</span>
<a href="#l75.35"></a><span id="l75.35"> </span>
<a href="#l75.36"></a><span id="l75.36" class="difflineminus">-var fdh, ch;</span>
<a href="#l75.37"></a><span id="l75.37" class="difflineminus">-</span>
<a href="#l75.38"></a><span id="l75.38" class="difflineminus">-function setupModule(module) {</span>
<a href="#l75.39"></a><span id="l75.39" class="difflineminus">-  fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l75.40"></a><span id="l75.40" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l75.41"></a><span id="l75.41" class="difflineminus">-  ch = collector.getModule(&quot;compose-helpers&quot;);</span>
<a href="#l75.42"></a><span id="l75.42" class="difflineminus">-  ch.installInto(module);</span>
<a href="#l75.43"></a><span id="l75.43" class="difflineminus">-}</span>
<a href="#l75.44"></a><span id="l75.44" class="difflineminus">-</span>
<a href="#l75.45"></a><span id="l75.45"> function test_image_insertion_dialog_persist() {</span>
<a href="#l75.46"></a><span id="l75.46">   let cwc = open_compose_new_mail();</span>
<a href="#l75.47"></a><span id="l75.47"> </span>
<a href="#l75.48"></a><span id="l75.48">   // First focus on the editor element</span>
<a href="#l75.49"></a><span id="l75.49">   cwc.e(&quot;content-frame&quot;).focus();</span>
<a href="#l75.50"></a><span id="l75.50"> </span>
<a href="#l75.51"></a><span id="l75.51">   // Now open the image window</span>
<a href="#l75.52"></a><span id="l75.52">   wh.plan_for_modal_dialog(&quot;imageDlg&quot;, function insert_image(mwc) {</span>
<a href="#l75.53"></a><span id="l75.53" class="difflineat">@@ -80,16 +70,17 @@ function test_image_insertion_dialog_per</span>
<a href="#l75.54"></a><span id="l75.54">       &quot;We should persist the previously selected value&quot;</span>
<a href="#l75.55"></a><span id="l75.55">     );</span>
<a href="#l75.56"></a><span id="l75.56">     // Accept the dialog</span>
<a href="#l75.57"></a><span id="l75.57">     mwc.window.document.documentElement.cancelDialog();</span>
<a href="#l75.58"></a><span id="l75.58">   });</span>
<a href="#l75.59"></a><span id="l75.59">   cwc.click(cwc.eid(&quot;insertImage&quot;));</span>
<a href="#l75.60"></a><span id="l75.60">   wh.wait_for_modal_dialog();</span>
<a href="#l75.61"></a><span id="l75.61">   wh.wait_for_window_close();</span>
<a href="#l75.62"></a><span id="l75.62" class="difflineplus">+  cwc.sleep(500);</span>
<a href="#l75.63"></a><span id="l75.63"> </span>
<a href="#l75.64"></a><span id="l75.64">   // Get the inserted image, double-click it, make sure we switch to &quot;no alt</span>
<a href="#l75.65"></a><span id="l75.65">   // text&quot;, despite the persisted value being &quot;use alt text&quot;</span>
<a href="#l75.66"></a><span id="l75.66">   let img = cwc.e(&quot;content-frame&quot;).contentDocument.querySelector(&quot;img&quot;);</span>
<a href="#l75.67"></a><span id="l75.67">   wh.plan_for_modal_dialog(&quot;imageDlg&quot;, function insert_image(mwc) {</span>
<a href="#l75.68"></a><span id="l75.68">     assert_true(</span>
<a href="#l75.69"></a><span id="l75.69">       mwc.window.document.getElementById(&quot;noAltTextRadio&quot;).selected,</span>
<a href="#l75.70"></a><span id="l75.70">       &quot;We shouldn't use the persisted value because the insert image has no alt text&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l76.1"></a><span id="l76.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-multipart-related.js</span>
<a href="#l76.2"></a><span id="l76.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-multipart-related.js</span>
<a href="#l76.3"></a><span id="l76.3" class="difflineat">@@ -3,47 +3,50 @@</span>
<a href="#l76.4"></a><span id="l76.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l76.5"></a><span id="l76.5"> </span>
<a href="#l76.6"></a><span id="l76.6"> /**</span>
<a href="#l76.7"></a><span id="l76.7">  * Tests that multipart/related messages are handled properly.</span>
<a href="#l76.8"></a><span id="l76.8">  */</span>
<a href="#l76.9"></a><span id="l76.9"> </span>
<a href="#l76.10"></a><span id="l76.10"> &quot;use strict&quot;;</span>
<a href="#l76.11"></a><span id="l76.11"> </span>
<a href="#l76.12"></a><span id="l76.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l76.13"></a><span id="l76.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l76.14"></a><span id="l76.14" class="difflineminus">-</span>
<a href="#l76.15"></a><span id="l76.15" class="difflineminus">-var MODULE_NAME = &quot;test-multipart-related&quot;;</span>
<a href="#l76.16"></a><span id="l76.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l76.17"></a><span id="l76.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l76.18"></a><span id="l76.18" class="difflineminus">-</span>
<a href="#l76.19"></a><span id="l76.19"> var elib = ChromeUtils.import(</span>
<a href="#l76.20"></a><span id="l76.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l76.21"></a><span id="l76.21"> );</span>
<a href="#l76.22"></a><span id="l76.22"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l76.23"></a><span id="l76.23"> var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l76.24"></a><span id="l76.24"> </span>
<a href="#l76.25"></a><span id="l76.25" class="difflineplus">+var { close_compose_window, open_compose_new_mail } = ChromeUtils.import(</span>
<a href="#l76.26"></a><span id="l76.26" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l76.27"></a><span id="l76.27" class="difflineplus">+);</span>
<a href="#l76.28"></a><span id="l76.28" class="difflineplus">+var {</span>
<a href="#l76.29"></a><span id="l76.29" class="difflineplus">+  assert_equals,</span>
<a href="#l76.30"></a><span id="l76.30" class="difflineplus">+  be_in_folder,</span>
<a href="#l76.31"></a><span id="l76.31" class="difflineplus">+  get_special_folder,</span>
<a href="#l76.32"></a><span id="l76.32" class="difflineplus">+  mc,</span>
<a href="#l76.33"></a><span id="l76.33" class="difflineplus">+  press_delete,</span>
<a href="#l76.34"></a><span id="l76.34" class="difflineplus">+  select_click_row,</span>
<a href="#l76.35"></a><span id="l76.35" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l76.36"></a><span id="l76.36" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l76.37"></a><span id="l76.37" class="difflineplus">+);</span>
<a href="#l76.38"></a><span id="l76.38"> var {</span>
<a href="#l76.39"></a><span id="l76.39">   plan_for_modal_dialog,</span>
<a href="#l76.40"></a><span id="l76.40">   wait_for_modal_dialog,</span>
<a href="#l76.41"></a><span id="l76.41">   wait_for_window_close,</span>
<a href="#l76.42"></a><span id="l76.42"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l76.43"></a><span id="l76.43"> </span>
<a href="#l76.44"></a><span id="l76.44"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l76.45"></a><span id="l76.45"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l76.46"></a><span id="l76.46">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l76.47"></a><span id="l76.47"> );</span>
<a href="#l76.48"></a><span id="l76.48"> var { MimeParser } = ChromeUtils.import(&quot;resource:///modules/mimeParser.jsm&quot;);</span>
<a href="#l76.49"></a><span id="l76.49"> </span>
<a href="#l76.50"></a><span id="l76.50"> var gDrafts;</span>
<a href="#l76.51"></a><span id="l76.51"> </span>
<a href="#l76.52"></a><span id="l76.52"> function setupModule(module) {</span>
<a href="#l76.53"></a><span id="l76.53" class="difflineminus">-  for (let req of MODULE_REQUIRES) {</span>
<a href="#l76.54"></a><span id="l76.54" class="difflineminus">-    collector.getModule(req).installInto(module);</span>
<a href="#l76.55"></a><span id="l76.55" class="difflineminus">-  }</span>
<a href="#l76.56"></a><span id="l76.56">   gDrafts = get_special_folder(Ci.nsMsgFolderFlags.Drafts, true);</span>
<a href="#l76.57"></a><span id="l76.57"> }</span>
<a href="#l76.58"></a><span id="l76.58"> </span>
<a href="#l76.59"></a><span id="l76.59"> /**</span>
<a href="#l76.60"></a><span id="l76.60">  * Helper to get the full message content.</span>
<a href="#l76.61"></a><span id="l76.61">  *</span>
<a href="#l76.62"></a><span id="l76.62">  * @param aMsgHdr: nsIMsgDBHdr object whose text body will be read</span>
<a href="#l76.63"></a><span id="l76.63">  * @return {Map(partnum -&gt; message headers), Map(partnum -&gt; message text)}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l77.1"></a><span id="l77.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-newmsg-compose-identity.js</span>
<a href="#l77.2"></a><span id="l77.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-newmsg-compose-identity.js</span>
<a href="#l77.3"></a><span id="l77.3" class="difflineat">@@ -4,30 +4,39 @@</span>
<a href="#l77.4"></a><span id="l77.4"> </span>
<a href="#l77.5"></a><span id="l77.5"> /**</span>
<a href="#l77.6"></a><span id="l77.6">  * Tests that compose new message chooses the correct initial identity when</span>
<a href="#l77.7"></a><span id="l77.7">  * called from the context of an open composer.</span>
<a href="#l77.8"></a><span id="l77.8">  */</span>
<a href="#l77.9"></a><span id="l77.9"> </span>
<a href="#l77.10"></a><span id="l77.10"> &quot;use strict&quot;;</span>
<a href="#l77.11"></a><span id="l77.11"> </span>
<a href="#l77.12"></a><span id="l77.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l77.13"></a><span id="l77.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l77.14"></a><span id="l77.14" class="difflineminus">-</span>
<a href="#l77.15"></a><span id="l77.15" class="difflineminus">-var MODULE_NAME = &quot;test-newmsg-compose-identity&quot;;</span>
<a href="#l77.16"></a><span id="l77.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l77.17"></a><span id="l77.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l77.18"></a><span id="l77.18" class="difflineminus">-</span>
<a href="#l77.19"></a><span id="l77.19" class="difflineplus">+var {</span>
<a href="#l77.20"></a><span id="l77.20" class="difflineplus">+  close_compose_window,</span>
<a href="#l77.21"></a><span id="l77.21" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l77.22"></a><span id="l77.22" class="difflineplus">+  wait_for_compose_window,</span>
<a href="#l77.23"></a><span id="l77.23" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l77.24"></a><span id="l77.24" class="difflineplus">+var {</span>
<a href="#l77.25"></a><span id="l77.25" class="difflineplus">+  assert_equals,</span>
<a href="#l77.26"></a><span id="l77.26" class="difflineplus">+  be_in_folder,</span>
<a href="#l77.27"></a><span id="l77.27" class="difflineplus">+  get_special_folder,</span>
<a href="#l77.28"></a><span id="l77.28" class="difflineplus">+  mc,</span>
<a href="#l77.29"></a><span id="l77.29" class="difflineplus">+  press_delete,</span>
<a href="#l77.30"></a><span id="l77.30" class="difflineplus">+  select_click_row,</span>
<a href="#l77.31"></a><span id="l77.31" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l77.32"></a><span id="l77.32" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l77.33"></a><span id="l77.33" class="difflineplus">+);</span>
<a href="#l77.34"></a><span id="l77.34"> var { plan_for_new_window } = ChromeUtils.import(</span>
<a href="#l77.35"></a><span id="l77.35">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l77.36"></a><span id="l77.36"> );</span>
<a href="#l77.37"></a><span id="l77.37"> </span>
<a href="#l77.38"></a><span id="l77.38"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l77.39"></a><span id="l77.39">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l77.40"></a><span id="l77.40"> );</span>
<a href="#l77.41"></a><span id="l77.41" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l77.42"></a><span id="l77.42"> </span>
<a href="#l77.43"></a><span id="l77.43"> var gInbox;</span>
<a href="#l77.44"></a><span id="l77.44"> var gDrafts;</span>
<a href="#l77.45"></a><span id="l77.45"> var account;</span>
<a href="#l77.46"></a><span id="l77.46"> </span>
<a href="#l77.47"></a><span id="l77.47"> var identityKey1;</span>
<a href="#l77.48"></a><span id="l77.48"> var identity1Email = &quot;x@example.invalid&quot;;</span>
<a href="#l77.49"></a><span id="l77.49"> var identityKey2;</span>
<a href="#l77.50"></a><span id="l77.50" class="difflineat">@@ -36,20 +45,16 @@ var identity2Name = &quot;User Y&quot;;</span>
<a href="#l77.51"></a><span id="l77.51"> var identity2From = identity2Name + &quot; &lt;&quot; + identity2Email + &quot;&gt;&quot;;</span>
<a href="#l77.52"></a><span id="l77.52"> var identityKey3;</span>
<a href="#l77.53"></a><span id="l77.53"> var identity3Email = &quot;z@example.invalid&quot;;</span>
<a href="#l77.54"></a><span id="l77.54"> var identity3Name = &quot;User Z&quot;;</span>
<a href="#l77.55"></a><span id="l77.55"> var identity3Label = &quot;Label Z&quot;;</span>
<a href="#l77.56"></a><span id="l77.56"> var identityKey4;</span>
<a href="#l77.57"></a><span id="l77.57"> </span>
<a href="#l77.58"></a><span id="l77.58"> function setupModule(module) {</span>
<a href="#l77.59"></a><span id="l77.59" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l77.60"></a><span id="l77.60" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l77.61"></a><span id="l77.61" class="difflineminus">-  }</span>
<a href="#l77.62"></a><span id="l77.62" class="difflineminus">-</span>
<a href="#l77.63"></a><span id="l77.63">   // Now set up an account with some identities.</span>
<a href="#l77.64"></a><span id="l77.64">   let acctMgr = MailServices.accounts;</span>
<a href="#l77.65"></a><span id="l77.65">   account = acctMgr.createAccount();</span>
<a href="#l77.66"></a><span id="l77.66">   account.incomingServer = acctMgr.createIncomingServer(</span>
<a href="#l77.67"></a><span id="l77.67">     &quot;nobody&quot;,</span>
<a href="#l77.68"></a><span id="l77.68">     &quot;New Msg Compose Identity Testing&quot;,</span>
<a href="#l77.69"></a><span id="l77.69">     &quot;pop3&quot;</span>
<a href="#l77.70"></a><span id="l77.70">   );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l78.1"></a><span id="l78.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-reply-addresses.js</span>
<a href="#l78.2"></a><span id="l78.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-reply-addresses.js</span>
<a href="#l78.3"></a><span id="l78.3" class="difflineat">@@ -5,40 +5,48 @@</span>
<a href="#l78.4"></a><span id="l78.4"> /**</span>
<a href="#l78.5"></a><span id="l78.5">  * Tests that we get correct adressees for different type of replies:</span>
<a href="#l78.6"></a><span id="l78.6">  * reply to sender, reply to all, reply to list, mail-followup-tp,</span>
<a href="#l78.7"></a><span id="l78.7">  * mail-reply-to, and reply to self.</span>
<a href="#l78.8"></a><span id="l78.8">  */</span>
<a href="#l78.9"></a><span id="l78.9"> </span>
<a href="#l78.10"></a><span id="l78.10"> &quot;use strict&quot;;</span>
<a href="#l78.11"></a><span id="l78.11"> </span>
<a href="#l78.12"></a><span id="l78.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l78.13"></a><span id="l78.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l78.14"></a><span id="l78.14" class="difflineminus">-</span>
<a href="#l78.15"></a><span id="l78.15" class="difflineminus">-var MODULE_NAME = &quot;test-reply-addresses&quot;;</span>
<a href="#l78.16"></a><span id="l78.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l78.17"></a><span id="l78.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l78.18"></a><span id="l78.18" class="difflineplus">+var {</span>
<a href="#l78.19"></a><span id="l78.19" class="difflineplus">+  close_compose_window,</span>
<a href="#l78.20"></a><span id="l78.20" class="difflineplus">+  open_compose_with_reply,</span>
<a href="#l78.21"></a><span id="l78.21" class="difflineplus">+  open_compose_with_reply_to_all,</span>
<a href="#l78.22"></a><span id="l78.22" class="difflineplus">+  open_compose_with_reply_to_list,</span>
<a href="#l78.23"></a><span id="l78.23" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l78.24"></a><span id="l78.24" class="difflineplus">+var {</span>
<a href="#l78.25"></a><span id="l78.25" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l78.26"></a><span id="l78.26" class="difflineplus">+  assert_equals,</span>
<a href="#l78.27"></a><span id="l78.27" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l78.28"></a><span id="l78.28" class="difflineplus">+  be_in_folder,</span>
<a href="#l78.29"></a><span id="l78.29" class="difflineplus">+  create_message,</span>
<a href="#l78.30"></a><span id="l78.30" class="difflineplus">+  mc,</span>
<a href="#l78.31"></a><span id="l78.31" class="difflineplus">+  select_click_row,</span>
<a href="#l78.32"></a><span id="l78.32" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l78.33"></a><span id="l78.33" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l78.34"></a><span id="l78.34" class="difflineplus">+);</span>
<a href="#l78.35"></a><span id="l78.35"> </span>
<a href="#l78.36"></a><span id="l78.36"> var folder;</span>
<a href="#l78.37"></a><span id="l78.37"> var i = 0;</span>
<a href="#l78.38"></a><span id="l78.38"> </span>
<a href="#l78.39"></a><span id="l78.39"> var myEmail = &quot;me@example.com&quot;;</span>
<a href="#l78.40"></a><span id="l78.40"> var myEmail2 = &quot;otherme@example.com&quot;;</span>
<a href="#l78.41"></a><span id="l78.41"> </span>
<a href="#l78.42"></a><span id="l78.42"> var identity;</span>
<a href="#l78.43"></a><span id="l78.43"> var identity2;</span>
<a href="#l78.44"></a><span id="l78.44"> </span>
<a href="#l78.45"></a><span id="l78.45"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l78.46"></a><span id="l78.46">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l78.47"></a><span id="l78.47"> );</span>
<a href="#l78.48"></a><span id="l78.48"> </span>
<a href="#l78.49"></a><span id="l78.49"> function setupModule(module) {</span>
<a href="#l78.50"></a><span id="l78.50" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l78.51"></a><span id="l78.51" class="difflineminus">-  collector.getModule(&quot;compose-helpers&quot;).installInto(module);</span>
<a href="#l78.52"></a><span id="l78.52" class="difflineminus">-</span>
<a href="#l78.53"></a><span id="l78.53">   // Now set up an account with some identities.</span>
<a href="#l78.54"></a><span id="l78.54">   let acctMgr = MailServices.accounts;</span>
<a href="#l78.55"></a><span id="l78.55">   let account = acctMgr.createAccount();</span>
<a href="#l78.56"></a><span id="l78.56">   account.incomingServer = acctMgr.createIncomingServer(</span>
<a href="#l78.57"></a><span id="l78.57">     &quot;nobody&quot;,</span>
<a href="#l78.58"></a><span id="l78.58">     &quot;Reply Addresses Testing&quot;,</span>
<a href="#l78.59"></a><span id="l78.59">     &quot;pop3&quot;</span>
<a href="#l78.60"></a><span id="l78.60">   );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l79.1"></a><span id="l79.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-reply-format-flowed.js</span>
<a href="#l79.2"></a><span id="l79.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-reply-format-flowed.js</span>
<a href="#l79.3"></a><span id="l79.3" class="difflineat">@@ -3,41 +3,45 @@</span>
<a href="#l79.4"></a><span id="l79.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l79.5"></a><span id="l79.5"> </span>
<a href="#l79.6"></a><span id="l79.6"> /**</span>
<a href="#l79.7"></a><span id="l79.7">  * Tests that the reply to a format=flowed message is also flowed.</span>
<a href="#l79.8"></a><span id="l79.8">  */</span>
<a href="#l79.9"></a><span id="l79.9"> </span>
<a href="#l79.10"></a><span id="l79.10"> &quot;use strict&quot;;</span>
<a href="#l79.11"></a><span id="l79.11"> </span>
<a href="#l79.12"></a><span id="l79.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l79.13"></a><span id="l79.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l79.14"></a><span id="l79.14" class="difflineminus">-</span>
<a href="#l79.15"></a><span id="l79.15" class="difflineminus">-var MODULE_NAME = &quot;test-reply-format-flowed&quot;;</span>
<a href="#l79.16"></a><span id="l79.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l79.17"></a><span id="l79.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l79.18"></a><span id="l79.18" class="difflineminus">-</span>
<a href="#l79.19"></a><span id="l79.19"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l79.20"></a><span id="l79.20"> </span>
<a href="#l79.21"></a><span id="l79.21" class="difflineplus">+var {</span>
<a href="#l79.22"></a><span id="l79.22" class="difflineplus">+  close_compose_window,</span>
<a href="#l79.23"></a><span id="l79.23" class="difflineplus">+  get_msg_source,</span>
<a href="#l79.24"></a><span id="l79.24" class="difflineplus">+  open_compose_with_reply,</span>
<a href="#l79.25"></a><span id="l79.25" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l79.26"></a><span id="l79.26" class="difflineplus">+var {</span>
<a href="#l79.27"></a><span id="l79.27" class="difflineplus">+  assert_true,</span>
<a href="#l79.28"></a><span id="l79.28" class="difflineplus">+  be_in_folder,</span>
<a href="#l79.29"></a><span id="l79.29" class="difflineplus">+  get_special_folder,</span>
<a href="#l79.30"></a><span id="l79.30" class="difflineplus">+  open_message_from_file,</span>
<a href="#l79.31"></a><span id="l79.31" class="difflineplus">+  press_delete,</span>
<a href="#l79.32"></a><span id="l79.32" class="difflineplus">+  select_click_row,</span>
<a href="#l79.33"></a><span id="l79.33" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l79.34"></a><span id="l79.34" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l79.35"></a><span id="l79.35" class="difflineplus">+);</span>
<a href="#l79.36"></a><span id="l79.36"> var { close_window } = ChromeUtils.import(</span>
<a href="#l79.37"></a><span id="l79.37">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l79.38"></a><span id="l79.38"> );</span>
<a href="#l79.39"></a><span id="l79.39"> </span>
<a href="#l79.40"></a><span id="l79.40"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l79.41"></a><span id="l79.41"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l79.42"></a><span id="l79.42">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l79.43"></a><span id="l79.43"> );</span>
<a href="#l79.44"></a><span id="l79.44"> </span>
<a href="#l79.45"></a><span id="l79.45"> var gDrafts;</span>
<a href="#l79.46"></a><span id="l79.46"> </span>
<a href="#l79.47"></a><span id="l79.47"> function setupModule(module) {</span>
<a href="#l79.48"></a><span id="l79.48" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l79.49"></a><span id="l79.49" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l79.50"></a><span id="l79.50" class="difflineminus">-  }</span>
<a href="#l79.51"></a><span id="l79.51" class="difflineminus">-</span>
<a href="#l79.52"></a><span id="l79.52">   gDrafts = get_special_folder(Ci.nsMsgFolderFlags.Drafts, true);</span>
<a href="#l79.53"></a><span id="l79.53"> </span>
<a href="#l79.54"></a><span id="l79.54">   Services.prefs.setBoolPref(&quot;mail.identity.id1.compose_html&quot;, false);</span>
<a href="#l79.55"></a><span id="l79.55"> }</span>
<a href="#l79.56"></a><span id="l79.56"> </span>
<a href="#l79.57"></a><span id="l79.57"> function subtest_reply_format_flowed(aFlowed) {</span>
<a href="#l79.58"></a><span id="l79.58">   let file = os.getFileForPath(</span>
<a href="#l79.59"></a><span id="l79.59">     os.abspath(&quot;./format-flowed.eml&quot;, os.getFileForPath(__file__))</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l80.1"></a><span id="l80.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-reply-multipart-charset.js</span>
<a href="#l80.2"></a><span id="l80.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-reply-multipart-charset.js</span>
<a href="#l80.3"></a><span id="l80.3" class="difflineat">@@ -17,39 +17,49 @@</span>
<a href="#l80.4"></a><span id="l80.4">  * Tests that the correct charset is used, even if the message</span>
<a href="#l80.5"></a><span id="l80.5">  * wasn't viewed before answering/forwarding.</span>
<a href="#l80.6"></a><span id="l80.6">  * For good measure some tests are included for charset overriding</span>
<a href="#l80.7"></a><span id="l80.7">  * and enforcing the charset default.</span>
<a href="#l80.8"></a><span id="l80.8">  */</span>
<a href="#l80.9"></a><span id="l80.9"> </span>
<a href="#l80.10"></a><span id="l80.10"> &quot;use strict&quot;;</span>
<a href="#l80.11"></a><span id="l80.11"> </span>
<a href="#l80.12"></a><span id="l80.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l80.13"></a><span id="l80.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l80.14"></a><span id="l80.14" class="difflineminus">-</span>
<a href="#l80.15"></a><span id="l80.15" class="difflineminus">-var MODULE_NAME = &quot;test-reply-multipart-charset&quot;;</span>
<a href="#l80.16"></a><span id="l80.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l80.17"></a><span id="l80.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l80.18"></a><span id="l80.18" class="difflineminus">-</span>
<a href="#l80.19"></a><span id="l80.19"> var elib = ChromeUtils.import(</span>
<a href="#l80.20"></a><span id="l80.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l80.21"></a><span id="l80.21"> );</span>
<a href="#l80.22"></a><span id="l80.22"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l80.23"></a><span id="l80.23"> </span>
<a href="#l80.24"></a><span id="l80.24" class="difflineplus">+var {</span>
<a href="#l80.25"></a><span id="l80.25" class="difflineplus">+  close_compose_window,</span>
<a href="#l80.26"></a><span id="l80.26" class="difflineplus">+  open_compose_with_edit_as_new,</span>
<a href="#l80.27"></a><span id="l80.27" class="difflineplus">+  open_compose_with_forward,</span>
<a href="#l80.28"></a><span id="l80.28" class="difflineplus">+  open_compose_with_forward_as_attachments,</span>
<a href="#l80.29"></a><span id="l80.29" class="difflineplus">+  open_compose_with_reply,</span>
<a href="#l80.30"></a><span id="l80.30" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l80.31"></a><span id="l80.31" class="difflineplus">+var {</span>
<a href="#l80.32"></a><span id="l80.32" class="difflineplus">+  assert_equals,</span>
<a href="#l80.33"></a><span id="l80.33" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l80.34"></a><span id="l80.34" class="difflineplus">+  be_in_folder,</span>
<a href="#l80.35"></a><span id="l80.35" class="difflineplus">+  create_folder,</span>
<a href="#l80.36"></a><span id="l80.36" class="difflineplus">+  mc,</span>
<a href="#l80.37"></a><span id="l80.37" class="difflineplus">+  open_message_from_file,</span>
<a href="#l80.38"></a><span id="l80.38" class="difflineplus">+  press_delete,</span>
<a href="#l80.39"></a><span id="l80.39" class="difflineplus">+  select_click_row,</span>
<a href="#l80.40"></a><span id="l80.40" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l80.41"></a><span id="l80.41" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l80.42"></a><span id="l80.42" class="difflineplus">+);</span>
<a href="#l80.43"></a><span id="l80.43"> var { close_window } = ChromeUtils.import(</span>
<a href="#l80.44"></a><span id="l80.44">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l80.45"></a><span id="l80.45"> );</span>
<a href="#l80.46"></a><span id="l80.46"> </span>
<a href="#l80.47"></a><span id="l80.47" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l80.48"></a><span id="l80.48" class="difflineplus">+</span>
<a href="#l80.49"></a><span id="l80.49"> var folderToStoreMessages;</span>
<a href="#l80.50"></a><span id="l80.50"> </span>
<a href="#l80.51"></a><span id="l80.51"> function setupModule(module) {</span>
<a href="#l80.52"></a><span id="l80.52" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l80.53"></a><span id="l80.53" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l80.54"></a><span id="l80.54" class="difflineminus">-  }</span>
<a href="#l80.55"></a><span id="l80.55" class="difflineminus">-</span>
<a href="#l80.56"></a><span id="l80.56">   folderToStoreMessages = create_folder(&quot;FolderWithMessages&quot;);</span>
<a href="#l80.57"></a><span id="l80.57"> }</span>
<a href="#l80.58"></a><span id="l80.58"> </span>
<a href="#l80.59"></a><span id="l80.59"> function subtest_replyEditAsNewForward_charset(</span>
<a href="#l80.60"></a><span id="l80.60">   aAction,</span>
<a href="#l80.61"></a><span id="l80.61">   aFile,</span>
<a href="#l80.62"></a><span id="l80.62">   aCharset,</span>
<a href="#l80.63"></a><span id="l80.63">   aOverride = null,</span>
<a href="#l80.64"></a><span id="l80.64" class="difflineat">@@ -192,9 +202,11 @@ function test_replyEditAsNewForward_noPr</span>
<a href="#l80.65"></a><span id="l80.65">   );</span>
<a href="#l80.66"></a><span id="l80.66">   subtest_replyEditAsNewForward_charset(</span>
<a href="#l80.67"></a><span id="l80.67">     3,</span>
<a href="#l80.68"></a><span id="l80.68">     &quot;./multipart-charset.eml&quot;,</span>
<a href="#l80.69"></a><span id="l80.69">     &quot;EUC-KR&quot;,</span>
<a href="#l80.70"></a><span id="l80.70">     null,</span>
<a href="#l80.71"></a><span id="l80.71">     false</span>
<a href="#l80.72"></a><span id="l80.72">   );</span>
<a href="#l80.73"></a><span id="l80.73" class="difflineplus">+</span>
<a href="#l80.74"></a><span id="l80.74" class="difflineplus">+  mc.window.goDoCommand(&quot;cmd_toggleMessagePane&quot;);</span>
<a href="#l80.75"></a><span id="l80.75"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l81.1"></a><span id="l81.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-reply-signature.js</span>
<a href="#l81.2"></a><span id="l81.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-reply-signature.js</span>
<a href="#l81.3"></a><span id="l81.3" class="difflineat">@@ -3,33 +3,39 @@</span>
<a href="#l81.4"></a><span id="l81.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l81.5"></a><span id="l81.5"> </span>
<a href="#l81.6"></a><span id="l81.6"> /**</span>
<a href="#l81.7"></a><span id="l81.7">  * Tests the mail.strip_sig_on_reply pref.</span>
<a href="#l81.8"></a><span id="l81.8">  */</span>
<a href="#l81.9"></a><span id="l81.9"> </span>
<a href="#l81.10"></a><span id="l81.10"> &quot;use strict&quot;;</span>
<a href="#l81.11"></a><span id="l81.11"> </span>
<a href="#l81.12"></a><span id="l81.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l81.13"></a><span id="l81.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l81.14"></a><span id="l81.14" class="difflineminus">-</span>
<a href="#l81.15"></a><span id="l81.15" class="difflineminus">-var MODULE_NAME = &quot;test-reply-signature&quot;;</span>
<a href="#l81.16"></a><span id="l81.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l81.17"></a><span id="l81.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l81.18"></a><span id="l81.18" class="difflineplus">+var {</span>
<a href="#l81.19"></a><span id="l81.19" class="difflineplus">+  close_compose_window,</span>
<a href="#l81.20"></a><span id="l81.20" class="difflineplus">+  get_compose_body,</span>
<a href="#l81.21"></a><span id="l81.21" class="difflineplus">+  open_compose_with_reply,</span>
<a href="#l81.22"></a><span id="l81.22" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l81.23"></a><span id="l81.23" class="difflineplus">+var {</span>
<a href="#l81.24"></a><span id="l81.24" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l81.25"></a><span id="l81.25" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l81.26"></a><span id="l81.26" class="difflineplus">+  be_in_folder,</span>
<a href="#l81.27"></a><span id="l81.27" class="difflineplus">+  create_folder,</span>
<a href="#l81.28"></a><span id="l81.28" class="difflineplus">+  create_message,</span>
<a href="#l81.29"></a><span id="l81.29" class="difflineplus">+  mc,</span>
<a href="#l81.30"></a><span id="l81.30" class="difflineplus">+  select_click_row,</span>
<a href="#l81.31"></a><span id="l81.31" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l81.32"></a><span id="l81.32" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l81.33"></a><span id="l81.33" class="difflineplus">+);</span>
<a href="#l81.34"></a><span id="l81.34"> </span>
<a href="#l81.35"></a><span id="l81.35"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l81.36"></a><span id="l81.36"> </span>
<a href="#l81.37"></a><span id="l81.37"> var sig = &quot;roses are red&quot;;</span>
<a href="#l81.38"></a><span id="l81.38"> var folder;</span>
<a href="#l81.39"></a><span id="l81.39"> </span>
<a href="#l81.40"></a><span id="l81.40"> function setupModule(module) {</span>
<a href="#l81.41"></a><span id="l81.41" class="difflineminus">-  for (let req of MODULE_REQUIRES) {</span>
<a href="#l81.42"></a><span id="l81.42" class="difflineminus">-    collector.getModule(req).installInto(module);</span>
<a href="#l81.43"></a><span id="l81.43" class="difflineminus">-  }</span>
<a href="#l81.44"></a><span id="l81.44" class="difflineminus">-</span>
<a href="#l81.45"></a><span id="l81.45">   folder = create_folder(&quot;SigStripTest&quot;);</span>
<a href="#l81.46"></a><span id="l81.46"> </span>
<a href="#l81.47"></a><span id="l81.47">   let msg = create_message({</span>
<a href="#l81.48"></a><span id="l81.48">     subject: &quot;msg with signature; format=flowed&quot;,</span>
<a href="#l81.49"></a><span id="l81.49">     body: {</span>
<a href="#l81.50"></a><span id="l81.50">       body:</span>
<a href="#l81.51"></a><span id="l81.51">         &quot;get with the flow! get with the flow! get with the flow! &quot; +</span>
<a href="#l81.52"></a><span id="l81.52">         &quot;get with the \n flow! get with the flow!\n-- \n&quot; +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l82.1"></a><span id="l82.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-save-changes-on-quit.js</span>
<a href="#l82.2"></a><span id="l82.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-save-changes-on-quit.js</span>
<a href="#l82.3"></a><span id="l82.3" class="difflineat">@@ -5,41 +5,51 @@</span>
<a href="#l82.4"></a><span id="l82.4"> /**</span>
<a href="#l82.5"></a><span id="l82.5">  * Tests that we prompt the user if they'd like to save their message when they</span>
<a href="#l82.6"></a><span id="l82.6">  * try to quit/close with an open compose window with unsaved changes, and</span>
<a href="#l82.7"></a><span id="l82.7">  * that we don't prompt if there are no changes.</span>
<a href="#l82.8"></a><span id="l82.8">  */</span>
<a href="#l82.9"></a><span id="l82.9"> </span>
<a href="#l82.10"></a><span id="l82.10"> &quot;use strict&quot;;</span>
<a href="#l82.11"></a><span id="l82.11"> </span>
<a href="#l82.12"></a><span id="l82.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l82.13"></a><span id="l82.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l82.14"></a><span id="l82.14" class="difflineminus">-</span>
<a href="#l82.15"></a><span id="l82.15" class="difflineminus">-var MODULE_NAME = &quot;test-save-changes-on-quit&quot;;</span>
<a href="#l82.16"></a><span id="l82.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l82.17"></a><span id="l82.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l82.18"></a><span id="l82.18" class="difflineminus">-</span>
<a href="#l82.19"></a><span id="l82.19" class="difflineminus">-var SAVE = 0;</span>
<a href="#l82.20"></a><span id="l82.20" class="difflineminus">-var CANCEL = 1;</span>
<a href="#l82.21"></a><span id="l82.21" class="difflineminus">-var DONT_SAVE = 2;</span>
<a href="#l82.22"></a><span id="l82.22" class="difflineminus">-</span>
<a href="#l82.23"></a><span id="l82.23" class="difflineplus">+var {</span>
<a href="#l82.24"></a><span id="l82.24" class="difflineplus">+  close_compose_window,</span>
<a href="#l82.25"></a><span id="l82.25" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l82.26"></a><span id="l82.26" class="difflineplus">+  open_compose_with_forward,</span>
<a href="#l82.27"></a><span id="l82.27" class="difflineplus">+  open_compose_with_reply,</span>
<a href="#l82.28"></a><span id="l82.28" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l82.29"></a><span id="l82.29" class="difflineplus">+var {</span>
<a href="#l82.30"></a><span id="l82.30" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l82.31"></a><span id="l82.31" class="difflineplus">+  assert_equals,</span>
<a href="#l82.32"></a><span id="l82.32" class="difflineplus">+  assert_false,</span>
<a href="#l82.33"></a><span id="l82.33" class="difflineplus">+  assert_not_equals,</span>
<a href="#l82.34"></a><span id="l82.34" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l82.35"></a><span id="l82.35" class="difflineplus">+  assert_true,</span>
<a href="#l82.36"></a><span id="l82.36" class="difflineplus">+  be_in_folder,</span>
<a href="#l82.37"></a><span id="l82.37" class="difflineplus">+  create_folder,</span>
<a href="#l82.38"></a><span id="l82.38" class="difflineplus">+  create_message,</span>
<a href="#l82.39"></a><span id="l82.39" class="difflineplus">+  mc,</span>
<a href="#l82.40"></a><span id="l82.40" class="difflineplus">+  select_click_row,</span>
<a href="#l82.41"></a><span id="l82.41" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l82.42"></a><span id="l82.42" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l82.43"></a><span id="l82.43" class="difflineplus">+);</span>
<a href="#l82.44"></a><span id="l82.44"> var { gMockPromptService } = ChromeUtils.import(</span>
<a href="#l82.45"></a><span id="l82.45">   &quot;resource://testing-common/mozmill/PromptHelpers.jsm&quot;</span>
<a href="#l82.46"></a><span id="l82.46"> );</span>
<a href="#l82.47"></a><span id="l82.47"> </span>
<a href="#l82.48"></a><span id="l82.48"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l82.49"></a><span id="l82.49"> </span>
<a href="#l82.50"></a><span id="l82.50" class="difflineplus">+var SAVE = 0;</span>
<a href="#l82.51"></a><span id="l82.51" class="difflineplus">+var CANCEL = 1;</span>
<a href="#l82.52"></a><span id="l82.52" class="difflineplus">+var DONT_SAVE = 2;</span>
<a href="#l82.53"></a><span id="l82.53" class="difflineplus">+</span>
<a href="#l82.54"></a><span id="l82.54"> var cwc = null; // compose window controller</span>
<a href="#l82.55"></a><span id="l82.55"> var folder = null;</span>
<a href="#l82.56"></a><span id="l82.56"> </span>
<a href="#l82.57"></a><span id="l82.57"> function setupModule(module) {</span>
<a href="#l82.58"></a><span id="l82.58" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l82.59"></a><span id="l82.59" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l82.60"></a><span id="l82.60" class="difflineminus">-  }</span>
<a href="#l82.61"></a><span id="l82.61" class="difflineminus">-</span>
<a href="#l82.62"></a><span id="l82.62">   folder = create_folder(&quot;PromptToSaveTest&quot;);</span>
<a href="#l82.63"></a><span id="l82.63"> </span>
<a href="#l82.64"></a><span id="l82.64">   add_message_to_folder(folder, create_message()); // row 0</span>
<a href="#l82.65"></a><span id="l82.65">   let localFolder = folder.QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l82.66"></a><span id="l82.66">   localFolder.addMessage(msgSource(&quot;content type: text&quot;, &quot;text&quot;)); // row 1</span>
<a href="#l82.67"></a><span id="l82.67">   localFolder.addMessage(msgSource(&quot;content type missing&quot;, null)); // row 2</span>
<a href="#l82.68"></a><span id="l82.68"> }</span>
<a href="#l82.69"></a><span id="l82.69"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l83.1"></a><span id="l83.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-send-button.js</span>
<a href="#l83.2"></a><span id="l83.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-send-button.js</span>
<a href="#l83.3"></a><span id="l83.3" class="difflineat">@@ -3,47 +3,60 @@</span>
<a href="#l83.4"></a><span id="l83.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l83.5"></a><span id="l83.5"> </span>
<a href="#l83.6"></a><span id="l83.6"> /**</span>
<a href="#l83.7"></a><span id="l83.7">  * Tests proper enabling of send buttons depending on addresses input.</span>
<a href="#l83.8"></a><span id="l83.8">  */</span>
<a href="#l83.9"></a><span id="l83.9"> </span>
<a href="#l83.10"></a><span id="l83.10"> &quot;use strict&quot;;</span>
<a href="#l83.11"></a><span id="l83.11"> </span>
<a href="#l83.12"></a><span id="l83.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l83.13"></a><span id="l83.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l83.14"></a><span id="l83.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l83.15"></a><span id="l83.15" class="difflineminus">-</span>
<a href="#l83.16"></a><span id="l83.16" class="difflineminus">-var MODULE_NAME = &quot;test-send-button&quot;;</span>
<a href="#l83.17"></a><span id="l83.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l83.18"></a><span id="l83.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l83.19"></a><span id="l83.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l83.20"></a><span id="l83.20" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l83.21"></a><span id="l83.21" class="difflineminus">-  &quot;address-book-helpers&quot;,</span>
<a href="#l83.22"></a><span id="l83.22" class="difflineminus">-];</span>
<a href="#l83.23"></a><span id="l83.23" class="difflineminus">-</span>
<a href="#l83.24"></a><span id="l83.24"> var elib = ChromeUtils.import(</span>
<a href="#l83.25"></a><span id="l83.25">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l83.26"></a><span id="l83.26"> );</span>
<a href="#l83.27"></a><span id="l83.27" class="difflineplus">+var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l83.28"></a><span id="l83.28"> </span>
<a href="#l83.29"></a><span id="l83.29" class="difflineplus">+var {</span>
<a href="#l83.30"></a><span id="l83.30" class="difflineplus">+  create_contact,</span>
<a href="#l83.31"></a><span id="l83.31" class="difflineplus">+  create_mailing_list,</span>
<a href="#l83.32"></a><span id="l83.32" class="difflineplus">+  load_contacts_into_address_book,</span>
<a href="#l83.33"></a><span id="l83.33" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l83.34"></a><span id="l83.34" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l83.35"></a><span id="l83.35" class="difflineplus">+);</span>
<a href="#l83.36"></a><span id="l83.36" class="difflineplus">+var {</span>
<a href="#l83.37"></a><span id="l83.37" class="difflineplus">+  assert_equals,</span>
<a href="#l83.38"></a><span id="l83.38" class="difflineplus">+  assert_false,</span>
<a href="#l83.39"></a><span id="l83.39" class="difflineplus">+  assert_true,</span>
<a href="#l83.40"></a><span id="l83.40" class="difflineplus">+  be_in_folder,</span>
<a href="#l83.41"></a><span id="l83.41" class="difflineplus">+  click_tree_row,</span>
<a href="#l83.42"></a><span id="l83.42" class="difflineplus">+  FAKE_SERVER_HOSTNAME,</span>
<a href="#l83.43"></a><span id="l83.43" class="difflineplus">+  get_special_folder,</span>
<a href="#l83.44"></a><span id="l83.44" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l83.45"></a><span id="l83.45" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l83.46"></a><span id="l83.46" class="difflineplus">+);</span>
<a href="#l83.47"></a><span id="l83.47" class="difflineplus">+var {</span>
<a href="#l83.48"></a><span id="l83.48" class="difflineplus">+  clear_recipient,</span>
<a href="#l83.49"></a><span id="l83.49" class="difflineplus">+  close_compose_window,</span>
<a href="#l83.50"></a><span id="l83.50" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l83.51"></a><span id="l83.51" class="difflineplus">+  setup_msg_contents,</span>
<a href="#l83.52"></a><span id="l83.52" class="difflineplus">+  toggle_recipient_type,</span>
<a href="#l83.53"></a><span id="l83.53" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l83.54"></a><span id="l83.54"> var { wait_for_frame_load } = ChromeUtils.import(</span>
<a href="#l83.55"></a><span id="l83.55">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l83.56"></a><span id="l83.56"> );</span>
<a href="#l83.57"></a><span id="l83.57"> </span>
<a href="#l83.58"></a><span id="l83.58"> var { AppConstants } = ChromeUtils.import(</span>
<a href="#l83.59"></a><span id="l83.59">   &quot;resource://gre/modules/AppConstants.jsm&quot;</span>
<a href="#l83.60"></a><span id="l83.60"> );</span>
<a href="#l83.61"></a><span id="l83.61" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l83.62"></a><span id="l83.62" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l83.63"></a><span id="l83.63" class="difflineplus">+);</span>
<a href="#l83.64"></a><span id="l83.64"> </span>
<a href="#l83.65"></a><span id="l83.65"> var account = null;</span>
<a href="#l83.66"></a><span id="l83.66"> </span>
<a href="#l83.67"></a><span id="l83.67"> function setupModule(module) {</span>
<a href="#l83.68"></a><span id="l83.68" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l83.69"></a><span id="l83.69" class="difflineminus">-  collector.getModule(&quot;compose-helpers&quot;).installInto(module);</span>
<a href="#l83.70"></a><span id="l83.70" class="difflineminus">-  collector.getModule(&quot;address-book-helpers&quot;).installInto(module);</span>
<a href="#l83.71"></a><span id="l83.71" class="difflineminus">-</span>
<a href="#l83.72"></a><span id="l83.72">   // Ensure we're in the tinderbox account as that has the right identities set</span>
<a href="#l83.73"></a><span id="l83.73">   // up for this test.</span>
<a href="#l83.74"></a><span id="l83.74">   let server = MailServices.accounts.FindServer(</span>
<a href="#l83.75"></a><span id="l83.75">     &quot;tinderbox&quot;,</span>
<a href="#l83.76"></a><span id="l83.76">     FAKE_SERVER_HOSTNAME,</span>
<a href="#l83.77"></a><span id="l83.77">     &quot;pop3&quot;</span>
<a href="#l83.78"></a><span id="l83.78">   );</span>
<a href="#l83.79"></a><span id="l83.79">   account = MailServices.accounts.FindAccountForServer(server);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l84.1"></a><span id="l84.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-send-format.js</span>
<a href="#l84.2"></a><span id="l84.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-send-format.js</span>
<a href="#l84.3"></a><span id="l84.3" class="difflineat">@@ -4,35 +4,28 @@</span>
<a href="#l84.4"></a><span id="l84.4"> </span>
<a href="#l84.5"></a><span id="l84.5"> /**</span>
<a href="#l84.6"></a><span id="l84.6">  * Tests resulting send format of a message dependent on using HTML features</span>
<a href="#l84.7"></a><span id="l84.7">  * in the composition.</span>
<a href="#l84.8"></a><span id="l84.8">  */</span>
<a href="#l84.9"></a><span id="l84.9"> </span>
<a href="#l84.10"></a><span id="l84.10"> &quot;use strict&quot;;</span>
<a href="#l84.11"></a><span id="l84.11"> </span>
<a href="#l84.12"></a><span id="l84.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l84.13"></a><span id="l84.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l84.14"></a><span id="l84.14" class="difflineminus">-</span>
<a href="#l84.15"></a><span id="l84.15" class="difflineminus">-var MODULE_NAME = &quot;test-send-format&quot;;</span>
<a href="#l84.16"></a><span id="l84.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l84.17"></a><span id="l84.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l84.18"></a><span id="l84.18" class="difflineminus">-</span>
<a href="#l84.19"></a><span id="l84.19"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l84.20"></a><span id="l84.20"> </span>
<a href="#l84.21"></a><span id="l84.21" class="difflineplus">+var { close_compose_window, open_compose_with_reply } = ChromeUtils.import(</span>
<a href="#l84.22"></a><span id="l84.22" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l84.23"></a><span id="l84.23" class="difflineplus">+);</span>
<a href="#l84.24"></a><span id="l84.24" class="difflineplus">+var { assert_equals, open_message_from_file } = ChromeUtils.import(</span>
<a href="#l84.25"></a><span id="l84.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l84.26"></a><span id="l84.26" class="difflineplus">+);</span>
<a href="#l84.27"></a><span id="l84.27"> var { close_window } = ChromeUtils.import(</span>
<a href="#l84.28"></a><span id="l84.28">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l84.29"></a><span id="l84.29"> );</span>
<a href="#l84.30"></a><span id="l84.30"> </span>
<a href="#l84.31"></a><span id="l84.31" class="difflineminus">-function setupModule(module) {</span>
<a href="#l84.32"></a><span id="l84.32" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l84.33"></a><span id="l84.33" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l84.34"></a><span id="l84.34" class="difflineminus">-  }</span>
<a href="#l84.35"></a><span id="l84.35" class="difflineminus">-}</span>
<a href="#l84.36"></a><span id="l84.36" class="difflineminus">-</span>
<a href="#l84.37"></a><span id="l84.37"> function checkMsgFile(aFilePath, aConvertibility) {</span>
<a href="#l84.38"></a><span id="l84.38">   let file = os.getFileForPath(</span>
<a href="#l84.39"></a><span id="l84.39">     os.abspath(aFilePath, os.getFileForPath(__file__))</span>
<a href="#l84.40"></a><span id="l84.40">   );</span>
<a href="#l84.41"></a><span id="l84.41">   let msgc = open_message_from_file(file);</span>
<a href="#l84.42"></a><span id="l84.42"> </span>
<a href="#l84.43"></a><span id="l84.43">   // Creating a reply should not affect convertibility.</span>
<a href="#l84.44"></a><span id="l84.44">   let cwc = open_compose_with_reply(msgc);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l85.1"></a><span id="l85.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-signature-init.js</span>
<a href="#l85.2"></a><span id="l85.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-signature-init.js</span>
<a href="#l85.3"></a><span id="l85.3" class="difflineat">@@ -4,35 +4,30 @@</span>
<a href="#l85.4"></a><span id="l85.4"> </span>
<a href="#l85.5"></a><span id="l85.5"> /**</span>
<a href="#l85.6"></a><span id="l85.6">  * Tests that the compose window initializes with the signature correctly</span>
<a href="#l85.7"></a><span id="l85.7">  * under various circumstances.</span>
<a href="#l85.8"></a><span id="l85.8">  */</span>
<a href="#l85.9"></a><span id="l85.9"> </span>
<a href="#l85.10"></a><span id="l85.10"> &quot;use strict&quot;;</span>
<a href="#l85.11"></a><span id="l85.11"> </span>
<a href="#l85.12"></a><span id="l85.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l85.13"></a><span id="l85.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l85.14"></a><span id="l85.14" class="difflineplus">+var { get_compose_body, open_compose_new_mail } = ChromeUtils.import(</span>
<a href="#l85.15"></a><span id="l85.15" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l85.16"></a><span id="l85.16" class="difflineplus">+);</span>
<a href="#l85.17"></a><span id="l85.17" class="difflineplus">+var { assert_equals } = ChromeUtils.import(</span>
<a href="#l85.18"></a><span id="l85.18" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l85.19"></a><span id="l85.19" class="difflineplus">+);</span>
<a href="#l85.20"></a><span id="l85.20"> </span>
<a href="#l85.21"></a><span id="l85.21" class="difflineminus">-var MODULE_NAME = &quot;test-signature-init&quot;;</span>
<a href="#l85.22"></a><span id="l85.22" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l85.23"></a><span id="l85.23" class="difflineminus">-var MODULE_REQUIRES = [&quot;compose-helpers&quot;, &quot;folder-display-helpers&quot;];</span>
<a href="#l85.24"></a><span id="l85.24" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l85.25"></a><span id="l85.25"> </span>
<a href="#l85.26"></a><span id="l85.26"> var kHtmlPref = &quot;mail.identity.default.compose_html&quot;;</span>
<a href="#l85.27"></a><span id="l85.27"> var kReplyOnTopPref = &quot;mail.identity.default.reply_on_top&quot;;</span>
<a href="#l85.28"></a><span id="l85.28"> var kReplyOnTop = 1;</span>
<a href="#l85.29"></a><span id="l85.29"> var kSigBottomPref = &quot;mail.identity.default.sig_bottom&quot;;</span>
<a href="#l85.30"></a><span id="l85.30"> </span>
<a href="#l85.31"></a><span id="l85.31" class="difflineminus">-var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l85.32"></a><span id="l85.32" class="difflineminus">-</span>
<a href="#l85.33"></a><span id="l85.33" class="difflineminus">-function setupModule(module) {</span>
<a href="#l85.34"></a><span id="l85.34" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l85.35"></a><span id="l85.35" class="difflineminus">-  collector.getModule(&quot;compose-helpers&quot;).installInto(module);</span>
<a href="#l85.36"></a><span id="l85.36" class="difflineminus">-}</span>
<a href="#l85.37"></a><span id="l85.37" class="difflineminus">-</span>
<a href="#l85.38"></a><span id="l85.38"> /**</span>
<a href="#l85.39"></a><span id="l85.39">  * Regression test for bug 762413 - tests that when we're set to reply above,</span>
<a href="#l85.40"></a><span id="l85.40">  * with the signature below the reply, we initialize the compose window such</span>
<a href="#l85.41"></a><span id="l85.41">  * that there is a &lt;br&gt; node above the signature. This allows the user to</span>
<a href="#l85.42"></a><span id="l85.42">  * insert text before the signature.</span>
<a href="#l85.43"></a><span id="l85.43">  */</span>
<a href="#l85.44"></a><span id="l85.44"> function test_on_reply_above_signature_below_reply() {</span>
<a href="#l85.45"></a><span id="l85.45">   let origHtml = Services.prefs.getBoolPref(kHtmlPref);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l86.1"></a><span id="l86.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-signature-updating.js</span>
<a href="#l86.2"></a><span id="l86.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-signature-updating.js</span>
<a href="#l86.3"></a><span id="l86.3" class="difflineat">@@ -9,32 +9,38 @@</span>
<a href="#l86.4"></a><span id="l86.4"> // mail.identity.id1.htmlSigFormat = false</span>
<a href="#l86.5"></a><span id="l86.5"> // mail.identity.id1.htmlSigText   = &quot;Tinderbox is soo 90ies&quot;</span>
<a href="#l86.6"></a><span id="l86.6"> </span>
<a href="#l86.7"></a><span id="l86.7"> // mail.identity.id2.htmlSigFormat = true</span>
<a href="#l86.8"></a><span id="l86.8"> // mail.identity.id2.htmlSigText   = &quot;Tinderboxpushlog is the new &lt;b&gt;hotness!&lt;/b&gt;&quot;</span>
<a href="#l86.9"></a><span id="l86.9"> </span>
<a href="#l86.10"></a><span id="l86.10"> &quot;use strict&quot;;</span>
<a href="#l86.11"></a><span id="l86.11"> </span>
<a href="#l86.12"></a><span id="l86.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l86.13"></a><span id="l86.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l86.14"></a><span id="l86.14" class="difflineplus">+var {</span>
<a href="#l86.15"></a><span id="l86.15" class="difflineplus">+  close_compose_window,</span>
<a href="#l86.16"></a><span id="l86.16" class="difflineplus">+  open_compose_new_mail,</span>
<a href="#l86.17"></a><span id="l86.17" class="difflineplus">+  setup_msg_contents,</span>
<a href="#l86.18"></a><span id="l86.18" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l86.19"></a><span id="l86.19" class="difflineplus">+var {</span>
<a href="#l86.20"></a><span id="l86.20" class="difflineplus">+  assert_equals,</span>
<a href="#l86.21"></a><span id="l86.21" class="difflineplus">+  be_in_folder,</span>
<a href="#l86.22"></a><span id="l86.22" class="difflineplus">+  FAKE_SERVER_HOSTNAME,</span>
<a href="#l86.23"></a><span id="l86.23" class="difflineplus">+  get_special_folder,</span>
<a href="#l86.24"></a><span id="l86.24" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l86.25"></a><span id="l86.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l86.26"></a><span id="l86.26" class="difflineplus">+);</span>
<a href="#l86.27"></a><span id="l86.27"> </span>
<a href="#l86.28"></a><span id="l86.28" class="difflineminus">-var MODULE_NAME = &quot;test-signature-updating&quot;;</span>
<a href="#l86.29"></a><span id="l86.29" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l86.30"></a><span id="l86.30" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l86.31"></a><span id="l86.31" class="difflineminus">-</span>
<a href="#l86.32"></a><span id="l86.32" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l86.33"></a><span id="l86.33" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l86.34"></a><span id="l86.34" class="difflineplus">+);</span>
<a href="#l86.35"></a><span id="l86.35"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l86.36"></a><span id="l86.36"> </span>
<a href="#l86.37"></a><span id="l86.37"> var cwc = null; // compose window controller</span>
<a href="#l86.38"></a><span id="l86.38"> </span>
<a href="#l86.39"></a><span id="l86.39"> function setupModule(module) {</span>
<a href="#l86.40"></a><span id="l86.40" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l86.41"></a><span id="l86.41" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l86.42"></a><span id="l86.42" class="difflineminus">-  }</span>
<a href="#l86.43"></a><span id="l86.43" class="difflineminus">-</span>
<a href="#l86.44"></a><span id="l86.44">   // Ensure we're in the tinderbox account as that has the right identities set</span>
<a href="#l86.45"></a><span id="l86.45">   // up for this test.</span>
<a href="#l86.46"></a><span id="l86.46">   let server = MailServices.accounts.FindServer(</span>
<a href="#l86.47"></a><span id="l86.47">     &quot;tinderbox&quot;,</span>
<a href="#l86.48"></a><span id="l86.48">     FAKE_SERVER_HOSTNAME,</span>
<a href="#l86.49"></a><span id="l86.49">     &quot;pop3&quot;</span>
<a href="#l86.50"></a><span id="l86.50">   );</span>
<a href="#l86.51"></a><span id="l86.51">   let inbox = get_special_folder(Ci.nsMsgFolderFlags.Inbox, false, server);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l87.1"></a><span id="l87.1" class="difflineminus">--- a/mail/test/mozmill/content-policy/test-compose-mailto.js</span>
<a href="#l87.2"></a><span id="l87.2" class="difflineplus">+++ b/mail/test/mozmill/content-policy/test-compose-mailto.js</span>
<a href="#l87.3"></a><span id="l87.3" class="difflineat">@@ -1,55 +1,42 @@</span>
<a href="#l87.4"></a><span id="l87.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l87.5"></a><span id="l87.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l87.6"></a><span id="l87.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l87.7"></a><span id="l87.7"> </span>
<a href="#l87.8"></a><span id="l87.8"> &quot;use strict&quot;;</span>
<a href="#l87.9"></a><span id="l87.9"> </span>
<a href="#l87.10"></a><span id="l87.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l87.11"></a><span id="l87.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l87.12"></a><span id="l87.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l87.13"></a><span id="l87.13" class="difflineminus">-</span>
<a href="#l87.14"></a><span id="l87.14" class="difflineminus">-var MODULE_NAME = &quot;test-compose-mailto&quot;;</span>
<a href="#l87.15"></a><span id="l87.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l87.16"></a><span id="l87.16" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l87.17"></a><span id="l87.17" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l87.18"></a><span id="l87.18" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l87.19"></a><span id="l87.19" class="difflineminus">-  &quot;content-tab-helpers&quot;,</span>
<a href="#l87.20"></a><span id="l87.20" class="difflineminus">-];</span>
<a href="#l87.21"></a><span id="l87.21" class="difflineminus">-</span>
<a href="#l87.22"></a><span id="l87.22" class="difflineplus">+var composeHelper = ChromeUtils.import(</span>
<a href="#l87.23"></a><span id="l87.23" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l87.24"></a><span id="l87.24" class="difflineplus">+);</span>
<a href="#l87.25"></a><span id="l87.25" class="difflineplus">+var { content_tab_eid, open_content_tab_with_url } = ChromeUtils.import(</span>
<a href="#l87.26"></a><span id="l87.26" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l87.27"></a><span id="l87.27" class="difflineplus">+);</span>
<a href="#l87.28"></a><span id="l87.28" class="difflineplus">+var { mc } = ChromeUtils.import(</span>
<a href="#l87.29"></a><span id="l87.29" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l87.30"></a><span id="l87.30" class="difflineplus">+);</span>
<a href="#l87.31"></a><span id="l87.31"> var { input_value } = ChromeUtils.import(</span>
<a href="#l87.32"></a><span id="l87.32">   &quot;resource://testing-common/mozmill/KeyboardHelpers.jsm&quot;</span>
<a href="#l87.33"></a><span id="l87.33"> );</span>
<a href="#l87.34"></a><span id="l87.34"> var {</span>
<a href="#l87.35"></a><span id="l87.35">   plan_for_modal_dialog,</span>
<a href="#l87.36"></a><span id="l87.36">   wait_for_modal_dialog,</span>
<a href="#l87.37"></a><span id="l87.37">   wait_for_window_close,</span>
<a href="#l87.38"></a><span id="l87.38"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l87.39"></a><span id="l87.39"> </span>
<a href="#l87.40"></a><span id="l87.40"> var folder = null;</span>
<a href="#l87.41"></a><span id="l87.41" class="difflineminus">-var composeHelper = null;</span>
<a href="#l87.42"></a><span id="l87.42"> var gMsgNo = 0;</span>
<a href="#l87.43"></a><span id="l87.43"> var gComposeWin;</span>
<a href="#l87.44"></a><span id="l87.44"> var gNewTab;</span>
<a href="#l87.45"></a><span id="l87.45"> var gPreCount;</span>
<a href="#l87.46"></a><span id="l87.46"> </span>
<a href="#l87.47"></a><span id="l87.47"> // RELATIVE_ROOT messes with the collector, so we have to bring the path back</span>
<a href="#l87.48"></a><span id="l87.48"> // so we get the right path for the resources.</span>
<a href="#l87.49"></a><span id="l87.49"> var url = collector.addHttpResource(&quot;../content-policy/html&quot;, &quot;content&quot;);</span>
<a href="#l87.50"></a><span id="l87.50"> </span>
<a href="#l87.51"></a><span id="l87.51" class="difflineminus">-function setupModule(module) {</span>
<a href="#l87.52"></a><span id="l87.52" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l87.53"></a><span id="l87.53" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l87.54"></a><span id="l87.54" class="difflineminus">-  composeHelper = collector.getModule(&quot;compose-helpers&quot;);</span>
<a href="#l87.55"></a><span id="l87.55" class="difflineminus">-  composeHelper.installInto(module);</span>
<a href="#l87.56"></a><span id="l87.56" class="difflineminus">-  let cth = collector.getModule(&quot;content-tab-helpers&quot;);</span>
<a href="#l87.57"></a><span id="l87.57" class="difflineminus">-  cth.installInto(module);</span>
<a href="#l87.58"></a><span id="l87.58" class="difflineminus">-}</span>
<a href="#l87.59"></a><span id="l87.59" class="difflineminus">-</span>
<a href="#l87.60"></a><span id="l87.60"> function test_openComposeFromMailToLink() {</span>
<a href="#l87.61"></a><span id="l87.61">   // Open a content tab with the mailto link in it.</span>
<a href="#l87.62"></a><span id="l87.62">   // To open a tab we're going to have to cheat and use tabmail so we can load</span>
<a href="#l87.63"></a><span id="l87.63">   // in the data of what we want.</span>
<a href="#l87.64"></a><span id="l87.64">   gPreCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l87.65"></a><span id="l87.65">   gNewTab = open_content_tab_with_url(url + &quot;mailtolink.html&quot;);</span>
<a href="#l87.66"></a><span id="l87.66">   gComposeWin = composeHelper.open_compose_with_element_click(</span>
<a href="#l87.67"></a><span id="l87.67">     content_tab_eid(gNewTab, &quot;mailtolink&quot;)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l88.1"></a><span id="l88.1" class="difflineminus">--- a/mail/test/mozmill/content-policy/test-dns-prefetch.js</span>
<a href="#l88.2"></a><span id="l88.2" class="difflineplus">+++ b/mail/test/mozmill/content-policy/test-dns-prefetch.js</span>
<a href="#l88.3"></a><span id="l88.3" class="difflineat">@@ -6,53 +6,52 @@</span>
<a href="#l88.4"></a><span id="l88.4">  * The purpose of this test is to ensure that dns prefetch is turned off in</span>
<a href="#l88.5"></a><span id="l88.5">  * the message pane and compose windows. It also checks that dns prefetch is</span>
<a href="#l88.6"></a><span id="l88.6">  * currently turned off in content tabs, although when bug 545407 is fixed, it</span>
<a href="#l88.7"></a><span id="l88.7">  * should be turned back on again.</span>
<a href="#l88.8"></a><span id="l88.8">  */</span>
<a href="#l88.9"></a><span id="l88.9"> </span>
<a href="#l88.10"></a><span id="l88.10"> &quot;use strict&quot;;</span>
<a href="#l88.11"></a><span id="l88.11"> </span>
<a href="#l88.12"></a><span id="l88.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l88.13"></a><span id="l88.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l88.14"></a><span id="l88.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l88.15"></a><span id="l88.15" class="difflineminus">-</span>
<a href="#l88.16"></a><span id="l88.16" class="difflineminus">-var MODULE_NAME = &quot;test-dns-prefetch&quot;;</span>
<a href="#l88.17"></a><span id="l88.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l88.18"></a><span id="l88.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l88.19"></a><span id="l88.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l88.20"></a><span id="l88.20" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l88.21"></a><span id="l88.21" class="difflineminus">-  &quot;content-tab-helpers&quot;,</span>
<a href="#l88.22"></a><span id="l88.22" class="difflineminus">-];</span>
<a href="#l88.23"></a><span id="l88.23" class="difflineplus">+var composeHelper = ChromeUtils.import(</span>
<a href="#l88.24"></a><span id="l88.24" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l88.25"></a><span id="l88.25" class="difflineplus">+);</span>
<a href="#l88.26"></a><span id="l88.26" class="difflineplus">+var { open_content_tab_with_url } = ChromeUtils.import(</span>
<a href="#l88.27"></a><span id="l88.27" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l88.28"></a><span id="l88.28" class="difflineplus">+);</span>
<a href="#l88.29"></a><span id="l88.29" class="difflineplus">+var {</span>
<a href="#l88.30"></a><span id="l88.30" class="difflineplus">+  assert_nothing_selected,</span>
<a href="#l88.31"></a><span id="l88.31" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l88.32"></a><span id="l88.32" class="difflineplus">+  be_in_folder,</span>
<a href="#l88.33"></a><span id="l88.33" class="difflineplus">+  close_message_window,</span>
<a href="#l88.34"></a><span id="l88.34" class="difflineplus">+  create_folder,</span>
<a href="#l88.35"></a><span id="l88.35" class="difflineplus">+  mc,</span>
<a href="#l88.36"></a><span id="l88.36" class="difflineplus">+  open_selected_message_in_new_window,</span>
<a href="#l88.37"></a><span id="l88.37" class="difflineplus">+  select_click_row,</span>
<a href="#l88.38"></a><span id="l88.38" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l88.39"></a><span id="l88.39" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l88.40"></a><span id="l88.40" class="difflineplus">+);</span>
<a href="#l88.41"></a><span id="l88.41"> </span>
<a href="#l88.42"></a><span id="l88.42"> var folder = null;</span>
<a href="#l88.43"></a><span id="l88.43" class="difflineminus">-var composeHelper = null;</span>
<a href="#l88.44"></a><span id="l88.44"> var gMsgNo = 0;</span>
<a href="#l88.45"></a><span id="l88.45"> var gMsgHdr = null;</span>
<a href="#l88.46"></a><span id="l88.46"> </span>
<a href="#l88.47"></a><span id="l88.47"> // These two constants are used to build the message body.</span>
<a href="#l88.48"></a><span id="l88.48"> var msgBody =</span>
<a href="#l88.49"></a><span id="l88.49">   '&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;\n' +</span>
<a href="#l88.50"></a><span id="l88.50">   &quot;&lt;html&gt;\n&quot; +</span>
<a href="#l88.51"></a><span id="l88.51">   &quot;&lt;head&gt;\n&quot; +</span>
<a href="#l88.52"></a><span id="l88.52">   &quot;\n&quot; +</span>
<a href="#l88.53"></a><span id="l88.53">   '&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;\n' +</span>
<a href="#l88.54"></a><span id="l88.54">   &quot;&lt;/head&gt;\n&quot; +</span>
<a href="#l88.55"></a><span id="l88.55">   '&lt;body bgcolor=&quot;#ffffff&quot; text=&quot;#000000&quot;&gt;\n' +</span>
<a href="#l88.56"></a><span id="l88.56">   &quot;dns prefetch test message\n&quot; +</span>
<a href="#l88.57"></a><span id="l88.57">   &quot;&lt;/body&gt;\n&lt;/html&gt;\n&quot;;</span>
<a href="#l88.58"></a><span id="l88.58"> </span>
<a href="#l88.59"></a><span id="l88.59"> function setupModule(module) {</span>
<a href="#l88.60"></a><span id="l88.60" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l88.61"></a><span id="l88.61" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l88.62"></a><span id="l88.62" class="difflineminus">-  composeHelper = collector.getModule(&quot;compose-helpers&quot;);</span>
<a href="#l88.63"></a><span id="l88.63" class="difflineminus">-  composeHelper.installInto(module);</span>
<a href="#l88.64"></a><span id="l88.64" class="difflineminus">-  let cth = collector.getModule(&quot;content-tab-helpers&quot;);</span>
<a href="#l88.65"></a><span id="l88.65" class="difflineminus">-  cth.installInto(module);</span>
<a href="#l88.66"></a><span id="l88.66" class="difflineminus">-</span>
<a href="#l88.67"></a><span id="l88.67">   folder = create_folder(&quot;dnsPrefetch&quot;);</span>
<a href="#l88.68"></a><span id="l88.68"> }</span>
<a href="#l88.69"></a><span id="l88.69"> </span>
<a href="#l88.70"></a><span id="l88.70"> function addToFolder(aSubject, aBody, aFolder) {</span>
<a href="#l88.71"></a><span id="l88.71">   let msgId =</span>
<a href="#l88.72"></a><span id="l88.72">     Cc[&quot;@mozilla.org/uuid-generator;1&quot;]</span>
<a href="#l88.73"></a><span id="l88.73">       .getService(Ci.nsIUUIDGenerator)</span>
<a href="#l88.74"></a><span id="l88.74">       .generateUUID() + &quot;@mozillamessaging.invalid&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l89.1"></a><span id="l89.1" class="difflineminus">--- a/mail/test/mozmill/content-policy/test-exposed-in-content-tabs.js</span>
<a href="#l89.2"></a><span id="l89.2" class="difflineplus">+++ b/mail/test/mozmill/content-policy/test-exposed-in-content-tabs.js</span>
<a href="#l89.3"></a><span id="l89.3" class="difflineat">@@ -4,30 +4,34 @@</span>
<a href="#l89.4"></a><span id="l89.4"> </span>
<a href="#l89.5"></a><span id="l89.5"> /**</span>
<a href="#l89.6"></a><span id="l89.6">  * The purpose of this test is to ensure that remote content can't gain access</span>
<a href="#l89.7"></a><span id="l89.7">  * to messages by loading their URIs.</span>
<a href="#l89.8"></a><span id="l89.8">  */</span>
<a href="#l89.9"></a><span id="l89.9"> </span>
<a href="#l89.10"></a><span id="l89.10"> &quot;use strict&quot;;</span>
<a href="#l89.11"></a><span id="l89.11"> </span>
<a href="#l89.12"></a><span id="l89.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l89.13"></a><span id="l89.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l89.14"></a><span id="l89.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l89.15"></a><span id="l89.15" class="difflineminus">-</span>
<a href="#l89.16"></a><span id="l89.16" class="difflineminus">-var MODULE_NAME = &quot;test-exposed-in-content-tabs&quot;;</span>
<a href="#l89.17"></a><span id="l89.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l89.18"></a><span id="l89.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l89.19"></a><span id="l89.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l89.20"></a><span id="l89.20" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l89.21"></a><span id="l89.21" class="difflineminus">-  &quot;content-tab-helpers&quot;,</span>
<a href="#l89.22"></a><span id="l89.22" class="difflineminus">-];</span>
<a href="#l89.23"></a><span id="l89.23" class="difflineplus">+var composeHelper = ChromeUtils.import(</span>
<a href="#l89.24"></a><span id="l89.24" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l89.25"></a><span id="l89.25" class="difflineplus">+);</span>
<a href="#l89.26"></a><span id="l89.26" class="difflineplus">+var { open_content_tab_with_url } = ChromeUtils.import(</span>
<a href="#l89.27"></a><span id="l89.27" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l89.28"></a><span id="l89.28" class="difflineplus">+);</span>
<a href="#l89.29"></a><span id="l89.29" class="difflineplus">+var {</span>
<a href="#l89.30"></a><span id="l89.30" class="difflineplus">+  assert_nothing_selected,</span>
<a href="#l89.31"></a><span id="l89.31" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l89.32"></a><span id="l89.32" class="difflineplus">+  be_in_folder,</span>
<a href="#l89.33"></a><span id="l89.33" class="difflineplus">+  create_folder,</span>
<a href="#l89.34"></a><span id="l89.34" class="difflineplus">+  mc,</span>
<a href="#l89.35"></a><span id="l89.35" class="difflineplus">+  select_click_row,</span>
<a href="#l89.36"></a><span id="l89.36" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l89.37"></a><span id="l89.37" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l89.38"></a><span id="l89.38" class="difflineplus">+);</span>
<a href="#l89.39"></a><span id="l89.39"> </span>
<a href="#l89.40"></a><span id="l89.40"> var folder = null;</span>
<a href="#l89.41"></a><span id="l89.41" class="difflineminus">-var composeHelper = null;</span>
<a href="#l89.42"></a><span id="l89.42"> var gMsgNo = 0;</span>
<a href="#l89.43"></a><span id="l89.43"> </span>
<a href="#l89.44"></a><span id="l89.44"> // RELATIVE_ROOT messes with the collector, so we have to bring the path back</span>
<a href="#l89.45"></a><span id="l89.45"> // so we get the right path for the resources.</span>
<a href="#l89.46"></a><span id="l89.46"> var url = collector.addHttpResource(&quot;../content-policy/html&quot;, &quot;content&quot;);</span>
<a href="#l89.47"></a><span id="l89.47"> </span>
<a href="#l89.48"></a><span id="l89.48"> // These two constants are used to build the message body.</span>
<a href="#l89.49"></a><span id="l89.49"> var msgBody =</span>
<a href="#l89.50"></a><span id="l89.50" class="difflineat">@@ -39,23 +43,16 @@ var msgBody =</span>
<a href="#l89.51"></a><span id="l89.51">   &quot;&lt;/head&gt;\n&quot; +</span>
<a href="#l89.52"></a><span id="l89.52">   '&lt;body bgcolor=&quot;#ffffff&quot; text=&quot;#000000&quot;&gt;\n' +</span>
<a href="#l89.53"></a><span id="l89.53">   '&lt;img id=&quot;testelement&quot; src=&quot;' +</span>
<a href="#l89.54"></a><span id="l89.54">   url +</span>
<a href="#l89.55"></a><span id="l89.55">   'pass.png&quot;/&gt;\n' +</span>
<a href="#l89.56"></a><span id="l89.56">   &quot;&lt;/body&gt;\n&lt;/html&gt;\n&quot;;</span>
<a href="#l89.57"></a><span id="l89.57"> </span>
<a href="#l89.58"></a><span id="l89.58"> function setupModule(module) {</span>
<a href="#l89.59"></a><span id="l89.59" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l89.60"></a><span id="l89.60" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l89.61"></a><span id="l89.61" class="difflineminus">-  composeHelper = collector.getModule(&quot;compose-helpers&quot;);</span>
<a href="#l89.62"></a><span id="l89.62" class="difflineminus">-  composeHelper.installInto(module);</span>
<a href="#l89.63"></a><span id="l89.63" class="difflineminus">-  let cth = collector.getModule(&quot;content-tab-helpers&quot;);</span>
<a href="#l89.64"></a><span id="l89.64" class="difflineminus">-  cth.installInto(module);</span>
<a href="#l89.65"></a><span id="l89.65" class="difflineminus">-</span>
<a href="#l89.66"></a><span id="l89.66">   folder = create_folder(&quot;exposedInContent&quot;);</span>
<a href="#l89.67"></a><span id="l89.67"> }</span>
<a href="#l89.68"></a><span id="l89.68"> </span>
<a href="#l89.69"></a><span id="l89.69"> function addToFolder(aSubject, aBody, aFolder) {</span>
<a href="#l89.70"></a><span id="l89.70">   let msgId =</span>
<a href="#l89.71"></a><span id="l89.71">     Cc[&quot;@mozilla.org/uuid-generator;1&quot;]</span>
<a href="#l89.72"></a><span id="l89.72">       .getService(Ci.nsIUUIDGenerator)</span>
<a href="#l89.73"></a><span id="l89.73">       .generateUUID() + &quot;@mozillamessaging.invalid&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l90.1"></a><span id="l90.1" class="difflineminus">--- a/mail/test/mozmill/content-policy/test-general-content-policy.js</span>
<a href="#l90.2"></a><span id="l90.2" class="difflineplus">+++ b/mail/test/mozmill/content-policy/test-general-content-policy.js</span>
<a href="#l90.3"></a><span id="l90.3" class="difflineat">@@ -14,33 +14,47 @@</span>
<a href="#l90.4"></a><span id="l90.4">  * - Reply email compose window</span>
<a href="#l90.5"></a><span id="l90.5">  * - Forward email compose window</span>
<a href="#l90.6"></a><span id="l90.6">  * - Content tab</span>
<a href="#l90.7"></a><span id="l90.7">  * - Feed message</span>
<a href="#l90.8"></a><span id="l90.8">  */</span>
<a href="#l90.9"></a><span id="l90.9"> </span>
<a href="#l90.10"></a><span id="l90.10"> &quot;use strict&quot;;</span>
<a href="#l90.11"></a><span id="l90.11"> </span>
<a href="#l90.12"></a><span id="l90.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l90.13"></a><span id="l90.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l90.14"></a><span id="l90.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l90.15"></a><span id="l90.15" class="difflineminus">-</span>
<a href="#l90.16"></a><span id="l90.16" class="difflineminus">-var MODULE_NAME = &quot;test-general-content-policy&quot;;</span>
<a href="#l90.17"></a><span id="l90.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l90.18"></a><span id="l90.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l90.19"></a><span id="l90.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l90.20"></a><span id="l90.20" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l90.21"></a><span id="l90.21" class="difflineminus">-  &quot;content-tab-helpers&quot;,</span>
<a href="#l90.22"></a><span id="l90.22" class="difflineminus">-];</span>
<a href="#l90.23"></a><span id="l90.23" class="difflineminus">-</span>
<a href="#l90.24"></a><span id="l90.24"> var elib = ChromeUtils.import(</span>
<a href="#l90.25"></a><span id="l90.25">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l90.26"></a><span id="l90.26"> );</span>
<a href="#l90.27"></a><span id="l90.27"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l90.28"></a><span id="l90.28"> </span>
<a href="#l90.29"></a><span id="l90.29" class="difflineplus">+var {</span>
<a href="#l90.30"></a><span id="l90.30" class="difflineplus">+  close_compose_window,</span>
<a href="#l90.31"></a><span id="l90.31" class="difflineplus">+  open_compose_with_forward,</span>
<a href="#l90.32"></a><span id="l90.32" class="difflineplus">+  open_compose_with_reply,</span>
<a href="#l90.33"></a><span id="l90.33" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l90.34"></a><span id="l90.34" class="difflineplus">+var { open_content_tab_with_url } = ChromeUtils.import(</span>
<a href="#l90.35"></a><span id="l90.35" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l90.36"></a><span id="l90.36" class="difflineplus">+);</span>
<a href="#l90.37"></a><span id="l90.37" class="difflineplus">+var {</span>
<a href="#l90.38"></a><span id="l90.38" class="difflineplus">+  assert_equals,</span>
<a href="#l90.39"></a><span id="l90.39" class="difflineplus">+  assert_nothing_selected,</span>
<a href="#l90.40"></a><span id="l90.40" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l90.41"></a><span id="l90.41" class="difflineplus">+  assert_true,</span>
<a href="#l90.42"></a><span id="l90.42" class="difflineplus">+  be_in_folder,</span>
<a href="#l90.43"></a><span id="l90.43" class="difflineplus">+  close_message_window,</span>
<a href="#l90.44"></a><span id="l90.44" class="difflineplus">+  create_folder,</span>
<a href="#l90.45"></a><span id="l90.45" class="difflineplus">+  mc,</span>
<a href="#l90.46"></a><span id="l90.46" class="difflineplus">+  open_message_from_file,</span>
<a href="#l90.47"></a><span id="l90.47" class="difflineplus">+  open_selected_message,</span>
<a href="#l90.48"></a><span id="l90.48" class="difflineplus">+  plan_for_message_display,</span>
<a href="#l90.49"></a><span id="l90.49" class="difflineplus">+  select_click_row,</span>
<a href="#l90.50"></a><span id="l90.50" class="difflineplus">+  set_open_message_behavior,</span>
<a href="#l90.51"></a><span id="l90.51" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l90.52"></a><span id="l90.52" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l90.53"></a><span id="l90.53" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l90.54"></a><span id="l90.54" class="difflineplus">+);</span>
<a href="#l90.55"></a><span id="l90.55"> var { input_value } = ChromeUtils.import(</span>
<a href="#l90.56"></a><span id="l90.56">   &quot;resource://testing-common/mozmill/KeyboardHelpers.jsm&quot;</span>
<a href="#l90.57"></a><span id="l90.57"> );</span>
<a href="#l90.58"></a><span id="l90.58"> var {</span>
<a href="#l90.59"></a><span id="l90.59">   get_notification_button,</span>
<a href="#l90.60"></a><span id="l90.60">   wait_for_notification_to_show,</span>
<a href="#l90.61"></a><span id="l90.61">   wait_for_notification_to_stop,</span>
<a href="#l90.62"></a><span id="l90.62"> } = ChromeUtils.import(</span>
<a href="#l90.63"></a><span id="l90.63" class="difflineat">@@ -119,20 +133,16 @@ var msgBodyStart =</span>
<a href="#l90.64"></a><span id="l90.64">   &quot;\n&quot; +</span>
<a href="#l90.65"></a><span id="l90.65">   '&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;\n' +</span>
<a href="#l90.66"></a><span id="l90.66">   &quot;&lt;/head&gt;\n&quot; +</span>
<a href="#l90.67"></a><span id="l90.67">   '&lt;body bgcolor=&quot;#ffffff&quot; text=&quot;#000000&quot;&gt;\n';</span>
<a href="#l90.68"></a><span id="l90.68"> </span>
<a href="#l90.69"></a><span id="l90.69"> var msgBodyEnd = &quot;&lt;/body&gt;\n&lt;/html&gt;\n&quot;;</span>
<a href="#l90.70"></a><span id="l90.70"> </span>
<a href="#l90.71"></a><span id="l90.71"> function setupModule(module) {</span>
<a href="#l90.72"></a><span id="l90.72" class="difflineminus">-  for (let dep of MODULE_REQUIRES) {</span>
<a href="#l90.73"></a><span id="l90.73" class="difflineminus">-    collector.getModule(dep).installInto(module);</span>
<a href="#l90.74"></a><span id="l90.74" class="difflineminus">-  }</span>
<a href="#l90.75"></a><span id="l90.75" class="difflineminus">-</span>
<a href="#l90.76"></a><span id="l90.76">   folder = create_folder(&quot;generalContentPolicy&quot;);</span>
<a href="#l90.77"></a><span id="l90.77"> }</span>
<a href="#l90.78"></a><span id="l90.78"> </span>
<a href="#l90.79"></a><span id="l90.79"> function addToFolder(aSubject, aBody, aFolder) {</span>
<a href="#l90.80"></a><span id="l90.80">   let msgId =</span>
<a href="#l90.81"></a><span id="l90.81">     Cc[&quot;@mozilla.org/uuid-generator;1&quot;]</span>
<a href="#l90.82"></a><span id="l90.82">       .getService(Ci.nsIUUIDGenerator)</span>
<a href="#l90.83"></a><span id="l90.83">       .generateUUID() + &quot;@mozillamessaging.invalid&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l91.1"></a><span id="l91.1" class="difflineminus">--- a/mail/test/mozmill/content-policy/test-js-content-policy.js</span>
<a href="#l91.2"></a><span id="l91.2" class="difflineplus">+++ b/mail/test/mozmill/content-policy/test-js-content-policy.js</span>
<a href="#l91.3"></a><span id="l91.3" class="difflineat">@@ -6,33 +6,41 @@</span>
<a href="#l91.4"></a><span id="l91.4">  * Tests whether JavaScript in a local/remote message works.</span>
<a href="#l91.5"></a><span id="l91.5">  *</span>
<a href="#l91.6"></a><span id="l91.6">  * @note This assumes an existing local account, and will cause the Trash</span>
<a href="#l91.7"></a><span id="l91.7">  * folder of that account to be emptied multiple times.</span>
<a href="#l91.8"></a><span id="l91.8">  */</span>
<a href="#l91.9"></a><span id="l91.9"> </span>
<a href="#l91.10"></a><span id="l91.10"> &quot;use strict&quot;;</span>
<a href="#l91.11"></a><span id="l91.11"> </span>
<a href="#l91.12"></a><span id="l91.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l91.13"></a><span id="l91.13" class="difflineplus">+var {</span>
<a href="#l91.14"></a><span id="l91.14" class="difflineplus">+  assert_equals,</span>
<a href="#l91.15"></a><span id="l91.15" class="difflineplus">+  assert_nothing_selected,</span>
<a href="#l91.16"></a><span id="l91.16" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l91.17"></a><span id="l91.17" class="difflineplus">+  be_in_folder,</span>
<a href="#l91.18"></a><span id="l91.18" class="difflineplus">+  close_tab,</span>
<a href="#l91.19"></a><span id="l91.19" class="difflineplus">+  create_folder,</span>
<a href="#l91.20"></a><span id="l91.20" class="difflineplus">+  mc,</span>
<a href="#l91.21"></a><span id="l91.21" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l91.22"></a><span id="l91.22" class="difflineplus">+  select_click_row,</span>
<a href="#l91.23"></a><span id="l91.23" class="difflineplus">+  select_none,</span>
<a href="#l91.24"></a><span id="l91.24" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l91.25"></a><span id="l91.25" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l91.26"></a><span id="l91.26" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l91.27"></a><span id="l91.27" class="difflineplus">+);</span>
<a href="#l91.28"></a><span id="l91.28"> </span>
<a href="#l91.29"></a><span id="l91.29" class="difflineminus">-var MODULE_NAME = &quot;test-js-content-policy&quot;;</span>
<a href="#l91.30"></a><span id="l91.30" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l91.31"></a><span id="l91.31" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l91.32"></a><span id="l91.32" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l91.33"></a><span id="l91.33"> </span>
<a href="#l91.34"></a><span id="l91.34"> var folder = null;</span>
<a href="#l91.35"></a><span id="l91.35"> </span>
<a href="#l91.36"></a><span id="l91.36"> // RELATIVE_ROOT messes with the collector, so we have to bring the path back</span>
<a href="#l91.37"></a><span id="l91.37"> // so we get the right path for the resources.</span>
<a href="#l91.38"></a><span id="l91.38"> var url = collector.addHttpResource(&quot;../content-policy/html&quot;, &quot;content&quot;);</span>
<a href="#l91.39"></a><span id="l91.39"> </span>
<a href="#l91.40"></a><span id="l91.40"> function setupModule(module) {</span>
<a href="#l91.41"></a><span id="l91.41" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l91.42"></a><span id="l91.42" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l91.43"></a><span id="l91.43" class="difflineminus">-  }</span>
<a href="#l91.44"></a><span id="l91.44" class="difflineminus">-</span>
<a href="#l91.45"></a><span id="l91.45">   folder = create_folder(&quot;jsContentPolicy&quot;);</span>
<a href="#l91.46"></a><span id="l91.46">   Services.prefs.setBoolPref(&quot;javascript.enabled&quot;, true);</span>
<a href="#l91.47"></a><span id="l91.47"> }</span>
<a href="#l91.48"></a><span id="l91.48"> </span>
<a href="#l91.49"></a><span id="l91.49"> function teardownModule(module) {</span>
<a href="#l91.50"></a><span id="l91.50">   Services.prefs.clearUserPref(&quot;javascript.enabled&quot;);</span>
<a href="#l91.51"></a><span id="l91.51"> }</span>
<a href="#l91.52"></a><span id="l91.52"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l92.1"></a><span id="l92.1" class="difflineminus">--- a/mail/test/mozmill/content-policy/test-plugins-policy.js</span>
<a href="#l92.2"></a><span id="l92.2" class="difflineplus">+++ b/mail/test/mozmill/content-policy/test-plugins-policy.js</span>
<a href="#l92.3"></a><span id="l92.3" class="difflineat">@@ -4,36 +4,45 @@</span>
<a href="#l92.4"></a><span id="l92.4"> </span>
<a href="#l92.5"></a><span id="l92.5"> /**</span>
<a href="#l92.6"></a><span id="l92.6">  * Checks if plugins are enabled in messages correctly or not.</span>
<a href="#l92.7"></a><span id="l92.7">  * As of bug 1508942, plugins are no longer enabled in any context.</span>
<a href="#l92.8"></a><span id="l92.8">  */</span>
<a href="#l92.9"></a><span id="l92.9"> </span>
<a href="#l92.10"></a><span id="l92.10"> &quot;use strict&quot;;</span>
<a href="#l92.11"></a><span id="l92.11"> </span>
<a href="#l92.12"></a><span id="l92.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l92.13"></a><span id="l92.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l92.14"></a><span id="l92.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l92.15"></a><span id="l92.15" class="difflineplus">+var composeHelper = ChromeUtils.import(</span>
<a href="#l92.16"></a><span id="l92.16" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l92.17"></a><span id="l92.17" class="difflineplus">+);</span>
<a href="#l92.18"></a><span id="l92.18" class="difflineplus">+var { open_content_tab_with_url } = ChromeUtils.import(</span>
<a href="#l92.19"></a><span id="l92.19" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l92.20"></a><span id="l92.20" class="difflineplus">+);</span>
<a href="#l92.21"></a><span id="l92.21"> </span>
<a href="#l92.22"></a><span id="l92.22" class="difflineminus">-var MODULE_NAME = &quot;test-plugins-policy&quot;;</span>
<a href="#l92.23"></a><span id="l92.23" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l92.24"></a><span id="l92.24" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l92.25"></a><span id="l92.25" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l92.26"></a><span id="l92.26" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l92.27"></a><span id="l92.27" class="difflineminus">-  &quot;content-tab-helpers&quot;,</span>
<a href="#l92.28"></a><span id="l92.28" class="difflineminus">-];</span>
<a href="#l92.29"></a><span id="l92.29" class="difflineminus">-</span>
<a href="#l92.30"></a><span id="l92.30" class="difflineplus">+var {</span>
<a href="#l92.31"></a><span id="l92.31" class="difflineplus">+  assert_nothing_selected,</span>
<a href="#l92.32"></a><span id="l92.32" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l92.33"></a><span id="l92.33" class="difflineplus">+  be_in_folder,</span>
<a href="#l92.34"></a><span id="l92.34" class="difflineplus">+  close_message_window,</span>
<a href="#l92.35"></a><span id="l92.35" class="difflineplus">+  create_folder,</span>
<a href="#l92.36"></a><span id="l92.36" class="difflineplus">+  mc,</span>
<a href="#l92.37"></a><span id="l92.37" class="difflineplus">+  open_selected_message,</span>
<a href="#l92.38"></a><span id="l92.38" class="difflineplus">+  select_click_row,</span>
<a href="#l92.39"></a><span id="l92.39" class="difflineplus">+  select_none,</span>
<a href="#l92.40"></a><span id="l92.40" class="difflineplus">+  set_open_message_behavior,</span>
<a href="#l92.41"></a><span id="l92.41" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l92.42"></a><span id="l92.42" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l92.43"></a><span id="l92.43" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l92.44"></a><span id="l92.44" class="difflineplus">+);</span>
<a href="#l92.45"></a><span id="l92.45"> var { plan_for_new_window, wait_for_new_window } = ChromeUtils.import(</span>
<a href="#l92.46"></a><span id="l92.46">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l92.47"></a><span id="l92.47"> );</span>
<a href="#l92.48"></a><span id="l92.48"> </span>
<a href="#l92.49"></a><span id="l92.49"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l92.50"></a><span id="l92.50"> </span>
<a href="#l92.51"></a><span id="l92.51"> var folder = null;</span>
<a href="#l92.52"></a><span id="l92.52" class="difflineminus">-var composeHelper = null;</span>
<a href="#l92.53"></a><span id="l92.53"> var gMsgNo = 0;</span>
<a href="#l92.54"></a><span id="l92.54"> </span>
<a href="#l92.55"></a><span id="l92.55"> // RELATIVE_ROOT messes with the collector, so we have to bring the path back</span>
<a href="#l92.56"></a><span id="l92.56"> // so we get the right path for the resources.</span>
<a href="#l92.57"></a><span id="l92.57"> var url = collector.addHttpResource(&quot;../content-policy/html&quot;, &quot;content&quot;);</span>
<a href="#l92.58"></a><span id="l92.58"> </span>
<a href="#l92.59"></a><span id="l92.59"> // These two constants are used to build the message body.</span>
<a href="#l92.60"></a><span id="l92.60"> var msgBody =</span>
<a href="#l92.61"></a><span id="l92.61" class="difflineat">@@ -43,23 +52,16 @@ var msgBody =</span>
<a href="#l92.62"></a><span id="l92.62">   &quot;\n&quot; +</span>
<a href="#l92.63"></a><span id="l92.63">   '&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;\n' +</span>
<a href="#l92.64"></a><span id="l92.64">   &quot;&lt;/head&gt;\n&quot; +</span>
<a href="#l92.65"></a><span id="l92.65">   '&lt;body bgcolor=&quot;#ffffff&quot; text=&quot;#000000&quot;&gt;\n' +</span>
<a href="#l92.66"></a><span id="l92.66">   '&lt;embed id=&quot;testelement&quot; type=&quot;application/x-test&quot; width=&quot;400&quot; height=&quot;400&quot; border=&quot;1&quot;&gt;&lt;/embed&gt;\n' +</span>
<a href="#l92.67"></a><span id="l92.67">   &quot;&lt;/body&gt;\n&lt;/html&gt;\n&quot;;</span>
<a href="#l92.68"></a><span id="l92.68"> </span>
<a href="#l92.69"></a><span id="l92.69"> function setupModule(module) {</span>
<a href="#l92.70"></a><span id="l92.70" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l92.71"></a><span id="l92.71" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l92.72"></a><span id="l92.72" class="difflineminus">-  composeHelper = collector.getModule(&quot;compose-helpers&quot;);</span>
<a href="#l92.73"></a><span id="l92.73" class="difflineminus">-  composeHelper.installInto(module);</span>
<a href="#l92.74"></a><span id="l92.74" class="difflineminus">-  let cth = collector.getModule(&quot;content-tab-helpers&quot;);</span>
<a href="#l92.75"></a><span id="l92.75" class="difflineminus">-  cth.installInto(module);</span>
<a href="#l92.76"></a><span id="l92.76" class="difflineminus">-</span>
<a href="#l92.77"></a><span id="l92.77">   folder = create_folder(&quot;pluginPolicy&quot;);</span>
<a href="#l92.78"></a><span id="l92.78"> }</span>
<a href="#l92.79"></a><span id="l92.79"> </span>
<a href="#l92.80"></a><span id="l92.80"> function addToFolder(aSubject, aBody, aFolder) {</span>
<a href="#l92.81"></a><span id="l92.81">   let msgId =</span>
<a href="#l92.82"></a><span id="l92.82">     Cc[&quot;@mozilla.org/uuid-generator;1&quot;]</span>
<a href="#l92.83"></a><span id="l92.83">       .getService(Ci.nsIUUIDGenerator)</span>
<a href="#l92.84"></a><span id="l92.84">       .generateUUID() + &quot;@mozillamessaging.invalid&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l93.1"></a><span id="l93.1" class="difflineminus">--- a/mail/test/mozmill/content-policy/test-view-source.js</span>
<a href="#l93.2"></a><span id="l93.2" class="difflineplus">+++ b/mail/test/mozmill/content-policy/test-view-source.js</span>
<a href="#l93.3"></a><span id="l93.3" class="difflineat">@@ -3,41 +3,40 @@</span>
<a href="#l93.4"></a><span id="l93.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l93.5"></a><span id="l93.5"> </span>
<a href="#l93.6"></a><span id="l93.6"> /**</span>
<a href="#l93.7"></a><span id="l93.7">  * Test that view-source content can be reloaded to change encoding.</span>
<a href="#l93.8"></a><span id="l93.8">  */</span>
<a href="#l93.9"></a><span id="l93.9"> </span>
<a href="#l93.10"></a><span id="l93.10"> &quot;use strict&quot;;</span>
<a href="#l93.11"></a><span id="l93.11"> </span>
<a href="#l93.12"></a><span id="l93.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l93.13"></a><span id="l93.13" class="difflineminus">-</span>
<a href="#l93.14"></a><span id="l93.14" class="difflineminus">-var MODULE_NAME = &quot;test-view-source&quot;;</span>
<a href="#l93.15"></a><span id="l93.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l93.16"></a><span id="l93.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l93.17"></a><span id="l93.17" class="difflineminus">-</span>
<a href="#l93.18"></a><span id="l93.18"> var elib = ChromeUtils.import(</span>
<a href="#l93.19"></a><span id="l93.19">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l93.20"></a><span id="l93.20"> );</span>
<a href="#l93.21"></a><span id="l93.21"> </span>
<a href="#l93.22"></a><span id="l93.22"> var {</span>
<a href="#l93.23"></a><span id="l93.23" class="difflineplus">+  assert_true,</span>
<a href="#l93.24"></a><span id="l93.24" class="difflineplus">+  be_in_folder,</span>
<a href="#l93.25"></a><span id="l93.25" class="difflineplus">+  create_folder,</span>
<a href="#l93.26"></a><span id="l93.26" class="difflineplus">+  mc,</span>
<a href="#l93.27"></a><span id="l93.27" class="difflineplus">+  select_click_row,</span>
<a href="#l93.28"></a><span id="l93.28" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l93.29"></a><span id="l93.29" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l93.30"></a><span id="l93.30" class="difflineplus">+);</span>
<a href="#l93.31"></a><span id="l93.31" class="difflineplus">+var {</span>
<a href="#l93.32"></a><span id="l93.32">   close_window,</span>
<a href="#l93.33"></a><span id="l93.33">   plan_for_new_window,</span>
<a href="#l93.34"></a><span id="l93.34">   wait_for_new_window,</span>
<a href="#l93.35"></a><span id="l93.35"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l93.36"></a><span id="l93.36"> </span>
<a href="#l93.37"></a><span id="l93.37"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l93.38"></a><span id="l93.38"> </span>
<a href="#l93.39"></a><span id="l93.39"> var folder = null;</span>
<a href="#l93.40"></a><span id="l93.40"> </span>
<a href="#l93.41"></a><span id="l93.41"> function setupModule(module) {</span>
<a href="#l93.42"></a><span id="l93.42" class="difflineminus">-  for (let dep of MODULE_REQUIRES) {</span>
<a href="#l93.43"></a><span id="l93.43" class="difflineminus">-    collector.getModule(dep).installInto(module);</span>
<a href="#l93.44"></a><span id="l93.44" class="difflineminus">-  }</span>
<a href="#l93.45"></a><span id="l93.45" class="difflineminus">-</span>
<a href="#l93.46"></a><span id="l93.46">   folder = create_folder(&quot;viewsource&quot;);</span>
<a href="#l93.47"></a><span id="l93.47"> }</span>
<a href="#l93.48"></a><span id="l93.48"> </span>
<a href="#l93.49"></a><span id="l93.49"> function addToFolder(aSubject, aBody, aFolder) {</span>
<a href="#l93.50"></a><span id="l93.50">   let msgId =</span>
<a href="#l93.51"></a><span id="l93.51">     Cc[&quot;@mozilla.org/uuid-generator;1&quot;]</span>
<a href="#l93.52"></a><span id="l93.52">       .getService(Ci.nsIUUIDGenerator)</span>
<a href="#l93.53"></a><span id="l93.53">       .generateUUID() + &quot;@invalid&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l94.1"></a><span id="l94.1" class="difflineminus">--- a/mail/test/mozmill/content-tabs/test-about-support.js</span>
<a href="#l94.2"></a><span id="l94.2" class="difflineplus">+++ b/mail/test/mozmill/content-tabs/test-about-support.js</span>
<a href="#l94.3"></a><span id="l94.3" class="difflineat">@@ -1,41 +1,52 @@</span>
<a href="#l94.4"></a><span id="l94.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l94.5"></a><span id="l94.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l94.6"></a><span id="l94.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l94.7"></a><span id="l94.7"> </span>
<a href="#l94.8"></a><span id="l94.8"> &quot;use strict&quot;;</span>
<a href="#l94.9"></a><span id="l94.9"> </span>
<a href="#l94.10"></a><span id="l94.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l94.11"></a><span id="l94.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l94.12"></a><span id="l94.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l94.13"></a><span id="l94.13" class="difflineplus">+var { close_compose_window, wait_for_compose_window } = ChromeUtils.import(</span>
<a href="#l94.14"></a><span id="l94.14" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l94.15"></a><span id="l94.15" class="difflineplus">+);</span>
<a href="#l94.16"></a><span id="l94.16" class="difflineplus">+var {</span>
<a href="#l94.17"></a><span id="l94.17" class="difflineplus">+  assert_content_tab_element_hidden,</span>
<a href="#l94.18"></a><span id="l94.18" class="difflineplus">+  assert_content_tab_element_visible,</span>
<a href="#l94.19"></a><span id="l94.19" class="difflineplus">+  assert_content_tab_text_absent,</span>
<a href="#l94.20"></a><span id="l94.20" class="difflineplus">+  assert_content_tab_text_present,</span>
<a href="#l94.21"></a><span id="l94.21" class="difflineplus">+  content_tab_e,</span>
<a href="#l94.22"></a><span id="l94.22" class="difflineplus">+  content_tab_eid,</span>
<a href="#l94.23"></a><span id="l94.23" class="difflineplus">+  get_content_tab_element_display,</span>
<a href="#l94.24"></a><span id="l94.24" class="difflineplus">+  get_element_by_text,</span>
<a href="#l94.25"></a><span id="l94.25" class="difflineplus">+  open_content_tab_with_click,</span>
<a href="#l94.26"></a><span id="l94.26" class="difflineplus">+  wait_for_content_tab_element_display,</span>
<a href="#l94.27"></a><span id="l94.27" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l94.28"></a><span id="l94.28" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l94.29"></a><span id="l94.29" class="difflineplus">+);</span>
<a href="#l94.30"></a><span id="l94.30"> </span>
<a href="#l94.31"></a><span id="l94.31" class="difflineminus">-var MODULE_NAME = &quot;test-about-support&quot;;</span>
<a href="#l94.32"></a><span id="l94.32" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l94.33"></a><span id="l94.33" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l94.34"></a><span id="l94.34" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l94.35"></a><span id="l94.35" class="difflineminus">-  &quot;content-tab-helpers&quot;,</span>
<a href="#l94.36"></a><span id="l94.36" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l94.37"></a><span id="l94.37" class="difflineminus">-];</span>
<a href="#l94.38"></a><span id="l94.38" class="difflineminus">-</span>
<a href="#l94.39"></a><span id="l94.39" class="difflineplus">+var {</span>
<a href="#l94.40"></a><span id="l94.40" class="difflineplus">+  assert_equals,</span>
<a href="#l94.41"></a><span id="l94.41" class="difflineplus">+  assert_true,</span>
<a href="#l94.42"></a><span id="l94.42" class="difflineplus">+  close_tab,</span>
<a href="#l94.43"></a><span id="l94.43" class="difflineplus">+  mark_failure,</span>
<a href="#l94.44"></a><span id="l94.44" class="difflineplus">+  mc,</span>
<a href="#l94.45"></a><span id="l94.45" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l94.46"></a><span id="l94.46" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l94.47"></a><span id="l94.47" class="difflineplus">+);</span>
<a href="#l94.48"></a><span id="l94.48"> var { plan_for_new_window } = ChromeUtils.import(</span>
<a href="#l94.49"></a><span id="l94.49">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l94.50"></a><span id="l94.50"> );</span>
<a href="#l94.51"></a><span id="l94.51"> </span>
<a href="#l94.52"></a><span id="l94.52"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l94.53"></a><span id="l94.53"> // eslint-disable-next-line mozilla/reject-importGlobalProperties</span>
<a href="#l94.54"></a><span id="l94.54"> Cu.importGlobalProperties([&quot;DOMParser&quot;]);</span>
<a href="#l94.55"></a><span id="l94.55"> </span>
<a href="#l94.56"></a><span id="l94.56"> var warningText = new Map();</span>
<a href="#l94.57"></a><span id="l94.57"> </span>
<a href="#l94.58"></a><span id="l94.58"> function setupModule(module) {</span>
<a href="#l94.59"></a><span id="l94.59" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l94.60"></a><span id="l94.60" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l94.61"></a><span id="l94.61" class="difflineminus">-  }</span>
<a href="#l94.62"></a><span id="l94.62" class="difflineminus">-</span>
<a href="#l94.63"></a><span id="l94.63">   // The wording of the warning message when private data is being exported</span>
<a href="#l94.64"></a><span id="l94.64">   // from the about:support page.</span>
<a href="#l94.65"></a><span id="l94.65">   let bundle = Services.strings.createBundle(</span>
<a href="#l94.66"></a><span id="l94.66">     &quot;chrome://messenger/locale/aboutSupportMail.properties&quot;</span>
<a href="#l94.67"></a><span id="l94.67">   );</span>
<a href="#l94.68"></a><span id="l94.68">   // In HTML the warning label and text comprise the textContent of a single element.</span>
<a href="#l94.69"></a><span id="l94.69">   warningText.set(</span>
<a href="#l94.70"></a><span id="l94.70">     &quot;text/html&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l95.1"></a><span id="l95.1" class="difflineminus">--- a/mail/test/mozmill/content-tabs/test-addons-mgr.js</span>
<a href="#l95.2"></a><span id="l95.2" class="difflineplus">+++ b/mail/test/mozmill/content-tabs/test-addons-mgr.js</span>
<a href="#l95.3"></a><span id="l95.3" class="difflineat">@@ -1,37 +1,30 @@</span>
<a href="#l95.4"></a><span id="l95.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l95.5"></a><span id="l95.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l95.6"></a><span id="l95.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l95.7"></a><span id="l95.7"> </span>
<a href="#l95.8"></a><span id="l95.8"> &quot;use strict&quot;;</span>
<a href="#l95.9"></a><span id="l95.9"> </span>
<a href="#l95.10"></a><span id="l95.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l95.11"></a><span id="l95.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l95.12"></a><span id="l95.12" class="difflineminus">-</span>
<a href="#l95.13"></a><span id="l95.13" class="difflineminus">-var MODULE_NAME = &quot;test-addons-mgr&quot;;</span>
<a href="#l95.14"></a><span id="l95.14" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l95.15"></a><span id="l95.15" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;content-tab-helpers&quot;];</span>
<a href="#l95.16"></a><span id="l95.16" class="difflineminus">-</span>
<a href="#l95.17"></a><span id="l95.17"> var elib = ChromeUtils.import(</span>
<a href="#l95.18"></a><span id="l95.18">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l95.19"></a><span id="l95.19"> );</span>
<a href="#l95.20"></a><span id="l95.20"> </span>
<a href="#l95.21"></a><span id="l95.21" class="difflineplus">+var { content_tab_e, wait_for_content_tab_load } = ChromeUtils.import(</span>
<a href="#l95.22"></a><span id="l95.22" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l95.23"></a><span id="l95.23" class="difflineplus">+);</span>
<a href="#l95.24"></a><span id="l95.24" class="difflineplus">+var { assert_true, mc } = ChromeUtils.import(</span>
<a href="#l95.25"></a><span id="l95.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l95.26"></a><span id="l95.26" class="difflineplus">+);</span>
<a href="#l95.27"></a><span id="l95.27"> var {</span>
<a href="#l95.28"></a><span id="l95.28">   plan_for_modal_dialog,</span>
<a href="#l95.29"></a><span id="l95.29">   wait_for_modal_dialog,</span>
<a href="#l95.30"></a><span id="l95.30">   wait_for_window_close,</span>
<a href="#l95.31"></a><span id="l95.31"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l95.32"></a><span id="l95.32"> </span>
<a href="#l95.33"></a><span id="l95.33" class="difflineminus">-function setupModule(module) {</span>
<a href="#l95.34"></a><span id="l95.34" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l95.35"></a><span id="l95.35" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l95.36"></a><span id="l95.36" class="difflineminus">-  }</span>
<a href="#l95.37"></a><span id="l95.37" class="difflineminus">-}</span>
<a href="#l95.38"></a><span id="l95.38" class="difflineminus">-</span>
<a href="#l95.39"></a><span id="l95.39"> function test_open_addons_with_url() {</span>
<a href="#l95.40"></a><span id="l95.40">   mc.window.openAddonsMgr(&quot;addons://list/theme&quot;);</span>
<a href="#l95.41"></a><span id="l95.41">   mc.sleep(0);</span>
<a href="#l95.42"></a><span id="l95.42"> </span>
<a href="#l95.43"></a><span id="l95.43">   let tab = mc.tabmail.currentTabInfo;</span>
<a href="#l95.44"></a><span id="l95.44">   wait_for_content_tab_load(tab, &quot;about:addons&quot;, 10000);</span>
<a href="#l95.45"></a><span id="l95.45">   assert_true(</span>
<a href="#l95.46"></a><span id="l95.46">     content_tab_e(tab, &quot;category-theme&quot;).selected,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l96.1"></a><span id="l96.1" class="difflineminus">--- a/mail/test/mozmill/content-tabs/test-content-tab.js</span>
<a href="#l96.2"></a><span id="l96.2" class="difflineplus">+++ b/mail/test/mozmill/content-tabs/test-content-tab.js</span>
<a href="#l96.3"></a><span id="l96.3" class="difflineat">@@ -1,55 +1,61 @@</span>
<a href="#l96.4"></a><span id="l96.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l96.5"></a><span id="l96.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l96.6"></a><span id="l96.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l96.7"></a><span id="l96.7"> </span>
<a href="#l96.8"></a><span id="l96.8"> &quot;use strict&quot;;</span>
<a href="#l96.9"></a><span id="l96.9"> </span>
<a href="#l96.10"></a><span id="l96.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l96.11"></a><span id="l96.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-dom-helpers.js */</span>
<a href="#l96.12"></a><span id="l96.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l96.13"></a><span id="l96.13" class="difflineminus">-</span>
<a href="#l96.14"></a><span id="l96.14" class="difflineminus">-var MODULE_NAME = &quot;test-content-tab&quot;;</span>
<a href="#l96.15"></a><span id="l96.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l96.16"></a><span id="l96.16" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l96.17"></a><span id="l96.17" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l96.18"></a><span id="l96.18" class="difflineminus">-  &quot;content-tab-helpers&quot;,</span>
<a href="#l96.19"></a><span id="l96.19" class="difflineminus">-  &quot;dom-helpers&quot;,</span>
<a href="#l96.20"></a><span id="l96.20" class="difflineminus">-];</span>
<a href="#l96.21"></a><span id="l96.21" class="difflineminus">-</span>
<a href="#l96.22"></a><span id="l96.22"> var controller = ChromeUtils.import(</span>
<a href="#l96.23"></a><span id="l96.23">   &quot;chrome://mozmill/content/modules/controller.jsm&quot;</span>
<a href="#l96.24"></a><span id="l96.24"> );</span>
<a href="#l96.25"></a><span id="l96.25" class="difflineplus">+var elementslib = ChromeUtils.import(</span>
<a href="#l96.26"></a><span id="l96.26" class="difflineplus">+  &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l96.27"></a><span id="l96.27" class="difflineplus">+);</span>
<a href="#l96.28"></a><span id="l96.28" class="difflineplus">+var EventUtils = ChromeUtils.import(</span>
<a href="#l96.29"></a><span id="l96.29" class="difflineplus">+  &quot;chrome://mozmill/content/stdlib/EventUtils.jsm&quot;</span>
<a href="#l96.30"></a><span id="l96.30" class="difflineplus">+);</span>
<a href="#l96.31"></a><span id="l96.31"> var mozmill = ChromeUtils.import(</span>
<a href="#l96.32"></a><span id="l96.32">   &quot;chrome://mozmill/content/modules/mozmill.jsm&quot;</span>
<a href="#l96.33"></a><span id="l96.33"> );</span>
<a href="#l96.34"></a><span id="l96.34" class="difflineminus">-var elementslib = ChromeUtils.import(</span>
<a href="#l96.35"></a><span id="l96.35" class="difflineminus">-  &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l96.36"></a><span id="l96.36" class="difflineplus">+</span>
<a href="#l96.37"></a><span id="l96.37" class="difflineplus">+var {</span>
<a href="#l96.38"></a><span id="l96.38" class="difflineplus">+  assert_content_tab_has_favicon,</span>
<a href="#l96.39"></a><span id="l96.39" class="difflineplus">+  open_content_tab_with_url,</span>
<a href="#l96.40"></a><span id="l96.40" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l96.41"></a><span id="l96.41" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l96.42"></a><span id="l96.42" class="difflineplus">+);</span>
<a href="#l96.43"></a><span id="l96.43" class="difflineplus">+var { assert_element_visible, assert_element_not_visible } = ChromeUtils.import(</span>
<a href="#l96.44"></a><span id="l96.44" class="difflineplus">+  &quot;resource://testing-common/mozmill/DOMHelpers.jsm&quot;</span>
<a href="#l96.45"></a><span id="l96.45"> );</span>
<a href="#l96.46"></a><span id="l96.46"> </span>
<a href="#l96.47"></a><span id="l96.47" class="difflineplus">+var {</span>
<a href="#l96.48"></a><span id="l96.48" class="difflineplus">+  assert_equals,</span>
<a href="#l96.49"></a><span id="l96.49" class="difflineplus">+  assert_not_equals,</span>
<a href="#l96.50"></a><span id="l96.50" class="difflineplus">+  assert_tab_has_title,</span>
<a href="#l96.51"></a><span id="l96.51" class="difflineplus">+  assert_true,</span>
<a href="#l96.52"></a><span id="l96.52" class="difflineplus">+  close_popup,</span>
<a href="#l96.53"></a><span id="l96.53" class="difflineplus">+  mc,</span>
<a href="#l96.54"></a><span id="l96.54" class="difflineplus">+  wait_for_popup_to_open,</span>
<a href="#l96.55"></a><span id="l96.55" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l96.56"></a><span id="l96.56" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l96.57"></a><span id="l96.57" class="difflineplus">+);</span>
<a href="#l96.58"></a><span id="l96.58"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l96.59"></a><span id="l96.59">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l96.60"></a><span id="l96.60"> );</span>
<a href="#l96.61"></a><span id="l96.61"> </span>
<a href="#l96.62"></a><span id="l96.62"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l96.63"></a><span id="l96.63"> </span>
<a href="#l96.64"></a><span id="l96.64"> // RELATIVE_ROOT messes with the collector, so we have to bring the path back</span>
<a href="#l96.65"></a><span id="l96.65"> // so we get the right path for the resources.</span>
<a href="#l96.66"></a><span id="l96.66"> // Note: this one adds to '' as we need to make sure that favicon.ico is in the</span>
<a href="#l96.67"></a><span id="l96.67"> // root directory.</span>
<a href="#l96.68"></a><span id="l96.68"> var url = collector.addHttpResource(&quot;../content-tabs/html&quot;, &quot;&quot;);</span>
<a href="#l96.69"></a><span id="l96.69"> var whatsUrl = url + &quot;whatsnew.html&quot;;</span>
<a href="#l96.70"></a><span id="l96.70"> </span>
<a href="#l96.71"></a><span id="l96.71" class="difflineminus">-function setupModule(module) {</span>
<a href="#l96.72"></a><span id="l96.72" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l96.73"></a><span id="l96.73" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l96.74"></a><span id="l96.74" class="difflineminus">-  }</span>
<a href="#l96.75"></a><span id="l96.75" class="difflineminus">-}</span>
<a href="#l96.76"></a><span id="l96.76" class="difflineminus">-</span>
<a href="#l96.77"></a><span id="l96.77"> function test_content_tab_open() {</span>
<a href="#l96.78"></a><span id="l96.78">   let tab = open_content_tab_with_url(whatsUrl);</span>
<a href="#l96.79"></a><span id="l96.79"> </span>
<a href="#l96.80"></a><span id="l96.80">   assert_tab_has_title(tab, &quot;What's New Content Test&quot;);</span>
<a href="#l96.81"></a><span id="l96.81">   // Check the location of the what's new image, this is via the link element</span>
<a href="#l96.82"></a><span id="l96.82">   // and therefore should be set and not favicon.png.</span>
<a href="#l96.83"></a><span id="l96.83">   assert_content_tab_has_favicon(tab, url + &quot;whatsnew.png&quot;);</span>
<a href="#l96.84"></a><span id="l96.84"> </span>
<a href="#l96.85"></a><span id="l96.85" class="difflineat">@@ -205,8 +211,14 @@ function test_content_tab_onbeforeunload</span>
<a href="#l96.86"></a><span id="l96.86"> </span>
<a href="#l96.87"></a><span id="l96.87">   Services.prefs.clearUserPref(interactionPref);</span>
<a href="#l96.88"></a><span id="l96.88"> }</span>
<a href="#l96.89"></a><span id="l96.89"> </span>
<a href="#l96.90"></a><span id="l96.90"> // XXX todo</span>
<a href="#l96.91"></a><span id="l96.91"> // - test find bar</span>
<a href="#l96.92"></a><span id="l96.92"> // - window.close within tab</span>
<a href="#l96.93"></a><span id="l96.93"> // - zoom?</span>
<a href="#l96.94"></a><span id="l96.94" class="difflineplus">+</span>
<a href="#l96.95"></a><span id="l96.95" class="difflineplus">+function teardownModule() {</span>
<a href="#l96.96"></a><span id="l96.96" class="difflineplus">+  while (mc.tabmail.tabInfo.length &gt; 1) {</span>
<a href="#l96.97"></a><span id="l96.97" class="difflineplus">+    mc.tabmail.closeTab(1);</span>
<a href="#l96.98"></a><span id="l96.98" class="difflineplus">+  }</span>
<a href="#l96.99"></a><span id="l96.99" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l97.1"></a><span id="l97.1" class="difflineminus">--- a/mail/test/mozmill/content-tabs/test-install-xpi.js</span>
<a href="#l97.2"></a><span id="l97.2" class="difflineplus">+++ b/mail/test/mozmill/content-tabs/test-install-xpi.js</span>
<a href="#l97.3"></a><span id="l97.3" class="difflineat">@@ -1,45 +1,41 @@</span>
<a href="#l97.4"></a><span id="l97.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l97.5"></a><span id="l97.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l97.6"></a><span id="l97.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l97.7"></a><span id="l97.7"> </span>
<a href="#l97.8"></a><span id="l97.8"> &quot;use strict&quot;;</span>
<a href="#l97.9"></a><span id="l97.9"> </span>
<a href="#l97.10"></a><span id="l97.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l97.11"></a><span id="l97.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l97.12"></a><span id="l97.12" class="difflineminus">-</span>
<a href="#l97.13"></a><span id="l97.13" class="difflineminus">-var MODULE_NAME = &quot;test-install-xpi&quot;;</span>
<a href="#l97.14"></a><span id="l97.14" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l97.15"></a><span id="l97.15" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;content-tab-helpers&quot;];</span>
<a href="#l97.16"></a><span id="l97.16" class="difflineminus">-</span>
<a href="#l97.17"></a><span id="l97.17"> var controller = ChromeUtils.import(</span>
<a href="#l97.18"></a><span id="l97.18">   &quot;chrome://mozmill/content/modules/controller.jsm&quot;</span>
<a href="#l97.19"></a><span id="l97.19"> );</span>
<a href="#l97.20"></a><span id="l97.20"> var elib = ChromeUtils.import(</span>
<a href="#l97.21"></a><span id="l97.21">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l97.22"></a><span id="l97.22"> );</span>
<a href="#l97.23"></a><span id="l97.23"> var mozmill = ChromeUtils.import(</span>
<a href="#l97.24"></a><span id="l97.24">   &quot;chrome://mozmill/content/modules/mozmill.jsm&quot;</span>
<a href="#l97.25"></a><span id="l97.25"> );</span>
<a href="#l97.26"></a><span id="l97.26" class="difflineplus">+</span>
<a href="#l97.27"></a><span id="l97.27" class="difflineplus">+var { content_tab_eid, open_content_tab_with_url } = ChromeUtils.import(</span>
<a href="#l97.28"></a><span id="l97.28" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l97.29"></a><span id="l97.29" class="difflineplus">+);</span>
<a href="#l97.30"></a><span id="l97.30" class="difflineplus">+var { mc } = ChromeUtils.import(</span>
<a href="#l97.31"></a><span id="l97.31" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l97.32"></a><span id="l97.32" class="difflineplus">+);</span>
<a href="#l97.33"></a><span id="l97.33" class="difflineplus">+</span>
<a href="#l97.34"></a><span id="l97.34"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l97.35"></a><span id="l97.35"> </span>
<a href="#l97.36"></a><span id="l97.36"> // RELATIVE_ROOT messes with the collector, so we have to bring the path back</span>
<a href="#l97.37"></a><span id="l97.37"> // so we get the right path for the resources.</span>
<a href="#l97.38"></a><span id="l97.38"> var url = collector.addHttpResource(&quot;../content-tabs/html&quot;, &quot;content-tabs&quot;);</span>
<a href="#l97.39"></a><span id="l97.39"> </span>
<a href="#l97.40"></a><span id="l97.40"> var gDocument;</span>
<a href="#l97.41"></a><span id="l97.41"> var gNewTab;</span>
<a href="#l97.42"></a><span id="l97.42"> </span>
<a href="#l97.43"></a><span id="l97.43"> function setupModule(module) {</span>
<a href="#l97.44"></a><span id="l97.44" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l97.45"></a><span id="l97.45" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l97.46"></a><span id="l97.46" class="difflineminus">-  let cth = collector.getModule(&quot;content-tab-helpers&quot;);</span>
<a href="#l97.47"></a><span id="l97.47" class="difflineminus">-  cth.installInto(module);</span>
<a href="#l97.48"></a><span id="l97.48" class="difflineminus">-</span>
<a href="#l97.49"></a><span id="l97.49">   gDocument = mc.window.document;</span>
<a href="#l97.50"></a><span id="l97.50">   gNewTab = open_content_tab_with_url(</span>
<a href="#l97.51"></a><span id="l97.51">     url + &quot;installxpi.html&quot;,</span>
<a href="#l97.52"></a><span id="l97.52">     &quot;specialTabs.siteClickHandler(event, new RegExp('^&quot; + url + &quot;'));&quot;</span>
<a href="#l97.53"></a><span id="l97.53">   );</span>
<a href="#l97.54"></a><span id="l97.54"> }</span>
<a href="#l97.55"></a><span id="l97.55"> </span>
<a href="#l97.56"></a><span id="l97.56"> var teardownModule = function(module) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l98.1"></a><span id="l98.1" class="difflineminus">--- a/mail/test/mozmill/cookies/test-cookies.js</span>
<a href="#l98.2"></a><span id="l98.2" class="difflineplus">+++ b/mail/test/mozmill/cookies/test-cookies.js</span>
<a href="#l98.3"></a><span id="l98.3" class="difflineat">@@ -5,34 +5,27 @@</span>
<a href="#l98.4"></a><span id="l98.4"> /**</span>
<a href="#l98.5"></a><span id="l98.5">  * Test file to check that cookies are correctly enabled in Thunderbird.</span>
<a href="#l98.6"></a><span id="l98.6">  *</span>
<a href="#l98.7"></a><span id="l98.7">  * XXX: Still need to check remote content in messages.</span>
<a href="#l98.8"></a><span id="l98.8">  */</span>
<a href="#l98.9"></a><span id="l98.9"> </span>
<a href="#l98.10"></a><span id="l98.10"> &quot;use strict&quot;;</span>
<a href="#l98.11"></a><span id="l98.11"> </span>
<a href="#l98.12"></a><span id="l98.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l98.13"></a><span id="l98.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l98.14"></a><span id="l98.14" class="difflineminus">-</span>
<a href="#l98.15"></a><span id="l98.15" class="difflineminus">-var MODULE_NAME = &quot;test-cookies&quot;;</span>
<a href="#l98.16"></a><span id="l98.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l98.17"></a><span id="l98.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;content-tab-helpers&quot;, &quot;folder-display-helpers&quot;];</span>
<a href="#l98.18"></a><span id="l98.18" class="difflineplus">+var { open_content_tab_with_url } = ChromeUtils.import(</span>
<a href="#l98.19"></a><span id="l98.19" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l98.20"></a><span id="l98.20" class="difflineplus">+);</span>
<a href="#l98.21"></a><span id="l98.21" class="difflineplus">+var { mc } = ChromeUtils.import(</span>
<a href="#l98.22"></a><span id="l98.22" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l98.23"></a><span id="l98.23" class="difflineplus">+);</span>
<a href="#l98.24"></a><span id="l98.24"> </span>
<a href="#l98.25"></a><span id="l98.25"> // RELATIVE_ROOT messes with the collector, so we have to bring the path back</span>
<a href="#l98.26"></a><span id="l98.26"> // so we get the right path for the resources.</span>
<a href="#l98.27"></a><span id="l98.27"> var url = collector.addHttpResource(&quot;../cookies/html&quot;, &quot;cookies&quot;);</span>
<a href="#l98.28"></a><span id="l98.28"> </span>
<a href="#l98.29"></a><span id="l98.29" class="difflineminus">-function setupModule(module) {</span>
<a href="#l98.30"></a><span id="l98.30" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l98.31"></a><span id="l98.31" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l98.32"></a><span id="l98.32" class="difflineminus">-  let cth = collector.getModule(&quot;content-tab-helpers&quot;);</span>
<a href="#l98.33"></a><span id="l98.33" class="difflineminus">-  cth.installInto(module);</span>
<a href="#l98.34"></a><span id="l98.34" class="difflineminus">-}</span>
<a href="#l98.35"></a><span id="l98.35" class="difflineminus">-</span>
<a href="#l98.36"></a><span id="l98.36"> /**</span>
<a href="#l98.37"></a><span id="l98.37">  * Test deleting junk messages with no messages marked as junk.</span>
<a href="#l98.38"></a><span id="l98.38">  */</span>
<a href="#l98.39"></a><span id="l98.39"> function test_load_cookie_page() {</span>
<a href="#l98.40"></a><span id="l98.40">   open_content_tab_with_url(url + &quot;cookietest1.html&quot;);</span>
<a href="#l98.41"></a><span id="l98.41"> }</span>
<a href="#l98.42"></a><span id="l98.42"> </span>
<a href="#l98.43"></a><span id="l98.43"> function test_load_cookie_result_page() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l99.1"></a><span id="l99.1" class="difflineminus">--- a/mail/test/mozmill/downloads/test-about-downloads.js</span>
<a href="#l99.2"></a><span id="l99.2" class="difflineplus">+++ b/mail/test/mozmill/downloads/test-about-downloads.js</span>
<a href="#l99.3"></a><span id="l99.3" class="difflineat">@@ -3,41 +3,47 @@</span>
<a href="#l99.4"></a><span id="l99.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l99.5"></a><span id="l99.5"> </span>
<a href="#l99.6"></a><span id="l99.6"> /**</span>
<a href="#l99.7"></a><span id="l99.7">  * Test about:downloads.</span>
<a href="#l99.8"></a><span id="l99.8">  */</span>
<a href="#l99.9"></a><span id="l99.9"> </span>
<a href="#l99.10"></a><span id="l99.10"> &quot;use strict&quot;;</span>
<a href="#l99.11"></a><span id="l99.11"> </span>
<a href="#l99.12"></a><span id="l99.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l99.13"></a><span id="l99.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-dom-helpers.js */</span>
<a href="#l99.14"></a><span id="l99.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l99.15"></a><span id="l99.15" class="difflineminus">-</span>
<a href="#l99.16"></a><span id="l99.16" class="difflineminus">-var MODULE_NAME = &quot;test-about-downloads&quot;;</span>
<a href="#l99.17"></a><span id="l99.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l99.18"></a><span id="l99.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l99.19"></a><span id="l99.19" class="difflineminus">-  &quot;content-tab-helpers&quot;,</span>
<a href="#l99.20"></a><span id="l99.20" class="difflineminus">-  &quot;dom-helpers&quot;,</span>
<a href="#l99.21"></a><span id="l99.21" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l99.22"></a><span id="l99.22" class="difflineminus">-];</span>
<a href="#l99.23"></a><span id="l99.23" class="difflineminus">-</span>
<a href="#l99.24"></a><span id="l99.24"> var elementslib = ChromeUtils.import(</span>
<a href="#l99.25"></a><span id="l99.25">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l99.26"></a><span id="l99.26"> );</span>
<a href="#l99.27"></a><span id="l99.27"> </span>
<a href="#l99.28"></a><span id="l99.28" class="difflineminus">-var { wait_for_browser_load } = ChromeUtils.import(</span>
<a href="#l99.29"></a><span id="l99.29" class="difflineminus">-  &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l99.30"></a><span id="l99.30" class="difflineminus">-);</span>
<a href="#l99.31"></a><span id="l99.31" class="difflineminus">-</span>
<a href="#l99.32"></a><span id="l99.32"> var { gMockFilePicker, gMockFilePickReg } = ChromeUtils.import(</span>
<a href="#l99.33"></a><span id="l99.33">   &quot;resource://testing-common/mozmill/AttachmentHelpers.jsm&quot;</span>
<a href="#l99.34"></a><span id="l99.34"> );</span>
<a href="#l99.35"></a><span id="l99.35" class="difflineplus">+var { content_tab_e, content_tab_eid } = ChromeUtils.import(</span>
<a href="#l99.36"></a><span id="l99.36" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l99.37"></a><span id="l99.37" class="difflineplus">+);</span>
<a href="#l99.38"></a><span id="l99.38" class="difflineplus">+var {</span>
<a href="#l99.39"></a><span id="l99.39" class="difflineplus">+  assert_equals,</span>
<a href="#l99.40"></a><span id="l99.40" class="difflineplus">+  assert_false,</span>
<a href="#l99.41"></a><span id="l99.41" class="difflineplus">+  assert_not_equals,</span>
<a href="#l99.42"></a><span id="l99.42" class="difflineplus">+  be_in_folder,</span>
<a href="#l99.43"></a><span id="l99.43" class="difflineplus">+  close_tab,</span>
<a href="#l99.44"></a><span id="l99.44" class="difflineplus">+  create_folder,</span>
<a href="#l99.45"></a><span id="l99.45" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l99.46"></a><span id="l99.46" class="difflineplus">+  mc,</span>
<a href="#l99.47"></a><span id="l99.47" class="difflineplus">+  select_click_row,</span>
<a href="#l99.48"></a><span id="l99.48" class="difflineplus">+  switch_tab,</span>
<a href="#l99.49"></a><span id="l99.49" class="difflineplus">+  wait_for_popup_to_open,</span>
<a href="#l99.50"></a><span id="l99.50" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l99.51"></a><span id="l99.51" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l99.52"></a><span id="l99.52" class="difflineplus">+);</span>
<a href="#l99.53"></a><span id="l99.53" class="difflineplus">+var { wait_for_browser_load } = ChromeUtils.import(</span>
<a href="#l99.54"></a><span id="l99.54" class="difflineplus">+  &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l99.55"></a><span id="l99.55" class="difflineplus">+);</span>
<a href="#l99.56"></a><span id="l99.56"> </span>
<a href="#l99.57"></a><span id="l99.57"> var downloads = ChromeUtils.import(&quot;resource://gre/modules/Downloads.jsm&quot;);</span>
<a href="#l99.58"></a><span id="l99.58" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l99.59"></a><span id="l99.59"> </span>
<a href="#l99.60"></a><span id="l99.60"> var downloadsTab;</span>
<a href="#l99.61"></a><span id="l99.61"> </span>
<a href="#l99.62"></a><span id="l99.62"> var attachmentFileNames = [</span>
<a href="#l99.63"></a><span id="l99.63">   &quot;Attachment#1.txt&quot;,</span>
<a href="#l99.64"></a><span id="l99.64">   &quot;Attachment#2.txt&quot;,</span>
<a href="#l99.65"></a><span id="l99.65">   &quot;Attachment#3.txt&quot;,</span>
<a href="#l99.66"></a><span id="l99.66"> ];</span>
<a href="#l99.67"></a><span id="l99.67" class="difflineat">@@ -116,19 +122,16 @@ function prepare_downloads_view() {</span>
<a href="#l99.68"></a><span id="l99.68">   let success = false;</span>
<a href="#l99.69"></a><span id="l99.69">   downloads.Downloads.getList(downloads.Downloads.ALL)</span>
<a href="#l99.70"></a><span id="l99.70">     .then(list =&gt; list.addView(downloadsView))</span>
<a href="#l99.71"></a><span id="l99.71">     .then(() =&gt; (success = true), Cu.reportError);</span>
<a href="#l99.72"></a><span id="l99.72">   mc.waitFor(() =&gt; success, &quot;Timeout waiting for attaching our download view.&quot;);</span>
<a href="#l99.73"></a><span id="l99.73"> }</span>
<a href="#l99.74"></a><span id="l99.74"> </span>
<a href="#l99.75"></a><span id="l99.75"> function setupModule(module) {</span>
<a href="#l99.76"></a><span id="l99.76" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l99.77"></a><span id="l99.77" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l99.78"></a><span id="l99.78" class="difflineminus">-  }</span>
<a href="#l99.79"></a><span id="l99.79">   gMockFilePickReg.register();</span>
<a href="#l99.80"></a><span id="l99.80"> </span>
<a href="#l99.81"></a><span id="l99.81">   prepare_messages();</span>
<a href="#l99.82"></a><span id="l99.82">   prepare_downloads_view();</span>
<a href="#l99.83"></a><span id="l99.83"> </span>
<a href="#l99.84"></a><span id="l99.84">   downloadsTab = open_about_downloads();</span>
<a href="#l99.85"></a><span id="l99.85"> }</span>
<a href="#l99.86"></a><span id="l99.86"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l100.1"></a><span id="l100.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-archive-messages.js</span>
<a href="#l100.2"></a><span id="l100.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-archive-messages.js</span>
<a href="#l100.3"></a><span id="l100.3" class="difflineat">@@ -1,31 +1,42 @@</span>
<a href="#l100.4"></a><span id="l100.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l100.5"></a><span id="l100.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l100.6"></a><span id="l100.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l100.7"></a><span id="l100.7"> </span>
<a href="#l100.8"></a><span id="l100.8"> &quot;use strict&quot;;</span>
<a href="#l100.9"></a><span id="l100.9"> </span>
<a href="#l100.10"></a><span id="l100.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l100.11"></a><span id="l100.11" class="difflineminus">-</span>
<a href="#l100.12"></a><span id="l100.12" class="difflineminus">-var MODULE_NAME = &quot;test-archive-messages&quot;;</span>
<a href="#l100.13"></a><span id="l100.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l100.14"></a><span id="l100.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l100.15"></a><span id="l100.15" class="difflineplus">+var {</span>
<a href="#l100.16"></a><span id="l100.16" class="difflineplus">+  add_sets_to_folders,</span>
<a href="#l100.17"></a><span id="l100.17" class="difflineplus">+  archive_messages,</span>
<a href="#l100.18"></a><span id="l100.18" class="difflineplus">+  assert_message_not_in_view,</span>
<a href="#l100.19"></a><span id="l100.19" class="difflineplus">+  assert_nothing_selected,</span>
<a href="#l100.20"></a><span id="l100.20" class="difflineplus">+  assert_selected,</span>
<a href="#l100.21"></a><span id="l100.21" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l100.22"></a><span id="l100.22" class="difflineplus">+  be_in_folder,</span>
<a href="#l100.23"></a><span id="l100.23" class="difflineplus">+  create_folder,</span>
<a href="#l100.24"></a><span id="l100.24" class="difflineplus">+  create_thread,</span>
<a href="#l100.25"></a><span id="l100.25" class="difflineplus">+  make_display_threaded,</span>
<a href="#l100.26"></a><span id="l100.26" class="difflineplus">+  mc,</span>
<a href="#l100.27"></a><span id="l100.27" class="difflineplus">+  select_click_row,</span>
<a href="#l100.28"></a><span id="l100.28" class="difflineplus">+  select_none,</span>
<a href="#l100.29"></a><span id="l100.29" class="difflineplus">+  select_shift_click_row,</span>
<a href="#l100.30"></a><span id="l100.30" class="difflineplus">+  toggle_thread_row,</span>
<a href="#l100.31"></a><span id="l100.31" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l100.32"></a><span id="l100.32" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l100.33"></a><span id="l100.33" class="difflineplus">+);</span>
<a href="#l100.34"></a><span id="l100.34"> </span>
<a href="#l100.35"></a><span id="l100.35"> var folder;</span>
<a href="#l100.36"></a><span id="l100.36"> </span>
<a href="#l100.37"></a><span id="l100.37"> /**</span>
<a href="#l100.38"></a><span id="l100.38">  * The number of messages in the thread we use to test.</span>
<a href="#l100.39"></a><span id="l100.39">  */</span>
<a href="#l100.40"></a><span id="l100.40"> var NUM_MESSAGES_IN_THREAD = 6;</span>
<a href="#l100.41"></a><span id="l100.41"> </span>
<a href="#l100.42"></a><span id="l100.42"> function setupModule(module) {</span>
<a href="#l100.43"></a><span id="l100.43" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l100.44"></a><span id="l100.44" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l100.45"></a><span id="l100.45" class="difflineminus">-</span>
<a href="#l100.46"></a><span id="l100.46">   folder = create_folder(&quot;ThreadedMessages&quot;);</span>
<a href="#l100.47"></a><span id="l100.47">   let thread = create_thread(NUM_MESSAGES_IN_THREAD);</span>
<a href="#l100.48"></a><span id="l100.48">   add_sets_to_folders([folder], [thread]);</span>
<a href="#l100.49"></a><span id="l100.49">   thread = create_thread(NUM_MESSAGES_IN_THREAD);</span>
<a href="#l100.50"></a><span id="l100.50">   add_sets_to_folders([folder], [thread]);</span>
<a href="#l100.51"></a><span id="l100.51"> }</span>
<a href="#l100.52"></a><span id="l100.52"> </span>
<a href="#l100.53"></a><span id="l100.53"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l101.1"></a><span id="l101.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-close-window-on-delete.js</span>
<a href="#l101.2"></a><span id="l101.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-close-window-on-delete.js</span>
<a href="#l101.3"></a><span id="l101.3" class="difflineat">@@ -3,34 +3,42 @@</span>
<a href="#l101.4"></a><span id="l101.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l101.5"></a><span id="l101.5"> </span>
<a href="#l101.6"></a><span id="l101.6"> /*</span>
<a href="#l101.7"></a><span id="l101.7">  * Test that the close message window on delete option works.</span>
<a href="#l101.8"></a><span id="l101.8">  */</span>
<a href="#l101.9"></a><span id="l101.9"> </span>
<a href="#l101.10"></a><span id="l101.10"> &quot;use strict&quot;;</span>
<a href="#l101.11"></a><span id="l101.11"> </span>
<a href="#l101.12"></a><span id="l101.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l101.13"></a><span id="l101.13" class="difflineminus">-</span>
<a href="#l101.14"></a><span id="l101.14" class="difflineminus">-var MODULE_NAME = &quot;test-close-window-on-delete&quot;;</span>
<a href="#l101.15"></a><span id="l101.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l101.16"></a><span id="l101.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l101.17"></a><span id="l101.17" class="difflineminus">-</span>
<a href="#l101.18"></a><span id="l101.18" class="difflineplus">+var {</span>
<a href="#l101.19"></a><span id="l101.19" class="difflineplus">+  assert_number_of_tabs_open,</span>
<a href="#l101.20"></a><span id="l101.20" class="difflineplus">+  be_in_folder,</span>
<a href="#l101.21"></a><span id="l101.21" class="difflineplus">+  close_tab,</span>
<a href="#l101.22"></a><span id="l101.22" class="difflineplus">+  create_folder,</span>
<a href="#l101.23"></a><span id="l101.23" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l101.24"></a><span id="l101.24" class="difflineplus">+  mc,</span>
<a href="#l101.25"></a><span id="l101.25" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l101.26"></a><span id="l101.26" class="difflineplus">+  open_selected_message_in_new_window,</span>
<a href="#l101.27"></a><span id="l101.27" class="difflineplus">+  press_delete,</span>
<a href="#l101.28"></a><span id="l101.28" class="difflineplus">+  reset_close_message_on_delete,</span>
<a href="#l101.29"></a><span id="l101.29" class="difflineplus">+  select_click_row,</span>
<a href="#l101.30"></a><span id="l101.30" class="difflineplus">+  set_close_message_on_delete,</span>
<a href="#l101.31"></a><span id="l101.31" class="difflineplus">+  switch_tab,</span>
<a href="#l101.32"></a><span id="l101.32" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l101.33"></a><span id="l101.33" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l101.34"></a><span id="l101.34" class="difflineplus">+);</span>
<a href="#l101.35"></a><span id="l101.35"> var {</span>
<a href="#l101.36"></a><span id="l101.36">   close_window,</span>
<a href="#l101.37"></a><span id="l101.37">   plan_for_window_close,</span>
<a href="#l101.38"></a><span id="l101.38">   wait_for_window_close,</span>
<a href="#l101.39"></a><span id="l101.39"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l101.40"></a><span id="l101.40"> </span>
<a href="#l101.41"></a><span id="l101.41"> var folder;</span>
<a href="#l101.42"></a><span id="l101.42"> </span>
<a href="#l101.43"></a><span id="l101.43"> function setupModule(module) {</span>
<a href="#l101.44"></a><span id="l101.44" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l101.45"></a><span id="l101.45" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l101.46"></a><span id="l101.46" class="difflineminus">-</span>
<a href="#l101.47"></a><span id="l101.47">   folder = create_folder(&quot;CloseWindowOnDeleteA&quot;);</span>
<a href="#l101.48"></a><span id="l101.48"> </span>
<a href="#l101.49"></a><span id="l101.49">   make_new_sets_in_folder(folder, [{ count: 10 }]);</span>
<a href="#l101.50"></a><span id="l101.50"> }</span>
<a href="#l101.51"></a><span id="l101.51"> </span>
<a href="#l101.52"></a><span id="l101.52"> /**</span>
<a href="#l101.53"></a><span id="l101.53">  * Delete a message and check that the message window is closed</span>
<a href="#l101.54"></a><span id="l101.54">  * where appropriate.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l102.1"></a><span id="l102.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-columns.js</span>
<a href="#l102.2"></a><span id="l102.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-columns.js</span>
<a href="#l102.3"></a><span id="l102.3" class="difflineat">@@ -5,33 +5,42 @@</span>
<a href="#l102.4"></a><span id="l102.4"> /*</span>
<a href="#l102.5"></a><span id="l102.5">  * Test column default logic and persistence logic.  Persistence comes in both</span>
<a href="#l102.6"></a><span id="l102.6">  *  tab-switching (because of the multiplexed implementation) and</span>
<a href="#l102.7"></a><span id="l102.7">  *  folder-switching forms.</span>
<a href="#l102.8"></a><span id="l102.8">  */</span>
<a href="#l102.9"></a><span id="l102.9"> </span>
<a href="#l102.10"></a><span id="l102.10"> &quot;use strict&quot;;</span>
<a href="#l102.11"></a><span id="l102.11"> </span>
<a href="#l102.12"></a><span id="l102.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l102.13"></a><span id="l102.13" class="difflineminus">-</span>
<a href="#l102.14"></a><span id="l102.14" class="difflineminus">-var MODULE_NAME = &quot;test-columns&quot;;</span>
<a href="#l102.15"></a><span id="l102.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l102.16"></a><span id="l102.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l102.17"></a><span id="l102.17" class="difflineminus">-</span>
<a href="#l102.18"></a><span id="l102.18"> var elib = ChromeUtils.import(</span>
<a href="#l102.19"></a><span id="l102.19">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l102.20"></a><span id="l102.20"> );</span>
<a href="#l102.21"></a><span id="l102.21"> </span>
<a href="#l102.22"></a><span id="l102.22"> var {</span>
<a href="#l102.23"></a><span id="l102.23" class="difflineplus">+  be_in_folder,</span>
<a href="#l102.24"></a><span id="l102.24" class="difflineplus">+  close_tab,</span>
<a href="#l102.25"></a><span id="l102.25" class="difflineplus">+  create_folder,</span>
<a href="#l102.26"></a><span id="l102.26" class="difflineplus">+  create_virtual_folder,</span>
<a href="#l102.27"></a><span id="l102.27" class="difflineplus">+  enter_folder,</span>
<a href="#l102.28"></a><span id="l102.28" class="difflineplus">+  inboxFolder,</span>
<a href="#l102.29"></a><span id="l102.29" class="difflineplus">+  mc,</span>
<a href="#l102.30"></a><span id="l102.30" class="difflineplus">+  open_folder_in_new_tab,</span>
<a href="#l102.31"></a><span id="l102.31" class="difflineplus">+  switch_tab,</span>
<a href="#l102.32"></a><span id="l102.32" class="difflineplus">+  wait_for_all_messages_to_load,</span>
<a href="#l102.33"></a><span id="l102.33" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l102.34"></a><span id="l102.34" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l102.35"></a><span id="l102.35" class="difflineplus">+);</span>
<a href="#l102.36"></a><span id="l102.36" class="difflineplus">+var {</span>
<a href="#l102.37"></a><span id="l102.37">   plan_for_modal_dialog,</span>
<a href="#l102.38"></a><span id="l102.38">   plan_for_observable_event,</span>
<a href="#l102.39"></a><span id="l102.39">   wait_for_modal_dialog,</span>
<a href="#l102.40"></a><span id="l102.40">   wait_for_observable_event,</span>
<a href="#l102.41"></a><span id="l102.41"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l102.42"></a><span id="l102.42"> </span>
<a href="#l102.43"></a><span id="l102.43" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l102.44"></a><span id="l102.44"> // needed to zero inter-folder processing delay</span>
<a href="#l102.45"></a><span id="l102.45"> var { MailUtils } = ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l102.46"></a><span id="l102.46"> </span>
<a href="#l102.47"></a><span id="l102.47"> var folderInbox, folderSent, folderVirtual, folderA, folderB;</span>
<a href="#l102.48"></a><span id="l102.48"> // INBOX_DEFAULTS sans 'dateCol' but gains 'tagsCol'</span>
<a href="#l102.49"></a><span id="l102.49"> var columnsB;</span>
<a href="#l102.50"></a><span id="l102.50"> // GLODA_DEFAULTS sans 'locationCol' but gains 'accountCol'</span>
<a href="#l102.51"></a><span id="l102.51"> var glodaColumns;</span>
<a href="#l102.52"></a><span id="l102.52" class="difflineat">@@ -43,19 +52,16 @@ var gColumnStateUpdated = false;</span>
<a href="#l102.53"></a><span id="l102.53"> </span>
<a href="#l102.54"></a><span id="l102.54"> var useCorrespondent;</span>
<a href="#l102.55"></a><span id="l102.55"> var INBOX_DEFAULTS;</span>
<a href="#l102.56"></a><span id="l102.56"> var SENT_DEFAULTS;</span>
<a href="#l102.57"></a><span id="l102.57"> var VIRTUAL_DEFAULTS;</span>
<a href="#l102.58"></a><span id="l102.58"> var GLODA_DEFAULTS;</span>
<a href="#l102.59"></a><span id="l102.59"> </span>
<a href="#l102.60"></a><span id="l102.60"> function setupModule(module) {</span>
<a href="#l102.61"></a><span id="l102.61" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l102.62"></a><span id="l102.62" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l102.63"></a><span id="l102.63" class="difflineminus">-</span>
<a href="#l102.64"></a><span id="l102.64">   useCorrespondent = Services.prefs.getBoolPref(</span>
<a href="#l102.65"></a><span id="l102.65">     &quot;mail.threadpane.use_correspondents&quot;</span>
<a href="#l102.66"></a><span id="l102.66">   );</span>
<a href="#l102.67"></a><span id="l102.67">   INBOX_DEFAULTS = [</span>
<a href="#l102.68"></a><span id="l102.68">     &quot;threadCol&quot;,</span>
<a href="#l102.69"></a><span id="l102.69">     &quot;flaggedCol&quot;,</span>
<a href="#l102.70"></a><span id="l102.70">     &quot;attachmentCol&quot;,</span>
<a href="#l102.71"></a><span id="l102.71">     &quot;subjectCol&quot;,</span>
<a href="#l102.72"></a><span id="l102.72" class="difflineat">@@ -655,8 +661,14 @@ function test_reset_columns_gloda_collec</span>
<a href="#l102.73"></a><span id="l102.73"> </span>
<a href="#l102.74"></a><span id="l102.74">   invoke_column_picker_option([{ anonid: &quot;menuitem&quot; }]); // reset!</span>
<a href="#l102.75"></a><span id="l102.75">   assert_visible_columns(glodaColumns); // same, only order (would be) reset</span>
<a href="#l102.76"></a><span id="l102.76"> </span>
<a href="#l102.77"></a><span id="l102.77">   mc.tabmail.openTab(&quot;glodaList&quot;, { collection: fakeCollection });</span>
<a href="#l102.78"></a><span id="l102.78">   wait_for_all_messages_to_load();</span>
<a href="#l102.79"></a><span id="l102.79">   assert_visible_columns(glodaColumns);</span>
<a href="#l102.80"></a><span id="l102.80"> }</span>
<a href="#l102.81"></a><span id="l102.81" class="difflineplus">+</span>
<a href="#l102.82"></a><span id="l102.82" class="difflineplus">+function teardownModule() {</span>
<a href="#l102.83"></a><span id="l102.83" class="difflineplus">+  while (mc.tabmail.tabInfo.length &gt; 1) {</span>
<a href="#l102.84"></a><span id="l102.84" class="difflineplus">+    mc.tabmail.closeTab(1);</span>
<a href="#l102.85"></a><span id="l102.85" class="difflineplus">+  }</span>
<a href="#l102.86"></a><span id="l102.86" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l103.1"></a><span id="l103.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-deletion-from-virtual-folders.js</span>
<a href="#l103.2"></a><span id="l103.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-deletion-from-virtual-folders.js</span>
<a href="#l103.3"></a><span id="l103.3" class="difflineat">@@ -3,44 +3,58 @@</span>
<a href="#l103.4"></a><span id="l103.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l103.5"></a><span id="l103.5"> </span>
<a href="#l103.6"></a><span id="l103.6"> /*</span>
<a href="#l103.7"></a><span id="l103.7">  * Test that deleting messages works from a virtual folder.</span>
<a href="#l103.8"></a><span id="l103.8">  */</span>
<a href="#l103.9"></a><span id="l103.9"> </span>
<a href="#l103.10"></a><span id="l103.10"> &quot;use strict&quot;;</span>
<a href="#l103.11"></a><span id="l103.11"> </span>
<a href="#l103.12"></a><span id="l103.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l103.13"></a><span id="l103.13" class="difflineminus">-</span>
<a href="#l103.14"></a><span id="l103.14" class="difflineminus">-var MODULE_NAME = &quot;test-deletion-from-virtual-folders&quot;;</span>
<a href="#l103.15"></a><span id="l103.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l103.16"></a><span id="l103.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l103.17"></a><span id="l103.17" class="difflineminus">-</span>
<a href="#l103.18"></a><span id="l103.18" class="difflineplus">+var {</span>
<a href="#l103.19"></a><span id="l103.19" class="difflineplus">+  assert_messages_in_view,</span>
<a href="#l103.20"></a><span id="l103.20" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l103.21"></a><span id="l103.21" class="difflineplus">+  assert_tab_titled_from,</span>
<a href="#l103.22"></a><span id="l103.22" class="difflineplus">+  be_in_folder,</span>
<a href="#l103.23"></a><span id="l103.23" class="difflineplus">+  create_folder,</span>
<a href="#l103.24"></a><span id="l103.24" class="difflineplus">+  get_smart_folder_named,</span>
<a href="#l103.25"></a><span id="l103.25" class="difflineplus">+  inboxFolder,</span>
<a href="#l103.26"></a><span id="l103.26" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l103.27"></a><span id="l103.27" class="difflineplus">+  mc,</span>
<a href="#l103.28"></a><span id="l103.28" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l103.29"></a><span id="l103.29" class="difflineplus">+  open_selected_message_in_new_window,</span>
<a href="#l103.30"></a><span id="l103.30" class="difflineplus">+  press_delete,</span>
<a href="#l103.31"></a><span id="l103.31" class="difflineplus">+  select_click_row,</span>
<a href="#l103.32"></a><span id="l103.32" class="difflineplus">+  switch_tab,</span>
<a href="#l103.33"></a><span id="l103.33" class="difflineplus">+  wait_for_all_messages_to_load,</span>
<a href="#l103.34"></a><span id="l103.34" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l103.35"></a><span id="l103.35" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l103.36"></a><span id="l103.36" class="difflineplus">+);</span>
<a href="#l103.37"></a><span id="l103.37"> var {</span>
<a href="#l103.38"></a><span id="l103.38">   plan_for_modal_dialog,</span>
<a href="#l103.39"></a><span id="l103.39">   plan_for_window_close,</span>
<a href="#l103.40"></a><span id="l103.40">   wait_for_modal_dialog,</span>
<a href="#l103.41"></a><span id="l103.41">   wait_for_window_close,</span>
<a href="#l103.42"></a><span id="l103.42"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l103.43"></a><span id="l103.43"> </span>
<a href="#l103.44"></a><span id="l103.44" class="difflineplus">+var { MailViewConstants } = ChromeUtils.import(</span>
<a href="#l103.45"></a><span id="l103.45" class="difflineplus">+  &quot;resource:///modules/MailViewManager.jsm&quot;</span>
<a href="#l103.46"></a><span id="l103.46" class="difflineplus">+);</span>
<a href="#l103.47"></a><span id="l103.47" class="difflineplus">+</span>
<a href="#l103.48"></a><span id="l103.48"> var baseFolder, folder, lastMessageFolder;</span>
<a href="#l103.49"></a><span id="l103.49"> </span>
<a href="#l103.50"></a><span id="l103.50"> var tabFolder, tabMessage, tabMessageBackground, curMessage, nextMessage;</span>
<a href="#l103.51"></a><span id="l103.51"> </span>
<a href="#l103.52"></a><span id="l103.52"> var setNormal;</span>
<a href="#l103.53"></a><span id="l103.53"> </span>
<a href="#l103.54"></a><span id="l103.54"> /**</span>
<a href="#l103.55"></a><span id="l103.55">  * The message window controller.</span>
<a href="#l103.56"></a><span id="l103.56">  */</span>
<a href="#l103.57"></a><span id="l103.57"> var msgc;</span>
<a href="#l103.58"></a><span id="l103.58"> </span>
<a href="#l103.59"></a><span id="l103.59"> function setupModule(module) {</span>
<a href="#l103.60"></a><span id="l103.60" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l103.61"></a><span id="l103.61" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l103.62"></a><span id="l103.62" class="difflineminus">-</span>
<a href="#l103.63"></a><span id="l103.63">   baseFolder = create_folder(&quot;DeletionFromVirtualFoldersA&quot;);</span>
<a href="#l103.64"></a><span id="l103.64">   // For setTagged, we want exactly as many messages as we plan to delete, so</span>
<a href="#l103.65"></a><span id="l103.65">   // that we can test that the message window and tabs close when they run out</span>
<a href="#l103.66"></a><span id="l103.66">   // of things to display.</span>
<a href="#l103.67"></a><span id="l103.67">   let [, setTagged] = make_new_sets_in_folder(baseFolder, [</span>
<a href="#l103.68"></a><span id="l103.68">     { count: 4 },</span>
<a href="#l103.69"></a><span id="l103.69">     { count: 4 },</span>
<a href="#l103.70"></a><span id="l103.70">   ]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l104.1"></a><span id="l104.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-deletion-with-multiple-displays.js</span>
<a href="#l104.2"></a><span id="l104.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-deletion-with-multiple-displays.js</span>
<a href="#l104.3"></a><span id="l104.3" class="difflineat">@@ -7,39 +7,49 @@</span>
<a href="#l104.4"></a><span id="l104.4">  *  that tab/window as well as all other tabs/windows.  We also test that the</span>
<a href="#l104.5"></a><span id="l104.5">  *  message tab title updates appropriately through all of this. We do all of</span>
<a href="#l104.6"></a><span id="l104.6">  *  this both for tabs that have ever been opened in the foreground, and tabs</span>
<a href="#l104.7"></a><span id="l104.7">  *  that haven't (and thus might have fake selections).</span>
<a href="#l104.8"></a><span id="l104.8">  */</span>
<a href="#l104.9"></a><span id="l104.9"> </span>
<a href="#l104.10"></a><span id="l104.10"> &quot;use strict&quot;;</span>
<a href="#l104.11"></a><span id="l104.11"> </span>
<a href="#l104.12"></a><span id="l104.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l104.13"></a><span id="l104.13" class="difflineminus">-</span>
<a href="#l104.14"></a><span id="l104.14" class="difflineminus">-var MODULE_NAME = &quot;test-deletion-with-multiple-displays&quot;;</span>
<a href="#l104.15"></a><span id="l104.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l104.16"></a><span id="l104.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l104.17"></a><span id="l104.17" class="difflineminus">-</span>
<a href="#l104.18"></a><span id="l104.18" class="difflineplus">+var {</span>
<a href="#l104.19"></a><span id="l104.19" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l104.20"></a><span id="l104.20" class="difflineplus">+  assert_tab_titled_from,</span>
<a href="#l104.21"></a><span id="l104.21" class="difflineplus">+  be_in_folder,</span>
<a href="#l104.22"></a><span id="l104.22" class="difflineplus">+  close_message_window,</span>
<a href="#l104.23"></a><span id="l104.23" class="difflineplus">+  close_tab,</span>
<a href="#l104.24"></a><span id="l104.24" class="difflineplus">+  create_folder,</span>
<a href="#l104.25"></a><span id="l104.25" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l104.26"></a><span id="l104.26" class="difflineplus">+  mc,</span>
<a href="#l104.27"></a><span id="l104.27" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l104.28"></a><span id="l104.28" class="difflineplus">+  open_selected_message_in_new_window,</span>
<a href="#l104.29"></a><span id="l104.29" class="difflineplus">+  press_delete,</span>
<a href="#l104.30"></a><span id="l104.30" class="difflineplus">+  select_click_row,</span>
<a href="#l104.31"></a><span id="l104.31" class="difflineplus">+  select_control_click_row,</span>
<a href="#l104.32"></a><span id="l104.32" class="difflineplus">+  select_shift_click_row,</span>
<a href="#l104.33"></a><span id="l104.33" class="difflineplus">+  switch_tab,</span>
<a href="#l104.34"></a><span id="l104.34" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l104.35"></a><span id="l104.35" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l104.36"></a><span id="l104.36" class="difflineplus">+);</span>
<a href="#l104.37"></a><span id="l104.37"> var { plan_for_window_close, wait_for_window_close } = ChromeUtils.import(</span>
<a href="#l104.38"></a><span id="l104.38">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l104.39"></a><span id="l104.39"> );</span>
<a href="#l104.40"></a><span id="l104.40"> </span>
<a href="#l104.41"></a><span id="l104.41"> var folder,</span>
<a href="#l104.42"></a><span id="l104.42">   lastMessageFolder,</span>
<a href="#l104.43"></a><span id="l104.43">   oneBeforeFolder,</span>
<a href="#l104.44"></a><span id="l104.44">   oneAfterFolder,</span>
<a href="#l104.45"></a><span id="l104.45">   multipleDeletionFolder1,</span>
<a href="#l104.46"></a><span id="l104.46">   multipleDeletionFolder2,</span>
<a href="#l104.47"></a><span id="l104.47">   multipleDeletionFolder3,</span>
<a href="#l104.48"></a><span id="l104.48">   multipleDeletionFolder4;</span>
<a href="#l104.49"></a><span id="l104.49"> </span>
<a href="#l104.50"></a><span id="l104.50"> function setupModule(module) {</span>
<a href="#l104.51"></a><span id="l104.51" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l104.52"></a><span id="l104.52" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l104.53"></a><span id="l104.53" class="difflineminus">-</span>
<a href="#l104.54"></a><span id="l104.54">   folder = create_folder(&quot;DeletionA&quot;);</span>
<a href="#l104.55"></a><span id="l104.55">   lastMessageFolder = create_folder(&quot;DeletionB&quot;);</span>
<a href="#l104.56"></a><span id="l104.56">   oneBeforeFolder = create_folder(&quot;DeletionC&quot;);</span>
<a href="#l104.57"></a><span id="l104.57">   oneAfterFolder = create_folder(&quot;DeletionD&quot;);</span>
<a href="#l104.58"></a><span id="l104.58">   multipleDeletionFolder1 = create_folder(&quot;DeletionE&quot;);</span>
<a href="#l104.59"></a><span id="l104.59">   multipleDeletionFolder2 = create_folder(&quot;DeletionF&quot;);</span>
<a href="#l104.60"></a><span id="l104.60">   multipleDeletionFolder3 = create_folder(&quot;DeletionG&quot;);</span>
<a href="#l104.61"></a><span id="l104.61">   multipleDeletionFolder4 = create_folder(&quot;DeletionH&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l105.1"></a><span id="l105.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-display-name.js</span>
<a href="#l105.2"></a><span id="l105.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-display-name.js</span>
<a href="#l105.3"></a><span id="l105.3" class="difflineat">@@ -4,22 +4,30 @@</span>
<a href="#l105.4"></a><span id="l105.4"> </span>
<a href="#l105.5"></a><span id="l105.5"> /*</span>
<a href="#l105.6"></a><span id="l105.6">  * Test that the display names in email addresses are correctly shown in the</span>
<a href="#l105.7"></a><span id="l105.7">  * thread pane.</span>
<a href="#l105.8"></a><span id="l105.8">  */</span>
<a href="#l105.9"></a><span id="l105.9"> </span>
<a href="#l105.10"></a><span id="l105.10"> &quot;use strict&quot;;</span>
<a href="#l105.11"></a><span id="l105.11"> </span>
<a href="#l105.12"></a><span id="l105.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l105.13"></a><span id="l105.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l105.14"></a><span id="l105.14" class="difflineminus">-</span>
<a href="#l105.15"></a><span id="l105.15" class="difflineminus">-var MODULE_NAME = &quot;test-display-name&quot;;</span>
<a href="#l105.16"></a><span id="l105.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l105.17"></a><span id="l105.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;address-book-helpers&quot;];</span>
<a href="#l105.18"></a><span id="l105.18" class="difflineplus">+var { ensure_card_exists } = ChromeUtils.import(</span>
<a href="#l105.19"></a><span id="l105.19" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l105.20"></a><span id="l105.20" class="difflineplus">+);</span>
<a href="#l105.21"></a><span id="l105.21" class="difflineplus">+var {</span>
<a href="#l105.22"></a><span id="l105.22" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l105.23"></a><span id="l105.23" class="difflineplus">+  assert_equals,</span>
<a href="#l105.24"></a><span id="l105.24" class="difflineplus">+  be_in_folder,</span>
<a href="#l105.25"></a><span id="l105.25" class="difflineplus">+  create_folder,</span>
<a href="#l105.26"></a><span id="l105.26" class="difflineplus">+  create_message,</span>
<a href="#l105.27"></a><span id="l105.27" class="difflineplus">+  mc,</span>
<a href="#l105.28"></a><span id="l105.28" class="difflineplus">+  select_click_row,</span>
<a href="#l105.29"></a><span id="l105.29" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l105.30"></a><span id="l105.30" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l105.31"></a><span id="l105.31" class="difflineplus">+);</span>
<a href="#l105.32"></a><span id="l105.32"> </span>
<a href="#l105.33"></a><span id="l105.33"> var folder;</span>
<a href="#l105.34"></a><span id="l105.34"> </span>
<a href="#l105.35"></a><span id="l105.35"> var messages = [</span>
<a href="#l105.36"></a><span id="l105.36">   // Basic From header tests</span>
<a href="#l105.37"></a><span id="l105.37">   {</span>
<a href="#l105.38"></a><span id="l105.38">     name: &quot;from_display_name_unquoted&quot;,</span>
<a href="#l105.39"></a><span id="l105.39">     headers: { From: &quot;Carter Burke &lt;cburke@wyutani.invalid&gt;&quot; },</span>
<a href="#l105.40"></a><span id="l105.40" class="difflineat">@@ -183,20 +191,16 @@ var messages = [</span>
<a href="#l105.41"></a><span id="l105.41"> ];</span>
<a href="#l105.42"></a><span id="l105.42"> </span>
<a href="#l105.43"></a><span id="l105.43"> var contacts = [</span>
<a href="#l105.44"></a><span id="l105.44">   { email: &quot;aapone@uscmc.invalid&quot;, name: &quot;Sarge&quot;, pdn: true },</span>
<a href="#l105.45"></a><span id="l105.45">   { email: &quot;rjorden@hadleys-hope.invalid&quot;, name: &quot;Newt&quot;, pdn: false },</span>
<a href="#l105.46"></a><span id="l105.46"> ];</span>
<a href="#l105.47"></a><span id="l105.47"> </span>
<a href="#l105.48"></a><span id="l105.48"> function setupModule(module) {</span>
<a href="#l105.49"></a><span id="l105.49" class="difflineminus">-  for (let req of MODULE_REQUIRES) {</span>
<a href="#l105.50"></a><span id="l105.50" class="difflineminus">-    collector.getModule(req).installInto(module);</span>
<a href="#l105.51"></a><span id="l105.51" class="difflineminus">-  }</span>
<a href="#l105.52"></a><span id="l105.52" class="difflineminus">-</span>
<a href="#l105.53"></a><span id="l105.53">   folder = create_folder(&quot;DisplayNameA&quot;);</span>
<a href="#l105.54"></a><span id="l105.54"> </span>
<a href="#l105.55"></a><span id="l105.55">   for (let message of messages) {</span>
<a href="#l105.56"></a><span id="l105.56">     add_message_to_folder(</span>
<a href="#l105.57"></a><span id="l105.57">       folder,</span>
<a href="#l105.58"></a><span id="l105.58">       create_message({</span>
<a href="#l105.59"></a><span id="l105.59">         clobberHeaders: message.headers,</span>
<a href="#l105.60"></a><span id="l105.60">       })</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l106.1"></a><span id="l106.1">deleted file mode 100644</span>
<a href="#l106.2"></a><span id="l106.2" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-displaying-messages-in-folder-tabs.js</span>
<a href="#l106.3"></a><span id="l106.3" class="difflineplus">+++ /dev/null</span>
<a href="#l106.4"></a><span id="l106.4" class="difflineat">@@ -1,400 +0,0 @@</span>
<a href="#l106.5"></a><span id="l106.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l106.6"></a><span id="l106.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l106.7"></a><span id="l106.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l106.8"></a><span id="l106.8" class="difflineminus">-</span>
<a href="#l106.9"></a><span id="l106.9" class="difflineminus">-/*</span>
<a href="#l106.10"></a><span id="l106.10" class="difflineminus">- * Test displaying messages in folder tabs. This is supposed to test a variety</span>
<a href="#l106.11"></a><span id="l106.11" class="difflineminus">- * of situations, including:</span>
<a href="#l106.12"></a><span id="l106.12" class="difflineminus">- * - dropping view filters to select the message</span>
<a href="#l106.13"></a><span id="l106.13" class="difflineminus">- * - displaying the message in an existing folder tab</span>
<a href="#l106.14"></a><span id="l106.14" class="difflineminus">- */</span>
<a href="#l106.15"></a><span id="l106.15" class="difflineminus">-</span>
<a href="#l106.16"></a><span id="l106.16" class="difflineminus">-&quot;use strict&quot;;</span>
<a href="#l106.17"></a><span id="l106.17" class="difflineminus">-</span>
<a href="#l106.18"></a><span id="l106.18" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l106.19"></a><span id="l106.19" class="difflineminus">-/* import-globals-from ../shared-modules/test-search-window-helpers.js */</span>
<a href="#l106.20"></a><span id="l106.20" class="difflineminus">-</span>
<a href="#l106.21"></a><span id="l106.21" class="difflineminus">-var MODULE_NAME = &quot;test-displaying-messages-in-folder-tabs&quot;;</span>
<a href="#l106.22"></a><span id="l106.22" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l106.23"></a><span id="l106.23" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;search-window-helpers&quot;];</span>
<a href="#l106.24"></a><span id="l106.24" class="difflineminus">-</span>
<a href="#l106.25"></a><span id="l106.25" class="difflineminus">-var { plan_for_window_close, wait_for_window_close } = ChromeUtils.import(</span>
<a href="#l106.26"></a><span id="l106.26" class="difflineminus">-  &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l106.27"></a><span id="l106.27" class="difflineminus">-);</span>
<a href="#l106.28"></a><span id="l106.28" class="difflineminus">-</span>
<a href="#l106.29"></a><span id="l106.29" class="difflineminus">-var folderA;</span>
<a href="#l106.30"></a><span id="l106.30" class="difflineminus">-var folderB;</span>
<a href="#l106.31"></a><span id="l106.31" class="difflineminus">-var folderC;</span>
<a href="#l106.32"></a><span id="l106.32" class="difflineminus">-</span>
<a href="#l106.33"></a><span id="l106.33" class="difflineminus">-var folderTab;</span>
<a href="#l106.34"></a><span id="l106.34" class="difflineminus">-</span>
<a href="#l106.35"></a><span id="l106.35" class="difflineminus">-var msgHdrsInFolderA = [],</span>
<a href="#l106.36"></a><span id="l106.36" class="difflineminus">-  msgHdrsInFolderB = [];</span>
<a href="#l106.37"></a><span id="l106.37" class="difflineminus">-</span>
<a href="#l106.38"></a><span id="l106.38" class="difflineminus">-// The number of messages in folderA/folderB.</span>
<a href="#l106.39"></a><span id="l106.39" class="difflineminus">-var NUM_MESSAGES_IN_FOLDER = 10;</span>
<a href="#l106.40"></a><span id="l106.40" class="difflineminus">-</span>
<a href="#l106.41"></a><span id="l106.41" class="difflineminus">-// A generator for indexes to load test.</span>
<a href="#l106.42"></a><span id="l106.42" class="difflineminus">-function* _generateIndexes() {</span>
<a href="#l106.43"></a><span id="l106.43" class="difflineminus">-  let index = 0;</span>
<a href="#l106.44"></a><span id="l106.44" class="difflineminus">-  while (true) {</span>
<a href="#l106.45"></a><span id="l106.45" class="difflineminus">-    yield index;</span>
<a href="#l106.46"></a><span id="l106.46" class="difflineminus">-    index = (index + 1) % NUM_MESSAGES_IN_FOLDER;</span>
<a href="#l106.47"></a><span id="l106.47" class="difflineminus">-  }</span>
<a href="#l106.48"></a><span id="l106.48" class="difflineminus">-}</span>
<a href="#l106.49"></a><span id="l106.49" class="difflineminus">-var indexes = _generateIndexes();</span>
<a href="#l106.50"></a><span id="l106.50" class="difflineminus">-</span>
<a href="#l106.51"></a><span id="l106.51" class="difflineminus">-function setupModule(module) {</span>
<a href="#l106.52"></a><span id="l106.52" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l106.53"></a><span id="l106.53" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l106.54"></a><span id="l106.54" class="difflineminus">-  let sh = collector.getModule(&quot;search-window-helpers&quot;);</span>
<a href="#l106.55"></a><span id="l106.55" class="difflineminus">-  sh.installInto(module);</span>
<a href="#l106.56"></a><span id="l106.56" class="difflineminus">-</span>
<a href="#l106.57"></a><span id="l106.57" class="difflineminus">-  folderA = create_folder(&quot;DisplayMessageFolderTabA&quot;);</span>
<a href="#l106.58"></a><span id="l106.58" class="difflineminus">-  folderB = create_folder(&quot;DisplayMessageFolderTabB&quot;);</span>
<a href="#l106.59"></a><span id="l106.59" class="difflineminus">-  folderC = create_folder(&quot;DisplayMessageFolderTabC&quot;);</span>
<a href="#l106.60"></a><span id="l106.60" class="difflineminus">-  make_new_sets_in_folder(folderA, [{ count: NUM_MESSAGES_IN_FOLDER }]);</span>
<a href="#l106.61"></a><span id="l106.61" class="difflineminus">-  let [, taggedMsg] = make_new_sets_in_folder(folderB, [</span>
<a href="#l106.62"></a><span id="l106.62" class="difflineminus">-    { count: NUM_MESSAGES_IN_FOLDER - 1 },</span>
<a href="#l106.63"></a><span id="l106.63" class="difflineminus">-    { count: 1 },</span>
<a href="#l106.64"></a><span id="l106.64" class="difflineminus">-  ]);</span>
<a href="#l106.65"></a><span id="l106.65" class="difflineminus">-  taggedMsg.addTag(&quot;$label3&quot;);</span>
<a href="#l106.66"></a><span id="l106.66" class="difflineminus">-  make_new_sets_in_folder(folderC, [{ count: 50 }]);</span>
<a href="#l106.67"></a><span id="l106.67" class="difflineminus">-}</span>
<a href="#l106.68"></a><span id="l106.68" class="difflineminus">-</span>
<a href="#l106.69"></a><span id="l106.69" class="difflineminus">-/**</span>
<a href="#l106.70"></a><span id="l106.70" class="difflineminus">- * Helper to test that a new 3-pane window is opened, a message is displayed,</span>
<a href="#l106.71"></a><span id="l106.71" class="difflineminus">- * and that the message is visible in the thread pane, even if there are no</span>
<a href="#l106.72"></a><span id="l106.72" class="difflineminus">- * 3-pane windows open.</span>
<a href="#l106.73"></a><span id="l106.73" class="difflineminus">- *</span>
<a href="#l106.74"></a><span id="l106.74" class="difflineminus">- * This test is done right at the beginning so that the globals set up right</span>
<a href="#l106.75"></a><span id="l106.75" class="difflineminus">- * after that are valid for all the other tests.</span>
<a href="#l106.76"></a><span id="l106.76" class="difflineminus">- */</span>
<a href="#l106.77"></a><span id="l106.77" class="difflineminus">-function test_display_message_with_no_3pane_windows_open() {</span>
<a href="#l106.78"></a><span id="l106.78" class="difflineminus">-  be_in_folder(folderC);</span>
<a href="#l106.79"></a><span id="l106.79" class="difflineminus">-  // Scroll to the top</span>
<a href="#l106.80"></a><span id="l106.80" class="difflineminus">-  mc.folderDisplay.ensureRowIsVisible(0);</span>
<a href="#l106.81"></a><span id="l106.81" class="difflineminus">-  let msgHdr = mc.dbView.getMsgHdrAt(45);</span>
<a href="#l106.82"></a><span id="l106.82" class="difflineminus">-</span>
<a href="#l106.83"></a><span id="l106.83" class="difflineminus">-  // Switch to a different folder, just to exercise that code</span>
<a href="#l106.84"></a><span id="l106.84" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.85"></a><span id="l106.85" class="difflineminus">-</span>
<a href="#l106.86"></a><span id="l106.86" class="difflineminus">-  // Make sure we have a different window open, so that we don't start shutting</span>
<a href="#l106.87"></a><span id="l106.87" class="difflineminus">-  // down just because the last window was closed.</span>
<a href="#l106.88"></a><span id="l106.88" class="difflineminus">-  let swc = open_search_window();</span>
<a href="#l106.89"></a><span id="l106.89" class="difflineminus">-</span>
<a href="#l106.90"></a><span id="l106.90" class="difflineminus">-  plan_for_window_close(mc);</span>
<a href="#l106.91"></a><span id="l106.91" class="difflineminus">-  mc.window.close();</span>
<a href="#l106.92"></a><span id="l106.92" class="difflineminus">-  wait_for_window_close();</span>
<a href="#l106.93"></a><span id="l106.93" class="difflineminus">-</span>
<a href="#l106.94"></a><span id="l106.94" class="difflineminus">-  display_message_in_folder_tab(msgHdr, true);</span>
<a href="#l106.95"></a><span id="l106.95" class="difflineminus">-</span>
<a href="#l106.96"></a><span id="l106.96" class="difflineminus">-  // We don't need the search window any more</span>
<a href="#l106.97"></a><span id="l106.97" class="difflineminus">-  plan_for_window_close(swc);</span>
<a href="#l106.98"></a><span id="l106.98" class="difflineminus">-  swc.window.close();</span>
<a href="#l106.99"></a><span id="l106.99" class="difflineminus">-  wait_for_window_close();</span>
<a href="#l106.100"></a><span id="l106.100" class="difflineminus">-</span>
<a href="#l106.101"></a><span id="l106.101" class="difflineminus">-  // Check that the right message is displayed</span>
<a href="#l106.102"></a><span id="l106.102" class="difflineminus">-  assert_number_of_tabs_open(1);</span>
<a href="#l106.103"></a><span id="l106.103" class="difflineminus">-  assert_folder_selected_and_displayed(folderC);</span>
<a href="#l106.104"></a><span id="l106.104" class="difflineminus">-  assert_selected_and_displayed(msgHdr);</span>
<a href="#l106.105"></a><span id="l106.105" class="difflineminus">-  // Check that row 45 is visible</span>
<a href="#l106.106"></a><span id="l106.106" class="difflineminus">-  assert_row_visible(45);</span>
<a href="#l106.107"></a><span id="l106.107" class="difflineminus">-}</span>
<a href="#l106.108"></a><span id="l106.108" class="difflineminus">-</span>
<a href="#l106.109"></a><span id="l106.109" class="difflineminus">-/**</span>
<a href="#l106.110"></a><span id="l106.110" class="difflineminus">- * Initialize the globals we'll need for all our tests.</span>
<a href="#l106.111"></a><span id="l106.111" class="difflineminus">- */</span>
<a href="#l106.112"></a><span id="l106.112" class="difflineminus">-function test_setup_displaying_messages_in_folder_tabs_globals() {</span>
<a href="#l106.113"></a><span id="l106.113" class="difflineminus">-  // We don't obey mail view persistence unless the view picker is there.</span>
<a href="#l106.114"></a><span id="l106.114" class="difflineminus">-  // XXX We used to do this in setupModule, but window.close() seems to cause</span>
<a href="#l106.115"></a><span id="l106.115" class="difflineminus">-  // bad problems with the toolbar item's persistence. (This seems to be an</span>
<a href="#l106.116"></a><span id="l106.116" class="difflineminus">-  // issue only in tests.)</span>
<a href="#l106.117"></a><span id="l106.117" class="difflineminus">-  add_to_toolbar(mc.e(&quot;mail-bar3&quot;), &quot;mailviews-container&quot;);</span>
<a href="#l106.118"></a><span id="l106.118" class="difflineminus">-</span>
<a href="#l106.119"></a><span id="l106.119" class="difflineminus">-  folderTab = mc.tabmail.currentTabInfo;</span>
<a href="#l106.120"></a><span id="l106.120" class="difflineminus">-</span>
<a href="#l106.121"></a><span id="l106.121" class="difflineminus">-  // Stash messages into arrays for convenience. We do it this way so that the</span>
<a href="#l106.122"></a><span id="l106.122" class="difflineminus">-  // order of messages in the arrays is the same as in the views.</span>
<a href="#l106.123"></a><span id="l106.123" class="difflineminus">-  be_in_folder(folderA);</span>
<a href="#l106.124"></a><span id="l106.124" class="difflineminus">-  for (let i = 0; i &lt; NUM_MESSAGES_IN_FOLDER; i++) {</span>
<a href="#l106.125"></a><span id="l106.125" class="difflineminus">-    msgHdrsInFolderA.push(mc.dbView.getMsgHdrAt(i));</span>
<a href="#l106.126"></a><span id="l106.126" class="difflineminus">-  }</span>
<a href="#l106.127"></a><span id="l106.127" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.128"></a><span id="l106.128" class="difflineminus">-  for (let i = 0; i &lt; NUM_MESSAGES_IN_FOLDER; i++) {</span>
<a href="#l106.129"></a><span id="l106.129" class="difflineminus">-    msgHdrsInFolderB.push(mc.dbView.getMsgHdrAt(i));</span>
<a href="#l106.130"></a><span id="l106.130" class="difflineminus">-  }</span>
<a href="#l106.131"></a><span id="l106.131" class="difflineminus">-</span>
<a href="#l106.132"></a><span id="l106.132" class="difflineminus">-  // Mark all messages read -- we need this for some tests</span>
<a href="#l106.133"></a><span id="l106.133" class="difflineminus">-  folderA.markAllMessagesRead(null);</span>
<a href="#l106.134"></a><span id="l106.134" class="difflineminus">-  folderB.markAllMessagesRead(null);</span>
<a href="#l106.135"></a><span id="l106.135" class="difflineminus">-}</span>
<a href="#l106.136"></a><span id="l106.136" class="difflineminus">-</span>
<a href="#l106.137"></a><span id="l106.137" class="difflineminus">-/**</span>
<a href="#l106.138"></a><span id="l106.138" class="difflineminus">- * Verifies that no new tab was opened, and that the right folder and message</span>
<a href="#l106.139"></a><span id="l106.139" class="difflineminus">- * were selected in the same tab.</span>
<a href="#l106.140"></a><span id="l106.140" class="difflineminus">- */</span>
<a href="#l106.141"></a><span id="l106.141" class="difflineminus">-function _verify_display_in_existing_tab(aPreCount, aFolder, aMsgHdr) {</span>
<a href="#l106.142"></a><span id="l106.142" class="difflineminus">-  // Verify that a new tab has not been opened</span>
<a href="#l106.143"></a><span id="l106.143" class="difflineminus">-  assert_number_of_tabs_open(aPreCount);</span>
<a href="#l106.144"></a><span id="l106.144" class="difflineminus">-  // Verify that the current tab is the folder tab</span>
<a href="#l106.145"></a><span id="l106.145" class="difflineminus">-  assert_selected_tab(folderTab);</span>
<a href="#l106.146"></a><span id="l106.146" class="difflineminus">-  // Verify that the correct folder is selected</span>
<a href="#l106.147"></a><span id="l106.147" class="difflineminus">-  assert_folder_selected_and_displayed(aFolder);</span>
<a href="#l106.148"></a><span id="l106.148" class="difflineminus">-  // Verify that the correct message is displayed</span>
<a href="#l106.149"></a><span id="l106.149" class="difflineminus">-  assert_selected_and_displayed(aMsgHdr);</span>
<a href="#l106.150"></a><span id="l106.150" class="difflineminus">-}</span>
<a href="#l106.151"></a><span id="l106.151" class="difflineminus">-</span>
<a href="#l106.152"></a><span id="l106.152" class="difflineminus">-/**</span>
<a href="#l106.153"></a><span id="l106.153" class="difflineminus">- * Test displaying a message with the same folder already open.</span>
<a href="#l106.154"></a><span id="l106.154" class="difflineminus">- */</span>
<a href="#l106.155"></a><span id="l106.155" class="difflineminus">-function test_display_message_in_same_folder() {</span>
<a href="#l106.156"></a><span id="l106.156" class="difflineminus">-  be_in_folder(folderA);</span>
<a href="#l106.157"></a><span id="l106.157" class="difflineminus">-  let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l106.158"></a><span id="l106.158" class="difflineminus">-</span>
<a href="#l106.159"></a><span id="l106.159" class="difflineminus">-  let msgHdr = msgHdrsInFolderA[indexes.next().value];</span>
<a href="#l106.160"></a><span id="l106.160" class="difflineminus">-</span>
<a href="#l106.161"></a><span id="l106.161" class="difflineminus">-  display_message_in_folder_tab(msgHdr);</span>
<a href="#l106.162"></a><span id="l106.162" class="difflineminus">-  // Verify</span>
<a href="#l106.163"></a><span id="l106.163" class="difflineminus">-  _verify_display_in_existing_tab(preCount, folderA, msgHdr);</span>
<a href="#l106.164"></a><span id="l106.164" class="difflineminus">-}</span>
<a href="#l106.165"></a><span id="l106.165" class="difflineminus">-</span>
<a href="#l106.166"></a><span id="l106.166" class="difflineminus">-/**</span>
<a href="#l106.167"></a><span id="l106.167" class="difflineminus">- * Test displaying a message with a different folder open.</span>
<a href="#l106.168"></a><span id="l106.168" class="difflineminus">- */</span>
<a href="#l106.169"></a><span id="l106.169" class="difflineminus">-function test_display_message_in_different_folder() {</span>
<a href="#l106.170"></a><span id="l106.170" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.171"></a><span id="l106.171" class="difflineminus">-  let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l106.172"></a><span id="l106.172" class="difflineminus">-</span>
<a href="#l106.173"></a><span id="l106.173" class="difflineminus">-  let msgHdr = msgHdrsInFolderA[indexes.next().value];</span>
<a href="#l106.174"></a><span id="l106.174" class="difflineminus">-</span>
<a href="#l106.175"></a><span id="l106.175" class="difflineminus">-  display_message_in_folder_tab(msgHdr);</span>
<a href="#l106.176"></a><span id="l106.176" class="difflineminus">-  // Verify</span>
<a href="#l106.177"></a><span id="l106.177" class="difflineminus">-  _verify_display_in_existing_tab(preCount, folderA, msgHdr);</span>
<a href="#l106.178"></a><span id="l106.178" class="difflineminus">-}</span>
<a href="#l106.179"></a><span id="l106.179" class="difflineminus">-</span>
<a href="#l106.180"></a><span id="l106.180" class="difflineminus">-/**</span>
<a href="#l106.181"></a><span id="l106.181" class="difflineminus">- * Test displaying a message with a message tab active.</span>
<a href="#l106.182"></a><span id="l106.182" class="difflineminus">- */</span>
<a href="#l106.183"></a><span id="l106.183" class="difflineminus">-function test_display_message_in_same_folder_with_message_tab_active() {</span>
<a href="#l106.184"></a><span id="l106.184" class="difflineminus">-  be_in_folder(folderA);</span>
<a href="#l106.185"></a><span id="l106.185" class="difflineminus">-</span>
<a href="#l106.186"></a><span id="l106.186" class="difflineminus">-  let indexToOpen = indexes.next().value;</span>
<a href="#l106.187"></a><span id="l106.187" class="difflineminus">-  select_click_row(indexToOpen);</span>
<a href="#l106.188"></a><span id="l106.188" class="difflineminus">-  let messageTab = open_selected_message_in_new_tab(false);</span>
<a href="#l106.189"></a><span id="l106.189" class="difflineminus">-</span>
<a href="#l106.190"></a><span id="l106.190" class="difflineminus">-  let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l106.191"></a><span id="l106.191" class="difflineminus">-  let msgHdr = msgHdrsInFolderA[indexes.next().value];</span>
<a href="#l106.192"></a><span id="l106.192" class="difflineminus">-  display_message_in_folder_tab(msgHdr);</span>
<a href="#l106.193"></a><span id="l106.193" class="difflineminus">-  // Verify</span>
<a href="#l106.194"></a><span id="l106.194" class="difflineminus">-  _verify_display_in_existing_tab(preCount, folderA, msgHdr);</span>
<a href="#l106.195"></a><span id="l106.195" class="difflineminus">-</span>
<a href="#l106.196"></a><span id="l106.196" class="difflineminus">-  // Clean up, close the message tab</span>
<a href="#l106.197"></a><span id="l106.197" class="difflineminus">-  close_tab(messageTab);</span>
<a href="#l106.198"></a><span id="l106.198" class="difflineminus">-}</span>
<a href="#l106.199"></a><span id="l106.199" class="difflineminus">-</span>
<a href="#l106.200"></a><span id="l106.200" class="difflineminus">-/**</span>
<a href="#l106.201"></a><span id="l106.201" class="difflineminus">- * Test displaying a message with a different folder open and a message tab</span>
<a href="#l106.202"></a><span id="l106.202" class="difflineminus">- * active.</span>
<a href="#l106.203"></a><span id="l106.203" class="difflineminus">- */</span>
<a href="#l106.204"></a><span id="l106.204" class="difflineminus">-function test_display_message_in_different_folder_with_message_tab_active() {</span>
<a href="#l106.205"></a><span id="l106.205" class="difflineminus">-  be_in_folder(folderA);</span>
<a href="#l106.206"></a><span id="l106.206" class="difflineminus">-</span>
<a href="#l106.207"></a><span id="l106.207" class="difflineminus">-  let indexToOpen = indexes.next().value;</span>
<a href="#l106.208"></a><span id="l106.208" class="difflineminus">-  select_click_row(indexToOpen);</span>
<a href="#l106.209"></a><span id="l106.209" class="difflineminus">-  let messageTab = open_selected_message_in_new_tab(false);</span>
<a href="#l106.210"></a><span id="l106.210" class="difflineminus">-</span>
<a href="#l106.211"></a><span id="l106.211" class="difflineminus">-  let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l106.212"></a><span id="l106.212" class="difflineminus">-  let msgHdr = msgHdrsInFolderB[indexes.next().value];</span>
<a href="#l106.213"></a><span id="l106.213" class="difflineminus">-  display_message_in_folder_tab(msgHdr);</span>
<a href="#l106.214"></a><span id="l106.214" class="difflineminus">-  // Verify</span>
<a href="#l106.215"></a><span id="l106.215" class="difflineminus">-  _verify_display_in_existing_tab(preCount, folderB, msgHdr);</span>
<a href="#l106.216"></a><span id="l106.216" class="difflineminus">-</span>
<a href="#l106.217"></a><span id="l106.217" class="difflineminus">-  // Clean up, close the message tab</span>
<a href="#l106.218"></a><span id="l106.218" class="difflineminus">-  close_tab(messageTab);</span>
<a href="#l106.219"></a><span id="l106.219" class="difflineminus">-}</span>
<a href="#l106.220"></a><span id="l106.220" class="difflineminus">-</span>
<a href="#l106.221"></a><span id="l106.221" class="difflineminus">-/**</span>
<a href="#l106.222"></a><span id="l106.222" class="difflineminus">- * Test displaying a message with the same folder open but filtered.</span>
<a href="#l106.223"></a><span id="l106.223" class="difflineminus">- */</span>
<a href="#l106.224"></a><span id="l106.224" class="difflineminus">-function test_display_message_in_same_folder_filtered() {</span>
<a href="#l106.225"></a><span id="l106.225" class="difflineminus">-  be_in_folder(folderA);</span>
<a href="#l106.226"></a><span id="l106.226" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemTags, &quot;$label1&quot;);</span>
<a href="#l106.227"></a><span id="l106.227" class="difflineminus">-  // Make sure all the messages have actually disappeared</span>
<a href="#l106.228"></a><span id="l106.228" class="difflineminus">-  assert_messages_not_in_view(msgHdrsInFolderA);</span>
<a href="#l106.229"></a><span id="l106.229" class="difflineminus">-</span>
<a href="#l106.230"></a><span id="l106.230" class="difflineminus">-  let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l106.231"></a><span id="l106.231" class="difflineminus">-  let msgHdr = msgHdrsInFolderA[indexes.next().value];</span>
<a href="#l106.232"></a><span id="l106.232" class="difflineminus">-  display_message_in_folder_tab(msgHdr);</span>
<a href="#l106.233"></a><span id="l106.233" class="difflineminus">-  // Verify</span>
<a href="#l106.234"></a><span id="l106.234" class="difflineminus">-  _verify_display_in_existing_tab(preCount, folderA, msgHdr);</span>
<a href="#l106.235"></a><span id="l106.235" class="difflineminus">-</span>
<a href="#l106.236"></a><span id="l106.236" class="difflineminus">-  // Reset the mail view</span>
<a href="#l106.237"></a><span id="l106.237" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemAll, null);</span>
<a href="#l106.238"></a><span id="l106.238" class="difflineminus">-}</span>
<a href="#l106.239"></a><span id="l106.239" class="difflineminus">-</span>
<a href="#l106.240"></a><span id="l106.240" class="difflineminus">-/**</span>
<a href="#l106.241"></a><span id="l106.241" class="difflineminus">- * Test displaying a message with the folder filtered, and another folder open.</span>
<a href="#l106.242"></a><span id="l106.242" class="difflineminus">- */</span>
<a href="#l106.243"></a><span id="l106.243" class="difflineminus">-function test_display_message_in_different_folder_filtered() {</span>
<a href="#l106.244"></a><span id="l106.244" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.245"></a><span id="l106.245" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemTags, &quot;$label1&quot;);</span>
<a href="#l106.246"></a><span id="l106.246" class="difflineminus">-  // Make sure all the messages have actually disappeared</span>
<a href="#l106.247"></a><span id="l106.247" class="difflineminus">-  assert_messages_not_in_view(msgHdrsInFolderB);</span>
<a href="#l106.248"></a><span id="l106.248" class="difflineminus">-</span>
<a href="#l106.249"></a><span id="l106.249" class="difflineminus">-  // Do the same for folder A</span>
<a href="#l106.250"></a><span id="l106.250" class="difflineminus">-  be_in_folder(folderA);</span>
<a href="#l106.251"></a><span id="l106.251" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemTags, &quot;$label2&quot;);</span>
<a href="#l106.252"></a><span id="l106.252" class="difflineminus">-  assert_messages_not_in_view(msgHdrsInFolderA);</span>
<a href="#l106.253"></a><span id="l106.253" class="difflineminus">-</span>
<a href="#l106.254"></a><span id="l106.254" class="difflineminus">-  let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l106.255"></a><span id="l106.255" class="difflineminus">-  let msgHdr = msgHdrsInFolderB[indexes.next().value];</span>
<a href="#l106.256"></a><span id="l106.256" class="difflineminus">-  display_message_in_folder_tab(msgHdr);</span>
<a href="#l106.257"></a><span id="l106.257" class="difflineminus">-  // Verify</span>
<a href="#l106.258"></a><span id="l106.258" class="difflineminus">-  _verify_display_in_existing_tab(preCount, folderB, msgHdr);</span>
<a href="#l106.259"></a><span id="l106.259" class="difflineminus">-  // Reset folder B's state</span>
<a href="#l106.260"></a><span id="l106.260" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.261"></a><span id="l106.261" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemAll, null);</span>
<a href="#l106.262"></a><span id="l106.262" class="difflineminus">-</span>
<a href="#l106.263"></a><span id="l106.263" class="difflineminus">-  // Now get back to folder A, and check that its state hasn't changed</span>
<a href="#l106.264"></a><span id="l106.264" class="difflineminus">-  be_in_folder(folderA);</span>
<a href="#l106.265"></a><span id="l106.265" class="difflineminus">-  assert_mail_view(MailViewConstants.kViewItemTags, &quot;$label2&quot;);</span>
<a href="#l106.266"></a><span id="l106.266" class="difflineminus">-  // Reset folder A's state</span>
<a href="#l106.267"></a><span id="l106.267" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemAll, null);</span>
<a href="#l106.268"></a><span id="l106.268" class="difflineminus">-}</span>
<a href="#l106.269"></a><span id="l106.269" class="difflineminus">-</span>
<a href="#l106.270"></a><span id="l106.270" class="difflineminus">-/**</span>
<a href="#l106.271"></a><span id="l106.271" class="difflineminus">- * Test displaying a message with the folder filtered and a message tab active.</span>
<a href="#l106.272"></a><span id="l106.272" class="difflineminus">- */</span>
<a href="#l106.273"></a><span id="l106.273" class="difflineminus">-function test_display_message_in_same_folder_filtered_with_message_tab_active() {</span>
<a href="#l106.274"></a><span id="l106.274" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.275"></a><span id="l106.275" class="difflineminus">-</span>
<a href="#l106.276"></a><span id="l106.276" class="difflineminus">-  let indexToOpen = indexes.next().value;</span>
<a href="#l106.277"></a><span id="l106.277" class="difflineminus">-  select_click_row(indexToOpen);</span>
<a href="#l106.278"></a><span id="l106.278" class="difflineminus">-  let messageTab = open_selected_message_in_new_tab(false);</span>
<a href="#l106.279"></a><span id="l106.279" class="difflineminus">-</span>
<a href="#l106.280"></a><span id="l106.280" class="difflineminus">-  switch_tab(folderTab);</span>
<a href="#l106.281"></a><span id="l106.281" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemTags, &quot;$label1&quot;);</span>
<a href="#l106.282"></a><span id="l106.282" class="difflineminus">-  // Make sure all the messages have actually disappeared</span>
<a href="#l106.283"></a><span id="l106.283" class="difflineminus">-  assert_messages_not_in_view(msgHdrsInFolderB);</span>
<a href="#l106.284"></a><span id="l106.284" class="difflineminus">-  switch_tab(messageTab);</span>
<a href="#l106.285"></a><span id="l106.285" class="difflineminus">-</span>
<a href="#l106.286"></a><span id="l106.286" class="difflineminus">-  let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l106.287"></a><span id="l106.287" class="difflineminus">-  let msgHdr = msgHdrsInFolderB[indexes.next().value];</span>
<a href="#l106.288"></a><span id="l106.288" class="difflineminus">-  display_message_in_folder_tab(msgHdr);</span>
<a href="#l106.289"></a><span id="l106.289" class="difflineminus">-  // Verify</span>
<a href="#l106.290"></a><span id="l106.290" class="difflineminus">-  _verify_display_in_existing_tab(preCount, folderB, msgHdr);</span>
<a href="#l106.291"></a><span id="l106.291" class="difflineminus">-</span>
<a href="#l106.292"></a><span id="l106.292" class="difflineminus">-  // Clean up, close the message tab and reset the mail view</span>
<a href="#l106.293"></a><span id="l106.293" class="difflineminus">-  close_tab(messageTab);</span>
<a href="#l106.294"></a><span id="l106.294" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemAll, null);</span>
<a href="#l106.295"></a><span id="l106.295" class="difflineminus">-}</span>
<a href="#l106.296"></a><span id="l106.296" class="difflineminus">-</span>
<a href="#l106.297"></a><span id="l106.297" class="difflineminus">-/**</span>
<a href="#l106.298"></a><span id="l106.298" class="difflineminus">- * Test displaying a message with the folder filtered, a different folder open,</span>
<a href="#l106.299"></a><span id="l106.299" class="difflineminus">- * and a message tab active.</span>
<a href="#l106.300"></a><span id="l106.300" class="difflineminus">- */</span>
<a href="#l106.301"></a><span id="l106.301" class="difflineminus">-function test_display_message_in_different_folder_filtered_with_message_tab_active() {</span>
<a href="#l106.302"></a><span id="l106.302" class="difflineminus">-  be_in_folder(folderA);</span>
<a href="#l106.303"></a><span id="l106.303" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemTags, &quot;$label1&quot;);</span>
<a href="#l106.304"></a><span id="l106.304" class="difflineminus">-  // Make sure all the messages have actually disappeared</span>
<a href="#l106.305"></a><span id="l106.305" class="difflineminus">-  assert_messages_not_in_view(msgHdrsInFolderA);</span>
<a href="#l106.306"></a><span id="l106.306" class="difflineminus">-</span>
<a href="#l106.307"></a><span id="l106.307" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.308"></a><span id="l106.308" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemTags, &quot;$label3&quot;);</span>
<a href="#l106.309"></a><span id="l106.309" class="difflineminus">-  // There should be one message in here</span>
<a href="#l106.310"></a><span id="l106.310" class="difflineminus">-  select_click_row(0);</span>
<a href="#l106.311"></a><span id="l106.311" class="difflineminus">-  let messageTab = open_selected_message_in_new_tab(false);</span>
<a href="#l106.312"></a><span id="l106.312" class="difflineminus">-</span>
<a href="#l106.313"></a><span id="l106.313" class="difflineminus">-  let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l106.314"></a><span id="l106.314" class="difflineminus">-  let msgHdr = msgHdrsInFolderA[indexes.next().value];</span>
<a href="#l106.315"></a><span id="l106.315" class="difflineminus">-  display_message_in_folder_tab(msgHdr);</span>
<a href="#l106.316"></a><span id="l106.316" class="difflineminus">-  // Verify</span>
<a href="#l106.317"></a><span id="l106.317" class="difflineminus">-  _verify_display_in_existing_tab(preCount, folderA, msgHdr);</span>
<a href="#l106.318"></a><span id="l106.318" class="difflineminus">-  // Close the message tab</span>
<a href="#l106.319"></a><span id="l106.319" class="difflineminus">-  close_tab(messageTab);</span>
<a href="#l106.320"></a><span id="l106.320" class="difflineminus">-  // Reset folder A's state</span>
<a href="#l106.321"></a><span id="l106.321" class="difflineminus">-  be_in_folder(folderA);</span>
<a href="#l106.322"></a><span id="l106.322" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemAll, null);</span>
<a href="#l106.323"></a><span id="l106.323" class="difflineminus">-</span>
<a href="#l106.324"></a><span id="l106.324" class="difflineminus">-  // Now get back to folder B, and check that its state hasn't changed</span>
<a href="#l106.325"></a><span id="l106.325" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.326"></a><span id="l106.326" class="difflineminus">-  assert_mail_view(MailViewConstants.kViewItemTags, &quot;$label3&quot;);</span>
<a href="#l106.327"></a><span id="l106.327" class="difflineminus">-  // Reset folder B's state</span>
<a href="#l106.328"></a><span id="l106.328" class="difflineminus">-  set_mail_view(MailViewConstants.kViewItemAll, null);</span>
<a href="#l106.329"></a><span id="l106.329" class="difflineminus">-}</span>
<a href="#l106.330"></a><span id="l106.330" class="difflineminus">-</span>
<a href="#l106.331"></a><span id="l106.331" class="difflineminus">-/**</span>
<a href="#l106.332"></a><span id="l106.332" class="difflineminus">- * Test displaying a message with the folder set to show unread messages only.</span>
<a href="#l106.333"></a><span id="l106.333" class="difflineminus">- */</span>
<a href="#l106.334"></a><span id="l106.334" class="difflineminus">-function test_display_message_in_same_folder_unread() {</span>
<a href="#l106.335"></a><span id="l106.335" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.336"></a><span id="l106.336" class="difflineminus">-  set_show_unread_only(true);</span>
<a href="#l106.337"></a><span id="l106.337" class="difflineminus">-  // Make sure all the messages have actually disappeared</span>
<a href="#l106.338"></a><span id="l106.338" class="difflineminus">-  assert_messages_not_in_view(msgHdrsInFolderB);</span>
<a href="#l106.339"></a><span id="l106.339" class="difflineminus">-</span>
<a href="#l106.340"></a><span id="l106.340" class="difflineminus">-  let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l106.341"></a><span id="l106.341" class="difflineminus">-  let msgHdr = msgHdrsInFolderB[indexes.next().value];</span>
<a href="#l106.342"></a><span id="l106.342" class="difflineminus">-  display_message_in_folder_tab(msgHdr);</span>
<a href="#l106.343"></a><span id="l106.343" class="difflineminus">-  // Verify</span>
<a href="#l106.344"></a><span id="l106.344" class="difflineminus">-  _verify_display_in_existing_tab(preCount, folderB, msgHdr);</span>
<a href="#l106.345"></a><span id="l106.345" class="difflineminus">-  // Reset the state</span>
<a href="#l106.346"></a><span id="l106.346" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.347"></a><span id="l106.347" class="difflineminus">-  set_show_unread_only(false);</span>
<a href="#l106.348"></a><span id="l106.348" class="difflineminus">-}</span>
<a href="#l106.349"></a><span id="l106.349" class="difflineminus">-</span>
<a href="#l106.350"></a><span id="l106.350" class="difflineminus">-/**</span>
<a href="#l106.351"></a><span id="l106.351" class="difflineminus">- * Test displaying a message with the folder set to show unread messages only,</span>
<a href="#l106.352"></a><span id="l106.352" class="difflineminus">- * and a different folder open.</span>
<a href="#l106.353"></a><span id="l106.353" class="difflineminus">- */</span>
<a href="#l106.354"></a><span id="l106.354" class="difflineminus">-function test_display_message_in_different_folder_unread() {</span>
<a href="#l106.355"></a><span id="l106.355" class="difflineminus">-  be_in_folder(folderA);</span>
<a href="#l106.356"></a><span id="l106.356" class="difflineminus">-  set_show_unread_only(true);</span>
<a href="#l106.357"></a><span id="l106.357" class="difflineminus">-  // Make sure all the messages have actually disappeared</span>
<a href="#l106.358"></a><span id="l106.358" class="difflineminus">-  assert_messages_not_in_view(msgHdrsInFolderA);</span>
<a href="#l106.359"></a><span id="l106.359" class="difflineminus">-</span>
<a href="#l106.360"></a><span id="l106.360" class="difflineminus">-  // Do the same for folder B</span>
<a href="#l106.361"></a><span id="l106.361" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.362"></a><span id="l106.362" class="difflineminus">-  set_show_unread_only(true);</span>
<a href="#l106.363"></a><span id="l106.363" class="difflineminus">-  assert_messages_not_in_view(msgHdrsInFolderB);</span>
<a href="#l106.364"></a><span id="l106.364" class="difflineminus">-</span>
<a href="#l106.365"></a><span id="l106.365" class="difflineminus">-  let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l106.366"></a><span id="l106.366" class="difflineminus">-  let msgHdr = msgHdrsInFolderA[indexes.next().value];</span>
<a href="#l106.367"></a><span id="l106.367" class="difflineminus">-  display_message_in_folder_tab(msgHdr);</span>
<a href="#l106.368"></a><span id="l106.368" class="difflineminus">-  // Verify</span>
<a href="#l106.369"></a><span id="l106.369" class="difflineminus">-  _verify_display_in_existing_tab(preCount, folderA, msgHdr);</span>
<a href="#l106.370"></a><span id="l106.370" class="difflineminus">-  // Reset folder A's state</span>
<a href="#l106.371"></a><span id="l106.371" class="difflineminus">-  be_in_folder(folderA);</span>
<a href="#l106.372"></a><span id="l106.372" class="difflineminus">-  set_show_unread_only(false);</span>
<a href="#l106.373"></a><span id="l106.373" class="difflineminus">-</span>
<a href="#l106.374"></a><span id="l106.374" class="difflineminus">-  // Now get back to folder B, and check that its state hasn't changed</span>
<a href="#l106.375"></a><span id="l106.375" class="difflineminus">-  be_in_folder(folderB);</span>
<a href="#l106.376"></a><span id="l106.376" class="difflineminus">-  assert_showing_unread_only();</span>
<a href="#l106.377"></a><span id="l106.377" class="difflineminus">-  // Reset folder B's state</span>
<a href="#l106.378"></a><span id="l106.378" class="difflineminus">-  set_show_unread_only(false);</span>
<a href="#l106.379"></a><span id="l106.379" class="difflineminus">-}</span>
<a href="#l106.380"></a><span id="l106.380" class="difflineminus">-</span>
<a href="#l106.381"></a><span id="l106.381" class="difflineminus">-/**</span>
<a href="#l106.382"></a><span id="l106.382" class="difflineminus">- * Test that we correctly scroll to the index of the message in a folder.</span>
<a href="#l106.383"></a><span id="l106.383" class="difflineminus">- */</span>
<a href="#l106.384"></a><span id="l106.384" class="difflineminus">-function test_display_message_scrolls_to_message() {</span>
<a href="#l106.385"></a><span id="l106.385" class="difflineminus">-  be_in_folder(folderC);</span>
<a href="#l106.386"></a><span id="l106.386" class="difflineminus">-  // Scroll to the top</span>
<a href="#l106.387"></a><span id="l106.387" class="difflineminus">-  mc.folderDisplay.ensureRowIsVisible(0);</span>
<a href="#l106.388"></a><span id="l106.388" class="difflineminus">-</span>
<a href="#l106.389"></a><span id="l106.389" class="difflineminus">-  let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l106.390"></a><span id="l106.390" class="difflineminus">-  let msgHdr = mc.dbView.getMsgHdrAt(45);</span>
<a href="#l106.391"></a><span id="l106.391" class="difflineminus">-  display_message_in_folder_tab(msgHdr);</span>
<a href="#l106.392"></a><span id="l106.392" class="difflineminus">-</span>
<a href="#l106.393"></a><span id="l106.393" class="difflineminus">-  // Check that row 45 is visible</span>
<a href="#l106.394"></a><span id="l106.394" class="difflineminus">-  assert_row_visible(45);</span>
<a href="#l106.395"></a><span id="l106.395" class="difflineminus">-  // Verify the rest</span>
<a href="#l106.396"></a><span id="l106.396" class="difflineminus">-  _verify_display_in_existing_tab(preCount, folderC, msgHdr);</span>
<a href="#l106.397"></a><span id="l106.397" class="difflineminus">-}</span>
<a href="#l106.398"></a><span id="l106.398" class="difflineminus">-</span>
<a href="#l106.399"></a><span id="l106.399" class="difflineminus">-/**</span>
<a href="#l106.400"></a><span id="l106.400" class="difflineminus">- * Clean up and remove the view picker.</span>
<a href="#l106.401"></a><span id="l106.401" class="difflineminus">- */</span>
<a href="#l106.402"></a><span id="l106.402" class="difflineminus">-function test_cleanup() {</span>
<a href="#l106.403"></a><span id="l106.403" class="difflineminus">-  remove_from_toolbar(mc.e(&quot;mail-bar3&quot;), &quot;mailviews-container&quot;);</span>
<a href="#l106.404"></a><span id="l106.404" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l107.1"></a><span id="l107.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-folder-pane-visibility.js</span>
<a href="#l107.2"></a><span id="l107.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-folder-pane-visibility.js</span>
<a href="#l107.3"></a><span id="l107.3" class="difflineat">@@ -4,28 +4,33 @@</span>
<a href="#l107.4"></a><span id="l107.4"> </span>
<a href="#l107.5"></a><span id="l107.5"> /*</span>
<a href="#l107.6"></a><span id="l107.6">  * Test that the folder pane collapses properly, stays collapsed amongst tab</span>
<a href="#l107.7"></a><span id="l107.7">  * changes, and that persistence works (to a first approximation).</span>
<a href="#l107.8"></a><span id="l107.8">  */</span>
<a href="#l107.9"></a><span id="l107.9"> </span>
<a href="#l107.10"></a><span id="l107.10"> &quot;use strict&quot;;</span>
<a href="#l107.11"></a><span id="l107.11"> </span>
<a href="#l107.12"></a><span id="l107.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l107.13"></a><span id="l107.13" class="difflineminus">-</span>
<a href="#l107.14"></a><span id="l107.14" class="difflineminus">-var MODULE_NAME = &quot;test-folder-pane-visibility&quot;;</span>
<a href="#l107.15"></a><span id="l107.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l107.16"></a><span id="l107.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l107.17"></a><span id="l107.17" class="difflineplus">+var {</span>
<a href="#l107.18"></a><span id="l107.18" class="difflineplus">+  be_in_folder,</span>
<a href="#l107.19"></a><span id="l107.19" class="difflineplus">+  close_tab,</span>
<a href="#l107.20"></a><span id="l107.20" class="difflineplus">+  create_folder,</span>
<a href="#l107.21"></a><span id="l107.21" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l107.22"></a><span id="l107.22" class="difflineplus">+  mc,</span>
<a href="#l107.23"></a><span id="l107.23" class="difflineplus">+  open_folder_in_new_tab,</span>
<a href="#l107.24"></a><span id="l107.24" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l107.25"></a><span id="l107.25" class="difflineplus">+  select_click_row,</span>
<a href="#l107.26"></a><span id="l107.26" class="difflineplus">+  switch_tab,</span>
<a href="#l107.27"></a><span id="l107.27" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l107.28"></a><span id="l107.28" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l107.29"></a><span id="l107.29" class="difflineplus">+);</span>
<a href="#l107.30"></a><span id="l107.30"> </span>
<a href="#l107.31"></a><span id="l107.31"> var folder;</span>
<a href="#l107.32"></a><span id="l107.32"> </span>
<a href="#l107.33"></a><span id="l107.33"> function setupModule(module) {</span>
<a href="#l107.34"></a><span id="l107.34" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l107.35"></a><span id="l107.35" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l107.36"></a><span id="l107.36" class="difflineminus">-</span>
<a href="#l107.37"></a><span id="l107.37">   folder = create_folder(&quot;FolderPaneVisibility&quot;);</span>
<a href="#l107.38"></a><span id="l107.38">   make_new_sets_in_folder(folder, [{ count: 3 }]);</span>
<a href="#l107.39"></a><span id="l107.39"> }</span>
<a href="#l107.40"></a><span id="l107.40"> </span>
<a href="#l107.41"></a><span id="l107.41"> /**</span>
<a href="#l107.42"></a><span id="l107.42">  * When displaying a folder, assert that the folder pane is visible and all the</span>
<a href="#l107.43"></a><span id="l107.43">  * menus, splitters, etc. are set up right.</span>
<a href="#l107.44"></a><span id="l107.44">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l108.1"></a><span id="l108.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-folder-toolbar.js</span>
<a href="#l108.2"></a><span id="l108.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-folder-toolbar.js</span>
<a href="#l108.3"></a><span id="l108.3" class="difflineat">@@ -4,28 +4,39 @@</span>
<a href="#l108.4"></a><span id="l108.4"> </span>
<a href="#l108.5"></a><span id="l108.5"> /*</span>
<a href="#l108.6"></a><span id="l108.6">  * Test that opening new folder and message tabs has the expected result and</span>
<a href="#l108.7"></a><span id="l108.7">  *  that closing them doesn't break anything.</span>
<a href="#l108.8"></a><span id="l108.8">  */</span>
<a href="#l108.9"></a><span id="l108.9"> </span>
<a href="#l108.10"></a><span id="l108.10"> &quot;use strict&quot;;</span>
<a href="#l108.11"></a><span id="l108.11"> </span>
<a href="#l108.12"></a><span id="l108.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l108.13"></a><span id="l108.13" class="difflineminus">-</span>
<a href="#l108.14"></a><span id="l108.14" class="difflineminus">-var MODULE_NAME = &quot;test-folder-toolbar&quot;;</span>
<a href="#l108.15"></a><span id="l108.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l108.16"></a><span id="l108.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l108.17"></a><span id="l108.17" class="difflineplus">+var {</span>
<a href="#l108.18"></a><span id="l108.18" class="difflineplus">+  add_to_toolbar,</span>
<a href="#l108.19"></a><span id="l108.19" class="difflineplus">+  assert_equals,</span>
<a href="#l108.20"></a><span id="l108.20" class="difflineplus">+  assert_folder_selected_and_displayed,</span>
<a href="#l108.21"></a><span id="l108.21" class="difflineplus">+  assert_nothing_selected,</span>
<a href="#l108.22"></a><span id="l108.22" class="difflineplus">+  be_in_folder,</span>
<a href="#l108.23"></a><span id="l108.23" class="difflineplus">+  close_tab,</span>
<a href="#l108.24"></a><span id="l108.24" class="difflineplus">+  create_folder,</span>
<a href="#l108.25"></a><span id="l108.25" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l108.26"></a><span id="l108.26" class="difflineplus">+  mc,</span>
<a href="#l108.27"></a><span id="l108.27" class="difflineplus">+  open_folder_in_new_tab,</span>
<a href="#l108.28"></a><span id="l108.28" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l108.29"></a><span id="l108.29" class="difflineplus">+  remove_from_toolbar,</span>
<a href="#l108.30"></a><span id="l108.30" class="difflineplus">+  select_click_row,</span>
<a href="#l108.31"></a><span id="l108.31" class="difflineplus">+  switch_tab,</span>
<a href="#l108.32"></a><span id="l108.32" class="difflineplus">+  wait_for_blank_content_pane,</span>
<a href="#l108.33"></a><span id="l108.33" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l108.34"></a><span id="l108.34" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l108.35"></a><span id="l108.35" class="difflineplus">+);</span>
<a href="#l108.36"></a><span id="l108.36"> </span>
<a href="#l108.37"></a><span id="l108.37"> var folderA, folderB;</span>
<a href="#l108.38"></a><span id="l108.38"> </span>
<a href="#l108.39"></a><span id="l108.39"> function setupModule(module) {</span>
<a href="#l108.40"></a><span id="l108.40" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l108.41"></a><span id="l108.41" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l108.42"></a><span id="l108.42" class="difflineminus">-</span>
<a href="#l108.43"></a><span id="l108.43">   folderA = create_folder(&quot;FolderToolbarA&quot;);</span>
<a href="#l108.44"></a><span id="l108.44">   // we need one message to select and open</span>
<a href="#l108.45"></a><span id="l108.45">   folderB = create_folder(&quot;FolderToolbarB&quot;);</span>
<a href="#l108.46"></a><span id="l108.46">   make_new_sets_in_folder(folderB, [{ count: 1 }]);</span>
<a href="#l108.47"></a><span id="l108.47"> }</span>
<a href="#l108.48"></a><span id="l108.48"> </span>
<a href="#l108.49"></a><span id="l108.49"> function test_add_folder_toolbar() {</span>
<a href="#l108.50"></a><span id="l108.50">   // It should not be present by default</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l109.1"></a><span id="l109.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-invalid-db-folder-load.js</span>
<a href="#l109.2"></a><span id="l109.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-invalid-db-folder-load.js</span>
<a href="#l109.3"></a><span id="l109.3" class="difflineat">@@ -5,29 +5,32 @@</span>
<a href="#l109.4"></a><span id="l109.4"> /*</span>
<a href="#l109.5"></a><span id="l109.5">  * Test that clicking on a folder with an invalid or missing .msf file</span>
<a href="#l109.6"></a><span id="l109.6">  * regenerates the.msf file and loads the view.</span>
<a href="#l109.7"></a><span id="l109.7">  * Also, check that rebuilding the index on a loaded folder reloads the folder.</span>
<a href="#l109.8"></a><span id="l109.8">  */</span>
<a href="#l109.9"></a><span id="l109.9"> </span>
<a href="#l109.10"></a><span id="l109.10"> &quot;use strict&quot;;</span>
<a href="#l109.11"></a><span id="l109.11"> </span>
<a href="#l109.12"></a><span id="l109.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l109.13"></a><span id="l109.13" class="difflineminus">-</span>
<a href="#l109.14"></a><span id="l109.14" class="difflineminus">-var MODULE_NAME = &quot;test-invalid-db-folder-load&quot;;</span>
<a href="#l109.15"></a><span id="l109.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l109.16"></a><span id="l109.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l109.17"></a><span id="l109.17" class="difflineplus">+var {</span>
<a href="#l109.18"></a><span id="l109.18" class="difflineplus">+  assert_messages_in_view,</span>
<a href="#l109.19"></a><span id="l109.19" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l109.20"></a><span id="l109.20" class="difflineplus">+  be_in_folder,</span>
<a href="#l109.21"></a><span id="l109.21" class="difflineplus">+  create_folder,</span>
<a href="#l109.22"></a><span id="l109.22" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l109.23"></a><span id="l109.23" class="difflineplus">+  mc,</span>
<a href="#l109.24"></a><span id="l109.24" class="difflineplus">+  select_click_row,</span>
<a href="#l109.25"></a><span id="l109.25" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l109.26"></a><span id="l109.26" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l109.27"></a><span id="l109.27" class="difflineplus">+);</span>
<a href="#l109.28"></a><span id="l109.28"> </span>
<a href="#l109.29"></a><span id="l109.29"> var folder;</span>
<a href="#l109.30"></a><span id="l109.30"> var setA;</span>
<a href="#l109.31"></a><span id="l109.31"> </span>
<a href="#l109.32"></a><span id="l109.32"> function setupModule(module) {</span>
<a href="#l109.33"></a><span id="l109.33" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l109.34"></a><span id="l109.34" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l109.35"></a><span id="l109.35" class="difflineminus">-</span>
<a href="#l109.36"></a><span id="l109.36">   folder = create_folder(&quot;InvalidMSF&quot;);</span>
<a href="#l109.37"></a><span id="l109.37">   [setA] = make_new_sets_in_folder(folder, [{ count: 3 }]);</span>
<a href="#l109.38"></a><span id="l109.38"> }</span>
<a href="#l109.39"></a><span id="l109.39"> </span>
<a href="#l109.40"></a><span id="l109.40"> /**</span>
<a href="#l109.41"></a><span id="l109.41">  * Check if the db of a folder assumed to be invalid can be restored.</span>
<a href="#l109.42"></a><span id="l109.42">  */</span>
<a href="#l109.43"></a><span id="l109.43"> function test_load_folder_with_invalidDB() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l110.1"></a><span id="l110.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-mail-views.js</span>
<a href="#l110.2"></a><span id="l110.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-mail-views.js</span>
<a href="#l110.3"></a><span id="l110.3" class="difflineat">@@ -1,39 +1,40 @@</span>
<a href="#l110.4"></a><span id="l110.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l110.5"></a><span id="l110.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l110.6"></a><span id="l110.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l110.7"></a><span id="l110.7"> </span>
<a href="#l110.8"></a><span id="l110.8"> &quot;use strict&quot;;</span>
<a href="#l110.9"></a><span id="l110.9"> </span>
<a href="#l110.10"></a><span id="l110.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l110.11"></a><span id="l110.11" class="difflineminus">-</span>
<a href="#l110.12"></a><span id="l110.12" class="difflineminus">-var MODULE_NAME = &quot;test-mail-views&quot;;</span>
<a href="#l110.13"></a><span id="l110.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l110.14"></a><span id="l110.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l110.15"></a><span id="l110.15" class="difflineminus">-</span>
<a href="#l110.16"></a><span id="l110.16"> var elib = ChromeUtils.import(</span>
<a href="#l110.17"></a><span id="l110.17">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l110.18"></a><span id="l110.18"> );</span>
<a href="#l110.19"></a><span id="l110.19"> </span>
<a href="#l110.20"></a><span id="l110.20" class="difflineplus">+var {</span>
<a href="#l110.21"></a><span id="l110.21" class="difflineplus">+  assert_messages_in_view,</span>
<a href="#l110.22"></a><span id="l110.22" class="difflineplus">+  be_in_folder,</span>
<a href="#l110.23"></a><span id="l110.23" class="difflineplus">+  create_folder,</span>
<a href="#l110.24"></a><span id="l110.24" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l110.25"></a><span id="l110.25" class="difflineplus">+  mc,</span>
<a href="#l110.26"></a><span id="l110.26" class="difflineplus">+  wait_for_all_messages_to_load,</span>
<a href="#l110.27"></a><span id="l110.27" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l110.28"></a><span id="l110.28" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l110.29"></a><span id="l110.29" class="difflineplus">+);</span>
<a href="#l110.30"></a><span id="l110.30"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l110.31"></a><span id="l110.31">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l110.32"></a><span id="l110.32"> );</span>
<a href="#l110.33"></a><span id="l110.33"> </span>
<a href="#l110.34"></a><span id="l110.34"> var { MailViewConstants } = ChromeUtils.import(</span>
<a href="#l110.35"></a><span id="l110.35">   &quot;resource:///modules/MailViewManager.jsm&quot;</span>
<a href="#l110.36"></a><span id="l110.36"> );</span>
<a href="#l110.37"></a><span id="l110.37"> </span>
<a href="#l110.38"></a><span id="l110.38"> var baseFolder, savedFolder;</span>
<a href="#l110.39"></a><span id="l110.39"> var setUntagged, setTagged;</span>
<a href="#l110.40"></a><span id="l110.40"> </span>
<a href="#l110.41"></a><span id="l110.41"> var setupModule = function(module) {</span>
<a href="#l110.42"></a><span id="l110.42" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l110.43"></a><span id="l110.43" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l110.44"></a><span id="l110.44" class="difflineminus">-</span>
<a href="#l110.45"></a><span id="l110.45">   // Create a folder with some messages that have no tags and some that are</span>
<a href="#l110.46"></a><span id="l110.46">   //  tagged Important ($label1).</span>
<a href="#l110.47"></a><span id="l110.47">   baseFolder = create_folder(&quot;MailViewA&quot;);</span>
<a href="#l110.48"></a><span id="l110.48">   [setUntagged, setTagged] = make_new_sets_in_folder(baseFolder, [{}, {}]);</span>
<a href="#l110.49"></a><span id="l110.49">   setTagged.addTag(&quot;$label1&quot;); // Important, by default</span>
<a href="#l110.50"></a><span id="l110.50"> };</span>
<a href="#l110.51"></a><span id="l110.51"> </span>
<a href="#l110.52"></a><span id="l110.52"> function test_put_view_picker_on_toolbar() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l111.1"></a><span id="l111.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-message-commands-on-msgstore.js</span>
<a href="#l111.2"></a><span id="l111.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-message-commands-on-msgstore.js</span>
<a href="#l111.3"></a><span id="l111.3" class="difflineat">@@ -6,23 +6,36 @@</span>
<a href="#l111.4"></a><span id="l111.4">  * This tests some commands on messages via the UI. But we specifically check,</span>
<a href="#l111.5"></a><span id="l111.5">  * whether the commands have an effect in the message store on disk, i.e. the</span>
<a href="#l111.6"></a><span id="l111.6">  * markings on the messages are stored in the msgStore, not only in the database.</span>
<a href="#l111.7"></a><span id="l111.7">  * For now, it checks for bug 840418.</span>
<a href="#l111.8"></a><span id="l111.8">  */</span>
<a href="#l111.9"></a><span id="l111.9"> </span>
<a href="#l111.10"></a><span id="l111.10"> &quot;use strict&quot;;</span>
<a href="#l111.11"></a><span id="l111.11"> </span>
<a href="#l111.12"></a><span id="l111.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l111.13"></a><span id="l111.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l111.14"></a><span id="l111.14" class="difflineminus">-</span>
<a href="#l111.15"></a><span id="l111.15" class="difflineminus">-var MODULE_NAME = &quot;test-message-commands-on-msgstore&quot;;</span>
<a href="#l111.16"></a><span id="l111.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l111.17"></a><span id="l111.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l111.18"></a><span id="l111.18" class="difflineminus">-</span>
<a href="#l111.19"></a><span id="l111.19" class="difflineplus">+var { open_compose_with_forward, open_compose_with_reply } = ChromeUtils.import(</span>
<a href="#l111.20"></a><span id="l111.20" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l111.21"></a><span id="l111.21" class="difflineplus">+);</span>
<a href="#l111.22"></a><span id="l111.22" class="difflineplus">+var {</span>
<a href="#l111.23"></a><span id="l111.23" class="difflineplus">+  assert_equals,</span>
<a href="#l111.24"></a><span id="l111.24" class="difflineplus">+  assert_false,</span>
<a href="#l111.25"></a><span id="l111.25" class="difflineplus">+  assert_not_equals,</span>
<a href="#l111.26"></a><span id="l111.26" class="difflineplus">+  assert_true,</span>
<a href="#l111.27"></a><span id="l111.27" class="difflineplus">+  be_in_folder,</span>
<a href="#l111.28"></a><span id="l111.28" class="difflineplus">+  create_folder,</span>
<a href="#l111.29"></a><span id="l111.29" class="difflineplus">+  empty_folder,</span>
<a href="#l111.30"></a><span id="l111.30" class="difflineplus">+  get_special_folder,</span>
<a href="#l111.31"></a><span id="l111.31" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l111.32"></a><span id="l111.32" class="difflineplus">+  mc,</span>
<a href="#l111.33"></a><span id="l111.33" class="difflineplus">+  press_delete,</span>
<a href="#l111.34"></a><span id="l111.34" class="difflineplus">+  right_click_on_row,</span>
<a href="#l111.35"></a><span id="l111.35" class="difflineplus">+  select_click_row,</span>
<a href="#l111.36"></a><span id="l111.36" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l111.37"></a><span id="l111.37" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l111.38"></a><span id="l111.38" class="difflineplus">+);</span>
<a href="#l111.39"></a><span id="l111.39"> var { plan_for_window_close, wait_for_window_close } = ChromeUtils.import(</span>
<a href="#l111.40"></a><span id="l111.40">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l111.41"></a><span id="l111.41"> );</span>
<a href="#l111.42"></a><span id="l111.42"> </span>
<a href="#l111.43"></a><span id="l111.43"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l111.44"></a><span id="l111.44"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l111.45"></a><span id="l111.45">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l111.46"></a><span id="l111.46"> );</span>
<a href="#l111.47"></a><span id="l111.47" class="difflineat">@@ -30,20 +43,16 @@ var { IOUtils } = ChromeUtils.import(&quot;re</span>
<a href="#l111.48"></a><span id="l111.48"> </span>
<a href="#l111.49"></a><span id="l111.49"> var statusHeader = &quot;X-Mozilla-Status: &quot;;</span>
<a href="#l111.50"></a><span id="l111.50"> </span>
<a href="#l111.51"></a><span id="l111.51"> var gInbox;</span>
<a href="#l111.52"></a><span id="l111.52"> var gOutbox;</span>
<a href="#l111.53"></a><span id="l111.53"> var gAutoRead;</span>
<a href="#l111.54"></a><span id="l111.54"> </span>
<a href="#l111.55"></a><span id="l111.55"> function setupModule(module) {</span>
<a href="#l111.56"></a><span id="l111.56" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l111.57"></a><span id="l111.57" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l111.58"></a><span id="l111.58" class="difflineminus">-  }</span>
<a href="#l111.59"></a><span id="l111.59" class="difflineminus">-</span>
<a href="#l111.60"></a><span id="l111.60">   gAutoRead = Services.prefs.getBoolPref(&quot;mailnews.mark_message_read.auto&quot;);</span>
<a href="#l111.61"></a><span id="l111.61">   Services.prefs.setBoolPref(&quot;mailnews.mark_message_read.auto&quot;, false);</span>
<a href="#l111.62"></a><span id="l111.62"> </span>
<a href="#l111.63"></a><span id="l111.63">   gOutbox = get_special_folder(Ci.nsMsgFolderFlags.Queue);</span>
<a href="#l111.64"></a><span id="l111.64">   gInbox = create_folder(&quot;MsgStoreChecks&quot;);</span>
<a href="#l111.65"></a><span id="l111.65">   make_new_sets_in_folder(gInbox, [{ count: 6 }]);</span>
<a href="#l111.66"></a><span id="l111.66"> </span>
<a href="#l111.67"></a><span id="l111.67">   // We delete the first message so that we have to compact anything.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l112.1"></a><span id="l112.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-message-commands.js</span>
<a href="#l112.2"></a><span id="l112.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-message-commands.js</span>
<a href="#l112.3"></a><span id="l112.3" class="difflineat">@@ -5,43 +5,63 @@</span>
<a href="#l112.4"></a><span id="l112.4"> /**</span>
<a href="#l112.5"></a><span id="l112.5">  * This tests various commands on messages. This is primarily for commands</span>
<a href="#l112.6"></a><span id="l112.6">  * that can't be tested with xpcshell tests because they're handling in the</span>
<a href="#l112.7"></a><span id="l112.7">  * front end - which is why Archive is the only command currently tested.</span>
<a href="#l112.8"></a><span id="l112.8">  */</span>
<a href="#l112.9"></a><span id="l112.9"> </span>
<a href="#l112.10"></a><span id="l112.10"> &quot;use strict&quot;;</span>
<a href="#l112.11"></a><span id="l112.11"> </span>
<a href="#l112.12"></a><span id="l112.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l112.13"></a><span id="l112.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l112.14"></a><span id="l112.14" class="difflineminus">-</span>
<a href="#l112.15"></a><span id="l112.15" class="difflineminus">-var MODULE_NAME = &quot;test-message-commands&quot;;</span>
<a href="#l112.16"></a><span id="l112.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l112.17"></a><span id="l112.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;content-tab-helpers&quot;];</span>
<a href="#l112.18"></a><span id="l112.18" class="difflineminus">-</span>
<a href="#l112.19"></a><span id="l112.19" class="difflineplus">+var { wait_for_content_tab_load } = ChromeUtils.import(</span>
<a href="#l112.20"></a><span id="l112.20" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l112.21"></a><span id="l112.21" class="difflineplus">+);</span>
<a href="#l112.22"></a><span id="l112.22" class="difflineplus">+var {</span>
<a href="#l112.23"></a><span id="l112.23" class="difflineplus">+  add_sets_to_folders,</span>
<a href="#l112.24"></a><span id="l112.24" class="difflineplus">+  archive_selected_messages,</span>
<a href="#l112.25"></a><span id="l112.25" class="difflineplus">+  assert_equals,</span>
<a href="#l112.26"></a><span id="l112.26" class="difflineplus">+  assert_false,</span>
<a href="#l112.27"></a><span id="l112.27" class="difflineplus">+  assert_not_equals,</span>
<a href="#l112.28"></a><span id="l112.28" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l112.29"></a><span id="l112.29" class="difflineplus">+  assert_true,</span>
<a href="#l112.30"></a><span id="l112.30" class="difflineplus">+  be_in_folder,</span>
<a href="#l112.31"></a><span id="l112.31" class="difflineplus">+  close_popup,</span>
<a href="#l112.32"></a><span id="l112.32" class="difflineplus">+  collapse_all_threads,</span>
<a href="#l112.33"></a><span id="l112.33" class="difflineplus">+  create_folder,</span>
<a href="#l112.34"></a><span id="l112.34" class="difflineplus">+  create_thread,</span>
<a href="#l112.35"></a><span id="l112.35" class="difflineplus">+  make_display_threaded,</span>
<a href="#l112.36"></a><span id="l112.36" class="difflineplus">+  make_display_unthreaded,</span>
<a href="#l112.37"></a><span id="l112.37" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l112.38"></a><span id="l112.38" class="difflineplus">+  mc,</span>
<a href="#l112.39"></a><span id="l112.39" class="difflineplus">+  press_delete,</span>
<a href="#l112.40"></a><span id="l112.40" class="difflineplus">+  right_click_on_row,</span>
<a href="#l112.41"></a><span id="l112.41" class="difflineplus">+  select_click_row,</span>
<a href="#l112.42"></a><span id="l112.42" class="difflineplus">+  select_control_click_row,</span>
<a href="#l112.43"></a><span id="l112.43" class="difflineplus">+  select_shift_click_row,</span>
<a href="#l112.44"></a><span id="l112.44" class="difflineplus">+  wait_for_popup_to_open,</span>
<a href="#l112.45"></a><span id="l112.45" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l112.46"></a><span id="l112.46" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l112.47"></a><span id="l112.47" class="difflineplus">+);</span>
<a href="#l112.48"></a><span id="l112.48"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l112.49"></a><span id="l112.49">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l112.50"></a><span id="l112.50"> );</span>
<a href="#l112.51"></a><span id="l112.51"> </span>
<a href="#l112.52"></a><span id="l112.52"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l112.53"></a><span id="l112.53" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l112.54"></a><span id="l112.54" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l112.55"></a><span id="l112.55" class="difflineplus">+);</span>
<a href="#l112.56"></a><span id="l112.56"> var { MailUtils } = ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l112.57"></a><span id="l112.57"> </span>
<a href="#l112.58"></a><span id="l112.58"> var unreadFolder, shiftDeleteFolder, threadDeleteFolder;</span>
<a href="#l112.59"></a><span id="l112.59"> var archiveSrcFolder = null;</span>
<a href="#l112.60"></a><span id="l112.60"> var archiveURI;</span>
<a href="#l112.61"></a><span id="l112.61"> </span>
<a href="#l112.62"></a><span id="l112.62"> var acctMgr;</span>
<a href="#l112.63"></a><span id="l112.63"> var tagArray;</span>
<a href="#l112.64"></a><span id="l112.64"> </span>
<a href="#l112.65"></a><span id="l112.65"> var setupModule = function(module) {</span>
<a href="#l112.66"></a><span id="l112.66" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l112.67"></a><span id="l112.67" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l112.68"></a><span id="l112.68" class="difflineminus">-  let cth = collector.getModule(&quot;content-tab-helpers&quot;);</span>
<a href="#l112.69"></a><span id="l112.69" class="difflineminus">-  cth.installInto(module);</span>
<a href="#l112.70"></a><span id="l112.70" class="difflineminus">-</span>
<a href="#l112.71"></a><span id="l112.71">   unreadFolder = create_folder(&quot;UnreadFolder&quot;);</span>
<a href="#l112.72"></a><span id="l112.72">   shiftDeleteFolder = create_folder(&quot;ShiftDeleteFolder&quot;);</span>
<a href="#l112.73"></a><span id="l112.73">   threadDeleteFolder = create_folder(&quot;ThreadDeleteFolder&quot;);</span>
<a href="#l112.74"></a><span id="l112.74">   archiveSrcFolder = create_folder(&quot;ArchiveSrc&quot;);</span>
<a href="#l112.75"></a><span id="l112.75"> </span>
<a href="#l112.76"></a><span id="l112.76">   make_new_sets_in_folder(unreadFolder, [{ count: 2 }]);</span>
<a href="#l112.77"></a><span id="l112.77">   make_new_sets_in_folder(shiftDeleteFolder, [{ count: 3 }]);</span>
<a href="#l112.78"></a><span id="l112.78">   add_sets_to_folders(</span>
<a href="#l112.79"></a><span id="l112.79" class="difflineat">@@ -597,14 +617,16 @@ function test_tag_keys_disabled_in_conte</span>
<a href="#l112.80"></a><span id="l112.80"> </span>
<a href="#l112.81"></a><span id="l112.81">   let tab = mc.tabmail.currentTabInfo;</span>
<a href="#l112.82"></a><span id="l112.82">   wait_for_content_tab_load(tab, &quot;about:addons&quot;, 15000);</span>
<a href="#l112.83"></a><span id="l112.83"> </span>
<a href="#l112.84"></a><span id="l112.84">   // Make sure pressing the &quot;1&quot; key in a content tab doesn't tag a message</span>
<a href="#l112.85"></a><span id="l112.85">   check_tag_in_message(curMessage, tagArray[0], false);</span>
<a href="#l112.86"></a><span id="l112.86">   mc.keypress(null, &quot;1&quot;, {});</span>
<a href="#l112.87"></a><span id="l112.87">   check_tag_in_message(curMessage, tagArray[0], false);</span>
<a href="#l112.88"></a><span id="l112.88" class="difflineplus">+</span>
<a href="#l112.89"></a><span id="l112.89" class="difflineplus">+  mc.tabmail.closeTab(tab);</span>
<a href="#l112.90"></a><span id="l112.90"> }</span>
<a href="#l112.91"></a><span id="l112.91"> </span>
<a href="#l112.92"></a><span id="l112.92"> function teardownModule() {</span>
<a href="#l112.93"></a><span id="l112.93">   // Make sure archiving is enabled at the end</span>
<a href="#l112.94"></a><span id="l112.94">   enable_archiving(true);</span>
<a href="#l112.95"></a><span id="l112.95"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l113.1"></a><span id="l113.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-message-pane-visibility.js</span>
<a href="#l113.2"></a><span id="l113.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-message-pane-visibility.js</span>
<a href="#l113.3"></a><span id="l113.3" class="difflineat">@@ -4,28 +4,36 @@</span>
<a href="#l113.4"></a><span id="l113.4"> </span>
<a href="#l113.5"></a><span id="l113.5"> /*</span>
<a href="#l113.6"></a><span id="l113.6">  * Test that the message pane collapses properly, stays collapsed amongst tab</span>
<a href="#l113.7"></a><span id="l113.7">  *  changes, and that persistence works (to a first approximation).</span>
<a href="#l113.8"></a><span id="l113.8">  */</span>
<a href="#l113.9"></a><span id="l113.9"> </span>
<a href="#l113.10"></a><span id="l113.10"> &quot;use strict&quot;;</span>
<a href="#l113.11"></a><span id="l113.11"> </span>
<a href="#l113.12"></a><span id="l113.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l113.13"></a><span id="l113.13" class="difflineminus">-</span>
<a href="#l113.14"></a><span id="l113.14" class="difflineminus">-var MODULE_NAME = &quot;test-message-pane-visibility&quot;;</span>
<a href="#l113.15"></a><span id="l113.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l113.16"></a><span id="l113.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l113.17"></a><span id="l113.17" class="difflineplus">+var {</span>
<a href="#l113.18"></a><span id="l113.18" class="difflineplus">+  assert_message_pane_hidden,</span>
<a href="#l113.19"></a><span id="l113.19" class="difflineplus">+  assert_message_pane_visible,</span>
<a href="#l113.20"></a><span id="l113.20" class="difflineplus">+  be_in_folder,</span>
<a href="#l113.21"></a><span id="l113.21" class="difflineplus">+  close_tab,</span>
<a href="#l113.22"></a><span id="l113.22" class="difflineplus">+  create_folder,</span>
<a href="#l113.23"></a><span id="l113.23" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l113.24"></a><span id="l113.24" class="difflineplus">+  mc,</span>
<a href="#l113.25"></a><span id="l113.25" class="difflineplus">+  open_folder_in_new_tab,</span>
<a href="#l113.26"></a><span id="l113.26" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l113.27"></a><span id="l113.27" class="difflineplus">+  select_click_row,</span>
<a href="#l113.28"></a><span id="l113.28" class="difflineplus">+  switch_tab,</span>
<a href="#l113.29"></a><span id="l113.29" class="difflineplus">+  toggle_message_pane,</span>
<a href="#l113.30"></a><span id="l113.30" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l113.31"></a><span id="l113.31" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l113.32"></a><span id="l113.32" class="difflineplus">+);</span>
<a href="#l113.33"></a><span id="l113.33"> </span>
<a href="#l113.34"></a><span id="l113.34"> var folder;</span>
<a href="#l113.35"></a><span id="l113.35"> </span>
<a href="#l113.36"></a><span id="l113.36"> function setupModule(module) {</span>
<a href="#l113.37"></a><span id="l113.37" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l113.38"></a><span id="l113.38" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l113.39"></a><span id="l113.39" class="difflineminus">-</span>
<a href="#l113.40"></a><span id="l113.40">   folder = create_folder(&quot;MessagePaneVisibility&quot;);</span>
<a href="#l113.41"></a><span id="l113.41">   make_new_sets_in_folder(folder, [{ count: 3 }]);</span>
<a href="#l113.42"></a><span id="l113.42"> }</span>
<a href="#l113.43"></a><span id="l113.43"> </span>
<a href="#l113.44"></a><span id="l113.44"> /**</span>
<a href="#l113.45"></a><span id="l113.45">  * By default, the message pane should be visible.  Make sure that this state of</span>
<a href="#l113.46"></a><span id="l113.46">  *  affairs is correct in terms of menu options, splitters, etc.</span>
<a href="#l113.47"></a><span id="l113.47">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l114.1"></a><span id="l114.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-message-reloads.js</span>
<a href="#l114.2"></a><span id="l114.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-message-reloads.js</span>
<a href="#l114.3"></a><span id="l114.3" class="difflineat">@@ -4,45 +4,54 @@</span>
<a href="#l114.4"></a><span id="l114.4"> </span>
<a href="#l114.5"></a><span id="l114.5"> /*</span>
<a href="#l114.6"></a><span id="l114.6">  * Test that message reloads happen properly when the message pane is hidden,</span>
<a href="#l114.7"></a><span id="l114.7">  * and then made visible again.</span>
<a href="#l114.8"></a><span id="l114.8">  */</span>
<a href="#l114.9"></a><span id="l114.9"> </span>
<a href="#l114.10"></a><span id="l114.10"> &quot;use strict&quot;;</span>
<a href="#l114.11"></a><span id="l114.11"> </span>
<a href="#l114.12"></a><span id="l114.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l114.13"></a><span id="l114.13" class="difflineminus">-</span>
<a href="#l114.14"></a><span id="l114.14" class="difflineminus">-var MODULE_NAME = &quot;test-message-reloads&quot;;</span>
<a href="#l114.15"></a><span id="l114.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l114.16"></a><span id="l114.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l114.17"></a><span id="l114.17" class="difflineplus">+var {</span>
<a href="#l114.18"></a><span id="l114.18" class="difflineplus">+  assert_message_pane_hidden,</span>
<a href="#l114.19"></a><span id="l114.19" class="difflineplus">+  assert_message_pane_visible,</span>
<a href="#l114.20"></a><span id="l114.20" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l114.21"></a><span id="l114.21" class="difflineplus">+  be_in_folder,</span>
<a href="#l114.22"></a><span id="l114.22" class="difflineplus">+  close_tab,</span>
<a href="#l114.23"></a><span id="l114.23" class="difflineplus">+  create_folder,</span>
<a href="#l114.24"></a><span id="l114.24" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l114.25"></a><span id="l114.25" class="difflineplus">+  open_folder_in_new_tab,</span>
<a href="#l114.26"></a><span id="l114.26" class="difflineplus">+  select_click_row,</span>
<a href="#l114.27"></a><span id="l114.27" class="difflineplus">+  switch_tab,</span>
<a href="#l114.28"></a><span id="l114.28" class="difflineplus">+  toggle_message_pane,</span>
<a href="#l114.29"></a><span id="l114.29" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l114.30"></a><span id="l114.30" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l114.31"></a><span id="l114.31" class="difflineplus">+);</span>
<a href="#l114.32"></a><span id="l114.32"> </span>
<a href="#l114.33"></a><span id="l114.33"> var folder;</span>
<a href="#l114.34"></a><span id="l114.34"> </span>
<a href="#l114.35"></a><span id="l114.35"> function setupModule(module) {</span>
<a href="#l114.36"></a><span id="l114.36" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l114.37"></a><span id="l114.37" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l114.38"></a><span id="l114.38" class="difflineminus">-</span>
<a href="#l114.39"></a><span id="l114.39">   folder = create_folder(&quot;MessageReloads&quot;);</span>
<a href="#l114.40"></a><span id="l114.40">   make_new_sets_in_folder(folder, [{ count: 1 }]);</span>
<a href="#l114.41"></a><span id="l114.41"> }</span>
<a href="#l114.42"></a><span id="l114.42"> </span>
<a href="#l114.43"></a><span id="l114.43"> function test_message_reloads_work_with_message_pane_toggles() {</span>
<a href="#l114.44"></a><span id="l114.44">   be_in_folder(folder);</span>
<a href="#l114.45"></a><span id="l114.45"> </span>
<a href="#l114.46"></a><span id="l114.46">   assert_message_pane_visible();</span>
<a href="#l114.47"></a><span id="l114.47">   select_click_row(0);</span>
<a href="#l114.48"></a><span id="l114.48">   // Toggle the message pane off, then on</span>
<a href="#l114.49"></a><span id="l114.49">   toggle_message_pane();</span>
<a href="#l114.50"></a><span id="l114.50">   assert_message_pane_hidden();</span>
<a href="#l114.51"></a><span id="l114.51">   toggle_message_pane();</span>
<a href="#l114.52"></a><span id="l114.52">   assert_message_pane_visible();</span>
<a href="#l114.53"></a><span id="l114.53">   // Open a new tab with the same message</span>
<a href="#l114.54"></a><span id="l114.54" class="difflineminus">-  open_folder_in_new_tab(folder);</span>
<a href="#l114.55"></a><span id="l114.55" class="difflineplus">+  let tab = open_folder_in_new_tab(folder);</span>
<a href="#l114.56"></a><span id="l114.56">   // Toggle the message pane off</span>
<a href="#l114.57"></a><span id="l114.57">   assert_message_pane_visible();</span>
<a href="#l114.58"></a><span id="l114.58">   toggle_message_pane();</span>
<a href="#l114.59"></a><span id="l114.59">   assert_message_pane_hidden();</span>
<a href="#l114.60"></a><span id="l114.60">   // Go back to the first tab, and make sure the message is actually displayed</span>
<a href="#l114.61"></a><span id="l114.61">   switch_tab(0);</span>
<a href="#l114.62"></a><span id="l114.62">   assert_message_pane_visible();</span>
<a href="#l114.63"></a><span id="l114.63">   assert_selected_and_displayed(0);</span>
<a href="#l114.64"></a><span id="l114.64" class="difflineplus">+</span>
<a href="#l114.65"></a><span id="l114.65" class="difflineplus">+  close_tab(tab);</span>
<a href="#l114.66"></a><span id="l114.66"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l115.1"></a><span id="l115.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-message-size.js</span>
<a href="#l115.2"></a><span id="l115.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-message-size.js</span>
<a href="#l115.3"></a><span id="l115.3" class="difflineat">@@ -5,28 +5,30 @@</span>
<a href="#l115.4"></a><span id="l115.4"> </span>
<a href="#l115.5"></a><span id="l115.5"> /*</span>
<a href="#l115.6"></a><span id="l115.6">  * Test that the size column of in the message list is formatted properly (e.g.</span>
<a href="#l115.7"></a><span id="l115.7">    0.1 KB, 1.2 KB, 12.3 KB, 123 KB, and likewise for MB and GB).</span>
<a href="#l115.8"></a><span id="l115.8">  */</span>
<a href="#l115.9"></a><span id="l115.9"> </span>
<a href="#l115.10"></a><span id="l115.10"> &quot;use strict&quot;;</span>
<a href="#l115.11"></a><span id="l115.11"> </span>
<a href="#l115.12"></a><span id="l115.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l115.13"></a><span id="l115.13" class="difflineminus">-</span>
<a href="#l115.14"></a><span id="l115.14" class="difflineminus">-var MODULE_NAME = &quot;test-message-size&quot;;</span>
<a href="#l115.15"></a><span id="l115.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l115.16"></a><span id="l115.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l115.17"></a><span id="l115.17" class="difflineplus">+var {</span>
<a href="#l115.18"></a><span id="l115.18" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l115.19"></a><span id="l115.19" class="difflineplus">+  be_in_folder,</span>
<a href="#l115.20"></a><span id="l115.20" class="difflineplus">+  create_folder,</span>
<a href="#l115.21"></a><span id="l115.21" class="difflineplus">+  create_message,</span>
<a href="#l115.22"></a><span id="l115.22" class="difflineplus">+  mc,</span>
<a href="#l115.23"></a><span id="l115.23" class="difflineplus">+  select_click_row,</span>
<a href="#l115.24"></a><span id="l115.24" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l115.25"></a><span id="l115.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l115.26"></a><span id="l115.26" class="difflineplus">+);</span>
<a href="#l115.27"></a><span id="l115.27"> </span>
<a href="#l115.28"></a><span id="l115.28"> var folder;</span>
<a href="#l115.29"></a><span id="l115.29"> </span>
<a href="#l115.30"></a><span id="l115.30"> function setupModule(module) {</span>
<a href="#l115.31"></a><span id="l115.31" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l115.32"></a><span id="l115.32" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l115.33"></a><span id="l115.33" class="difflineminus">-</span>
<a href="#l115.34"></a><span id="l115.34">   folder = create_folder(&quot;MessageSizeA&quot;);</span>
<a href="#l115.35"></a><span id="l115.35"> </span>
<a href="#l115.36"></a><span id="l115.36">   // Create messages with sizes in the byte, KB, and MB ranges.</span>
<a href="#l115.37"></a><span id="l115.37">   let bytemsg = create_message({ body: { body: &quot; &quot; } });</span>
<a href="#l115.38"></a><span id="l115.38"> </span>
<a href="#l115.39"></a><span id="l115.39">   let kbstring = &quot;x &quot;.repeat(1024 / 2);</span>
<a href="#l115.40"></a><span id="l115.40">   let kbmsg = create_message({ body: { body: kbstring } });</span>
<a href="#l115.41"></a><span id="l115.41"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l116.1"></a><span id="l116.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-message-window.js</span>
<a href="#l116.2"></a><span id="l116.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-message-window.js</span>
<a href="#l116.3"></a><span id="l116.3" class="difflineat">@@ -4,36 +4,42 @@</span>
<a href="#l116.4"></a><span id="l116.4"> </span>
<a href="#l116.5"></a><span id="l116.5"> /*</span>
<a href="#l116.6"></a><span id="l116.6">  * Test that we can open and close a standalone message display window from the</span>
<a href="#l116.7"></a><span id="l116.7">  *  folder pane.</span>
<a href="#l116.8"></a><span id="l116.8">  */</span>
<a href="#l116.9"></a><span id="l116.9"> </span>
<a href="#l116.10"></a><span id="l116.10"> &quot;use strict&quot;;</span>
<a href="#l116.11"></a><span id="l116.11"> </span>
<a href="#l116.12"></a><span id="l116.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l116.13"></a><span id="l116.13" class="difflineminus">-</span>
<a href="#l116.14"></a><span id="l116.14" class="difflineminus">-var MODULE_NAME = &quot;test-message-window&quot;;</span>
<a href="#l116.15"></a><span id="l116.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l116.16"></a><span id="l116.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l116.17"></a><span id="l116.17" class="difflineminus">-</span>
<a href="#l116.18"></a><span id="l116.18" class="difflineplus">+var {</span>
<a href="#l116.19"></a><span id="l116.19" class="difflineplus">+  add_sets_to_folders,</span>
<a href="#l116.20"></a><span id="l116.20" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l116.21"></a><span id="l116.21" class="difflineplus">+  assert_true,</span>
<a href="#l116.22"></a><span id="l116.22" class="difflineplus">+  be_in_folder,</span>
<a href="#l116.23"></a><span id="l116.23" class="difflineplus">+  create_folder,</span>
<a href="#l116.24"></a><span id="l116.24" class="difflineplus">+  create_thread,</span>
<a href="#l116.25"></a><span id="l116.25" class="difflineplus">+  open_selected_message_in_new_window,</span>
<a href="#l116.26"></a><span id="l116.26" class="difflineplus">+  plan_for_message_display,</span>
<a href="#l116.27"></a><span id="l116.27" class="difflineplus">+  press_delete,</span>
<a href="#l116.28"></a><span id="l116.28" class="difflineplus">+  select_click_row,</span>
<a href="#l116.29"></a><span id="l116.29" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l116.30"></a><span id="l116.30" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l116.31"></a><span id="l116.31" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l116.32"></a><span id="l116.32" class="difflineplus">+);</span>
<a href="#l116.33"></a><span id="l116.33"> var {</span>
<a href="#l116.34"></a><span id="l116.34">   plan_for_modal_dialog,</span>
<a href="#l116.35"></a><span id="l116.35">   plan_for_window_close,</span>
<a href="#l116.36"></a><span id="l116.36">   wait_for_modal_dialog,</span>
<a href="#l116.37"></a><span id="l116.37">   wait_for_window_close,</span>
<a href="#l116.38"></a><span id="l116.38"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l116.39"></a><span id="l116.39"> </span>
<a href="#l116.40"></a><span id="l116.40"> var folderA, folderB;</span>
<a href="#l116.41"></a><span id="l116.41"> var curMessage;</span>
<a href="#l116.42"></a><span id="l116.42"> </span>
<a href="#l116.43"></a><span id="l116.43"> function setupModule(module) {</span>
<a href="#l116.44"></a><span id="l116.44" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l116.45"></a><span id="l116.45" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l116.46"></a><span id="l116.46" class="difflineminus">-</span>
<a href="#l116.47"></a><span id="l116.47">   folderA = create_folder(&quot;MessageWindowA&quot;);</span>
<a href="#l116.48"></a><span id="l116.48">   folderB = create_folder(&quot;MessageWindowB&quot;);</span>
<a href="#l116.49"></a><span id="l116.49">   // create three messages in the folder to display</span>
<a href="#l116.50"></a><span id="l116.50">   let msg1 = create_thread(1);</span>
<a href="#l116.51"></a><span id="l116.51">   let msg2 = create_thread(1);</span>
<a href="#l116.52"></a><span id="l116.52">   let thread1 = create_thread(2);</span>
<a href="#l116.53"></a><span id="l116.53">   let thread2 = create_thread(2);</span>
<a href="#l116.54"></a><span id="l116.54">   add_sets_to_folders([folderA], [msg1, msg2, thread1, thread2]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l117.1"></a><span id="l117.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js</span>
<a href="#l117.2"></a><span id="l117.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js</span>
<a href="#l117.3"></a><span id="l117.3" class="difflineat">@@ -5,41 +5,59 @@</span>
<a href="#l117.4"></a><span id="l117.4"> /*</span>
<a href="#l117.5"></a><span id="l117.5">  * Test that messages without a backing view are opened correctly. Examples of</span>
<a href="#l117.6"></a><span id="l117.6">  * messages without a backing view are those opened from the command line or</span>
<a href="#l117.7"></a><span id="l117.7">  * desktop search integration results.</span>
<a href="#l117.8"></a><span id="l117.8">  */</span>
<a href="#l117.9"></a><span id="l117.9"> </span>
<a href="#l117.10"></a><span id="l117.10"> &quot;use strict&quot;;</span>
<a href="#l117.11"></a><span id="l117.11"> </span>
<a href="#l117.12"></a><span id="l117.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l117.13"></a><span id="l117.13" class="difflineminus">-</span>
<a href="#l117.14"></a><span id="l117.14" class="difflineminus">-var MODULE_NAME = &quot;test-opening-messages-without-a-backing-view&quot;;</span>
<a href="#l117.15"></a><span id="l117.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l117.16"></a><span id="l117.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l117.17"></a><span id="l117.17" class="difflineminus">-</span>
<a href="#l117.18"></a><span id="l117.18" class="difflineplus">+var {</span>
<a href="#l117.19"></a><span id="l117.19" class="difflineplus">+  add_to_toolbar,</span>
<a href="#l117.20"></a><span id="l117.20" class="difflineplus">+  assert_message_pane_focused,</span>
<a href="#l117.21"></a><span id="l117.21" class="difflineplus">+  assert_messages_not_in_view,</span>
<a href="#l117.22"></a><span id="l117.22" class="difflineplus">+  assert_number_of_tabs_open,</span>
<a href="#l117.23"></a><span id="l117.23" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l117.24"></a><span id="l117.24" class="difflineplus">+  assert_tab_mode_name,</span>
<a href="#l117.25"></a><span id="l117.25" class="difflineplus">+  assert_tab_titled_from,</span>
<a href="#l117.26"></a><span id="l117.26" class="difflineplus">+  be_in_folder,</span>
<a href="#l117.27"></a><span id="l117.27" class="difflineplus">+  close_message_window,</span>
<a href="#l117.28"></a><span id="l117.28" class="difflineplus">+  close_tab,</span>
<a href="#l117.29"></a><span id="l117.29" class="difflineplus">+  create_folder,</span>
<a href="#l117.30"></a><span id="l117.30" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l117.31"></a><span id="l117.31" class="difflineplus">+  mc,</span>
<a href="#l117.32"></a><span id="l117.32" class="difflineplus">+  plan_for_message_display,</span>
<a href="#l117.33"></a><span id="l117.33" class="difflineplus">+  remove_from_toolbar,</span>
<a href="#l117.34"></a><span id="l117.34" class="difflineplus">+  reset_open_message_behavior,</span>
<a href="#l117.35"></a><span id="l117.35" class="difflineplus">+  set_mail_view,</span>
<a href="#l117.36"></a><span id="l117.36" class="difflineplus">+  set_open_message_behavior,</span>
<a href="#l117.37"></a><span id="l117.37" class="difflineplus">+  switch_tab,</span>
<a href="#l117.38"></a><span id="l117.38" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l117.39"></a><span id="l117.39" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l117.40"></a><span id="l117.40" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l117.41"></a><span id="l117.41" class="difflineplus">+);</span>
<a href="#l117.42"></a><span id="l117.42"> var { plan_for_new_window, wait_for_new_window } = ChromeUtils.import(</span>
<a href="#l117.43"></a><span id="l117.43">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l117.44"></a><span id="l117.44"> );</span>
<a href="#l117.45"></a><span id="l117.45"> </span>
<a href="#l117.46"></a><span id="l117.46"> var { MailUtils } = ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l117.47"></a><span id="l117.47" class="difflineplus">+var { MailViewConstants } = ChromeUtils.import(</span>
<a href="#l117.48"></a><span id="l117.48" class="difflineplus">+  &quot;resource:///modules/MailViewManager.jsm&quot;</span>
<a href="#l117.49"></a><span id="l117.49" class="difflineplus">+);</span>
<a href="#l117.50"></a><span id="l117.50"> </span>
<a href="#l117.51"></a><span id="l117.51"> // One folder's enough</span>
<a href="#l117.52"></a><span id="l117.52"> var folder = null;</span>
<a href="#l117.53"></a><span id="l117.53"> </span>
<a href="#l117.54"></a><span id="l117.54"> // A list of the message headers in this folder</span>
<a href="#l117.55"></a><span id="l117.55"> var msgHdrsInFolder = null;</span>
<a href="#l117.56"></a><span id="l117.56"> </span>
<a href="#l117.57"></a><span id="l117.57"> // Number of messages to open for multi-message tests</span>
<a href="#l117.58"></a><span id="l117.58"> var NUM_MESSAGES_TO_OPEN = 5;</span>
<a href="#l117.59"></a><span id="l117.59"> </span>
<a href="#l117.60"></a><span id="l117.60"> function setupModule(module) {</span>
<a href="#l117.61"></a><span id="l117.61" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l117.62"></a><span id="l117.62" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l117.63"></a><span id="l117.63" class="difflineminus">-</span>
<a href="#l117.64"></a><span id="l117.64">   folder = create_folder(&quot;OpeningMessagesNoBackingViewA&quot;);</span>
<a href="#l117.65"></a><span id="l117.65">   make_new_sets_in_folder(folder, [{ count: 10 }]);</span>
<a href="#l117.66"></a><span id="l117.66">   // We don't obey mail view persistence unless the view picker is there</span>
<a href="#l117.67"></a><span id="l117.67">   add_to_toolbar(mc.e(&quot;mail-bar3&quot;), &quot;mailviews-container&quot;);</span>
<a href="#l117.68"></a><span id="l117.68"> }</span>
<a href="#l117.69"></a><span id="l117.69"> </span>
<a href="#l117.70"></a><span id="l117.70"> /**</span>
<a href="#l117.71"></a><span id="l117.71">  * Test opening a single message without a backing view in a new tab.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l118.1"></a><span id="l118.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-opening-messages.js</span>
<a href="#l118.2"></a><span id="l118.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-opening-messages.js</span>
<a href="#l118.3"></a><span id="l118.3" class="difflineat">@@ -13,36 +13,52 @@</span>
<a href="#l118.4"></a><span id="l118.4">  *   amount of additional work and are hard to test. We're also assuming here</span>
<a href="#l118.5"></a><span id="l118.5">  *   that multiple messages opened in windows are just the same function called</span>
<a href="#l118.6"></a><span id="l118.6">  *   repeatedly.)</span>
<a href="#l118.7"></a><span id="l118.7">  * - reusing an existing window to show another message</span>
<a href="#l118.8"></a><span id="l118.8">  */</span>
<a href="#l118.9"></a><span id="l118.9"> </span>
<a href="#l118.10"></a><span id="l118.10"> &quot;use strict&quot;;</span>
<a href="#l118.11"></a><span id="l118.11"> </span>
<a href="#l118.12"></a><span id="l118.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l118.13"></a><span id="l118.13" class="difflineminus">-</span>
<a href="#l118.14"></a><span id="l118.14" class="difflineminus">-var MODULE_NAME = &quot;test-opening-messages&quot;;</span>
<a href="#l118.15"></a><span id="l118.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l118.16"></a><span id="l118.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l118.17"></a><span id="l118.17" class="difflineminus">-</span>
<a href="#l118.18"></a><span id="l118.18" class="difflineplus">+var {</span>
<a href="#l118.19"></a><span id="l118.19" class="difflineplus">+  assert_equals,</span>
<a href="#l118.20"></a><span id="l118.20" class="difflineplus">+  assert_message_pane_focused,</span>
<a href="#l118.21"></a><span id="l118.21" class="difflineplus">+  assert_number_of_tabs_open,</span>
<a href="#l118.22"></a><span id="l118.22" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l118.23"></a><span id="l118.23" class="difflineplus">+  assert_tab_mode_name,</span>
<a href="#l118.24"></a><span id="l118.24" class="difflineplus">+  assert_tab_titled_from,</span>
<a href="#l118.25"></a><span id="l118.25" class="difflineplus">+  be_in_folder,</span>
<a href="#l118.26"></a><span id="l118.26" class="difflineplus">+  close_message_window,</span>
<a href="#l118.27"></a><span id="l118.27" class="difflineplus">+  close_tab,</span>
<a href="#l118.28"></a><span id="l118.28" class="difflineplus">+  create_folder,</span>
<a href="#l118.29"></a><span id="l118.29" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l118.30"></a><span id="l118.30" class="difflineplus">+  mc,</span>
<a href="#l118.31"></a><span id="l118.31" class="difflineplus">+  open_selected_message,</span>
<a href="#l118.32"></a><span id="l118.32" class="difflineplus">+  open_selected_messages,</span>
<a href="#l118.33"></a><span id="l118.33" class="difflineplus">+  plan_for_message_display,</span>
<a href="#l118.34"></a><span id="l118.34" class="difflineplus">+  reset_open_message_behavior,</span>
<a href="#l118.35"></a><span id="l118.35" class="difflineplus">+  select_click_row,</span>
<a href="#l118.36"></a><span id="l118.36" class="difflineplus">+  select_shift_click_row,</span>
<a href="#l118.37"></a><span id="l118.37" class="difflineplus">+  set_open_message_behavior,</span>
<a href="#l118.38"></a><span id="l118.38" class="difflineplus">+  switch_tab,</span>
<a href="#l118.39"></a><span id="l118.39" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l118.40"></a><span id="l118.40" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l118.41"></a><span id="l118.41" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l118.42"></a><span id="l118.42" class="difflineplus">+);</span>
<a href="#l118.43"></a><span id="l118.43"> var { plan_for_new_window, wait_for_new_window } = ChromeUtils.import(</span>
<a href="#l118.44"></a><span id="l118.44">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l118.45"></a><span id="l118.45"> );</span>
<a href="#l118.46"></a><span id="l118.46"> </span>
<a href="#l118.47"></a><span id="l118.47"> // One folder's enough</span>
<a href="#l118.48"></a><span id="l118.48"> var folder = null;</span>
<a href="#l118.49"></a><span id="l118.49"> </span>
<a href="#l118.50"></a><span id="l118.50"> // Number of messages to open for multi-message tests</span>
<a href="#l118.51"></a><span id="l118.51"> var NUM_MESSAGES_TO_OPEN = 5;</span>
<a href="#l118.52"></a><span id="l118.52"> </span>
<a href="#l118.53"></a><span id="l118.53"> function setupModule(module) {</span>
<a href="#l118.54"></a><span id="l118.54" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l118.55"></a><span id="l118.55" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l118.56"></a><span id="l118.56" class="difflineminus">-</span>
<a href="#l118.57"></a><span id="l118.57">   folder = create_folder(&quot;OpeningMessagesA&quot;);</span>
<a href="#l118.58"></a><span id="l118.58">   make_new_sets_in_folder(folder, [{ count: 10 }]);</span>
<a href="#l118.59"></a><span id="l118.59"> }</span>
<a href="#l118.60"></a><span id="l118.60"> </span>
<a href="#l118.61"></a><span id="l118.61"> /**</span>
<a href="#l118.62"></a><span id="l118.62">  * Test opening a single message in a new tab.</span>
<a href="#l118.63"></a><span id="l118.63">  */</span>
<a href="#l118.64"></a><span id="l118.64"> function test_open_single_message_in_tab() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l119.1"></a><span id="l119.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-pane-focus.js</span>
<a href="#l119.2"></a><span id="l119.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-pane-focus.js</span>
<a href="#l119.3"></a><span id="l119.3" class="difflineat">@@ -3,28 +3,40 @@</span>
<a href="#l119.4"></a><span id="l119.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l119.5"></a><span id="l119.5"> </span>
<a href="#l119.6"></a><span id="l119.6"> /*</span>
<a href="#l119.7"></a><span id="l119.7">  * Test that cycling through the focus of the 3pane's panes works correctly.</span>
<a href="#l119.8"></a><span id="l119.8">  */</span>
<a href="#l119.9"></a><span id="l119.9"> </span>
<a href="#l119.10"></a><span id="l119.10"> &quot;use strict&quot;;</span>
<a href="#l119.11"></a><span id="l119.11"> </span>
<a href="#l119.12"></a><span id="l119.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l119.13"></a><span id="l119.13" class="difflineplus">+var {</span>
<a href="#l119.14"></a><span id="l119.14" class="difflineplus">+  add_sets_to_folders,</span>
<a href="#l119.15"></a><span id="l119.15" class="difflineplus">+  assert_equals,</span>
<a href="#l119.16"></a><span id="l119.16" class="difflineplus">+  be_in_folder,</span>
<a href="#l119.17"></a><span id="l119.17" class="difflineplus">+  close_tab,</span>
<a href="#l119.18"></a><span id="l119.18" class="difflineplus">+  collapse_all_threads,</span>
<a href="#l119.19"></a><span id="l119.19" class="difflineplus">+  create_folder,</span>
<a href="#l119.20"></a><span id="l119.20" class="difflineplus">+  create_thread,</span>
<a href="#l119.21"></a><span id="l119.21" class="difflineplus">+  make_display_threaded,</span>
<a href="#l119.22"></a><span id="l119.22" class="difflineplus">+  mc,</span>
<a href="#l119.23"></a><span id="l119.23" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l119.24"></a><span id="l119.24" class="difflineplus">+  press_delete,</span>
<a href="#l119.25"></a><span id="l119.25" class="difflineplus">+  select_click_row,</span>
<a href="#l119.26"></a><span id="l119.26" class="difflineplus">+  select_none,</span>
<a href="#l119.27"></a><span id="l119.27" class="difflineplus">+  switch_tab,</span>
<a href="#l119.28"></a><span id="l119.28" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l119.29"></a><span id="l119.29" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l119.30"></a><span id="l119.30" class="difflineplus">+);</span>
<a href="#l119.31"></a><span id="l119.31"> </span>
<a href="#l119.32"></a><span id="l119.32" class="difflineminus">-var MODULE_NAME = &quot;test-pane-focus&quot;;</span>
<a href="#l119.33"></a><span id="l119.33" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l119.34"></a><span id="l119.34" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l119.35"></a><span id="l119.35" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l119.36"></a><span id="l119.36"> </span>
<a href="#l119.37"></a><span id="l119.37"> var folder;</span>
<a href="#l119.38"></a><span id="l119.38"> </span>
<a href="#l119.39"></a><span id="l119.39"> function setupModule(module) {</span>
<a href="#l119.40"></a><span id="l119.40" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l119.41"></a><span id="l119.41" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l119.42"></a><span id="l119.42" class="difflineminus">-</span>
<a href="#l119.43"></a><span id="l119.43">   folder = create_folder(&quot;PaneFocus&quot;);</span>
<a href="#l119.44"></a><span id="l119.44">   let msg1 = create_thread(1);</span>
<a href="#l119.45"></a><span id="l119.45">   let thread = create_thread(3);</span>
<a href="#l119.46"></a><span id="l119.46">   let msg2 = create_thread(1);</span>
<a href="#l119.47"></a><span id="l119.47">   add_sets_to_folders([folder], [msg1, thread, msg2]);</span>
<a href="#l119.48"></a><span id="l119.48"> </span>
<a href="#l119.49"></a><span id="l119.49">   be_in_folder(folder);</span>
<a href="#l119.50"></a><span id="l119.50">   make_display_threaded();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l120.1"></a><span id="l120.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-recent-menu.js</span>
<a href="#l120.2"></a><span id="l120.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-recent-menu.js</span>
<a href="#l120.3"></a><span id="l120.3" class="difflineat">@@ -5,38 +5,43 @@</span>
<a href="#l120.4"></a><span id="l120.4"> /**</span>
<a href="#l120.5"></a><span id="l120.5">  * This tests the move/copy to recent folder menus to make sure</span>
<a href="#l120.6"></a><span id="l120.6">  * that they get updated when messages are moved to folders, and</span>
<a href="#l120.7"></a><span id="l120.7">  * don't get updated when we archive.</span>
<a href="#l120.8"></a><span id="l120.8">  */</span>
<a href="#l120.9"></a><span id="l120.9"> </span>
<a href="#l120.10"></a><span id="l120.10"> &quot;use strict&quot;;</span>
<a href="#l120.11"></a><span id="l120.11"> </span>
<a href="#l120.12"></a><span id="l120.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l120.13"></a><span id="l120.13" class="difflineminus">-</span>
<a href="#l120.14"></a><span id="l120.14" class="difflineminus">-var MODULE_NAME = &quot;test-recent-menu&quot;;</span>
<a href="#l120.15"></a><span id="l120.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l120.16"></a><span id="l120.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l120.17"></a><span id="l120.17" class="difflineplus">+var {</span>
<a href="#l120.18"></a><span id="l120.18" class="difflineplus">+  archive_selected_messages,</span>
<a href="#l120.19"></a><span id="l120.19" class="difflineplus">+  assert_equals,</span>
<a href="#l120.20"></a><span id="l120.20" class="difflineplus">+  be_in_folder,</span>
<a href="#l120.21"></a><span id="l120.21" class="difflineplus">+  create_folder,</span>
<a href="#l120.22"></a><span id="l120.22" class="difflineplus">+  get_special_folder,</span>
<a href="#l120.23"></a><span id="l120.23" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l120.24"></a><span id="l120.24" class="difflineplus">+  mc,</span>
<a href="#l120.25"></a><span id="l120.25" class="difflineplus">+  press_delete,</span>
<a href="#l120.26"></a><span id="l120.26" class="difflineplus">+  right_click_on_row,</span>
<a href="#l120.27"></a><span id="l120.27" class="difflineplus">+  select_click_row,</span>
<a href="#l120.28"></a><span id="l120.28" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l120.29"></a><span id="l120.29" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l120.30"></a><span id="l120.30" class="difflineplus">+);</span>
<a href="#l120.31"></a><span id="l120.31"> </span>
<a href="#l120.32"></a><span id="l120.32"> var { MailUtils } = ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l120.33"></a><span id="l120.33"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l120.34"></a><span id="l120.34">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l120.35"></a><span id="l120.35"> );</span>
<a href="#l120.36"></a><span id="l120.36"> var { fixIterator } = ChromeUtils.import(</span>
<a href="#l120.37"></a><span id="l120.37">   &quot;resource:///modules/iteratorUtils.jsm&quot;</span>
<a href="#l120.38"></a><span id="l120.38"> );</span>
<a href="#l120.39"></a><span id="l120.39"> </span>
<a href="#l120.40"></a><span id="l120.40"> var folder1, folder2;</span>
<a href="#l120.41"></a><span id="l120.41"> var gInitRecentMenuCount;</span>
<a href="#l120.42"></a><span id="l120.42"> </span>
<a href="#l120.43"></a><span id="l120.43"> var setupModule = function(module) {</span>
<a href="#l120.44"></a><span id="l120.44" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l120.45"></a><span id="l120.45" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l120.46"></a><span id="l120.46" class="difflineminus">-  }</span>
<a href="#l120.47"></a><span id="l120.47" class="difflineminus">-</span>
<a href="#l120.48"></a><span id="l120.48">   // Ensure that there are no updated folders to ensure the recent folder</span>
<a href="#l120.49"></a><span id="l120.49">   // is empty.</span>
<a href="#l120.50"></a><span id="l120.50">   let allFolders = MailServices.accounts.allFolders;</span>
<a href="#l120.51"></a><span id="l120.51">   for (let folder of fixIterator(allFolders, Ci.nsIMsgFolder)) {</span>
<a href="#l120.52"></a><span id="l120.52">     folder.setStringProperty(&quot;MRMTime&quot;, &quot;0&quot;);</span>
<a href="#l120.53"></a><span id="l120.53">   }</span>
<a href="#l120.54"></a><span id="l120.54"> </span>
<a href="#l120.55"></a><span id="l120.55">   // Try to make these folders first in alphabetic order</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l121.1"></a><span id="l121.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-right-click-middle-click-folders.js</span>
<a href="#l121.2"></a><span id="l121.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-right-click-middle-click-folders.js</span>
<a href="#l121.3"></a><span id="l121.3" class="difflineat">@@ -4,28 +4,44 @@</span>
<a href="#l121.4"></a><span id="l121.4"> </span>
<a href="#l121.5"></a><span id="l121.5"> /*</span>
<a href="#l121.6"></a><span id="l121.6">  * Test the many horrors involving right-clicks, middle clicks, and</span>
<a href="#l121.7"></a><span id="l121.7">  * selections... on folders!</span>
<a href="#l121.8"></a><span id="l121.8">  */</span>
<a href="#l121.9"></a><span id="l121.9"> </span>
<a href="#l121.10"></a><span id="l121.10"> &quot;use strict&quot;;</span>
<a href="#l121.11"></a><span id="l121.11"> </span>
<a href="#l121.12"></a><span id="l121.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l121.13"></a><span id="l121.13" class="difflineminus">-</span>
<a href="#l121.14"></a><span id="l121.14" class="difflineminus">-var MODULE_NAME = &quot;test-right-click-middle-click-folders&quot;;</span>
<a href="#l121.15"></a><span id="l121.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l121.16"></a><span id="l121.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l121.17"></a><span id="l121.17" class="difflineplus">+var {</span>
<a href="#l121.18"></a><span id="l121.18" class="difflineplus">+  assert_folder_displayed,</span>
<a href="#l121.19"></a><span id="l121.19" class="difflineplus">+  assert_folder_selected,</span>
<a href="#l121.20"></a><span id="l121.20" class="difflineplus">+  assert_folder_selected_and_displayed,</span>
<a href="#l121.21"></a><span id="l121.21" class="difflineplus">+  assert_folders_selected_and_displayed,</span>
<a href="#l121.22"></a><span id="l121.22" class="difflineplus">+  assert_no_folders_selected,</span>
<a href="#l121.23"></a><span id="l121.23" class="difflineplus">+  assert_selected_tab,</span>
<a href="#l121.24"></a><span id="l121.24" class="difflineplus">+  be_in_folder,</span>
<a href="#l121.25"></a><span id="l121.25" class="difflineplus">+  close_popup,</span>
<a href="#l121.26"></a><span id="l121.26" class="difflineplus">+  close_tab,</span>
<a href="#l121.27"></a><span id="l121.27" class="difflineplus">+  create_folder,</span>
<a href="#l121.28"></a><span id="l121.28" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l121.29"></a><span id="l121.29" class="difflineplus">+  mc,</span>
<a href="#l121.30"></a><span id="l121.30" class="difflineplus">+  middle_click_on_folder,</span>
<a href="#l121.31"></a><span id="l121.31" class="difflineplus">+  reset_context_menu_background_tabs,</span>
<a href="#l121.32"></a><span id="l121.32" class="difflineplus">+  right_click_on_folder,</span>
<a href="#l121.33"></a><span id="l121.33" class="difflineplus">+  select_click_folder,</span>
<a href="#l121.34"></a><span id="l121.34" class="difflineplus">+  select_no_folders,</span>
<a href="#l121.35"></a><span id="l121.35" class="difflineplus">+  select_shift_click_folder,</span>
<a href="#l121.36"></a><span id="l121.36" class="difflineplus">+  set_context_menu_background_tabs,</span>
<a href="#l121.37"></a><span id="l121.37" class="difflineplus">+  switch_tab,</span>
<a href="#l121.38"></a><span id="l121.38" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l121.39"></a><span id="l121.39" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l121.40"></a><span id="l121.40" class="difflineplus">+);</span>
<a href="#l121.41"></a><span id="l121.41"> </span>
<a href="#l121.42"></a><span id="l121.42"> var folderA, folderB, folderC;</span>
<a href="#l121.43"></a><span id="l121.43"> </span>
<a href="#l121.44"></a><span id="l121.44"> function setupModule(module) {</span>
<a href="#l121.45"></a><span id="l121.45" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l121.46"></a><span id="l121.46" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l121.47"></a><span id="l121.47" class="difflineminus">-</span>
<a href="#l121.48"></a><span id="l121.48">   folderA = create_folder(&quot;RightClickMiddleClickFoldersA&quot;);</span>
<a href="#l121.49"></a><span id="l121.49">   folderB = create_folder(&quot;RightClickMiddleClickFoldersB&quot;);</span>
<a href="#l121.50"></a><span id="l121.50">   folderC = create_folder(&quot;RightClickMiddleClickFoldersC&quot;);</span>
<a href="#l121.51"></a><span id="l121.51"> </span>
<a href="#l121.52"></a><span id="l121.52">   // We aren't really interested in the messages the folders contain, but just</span>
<a href="#l121.53"></a><span id="l121.53">   // for appearance's sake, add a message to each folder</span>
<a href="#l121.54"></a><span id="l121.54"> </span>
<a href="#l121.55"></a><span id="l121.55">   make_new_sets_in_folder(folderA, [{ count: 1 }]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l122.1"></a><span id="l122.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-right-click-middle-click-messages.js</span>
<a href="#l122.2"></a><span id="l122.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-right-click-middle-click-messages.js</span>
<a href="#l122.3"></a><span id="l122.3" class="difflineat">@@ -3,37 +3,65 @@</span>
<a href="#l122.4"></a><span id="l122.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l122.5"></a><span id="l122.5"> </span>
<a href="#l122.6"></a><span id="l122.6"> /*</span>
<a href="#l122.7"></a><span id="l122.7">  * Test the many horrors involving right-clicks, middle clicks, and selections.</span>
<a href="#l122.8"></a><span id="l122.8">  */</span>
<a href="#l122.9"></a><span id="l122.9"> </span>
<a href="#l122.10"></a><span id="l122.10"> &quot;use strict&quot;;</span>
<a href="#l122.11"></a><span id="l122.11"> </span>
<a href="#l122.12"></a><span id="l122.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l122.13"></a><span id="l122.13" class="difflineminus">-</span>
<a href="#l122.14"></a><span id="l122.14" class="difflineminus">-var MODULE_NAME = &quot;test-right-click-middle-click-messages&quot;;</span>
<a href="#l122.15"></a><span id="l122.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l122.16"></a><span id="l122.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l122.17"></a><span id="l122.17" class="difflineminus">-</span>
<a href="#l122.18"></a><span id="l122.18"> var elib = ChromeUtils.import(</span>
<a href="#l122.19"></a><span id="l122.19">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l122.20"></a><span id="l122.20"> );</span>
<a href="#l122.21"></a><span id="l122.21"> </span>
<a href="#l122.22"></a><span id="l122.22" class="difflineplus">+var {</span>
<a href="#l122.23"></a><span id="l122.23" class="difflineplus">+  add_sets_to_folders,</span>
<a href="#l122.24"></a><span id="l122.24" class="difflineplus">+  assert_displayed,</span>
<a href="#l122.25"></a><span id="l122.25" class="difflineplus">+  assert_message_not_in_view,</span>
<a href="#l122.26"></a><span id="l122.26" class="difflineplus">+  assert_message_pane_focused,</span>
<a href="#l122.27"></a><span id="l122.27" class="difflineplus">+  assert_messages_not_in_view,</span>
<a href="#l122.28"></a><span id="l122.28" class="difflineplus">+  assert_nothing_selected,</span>
<a href="#l122.29"></a><span id="l122.29" class="difflineplus">+  assert_selected,</span>
<a href="#l122.30"></a><span id="l122.30" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l122.31"></a><span id="l122.31" class="difflineplus">+  assert_selected_tab,</span>
<a href="#l122.32"></a><span id="l122.32" class="difflineplus">+  assert_thread_tree_focused,</span>
<a href="#l122.33"></a><span id="l122.33" class="difflineplus">+  be_in_folder,</span>
<a href="#l122.34"></a><span id="l122.34" class="difflineplus">+  close_popup,</span>
<a href="#l122.35"></a><span id="l122.35" class="difflineplus">+  close_tab,</span>
<a href="#l122.36"></a><span id="l122.36" class="difflineplus">+  collapse_all_threads,</span>
<a href="#l122.37"></a><span id="l122.37" class="difflineplus">+  create_folder,</span>
<a href="#l122.38"></a><span id="l122.38" class="difflineplus">+  create_thread,</span>
<a href="#l122.39"></a><span id="l122.39" class="difflineplus">+  delete_via_popup,</span>
<a href="#l122.40"></a><span id="l122.40" class="difflineplus">+  expand_all_threads,</span>
<a href="#l122.41"></a><span id="l122.41" class="difflineplus">+  focus_thread_tree,</span>
<a href="#l122.42"></a><span id="l122.42" class="difflineplus">+  make_display_threaded,</span>
<a href="#l122.43"></a><span id="l122.43" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l122.44"></a><span id="l122.44" class="difflineplus">+  mc,</span>
<a href="#l122.45"></a><span id="l122.45" class="difflineplus">+  middle_click_on_row,</span>
<a href="#l122.46"></a><span id="l122.46" class="difflineplus">+  reset_context_menu_background_tabs,</span>
<a href="#l122.47"></a><span id="l122.47" class="difflineplus">+  right_click_on_row,</span>
<a href="#l122.48"></a><span id="l122.48" class="difflineplus">+  select_click_row,</span>
<a href="#l122.49"></a><span id="l122.49" class="difflineplus">+  select_none,</span>
<a href="#l122.50"></a><span id="l122.50" class="difflineplus">+  select_shift_click_row,</span>
<a href="#l122.51"></a><span id="l122.51" class="difflineplus">+  set_context_menu_background_tabs,</span>
<a href="#l122.52"></a><span id="l122.52" class="difflineplus">+  switch_tab,</span>
<a href="#l122.53"></a><span id="l122.53" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l122.54"></a><span id="l122.54" class="difflineplus">+  wait_for_popup_to_open,</span>
<a href="#l122.55"></a><span id="l122.55" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l122.56"></a><span id="l122.56" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l122.57"></a><span id="l122.57" class="difflineplus">+);</span>
<a href="#l122.58"></a><span id="l122.58" class="difflineplus">+</span>
<a href="#l122.59"></a><span id="l122.59"> var folder, threadedFolder;</span>
<a href="#l122.60"></a><span id="l122.60"> </span>
<a href="#l122.61"></a><span id="l122.61"> /**</span>
<a href="#l122.62"></a><span id="l122.62">  * The number of messages in the thread we use to test.</span>
<a href="#l122.63"></a><span id="l122.63">  */</span>
<a href="#l122.64"></a><span id="l122.64"> var NUM_MESSAGES_IN_THREAD = 6;</span>
<a href="#l122.65"></a><span id="l122.65"> </span>
<a href="#l122.66"></a><span id="l122.66"> function setupModule(module) {</span>
<a href="#l122.67"></a><span id="l122.67" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l122.68"></a><span id="l122.68" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l122.69"></a><span id="l122.69" class="difflineminus">-</span>
<a href="#l122.70"></a><span id="l122.70">   folder = create_folder(&quot;RightClickMiddleClickA&quot;);</span>
<a href="#l122.71"></a><span id="l122.71">   threadedFolder = create_folder(&quot;RightClickMiddleClickB&quot;);</span>
<a href="#l122.72"></a><span id="l122.72">   // we want exactly as many messages as we plan to delete, so that we can test</span>
<a href="#l122.73"></a><span id="l122.73">   //  that the message window and tabs close when they run out of things to</span>
<a href="#l122.74"></a><span id="l122.74">   //  to display.</span>
<a href="#l122.75"></a><span id="l122.75">   make_new_sets_in_folder(folder, [{ count: 20 }]);</span>
<a href="#l122.76"></a><span id="l122.76">   // Create a few messages and one thread (the order is important here, as it</span>
<a href="#l122.77"></a><span id="l122.77">   // determines where the thread is placed. We want it placed right at the</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l123.1"></a><span id="l123.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-savedsearch-reload-after-compact.js</span>
<a href="#l123.2"></a><span id="l123.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-savedsearch-reload-after-compact.js</span>
<a href="#l123.3"></a><span id="l123.3" class="difflineat">@@ -4,26 +4,28 @@</span>
<a href="#l123.4"></a><span id="l123.4"> </span>
<a href="#l123.5"></a><span id="l123.5"> /**</span>
<a href="#l123.6"></a><span id="l123.6">  * Test reload of saved searches over local folders after compaction</span>
<a href="#l123.7"></a><span id="l123.7">  * of local folders.</span>
<a href="#l123.8"></a><span id="l123.8">  */</span>
<a href="#l123.9"></a><span id="l123.9"> </span>
<a href="#l123.10"></a><span id="l123.10"> &quot;use strict&quot;;</span>
<a href="#l123.11"></a><span id="l123.11"> </span>
<a href="#l123.12"></a><span id="l123.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l123.13"></a><span id="l123.13" class="difflineminus">-</span>
<a href="#l123.14"></a><span id="l123.14" class="difflineminus">-var MODULE_NAME = &quot;test-savedsearch-reload-after-compact&quot;;</span>
<a href="#l123.15"></a><span id="l123.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l123.16"></a><span id="l123.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l123.17"></a><span id="l123.17" class="difflineminus">-</span>
<a href="#l123.18"></a><span id="l123.18" class="difflineminus">-function setupModule(module) {</span>
<a href="#l123.19"></a><span id="l123.19" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l123.20"></a><span id="l123.20" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l123.21"></a><span id="l123.21" class="difflineminus">-}</span>
<a href="#l123.22"></a><span id="l123.22" class="difflineplus">+var {</span>
<a href="#l123.23"></a><span id="l123.23" class="difflineplus">+  be_in_folder,</span>
<a href="#l123.24"></a><span id="l123.24" class="difflineplus">+  create_folder,</span>
<a href="#l123.25"></a><span id="l123.25" class="difflineplus">+  create_virtual_folder,</span>
<a href="#l123.26"></a><span id="l123.26" class="difflineplus">+  inboxFolder,</span>
<a href="#l123.27"></a><span id="l123.27" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l123.28"></a><span id="l123.28" class="difflineplus">+  mc,</span>
<a href="#l123.29"></a><span id="l123.29" class="difflineplus">+  press_delete,</span>
<a href="#l123.30"></a><span id="l123.30" class="difflineplus">+  select_click_row,</span>
<a href="#l123.31"></a><span id="l123.31" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l123.32"></a><span id="l123.32" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l123.33"></a><span id="l123.33" class="difflineplus">+);</span>
<a href="#l123.34"></a><span id="l123.34"> </span>
<a href="#l123.35"></a><span id="l123.35"> /**</span>
<a href="#l123.36"></a><span id="l123.36">  * Add some messages to a folder, delete the first one, and create a saved</span>
<a href="#l123.37"></a><span id="l123.37">  * search over the inbox and the folder. Then, compact folders.</span>
<a href="#l123.38"></a><span id="l123.38">  */</span>
<a href="#l123.39"></a><span id="l123.39"> function test_setup_virtual_folder_and_compact() {</span>
<a href="#l123.40"></a><span id="l123.40">   let otherFolder = create_folder(&quot;otherFolder&quot;);</span>
<a href="#l123.41"></a><span id="l123.41">   make_new_sets_in_folder(otherFolder, [{ count: 2 }]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l124.1"></a><span id="l124.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-selection.js</span>
<a href="#l124.2"></a><span id="l124.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-selection.js</span>
<a href="#l124.3"></a><span id="l124.3" class="difflineat">@@ -1,28 +1,48 @@</span>
<a href="#l124.4"></a><span id="l124.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l124.5"></a><span id="l124.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l124.6"></a><span id="l124.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l124.7"></a><span id="l124.7"> </span>
<a href="#l124.8"></a><span id="l124.8"> &quot;use strict&quot;;</span>
<a href="#l124.9"></a><span id="l124.9"> </span>
<a href="#l124.10"></a><span id="l124.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l124.11"></a><span id="l124.11" class="difflineminus">-</span>
<a href="#l124.12"></a><span id="l124.12" class="difflineminus">-var MODULE_NAME = &quot;test-selection&quot;;</span>
<a href="#l124.13"></a><span id="l124.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l124.14"></a><span id="l124.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l124.15"></a><span id="l124.15" class="difflineplus">+var {</span>
<a href="#l124.16"></a><span id="l124.16" class="difflineplus">+  assert_nothing_selected,</span>
<a href="#l124.17"></a><span id="l124.17" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l124.18"></a><span id="l124.18" class="difflineplus">+  assert_visible,</span>
<a href="#l124.19"></a><span id="l124.19" class="difflineplus">+  be_in_folder,</span>
<a href="#l124.20"></a><span id="l124.20" class="difflineplus">+  close_tab,</span>
<a href="#l124.21"></a><span id="l124.21" class="difflineplus">+  create_folder,</span>
<a href="#l124.22"></a><span id="l124.22" class="difflineplus">+  delete_via_popup,</span>
<a href="#l124.23"></a><span id="l124.23" class="difflineplus">+  enter_folder,</span>
<a href="#l124.24"></a><span id="l124.24" class="difflineplus">+  make_display_grouped,</span>
<a href="#l124.25"></a><span id="l124.25" class="difflineplus">+  make_display_threaded,</span>
<a href="#l124.26"></a><span id="l124.26" class="difflineplus">+  make_display_unthreaded,</span>
<a href="#l124.27"></a><span id="l124.27" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l124.28"></a><span id="l124.28" class="difflineplus">+  make_new_sets_in_folders,</span>
<a href="#l124.29"></a><span id="l124.29" class="difflineplus">+  mc,</span>
<a href="#l124.30"></a><span id="l124.30" class="difflineplus">+  open_folder_in_new_tab,</span>
<a href="#l124.31"></a><span id="l124.31" class="difflineplus">+  press_delete,</span>
<a href="#l124.32"></a><span id="l124.32" class="difflineplus">+  right_click_on_row,</span>
<a href="#l124.33"></a><span id="l124.33" class="difflineplus">+  select_click_row,</span>
<a href="#l124.34"></a><span id="l124.34" class="difflineplus">+  select_column_click_row,</span>
<a href="#l124.35"></a><span id="l124.35" class="difflineplus">+  select_control_click_row,</span>
<a href="#l124.36"></a><span id="l124.36" class="difflineplus">+  select_none,</span>
<a href="#l124.37"></a><span id="l124.37" class="difflineplus">+  select_shift_click_row,</span>
<a href="#l124.38"></a><span id="l124.38" class="difflineplus">+  switch_tab,</span>
<a href="#l124.39"></a><span id="l124.39" class="difflineplus">+  wait_for_blank_content_pane,</span>
<a href="#l124.40"></a><span id="l124.40" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l124.41"></a><span id="l124.41" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l124.42"></a><span id="l124.42" class="difflineplus">+);</span>
<a href="#l124.43"></a><span id="l124.43"> </span>
<a href="#l124.44"></a><span id="l124.44"> // let us have 2 folders</span>
<a href="#l124.45"></a><span id="l124.45"> var folder = null,</span>
<a href="#l124.46"></a><span id="l124.46">   folder2 = null;</span>
<a href="#l124.47"></a><span id="l124.47"> </span>
<a href="#l124.48"></a><span id="l124.48"> var setupModule = function(module) {</span>
<a href="#l124.49"></a><span id="l124.49" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l124.50"></a><span id="l124.50" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l124.51"></a><span id="l124.51" class="difflineminus">-</span>
<a href="#l124.52"></a><span id="l124.52">   folder = create_folder(&quot;SelectionA&quot;);</span>
<a href="#l124.53"></a><span id="l124.53">   folder2 = create_folder(&quot;SelectionB&quot;);</span>
<a href="#l124.54"></a><span id="l124.54">   make_new_sets_in_folders([folder, folder2], [{ count: 50 }]);</span>
<a href="#l124.55"></a><span id="l124.55"> };</span>
<a href="#l124.56"></a><span id="l124.56"> </span>
<a href="#l124.57"></a><span id="l124.57"> // https://bugzilla.mozilla.org/show_bug.cgi?id=474701#c80</span>
<a href="#l124.58"></a><span id="l124.58"> function test_selection_on_entry() {</span>
<a href="#l124.59"></a><span id="l124.59">   enter_folder(folder);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l125.1"></a><span id="l125.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-summarization.js</span>
<a href="#l125.2"></a><span id="l125.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-summarization.js</span>
<a href="#l125.3"></a><span id="l125.3" class="difflineat">@@ -14,32 +14,60 @@</span>
<a href="#l125.4"></a><span id="l125.4">  *  tab tests may do the same thing too...)</span>
<a href="#l125.5"></a><span id="l125.5">  *</span>
<a href="#l125.6"></a><span id="l125.6">  * Things we don't test but should:</span>
<a href="#l125.7"></a><span id="l125.7">  * - The difference between thread summary and multi-message summary.</span>
<a href="#l125.8"></a><span id="l125.8">  */</span>
<a href="#l125.9"></a><span id="l125.9"> </span>
<a href="#l125.10"></a><span id="l125.10"> &quot;use strict&quot;;</span>
<a href="#l125.11"></a><span id="l125.11"> </span>
<a href="#l125.12"></a><span id="l125.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l125.13"></a><span id="l125.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l125.14"></a><span id="l125.14" class="difflineplus">+var { ensure_card_exists, ensure_no_card_exists } = ChromeUtils.import(</span>
<a href="#l125.15"></a><span id="l125.15" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l125.16"></a><span id="l125.16" class="difflineplus">+);</span>
<a href="#l125.17"></a><span id="l125.17" class="difflineplus">+var {</span>
<a href="#l125.18"></a><span id="l125.18" class="difflineplus">+  add_sets_to_folders,</span>
<a href="#l125.19"></a><span id="l125.19" class="difflineplus">+  assert_collapsed,</span>
<a href="#l125.20"></a><span id="l125.20" class="difflineplus">+  assert_expanded,</span>
<a href="#l125.21"></a><span id="l125.21" class="difflineplus">+  assert_messages_summarized,</span>
<a href="#l125.22"></a><span id="l125.22" class="difflineplus">+  assert_nothing_selected,</span>
<a href="#l125.23"></a><span id="l125.23" class="difflineplus">+  assert_selected,</span>
<a href="#l125.24"></a><span id="l125.24" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l125.25"></a><span id="l125.25" class="difflineplus">+  assert_summary_contains_N_elts,</span>
<a href="#l125.26"></a><span id="l125.26" class="difflineplus">+  be_in_folder,</span>
<a href="#l125.27"></a><span id="l125.27" class="difflineplus">+  close_tab,</span>
<a href="#l125.28"></a><span id="l125.28" class="difflineplus">+  collapse_all_threads,</span>
<a href="#l125.29"></a><span id="l125.29" class="difflineplus">+  create_folder,</span>
<a href="#l125.30"></a><span id="l125.30" class="difflineplus">+  create_thread,</span>
<a href="#l125.31"></a><span id="l125.31" class="difflineplus">+  create_virtual_folder,</span>
<a href="#l125.32"></a><span id="l125.32" class="difflineplus">+  make_display_threaded,</span>
<a href="#l125.33"></a><span id="l125.33" class="difflineplus">+  make_new_sets_in_folders,</span>
<a href="#l125.34"></a><span id="l125.34" class="difflineplus">+  mc,</span>
<a href="#l125.35"></a><span id="l125.35" class="difflineplus">+  open_folder_in_new_tab,</span>
<a href="#l125.36"></a><span id="l125.36" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l125.37"></a><span id="l125.37" class="difflineplus">+  plan_to_wait_for_folder_events,</span>
<a href="#l125.38"></a><span id="l125.38" class="difflineplus">+  select_click_row,</span>
<a href="#l125.39"></a><span id="l125.39" class="difflineplus">+  select_control_click_row,</span>
<a href="#l125.40"></a><span id="l125.40" class="difflineplus">+  select_none,</span>
<a href="#l125.41"></a><span id="l125.41" class="difflineplus">+  select_shift_click_row,</span>
<a href="#l125.42"></a><span id="l125.42" class="difflineplus">+  switch_tab,</span>
<a href="#l125.43"></a><span id="l125.43" class="difflineplus">+  toggle_thread_row,</span>
<a href="#l125.44"></a><span id="l125.44" class="difflineplus">+  wait_for_blank_content_pane,</span>
<a href="#l125.45"></a><span id="l125.45" class="difflineplus">+  wait_for_folder_events,</span>
<a href="#l125.46"></a><span id="l125.46" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l125.47"></a><span id="l125.47" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l125.48"></a><span id="l125.48" class="difflineplus">+);</span>
<a href="#l125.49"></a><span id="l125.49"> </span>
<a href="#l125.50"></a><span id="l125.50" class="difflineminus">-var MODULE_NAME = &quot;test-summarization&quot;;</span>
<a href="#l125.51"></a><span id="l125.51" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l125.52"></a><span id="l125.52" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;address-book-helpers&quot;];</span>
<a href="#l125.53"></a><span id="l125.53" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l125.54"></a><span id="l125.54" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l125.55"></a><span id="l125.55" class="difflineplus">+);</span>
<a href="#l125.56"></a><span id="l125.56"> </span>
<a href="#l125.57"></a><span id="l125.57"> var folder;</span>
<a href="#l125.58"></a><span id="l125.58"> var thread1, thread2, msg1, msg2;</span>
<a href="#l125.59"></a><span id="l125.59"> </span>
<a href="#l125.60"></a><span id="l125.60"> var setupModule = function(module) {</span>
<a href="#l125.61"></a><span id="l125.61" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l125.62"></a><span id="l125.62" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l125.63"></a><span id="l125.63" class="difflineminus">-  let abh = collector.getModule(&quot;address-book-helpers&quot;);</span>
<a href="#l125.64"></a><span id="l125.64" class="difflineminus">-  abh.installInto(module);</span>
<a href="#l125.65"></a><span id="l125.65" class="difflineminus">-</span>
<a href="#l125.66"></a><span id="l125.66">   folder = create_folder(&quot;SummarizationA&quot;);</span>
<a href="#l125.67"></a><span id="l125.67">   thread1 = create_thread(10);</span>
<a href="#l125.68"></a><span id="l125.68">   msg1 = create_thread(1);</span>
<a href="#l125.69"></a><span id="l125.69">   thread2 = create_thread(10);</span>
<a href="#l125.70"></a><span id="l125.70">   msg2 = create_thread(1);</span>
<a href="#l125.71"></a><span id="l125.71">   add_sets_to_folders([folder], [thread1, msg1, thread2, msg2]);</span>
<a href="#l125.72"></a><span id="l125.72"> };</span>
<a href="#l125.73"></a><span id="l125.73"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l126.1"></a><span id="l126.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-tabs-simple.js</span>
<a href="#l126.2"></a><span id="l126.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-tabs-simple.js</span>
<a href="#l126.3"></a><span id="l126.3" class="difflineat">@@ -8,28 +8,43 @@</span>
<a href="#l126.4"></a><span id="l126.4">  * transitions at one point; I (asuth) am changing our test infrastructure to</span>
<a href="#l126.5"></a><span id="l126.5">  * cause more realistic focus changes so those changes now look sillier</span>
<a href="#l126.6"></a><span id="l126.6">  * because in many cases we are explicitly setting focus back after the thread</span>
<a href="#l126.7"></a><span id="l126.7">  * tree gains focus.</span>
<a href="#l126.8"></a><span id="l126.8">  */</span>
<a href="#l126.9"></a><span id="l126.9"> </span>
<a href="#l126.10"></a><span id="l126.10"> &quot;use strict&quot;;</span>
<a href="#l126.11"></a><span id="l126.11"> </span>
<a href="#l126.12"></a><span id="l126.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l126.13"></a><span id="l126.13" class="difflineminus">-</span>
<a href="#l126.14"></a><span id="l126.14" class="difflineminus">-var MODULE_NAME = &quot;test-tabs-simple&quot;;</span>
<a href="#l126.15"></a><span id="l126.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l126.16"></a><span id="l126.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l126.17"></a><span id="l126.17" class="difflineplus">+var {</span>
<a href="#l126.18"></a><span id="l126.18" class="difflineplus">+  assert_folder_tree_focused,</span>
<a href="#l126.19"></a><span id="l126.19" class="difflineplus">+  assert_message_pane_focused,</span>
<a href="#l126.20"></a><span id="l126.20" class="difflineplus">+  assert_messages_in_view,</span>
<a href="#l126.21"></a><span id="l126.21" class="difflineplus">+  assert_nothing_selected,</span>
<a href="#l126.22"></a><span id="l126.22" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l126.23"></a><span id="l126.23" class="difflineplus">+  assert_thread_tree_focused,</span>
<a href="#l126.24"></a><span id="l126.24" class="difflineplus">+  be_in_folder,</span>
<a href="#l126.25"></a><span id="l126.25" class="difflineplus">+  close_tab,</span>
<a href="#l126.26"></a><span id="l126.26" class="difflineplus">+  create_folder,</span>
<a href="#l126.27"></a><span id="l126.27" class="difflineplus">+  focus_folder_tree,</span>
<a href="#l126.28"></a><span id="l126.28" class="difflineplus">+  focus_message_pane,</span>
<a href="#l126.29"></a><span id="l126.29" class="difflineplus">+  focus_thread_tree,</span>
<a href="#l126.30"></a><span id="l126.30" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l126.31"></a><span id="l126.31" class="difflineplus">+  mc,</span>
<a href="#l126.32"></a><span id="l126.32" class="difflineplus">+  open_folder_in_new_tab,</span>
<a href="#l126.33"></a><span id="l126.33" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l126.34"></a><span id="l126.34" class="difflineplus">+  select_click_row,</span>
<a href="#l126.35"></a><span id="l126.35" class="difflineplus">+  switch_tab,</span>
<a href="#l126.36"></a><span id="l126.36" class="difflineplus">+  wait_for_blank_content_pane,</span>
<a href="#l126.37"></a><span id="l126.37" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l126.38"></a><span id="l126.38" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l126.39"></a><span id="l126.39" class="difflineplus">+);</span>
<a href="#l126.40"></a><span id="l126.40"> </span>
<a href="#l126.41"></a><span id="l126.41"> var folderA, folderB, setA, setB;</span>
<a href="#l126.42"></a><span id="l126.42"> </span>
<a href="#l126.43"></a><span id="l126.43"> function setupModule(module) {</span>
<a href="#l126.44"></a><span id="l126.44" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l126.45"></a><span id="l126.45" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l126.46"></a><span id="l126.46" class="difflineminus">-</span>
<a href="#l126.47"></a><span id="l126.47">   folderA = create_folder(&quot;TabsSimpleA&quot;);</span>
<a href="#l126.48"></a><span id="l126.48">   folderB = create_folder(&quot;TabsSimpleB&quot;);</span>
<a href="#l126.49"></a><span id="l126.49"> </span>
<a href="#l126.50"></a><span id="l126.50">   // We will verify we are seeing the right folder by checking that it has the</span>
<a href="#l126.51"></a><span id="l126.51">   //  right messages in it.</span>
<a href="#l126.52"></a><span id="l126.52">   [setA] = make_new_sets_in_folder(folderA, [{}]);</span>
<a href="#l126.53"></a><span id="l126.53">   [setB] = make_new_sets_in_folder(folderB, [{}]);</span>
<a href="#l126.54"></a><span id="l126.54"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l127.1"></a><span id="l127.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-virtual-folder-commands.js</span>
<a href="#l127.2"></a><span id="l127.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-virtual-folder-commands.js</span>
<a href="#l127.3"></a><span id="l127.3" class="difflineat">@@ -3,30 +3,34 @@</span>
<a href="#l127.4"></a><span id="l127.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l127.5"></a><span id="l127.5"> </span>
<a href="#l127.6"></a><span id="l127.6"> /*</span>
<a href="#l127.7"></a><span id="l127.7">  * Test that commands on virtual folders work properly.</span>
<a href="#l127.8"></a><span id="l127.8">  */</span>
<a href="#l127.9"></a><span id="l127.9"> </span>
<a href="#l127.10"></a><span id="l127.10"> &quot;use strict&quot;;</span>
<a href="#l127.11"></a><span id="l127.11"> </span>
<a href="#l127.12"></a><span id="l127.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l127.13"></a><span id="l127.13" class="difflineminus">-</span>
<a href="#l127.14"></a><span id="l127.14" class="difflineminus">-var MODULE_NAME = &quot;test-virtual-folder-commands&quot;;</span>
<a href="#l127.15"></a><span id="l127.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l127.16"></a><span id="l127.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l127.17"></a><span id="l127.17" class="difflineplus">+var {</span>
<a href="#l127.18"></a><span id="l127.18" class="difflineplus">+  assert_true,</span>
<a href="#l127.19"></a><span id="l127.19" class="difflineplus">+  be_in_folder,</span>
<a href="#l127.20"></a><span id="l127.20" class="difflineplus">+  expand_all_threads,</span>
<a href="#l127.21"></a><span id="l127.21" class="difflineplus">+  make_display_threaded,</span>
<a href="#l127.22"></a><span id="l127.22" class="difflineplus">+  make_folder_with_sets,</span>
<a href="#l127.23"></a><span id="l127.23" class="difflineplus">+  make_virtual_folder,</span>
<a href="#l127.24"></a><span id="l127.24" class="difflineplus">+  mc,</span>
<a href="#l127.25"></a><span id="l127.25" class="difflineplus">+  select_click_row,</span>
<a href="#l127.26"></a><span id="l127.26" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l127.27"></a><span id="l127.27" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l127.28"></a><span id="l127.28" class="difflineplus">+);</span>
<a href="#l127.29"></a><span id="l127.29"> </span>
<a href="#l127.30"></a><span id="l127.30"> var msgsPerThread = 5;</span>
<a href="#l127.31"></a><span id="l127.31"> var singleVirtFolder;</span>
<a href="#l127.32"></a><span id="l127.32"> var multiVirtFolder;</span>
<a href="#l127.33"></a><span id="l127.33"> </span>
<a href="#l127.34"></a><span id="l127.34"> function setupModule(module) {</span>
<a href="#l127.35"></a><span id="l127.35" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l127.36"></a><span id="l127.36" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l127.37"></a><span id="l127.37" class="difflineminus">-</span>
<a href="#l127.38"></a><span id="l127.38">   let [folderOne] = make_folder_with_sets([{ msgsPerThread }]);</span>
<a href="#l127.39"></a><span id="l127.39">   let [folderTwo] = make_folder_with_sets([{ msgsPerThread }]);</span>
<a href="#l127.40"></a><span id="l127.40"> </span>
<a href="#l127.41"></a><span id="l127.41">   singleVirtFolder = make_virtual_folder([folderOne], {});</span>
<a href="#l127.42"></a><span id="l127.42">   multiVirtFolder = make_virtual_folder([folderOne, folderTwo], {});</span>
<a href="#l127.43"></a><span id="l127.43"> }</span>
<a href="#l127.44"></a><span id="l127.44"> </span>
<a href="#l127.45"></a><span id="l127.45"> function test_single_folder_select_thread() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l128.1"></a><span id="l128.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-watch-ignore-thread.js</span>
<a href="#l128.2"></a><span id="l128.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-watch-ignore-thread.js</span>
<a href="#l128.3"></a><span id="l128.3" class="difflineat">@@ -3,28 +3,37 @@</span>
<a href="#l128.4"></a><span id="l128.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l128.5"></a><span id="l128.5"> </span>
<a href="#l128.6"></a><span id="l128.6"> /*</span>
<a href="#l128.7"></a><span id="l128.7">  * Test that &quot;watch thread&quot; and &quot;ignore thread&quot; works correctly.</span>
<a href="#l128.8"></a><span id="l128.8">  */</span>
<a href="#l128.9"></a><span id="l128.9"> </span>
<a href="#l128.10"></a><span id="l128.10"> &quot;use strict&quot;;</span>
<a href="#l128.11"></a><span id="l128.11"> </span>
<a href="#l128.12"></a><span id="l128.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l128.13"></a><span id="l128.13" class="difflineminus">-</span>
<a href="#l128.14"></a><span id="l128.14" class="difflineminus">-var MODULE_NAME = &quot;test-watch-ignore-thread&quot;;</span>
<a href="#l128.15"></a><span id="l128.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l128.16"></a><span id="l128.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l128.17"></a><span id="l128.17" class="difflineplus">+var {</span>
<a href="#l128.18"></a><span id="l128.18" class="difflineplus">+  add_sets_to_folders,</span>
<a href="#l128.19"></a><span id="l128.19" class="difflineplus">+  assert_not_shown,</span>
<a href="#l128.20"></a><span id="l128.20" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l128.21"></a><span id="l128.21" class="difflineplus">+  assert_visible,</span>
<a href="#l128.22"></a><span id="l128.22" class="difflineplus">+  be_in_folder,</span>
<a href="#l128.23"></a><span id="l128.23" class="difflineplus">+  create_folder,</span>
<a href="#l128.24"></a><span id="l128.24" class="difflineplus">+  create_thread,</span>
<a href="#l128.25"></a><span id="l128.25" class="difflineplus">+  expand_all_threads,</span>
<a href="#l128.26"></a><span id="l128.26" class="difflineplus">+  inboxFolder,</span>
<a href="#l128.27"></a><span id="l128.27" class="difflineplus">+  make_display_threaded,</span>
<a href="#l128.28"></a><span id="l128.28" class="difflineplus">+  mc,</span>
<a href="#l128.29"></a><span id="l128.29" class="difflineplus">+  select_click_row,</span>
<a href="#l128.30"></a><span id="l128.30" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l128.31"></a><span id="l128.31" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l128.32"></a><span id="l128.32" class="difflineplus">+);</span>
<a href="#l128.33"></a><span id="l128.33"> </span>
<a href="#l128.34"></a><span id="l128.34"> var folder;</span>
<a href="#l128.35"></a><span id="l128.35"> var thread1, thread2, thread3;</span>
<a href="#l128.36"></a><span id="l128.36"> </span>
<a href="#l128.37"></a><span id="l128.37"> function setupModule(module) {</span>
<a href="#l128.38"></a><span id="l128.38" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l128.39"></a><span id="l128.39" class="difflineminus">-</span>
<a href="#l128.40"></a><span id="l128.40">   folder = create_folder(&quot;WatchIgnoreThreadTest&quot;);</span>
<a href="#l128.41"></a><span id="l128.41">   thread1 = create_thread(3);</span>
<a href="#l128.42"></a><span id="l128.42">   thread2 = create_thread(4);</span>
<a href="#l128.43"></a><span id="l128.43">   thread3 = create_thread(5);</span>
<a href="#l128.44"></a><span id="l128.44">   add_sets_to_folders([folder], [thread1, thread2, thread3]);</span>
<a href="#l128.45"></a><span id="l128.45"> </span>
<a href="#l128.46"></a><span id="l128.46">   be_in_folder(folder);</span>
<a href="#l128.47"></a><span id="l128.47">   make_display_threaded();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l129.1"></a><span id="l129.1" class="difflineminus">--- a/mail/test/mozmill/folder-pane/test-display-message-with-folder-modes.js</span>
<a href="#l129.2"></a><span id="l129.2" class="difflineplus">+++ b/mail/test/mozmill/folder-pane/test-display-message-with-folder-modes.js</span>
<a href="#l129.3"></a><span id="l129.3" class="difflineat">@@ -9,32 +9,47 @@</span>
<a href="#l129.4"></a><span id="l129.4">  *   current folder mode</span>
<a href="#l129.5"></a><span id="l129.5">  * - not switching otherwise</span>
<a href="#l129.6"></a><span id="l129.6">  * - making sure that we're able to expand the right folders in the smart folder</span>
<a href="#l129.7"></a><span id="l129.7">  *   mode</span>
<a href="#l129.8"></a><span id="l129.8">  */</span>
<a href="#l129.9"></a><span id="l129.9"> </span>
<a href="#l129.10"></a><span id="l129.10"> &quot;use strict&quot;;</span>
<a href="#l129.11"></a><span id="l129.11"> </span>
<a href="#l129.12"></a><span id="l129.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l129.13"></a><span id="l129.13" class="difflineminus">-</span>
<a href="#l129.14"></a><span id="l129.14" class="difflineminus">-var MODULE_NAME = &quot;test-display-message-with-folder-modes&quot;;</span>
<a href="#l129.15"></a><span id="l129.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l129.16"></a><span id="l129.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l129.17"></a><span id="l129.17" class="difflineplus">+var {</span>
<a href="#l129.18"></a><span id="l129.18" class="difflineplus">+  assert_folder_child_in_view,</span>
<a href="#l129.19"></a><span id="l129.19" class="difflineplus">+  assert_folder_collapsed,</span>
<a href="#l129.20"></a><span id="l129.20" class="difflineplus">+  assert_folder_expanded,</span>
<a href="#l129.21"></a><span id="l129.21" class="difflineplus">+  assert_folder_mode,</span>
<a href="#l129.22"></a><span id="l129.22" class="difflineplus">+  assert_folder_not_visible,</span>
<a href="#l129.23"></a><span id="l129.23" class="difflineplus">+  assert_folder_selected_and_displayed,</span>
<a href="#l129.24"></a><span id="l129.24" class="difflineplus">+  assert_folder_tree_view_row_count,</span>
<a href="#l129.25"></a><span id="l129.25" class="difflineplus">+  assert_folder_visible,</span>
<a href="#l129.26"></a><span id="l129.26" class="difflineplus">+  assert_message_not_in_view,</span>
<a href="#l129.27"></a><span id="l129.27" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l129.28"></a><span id="l129.28" class="difflineplus">+  be_in_folder,</span>
<a href="#l129.29"></a><span id="l129.29" class="difflineplus">+  collapse_folder,</span>
<a href="#l129.30"></a><span id="l129.30" class="difflineplus">+  display_message_in_folder_tab,</span>
<a href="#l129.31"></a><span id="l129.31" class="difflineplus">+  get_smart_folder_named,</span>
<a href="#l129.32"></a><span id="l129.32" class="difflineplus">+  inboxFolder,</span>
<a href="#l129.33"></a><span id="l129.33" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l129.34"></a><span id="l129.34" class="difflineplus">+  mc,</span>
<a href="#l129.35"></a><span id="l129.35" class="difflineplus">+  select_none,</span>
<a href="#l129.36"></a><span id="l129.36" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l129.37"></a><span id="l129.37" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l129.38"></a><span id="l129.38" class="difflineplus">+);</span>
<a href="#l129.39"></a><span id="l129.39"> </span>
<a href="#l129.40"></a><span id="l129.40"> var folder;</span>
<a href="#l129.41"></a><span id="l129.41"> var dummyFolder;</span>
<a href="#l129.42"></a><span id="l129.42"> var inbox2Folder;</span>
<a href="#l129.43"></a><span id="l129.43"> var smartInboxFolder;</span>
<a href="#l129.44"></a><span id="l129.44"> </span>
<a href="#l129.45"></a><span id="l129.45"> var msgHdr;</span>
<a href="#l129.46"></a><span id="l129.46"> </span>
<a href="#l129.47"></a><span id="l129.47"> function setupModule(module) {</span>
<a href="#l129.48"></a><span id="l129.48" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l129.49"></a><span id="l129.49" class="difflineminus">-</span>
<a href="#l129.50"></a><span id="l129.50">   assert_folder_mode(&quot;all&quot;);</span>
<a href="#l129.51"></a><span id="l129.51">   assert_folder_tree_view_row_count(7);</span>
<a href="#l129.52"></a><span id="l129.52"> </span>
<a href="#l129.53"></a><span id="l129.53">   // This is a subfolder of the inbox so that</span>
<a href="#l129.54"></a><span id="l129.54">   // test_display_message_in_smart_folder_mode_works is able to test that we</span>
<a href="#l129.55"></a><span id="l129.55">   // don't attempt to expand any inboxes.</span>
<a href="#l129.56"></a><span id="l129.56">   inboxFolder.createSubfolder(&quot;DisplayMessageWithFolderModesA&quot;, null);</span>
<a href="#l129.57"></a><span id="l129.57">   folder = inboxFolder.getChildNamed(&quot;DisplayMessageWithFolderModesA&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l130.1"></a><span id="l130.1" class="difflineminus">--- a/mail/test/mozmill/folder-pane/test-folder-names-in-recent-mode.js</span>
<a href="#l130.2"></a><span id="l130.2" class="difflineplus">+++ b/mail/test/mozmill/folder-pane/test-folder-names-in-recent-mode.js</span>
<a href="#l130.3"></a><span id="l130.3" class="difflineat">@@ -3,29 +3,34 @@</span>
<a href="#l130.4"></a><span id="l130.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l130.5"></a><span id="l130.5"> </span>
<a href="#l130.6"></a><span id="l130.6"> /**</span>
<a href="#l130.7"></a><span id="l130.7">  * Test that the folder names have account name appended when in &quot;recent&quot; view.</span>
<a href="#l130.8"></a><span id="l130.8">  */</span>
<a href="#l130.9"></a><span id="l130.9"> </span>
<a href="#l130.10"></a><span id="l130.10"> &quot;use strict&quot;;</span>
<a href="#l130.11"></a><span id="l130.11"> </span>
<a href="#l130.12"></a><span id="l130.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l130.13"></a><span id="l130.13" class="difflineplus">+var {</span>
<a href="#l130.14"></a><span id="l130.14" class="difflineplus">+  assert_folder_at_index_as,</span>
<a href="#l130.15"></a><span id="l130.15" class="difflineplus">+  assert_folder_mode,</span>
<a href="#l130.16"></a><span id="l130.16" class="difflineplus">+  assert_folder_tree_view_row_count,</span>
<a href="#l130.17"></a><span id="l130.17" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l130.18"></a><span id="l130.18" class="difflineplus">+  mc,</span>
<a href="#l130.19"></a><span id="l130.19" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l130.20"></a><span id="l130.20" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l130.21"></a><span id="l130.21" class="difflineplus">+);</span>
<a href="#l130.22"></a><span id="l130.22"> </span>
<a href="#l130.23"></a><span id="l130.23" class="difflineminus">-var MODULE_NAME = &quot;test-folder-names-in-recent-mode&quot;;</span>
<a href="#l130.24"></a><span id="l130.24" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l130.25"></a><span id="l130.25" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l130.26"></a><span id="l130.26" class="difflineminus">-</span>
<a href="#l130.27"></a><span id="l130.27" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l130.28"></a><span id="l130.28" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l130.29"></a><span id="l130.29" class="difflineplus">+);</span>
<a href="#l130.30"></a><span id="l130.30"> var { fixIterator } = ChromeUtils.import(</span>
<a href="#l130.31"></a><span id="l130.31">   &quot;resource:///modules/iteratorUtils.jsm&quot;</span>
<a href="#l130.32"></a><span id="l130.32"> );</span>
<a href="#l130.33"></a><span id="l130.33"> </span>
<a href="#l130.34"></a><span id="l130.34"> function setupModule(module) {</span>
<a href="#l130.35"></a><span id="l130.35" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l130.36"></a><span id="l130.36" class="difflineminus">-</span>
<a href="#l130.37"></a><span id="l130.37">   assert_folder_mode(&quot;all&quot;);</span>
<a href="#l130.38"></a><span id="l130.38">   assert_folder_tree_view_row_count(7);</span>
<a href="#l130.39"></a><span id="l130.39"> }</span>
<a href="#l130.40"></a><span id="l130.40"> </span>
<a href="#l130.41"></a><span id="l130.41"> function test_folder_names_in_recent_view_mode() {</span>
<a href="#l130.42"></a><span id="l130.42">   // We need 2 local accounts that have pristine folders with</span>
<a href="#l130.43"></a><span id="l130.43">   // unmodified times, so that it does not influence the</span>
<a href="#l130.44"></a><span id="l130.44">   // list of Recent folders. So clear out the most-recently-used time.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l131.1"></a><span id="l131.1" class="difflineminus">--- a/mail/test/mozmill/folder-pane/test-folder-pane-consumers.js</span>
<a href="#l131.2"></a><span id="l131.2" class="difflineplus">+++ b/mail/test/mozmill/folder-pane/test-folder-pane-consumers.js</span>
<a href="#l131.3"></a><span id="l131.3" class="difflineat">@@ -3,38 +3,33 @@</span>
<a href="#l131.4"></a><span id="l131.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l131.5"></a><span id="l131.5"> </span>
<a href="#l131.6"></a><span id="l131.6"> /*</span>
<a href="#l131.7"></a><span id="l131.7">  * Tests for other dialogs using the tree view implementation in folderPane.js.</span>
<a href="#l131.8"></a><span id="l131.8">  */</span>
<a href="#l131.9"></a><span id="l131.9"> </span>
<a href="#l131.10"></a><span id="l131.10"> &quot;use strict&quot;;</span>
<a href="#l131.11"></a><span id="l131.11"> </span>
<a href="#l131.12"></a><span id="l131.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l131.13"></a><span id="l131.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-nntp-helpers.js */</span>
<a href="#l131.14"></a><span id="l131.14" class="difflineminus">-</span>
<a href="#l131.15"></a><span id="l131.15" class="difflineminus">-var MODULE_NAME = &quot;test-folder-pane&quot;;</span>
<a href="#l131.16"></a><span id="l131.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l131.17"></a><span id="l131.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;nntp-helpers&quot;];</span>
<a href="#l131.18"></a><span id="l131.18" class="difflineminus">-</span>
<a href="#l131.19"></a><span id="l131.19" class="difflineplus">+var { assert_true, mc } = ChromeUtils.import(</span>
<a href="#l131.20"></a><span id="l131.20" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l131.21"></a><span id="l131.21" class="difflineplus">+);</span>
<a href="#l131.22"></a><span id="l131.22" class="difflineplus">+var { NNTP_PORT, setupLocalServer } = ChromeUtils.import(</span>
<a href="#l131.23"></a><span id="l131.23" class="difflineplus">+  &quot;resource://testing-common/mozmill/NNTPHelpers.jsm&quot;</span>
<a href="#l131.24"></a><span id="l131.24" class="difflineplus">+);</span>
<a href="#l131.25"></a><span id="l131.25"> var { plan_for_modal_dialog, wait_for_modal_dialog } = ChromeUtils.import(</span>
<a href="#l131.26"></a><span id="l131.26">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l131.27"></a><span id="l131.27"> );</span>
<a href="#l131.28"></a><span id="l131.28"> </span>
<a href="#l131.29"></a><span id="l131.29"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l131.30"></a><span id="l131.30">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l131.31"></a><span id="l131.31"> );</span>
<a href="#l131.32"></a><span id="l131.32"> </span>
<a href="#l131.33"></a><span id="l131.33"> var nntpAccount;</span>
<a href="#l131.34"></a><span id="l131.34"> </span>
<a href="#l131.35"></a><span id="l131.35"> function setupModule(module) {</span>
<a href="#l131.36"></a><span id="l131.36" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l131.37"></a><span id="l131.37" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l131.38"></a><span id="l131.38" class="difflineminus">-  }</span>
<a href="#l131.39"></a><span id="l131.39" class="difflineminus">-</span>
<a href="#l131.40"></a><span id="l131.40">   let server = setupLocalServer(NNTP_PORT);</span>
<a href="#l131.41"></a><span id="l131.41">   nntpAccount = MailServices.accounts.FindAccountForServer(server);</span>
<a href="#l131.42"></a><span id="l131.42"> }</span>
<a href="#l131.43"></a><span id="l131.43"> </span>
<a href="#l131.44"></a><span id="l131.44"> function test_virtual_folder_selection_tree() {</span>
<a href="#l131.45"></a><span id="l131.45">   plan_for_modal_dialog(</span>
<a href="#l131.46"></a><span id="l131.46">     &quot;mailnews:virtualFolderProperties&quot;,</span>
<a href="#l131.47"></a><span id="l131.47">     subtest_create_virtual_folder</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l132.1"></a><span id="l132.1" class="difflineminus">--- a/mail/test/mozmill/folder-pane/test-folder-pane.js</span>
<a href="#l132.2"></a><span id="l132.2" class="difflineplus">+++ b/mail/test/mozmill/folder-pane/test-folder-pane.js</span>
<a href="#l132.3"></a><span id="l132.3" class="difflineat">@@ -5,31 +5,35 @@</span>
<a href="#l132.4"></a><span id="l132.4"> /*</span>
<a href="#l132.5"></a><span id="l132.5">  * Tests for the folder pane, in particular the tree view. This is kept separate</span>
<a href="#l132.6"></a><span id="l132.6">  * from the main folder-display suite so that the folders created by other tests</span>
<a href="#l132.7"></a><span id="l132.7">  * there don't influence the results here.</span>
<a href="#l132.8"></a><span id="l132.8">  */</span>
<a href="#l132.9"></a><span id="l132.9"> </span>
<a href="#l132.10"></a><span id="l132.10"> &quot;use strict&quot;;</span>
<a href="#l132.11"></a><span id="l132.11"> </span>
<a href="#l132.12"></a><span id="l132.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l132.13"></a><span id="l132.13" class="difflineminus">-</span>
<a href="#l132.14"></a><span id="l132.14" class="difflineminus">-var MODULE_NAME = &quot;test-folder-pane&quot;;</span>
<a href="#l132.15"></a><span id="l132.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l132.16"></a><span id="l132.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l132.17"></a><span id="l132.17" class="difflineplus">+var {</span>
<a href="#l132.18"></a><span id="l132.18" class="difflineplus">+  FAKE_SERVER_HOSTNAME,</span>
<a href="#l132.19"></a><span id="l132.19" class="difflineplus">+  assert_folder_mode,</span>
<a href="#l132.20"></a><span id="l132.20" class="difflineplus">+  assert_folder_tree_view_row_count,</span>
<a href="#l132.21"></a><span id="l132.21" class="difflineplus">+  be_in_folder,</span>
<a href="#l132.22"></a><span id="l132.22" class="difflineplus">+  collapse_folder,</span>
<a href="#l132.23"></a><span id="l132.23" class="difflineplus">+  create_folder,</span>
<a href="#l132.24"></a><span id="l132.24" class="difflineplus">+  enter_folder,</span>
<a href="#l132.25"></a><span id="l132.25" class="difflineplus">+  expand_folder,</span>
<a href="#l132.26"></a><span id="l132.26" class="difflineplus">+  mc,</span>
<a href="#l132.27"></a><span id="l132.27" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l132.28"></a><span id="l132.28" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l132.29"></a><span id="l132.29" class="difflineplus">+);</span>
<a href="#l132.30"></a><span id="l132.30"> </span>
<a href="#l132.31"></a><span id="l132.31"> var { MailUtils } = ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l132.32"></a><span id="l132.32"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l132.33"></a><span id="l132.33">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l132.34"></a><span id="l132.34"> );</span>
<a href="#l132.35"></a><span id="l132.35"> </span>
<a href="#l132.36"></a><span id="l132.36" class="difflineminus">-function setupModule(module) {</span>
<a href="#l132.37"></a><span id="l132.37" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l132.38"></a><span id="l132.38" class="difflineminus">-}</span>
<a href="#l132.39"></a><span id="l132.39" class="difflineminus">-</span>
<a href="#l132.40"></a><span id="l132.40"> /**</span>
<a href="#l132.41"></a><span id="l132.41">  * Assert the Folder Pane is in All Folder mode by default.  Check that the</span>
<a href="#l132.42"></a><span id="l132.42">  * correct number of rows for accounts and folders are always shown as new</span>
<a href="#l132.43"></a><span id="l132.43">  * folders are created, expanded, and collapsed.</span>
<a href="#l132.44"></a><span id="l132.44">  */</span>
<a href="#l132.45"></a><span id="l132.45"> function test_all_folders_toggle_folder_open_state() {</span>
<a href="#l132.46"></a><span id="l132.46">   // Test that we are in All Folders mode by default</span>
<a href="#l132.47"></a><span id="l132.47">   assert_folder_mode(&quot;all&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l133.1"></a><span id="l133.1" class="difflineminus">--- a/mail/test/mozmill/folder-tree-modes/test-custom-folder-tree-mode.js</span>
<a href="#l133.2"></a><span id="l133.2" class="difflineplus">+++ b/mail/test/mozmill/folder-tree-modes/test-custom-folder-tree-mode.js</span>
<a href="#l133.3"></a><span id="l133.3" class="difflineat">@@ -5,35 +5,38 @@</span>
<a href="#l133.4"></a><span id="l133.4"> </span>
<a href="#l133.5"></a><span id="l133.5"> /*</span>
<a href="#l133.6"></a><span id="l133.6">  * Tests for custom folder tree modes. The test mode is provided by the test</span>
<a href="#l133.7"></a><span id="l133.7">  * extension in the test-extension subdirectory.</span>
<a href="#l133.8"></a><span id="l133.8">  */</span>
<a href="#l133.9"></a><span id="l133.9"> </span>
<a href="#l133.10"></a><span id="l133.10"> &quot;use strict&quot;;</span>
<a href="#l133.11"></a><span id="l133.11"> </span>
<a href="#l133.12"></a><span id="l133.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l133.13"></a><span id="l133.13" class="difflineminus">-</span>
<a href="#l133.14"></a><span id="l133.14" class="difflineminus">-var MODULE_NAME = &quot;test-custom-folder-tree-mode&quot;;</span>
<a href="#l133.15"></a><span id="l133.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l133.16"></a><span id="l133.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l133.17"></a><span id="l133.17" class="difflineminus">-</span>
<a href="#l133.18"></a><span id="l133.18" class="difflineplus">+var {</span>
<a href="#l133.19"></a><span id="l133.19" class="difflineplus">+  assert_folder_mode,</span>
<a href="#l133.20"></a><span id="l133.20" class="difflineplus">+  assert_folder_visible,</span>
<a href="#l133.21"></a><span id="l133.21" class="difflineplus">+  FAKE_SERVER_HOSTNAME,</span>
<a href="#l133.22"></a><span id="l133.22" class="difflineplus">+  get_special_folder,</span>
<a href="#l133.23"></a><span id="l133.23" class="difflineplus">+  mc,</span>
<a href="#l133.24"></a><span id="l133.24" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l133.25"></a><span id="l133.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l133.26"></a><span id="l133.26" class="difflineplus">+);</span>
<a href="#l133.27"></a><span id="l133.27"> var {</span>
<a href="#l133.28"></a><span id="l133.28">   close_window,</span>
<a href="#l133.29"></a><span id="l133.29">   plan_for_new_window,</span>
<a href="#l133.30"></a><span id="l133.30">   wait_for_new_window,</span>
<a href="#l133.31"></a><span id="l133.31"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l133.32"></a><span id="l133.32"> </span>
<a href="#l133.33"></a><span id="l133.33" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l133.34"></a><span id="l133.34" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l133.35"></a><span id="l133.35" class="difflineplus">+);</span>
<a href="#l133.36"></a><span id="l133.36" class="difflineplus">+</span>
<a href="#l133.37"></a><span id="l133.37"> var gInbox;</span>
<a href="#l133.38"></a><span id="l133.38"> </span>
<a href="#l133.39"></a><span id="l133.39"> function setupModule(module) {</span>
<a href="#l133.40"></a><span id="l133.40" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l133.41"></a><span id="l133.41" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l133.42"></a><span id="l133.42" class="difflineminus">-  }</span>
<a href="#l133.43"></a><span id="l133.43" class="difflineminus">-</span>
<a href="#l133.44"></a><span id="l133.44">   let server = MailServices.accounts.FindServer(</span>
<a href="#l133.45"></a><span id="l133.45">     &quot;tinderbox&quot;,</span>
<a href="#l133.46"></a><span id="l133.46">     FAKE_SERVER_HOSTNAME,</span>
<a href="#l133.47"></a><span id="l133.47">     &quot;pop3&quot;</span>
<a href="#l133.48"></a><span id="l133.48">   );</span>
<a href="#l133.49"></a><span id="l133.49">   gInbox = get_special_folder(Ci.nsMsgFolderFlags.Inbox, false, server);</span>
<a href="#l133.50"></a><span id="l133.50"> }</span>
<a href="#l133.51"></a><span id="l133.51"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l134.1"></a><span id="l134.1" class="difflineminus">--- a/mail/test/mozmill/folder-tree-modes/test-custom-smart-folder.js</span>
<a href="#l134.2"></a><span id="l134.2" class="difflineplus">+++ b/mail/test/mozmill/folder-tree-modes/test-custom-smart-folder.js</span>
<a href="#l134.3"></a><span id="l134.3" class="difflineat">@@ -5,21 +5,33 @@</span>
<a href="#l134.4"></a><span id="l134.4"> </span>
<a href="#l134.5"></a><span id="l134.5"> /*</span>
<a href="#l134.6"></a><span id="l134.6">  * Tests for custom folder tree modes. The test mode is provided by the test</span>
<a href="#l134.7"></a><span id="l134.7">  * extension in the test-extension subdirectory.</span>
<a href="#l134.8"></a><span id="l134.8">  */</span>
<a href="#l134.9"></a><span id="l134.9"> </span>
<a href="#l134.10"></a><span id="l134.10"> &quot;use strict&quot;;</span>
<a href="#l134.11"></a><span id="l134.11"> </span>
<a href="#l134.12"></a><span id="l134.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l134.13"></a><span id="l134.13" class="difflineminus">-</span>
<a href="#l134.14"></a><span id="l134.14" class="difflineminus">-var MODULE_NAME = &quot;test-custom-smart-folder&quot;;</span>
<a href="#l134.15"></a><span id="l134.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l134.16"></a><span id="l134.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l134.17"></a><span id="l134.17" class="difflineplus">+var {</span>
<a href="#l134.18"></a><span id="l134.18" class="difflineplus">+  assert_folder_collapsed,</span>
<a href="#l134.19"></a><span id="l134.19" class="difflineplus">+  assert_folder_displayed,</span>
<a href="#l134.20"></a><span id="l134.20" class="difflineplus">+  assert_folder_expanded,</span>
<a href="#l134.21"></a><span id="l134.21" class="difflineplus">+  assert_folder_mode,</span>
<a href="#l134.22"></a><span id="l134.22" class="difflineplus">+  assert_folder_not_visible,</span>
<a href="#l134.23"></a><span id="l134.23" class="difflineplus">+  assert_folder_selected_and_displayed,</span>
<a href="#l134.24"></a><span id="l134.24" class="difflineplus">+  assert_folder_visible,</span>
<a href="#l134.25"></a><span id="l134.25" class="difflineplus">+  collapse_folder,</span>
<a href="#l134.26"></a><span id="l134.26" class="difflineplus">+  expand_folder,</span>
<a href="#l134.27"></a><span id="l134.27" class="difflineplus">+  get_smart_folder_named,</span>
<a href="#l134.28"></a><span id="l134.28" class="difflineplus">+  inboxFolder,</span>
<a href="#l134.29"></a><span id="l134.29" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l134.30"></a><span id="l134.30" class="difflineplus">+  mc,</span>
<a href="#l134.31"></a><span id="l134.31" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l134.32"></a><span id="l134.32" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l134.33"></a><span id="l134.33" class="difflineplus">+);</span>
<a href="#l134.34"></a><span id="l134.34"> </span>
<a href="#l134.35"></a><span id="l134.35"> // spaces in the name are intentional</span>
<a href="#l134.36"></a><span id="l134.36"> var smartParentNameA = &quot;My Smart Folder A&quot;;</span>
<a href="#l134.37"></a><span id="l134.37"> var smartParentNameB = &quot;My Smart Folder B&quot;;</span>
<a href="#l134.38"></a><span id="l134.38"> </span>
<a href="#l134.39"></a><span id="l134.39"> var rootFolder;</span>
<a href="#l134.40"></a><span id="l134.40"> var inboxSubfolder, subfolderA, subfolderB;</span>
<a href="#l134.41"></a><span id="l134.41"> var smartFolderInbox;</span>
<a href="#l134.42"></a><span id="l134.42" class="difflineat">@@ -27,19 +39,16 @@ var smartFolderA;</span>
<a href="#l134.43"></a><span id="l134.43"> </span>
<a href="#l134.44"></a><span id="l134.44"> var nsMsgFolderFlags = Ci.nsMsgFolderFlags;</span>
<a href="#l134.45"></a><span id="l134.45"> </span>
<a href="#l134.46"></a><span id="l134.46"> /**</span>
<a href="#l134.47"></a><span id="l134.47">  * create two smart folder types and two real folders, one for each</span>
<a href="#l134.48"></a><span id="l134.48">  * smart folder type</span>
<a href="#l134.49"></a><span id="l134.49">  */</span>
<a href="#l134.50"></a><span id="l134.50"> function setupModule(module) {</span>
<a href="#l134.51"></a><span id="l134.51" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l134.52"></a><span id="l134.52" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l134.53"></a><span id="l134.53" class="difflineminus">-</span>
<a href="#l134.54"></a><span id="l134.54">   rootFolder = inboxFolder.server.rootFolder;</span>
<a href="#l134.55"></a><span id="l134.55"> </span>
<a href="#l134.56"></a><span id="l134.56">   // register a new smart folder type</span>
<a href="#l134.57"></a><span id="l134.57">   mc.folderTreeView</span>
<a href="#l134.58"></a><span id="l134.58">     .getFolderTreeMode(&quot;smart&quot;)</span>
<a href="#l134.59"></a><span id="l134.59">     .addSmartFolderType(smartParentNameA, false, false);</span>
<a href="#l134.60"></a><span id="l134.60">   mc.folderTreeView</span>
<a href="#l134.61"></a><span id="l134.61">     .getFolderTreeMode(&quot;smart&quot;)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l135.1"></a><span id="l135.1" class="difflineminus">--- a/mail/test/mozmill/folder-tree-modes/test-mode-switching.js</span>
<a href="#l135.2"></a><span id="l135.2" class="difflineplus">+++ b/mail/test/mozmill/folder-tree-modes/test-mode-switching.js</span>
<a href="#l135.3"></a><span id="l135.3" class="difflineat">@@ -5,42 +5,45 @@</span>
<a href="#l135.4"></a><span id="l135.4"> /*</span>
<a href="#l135.5"></a><span id="l135.5">  * Bug 978592.</span>
<a href="#l135.6"></a><span id="l135.6">  * Test that switching folder modes via menu works and also compact versions</span>
<a href="#l135.7"></a><span id="l135.7">  * can be toggled properly.</span>
<a href="#l135.8"></a><span id="l135.8">  */</span>
<a href="#l135.9"></a><span id="l135.9"> </span>
<a href="#l135.10"></a><span id="l135.10"> &quot;use strict&quot;;</span>
<a href="#l135.11"></a><span id="l135.11"> </span>
<a href="#l135.12"></a><span id="l135.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l135.13"></a><span id="l135.13" class="difflineminus">-</span>
<a href="#l135.14"></a><span id="l135.14" class="difflineminus">-var MODULE_NAME = &quot;test-mode-switching&quot;;</span>
<a href="#l135.15"></a><span id="l135.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l135.16"></a><span id="l135.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l135.17"></a><span id="l135.17" class="difflineplus">+var {</span>
<a href="#l135.18"></a><span id="l135.18" class="difflineplus">+  assert_equals,</span>
<a href="#l135.19"></a><span id="l135.19" class="difflineplus">+  assert_folder_not_visible,</span>
<a href="#l135.20"></a><span id="l135.20" class="difflineplus">+  assert_folder_visible,</span>
<a href="#l135.21"></a><span id="l135.21" class="difflineplus">+  assert_true,</span>
<a href="#l135.22"></a><span id="l135.22" class="difflineplus">+  inboxFolder,</span>
<a href="#l135.23"></a><span id="l135.23" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l135.24"></a><span id="l135.24" class="difflineplus">+  mc,</span>
<a href="#l135.25"></a><span id="l135.25" class="difflineplus">+  select_no_folders,</span>
<a href="#l135.26"></a><span id="l135.26" class="difflineplus">+  toggle_main_menu,</span>
<a href="#l135.27"></a><span id="l135.27" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l135.28"></a><span id="l135.28" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l135.29"></a><span id="l135.29" class="difflineplus">+);</span>
<a href="#l135.30"></a><span id="l135.30"> </span>
<a href="#l135.31"></a><span id="l135.31"> var rootFolder;</span>
<a href="#l135.32"></a><span id="l135.32" class="difflineminus">-var inboxFolder;</span>
<a href="#l135.33"></a><span id="l135.33"> var unreadFolder;</span>
<a href="#l135.34"></a><span id="l135.34"> var favoriteFolder;</span>
<a href="#l135.35"></a><span id="l135.35"> var toggle_menu;</span>
<a href="#l135.36"></a><span id="l135.36"> var toggle_appmenu;</span>
<a href="#l135.37"></a><span id="l135.37"> var tree;</span>
<a href="#l135.38"></a><span id="l135.38"> var modeList_menu;</span>
<a href="#l135.39"></a><span id="l135.39"> var modeList_appmenu;</span>
<a href="#l135.40"></a><span id="l135.40"> var view_menu;</span>
<a href="#l135.41"></a><span id="l135.41"> var view_menupopup;</span>
<a href="#l135.42"></a><span id="l135.42"> var appmenu_button;</span>
<a href="#l135.43"></a><span id="l135.43"> var appmenu_mainView;</span>
<a href="#l135.44"></a><span id="l135.44"> var menu_state;</span>
<a href="#l135.45"></a><span id="l135.45"> </span>
<a href="#l135.46"></a><span id="l135.46"> function setupModule(module) {</span>
<a href="#l135.47"></a><span id="l135.47" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l135.48"></a><span id="l135.48" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l135.49"></a><span id="l135.49" class="difflineminus">-  }</span>
<a href="#l135.50"></a><span id="l135.50" class="difflineminus">-</span>
<a href="#l135.51"></a><span id="l135.51">   rootFolder = inboxFolder.server.rootFolder;</span>
<a href="#l135.52"></a><span id="l135.52"> </span>
<a href="#l135.53"></a><span id="l135.53">   // Create one folder with unread messages and one favorite folder.</span>
<a href="#l135.54"></a><span id="l135.54">   inboxFolder.createSubfolder(&quot;UnreadFolder&quot;, null);</span>
<a href="#l135.55"></a><span id="l135.55">   unreadFolder = inboxFolder.getChildNamed(&quot;UnreadFolder&quot;);</span>
<a href="#l135.56"></a><span id="l135.56"> </span>
<a href="#l135.57"></a><span id="l135.57">   inboxFolder.createSubfolder(&quot;FavoriteFolder&quot;, null);</span>
<a href="#l135.58"></a><span id="l135.58">   favoriteFolder = inboxFolder.getChildNamed(&quot;FavoriteFolder&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l136.1"></a><span id="l136.1" class="difflineminus">--- a/mail/test/mozmill/folder-tree-modes/test-smart-folders.js</span>
<a href="#l136.2"></a><span id="l136.2" class="difflineplus">+++ b/mail/test/mozmill/folder-tree-modes/test-smart-folders.js</span>
<a href="#l136.3"></a><span id="l136.3" class="difflineat">@@ -5,39 +5,54 @@</span>
<a href="#l136.4"></a><span id="l136.4"> /*</span>
<a href="#l136.5"></a><span id="l136.5">  * Test that the smart folder mode works properly. This includes checking</span>
<a href="#l136.6"></a><span id="l136.6">  * whether |getParentOfFolder| works, and also making sure selectFolder behaves</span>
<a href="#l136.7"></a><span id="l136.7">  * properly, opening the right folders.</span>
<a href="#l136.8"></a><span id="l136.8">  */</span>
<a href="#l136.9"></a><span id="l136.9"> </span>
<a href="#l136.10"></a><span id="l136.10"> &quot;use strict&quot;;</span>
<a href="#l136.11"></a><span id="l136.11"> </span>
<a href="#l136.12"></a><span id="l136.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l136.13"></a><span id="l136.13" class="difflineplus">+var {</span>
<a href="#l136.14"></a><span id="l136.14" class="difflineplus">+  archive_selected_messages,</span>
<a href="#l136.15"></a><span id="l136.15" class="difflineplus">+  assert_folder_child_in_view,</span>
<a href="#l136.16"></a><span id="l136.16" class="difflineplus">+  assert_folder_collapsed,</span>
<a href="#l136.17"></a><span id="l136.17" class="difflineplus">+  assert_folder_expanded,</span>
<a href="#l136.18"></a><span id="l136.18" class="difflineplus">+  assert_folder_selected_and_displayed,</span>
<a href="#l136.19"></a><span id="l136.19" class="difflineplus">+  be_in_folder,</span>
<a href="#l136.20"></a><span id="l136.20" class="difflineplus">+  collapse_folder,</span>
<a href="#l136.21"></a><span id="l136.21" class="difflineplus">+  delete_message_set,</span>
<a href="#l136.22"></a><span id="l136.22" class="difflineplus">+  expand_folder,</span>
<a href="#l136.23"></a><span id="l136.23" class="difflineplus">+  FAKE_SERVER_HOSTNAME,</span>
<a href="#l136.24"></a><span id="l136.24" class="difflineplus">+  get_smart_folder_named,</span>
<a href="#l136.25"></a><span id="l136.25" class="difflineplus">+  get_special_folder,</span>
<a href="#l136.26"></a><span id="l136.26" class="difflineplus">+  inboxFolder,</span>
<a href="#l136.27"></a><span id="l136.27" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l136.28"></a><span id="l136.28" class="difflineplus">+  mc,</span>
<a href="#l136.29"></a><span id="l136.29" class="difflineplus">+  select_click_row,</span>
<a href="#l136.30"></a><span id="l136.30" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l136.31"></a><span id="l136.31" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l136.32"></a><span id="l136.32" class="difflineplus">+);</span>
<a href="#l136.33"></a><span id="l136.33"> </span>
<a href="#l136.34"></a><span id="l136.34"> var { fixIterator } = ChromeUtils.import(</span>
<a href="#l136.35"></a><span id="l136.35">   &quot;resource:///modules/iteratorUtils.jsm&quot;</span>
<a href="#l136.36"></a><span id="l136.36"> );</span>
<a href="#l136.37"></a><span id="l136.37" class="difflineminus">-</span>
<a href="#l136.38"></a><span id="l136.38" class="difflineminus">-var MODULE_NAME = &quot;test-smart-folders&quot;;</span>
<a href="#l136.39"></a><span id="l136.39" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l136.40"></a><span id="l136.40" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l136.41"></a><span id="l136.41" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l136.42"></a><span id="l136.42" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l136.43"></a><span id="l136.43" class="difflineplus">+);</span>
<a href="#l136.44"></a><span id="l136.44"> </span>
<a href="#l136.45"></a><span id="l136.45"> var rootFolder;</span>
<a href="#l136.46"></a><span id="l136.46"> var inboxSubfolder;</span>
<a href="#l136.47"></a><span id="l136.47"> var trashFolder;</span>
<a href="#l136.48"></a><span id="l136.48"> var trashSubfolder;</span>
<a href="#l136.49"></a><span id="l136.49"> </span>
<a href="#l136.50"></a><span id="l136.50"> var smartInboxFolder;</span>
<a href="#l136.51"></a><span id="l136.51"> </span>
<a href="#l136.52"></a><span id="l136.52"> var inboxSet;</span>
<a href="#l136.53"></a><span id="l136.53"> </span>
<a href="#l136.54"></a><span id="l136.54"> function setupModule(module) {</span>
<a href="#l136.55"></a><span id="l136.55" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l136.56"></a><span id="l136.56" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l136.57"></a><span id="l136.57" class="difflineminus">-</span>
<a href="#l136.58"></a><span id="l136.58">   rootFolder = inboxFolder.server.rootFolder;</span>
<a href="#l136.59"></a><span id="l136.59"> </span>
<a href="#l136.60"></a><span id="l136.60">   // Create a folder as a subfolder of the inbox</span>
<a href="#l136.61"></a><span id="l136.61">   inboxFolder.createSubfolder(&quot;SmartFoldersA&quot;, null);</span>
<a href="#l136.62"></a><span id="l136.62">   inboxSubfolder = inboxFolder.getChildNamed(&quot;SmartFoldersA&quot;);</span>
<a href="#l136.63"></a><span id="l136.63"> </span>
<a href="#l136.64"></a><span id="l136.64">   trashFolder = inboxFolder.server.rootFolder.getFolderWithFlags(</span>
<a href="#l136.65"></a><span id="l136.65">     Ci.nsMsgFolderFlags.Trash</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l137.1"></a><span id="l137.1" class="difflineminus">--- a/mail/test/mozmill/folder-tree-modes/test-unread-folders.js</span>
<a href="#l137.2"></a><span id="l137.2" class="difflineplus">+++ b/mail/test/mozmill/folder-tree-modes/test-unread-folders.js</span>
<a href="#l137.3"></a><span id="l137.3" class="difflineat">@@ -5,32 +5,34 @@</span>
<a href="#l137.4"></a><span id="l137.4"> /*</span>
<a href="#l137.5"></a><span id="l137.5">  * Test that the unread folder mode works properly. This includes making</span>
<a href="#l137.6"></a><span id="l137.6">  * sure that the selected folder is maintained correctly when the view</span>
<a href="#l137.7"></a><span id="l137.7">  * is rebuilt because a folder has become newly unread.</span>
<a href="#l137.8"></a><span id="l137.8">  */</span>
<a href="#l137.9"></a><span id="l137.9"> </span>
<a href="#l137.10"></a><span id="l137.10"> &quot;use strict&quot;;</span>
<a href="#l137.11"></a><span id="l137.11"> </span>
<a href="#l137.12"></a><span id="l137.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l137.13"></a><span id="l137.13" class="difflineminus">-</span>
<a href="#l137.14"></a><span id="l137.14" class="difflineminus">-var MODULE_NAME = &quot;test-unread-folders&quot;;</span>
<a href="#l137.15"></a><span id="l137.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l137.16"></a><span id="l137.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l137.17"></a><span id="l137.17" class="difflineplus">+var {</span>
<a href="#l137.18"></a><span id="l137.18" class="difflineplus">+  assert_folder_visible,</span>
<a href="#l137.19"></a><span id="l137.19" class="difflineplus">+  be_in_folder,</span>
<a href="#l137.20"></a><span id="l137.20" class="difflineplus">+  delete_message_set,</span>
<a href="#l137.21"></a><span id="l137.21" class="difflineplus">+  inboxFolder,</span>
<a href="#l137.22"></a><span id="l137.22" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l137.23"></a><span id="l137.23" class="difflineplus">+  mc,</span>
<a href="#l137.24"></a><span id="l137.24" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l137.25"></a><span id="l137.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l137.26"></a><span id="l137.26" class="difflineplus">+);</span>
<a href="#l137.27"></a><span id="l137.27"> </span>
<a href="#l137.28"></a><span id="l137.28"> var rootFolder;</span>
<a href="#l137.29"></a><span id="l137.29"> var inboxSubfolder;</span>
<a href="#l137.30"></a><span id="l137.30"> var trashFolder;</span>
<a href="#l137.31"></a><span id="l137.31"> var trashSubfolder;</span>
<a href="#l137.32"></a><span id="l137.32"> var inboxSet;</span>
<a href="#l137.33"></a><span id="l137.33"> </span>
<a href="#l137.34"></a><span id="l137.34"> function setupModule(module) {</span>
<a href="#l137.35"></a><span id="l137.35" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l137.36"></a><span id="l137.36" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l137.37"></a><span id="l137.37" class="difflineminus">-</span>
<a href="#l137.38"></a><span id="l137.38">   rootFolder = inboxFolder.server.rootFolder;</span>
<a href="#l137.39"></a><span id="l137.39"> </span>
<a href="#l137.40"></a><span id="l137.40">   // Create a folder as a subfolder of the inbox</span>
<a href="#l137.41"></a><span id="l137.41">   inboxFolder.createSubfolder(&quot;UnreadFoldersA&quot;, null);</span>
<a href="#l137.42"></a><span id="l137.42">   inboxSubfolder = inboxFolder.getChildNamed(&quot;UnreadFoldersA&quot;);</span>
<a href="#l137.43"></a><span id="l137.43"> </span>
<a href="#l137.44"></a><span id="l137.44">   trashFolder = inboxFolder.server.rootFolder.getFolderWithFlags(</span>
<a href="#l137.45"></a><span id="l137.45">     Ci.nsMsgFolderFlags.Trash</span>
<a href="#l137.46"></a><span id="l137.46" class="difflineat">@@ -82,9 +84,10 @@ function test_newly_added_folder() {</span>
<a href="#l137.47"></a><span id="l137.47">   }</span>
<a href="#l137.48"></a><span id="l137.48">   delete_message_set(newSet);</span>
<a href="#l137.49"></a><span id="l137.49"> }</span>
<a href="#l137.50"></a><span id="l137.50"> </span>
<a href="#l137.51"></a><span id="l137.51"> function teardownModule() {</span>
<a href="#l137.52"></a><span id="l137.52">   inboxFolder.propagateDelete(inboxSubfolder, true, null);</span>
<a href="#l137.53"></a><span id="l137.53">   delete_message_set(inboxSet);</span>
<a href="#l137.54"></a><span id="l137.54">   trashFolder.propagateDelete(trashSubfolder, true, null);</span>
<a href="#l137.55"></a><span id="l137.55" class="difflineplus">+  mc.folderTreeView.mode = &quot;all&quot;;</span>
<a href="#l137.56"></a><span id="l137.56"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l138.1"></a><span id="l138.1" class="difflineminus">--- a/mail/test/mozmill/folder-widget/test-message-filters.js</span>
<a href="#l138.2"></a><span id="l138.2" class="difflineplus">+++ b/mail/test/mozmill/folder-widget/test-message-filters.js</span>
<a href="#l138.3"></a><span id="l138.3" class="difflineat">@@ -3,55 +3,60 @@</span>
<a href="#l138.4"></a><span id="l138.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l138.5"></a><span id="l138.5"> </span>
<a href="#l138.6"></a><span id="l138.6"> /*</span>
<a href="#l138.7"></a><span id="l138.7">  * Test various properties of the message filters.</span>
<a href="#l138.8"></a><span id="l138.8">  */</span>
<a href="#l138.9"></a><span id="l138.9"> </span>
<a href="#l138.10"></a><span id="l138.10"> &quot;use strict&quot;;</span>
<a href="#l138.11"></a><span id="l138.11"> </span>
<a href="#l138.12"></a><span id="l138.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l138.13"></a><span id="l138.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l138.14"></a><span id="l138.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-nntp-helpers.js */</span>
<a href="#l138.15"></a><span id="l138.15" class="difflineminus">-</span>
<a href="#l138.16"></a><span id="l138.16" class="difflineminus">-var MODULE_NAME = &quot;test-message-filters&quot;;</span>
<a href="#l138.17"></a><span id="l138.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l138.18"></a><span id="l138.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l138.19"></a><span id="l138.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l138.20"></a><span id="l138.20" class="difflineminus">-  &quot;nntp-helpers&quot;,</span>
<a href="#l138.21"></a><span id="l138.21" class="difflineminus">-  &quot;address-book-helpers&quot;,</span>
<a href="#l138.22"></a><span id="l138.22" class="difflineminus">-];</span>
<a href="#l138.23"></a><span id="l138.23" class="difflineminus">-</span>
<a href="#l138.24"></a><span id="l138.24"> var elib = ChromeUtils.import(</span>
<a href="#l138.25"></a><span id="l138.25">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l138.26"></a><span id="l138.26"> );</span>
<a href="#l138.27"></a><span id="l138.27"> </span>
<a href="#l138.28"></a><span id="l138.28" class="difflineplus">+var { create_ldap_address_book } = ChromeUtils.import(</span>
<a href="#l138.29"></a><span id="l138.29" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l138.30"></a><span id="l138.30" class="difflineplus">+);</span>
<a href="#l138.31"></a><span id="l138.31" class="difflineplus">+var {</span>
<a href="#l138.32"></a><span id="l138.32" class="difflineplus">+  assert_equals,</span>
<a href="#l138.33"></a><span id="l138.33" class="difflineplus">+  assert_false,</span>
<a href="#l138.34"></a><span id="l138.34" class="difflineplus">+  assert_not_equals,</span>
<a href="#l138.35"></a><span id="l138.35" class="difflineplus">+  assert_true,</span>
<a href="#l138.36"></a><span id="l138.36" class="difflineplus">+  be_in_folder,</span>
<a href="#l138.37"></a><span id="l138.37" class="difflineplus">+  close_popup,</span>
<a href="#l138.38"></a><span id="l138.38" class="difflineplus">+  create_folder,</span>
<a href="#l138.39"></a><span id="l138.39" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l138.40"></a><span id="l138.40" class="difflineplus">+  mc,</span>
<a href="#l138.41"></a><span id="l138.41" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l138.42"></a><span id="l138.42" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l138.43"></a><span id="l138.43" class="difflineplus">+);</span>
<a href="#l138.44"></a><span id="l138.44" class="difflineplus">+var { NNTP_PORT, setupLocalServer, setupNNTPDaemon } = ChromeUtils.import(</span>
<a href="#l138.45"></a><span id="l138.45" class="difflineplus">+  &quot;resource://testing-common/mozmill/NNTPHelpers.jsm&quot;</span>
<a href="#l138.46"></a><span id="l138.46" class="difflineplus">+);</span>
<a href="#l138.47"></a><span id="l138.47"> var {</span>
<a href="#l138.48"></a><span id="l138.48">   close_window,</span>
<a href="#l138.49"></a><span id="l138.49">   plan_for_modal_dialog,</span>
<a href="#l138.50"></a><span id="l138.50">   plan_for_new_window,</span>
<a href="#l138.51"></a><span id="l138.51">   plan_for_window_close,</span>
<a href="#l138.52"></a><span id="l138.52">   wait_for_existing_window,</span>
<a href="#l138.53"></a><span id="l138.53">   wait_for_modal_dialog,</span>
<a href="#l138.54"></a><span id="l138.54">   wait_for_new_window,</span>
<a href="#l138.55"></a><span id="l138.55">   wait_for_window_focused,</span>
<a href="#l138.56"></a><span id="l138.56">   wait_for_window_close,</span>
<a href="#l138.57"></a><span id="l138.57"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l138.58"></a><span id="l138.58"> </span>
<a href="#l138.59"></a><span id="l138.59"> var { gMockPromptService } = ChromeUtils.import(</span>
<a href="#l138.60"></a><span id="l138.60">   &quot;resource://testing-common/mozmill/PromptHelpers.jsm&quot;</span>
<a href="#l138.61"></a><span id="l138.61"> );</span>
<a href="#l138.62"></a><span id="l138.62"> </span>
<a href="#l138.63"></a><span id="l138.63" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l138.64"></a><span id="l138.64" class="difflineplus">+</span>
<a href="#l138.65"></a><span id="l138.65"> var folderA;</span>
<a href="#l138.66"></a><span id="l138.66"> </span>
<a href="#l138.67"></a><span id="l138.67"> function setupModule(module) {</span>
<a href="#l138.68"></a><span id="l138.68" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l138.69"></a><span id="l138.69" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l138.70"></a><span id="l138.70" class="difflineminus">-  }</span>
<a href="#l138.71"></a><span id="l138.71" class="difflineminus">-</span>
<a href="#l138.72"></a><span id="l138.72">   setupNNTPDaemon();</span>
<a href="#l138.73"></a><span id="l138.73"> </span>
<a href="#l138.74"></a><span id="l138.74">   folderA = create_folder(&quot;FolderToolbarA&quot;);</span>
<a href="#l138.75"></a><span id="l138.75">   // we need one message to select and open</span>
<a href="#l138.76"></a><span id="l138.76">   make_new_sets_in_folder(folderA, [{ count: 1 }]);</span>
<a href="#l138.77"></a><span id="l138.77"> </span>
<a href="#l138.78"></a><span id="l138.78">   setupLocalServer(NNTP_PORT);</span>
<a href="#l138.79"></a><span id="l138.79"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l139.1"></a><span id="l139.1" class="difflineminus">--- a/mail/test/mozmill/im/test-chat-tab-restore.js</span>
<a href="#l139.2"></a><span id="l139.2" class="difflineplus">+++ b/mail/test/mozmill/im/test-chat-tab-restore.js</span>
<a href="#l139.3"></a><span id="l139.3" class="difflineat">@@ -1,19 +1,19 @@</span>
<a href="#l139.4"></a><span id="l139.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l139.5"></a><span id="l139.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l139.6"></a><span id="l139.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l139.7"></a><span id="l139.7"> </span>
<a href="#l139.8"></a><span id="l139.8"> &quot;use strict&quot;;</span>
<a href="#l139.9"></a><span id="l139.9"> </span>
<a href="#l139.10"></a><span id="l139.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l139.11"></a><span id="l139.11" class="difflineplus">+var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l139.12"></a><span id="l139.12"> </span>
<a href="#l139.13"></a><span id="l139.13" class="difflineminus">-var MODULE_NAME = &quot;test-chat-tab-restore&quot;;</span>
<a href="#l139.14"></a><span id="l139.14" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l139.15"></a><span id="l139.15" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l139.16"></a><span id="l139.16" class="difflineplus">+var { assert_tab_mode_name, mark_action, mc } = ChromeUtils.import(</span>
<a href="#l139.17"></a><span id="l139.17" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l139.18"></a><span id="l139.18" class="difflineplus">+);</span>
<a href="#l139.19"></a><span id="l139.19"> </span>
<a href="#l139.20"></a><span id="l139.20"> /**</span>
<a href="#l139.21"></a><span id="l139.21">  * Create a new chat tab, making that tab the current tab. We block until the</span>
<a href="#l139.22"></a><span id="l139.22">  * message finishes loading. (Inspired by open_selected_message_in_new_tab)</span>
<a href="#l139.23"></a><span id="l139.23">  */</span>
<a href="#l139.24"></a><span id="l139.24"> function open_chat_tab() {</span>
<a href="#l139.25"></a><span id="l139.25">   // Get the current tab count so we can make sure the tab actually opened.</span>
<a href="#l139.26"></a><span id="l139.26">   let preCount = mc.tabmail.tabContainer.allTabs.length;</span>
<a href="#l139.27"></a><span id="l139.27" class="difflineat">@@ -53,20 +53,16 @@ function wait_for_chat_tab_to_open(aCont</span>
<a href="#l139.28"></a><span id="l139.28">   );</span>
<a href="#l139.29"></a><span id="l139.29"> </span>
<a href="#l139.30"></a><span id="l139.30">   // The above may return immediately, meaning the event queue might not get a</span>
<a href="#l139.31"></a><span id="l139.31">   // chance. Give it a chance now.</span>
<a href="#l139.32"></a><span id="l139.32">   aController.sleep(0);</span>
<a href="#l139.33"></a><span id="l139.33">   mark_action(&quot;imh&quot;, &quot;/wait_for_chat_tab_to_open&quot;, []);</span>
<a href="#l139.34"></a><span id="l139.34"> }</span>
<a href="#l139.35"></a><span id="l139.35"> </span>
<a href="#l139.36"></a><span id="l139.36" class="difflineminus">-function setupModule(module) {</span>
<a href="#l139.37"></a><span id="l139.37" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l139.38"></a><span id="l139.38" class="difflineminus">-}</span>
<a href="#l139.39"></a><span id="l139.39" class="difflineminus">-</span>
<a href="#l139.40"></a><span id="l139.40"> /*</span>
<a href="#l139.41"></a><span id="l139.41">  * This tests that the chat tab is restored properly after tabs are</span>
<a href="#l139.42"></a><span id="l139.42">  * serialized. As for folder tabs, we can't test a restart (can we ?), so we</span>
<a href="#l139.43"></a><span id="l139.43">  * just test the persist/restore cycle.</span>
<a href="#l139.44"></a><span id="l139.44">  */</span>
<a href="#l139.45"></a><span id="l139.45"> function test_chat_tab_restore() {</span>
<a href="#l139.46"></a><span id="l139.46">   // Close everything but the first tab.</span>
<a href="#l139.47"></a><span id="l139.47">   let closeTabs = function() {</span>
<a href="#l139.48"></a><span id="l139.48" class="difflineat">@@ -83,9 +79,11 @@ function test_chat_tab_restore() {</span>
<a href="#l139.49"></a><span id="l139.49">   if (mc.tabmail.tabContainer.allTabs.length &lt; 2) {</span>
<a href="#l139.50"></a><span id="l139.50">     throw new Error(&quot;The tab is not restored!&quot;);</span>
<a href="#l139.51"></a><span id="l139.51">   }</span>
<a href="#l139.52"></a><span id="l139.52"> </span>
<a href="#l139.53"></a><span id="l139.53">   let tabTypes = [&quot;folder&quot;, &quot;chat&quot;];</span>
<a href="#l139.54"></a><span id="l139.54">   for (let i in tabTypes) {</span>
<a href="#l139.55"></a><span id="l139.55">     assert_tab_mode_name(mc.tabmail.tabInfo[i], tabTypes[i]);</span>
<a href="#l139.56"></a><span id="l139.56">   }</span>
<a href="#l139.57"></a><span id="l139.57" class="difflineplus">+</span>
<a href="#l139.58"></a><span id="l139.58" class="difflineplus">+  closeTabs();</span>
<a href="#l139.59"></a><span id="l139.59"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l140.1"></a><span id="l140.1" class="difflineminus">--- a/mail/test/mozmill/im/test-toolbar-buttons.js</span>
<a href="#l140.2"></a><span id="l140.2" class="difflineplus">+++ b/mail/test/mozmill/im/test-toolbar-buttons.js</span>
<a href="#l140.3"></a><span id="l140.3" class="difflineat">@@ -1,26 +1,26 @@</span>
<a href="#l140.4"></a><span id="l140.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l140.5"></a><span id="l140.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l140.6"></a><span id="l140.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l140.7"></a><span id="l140.7"> </span>
<a href="#l140.8"></a><span id="l140.8"> &quot;use strict&quot;;</span>
<a href="#l140.9"></a><span id="l140.9"> </span>
<a href="#l140.10"></a><span id="l140.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l140.11"></a><span id="l140.11" class="difflineminus">-</span>
<a href="#l140.12"></a><span id="l140.12" class="difflineminus">-var MODULE_NAME = &quot;test-toolbar-buttons&quot;;</span>
<a href="#l140.13"></a><span id="l140.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l140.14"></a><span id="l140.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l140.15"></a><span id="l140.15" class="difflineplus">+var {</span>
<a href="#l140.16"></a><span id="l140.16" class="difflineplus">+  assert_equals,</span>
<a href="#l140.17"></a><span id="l140.17" class="difflineplus">+  assert_false,</span>
<a href="#l140.18"></a><span id="l140.18" class="difflineplus">+  assert_not_equals,</span>
<a href="#l140.19"></a><span id="l140.19" class="difflineplus">+  assert_true,</span>
<a href="#l140.20"></a><span id="l140.20" class="difflineplus">+  mc,</span>
<a href="#l140.21"></a><span id="l140.21" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l140.22"></a><span id="l140.22" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l140.23"></a><span id="l140.23" class="difflineplus">+);</span>
<a href="#l140.24"></a><span id="l140.24"> </span>
<a href="#l140.25"></a><span id="l140.25"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l140.26"></a><span id="l140.26"> </span>
<a href="#l140.27"></a><span id="l140.27" class="difflineminus">-function setupModule(module) {</span>
<a href="#l140.28"></a><span id="l140.28" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l140.29"></a><span id="l140.29" class="difflineminus">-}</span>
<a href="#l140.30"></a><span id="l140.30" class="difflineminus">-</span>
<a href="#l140.31"></a><span id="l140.31"> /* This test checks that the toolbar buttons of the chat toolbar are</span>
<a href="#l140.32"></a><span id="l140.32">  * correctly disabled/enabled, and that the placeholder displayed in</span>
<a href="#l140.33"></a><span id="l140.33">  * the middle of the chat tab is correct.</span>
<a href="#l140.34"></a><span id="l140.34">  */</span>
<a href="#l140.35"></a><span id="l140.35"> function test_toolbar_and_placeholder() {</span>
<a href="#l140.36"></a><span id="l140.36">   assert_not_equals(</span>
<a href="#l140.37"></a><span id="l140.37">     mc.tabmail.selectedTab.mode.type,</span>
<a href="#l140.38"></a><span id="l140.38">     &quot;chat&quot;,</span>
<a href="#l140.39"></a><span id="l140.39" class="difflineat">@@ -136,9 +136,13 @@ function test_toolbar_and_placeholder() </span>
<a href="#l140.40"></a><span id="l140.40">     mc.e(&quot;noConnectedAccountInnerBox&quot;).hidden,</span>
<a href="#l140.41"></a><span id="l140.41">     &quot;the 'No connected account' placeholder is visible&quot;</span>
<a href="#l140.42"></a><span id="l140.42">   );</span>
<a href="#l140.43"></a><span id="l140.43">   assert_equals(</span>
<a href="#l140.44"></a><span id="l140.44">     chatHandler._placeHolderButtonId,</span>
<a href="#l140.45"></a><span id="l140.45">     &quot;openIMAccountManagerButton&quot;,</span>
<a href="#l140.46"></a><span id="l140.46">     &quot;the correct placeholder button is visible&quot;</span>
<a href="#l140.47"></a><span id="l140.47">   );</span>
<a href="#l140.48"></a><span id="l140.48" class="difflineplus">+</span>
<a href="#l140.49"></a><span id="l140.49" class="difflineplus">+  while (mc.tabmail.tabInfo.length &gt; 1) {</span>
<a href="#l140.50"></a><span id="l140.50" class="difflineplus">+    mc.tabmail.closeTab(1);</span>
<a href="#l140.51"></a><span id="l140.51" class="difflineplus">+  }</span>
<a href="#l140.52"></a><span id="l140.52"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l141.1"></a><span id="l141.1" class="difflineminus">--- a/mail/test/mozmill/instrumentation/test-instrument-setup.js</span>
<a href="#l141.2"></a><span id="l141.2" class="difflineplus">+++ b/mail/test/mozmill/instrumentation/test-instrument-setup.js</span>
<a href="#l141.3"></a><span id="l141.3" class="difflineat">@@ -1,47 +1,43 @@</span>
<a href="#l141.4"></a><span id="l141.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l141.5"></a><span id="l141.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l141.6"></a><span id="l141.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l141.7"></a><span id="l141.7"> </span>
<a href="#l141.8"></a><span id="l141.8"> &quot;use strict&quot;;</span>
<a href="#l141.9"></a><span id="l141.9"> </span>
<a href="#l141.10"></a><span id="l141.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l141.11"></a><span id="l141.11" class="difflineminus">-</span>
<a href="#l141.12"></a><span id="l141.12" class="difflineminus">-var MODULE_NAME = &quot;test-instrument-setup&quot;;</span>
<a href="#l141.13"></a><span id="l141.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l141.14"></a><span id="l141.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l141.15"></a><span id="l141.15" class="difflineminus">-</span>
<a href="#l141.16"></a><span id="l141.16"> var elib = ChromeUtils.import(</span>
<a href="#l141.17"></a><span id="l141.17">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l141.18"></a><span id="l141.18"> );</span>
<a href="#l141.19"></a><span id="l141.19"> </span>
<a href="#l141.20"></a><span id="l141.20" class="difflineplus">+var { assert_equals, mc } = ChromeUtils.import(</span>
<a href="#l141.21"></a><span id="l141.21" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l141.22"></a><span id="l141.22" class="difflineplus">+);</span>
<a href="#l141.23"></a><span id="l141.23"> var { input_value } = ChromeUtils.import(</span>
<a href="#l141.24"></a><span id="l141.24">   &quot;resource://testing-common/mozmill/KeyboardHelpers.jsm&quot;</span>
<a href="#l141.25"></a><span id="l141.25"> );</span>
<a href="#l141.26"></a><span id="l141.26"> var {</span>
<a href="#l141.27"></a><span id="l141.27">   plan_for_window_close,</span>
<a href="#l141.28"></a><span id="l141.28">   wait_for_existing_window,</span>
<a href="#l141.29"></a><span id="l141.29">   wait_for_window_close,</span>
<a href="#l141.30"></a><span id="l141.30"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l141.31"></a><span id="l141.31"> </span>
<a href="#l141.32"></a><span id="l141.32"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l141.33"></a><span id="l141.33" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l141.34"></a><span id="l141.34" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l141.35"></a><span id="l141.35" class="difflineplus">+);</span>
<a href="#l141.36"></a><span id="l141.36"> </span>
<a href="#l141.37"></a><span id="l141.37"> var user = {</span>
<a href="#l141.38"></a><span id="l141.38">   name: &quot;Roger Sterling&quot;,</span>
<a href="#l141.39"></a><span id="l141.39">   email: &quot;roger.sterling@example.com&quot;,</span>
<a href="#l141.40"></a><span id="l141.40">   incomingHost: &quot;testin.example.com&quot;,</span>
<a href="#l141.41"></a><span id="l141.41">   outgoingHost: &quot;testout.example.com&quot;,</span>
<a href="#l141.42"></a><span id="l141.42"> };</span>
<a href="#l141.43"></a><span id="l141.43"> </span>
<a href="#l141.44"></a><span id="l141.44"> function setupModule(module) {</span>
<a href="#l141.45"></a><span id="l141.45" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l141.46"></a><span id="l141.46" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l141.47"></a><span id="l141.47" class="difflineminus">-  }</span>
<a href="#l141.48"></a><span id="l141.48" class="difflineminus">-</span>
<a href="#l141.49"></a><span id="l141.49">   Services.prefs.setCharPref(&quot;mail.wizard.logging.dump&quot;, &quot;All&quot;);</span>
<a href="#l141.50"></a><span id="l141.50"> </span>
<a href="#l141.51"></a><span id="l141.51">   // Set the pref to load a local autoconfig file.</span>
<a href="#l141.52"></a><span id="l141.52">   let url = collector.addHttpResource(&quot;../account/xml&quot;, &quot;autoconfig&quot;);</span>
<a href="#l141.53"></a><span id="l141.53">   Services.prefs.setCharPref(&quot;mailnews.auto_config_url&quot;, url);</span>
<a href="#l141.54"></a><span id="l141.54"> </span>
<a href="#l141.55"></a><span id="l141.55">   // Force .com MIME-Type to text/xml</span>
<a href="#l141.56"></a><span id="l141.56">   collector.httpd.registerContentType(&quot;com&quot;, &quot;text/xml&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l142.1"></a><span id="l142.1" class="difflineminus">--- a/mail/test/mozmill/junk-commands/test-junk-commands.js</span>
<a href="#l142.2"></a><span id="l142.2" class="difflineplus">+++ b/mail/test/mozmill/junk-commands/test-junk-commands.js</span>
<a href="#l142.3"></a><span id="l142.3" class="difflineat">@@ -1,32 +1,35 @@</span>
<a href="#l142.4"></a><span id="l142.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l142.5"></a><span id="l142.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l142.6"></a><span id="l142.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l142.7"></a><span id="l142.7"> </span>
<a href="#l142.8"></a><span id="l142.8"> &quot;use strict&quot;;</span>
<a href="#l142.9"></a><span id="l142.9"> </span>
<a href="#l142.10"></a><span id="l142.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l142.11"></a><span id="l142.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-junk-helpers.js */</span>
<a href="#l142.12"></a><span id="l142.12" class="difflineplus">+var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l142.13"></a><span id="l142.13"> </span>
<a href="#l142.14"></a><span id="l142.14" class="difflineminus">-var MODULE_NAME = &quot;test-junk-commands&quot;;</span>
<a href="#l142.15"></a><span id="l142.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l142.16"></a><span id="l142.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;junk-helpers&quot;];</span>
<a href="#l142.17"></a><span id="l142.17" class="difflineminus">-</span>
<a href="#l142.18"></a><span id="l142.18" class="difflineminus">-var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l142.19"></a><span id="l142.19" class="difflineplus">+var {</span>
<a href="#l142.20"></a><span id="l142.20" class="difflineplus">+  be_in_folder,</span>
<a href="#l142.21"></a><span id="l142.21" class="difflineplus">+  create_folder,</span>
<a href="#l142.22"></a><span id="l142.22" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l142.23"></a><span id="l142.23" class="difflineplus">+  select_click_row,</span>
<a href="#l142.24"></a><span id="l142.24" class="difflineplus">+  select_none,</span>
<a href="#l142.25"></a><span id="l142.25" class="difflineplus">+  select_shift_click_row,</span>
<a href="#l142.26"></a><span id="l142.26" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l142.27"></a><span id="l142.27" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l142.28"></a><span id="l142.28" class="difflineplus">+);</span>
<a href="#l142.29"></a><span id="l142.29" class="difflineplus">+var {</span>
<a href="#l142.30"></a><span id="l142.30" class="difflineplus">+  delete_mail_marked_as_junk,</span>
<a href="#l142.31"></a><span id="l142.31" class="difflineplus">+  mark_selected_messages_as_junk,</span>
<a href="#l142.32"></a><span id="l142.32" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/JunkHelpers.jsm&quot;);</span>
<a href="#l142.33"></a><span id="l142.33"> </span>
<a href="#l142.34"></a><span id="l142.34"> // One folder's enough</span>
<a href="#l142.35"></a><span id="l142.35"> var folder = null;</span>
<a href="#l142.36"></a><span id="l142.36"> </span>
<a href="#l142.37"></a><span id="l142.37"> function setupModule(module) {</span>
<a href="#l142.38"></a><span id="l142.38" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l142.39"></a><span id="l142.39" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l142.40"></a><span id="l142.40" class="difflineminus">-  let jh = collector.getModule(&quot;junk-helpers&quot;);</span>
<a href="#l142.41"></a><span id="l142.41" class="difflineminus">-  jh.installInto(module);</span>
<a href="#l142.42"></a><span id="l142.42" class="difflineminus">-</span>
<a href="#l142.43"></a><span id="l142.43">   folder = create_folder(&quot;JunkCommandsA&quot;);</span>
<a href="#l142.44"></a><span id="l142.44">   make_new_sets_in_folder(folder, [{ count: 30 }]);</span>
<a href="#l142.45"></a><span id="l142.45"> }</span>
<a href="#l142.46"></a><span id="l142.46"> </span>
<a href="#l142.47"></a><span id="l142.47"> /**</span>
<a href="#l142.48"></a><span id="l142.48">  * The number of messages to mark as junk and expect to be deleted.</span>
<a href="#l142.49"></a><span id="l142.49">  */</span>
<a href="#l142.50"></a><span id="l142.50"> var NUM_MESSAGES_TO_JUNK = 8;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l143.1"></a><span id="l143.1" class="difflineminus">--- a/mail/test/mozmill/keyboard/test-spacehit.js</span>
<a href="#l143.2"></a><span id="l143.2" class="difflineplus">+++ b/mail/test/mozmill/keyboard/test-spacehit.js</span>
<a href="#l143.3"></a><span id="l143.3" class="difflineat">@@ -4,29 +4,35 @@</span>
<a href="#l143.4"></a><span id="l143.4"> </span>
<a href="#l143.5"></a><span id="l143.5"> /**</span>
<a href="#l143.6"></a><span id="l143.6">  * Tests that the space bar only advances to the next unread message</span>
<a href="#l143.7"></a><span id="l143.7">  * when mail.advance_on_spacebar is true (default).</span>
<a href="#l143.8"></a><span id="l143.8">  */</span>
<a href="#l143.9"></a><span id="l143.9"> </span>
<a href="#l143.10"></a><span id="l143.10"> &quot;use strict&quot;;</span>
<a href="#l143.11"></a><span id="l143.11"> </span>
<a href="#l143.12"></a><span id="l143.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l143.13"></a><span id="l143.13" class="difflineminus">-</span>
<a href="#l143.14"></a><span id="l143.14" class="difflineminus">-var MODULE_NAME = &quot;test-spacehit&quot;;</span>
<a href="#l143.15"></a><span id="l143.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l143.16"></a><span id="l143.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l143.17"></a><span id="l143.17" class="difflineplus">+var {</span>
<a href="#l143.18"></a><span id="l143.18" class="difflineplus">+  assert_equals,</span>
<a href="#l143.19"></a><span id="l143.19" class="difflineplus">+  assert_not_equals,</span>
<a href="#l143.20"></a><span id="l143.20" class="difflineplus">+  be_in_folder,</span>
<a href="#l143.21"></a><span id="l143.21" class="difflineplus">+  create_folder,</span>
<a href="#l143.22"></a><span id="l143.22" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l143.23"></a><span id="l143.23" class="difflineplus">+  mc,</span>
<a href="#l143.24"></a><span id="l143.24" class="difflineplus">+  select_click_row,</span>
<a href="#l143.25"></a><span id="l143.25" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l143.26"></a><span id="l143.26" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l143.27"></a><span id="l143.27" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l143.28"></a><span id="l143.28" class="difflineplus">+);</span>
<a href="#l143.29"></a><span id="l143.29"> </span>
<a href="#l143.30"></a><span id="l143.30"> // Get original preference value</span>
<a href="#l143.31"></a><span id="l143.31"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l143.32"></a><span id="l143.32"> var prefName = &quot;mail.advance_on_spacebar&quot;;</span>
<a href="#l143.33"></a><span id="l143.33"> var prefValue = Services.prefs.getBoolPref(prefName);</span>
<a href="#l143.34"></a><span id="l143.34"> </span>
<a href="#l143.35"></a><span id="l143.35"> function setupModule(module) {</span>
<a href="#l143.36"></a><span id="l143.36" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l143.37"></a><span id="l143.37">   // Create four unread messages in a sample folder</span>
<a href="#l143.38"></a><span id="l143.38">   let folder = create_folder(&quot;Sample&quot;);</span>
<a href="#l143.39"></a><span id="l143.39">   make_new_sets_in_folder(folder, [{ count: 4 }]);</span>
<a href="#l143.40"></a><span id="l143.40">   be_in_folder(folder);</span>
<a href="#l143.41"></a><span id="l143.41"> }</span>
<a href="#l143.42"></a><span id="l143.42"> </span>
<a href="#l143.43"></a><span id="l143.43"> function teardownModule(module) {</span>
<a href="#l143.44"></a><span id="l143.44">   // Restore original preference value</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l144.1"></a><span id="l144.1" class="difflineminus">--- a/mail/test/mozmill/message-header/test-message-header.js</span>
<a href="#l144.2"></a><span id="l144.2" class="difflineplus">+++ b/mail/test/mozmill/message-header/test-message-header.js</span>
<a href="#l144.3"></a><span id="l144.3" class="difflineat">@@ -4,32 +4,53 @@</span>
<a href="#l144.4"></a><span id="l144.4"> </span>
<a href="#l144.5"></a><span id="l144.5"> /**</span>
<a href="#l144.6"></a><span id="l144.6">  * Test functionality in the message header, e.g. tagging, contact editing,</span>
<a href="#l144.7"></a><span id="l144.7">  * the more button ...</span>
<a href="#l144.8"></a><span id="l144.8">  */</span>
<a href="#l144.9"></a><span id="l144.9"> </span>
<a href="#l144.10"></a><span id="l144.10"> &quot;use strict&quot;;</span>
<a href="#l144.11"></a><span id="l144.11"> </span>
<a href="#l144.12"></a><span id="l144.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l144.13"></a><span id="l144.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-dom-helpers.js */</span>
<a href="#l144.14"></a><span id="l144.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l144.15"></a><span id="l144.15" class="difflineminus">-</span>
<a href="#l144.16"></a><span id="l144.16" class="difflineminus">-var MODULE_NAME = &quot;test-message-header&quot;;</span>
<a href="#l144.17"></a><span id="l144.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l144.18"></a><span id="l144.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l144.19"></a><span id="l144.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l144.20"></a><span id="l144.20" class="difflineminus">-  &quot;address-book-helpers&quot;,</span>
<a href="#l144.21"></a><span id="l144.21" class="difflineminus">-  &quot;dom-helpers&quot;,</span>
<a href="#l144.22"></a><span id="l144.22" class="difflineminus">-];</span>
<a href="#l144.23"></a><span id="l144.23" class="difflineminus">-</span>
<a href="#l144.24"></a><span id="l144.24"> var elib = ChromeUtils.import(</span>
<a href="#l144.25"></a><span id="l144.25">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l144.26"></a><span id="l144.26"> );</span>
<a href="#l144.27"></a><span id="l144.27"> </span>
<a href="#l144.28"></a><span id="l144.28" class="difflineplus">+var {</span>
<a href="#l144.29"></a><span id="l144.29" class="difflineplus">+  create_address_book,</span>
<a href="#l144.30"></a><span id="l144.30" class="difflineplus">+  create_mailing_list,</span>
<a href="#l144.31"></a><span id="l144.31" class="difflineplus">+  ensure_no_card_exists,</span>
<a href="#l144.32"></a><span id="l144.32" class="difflineplus">+  get_cards_in_all_address_books_for_email,</span>
<a href="#l144.33"></a><span id="l144.33" class="difflineplus">+  get_mailing_list_from_address_book,</span>
<a href="#l144.34"></a><span id="l144.34" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l144.35"></a><span id="l144.35" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l144.36"></a><span id="l144.36" class="difflineplus">+);</span>
<a href="#l144.37"></a><span id="l144.37" class="difflineplus">+</span>
<a href="#l144.38"></a><span id="l144.38" class="difflineplus">+var {</span>
<a href="#l144.39"></a><span id="l144.39" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l144.40"></a><span id="l144.40" class="difflineplus">+  assert_equals,</span>
<a href="#l144.41"></a><span id="l144.41" class="difflineplus">+  assert_not_equals,</span>
<a href="#l144.42"></a><span id="l144.42" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l144.43"></a><span id="l144.43" class="difflineplus">+  assert_true,</span>
<a href="#l144.44"></a><span id="l144.44" class="difflineplus">+  be_in_folder,</span>
<a href="#l144.45"></a><span id="l144.45" class="difflineplus">+  close_popup,</span>
<a href="#l144.46"></a><span id="l144.46" class="difflineplus">+  create_folder,</span>
<a href="#l144.47"></a><span id="l144.47" class="difflineplus">+  create_message,</span>
<a href="#l144.48"></a><span id="l144.48" class="difflineplus">+  gDefaultWindowHeight,</span>
<a href="#l144.49"></a><span id="l144.49" class="difflineplus">+  mc,</span>
<a href="#l144.50"></a><span id="l144.50" class="difflineplus">+  msgGen,</span>
<a href="#l144.51"></a><span id="l144.51" class="difflineplus">+  restore_default_window_size,</span>
<a href="#l144.52"></a><span id="l144.52" class="difflineplus">+  select_click_row,</span>
<a href="#l144.53"></a><span id="l144.53" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l144.54"></a><span id="l144.54" class="difflineplus">+  wait_for_popup_to_open,</span>
<a href="#l144.55"></a><span id="l144.55" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l144.56"></a><span id="l144.56" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l144.57"></a><span id="l144.57" class="difflineplus">+);</span>
<a href="#l144.58"></a><span id="l144.58" class="difflineplus">+var { collapse_panes, element_visible_recursive } = ChromeUtils.import(</span>
<a href="#l144.59"></a><span id="l144.59" class="difflineplus">+  &quot;resource://testing-common/mozmill/DOMHelpers.jsm&quot;</span>
<a href="#l144.60"></a><span id="l144.60" class="difflineplus">+);</span>
<a href="#l144.61"></a><span id="l144.61"> var { resize_to } = ChromeUtils.import(</span>
<a href="#l144.62"></a><span id="l144.62">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l144.63"></a><span id="l144.63"> );</span>
<a href="#l144.64"></a><span id="l144.64"> </span>
<a href="#l144.65"></a><span id="l144.65"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l144.66"></a><span id="l144.66"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l144.67"></a><span id="l144.67">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l144.68"></a><span id="l144.68"> );</span>
<a href="#l144.69"></a><span id="l144.69" class="difflineat">@@ -38,20 +59,16 @@ var folder, folderMore;</span>
<a href="#l144.70"></a><span id="l144.70"> var gInterestingMessage;</span>
<a href="#l144.71"></a><span id="l144.71"> </span>
<a href="#l144.72"></a><span id="l144.72"> /**</span>
<a href="#l144.73"></a><span id="l144.73">  * Wraps a call to querySelector in an elib.Elem.</span>
<a href="#l144.74"></a><span id="l144.74">  */</span>
<a href="#l144.75"></a><span id="l144.75"> const getElement = (elem, query) =&gt; new elib.Elem(elem.querySelector(query));</span>
<a href="#l144.76"></a><span id="l144.76"> </span>
<a href="#l144.77"></a><span id="l144.77"> function setupModule(module) {</span>
<a href="#l144.78"></a><span id="l144.78" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l144.79"></a><span id="l144.79" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l144.80"></a><span id="l144.80" class="difflineminus">-  }</span>
<a href="#l144.81"></a><span id="l144.81" class="difflineminus">-</span>
<a href="#l144.82"></a><span id="l144.82">   folder = create_folder(&quot;MessageWindowA&quot;);</span>
<a href="#l144.83"></a><span id="l144.83">   folderMore = create_folder(&quot;MesageHeaderMoreButton&quot;);</span>
<a href="#l144.84"></a><span id="l144.84"> </span>
<a href="#l144.85"></a><span id="l144.85">   // create a message that has the interesting headers that commonly</span>
<a href="#l144.86"></a><span id="l144.86">   // show up in the message header pane for testing</span>
<a href="#l144.87"></a><span id="l144.87">   gInterestingMessage = create_message({</span>
<a href="#l144.88"></a><span id="l144.88">     cc: msgGen.makeNamesAndAddresses(20), // YYY</span>
<a href="#l144.89"></a><span id="l144.89">     subject:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l145.1"></a><span id="l145.1" class="difflineminus">--- a/mail/test/mozmill/message-header/test-phishing-bar.js</span>
<a href="#l145.2"></a><span id="l145.2" class="difflineplus">+++ b/mail/test/mozmill/message-header/test-phishing-bar.js</span>
<a href="#l145.3"></a><span id="l145.3" class="difflineat">@@ -3,25 +3,31 @@</span>
<a href="#l145.4"></a><span id="l145.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l145.5"></a><span id="l145.5"> </span>
<a href="#l145.6"></a><span id="l145.6"> /**</span>
<a href="#l145.7"></a><span id="l145.7">  * Test that phishing notifications behave properly.</span>
<a href="#l145.8"></a><span id="l145.8">  */</span>
<a href="#l145.9"></a><span id="l145.9"> </span>
<a href="#l145.10"></a><span id="l145.10"> &quot;use strict&quot;;</span>
<a href="#l145.11"></a><span id="l145.11"> </span>
<a href="#l145.12"></a><span id="l145.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l145.13"></a><span id="l145.13" class="difflineminus">-</span>
<a href="#l145.14"></a><span id="l145.14" class="difflineminus">-var MODULE_NAME = &quot;test-phishing-bar&quot;;</span>
<a href="#l145.15"></a><span id="l145.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l145.16"></a><span id="l145.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l145.17"></a><span id="l145.17" class="difflineminus">-</span>
<a href="#l145.18"></a><span id="l145.18"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l145.19"></a><span id="l145.19"> </span>
<a href="#l145.20"></a><span id="l145.20"> var {</span>
<a href="#l145.21"></a><span id="l145.21" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l145.22"></a><span id="l145.22" class="difflineplus">+  be_in_folder,</span>
<a href="#l145.23"></a><span id="l145.23" class="difflineplus">+  create_folder,</span>
<a href="#l145.24"></a><span id="l145.24" class="difflineplus">+  create_message,</span>
<a href="#l145.25"></a><span id="l145.25" class="difflineplus">+  mc,</span>
<a href="#l145.26"></a><span id="l145.26" class="difflineplus">+  open_message_from_file,</span>
<a href="#l145.27"></a><span id="l145.27" class="difflineplus">+  select_click_row,</span>
<a href="#l145.28"></a><span id="l145.28" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l145.29"></a><span id="l145.29" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l145.30"></a><span id="l145.30" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l145.31"></a><span id="l145.31" class="difflineplus">+);</span>
<a href="#l145.32"></a><span id="l145.32" class="difflineplus">+var {</span>
<a href="#l145.33"></a><span id="l145.33">   assert_notification_displayed,</span>
<a href="#l145.34"></a><span id="l145.34">   get_notification_button,</span>
<a href="#l145.35"></a><span id="l145.35">   wait_for_notification_to_show,</span>
<a href="#l145.36"></a><span id="l145.36">   wait_for_notification_to_stop,</span>
<a href="#l145.37"></a><span id="l145.37"> } = ChromeUtils.import(</span>
<a href="#l145.38"></a><span id="l145.38">   &quot;resource://testing-common/mozmill/NotificationBoxHelpers.jsm&quot;</span>
<a href="#l145.39"></a><span id="l145.39"> );</span>
<a href="#l145.40"></a><span id="l145.40"> var {</span>
<a href="#l145.41"></a><span id="l145.41" class="difflineat">@@ -32,20 +38,16 @@ var {</span>
<a href="#l145.42"></a><span id="l145.42"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l145.43"></a><span id="l145.43"> </span>
<a href="#l145.44"></a><span id="l145.44"> var folder;</span>
<a href="#l145.45"></a><span id="l145.45"> </span>
<a href="#l145.46"></a><span id="l145.46"> var kBoxId = &quot;mail-notification-top&quot;;</span>
<a href="#l145.47"></a><span id="l145.47"> var kNotificationValue = &quot;maybeScam&quot;;</span>
<a href="#l145.48"></a><span id="l145.48"> </span>
<a href="#l145.49"></a><span id="l145.49"> function setupModule(module) {</span>
<a href="#l145.50"></a><span id="l145.50" class="difflineminus">-  for (let dep of MODULE_REQUIRES) {</span>
<a href="#l145.51"></a><span id="l145.51" class="difflineminus">-    collector.getModule(dep).installInto(module);</span>
<a href="#l145.52"></a><span id="l145.52" class="difflineminus">-  }</span>
<a href="#l145.53"></a><span id="l145.53" class="difflineminus">-</span>
<a href="#l145.54"></a><span id="l145.54">   folder = create_folder(&quot;PhishingBarA&quot;);</span>
<a href="#l145.55"></a><span id="l145.55">   add_message_to_folder(</span>
<a href="#l145.56"></a><span id="l145.56">     folder,</span>
<a href="#l145.57"></a><span id="l145.57">     create_message({</span>
<a href="#l145.58"></a><span id="l145.58">       body: {</span>
<a href="#l145.59"></a><span id="l145.59">         body: '&lt;form action=&quot;http://localhost/download-me&quot;&gt;&lt;input&gt;&lt;/form&gt;.',</span>
<a href="#l145.60"></a><span id="l145.60">         contentType: &quot;text/html&quot;,</span>
<a href="#l145.61"></a><span id="l145.61">       },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l146.1"></a><span id="l146.1" class="difflineminus">--- a/mail/test/mozmill/message-header/test-reply-identity.js</span>
<a href="#l146.2"></a><span id="l146.2" class="difflineplus">+++ b/mail/test/mozmill/message-header/test-reply-identity.js</span>
<a href="#l146.3"></a><span id="l146.3" class="difflineat">@@ -3,33 +3,40 @@</span>
<a href="#l146.4"></a><span id="l146.4">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l146.5"></a><span id="l146.5"> </span>
<a href="#l146.6"></a><span id="l146.6"> /**</span>
<a href="#l146.7"></a><span id="l146.7">  * Tests that actions such as replying choses the most suitable identity.</span>
<a href="#l146.8"></a><span id="l146.8">  */</span>
<a href="#l146.9"></a><span id="l146.9"> </span>
<a href="#l146.10"></a><span id="l146.10"> &quot;use strict&quot;;</span>
<a href="#l146.11"></a><span id="l146.11"> </span>
<a href="#l146.12"></a><span id="l146.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l146.13"></a><span id="l146.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l146.14"></a><span id="l146.14" class="difflineplus">+var { close_compose_window, open_compose_with_reply } = ChromeUtils.import(</span>
<a href="#l146.15"></a><span id="l146.15" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l146.16"></a><span id="l146.16" class="difflineplus">+);</span>
<a href="#l146.17"></a><span id="l146.17" class="difflineplus">+var {</span>
<a href="#l146.18"></a><span id="l146.18" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l146.19"></a><span id="l146.19" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l146.20"></a><span id="l146.20" class="difflineplus">+  be_in_folder,</span>
<a href="#l146.21"></a><span id="l146.21" class="difflineplus">+  create_message,</span>
<a href="#l146.22"></a><span id="l146.22" class="difflineplus">+  mc,</span>
<a href="#l146.23"></a><span id="l146.23" class="difflineplus">+  select_click_row,</span>
<a href="#l146.24"></a><span id="l146.24" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l146.25"></a><span id="l146.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l146.26"></a><span id="l146.26" class="difflineplus">+);</span>
<a href="#l146.27"></a><span id="l146.27"> </span>
<a href="#l146.28"></a><span id="l146.28" class="difflineminus">-var MODULE_NAME = &quot;test-reply-identity&quot;;</span>
<a href="#l146.29"></a><span id="l146.29" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l146.30"></a><span id="l146.30" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l146.31"></a><span id="l146.31" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l146.32"></a><span id="l146.32" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l146.33"></a><span id="l146.33" class="difflineplus">+);</span>
<a href="#l146.34"></a><span id="l146.34"> </span>
<a href="#l146.35"></a><span id="l146.35"> var testFolder = null;</span>
<a href="#l146.36"></a><span id="l146.36"> </span>
<a href="#l146.37"></a><span id="l146.37"> var identity1Email = &quot;carl@example.com&quot;;</span>
<a href="#l146.38"></a><span id="l146.38"> var identity2Email = &quot;lenny@springfield.invalid&quot;;</span>
<a href="#l146.39"></a><span id="l146.39"> </span>
<a href="#l146.40"></a><span id="l146.40"> function setupModule(module) {</span>
<a href="#l146.41"></a><span id="l146.41" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l146.42"></a><span id="l146.42" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l146.43"></a><span id="l146.43" class="difflineminus">-  }</span>
<a href="#l146.44"></a><span id="l146.44" class="difflineminus">-</span>
<a href="#l146.45"></a><span id="l146.45">   addIdentitiesAndFolder();</span>
<a href="#l146.46"></a><span id="l146.46">   // Msg #0</span>
<a href="#l146.47"></a><span id="l146.47">   add_message_to_folder(</span>
<a href="#l146.48"></a><span id="l146.48">     testFolder,</span>
<a href="#l146.49"></a><span id="l146.49">     create_message({</span>
<a href="#l146.50"></a><span id="l146.50">       from: &quot;Homer &lt;homer@example.com&gt;&quot;,</span>
<a href="#l146.51"></a><span id="l146.51">       to: &quot;workers@springfield.invalid&quot;,</span>
<a href="#l146.52"></a><span id="l146.52">       subject: &quot;no matching identity, like bcc/list&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l147.1"></a><span id="l147.1" class="difflineminus">--- a/mail/test/mozmill/message-header/test-reply-to-list-from-address-selection.js</span>
<a href="#l147.2"></a><span id="l147.2" class="difflineplus">+++ b/mail/test/mozmill/message-header/test-reply-to-list-from-address-selection.js</span>
<a href="#l147.3"></a><span id="l147.3" class="difflineat">@@ -3,34 +3,39 @@</span>
<a href="#l147.4"></a><span id="l147.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l147.5"></a><span id="l147.5"> </span>
<a href="#l147.6"></a><span id="l147.6"> /*</span>
<a href="#l147.7"></a><span id="l147.7">  *  Test for the most suitable identity in From address for reply-to-list</span>
<a href="#l147.8"></a><span id="l147.8">  */</span>
<a href="#l147.9"></a><span id="l147.9"> </span>
<a href="#l147.10"></a><span id="l147.10"> &quot;use strict&quot;;</span>
<a href="#l147.11"></a><span id="l147.11"> </span>
<a href="#l147.12"></a><span id="l147.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l147.13"></a><span id="l147.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l147.14"></a><span id="l147.14" class="difflineplus">+var { open_compose_with_reply_to_list } = ChromeUtils.import(</span>
<a href="#l147.15"></a><span id="l147.15" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l147.16"></a><span id="l147.16" class="difflineplus">+);</span>
<a href="#l147.17"></a><span id="l147.17" class="difflineplus">+var {</span>
<a href="#l147.18"></a><span id="l147.18" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l147.19"></a><span id="l147.19" class="difflineplus">+  be_in_folder,</span>
<a href="#l147.20"></a><span id="l147.20" class="difflineplus">+  mc,</span>
<a href="#l147.21"></a><span id="l147.21" class="difflineplus">+  select_click_row,</span>
<a href="#l147.22"></a><span id="l147.22" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l147.23"></a><span id="l147.23" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l147.24"></a><span id="l147.24" class="difflineplus">+);</span>
<a href="#l147.25"></a><span id="l147.25"> </span>
<a href="#l147.26"></a><span id="l147.26" class="difflineminus">-var MODULE_NAME = &quot;test-reply-to-list-from-address-selection&quot;;</span>
<a href="#l147.27"></a><span id="l147.27" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l147.28"></a><span id="l147.28" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;];</span>
<a href="#l147.29"></a><span id="l147.29" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l147.30"></a><span id="l147.30" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l147.31"></a><span id="l147.31" class="difflineplus">+);</span>
<a href="#l147.32"></a><span id="l147.32"> </span>
<a href="#l147.33"></a><span id="l147.33"> var testFolder = null;</span>
<a href="#l147.34"></a><span id="l147.34"> var msgHdr = null;</span>
<a href="#l147.35"></a><span id="l147.35"> var replyToListWindow = null;</span>
<a href="#l147.36"></a><span id="l147.36"> </span>
<a href="#l147.37"></a><span id="l147.37"> var identityString1 = &quot;tinderbox_correct_identity@foo.invalid&quot;;</span>
<a href="#l147.38"></a><span id="l147.38"> </span>
<a href="#l147.39"></a><span id="l147.39"> function setupModule(module) {</span>
<a href="#l147.40"></a><span id="l147.40" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l147.41"></a><span id="l147.41" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l147.42"></a><span id="l147.42" class="difflineminus">-  }</span>
<a href="#l147.43"></a><span id="l147.43" class="difflineminus">-</span>
<a href="#l147.44"></a><span id="l147.44">   addIdentitiesAndFolder();</span>
<a href="#l147.45"></a><span id="l147.45">   addMessageToFolder(testFolder);</span>
<a href="#l147.46"></a><span id="l147.46"> }</span>
<a href="#l147.47"></a><span id="l147.47"> </span>
<a href="#l147.48"></a><span id="l147.48"> function addMessageToFolder(aFolder) {</span>
<a href="#l147.49"></a><span id="l147.49">   var msgId =</span>
<a href="#l147.50"></a><span id="l147.50">     Cc[&quot;@mozilla.org/uuid-generator;1&quot;]</span>
<a href="#l147.51"></a><span id="l147.51">       .getService(Ci.nsIUUIDGenerator)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l148.1"></a><span id="l148.1" class="difflineminus">--- a/mail/test/mozmill/message-header/test-return-receipt.js</span>
<a href="#l148.2"></a><span id="l148.2" class="difflineplus">+++ b/mail/test/mozmill/message-header/test-return-receipt.js</span>
<a href="#l148.3"></a><span id="l148.3" class="difflineat">@@ -3,34 +3,37 @@</span>
<a href="#l148.4"></a><span id="l148.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l148.5"></a><span id="l148.5"> </span>
<a href="#l148.6"></a><span id="l148.6"> /*</span>
<a href="#l148.7"></a><span id="l148.7">  * Test return receipt (MDN) stuff.</span>
<a href="#l148.8"></a><span id="l148.8">  */</span>
<a href="#l148.9"></a><span id="l148.9"> </span>
<a href="#l148.10"></a><span id="l148.10"> &quot;use strict&quot;;</span>
<a href="#l148.11"></a><span id="l148.11"> </span>
<a href="#l148.12"></a><span id="l148.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l148.13"></a><span id="l148.13" class="difflineminus">-</span>
<a href="#l148.14"></a><span id="l148.14" class="difflineminus">-var MODULE_NAME = &quot;test-return-receipt&quot;;</span>
<a href="#l148.15"></a><span id="l148.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l148.16"></a><span id="l148.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l148.17"></a><span id="l148.17" class="difflineminus">-</span>
<a href="#l148.18"></a><span id="l148.18" class="difflineplus">+var {</span>
<a href="#l148.19"></a><span id="l148.19" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l148.20"></a><span id="l148.20" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l148.21"></a><span id="l148.21" class="difflineplus">+  be_in_folder,</span>
<a href="#l148.22"></a><span id="l148.22" class="difflineplus">+  create_folder,</span>
<a href="#l148.23"></a><span id="l148.23" class="difflineplus">+  create_message,</span>
<a href="#l148.24"></a><span id="l148.24" class="difflineplus">+  mc,</span>
<a href="#l148.25"></a><span id="l148.25" class="difflineplus">+  select_click_row,</span>
<a href="#l148.26"></a><span id="l148.26" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l148.27"></a><span id="l148.27" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l148.28"></a><span id="l148.28" class="difflineplus">+);</span>
<a href="#l148.29"></a><span id="l148.29"> var { assert_notification_displayed } = ChromeUtils.import(</span>
<a href="#l148.30"></a><span id="l148.30">   &quot;resource://testing-common/mozmill/NotificationBoxHelpers.jsm&quot;</span>
<a href="#l148.31"></a><span id="l148.31"> );</span>
<a href="#l148.32"></a><span id="l148.32"> </span>
<a href="#l148.33"></a><span id="l148.33"> var folder;</span>
<a href="#l148.34"></a><span id="l148.34"> </span>
<a href="#l148.35"></a><span id="l148.35"> var kBoxId = &quot;mail-notification-top&quot;;</span>
<a href="#l148.36"></a><span id="l148.36"> var kNotificationValue = &quot;mdnRequested&quot;;</span>
<a href="#l148.37"></a><span id="l148.37"> </span>
<a href="#l148.38"></a><span id="l148.38"> function setupModule(module) {</span>
<a href="#l148.39"></a><span id="l148.39" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l148.40"></a><span id="l148.40" class="difflineminus">-</span>
<a href="#l148.41"></a><span id="l148.41">   folder = create_folder(&quot;ReturnReceiptTest&quot;);</span>
<a href="#l148.42"></a><span id="l148.42"> </span>
<a href="#l148.43"></a><span id="l148.43">   // Create a message that requests a return receipt.</span>
<a href="#l148.44"></a><span id="l148.44">   let msg0 = create_message({</span>
<a href="#l148.45"></a><span id="l148.45">     from: [&quot;Ake&quot;, &quot;ake@example.com&quot;],</span>
<a href="#l148.46"></a><span id="l148.46">     clobberHeaders: { &quot;Disposition-Notification-To&quot;: &quot;ake@example.com&quot; },</span>
<a href="#l148.47"></a><span id="l148.47">   });</span>
<a href="#l148.48"></a><span id="l148.48">   add_message_to_folder(folder, msg0);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l149.1"></a><span id="l149.1" class="difflineminus">--- a/mail/test/mozmill/message-reader/test-bug594646.js</span>
<a href="#l149.2"></a><span id="l149.2" class="difflineplus">+++ b/mail/test/mozmill/message-reader/test-bug594646.js</span>
<a href="#l149.3"></a><span id="l149.3" class="difflineat">@@ -6,32 +6,28 @@</span>
<a href="#l149.4"></a><span id="l149.4"> </span>
<a href="#l149.5"></a><span id="l149.5"> /**</span>
<a href="#l149.6"></a><span id="l149.6">  * Tests that opening an .eml file the body of the message is correct,</span>
<a href="#l149.7"></a><span id="l149.7">  * that it hasn't been UTF-8 mojibake'd.</span>
<a href="#l149.8"></a><span id="l149.8">  */</span>
<a href="#l149.9"></a><span id="l149.9"> </span>
<a href="#l149.10"></a><span id="l149.10"> &quot;use strict&quot;;</span>
<a href="#l149.11"></a><span id="l149.11"> </span>
<a href="#l149.12"></a><span id="l149.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l149.13"></a><span id="l149.13" class="difflineminus">-</span>
<a href="#l149.14"></a><span id="l149.14" class="difflineminus">-var MODULE_NAME = &quot;test-bug594646&quot;;</span>
<a href="#l149.15"></a><span id="l149.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l149.16"></a><span id="l149.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l149.17"></a><span id="l149.17" class="difflineminus">-</span>
<a href="#l149.18"></a><span id="l149.18"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l149.19"></a><span id="l149.19"> </span>
<a href="#l149.20"></a><span id="l149.20" class="difflineplus">+var { assert_equals, open_message_from_file } = ChromeUtils.import(</span>
<a href="#l149.21"></a><span id="l149.21" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l149.22"></a><span id="l149.22" class="difflineplus">+);</span>
<a href="#l149.23"></a><span id="l149.23"> var { close_window } = ChromeUtils.import(</span>
<a href="#l149.24"></a><span id="l149.24">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l149.25"></a><span id="l149.25"> );</span>
<a href="#l149.26"></a><span id="l149.26"> </span>
<a href="#l149.27"></a><span id="l149.27"> var gReferenceTextContent;</span>
<a href="#l149.28"></a><span id="l149.28"> </span>
<a href="#l149.29"></a><span id="l149.29"> function setupModule(module) {</span>
<a href="#l149.30"></a><span id="l149.30" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l149.31"></a><span id="l149.31">   gReferenceTextContent = extract_eml_body_textcontent(</span>
<a href="#l149.32"></a><span id="l149.32">     &quot;./bug594646_reference.eml&quot;</span>
<a href="#l149.33"></a><span id="l149.33">   );</span>
<a href="#l149.34"></a><span id="l149.34"> }</span>
<a href="#l149.35"></a><span id="l149.35"> </span>
<a href="#l149.36"></a><span id="l149.36"> function extract_eml_body_textcontent(eml) {</span>
<a href="#l149.37"></a><span id="l149.37">   let file = os.getFileForPath(os.abspath(eml, os.getFileForPath(__file__)));</span>
<a href="#l149.38"></a><span id="l149.38">   let msgc = open_message_from_file(file);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l150.1"></a><span id="l150.1" class="difflineminus">--- a/mail/test/mozmill/message-window/test-autohide-menubar.js</span>
<a href="#l150.2"></a><span id="l150.2" class="difflineplus">+++ b/mail/test/mozmill/message-window/test-autohide-menubar.js</span>
<a href="#l150.3"></a><span id="l150.3" class="difflineat">@@ -2,43 +2,43 @@</span>
<a href="#l150.4"></a><span id="l150.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l150.5"></a><span id="l150.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l150.6"></a><span id="l150.6"> </span>
<a href="#l150.7"></a><span id="l150.7"> /* Test that the menubar can be set to &quot;autohide&quot;. This should only have an</span>
<a href="#l150.8"></a><span id="l150.8">    effect on Windows. */</span>
<a href="#l150.9"></a><span id="l150.9"> </span>
<a href="#l150.10"></a><span id="l150.10"> &quot;use strict&quot;;</span>
<a href="#l150.11"></a><span id="l150.11"> </span>
<a href="#l150.12"></a><span id="l150.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l150.13"></a><span id="l150.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l150.14"></a><span id="l150.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l150.15"></a><span id="l150.15" class="difflineminus">-</span>
<a href="#l150.16"></a><span id="l150.16" class="difflineminus">-var MODULE_NAME = &quot;test-autohide-menubar&quot;;</span>
<a href="#l150.17"></a><span id="l150.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l150.18"></a><span id="l150.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l150.19"></a><span id="l150.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l150.20"></a><span id="l150.20" class="difflineminus">-  &quot;address-book-helpers&quot;,</span>
<a href="#l150.21"></a><span id="l150.21" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l150.22"></a><span id="l150.22" class="difflineminus">-];</span>
<a href="#l150.23"></a><span id="l150.23" class="difflineminus">-</span>
<a href="#l150.24"></a><span id="l150.24"> var elib = ChromeUtils.import(</span>
<a href="#l150.25"></a><span id="l150.25">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l150.26"></a><span id="l150.26"> );</span>
<a href="#l150.27"></a><span id="l150.27"> </span>
<a href="#l150.28"></a><span id="l150.28" class="difflineplus">+var { open_address_book_window } = ChromeUtils.import(</span>
<a href="#l150.29"></a><span id="l150.29" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l150.30"></a><span id="l150.30" class="difflineplus">+);</span>
<a href="#l150.31"></a><span id="l150.31" class="difflineplus">+var { close_compose_window, open_compose_new_mail } = ChromeUtils.import(</span>
<a href="#l150.32"></a><span id="l150.32" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l150.33"></a><span id="l150.33" class="difflineplus">+);</span>
<a href="#l150.34"></a><span id="l150.34" class="difflineplus">+var {</span>
<a href="#l150.35"></a><span id="l150.35" class="difflineplus">+  be_in_folder,</span>
<a href="#l150.36"></a><span id="l150.36" class="difflineplus">+  close_message_window,</span>
<a href="#l150.37"></a><span id="l150.37" class="difflineplus">+  create_folder,</span>
<a href="#l150.38"></a><span id="l150.38" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l150.39"></a><span id="l150.39" class="difflineplus">+  mc,</span>
<a href="#l150.40"></a><span id="l150.40" class="difflineplus">+  open_selected_message_in_new_window,</span>
<a href="#l150.41"></a><span id="l150.41" class="difflineplus">+  select_click_row,</span>
<a href="#l150.42"></a><span id="l150.42" class="difflineplus">+  toggle_main_menu,</span>
<a href="#l150.43"></a><span id="l150.43" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l150.44"></a><span id="l150.44" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l150.45"></a><span id="l150.45" class="difflineplus">+);</span>
<a href="#l150.46"></a><span id="l150.46" class="difflineplus">+</span>
<a href="#l150.47"></a><span id="l150.47"> var menuFolder;</span>
<a href="#l150.48"></a><span id="l150.48"> var menuState;</span>
<a href="#l150.49"></a><span id="l150.49"> </span>
<a href="#l150.50"></a><span id="l150.50"> function setupModule(module) {</span>
<a href="#l150.51"></a><span id="l150.51" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l150.52"></a><span id="l150.52" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l150.53"></a><span id="l150.53" class="difflineminus">-  let abh = collector.getModule(&quot;address-book-helpers&quot;);</span>
<a href="#l150.54"></a><span id="l150.54" class="difflineminus">-  abh.installInto(module);</span>
<a href="#l150.55"></a><span id="l150.55" class="difflineminus">-  let ch = collector.getModule(&quot;compose-helpers&quot;);</span>
<a href="#l150.56"></a><span id="l150.56" class="difflineminus">-  ch.installInto(module);</span>
<a href="#l150.57"></a><span id="l150.57" class="difflineminus">-</span>
<a href="#l150.58"></a><span id="l150.58">   menuFolder = create_folder(&quot;menuFolder&quot;);</span>
<a href="#l150.59"></a><span id="l150.59">   make_new_sets_in_folder(menuFolder, [{ count: 1 }]);</span>
<a href="#l150.60"></a><span id="l150.60"> </span>
<a href="#l150.61"></a><span id="l150.61">   // Make the menubar not autohide by default.</span>
<a href="#l150.62"></a><span id="l150.62">   menuState = toggle_main_menu(true);</span>
<a href="#l150.63"></a><span id="l150.63"> }</span>
<a href="#l150.64"></a><span id="l150.64"> </span>
<a href="#l150.65"></a><span id="l150.65"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l151.1"></a><span id="l151.1" class="difflineminus">--- a/mail/test/mozmill/message-window/test-commands.js</span>
<a href="#l151.2"></a><span id="l151.2" class="difflineplus">+++ b/mail/test/mozmill/message-window/test-commands.js</span>
<a href="#l151.3"></a><span id="l151.3" class="difflineat">@@ -1,38 +1,41 @@</span>
<a href="#l151.4"></a><span id="l151.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l151.5"></a><span id="l151.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l151.6"></a><span id="l151.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l151.7"></a><span id="l151.7"> </span>
<a href="#l151.8"></a><span id="l151.8"> &quot;use strict&quot;;</span>
<a href="#l151.9"></a><span id="l151.9"> </span>
<a href="#l151.10"></a><span id="l151.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l151.11"></a><span id="l151.11" class="difflineminus">-</span>
<a href="#l151.12"></a><span id="l151.12" class="difflineminus">-var MODULE_NAME = &quot;test-commands&quot;;</span>
<a href="#l151.13"></a><span id="l151.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l151.14"></a><span id="l151.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l151.15"></a><span id="l151.15" class="difflineminus">-</span>
<a href="#l151.16"></a><span id="l151.16"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l151.17"></a><span id="l151.17">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l151.18"></a><span id="l151.18"> );</span>
<a href="#l151.19"></a><span id="l151.19"> var elib = ChromeUtils.import(</span>
<a href="#l151.20"></a><span id="l151.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l151.21"></a><span id="l151.21"> );</span>
<a href="#l151.22"></a><span id="l151.22"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l151.23"></a><span id="l151.23"> </span>
<a href="#l151.24"></a><span id="l151.24" class="difflineplus">+var {</span>
<a href="#l151.25"></a><span id="l151.25" class="difflineplus">+  assert_equals,</span>
<a href="#l151.26"></a><span id="l151.26" class="difflineplus">+  be_in_folder,</span>
<a href="#l151.27"></a><span id="l151.27" class="difflineplus">+  create_folder,</span>
<a href="#l151.28"></a><span id="l151.28" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l151.29"></a><span id="l151.29" class="difflineplus">+  mc,</span>
<a href="#l151.30"></a><span id="l151.30" class="difflineplus">+  open_message_from_file,</span>
<a href="#l151.31"></a><span id="l151.31" class="difflineplus">+  press_delete,</span>
<a href="#l151.32"></a><span id="l151.32" class="difflineplus">+  select_click_row,</span>
<a href="#l151.33"></a><span id="l151.33" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l151.34"></a><span id="l151.34" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l151.35"></a><span id="l151.35" class="difflineplus">+);</span>
<a href="#l151.36"></a><span id="l151.36"> var { close_window } = ChromeUtils.import(</span>
<a href="#l151.37"></a><span id="l151.37">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l151.38"></a><span id="l151.38"> );</span>
<a href="#l151.39"></a><span id="l151.39"> </span>
<a href="#l151.40"></a><span id="l151.40"> var folder1, folder2;</span>
<a href="#l151.41"></a><span id="l151.41"> </span>
<a href="#l151.42"></a><span id="l151.42"> var setupModule = function(module) {</span>
<a href="#l151.43"></a><span id="l151.43" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l151.44"></a><span id="l151.44" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l151.45"></a><span id="l151.45" class="difflineminus">-</span>
<a href="#l151.46"></a><span id="l151.46">   folder1 = create_folder(&quot;CopyFromFolder&quot;);</span>
<a href="#l151.47"></a><span id="l151.47">   folder2 = create_folder(&quot;CopyToFolder&quot;);</span>
<a href="#l151.48"></a><span id="l151.48">   make_new_sets_in_folder(folder1, [{ count: 1 }]);</span>
<a href="#l151.49"></a><span id="l151.49"> };</span>
<a href="#l151.50"></a><span id="l151.50"> </span>
<a href="#l151.51"></a><span id="l151.51"> function test_copy_eml_message() {</span>
<a href="#l151.52"></a><span id="l151.52">   // First, copy an email to a folder and delete it immediately just so it shows</span>
<a href="#l151.53"></a><span id="l151.53">   // up in the recent folders list. This simplifies navigation of the copy</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l152.1"></a><span id="l152.1" class="difflineminus">--- a/mail/test/mozmill/message-window/test-eml-subject.js</span>
<a href="#l152.2"></a><span id="l152.2" class="difflineplus">+++ b/mail/test/mozmill/message-window/test-eml-subject.js</span>
<a href="#l152.3"></a><span id="l152.3" class="difflineat">@@ -3,39 +3,33 @@</span>
<a href="#l152.4"></a><span id="l152.4">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l152.5"></a><span id="l152.5"> </span>
<a href="#l152.6"></a><span id="l152.6"> /**</span>
<a href="#l152.7"></a><span id="l152.7">  * Tests that opening an .eml file with empty subject works.</span>
<a href="#l152.8"></a><span id="l152.8">  */</span>
<a href="#l152.9"></a><span id="l152.9"> </span>
<a href="#l152.10"></a><span id="l152.10"> &quot;use strict&quot;;</span>
<a href="#l152.11"></a><span id="l152.11"> </span>
<a href="#l152.12"></a><span id="l152.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l152.13"></a><span id="l152.13" class="difflineminus">-</span>
<a href="#l152.14"></a><span id="l152.14" class="difflineminus">-var MODULE_NAME = &quot;test-eml-subject&quot;;</span>
<a href="#l152.15"></a><span id="l152.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l152.16"></a><span id="l152.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l152.17"></a><span id="l152.17" class="difflineminus">-</span>
<a href="#l152.18"></a><span id="l152.18"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l152.19"></a><span id="l152.19"> </span>
<a href="#l152.20"></a><span id="l152.20" class="difflineplus">+var { assert_equals, open_message_from_file } = ChromeUtils.import(</span>
<a href="#l152.21"></a><span id="l152.21" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l152.22"></a><span id="l152.22" class="difflineplus">+);</span>
<a href="#l152.23"></a><span id="l152.23"> var { close_window } = ChromeUtils.import(</span>
<a href="#l152.24"></a><span id="l152.24">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l152.25"></a><span id="l152.25"> );</span>
<a href="#l152.26"></a><span id="l152.26"> </span>
<a href="#l152.27"></a><span id="l152.27"> var { StringBundle } = ChromeUtils.import(</span>
<a href="#l152.28"></a><span id="l152.28">   &quot;resource:///modules/StringBundle.js&quot;</span>
<a href="#l152.29"></a><span id="l152.29"> );</span>
<a href="#l152.30"></a><span id="l152.30"> var { AppConstants } = ChromeUtils.import(</span>
<a href="#l152.31"></a><span id="l152.31">   &quot;resource://gre/modules/AppConstants.jsm&quot;</span>
<a href="#l152.32"></a><span id="l152.32"> );</span>
<a href="#l152.33"></a><span id="l152.33"> </span>
<a href="#l152.34"></a><span id="l152.34" class="difflineminus">-var setupModule = function(module) {</span>
<a href="#l152.35"></a><span id="l152.35" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l152.36"></a><span id="l152.36" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l152.37"></a><span id="l152.37" class="difflineminus">-};</span>
<a href="#l152.38"></a><span id="l152.38" class="difflineplus">+var setupModule = function(module) {};</span>
<a href="#l152.39"></a><span id="l152.39"> </span>
<a href="#l152.40"></a><span id="l152.40"> function check_eml_window_title(subject, eml) {</span>
<a href="#l152.41"></a><span id="l152.41">   let file = os.getFileForPath(os.abspath(eml, os.getFileForPath(__file__)));</span>
<a href="#l152.42"></a><span id="l152.42">   let msgc = open_message_from_file(file);</span>
<a href="#l152.43"></a><span id="l152.43"> </span>
<a href="#l152.44"></a><span id="l152.44">   let brandBundle = new StringBundle(</span>
<a href="#l152.45"></a><span id="l152.45">     &quot;chrome://branding/locale/brand.properties&quot;</span>
<a href="#l152.46"></a><span id="l152.46">   );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l153.1"></a><span id="l153.1" class="difflineminus">--- a/mail/test/mozmill/message-window/test-message-sidebar.js</span>
<a href="#l153.2"></a><span id="l153.2" class="difflineplus">+++ b/mail/test/mozmill/message-window/test-message-sidebar.js</span>
<a href="#l153.3"></a><span id="l153.3" class="difflineat">@@ -1,20 +1,13 @@</span>
<a href="#l153.4"></a><span id="l153.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l153.5"></a><span id="l153.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l153.6"></a><span id="l153.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l153.7"></a><span id="l153.7"> </span>
<a href="#l153.8"></a><span id="l153.8"> &quot;use strict&quot;;</span>
<a href="#l153.9"></a><span id="l153.9"> </span>
<a href="#l153.10"></a><span id="l153.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l153.11"></a><span id="l153.11" class="difflineminus">-</span>
<a href="#l153.12"></a><span id="l153.12" class="difflineminus">-var MODULE_NAME = &quot;test-message-sidebar&quot;;</span>
<a href="#l153.13"></a><span id="l153.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l153.14"></a><span id="l153.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l153.15"></a><span id="l153.15" class="difflineminus">-</span>
<a href="#l153.16"></a><span id="l153.16" class="difflineminus">-var setupModule = function(module) {</span>
<a href="#l153.17"></a><span id="l153.17" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l153.18"></a><span id="l153.18" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l153.19"></a><span id="l153.19" class="difflineminus">-};</span>
<a href="#l153.20"></a><span id="l153.20" class="difflineplus">+var { mc } = ChromeUtils.import(</span>
<a href="#l153.21"></a><span id="l153.21" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l153.22"></a><span id="l153.22" class="difflineplus">+);</span>
<a href="#l153.23"></a><span id="l153.23"> </span>
<a href="#l153.24"></a><span id="l153.24"> function test_messagepane_extension_points_exist() {</span>
<a href="#l153.25"></a><span id="l153.25">   mc.assertNode(mc.eid(&quot;messagepanewrapper&quot;));</span>
<a href="#l153.26"></a><span id="l153.26"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l154.1"></a><span id="l154.1" class="difflineminus">--- a/mail/test/mozmill/message-window/test-vcard-actions.js</span>
<a href="#l154.2"></a><span id="l154.2" class="difflineplus">+++ b/mail/test/mozmill/message-window/test-vcard-actions.js</span>
<a href="#l154.3"></a><span id="l154.3" class="difflineat">@@ -3,37 +3,30 @@</span>
<a href="#l154.4"></a><span id="l154.4">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l154.5"></a><span id="l154.5"> </span>
<a href="#l154.6"></a><span id="l154.6"> /**</span>
<a href="#l154.7"></a><span id="l154.7">  * Tests for attached vcards.</span>
<a href="#l154.8"></a><span id="l154.8">  */</span>
<a href="#l154.9"></a><span id="l154.9"> </span>
<a href="#l154.10"></a><span id="l154.10"> &quot;use strict&quot;;</span>
<a href="#l154.11"></a><span id="l154.11"> </span>
<a href="#l154.12"></a><span id="l154.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l154.13"></a><span id="l154.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l154.14"></a><span id="l154.14" class="difflineminus">-</span>
<a href="#l154.15"></a><span id="l154.15" class="difflineminus">-var MODULE_NAME = &quot;test-vcard-actions&quot;;</span>
<a href="#l154.16"></a><span id="l154.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l154.17"></a><span id="l154.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;address-book-helpers&quot;];</span>
<a href="#l154.18"></a><span id="l154.18" class="difflineminus">-</span>
<a href="#l154.19"></a><span id="l154.19"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l154.20"></a><span id="l154.20"> </span>
<a href="#l154.21"></a><span id="l154.21" class="difflineplus">+var { get_cards_in_all_address_books_for_email } = ChromeUtils.import(</span>
<a href="#l154.22"></a><span id="l154.22" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l154.23"></a><span id="l154.23" class="difflineplus">+);</span>
<a href="#l154.24"></a><span id="l154.24" class="difflineplus">+var { assert_equals, open_message_from_file } = ChromeUtils.import(</span>
<a href="#l154.25"></a><span id="l154.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l154.26"></a><span id="l154.26" class="difflineplus">+);</span>
<a href="#l154.27"></a><span id="l154.27"> var {</span>
<a href="#l154.28"></a><span id="l154.28">   close_window,</span>
<a href="#l154.29"></a><span id="l154.29">   plan_for_modal_dialog,</span>
<a href="#l154.30"></a><span id="l154.30">   wait_for_modal_dialog,</span>
<a href="#l154.31"></a><span id="l154.31"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l154.32"></a><span id="l154.32"> </span>
<a href="#l154.33"></a><span id="l154.33" class="difflineminus">-function setupModule(module) {</span>
<a href="#l154.34"></a><span id="l154.34" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l154.35"></a><span id="l154.35" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l154.36"></a><span id="l154.36" class="difflineminus">-  }</span>
<a href="#l154.37"></a><span id="l154.37" class="difflineminus">-}</span>
<a href="#l154.38"></a><span id="l154.38" class="difflineminus">-</span>
<a href="#l154.39"></a><span id="l154.39"> /**</span>
<a href="#l154.40"></a><span id="l154.40">  * Bug 1374779</span>
<a href="#l154.41"></a><span id="l154.41">  * Check if clicking attached vcard image opens new card dialog and adds a contact.</span>
<a href="#l154.42"></a><span id="l154.42">  */</span>
<a href="#l154.43"></a><span id="l154.43"> function test_check_vcard_icon() {</span>
<a href="#l154.44"></a><span id="l154.44">   let file = os.getFileForPath(</span>
<a href="#l154.45"></a><span id="l154.45">     os.abspath(&quot;./test-vcard-icon.eml&quot;, os.getFileForPath(__file__))</span>
<a href="#l154.46"></a><span id="l154.46">   );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l155.1"></a><span id="l155.1" class="difflineminus">--- a/mail/test/mozmill/message-window/test-view-plaintext.js</span>
<a href="#l155.2"></a><span id="l155.2" class="difflineplus">+++ b/mail/test/mozmill/message-window/test-view-plaintext.js</span>
<a href="#l155.3"></a><span id="l155.3" class="difflineat">@@ -3,36 +3,27 @@</span>
<a href="#l155.4"></a><span id="l155.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l155.5"></a><span id="l155.5"> </span>
<a href="#l155.6"></a><span id="l155.6"> /**</span>
<a href="#l155.7"></a><span id="l155.7">  * Tests that the plain text part of multipart/alternative messages can be correctly viewed.</span>
<a href="#l155.8"></a><span id="l155.8">  */</span>
<a href="#l155.9"></a><span id="l155.9"> </span>
<a href="#l155.10"></a><span id="l155.10"> &quot;use strict&quot;;</span>
<a href="#l155.11"></a><span id="l155.11"> </span>
<a href="#l155.12"></a><span id="l155.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l155.13"></a><span id="l155.13" class="difflineminus">-</span>
<a href="#l155.14"></a><span id="l155.14" class="difflineminus">-var MODULE_NAME = &quot;test-view-plaintext&quot;;</span>
<a href="#l155.15"></a><span id="l155.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l155.16"></a><span id="l155.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l155.17"></a><span id="l155.17" class="difflineminus">-</span>
<a href="#l155.18"></a><span id="l155.18"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l155.19"></a><span id="l155.19"> </span>
<a href="#l155.20"></a><span id="l155.20" class="difflineplus">+var { assert_false, assert_true, open_message_from_file } = ChromeUtils.import(</span>
<a href="#l155.21"></a><span id="l155.21" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l155.22"></a><span id="l155.22" class="difflineplus">+);</span>
<a href="#l155.23"></a><span id="l155.23"> var { close_window } = ChromeUtils.import(</span>
<a href="#l155.24"></a><span id="l155.24">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l155.25"></a><span id="l155.25"> );</span>
<a href="#l155.26"></a><span id="l155.26"> </span>
<a href="#l155.27"></a><span id="l155.27"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l155.28"></a><span id="l155.28"> </span>
<a href="#l155.29"></a><span id="l155.29" class="difflineminus">-function setupModule(module) {</span>
<a href="#l155.30"></a><span id="l155.30" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l155.31"></a><span id="l155.31" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l155.32"></a><span id="l155.32" class="difflineminus">-  }</span>
<a href="#l155.33"></a><span id="l155.33" class="difflineminus">-}</span>
<a href="#l155.34"></a><span id="l155.34" class="difflineminus">-</span>
<a href="#l155.35"></a><span id="l155.35"> /**</span>
<a href="#l155.36"></a><span id="l155.36">  * Retrieve the textual content of the message and compare it.</span>
<a href="#l155.37"></a><span id="l155.37">  *</span>
<a href="#l155.38"></a><span id="l155.38">  * @param aWindow         Message window.</span>
<a href="#l155.39"></a><span id="l155.39">  * @param aExpected       Expected content.</span>
<a href="#l155.40"></a><span id="l155.40">  * @param aDontWantToSee  Content of other MIME parts we don't want to see.</span>
<a href="#l155.41"></a><span id="l155.41">  */</span>
<a href="#l155.42"></a><span id="l155.42"> function check_content(aWindow, aExpected, aDontWantToSee) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l156.1"></a><span id="l156.1" class="difflineminus">--- a/mail/test/mozmill/multiple-identities/test-display-names.js</span>
<a href="#l156.2"></a><span id="l156.2" class="difflineplus">+++ b/mail/test/mozmill/multiple-identities/test-display-names.js</span>
<a href="#l156.3"></a><span id="l156.3" class="difflineat">@@ -4,22 +4,30 @@</span>
<a href="#l156.4"></a><span id="l156.4"> </span>
<a href="#l156.5"></a><span id="l156.5"> /*</span>
<a href="#l156.6"></a><span id="l156.6">  * Test that we can open and close a standalone message display window from the</span>
<a href="#l156.7"></a><span id="l156.7">  *  folder pane.</span>
<a href="#l156.8"></a><span id="l156.8">  */</span>
<a href="#l156.9"></a><span id="l156.9"> </span>
<a href="#l156.10"></a><span id="l156.10"> &quot;use strict&quot;;</span>
<a href="#l156.11"></a><span id="l156.11"> </span>
<a href="#l156.12"></a><span id="l156.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l156.13"></a><span id="l156.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l156.14"></a><span id="l156.14" class="difflineminus">-</span>
<a href="#l156.15"></a><span id="l156.15" class="difflineminus">-var MODULE_NAME = &quot;test-display-names&quot;;</span>
<a href="#l156.16"></a><span id="l156.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l156.17"></a><span id="l156.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;address-book-helpers&quot;];</span>
<a href="#l156.18"></a><span id="l156.18" class="difflineplus">+var { ensure_card_exists, ensure_no_card_exists } = ChromeUtils.import(</span>
<a href="#l156.19"></a><span id="l156.19" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l156.20"></a><span id="l156.20" class="difflineplus">+);</span>
<a href="#l156.21"></a><span id="l156.21" class="difflineplus">+var {</span>
<a href="#l156.22"></a><span id="l156.22" class="difflineplus">+  add_message_to_folder,</span>
<a href="#l156.23"></a><span id="l156.23" class="difflineplus">+  assert_true,</span>
<a href="#l156.24"></a><span id="l156.24" class="difflineplus">+  be_in_folder,</span>
<a href="#l156.25"></a><span id="l156.25" class="difflineplus">+  create_folder,</span>
<a href="#l156.26"></a><span id="l156.26" class="difflineplus">+  create_message,</span>
<a href="#l156.27"></a><span id="l156.27" class="difflineplus">+  mc,</span>
<a href="#l156.28"></a><span id="l156.28" class="difflineplus">+  select_click_row,</span>
<a href="#l156.29"></a><span id="l156.29" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l156.30"></a><span id="l156.30" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l156.31"></a><span id="l156.31" class="difflineplus">+);</span>
<a href="#l156.32"></a><span id="l156.32"> </span>
<a href="#l156.33"></a><span id="l156.33"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l156.34"></a><span id="l156.34"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l156.35"></a><span id="l156.35">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l156.36"></a><span id="l156.36"> );</span>
<a href="#l156.37"></a><span id="l156.37"> </span>
<a href="#l156.38"></a><span id="l156.38"> var folder;</span>
<a href="#l156.39"></a><span id="l156.39"> var decoyFolder;</span>
<a href="#l156.40"></a><span id="l156.40" class="difflineat">@@ -27,21 +35,16 @@ var localAccount;</span>
<a href="#l156.41"></a><span id="l156.41"> var secondIdentity;</span>
<a href="#l156.42"></a><span id="l156.42"> var myEmail = &quot;sender@nul.invalid&quot;; // Dictated by messagerInjector.js</span>
<a href="#l156.43"></a><span id="l156.43"> var friendEmail = &quot;carl@sagan.invalid&quot;;</span>
<a href="#l156.44"></a><span id="l156.44"> var friendName = &quot;Carl Sagan&quot;;</span>
<a href="#l156.45"></a><span id="l156.45"> var headertoFieldMe;</span>
<a href="#l156.46"></a><span id="l156.46"> var collectedAddresses;</span>
<a href="#l156.47"></a><span id="l156.47"> </span>
<a href="#l156.48"></a><span id="l156.48"> function setupModule(module) {</span>
<a href="#l156.49"></a><span id="l156.49" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l156.50"></a><span id="l156.50" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l156.51"></a><span id="l156.51" class="difflineminus">-  let abh = collector.getModule(&quot;address-book-helpers&quot;);</span>
<a href="#l156.52"></a><span id="l156.52" class="difflineminus">-  abh.installInto(module);</span>
<a href="#l156.53"></a><span id="l156.53" class="difflineminus">-</span>
<a href="#l156.54"></a><span id="l156.54">   localAccount = MailServices.accounts.FindAccountForServer(</span>
<a href="#l156.55"></a><span id="l156.55">     MailServices.accounts.localFoldersServer</span>
<a href="#l156.56"></a><span id="l156.56">   );</span>
<a href="#l156.57"></a><span id="l156.57"> </span>
<a href="#l156.58"></a><span id="l156.58">   // We need to make sure we have only one identity:</span>
<a href="#l156.59"></a><span id="l156.59">   // 1) Delete all accounts except for Local Folders</span>
<a href="#l156.60"></a><span id="l156.60">   for (let i = MailServices.accounts.accounts.length - 1; i &gt;= 0; i--) {</span>
<a href="#l156.61"></a><span id="l156.61">     let account = MailServices.accounts.accounts.queryElementAt(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l157.1"></a><span id="l157.1" class="difflineminus">--- a/mail/test/mozmill/newmailaccount/test-newmailaccount.js</span>
<a href="#l157.2"></a><span id="l157.2" class="difflineplus">+++ b/mail/test/mozmill/newmailaccount/test-newmailaccount.js</span>
<a href="#l157.3"></a><span id="l157.3" class="difflineat">@@ -3,52 +3,78 @@</span>
<a href="#l157.4"></a><span id="l157.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l157.5"></a><span id="l157.5"> </span>
<a href="#l157.6"></a><span id="l157.6"> /**</span>
<a href="#l157.7"></a><span id="l157.7">  * Tests the get an account (account provisioning) workflow.</span>
<a href="#l157.8"></a><span id="l157.8">  */</span>
<a href="#l157.9"></a><span id="l157.9"> </span>
<a href="#l157.10"></a><span id="l157.10"> &quot;use strict&quot;;</span>
<a href="#l157.11"></a><span id="l157.11"> </span>
<a href="#l157.12"></a><span id="l157.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l157.13"></a><span id="l157.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l157.14"></a><span id="l157.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-newmailaccount-helpers.js */</span>
<a href="#l157.15"></a><span id="l157.15" class="difflineminus">-/* import-globals-from ../shared-modules/test-dom-helpers.js */</span>
<a href="#l157.16"></a><span id="l157.16" class="difflineminus">-</span>
<a href="#l157.17"></a><span id="l157.17" class="difflineminus">-var MODULE_NAME = &quot;test-newmailaccount&quot;;</span>
<a href="#l157.18"></a><span id="l157.18" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l157.19"></a><span id="l157.19" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l157.20"></a><span id="l157.20" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l157.21"></a><span id="l157.21" class="difflineminus">-  &quot;content-tab-helpers&quot;,</span>
<a href="#l157.22"></a><span id="l157.22" class="difflineminus">-  &quot;newmailaccount-helpers&quot;,</span>
<a href="#l157.23"></a><span id="l157.23" class="difflineminus">-  &quot;dom-helpers&quot;,</span>
<a href="#l157.24"></a><span id="l157.24" class="difflineminus">-];</span>
<a href="#l157.25"></a><span id="l157.25" class="difflineminus">-</span>
<a href="#l157.26"></a><span id="l157.26"> var elib = ChromeUtils.import(</span>
<a href="#l157.27"></a><span id="l157.27">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l157.28"></a><span id="l157.28"> );</span>
<a href="#l157.29"></a><span id="l157.29" class="difflineplus">+var { HttpServer } = ChromeUtils.import(</span>
<a href="#l157.30"></a><span id="l157.30" class="difflineplus">+  &quot;chrome://mozmill/content/stdlib/httpd.jsm&quot;</span>
<a href="#l157.31"></a><span id="l157.31" class="difflineplus">+);</span>
<a href="#l157.32"></a><span id="l157.32"> </span>
<a href="#l157.33"></a><span id="l157.33"> var {</span>
<a href="#l157.34"></a><span id="l157.34" class="difflineplus">+  gMockExtProtSvc,</span>
<a href="#l157.35"></a><span id="l157.35" class="difflineplus">+  gMockExtProtSvcReg,</span>
<a href="#l157.36"></a><span id="l157.36" class="difflineplus">+  open_content_tab_with_click,</span>
<a href="#l157.37"></a><span id="l157.37" class="difflineplus">+  plan_for_content_tab_load,</span>
<a href="#l157.38"></a><span id="l157.38" class="difflineplus">+  wait_for_content_tab_load,</span>
<a href="#l157.39"></a><span id="l157.39" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l157.40"></a><span id="l157.40" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l157.41"></a><span id="l157.41" class="difflineplus">+);</span>
<a href="#l157.42"></a><span id="l157.42" class="difflineplus">+var {</span>
<a href="#l157.43"></a><span id="l157.43" class="difflineplus">+  assert_element_visible,</span>
<a href="#l157.44"></a><span id="l157.44" class="difflineplus">+  wait_for_element_enabled,</span>
<a href="#l157.45"></a><span id="l157.45" class="difflineplus">+  wait_for_element_invisible,</span>
<a href="#l157.46"></a><span id="l157.46" class="difflineplus">+  wait_for_element_visible,</span>
<a href="#l157.47"></a><span id="l157.47" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/DOMHelpers.jsm&quot;);</span>
<a href="#l157.48"></a><span id="l157.48" class="difflineplus">+var {</span>
<a href="#l157.49"></a><span id="l157.49" class="difflineplus">+  assert_equals,</span>
<a href="#l157.50"></a><span id="l157.50" class="difflineplus">+  assert_false,</span>
<a href="#l157.51"></a><span id="l157.51" class="difflineplus">+  assert_not_equals,</span>
<a href="#l157.52"></a><span id="l157.52" class="difflineplus">+  assert_selected_tab,</span>
<a href="#l157.53"></a><span id="l157.53" class="difflineplus">+  assert_true,</span>
<a href="#l157.54"></a><span id="l157.54" class="difflineplus">+  mc,</span>
<a href="#l157.55"></a><span id="l157.55" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l157.56"></a><span id="l157.56" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l157.57"></a><span id="l157.57" class="difflineplus">+);</span>
<a href="#l157.58"></a><span id="l157.58" class="difflineplus">+var {</span>
<a href="#l157.59"></a><span id="l157.59" class="difflineplus">+  assert_links_not_shown,</span>
<a href="#l157.60"></a><span id="l157.60" class="difflineplus">+  assert_links_shown,</span>
<a href="#l157.61"></a><span id="l157.61" class="difflineplus">+  gConsoleListener,</span>
<a href="#l157.62"></a><span id="l157.62" class="difflineplus">+  open_provisioner_window,</span>
<a href="#l157.63"></a><span id="l157.63" class="difflineplus">+  remove_email_account,</span>
<a href="#l157.64"></a><span id="l157.64" class="difflineplus">+  type_in_search_name,</span>
<a href="#l157.65"></a><span id="l157.65" class="difflineplus">+  wait_for_provider_list_loaded,</span>
<a href="#l157.66"></a><span id="l157.66" class="difflineplus">+  wait_for_search_ready,</span>
<a href="#l157.67"></a><span id="l157.67" class="difflineplus">+  wait_for_search_results,</span>
<a href="#l157.68"></a><span id="l157.68" class="difflineplus">+  wait_for_the_wizard_to_be_closed,</span>
<a href="#l157.69"></a><span id="l157.69" class="difflineplus">+  wait_to_be_offline,</span>
<a href="#l157.70"></a><span id="l157.70" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l157.71"></a><span id="l157.71" class="difflineplus">+  &quot;resource://testing-common/mozmill/NewMailAccountHelpers.jsm&quot;</span>
<a href="#l157.72"></a><span id="l157.72" class="difflineplus">+);</span>
<a href="#l157.73"></a><span id="l157.73" class="difflineplus">+var {</span>
<a href="#l157.74"></a><span id="l157.74">   close_window,</span>
<a href="#l157.75"></a><span id="l157.75">   plan_for_modal_dialog,</span>
<a href="#l157.76"></a><span id="l157.76">   plan_for_new_window,</span>
<a href="#l157.77"></a><span id="l157.77">   plan_for_window_close,</span>
<a href="#l157.78"></a><span id="l157.78">   wait_for_browser_load,</span>
<a href="#l157.79"></a><span id="l157.79">   wait_for_modal_dialog,</span>
<a href="#l157.80"></a><span id="l157.80">   wait_for_new_window,</span>
<a href="#l157.81"></a><span id="l157.81">   wait_for_window_close,</span>
<a href="#l157.82"></a><span id="l157.82"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l157.83"></a><span id="l157.83"> </span>
<a href="#l157.84"></a><span id="l157.84"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l157.85"></a><span id="l157.85"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l157.86"></a><span id="l157.86">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l157.87"></a><span id="l157.87"> );</span>
<a href="#l157.88"></a><span id="l157.88" class="difflineminus">-var { HttpServer } = ChromeUtils.import(</span>
<a href="#l157.89"></a><span id="l157.89" class="difflineminus">-  &quot;chrome://mozmill/content/stdlib/httpd.jsm&quot;</span>
<a href="#l157.90"></a><span id="l157.90" class="difflineminus">-);</span>
<a href="#l157.91"></a><span id="l157.91"> </span>
<a href="#l157.92"></a><span id="l157.92"> // RELATIVE_ROOT messes with the collector, so we have to bring the path back</span>
<a href="#l157.93"></a><span id="l157.93"> // so we get the right path for the resources.</span>
<a href="#l157.94"></a><span id="l157.94"> var url = collector.addHttpResource(&quot;../newmailaccount/html&quot;, &quot;&quot;);</span>
<a href="#l157.95"></a><span id="l157.95"> var kProvisionerUrl =</span>
<a href="#l157.96"></a><span id="l157.96">   &quot;chrome://messenger/content/newmailaccount/accountProvisioner.xhtml&quot;;</span>
<a href="#l157.97"></a><span id="l157.97"> var kProvisionerEnabledPref = &quot;mail.provider.enabled&quot;;</span>
<a href="#l157.98"></a><span id="l157.98"> var kSuggestFromNamePref = &quot;mail.provider.suggestFromName&quot;;</span>
<a href="#l157.99"></a><span id="l157.99" class="difflineat">@@ -65,20 +91,16 @@ var NAME = &quot;Leonard Shelby&quot;;</span>
<a href="#l157.100"></a><span id="l157.100"> </span>
<a href="#l157.101"></a><span id="l157.101"> // Record what the original value of the mail.provider.enabled pref is so</span>
<a href="#l157.102"></a><span id="l157.102"> // that we can put it back once the tests are done.</span>
<a href="#l157.103"></a><span id="l157.103"> var gProvisionerEnabled = Services.prefs.getBoolPref(kProvisionerEnabledPref);</span>
<a href="#l157.104"></a><span id="l157.104"> var gOldAcceptLangs = Services.locale.requestedLocales;</span>
<a href="#l157.105"></a><span id="l157.105"> var gNumAccounts;</span>
<a href="#l157.106"></a><span id="l157.106"> </span>
<a href="#l157.107"></a><span id="l157.107"> function setupModule(module) {</span>
<a href="#l157.108"></a><span id="l157.108" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l157.109"></a><span id="l157.109" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l157.110"></a><span id="l157.110" class="difflineminus">-  }</span>
<a href="#l157.111"></a><span id="l157.111" class="difflineminus">-</span>
<a href="#l157.112"></a><span id="l157.112">   // Make sure we enable the Account Provisioner.</span>
<a href="#l157.113"></a><span id="l157.113">   Services.prefs.setBoolPref(kProvisionerEnabledPref, true);</span>
<a href="#l157.114"></a><span id="l157.114">   // Restrict the user's language to just en-US</span>
<a href="#l157.115"></a><span id="l157.115">   Services.locale.requestedLocales = [&quot;en-US&quot;];</span>
<a href="#l157.116"></a><span id="l157.116"> </span>
<a href="#l157.117"></a><span id="l157.117">   // Add a &quot;bar&quot; search engine that we can switch to be the default.</span>
<a href="#l157.118"></a><span id="l157.118">   let engineAdded = false;</span>
<a href="#l157.119"></a><span id="l157.119">   Services.search</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l158.1"></a><span id="l158.1" class="difflineminus">--- a/mail/test/mozmill/notification/test-notification.js</span>
<a href="#l158.2"></a><span id="l158.2" class="difflineplus">+++ b/mail/test/mozmill/notification/test-notification.js</span>
<a href="#l158.3"></a><span id="l158.3" class="difflineat">@@ -1,20 +1,23 @@</span>
<a href="#l158.4"></a><span id="l158.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l158.5"></a><span id="l158.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l158.6"></a><span id="l158.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l158.7"></a><span id="l158.7"> </span>
<a href="#l158.8"></a><span id="l158.8"> &quot;use strict&quot;;</span>
<a href="#l158.9"></a><span id="l158.9"> </span>
<a href="#l158.10"></a><span id="l158.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l158.11"></a><span id="l158.11" class="difflineminus">-</span>
<a href="#l158.12"></a><span id="l158.12" class="difflineminus">-var MODULE_NAME = &quot;test-notifications&quot;;</span>
<a href="#l158.13"></a><span id="l158.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l158.14"></a><span id="l158.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l158.15"></a><span id="l158.15" class="difflineminus">-</span>
<a href="#l158.16"></a><span id="l158.16" class="difflineplus">+var {</span>
<a href="#l158.17"></a><span id="l158.17" class="difflineplus">+  assert_false,</span>
<a href="#l158.18"></a><span id="l158.18" class="difflineplus">+  assert_true,</span>
<a href="#l158.19"></a><span id="l158.19" class="difflineplus">+  be_in_folder,</span>
<a href="#l158.20"></a><span id="l158.20" class="difflineplus">+  create_folder,</span>
<a href="#l158.21"></a><span id="l158.21" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l158.22"></a><span id="l158.22" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l158.23"></a><span id="l158.23" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l158.24"></a><span id="l158.24" class="difflineplus">+);</span>
<a href="#l158.25"></a><span id="l158.25"> var {</span>
<a href="#l158.26"></a><span id="l158.26">   plan_for_new_window,</span>
<a href="#l158.27"></a><span id="l158.27">   plan_for_window_close,</span>
<a href="#l158.28"></a><span id="l158.28">   wait_for_new_window,</span>
<a href="#l158.29"></a><span id="l158.29">   wait_for_window_close,</span>
<a href="#l158.30"></a><span id="l158.30"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l158.31"></a><span id="l158.31"> </span>
<a href="#l158.32"></a><span id="l158.32"> var { XPCOMUtils } = ChromeUtils.import(</span>
<a href="#l158.33"></a><span id="l158.33" class="difflineat">@@ -105,19 +108,16 @@ var gMockAlertsServiceFactory = {</span>
<a href="#l158.34"></a><span id="l158.34">       throw Cr.NS_ERROR_NO_INTERFACE;</span>
<a href="#l158.35"></a><span id="l158.35">     }</span>
<a href="#l158.36"></a><span id="l158.36"> </span>
<a href="#l158.37"></a><span id="l158.37">     return gMockAlertsService;</span>
<a href="#l158.38"></a><span id="l158.38">   },</span>
<a href="#l158.39"></a><span id="l158.39"> };</span>
<a href="#l158.40"></a><span id="l158.40"> </span>
<a href="#l158.41"></a><span id="l158.41"> function setupModule(module) {</span>
<a href="#l158.42"></a><span id="l158.42" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l158.43"></a><span id="l158.43" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l158.44"></a><span id="l158.44" class="difflineminus">-</span>
<a href="#l158.45"></a><span id="l158.45">   // Register the mock alerts service</span>
<a href="#l158.46"></a><span id="l158.46">   Components.manager</span>
<a href="#l158.47"></a><span id="l158.47">     .QueryInterface(Ci.nsIComponentRegistrar)</span>
<a href="#l158.48"></a><span id="l158.48">     .registerFactory(</span>
<a href="#l158.49"></a><span id="l158.49">       Components.ID(&quot;{1bda6c33-b089-43df-a8fd-111907d6385a}&quot;),</span>
<a href="#l158.50"></a><span id="l158.50">       &quot;Mock Alerts Service&quot;,</span>
<a href="#l158.51"></a><span id="l158.51">       &quot;@mozilla.org/system-alerts-service;1&quot;,</span>
<a href="#l158.52"></a><span id="l158.52">       gMockAlertsServiceFactory</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l159.1"></a><span id="l159.1" class="difflineminus">--- a/mail/test/mozmill/override-main-menu-collapse/test-override-mainmenu-collapse.js</span>
<a href="#l159.2"></a><span id="l159.2" class="difflineplus">+++ b/mail/test/mozmill/override-main-menu-collapse/test-override-mainmenu-collapse.js</span>
<a href="#l159.3"></a><span id="l159.3" class="difflineat">@@ -5,32 +5,25 @@</span>
<a href="#l159.4"></a><span id="l159.4"> /**</span>
<a href="#l159.5"></a><span id="l159.5">  * Tests that the main menu will NOT be collapsed by default if Thunderbird</span>
<a href="#l159.6"></a><span id="l159.6">  * starts with no accounts created, and mail.main_menu.collapse_by_default set</span>
<a href="#l159.7"></a><span id="l159.7">  * to false.</span>
<a href="#l159.8"></a><span id="l159.8">  */</span>
<a href="#l159.9"></a><span id="l159.9"> </span>
<a href="#l159.10"></a><span id="l159.10"> &quot;use strict&quot;;</span>
<a href="#l159.11"></a><span id="l159.11"> </span>
<a href="#l159.12"></a><span id="l159.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l159.13"></a><span id="l159.13" class="difflineminus">-</span>
<a href="#l159.14"></a><span id="l159.14" class="difflineminus">-var MODULE_NAME = &quot;test-override-mainmenu-collapse&quot;;</span>
<a href="#l159.15"></a><span id="l159.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l159.16"></a><span id="l159.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l159.17"></a><span id="l159.17" class="difflineminus">-</span>
<a href="#l159.18"></a><span id="l159.18" class="difflineplus">+var { assert_false, mc } = ChromeUtils.import(</span>
<a href="#l159.19"></a><span id="l159.19" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l159.20"></a><span id="l159.20" class="difflineplus">+);</span>
<a href="#l159.21"></a><span id="l159.21"> var { close_window, wait_for_existing_window } = ChromeUtils.import(</span>
<a href="#l159.22"></a><span id="l159.22">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l159.23"></a><span id="l159.23"> );</span>
<a href="#l159.24"></a><span id="l159.24"> </span>
<a href="#l159.25"></a><span id="l159.25"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l159.26"></a><span id="l159.26"> </span>
<a href="#l159.27"></a><span id="l159.27" class="difflineminus">-function setupModule(module) {</span>
<a href="#l159.28"></a><span id="l159.28" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l159.29"></a><span id="l159.29" class="difflineminus">-}</span>
<a href="#l159.30"></a><span id="l159.30" class="difflineminus">-</span>
<a href="#l159.31"></a><span id="l159.31"> function test_main_menu_not_collapsed() {</span>
<a href="#l159.32"></a><span id="l159.32">   // Due to random oranges on slower machines, we need to ensure that startup</span>
<a href="#l159.33"></a><span id="l159.33">   // is complete before running this test.</span>
<a href="#l159.34"></a><span id="l159.34">   let done = false;</span>
<a href="#l159.35"></a><span id="l159.35">   let observer = {</span>
<a href="#l159.36"></a><span id="l159.36">     observe(aSubject, aTopic, aData) {</span>
<a href="#l159.37"></a><span id="l159.37">       if (aTopic == &quot;mail-startup-done&quot;) {</span>
<a href="#l159.38"></a><span id="l159.38">         done = true;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l160.1"></a><span id="l160.1" class="difflineminus">--- a/mail/test/mozmill/pref-window/test-font-chooser.js</span>
<a href="#l160.2"></a><span id="l160.2" class="difflineplus">+++ b/mail/test/mozmill/pref-window/test-font-chooser.js</span>
<a href="#l160.3"></a><span id="l160.3" class="difflineat">@@ -7,28 +7,25 @@</span>
<a href="#l160.4"></a><span id="l160.4">  * Test various things about the font chooser window, including</span>
<a href="#l160.5"></a><span id="l160.5">  * - whether if the font defined in font.name.&lt;style&gt;.&lt;language&gt; is not present</span>
<a href="#l160.6"></a><span id="l160.6">  * on the computer, we fall back to displaying what's in</span>
<a href="#l160.7"></a><span id="l160.7">  * font.name-list.&lt;style&gt;.&lt;language&gt;.</span>
<a href="#l160.8"></a><span id="l160.8">  */</span>
<a href="#l160.9"></a><span id="l160.9"> </span>
<a href="#l160.10"></a><span id="l160.10"> &quot;use strict&quot;;</span>
<a href="#l160.11"></a><span id="l160.11"> </span>
<a href="#l160.12"></a><span id="l160.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l160.13"></a><span id="l160.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l160.14"></a><span id="l160.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-pref-window-helpers.js */</span>
<a href="#l160.15"></a><span id="l160.15" class="difflineminus">-</span>
<a href="#l160.16"></a><span id="l160.16" class="difflineminus">-var MODULE_NAME = &quot;test-font-chooser&quot;;</span>
<a href="#l160.17"></a><span id="l160.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l160.18"></a><span id="l160.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l160.19"></a><span id="l160.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l160.20"></a><span id="l160.20" class="difflineminus">-  &quot;pref-window-helpers&quot;,</span>
<a href="#l160.21"></a><span id="l160.21" class="difflineminus">-  &quot;content-tab-helpers&quot;,</span>
<a href="#l160.22"></a><span id="l160.22" class="difflineminus">-];</span>
<a href="#l160.23"></a><span id="l160.23" class="difflineminus">-</span>
<a href="#l160.24"></a><span id="l160.24" class="difflineplus">+var { content_tab_e, content_tab_eid } = ChromeUtils.import(</span>
<a href="#l160.25"></a><span id="l160.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l160.26"></a><span id="l160.26" class="difflineplus">+);</span>
<a href="#l160.27"></a><span id="l160.27" class="difflineplus">+var { mc } = ChromeUtils.import(</span>
<a href="#l160.28"></a><span id="l160.28" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l160.29"></a><span id="l160.29" class="difflineplus">+);</span>
<a href="#l160.30"></a><span id="l160.30" class="difflineplus">+var { close_pref_tab, open_pref_tab } = ChromeUtils.import(</span>
<a href="#l160.31"></a><span id="l160.31" class="difflineplus">+  &quot;resource://testing-common/mozmill/PrefTabHelpers.jsm&quot;</span>
<a href="#l160.32"></a><span id="l160.32" class="difflineplus">+);</span>
<a href="#l160.33"></a><span id="l160.33"> var { wait_for_frame_load } = ChromeUtils.import(</span>
<a href="#l160.34"></a><span id="l160.34">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l160.35"></a><span id="l160.35"> );</span>
<a href="#l160.36"></a><span id="l160.36"> </span>
<a href="#l160.37"></a><span id="l160.37"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l160.38"></a><span id="l160.38"> var { AppConstants } = ChromeUtils.import(</span>
<a href="#l160.39"></a><span id="l160.39">   &quot;resource://gre/modules/AppConstants.jsm&quot;</span>
<a href="#l160.40"></a><span id="l160.40"> );</span>
<a href="#l160.41"></a><span id="l160.41" class="difflineat">@@ -44,20 +41,16 @@ const kLanguage = &quot;x-western&quot;;</span>
<a href="#l160.42"></a><span id="l160.42"> </span>
<a href="#l160.43"></a><span id="l160.43"> // A list of fonts present on the computer for each font type.</span>
<a href="#l160.44"></a><span id="l160.44"> var gRealFontLists = {};</span>
<a href="#l160.45"></a><span id="l160.45"> </span>
<a href="#l160.46"></a><span id="l160.46"> // A list of font types to consider</span>
<a href="#l160.47"></a><span id="l160.47"> const kFontTypes = [&quot;serif&quot;, &quot;sans-serif&quot;, &quot;monospace&quot;];</span>
<a href="#l160.48"></a><span id="l160.48"> </span>
<a href="#l160.49"></a><span id="l160.49"> function setupModule(module) {</span>
<a href="#l160.50"></a><span id="l160.50" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l160.51"></a><span id="l160.51" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l160.52"></a><span id="l160.52" class="difflineminus">-  }</span>
<a href="#l160.53"></a><span id="l160.53" class="difflineminus">-</span>
<a href="#l160.54"></a><span id="l160.54">   let finished = false;</span>
<a href="#l160.55"></a><span id="l160.55">   buildFontList().then(() =&gt; (finished = true), Cu.reportError);</span>
<a href="#l160.56"></a><span id="l160.56">   mc.waitFor(</span>
<a href="#l160.57"></a><span id="l160.57">     () =&gt; finished,</span>
<a href="#l160.58"></a><span id="l160.58">     &quot;Timeout waiting for font enumeration to complete.&quot;</span>
<a href="#l160.59"></a><span id="l160.59">   );</span>
<a href="#l160.60"></a><span id="l160.60"> </span>
<a href="#l160.61"></a><span id="l160.61">   // Hide Lightning's Today pane as it obscures buttons in preferences in the</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l161.1"></a><span id="l161.1" class="difflineminus">--- a/mail/test/mozmill/quick-filter-bar/test-display-issues.js</span>
<a href="#l161.2"></a><span id="l161.2" class="difflineplus">+++ b/mail/test/mozmill/quick-filter-bar/test-display-issues.js</span>
<a href="#l161.3"></a><span id="l161.3" class="difflineat">@@ -6,51 +6,63 @@</span>
<a href="#l161.4"></a><span id="l161.4">  * Test things of a visual nature.</span>
<a href="#l161.5"></a><span id="l161.5">  *</span>
<a href="#l161.6"></a><span id="l161.6">  * Note: this test requires a screen resolution of 1280 x 1024 which is standard on</span>
<a href="#l161.7"></a><span id="l161.7">  * the unit test machines (see also testing/machine-configuration.json).</span>
<a href="#l161.8"></a><span id="l161.8">  */</span>
<a href="#l161.9"></a><span id="l161.9"> </span>
<a href="#l161.10"></a><span id="l161.10"> &quot;use strict&quot;;</span>
<a href="#l161.11"></a><span id="l161.11"> </span>
<a href="#l161.12"></a><span id="l161.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-dom-helpers.js */</span>
<a href="#l161.13"></a><span id="l161.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l161.14"></a><span id="l161.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-quick-filter-bar-helpers.js */</span>
<a href="#l161.15"></a><span id="l161.15" class="difflineminus">-</span>
<a href="#l161.16"></a><span id="l161.16" class="difflineminus">-var MODULE_NAME = &quot;test-display-issues&quot;;</span>
<a href="#l161.17"></a><span id="l161.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l161.18"></a><span id="l161.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l161.19"></a><span id="l161.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l161.20"></a><span id="l161.20" class="difflineminus">-  &quot;quick-filter-bar-helpers&quot;,</span>
<a href="#l161.21"></a><span id="l161.21" class="difflineminus">-  &quot;dom-helpers&quot;,</span>
<a href="#l161.22"></a><span id="l161.22" class="difflineminus">-];</span>
<a href="#l161.23"></a><span id="l161.23" class="difflineminus">-</span>
<a href="#l161.24"></a><span id="l161.24" class="difflineplus">+var { collapse_panes } = ChromeUtils.import(</span>
<a href="#l161.25"></a><span id="l161.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/DOMHelpers.jsm&quot;</span>
<a href="#l161.26"></a><span id="l161.26" class="difflineplus">+);</span>
<a href="#l161.27"></a><span id="l161.27" class="difflineplus">+var {</span>
<a href="#l161.28"></a><span id="l161.28" class="difflineplus">+  assert_default_window_size,</span>
<a href="#l161.29"></a><span id="l161.29" class="difflineplus">+  assert_pane_layout,</span>
<a href="#l161.30"></a><span id="l161.30" class="difflineplus">+  assert_true,</span>
<a href="#l161.31"></a><span id="l161.31" class="difflineplus">+  be_in_folder,</span>
<a href="#l161.32"></a><span id="l161.32" class="difflineplus">+  create_folder,</span>
<a href="#l161.33"></a><span id="l161.33" class="difflineplus">+  gDefaultWindowHeight,</span>
<a href="#l161.34"></a><span id="l161.34" class="difflineplus">+  gDefaultWindowWidth,</span>
<a href="#l161.35"></a><span id="l161.35" class="difflineplus">+  kClassicMailLayout,</span>
<a href="#l161.36"></a><span id="l161.36" class="difflineplus">+  kVerticalMailLayout,</span>
<a href="#l161.37"></a><span id="l161.37" class="difflineplus">+  mark_action,</span>
<a href="#l161.38"></a><span id="l161.38" class="difflineplus">+  mc,</span>
<a href="#l161.39"></a><span id="l161.39" class="difflineplus">+  open_folder_in_new_window,</span>
<a href="#l161.40"></a><span id="l161.40" class="difflineplus">+  restore_default_window_size,</span>
<a href="#l161.41"></a><span id="l161.41" class="difflineplus">+  set_pane_layout,</span>
<a href="#l161.42"></a><span id="l161.42" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l161.43"></a><span id="l161.43" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l161.44"></a><span id="l161.44" class="difflineplus">+);</span>
<a href="#l161.45"></a><span id="l161.45" class="difflineplus">+var {</span>
<a href="#l161.46"></a><span id="l161.46" class="difflineplus">+  assert_quick_filter_bar_visible,</span>
<a href="#l161.47"></a><span id="l161.47" class="difflineplus">+  clear_constraints,</span>
<a href="#l161.48"></a><span id="l161.48" class="difflineplus">+  toggle_quick_filter_bar,</span>
<a href="#l161.49"></a><span id="l161.49" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l161.50"></a><span id="l161.50" class="difflineplus">+  &quot;resource://testing-common/mozmill/QuickFilterBarHelpers.jsm&quot;</span>
<a href="#l161.51"></a><span id="l161.51" class="difflineplus">+);</span>
<a href="#l161.52"></a><span id="l161.52"> var { close_window, resize_to } = ChromeUtils.import(</span>
<a href="#l161.53"></a><span id="l161.53">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l161.54"></a><span id="l161.54"> );</span>
<a href="#l161.55"></a><span id="l161.55"> </span>
<a href="#l161.56"></a><span id="l161.56"> var folder;</span>
<a href="#l161.57"></a><span id="l161.57"> var setUnstarred, setStarred;</span>
<a href="#l161.58"></a><span id="l161.58"> var gOriginalPaneWidth;</span>
<a href="#l161.59"></a><span id="l161.59"> </span>
<a href="#l161.60"></a><span id="l161.60"> var gEnlargedWindowWidth = 1260;</span>
<a href="#l161.61"></a><span id="l161.61"> var gShrunkenWindowWidth = 600;</span>
<a href="#l161.62"></a><span id="l161.62"> </span>
<a href="#l161.63"></a><span id="l161.63"> var gTodayPane;</span>
<a href="#l161.64"></a><span id="l161.64"> </span>
<a href="#l161.65"></a><span id="l161.65"> function setupModule(module) {</span>
<a href="#l161.66"></a><span id="l161.66" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l161.67"></a><span id="l161.67" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l161.68"></a><span id="l161.68" class="difflineminus">-  }</span>
<a href="#l161.69"></a><span id="l161.69" class="difflineminus">-</span>
<a href="#l161.70"></a><span id="l161.70">   folder = create_folder(&quot;QuickFilterBarDisplayIssues&quot;);</span>
<a href="#l161.71"></a><span id="l161.71">   be_in_folder(folder);</span>
<a href="#l161.72"></a><span id="l161.72"> </span>
<a href="#l161.73"></a><span id="l161.73">   // Let's check window dimensions so we can enlarge from them.</span>
<a href="#l161.74"></a><span id="l161.74" class="difflineminus">-  assert_default_window_size();</span>
<a href="#l161.75"></a><span id="l161.75" class="difflineplus">+  restore_default_window_size();</span>
<a href="#l161.76"></a><span id="l161.76">   assert_true(</span>
<a href="#l161.77"></a><span id="l161.77">     gEnlargedWindowWidth &gt; gDefaultWindowWidth,</span>
<a href="#l161.78"></a><span id="l161.78">     &quot;Main window too large for the test logic&quot;</span>
<a href="#l161.79"></a><span id="l161.79">   );</span>
<a href="#l161.80"></a><span id="l161.80"> </span>
<a href="#l161.81"></a><span id="l161.81">   // Store folder pane width that we will change temporarily.</span>
<a href="#l161.82"></a><span id="l161.82">   let folderPaneBox = mc.e(&quot;folderPaneBox&quot;);</span>
<a href="#l161.83"></a><span id="l161.83">   gOriginalPaneWidth = folderPaneBox.width;</span>
<a href="#l161.84"></a><span id="l161.84" class="difflineat">@@ -165,16 +177,24 @@ function test_buttons_collapse_and_expan</span>
<a href="#l161.85"></a><span id="l161.85">     () =&gt; qfb.getAttribute(&quot;shrink&quot;) == &quot;true&quot;,</span>
<a href="#l161.86"></a><span id="l161.86">     &quot;New 3pane should have had a collapsed QFB&quot;</span>
<a href="#l161.87"></a><span id="l161.87">   );</span>
<a href="#l161.88"></a><span id="l161.88">   close_window(mc2);</span>
<a href="#l161.89"></a><span id="l161.89"> </span>
<a href="#l161.90"></a><span id="l161.90">   set_pane_layout(kClassicMailLayout);</span>
<a href="#l161.91"></a><span id="l161.91"> }</span>
<a href="#l161.92"></a><span id="l161.92"> </span>
<a href="#l161.93"></a><span id="l161.93" class="difflineplus">+function teardownTest() {</span>
<a href="#l161.94"></a><span id="l161.94" class="difflineplus">+  clear_constraints();</span>
<a href="#l161.95"></a><span id="l161.95" class="difflineplus">+  // make it visible if it's not</span>
<a href="#l161.96"></a><span id="l161.96" class="difflineplus">+  if (mc.e(&quot;quick-filter-bar&quot;).collapsed) {</span>
<a href="#l161.97"></a><span id="l161.97" class="difflineplus">+    toggle_quick_filter_bar();</span>
<a href="#l161.98"></a><span id="l161.98" class="difflineplus">+  }</span>
<a href="#l161.99"></a><span id="l161.99" class="difflineplus">+}</span>
<a href="#l161.100"></a><span id="l161.100" class="difflineplus">+</span>
<a href="#l161.101"></a><span id="l161.101"> function teardownModule() {</span>
<a href="#l161.102"></a><span id="l161.102">   // Restore the window to original layout.</span>
<a href="#l161.103"></a><span id="l161.103">   restore_default_window_size();</span>
<a href="#l161.104"></a><span id="l161.104">   collapse_panes(mc.e(&quot;folderpane_splitter&quot;), false);</span>
<a href="#l161.105"></a><span id="l161.105">   let folderPaneBox = mc.e(&quot;folderPaneBox&quot;);</span>
<a href="#l161.106"></a><span id="l161.106">   folderPaneBox.width = gOriginalPaneWidth;</span>
<a href="#l161.107"></a><span id="l161.107"> </span>
<a href="#l161.108"></a><span id="l161.108">   if (gTodayPane &amp;&amp; gTodayPane.collapsed) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l162.1"></a><span id="l162.1" class="difflineminus">--- a/mail/test/mozmill/quick-filter-bar/test-filter-logic.js</span>
<a href="#l162.2"></a><span id="l162.2" class="difflineplus">+++ b/mail/test/mozmill/quick-filter-bar/test-filter-logic.js</span>
<a href="#l162.3"></a><span id="l162.3" class="difflineat">@@ -4,27 +4,45 @@</span>
<a href="#l162.4"></a><span id="l162.4"> </span>
<a href="#l162.5"></a><span id="l162.5"> /**</span>
<a href="#l162.6"></a><span id="l162.6">  * Verify that we are constructing the filters that we expect and that they</span>
<a href="#l162.7"></a><span id="l162.7">  * are hooked up to the right buttons.</span>
<a href="#l162.8"></a><span id="l162.8">  */</span>
<a href="#l162.9"></a><span id="l162.9"> </span>
<a href="#l162.10"></a><span id="l162.10"> &quot;use strict&quot;;</span>
<a href="#l162.11"></a><span id="l162.11"> </span>
<a href="#l162.12"></a><span id="l162.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l162.13"></a><span id="l162.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-quick-filter-bar-helpers.js */</span>
<a href="#l162.14"></a><span id="l162.14" class="difflineplus">+var {</span>
<a href="#l162.15"></a><span id="l162.15" class="difflineplus">+  assert_messages_in_view,</span>
<a href="#l162.16"></a><span id="l162.16" class="difflineplus">+  assert_messages_not_in_view,</span>
<a href="#l162.17"></a><span id="l162.17" class="difflineplus">+  be_in_folder,</span>
<a href="#l162.18"></a><span id="l162.18" class="difflineplus">+  create_folder,</span>
<a href="#l162.19"></a><span id="l162.19" class="difflineplus">+  delete_message_set,</span>
<a href="#l162.20"></a><span id="l162.20" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l162.21"></a><span id="l162.21" class="difflineplus">+  mc,</span>
<a href="#l162.22"></a><span id="l162.22" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l162.23"></a><span id="l162.23" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l162.24"></a><span id="l162.24" class="difflineplus">+);</span>
<a href="#l162.25"></a><span id="l162.25" class="difflineplus">+var {</span>
<a href="#l162.26"></a><span id="l162.26" class="difflineplus">+  assert_quick_filter_bar_visible,</span>
<a href="#l162.27"></a><span id="l162.27" class="difflineplus">+  assert_results_label_count,</span>
<a href="#l162.28"></a><span id="l162.28" class="difflineplus">+  assert_text_constraints_checked,</span>
<a href="#l162.29"></a><span id="l162.29" class="difflineplus">+  clear_constraints,</span>
<a href="#l162.30"></a><span id="l162.30" class="difflineplus">+  set_filter_text,</span>
<a href="#l162.31"></a><span id="l162.31" class="difflineplus">+  toggle_boolean_constraints,</span>
<a href="#l162.32"></a><span id="l162.32" class="difflineplus">+  toggle_quick_filter_bar,</span>
<a href="#l162.33"></a><span id="l162.33" class="difflineplus">+  toggle_tag_constraints,</span>
<a href="#l162.34"></a><span id="l162.34" class="difflineplus">+  toggle_tag_mode,</span>
<a href="#l162.35"></a><span id="l162.35" class="difflineplus">+  toggle_text_constraints,</span>
<a href="#l162.36"></a><span id="l162.36" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l162.37"></a><span id="l162.37" class="difflineplus">+  &quot;resource://testing-common/mozmill/QuickFilterBarHelpers.jsm&quot;</span>
<a href="#l162.38"></a><span id="l162.38" class="difflineplus">+);</span>
<a href="#l162.39"></a><span id="l162.39"> </span>
<a href="#l162.40"></a><span id="l162.40" class="difflineminus">-var MODULE_NAME = &quot;test-filter-logic&quot;;</span>
<a href="#l162.41"></a><span id="l162.41" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l162.42"></a><span id="l162.42" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;quick-filter-bar-helpers&quot;];</span>
<a href="#l162.43"></a><span id="l162.43" class="difflineminus">-</span>
<a href="#l162.44"></a><span id="l162.44" class="difflineminus">-function setupModule(module) {</span>
<a href="#l162.45"></a><span id="l162.45" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l162.46"></a><span id="l162.46" class="difflineminus">-  collector.getModule(&quot;quick-filter-bar-helpers&quot;).installInto(module);</span>
<a href="#l162.47"></a><span id="l162.47" class="difflineminus">-}</span>
<a href="#l162.48"></a><span id="l162.48" class="difflineplus">+var { MailServices } = ChromeUtils.import(</span>
<a href="#l162.49"></a><span id="l162.49" class="difflineplus">+  &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l162.50"></a><span id="l162.50" class="difflineplus">+);</span>
<a href="#l162.51"></a><span id="l162.51"> </span>
<a href="#l162.52"></a><span id="l162.52"> function test_filter_unread() {</span>
<a href="#l162.53"></a><span id="l162.53">   let folder = create_folder(&quot;QuickFilterBarFilterUnread&quot;);</span>
<a href="#l162.54"></a><span id="l162.54">   let [unread, read] = make_new_sets_in_folder(folder, [</span>
<a href="#l162.55"></a><span id="l162.55">     { count: 1 },</span>
<a href="#l162.56"></a><span id="l162.56">     { count: 1 },</span>
<a href="#l162.57"></a><span id="l162.57">   ]);</span>
<a href="#l162.58"></a><span id="l162.58">   read.setRead(true);</span>
<a href="#l162.59"></a><span id="l162.59" class="difflineat">@@ -397,8 +415,16 @@ function test_results_label() {</span>
<a href="#l162.60"></a><span id="l162.60">   assert_results_label_count(2);</span>
<a href="#l162.61"></a><span id="l162.61"> </span>
<a href="#l162.62"></a><span id="l162.62">   delete_message_set(setMortal);</span>
<a href="#l162.63"></a><span id="l162.63">   assert_results_label_count(1);</span>
<a href="#l162.64"></a><span id="l162.64"> </span>
<a href="#l162.65"></a><span id="l162.65">   delete_message_set(setImmortal);</span>
<a href="#l162.66"></a><span id="l162.66">   assert_results_label_count(0);</span>
<a href="#l162.67"></a><span id="l162.67"> }</span>
<a href="#l162.68"></a><span id="l162.68" class="difflineplus">+</span>
<a href="#l162.69"></a><span id="l162.69" class="difflineplus">+function teardownTest() {</span>
<a href="#l162.70"></a><span id="l162.70" class="difflineplus">+  clear_constraints();</span>
<a href="#l162.71"></a><span id="l162.71" class="difflineplus">+  // make it visible if it's not</span>
<a href="#l162.72"></a><span id="l162.72" class="difflineplus">+  if (mc.e(&quot;quick-filter-bar&quot;).collapsed) {</span>
<a href="#l162.73"></a><span id="l162.73" class="difflineplus">+    toggle_quick_filter_bar();</span>
<a href="#l162.74"></a><span id="l162.74" class="difflineplus">+  }</span>
<a href="#l162.75"></a><span id="l162.75" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l163.1"></a><span id="l163.1" class="difflineminus">--- a/mail/test/mozmill/quick-filter-bar/test-keyboard-interface.js</span>
<a href="#l163.2"></a><span id="l163.2" class="difflineplus">+++ b/mail/test/mozmill/quick-filter-bar/test-keyboard-interface.js</span>
<a href="#l163.3"></a><span id="l163.3" class="difflineat">@@ -6,31 +6,40 @@</span>
<a href="#l163.4"></a><span id="l163.4">  * Tests keyboard stuff that doesn't fall under some other test's heading.</span>
<a href="#l163.5"></a><span id="l163.5">  * Namely, control-shift-k toggling the bar into existence happens in</span>
<a href="#l163.6"></a><span id="l163.6">  * test-toggle-bar.js, but we test that repeatedly hitting control-shift-k</span>
<a href="#l163.7"></a><span id="l163.7">  * selects the text entered in the quick filter bar.</span>
<a href="#l163.8"></a><span id="l163.8">  */</span>
<a href="#l163.9"></a><span id="l163.9"> </span>
<a href="#l163.10"></a><span id="l163.10"> &quot;use strict&quot;;</span>
<a href="#l163.11"></a><span id="l163.11"> </span>
<a href="#l163.12"></a><span id="l163.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l163.13"></a><span id="l163.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-quick-filter-bar-helpers.js */</span>
<a href="#l163.14"></a><span id="l163.14" class="difflineminus">-</span>
<a href="#l163.15"></a><span id="l163.15" class="difflineminus">-var MODULE_NAME = &quot;test-keyboard-interface&quot;;</span>
<a href="#l163.16"></a><span id="l163.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l163.17"></a><span id="l163.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;quick-filter-bar-helpers&quot;];</span>
<a href="#l163.18"></a><span id="l163.18" class="difflineplus">+var {</span>
<a href="#l163.19"></a><span id="l163.19" class="difflineplus">+  be_in_folder,</span>
<a href="#l163.20"></a><span id="l163.20" class="difflineplus">+  create_folder,</span>
<a href="#l163.21"></a><span id="l163.21" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l163.22"></a><span id="l163.22" class="difflineplus">+  mc,</span>
<a href="#l163.23"></a><span id="l163.23" class="difflineplus">+  select_click_row,</span>
<a href="#l163.24"></a><span id="l163.24" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l163.25"></a><span id="l163.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l163.26"></a><span id="l163.26" class="difflineplus">+);</span>
<a href="#l163.27"></a><span id="l163.27" class="difflineplus">+var {</span>
<a href="#l163.28"></a><span id="l163.28" class="difflineplus">+  assert_constraints_expressed,</span>
<a href="#l163.29"></a><span id="l163.29" class="difflineplus">+  assert_filter_text,</span>
<a href="#l163.30"></a><span id="l163.30" class="difflineplus">+  assert_quick_filter_bar_visible,</span>
<a href="#l163.31"></a><span id="l163.31" class="difflineplus">+  clear_constraints,</span>
<a href="#l163.32"></a><span id="l163.32" class="difflineplus">+  set_filter_text,</span>
<a href="#l163.33"></a><span id="l163.33" class="difflineplus">+  toggle_boolean_constraints,</span>
<a href="#l163.34"></a><span id="l163.34" class="difflineplus">+  toggle_quick_filter_bar,</span>
<a href="#l163.35"></a><span id="l163.35" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l163.36"></a><span id="l163.36" class="difflineplus">+  &quot;resource://testing-common/mozmill/QuickFilterBarHelpers.jsm&quot;</span>
<a href="#l163.37"></a><span id="l163.37" class="difflineplus">+);</span>
<a href="#l163.38"></a><span id="l163.38"> </span>
<a href="#l163.39"></a><span id="l163.39"> var folder;</span>
<a href="#l163.40"></a><span id="l163.40"> </span>
<a href="#l163.41"></a><span id="l163.41"> function setupModule(module) {</span>
<a href="#l163.42"></a><span id="l163.42" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l163.43"></a><span id="l163.43" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l163.44"></a><span id="l163.44" class="difflineminus">-  let qfb = collector.getModule(&quot;quick-filter-bar-helpers&quot;);</span>
<a href="#l163.45"></a><span id="l163.45" class="difflineminus">-  qfb.installInto(module);</span>
<a href="#l163.46"></a><span id="l163.46" class="difflineminus">-</span>
<a href="#l163.47"></a><span id="l163.47">   folder = create_folder(&quot;QuickFilterBarKeyboardInterface&quot;);</span>
<a href="#l163.48"></a><span id="l163.48">   // we need a message so we can select it so we can find in message</span>
<a href="#l163.49"></a><span id="l163.49">   make_new_sets_in_folder(folder, [{ count: 1 }]);</span>
<a href="#l163.50"></a><span id="l163.50">   be_in_folder(folder);</span>
<a href="#l163.51"></a><span id="l163.51"> }</span>
<a href="#l163.52"></a><span id="l163.52"> </span>
<a href="#l163.53"></a><span id="l163.53"> /**</span>
<a href="#l163.54"></a><span id="l163.54">  * The rules for pressing escape:</span>
<a href="#l163.55"></a><span id="l163.55" class="difflineat">@@ -166,8 +175,16 @@ function test_control_shift_k_shows_quic</span>
<a href="#l163.56"></a><span id="l163.56">   assert_quick_filter_bar_visible(true);</span>
<a href="#l163.57"></a><span id="l163.57">   assert_filter_text(&quot;&quot;);</span>
<a href="#l163.58"></a><span id="l163.58"> </span>
<a href="#l163.59"></a><span id="l163.59">   // hit escape one more time and make sure we finally collapsed the quick</span>
<a href="#l163.60"></a><span id="l163.60">   // filter bar.</span>
<a href="#l163.61"></a><span id="l163.61">   mc.keypress(null, &quot;VK_ESCAPE&quot;, {});</span>
<a href="#l163.62"></a><span id="l163.62">   assert_quick_filter_bar_visible(false);</span>
<a href="#l163.63"></a><span id="l163.63"> }</span>
<a href="#l163.64"></a><span id="l163.64" class="difflineplus">+</span>
<a href="#l163.65"></a><span id="l163.65" class="difflineplus">+function teardownTest() {</span>
<a href="#l163.66"></a><span id="l163.66" class="difflineplus">+  clear_constraints();</span>
<a href="#l163.67"></a><span id="l163.67" class="difflineplus">+  // make it visible if it's not</span>
<a href="#l163.68"></a><span id="l163.68" class="difflineplus">+  if (mc.e(&quot;quick-filter-bar&quot;).collapsed) {</span>
<a href="#l163.69"></a><span id="l163.69" class="difflineplus">+    toggle_quick_filter_bar();</span>
<a href="#l163.70"></a><span id="l163.70" class="difflineplus">+  }</span>
<a href="#l163.71"></a><span id="l163.71" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l164.1"></a><span id="l164.1" class="difflineminus">--- a/mail/test/mozmill/quick-filter-bar/test-sticky-filter-logic.js</span>
<a href="#l164.2"></a><span id="l164.2" class="difflineplus">+++ b/mail/test/mozmill/quick-filter-bar/test-sticky-filter-logic.js</span>
<a href="#l164.3"></a><span id="l164.3" class="difflineat">@@ -4,29 +4,39 @@</span>
<a href="#l164.4"></a><span id="l164.4"> </span>
<a href="#l164.5"></a><span id="l164.5"> /*</span>
<a href="#l164.6"></a><span id="l164.6">  * Sticky logic only needs to test the general sticky logic plus any filters</span>
<a href="#l164.7"></a><span id="l164.7">  *  with custom propagateState implementations (currently: tags, text filter.)</span>
<a href="#l164.8"></a><span id="l164.8">  */</span>
<a href="#l164.9"></a><span id="l164.9"> </span>
<a href="#l164.10"></a><span id="l164.10"> &quot;use strict&quot;;</span>
<a href="#l164.11"></a><span id="l164.11"> </span>
<a href="#l164.12"></a><span id="l164.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l164.13"></a><span id="l164.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-quick-filter-bar-helpers.js */</span>
<a href="#l164.14"></a><span id="l164.14" class="difflineminus">-</span>
<a href="#l164.15"></a><span id="l164.15" class="difflineminus">-var MODULE_NAME = &quot;test-sticky-filter-logic&quot;;</span>
<a href="#l164.16"></a><span id="l164.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l164.17"></a><span id="l164.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;quick-filter-bar-helpers&quot;];</span>
<a href="#l164.18"></a><span id="l164.18" class="difflineminus">-</span>
<a href="#l164.19"></a><span id="l164.19" class="difflineminus">-function setupModule(module) {</span>
<a href="#l164.20"></a><span id="l164.20" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l164.21"></a><span id="l164.21" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l164.22"></a><span id="l164.22" class="difflineminus">-  let qfb = collector.getModule(&quot;quick-filter-bar-helpers&quot;);</span>
<a href="#l164.23"></a><span id="l164.23" class="difflineminus">-  qfb.installInto(module);</span>
<a href="#l164.24"></a><span id="l164.24" class="difflineminus">-}</span>
<a href="#l164.25"></a><span id="l164.25" class="difflineplus">+var {</span>
<a href="#l164.26"></a><span id="l164.26" class="difflineplus">+  assert_messages_in_view,</span>
<a href="#l164.27"></a><span id="l164.27" class="difflineplus">+  be_in_folder,</span>
<a href="#l164.28"></a><span id="l164.28" class="difflineplus">+  close_tab,</span>
<a href="#l164.29"></a><span id="l164.29" class="difflineplus">+  create_folder,</span>
<a href="#l164.30"></a><span id="l164.30" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l164.31"></a><span id="l164.31" class="difflineplus">+  mc,</span>
<a href="#l164.32"></a><span id="l164.32" class="difflineplus">+  open_folder_in_new_tab,</span>
<a href="#l164.33"></a><span id="l164.33" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l164.34"></a><span id="l164.34" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l164.35"></a><span id="l164.35" class="difflineplus">+);</span>
<a href="#l164.36"></a><span id="l164.36" class="difflineplus">+var {</span>
<a href="#l164.37"></a><span id="l164.37" class="difflineplus">+  assert_constraints_expressed,</span>
<a href="#l164.38"></a><span id="l164.38" class="difflineplus">+  assert_filter_text,</span>
<a href="#l164.39"></a><span id="l164.39" class="difflineplus">+  assert_tag_constraints_visible,</span>
<a href="#l164.40"></a><span id="l164.40" class="difflineplus">+  clear_constraints,</span>
<a href="#l164.41"></a><span id="l164.41" class="difflineplus">+  set_filter_text,</span>
<a href="#l164.42"></a><span id="l164.42" class="difflineplus">+  toggle_boolean_constraints,</span>
<a href="#l164.43"></a><span id="l164.43" class="difflineplus">+  toggle_quick_filter_bar,</span>
<a href="#l164.44"></a><span id="l164.44" class="difflineplus">+  toggle_tag_constraints,</span>
<a href="#l164.45"></a><span id="l164.45" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l164.46"></a><span id="l164.46" class="difflineplus">+  &quot;resource://testing-common/mozmill/QuickFilterBarHelpers.jsm&quot;</span>
<a href="#l164.47"></a><span id="l164.47" class="difflineplus">+);</span>
<a href="#l164.48"></a><span id="l164.48"> </span>
<a href="#l164.49"></a><span id="l164.49"> /**</span>
<a href="#l164.50"></a><span id="l164.50">  * Persist the current settings through folder change and inherit into a new tab.</span>
<a href="#l164.51"></a><span id="l164.51">  */</span>
<a href="#l164.52"></a><span id="l164.52"> function test_sticky_basics() {</span>
<a href="#l164.53"></a><span id="l164.53">   let folderOne = create_folder(&quot;QuickFilterBarStickyBasics1&quot;);</span>
<a href="#l164.54"></a><span id="l164.54">   let [unreadOne, readOne] = make_new_sets_in_folder(folderOne, [</span>
<a href="#l164.55"></a><span id="l164.55">     { count: 1 },</span>
<a href="#l164.56"></a><span id="l164.56" class="difflineat">@@ -126,8 +136,16 @@ function test_sticky_text() {</span>
<a href="#l164.57"></a><span id="l164.57"> </span>
<a href="#l164.58"></a><span id="l164.58">   be_in_folder(folderOne);</span>
<a href="#l164.59"></a><span id="l164.59">   toggle_boolean_constraints(&quot;sticky&quot;);</span>
<a href="#l164.60"></a><span id="l164.60">   set_filter_text(&quot;foo&quot;);</span>
<a href="#l164.61"></a><span id="l164.61"> </span>
<a href="#l164.62"></a><span id="l164.62">   be_in_folder(folderTwo);</span>
<a href="#l164.63"></a><span id="l164.63">   assert_filter_text(&quot;foo&quot;);</span>
<a href="#l164.64"></a><span id="l164.64"> }</span>
<a href="#l164.65"></a><span id="l164.65" class="difflineplus">+</span>
<a href="#l164.66"></a><span id="l164.66" class="difflineplus">+function teardownTest() {</span>
<a href="#l164.67"></a><span id="l164.67" class="difflineplus">+  clear_constraints();</span>
<a href="#l164.68"></a><span id="l164.68" class="difflineplus">+  // make it visible if it's not</span>
<a href="#l164.69"></a><span id="l164.69" class="difflineplus">+  if (mc.e(&quot;quick-filter-bar&quot;).collapsed) {</span>
<a href="#l164.70"></a><span id="l164.70" class="difflineplus">+    toggle_quick_filter_bar();</span>
<a href="#l164.71"></a><span id="l164.71" class="difflineplus">+  }</span>
<a href="#l164.72"></a><span id="l164.72" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l165.1"></a><span id="l165.1" class="difflineminus">--- a/mail/test/mozmill/quick-filter-bar/test-toggle-bar.js</span>
<a href="#l165.2"></a><span id="l165.2" class="difflineplus">+++ b/mail/test/mozmill/quick-filter-bar/test-toggle-bar.js</span>
<a href="#l165.3"></a><span id="l165.3" class="difflineat">@@ -4,32 +4,40 @@</span>
<a href="#l165.4"></a><span id="l165.4"> </span>
<a href="#l165.5"></a><span id="l165.5"> /*</span>
<a href="#l165.6"></a><span id="l165.6">  * Test that the message filter bar toggles into and out of existence and</span>
<a href="#l165.7"></a><span id="l165.7">  * states are updated as appropriate.</span>
<a href="#l165.8"></a><span id="l165.8">  */</span>
<a href="#l165.9"></a><span id="l165.9"> </span>
<a href="#l165.10"></a><span id="l165.10"> &quot;use strict&quot;;</span>
<a href="#l165.11"></a><span id="l165.11"> </span>
<a href="#l165.12"></a><span id="l165.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l165.13"></a><span id="l165.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-quick-filter-bar-helpers.js */</span>
<a href="#l165.14"></a><span id="l165.14" class="difflineminus">-</span>
<a href="#l165.15"></a><span id="l165.15" class="difflineminus">-var MODULE_NAME = &quot;test-toggle-bar&quot;;</span>
<a href="#l165.16"></a><span id="l165.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l165.17"></a><span id="l165.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;quick-filter-bar-helpers&quot;];</span>
<a href="#l165.18"></a><span id="l165.18" class="difflineplus">+var {</span>
<a href="#l165.19"></a><span id="l165.19" class="difflineplus">+  assert_messages_in_view,</span>
<a href="#l165.20"></a><span id="l165.20" class="difflineplus">+  be_in_folder,</span>
<a href="#l165.21"></a><span id="l165.21" class="difflineplus">+  create_folder,</span>
<a href="#l165.22"></a><span id="l165.22" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l165.23"></a><span id="l165.23" class="difflineplus">+  mc,</span>
<a href="#l165.24"></a><span id="l165.24" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l165.25"></a><span id="l165.25" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l165.26"></a><span id="l165.26" class="difflineplus">+);</span>
<a href="#l165.27"></a><span id="l165.27" class="difflineplus">+var {</span>
<a href="#l165.28"></a><span id="l165.28" class="difflineplus">+  assert_constraints_expressed,</span>
<a href="#l165.29"></a><span id="l165.29" class="difflineplus">+  assert_quick_filter_bar_visible,</span>
<a href="#l165.30"></a><span id="l165.30" class="difflineplus">+  assert_quick_filter_button_enabled,</span>
<a href="#l165.31"></a><span id="l165.31" class="difflineplus">+  clear_constraints,</span>
<a href="#l165.32"></a><span id="l165.32" class="difflineplus">+  toggle_boolean_constraints,</span>
<a href="#l165.33"></a><span id="l165.33" class="difflineplus">+  toggle_quick_filter_bar,</span>
<a href="#l165.34"></a><span id="l165.34" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l165.35"></a><span id="l165.35" class="difflineplus">+  &quot;resource://testing-common/mozmill/QuickFilterBarHelpers.jsm&quot;</span>
<a href="#l165.36"></a><span id="l165.36" class="difflineplus">+);</span>
<a href="#l165.37"></a><span id="l165.37"> </span>
<a href="#l165.38"></a><span id="l165.38"> var folder;</span>
<a href="#l165.39"></a><span id="l165.39"> var setUnstarred, setStarred;</span>
<a href="#l165.40"></a><span id="l165.40"> </span>
<a href="#l165.41"></a><span id="l165.41"> function setupModule(module) {</span>
<a href="#l165.42"></a><span id="l165.42" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l165.43"></a><span id="l165.43" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l165.44"></a><span id="l165.44" class="difflineminus">-  let qfb = collector.getModule(&quot;quick-filter-bar-helpers&quot;);</span>
<a href="#l165.45"></a><span id="l165.45" class="difflineminus">-  qfb.installInto(module);</span>
<a href="#l165.46"></a><span id="l165.46" class="difflineminus">-</span>
<a href="#l165.47"></a><span id="l165.47">   folder = create_folder(&quot;QuickFilterBarToggleBar&quot;);</span>
<a href="#l165.48"></a><span id="l165.48">   [setUnstarred, setStarred] = make_new_sets_in_folder(folder, [</span>
<a href="#l165.49"></a><span id="l165.49">     { count: 1 },</span>
<a href="#l165.50"></a><span id="l165.50">     { count: 1 },</span>
<a href="#l165.51"></a><span id="l165.51">   ]);</span>
<a href="#l165.52"></a><span id="l165.52">   setStarred.setStarred(true);</span>
<a href="#l165.53"></a><span id="l165.53"> }</span>
<a href="#l165.54"></a><span id="l165.54"> </span>
<a href="#l165.55"></a><span id="l165.55" class="difflineat">@@ -80,8 +88,16 @@ function test_constraints_disappear_when</span>
<a href="#l165.56"></a><span id="l165.56"> </span>
<a href="#l165.57"></a><span id="l165.57">   // uncollapse, we should still see them all!</span>
<a href="#l165.58"></a><span id="l165.58">   toggle_quick_filter_bar();</span>
<a href="#l165.59"></a><span id="l165.59">   assert_messages_in_view([setUnstarred, setStarred]);</span>
<a href="#l165.60"></a><span id="l165.60"> </span>
<a href="#l165.61"></a><span id="l165.61">   // there better be no constraints left!</span>
<a href="#l165.62"></a><span id="l165.62">   assert_constraints_expressed({});</span>
<a href="#l165.63"></a><span id="l165.63"> }</span>
<a href="#l165.64"></a><span id="l165.64" class="difflineplus">+</span>
<a href="#l165.65"></a><span id="l165.65" class="difflineplus">+function teardownTest() {</span>
<a href="#l165.66"></a><span id="l165.66" class="difflineplus">+  clear_constraints();</span>
<a href="#l165.67"></a><span id="l165.67" class="difflineplus">+  // make it visible if it's not</span>
<a href="#l165.68"></a><span id="l165.68" class="difflineplus">+  if (mc.e(&quot;quick-filter-bar&quot;).collapsed) {</span>
<a href="#l165.69"></a><span id="l165.69" class="difflineplus">+    toggle_quick_filter_bar();</span>
<a href="#l165.70"></a><span id="l165.70" class="difflineplus">+  }</span>
<a href="#l165.71"></a><span id="l165.71" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l166.1"></a><span id="l166.1" class="difflineminus">--- a/mail/test/mozmill/runtest.py</span>
<a href="#l166.2"></a><span id="l166.2" class="difflineplus">+++ b/mail/test/mozmill/runtest.py</span>
<a href="#l166.3"></a><span id="l166.3" class="difflineat">@@ -66,16 +66,17 @@ def rmtree_onerror(func, path, exc_info)</span>
<a href="#l166.4"></a><span id="l166.4">         os.chmod(path, stat.S_IWUSR)</span>
<a href="#l166.5"></a><span id="l166.5">         func(path)</span>
<a href="#l166.6"></a><span id="l166.6">     else:</span>
<a href="#l166.7"></a><span id="l166.7">         raise</span>
<a href="#l166.8"></a><span id="l166.8"> </span>
<a href="#l166.9"></a><span id="l166.9"> </span>
<a href="#l166.10"></a><span id="l166.10"> class ThunderTestProfile(mozprofile.ThunderbirdProfile):</span>
<a href="#l166.11"></a><span id="l166.11">     preferences = {</span>
<a href="#l166.12"></a><span id="l166.12" class="difflineplus">+        'calendar.icaljs': False,</span>
<a href="#l166.13"></a><span id="l166.13">         # say yes to debug output via dump</span>
<a href="#l166.14"></a><span id="l166.14">         'browser.dom.window.dump.enabled': True,</span>
<a href="#l166.15"></a><span id="l166.15">         # say no to slow script warnings</span>
<a href="#l166.16"></a><span id="l166.16">         'dom.max_chrome_script_run_time': 0,</span>
<a href="#l166.17"></a><span id="l166.17">         'dom.max_script_run_time': 0,</span>
<a href="#l166.18"></a><span id="l166.18">         # disable extension stuffs</span>
<a href="#l166.19"></a><span id="l166.19">         'extensions.update.enabled': False,</span>
<a href="#l166.20"></a><span id="l166.20">         'extensions.update.notifyUser': False,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l167.1"></a><span id="l167.1" class="difflineminus">--- a/mail/test/mozmill/search-window/test-multiple-search-windows.js</span>
<a href="#l167.2"></a><span id="l167.2" class="difflineplus">+++ b/mail/test/mozmill/search-window/test-multiple-search-windows.js</span>
<a href="#l167.3"></a><span id="l167.3" class="difflineat">@@ -4,30 +4,29 @@</span>
<a href="#l167.4"></a><span id="l167.4"> </span>
<a href="#l167.5"></a><span id="l167.5"> /*</span>
<a href="#l167.6"></a><span id="l167.6">  * Test that we open multiple search windows when shortcuts are invoked multiple</span>
<a href="#l167.7"></a><span id="l167.7">  * times.</span>
<a href="#l167.8"></a><span id="l167.8">  */</span>
<a href="#l167.9"></a><span id="l167.9"> </span>
<a href="#l167.10"></a><span id="l167.10"> &quot;use strict&quot;;</span>
<a href="#l167.11"></a><span id="l167.11"> </span>
<a href="#l167.12"></a><span id="l167.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l167.13"></a><span id="l167.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-search-window-helpers.js */</span>
<a href="#l167.14"></a><span id="l167.14" class="difflineminus">-</span>
<a href="#l167.15"></a><span id="l167.15" class="difflineminus">-var MODULE_NAME = &quot;test-multiple-search-windows&quot;;</span>
<a href="#l167.16"></a><span id="l167.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l167.17"></a><span id="l167.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;search-window-helpers&quot;];</span>
<a href="#l167.18"></a><span id="l167.18" class="difflineplus">+var { be_in_folder, create_folder, mc } = ChromeUtils.import(</span>
<a href="#l167.19"></a><span id="l167.19" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l167.20"></a><span id="l167.20" class="difflineplus">+);</span>
<a href="#l167.21"></a><span id="l167.21" class="difflineplus">+var {</span>
<a href="#l167.22"></a><span id="l167.22" class="difflineplus">+  assert_search_window_folder_displayed,</span>
<a href="#l167.23"></a><span id="l167.23" class="difflineplus">+  close_search_window,</span>
<a href="#l167.24"></a><span id="l167.24" class="difflineplus">+  open_search_window,</span>
<a href="#l167.25"></a><span id="l167.25" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l167.26"></a><span id="l167.26" class="difflineplus">+  &quot;resource://testing-common/mozmill/SearchWindowHelpers.jsm&quot;</span>
<a href="#l167.27"></a><span id="l167.27" class="difflineplus">+);</span>
<a href="#l167.28"></a><span id="l167.28"> </span>
<a href="#l167.29"></a><span id="l167.29"> var folderA, folderB;</span>
<a href="#l167.30"></a><span id="l167.30"> function setupModule(module) {</span>
<a href="#l167.31"></a><span id="l167.31" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l167.32"></a><span id="l167.32" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l167.33"></a><span id="l167.33" class="difflineminus">-  let swh = collector.getModule(&quot;search-window-helpers&quot;);</span>
<a href="#l167.34"></a><span id="l167.34" class="difflineminus">-  swh.installInto(module);</span>
<a href="#l167.35"></a><span id="l167.35" class="difflineminus">-</span>
<a href="#l167.36"></a><span id="l167.36">   folderA = create_folder(&quot;MultipleSearchWindowsA&quot;);</span>
<a href="#l167.37"></a><span id="l167.37">   folderB = create_folder(&quot;MultipleSearchWindowsB&quot;);</span>
<a href="#l167.38"></a><span id="l167.38"> }</span>
<a href="#l167.39"></a><span id="l167.39"> </span>
<a href="#l167.40"></a><span id="l167.40"> /**</span>
<a href="#l167.41"></a><span id="l167.41">  * Test bringing up multiple search windows for multiple folders.</span>
<a href="#l167.42"></a><span id="l167.42">  */</span>
<a href="#l167.43"></a><span id="l167.43"> function test_show_multiple_search_windows_for_multiple_folders() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l168.1"></a><span id="l168.1" class="difflineminus">--- a/mail/test/mozmill/search-window/test-right-click-to-open-search-window.js</span>
<a href="#l168.2"></a><span id="l168.2" class="difflineplus">+++ b/mail/test/mozmill/search-window/test-right-click-to-open-search-window.js</span>
<a href="#l168.3"></a><span id="l168.3" class="difflineat">@@ -1,28 +1,35 @@</span>
<a href="#l168.4"></a><span id="l168.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l168.5"></a><span id="l168.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l168.6"></a><span id="l168.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l168.7"></a><span id="l168.7"> </span>
<a href="#l168.8"></a><span id="l168.8"> &quot;use strict&quot;;</span>
<a href="#l168.9"></a><span id="l168.9"> </span>
<a href="#l168.10"></a><span id="l168.10" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l168.11"></a><span id="l168.11" class="difflineminus">-/* import-globals-from ../shared-modules/test-search-window-helpers.js */</span>
<a href="#l168.12"></a><span id="l168.12" class="difflineminus">-</span>
<a href="#l168.13"></a><span id="l168.13" class="difflineminus">-var MODULE_NAME = &quot;test-right-click-to-open-search-window&quot;;</span>
<a href="#l168.14"></a><span id="l168.14" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l168.15"></a><span id="l168.15" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;search-window-helpers&quot;];</span>
<a href="#l168.16"></a><span id="l168.16" class="difflineplus">+var {</span>
<a href="#l168.17"></a><span id="l168.17" class="difflineplus">+  assert_folders_selected_and_displayed,</span>
<a href="#l168.18"></a><span id="l168.18" class="difflineplus">+  assert_no_folders_selected,</span>
<a href="#l168.19"></a><span id="l168.19" class="difflineplus">+  create_folder,</span>
<a href="#l168.20"></a><span id="l168.20" class="difflineplus">+  enter_folder,</span>
<a href="#l168.21"></a><span id="l168.21" class="difflineplus">+  select_click_folder,</span>
<a href="#l168.22"></a><span id="l168.22" class="difflineplus">+  select_no_folders,</span>
<a href="#l168.23"></a><span id="l168.23" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l168.24"></a><span id="l168.24" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l168.25"></a><span id="l168.25" class="difflineplus">+);</span>
<a href="#l168.26"></a><span id="l168.26" class="difflineplus">+var {</span>
<a href="#l168.27"></a><span id="l168.27" class="difflineplus">+  assert_search_window_folder_displayed,</span>
<a href="#l168.28"></a><span id="l168.28" class="difflineplus">+  close_search_window,</span>
<a href="#l168.29"></a><span id="l168.29" class="difflineplus">+  open_search_window,</span>
<a href="#l168.30"></a><span id="l168.30" class="difflineplus">+  open_search_window_from_context_menu,</span>
<a href="#l168.31"></a><span id="l168.31" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l168.32"></a><span id="l168.32" class="difflineplus">+  &quot;resource://testing-common/mozmill/SearchWindowHelpers.jsm&quot;</span>
<a href="#l168.33"></a><span id="l168.33" class="difflineplus">+);</span>
<a href="#l168.34"></a><span id="l168.34"> </span>
<a href="#l168.35"></a><span id="l168.35"> var folderA, folderB;</span>
<a href="#l168.36"></a><span id="l168.36"> function setupModule(module) {</span>
<a href="#l168.37"></a><span id="l168.37" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l168.38"></a><span id="l168.38" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l168.39"></a><span id="l168.39" class="difflineminus">-  let swh = collector.getModule(&quot;search-window-helpers&quot;);</span>
<a href="#l168.40"></a><span id="l168.40" class="difflineminus">-  swh.installInto(module);</span>
<a href="#l168.41"></a><span id="l168.41" class="difflineminus">-</span>
<a href="#l168.42"></a><span id="l168.42">   folderA = create_folder(&quot;RightClickToOpenSearchWindowA&quot;);</span>
<a href="#l168.43"></a><span id="l168.43">   folderB = create_folder(&quot;RightClickToOpenSearchWindowB&quot;);</span>
<a href="#l168.44"></a><span id="l168.44"> }</span>
<a href="#l168.45"></a><span id="l168.45"> </span>
<a href="#l168.46"></a><span id="l168.46"> /**</span>
<a href="#l168.47"></a><span id="l168.47">  * Test opening a search window while nothing is selected.</span>
<a href="#l168.48"></a><span id="l168.48">  */</span>
<a href="#l168.49"></a><span id="l168.49"> function test_open_search_window_with_nothing_selected() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l169.1"></a><span id="l169.1" class="difflineminus">--- a/mail/test/mozmill/search-window/test-search-window.js</span>
<a href="#l169.2"></a><span id="l169.2" class="difflineplus">+++ b/mail/test/mozmill/search-window/test-search-window.js</span>
<a href="#l169.3"></a><span id="l169.3" class="difflineat">@@ -4,43 +4,60 @@</span>
<a href="#l169.4"></a><span id="l169.4"> </span>
<a href="#l169.5"></a><span id="l169.5"> /*</span>
<a href="#l169.6"></a><span id="l169.6">  * Tests:</span>
<a href="#l169.7"></a><span id="l169.7">  * - https://bugzilla.mozilla.org/show_bug.cgi?id=474701#c96 first para</span>
<a href="#l169.8"></a><span id="l169.8">  */</span>
<a href="#l169.9"></a><span id="l169.9"> </span>
<a href="#l169.10"></a><span id="l169.10"> &quot;use strict&quot;;</span>
<a href="#l169.11"></a><span id="l169.11"> </span>
<a href="#l169.12"></a><span id="l169.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l169.13"></a><span id="l169.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-search-window-helpers.js */</span>
<a href="#l169.14"></a><span id="l169.14" class="difflineminus">-</span>
<a href="#l169.15"></a><span id="l169.15" class="difflineminus">-var MODULE_NAME = &quot;test-search-window&quot;;</span>
<a href="#l169.16"></a><span id="l169.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l169.17"></a><span id="l169.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;search-window-helpers&quot;];</span>
<a href="#l169.18"></a><span id="l169.18" class="difflineminus">-</span>
<a href="#l169.19"></a><span id="l169.19"> var elib = ChromeUtils.import(</span>
<a href="#l169.20"></a><span id="l169.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l169.21"></a><span id="l169.21"> );</span>
<a href="#l169.22"></a><span id="l169.22"> </span>
<a href="#l169.23"></a><span id="l169.23"> var {</span>
<a href="#l169.24"></a><span id="l169.24" class="difflineplus">+  assert_messages_in_view,</span>
<a href="#l169.25"></a><span id="l169.25" class="difflineplus">+  assert_number_of_tabs_open,</span>
<a href="#l169.26"></a><span id="l169.26" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l169.27"></a><span id="l169.27" class="difflineplus">+  assert_tab_mode_name,</span>
<a href="#l169.28"></a><span id="l169.28" class="difflineplus">+  assert_tab_titled_from,</span>
<a href="#l169.29"></a><span id="l169.29" class="difflineplus">+  be_in_folder,</span>
<a href="#l169.30"></a><span id="l169.30" class="difflineplus">+  close_message_window,</span>
<a href="#l169.31"></a><span id="l169.31" class="difflineplus">+  close_tab,</span>
<a href="#l169.32"></a><span id="l169.32" class="difflineplus">+  create_folder,</span>
<a href="#l169.33"></a><span id="l169.33" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l169.34"></a><span id="l169.34" class="difflineplus">+  mc,</span>
<a href="#l169.35"></a><span id="l169.35" class="difflineplus">+  open_selected_message,</span>
<a href="#l169.36"></a><span id="l169.36" class="difflineplus">+  open_selected_messages,</span>
<a href="#l169.37"></a><span id="l169.37" class="difflineplus">+  plan_for_message_display,</span>
<a href="#l169.38"></a><span id="l169.38" class="difflineplus">+  reset_open_message_behavior,</span>
<a href="#l169.39"></a><span id="l169.39" class="difflineplus">+  select_click_row,</span>
<a href="#l169.40"></a><span id="l169.40" class="difflineplus">+  select_shift_click_row,</span>
<a href="#l169.41"></a><span id="l169.41" class="difflineplus">+  set_open_message_behavior,</span>
<a href="#l169.42"></a><span id="l169.42" class="difflineplus">+  switch_tab,</span>
<a href="#l169.43"></a><span id="l169.43" class="difflineplus">+  wait_for_all_messages_to_load,</span>
<a href="#l169.44"></a><span id="l169.44" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l169.45"></a><span id="l169.45" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l169.46"></a><span id="l169.46" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l169.47"></a><span id="l169.47" class="difflineplus">+);</span>
<a href="#l169.48"></a><span id="l169.48" class="difflineplus">+var {</span>
<a href="#l169.49"></a><span id="l169.49" class="difflineplus">+  assert_search_window_folder_displayed,</span>
<a href="#l169.50"></a><span id="l169.50" class="difflineplus">+  open_search_window,</span>
<a href="#l169.51"></a><span id="l169.51" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l169.52"></a><span id="l169.52" class="difflineplus">+  &quot;resource://testing-common/mozmill/SearchWindowHelpers.jsm&quot;</span>
<a href="#l169.53"></a><span id="l169.53" class="difflineplus">+);</span>
<a href="#l169.54"></a><span id="l169.54" class="difflineplus">+var {</span>
<a href="#l169.55"></a><span id="l169.55">   plan_for_modal_dialog,</span>
<a href="#l169.56"></a><span id="l169.56">   plan_for_new_window,</span>
<a href="#l169.57"></a><span id="l169.57">   plan_for_window_close,</span>
<a href="#l169.58"></a><span id="l169.58">   wait_for_modal_dialog,</span>
<a href="#l169.59"></a><span id="l169.59">   wait_for_new_window,</span>
<a href="#l169.60"></a><span id="l169.60">   wait_for_window_close,</span>
<a href="#l169.61"></a><span id="l169.61"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l169.62"></a><span id="l169.62"> </span>
<a href="#l169.63"></a><span id="l169.63" class="difflineminus">-function setupModule(module) {</span>
<a href="#l169.64"></a><span id="l169.64" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l169.65"></a><span id="l169.65" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l169.66"></a><span id="l169.66" class="difflineminus">-  let sh = collector.getModule(&quot;search-window-helpers&quot;);</span>
<a href="#l169.67"></a><span id="l169.67" class="difflineminus">-  sh.installInto(module);</span>
<a href="#l169.68"></a><span id="l169.68" class="difflineminus">-}</span>
<a href="#l169.69"></a><span id="l169.69" class="difflineminus">-</span>
<a href="#l169.70"></a><span id="l169.70"> var folder, setFoo, setBar, setFooBar;</span>
<a href="#l169.71"></a><span id="l169.71"> </span>
<a href="#l169.72"></a><span id="l169.72"> // Number of messages to open for multi-message tests</span>
<a href="#l169.73"></a><span id="l169.73"> var NUM_MESSAGES_TO_OPEN = 5;</span>
<a href="#l169.74"></a><span id="l169.74"> </span>
<a href="#l169.75"></a><span id="l169.75"> /**</span>
<a href="#l169.76"></a><span id="l169.76">  * Create some messages that our constraint below will satisfy</span>
<a href="#l169.77"></a><span id="l169.77">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l170.1"></a><span id="l170.1" class="difflineminus">--- a/mail/test/mozmill/session-store/test-session-store.js</span>
<a href="#l170.2"></a><span id="l170.2" class="difflineplus">+++ b/mail/test/mozmill/session-store/test-session-store.js</span>
<a href="#l170.3"></a><span id="l170.3" class="difflineat">@@ -4,27 +4,45 @@</span>
<a href="#l170.4"></a><span id="l170.4"> </span>
<a href="#l170.5"></a><span id="l170.5"> /*</span>
<a href="#l170.6"></a><span id="l170.6">  * Session Storage Tests. Session Restoration Tests are currently implemented in</span>
<a href="#l170.7"></a><span id="l170.7">  * folder-display/test-message-pane-visibility.js.</span>
<a href="#l170.8"></a><span id="l170.8">  */</span>
<a href="#l170.9"></a><span id="l170.9"> </span>
<a href="#l170.10"></a><span id="l170.10"> &quot;use strict&quot;;</span>
<a href="#l170.11"></a><span id="l170.11"> </span>
<a href="#l170.12"></a><span id="l170.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l170.13"></a><span id="l170.13" class="difflineminus">-</span>
<a href="#l170.14"></a><span id="l170.14" class="difflineminus">-var MODULE_NAME = &quot;test-session-store&quot;;</span>
<a href="#l170.15"></a><span id="l170.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l170.16"></a><span id="l170.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l170.17"></a><span id="l170.17" class="difflineminus">-</span>
<a href="#l170.18"></a><span id="l170.18"> var controller = ChromeUtils.import(</span>
<a href="#l170.19"></a><span id="l170.19">   &quot;chrome://mozmill/content/modules/controller.jsm&quot;</span>
<a href="#l170.20"></a><span id="l170.20"> );</span>
<a href="#l170.21"></a><span id="l170.21" class="difflineplus">+var EventUtils = ChromeUtils.import(</span>
<a href="#l170.22"></a><span id="l170.22" class="difflineplus">+  &quot;chrome://mozmill/content/stdlib/EventUtils.jsm&quot;</span>
<a href="#l170.23"></a><span id="l170.23" class="difflineplus">+);</span>
<a href="#l170.24"></a><span id="l170.24" class="difflineplus">+var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l170.25"></a><span id="l170.25"> </span>
<a href="#l170.26"></a><span id="l170.26"> var {</span>
<a href="#l170.27"></a><span id="l170.27" class="difflineplus">+  assert_equals,</span>
<a href="#l170.28"></a><span id="l170.28" class="difflineplus">+  assert_false,</span>
<a href="#l170.29"></a><span id="l170.29" class="difflineplus">+  assert_message_pane_hidden,</span>
<a href="#l170.30"></a><span id="l170.30" class="difflineplus">+  assert_message_pane_visible,</span>
<a href="#l170.31"></a><span id="l170.31" class="difflineplus">+  assert_not_equals,</span>
<a href="#l170.32"></a><span id="l170.32" class="difflineplus">+  assert_pane_layout,</span>
<a href="#l170.33"></a><span id="l170.33" class="difflineplus">+  assert_true,</span>
<a href="#l170.34"></a><span id="l170.34" class="difflineplus">+  be_in_folder,</span>
<a href="#l170.35"></a><span id="l170.35" class="difflineplus">+  create_folder,</span>
<a href="#l170.36"></a><span id="l170.36" class="difflineplus">+  kClassicMailLayout,</span>
<a href="#l170.37"></a><span id="l170.37" class="difflineplus">+  kVerticalMailLayout,</span>
<a href="#l170.38"></a><span id="l170.38" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l170.39"></a><span id="l170.39" class="difflineplus">+  mc,</span>
<a href="#l170.40"></a><span id="l170.40" class="difflineplus">+  set_mc,</span>
<a href="#l170.41"></a><span id="l170.41" class="difflineplus">+  set_pane_layout,</span>
<a href="#l170.42"></a><span id="l170.42" class="difflineplus">+  toggle_message_pane,</span>
<a href="#l170.43"></a><span id="l170.43" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l170.44"></a><span id="l170.44" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l170.45"></a><span id="l170.45" class="difflineplus">+);</span>
<a href="#l170.46"></a><span id="l170.46" class="difflineplus">+var {</span>
<a href="#l170.47"></a><span id="l170.47">   close_window,</span>
<a href="#l170.48"></a><span id="l170.48">   plan_for_new_window,</span>
<a href="#l170.49"></a><span id="l170.49">   plan_for_window_close,</span>
<a href="#l170.50"></a><span id="l170.50">   wait_for_new_window,</span>
<a href="#l170.51"></a><span id="l170.51">   wait_for_window_close,</span>
<a href="#l170.52"></a><span id="l170.52"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l170.53"></a><span id="l170.53"> </span>
<a href="#l170.54"></a><span id="l170.54"> var { IOUtils } = ChromeUtils.import(&quot;resource:///modules/IOUtils.js&quot;);</span>
<a href="#l170.55"></a><span id="l170.55" class="difflineat">@@ -92,20 +110,16 @@ function openAddressBook() {</span>
<a href="#l170.56"></a><span id="l170.56">     null</span>
<a href="#l170.57"></a><span id="l170.57">   );</span>
<a href="#l170.58"></a><span id="l170.58">   return wait_for_new_window(&quot;mail:addressbook&quot;);</span>
<a href="#l170.59"></a><span id="l170.59"> }</span>
<a href="#l170.60"></a><span id="l170.60"> </span>
<a href="#l170.61"></a><span id="l170.61"> /* :::::::: The Tests ::::::::::::::: */</span>
<a href="#l170.62"></a><span id="l170.62"> </span>
<a href="#l170.63"></a><span id="l170.63"> function setupModule(module) {</span>
<a href="#l170.64"></a><span id="l170.64" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l170.65"></a><span id="l170.65" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l170.66"></a><span id="l170.66" class="difflineminus">-  }</span>
<a href="#l170.67"></a><span id="l170.67" class="difflineminus">-</span>
<a href="#l170.68"></a><span id="l170.68">   folderA = create_folder(&quot;SessionStoreA&quot;);</span>
<a href="#l170.69"></a><span id="l170.69">   make_new_sets_in_folder(folderA, [{ count: 3 }]);</span>
<a href="#l170.70"></a><span id="l170.70"> </span>
<a href="#l170.71"></a><span id="l170.71">   folderB = create_folder(&quot;SessionStoreB&quot;);</span>
<a href="#l170.72"></a><span id="l170.72">   make_new_sets_in_folder(folderB, [{ count: 3 }]);</span>
<a href="#l170.73"></a><span id="l170.73"> </span>
<a href="#l170.74"></a><span id="l170.74">   SessionStoreManager.stopPeriodicSave();</span>
<a href="#l170.75"></a><span id="l170.75"> </span>
<a href="#l170.76"></a><span id="l170.76" class="difflineat">@@ -195,16 +209,17 @@ function test_restore_single_3pane_persi</span>
<a href="#l170.77"></a><span id="l170.77">   let abwc = openAddressBook();</span>
<a href="#l170.78"></a><span id="l170.78"> </span>
<a href="#l170.79"></a><span id="l170.79">   // close the 3pane window</span>
<a href="#l170.80"></a><span id="l170.80">   close_window(new mozmill.controller.MozMillController(mail3PaneWindow));</span>
<a href="#l170.81"></a><span id="l170.81">   // Wait for window close async session write to finish.</span>
<a href="#l170.82"></a><span id="l170.82">   controller.sleep(asyncFileWriteDelayMS);</span>
<a href="#l170.83"></a><span id="l170.83"> </span>
<a href="#l170.84"></a><span id="l170.84">   mc = open3PaneWindow();</span>
<a href="#l170.85"></a><span id="l170.85" class="difflineplus">+  set_mc(mc);</span>
<a href="#l170.86"></a><span id="l170.86">   be_in_folder(folderA);</span>
<a href="#l170.87"></a><span id="l170.87">   assert_message_pane_hidden();</span>
<a href="#l170.88"></a><span id="l170.88">   // restore message pane.</span>
<a href="#l170.89"></a><span id="l170.89">   toggle_message_pane();</span>
<a href="#l170.90"></a><span id="l170.90"> </span>
<a href="#l170.91"></a><span id="l170.91">   // We don't need the address book window any more.</span>
<a href="#l170.92"></a><span id="l170.92">   plan_for_window_close(abwc);</span>
<a href="#l170.93"></a><span id="l170.93">   abwc.window.close();</span>
<a href="#l170.94"></a><span id="l170.94" class="difflineat">@@ -262,16 +277,17 @@ function test_message_pane_height_persis</span>
<a href="#l170.95"></a><span id="l170.95">   let abwc = openAddressBook();</span>
<a href="#l170.96"></a><span id="l170.96"> </span>
<a href="#l170.97"></a><span id="l170.97">   // The 3pane window is closed.</span>
<a href="#l170.98"></a><span id="l170.98">   close_window(new mozmill.controller.MozMillController(mail3PaneWindow));</span>
<a href="#l170.99"></a><span id="l170.99">   // Wait for window close async session write to finish.</span>
<a href="#l170.100"></a><span id="l170.100">   controller.sleep(asyncFileWriteDelayMS);</span>
<a href="#l170.101"></a><span id="l170.101"> </span>
<a href="#l170.102"></a><span id="l170.102">   mc = open3PaneWindow();</span>
<a href="#l170.103"></a><span id="l170.103" class="difflineplus">+  set_mc(mc);</span>
<a href="#l170.104"></a><span id="l170.104">   be_in_folder(folderA);</span>
<a href="#l170.105"></a><span id="l170.105">   assert_message_pane_visible();</span>
<a href="#l170.106"></a><span id="l170.106"> </span>
<a href="#l170.107"></a><span id="l170.107">   actualHeight = mc.e(&quot;messagepaneboxwrapper&quot;).clientHeight;</span>
<a href="#l170.108"></a><span id="l170.108"> </span>
<a href="#l170.109"></a><span id="l170.109">   assert_equals(</span>
<a href="#l170.110"></a><span id="l170.110">     newHeight,</span>
<a href="#l170.111"></a><span id="l170.111">     actualHeight,</span>
<a href="#l170.112"></a><span id="l170.112" class="difflineat">@@ -287,16 +303,17 @@ function test_message_pane_height_persis</span>
<a href="#l170.113"></a><span id="l170.113">   _move_splitter(mc.e(&quot;threadpane-splitter&quot;), 0, -diffHeight);</span>
<a href="#l170.114"></a><span id="l170.114"> </span>
<a href="#l170.115"></a><span id="l170.115">   // The 3pane window is closed.</span>
<a href="#l170.116"></a><span id="l170.116">   close_window(mc);</span>
<a href="#l170.117"></a><span id="l170.117">   // Wait for window close async session write to finish.</span>
<a href="#l170.118"></a><span id="l170.118">   controller.sleep(asyncFileWriteDelayMS);</span>
<a href="#l170.119"></a><span id="l170.119"> </span>
<a href="#l170.120"></a><span id="l170.120">   mc = open3PaneWindow();</span>
<a href="#l170.121"></a><span id="l170.121" class="difflineplus">+  set_mc(mc);</span>
<a href="#l170.122"></a><span id="l170.122">   be_in_folder(folderA);</span>
<a href="#l170.123"></a><span id="l170.123">   assert_message_pane_visible();</span>
<a href="#l170.124"></a><span id="l170.124"> </span>
<a href="#l170.125"></a><span id="l170.125">   actualHeight = mc.e(&quot;messagepaneboxwrapper&quot;).clientHeight;</span>
<a href="#l170.126"></a><span id="l170.126">   assert_equals(</span>
<a href="#l170.127"></a><span id="l170.127">     oldHeight,</span>
<a href="#l170.128"></a><span id="l170.128">     actualHeight,</span>
<a href="#l170.129"></a><span id="l170.129">     &quot;The message pane height should be &quot; +</span>
<a href="#l170.130"></a><span id="l170.130" class="difflineat">@@ -368,16 +385,17 @@ function test_message_pane_width_persist</span>
<a href="#l170.131"></a><span id="l170.131">   let abwc = openAddressBook();</span>
<a href="#l170.132"></a><span id="l170.132"> </span>
<a href="#l170.133"></a><span id="l170.133">   // The 3pane window is closed.</span>
<a href="#l170.134"></a><span id="l170.134">   close_window(new mozmill.controller.MozMillController(mail3PaneWindow));</span>
<a href="#l170.135"></a><span id="l170.135">   // Wait for window close async session write to finish.</span>
<a href="#l170.136"></a><span id="l170.136">   controller.sleep(asyncFileWriteDelayMS);</span>
<a href="#l170.137"></a><span id="l170.137"> </span>
<a href="#l170.138"></a><span id="l170.138">   mc = open3PaneWindow();</span>
<a href="#l170.139"></a><span id="l170.139" class="difflineplus">+  set_mc(mc);</span>
<a href="#l170.140"></a><span id="l170.140">   be_in_folder(folderA);</span>
<a href="#l170.141"></a><span id="l170.141">   assert_message_pane_visible();</span>
<a href="#l170.142"></a><span id="l170.142">   assert_pane_layout(kVerticalMailLayout);</span>
<a href="#l170.143"></a><span id="l170.143"> </span>
<a href="#l170.144"></a><span id="l170.144">   actualWidth = mc.e(&quot;messagepaneboxwrapper&quot;).clientWidth;</span>
<a href="#l170.145"></a><span id="l170.145">   assert_equals(</span>
<a href="#l170.146"></a><span id="l170.146">     newWidth,</span>
<a href="#l170.147"></a><span id="l170.147">     actualWidth,</span>
<a href="#l170.148"></a><span id="l170.148" class="difflineat">@@ -407,16 +425,17 @@ function test_message_pane_width_persist</span>
<a href="#l170.149"></a><span id="l170.149">   oldWidth = actualWidth;</span>
<a href="#l170.150"></a><span id="l170.150"> </span>
<a href="#l170.151"></a><span id="l170.151">   // The 3pane window is closed.</span>
<a href="#l170.152"></a><span id="l170.152">   close_window(mc);</span>
<a href="#l170.153"></a><span id="l170.153">   // Wait for window close async session write to finish.</span>
<a href="#l170.154"></a><span id="l170.154">   controller.sleep(asyncFileWriteDelayMS);</span>
<a href="#l170.155"></a><span id="l170.155"> </span>
<a href="#l170.156"></a><span id="l170.156">   mc = open3PaneWindow();</span>
<a href="#l170.157"></a><span id="l170.157" class="difflineplus">+  set_mc(mc);</span>
<a href="#l170.158"></a><span id="l170.158">   be_in_folder(folderA);</span>
<a href="#l170.159"></a><span id="l170.159">   assert_message_pane_visible();</span>
<a href="#l170.160"></a><span id="l170.160">   assert_pane_layout(kVerticalMailLayout);</span>
<a href="#l170.161"></a><span id="l170.161"> </span>
<a href="#l170.162"></a><span id="l170.162">   actualWidth = mc.e(&quot;messagepaneboxwrapper&quot;).clientWidth;</span>
<a href="#l170.163"></a><span id="l170.163">   assert_equals(</span>
<a href="#l170.164"></a><span id="l170.164">     oldWidth,</span>
<a href="#l170.165"></a><span id="l170.165">     actualWidth,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l171.1"></a><span id="l171.1">rename from mail/test/mozmill/shared-modules/test-account-manager-helpers.js</span>
<a href="#l171.2"></a><span id="l171.2">rename to mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm</span>
<a href="#l171.3"></a><span id="l171.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-account-manager-helpers.js</span>
<a href="#l171.4"></a><span id="l171.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/AccountManagerHelpers.jsm</span>
<a href="#l171.5"></a><span id="l171.5" class="difflineat">@@ -1,45 +1,36 @@</span>
<a href="#l171.6"></a><span id="l171.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l171.7"></a><span id="l171.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l171.8"></a><span id="l171.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l171.9"></a><span id="l171.9"> </span>
<a href="#l171.10"></a><span id="l171.10"> &quot;use strict&quot;;</span>
<a href="#l171.11"></a><span id="l171.11"> </span>
<a href="#l171.12"></a><span id="l171.12" class="difflineminus">-var MODULE_NAME = &quot;account-manager-helpers&quot;;</span>
<a href="#l171.13"></a><span id="l171.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l171.14"></a><span id="l171.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l171.15"></a><span id="l171.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l171.16"></a><span id="l171.16" class="difflineplus">+  &quot;open_advanced_settings&quot;,</span>
<a href="#l171.17"></a><span id="l171.17" class="difflineplus">+  &quot;open_advanced_settings_from_account_wizard&quot;,</span>
<a href="#l171.18"></a><span id="l171.18" class="difflineplus">+  &quot;open_mail_account_setup_wizard&quot;,</span>
<a href="#l171.19"></a><span id="l171.19" class="difflineplus">+  &quot;click_account_tree_row&quot;,</span>
<a href="#l171.20"></a><span id="l171.20" class="difflineplus">+  &quot;get_account_tree_row&quot;,</span>
<a href="#l171.21"></a><span id="l171.21" class="difflineplus">+  &quot;remove_account&quot;,</span>
<a href="#l171.22"></a><span id="l171.22" class="difflineplus">+];</span>
<a href="#l171.23"></a><span id="l171.23"> </span>
<a href="#l171.24"></a><span id="l171.24" class="difflineminus">-var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l171.25"></a><span id="l171.25"> var elib = ChromeUtils.import(</span>
<a href="#l171.26"></a><span id="l171.26">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l171.27"></a><span id="l171.27"> );</span>
<a href="#l171.28"></a><span id="l171.28" class="difflineplus">+var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l171.29"></a><span id="l171.29"> </span>
<a href="#l171.30"></a><span id="l171.30" class="difflineplus">+var fdh = ChromeUtils.import(</span>
<a href="#l171.31"></a><span id="l171.31" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l171.32"></a><span id="l171.32" class="difflineplus">+);</span>
<a href="#l171.33"></a><span id="l171.33"> var wh = ChromeUtils.import(</span>
<a href="#l171.34"></a><span id="l171.34">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l171.35"></a><span id="l171.35"> );</span>
<a href="#l171.36"></a><span id="l171.36"> </span>
<a href="#l171.37"></a><span id="l171.37" class="difflineminus">-var fdh, mc;</span>
<a href="#l171.38"></a><span id="l171.38" class="difflineminus">-</span>
<a href="#l171.39"></a><span id="l171.39" class="difflineminus">-function setupModule() {</span>
<a href="#l171.40"></a><span id="l171.40" class="difflineminus">-  fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l171.41"></a><span id="l171.41" class="difflineminus">-  mc = fdh.mc;</span>
<a href="#l171.42"></a><span id="l171.42" class="difflineminus">-}</span>
<a href="#l171.43"></a><span id="l171.43" class="difflineminus">-</span>
<a href="#l171.44"></a><span id="l171.44" class="difflineminus">-function installInto(module) {</span>
<a href="#l171.45"></a><span id="l171.45" class="difflineminus">-  setupModule();</span>
<a href="#l171.46"></a><span id="l171.46" class="difflineminus">-</span>
<a href="#l171.47"></a><span id="l171.47" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l171.48"></a><span id="l171.48" class="difflineminus">-  module.open_advanced_settings = open_advanced_settings;</span>
<a href="#l171.49"></a><span id="l171.49" class="difflineminus">-  module.open_advanced_settings_from_account_wizard = open_advanced_settings_from_account_wizard;</span>
<a href="#l171.50"></a><span id="l171.50" class="difflineminus">-  module.open_mail_account_setup_wizard = open_mail_account_setup_wizard;</span>
<a href="#l171.51"></a><span id="l171.51" class="difflineminus">-  module.click_account_tree_row = click_account_tree_row;</span>
<a href="#l171.52"></a><span id="l171.52" class="difflineminus">-  module.get_account_tree_row = get_account_tree_row;</span>
<a href="#l171.53"></a><span id="l171.53" class="difflineminus">-  module.remove_account = remove_account;</span>
<a href="#l171.54"></a><span id="l171.54" class="difflineminus">-}</span>
<a href="#l171.55"></a><span id="l171.55" class="difflineplus">+var mc = fdh.mc;</span>
<a href="#l171.56"></a><span id="l171.56"> </span>
<a href="#l171.57"></a><span id="l171.57"> /**</span>
<a href="#l171.58"></a><span id="l171.58">  * Opens the Account Manager.</span>
<a href="#l171.59"></a><span id="l171.59">  *</span>
<a href="#l171.60"></a><span id="l171.60">  * @param callback Callback for the modal dialog that is opened.</span>
<a href="#l171.61"></a><span id="l171.61">  */</span>
<a href="#l171.62"></a><span id="l171.62"> function open_advanced_settings(aCallback, aController) {</span>
<a href="#l171.63"></a><span id="l171.63">   if (aController === undefined) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l172.1"></a><span id="l172.1">rename from mail/test/mozmill/shared-modules/test-address-book-helpers.js</span>
<a href="#l172.2"></a><span id="l172.2">rename to mail/test/mozmill/shared-modules/AddressBookHelpers.jsm</span>
<a href="#l172.3"></a><span id="l172.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-address-book-helpers.js</span>
<a href="#l172.4"></a><span id="l172.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/AddressBookHelpers.jsm</span>
<a href="#l172.5"></a><span id="l172.5" class="difflineat">@@ -1,76 +1,67 @@</span>
<a href="#l172.6"></a><span id="l172.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l172.7"></a><span id="l172.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l172.8"></a><span id="l172.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l172.9"></a><span id="l172.9"> </span>
<a href="#l172.10"></a><span id="l172.10"> &quot;use strict&quot;;</span>
<a href="#l172.11"></a><span id="l172.11"> </span>
<a href="#l172.12"></a><span id="l172.12" class="difflineminus">-var MODULE_NAME = &quot;address-book-helpers&quot;;</span>
<a href="#l172.13"></a><span id="l172.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l172.14"></a><span id="l172.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l172.15"></a><span id="l172.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l172.16"></a><span id="l172.16" class="difflineplus">+  &quot;ensure_card_exists&quot;,</span>
<a href="#l172.17"></a><span id="l172.17" class="difflineplus">+  &quot;ensure_no_card_exists&quot;,</span>
<a href="#l172.18"></a><span id="l172.18" class="difflineplus">+  &quot;open_address_book_window&quot;,</span>
<a href="#l172.19"></a><span id="l172.19" class="difflineplus">+  &quot;close_address_book_window&quot;,</span>
<a href="#l172.20"></a><span id="l172.20" class="difflineplus">+  &quot;create_address_book&quot;,</span>
<a href="#l172.21"></a><span id="l172.21" class="difflineplus">+  &quot;create_ldap_address_book&quot;,</span>
<a href="#l172.22"></a><span id="l172.22" class="difflineplus">+  &quot;create_contact&quot;,</span>
<a href="#l172.23"></a><span id="l172.23" class="difflineplus">+  &quot;create_mailing_list&quot;,</span>
<a href="#l172.24"></a><span id="l172.24" class="difflineplus">+  &quot;get_mailing_list_from_address_book&quot;,</span>
<a href="#l172.25"></a><span id="l172.25" class="difflineplus">+  &quot;load_contacts_into_address_book&quot;,</span>
<a href="#l172.26"></a><span id="l172.26" class="difflineplus">+  &quot;load_contacts_into_mailing_list&quot;,</span>
<a href="#l172.27"></a><span id="l172.27" class="difflineplus">+  &quot;get_cards_in_all_address_books_for_email&quot;,</span>
<a href="#l172.28"></a><span id="l172.28" class="difflineplus">+  &quot;get_address_book_tree_view_index&quot;,</span>
<a href="#l172.29"></a><span id="l172.29" class="difflineplus">+  &quot;set_address_books_collapsed&quot;,</span>
<a href="#l172.30"></a><span id="l172.30" class="difflineplus">+  &quot;set_address_books_expanded&quot;,</span>
<a href="#l172.31"></a><span id="l172.31" class="difflineplus">+  &quot;is_address_book_collapsed&quot;,</span>
<a href="#l172.32"></a><span id="l172.32" class="difflineplus">+  &quot;is_address_book_collapsible&quot;,</span>
<a href="#l172.33"></a><span id="l172.33" class="difflineplus">+  &quot;get_name_of_address_book_element_at&quot;,</span>
<a href="#l172.34"></a><span id="l172.34" class="difflineplus">+  &quot;select_address_book&quot;,</span>
<a href="#l172.35"></a><span id="l172.35" class="difflineplus">+  &quot;get_contact_ab_view_index&quot;,</span>
<a href="#l172.36"></a><span id="l172.36" class="difflineplus">+  &quot;select_contacts&quot;,</span>
<a href="#l172.37"></a><span id="l172.37" class="difflineplus">+  &quot;edit_selected_contact&quot;,</span>
<a href="#l172.38"></a><span id="l172.38" class="difflineplus">+  &quot;accept_contact_changes&quot;,</span>
<a href="#l172.39"></a><span id="l172.39" class="difflineplus">+  &quot;delete_address_book&quot;,</span>
<a href="#l172.40"></a><span id="l172.40" class="difflineplus">+];</span>
<a href="#l172.41"></a><span id="l172.41"> </span>
<a href="#l172.42"></a><span id="l172.42" class="difflineplus">+var folderDisplayHelper = ChromeUtils.import(</span>
<a href="#l172.43"></a><span id="l172.43" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l172.44"></a><span id="l172.44" class="difflineplus">+);</span>
<a href="#l172.45"></a><span id="l172.45"> var windowHelper = ChromeUtils.import(</span>
<a href="#l172.46"></a><span id="l172.46">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l172.47"></a><span id="l172.47"> );</span>
<a href="#l172.48"></a><span id="l172.48"> </span>
<a href="#l172.49"></a><span id="l172.49"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l172.50"></a><span id="l172.50"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l172.51"></a><span id="l172.51">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l172.52"></a><span id="l172.52"> );</span>
<a href="#l172.53"></a><span id="l172.53"> </span>
<a href="#l172.54"></a><span id="l172.54"> var ABJS_PREFIX = &quot;jsaddrbook://&quot;;</span>
<a href="#l172.55"></a><span id="l172.55"> var ABLDAP_PREFIX = &quot;moz-abldapdirectory://&quot;;</span>
<a href="#l172.56"></a><span id="l172.56"> </span>
<a href="#l172.57"></a><span id="l172.57"> var collectedAddresses;</span>
<a href="#l172.58"></a><span id="l172.58"> </span>
<a href="#l172.59"></a><span id="l172.59"> var abController;</span>
<a href="#l172.60"></a><span id="l172.60"> </span>
<a href="#l172.61"></a><span id="l172.61" class="difflineminus">-var folderDisplayHelper;</span>
<a href="#l172.62"></a><span id="l172.62" class="difflineminus">-var mc;</span>
<a href="#l172.63"></a><span id="l172.63" class="difflineminus">-</span>
<a href="#l172.64"></a><span id="l172.64" class="difflineminus">-function setupModule() {</span>
<a href="#l172.65"></a><span id="l172.65" class="difflineminus">-  folderDisplayHelper = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l172.66"></a><span id="l172.66" class="difflineminus">-  mc = folderDisplayHelper.mc;</span>
<a href="#l172.67"></a><span id="l172.67" class="difflineminus">-  // Ensure all the directories are initialised.</span>
<a href="#l172.68"></a><span id="l172.68" class="difflineminus">-  MailServices.ab.directories;</span>
<a href="#l172.69"></a><span id="l172.69" class="difflineminus">-  collectedAddresses = MailServices.ab.getDirectory(</span>
<a href="#l172.70"></a><span id="l172.70" class="difflineminus">-    &quot;jsaddrbook://history.sqlite&quot;</span>
<a href="#l172.71"></a><span id="l172.71" class="difflineminus">-  );</span>
<a href="#l172.72"></a><span id="l172.72" class="difflineminus">-}</span>
<a href="#l172.73"></a><span id="l172.73" class="difflineminus">-</span>
<a href="#l172.74"></a><span id="l172.74" class="difflineminus">-function installInto(module) {</span>
<a href="#l172.75"></a><span id="l172.75" class="difflineminus">-  setupModule();</span>
<a href="#l172.76"></a><span id="l172.76" class="difflineplus">+var mc = folderDisplayHelper.mc;</span>
<a href="#l172.77"></a><span id="l172.77"> </span>
<a href="#l172.78"></a><span id="l172.78" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l172.79"></a><span id="l172.79" class="difflineminus">-  module.ensure_card_exists = ensure_card_exists;</span>
<a href="#l172.80"></a><span id="l172.80" class="difflineminus">-  module.ensure_no_card_exists = ensure_no_card_exists;</span>
<a href="#l172.81"></a><span id="l172.81" class="difflineminus">-  module.open_address_book_window = open_address_book_window;</span>
<a href="#l172.82"></a><span id="l172.82" class="difflineminus">-  module.close_address_book_window = close_address_book_window;</span>
<a href="#l172.83"></a><span id="l172.83" class="difflineminus">-  module.create_address_book = create_address_book;</span>
<a href="#l172.84"></a><span id="l172.84" class="difflineminus">-  module.create_ldap_address_book = create_ldap_address_book;</span>
<a href="#l172.85"></a><span id="l172.85" class="difflineminus">-  module.create_contact = create_contact;</span>
<a href="#l172.86"></a><span id="l172.86" class="difflineminus">-  module.create_mailing_list = create_mailing_list;</span>
<a href="#l172.87"></a><span id="l172.87" class="difflineminus">-  module.get_mailing_list_from_address_book = get_mailing_list_from_address_book;</span>
<a href="#l172.88"></a><span id="l172.88" class="difflineminus">-  module.load_contacts_into_address_book = load_contacts_into_address_book;</span>
<a href="#l172.89"></a><span id="l172.89" class="difflineminus">-  module.load_contacts_into_mailing_list = load_contacts_into_mailing_list;</span>
<a href="#l172.90"></a><span id="l172.90" class="difflineminus">-  module.get_cards_in_all_address_books_for_email = get_cards_in_all_address_books_for_email;</span>
<a href="#l172.91"></a><span id="l172.91" class="difflineminus">-  module.get_address_book_tree_view_index = get_address_book_tree_view_index;</span>
<a href="#l172.92"></a><span id="l172.92" class="difflineminus">-  module.set_address_books_collapsed = set_address_books_collapsed;</span>
<a href="#l172.93"></a><span id="l172.93" class="difflineminus">-  module.set_address_books_expanded = set_address_books_expanded;</span>
<a href="#l172.94"></a><span id="l172.94" class="difflineminus">-  module.is_address_book_collapsed = is_address_book_collapsed;</span>
<a href="#l172.95"></a><span id="l172.95" class="difflineminus">-  module.is_address_book_collapsible = is_address_book_collapsible;</span>
<a href="#l172.96"></a><span id="l172.96" class="difflineminus">-  module.get_name_of_address_book_element_at = get_name_of_address_book_element_at;</span>
<a href="#l172.97"></a><span id="l172.97" class="difflineminus">-  module.select_address_book = select_address_book;</span>
<a href="#l172.98"></a><span id="l172.98" class="difflineminus">-  module.get_contact_ab_view_index = get_contact_ab_view_index;</span>
<a href="#l172.99"></a><span id="l172.99" class="difflineminus">-  module.select_contacts = select_contacts;</span>
<a href="#l172.100"></a><span id="l172.100" class="difflineminus">-  module.edit_selected_contact = edit_selected_contact;</span>
<a href="#l172.101"></a><span id="l172.101" class="difflineminus">-  module.accept_contact_changes = accept_contact_changes;</span>
<a href="#l172.102"></a><span id="l172.102" class="difflineminus">-  module.delete_address_book = delete_address_book;</span>
<a href="#l172.103"></a><span id="l172.103" class="difflineminus">-}</span>
<a href="#l172.104"></a><span id="l172.104" class="difflineplus">+// Ensure all the directories are initialised.</span>
<a href="#l172.105"></a><span id="l172.105" class="difflineplus">+MailServices.ab.directories;</span>
<a href="#l172.106"></a><span id="l172.106" class="difflineplus">+collectedAddresses = MailServices.ab.getDirectory(</span>
<a href="#l172.107"></a><span id="l172.107" class="difflineplus">+  &quot;jsaddrbook://history.sqlite&quot;</span>
<a href="#l172.108"></a><span id="l172.108" class="difflineplus">+);</span>
<a href="#l172.109"></a><span id="l172.109"> </span>
<a href="#l172.110"></a><span id="l172.110"> /**</span>
<a href="#l172.111"></a><span id="l172.111">  * Make sure that there is a card for this email address</span>
<a href="#l172.112"></a><span id="l172.112">  * @param emailAddress the address that should have a card</span>
<a href="#l172.113"></a><span id="l172.113">  * @param displayName the display name the card should have</span>
<a href="#l172.114"></a><span id="l172.114">  * @param preferDisplayName |true| if the card display name should override the</span>
<a href="#l172.115"></a><span id="l172.115">  *                          header display name</span>
<a href="#l172.116"></a><span id="l172.116">  */</span>
<a href="#l172.117"></a><span id="l172.117" class="difflineat">@@ -129,17 +120,17 @@ function open_address_book_window(aContr</span>
<a href="#l172.118"></a><span id="l172.118">   if (aController === undefined) {</span>
<a href="#l172.119"></a><span id="l172.119">     aController = mc;</span>
<a href="#l172.120"></a><span id="l172.120">   }</span>
<a href="#l172.121"></a><span id="l172.121"> </span>
<a href="#l172.122"></a><span id="l172.122">   windowHelper.plan_for_new_window(&quot;mail:addressbook&quot;);</span>
<a href="#l172.123"></a><span id="l172.123">   aController.keypress(null, &quot;b&quot;, { shiftKey: true, accelKey: true });</span>
<a href="#l172.124"></a><span id="l172.124"> </span>
<a href="#l172.125"></a><span id="l172.125">   // XXX this should probably be changed to making callers pass in which address</span>
<a href="#l172.126"></a><span id="l172.126" class="difflineminus">-  // book they want to work with, just like test-compose-helpers.</span>
<a href="#l172.127"></a><span id="l172.127" class="difflineplus">+  // book they want to work with, just like ComposeHelpers.</span>
<a href="#l172.128"></a><span id="l172.128">   abController = windowHelper.wait_for_new_window(&quot;mail:addressbook&quot;);</span>
<a href="#l172.129"></a><span id="l172.129">   windowHelper.augment_controller(abController);</span>
<a href="#l172.130"></a><span id="l172.130">   return abController;</span>
<a href="#l172.131"></a><span id="l172.131"> }</span>
<a href="#l172.132"></a><span id="l172.132"> </span>
<a href="#l172.133"></a><span id="l172.133"> /**</span>
<a href="#l172.134"></a><span id="l172.134">  * Closes the address book interface</span>
<a href="#l172.135"></a><span id="l172.135">  * @param abc the controller for the address book window to close</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l173.1"></a><span id="l173.1">rename from mail/test/mozmill/shared-modules/test-cloudfile-helpers.js</span>
<a href="#l173.2"></a><span id="l173.2">rename to mail/test/mozmill/shared-modules/CloudfileHelpers.jsm</span>
<a href="#l173.3"></a><span id="l173.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-cloudfile-helpers.js</span>
<a href="#l173.4"></a><span id="l173.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/CloudfileHelpers.jsm</span>
<a href="#l173.5"></a><span id="l173.5" class="difflineat">@@ -1,55 +1,44 @@</span>
<a href="#l173.6"></a><span id="l173.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l173.7"></a><span id="l173.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l173.8"></a><span id="l173.8">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l173.9"></a><span id="l173.9"> </span>
<a href="#l173.10"></a><span id="l173.10"> &quot;use strict&quot;;</span>
<a href="#l173.11"></a><span id="l173.11"> </span>
<a href="#l173.12"></a><span id="l173.12" class="difflineminus">-var MODULE_NAME = &quot;cloudfile-helpers&quot;;</span>
<a href="#l173.13"></a><span id="l173.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l173.14"></a><span id="l173.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l173.15"></a><span id="l173.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l173.16"></a><span id="l173.16" class="difflineplus">+  &quot;gMockCloudfileManager&quot;,</span>
<a href="#l173.17"></a><span id="l173.17" class="difflineplus">+  &quot;MockCloudfileAccount&quot;,</span>
<a href="#l173.18"></a><span id="l173.18" class="difflineplus">+  &quot;getFile&quot;,</span>
<a href="#l173.19"></a><span id="l173.19" class="difflineplus">+  &quot;collectFiles&quot;,</span>
<a href="#l173.20"></a><span id="l173.20" class="difflineplus">+];</span>
<a href="#l173.21"></a><span id="l173.21"> </span>
<a href="#l173.22"></a><span id="l173.22" class="difflineminus">-var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l173.23"></a><span id="l173.23" class="difflineplus">+var fdh = ChromeUtils.import(</span>
<a href="#l173.24"></a><span id="l173.24" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l173.25"></a><span id="l173.25" class="difflineplus">+);</span>
<a href="#l173.26"></a><span id="l173.26" class="difflineplus">+</span>
<a href="#l173.27"></a><span id="l173.27"> var { cloudFileAccounts } = ChromeUtils.import(</span>
<a href="#l173.28"></a><span id="l173.28">   &quot;resource:///modules/cloudFileAccounts.jsm&quot;</span>
<a href="#l173.29"></a><span id="l173.29"> );</span>
<a href="#l173.30"></a><span id="l173.30"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l173.31"></a><span id="l173.31"> </span>
<a href="#l173.32"></a><span id="l173.32" class="difflineminus">-var kMockContractIDPrefix = &quot;@mozilla.org/mail/mockCloudFile;1?id=&quot;;</span>
<a href="#l173.33"></a><span id="l173.33" class="difflineminus">-</span>
<a href="#l173.34"></a><span id="l173.34"> var kDefaults = {</span>
<a href="#l173.35"></a><span id="l173.35">   type: &quot;default&quot;,</span>
<a href="#l173.36"></a><span id="l173.36">   iconURL: &quot;chrome://messenger/content/extension.svg&quot;,</span>
<a href="#l173.37"></a><span id="l173.37">   accountKey: null,</span>
<a href="#l173.38"></a><span id="l173.38">   settingsURL: &quot;&quot;,</span>
<a href="#l173.39"></a><span id="l173.39">   managementURL: &quot;&quot;,</span>
<a href="#l173.40"></a><span id="l173.40">   authErr: cloudFileAccounts.constants.authErr,</span>
<a href="#l173.41"></a><span id="l173.41">   offlineErr: cloudFileAccounts.constants.offlineErr,</span>
<a href="#l173.42"></a><span id="l173.42">   uploadErr: cloudFileAccounts.constants.uploadErr,</span>
<a href="#l173.43"></a><span id="l173.43">   uploadWouldExceedQuota: cloudFileAccounts.constants.uploadWouldExceedQuota,</span>
<a href="#l173.44"></a><span id="l173.44">   uploadExceedsFileLimit: cloudFileAccounts.constants.uploadExceedsFileLimit,</span>
<a href="#l173.45"></a><span id="l173.45">   uploadCancelled: cloudFileAccounts.constants.uploadCancelled,</span>
<a href="#l173.46"></a><span id="l173.46"> };</span>
<a href="#l173.47"></a><span id="l173.47"> </span>
<a href="#l173.48"></a><span id="l173.48" class="difflineminus">-var fdh;</span>
<a href="#l173.49"></a><span id="l173.49" class="difflineminus">-</span>
<a href="#l173.50"></a><span id="l173.50" class="difflineminus">-function setupModule(module) {</span>
<a href="#l173.51"></a><span id="l173.51" class="difflineminus">-  fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l173.52"></a><span id="l173.52" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l173.53"></a><span id="l173.53" class="difflineminus">-}</span>
<a href="#l173.54"></a><span id="l173.54" class="difflineminus">-</span>
<a href="#l173.55"></a><span id="l173.55" class="difflineminus">-function installInto(module) {</span>
<a href="#l173.56"></a><span id="l173.56" class="difflineminus">-  setupModule(module);</span>
<a href="#l173.57"></a><span id="l173.57" class="difflineminus">-  module.gMockCloudfileManager = gMockCloudfileManager;</span>
<a href="#l173.58"></a><span id="l173.58" class="difflineminus">-  module.MockCloudfileAccount = MockCloudfileAccount;</span>
<a href="#l173.59"></a><span id="l173.59" class="difflineminus">-  module.getFile = getFile;</span>
<a href="#l173.60"></a><span id="l173.60" class="difflineminus">-  module.collectFiles = collectFiles;</span>
<a href="#l173.61"></a><span id="l173.61" class="difflineminus">-}</span>
<a href="#l173.62"></a><span id="l173.62" class="difflineminus">-</span>
<a href="#l173.63"></a><span id="l173.63"> function getFile(aFilename, aRoot) {</span>
<a href="#l173.64"></a><span id="l173.64">   let path = os.getFileForPath(aRoot);</span>
<a href="#l173.65"></a><span id="l173.65">   let file = os.getFileForPath(os.abspath(aFilename, path));</span>
<a href="#l173.66"></a><span id="l173.66">   fdh.assert_true(file.exists, &quot;File &quot; + aFilename + &quot; does not exist.&quot;);</span>
<a href="#l173.67"></a><span id="l173.67">   return file;</span>
<a href="#l173.68"></a><span id="l173.68"> }</span>
<a href="#l173.69"></a><span id="l173.69"> </span>
<a href="#l173.70"></a><span id="l173.70"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l174.1"></a><span id="l174.1">rename from mail/test/mozmill/shared-modules/test-compose-helpers.js</span>
<a href="#l174.2"></a><span id="l174.2">rename to mail/test/mozmill/shared-modules/ComposeHelpers.jsm</span>
<a href="#l174.3"></a><span id="l174.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-compose-helpers.js</span>
<a href="#l174.4"></a><span id="l174.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/ComposeHelpers.jsm</span>
<a href="#l174.5"></a><span id="l174.5" class="difflineat">@@ -1,66 +1,54 @@</span>
<a href="#l174.6"></a><span id="l174.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l174.7"></a><span id="l174.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l174.8"></a><span id="l174.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l174.9"></a><span id="l174.9"> </span>
<a href="#l174.10"></a><span id="l174.10"> &quot;use strict&quot;;</span>
<a href="#l174.11"></a><span id="l174.11"> </span>
<a href="#l174.12"></a><span id="l174.12" class="difflineminus">-var MODULE_NAME = &quot;compose-helpers&quot;;</span>
<a href="#l174.13"></a><span id="l174.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l174.14"></a><span id="l174.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;dom-helpers&quot;];</span>
<a href="#l174.15"></a><span id="l174.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l174.16"></a><span id="l174.16" class="difflineplus">+  &quot;open_compose_new_mail&quot;,</span>
<a href="#l174.17"></a><span id="l174.17" class="difflineplus">+  &quot;open_compose_with_reply&quot;,</span>
<a href="#l174.18"></a><span id="l174.18" class="difflineplus">+  &quot;open_compose_with_reply_to_all&quot;,</span>
<a href="#l174.19"></a><span id="l174.19" class="difflineplus">+  &quot;open_compose_with_reply_to_list&quot;,</span>
<a href="#l174.20"></a><span id="l174.20" class="difflineplus">+  &quot;open_compose_with_forward&quot;,</span>
<a href="#l174.21"></a><span id="l174.21" class="difflineplus">+  &quot;open_compose_with_forward_as_attachments&quot;,</span>
<a href="#l174.22"></a><span id="l174.22" class="difflineplus">+  &quot;open_compose_with_edit_as_new&quot;,</span>
<a href="#l174.23"></a><span id="l174.23" class="difflineplus">+  &quot;open_compose_with_element_click&quot;,</span>
<a href="#l174.24"></a><span id="l174.24" class="difflineplus">+  &quot;open_compose_from_draft&quot;,</span>
<a href="#l174.25"></a><span id="l174.25" class="difflineplus">+  &quot;close_compose_window&quot;,</span>
<a href="#l174.26"></a><span id="l174.26" class="difflineplus">+  &quot;wait_for_compose_window&quot;,</span>
<a href="#l174.27"></a><span id="l174.27" class="difflineplus">+  &quot;setup_msg_contents&quot;,</span>
<a href="#l174.28"></a><span id="l174.28" class="difflineplus">+  &quot;clear_recipient&quot;,</span>
<a href="#l174.29"></a><span id="l174.29" class="difflineplus">+  &quot;toggle_recipient_type&quot;,</span>
<a href="#l174.30"></a><span id="l174.30" class="difflineplus">+  &quot;create_msg_attachment&quot;,</span>
<a href="#l174.31"></a><span id="l174.31" class="difflineplus">+  &quot;add_attachments&quot;,</span>
<a href="#l174.32"></a><span id="l174.32" class="difflineplus">+  &quot;add_cloud_attachments&quot;,</span>
<a href="#l174.33"></a><span id="l174.33" class="difflineplus">+  &quot;delete_attachment&quot;,</span>
<a href="#l174.34"></a><span id="l174.34" class="difflineplus">+  &quot;get_compose_body&quot;,</span>
<a href="#l174.35"></a><span id="l174.35" class="difflineplus">+  &quot;type_in_composer&quot;,</span>
<a href="#l174.36"></a><span id="l174.36" class="difflineplus">+  &quot;assert_previous_text&quot;,</span>
<a href="#l174.37"></a><span id="l174.37" class="difflineplus">+  &quot;get_msg_source&quot;,</span>
<a href="#l174.38"></a><span id="l174.38" class="difflineplus">+];</span>
<a href="#l174.39"></a><span id="l174.39"> </span>
<a href="#l174.40"></a><span id="l174.40"> var elib = ChromeUtils.import(</span>
<a href="#l174.41"></a><span id="l174.41">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l174.42"></a><span id="l174.42"> );</span>
<a href="#l174.43"></a><span id="l174.43"> var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l174.44"></a><span id="l174.44"> </span>
<a href="#l174.45"></a><span id="l174.45" class="difflineplus">+var folderDisplayHelper = ChromeUtils.import(</span>
<a href="#l174.46"></a><span id="l174.46" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l174.47"></a><span id="l174.47" class="difflineplus">+);</span>
<a href="#l174.48"></a><span id="l174.48"> var windowHelper = ChromeUtils.import(</span>
<a href="#l174.49"></a><span id="l174.49">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l174.50"></a><span id="l174.50"> );</span>
<a href="#l174.51"></a><span id="l174.51"> </span>
<a href="#l174.52"></a><span id="l174.52"> var kTextNodeType = 3;</span>
<a href="#l174.53"></a><span id="l174.53"> </span>
<a href="#l174.54"></a><span id="l174.54" class="difflineminus">-var folderDisplayHelper;</span>
<a href="#l174.55"></a><span id="l174.55" class="difflineminus">-var mc;</span>
<a href="#l174.56"></a><span id="l174.56" class="difflineminus">-var domHelper;</span>
<a href="#l174.57"></a><span id="l174.57" class="difflineminus">-</span>
<a href="#l174.58"></a><span id="l174.58" class="difflineminus">-function setupModule() {</span>
<a href="#l174.59"></a><span id="l174.59" class="difflineminus">-  folderDisplayHelper = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l174.60"></a><span id="l174.60" class="difflineminus">-  mc = folderDisplayHelper.mc;</span>
<a href="#l174.61"></a><span id="l174.61" class="difflineminus">-  domHelper = collector.getModule(&quot;dom-helpers&quot;);</span>
<a href="#l174.62"></a><span id="l174.62" class="difflineminus">-}</span>
<a href="#l174.63"></a><span id="l174.63" class="difflineminus">-</span>
<a href="#l174.64"></a><span id="l174.64" class="difflineminus">-function installInto(module) {</span>
<a href="#l174.65"></a><span id="l174.65" class="difflineminus">-  setupModule();</span>
<a href="#l174.66"></a><span id="l174.66" class="difflineminus">-</span>
<a href="#l174.67"></a><span id="l174.67" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l174.68"></a><span id="l174.68" class="difflineminus">-  module.open_compose_new_mail = open_compose_new_mail;</span>
<a href="#l174.69"></a><span id="l174.69" class="difflineminus">-  module.open_compose_with_reply = open_compose_with_reply;</span>
<a href="#l174.70"></a><span id="l174.70" class="difflineminus">-  module.open_compose_with_reply_to_all = open_compose_with_reply_to_all;</span>
<a href="#l174.71"></a><span id="l174.71" class="difflineminus">-  module.open_compose_with_reply_to_list = open_compose_with_reply_to_list;</span>
<a href="#l174.72"></a><span id="l174.72" class="difflineminus">-  module.open_compose_with_forward = open_compose_with_forward;</span>
<a href="#l174.73"></a><span id="l174.73" class="difflineminus">-  module.open_compose_with_forward_as_attachments = open_compose_with_forward_as_attachments;</span>
<a href="#l174.74"></a><span id="l174.74" class="difflineminus">-  module.open_compose_with_edit_as_new = open_compose_with_edit_as_new;</span>
<a href="#l174.75"></a><span id="l174.75" class="difflineminus">-  module.open_compose_with_element_click = open_compose_with_element_click;</span>
<a href="#l174.76"></a><span id="l174.76" class="difflineminus">-  module.open_compose_from_draft = open_compose_from_draft;</span>
<a href="#l174.77"></a><span id="l174.77" class="difflineminus">-  module.close_compose_window = close_compose_window;</span>
<a href="#l174.78"></a><span id="l174.78" class="difflineminus">-  module.wait_for_compose_window = wait_for_compose_window;</span>
<a href="#l174.79"></a><span id="l174.79" class="difflineminus">-  module.setup_msg_contents = setup_msg_contents;</span>
<a href="#l174.80"></a><span id="l174.80" class="difflineminus">-  module.clear_recipient = clear_recipient;</span>
<a href="#l174.81"></a><span id="l174.81" class="difflineminus">-  module.toggle_recipient_type = toggle_recipient_type;</span>
<a href="#l174.82"></a><span id="l174.82" class="difflineminus">-  module.create_msg_attachment = create_msg_attachment;</span>
<a href="#l174.83"></a><span id="l174.83" class="difflineminus">-  module.add_attachments = add_attachments;</span>
<a href="#l174.84"></a><span id="l174.84" class="difflineminus">-  module.add_cloud_attachments = add_cloud_attachments;</span>
<a href="#l174.85"></a><span id="l174.85" class="difflineminus">-  module.delete_attachment = delete_attachment;</span>
<a href="#l174.86"></a><span id="l174.86" class="difflineminus">-  module.get_compose_body = get_compose_body;</span>
<a href="#l174.87"></a><span id="l174.87" class="difflineminus">-  module.type_in_composer = type_in_composer;</span>
<a href="#l174.88"></a><span id="l174.88" class="difflineminus">-  module.assert_previous_text = assert_previous_text;</span>
<a href="#l174.89"></a><span id="l174.89" class="difflineminus">-  module.get_msg_source = get_msg_source;</span>
<a href="#l174.90"></a><span id="l174.90" class="difflineminus">-}</span>
<a href="#l174.91"></a><span id="l174.91" class="difflineplus">+var mc = folderDisplayHelper.mc;</span>
<a href="#l174.92"></a><span id="l174.92"> </span>
<a href="#l174.93"></a><span id="l174.93"> /**</span>
<a href="#l174.94"></a><span id="l174.94">  * Opens the compose window by starting a new message</span>
<a href="#l174.95"></a><span id="l174.95">  *</span>
<a href="#l174.96"></a><span id="l174.96">  * @param aController the controller for the mail:3pane from which to spawn</span>
<a href="#l174.97"></a><span id="l174.97">  *                    the compose window.  If left blank, defaults to mc.</span>
<a href="#l174.98"></a><span id="l174.98">  *</span>
<a href="#l174.99"></a><span id="l174.99">  * @return The loaded window of type &quot;msgcompose&quot; wrapped in a MozmillController</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l175.1"></a><span id="l175.1">rename from mail/test/mozmill/shared-modules/test-content-tab-helpers.js</span>
<a href="#l175.2"></a><span id="l175.2">rename to mail/test/mozmill/shared-modules/ContentTabHelpers.jsm</span>
<a href="#l175.3"></a><span id="l175.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-content-tab-helpers.js</span>
<a href="#l175.4"></a><span id="l175.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/ContentTabHelpers.jsm</span>
<a href="#l175.5"></a><span id="l175.5" class="difflineat">@@ -1,86 +1,71 @@</span>
<a href="#l175.6"></a><span id="l175.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l175.7"></a><span id="l175.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l175.8"></a><span id="l175.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l175.9"></a><span id="l175.9"> </span>
<a href="#l175.10"></a><span id="l175.10"> &quot;use strict&quot;;</span>
<a href="#l175.11"></a><span id="l175.11"> </span>
<a href="#l175.12"></a><span id="l175.12" class="difflineminus">-var MODULE_NAME = &quot;content-tab-helpers&quot;;</span>
<a href="#l175.13"></a><span id="l175.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l175.14"></a><span id="l175.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l175.15"></a><span id="l175.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l175.16"></a><span id="l175.16" class="difflineplus">+  &quot;open_content_tab_with_url&quot;,</span>
<a href="#l175.17"></a><span id="l175.17" class="difflineplus">+  &quot;open_content_tab_with_click&quot;,</span>
<a href="#l175.18"></a><span id="l175.18" class="difflineplus">+  &quot;plan_for_content_tab_load&quot;,</span>
<a href="#l175.19"></a><span id="l175.19" class="difflineplus">+  &quot;wait_for_content_tab_load&quot;,</span>
<a href="#l175.20"></a><span id="l175.20" class="difflineplus">+  &quot;assert_content_tab_has_url&quot;,</span>
<a href="#l175.21"></a><span id="l175.21" class="difflineplus">+  &quot;assert_content_tab_has_favicon&quot;,</span>
<a href="#l175.22"></a><span id="l175.22" class="difflineplus">+  &quot;content_tab_e&quot;,</span>
<a href="#l175.23"></a><span id="l175.23" class="difflineplus">+  &quot;content_tab_eid&quot;,</span>
<a href="#l175.24"></a><span id="l175.24" class="difflineplus">+  &quot;get_content_tab_element_display&quot;,</span>
<a href="#l175.25"></a><span id="l175.25" class="difflineplus">+  &quot;assert_content_tab_element_hidden&quot;,</span>
<a href="#l175.26"></a><span id="l175.26" class="difflineplus">+  &quot;assert_content_tab_element_visible&quot;,</span>
<a href="#l175.27"></a><span id="l175.27" class="difflineplus">+  &quot;wait_for_content_tab_element_display_value&quot;,</span>
<a href="#l175.28"></a><span id="l175.28" class="difflineplus">+  &quot;wait_for_content_tab_element_display&quot;,</span>
<a href="#l175.29"></a><span id="l175.29" class="difflineplus">+  &quot;get_element_by_text&quot;,</span>
<a href="#l175.30"></a><span id="l175.30" class="difflineplus">+  &quot;assert_content_tab_text_present&quot;,</span>
<a href="#l175.31"></a><span id="l175.31" class="difflineplus">+  &quot;assert_content_tab_text_absent&quot;,</span>
<a href="#l175.32"></a><span id="l175.32" class="difflineplus">+  &quot;NotificationWatcher&quot;,</span>
<a href="#l175.33"></a><span id="l175.33" class="difflineplus">+  &quot;get_notification_bar_for_tab&quot;,</span>
<a href="#l175.34"></a><span id="l175.34" class="difflineplus">+  &quot;get_test_plugin&quot;,</span>
<a href="#l175.35"></a><span id="l175.35" class="difflineplus">+  &quot;updateBlocklist&quot;,</span>
<a href="#l175.36"></a><span id="l175.36" class="difflineplus">+  &quot;setAndUpdateBlocklist&quot;,</span>
<a href="#l175.37"></a><span id="l175.37" class="difflineplus">+  &quot;resetBlocklist&quot;,</span>
<a href="#l175.38"></a><span id="l175.38" class="difflineplus">+  &quot;gMockExtProtSvcReg&quot;,</span>
<a href="#l175.39"></a><span id="l175.39" class="difflineplus">+  &quot;gMockExtProtSvc&quot;,</span>
<a href="#l175.40"></a><span id="l175.40" class="difflineplus">+];</span>
<a href="#l175.41"></a><span id="l175.41"> </span>
<a href="#l175.42"></a><span id="l175.42"> var elib = ChromeUtils.import(</span>
<a href="#l175.43"></a><span id="l175.43">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l175.44"></a><span id="l175.44"> );</span>
<a href="#l175.45"></a><span id="l175.45"> var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l175.46"></a><span id="l175.46"> </span>
<a href="#l175.47"></a><span id="l175.47" class="difflineplus">+var folderDisplayHelper = ChromeUtils.import(</span>
<a href="#l175.48"></a><span id="l175.48" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l175.49"></a><span id="l175.49" class="difflineplus">+);</span>
<a href="#l175.50"></a><span id="l175.50"> var { MockObjectReplacer } = ChromeUtils.import(</span>
<a href="#l175.51"></a><span id="l175.51">   &quot;resource://testing-common/mozmill/MockObjectHelpers.jsm&quot;</span>
<a href="#l175.52"></a><span id="l175.52"> );</span>
<a href="#l175.53"></a><span id="l175.53"> var wh = ChromeUtils.import(</span>
<a href="#l175.54"></a><span id="l175.54">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l175.55"></a><span id="l175.55"> );</span>
<a href="#l175.56"></a><span id="l175.56"> </span>
<a href="#l175.57"></a><span id="l175.57"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l175.58"></a><span id="l175.58"> </span>
<a href="#l175.59"></a><span id="l175.59" class="difflineminus">-var NORMAL_TIMEOUT = 6000;</span>
<a href="#l175.60"></a><span id="l175.60"> var FAST_TIMEOUT = 1000;</span>
<a href="#l175.61"></a><span id="l175.61"> var FAST_INTERVAL = 100;</span>
<a href="#l175.62"></a><span id="l175.62"> var EXT_PROTOCOL_SVC_CID = &quot;@mozilla.org/uriloader/external-protocol-service;1&quot;;</span>
<a href="#l175.63"></a><span id="l175.63"> </span>
<a href="#l175.64"></a><span id="l175.64" class="difflineminus">-var folderDisplayHelper;</span>
<a href="#l175.65"></a><span id="l175.65" class="difflineminus">-var mc;</span>
<a href="#l175.66"></a><span id="l175.66" class="difflineplus">+var mc = folderDisplayHelper.mc;</span>
<a href="#l175.67"></a><span id="l175.67" class="difflineplus">+var mark_failure = folderDisplayHelper.mark_failure;</span>
<a href="#l175.68"></a><span id="l175.68"> </span>
<a href="#l175.69"></a><span id="l175.69"> var _originalBlocklistURL = null;</span>
<a href="#l175.70"></a><span id="l175.70"> </span>
<a href="#l175.71"></a><span id="l175.71" class="difflineminus">-// logHelper (and therefore folderDisplayHelper) exports</span>
<a href="#l175.72"></a><span id="l175.72" class="difflineminus">-var mark_failure;</span>
<a href="#l175.73"></a><span id="l175.73" class="difflineminus">-var gMockExtProtSvcReg;</span>
<a href="#l175.74"></a><span id="l175.74" class="difflineminus">-</span>
<a href="#l175.75"></a><span id="l175.75" class="difflineminus">-function setupModule() {</span>
<a href="#l175.76"></a><span id="l175.76" class="difflineminus">-  folderDisplayHelper = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l175.77"></a><span id="l175.77" class="difflineminus">-  mc = folderDisplayHelper.mc;</span>
<a href="#l175.78"></a><span id="l175.78" class="difflineminus">-  mark_failure = folderDisplayHelper.mark_failure;</span>
<a href="#l175.79"></a><span id="l175.79" class="difflineminus">-</span>
<a href="#l175.80"></a><span id="l175.80" class="difflineminus">-  gMockExtProtSvcReg = new MockObjectReplacer(</span>
<a href="#l175.81"></a><span id="l175.81" class="difflineminus">-    EXT_PROTOCOL_SVC_CID,</span>
<a href="#l175.82"></a><span id="l175.82" class="difflineminus">-    MockExtProtConstructor</span>
<a href="#l175.83"></a><span id="l175.83" class="difflineminus">-  );</span>
<a href="#l175.84"></a><span id="l175.84" class="difflineminus">-}</span>
<a href="#l175.85"></a><span id="l175.85" class="difflineminus">-</span>
<a href="#l175.86"></a><span id="l175.86" class="difflineminus">-function installInto(module) {</span>
<a href="#l175.87"></a><span id="l175.87" class="difflineminus">-  setupModule();</span>
<a href="#l175.88"></a><span id="l175.88" class="difflineminus">-</span>
<a href="#l175.89"></a><span id="l175.89" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l175.90"></a><span id="l175.90" class="difflineminus">-  module.open_content_tab_with_url = open_content_tab_with_url;</span>
<a href="#l175.91"></a><span id="l175.91" class="difflineminus">-  module.open_content_tab_with_click = open_content_tab_with_click;</span>
<a href="#l175.92"></a><span id="l175.92" class="difflineminus">-  module.plan_for_content_tab_load = plan_for_content_tab_load;</span>
<a href="#l175.93"></a><span id="l175.93" class="difflineminus">-  module.wait_for_content_tab_load = wait_for_content_tab_load;</span>
<a href="#l175.94"></a><span id="l175.94" class="difflineminus">-  module.assert_content_tab_has_url = assert_content_tab_has_url;</span>
<a href="#l175.95"></a><span id="l175.95" class="difflineminus">-  module.assert_content_tab_has_favicon = assert_content_tab_has_favicon;</span>
<a href="#l175.96"></a><span id="l175.96" class="difflineminus">-  module.content_tab_e = content_tab_e;</span>
<a href="#l175.97"></a><span id="l175.97" class="difflineminus">-  module.content_tab_eid = content_tab_eid;</span>
<a href="#l175.98"></a><span id="l175.98" class="difflineminus">-  module.get_content_tab_element_display = get_content_tab_element_display;</span>
<a href="#l175.99"></a><span id="l175.99" class="difflineminus">-  module.assert_content_tab_element_hidden = assert_content_tab_element_hidden;</span>
<a href="#l175.100"></a><span id="l175.100" class="difflineminus">-  module.assert_content_tab_element_visible = assert_content_tab_element_visible;</span>
<a href="#l175.101"></a><span id="l175.101" class="difflineminus">-  module.wait_for_content_tab_element_display_value = wait_for_content_tab_element_display_value;</span>
<a href="#l175.102"></a><span id="l175.102" class="difflineminus">-  module.wait_for_content_tab_element_display = wait_for_content_tab_element_display;</span>
<a href="#l175.103"></a><span id="l175.103" class="difflineminus">-  module.get_element_by_text = get_element_by_text;</span>
<a href="#l175.104"></a><span id="l175.104" class="difflineminus">-  module.assert_content_tab_text_present = assert_content_tab_text_present;</span>
<a href="#l175.105"></a><span id="l175.105" class="difflineminus">-  module.assert_content_tab_text_absent = assert_content_tab_text_absent;</span>
<a href="#l175.106"></a><span id="l175.106" class="difflineminus">-  module.NotificationWatcher = NotificationWatcher;</span>
<a href="#l175.107"></a><span id="l175.107" class="difflineminus">-  module.get_notification_bar_for_tab = get_notification_bar_for_tab;</span>
<a href="#l175.108"></a><span id="l175.108" class="difflineminus">-  module.get_test_plugin = get_test_plugin;</span>
<a href="#l175.109"></a><span id="l175.109" class="difflineminus">-  module.updateBlocklist = updateBlocklist;</span>
<a href="#l175.110"></a><span id="l175.110" class="difflineminus">-  module.setAndUpdateBlocklist = setAndUpdateBlocklist;</span>
<a href="#l175.111"></a><span id="l175.111" class="difflineminus">-  module.resetBlocklist = resetBlocklist;</span>
<a href="#l175.112"></a><span id="l175.112" class="difflineminus">-  module.gMockExtProtSvcReg = gMockExtProtSvcReg;</span>
<a href="#l175.113"></a><span id="l175.113" class="difflineminus">-  module.gMockExtProtSvc = gMockExtProtSvc;</span>
<a href="#l175.114"></a><span id="l175.114" class="difflineminus">-}</span>
<a href="#l175.115"></a><span id="l175.115" class="difflineplus">+var gMockExtProtSvcReg = new MockObjectReplacer(</span>
<a href="#l175.116"></a><span id="l175.116" class="difflineplus">+  EXT_PROTOCOL_SVC_CID,</span>
<a href="#l175.117"></a><span id="l175.117" class="difflineplus">+  MockExtProtConstructor</span>
<a href="#l175.118"></a><span id="l175.118" class="difflineplus">+);</span>
<a href="#l175.119"></a><span id="l175.119"> </span>
<a href="#l175.120"></a><span id="l175.120"> /**</span>
<a href="#l175.121"></a><span id="l175.121">  * gMockExtProtocolSvc allows us to capture (most if not all) attempts to</span>
<a href="#l175.122"></a><span id="l175.122">  * open links in the default browser.</span>
<a href="#l175.123"></a><span id="l175.123">  */</span>
<a href="#l175.124"></a><span id="l175.124"> var gMockExtProtSvc = {</span>
<a href="#l175.125"></a><span id="l175.125">   _loadedURLs: [],</span>
<a href="#l175.126"></a><span id="l175.126">   QueryInterface: ChromeUtils.generateQI([Ci.nsIExternalProtocolService]),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l176.1"></a><span id="l176.1">rename from mail/test/mozmill/shared-modules/test-customization-helpers.js</span>
<a href="#l176.2"></a><span id="l176.2">rename to mail/test/mozmill/shared-modules/CustomizationHelpers.jsm</span>
<a href="#l176.3"></a><span id="l176.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-customization-helpers.js</span>
<a href="#l176.4"></a><span id="l176.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/CustomizationHelpers.jsm</span>
<a href="#l176.5"></a><span id="l176.5" class="difflineat">@@ -1,41 +1,30 @@</span>
<a href="#l176.6"></a><span id="l176.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l176.7"></a><span id="l176.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l176.8"></a><span id="l176.8">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l176.9"></a><span id="l176.9"> </span>
<a href="#l176.10"></a><span id="l176.10"> &quot;use strict&quot;;</span>
<a href="#l176.11"></a><span id="l176.11"> </span>
<a href="#l176.12"></a><span id="l176.12" class="difflineminus">-var MODULE_NAME = &quot;customization-helpers&quot;;</span>
<a href="#l176.13"></a><span id="l176.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l176.14"></a><span id="l176.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l176.15"></a><span id="l176.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [&quot;CustomizeDialogHelper&quot;];</span>
<a href="#l176.16"></a><span id="l176.16"> </span>
<a href="#l176.17"></a><span id="l176.17" class="difflineminus">-var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l176.18"></a><span id="l176.18"> var elib = ChromeUtils.import(</span>
<a href="#l176.19"></a><span id="l176.19">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l176.20"></a><span id="l176.20"> );</span>
<a href="#l176.21"></a><span id="l176.21"> </span>
<a href="#l176.22"></a><span id="l176.22" class="difflineplus">+var fdh = ChromeUtils.import(</span>
<a href="#l176.23"></a><span id="l176.23" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l176.24"></a><span id="l176.24" class="difflineplus">+);</span>
<a href="#l176.25"></a><span id="l176.25"> var wh = ChromeUtils.import(</span>
<a href="#l176.26"></a><span id="l176.26">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l176.27"></a><span id="l176.27"> );</span>
<a href="#l176.28"></a><span id="l176.28"> </span>
<a href="#l176.29"></a><span id="l176.29" class="difflineminus">-var USE_SHEET_PREF = &quot;toolbar.customization.usesheet&quot;;</span>
<a href="#l176.30"></a><span id="l176.30" class="difflineminus">-</span>
<a href="#l176.31"></a><span id="l176.31" class="difflineminus">-var fdh;</span>
<a href="#l176.32"></a><span id="l176.32" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l176.33"></a><span id="l176.33"> </span>
<a href="#l176.34"></a><span id="l176.34" class="difflineminus">-function setupModule() {</span>
<a href="#l176.35"></a><span id="l176.35" class="difflineminus">-  fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l176.36"></a><span id="l176.36" class="difflineminus">-}</span>
<a href="#l176.37"></a><span id="l176.37" class="difflineminus">-</span>
<a href="#l176.38"></a><span id="l176.38" class="difflineminus">-function installInto(module) {</span>
<a href="#l176.39"></a><span id="l176.39" class="difflineminus">-  setupModule();</span>
<a href="#l176.40"></a><span id="l176.40" class="difflineminus">-</span>
<a href="#l176.41"></a><span id="l176.41" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l176.42"></a><span id="l176.42" class="difflineminus">-  module.CustomizeDialogHelper = CustomizeDialogHelper;</span>
<a href="#l176.43"></a><span id="l176.43" class="difflineminus">-}</span>
<a href="#l176.44"></a><span id="l176.44" class="difflineplus">+var USE_SHEET_PREF = &quot;toolbar.customization.usesheet&quot;;</span>
<a href="#l176.45"></a><span id="l176.45"> </span>
<a href="#l176.46"></a><span id="l176.46"> /**</span>
<a href="#l176.47"></a><span id="l176.47">  * Initialize the help for a customization dialog</span>
<a href="#l176.48"></a><span id="l176.48">  * @param {} aToolbarId</span>
<a href="#l176.49"></a><span id="l176.49">  *   the ID of the toolbar to be customized</span>
<a href="#l176.50"></a><span id="l176.50">  * @param {} aOpenElementId</span>
<a href="#l176.51"></a><span id="l176.51">  *   the ID of the element to be clicked on to open the dialog</span>
<a href="#l176.52"></a><span id="l176.52">  * @param {} aWindowType</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l177.1"></a><span id="l177.1">rename from mail/test/mozmill/shared-modules/test-dom-helpers.js</span>
<a href="#l177.2"></a><span id="l177.2">rename to mail/test/mozmill/shared-modules/DOMHelpers.jsm</span>
<a href="#l177.3"></a><span id="l177.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-dom-helpers.js</span>
<a href="#l177.4"></a><span id="l177.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/DOMHelpers.jsm</span>
<a href="#l177.5"></a><span id="l177.5" class="difflineat">@@ -1,54 +1,32 @@</span>
<a href="#l177.6"></a><span id="l177.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l177.7"></a><span id="l177.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l177.8"></a><span id="l177.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l177.9"></a><span id="l177.9"> </span>
<a href="#l177.10"></a><span id="l177.10"> &quot;use strict&quot;;</span>
<a href="#l177.11"></a><span id="l177.11"> </span>
<a href="#l177.12"></a><span id="l177.12" class="difflineminus">-var MODULE_NAME = &quot;dom-helpers&quot;;</span>
<a href="#l177.13"></a><span id="l177.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l177.14"></a><span id="l177.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l177.15"></a><span id="l177.15" class="difflineminus">-</span>
<a href="#l177.16"></a><span id="l177.16" class="difflineminus">-var elib = ChromeUtils.import(</span>
<a href="#l177.17"></a><span id="l177.17" class="difflineminus">-  &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l177.18"></a><span id="l177.18" class="difflineminus">-);</span>
<a href="#l177.19"></a><span id="l177.19" class="difflineminus">-</span>
<a href="#l177.20"></a><span id="l177.20" class="difflineminus">-var NORMAL_TIMEOUT = 6000;</span>
<a href="#l177.21"></a><span id="l177.21" class="difflineminus">-var FAST_TIMEOUT = 1000;</span>
<a href="#l177.22"></a><span id="l177.22" class="difflineminus">-var FAST_INTERVAL = 100;</span>
<a href="#l177.23"></a><span id="l177.23" class="difflineminus">-</span>
<a href="#l177.24"></a><span id="l177.24" class="difflineminus">-var folderDisplayHelper;</span>
<a href="#l177.25"></a><span id="l177.25" class="difflineminus">-var mc;</span>
<a href="#l177.26"></a><span id="l177.26" class="difflineminus">-</span>
<a href="#l177.27"></a><span id="l177.27" class="difflineminus">-// logHelper (and therefore folderDisplayHelper) exports</span>
<a href="#l177.28"></a><span id="l177.28" class="difflineminus">-var mark_failure;</span>
<a href="#l177.29"></a><span id="l177.29" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l177.30"></a><span id="l177.30" class="difflineplus">+  &quot;assert_element_visible&quot;,</span>
<a href="#l177.31"></a><span id="l177.31" class="difflineplus">+  &quot;element_visible_recursive&quot;,</span>
<a href="#l177.32"></a><span id="l177.32" class="difflineplus">+  &quot;assert_element_not_visible&quot;,</span>
<a href="#l177.33"></a><span id="l177.33" class="difflineplus">+  &quot;wait_for_element&quot;,</span>
<a href="#l177.34"></a><span id="l177.34" class="difflineplus">+  &quot;assert_next_nodes&quot;,</span>
<a href="#l177.35"></a><span id="l177.35" class="difflineplus">+  &quot;assert_previous_nodes&quot;,</span>
<a href="#l177.36"></a><span id="l177.36" class="difflineplus">+  &quot;wait_for_element_enabled&quot;,</span>
<a href="#l177.37"></a><span id="l177.37" class="difflineplus">+  &quot;check_element_visible&quot;,</span>
<a href="#l177.38"></a><span id="l177.38" class="difflineplus">+  &quot;wait_for_element_visible&quot;,</span>
<a href="#l177.39"></a><span id="l177.39" class="difflineplus">+  &quot;wait_for_element_invisible&quot;,</span>
<a href="#l177.40"></a><span id="l177.40" class="difflineplus">+  &quot;collapse_panes&quot;,</span>
<a href="#l177.41"></a><span id="l177.41" class="difflineplus">+];</span>
<a href="#l177.42"></a><span id="l177.42"> </span>
<a href="#l177.43"></a><span id="l177.43" class="difflineminus">-function setupModule() {</span>
<a href="#l177.44"></a><span id="l177.44" class="difflineminus">-  folderDisplayHelper = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l177.45"></a><span id="l177.45" class="difflineminus">-  mc = folderDisplayHelper.mc;</span>
<a href="#l177.46"></a><span id="l177.46" class="difflineminus">-  mark_failure = folderDisplayHelper.mark_failure;</span>
<a href="#l177.47"></a><span id="l177.47" class="difflineminus">-}</span>
<a href="#l177.48"></a><span id="l177.48" class="difflineminus">-</span>
<a href="#l177.49"></a><span id="l177.49" class="difflineminus">-function installInto(module) {</span>
<a href="#l177.50"></a><span id="l177.50" class="difflineminus">-  setupModule();</span>
<a href="#l177.51"></a><span id="l177.51" class="difflineminus">-</span>
<a href="#l177.52"></a><span id="l177.52" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l177.53"></a><span id="l177.53" class="difflineminus">-  module.assert_element_visible = assert_element_visible;</span>
<a href="#l177.54"></a><span id="l177.54" class="difflineminus">-  module.element_visible_recursive = element_visible_recursive;</span>
<a href="#l177.55"></a><span id="l177.55" class="difflineminus">-  module.assert_element_not_visible = assert_element_not_visible;</span>
<a href="#l177.56"></a><span id="l177.56" class="difflineminus">-  module.wait_for_element = wait_for_element;</span>
<a href="#l177.57"></a><span id="l177.57" class="difflineminus">-  module.assert_next_nodes = assert_next_nodes;</span>
<a href="#l177.58"></a><span id="l177.58" class="difflineminus">-  module.assert_previous_nodes = assert_previous_nodes;</span>
<a href="#l177.59"></a><span id="l177.59" class="difflineminus">-  module.wait_for_element_enabled = wait_for_element_enabled;</span>
<a href="#l177.60"></a><span id="l177.60" class="difflineminus">-  module.check_element_visible = check_element_visible;</span>
<a href="#l177.61"></a><span id="l177.61" class="difflineminus">-  module.wait_for_element_visible = wait_for_element_visible;</span>
<a href="#l177.62"></a><span id="l177.62" class="difflineminus">-  module.wait_for_element_invisible = wait_for_element_invisible;</span>
<a href="#l177.63"></a><span id="l177.63" class="difflineminus">-  module.collapse_panes = collapse_panes;</span>
<a href="#l177.64"></a><span id="l177.64" class="difflineminus">-}</span>
<a href="#l177.65"></a><span id="l177.65" class="difflineplus">+var folderDisplayHelper = ChromeUtils.import(</span>
<a href="#l177.66"></a><span id="l177.66" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l177.67"></a><span id="l177.67" class="difflineplus">+);</span>
<a href="#l177.68"></a><span id="l177.68" class="difflineplus">+var mc = folderDisplayHelper.mc;</span>
<a href="#l177.69"></a><span id="l177.69"> </span>
<a href="#l177.70"></a><span id="l177.70"> /**</span>
<a href="#l177.71"></a><span id="l177.71">  * This function takes either a string or an elementlibs.Elem, and returns</span>
<a href="#l177.72"></a><span id="l177.72">  * whether it is hidden or not (simply by poking at its hidden property). It</span>
<a href="#l177.73"></a><span id="l177.73">  * doesn't try to do anything smart, like is it not into view, or whatever.</span>
<a href="#l177.74"></a><span id="l177.74">  *</span>
<a href="#l177.75"></a><span id="l177.75">  * @param aElt The element to query.</span>
<a href="#l177.76"></a><span id="l177.76">  * @return Whether the element is visible or not.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l178.1"></a><span id="l178.1">rename from mail/test/mozmill/shared-modules/test-folder-display-helpers.js</span>
<a href="#l178.2"></a><span id="l178.2">rename to mail/test/mozmill/shared-modules/FolderDisplayHelpers.jsm</span>
<a href="#l178.3"></a><span id="l178.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-folder-display-helpers.js</span>
<a href="#l178.4"></a><span id="l178.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/FolderDisplayHelpers.jsm</span>
<a href="#l178.5"></a><span id="l178.5" class="difflineat">@@ -1,16 +1,165 @@</span>
<a href="#l178.6"></a><span id="l178.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l178.7"></a><span id="l178.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l178.8"></a><span id="l178.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l178.9"></a><span id="l178.9"> </span>
<a href="#l178.10"></a><span id="l178.10"> &quot;use strict&quot;;</span>
<a href="#l178.11"></a><span id="l178.11"> </span>
<a href="#l178.12"></a><span id="l178.12" class="difflineminus">-var MODULE_NAME = &quot;folder-display-helpers&quot;;</span>
<a href="#l178.13"></a><span id="l178.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l178.14"></a><span id="l178.14" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l178.15"></a><span id="l178.15" class="difflineplus">+  &quot;add_message_to_folder&quot;,</span>
<a href="#l178.16"></a><span id="l178.16" class="difflineplus">+  &quot;add_sets_to_folders&quot;,</span>
<a href="#l178.17"></a><span id="l178.17" class="difflineplus">+  &quot;add_to_toolbar&quot;,</span>
<a href="#l178.18"></a><span id="l178.18" class="difflineplus">+  &quot;archive_messages&quot;,</span>
<a href="#l178.19"></a><span id="l178.19" class="difflineplus">+  &quot;archive_selected_messages&quot;,</span>
<a href="#l178.20"></a><span id="l178.20" class="difflineplus">+  &quot;assert_attachment_list_focused&quot;,</span>
<a href="#l178.21"></a><span id="l178.21" class="difflineplus">+  &quot;assert_collapsed&quot;,</span>
<a href="#l178.22"></a><span id="l178.22" class="difflineplus">+  &quot;assert_default_window_size&quot;,</span>
<a href="#l178.23"></a><span id="l178.23" class="difflineplus">+  &quot;assert_displayed&quot;,</span>
<a href="#l178.24"></a><span id="l178.24" class="difflineplus">+  &quot;assert_equals&quot;,</span>
<a href="#l178.25"></a><span id="l178.25" class="difflineplus">+  &quot;assert_expanded&quot;,</span>
<a href="#l178.26"></a><span id="l178.26" class="difflineplus">+  &quot;assert_false&quot;,</span>
<a href="#l178.27"></a><span id="l178.27" class="difflineplus">+  &quot;assert_folder_at_index_as&quot;,</span>
<a href="#l178.28"></a><span id="l178.28" class="difflineplus">+  &quot;assert_folder_child_in_view&quot;,</span>
<a href="#l178.29"></a><span id="l178.29" class="difflineplus">+  &quot;assert_folder_collapsed&quot;,</span>
<a href="#l178.30"></a><span id="l178.30" class="difflineplus">+  &quot;assert_folder_displayed&quot;,</span>
<a href="#l178.31"></a><span id="l178.31" class="difflineplus">+  &quot;assert_folder_expanded&quot;,</span>
<a href="#l178.32"></a><span id="l178.32" class="difflineplus">+  &quot;assert_folder_mode&quot;,</span>
<a href="#l178.33"></a><span id="l178.33" class="difflineplus">+  &quot;assert_folder_not_visible&quot;,</span>
<a href="#l178.34"></a><span id="l178.34" class="difflineplus">+  &quot;assert_folder_selected&quot;,</span>
<a href="#l178.35"></a><span id="l178.35" class="difflineplus">+  &quot;assert_folder_selected_and_displayed&quot;,</span>
<a href="#l178.36"></a><span id="l178.36" class="difflineplus">+  &quot;assert_folder_tree_focused&quot;,</span>
<a href="#l178.37"></a><span id="l178.37" class="difflineplus">+  &quot;assert_folder_tree_view_row_count&quot;,</span>
<a href="#l178.38"></a><span id="l178.38" class="difflineplus">+  &quot;assert_folder_visible&quot;,</span>
<a href="#l178.39"></a><span id="l178.39" class="difflineplus">+  &quot;assert_folders_selected&quot;,</span>
<a href="#l178.40"></a><span id="l178.40" class="difflineplus">+  &quot;assert_folders_selected_and_displayed&quot;,</span>
<a href="#l178.41"></a><span id="l178.41" class="difflineplus">+  &quot;assert_mail_view&quot;,</span>
<a href="#l178.42"></a><span id="l178.42" class="difflineplus">+  &quot;assert_message_not_in_view&quot;,</span>
<a href="#l178.43"></a><span id="l178.43" class="difflineplus">+  &quot;assert_message_pane_focused&quot;,</span>
<a href="#l178.44"></a><span id="l178.44" class="difflineplus">+  &quot;assert_message_pane_hidden&quot;,</span>
<a href="#l178.45"></a><span id="l178.45" class="difflineplus">+  &quot;assert_message_pane_visible&quot;,</span>
<a href="#l178.46"></a><span id="l178.46" class="difflineplus">+  &quot;assert_messages_in_view&quot;,</span>
<a href="#l178.47"></a><span id="l178.47" class="difflineplus">+  &quot;assert_messages_not_in_view&quot;,</span>
<a href="#l178.48"></a><span id="l178.48" class="difflineplus">+  &quot;assert_messages_summarized&quot;,</span>
<a href="#l178.49"></a><span id="l178.49" class="difflineplus">+  &quot;assert_multimessage_pane_focused&quot;,</span>
<a href="#l178.50"></a><span id="l178.50" class="difflineplus">+  &quot;assert_no_folders_selected&quot;,</span>
<a href="#l178.51"></a><span id="l178.51" class="difflineplus">+  &quot;assert_not_equals&quot;,</span>
<a href="#l178.52"></a><span id="l178.52" class="difflineplus">+  &quot;assert_not_selected_tab&quot;,</span>
<a href="#l178.53"></a><span id="l178.53" class="difflineplus">+  &quot;assert_not_showing_unread_only&quot;,</span>
<a href="#l178.54"></a><span id="l178.54" class="difflineplus">+  &quot;assert_not_shown&quot;,</span>
<a href="#l178.55"></a><span id="l178.55" class="difflineplus">+  &quot;assert_nothing_selected&quot;,</span>
<a href="#l178.56"></a><span id="l178.56" class="difflineplus">+  &quot;assert_number_of_tabs_open&quot;,</span>
<a href="#l178.57"></a><span id="l178.57" class="difflineplus">+  &quot;assert_pane_layout&quot;,</span>
<a href="#l178.58"></a><span id="l178.58" class="difflineplus">+  &quot;assert_row_visible&quot;,</span>
<a href="#l178.59"></a><span id="l178.59" class="difflineplus">+  &quot;assert_selected&quot;,</span>
<a href="#l178.60"></a><span id="l178.60" class="difflineplus">+  &quot;assert_selected_and_displayed&quot;,</span>
<a href="#l178.61"></a><span id="l178.61" class="difflineplus">+  &quot;assert_selected_tab&quot;,</span>
<a href="#l178.62"></a><span id="l178.62" class="difflineplus">+  &quot;assert_showing_unread_only&quot;,</span>
<a href="#l178.63"></a><span id="l178.63" class="difflineplus">+  &quot;assert_summary_contains_N_elts&quot;,</span>
<a href="#l178.64"></a><span id="l178.64" class="difflineplus">+  &quot;assert_tab_has_title&quot;,</span>
<a href="#l178.65"></a><span id="l178.65" class="difflineplus">+  &quot;assert_tab_mode_name&quot;,</span>
<a href="#l178.66"></a><span id="l178.66" class="difflineplus">+  &quot;assert_tab_titled_from&quot;,</span>
<a href="#l178.67"></a><span id="l178.67" class="difflineplus">+  &quot;assert_thread_tree_focused&quot;,</span>
<a href="#l178.68"></a><span id="l178.68" class="difflineplus">+  &quot;assert_true&quot;,</span>
<a href="#l178.69"></a><span id="l178.69" class="difflineplus">+  &quot;assert_visible&quot;,</span>
<a href="#l178.70"></a><span id="l178.70" class="difflineplus">+  &quot;be_in_folder&quot;,</span>
<a href="#l178.71"></a><span id="l178.71" class="difflineplus">+  &quot;click_tree_row&quot;,</span>
<a href="#l178.72"></a><span id="l178.72" class="difflineplus">+  &quot;close_message_window&quot;,</span>
<a href="#l178.73"></a><span id="l178.73" class="difflineplus">+  &quot;close_popup&quot;,</span>
<a href="#l178.74"></a><span id="l178.74" class="difflineplus">+  &quot;close_tab&quot;,</span>
<a href="#l178.75"></a><span id="l178.75" class="difflineplus">+  &quot;collapse_all_threads&quot;,</span>
<a href="#l178.76"></a><span id="l178.76" class="difflineplus">+  &quot;collapse_folder&quot;,</span>
<a href="#l178.77"></a><span id="l178.77" class="difflineplus">+  &quot;create_encrypted_smime_message&quot;,</span>
<a href="#l178.78"></a><span id="l178.78" class="difflineplus">+  &quot;create_folder&quot;,</span>
<a href="#l178.79"></a><span id="l178.79" class="difflineplus">+  &quot;create_message&quot;,</span>
<a href="#l178.80"></a><span id="l178.80" class="difflineplus">+  &quot;create_thread&quot;,</span>
<a href="#l178.81"></a><span id="l178.81" class="difflineplus">+  &quot;create_virtual_folder&quot;,</span>
<a href="#l178.82"></a><span id="l178.82" class="difflineplus">+  &quot;delete_message_set&quot;,</span>
<a href="#l178.83"></a><span id="l178.83" class="difflineplus">+  &quot;delete_via_popup&quot;,</span>
<a href="#l178.84"></a><span id="l178.84" class="difflineplus">+  &quot;display_message_in_folder_tab&quot;,</span>
<a href="#l178.85"></a><span id="l178.85" class="difflineplus">+  &quot;empty_folder&quot;,</span>
<a href="#l178.86"></a><span id="l178.86" class="difflineplus">+  &quot;enter_folder&quot;,</span>
<a href="#l178.87"></a><span id="l178.87" class="difflineplus">+  &quot;expand_all_threads&quot;,</span>
<a href="#l178.88"></a><span id="l178.88" class="difflineplus">+  &quot;expand_folder&quot;,</span>
<a href="#l178.89"></a><span id="l178.89" class="difflineplus">+  &quot;FAKE_SERVER_HOSTNAME&quot;,</span>
<a href="#l178.90"></a><span id="l178.90" class="difflineplus">+  &quot;focus_folder_tree&quot;,</span>
<a href="#l178.91"></a><span id="l178.91" class="difflineplus">+  &quot;focus_message_pane&quot;,</span>
<a href="#l178.92"></a><span id="l178.92" class="difflineplus">+  &quot;focus_multimessage_pane&quot;,</span>
<a href="#l178.93"></a><span id="l178.93" class="difflineplus">+  &quot;focus_thread_tree&quot;,</span>
<a href="#l178.94"></a><span id="l178.94" class="difflineplus">+  &quot;gDefaultWindowHeight&quot;,</span>
<a href="#l178.95"></a><span id="l178.95" class="difflineplus">+  &quot;gDefaultWindowWidth&quot;,</span>
<a href="#l178.96"></a><span id="l178.96" class="difflineplus">+  &quot;get_smart_folder_named&quot;,</span>
<a href="#l178.97"></a><span id="l178.97" class="difflineplus">+  &quot;get_special_folder&quot;,</span>
<a href="#l178.98"></a><span id="l178.98" class="difflineplus">+  &quot;inboxFolder&quot;,</span>
<a href="#l178.99"></a><span id="l178.99" class="difflineplus">+  &quot;kClassicMailLayout&quot;,</span>
<a href="#l178.100"></a><span id="l178.100" class="difflineplus">+  &quot;kVerticalMailLayout&quot;,</span>
<a href="#l178.101"></a><span id="l178.101" class="difflineplus">+  &quot;kWideMailLayout&quot;,</span>
<a href="#l178.102"></a><span id="l178.102" class="difflineplus">+  &quot;load_via_src_path&quot;,</span>
<a href="#l178.103"></a><span id="l178.103" class="difflineplus">+  &quot;make_display_grouped&quot;,</span>
<a href="#l178.104"></a><span id="l178.104" class="difflineplus">+  &quot;make_display_threaded&quot;,</span>
<a href="#l178.105"></a><span id="l178.105" class="difflineplus">+  &quot;make_display_unthreaded&quot;,</span>
<a href="#l178.106"></a><span id="l178.106" class="difflineplus">+  &quot;make_folder_with_sets&quot;,</span>
<a href="#l178.107"></a><span id="l178.107" class="difflineplus">+  &quot;make_new_sets_in_folder&quot;,</span>
<a href="#l178.108"></a><span id="l178.108" class="difflineplus">+  &quot;make_new_sets_in_folders&quot;,</span>
<a href="#l178.109"></a><span id="l178.109" class="difflineplus">+  &quot;make_virtual_folder&quot;,</span>
<a href="#l178.110"></a><span id="l178.110" class="difflineplus">+  &quot;mark_action&quot;,</span>
<a href="#l178.111"></a><span id="l178.111" class="difflineplus">+  &quot;mc&quot;,</span>
<a href="#l178.112"></a><span id="l178.112" class="difflineplus">+  &quot;middle_click_on_folder&quot;,</span>
<a href="#l178.113"></a><span id="l178.113" class="difflineplus">+  &quot;middle_click_on_row&quot;,</span>
<a href="#l178.114"></a><span id="l178.114" class="difflineplus">+  &quot;msgGen&quot;,</span>
<a href="#l178.115"></a><span id="l178.115" class="difflineplus">+  &quot;open_folder_in_new_tab&quot;,</span>
<a href="#l178.116"></a><span id="l178.116" class="difflineplus">+  &quot;open_folder_in_new_window&quot;,</span>
<a href="#l178.117"></a><span id="l178.117" class="difflineplus">+  &quot;open_message_from_file&quot;,</span>
<a href="#l178.118"></a><span id="l178.118" class="difflineplus">+  &quot;open_selected_message&quot;,</span>
<a href="#l178.119"></a><span id="l178.119" class="difflineplus">+  &quot;open_selected_message_in_new_tab&quot;,</span>
<a href="#l178.120"></a><span id="l178.120" class="difflineplus">+  &quot;open_selected_message_in_new_window&quot;,</span>
<a href="#l178.121"></a><span id="l178.121" class="difflineplus">+  &quot;open_selected_messages&quot;,</span>
<a href="#l178.122"></a><span id="l178.122" class="difflineplus">+  &quot;plan_for_message_display&quot;,</span>
<a href="#l178.123"></a><span id="l178.123" class="difflineplus">+  &quot;plan_to_wait_for_folder_events&quot;,</span>
<a href="#l178.124"></a><span id="l178.124" class="difflineplus">+  &quot;press_delete&quot;,</span>
<a href="#l178.125"></a><span id="l178.125" class="difflineplus">+  &quot;press_enter&quot;,</span>
<a href="#l178.126"></a><span id="l178.126" class="difflineplus">+  &quot;remove_from_toolbar&quot;,</span>
<a href="#l178.127"></a><span id="l178.127" class="difflineplus">+  &quot;reset_close_message_on_delete&quot;,</span>
<a href="#l178.128"></a><span id="l178.128" class="difflineplus">+  &quot;reset_context_menu_background_tabs&quot;,</span>
<a href="#l178.129"></a><span id="l178.129" class="difflineplus">+  &quot;reset_open_message_behavior&quot;,</span>
<a href="#l178.130"></a><span id="l178.130" class="difflineplus">+  &quot;restore_default_window_size&quot;,</span>
<a href="#l178.131"></a><span id="l178.131" class="difflineplus">+  &quot;right_click_on_folder&quot;,</span>
<a href="#l178.132"></a><span id="l178.132" class="difflineplus">+  &quot;right_click_on_row&quot;,</span>
<a href="#l178.133"></a><span id="l178.133" class="difflineplus">+  &quot;select_click_folder&quot;,</span>
<a href="#l178.134"></a><span id="l178.134" class="difflineplus">+  &quot;select_click_row&quot;,</span>
<a href="#l178.135"></a><span id="l178.135" class="difflineplus">+  &quot;select_column_click_row&quot;,</span>
<a href="#l178.136"></a><span id="l178.136" class="difflineplus">+  &quot;select_control_click_row&quot;,</span>
<a href="#l178.137"></a><span id="l178.137" class="difflineplus">+  &quot;select_no_folders&quot;,</span>
<a href="#l178.138"></a><span id="l178.138" class="difflineplus">+  &quot;select_none&quot;,</span>
<a href="#l178.139"></a><span id="l178.139" class="difflineplus">+  &quot;select_shift_click_folder&quot;,</span>
<a href="#l178.140"></a><span id="l178.140" class="difflineplus">+  &quot;select_shift_click_row&quot;,</span>
<a href="#l178.141"></a><span id="l178.141" class="difflineplus">+  &quot;set_close_message_on_delete&quot;,</span>
<a href="#l178.142"></a><span id="l178.142" class="difflineplus">+  &quot;set_context_menu_background_tabs&quot;,</span>
<a href="#l178.143"></a><span id="l178.143" class="difflineplus">+  &quot;set_mail_view&quot;,</span>
<a href="#l178.144"></a><span id="l178.144" class="difflineplus">+  &quot;set_mc&quot;,</span>
<a href="#l178.145"></a><span id="l178.145" class="difflineplus">+  &quot;set_open_message_behavior&quot;,</span>
<a href="#l178.146"></a><span id="l178.146" class="difflineplus">+  &quot;set_pane_layout&quot;,</span>
<a href="#l178.147"></a><span id="l178.147" class="difflineplus">+  &quot;set_show_unread_only&quot;,</span>
<a href="#l178.148"></a><span id="l178.148" class="difflineplus">+  &quot;smimeUtils_ensureNSS&quot;,</span>
<a href="#l178.149"></a><span id="l178.149" class="difflineplus">+  &quot;smimeUtils_loadCertificateAndKey&quot;,</span>
<a href="#l178.150"></a><span id="l178.150" class="difflineplus">+  &quot;smimeUtils_loadPEMCertificate&quot;,</span>
<a href="#l178.151"></a><span id="l178.151" class="difflineplus">+  &quot;switch_tab&quot;,</span>
<a href="#l178.152"></a><span id="l178.152" class="difflineplus">+  &quot;SyntheticPartLeaf&quot;,</span>
<a href="#l178.153"></a><span id="l178.153" class="difflineplus">+  &quot;SyntheticPartMultiMixed&quot;,</span>
<a href="#l178.154"></a><span id="l178.154" class="difflineplus">+  &quot;SyntheticPartMultiRelated&quot;,</span>
<a href="#l178.155"></a><span id="l178.155" class="difflineplus">+  &quot;throw_and_dump_view_state&quot;,</span>
<a href="#l178.156"></a><span id="l178.156" class="difflineplus">+  &quot;toggle_main_menu&quot;,</span>
<a href="#l178.157"></a><span id="l178.157" class="difflineplus">+  &quot;toggle_message_pane&quot;,</span>
<a href="#l178.158"></a><span id="l178.158" class="difflineplus">+  &quot;toggle_thread_row&quot;,</span>
<a href="#l178.159"></a><span id="l178.159" class="difflineplus">+  &quot;wait_for_all_messages_to_load&quot;,</span>
<a href="#l178.160"></a><span id="l178.160" class="difflineplus">+  &quot;wait_for_blank_content_pane&quot;,</span>
<a href="#l178.161"></a><span id="l178.161" class="difflineplus">+  &quot;wait_for_folder_events&quot;,</span>
<a href="#l178.162"></a><span id="l178.162" class="difflineplus">+  &quot;wait_for_message_display_completion&quot;,</span>
<a href="#l178.163"></a><span id="l178.163" class="difflineplus">+  &quot;wait_for_popup_to_open&quot;,</span>
<a href="#l178.164"></a><span id="l178.164" class="difflineplus">+];</span>
<a href="#l178.165"></a><span id="l178.165"> </span>
<a href="#l178.166"></a><span id="l178.166"> var EventUtils = ChromeUtils.import(</span>
<a href="#l178.167"></a><span id="l178.167">   &quot;chrome://mozmill/content/stdlib/EventUtils.jsm&quot;</span>
<a href="#l178.168"></a><span id="l178.168"> );</span>
<a href="#l178.169"></a><span id="l178.169"> var controller = ChromeUtils.import(</span>
<a href="#l178.170"></a><span id="l178.170">   &quot;chrome://mozmill/content/modules/controller.jsm&quot;</span>
<a href="#l178.171"></a><span id="l178.171"> );</span>
<a href="#l178.172"></a><span id="l178.172"> var frame = ChromeUtils.import(&quot;chrome://mozmill/content/modules/frame.jsm&quot;);</span>
<a href="#l178.173"></a><span id="l178.173" class="difflineat">@@ -25,72 +174,31 @@ var windowHelper = ChromeUtils.import(</span>
<a href="#l178.174"></a><span id="l178.174"> var { Log4Moz } = ChromeUtils.import(&quot;resource:///modules/gloda/log4moz.js&quot;);</span>
<a href="#l178.175"></a><span id="l178.175"> </span>
<a href="#l178.176"></a><span id="l178.176"> var nsMsgViewIndex_None = 0xffffffff;</span>
<a href="#l178.177"></a><span id="l178.177"> var { MailConsts } = ChromeUtils.import(&quot;resource:///modules/MailConsts.jsm&quot;);</span>
<a href="#l178.178"></a><span id="l178.178"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l178.179"></a><span id="l178.179">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l178.180"></a><span id="l178.180"> );</span>
<a href="#l178.181"></a><span id="l178.181"> var { MailUtils } = ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l178.182"></a><span id="l178.182" class="difflineminus">-var { MailViewManager, MailViewConstants } = ChromeUtils.import(</span>
<a href="#l178.183"></a><span id="l178.183" class="difflineminus">-  &quot;resource:///modules/MailViewManager.jsm&quot;</span>
<a href="#l178.184"></a><span id="l178.184" class="difflineminus">-);</span>
<a href="#l178.185"></a><span id="l178.185"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l178.186"></a><span id="l178.186"> </span>
<a href="#l178.187"></a><span id="l178.187" class="difflineminus">-var FILE_LOAD_PATHS = [</span>
<a href="#l178.188"></a><span id="l178.188" class="difflineminus">-  &quot;../&quot;,</span>
<a href="#l178.189"></a><span id="l178.189" class="difflineminus">-  &quot;../../&quot;,</span>
<a href="#l178.190"></a><span id="l178.190" class="difflineminus">-  &quot;../../../../mailnews/test/&quot;,</span>
<a href="#l178.191"></a><span id="l178.191" class="difflineminus">-  &quot;../../../../mail/base/test/unit/&quot;,</span>
<a href="#l178.192"></a><span id="l178.192" class="difflineminus">-];</span>
<a href="#l178.193"></a><span id="l178.193" class="difflineplus">+var FILE_LOAD_PATHS = [&quot;../../mozmill/&quot;];</span>
<a href="#l178.194"></a><span id="l178.194"> </span>
<a href="#l178.195"></a><span id="l178.195"> /**</span>
<a href="#l178.196"></a><span id="l178.196">  * Server hostname as set in runtest.py</span>
<a href="#l178.197"></a><span id="l178.197">  */</span>
<a href="#l178.198"></a><span id="l178.198"> var FAKE_SERVER_HOSTNAME = &quot;tinderbox123&quot;;</span>
<a href="#l178.199"></a><span id="l178.199"> </span>
<a href="#l178.200"></a><span id="l178.200" class="difflineminus">-/**</span>
<a href="#l178.201"></a><span id="l178.201" class="difflineminus">- * List of keys not to export via installInto; values do not matter, we just</span>
<a href="#l178.202"></a><span id="l178.202" class="difflineminus">- *  use true.</span>
<a href="#l178.203"></a><span id="l178.203" class="difflineminus">- */</span>
<a href="#l178.204"></a><span id="l178.204" class="difflineminus">-var DO_NOT_EXPORT = {</span>
<a href="#l178.205"></a><span id="l178.205" class="difflineminus">-  // magic globals</span>
<a href="#l178.206"></a><span id="l178.206" class="difflineminus">-  MODULE_NAME: true,</span>
<a href="#l178.207"></a><span id="l178.207" class="difflineminus">-  DO_NOT_EXPORT: true,</span>
<a href="#l178.208"></a><span id="l178.208" class="difflineminus">-  installInto: true,</span>
<a href="#l178.209"></a><span id="l178.209" class="difflineminus">-  // imported modules</span>
<a href="#l178.210"></a><span id="l178.210" class="difflineminus">-  controller: true,</span>
<a href="#l178.211"></a><span id="l178.211" class="difflineminus">-  frame: true,</span>
<a href="#l178.212"></a><span id="l178.212" class="difflineminus">-  os: true,</span>
<a href="#l178.213"></a><span id="l178.213" class="difflineminus">-  // useful constants (we do export MailViewConstants)</span>
<a href="#l178.214"></a><span id="l178.214" class="difflineminus">-  nsMsgViewIndex_None: true,</span>
<a href="#l178.215"></a><span id="l178.215" class="difflineminus">-  MailConsts: true,</span>
<a href="#l178.216"></a><span id="l178.216" class="difflineminus">-  // utility functions</span>
<a href="#l178.217"></a><span id="l178.217" class="difflineminus">-  MailUtils: true,</span>
<a href="#l178.218"></a><span id="l178.218" class="difflineminus">-  MailViewManager: true,</span>
<a href="#l178.219"></a><span id="l178.219" class="difflineminus">-  // internal setup functions</span>
<a href="#l178.220"></a><span id="l178.220" class="difflineminus">-  setupModule: true,</span>
<a href="#l178.221"></a><span id="l178.221" class="difflineminus">-  setupAccountStuff: true,</span>
<a href="#l178.222"></a><span id="l178.222" class="difflineminus">-  // we export this separately</span>
<a href="#l178.223"></a><span id="l178.223" class="difflineminus">-  teardownImporter: true,</span>
<a href="#l178.224"></a><span id="l178.224" class="difflineminus">-  // internal setup flags</span>
<a href="#l178.225"></a><span id="l178.225" class="difflineminus">-  initialized: false,</span>
<a href="#l178.226"></a><span id="l178.226" class="difflineminus">-  // other libraries we use</span>
<a href="#l178.227"></a><span id="l178.227" class="difflineminus">-  testHelperModule: true,</span>
<a href="#l178.228"></a><span id="l178.228" class="difflineminus">-  windowHelper: true,</span>
<a href="#l178.229"></a><span id="l178.229" class="difflineminus">-};</span>
<a href="#l178.230"></a><span id="l178.230" class="difflineminus">-</span>
<a href="#l178.231"></a><span id="l178.231" class="difflineminus">-var EXPORT_VIA_GETTER_SETTER = {</span>
<a href="#l178.232"></a><span id="l178.232" class="difflineminus">-  // These should be getters and setters instead of direct property accesses so</span>
<a href="#l178.233"></a><span id="l178.233" class="difflineminus">-  // that setting them reflects across scopes.</span>
<a href="#l178.234"></a><span id="l178.234" class="difflineminus">-  mc: true,</span>
<a href="#l178.235"></a><span id="l178.235" class="difflineminus">-};</span>
<a href="#l178.236"></a><span id="l178.236" class="difflineminus">-</span>
<a href="#l178.237"></a><span id="l178.237"> /** The controller for the main 3-pane window. */</span>
<a href="#l178.238"></a><span id="l178.238"> var mc;</span>
<a href="#l178.239"></a><span id="l178.239" class="difflineplus">+function set_mc(value) {</span>
<a href="#l178.240"></a><span id="l178.240" class="difflineplus">+  mc = value;</span>
<a href="#l178.241"></a><span id="l178.241" class="difflineplus">+}</span>
<a href="#l178.242"></a><span id="l178.242" class="difflineplus">+</span>
<a href="#l178.243"></a><span id="l178.243"> /** the index of the current 'other' tab */</span>
<a href="#l178.244"></a><span id="l178.244"> var otherTab;</span>
<a href="#l178.245"></a><span id="l178.245"> </span>
<a href="#l178.246"></a><span id="l178.246"> // These are pseudo-modules setup by setupModule:</span>
<a href="#l178.247"></a><span id="l178.247"> var testHelperModule;</span>
<a href="#l178.248"></a><span id="l178.248"> // (end pseudo-modules)</span>
<a href="#l178.249"></a><span id="l178.249"> </span>
<a href="#l178.250"></a><span id="l178.250"> var msgGen;</span>
<a href="#l178.251"></a><span id="l178.251" class="difflineat">@@ -267,158 +375,34 @@ function setupModule() {</span>
<a href="#l178.252"></a><span id="l178.252"> </span>
<a href="#l178.253"></a><span id="l178.253">   setupAccountStuff();</span>
<a href="#l178.254"></a><span id="l178.254">   // This will throw if we've not got the main window set up yet e.g. the</span>
<a href="#l178.255"></a><span id="l178.255">   // account wizard is open on an initial startup type test.</span>
<a href="#l178.256"></a><span id="l178.256">   try {</span>
<a href="#l178.257"></a><span id="l178.257">     mc.folderTreeView.toggleOpenState(1);</span>
<a href="#l178.258"></a><span id="l178.258">   } catch (ex) {}</span>
<a href="#l178.259"></a><span id="l178.259"> }</span>
<a href="#l178.260"></a><span id="l178.260" class="difflineplus">+setupModule();</span>
<a href="#l178.261"></a><span id="l178.261"> </span>
<a href="#l178.262"></a><span id="l178.262"> function smimeUtils_ensureNSS() {</span>
<a href="#l178.263"></a><span id="l178.263">   testHelperModule.SmimeUtils.ensureNSS();</span>
<a href="#l178.264"></a><span id="l178.264"> }</span>
<a href="#l178.265"></a><span id="l178.265"> </span>
<a href="#l178.266"></a><span id="l178.266"> function smimeUtils_loadPEMCertificate(file, certType, loadKey = false) {</span>
<a href="#l178.267"></a><span id="l178.267">   testHelperModule.SmimeUtils.loadPEMCertificate(file, certType, loadKey);</span>
<a href="#l178.268"></a><span id="l178.268"> }</span>
<a href="#l178.269"></a><span id="l178.269"> </span>
<a href="#l178.270"></a><span id="l178.270"> function smimeUtils_loadCertificateAndKey(file) {</span>
<a href="#l178.271"></a><span id="l178.271">   testHelperModule.SmimeUtils.loadCertificateAndKey(file);</span>
<a href="#l178.272"></a><span id="l178.272"> }</span>
<a href="#l178.273"></a><span id="l178.273"> </span>
<a href="#l178.274"></a><span id="l178.274" class="difflineminus">-/**</span>
<a href="#l178.275"></a><span id="l178.275" class="difflineminus">- * Install this module into the provided module.</span>
<a href="#l178.276"></a><span id="l178.276" class="difflineminus">- */</span>
<a href="#l178.277"></a><span id="l178.277" class="difflineminus">-function installInto(module) {</span>
<a href="#l178.278"></a><span id="l178.278" class="difflineminus">-  setupModule();</span>
<a href="#l178.279"></a><span id="l178.279" class="difflineminus">-</span>
<a href="#l178.280"></a><span id="l178.280" class="difflineminus">-  // Force the window to be a nice size we all can love.</span>
<a href="#l178.281"></a><span id="l178.281" class="difflineminus">-  // Note that we can't resize a window larger than the display it lives on!</span>
<a href="#l178.282"></a><span id="l178.282" class="difflineminus">-  // (I think the inner window is actually limited to the display size, so since</span>
<a href="#l178.283"></a><span id="l178.283" class="difflineminus">-  // resizeTo operates on outerWidth/outerHeight, their limit is actually</span>
<a href="#l178.284"></a><span id="l178.284" class="difflineminus">-  // screen size + window border size.)</span>
<a href="#l178.285"></a><span id="l178.285" class="difflineminus">-  if (</span>
<a href="#l178.286"></a><span id="l178.286" class="difflineminus">-    mc.window.outerWidth != gDefaultWindowWidth ||</span>
<a href="#l178.287"></a><span id="l178.287" class="difflineminus">-    mc.window.outerHeight != gDefaultWindowHeight</span>
<a href="#l178.288"></a><span id="l178.288" class="difflineminus">-  ) {</span>
<a href="#l178.289"></a><span id="l178.289" class="difflineminus">-    restore_default_window_size();</span>
<a href="#l178.290"></a><span id="l178.290" class="difflineminus">-  }</span>
<a href="#l178.291"></a><span id="l178.291" class="difflineminus">-</span>
<a href="#l178.292"></a><span id="l178.292" class="difflineminus">-  // now copy everything into the module they provided to us...</span>
<a href="#l178.293"></a><span id="l178.293" class="difflineminus">-  let us = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l178.294"></a><span id="l178.294" class="difflineminus">-  let self = this;</span>
<a href="#l178.295"></a><span id="l178.295" class="difflineminus">-  for (let key in us) {</span>
<a href="#l178.296"></a><span id="l178.296" class="difflineminus">-    let value = us[key];</span>
<a href="#l178.297"></a><span id="l178.297" class="difflineminus">-    if (key in EXPORT_VIA_GETTER_SETTER) {</span>
<a href="#l178.298"></a><span id="l178.298" class="difflineminus">-      // The value of |key| changes between iterations, so it's important to</span>
<a href="#l178.299"></a><span id="l178.299" class="difflineminus">-      // capture the right key in a local variable.</span>
<a href="#l178.300"></a><span id="l178.300" class="difflineminus">-      let thisKey = key;</span>
<a href="#l178.301"></a><span id="l178.301" class="difflineminus">-      module.__defineGetter__(thisKey, () =&gt; self[thisKey]);</span>
<a href="#l178.302"></a><span id="l178.302" class="difflineminus">-      module.__defineSetter__(thisKey, function(aNewValue) {</span>
<a href="#l178.303"></a><span id="l178.303" class="difflineminus">-        self[thisKey] = aNewValue;</span>
<a href="#l178.304"></a><span id="l178.304" class="difflineminus">-      });</span>
<a href="#l178.305"></a><span id="l178.305" class="difflineminus">-    } else if (!(key in DO_NOT_EXPORT) &amp;&amp; key[0] != &quot;_&quot;) {</span>
<a href="#l178.306"></a><span id="l178.306" class="difflineminus">-      module[key] = value;</span>
<a href="#l178.307"></a><span id="l178.307" class="difflineminus">-    }</span>
<a href="#l178.308"></a><span id="l178.308" class="difflineminus">-  }</span>
<a href="#l178.309"></a><span id="l178.309" class="difflineminus">-</span>
<a href="#l178.310"></a><span id="l178.310" class="difflineminus">-  // Export the teardown helper</span>
<a href="#l178.311"></a><span id="l178.311" class="difflineminus">-  let customTeardown = null;</span>
<a href="#l178.312"></a><span id="l178.312" class="difflineminus">-  // Mozmill uses __teardownModule__ to store what it thinks is the</span>
<a href="#l178.313"></a><span id="l178.313" class="difflineminus">-  // teardownModule function. Unfortunately, all this is figured out when the</span>
<a href="#l178.314"></a><span id="l178.314" class="difflineminus">-  // file is loaded, and we're evaluated much too late for that, so overwrite</span>
<a href="#l178.315"></a><span id="l178.315" class="difflineminus">-  // it.</span>
<a href="#l178.316"></a><span id="l178.316" class="difflineminus">-  if (&quot;__teardownModule__&quot; in module) {</span>
<a href="#l178.317"></a><span id="l178.317" class="difflineminus">-    customTeardown = module.__teardownModule__;</span>
<a href="#l178.318"></a><span id="l178.318" class="difflineminus">-  }</span>
<a href="#l178.319"></a><span id="l178.319" class="difflineminus">-  module.__teardownModule__ = teardownImporter(customTeardown);</span>
<a href="#l178.320"></a><span id="l178.320" class="difflineminus">-}</span>
<a href="#l178.321"></a><span id="l178.321" class="difflineminus">-</span>
<a href="#l178.322"></a><span id="l178.322"> function setupAccountStuff() {</span>
<a href="#l178.323"></a><span id="l178.323">   inboxFolder = testHelperModule.configure_message_injection({ mode: &quot;local&quot; });</span>
<a href="#l178.324"></a><span id="l178.324"> }</span>
<a href="#l178.325"></a><span id="l178.325"> </span>
<a href="#l178.326"></a><span id="l178.326" class="difflineminus">-/**</span>
<a href="#l178.327"></a><span id="l178.327" class="difflineminus">- * This returns a function that cleans up state in case any tests have failed,</span>
<a href="#l178.328"></a><span id="l178.328" class="difflineminus">- * so that the chain of failures isn't propagated to the rest of the suite. We</span>
<a href="#l178.329"></a><span id="l178.329" class="difflineminus">- * attempt to guarantee that after the teardown is executed:</span>
<a href="#l178.330"></a><span id="l178.330" class="difflineminus">- * - exactly one 3-pane window is open, and its controller is assigned to |mc|</span>
<a href="#l178.331"></a><span id="l178.331" class="difflineminus">- * - there are no other windows open</span>
<a href="#l178.332"></a><span id="l178.332" class="difflineminus">- * - the 3-pane window has exactly one tab open -- the main 3-pane tab</span>
<a href="#l178.333"></a><span id="l178.333" class="difflineminus">- * - the folder mode is set to All Folders</span>
<a href="#l178.334"></a><span id="l178.334" class="difflineminus">- *</span>
<a href="#l178.335"></a><span id="l178.335" class="difflineminus">- * @param [customTeardown] A custom teardown function, if it's already been</span>
<a href="#l178.336"></a><span id="l178.336" class="difflineminus">- *     defined in a particular module. This will always be executed before any</span>
<a href="#l178.337"></a><span id="l178.337" class="difflineminus">- *     cleanup we perform.</span>
<a href="#l178.338"></a><span id="l178.338" class="difflineminus">- */</span>
<a href="#l178.339"></a><span id="l178.339" class="difflineminus">-function teardownImporter(customTeardown) {</span>
<a href="#l178.340"></a><span id="l178.340" class="difflineminus">-  let teardownModule = function teardownModule() {</span>
<a href="#l178.341"></a><span id="l178.341" class="difflineminus">-    if (customTeardown) {</span>
<a href="#l178.342"></a><span id="l178.342" class="difflineminus">-      customTeardown();</span>
<a href="#l178.343"></a><span id="l178.343" class="difflineminus">-    }</span>
<a href="#l178.344"></a><span id="l178.344" class="difflineminus">-</span>
<a href="#l178.345"></a><span id="l178.345" class="difflineminus">-    // - If there are no 3-pane windows open, open one.</span>
<a href="#l178.346"></a><span id="l178.346" class="difflineminus">-    let mail3PaneWindow = Services.wm.getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l178.347"></a><span id="l178.347" class="difflineminus">-    if (!mail3PaneWindow) {</span>
<a href="#l178.348"></a><span id="l178.348" class="difflineminus">-      windowHelper.plan_for_new_window(&quot;mail:3pane&quot;);</span>
<a href="#l178.349"></a><span id="l178.349" class="difflineminus">-      Services.ww.openWindow(</span>
<a href="#l178.350"></a><span id="l178.350" class="difflineminus">-        null,</span>
<a href="#l178.351"></a><span id="l178.351" class="difflineminus">-        &quot;chrome://messenger/content/&quot;,</span>
<a href="#l178.352"></a><span id="l178.352" class="difflineminus">-        &quot;&quot;,</span>
<a href="#l178.353"></a><span id="l178.353" class="difflineminus">-        &quot;all,chrome,dialog=no,status,toolbar&quot;,</span>
<a href="#l178.354"></a><span id="l178.354" class="difflineminus">-        null</span>
<a href="#l178.355"></a><span id="l178.355" class="difflineminus">-      );</span>
<a href="#l178.356"></a><span id="l178.356" class="difflineminus">-      mc = windowHelper.wait_for_new_window(&quot;mail:3pane&quot;);</span>
<a href="#l178.357"></a><span id="l178.357" class="difflineminus">-    } else if (!mc || mc.window.closed) {</span>
<a href="#l178.358"></a><span id="l178.358" class="difflineminus">-      // - We might have a window open, but not be assigned to mc -- so if</span>
<a href="#l178.359"></a><span id="l178.359" class="difflineminus">-      //   mc.window.closed is true, look for a window to assign to mc.</span>
<a href="#l178.360"></a><span id="l178.360" class="difflineminus">-      mc = windowHelper.wait_for_existing_window(&quot;mail:3pane&quot;);</span>
<a href="#l178.361"></a><span id="l178.361" class="difflineminus">-    }</span>
<a href="#l178.362"></a><span id="l178.362" class="difflineminus">-</span>
<a href="#l178.363"></a><span id="l178.363" class="difflineminus">-    // Run through all open windows, closing any that aren't assigned to mc.</span>
<a href="#l178.364"></a><span id="l178.364" class="difflineminus">-    let enumerator = Services.wm.getEnumerator(null);</span>
<a href="#l178.365"></a><span id="l178.365" class="difflineminus">-    while (enumerator.hasMoreElements()) {</span>
<a href="#l178.366"></a><span id="l178.366" class="difflineminus">-      let win = enumerator.getNext();</span>
<a href="#l178.367"></a><span id="l178.367" class="difflineminus">-      if (win != mc.window) {</span>
<a href="#l178.368"></a><span id="l178.368" class="difflineminus">-        mark_action(&quot;fdh&quot;, &quot;teardown&quot;, [</span>
<a href="#l178.369"></a><span id="l178.369" class="difflineminus">-          &quot;cleanup closing non-mc window&quot;,</span>
<a href="#l178.370"></a><span id="l178.370" class="difflineminus">-          win.toString(),</span>
<a href="#l178.371"></a><span id="l178.371" class="difflineminus">-          &quot;window type&quot;,</span>
<a href="#l178.372"></a><span id="l178.372" class="difflineminus">-          windowHelper.getWindowTypeForXulWindow(win),</span>
<a href="#l178.373"></a><span id="l178.373" class="difflineminus">-        ]);</span>
<a href="#l178.374"></a><span id="l178.374" class="difflineminus">-        win.close();</span>
<a href="#l178.375"></a><span id="l178.375" class="difflineminus">-      }</span>
<a href="#l178.376"></a><span id="l178.376" class="difflineminus">-    }</span>
<a href="#l178.377"></a><span id="l178.377" class="difflineminus">-</span>
<a href="#l178.378"></a><span id="l178.378" class="difflineminus">-    // At this point we should have exactly one window open.</span>
<a href="#l178.379"></a><span id="l178.379" class="difflineminus">-    // - Close all tabs other than the first one.</span>
<a href="#l178.380"></a><span id="l178.380" class="difflineminus">-    mc.tabmail.closeOtherTabs(mc.tabmail.tabInfo[0]);</span>
<a href="#l178.381"></a><span id="l178.381" class="difflineminus">-</span>
<a href="#l178.382"></a><span id="l178.382" class="difflineminus">-    // - Set the mode to All Folders.</span>
<a href="#l178.383"></a><span id="l178.383" class="difflineminus">-    if (mc.folderTreeView.mode != &quot;all&quot;) {</span>
<a href="#l178.384"></a><span id="l178.384" class="difflineminus">-      mark_action(&quot;fdh&quot;, &quot;teardown&quot;, [</span>
<a href="#l178.385"></a><span id="l178.385" class="difflineminus">-        &quot;resetting folderTreeView mode&quot;,</span>
<a href="#l178.386"></a><span id="l178.386" class="difflineminus">-        mc.folderTreeView.mode,</span>
<a href="#l178.387"></a><span id="l178.387" class="difflineminus">-      ]);</span>
<a href="#l178.388"></a><span id="l178.388" class="difflineminus">-      mc.folderTreeView.mode = &quot;all&quot;;</span>
<a href="#l178.389"></a><span id="l178.389" class="difflineminus">-    }</span>
<a href="#l178.390"></a><span id="l178.390" class="difflineminus">-</span>
<a href="#l178.391"></a><span id="l178.391" class="difflineminus">-    // - Make sure the message pane is visible.</span>
<a href="#l178.392"></a><span id="l178.392" class="difflineminus">-    if (mc.window.IsMessagePaneCollapsed()) {</span>
<a href="#l178.393"></a><span id="l178.393" class="difflineminus">-      mark_action(&quot;fdh&quot;, &quot;teardown&quot;, [&quot;toggling message pane on again&quot;]);</span>
<a href="#l178.394"></a><span id="l178.394" class="difflineminus">-      mc.window.MsgToggleMessagePane();</span>
<a href="#l178.395"></a><span id="l178.395" class="difflineminus">-    }</span>
<a href="#l178.396"></a><span id="l178.396" class="difflineminus">-  };</span>
<a href="#l178.397"></a><span id="l178.397" class="difflineminus">-  // Another internal mozmill thing, again figured out too early for it to have</span>
<a href="#l178.398"></a><span id="l178.398" class="difflineminus">-  // a chance.</span>
<a href="#l178.399"></a><span id="l178.399" class="difflineminus">-  teardownModule.__name__ = &quot;teardownModule&quot;;</span>
<a href="#l178.400"></a><span id="l178.400" class="difflineminus">-  return teardownModule;</span>
<a href="#l178.401"></a><span id="l178.401" class="difflineminus">-}</span>
<a href="#l178.402"></a><span id="l178.402" class="difflineminus">-</span>
<a href="#l178.403"></a><span id="l178.403"> /*</span>
<a href="#l178.404"></a><span id="l178.404">  * Although we all agree that the use of generators when dealing with async</span>
<a href="#l178.405"></a><span id="l178.405">  *  operations is awesome, the mozmill idiom is for calls to be synchronous and</span>
<a href="#l178.406"></a><span id="l178.406">  *  just spin event loops when they need to wait for things to happen.  This</span>
<a href="#l178.407"></a><span id="l178.407">  *  does make the test code significantly less confusing, so we do it too.</span>
<a href="#l178.408"></a><span id="l178.408">  * All of our operations are synchronous and just spin until they are happy.</span>
<a href="#l178.409"></a><span id="l178.409">  */</span>
<a href="#l178.410"></a><span id="l178.410"> </span>
<a href="#l178.411"></a><span id="l178.411" class="difflineat">@@ -3459,20 +3443,28 @@ var SyntheticPartMultiRelated;</span>
<a href="#l178.412"></a><span id="l178.412">  * test-folder-helpers.js - if you get an error in this function, probably an appropriate relative</span>
<a href="#l178.413"></a><span id="l178.413">  * path in FILE_LOAD_PATHS is missing for your setup.</span>
<a href="#l178.414"></a><span id="l178.414">  *</span>
<a href="#l178.415"></a><span id="l178.415">  * @param aPath A path relative to the comm-central source path (can be just a file name)</span>
<a href="#l178.416"></a><span id="l178.416">  *</span>
<a href="#l178.417"></a><span id="l178.417">  * @return An object that serves as the global scope for the loaded file.</span>
<a href="#l178.418"></a><span id="l178.418">  */</span>
<a href="#l178.419"></a><span id="l178.419"> function load_via_src_path(aPath, aModule) {</span>
<a href="#l178.420"></a><span id="l178.420" class="difflineminus">-  let thisFilePath = os.getFileForPath(__file__);</span>
<a href="#l178.421"></a><span id="l178.421" class="difflineplus">+  let thisFileURL = Cc[&quot;@mozilla.org/network/protocol;1?name=resource&quot;]</span>
<a href="#l178.422"></a><span id="l178.422" class="difflineplus">+    .getService(Ci.nsIResProtocolHandler)</span>
<a href="#l178.423"></a><span id="l178.423" class="difflineplus">+    .resolveURI(</span>
<a href="#l178.424"></a><span id="l178.424" class="difflineplus">+      Services.io.newURI(</span>
<a href="#l178.425"></a><span id="l178.425" class="difflineplus">+        &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l178.426"></a><span id="l178.426" class="difflineplus">+      )</span>
<a href="#l178.427"></a><span id="l178.427" class="difflineplus">+    );</span>
<a href="#l178.428"></a><span id="l178.428" class="difflineplus">+  let thisFile = Services.io.newURI(thisFileURL).QueryInterface(Ci.nsIFileURL)</span>
<a href="#l178.429"></a><span id="l178.429" class="difflineplus">+    .file;</span>
<a href="#l178.430"></a><span id="l178.430"> </span>
<a href="#l178.431"></a><span id="l178.431">   for (let i = 0; i &lt; FILE_LOAD_PATHS.length; ++i) {</span>
<a href="#l178.432"></a><span id="l178.432" class="difflineminus">-    let srcPath = os.abspath(FILE_LOAD_PATHS[i], thisFilePath);</span>
<a href="#l178.433"></a><span id="l178.433" class="difflineplus">+    let srcPath = os.abspath(FILE_LOAD_PATHS[i], thisFile);</span>
<a href="#l178.434"></a><span id="l178.434">     let fullPath = os.abspath(aPath, os.getFileForPath(srcPath));</span>
<a href="#l178.435"></a><span id="l178.435"> </span>
<a href="#l178.436"></a><span id="l178.436">     let file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsIFile);</span>
<a href="#l178.437"></a><span id="l178.437">     file.initWithPath(fullPath);</span>
<a href="#l178.438"></a><span id="l178.438"> </span>
<a href="#l178.439"></a><span id="l178.439">     if (file.exists()) {</span>
<a href="#l178.440"></a><span id="l178.440">       try {</span>
<a href="#l178.441"></a><span id="l178.441">         let uri = Services.io.newFileURI(file).spec;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l179.1"></a><span id="l179.1">rename from mail/test/mozmill/shared-modules/test-junk-helpers.js</span>
<a href="#l179.2"></a><span id="l179.2">rename to mail/test/mozmill/shared-modules/JunkHelpers.jsm</span>
<a href="#l179.3"></a><span id="l179.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-junk-helpers.js</span>
<a href="#l179.4"></a><span id="l179.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/JunkHelpers.jsm</span>
<a href="#l179.5"></a><span id="l179.5" class="difflineat">@@ -1,42 +1,29 @@</span>
<a href="#l179.6"></a><span id="l179.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l179.7"></a><span id="l179.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l179.8"></a><span id="l179.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l179.9"></a><span id="l179.9"> </span>
<a href="#l179.10"></a><span id="l179.10"> &quot;use strict&quot;;</span>
<a href="#l179.11"></a><span id="l179.11"> </span>
<a href="#l179.12"></a><span id="l179.12" class="difflineminus">-var MODULE_NAME = &quot;junk-helpers&quot;;</span>
<a href="#l179.13"></a><span id="l179.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l179.14"></a><span id="l179.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l179.15"></a><span id="l179.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l179.16"></a><span id="l179.16" class="difflineplus">+  &quot;mark_selected_messages_as_junk&quot;,</span>
<a href="#l179.17"></a><span id="l179.17" class="difflineplus">+  &quot;delete_mail_marked_as_junk&quot;,</span>
<a href="#l179.18"></a><span id="l179.18" class="difflineplus">+];</span>
<a href="#l179.19"></a><span id="l179.19"> </span>
<a href="#l179.20"></a><span id="l179.20"> var elib = ChromeUtils.import(</span>
<a href="#l179.21"></a><span id="l179.21">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l179.22"></a><span id="l179.22"> );</span>
<a href="#l179.23"></a><span id="l179.23"> var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l179.24"></a><span id="l179.24"> </span>
<a href="#l179.25"></a><span id="l179.25" class="difflineminus">-var folderDisplayHelper;</span>
<a href="#l179.26"></a><span id="l179.26" class="difflineminus">-var mc;</span>
<a href="#l179.27"></a><span id="l179.27" class="difflineminus">-</span>
<a href="#l179.28"></a><span id="l179.28" class="difflineminus">-// logHelper (and therefore folderDisplayHelper) exports</span>
<a href="#l179.29"></a><span id="l179.29" class="difflineminus">-var mark_failure;</span>
<a href="#l179.30"></a><span id="l179.30" class="difflineminus">-</span>
<a href="#l179.31"></a><span id="l179.31" class="difflineminus">-function setupModule() {</span>
<a href="#l179.32"></a><span id="l179.32" class="difflineminus">-  folderDisplayHelper = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l179.33"></a><span id="l179.33" class="difflineminus">-  mc = folderDisplayHelper.mc;</span>
<a href="#l179.34"></a><span id="l179.34" class="difflineminus">-  mark_failure = folderDisplayHelper.mark_failure;</span>
<a href="#l179.35"></a><span id="l179.35" class="difflineminus">-}</span>
<a href="#l179.36"></a><span id="l179.36" class="difflineminus">-</span>
<a href="#l179.37"></a><span id="l179.37" class="difflineminus">-function installInto(module) {</span>
<a href="#l179.38"></a><span id="l179.38" class="difflineminus">-  setupModule();</span>
<a href="#l179.39"></a><span id="l179.39" class="difflineminus">-</span>
<a href="#l179.40"></a><span id="l179.40" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l179.41"></a><span id="l179.41" class="difflineminus">-  module.mark_selected_messages_as_junk = mark_selected_messages_as_junk;</span>
<a href="#l179.42"></a><span id="l179.42" class="difflineminus">-  module.delete_mail_marked_as_junk = delete_mail_marked_as_junk;</span>
<a href="#l179.43"></a><span id="l179.43" class="difflineminus">-}</span>
<a href="#l179.44"></a><span id="l179.44" class="difflineplus">+var folderDisplayHelper = ChromeUtils.import(</span>
<a href="#l179.45"></a><span id="l179.45" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l179.46"></a><span id="l179.46" class="difflineplus">+);</span>
<a href="#l179.47"></a><span id="l179.47" class="difflineplus">+var mc = folderDisplayHelper.mc;</span>
<a href="#l179.48"></a><span id="l179.48" class="difflineplus">+var mark_failure = folderDisplayHelper.mark_failure;</span>
<a href="#l179.49"></a><span id="l179.49"> </span>
<a href="#l179.50"></a><span id="l179.50"> /**</span>
<a href="#l179.51"></a><span id="l179.51">  * Mark the selected messages as junk. This is done by pressing the J key.</span>
<a href="#l179.52"></a><span id="l179.52">  *</span>
<a href="#l179.53"></a><span id="l179.53">  * @param aController The controller in whose context to do this, defaults to</span>
<a href="#l179.54"></a><span id="l179.54">  *     |mc| if omitted.</span>
<a href="#l179.55"></a><span id="l179.55">  */</span>
<a href="#l179.56"></a><span id="l179.56"> function mark_selected_messages_as_junk(aController) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l180.1"></a><span id="l180.1">rename from mail/test/mozmill/shared-modules/test-mouse-event-helpers.js</span>
<a href="#l180.2"></a><span id="l180.2">rename to mail/test/mozmill/shared-modules/MouseEventHelpers.jsm</span>
<a href="#l180.3"></a><span id="l180.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js</span>
<a href="#l180.4"></a><span id="l180.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/MouseEventHelpers.jsm</span>
<a href="#l180.5"></a><span id="l180.5" class="difflineat">@@ -1,38 +1,29 @@</span>
<a href="#l180.6"></a><span id="l180.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l180.7"></a><span id="l180.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l180.8"></a><span id="l180.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l180.9"></a><span id="l180.9"> </span>
<a href="#l180.10"></a><span id="l180.10"> &quot;use strict&quot;;</span>
<a href="#l180.11"></a><span id="l180.11"> </span>
<a href="#l180.12"></a><span id="l180.12" class="difflineminus">-var MODULE_NAME = &quot;mouse-event-helpers&quot;;</span>
<a href="#l180.13"></a><span id="l180.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l180.14"></a><span id="l180.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l180.15"></a><span id="l180.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l180.16"></a><span id="l180.16" class="difflineplus">+  &quot;drag_n_drop_element&quot;,</span>
<a href="#l180.17"></a><span id="l180.17" class="difflineplus">+  &quot;synthesize_drag_start&quot;,</span>
<a href="#l180.18"></a><span id="l180.18" class="difflineplus">+  &quot;synthesize_drag_over&quot;,</span>
<a href="#l180.19"></a><span id="l180.19" class="difflineplus">+  &quot;synthesize_drag_end&quot;,</span>
<a href="#l180.20"></a><span id="l180.20" class="difflineplus">+  &quot;synthesize_drop&quot;,</span>
<a href="#l180.21"></a><span id="l180.21" class="difflineplus">+];</span>
<a href="#l180.22"></a><span id="l180.22"> </span>
<a href="#l180.23"></a><span id="l180.23"> var EventUtils = ChromeUtils.import(</span>
<a href="#l180.24"></a><span id="l180.24">   &quot;chrome://mozmill/content/stdlib/EventUtils.jsm&quot;</span>
<a href="#l180.25"></a><span id="l180.25"> );</span>
<a href="#l180.26"></a><span id="l180.26"> </span>
<a href="#l180.27"></a><span id="l180.27" class="difflineminus">-var fdh;</span>
<a href="#l180.28"></a><span id="l180.28" class="difflineminus">-</span>
<a href="#l180.29"></a><span id="l180.29" class="difflineminus">-function setupModule() {</span>
<a href="#l180.30"></a><span id="l180.30" class="difflineminus">-  fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l180.31"></a><span id="l180.31" class="difflineminus">-}</span>
<a href="#l180.32"></a><span id="l180.32" class="difflineminus">-</span>
<a href="#l180.33"></a><span id="l180.33" class="difflineminus">-function installInto(module) {</span>
<a href="#l180.34"></a><span id="l180.34" class="difflineminus">-  setupModule();</span>
<a href="#l180.35"></a><span id="l180.35" class="difflineminus">-</span>
<a href="#l180.36"></a><span id="l180.36" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l180.37"></a><span id="l180.37" class="difflineminus">-  module.drag_n_drop_element = drag_n_drop_element;</span>
<a href="#l180.38"></a><span id="l180.38" class="difflineminus">-  module.synthesize_drag_start = synthesize_drag_start;</span>
<a href="#l180.39"></a><span id="l180.39" class="difflineminus">-  module.synthesize_drag_over = synthesize_drag_over;</span>
<a href="#l180.40"></a><span id="l180.40" class="difflineminus">-  module.synthesize_drag_end = synthesize_drag_end;</span>
<a href="#l180.41"></a><span id="l180.41" class="difflineminus">-  module.synthesize_drop = synthesize_drop;</span>
<a href="#l180.42"></a><span id="l180.42" class="difflineminus">-}</span>
<a href="#l180.43"></a><span id="l180.43" class="difflineplus">+var fdh = ChromeUtils.import(</span>
<a href="#l180.44"></a><span id="l180.44" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l180.45"></a><span id="l180.45" class="difflineplus">+);</span>
<a href="#l180.46"></a><span id="l180.46"> </span>
<a href="#l180.47"></a><span id="l180.47"> /**</span>
<a href="#l180.48"></a><span id="l180.48">  * Execute a drag and drop session.</span>
<a href="#l180.49"></a><span id="l180.49">  * @param {XULElement} aDragObject</span>
<a href="#l180.50"></a><span id="l180.50">  *   the element from which the drag session should be started.</span>
<a href="#l180.51"></a><span id="l180.51">  * @param {} aDragWindow</span>
<a href="#l180.52"></a><span id="l180.52">  *   the window the aDragObject is in</span>
<a href="#l180.53"></a><span id="l180.53">  * @param {XULElement} aDropObject</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l181.1"></a><span id="l181.1">rename from mail/test/mozmill/shared-modules/test-nntp-helpers.js</span>
<a href="#l181.2"></a><span id="l181.2">rename to mail/test/mozmill/shared-modules/NNTPHelpers.jsm</span>
<a href="#l181.3"></a><span id="l181.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-nntp-helpers.js</span>
<a href="#l181.4"></a><span id="l181.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/NNTPHelpers.jsm</span>
<a href="#l181.5"></a><span id="l181.5" class="difflineat">@@ -1,17 +1,25 @@</span>
<a href="#l181.6"></a><span id="l181.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l181.7"></a><span id="l181.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l181.8"></a><span id="l181.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l181.9"></a><span id="l181.9"> </span>
<a href="#l181.10"></a><span id="l181.10"> &quot;use strict&quot;;</span>
<a href="#l181.11"></a><span id="l181.11"> </span>
<a href="#l181.12"></a><span id="l181.12" class="difflineminus">-var MODULE_NAME = &quot;nntp-helpers&quot;;</span>
<a href="#l181.13"></a><span id="l181.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l181.14"></a><span id="l181.14" class="difflineminus">-var MODULES_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l181.15"></a><span id="l181.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l181.16"></a><span id="l181.16" class="difflineplus">+  &quot;setupNNTPDaemon&quot;,</span>
<a href="#l181.17"></a><span id="l181.17" class="difflineplus">+  &quot;NNTP_PORT&quot;,</span>
<a href="#l181.18"></a><span id="l181.18" class="difflineplus">+  &quot;setupLocalServer&quot;,</span>
<a href="#l181.19"></a><span id="l181.19" class="difflineplus">+  &quot;startupNNTPServer&quot;,</span>
<a href="#l181.20"></a><span id="l181.20" class="difflineplus">+  &quot;shutdownNNTPServer&quot;,</span>
<a href="#l181.21"></a><span id="l181.21" class="difflineplus">+];</span>
<a href="#l181.22"></a><span id="l181.22" class="difflineplus">+</span>
<a href="#l181.23"></a><span id="l181.23" class="difflineplus">+var folderDisplayHelper = ChromeUtils.import(</span>
<a href="#l181.24"></a><span id="l181.24" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l181.25"></a><span id="l181.25" class="difflineplus">+);</span>
<a href="#l181.26"></a><span id="l181.26"> </span>
<a href="#l181.27"></a><span id="l181.27"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l181.28"></a><span id="l181.28"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l181.29"></a><span id="l181.29">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l181.30"></a><span id="l181.30"> );</span>
<a href="#l181.31"></a><span id="l181.31"> </span>
<a href="#l181.32"></a><span id="l181.32"> var kSimpleNewsArticle =</span>
<a href="#l181.33"></a><span id="l181.33">   &quot;From: John Doe &lt;john.doe@example.com&gt;\n&quot; +</span>
<a href="#l181.34"></a><span id="l181.34" class="difflineat">@@ -27,24 +35,19 @@ var kSimpleNewsArticle =</span>
<a href="#l181.35"></a><span id="l181.35"> // second element is whether or not we should subscribe to it.</span>
<a href="#l181.36"></a><span id="l181.36"> var groups = [</span>
<a href="#l181.37"></a><span id="l181.37">   [&quot;test.empty&quot;, false],</span>
<a href="#l181.38"></a><span id="l181.38">   [&quot;test.subscribe.empty&quot;, true],</span>
<a href="#l181.39"></a><span id="l181.39">   [&quot;test.subscribe.simple&quot;, true],</span>
<a href="#l181.40"></a><span id="l181.40">   [&quot;test.filter&quot;, true],</span>
<a href="#l181.41"></a><span id="l181.41"> ];</span>
<a href="#l181.42"></a><span id="l181.42"> </span>
<a href="#l181.43"></a><span id="l181.43" class="difflineminus">-var folderDisplayHelper;</span>
<a href="#l181.44"></a><span id="l181.44" class="difflineminus">-var mc;</span>
<a href="#l181.45"></a><span id="l181.45" class="difflineminus">-</span>
<a href="#l181.46"></a><span id="l181.46"> var testHelperModule;</span>
<a href="#l181.47"></a><span id="l181.47"> </span>
<a href="#l181.48"></a><span id="l181.48"> function setupModule() {</span>
<a href="#l181.49"></a><span id="l181.49" class="difflineminus">-  folderDisplayHelper = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l181.50"></a><span id="l181.50" class="difflineminus">-  mc = folderDisplayHelper.mc;</span>
<a href="#l181.51"></a><span id="l181.51">   testHelperModule = {</span>
<a href="#l181.52"></a><span id="l181.52">     Cc,</span>
<a href="#l181.53"></a><span id="l181.53">     Ci,</span>
<a href="#l181.54"></a><span id="l181.54">     Cu,</span>
<a href="#l181.55"></a><span id="l181.55">     // fake some xpcshell stuff</span>
<a href="#l181.56"></a><span id="l181.56">     _TEST_FILE: [&quot;mozmill&quot;],</span>
<a href="#l181.57"></a><span id="l181.57">     do_throw(aMsg) {</span>
<a href="#l181.58"></a><span id="l181.58">       throw new Error(aMsg);</span>
<a href="#l181.59"></a><span id="l181.59" class="difflineat">@@ -54,27 +57,17 @@ function setupModule() {</span>
<a href="#l181.60"></a><span id="l181.60">     &quot;fakeserver/nntpd.js&quot;,</span>
<a href="#l181.61"></a><span id="l181.61">     testHelperModule</span>
<a href="#l181.62"></a><span id="l181.62">   );</span>
<a href="#l181.63"></a><span id="l181.63">   folderDisplayHelper.load_via_src_path(</span>
<a href="#l181.64"></a><span id="l181.64">     &quot;fakeserver/maild.js&quot;,</span>
<a href="#l181.65"></a><span id="l181.65">     testHelperModule</span>
<a href="#l181.66"></a><span id="l181.66">   );</span>
<a href="#l181.67"></a><span id="l181.67"> }</span>
<a href="#l181.68"></a><span id="l181.68" class="difflineminus">-</span>
<a href="#l181.69"></a><span id="l181.69" class="difflineminus">-function installInto(module) {</span>
<a href="#l181.70"></a><span id="l181.70" class="difflineminus">-  setupModule();</span>
<a href="#l181.71"></a><span id="l181.71" class="difflineminus">-</span>
<a href="#l181.72"></a><span id="l181.72" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l181.73"></a><span id="l181.73" class="difflineminus">-  module.setupNNTPDaemon = setupNNTPDaemon;</span>
<a href="#l181.74"></a><span id="l181.74" class="difflineminus">-  module.NNTP_PORT = NNTP_PORT;</span>
<a href="#l181.75"></a><span id="l181.75" class="difflineminus">-  module.setupLocalServer = setupLocalServer;</span>
<a href="#l181.76"></a><span id="l181.76" class="difflineminus">-  module.startupNNTPServer = startupNNTPServer;</span>
<a href="#l181.77"></a><span id="l181.77" class="difflineminus">-  module.shutdownNNTPServer = shutdownNNTPServer;</span>
<a href="#l181.78"></a><span id="l181.78" class="difflineminus">-}</span>
<a href="#l181.79"></a><span id="l181.79" class="difflineplus">+setupModule();</span>
<a href="#l181.80"></a><span id="l181.80"> </span>
<a href="#l181.81"></a><span id="l181.81"> // Sets up the NNTP daemon object for use in fake server</span>
<a href="#l181.82"></a><span id="l181.82"> function setupNNTPDaemon() {</span>
<a href="#l181.83"></a><span id="l181.83">   var daemon = new testHelperModule.nntpDaemon();</span>
<a href="#l181.84"></a><span id="l181.84"> </span>
<a href="#l181.85"></a><span id="l181.85">   groups.forEach(function(element) {</span>
<a href="#l181.86"></a><span id="l181.86">     daemon.addGroup(element[0]);</span>
<a href="#l181.87"></a><span id="l181.87">   });</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l182.1"></a><span id="l182.1">rename from mail/test/mozmill/shared-modules/test-newmailaccount-helpers.js</span>
<a href="#l182.2"></a><span id="l182.2">rename to mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm</span>
<a href="#l182.3"></a><span id="l182.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-newmailaccount-helpers.js</span>
<a href="#l182.4"></a><span id="l182.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/NewMailAccountHelpers.jsm</span>
<a href="#l182.5"></a><span id="l182.5" class="difflineat">@@ -1,58 +1,49 @@</span>
<a href="#l182.6"></a><span id="l182.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l182.7"></a><span id="l182.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l182.8"></a><span id="l182.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l182.9"></a><span id="l182.9"> </span>
<a href="#l182.10"></a><span id="l182.10"> &quot;use strict&quot;;</span>
<a href="#l182.11"></a><span id="l182.11"> </span>
<a href="#l182.12"></a><span id="l182.12" class="difflineminus">-var MODULE_NAME = &quot;newmailaccount-helpers&quot;;</span>
<a href="#l182.13"></a><span id="l182.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l182.14"></a><span id="l182.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;dom-helpers&quot;];</span>
<a href="#l182.15"></a><span id="l182.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l182.16"></a><span id="l182.16" class="difflineplus">+  &quot;wait_for_provider_list_loaded&quot;,</span>
<a href="#l182.17"></a><span id="l182.17" class="difflineplus">+  &quot;wait_for_search_ready&quot;,</span>
<a href="#l182.18"></a><span id="l182.18" class="difflineplus">+  &quot;open_provisioner_window&quot;,</span>
<a href="#l182.19"></a><span id="l182.19" class="difflineplus">+  &quot;wait_for_the_wizard_to_be_closed&quot;,</span>
<a href="#l182.20"></a><span id="l182.20" class="difflineplus">+  &quot;assert_links_shown&quot;,</span>
<a href="#l182.21"></a><span id="l182.21" class="difflineplus">+  &quot;assert_links_not_shown&quot;,</span>
<a href="#l182.22"></a><span id="l182.22" class="difflineplus">+  &quot;wait_for_search_results&quot;,</span>
<a href="#l182.23"></a><span id="l182.23" class="difflineplus">+  &quot;gConsoleListener&quot;,</span>
<a href="#l182.24"></a><span id="l182.24" class="difflineplus">+  &quot;wait_to_be_offline&quot;,</span>
<a href="#l182.25"></a><span id="l182.25" class="difflineplus">+  &quot;remove_email_account&quot;,</span>
<a href="#l182.26"></a><span id="l182.26" class="difflineplus">+  &quot;type_in_search_name&quot;,</span>
<a href="#l182.27"></a><span id="l182.27" class="difflineplus">+];</span>
<a href="#l182.28"></a><span id="l182.28"> </span>
<a href="#l182.29"></a><span id="l182.29"> var elib = ChromeUtils.import(</span>
<a href="#l182.30"></a><span id="l182.30">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l182.31"></a><span id="l182.31"> );</span>
<a href="#l182.32"></a><span id="l182.32"> </span>
<a href="#l182.33"></a><span id="l182.33" class="difflineplus">+var dh = ChromeUtils.import(&quot;resource://testing-common/mozmill/DOMHelpers.jsm&quot;);</span>
<a href="#l182.34"></a><span id="l182.34" class="difflineplus">+var fdh = ChromeUtils.import(</span>
<a href="#l182.35"></a><span id="l182.35" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l182.36"></a><span id="l182.36" class="difflineplus">+);</span>
<a href="#l182.37"></a><span id="l182.37"> var { input_value } = ChromeUtils.import(</span>
<a href="#l182.38"></a><span id="l182.38">   &quot;resource://testing-common/mozmill/KeyboardHelpers.jsm&quot;</span>
<a href="#l182.39"></a><span id="l182.39"> );</span>
<a href="#l182.40"></a><span id="l182.40"> </span>
<a href="#l182.41"></a><span id="l182.41"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l182.42"></a><span id="l182.42"> var { fixIterator } = ChromeUtils.import(</span>
<a href="#l182.43"></a><span id="l182.43">   &quot;resource:///modules/iteratorUtils.jsm&quot;</span>
<a href="#l182.44"></a><span id="l182.44"> );</span>
<a href="#l182.45"></a><span id="l182.45"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l182.46"></a><span id="l182.46">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l182.47"></a><span id="l182.47"> );</span>
<a href="#l182.48"></a><span id="l182.48"> </span>
<a href="#l182.49"></a><span id="l182.49" class="difflineminus">-var mc, fdh, dh;</span>
<a href="#l182.50"></a><span id="l182.50" class="difflineminus">-</span>
<a href="#l182.51"></a><span id="l182.51" class="difflineminus">-function setupModule(module) {</span>
<a href="#l182.52"></a><span id="l182.52" class="difflineminus">-  fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l182.53"></a><span id="l182.53" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l182.54"></a><span id="l182.54" class="difflineminus">-  dh = collector.getModule(&quot;dom-helpers&quot;);</span>
<a href="#l182.55"></a><span id="l182.55" class="difflineminus">-  mc = fdh.mc;</span>
<a href="#l182.56"></a><span id="l182.56" class="difflineminus">-}</span>
<a href="#l182.57"></a><span id="l182.57" class="difflineminus">-</span>
<a href="#l182.58"></a><span id="l182.58" class="difflineminus">-function installInto(module) {</span>
<a href="#l182.59"></a><span id="l182.59" class="difflineminus">-  setupModule(module);</span>
<a href="#l182.60"></a><span id="l182.60" class="difflineminus">-</span>
<a href="#l182.61"></a><span id="l182.61" class="difflineminus">-  module.wait_for_provider_list_loaded = wait_for_provider_list_loaded;</span>
<a href="#l182.62"></a><span id="l182.62" class="difflineminus">-  module.wait_for_search_ready = wait_for_search_ready;</span>
<a href="#l182.63"></a><span id="l182.63" class="difflineminus">-  module.open_provisioner_window = open_provisioner_window;</span>
<a href="#l182.64"></a><span id="l182.64" class="difflineminus">-  module.wait_for_the_wizard_to_be_closed = wait_for_the_wizard_to_be_closed;</span>
<a href="#l182.65"></a><span id="l182.65" class="difflineminus">-  module.assert_links_shown = assert_links_shown;</span>
<a href="#l182.66"></a><span id="l182.66" class="difflineminus">-  module.assert_links_not_shown = assert_links_not_shown;</span>
<a href="#l182.67"></a><span id="l182.67" class="difflineminus">-  module.wait_for_search_results = wait_for_search_results;</span>
<a href="#l182.68"></a><span id="l182.68" class="difflineminus">-  module.gConsoleListener = gConsoleListener;</span>
<a href="#l182.69"></a><span id="l182.69" class="difflineminus">-  module.wait_to_be_offline = wait_to_be_offline;</span>
<a href="#l182.70"></a><span id="l182.70" class="difflineminus">-  module.remove_email_account = remove_email_account;</span>
<a href="#l182.71"></a><span id="l182.71" class="difflineminus">-  module.type_in_search_name = type_in_search_name;</span>
<a href="#l182.72"></a><span id="l182.72" class="difflineminus">-}</span>
<a href="#l182.73"></a><span id="l182.73" class="difflineplus">+var mc = fdh.mc;</span>
<a href="#l182.74"></a><span id="l182.74"> </span>
<a href="#l182.75"></a><span id="l182.75"> /* Wait until the list of providers is loaded and displayed.</span>
<a href="#l182.76"></a><span id="l182.76">  */</span>
<a href="#l182.77"></a><span id="l182.77"> function wait_for_provider_list_loaded(aController) {</span>
<a href="#l182.78"></a><span id="l182.78">   mc.waitFor(function() {</span>
<a href="#l182.79"></a><span id="l182.79">     return aController.window.EmailAccountProvisioner.loadedProviders;</span>
<a href="#l182.80"></a><span id="l182.80">   }, &quot;Timed out waiting for the provider list to be loaded&quot;);</span>
<a href="#l182.81"></a><span id="l182.81"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l183.1"></a><span id="l183.1">rename from mail/test/mozmill/shared-modules/test-pref-window-helpers.js</span>
<a href="#l183.2"></a><span id="l183.2">rename to mail/test/mozmill/shared-modules/PrefTabHelpers.jsm</span>
<a href="#l183.3"></a><span id="l183.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-pref-window-helpers.js</span>
<a href="#l183.4"></a><span id="l183.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/PrefTabHelpers.jsm</span>
<a href="#l183.5"></a><span id="l183.5" class="difflineat">@@ -1,40 +1,29 @@</span>
<a href="#l183.6"></a><span id="l183.6"> /* -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l183.7"></a><span id="l183.7"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l183.8"></a><span id="l183.8">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l183.9"></a><span id="l183.9">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l183.10"></a><span id="l183.10"> </span>
<a href="#l183.11"></a><span id="l183.11"> /*</span>
<a href="#l183.12"></a><span id="l183.12" class="difflineminus">- * Helpers to deal with the preferences window.</span>
<a href="#l183.13"></a><span id="l183.13" class="difflineplus">+ * Helpers to deal with the preferences tab.</span>
<a href="#l183.14"></a><span id="l183.14">  */</span>
<a href="#l183.15"></a><span id="l183.15"> </span>
<a href="#l183.16"></a><span id="l183.16"> &quot;use strict&quot;;</span>
<a href="#l183.17"></a><span id="l183.17"> </span>
<a href="#l183.18"></a><span id="l183.18" class="difflineminus">-var MODULE_NAME = &quot;pref-window-helpers&quot;;</span>
<a href="#l183.19"></a><span id="l183.19" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l183.20"></a><span id="l183.20" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;content-tab-helpers&quot;];</span>
<a href="#l183.21"></a><span id="l183.21" class="difflineplus">+this.EXPORTED_SYMBOLS = [&quot;close_pref_tab&quot;, &quot;open_pref_tab&quot;];</span>
<a href="#l183.22"></a><span id="l183.22"> </span>
<a href="#l183.23"></a><span id="l183.23"> var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l183.24"></a><span id="l183.24"> </span>
<a href="#l183.25"></a><span id="l183.25" class="difflineminus">-var fdh;</span>
<a href="#l183.26"></a><span id="l183.26" class="difflineminus">-var cth;</span>
<a href="#l183.27"></a><span id="l183.27" class="difflineminus">-</span>
<a href="#l183.28"></a><span id="l183.28" class="difflineminus">-function setupModule() {</span>
<a href="#l183.29"></a><span id="l183.29" class="difflineminus">-  fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l183.30"></a><span id="l183.30" class="difflineminus">-  cth = collector.getModule(&quot;content-tab-helpers&quot;);</span>
<a href="#l183.31"></a><span id="l183.31" class="difflineminus">-}</span>
<a href="#l183.32"></a><span id="l183.32" class="difflineminus">-</span>
<a href="#l183.33"></a><span id="l183.33" class="difflineminus">-function installInto(module) {</span>
<a href="#l183.34"></a><span id="l183.34" class="difflineminus">-  setupModule();</span>
<a href="#l183.35"></a><span id="l183.35" class="difflineminus">-</span>
<a href="#l183.36"></a><span id="l183.36" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l183.37"></a><span id="l183.37" class="difflineminus">-  module.open_pref_tab = open_pref_tab;</span>
<a href="#l183.38"></a><span id="l183.38" class="difflineminus">-  module.close_pref_tab = close_pref_tab;</span>
<a href="#l183.39"></a><span id="l183.39" class="difflineminus">-}</span>
<a href="#l183.40"></a><span id="l183.40" class="difflineplus">+var fdh = ChromeUtils.import(</span>
<a href="#l183.41"></a><span id="l183.41" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l183.42"></a><span id="l183.42" class="difflineplus">+);</span>
<a href="#l183.43"></a><span id="l183.43" class="difflineplus">+var cth = ChromeUtils.import(</span>
<a href="#l183.44"></a><span id="l183.44" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l183.45"></a><span id="l183.45" class="difflineplus">+);</span>
<a href="#l183.46"></a><span id="l183.46"> </span>
<a href="#l183.47"></a><span id="l183.47"> /**</span>
<a href="#l183.48"></a><span id="l183.48">  * Open the preferences tab with the given pane displayed. The pane needs to</span>
<a href="#l183.49"></a><span id="l183.49">  * be one of the prefpane ids in mail/components/preferences/aboutPreferences.xul.</span>
<a href="#l183.50"></a><span id="l183.50">  *</span>
<a href="#l183.51"></a><span id="l183.51">  * @param aPaneID The ID of the pref pane to display (see</span>
<a href="#l183.52"></a><span id="l183.52">  *     mail/components/preferences/aboutPreferences.xul for valid IDs.)</span>
<a href="#l183.53"></a><span id="l183.53">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l184.1"></a><span id="l184.1">rename from mail/test/mozmill/shared-modules/test-quick-filter-bar-helpers.js</span>
<a href="#l184.2"></a><span id="l184.2">rename to mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm</span>
<a href="#l184.3"></a><span id="l184.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-quick-filter-bar-helpers.js</span>
<a href="#l184.4"></a><span id="l184.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/QuickFilterBarHelpers.jsm</span>
<a href="#l184.5"></a><span id="l184.5" class="difflineat">@@ -1,26 +1,15 @@</span>
<a href="#l184.6"></a><span id="l184.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l184.7"></a><span id="l184.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l184.8"></a><span id="l184.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l184.9"></a><span id="l184.9"> </span>
<a href="#l184.10"></a><span id="l184.10"> &quot;use strict&quot;;</span>
<a href="#l184.11"></a><span id="l184.11"> </span>
<a href="#l184.12"></a><span id="l184.12" class="difflineminus">-var MODULE_NAME = &quot;quick-filter-bar-helpers&quot;;</span>
<a href="#l184.13"></a><span id="l184.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l184.14"></a><span id="l184.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l184.15"></a><span id="l184.15" class="difflineminus">-</span>
<a href="#l184.16"></a><span id="l184.16" class="difflineminus">-var fdh, mc;</span>
<a href="#l184.17"></a><span id="l184.17" class="difflineminus">-</span>
<a href="#l184.18"></a><span id="l184.18" class="difflineminus">-function setupModule() {</span>
<a href="#l184.19"></a><span id="l184.19" class="difflineminus">-  fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l184.20"></a><span id="l184.20" class="difflineminus">-  mc = fdh.mc;</span>
<a href="#l184.21"></a><span id="l184.21" class="difflineminus">-}</span>
<a href="#l184.22"></a><span id="l184.22" class="difflineminus">-</span>
<a href="#l184.23"></a><span id="l184.23" class="difflineminus">-var EXPORT = [</span>
<a href="#l184.24"></a><span id="l184.24" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l184.25"></a><span id="l184.25">   &quot;assert_quick_filter_button_enabled&quot;,</span>
<a href="#l184.26"></a><span id="l184.26">   &quot;assert_quick_filter_bar_visible&quot;,</span>
<a href="#l184.27"></a><span id="l184.27">   &quot;toggle_quick_filter_bar&quot;,</span>
<a href="#l184.28"></a><span id="l184.28">   &quot;assert_constraints_expressed&quot;,</span>
<a href="#l184.29"></a><span id="l184.29">   &quot;toggle_boolean_constraints&quot;,</span>
<a href="#l184.30"></a><span id="l184.30">   &quot;toggle_tag_constraints&quot;,</span>
<a href="#l184.31"></a><span id="l184.31">   &quot;toggle_tag_mode&quot;,</span>
<a href="#l184.32"></a><span id="l184.32">   &quot;assert_tag_constraints_visible&quot;,</span>
<a href="#l184.33"></a><span id="l184.33" class="difflineat">@@ -28,38 +17,23 @@ var EXPORT = [</span>
<a href="#l184.34"></a><span id="l184.34">   &quot;toggle_text_constraints&quot;,</span>
<a href="#l184.35"></a><span id="l184.35">   &quot;assert_text_constraints_checked&quot;,</span>
<a href="#l184.36"></a><span id="l184.36">   &quot;set_filter_text&quot;,</span>
<a href="#l184.37"></a><span id="l184.37">   &quot;assert_filter_text&quot;,</span>
<a href="#l184.38"></a><span id="l184.38">   &quot;assert_results_label_count&quot;,</span>
<a href="#l184.39"></a><span id="l184.39">   &quot;clear_constraints&quot;,</span>
<a href="#l184.40"></a><span id="l184.40"> ];</span>
<a href="#l184.41"></a><span id="l184.41"> </span>
<a href="#l184.42"></a><span id="l184.42" class="difflineminus">-var backstage = this;</span>
<a href="#l184.43"></a><span id="l184.43" class="difflineminus">-</span>
<a href="#l184.44"></a><span id="l184.44" class="difflineminus">-function installInto(module) {</span>
<a href="#l184.45"></a><span id="l184.45" class="difflineminus">-  setupModule();</span>
<a href="#l184.46"></a><span id="l184.46" class="difflineminus">-  for (let name of EXPORT) {</span>
<a href="#l184.47"></a><span id="l184.47" class="difflineminus">-    module[name] = backstage[name];</span>
<a href="#l184.48"></a><span id="l184.48" class="difflineminus">-  }</span>
<a href="#l184.49"></a><span id="l184.49" class="difflineminus">-  // disable the deferred search processing!</span>
<a href="#l184.50"></a><span id="l184.50" class="difflineminus">-  mc.window.QuickFilterBarMuxer.deferredUpdateSearch =</span>
<a href="#l184.51"></a><span id="l184.51" class="difflineminus">-    mc.window.QuickFilterBarMuxer.updateSearch;</span>
<a href="#l184.52"></a><span id="l184.52" class="difflineminus">-</span>
<a href="#l184.53"></a><span id="l184.53" class="difflineminus">-  module.__teardownTest__ = _afterEveryTest;</span>
<a href="#l184.54"></a><span id="l184.54" class="difflineminus">-  _afterEveryTest.__name__ = &quot;teardownTest&quot;;</span>
<a href="#l184.55"></a><span id="l184.55" class="difflineminus">-}</span>
<a href="#l184.56"></a><span id="l184.56" class="difflineminus">-</span>
<a href="#l184.57"></a><span id="l184.57" class="difflineminus">-function _afterEveryTest() {</span>
<a href="#l184.58"></a><span id="l184.58" class="difflineminus">-  clear_constraints();</span>
<a href="#l184.59"></a><span id="l184.59" class="difflineminus">-  // make it visible if it's not</span>
<a href="#l184.60"></a><span id="l184.60" class="difflineminus">-  if (mc.e(&quot;quick-filter-bar&quot;).collapsed) {</span>
<a href="#l184.61"></a><span id="l184.61" class="difflineminus">-    toggle_quick_filter_bar();</span>
<a href="#l184.62"></a><span id="l184.62" class="difflineminus">-  }</span>
<a href="#l184.63"></a><span id="l184.63" class="difflineminus">-}</span>
<a href="#l184.64"></a><span id="l184.64" class="difflineplus">+var fdh = ChromeUtils.import(</span>
<a href="#l184.65"></a><span id="l184.65" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l184.66"></a><span id="l184.66" class="difflineplus">+);</span>
<a href="#l184.67"></a><span id="l184.67" class="difflineplus">+var mc = fdh.mc;</span>
<a href="#l184.68"></a><span id="l184.68" class="difflineplus">+// disable the deferred search processing!</span>
<a href="#l184.69"></a><span id="l184.69" class="difflineplus">+mc.window.QuickFilterBarMuxer.deferredUpdateSearch =</span>
<a href="#l184.70"></a><span id="l184.70" class="difflineplus">+  mc.window.QuickFilterBarMuxer.updateSearch;</span>
<a href="#l184.71"></a><span id="l184.71"> </span>
<a href="#l184.72"></a><span id="l184.72"> /**</span>
<a href="#l184.73"></a><span id="l184.73">  * Maps names to bar DOM ids to simplify checking.</span>
<a href="#l184.74"></a><span id="l184.74">  */</span>
<a href="#l184.75"></a><span id="l184.75"> var nameToBarDomId = {</span>
<a href="#l184.76"></a><span id="l184.76">   sticky: &quot;qfb-sticky&quot;,</span>
<a href="#l184.77"></a><span id="l184.77">   unread: &quot;qfb-unread&quot;,</span>
<a href="#l184.78"></a><span id="l184.78">   starred: &quot;qfb-starred&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l185.1"></a><span id="l185.1">rename from mail/test/mozmill/shared-modules/test-search-window-helpers.js</span>
<a href="#l185.2"></a><span id="l185.2">rename to mail/test/mozmill/shared-modules/SearchWindowHelpers.jsm</span>
<a href="#l185.3"></a><span id="l185.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-search-window-helpers.js</span>
<a href="#l185.4"></a><span id="l185.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/SearchWindowHelpers.jsm</span>
<a href="#l185.5"></a><span id="l185.5" class="difflineat">@@ -1,39 +1,29 @@</span>
<a href="#l185.6"></a><span id="l185.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l185.7"></a><span id="l185.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l185.8"></a><span id="l185.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l185.9"></a><span id="l185.9"> </span>
<a href="#l185.10"></a><span id="l185.10"> &quot;use strict&quot;;</span>
<a href="#l185.11"></a><span id="l185.11"> </span>
<a href="#l185.12"></a><span id="l185.12" class="difflineminus">-var MODULE_NAME = &quot;search-window-helpers&quot;;</span>
<a href="#l185.13"></a><span id="l185.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l185.14"></a><span id="l185.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l185.15"></a><span id="l185.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l185.16"></a><span id="l185.16" class="difflineplus">+  &quot;open_search_window&quot;,</span>
<a href="#l185.17"></a><span id="l185.17" class="difflineplus">+  &quot;open_search_window_from_context_menu&quot;,</span>
<a href="#l185.18"></a><span id="l185.18" class="difflineplus">+  &quot;close_search_window&quot;,</span>
<a href="#l185.19"></a><span id="l185.19" class="difflineplus">+  &quot;assert_search_window_folder_displayed&quot;,</span>
<a href="#l185.20"></a><span id="l185.20" class="difflineplus">+];</span>
<a href="#l185.21"></a><span id="l185.21"> </span>
<a href="#l185.22"></a><span id="l185.22" class="difflineplus">+var folderDisplayHelper = ChromeUtils.import(</span>
<a href="#l185.23"></a><span id="l185.23" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l185.24"></a><span id="l185.24" class="difflineplus">+);</span>
<a href="#l185.25"></a><span id="l185.25"> var windowHelper = ChromeUtils.import(</span>
<a href="#l185.26"></a><span id="l185.26">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l185.27"></a><span id="l185.27"> );</span>
<a href="#l185.28"></a><span id="l185.28"> </span>
<a href="#l185.29"></a><span id="l185.29" class="difflineminus">-var folderDisplayHelper;</span>
<a href="#l185.30"></a><span id="l185.30" class="difflineminus">-var mc;</span>
<a href="#l185.31"></a><span id="l185.31" class="difflineminus">-</span>
<a href="#l185.32"></a><span id="l185.32" class="difflineminus">-function setupModule() {</span>
<a href="#l185.33"></a><span id="l185.33" class="difflineminus">-  folderDisplayHelper = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l185.34"></a><span id="l185.34" class="difflineminus">-  mc = folderDisplayHelper.mc;</span>
<a href="#l185.35"></a><span id="l185.35" class="difflineminus">-}</span>
<a href="#l185.36"></a><span id="l185.36" class="difflineminus">-</span>
<a href="#l185.37"></a><span id="l185.37" class="difflineminus">-function installInto(module) {</span>
<a href="#l185.38"></a><span id="l185.38" class="difflineminus">-  setupModule();</span>
<a href="#l185.39"></a><span id="l185.39" class="difflineminus">-</span>
<a href="#l185.40"></a><span id="l185.40" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l185.41"></a><span id="l185.41" class="difflineminus">-  module.open_search_window = open_search_window;</span>
<a href="#l185.42"></a><span id="l185.42" class="difflineminus">-  module.open_search_window_from_context_menu = open_search_window_from_context_menu;</span>
<a href="#l185.43"></a><span id="l185.43" class="difflineminus">-  module.close_search_window = close_search_window;</span>
<a href="#l185.44"></a><span id="l185.44" class="difflineminus">-  module.assert_search_window_folder_displayed = assert_search_window_folder_displayed;</span>
<a href="#l185.45"></a><span id="l185.45" class="difflineminus">-}</span>
<a href="#l185.46"></a><span id="l185.46" class="difflineplus">+var mc = folderDisplayHelper.mc;</span>
<a href="#l185.47"></a><span id="l185.47"> </span>
<a href="#l185.48"></a><span id="l185.48"> /**</span>
<a href="#l185.49"></a><span id="l185.49">  * Open a search window using the accel-shift-f shortcut.</span>
<a href="#l185.50"></a><span id="l185.50">  *</span>
<a href="#l185.51"></a><span id="l185.51">  * @returns the controller for the search window</span>
<a href="#l185.52"></a><span id="l185.52">  */</span>
<a href="#l185.53"></a><span id="l185.53"> function open_search_window() {</span>
<a href="#l185.54"></a><span id="l185.54">   windowHelper.plan_for_new_window(&quot;mailnews:search&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l186.1"></a><span id="l186.1">rename from mail/test/mozmill/shared-modules/test-subscribe-window-helpers.js</span>
<a href="#l186.2"></a><span id="l186.2">rename to mail/test/mozmill/shared-modules/SubscribeWindowHelpers.jsm</span>
<a href="#l186.3"></a><span id="l186.3" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-subscribe-window-helpers.js</span>
<a href="#l186.4"></a><span id="l186.4" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/SubscribeWindowHelpers.jsm</span>
<a href="#l186.5"></a><span id="l186.5" class="difflineat">@@ -1,41 +1,31 @@</span>
<a href="#l186.6"></a><span id="l186.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l186.7"></a><span id="l186.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l186.8"></a><span id="l186.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l186.9"></a><span id="l186.9"> </span>
<a href="#l186.10"></a><span id="l186.10"> &quot;use strict&quot;;</span>
<a href="#l186.11"></a><span id="l186.11"> </span>
<a href="#l186.12"></a><span id="l186.12" class="difflineminus">-var MODULE_NAME = &quot;subscribe-window-helpers&quot;;</span>
<a href="#l186.13"></a><span id="l186.13" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l186.14"></a><span id="l186.14" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l186.15"></a><span id="l186.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [</span>
<a href="#l186.16"></a><span id="l186.16" class="difflineplus">+  &quot;open_subscribe_window_from_context_menu&quot;,</span>
<a href="#l186.17"></a><span id="l186.17" class="difflineplus">+  &quot;enter_text_in_search_box&quot;,</span>
<a href="#l186.18"></a><span id="l186.18" class="difflineplus">+  &quot;check_newsgroup_displayed&quot;,</span>
<a href="#l186.19"></a><span id="l186.19" class="difflineplus">+];</span>
<a href="#l186.20"></a><span id="l186.20"> </span>
<a href="#l186.21"></a><span id="l186.21" class="difflineplus">+var folderDisplayHelper = ChromeUtils.import(</span>
<a href="#l186.22"></a><span id="l186.22" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l186.23"></a><span id="l186.23" class="difflineplus">+);</span>
<a href="#l186.24"></a><span id="l186.24"> var { input_value, delete_all_existing } = ChromeUtils.import(</span>
<a href="#l186.25"></a><span id="l186.25">   &quot;resource://testing-common/mozmill/KeyboardHelpers.jsm&quot;</span>
<a href="#l186.26"></a><span id="l186.26"> );</span>
<a href="#l186.27"></a><span id="l186.27"> var windowHelper = ChromeUtils.import(</span>
<a href="#l186.28"></a><span id="l186.28">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l186.29"></a><span id="l186.29"> );</span>
<a href="#l186.30"></a><span id="l186.30"> </span>
<a href="#l186.31"></a><span id="l186.31" class="difflineminus">-var folderDisplayHelper;</span>
<a href="#l186.32"></a><span id="l186.32" class="difflineminus">-var mc;</span>
<a href="#l186.33"></a><span id="l186.33" class="difflineminus">-</span>
<a href="#l186.34"></a><span id="l186.34" class="difflineminus">-function setupModule() {</span>
<a href="#l186.35"></a><span id="l186.35" class="difflineminus">-  folderDisplayHelper = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l186.36"></a><span id="l186.36" class="difflineminus">-  mc = folderDisplayHelper.mc;</span>
<a href="#l186.37"></a><span id="l186.37" class="difflineminus">-}</span>
<a href="#l186.38"></a><span id="l186.38" class="difflineminus">-</span>
<a href="#l186.39"></a><span id="l186.39" class="difflineminus">-function installInto(module) {</span>
<a href="#l186.40"></a><span id="l186.40" class="difflineminus">-  setupModule();</span>
<a href="#l186.41"></a><span id="l186.41" class="difflineminus">-</span>
<a href="#l186.42"></a><span id="l186.42" class="difflineminus">-  // Now copy helper functions</span>
<a href="#l186.43"></a><span id="l186.43" class="difflineminus">-  module.open_subscribe_window_from_context_menu = open_subscribe_window_from_context_menu;</span>
<a href="#l186.44"></a><span id="l186.44" class="difflineminus">-  module.enter_text_in_search_box = enter_text_in_search_box;</span>
<a href="#l186.45"></a><span id="l186.45" class="difflineminus">-  module.check_newsgroup_displayed = check_newsgroup_displayed;</span>
<a href="#l186.46"></a><span id="l186.46" class="difflineminus">-}</span>
<a href="#l186.47"></a><span id="l186.47" class="difflineplus">+var mc = folderDisplayHelper.mc;</span>
<a href="#l186.48"></a><span id="l186.48"> </span>
<a href="#l186.49"></a><span id="l186.49"> /**</span>
<a href="#l186.50"></a><span id="l186.50">  * Open a subscribe dialog from the context menu.</span>
<a href="#l186.51"></a><span id="l186.51">  *</span>
<a href="#l186.52"></a><span id="l186.52">  * @param aFolder the folder to open the subscribe dialog for</span>
<a href="#l186.53"></a><span id="l186.53">  * @param aFunction Callback that will be invoked with a controller</span>
<a href="#l186.54"></a><span id="l186.54">  *        for the subscribe dialogue as parameter</span>
<a href="#l186.55"></a><span id="l186.55">  */</span>
<a href="#l186.56"></a><span id="l186.56" class="difflineat">@@ -60,26 +50,16 @@ function open_subscribe_window_from_cont</span>
<a href="#l186.57"></a><span id="l186.57">  */</span>
<a href="#l186.58"></a><span id="l186.58"> function enter_text_in_search_box(swc, text) {</span>
<a href="#l186.59"></a><span id="l186.59">   let textbox = swc.eid(&quot;namefield&quot;);</span>
<a href="#l186.60"></a><span id="l186.60">   delete_all_existing(swc, textbox);</span>
<a href="#l186.61"></a><span id="l186.61">   input_value(swc, text, textbox);</span>
<a href="#l186.62"></a><span id="l186.62"> }</span>
<a href="#l186.63"></a><span id="l186.63"> </span>
<a href="#l186.64"></a><span id="l186.64"> /**</span>
<a href="#l186.65"></a><span id="l186.65" class="difflineminus">- * Check that the search view is currently displayed.</span>
<a href="#l186.66"></a><span id="l186.66" class="difflineminus">- *</span>
<a href="#l186.67"></a><span id="l186.67" class="difflineminus">- * @param swc A controller for the subscribe window.</span>
<a href="#l186.68"></a><span id="l186.68" class="difflineminus">- * @returns {Boolean} Result of the check.</span>
<a href="#l186.69"></a><span id="l186.69" class="difflineminus">- */</span>
<a href="#l186.70"></a><span id="l186.70" class="difflineminus">-function check_searchview(swc) {</span>
<a href="#l186.71"></a><span id="l186.71" class="difflineminus">-  return swc.eid(&quot;subscribedeck&quot;).selectedIndex == 1;</span>
<a href="#l186.72"></a><span id="l186.72" class="difflineminus">-}</span>
<a href="#l186.73"></a><span id="l186.73" class="difflineminus">-</span>
<a href="#l186.74"></a><span id="l186.74" class="difflineminus">-/**</span>
<a href="#l186.75"></a><span id="l186.75">  * Check whether the given newsgroup is in the searchview.</span>
<a href="#l186.76"></a><span id="l186.76">  *</span>
<a href="#l186.77"></a><span id="l186.77">  * @param swc A controller for the subscribe window</span>
<a href="#l186.78"></a><span id="l186.78">  * @param name Name of the newsgroup</span>
<a href="#l186.79"></a><span id="l186.79">  * @returns {Boolean} Result of the check</span>
<a href="#l186.80"></a><span id="l186.80">  */</span>
<a href="#l186.81"></a><span id="l186.81"> function check_newsgroup_displayed(swc, name) {</span>
<a href="#l186.82"></a><span id="l186.82">   let tree = swc.eid(&quot;searchTree&quot;).getNode();</span>
<a href="#l186.83"></a><span id="l186.83" class="difflineat">@@ -87,17 +67,8 @@ function check_newsgroup_displayed(swc, </span>
<a href="#l186.84"></a><span id="l186.84">   let nameCol = tree.columns.getColumnFor(swc.eid(&quot;nameColumn2&quot;).getNode());</span>
<a href="#l186.85"></a><span id="l186.85">   for (let i = 0; i &lt; treeview.rowCount; i++) {</span>
<a href="#l186.86"></a><span id="l186.86">     if (treeview.getCellText(i, nameCol) == name) {</span>
<a href="#l186.87"></a><span id="l186.87">       return true;</span>
<a href="#l186.88"></a><span id="l186.88">     }</span>
<a href="#l186.89"></a><span id="l186.89">   }</span>
<a href="#l186.90"></a><span id="l186.90">   return false;</span>
<a href="#l186.91"></a><span id="l186.91"> }</span>
<a href="#l186.92"></a><span id="l186.92" class="difflineminus">-</span>
<a href="#l186.93"></a><span id="l186.93" class="difflineminus">-/**</span>
<a href="#l186.94"></a><span id="l186.94" class="difflineminus">- * Close a search window by calling window.close() on the controller.</span>
<a href="#l186.95"></a><span id="l186.95" class="difflineminus">- *</span>
<a href="#l186.96"></a><span id="l186.96" class="difflineminus">- * @param swc A controller for the subscribe window</span>
<a href="#l186.97"></a><span id="l186.97" class="difflineminus">- */</span>
<a href="#l186.98"></a><span id="l186.98" class="difflineminus">-function close_subscribe_window(swc) {</span>
<a href="#l186.99"></a><span id="l186.99" class="difflineminus">-  windowHelper.close_window(swc);</span>
<a href="#l186.100"></a><span id="l186.100" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l187.1"></a><span id="l187.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/WindowHelpers.jsm</span>
<a href="#l187.2"></a><span id="l187.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/WindowHelpers.jsm</span>
<a href="#l187.3"></a><span id="l187.3" class="difflineat">@@ -2106,20 +2106,20 @@ function screenshotToDataURL(aWindow) {</span>
<a href="#l187.4"></a><span id="l187.4">   // the following, so it is commented out.  It is left around rather than</span>
<a href="#l187.5"></a><span id="l187.5">   // deleted because in the event we do need it again, this has some</span>
<a href="#l187.6"></a><span id="l187.6">   // improvements on the other variations a search might turn up.</span>
<a href="#l187.7"></a><span id="l187.7">   //</span>
<a href="#l187.8"></a><span id="l187.8">   // (We may need to do this for popups...)</span>
<a href="#l187.9"></a><span id="l187.9">   /*</span>
<a href="#l187.10"></a><span id="l187.10">   // - find all the sub-windows and render them</span>
<a href="#l187.11"></a><span id="l187.11"> </span>
<a href="#l187.12"></a><span id="l187.12" class="difflineminus">-  // function isVisible(aElem) has been moved to test-dom-helpers.js and</span>
<a href="#l187.13"></a><span id="l187.13" class="difflineplus">+  // function isVisible(aElem) has been moved to DOMHelpers.jsm and</span>
<a href="#l187.14"></a><span id="l187.14">   // renamed into element_visible_recursive(). If you resurrect the following</span>
<a href="#l187.15"></a><span id="l187.15">   // function subrenderCandidates, then make sure that you import</span>
<a href="#l187.16"></a><span id="l187.16" class="difflineminus">-  // test-dom-helpers.js.</span>
<a href="#l187.17"></a><span id="l187.17" class="difflineplus">+  // DOMHelpers.jsm.</span>
<a href="#l187.18"></a><span id="l187.18"> </span>
<a href="#l187.19"></a><span id="l187.19">   function subrenderCandidates(aElements) {</span>
<a href="#l187.20"></a><span id="l187.20">     for (let i = 0; i &lt; aElements.length; i++) {</span>
<a href="#l187.21"></a><span id="l187.21">       let elem = aElements[i];</span>
<a href="#l187.22"></a><span id="l187.22">       if (element_visible_recursive(elem)) {</span>
<a href="#l187.23"></a><span id="l187.23">         let rect = elem.getBoundingClientRect();</span>
<a href="#l187.24"></a><span id="l187.24">         ctx.save();</span>
<a href="#l187.25"></a><span id="l187.25">         ctx.translate(rect.left, rect.top);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l188.1"></a><span id="l188.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/moz.build</span>
<a href="#l188.2"></a><span id="l188.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/moz.build</span>
<a href="#l188.3"></a><span id="l188.3" class="difflineat">@@ -1,21 +1,30 @@</span>
<a href="#l188.4"></a><span id="l188.4"> # vim: set filetype=python:</span>
<a href="#l188.5"></a><span id="l188.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l188.6"></a><span id="l188.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l188.7"></a><span id="l188.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l188.8"></a><span id="l188.8"> </span>
<a href="#l188.9"></a><span id="l188.9" class="difflineminus">-# Copies the files in this folder to a staging directory in the objdir.</span>
<a href="#l188.10"></a><span id="l188.10" class="difflineminus">-# The calendar mozmill test files are run from there and use some files</span>
<a href="#l188.11"></a><span id="l188.11" class="difflineminus">-# from this folder.</span>
<a href="#l188.12"></a><span id="l188.12" class="difflineminus">-TEST_HARNESS_FILES.mozmill.stage['shared-modules'] += [</span>
<a href="#l188.13"></a><span id="l188.13" class="difflineminus">-    'test*.js',</span>
<a href="#l188.14"></a><span id="l188.14" class="difflineminus">-]</span>
<a href="#l188.15"></a><span id="l188.15" class="difflineminus">-</span>
<a href="#l188.16"></a><span id="l188.16"> TESTING_JS_MODULES.mozmill += [</span>
<a href="#l188.17"></a><span id="l188.17" class="difflineplus">+    'AccountManagerHelpers.jsm',</span>
<a href="#l188.18"></a><span id="l188.18" class="difflineplus">+    'AddressBookHelpers.jsm',</span>
<a href="#l188.19"></a><span id="l188.19">     'AttachmentHelpers.jsm',</span>
<a href="#l188.20"></a><span id="l188.20" class="difflineplus">+    'CloudfileHelpers.jsm',</span>
<a href="#l188.21"></a><span id="l188.21" class="difflineplus">+    'ComposeHelpers.jsm',</span>
<a href="#l188.22"></a><span id="l188.22" class="difflineplus">+    'ContentTabHelpers.jsm',</span>
<a href="#l188.23"></a><span id="l188.23" class="difflineplus">+    'CustomizationHelpers.jsm',</span>
<a href="#l188.24"></a><span id="l188.24" class="difflineplus">+    'DOMHelpers.jsm',</span>
<a href="#l188.25"></a><span id="l188.25" class="difflineplus">+    'FolderDisplayHelpers.jsm',</span>
<a href="#l188.26"></a><span id="l188.26" class="difflineplus">+    'JunkHelpers.jsm',</span>
<a href="#l188.27"></a><span id="l188.27">     'KeyboardHelpers.jsm',</span>
<a href="#l188.28"></a><span id="l188.28">     'MessageHelpers.jsm',</span>
<a href="#l188.29"></a><span id="l188.29">     'MockObjectHelpers.jsm',</span>
<a href="#l188.30"></a><span id="l188.30" class="difflineplus">+    'MouseEventHelpers.jsm',</span>
<a href="#l188.31"></a><span id="l188.31" class="difflineplus">+    'NewMailAccountHelpers.jsm',</span>
<a href="#l188.32"></a><span id="l188.32" class="difflineplus">+    'NNTPHelpers.jsm',</span>
<a href="#l188.33"></a><span id="l188.33">     'NotificationBoxHelpers.jsm',</span>
<a href="#l188.34"></a><span id="l188.34" class="difflineplus">+    'PrefTabHelpers.jsm',</span>
<a href="#l188.35"></a><span id="l188.35">     'PromptHelpers.jsm',</span>
<a href="#l188.36"></a><span id="l188.36" class="difflineplus">+    'QuickFilterBarHelpers.jsm',</span>
<a href="#l188.37"></a><span id="l188.37" class="difflineplus">+    'SearchWindowHelpers.jsm',</span>
<a href="#l188.38"></a><span id="l188.38" class="difflineplus">+    'SubscribeWindowHelpers.jsm',</span>
<a href="#l188.39"></a><span id="l188.39">     'WindowHelpers.jsm',</span>
<a href="#l188.40"></a><span id="l188.40"> ]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l189.1"></a><span id="l189.1">deleted file mode 100644</span>
<a href="#l189.2"></a><span id="l189.2" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-cloudfile-backend-helpers.js</span>
<a href="#l189.3"></a><span id="l189.3" class="difflineplus">+++ /dev/null</span>
<a href="#l189.4"></a><span id="l189.4" class="difflineat">@@ -1,126 +0,0 @@</span>
<a href="#l189.5"></a><span id="l189.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l189.6"></a><span id="l189.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l189.7"></a><span id="l189.7" class="difflineminus">- * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l189.8"></a><span id="l189.8" class="difflineminus">-</span>
<a href="#l189.9"></a><span id="l189.9" class="difflineminus">-&quot;use strict&quot;;</span>
<a href="#l189.10"></a><span id="l189.10" class="difflineminus">-</span>
<a href="#l189.11"></a><span id="l189.11" class="difflineminus">-var MODULE_NAME = &quot;cloudfile-backend-helpers&quot;;</span>
<a href="#l189.12"></a><span id="l189.12" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l189.13"></a><span id="l189.13" class="difflineminus">-</span>
<a href="#l189.14"></a><span id="l189.14" class="difflineminus">-var wh = ChromeUtils.import(</span>
<a href="#l189.15"></a><span id="l189.15" class="difflineminus">-  &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l189.16"></a><span id="l189.16" class="difflineminus">-);</span>
<a href="#l189.17"></a><span id="l189.17" class="difflineminus">-</span>
<a href="#l189.18"></a><span id="l189.18" class="difflineminus">-var { cloudFileAccounts } = ChromeUtils.import(</span>
<a href="#l189.19"></a><span id="l189.19" class="difflineminus">-  &quot;resource:///modules/cloudFileAccounts.jsm&quot;</span>
<a href="#l189.20"></a><span id="l189.20" class="difflineminus">-);</span>
<a href="#l189.21"></a><span id="l189.21" class="difflineminus">-</span>
<a href="#l189.22"></a><span id="l189.22" class="difflineminus">-var kUserAuthRequested = &quot;cloudfile:auth&quot;;</span>
<a href="#l189.23"></a><span id="l189.23" class="difflineminus">-var kUserDataRequested = &quot;cloudfile:user&quot;;</span>
<a href="#l189.24"></a><span id="l189.24" class="difflineminus">-var kUploadFile = &quot;cloudfile:uploadFile&quot;;</span>
<a href="#l189.25"></a><span id="l189.25" class="difflineminus">-var kGetFileURL = &quot;cloudfile:getFileURL&quot;;</span>
<a href="#l189.26"></a><span id="l189.26" class="difflineminus">-var kDeleteFile = &quot;cloudfile:deleteFile&quot;;</span>
<a href="#l189.27"></a><span id="l189.27" class="difflineminus">-var kLogout = &quot;cloudfile:logout&quot;;</span>
<a href="#l189.28"></a><span id="l189.28" class="difflineminus">-</span>
<a href="#l189.29"></a><span id="l189.29" class="difflineminus">-function installInto(module) {</span>
<a href="#l189.30"></a><span id="l189.30" class="difflineminus">-  module.kUserAuthRequested = kUserAuthRequested;</span>
<a href="#l189.31"></a><span id="l189.31" class="difflineminus">-  module.kUserDataRequested = kUserDataRequested;</span>
<a href="#l189.32"></a><span id="l189.32" class="difflineminus">-  module.kUploadFile = kUploadFile;</span>
<a href="#l189.33"></a><span id="l189.33" class="difflineminus">-  module.kGetFileURL = kGetFileURL;</span>
<a href="#l189.34"></a><span id="l189.34" class="difflineminus">-  module.kDeleteFile = kDeleteFile;</span>
<a href="#l189.35"></a><span id="l189.35" class="difflineminus">-  module.kLogout = kLogout;</span>
<a href="#l189.36"></a><span id="l189.36" class="difflineminus">-  module.SimpleRequestObserverManager = SimpleRequestObserverManager;</span>
<a href="#l189.37"></a><span id="l189.37" class="difflineminus">-  module.SimpleRequestObserver = SimpleRequestObserver;</span>
<a href="#l189.38"></a><span id="l189.38" class="difflineminus">-  module.assert_can_cancel_uploads = assert_can_cancel_uploads;</span>
<a href="#l189.39"></a><span id="l189.39" class="difflineminus">-}</span>
<a href="#l189.40"></a><span id="l189.40" class="difflineminus">-</span>
<a href="#l189.41"></a><span id="l189.41" class="difflineminus">-function SimpleRequestObserverManager() {</span>
<a href="#l189.42"></a><span id="l189.42" class="difflineminus">-  this._observers = [];</span>
<a href="#l189.43"></a><span id="l189.43" class="difflineminus">-}</span>
<a href="#l189.44"></a><span id="l189.44" class="difflineminus">-</span>
<a href="#l189.45"></a><span id="l189.45" class="difflineminus">-SimpleRequestObserverManager.prototype = {</span>
<a href="#l189.46"></a><span id="l189.46" class="difflineminus">-  create(aName) {</span>
<a href="#l189.47"></a><span id="l189.47" class="difflineminus">-    let obs = new SimpleRequestObserver(aName);</span>
<a href="#l189.48"></a><span id="l189.48" class="difflineminus">-    this._observers.push(obs);</span>
<a href="#l189.49"></a><span id="l189.49" class="difflineminus">-    return obs;</span>
<a href="#l189.50"></a><span id="l189.50" class="difflineminus">-  },</span>
<a href="#l189.51"></a><span id="l189.51" class="difflineminus">-</span>
<a href="#l189.52"></a><span id="l189.52" class="difflineminus">-  check() {</span>
<a href="#l189.53"></a><span id="l189.53" class="difflineminus">-    for (let observer of this._observers) {</span>
<a href="#l189.54"></a><span id="l189.54" class="difflineminus">-      if (!observer.success) {</span>
<a href="#l189.55"></a><span id="l189.55" class="difflineminus">-        throw new Error(</span>
<a href="#l189.56"></a><span id="l189.56" class="difflineminus">-          &quot;An observer named &quot; +</span>
<a href="#l189.57"></a><span id="l189.57" class="difflineminus">-            observer.name +</span>
<a href="#l189.58"></a><span id="l189.58" class="difflineminus">-            &quot; was leftover, &quot; +</span>
<a href="#l189.59"></a><span id="l189.59" class="difflineminus">-            &quot;with its success attribute set to: &quot; +</span>
<a href="#l189.60"></a><span id="l189.60" class="difflineminus">-            observer.success</span>
<a href="#l189.61"></a><span id="l189.61" class="difflineminus">-        );</span>
<a href="#l189.62"></a><span id="l189.62" class="difflineminus">-      }</span>
<a href="#l189.63"></a><span id="l189.63" class="difflineminus">-    }</span>
<a href="#l189.64"></a><span id="l189.64" class="difflineminus">-  },</span>
<a href="#l189.65"></a><span id="l189.65" class="difflineminus">-</span>
<a href="#l189.66"></a><span id="l189.66" class="difflineminus">-  reset() {</span>
<a href="#l189.67"></a><span id="l189.67" class="difflineminus">-    this._observers = [];</span>
<a href="#l189.68"></a><span id="l189.68" class="difflineminus">-  },</span>
<a href="#l189.69"></a><span id="l189.69" class="difflineminus">-};</span>
<a href="#l189.70"></a><span id="l189.70" class="difflineminus">-</span>
<a href="#l189.71"></a><span id="l189.71" class="difflineminus">-function SimpleRequestObserver(aName) {</span>
<a href="#l189.72"></a><span id="l189.72" class="difflineminus">-  this.name = aName;</span>
<a href="#l189.73"></a><span id="l189.73" class="difflineminus">-}</span>
<a href="#l189.74"></a><span id="l189.74" class="difflineminus">-</span>
<a href="#l189.75"></a><span id="l189.75" class="difflineminus">-SimpleRequestObserver.prototype = {</span>
<a href="#l189.76"></a><span id="l189.76" class="difflineminus">-  success: null,</span>
<a href="#l189.77"></a><span id="l189.77" class="difflineminus">-  onStartRequest(aRequest) {},</span>
<a href="#l189.78"></a><span id="l189.78" class="difflineminus">-  onStopRequest(aRequest, aStatusCode) {</span>
<a href="#l189.79"></a><span id="l189.79" class="difflineminus">-    if (Components.isSuccessCode(aStatusCode)) {</span>
<a href="#l189.80"></a><span id="l189.80" class="difflineminus">-      this.success = true;</span>
<a href="#l189.81"></a><span id="l189.81" class="difflineminus">-    } else {</span>
<a href="#l189.82"></a><span id="l189.82" class="difflineminus">-      this.success = false;</span>
<a href="#l189.83"></a><span id="l189.83" class="difflineminus">-    }</span>
<a href="#l189.84"></a><span id="l189.84" class="difflineminus">-  },</span>
<a href="#l189.85"></a><span id="l189.85" class="difflineminus">-  QueryInterface: ChromeUtils.generateQI([</span>
<a href="#l189.86"></a><span id="l189.86" class="difflineminus">-    Ci.nsIRequestObserver,</span>
<a href="#l189.87"></a><span id="l189.87" class="difflineminus">-    Ci.nsISupportsWeakReference,</span>
<a href="#l189.88"></a><span id="l189.88" class="difflineminus">-  ]),</span>
<a href="#l189.89"></a><span id="l189.89" class="difflineminus">-};</span>
<a href="#l189.90"></a><span id="l189.90" class="difflineminus">-</span>
<a href="#l189.91"></a><span id="l189.91" class="difflineminus">-/**</span>
<a href="#l189.92"></a><span id="l189.92" class="difflineminus">- * This function uploads one or more files, and then proceeds to cancel</span>
<a href="#l189.93"></a><span id="l189.93" class="difflineminus">- * them.  This function assumes that the mock server for the provider</span>
<a href="#l189.94"></a><span id="l189.94" class="difflineminus">- * is prepared for the uploaded files, and will give enough time for</span>
<a href="#l189.95"></a><span id="l189.95" class="difflineminus">- * the uploads to be cancelled before they complete.</span>
<a href="#l189.96"></a><span id="l189.96" class="difflineminus">- *</span>
<a href="#l189.97"></a><span id="l189.97" class="difflineminus">- * @param aController the controller to use for waitFors.</span>
<a href="#l189.98"></a><span id="l189.98" class="difflineminus">- * @param aProvider the provider to upload and cancel the files with.</span>
<a href="#l189.99"></a><span id="l189.99" class="difflineminus">- * @param aFiles the array of files to upload.</span>
<a href="#l189.100"></a><span id="l189.100" class="difflineminus">- */</span>
<a href="#l189.101"></a><span id="l189.101" class="difflineminus">-function assert_can_cancel_uploads(aController, aProvider, aFiles) {</span>
<a href="#l189.102"></a><span id="l189.102" class="difflineminus">-  let fileListenerMap = [];</span>
<a href="#l189.103"></a><span id="l189.103" class="difflineminus">-  wh.plan_for_observable_event(&quot;cloudfile:uploadStarted&quot;);</span>
<a href="#l189.104"></a><span id="l189.104" class="difflineminus">-</span>
<a href="#l189.105"></a><span id="l189.105" class="difflineminus">-  for (let file of aFiles) {</span>
<a href="#l189.106"></a><span id="l189.106" class="difflineminus">-    let mapping = {};</span>
<a href="#l189.107"></a><span id="l189.107" class="difflineminus">-    aProvider.uploadFile(file).catch(() =&gt; {</span>
<a href="#l189.108"></a><span id="l189.108" class="difflineminus">-      mapping.cancelled = true;</span>
<a href="#l189.109"></a><span id="l189.109" class="difflineminus">-    });</span>
<a href="#l189.110"></a><span id="l189.110" class="difflineminus">-    fileListenerMap.push(mapping);</span>
<a href="#l189.111"></a><span id="l189.111" class="difflineminus">-  }</span>
<a href="#l189.112"></a><span id="l189.112" class="difflineminus">-</span>
<a href="#l189.113"></a><span id="l189.113" class="difflineminus">-  // Wait for the first file to start uploading...</span>
<a href="#l189.114"></a><span id="l189.114" class="difflineminus">-  wh.wait_for_observable_event(&quot;cloudfile:uploadStarted&quot;);</span>
<a href="#l189.115"></a><span id="l189.115" class="difflineminus">-</span>
<a href="#l189.116"></a><span id="l189.116" class="difflineminus">-  // Go backwards through the file list, ensuring that we can cancel the</span>
<a href="#l189.117"></a><span id="l189.117" class="difflineminus">-  // last file, all the way to the first.</span>
<a href="#l189.118"></a><span id="l189.118" class="difflineminus">-  for (let i = aFiles.length - 1; i &gt;= 0; --i) {</span>
<a href="#l189.119"></a><span id="l189.119" class="difflineminus">-    aProvider.cancelFileUpload(aFiles[i]);</span>
<a href="#l189.120"></a><span id="l189.120" class="difflineminus">-  }</span>
<a href="#l189.121"></a><span id="l189.121" class="difflineminus">-</span>
<a href="#l189.122"></a><span id="l189.122" class="difflineminus">-  aController.waitFor(function() {</span>
<a href="#l189.123"></a><span id="l189.123" class="difflineminus">-    return (</span>
<a href="#l189.124"></a><span id="l189.124" class="difflineminus">-      fileListenerMap.length == aFiles.length &amp;&amp;</span>
<a href="#l189.125"></a><span id="l189.125" class="difflineminus">-      fileListenerMap.every(function(aMapping) {</span>
<a href="#l189.126"></a><span id="l189.126" class="difflineminus">-        return aMapping.cancelled;</span>
<a href="#l189.127"></a><span id="l189.127" class="difflineminus">-      })</span>
<a href="#l189.128"></a><span id="l189.128" class="difflineminus">-    );</span>
<a href="#l189.129"></a><span id="l189.129" class="difflineminus">-  }, &quot;Timed out waiting for cancellation to occur&quot;);</span>
<a href="#l189.130"></a><span id="l189.130" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l190.1"></a><span id="l190.1" class="difflineminus">--- a/mail/test/mozmill/smime/test-smime-multipart-alternative.js</span>
<a href="#l190.2"></a><span id="l190.2" class="difflineplus">+++ b/mail/test/mozmill/smime/test-smime-multipart-alternative.js</span>
<a href="#l190.3"></a><span id="l190.3" class="difflineat">@@ -5,42 +5,48 @@</span>
<a href="#l190.4"></a><span id="l190.4"> /**</span>
<a href="#l190.5"></a><span id="l190.5">  * Test that a reply to a multipart/alternative message with two</span>
<a href="#l190.6"></a><span id="l190.6">  * encrypted parts doesn't leak the secret plaintext from the second</span>
<a href="#l190.7"></a><span id="l190.7">  * part.</span>
<a href="#l190.8"></a><span id="l190.8">  */</span>
<a href="#l190.9"></a><span id="l190.9"> </span>
<a href="#l190.10"></a><span id="l190.10"> &quot;use strict&quot;;</span>
<a href="#l190.11"></a><span id="l190.11"> </span>
<a href="#l190.12"></a><span id="l190.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l190.13"></a><span id="l190.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l190.14"></a><span id="l190.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-window-helpers.js */</span>
<a href="#l190.15"></a><span id="l190.15" class="difflineplus">+var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l190.16"></a><span id="l190.16"> </span>
<a href="#l190.17"></a><span id="l190.17" class="difflineminus">-var MODULE_NAME = &quot;test-smime-multipart-alternative&quot;;</span>
<a href="#l190.18"></a><span id="l190.18" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l190.19"></a><span id="l190.19" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l190.20"></a><span id="l190.20" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l190.21"></a><span id="l190.21" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l190.22"></a><span id="l190.22" class="difflineminus">-  &quot;window-helpers&quot;,</span>
<a href="#l190.23"></a><span id="l190.23" class="difflineminus">-];</span>
<a href="#l190.24"></a><span id="l190.24" class="difflineplus">+var {</span>
<a href="#l190.25"></a><span id="l190.25" class="difflineplus">+  close_compose_window,</span>
<a href="#l190.26"></a><span id="l190.26" class="difflineplus">+  get_msg_source,</span>
<a href="#l190.27"></a><span id="l190.27" class="difflineplus">+  open_compose_with_reply,</span>
<a href="#l190.28"></a><span id="l190.28" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;);</span>
<a href="#l190.29"></a><span id="l190.29" class="difflineplus">+var {</span>
<a href="#l190.30"></a><span id="l190.30" class="difflineplus">+  assert_false,</span>
<a href="#l190.31"></a><span id="l190.31" class="difflineplus">+  be_in_folder,</span>
<a href="#l190.32"></a><span id="l190.32" class="difflineplus">+  get_special_folder,</span>
<a href="#l190.33"></a><span id="l190.33" class="difflineplus">+  open_message_from_file,</span>
<a href="#l190.34"></a><span id="l190.34" class="difflineplus">+  press_delete,</span>
<a href="#l190.35"></a><span id="l190.35" class="difflineplus">+  select_click_row,</span>
<a href="#l190.36"></a><span id="l190.36" class="difflineplus">+  smimeUtils_ensureNSS,</span>
<a href="#l190.37"></a><span id="l190.37" class="difflineplus">+  smimeUtils_loadCertificateAndKey,</span>
<a href="#l190.38"></a><span id="l190.38" class="difflineplus">+  smimeUtils_loadPEMCertificate,</span>
<a href="#l190.39"></a><span id="l190.39" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l190.40"></a><span id="l190.40" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l190.41"></a><span id="l190.41" class="difflineplus">+);</span>
<a href="#l190.42"></a><span id="l190.42" class="difflineplus">+var { close_window } = ChromeUtils.import(</span>
<a href="#l190.43"></a><span id="l190.43" class="difflineplus">+  &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l190.44"></a><span id="l190.44" class="difflineplus">+);</span>
<a href="#l190.45"></a><span id="l190.45"> </span>
<a href="#l190.46"></a><span id="l190.46"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l190.47"></a><span id="l190.47"> var { MailServices } = ChromeUtils.import(</span>
<a href="#l190.48"></a><span id="l190.48">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l190.49"></a><span id="l190.49"> );</span>
<a href="#l190.50"></a><span id="l190.50"> </span>
<a href="#l190.51"></a><span id="l190.51" class="difflineminus">-var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l190.52"></a><span id="l190.52" class="difflineminus">-</span>
<a href="#l190.53"></a><span id="l190.53"> var gDrafts;</span>
<a href="#l190.54"></a><span id="l190.54"> </span>
<a href="#l190.55"></a><span id="l190.55"> function setupModule(module) {</span>
<a href="#l190.56"></a><span id="l190.56" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l190.57"></a><span id="l190.57" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l190.58"></a><span id="l190.58" class="difflineminus">-  }</span>
<a href="#l190.59"></a><span id="l190.59" class="difflineminus">-</span>
<a href="#l190.60"></a><span id="l190.60">   gDrafts = get_special_folder(Ci.nsMsgFolderFlags.Drafts, true);</span>
<a href="#l190.61"></a><span id="l190.61"> </span>
<a href="#l190.62"></a><span id="l190.62">   Services.prefs.setBoolPref(&quot;mail.identity.id1.compose_html&quot;, true);</span>
<a href="#l190.63"></a><span id="l190.63"> }</span>
<a href="#l190.64"></a><span id="l190.64"> </span>
<a href="#l190.65"></a><span id="l190.65"> function get_file_for_path(path) {</span>
<a href="#l190.66"></a><span id="l190.66">   return os.getFileForPath(os.abspath(path, os.getFileForPath(__file__)));</span>
<a href="#l190.67"></a><span id="l190.67"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l191.1"></a><span id="l191.1" class="difflineminus">--- a/mail/test/mozmill/startup-firstrun/test-menubar-collapsed.js</span>
<a href="#l191.2"></a><span id="l191.2" class="difflineplus">+++ b/mail/test/mozmill/startup-firstrun/test-menubar-collapsed.js</span>
<a href="#l191.3"></a><span id="l191.3" class="difflineat">@@ -4,29 +4,24 @@</span>
<a href="#l191.4"></a><span id="l191.4"> </span>
<a href="#l191.5"></a><span id="l191.5"> /**</span>
<a href="#l191.6"></a><span id="l191.6">  * Tests that the main menu will be collapsed by default if Thunderbird starts</span>
<a href="#l191.7"></a><span id="l191.7">  * with no accounts created.</span>
<a href="#l191.8"></a><span id="l191.8">  */</span>
<a href="#l191.9"></a><span id="l191.9"> </span>
<a href="#l191.10"></a><span id="l191.10"> &quot;use strict&quot;;</span>
<a href="#l191.11"></a><span id="l191.11"> </span>
<a href="#l191.12"></a><span id="l191.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l191.13"></a><span id="l191.13" class="difflineminus">-</span>
<a href="#l191.14"></a><span id="l191.14" class="difflineminus">-var MODULE_NAME = &quot;test-main-menu-collapsed&quot;;</span>
<a href="#l191.15"></a><span id="l191.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l191.16"></a><span id="l191.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l191.17"></a><span id="l191.17" class="difflineminus">-</span>
<a href="#l191.18"></a><span id="l191.18" class="difflineplus">+var { assert_equals, mc } = ChromeUtils.import(</span>
<a href="#l191.19"></a><span id="l191.19" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l191.20"></a><span id="l191.20" class="difflineplus">+);</span>
<a href="#l191.21"></a><span id="l191.21"> var { close_window, wait_for_existing_window } = ChromeUtils.import(</span>
<a href="#l191.22"></a><span id="l191.22">   &quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;</span>
<a href="#l191.23"></a><span id="l191.23"> );</span>
<a href="#l191.24"></a><span id="l191.24"> </span>
<a href="#l191.25"></a><span id="l191.25" class="difflineminus">-function setupModule(module) {</span>
<a href="#l191.26"></a><span id="l191.26" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l191.27"></a><span id="l191.27" class="difflineminus">-}</span>
<a href="#l191.28"></a><span id="l191.28" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l191.29"></a><span id="l191.29"> </span>
<a href="#l191.30"></a><span id="l191.30"> function test_main_menu_collapsed() {</span>
<a href="#l191.31"></a><span id="l191.31">   // Due to random oranges on slower machines, we need to ensure that startup</span>
<a href="#l191.32"></a><span id="l191.32">   // is complete before running this test.</span>
<a href="#l191.33"></a><span id="l191.33">   let done = false;</span>
<a href="#l191.34"></a><span id="l191.34">   let observer = {</span>
<a href="#l191.35"></a><span id="l191.35">     observe(aSubject, aTopic, aData) {</span>
<a href="#l191.36"></a><span id="l191.36">       if (aTopic == &quot;mail-startup-done&quot;) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l192.1"></a><span id="l192.1" class="difflineminus">--- a/mail/test/mozmill/subscribe/test-subscribe-news-filter.js</span>
<a href="#l192.2"></a><span id="l192.2" class="difflineplus">+++ b/mail/test/mozmill/subscribe/test-subscribe-news-filter.js</span>
<a href="#l192.3"></a><span id="l192.3" class="difflineat">@@ -1,33 +1,32 @@</span>
<a href="#l192.4"></a><span id="l192.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l192.5"></a><span id="l192.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l192.6"></a><span id="l192.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l192.7"></a><span id="l192.7"> </span>
<a href="#l192.8"></a><span id="l192.8"> /* Test that the subscribe window for news servers has working autocomplete. */</span>
<a href="#l192.9"></a><span id="l192.9"> </span>
<a href="#l192.10"></a><span id="l192.10"> &quot;use strict&quot;;</span>
<a href="#l192.11"></a><span id="l192.11"> </span>
<a href="#l192.12"></a><span id="l192.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l192.13"></a><span id="l192.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-nntp-helpers.js */</span>
<a href="#l192.14"></a><span id="l192.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-subscribe-window-helpers.js */</span>
<a href="#l192.15"></a><span id="l192.15" class="difflineplus">+var utils = ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.jsm&quot;);</span>
<a href="#l192.16"></a><span id="l192.16"> </span>
<a href="#l192.17"></a><span id="l192.17" class="difflineminus">-var MODULE_NAME = &quot;test-subscribe-news-filter&quot;;</span>
<a href="#l192.18"></a><span id="l192.18" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l192.19"></a><span id="l192.19" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l192.20"></a><span id="l192.20" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l192.21"></a><span id="l192.21" class="difflineminus">-  &quot;nntp-helpers&quot;,</span>
<a href="#l192.22"></a><span id="l192.22" class="difflineminus">-  &quot;subscribe-window-helpers&quot;,</span>
<a href="#l192.23"></a><span id="l192.23" class="difflineminus">-];</span>
<a href="#l192.24"></a><span id="l192.24" class="difflineminus">-</span>
<a href="#l192.25"></a><span id="l192.25" class="difflineminus">-function setupModule(module) {</span>
<a href="#l192.26"></a><span id="l192.26" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l192.27"></a><span id="l192.27" class="difflineminus">-  collector.getModule(&quot;nntp-helpers&quot;).installInto(module);</span>
<a href="#l192.28"></a><span id="l192.28" class="difflineminus">-  collector.getModule(&quot;subscribe-window-helpers&quot;).installInto(module);</span>
<a href="#l192.29"></a><span id="l192.29" class="difflineminus">-}</span>
<a href="#l192.30"></a><span id="l192.30" class="difflineplus">+var {</span>
<a href="#l192.31"></a><span id="l192.31" class="difflineplus">+  NNTP_PORT,</span>
<a href="#l192.32"></a><span id="l192.32" class="difflineplus">+  setupLocalServer,</span>
<a href="#l192.33"></a><span id="l192.33" class="difflineplus">+  setupNNTPDaemon,</span>
<a href="#l192.34"></a><span id="l192.34" class="difflineplus">+  shutdownNNTPServer,</span>
<a href="#l192.35"></a><span id="l192.35" class="difflineplus">+  startupNNTPServer,</span>
<a href="#l192.36"></a><span id="l192.36" class="difflineplus">+} = ChromeUtils.import(&quot;resource://testing-common/mozmill/NNTPHelpers.jsm&quot;);</span>
<a href="#l192.37"></a><span id="l192.37" class="difflineplus">+var {</span>
<a href="#l192.38"></a><span id="l192.38" class="difflineplus">+  check_newsgroup_displayed,</span>
<a href="#l192.39"></a><span id="l192.39" class="difflineplus">+  enter_text_in_search_box,</span>
<a href="#l192.40"></a><span id="l192.40" class="difflineplus">+  open_subscribe_window_from_context_menu,</span>
<a href="#l192.41"></a><span id="l192.41" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l192.42"></a><span id="l192.42" class="difflineplus">+  &quot;resource://testing-common/mozmill/SubscribeWindowHelpers.jsm&quot;</span>
<a href="#l192.43"></a><span id="l192.43" class="difflineplus">+);</span>
<a href="#l192.44"></a><span id="l192.44"> </span>
<a href="#l192.45"></a><span id="l192.45"> /**</span>
<a href="#l192.46"></a><span id="l192.46">  * Checks that the filter in the subscribe window works correctly</span>
<a href="#l192.47"></a><span id="l192.47">  * (shows only newsgroups matching all of several search strings</span>
<a href="#l192.48"></a><span id="l192.48">  * separated by whitespace)</span>
<a href="#l192.49"></a><span id="l192.49">  */</span>
<a href="#l192.50"></a><span id="l192.50"> function test_subscribe_newsgroup_filter() {</span>
<a href="#l192.51"></a><span id="l192.51">   var daemon = setupNNTPDaemon();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l193.1"></a><span id="l193.1" class="difflineminus">--- a/mail/test/mozmill/tabmail/test-tabmail-closing.js</span>
<a href="#l193.2"></a><span id="l193.2" class="difflineplus">+++ b/mail/test/mozmill/tabmail/test-tabmail-closing.js</span>
<a href="#l193.3"></a><span id="l193.3" class="difflineat">@@ -3,29 +3,38 @@</span>
<a href="#l193.4"></a><span id="l193.4">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l193.5"></a><span id="l193.5"> </span>
<a href="#l193.6"></a><span id="l193.6"> /*</span>
<a href="#l193.7"></a><span id="l193.7">  * Test tabmail behaviour when tabs close.</span>
<a href="#l193.8"></a><span id="l193.8">  */</span>
<a href="#l193.9"></a><span id="l193.9"> </span>
<a href="#l193.10"></a><span id="l193.10"> &quot;use strict&quot;;</span>
<a href="#l193.11"></a><span id="l193.11"> </span>
<a href="#l193.12"></a><span id="l193.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l193.13"></a><span id="l193.13" class="difflineminus">-</span>
<a href="#l193.14"></a><span id="l193.14" class="difflineminus">-var MODULE_NAME = &quot;test-tabmail-closing&quot;;</span>
<a href="#l193.15"></a><span id="l193.15" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l193.16"></a><span id="l193.16" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;];</span>
<a href="#l193.17"></a><span id="l193.17" class="difflineplus">+var {</span>
<a href="#l193.18"></a><span id="l193.18" class="difflineplus">+  assert_equals,</span>
<a href="#l193.19"></a><span id="l193.19" class="difflineplus">+  assert_selected_tab,</span>
<a href="#l193.20"></a><span id="l193.20" class="difflineplus">+  be_in_folder,</span>
<a href="#l193.21"></a><span id="l193.21" class="difflineplus">+  collapse_all_threads,</span>
<a href="#l193.22"></a><span id="l193.22" class="difflineplus">+  create_folder,</span>
<a href="#l193.23"></a><span id="l193.23" class="difflineplus">+  make_display_threaded,</span>
<a href="#l193.24"></a><span id="l193.24" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l193.25"></a><span id="l193.25" class="difflineplus">+  mc,</span>
<a href="#l193.26"></a><span id="l193.26" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l193.27"></a><span id="l193.27" class="difflineplus">+  open_selected_messages,</span>
<a href="#l193.28"></a><span id="l193.28" class="difflineplus">+  select_click_row,</span>
<a href="#l193.29"></a><span id="l193.29" class="difflineplus">+  switch_tab,</span>
<a href="#l193.30"></a><span id="l193.30" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l193.31"></a><span id="l193.31" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l193.32"></a><span id="l193.32" class="difflineplus">+);</span>
<a href="#l193.33"></a><span id="l193.33"> </span>
<a href="#l193.34"></a><span id="l193.34"> var gFolder;</span>
<a href="#l193.35"></a><span id="l193.35"> </span>
<a href="#l193.36"></a><span id="l193.36"> var MSGS_PER_THREAD = 3;</span>
<a href="#l193.37"></a><span id="l193.37"> </span>
<a href="#l193.38"></a><span id="l193.38"> function setupModule(module) {</span>
<a href="#l193.39"></a><span id="l193.39" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l193.40"></a><span id="l193.40" class="difflineminus">-</span>
<a href="#l193.41"></a><span id="l193.41">   gFolder = create_folder(&quot;test-tabmail-closing folder&quot;);</span>
<a href="#l193.42"></a><span id="l193.42">   make_new_sets_in_folder(gFolder, [{ msgsPerThread: MSGS_PER_THREAD }]);</span>
<a href="#l193.43"></a><span id="l193.43"> }</span>
<a href="#l193.44"></a><span id="l193.44"> </span>
<a href="#l193.45"></a><span id="l193.45"> /**</span>
<a href="#l193.46"></a><span id="l193.46">  * Test that if we open up a message in a tab from the inbox tab, that</span>
<a href="#l193.47"></a><span id="l193.47">  * if we immediately close that tab, we switch back to the inbox tab.</span>
<a href="#l193.48"></a><span id="l193.48">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l194.1"></a><span id="l194.1" class="difflineminus">--- a/mail/test/mozmill/tabmail/test-tabmail-customize.js</span>
<a href="#l194.2"></a><span id="l194.2" class="difflineplus">+++ b/mail/test/mozmill/tabmail/test-tabmail-customize.js</span>
<a href="#l194.3"></a><span id="l194.3" class="difflineat">@@ -3,37 +3,36 @@</span>
<a href="#l194.4"></a><span id="l194.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l194.5"></a><span id="l194.5"> </span>
<a href="#l194.6"></a><span id="l194.6"> /*</span>
<a href="#l194.7"></a><span id="l194.7">  * Tests customization features of the tabs toolbar.</span>
<a href="#l194.8"></a><span id="l194.8">  */</span>
<a href="#l194.9"></a><span id="l194.9"> </span>
<a href="#l194.10"></a><span id="l194.10"> &quot;use strict&quot;;</span>
<a href="#l194.11"></a><span id="l194.11"> </span>
<a href="#l194.12"></a><span id="l194.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-customization-helpers.js */</span>
<a href="#l194.13"></a><span id="l194.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l194.14"></a><span id="l194.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-mouse-event-helpers.js */</span>
<a href="#l194.15"></a><span id="l194.15" class="difflineplus">+var { CustomizeDialogHelper } = ChromeUtils.import(</span>
<a href="#l194.16"></a><span id="l194.16" class="difflineplus">+  &quot;resource://testing-common/mozmill/CustomizationHelpers.jsm&quot;</span>
<a href="#l194.17"></a><span id="l194.17" class="difflineplus">+);</span>
<a href="#l194.18"></a><span id="l194.18" class="difflineplus">+var {</span>
<a href="#l194.19"></a><span id="l194.19" class="difflineplus">+  assert_equals,</span>
<a href="#l194.20"></a><span id="l194.20" class="difflineplus">+  assert_not_equals,</span>
<a href="#l194.21"></a><span id="l194.21" class="difflineplus">+  mc,</span>
<a href="#l194.22"></a><span id="l194.22" class="difflineplus">+  wait_for_popup_to_open,</span>
<a href="#l194.23"></a><span id="l194.23" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l194.24"></a><span id="l194.24" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l194.25"></a><span id="l194.25" class="difflineplus">+);</span>
<a href="#l194.26"></a><span id="l194.26" class="difflineplus">+var { drag_n_drop_element } = ChromeUtils.import(</span>
<a href="#l194.27"></a><span id="l194.27" class="difflineplus">+  &quot;resource://testing-common/mozmill/MouseEventHelpers.jsm&quot;</span>
<a href="#l194.28"></a><span id="l194.28" class="difflineplus">+);</span>
<a href="#l194.29"></a><span id="l194.29"> </span>
<a href="#l194.30"></a><span id="l194.30" class="difflineminus">-var MODULE_NAME = &quot;test-tabmail-customize&quot;;</span>
<a href="#l194.31"></a><span id="l194.31" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l194.32"></a><span id="l194.32" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l194.33"></a><span id="l194.33" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l194.34"></a><span id="l194.34" class="difflineminus">-  &quot;mouse-event-helpers&quot;,</span>
<a href="#l194.35"></a><span id="l194.35" class="difflineminus">-  &quot;customization-helpers&quot;,</span>
<a href="#l194.36"></a><span id="l194.36" class="difflineminus">-];</span>
<a href="#l194.37"></a><span id="l194.37" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l194.38"></a><span id="l194.38"> </span>
<a href="#l194.39"></a><span id="l194.39"> var gCDHelper;</span>
<a href="#l194.40"></a><span id="l194.40"> </span>
<a href="#l194.41"></a><span id="l194.41"> function setupModule(module) {</span>
<a href="#l194.42"></a><span id="l194.42" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l194.43"></a><span id="l194.43" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l194.44"></a><span id="l194.44" class="difflineminus">-  let meh = collector.getModule(&quot;mouse-event-helpers&quot;);</span>
<a href="#l194.45"></a><span id="l194.45" class="difflineminus">-  meh.installInto(module);</span>
<a href="#l194.46"></a><span id="l194.46" class="difflineminus">-  let cu = collector.getModule(&quot;customization-helpers&quot;);</span>
<a href="#l194.47"></a><span id="l194.47" class="difflineminus">-  cu.installInto(module);</span>
<a href="#l194.48"></a><span id="l194.48">   gCDHelper = new CustomizeDialogHelper(</span>
<a href="#l194.49"></a><span id="l194.49">     &quot;mail-toolbar-menubar2&quot;,</span>
<a href="#l194.50"></a><span id="l194.50">     &quot;CustomizeMailToolbar&quot;,</span>
<a href="#l194.51"></a><span id="l194.51">     &quot;mailnews:customizeToolbar&quot;</span>
<a href="#l194.52"></a><span id="l194.52">   );</span>
<a href="#l194.53"></a><span id="l194.53"> }</span>
<a href="#l194.54"></a><span id="l194.54"> </span>
<a href="#l194.55"></a><span id="l194.55"> function teardownModule(module) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l195.1"></a><span id="l195.1" class="difflineminus">--- a/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js</span>
<a href="#l195.2"></a><span id="l195.2" class="difflineplus">+++ b/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js</span>
<a href="#l195.3"></a><span id="l195.3" class="difflineat">@@ -3,47 +3,67 @@</span>
<a href="#l195.4"></a><span id="l195.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l195.5"></a><span id="l195.5"> </span>
<a href="#l195.6"></a><span id="l195.6"> &quot;use strict&quot;;</span>
<a href="#l195.7"></a><span id="l195.7"> </span>
<a href="#l195.8"></a><span id="l195.8"> /*</span>
<a href="#l195.9"></a><span id="l195.9">  * Test rearanging tabs via drag'n'drop.</span>
<a href="#l195.10"></a><span id="l195.10">  */</span>
<a href="#l195.11"></a><span id="l195.11"> </span>
<a href="#l195.12"></a><span id="l195.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l195.13"></a><span id="l195.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-mouse-event-helpers.js */</span>
<a href="#l195.14"></a><span id="l195.14" class="difflineminus">-</span>
<a href="#l195.15"></a><span id="l195.15" class="difflineminus">-var MODULE_NAME = &quot;test-tabmail-dragndrop&quot;;</span>
<a href="#l195.16"></a><span id="l195.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l195.17"></a><span id="l195.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;mouse-event-helpers&quot;];</span>
<a href="#l195.18"></a><span id="l195.18" class="difflineminus">-</span>
<a href="#l195.19"></a><span id="l195.19"> var elib = ChromeUtils.import(</span>
<a href="#l195.20"></a><span id="l195.20">   &quot;chrome://mozmill/content/modules/elementslib.jsm&quot;</span>
<a href="#l195.21"></a><span id="l195.21"> );</span>
<a href="#l195.22"></a><span id="l195.22" class="difflineplus">+var EventUtils = ChromeUtils.import(</span>
<a href="#l195.23"></a><span id="l195.23" class="difflineplus">+  &quot;chrome://mozmill/content/stdlib/EventUtils.jsm&quot;</span>
<a href="#l195.24"></a><span id="l195.24" class="difflineplus">+);</span>
<a href="#l195.25"></a><span id="l195.25"> </span>
<a href="#l195.26"></a><span id="l195.26"> var {</span>
<a href="#l195.27"></a><span id="l195.27" class="difflineplus">+  assert_equals,</span>
<a href="#l195.28"></a><span id="l195.28" class="difflineplus">+  assert_folder_selected_and_displayed,</span>
<a href="#l195.29"></a><span id="l195.29" class="difflineplus">+  assert_number_of_tabs_open,</span>
<a href="#l195.30"></a><span id="l195.30" class="difflineplus">+  assert_row_visible,</span>
<a href="#l195.31"></a><span id="l195.31" class="difflineplus">+  assert_selected_and_displayed,</span>
<a href="#l195.32"></a><span id="l195.32" class="difflineplus">+  assert_true,</span>
<a href="#l195.33"></a><span id="l195.33" class="difflineplus">+  be_in_folder,</span>
<a href="#l195.34"></a><span id="l195.34" class="difflineplus">+  close_popup,</span>
<a href="#l195.35"></a><span id="l195.35" class="difflineplus">+  create_folder,</span>
<a href="#l195.36"></a><span id="l195.36" class="difflineplus">+  display_message_in_folder_tab,</span>
<a href="#l195.37"></a><span id="l195.37" class="difflineplus">+  make_new_sets_in_folder,</span>
<a href="#l195.38"></a><span id="l195.38" class="difflineplus">+  mc,</span>
<a href="#l195.39"></a><span id="l195.39" class="difflineplus">+  open_selected_message_in_new_tab,</span>
<a href="#l195.40"></a><span id="l195.40" class="difflineplus">+  select_click_row,</span>
<a href="#l195.41"></a><span id="l195.41" class="difflineplus">+  switch_tab,</span>
<a href="#l195.42"></a><span id="l195.42" class="difflineplus">+  wait_for_message_display_completion,</span>
<a href="#l195.43"></a><span id="l195.43" class="difflineplus">+  wait_for_popup_to_open,</span>
<a href="#l195.44"></a><span id="l195.44" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l195.45"></a><span id="l195.45" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l195.46"></a><span id="l195.46" class="difflineplus">+);</span>
<a href="#l195.47"></a><span id="l195.47" class="difflineplus">+var {</span>
<a href="#l195.48"></a><span id="l195.48" class="difflineplus">+  drag_n_drop_element,</span>
<a href="#l195.49"></a><span id="l195.49" class="difflineplus">+  synthesize_drag_end,</span>
<a href="#l195.50"></a><span id="l195.50" class="difflineplus">+  synthesize_drag_start,</span>
<a href="#l195.51"></a><span id="l195.51" class="difflineplus">+  synthesize_drag_over,</span>
<a href="#l195.52"></a><span id="l195.52" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l195.53"></a><span id="l195.53" class="difflineplus">+  &quot;resource://testing-common/mozmill/MouseEventHelpers.jsm&quot;</span>
<a href="#l195.54"></a><span id="l195.54" class="difflineplus">+);</span>
<a href="#l195.55"></a><span id="l195.55" class="difflineplus">+var {</span>
<a href="#l195.56"></a><span id="l195.56">   close_window,</span>
<a href="#l195.57"></a><span id="l195.57">   plan_for_new_window,</span>
<a href="#l195.58"></a><span id="l195.58">   wait_for_new_window,</span>
<a href="#l195.59"></a><span id="l195.59"> } = ChromeUtils.import(&quot;resource://testing-common/mozmill/WindowHelpers.jsm&quot;);</span>
<a href="#l195.60"></a><span id="l195.60"> </span>
<a href="#l195.61"></a><span id="l195.61"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l195.62"></a><span id="l195.62"> </span>
<a href="#l195.63"></a><span id="l195.63"> var folder;</span>
<a href="#l195.64"></a><span id="l195.64"> var msgHdrsInFolder = [];</span>
<a href="#l195.65"></a><span id="l195.65"> </span>
<a href="#l195.66"></a><span id="l195.66"> // The number of messages in folder.</span>
<a href="#l195.67"></a><span id="l195.67"> var NUM_MESSAGES_IN_FOLDER = 15;</span>
<a href="#l195.68"></a><span id="l195.68"> </span>
<a href="#l195.69"></a><span id="l195.69"> function setupModule(module) {</span>
<a href="#l195.70"></a><span id="l195.70" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l195.71"></a><span id="l195.71" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l195.72"></a><span id="l195.72" class="difflineminus">-  let meh = collector.getModule(&quot;mouse-event-helpers&quot;);</span>
<a href="#l195.73"></a><span id="l195.73" class="difflineminus">-  meh.installInto(module);</span>
<a href="#l195.74"></a><span id="l195.74" class="difflineminus">-</span>
<a href="#l195.75"></a><span id="l195.75">   folder = create_folder(&quot;MessageFolder&quot;);</span>
<a href="#l195.76"></a><span id="l195.76">   make_new_sets_in_folder(folder, [{ count: NUM_MESSAGES_IN_FOLDER }]);</span>
<a href="#l195.77"></a><span id="l195.77"> }</span>
<a href="#l195.78"></a><span id="l195.78"> </span>
<a href="#l195.79"></a><span id="l195.79"> /**</span>
<a href="#l195.80"></a><span id="l195.80">  * Verifies our test environment is setup correctly and initializes</span>
<a href="#l195.81"></a><span id="l195.81">  * all global variables.</span>
<a href="#l195.82"></a><span id="l195.82">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l196.1"></a><span id="l196.1" class="difflineminus">--- a/mail/test/mozmill/utils/test-extensionSupport.js</span>
<a href="#l196.2"></a><span id="l196.2" class="difflineplus">+++ b/mail/test/mozmill/utils/test-extensionSupport.js</span>
<a href="#l196.3"></a><span id="l196.3" class="difflineat">@@ -1,40 +1,33 @@</span>
<a href="#l196.4"></a><span id="l196.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l196.5"></a><span id="l196.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l196.6"></a><span id="l196.6">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l196.7"></a><span id="l196.7"> </span>
<a href="#l196.8"></a><span id="l196.8"> /**</span>
<a href="#l196.9"></a><span id="l196.9">  * Tests ExtensionSupport.jsm functions.</span>
<a href="#l196.10"></a><span id="l196.10">  */</span>
<a href="#l196.11"></a><span id="l196.11"> </span>
<a href="#l196.12"></a><span id="l196.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-address-book-helpers.js */</span>
<a href="#l196.13"></a><span id="l196.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-compose-helpers.js */</span>
<a href="#l196.14"></a><span id="l196.14" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l196.15"></a><span id="l196.15" class="difflineminus">-</span>
<a href="#l196.16"></a><span id="l196.16" class="difflineminus">-var MODULE_NAME = &quot;test-extensionSupport&quot;;</span>
<a href="#l196.17"></a><span id="l196.17" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l196.18"></a><span id="l196.18" class="difflineminus">-var MODULE_REQUIRES = [</span>
<a href="#l196.19"></a><span id="l196.19" class="difflineminus">-  &quot;folder-display-helpers&quot;,</span>
<a href="#l196.20"></a><span id="l196.20" class="difflineminus">-  &quot;compose-helpers&quot;,</span>
<a href="#l196.21"></a><span id="l196.21" class="difflineminus">-  &quot;address-book-helpers&quot;,</span>
<a href="#l196.22"></a><span id="l196.22" class="difflineminus">-];</span>
<a href="#l196.23"></a><span id="l196.23" class="difflineplus">+var {</span>
<a href="#l196.24"></a><span id="l196.24" class="difflineplus">+  close_address_book_window,</span>
<a href="#l196.25"></a><span id="l196.25" class="difflineplus">+  open_address_book_window,</span>
<a href="#l196.26"></a><span id="l196.26" class="difflineplus">+} = ChromeUtils.import(</span>
<a href="#l196.27"></a><span id="l196.27" class="difflineplus">+  &quot;resource://testing-common/mozmill/AddressBookHelpers.jsm&quot;</span>
<a href="#l196.28"></a><span id="l196.28" class="difflineplus">+);</span>
<a href="#l196.29"></a><span id="l196.29" class="difflineplus">+var { close_compose_window, open_compose_new_mail } = ChromeUtils.import(</span>
<a href="#l196.30"></a><span id="l196.30" class="difflineplus">+  &quot;resource://testing-common/mozmill/ComposeHelpers.jsm&quot;</span>
<a href="#l196.31"></a><span id="l196.31" class="difflineplus">+);</span>
<a href="#l196.32"></a><span id="l196.32" class="difflineplus">+var { assert_equals, assert_false, assert_true } = ChromeUtils.import(</span>
<a href="#l196.33"></a><span id="l196.33" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l196.34"></a><span id="l196.34" class="difflineplus">+);</span>
<a href="#l196.35"></a><span id="l196.35"> </span>
<a href="#l196.36"></a><span id="l196.36"> var { ExtensionSupport } = ChromeUtils.import(</span>
<a href="#l196.37"></a><span id="l196.37">   &quot;resource:///modules/ExtensionSupport.jsm&quot;</span>
<a href="#l196.38"></a><span id="l196.38"> );</span>
<a href="#l196.39"></a><span id="l196.39"> </span>
<a href="#l196.40"></a><span id="l196.40" class="difflineminus">-function setupModule(module) {</span>
<a href="#l196.41"></a><span id="l196.41" class="difflineminus">-  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l196.42"></a><span id="l196.42" class="difflineminus">-    collector.getModule(lib).installInto(module);</span>
<a href="#l196.43"></a><span id="l196.43" class="difflineminus">-  }</span>
<a href="#l196.44"></a><span id="l196.44" class="difflineminus">-}</span>
<a href="#l196.45"></a><span id="l196.45" class="difflineminus">-</span>
<a href="#l196.46"></a><span id="l196.46" class="difflineminus">-function teardownModule(module) {}</span>
<a href="#l196.47"></a><span id="l196.47" class="difflineminus">-</span>
<a href="#l196.48"></a><span id="l196.48"> /**</span>
<a href="#l196.49"></a><span id="l196.49">  * Bug 1450288</span>
<a href="#l196.50"></a><span id="l196.50">  * Test ExtensionSupport.registerWindowListener and ExtensionSupport.unregisterWindowListener.</span>
<a href="#l196.51"></a><span id="l196.51">  */</span>
<a href="#l196.52"></a><span id="l196.52"> function test_windowListeners() {</span>
<a href="#l196.53"></a><span id="l196.53">   // There may be some pre-existing listeners already set up, e.g. mozmill ones.</span>
<a href="#l196.54"></a><span id="l196.54">   let originalListenerCount = ExtensionSupport.registeredWindowListenerCount;</span>
<a href="#l196.55"></a><span id="l196.55"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l197.1"></a><span id="l197.1" class="difflineminus">--- a/mail/test/mozmill/utils/test-iteratorUtils.js</span>
<a href="#l197.2"></a><span id="l197.2" class="difflineplus">+++ b/mail/test/mozmill/utils/test-iteratorUtils.js</span>
<a href="#l197.3"></a><span id="l197.3" class="difflineat">@@ -1,35 +1,33 @@</span>
<a href="#l197.4"></a><span id="l197.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l197.5"></a><span id="l197.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l197.6"></a><span id="l197.6">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l197.7"></a><span id="l197.7"> </span>
<a href="#l197.8"></a><span id="l197.8"> /**</span>
<a href="#l197.9"></a><span id="l197.9">  * Tests iteratorUtils with items pulled from content into chrome.</span>
<a href="#l197.10"></a><span id="l197.10">  */</span>
<a href="#l197.11"></a><span id="l197.11"> </span>
<a href="#l197.12"></a><span id="l197.12" class="difflineminus">-/* import-globals-from ../shared-modules/test-content-tab-helpers.js */</span>
<a href="#l197.13"></a><span id="l197.13" class="difflineminus">-/* import-globals-from ../shared-modules/test-folder-display-helpers.js */</span>
<a href="#l197.14"></a><span id="l197.14" class="difflineminus">-</span>
<a href="#l197.15"></a><span id="l197.15" class="difflineminus">-var MODULE_NAME = &quot;test-iteratorUtils&quot;;</span>
<a href="#l197.16"></a><span id="l197.16" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l197.17"></a><span id="l197.17" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;content-tab-helpers&quot;];</span>
<a href="#l197.18"></a><span id="l197.18" class="difflineplus">+var { open_content_tab_with_url } = ChromeUtils.import(</span>
<a href="#l197.19"></a><span id="l197.19" class="difflineplus">+  &quot;resource://testing-common/mozmill/ContentTabHelpers.jsm&quot;</span>
<a href="#l197.20"></a><span id="l197.20" class="difflineplus">+);</span>
<a href="#l197.21"></a><span id="l197.21" class="difflineplus">+var { assert_equals, close_tab } = ChromeUtils.import(</span>
<a href="#l197.22"></a><span id="l197.22" class="difflineplus">+  &quot;resource://testing-common/mozmill/FolderDisplayHelpers.jsm&quot;</span>
<a href="#l197.23"></a><span id="l197.23" class="difflineplus">+);</span>
<a href="#l197.24"></a><span id="l197.24"> </span>
<a href="#l197.25"></a><span id="l197.25"> var iteratorUtils = ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l197.26"></a><span id="l197.26" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l197.27"></a><span id="l197.27"> </span>
<a href="#l197.28"></a><span id="l197.28"> var kWhatsNewPref = &quot;mailnews.start_page.override_url&quot;;</span>
<a href="#l197.29"></a><span id="l197.29"> </span>
<a href="#l197.30"></a><span id="l197.30"> var gUrl = collector.addHttpResource(&quot;../utils/html&quot;, &quot;&quot;);</span>
<a href="#l197.31"></a><span id="l197.31"> var gCollectionsUrl = gUrl + &quot;collections.html&quot;;</span>
<a href="#l197.32"></a><span id="l197.32"> var gOriginalWhatsNew, gTab;</span>
<a href="#l197.33"></a><span id="l197.33"> </span>
<a href="#l197.34"></a><span id="l197.34"> function setupModule(module) {</span>
<a href="#l197.35"></a><span id="l197.35" class="difflineminus">-  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l197.36"></a><span id="l197.36" class="difflineminus">-  collector.getModule(&quot;content-tab-helpers&quot;).installInto(module);</span>
<a href="#l197.37"></a><span id="l197.37" class="difflineminus">-</span>
<a href="#l197.38"></a><span id="l197.38">   gOriginalWhatsNew = Services.prefs.getCharPref(kWhatsNewPref);</span>
<a href="#l197.39"></a><span id="l197.39">   Services.prefs.setCharPref(kWhatsNewPref, gCollectionsUrl);</span>
<a href="#l197.40"></a><span id="l197.40"> }</span>
<a href="#l197.41"></a><span id="l197.41"> </span>
<a href="#l197.42"></a><span id="l197.42"> function teardownModule(module) {</span>
<a href="#l197.43"></a><span id="l197.43">   Services.prefs.setCharPref(kWhatsNewPref, gOriginalWhatsNew);</span>
<a href="#l197.44"></a><span id="l197.44"> }</span>
<a href="#l197.45"></a><span id="l197.45"> </span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:31Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

