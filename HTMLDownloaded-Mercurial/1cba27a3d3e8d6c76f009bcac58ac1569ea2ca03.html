<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 24558:1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03" />
<meta property="og:url" content="/comm-central/rev/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03" />
<meta property="og:description" content="Bug 1485820 - Port bug 1484496 to C-C: Changes to use of nsISimpleEnumerator. rs=jorgk,bustage-fix CLOSED TREE" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03">shortlog</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03">files</a> |
changeset |
<a href="/comm-central/raw-rev/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03">raw</a>  | <a href="/comm-central/archive/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1485820">Bug 1485820</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1484496">bug 1484496</a> to C-C: Changes to use of nsISimpleEnumerator. rs=jorgk,bustage-fix CLOSED TREE
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#97;&#99;&#101;&#109;&#97;&#110;&#32;&#60;&#97;&#99;&#101;&#108;&#105;&#115;&#116;&#115;&#64;&#97;&#116;&#108;&#97;&#115;&#46;&#115;&#107;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 23 Aug 2018 19:01:00 +0200</td></tr>

<tr>
 <td>changeset 24558</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03">1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03</a></td>
</tr>



<tr>
<td>parent 24557</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/b786d0165808c25cb73b682b7ac948dca4ff6ab2">b786d0165808c25cb73b682b7ac948dca4ff6ab2</a>
</td>
</tr>

<tr>
<td>child 24559</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/259fe92cbdd47d3d12b910589853b2515249c32d">259fe92cbdd47d3d12b910589853b2515249c32d</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03">14780</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Fri, 24 Aug 2018 20:51:40 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@1cba27a3d3e8 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03&newProject=comm-central&newRevision=b786d0165808c25cb73b682b7ac948dca4ff6ab2&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03&newProject=comm-central&newRevision=b786d0165808c25cb73b682b7ac948dca4ff6ab2&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03&newProject=comm-central&newRevision=b786d0165808c25cb73b682b7ac948dca4ff6ab2&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28jorgk%29&revcount=50">jorgk</a>, <a href="/comm-central/log?rev=reviewer%28bustage-fix%29&revcount=50">bustage-fix</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1485820">1485820</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1484496">1484496</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1485820">Bug 1485820</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1484496">bug 1484496</a> to C-C: Changes to use of nsISimpleEnumerator. rs=jorgk,bustage-fix CLOSED TREE</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.cpp">mail/components/shell/DirectoryProvider.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.h">mail/components/shell/DirectoryProvider.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.h">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.h">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.h">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.h">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mail/components/shell/DirectoryProvider.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbBSDirectory.cpp">mailnews/addrbook/src/nsAbBSDirectory.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbBSDirectory.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbBSDirectory.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbBSDirectory.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbBSDirectory.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbBSDirectory.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbCardProperty.cpp">mailnews/addrbook/src/nsAbCardProperty.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbCardProperty.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbCardProperty.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbCardProperty.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbCardProperty.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbCardProperty.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbMDBDirectory.cpp">mailnews/addrbook/src/nsAbMDBDirectory.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbMDBDirectory.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbMDBDirectory.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbMDBDirectory.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbMDBDirectory.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAbMDBDirectory.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAddrDatabase.cpp">mailnews/addrbook/src/nsAddrDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAddrDatabase.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAddrDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAddrDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAddrDatabase.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/addrbook/src/nsAddrDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/search/src/nsMsgFilterService.cpp">mailnews/base/search/src/nsMsgFilterService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/search/src/nsMsgFilterService.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/search/src/nsMsgFilterService.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/search/src/nsMsgFilterService.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/search/src/nsMsgFilterService.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/search/src/nsMsgFilterService.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.cpp">mailnews/base/src/nsMailDirProvider.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.h">mailnews/base/src/nsMailDirProvider.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.h">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.h">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.h">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.h">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMailDirProvider.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.cpp">mailnews/base/src/nsMsgDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.h">mailnews/base/src/nsMsgDBView.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.h">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.h">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.h">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.h">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgDBView.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgGroupThread.cpp">mailnews/base/src/nsMsgGroupThread.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgGroupThread.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgGroupThread.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgGroupThread.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgGroupThread.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsMsgGroupThread.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribableServer.cpp">mailnews/base/src/nsSubscribableServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribableServer.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribableServer.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribableServer.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribableServer.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribableServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribeDataSource.cpp">mailnews/base/src/nsSubscribeDataSource.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribeDataSource.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribeDataSource.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribeDataSource.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribeDataSource.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/src/nsSubscribeDataSource.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgDBFolder.cpp">mailnews/base/util/nsMsgDBFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgDBFolder.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgDBFolder.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgDBFolder.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgDBFolder.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgDBFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgTxn.cpp">mailnews/base/util/nsMsgTxn.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgTxn.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgTxn.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgTxn.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgTxn.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/base/util/nsMsgTxn.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgCompFields.cpp">mailnews/compose/src/nsMsgCompFields.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgCompFields.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgCompFields.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgCompFields.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgCompFields.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgCompFields.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgSendLater.cpp">mailnews/compose/src/nsMsgSendLater.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgSendLater.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgSendLater.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgSendLater.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgSendLater.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsMsgSendLater.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsSmtpService.cpp">mailnews/compose/src/nsSmtpService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsSmtpService.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsSmtpService.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsSmtpService.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsSmtpService.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/compose/src/nsSmtpService.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/gloda/modules/index_msg.js">mailnews/db/gloda/modules/index_msg.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/gloda/modules/index_msg.js">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/gloda/modules/index_msg.js">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/gloda/modules/index_msg.js">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/gloda/modules/index_msg.js">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/gloda/modules/index_msg.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/public/nsMsgDatabase.h">mailnews/db/msgdb/public/nsMsgDatabase.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/public/nsMsgDatabase.h">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/public/nsMsgDatabase.h">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/public/nsMsgDatabase.h">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/public/nsMsgDatabase.h">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/public/nsMsgDatabase.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMailDatabase.cpp">mailnews/db/msgdb/src/nsMailDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMailDatabase.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMailDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMailDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMailDatabase.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMailDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgDatabase.cpp">mailnews/db/msgdb/src/nsMsgDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgDatabase.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgDatabase.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgThread.cpp">mailnews/db/msgdb/src/nsMsgThread.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgThread.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgThread.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgThread.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgThread.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/db/msgdb/src/nsMsgThread.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/imap/src/nsImapMailFolder.cpp">mailnews/imap/src/nsImapMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/imap/src/nsImapMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/imap/src/nsImapMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/imap/src/nsImapMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/imap/src/nsImapMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/imap/src/nsImapMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/local/src/nsLocalMailFolder.cpp">mailnews/local/src/nsLocalMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/local/src/nsLocalMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/local/src/nsLocalMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/local/src/nsLocalMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/local/src/nsLocalMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/local/src/nsLocalMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/news/src/nsNewsFolder.cpp">mailnews/news/src/nsNewsFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/news/src/nsNewsFolder.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/news/src/nsNewsFolder.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/news/src/nsNewsFolder.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/news/src/nsNewsFolder.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/mailnews/news/src/nsNewsFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsCompositeDataSource.cpp">rdf/base/nsCompositeDataSource.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsCompositeDataSource.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsCompositeDataSource.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsCompositeDataSource.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsCompositeDataSource.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsCompositeDataSource.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsContainerEnumerator.cpp">rdf/base/nsContainerEnumerator.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsContainerEnumerator.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsContainerEnumerator.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsContainerEnumerator.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsContainerEnumerator.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsContainerEnumerator.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsInMemoryDataSource.cpp">rdf/base/nsInMemoryDataSource.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsInMemoryDataSource.cpp">file</a> |
<a href="/comm-central/annotate/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsInMemoryDataSource.cpp">annotate</a> |
<a href="/comm-central/diff/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsInMemoryDataSource.cpp">diff</a> |
<a href="/comm-central/comparison/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsInMemoryDataSource.cpp">comparison</a> |
<a href="/comm-central/log/1cba27a3d3e8d6c76f009bcac58ac1569ea2ca03/rdf/base/nsInMemoryDataSource.cpp">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/components/shell/DirectoryProvider.cpp</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/components/shell/DirectoryProvider.cpp</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -134,24 +134,22 @@ DirectoryProvider::GetFiles(const char *</span>
<a href="#l1.4"></a><span id="l1.4">     nsCOMPtr&lt;nsIProperties&gt; dirSvc</span>
<a href="#l1.5"></a><span id="l1.5">       (do_GetService(NS_DIRECTORY_SERVICE_CONTRACTID));</span>
<a href="#l1.6"></a><span id="l1.6">     if (!dirSvc)</span>
<a href="#l1.7"></a><span id="l1.7">       return NS_ERROR_FAILURE;</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9">     nsCOMArray&lt;nsIFile&gt; distroFiles;</span>
<a href="#l1.10"></a><span id="l1.10">     AppendDistroSearchDirs(dirSvc, distroFiles);</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    return NS_NewArrayEnumerator(aResult, distroFiles);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    return NS_NewArrayEnumerator(aResult, distroFiles, NS_GET_IID(nsIFile));</span>
<a href="#l1.14"></a><span id="l1.14">   }</span>
<a href="#l1.15"></a><span id="l1.15"> </span>
<a href="#l1.16"></a><span id="l1.16">   return NS_ERROR_FAILURE;</span>
<a href="#l1.17"></a><span id="l1.17"> }</span>
<a href="#l1.18"></a><span id="l1.18"> </span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-NS_IMPL_ISUPPORTS(DirectoryProvider::AppendingEnumerator, nsISimpleEnumerator)</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-</span>
<a href="#l1.21"></a><span id="l1.21"> NS_IMETHODIMP</span>
<a href="#l1.22"></a><span id="l1.22"> DirectoryProvider::AppendingEnumerator::HasMoreElements(bool *aResult)</span>
<a href="#l1.23"></a><span id="l1.23"> {</span>
<a href="#l1.24"></a><span id="l1.24">   *aResult = mNext ? true : false;</span>
<a href="#l1.25"></a><span id="l1.25">   return NS_OK;</span>
<a href="#l1.26"></a><span id="l1.26"> }</span>
<a href="#l1.27"></a><span id="l1.27"> </span>
<a href="#l1.28"></a><span id="l1.28"> NS_IMETHODIMP</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/components/shell/DirectoryProvider.h</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/components/shell/DirectoryProvider.h</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -2,17 +2,17 @@</span>
<a href="#l2.4"></a><span id="l2.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.5"></a><span id="l2.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l2.6"></a><span id="l2.6"> </span>
<a href="#l2.7"></a><span id="l2.7"> #ifndef DirectoryProvider_h__</span>
<a href="#l2.8"></a><span id="l2.8"> #define DirectoryProvider_h__</span>
<a href="#l2.9"></a><span id="l2.9"> </span>
<a href="#l2.10"></a><span id="l2.10"> #include &quot;nsIDirectoryService.h&quot;</span>
<a href="#l2.11"></a><span id="l2.11"> #include &quot;nsComponentManagerUtils.h&quot;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-#include &quot;nsISimpleEnumerator.h&quot;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l2.14"></a><span id="l2.14"> #include &quot;nsIFile.h&quot;</span>
<a href="#l2.15"></a><span id="l2.15"> </span>
<a href="#l2.16"></a><span id="l2.16"> #define NS_MAILDIRECTORYPROVIDER_CONTRACTID \</span>
<a href="#l2.17"></a><span id="l2.17">   &quot;@mozilla.org/mail/directory-provider;1&quot;</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19"> #define NS_MAILDIRECTORYPROVIDER_CID \</span>
<a href="#l2.20"></a><span id="l2.20">   { 0xa7e8e047, 0xd36e, 0x4605, { 0xa5, 0xab, 0x1a, 0x62, 0x29, 0x03, 0x85, 0x99 }}</span>
<a href="#l2.21"></a><span id="l2.21"> </span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -31,27 +31,29 @@ public:</span>
<a href="#l2.23"></a><span id="l2.23">   NS_DECL_ISUPPORTS</span>
<a href="#l2.24"></a><span id="l2.24">   NS_DECL_NSIDIRECTORYSERVICEPROVIDER</span>
<a href="#l2.25"></a><span id="l2.25">   NS_DECL_NSIDIRECTORYSERVICEPROVIDER2</span>
<a href="#l2.26"></a><span id="l2.26"> </span>
<a href="#l2.27"></a><span id="l2.27">   DirectoryProvider() {}</span>
<a href="#l2.28"></a><span id="l2.28"> </span>
<a href="#l2.29"></a><span id="l2.29"> private:</span>
<a href="#l2.30"></a><span id="l2.30">   virtual ~DirectoryProvider() {}</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-  class AppendingEnumerator : public nsISimpleEnumerator</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+  class AppendingEnumerator : public nsSimpleEnumerator</span>
<a href="#l2.33"></a><span id="l2.33">   {</span>
<a href="#l2.34"></a><span id="l2.34">   public:</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineminus">-    NS_DECL_ISUPPORTS</span>
<a href="#l2.36"></a><span id="l2.36">     NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l2.37"></a><span id="l2.37"> </span>
<a href="#l2.38"></a><span id="l2.38" class="difflineplus">+    const nsID&amp; DefaultInterface() override</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineplus">+    {</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineplus">+      return NS_GET_IID(nsIFile);</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineplus">+    }</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineplus">+</span>
<a href="#l2.43"></a><span id="l2.43">     AppendingEnumerator(nsISimpleEnumerator* aBase,</span>
<a href="#l2.44"></a><span id="l2.44">                         char const *const *aAppendList);</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineminus">-</span>
<a href="#l2.46"></a><span id="l2.46">   private:</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineminus">-    virtual ~AppendingEnumerator() {}</span>
<a href="#l2.48"></a><span id="l2.48">     nsCOMPtr&lt;nsISimpleEnumerator&gt; mBase;</span>
<a href="#l2.49"></a><span id="l2.49">     char const *const *const      mAppendList;</span>
<a href="#l2.50"></a><span id="l2.50">     nsCOMPtr&lt;nsIFile&gt;             mNext;</span>
<a href="#l2.51"></a><span id="l2.51">   };</span>
<a href="#l2.52"></a><span id="l2.52"> };</span>
<a href="#l2.53"></a><span id="l2.53"> </span>
<a href="#l2.54"></a><span id="l2.54"> } // namespace mail</span>
<a href="#l2.55"></a><span id="l2.55"> } // namespace mozilla</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbBSDirectory.cpp</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbBSDirectory.cpp</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -88,17 +88,17 @@ nsresult nsAbBSDirectory::CreateDirector</span>
<a href="#l3.4"></a><span id="l3.4">   return NS_OK;</span>
<a href="#l3.5"></a><span id="l3.5"> }</span>
<a href="#l3.6"></a><span id="l3.6"> </span>
<a href="#l3.7"></a><span id="l3.7"> NS_IMETHODIMP nsAbBSDirectory::GetChildNodes(nsISimpleEnumerator* *aResult)</span>
<a href="#l3.8"></a><span id="l3.8"> {</span>
<a href="#l3.9"></a><span id="l3.9">   nsresult rv = EnsureInitialized();</span>
<a href="#l3.10"></a><span id="l3.10">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  return NS_NewArrayEnumerator(aResult, mSubDirectories);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+  return NS_NewArrayEnumerator(aResult, mSubDirectories, NS_GET_IID(nsIAbDirectory));</span>
<a href="#l3.14"></a><span id="l3.14"> }</span>
<a href="#l3.15"></a><span id="l3.15"> </span>
<a href="#l3.16"></a><span id="l3.16"> nsresult nsAbBSDirectory::EnsureInitialized()</span>
<a href="#l3.17"></a><span id="l3.17"> {</span>
<a href="#l3.18"></a><span id="l3.18">   if (mInitialized)</span>
<a href="#l3.19"></a><span id="l3.19">     return NS_OK;</span>
<a href="#l3.20"></a><span id="l3.20"> </span>
<a href="#l3.21"></a><span id="l3.21">   nsresult rv;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbCardProperty.cpp</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbCardProperty.cpp</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -238,17 +238,17 @@ nsAbSimpleProperty::GetValue(nsIVariant*</span>
<a href="#l4.4"></a><span id="l4.4"> </span>
<a href="#l4.5"></a><span id="l4.5"> NS_IMETHODIMP nsAbCardProperty::GetProperties(nsISimpleEnumerator **props)</span>
<a href="#l4.6"></a><span id="l4.6"> {</span>
<a href="#l4.7"></a><span id="l4.7">   nsCOMArray&lt;nsIProperty&gt; propertyArray(m_properties.Count());</span>
<a href="#l4.8"></a><span id="l4.8">   for (auto iter = m_properties.Iter(); !iter.Done(); iter.Next()) {</span>
<a href="#l4.9"></a><span id="l4.9">     propertyArray.AppendObject(new nsAbSimpleProperty(iter.Key(),</span>
<a href="#l4.10"></a><span id="l4.10">                                                       iter.UserData()));</span>
<a href="#l4.11"></a><span id="l4.11">   }</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-  return NS_NewArrayEnumerator(props, propertyArray);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+  return NS_NewArrayEnumerator(props, propertyArray, NS_GET_IID(nsIProperty));</span>
<a href="#l4.14"></a><span id="l4.14"> }</span>
<a href="#l4.15"></a><span id="l4.15"> </span>
<a href="#l4.16"></a><span id="l4.16"> NS_IMETHODIMP nsAbCardProperty::GetProperty(const nsACString &amp;name,</span>
<a href="#l4.17"></a><span id="l4.17">                                             nsIVariant *defaultValue,</span>
<a href="#l4.18"></a><span id="l4.18">                                             nsIVariant **value)</span>
<a href="#l4.19"></a><span id="l4.19"> {</span>
<a href="#l4.20"></a><span id="l4.20">   if (!m_properties.Get(name, value))</span>
<a href="#l4.21"></a><span id="l4.21">     NS_ADDREF(*value = defaultValue);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbMDBDirectory.cpp</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbMDBDirectory.cpp</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -374,17 +374,17 @@ NS_IMETHODIMP nsAbMDBDirectory::GetURI(n</span>
<a href="#l5.4"></a><span id="l5.4">   return NS_OK;</span>
<a href="#l5.5"></a><span id="l5.5"> }</span>
<a href="#l5.6"></a><span id="l5.6"> </span>
<a href="#l5.7"></a><span id="l5.7"> NS_IMETHODIMP nsAbMDBDirectory::GetChildNodes(nsISimpleEnumerator* *aResult)</span>
<a href="#l5.8"></a><span id="l5.8"> {</span>
<a href="#l5.9"></a><span id="l5.9">   if (mIsQueryURI)</span>
<a href="#l5.10"></a><span id="l5.10">     return NS_NewEmptyEnumerator(aResult);</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-  return NS_NewArrayEnumerator(aResult, mSubDirectories);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+  return NS_NewArrayEnumerator(aResult, mSubDirectories, NS_GET_IID(nsIAbDirectory));</span>
<a href="#l5.14"></a><span id="l5.14"> }</span>
<a href="#l5.15"></a><span id="l5.15"> </span>
<a href="#l5.16"></a><span id="l5.16"> NS_IMETHODIMP nsAbMDBDirectory::GetChildCards(nsISimpleEnumerator* *result)</span>
<a href="#l5.17"></a><span id="l5.17"> {</span>
<a href="#l5.18"></a><span id="l5.18">   nsresult rv;</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20">   if (mIsQueryURI)</span>
<a href="#l5.21"></a><span id="l5.21">   {</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineat">@@ -393,17 +393,17 @@ NS_IMETHODIMP nsAbMDBDirectory::GetChild</span>
<a href="#l5.23"></a><span id="l5.23"> </span>
<a href="#l5.24"></a><span id="l5.24">     // TODO</span>
<a href="#l5.25"></a><span id="l5.25">     // Search is synchronous so need to return</span>
<a href="#l5.26"></a><span id="l5.26">     // results after search is complete</span>
<a href="#l5.27"></a><span id="l5.27">     nsCOMPtr&lt;nsIMutableArray&gt; array(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l5.28"></a><span id="l5.28">     for (auto iter = mSearchCache.Iter(); !iter.Done(); iter.Next()) {</span>
<a href="#l5.29"></a><span id="l5.29">       array-&gt;AppendElement(iter.Data());</span>
<a href="#l5.30"></a><span id="l5.30">     }</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-    return NS_NewArrayEnumerator(result, array);</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+    return NS_NewArrayEnumerator(result, array, NS_GET_IID(nsIAbCard));</span>
<a href="#l5.33"></a><span id="l5.33">   }</span>
<a href="#l5.34"></a><span id="l5.34"> </span>
<a href="#l5.35"></a><span id="l5.35">   rv = GetAbDatabase();</span>
<a href="#l5.36"></a><span id="l5.36"> </span>
<a href="#l5.37"></a><span id="l5.37">   if (NS_FAILED(rv) || !mDatabase)</span>
<a href="#l5.38"></a><span id="l5.38">     return rv;</span>
<a href="#l5.39"></a><span id="l5.39"> </span>
<a href="#l5.40"></a><span id="l5.40">   return m_IsMailList ? mDatabase-&gt;EnumerateListAddresses(this, result) :</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -22,16 +22,17 @@</span>
<a href="#l6.4"></a><span id="l6.4"> #include &quot;nsIPromptService.h&quot;</span>
<a href="#l6.5"></a><span id="l6.5"> #include &quot;nsIStringBundle.h&quot;</span>
<a href="#l6.6"></a><span id="l6.6"> #include &quot;nsIFile.h&quot;</span>
<a href="#l6.7"></a><span id="l6.7"> #include &quot;nsEmbedCID.h&quot;</span>
<a href="#l6.8"></a><span id="l6.8"> #include &quot;nsIProperty.h&quot;</span>
<a href="#l6.9"></a><span id="l6.9"> #include &quot;nsIVariant.h&quot;</span>
<a href="#l6.10"></a><span id="l6.10"> #include &quot;nsCOMArray.h&quot;</span>
<a href="#l6.11"></a><span id="l6.11"> #include &quot;nsArrayEnumerator.h&quot;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l6.13"></a><span id="l6.13"> #include &quot;nsIPrefService.h&quot;</span>
<a href="#l6.14"></a><span id="l6.14"> #include &quot;nsIPrefBranch.h&quot;</span>
<a href="#l6.15"></a><span id="l6.15"> #include &quot;nsIAbManager.h&quot;</span>
<a href="#l6.16"></a><span id="l6.16"> #include &quot;mozilla/Services.h&quot;</span>
<a href="#l6.17"></a><span id="l6.17"> </span>
<a href="#l6.18"></a><span id="l6.18"> #define ID_PAB_TABLE            1</span>
<a href="#l6.19"></a><span id="l6.19"> #define ID_DELETEDCARDS_TABLE           2</span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21" class="difflineat">@@ -2295,30 +2296,35 @@ nsresult nsAddrDatabase::GetListFromDB(n</span>
<a href="#l6.22"></a><span id="l6.22">       if(NS_SUCCEEDED(err))</span>
<a href="#l6.23"></a><span id="l6.23">         dbnewList-&gt;AddAddressToList(card);</span>
<a href="#l6.24"></a><span id="l6.24">     }</span>
<a href="#l6.25"></a><span id="l6.25">   }</span>
<a href="#l6.26"></a><span id="l6.26"> </span>
<a href="#l6.27"></a><span id="l6.27">   return err;</span>
<a href="#l6.28"></a><span id="l6.28"> }</span>
<a href="#l6.29"></a><span id="l6.29"> </span>
<a href="#l6.30"></a><span id="l6.30" class="difflineminus">-class nsAddrDBEnumerator : public nsISimpleEnumerator, public nsIAddrDBListener</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineplus">+class nsAddrDBEnumerator : public nsSimpleEnumerator, public nsIAddrDBListener</span>
<a href="#l6.32"></a><span id="l6.32"> {</span>
<a href="#l6.33"></a><span id="l6.33"> public:</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineminus">-    NS_DECL_ISUPPORTS</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+    NS_DECL_ISUPPORTS_INHERITED</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+    const nsID&amp; DefaultInterface() override</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineplus">+    {</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineplus">+      return NS_GET_IID(nsIFile);</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineplus">+    }</span>
<a href="#l6.41"></a><span id="l6.41"> </span>
<a href="#l6.42"></a><span id="l6.42">     // nsISimpleEnumerator methods:</span>
<a href="#l6.43"></a><span id="l6.43">     NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l6.44"></a><span id="l6.44">     NS_DECL_NSIADDRDBLISTENER</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineplus">+</span>
<a href="#l6.46"></a><span id="l6.46">     // nsAddrDBEnumerator methods:</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineminus">-</span>
<a href="#l6.48"></a><span id="l6.48">     nsAddrDBEnumerator(nsAddrDatabase* aDb);</span>
<a href="#l6.49"></a><span id="l6.49">     void Clear();</span>
<a href="#l6.50"></a><span id="l6.50"> protected:</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineminus">-    virtual ~nsAddrDBEnumerator();</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+    ~nsAddrDBEnumerator() override;</span>
<a href="#l6.53"></a><span id="l6.53">     RefPtr&lt;nsAddrDatabase&gt; mDb;</span>
<a href="#l6.54"></a><span id="l6.54">     nsIMdbTable *mDbTable;</span>
<a href="#l6.55"></a><span id="l6.55">     nsCOMPtr&lt;nsIMdbTableRowCursor&gt; mRowCursor;</span>
<a href="#l6.56"></a><span id="l6.56">     nsCOMPtr&lt;nsIMdbRow&gt; mCurrentRow;</span>
<a href="#l6.57"></a><span id="l6.57">     mdb_pos mRowPos;</span>
<a href="#l6.58"></a><span id="l6.58"> };</span>
<a href="#l6.59"></a><span id="l6.59"> </span>
<a href="#l6.60"></a><span id="l6.60"> nsAddrDBEnumerator::nsAddrDBEnumerator(nsAddrDatabase* aDb)</span>
<a href="#l6.61"></a><span id="l6.61" class="difflineat">@@ -2339,17 +2345,17 @@ void nsAddrDBEnumerator::Clear()</span>
<a href="#l6.62"></a><span id="l6.62"> {</span>
<a href="#l6.63"></a><span id="l6.63">   mRowCursor = nullptr;</span>
<a href="#l6.64"></a><span id="l6.64">   mCurrentRow = nullptr;</span>
<a href="#l6.65"></a><span id="l6.65">   mDbTable = nullptr;</span>
<a href="#l6.66"></a><span id="l6.66">   if (mDb)</span>
<a href="#l6.67"></a><span id="l6.67">     mDb-&gt;RemoveListener(this);</span>
<a href="#l6.68"></a><span id="l6.68"> }</span>
<a href="#l6.69"></a><span id="l6.69"> </span>
<a href="#l6.70"></a><span id="l6.70" class="difflineminus">-NS_IMPL_ISUPPORTS(nsAddrDBEnumerator, nsISimpleEnumerator, nsIAddrDBListener)</span>
<a href="#l6.71"></a><span id="l6.71" class="difflineplus">+NS_IMPL_ISUPPORTS_INHERITED(nsAddrDBEnumerator, nsSimpleEnumerator, nsIAddrDBListener)</span>
<a href="#l6.72"></a><span id="l6.72"> </span>
<a href="#l6.73"></a><span id="l6.73"> NS_IMETHODIMP</span>
<a href="#l6.74"></a><span id="l6.74"> nsAddrDBEnumerator::HasMoreElements(bool *aResult)</span>
<a href="#l6.75"></a><span id="l6.75"> {</span>
<a href="#l6.76"></a><span id="l6.76">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l6.77"></a><span id="l6.77">     *aResult = false;</span>
<a href="#l6.78"></a><span id="l6.78"> </span>
<a href="#l6.79"></a><span id="l6.79">     if (!mDbTable || !mDb-&gt;GetEnv())</span>
<a href="#l6.80"></a><span id="l6.80" class="difflineat">@@ -2461,30 +2467,31 @@ NS_IMETHODIMP nsAddrDBEnumerator::OnList</span>
<a href="#l6.81"></a><span id="l6.81"> </span>
<a href="#l6.82"></a><span id="l6.82"> /* void onAnnouncerGoingAway (); */</span>
<a href="#l6.83"></a><span id="l6.83"> NS_IMETHODIMP nsAddrDBEnumerator::OnAnnouncerGoingAway()</span>
<a href="#l6.84"></a><span id="l6.84"> {</span>
<a href="#l6.85"></a><span id="l6.85">   Clear();</span>
<a href="#l6.86"></a><span id="l6.86">   return NS_OK;</span>
<a href="#l6.87"></a><span id="l6.87"> }</span>
<a href="#l6.88"></a><span id="l6.88"> </span>
<a href="#l6.89"></a><span id="l6.89" class="difflineminus">-class nsListAddressEnumerator final : public nsISimpleEnumerator</span>
<a href="#l6.90"></a><span id="l6.90" class="difflineplus">+class nsListAddressEnumerator final : public nsSimpleEnumerator</span>
<a href="#l6.91"></a><span id="l6.91"> {</span>
<a href="#l6.92"></a><span id="l6.92"> public:</span>
<a href="#l6.93"></a><span id="l6.93" class="difflineminus">-    NS_DECL_ISUPPORTS</span>
<a href="#l6.94"></a><span id="l6.94" class="difflineplus">+    const nsID&amp; DefaultInterface() override</span>
<a href="#l6.95"></a><span id="l6.95" class="difflineplus">+    {</span>
<a href="#l6.96"></a><span id="l6.96" class="difflineplus">+      return NS_GET_IID(nsIAbCard);</span>
<a href="#l6.97"></a><span id="l6.97" class="difflineplus">+    }</span>
<a href="#l6.98"></a><span id="l6.98"> </span>
<a href="#l6.99"></a><span id="l6.99">     // nsISimpleEnumerator methods:</span>
<a href="#l6.100"></a><span id="l6.100">     NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l6.101"></a><span id="l6.101"> </span>
<a href="#l6.102"></a><span id="l6.102">     // nsListAddressEnumerator methods:</span>
<a href="#l6.103"></a><span id="l6.103" class="difflineminus">-</span>
<a href="#l6.104"></a><span id="l6.104">     nsListAddressEnumerator(nsAddrDatabase* aDb, mdb_id aRowID);</span>
<a href="#l6.105"></a><span id="l6.105"> </span>
<a href="#l6.106"></a><span id="l6.106"> protected:</span>
<a href="#l6.107"></a><span id="l6.107" class="difflineminus">-    ~nsListAddressEnumerator() {}</span>
<a href="#l6.108"></a><span id="l6.108">     RefPtr&lt;nsAddrDatabase&gt; mDb;</span>
<a href="#l6.109"></a><span id="l6.109">     nsIMdbTable *mDbTable;</span>
<a href="#l6.110"></a><span id="l6.110">     nsCOMPtr&lt;nsIMdbRow&gt; mListRow;</span>
<a href="#l6.111"></a><span id="l6.111">     mdb_id mListRowID;</span>
<a href="#l6.112"></a><span id="l6.112">     uint32_t mAddressTotal;</span>
<a href="#l6.113"></a><span id="l6.113">     uint16_t mAddressPos;</span>
<a href="#l6.114"></a><span id="l6.114"> };</span>
<a href="#l6.115"></a><span id="l6.115"> </span>
<a href="#l6.116"></a><span id="l6.116" class="difflineat">@@ -2494,18 +2501,16 @@ nsListAddressEnumerator::nsListAddressEn</span>
<a href="#l6.117"></a><span id="l6.117">       mDbTable(aDb-&gt;GetPabTable()),</span>
<a href="#l6.118"></a><span id="l6.118">       mListRowID(aRowID),</span>
<a href="#l6.119"></a><span id="l6.119">       mAddressPos(0)</span>
<a href="#l6.120"></a><span id="l6.120"> {</span>
<a href="#l6.121"></a><span id="l6.121">     mDb-&gt;GetListRowByRowID(mListRowID, getter_AddRefs(mListRow));</span>
<a href="#l6.122"></a><span id="l6.122">     mAddressTotal = aDb-&gt;GetListAddressTotal(mListRow);</span>
<a href="#l6.123"></a><span id="l6.123"> }</span>
<a href="#l6.124"></a><span id="l6.124"> </span>
<a href="#l6.125"></a><span id="l6.125" class="difflineminus">-NS_IMPL_ISUPPORTS(nsListAddressEnumerator, nsISimpleEnumerator)</span>
<a href="#l6.126"></a><span id="l6.126" class="difflineminus">-</span>
<a href="#l6.127"></a><span id="l6.127"> NS_IMETHODIMP</span>
<a href="#l6.128"></a><span id="l6.128"> nsListAddressEnumerator::HasMoreElements(bool *aResult)</span>
<a href="#l6.129"></a><span id="l6.129"> {</span>
<a href="#l6.130"></a><span id="l6.130">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l6.131"></a><span id="l6.131"> </span>
<a href="#l6.132"></a><span id="l6.132">   *aResult = false;</span>
<a href="#l6.133"></a><span id="l6.133"> </span>
<a href="#l6.134"></a><span id="l6.134">   if (!mDbTable || !mDb-&gt;GetEnv())</span>
<a href="#l6.135"></a><span id="l6.135" class="difflineat">@@ -2908,17 +2913,17 @@ NS_IMETHODIMP nsAddrDatabase::GetCardsFr</span>
<a href="#l6.136"></a><span id="l6.136">       if (NS_FAILED(CreateABCard(row, 0, getter_AddRefs(card))))</span>
<a href="#l6.137"></a><span id="l6.137">         continue;</span>
<a href="#l6.138"></a><span id="l6.138">       list.AppendObject(card);</span>
<a href="#l6.139"></a><span id="l6.139">     }</span>
<a href="#l6.140"></a><span id="l6.140">     else</span>
<a href="#l6.141"></a><span id="l6.141">       done = true;</span>
<a href="#l6.142"></a><span id="l6.142">   } while (!done);</span>
<a href="#l6.143"></a><span id="l6.143"> </span>
<a href="#l6.144"></a><span id="l6.144" class="difflineminus">-  return NS_NewArrayEnumerator(cards, list);</span>
<a href="#l6.145"></a><span id="l6.145" class="difflineplus">+  return NS_NewArrayEnumerator(cards, list, NS_GET_IID(nsIAbCard));</span>
<a href="#l6.146"></a><span id="l6.146"> }</span>
<a href="#l6.147"></a><span id="l6.147"> </span>
<a href="#l6.148"></a><span id="l6.148"> NS_IMETHODIMP nsAddrDatabase::AddListDirNode(nsIMdbRow * listRow)</span>
<a href="#l6.149"></a><span id="l6.149"> {</span>
<a href="#l6.150"></a><span id="l6.150">   nsresult rv = NS_OK;</span>
<a href="#l6.151"></a><span id="l6.151"> </span>
<a href="#l6.152"></a><span id="l6.152">   nsCOMPtr&lt;nsIAbManager&gt; abManager(do_GetService(NS_ABMANAGER_CONTRACTID, &amp;rv));</span>
<a href="#l6.153"></a><span id="l6.153"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgFilterService.cpp</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgFilterService.cpp</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -918,17 +918,17 @@ NS_IMETHODIMP nsMsgFilterService::AddCus</span>
<a href="#l7.4"></a><span id="l7.4">   mCustomActions.AppendObject(aAction);</span>
<a href="#l7.5"></a><span id="l7.5">   return NS_OK;</span>
<a href="#l7.6"></a><span id="l7.6"> }</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8"> NS_IMETHODIMP nsMsgFilterService::GetCustomActions(nsISimpleEnumerator** aResult)</span>
<a href="#l7.9"></a><span id="l7.9"> {</span>
<a href="#l7.10"></a><span id="l7.10">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-  return NS_NewArrayEnumerator(aResult, mCustomActions);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+  return NS_NewArrayEnumerator(aResult, mCustomActions, NS_GET_IID(nsIMsgFilterCustomAction));</span>
<a href="#l7.14"></a><span id="l7.14"> }</span>
<a href="#l7.15"></a><span id="l7.15"> </span>
<a href="#l7.16"></a><span id="l7.16"> NS_IMETHODIMP</span>
<a href="#l7.17"></a><span id="l7.17"> nsMsgFilterService::GetCustomAction(const nsACString &amp; aId,</span>
<a href="#l7.18"></a><span id="l7.18">                                     nsIMsgFilterCustomAction** aResult)</span>
<a href="#l7.19"></a><span id="l7.19"> {</span>
<a href="#l7.20"></a><span id="l7.20">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l7.21"></a><span id="l7.21"> </span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -951,17 +951,17 @@ NS_IMETHODIMP nsMsgFilterService::AddCus</span>
<a href="#l7.23"></a><span id="l7.23">   mCustomTerms.AppendObject(aTerm);</span>
<a href="#l7.24"></a><span id="l7.24">   return NS_OK;</span>
<a href="#l7.25"></a><span id="l7.25"> }</span>
<a href="#l7.26"></a><span id="l7.26"> </span>
<a href="#l7.27"></a><span id="l7.27"> NS_IMETHODIMP nsMsgFilterService::GetCustomTerms(nsISimpleEnumerator** aResult)</span>
<a href="#l7.28"></a><span id="l7.28"> {</span>
<a href="#l7.29"></a><span id="l7.29">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l7.30"></a><span id="l7.30"> </span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-  return NS_NewArrayEnumerator(aResult, mCustomTerms);</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+  return NS_NewArrayEnumerator(aResult, mCustomTerms, NS_GET_IID(nsIMsgSearchCustomTerm));</span>
<a href="#l7.33"></a><span id="l7.33"> }</span>
<a href="#l7.34"></a><span id="l7.34"> </span>
<a href="#l7.35"></a><span id="l7.35"> NS_IMETHODIMP</span>
<a href="#l7.36"></a><span id="l7.36"> nsMsgFilterService::GetCustomTerm(const nsACString&amp; aId,</span>
<a href="#l7.37"></a><span id="l7.37">                                     nsIMsgSearchCustomTerm** aResult)</span>
<a href="#l7.38"></a><span id="l7.38"> {</span>
<a href="#l7.39"></a><span id="l7.39">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l7.40"></a><span id="l7.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/base/src/nsMailDirProvider.cpp</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/base/src/nsMailDirProvider.cpp</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -125,19 +125,16 @@ nsMailDirProvider::GetFiles(const char *</span>
<a href="#l8.4"></a><span id="l8.4"> </span>
<a href="#l8.5"></a><span id="l8.5">   rv = NS_NewUnionEnumerator(getter_AddRefs(combinedEnumerator), directoryEnumerator, extensionsEnum);</span>
<a href="#l8.6"></a><span id="l8.6">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8">   NS_ADDREF(*aResult = new AppendingEnumerator(combinedEnumerator));</span>
<a href="#l8.9"></a><span id="l8.9">   return NS_SUCCESS_AGGREGATE_RESULT;</span>
<a href="#l8.10"></a><span id="l8.10"> }</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-NS_IMPL_ISUPPORTS(nsMailDirProvider::AppendingEnumerator,</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-                   nsISimpleEnumerator)</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-</span>
<a href="#l8.15"></a><span id="l8.15"> NS_IMETHODIMP</span>
<a href="#l8.16"></a><span id="l8.16"> nsMailDirProvider::AppendingEnumerator::HasMoreElements(bool *aResult)</span>
<a href="#l8.17"></a><span id="l8.17"> {</span>
<a href="#l8.18"></a><span id="l8.18">   *aResult = mNext || mNextWithLocale ? true : false;</span>
<a href="#l8.19"></a><span id="l8.19">   return NS_OK;</span>
<a href="#l8.20"></a><span id="l8.20"> }</span>
<a href="#l8.21"></a><span id="l8.21"> </span>
<a href="#l8.22"></a><span id="l8.22"> NS_IMETHODIMP</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/src/nsMailDirProvider.h</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/src/nsMailDirProvider.h</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -2,42 +2,47 @@</span>
<a href="#l9.4"></a><span id="l9.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l9.5"></a><span id="l9.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l9.6"></a><span id="l9.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8"> #ifndef nsMailDirProvider_h__</span>
<a href="#l9.9"></a><span id="l9.9"> #define nsMailDirProvider_h__</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11"> #include &quot;nsIDirectoryService.h&quot;</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-#include &quot;nsISimpleEnumerator.h&quot;</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l9.14"></a><span id="l9.14"> #include &quot;nsString.h&quot;</span>
<a href="#l9.15"></a><span id="l9.15"> #include &quot;nsCOMPtr.h&quot;</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+#include &quot;nsIFile.h&quot;</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18"> class nsMailDirProvider final : public nsIDirectoryServiceProvider2</span>
<a href="#l9.19"></a><span id="l9.19"> {</span>
<a href="#l9.20"></a><span id="l9.20"> public:</span>
<a href="#l9.21"></a><span id="l9.21">   NS_DECL_ISUPPORTS</span>
<a href="#l9.22"></a><span id="l9.22">   NS_DECL_NSIDIRECTORYSERVICEPROVIDER</span>
<a href="#l9.23"></a><span id="l9.23">   NS_DECL_NSIDIRECTORYSERVICEPROVIDER2</span>
<a href="#l9.24"></a><span id="l9.24"> </span>
<a href="#l9.25"></a><span id="l9.25"> private:</span>
<a href="#l9.26"></a><span id="l9.26">   ~nsMailDirProvider() {}</span>
<a href="#l9.27"></a><span id="l9.27"> </span>
<a href="#l9.28"></a><span id="l9.28">   nsresult EnsureDirectory(nsIFile *aDirectory);</span>
<a href="#l9.29"></a><span id="l9.29"> </span>
<a href="#l9.30"></a><span id="l9.30" class="difflineminus">-  class AppendingEnumerator final : public nsISimpleEnumerator</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineplus">+</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+  class AppendingEnumerator final : public nsSimpleEnumerator</span>
<a href="#l9.33"></a><span id="l9.33">   {</span>
<a href="#l9.34"></a><span id="l9.34">   public:</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineminus">-    NS_DECL_ISUPPORTS</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+    const nsID&amp; DefaultInterface() override</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineplus">+    {</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineplus">+      return NS_GET_IID(nsIFile);</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineplus">+    }</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineplus">+</span>
<a href="#l9.41"></a><span id="l9.41">     NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l9.42"></a><span id="l9.42"> </span>
<a href="#l9.43"></a><span id="l9.43">     AppendingEnumerator(nsISimpleEnumerator* aBase);</span>
<a href="#l9.44"></a><span id="l9.44"> </span>
<a href="#l9.45"></a><span id="l9.45">   private:</span>
<a href="#l9.46"></a><span id="l9.46" class="difflineminus">-    ~AppendingEnumerator() {}</span>
<a href="#l9.47"></a><span id="l9.47">     nsCOMPtr&lt;nsISimpleEnumerator&gt; mBase;</span>
<a href="#l9.48"></a><span id="l9.48">     nsCOMPtr&lt;nsIFile&gt;             mNext;</span>
<a href="#l9.49"></a><span id="l9.49">     nsCOMPtr&lt;nsIFile&gt;             mNextWithLocale;</span>
<a href="#l9.50"></a><span id="l9.50">     nsCString                     mLocale;</span>
<a href="#l9.51"></a><span id="l9.51">   };</span>
<a href="#l9.52"></a><span id="l9.52"> };</span>
<a href="#l9.53"></a><span id="l9.53"> </span>
<a href="#l9.54"></a><span id="l9.54"> #endif // nsMailDirProvider_h__</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -8832,18 +8832,16 @@ nsMsgDBView::SetMRUTimeForFolder(nsIMsgF</span>
<a href="#l10.4"></a><span id="l10.4"> {</span>
<a href="#l10.5"></a><span id="l10.5">   uint32_t seconds;</span>
<a href="#l10.6"></a><span id="l10.6">   PRTime2Seconds(PR_Now(), &amp;seconds);</span>
<a href="#l10.7"></a><span id="l10.7">   nsAutoCString nowStr;</span>
<a href="#l10.8"></a><span id="l10.8">   nowStr.AppendInt(seconds);</span>
<a href="#l10.9"></a><span id="l10.9">   folder-&gt;SetStringProperty(MRU_TIME_PROPERTY, nowStr);</span>
<a href="#l10.10"></a><span id="l10.10"> }</span>
<a href="#l10.11"></a><span id="l10.11"> </span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-NS_IMPL_ISUPPORTS(nsMsgDBView::nsMsgViewHdrEnumerator, nsISimpleEnumerator)</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-</span>
<a href="#l10.14"></a><span id="l10.14"> nsMsgDBView::nsMsgViewHdrEnumerator::nsMsgViewHdrEnumerator(nsMsgDBView *view)</span>
<a href="#l10.15"></a><span id="l10.15"> {</span>
<a href="#l10.16"></a><span id="l10.16">   // We need to clone the view because the caller may clear the</span>
<a href="#l10.17"></a><span id="l10.17">   // current view immediately. It also makes it easier to expand all</span>
<a href="#l10.18"></a><span id="l10.18">   // if we're working on a copy.</span>
<a href="#l10.19"></a><span id="l10.19">   nsCOMPtr&lt;nsIMsgDBView&gt; clonedView;</span>
<a href="#l10.20"></a><span id="l10.20">   view-&gt;CloneDBView(nullptr, nullptr, nullptr, getter_AddRefs(clonedView));</span>
<a href="#l10.21"></a><span id="l10.21">   m_view = static_cast&lt;nsMsgDBView*&gt;(clonedView.get());</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/base/src/nsMsgDBView.h</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgDBView.h</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -26,16 +26,17 @@</span>
<a href="#l11.4"></a><span id="l11.4"> #include &quot;nsMsgTagService.h&quot;</span>
<a href="#l11.5"></a><span id="l11.5"> #include &quot;nsCOMArray.h&quot;</span>
<a href="#l11.6"></a><span id="l11.6"> #include &quot;nsTArray.h&quot;</span>
<a href="#l11.7"></a><span id="l11.7"> #include &quot;nsTHashtable.h&quot;</span>
<a href="#l11.8"></a><span id="l11.8"> #include &quot;nsHashKeys.h&quot;</span>
<a href="#l11.9"></a><span id="l11.9"> #include &quot;nsIMsgCustomColumnHandler.h&quot;</span>
<a href="#l11.10"></a><span id="l11.10"> #include &quot;nsAutoPtr.h&quot;</span>
<a href="#l11.11"></a><span id="l11.11"> #include &quot;nsIWeakReferenceUtils.h&quot;</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l11.13"></a><span id="l11.13"> #define MESSENGER_STRING_URL       &quot;chrome://messenger/locale/messenger.properties&quot;</span>
<a href="#l11.14"></a><span id="l11.14"> </span>
<a href="#l11.15"></a><span id="l11.15"> typedef AutoTArray&lt;nsMsgViewIndex, 1&gt; nsMsgViewIndexArray;</span>
<a href="#l11.16"></a><span id="l11.16"> static_assert(nsMsgViewIndex(nsMsgViewIndexArray::NoIndex) ==</span>
<a href="#l11.17"></a><span id="l11.17">   nsMsgViewIndex_None, &quot;These need to be the same value.&quot;);</span>
<a href="#l11.18"></a><span id="l11.18"> </span>
<a href="#l11.19"></a><span id="l11.19"> enum eFieldType {</span>
<a href="#l11.20"></a><span id="l11.20">     kCollationKey,</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineat">@@ -536,28 +537,31 @@ private:</span>
<a href="#l11.22"></a><span id="l11.22"> </span>
<a href="#l11.23"></a><span id="l11.23">   nsresult PerformActionsOnJunkMsgs(bool msgsAreJunk);</span>
<a href="#l11.24"></a><span id="l11.24">   nsresult DetermineActionsForJunkChange(bool msgsAreJunk,</span>
<a href="#l11.25"></a><span id="l11.25">                                          nsIMsgFolder *srcFolder,</span>
<a href="#l11.26"></a><span id="l11.26">                                          bool &amp;moveMessages,</span>
<a href="#l11.27"></a><span id="l11.27">                                          bool &amp;changeReadState,</span>
<a href="#l11.28"></a><span id="l11.28">                                          nsIMsgFolder** targetFolder);</span>
<a href="#l11.29"></a><span id="l11.29"> </span>
<a href="#l11.30"></a><span id="l11.30" class="difflineminus">-  class nsMsgViewHdrEnumerator final : public nsISimpleEnumerator</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineplus">+  class nsMsgViewHdrEnumerator final : public nsSimpleEnumerator</span>
<a href="#l11.32"></a><span id="l11.32">   {</span>
<a href="#l11.33"></a><span id="l11.33">   public:</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineminus">-    NS_DECL_ISUPPORTS</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineplus">+    const nsID&amp; DefaultInterface() override</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineplus">+    {</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineplus">+      return NS_GET_IID(nsIMsgDBHdr);</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineplus">+    }</span>
<a href="#l11.39"></a><span id="l11.39"> </span>
<a href="#l11.40"></a><span id="l11.40">     // nsISimpleEnumerator methods:</span>
<a href="#l11.41"></a><span id="l11.41">     NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l11.42"></a><span id="l11.42"> </span>
<a href="#l11.43"></a><span id="l11.43">     // nsMsgThreadEnumerator methods:</span>
<a href="#l11.44"></a><span id="l11.44">     nsMsgViewHdrEnumerator(nsMsgDBView *view);</span>
<a href="#l11.45"></a><span id="l11.45"> </span>
<a href="#l11.46"></a><span id="l11.46">     RefPtr&lt;nsMsgDBView&gt; m_view;</span>
<a href="#l11.47"></a><span id="l11.47">     nsMsgViewIndex m_curHdrIndex;</span>
<a href="#l11.48"></a><span id="l11.48"> </span>
<a href="#l11.49"></a><span id="l11.49">   private:</span>
<a href="#l11.50"></a><span id="l11.50" class="difflineminus">-    ~nsMsgViewHdrEnumerator();</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineplus">+    ~nsMsgViewHdrEnumerator() override;</span>
<a href="#l11.52"></a><span id="l11.52">   };</span>
<a href="#l11.53"></a><span id="l11.53"> };</span>
<a href="#l11.54"></a><span id="l11.54"> </span>
<a href="#l11.55"></a><span id="l11.55"> #endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/src/nsMsgGroupThread.cpp</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgGroupThread.cpp</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -3,16 +3,17 @@</span>
<a href="#l12.4"></a><span id="l12.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l12.5"></a><span id="l12.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l12.6"></a><span id="l12.6"> </span>
<a href="#l12.7"></a><span id="l12.7"> #include &quot;msgCore.h&quot;</span>
<a href="#l12.8"></a><span id="l12.8"> #include &quot;nsMsgGroupThread.h&quot;</span>
<a href="#l12.9"></a><span id="l12.9"> #include &quot;nsMsgDBView.h&quot;</span>
<a href="#l12.10"></a><span id="l12.10"> #include &quot;nsMsgMessageFlags.h&quot;</span>
<a href="#l12.11"></a><span id="l12.11"> #include &quot;nsMsgUtils.h&quot;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l12.13"></a><span id="l12.13"> </span>
<a href="#l12.14"></a><span id="l12.14"> NS_IMPL_ISUPPORTS(nsMsgGroupThread, nsIMsgThread)</span>
<a href="#l12.15"></a><span id="l12.15"> </span>
<a href="#l12.16"></a><span id="l12.16"> nsMsgGroupThread::nsMsgGroupThread()</span>
<a href="#l12.17"></a><span id="l12.17"> {</span>
<a href="#l12.18"></a><span id="l12.18">   Init();</span>
<a href="#l12.19"></a><span id="l12.19"> }</span>
<a href="#l12.20"></a><span id="l12.20"> </span>
<a href="#l12.21"></a><span id="l12.21" class="difflineat">@@ -320,19 +321,22 @@ nsresult nsMsgGroupThread::ReparentChild</span>
<a href="#l12.22"></a><span id="l12.22"> </span>
<a href="#l12.23"></a><span id="l12.23"> NS_IMETHODIMP nsMsgGroupThread::MarkChildRead(bool bRead)</span>
<a href="#l12.24"></a><span id="l12.24"> {</span>
<a href="#l12.25"></a><span id="l12.25">   ChangeUnreadChildCount(bRead ? -1 : 1);</span>
<a href="#l12.26"></a><span id="l12.26">   return NS_OK;</span>
<a href="#l12.27"></a><span id="l12.27"> }</span>
<a href="#l12.28"></a><span id="l12.28"> </span>
<a href="#l12.29"></a><span id="l12.29"> // this could be moved into utils, because I think it's the same as the db impl.</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineminus">-class nsMsgGroupThreadEnumerator : public nsISimpleEnumerator {</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+class nsMsgGroupThreadEnumerator : public nsSimpleEnumerator {</span>
<a href="#l12.32"></a><span id="l12.32"> public:</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineminus">-  NS_DECL_ISUPPORTS</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+  const nsID&amp; DefaultInterface() override</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineplus">+  {</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineplus">+    return NS_GET_IID(nsIMsgDBHdr);</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineplus">+  }</span>
<a href="#l12.38"></a><span id="l12.38"> </span>
<a href="#l12.39"></a><span id="l12.39">   // nsISimpleEnumerator methods:</span>
<a href="#l12.40"></a><span id="l12.40">   NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l12.41"></a><span id="l12.41"> </span>
<a href="#l12.42"></a><span id="l12.42">   // nsMsgGroupThreadEnumerator methods:</span>
<a href="#l12.43"></a><span id="l12.43">   typedef nsresult (*nsMsgGroupThreadEnumeratorFilter)(nsIMsgDBHdr* hdr, void* closure);</span>
<a href="#l12.44"></a><span id="l12.44"> </span>
<a href="#l12.45"></a><span id="l12.45">   nsMsgGroupThreadEnumerator(nsMsgGroupThread *thread, nsMsgKey startKey,</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineat">@@ -418,18 +422,16 @@ nsMsgGroupThreadEnumerator::nsMsgGroupTh</span>
<a href="#l12.47"></a><span id="l12.47">   }</span>
<a href="#l12.48"></a><span id="l12.48"> #endif</span>
<a href="#l12.49"></a><span id="l12.49"> }</span>
<a href="#l12.50"></a><span id="l12.50"> </span>
<a href="#l12.51"></a><span id="l12.51"> nsMsgGroupThreadEnumerator::~nsMsgGroupThreadEnumerator()</span>
<a href="#l12.52"></a><span id="l12.52"> {</span>
<a href="#l12.53"></a><span id="l12.53"> }</span>
<a href="#l12.54"></a><span id="l12.54"> </span>
<a href="#l12.55"></a><span id="l12.55" class="difflineminus">-NS_IMPL_ISUPPORTS(nsMsgGroupThreadEnumerator, nsISimpleEnumerator)</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineminus">-</span>
<a href="#l12.57"></a><span id="l12.57"> int32_t nsMsgGroupThreadEnumerator::MsgKeyFirstChildIndex(nsMsgKey inMsgKey)</span>
<a href="#l12.58"></a><span id="l12.58"> {</span>
<a href="#l12.59"></a><span id="l12.59">   // look through rest of thread looking for a child of this message.</span>
<a href="#l12.60"></a><span id="l12.60">   // If the inMsgKey is the first message in the thread, then all children</span>
<a href="#l12.61"></a><span id="l12.61">   // without parents are considered to be children of inMsgKey.</span>
<a href="#l12.62"></a><span id="l12.62">   // Otherwise, only true children qualify.</span>
<a href="#l12.63"></a><span id="l12.63">   uint32_t numChildren;</span>
<a href="#l12.64"></a><span id="l12.64">   nsCOMPtr&lt;nsIMsgDBHdr&gt; curHdr;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/src/nsSubscribableServer.cpp</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/src/nsSubscribableServer.cpp</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -825,17 +825,17 @@ nsSubscribableServer::GetChildren(const </span>
<a href="#l13.4"></a><span id="l13.4"> </span>
<a href="#l13.5"></a><span id="l13.5">         // todo, is this creating nsMsgFolders?</span>
<a href="#l13.6"></a><span id="l13.6">         mRDFService-&gt;GetResource(uri, getter_AddRefs(res));</span>
<a href="#l13.7"></a><span id="l13.7">         result.AppendObject(res);</span>
<a href="#l13.8"></a><span id="l13.8"> </span>
<a href="#l13.9"></a><span id="l13.9">         current = current-&gt;prevSibling;</span>
<a href="#l13.10"></a><span id="l13.10">     }</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-    return NS_NewArrayEnumerator(aResult, result);</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+    return NS_NewArrayEnumerator(aResult, result, NS_GET_IID(nsIRDFResource));</span>
<a href="#l13.14"></a><span id="l13.14"> }</span>
<a href="#l13.15"></a><span id="l13.15"> </span>
<a href="#l13.16"></a><span id="l13.16"> NS_IMETHODIMP</span>
<a href="#l13.17"></a><span id="l13.17"> nsSubscribableServer::CommitSubscribeChanges()</span>
<a href="#l13.18"></a><span id="l13.18"> {</span>
<a href="#l13.19"></a><span id="l13.19">     NS_ASSERTION(false,&quot;override this.&quot;);</span>
<a href="#l13.20"></a><span id="l13.20">     return NS_ERROR_FAILURE;</span>
<a href="#l13.21"></a><span id="l13.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/src/nsSubscribeDataSource.cpp</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/src/nsSubscribeDataSource.cpp</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -548,17 +548,17 @@ nsSubscribeDataSource::ArcLabelsOut(nsIR</span>
<a href="#l14.4"></a><span id="l14.4">     array.AppendObject(kNC_Name);</span>
<a href="#l14.5"></a><span id="l14.5">     array.AppendObject(kNC_ServerType);</span>
<a href="#l14.6"></a><span id="l14.6">     array.AppendObject(kNC_LeafName);</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8">     if (hasChildren) {</span>
<a href="#l14.9"></a><span id="l14.9">         array.AppendObject(kNC_Child);</span>
<a href="#l14.10"></a><span id="l14.10">     }</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-    return NS_NewArrayEnumerator(labels, array);</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+    return NS_NewArrayEnumerator(labels, array, NS_GET_IID(nsIRDFResource));</span>
<a href="#l14.14"></a><span id="l14.14"> }</span>
<a href="#l14.15"></a><span id="l14.15"> </span>
<a href="#l14.16"></a><span id="l14.16"> NS_IMETHODIMP</span>
<a href="#l14.17"></a><span id="l14.17"> nsSubscribeDataSource::GetAllResources(nsISimpleEnumerator** aCursor)</span>
<a href="#l14.18"></a><span id="l14.18"> {</span>
<a href="#l14.19"></a><span id="l14.19">   MOZ_ASSERT_UNREACHABLE(&quot;sorry!&quot;);</span>
<a href="#l14.20"></a><span id="l14.20">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l14.21"></a><span id="l14.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -2994,17 +2994,17 @@ nsMsgDBFolder::GetURI(nsACString&amp; name)</span>
<a href="#l15.4"></a><span id="l15.4"> typedef bool</span>
<a href="#l15.5"></a><span id="l15.5"> (*nsArrayFilter)(nsISupports* element, void* data);</span>
<a href="#l15.6"></a><span id="l15.6"> #endif</span>
<a href="#l15.7"></a><span id="l15.7"> ////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l15.8"></a><span id="l15.8"> </span>
<a href="#l15.9"></a><span id="l15.9"> NS_IMETHODIMP</span>
<a href="#l15.10"></a><span id="l15.10"> nsMsgDBFolder::GetSubFolders(nsISimpleEnumerator **aResult)</span>
<a href="#l15.11"></a><span id="l15.11"> {</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-  return aResult ? NS_NewArrayEnumerator(aResult, mSubFolders) : NS_ERROR_NULL_POINTER;</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+  return aResult ? NS_NewArrayEnumerator(aResult, mSubFolders, NS_GET_IID(nsIMsgFolder)) : NS_ERROR_NULL_POINTER;</span>
<a href="#l15.14"></a><span id="l15.14"> }</span>
<a href="#l15.15"></a><span id="l15.15"> </span>
<a href="#l15.16"></a><span id="l15.16"> NS_IMETHODIMP</span>
<a href="#l15.17"></a><span id="l15.17"> nsMsgDBFolder::FindSubFolder(const nsACString&amp; aEscapedSubFolderName, nsIMsgFolder **aFolder)</span>
<a href="#l15.18"></a><span id="l15.18"> {</span>
<a href="#l15.19"></a><span id="l15.19">   nsresult rv = NS_OK;</span>
<a href="#l15.20"></a><span id="l15.20">   nsCOMPtr&lt;nsIRDFService&gt; rdf(do_GetService(kRDFServiceCID, &amp;rv));</span>
<a href="#l15.21"></a><span id="l15.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/base/util/nsMsgTxn.cpp</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgTxn.cpp</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -113,17 +113,17 @@ NS_IMETHODIMP nsMailSimpleProperty::GetV</span>
<a href="#l16.4"></a><span id="l16.4"> NS_IMETHODIMP nsMsgTxn::GetEnumerator(nsISimpleEnumerator* *_retval)</span>
<a href="#l16.5"></a><span id="l16.5"> {</span>
<a href="#l16.6"></a><span id="l16.6">   nsCOMArray&lt;nsIProperty&gt; propertyArray;</span>
<a href="#l16.7"></a><span id="l16.7">   for (auto iter = mPropertyHash.Iter(); !iter.Done(); iter.Next()) {</span>
<a href="#l16.8"></a><span id="l16.8">     nsMailSimpleProperty *sprop = new nsMailSimpleProperty(iter.Key(),</span>
<a href="#l16.9"></a><span id="l16.9">                                                            iter.Data());</span>
<a href="#l16.10"></a><span id="l16.10">     propertyArray.AppendObject(sprop);</span>
<a href="#l16.11"></a><span id="l16.11">   }</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-  return NS_NewArrayEnumerator(_retval, propertyArray);</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+  return NS_NewArrayEnumerator(_retval, propertyArray, NS_GET_IID(nsIProperty));</span>
<a href="#l16.14"></a><span id="l16.14"> }</span>
<a href="#l16.15"></a><span id="l16.15"> </span>
<a href="#l16.16"></a><span id="l16.16"> #define IMPL_GETSETPROPERTY_AS(Name, Type) \</span>
<a href="#l16.17"></a><span id="l16.17"> NS_IMETHODIMP \</span>
<a href="#l16.18"></a><span id="l16.18"> nsMsgTxn::GetPropertyAs ## Name (const nsAString &amp; prop, Type *_retval) \</span>
<a href="#l16.19"></a><span id="l16.19"> { \</span>
<a href="#l16.20"></a><span id="l16.20">     nsIVariant* v = mPropertyHash.GetWeak(prop); \</span>
<a href="#l16.21"></a><span id="l16.21">     if (!v) \</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgCompFields.cpp</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgCompFields.cpp</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -531,17 +531,17 @@ nsresult nsMsgCompFields::SetBody(const </span>
<a href="#l17.4"></a><span id="l17.4"> const char* nsMsgCompFields::GetBody()</span>
<a href="#l17.5"></a><span id="l17.5"> {</span>
<a href="#l17.6"></a><span id="l17.6">     return m_body.get();</span>
<a href="#l17.7"></a><span id="l17.7"> }</span>
<a href="#l17.8"></a><span id="l17.8"> </span>
<a href="#l17.9"></a><span id="l17.9"> /* readonly attribute nsISimpleEnumerator attachmentsArray; */</span>
<a href="#l17.10"></a><span id="l17.10"> NS_IMETHODIMP nsMsgCompFields::GetAttachments(nsISimpleEnumerator * *aAttachmentsEnum)</span>
<a href="#l17.11"></a><span id="l17.11"> {</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-  return aAttachmentsEnum ? NS_NewArrayEnumerator(aAttachmentsEnum, m_attachments) : NS_ERROR_NULL_POINTER;</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+  return aAttachmentsEnum ? NS_NewArrayEnumerator(aAttachmentsEnum, m_attachments, NS_GET_IID(nsIMsgAttachment)) : NS_ERROR_NULL_POINTER;</span>
<a href="#l17.14"></a><span id="l17.14"> }</span>
<a href="#l17.15"></a><span id="l17.15"> </span>
<a href="#l17.16"></a><span id="l17.16"> /* void addAttachment (in nsIMsgAttachment attachment); */</span>
<a href="#l17.17"></a><span id="l17.17"> NS_IMETHODIMP nsMsgCompFields::AddAttachment(nsIMsgAttachment *attachment)</span>
<a href="#l17.18"></a><span id="l17.18"> {</span>
<a href="#l17.19"></a><span id="l17.19">   int32_t attachmentCount = m_attachments.Count();</span>
<a href="#l17.20"></a><span id="l17.20"> </span>
<a href="#l17.21"></a><span id="l17.21">   //Don't add twice the same attachment.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSendLater.cpp</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSendLater.cpp</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -807,17 +807,17 @@ nsMsgSendLater::InternalSendMessages(boo</span>
<a href="#l18.4"></a><span id="l18.4">           if (NS_SUCCEEDED(rv) &amp;&amp; !(flags &amp; nsMsgMessageFlags::Queued))</span>
<a href="#l18.5"></a><span id="l18.5">             mMessagesToSend.AppendObject(messageHeader);</span>
<a href="#l18.6"></a><span id="l18.6">         }</span>
<a href="#l18.7"></a><span id="l18.7">       }</span>
<a href="#l18.8"></a><span id="l18.8">     }</span>
<a href="#l18.9"></a><span id="l18.9">   }</span>
<a href="#l18.10"></a><span id="l18.10"> </span>
<a href="#l18.11"></a><span id="l18.11">   // Now get an enumerator for our array.</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-  rv = NS_NewArrayEnumerator(getter_AddRefs(mEnumerator), mMessagesToSend);</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+  rv = NS_NewArrayEnumerator(getter_AddRefs(mEnumerator), mMessagesToSend, NS_GET_IID(nsIMsgDBHdr));</span>
<a href="#l18.14"></a><span id="l18.14">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l18.15"></a><span id="l18.15"> </span>
<a href="#l18.16"></a><span id="l18.16">   // We're now sending messages so its time to signal that and reset our counts.</span>
<a href="#l18.17"></a><span id="l18.17">   mSendingMessages = true;</span>
<a href="#l18.18"></a><span id="l18.18">   mTotalSentSuccessfully = 0;</span>
<a href="#l18.19"></a><span id="l18.19">   mTotalSendCount = 0;</span>
<a href="#l18.20"></a><span id="l18.20"> </span>
<a href="#l18.21"></a><span id="l18.21">   // Notify the listeners that we are starting a send.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/compose/src/nsSmtpService.cpp</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/compose/src/nsSmtpService.cpp</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -380,17 +380,17 @@ nsSmtpService::GetServers(nsISimpleEnume</span>
<a href="#l19.4"></a><span id="l19.4">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l19.5"></a><span id="l19.5"> </span>
<a href="#l19.6"></a><span id="l19.6">   // now read in the servers from prefs if necessary</span>
<a href="#l19.7"></a><span id="l19.7">   uint32_t serverCount = mSmtpServers.Count();</span>
<a href="#l19.8"></a><span id="l19.8"> </span>
<a href="#l19.9"></a><span id="l19.9">   if (serverCount &lt;= 0)</span>
<a href="#l19.10"></a><span id="l19.10">     loadSmtpServers();</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-  return NS_NewArrayEnumerator(aResult, mSmtpServers);</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+  return NS_NewArrayEnumerator(aResult, mSmtpServers, NS_GET_IID(nsISmtpServer));</span>
<a href="#l19.14"></a><span id="l19.14"> }</span>
<a href="#l19.15"></a><span id="l19.15"> </span>
<a href="#l19.16"></a><span id="l19.16"> nsresult</span>
<a href="#l19.17"></a><span id="l19.17"> nsSmtpService::loadSmtpServers()</span>
<a href="#l19.18"></a><span id="l19.18"> {</span>
<a href="#l19.19"></a><span id="l19.19">   if (mSmtpServersLoaded)</span>
<a href="#l19.20"></a><span id="l19.20">     return NS_OK;</span>
<a href="#l19.21"></a><span id="l19.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mailnews/db/gloda/modules/index_msg.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/index_msg.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -1152,18 +1152,21 @@ var GlodaMsgIndexer = {</span>
<a href="#l20.4"></a><span id="l20.4">     // list of gloda id's to mark deleted</span>
<a href="#l20.5"></a><span id="l20.5">     let deleteGlodaIds = [];</span>
<a href="#l20.6"></a><span id="l20.6">     let exceptionalMessages = {};</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8">     // for GC reasons we need to track the number of headers seen</span>
<a href="#l20.9"></a><span id="l20.9">     let numHeadersSeen = 0;</span>
<a href="#l20.10"></a><span id="l20.10"> </span>
<a href="#l20.11"></a><span id="l20.11">     // We are consuming two lists; our loop structure has to reflect that.</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-    let headerIter = XPCOMUtils.IterSimpleEnumerator(this._indexingEnumerator,</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineminus">-                                                     nsIMsgDBHdr);</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineplus">+    let headerIterator = function* (aEnumerator) {</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineplus">+      while (aEnumerator.hasMoreElements())</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineplus">+        yield aEnumerator.getNext().QueryInterface(nsIMsgDBHdr);</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineplus">+    };</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineplus">+    let headerIter = headerIterator(this._indexingEnumerator);</span>
<a href="#l20.19"></a><span id="l20.19">     let mayHaveMoreGlodaMessages = true;</span>
<a href="#l20.20"></a><span id="l20.20">     let keepIterHeader = false;</span>
<a href="#l20.21"></a><span id="l20.21">     let keepGlodaTuple = false;</span>
<a href="#l20.22"></a><span id="l20.22">     let msgHdr = null;</span>
<a href="#l20.23"></a><span id="l20.23">     while (headerIter || mayHaveMoreGlodaMessages) {</span>
<a href="#l20.24"></a><span id="l20.24">       let glodaId;</span>
<a href="#l20.25"></a><span id="l20.25">       if (headerIter) {</span>
<a href="#l20.26"></a><span id="l20.26">         if (!keepIterHeader) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mailnews/db/msgdb/public/nsMsgDatabase.h</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mailnews/db/msgdb/public/nsMsgDatabase.h</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -23,16 +23,18 @@</span>
<a href="#l21.4"></a><span id="l21.4"> #include &quot;nsICollation.h&quot;</span>
<a href="#l21.5"></a><span id="l21.5"> #include &quot;nsIMsgSearchSession.h&quot;</span>
<a href="#l21.6"></a><span id="l21.6"> #include &quot;nsIMimeConverter.h&quot;</span>
<a href="#l21.7"></a><span id="l21.7"> #include &quot;nsCOMPtr.h&quot;</span>
<a href="#l21.8"></a><span id="l21.8"> #include &quot;nsCOMArray.h&quot;</span>
<a href="#l21.9"></a><span id="l21.9"> #include &quot;PLDHashTable.h&quot;</span>
<a href="#l21.10"></a><span id="l21.10"> #include &quot;nsTArray.h&quot;</span>
<a href="#l21.11"></a><span id="l21.11"> #include &quot;nsTObserverArray.h&quot;</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+</span>
<a href="#l21.14"></a><span id="l21.14"> class ListContext;</span>
<a href="#l21.15"></a><span id="l21.15"> class nsMsgKeySet;</span>
<a href="#l21.16"></a><span id="l21.16"> class nsMsgThread;</span>
<a href="#l21.17"></a><span id="l21.17"> class nsMsgDatabase;</span>
<a href="#l21.18"></a><span id="l21.18"> class nsIMsgThread;</span>
<a href="#l21.19"></a><span id="l21.19"> class nsIDBFolderInfo;</span>
<a href="#l21.20"></a><span id="l21.20"> </span>
<a href="#l21.21"></a><span id="l21.21"> const int32_t kMsgDBVersion = 1;</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineat">@@ -68,19 +70,22 @@ protected:</span>
<a href="#l21.23"></a><span id="l21.23">   void FinishDBOpen(nsIMsgFolder *aFolder, nsMsgDatabase *aMsgDB);</span>
<a href="#l21.24"></a><span id="l21.24">   nsMsgDatabase* FindInCache(nsIFile *dbName);</span>
<a href="#l21.25"></a><span id="l21.25"> </span>
<a href="#l21.26"></a><span id="l21.26">   nsCOMArray &lt;nsIMsgFolder&gt; m_foldersPendingListeners;</span>
<a href="#l21.27"></a><span id="l21.27">   nsCOMArray &lt;nsIDBChangeListener&gt; m_pendingListeners;</span>
<a href="#l21.28"></a><span id="l21.28">   AutoTArray&lt;nsMsgDatabase*, kInitialMsgDBCacheSize&gt; m_dbCache;</span>
<a href="#l21.29"></a><span id="l21.29"> };</span>
<a href="#l21.30"></a><span id="l21.30"> </span>
<a href="#l21.31"></a><span id="l21.31" class="difflineminus">-class nsMsgDBEnumerator : public nsISimpleEnumerator {</span>
<a href="#l21.32"></a><span id="l21.32" class="difflineplus">+class nsMsgDBEnumerator : public nsSimpleEnumerator {</span>
<a href="#l21.33"></a><span id="l21.33"> public:</span>
<a href="#l21.34"></a><span id="l21.34" class="difflineminus">-    NS_DECL_ISUPPORTS</span>
<a href="#l21.35"></a><span id="l21.35" class="difflineplus">+    const nsID&amp; DefaultInterface() override</span>
<a href="#l21.36"></a><span id="l21.36" class="difflineplus">+    {</span>
<a href="#l21.37"></a><span id="l21.37" class="difflineplus">+      return NS_GET_IID(nsIMsgDBHdr);</span>
<a href="#l21.38"></a><span id="l21.38" class="difflineplus">+    }</span>
<a href="#l21.39"></a><span id="l21.39"> </span>
<a href="#l21.40"></a><span id="l21.40">     // nsISimpleEnumerator methods:</span>
<a href="#l21.41"></a><span id="l21.41">     NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l21.42"></a><span id="l21.42"> </span>
<a href="#l21.43"></a><span id="l21.43">     // nsMsgDBEnumerator methods:</span>
<a href="#l21.44"></a><span id="l21.44">     typedef nsresult (*nsMsgDBEnumeratorFilter)(nsIMsgDBHdr* hdr, void* closure);</span>
<a href="#l21.45"></a><span id="l21.45"> </span>
<a href="#l21.46"></a><span id="l21.46">     nsMsgDBEnumerator(nsMsgDatabase* db, nsIMdbTable *table,</span>
<a href="#l21.47"></a><span id="l21.47" class="difflineat">@@ -100,17 +105,17 @@ public:</span>
<a href="#l21.48"></a><span id="l21.48">     nsMsgDBEnumeratorFilter         mFilter;</span>
<a href="#l21.49"></a><span id="l21.49">     nsCOMPtr &lt;nsIMdbTable&gt;          mTable;</span>
<a href="#l21.50"></a><span id="l21.50">     void*                           mClosure;</span>
<a href="#l21.51"></a><span id="l21.51">     // This is used when the caller wants to limit how many headers the</span>
<a href="#l21.52"></a><span id="l21.52">     // enumerator looks at in any given time slice.</span>
<a href="#l21.53"></a><span id="l21.53">     mdb_pos                         mStopPos;</span>
<a href="#l21.54"></a><span id="l21.54"> </span>
<a href="#l21.55"></a><span id="l21.55"> protected:</span>
<a href="#l21.56"></a><span id="l21.56" class="difflineminus">-    virtual ~nsMsgDBEnumerator();</span>
<a href="#l21.57"></a><span id="l21.57" class="difflineplus">+    ~nsMsgDBEnumerator() override;</span>
<a href="#l21.58"></a><span id="l21.58"> };</span>
<a href="#l21.59"></a><span id="l21.59"> </span>
<a href="#l21.60"></a><span id="l21.60"> class nsMsgFilteredDBEnumerator : public nsMsgDBEnumerator</span>
<a href="#l21.61"></a><span id="l21.61"> {</span>
<a href="#l21.62"></a><span id="l21.62"> public:</span>
<a href="#l21.63"></a><span id="l21.63">   nsMsgFilteredDBEnumerator(nsMsgDatabase* db, nsIMdbTable *table,</span>
<a href="#l21.64"></a><span id="l21.64">                             bool reverse, nsIArray *searchTerms);</span>
<a href="#l21.65"></a><span id="l21.65">   virtual ~nsMsgFilteredDBEnumerator();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsMailDatabase.cpp</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsMailDatabase.cpp</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -9,16 +9,17 @@</span>
<a href="#l22.4"></a><span id="l22.4"> #include &quot;nsMsgLocalFolderHdrs.h&quot;</span>
<a href="#l22.5"></a><span id="l22.5"> #include &quot;nsNetUtil.h&quot;</span>
<a href="#l22.6"></a><span id="l22.6"> #include &quot;nsMsgOfflineImapOperation.h&quot;</span>
<a href="#l22.7"></a><span id="l22.7"> #include &quot;nsMsgFolderFlags.h&quot;</span>
<a href="#l22.8"></a><span id="l22.8"> #include &quot;mozilla/Logging.h&quot;</span>
<a href="#l22.9"></a><span id="l22.9"> #include &quot;prprf.h&quot;</span>
<a href="#l22.10"></a><span id="l22.10"> #include &quot;nsMsgUtils.h&quot;</span>
<a href="#l22.11"></a><span id="l22.11"> #include &quot;nsIMsgPluggableStore.h&quot;</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l22.13"></a><span id="l22.13"> </span>
<a href="#l22.14"></a><span id="l22.14"> using namespace mozilla;</span>
<a href="#l22.15"></a><span id="l22.15"> </span>
<a href="#l22.16"></a><span id="l22.16"> extern LazyLogModule IMAPOffline; // defined in nsMsgOfflineImapOperation.cpp</span>
<a href="#l22.17"></a><span id="l22.17"> </span>
<a href="#l22.18"></a><span id="l22.18"> // scope for all offine ops table</span>
<a href="#l22.19"></a><span id="l22.19"> const char *kOfflineOpsScope = &quot;ns:msg:db:row:scope:ops:all&quot;;</span>
<a href="#l22.20"></a><span id="l22.20"> const char *kOfflineOpsTableKind = &quot;ns:msg:db:table:kind:ops&quot;;</span>
<a href="#l22.21"></a><span id="l22.21" class="difflineat">@@ -303,27 +304,30 @@ NS_IMETHODIMP nsMailDatabase::ListAllOff</span>
<a href="#l22.22"></a><span id="l22.22"> </span>
<a href="#l22.23"></a><span id="l22.23"> // This is used to remember that the db is out of sync with the mail folder</span>
<a href="#l22.24"></a><span id="l22.24"> // and needs to be regenerated.</span>
<a href="#l22.25"></a><span id="l22.25"> void nsMailDatabase::SetReparse(bool reparse)</span>
<a href="#l22.26"></a><span id="l22.26"> {</span>
<a href="#l22.27"></a><span id="l22.27">   m_reparse = reparse;</span>
<a href="#l22.28"></a><span id="l22.28"> }</span>
<a href="#l22.29"></a><span id="l22.29"> </span>
<a href="#l22.30"></a><span id="l22.30" class="difflineminus">-class nsMsgOfflineOpEnumerator : public nsISimpleEnumerator {</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineplus">+class nsMsgOfflineOpEnumerator : public nsSimpleEnumerator {</span>
<a href="#l22.32"></a><span id="l22.32"> public:</span>
<a href="#l22.33"></a><span id="l22.33" class="difflineminus">-  NS_DECL_ISUPPORTS</span>
<a href="#l22.34"></a><span id="l22.34" class="difflineplus">+  const nsID&amp; DefaultInterface() override</span>
<a href="#l22.35"></a><span id="l22.35" class="difflineplus">+  {</span>
<a href="#l22.36"></a><span id="l22.36" class="difflineplus">+    return NS_GET_IID(nsIMsgOfflineImapOperation);</span>
<a href="#l22.37"></a><span id="l22.37" class="difflineplus">+  }</span>
<a href="#l22.38"></a><span id="l22.38"> </span>
<a href="#l22.39"></a><span id="l22.39">   // nsISimpleEnumerator methods:</span>
<a href="#l22.40"></a><span id="l22.40">   NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l22.41"></a><span id="l22.41"> </span>
<a href="#l22.42"></a><span id="l22.42">   nsMsgOfflineOpEnumerator(nsMailDatabase* db);</span>
<a href="#l22.43"></a><span id="l22.43"> </span>
<a href="#l22.44"></a><span id="l22.44"> protected:</span>
<a href="#l22.45"></a><span id="l22.45" class="difflineminus">-  virtual ~nsMsgOfflineOpEnumerator();</span>
<a href="#l22.46"></a><span id="l22.46" class="difflineplus">+  ~nsMsgOfflineOpEnumerator() override;</span>
<a href="#l22.47"></a><span id="l22.47">   nsresult GetRowCursor();</span>
<a href="#l22.48"></a><span id="l22.48">   nsresult PrefetchNext();</span>
<a href="#l22.49"></a><span id="l22.49">   nsMailDatabase* mDB;</span>
<a href="#l22.50"></a><span id="l22.50">   nsIMdbTableRowCursor* mRowCursor;</span>
<a href="#l22.51"></a><span id="l22.51">   nsCOMPtr &lt;nsIMsgOfflineImapOperation&gt; mResultOp;</span>
<a href="#l22.52"></a><span id="l22.52">   bool  mDone;</span>
<a href="#l22.53"></a><span id="l22.53">   bool mNextPrefetched;</span>
<a href="#l22.54"></a><span id="l22.54"> };</span>
<a href="#l22.55"></a><span id="l22.55" class="difflineat">@@ -336,18 +340,16 @@ nsMsgOfflineOpEnumerator::nsMsgOfflineOp</span>
<a href="#l22.56"></a><span id="l22.56"> }</span>
<a href="#l22.57"></a><span id="l22.57"> </span>
<a href="#l22.58"></a><span id="l22.58"> nsMsgOfflineOpEnumerator::~nsMsgOfflineOpEnumerator()</span>
<a href="#l22.59"></a><span id="l22.59"> {</span>
<a href="#l22.60"></a><span id="l22.60">   NS_IF_RELEASE(mRowCursor);</span>
<a href="#l22.61"></a><span id="l22.61">   NS_RELEASE(mDB);</span>
<a href="#l22.62"></a><span id="l22.62"> }</span>
<a href="#l22.63"></a><span id="l22.63"> </span>
<a href="#l22.64"></a><span id="l22.64" class="difflineminus">-NS_IMPL_ISUPPORTS(nsMsgOfflineOpEnumerator, nsISimpleEnumerator)</span>
<a href="#l22.65"></a><span id="l22.65" class="difflineminus">-</span>
<a href="#l22.66"></a><span id="l22.66"> nsresult nsMsgOfflineOpEnumerator::GetRowCursor()</span>
<a href="#l22.67"></a><span id="l22.67"> {</span>
<a href="#l22.68"></a><span id="l22.68">   nsresult rv = NS_OK;</span>
<a href="#l22.69"></a><span id="l22.69">   mDone = false;</span>
<a href="#l22.70"></a><span id="l22.70"> </span>
<a href="#l22.71"></a><span id="l22.71">   if (!mDB || !mDB-&gt;m_mdbAllOfflineOpsTable)</span>
<a href="#l22.72"></a><span id="l22.72">     return NS_ERROR_NULL_POINTER;</span>
<a href="#l22.73"></a><span id="l22.73"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsMsgDatabase.cpp</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsMsgDatabase.cpp</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -33,16 +33,17 @@</span>
<a href="#l23.4"></a><span id="l23.4"> #include &quot;nsComponentManagerUtils.h&quot;</span>
<a href="#l23.5"></a><span id="l23.5"> #include &quot;nsServiceManagerUtils.h&quot;</span>
<a href="#l23.6"></a><span id="l23.6"> #include &quot;nsMemory.h&quot;</span>
<a href="#l23.7"></a><span id="l23.7"> #include &quot;nsICollation.h&quot;</span>
<a href="#l23.8"></a><span id="l23.8"> #include &quot;nsCollationCID.h&quot;</span>
<a href="#l23.9"></a><span id="l23.9"> #include &quot;nsIPrefService.h&quot;</span>
<a href="#l23.10"></a><span id="l23.10"> #include &quot;nsIPrefBranch.h&quot;</span>
<a href="#l23.11"></a><span id="l23.11"> #include &quot;nsArrayEnumerator.h&quot;</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l23.13"></a><span id="l23.13"> #include &quot;nsIMemoryReporter.h&quot;</span>
<a href="#l23.14"></a><span id="l23.14"> #include &quot;mozilla/mailnews/MimeHeaderParser.h&quot;</span>
<a href="#l23.15"></a><span id="l23.15"> #include &quot;mozilla/mailnews/Services.h&quot;</span>
<a href="#l23.16"></a><span id="l23.16"> </span>
<a href="#l23.17"></a><span id="l23.17"> using namespace mozilla::mailnews;</span>
<a href="#l23.18"></a><span id="l23.18"> using namespace mozilla;</span>
<a href="#l23.19"></a><span id="l23.19"> </span>
<a href="#l23.20"></a><span id="l23.20"> #if defined(DEBUG_sspitzer_) || defined(DEBUG_seth_)</span>
<a href="#l23.21"></a><span id="l23.21" class="difflineat">@@ -2821,18 +2822,16 @@ void nsMsgDBEnumerator::Clear()</span>
<a href="#l23.22"></a><span id="l23.22">   mRowCursor = nullptr;</span>
<a href="#l23.23"></a><span id="l23.23">   mTable = nullptr;</span>
<a href="#l23.24"></a><span id="l23.24">   mResultHdr = nullptr;</span>
<a href="#l23.25"></a><span id="l23.25">   if (mDB)</span>
<a href="#l23.26"></a><span id="l23.26">     mDB-&gt;m_enumerators.RemoveElement(this);</span>
<a href="#l23.27"></a><span id="l23.27">   mDB = nullptr;</span>
<a href="#l23.28"></a><span id="l23.28"> }</span>
<a href="#l23.29"></a><span id="l23.29"> </span>
<a href="#l23.30"></a><span id="l23.30" class="difflineminus">-NS_IMPL_ISUPPORTS(nsMsgDBEnumerator, nsISimpleEnumerator)</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineminus">-</span>
<a href="#l23.32"></a><span id="l23.32"> nsresult nsMsgDBEnumerator::GetRowCursor()</span>
<a href="#l23.33"></a><span id="l23.33"> {</span>
<a href="#l23.34"></a><span id="l23.34">   mDone = false;</span>
<a href="#l23.35"></a><span id="l23.35"> </span>
<a href="#l23.36"></a><span id="l23.36">   if (!mDB || !mTable)</span>
<a href="#l23.37"></a><span id="l23.37">     return NS_ERROR_NULL_POINTER;</span>
<a href="#l23.38"></a><span id="l23.38"> </span>
<a href="#l23.39"></a><span id="l23.39">   if (mIterateForwards)</span>
<a href="#l23.40"></a><span id="l23.40" class="difflineat">@@ -3159,33 +3158,38 @@ NS_IMETHODIMP nsMsgDatabase::ListAllKeys</span>
<a href="#l23.41"></a><span id="l23.41">         break;</span>
<a href="#l23.42"></a><span id="l23.42">       if (NS_SUCCEEDED(rv))</span>
<a href="#l23.43"></a><span id="l23.43">         aKeys-&gt;AppendElement(outOid.mOid_Id);</span>
<a href="#l23.44"></a><span id="l23.44">     }</span>
<a href="#l23.45"></a><span id="l23.45">   }</span>
<a href="#l23.46"></a><span id="l23.46">   return rv;</span>
<a href="#l23.47"></a><span id="l23.47"> }</span>
<a href="#l23.48"></a><span id="l23.48"> </span>
<a href="#l23.49"></a><span id="l23.49" class="difflineminus">-class nsMsgDBThreadEnumerator : public nsISimpleEnumerator, public nsIDBChangeListener</span>
<a href="#l23.50"></a><span id="l23.50" class="difflineplus">+class nsMsgDBThreadEnumerator : public nsSimpleEnumerator, nsIDBChangeListener</span>
<a href="#l23.51"></a><span id="l23.51"> {</span>
<a href="#l23.52"></a><span id="l23.52"> public:</span>
<a href="#l23.53"></a><span id="l23.53" class="difflineminus">-    NS_DECL_ISUPPORTS</span>
<a href="#l23.54"></a><span id="l23.54" class="difflineplus">+    NS_DECL_ISUPPORTS_INHERITED</span>
<a href="#l23.55"></a><span id="l23.55"> </span>
<a href="#l23.56"></a><span id="l23.56">     // nsISimpleEnumerator methods:</span>
<a href="#l23.57"></a><span id="l23.57">     NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l23.58"></a><span id="l23.58"> </span>
<a href="#l23.59"></a><span id="l23.59" class="difflineplus">+    const nsID&amp; DefaultInterface() override</span>
<a href="#l23.60"></a><span id="l23.60" class="difflineplus">+    {</span>
<a href="#l23.61"></a><span id="l23.61" class="difflineplus">+      return NS_GET_IID(nsIMsgThread);</span>
<a href="#l23.62"></a><span id="l23.62" class="difflineplus">+    }</span>
<a href="#l23.63"></a><span id="l23.63" class="difflineplus">+</span>
<a href="#l23.64"></a><span id="l23.64">     NS_DECL_NSIDBCHANGELISTENER</span>
<a href="#l23.65"></a><span id="l23.65"> </span>
<a href="#l23.66"></a><span id="l23.66">     // nsMsgDBEnumerator methods:</span>
<a href="#l23.67"></a><span id="l23.67">     typedef nsresult (*nsMsgDBThreadEnumeratorFilter)(nsIMsgThread* thread);</span>
<a href="#l23.68"></a><span id="l23.68"> </span>
<a href="#l23.69"></a><span id="l23.69">     nsMsgDBThreadEnumerator(nsMsgDatabase* db, nsMsgDBThreadEnumeratorFilter filter);</span>
<a href="#l23.70"></a><span id="l23.70"> </span>
<a href="#l23.71"></a><span id="l23.71"> protected:</span>
<a href="#l23.72"></a><span id="l23.72" class="difflineminus">-    virtual ~nsMsgDBThreadEnumerator();</span>
<a href="#l23.73"></a><span id="l23.73" class="difflineplus">+    ~nsMsgDBThreadEnumerator() override;</span>
<a href="#l23.74"></a><span id="l23.74">     nsresult          GetTableCursor(void);</span>
<a href="#l23.75"></a><span id="l23.75">     nsresult          PrefetchNext();</span>
<a href="#l23.76"></a><span id="l23.76">     nsMsgDatabase*    mDB;</span>
<a href="#l23.77"></a><span id="l23.77">     nsCOMPtr&lt;nsIMdbPortTableCursor&gt;  mTableCursor;</span>
<a href="#l23.78"></a><span id="l23.78">     RefPtr&lt;nsIMsgThread&gt; mResultThread;</span>
<a href="#l23.79"></a><span id="l23.79">     bool              mDone;</span>
<a href="#l23.80"></a><span id="l23.80">     bool              mNextPrefetched;</span>
<a href="#l23.81"></a><span id="l23.81">     nsMsgDBThreadEnumeratorFilter     mFilter;</span>
<a href="#l23.82"></a><span id="l23.82" class="difflineat">@@ -3203,17 +3207,17 @@ nsMsgDBThreadEnumerator::nsMsgDBThreadEn</span>
<a href="#l23.83"></a><span id="l23.83"> nsMsgDBThreadEnumerator::~nsMsgDBThreadEnumerator()</span>
<a href="#l23.84"></a><span id="l23.84"> {</span>
<a href="#l23.85"></a><span id="l23.85">   mTableCursor = nullptr;</span>
<a href="#l23.86"></a><span id="l23.86">   mResultThread = nullptr;</span>
<a href="#l23.87"></a><span id="l23.87">   if (mDB)</span>
<a href="#l23.88"></a><span id="l23.88">     mDB-&gt;RemoveListener(this);</span>
<a href="#l23.89"></a><span id="l23.89"> }</span>
<a href="#l23.90"></a><span id="l23.90"> </span>
<a href="#l23.91"></a><span id="l23.91" class="difflineminus">-NS_IMPL_ISUPPORTS(nsMsgDBThreadEnumerator, nsISimpleEnumerator, nsIDBChangeListener)</span>
<a href="#l23.92"></a><span id="l23.92" class="difflineplus">+NS_IMPL_ISUPPORTS_INHERITED(nsMsgDBThreadEnumerator, nsSimpleEnumerator, nsIDBChangeListener)</span>
<a href="#l23.93"></a><span id="l23.93"> </span>
<a href="#l23.94"></a><span id="l23.94"> </span>
<a href="#l23.95"></a><span id="l23.95"> /* void OnHdrFlagsChanged (in nsIMsgDBHdr aHdrChanged, in unsigned long aOldFlags, in unsigned long aNewFlags, in nsIDBChangeListener aInstigator); */</span>
<a href="#l23.96"></a><span id="l23.96"> NS_IMETHODIMP nsMsgDBThreadEnumerator::OnHdrFlagsChanged(nsIMsgDBHdr *aHdrChanged, uint32_t aOldFlags, uint32_t aNewFlags, nsIDBChangeListener *aInstigator)</span>
<a href="#l23.97"></a><span id="l23.97"> {</span>
<a href="#l23.98"></a><span id="l23.98">     return NS_OK;</span>
<a href="#l23.99"></a><span id="l23.99"> }</span>
<a href="#l23.100"></a><span id="l23.100"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsMsgThread.cpp</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsMsgThread.cpp</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -2,16 +2,17 @@</span>
<a href="#l24.4"></a><span id="l24.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l24.5"></a><span id="l24.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l24.6"></a><span id="l24.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l24.7"></a><span id="l24.7"> </span>
<a href="#l24.8"></a><span id="l24.8"> #include &quot;msgCore.h&quot;</span>
<a href="#l24.9"></a><span id="l24.9"> #include &quot;nsMsgDatabase.h&quot;</span>
<a href="#l24.10"></a><span id="l24.10"> #include &quot;nsCOMPtr.h&quot;</span>
<a href="#l24.11"></a><span id="l24.11"> #include &quot;nsMsgThread.h&quot;</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l24.13"></a><span id="l24.13"> #include &quot;MailNewsTypes2.h&quot;</span>
<a href="#l24.14"></a><span id="l24.14"> #include &quot;mozilla/DebugOnly.h&quot;</span>
<a href="#l24.15"></a><span id="l24.15"> </span>
<a href="#l24.16"></a><span id="l24.16"> NS_IMPL_ISUPPORTS(nsMsgThread, nsIMsgThread)</span>
<a href="#l24.17"></a><span id="l24.17"> </span>
<a href="#l24.18"></a><span id="l24.18"> nsMsgThread::nsMsgThread()</span>
<a href="#l24.19"></a><span id="l24.19"> {</span>
<a href="#l24.20"></a><span id="l24.20">   Init();</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineat">@@ -584,37 +585,38 @@ nsresult nsMsgThread::ReparentChildrenOf</span>
<a href="#l24.22"></a><span id="l24.22"> }</span>
<a href="#l24.23"></a><span id="l24.23"> </span>
<a href="#l24.24"></a><span id="l24.24"> NS_IMETHODIMP nsMsgThread::MarkChildRead(bool bRead)</span>
<a href="#l24.25"></a><span id="l24.25"> {</span>
<a href="#l24.26"></a><span id="l24.26">   ChangeUnreadChildCount(bRead ? -1 : 1);</span>
<a href="#l24.27"></a><span id="l24.27">   return NS_OK;</span>
<a href="#l24.28"></a><span id="l24.28"> }</span>
<a href="#l24.29"></a><span id="l24.29"> </span>
<a href="#l24.30"></a><span id="l24.30" class="difflineminus">-class nsMsgThreadEnumerator : public nsISimpleEnumerator {</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineplus">+class nsMsgThreadEnumerator : public nsSimpleEnumerator {</span>
<a href="#l24.32"></a><span id="l24.32"> public:</span>
<a href="#l24.33"></a><span id="l24.33" class="difflineminus">-  NS_DECL_ISUPPORTS</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineplus">+  const nsID&amp; DefaultInterface() override</span>
<a href="#l24.35"></a><span id="l24.35" class="difflineplus">+  {</span>
<a href="#l24.36"></a><span id="l24.36" class="difflineplus">+    return NS_GET_IID(nsIMsgDBHdr);</span>
<a href="#l24.37"></a><span id="l24.37" class="difflineplus">+  }</span>
<a href="#l24.38"></a><span id="l24.38"> </span>
<a href="#l24.39"></a><span id="l24.39">   // nsISimpleEnumerator methods:</span>
<a href="#l24.40"></a><span id="l24.40">   NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l24.41"></a><span id="l24.41"> </span>
<a href="#l24.42"></a><span id="l24.42">   // nsMsgThreadEnumerator methods:</span>
<a href="#l24.43"></a><span id="l24.43">   typedef nsresult (*nsMsgThreadEnumeratorFilter)(nsIMsgDBHdr* hdr, void* closure);</span>
<a href="#l24.44"></a><span id="l24.44"> </span>
<a href="#l24.45"></a><span id="l24.45">   nsMsgThreadEnumerator(nsMsgThread *thread, nsMsgKey startKey,</span>
<a href="#l24.46"></a><span id="l24.46">   nsMsgThreadEnumeratorFilter filter, void* closure);</span>
<a href="#l24.47"></a><span id="l24.47">   int32_t MsgKeyFirstChildIndex(nsMsgKey inMsgKey);</span>
<a href="#l24.48"></a><span id="l24.48"> </span>
<a href="#l24.49"></a><span id="l24.49"> protected:</span>
<a href="#l24.50"></a><span id="l24.50" class="difflineminus">-  virtual ~nsMsgThreadEnumerator();</span>
<a href="#l24.51"></a><span id="l24.51" class="difflineminus">-</span>
<a href="#l24.52"></a><span id="l24.52">   nsresult                Prefetch();</span>
<a href="#l24.53"></a><span id="l24.53"> </span>
<a href="#l24.54"></a><span id="l24.54">   nsIMdbTableRowCursor*   mRowCursor;</span>
<a href="#l24.55"></a><span id="l24.55" class="difflineminus">-  nsCOMPtr&lt;nsIMsgDBHdr&gt;  mResultHdr;</span>
<a href="#l24.56"></a><span id="l24.56" class="difflineplus">+  nsCOMPtr&lt;nsIMsgDBHdr&gt;   mResultHdr;</span>
<a href="#l24.57"></a><span id="l24.57">   RefPtr&lt;nsMsgThread&gt;     mThread;</span>
<a href="#l24.58"></a><span id="l24.58">   nsMsgKey                mThreadParentKey;</span>
<a href="#l24.59"></a><span id="l24.59">   nsMsgKey                mFirstMsgKey;</span>
<a href="#l24.60"></a><span id="l24.60">   int32_t                 mChildIndex;</span>
<a href="#l24.61"></a><span id="l24.61">   bool                    mDone;</span>
<a href="#l24.62"></a><span id="l24.62">   bool                    mNeedToPrefetch;</span>
<a href="#l24.63"></a><span id="l24.63">   nsMsgThreadEnumeratorFilter     mFilter;</span>
<a href="#l24.64"></a><span id="l24.64">   void*                   mClosure;</span>
<a href="#l24.65"></a><span id="l24.65" class="difflineat">@@ -681,22 +683,16 @@ nsMsgThreadEnumerator::nsMsgThreadEnumer</span>
<a href="#l24.66"></a><span id="l24.66">       child-&gt;GetThreadParent(&amp;threadParent);</span>
<a href="#l24.67"></a><span id="l24.67"> </span>
<a href="#l24.68"></a><span id="l24.68">       printf(&quot;index = %ld key = %ld parent = %lx\n&quot;, childIndex, msgKey, threadParent);</span>
<a href="#l24.69"></a><span id="l24.69">     }</span>
<a href="#l24.70"></a><span id="l24.70">   }</span>
<a href="#l24.71"></a><span id="l24.71"> #endif</span>
<a href="#l24.72"></a><span id="l24.72"> }</span>
<a href="#l24.73"></a><span id="l24.73"> </span>
<a href="#l24.74"></a><span id="l24.74" class="difflineminus">-nsMsgThreadEnumerator::~nsMsgThreadEnumerator()</span>
<a href="#l24.75"></a><span id="l24.75" class="difflineminus">-{</span>
<a href="#l24.76"></a><span id="l24.76" class="difflineminus">-}</span>
<a href="#l24.77"></a><span id="l24.77" class="difflineminus">-</span>
<a href="#l24.78"></a><span id="l24.78" class="difflineminus">-NS_IMPL_ISUPPORTS(nsMsgThreadEnumerator, nsISimpleEnumerator)</span>
<a href="#l24.79"></a><span id="l24.79" class="difflineminus">-</span>
<a href="#l24.80"></a><span id="l24.80"> int32_t nsMsgThreadEnumerator::MsgKeyFirstChildIndex(nsMsgKey inMsgKey)</span>
<a href="#l24.81"></a><span id="l24.81"> {</span>
<a href="#l24.82"></a><span id="l24.82">   // if (msgKey != mThreadParentKey)</span>
<a href="#l24.83"></a><span id="l24.83">   //   mDone = true;</span>
<a href="#l24.84"></a><span id="l24.84">   // look through rest of thread looking for a child of this message.</span>
<a href="#l24.85"></a><span id="l24.85">   // If the inMsgKey is the first message in the thread, then all children</span>
<a href="#l24.86"></a><span id="l24.86">   // without parents are considered to be children of inMsgKey.</span>
<a href="#l24.87"></a><span id="l24.87">   // Otherwise, only true children qualify.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -568,17 +568,17 @@ NS_IMETHODIMP nsImapMailFolder::GetSubFo</span>
<a href="#l25.4"></a><span id="l25.4">     nsCOMPtr&lt;nsISimpleEnumerator&gt; dummy;</span>
<a href="#l25.5"></a><span id="l25.5">     for (int32_t i = 0; i &lt; count; i++)</span>
<a href="#l25.6"></a><span id="l25.6">       mSubFolders[i]-&gt;GetSubFolders(getter_AddRefs(dummy));</span>
<a href="#l25.7"></a><span id="l25.7"> </span>
<a href="#l25.8"></a><span id="l25.8">     UpdateSummaryTotals(false);</span>
<a href="#l25.9"></a><span id="l25.9">     if (NS_FAILED(rv)) return rv;</span>
<a href="#l25.10"></a><span id="l25.10">   }</span>
<a href="#l25.11"></a><span id="l25.11"> </span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-  return aResult ? NS_NewArrayEnumerator(aResult, mSubFolders) : NS_ERROR_NULL_POINTER;</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+  return aResult ? NS_NewArrayEnumerator(aResult, mSubFolders, NS_GET_IID(nsIMsgFolder)) : NS_ERROR_NULL_POINTER;</span>
<a href="#l25.14"></a><span id="l25.14"> }</span>
<a href="#l25.15"></a><span id="l25.15"> </span>
<a href="#l25.16"></a><span id="l25.16"> //Makes sure the database is open and exists.  If the database is valid then</span>
<a href="#l25.17"></a><span id="l25.17"> //returns NS_OK.  Otherwise returns a failure error value.</span>
<a href="#l25.18"></a><span id="l25.18"> nsresult nsImapMailFolder::GetDatabase()</span>
<a href="#l25.19"></a><span id="l25.19"> {</span>
<a href="#l25.20"></a><span id="l25.20">   nsresult rv = NS_OK;</span>
<a href="#l25.21"></a><span id="l25.21">   if (!mDatabase)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mailnews/local/src/nsLocalMailFolder.cpp</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mailnews/local/src/nsLocalMailFolder.cpp</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -250,17 +250,17 @@ nsMsgLocalMailFolder::GetSubFolders(nsIS</span>
<a href="#l26.4"></a><span id="l26.4">         rv = localMailServer-&gt;SetFlagsOnDefaultMailboxes();</span>
<a href="#l26.5"></a><span id="l26.5">         if (NS_FAILED(rv))</span>
<a href="#l26.6"></a><span id="l26.6">           return rv;</span>
<a href="#l26.7"></a><span id="l26.7">       }</span>
<a href="#l26.8"></a><span id="l26.8">     }</span>
<a href="#l26.9"></a><span id="l26.9">     UpdateSummaryTotals(false);</span>
<a href="#l26.10"></a><span id="l26.10">   }</span>
<a href="#l26.11"></a><span id="l26.11"> </span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-  return aResult ? NS_NewArrayEnumerator(aResult, mSubFolders) : NS_ERROR_NULL_POINTER;</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+  return aResult ? NS_NewArrayEnumerator(aResult, mSubFolders, NS_GET_IID(nsIMsgFolder)) : NS_ERROR_NULL_POINTER;</span>
<a href="#l26.14"></a><span id="l26.14"> }</span>
<a href="#l26.15"></a><span id="l26.15"> </span>
<a href="#l26.16"></a><span id="l26.16"> nsresult nsMsgLocalMailFolder::GetDatabase()</span>
<a href="#l26.17"></a><span id="l26.17"> {</span>
<a href="#l26.18"></a><span id="l26.18">   nsCOMPtr &lt;nsIMsgDatabase&gt; msgDB;</span>
<a href="#l26.19"></a><span id="l26.19">   return GetDatabaseWOReparse(getter_AddRefs(msgDB));</span>
<a href="#l26.20"></a><span id="l26.20"> }</span>
<a href="#l26.21"></a><span id="l26.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mailnews/news/src/nsNewsFolder.cpp</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mailnews/news/src/nsNewsFolder.cpp</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -235,17 +235,17 @@ nsMsgNewsFolder::GetSubFolders(nsISimple</span>
<a href="#l27.4"></a><span id="l27.4">     if (NS_FAILED(rv)) return rv;</span>
<a href="#l27.5"></a><span id="l27.5"> </span>
<a href="#l27.6"></a><span id="l27.6">     // force ourselves to get initialized from cache</span>
<a href="#l27.7"></a><span id="l27.7">     // Don't care if it fails.  this will fail the first time after</span>
<a href="#l27.8"></a><span id="l27.8">     // migration, but we continue on.  see #66018</span>
<a href="#l27.9"></a><span id="l27.9">     (void)UpdateSummaryTotals(false);</span>
<a href="#l27.10"></a><span id="l27.10">   }</span>
<a href="#l27.11"></a><span id="l27.11"> </span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-  return aResult ? NS_NewArrayEnumerator(aResult, mSubFolders) : NS_ERROR_NULL_POINTER;</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+  return aResult ? NS_NewArrayEnumerator(aResult, mSubFolders, NS_GET_IID(nsIMsgFolder)) : NS_ERROR_NULL_POINTER;</span>
<a href="#l27.14"></a><span id="l27.14"> }</span>
<a href="#l27.15"></a><span id="l27.15"> </span>
<a href="#l27.16"></a><span id="l27.16"> //Makes sure the database is open and exists.  If the database is valid then</span>
<a href="#l27.17"></a><span id="l27.17"> //returns NS_OK.  Otherwise returns a failure error value.</span>
<a href="#l27.18"></a><span id="l27.18"> nsresult nsMsgNewsFolder::GetDatabase()</span>
<a href="#l27.19"></a><span id="l27.19"> {</span>
<a href="#l27.20"></a><span id="l27.20">   nsresult rv;</span>
<a href="#l27.21"></a><span id="l27.21">   if (!mDatabase)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/rdf/base/nsCompositeDataSource.cpp</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/rdf/base/nsCompositeDataSource.cpp</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -31,16 +31,17 @@</span>
<a href="#l28.4"></a><span id="l28.4"> #include &quot;nsIComponentManager.h&quot;</span>
<a href="#l28.5"></a><span id="l28.5"> #include &quot;nsIRDFCompositeDataSource.h&quot;</span>
<a href="#l28.6"></a><span id="l28.6"> #include &quot;nsIRDFNode.h&quot;</span>
<a href="#l28.7"></a><span id="l28.7"> #include &quot;nsIRDFObserver.h&quot;</span>
<a href="#l28.8"></a><span id="l28.8"> #include &quot;nsIRDFRemoteDataSource.h&quot;</span>
<a href="#l28.9"></a><span id="l28.9"> #include &quot;nsTArray.h&quot;</span>
<a href="#l28.10"></a><span id="l28.10"> #include &quot;nsCOMArray.h&quot;</span>
<a href="#l28.11"></a><span id="l28.11"> #include &quot;nsArrayEnumerator.h&quot;</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l28.13"></a><span id="l28.13"> #include &quot;nsString.h&quot;</span>
<a href="#l28.14"></a><span id="l28.14"> #include &quot;rdf.h&quot;</span>
<a href="#l28.15"></a><span id="l28.15"> #include &quot;nsCycleCollectionParticipant.h&quot;</span>
<a href="#l28.16"></a><span id="l28.16"> </span>
<a href="#l28.17"></a><span id="l28.17"> #include &quot;nsEnumeratorUtils.h&quot;</span>
<a href="#l28.18"></a><span id="l28.18"> </span>
<a href="#l28.19"></a><span id="l28.19"> #include &quot;mozilla/Logging.h&quot;</span>
<a href="#l28.20"></a><span id="l28.20"> #include &lt;stdio.h&gt;</span>
<a href="#l28.21"></a><span id="l28.21" class="difflineat">@@ -96,37 +97,39 @@ protected:</span>
<a href="#l28.22"></a><span id="l28.22">     friend class CompositeAssertionEnumeratorImpl;</span>
<a href="#l28.23"></a><span id="l28.23"> };</span>
<a href="#l28.24"></a><span id="l28.24"> </span>
<a href="#l28.25"></a><span id="l28.25"> //----------------------------------------------------------------------</span>
<a href="#l28.26"></a><span id="l28.26"> //</span>
<a href="#l28.27"></a><span id="l28.27"> // CompositeEnumeratorImpl</span>
<a href="#l28.28"></a><span id="l28.28"> //</span>
<a href="#l28.29"></a><span id="l28.29"> </span>
<a href="#l28.30"></a><span id="l28.30" class="difflineminus">-class CompositeEnumeratorImpl : public nsISimpleEnumerator</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineplus">+class CompositeEnumeratorImpl : public nsSimpleEnumerator</span>
<a href="#l28.32"></a><span id="l28.32"> {</span>
<a href="#l28.33"></a><span id="l28.33" class="difflineminus">-    // nsISupports</span>
<a href="#l28.34"></a><span id="l28.34" class="difflineminus">-    NS_DECL_ISUPPORTS</span>
<a href="#l28.35"></a><span id="l28.35" class="difflineplus">+    const nsID&amp; DefaultInterface() override</span>
<a href="#l28.36"></a><span id="l28.36" class="difflineplus">+    {</span>
<a href="#l28.37"></a><span id="l28.37" class="difflineplus">+      return NS_GET_IID(nsIRDFNode);</span>
<a href="#l28.38"></a><span id="l28.38" class="difflineplus">+    }</span>
<a href="#l28.39"></a><span id="l28.39"> </span>
<a href="#l28.40"></a><span id="l28.40">     // nsISimpleEnumerator interface</span>
<a href="#l28.41"></a><span id="l28.41">     NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l28.42"></a><span id="l28.42"> </span>
<a href="#l28.43"></a><span id="l28.43">     // pure abstract methods to be overridden</span>
<a href="#l28.44"></a><span id="l28.44">     virtual nsresult</span>
<a href="#l28.45"></a><span id="l28.45">     GetEnumerator(nsIRDFDataSource* aDataSource, nsISimpleEnumerator** aResult) = 0;</span>
<a href="#l28.46"></a><span id="l28.46"> </span>
<a href="#l28.47"></a><span id="l28.47">     virtual nsresult</span>
<a href="#l28.48"></a><span id="l28.48">     HasNegation(nsIRDFDataSource* aDataSource, nsIRDFNode* aNode, bool* aResult) = 0;</span>
<a href="#l28.49"></a><span id="l28.49"> </span>
<a href="#l28.50"></a><span id="l28.50"> protected:</span>
<a href="#l28.51"></a><span id="l28.51">     CompositeEnumeratorImpl(CompositeDataSourceImpl* aCompositeDataSource,</span>
<a href="#l28.52"></a><span id="l28.52">                             bool aAllowNegativeAssertions,</span>
<a href="#l28.53"></a><span id="l28.53">                             bool aCoalesceDuplicateArcs);</span>
<a href="#l28.54"></a><span id="l28.54"> </span>
<a href="#l28.55"></a><span id="l28.55" class="difflineminus">-    virtual ~CompositeEnumeratorImpl();</span>
<a href="#l28.56"></a><span id="l28.56" class="difflineplus">+    ~CompositeEnumeratorImpl() override;</span>
<a href="#l28.57"></a><span id="l28.57"> </span>
<a href="#l28.58"></a><span id="l28.58">     CompositeDataSourceImpl* mCompositeDataSource;</span>
<a href="#l28.59"></a><span id="l28.59"> </span>
<a href="#l28.60"></a><span id="l28.60">     nsISimpleEnumerator* mCurrent;</span>
<a href="#l28.61"></a><span id="l28.61">     nsIRDFNode*  mResult;</span>
<a href="#l28.62"></a><span id="l28.62">     int32_t      mNext;</span>
<a href="#l28.63"></a><span id="l28.63">     AutoTArray&lt;nsCOMPtr&lt;nsIRDFNode&gt;, 8&gt;  mAlreadyReturned;</span>
<a href="#l28.64"></a><span id="l28.64">     bool mAllowNegativeAssertions;</span>
<a href="#l28.65"></a><span id="l28.65" class="difflineat">@@ -135,35 +138,31 @@ protected:</span>
<a href="#l28.66"></a><span id="l28.66"> </span>
<a href="#l28.67"></a><span id="l28.67"> </span>
<a href="#l28.68"></a><span id="l28.68"> CompositeEnumeratorImpl::CompositeEnumeratorImpl(CompositeDataSourceImpl* aCompositeDataSource,</span>
<a href="#l28.69"></a><span id="l28.69">                                                  bool aAllowNegativeAssertions,</span>
<a href="#l28.70"></a><span id="l28.70">                                                  bool aCoalesceDuplicateArcs)</span>
<a href="#l28.71"></a><span id="l28.71">     : mCompositeDataSource(aCompositeDataSource),</span>
<a href="#l28.72"></a><span id="l28.72">       mCurrent(nullptr),</span>
<a href="#l28.73"></a><span id="l28.73">       mResult(nullptr),</span>
<a href="#l28.74"></a><span id="l28.74" class="difflineminus">-	  mNext(0),</span>
<a href="#l28.75"></a><span id="l28.75" class="difflineplus">+      mNext(0),</span>
<a href="#l28.76"></a><span id="l28.76">       mAllowNegativeAssertions(aAllowNegativeAssertions),</span>
<a href="#l28.77"></a><span id="l28.77">       mCoalesceDuplicateArcs(aCoalesceDuplicateArcs)</span>
<a href="#l28.78"></a><span id="l28.78"> {</span>
<a href="#l28.79"></a><span id="l28.79">     NS_ADDREF(mCompositeDataSource);</span>
<a href="#l28.80"></a><span id="l28.80"> }</span>
<a href="#l28.81"></a><span id="l28.81"> </span>
<a href="#l28.82"></a><span id="l28.82"> </span>
<a href="#l28.83"></a><span id="l28.83"> CompositeEnumeratorImpl::~CompositeEnumeratorImpl(void)</span>
<a href="#l28.84"></a><span id="l28.84"> {</span>
<a href="#l28.85"></a><span id="l28.85">     NS_IF_RELEASE(mCurrent);</span>
<a href="#l28.86"></a><span id="l28.86">     NS_IF_RELEASE(mResult);</span>
<a href="#l28.87"></a><span id="l28.87">     NS_RELEASE(mCompositeDataSource);</span>
<a href="#l28.88"></a><span id="l28.88"> }</span>
<a href="#l28.89"></a><span id="l28.89"> </span>
<a href="#l28.90"></a><span id="l28.90" class="difflineminus">-NS_IMPL_ADDREF(CompositeEnumeratorImpl)</span>
<a href="#l28.91"></a><span id="l28.91" class="difflineminus">-NS_IMPL_RELEASE(CompositeEnumeratorImpl)</span>
<a href="#l28.92"></a><span id="l28.92" class="difflineminus">-NS_IMPL_QUERY_INTERFACE(CompositeEnumeratorImpl, nsISimpleEnumerator)</span>
<a href="#l28.93"></a><span id="l28.93" class="difflineminus">-</span>
<a href="#l28.94"></a><span id="l28.94"> NS_IMETHODIMP</span>
<a href="#l28.95"></a><span id="l28.95"> CompositeEnumeratorImpl::HasMoreElements(bool* aResult)</span>
<a href="#l28.96"></a><span id="l28.96"> {</span>
<a href="#l28.97"></a><span id="l28.97">     NS_ASSERTION(aResult != nullptr, &quot;null ptr&quot;);</span>
<a href="#l28.98"></a><span id="l28.98">     if (! aResult)</span>
<a href="#l28.99"></a><span id="l28.99">         return NS_ERROR_NULL_POINTER;</span>
<a href="#l28.100"></a><span id="l28.100"> </span>
<a href="#l28.101"></a><span id="l28.101">     nsresult rv;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/rdf/base/nsContainerEnumerator.cpp</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/rdf/base/nsContainerEnumerator.cpp</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -24,46 +24,51 @@</span>
<a href="#l29.4"></a><span id="l29.4"> #include &quot;nsCOMPtr.h&quot;</span>
<a href="#l29.5"></a><span id="l29.5"> #include &quot;nsIRDFContainerUtils.h&quot;</span>
<a href="#l29.6"></a><span id="l29.6"> #include &quot;nsIRDFDataSource.h&quot;</span>
<a href="#l29.7"></a><span id="l29.7"> #include &quot;nsIRDFNode.h&quot;</span>
<a href="#l29.8"></a><span id="l29.8"> #include &quot;nsIRDFService.h&quot;</span>
<a href="#l29.9"></a><span id="l29.9"> #include &quot;nsIServiceManager.h&quot;</span>
<a href="#l29.10"></a><span id="l29.10"> #include &quot;nsRDFCID.h&quot;</span>
<a href="#l29.11"></a><span id="l29.11"> #include &quot;nsString.h&quot;</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l29.13"></a><span id="l29.13"> #include &quot;mozilla/Logging.h&quot;</span>
<a href="#l29.14"></a><span id="l29.14"> #include &quot;rdf.h&quot;</span>
<a href="#l29.15"></a><span id="l29.15"> #include &quot;rdfutil.h&quot;</span>
<a href="#l29.16"></a><span id="l29.16"> </span>
<a href="#l29.17"></a><span id="l29.17"> ////////////////////////////////////////////////////////////////////////</span>
<a href="#l29.18"></a><span id="l29.18"> </span>
<a href="#l29.19"></a><span id="l29.19" class="difflineminus">-class ContainerEnumeratorImpl : public nsISimpleEnumerator {</span>
<a href="#l29.20"></a><span id="l29.20" class="difflineplus">+class ContainerEnumeratorImpl : public nsSimpleEnumerator {</span>
<a href="#l29.21"></a><span id="l29.21"> private:</span>
<a href="#l29.22"></a><span id="l29.22">     // pseudo-constants</span>
<a href="#l29.23"></a><span id="l29.23">     static nsrefcnt              gRefCnt;</span>
<a href="#l29.24"></a><span id="l29.24">     static nsIRDFResource*       kRDF_nextVal;</span>
<a href="#l29.25"></a><span id="l29.25">     static nsIRDFContainerUtils* gRDFC;</span>
<a href="#l29.26"></a><span id="l29.26"> </span>
<a href="#l29.27"></a><span id="l29.27">     nsCOMPtr&lt;nsIRDFDataSource&gt;      mDataSource;</span>
<a href="#l29.28"></a><span id="l29.28">     nsCOMPtr&lt;nsIRDFResource&gt;        mContainer;</span>
<a href="#l29.29"></a><span id="l29.29">     nsCOMPtr&lt;nsIRDFResource&gt;        mOrdinalProperty;</span>
<a href="#l29.30"></a><span id="l29.30"> </span>
<a href="#l29.31"></a><span id="l29.31">     nsCOMPtr&lt;nsISimpleEnumerator&gt;   mCurrent;</span>
<a href="#l29.32"></a><span id="l29.32">     nsCOMPtr&lt;nsIRDFNode&gt;            mResult;</span>
<a href="#l29.33"></a><span id="l29.33">     int32_t mNextIndex;</span>
<a href="#l29.34"></a><span id="l29.34"> </span>
<a href="#l29.35"></a><span id="l29.35" class="difflineminus">-    virtual ~ContainerEnumeratorImpl();</span>
<a href="#l29.36"></a><span id="l29.36" class="difflineplus">+    ~ContainerEnumeratorImpl() override;</span>
<a href="#l29.37"></a><span id="l29.37"> </span>
<a href="#l29.38"></a><span id="l29.38"> public:</span>
<a href="#l29.39"></a><span id="l29.39" class="difflineplus">+    const nsID&amp; DefaultInterface() override</span>
<a href="#l29.40"></a><span id="l29.40" class="difflineplus">+    {</span>
<a href="#l29.41"></a><span id="l29.41" class="difflineplus">+      return NS_GET_IID(nsIRDFNode);</span>
<a href="#l29.42"></a><span id="l29.42" class="difflineplus">+    }</span>
<a href="#l29.43"></a><span id="l29.43" class="difflineplus">+</span>
<a href="#l29.44"></a><span id="l29.44" class="difflineplus">+    NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l29.45"></a><span id="l29.45" class="difflineplus">+</span>
<a href="#l29.46"></a><span id="l29.46">     ContainerEnumeratorImpl(nsIRDFDataSource* ds, nsIRDFResource* container);</span>
<a href="#l29.47"></a><span id="l29.47"> </span>
<a href="#l29.48"></a><span id="l29.48">     nsresult Init();</span>
<a href="#l29.49"></a><span id="l29.49" class="difflineminus">-</span>
<a href="#l29.50"></a><span id="l29.50" class="difflineminus">-    NS_DECL_ISUPPORTS</span>
<a href="#l29.51"></a><span id="l29.51" class="difflineminus">-    NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l29.52"></a><span id="l29.52"> };</span>
<a href="#l29.53"></a><span id="l29.53"> </span>
<a href="#l29.54"></a><span id="l29.54"> nsrefcnt              ContainerEnumeratorImpl::gRefCnt;</span>
<a href="#l29.55"></a><span id="l29.55"> nsIRDFResource*       ContainerEnumeratorImpl::kRDF_nextVal;</span>
<a href="#l29.56"></a><span id="l29.56"> nsIRDFContainerUtils* ContainerEnumeratorImpl::gRDFC;</span>
<a href="#l29.57"></a><span id="l29.57"> </span>
<a href="#l29.58"></a><span id="l29.58"> </span>
<a href="#l29.59"></a><span id="l29.59"> ContainerEnumeratorImpl::ContainerEnumeratorImpl(nsIRDFDataSource* aDataSource,</span>
<a href="#l29.60"></a><span id="l29.60" class="difflineat">@@ -102,19 +107,16 @@ ContainerEnumeratorImpl::Init()</span>
<a href="#l29.61"></a><span id="l29.61"> ContainerEnumeratorImpl::~ContainerEnumeratorImpl()</span>
<a href="#l29.62"></a><span id="l29.62"> {</span>
<a href="#l29.63"></a><span id="l29.63">     if (--gRefCnt == 0) {</span>
<a href="#l29.64"></a><span id="l29.64">         NS_IF_RELEASE(kRDF_nextVal);</span>
<a href="#l29.65"></a><span id="l29.65">         NS_IF_RELEASE(gRDFC);</span>
<a href="#l29.66"></a><span id="l29.66">     }</span>
<a href="#l29.67"></a><span id="l29.67"> }</span>
<a href="#l29.68"></a><span id="l29.68"> </span>
<a href="#l29.69"></a><span id="l29.69" class="difflineminus">-NS_IMPL_ISUPPORTS(ContainerEnumeratorImpl, nsISimpleEnumerator)</span>
<a href="#l29.70"></a><span id="l29.70" class="difflineminus">-</span>
<a href="#l29.71"></a><span id="l29.71" class="difflineminus">-</span>
<a href="#l29.72"></a><span id="l29.72"> NS_IMETHODIMP</span>
<a href="#l29.73"></a><span id="l29.73"> ContainerEnumeratorImpl::HasMoreElements(bool* aResult)</span>
<a href="#l29.74"></a><span id="l29.74"> {</span>
<a href="#l29.75"></a><span id="l29.75">     NS_ASSERTION(aResult != nullptr, &quot;null ptr&quot;);</span>
<a href="#l29.76"></a><span id="l29.76">     if (! aResult)</span>
<a href="#l29.77"></a><span id="l29.77">         return NS_ERROR_NULL_POINTER;</span>
<a href="#l29.78"></a><span id="l29.78"> </span>
<a href="#l29.79"></a><span id="l29.79">     nsresult rv;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/rdf/base/nsInMemoryDataSource.cpp</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/rdf/base/nsInMemoryDataSource.cpp</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -33,16 +33,17 @@</span>
<a href="#l30.4"></a><span id="l30.4"> #include &quot;nsIRDFObserver.h&quot;</span>
<a href="#l30.5"></a><span id="l30.5"> #include &quot;nsIRDFInMemoryDataSource.h&quot;</span>
<a href="#l30.6"></a><span id="l30.6"> #include &quot;nsIRDFPropagatableDataSource.h&quot;</span>
<a href="#l30.7"></a><span id="l30.7"> #include &quot;nsIRDFPurgeableDataSource.h&quot;</span>
<a href="#l30.8"></a><span id="l30.8"> #include &quot;nsIRDFService.h&quot;</span>
<a href="#l30.9"></a><span id="l30.9"> #include &quot;nsIServiceManager.h&quot;</span>
<a href="#l30.10"></a><span id="l30.10"> #include &quot;nsCOMArray.h&quot;</span>
<a href="#l30.11"></a><span id="l30.11"> #include &quot;nsEnumeratorUtils.h&quot;</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineplus">+#include &quot;nsSimpleEnumerator.h&quot;</span>
<a href="#l30.13"></a><span id="l30.13"> #include &quot;nsTArray.h&quot;</span>
<a href="#l30.14"></a><span id="l30.14"> #include &quot;nsCRT.h&quot;</span>
<a href="#l30.15"></a><span id="l30.15"> #include &quot;nsRDFCID.h&quot;</span>
<a href="#l30.16"></a><span id="l30.16"> #include &quot;nsRDFBaseDataSources.h&quot;</span>
<a href="#l30.17"></a><span id="l30.17"> #include &quot;nsString.h&quot;</span>
<a href="#l30.18"></a><span id="l30.18"> #include &quot;nsReadableUtils.h&quot;</span>
<a href="#l30.19"></a><span id="l30.19"> #include &quot;nsString.h&quot;</span>
<a href="#l30.20"></a><span id="l30.20"> #include &quot;rdfutil.h&quot;</span>
<a href="#l30.21"></a><span id="l30.21" class="difflineat">@@ -345,41 +346,43 @@ mozilla::LazyLogModule InMemoryDataSourc</span>
<a href="#l30.22"></a><span id="l30.22"> //----------------------------------------------------------------------</span>
<a href="#l30.23"></a><span id="l30.23"> //</span>
<a href="#l30.24"></a><span id="l30.24"> // InMemoryAssertionEnumeratorImpl</span>
<a href="#l30.25"></a><span id="l30.25"> //</span>
<a href="#l30.26"></a><span id="l30.26"> </span>
<a href="#l30.27"></a><span id="l30.27"> /**</span>
<a href="#l30.28"></a><span id="l30.28">  * InMemoryAssertionEnumeratorImpl</span>
<a href="#l30.29"></a><span id="l30.29">  */</span>
<a href="#l30.30"></a><span id="l30.30" class="difflineminus">-class InMemoryAssertionEnumeratorImpl : public nsISimpleEnumerator</span>
<a href="#l30.31"></a><span id="l30.31" class="difflineplus">+class InMemoryAssertionEnumeratorImpl : public nsSimpleEnumerator</span>
<a href="#l30.32"></a><span id="l30.32"> {</span>
<a href="#l30.33"></a><span id="l30.33"> private:</span>
<a href="#l30.34"></a><span id="l30.34">     InMemoryDataSource* mDataSource;</span>
<a href="#l30.35"></a><span id="l30.35">     nsIRDFResource* mSource;</span>
<a href="#l30.36"></a><span id="l30.36">     nsIRDFResource* mProperty;</span>
<a href="#l30.37"></a><span id="l30.37">     nsIRDFNode*     mTarget;</span>
<a href="#l30.38"></a><span id="l30.38">     nsIRDFNode*     mValue;</span>
<a href="#l30.39"></a><span id="l30.39">     bool            mTruthValue;</span>
<a href="#l30.40"></a><span id="l30.40">     Assertion*      mNextAssertion;</span>
<a href="#l30.41"></a><span id="l30.41"> </span>
<a href="#l30.42"></a><span id="l30.42" class="difflineminus">-    virtual ~InMemoryAssertionEnumeratorImpl();</span>
<a href="#l30.43"></a><span id="l30.43" class="difflineplus">+    ~InMemoryAssertionEnumeratorImpl() override;</span>
<a href="#l30.44"></a><span id="l30.44"> </span>
<a href="#l30.45"></a><span id="l30.45"> public:</span>
<a href="#l30.46"></a><span id="l30.46" class="difflineplus">+    const nsID&amp; DefaultInterface() override</span>
<a href="#l30.47"></a><span id="l30.47" class="difflineplus">+    {</span>
<a href="#l30.48"></a><span id="l30.48" class="difflineplus">+      return NS_GET_IID(nsIRDFNode);</span>
<a href="#l30.49"></a><span id="l30.49" class="difflineplus">+    }</span>
<a href="#l30.50"></a><span id="l30.50" class="difflineplus">+</span>
<a href="#l30.51"></a><span id="l30.51" class="difflineplus">+    // nsISimpleEnumerator interface</span>
<a href="#l30.52"></a><span id="l30.52" class="difflineplus">+    NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l30.53"></a><span id="l30.53" class="difflineplus">+</span>
<a href="#l30.54"></a><span id="l30.54">     InMemoryAssertionEnumeratorImpl(InMemoryDataSource* aDataSource,</span>
<a href="#l30.55"></a><span id="l30.55">                                     nsIRDFResource* aSource,</span>
<a href="#l30.56"></a><span id="l30.56">                                     nsIRDFResource* aProperty,</span>
<a href="#l30.57"></a><span id="l30.57">                                     nsIRDFNode* aTarget,</span>
<a href="#l30.58"></a><span id="l30.58">                                     bool aTruthValue);</span>
<a href="#l30.59"></a><span id="l30.59" class="difflineminus">-</span>
<a href="#l30.60"></a><span id="l30.60" class="difflineminus">-    // nsISupports interface</span>
<a href="#l30.61"></a><span id="l30.61" class="difflineminus">-    NS_DECL_ISUPPORTS</span>
<a href="#l30.62"></a><span id="l30.62" class="difflineminus">-</span>
<a href="#l30.63"></a><span id="l30.63" class="difflineminus">-    // nsISimpleEnumerator interface</span>
<a href="#l30.64"></a><span id="l30.64" class="difflineminus">-    NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l30.65"></a><span id="l30.65"> };</span>
<a href="#l30.66"></a><span id="l30.66"> </span>
<a href="#l30.67"></a><span id="l30.67"> ////////////////////////////////////////////////////////////////////////</span>
<a href="#l30.68"></a><span id="l30.68"> </span>
<a href="#l30.69"></a><span id="l30.69"> </span>
<a href="#l30.70"></a><span id="l30.70"> InMemoryAssertionEnumeratorImpl::InMemoryAssertionEnumeratorImpl(</span>
<a href="#l30.71"></a><span id="l30.71">                  InMemoryDataSource* aDataSource,</span>
<a href="#l30.72"></a><span id="l30.72">                  nsIRDFResource* aSource,</span>
<a href="#l30.73"></a><span id="l30.73" class="difflineat">@@ -431,20 +434,16 @@ InMemoryAssertionEnumeratorImpl::~InMemo</span>
<a href="#l30.74"></a><span id="l30.74"> </span>
<a href="#l30.75"></a><span id="l30.75">     NS_IF_RELEASE(mDataSource);</span>
<a href="#l30.76"></a><span id="l30.76">     NS_IF_RELEASE(mSource);</span>
<a href="#l30.77"></a><span id="l30.77">     NS_IF_RELEASE(mProperty);</span>
<a href="#l30.78"></a><span id="l30.78">     NS_IF_RELEASE(mTarget);</span>
<a href="#l30.79"></a><span id="l30.79">     NS_IF_RELEASE(mValue);</span>
<a href="#l30.80"></a><span id="l30.80"> }</span>
<a href="#l30.81"></a><span id="l30.81"> </span>
<a href="#l30.82"></a><span id="l30.82" class="difflineminus">-NS_IMPL_ADDREF(InMemoryAssertionEnumeratorImpl)</span>
<a href="#l30.83"></a><span id="l30.83" class="difflineminus">-NS_IMPL_RELEASE(InMemoryAssertionEnumeratorImpl)</span>
<a href="#l30.84"></a><span id="l30.84" class="difflineminus">-NS_IMPL_QUERY_INTERFACE(InMemoryAssertionEnumeratorImpl, nsISimpleEnumerator)</span>
<a href="#l30.85"></a><span id="l30.85" class="difflineminus">-</span>
<a href="#l30.86"></a><span id="l30.86"> NS_IMETHODIMP</span>
<a href="#l30.87"></a><span id="l30.87"> InMemoryAssertionEnumeratorImpl::HasMoreElements(bool* aResult)</span>
<a href="#l30.88"></a><span id="l30.88"> {</span>
<a href="#l30.89"></a><span id="l30.89">     if (mValue) {</span>
<a href="#l30.90"></a><span id="l30.90">         *aResult = true;</span>
<a href="#l30.91"></a><span id="l30.91">         return NS_OK;</span>
<a href="#l30.92"></a><span id="l30.92">     }</span>
<a href="#l30.93"></a><span id="l30.93"> </span>
<a href="#l30.94"></a><span id="l30.94" class="difflineat">@@ -512,39 +511,41 @@ InMemoryAssertionEnumeratorImpl::GetNext</span>
<a href="#l30.95"></a><span id="l30.95"> /**</span>
<a href="#l30.96"></a><span id="l30.96">  * This class is a little bit bizarre in that it implements both the</span>
<a href="#l30.97"></a><span id="l30.97">  * &lt;tt&gt;nsIRDFArcsOutCursor&lt;/tt&gt; and &lt;tt&gt;nsIRDFArcsInCursor&lt;/tt&gt; interfaces.</span>
<a href="#l30.98"></a><span id="l30.98">  * Because the structure of the in-memory graph is pretty flexible, it's</span>
<a href="#l30.99"></a><span id="l30.99">  * fairly easy to parameterize this class. The only funky thing to watch</span>
<a href="#l30.100"></a><span id="l30.100">  * out for is the multiple inheritance clashes.</span>
<a href="#l30.101"></a><span id="l30.101">  */</span>
<a href="#l30.102"></a><span id="l30.102"> </span>
<a href="#l30.103"></a><span id="l30.103" class="difflineminus">-class InMemoryArcsEnumeratorImpl : public nsISimpleEnumerator</span>
<a href="#l30.104"></a><span id="l30.104" class="difflineplus">+class InMemoryArcsEnumeratorImpl : public nsSimpleEnumerator</span>
<a href="#l30.105"></a><span id="l30.105"> {</span>
<a href="#l30.106"></a><span id="l30.106"> private:</span>
<a href="#l30.107"></a><span id="l30.107">     InMemoryDataSource* mDataSource;</span>
<a href="#l30.108"></a><span id="l30.108">     nsIRDFResource*     mSource;</span>
<a href="#l30.109"></a><span id="l30.109">     nsIRDFNode*         mTarget;</span>
<a href="#l30.110"></a><span id="l30.110">     AutoTArray&lt;nsCOMPtr&lt;nsIRDFResource&gt;, 8&gt; mAlreadyReturned;</span>
<a href="#l30.111"></a><span id="l30.111">     nsIRDFResource*     mCurrent;</span>
<a href="#l30.112"></a><span id="l30.112">     Assertion*          mAssertion;</span>
<a href="#l30.113"></a><span id="l30.113">     nsCOMArray&lt;nsIRDFNode&gt;* mHashArcs;</span>
<a href="#l30.114"></a><span id="l30.114"> </span>
<a href="#l30.115"></a><span id="l30.115" class="difflineminus">-    virtual ~InMemoryArcsEnumeratorImpl();</span>
<a href="#l30.116"></a><span id="l30.116" class="difflineplus">+    ~InMemoryArcsEnumeratorImpl() override;</span>
<a href="#l30.117"></a><span id="l30.117"> </span>
<a href="#l30.118"></a><span id="l30.118"> public:</span>
<a href="#l30.119"></a><span id="l30.119" class="difflineplus">+    const nsID&amp; DefaultInterface() override</span>
<a href="#l30.120"></a><span id="l30.120" class="difflineplus">+    {</span>
<a href="#l30.121"></a><span id="l30.121" class="difflineplus">+      return NS_GET_IID(nsIRDFResource);</span>
<a href="#l30.122"></a><span id="l30.122" class="difflineplus">+    }</span>
<a href="#l30.123"></a><span id="l30.123" class="difflineplus">+</span>
<a href="#l30.124"></a><span id="l30.124" class="difflineplus">+    // nsISimpleEnumerator interface</span>
<a href="#l30.125"></a><span id="l30.125" class="difflineplus">+    NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l30.126"></a><span id="l30.126" class="difflineplus">+</span>
<a href="#l30.127"></a><span id="l30.127">     InMemoryArcsEnumeratorImpl(InMemoryDataSource* aDataSource,</span>
<a href="#l30.128"></a><span id="l30.128">                                nsIRDFResource* aSource,</span>
<a href="#l30.129"></a><span id="l30.129">                                nsIRDFNode* aTarget);</span>
<a href="#l30.130"></a><span id="l30.130" class="difflineminus">-</span>
<a href="#l30.131"></a><span id="l30.131" class="difflineminus">-    // nsISupports interface</span>
<a href="#l30.132"></a><span id="l30.132" class="difflineminus">-    NS_DECL_ISUPPORTS</span>
<a href="#l30.133"></a><span id="l30.133" class="difflineminus">-</span>
<a href="#l30.134"></a><span id="l30.134" class="difflineminus">-    // nsISimpleEnumerator interface</span>
<a href="#l30.135"></a><span id="l30.135" class="difflineminus">-    NS_DECL_NSISIMPLEENUMERATOR</span>
<a href="#l30.136"></a><span id="l30.136"> };</span>
<a href="#l30.137"></a><span id="l30.137"> </span>
<a href="#l30.138"></a><span id="l30.138"> </span>
<a href="#l30.139"></a><span id="l30.139"> InMemoryArcsEnumeratorImpl::InMemoryArcsEnumeratorImpl(InMemoryDataSource* aDataSource,</span>
<a href="#l30.140"></a><span id="l30.140">                                                        nsIRDFResource* aSource,</span>
<a href="#l30.141"></a><span id="l30.141">                                                        nsIRDFNode* aTarget)</span>
<a href="#l30.142"></a><span id="l30.142">     : mDataSource(aDataSource),</span>
<a href="#l30.143"></a><span id="l30.143">       mSource(aSource),</span>
<a href="#l30.144"></a><span id="l30.144" class="difflineat">@@ -586,20 +587,16 @@ InMemoryArcsEnumeratorImpl::~InMemoryArc</span>
<a href="#l30.145"></a><span id="l30.145"> </span>
<a href="#l30.146"></a><span id="l30.146">     NS_RELEASE(mDataSource);</span>
<a href="#l30.147"></a><span id="l30.147">     NS_IF_RELEASE(mSource);</span>
<a href="#l30.148"></a><span id="l30.148">     NS_IF_RELEASE(mTarget);</span>
<a href="#l30.149"></a><span id="l30.149">     NS_IF_RELEASE(mCurrent);</span>
<a href="#l30.150"></a><span id="l30.150">     delete mHashArcs;</span>
<a href="#l30.151"></a><span id="l30.151"> }</span>
<a href="#l30.152"></a><span id="l30.152"> </span>
<a href="#l30.153"></a><span id="l30.153" class="difflineminus">-NS_IMPL_ADDREF(InMemoryArcsEnumeratorImpl)</span>
<a href="#l30.154"></a><span id="l30.154" class="difflineminus">-NS_IMPL_RELEASE(InMemoryArcsEnumeratorImpl)</span>
<a href="#l30.155"></a><span id="l30.155" class="difflineminus">-NS_IMPL_QUERY_INTERFACE(InMemoryArcsEnumeratorImpl, nsISimpleEnumerator)</span>
<a href="#l30.156"></a><span id="l30.156" class="difflineminus">-</span>
<a href="#l30.157"></a><span id="l30.157"> NS_IMETHODIMP</span>
<a href="#l30.158"></a><span id="l30.158"> InMemoryArcsEnumeratorImpl::HasMoreElements(bool* aResult)</span>
<a href="#l30.159"></a><span id="l30.159"> {</span>
<a href="#l30.160"></a><span id="l30.160">     NS_ASSERTION(aResult != nullptr, &quot;null ptr&quot;);</span>
<a href="#l30.161"></a><span id="l30.161">     if (! aResult)</span>
<a href="#l30.162"></a><span id="l30.162">         return NS_ERROR_NULL_POINTER;</span>
<a href="#l30.163"></a><span id="l30.163"> </span>
<a href="#l30.164"></a><span id="l30.164">     if (mCurrent) {</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:32Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

