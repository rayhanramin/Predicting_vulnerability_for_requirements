<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 5740:d9a57a60f0804de28496a956e34ceb338f2b1567</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ d9a57a60f0804de28496a956e34ceb338f2b1567" />
<meta property="og:url" content="/comm-central/rev/d9a57a60f0804de28496a956e34ceb338f2b1567" />
<meta property="og:description" content="bug 411754 - Overlay suite features onto toolkit view source window and use that instead of an own implementation, r=Neil" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / d9a57a60f0804de28496a956e34ceb338f2b1567 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/d9a57a60f0804de28496a956e34ceb338f2b1567">shortlog</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/d9a57a60f0804de28496a956e34ceb338f2b1567">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567">files</a> |
changeset |
<a href="/comm-central/raw-rev/d9a57a60f0804de28496a956e34ceb338f2b1567">raw</a>  | <a href="/comm-central/archive/d9a57a60f0804de28496a956e34ceb338f2b1567.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=411754">bug 411754</a> - Overlay suite features onto toolkit view source window and use that instead of an own implementation, r=Neil
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#82;&#111;&#98;&#101;&#114;&#116;&#32;&#75;&#97;&#105;&#115;&#101;&#114;&#32;&#60;&#107;&#97;&#105;&#114;&#111;&#64;&#107;&#97;&#105;&#114;&#111;&#46;&#97;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 27 May 2010 14:58:28 +0200</td></tr>

<tr>
 <td>changeset 5740</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/d9a57a60f0804de28496a956e34ceb338f2b1567">d9a57a60f0804de28496a956e34ceb338f2b1567</a></td>
</tr>



<tr>
<td>parent 5739</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/c3b77a8373b549aa81d5f07752381525fb0af446">c3b77a8373b549aa81d5f07752381525fb0af446</a>
</td>
</tr>

<tr>
<td>child 5741</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/7c3fdb5ad7cb5dff1d263c4bfd7246727ab93d57">7c3fdb5ad7cb5dff1d263c4bfd7246727ab93d57</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=d9a57a60f0804de28496a956e34ceb338f2b1567">4448</a></td></tr>
<tr><td>push user</td><td>kairo@kairo.at</td></tr>
<tr><td>push date</td><td class="date age">Thu, 27 May 2010 12:59:14 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@d9a57a60f080 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=d9a57a60f0804de28496a956e34ceb338f2b1567">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=d9a57a60f0804de28496a956e34ceb338f2b1567&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d9a57a60f0804de28496a956e34ceb338f2b1567&newProject=comm-central&newRevision=d9a57a60f0804de28496a956e34ceb338f2b1567&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d9a57a60f0804de28496a956e34ceb338f2b1567&newProject=comm-central&newRevision=d9a57a60f0804de28496a956e34ceb338f2b1567&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d9a57a60f0804de28496a956e34ceb338f2b1567&newProject=comm-central&newRevision=d9a57a60f0804de28496a956e34ceb338f2b1567&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Neil%29&revcount=50">Neil</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=411754">411754</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=411754">bug 411754</a> - Overlay suite features onto toolkit view source window and use that instead of an own implementation, r=Neil</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/jar.mn">suite/browser/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/jar.mn">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/jar.mn">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/jar.mn">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/jar.mn">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/navigator.js">suite/browser/navigator.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/navigator.js">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/navigator.js">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/navigator.js">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/navigator.js">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/navigator.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewPartialSource.js">suite/browser/viewPartialSource.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewPartialSource.js">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewPartialSource.js">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewPartialSource.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewPartialSource.xul">suite/browser/viewPartialSource.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewPartialSource.xul">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewPartialSource.xul">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewPartialSource.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewSource.xul">suite/browser/viewSource.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewSource.xul">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewSource.xul">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewSource.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewSourceOverlay.xul">suite/browser/viewSourceOverlay.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewSourceOverlay.xul">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewSourceOverlay.xul">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewSourceOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewsource.js">suite/browser/viewsource.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewsource.js">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewsource.js">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/browser/viewsource.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/jar.mn">suite/common/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/jar.mn">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/jar.mn">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/jar.mn">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/jar.mn">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/nsContextMenu.js">suite/common/nsContextMenu.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/nsContextMenu.js">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/nsContextMenu.js">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/nsContextMenu.js">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/nsContextMenu.js">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/nsContextMenu.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.js">suite/common/viewSourceOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.js">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.js">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.js">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.js">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.xul">suite/common/viewSourceOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.xul">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.xul">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.xul">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.xul">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/common/viewSourceOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/en-US/chrome/browser/viewSource.dtd">suite/locales/en-US/chrome/browser/viewSource.dtd</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/en-US/chrome/browser/viewSource.dtd">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/en-US/chrome/browser/viewSource.dtd">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/en-US/chrome/browser/viewSource.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/en-US/chrome/browser/viewSource.properties">suite/locales/en-US/chrome/browser/viewSource.properties</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/en-US/chrome/browser/viewSource.properties">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/en-US/chrome/browser/viewSource.properties">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/en-US/chrome/browser/viewSource.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/jar.mn">suite/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/locales/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/mailCommands.js">suite/mailnews/mailCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/mailCommands.js">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/mailCommands.js">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/mailCommands.js">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/mailCommands.js">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/mailCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/msgHdrViewOverlay.js">suite/mailnews/msgHdrViewOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/msgHdrViewOverlay.js">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/msgHdrViewOverlay.js">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/msgHdrViewOverlay.js">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/msgHdrViewOverlay.js">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/mailnews/msgHdrViewOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/communicator/viewSourceOverlay.css">suite/themes/classic/communicator/viewSourceOverlay.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/communicator/viewSourceOverlay.css">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/communicator/viewSourceOverlay.css">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/communicator/viewSourceOverlay.css">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/communicator/viewSourceOverlay.css">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/communicator/viewSourceOverlay.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/jar.mn">suite/themes/classic/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/jar.mn">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/jar.mn">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/jar.mn">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/jar.mn">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/classic/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/communicator/viewSourceOverlay.css">suite/themes/modern/communicator/viewSourceOverlay.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/communicator/viewSourceOverlay.css">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/communicator/viewSourceOverlay.css">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/communicator/viewSourceOverlay.css">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/communicator/viewSourceOverlay.css">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/communicator/viewSourceOverlay.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/jar.mn">suite/themes/modern/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/jar.mn">file</a> |
<a href="/comm-central/annotate/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/jar.mn">annotate</a> |
<a href="/comm-central/diff/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/jar.mn">diff</a> |
<a href="/comm-central/comparison/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/jar.mn">comparison</a> |
<a href="/comm-central/log/d9a57a60f0804de28496a956e34ceb338f2b1567/suite/themes/modern/jar.mn">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/suite/browser/jar.mn</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/suite/browser/jar.mn</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -19,21 +19,16 @@ comm.jar:</span>
<a href="#l1.4"></a><span id="l1.4">    content/navigator/navigatorDD.js</span>
<a href="#l1.5"></a><span id="l1.5">    content/navigator/navigatorOverlay.xul</span>
<a href="#l1.6"></a><span id="l1.6">    content/navigator/nsBrowserContentListener.js</span>
<a href="#l1.7"></a><span id="l1.7">    content/navigator/nsBrowserStatusHandler.js</span>
<a href="#l1.8"></a><span id="l1.8">    content/navigator/searchconfig.properties</span>
<a href="#l1.9"></a><span id="l1.9">    content/navigator/sessionHistoryUI.js</span>
<a href="#l1.10"></a><span id="l1.10">    content/navigator/tabbrowser.xml</span>
<a href="#l1.11"></a><span id="l1.11">    content/navigator/urlbarBindings.xml</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-   content/navigator/viewsource.js</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-   content/navigator/viewSource.xul</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-   content/navigator/viewSourceOverlay.xul</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-   content/navigator/viewPartialSource.js</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-   content/navigator/viewPartialSource.xul</span>
<a href="#l1.17"></a><span id="l1.17"> #ifdef XP_MACOSX</span>
<a href="#l1.18"></a><span id="l1.18">    content/navigator/platformNavigationBindings.xul                 (mac/platformNavigationBindings.xul)</span>
<a href="#l1.19"></a><span id="l1.19">    content/navigator/platformMailOverlay.xul                        (mac/platformMailOverlay.xul)</span>
<a href="#l1.20"></a><span id="l1.20"> #else</span>
<a href="#l1.21"></a><span id="l1.21"> #ifdef XP_WIN32</span>
<a href="#l1.22"></a><span id="l1.22">    content/navigator/platformNavigationBindings.xul                 (win/platformNavigationBindings.xul)</span>
<a href="#l1.23"></a><span id="l1.23">    content/navigator/platformMailOverlay.xul                        (win/platformMailOverlay.xul)</span>
<a href="#l1.24"></a><span id="l1.24"> #else</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/suite/browser/navigator.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/suite/browser/navigator.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1696,17 +1696,17 @@ function BrowserViewSourceOfDocument(aDo</span>
<a href="#l2.4"></a><span id="l2.4">   }</span>
<a href="#l2.5"></a><span id="l2.5"> </span>
<a href="#l2.6"></a><span id="l2.6">   BrowserViewSourceOfURL(webNav.currentURI.spec, docCharset, pageCookie);</span>
<a href="#l2.7"></a><span id="l2.7"> }</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9"> function BrowserViewSourceOfURL(url, charset, pageCookie)</span>
<a href="#l2.10"></a><span id="l2.10"> {</span>
<a href="#l2.11"></a><span id="l2.11">   // try to open a view-source window while inheriting the charset (if any)</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-  openDialog(&quot;chrome://navigator/content/viewSource.xul&quot;,</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+  openDialog(&quot;chrome://global/content/viewSource.xul&quot;,</span>
<a href="#l2.14"></a><span id="l2.14">              &quot;_blank&quot;,</span>
<a href="#l2.15"></a><span id="l2.15">              &quot;all,dialog=no&quot;,</span>
<a href="#l2.16"></a><span id="l2.16">              url, charset, pageCookie);</span>
<a href="#l2.17"></a><span id="l2.17"> }</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19"> // doc - document to use for source, or null for the current tab</span>
<a href="#l2.20"></a><span id="l2.20"> // initialTab - id of the initial tab to display, or null for the first tab</span>
<a href="#l2.21"></a><span id="l2.21"> function BrowserPageInfo(doc, initialTab)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1">deleted file mode 100644</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineminus">--- a/suite/browser/viewPartialSource.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineplus">+++ /dev/null</span>
<a href="#l3.4"></a><span id="l3.4" class="difflineat">@@ -1,506 +0,0 @@</span>
<a href="#l3.5"></a><span id="l3.5" class="difflineminus">-/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l3.6"></a><span id="l3.6" class="difflineminus">- * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l3.7"></a><span id="l3.7" class="difflineminus">- *</span>
<a href="#l3.8"></a><span id="l3.8" class="difflineminus">- * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineminus">- * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineminus">- * the License. You may obtain a copy of the License at</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineminus">- * http://www.mozilla.org/MPL/</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">- *</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">- * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">- * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">- * for the specific language governing rights and limitations under the</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineminus">- * License.</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineminus">- *</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineminus">- * The Original Code is mozilla.org view-source front-end.</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineminus">- *</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineminus">- * The Initial Developer of the Original Code is mozilla.org.</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineminus">- * Portions created by the Initial Developer are Copyright (C) 2002</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineminus">- * the Initial Developer. All Rights Reserved.</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineminus">- *</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineminus">- * Contributor(s):</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineminus">- *   Roger B. Sidje &lt;rbs@maths.uq.edu.au&gt; (Original Author)</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineminus">- *   Steve Swanson &lt;steve.swanson@mackichan.com&gt;</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineminus">- *   Doron Rosenberg &lt;doronr@naboonline.com&gt;</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineminus">- *</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineminus">- * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">- * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">- * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineminus">- * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineminus">- * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineminus">- * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineminus">- * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineminus">- * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineminus">- * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineminus">- * the provisions above, a recipient may use your version of this file under</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineminus">- * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineminus">- *</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineminus">- * ***** END LICENSE BLOCK ***** */</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineminus">-</span>
<a href="#l3.43"></a><span id="l3.43" class="difflineminus">-var gDebug = 0;</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineminus">-var gLineCount = 0;</span>
<a href="#l3.45"></a><span id="l3.45" class="difflineminus">-var gStartTargetLine = 0;</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineminus">-var gEndTargetLine = 0;</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineminus">-var gTargetNode = null;</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineminus">-</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineminus">-var gEntityConverter = null;</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineminus">-var gWrapLongLines = false;</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineminus">-const gViewSourceCSS = 'resource://gre-resources/viewsource.css';</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineminus">-const NS_XHTML = 'http://www.w3.org/1999/xhtml';</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineminus">-</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineminus">-// These are markers used to delimit the selection during processing. They</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineminus">-// are removed from the final rendering, but we pick space-like characters for</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineminus">-// safety (and futhermore, these are known to be mapped to a 0-length string</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineminus">-// in transliterate.properties). It is okay to set start=end, we use findNext()</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineminus">-// U+200B ZERO WIDTH SPACE</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-const MARK_SELECTION_START = '\u200B\u200B\u200B\u200B\u200B';</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineminus">-const MARK_SELECTION_END = '\u200B\u200B\u200B\u200B\u200B';</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineminus">-</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineminus">-function onLoadViewPartialSource()</span>
<a href="#l3.63"></a><span id="l3.63" class="difflineminus">-{</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineminus">-  // check the view_source.wrap_long_lines pref and set the menuitem's checked attribute accordingly</span>
<a href="#l3.65"></a><span id="l3.65" class="difflineminus">-  if (gPrefs) {</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineminus">-    try {</span>
<a href="#l3.67"></a><span id="l3.67" class="difflineminus">-      var wraplonglinesPrefValue = gPrefs.getBoolPref('view_source.wrap_long_lines');</span>
<a href="#l3.68"></a><span id="l3.68" class="difflineminus">-      if (wraplonglinesPrefValue) {</span>
<a href="#l3.69"></a><span id="l3.69" class="difflineminus">-        document.getElementById('menu_wrapLongLines').setAttribute('checked', 'true');</span>
<a href="#l3.70"></a><span id="l3.70" class="difflineminus">-        gWrapLongLines = true;</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineminus">-      }</span>
<a href="#l3.72"></a><span id="l3.72" class="difflineminus">-    } catch (e) { }</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineminus">-    try {</span>
<a href="#l3.74"></a><span id="l3.74" class="difflineminus">-      document.getElementById(&quot;menu_highlightSyntax&quot;).setAttribute(&quot;checked&quot;, gPrefs.getBoolPref(&quot;view_source.syntax_highlight&quot;));</span>
<a href="#l3.75"></a><span id="l3.75" class="difflineminus">-    } catch (e) {</span>
<a href="#l3.76"></a><span id="l3.76" class="difflineminus">-    }</span>
<a href="#l3.77"></a><span id="l3.77" class="difflineminus">-  } else {</span>
<a href="#l3.78"></a><span id="l3.78" class="difflineminus">-    document.getElementById(&quot;menu_highlightSyntax&quot;).setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l3.79"></a><span id="l3.79" class="difflineminus">-  }</span>
<a href="#l3.80"></a><span id="l3.80" class="difflineminus">-</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineminus">-  // disable menu items that don't work since the selection is munged and</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineminus">-  // the editor doesn't work for MathML</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineminus">-  document.getElementById('cmd_savePage').setAttribute('disabled', 'true');</span>
<a href="#l3.84"></a><span id="l3.84" class="difflineminus">-  document.getElementById('cmd_editPage').setAttribute('disabled', 'true');</span>
<a href="#l3.85"></a><span id="l3.85" class="difflineminus">-</span>
<a href="#l3.86"></a><span id="l3.86" class="difflineminus">-  if (window.arguments[3] == 'selection')</span>
<a href="#l3.87"></a><span id="l3.87" class="difflineminus">-    viewPartialSourceForSelection(window.arguments[2]);</span>
<a href="#l3.88"></a><span id="l3.88" class="difflineminus">-  else</span>
<a href="#l3.89"></a><span id="l3.89" class="difflineminus">-    viewPartialSourceForFragment(window.arguments[2], window.arguments[3]);</span>
<a href="#l3.90"></a><span id="l3.90" class="difflineminus">-</span>
<a href="#l3.91"></a><span id="l3.91" class="difflineminus">-  window.content.focus();</span>
<a href="#l3.92"></a><span id="l3.92" class="difflineminus">-}</span>
<a href="#l3.93"></a><span id="l3.93" class="difflineminus">-</span>
<a href="#l3.94"></a><span id="l3.94" class="difflineminus">-////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l3.95"></a><span id="l3.95" class="difflineminus">-// view-source of a selection with the special effect of remapping the selection</span>
<a href="#l3.96"></a><span id="l3.96" class="difflineminus">-// to the underlying view-source output</span>
<a href="#l3.97"></a><span id="l3.97" class="difflineminus">-function viewPartialSourceForSelection(selection)</span>
<a href="#l3.98"></a><span id="l3.98" class="difflineminus">-{</span>
<a href="#l3.99"></a><span id="l3.99" class="difflineminus">-  var range = selection.getRangeAt(0);</span>
<a href="#l3.100"></a><span id="l3.100" class="difflineminus">-  var ancestorContainer = range.commonAncestorContainer;</span>
<a href="#l3.101"></a><span id="l3.101" class="difflineminus">-  var doc = ancestorContainer.ownerDocument;</span>
<a href="#l3.102"></a><span id="l3.102" class="difflineminus">-</span>
<a href="#l3.103"></a><span id="l3.103" class="difflineminus">-  var startContainer = range.startContainer;</span>
<a href="#l3.104"></a><span id="l3.104" class="difflineminus">-  var endContainer = range.endContainer;</span>
<a href="#l3.105"></a><span id="l3.105" class="difflineminus">-  var startOffset = range.startOffset;</span>
<a href="#l3.106"></a><span id="l3.106" class="difflineminus">-  var endOffset = range.endOffset;</span>
<a href="#l3.107"></a><span id="l3.107" class="difflineminus">-</span>
<a href="#l3.108"></a><span id="l3.108" class="difflineminus">-  // let the ancestor be an element</span>
<a href="#l3.109"></a><span id="l3.109" class="difflineminus">-  if (ancestorContainer.nodeType == Node.TEXT_NODE ||</span>
<a href="#l3.110"></a><span id="l3.110" class="difflineminus">-      ancestorContainer.nodeType == Node.CDATA_SECTION_NODE)</span>
<a href="#l3.111"></a><span id="l3.111" class="difflineminus">-    ancestorContainer = ancestorContainer.parentNode;</span>
<a href="#l3.112"></a><span id="l3.112" class="difflineminus">-</span>
<a href="#l3.113"></a><span id="l3.113" class="difflineminus">-  // for selectAll, let's use the entire document, including &lt;html&gt;...&lt;/html&gt;</span>
<a href="#l3.114"></a><span id="l3.114" class="difflineminus">-  // @see DocumentViewerImpl::SelectAll() for how selectAll is implemented</span>
<a href="#l3.115"></a><span id="l3.115" class="difflineminus">-  try {</span>
<a href="#l3.116"></a><span id="l3.116" class="difflineminus">-    if (ancestorContainer == doc.body)</span>
<a href="#l3.117"></a><span id="l3.117" class="difflineminus">-      ancestorContainer = doc.documentElement;</span>
<a href="#l3.118"></a><span id="l3.118" class="difflineminus">-  } catch (e) { }</span>
<a href="#l3.119"></a><span id="l3.119" class="difflineminus">-</span>
<a href="#l3.120"></a><span id="l3.120" class="difflineminus">-  // each path is a &quot;child sequence&quot; (a.k.a. &quot;tumbler&quot;) that</span>
<a href="#l3.121"></a><span id="l3.121" class="difflineminus">-  // descends from the ancestor down to the boundary point</span>
<a href="#l3.122"></a><span id="l3.122" class="difflineminus">-  var startPath = getPath(ancestorContainer, startContainer);</span>
<a href="#l3.123"></a><span id="l3.123" class="difflineminus">-  var endPath = getPath(ancestorContainer, endContainer);</span>
<a href="#l3.124"></a><span id="l3.124" class="difflineminus">-</span>
<a href="#l3.125"></a><span id="l3.125" class="difflineminus">-  // clone the fragment of interest and reset everything to be relative to it</span>
<a href="#l3.126"></a><span id="l3.126" class="difflineminus">-  // note: it is with the clone that we operate/munge from now on</span>
<a href="#l3.127"></a><span id="l3.127" class="difflineminus">-  ancestorContainer = ancestorContainer.cloneNode(true);</span>
<a href="#l3.128"></a><span id="l3.128" class="difflineminus">-  startContainer = ancestorContainer;</span>
<a href="#l3.129"></a><span id="l3.129" class="difflineminus">-  endContainer = ancestorContainer;</span>
<a href="#l3.130"></a><span id="l3.130" class="difflineminus">-</span>
<a href="#l3.131"></a><span id="l3.131" class="difflineminus">-  // Only bother with the selection if it can be remapped. Don't mess with</span>
<a href="#l3.132"></a><span id="l3.132" class="difflineminus">-  // leaf elements (such as &lt;isindex&gt;) that secretly use anynomous content</span>
<a href="#l3.133"></a><span id="l3.133" class="difflineminus">-  // for their display appearance.</span>
<a href="#l3.134"></a><span id="l3.134" class="difflineminus">-  var canDrawSelection = ancestorContainer.hasChildNodes();</span>
<a href="#l3.135"></a><span id="l3.135" class="difflineminus">-  if (canDrawSelection) {</span>
<a href="#l3.136"></a><span id="l3.136" class="difflineminus">-    var i;</span>
<a href="#l3.137"></a><span id="l3.137" class="difflineminus">-    for (i = startPath ? startPath.length-1 : -1; i &gt;= 0; i--) {</span>
<a href="#l3.138"></a><span id="l3.138" class="difflineminus">-      startContainer = startContainer.childNodes.item(startPath[i]);</span>
<a href="#l3.139"></a><span id="l3.139" class="difflineminus">-    }</span>
<a href="#l3.140"></a><span id="l3.140" class="difflineminus">-    for (i = endPath ? endPath.length-1 : -1; i &gt;= 0; i--) {</span>
<a href="#l3.141"></a><span id="l3.141" class="difflineminus">-      endContainer = endContainer.childNodes.item(endPath[i]);</span>
<a href="#l3.142"></a><span id="l3.142" class="difflineminus">-    }</span>
<a href="#l3.143"></a><span id="l3.143" class="difflineminus">-</span>
<a href="#l3.144"></a><span id="l3.144" class="difflineminus">-    // add special markers to record the extent of the selection</span>
<a href="#l3.145"></a><span id="l3.145" class="difflineminus">-    // note: |startOffset| and |endOffset| are interpreted either as</span>
<a href="#l3.146"></a><span id="l3.146" class="difflineminus">-    // offsets in the text data or as child indices (see the Range spec)</span>
<a href="#l3.147"></a><span id="l3.147" class="difflineminus">-    // (here, munging the end point first to keep the start point safe...)</span>
<a href="#l3.148"></a><span id="l3.148" class="difflineminus">-    var tmpNode;</span>
<a href="#l3.149"></a><span id="l3.149" class="difflineminus">-    if (endContainer.nodeType == Node.TEXT_NODE ||</span>
<a href="#l3.150"></a><span id="l3.150" class="difflineminus">-        endContainer.nodeType == Node.CDATA_SECTION_NODE) {</span>
<a href="#l3.151"></a><span id="l3.151" class="difflineminus">-      // do some extra tweaks to try to avoid the view-source output to look like</span>
<a href="#l3.152"></a><span id="l3.152" class="difflineminus">-      // ...&lt;tag&gt;]... or ...]&lt;/tag&gt;... (where ']' marks the end of the selection).</span>
<a href="#l3.153"></a><span id="l3.153" class="difflineminus">-      // To get a neat output, the idea here is to remap the end point from:</span>
<a href="#l3.154"></a><span id="l3.154" class="difflineminus">-      // 1. ...&lt;tag&gt;]...   to   ...]&lt;tag&gt;...</span>
<a href="#l3.155"></a><span id="l3.155" class="difflineminus">-      // 2. ...]&lt;/tag&gt;...  to   ...&lt;/tag&gt;]...</span>
<a href="#l3.156"></a><span id="l3.156" class="difflineminus">-      if ((endOffset &gt; 0 &amp;&amp; endOffset &lt; endContainer.data.length) ||</span>
<a href="#l3.157"></a><span id="l3.157" class="difflineminus">-          !endContainer.parentNode || !endContainer.parentNode.parentNode)</span>
<a href="#l3.158"></a><span id="l3.158" class="difflineminus">-        endContainer.insertData(endOffset, MARK_SELECTION_END);</span>
<a href="#l3.159"></a><span id="l3.159" class="difflineminus">-      else {</span>
<a href="#l3.160"></a><span id="l3.160" class="difflineminus">-        tmpNode = doc.createTextNode(MARK_SELECTION_END);</span>
<a href="#l3.161"></a><span id="l3.161" class="difflineminus">-        endContainer = endContainer.parentNode;</span>
<a href="#l3.162"></a><span id="l3.162" class="difflineminus">-        if (endOffset == 0)</span>
<a href="#l3.163"></a><span id="l3.163" class="difflineminus">-          endContainer.parentNode.insertBefore(tmpNode, endContainer);</span>
<a href="#l3.164"></a><span id="l3.164" class="difflineminus">-        else</span>
<a href="#l3.165"></a><span id="l3.165" class="difflineminus">-          endContainer.parentNode.insertBefore(tmpNode, endContainer.nextSibling);</span>
<a href="#l3.166"></a><span id="l3.166" class="difflineminus">-      }</span>
<a href="#l3.167"></a><span id="l3.167" class="difflineminus">-    }</span>
<a href="#l3.168"></a><span id="l3.168" class="difflineminus">-    else {</span>
<a href="#l3.169"></a><span id="l3.169" class="difflineminus">-      tmpNode = doc.createTextNode(MARK_SELECTION_END);</span>
<a href="#l3.170"></a><span id="l3.170" class="difflineminus">-      endContainer.insertBefore(tmpNode, endContainer.childNodes.item(endOffset));</span>
<a href="#l3.171"></a><span id="l3.171" class="difflineminus">-    }</span>
<a href="#l3.172"></a><span id="l3.172" class="difflineminus">-</span>
<a href="#l3.173"></a><span id="l3.173" class="difflineminus">-    if (startContainer.nodeType == Node.TEXT_NODE ||</span>
<a href="#l3.174"></a><span id="l3.174" class="difflineminus">-        startContainer.nodeType == Node.CDATA_SECTION_NODE) {</span>
<a href="#l3.175"></a><span id="l3.175" class="difflineminus">-      // do some extra tweaks to try to avoid the view-source output to look like</span>
<a href="#l3.176"></a><span id="l3.176" class="difflineminus">-      // ...&lt;tag&gt;[... or ...[&lt;/tag&gt;... (where '[' marks the start of the selection).</span>
<a href="#l3.177"></a><span id="l3.177" class="difflineminus">-      // To get a neat output, the idea here is to remap the start point from:</span>
<a href="#l3.178"></a><span id="l3.178" class="difflineminus">-      // 1. ...&lt;tag&gt;[...   to   ...[&lt;tag&gt;...</span>
<a href="#l3.179"></a><span id="l3.179" class="difflineminus">-      // 2. ...[&lt;/tag&gt;...  to   ...&lt;/tag&gt;[...</span>
<a href="#l3.180"></a><span id="l3.180" class="difflineminus">-      if ((startOffset &gt; 0 &amp;&amp; startOffset &lt; startContainer.data.length) ||</span>
<a href="#l3.181"></a><span id="l3.181" class="difflineminus">-          !startContainer.parentNode || !startContainer.parentNode.parentNode ||</span>
<a href="#l3.182"></a><span id="l3.182" class="difflineminus">-          startContainer != startContainer.parentNode.lastChild)</span>
<a href="#l3.183"></a><span id="l3.183" class="difflineminus">-        startContainer.insertData(startOffset, MARK_SELECTION_START);</span>
<a href="#l3.184"></a><span id="l3.184" class="difflineminus">-      else {</span>
<a href="#l3.185"></a><span id="l3.185" class="difflineminus">-        tmpNode = doc.createTextNode(MARK_SELECTION_START);</span>
<a href="#l3.186"></a><span id="l3.186" class="difflineminus">-        startContainer = startContainer.parentNode;</span>
<a href="#l3.187"></a><span id="l3.187" class="difflineminus">-        if (startOffset == 0)</span>
<a href="#l3.188"></a><span id="l3.188" class="difflineminus">-          startContainer.parentNode.insertBefore(tmpNode, startContainer);</span>
<a href="#l3.189"></a><span id="l3.189" class="difflineminus">-        else</span>
<a href="#l3.190"></a><span id="l3.190" class="difflineminus">-          startContainer.parentNode.insertBefore(tmpNode, startContainer.nextSibling);</span>
<a href="#l3.191"></a><span id="l3.191" class="difflineminus">-      }</span>
<a href="#l3.192"></a><span id="l3.192" class="difflineminus">-    }</span>
<a href="#l3.193"></a><span id="l3.193" class="difflineminus">-    else {</span>
<a href="#l3.194"></a><span id="l3.194" class="difflineminus">-      tmpNode = doc.createTextNode(MARK_SELECTION_START);</span>
<a href="#l3.195"></a><span id="l3.195" class="difflineminus">-      startContainer.insertBefore(tmpNode, startContainer.childNodes.item(startOffset));</span>
<a href="#l3.196"></a><span id="l3.196" class="difflineminus">-    }</span>
<a href="#l3.197"></a><span id="l3.197" class="difflineminus">-  }</span>
<a href="#l3.198"></a><span id="l3.198" class="difflineminus">-</span>
<a href="#l3.199"></a><span id="l3.199" class="difflineminus">-  // now extract and display the syntax highlighted source</span>
<a href="#l3.200"></a><span id="l3.200" class="difflineminus">-  tmpNode = doc.createElementNS(NS_XHTML, 'div');</span>
<a href="#l3.201"></a><span id="l3.201" class="difflineminus">-  tmpNode.appendChild(ancestorContainer);</span>
<a href="#l3.202"></a><span id="l3.202" class="difflineminus">-</span>
<a href="#l3.203"></a><span id="l3.203" class="difflineminus">-  // the load is aynchronous and so we will wait until the view-source DOM is done</span>
<a href="#l3.204"></a><span id="l3.204" class="difflineminus">-  // before drawing the selection.</span>
<a href="#l3.205"></a><span id="l3.205" class="difflineminus">-  if (canDrawSelection) {</span>
<a href="#l3.206"></a><span id="l3.206" class="difflineminus">-    window.document.getElementById(&quot;appcontent&quot;).addEventListener(&quot;load&quot;, drawSelection, true);</span>
<a href="#l3.207"></a><span id="l3.207" class="difflineminus">-  }</span>
<a href="#l3.208"></a><span id="l3.208" class="difflineminus">-</span>
<a href="#l3.209"></a><span id="l3.209" class="difflineminus">-  // all our content is held by the data:URI and URIs are internally stored as utf-8 (see nsIURI.idl)</span>
<a href="#l3.210"></a><span id="l3.210" class="difflineminus">-  var loadFlags = Components.interfaces.nsIWebNavigation.LOAD_FLAGS_NONE;</span>
<a href="#l3.211"></a><span id="l3.211" class="difflineminus">-  getBrowser().webNavigation</span>
<a href="#l3.212"></a><span id="l3.212" class="difflineminus">-              .loadURI(&quot;view-source:data:text/html;charset=utf-8,&quot; + encodeURIComponent(tmpNode.innerHTML),</span>
<a href="#l3.213"></a><span id="l3.213" class="difflineminus">-                       loadFlags, null, null, null);</span>
<a href="#l3.214"></a><span id="l3.214" class="difflineminus">-}</span>
<a href="#l3.215"></a><span id="l3.215" class="difflineminus">-</span>
<a href="#l3.216"></a><span id="l3.216" class="difflineminus">-////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l3.217"></a><span id="l3.217" class="difflineminus">-// helper to get a path like FIXptr, but with an array instead of the &quot;tumbler&quot; notation</span>
<a href="#l3.218"></a><span id="l3.218" class="difflineminus">-// see FIXptr: http://lists.w3.org/Archives/Public/www-xml-linking-comments/2001AprJun/att-0074/01-NOTE-FIXptr-20010425.htm</span>
<a href="#l3.219"></a><span id="l3.219" class="difflineminus">-function getPath(ancestor, node)</span>
<a href="#l3.220"></a><span id="l3.220" class="difflineminus">-{</span>
<a href="#l3.221"></a><span id="l3.221" class="difflineminus">-  var n = node;</span>
<a href="#l3.222"></a><span id="l3.222" class="difflineminus">-  var p = n.parentNode;</span>
<a href="#l3.223"></a><span id="l3.223" class="difflineminus">-  if (n == ancestor || !p)</span>
<a href="#l3.224"></a><span id="l3.224" class="difflineminus">-    return null;</span>
<a href="#l3.225"></a><span id="l3.225" class="difflineminus">-  var path = new Array();</span>
<a href="#l3.226"></a><span id="l3.226" class="difflineminus">-  if (!path)</span>
<a href="#l3.227"></a><span id="l3.227" class="difflineminus">-    return null;</span>
<a href="#l3.228"></a><span id="l3.228" class="difflineminus">-  do {</span>
<a href="#l3.229"></a><span id="l3.229" class="difflineminus">-    for (var i = 0; i &lt; p.childNodes.length; i++) {</span>
<a href="#l3.230"></a><span id="l3.230" class="difflineminus">-      if (p.childNodes.item(i) == n) {</span>
<a href="#l3.231"></a><span id="l3.231" class="difflineminus">-        path.push(i);</span>
<a href="#l3.232"></a><span id="l3.232" class="difflineminus">-        break;</span>
<a href="#l3.233"></a><span id="l3.233" class="difflineminus">-      }</span>
<a href="#l3.234"></a><span id="l3.234" class="difflineminus">-    }</span>
<a href="#l3.235"></a><span id="l3.235" class="difflineminus">-    n = p;</span>
<a href="#l3.236"></a><span id="l3.236" class="difflineminus">-    p = n.parentNode;</span>
<a href="#l3.237"></a><span id="l3.237" class="difflineminus">-  } while (n != ancestor &amp;&amp; p);</span>
<a href="#l3.238"></a><span id="l3.238" class="difflineminus">-  return path;</span>
<a href="#l3.239"></a><span id="l3.239" class="difflineminus">-}</span>
<a href="#l3.240"></a><span id="l3.240" class="difflineminus">-</span>
<a href="#l3.241"></a><span id="l3.241" class="difflineminus">-////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l3.242"></a><span id="l3.242" class="difflineminus">-// using special markers left in the serialized source, this helper makes the</span>
<a href="#l3.243"></a><span id="l3.243" class="difflineminus">-// underlying markup of the selected fragment to automatically appear as selected</span>
<a href="#l3.244"></a><span id="l3.244" class="difflineminus">-// on the inflated view-source DOM</span>
<a href="#l3.245"></a><span id="l3.245" class="difflineminus">-function drawSelection()</span>
<a href="#l3.246"></a><span id="l3.246" class="difflineminus">-{</span>
<a href="#l3.247"></a><span id="l3.247" class="difflineminus">-  // find the special selection markers that we added earlier, and</span>
<a href="#l3.248"></a><span id="l3.248" class="difflineminus">-  // draw the selection between the two...</span>
<a href="#l3.249"></a><span id="l3.249" class="difflineminus">-  var findService = null;</span>
<a href="#l3.250"></a><span id="l3.250" class="difflineminus">-  try {</span>
<a href="#l3.251"></a><span id="l3.251" class="difflineminus">-    // get the find service which stores the global find state</span>
<a href="#l3.252"></a><span id="l3.252" class="difflineminus">-    findService = Components.classes[&quot;@mozilla.org/find/find_service;1&quot;]</span>
<a href="#l3.253"></a><span id="l3.253" class="difflineminus">-                            .getService(Components.interfaces.nsIFindService);</span>
<a href="#l3.254"></a><span id="l3.254" class="difflineminus">-  } catch(e) { }</span>
<a href="#l3.255"></a><span id="l3.255" class="difflineminus">-  if (!findService)</span>
<a href="#l3.256"></a><span id="l3.256" class="difflineminus">-    return;</span>
<a href="#l3.257"></a><span id="l3.257" class="difflineminus">-</span>
<a href="#l3.258"></a><span id="l3.258" class="difflineminus">-  // cache the current global find state</span>
<a href="#l3.259"></a><span id="l3.259" class="difflineminus">-  var matchCase     = findService.matchCase;</span>
<a href="#l3.260"></a><span id="l3.260" class="difflineminus">-  var entireWord    = findService.entireWord;</span>
<a href="#l3.261"></a><span id="l3.261" class="difflineminus">-  var wrapFind      = findService.wrapFind;</span>
<a href="#l3.262"></a><span id="l3.262" class="difflineminus">-  var findBackwards = findService.findBackwards;</span>
<a href="#l3.263"></a><span id="l3.263" class="difflineminus">-  var searchString  = findService.searchString;</span>
<a href="#l3.264"></a><span id="l3.264" class="difflineminus">-  var replaceString = findService.replaceString;</span>
<a href="#l3.265"></a><span id="l3.265" class="difflineminus">-</span>
<a href="#l3.266"></a><span id="l3.266" class="difflineminus">-  // setup our find instance</span>
<a href="#l3.267"></a><span id="l3.267" class="difflineminus">-  var findInst = getBrowser().webBrowserFind;</span>
<a href="#l3.268"></a><span id="l3.268" class="difflineminus">-  findInst.matchCase = true;</span>
<a href="#l3.269"></a><span id="l3.269" class="difflineminus">-  findInst.entireWord = false;</span>
<a href="#l3.270"></a><span id="l3.270" class="difflineminus">-  findInst.wrapFind = true;</span>
<a href="#l3.271"></a><span id="l3.271" class="difflineminus">-  findInst.findBackwards = false;</span>
<a href="#l3.272"></a><span id="l3.272" class="difflineminus">-</span>
<a href="#l3.273"></a><span id="l3.273" class="difflineminus">-  // ...lookup the start mark</span>
<a href="#l3.274"></a><span id="l3.274" class="difflineminus">-  findInst.searchString = MARK_SELECTION_START;</span>
<a href="#l3.275"></a><span id="l3.275" class="difflineminus">-  var startLength = MARK_SELECTION_START.length;</span>
<a href="#l3.276"></a><span id="l3.276" class="difflineminus">-  findInst.findNext();</span>
<a href="#l3.277"></a><span id="l3.277" class="difflineminus">-</span>
<a href="#l3.278"></a><span id="l3.278" class="difflineminus">-  var contentWindow = getBrowser().contentDocument.defaultView;</span>
<a href="#l3.279"></a><span id="l3.279" class="difflineminus">-  var selection = contentWindow.getSelection();</span>
<a href="#l3.280"></a><span id="l3.280" class="difflineminus">-  var range = selection.getRangeAt(0);</span>
<a href="#l3.281"></a><span id="l3.281" class="difflineminus">-</span>
<a href="#l3.282"></a><span id="l3.282" class="difflineminus">-  var startContainer = range.startContainer;</span>
<a href="#l3.283"></a><span id="l3.283" class="difflineminus">-  var startOffset = range.startOffset;</span>
<a href="#l3.284"></a><span id="l3.284" class="difflineminus">-</span>
<a href="#l3.285"></a><span id="l3.285" class="difflineminus">-  // ...lookup the end mark</span>
<a href="#l3.286"></a><span id="l3.286" class="difflineminus">-  findInst.searchString = MARK_SELECTION_END;</span>
<a href="#l3.287"></a><span id="l3.287" class="difflineminus">-  var endLength = MARK_SELECTION_END.length;</span>
<a href="#l3.288"></a><span id="l3.288" class="difflineminus">-  findInst.findNext();</span>
<a href="#l3.289"></a><span id="l3.289" class="difflineminus">-</span>
<a href="#l3.290"></a><span id="l3.290" class="difflineminus">-  var endContainer = selection.anchorNode;</span>
<a href="#l3.291"></a><span id="l3.291" class="difflineminus">-  var endOffset = selection.anchorOffset;</span>
<a href="#l3.292"></a><span id="l3.292" class="difflineminus">-</span>
<a href="#l3.293"></a><span id="l3.293" class="difflineminus">-  // reset the selection that find has left</span>
<a href="#l3.294"></a><span id="l3.294" class="difflineminus">-  selection.removeAllRanges();</span>
<a href="#l3.295"></a><span id="l3.295" class="difflineminus">-</span>
<a href="#l3.296"></a><span id="l3.296" class="difflineminus">-  // delete the special markers now...</span>
<a href="#l3.297"></a><span id="l3.297" class="difflineminus">-  endContainer.deleteData(endOffset, endLength);</span>
<a href="#l3.298"></a><span id="l3.298" class="difflineminus">-  startContainer.deleteData(startOffset, startLength);</span>
<a href="#l3.299"></a><span id="l3.299" class="difflineminus">-  if (startContainer == endContainer)</span>
<a href="#l3.300"></a><span id="l3.300" class="difflineminus">-    endOffset -= startLength; // has shrunk if on same text node...</span>
<a href="#l3.301"></a><span id="l3.301" class="difflineminus">-  range.setEnd(endContainer, endOffset);</span>
<a href="#l3.302"></a><span id="l3.302" class="difflineminus">-</span>
<a href="#l3.303"></a><span id="l3.303" class="difflineminus">-  // show the selection and scroll it into view</span>
<a href="#l3.304"></a><span id="l3.304" class="difflineminus">-  selection.addRange(range);</span>
<a href="#l3.305"></a><span id="l3.305" class="difflineminus">-  // the default behavior of the selection is to scroll at the end of</span>
<a href="#l3.306"></a><span id="l3.306" class="difflineminus">-  // the selection, whereas in this situation, it is more user-friendly</span>
<a href="#l3.307"></a><span id="l3.307" class="difflineminus">-  // to scroll at the beginning. So we override the default behavior here</span>
<a href="#l3.308"></a><span id="l3.308" class="difflineminus">-  try {</span>
<a href="#l3.309"></a><span id="l3.309" class="difflineminus">-    getBrowser().docShell</span>
<a href="#l3.310"></a><span id="l3.310" class="difflineminus">-                .QueryInterface(Components.interfaces.nsIInterfaceRequestor)</span>
<a href="#l3.311"></a><span id="l3.311" class="difflineminus">-                .getInterface(Components.interfaces.nsISelectionDisplay)</span>
<a href="#l3.312"></a><span id="l3.312" class="difflineminus">-                .QueryInterface(Components.interfaces.nsISelectionController)</span>
<a href="#l3.313"></a><span id="l3.313" class="difflineminus">-                .scrollSelectionIntoView(Components.interfaces.nsISelectionController.SELECTION_NORMAL,</span>
<a href="#l3.314"></a><span id="l3.314" class="difflineminus">-                                         Components.interfaces.nsISelectionController.SELECTION_ANCHOR_REGION,</span>
<a href="#l3.315"></a><span id="l3.315" class="difflineminus">-                                         true);</span>
<a href="#l3.316"></a><span id="l3.316" class="difflineminus">-  }</span>
<a href="#l3.317"></a><span id="l3.317" class="difflineminus">-  catch(e) { }</span>
<a href="#l3.318"></a><span id="l3.318" class="difflineminus">-</span>
<a href="#l3.319"></a><span id="l3.319" class="difflineminus">-  // restore the current find state</span>
<a href="#l3.320"></a><span id="l3.320" class="difflineminus">-  findService.matchCase     = matchCase;</span>
<a href="#l3.321"></a><span id="l3.321" class="difflineminus">-  findService.entireWord    = entireWord;</span>
<a href="#l3.322"></a><span id="l3.322" class="difflineminus">-  findService.wrapFind      = wrapFind;</span>
<a href="#l3.323"></a><span id="l3.323" class="difflineminus">-  findService.findBackwards = findBackwards;</span>
<a href="#l3.324"></a><span id="l3.324" class="difflineminus">-  findService.searchString  = searchString;</span>
<a href="#l3.325"></a><span id="l3.325" class="difflineminus">-  findService.replaceString = replaceString;</span>
<a href="#l3.326"></a><span id="l3.326" class="difflineminus">-</span>
<a href="#l3.327"></a><span id="l3.327" class="difflineminus">-  findInst.matchCase     = matchCase;</span>
<a href="#l3.328"></a><span id="l3.328" class="difflineminus">-  findInst.entireWord    = entireWord;</span>
<a href="#l3.329"></a><span id="l3.329" class="difflineminus">-  findInst.wrapFind      = wrapFind;</span>
<a href="#l3.330"></a><span id="l3.330" class="difflineminus">-  findInst.findBackwards = findBackwards;</span>
<a href="#l3.331"></a><span id="l3.331" class="difflineminus">-  findInst.searchString  = searchString;</span>
<a href="#l3.332"></a><span id="l3.332" class="difflineminus">-}</span>
<a href="#l3.333"></a><span id="l3.333" class="difflineminus">-</span>
<a href="#l3.334"></a><span id="l3.334" class="difflineminus">-////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l3.335"></a><span id="l3.335" class="difflineminus">-// special handler for markups such as MathML where reformatting the output is</span>
<a href="#l3.336"></a><span id="l3.336" class="difflineminus">-// helpful</span>
<a href="#l3.337"></a><span id="l3.337" class="difflineminus">-function viewPartialSourceForFragment(node, context)</span>
<a href="#l3.338"></a><span id="l3.338" class="difflineminus">-{</span>
<a href="#l3.339"></a><span id="l3.339" class="difflineminus">-  gTargetNode = node;</span>
<a href="#l3.340"></a><span id="l3.340" class="difflineminus">-  if (gTargetNode &amp;&amp; gTargetNode.nodeType == Node.TEXT_NODE)</span>
<a href="#l3.341"></a><span id="l3.341" class="difflineminus">-    gTargetNode = gTargetNode.parentNode;</span>
<a href="#l3.342"></a><span id="l3.342" class="difflineminus">-</span>
<a href="#l3.343"></a><span id="l3.343" class="difflineminus">-  // walk up the tree to the top-level element (e.g., &lt;math&gt;, &lt;svg&gt;)</span>
<a href="#l3.344"></a><span id="l3.344" class="difflineminus">-  var topTag;</span>
<a href="#l3.345"></a><span id="l3.345" class="difflineminus">-  if (context == 'mathml')</span>
<a href="#l3.346"></a><span id="l3.346" class="difflineminus">-    topTag = 'math';</span>
<a href="#l3.347"></a><span id="l3.347" class="difflineminus">-  else</span>
<a href="#l3.348"></a><span id="l3.348" class="difflineminus">-    throw 'not reached';</span>
<a href="#l3.349"></a><span id="l3.349" class="difflineminus">-  var topNode = gTargetNode;</span>
<a href="#l3.350"></a><span id="l3.350" class="difflineminus">-  while (topNode &amp;&amp; topNode.localName != topTag)</span>
<a href="#l3.351"></a><span id="l3.351" class="difflineminus">-    topNode = topNode.parentNode;</span>
<a href="#l3.352"></a><span id="l3.352" class="difflineminus">-  if (!topNode)</span>
<a href="#l3.353"></a><span id="l3.353" class="difflineminus">-    return;</span>
<a href="#l3.354"></a><span id="l3.354" class="difflineminus">-</span>
<a href="#l3.355"></a><span id="l3.355" class="difflineminus">-  // serialize (note: the main window overrides the title set here)</span>
<a href="#l3.356"></a><span id="l3.356" class="difflineminus">-  var wrapClass = gWrapLongLines ? ' class=&quot;wrap&quot;' : '';</span>
<a href="#l3.357"></a><span id="l3.357" class="difflineminus">-  var source =</span>
<a href="#l3.358"></a><span id="l3.358" class="difflineminus">-    '&lt;!DOCTYPE html&gt;'</span>
<a href="#l3.359"></a><span id="l3.359" class="difflineminus">-  + '&lt;html&gt;'</span>
<a href="#l3.360"></a><span id="l3.360" class="difflineminus">-  + '&lt;head&gt;&lt;title&gt;Mozilla&lt;/title&gt;'</span>
<a href="#l3.361"></a><span id="l3.361" class="difflineminus">-  + '&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;' + gViewSourceCSS + '&quot;&gt;'</span>
<a href="#l3.362"></a><span id="l3.362" class="difflineminus">-  + '&lt;style type=&quot;text/css&quot;&gt;'</span>
<a href="#l3.363"></a><span id="l3.363" class="difflineminus">-  + '#target { border: dashed 1px; background-color: lightyellow; }'</span>
<a href="#l3.364"></a><span id="l3.364" class="difflineminus">-  + '&lt;/style&gt;'</span>
<a href="#l3.365"></a><span id="l3.365" class="difflineminus">-  + '&lt;/head&gt;'</span>
<a href="#l3.366"></a><span id="l3.366" class="difflineminus">-  + '&lt;body id=&quot;viewsource&quot;' + wrapClass</span>
<a href="#l3.367"></a><span id="l3.367" class="difflineminus">-  +        ' onload=&quot;document.getElementById(\'target\').scrollIntoView(true)&quot;&gt;'</span>
<a href="#l3.368"></a><span id="l3.368" class="difflineminus">-  + '&lt;pre&gt;'</span>
<a href="#l3.369"></a><span id="l3.369" class="difflineminus">-  + getOuterMarkup(topNode, 0)</span>
<a href="#l3.370"></a><span id="l3.370" class="difflineminus">-  + '&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;'</span>
<a href="#l3.371"></a><span id="l3.371" class="difflineminus">-  ; // end</span>
<a href="#l3.372"></a><span id="l3.372" class="difflineminus">-</span>
<a href="#l3.373"></a><span id="l3.373" class="difflineminus">-  // display</span>
<a href="#l3.374"></a><span id="l3.374" class="difflineminus">-  var loadFlags = Components.interfaces.nsIWebNavigation.LOAD_FLAGS_NONE;</span>
<a href="#l3.375"></a><span id="l3.375" class="difflineminus">-  getBrowser().webNavigation</span>
<a href="#l3.376"></a><span id="l3.376" class="difflineminus">-              .loadURI(&quot;data:text/html;charset=utf-8,&quot; + encodeURIComponent(source),</span>
<a href="#l3.377"></a><span id="l3.377" class="difflineminus">-                       loadFlags, null, null, null);</span>
<a href="#l3.378"></a><span id="l3.378" class="difflineminus">-}</span>
<a href="#l3.379"></a><span id="l3.379" class="difflineminus">-</span>
<a href="#l3.380"></a><span id="l3.380" class="difflineminus">-////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l3.381"></a><span id="l3.381" class="difflineminus">-function getInnerMarkup(node, indent) {</span>
<a href="#l3.382"></a><span id="l3.382" class="difflineminus">-  var str = '';</span>
<a href="#l3.383"></a><span id="l3.383" class="difflineminus">-  for (var i = 0; i &lt; node.childNodes.length; i++) {</span>
<a href="#l3.384"></a><span id="l3.384" class="difflineminus">-    str += getOuterMarkup(node.childNodes.item(i), indent);</span>
<a href="#l3.385"></a><span id="l3.385" class="difflineminus">-  }</span>
<a href="#l3.386"></a><span id="l3.386" class="difflineminus">-  return str;</span>
<a href="#l3.387"></a><span id="l3.387" class="difflineminus">-}</span>
<a href="#l3.388"></a><span id="l3.388" class="difflineminus">-</span>
<a href="#l3.389"></a><span id="l3.389" class="difflineminus">-////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l3.390"></a><span id="l3.390" class="difflineminus">-function getOuterMarkup(node, indent) {</span>
<a href="#l3.391"></a><span id="l3.391" class="difflineminus">-  var newline = '';</span>
<a href="#l3.392"></a><span id="l3.392" class="difflineminus">-  var padding = '';</span>
<a href="#l3.393"></a><span id="l3.393" class="difflineminus">-  var str = '';</span>
<a href="#l3.394"></a><span id="l3.394" class="difflineminus">-  if (node == gTargetNode) {</span>
<a href="#l3.395"></a><span id="l3.395" class="difflineminus">-    gStartTargetLine = gLineCount;</span>
<a href="#l3.396"></a><span id="l3.396" class="difflineminus">-    str += '&lt;/pre&gt;&lt;pre id=&quot;target&quot;&gt;';</span>
<a href="#l3.397"></a><span id="l3.397" class="difflineminus">-  }</span>
<a href="#l3.398"></a><span id="l3.398" class="difflineminus">-</span>
<a href="#l3.399"></a><span id="l3.399" class="difflineminus">-  switch (node.nodeType) {</span>
<a href="#l3.400"></a><span id="l3.400" class="difflineminus">-  case Node.ELEMENT_NODE: // Element</span>
<a href="#l3.401"></a><span id="l3.401" class="difflineminus">-    // to avoid the wide gap problem, '\n' is not emitted on the first</span>
<a href="#l3.402"></a><span id="l3.402" class="difflineminus">-    // line and the lines before &amp; after the &lt;pre id=&quot;target&quot;&gt;...&lt;/pre&gt;</span>
<a href="#l3.403"></a><span id="l3.403" class="difflineminus">-    if (gLineCount &gt; 0 &amp;&amp;</span>
<a href="#l3.404"></a><span id="l3.404" class="difflineminus">-        gLineCount != gStartTargetLine &amp;&amp;</span>
<a href="#l3.405"></a><span id="l3.405" class="difflineminus">-        gLineCount != gEndTargetLine) {</span>
<a href="#l3.406"></a><span id="l3.406" class="difflineminus">-      newline = '\n';</span>
<a href="#l3.407"></a><span id="l3.407" class="difflineminus">-    }</span>
<a href="#l3.408"></a><span id="l3.408" class="difflineminus">-    gLineCount++;</span>
<a href="#l3.409"></a><span id="l3.409" class="difflineminus">-    if (gDebug) {</span>
<a href="#l3.410"></a><span id="l3.410" class="difflineminus">-      newline += gLineCount;</span>
<a href="#l3.411"></a><span id="l3.411" class="difflineminus">-    }</span>
<a href="#l3.412"></a><span id="l3.412" class="difflineminus">-    for (var k = 0; k &lt; indent; k++) {</span>
<a href="#l3.413"></a><span id="l3.413" class="difflineminus">-      padding += ' ';</span>
<a href="#l3.414"></a><span id="l3.414" class="difflineminus">-    }</span>
<a href="#l3.415"></a><span id="l3.415" class="difflineminus">-    str += newline + padding</span>
<a href="#l3.416"></a><span id="l3.416" class="difflineminus">-        +  '&amp;lt;&lt;span class=&quot;start-tag&quot;&gt;' + node.nodeName + '&lt;/span&gt;';</span>
<a href="#l3.417"></a><span id="l3.417" class="difflineminus">-    for (var i = 0; i &lt; node.attributes.length; i++) {</span>
<a href="#l3.418"></a><span id="l3.418" class="difflineminus">-      var attr = node.attributes.item(i);</span>
<a href="#l3.419"></a><span id="l3.419" class="difflineminus">-      if (!gDebug &amp;&amp; attr.nodeName.match(/^[-_]moz/)) {</span>
<a href="#l3.420"></a><span id="l3.420" class="difflineminus">-        continue;</span>
<a href="#l3.421"></a><span id="l3.421" class="difflineminus">-      }</span>
<a href="#l3.422"></a><span id="l3.422" class="difflineminus">-      str += ' &lt;span class=&quot;attribute-name&quot;&gt;'</span>
<a href="#l3.423"></a><span id="l3.423" class="difflineminus">-          +  attr.nodeName</span>
<a href="#l3.424"></a><span id="l3.424" class="difflineminus">-          +  '&lt;/span&gt;=&lt;span class=&quot;attribute-value&quot;&gt;&quot;'</span>
<a href="#l3.425"></a><span id="l3.425" class="difflineminus">-          +  unicodeTOentity(attr.nodeValue)</span>
<a href="#l3.426"></a><span id="l3.426" class="difflineminus">-          +  '&quot;&lt;/span&gt;';</span>
<a href="#l3.427"></a><span id="l3.427" class="difflineminus">-    }</span>
<a href="#l3.428"></a><span id="l3.428" class="difflineminus">-    if (!node.hasChildNodes()) {</span>
<a href="#l3.429"></a><span id="l3.429" class="difflineminus">-      str += '/&amp;gt;';</span>
<a href="#l3.430"></a><span id="l3.430" class="difflineminus">-    }</span>
<a href="#l3.431"></a><span id="l3.431" class="difflineminus">-    else {</span>
<a href="#l3.432"></a><span id="l3.432" class="difflineminus">-      str += '&amp;gt;';</span>
<a href="#l3.433"></a><span id="l3.433" class="difflineminus">-      var oldLine = gLineCount;</span>
<a href="#l3.434"></a><span id="l3.434" class="difflineminus">-      str += getInnerMarkup(node, indent + 2);</span>
<a href="#l3.435"></a><span id="l3.435" class="difflineminus">-      if (oldLine == gLineCount) {</span>
<a href="#l3.436"></a><span id="l3.436" class="difflineminus">-        newline = '';</span>
<a href="#l3.437"></a><span id="l3.437" class="difflineminus">-        padding = '';</span>
<a href="#l3.438"></a><span id="l3.438" class="difflineminus">-      }</span>
<a href="#l3.439"></a><span id="l3.439" class="difflineminus">-      else {</span>
<a href="#l3.440"></a><span id="l3.440" class="difflineminus">-        newline = (gLineCount == gEndTargetLine) ? '' : '\n';</span>
<a href="#l3.441"></a><span id="l3.441" class="difflineminus">-        gLineCount++;</span>
<a href="#l3.442"></a><span id="l3.442" class="difflineminus">-        if (gDebug) {</span>
<a href="#l3.443"></a><span id="l3.443" class="difflineminus">-          newline += gLineCount;</span>
<a href="#l3.444"></a><span id="l3.444" class="difflineminus">-        }</span>
<a href="#l3.445"></a><span id="l3.445" class="difflineminus">-      }</span>
<a href="#l3.446"></a><span id="l3.446" class="difflineminus">-      str += newline + padding</span>
<a href="#l3.447"></a><span id="l3.447" class="difflineminus">-          +  '&amp;lt;/&lt;span class=&quot;end-tag&quot;&gt;' + node.nodeName + '&lt;/span&gt;&amp;gt;';</span>
<a href="#l3.448"></a><span id="l3.448" class="difflineminus">-    }</span>
<a href="#l3.449"></a><span id="l3.449" class="difflineminus">-    break;</span>
<a href="#l3.450"></a><span id="l3.450" class="difflineminus">-  case Node.TEXT_NODE: // Text</span>
<a href="#l3.451"></a><span id="l3.451" class="difflineminus">-    var tmp = node.nodeValue.replace(/(\n|\r|\t)+/g, &quot; &quot;).trim();</span>
<a href="#l3.452"></a><span id="l3.452" class="difflineminus">-    if (tmp.length != 0) {</span>
<a href="#l3.453"></a><span id="l3.453" class="difflineminus">-      str += '&lt;span class=&quot;text&quot;&gt;' + unicodeTOentity(tmp) + '&lt;/span&gt;';</span>
<a href="#l3.454"></a><span id="l3.454" class="difflineminus">-    }</span>
<a href="#l3.455"></a><span id="l3.455" class="difflineminus">-    break;</span>
<a href="#l3.456"></a><span id="l3.456" class="difflineminus">-  default:</span>
<a href="#l3.457"></a><span id="l3.457" class="difflineminus">-    break;</span>
<a href="#l3.458"></a><span id="l3.458" class="difflineminus">-  }</span>
<a href="#l3.459"></a><span id="l3.459" class="difflineminus">-</span>
<a href="#l3.460"></a><span id="l3.460" class="difflineminus">-  if (node == gTargetNode) {</span>
<a href="#l3.461"></a><span id="l3.461" class="difflineminus">-    gEndTargetLine = gLineCount;</span>
<a href="#l3.462"></a><span id="l3.462" class="difflineminus">-    str += '&lt;/pre&gt;&lt;pre&gt;';</span>
<a href="#l3.463"></a><span id="l3.463" class="difflineminus">-  }</span>
<a href="#l3.464"></a><span id="l3.464" class="difflineminus">-  return str;</span>
<a href="#l3.465"></a><span id="l3.465" class="difflineminus">-}</span>
<a href="#l3.466"></a><span id="l3.466" class="difflineminus">-</span>
<a href="#l3.467"></a><span id="l3.467" class="difflineminus">-////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l3.468"></a><span id="l3.468" class="difflineminus">-function unicodeTOentity(text)</span>
<a href="#l3.469"></a><span id="l3.469" class="difflineminus">-{</span>
<a href="#l3.470"></a><span id="l3.470" class="difflineminus">-  const charTable = {</span>
<a href="#l3.471"></a><span id="l3.471" class="difflineminus">-    '&amp;': '&amp;amp;&lt;span class=&quot;entity&quot;&gt;amp;&lt;/span&gt;',</span>
<a href="#l3.472"></a><span id="l3.472" class="difflineminus">-    '&lt;': '&amp;amp;&lt;span class=&quot;entity&quot;&gt;lt;&lt;/span&gt;',</span>
<a href="#l3.473"></a><span id="l3.473" class="difflineminus">-    '&gt;': '&amp;amp;&lt;span class=&quot;entity&quot;&gt;gt;&lt;/span&gt;',</span>
<a href="#l3.474"></a><span id="l3.474" class="difflineminus">-    '&quot;': '&amp;amp;&lt;span class=&quot;entity&quot;&gt;quot;&lt;/span&gt;'</span>
<a href="#l3.475"></a><span id="l3.475" class="difflineminus">-  };</span>
<a href="#l3.476"></a><span id="l3.476" class="difflineminus">-</span>
<a href="#l3.477"></a><span id="l3.477" class="difflineminus">-  function charTableLookup(letter) {</span>
<a href="#l3.478"></a><span id="l3.478" class="difflineminus">-    return charTable[letter];</span>
<a href="#l3.479"></a><span id="l3.479" class="difflineminus">-  }</span>
<a href="#l3.480"></a><span id="l3.480" class="difflineminus">-</span>
<a href="#l3.481"></a><span id="l3.481" class="difflineminus">-  function convertEntity(letter) {</span>
<a href="#l3.482"></a><span id="l3.482" class="difflineminus">-    try {</span>
<a href="#l3.483"></a><span id="l3.483" class="difflineminus">-      var unichar = gEntityConverter.ConvertToEntity(letter, entityVersion);</span>
<a href="#l3.484"></a><span id="l3.484" class="difflineminus">-      var entity = unichar.substring(1); // extract '&amp;'</span>
<a href="#l3.485"></a><span id="l3.485" class="difflineminus">-      return '&amp;amp;&lt;span class=&quot;entity&quot;&gt;' + entity + '&lt;/span&gt;';</span>
<a href="#l3.486"></a><span id="l3.486" class="difflineminus">-    } catch (ex) {</span>
<a href="#l3.487"></a><span id="l3.487" class="difflineminus">-      return letter;</span>
<a href="#l3.488"></a><span id="l3.488" class="difflineminus">-    }</span>
<a href="#l3.489"></a><span id="l3.489" class="difflineminus">-  }</span>
<a href="#l3.490"></a><span id="l3.490" class="difflineminus">-</span>
<a href="#l3.491"></a><span id="l3.491" class="difflineminus">-  if (!gEntityConverter) {</span>
<a href="#l3.492"></a><span id="l3.492" class="difflineminus">-    try {</span>
<a href="#l3.493"></a><span id="l3.493" class="difflineminus">-      gEntityConverter =</span>
<a href="#l3.494"></a><span id="l3.494" class="difflineminus">-        Components.classes[&quot;@mozilla.org/intl/entityconverter;1&quot;]</span>
<a href="#l3.495"></a><span id="l3.495" class="difflineminus">-                  .createInstance(Components.interfaces.nsIEntityConverter);</span>
<a href="#l3.496"></a><span id="l3.496" class="difflineminus">-    } catch(e) { }</span>
<a href="#l3.497"></a><span id="l3.497" class="difflineminus">-  }</span>
<a href="#l3.498"></a><span id="l3.498" class="difflineminus">-</span>
<a href="#l3.499"></a><span id="l3.499" class="difflineminus">-  const entityVersion = Components.interfaces.nsIEntityConverter.entityW3C;</span>
<a href="#l3.500"></a><span id="l3.500" class="difflineminus">-</span>
<a href="#l3.501"></a><span id="l3.501" class="difflineminus">-  var str = text;</span>
<a href="#l3.502"></a><span id="l3.502" class="difflineminus">-</span>
<a href="#l3.503"></a><span id="l3.503" class="difflineminus">-  // replace chars in our charTable</span>
<a href="#l3.504"></a><span id="l3.504" class="difflineminus">-  str = str.replace(/[&lt;&gt;&amp;&quot;]/g, charTableLookup);</span>
<a href="#l3.505"></a><span id="l3.505" class="difflineminus">-</span>
<a href="#l3.506"></a><span id="l3.506" class="difflineminus">-  // replace chars &gt; 0x7f via nsIEntityConverter</span>
<a href="#l3.507"></a><span id="l3.507" class="difflineminus">-  str = str.replace(/[^\0-\u007f]/g, convertEntity);</span>
<a href="#l3.508"></a><span id="l3.508" class="difflineminus">-</span>
<a href="#l3.509"></a><span id="l3.509" class="difflineminus">-  return str;</span>
<a href="#l3.510"></a><span id="l3.510" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1">deleted file mode 100644</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineminus">--- a/suite/browser/viewPartialSource.xul</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineplus">+++ /dev/null</span>
<a href="#l4.4"></a><span id="l4.4" class="difflineat">@@ -1,104 +0,0 @@</span>
<a href="#l4.5"></a><span id="l4.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!-- -*- Mode: HTML -*- --&gt; </span>
<a href="#l4.6"></a><span id="l4.6" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://navigator/skin/&quot; type=&quot;text/css&quot;?&gt; </span>
<a href="#l4.7"></a><span id="l4.7" class="difflineminus">-</span>
<a href="#l4.8"></a><span id="l4.8" class="difflineminus">-&lt;!-- ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineminus">-   - Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l4.10"></a><span id="l4.10" class="difflineminus">-   -</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineminus">-   - The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-   - 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-   - the License. You may obtain a copy of the License at</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-   - http://www.mozilla.org/MPL/</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-   -</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">-   - Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">-   - WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineminus">-   - for the specific language governing rights and limitations under the</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineminus">-   - License.</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineminus">-   -</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineminus">-   - The Original Code is mozilla.org view-source front end.</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineminus">-   -</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineminus">-   - The Initial Developer of the Original Code is</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineminus">-   - mozilla.org.</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineminus">-   - Portions created by the Initial Developer are Copyright (C) 2002</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineminus">-   - the Initial Developer. All Rights Reserved.</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineminus">-   -</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineminus">-   - Contributor(s):</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineminus">-   -   Roger B. Sidje &lt;rbs@maths.uq.edu.au&gt; (Original Author)</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineminus">-   -   Doron Rosenberg &lt;doronr@naboonline.com&gt;</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-   -</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineminus">-   - Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineminus">-   - either of the GNU General Public License Version 2 or later (the &quot;GPL&quot;),</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineminus">-   - or the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineminus">-   - in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineminus">-   - of those above. If you wish to allow use of your version of this file only</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineminus">-   - under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineminus">-   - use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineminus">-   - decision by deleting the provisions above and replace them with the notice</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineminus">-   - and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineminus">-   - the provisions above, a recipient may use your version of this file under</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineminus">-   - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineminus">-   -</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineminus">-   - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineminus">-</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineminus">-&lt;?xul-overlay href=&quot;chrome://navigator/content/viewSourceOverlay.xul&quot;?&gt;</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineminus">-</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineminus">-&lt;!DOCTYPE window [</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineminus">-&lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot; &gt;</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineminus">-%brandDTD;</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineminus">-&lt;!ENTITY % sourceDTD SYSTEM &quot;chrome://navigator/locale/viewSource.dtd&quot; &gt;</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineminus">-%sourceDTD;</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineminus">-&lt;!ENTITY % navigatorDTD SYSTEM &quot;chrome://navigator/locale/navigator.dtd&quot; &gt;</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineminus">-%navigatorDTD;</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineminus">-&lt;!ENTITY % contentAreaCommandsDTD SYSTEM &quot;chrome://communicator/locale/contentAreaCommands.dtd&quot; &gt;</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineminus">-%contentAreaCommandsDTD;</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineminus">-]&gt;</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineminus">-</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineminus">-&lt;window id=&quot;main-window&quot;</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineminus">-        xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineminus">-        onload=&quot;onLoadViewPartialSource();&quot;</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineminus">-        title=&quot;&amp;viewPartialSourceWindow.title;&quot;</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineminus">-        windowtype=&quot;navigator:view-source&quot;</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineminus">-        width=&quot;500&quot; height=&quot;300&quot;</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineminus">-        screenX=&quot;10&quot; screenY=&quot;10&quot;</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineminus">-        persist=&quot;screenX screenY width height sizemode&quot;&gt;</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineminus">-</span>
<a href="#l4.68"></a><span id="l4.68" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://navigator/content/viewPartialSource.js&quot;/&gt;</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineminus">-</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineminus">-  &lt;commandset id=&quot;commands&quot;/&gt;</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineminus">-  &lt;keyset id=&quot;viewSourceKeys&quot;/&gt;</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineminus">-  &lt;stringbundleset id=&quot;viewSource-stringbundleset&quot;/&gt;</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineminus">-  &lt;popupset id=&quot;viewSourceContextSet&quot; /&gt;</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineminus">-</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineminus">-  &lt;toolbox id=&quot;viewSource-toolbox&quot;&gt;</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineminus">-    &lt;menubar id=&quot;viewSource-main-menubar&quot;&gt;</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineminus">-      &lt;menu id=&quot;menu_File&quot;/&gt;</span>
<a href="#l4.78"></a><span id="l4.78" class="difflineminus">-      &lt;menu id=&quot;menu_Edit&quot;/&gt;</span>
<a href="#l4.79"></a><span id="l4.79" class="difflineminus">-      &lt;menu id=&quot;menu_View&quot;&gt;</span>
<a href="#l4.80"></a><span id="l4.80" class="difflineminus">-        &lt;menupopup id=&quot;menu_View_Popup&quot;&gt;</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineminus">-          &lt;menuitem accesskey=&quot;&amp;reloadCmd.accesskey;&quot; key=&quot;key_reload&quot; label=&quot;&amp;reloadCmd.label;&quot; oncommand=&quot;BrowserReload();&quot;/&gt;</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineminus">-          &lt;menuseparator /&gt;</span>
<a href="#l4.83"></a><span id="l4.83" class="difflineminus">-          &lt;menu id=&quot;menu_zoom&quot;/&gt;  </span>
<a href="#l4.84"></a><span id="l4.84" class="difflineminus">-          &lt;menuseparator/&gt;</span>
<a href="#l4.85"></a><span id="l4.85" class="difflineminus">-&lt;!--      &lt;menuitem key=&quot;key_viewInfo&quot; observes=&quot;View:PageInfo&quot;</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineminus">-                    label=&quot;&amp;pageInfoCmd.label;&quot; accesskey=&quot;&amp;pageInfoCmd.accesskey;&quot;/&gt;</span>
<a href="#l4.87"></a><span id="l4.87" class="difflineminus">-          &lt;menuseparator id=&quot;file_moduleSeparator&quot;/&gt;--&gt;</span>
<a href="#l4.88"></a><span id="l4.88" class="difflineminus">-          &lt;menuitem id=&quot;menu_wrapLongLines&quot; type=&quot;checkbox&quot; oncommand=&quot;wrapLongLines()&quot;</span>
<a href="#l4.89"></a><span id="l4.89" class="difflineminus">-                    label=&quot;&amp;menu_wrapLongLines.title;&quot; accesskey=&quot;&amp;menu_wrapLongLines.accesskey;&quot;/&gt;</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineminus">-          &lt;menuitem type=&quot;checkbox&quot; id=&quot;menu_highlightSyntax&quot; oncommand=&quot;highlightSyntax();&quot;</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineminus">-                    label=&quot;&amp;menu_highlightSyntax.label;&quot; accesskey=&quot;&amp;menu_highlightSyntax.accesskey;&quot;/&gt;</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineminus">-        &lt;/menupopup&gt;</span>
<a href="#l4.93"></a><span id="l4.93" class="difflineminus">-      &lt;/menu&gt;</span>
<a href="#l4.94"></a><span id="l4.94" class="difflineminus">-      &lt;menu id=&quot;windowMenu&quot;/&gt;</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineminus">-      &lt;menu id=&quot;menu_Help&quot;/&gt;</span>
<a href="#l4.96"></a><span id="l4.96" class="difflineminus">-    &lt;/menubar&gt;</span>
<a href="#l4.97"></a><span id="l4.97" class="difflineminus">-  &lt;/toolbox&gt;</span>
<a href="#l4.98"></a><span id="l4.98" class="difflineminus">-  </span>
<a href="#l4.99"></a><span id="l4.99" class="difflineminus">-  &lt;vbox id=&quot;appcontent&quot; flex=&quot;1&quot;</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineminus">-        ondragdrop=&quot;nsDragAndDrop.drop(event, contentAreaDNDObserver);&quot;&gt;</span>
<a href="#l4.101"></a><span id="l4.101" class="difflineminus">-</span>
<a href="#l4.102"></a><span id="l4.102" class="difflineminus">-    &lt;browser id=&quot;content&quot; type=&quot;content-primary&quot; name=&quot;content&quot; src=&quot;about:blank&quot; flex=&quot;1&quot;</span>
<a href="#l4.103"></a><span id="l4.103" class="difflineminus">-             disablehistory=&quot;true&quot; disablesecurity=&quot;true&quot;</span>
<a href="#l4.104"></a><span id="l4.104" class="difflineminus">-             context=&quot;viewSourceContextMenu&quot;/&gt;</span>
<a href="#l4.105"></a><span id="l4.105" class="difflineminus">-</span>
<a href="#l4.106"></a><span id="l4.106" class="difflineminus">-  &lt;/vbox&gt;</span>
<a href="#l4.107"></a><span id="l4.107" class="difflineminus">-</span>
<a href="#l4.108"></a><span id="l4.108" class="difflineminus">-&lt;/window&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1">deleted file mode 100644</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineminus">--- a/suite/browser/viewSource.xul</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineplus">+++ /dev/null</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineat">@@ -1,109 +0,0 @@</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!-- -*- Mode: HTML -*- --&gt; </span>
<a href="#l5.6"></a><span id="l5.6" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://navigator/skin/&quot; type=&quot;text/css&quot;?&gt; </span>
<a href="#l5.7"></a><span id="l5.7" class="difflineminus">-</span>
<a href="#l5.8"></a><span id="l5.8" class="difflineminus">-&lt;!-- ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineminus">-   - Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineminus">-   -</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineminus">-   - The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-   - 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-   - the License. You may obtain a copy of the License at</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-   - http://www.mozilla.org/MPL/</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineminus">-   -</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineminus">-   - Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineminus">-   - WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineminus">-   - for the specific language governing rights and limitations under the</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineminus">-   - License.</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineminus">-   -</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineminus">-   - The Original Code is mozilla.org viewsource frontend.</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineminus">-   -</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineminus">-   - The Initial Developer of the Original Code is</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineminus">-   - Netscape Communications Corporation.</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineminus">-   - Portions created by the Initial Developer are Copyright (C) 2000</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineminus">-   - the Initial Developer. All Rights Reserved.</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineminus">-   -</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineminus">-   - Contributor(s):</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineminus">-   -   Doron Rosenberg (doronr@naboonline.com)</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineminus">-   -   Roger B. Sidje (rbs@maths.uq.edu.au)</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-   -</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineminus">-   - Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineminus">-   - either of the GNU General Public License Version 2 or later (the &quot;GPL&quot;),</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineminus">-   - or the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineminus">-   - in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineminus">-   - of those above. If you wish to allow use of your version of this file only</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineminus">-   - under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineminus">-   - use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineminus">-   - decision by deleting the provisions above and replace them with the notice</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineminus">-   - and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineminus">-   - the provisions above, a recipient may use your version of this file under</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineminus">-   - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineminus">-   -</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineminus">-   - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineminus">-</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineminus">-&lt;?xul-overlay href=&quot;chrome://navigator/content/viewSourceOverlay.xul&quot;?&gt;</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineminus">-</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineminus">-&lt;!DOCTYPE window [</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineminus">-&lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot; &gt;</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineminus">-%brandDTD;</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineminus">-&lt;!ENTITY % sourceDTD SYSTEM &quot;chrome://navigator/locale/viewSource.dtd&quot; &gt;</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineminus">-%sourceDTD;</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineminus">-&lt;!ENTITY % navigatorDTD SYSTEM &quot;chrome://navigator/locale/navigator.dtd&quot; &gt;</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineminus">-%navigatorDTD;</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineminus">-&lt;!ENTITY % contentAreaCommandsDTD SYSTEM &quot;chrome://communicator/locale/contentAreaCommands.dtd&quot; &gt;</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineminus">-%contentAreaCommandsDTD;</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineminus">-]&gt;</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineminus">-</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineminus">-&lt;window id=&quot;main-window&quot;</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineminus">-        xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineminus">-        onload=&quot;onLoadViewSource();&quot;</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineminus">-        contenttitlesetting=&quot;true&quot;</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineminus">-        title=&quot;&amp;mainWindow.title;&quot; </span>
<a href="#l5.64"></a><span id="l5.64" class="difflineminus">-        titlemodifier=&quot;&amp;mainWindow.titlemodifier;&quot; </span>
<a href="#l5.65"></a><span id="l5.65" class="difflineminus">-        titlepreface=&quot;&amp;mainWindow.preface;&quot;</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineminus">-        titlemenuseparator =&quot;&amp;mainWindow.titlemodifierseparator;&quot;  </span>
<a href="#l5.67"></a><span id="l5.67" class="difflineminus">-        windowtype=&quot;navigator:view-source&quot;</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineminus">-        width=&quot;640&quot; height=&quot;480&quot;</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineminus">-        screenX=&quot;10&quot; screenY=&quot;10&quot;</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineminus">-        persist=&quot;screenX screenY width height sizemode&quot;&gt;</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineminus">-</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineminus">-  &lt;commandset id=&quot;commands&quot;/&gt;</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineminus">-  &lt;keyset id=&quot;viewSourceKeys&quot;/&gt;</span>
<a href="#l5.74"></a><span id="l5.74" class="difflineminus">-  &lt;stringbundleset id=&quot;viewSource-stringbundleset&quot;/&gt;</span>
<a href="#l5.75"></a><span id="l5.75" class="difflineminus">-  &lt;popupset id=&quot;viewSourceContextSet&quot; /&gt;</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineminus">-</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineminus">-  &lt;toolbox id=&quot;viewSource-toolbox&quot;&gt;</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineminus">-    &lt;menubar id=&quot;viewSource-main-menubar&quot;&gt;</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineminus">-      &lt;menu id=&quot;menu_File&quot;/&gt;</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineminus">-      &lt;menu id=&quot;menu_Edit&quot;/&gt;</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineminus">-      &lt;menu id=&quot;menu_View&quot;&gt;</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineminus">-        &lt;menupopup id=&quot;menu_View_Popup&quot;&gt;</span>
<a href="#l5.83"></a><span id="l5.83" class="difflineminus">-          &lt;menuitem accesskey=&quot;&amp;reloadCmd.accesskey;&quot; key=&quot;key_reload&quot; label=&quot;&amp;reloadCmd.label;&quot; oncommand=&quot;BrowserReload();&quot;/&gt;</span>
<a href="#l5.84"></a><span id="l5.84" class="difflineminus">-          &lt;menuseparator /&gt;</span>
<a href="#l5.85"></a><span id="l5.85" class="difflineminus">-          &lt;menu id=&quot;menu_zoom&quot;/&gt;  </span>
<a href="#l5.86"></a><span id="l5.86" class="difflineminus">-          &lt;menuseparator/&gt;</span>
<a href="#l5.87"></a><span id="l5.87" class="difflineminus">-&lt;!--      &lt;menuitem key=&quot;key_viewInfo&quot; observes=&quot;View:PageInfo&quot;</span>
<a href="#l5.88"></a><span id="l5.88" class="difflineminus">-                    label=&quot;&amp;pageInfoCmd.label;&quot; accesskey=&quot;&amp;pageInfoCmd.accesskey;&quot;/&gt;</span>
<a href="#l5.89"></a><span id="l5.89" class="difflineminus">-          &lt;menuseparator id=&quot;file_moduleSeparator&quot;/&gt;--&gt;</span>
<a href="#l5.90"></a><span id="l5.90" class="difflineminus">-          &lt;menu id=&quot;charsetMenu&quot;/&gt;</span>
<a href="#l5.91"></a><span id="l5.91" class="difflineminus">-          &lt;menuitem id=&quot;menu_wrapLongLines&quot; type=&quot;checkbox&quot; oncommand=&quot;wrapLongLines()&quot;</span>
<a href="#l5.92"></a><span id="l5.92" class="difflineminus">-                    label=&quot;&amp;menu_wrapLongLines.title;&quot; accesskey=&quot;&amp;menu_wrapLongLines.accesskey;&quot;/&gt;</span>
<a href="#l5.93"></a><span id="l5.93" class="difflineminus">-          &lt;menuitem type=&quot;checkbox&quot; id=&quot;menu_highlightSyntax&quot; oncommand=&quot;highlightSyntax();&quot;</span>
<a href="#l5.94"></a><span id="l5.94" class="difflineminus">-                    label=&quot;&amp;menu_highlightSyntax.label;&quot; accesskey=&quot;&amp;menu_highlightSyntax.accesskey;&quot;/&gt;</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineminus">-        &lt;/menupopup&gt;</span>
<a href="#l5.96"></a><span id="l5.96" class="difflineminus">-      &lt;/menu&gt;</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineminus">-      &lt;menu id=&quot;windowMenu&quot;/&gt;</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineminus">-      &lt;menu id=&quot;menu_Help&quot;/&gt;</span>
<a href="#l5.99"></a><span id="l5.99" class="difflineminus">-    &lt;/menubar&gt;</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineminus">-  &lt;/toolbox&gt;</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineminus">-</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineminus">-  &lt;vbox id=&quot;appcontent&quot; flex=&quot;1&quot;</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineminus">-       ondragdrop=&quot;nsDragAndDrop.drop(event, contentAreaDNDObserver);&quot;&gt;</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineminus">-</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineminus">-    &lt;browser id=&quot;content&quot; type=&quot;content-primary&quot; name=&quot;content&quot; src=&quot;about:blank&quot; flex=&quot;1&quot;</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineminus">-             disablesecurity=&quot;true&quot; context=&quot;viewSourceContextMenu&quot; showcaret=&quot;true&quot;/&gt;</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineminus">-</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineminus">-  &lt;/vbox&gt; </span>
<a href="#l5.109"></a><span id="l5.109" class="difflineminus">-</span>
<a href="#l5.110"></a><span id="l5.110" class="difflineminus">-  &lt;statusbar id=&quot;status-bar&quot; class=&quot;chromeclass-status&quot;&gt;</span>
<a href="#l5.111"></a><span id="l5.111" class="difflineminus">-    &lt;statusbarpanel id=&quot;statusbar-line-col&quot; label=&quot;&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l5.112"></a><span id="l5.112" class="difflineminus">-  &lt;/statusbar&gt;</span>
<a href="#l5.113"></a><span id="l5.113" class="difflineminus">-&lt;/window&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">deleted file mode 100644</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineminus">--- a/suite/browser/viewSourceOverlay.xul</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineplus">+++ /dev/null</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineat">@@ -1,189 +0,0 @@</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!-- -*- Mode: HTML -*- --&gt;</span>
<a href="#l6.6"></a><span id="l6.6" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://navigator/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l6.7"></a><span id="l6.7" class="difflineminus">-</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineminus">-&lt;!-- ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineminus">-   - Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineminus">-   -</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineminus">-   - The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-   - 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-   - the License. You may obtain a copy of the License at</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-   - http://www.mozilla.org/MPL/</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-   -</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineminus">-   - Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineminus">-   - WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineminus">-   - for the specific language governing rights and limitations under the</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineminus">-   - License.</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineminus">-   -</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineminus">-   - The Original Code is mozilla.org view-source front-end.</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineminus">-   -</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineminus">-   - The Initial Developer of the Original Code is</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineminus">-   - mozilla.org.</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineminus">-   - Portions created by the Initial Developer are Copyright (C) 2002</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineminus">-   - the Initial Developer. All Rights Reserved.</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineminus">-   -</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineminus">-   - Contributor(s):</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineminus">-   -   Doron Rosenberg (doronr@naboonline.com)</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineminus">-   -   Roger B. Sidje (rbs@maths.uq.edu.au)</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-   -</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineminus">-   - Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineminus">-   - either of the GNU General Public License Version 2 or later (the &quot;GPL&quot;),</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineminus">-   - or the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineminus">-   - in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineminus">-   - of those above. If you wish to allow use of your version of this file only</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineminus">-   - under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineminus">-   - use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineminus">-   - decision by deleting the provisions above and replace them with the notice</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineminus">-   - and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineminus">-   - the provisions above, a recipient may use your version of this file under</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineminus">-   - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineminus">-   -</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineminus">-   - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineminus">-</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineminus">-&lt;?xul-overlay href=&quot;chrome://navigator/content/navigatorOverlay.xul&quot;?&gt;</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineminus">-</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineminus">-&lt;!DOCTYPE overlay [</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineminus">-&lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot; &gt;</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-%brandDTD;</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineminus">-&lt;!ENTITY % sourceDTD SYSTEM &quot;chrome://navigator/locale/viewSource.dtd&quot; &gt;</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineminus">-%sourceDTD;</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineminus">-&lt;!ENTITY % navigatorDTD SYSTEM &quot;chrome://navigator/locale/navigator.dtd&quot; &gt;</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineminus">-%navigatorDTD;</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineminus">-&lt;!ENTITY % contentAreaCommandsDTD SYSTEM &quot;chrome://communicator/locale/contentAreaCommands.dtd&quot; &gt;</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineminus">-%contentAreaCommandsDTD;</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineminus">-]&gt;</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineminus">-</span>
<a href="#l6.59"></a><span id="l6.59" class="difflineminus">-&lt;overlay id=&quot;viewSourceOverlay&quot;</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineminus">-         xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l6.61"></a><span id="l6.61" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/nsDragAndDrop.js&quot;/&gt;</span>
<a href="#l6.62"></a><span id="l6.62" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://communicator/content/contentAreaDD.js&quot;/&gt;</span>
<a href="#l6.63"></a><span id="l6.63" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/printUtils.js&quot;/&gt;</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://navigator/content/browser.js&quot;/&gt;</span>
<a href="#l6.65"></a><span id="l6.65" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://navigator/content/viewsource.js&quot;/&gt;</span>
<a href="#l6.66"></a><span id="l6.66" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://communicator/content/findUtils.js&quot;/&gt;</span>
<a href="#l6.67"></a><span id="l6.67" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/contentAreaUtils.js&quot;/&gt;</span>
<a href="#l6.68"></a><span id="l6.68" class="difflineminus">-</span>
<a href="#l6.69"></a><span id="l6.69" class="difflineminus">-  &lt;commandset id=&quot;commands&quot;&gt;</span>
<a href="#l6.70"></a><span id="l6.70" class="difflineminus">-    &lt;commandset id=&quot;globalEditMenuItems&quot;/&gt;</span>
<a href="#l6.71"></a><span id="l6.71" class="difflineminus">-    &lt;commandset id=&quot;selectEditMenuItems&quot;/&gt;</span>
<a href="#l6.72"></a><span id="l6.72" class="difflineminus">-    &lt;commandset id=&quot;clipboardEditMenuItems&quot;/&gt;</span>
<a href="#l6.73"></a><span id="l6.73" class="difflineminus">-    &lt;commandset id=&quot;viewSourceMenuItems&quot;&gt;</span>
<a href="#l6.74"></a><span id="l6.74" class="difflineminus">-      &lt;command id=&quot;cmd_close&quot; oncommand=&quot;ViewSourceClose()&quot;/&gt;</span>
<a href="#l6.75"></a><span id="l6.75" class="difflineminus">-      &lt;command id=&quot;cmd_savePage&quot; oncommand=&quot;ViewSourceSavePage();&quot;/&gt;</span>
<a href="#l6.76"></a><span id="l6.76" class="difflineminus">-      &lt;command id=&quot;cmd_editPage&quot; oncommand=&quot;ViewSourceEditPage();&quot;/&gt;</span>
<a href="#l6.77"></a><span id="l6.77" class="difflineminus">-      &lt;command id=&quot;cmd_goToLine&quot; oncommand=&quot;ViewSourceGoToLine();&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l6.78"></a><span id="l6.78" class="difflineminus">-    &lt;/commandset&gt;</span>
<a href="#l6.79"></a><span id="l6.79" class="difflineminus">-  &lt;/commandset&gt;</span>
<a href="#l6.80"></a><span id="l6.80" class="difflineminus">-</span>
<a href="#l6.81"></a><span id="l6.81" class="difflineminus">-  &lt;stringbundleset id=&quot;viewSource-stringbundleset&quot;&gt;</span>
<a href="#l6.82"></a><span id="l6.82" class="difflineminus">-    &lt;stringbundle id=&quot;bundle_viewZoom&quot;/&gt;</span>
<a href="#l6.83"></a><span id="l6.83" class="difflineminus">-    &lt;stringbundle id=&quot;findBundle&quot; src=&quot;chrome://global/locale/finddialog.properties&quot;/&gt;</span>
<a href="#l6.84"></a><span id="l6.84" class="difflineminus">-    &lt;stringbundle id=&quot;viewSourceBundle&quot; src=&quot;chrome://navigator/locale/viewSource.properties&quot;/&gt;</span>
<a href="#l6.85"></a><span id="l6.85" class="difflineminus">-  &lt;/stringbundleset&gt;</span>
<a href="#l6.86"></a><span id="l6.86" class="difflineminus">-</span>
<a href="#l6.87"></a><span id="l6.87" class="difflineminus">-  &lt;!-- keys are appended from the overlay --&gt;</span>
<a href="#l6.88"></a><span id="l6.88" class="difflineminus">-  &lt;keyset id=&quot;viewSourceKeys&quot;&gt;</span>
<a href="#l6.89"></a><span id="l6.89" class="difflineminus">-    &lt;!-- File Menu --&gt;</span>
<a href="#l6.90"></a><span id="l6.90" class="difflineminus">-    &lt;key id=&quot;key_newNavigator&quot;/&gt;</span>
<a href="#l6.91"></a><span id="l6.91" class="difflineminus">-    &lt;key id=&quot;key_newBlankPage&quot;/&gt;</span>
<a href="#l6.92"></a><span id="l6.92" class="difflineminus">-    &lt;key id=&quot;key_savePage&quot;     key=&quot;&amp;savePageCmd.commandkey;&quot; command=&quot;cmd_savePage&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l6.93"></a><span id="l6.93" class="difflineminus">-    &lt;key id=&quot;key_editPage&quot;     key=&quot;&amp;editPageCmd.commandkey;&quot; command=&quot;Browser:EditPage&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l6.94"></a><span id="l6.94" class="difflineminus">-    &lt;key id=&quot;printKb&quot;          key=&quot;&amp;printCmd.commandkey;&quot; command=&quot;Browser:Print&quot;  modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l6.95"></a><span id="l6.95" class="difflineminus">-    &lt;key id=&quot;key_close&quot;/&gt;</span>
<a href="#l6.96"></a><span id="l6.96" class="difflineminus">-</span>
<a href="#l6.97"></a><span id="l6.97" class="difflineminus">-    &lt;!-- Edit Menu --&gt;</span>
<a href="#l6.98"></a><span id="l6.98" class="difflineminus">-    &lt;key id=&quot;key_undo&quot;/&gt;</span>
<a href="#l6.99"></a><span id="l6.99" class="difflineminus">-    &lt;key id=&quot;key_redo&quot;/&gt;</span>
<a href="#l6.100"></a><span id="l6.100" class="difflineminus">-    &lt;key id=&quot;key_cut&quot;/&gt;</span>
<a href="#l6.101"></a><span id="l6.101" class="difflineminus">-    &lt;key id=&quot;key_copy&quot;/&gt;</span>
<a href="#l6.102"></a><span id="l6.102" class="difflineminus">-    &lt;key id=&quot;key_paste&quot;/&gt;</span>
<a href="#l6.103"></a><span id="l6.103" class="difflineminus">-    &lt;key id=&quot;key_delete&quot;/&gt;</span>
<a href="#l6.104"></a><span id="l6.104" class="difflineminus">-    &lt;key id=&quot;key_delete2&quot;/&gt;</span>
<a href="#l6.105"></a><span id="l6.105" class="difflineminus">-    &lt;key id=&quot;key_selectAll&quot;/&gt;</span>
<a href="#l6.106"></a><span id="l6.106" class="difflineminus">-    &lt;key id=&quot;key_goToLine&quot;     key=&quot;&amp;goToLineCmd.commandkey;&quot;  command=&quot;cmd_goToLine&quot;  modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l6.107"></a><span id="l6.107" class="difflineminus">-    &lt;key id=&quot;key_find&quot;         key=&quot;&amp;findOnCmd.commandkey;&quot; command=&quot;Browser:Find&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l6.108"></a><span id="l6.108" class="difflineminus">-    &lt;key id=&quot;key_findAgain&quot;    key=&quot;&amp;findAgainCmd.commandkey;&quot; command=&quot;Browser:FindAgain&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l6.109"></a><span id="l6.109" class="difflineminus">-    &lt;key id=&quot;key_findPrev&quot;     key=&quot;&amp;findPrevCmd.commandkey;&quot;  command=&quot;Browser:FindPrev&quot;  modifiers=&quot;accel, shift&quot;/&gt;</span>
<a href="#l6.110"></a><span id="l6.110" class="difflineminus">-    &lt;key keycode=&quot;&amp;findAgainCmd.commandkey2;&quot; command=&quot;Browser:FindAgain&quot;/&gt;</span>
<a href="#l6.111"></a><span id="l6.111" class="difflineminus">-    &lt;key keycode=&quot;&amp;findPrevCmd.commandkey2;&quot;  command=&quot;Browser:FindPrev&quot;  modifiers=&quot;shift&quot;/&gt;</span>
<a href="#l6.112"></a><span id="l6.112" class="difflineminus">-    &lt;key id=&quot;key_findTypeText&quot;/&gt;</span>
<a href="#l6.113"></a><span id="l6.113" class="difflineminus">-</span>
<a href="#l6.114"></a><span id="l6.114" class="difflineminus">-    &lt;!-- View Menu --&gt;</span>
<a href="#l6.115"></a><span id="l6.115" class="difflineminus">-    &lt;key id=&quot;key_reload&quot;  key=&quot;&amp;reloadCmd.commandkey;&quot; oncommand=&quot;BrowserReload();&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l6.116"></a><span id="l6.116" class="difflineminus">-    &lt;key key=&quot;&amp;reloadCmd.commandkey;&quot; oncommand=&quot;BrowserReloadSkipCache();&quot; modifiers=&quot;accel,shift&quot;/&gt;</span>
<a href="#l6.117"></a><span id="l6.117" class="difflineminus">-    &lt;keyset id=&quot;viewZoomKeys&quot;/&gt;</span>
<a href="#l6.118"></a><span id="l6.118" class="difflineminus">-</span>
<a href="#l6.119"></a><span id="l6.119" class="difflineminus">-    &lt;!-- Window Menu --&gt;</span>
<a href="#l6.120"></a><span id="l6.120" class="difflineminus">-    &lt;keyset id=&quot;tasksKeys&quot;/&gt;</span>
<a href="#l6.121"></a><span id="l6.121" class="difflineminus">-</span>
<a href="#l6.122"></a><span id="l6.122" class="difflineminus">-    &lt;!-- Context Menu --&gt;</span>
<a href="#l6.123"></a><span id="l6.123" class="difflineminus">-    &lt;key keycode=&quot;VK_BACK&quot; command=&quot;Browser:Back&quot;/&gt;</span>
<a href="#l6.124"></a><span id="l6.124" class="difflineminus">-    &lt;key keycode=&quot;VK_BACK&quot; command=&quot;Browser:Forward&quot; modifiers=&quot;shift&quot;/&gt;</span>
<a href="#l6.125"></a><span id="l6.125" class="difflineminus">-    &lt;keyset id=&quot;navigationKeys&quot;/&gt;</span>
<a href="#l6.126"></a><span id="l6.126" class="difflineminus">-  &lt;/keyset&gt;</span>
<a href="#l6.127"></a><span id="l6.127" class="difflineminus">-</span>
<a href="#l6.128"></a><span id="l6.128" class="difflineminus">-  &lt;!-- context menu --&gt;</span>
<a href="#l6.129"></a><span id="l6.129" class="difflineminus">-  &lt;popupset id=&quot;viewSourceContextSet&quot;&gt;</span>
<a href="#l6.130"></a><span id="l6.130" class="difflineminus">-    &lt;popup id=&quot;viewSourceContextMenu&quot;&gt;</span>
<a href="#l6.131"></a><span id="l6.131" class="difflineminus">-      &lt;menuitem id=&quot;context-back&quot; command=&quot;Browser:Back&quot;</span>
<a href="#l6.132"></a><span id="l6.132" class="difflineminus">-                label=&quot;&amp;goBackCmd.label;&quot; accesskey=&quot;&amp;goBackCmd.accesskey;&quot;/&gt;</span>
<a href="#l6.133"></a><span id="l6.133" class="difflineminus">-      &lt;menuitem id=&quot;context-forward&quot; command=&quot;Browser:Forward&quot;</span>
<a href="#l6.134"></a><span id="l6.134" class="difflineminus">-                label=&quot;&amp;goForwardCmd.label;&quot; accesskey=&quot;&amp;goForwardCmd.accesskey;&quot;/&gt;</span>
<a href="#l6.135"></a><span id="l6.135" class="difflineminus">-      &lt;menuseparator/&gt;</span>
<a href="#l6.136"></a><span id="l6.136" class="difflineminus">-      &lt;menuitem label=&quot;&amp;findNextCmd.label;&quot; accesskey=&quot;&amp;findNextCmd.accesskey;&quot;  command=&quot;Browser:FindAgain&quot;/&gt;</span>
<a href="#l6.137"></a><span id="l6.137" class="difflineminus">-      &lt;menuseparator/&gt;</span>
<a href="#l6.138"></a><span id="l6.138" class="difflineminus">-      &lt;menuitem id=&quot;menu_copy_cm&quot; command=&quot;cmd_copy&quot;</span>
<a href="#l6.139"></a><span id="l6.139" class="difflineminus">-                label=&quot;&amp;copyCmd.label;&quot; accesskey=&quot;&amp;copyCmd.accesskey;&quot;/&gt;</span>
<a href="#l6.140"></a><span id="l6.140" class="difflineminus">-      &lt;menuseparator/&gt;</span>
<a href="#l6.141"></a><span id="l6.141" class="difflineminus">-      &lt;menuitem id=&quot;menu_selectAll_cm&quot; command=&quot;cmd_selectAll&quot;</span>
<a href="#l6.142"></a><span id="l6.142" class="difflineminus">-                label=&quot;&amp;selectAllCmd.label;&quot; accesskey=&quot;&amp;selectAllCmd.accesskey;&quot;/&gt;</span>
<a href="#l6.143"></a><span id="l6.143" class="difflineminus">-    &lt;/popup&gt;</span>
<a href="#l6.144"></a><span id="l6.144" class="difflineminus">-  &lt;/popupset&gt;</span>
<a href="#l6.145"></a><span id="l6.145" class="difflineminus">-</span>
<a href="#l6.146"></a><span id="l6.146" class="difflineminus">-  &lt;!-- Common menus --&gt;</span>
<a href="#l6.147"></a><span id="l6.147" class="difflineminus">-      &lt;menu id=&quot;menu_File&quot;&gt;</span>
<a href="#l6.148"></a><span id="l6.148" class="difflineminus">-        &lt;menupopup id=&quot;filemenu-popup&quot; onpopupshowing=&quot;updateSavePageItems();&quot;&gt;</span>
<a href="#l6.149"></a><span id="l6.149" class="difflineminus">-          &lt;menu id=&quot;menu_New&quot;&gt;</span>
<a href="#l6.150"></a><span id="l6.150" class="difflineminus">-            &lt;menupopup id=&quot;menu_NewPopup&quot;&gt;</span>
<a href="#l6.151"></a><span id="l6.151" class="difflineminus">-              &lt;menuitem id=&quot;menu_newNavigator&quot;/&gt;</span>
<a href="#l6.152"></a><span id="l6.152" class="difflineminus">-              &lt;menuitem id=&quot;menu_newEditor&quot;/&gt;</span>
<a href="#l6.153"></a><span id="l6.153" class="difflineminus">-            &lt;/menupopup&gt;</span>
<a href="#l6.154"></a><span id="l6.154" class="difflineminus">-          &lt;/menu&gt;</span>
<a href="#l6.155"></a><span id="l6.155" class="difflineminus">-          &lt;menuitem id=&quot;menu_close&quot;/&gt;</span>
<a href="#l6.156"></a><span id="l6.156" class="difflineminus">-          &lt;menuseparator/&gt;</span>
<a href="#l6.157"></a><span id="l6.157" class="difflineminus">-          &lt;menuitem id=&quot;savepage&quot; key=&quot;key_savePage&quot; command=&quot;cmd_savePage&quot;</span>
<a href="#l6.158"></a><span id="l6.158" class="difflineminus">-                    valueSaveAs=&quot;&amp;savePageAsCmd.label;&quot; valueSave=&quot;&amp;savePageCmd.label;&quot;</span>
<a href="#l6.159"></a><span id="l6.159" class="difflineminus">-                    accesskey=&quot;&amp;savePageCmd.accesskey;&quot;/&gt;</span>
<a href="#l6.160"></a><span id="l6.160" class="difflineminus">-          &lt;menuseparator/&gt;</span>
<a href="#l6.161"></a><span id="l6.161" class="difflineminus">-          &lt;menuitem key=&quot;key_editPage&quot; command=&quot;cmd_editPage&quot;</span>
<a href="#l6.162"></a><span id="l6.162" class="difflineminus">-                    label=&quot;&amp;editPageCmd.label;&quot; accesskey=&quot;&amp;editPageCmd.accesskey;&quot;/&gt;</span>
<a href="#l6.163"></a><span id="l6.163" class="difflineminus">-          &lt;menuseparator/&gt;</span>
<a href="#l6.164"></a><span id="l6.164" class="difflineminus">-          &lt;menuitem id=&quot;printSetupMenuItem&quot; label=&quot;&amp;printSetupCmd.label;&quot; accesskey=&quot;&amp;printSetupCmd.accesskey;&quot; command=&quot;cmd_printSetup&quot;/&gt;</span>
<a href="#l6.165"></a><span id="l6.165" class="difflineminus">-          &lt;menuitem label=&quot;&amp;printCmd.label;&quot; accesskey=&quot;&amp;printCmd.accesskey;&quot; key=&quot;printKb&quot; command=&quot;Browser:Print&quot;/&gt;</span>
<a href="#l6.166"></a><span id="l6.166" class="difflineminus">-        &lt;/menupopup&gt;</span>
<a href="#l6.167"></a><span id="l6.167" class="difflineminus">-      &lt;/menu&gt;</span>
<a href="#l6.168"></a><span id="l6.168" class="difflineminus">-</span>
<a href="#l6.169"></a><span id="l6.169" class="difflineminus">-      &lt;menu id=&quot;menu_Edit&quot;&gt;</span>
<a href="#l6.170"></a><span id="l6.170" class="difflineminus">-        &lt;menupopup id=&quot;menu_EditPopup&quot;&gt;</span>
<a href="#l6.171"></a><span id="l6.171" class="difflineminus">-          &lt;menuitem id=&quot;menu_undo&quot;/&gt;</span>
<a href="#l6.172"></a><span id="l6.172" class="difflineminus">-          &lt;menuitem id=&quot;menu_redo&quot;/&gt;</span>
<a href="#l6.173"></a><span id="l6.173" class="difflineminus">-          &lt;menuseparator/&gt;</span>
<a href="#l6.174"></a><span id="l6.174" class="difflineminus">-          &lt;menuitem id=&quot;menu_cut&quot;/&gt;</span>
<a href="#l6.175"></a><span id="l6.175" class="difflineminus">-          &lt;menuitem id=&quot;menu_copy&quot;/&gt;</span>
<a href="#l6.176"></a><span id="l6.176" class="difflineminus">-          &lt;menuitem id=&quot;menu_paste&quot;/&gt;</span>
<a href="#l6.177"></a><span id="l6.177" class="difflineminus">-          &lt;menuitem id=&quot;menu_delete&quot;/&gt;</span>
<a href="#l6.178"></a><span id="l6.178" class="difflineminus">-          &lt;menuseparator/&gt;</span>
<a href="#l6.179"></a><span id="l6.179" class="difflineminus">-          &lt;menuitem id=&quot;menu_selectAll&quot;/&gt;</span>
<a href="#l6.180"></a><span id="l6.180" class="difflineminus">-          &lt;menuseparator/&gt;</span>
<a href="#l6.181"></a><span id="l6.181" class="difflineminus">-          &lt;menuitem id=&quot;menu_goToLine&quot; key=&quot;key_goToLine&quot; command=&quot;cmd_goToLine&quot;</span>
<a href="#l6.182"></a><span id="l6.182" class="difflineminus">-                    label=&quot;&amp;goToLineCmd.label;&quot; accesskey=&quot;&amp;goToLineCmd.accesskey;&quot;/&gt;</span>
<a href="#l6.183"></a><span id="l6.183" class="difflineminus">-          &lt;menuitem id=&quot;menu_find&quot; key=&quot;key_find&quot; command=&quot;Browser:Find&quot;</span>
<a href="#l6.184"></a><span id="l6.184" class="difflineminus">-                    label=&quot;&amp;findOnCmd.label;&quot; accesskey=&quot;&amp;findOnCmd.accesskey;&quot;/&gt;</span>
<a href="#l6.185"></a><span id="l6.185" class="difflineminus">-          &lt;menuitem id=&quot;menu_findAgain&quot; key=&quot;key_findAgain&quot; command=&quot;Browser:FindAgain&quot;</span>
<a href="#l6.186"></a><span id="l6.186" class="difflineminus">-                    label=&quot;&amp;findAgainCmd.label;&quot; accesskey=&quot;&amp;findAgainCmd.accesskey;&quot;/&gt;</span>
<a href="#l6.187"></a><span id="l6.187" class="difflineminus">-          &lt;menuitem id=&quot;menu_findPrev&quot; key=&quot;key_findPrev&quot; command=&quot;Browser:FindPrev&quot;</span>
<a href="#l6.188"></a><span id="l6.188" class="difflineminus">-                    label=&quot;&amp;findPrevCmd.label;&quot; accesskey=&quot;&amp;findPrevCmd.accesskey;&quot;/&gt;</span>
<a href="#l6.189"></a><span id="l6.189" class="difflineminus">-          &lt;menuseparator/&gt;</span>
<a href="#l6.190"></a><span id="l6.190" class="difflineminus">-          &lt;menuitem id=&quot;menu_findTypeText&quot;/&gt;</span>
<a href="#l6.191"></a><span id="l6.191" class="difflineminus">-        &lt;/menupopup&gt;</span>
<a href="#l6.192"></a><span id="l6.192" class="difflineminus">-      &lt;/menu&gt;</span>
<a href="#l6.193"></a><span id="l6.193" class="difflineminus">-&lt;/overlay&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">deleted file mode 100644</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineminus">--- a/suite/browser/viewsource.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineplus">+++ /dev/null</span>
<a href="#l7.4"></a><span id="l7.4" class="difflineat">@@ -1,694 +0,0 @@</span>
<a href="#l7.5"></a><span id="l7.5" class="difflineminus">-/* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l7.6"></a><span id="l7.6" class="difflineminus">- * ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l7.7"></a><span id="l7.7" class="difflineminus">- * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l7.8"></a><span id="l7.8" class="difflineminus">- *</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineminus">- * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineminus">- * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineminus">- * the License. You may obtain a copy of the License at</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">- * http://www.mozilla.org/MPL/</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">- *</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">- * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">- * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineminus">- * for the specific language governing rights and limitations under the</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineminus">- * License.</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineminus">- *</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineminus">- * The Original Code is mozilla.org code.</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineminus">- *</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineminus">- * The Initial Developer of the Original Code is</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineminus">- * Netscape Communications Corporation.</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineminus">- * Portions created by the Initial Developer are Copyright (C) 2001</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineminus">- * the Initial Developer. All Rights Reserved.</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineminus">- *</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineminus">- * Contributor(s):</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineminus">- *   Doron Rosenberg (doronr@naboonline.com)</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineminus">- *   Neil Rashbrook (neil@parkwaycc.co.uk)</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineminus">- *</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineminus">- * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">- * either of the GNU General Public License Version 2 or later (the &quot;GPL&quot;),</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineminus">- * or the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineminus">- * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineminus">- * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineminus">- * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineminus">- * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineminus">- * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineminus">- * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineminus">- * the provisions above, a recipient may use your version of this file under</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineminus">- * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineminus">- *</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineminus">- * ***** END LICENSE BLOCK ***** */</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineminus">-</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineminus">-const pageLoaderIface = Components.interfaces.nsIWebPageDescriptor;</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineminus">-const nsISelectionPrivate = Components.interfaces.nsISelectionPrivate;</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineminus">-const nsISelectionController = Components.interfaces.nsISelectionController;</span>
<a href="#l7.47"></a><span id="l7.47" class="difflineminus">-var gBrowser = null;</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineminus">-var gViewSourceBundle = null;</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineminus">-var gPrefs = null;</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineminus">-</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineminus">-var gLastLineFound = '';</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineminus">-var gGoToLine = 0;</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineminus">-</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineminus">-try {</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineminus">-  var prefService = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l7.56"></a><span id="l7.56" class="difflineminus">-                              .getService(Components.interfaces.nsIPrefService);</span>
<a href="#l7.57"></a><span id="l7.57" class="difflineminus">-  gPrefs = prefService.getBranch(null);</span>
<a href="#l7.58"></a><span id="l7.58" class="difflineminus">-} catch (ex) {</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineminus">-}</span>
<a href="#l7.60"></a><span id="l7.60" class="difflineminus">-</span>
<a href="#l7.61"></a><span id="l7.61" class="difflineminus">-var gSelectionListener = {</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineminus">-  timeout: 0,</span>
<a href="#l7.63"></a><span id="l7.63" class="difflineminus">-  attached: false,</span>
<a href="#l7.64"></a><span id="l7.64" class="difflineminus">-  notifySelectionChanged: function(doc, sel, reason)</span>
<a href="#l7.65"></a><span id="l7.65" class="difflineminus">-  {</span>
<a href="#l7.66"></a><span id="l7.66" class="difflineminus">-    // Coalesce notifications within 100ms intervals.</span>
<a href="#l7.67"></a><span id="l7.67" class="difflineminus">-    if (!this.timeout)</span>
<a href="#l7.68"></a><span id="l7.68" class="difflineminus">-      this.timeout = setTimeout(updateStatusBar, 100);</span>
<a href="#l7.69"></a><span id="l7.69" class="difflineminus">-  }</span>
<a href="#l7.70"></a><span id="l7.70" class="difflineminus">-}</span>
<a href="#l7.71"></a><span id="l7.71" class="difflineminus">-</span>
<a href="#l7.72"></a><span id="l7.72" class="difflineminus">-var gViewSourceProgressListener = {</span>
<a href="#l7.73"></a><span id="l7.73" class="difflineminus">-  QueryInterface: function (aIID) {</span>
<a href="#l7.74"></a><span id="l7.74" class="difflineminus">-    if (aIID.equals(Components.interfaces.nsIWebProgressListener) ||</span>
<a href="#l7.75"></a><span id="l7.75" class="difflineminus">-        aIID.equals(Components.interfaces.nsISupportsWeakReference) ||</span>
<a href="#l7.76"></a><span id="l7.76" class="difflineminus">-        aIID.equals(Components.interfaces.nsISupports))</span>
<a href="#l7.77"></a><span id="l7.77" class="difflineminus">-      return this;</span>
<a href="#l7.78"></a><span id="l7.78" class="difflineminus">-    throw Components.results.NS_NOINTERFACE;</span>
<a href="#l7.79"></a><span id="l7.79" class="difflineminus">-  },</span>
<a href="#l7.80"></a><span id="l7.80" class="difflineminus">-</span>
<a href="#l7.81"></a><span id="l7.81" class="difflineminus">-  onStateChange: function (aWebProgress, aRequest, aStateFlags, aStatus) {</span>
<a href="#l7.82"></a><span id="l7.82" class="difflineminus">-  },</span>
<a href="#l7.83"></a><span id="l7.83" class="difflineminus">-</span>
<a href="#l7.84"></a><span id="l7.84" class="difflineminus">-  onProgressChange: function (aWebProgress, aRequest,</span>
<a href="#l7.85"></a><span id="l7.85" class="difflineminus">-                              aCurSelfProgress, aMaxSelfProgress,</span>
<a href="#l7.86"></a><span id="l7.86" class="difflineminus">-                              aCurTotalProgress, aMaxTotalProgress) {</span>
<a href="#l7.87"></a><span id="l7.87" class="difflineminus">-  },</span>
<a href="#l7.88"></a><span id="l7.88" class="difflineminus">-</span>
<a href="#l7.89"></a><span id="l7.89" class="difflineminus">-  onLocationChange: function (aWebProgress, aRequest, aLocationURI) {</span>
<a href="#l7.90"></a><span id="l7.90" class="difflineminus">-    UpdateBackForwardCommands(getBrowser().webNavigation);</span>
<a href="#l7.91"></a><span id="l7.91" class="difflineminus">-  },</span>
<a href="#l7.92"></a><span id="l7.92" class="difflineminus">-</span>
<a href="#l7.93"></a><span id="l7.93" class="difflineminus">-  onStatusChange: function (aWebProgress, aRequest, aStatus, aMessage) {</span>
<a href="#l7.94"></a><span id="l7.94" class="difflineminus">-  },</span>
<a href="#l7.95"></a><span id="l7.95" class="difflineminus">-</span>
<a href="#l7.96"></a><span id="l7.96" class="difflineminus">-  onSecurityChange: function (aWebProgress, aRequest, aState) {</span>
<a href="#l7.97"></a><span id="l7.97" class="difflineminus">-  }</span>
<a href="#l7.98"></a><span id="l7.98" class="difflineminus">-}</span>
<a href="#l7.99"></a><span id="l7.99" class="difflineminus">-</span>
<a href="#l7.100"></a><span id="l7.100" class="difflineminus">-function onLoadViewSource() </span>
<a href="#l7.101"></a><span id="l7.101" class="difflineminus">-{</span>
<a href="#l7.102"></a><span id="l7.102" class="difflineminus">-  viewSource(window.arguments[0]);</span>
<a href="#l7.103"></a><span id="l7.103" class="difflineminus">-  document.commandDispatcher.focusedWindow = content;</span>
<a href="#l7.104"></a><span id="l7.104" class="difflineminus">-}</span>
<a href="#l7.105"></a><span id="l7.105" class="difflineminus">-</span>
<a href="#l7.106"></a><span id="l7.106" class="difflineminus">-function getBrowser()</span>
<a href="#l7.107"></a><span id="l7.107" class="difflineminus">-{</span>
<a href="#l7.108"></a><span id="l7.108" class="difflineminus">-  if (!gBrowser)</span>
<a href="#l7.109"></a><span id="l7.109" class="difflineminus">-    gBrowser = document.getElementById(&quot;content&quot;);</span>
<a href="#l7.110"></a><span id="l7.110" class="difflineminus">-  return gBrowser;</span>
<a href="#l7.111"></a><span id="l7.111" class="difflineminus">-}</span>
<a href="#l7.112"></a><span id="l7.112" class="difflineminus">-</span>
<a href="#l7.113"></a><span id="l7.113" class="difflineminus">-function getSelectionController()</span>
<a href="#l7.114"></a><span id="l7.114" class="difflineminus">-{</span>
<a href="#l7.115"></a><span id="l7.115" class="difflineminus">-  return getBrowser().docShell</span>
<a href="#l7.116"></a><span id="l7.116" class="difflineminus">-    .QueryInterface(Components.interfaces.nsIInterfaceRequestor)</span>
<a href="#l7.117"></a><span id="l7.117" class="difflineminus">-    .getInterface(Components.interfaces.nsISelectionDisplay)</span>
<a href="#l7.118"></a><span id="l7.118" class="difflineminus">-    .QueryInterface(nsISelectionController);</span>
<a href="#l7.119"></a><span id="l7.119" class="difflineminus">-</span>
<a href="#l7.120"></a><span id="l7.120" class="difflineminus">-}</span>
<a href="#l7.121"></a><span id="l7.121" class="difflineminus">-</span>
<a href="#l7.122"></a><span id="l7.122" class="difflineminus">-function getViewSourceBundle()</span>
<a href="#l7.123"></a><span id="l7.123" class="difflineminus">-{</span>
<a href="#l7.124"></a><span id="l7.124" class="difflineminus">-  if (!gViewSourceBundle)</span>
<a href="#l7.125"></a><span id="l7.125" class="difflineminus">-    gViewSourceBundle = document.getElementById(&quot;viewSourceBundle&quot;);</span>
<a href="#l7.126"></a><span id="l7.126" class="difflineminus">-  return gViewSourceBundle;</span>
<a href="#l7.127"></a><span id="l7.127" class="difflineminus">-}</span>
<a href="#l7.128"></a><span id="l7.128" class="difflineminus">-</span>
<a href="#l7.129"></a><span id="l7.129" class="difflineminus">-function viewSource(url)</span>
<a href="#l7.130"></a><span id="l7.130" class="difflineminus">-{</span>
<a href="#l7.131"></a><span id="l7.131" class="difflineminus">-  if (!url)</span>
<a href="#l7.132"></a><span id="l7.132" class="difflineminus">-    return false; // throw Components.results.NS_ERROR_FAILURE;</span>
<a href="#l7.133"></a><span id="l7.133" class="difflineminus">-</span>
<a href="#l7.134"></a><span id="l7.134" class="difflineminus">-  var viewSrcUrl = &quot;view-source:&quot; + url;</span>
<a href="#l7.135"></a><span id="l7.135" class="difflineminus">-</span>
<a href="#l7.136"></a><span id="l7.136" class="difflineminus">-  getBrowser().addEventListener(&quot;unload&quot;, onUnloadContent, true);</span>
<a href="#l7.137"></a><span id="l7.137" class="difflineminus">-  getBrowser().addEventListener(&quot;load&quot;, onLoadContent, true);</span>
<a href="#l7.138"></a><span id="l7.138" class="difflineminus">-  window.addEventListener(&quot;AppCommand&quot;, HandleAppCommandEvent, true);</span>
<a href="#l7.139"></a><span id="l7.139" class="difflineminus">-</span>
<a href="#l7.140"></a><span id="l7.140" class="difflineminus">-  // Attach the progress listener.</span>
<a href="#l7.141"></a><span id="l7.141" class="difflineminus">-  getBrowser().addProgressListener(gViewSourceProgressListener,</span>
<a href="#l7.142"></a><span id="l7.142" class="difflineminus">-      Components.interfaces.nsIWebProgress.NOTIFY_LOCATION);</span>
<a href="#l7.143"></a><span id="l7.143" class="difflineminus">-</span>
<a href="#l7.144"></a><span id="l7.144" class="difflineminus">-  var loadFromURL = true;</span>
<a href="#l7.145"></a><span id="l7.145" class="difflineminus">-  //</span>
<a href="#l7.146"></a><span id="l7.146" class="difflineminus">-  // Parse the 'arguments' supplied with the dialog.</span>
<a href="#l7.147"></a><span id="l7.147" class="difflineminus">-  //    arg[0] - URL string.</span>
<a href="#l7.148"></a><span id="l7.148" class="difflineminus">-  //    arg[1] - Charset value in the form 'charset=xxx'.</span>
<a href="#l7.149"></a><span id="l7.149" class="difflineminus">-  //    arg[2] - Page descriptor used to load content from the cache.</span>
<a href="#l7.150"></a><span id="l7.150" class="difflineminus">-  //    arg[3] - Line number to go to.</span>
<a href="#l7.151"></a><span id="l7.151" class="difflineminus">-  //</span>
<a href="#l7.152"></a><span id="l7.152" class="difflineminus">-  if (&quot;arguments&quot; in window) {</span>
<a href="#l7.153"></a><span id="l7.153" class="difflineminus">-    var arg;</span>
<a href="#l7.154"></a><span id="l7.154" class="difflineminus">-    //</span>
<a href="#l7.155"></a><span id="l7.155" class="difflineminus">-    // Set the charset of the viewsource window...</span>
<a href="#l7.156"></a><span id="l7.156" class="difflineminus">-    //</span>
<a href="#l7.157"></a><span id="l7.157" class="difflineminus">-    if (window.arguments.length &gt;= 2) {</span>
<a href="#l7.158"></a><span id="l7.158" class="difflineminus">-      arg = window.arguments[1];</span>
<a href="#l7.159"></a><span id="l7.159" class="difflineminus">-</span>
<a href="#l7.160"></a><span id="l7.160" class="difflineminus">-      try {</span>
<a href="#l7.161"></a><span id="l7.161" class="difflineminus">-        if (typeof(arg) == &quot;string&quot; &amp;&amp; arg.indexOf('charset=') != -1) {</span>
<a href="#l7.162"></a><span id="l7.162" class="difflineminus">-          var arrayArgComponents = arg.split('=');</span>
<a href="#l7.163"></a><span id="l7.163" class="difflineminus">-          if (arrayArgComponents) {</span>
<a href="#l7.164"></a><span id="l7.164" class="difflineminus">-            //we should &quot;inherit&quot; the charset menu setting in a new window</span>
<a href="#l7.165"></a><span id="l7.165" class="difflineminus">-            getMarkupDocumentViewer().defaultCharacterSet = arrayArgComponents[1];</span>
<a href="#l7.166"></a><span id="l7.166" class="difflineminus">-          } </span>
<a href="#l7.167"></a><span id="l7.167" class="difflineminus">-        }</span>
<a href="#l7.168"></a><span id="l7.168" class="difflineminus">-      } catch (ex) {</span>
<a href="#l7.169"></a><span id="l7.169" class="difflineminus">-        // Ignore the failure and keep processing arguments...</span>
<a href="#l7.170"></a><span id="l7.170" class="difflineminus">-      }</span>
<a href="#l7.171"></a><span id="l7.171" class="difflineminus">-    }</span>
<a href="#l7.172"></a><span id="l7.172" class="difflineminus">-    //</span>
<a href="#l7.173"></a><span id="l7.173" class="difflineminus">-    // Get any specified line to jump to.</span>
<a href="#l7.174"></a><span id="l7.174" class="difflineminus">-    //</span>
<a href="#l7.175"></a><span id="l7.175" class="difflineminus">-    if (window.arguments.length &gt;= 4) {</span>
<a href="#l7.176"></a><span id="l7.176" class="difflineminus">-      arg = window.arguments[3];</span>
<a href="#l7.177"></a><span id="l7.177" class="difflineminus">-      gGoToLine = parseInt(arg);</span>
<a href="#l7.178"></a><span id="l7.178" class="difflineminus">-    }</span>
<a href="#l7.179"></a><span id="l7.179" class="difflineminus">-    //</span>
<a href="#l7.180"></a><span id="l7.180" class="difflineminus">-    // Use the page descriptor to load the content from the cache (if</span>
<a href="#l7.181"></a><span id="l7.181" class="difflineminus">-    // available).</span>
<a href="#l7.182"></a><span id="l7.182" class="difflineminus">-    //</span>
<a href="#l7.183"></a><span id="l7.183" class="difflineminus">-    if (window.arguments.length &gt;= 3) {</span>
<a href="#l7.184"></a><span id="l7.184" class="difflineminus">-      arg = window.arguments[2];</span>
<a href="#l7.185"></a><span id="l7.185" class="difflineminus">-</span>
<a href="#l7.186"></a><span id="l7.186" class="difflineminus">-      try {</span>
<a href="#l7.187"></a><span id="l7.187" class="difflineminus">-        if (typeof(arg) == &quot;object&quot; &amp;&amp; arg != null) {</span>
<a href="#l7.188"></a><span id="l7.188" class="difflineminus">-          var PageLoader = getBrowser().webNavigation.QueryInterface(pageLoaderIface);</span>
<a href="#l7.189"></a><span id="l7.189" class="difflineminus">-</span>
<a href="#l7.190"></a><span id="l7.190" class="difflineminus">-          //</span>
<a href="#l7.191"></a><span id="l7.191" class="difflineminus">-          // Load the page using the page descriptor rather than the URL.</span>
<a href="#l7.192"></a><span id="l7.192" class="difflineminus">-          // This allows the content to be fetched from the cache (if</span>
<a href="#l7.193"></a><span id="l7.193" class="difflineminus">-          // possible) rather than the network...</span>
<a href="#l7.194"></a><span id="l7.194" class="difflineminus">-          //</span>
<a href="#l7.195"></a><span id="l7.195" class="difflineminus">-          PageLoader.loadPage(arg, pageLoaderIface.DISPLAY_AS_SOURCE);</span>
<a href="#l7.196"></a><span id="l7.196" class="difflineminus">-</span>
<a href="#l7.197"></a><span id="l7.197" class="difflineminus">-          // Record the page load in the session history so &lt;back&gt; will work.</span>
<a href="#l7.198"></a><span id="l7.198" class="difflineminus">-          var shEntrySource = arg.QueryInterface(Components.interfaces.nsISHEntry);</span>
<a href="#l7.199"></a><span id="l7.199" class="difflineminus">-          var shEntry = Components.classes[&quot;@mozilla.org/browser/session-history-entry;1&quot;]</span>
<a href="#l7.200"></a><span id="l7.200" class="difflineminus">-                                  .createInstance(Components.interfaces.nsISHEntry);</span>
<a href="#l7.201"></a><span id="l7.201" class="difflineminus">-          shEntry.setURI(makeURI(viewSrcUrl, null, null));</span>
<a href="#l7.202"></a><span id="l7.202" class="difflineminus">-          shEntry.setTitle(viewSrcUrl);</span>
<a href="#l7.203"></a><span id="l7.203" class="difflineminus">-          shEntry.loadType = Components.interfaces.nsIDocShellLoadInfo.loadHistory;</span>
<a href="#l7.204"></a><span id="l7.204" class="difflineminus">-          shEntry.cacheKey = shEntrySource.cacheKey;</span>
<a href="#l7.205"></a><span id="l7.205" class="difflineminus">-          PageLoader.sessionHistory</span>
<a href="#l7.206"></a><span id="l7.206" class="difflineminus">-                    .QueryInterface(Components.interfaces.nsISHistoryInternal)</span>
<a href="#l7.207"></a><span id="l7.207" class="difflineminus">-                    .addEntry(shEntry, true);</span>
<a href="#l7.208"></a><span id="l7.208" class="difflineminus">-</span>
<a href="#l7.209"></a><span id="l7.209" class="difflineminus">-          // The content was successfully loaded from the page cookie and</span>
<a href="#l7.210"></a><span id="l7.210" class="difflineminus">-          // recorded in session history, so we don't need to load via the URL.</span>
<a href="#l7.211"></a><span id="l7.211" class="difflineminus">-          loadFromURL = false;</span>
<a href="#l7.212"></a><span id="l7.212" class="difflineminus">-        }</span>
<a href="#l7.213"></a><span id="l7.213" class="difflineminus">-      } catch(ex) {</span>
<a href="#l7.214"></a><span id="l7.214" class="difflineminus">-        // Ignore the failure.  The content will be loaded via the URL</span>
<a href="#l7.215"></a><span id="l7.215" class="difflineminus">-        // that was supplied in arg[0].</span>
<a href="#l7.216"></a><span id="l7.216" class="difflineminus">-      }</span>
<a href="#l7.217"></a><span id="l7.217" class="difflineminus">-    }</span>
<a href="#l7.218"></a><span id="l7.218" class="difflineminus">-  }</span>
<a href="#l7.219"></a><span id="l7.219" class="difflineminus">-</span>
<a href="#l7.220"></a><span id="l7.220" class="difflineminus">-  if (loadFromURL) {</span>
<a href="#l7.221"></a><span id="l7.221" class="difflineminus">-    //</span>
<a href="#l7.222"></a><span id="l7.222" class="difflineminus">-    // Currently, an exception is thrown if the URL load fails...</span>
<a href="#l7.223"></a><span id="l7.223" class="difflineminus">-    //</span>
<a href="#l7.224"></a><span id="l7.224" class="difflineminus">-    var loadFlags = Components.interfaces.nsIWebNavigation.LOAD_FLAGS_NONE;</span>
<a href="#l7.225"></a><span id="l7.225" class="difflineminus">-    getBrowser().webNavigation.loadURI(viewSrcUrl, loadFlags, null, null, null);</span>
<a href="#l7.226"></a><span id="l7.226" class="difflineminus">-  }</span>
<a href="#l7.227"></a><span id="l7.227" class="difflineminus">-</span>
<a href="#l7.228"></a><span id="l7.228" class="difflineminus">-  //check the view_source.wrap_long_lines pref and set the menuitem's checked attribute accordingly</span>
<a href="#l7.229"></a><span id="l7.229" class="difflineminus">-  if (gPrefs) {</span>
<a href="#l7.230"></a><span id="l7.230" class="difflineminus">-    try {</span>
<a href="#l7.231"></a><span id="l7.231" class="difflineminus">-      var wraplonglinesPrefValue = gPrefs.getBoolPref(&quot;view_source.wrap_long_lines&quot;);</span>
<a href="#l7.232"></a><span id="l7.232" class="difflineminus">-</span>
<a href="#l7.233"></a><span id="l7.233" class="difflineminus">-      if (wraplonglinesPrefValue)</span>
<a href="#l7.234"></a><span id="l7.234" class="difflineminus">-        document.getElementById('menu_wrapLongLines').setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l7.235"></a><span id="l7.235" class="difflineminus">-    } catch (ex) {</span>
<a href="#l7.236"></a><span id="l7.236" class="difflineminus">-    }</span>
<a href="#l7.237"></a><span id="l7.237" class="difflineminus">-    try {</span>
<a href="#l7.238"></a><span id="l7.238" class="difflineminus">-      document.getElementById(&quot;menu_highlightSyntax&quot;).setAttribute(&quot;checked&quot;, gPrefs.getBoolPref(&quot;view_source.syntax_highlight&quot;));</span>
<a href="#l7.239"></a><span id="l7.239" class="difflineminus">-    } catch (ex) {</span>
<a href="#l7.240"></a><span id="l7.240" class="difflineminus">-    }</span>
<a href="#l7.241"></a><span id="l7.241" class="difflineminus">-  } else {</span>
<a href="#l7.242"></a><span id="l7.242" class="difflineminus">-    document.getElementById(&quot;menu_highlightSyntax&quot;).setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l7.243"></a><span id="l7.243" class="difflineminus">-  }</span>
<a href="#l7.244"></a><span id="l7.244" class="difflineminus">-</span>
<a href="#l7.245"></a><span id="l7.245" class="difflineminus">-  window.content.focus();</span>
<a href="#l7.246"></a><span id="l7.246" class="difflineminus">-</span>
<a href="#l7.247"></a><span id="l7.247" class="difflineminus">-  return true;</span>
<a href="#l7.248"></a><span id="l7.248" class="difflineminus">-}</span>
<a href="#l7.249"></a><span id="l7.249" class="difflineminus">-</span>
<a href="#l7.250"></a><span id="l7.250" class="difflineminus">-function onLoadContent()</span>
<a href="#l7.251"></a><span id="l7.251" class="difflineminus">-{</span>
<a href="#l7.252"></a><span id="l7.252" class="difflineminus">-  //</span>
<a href="#l7.253"></a><span id="l7.253" class="difflineminus">-  // If the view source was opened with a &quot;go to line&quot; argument.</span>
<a href="#l7.254"></a><span id="l7.254" class="difflineminus">-  //</span>
<a href="#l7.255"></a><span id="l7.255" class="difflineminus">-  if (gGoToLine &gt; 0) {</span>
<a href="#l7.256"></a><span id="l7.256" class="difflineminus">-    goToLine(gGoToLine);</span>
<a href="#l7.257"></a><span id="l7.257" class="difflineminus">-    gGoToLine = 0;</span>
<a href="#l7.258"></a><span id="l7.258" class="difflineminus">-  }</span>
<a href="#l7.259"></a><span id="l7.259" class="difflineminus">-  document.getElementById('cmd_goToLine').removeAttribute('disabled');</span>
<a href="#l7.260"></a><span id="l7.260" class="difflineminus">-</span>
<a href="#l7.261"></a><span id="l7.261" class="difflineminus">-  // Register a listener so that we can show the caret position on the status bar.</span>
<a href="#l7.262"></a><span id="l7.262" class="difflineminus">-  window.content.getSelection()</span>
<a href="#l7.263"></a><span id="l7.263" class="difflineminus">-   .QueryInterface(nsISelectionPrivate)</span>
<a href="#l7.264"></a><span id="l7.264" class="difflineminus">-   .addSelectionListener(gSelectionListener);</span>
<a href="#l7.265"></a><span id="l7.265" class="difflineminus">-  gSelectionListener.attached = true;</span>
<a href="#l7.266"></a><span id="l7.266" class="difflineminus">-}</span>
<a href="#l7.267"></a><span id="l7.267" class="difflineminus">-</span>
<a href="#l7.268"></a><span id="l7.268" class="difflineminus">-function onUnloadContent()</span>
<a href="#l7.269"></a><span id="l7.269" class="difflineminus">-{</span>
<a href="#l7.270"></a><span id="l7.270" class="difflineminus">-  //</span>
<a href="#l7.271"></a><span id="l7.271" class="difflineminus">-  // Disable &quot;go to line&quot; while reloading due to e.g. change of charset</span>
<a href="#l7.272"></a><span id="l7.272" class="difflineminus">-  // or toggling of syntax highlighting.</span>
<a href="#l7.273"></a><span id="l7.273" class="difflineminus">-  //</span>
<a href="#l7.274"></a><span id="l7.274" class="difflineminus">-  document.getElementById('cmd_goToLine').setAttribute('disabled', 'true');</span>
<a href="#l7.275"></a><span id="l7.275" class="difflineminus">-</span>
<a href="#l7.276"></a><span id="l7.276" class="difflineminus">-  // If we're not just unloading the initial &quot;about:blank&quot; which doesn't have</span>
<a href="#l7.277"></a><span id="l7.277" class="difflineminus">-  // a selection listener, get rid of it so it doesn't try to fire after the</span>
<a href="#l7.278"></a><span id="l7.278" class="difflineminus">-  // window has gone away.</span>
<a href="#l7.279"></a><span id="l7.279" class="difflineminus">-  if (gSelectionListener.attached) {</span>
<a href="#l7.280"></a><span id="l7.280" class="difflineminus">-    window.content.getSelection()</span>
<a href="#l7.281"></a><span id="l7.281" class="difflineminus">-          .QueryInterface(nsISelectionPrivate)</span>
<a href="#l7.282"></a><span id="l7.282" class="difflineminus">-          .removeSelectionListener(gSelectionListener);</span>
<a href="#l7.283"></a><span id="l7.283" class="difflineminus">-    gSelectionListener.attached = false;</span>
<a href="#l7.284"></a><span id="l7.284" class="difflineminus">-  }</span>
<a href="#l7.285"></a><span id="l7.285" class="difflineminus">-}</span>
<a href="#l7.286"></a><span id="l7.286" class="difflineminus">-</span>
<a href="#l7.287"></a><span id="l7.287" class="difflineminus">-function HandleAppCommandEvent(event)</span>
<a href="#l7.288"></a><span id="l7.288" class="difflineminus">-{</span>
<a href="#l7.289"></a><span id="l7.289" class="difflineminus">-  event.stopPropagation();</span>
<a href="#l7.290"></a><span id="l7.290" class="difflineminus">-  switch (event.command) {</span>
<a href="#l7.291"></a><span id="l7.291" class="difflineminus">-    case &quot;Back&quot;:</span>
<a href="#l7.292"></a><span id="l7.292" class="difflineminus">-      BrowserBack();</span>
<a href="#l7.293"></a><span id="l7.293" class="difflineminus">-      break;</span>
<a href="#l7.294"></a><span id="l7.294" class="difflineminus">-    case &quot;Forward&quot;:</span>
<a href="#l7.295"></a><span id="l7.295" class="difflineminus">-      BrowserForward();</span>
<a href="#l7.296"></a><span id="l7.296" class="difflineminus">-      break;</span>
<a href="#l7.297"></a><span id="l7.297" class="difflineminus">-    case &quot;Reload&quot;:</span>
<a href="#l7.298"></a><span id="l7.298" class="difflineminus">-      BrowserReload();</span>
<a href="#l7.299"></a><span id="l7.299" class="difflineminus">-      break;</span>
<a href="#l7.300"></a><span id="l7.300" class="difflineminus">-  }</span>
<a href="#l7.301"></a><span id="l7.301" class="difflineminus">-}</span>
<a href="#l7.302"></a><span id="l7.302" class="difflineminus">-</span>
<a href="#l7.303"></a><span id="l7.303" class="difflineminus">-function ViewSourceClose()</span>
<a href="#l7.304"></a><span id="l7.304" class="difflineminus">-{</span>
<a href="#l7.305"></a><span id="l7.305" class="difflineminus">-  window.close();</span>
<a href="#l7.306"></a><span id="l7.306" class="difflineminus">-}</span>
<a href="#l7.307"></a><span id="l7.307" class="difflineminus">-</span>
<a href="#l7.308"></a><span id="l7.308" class="difflineminus">-function BrowserBack() {</span>
<a href="#l7.309"></a><span id="l7.309" class="difflineminus">-  try {</span>
<a href="#l7.310"></a><span id="l7.310" class="difflineminus">-    getBrowser().goBack();</span>
<a href="#l7.311"></a><span id="l7.311" class="difflineminus">-  }</span>
<a href="#l7.312"></a><span id="l7.312" class="difflineminus">-  catch(ex) {</span>
<a href="#l7.313"></a><span id="l7.313" class="difflineminus">-  }</span>
<a href="#l7.314"></a><span id="l7.314" class="difflineminus">-}</span>
<a href="#l7.315"></a><span id="l7.315" class="difflineminus">-</span>
<a href="#l7.316"></a><span id="l7.316" class="difflineminus">-function BrowserForward() {</span>
<a href="#l7.317"></a><span id="l7.317" class="difflineminus">-  try {</span>
<a href="#l7.318"></a><span id="l7.318" class="difflineminus">-    getBrowser().goForward();</span>
<a href="#l7.319"></a><span id="l7.319" class="difflineminus">-  }</span>
<a href="#l7.320"></a><span id="l7.320" class="difflineminus">-  catch(ex) {</span>
<a href="#l7.321"></a><span id="l7.321" class="difflineminus">-  }</span>
<a href="#l7.322"></a><span id="l7.322" class="difflineminus">-}</span>
<a href="#l7.323"></a><span id="l7.323" class="difflineminus">-</span>
<a href="#l7.324"></a><span id="l7.324" class="difflineminus">-function BrowserReload()</span>
<a href="#l7.325"></a><span id="l7.325" class="difflineminus">-{</span>
<a href="#l7.326"></a><span id="l7.326" class="difflineminus">-  // Reload will always reload from cache which is probably not what's wanted</span>
<a href="#l7.327"></a><span id="l7.327" class="difflineminus">-  BrowserReloadSkipCache();</span>
<a href="#l7.328"></a><span id="l7.328" class="difflineminus">-}</span>
<a href="#l7.329"></a><span id="l7.329" class="difflineminus">-</span>
<a href="#l7.330"></a><span id="l7.330" class="difflineminus">-function BrowserReloadSkipCache()</span>
<a href="#l7.331"></a><span id="l7.331" class="difflineminus">-{</span>
<a href="#l7.332"></a><span id="l7.332" class="difflineminus">-  const webNavigation = getBrowser().webNavigation;</span>
<a href="#l7.333"></a><span id="l7.333" class="difflineminus">-  webNavigation.reload(webNavigation.LOAD_FLAGS_BYPASS_PROXY | webNavigation.LOAD_FLAGS_BYPASS_CACHE);</span>
<a href="#l7.334"></a><span id="l7.334" class="difflineminus">-}</span>
<a href="#l7.335"></a><span id="l7.335" class="difflineminus">-</span>
<a href="#l7.336"></a><span id="l7.336" class="difflineminus">-// Strips the |view-source:| for editPage()</span>
<a href="#l7.337"></a><span id="l7.337" class="difflineminus">-function ViewSourceEditPage()</span>
<a href="#l7.338"></a><span id="l7.338" class="difflineminus">-{</span>
<a href="#l7.339"></a><span id="l7.339" class="difflineminus">-  editPage(window.content.location.href.substring(12));</span>
<a href="#l7.340"></a><span id="l7.340" class="difflineminus">-}</span>
<a href="#l7.341"></a><span id="l7.341" class="difflineminus">-</span>
<a href="#l7.342"></a><span id="l7.342" class="difflineminus">-// Strips the |view-source:| for saveURL()</span>
<a href="#l7.343"></a><span id="l7.343" class="difflineminus">-function ViewSourceSavePage()</span>
<a href="#l7.344"></a><span id="l7.344" class="difflineminus">-{</span>
<a href="#l7.345"></a><span id="l7.345" class="difflineminus">-  saveURL(window.content.location.href.substring(12), null, &quot;SaveLinkTitle&quot;,</span>
<a href="#l7.346"></a><span id="l7.346" class="difflineminus">-          false, true);</span>
<a href="#l7.347"></a><span id="l7.347" class="difflineminus">-}</span>
<a href="#l7.348"></a><span id="l7.348" class="difflineminus">-</span>
<a href="#l7.349"></a><span id="l7.349" class="difflineminus">-function ViewSourceGoToLine()</span>
<a href="#l7.350"></a><span id="l7.350" class="difflineminus">-{</span>
<a href="#l7.351"></a><span id="l7.351" class="difflineminus">-  var promptService = Components.classes[&quot;@mozilla.org/embedcomp/prompt-service;1&quot;]</span>
<a href="#l7.352"></a><span id="l7.352" class="difflineminus">-        .getService(Components.interfaces.nsIPromptService);</span>
<a href="#l7.353"></a><span id="l7.353" class="difflineminus">-  var viewSourceBundle = getViewSourceBundle();</span>
<a href="#l7.354"></a><span id="l7.354" class="difflineminus">-</span>
<a href="#l7.355"></a><span id="l7.355" class="difflineminus">-  var input = {value:gLastLineFound};</span>
<a href="#l7.356"></a><span id="l7.356" class="difflineminus">-  for (;;) {</span>
<a href="#l7.357"></a><span id="l7.357" class="difflineminus">-    var ok = promptService.prompt(</span>
<a href="#l7.358"></a><span id="l7.358" class="difflineminus">-        window,</span>
<a href="#l7.359"></a><span id="l7.359" class="difflineminus">-        viewSourceBundle.getString(&quot;goToLineTitle&quot;),</span>
<a href="#l7.360"></a><span id="l7.360" class="difflineminus">-        viewSourceBundle.getString(&quot;goToLineText&quot;),</span>
<a href="#l7.361"></a><span id="l7.361" class="difflineminus">-        input,</span>
<a href="#l7.362"></a><span id="l7.362" class="difflineminus">-        null,</span>
<a href="#l7.363"></a><span id="l7.363" class="difflineminus">-        {value:0});</span>
<a href="#l7.364"></a><span id="l7.364" class="difflineminus">-</span>
<a href="#l7.365"></a><span id="l7.365" class="difflineminus">-    if (!ok)</span>
<a href="#l7.366"></a><span id="l7.366" class="difflineminus">-      return;</span>
<a href="#l7.367"></a><span id="l7.367" class="difflineminus">-</span>
<a href="#l7.368"></a><span id="l7.368" class="difflineminus">-    var line = parseInt(input.value, 10);</span>
<a href="#l7.369"></a><span id="l7.369" class="difflineminus">-</span>
<a href="#l7.370"></a><span id="l7.370" class="difflineminus">-    if (!(line &gt; 0)) {</span>
<a href="#l7.371"></a><span id="l7.371" class="difflineminus">-      promptService.alert(window,</span>
<a href="#l7.372"></a><span id="l7.372" class="difflineminus">-          viewSourceBundle.getString(&quot;invalidInputTitle&quot;),</span>
<a href="#l7.373"></a><span id="l7.373" class="difflineminus">-          viewSourceBundle.getString(&quot;invalidInputText&quot;));</span>
<a href="#l7.374"></a><span id="l7.374" class="difflineminus">-</span>
<a href="#l7.375"></a><span id="l7.375" class="difflineminus">-      continue;</span>
<a href="#l7.376"></a><span id="l7.376" class="difflineminus">-    }</span>
<a href="#l7.377"></a><span id="l7.377" class="difflineminus">-</span>
<a href="#l7.378"></a><span id="l7.378" class="difflineminus">-    var found = goToLine(line);</span>
<a href="#l7.379"></a><span id="l7.379" class="difflineminus">-</span>
<a href="#l7.380"></a><span id="l7.380" class="difflineminus">-    if (found) {</span>
<a href="#l7.381"></a><span id="l7.381" class="difflineminus">-      break;</span>
<a href="#l7.382"></a><span id="l7.382" class="difflineminus">-    }</span>
<a href="#l7.383"></a><span id="l7.383" class="difflineminus">-</span>
<a href="#l7.384"></a><span id="l7.384" class="difflineminus">-    promptService.alert(window,</span>
<a href="#l7.385"></a><span id="l7.385" class="difflineminus">-        viewSourceBundle.getString(&quot;outOfRangeTitle&quot;),</span>
<a href="#l7.386"></a><span id="l7.386" class="difflineminus">-        viewSourceBundle.getString(&quot;outOfRangeText&quot;));</span>
<a href="#l7.387"></a><span id="l7.387" class="difflineminus">-  }</span>
<a href="#l7.388"></a><span id="l7.388" class="difflineminus">-}</span>
<a href="#l7.389"></a><span id="l7.389" class="difflineminus">-</span>
<a href="#l7.390"></a><span id="l7.390" class="difflineminus">-function goToLine(line)</span>
<a href="#l7.391"></a><span id="l7.391" class="difflineminus">-{</span>
<a href="#l7.392"></a><span id="l7.392" class="difflineminus">-  var viewsource = window.content.document.body;</span>
<a href="#l7.393"></a><span id="l7.393" class="difflineminus">-</span>
<a href="#l7.394"></a><span id="l7.394" class="difflineminus">-  //</span>
<a href="#l7.395"></a><span id="l7.395" class="difflineminus">-  // The source document is made up of a number of pre elements with</span>
<a href="#l7.396"></a><span id="l7.396" class="difflineminus">-  // id attributes in the format &lt;pre id=&quot;line123&quot;&gt;, meaning that</span>
<a href="#l7.397"></a><span id="l7.397" class="difflineminus">-  // the first line in the pre element is number 123.</span>
<a href="#l7.398"></a><span id="l7.398" class="difflineminus">-  // Do binary search to find the pre element containing the line.</span>
<a href="#l7.399"></a><span id="l7.399" class="difflineminus">-  //</span>
<a href="#l7.400"></a><span id="l7.400" class="difflineminus">-  var pre;</span>
<a href="#l7.401"></a><span id="l7.401" class="difflineminus">-  for (var lbound = 0, ubound = viewsource.childNodes.length; ; ) {</span>
<a href="#l7.402"></a><span id="l7.402" class="difflineminus">-    var middle = (lbound + ubound) &gt;&gt; 1;</span>
<a href="#l7.403"></a><span id="l7.403" class="difflineminus">-    pre = viewsource.childNodes[middle];</span>
<a href="#l7.404"></a><span id="l7.404" class="difflineminus">-</span>
<a href="#l7.405"></a><span id="l7.405" class="difflineminus">-    var firstLine = parseInt(pre.id.substring(4));</span>
<a href="#l7.406"></a><span id="l7.406" class="difflineminus">-</span>
<a href="#l7.407"></a><span id="l7.407" class="difflineminus">-    if (lbound == ubound - 1) {</span>
<a href="#l7.408"></a><span id="l7.408" class="difflineminus">-      break;</span>
<a href="#l7.409"></a><span id="l7.409" class="difflineminus">-    }</span>
<a href="#l7.410"></a><span id="l7.410" class="difflineminus">-</span>
<a href="#l7.411"></a><span id="l7.411" class="difflineminus">-    if (line &gt;= firstLine) {</span>
<a href="#l7.412"></a><span id="l7.412" class="difflineminus">-      lbound = middle;</span>
<a href="#l7.413"></a><span id="l7.413" class="difflineminus">-    } else {</span>
<a href="#l7.414"></a><span id="l7.414" class="difflineminus">-      ubound = middle;</span>
<a href="#l7.415"></a><span id="l7.415" class="difflineminus">-    }</span>
<a href="#l7.416"></a><span id="l7.416" class="difflineminus">-  }</span>
<a href="#l7.417"></a><span id="l7.417" class="difflineminus">-</span>
<a href="#l7.418"></a><span id="l7.418" class="difflineminus">-  var result = {};</span>
<a href="#l7.419"></a><span id="l7.419" class="difflineminus">-  var found = findLocation(pre, line, null, -1, false, result);</span>
<a href="#l7.420"></a><span id="l7.420" class="difflineminus">-</span>
<a href="#l7.421"></a><span id="l7.421" class="difflineminus">-  if (!found) {</span>
<a href="#l7.422"></a><span id="l7.422" class="difflineminus">-    return false;</span>
<a href="#l7.423"></a><span id="l7.423" class="difflineminus">-  }</span>
<a href="#l7.424"></a><span id="l7.424" class="difflineminus">-</span>
<a href="#l7.425"></a><span id="l7.425" class="difflineminus">-  var selection = window.content.getSelection();</span>
<a href="#l7.426"></a><span id="l7.426" class="difflineminus">-  selection.removeAllRanges();</span>
<a href="#l7.427"></a><span id="l7.427" class="difflineminus">-</span>
<a href="#l7.428"></a><span id="l7.428" class="difflineminus">-  // In our case, the range's startOffset is after &quot;\n&quot; on the previous line.</span>
<a href="#l7.429"></a><span id="l7.429" class="difflineminus">-  // Tune the selection at the beginning of the next line and do some tweaking</span>
<a href="#l7.430"></a><span id="l7.430" class="difflineminus">-  // to position the focusNode and the caret at the beginning of the line.</span>
<a href="#l7.431"></a><span id="l7.431" class="difflineminus">-</span>
<a href="#l7.432"></a><span id="l7.432" class="difflineminus">-  selection.QueryInterface(nsISelectionPrivate)</span>
<a href="#l7.433"></a><span id="l7.433" class="difflineminus">-           .interlinePosition = true;</span>
<a href="#l7.434"></a><span id="l7.434" class="difflineminus">-</span>
<a href="#l7.435"></a><span id="l7.435" class="difflineminus">-  selection.addRange(result.range);</span>
<a href="#l7.436"></a><span id="l7.436" class="difflineminus">-</span>
<a href="#l7.437"></a><span id="l7.437" class="difflineminus">-  if (!selection.isCollapsed) {</span>
<a href="#l7.438"></a><span id="l7.438" class="difflineminus">-    selection.collapseToEnd();</span>
<a href="#l7.439"></a><span id="l7.439" class="difflineminus">-</span>
<a href="#l7.440"></a><span id="l7.440" class="difflineminus">-    var offset = result.range.startOffset;</span>
<a href="#l7.441"></a><span id="l7.441" class="difflineminus">-    var node = result.range.startContainer;</span>
<a href="#l7.442"></a><span id="l7.442" class="difflineminus">-    if (offset &lt; node.data.length) {</span>
<a href="#l7.443"></a><span id="l7.443" class="difflineminus">-      // The same text node spans across the &quot;\n&quot;, just focus where we were.</span>
<a href="#l7.444"></a><span id="l7.444" class="difflineminus">-      selection.extend(node, offset);</span>
<a href="#l7.445"></a><span id="l7.445" class="difflineminus">-    }</span>
<a href="#l7.446"></a><span id="l7.446" class="difflineminus">-    else {</span>
<a href="#l7.447"></a><span id="l7.447" class="difflineminus">-      // There is another tag just after the &quot;\n&quot;, hook there. We need</span>
<a href="#l7.448"></a><span id="l7.448" class="difflineminus">-      // to focus a safe point because there are edgy cases such as</span>
<a href="#l7.449"></a><span id="l7.449" class="difflineminus">-      // &lt;span&gt;...\n&lt;/span&gt;&lt;span&gt;...&lt;/span&gt; vs.</span>
<a href="#l7.450"></a><span id="l7.450" class="difflineminus">-      // &lt;span&gt;...\n&lt;span&gt;...&lt;/span&gt;&lt;/span&gt;&lt;span&gt;...&lt;/span&gt;</span>
<a href="#l7.451"></a><span id="l7.451" class="difflineminus">-      node = node.nextSibling ? node.nextSibling : node.parentNode.nextSibling;</span>
<a href="#l7.452"></a><span id="l7.452" class="difflineminus">-      selection.extend(node, 0);</span>
<a href="#l7.453"></a><span id="l7.453" class="difflineminus">-    }</span>
<a href="#l7.454"></a><span id="l7.454" class="difflineminus">-  }</span>
<a href="#l7.455"></a><span id="l7.455" class="difflineminus">-</span>
<a href="#l7.456"></a><span id="l7.456" class="difflineminus">-  var selCon = getSelectionController();</span>
<a href="#l7.457"></a><span id="l7.457" class="difflineminus">-  selCon.setDisplaySelection(nsISelectionController.SELECTION_ON);</span>
<a href="#l7.458"></a><span id="l7.458" class="difflineminus">-  selCon.setCaretVisibilityDuringSelection(true);</span>
<a href="#l7.459"></a><span id="l7.459" class="difflineminus">-</span>
<a href="#l7.460"></a><span id="l7.460" class="difflineminus">-  // Scroll the beginning of the line into view.</span>
<a href="#l7.461"></a><span id="l7.461" class="difflineminus">-  selCon.scrollSelectionIntoView(</span>
<a href="#l7.462"></a><span id="l7.462" class="difflineminus">-    nsISelectionController.SELECTION_NORMAL,</span>
<a href="#l7.463"></a><span id="l7.463" class="difflineminus">-    nsISelectionController.SELECTION_FOCUS_REGION,</span>
<a href="#l7.464"></a><span id="l7.464" class="difflineminus">-    true);</span>
<a href="#l7.465"></a><span id="l7.465" class="difflineminus">-</span>
<a href="#l7.466"></a><span id="l7.466" class="difflineminus">-  gLastLineFound = line;</span>
<a href="#l7.467"></a><span id="l7.467" class="difflineminus">-</span>
<a href="#l7.468"></a><span id="l7.468" class="difflineminus">-  document.getElementById(&quot;statusbar-line-col&quot;).label = getViewSourceBundle()</span>
<a href="#l7.469"></a><span id="l7.469" class="difflineminus">-      .getFormattedString(&quot;statusBarLineCol&quot;, [line, 1]);</span>
<a href="#l7.470"></a><span id="l7.470" class="difflineminus">-</span>
<a href="#l7.471"></a><span id="l7.471" class="difflineminus">-  return true;</span>
<a href="#l7.472"></a><span id="l7.472" class="difflineminus">-}</span>
<a href="#l7.473"></a><span id="l7.473" class="difflineminus">-</span>
<a href="#l7.474"></a><span id="l7.474" class="difflineminus">-function updateStatusBar()</span>
<a href="#l7.475"></a><span id="l7.475" class="difflineminus">-{</span>
<a href="#l7.476"></a><span id="l7.476" class="difflineminus">-  // Reset the coalesce flag.</span>
<a href="#l7.477"></a><span id="l7.477" class="difflineminus">-  gSelectionListener.timeout = 0;</span>
<a href="#l7.478"></a><span id="l7.478" class="difflineminus">-</span>
<a href="#l7.479"></a><span id="l7.479" class="difflineminus">-  var statusBarField = document.getElementById(&quot;statusbar-line-col&quot;);</span>
<a href="#l7.480"></a><span id="l7.480" class="difflineminus">-</span>
<a href="#l7.481"></a><span id="l7.481" class="difflineminus">-  var selection = window.content.getSelection();</span>
<a href="#l7.482"></a><span id="l7.482" class="difflineminus">-  if (!selection.focusNode) {</span>
<a href="#l7.483"></a><span id="l7.483" class="difflineminus">-    statusBarField.label = '';</span>
<a href="#l7.484"></a><span id="l7.484" class="difflineminus">-    return;</span>
<a href="#l7.485"></a><span id="l7.485" class="difflineminus">-  }</span>
<a href="#l7.486"></a><span id="l7.486" class="difflineminus">-  if (selection.focusNode.nodeType != Node.TEXT_NODE) {</span>
<a href="#l7.487"></a><span id="l7.487" class="difflineminus">-    return;</span>
<a href="#l7.488"></a><span id="l7.488" class="difflineminus">-  }</span>
<a href="#l7.489"></a><span id="l7.489" class="difflineminus">-</span>
<a href="#l7.490"></a><span id="l7.490" class="difflineminus">-  var selCon = getSelectionController();</span>
<a href="#l7.491"></a><span id="l7.491" class="difflineminus">-  selCon.setDisplaySelection(nsISelectionController.SELECTION_ON);</span>
<a href="#l7.492"></a><span id="l7.492" class="difflineminus">-  selCon.setCaretVisibilityDuringSelection(true);</span>
<a href="#l7.493"></a><span id="l7.493" class="difflineminus">-</span>
<a href="#l7.494"></a><span id="l7.494" class="difflineminus">-  var interlinePosition = selection</span>
<a href="#l7.495"></a><span id="l7.495" class="difflineminus">-      .QueryInterface(nsISelectionPrivate).interlinePosition;</span>
<a href="#l7.496"></a><span id="l7.496" class="difflineminus">-</span>
<a href="#l7.497"></a><span id="l7.497" class="difflineminus">-  var result = {};</span>
<a href="#l7.498"></a><span id="l7.498" class="difflineminus">-  findLocation(null, -1, </span>
<a href="#l7.499"></a><span id="l7.499" class="difflineminus">-      selection.focusNode, selection.focusOffset, interlinePosition, result);</span>
<a href="#l7.500"></a><span id="l7.500" class="difflineminus">-</span>
<a href="#l7.501"></a><span id="l7.501" class="difflineminus">-  statusBarField.label = getViewSourceBundle()</span>
<a href="#l7.502"></a><span id="l7.502" class="difflineminus">-      .getFormattedString(&quot;statusBarLineCol&quot;, [result.line, result.col]);</span>
<a href="#l7.503"></a><span id="l7.503" class="difflineminus">-}</span>
<a href="#l7.504"></a><span id="l7.504" class="difflineminus">-</span>
<a href="#l7.505"></a><span id="l7.505" class="difflineminus">-//</span>
<a href="#l7.506"></a><span id="l7.506" class="difflineminus">-// Loops through the text lines in the pre element. The arguments are either</span>
<a href="#l7.507"></a><span id="l7.507" class="difflineminus">-// (pre, line) or (node, offset, interlinePosition). result is an out</span>
<a href="#l7.508"></a><span id="l7.508" class="difflineminus">-// argument. If (pre, line) are specified (and node == null), result.range is</span>
<a href="#l7.509"></a><span id="l7.509" class="difflineminus">-// a range spanning the specified line. If the (node, offset,</span>
<a href="#l7.510"></a><span id="l7.510" class="difflineminus">-// interlinePosition) are specified, result.line and result.col are the line</span>
<a href="#l7.511"></a><span id="l7.511" class="difflineminus">-// and column number of the specified offset in the specified node relative to</span>
<a href="#l7.512"></a><span id="l7.512" class="difflineminus">-// the whole file.</span>
<a href="#l7.513"></a><span id="l7.513" class="difflineminus">-//</span>
<a href="#l7.514"></a><span id="l7.514" class="difflineminus">-function findLocation(pre, line, node, offset, interlinePosition, result)</span>
<a href="#l7.515"></a><span id="l7.515" class="difflineminus">-{</span>
<a href="#l7.516"></a><span id="l7.516" class="difflineminus">-  if (node &amp;&amp; !pre) {</span>
<a href="#l7.517"></a><span id="l7.517" class="difflineminus">-    //</span>
<a href="#l7.518"></a><span id="l7.518" class="difflineminus">-    // Look upwards to find the current pre element.</span>
<a href="#l7.519"></a><span id="l7.519" class="difflineminus">-    //</span>
<a href="#l7.520"></a><span id="l7.520" class="difflineminus">-    for (pre = node;</span>
<a href="#l7.521"></a><span id="l7.521" class="difflineminus">-         pre.nodeName != &quot;PRE&quot;;</span>
<a href="#l7.522"></a><span id="l7.522" class="difflineminus">-         pre = pre.parentNode);</span>
<a href="#l7.523"></a><span id="l7.523" class="difflineminus">-  }</span>
<a href="#l7.524"></a><span id="l7.524" class="difflineminus">-</span>
<a href="#l7.525"></a><span id="l7.525" class="difflineminus">-  //</span>
<a href="#l7.526"></a><span id="l7.526" class="difflineminus">-  // The source document is made up of a number of pre elements with</span>
<a href="#l7.527"></a><span id="l7.527" class="difflineminus">-  // id attributes in the format &lt;pre id=&quot;line123&quot;&gt;, meaning that</span>
<a href="#l7.528"></a><span id="l7.528" class="difflineminus">-  // the first line in the pre element is number 123.</span>
<a href="#l7.529"></a><span id="l7.529" class="difflineminus">-  //</span>
<a href="#l7.530"></a><span id="l7.530" class="difflineminus">-  var curLine = parseInt(pre.id.substring(4));</span>
<a href="#l7.531"></a><span id="l7.531" class="difflineminus">-</span>
<a href="#l7.532"></a><span id="l7.532" class="difflineminus">-  //</span>
<a href="#l7.533"></a><span id="l7.533" class="difflineminus">-  // Walk through each of the text nodes and count newlines.</span>
<a href="#l7.534"></a><span id="l7.534" class="difflineminus">-  //</span>
<a href="#l7.535"></a><span id="l7.535" class="difflineminus">-  var treewalker = window.content.document</span>
<a href="#l7.536"></a><span id="l7.536" class="difflineminus">-      .createTreeWalker(pre, NodeFilter.SHOW_TEXT, null, false);</span>
<a href="#l7.537"></a><span id="l7.537" class="difflineminus">-</span>
<a href="#l7.538"></a><span id="l7.538" class="difflineminus">-  //</span>
<a href="#l7.539"></a><span id="l7.539" class="difflineminus">-  // The column number of the first character in the current text node.</span>
<a href="#l7.540"></a><span id="l7.540" class="difflineminus">-  //</span>
<a href="#l7.541"></a><span id="l7.541" class="difflineminus">-  var firstCol = 1;</span>
<a href="#l7.542"></a><span id="l7.542" class="difflineminus">-</span>
<a href="#l7.543"></a><span id="l7.543" class="difflineminus">-  var found = false;</span>
<a href="#l7.544"></a><span id="l7.544" class="difflineminus">-  for (var textNode = treewalker.firstChild();</span>
<a href="#l7.545"></a><span id="l7.545" class="difflineminus">-       textNode &amp;&amp; !found;</span>
<a href="#l7.546"></a><span id="l7.546" class="difflineminus">-       textNode = treewalker.nextNode()) {</span>
<a href="#l7.547"></a><span id="l7.547" class="difflineminus">-</span>
<a href="#l7.548"></a><span id="l7.548" class="difflineminus">-    //</span>
<a href="#l7.549"></a><span id="l7.549" class="difflineminus">-    // \r is not a valid character in the DOM, so we only check for \n.</span>
<a href="#l7.550"></a><span id="l7.550" class="difflineminus">-    //</span>
<a href="#l7.551"></a><span id="l7.551" class="difflineminus">-    var lineArray = textNode.data.split(/\n/);</span>
<a href="#l7.552"></a><span id="l7.552" class="difflineminus">-    var lastLineInNode = curLine + lineArray.length - 1;</span>
<a href="#l7.553"></a><span id="l7.553" class="difflineminus">-</span>
<a href="#l7.554"></a><span id="l7.554" class="difflineminus">-    //</span>
<a href="#l7.555"></a><span id="l7.555" class="difflineminus">-    // Check if we can skip the text node without further inspection.</span>
<a href="#l7.556"></a><span id="l7.556" class="difflineminus">-    //</span>
<a href="#l7.557"></a><span id="l7.557" class="difflineminus">-    if (node ? (textNode != node) : (lastLineInNode &lt; line)) {</span>
<a href="#l7.558"></a><span id="l7.558" class="difflineminus">-      if (lineArray.length &gt; 1) {</span>
<a href="#l7.559"></a><span id="l7.559" class="difflineminus">-        firstCol = 1;</span>
<a href="#l7.560"></a><span id="l7.560" class="difflineminus">-      }</span>
<a href="#l7.561"></a><span id="l7.561" class="difflineminus">-      firstCol += lineArray[lineArray.length - 1].length;</span>
<a href="#l7.562"></a><span id="l7.562" class="difflineminus">-      curLine = lastLineInNode;</span>
<a href="#l7.563"></a><span id="l7.563" class="difflineminus">-      continue;</span>
<a href="#l7.564"></a><span id="l7.564" class="difflineminus">-    }</span>
<a href="#l7.565"></a><span id="l7.565" class="difflineminus">-</span>
<a href="#l7.566"></a><span id="l7.566" class="difflineminus">-    //</span>
<a href="#l7.567"></a><span id="l7.567" class="difflineminus">-    // curPos is the offset within the current text node of the first</span>
<a href="#l7.568"></a><span id="l7.568" class="difflineminus">-    // character in the current line.</span>
<a href="#l7.569"></a><span id="l7.569" class="difflineminus">-    //</span>
<a href="#l7.570"></a><span id="l7.570" class="difflineminus">-    for (var i = 0, curPos = 0;</span>
<a href="#l7.571"></a><span id="l7.571" class="difflineminus">-         i &lt; lineArray.length;</span>
<a href="#l7.572"></a><span id="l7.572" class="difflineminus">-         curPos += lineArray[i++].length + 1) {</span>
<a href="#l7.573"></a><span id="l7.573" class="difflineminus">-</span>
<a href="#l7.574"></a><span id="l7.574" class="difflineminus">-      if (i &gt; 0) {</span>
<a href="#l7.575"></a><span id="l7.575" class="difflineminus">-        curLine++;</span>
<a href="#l7.576"></a><span id="l7.576" class="difflineminus">-      }</span>
<a href="#l7.577"></a><span id="l7.577" class="difflineminus">-</span>
<a href="#l7.578"></a><span id="l7.578" class="difflineminus">-      if (node) {</span>
<a href="#l7.579"></a><span id="l7.579" class="difflineminus">-        if (offset &gt;= curPos &amp;&amp; offset &lt;= curPos + lineArray[i].length) {</span>
<a href="#l7.580"></a><span id="l7.580" class="difflineminus">-          //</span>
<a href="#l7.581"></a><span id="l7.581" class="difflineminus">-          // If we are right after the \n of a line and interlinePosition is</span>
<a href="#l7.582"></a><span id="l7.582" class="difflineminus">-          // false, the caret looks as if it were at the end of the previous</span>
<a href="#l7.583"></a><span id="l7.583" class="difflineminus">-          // line, so we display that line and column instead.</span>
<a href="#l7.584"></a><span id="l7.584" class="difflineminus">-          //</span>
<a href="#l7.585"></a><span id="l7.585" class="difflineminus">-          if (i &gt; 0 &amp;&amp; offset == curPos &amp;&amp; !interlinePosition) {</span>
<a href="#l7.586"></a><span id="l7.586" class="difflineminus">-            result.line = curLine - 1;</span>
<a href="#l7.587"></a><span id="l7.587" class="difflineminus">-            var prevPos = curPos - lineArray[i - 1].length;</span>
<a href="#l7.588"></a><span id="l7.588" class="difflineminus">-            result.col = (i == 1 ? firstCol : 1) + offset - prevPos;</span>
<a href="#l7.589"></a><span id="l7.589" class="difflineminus">-</span>
<a href="#l7.590"></a><span id="l7.590" class="difflineminus">-          } else {</span>
<a href="#l7.591"></a><span id="l7.591" class="difflineminus">-            result.line = curLine;</span>
<a href="#l7.592"></a><span id="l7.592" class="difflineminus">-            result.col = (i == 0 ? firstCol : 1) + offset - curPos;</span>
<a href="#l7.593"></a><span id="l7.593" class="difflineminus">-          }</span>
<a href="#l7.594"></a><span id="l7.594" class="difflineminus">-          found = true;</span>
<a href="#l7.595"></a><span id="l7.595" class="difflineminus">-</span>
<a href="#l7.596"></a><span id="l7.596" class="difflineminus">-          break;</span>
<a href="#l7.597"></a><span id="l7.597" class="difflineminus">-        }</span>
<a href="#l7.598"></a><span id="l7.598" class="difflineminus">-</span>
<a href="#l7.599"></a><span id="l7.599" class="difflineminus">-      } else {</span>
<a href="#l7.600"></a><span id="l7.600" class="difflineminus">-        if (curLine == line &amp;&amp; !(&quot;range&quot; in result)) {</span>
<a href="#l7.601"></a><span id="l7.601" class="difflineminus">-          result.range = document.createRange();</span>
<a href="#l7.602"></a><span id="l7.602" class="difflineminus">-          result.range.setStart(textNode, curPos);</span>
<a href="#l7.603"></a><span id="l7.603" class="difflineminus">-</span>
<a href="#l7.604"></a><span id="l7.604" class="difflineminus">-          //</span>
<a href="#l7.605"></a><span id="l7.605" class="difflineminus">-          // This will always be overridden later, except when we look for</span>
<a href="#l7.606"></a><span id="l7.606" class="difflineminus">-          // the very last line in the file (this is the only line that does</span>
<a href="#l7.607"></a><span id="l7.607" class="difflineminus">-          // not end with \n).</span>
<a href="#l7.608"></a><span id="l7.608" class="difflineminus">-          //</span>
<a href="#l7.609"></a><span id="l7.609" class="difflineminus">-          result.range.setEndAfter(pre.lastChild);</span>
<a href="#l7.610"></a><span id="l7.610" class="difflineminus">-</span>
<a href="#l7.611"></a><span id="l7.611" class="difflineminus">-        } else if (curLine == line + 1) {</span>
<a href="#l7.612"></a><span id="l7.612" class="difflineminus">-          result.range.setEnd(textNode, curPos - 1);</span>
<a href="#l7.613"></a><span id="l7.613" class="difflineminus">-          found = true;</span>
<a href="#l7.614"></a><span id="l7.614" class="difflineminus">-          break;</span>
<a href="#l7.615"></a><span id="l7.615" class="difflineminus">-        }</span>
<a href="#l7.616"></a><span id="l7.616" class="difflineminus">-      }</span>
<a href="#l7.617"></a><span id="l7.617" class="difflineminus">-    }</span>
<a href="#l7.618"></a><span id="l7.618" class="difflineminus">-  }</span>
<a href="#l7.619"></a><span id="l7.619" class="difflineminus">-</span>
<a href="#l7.620"></a><span id="l7.620" class="difflineminus">-  return found || (&quot;range&quot; in result);</span>
<a href="#l7.621"></a><span id="l7.621" class="difflineminus">-}</span>
<a href="#l7.622"></a><span id="l7.622" class="difflineminus">-</span>
<a href="#l7.623"></a><span id="l7.623" class="difflineminus">-//function to toggle long-line wrapping and set the view_source.wrap_long_lines </span>
<a href="#l7.624"></a><span id="l7.624" class="difflineminus">-//pref to persist the last state</span>
<a href="#l7.625"></a><span id="l7.625" class="difflineminus">-function wrapLongLines()</span>
<a href="#l7.626"></a><span id="l7.626" class="difflineminus">-{</span>
<a href="#l7.627"></a><span id="l7.627" class="difflineminus">-  var myWrap = window.content.document.body;</span>
<a href="#l7.628"></a><span id="l7.628" class="difflineminus">-</span>
<a href="#l7.629"></a><span id="l7.629" class="difflineminus">-  if (myWrap.className == '')</span>
<a href="#l7.630"></a><span id="l7.630" class="difflineminus">-    myWrap.className = 'wrap';</span>
<a href="#l7.631"></a><span id="l7.631" class="difflineminus">-  else myWrap.className = '';</span>
<a href="#l7.632"></a><span id="l7.632" class="difflineminus">-</span>
<a href="#l7.633"></a><span id="l7.633" class="difflineminus">-  //since multiple viewsource windows are possible, another window could have </span>
<a href="#l7.634"></a><span id="l7.634" class="difflineminus">-  //affected the pref, so instead of determining the new pref value via the current</span>
<a href="#l7.635"></a><span id="l7.635" class="difflineminus">-  //pref value, we use myWrap.className  </span>
<a href="#l7.636"></a><span id="l7.636" class="difflineminus">-  if (gPrefs){</span>
<a href="#l7.637"></a><span id="l7.637" class="difflineminus">-    try {</span>
<a href="#l7.638"></a><span id="l7.638" class="difflineminus">-      if (myWrap.className == '') {</span>
<a href="#l7.639"></a><span id="l7.639" class="difflineminus">-        gPrefs.setBoolPref(&quot;view_source.wrap_long_lines&quot;, false);</span>
<a href="#l7.640"></a><span id="l7.640" class="difflineminus">-      }</span>
<a href="#l7.641"></a><span id="l7.641" class="difflineminus">-      else {</span>
<a href="#l7.642"></a><span id="l7.642" class="difflineminus">-        gPrefs.setBoolPref(&quot;view_source.wrap_long_lines&quot;, true);</span>
<a href="#l7.643"></a><span id="l7.643" class="difflineminus">-      }</span>
<a href="#l7.644"></a><span id="l7.644" class="difflineminus">-    } catch (ex) {</span>
<a href="#l7.645"></a><span id="l7.645" class="difflineminus">-    }</span>
<a href="#l7.646"></a><span id="l7.646" class="difflineminus">-  }</span>
<a href="#l7.647"></a><span id="l7.647" class="difflineminus">-}</span>
<a href="#l7.648"></a><span id="l7.648" class="difflineminus">-</span>
<a href="#l7.649"></a><span id="l7.649" class="difflineminus">-//function to toggle syntax highlighting and set the view_source.syntax_highlight</span>
<a href="#l7.650"></a><span id="l7.650" class="difflineminus">-//pref to persist the last state</span>
<a href="#l7.651"></a><span id="l7.651" class="difflineminus">-function highlightSyntax()</span>
<a href="#l7.652"></a><span id="l7.652" class="difflineminus">-{</span>
<a href="#l7.653"></a><span id="l7.653" class="difflineminus">-  var highlightSyntaxMenu = document.getElementById(&quot;menu_highlightSyntax&quot;);</span>
<a href="#l7.654"></a><span id="l7.654" class="difflineminus">-  var highlightSyntax = (highlightSyntaxMenu.getAttribute(&quot;checked&quot;) == &quot;true&quot;);</span>
<a href="#l7.655"></a><span id="l7.655" class="difflineminus">-  gPrefs.setBoolPref(&quot;view_source.syntax_highlight&quot;, highlightSyntax);</span>
<a href="#l7.656"></a><span id="l7.656" class="difflineminus">-</span>
<a href="#l7.657"></a><span id="l7.657" class="difflineminus">-  var PageLoader = getBrowser().webNavigation.QueryInterface(pageLoaderIface);</span>
<a href="#l7.658"></a><span id="l7.658" class="difflineminus">-  PageLoader.loadPage(PageLoader.currentDescriptor, pageLoaderIface.DISPLAY_NORMAL);</span>
<a href="#l7.659"></a><span id="l7.659" class="difflineminus">-}</span>
<a href="#l7.660"></a><span id="l7.660" class="difflineminus">-</span>
<a href="#l7.661"></a><span id="l7.661" class="difflineminus">-// Fix for bug 136322: this function overrides the function in</span>
<a href="#l7.662"></a><span id="l7.662" class="difflineminus">-// browser.js to call PageLoader.loadPage() instead of BrowserReloadWithFlags()</span>
<a href="#l7.663"></a><span id="l7.663" class="difflineminus">-function BrowserSetForcedCharacterSet(aCharset)</span>
<a href="#l7.664"></a><span id="l7.664" class="difflineminus">-{</span>
<a href="#l7.665"></a><span id="l7.665" class="difflineminus">-  var docCharset = getBrowser().docShell.QueryInterface(</span>
<a href="#l7.666"></a><span id="l7.666" class="difflineminus">-                            Components.interfaces.nsIDocCharset);</span>
<a href="#l7.667"></a><span id="l7.667" class="difflineminus">-  docCharset.charset = aCharset;</span>
<a href="#l7.668"></a><span id="l7.668" class="difflineminus">-  var PageLoader = getBrowser().webNavigation.QueryInterface(pageLoaderIface);</span>
<a href="#l7.669"></a><span id="l7.669" class="difflineminus">-  PageLoader.loadPage(PageLoader.currentDescriptor, pageLoaderIface.DISPLAY_NORMAL);</span>
<a href="#l7.670"></a><span id="l7.670" class="difflineminus">-}</span>
<a href="#l7.671"></a><span id="l7.671" class="difflineminus">-</span>
<a href="#l7.672"></a><span id="l7.672" class="difflineminus">-function updateSavePageItems()</span>
<a href="#l7.673"></a><span id="l7.673" class="difflineminus">-{</span>
<a href="#l7.674"></a><span id="l7.674" class="difflineminus">-  var autoDownload = gPrefs.getBoolPref(&quot;browser.download.useDownloadDir&quot;);</span>
<a href="#l7.675"></a><span id="l7.675" class="difflineminus">-  goSetMenuValue(&quot;savepage&quot;, autoDownload ? &quot;valueSave&quot; : &quot;valueSaveAs&quot;);</span>
<a href="#l7.676"></a><span id="l7.676" class="difflineminus">-}</span>
<a href="#l7.677"></a><span id="l7.677" class="difflineminus">-</span>
<a href="#l7.678"></a><span id="l7.678" class="difflineminus">-function UpdateBackForwardCommands(aWebNavigation) {</span>
<a href="#l7.679"></a><span id="l7.679" class="difflineminus">-  var backBroadcaster = document.getElementById(&quot;Browser:Back&quot;);</span>
<a href="#l7.680"></a><span id="l7.680" class="difflineminus">-  var forwardBroadcaster = document.getElementById(&quot;Browser:Forward&quot;);</span>
<a href="#l7.681"></a><span id="l7.681" class="difflineminus">-</span>
<a href="#l7.682"></a><span id="l7.682" class="difflineminus">-  var backDisabled = backBroadcaster.hasAttribute(&quot;disabled&quot;);</span>
<a href="#l7.683"></a><span id="l7.683" class="difflineminus">-  var forwardDisabled = forwardBroadcaster.hasAttribute(&quot;disabled&quot;);</span>
<a href="#l7.684"></a><span id="l7.684" class="difflineminus">-</span>
<a href="#l7.685"></a><span id="l7.685" class="difflineminus">-  if (backDisabled == aWebNavigation.canGoBack) {</span>
<a href="#l7.686"></a><span id="l7.686" class="difflineminus">-    if (backDisabled)</span>
<a href="#l7.687"></a><span id="l7.687" class="difflineminus">-      backBroadcaster.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l7.688"></a><span id="l7.688" class="difflineminus">-    else</span>
<a href="#l7.689"></a><span id="l7.689" class="difflineminus">-      backBroadcaster.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l7.690"></a><span id="l7.690" class="difflineminus">-  }</span>
<a href="#l7.691"></a><span id="l7.691" class="difflineminus">-</span>
<a href="#l7.692"></a><span id="l7.692" class="difflineminus">-  if (forwardDisabled == aWebNavigation.canGoForward) {</span>
<a href="#l7.693"></a><span id="l7.693" class="difflineminus">-    if (forwardDisabled)</span>
<a href="#l7.694"></a><span id="l7.694" class="difflineminus">-      forwardBroadcaster.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l7.695"></a><span id="l7.695" class="difflineminus">-    else</span>
<a href="#l7.696"></a><span id="l7.696" class="difflineminus">-      forwardBroadcaster.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l7.697"></a><span id="l7.697" class="difflineminus">-  }</span>
<a href="#l7.698"></a><span id="l7.698" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/suite/common/jar.mn</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/suite/common/jar.mn</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1,15 +1,17 @@</span>
<a href="#l8.4"></a><span id="l8.4"> comm.jar:</span>
<a href="#l8.5"></a><span id="l8.5"> % content communicator %content/communicator/ xpcnativewrappers=yes contentaccessible=yes</span>
<a href="#l8.6"></a><span id="l8.6"> % override chrome://global/content/license.html chrome://communicator/content/license.html</span>
<a href="#l8.7"></a><span id="l8.7"> % override chrome://mozapps/content/profile/profileSelection.xul chrome://communicator/content/profile/profileSelection.xul</span>
<a href="#l8.8"></a><span id="l8.8"> % overlay chrome://communicator/content/contentAreaContextOverlay.xul chrome://communicator/content/permissions/imageContextOverlay.xul</span>
<a href="#l8.9"></a><span id="l8.9"> % overlay chrome://navigator/content/navigatorOverlay.xul chrome://communicator/content/permissions/permissionsNavigatorOverlay.xul</span>
<a href="#l8.10"></a><span id="l8.10"> % overlay chrome://global/content/console.xul chrome://communicator/content/consoleOverlay.xul</span>
<a href="#l8.11"></a><span id="l8.11" class="difflineplus">+% overlay chrome://global/content/viewSource.xul chrome://communicator/content/viewSourceOverlay.xul</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+% overlay chrome://global/content/viewPartialSource.xul chrome://communicator/content/viewSourceOverlay.xul</span>
<a href="#l8.13"></a><span id="l8.13"> % overlay chrome://help/content/help.xul chrome://communicator/content/helpOverlay.xul</span>
<a href="#l8.14"></a><span id="l8.14"> % overlay chrome://editor/content/EdAdvancedEdit.xul chrome://communicator/content/helpEditorOverlay.xul</span>
<a href="#l8.15"></a><span id="l8.15"> % overlay chrome://editor/content/EdImageProps.xul chrome://communicator/content/helpEditorOverlay.xul</span>
<a href="#l8.16"></a><span id="l8.16"> % overlay chrome://editor/content/EditorPublish.xul chrome://communicator/content/helpEditorOverlay.xul</span>
<a href="#l8.17"></a><span id="l8.17"> % overlay chrome://editor/content/EditorPublishProgress.xul chrome://communicator/content/helpEditorOverlay.xul</span>
<a href="#l8.18"></a><span id="l8.18"> % overlay chrome://editor/content/EditorPublishSettings.xul chrome://communicator/content/helpEditorOverlay.xul</span>
<a href="#l8.19"></a><span id="l8.19"> % overlay chrome://editor/content/EdLinkProps.xul chrome://communicator/content/helpEditorOverlay.xul</span>
<a href="#l8.20"></a><span id="l8.20"> % overlay chrome://editor/content/EdTableProps.xul chrome://communicator/content/helpEditorOverlay.xul</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineat">@@ -73,16 +75,18 @@ comm.jar:</span>
<a href="#l8.22"></a><span id="l8.22">    content/communicator/openLocation.xul</span>
<a href="#l8.23"></a><span id="l8.23">    content/communicator/passwordManager.xul</span>
<a href="#l8.24"></a><span id="l8.24">    content/communicator/printPreviewBindings.xml</span>
<a href="#l8.25"></a><span id="l8.25">    content/communicator/sanitize.xul</span>
<a href="#l8.26"></a><span id="l8.26">    content/communicator/tasksOverlay.js</span>
<a href="#l8.27"></a><span id="l8.27">    content/communicator/tasksOverlay.xul</span>
<a href="#l8.28"></a><span id="l8.28">    content/communicator/utilityOverlay.js</span>
<a href="#l8.29"></a><span id="l8.29">    content/communicator/utilityOverlay.xul</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineplus">+   content/communicator/viewSourceOverlay.js</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineplus">+   content/communicator/viewSourceOverlay.xul</span>
<a href="#l8.32"></a><span id="l8.32">    content/communicator/viewZoomOverlay.xul</span>
<a href="#l8.33"></a><span id="l8.33">    content/communicator/viewZoomOverlay.js</span>
<a href="#l8.34"></a><span id="l8.34"> #ifdef XP_MACOSX</span>
<a href="#l8.35"></a><span id="l8.35">    content/communicator/platformBrowserBindings.xul                 (mac/platformBrowserBindings.xul)</span>
<a href="#l8.36"></a><span id="l8.36">    content/communicator/platformEditorBindings.xul                  (mac/platformEditorBindings.xul)</span>
<a href="#l8.37"></a><span id="l8.37">    content/communicator/platformCommunicatorOverlay.xul             (mac/platformCommunicatorOverlay.xul)</span>
<a href="#l8.38"></a><span id="l8.38"> #else</span>
<a href="#l8.39"></a><span id="l8.39"> #ifdef XP_WIN32</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/suite/common/nsContextMenu.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/suite/common/nsContextMenu.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -764,18 +764,18 @@ nsContextMenu.prototype = {</span>
<a href="#l9.4"></a><span id="l9.4">     if (aContext == &quot;selection&quot;)</span>
<a href="#l9.5"></a><span id="l9.5">       reference = focusedWindow.getSelection();</span>
<a href="#l9.6"></a><span id="l9.6">     else if (aContext == &quot;mathml&quot;)</span>
<a href="#l9.7"></a><span id="l9.7">       reference = this.target;</span>
<a href="#l9.8"></a><span id="l9.8">     else</span>
<a href="#l9.9"></a><span id="l9.9">       throw &quot;not reached&quot;;</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11">     var docUrl = null; // unused (and play nice for fragments generated via XSLT too)</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    window.openDialog(&quot;chrome://navigator/content/viewPartialSource.xul&quot;,</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-                      &quot;_blank&quot;, &quot;scrollbars,resizable,chrome,dialog=no&quot;,</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+    window.openDialog(&quot;chrome://global/content/viewPartialSource.xul&quot;,</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+                      &quot;_blank&quot;, &quot;all,dialog=no&quot;,</span>
<a href="#l9.16"></a><span id="l9.16">                       docUrl, docCharset, reference, aContext);</span>
<a href="#l9.17"></a><span id="l9.17">   },</span>
<a href="#l9.18"></a><span id="l9.18"> </span>
<a href="#l9.19"></a><span id="l9.19">   // Open new &quot;view source&quot; window with the frame's URL.</span>
<a href="#l9.20"></a><span id="l9.20">   viewFrameSource: function() {</span>
<a href="#l9.21"></a><span id="l9.21">     BrowserViewSourceOfDocument(this.target.ownerDocument);</span>
<a href="#l9.22"></a><span id="l9.22">   },</span>
<a href="#l9.23"></a><span id="l9.23"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">new file mode 100644</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineminus">--- /dev/null</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineplus">+++ b/suite/common/viewSourceOverlay.js</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineat">@@ -0,0 +1,53 @@</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l10.6"></a><span id="l10.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l10.7"></a><span id="l10.7" class="difflineplus">+ *</span>
<a href="#l10.8"></a><span id="l10.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+ *</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineplus">+ * License.</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineplus">+ *</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineplus">+ * The Original Code is SeaMonkey internet suite code.</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineplus">+ *</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineplus">+ * Mozilla Foundation.</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineplus">+ *</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineplus">+ *   Robert Kaiser &lt;kairo@kairo.at&gt;</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineplus">+ *</span>
<a href="#l10.28"></a><span id="l10.28" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l10.33"></a><span id="l10.33" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l10.35"></a><span id="l10.35" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l10.36"></a><span id="l10.36" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l10.37"></a><span id="l10.37" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l10.38"></a><span id="l10.38" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l10.39"></a><span id="l10.39" class="difflineplus">+ *</span>
<a href="#l10.40"></a><span id="l10.40" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineplus">+</span>
<a href="#l10.42"></a><span id="l10.42" class="difflineplus">+// onload make sure we adapt what's needed for partial source</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineplus">+window.addEventListener(&quot;load&quot;, onLoadViewSourceOverlay, false);</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineplus">+</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineplus">+function onLoadViewSourceOverlay() {</span>
<a href="#l10.46"></a><span id="l10.46" class="difflineplus">+  if (/viewPartialSource\.xul$/.test(document.location)) {</span>
<a href="#l10.47"></a><span id="l10.47" class="difflineplus">+    // disable menu items that don't work since the selection is munged and</span>
<a href="#l10.48"></a><span id="l10.48" class="difflineplus">+    // the editor doesn't work for MathML</span>
<a href="#l10.49"></a><span id="l10.49" class="difflineplus">+    document.getElementById('cmd_savePage').setAttribute('disabled', 'true');</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineplus">+    document.getElementById('cmd_editPage').setAttribute('disabled', 'true');</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineplus">+  }</span>
<a href="#l10.52"></a><span id="l10.52" class="difflineplus">+}</span>
<a href="#l10.53"></a><span id="l10.53" class="difflineplus">+</span>
<a href="#l10.54"></a><span id="l10.54" class="difflineplus">+// editPage() comes in from editorApplicationOverlay.js</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineplus">+function ViewSourceEditPage() {</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineplus">+  editPage(window.content.location.href);</span>
<a href="#l10.57"></a><span id="l10.57" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">new file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- /dev/null</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ b/suite/common/viewSourceOverlay.xul</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -0,0 +1,106 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineplus">+</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineplus">+&lt;!-- ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineplus">+ Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineplus">+</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineplus">+ The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineplus">+ 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+ the License. You may obtain a copy of the License at</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+ http://www.mozilla.org/MPL/</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+ Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+ WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+ for the specific language governing rights and limitations under the</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+ License.</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineplus">+</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineplus">+ The Original Code is SeaMonkey internet suite code.</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineplus">+</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineplus">+ The Initial Developer of the Original Code is</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineplus">+ Mozilla Foundation.</span>
<a href="#l11.24"></a><span id="l11.24" class="difflineplus">+ Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineplus">+ the Initial Developer. All Rights Reserved.</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineplus">+</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineplus">+ Contributor(s):</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+   Robert Kaiser &lt;kairo@kairo.at&gt;</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineplus">+</span>
<a href="#l11.30"></a><span id="l11.30" class="difflineplus">+ Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineplus">+ either of the GNU General Public License Version 2 or later (the &quot;GPL&quot;),</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+ or the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineplus">+ in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineplus">+ of those above. If you wish to allow use of your version of this file only</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineplus">+ under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineplus">+ use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineplus">+ decision by deleting the provisions above and replace them with the notice</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineplus">+ and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineplus">+ the provisions above, a recipient may use your version of this file under</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineplus">+ the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineplus">+</span>
<a href="#l11.42"></a><span id="l11.42" class="difflineplus">+ ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l11.43"></a><span id="l11.43" class="difflineplus">+</span>
<a href="#l11.44"></a><span id="l11.44" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://communicator/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l11.45"></a><span id="l11.45" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://communicator/skin/viewSourceOverlay.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineplus">+</span>
<a href="#l11.47"></a><span id="l11.47" class="difflineplus">+&lt;?xul-overlay href=&quot;chrome://global/content/globalOverlay.xul&quot;?&gt;</span>
<a href="#l11.48"></a><span id="l11.48" class="difflineplus">+&lt;?xul-overlay href=&quot;chrome://communicator/content/utilityOverlay.xul&quot;?&gt;</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineplus">+&lt;?xul-overlay href=&quot;chrome://communicator/content/tasksOverlay.xul&quot;?&gt;</span>
<a href="#l11.50"></a><span id="l11.50" class="difflineplus">+</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineplus">+&lt;!DOCTYPE overlay [</span>
<a href="#l11.52"></a><span id="l11.52" class="difflineplus">+</span>
<a href="#l11.53"></a><span id="l11.53" class="difflineplus">+&lt;!ENTITY % navDTD SYSTEM &quot;chrome://navigator/locale/navigator.dtd&quot;&gt;</span>
<a href="#l11.54"></a><span id="l11.54" class="difflineplus">+%navDTD;</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineplus">+</span>
<a href="#l11.56"></a><span id="l11.56" class="difflineplus">+]&gt;</span>
<a href="#l11.57"></a><span id="l11.57" class="difflineplus">+</span>
<a href="#l11.58"></a><span id="l11.58" class="difflineplus">+&lt;overlay id=&quot;viewSourceOverlay&quot;</span>
<a href="#l11.59"></a><span id="l11.59" class="difflineplus">+         xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineplus">+</span>
<a href="#l11.61"></a><span id="l11.61" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineplus">+          src=&quot;chrome://communicator/content/viewSourceOverlay.js&quot;/&gt;</span>
<a href="#l11.63"></a><span id="l11.63" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l11.64"></a><span id="l11.64" class="difflineplus">+          src=&quot;chrome://editor/content/editorApplicationOverlay.js&quot;/&gt;</span>
<a href="#l11.65"></a><span id="l11.65" class="difflineplus">+</span>
<a href="#l11.66"></a><span id="l11.66" class="difflineplus">+  &lt;window id=&quot;viewSource&quot;&gt;</span>
<a href="#l11.67"></a><span id="l11.67" class="difflineplus">+    &lt;commandset id=&quot;tasksCommands&quot;/&gt;</span>
<a href="#l11.68"></a><span id="l11.68" class="difflineplus">+    &lt;command id=&quot;cmd_newNavigator&quot;/&gt;</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineplus">+    &lt;command id=&quot;cmd_newEditor&quot;/&gt;</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineplus">+    &lt;command id=&quot;cmd_editPage&quot; oncommand=&quot;ViewSourceEditPage();&quot;/&gt;</span>
<a href="#l11.71"></a><span id="l11.71" class="difflineplus">+  &lt;/window&gt;</span>
<a href="#l11.72"></a><span id="l11.72" class="difflineplus">+</span>
<a href="#l11.73"></a><span id="l11.73" class="difflineplus">+  &lt;keyset id=&quot;viewSourceKeys&quot;&gt;</span>
<a href="#l11.74"></a><span id="l11.74" class="difflineplus">+    &lt;keyset id=&quot;tasksKeys&quot;/&gt;</span>
<a href="#l11.75"></a><span id="l11.75" class="difflineplus">+    &lt;key id=&quot;key_newBlankPage&quot;/&gt;</span>
<a href="#l11.76"></a><span id="l11.76" class="difflineplus">+    &lt;key id=&quot;key_newNavigator&quot;/&gt;</span>
<a href="#l11.77"></a><span id="l11.77" class="difflineplus">+    &lt;key id=&quot;key_editPage&quot; key=&quot;&amp;editPageCmd.commandkey;&quot;</span>
<a href="#l11.78"></a><span id="l11.78" class="difflineplus">+         command=&quot;Browser:EditPage&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l11.79"></a><span id="l11.79" class="difflineplus">+  &lt;/keyset&gt;</span>
<a href="#l11.80"></a><span id="l11.80" class="difflineplus">+</span>
<a href="#l11.81"></a><span id="l11.81" class="difflineplus">+  &lt;menubar id=&quot;viewSource-main-menubar&quot;</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineplus">+           class=&quot;chromeclass-menubar&quot;</span>
<a href="#l11.83"></a><span id="l11.83" class="difflineplus">+           grippytooltiptext=&quot;&amp;menuBar.tooltip;&quot;&gt;</span>
<a href="#l11.84"></a><span id="l11.84" class="difflineplus">+    &lt;menu id=&quot;menu_file&quot;&gt;</span>
<a href="#l11.85"></a><span id="l11.85" class="difflineplus">+      &lt;menupopup id=&quot;filemenu-popup&quot;&gt;</span>
<a href="#l11.86"></a><span id="l11.86" class="difflineplus">+        &lt;menu id=&quot;menu_New&quot; position=&quot;1&quot;&gt;</span>
<a href="#l11.87"></a><span id="l11.87" class="difflineplus">+          &lt;menupopup id=&quot;menu_NewPopup&quot;&gt;</span>
<a href="#l11.88"></a><span id="l11.88" class="difflineplus">+            &lt;menuitem id=&quot;menu_newNavigator&quot;/&gt;</span>
<a href="#l11.89"></a><span id="l11.89" class="difflineplus">+            &lt;menuitem id=&quot;menu_newEditor&quot;/&gt;</span>
<a href="#l11.90"></a><span id="l11.90" class="difflineplus">+          &lt;/menupopup&gt;</span>
<a href="#l11.91"></a><span id="l11.91" class="difflineplus">+        &lt;/menu&gt;</span>
<a href="#l11.92"></a><span id="l11.92" class="difflineplus">+        &lt;menuitem id=&quot;menu_editPage&quot; insertafter=&quot;menu_savePage&quot;</span>
<a href="#l11.93"></a><span id="l11.93" class="difflineplus">+                  key=&quot;key_editPage&quot; command=&quot;cmd_editPage&quot;</span>
<a href="#l11.94"></a><span id="l11.94" class="difflineplus">+                  label=&quot;&amp;editPageCmd.label;&quot;</span>
<a href="#l11.95"></a><span id="l11.95" class="difflineplus">+                  accesskey=&quot;&amp;editPageCmd.accesskey;&quot;/&gt;</span>
<a href="#l11.96"></a><span id="l11.96" class="difflineplus">+        &lt;menuseparator insertbefore=&quot;menu_pageSetup&quot;/&gt;</span>
<a href="#l11.97"></a><span id="l11.97" class="difflineplus">+      &lt;/menupopup&gt;</span>
<a href="#l11.98"></a><span id="l11.98" class="difflineplus">+    &lt;/menu&gt;</span>
<a href="#l11.99"></a><span id="l11.99" class="difflineplus">+</span>
<a href="#l11.100"></a><span id="l11.100" class="difflineplus">+    &lt;!-- tasks menu filled from tasksOverlay --&gt;</span>
<a href="#l11.101"></a><span id="l11.101" class="difflineplus">+    &lt;menu id=&quot;tasksMenu&quot;/&gt;</span>
<a href="#l11.102"></a><span id="l11.102" class="difflineplus">+</span>
<a href="#l11.103"></a><span id="l11.103" class="difflineplus">+    &lt;!-- window menu filled from tasksOverlay --&gt;</span>
<a href="#l11.104"></a><span id="l11.104" class="difflineplus">+    &lt;menu id=&quot;windowMenu&quot;/&gt;</span>
<a href="#l11.105"></a><span id="l11.105" class="difflineplus">+</span>
<a href="#l11.106"></a><span id="l11.106" class="difflineplus">+    &lt;!-- help menu filled from globalOverlay --&gt;</span>
<a href="#l11.107"></a><span id="l11.107" class="difflineplus">+    &lt;menu id=&quot;menu_Help&quot;/&gt;</span>
<a href="#l11.108"></a><span id="l11.108" class="difflineplus">+  &lt;/menubar&gt;</span>
<a href="#l11.109"></a><span id="l11.109" class="difflineplus">+</span>
<a href="#l11.110"></a><span id="l11.110" class="difflineplus">+&lt;/overlay&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">deleted file mode 100644</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineminus">--- a/suite/locales/en-US/chrome/browser/viewSource.dtd</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineplus">+++ /dev/null</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineat">@@ -1,27 +0,0 @@</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineminus">-&lt;!-- extracted from content/viewSource.xul --&gt;</span>
<a href="#l12.6"></a><span id="l12.6" class="difflineminus">-</span>
<a href="#l12.7"></a><span id="l12.7" class="difflineminus">-&lt;!-- LOCALIZATION NOTE (mainWindow.title) : DONT_TRANSLATE --&gt; </span>
<a href="#l12.8"></a><span id="l12.8" class="difflineminus">-&lt;!ENTITY mainWindow.title &quot;&amp;brandShortName;&quot;&gt; </span>
<a href="#l12.9"></a><span id="l12.9" class="difflineminus">-&lt;!-- LOCALIZATION NOTE (mainWindow.titlemodifier) : DONT_TRANSLATE --&gt; </span>
<a href="#l12.10"></a><span id="l12.10" class="difflineminus">-&lt;!ENTITY mainWindow.titlemodifier &quot;&amp;brandShortName;&quot;&gt; </span>
<a href="#l12.11"></a><span id="l12.11" class="difflineminus">-&lt;!-- LOCALIZATION NOTE (mainWindow.titlemodifierseparator) : DONT_TRANSLATE --&gt;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-&lt;!ENTITY mainWindow.titlemodifierseparator &quot; - &quot;&gt;</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-&lt;!ENTITY mainWindow.preface &quot;Source of: &quot;&gt;</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-&lt;!ENTITY viewPartialSourceWindow.title &quot;DOM Source&quot;&gt;</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-&lt;!ENTITY menu_wrapLongLines.title &quot;Wrap Long Lines&quot;&gt; </span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-&lt;!ENTITY menu_wrapLongLines.accesskey &quot;W&quot;&gt;</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineminus">-</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineminus">-&lt;!ENTITY menu_highlightSyntax.label &quot;Syntax Highlighting&quot;&gt;</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineminus">-&lt;!ENTITY menu_highlightSyntax.accesskey &quot;H&quot;&gt;</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineminus">-</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineminus">-&lt;!ENTITY findNextCmd.label &quot;Find Next&quot;&gt;</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineminus">-&lt;!ENTITY findNextCmd.accesskey &quot;n&quot;&gt;</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineminus">-</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineminus">-&lt;!ENTITY goToLineCmd.label &quot;Go to Line&quot;&gt;</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineminus">-&lt;!ENTITY goToLineCmd.accesskey &quot;G&quot;&gt;</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineminus">-&lt;!ENTITY goToLineCmd.commandkey &quot;l&quot;&gt;</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineminus">-</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineminus">-&lt;!ENTITY printSetupCmd.label &quot;Page Setup&quot;&gt;</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-&lt;!ENTITY printSetupCmd.accesskey &quot;u&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1">deleted file mode 100644</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineminus">--- a/suite/locales/en-US/chrome/browser/viewSource.properties</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineplus">+++ /dev/null</span>
<a href="#l13.4"></a><span id="l13.4" class="difflineat">@@ -1,7 +0,0 @@</span>
<a href="#l13.5"></a><span id="l13.5" class="difflineminus">-goToLineTitle     = Go to line</span>
<a href="#l13.6"></a><span id="l13.6" class="difflineminus">-goToLineText      = Enter line number</span>
<a href="#l13.7"></a><span id="l13.7" class="difflineminus">-invalidInputTitle = Invalid input</span>
<a href="#l13.8"></a><span id="l13.8" class="difflineminus">-invalidInputText  = The line number entered is invalid.</span>
<a href="#l13.9"></a><span id="l13.9" class="difflineminus">-outOfRangeTitle   = Line not found</span>
<a href="#l13.10"></a><span id="l13.10" class="difflineminus">-outOfRangeText    = The specified line was not found.</span>
<a href="#l13.11"></a><span id="l13.11" class="difflineminus">-statusBarLineCol  = Line %1$S, Col %2$S</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/suite/locales/jar.mn</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/suite/locales/jar.mn</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -329,18 +329,16 @@</span>
<a href="#l14.4"></a><span id="l14.4">   locale/@AB_CD@/navigator/metadata.dtd                                     (%chrome/browser/metadata.dtd)</span>
<a href="#l14.5"></a><span id="l14.5">   locale/@AB_CD@/navigator/metadata.properties                              (%chrome/browser/metadata.properties)</span>
<a href="#l14.6"></a><span id="l14.6">   locale/@AB_CD@/navigator/navigator.dtd                                    (%chrome/browser/navigator.dtd)</span>
<a href="#l14.7"></a><span id="l14.7">   locale/@AB_CD@/navigator/navigator.properties                             (%chrome/browser/navigator.properties)</span>
<a href="#l14.8"></a><span id="l14.8">   locale/@AB_CD@/navigator/pageInfo.dtd                                     (%chrome/browser/pageInfo.dtd)</span>
<a href="#l14.9"></a><span id="l14.9">   locale/@AB_CD@/navigator/pageInfo.properties                              (%chrome/browser/pageInfo.properties)</span>
<a href="#l14.10"></a><span id="l14.10">   locale/@AB_CD@/navigator/tabbrowser.dtd                                   (%chrome/browser/tabbrowser.dtd)</span>
<a href="#l14.11"></a><span id="l14.11">   locale/@AB_CD@/navigator/tabbrowser.properties                            (%chrome/browser/tabbrowser.properties)</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  locale/@AB_CD@/navigator/viewSource.dtd                                   (%chrome/browser/viewSource.dtd)</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-  locale/@AB_CD@/navigator/viewSource.properties                            (%chrome/browser/viewSource.properties)</span>
<a href="#l14.14"></a><span id="l14.14">   locale/@AB_CD@/navigator-platform/mac/navigator.properties                (%chrome/browser/mac/navigator.properties)</span>
<a href="#l14.15"></a><span id="l14.15">   locale/@AB_CD@/navigator-platform/mac/platformNavigationBindings.dtd      (%chrome/browser/mac/platformNavigationBindings.dtd)</span>
<a href="#l14.16"></a><span id="l14.16">   locale/@AB_CD@/navigator-platform/unix/navigator.properties               (%chrome/browser/unix/navigator.properties)</span>
<a href="#l14.17"></a><span id="l14.17">   locale/@AB_CD@/navigator-platform/unix/platformNavigationBindings.dtd     (%chrome/browser/unix/platformNavigationBindings.dtd)</span>
<a href="#l14.18"></a><span id="l14.18">   locale/@AB_CD@/navigator-platform/win/navigator.properties                (%chrome/browser/win/navigator.properties)</span>
<a href="#l14.19"></a><span id="l14.19">   locale/@AB_CD@/navigator-platform/win/platformNavigationBindings.dtd      (%chrome/browser/win/platformNavigationBindings.dtd)</span>
<a href="#l14.20"></a><span id="l14.20">   locale/@AB_CD@/navigator-region/region.properties                         (%chrome/browser/region.properties)</span>
<a href="#l14.21"></a><span id="l14.21">   locale/@AB_CD@/pippki/pref-certs.dtd                                      (%chrome/common/pref/pref-certs.dtd)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/suite/mailnews/mailCommands.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/suite/mailnews/mailCommands.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -467,17 +467,17 @@ function ViewPageSource(messages)</span>
<a href="#l15.4"></a><span id="l15.4"> </span>
<a href="#l15.5"></a><span id="l15.5">         var mailCharacterSet = &quot;charset=&quot; + msgWindow.mailCharacterSet;</span>
<a href="#l15.6"></a><span id="l15.6"> </span>
<a href="#l15.7"></a><span id="l15.7">         for (var i = 0; i &lt; numMessages; i++)</span>
<a href="#l15.8"></a><span id="l15.8">         {</span>
<a href="#l15.9"></a><span id="l15.9">             // Now, we need to get a URL from a URI</span>
<a href="#l15.10"></a><span id="l15.10">             var url = mailSession.ConvertMsgURIToMsgURL(messages[i], msgWindow);</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-            window.openDialog( &quot;chrome://navigator/content/viewSource.xul&quot;,</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+            window.openDialog( &quot;chrome://global/content/viewSource.xul&quot;,</span>
<a href="#l15.14"></a><span id="l15.14">                                &quot;_blank&quot;, &quot;all,dialog=no&quot;, url,</span>
<a href="#l15.15"></a><span id="l15.15">                                mailCharacterSet);</span>
<a href="#l15.16"></a><span id="l15.16">         }</span>
<a href="#l15.17"></a><span id="l15.17">         return true;</span>
<a href="#l15.18"></a><span id="l15.18">     } catch (e) {</span>
<a href="#l15.19"></a><span id="l15.19">         // Couldn't get mail session</span>
<a href="#l15.20"></a><span id="l15.20">         return false;</span>
<a href="#l15.21"></a><span id="l15.21">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/suite/mailnews/msgHdrViewOverlay.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/suite/mailnews/msgHdrViewOverlay.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -1155,17 +1155,17 @@ createNewAttachmentInfo.prototype.saveAt</span>
<a href="#l16.4"></a><span id="l16.4">                              false);</span>
<a href="#l16.5"></a><span id="l16.5"> }</span>
<a href="#l16.6"></a><span id="l16.6"> </span>
<a href="#l16.7"></a><span id="l16.7"> createNewAttachmentInfo.prototype.viewAttachment = function viewAttachment()</span>
<a href="#l16.8"></a><span id="l16.8"> {</span>
<a href="#l16.9"></a><span id="l16.9">   var url = this.url;</span>
<a href="#l16.10"></a><span id="l16.10">   if (!this.isExternalAttachment)</span>
<a href="#l16.11"></a><span id="l16.11">     url += &quot;&amp;filename=&quot; + encodeURIComponent(this.displayName);</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-  openDialog(&quot;chrome://navigator/content/viewSource.xul&quot;,</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+  openDialog(&quot;chrome://global/content/viewSource.xul&quot;,</span>
<a href="#l16.14"></a><span id="l16.14">              &quot;_blank&quot;, &quot;all,dialog=no&quot;, url);</span>
<a href="#l16.15"></a><span id="l16.15"> }</span>
<a href="#l16.16"></a><span id="l16.16"> </span>
<a href="#l16.17"></a><span id="l16.17"> createNewAttachmentInfo.prototype.openAttachment = function openAttachment()</span>
<a href="#l16.18"></a><span id="l16.18"> {</span>
<a href="#l16.19"></a><span id="l16.19">   if (this.contentType == &quot;text/x-moz-deleted&quot;)</span>
<a href="#l16.20"></a><span id="l16.20">     return;</span>
<a href="#l16.21"></a><span id="l16.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1">new file mode 100644</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineminus">--- /dev/null</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineplus">+++ b/suite/themes/classic/communicator/viewSourceOverlay.css</span>
<a href="#l17.4"></a><span id="l17.4" class="difflineat">@@ -0,0 +1,51 @@</span>
<a href="#l17.5"></a><span id="l17.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l17.6"></a><span id="l17.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l17.7"></a><span id="l17.7" class="difflineplus">+ *</span>
<a href="#l17.8"></a><span id="l17.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l17.9"></a><span id="l17.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l17.10"></a><span id="l17.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l17.11"></a><span id="l17.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+ *</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+ * License.</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineplus">+ *</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineplus">+ * The Original Code is SeaMonkey internet suite code.</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineplus">+ *</span>
<a href="#l17.20"></a><span id="l17.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineplus">+ * Mozilla Foundation.</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l17.23"></a><span id="l17.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l17.24"></a><span id="l17.24" class="difflineplus">+ *</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l17.26"></a><span id="l17.26" class="difflineplus">+ *   Robert Kaiser &lt;kairo@kairo.at&gt;</span>
<a href="#l17.27"></a><span id="l17.27" class="difflineplus">+ *</span>
<a href="#l17.28"></a><span id="l17.28" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l17.29"></a><span id="l17.29" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l17.30"></a><span id="l17.30" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l17.33"></a><span id="l17.33" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l17.34"></a><span id="l17.34" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l17.36"></a><span id="l17.36" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l17.37"></a><span id="l17.37" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l17.38"></a><span id="l17.38" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l17.39"></a><span id="l17.39" class="difflineplus">+ *</span>
<a href="#l17.40"></a><span id="l17.40" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l17.41"></a><span id="l17.41" class="difflineplus">+</span>
<a href="#l17.42"></a><span id="l17.42" class="difflineplus">+/* make findbar appear above content */</span>
<a href="#l17.43"></a><span id="l17.43" class="difflineplus">+#appcontent {</span>
<a href="#l17.44"></a><span id="l17.44" class="difflineplus">+  -moz-box-direction: reverse;</span>
<a href="#l17.45"></a><span id="l17.45" class="difflineplus">+}</span>
<a href="#l17.46"></a><span id="l17.46" class="difflineplus">+</span>
<a href="#l17.47"></a><span id="l17.47" class="difflineplus">+/* style findbar for being on top */</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineplus">+#FindToolbar {</span>
<a href="#l17.49"></a><span id="l17.49" class="difflineplus">+  border-top: none;</span>
<a href="#l17.50"></a><span id="l17.50" class="difflineplus">+  border-bottom: 2px solid;</span>
<a href="#l17.51"></a><span id="l17.51" class="difflineplus">+  -moz-border-bottom-colors: ThreeDShadow ThreeDHighlight;</span>
<a href="#l17.52"></a><span id="l17.52" class="difflineplus">+  padding-top: 1px;</span>
<a href="#l17.53"></a><span id="l17.53" class="difflineplus">+  padding-bottom: 0px;</span>
<a href="#l17.54"></a><span id="l17.54" class="difflineplus">+  min-width: 1px;</span>
<a href="#l17.55"></a><span id="l17.55" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/suite/themes/classic/jar.mn</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/suite/themes/classic/jar.mn</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -51,16 +51,17 @@ classic.jar:</span>
<a href="#l18.4"></a><span id="l18.4">   skin/classic/communicator/brand.css                                   (communicator/brand.css)</span>
<a href="#l18.5"></a><span id="l18.5">   skin/classic/communicator/certError.css                               (communicator/certError.css)</span>
<a href="#l18.6"></a><span id="l18.6">   skin/classic/communicator/dialogs.css                                 (communicator/dialogs.css)</span>
<a href="#l18.7"></a><span id="l18.7">   skin/classic/communicator/communicatorBindings.xml                    (communicator/communicatorBindings.xml)</span>
<a href="#l18.8"></a><span id="l18.8">   skin/classic/communicator/preferences.css                             (communicator/preferences.css)</span>
<a href="#l18.9"></a><span id="l18.9">   skin/classic/communicator/prefpanels.css                              (communicator/prefpanels.css)</span>
<a href="#l18.10"></a><span id="l18.10">   skin/classic/communicator/smileys.css                                 (communicator/smileys.css)</span>
<a href="#l18.11"></a><span id="l18.11">   skin/classic/communicator/tasksOverlay.css                            (communicator/tasksOverlay.css)</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineplus">+  skin/classic/communicator/viewSourceOverlay.css                       (communicator/viewSourceOverlay.css)</span>
<a href="#l18.13"></a><span id="l18.13">   skin/classic/communicator/bookmarks/bookmark-group.png                (communicator/bookmarks/bookmark-group.png)</span>
<a href="#l18.14"></a><span id="l18.14">   skin/classic/communicator/bookmarks/bookmark-item-dis.png             (communicator/bookmarks/bookmark-item-dis.png)</span>
<a href="#l18.15"></a><span id="l18.15">   skin/classic/communicator/bookmarks/bookmark-item-updated.png         (communicator/bookmarks/bookmark-item-updated.png)</span>
<a href="#l18.16"></a><span id="l18.16">   skin/classic/communicator/bookmarks/bookmark-item.png                 (communicator/bookmarks/bookmark-item.png)</span>
<a href="#l18.17"></a><span id="l18.17">   skin/classic/communicator/bookmarks/bookmarksWindow.css               (communicator/bookmarks/bookmarksWindow.css)</span>
<a href="#l18.18"></a><span id="l18.18">   skin/classic/communicator/bookmarks/home.png                          (communicator/bookmarks/home.png)</span>
<a href="#l18.19"></a><span id="l18.19">   skin/classic/communicator/bookmarks/location-act.gif                  (communicator/bookmarks/location-act.gif)</span>
<a href="#l18.20"></a><span id="l18.20">   skin/classic/communicator/bookmarks/location-dis.gif                  (communicator/bookmarks/location-dis.gif)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1">new file mode 100644</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineminus">--- /dev/null</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineplus">+++ b/suite/themes/modern/communicator/viewSourceOverlay.css</span>
<a href="#l19.4"></a><span id="l19.4" class="difflineat">@@ -0,0 +1,41 @@</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l19.6"></a><span id="l19.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l19.7"></a><span id="l19.7" class="difflineplus">+ *</span>
<a href="#l19.8"></a><span id="l19.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l19.9"></a><span id="l19.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l19.10"></a><span id="l19.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l19.11"></a><span id="l19.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+ *</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineplus">+ * License.</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+ *</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineplus">+ * The Original Code is SeaMonkey internet suite code.</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineplus">+ *</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineplus">+ * Mozilla Foundation.</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineplus">+ *</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l19.26"></a><span id="l19.26" class="difflineplus">+ *   Robert Kaiser &lt;kairo@kairo.at&gt;</span>
<a href="#l19.27"></a><span id="l19.27" class="difflineplus">+ *</span>
<a href="#l19.28"></a><span id="l19.28" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l19.29"></a><span id="l19.29" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l19.30"></a><span id="l19.30" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l19.37"></a><span id="l19.37" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l19.38"></a><span id="l19.38" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l19.39"></a><span id="l19.39" class="difflineplus">+ *</span>
<a href="#l19.40"></a><span id="l19.40" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l19.41"></a><span id="l19.41" class="difflineplus">+</span>
<a href="#l19.42"></a><span id="l19.42" class="difflineplus">+/* make findbar appear above content */</span>
<a href="#l19.43"></a><span id="l19.43" class="difflineplus">+#appcontent {</span>
<a href="#l19.44"></a><span id="l19.44" class="difflineplus">+  -moz-box-direction: reverse;</span>
<a href="#l19.45"></a><span id="l19.45" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/suite/themes/modern/jar.mn</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/suite/themes/modern/jar.mn</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -18,16 +18,17 @@ modern.jar:</span>
<a href="#l20.4"></a><span id="l20.4">   skin/modern/communicator/tasksOverlay.css                        (communicator/tasksOverlay.css)</span>
<a href="#l20.5"></a><span id="l20.5">   skin/modern/communicator/button.css                              (communicator/button.css)</span>
<a href="#l20.6"></a><span id="l20.6">   skin/modern/communicator/toolbar.css                             (communicator/toolbar.css)</span>
<a href="#l20.7"></a><span id="l20.7">   skin/modern/communicator/dialogs.css                             (communicator/dialogs.css)</span>
<a href="#l20.8"></a><span id="l20.8">   skin/modern/communicator/helpOverlay.css                         (communicator/helpOverlay.css)</span>
<a href="#l20.9"></a><span id="l20.9">   skin/modern/communicator/smileys.css                             (communicator/smileys.css)</span>
<a href="#l20.10"></a><span id="l20.10">   skin/modern/communicator/communicator.css                        (communicator/communicator.css)</span>
<a href="#l20.11"></a><span id="l20.11">   skin/modern/communicator/aboutSessionRestore.css                 (communicator/aboutSessionRestore.css)</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineplus">+  skin/modern/communicator/viewSourceOverlay.css                   (communicator/viewSourceOverlay.css)</span>
<a href="#l20.13"></a><span id="l20.13">   skin/modern/communicator/bookmarks/bookmark-folder-closed.gif    (communicator/bookmarks/bookmark-folder-closed.gif)</span>
<a href="#l20.14"></a><span id="l20.14">   skin/modern/communicator/bookmarks/bookmark-folder-dis.gif       (communicator/bookmarks/bookmark-folder-dis.gif)</span>
<a href="#l20.15"></a><span id="l20.15">   skin/modern/communicator/bookmarks/bookmark-folder-open.gif      (communicator/bookmarks/bookmark-folder-open.gif)</span>
<a href="#l20.16"></a><span id="l20.16">   skin/modern/communicator/bookmarks/bookmark-group.gif            (communicator/bookmarks/bookmark-group.gif)</span>
<a href="#l20.17"></a><span id="l20.17">   skin/modern/communicator/bookmarks/bookmark-item-dis.gif         (communicator/bookmarks/bookmark-item-dis.gif)</span>
<a href="#l20.18"></a><span id="l20.18">   skin/modern/communicator/bookmarks/bookmark-item-updated.gif     (communicator/bookmarks/bookmark-item-updated.gif)</span>
<a href="#l20.19"></a><span id="l20.19">   skin/modern/communicator/bookmarks/bookmark-item.gif             (communicator/bookmarks/bookmark-item.gif)</span>
<a href="#l20.20"></a><span id="l20.20">   skin/modern/communicator/bookmarks/bookmarks.css                 (communicator/bookmarks/bookmarks.css)</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

