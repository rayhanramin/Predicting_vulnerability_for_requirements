<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 3711:97610babc9e74367f2b1da7fe939ba0bff905009</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 97610babc9e74367f2b1da7fe939ba0bff905009" />
<meta property="og:url" content="/comm-central/rev/97610babc9e74367f2b1da7fe939ba0bff905009" />
<meta property="og:description" content="merge of add-protovis" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 97610babc9e74367f2b1da7fe939ba0bff905009 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/97610babc9e74367f2b1da7fe939ba0bff905009">shortlog</a> |
<a href="/comm-central/log/97610babc9e74367f2b1da7fe939ba0bff905009">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/97610babc9e74367f2b1da7fe939ba0bff905009">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/97610babc9e74367f2b1da7fe939ba0bff905009">files</a> |
changeset |
<a href="/comm-central/raw-rev/97610babc9e74367f2b1da7fe939ba0bff905009">raw</a>  | <a href="/comm-central/archive/97610babc9e74367f2b1da7fe939ba0bff905009.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
merge of add-protovis
<span class="logtags"><span class="inbranchtag" title="add-jquery">add-jquery</span> </span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#65;&#110;&#100;&#114;&#101;&#119;&#32;&#83;&#117;&#116;&#104;&#101;&#114;&#108;&#97;&#110;&#100;&#32;&#60;&#97;&#115;&#117;&#116;&#104;&#101;&#114;&#108;&#97;&#110;&#100;&#64;&#97;&#115;&#117;&#116;&#104;&#101;&#114;&#108;&#97;&#110;&#100;&#46;&#111;&#114;&#103;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 08 Sep 2009 20:53:59 -0700</td></tr>
<tr><td>branch</td><td>add-jquery</td></tr>
<tr>
 <td>changeset 3711</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/97610babc9e74367f2b1da7fe939ba0bff905009">97610babc9e74367f2b1da7fe939ba0bff905009</a></td>
</tr>



<tr>
<td>parent 3706</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/45fbab07d8b3e6cf7fb227e5783b1a5dcdc141d5">45fbab07d8b3e6cf7fb227e5783b1a5dcdc141d5</a> (current diff)
</td>
</tr>
<tr>
<td>parent 3710</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/668c342deb663372479da9e47656295941ae6815">668c342deb663372479da9e47656295941ae6815</a> (<a href="/comm-central/rev/668c342deb663372479da9e47656295941ae6815:97610babc9e7">diff</a>)
</td>
</tr>

<tr>
<td>child 3712</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/d9ad1f4f89510a5bc894cdffbe3d6fac711f316c">d9ad1f4f89510a5bc894cdffbe3d6fac711f316c</a>
</td>
</tr>
<tr>
<td>child 3726</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/a1a09863751a33941eb5230459fb006f1df33d5e">a1a09863751a33941eb5230459fb006f1df33d5e</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=97610babc9e74367f2b1da7fe939ba0bff905009">2927</a></td></tr>
<tr><td>push user</td><td>bugmail@asutherland.org</td></tr>
<tr><td>push date</td><td class="date age">Thu, 10 Sep 2009 01:15:56 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@0b161ed73eb6 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=0b161ed73eb66538ade852cb5a4b9b1b2c319a33">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=0b161ed73eb66538ade852cb5a4b9b1b2c319a33&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=0b161ed73eb66538ade852cb5a4b9b1b2c319a33&newProject=comm-central&newRevision=b5e0aff84bf4077a47919481912ad0bd11c6a8d8&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=0b161ed73eb66538ade852cb5a4b9b1b2c319a33&newProject=comm-central&newRevision=b5e0aff84bf4077a47919481912ad0bd11c6a8d8&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=0b161ed73eb66538ade852cb5a4b9b1b2c319a33&newProject=comm-central&newRevision=b5e0aff84bf4077a47919481912ad0bd11c6a8d8&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>






</table></div>

<div class="page_body description">merge of add-protovis</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/97610babc9e74367f2b1da7fe939ba0bff905009/.hgpatchinfo/add-jquery.dep">.hgpatchinfo/add-jquery.dep</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/97610babc9e74367f2b1da7fe939ba0bff905009/.hgpatchinfo/add-jquery.dep">file</a> |
<a href="/comm-central/annotate/97610babc9e74367f2b1da7fe939ba0bff905009/.hgpatchinfo/add-jquery.dep">annotate</a> |
<a href="/comm-central/diff/97610babc9e74367f2b1da7fe939ba0bff905009/.hgpatchinfo/add-jquery.dep">diff</a> |
<a href="/comm-central/comparison/97610babc9e74367f2b1da7fe939ba0bff905009/.hgpatchinfo/add-jquery.dep">comparison</a> |
<a href="/comm-central/log/97610babc9e74367f2b1da7fe939ba0bff905009/.hgpatchinfo/add-jquery.dep">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/.hgpatchinfo/add-jquery.dep</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/.hgpatchinfo/add-jquery.dep</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,1 +1,1 @@</span>
<a href="#l1.4"></a><span id="l1.4" class="difflineminus">-3786d789303cc727aabf6728454556705232a33e</span>
<a href="#l1.5"></a><span id="l1.5">\ No newline at end of file</span>
<a href="#l1.6"></a><span id="l1.6" class="difflineplus">+668c342deb663372479da9e47656295941ae6815</span>
<a href="#l1.7"></a><span id="l1.7">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/.hgpatchinfo/add-protovis.dep</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/.hgpatchinfo/add-protovis.dep</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,1 +1,1 @@</span>
<a href="#l2.4"></a><span id="l2.4" class="difflineminus">-23f393649289dd4774ddd1d231b01e1de8a75cfe</span>
<a href="#l2.5"></a><span id="l2.5">\ No newline at end of file</span>
<a href="#l2.6"></a><span id="l2.6" class="difflineplus">+9b7f6edb75fa33f6ebdb8bbddca9251126fc6a26</span>
<a href="#l2.7"></a><span id="l2.7">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/agenda-listbox.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/agenda-listbox.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -163,63 +163,41 @@ function onCheckboxChange(event) {</span>
<a href="#l3.4"></a><span id="l3.4"> </span>
<a href="#l3.5"></a><span id="l3.5"> /**</span>
<a href="#l3.6"></a><span id="l3.6">  * Handler function called when an agenda listbox item is selected</span>
<a href="#l3.7"></a><span id="l3.7">  *</span>
<a href="#l3.8"></a><span id="l3.8">  * @param aListItem     The agenda-base-richlist-item that was selected.</span>
<a href="#l3.9"></a><span id="l3.9">  */</span>
<a href="#l3.10"></a><span id="l3.10"> agendaListbox.onSelect =</span>
<a href="#l3.11"></a><span id="l3.11"> function onSelect(aListItem) {</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    var listbox = document.getElementById(&quot;agenda-listbox&quot;);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-    listbox.focus();</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-    listbox.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-    var item = aListItem || listbox.selectedItem;</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+    let listbox = document.getElementById(&quot;agenda-listbox&quot;);</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+    let item = aListItem || listbox.selectedItem;</span>
<a href="#l3.18"></a><span id="l3.18">     if (aListItem) {</span>
<a href="#l3.19"></a><span id="l3.19">         listbox.selectedItem = item;</span>
<a href="#l3.20"></a><span id="l3.20">     }</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineminus">-    if (item) {</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineminus">-        item.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineminus">-    }</span>
<a href="#l3.24"></a><span id="l3.24">     calendarController.onSelectionChanged({detail: agendaListbox.getSelectedItems()});</span>
<a href="#l3.25"></a><span id="l3.25"> }</span>
<a href="#l3.26"></a><span id="l3.26"> </span>
<a href="#l3.27"></a><span id="l3.27"> /**</span>
<a href="#l3.28"></a><span id="l3.28">  * Handler function called when the agenda listbox becomes focused</span>
<a href="#l3.29"></a><span id="l3.29">  */</span>
<a href="#l3.30"></a><span id="l3.30"> agendaListbox.onFocus =</span>
<a href="#l3.31"></a><span id="l3.31"> function onFocus() {</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineminus">-    var listbox = document.getElementById(&quot;agenda-listbox&quot;);</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineminus">-    listbox.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineminus">-    this.enableListItems();</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+    let listbox = document.getElementById(&quot;agenda-listbox&quot;);</span>
<a href="#l3.36"></a><span id="l3.36">     calendarController.onSelectionChanged({detail: agendaListbox.getSelectedItems()});</span>
<a href="#l3.37"></a><span id="l3.37"> }</span>
<a href="#l3.38"></a><span id="l3.38"> </span>
<a href="#l3.39"></a><span id="l3.39"> /**</span>
<a href="#l3.40"></a><span id="l3.40">  * Handler function called when the agenda listbox loses focus.</span>
<a href="#l3.41"></a><span id="l3.41">  */</span>
<a href="#l3.42"></a><span id="l3.42"> agendaListbox.onBlur =</span>
<a href="#l3.43"></a><span id="l3.43"> function onBlur() {</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineminus">-    var item  = document.getElementById(&quot;agenda-listbox&quot;).selectedItem;</span>
<a href="#l3.45"></a><span id="l3.45" class="difflineminus">-    if (item) {</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineminus">-        item.setAttribute(&quot;disabled&quot;,&quot;true&quot;);</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineminus">-    }</span>
<a href="#l3.48"></a><span id="l3.48">     calendarController.onSelectionChanged({detail: []});</span>
<a href="#l3.49"></a><span id="l3.49"> }</span>
<a href="#l3.50"></a><span id="l3.50"> </span>
<a href="#l3.51"></a><span id="l3.51" class="difflineminus">-/**</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineminus">- * Enables all child nodes of the agenda listbox</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineminus">- */</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineminus">-agendaListbox.enableListItems =</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineminus">-function enableListItems() {</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineminus">-    var childNodes = document.getElementById(&quot;agenda-listbox&quot;).childNodes;</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineminus">-    for (var i = 0;i &lt; childNodes.length; i++) {</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineminus">-        var listItem = childNodes[i];</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-        listItem.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineminus">-    }</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineminus">-}</span>
<a href="#l3.62"></a><span id="l3.62"> </span>
<a href="#l3.63"></a><span id="l3.63"> /**</span>
<a href="#l3.64"></a><span id="l3.64">  * Handler function called when a key was pressed on the agenda listbox</span>
<a href="#l3.65"></a><span id="l3.65">  */</span>
<a href="#l3.66"></a><span id="l3.66"> agendaListbox.onKeyPress =</span>
<a href="#l3.67"></a><span id="l3.67"> function onKeyPress(aEvent) {</span>
<a href="#l3.68"></a><span id="l3.68">     var listItem = aEvent.target;</span>
<a href="#l3.69"></a><span id="l3.69">     if (listItem.localName == &quot;richlistbox&quot;) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -879,19 +879,17 @@</span>
<a href="#l4.4"></a><span id="l4.4">            */</span>
<a href="#l4.5"></a><span id="l4.5">           onCalendarAdded: function tTO_onCalendarAdded(aCalendar) {</span>
<a href="#l4.6"></a><span id="l4.6">               if (!aCalendar.getProperty(&quot;disabled&quot;)) {</span>
<a href="#l4.7"></a><span id="l4.7">                   this.binding.onCalendarAdded(aCalendar);</span>
<a href="#l4.8"></a><span id="l4.8">               }</span>
<a href="#l4.9"></a><span id="l4.9">           },</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11">           onCalendarRemoved: function tTO_onCalendarRemoved(aCalendar) {</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-              if (!aCalendar.getProperty(&quot;disabled&quot;)) {</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-                  this.binding.onCalendarRemoved(aCalendar);</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-              }</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+              this.binding.onCalendarRemoved(aCalendar);</span>
<a href="#l4.16"></a><span id="l4.16">           },</span>
<a href="#l4.17"></a><span id="l4.17"> </span>
<a href="#l4.18"></a><span id="l4.18">           onDefaultCalendarChanged: function tTO_onDefaultCalendarChanged(aNewDefaultCalendar) {}</span>
<a href="#l4.19"></a><span id="l4.19">       })</span>
<a href="#l4.20"></a><span id="l4.20">       ]]&gt;&lt;/field&gt;</span>
<a href="#l4.21"></a><span id="l4.21"> </span>
<a href="#l4.22"></a><span id="l4.22">       &lt;method name=&quot;observe&quot;&gt;</span>
<a href="#l4.23"></a><span id="l4.23">         &lt;parameter name=&quot;aSubject&quot;/&gt;</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineat">@@ -977,26 +975,24 @@</span>
<a href="#l4.25"></a><span id="l4.25">                 this.refreshFromCalendar(aCalendar, aFilter, false);</span>
<a href="#l4.26"></a><span id="l4.26">             }</span>
<a href="#l4.27"></a><span id="l4.27">         ]]&gt;&lt;/body&gt;</span>
<a href="#l4.28"></a><span id="l4.28">       &lt;/method&gt;</span>
<a href="#l4.29"></a><span id="l4.29"> </span>
<a href="#l4.30"></a><span id="l4.30">       &lt;method name=&quot;onCalendarRemoved&quot;&gt;</span>
<a href="#l4.31"></a><span id="l4.31">         &lt;parameter name=&quot;aCalendar&quot;/&gt;</span>
<a href="#l4.32"></a><span id="l4.32">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineminus">-            if (!aCalendar.getProperty(&quot;disabled&quot;)) {</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineminus">-                this.mTreeView.treebox.beginUpdateBatch();</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineminus">-                let tasks = this.mTaskArray.concat([]);</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineminus">-                for each (let task in tasks) {</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineminus">-                    if (task.calendar.id == aCalendar.id) {</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineminus">-                        this.mTreeView.removeItem(task);</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineminus">-                    }</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+            this.mTreeView.treebox.beginUpdateBatch();</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+            let tasks = this.mTaskArray.concat([]);</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+            for each (let task in tasks) {</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+                if (task.calendar.id == aCalendar.id) {</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+                    this.mTreeView.removeItem(task);</span>
<a href="#l4.45"></a><span id="l4.45">                 }</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineminus">-                this.mTreeView.treebox.endUpdateBatch();</span>
<a href="#l4.47"></a><span id="l4.47">             }</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+            this.mTreeView.treebox.endUpdateBatch();</span>
<a href="#l4.49"></a><span id="l4.49">         ]]&gt;&lt;/body&gt;</span>
<a href="#l4.50"></a><span id="l4.50">       &lt;/method&gt;</span>
<a href="#l4.51"></a><span id="l4.51"> </span>
<a href="#l4.52"></a><span id="l4.52">       &lt;method name=&quot;popRefreshQueue&quot;&gt;</span>
<a href="#l4.53"></a><span id="l4.53">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l4.54"></a><span id="l4.54">           var pendingRefresh = this.mPendingRefresh;</span>
<a href="#l4.55"></a><span id="l4.55">           if (pendingRefresh) {</span>
<a href="#l4.56"></a><span id="l4.56">               if (calInstanceOf(pendingRefresh, Components.interfaces.calIOperation)) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/modules/calProviderUtils.jsm</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/modules/calProviderUtils.jsm</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -415,20 +415,20 @@ cal.toRFC3339 = function toRFC3339(aDate</span>
<a href="#l5.4"></a><span id="l5.4">         }</span>
<a href="#l5.5"></a><span id="l5.5">     }</span>
<a href="#l5.6"></a><span id="l5.6">     return str;</span>
<a href="#l5.7"></a><span id="l5.7"> };</span>
<a href="#l5.8"></a><span id="l5.8"> </span>
<a href="#l5.9"></a><span id="l5.9"> /**</span>
<a href="#l5.10"></a><span id="l5.10">  * Observer bag implementation taking care to replay open batch notifications.</span>
<a href="#l5.11"></a><span id="l5.11">  */</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-cal.observerBag = function calObserverBag(iid) {</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+cal.ObserverBag = function calObserverBag(iid) {</span>
<a href="#l5.14"></a><span id="l5.14">     this.init(iid);</span>
<a href="#l5.15"></a><span id="l5.15"> };</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineminus">-cal.observerBag.prototype = {</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+cal.ObserverBag.prototype = {</span>
<a href="#l5.18"></a><span id="l5.18">     __proto__: cal.calListenerBag.prototype,</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20">     mBatchCount: 0,</span>
<a href="#l5.21"></a><span id="l5.21">     notify: function calObserverBag_notify(func, args) {</span>
<a href="#l5.22"></a><span id="l5.22">         switch (func) {</span>
<a href="#l5.23"></a><span id="l5.23">             case &quot;onStartBatch&quot;:</span>
<a href="#l5.24"></a><span id="l5.24">                  ++this.mBatchCount;</span>
<a href="#l5.25"></a><span id="l5.25">                  break;</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineat">@@ -478,17 +478,17 @@ cal.ProviderBase.prototype = {</span>
<a href="#l5.27"></a><span id="l5.27"> </span>
<a href="#l5.28"></a><span id="l5.28">     mID: null,</span>
<a href="#l5.29"></a><span id="l5.29">     mUri: null,</span>
<a href="#l5.30"></a><span id="l5.30">     mObservers: null,</span>
<a href="#l5.31"></a><span id="l5.31">     mProperties: null,</span>
<a href="#l5.32"></a><span id="l5.32"> </span>
<a href="#l5.33"></a><span id="l5.33">     initProviderBase: function cPB_initProviderBase() {</span>
<a href="#l5.34"></a><span id="l5.34">         this.wrappedJSObject = this;</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineminus">-        this.mObservers = new cal.observerBag(Components.interfaces.calIObserver);</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+        this.mObservers = new cal.ObserverBag(Components.interfaces.calIObserver);</span>
<a href="#l5.37"></a><span id="l5.37">         this.mProperties = {};</span>
<a href="#l5.38"></a><span id="l5.38">         this.mProperties.currentStatus = Components.results.NS_OK;</span>
<a href="#l5.39"></a><span id="l5.39">     },</span>
<a href="#l5.40"></a><span id="l5.40"> </span>
<a href="#l5.41"></a><span id="l5.41">     get observers cPB_observers_get() {</span>
<a href="#l5.42"></a><span id="l5.42">         return this.mObservers;</span>
<a href="#l5.43"></a><span id="l5.43">     },</span>
<a href="#l5.44"></a><span id="l5.44"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/src/calCachedCalendar.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/src/calCachedCalendar.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -101,17 +101,17 @@ calCachedCalendarObserverHelper.prototyp</span>
<a href="#l6.4"></a><span id="l6.4">             this.home.mObservers.notify(&quot;onPropertyDeleting&quot;, [this.home, aName]);</span>
<a href="#l6.5"></a><span id="l6.5">         }</span>
<a href="#l6.6"></a><span id="l6.6">     }</span>
<a href="#l6.7"></a><span id="l6.7"> };</span>
<a href="#l6.8"></a><span id="l6.8"> </span>
<a href="#l6.9"></a><span id="l6.9"> function calCachedCalendar(uncachedCalendar) {</span>
<a href="#l6.10"></a><span id="l6.10">     this.wrappedJSObject = this;</span>
<a href="#l6.11"></a><span id="l6.11">     this.mSyncQueue = [];</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-    this.mObservers = new cal.observerBag(Components.interfaces.calIObserver);</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+    this.mObservers = new cal.ObserverBag(Components.interfaces.calIObserver);</span>
<a href="#l6.14"></a><span id="l6.14">     uncachedCalendar.superCalendar = this;</span>
<a href="#l6.15"></a><span id="l6.15">     uncachedCalendar.addObserver(new calCachedCalendarObserverHelper(this, false));</span>
<a href="#l6.16"></a><span id="l6.16">     this.mUncachedCalendar = uncachedCalendar;</span>
<a href="#l6.17"></a><span id="l6.17">     this.setupCachedCalendar();</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19">     if (this.supportsChangeLog) {</span>
<a href="#l6.20"></a><span id="l6.20">         var updateTimer = this.getProperty(&quot;cache.updateTimer&quot;);</span>
<a href="#l6.21"></a><span id="l6.21">         if (updateTimer === null) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -107,20 +107,20 @@ var calendarTabType = {</span>
<a href="#l7.4"></a><span id="l7.4">       },</span>
<a href="#l7.5"></a><span id="l7.5"> </span>
<a href="#l7.6"></a><span id="l7.6">       onTitleChanged: function(aTab) {</span>
<a href="#l7.7"></a><span id="l7.7">         // Make sure the title is updated.</span>
<a href="#l7.8"></a><span id="l7.8">         // TODO We should move this to a dedicated string some time.</span>
<a href="#l7.9"></a><span id="l7.9">         aTab.title = document.getElementById(&quot;calendar-tab-button&quot;).getAttribute(&quot;tooltiptext&quot;);</span>
<a href="#l7.10"></a><span id="l7.10">       },</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-      supportsCommand: function (aTab, aCommand) calendarController.supportsCommand(aCommand),</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-      isCommandEnabled: function (aTab, aCommand) calendarController.isCommandEnabled(aCommand),</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-      doCommand: function(aTab, aCommand) calendarController.doCommand(aCommand),</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-      onEvent: function(aTab, aEvent) calendarController.onEvent(aEvent)</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+      supportsCommand: function (aCommand, aTab) calendarController.supportsCommand(aCommand),</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+      isCommandEnabled: function (aCommand, aTab) calendarController.isCommandEnabled(aCommand),</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+      doCommand: function(aCommand, aTab) calendarController.doCommand(aCommand),</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+      onEvent: function(aEvent, aTab) calendarController.onEvent(aEvent)</span>
<a href="#l7.20"></a><span id="l7.20">     },</span>
<a href="#l7.21"></a><span id="l7.21"> </span>
<a href="#l7.22"></a><span id="l7.22">     tasks: {</span>
<a href="#l7.23"></a><span id="l7.23">       type: &quot;tasks&quot;,</span>
<a href="#l7.24"></a><span id="l7.24">       maxTabs: 1,</span>
<a href="#l7.25"></a><span id="l7.25">       openTab: function(aTab, aArgs) {</span>
<a href="#l7.26"></a><span id="l7.26">         aTab.title = aArgs[&quot;title&quot;];</span>
<a href="#l7.27"></a><span id="l7.27">         if (!(&quot;background&quot; in aArgs) || !aArgs[&quot;background&quot;]) {</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineat">@@ -148,20 +148,20 @@ var calendarTabType = {</span>
<a href="#l7.29"></a><span id="l7.29">         };</span>
<a href="#l7.30"></a><span id="l7.30">       },</span>
<a href="#l7.31"></a><span id="l7.31"> </span>
<a href="#l7.32"></a><span id="l7.32">       restoreTab: function(aTabmail, aState) {</span>
<a href="#l7.33"></a><span id="l7.33">         aState.title = document.getElementById('task-tab-button').getAttribute('tooltiptext');</span>
<a href="#l7.34"></a><span id="l7.34">         aTabmail.openTab('tasks', aState);</span>
<a href="#l7.35"></a><span id="l7.35">       },</span>
<a href="#l7.36"></a><span id="l7.36"> </span>
<a href="#l7.37"></a><span id="l7.37" class="difflineminus">-      supportsCommand: function (aTab, aCommand) calendarController.supportsCommand(aCommand),</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineminus">-      isCommandEnabled: function (aTab, aCommand) calendarController.isCommandEnabled(aCommand),</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineminus">-      doCommand: function(aTab, aCommand) calendarController.doCommand(aCommand),</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineminus">-      onEvent: function(aTab, aEvent) calendarController.onEvent(aEvent)</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineplus">+      supportsCommand: function (aCommand, aTab) calendarController.supportsCommand(aCommand),</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+      isCommandEnabled: function (aCommand, aTab) calendarController.isCommandEnabled(aCommand),</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineplus">+      doCommand: function(aCommand, aTab) calendarController.doCommand(aCommand),</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineplus">+      onEvent: function(aEvent, aTab) calendarController.onEvent(aEvent)</span>
<a href="#l7.45"></a><span id="l7.45">     },</span>
<a href="#l7.46"></a><span id="l7.46">   },</span>
<a href="#l7.47"></a><span id="l7.47"> </span>
<a href="#l7.48"></a><span id="l7.48">   /* because calendar does some direct menu manipulation, we need to change</span>
<a href="#l7.49"></a><span id="l7.49">    *  to the mail mode to clean up after those hacks.</span>
<a href="#l7.50"></a><span id="l7.50">    */</span>
<a href="#l7.51"></a><span id="l7.51">   saveTabState: function(aTab) {</span>
<a href="#l7.52"></a><span id="l7.52">     ltnSwitch2Mail();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/lightning/install.rdf</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/lightning/install.rdf</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -6,17 +6,17 @@</span>
<a href="#l8.4"></a><span id="l8.4"> </span>
<a href="#l8.5"></a><span id="l8.5">   &lt;Description about=&quot;urn:mozilla:install-manifest&quot;&gt;</span>
<a href="#l8.6"></a><span id="l8.6">     &lt;!-- Target Application this extension can install into, </span>
<a href="#l8.7"></a><span id="l8.7">         with minimum and maximum supported versions. --&gt; </span>
<a href="#l8.8"></a><span id="l8.8">     &lt;em:targetApplication&gt;</span>
<a href="#l8.9"></a><span id="l8.9">       &lt;Description&gt;</span>
<a href="#l8.10"></a><span id="l8.10">         &lt;!-- thunderbird --&gt;</span>
<a href="#l8.11"></a><span id="l8.11">         &lt;em:id&gt;{3550f703-e582-4d05-9a08-453d09bdfdc6}&lt;/em:id&gt;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-        &lt;em:minVersion&gt;3.0b3&lt;/em:minVersion&gt;</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+        &lt;em:minVersion&gt;3.0b4pre&lt;/em:minVersion&gt;</span>
<a href="#l8.14"></a><span id="l8.14">         &lt;em:maxVersion&gt;@THUNDERBIRD_VERSION@&lt;/em:maxVersion&gt;</span>
<a href="#l8.15"></a><span id="l8.15">       &lt;/Description&gt;</span>
<a href="#l8.16"></a><span id="l8.16">     &lt;/em:targetApplication&gt;</span>
<a href="#l8.17"></a><span id="l8.17"> </span>
<a href="#l8.18"></a><span id="l8.18"> #if LIGHTNING_FIREFOX</span>
<a href="#l8.19"></a><span id="l8.19">     &lt;!-- We only allow installation of Lightning into Firefox for ease of</span>
<a href="#l8.20"></a><span id="l8.20">        - development. You can edit the JS and then click reload in Firefox as</span>
<a href="#l8.21"></a><span id="l8.21">        - opposed to having to restart Thunderbird after each edit. --&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/providers/composite/calCompositeCalendar.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/providers/composite/calCompositeCalendar.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -99,18 +99,18 @@ calCompositeCalendarObserverHelper.proto</span>
<a href="#l9.4"></a><span id="l9.4">     }</span>
<a href="#l9.5"></a><span id="l9.5"> };</span>
<a href="#l9.6"></a><span id="l9.6"> </span>
<a href="#l9.7"></a><span id="l9.7"> function calCompositeCalendar () {</span>
<a href="#l9.8"></a><span id="l9.8">     this.mObserverHelper = new calCompositeCalendarObserverHelper(this);</span>
<a href="#l9.9"></a><span id="l9.9">     this.wrappedJSObject = this;</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11">     this.mCalendars = new Array();</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    this.mCompositeObservers = new cal.observerBag(Components.interfaces.calICompositeObserver);</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-    this.mObservers = new cal.observerBag(Components.interfaces.calIObserver);</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+    this.mCompositeObservers = new cal.ObserverBag(Components.interfaces.calICompositeObserver);</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+    this.mObservers = new cal.ObserverBag(Components.interfaces.calIObserver);</span>
<a href="#l9.16"></a><span id="l9.16">     this.mDefaultCalendar = null;</span>
<a href="#l9.17"></a><span id="l9.17">     this.mStatusObserver = null;</span>
<a href="#l9.18"></a><span id="l9.18"> }</span>
<a href="#l9.19"></a><span id="l9.19"> </span>
<a href="#l9.20"></a><span id="l9.20"> calCompositeCalendar.prototype = {</span>
<a href="#l9.21"></a><span id="l9.21">     //</span>
<a href="#l9.22"></a><span id="l9.22">     // private members</span>
<a href="#l9.23"></a><span id="l9.23">     //</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/providers/memory/calMemoryCalendar.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/providers/memory/calMemoryCalendar.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -59,17 +59,17 @@ calMemoryCalendar.prototype = {</span>
<a href="#l10.4"></a><span id="l10.4">     // </span>
<a href="#l10.5"></a><span id="l10.5">     QueryInterface: function (aIID) {</span>
<a href="#l10.6"></a><span id="l10.6">         return doQueryInterface(this, calMemoryCalendar.prototype, aIID,</span>
<a href="#l10.7"></a><span id="l10.7">                                 [Components.interfaces.calISyncWriteCalendar,</span>
<a href="#l10.8"></a><span id="l10.8">                                  Components.interfaces.calICalendarProvider]);</span>
<a href="#l10.9"></a><span id="l10.9">     },</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11">     initMemoryCalendar: function() {</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-        this.mObservers = new cal.observerBag(Components.interfaces.calIObserver);</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+        this.mObservers = new cal.ObserverBag(Components.interfaces.calIObserver);</span>
<a href="#l10.14"></a><span id="l10.14">         this.mItems = {};</span>
<a href="#l10.15"></a><span id="l10.15">         this.mMetaData = new calPropertyBag();</span>
<a href="#l10.16"></a><span id="l10.16">     },</span>
<a href="#l10.17"></a><span id="l10.17"> </span>
<a href="#l10.18"></a><span id="l10.18">     //</span>
<a href="#l10.19"></a><span id="l10.19">     // calICalendarProvider interface</span>
<a href="#l10.20"></a><span id="l10.20">     //</span>
<a href="#l10.21"></a><span id="l10.21">     get prefChromeOverlay() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdImageOverlay.xul</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdImageOverlay.xul</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -254,22 +254,32 @@</span>
<a href="#l11.4"></a><span id="l11.4">       &lt;/grid&gt;</span>
<a href="#l11.5"></a><span id="l11.5">     &lt;/groupbox&gt;</span>
<a href="#l11.6"></a><span id="l11.6"> </span>
<a href="#l11.7"></a><span id="l11.7">     &lt;vbox&gt;</span>
<a href="#l11.8"></a><span id="l11.8">       &lt;groupbox align=&quot;start&quot;&gt;</span>
<a href="#l11.9"></a><span id="l11.9">         &lt;caption id=&quot;alignLabel&quot; label=&quot;&amp;alignment.label;&quot;/&gt;</span>
<a href="#l11.10"></a><span id="l11.10">         &lt;menulist id=&quot;alignTypeSelect&quot; class=&quot;align-menu&quot;&gt;</span>
<a href="#l11.11"></a><span id="l11.11">           &lt;menupopup&gt;</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-            &lt;menuitem class=&quot;align-menu&quot; value=&quot;top&quot;    label=&quot;&amp;topPopup.value;&quot;/&gt;</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-            &lt;menuitem class=&quot;align-menu&quot; value=&quot;middle&quot; label=&quot;&amp;centerPopup.value;&quot;/&gt;</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-            &lt;menuitem class=&quot;align-menu&quot; value=&quot;bottom&quot; label=&quot;&amp;bottomPopup.value;&quot;/&gt;</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+            &lt;menuitem class=&quot;align-menu menuitem-iconic&quot;</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+                      value=&quot;top&quot;</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+                      label=&quot;&amp;topPopup.value;&quot;/&gt;</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+            &lt;menuitem class=&quot;align-menu menuitem-iconic&quot;</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineplus">+                      value=&quot;middle&quot;</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineplus">+                      label=&quot;&amp;centerPopup.value;&quot;/&gt;</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineplus">+            &lt;menuitem class=&quot;align-menu menuitem-iconic&quot;</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineplus">+                      value=&quot;bottom&quot;</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineplus">+                      label=&quot;&amp;bottomPopup.value;&quot;/&gt;</span>
<a href="#l11.24"></a><span id="l11.24">             &lt;!-- HTML attribute value is opposite of the button label on purpose --&gt;</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineminus">-            &lt;menuitem class=&quot;align-menu&quot; value=&quot;right&quot;  label=&quot;&amp;wrapLeftPopup.value;&quot;/&gt;</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineminus">-            &lt;menuitem class=&quot;align-menu&quot; value=&quot;left&quot;   label=&quot;&amp;wrapRightPopup.value;&quot;/&gt;</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineplus">+            &lt;menuitem class=&quot;align-menu menuitem-iconic&quot;</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+                      value=&quot;right&quot;</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineplus">+                      label=&quot;&amp;wrapLeftPopup.value;&quot;/&gt;</span>
<a href="#l11.30"></a><span id="l11.30" class="difflineplus">+            &lt;menuitem class=&quot;align-menu menuitem-iconic&quot;</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineplus">+                      value=&quot;left&quot;</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+                      label=&quot;&amp;wrapRightPopup.value;&quot;/&gt;</span>
<a href="#l11.33"></a><span id="l11.33">           &lt;/menupopup&gt;</span>
<a href="#l11.34"></a><span id="l11.34">         &lt;/menulist&gt;</span>
<a href="#l11.35"></a><span id="l11.35">       &lt;/groupbox&gt;</span>
<a href="#l11.36"></a><span id="l11.36"> </span>
<a href="#l11.37"></a><span id="l11.37">       &lt;groupbox&gt;</span>
<a href="#l11.38"></a><span id="l11.38">         &lt;caption id=&quot;imagemapLabel&quot; label=&quot;&amp;imagemapBox.label;&quot;/&gt;</span>
<a href="#l11.39"></a><span id="l11.39">         &lt;hbox equalsize=&quot;always&quot;&gt;</span>
<a href="#l11.40"></a><span id="l11.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/app/profile/all-thunderbird.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/app/profile/all-thunderbird.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -462,8 +462,12 @@ pref(&quot;mail.compose.attachment_reminder&quot;,</span>
<a href="#l12.4"></a><span id="l12.4"> // Words that should trigger a missing attachments warning.</span>
<a href="#l12.5"></a><span id="l12.5"> pref(&quot;mail.compose.attachment_reminder_keywords&quot;, &quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;);</span>
<a href="#l12.6"></a><span id="l12.6"> </span>
<a href="#l12.7"></a><span id="l12.7"> pref(&quot;browser.formfill.enable&quot;, true);</span>
<a href="#l12.8"></a><span id="l12.8"> // Override the all.js values so that unit tests pass and we get sane values.</span>
<a href="#l12.9"></a><span id="l12.9"> pref(&quot;browser.history_expire_days&quot;, 180);</span>
<a href="#l12.10"></a><span id="l12.10"> pref(&quot;browser.history_expire_days_min&quot;, 90);</span>
<a href="#l12.11"></a><span id="l12.11"> pref(&quot;browser.history_expire_sites&quot;, 40000);</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+// Disable autoplay as we don't handle audio elements in emails very well.</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+// See bug 515082.</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+pref(&quot;media.autoplay.enabled&quot;, false);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mail/base/content/SearchDialog.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mail/base/content/SearchDialog.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -639,22 +639,16 @@ function MoveMessageInSearch(destFolder)</span>
<a href="#l13.4"></a><span id="l13.4">   }</span>
<a href="#l13.5"></a><span id="l13.5"> }</span>
<a href="#l13.6"></a><span id="l13.6"> </span>
<a href="#l13.7"></a><span id="l13.7"> function GoToFolder()</span>
<a href="#l13.8"></a><span id="l13.8"> {</span>
<a href="#l13.9"></a><span id="l13.9">   MsgOpenNewWindowForFolder(gFolderDisplay.selectedMessage);</span>
<a href="#l13.10"></a><span id="l13.10"> }</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-function BeginDragThreadPane(event)</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-{</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-    // no search pane dnd yet</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineminus">-    return false;</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineminus">-}</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineminus">-</span>
<a href="#l13.18"></a><span id="l13.18"> function saveAsVirtualFolder()</span>
<a href="#l13.19"></a><span id="l13.19"> {</span>
<a href="#l13.20"></a><span id="l13.20">   var searchFolderURIs = window.arguments[0].folder.URI;</span>
<a href="#l13.21"></a><span id="l13.21"> </span>
<a href="#l13.22"></a><span id="l13.22">   var searchSubfolders = document.getElementById(&quot;checkSearchSubFolders&quot;).checked;</span>
<a href="#l13.23"></a><span id="l13.23">   if (gCurrentFolder &amp;&amp; (searchSubfolders || gCurrentFolder.isServer || gCurrentFolder.noSelect))</span>
<a href="#l13.24"></a><span id="l13.24">   {</span>
<a href="#l13.25"></a><span id="l13.25">     var subFolderURIs = AddSubFoldersToURI(gCurrentFolder);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mail/base/content/SearchDialog.xul</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mail/base/content/SearchDialog.xul</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -62,17 +62,16 @@</span>
<a href="#l14.4"></a><span id="l14.4">   &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/messageDisplay.js&quot;/&gt;</span>
<a href="#l14.5"></a><span id="l14.5">   &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/threadPane.js&quot;/&gt;</span>
<a href="#l14.6"></a><span id="l14.6">   &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/msgMail3PaneWindow.js&quot;/&gt;</span>
<a href="#l14.7"></a><span id="l14.7">   &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://global/content/globalOverlay.js&quot;/&gt;</span>
<a href="#l14.8"></a><span id="l14.8">   &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/mailCommands.js&quot;/&gt;</span>
<a href="#l14.9"></a><span id="l14.9">   &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/mailWindowOverlay.js&quot;/&gt;</span>
<a href="#l14.10"></a><span id="l14.10">   &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/commandglue.js&quot;/&gt;</span>
<a href="#l14.11"></a><span id="l14.11">   &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/SearchDialog.js&quot;/&gt;</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/messengerdnd.js&quot;/&gt;</span>
<a href="#l14.13"></a><span id="l14.13"> </span>
<a href="#l14.14"></a><span id="l14.14">   &lt;!-- We need this for a SetFolderPicker call, until we de-rdfify this file --&gt;</span>
<a href="#l14.15"></a><span id="l14.15">   &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/msgFolderPickerOverlay.js&quot;/&gt;</span>
<a href="#l14.16"></a><span id="l14.16">   &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/widgetglue.js&quot;/&gt;</span>
<a href="#l14.17"></a><span id="l14.17"> </span>
<a href="#l14.18"></a><span id="l14.18">   &lt;commands id=&quot;commands&quot;&gt;</span>
<a href="#l14.19"></a><span id="l14.19">     &lt;commandset id=&quot;mailSearchItems&quot;</span>
<a href="#l14.20"></a><span id="l14.20">                 commandupdater=&quot;true&quot;</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineat">@@ -120,18 +119,18 @@</span>
<a href="#l14.22"></a><span id="l14.22"> </span>
<a href="#l14.23"></a><span id="l14.23">          &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l14.24"></a><span id="l14.24">            &lt;checkbox id=&quot;checkSearchSubFolders&quot; label=&quot;&amp;searchSubfolders.label;&quot; checked=&quot;true&quot; accesskey=&quot;&amp;searchSubfolders.accesskey;&quot;/&gt;</span>
<a href="#l14.25"></a><span id="l14.25">            &lt;spacer flex=&quot;10&quot;/&gt;</span>
<a href="#l14.26"></a><span id="l14.26">            &lt;button label=&quot;&amp;resetButton.label;&quot; oncommand=&quot;onResetSearch(event);&quot; accesskey=&quot;&amp;resetButton.accesskey;&quot;/&gt;</span>
<a href="#l14.27"></a><span id="l14.27">          &lt;/hbox&gt;</span>
<a href="#l14.28"></a><span id="l14.28">          &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l14.29"></a><span id="l14.29">            &lt;checkbox id=&quot;checkSearchOnline&quot;</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineminus">-                     label=&quot;&amp;searchOnline.label;&quot;</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-                     accesskey=&quot;&amp;searchOnline.accesskey;&quot;</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+                     label=&quot;&amp;searchOnServer.label;&quot;</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineplus">+                     accesskey=&quot;&amp;searchOnServer.accesskey;&quot;</span>
<a href="#l14.34"></a><span id="l14.34">                      oncommand=&quot;updateSearchLocalSystem();&quot;/&gt;</span>
<a href="#l14.35"></a><span id="l14.35">          &lt;/hbox&gt;</span>
<a href="#l14.36"></a><span id="l14.36">       &lt;/vbox&gt;</span>
<a href="#l14.37"></a><span id="l14.37"> </span>
<a href="#l14.38"></a><span id="l14.38">       &lt;hbox flex=&quot;1&quot;&gt;</span>
<a href="#l14.39"></a><span id="l14.39">         &lt;vbox id=&quot;searchTermListBox&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l14.40"></a><span id="l14.40">       &lt;/hbox&gt;</span>
<a href="#l14.41"></a><span id="l14.41">     &lt;/vbox&gt;</span>
<a href="#l14.42"></a><span id="l14.42" class="difflineat">@@ -196,17 +195,17 @@</span>
<a href="#l14.43"></a><span id="l14.43">                      label=&quot;&amp;totalColumn.label;&quot; tooltiptext=&quot;&amp;totalColumn.tooltip;&quot;/&gt;</span>
<a href="#l14.44"></a><span id="l14.44">             &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l14.45"></a><span id="l14.45">             &lt;treecol id=&quot;locationCol&quot; persist=&quot;width&quot; flex=&quot;1&quot; hidden=&quot;true&quot; ignoreincolumnpicker=&quot;true&quot;</span>
<a href="#l14.46"></a><span id="l14.46">                      label=&quot;&amp;locationColumn.label;&quot; tooltiptext=&quot;&amp;locationColumn.tooltip;&quot;/&gt;</span>
<a href="#l14.47"></a><span id="l14.47">             &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l14.48"></a><span id="l14.48">             &lt;treecol id=&quot;idCol&quot; persist=&quot;hidden ordinal width&quot; flex=&quot;1&quot; hidden=&quot;true&quot;</span>
<a href="#l14.49"></a><span id="l14.49">                      label=&quot;&amp;idColumn.label;&quot; tooltiptext=&quot;&amp;idColumn.tooltip;&quot;/&gt;</span>
<a href="#l14.50"></a><span id="l14.50">           &lt;/treecols&gt;</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineminus">-          &lt;treechildren ondraggesture=&quot;BeginDragThreadPane(event);&quot;/&gt;</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+          &lt;treechildren ondraggesture=&quot;ThreadPaneOnDragStart(event);&quot;/&gt;</span>
<a href="#l14.53"></a><span id="l14.53">         &lt;/tree&gt;</span>
<a href="#l14.54"></a><span id="l14.54">       &lt;/vbox&gt;</span>
<a href="#l14.55"></a><span id="l14.55">       &lt;hbox align=&quot;start&quot;&gt; </span>
<a href="#l14.56"></a><span id="l14.56">         &lt;button label=&quot;&amp;openButton.label;&quot; id=&quot;openButton&quot; command=&quot;cmd_open&quot; accesskey=&quot;&amp;openButton.accesskey;&quot;/&gt;</span>
<a href="#l14.57"></a><span id="l14.57">         &lt;button id=&quot;fileMessageButton&quot; type=&quot;menu&quot; label=&quot;&amp;fileButton.label;&quot;</span>
<a href="#l14.58"></a><span id="l14.58">                 accesskey=&quot;&amp;fileButton.accesskey;&quot;</span>
<a href="#l14.59"></a><span id="l14.59">                 observes=&quot;file_message_button&quot;</span>
<a href="#l14.60"></a><span id="l14.60">                 oncommand=&quot;MoveMessageInSearch(event.target)&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mail/base/content/aboutDialog.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mail/base/content/aboutDialog.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -82,13 +82,28 @@ function switchPage(aEvent) {</span>
<a href="#l15.4"></a><span id="l15.4">                         document.documentElement.getAttribute(&quot;creditsaccesskey&quot;));</span>
<a href="#l15.5"></a><span id="l15.5">     gSelectedPage = 0;</span>
<a href="#l15.6"></a><span id="l15.6">   }</span>
<a href="#l15.7"></a><span id="l15.7">   document.getElementById(&quot;modes&quot;).setAttribute(&quot;selectedIndex&quot;, gSelectedPage);</span>
<a href="#l15.8"></a><span id="l15.8"> }</span>
<a href="#l15.9"></a><span id="l15.9"> </span>
<a href="#l15.10"></a><span id="l15.10"> function loadAbout(type)</span>
<a href="#l15.11"></a><span id="l15.11"> {</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-  window.openDialog(&quot;chrome://messenger/content/&quot;, &quot;_blank&quot;,</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-                    &quot;chrome,dialog=no,all&quot;, null,</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineminus">-                    { tabType: &quot;contentTab&quot;,</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-                      tabParams: { contentPage: &quot;about:&quot; + type } });</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+  let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineplus">+  if (!tabmail) {</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineplus">+    // Try opening new tabs in an existing 3pane window</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+    let mail3PaneWindow = Components.classes[&quot;@mozilla.org/appshell/window-mediator;1&quot;]</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineplus">+                                    .getService(Components.interfaces.nsIWindowMediator)</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineplus">+                                    .getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineplus">+    if (mail3PaneWindow) {</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+      tabmail = mail3PaneWindow.document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineplus">+      mail3PaneWindow.focus();</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+    }</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+  }</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineplus">+</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineplus">+  if (tabmail)</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineplus">+    tabmail.openTab(&quot;contentTab&quot;, {contentPage: &quot;about:&quot; + type});</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineplus">+  else</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineplus">+    window.openDialog(&quot;chrome://messenger/content/&quot;, &quot;_blank&quot;,</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+                      &quot;chrome,dialog=no,all&quot;, null,</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineplus">+                      { tabType: &quot;contentTab&quot;,</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineplus">+                        tabParams: {contentPage: &quot;about:&quot; + type} });</span>
<a href="#l15.35"></a><span id="l15.35"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mail/base/content/folderDisplay.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mail/base/content/folderDisplay.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -958,16 +958,39 @@ FolderDisplayWidget.prototype = {</span>
<a href="#l16.4"></a><span id="l16.4">     }</span>
<a href="#l16.5"></a><span id="l16.5"> </span>
<a href="#l16.6"></a><span id="l16.6">     // - new messages</span>
<a href="#l16.7"></a><span id="l16.7">     // if configured to scroll to new messages, try that</span>
<a href="#l16.8"></a><span id="l16.8">     if (gPrefBranch.getBoolPref(&quot;mailnews.scroll_to_new_message&quot;) &amp;&amp;</span>
<a href="#l16.9"></a><span id="l16.9">         this.navigate(nsMsgNavigationType.firstNew, /* select */ false))</span>
<a href="#l16.10"></a><span id="l16.10">       return;</span>
<a href="#l16.11"></a><span id="l16.11"> </span>
<a href="#l16.12"></a><span id="l16.12" class="difflineplus">+    // - last selected message</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+    // if configured to load the last selected message (this is currently more</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+    //  persistent than our saveSelection/restoreSelection stuff), and the view</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+    //  is backed by a single underlying folder (the only way having just a</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineplus">+    //  message key works out), try that</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineplus">+    if (gPrefBranch.getBoolPref(&quot;mailnews.remember_selected_message&quot;) &amp;&amp;</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineplus">+        this.view.isSingleFolder) {</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineplus">+      // use the displayed folder; nsMsgDBView goes to the effort to save the</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineplus">+      //  state to the viewFolder, so this is the correct course of action.</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineplus">+      let lastLoadedMessageKey = this.view.displayedFolder.lastMessageLoaded;</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineplus">+      if (lastLoadedMessageKey != nsMsgKey_None) {</span>
<a href="#l16.23"></a><span id="l16.23" class="difflineplus">+        this.view.dbView.selectMsgByKey(lastLoadedMessageKey);</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineplus">+        // The message key may not be present in the view for a variety of</span>
<a href="#l16.25"></a><span id="l16.25" class="difflineplus">+        //  reasons.  Beyond message deletion, it simply may not match the</span>
<a href="#l16.26"></a><span id="l16.26" class="difflineplus">+        //  active mail view or quick search, for example.</span>
<a href="#l16.27"></a><span id="l16.27" class="difflineplus">+        if (this.view.dbView.numSelected &gt; 0) {</span>
<a href="#l16.28"></a><span id="l16.28" class="difflineplus">+          this.ensureRowIsVisible(</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineplus">+            this.view.dbView.viewIndexForFirstSelectedMsg);</span>
<a href="#l16.30"></a><span id="l16.30" class="difflineplus">+          return;</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineplus">+        }</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineplus">+      }</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineplus">+    }</span>
<a href="#l16.34"></a><span id="l16.34" class="difflineplus">+</span>
<a href="#l16.35"></a><span id="l16.35">     // - towards the newest messages, but don't select</span>
<a href="#l16.36"></a><span id="l16.36">     if (this.view.isSortedAscending &amp;&amp; this.view.sortImpliesTemporalOrdering &amp;&amp;</span>
<a href="#l16.37"></a><span id="l16.37">       this.navigate(nsMsgNavigationType.lastMessage, /* select */ false))</span>
<a href="#l16.38"></a><span id="l16.38">       return;</span>
<a href="#l16.39"></a><span id="l16.39"> </span>
<a href="#l16.40"></a><span id="l16.40">     // - to the top, the coliseum</span>
<a href="#l16.41"></a><span id="l16.41">     this.ensureRowIsVisible(0);</span>
<a href="#l16.42"></a><span id="l16.42">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mail/base/content/folderPane.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mail/base/content/folderPane.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -32,16 +32,18 @@</span>
<a href="#l17.4"></a><span id="l17.4">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l17.5"></a><span id="l17.5">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l17.6"></a><span id="l17.6">  *</span>
<a href="#l17.7"></a><span id="l17.7">  * ***** END LICENSE BLOCK ***** */</span>
<a href="#l17.8"></a><span id="l17.8"> </span>
<a href="#l17.9"></a><span id="l17.9"> Components.utils.import(&quot;resource://gre/modules/iteratorUtils.jsm&quot;);</span>
<a href="#l17.10"></a><span id="l17.10"> Components.utils.import(&quot;resource://gre/modules/folderUtils.jsm&quot;);</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+const kDefaultMode = &quot;smart&quot;;</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+</span>
<a href="#l17.14"></a><span id="l17.14"> /**</span>
<a href="#l17.15"></a><span id="l17.15">  * This file contains the controls and functions for the folder pane.</span>
<a href="#l17.16"></a><span id="l17.16">  * The following definitions will be useful to know:</span>
<a href="#l17.17"></a><span id="l17.17">  *</span>
<a href="#l17.18"></a><span id="l17.18">  * gFolderTreeView - the controller for the folder tree.</span>
<a href="#l17.19"></a><span id="l17.19">  * ftvItem  - folder tree view item, representing a row in the tree</span>
<a href="#l17.20"></a><span id="l17.20">  * mode - folder view type, e.g., all folders, favorite folders, MRU...</span>
<a href="#l17.21"></a><span id="l17.21">  */</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineat">@@ -71,17 +73,18 @@ let gFolderTreeView = {</span>
<a href="#l17.23"></a><span id="l17.23"> </span>
<a href="#l17.24"></a><span id="l17.24">     try {</span>
<a href="#l17.25"></a><span id="l17.25">       // Normally our tree takes care of keeping the last selected by itself.</span>
<a href="#l17.26"></a><span id="l17.26">       // However older versions of TB stored this in a preference, which we need</span>
<a href="#l17.27"></a><span id="l17.27">       // to migrate</span>
<a href="#l17.28"></a><span id="l17.28">       let prefB = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l17.29"></a><span id="l17.29">                      .getService(Ci.nsIPrefBranch);</span>
<a href="#l17.30"></a><span id="l17.30">       let modeIndex = prefB.getIntPref(&quot;mail.ui.folderpane.view&quot;);</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineminus">-      this._mode = this._modeNames[modeIndex];</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+      // upgrade default All to Smart</span>
<a href="#l17.33"></a><span id="l17.33" class="difflineplus">+      this._mode = (modeIndex == 0) ? kDefaultMode : this._modeNames[modeIndex];</span>
<a href="#l17.34"></a><span id="l17.34">       prefB.deleteBranch(&quot;mail.ui.folderpane&quot;);</span>
<a href="#l17.35"></a><span id="l17.35">     } catch(ex) {</span>
<a href="#l17.36"></a><span id="l17.36">       // This is ok.  If we've already migrated we'll end up here</span>
<a href="#l17.37"></a><span id="l17.37">     }</span>
<a href="#l17.38"></a><span id="l17.38"> </span>
<a href="#l17.39"></a><span id="l17.39">     if (document.getElementById('folderpane-title')) {</span>
<a href="#l17.40"></a><span id="l17.40">       let string;</span>
<a href="#l17.41"></a><span id="l17.41">         if (this._mode in this._modeDisplayNames)</span>
<a href="#l17.42"></a><span id="l17.42" class="difflineat">@@ -180,17 +183,17 @@ let gFolderTreeView = {</span>
<a href="#l17.43"></a><span id="l17.43">    * @param aCommonName  the common-name with which the mode was previously</span>
<a href="#l17.44"></a><span id="l17.44">    *                     registered</span>
<a href="#l17.45"></a><span id="l17.45">    */</span>
<a href="#l17.46"></a><span id="l17.46">   unregisterMode: function ftv_unregisterMode(aCommonName) {</span>
<a href="#l17.47"></a><span id="l17.47">     this._modeNames.splice(this._modeNames.indexOf(aCommonName), 1);</span>
<a href="#l17.48"></a><span id="l17.48">     delete this._mapGenerators[aCommonName];</span>
<a href="#l17.49"></a><span id="l17.49">     delete this._modeDisplayNames[aCommonName];</span>
<a href="#l17.50"></a><span id="l17.50">     if (this._mode == aCommonName)</span>
<a href="#l17.51"></a><span id="l17.51" class="difflineminus">-      this.mode = &quot;all&quot;;</span>
<a href="#l17.52"></a><span id="l17.52" class="difflineplus">+      this.mode = kDefaultMode;</span>
<a href="#l17.53"></a><span id="l17.53">   },</span>
<a href="#l17.54"></a><span id="l17.54"> </span>
<a href="#l17.55"></a><span id="l17.55">   /**</span>
<a href="#l17.56"></a><span id="l17.56">    * Called to move to the next/prev folder-mode in the list</span>
<a href="#l17.57"></a><span id="l17.57">    *</span>
<a href="#l17.58"></a><span id="l17.58">    * @param aForward  whether or not we should move forward in the list</span>
<a href="#l17.59"></a><span id="l17.59">    */</span>
<a href="#l17.60"></a><span id="l17.60">   cycleMode: function ftv_cycleMode(aForward) {</span>
<a href="#l17.61"></a><span id="l17.61" class="difflineat">@@ -234,17 +237,17 @@ let gFolderTreeView = {</span>
<a href="#l17.62"></a><span id="l17.62">    * correspond to an entry in _mapGenerators</span>
<a href="#l17.63"></a><span id="l17.63">    */</span>
<a href="#l17.64"></a><span id="l17.64">   _mode: null,</span>
<a href="#l17.65"></a><span id="l17.65">   get mode() {</span>
<a href="#l17.66"></a><span id="l17.66">     if (!this._mode) {</span>
<a href="#l17.67"></a><span id="l17.67">       this._mode = this._treeElement.getAttribute(&quot;mode&quot;);</span>
<a href="#l17.68"></a><span id="l17.68">       // this can happen when an extension is removed</span>
<a href="#l17.69"></a><span id="l17.69">       if (!(this._mode in this._mapGenerators))</span>
<a href="#l17.70"></a><span id="l17.70" class="difflineminus">-        this._mode = &quot;all&quot;;</span>
<a href="#l17.71"></a><span id="l17.71" class="difflineplus">+        this._mode = kDefaultMode;</span>
<a href="#l17.72"></a><span id="l17.72">     }</span>
<a href="#l17.73"></a><span id="l17.73">     return this._mode;</span>
<a href="#l17.74"></a><span id="l17.74">   },</span>
<a href="#l17.75"></a><span id="l17.75">   set mode(aMode) {</span>
<a href="#l17.76"></a><span id="l17.76">     this._mode = aMode;</span>
<a href="#l17.77"></a><span id="l17.77"> </span>
<a href="#l17.78"></a><span id="l17.78">     let string;</span>
<a href="#l17.79"></a><span id="l17.79">     if (this._mode in this._modeDisplayNames)</span>
<a href="#l17.80"></a><span id="l17.80" class="difflineat">@@ -767,33 +770,43 @@ let gFolderTreeView = {</span>
<a href="#l17.81"></a><span id="l17.81">     return folders;</span>
<a href="#l17.82"></a><span id="l17.82">   },</span>
<a href="#l17.83"></a><span id="l17.83"> </span>
<a href="#l17.84"></a><span id="l17.84">   _smartFoldersGenerator: function ftv_smartFoldersGenerator(ftv)</span>
<a href="#l17.85"></a><span id="l17.85">   {</span>
<a href="#l17.86"></a><span id="l17.86">     let map = [];</span>
<a href="#l17.87"></a><span id="l17.87">     let acctMgr = Components.classes[&quot;@mozilla.org/messenger/account-manager;1&quot;]</span>
<a href="#l17.88"></a><span id="l17.88">                     .getService(Components.interfaces.nsIMsgAccountManager);</span>
<a href="#l17.89"></a><span id="l17.89" class="difflineplus">+    // Smart mode only makes sense if there's more than 1 incoming mail account,</span>
<a href="#l17.90"></a><span id="l17.90" class="difflineplus">+    // so check for that and fall back to &quot;all folders&quot; if we don't find a 2nd.</span>
<a href="#l17.91"></a><span id="l17.91" class="difflineplus">+    let accounts = gFolderTreeView._sortedAccounts();</span>
<a href="#l17.92"></a><span id="l17.92" class="difflineplus">+    let numMailAccounts = 0;</span>
<a href="#l17.93"></a><span id="l17.93" class="difflineplus">+    for each (let account in accounts) {</span>
<a href="#l17.94"></a><span id="l17.94" class="difflineplus">+      if (GetInboxFolder(account.incomingServer) != null)</span>
<a href="#l17.95"></a><span id="l17.95" class="difflineplus">+        numMailAccounts++;</span>
<a href="#l17.96"></a><span id="l17.96" class="difflineplus">+      if (numMailAccounts &gt; 1)</span>
<a href="#l17.97"></a><span id="l17.97" class="difflineplus">+        break;</span>
<a href="#l17.98"></a><span id="l17.98" class="difflineplus">+    }</span>
<a href="#l17.99"></a><span id="l17.99" class="difflineplus">+    if (numMailAccounts &lt;= 1)</span>
<a href="#l17.100"></a><span id="l17.100" class="difflineplus">+      return ftv._mapGenerators[&quot;all&quot;](ftv);</span>
<a href="#l17.101"></a><span id="l17.101">     let smartServer;</span>
<a href="#l17.102"></a><span id="l17.102">     try {</span>
<a href="#l17.103"></a><span id="l17.103">       smartServer = acctMgr.FindServer(&quot;nobody&quot;, &quot;smart mailboxes&quot;, &quot;none&quot;);</span>
<a href="#l17.104"></a><span id="l17.104">     } catch (ex) {</span>
<a href="#l17.105"></a><span id="l17.105">       smartServer = acctMgr.createIncomingServer(&quot;nobody&quot;, &quot;smart mailboxes&quot;, &quot;none&quot;);</span>
<a href="#l17.106"></a><span id="l17.106">       // We don't want the &quot;smart&quot; server/account leaking out into the ui in</span>
<a href="#l17.107"></a><span id="l17.107">       // other places, so set it as hidden.</span>
<a href="#l17.108"></a><span id="l17.108">       smartServer.hidden = true;</span>
<a href="#l17.109"></a><span id="l17.109">       let account = acctMgr.createAccount();</span>
<a href="#l17.110"></a><span id="l17.110">       account.incomingServer = smartServer;</span>
<a href="#l17.111"></a><span id="l17.111">     }</span>
<a href="#l17.112"></a><span id="l17.112">     smartServer.prettyName = document.getElementById(&quot;bundle_messenger&quot;)</span>
<a href="#l17.113"></a><span id="l17.113">                              .getString(&quot;smartAccountName&quot;);</span>
<a href="#l17.114"></a><span id="l17.114">     smartServer.canHaveFilters = false;</span>
<a href="#l17.115"></a><span id="l17.115"> </span>
<a href="#l17.116"></a><span id="l17.116" class="difflineminus">-    let accounts = gFolderTreeView._sortedAccounts();</span>
<a href="#l17.117"></a><span id="l17.117" class="difflineminus">-</span>
<a href="#l17.118"></a><span id="l17.118">     let smartRoot = smartServer.rootFolder;</span>
<a href="#l17.119"></a><span id="l17.119">     let nsMsgFolderFlags = Components.interfaces.nsMsgFolderFlags;</span>
<a href="#l17.120"></a><span id="l17.120">     let smartChildren = new Array;</span>
<a href="#l17.121"></a><span id="l17.121">     gFolderTreeView._addSmartFoldersForFlag(smartChildren, accounts, smartRoot,</span>
<a href="#l17.122"></a><span id="l17.122">                                             nsMsgFolderFlags.Inbox, &quot;Inbox&quot;);</span>
<a href="#l17.123"></a><span id="l17.123">     gFolderTreeView._addSmartFoldersForFlag(smartChildren, accounts, smartRoot,</span>
<a href="#l17.124"></a><span id="l17.124">                                             nsMsgFolderFlags.Drafts, &quot;Drafts&quot;);</span>
<a href="#l17.125"></a><span id="l17.125">     gFolderTreeView._addSmartFoldersForFlag(smartChildren, accounts, smartRoot,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mail/base/content/mailContextMenus.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mail/base/content/mailContextMenus.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -123,38 +123,40 @@ function fillMailContextMenu(event)</span>
<a href="#l18.4"></a><span id="l18.4">   var selectedMessage = gFolderDisplay.selectedMessage;</span>
<a href="#l18.5"></a><span id="l18.5">   var isNewsgroup = gFolderDisplay.selectedMessageIsNews;</span>
<a href="#l18.6"></a><span id="l18.6"> </span>
<a href="#l18.7"></a><span id="l18.7">   // Don't show mail items for links/images, just show related items.</span>
<a href="#l18.8"></a><span id="l18.8">   var hideMailItems = !inThreadPane &amp;&amp;</span>
<a href="#l18.9"></a><span id="l18.9">                       (gContextMenu.onImage || gContextMenu.onLink);</span>
<a href="#l18.10"></a><span id="l18.10">   var single = (numSelected == 1);</span>
<a href="#l18.11"></a><span id="l18.11"> </span>
<a href="#l18.12"></a><span id="l18.12" class="difflineplus">+  let onPlayableMedia = gContextMenu.onVideo || gContextMenu.onAudio;</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+</span>
<a href="#l18.14"></a><span id="l18.14">   // Select-all and copy are only available in the message-pane</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineminus">-  if (inThreadPane) {</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineminus">-    document.getElementById(&quot;mailContext-selectall&quot;).hidden = true;</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineminus">-    document.getElementById(&quot;mailContext-copy&quot;).hidden = true;</span>
<a href="#l18.18"></a><span id="l18.18" class="difflineminus">-  }</span>
<a href="#l18.19"></a><span id="l18.19" class="difflineplus">+  ShowMenuItem(&quot;mailContext-selectall&quot;, !inThreadPane &amp;&amp; !onPlayableMedia);</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineplus">+  ShowMenuItem(&quot;mailContext-copy&quot;, !inThreadPane &amp;&amp; !onPlayableMedia);</span>
<a href="#l18.21"></a><span id="l18.21"> </span>
<a href="#l18.22"></a><span id="l18.22">   // Show the Open in New Window  and New Tab options if there is exactly one</span>
<a href="#l18.23"></a><span id="l18.23">   // message selected.</span>
<a href="#l18.24"></a><span id="l18.24">   ShowMenuItem(&quot;mailContext-openNewWindow&quot;, single &amp;&amp; inThreadPane);</span>
<a href="#l18.25"></a><span id="l18.25">   ShowMenuItem(&quot;threadPaneContext-openNewTab&quot;, single &amp;&amp; inThreadPane);</span>
<a href="#l18.26"></a><span id="l18.26"> </span>
<a href="#l18.27"></a><span id="l18.27">   /**</span>
<a href="#l18.28"></a><span id="l18.28">    * Most menu items are visible if there's 1 or 0 messages selected, and</span>
<a href="#l18.29"></a><span id="l18.29">    * enabled if there's exactly one selected. Handle those here.</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineplus">+   * Exception: playable media is selected, in which case, don't show them.</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+   *</span>
<a href="#l18.32"></a><span id="l18.32">    * @param aID   the id of the element to display/enable</span>
<a href="#l18.33"></a><span id="l18.33">    * @param aHide (optional)  an additional criteria to evaluate when we</span>
<a href="#l18.34"></a><span id="l18.34">    *              decide whether to display the element. If false, we'll hide</span>
<a href="#l18.35"></a><span id="l18.35">    *              the item no matter what messages are selected</span>
<a href="#l18.36"></a><span id="l18.36">    */</span>
<a href="#l18.37"></a><span id="l18.37">  function setSingleSelection(aID, aHide) {</span>
<a href="#l18.38"></a><span id="l18.38">     var hide = aHide != undefined ? aHide : true;</span>
<a href="#l18.39"></a><span id="l18.39" class="difflineminus">-    ShowMenuItem(aID, single &amp;&amp; !hideMailItems &amp;&amp; hide);</span>
<a href="#l18.40"></a><span id="l18.40" class="difflineplus">+    ShowMenuItem(aID, single &amp;&amp; !hideMailItems &amp;&amp; hide &amp;&amp; !onPlayableMedia);</span>
<a href="#l18.41"></a><span id="l18.41">     EnableMenuItem(aID, single);</span>
<a href="#l18.42"></a><span id="l18.42">   }</span>
<a href="#l18.43"></a><span id="l18.43"> </span>
<a href="#l18.44"></a><span id="l18.44">   setSingleSelection(&quot;mailContext-replySender&quot;);</span>
<a href="#l18.45"></a><span id="l18.45">   setSingleSelection(&quot;mailContext-editAsNew&quot;);</span>
<a href="#l18.46"></a><span id="l18.46">   setSingleSelection(&quot;mailContext-replyNewsgroup&quot;, isNewsgroup);</span>
<a href="#l18.47"></a><span id="l18.47">   setSingleSelection(&quot;mailContext-replyAll&quot;);</span>
<a href="#l18.48"></a><span id="l18.48">   setSingleSelection(&quot;mailContext-replyList&quot;);</span>
<a href="#l18.49"></a><span id="l18.49" class="difflineat">@@ -167,46 +169,49 @@ function fillMailContextMenu(event)</span>
<a href="#l18.50"></a><span id="l18.50">   ShowMenuItem(&quot;mailContext-sep-open&quot;, single);</span>
<a href="#l18.51"></a><span id="l18.51"> </span>
<a href="#l18.52"></a><span id="l18.52">   ShowMenuItem(&quot;mailContext-sep-reply&quot;, true);</span>
<a href="#l18.53"></a><span id="l18.53"> </span>
<a href="#l18.54"></a><span id="l18.54">   let msgFolder = gFolderDisplay.displayedFolder;</span>
<a href="#l18.55"></a><span id="l18.55"> </span>
<a href="#l18.56"></a><span id="l18.56">   // Set up the move menu. We can't move from newsgroups.</span>
<a href="#l18.57"></a><span id="l18.57">   ShowMenuItem(&quot;mailContext-moveMenu&quot;,</span>
<a href="#l18.58"></a><span id="l18.58" class="difflineminus">-               !isNewsgroup &amp;&amp; !hideMailItems &amp;&amp; msgFolder);</span>
<a href="#l18.59"></a><span id="l18.59" class="difflineplus">+               !isNewsgroup &amp;&amp; !hideMailItems &amp;&amp; msgFolder &amp;&amp; !onPlayableMedia);</span>
<a href="#l18.60"></a><span id="l18.60"> </span>
<a href="#l18.61"></a><span id="l18.61">   // disable move if we can't delete message(s) from this folder</span>
<a href="#l18.62"></a><span id="l18.62">   var canMove = msgFolder &amp;&amp; msgFolder.canDeleteMessages;</span>
<a href="#l18.63"></a><span id="l18.63" class="difflineminus">-  EnableMenuItem(&quot;mailContext-moveMenu&quot;, canMove);</span>
<a href="#l18.64"></a><span id="l18.64" class="difflineplus">+  EnableMenuItem(&quot;mailContext-moveMenu&quot;, canMove &amp;&amp; !onPlayableMedia);</span>
<a href="#l18.65"></a><span id="l18.65"> </span>
<a href="#l18.66"></a><span id="l18.66">   // Copy is available as long as something is selected.</span>
<a href="#l18.67"></a><span id="l18.67" class="difflineminus">-  ShowMenuItem(&quot;mailContext-copyMenu&quot;, !hideMailItems &amp;&amp; msgFolder);</span>
<a href="#l18.68"></a><span id="l18.68" class="difflineplus">+  ShowMenuItem(&quot;mailContext-copyMenu&quot;,</span>
<a href="#l18.69"></a><span id="l18.69" class="difflineplus">+               !hideMailItems &amp;&amp; msgFolder &amp;&amp; !onPlayableMedia);</span>
<a href="#l18.70"></a><span id="l18.70"> </span>
<a href="#l18.71"></a><span id="l18.71" class="difflineminus">-  ShowMenuItem(&quot;mailContext-moveToFolderAgain&quot;, !hideMailItems &amp;&amp; msgFolder);</span>
<a href="#l18.72"></a><span id="l18.72" class="difflineminus">-  if (!hideMailItems) {</span>
<a href="#l18.73"></a><span id="l18.73" class="difflineplus">+  let hideMoveToFolderAgain = !hideMailItems &amp;&amp; msgFolder &amp;&amp; !onPlayableMedia;</span>
<a href="#l18.74"></a><span id="l18.74" class="difflineplus">+  ShowMenuItem(&quot;mailContext-moveToFolderAgain&quot;, hideMoveToFolderAgain);</span>
<a href="#l18.75"></a><span id="l18.75" class="difflineplus">+  if (hideMoveToFolderAgain) {</span>
<a href="#l18.76"></a><span id="l18.76">     initMoveToFolderAgainMenu(document.getElementById(&quot;mailContext-moveToFolderAgain&quot;));</span>
<a href="#l18.77"></a><span id="l18.77">     goUpdateCommand(&quot;cmd_moveToFolderAgain&quot;);</span>
<a href="#l18.78"></a><span id="l18.78">   }</span>
<a href="#l18.79"></a><span id="l18.79"> </span>
<a href="#l18.80"></a><span id="l18.80">   ShowMenuItem(&quot;paneContext-afterMove&quot;, !inThreadPane);</span>
<a href="#l18.81"></a><span id="l18.81"> </span>
<a href="#l18.82"></a><span id="l18.82" class="difflineminus">-  ShowMenuItem(&quot;mailContext-tags&quot;, !hideMailItems &amp;&amp; msgFolder);</span>
<a href="#l18.83"></a><span id="l18.83" class="difflineplus">+  ShowMenuItem(&quot;mailContext-tags&quot;, !hideMailItems &amp;&amp; msgFolder &amp;&amp; !onPlayableMedia);</span>
<a href="#l18.84"></a><span id="l18.84"> </span>
<a href="#l18.85"></a><span id="l18.85" class="difflineminus">-  ShowMenuItem(&quot;mailContext-mark&quot;, !hideMailItems &amp;&amp; msgFolder);</span>
<a href="#l18.86"></a><span id="l18.86" class="difflineplus">+  ShowMenuItem(&quot;mailContext-mark&quot;, !hideMailItems &amp;&amp; msgFolder &amp;&amp; !onPlayableMedia);</span>
<a href="#l18.87"></a><span id="l18.87"> </span>
<a href="#l18.88"></a><span id="l18.88">   setSingleSelection(&quot;mailContext-saveAs&quot;);</span>
<a href="#l18.89"></a><span id="l18.89">   if (Application.platformIsMac)</span>
<a href="#l18.90"></a><span id="l18.90">     ShowMenuItem(&quot;mailContext-printpreview&quot;, false);</span>
<a href="#l18.91"></a><span id="l18.91">   else</span>
<a href="#l18.92"></a><span id="l18.92">     setSingleSelection(&quot;mailContext-printpreview&quot;);</span>
<a href="#l18.93"></a><span id="l18.93"> </span>
<a href="#l18.94"></a><span id="l18.94" class="difflineminus">-  ShowMenuItem(&quot;mailContext-print&quot;, !hideMailItems);</span>
<a href="#l18.95"></a><span id="l18.95" class="difflineplus">+  ShowMenuItem(&quot;mailContext-print&quot;, !hideMailItems &amp;&amp; !onPlayableMedia);</span>
<a href="#l18.96"></a><span id="l18.96"> </span>
<a href="#l18.97"></a><span id="l18.97" class="difflineminus">-  ShowMenuItem(&quot;mailContext-delete&quot;, !hideMailItems &amp;&amp; (isNewsgroup || canMove));</span>
<a href="#l18.98"></a><span id="l18.98" class="difflineplus">+  ShowMenuItem(&quot;mailContext-delete&quot;,</span>
<a href="#l18.99"></a><span id="l18.99" class="difflineplus">+               !hideMailItems &amp;&amp; (isNewsgroup || canMove) &amp;&amp; !onPlayableMedia);</span>
<a href="#l18.100"></a><span id="l18.100">   // This function is needed for the case where a folder is just loaded (while</span>
<a href="#l18.101"></a><span id="l18.101">   // there isn't a message loaded in the message pane), a right-click is done</span>
<a href="#l18.102"></a><span id="l18.102">   // in the thread pane.  This function will disable enable the 'Delete</span>
<a href="#l18.103"></a><span id="l18.103">   // Message' menu item.</span>
<a href="#l18.104"></a><span id="l18.104">   goUpdateCommand('cmd_delete');</span>
<a href="#l18.105"></a><span id="l18.105"> </span>
<a href="#l18.106"></a><span id="l18.106">   setSingleSelection(&quot;mailContext-composeemailto&quot;,</span>
<a href="#l18.107"></a><span id="l18.107">                      gContextMenu.onMailtoLink &amp;&amp; !inThreadPane);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -527,16 +527,32 @@</span>
<a href="#l19.4"></a><span id="l19.4">               label=&quot;&amp;selectAllCmd.label;&quot;</span>
<a href="#l19.5"></a><span id="l19.5">               accesskey=&quot;&amp;selectAllCmd.accesskey;&quot;</span>
<a href="#l19.6"></a><span id="l19.6">               command=&quot;cmd_selectAll&quot;/&gt;</span>
<a href="#l19.7"></a><span id="l19.7">     &lt;menuitem id=&quot;mailContext-copy&quot;</span>
<a href="#l19.8"></a><span id="l19.8">               label=&quot;&amp;copyCmd.label;&quot;</span>
<a href="#l19.9"></a><span id="l19.9">               accesskey=&quot;&amp;copyCmd.accesskey;&quot;</span>
<a href="#l19.10"></a><span id="l19.10">               command=&quot;cmd_copy&quot;/&gt;</span>
<a href="#l19.11"></a><span id="l19.11">     &lt;menuseparator id=&quot;mailContext-sep-open&quot;/&gt;</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+    &lt;menuitem id=&quot;mailContext-media-play&quot;</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+              label=&quot;&amp;contextPlay.label;&quot;</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+              accesskey=&quot;&amp;contextPlay.accesskey;&quot;</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+              oncommand=&quot;gContextMenu.mediaCommand('play');&quot;/&gt;</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineplus">+    &lt;menuitem id=&quot;mailContext-media-pause&quot;</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+              label=&quot;&amp;contextPause.label;&quot;</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineplus">+              accesskey=&quot;&amp;contextPause.accesskey;&quot;</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineplus">+              oncommand=&quot;gContextMenu.mediaCommand('pause');&quot;/&gt;</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineplus">+    &lt;menuitem id=&quot;mailContext-media-mute&quot;</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineplus">+              label=&quot;&amp;contextMute.label;&quot;</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineplus">+              accesskey=&quot;&amp;contextMute.accesskey;&quot;</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineplus">+              oncommand=&quot;gContextMenu.mediaCommand('mute');&quot;/&gt;</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineplus">+    &lt;menuitem id=&quot;mailContext-media-unmute&quot;</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineplus">+              label=&quot;&amp;contextUnmute.label;&quot;</span>
<a href="#l19.26"></a><span id="l19.26" class="difflineplus">+              accesskey=&quot;&amp;contextUnmute.accesskey;&quot;</span>
<a href="#l19.27"></a><span id="l19.27" class="difflineplus">+              oncommand=&quot;gContextMenu.mediaCommand('unmute');&quot;/&gt;</span>
<a href="#l19.28"></a><span id="l19.28">     &lt;menuitem id=&quot;mailContext-openNewWindow&quot;</span>
<a href="#l19.29"></a><span id="l19.29">               label=&quot;&amp;contextOpenNewWindow.label;&quot;</span>
<a href="#l19.30"></a><span id="l19.30">               accesskey=&quot;&amp;contextOpenNewWindow.accesskey;&quot;</span>
<a href="#l19.31"></a><span id="l19.31">               oncommand=&quot;MsgOpenNewWindowForMessage();&quot;/&gt;</span>
<a href="#l19.32"></a><span id="l19.32">     &lt;menuitem id=&quot;threadPaneContext-openNewTab&quot;</span>
<a href="#l19.33"></a><span id="l19.33">               label=&quot;&amp;contextOpenNewTab.label;&quot;</span>
<a href="#l19.34"></a><span id="l19.34">               accesskey=&quot;&amp;contextOpenNewTab.accesskey;&quot;</span>
<a href="#l19.35"></a><span id="l19.35">               oncommand=&quot;OpenMessageInNewTab(event);&quot;/&gt;</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineat">@@ -1028,16 +1044,21 @@</span>
<a href="#l19.37"></a><span id="l19.37">             &lt;menuseparator id=&quot;viewMenuAfterPaneVerticalSeparator&quot;/&gt;</span>
<a href="#l19.38"></a><span id="l19.38">             &lt;menuitem id=&quot;menu_showMessage&quot; type=&quot;checkbox&quot; label=&quot;&amp;showMessageCmd.label;&quot; key=&quot;key_toggleMessagePane&quot;</span>
<a href="#l19.39"></a><span id="l19.39">                       accesskey=&quot;&amp;showMessageCmd.accesskey;&quot; oncommand=&quot;MsgToggleMessagePane();&quot;/&gt;</span>
<a href="#l19.40"></a><span id="l19.40">           &lt;/menupopup&gt;</span>
<a href="#l19.41"></a><span id="l19.41">         &lt;/menu&gt;</span>
<a href="#l19.42"></a><span id="l19.42">         &lt;menu id=&quot;menu_FolderViews&quot; label=&quot;&amp;folderView.label;&quot; accesskey=&quot;&amp;folderView.accesskey;&quot;&gt;</span>
<a href="#l19.43"></a><span id="l19.43">           &lt;menupopup id=&quot;menu_FolderViewsPopup&quot;</span>
<a href="#l19.44"></a><span id="l19.44">                      onpopupshowing=&quot;InitViewFolderViewsMenu(event)&quot;&gt;</span>
<a href="#l19.45"></a><span id="l19.45" class="difflineplus">+            &lt;menuitem id=&quot;menu_allFolders&quot; value=&quot;smart&quot;</span>
<a href="#l19.46"></a><span id="l19.46" class="difflineplus">+                      label=&quot;&amp;smartFolders.label;&quot;</span>
<a href="#l19.47"></a><span id="l19.47" class="difflineplus">+                      accesskey=&quot;&amp;smartFolders.accesskey;&quot;</span>
<a href="#l19.48"></a><span id="l19.48" class="difflineplus">+                      type=&quot;radio&quot; name=&quot;viewmessages&quot;</span>
<a href="#l19.49"></a><span id="l19.49" class="difflineplus">+                      oncommand=&quot;gFolderTreeView.mode = this.value;&quot;/&gt;</span>
<a href="#l19.50"></a><span id="l19.50">             &lt;menuitem id=&quot;menu_allFolders&quot; value=&quot;all&quot;</span>
<a href="#l19.51"></a><span id="l19.51">                       label=&quot;&amp;allFolders.label;&quot;</span>
<a href="#l19.52"></a><span id="l19.52">                       accesskey=&quot;&amp;allFolders.accesskey;&quot;</span>
<a href="#l19.53"></a><span id="l19.53">                       type=&quot;radio&quot; name=&quot;viewmessages&quot;</span>
<a href="#l19.54"></a><span id="l19.54">                       oncommand=&quot;gFolderTreeView.mode = this.value;&quot;/&gt;</span>
<a href="#l19.55"></a><span id="l19.55">             &lt;menuitem id=&quot;menu_unreadFolders&quot;</span>
<a href="#l19.56"></a><span id="l19.56">                       label=&quot;&amp;unreadFolders.label;&quot; value=&quot;unread&quot;</span>
<a href="#l19.57"></a><span id="l19.57">                       accesskey=&quot;&amp;unreadFolders.accesskey;&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mail/base/content/multimessageview.css</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mail/base/content/multimessageview.css</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -52,17 +52,16 @@</span>
<a href="#l20.4"></a><span id="l20.4">   background-repeat: no-repeat;</span>
<a href="#l20.5"></a><span id="l20.5"> }</span>
<a href="#l20.6"></a><span id="l20.6"> </span>
<a href="#l20.7"></a><span id="l20.7"> #content {</span>
<a href="#l20.8"></a><span id="l20.8">   position: absolute;</span>
<a href="#l20.9"></a><span id="l20.9">   top: 4em;</span>
<a href="#l20.10"></a><span id="l20.10">   right: 0;</span>
<a href="#l20.11"></a><span id="l20.11">   left: 0;</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-  padding: 1em;</span>
<a href="#l20.13"></a><span id="l20.13">   z-index: -1;</span>
<a href="#l20.14"></a><span id="l20.14">   padding: 1ex 1em;</span>
<a href="#l20.15"></a><span id="l20.15">   margin: 0px;</span>
<a href="#l20.16"></a><span id="l20.16">   font-size: small;</span>
<a href="#l20.17"></a><span id="l20.17"> }</span>
<a href="#l20.18"></a><span id="l20.18"> </span>
<a href="#l20.19"></a><span id="l20.19"> .row {</span>
<a href="#l20.20"></a><span id="l20.20">   position: relative;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mail/base/content/multimessageview.xhtml</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mail/base/content/multimessageview.xhtml</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -54,18 +54,31 @@</span>
<a href="#l21.4"></a><span id="l21.4">     &lt;head&gt;</span>
<a href="#l21.5"></a><span id="l21.5">         &lt;link rel=&quot;stylesheet&quot; media=&quot;screen&quot; type=&quot;text/css&quot;</span>
<a href="#l21.6"></a><span id="l21.6">               href=&quot;chrome://messenger/skin/messageHeader.css&quot;/&gt;</span>
<a href="#l21.7"></a><span id="l21.7">         &lt;link rel=&quot;stylesheet&quot; media=&quot;screen&quot; type=&quot;text/css&quot;</span>
<a href="#l21.8"></a><span id="l21.8">               href=&quot;chrome://messenger/skin/multimessageview.css&quot;/&gt;</span>
<a href="#l21.9"></a><span id="l21.9">         &lt;link rel=&quot;stylesheet&quot; media=&quot;screen&quot; type=&quot;text/css&quot;</span>
<a href="#l21.10"></a><span id="l21.10">               href=&quot;chrome://messenger/skin/tagColors.css&quot;/&gt;</span>
<a href="#l21.11"></a><span id="l21.11">         &lt;title&gt;&amp;window.title;&lt;/title&gt;</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+        &lt;script type=&quot;application/x-javascript;version=1.8&quot;&gt;&lt;![CDATA[</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+            function hookResize() {</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+              // we need to hook into the resize event on the header to make the #content</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineplus">+              // node shift down as it reflows.</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineplus">+              let content = document.getElementById('content');</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineplus">+              let heading = document.getElementById('heading');</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineplus">+              window.addEventListener('resize',</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineplus">+                function(e) {</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineplus">+                  content.style.top = heading.getBoundingClientRect().height + 'px';</span>
<a href="#l21.21"></a><span id="l21.21" class="difflineplus">+              }, false);</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineplus">+            }</span>
<a href="#l21.23"></a><span id="l21.23" class="difflineplus">+        ]]&gt;</span>
<a href="#l21.24"></a><span id="l21.24" class="difflineplus">+        &lt;/script&gt;</span>
<a href="#l21.25"></a><span id="l21.25">     &lt;/head&gt;</span>
<a href="#l21.26"></a><span id="l21.26" class="difflineminus">-&lt;body&gt;</span>
<a href="#l21.27"></a><span id="l21.27" class="difflineplus">+&lt;body onload=&quot;hookResize()&quot;&gt;</span>
<a href="#l21.28"></a><span id="l21.28">     &lt;div id=&quot;headingwrappertable&quot;&gt;</span>
<a href="#l21.29"></a><span id="l21.29">         &lt;div id=&quot;headingwrapper&quot;&gt;</span>
<a href="#l21.30"></a><span id="l21.30">             &lt;div id=&quot;buttonbox&quot;</span>
<a href="#l21.31"></a><span id="l21.31">                  xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l21.32"></a><span id="l21.32">                  xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l21.33"></a><span id="l21.33">                 &lt;hbox id=&quot;buttonhbox&quot; align=&quot;start&quot;&gt;</span>
<a href="#l21.34"></a><span id="l21.34">                     &lt;button id=&quot;archive&quot;</span>
<a href="#l21.35"></a><span id="l21.35">                             class=&quot;button msgHeaderView-button hdrArchiveButton&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mail/base/content/nsContextMenu.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mail/base/content/nsContextMenu.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -41,25 +41,28 @@</span>
<a href="#l22.4"></a><span id="l22.4"> # ***** END LICENSE BLOCK *****</span>
<a href="#l22.5"></a><span id="l22.5"> </span>
<a href="#l22.6"></a><span id="l22.6"> function nsContextMenu(aXulMenu) {</span>
<a href="#l22.7"></a><span id="l22.7">   this.target         = null;</span>
<a href="#l22.8"></a><span id="l22.8">   this.menu           = null;</span>
<a href="#l22.9"></a><span id="l22.9">   this.onTextInput    = false;</span>
<a href="#l22.10"></a><span id="l22.10">   this.onImage        = false;</span>
<a href="#l22.11"></a><span id="l22.11">   this.onLoadedImage  = false;</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineplus">+  this.onVideo        = false;</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+  this.onAudio        = false;</span>
<a href="#l22.14"></a><span id="l22.14">   this.onLink         = false;</span>
<a href="#l22.15"></a><span id="l22.15">   this.onMailtoLink   = false;</span>
<a href="#l22.16"></a><span id="l22.16">   this.onSaveableLink = false;</span>
<a href="#l22.17"></a><span id="l22.17">   this.onMetaDataItem = false;</span>
<a href="#l22.18"></a><span id="l22.18">   this.onMathML       = false;</span>
<a href="#l22.19"></a><span id="l22.19">   this.link           = false;</span>
<a href="#l22.20"></a><span id="l22.20">   this.linkURL        = &quot;&quot;;</span>
<a href="#l22.21"></a><span id="l22.21">   this.linkURI        = null;</span>
<a href="#l22.22"></a><span id="l22.22">   this.linkProtocol   = null;</span>
<a href="#l22.23"></a><span id="l22.23" class="difflineplus">+  this.mediaURL       = &quot;&quot;;</span>
<a href="#l22.24"></a><span id="l22.24">   this.inFrame        = false;</span>
<a href="#l22.25"></a><span id="l22.25">   this.hasBGImage     = false;</span>
<a href="#l22.26"></a><span id="l22.26">   this.isContentSelected = false;</span>
<a href="#l22.27"></a><span id="l22.27">   this.inDirList      = false;</span>
<a href="#l22.28"></a><span id="l22.28">   this.shouldDisplay  = true;</span>
<a href="#l22.29"></a><span id="l22.29"> </span>
<a href="#l22.30"></a><span id="l22.30">   this.initMenu(aXulMenu);</span>
<a href="#l22.31"></a><span id="l22.31"> }</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineat">@@ -77,16 +80,17 @@ nsContextMenu.prototype = {</span>
<a href="#l22.33"></a><span id="l22.33">     this.setTarget(document.popupNode);</span>
<a href="#l22.34"></a><span id="l22.34">     this.isContentSelected = this.isContentSelection();</span>
<a href="#l22.35"></a><span id="l22.35"> </span>
<a href="#l22.36"></a><span id="l22.36">     this.initItems();</span>
<a href="#l22.37"></a><span id="l22.37">   },</span>
<a href="#l22.38"></a><span id="l22.38">   initItems : function CM_initItems() {</span>
<a href="#l22.39"></a><span id="l22.39">     this.initSaveItems();</span>
<a href="#l22.40"></a><span id="l22.40">     this.initClipboardItems();</span>
<a href="#l22.41"></a><span id="l22.41" class="difflineplus">+    this.initMediaPlayerItems();</span>
<a href="#l22.42"></a><span id="l22.42">   },</span>
<a href="#l22.43"></a><span id="l22.43">   initSaveItems : function CM_initSaveItems() {</span>
<a href="#l22.44"></a><span id="l22.44">     this.showItem(&quot;mailContext-savelink&quot;, this.onSaveableLink);</span>
<a href="#l22.45"></a><span id="l22.45">     this.showItem(&quot;mailContext-saveimage&quot;, this.onLoadedImage);</span>
<a href="#l22.46"></a><span id="l22.46">   },</span>
<a href="#l22.47"></a><span id="l22.47">   initClipboardItems : function CM_initClipboardItems() {</span>
<a href="#l22.48"></a><span id="l22.48">     // Copy depends on whether there is selected text.</span>
<a href="#l22.49"></a><span id="l22.49">     // Enabling this context menu item is now done through the global</span>
<a href="#l22.50"></a><span id="l22.50" class="difflineat">@@ -95,16 +99,31 @@ nsContextMenu.prototype = {</span>
<a href="#l22.51"></a><span id="l22.51">     goUpdateGlobalEditMenuItems();</span>
<a href="#l22.52"></a><span id="l22.52"> </span>
<a href="#l22.53"></a><span id="l22.53">     this.showItem(&quot;mailContext-copy&quot;, this.isContentSelected || this.onTextInput);</span>
<a href="#l22.54"></a><span id="l22.54">     this.showItem(&quot;mailContext-selectall&quot;, true);</span>
<a href="#l22.55"></a><span id="l22.55">     this.showItem(&quot;mailContext-copyemail&quot;, this.onMailtoLink);</span>
<a href="#l22.56"></a><span id="l22.56">     this.showItem(&quot;mailContext-copylink&quot;, this.onLink);</span>
<a href="#l22.57"></a><span id="l22.57">     this.showItem(&quot;mailContext-copyimage&quot;, this.onImage);</span>
<a href="#l22.58"></a><span id="l22.58">   },</span>
<a href="#l22.59"></a><span id="l22.59" class="difflineplus">+  initMediaPlayerItems: function CM_initMediaPlayerItems() {</span>
<a href="#l22.60"></a><span id="l22.60" class="difflineplus">+    let onMedia = this.onVideo || this.onAudio;</span>
<a href="#l22.61"></a><span id="l22.61" class="difflineplus">+    // Several mutually exclusive items.... play/pause, mute/unmute, show/hide</span>
<a href="#l22.62"></a><span id="l22.62" class="difflineplus">+    this.showItem(&quot;mailContext-media-play&quot;, onMedia &amp;&amp; this.target.paused);</span>
<a href="#l22.63"></a><span id="l22.63" class="difflineplus">+    this.showItem(&quot;mailContext-media-pause&quot;, onMedia &amp;&amp; !this.target.paused);</span>
<a href="#l22.64"></a><span id="l22.64" class="difflineplus">+    this.showItem(&quot;mailContext-media-mute&quot;, onMedia &amp;&amp; !this.target.muted);</span>
<a href="#l22.65"></a><span id="l22.65" class="difflineplus">+    this.showItem(&quot;mailContext-media-unmute&quot;, onMedia &amp;&amp; this.target.muted);</span>
<a href="#l22.66"></a><span id="l22.66" class="difflineplus">+    if (onMedia) {</span>
<a href="#l22.67"></a><span id="l22.67" class="difflineplus">+      let hasError = this.target.error != null;</span>
<a href="#l22.68"></a><span id="l22.68" class="difflineplus">+      this.setItemAttr(&quot;mailContext-media-play&quot;, &quot;disabled&quot;, hasError);</span>
<a href="#l22.69"></a><span id="l22.69" class="difflineplus">+      this.setItemAttr(&quot;mailContext-media-pause&quot;, &quot;disabled&quot;, hasError);</span>
<a href="#l22.70"></a><span id="l22.70" class="difflineplus">+      this.setItemAttr(&quot;mailContext-media-mute&quot;, &quot;disabled&quot;, hasError);</span>
<a href="#l22.71"></a><span id="l22.71" class="difflineplus">+      this.setItemAttr(&quot;mailContext-media-unmute&quot;, &quot;disabled&quot;, hasError);</span>
<a href="#l22.72"></a><span id="l22.72" class="difflineplus">+    }</span>
<a href="#l22.73"></a><span id="l22.73" class="difflineplus">+  },</span>
<a href="#l22.74"></a><span id="l22.74"> </span>
<a href="#l22.75"></a><span id="l22.75">   /**</span>
<a href="#l22.76"></a><span id="l22.76">    * Set the nsContextMenu properties based on the selected node and</span>
<a href="#l22.77"></a><span id="l22.77">    * its ancestors.</span>
<a href="#l22.78"></a><span id="l22.78">    */</span>
<a href="#l22.79"></a><span id="l22.79">   setTarget : function CM_setTarget(aNode) {</span>
<a href="#l22.80"></a><span id="l22.80">     const xulNS =</span>
<a href="#l22.81"></a><span id="l22.81">       &quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;;</span>
<a href="#l22.82"></a><span id="l22.82" class="difflineat">@@ -113,16 +132,19 @@ nsContextMenu.prototype = {</span>
<a href="#l22.83"></a><span id="l22.83">       return;</span>
<a href="#l22.84"></a><span id="l22.84">     }</span>
<a href="#l22.85"></a><span id="l22.85">     this.onImage        = false;</span>
<a href="#l22.86"></a><span id="l22.86">     this.onLoadedImage  = false;</span>
<a href="#l22.87"></a><span id="l22.87">     this.onMetaDataItem = false;</span>
<a href="#l22.88"></a><span id="l22.88">     this.onTextInput    = false;</span>
<a href="#l22.89"></a><span id="l22.89">     this.imageURL       = &quot;&quot;;</span>
<a href="#l22.90"></a><span id="l22.90">     this.onLink         = false;</span>
<a href="#l22.91"></a><span id="l22.91" class="difflineplus">+    this.onVideo        = false;</span>
<a href="#l22.92"></a><span id="l22.92" class="difflineplus">+    this.onAudio        = false;</span>
<a href="#l22.93"></a><span id="l22.93" class="difflineplus">+    this.mediaURL       = &quot;&quot;;</span>
<a href="#l22.94"></a><span id="l22.94">     this.linkURL        = &quot;&quot;;</span>
<a href="#l22.95"></a><span id="l22.95">     this.linkURI        = null;</span>
<a href="#l22.96"></a><span id="l22.96">     this.linkProtocol   = null;</span>
<a href="#l22.97"></a><span id="l22.97">     this.onMathML       = false;</span>
<a href="#l22.98"></a><span id="l22.98">     this.inFrame        = false;</span>
<a href="#l22.99"></a><span id="l22.99">     this.hasBGImage     = false;</span>
<a href="#l22.100"></a><span id="l22.100">     this.bgImageURL     = &quot;&quot;;</span>
<a href="#l22.101"></a><span id="l22.101"> </span>
<a href="#l22.102"></a><span id="l22.102" class="difflineat">@@ -139,16 +161,22 @@ nsContextMenu.prototype = {</span>
<a href="#l22.103"></a><span id="l22.103">         if (request &amp;&amp; (request.imageStatus &amp; request.STATUS_SIZE_AVAILABLE))</span>
<a href="#l22.104"></a><span id="l22.104">           this.onLoadedImage = true;</span>
<a href="#l22.105"></a><span id="l22.105"> </span>
<a href="#l22.106"></a><span id="l22.106">         this.imageURL = this.target.currentURI.spec;</span>
<a href="#l22.107"></a><span id="l22.107">       } else if (this.target instanceof HTMLInputElement) {</span>
<a href="#l22.108"></a><span id="l22.108">         this.onTextInput = this.isTargetATextBox(this.target);</span>
<a href="#l22.109"></a><span id="l22.109">       } else if (this.target instanceof HTMLTextAreaElement) {</span>
<a href="#l22.110"></a><span id="l22.110">         this.onTextInput = true;</span>
<a href="#l22.111"></a><span id="l22.111" class="difflineplus">+      } else if (this.target instanceof HTMLVideoElement) {</span>
<a href="#l22.112"></a><span id="l22.112" class="difflineplus">+        this.onVideo = true;</span>
<a href="#l22.113"></a><span id="l22.113" class="difflineplus">+        this.mediaURL = this.target.currentSrc || this.target.src;</span>
<a href="#l22.114"></a><span id="l22.114" class="difflineplus">+      } else if (this.target instanceof HTMLAudioElement) {</span>
<a href="#l22.115"></a><span id="l22.115" class="difflineplus">+        this.onAudio = true;</span>
<a href="#l22.116"></a><span id="l22.116" class="difflineplus">+        this.mediaURL = this.target.currentSrc || this.target.src;</span>
<a href="#l22.117"></a><span id="l22.117">       } else if (this.target instanceof HTMLHtmlElement) {</span>
<a href="#l22.118"></a><span id="l22.118">         var bodyElt = this.target.ownerDocument.body;</span>
<a href="#l22.119"></a><span id="l22.119">         if (bodyElt) {</span>
<a href="#l22.120"></a><span id="l22.120">           var computedURL = this.getComputedURL(bodyElt, &quot;background-image&quot;);</span>
<a href="#l22.121"></a><span id="l22.121">           if (computedURL) {</span>
<a href="#l22.122"></a><span id="l22.122">             this.hasBGImage = true;</span>
<a href="#l22.123"></a><span id="l22.123">             this.bgImageURL = this.makeURLAbsolute(bodyElt.baseURI,</span>
<a href="#l22.124"></a><span id="l22.124">                                                    computedURL);</span>
<a href="#l22.125"></a><span id="l22.125" class="difflineat">@@ -524,10 +552,31 @@ nsContextMenu.prototype = {</span>
<a href="#l22.126"></a><span id="l22.126">       var sibling = separator.previousSibling;</span>
<a href="#l22.127"></a><span id="l22.127">       while (sibling &amp;&amp; sibling.localName != &quot;menuseparator&quot;) {</span>
<a href="#l22.128"></a><span id="l22.128">         if (sibling.getAttribute(&quot;hidden&quot;) != &quot;true&quot;)</span>
<a href="#l22.129"></a><span id="l22.129">           return true;</span>
<a href="#l22.130"></a><span id="l22.130">         sibling = sibling.previousSibling;</span>
<a href="#l22.131"></a><span id="l22.131">       }</span>
<a href="#l22.132"></a><span id="l22.132">     }</span>
<a href="#l22.133"></a><span id="l22.133">     return false;</span>
<a href="#l22.134"></a><span id="l22.134" class="difflineplus">+  },</span>
<a href="#l22.135"></a><span id="l22.135" class="difflineplus">+</span>
<a href="#l22.136"></a><span id="l22.136" class="difflineplus">+  mediaCommand : function CM_mediaCommand(command) {</span>
<a href="#l22.137"></a><span id="l22.137" class="difflineplus">+    var media = this.target;</span>
<a href="#l22.138"></a><span id="l22.138" class="difflineplus">+</span>
<a href="#l22.139"></a><span id="l22.139" class="difflineplus">+    switch (command) {</span>
<a href="#l22.140"></a><span id="l22.140" class="difflineplus">+      case &quot;play&quot;:</span>
<a href="#l22.141"></a><span id="l22.141" class="difflineplus">+        media.play();</span>
<a href="#l22.142"></a><span id="l22.142" class="difflineplus">+        break;</span>
<a href="#l22.143"></a><span id="l22.143" class="difflineplus">+      case &quot;pause&quot;:</span>
<a href="#l22.144"></a><span id="l22.144" class="difflineplus">+        media.pause();</span>
<a href="#l22.145"></a><span id="l22.145" class="difflineplus">+        break;</span>
<a href="#l22.146"></a><span id="l22.146" class="difflineplus">+      case &quot;mute&quot;:</span>
<a href="#l22.147"></a><span id="l22.147" class="difflineplus">+        media.muted = true;</span>
<a href="#l22.148"></a><span id="l22.148" class="difflineplus">+        break;</span>
<a href="#l22.149"></a><span id="l22.149" class="difflineplus">+      case &quot;unmute&quot;:</span>
<a href="#l22.150"></a><span id="l22.150" class="difflineplus">+        media.muted = false;</span>
<a href="#l22.151"></a><span id="l22.151" class="difflineplus">+        break;</span>
<a href="#l22.152"></a><span id="l22.152" class="difflineplus">+      // XXX hide controls &amp; show controls don't work in emails as Javascript is</span>
<a href="#l22.153"></a><span id="l22.153" class="difflineplus">+      // disabled. May want to consider later for RSS feeds.</span>
<a href="#l22.154"></a><span id="l22.154" class="difflineplus">+    }</span>
<a href="#l22.155"></a><span id="l22.155">   }</span>
<a href="#l22.156"></a><span id="l22.156"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mail/components/addrbook/content/abCommon.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mail/components/addrbook/content/abCommon.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -467,17 +467,17 @@ function DirPaneDoubleClick(event)</span>
<a href="#l23.4"></a><span id="l23.4"> </span>
<a href="#l23.5"></a><span id="l23.5">   if (dirTree &amp;&amp; dirTree.view.selection &amp;&amp; dirTree.view.selection.count == 1)</span>
<a href="#l23.6"></a><span id="l23.6">     AbEditSelectedDirectory();</span>
<a href="#l23.7"></a><span id="l23.7"> }</span>
<a href="#l23.8"></a><span id="l23.8"> </span>
<a href="#l23.9"></a><span id="l23.9"> function DirPaneSelectionChange()</span>
<a href="#l23.10"></a><span id="l23.10"> {</span>
<a href="#l23.11"></a><span id="l23.11">   // clear out the search box when changing folders...</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-  onClearSearch();</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+  onAbClearSearch();</span>
<a href="#l23.14"></a><span id="l23.14">   if (dirTree &amp;&amp; dirTree.view.selection &amp;&amp; dirTree.view.selection.count == 1) {</span>
<a href="#l23.15"></a><span id="l23.15">     gPreviousDirTreeIndex = dirTree.currentIndex;</span>
<a href="#l23.16"></a><span id="l23.16">     ChangeDirectoryByURI(GetSelectedDirectory());</span>
<a href="#l23.17"></a><span id="l23.17">   }</span>
<a href="#l23.18"></a><span id="l23.18">   goUpdateCommand('cmd_newlist');</span>
<a href="#l23.19"></a><span id="l23.19"> }</span>
<a href="#l23.20"></a><span id="l23.20"> </span>
<a href="#l23.21"></a><span id="l23.21"> function ChangeDirectoryByURI(uri)</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineat">@@ -622,64 +622,24 @@ function GetSelectedDirectory()</span>
<a href="#l23.23"></a><span id="l23.23"> }</span>
<a href="#l23.24"></a><span id="l23.24"> </span>
<a href="#l23.25"></a><span id="l23.25"> function onAbClearSearch()</span>
<a href="#l23.26"></a><span id="l23.26"> {</span>
<a href="#l23.27"></a><span id="l23.27">   gSearchInput.value = &quot;&quot;;</span>
<a href="#l23.28"></a><span id="l23.28">   onEnterInSearchBar();</span>
<a href="#l23.29"></a><span id="l23.29"> }</span>
<a href="#l23.30"></a><span id="l23.30"> </span>
<a href="#l23.31"></a><span id="l23.31" class="difflineminus">-function onSearchInputFocus(event)</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineminus">-{</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineminus">-  // search bar has focus, ...clear the showing search criteria flag</span>
<a href="#l23.34"></a><span id="l23.34" class="difflineminus">-  if (gSearchInput.showingSearchCriteria)</span>
<a href="#l23.35"></a><span id="l23.35" class="difflineminus">-  {</span>
<a href="#l23.36"></a><span id="l23.36" class="difflineminus">-    gSearchInput.value = &quot;&quot;;</span>
<a href="#l23.37"></a><span id="l23.37" class="difflineminus">-    gSearchInput.showingSearchCriteria = false;</span>
<a href="#l23.38"></a><span id="l23.38" class="difflineminus">-  }</span>
<a href="#l23.39"></a><span id="l23.39" class="difflineminus">-}</span>
<a href="#l23.40"></a><span id="l23.40" class="difflineminus">-</span>
<a href="#l23.41"></a><span id="l23.41"> // sets focus into the quick search box</span>
<a href="#l23.42"></a><span id="l23.42"> function QuickSearchFocus()</span>
<a href="#l23.43"></a><span id="l23.43"> {</span>
<a href="#l23.44"></a><span id="l23.44">   gSearchInput.focus();</span>
<a href="#l23.45"></a><span id="l23.45">   gSearchInput.select();</span>
<a href="#l23.46"></a><span id="l23.46"> }</span>
<a href="#l23.47"></a><span id="l23.47"> </span>
<a href="#l23.48"></a><span id="l23.48" class="difflineminus">-function onSearchInputBlur(event)</span>
<a href="#l23.49"></a><span id="l23.49" class="difflineminus">-{</span>
<a href="#l23.50"></a><span id="l23.50" class="difflineminus">-//  if (gQuickSearchFocusEl &amp;&amp; gQuickSearchFocusEl.id == 'searchInput') // ignore the blur if we are in the middle of processing the clear button</span>
<a href="#l23.51"></a><span id="l23.51" class="difflineminus">-//    return;</span>
<a href="#l23.52"></a><span id="l23.52" class="difflineminus">-</span>
<a href="#l23.53"></a><span id="l23.53" class="difflineminus">-  if (!gSearchInput.value)</span>
<a href="#l23.54"></a><span id="l23.54" class="difflineminus">-    gSearchInput.showingSearchCriteria = true;</span>
<a href="#l23.55"></a><span id="l23.55" class="difflineminus">-</span>
<a href="#l23.56"></a><span id="l23.56" class="difflineminus">-  if (gSearchInput.showingSearchCriteria)</span>
<a href="#l23.57"></a><span id="l23.57" class="difflineminus">-    gSearchInput.setSearchCriteriaText();</span>
<a href="#l23.58"></a><span id="l23.58" class="difflineminus">-}</span>
<a href="#l23.59"></a><span id="l23.59" class="difflineminus">-</span>
<a href="#l23.60"></a><span id="l23.60"> var gQuickSearchFocusEl = null;</span>
<a href="#l23.61"></a><span id="l23.61" class="difflineminus">-</span>
<a href="#l23.62"></a><span id="l23.62" class="difflineminus">-function onClearSearch()</span>
<a href="#l23.63"></a><span id="l23.63" class="difflineminus">-{</span>
<a href="#l23.64"></a><span id="l23.64" class="difflineminus">-  if (gSearchInput &amp;&amp; !gSearchInput.showingSearchCriteria) // ignore the text box value if it's just showing the search criteria string</span>
<a href="#l23.65"></a><span id="l23.65" class="difflineminus">-  {</span>
<a href="#l23.66"></a><span id="l23.66" class="difflineminus">-     onAbClearSearch();</span>
<a href="#l23.67"></a><span id="l23.67" class="difflineminus">-     // this needs to be on a timer otherwise we end up messing up the focus while the Search(&quot;&quot;) is still happening</span>
<a href="#l23.68"></a><span id="l23.68" class="difflineminus">-     setTimeout(restoreSearchFocusAfterClear, 0);</span>
<a href="#l23.69"></a><span id="l23.69" class="difflineminus">-  }</span>
<a href="#l23.70"></a><span id="l23.70" class="difflineminus">-}</span>
<a href="#l23.71"></a><span id="l23.71" class="difflineminus">-</span>
<a href="#l23.72"></a><span id="l23.72" class="difflineminus">-function restoreSearchFocusAfterClear()</span>
<a href="#l23.73"></a><span id="l23.73" class="difflineminus">-{</span>
<a href="#l23.74"></a><span id="l23.74" class="difflineminus">-//  gQuickSearchFocusEl.focus();</span>
<a href="#l23.75"></a><span id="l23.75" class="difflineminus">-  gSearchInput.clearButtonHidden = 'true';</span>
<a href="#l23.76"></a><span id="l23.76" class="difflineminus">-  gQuickSearchFocusEl = null;</span>
<a href="#l23.77"></a><span id="l23.77" class="difflineminus">-}</span>
<a href="#l23.78"></a><span id="l23.78" class="difflineminus">-</span>
<a href="#l23.79"></a><span id="l23.79"> var gIsOffline;</span>
<a href="#l23.80"></a><span id="l23.80"> var gSessionAdded;</span>
<a href="#l23.81"></a><span id="l23.81"> var gCurrentAutocompleteDirectory;</span>
<a href="#l23.82"></a><span id="l23.82"> var gAutocompleteSession;</span>
<a href="#l23.83"></a><span id="l23.83"> var gSetupLdapAutocomplete;</span>
<a href="#l23.84"></a><span id="l23.84"> var gLDAPSession;</span>
<a href="#l23.85"></a><span id="l23.85"> </span>
<a href="#l23.86"></a><span id="l23.86"> function setupLdapAutocompleteSession()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mail/components/addrbook/content/abContactsPanel.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mail/components/addrbook/content/abContactsPanel.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -86,17 +86,17 @@ function AddressBookMenuListChange()</span>
<a href="#l24.4"></a><span id="l24.4">     onEnterInSearchBar();</span>
<a href="#l24.5"></a><span id="l24.5">   else </span>
<a href="#l24.6"></a><span id="l24.6">     ChangeDirectoryByURI(document.getElementById('addressbookList').value);</span>
<a href="#l24.7"></a><span id="l24.7"> }</span>
<a href="#l24.8"></a><span id="l24.8"> </span>
<a href="#l24.9"></a><span id="l24.9"> function AbPanelOnComposerClose()</span>
<a href="#l24.10"></a><span id="l24.10"> {</span>
<a href="#l24.11"></a><span id="l24.11">   CloseAbView();</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-  onClearSearch();</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+  onAbClearSearch();</span>
<a href="#l24.14"></a><span id="l24.14"> }</span>
<a href="#l24.15"></a><span id="l24.15"> </span>
<a href="#l24.16"></a><span id="l24.16"> function AbPanelOnComposerReOpen()</span>
<a href="#l24.17"></a><span id="l24.17"> {</span>
<a href="#l24.18"></a><span id="l24.18">   SetAbView(GetSelectedDirectory());</span>
<a href="#l24.19"></a><span id="l24.19"> }</span>
<a href="#l24.20"></a><span id="l24.20"> </span>
<a href="#l24.21"></a><span id="l24.21"> function AbPanelLoad() </span>
<a href="#l24.22"></a><span id="l24.22" class="difflineat">@@ -114,17 +114,17 @@ function AbPanelLoad()</span>
<a href="#l24.23"></a><span id="l24.23">   abPopup.value = temp;</span>
<a href="#l24.24"></a><span id="l24.24">   if (!abPopup.selectedItem)</span>
<a href="#l24.25"></a><span id="l24.25">     abPopup.selectedIndex = 0;</span>
<a href="#l24.26"></a><span id="l24.26"> </span>
<a href="#l24.27"></a><span id="l24.27">   ChangeDirectoryByURI(abPopup.value);</span>
<a href="#l24.28"></a><span id="l24.28"> </span>
<a href="#l24.29"></a><span id="l24.29">   parent.addEventListener(&quot;compose-window-close&quot;, AbPanelOnComposerClose, true);</span>
<a href="#l24.30"></a><span id="l24.30">   parent.addEventListener(&quot;compose-window-reopen&quot;, AbPanelOnComposerReOpen, true);</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineminus">-  gSearchInput = document.getElementById(&quot;searchInput&quot;);</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineplus">+  gSearchInput = document.getElementById(&quot;peopleSearchInput&quot;);</span>
<a href="#l24.33"></a><span id="l24.33"> }</span>
<a href="#l24.34"></a><span id="l24.34"> </span>
<a href="#l24.35"></a><span id="l24.35"> function AbPanelUnload()</span>
<a href="#l24.36"></a><span id="l24.36"> {</span>
<a href="#l24.37"></a><span id="l24.37">   parent.removeEventListener(&quot;compose-window-close&quot;, AbPanelOnComposerClose, true);</span>
<a href="#l24.38"></a><span id="l24.38">   parent.removeEventListener(&quot;compose-window-reopen&quot;, AbPanelOnComposerReOpen, true);</span>
<a href="#l24.39"></a><span id="l24.39"> </span>
<a href="#l24.40"></a><span id="l24.40">   CloseAbView();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mail/components/addrbook/content/abContactsPanel.xul</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mail/components/addrbook/content/abContactsPanel.xul</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -88,27 +88,21 @@</span>
<a href="#l25.4"></a><span id="l25.4">                 persist=&quot;value&quot;&gt;</span>
<a href="#l25.5"></a><span id="l25.5">         &lt;menupopup id=&quot;addressbookList-menupopup&quot; class=&quot;addrbooksPopup&quot;/&gt;</span>
<a href="#l25.6"></a><span id="l25.6">       &lt;/menulist&gt;</span>
<a href="#l25.7"></a><span id="l25.7">     &lt;/hbox&gt;</span>
<a href="#l25.8"></a><span id="l25.8"> </span>
<a href="#l25.9"></a><span id="l25.9">     &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l25.10"></a><span id="l25.10"> </span>
<a href="#l25.11"></a><span id="l25.11">     &lt;vbox&gt;</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-      &lt;label value=&quot;&amp;searchInput.label;&quot; accesskey=&quot;&amp;searchInput.accesskey;&quot; control=&quot;searchInput&quot;/&gt;</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">-      &lt;textbox id=&quot;searchInput&quot; flex=&quot;1&quot; type=&quot;timed&quot; timeout=&quot;800&quot;</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineminus">-               onfocus=&quot;onSearchInputFocus(event);&quot;</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineminus">-               onblur=&quot;onSearchInputBlur(event);&quot; clickSelectsAll=&quot;true&quot;</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineminus">-               oncommand=&quot;onEnterInSearchBar();&quot; chromedir=&quot;&amp;locale.dir;&quot;&gt;</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineminus">-        &lt;button id=&quot;quick-search-button&quot; type=&quot;menu&quot; chromedir=&quot;&amp;locale.dir;&quot;&gt;</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineminus">-          &lt;menupopup id=&quot;quick-search-menupopup&quot; value=&quot;0&quot; persist=&quot;value&quot; popupalign=&quot;topleft&quot; popupanchor=&quot;bottomleft&quot;&gt;</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineminus">-            &lt;menuitem value=&quot;0&quot; label=&quot;&amp;SearchNameOrEmail.label;&quot; type=&quot;radio&quot;/&gt;</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineminus">-          &lt;/menupopup&gt;</span>
<a href="#l25.21"></a><span id="l25.21" class="difflineminus">-        &lt;/button&gt;</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineminus">-      &lt;/textbox&gt;</span>
<a href="#l25.23"></a><span id="l25.23" class="difflineplus">+      &lt;label value=&quot;&amp;searchInput.label;&quot; accesskey=&quot;&amp;searchInput.accesskey;&quot;</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineplus">+             control=&quot;peopleSearchInput&quot;/&gt;</span>
<a href="#l25.25"></a><span id="l25.25" class="difflineplus">+      &lt;textbox id=&quot;peopleSearchInput&quot; flex=&quot;1&quot; type=&quot;search&quot; timeout=&quot;800&quot;</span>
<a href="#l25.26"></a><span id="l25.26" class="difflineplus">+               emptytext=&quot;&amp;SearchNameOrEmail.label;&quot; clickSelectsAll=&quot;true&quot;</span>
<a href="#l25.27"></a><span id="l25.27" class="difflineplus">+               oncommand=&quot;onEnterInSearchBar();&quot; chromedir=&quot;&amp;locale.dir;&quot;/&gt;</span>
<a href="#l25.28"></a><span id="l25.28">     &lt;/vbox&gt;</span>
<a href="#l25.29"></a><span id="l25.29"> </span>
<a href="#l25.30"></a><span id="l25.30">     &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l25.31"></a><span id="l25.31"> </span>
<a href="#l25.32"></a><span id="l25.32">     &lt;tree id=&quot;abResultsTree&quot; flex=&quot;1&quot; context=&quot;cardProperties&quot; class=&quot;plain&quot; sortCol=&quot;GeneratedName&quot; persist=&quot;sortCol&quot;</span>
<a href="#l25.33"></a><span id="l25.33">           onclick=&quot;contactsListOnClick(event);&quot;&gt;</span>
<a href="#l25.34"></a><span id="l25.34">       &lt;treecols&gt;</span>
<a href="#l25.35"></a><span id="l25.35">         &lt;!-- these column ids must match up to the mork column names, see nsIAddrDatabase.idl --&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mail/components/addrbook/content/addressbook.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mail/components/addrbook/content/addressbook.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -165,17 +165,17 @@ function OnLoadAddressBook()</span>
<a href="#l26.4"></a><span id="l26.4">     document.documentElement.setAttribute(&quot;screenX&quot;, screen.availLeft);</span>
<a href="#l26.5"></a><span id="l26.5">     document.documentElement.setAttribute(&quot;screenY&quot;, screen.availTop);</span>
<a href="#l26.6"></a><span id="l26.6">   }</span>
<a href="#l26.7"></a><span id="l26.7">   setTimeout(delayedOnLoadAddressBook, 0); // when debugging, set this to 5000, so you can see what happens after the window comes up.</span>
<a href="#l26.8"></a><span id="l26.8"> }</span>
<a href="#l26.9"></a><span id="l26.9"> </span>
<a href="#l26.10"></a><span id="l26.10"> function delayedOnLoadAddressBook()</span>
<a href="#l26.11"></a><span id="l26.11"> {</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-  gSearchInput = document.getElementById(&quot;searchInput&quot;);</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+  gSearchInput = document.getElementById(&quot;peopleSearchInput&quot;);</span>
<a href="#l26.14"></a><span id="l26.14"> </span>
<a href="#l26.15"></a><span id="l26.15">   verifyAccounts(null, false);   // this will do migration, if we need to.</span>
<a href="#l26.16"></a><span id="l26.16"> </span>
<a href="#l26.17"></a><span id="l26.17">   InitCommonJS();</span>
<a href="#l26.18"></a><span id="l26.18"> </span>
<a href="#l26.19"></a><span id="l26.19">   GetCurrentPrefs();</span>
<a href="#l26.20"></a><span id="l26.20"> </span>
<a href="#l26.21"></a><span id="l26.21">   // FIX ME - later we will be able to use onload from the overlay</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mail/components/addrbook/content/addressbook.xul</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mail/components/addrbook/content/addressbook.xul</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -559,27 +559,21 @@</span>
<a href="#l27.4"></a><span id="l27.4">       &lt;toolbarbutton class=&quot;toolbarbutton-1&quot; id=&quot;button-newmessage&quot; label=&quot;&amp;newmsgButton.label;&quot; tooltiptext=&quot;&amp;newmsgButton.tooltip;&quot; oncommand=&quot;AbNewMessage();&quot;/&gt;</span>
<a href="#l27.5"></a><span id="l27.5">       &lt;toolbarbutton class=&quot;toolbarbutton-1&quot; id=&quot;button-newim&quot; label=&quot;&amp;newIM.label;&quot; tooltiptext=&quot;&amp;newIM.tooltip;&quot; oncommand=&quot;AbIMSelected();&quot;/&gt;</span>
<a href="#l27.6"></a><span id="l27.6">       &lt;toolbarbutton class=&quot;toolbarbutton-1&quot; id=&quot;button-abdelete&quot;</span>
<a href="#l27.7"></a><span id="l27.7">                      observes=&quot;button_delete&quot; label=&quot;&amp;deleteButton2.label;&quot;</span>
<a href="#l27.8"></a><span id="l27.8">                      tooltiptext=&quot;&amp;deleteButton2.tooltip;&quot;</span>
<a href="#l27.9"></a><span id="l27.9">                      oncommand=&quot;goDoCommand('button_delete');&quot;/&gt;</span>
<a href="#l27.10"></a><span id="l27.10"> </span>
<a href="#l27.11"></a><span id="l27.11">       &lt;toolbaritem id=&quot;search-container&quot; title=&quot;&amp;searchItem.title;&quot; align=&quot;center&quot; class=&quot;chromeclass-toolbar-additional&quot;&gt;</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-        &lt;textbox id=&quot;searchInput&quot; flex=&quot;1&quot; timeout=&quot;800&quot;</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineminus">-                 onfocus=&quot;onSearchInputFocus(event);&quot;</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineminus">-                 onblur=&quot;onSearchInputBlur(event);&quot;</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineminus">-                 clickSelectsAll=&quot;true&quot; oncommand=&quot;onEnterInSearchBar();&quot;</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineminus">-                 chromedir=&quot;&amp;locale.dir;&quot;&gt;</span>
<a href="#l27.17"></a><span id="l27.17" class="difflineminus">-          &lt;button id=&quot;quick-search-button&quot; type=&quot;menu&quot; chromedir=&quot;&amp;locale.dir;&quot;&gt;</span>
<a href="#l27.18"></a><span id="l27.18" class="difflineminus">-            &lt;menupopup id=&quot;quick-search-menupopup&quot; value=&quot;0&quot; persist=&quot;value&quot; popupalign=&quot;topleft&quot; popupanchor=&quot;bottomleft&quot;&gt;</span>
<a href="#l27.19"></a><span id="l27.19" class="difflineminus">-              &lt;menuitem value=&quot;0&quot; label=&quot;&amp;SearchNameOrEmail.label;&quot; type=&quot;radio&quot;/&gt;</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineminus">-            &lt;/menupopup&gt;</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineminus">-          &lt;/button&gt;</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineminus">-        &lt;/textbox&gt;</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineplus">+        &lt;textbox id=&quot;peopleSearchInput&quot; flex=&quot;1&quot; timeout=&quot;800&quot;</span>
<a href="#l27.24"></a><span id="l27.24" class="difflineplus">+                 type=&quot;search&quot;</span>
<a href="#l27.25"></a><span id="l27.25" class="difflineplus">+                 emptytext=&quot;&amp;SearchNameOrEmail.label;&quot;</span>
<a href="#l27.26"></a><span id="l27.26" class="difflineplus">+                 oncommand=&quot;onEnterInSearchBar();&quot;</span>
<a href="#l27.27"></a><span id="l27.27" class="difflineplus">+                 chromedir=&quot;&amp;locale.dir;&quot;/&gt;</span>
<a href="#l27.28"></a><span id="l27.28">       &lt;/toolbaritem&gt;     </span>
<a href="#l27.29"></a><span id="l27.29">   &lt;/toolbarpalette&gt;</span>
<a href="#l27.30"></a><span id="l27.30">   &lt;!-- toolbar --&gt;</span>
<a href="#l27.31"></a><span id="l27.31">   &lt;toolbar id=&quot;ab-bar2&quot; class=&quot;toolbar-primary chromeclass-toolbar&quot;</span>
<a href="#l27.32"></a><span id="l27.32">            toolbarname=&quot;&amp;showAbToolbarCmd.label;&quot;</span>
<a href="#l27.33"></a><span id="l27.33">            accesskey=&quot;&amp;showAbToolbarCmd.accesskey;&quot;</span>
<a href="#l27.34"></a><span id="l27.34">            fullscreentoolbar=&quot;true&quot; mode=&quot;full&quot;</span>
<a href="#l27.35"></a><span id="l27.35">            customizable=&quot;true&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/SearchDialog.dtd</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/SearchDialog.dtd</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1,15 +1,15 @@</span>
<a href="#l28.4"></a><span id="l28.4"> &lt;!-- for SearchDialog.xul --&gt;</span>
<a href="#l28.5"></a><span id="l28.5"> &lt;!ENTITY searchHeading.label         &quot;Search for messages in:&quot;&gt;</span>
<a href="#l28.6"></a><span id="l28.6"> &lt;!ENTITY searchHeading.accesskey     &quot;h&quot;&gt;</span>
<a href="#l28.7"></a><span id="l28.7"> &lt;!ENTITY searchSubfolders.label      &quot;Search subfolders&quot;&gt;</span>
<a href="#l28.8"></a><span id="l28.8"> &lt;!ENTITY searchSubfolders.accesskey  &quot;e&quot;&gt;</span>
<a href="#l28.9"></a><span id="l28.9" class="difflineminus">-&lt;!ENTITY searchOnline.label          &quot;Search online&quot;&gt;</span>
<a href="#l28.10"></a><span id="l28.10" class="difflineminus">-&lt;!ENTITY searchOnline.accesskey      &quot;l&quot;&gt;</span>
<a href="#l28.11"></a><span id="l28.11" class="difflineplus">+&lt;!ENTITY searchOnServer.label        &quot;Run search on server&quot;&gt;</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineplus">+&lt;!ENTITY searchOnServer.accesskey    &quot;u&quot;&gt;</span>
<a href="#l28.13"></a><span id="l28.13"> &lt;!ENTITY resetButton.label           &quot;Clear&quot;&gt;</span>
<a href="#l28.14"></a><span id="l28.14"> &lt;!ENTITY resetButton.accesskey       &quot;C&quot;&gt;</span>
<a href="#l28.15"></a><span id="l28.15"> &lt;!ENTITY openButton.label            &quot;Open&quot;&gt;</span>
<a href="#l28.16"></a><span id="l28.16"> &lt;!ENTITY openButton.accesskey        &quot;n&quot;&gt;</span>
<a href="#l28.17"></a><span id="l28.17"> &lt;!ENTITY deleteButton.label          &quot;Delete&quot;&gt;</span>
<a href="#l28.18"></a><span id="l28.18"> &lt;!ENTITY deleteButton.accesskey      &quot;D&quot;&gt;</span>
<a href="#l28.19"></a><span id="l28.19"> &lt;!ENTITY searchDialogTitle.label     &quot;Search Messages&quot;&gt;</span>
<a href="#l28.20"></a><span id="l28.20"> &lt;!ENTITY results.label               &quot;Results&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/am-offline.dtd</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/am-offline.dtd</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -27,8 +27,23 @@</span>
<a href="#l29.4"></a><span id="l29.4"> &lt;!ENTITY nntpRemoveMsgBody.label &quot;Remove bodies from messages more than&quot;&gt;</span>
<a href="#l29.5"></a><span id="l29.5"> &lt;!ENTITY nntpRemoveMsgBody.accesskey &quot;o&quot;&gt;</span>
<a href="#l29.6"></a><span id="l29.6"> &lt;!ENTITY offlineSelectNntp.label &quot;Select newsgroups for offline use&quot;&gt;</span>
<a href="#l29.7"></a><span id="l29.7"> &lt;!ENTITY offlineSelectNntp.accesskey &quot;S&quot;&gt;</span>
<a href="#l29.8"></a><span id="l29.8"> &lt;!ENTITY offlineImapAdvancedOffline.label &quot;Advanced&quot;&gt;</span>
<a href="#l29.9"></a><span id="l29.9"> &lt;!ENTITY offlineImapAdvancedOffline.accesskey &quot;v&quot;&gt;</span>
<a href="#l29.10"></a><span id="l29.10"> &lt;!ENTITY syncGroupTitle.label &quot;Message Synchronizing&quot;&gt;</span>
<a href="#l29.11"></a><span id="l29.11"> &lt;!ENTITY diskspaceGroupTitle.label &quot;Disk Space&quot;&gt;</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineplus">+</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+&lt;!-- LOCALIZATION NOTE: (useAutosyncBefore.label, useAutosyncMiddle.label, useAutosyncAfter.label):</span>
<a href="#l29.14"></a><span id="l29.14" class="difflineplus">+  The entities useAutosyncBefore.label, useAutosyncMiddle.label, and</span>
<a href="#l29.15"></a><span id="l29.15" class="difflineplus">+  useAutosyncAfter.label appear on a single line in preferences as follows:</span>
<a href="#l29.16"></a><span id="l29.16" class="difflineplus">+</span>
<a href="#l29.17"></a><span id="l29.17" class="difflineplus">+  &amp;useAutosyncBefore.label [textbox for autosync value] &amp;useAutosyncMiddle.label; [dropdown for autosync interval] &amp;useAutosyncAfter.label;</span>
<a href="#l29.18"></a><span id="l29.18" class="difflineplus">+--&gt;</span>
<a href="#l29.19"></a><span id="l29.19" class="difflineplus">+&lt;!ENTITY useAutosyncBefore.label         &quot;&quot;&gt;</span>
<a href="#l29.20"></a><span id="l29.20" class="difflineplus">+&lt;!ENTITY useAutosyncMiddle.label         &quot;&quot;&gt;</span>
<a href="#l29.21"></a><span id="l29.21" class="difflineplus">+&lt;!ENTITY allInterval.label               &quot;All&quot;&gt;</span>
<a href="#l29.22"></a><span id="l29.22" class="difflineplus">+&lt;!ENTITY dayInterval.label               &quot;Days of&quot;&gt;</span>
<a href="#l29.23"></a><span id="l29.23" class="difflineplus">+&lt;!ENTITY weekInterval.label              &quot;Weeks of&quot;&gt;</span>
<a href="#l29.24"></a><span id="l29.24" class="difflineplus">+&lt;!ENTITY monthInterval.label             &quot;Months of&quot;&gt;</span>
<a href="#l29.25"></a><span id="l29.25" class="difflineplus">+&lt;!ENTITY yearInterval.label              &quot;Years of&quot;&gt;</span>
<a href="#l29.26"></a><span id="l29.26" class="difflineplus">+&lt;!ENTITY useAutosyncAfter.label          &quot;email will be stored on disk&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -125,16 +125,18 @@</span>
<a href="#l30.4"></a><span id="l30.4"> &lt;!ENTITY messagePaneWide.accesskey &quot;W&quot;&gt;</span>
<a href="#l30.5"></a><span id="l30.5"> &lt;!ENTITY messagePaneVertical.label &quot;Vertical View&quot;&gt;</span>
<a href="#l30.6"></a><span id="l30.6"> &lt;!ENTITY messagePaneVertical.accesskey &quot;V&quot;&gt;</span>
<a href="#l30.7"></a><span id="l30.7"> &lt;!ENTITY showMessageCmd.label &quot;Message Pane&quot;&gt;</span>
<a href="#l30.8"></a><span id="l30.8"> &lt;!ENTITY showMessageCmd.accesskey &quot;M&quot;&gt;</span>
<a href="#l30.9"></a><span id="l30.9"> </span>
<a href="#l30.10"></a><span id="l30.10"> &lt;!ENTITY folderView.label &quot;Folders&quot;&gt;</span>
<a href="#l30.11"></a><span id="l30.11"> &lt;!ENTITY folderView.accesskey &quot;F&quot;&gt;</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineplus">+&lt;!ENTITY smartFolders.label &quot;Smart&quot;&gt;</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+&lt;!ENTITY smartFolders.accesskey &quot;S&quot;&gt;</span>
<a href="#l30.14"></a><span id="l30.14"> &lt;!ENTITY allFolders.label &quot;All&quot;&gt;</span>
<a href="#l30.15"></a><span id="l30.15"> &lt;!ENTITY allFolders.accesskey &quot;A&quot;&gt;</span>
<a href="#l30.16"></a><span id="l30.16"> &lt;!ENTITY unreadFolders.label &quot;Unread&quot;&gt;</span>
<a href="#l30.17"></a><span id="l30.17"> &lt;!ENTITY unreadFolders.accesskey &quot;U&quot;&gt;</span>
<a href="#l30.18"></a><span id="l30.18"> &lt;!ENTITY favoriteFolders.label &quot;Favorite&quot;&gt;</span>
<a href="#l30.19"></a><span id="l30.19"> &lt;!ENTITY favoriteFolders.accesskey &quot;F&quot;&gt;</span>
<a href="#l30.20"></a><span id="l30.20"> &lt;!ENTITY recentFolders.label &quot;Recent&quot;&gt;</span>
<a href="#l30.21"></a><span id="l30.21"> &lt;!ENTITY recentFolders.accesskey &quot;R&quot;&gt;</span>
<a href="#l30.22"></a><span id="l30.22" class="difflineat">@@ -679,16 +681,26 @@ you can use these alternative items. Oth</span>
<a href="#l30.23"></a><span id="l30.23"> &lt;!ENTITY contextCopyMsgMenu.accesskey &quot;C&quot;&gt;</span>
<a href="#l30.24"></a><span id="l30.24"> &lt;!ENTITY contextSaveAs.label &quot;Save As&quot;&gt;</span>
<a href="#l30.25"></a><span id="l30.25"> &lt;!ENTITY contextSaveAs.accesskey &quot;S&quot;&gt;</span>
<a href="#l30.26"></a><span id="l30.26"> &lt;!ENTITY contextPrint.label &quot;Print&quot;&gt;</span>
<a href="#l30.27"></a><span id="l30.27"> &lt;!ENTITY contextPrint.accesskey &quot;P&quot;&gt;</span>
<a href="#l30.28"></a><span id="l30.28"> &lt;!ENTITY contextPrintPreview.label &quot;Print Preview&quot;&gt;</span>
<a href="#l30.29"></a><span id="l30.29"> &lt;!ENTITY contextPrintPreview.accesskey &quot;v&quot;&gt;</span>
<a href="#l30.30"></a><span id="l30.30"> </span>
<a href="#l30.31"></a><span id="l30.31" class="difflineplus">+&lt;!-- Media (video/audio) controls --&gt;</span>
<a href="#l30.32"></a><span id="l30.32" class="difflineplus">+&lt;!ENTITY contextPlay.label &quot;Play&quot;&gt;</span>
<a href="#l30.33"></a><span id="l30.33" class="difflineplus">+&lt;!ENTITY contextPlay.accesskey &quot;P&quot;&gt;</span>
<a href="#l30.34"></a><span id="l30.34" class="difflineplus">+&lt;!ENTITY contextPause.label &quot;Pause&quot;&gt;</span>
<a href="#l30.35"></a><span id="l30.35" class="difflineplus">+&lt;!ENTITY contextPause.accesskey &quot;P&quot;&gt;</span>
<a href="#l30.36"></a><span id="l30.36" class="difflineplus">+&lt;!ENTITY contextMute.label &quot;Mute&quot;&gt;</span>
<a href="#l30.37"></a><span id="l30.37" class="difflineplus">+&lt;!ENTITY contextMute.accesskey &quot;M&quot;&gt;</span>
<a href="#l30.38"></a><span id="l30.38" class="difflineplus">+&lt;!ENTITY contextUnmute.label &quot;Unmute&quot;&gt;</span>
<a href="#l30.39"></a><span id="l30.39" class="difflineplus">+&lt;!ENTITY contextUnmute.accesskey &quot;m&quot;&gt;</span>
<a href="#l30.40"></a><span id="l30.40" class="difflineplus">+</span>
<a href="#l30.41"></a><span id="l30.41"> &lt;!-- Junk Bar --&gt;</span>
<a href="#l30.42"></a><span id="l30.42"> &lt;!ENTITY junkBarMessage1.label &quot;Junk Mail&quot;&gt;</span>
<a href="#l30.43"></a><span id="l30.43"> &lt;!ENTITY junkBarButton1.label &quot;Not Junk&quot;&gt;</span>
<a href="#l30.44"></a><span id="l30.44"> &lt;!ENTITY junkInfoButton.label &quot;?&quot;&gt;</span>
<a href="#l30.45"></a><span id="l30.45"> </span>
<a href="#l30.46"></a><span id="l30.46"> &lt;!-- Remote Content Bar --&gt;</span>
<a href="#l30.47"></a><span id="l30.47"> &lt;!ENTITY remoteContentMessage2.label &quot;To protect your privacy, &amp;brandShortName; has blocked remote content in this message.&quot;&gt;</span>
<a href="#l30.48"></a><span id="l30.48"> &lt;!ENTITY loadRemoteContentButton3.label &quot;Show Remote Content&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-selection.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-selection.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -150,8 +150,23 @@ function test_enter_scroll_to_new() {</span>
<a href="#l31.4"></a><span id="l31.4">   enter_folder(folder.rootFolder);</span>
<a href="#l31.5"></a><span id="l31.5">   // add a new message, and make sure it is new</span>
<a href="#l31.6"></a><span id="l31.6">   let newSet = make_new_sets_in_folder(folder, [{count: 1}]);</span>
<a href="#l31.7"></a><span id="l31.7">   // enter the folder</span>
<a href="#l31.8"></a><span id="l31.8">   enter_folder(folder);</span>
<a href="#l31.9"></a><span id="l31.9">   // make sure it (which must be the last row) is visible</span>
<a href="#l31.10"></a><span id="l31.10">   assert_visible(-1);</span>
<a href="#l31.11"></a><span id="l31.11"> }</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineplus">+</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+/**</span>
<a href="#l31.14"></a><span id="l31.14" class="difflineplus">+ * Test that the last selected message persists through folder changes.</span>
<a href="#l31.15"></a><span id="l31.15" class="difflineplus">+ */</span>
<a href="#l31.16"></a><span id="l31.16" class="difflineplus">+function test_selection_persists_through_folder_changes() {</span>
<a href="#l31.17"></a><span id="l31.17" class="difflineplus">+  // be in the folder</span>
<a href="#l31.18"></a><span id="l31.18" class="difflineplus">+  be_in_folder(folder);</span>
<a href="#l31.19"></a><span id="l31.19" class="difflineplus">+  // select a message</span>
<a href="#l31.20"></a><span id="l31.20" class="difflineplus">+  select_click_row(3);</span>
<a href="#l31.21"></a><span id="l31.21" class="difflineplus">+  // leave and re-enter the folder</span>
<a href="#l31.22"></a><span id="l31.22" class="difflineplus">+  enter_folder(folder.rootFolder);</span>
<a href="#l31.23"></a><span id="l31.23" class="difflineplus">+  enter_folder(folder);</span>
<a href="#l31.24"></a><span id="l31.24" class="difflineplus">+  // make sure it is selected and displayed</span>
<a href="#l31.25"></a><span id="l31.25" class="difflineplus">+  assert_selected_and_displayed(3);</span>
<a href="#l31.26"></a><span id="l31.26" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mail/themes/gnomestripe/mail/accountCentral.css</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mail/themes/gnomestripe/mail/accountCentral.css</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -65,17 +65,17 @@ separator.thin {</span>
<a href="#l32.4"></a><span id="l32.4">   font-size: 180%;</span>
<a href="#l32.5"></a><span id="l32.5">   font-weight: bold;</span>
<a href="#l32.6"></a><span id="l32.6">   color: #000000;</span>
<a href="#l32.7"></a><span id="l32.7"> }</span>
<a href="#l32.8"></a><span id="l32.8"> </span>
<a href="#l32.9"></a><span id="l32.9"> .acctCentralRow {</span>
<a href="#l32.10"></a><span id="l32.10">   -moz-margin-start: 10px;</span>
<a href="#l32.11"></a><span id="l32.11">   font-size: 125%;</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-  color: #000000;</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+  color: Highlight;</span>
<a href="#l32.14"></a><span id="l32.14"> }</span>
<a href="#l32.15"></a><span id="l32.15"> </span>
<a href="#l32.16"></a><span id="l32.16"> .row-iconic-icon {</span>
<a href="#l32.17"></a><span id="l32.17">   list-style-image: inherit;</span>
<a href="#l32.18"></a><span id="l32.18">   -moz-margin-end: 10px;</span>
<a href="#l32.19"></a><span id="l32.19"> }</span>
<a href="#l32.20"></a><span id="l32.20"> </span>
<a href="#l32.21"></a><span id="l32.21"> .acctCentralRowTitleBox {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1">index aa1f1f87de01c70755dfa72ed9566ae646efdf14..655177b23edefb92fe3508bb18437a91c7c561db</span>
<a href="#l33.2"></a><span id="l33.2">GIT binary patch
literal 1677
zc$@)^26Fj{P)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H11`0_;K~zYIja6-IQ`Z@O&amp;bc4&lt;y@`Vp=fk0xuxU0~2yKuer2Qxz
z-J}G9D#1j$t!cFnX+O3hCJ`s&gt;Pr+#lBeu0ps`jTUL)!{kR;iWRHCnf_(ln(CBw*Me
zklJzL6vtUcVmto0=iYnHevG27B%&lt;%Xqw~Jc^FHUiA4CX&amp;FKgk*sf~)FTp)x9#@M%l
zz5S_&amp;#mMVjM5057ola-e;c$Goyu94i7d%&gt;!W%;GOd%M26p~_AEG&lt;@zbfZm4@ko6S2
z^qXHNe)xkQePtoDV88wLTT`ZKo^iXYUwF2s$H`0+r%%6n$283*08i?=ewr~&gt;ZCO^w
z(f(h4_@xwZZgXZD*zEI3-3Pn3B@*$$wjDbhrpcfxDt5HBc`i&gt;}UiNrA(!Q&gt;Jn$0=R
zo_(zwz}f^ao)~N)gnUN`@lOD8RaHF&gt;)rrjF0@CRPl*(ntJMa7jLI}9s)u{E&lt;I-c!$
z&amp;f%)60wn~oSj;dC7W-nN_X#K^&lt;4&lt;=#t&lt;TQRmhYs~yt%nqO(qk#Jv|M#+YMcJqC)oq
z0E8e|E#xuw(HORDX@cJ$KstTL5`rhz{ey61DAV&amp;yPkmLD3zlso7K?!~23=EOb1pvp
zG+j!k7bE~^Z1mcXY;4pdiIPImfWzT{+wHbSMn*~i79~lN48!=nZQG&amp;y1fhXrPkFuG
zbKm&gt;!_x0J?B&lt;?ORL)R4Co{pF2=2D+9#s&amp;dgx|dkHs;WVs?~&amp;H60l%|UwoqSJj|Q(7
zrBV@!tm1cPUPY-?s&lt;{6|oQt;&gt;7Z&lt;J7)jXD0R^Y1CapUGxIgyxo*|zQe(D4EOIpv9C
z$DjXmJf1u$1U&lt;a1rP;ao?+jFj3{Ooh;)#T%DC+gT;L)PQg;jUqgZB@~vh&lt;4IAE&gt;FR
z@hFlk!7xf&lt;a`NhR(=-nbgkE@{mUn-1H_o5``}ur6w|`61X0N7K62XDhLIH2S`9`W(
zEPP}4?kCGslH~XH?&amp;%slc(A*9*W-_Cj4{YmLUJZmDwmB@1EIlnTYVrj$PI%XOD0n#
zRaHSLMLZriP1AaPAT+oF05a#c&amp;P+yiO+z-9gCtQXD#iSKN)m!!UJv{;6M|oxpHE5c
z?QJkkU|UOza^uFoes(&lt;c{MSv&gt;JVY5Y_q_Y=U;lCT+}RQ(1WrwZBCFs6;QZlpigN)j
z09jU{sw#5%91iS1;M}$AiB3Z3`}E|AUri5$2EU!n=1z@Y8aGr$1tAnZ-zHlK(f)7+
z;?e*40+bRcih}&amp;=DilQl0Eq%XUw=&gt;q&amp;{bdGpq9&amp;J5JC~~2Q*4)e_wx)tOwrLAEcDh
zkl!EB91bUBS;6@DC1ZGacyVN8&lt;YmU#E(!p;t`E08_SmBh4Gm;=E(y208k;uxNWkxJ
zA%qMC`+DgY!GnFh1i%Tu|7$J2O+HfTav__`;^vK;vSnFKCtf^xc&lt;59(E&amp;~8#Y+qyJ
zMrmnj2^G4IrKKg**43e-qr=Gs|M{(3w&gt;x`-NB*zTBuNSe{QlO?j!vhdD43p}hG7_R
zRk@6nm6iPf&amp;H?vEMPGj~L@E8L5S$Z2E4OdouI%aDs|X0#mWjE!S#j&amp;u?b7VroCE+(
zn|*d*&gt;sGC4a}#kmHQ1JotFcL_sss644j+t;-Zf3LF%pil2lhd4@W&gt;92$8%xl&amp;Yi9e
zRU6RS+KPNW57T5&amp;6cqqqSr!1m?XE^@K84AN%T{WBzUXpQ%H9UA{?WyYHs{&lt;C2}kX&lt;
z_CaGsMFk{@BA3tNYAgnCLjyETLq%mJD4{463b=dsKbV-DfUaw}8jG2hWgW&lt;5G8+?#
znRd?k8&lt;B9-2G(9Ut+lnadM=yCwd&gt;c4xm-^1dc9U_&gt;o%=WC_&gt;kD#6O9fp4u9vuC5-1
z!YYIi`A9hW-o5xgd&gt;-t9&gt;HzS!D_5@I;&gt;Q&lt;r*=+U@=UmTZG7GEuRaEFY#&gt;U2qGs&amp;6X
zPE1Tr#p7{CsRTmES~zPHM8eT4LI~9~&amp;HC_A&lt;a8t)wS*9_WOF&amp;TkXhh{VZ_2ikza7m
z+mp%U$D^a8;GF+)J%TlNawHt(0F2MhobxkNQ&amp;T?{Lby2RKe^{q0PsX_@Q4P0tw-=*
XXQu0=@CuHL00000NkvXXu0mjf7g#6~</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1">index 95a7609f98c37973bff8213ddbaf8b85e6b1f7f0..034b11c4e2593e5347254a7a29cdf5b7f03898b3</span>
<a href="#l34.2"></a><span id="l34.2">GIT binary patch
literal 876
zc$@)j1C#uTP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00001b5ch_0Itp)
z=&gt;Px#24YJ`L;wH)0002_L%V+f000SaNLh0L01ejw01ejxLMWSf00007bV*G`2iXJ|
z4-p0^F8}WU00QhuL_t(Y$L&amp;&gt;1YZFlv{!Z@9&lt;k7}d9gH=tR_a29K&amp;|ikiXaH?1jTB1
zf&gt;OaJYAv|6l2&amp;x&gt;LPWuZh*meH#)!=yuuE-GF|i7gR+?taoy4T~y2xv$T8y}p9yoCC
znc@5HJ?A^;0t&gt;ca|7!HR;EkK%D?*5CQc9&amp;poLR=$t;-jCd;Ule9_U-{a=AVp&gt;+EtV
zN^ST;2t0cHFqcjn!QP&amp;$@2uZ`K_H@&amp;TeoagIL~1G!#Dsy3IS1Z2_XcetnPPp&gt;_*4-
zo$8Bd&lt;TQYDRy@a?(&gt;sXhOl#{J&lt;?YxQa@j0Q&amp;cV4^ans~5O&gt;2xp)0_yb2sjvH$HN1C
z&amp;Upy{99X+{T^)h&amp;{=&lt;7@vn5c@i*A}W;9}f_5CQ&lt;u*0w&lt;faCqJnF~%;nx3#&lt;Di8y?|
zMcB4^M@==zW;p=D`gQA_qoc1c19(uuw4`U1uIv39+czo0kzuS_*#apgIOl)#LZJY|
zFre!?lF4Ml&lt;}Dkay^Ov}+HT-*I8N=}xks7$Hi_?sfp|QQL?QtKq25~$pU-DIwP6@Y
zrwvFc&amp;&gt;wY|qHhqn-l0u=o;U~KgpGiRPWt_RrfE)`J#zt65^z4B$KcZ^7#SI{5wxss
z!O_lR&amp;{Pfm(LwmUgc(DkVQ~XVDZ9c0ecio1S7#NAmc99W9@D95iwq?+O~v6uN6&gt;kM
z0gy%6%A!&lt;1fBA&amp;8k%lbf0JtCvIiyn4AR&lt;jlsRF1F5CEvE2Di&amp;y0T)t03W3R~uMk4o
zw7&gt;u2^Est&lt;LF6;ocYX+fhXF7FkOBZrO--(1mI#b7YwatYS|%$Ki#&amp;%OXtw&gt;gWZBZn
zdg{wWRi=%NjXolpHM1tG^VHQm$jTr9pa+_5ds`o5oz7e;mA-TD{@oKo2(=dQ?of4o
zJ67%2Q+s70li`nthawl^mSLv^gF!D5H8|XEMM_D3Gm&gt;ZYgX85Jcqa#2-9$4Uk7p(p
zixsRu6bgk{N#lP-@XdedM@7CoqQ+t|0YLm8FWOH{Q&lt;daIkf&gt;|`0000&lt;MNUMnLSTZm
C7l#u7</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1">index 3aeee0ebeb057497e09cc652a33e51602fc8e32d..27a802afd722f1401f93889ce7e171bbb917a296</span>
<a href="#l35.2"></a><span id="l35.2">GIT binary patch
literal 1167
zc$@)`1aSL_P)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H11Pn&lt;;K~zYItyWu1TtyiEX3p8OtXnBijY_w4p)FV}t=%*wtr9LG
zNP&lt;mmqlrG4Dj*jv7h{Z%USbmyT`rr#u0Uy0(+4-&lt;$x0;3rNJN-C_xIgwp_|(xw%_#
zFK74cneo9^H$o}K{gQe3XTJHq%s=zb4B?z(v#?sL4-=8LF$G6UODnE#W)9t~xTVGN
zs79;3l$ri~v=||@TP&amp;8yuo&gt;9xc0tF&lt;H+i|oViNZxldSZdSe+iN07zI2R@{r`g!sgi
zsHkXq=Z*`HKNc$*48|kYrrI&lt;A+o0jg+Lr}EDBSyGvd-u8fH4MH_9Eq}0}n|WvBKI|
z{nAGB$wr&amp;p&amp;`_I1MBWSFVE`b6iYJf13VZ8UAcO?((pDMesbvLKH`f*6oUhyJ8*BE5
z#w{%$Mpzqb`O?xNueX`yfAcLibIN);&gt;!!%sTw6&gt;y?|D%ALLm~;VQZ`_S&lt;@dHoIn3j
zM3Bdv+i5VKn4Xyu{)&gt;SmX}1{T5^5XISu))#!BbULRX!kOlN%ap5)&gt;9QY&lt;fEN&lt;O?~+
zw1jNBL;wJU5R#RdD?M{0{e(VJ7^!cr-u?Fqtc~V;K@u-Mdo*K&lt;VS60$c-#P(&amp;|s@M
zLpZ%yQc^y0Pe&gt;5{S+w157nbkLW`gtABq&gt;7jc-)BF5ie$E&gt;Eb)Pz8kVN)x0ijGi)=6
zgmmoQm8g%~VWhI`gQ6&amp;ijEo|JD5iO3Pg&amp;oUo&gt;U4=7lTl_Kjk2P8M&amp;%n8SMSq&gt;-(ck
zuhV~EG$tHO+OwAkf(TjmLMv%WKnZG`&amp;gB&gt;B&gt;B7@9Dq*IHiCdHXgMB{6R47USlT+h}
zj*3P`S~hkiB;_e8=?4HxDF6r(6$ecR4joEQ%YsIu#jiK6LH5gFOvS*}K6!ln#xxHS
z69s^&gt;f~uP=D5W?Yv+b9AIy^qvi^ZjRb!d2?^~ayOxp8L#GBa`&gt;A%uWZ3Y|_T=H(vO
zZ`~S=&amp;hGC6W23|MPN&amp;l^`@Fc^)9G&lt;IX1YWw?&lt;*~&gt;xW1;)Y|VA=5kfv@s;Vg|s??md
znV%B{;X-b9{u6U^voM(sW9s%T06&lt;4q`){0(SIUYihipxCK1vDUjDPZ0Vfm-`^wu1e
z;)3$eRW+E$IbQ&amp;Pw~OEXfpfeuG~AEm&lt;b9x&amp;!mvFKKM(YR6Mm|!sB#DZIOp?0Rm~3-
z$K8Q-o2B`)*wFZ_?ThY(g?X+h3co!)!Ru}2Z#Uv^SjhnJ&amp;YSPgg~kFQmsVC&gt;E=sA(
z&lt;#f6Lv~9${Z;I{*!quMT&lt;;76|qjQd#QNqZkt`hOVl)u2aGU-}zj&amp;aWMyK@;qF*qGo
z1D!5n)$f&lt;DF~*=M0T92=9aaNDSd{~Tm@&amp;o}0!jcHO@u$J29gx1u6o&gt;~e!mZlsaSA0
hHuW9Z@I?y;{seGfCpI!ys@VVl002ovPDHLkV1k|U7|s9y</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1">index b249f6cd8180143e1f66fd9276ba830aaef4990b..9052a4a48e5137c2626b6be17f4d256634d68563</span>
<a href="#l36.2"></a><span id="l36.2">GIT binary patch
literal 858
zc$@)R1Eu_lP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00001b5ch_0Itp)
z=&gt;Px#24YJ`L;(K){{a7&gt;y{D4^000SaNLh0L01ejw01ejxLMWSf00007bV*G`2iXW1
z5H2)ot&amp;JZ500P=cL_t(Y$L*E7Z&amp;XJVhrcuT&amp;a$&gt;;5m5jMK`0F!N{Wb7RB7laco{_g
zg(yu@Z-YpYf59C&gt;77}SJs1hZSjOapmtt&gt;3Syb9P2f!Mq2`#LAZo!xuaUPJ;(myt%h
zznwGZJ9EyQ9r%B|VMtw^Jbi4=lzB6oo?vUSkFKo08k|^MT&lt;rf{KwKA*L}!m2Jv_a8
z*X}KbswzuM*FJBzSLT6JZv`-P`^@wVcURivc{XO)Xl&amp;!)!B3l=&amp;Wj_*Pad_+j$9;t
zA^vjV!ovLP0minxC`gioqA123q-n;(NB22&amp;=(8yoIm`?*EkD&amp;*`*Usjho7&amp;W1Lh~y
zK+b$IcRkCCk3|GC3&amp;1K+kx&gt;w1YZ4Y}I*(&amp;__QLs#tr4KrYPsdR?Tv4~{&gt;pprapDjW
z#5tS@h#=w+K*UvH85joPBx=TB(C6H@-{lt&lt;F8NW4TCJAOoj##6Gqc&gt;g*AAPk+*Bw=
zl@3+K0MjC*$xzc^4|_h?H+DJQ=mxoHfPr%kRjsC#bLeb1C*FAxR2AnW-wKGNpJpk}
z#c$tKA{44X1&amp;C{lz4hKY&amp;Iy8GVhB&lt;e(ZGaI11ZxX5)xsE2`1oNIDtsE1z^zY_j&lt;%}
zjBof*I6}^AHQA)i6tz-EQB(#n34rPPpx@)Y9kZDE2?eZcsvf{FEx$)m45o;XZUH1&amp;
z@vPS$uyfar(Y32@9@hat_&amp;wOf-jgONBGTIoa7A7`?R2~B-~Z8s&amp;0thrTf$0BEp6U6
z=yp07wh}Io4go&amp;P^IK1zJSELOVIxVZ8d&amp;9Mn4-F_*T57y&amp;%3%YNNxijNQQu^8^7LI
znrb$(2lrQfv)L&gt;G7#boj|0Bw7Ep=$P0Kp*7U-H|{JL!u*US0&gt;L&gt;HxpGy4v_~@B7P_
zzQ26nT^^X&lt;yWPh&gt;{rJmrIKil=w+G^0V0QCE^bdvsYrtb*0K6JHY5-BKv)=^(pg;kn
kQgbN(@^fr8;D0y%0$BALiINi4H~;_u07*qoM6N&lt;$f&gt;3UOk^lez</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1">index 2f37d6b45fed95e3907748546096c86d086bfe80..620843ef0252908937ceb8af1509a3efd6fdace5</span>
<a href="#l37.2"></a><span id="l37.2">GIT binary patch
literal 990
zc$@*=10np0P)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H116xT%K~zYIwN&gt;3~TtyWBote2Gd-oQb{vXoUKq+ZrD&lt;XoywjhWv
zLP}6#)2&lt;P;NQfjYrkk#b#I$`8E2)t}npy~`FZ-a92Nge1RESbr3+Y~T*KIcUV?KP?
zY_gk8c7wJDe$1UY!#Oj*bM9}*7=wpt?4d&gt;nAOK+Q+H5E1JR_y-)mjT&lt;40Zwl$r)dW
zlX#-&lt;h5n_s8D&gt;9xzw?vN7T3z&lt;f6Q*JR4SVJg==fm7pFQ~9mW^~214fGfiBnc(vVWN
zK(Ybf--9EEpKuvbrY%KL6!)f59*i;IoY%Pw8tcC~H%7xx`v}9Rw{3zXNdy2SNxb8x
zLQudjzy6FrZr_5|8bkylLdU)iab@;BQ=1bJ7-Lchv7nTic=q^nOF~MCYJz0P;NN}!
zExNmU&amp;~xZ;y8{D&amp;xPQNV?8~LkpSn7CrJJes1oa%(&lt;Hw(Vz+&gt;G&lt;;QM=!BwPL4*UR(L
zIC!AT1tG(vQ~&amp;_2^|n}EUWV`c&amp;{~5r0ucid17nTgoPl!=&amp;N+w(sg#E(ihG69N&amp;$uo
zVb%J)&amp;J3bB0str_0T76G!xCWI4w57hf)TqJ1i{lC9s8(Ok6Q35b+TdHt=YB%DJ9ry
zrINjVV?HdEif|kUj^n_#ZCF+nH42;gZw&amp;xYQi8ql`tTQb?%aNI=F;@yo1?=rH&lt;{H$
zv`$HN6Hx8_o$9n5s&lt;&amp;2EEgBgf%&gt;&amp;54cIH*9QmMoMK*VtI(z~Hj$~ML@&amp;IODyEo!jo
zAR+(;N-Nc%rsu}S6DcL)IKqY8`S7&gt;jm(MW9KfYJEXFM;xPM-tYcHuZ%;cR?+UK&amp;9V
z7)I=7lUz%sFm`q{{PXVJ6WQ_Hh1JSxcJ8CAVX^o(TsO6j&amp;7hWLLkJ7D?QGPrR4U^7
zjrnl3QpwWR)*KjosiL($Ha#`7SX(&gt;w%E?2iRBA|T{W!1w3?L%xe{_Fx^qJ$XQWBPB
zBR84V&lt;#Jhb&amp;OeRg`25K5XkIkkAW3&gt;=rY|?&gt;d@ehg2aq2;Jzx&lt;Luj$U$-+VPvC=^~k
z(bw++z{&lt;)BBO&gt;?Q*!ZUIwA1r;$P5jherx&gt;fS`&gt;vQGc;(n`kN^FFLv_O!1H?_*?YNE
zF1c?{Of~e`19_7tbMJf*{1qHkO06|H|1U-L=zp=V=?Q%x6t%K{0q-sB@}IlGjsO4v
M07*qoM6N&lt;$g6Lt({Qv*}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1">old mode 100644</span>
<a href="#l38.2"></a><span id="l38.2">new mode 100755</span>
<a href="#l38.3"></a><span id="l38.3">index 1d58fc4712118a7b4c49f2cba3967ed601b76840..94cb9619a1d5b3643ade69012fa66a8d857a9057</span>
<a href="#l38.4"></a><span id="l38.4">GIT binary patch
literal 1014
zc$@+D0}1?zP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00001b5ch_0Itp)
z=&gt;Px#24YJ`L;(K){{a7&gt;y{D4^000SaNLh0L01ejw01ejxLMWSf00007bV*G`2iXW1
z5HA!+*qoLC00VYOL_t(Y$JLf^Xq8nQ$3N$}yLZlYx4FCR&amp;R9f~W!f}dxtxC&gt;2nt6a
z;tN@&lt;Hw6izr1fI;atR`01QA8OD5xoxNJWqdndXud#fVL#z^&amp;Z8cXR)_cbn}#=lptc
zp51$&amp;d+#O)z39Aoe&amp;&gt;14@B90GzvujZ=YjwGQ1iyMcEZY0`;_CnW?Wr!KVVM484@G!
zipcv-UCaO!r6W1co8gD+-*|A#bH&amp;A#(L84n0b?NjG++e8AjW_(+#MgT9lCO%GZ`NQ
z&lt;Vc#qwRQqdz!_cHzNaE6V=x^9Bm-^?7!6umTWc^HF&amp;eb@%@}x~j=5khH^2Mhj?q%v
z)P*=6Mi?jwRaEDLYYU9lp6y!j`S+eJ+C?V%DK3j3Mj}A5PogX_(vrBFKS13bgNZ*-
zlYgQ{dm$OiVdQ1+1;ZF0T2Z0R5)mX=j)d!xa6MFSn5To&amp;^AW1|lMJ}FpxO4K0Yn6}
zMx{n5I&lt;pfAHy{-auxu4(c?)Lk9#pg$b&gt;S^Y-1a2OFhcag0W7#{GtwHShf#?*YTz7V
zG=XR{y5(&amp;o`V?$G1&gt;e2|qt|^bB!_|Hn|WG_r&gt;B1QQ}mX1(2cvHBnpE+&lt;9xjXb-No0
zl_6U@?NRk@`aJ?zEnOs7fs{8OwJpfwFQZ$(L&gt;_qoW=2tG_F8#r)*-9fyoB7$F}@cA
zw1(+B1ispab8bKC){hV&gt;#cVx&lt;Jl2NHB~jg-)@M@(EQ$C}loSdeSrW}}STYW`&amp;Z2(U
zi@N9mZa4s;WpMK}{QVPz!my$&gt;t40=MASSJ)RISBq`y6RK4mInbw+s5dM?zs_{i}9e
z-&amp;yMyX~;0oPCqw*uYjI&gt;9jRJ_RIkA_cYtwGJ)hZyHBVTuvEQv&lt;&lt;x1-(lHUL`3W;B$
z+{IcW!#AwGw91=b&amp;&amp;&amp;&amp;e=NFnWh^M3a&lt;uJ0b!*&lt;&amp;4gXy~9!$u?#w;4|kB1a#B+3^Ki
zcut|2ba#~4Wz@;-Uf0a(pozG@?_`53wV*^vV9uQyL6z0zb;?3^?rA|OROJd%iE%`c
zc&gt;a{dE&amp;^!k!acu&gt;W3j6jUs=BX&gt;0t2DMi8-?dl!p{y;Ll4VZBp{afWXEn(CY6#K&lt;h=
zz)V`AkAIW*UQ7)vor(?YR1jJSWU(Q_KmAjDbMO+!^X_Dz1Snq}!F{HV()+oSPya=-
ke~MDT1tx&amp;m|NO7wUx7AKAIFhHN&amp;o-=07*qoM6N&lt;$f{9zxvj6}9</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1">index 7a8d02126e88c7bb5fe7d6a0cf3d0795a17cb696..4e18a907867e6ee1d7e9fe71a5667ea6b4975d59</span>
<a href="#l39.2"></a><span id="l39.2">GIT binary patch
literal 717
zc$@*v0y6!HP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00001b5ch_0Itp)
z=&gt;Px#24YJ`L;(K){{a7&gt;y{D4^000SaNLh0L01FZT01FZU(%pXi00007bV*G`2iXW1
z5HBcax8M-~002I8MObu0Z*6U5Zgc=ca%Ew3Wn&gt;_CX&gt;@2HRA^-&amp;M@dak3JNG=DIhX1
zFf$-ZVQY0_ASY^RZEay=Cm&gt;UFWod3@awjwISO5S514%?dR7l6Ql}~8XP#C~}Fa5J3
zI_UJ)la&gt;y_&lt;4%f45e08My8Bufh@jwMw5;20Cx^NrdegD#@G5#3yX`Or9vpZn5{qrA
zOGi81A2EGi(vapQX;Rp`BzbvXe&amp;74PUlKUuAqFidFO)Wb$q3I}DbCIndKd8!0h70H
z-65A7AGpvk_E~$kng=2Q$mPbldw+4@y3cD*l(|rVWHJfBjqBGyf&amp;_%Hjz}be?d?6!
z*iZn|Gy%}G7zk;#PTDQ}{-fy|8w$|vb^(aRW7dqM@vFnp@hOLYPHd2rayUS5XfchZ
z(V?;50VynK!rDy$V33N&gt;UOeUA%@O$fmCG04oJgS`oVPuf0k+47RFR!8ZRK8IiK43b
z@$F;fUcFxT2Sioz`SOxq4n&lt;EuR22);GXPX76+1SY&amp;GPcqav7Lc08v$JwORnA(`g&amp;p
zZrgp)fUc*eVO9K8m}YEqOR3Kl;0&gt;5SX$r~;V6W0p9_ppy*ya{j17!FHb2tHsL;`@O
z{xi@bw~7&lt;i^{x&lt;o=SmN%)vBj@VN`U2{4`zJ_^_Uj@YN^+Wq0Q8?45x8!v~KrO%q+$
z$z(EprSMVFGxG^4y-QT9)c{DPQW%EO7v!U2-*E3l0j$4Y9qOm&lt;%+_5V=THBV19%Y_
z1$uAXKj0K-1HUbIwbw8+0&lt;!_^(v;PwGadf{ew6PFdknU&gt;00000NkvXXu0mjfYy~xU</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1">index 8f1668f27db47b085f29442c82959d0431bf8f16..4056347bc32a0276ce056767f1a3ed00207af6f0</span>
<a href="#l40.2"></a><span id="l40.2">GIT binary patch
literal 977
zc$@*z11|iDP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00001b5ch_0Itp)
z=&gt;Px#24YJ`L;(K){{a7&gt;y{D4^000SaNLh0L01FcU01FcV0GgZ_00007bV*G`2iXW1
z5HC1-0PuAH00U7;L_t(Y$L*ERZ`))X#y^hZBu(0;&gt;Z)pKHf&gt;9$hJ~clGKw^D3W5RR
z0^3yWJc%PhDhJTem;|acjj4!THVys)4!~sv#zusoV}kTorfLEr)E*e3OS7bQ&gt;Ui&lt;{
zngcjEOScPL5IoW=e`P;&lt;p7;Iw`P%SrhvF8OE}oyNZs;ffuHfp=D{o)8`2L$+56+yO
za{dXNIXmTeb^UJ9YPFc3pJ!}r3`J28Lf|-maUI7&amp;QIvM=y|1bo&amp;E_WMa+y}E)v&lt;A(
z*C3b6Q7V-HkW%6}4nhc|lx;C@ErdW(6jT+iT=|S#F84448-R2=O|e)+)3mmUloBCC
zd)c;)5CXs7kEW^2%v|R1;b%K^x(saF{_`ryWHOXWrMAgdOHmX80Y9bXGKUU5(Qcco
z(`Dd7h!#Q!5{U$hi;F}e5l=fDG*v}PNjMy0c6OG;t`Rg%dtj&gt;C29{-Y^cEnQOmgGf
z&gt;-6^a5{&gt;o|i9`s6Lqwx}6s}!k=Z&lt;)npsUlBB3IP=axKeZIKG|h-+bLp5I`^#V((~*
z;o%`H%f7DzVrv6$&gt;&gt;S78_S&amp;!P-m#1A;bFE#2fKDU&amp;&gt;v)B=?9X@&lt;U&lt;FqV-DOCG|UG3
zMpIa3la&lt;v~?yUcY*)-`1_0Zqfk6{?p^*V~8u(4EQWF$_lR;6i~jE^7W^Q)Kh&amp;ph&gt;f
zp~Jw&lt;w{6?RV{s~XDi{qN!!$Usf1F@2K-0R%k3Zca8jX@jB*B68YK5lNWPkP`!C-*L
zAG260Eqw9OCm%k2&lt;b{cX?|y?=EQY3O#9}dYV}o=mgHQESYuuySut_BLqN*zMi*w8^
zd=Dt&gt;OFio02u4$nsJdZHcAVfqHv87Z@nanysfmeWWYSrFshSAs&amp;}iE9_yo(hmYJFP
z6xFAae=^UW-3e~jtTt!ofWXl8Y=^&lt;iue^F1IPHnAcI4=bAK$IlpIfUz-IRp&lt;l3u0B
zdZn^*&gt;B0wl0J3A5@_OxVa;@fTbHZ$*8^+Bo2hHsmV43FTJH_G+F&amp;Nk&amp;HDt0)t1(yn
zPUwbl!X@gu{!*cERSfv+q=rle{Z+myd?^gwnC|!=JP7ZeKbMz6PD&amp;}WLW-MG%ITA@
zoho=aZ=8BPFQuFmQf8(2gEM{Zy#oK^zk%NY(vTaIfYX6K00000NkvXXu0mjfe80|Z</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1">index e9c92f470748e1f8430f391fb3d7cd5017e6eef4..f4a709c32f32e14ffaf5d239a8f59401c03aebbb</span>
<a href="#l41.2"></a><span id="l41.2">GIT binary patch
literal 1284
zc$@(Q1^fDmP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00001b5ch_0Itp)
z=&gt;Px#24YJ`L;(K){{a7&gt;y{D4^000SaNLh0L01ejw01ejxLMWSf00007bV*G`2iXW1
z5HJpS;A?UK00e|dL_t(Y$K8})Y*S?vz|Z;ay&gt;0I;?b^|&lt;EgQiJ&gt;X^tJ9S}$q34()=
zI3x1`6Qh|RGC^LbQ;0+aTtJlY;DgG9EE*?&gt;iw{01l(87X+@K^lh9E2(&gt;;81@UDyA&amp;
z_ulXGrHumtt53$0oP1xtoO6EP`I7_iUy$0`TKu=Z_jL3%ZEsUD&gt;9vR`QbrLGDWx=R
zu~=L8?P-3!Pym1D!&amp;^&lt;;pG&gt;9GKi03SHxv~WV^-Cf&amp;VULW5(F^EV-v5%V)2))R?CWg
zdz#PvqYQSvw{u}M8trP_{3f2dIGpX1`HV@DM4bXpfN6&lt;DBJG_4rWMs?hC_!B(h_G$
z&amp;CVUW0tIIfiO3yW-`Ixj-63^Uu?p*#mnBN4OOuo_Ev4w%)nH8hxo&gt;&lt;{{FjmJmd0&amp;{
zLx(@=1OUtZ09^jE^WArR-UT%)Z_2!WGbstLu9!XMv5ROj5P?#ll!0au1udm$SNdgI
zZlo#IWjEpcs&gt;c#%J371W1t5R^KD^z#z$=^|P_@MmId1SAs#%R@Gg&amp;=B8A}4NBmzsy
zadik0&amp;-8`&gt;7cE?D3Wdg+3MvuL^ESc&gt;V3N$n(qfaUsFVSK&amp;T~X#z*I^hGa_e#k(d$$
zgk(4c%S2HEj^iB#0T7YXbR9UJ=b|YsX%q+n&lt;Q1K&lt;EJ4gnB(q~@E{854foY5aa6Hce
z01$#)K&gt;$jrW)yfqAdFoP#zzTSh&lt;zI9N&gt;(3&lt;rL}?1-p~~tK;jruAk3txs;(#sM=4bc
z0=QhR3&amp;CKprpRExYq!G1x5BA&amp;j6evHjByM?ltGLGZ~`*3JRW+YVpcKAazt^vJ?HNS
zAX9qqnZM)o$Xc(96V2jMoly%gB)}NY7&amp;S7aR*GQAWHKdor}L@Rk2^`r(Ic^Fbi!ZI
zn4Ui656rEs@R^OgGVkGX&gt;1H@vGd?op6h-j{a0qH9&gt;j(u0x7r&lt;!7uQzVfL9{aG2I!v
zdbMwP`RoUdUg_;i+!p`&lt;@cg&gt;xe)_fd@@AHr7+t?+sZ|Buoy@YQb%xK127XP|oRS%J
zUI!fe&lt;O8~D)iY#ZV8CLv7O9i5Xv2fE%fGxE&lt;S)yvdH&gt;$|gM+tza5|hBo2}U3UEsCN
zoH^6d-`_vk-P1jK{rBHQC9UqZ*{z&gt;9Zr%cZzaKb`Q!ZZWNy)PO=&lt;&amp;91M+(}e&amp;HMMh
z0s!?xLqp3DQDlsz%gV~m0&gt;JSm-;OUD8yoi_VQ+8TunD@lx`0xuU%b?libNt6C%!p3
z{I`H9LqKwNIK_tn05mi-yd+A-Pd9GZgn&gt;W+j7B5t==5hoq4A27C%zlJ8-V0Sm&amp;&lt;E)
zb+zHZfdg}0E|&amp;)Y_;5HJX&gt;D!2*3!}v2LM`ESGT0J%=7)m4Vy3?kAvNAhxhmH9{&amp;2P
zw$j_iG#A(a07C9GN|Ge{e7&lt;=ek7tp`&lt;9Wg1aI7|)%~h3^m2+}ibXt3Rd*DJ(VClh+
zKLoei4Hk&lt;9Y&amp;Kgu9~&lt;xJhmZs1v$!prDdl1SKmkC{&gt;*6JgW&gt;h&gt;&lt;aZHjVw;Y*R+1A!}
u`CdK9*Za=E+!XsfAg@{uMDzXm|HvOl;{VVUx7+mq0000&lt;MNUMnLSTY?QB@NF</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1">index 2dd3f99d31a11146921f8b5b036199b83d34f8fd..e57541ce32443553da538caf6adbd6ede24481c9</span>
<a href="#l42.2"></a><span id="l42.2">GIT binary patch
literal 1139
zc$@)q1dRKMP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00001b5ch_0Itp)
z=&gt;Px#24YJ`L;(K){{a7&gt;y{D4^000SaNLh0L01ejw01ejxLMWSf00007bV*G`2iXW1
z5HKGSP)mRS00Z+$L_t(Y$JLf!XdG1(#(#HacPHuYCf(LH$tJs|HCTK|3Z+ODD^WBB
z=|d4Kf*^wUpy`96P!S)3zKRc3`cx57RE&amp;tE{)=t;V$@nGfyAV(Nh2oNHEI5Bvb)Ld
z%-nl@m`So*H?h754%|EEUYPGY=X~ehGw^?ZMCsyO-`6iAcwOuA{aXSOXsvj=&lt;Do}R
zZc5O5{ww`pdk3ar-Xg3&lt;`&lt;9fFYoBzg*wlsL!eXXpWg+`U+ZnqUxcQTS8NhL!Qj9V%
zt+i)se@A&lt;EC_B#XmFq_B;ip&lt;&gt;&amp;cAzynx3x)UJ6w5OG?T3_&amp;9|^0f0y(Od^ro@K|e&gt;
zm$SI8gBb`AjfBbezDn(ZV+7qP!ZmW+q7WURDI@T_1EnO%+mk4z05F6=DY*`=fpBCS
z_))l{-=KpLf)=RhVbVkC6(#j^KskZqIO`EiOiYr?=Ku(Yw~&lt;UHeZY;pX|2I6Q2gO7
zcC&lt;ea^B1{s`FmGu`VM?Ze+2^9BT$mYrnv91H%TeWrS-K@181mez6Z0I!kHdo_V=u#
zr0!hTw3NUtiC}Val6*eDq47&lt;k2SWk&amp;?5;+Qd`ax#6Ois&gt;;?e-FVVyqseqpjA!Fr06
zq#@pblB%Q-*Xmk;03ifiI7zhaC}R04`SG7w$_PE$_~@JP5nB&gt;ytw~L#$mjAKU~9+5
zH^a+Usn7gLb?af6I!9_S#c0zpcV_#+!sY~i{R&lt;&amp;TBohdP2QJn;7aqP=6h3~9*xirA
z;s^_a{TQ(pQnjrr&amp;r&lt;ohswA&gt;u7^Kr_3M&amp;PlKoAK&gt;h&amp;MI&gt;0(baxg0Tdlpp8sjA^ls1
zy|47(eD*D@vK4{j*S$faDS;4TWB3tZXDR-8nq5a;fVqCAf4PX-+m5Ka3)ejh7-a-T
zMFPV&gt;2!Ynx8_E;fGz{#Y-XXm20nF7uD5eIPOBY$({|vTmW7{qnGXETb5Q6FH8FINC
zhVOk&lt;brp$SQD#T`Xu0&lt;&amp;WUerAX^6!;AEP=JClm^KDPGwkMXs-b5Q2C-?tu$|5MD%b
zb&amp;;%-!)Wbf_KRo96{&gt;LCo*&gt;&gt;3$FeMB=_R&gt;U1b)qU?-Cts$L70h0j%y56jLKCA9|7c
z#ssk)F-+6MaU2A&gt;O$o#XLHWTI{=AxBrRP_RoqM9}J9LWrx(4F$Myf0eAq0-&amp;l3B1t
zMS|w$X3KFLq?FV|YAUvu+MV@$`oVjMP!!9usHv&amp;JvMdb4Kq-Y?w2h^urO@9xT31(&gt;
z(cRs&lt;{l5G6pRz3TN#$3LS49e~HL7GSrNqD4*Y}jtfN^%&lt;^7W^WA3u`m&gt;grNuEwiPi
z#R^8Fb(XHaO_|F0w&gt;{ZZrp$)i8_dtojg5^J|Fge}zW}V{_l^Sf4SWCq002ovPDHLk
FV1g)29ccgn</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1">index aa1f1f87de01c70755dfa72ed9566ae646efdf14..27c1f52d180661e06d7b22ad748f460d6aca7205</span>
<a href="#l43.2"></a><span id="l43.2">GIT binary patch
literal 1656
zc$@)v28a2HP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H11@%cpK~zYIjZ{l)8`l**Z$6x%NDjr1CF*0&lt;mT1Yf&lt;SIa6G(ozk
zvoO$XTC_kmvP~d1P#}s*FS;m=tkT*&lt;f&lt;P^cBtYFSTfk@w7%&lt;Ro+5|OF8%~tiMiQs~
zO0q;!vM7lo^D`pnedcvhNii&amp;?^&lt;6zYym!vM_uO-dloC%9nOuHU)3kE{EYA5W*&gt;vjC
z)BMxE1k4ZM7yw^3oqBuY`o(B8ddTn@WNGQ)2&gt;_Qi-i`qX1Gtb)r^-)aDLWA;iaHq#
z27hLnX7=&lt;i{%{-s2q6K}G)W-P1`uLxfInv##=BjK#H6lkf6nCc+wgX*fDpt&amp;A&lt;GC^
zA$4YYdNPyChgDTQ&gt;NoxHn&lt;k``&amp;u4P^Q&lt;|o|Iy^LFX_|^kr4j|Ot&gt;0uP4KlfWQq#0+
z2M!E}*BuA-M!nS@4jUb@I8jsuj^kjdTy93%!~VYBUR?g*!)mQwe&lt;_&lt;z{bNUhOfK(N
z6m^mi#Doy10hCl#T^Jr7iK&gt;c%g~f+xwwiD$g-`P#(rzIVw$PL4gs$uO`#&amp;$$TuMg(
zP+iwwBS0Tz?B#4aRoQIOv9&gt;n&lt;@lePzR#ujeNGU}m67@L^2eWhY=;=&lt;NCy_uf*al5i
z!8k*+*~0w7BKo=$7)mCM+xPF^Bmf2n`u#1}CG*A7&gt;j1_#34EM$FBl4`@%XMV0pP4V
zC=`nr9XS9YIA-T&amp;ZO3s800;$x?qG5tx_5UE&gt;J10`_I||}8t6A9JV;OC%E#9n0Q%Mx
zWz(s*UDq9-otdtzuRBmQ74wA&gt;4(uO-y=FIW-@Q9mt&lt;}c35ItOop0#Rq?8c{`&amp;CSfs
zt#`(vfD|wd9j;69*Z1D9uU70V&lt;9vLZ$eCPzqNAhpO&lt;nhy01%Hw@b6o&lt;N}TiIY&amp;unY
zVh}7{*KfY?&amp;2RK2;!!B74&gt;#}J!zZ8L`pr+q$4+jE{NtbheiXoqgph!uC`SkS`}^!i
zRnpttg&lt;`Q-tJwArvgy&gt;Hb{gkQF8{rKdwPHOt!EEeP3mD`c@&lt;ZtKB@&gt;I&amp;Ph)?67s61
zs@l0|G;+u^P2x9A#A7k6tl9_#0%$ZE0Pyin;2ZH#t=&gt;?D@W41jAP~Ul$Vkk7RLxLI
z&lt;-?_iWet#)&amp;u0+7&gt;4)hzp(qLr!v|GWK?som)c--C7`hH2I2ae8jDsjDG+hH19+470
zO$hNyxx93O5MoIwpFcP}91U9*JRuOaETy%w@+^RRJE8At4;|_0jKk#~nv|njZ{U;9
zKCMbAFH4{&lt;rT4cdMLyNt)pfSFtJ|;Z8VDhnx_*6$F?KMUPOUx;e&amp;&amp;}KyLvi&lt;pC8&lt;x
zj54C5&gt;QKxT3n&amp;x{zdbW??8KJHn*^C${y9z4{y3OS4(#skM#FIsYY*c=vEbghKfT5n
zKLy~buBjx}9yk&amp;X2HzOy+a2-;E!}Roa4AP+&amp;BpZf{fZFcWHz0;xJ8i3&lt;;M)4@7?`_
zgI1!m6RJW00J=(G8V0J&gt;I%eh{)EbStV)%5@y(@;U&amp;W?aoe5kH7G${q83@yq~t&lt;|u!
zSgLWs-#I&amp;R?DVFS!;whD&amp;@&gt;fSr&gt;3fuQnGKL-}vgjq@k%QI^$9FCZd)?BsllrGLA-z
zq0yvhQI4hZvM81c4JjpQkHkY}TQKC*AH{($*7b!-rSg((+fmBcj{w}hJ3VuAuz#-s
zO@#!3@PHQQa5+b_CD3#kT*g5eL#b3~FiO7-fZD6eZvnEy^Snvmi&amp;ar(oWDRB8{JsB
zlmL)YqFSrt-s}S`ELY&amp;T0#1v=uGR3MP(a0AgG(8tlmr0Hrc&gt;9?OdLJzdEVEu&gt;C~Oa
zD?m1#@;1-9uD_PtyT=az@BQma-SfP^fROKg{h4QCilX4!jT=?rc^3eDr+4?BSbKC=
zsIpRi3&amp;7zGEU{&amp;jFELP`ODUPUe!~$$yz%&lt;@*hwM8IeTpl)mj}Axct*skDd@hoLpQi
z)mm-~fb7WR^4m&lt;gBLQRV&lt;-)?^uU71}^IV8G@!xhilrq_JT}UbG8&lt;}1doW0}J9{t+$
zyzf7r`8FT?zsThBhgDTQ55VVn-o)7-9zXvy|NaAp@bj))b@Au`0000&lt;MNUMnLSTXd
CH56q4</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1">index 95a7609f98c37973bff8213ddbaf8b85e6b1f7f0..8aa8a28c404de5cb855330c76c3febb7eba1c086</span>
<a href="#l44.2"></a><span id="l44.2">GIT binary patch
literal 917
zc$@*118V$&lt;P)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H10}@F@K~zYI?Uhex99100Kfkv#`%kjjB&amp;*%fHYBkGHK9GM+Cq&amp;z
zC&lt;L#81oWnY6hTBt&gt;cvBXSB2owix@lwJcx%7A(BIswh4$BV$l3Cy4EdAOv}#h?9S}I
z=V7yxY`V1(?5$t;&amp;HR3E9&gt;4GVe&amp;3rJF~;yPp&amp;n}YM+A=u{ufxS2A7wYzXV2=IvKw)
z2Cen?!^6Xuk3W;+FWTbbVpk{&gt;$_@@a9Sy0L{H-Wh|9PWSbcz&gt;7Mn*RORe|SuZ=N}O
zCghe}e){z{RLI6?jn*}^)=hc6uJPifXX#F#imt7#zXQB`wBK&lt;Lq*N-smrg%nZ~U@&gt;
z&gt;$&lt;ol2e(u&gt;xF65!5wdKO$#&amp;)Y{u}f2^O5@!%+Aif)S2pR7Zh9D+jwpnx9CuAM9IN*
zi&lt;E&lt;KD7!^O1Y-&lt;+eZ6)rmm9mUMb)Z5IdJY=?ABkmh(FdwyyNVNcHpj4CfOFHr&gt;7^f
zva&amp;h}d~pxK%*;%8D%EwRy*&lt;gz)f*(cP7{sTCnCt@3taxX2LzPGdFLZ%Xkubwt;r(a
z_pd(p{6*_-p@3ya=;%5{JQgMv4HJ#nEh84SiO0fd0D)HrUq&gt;wPJTKVjKtZKac{`PQ
zJhZ*FNp?3&amp;b~g)vZQBf9$Y4bhO{=bYMb&gt;{@!Sg%-8Yfy=P^na28y_FPIyX003kaNI
zG3j`QNXKa|z1$5(V~n9vEU^B=ji6Bjwr%r4`K^X6$U!Hu;PYobjLUhdPkyE93PeOE
zuU$KsAqWaYAwVqAN#@Ec&amp;88cJ!N50lTaIERJ&lt;4tWcXIw8{H&lt;=+33_{bBXt++S9#E1
zR0Kg#7R+sZ7AWXX_On~w4r*nAH9bA85{X0tpr$pQZSe&lt;mKg7+^{UCqg+YYk+7RnOF
zufMOqTU{M0?eA||Q&amp;UqWlgU(!*5=bsKK2iEG#S!b#Nk9ikPKm{ue@5Vs+dx4y1!pr
z#uy_a&amp;cMJxU;fUWq^hZ~WrYMl&gt;%-nh#^h+-7*iLyj#am9XJ_ZBy}i9Z7Zw(3!Pito
rWNd6q&lt;@5P_HT*{`EiGwdj0X4zE7w`a!Wsr-00000NkvXXu0mjfM{%S7</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1">index 3aeee0ebeb057497e09cc652a33e51602fc8e32d..8595b5d456ed69fb5d83433d7a3c77442a9189b5</span>
<a href="#l45.2"></a><span id="l45.2">GIT binary patch
literal 1230
zc$@*w1Tp)GP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H11WQRoK~zYItyWu1lt&amp;c)W`&lt;q%f?O@Scuxuj47NZ`YwE3PTN)da
zCJjcD`d}6lZSBPv(&gt;KzGKJ&gt;v`ji~FTO&gt;HcpA=aiPp}_#60zp6!7E8BL%Vn?ZuCn{@
zf1T+QW&gt;JWn=$A}p&amp;YW|;FK1&gt;&gt;G7v%_mEm^Z-Qf&gt;-wXUvPAElZjga8pj;CXPn-Ak=D
z^RUfkx5i&gt;IB@hjjt}S2dd2S*Ano5kO%guIsM*4z$2g%OPG22b%me$r*%S#cs+0lBD
zF}BQZ%V5!H1XhcMrlpzkEmr#b3kx(hUEL*w*qNJ~YnEjRoO2`+3FPI@H&gt;;Yyq4oM-
zHO~{6^A76jeq5fFlifoI%&gt;p5S0DGhSE!^(y1RxB600b(bbo={Twl&amp;YGFx$=d^&gt;uA)
zY-~(V-fOsWSq%mQqT$LfqN(X8d$MnEcyQ-jujrX0&gt;gw+JCe4)oTV|$aPTrR!NdSP9
zkf5rG8D(pVeEN28R~-P;(|l&gt;ui;j*CYdjIH%goHG42Ap*LYYAlmtq0{5(x&gt;qGRc#D
zfuN5%3Ko6b($-X%nPK~|qGG*w+D8H4(k0i@hod7sIaxWCYbw^7C&amp;M8gi$!LTaL#AU
z$p{8~dTGh)Y{jxyUmNlK+xNrIuJR`WwXUP@$g0v`QoOpTsHnsokH_$M&gt;M&lt;Q1k9~W}
zb-X;8h%p92$h1jnT}RfPIeYAsl#nvx@hRlxy~5VLy(ypTdi&amp;Y)Cw2n&gt;Iqf&lt;YT(Wq1
zPDR-oW*7!2We5a(@cAb&amp;?j3`o$ZZU4w*g~h*N#2u^$nMx$yy;{xM;On*B3Yz!{I2v
z{JeZ{&amp;cPVNKc2sZ``&amp;=23sFur!pbImWA|=#woAIM!7y}q?vEfNV;(lH+k%ya#TyM6
z{QxMX6aWD;)9%%!W$QO&gt;co#Oi9UjjJ;_)~*=jb2kRfb1~{D#1rpH_c0L=QL*jL9)k
z5eWwyTCO)svDg%XK|dcD?ESUv#x-N%!UAmF{6RKjX(mc3OePa5-`k$OAm4$u8`q4x
zLw7EOCPR;8If0v&lt;ZSjYr_q&amp;&lt;USM9I&lt;@(%D+qq)w1zZaAo=Z0aim&gt;$_AZC*JM^zzot
zmCGX0FiKaI;lV=&gt;EEX%8n*SIT;8pva2RmICPKF4&lt;Ji&amp;3oJ0AYJrl#h}OPJ9Id!3)V
zxT&lt;dg;01vF)dz18E~@(ayT!`FVlYOrbjb&gt;I_jCe+@89P&lt;*a-mK(EX~WSM7BkIGjul
zVD?TvckcLt`uch{ZP%VXa%F7%KcQ)w@cAZ0?U|!p$?+#Id{;16C#PW+IGtbklWhWA
zjYPs59SavB`X~ZH@Mp6Bvpt6=X5)G0h~@$jxZ(4A-2mMFfY(hx+f&amp;H{Fna}0W6H)y
zqtVG&gt;AvnU}Nib*+QWZ$4f&lt;vDiQe;IL;#&gt;@=sxrj6`Z!gAlqvuKRh5T1=TKDz)RHd0
sd;v{!D@p&gt;gq5xVfk!oH_zls;Z|71X|M9Q^L{r~^~07*qoM6N&lt;$g75%7BLDyZ</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1">index b249f6cd8180143e1f66fd9276ba830aaef4990b..b258d6bb0b882a4219e086326576a998c60437b9</span>
<a href="#l46.2"></a><span id="l46.2">GIT binary patch
literal 919
zc$@*318Dq-P)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H10~AR_K~zYIwUte88&amp;wpB-*aciV&gt;@m_lu!eT*dS$xkSMr|Rw_tH
zAl57(i&gt;}!rA^t#r084~eAfY0`2KWtx9drQ#(qJi#Mcq*Pk&lt;g?#zH{&amp;SU||QvnQ&gt;wk
z9O+%m+^h54_niAdW`_SW(&amp;Hby-4AZW;Gg5j8xY+z(oHCO4%W*fwwEt``uM*B=(vO3
z?)#QC+TdajFb5SaBo&lt;yckZ5cW5QyB48Eygks{&amp;hqZWE=w`@roB7e0xnIskxHy8{Ua
z82)t=5)Sf4tDPrV69AyXnMhbw4y(f94US&lt;bTm+SnwpBfVC(i;HV3cGzTJ4LF;t&gt;w_
zHW0%-WcdP;v&lt;{b~K&amp;=S?1fV$&lt;9`t`{Rh7t1WLF*6ivc@CQfuPe)0fa#dI6yrzz^&lt;E
zFZPtpG6CSoz{I=}C~G`{g_T#}2al%a7v{485~H0Uj8_){5G0m*cqSk{Imt8tR#Yq{
z8zq@i3Y`VO9L=Nv%$FvT)xa@Ar2-B&gt;L}qYslt71NKvILm2$4_?n8ks{XvWnJfcj_w
zTmhhD#uCK{6&lt;_TD_3?NaK$Jnax&lt;r$^h}nz_82btZ2s4C&gt;vV&lt;Wj{QWntuAB~t(M&amp;x|
zJWPfYg8FffLZ!|vE=v;V+Nl7J5z4+o0m{XAJd`ByZ_F&gt;9&amp;(-wmNx&lt;Y?WM(D-5Rc;r
z&amp;SlGZxU+?&lt;mR0ru0Fv4qU{&lt;&lt;3OFxW@@nJi*D_q2b{x+7LS%Pr&amp;IiPfgCKF-fkKWc0
zXaeT`Z7`$&amp;3~*TkW(1XTFHH4pfT~&gt;{?C*Wm+x+b?atfEuV^k`I!Em@g6p=cT+Ib||
zA}DD9a4;2^RXd=nH~EJzu3RPOK7Q)imHPbRf+I@N{qd&amp;=*hfV4nt@icyy@$$)?D6f
zCRr^9Il@l&amp;COT{DG}XaTbk^3do9fH=Zuk3lf8X&amp;svae&gt;i_R`zmKJN}5FBX3A*1^NO
zAMW;h8-L#FhTS`N_Gfl*%*mW{^jVVSZ*uUt8J0V1&gt;!nBG=g(iC^U3hC5n31D`R?nP
t0Y`D;%Pa2^(R-@)VrOl=e2&lt;(G{{WORJC=`~$*%wa002ovPDHLkV1kI|n+pH{</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1">index 2f37d6b45fed95e3907748546096c86d086bfe80..5f5b22a6f44fb6766c65297f751fe054aceb6c64</span>
<a href="#l47.2"></a><span id="l47.2">GIT binary patch
literal 764
zc$@+J0t5YtP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H10(nV9K~zYIwN=kc8$lR-nc117Es97^78(z|#r^^9p(v!(V~^(2
zf-SvQO6{eH^rYB&gt;5&amp;wc7yaigk)zq9&lt;Aug2S#gIc01i`ZA$NXBShnh5r&gt;$+NfFtEeS
z_r3RK=ldpMt;J1(+-P&lt;H4gi$P&lt;uqgLV&lt;M5rpPZZ|;{*~yq_uWUYyDw-eEcwyz;T&gt;U
zLqkLP(a}-H7&gt;lJ$Yn`gqYA=tDj&amp;1{Zajp;m@O^(OlgTj77!p9N!5Kp)lVQH^PeloF
z0H9v4bB9s{K@dxQCzw*y&gt;veu1L8H-txn%M-8jVJ@i1wzym@|t?DeP6NI5;&gt;s*WKXY
zAd1DJ?hYe_thHLL_xXJOutN}554*d&amp;Ae3TaVgkuz&lt;mGbOA5u!k^StN#`}+X!ibUDm
zt5)$~Yz#@x0c&amp;H8B&lt;C2*W?8e@%=a8o7@Ex{D5WqV#}@@kDTENbL!guj-6({(baDU)
zf&amp;fAYbO;C`MhM}gQmLMeQp(VOa}lhykWvCTEi}g1`ewOo`&lt;=8^{0~9&lt;h~8Ezl&gt;u*O
z=h4i}%&amp;qU6o6&gt;b%aL!}(r7-k3C=?2Ni;IgnrL}gqwyf*Azl|~Xuj&amp;B!=l)E)E|p4J
zN;z356n&lt;T{b#$X0+e1JI`Kh&amp;jy}G)(b2&gt;LyaUp~NAw&amp;aR6$k)JOG^*C=Zvwh-!?X$
zJ;~)r{|$&gt;uUMiIWN@?*7K|hQ!Z#&gt;WA+uPfd_}isJad%`yOixeWSzcal`Nzi&amp;=X_mC
z`3?XQaqjv2{Jc}E)y@?&amp;JUsj*o6SD1R4S=-I?d+h&lt;~r3Gi{K*6&amp;dv@PV}2;5?yan&gt;
u^f&lt;kiM}J{q;aDm4lri?Xf9+ZvMBxuwVM*!{E}Sj^0000&lt;MNUMnLSTYGV_RPU</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1">index 1d58fc4712118a7b4c49f2cba3967ed601b76840..a6c243bd14760b8bb783b01cdd7859fa394efad7</span>
<a href="#l48.2"></a><span id="l48.2">GIT binary patch
literal 1237
zc$@*%1S&lt;Q9P)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H11X4*vK~zYIrIlNVRaF?rf8V$EIWyy#&lt;7FH)N28=E6wL=UQ3F8&gt;
zit3&gt;YWMB{VP=R5HFHwRC7F3YbOK(DikU~n7Jp^6mK}_jp*hL%@9c6U#IL=ISX3jom
zul4n?&amp;Ya_TsiXyqy;+z4|NDMx?QhF(Ptt+#3h+F}RQ^vB{u0&lt;_#v2RwS_vRQ*xEYp
z_DzKai*l|w0}%z$#tzH?0}Gf12tK}t49tViF!SJRWFv#cu~VmCym&lt;a{n}}&gt;OvswZ?
z*S&gt;gJ&amp;J{Zlbs!E@5d;9kAcQCuJcO*?9fS-MMSO-KB-1)6bW1KRU49za4qQkOExKX{
z(mEAg{VMnhR7YbU?n4HTW1|C@MN?xUBLgu+43mI}VxnkaIsyft7!4p|@foOs7La@a
zxCJ`8Vg6beE5Yd=Y~UxvqL7GSB6X4yJ0KHdL&lt;EXO5QJL9KplHMQZt}!CbIAeSh^9L
zdMlV=W)lnJ^UC)tS^|azj{u=(8(v$Xbvja*g?27LX5Ix!TMVf&lt;2bR8oKeh+yKioWc
zETXeeM|h=y0ihNbTEK-2M$1s{#|DmKE)U(0AYIGri96hq4P-4v&lt;m7?+!TZMT!oqbj
z$f}?Y2^zUJt|^d&gt;!&gt;_vu=YK#JJ%#0qgy0GDA0$25gPhpgyjhx{E$vqufcYvC6z+cq
z(qU}44;eXwUHl!!ON4ZUtnUN-x9?*2?L==|1Atqzjcni;$)%&amp;&lt;1n^ioJjp--EK6f|
zd91w)=B~sRt|zQ|nM&amp;JS(%vr!mwVClBFWdAv9VIz?ee&amp;FuVc&gt;P5=EWj61~=dtb%2g
z##bAHCrv9&lt;J+NXkJiZT|HV@|%&amp;4$Pw+S(A1S$D%74&lt;o7#lN)B&gt;KYfPs-u09}--17P
zq$x6I8GhY+pb0J!+}W&gt;ie|*xMU;Yw^qR9&lt;1u#jO{h3c6@=-F?`_kM&amp;supSO&gt;2cOnW
zmXj@dwh?Lm`yEg#N0k|O;%9WDs;HA|4Zz4sCm&lt;`MDu@bBAb0#j+;?v`SFhMYR+xu6
zB?)Dc3kREXw?BY6#a$1PA3RN{3?Z|Zz@vMx$M$1gD^aK9PV7ei{IPzhtytH+h&gt;JM#
z=X;u%y6!&lt;m(CZ=cqXV&amp;qtlo-st-@w6#jkn|9|RR6*LR??!8#XXfOAT&amp;e5$E5Wi}&gt;)
z&gt;SRPow6E8yq@_9I@^~{u6gT)wbG&amp;nL&lt;3J@VHI3V5A)&lt;(zq#rX#3Lq-T;kV$@act-m
z9C;HFK?HQHzbRChiy5d2E{rwDbM5i}lw?&lt;BAe6O*Lh!(aBk2Bz2qvg1xx9dYrbD!U
zwwA0`#f21cf{372Va}H;86OXLZ&amp;+efsbWIIIWgE(DY3E89g;}T*DHBs7vmWRMj(NS
zQZ@pyqSxx6llYxh&amp;S|)m%D#!Zortlczn8Y@XW5{RDU%6KF1`QOLSVc!7Czqjv%L?D
z0*IL*B6*+_X#Yor|JJN7UNW&lt;qnB82IH{1ROo0R#Tm~UwI00000NkvXXu0mjf8$=`!</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1">index 7a8d02126e88c7bb5fe7d6a0cf3d0795a17cb696..37914ab698288943fa2212e5d9776078d97b7e0a</span>
<a href="#l49.2"></a><span id="l49.2">GIT binary patch
literal 1005
zc$@+40}}j+P)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H118PY`K~zYIm6c6zTSXLxpZU1gj^m_&gt;n}`IEsGzBv4@wgXYd}Jv
zNGzzRgpi&lt;1FS4L3egQwAsIpj-ZcqbK5mGkYP*fq*2%0)=l2(8ef(l9N#Kd+JY~L9c
z*S@~~irZHj&amp;D=9H=RN10nRA7;mTT7*2M9qR5K&lt;y*P56DIO(CV=pRKH!oqczY4$$-S
zUqxr8Cw8s1oz?`j!KgYk#*)o$H%&gt;Ma)CRYf*VsQ$D5cTbZ&amp;IpiU$-gcptZ(v6n$~k
zC8!X=RyM+CU%t_GLjYUm)&lt;XWU;2Q~~)Gd=UlMc~H)t_zbmojCPYTeTeDXM}hC0iyR
zY&lt;oCb;AnyC_$}i4O#oUuT?uq83auTK@)NFj{^a7NKX9DRI(rqEK7EoqD@!dm&lt;aXvB
zLqj9SwAMaBPgLNPHy9u5;r40~V*mszckWXzSE&gt;Po54$$5+ru^hDJ8o0(bp&gt;=zf8Y;
zhKXknxVyFkOapNK^LM&amp;R5ys-B?J9w&amp;OQcj?ild1r$+5wzz4aicPH5sW|LmF%KXb2w
z)(Q{^Aqga^IWopyIXn~v1hx4v{@ylBooIi9q@-a_K;Sqoo@e-ZX)AcCFp5$dA;8gs
zQrRcZ&lt;_!6w^&lt;`}XA?j)b67~1FT&gt;t*HhQqSvUzAd)(x03&lt;-plgpV=5J&amp;WaD?uRI;bl
z`+gBA2g4aSc%JngDOE3KQsEh2I#v9YUPhRDu0-Z;)~`W(P#7F09&amp;dUJd)sLBR-IsH
z=b_r%%zN!pJ@s-@h4nmg#AQ4=$m;qI*22bSp2_h&lt;TbTlavuEEg5-J&amp;2u6#QyguQBv
z5g=M_(a_N-V=oPG|F;~EvIi6j&lt;&lt;&gt;011mTZ#I{ktWe0}&lt;rNvFR*jxh$MG{#u2-+0j0
z!7s}X56wW-{sXC0%8A8#ezMlSs&lt;kQseDd*!k$k~J%6ge@F6W(a^X89?jy``Z$Y6JO
z*TiD6w}lXRUQk-HN@*$O(&gt;ZUOK|5T&amp;Jil+PjXsg5Hb^9fM-C+jV`1T&amp;86m_EfU~~7
z8qMW$7{4NN=FIE=xvp!hwI7{3_rcXC&amp;Y*^LIz6D2T05D1aU_u#!1D~@eOfCDg~w!8
z*7BZbCg$em{(35c3l~294tURXorA;HmCKa~aKl&gt;r=EaL&amp;7-+ht9h^%b1*A%)a@Sz0
b2#VDI&amp;e|s##(V=m00000NkvXXu0mjfiB!w!</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1">index 8f1668f27db47b085f29442c82959d0431bf8f16..15ab1d373528d7391a57b7abd5ee7ecd00984e52</span>
<a href="#l50.2"></a><span id="l50.2">GIT binary patch
literal 1039
zc$@(b1n~QbP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H11B^*TK~zYI?UdhZn^hRcKc`8WrAX4Ors)rKX}gYe7fCjyosDdf
zwNAaP*@lWBWef#Tl!&lt;?XDEI@t_Rbp%Mq#v23u9pI+Cm{|X_IPg-h|Dzv)kVE$J-?D
zIbN8=h73A&amp;yYqpE_wb%`zMtou^W_mrDIR6iJyP}m0S^*ZfYH%WyTjpdJS0sc5{Vd9
z0H@RW3(&amp;$tu#|#rz+DB9Qa1bjeyhjh`PafyN|qKE*}QY-vHkz8&lt;@wti8z`k{Y;64J
zRV&amp;59!UC-=EohmHr~%}1IePql(&amp;;qCViBj)d7!8ef9u5KaoSp2vD@wBa=EH?Rsdbs
zQA*L()y3T097lXU+-^4qg;I({B0-DSi_7IgN?8M_E1#hJx}i`AEuAJFk5ecV$mjF-
z&amp;7GYc#&gt;dBbyr~JV*IN&lt;PbzRf|bX|v%frJo*LLppECleDB6bgl!+}zw`Y;25EeSNgI
zw^voH&gt;w4`KZEbDUIMnC!VYAtY#bQ`27NnGwHBw5&gt;oIZ`q&lt;*M2vgt$K-m&amp;?@vGTAJe
zrg1(R1;8*248y=QO{_K&gt;sZ&lt;KnH0kW@tn4Wi3heFe)w-xyELMpplSv#72jTvH0J7N(
zzpnnq+V8jUdRy^5d4y-fVKUh)%gf6kU}a^6+kb3u^jMep_&gt;+%b{ou-n-&amp;6qmE68TE
z_&lt;TO&gt;b~^xCMq_$rnouZ6|EXt4Ypcx6PP4eQ$kz52ha278)$elh&lt;WmejF^Hz6nVFsa
z`tvV7z4z`r?_I4lyRtJnIyx%i0IB5^!9ai&gt;|8W``8tCyKClCyR5S$x4$M)_vfk2S%
zquto;cDlQd5eNjVha8S8`%fU|=jXB6Y*kmKlw#_}6urHDD5bDi&gt;M%`7TU#67{}7|e
zeV9ZdLF7yXP*^M$Ow**&lt;&lt;EcxfQcnX|g%I__!^59_7mJ&lt;v%Lqd5hZN1d6Z7*4&amp;x&lt;d-
zB!mzsrMPze8n&lt;q)t$#Z*GM6vz1(V67cVOUoQ7&amp;p`_G)o`eQl&amp;tB_M!9Kz(Uk$)Srw
z;Y*i?cQq|7^ZC3=r&amp;rbRr8kUdG};e{=!K!)H{ZIvt7SB47=}tFm*i`&amp;zp{J&amp;;&gt;!W0
z6yl%`Erf7HB9U-Qo9FF1VHuFf2`!WTYV!Kz&amp;q}GB5W@c4*+|&amp;yZGIm(E2a7|o5_4R
z`P0-5;NF7(MCq;SOWz_;018SeRcd&lt;Wc^hDs=JQG^bs*rs#-AD0z0wgepbG#1002ov
JPDHLkV1k3B^eg}X</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1">index e9c92f470748e1f8430f391fb3d7cd5017e6eef4..75cc80e06427f95c368b3add6a916f66ba00596d</span>
<a href="#l51.2"></a><span id="l51.2">GIT binary patch
literal 1064
zc$@(!1lRkCP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H11EonsK~zYIwUqB`8+9DV-`~6M-F=hGC21CuY-(U`)GgU2v#&gt;1`
z5g(~TRQ8JrK63&lt;-r6&lt;T9^ns)Y_7AYoCq&lt;v=6B$)OgdrBKSi0J7&gt;l#}ex;@aMX||+o
ze)e*?-1*&gt;=nF%&amp;6#5WvweD1!V*XRBD93NuaHvUi1e+M*8BLLo@g7hi~5|(N1&lt;EZev
zZCNvBqdqw@GV=9q0Ho7_rfE?sh@U+ce*9SMctZ9Ef^fNIY*owHTrXg0ep=7x@Bd)v
zTW^kzj^=j-&amp;@^p76~x;opFb@hJba8Nga7~&lt;O~7aZrUe)c6DvP`Yy5HNW_fKb8yg=V
zzuyf&amp;+ijtOc=gl^uXqj~I?4fnZ39&amp;U(9Mo&amp;IEo{Qmqp8JDu!u(N(gz$?lMHqIZ56M
z?S1m_fv1mffK%&lt;p)}zTg6+ii+D9g%osnoj{x;fwgKoF&amp;K@qs~^5CY2vN;+U|Qx{JK
z?2n&amp;dE;l&lt;v2;sT{EXx}3`-1?0N`3p}ZTa@&gt;C9+339*@V}+kHnhO_Klw-LeOD(;4VP
zI{D|&gt;hBKG8+};2P?0v-JkpWcx(?L3&amp;uJcqZR4Qc{O@QYBkq2A?zy#;+5&amp;#zk7&lt;Jz9
z98fE*!v^`QX`0&lt;z#Btn&gt;jlu%}fJB|dj5&lt;l%0M@!B3P?OqS&lt;l+lO8GXYE9I_$hM`X`
z%}&gt;{OVngJeDj$M6oG|Ld2^zS!Jg+~&lt;=Vw+{rfXdR06yL&lt;&lt;bJ#R^IVg1fWQM{D_Prt
zM4h&lt;61B)}?7?nzCVe#hjSGH|iT&gt;&lt;HI+BWL?nWee!YMF%}O#&amp;Mn0cdL;LaXnvOw3MS
zGwx&amp;-Y!{QF7caiv^?!S07Yz&gt;&amp;M_q3Db6;N|{&gt;-zdT;WIreSLmx6bi`Y)^KBPW~*4-
zoXcjjzeK{JcN9hWlQDK$Rn^Rn002M;A@5zea&gt;?y-pOqx(sMTx+IiAnfYPIFuT5jsr
zt(7kq7iU*fsnmx)pYO8Y?=MkG&amp;#J0AwIe_$=!ryvg$+Y)G$anFR5O`Ot-X7a$t1@Z
z`yv&lt;&amp;z7_}s8kS{U8X6k&lt;WXFJ=D49&amp;U8Drmv!{HO5PzbuNzn@B_KIj&gt;s1qm_6u16w~
zr=rm)ipAnbrfI&amp;ds%o&lt;*fEJ{mF*X~CME3Oe_amRrU#r*a=T%j$_5{#^3^K;1LZJ|g
z#bQ`pUA+!quxEf4&lt;Q!w{s@Ll!ilTrqHn8oY+N~xgCMI=VPnAj~qg*cE({=sVo;qkN
inM`^aWBS&lt;GnDIBzG=&gt;P=ugL)b0000&lt;MNUMnLSTX%#^2Ha</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1">index 2dd3f99d31a11146921f8b5b036199b83d34f8fd..35dae759a0ba66a2aeccba15d01610ca02ffb4d3</span>
<a href="#l52.2"></a><span id="l52.2">GIT binary patch
literal 954
zc$@*c14aCaP)&lt;h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H112;)TK~zYIwU$jx6G0e;-&lt;@3xNY`!sDKr{l@Lx&lt;YK)}QVj0(}C
zKL&lt;USC`S^b#&lt;NBfPe!7NM-AbEcMr;i1VbPy2dT6x#v%w(C@O8Y+ZJcro$*lHuyzZL
z=zH3k@0&lt;6TZ@!)E3Y&gt;HNPf3G=gDwEke_=)lnP_WkJ7@v?4$#)t*0S}OClU$xe7=hG
z)vI#4yezal6P$6R%rj&amp;?rZy6yNW2jwNv_ykcgWblpGzyFx~{|T_ghvdih{bjx{}&lt;J
zu|&gt;zbO|F`j&gt;1hztL&lt;HK91&gt;kf#(cIi@-I5@bwsk?kWME`lO7RN8Mg{vO-Y#!lO5U&amp;l
z;_*0CRsE|9VxeI))^q9o)H33!jqtn6?%aGj_R|88Wf@IPO@CDZ=zF*;bnKB{nt^$@
zdhOBM`@rwFC?`S)91cfmhAZ^d-wOg04l#s@H`A0GpU&gt;rDc&gt;rS!nx+*rc{M4Df&amp;+VM
zP+lH~w(tS!h|0n7&lt;oYvnvH-w2hb+rzX=y1LAP55H1CPPdKVYQ3V16pjGii2fWsa1|
zWIzZ3V+^ra4CCYDMGakwg8KUU{5Y}n5wfcsdUy)HSCjBGbjHtjJ=84#!!SSy0cQ-(
z%1SggG!zAhq6o%VejHzT0jkd-GB*K}yCK(hr2bqZQA)EFaE@p!hSAZ{Z24;(k4p?&lt;
z|6T_e4IwZxhohJK5Dcda@+8ABAc`V5V{j=7PM$cihBW}rpocy~3#*v*2T--E6&lt;c;T
zL7g2c*jF9^WSf?IUQJ=O2a=S8h*?aIf5*Ao_W{n4PN!D~gclbvFfd?i&gt;hXBc(cTWz
zh=M=^)qL;|f5M^TU2tyR0bSQ&amp;7)HT5iBg&amp;eRCzqOc;SLAAa|paOJk_2J&amp;c851X^Sa
zCr{tZo*L(%l-gGyt*D^Czu%JJ^?Gso)T#VfgpNd%A{tKO*rjer8!Ga#qDRD}?0xfA
zSEKXF7267Odi^elow9~4wP)ek-Ikx{fb9_x!!T?EcB0D~?%wNx;67$C&amp;k}g?9+;+C
z5+M3*27SFfsM&amp;X&lt;AXc;oj4?3AkjZ4$1Z&gt;@&amp;{hr(9nx+ZHSRnuaXN+YYba$`&amp;|3wgl
c$e(k+0ORU&lt;%-A`W^#A|&gt;07*qoM6N&lt;$f|vBGQvd(}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/mail/themes/qute/mail/messageQuotes.css</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/mail/themes/qute/mail/messageQuotes.css</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -7,46 +7,48 @@</span>
<a href="#l53.4"></a><span id="l53.4">   == between the message body during</span>
<a href="#l53.5"></a><span id="l53.5">   == message display and the mail editor instance for mail compose.</span>
<a href="#l53.6"></a><span id="l53.6">   ======================================================================= */</span>
<a href="#l53.7"></a><span id="l53.7"> </span>
<a href="#l53.8"></a><span id="l53.8"> /* ::::: signature ::::: */</span>
<a href="#l53.9"></a><span id="l53.9"> </span>
<a href="#l53.10"></a><span id="l53.10"> .moz-txt-sig,</span>
<a href="#l53.11"></a><span id="l53.11"> .moz-signature {</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-  color: gray;</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineplus">+  color: rgb(136,138,133); /* Aluminum 4 */</span>
<a href="#l53.14"></a><span id="l53.14"> }</span>
<a href="#l53.15"></a><span id="l53.15"> </span>
<a href="#l53.16"></a><span id="l53.16"> .moz-txt-sig &gt; a,</span>
<a href="#l53.17"></a><span id="l53.17"> .moz-signature &gt; a {</span>
<a href="#l53.18"></a><span id="l53.18" class="difflineminus">-  color: #7777FF; /* light blue */</span>
<a href="#l53.19"></a><span id="l53.19" class="difflineplus">+  color: rgb(114,159,207); /* Sky Blue 1 */</span>
<a href="#l53.20"></a><span id="l53.20"> }</span>
<a href="#l53.21"></a><span id="l53.21"> </span>
<a href="#l53.22"></a><span id="l53.22"> /* ::::: Turn on borders and padding for quotes. ::::: */</span>
<a href="#l53.23"></a><span id="l53.23"> </span>
<a href="#l53.24"></a><span id="l53.24"> blockquote[type=cite] {</span>
<a href="#l53.25"></a><span id="l53.25" class="difflineminus">-  padding: 0em 1em .5em;</span>
<a href="#l53.26"></a><span id="l53.26" class="difflineminus">-  border-right: 2px solid;</span>
<a href="#l53.27"></a><span id="l53.27" class="difflineminus">-  border-left: 2px solid;</span>
<a href="#l53.28"></a><span id="l53.28" class="difflineplus">+  padding: 0.4ex 1ex;</span>
<a href="#l53.29"></a><span id="l53.29" class="difflineplus">+  margin: 1ex;</span>
<a href="#l53.30"></a><span id="l53.30" class="difflineplus">+  border-width: 0 2px;</span>
<a href="#l53.31"></a><span id="l53.31" class="difflineplus">+  border-style: none solid none solid;</span>
<a href="#l53.32"></a><span id="l53.32" class="difflineplus">+  -moz-border-radius: 2px;</span>
<a href="#l53.33"></a><span id="l53.33"> }</span>
<a href="#l53.34"></a><span id="l53.34"> </span>
<a href="#l53.35"></a><span id="l53.35"> /* ::::: Colorize block quote borders. We only go 5 levels deep. ::::: */</span>
<a href="#l53.36"></a><span id="l53.36"> </span>
<a href="#l53.37"></a><span id="l53.37"> blockquote[type=cite] {</span>
<a href="#l53.38"></a><span id="l53.38" class="difflineminus">-  border-color: blue;</span>
<a href="#l53.39"></a><span id="l53.39" class="difflineplus">+  border-color: rgb(114,159,207); /* Sky Blue 1 */</span>
<a href="#l53.40"></a><span id="l53.40"> }</span>
<a href="#l53.41"></a><span id="l53.41"> </span>
<a href="#l53.42"></a><span id="l53.42"> blockquote[type=cite] blockquote[type=cite] {</span>
<a href="#l53.43"></a><span id="l53.43" class="difflineminus">-  border-color: maroon;</span>
<a href="#l53.44"></a><span id="l53.44" class="difflineplus">+  border-color: rgb(173,127,168); /* Plum 1 */</span>
<a href="#l53.45"></a><span id="l53.45"> }</span>
<a href="#l53.46"></a><span id="l53.46"> </span>
<a href="#l53.47"></a><span id="l53.47"> blockquote[type=cite] blockquote[type=cite] blockquote[type=cite] {</span>
<a href="#l53.48"></a><span id="l53.48" class="difflineminus">-  border-color: teal;</span>
<a href="#l53.49"></a><span id="l53.49" class="difflineplus">+  border-color: rgb(138,226,52); /* Chameleon 1 */</span>
<a href="#l53.50"></a><span id="l53.50"> }</span>
<a href="#l53.51"></a><span id="l53.51"> </span>
<a href="#l53.52"></a><span id="l53.52"> blockquote[type=cite] blockquote[type=cite] blockquote[type=cite] blockquote[type=cite] {</span>
<a href="#l53.53"></a><span id="l53.53" class="difflineminus">-  border-color: purple;</span>
<a href="#l53.54"></a><span id="l53.54" class="difflineplus">+  border-color: rgb(252,175,62); /* Orange 1 */</span>
<a href="#l53.55"></a><span id="l53.55"> }</span>
<a href="#l53.56"></a><span id="l53.56"> </span>
<a href="#l53.57"></a><span id="l53.57"> blockquote[type=cite] blockquote[type=cite] blockquote[type=cite] blockquote[type=cite] blockquote[type=cite] {</span>
<a href="#l53.58"></a><span id="l53.58" class="difflineminus">-  border-color: green;</span>
<a href="#l53.59"></a><span id="l53.59" class="difflineplus">+  border-color: rgb(233,185,110); /* Chocolate 1 */</span>
<a href="#l53.60"></a><span id="l53.60"> }</span>
<a href="#l53.61"></a><span id="l53.61"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-offline.js</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-offline.js</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -90,70 +90,133 @@ function initRetentionSettings()</span>
<a href="#l54.4"></a><span id="l54.4">         document.getElementById(&quot;nntp.removeBodyMin&quot;).setAttribute(&quot;value&quot;, retentionSettings.daysToKeepBodies);</span>
<a href="#l54.5"></a><span id="l54.5">     else</span>
<a href="#l54.6"></a><span id="l54.6">         document.getElementById(&quot;nntp.removeBodyMin&quot;).setAttribute(&quot;value&quot;, &quot;30&quot;);</span>
<a href="#l54.7"></a><span id="l54.7"> }</span>
<a href="#l54.8"></a><span id="l54.8"> </span>
<a href="#l54.9"></a><span id="l54.9"> </span>
<a href="#l54.10"></a><span id="l54.10"> function initDownloadSettings()</span>
<a href="#l54.11"></a><span id="l54.11"> {</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-</span>
<a href="#l54.13"></a><span id="l54.13">     var downloadSettings =  gIncomingServer.downloadSettings;</span>
<a href="#l54.14"></a><span id="l54.14">     document.getElementById(&quot;nntp.downloadMsg&quot;).checked = downloadSettings.downloadByDate;</span>
<a href="#l54.15"></a><span id="l54.15">     document.getElementById(&quot;nntp.notDownloadRead&quot;).checked = downloadSettings.downloadUnreadOnly;</span>
<a href="#l54.16"></a><span id="l54.16">     if(downloadSettings.ageLimitOfMsgsToDownload &gt; 0)</span>
<a href="#l54.17"></a><span id="l54.17">         document.getElementById(&quot;nntp.downloadMsgMin&quot;).setAttribute(&quot;value&quot;, downloadSettings.ageLimitOfMsgsToDownload);</span>
<a href="#l54.18"></a><span id="l54.18">     else</span>
<a href="#l54.19"></a><span id="l54.19">         document.getElementById(&quot;nntp.downloadMsgMin&quot;).setAttribute(&quot;value&quot;, &quot;30&quot;);</span>
<a href="#l54.20"></a><span id="l54.20">  </span>
<a href="#l54.21"></a><span id="l54.21" class="difflineplus">+  // Figure out what the most natural division of the autosync pref into</span>
<a href="#l54.22"></a><span id="l54.22" class="difflineplus">+  // a value and an interval is.</span>
<a href="#l54.23"></a><span id="l54.23" class="difflineplus">+  let autosyncInterval = document.getElementById(&quot;autosyncInterval&quot;);</span>
<a href="#l54.24"></a><span id="l54.24" class="difflineplus">+  let autosyncValue = document.getElementById(&quot;autosyncValue&quot;);</span>
<a href="#l54.25"></a><span id="l54.25" class="difflineplus">+  let autosyncPref = document.getElementById(&quot;imap.autoSyncMaxAgeDays&quot;);</span>
<a href="#l54.26"></a><span id="l54.26" class="difflineplus">+  let autosyncPrefValue = (autosyncPref.value == &quot;&quot;) ? -1 :</span>
<a href="#l54.27"></a><span id="l54.27" class="difflineplus">+                                               parseInt(autosyncPref.value, 10);</span>
<a href="#l54.28"></a><span id="l54.28" class="difflineplus">+</span>
<a href="#l54.29"></a><span id="l54.29" class="difflineplus">+  // Clear the preference until we're done initializing.</span>
<a href="#l54.30"></a><span id="l54.30" class="difflineplus">+  autosyncPref.value = &quot;&quot;;</span>
<a href="#l54.31"></a><span id="l54.31" class="difflineplus">+</span>
<a href="#l54.32"></a><span id="l54.32" class="difflineplus">+  if (autosyncPrefValue &lt;= 0) {</span>
<a href="#l54.33"></a><span id="l54.33" class="difflineplus">+    // Special-case values &lt;= 0 to have an interval of &quot;All&quot; and a disabled</span>
<a href="#l54.34"></a><span id="l54.34" class="difflineplus">+    // value of the positive version of the preference, so we don't lose</span>
<a href="#l54.35"></a><span id="l54.35" class="difflineplus">+    // the last value the user typed.</span>
<a href="#l54.36"></a><span id="l54.36" class="difflineplus">+    autosyncInterval.value = 0;</span>
<a href="#l54.37"></a><span id="l54.37" class="difflineplus">+    autosyncValue.value = 31;</span>
<a href="#l54.38"></a><span id="l54.38" class="difflineplus">+    autosyncValue.disabled = true;</span>
<a href="#l54.39"></a><span id="l54.39" class="difflineplus">+  }</span>
<a href="#l54.40"></a><span id="l54.40" class="difflineplus">+  else {</span>
<a href="#l54.41"></a><span id="l54.41" class="difflineplus">+    // Otherwise, get the list of possible intervals, in order from</span>
<a href="#l54.42"></a><span id="l54.42" class="difflineplus">+    // largest to smallest.</span>
<a href="#l54.43"></a><span id="l54.43" class="difflineplus">+    let valuesToTest = [];</span>
<a href="#l54.44"></a><span id="l54.44" class="difflineplus">+    for (let i = autosyncInterval.itemCount - 1; i &gt;= 0; i--)</span>
<a href="#l54.45"></a><span id="l54.45" class="difflineplus">+      valuesToTest.push(autosyncInterval.getItemAtIndex(i).value);</span>
<a href="#l54.46"></a><span id="l54.46" class="difflineplus">+</span>
<a href="#l54.47"></a><span id="l54.47" class="difflineplus">+    // and find the first one that divides the preference evenly.</span>
<a href="#l54.48"></a><span id="l54.48" class="difflineplus">+    for (let i in valuesToTest) {</span>
<a href="#l54.49"></a><span id="l54.49" class="difflineplus">+      if (!(autosyncPrefValue % valuesToTest[i])) {</span>
<a href="#l54.50"></a><span id="l54.50" class="difflineplus">+        autosyncInterval.value = valuesToTest[i];</span>
<a href="#l54.51"></a><span id="l54.51" class="difflineplus">+        autosyncValue.value = autosyncPrefValue / autosyncInterval.value;</span>
<a href="#l54.52"></a><span id="l54.52" class="difflineplus">+        break;</span>
<a href="#l54.53"></a><span id="l54.53" class="difflineplus">+      }</span>
<a href="#l54.54"></a><span id="l54.54" class="difflineplus">+    }</span>
<a href="#l54.55"></a><span id="l54.55" class="difflineplus">+  }</span>
<a href="#l54.56"></a><span id="l54.56" class="difflineplus">+  autosyncPref.value = autosyncPrefValue;</span>
<a href="#l54.57"></a><span id="l54.57"> }</span>
<a href="#l54.58"></a><span id="l54.58"> </span>
<a href="#l54.59"></a><span id="l54.59"> </span>
<a href="#l54.60"></a><span id="l54.60"> function onPreInit(account, accountValues)</span>
<a href="#l54.61"></a><span id="l54.61"> {</span>
<a href="#l54.62"></a><span id="l54.62" class="difflineplus">+  gServerType = getAccountValue(account, accountValues, &quot;server&quot;, &quot;type&quot;, null, false);</span>
<a href="#l54.63"></a><span id="l54.63" class="difflineplus">+  hideShowControls(gServerType);</span>
<a href="#l54.64"></a><span id="l54.64" class="difflineplus">+  gIncomingServer = account.incomingServer;</span>
<a href="#l54.65"></a><span id="l54.65" class="difflineplus">+  gIncomingServer.type = gServerType;</span>
<a href="#l54.66"></a><span id="l54.66"> </span>
<a href="#l54.67"></a><span id="l54.67" class="difflineminus">-    gServerType = getAccountValue(account, accountValues, &quot;server&quot;, &quot;type&quot;, null, false);</span>
<a href="#l54.68"></a><span id="l54.68" class="difflineminus">-    hideShowControls(gServerType);</span>
<a href="#l54.69"></a><span id="l54.69" class="difflineminus">-    gIncomingServer= account.incomingServer;</span>
<a href="#l54.70"></a><span id="l54.70" class="difflineminus">-    gIncomingServer.type = gServerType;</span>
<a href="#l54.71"></a><span id="l54.71" class="difflineminus">-</span>
<a href="#l54.72"></a><span id="l54.72" class="difflineminus">-    // 10 is OFFLINE_SUPPORT_LEVEL_REGULAR, see nsIMsgIncomingServer.idl</span>
<a href="#l54.73"></a><span id="l54.73" class="difflineminus">-    // currently, there is no offline without diskspace</span>
<a href="#l54.74"></a><span id="l54.74" class="difflineminus">-    var titleStringID = (gIncomingServer.offlineSupportLevel &gt;= 10) ?</span>
<a href="#l54.75"></a><span id="l54.75" class="difflineminus">-     &quot;prefPanel-synchronization&quot; : &quot;prefPanel-diskspace&quot;;</span>
<a href="#l54.76"></a><span id="l54.76" class="difflineplus">+  // 10 is OFFLINE_SUPPORT_LEVEL_REGULAR, see nsIMsgIncomingServer.idl</span>
<a href="#l54.77"></a><span id="l54.77" class="difflineplus">+  // currently, there is no offline without diskspace</span>
<a href="#l54.78"></a><span id="l54.78" class="difflineplus">+  var titleStringID = (gIncomingServer.offlineSupportLevel &gt;= 10) ?</span>
<a href="#l54.79"></a><span id="l54.79" class="difflineplus">+   &quot;prefPanel-synchronization&quot; : &quot;prefPanel-diskspace&quot;;</span>
<a href="#l54.80"></a><span id="l54.80"> </span>
<a href="#l54.81"></a><span id="l54.81" class="difflineminus">-    var prefBundle = document.getElementById(&quot;bundle_prefs&quot;);</span>
<a href="#l54.82"></a><span id="l54.82" class="difflineminus">-    var headertitle = document.getElementById(&quot;headertitle&quot;);</span>
<a href="#l54.83"></a><span id="l54.83" class="difflineminus">-    headertitle.setAttribute('title',prefBundle.getString(titleStringID));</span>
<a href="#l54.84"></a><span id="l54.84" class="difflineminus">-    document.title = prefBundle.getString(titleStringID);</span>
<a href="#l54.85"></a><span id="l54.85" class="difflineplus">+  var prefBundle = document.getElementById(&quot;bundle_prefs&quot;);</span>
<a href="#l54.86"></a><span id="l54.86" class="difflineplus">+  var headertitle = document.getElementById(&quot;headertitle&quot;);</span>
<a href="#l54.87"></a><span id="l54.87" class="difflineplus">+  headertitle.setAttribute('title',prefBundle.getString(titleStringID));</span>
<a href="#l54.88"></a><span id="l54.88" class="difflineplus">+  document.title = prefBundle.getString(titleStringID);</span>
<a href="#l54.89"></a><span id="l54.89"> </span>
<a href="#l54.90"></a><span id="l54.90" class="difflineminus">-    if (gServerType == &quot;pop3&quot;)</span>
<a href="#l54.91"></a><span id="l54.91" class="difflineminus">-    {</span>
<a href="#l54.92"></a><span id="l54.92" class="difflineminus">-      var pop3Server = gIncomingServer.QueryInterface(Components.interfaces.nsIPop3IncomingServer);</span>
<a href="#l54.93"></a><span id="l54.93" class="difflineminus">-      // hide retention settings for deferred accounts</span>
<a href="#l54.94"></a><span id="l54.94" class="difflineminus">-      if (pop3Server.deferredToAccount.length)</span>
<a href="#l54.95"></a><span id="l54.95" class="difflineminus">-      {</span>
<a href="#l54.96"></a><span id="l54.96" class="difflineminus">-        var retentionRadio = document.getElementById(&quot;retention.keepMsg&quot;);</span>
<a href="#l54.97"></a><span id="l54.97" class="difflineminus">-        retentionRadio.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l54.98"></a><span id="l54.98" class="difflineminus">-        var retentionLabel = document.getElementById(&quot;retentionDescriptionPop&quot;);</span>
<a href="#l54.99"></a><span id="l54.99" class="difflineminus">-        retentionLabel.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l54.100"></a><span id="l54.100" class="difflineminus">-        var applyToFlaggedCheckbox = document.getElementById(&quot;retention.applyToFlagged&quot;);</span>
<a href="#l54.101"></a><span id="l54.101" class="difflineminus">-        applyToFlaggedCheckbox.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l54.102"></a><span id="l54.102" class="difflineminus">-      }</span>
<a href="#l54.103"></a><span id="l54.103" class="difflineplus">+  if (gServerType == &quot;pop3&quot;) {</span>
<a href="#l54.104"></a><span id="l54.104" class="difflineplus">+    var pop3Server = gIncomingServer.QueryInterface(Components.interfaces.nsIPop3IncomingServer);</span>
<a href="#l54.105"></a><span id="l54.105" class="difflineplus">+    // hide retention settings for deferred accounts</span>
<a href="#l54.106"></a><span id="l54.106" class="difflineplus">+    if (pop3Server.deferredToAccount.length) {</span>
<a href="#l54.107"></a><span id="l54.107" class="difflineplus">+      var retentionRadio = document.getElementById(&quot;retention.keepMsg&quot;);</span>
<a href="#l54.108"></a><span id="l54.108" class="difflineplus">+      retentionRadio.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l54.109"></a><span id="l54.109" class="difflineplus">+      var retentionLabel = document.getElementById(&quot;retentionDescriptionPop&quot;);</span>
<a href="#l54.110"></a><span id="l54.110" class="difflineplus">+      retentionLabel.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l54.111"></a><span id="l54.111" class="difflineplus">+      var applyToFlaggedCheckbox = document.getElementById(&quot;retention.applyToFlagged&quot;);</span>
<a href="#l54.112"></a><span id="l54.112" class="difflineplus">+      applyToFlaggedCheckbox.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l54.113"></a><span id="l54.113">     }</span>
<a href="#l54.114"></a><span id="l54.114" class="difflineplus">+  }</span>
<a href="#l54.115"></a><span id="l54.115"> }</span>
<a href="#l54.116"></a><span id="l54.116"> </span>
<a href="#l54.117"></a><span id="l54.117"> function onClickSelect()</span>
<a href="#l54.118"></a><span id="l54.118"> {</span>
<a href="#l54.119"></a><span id="l54.119">    </span>
<a href="#l54.120"></a><span id="l54.120">     top.window.openDialog(&quot;chrome://messenger/content/msgSelectOffline.xul&quot;, &quot;&quot;, &quot;centerscreen,chrome,modal,titlebar,resizable=yes&quot;);</span>
<a href="#l54.121"></a><span id="l54.121">     return true;</span>
<a href="#l54.122"></a><span id="l54.122"> </span>
<a href="#l54.123"></a><span id="l54.123"> }</span>
<a href="#l54.124"></a><span id="l54.124"> </span>
<a href="#l54.125"></a><span id="l54.125" class="difflineplus">+/**</span>
<a href="#l54.126"></a><span id="l54.126" class="difflineplus">+ * Handle updates to the Autosync</span>
<a href="#l54.127"></a><span id="l54.127" class="difflineplus">+ */</span>
<a href="#l54.128"></a><span id="l54.128" class="difflineplus">+function onAutosyncChange()</span>
<a href="#l54.129"></a><span id="l54.129" class="difflineplus">+{</span>
<a href="#l54.130"></a><span id="l54.130" class="difflineplus">+  let autosyncInterval = document.getElementById(&quot;autosyncInterval&quot;);</span>
<a href="#l54.131"></a><span id="l54.131" class="difflineplus">+  let autosyncValue = document.getElementById(&quot;autosyncValue&quot;);</span>
<a href="#l54.132"></a><span id="l54.132" class="difflineplus">+  let autosyncPref = document.getElementById(&quot;imap.autoSyncMaxAgeDays&quot;);</span>
<a href="#l54.133"></a><span id="l54.133" class="difflineplus">+</span>
<a href="#l54.134"></a><span id="l54.134" class="difflineplus">+  // If we're not done initializing, don't do anything.</span>
<a href="#l54.135"></a><span id="l54.135" class="difflineplus">+  // (See initDownloadSettings() for more details.)</span>
<a href="#l54.136"></a><span id="l54.136" class="difflineplus">+  if (autosyncPref.value == &quot;&quot;)</span>
<a href="#l54.137"></a><span id="l54.137" class="difflineplus">+    return;</span>
<a href="#l54.138"></a><span id="l54.138" class="difflineplus">+</span>
<a href="#l54.139"></a><span id="l54.139" class="difflineplus">+  // If the user selected the All option, disable the autosync and the</span>
<a href="#l54.140"></a><span id="l54.140" class="difflineplus">+  // textbox.</span>
<a href="#l54.141"></a><span id="l54.141" class="difflineplus">+  if (autosyncInterval.value == 0) {</span>
<a href="#l54.142"></a><span id="l54.142" class="difflineplus">+    autosyncPref.value = 0;</span>
<a href="#l54.143"></a><span id="l54.143" class="difflineplus">+    autosyncValue.disabled = true;</span>
<a href="#l54.144"></a><span id="l54.144" class="difflineplus">+    return;</span>
<a href="#l54.145"></a><span id="l54.145" class="difflineplus">+  }</span>
<a href="#l54.146"></a><span id="l54.146" class="difflineplus">+</span>
<a href="#l54.147"></a><span id="l54.147" class="difflineplus">+  let max = 0x7FFFFFFF / (60 * 60 * 24 * autosyncInterval.value);</span>
<a href="#l54.148"></a><span id="l54.148" class="difflineplus">+  autosyncValue.setAttribute(&quot;max&quot;, max);</span>
<a href="#l54.149"></a><span id="l54.149" class="difflineplus">+  if (autosyncValue.value &gt; max)</span>
<a href="#l54.150"></a><span id="l54.150" class="difflineplus">+    autosyncValue.value = Math.floor(max);</span>
<a href="#l54.151"></a><span id="l54.151" class="difflineplus">+</span>
<a href="#l54.152"></a><span id="l54.152" class="difflineplus">+  autosyncValue.disabled = false;</span>
<a href="#l54.153"></a><span id="l54.153" class="difflineplus">+  autosyncPref.value = autosyncValue.value * autosyncInterval.value;</span>
<a href="#l54.154"></a><span id="l54.154" class="difflineplus">+}</span>
<a href="#l54.155"></a><span id="l54.155" class="difflineplus">+</span>
<a href="#l54.156"></a><span id="l54.156"> function onCancel()</span>
<a href="#l54.157"></a><span id="l54.157"> {</span>
<a href="#l54.158"></a><span id="l54.158">     // restore the offline flags for all folders</span>
<a href="#l54.159"></a><span id="l54.159">     restoreOfflineFolders(gOfflineMap);</span>
<a href="#l54.160"></a><span id="l54.160">     return true;</span>
<a href="#l54.161"></a><span id="l54.161"> }</span>
<a href="#l54.162"></a><span id="l54.162"> </span>
<a href="#l54.163"></a><span id="l54.163"> function onSave()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-offline.xul</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-offline.xul</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -49,16 +49,19 @@</span>
<a href="#l55.4"></a><span id="l55.4"> </span>
<a href="#l55.5"></a><span id="l55.5">     &lt;stringbundle id=&quot;bundle_prefs&quot; src=&quot;chrome://messenger/locale/prefs.properties&quot;/&gt; </span>
<a href="#l55.6"></a><span id="l55.6"> </span>
<a href="#l55.7"></a><span id="l55.7">     &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/AccountManager.js&quot;/&gt;</span>
<a href="#l55.8"></a><span id="l55.8">     &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/retention.js&quot;/&gt;</span>
<a href="#l55.9"></a><span id="l55.9">     &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/am-offline.js&quot;/&gt;</span>
<a href="#l55.10"></a><span id="l55.10"> </span>
<a href="#l55.11"></a><span id="l55.11">     &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;server.type&quot;/&gt;  </span>
<a href="#l55.12"></a><span id="l55.12" class="difflineplus">+    &lt;label id=&quot;imap.autoSyncMaxAgeDays&quot; hidden=&quot;true&quot;</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineplus">+           wsm_persist=&quot;true&quot; preftype=&quot;int&quot;</span>
<a href="#l55.14"></a><span id="l55.14" class="difflineplus">+           prefstring=&quot;mail.server.%serverkey%.autosync_max_age_days&quot;/&gt;</span>
<a href="#l55.15"></a><span id="l55.15"> </span>
<a href="#l55.16"></a><span id="l55.16">     &lt;dialogheader id=&quot;headertitle&quot;/&gt;</span>
<a href="#l55.17"></a><span id="l55.17"> </span>
<a href="#l55.18"></a><span id="l55.18">     &lt;groupbox id=&quot;offline.titlebox&quot; hidefor=&quot;movemail,pop3,none,rss&quot;&gt;</span>
<a href="#l55.19"></a><span id="l55.19">       &lt;caption label=&quot;&amp;syncGroupTitle.label;&quot;/&gt;</span>
<a href="#l55.20"></a><span id="l55.20"> </span>
<a href="#l55.21"></a><span id="l55.21">     &lt;checkbox hidefor=&quot;movemail,pop3,nntp,none&quot; </span>
<a href="#l55.22"></a><span id="l55.22">               id=&quot;offline.folders&quot; label=&quot;&amp;allFoldersOffline.label;&quot;</span>
<a href="#l55.23"></a><span id="l55.23" class="difflineat">@@ -77,43 +80,67 @@</span>
<a href="#l55.24"></a><span id="l55.24">                 oncommand=&quot;onClickSelect()&quot; id=&quot;selectNewsgroupsButton&quot; class=&quot;selectForOfflineUseButton&quot;/&gt;</span>
<a href="#l55.25"></a><span id="l55.25">     &lt;/hbox&gt;</span>
<a href="#l55.26"></a><span id="l55.26"> </span>
<a href="#l55.27"></a><span id="l55.27">     &lt;/groupbox&gt;</span>
<a href="#l55.28"></a><span id="l55.28"> </span>
<a href="#l55.29"></a><span id="l55.29">     &lt;groupbox id=&quot;diskspace.titlebox&quot;&gt;</span>
<a href="#l55.30"></a><span id="l55.30">       &lt;caption label=&quot;&amp;diskspaceGroupTitle.label;&quot; hidefor=&quot;movemail,pop3,none,rss&quot;/&gt;</span>
<a href="#l55.31"></a><span id="l55.31"> </span>
<a href="#l55.32"></a><span id="l55.32" class="difflineplus">+    &lt;!-- IMAP Autosync Preference --&gt;</span>
<a href="#l55.33"></a><span id="l55.33" class="difflineplus">+    &lt;hbox align=&quot;center&quot; hidefor=&quot;movemail,pop3,nntp,none,rss&quot;&gt;</span>
<a href="#l55.34"></a><span id="l55.34" class="difflineplus">+      &lt;label id=&quot;useAutosyncBefore&quot;&gt;&amp;useAutosyncBefore.label;&lt;/label&gt;</span>
<a href="#l55.35"></a><span id="l55.35" class="difflineplus">+      &lt;textbox id=&quot;autosyncValue&quot; type=&quot;number&quot; size=&quot;5&quot; min=&quot;1&quot;</span>
<a href="#l55.36"></a><span id="l55.36" class="difflineplus">+               class=&quot;autosync&quot; onchange=&quot;onAutosyncChange();&quot;</span>
<a href="#l55.37"></a><span id="l55.37" class="difflineplus">+               aria-labelledby=&quot;useAutosyncBefore autosyncValue useAutosyncMiddle autosyncInterval useAutosyncAfter&quot;/&gt;</span>
<a href="#l55.38"></a><span id="l55.38" class="difflineplus">+      &lt;label id=&quot;useAutosyncMiddle&quot;&gt;&amp;useAutosyncMiddle.label;&lt;/label&gt;</span>
<a href="#l55.39"></a><span id="l55.39" class="difflineplus">+      &lt;menulist id=&quot;autosyncInterval&quot; onselect=&quot;onAutosyncChange();&quot;&gt;</span>
<a href="#l55.40"></a><span id="l55.40" class="difflineplus">+        &lt;menupopup&gt;</span>
<a href="#l55.41"></a><span id="l55.41" class="difflineplus">+          &lt;menuitem label=&quot;&amp;allInterval.label;&quot; value=&quot;0&quot;/&gt;</span>
<a href="#l55.42"></a><span id="l55.42" class="difflineplus">+          &lt;menuitem label=&quot;&amp;dayInterval.label;&quot; value=&quot;1&quot;/&gt;</span>
<a href="#l55.43"></a><span id="l55.43" class="difflineplus">+          &lt;menuitem label=&quot;&amp;weekInterval.label;&quot; value=&quot;7&quot;/&gt;</span>
<a href="#l55.44"></a><span id="l55.44" class="difflineplus">+          &lt;menuitem label=&quot;&amp;monthInterval.label;&quot; value=&quot;31&quot;/&gt;</span>
<a href="#l55.45"></a><span id="l55.45" class="difflineplus">+          &lt;menuitem label=&quot;&amp;yearInterval.label;&quot; value=&quot;365&quot;/&gt;</span>
<a href="#l55.46"></a><span id="l55.46" class="difflineplus">+        &lt;/menupopup&gt;</span>
<a href="#l55.47"></a><span id="l55.47" class="difflineplus">+      &lt;/menulist&gt;</span>
<a href="#l55.48"></a><span id="l55.48" class="difflineplus">+      &lt;label id=&quot;useAutosyncAfter&quot; control=&quot;autosyncValue&quot;</span>
<a href="#l55.49"></a><span id="l55.49" class="difflineplus">+             flex=&quot;1&quot;&gt;&amp;useAutosyncAfter.label;&lt;/label&gt;</span>
<a href="#l55.50"></a><span id="l55.50" class="difflineplus">+    &lt;/hbox&gt;</span>
<a href="#l55.51"></a><span id="l55.51" class="difflineplus">+</span>
<a href="#l55.52"></a><span id="l55.52">     &lt;description hidefor=&quot;pop3,movemail,none,rss&quot;&gt;&amp;doNotDownload.label;&lt;/description&gt;</span>
<a href="#l55.53"></a><span id="l55.53">     &lt;description hidefor=&quot;imap,nntp,none,rss&quot;&gt;&amp;doNotDownloadPop3Movemail.label;&lt;/description&gt;</span>
<a href="#l55.54"></a><span id="l55.54"> </span>
<a href="#l55.55"></a><span id="l55.55">     &lt;hbox align=&quot;center&quot; class=&quot;indent&quot; hidefor=&quot;rss&quot;&gt;</span>
<a href="#l55.56"></a><span id="l55.56">         &lt;checkbox hidefor=&quot;movemail,pop3,imap,none&quot;</span>
<a href="#l55.57"></a><span id="l55.57">                   id=&quot;nntp.notDownloadRead&quot; wsm_persist=&quot;true&quot;</span>
<a href="#l55.58"></a><span id="l55.58" class="difflineminus">-                  label=&quot;&amp;nntpNotDownloadRead.label;&quot; accesskey=&quot;&amp;nntpNotDownloadRead.accesskey;&quot;/&gt;</span>
<a href="#l55.59"></a><span id="l55.59" class="difflineplus">+                  label=&quot;&amp;nntpNotDownloadRead.label;&quot;</span>
<a href="#l55.60"></a><span id="l55.60" class="difflineplus">+                  accesskey=&quot;&amp;nntpNotDownloadRead.accesskey;&quot;/&gt;</span>
<a href="#l55.61"></a><span id="l55.61">     &lt;/hbox&gt;</span>
<a href="#l55.62"></a><span id="l55.62"> </span>
<a href="#l55.63"></a><span id="l55.63">     &lt;hbox align=&quot;center&quot; class=&quot;indent&quot; hidefor=&quot;none,rss&quot;&gt;</span>
<a href="#l55.64"></a><span id="l55.64">         &lt;checkbox wsm_persist=&quot;true&quot; id=&quot;offline.notDownload&quot;</span>
<a href="#l55.65"></a><span id="l55.65" class="difflineminus">-                  label=&quot;&amp;offlineNotDownload.label;&quot; accesskey=&quot;&amp;offlineNotDownload.accesskey;&quot;</span>
<a href="#l55.66"></a><span id="l55.66" class="difflineplus">+                  label=&quot;&amp;offlineNotDownload.label;&quot;</span>
<a href="#l55.67"></a><span id="l55.67" class="difflineplus">+                  accesskey=&quot;&amp;offlineNotDownload.accesskey;&quot;</span>
<a href="#l55.68"></a><span id="l55.68">                   oncommand=&quot;onCheckItem('offline.notDownloadMin', 'offline.notDownload');&quot;/&gt;</span>
<a href="#l55.69"></a><span id="l55.69">         &lt;textbox wsm_persist=&quot;true&quot; id=&quot;offline.notDownloadMin&quot;</span>
<a href="#l55.70"></a><span id="l55.70">                  type=&quot;number&quot; min=&quot;1&quot; increment=&quot;10&quot; size=&quot;4&quot; value=&quot;50&quot;</span>
<a href="#l55.71"></a><span id="l55.71">                  aria-labelledby=&quot;offline.notDownload offline.notDownloadMin kbLabel&quot;/&gt;</span>
<a href="#l55.72"></a><span id="l55.72">         &lt;label value=&quot;&amp;kb.label;&quot; control=&quot;offline.notDownloadMin&quot; id=&quot;kbLabel&quot;/&gt;</span>
<a href="#l55.73"></a><span id="l55.73">     &lt;/hbox&gt;</span>
<a href="#l55.74"></a><span id="l55.74"> </span>
<a href="#l55.75"></a><span id="l55.75">     &lt;hbox align=&quot;center&quot; class=&quot;indent&quot; hidefor=&quot;movemail,pop3,imap,none,rss&quot;&gt;</span>
<a href="#l55.76"></a><span id="l55.76">         &lt;checkbox wsm_persist=&quot;true&quot; id=&quot;nntp.downloadMsg&quot;</span>
<a href="#l55.77"></a><span id="l55.77" class="difflineminus">-                  label=&quot;&amp;nntpDownloadMsg.label;&quot; accesskey=&quot;&amp;nntpDownloadMsg.accesskey;&quot;</span>
<a href="#l55.78"></a><span id="l55.78" class="difflineplus">+                  label=&quot;&amp;nntpDownloadMsg.label;&quot;</span>
<a href="#l55.79"></a><span id="l55.79" class="difflineplus">+                  accesskey=&quot;&amp;nntpDownloadMsg.accesskey;&quot;</span>
<a href="#l55.80"></a><span id="l55.80">                   oncommand=&quot;onCheckItem('nntp.downloadMsgMin', 'nntp.downloadMsg');&quot;/&gt;</span>
<a href="#l55.81"></a><span id="l55.81">         &lt;textbox wsm_persist=&quot;true&quot; id=&quot;nntp.downloadMsgMin&quot;</span>
<a href="#l55.82"></a><span id="l55.82">                  type=&quot;number&quot; min=&quot;1&quot; size=&quot;2&quot; value=&quot;30&quot;</span>
<a href="#l55.83"></a><span id="l55.83">                  aria-labelledby=&quot;nntp.downloadMsg nntp.downloadMsgMin daysOldLabel&quot;/&gt;</span>
<a href="#l55.84"></a><span id="l55.84" class="difflineminus">-        &lt;label value=&quot;&amp;daysOld.label;&quot; control=&quot;nntp.downloadMsgMin&quot; id=&quot;daysOldLabel&quot;/&gt;</span>
<a href="#l55.85"></a><span id="l55.85" class="difflineplus">+        &lt;label value=&quot;&amp;daysOld.label;&quot; control=&quot;nntp.downloadMsgMin&quot;</span>
<a href="#l55.86"></a><span id="l55.86" class="difflineplus">+               id=&quot;daysOldLabel&quot;/&gt;</span>
<a href="#l55.87"></a><span id="l55.87">     &lt;/hbox&gt;</span>
<a href="#l55.88"></a><span id="l55.88"> </span>
<a href="#l55.89"></a><span id="l55.89">     &lt;vbox align=&quot;start&quot;&gt;</span>
<a href="#l55.90"></a><span id="l55.90">     &lt;separator hidefor=&quot;none,rss&quot;/&gt;</span>
<a href="#l55.91"></a><span id="l55.91">     &lt;label id=&quot;retentionDescription&quot; hidefor=&quot;imap,pop3&quot; class=&quot;desc&quot; control=&quot;retention.keepMsg&quot;&gt;&amp;retentionCleanup.label;&lt;/label&gt;</span>
<a href="#l55.92"></a><span id="l55.92">     &lt;label id=&quot;retentionDescriptionImap&quot; hidefor=&quot;movemail,pop3,nntp,none,rss&quot; class=&quot;desc&quot; control=&quot;retention.keepMsg&quot;&gt;&amp;retentionCleanupImap.label;&lt;/label&gt;</span>
<a href="#l55.93"></a><span id="l55.93">     &lt;label id=&quot;retentionDescriptionPop&quot; hidefor=&quot;movemail,imap,nntp,none,rss&quot; class=&quot;desc&quot; control=&quot;retention.keepMsg&quot;&gt;&amp;retentionCleanupPop.label;&lt;/label&gt;</span>
<a href="#l55.94"></a><span id="l55.94"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgSearchSession.cpp</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgSearchSession.cpp</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -488,16 +488,17 @@ nsresult nsMsgSearchSession::GetNextUrl(</span>
<a href="#l56.4"></a><span id="l56.4">   nsCOMPtr&lt;nsIMsgWindow&gt; msgWindow(do_QueryReferent(m_msgWindowWeak));</span>
<a href="#l56.5"></a><span id="l56.5">   if (msgWindow)</span>
<a href="#l56.6"></a><span id="l56.6">     msgWindow-&gt;GetStopped(&amp;stopped);</span>
<a href="#l56.7"></a><span id="l56.7">   if (stopped)</span>
<a href="#l56.8"></a><span id="l56.8">     return NS_OK;</span>
<a href="#l56.9"></a><span id="l56.9"> </span>
<a href="#l56.10"></a><span id="l56.10">   m_urlQueue.CStringAt(m_urlQueueIndex, nextUrl);</span>
<a href="#l56.11"></a><span id="l56.11">   nsMsgSearchScopeTerm *currentTerm = GetRunningScope();</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineplus">+  NS_ENSURE_TRUE(currentTerm, NS_ERROR_NULL_POINTER);</span>
<a href="#l56.13"></a><span id="l56.13">   EnableFolderNotifications(PR_FALSE);</span>
<a href="#l56.14"></a><span id="l56.14">   nsCOMPtr &lt;nsIMsgFolder&gt; folder = currentTerm-&gt;m_folder;</span>
<a href="#l56.15"></a><span id="l56.15">   if (folder)</span>
<a href="#l56.16"></a><span id="l56.16">   {</span>
<a href="#l56.17"></a><span id="l56.17">     nsCString folderUri;</span>
<a href="#l56.18"></a><span id="l56.18">     folder-&gt;GetURI(folderUri);</span>
<a href="#l56.19"></a><span id="l56.19">     nsresult rv = GetMessageServiceFromURI(folderUri, getter_AddRefs(msgService));</span>
<a href="#l56.20"></a><span id="l56.20"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_imapFilterActions.js</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_imapFilterActions.js</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -419,20 +419,18 @@ function testContinue(source)</span>
<a href="#l57.4"></a><span id="l57.4">     if (gContinueListener == kDeleteOrMoveMsgCompleted &amp;&amp;</span>
<a href="#l57.5"></a><span id="l57.5">         gAction.type == Ci.nsMsgFilterAction.MoveToFolder)</span>
<a href="#l57.6"></a><span id="l57.6">     {</span>
<a href="#l57.7"></a><span id="l57.7">       // Moves give 2 events, just use the second.</span>
<a href="#l57.8"></a><span id="l57.8">       gMoveCallbackCount++;</span>
<a href="#l57.9"></a><span id="l57.9">       if (gMoveCallbackCount != 2)</span>
<a href="#l57.10"></a><span id="l57.10">         return;</span>
<a href="#l57.11"></a><span id="l57.11">     }</span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-    if (gChecks)</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineminus">-      gChecks();</span>
<a href="#l57.14"></a><span id="l57.14">     gCurTestNum++;</span>
<a href="#l57.15"></a><span id="l57.15" class="difflineminus">-    do_timeout(100, &quot;doTest();&quot;);</span>
<a href="#l57.16"></a><span id="l57.16" class="difflineplus">+    do_timeout(200, &quot;doTest();&quot;);</span>
<a href="#l57.17"></a><span id="l57.17">   }</span>
<a href="#l57.18"></a><span id="l57.18"> }</span>
<a href="#l57.19"></a><span id="l57.19"> </span>
<a href="#l57.20"></a><span id="l57.20"> // basic preparation done for each test</span>
<a href="#l57.21"></a><span id="l57.21"> function setupTest(aFilter, aAction)</span>
<a href="#l57.22"></a><span id="l57.22"> {</span>
<a href="#l57.23"></a><span id="l57.23">   if (aAction &amp;&amp;</span>
<a href="#l57.24"></a><span id="l57.24">       ((aAction.type == Ci.nsMsgFilterAction.CopyToFolder) ||</span>
<a href="#l57.25"></a><span id="l57.25" class="difflineat">@@ -471,16 +469,20 @@ function setupTest(aFilter, aAction)</span>
<a href="#l57.26"></a><span id="l57.26">   gIMAPMailbox.addMessage(new imapMessage(specForFileName(gMessage),</span>
<a href="#l57.27"></a><span id="l57.27">                           gIMAPMailbox.uidnext++, []));</span>
<a href="#l57.28"></a><span id="l57.28">   gIMAPInbox.updateFolderWithListener(null, URLListener);</span>
<a href="#l57.29"></a><span id="l57.29"> }</span>
<a href="#l57.30"></a><span id="l57.30"> </span>
<a href="#l57.31"></a><span id="l57.31"> // run the next test</span>
<a href="#l57.32"></a><span id="l57.32"> function doTest()</span>
<a href="#l57.33"></a><span id="l57.33"> {</span>
<a href="#l57.34"></a><span id="l57.34" class="difflineplus">+  // Run the checks, if any, from the previous test.</span>
<a href="#l57.35"></a><span id="l57.35" class="difflineplus">+  if (gChecks)</span>
<a href="#l57.36"></a><span id="l57.36" class="difflineplus">+    gChecks();</span>
<a href="#l57.37"></a><span id="l57.37" class="difflineplus">+</span>
<a href="#l57.38"></a><span id="l57.38">   test = gCurTestNum;</span>
<a href="#l57.39"></a><span id="l57.39">   if (test &lt;= gTestArray.length)</span>
<a href="#l57.40"></a><span id="l57.40">   {</span>
<a href="#l57.41"></a><span id="l57.41"> </span>
<a href="#l57.42"></a><span id="l57.42">     var testFn = gTestArray[test-1];</span>
<a href="#l57.43"></a><span id="l57.43">     dump(&quot;Doing test &quot; + test + &quot; &quot; + testFn.name + &quot;\n&quot;);</span>
<a href="#l57.44"></a><span id="l57.44">     // Set a limit of ten seconds; if the notifications haven't arrived by then there's a problem.</span>
<a href="#l57.45"></a><span id="l57.45">     do_timeout(10000, &quot;if (gCurTestNum == &quot;+test+&quot;) \</span>
<a href="#l57.46"></a><span id="l57.46" class="difflineat">@@ -751,18 +753,24 @@ function testCounts(aHasNew, aUnreadDelt</span>
<a href="#l57.47"></a><span id="l57.47">        &quot; unread: &quot; + unread +</span>
<a href="#l57.48"></a><span id="l57.48">        &quot; folderNew: &quot; + folderNew +</span>
<a href="#l57.49"></a><span id="l57.49">        &quot; folderNewFlag: &quot; + folderNewFlag +</span>
<a href="#l57.50"></a><span id="l57.50">        &quot; dbNew: &quot; + dbNew +</span>
<a href="#l57.51"></a><span id="l57.51">        &quot;\n&quot;);</span>
<a href="#l57.52"></a><span id="l57.52">   do_check_eq(aHasNew, hasNew);</span>
<a href="#l57.53"></a><span id="l57.53">   do_check_eq(aUnreadDelta, unread - gPreviousUnread);</span>
<a href="#l57.54"></a><span id="l57.54">   gPreviousUnread = unread;</span>
<a href="#l57.55"></a><span id="l57.55" class="difflineminus">-  // this seems to be rest for each folder update</span>
<a href="#l57.56"></a><span id="l57.56" class="difflineminus">-  do_check_eq(aFolderNewDelta, folderNew);</span>
<a href="#l57.57"></a><span id="l57.57" class="difflineplus">+  // This seems to be reset for each folder update.</span>
<a href="#l57.58"></a><span id="l57.58" class="difflineplus">+  //</span>
<a href="#l57.59"></a><span id="l57.59" class="difflineplus">+  // This check seems to be failing in SeaMonkey builds, yet I can see no ill</span>
<a href="#l57.60"></a><span id="l57.60" class="difflineplus">+  // effects of this in the actual program. Fixing this is complex because of</span>
<a href="#l57.61"></a><span id="l57.61" class="difflineplus">+  // the messiness of new count management (see bug 507638 for a</span>
<a href="#l57.62"></a><span id="l57.62" class="difflineplus">+  // refactoring proposal, and attachment 398899 on bug 514801 for one possible</span>
<a href="#l57.63"></a><span id="l57.63" class="difflineplus">+  // fix to this particular test). So I am disabling this.</span>
<a href="#l57.64"></a><span id="l57.64" class="difflineplus">+  //do_check_eq(aFolderNewDelta, folderNew);</span>
<a href="#l57.65"></a><span id="l57.65">   do_check_eq(aDbNewDelta, dbNew - gPreviousDbNew);</span>
<a href="#l57.66"></a><span id="l57.66">   gPreviousDbNew = dbNew;</span>
<a href="#l57.67"></a><span id="l57.67">   } catch (e) {dump(e);}</span>
<a href="#l57.68"></a><span id="l57.68"> }</span>
<a href="#l57.69"></a><span id="l57.69"> </span>
<a href="#l57.70"></a><span id="l57.70"> // print the counts for debugging purposes in this test</span>
<a href="#l57.71"></a><span id="l57.71"> function printListener(listener)</span>
<a href="#l57.72"></a><span id="l57.72"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/suite/common/pref/pref-search.xul</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/suite/common/pref/pref-search.xul</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -72,17 +72,18 @@</span>
<a href="#l58.4"></a><span id="l58.4">         &lt;menulist id=&quot;engineList&quot;</span>
<a href="#l58.5"></a><span id="l58.5">                   ref=&quot;&quot;</span>
<a href="#l58.6"></a><span id="l58.6">                   datasources=&quot;rdf:internetsearch&quot;</span>
<a href="#l58.7"></a><span id="l58.7">                   sortResource=&quot;http://home.netscape.com/NC-rdf#Name&quot;</span>
<a href="#l58.8"></a><span id="l58.8">                   sortDirection=&quot;ascending&quot;</span>
<a href="#l58.9"></a><span id="l58.9">                   preference=&quot;browser.search.defaultengine&quot;&gt;</span>
<a href="#l58.10"></a><span id="l58.10">           &lt;template&gt;</span>
<a href="#l58.11"></a><span id="l58.11">             &lt;menupopup&gt;</span>
<a href="#l58.12"></a><span id="l58.12" class="difflineminus">-              &lt;menuitem value=&quot;...&quot;</span>
<a href="#l58.13"></a><span id="l58.13" class="difflineplus">+              &lt;menuitem class=&quot;menuitem-iconic&quot;</span>
<a href="#l58.14"></a><span id="l58.14" class="difflineplus">+                        value=&quot;...&quot;</span>
<a href="#l58.15"></a><span id="l58.15">                         uri=&quot;...&quot;</span>
<a href="#l58.16"></a><span id="l58.16">                         image=&quot;rdf:http://home.netscape.com/NC-rdf#Icon&quot;</span>
<a href="#l58.17"></a><span id="l58.17">                         label=&quot;rdf:http://home.netscape.com/NC-rdf#Name&quot;/&gt;</span>
<a href="#l58.18"></a><span id="l58.18">             &lt;/menupopup&gt;</span>
<a href="#l58.19"></a><span id="l58.19">           &lt;/template&gt;</span>
<a href="#l58.20"></a><span id="l58.20">         &lt;/menulist&gt;</span>
<a href="#l58.21"></a><span id="l58.21">       &lt;/hbox&gt;</span>
<a href="#l58.22"></a><span id="l58.22">     &lt;/groupbox&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/suite/locales/en-US/chrome/common/help/shortcuts-mailnews.xhtml</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/common/help/shortcuts-mailnews.xhtml</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -66,25 +66,25 @@</span>
<a href="#l59.4"></a><span id="l59.4">   &lt;tr&gt;</span>
<a href="#l59.5"></a><span id="l59.5">     &lt;td&gt;New Message&lt;/td&gt;</span>
<a href="#l59.6"></a><span id="l59.6">     &lt;td&gt;Ctrl+M&lt;/td&gt;</span>
<a href="#l59.7"></a><span id="l59.7">     &lt;td&gt;Cmd+Shift+M&lt;/td&gt;</span>
<a href="#l59.8"></a><span id="l59.8">     &lt;td&gt;Ctrl+M&lt;/td&gt;</span>
<a href="#l59.9"></a><span id="l59.9">   &lt;/tr&gt;</span>
<a href="#l59.10"></a><span id="l59.10">   &lt;tr&gt;</span>
<a href="#l59.11"></a><span id="l59.11">     &lt;td&gt;Get New Messages&lt;/td&gt;</span>
<a href="#l59.12"></a><span id="l59.12" class="difflineminus">-    &lt;td&gt;Ctrl+T&lt;/td&gt;</span>
<a href="#l59.13"></a><span id="l59.13" class="difflineminus">-    &lt;td&gt;Cmd+T&lt;/td&gt;</span>
<a href="#l59.14"></a><span id="l59.14" class="difflineminus">-    &lt;td&gt;Ctrl+T&lt;/td&gt;</span>
<a href="#l59.15"></a><span id="l59.15" class="difflineplus">+    &lt;td&gt;Ctrl+D&lt;/td&gt;</span>
<a href="#l59.16"></a><span id="l59.16" class="difflineplus">+    &lt;td&gt;Cmd+D&lt;/td&gt;</span>
<a href="#l59.17"></a><span id="l59.17" class="difflineplus">+    &lt;td&gt;Ctrl+D&lt;/td&gt;</span>
<a href="#l59.18"></a><span id="l59.18">   &lt;/tr&gt;</span>
<a href="#l59.19"></a><span id="l59.19">   &lt;tr&gt;</span>
<a href="#l59.20"></a><span id="l59.20">     &lt;td&gt;Get All New Messages&lt;/td&gt;</span>
<a href="#l59.21"></a><span id="l59.21" class="difflineminus">-    &lt;td&gt;Ctrl+Shift+T&lt;/td&gt;</span>
<a href="#l59.22"></a><span id="l59.22" class="difflineminus">-    &lt;td&gt;Cmd+Shift+T&lt;/td&gt;</span>
<a href="#l59.23"></a><span id="l59.23" class="difflineminus">-    &lt;td&gt;Ctrl+Shift+T&lt;/td&gt;</span>
<a href="#l59.24"></a><span id="l59.24" class="difflineplus">+    &lt;td&gt;Ctrl+Shift+D&lt;/td&gt;</span>
<a href="#l59.25"></a><span id="l59.25" class="difflineplus">+    &lt;td&gt;Cmd+Shift+D&lt;/td&gt;</span>
<a href="#l59.26"></a><span id="l59.26" class="difflineplus">+    &lt;td&gt;Ctrl+Shift+D&lt;/td&gt;</span>
<a href="#l59.27"></a><span id="l59.27">   &lt;/tr&gt;</span>
<a href="#l59.28"></a><span id="l59.28">   &lt;tr&gt;</span>
<a href="#l59.29"></a><span id="l59.29">     &lt;td&gt;Search Messages&lt;/td&gt;</span>
<a href="#l59.30"></a><span id="l59.30">     &lt;td&gt;Ctrl+Shift+S&lt;/td&gt;</span>
<a href="#l59.31"></a><span id="l59.31">     &lt;td&gt;Cmd+Shift+S&lt;/td&gt;</span>
<a href="#l59.32"></a><span id="l59.32">     &lt;td&gt;Ctrl+Shift+S&lt;/td&gt;</span>
<a href="#l59.33"></a><span id="l59.33">   &lt;/tr&gt;</span>
<a href="#l59.34"></a><span id="l59.34"> &lt;/tbody&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1" class="difflineminus">--- a/suite/locales/en-US/chrome/common/help/shortcuts.xhtml</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/common/help/shortcuts.xhtml</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineat">@@ -167,16 +167,22 @@</span>
<a href="#l60.4"></a><span id="l60.4">   &lt;/tr&gt;</span>
<a href="#l60.5"></a><span id="l60.5">   &lt;tr&gt;</span>
<a href="#l60.6"></a><span id="l60.6">     &lt;td&gt;Redo&lt;/td&gt;</span>
<a href="#l60.7"></a><span id="l60.7">     &lt;td&gt;Ctrl+Y or Ctrl+Shift+Z&lt;/td&gt;</span>
<a href="#l60.8"></a><span id="l60.8">     &lt;td&gt;Cmd+Shift+Z&lt;/td&gt;</span>
<a href="#l60.9"></a><span id="l60.9">     &lt;td&gt;Ctrl+Y or Ctrl+Shift+Z&lt;/td&gt;</span>
<a href="#l60.10"></a><span id="l60.10">   &lt;/tr&gt;</span>
<a href="#l60.11"></a><span id="l60.11">   &lt;tr&gt;</span>
<a href="#l60.12"></a><span id="l60.12" class="difflineplus">+    &lt;td&gt;Focus Search Field&lt;/td&gt;</span>
<a href="#l60.13"></a><span id="l60.13" class="difflineplus">+    &lt;td&gt;Ctrl+F or Ctrl+K&lt;/td&gt;</span>
<a href="#l60.14"></a><span id="l60.14" class="difflineplus">+    &lt;td&gt;Cmd+F or Cmd+K&lt;/td&gt;</span>
<a href="#l60.15"></a><span id="l60.15" class="difflineplus">+    &lt;td&gt;Ctrl+F or Ctrl+K&lt;/td&gt;</span>
<a href="#l60.16"></a><span id="l60.16" class="difflineplus">+  &lt;/tr&gt;</span>
<a href="#l60.17"></a><span id="l60.17" class="difflineplus">+  &lt;tr&gt;</span>
<a href="#l60.18"></a><span id="l60.18">     &lt;td&gt;Find&lt;/td&gt;</span>
<a href="#l60.19"></a><span id="l60.19">     &lt;td&gt;Ctrl+F&lt;/td&gt;</span>
<a href="#l60.20"></a><span id="l60.20">     &lt;td&gt;Cmd+F&lt;/td&gt;</span>
<a href="#l60.21"></a><span id="l60.21">     &lt;td&gt;Ctrl+F&lt;/td&gt;</span>
<a href="#l60.22"></a><span id="l60.22">   &lt;/tr&gt;</span>
<a href="#l60.23"></a><span id="l60.23">   &lt;tr&gt;</span>
<a href="#l60.24"></a><span id="l60.24">     &lt;td&gt;Find Again&lt;/td&gt;</span>
<a href="#l60.25"></a><span id="l60.25">     &lt;td&gt;Ctrl+G or F3&lt;/td&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/pref/am-offline.dtd</span>
<a href="#l61.2"></a><span id="l61.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/pref/am-offline.dtd</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineat">@@ -27,8 +27,23 @@</span>
<a href="#l61.4"></a><span id="l61.4"> &lt;!ENTITY nntpRemoveMsgBody.label &quot;Remove bodies from messages more than&quot;&gt;</span>
<a href="#l61.5"></a><span id="l61.5"> &lt;!ENTITY nntpRemoveMsgBody.accesskey &quot;o&quot;&gt;</span>
<a href="#l61.6"></a><span id="l61.6"> &lt;!ENTITY offlineSelectNntp.label &quot;Select newsgroups for offline use&quot;&gt;</span>
<a href="#l61.7"></a><span id="l61.7"> &lt;!ENTITY offlineSelectNntp.accesskey &quot;S&quot;&gt;</span>
<a href="#l61.8"></a><span id="l61.8"> &lt;!ENTITY offlineImapAdvancedOffline.label &quot;Advanced&quot;&gt;</span>
<a href="#l61.9"></a><span id="l61.9"> &lt;!ENTITY offlineImapAdvancedOffline.accesskey &quot;v&quot;&gt;</span>
<a href="#l61.10"></a><span id="l61.10"> &lt;!ENTITY syncGroupTitle.label &quot;Message Synchronizing&quot;&gt;</span>
<a href="#l61.11"></a><span id="l61.11"> &lt;!ENTITY diskspaceGroupTitle.label &quot;Disk Space&quot;&gt;</span>
<a href="#l61.12"></a><span id="l61.12" class="difflineplus">+</span>
<a href="#l61.13"></a><span id="l61.13" class="difflineplus">+&lt;!-- LOCALIZATION NOTE: (useAutosyncBefore.label, useAutosyncMiddle.label, useAutosyncAfter.label):</span>
<a href="#l61.14"></a><span id="l61.14" class="difflineplus">+  The entities useAutosyncBefore.label, useAutosyncMiddle.label, and</span>
<a href="#l61.15"></a><span id="l61.15" class="difflineplus">+  useAutosyncAfter.label appear on a single line in preferences as follows:</span>
<a href="#l61.16"></a><span id="l61.16" class="difflineplus">+</span>
<a href="#l61.17"></a><span id="l61.17" class="difflineplus">+  &amp;useAutosyncBefore.label [textbox for autosync value] &amp;useAutosyncMiddle.label; [dropdown for autosync interval] &amp;useAutosyncAfter.label;</span>
<a href="#l61.18"></a><span id="l61.18" class="difflineplus">+--&gt;</span>
<a href="#l61.19"></a><span id="l61.19" class="difflineplus">+&lt;!ENTITY useAutosyncBefore.label         &quot;&quot;&gt;</span>
<a href="#l61.20"></a><span id="l61.20" class="difflineplus">+&lt;!ENTITY useAutosyncMiddle.label         &quot;&quot;&gt;</span>
<a href="#l61.21"></a><span id="l61.21" class="difflineplus">+&lt;!ENTITY allInterval.label               &quot;All&quot;&gt;</span>
<a href="#l61.22"></a><span id="l61.22" class="difflineplus">+&lt;!ENTITY dayInterval.label               &quot;Days of&quot;&gt;</span>
<a href="#l61.23"></a><span id="l61.23" class="difflineplus">+&lt;!ENTITY weekInterval.label              &quot;Weeks of&quot;&gt;</span>
<a href="#l61.24"></a><span id="l61.24" class="difflineplus">+&lt;!ENTITY monthInterval.label             &quot;Months of&quot;&gt;</span>
<a href="#l61.25"></a><span id="l61.25" class="difflineplus">+&lt;!ENTITY yearInterval.label              &quot;Years of&quot;&gt;</span>
<a href="#l61.26"></a><span id="l61.26" class="difflineplus">+&lt;!ENTITY useAutosyncAfter.label          &quot;email will be stored on disk&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1" class="difflineminus">--- a/suite/themes/classic/communicator/communicator.css</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineplus">+++ b/suite/themes/classic/communicator/communicator.css</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineat">@@ -96,13 +96,19 @@</span>
<a href="#l62.4"></a><span id="l62.4">   list-style-image: url(&quot;chrome://global/skin/arrow/arrow-dn-dis.gif&quot;);</span>
<a href="#l62.5"></a><span id="l62.5"> }</span>
<a href="#l62.6"></a><span id="l62.6"> </span>
<a href="#l62.7"></a><span id="l62.7"> .sidebarTree {</span>
<a href="#l62.8"></a><span id="l62.8">   border: none;</span>
<a href="#l62.9"></a><span id="l62.9">   margin: 0px !important;</span>
<a href="#l62.10"></a><span id="l62.10"> }</span>
<a href="#l62.11"></a><span id="l62.11"> </span>
<a href="#l62.12"></a><span id="l62.12" class="difflineplus">+/* ::::: iconic menuitems ::::: */</span>
<a href="#l62.13"></a><span id="l62.13" class="difflineplus">+</span>
<a href="#l62.14"></a><span id="l62.14" class="difflineplus">+menuitem.menuitem-iconic &gt; .menu-iconic-left {</span>
<a href="#l62.15"></a><span id="l62.15" class="difflineplus">+  display: -moz-box;</span>
<a href="#l62.16"></a><span id="l62.16" class="difflineplus">+}</span>
<a href="#l62.17"></a><span id="l62.17" class="difflineplus">+</span>
<a href="#l62.18"></a><span id="l62.18"> /* ::::: download manager ::::: */</span>
<a href="#l62.19"></a><span id="l62.19"> </span>
<a href="#l62.20"></a><span id="l62.20"> #downloadView &gt; treechildren::-moz-tree-image(Name) {</span>
<a href="#l62.21"></a><span id="l62.21">   -moz-margin-end: 2px;</span>
<a href="#l62.22"></a><span id="l62.22"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1" class="difflineminus">--- a/suite/themes/classic/editor/EditorDialog.css</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineplus">+++ b/suite/themes/classic/editor/EditorDialog.css</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineat">@@ -33,23 +33,16 @@</span>
<a href="#l63.4"></a><span id="l63.4">  * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l63.5"></a><span id="l63.5">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l63.6"></a><span id="l63.6">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l63.7"></a><span id="l63.7">  *</span>
<a href="#l63.8"></a><span id="l63.8">  * ***** END LICENSE BLOCK ***** */</span>
<a href="#l63.9"></a><span id="l63.9"> </span>
<a href="#l63.10"></a><span id="l63.10"> @namespace url(&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;);</span>
<a href="#l63.11"></a><span id="l63.11"> </span>
<a href="#l63.12"></a><span id="l63.12" class="difflineminus">-/* The defaults are WAY to big! */</span>
<a href="#l63.13"></a><span id="l63.13" class="difflineminus">-groupbox {</span>
<a href="#l63.14"></a><span id="l63.14" class="difflineminus">-  margin:         2px 5px /* 4px 5px */;</span>
<a href="#l63.15"></a><span id="l63.15" class="difflineminus">-  padding-top:    2px;</span>
<a href="#l63.16"></a><span id="l63.16" class="difflineminus">-  padding-bottom: 4px;</span>
<a href="#l63.17"></a><span id="l63.17" class="difflineminus">-}</span>
<a href="#l63.18"></a><span id="l63.18" class="difflineminus">-</span>
<a href="#l63.19"></a><span id="l63.19"> .MinWidth5em {</span>
<a href="#l63.20"></a><span id="l63.20">   min-width: 5em;</span>
<a href="#l63.21"></a><span id="l63.21"> }</span>
<a href="#l63.22"></a><span id="l63.22"> </span>
<a href="#l63.23"></a><span id="l63.23"> .MinWidth10em {</span>
<a href="#l63.24"></a><span id="l63.24">   min-width: 10em;</span>
<a href="#l63.25"></a><span id="l63.25"> }</span>
<a href="#l63.26"></a><span id="l63.26"> </span>
<a href="#l63.27"></a><span id="l63.27" class="difflineat">@@ -80,24 +73,16 @@ groupbox {</span>
<a href="#l63.28"></a><span id="l63.28"> .wrap {</span>
<a href="#l63.29"></a><span id="l63.29">  width: 1em;</span>
<a href="#l63.30"></a><span id="l63.30"> }</span>
<a href="#l63.31"></a><span id="l63.31"> </span>
<a href="#l63.32"></a><span id="l63.32"> .menuitem-highlight-1 {</span>
<a href="#l63.33"></a><span id="l63.33">   font-weight : bold;</span>
<a href="#l63.34"></a><span id="l63.34"> }</span>
<a href="#l63.35"></a><span id="l63.35"> </span>
<a href="#l63.36"></a><span id="l63.36" class="difflineminus">-/* Use this with groove-thin in dialogs </span>
<a href="#l63.37"></a><span id="l63.37" class="difflineminus">-   to add margins to top and bottom</span>
<a href="#l63.38"></a><span id="l63.38" class="difflineminus">-*/</span>
<a href="#l63.39"></a><span id="l63.39" class="difflineminus">-.tb-margin {</span>
<a href="#l63.40"></a><span id="l63.40" class="difflineminus">-  margin-top    : 6px;</span>
<a href="#l63.41"></a><span id="l63.41" class="difflineminus">-  margin-bottom : 6px;</span>
<a href="#l63.42"></a><span id="l63.42" class="difflineminus">-}</span>
<a href="#l63.43"></a><span id="l63.43" class="difflineminus">-</span>
<a href="#l63.44"></a><span id="l63.44"> .color-well {</span>
<a href="#l63.45"></a><span id="l63.45">   width: 20px;</span>
<a href="#l63.46"></a><span id="l63.46">   height: 12px; </span>
<a href="#l63.47"></a><span id="l63.47">   border: 1px inset #CCCCCC;</span>
<a href="#l63.48"></a><span id="l63.48"> }</span>
<a href="#l63.49"></a><span id="l63.49"> </span>
<a href="#l63.50"></a><span id="l63.50"> .color-well[default=&quot;true&quot;] {</span>
<a href="#l63.51"></a><span id="l63.51">   border: 1px solid transparent !important;</span>
<a href="#l63.52"></a><span id="l63.52" class="difflineat">@@ -105,20 +90,16 @@ groupbox {</span>
<a href="#l63.53"></a><span id="l63.53"> }</span>
<a href="#l63.54"></a><span id="l63.54"> </span>
<a href="#l63.55"></a><span id="l63.55"> .color-button {</span>
<a href="#l63.56"></a><span id="l63.56">   /* override large default min-width */</span>
<a href="#l63.57"></a><span id="l63.57">   min-width : 0px;</span>
<a href="#l63.58"></a><span id="l63.58">   margin: 2px;</span>
<a href="#l63.59"></a><span id="l63.59"> }</span>
<a href="#l63.60"></a><span id="l63.60"> </span>
<a href="#l63.61"></a><span id="l63.61" class="difflineminus">-.menu-list[focused=&quot;true&quot;] {</span>
<a href="#l63.62"></a><span id="l63.62" class="difflineminus">-  color: white;</span>
<a href="#l63.63"></a><span id="l63.63" class="difflineminus">-}</span>
<a href="#l63.64"></a><span id="l63.64" class="difflineminus">-</span>
<a href="#l63.65"></a><span id="l63.65"> #ColorPicker {</span>
<a href="#l63.66"></a><span id="l63.66">   -moz-user-focus: normal;</span>
<a href="#l63.67"></a><span id="l63.67"> }</span>
<a href="#l63.68"></a><span id="l63.68"> </span>
<a href="#l63.69"></a><span id="l63.69"> #ColorPickerSwatch {</span>
<a href="#l63.70"></a><span id="l63.70">   border : 2px outset #CCCCCC;</span>
<a href="#l63.71"></a><span id="l63.71">   width: 25px;</span>
<a href="#l63.72"></a><span id="l63.72">   height: 20px;</span>
<a href="#l63.73"></a><span id="l63.73" class="difflineat">@@ -138,36 +119,24 @@ groupbox {</span>
<a href="#l63.74"></a><span id="l63.74">   height: 13px; </span>
<a href="#l63.75"></a><span id="l63.75">   border: 1px inset #CCCCCC;</span>
<a href="#l63.76"></a><span id="l63.76">   margin-top: 1px;</span>
<a href="#l63.77"></a><span id="l63.77">   margin-bottom: 2px;</span>
<a href="#l63.78"></a><span id="l63.78">   -moz-margin-start: 4px;</span>
<a href="#l63.79"></a><span id="l63.79">   -moz-margin-end: 2px;</span>
<a href="#l63.80"></a><span id="l63.80"> }</span>
<a href="#l63.81"></a><span id="l63.81"> </span>
<a href="#l63.82"></a><span id="l63.82" class="difflineminus">-/* temporary -- we need a simple box-based list defined in XBL */</span>
<a href="#l63.83"></a><span id="l63.83" class="difflineminus">-tree.list {</span>
<a href="#l63.84"></a><span id="l63.84" class="difflineminus">-  border: 1px inset #CCCCCC;</span>
<a href="#l63.85"></a><span id="l63.85" class="difflineminus">-  /* same as in menulist.css */</span>
<a href="#l63.86"></a><span id="l63.86" class="difflineminus">-  margin: 1px 5px 2px;</span>
<a href="#l63.87"></a><span id="l63.87" class="difflineminus">-  /* use rows=&quot;#&quot; in XUL to define height */</span>
<a href="#l63.88"></a><span id="l63.88" class="difflineminus">-}</span>
<a href="#l63.89"></a><span id="l63.89" class="difflineminus">-</span>
<a href="#l63.90"></a><span id="l63.90"> #ColorPreview {</span>
<a href="#l63.91"></a><span id="l63.91">   border: 1px inset #CCCCCC;</span>
<a href="#l63.92"></a><span id="l63.92">   -moz-margin-start:    10px;</span>
<a href="#l63.93"></a><span id="l63.93">   padding: 0 5px;</span>
<a href="#l63.94"></a><span id="l63.94">   min-width:     100px;</span>
<a href="#l63.95"></a><span id="l63.95">   min-height:     50px;</span>
<a href="#l63.96"></a><span id="l63.96"> }</span>
<a href="#l63.97"></a><span id="l63.97"> </span>
<a href="#l63.98"></a><span id="l63.98" class="difflineminus">-#alignTypeSelect,label#alignLabel {</span>
<a href="#l63.99"></a><span id="l63.99" class="difflineminus">-  -moz-margin-start: 5px;</span>
<a href="#l63.100"></a><span id="l63.100" class="difflineminus">-}</span>
<a href="#l63.101"></a><span id="l63.101" class="difflineminus">-</span>
<a href="#l63.102"></a><span id="l63.102"> /* ::::: table properties dialog ::::: */</span>
<a href="#l63.103"></a><span id="l63.103"> </span>
<a href="#l63.104"></a><span id="l63.104"> #MoreFewerButton[more=&quot;0&quot;] {</span>
<a href="#l63.105"></a><span id="l63.105">   list-style-image: url(&quot;chrome://global/skin/arrow/arrow-dn.gif&quot;);</span>
<a href="#l63.106"></a><span id="l63.106">   min-width: 12em;</span>
<a href="#l63.107"></a><span id="l63.107"> }</span>
<a href="#l63.108"></a><span id="l63.108"> </span>
<a href="#l63.109"></a><span id="l63.109"> #MoreFewerButton[more=&quot;1&quot;] {</span>
<a href="#l63.110"></a><span id="l63.110" class="difflineat">@@ -188,20 +157,16 @@ tree.list {</span>
<a href="#l63.111"></a><span id="l63.111"> }</span>
<a href="#l63.112"></a><span id="l63.112"> </span>
<a href="#l63.113"></a><span id="l63.113"> #NextButton[type=&quot;row&quot;] {</span>
<a href="#l63.114"></a><span id="l63.114">   list-style-image: url(&quot;chrome://global/skin/arrow/arrow-dn.gif&quot;);</span>
<a href="#l63.115"></a><span id="l63.115"> }</span>
<a href="#l63.116"></a><span id="l63.116"> </span>
<a href="#l63.117"></a><span id="l63.117"> /* ::::: spelling dialog ::::: */</span>
<a href="#l63.118"></a><span id="l63.118"> </span>
<a href="#l63.119"></a><span id="l63.119" class="difflineminus">-#MisspelledWord {</span>
<a href="#l63.120"></a><span id="l63.120" class="difflineminus">-  font-weight: bold;</span>
<a href="#l63.121"></a><span id="l63.121" class="difflineminus">-}</span>
<a href="#l63.122"></a><span id="l63.122" class="difflineminus">-</span>
<a href="#l63.123"></a><span id="l63.123"> #ReplaceWordInput {</span>
<a href="#l63.124"></a><span id="l63.124">   min-width: 16em;</span>
<a href="#l63.125"></a><span id="l63.125">   width: 16em;</span>
<a href="#l63.126"></a><span id="l63.126"> }</span>
<a href="#l63.127"></a><span id="l63.127"> </span>
<a href="#l63.128"></a><span id="l63.128"> .spell-check {</span>
<a href="#l63.129"></a><span id="l63.129">   min-width: 8em;</span>
<a href="#l63.130"></a><span id="l63.130"> }</span>
<a href="#l63.131"></a><span id="l63.131" class="difflineat">@@ -251,38 +216,39 @@ tree.list {</span>
<a href="#l63.132"></a><span id="l63.132">   min-width: 2em;</span>
<a href="#l63.133"></a><span id="l63.133"> }</span>
<a href="#l63.134"></a><span id="l63.134"> </span>
<a href="#l63.135"></a><span id="l63.135"> .radio-spacer {</span>
<a href="#l63.136"></a><span id="l63.136">   width: 2em;</span>
<a href="#l63.137"></a><span id="l63.137">   min-width: 2em;</span>
<a href="#l63.138"></a><span id="l63.138"> }</span>
<a href="#l63.139"></a><span id="l63.139"> </span>
<a href="#l63.140"></a><span id="l63.140" class="difflineminus">-#alignTypeSelect {</span>
<a href="#l63.141"></a><span id="l63.141" class="difflineminus">-  height: 34px;</span>
<a href="#l63.142"></a><span id="l63.142" class="difflineplus">+.align-menu &gt; .menu-iconic-left &gt; .menu-iconic-icon {</span>
<a href="#l63.143"></a><span id="l63.143" class="difflineplus">+  height: auto;</span>
<a href="#l63.144"></a><span id="l63.144" class="difflineplus">+  width: auto;</span>
<a href="#l63.145"></a><span id="l63.145"> }</span>
<a href="#l63.146"></a><span id="l63.146"> </span>
<a href="#l63.147"></a><span id="l63.147"> .align-menu[value=&quot;top&quot;] {</span>
<a href="#l63.148"></a><span id="l63.148" class="difflineminus">-  list-style-image:url(&quot;chrome://editor/skin/icons/img-align-top.gif&quot;);</span>
<a href="#l63.149"></a><span id="l63.149" class="difflineplus">+  list-style-image:url(&quot;chrome://editor/skin/icons/img-align-top.gif&quot;) !important;</span>
<a href="#l63.150"></a><span id="l63.150"> }</span>
<a href="#l63.151"></a><span id="l63.151"> </span>
<a href="#l63.152"></a><span id="l63.152"> .align-menu[value=&quot;middle&quot;] {</span>
<a href="#l63.153"></a><span id="l63.153" class="difflineminus">-  list-style-image:url(&quot;chrome://editor/skin/icons/img-align-middle.gif&quot;);</span>
<a href="#l63.154"></a><span id="l63.154" class="difflineplus">+  list-style-image:url(&quot;chrome://editor/skin/icons/img-align-middle.gif&quot;) !important;</span>
<a href="#l63.155"></a><span id="l63.155"> }</span>
<a href="#l63.156"></a><span id="l63.156"> </span>
<a href="#l63.157"></a><span id="l63.157"> .align-menu[value=&quot;bottom&quot;] {</span>
<a href="#l63.158"></a><span id="l63.158" class="difflineminus">-  list-style-image:url(&quot;chrome://editor/skin/icons/img-align-bottom.gif&quot;);</span>
<a href="#l63.159"></a><span id="l63.159" class="difflineplus">+  list-style-image:url(&quot;chrome://editor/skin/icons/img-align-bottom.gif&quot;) !important;</span>
<a href="#l63.160"></a><span id="l63.160"> }</span>
<a href="#l63.161"></a><span id="l63.161"> </span>
<a href="#l63.162"></a><span id="l63.162"> .align-menu[value=&quot;right&quot;] {</span>
<a href="#l63.163"></a><span id="l63.163" class="difflineminus">-  list-style-image:url(&quot;chrome://editor/skin/icons/img-align-right.gif&quot;);</span>
<a href="#l63.164"></a><span id="l63.164" class="difflineplus">+  list-style-image:url(&quot;chrome://editor/skin/icons/img-align-right.gif&quot;) !important;</span>
<a href="#l63.165"></a><span id="l63.165"> }</span>
<a href="#l63.166"></a><span id="l63.166"> </span>
<a href="#l63.167"></a><span id="l63.167"> .align-menu[value=&quot;left&quot;] {</span>
<a href="#l63.168"></a><span id="l63.168" class="difflineminus">-  list-style-image:url(&quot;chrome://editor/skin/icons/img-align-left.gif&quot;);</span>
<a href="#l63.169"></a><span id="l63.169" class="difflineplus">+  list-style-image:url(&quot;chrome://editor/skin/icons/img-align-left.gif&quot;) !important;</span>
<a href="#l63.170"></a><span id="l63.170"> }</span>
<a href="#l63.171"></a><span id="l63.171"> </span>
<a href="#l63.172"></a><span id="l63.172"> /* Don't change width/height of these without changing values in </span>
<a href="#l63.173"></a><span id="l63.173">   GetOriginalWidth(), EdImageProps.js</span>
<a href="#l63.174"></a><span id="l63.174"> */    </span>
<a href="#l63.175"></a><span id="l63.175"> #preview-image-box {</span>
<a href="#l63.176"></a><span id="l63.176">   border: 1px inset #CCCCCC;</span>
<a href="#l63.177"></a><span id="l63.177">   width      : 82px;</span>
<a href="#l63.178"></a><span id="l63.178" class="difflineat">@@ -315,20 +281,16 @@ tree.list {</span>
<a href="#l63.179"></a><span id="l63.179"> /* styles for an attribute tree-table */</span>
<a href="#l63.180"></a><span id="l63.180"> tree.AttributesTree {</span>
<a href="#l63.181"></a><span id="l63.181">   min-width : 200px;</span>
<a href="#l63.182"></a><span id="l63.182">   min-height: 200px;</span>
<a href="#l63.183"></a><span id="l63.183"> }</span>
<a href="#l63.184"></a><span id="l63.184"> </span>
<a href="#l63.185"></a><span id="l63.185"> /* ::::: select edit dialog ::::: */</span>
<a href="#l63.186"></a><span id="l63.186"> </span>
<a href="#l63.187"></a><span id="l63.187" class="difflineminus">-#SelectTreeChildren::-moz-tree-cell(SelectSelCol, checked-false) {</span>
<a href="#l63.188"></a><span id="l63.188" class="difflineminus">-  background: url(&quot;chrome://global/skin/checkbox/cbox.gif&quot;) 50% 50% no-repeat;</span>
<a href="#l63.189"></a><span id="l63.189" class="difflineminus">-}</span>
<a href="#l63.190"></a><span id="l63.190" class="difflineminus">-</span>
<a href="#l63.191"></a><span id="l63.191"> #SelectTreeChildren::-moz-tree-cell(SelectSelCol, checked-true) {</span>
<a href="#l63.192"></a><span id="l63.192">   background: url(&quot;chrome://global/skin/checkbox/cbox-check.gif&quot;) 50% 50% no-repeat;</span>
<a href="#l63.193"></a><span id="l63.193"> }</span>
<a href="#l63.194"></a><span id="l63.194"> </span>
<a href="#l63.195"></a><span id="l63.195"> /* ::::: Publishing Progress ::::: */</span>
<a href="#l63.196"></a><span id="l63.196"> </span>
<a href="#l63.197"></a><span id="l63.197"> .progressitem[progress=&quot;busy&quot;] {</span>
<a href="#l63.198"></a><span id="l63.198"> 	list-style-image: url(&quot;chrome://editor/skin/icons/progress-busy.gif&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1" class="difflineminus">--- a/suite/themes/classic/jar.mn</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineplus">+++ b/suite/themes/classic/jar.mn</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineat">@@ -1,12 +1,11 @@</span>
<a href="#l64.4"></a><span id="l64.4"> classic.jar:</span>
<a href="#l64.5"></a><span id="l64.5"> % skin communicator classic/1.0 %skin/classic/communicator/</span>
<a href="#l64.6"></a><span id="l64.6"> % skin editor classic/1.0 %skin/classic/editor/</span>
<a href="#l64.7"></a><span id="l64.7" class="difflineminus">-% skin global classic/1.0 %skin/classic/global/</span>
<a href="#l64.8"></a><span id="l64.8"> % skin messenger classic/1.0 %skin/classic/messenger/</span>
<a href="#l64.9"></a><span id="l64.9"> % skin navigator classic/1.0 %skin/classic/navigator/</span>
<a href="#l64.10"></a><span id="l64.10"> % skin messenger-newsblog classic/1.0 %skin/classic/messenger-newsblog/</span>
<a href="#l64.11"></a><span id="l64.11"> % style chrome://global/content/customizeToolbar.xul chrome://navigator/skin/navigator.css</span>
<a href="#l64.12"></a><span id="l64.12"> % style chrome://global/content/customizeToolbar.xul chrome://messenger/skin/primaryToolbar.css</span>
<a href="#l64.13"></a><span id="l64.13"> #ifdef XP_MACOSX</span>
<a href="#l64.14"></a><span id="l64.14">   skin/classic/communicator/aboutSessionRestore.css                     (mac/communicator/aboutSessionRestore.css)</span>
<a href="#l64.15"></a><span id="l64.15">   skin/classic/communicator/button.css                                  (mac/communicator/button.css)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1" class="difflineminus">--- a/suite/themes/modern/communicator/aboutSessionRestore.css</span>
<a href="#l65.2"></a><span id="l65.2" class="difflineplus">+++ b/suite/themes/modern/communicator/aboutSessionRestore.css</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineat">@@ -64,15 +64,15 @@ treechildren::-moz-tree-checkbox {</span>
<a href="#l65.4"></a><span id="l65.4">   list-style-image: url(&quot;chrome://global/skin/checkbox/cbox.gif&quot;);</span>
<a href="#l65.5"></a><span id="l65.5"> }</span>
<a href="#l65.6"></a><span id="l65.6"> </span>
<a href="#l65.7"></a><span id="l65.7"> treechildren::-moz-tree-checkbox(checked) {</span>
<a href="#l65.8"></a><span id="l65.8">   list-style-image: url(&quot;chrome://global/skin/checkbox/cbox-check.gif&quot;);</span>
<a href="#l65.9"></a><span id="l65.9"> }</span>
<a href="#l65.10"></a><span id="l65.10"> </span>
<a href="#l65.11"></a><span id="l65.11"> treechildren::-moz-tree-checkbox(partial) {</span>
<a href="#l65.12"></a><span id="l65.12" class="difflineminus">-  list-style-image: url(&quot;chrome://global/skin/checkbox/cbox-check-dis.gif&quot;);</span>
<a href="#l65.13"></a><span id="l65.13" class="difflineplus">+  list-style-image: url(&quot;chrome://global/skin/checkbox/cbox-dis-check.gif&quot;);</span>
<a href="#l65.14"></a><span id="l65.14"> }</span>
<a href="#l65.15"></a><span id="l65.15"> </span>
<a href="#l65.16"></a><span id="l65.16"> #buttons {</span>
<a href="#l65.17"></a><span id="l65.17">   margin-top: 2em;</span>
<a href="#l65.18"></a><span id="l65.18">   -moz-margin-start: 80px;</span>
<a href="#l65.19"></a><span id="l65.19"> }</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

