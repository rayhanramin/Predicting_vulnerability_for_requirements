<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 24595:310a088dcdecc9210ff0f166a24464e6708a02dd</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 310a088dcdecc9210ff0f166a24464e6708a02dd" />
<meta property="og:url" content="/comm-central/rev/310a088dcdecc9210ff0f166a24464e6708a02dd" />
<meta property="og:description" content="Bug 1486690 - Update Thunderbird for function renamings. r=jorgk DONTBUILD" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 310a088dcdecc9210ff0f166a24464e6708a02dd 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/310a088dcdecc9210ff0f166a24464e6708a02dd">shortlog</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/310a088dcdecc9210ff0f166a24464e6708a02dd">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd">files</a> |
changeset |
<a href="/comm-central/raw-rev/310a088dcdecc9210ff0f166a24464e6708a02dd">raw</a>  | <a href="/comm-central/archive/310a088dcdecc9210ff0f166a24464e6708a02dd.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1486690">Bug 1486690</a> - Update Thunderbird for function renamings. r=jorgk DONTBUILD
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#78;&#105;&#99;&#104;&#111;&#108;&#97;&#115;&#32;&#78;&#101;&#116;&#104;&#101;&#114;&#99;&#111;&#116;&#101;&#32;&#60;&#110;&#110;&#101;&#116;&#104;&#101;&#114;&#99;&#111;&#116;&#101;&#64;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Wed, 29 Aug 2018 14:32:01 +1000</td></tr>

<tr>
 <td>changeset 24595</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/310a088dcdecc9210ff0f166a24464e6708a02dd">310a088dcdecc9210ff0f166a24464e6708a02dd</a></td>
</tr>



<tr>
<td>parent 24594</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/950a6edc45eba1a46a39b19668f0333a3dd4a15b">950a6edc45eba1a46a39b19668f0333a3dd4a15b</a>
</td>
</tr>

<tr>
<td>child 24596</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/f8389d3d22be3ab767997b23390866bd1e07fa36">f8389d3d22be3ab767997b23390866bd1e07fa36</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=310a088dcdecc9210ff0f166a24464e6708a02dd">14802</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Wed, 29 Aug 2018 10:43:09 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@310a088dcdec [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=310a088dcdecc9210ff0f166a24464e6708a02dd">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=310a088dcdecc9210ff0f166a24464e6708a02dd&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=310a088dcdecc9210ff0f166a24464e6708a02dd&newProject=comm-central&newRevision=310a088dcdecc9210ff0f166a24464e6708a02dd&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=310a088dcdecc9210ff0f166a24464e6708a02dd&newProject=comm-central&newRevision=310a088dcdecc9210ff0f166a24464e6708a02dd&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=310a088dcdecc9210ff0f166a24464e6708a02dd&newProject=comm-central&newRevision=310a088dcdecc9210ff0f166a24464e6708a02dd&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28jorgk%29&revcount=50">jorgk</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1486690">1486690</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1486690">Bug 1486690</a> - Update Thunderbird for function renamings. r=jorgk DONTBUILD

Specifically:
- NS_strdup --&gt; NS_xstrdup
- NS_strndup --&gt; NS_xstrndup
- nsMemory::Clone --&gt; moz_xmemdup</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/calendar/base/backend/libical/calRecurrenceRule.cpp">calendar/base/backend/libical/calRecurrenceRule.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/calendar/base/backend/libical/calRecurrenceRule.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/calendar/base/backend/libical/calRecurrenceRule.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/calendar/base/backend/libical/calRecurrenceRule.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/calendar/base/backend/libical/calRecurrenceRule.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/calendar/base/backend/libical/calRecurrenceRule.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/ldap/xpcom/src/nsLDAPMessage.cpp">ldap/xpcom/src/nsLDAPMessage.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/ldap/xpcom/src/nsLDAPMessage.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/ldap/xpcom/src/nsLDAPMessage.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/ldap/xpcom/src/nsLDAPMessage.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/ldap/xpcom/src/nsLDAPMessage.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/ldap/xpcom/src/nsLDAPMessage.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/addrbook/src/nsAddrDatabase.cpp">mailnews/addrbook/src/nsAddrDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/addrbook/src/nsAddrDatabase.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/addrbook/src/nsAddrDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/addrbook/src/nsAddrDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/addrbook/src/nsAddrDatabase.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/addrbook/src/nsAddrDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchAdapter.cpp">mailnews/base/search/src/nsMsgSearchAdapter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchAdapter.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchAdapter.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchAdapter.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchAdapter.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchAdapter.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchValue.cpp">mailnews/base/search/src/nsMsgSearchValue.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchValue.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchValue.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchValue.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchValue.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/search/src/nsMsgSearchValue.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMessenger.cpp">mailnews/base/src/nsMessenger.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMessenger.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMessenger.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMessenger.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMessenger.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMessenger.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMsgDBView.cpp">mailnews/base/src/nsMsgDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMsgDBView.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMsgDBView.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMsgDBView.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMsgDBView.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/src/nsMsgDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgKeyArray.cpp">mailnews/base/util/nsMsgKeyArray.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgKeyArray.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgKeyArray.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgKeyArray.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgKeyArray.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgKeyArray.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgProtocol.cpp">mailnews/base/util/nsMsgProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgProtocol.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgProtocol.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/base/util/nsMsgProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">mailnews/db/msgdb/src/nsMsgDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/db/msgdb/src/nsMsgDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPBodyShell.cpp">mailnews/imap/src/nsIMAPBodyShell.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPBodyShell.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPBodyShell.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPBodyShell.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPBodyShell.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPBodyShell.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPNamespace.cpp">mailnews/imap/src/nsIMAPNamespace.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPNamespace.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPNamespace.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPNamespace.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPNamespace.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsIMAPNamespace.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapFlagAndUidState.cpp">mailnews/imap/src/nsImapFlagAndUidState.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapFlagAndUidState.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapFlagAndUidState.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapFlagAndUidState.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapFlagAndUidState.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapFlagAndUidState.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapMailFolder.cpp">mailnews/imap/src/nsImapMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/imap/src/nsImapMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/outlook/src/MapiMessage.cpp">mailnews/import/outlook/src/MapiMessage.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/outlook/src/MapiMessage.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/outlook/src/MapiMessage.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/outlook/src/MapiMessage.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/outlook/src/MapiMessage.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/outlook/src/MapiMessage.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/src/nsImportService.cpp">mailnews/import/src/nsImportService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/src/nsImportService.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/src/nsImportService.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/src/nsImportService.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/src/nsImportService.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/src/nsImportService.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/text/src/nsTextImport.cpp">mailnews/import/text/src/nsTextImport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/text/src/nsTextImport.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/text/src/nsTextImport.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/text/src/nsTextImport.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/text/src/nsTextImport.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/import/text/src/nsTextImport.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/mime/src/nsStreamConverter.cpp">mailnews/mime/src/nsStreamConverter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/mime/src/nsStreamConverter.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/mime/src/nsStreamConverter.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/mime/src/nsStreamConverter.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/mime/src/nsStreamConverter.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/mime/src/nsStreamConverter.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/news/src/nsNNTPProtocol.cpp">mailnews/news/src/nsNNTPProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/news/src/nsNNTPProtocol.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/news/src/nsNNTPProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/news/src/nsNNTPProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/news/src/nsNNTPProtocol.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/mailnews/news/src/nsNNTPProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/rdf/base/nsRDFService.cpp">rdf/base/nsRDFService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/310a088dcdecc9210ff0f166a24464e6708a02dd/rdf/base/nsRDFService.cpp">file</a> |
<a href="/comm-central/annotate/310a088dcdecc9210ff0f166a24464e6708a02dd/rdf/base/nsRDFService.cpp">annotate</a> |
<a href="/comm-central/diff/310a088dcdecc9210ff0f166a24464e6708a02dd/rdf/base/nsRDFService.cpp">diff</a> |
<a href="/comm-central/comparison/310a088dcdecc9210ff0f166a24464e6708a02dd/rdf/base/nsRDFService.cpp">comparison</a> |
<a href="/comm-central/log/310a088dcdecc9210ff0f166a24464e6708a02dd/rdf/base/nsRDFService.cpp">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/backend/libical/calRecurrenceRule.cpp</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/backend/libical/calRecurrenceRule.cpp</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -268,18 +268,18 @@ calRecurrenceRule::GetComponent(const ns</span>
<a href="#l1.4"></a><span id="l1.4"> #define HANDLE_COMPONENT(_comptype,_icalvar,_icalmax)                   \</span>
<a href="#l1.5"></a><span id="l1.5">     if (aComponentType.EqualsLiteral( #_comptype )) {                    \</span>
<a href="#l1.6"></a><span id="l1.6">         int count;                                                      \</span>
<a href="#l1.7"></a><span id="l1.7">         for (count = 0; count &lt; _icalmax; count++) {                    \</span>
<a href="#l1.8"></a><span id="l1.8">             if (mIcalRecur._icalvar[count] == ICAL_RECURRENCE_ARRAY_MAX) \</span>
<a href="#l1.9"></a><span id="l1.9">                 break;                                                  \</span>
<a href="#l1.10"></a><span id="l1.10">         }                                                               \</span>
<a href="#l1.11"></a><span id="l1.11">         if (count) {                                                    \</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-            *aValues = (int16_t*) nsMemory::Clone(mIcalRecur._icalvar,  \</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-                                                  count * sizeof(int16_t)); \</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+            *aValues = (int16_t*) moz_xmemdup(mIcalRecur._icalvar,      \</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+                                              count * sizeof(int16_t)); \</span>
<a href="#l1.16"></a><span id="l1.16">             if (!*aValues) return NS_ERROR_OUT_OF_MEMORY;               \</span>
<a href="#l1.17"></a><span id="l1.17">         } else {                                                        \</span>
<a href="#l1.18"></a><span id="l1.18">             *aValues = nullptr;                                          \</span>
<a href="#l1.19"></a><span id="l1.19">         }                                                               \</span>
<a href="#l1.20"></a><span id="l1.20">         *aCount = count;                                                \</span>
<a href="#l1.21"></a><span id="l1.21">     }</span>
<a href="#l1.22"></a><span id="l1.22"> </span>
<a href="#l1.23"></a><span id="l1.23">     HANDLE_COMPONENT(BYSECOND, by_second, ICAL_BY_SECOND_SIZE)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/ldap/xpcom/src/nsLDAPMessage.cpp</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/ldap/xpcom/src/nsLDAPMessage.cpp</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -337,17 +337,17 @@ nsLDAPMessage::IterateAttributes(uint32_</span>
<a href="#l2.4"></a><span id="l2.4">     if (!attr) {</span>
<a href="#l2.5"></a><span id="l2.5">         return IterateAttrErrHandler(ldap_get_lderrno(mConnectionHandle, 0, 0),</span>
<a href="#l2.6"></a><span id="l2.6">                                      aAttrCount, aAttributes, position);</span>
<a href="#l2.7"></a><span id="l2.7">     }</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9">     // if we're getting attributes, try and fill in the first field</span>
<a href="#l2.10"></a><span id="l2.10">     //</span>
<a href="#l2.11"></a><span id="l2.11">     if (getP) {</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        (*aAttributes)[0] = NS_strdup(attr);</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        (*aAttributes)[0] = NS_xstrdup(attr);</span>
<a href="#l2.14"></a><span id="l2.14">         if (!(*aAttributes)[0]) {</span>
<a href="#l2.15"></a><span id="l2.15">             ldap_memfree(attr);</span>
<a href="#l2.16"></a><span id="l2.16">             free(*aAttributes);</span>
<a href="#l2.17"></a><span id="l2.17">             return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l2.18"></a><span id="l2.18">         }</span>
<a href="#l2.19"></a><span id="l2.19"> </span>
<a href="#l2.20"></a><span id="l2.20">         // note that we start counting again, in order to keep our place in</span>
<a href="#l2.21"></a><span id="l2.21">         // the array so that we can unwind gracefully and avoid leakage if</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -385,17 +385,17 @@ nsLDAPMessage::IterateAttributes(uint32_</span>
<a href="#l2.23"></a><span id="l2.23">             //</span>
<a href="#l2.24"></a><span id="l2.24">             break;</span>
<a href="#l2.25"></a><span id="l2.25"> </span>
<a href="#l2.26"></a><span id="l2.26">         } else if (getP) {</span>
<a href="#l2.27"></a><span id="l2.27"> </span>
<a href="#l2.28"></a><span id="l2.28">             // if ldap_next_attribute did return successfully, and</span>
<a href="#l2.29"></a><span id="l2.29">             // we're supposed to fill in a value, do so.</span>
<a href="#l2.30"></a><span id="l2.30">             //</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-            (*aAttributes)[*aAttrCount] = NS_strdup(attr);</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+            (*aAttributes)[*aAttrCount] = NS_xstrdup(attr);</span>
<a href="#l2.33"></a><span id="l2.33">             if (!(*aAttributes)[*aAttrCount]) {</span>
<a href="#l2.34"></a><span id="l2.34">                 ldap_memfree(attr);</span>
<a href="#l2.35"></a><span id="l2.35">                 return IterateAttrErrHandler(LDAP_NO_MEMORY, aAttrCount,</span>
<a href="#l2.36"></a><span id="l2.36">                                              aAttributes, position);</span>
<a href="#l2.37"></a><span id="l2.37">             }</span>
<a href="#l2.38"></a><span id="l2.38"> </span>
<a href="#l2.39"></a><span id="l2.39">         }</span>
<a href="#l2.40"></a><span id="l2.40">         ldap_memfree(attr);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1698,17 +1698,17 @@ NS_IMETHODIMP nsAddrDatabase::GetCardVal</span>
<a href="#l3.4"></a><span id="l3.4">   nsAutoString tempString;</span>
<a href="#l3.5"></a><span id="l3.5">   rv = GetStringColumn(cardRow, token, tempString);</span>
<a href="#l3.6"></a><span id="l3.6">   if (NS_FAILED(rv)) {</span>
<a href="#l3.7"></a><span id="l3.7">     // not all cards are going this column</span>
<a href="#l3.8"></a><span id="l3.8">     *value = nullptr;</span>
<a href="#l3.9"></a><span id="l3.9">     return NS_OK;</span>
<a href="#l3.10"></a><span id="l3.10">   }</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  *value = NS_strdup(tempString.get());</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+  *value = NS_xstrdup(tempString.get());</span>
<a href="#l3.14"></a><span id="l3.14">   if (!*value)</span>
<a href="#l3.15"></a><span id="l3.15">     return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l3.16"></a><span id="l3.16">   return NS_OK;</span>
<a href="#l3.17"></a><span id="l3.17"> }</span>
<a href="#l3.18"></a><span id="l3.18"> </span>
<a href="#l3.19"></a><span id="l3.19"> NS_IMETHODIMP nsAddrDatabase::EditCard(nsIAbCard *aCard, bool aNotify, nsIAbDirectory *aParent)</span>
<a href="#l3.20"></a><span id="l3.20"> {</span>
<a href="#l3.21"></a><span id="l3.21">   // XXX make sure this isn't getting called when we're just editing one or two well known fields</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgSearchAdapter.cpp</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgSearchAdapter.cpp</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -163,41 +163,41 @@ nsMsgSearchAdapter::GetImapCharsetParam(</span>
<a href="#l4.4"></a><span id="l4.4"> /*</span>
<a href="#l4.5"></a><span id="l4.5">    09/21/2000 - taka@netscape.com</span>
<a href="#l4.6"></a><span id="l4.6">    This method is bogus. Escape must be done against char * not char16_t *</span>
<a href="#l4.7"></a><span id="l4.7">    should be rewritten later.</span>
<a href="#l4.8"></a><span id="l4.8">    for now, just duplicate the string.</span>
<a href="#l4.9"></a><span id="l4.9"> */</span>
<a href="#l4.10"></a><span id="l4.10"> char16_t *nsMsgSearchAdapter::EscapeSearchUrl (const char16_t *nntpCommand)</span>
<a href="#l4.11"></a><span id="l4.11"> {</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-  return nntpCommand ? NS_strdup(nntpCommand) : nullptr;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+  return nntpCommand ? NS_xstrdup(nntpCommand) : nullptr;</span>
<a href="#l4.14"></a><span id="l4.14"> }</span>
<a href="#l4.15"></a><span id="l4.15"> </span>
<a href="#l4.16"></a><span id="l4.16"> /*</span>
<a href="#l4.17"></a><span id="l4.17">    09/21/2000 - taka@netscape.com</span>
<a href="#l4.18"></a><span id="l4.18">    This method is bogus. Escape must be done against char * not char16_t *</span>
<a href="#l4.19"></a><span id="l4.19">    should be rewritten later.</span>
<a href="#l4.20"></a><span id="l4.20">    for now, just duplicate the string.</span>
<a href="#l4.21"></a><span id="l4.21"> */</span>
<a href="#l4.22"></a><span id="l4.22"> char16_t *</span>
<a href="#l4.23"></a><span id="l4.23"> nsMsgSearchAdapter::EscapeImapSearchProtocol(const char16_t *imapCommand)</span>
<a href="#l4.24"></a><span id="l4.24"> {</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineminus">-  return imapCommand ? NS_strdup(imapCommand) : nullptr;</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineplus">+  return imapCommand ? NS_xstrdup(imapCommand) : nullptr;</span>
<a href="#l4.27"></a><span id="l4.27"> }</span>
<a href="#l4.28"></a><span id="l4.28"> </span>
<a href="#l4.29"></a><span id="l4.29"> /*</span>
<a href="#l4.30"></a><span id="l4.30">    09/21/2000 - taka@netscape.com</span>
<a href="#l4.31"></a><span id="l4.31">    This method is bogus. Escape must be done against char * not char16_t *</span>
<a href="#l4.32"></a><span id="l4.32">    should be rewritten later.</span>
<a href="#l4.33"></a><span id="l4.33">    for now, just duplicate the string.</span>
<a href="#l4.34"></a><span id="l4.34"> */</span>
<a href="#l4.35"></a><span id="l4.35"> char16_t *</span>
<a href="#l4.36"></a><span id="l4.36"> nsMsgSearchAdapter::EscapeQuoteImapSearchProtocol(const char16_t *imapCommand)</span>
<a href="#l4.37"></a><span id="l4.37"> {</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineminus">-  return imapCommand ? NS_strdup(imapCommand) : nullptr;</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+  return imapCommand ? NS_xstrdup(imapCommand) : nullptr;</span>
<a href="#l4.40"></a><span id="l4.40"> }</span>
<a href="#l4.41"></a><span id="l4.41"> </span>
<a href="#l4.42"></a><span id="l4.42"> char *nsMsgSearchAdapter::UnEscapeSearchUrl (const char *commandSpecificData)</span>
<a href="#l4.43"></a><span id="l4.43"> {</span>
<a href="#l4.44"></a><span id="l4.44">   char *result = (char*) PR_Malloc (strlen(commandSpecificData) + 1);</span>
<a href="#l4.45"></a><span id="l4.45">   if (result)</span>
<a href="#l4.46"></a><span id="l4.46">   {</span>
<a href="#l4.47"></a><span id="l4.47">     char *resultPtr = result;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgSearchValue.cpp</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgSearchValue.cpp</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -9,17 +9,17 @@</span>
<a href="#l5.4"></a><span id="l5.4"> #include &quot;nsMsgUtils.h&quot;</span>
<a href="#l5.5"></a><span id="l5.5"> #include &quot;nsString.h&quot;</span>
<a href="#l5.6"></a><span id="l5.6"> </span>
<a href="#l5.7"></a><span id="l5.7"> nsMsgSearchValueImpl::nsMsgSearchValueImpl(nsMsgSearchValue *aInitialValue)</span>
<a href="#l5.8"></a><span id="l5.8"> {</span>
<a href="#l5.9"></a><span id="l5.9">     mValue = *aInitialValue;</span>
<a href="#l5.10"></a><span id="l5.10">     if (IS_STRING_ATTRIBUTE(aInitialValue-&gt;attribute) &amp;&amp; aInitialValue-&gt;string)</span>
<a href="#l5.11"></a><span id="l5.11">     {</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-        mValue.string = NS_strdup(aInitialValue-&gt;string);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+        mValue.string = NS_xstrdup(aInitialValue-&gt;string);</span>
<a href="#l5.14"></a><span id="l5.14">         CopyUTF8toUTF16(mozilla::MakeStringSpan(mValue.string), mValue.utf16String);</span>
<a href="#l5.15"></a><span id="l5.15">     }</span>
<a href="#l5.16"></a><span id="l5.16">     else</span>
<a href="#l5.17"></a><span id="l5.17">         mValue.string = 0;</span>
<a href="#l5.18"></a><span id="l5.18"> }</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20"> nsMsgSearchValueImpl::~nsMsgSearchValueImpl()</span>
<a href="#l5.21"></a><span id="l5.21"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -2060,17 +2060,17 @@ nsSaveAllAttachmentsState::nsSaveAllAtta</span>
<a href="#l6.4"></a><span id="l6.4">     m_messageUriArray = new char*[count];</span>
<a href="#l6.5"></a><span id="l6.5">     for (i = 0; i &lt; count; i++)</span>
<a href="#l6.6"></a><span id="l6.6">     {</span>
<a href="#l6.7"></a><span id="l6.7">         m_contentTypeArray[i] = strdup(contentTypeArray[i]);</span>
<a href="#l6.8"></a><span id="l6.8">         m_urlArray[i] = strdup(urlArray[i]);</span>
<a href="#l6.9"></a><span id="l6.9">         m_displayNameArray[i] = strdup(nameArray[i]);</span>
<a href="#l6.10"></a><span id="l6.10">         m_messageUriArray[i] = strdup(uriArray[i]);</span>
<a href="#l6.11"></a><span id="l6.11">     }</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-    m_directoryName = NS_strdup(dirName);</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+    m_directoryName = NS_xstrdup(dirName);</span>
<a href="#l6.14"></a><span id="l6.14">     m_detachingAttachments = detachingAttachments;</span>
<a href="#l6.15"></a><span id="l6.15"> }</span>
<a href="#l6.16"></a><span id="l6.16"> </span>
<a href="#l6.17"></a><span id="l6.17"> nsSaveAllAttachmentsState::~nsSaveAllAttachmentsState()</span>
<a href="#l6.18"></a><span id="l6.18"> {</span>
<a href="#l6.19"></a><span id="l6.19">     uint32_t i;</span>
<a href="#l6.20"></a><span id="l6.20">     for (i = 0; i &lt; m_count; i++)</span>
<a href="#l6.21"></a><span id="l6.21">     {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -218,17 +218,17 @@ char16_t * nsMsgDBView::GetString(const </span>
<a href="#l7.4"></a><span id="l7.4"> </span>
<a href="#l7.5"></a><span id="l7.5">   if (mMessengerStringBundle)</span>
<a href="#l7.6"></a><span id="l7.6">     res = mMessengerStringBundle-&gt;GetStringFromName(</span>
<a href="#l7.7"></a><span id="l7.7">                                     NS_ConvertUTF16toUTF8(aStringName).get(), str);</span>
<a href="#l7.8"></a><span id="l7.8"> </span>
<a href="#l7.9"></a><span id="l7.9">   if (NS_SUCCEEDED(res))</span>
<a href="#l7.10"></a><span id="l7.10">     return ToNewUnicode(str);</span>
<a href="#l7.11"></a><span id="l7.11">   else</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-    return NS_strdup(aStringName);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+    return NS_xstrdup(aStringName);</span>
<a href="#l7.14"></a><span id="l7.14"> }</span>
<a href="#l7.15"></a><span id="l7.15"> </span>
<a href="#l7.16"></a><span id="l7.16"> // Helper function used to fetch localized strings from the prefs</span>
<a href="#l7.17"></a><span id="l7.17"> nsresult</span>
<a href="#l7.18"></a><span id="l7.18"> nsMsgDBView::GetPrefLocalizedString(const char *aPrefName,</span>
<a href="#l7.19"></a><span id="l7.19">                                     nsString&amp; aResult)</span>
<a href="#l7.20"></a><span id="l7.20"> {</span>
<a href="#l7.21"></a><span id="l7.21">   nsresult rv = NS_OK;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/base/util/nsMsgKeyArray.cpp</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgKeyArray.cpp</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -66,12 +66,12 @@ NS_IMETHODIMP nsMsgKeyArray::InsertEleme</span>
<a href="#l8.4"></a><span id="l8.4"> }</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6"> NS_IMETHODIMP nsMsgKeyArray::GetArray(uint32_t *aCount, nsMsgKey **aKeys)</span>
<a href="#l8.7"></a><span id="l8.7"> {</span>
<a href="#l8.8"></a><span id="l8.8">   NS_ENSURE_ARG_POINTER(aCount);</span>
<a href="#l8.9"></a><span id="l8.9">   NS_ENSURE_ARG_POINTER(aKeys);</span>
<a href="#l8.10"></a><span id="l8.10">   *aCount = m_keys.Length();</span>
<a href="#l8.11"></a><span id="l8.11">   *aKeys =</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-    (nsMsgKey *) nsMemory::Clone(m_keys.Elements(),</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-                                 m_keys.Length() * sizeof(nsMsgKey));</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+    (nsMsgKey *) moz_xmemdup(m_keys.Elements(),</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+                             m_keys.Length() * sizeof(nsMsgKey));</span>
<a href="#l8.16"></a><span id="l8.16">   return (*aKeys) ? NS_OK : NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l8.17"></a><span id="l8.17"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/util/nsMsgProtocol.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgProtocol.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -934,17 +934,17 @@ nsresult nsMsgProtocol::DoGSSAPIStep2(ns</span>
<a href="#l9.4"></a><span id="l9.4">         {</span>
<a href="#l9.5"></a><span id="l9.5">             char *base64Str = PL_Base64Encode((char *)outBuf, outBufLen, nullptr);</span>
<a href="#l9.6"></a><span id="l9.6">             if (base64Str)</span>
<a href="#l9.7"></a><span id="l9.7">                 response.Adopt(base64Str);</span>
<a href="#l9.8"></a><span id="l9.8">             else</span>
<a href="#l9.9"></a><span id="l9.9">                 rv = NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l9.10"></a><span id="l9.10">         }</span>
<a href="#l9.11"></a><span id="l9.11">         else</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-            response.Adopt((char *)nsMemory::Clone(&quot;&quot;,1));</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+            response.Adopt((char *)moz_xmemdup(&quot;&quot;,1));</span>
<a href="#l9.14"></a><span id="l9.14">     }</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16"> #ifdef DEBUG_BenB</span>
<a href="#l9.17"></a><span id="l9.17">     printf(NS_SUCCEEDED(rv) ? &quot;GSSAPI step 2 succeeded\n&quot; : &quot;GSSAPI step 2 failed\n&quot;);</span>
<a href="#l9.18"></a><span id="l9.18"> #endif</span>
<a href="#l9.19"></a><span id="l9.19">     return rv;</span>
<a href="#l9.20"></a><span id="l9.20"> }</span>
<a href="#l9.21"></a><span id="l9.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsMsgDatabase.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsMsgDatabase.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -2274,18 +2274,18 @@ nsMsgDatabase::MarkThreadRead(nsIMsgThre</span>
<a href="#l10.4"></a><span id="l10.4">     }</span>
<a href="#l10.5"></a><span id="l10.5">   }</span>
<a href="#l10.6"></a><span id="l10.6"> </span>
<a href="#l10.7"></a><span id="l10.7">   *aNumMarked = thoseMarked.Length();</span>
<a href="#l10.8"></a><span id="l10.8"> </span>
<a href="#l10.9"></a><span id="l10.9">   if (thoseMarked.Length())</span>
<a href="#l10.10"></a><span id="l10.10">   {</span>
<a href="#l10.11"></a><span id="l10.11">     *aThoseMarked =</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-      (nsMsgKey *) nsMemory::Clone(&amp;thoseMarked[0],</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-                                   thoseMarked.Length() * sizeof(nsMsgKey));</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+      (nsMsgKey *) moz_xmemdup(&amp;thoseMarked[0],</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+                               thoseMarked.Length() * sizeof(nsMsgKey));</span>
<a href="#l10.16"></a><span id="l10.16">     if (!*aThoseMarked)</span>
<a href="#l10.17"></a><span id="l10.17">       return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l10.18"></a><span id="l10.18">   }</span>
<a href="#l10.19"></a><span id="l10.19">   else</span>
<a href="#l10.20"></a><span id="l10.20">     *aThoseMarked = nullptr;</span>
<a href="#l10.21"></a><span id="l10.21"> </span>
<a href="#l10.22"></a><span id="l10.22">   return rv;</span>
<a href="#l10.23"></a><span id="l10.23"> }</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineat">@@ -2709,18 +2709,18 @@ NS_IMETHODIMP nsMsgDatabase::MarkAllRead</span>
<a href="#l10.25"></a><span id="l10.25">     }</span>
<a href="#l10.26"></a><span id="l10.26">     NS_RELEASE(pHeader);</span>
<a href="#l10.27"></a><span id="l10.27">   }</span>
<a href="#l10.28"></a><span id="l10.28"> </span>
<a href="#l10.29"></a><span id="l10.29">   *aNumKeys = thoseMarked.Length();</span>
<a href="#l10.30"></a><span id="l10.30"> </span>
<a href="#l10.31"></a><span id="l10.31">   if (thoseMarked.Length())</span>
<a href="#l10.32"></a><span id="l10.32">   {</span>
<a href="#l10.33"></a><span id="l10.33" class="difflineminus">-    *aThoseMarked = (nsMsgKey *) nsMemory::Clone(&amp;thoseMarked[0],</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineminus">-                                                 thoseMarked.Length() * sizeof(nsMsgKey));</span>
<a href="#l10.35"></a><span id="l10.35" class="difflineplus">+    *aThoseMarked = (nsMsgKey *) moz_xmemdup(&amp;thoseMarked[0],</span>
<a href="#l10.36"></a><span id="l10.36" class="difflineplus">+                                             thoseMarked.Length() * sizeof(nsMsgKey));</span>
<a href="#l10.37"></a><span id="l10.37">     if (!*aThoseMarked)</span>
<a href="#l10.38"></a><span id="l10.38">       return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l10.39"></a><span id="l10.39">   }</span>
<a href="#l10.40"></a><span id="l10.40">   else</span>
<a href="#l10.41"></a><span id="l10.41">     *aThoseMarked = nullptr;</span>
<a href="#l10.42"></a><span id="l10.42"> </span>
<a href="#l10.43"></a><span id="l10.43">   // force num new to 0.</span>
<a href="#l10.44"></a><span id="l10.44">   int32_t numUnreadMessages;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/imap/src/nsIMAPBodyShell.cpp</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/imap/src/nsIMAPBodyShell.cpp</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -58,17 +58,17 @@ nsIMAPBodyShell::nsIMAPBodyShell(nsImapP</span>
<a href="#l11.4"></a><span id="l11.4">   m_UID.AppendInt(UID);</span>
<a href="#l11.5"></a><span id="l11.5">   m_UID_validity = m_UID;</span>
<a href="#l11.6"></a><span id="l11.6">   m_UID_validity.AppendInt(UIDValidity);</span>
<a href="#l11.7"></a><span id="l11.7"> #ifdef DEBUG_chrisf</span>
<a href="#l11.8"></a><span id="l11.8">   NS_ASSERTION(folderName);</span>
<a href="#l11.9"></a><span id="l11.9"> #endif</span>
<a href="#l11.10"></a><span id="l11.10">   if (!folderName)</span>
<a href="#l11.11"></a><span id="l11.11">     return;</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-  m_folderName = NS_strdup(folderName);</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+  m_folderName = NS_xstrdup(folderName);</span>
<a href="#l11.14"></a><span id="l11.14">   if (!m_folderName)</span>
<a href="#l11.15"></a><span id="l11.15">     return;</span>
<a href="#l11.16"></a><span id="l11.16"> </span>
<a href="#l11.17"></a><span id="l11.17">   SetContentModified(GetShowAttachmentsInline() ? IMAP_CONTENT_MODIFIED_VIEW_INLINE : IMAP_CONTENT_MODIFIED_VIEW_AS_LINKS);</span>
<a href="#l11.18"></a><span id="l11.18"> </span>
<a href="#l11.19"></a><span id="l11.19">   SetIsValid(m_message != nullptr);</span>
<a href="#l11.20"></a><span id="l11.20"> }</span>
<a href="#l11.21"></a><span id="l11.21"> </span>
<a href="#l11.22"></a><span id="l11.22" class="difflineat">@@ -912,20 +912,20 @@ nsIMAPBodypart(partNum, parentPart)</span>
<a href="#l11.23"></a><span id="l11.23">   {</span>
<a href="#l11.24"></a><span id="l11.24">     // the multipart (this) will inherit the part number of its parent</span>
<a href="#l11.25"></a><span id="l11.25">     PR_FREEIF(m_partNumberString);</span>
<a href="#l11.26"></a><span id="l11.26">     if (!m_parentPart)</span>
<a href="#l11.27"></a><span id="l11.27">     {</span>
<a href="#l11.28"></a><span id="l11.28">       m_partNumberString = PR_smprintf(&quot;0&quot;);</span>
<a href="#l11.29"></a><span id="l11.29">     }</span>
<a href="#l11.30"></a><span id="l11.30">     else</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-      m_partNumberString = NS_strdup(m_parentPart-&gt;GetPartNumberString());</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+      m_partNumberString = NS_xstrdup(m_parentPart-&gt;GetPartNumberString());</span>
<a href="#l11.33"></a><span id="l11.33">   }</span>
<a href="#l11.34"></a><span id="l11.34">   m_partList = new nsTArray&lt;nsIMAPBodypart*&gt;();</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineminus">-  m_bodyType = NS_strdup(&quot;multipart&quot;);</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineplus">+  m_bodyType = NS_xstrdup(&quot;multipart&quot;);</span>
<a href="#l11.37"></a><span id="l11.37">   if (m_partList &amp;&amp; m_parentPart &amp;&amp; m_bodyType)</span>
<a href="#l11.38"></a><span id="l11.38">     SetIsValid(true);</span>
<a href="#l11.39"></a><span id="l11.39">   else</span>
<a href="#l11.40"></a><span id="l11.40">     SetIsValid(false);</span>
<a href="#l11.41"></a><span id="l11.41"> }</span>
<a href="#l11.42"></a><span id="l11.42"> </span>
<a href="#l11.43"></a><span id="l11.43"> nsIMAPBodypartType nsIMAPBodypartMultipart::GetType()</span>
<a href="#l11.44"></a><span id="l11.44"> {</span>
<a href="#l11.45"></a><span id="l11.45" class="difflineat">@@ -1079,17 +1079,17 @@ nsIMAPBodypart *nsIMAPBodypartMultipart:</span>
<a href="#l11.46"></a><span id="l11.46"> nsIMAPMessageHeaders::nsIMAPMessageHeaders(char *partNum, nsIMAPBodypart *parentPart) :</span>
<a href="#l11.47"></a><span id="l11.47"> nsIMAPBodypart(partNum, parentPart)</span>
<a href="#l11.48"></a><span id="l11.48"> {</span>
<a href="#l11.49"></a><span id="l11.49">   if (!partNum)</span>
<a href="#l11.50"></a><span id="l11.50">   {</span>
<a href="#l11.51"></a><span id="l11.51">     SetIsValid(false);</span>
<a href="#l11.52"></a><span id="l11.52">     return;</span>
<a href="#l11.53"></a><span id="l11.53">   }</span>
<a href="#l11.54"></a><span id="l11.54" class="difflineminus">-  m_partNumberString = NS_strdup(partNum);</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineplus">+  m_partNumberString = NS_xstrdup(partNum);</span>
<a href="#l11.56"></a><span id="l11.56">   if (!m_partNumberString)</span>
<a href="#l11.57"></a><span id="l11.57">   {</span>
<a href="#l11.58"></a><span id="l11.58">     SetIsValid(false);</span>
<a href="#l11.59"></a><span id="l11.59">     return;</span>
<a href="#l11.60"></a><span id="l11.60">   }</span>
<a href="#l11.61"></a><span id="l11.61">   if (!m_parentPart || !m_parentPart-&gt;GetnsIMAPBodypartMessage())</span>
<a href="#l11.62"></a><span id="l11.62">   {</span>
<a href="#l11.63"></a><span id="l11.63">     // Message headers created without a valid Message parent</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/imap/src/nsIMAPNamespace.cpp</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/imap/src/nsIMAPNamespace.cpp</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -453,17 +453,17 @@ nsIMAPNamespace* nsIMAPNamespaceList::Ge</span>
<a href="#l12.4"></a><span id="l12.4">   return resultNamespace;</span>
<a href="#l12.5"></a><span id="l12.5"> }</span>
<a href="#l12.6"></a><span id="l12.6"> </span>
<a href="#l12.7"></a><span id="l12.7"> /* static */</span>
<a href="#l12.8"></a><span id="l12.8"> char *nsIMAPNamespaceList::AllocateServerFolderName(const char *canonicalFolderName, char delimiter)</span>
<a href="#l12.9"></a><span id="l12.9"> {</span>
<a href="#l12.10"></a><span id="l12.10">   if (delimiter)</span>
<a href="#l12.11"></a><span id="l12.11">     return nsImapUrl::ReplaceCharsInCopiedString(canonicalFolderName, '/', delimiter);</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  return NS_strdup(canonicalFolderName);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  return NS_xstrdup(canonicalFolderName);</span>
<a href="#l12.14"></a><span id="l12.14"> }</span>
<a href="#l12.15"></a><span id="l12.15"> </span>
<a href="#l12.16"></a><span id="l12.16"> /*</span>
<a href="#l12.17"></a><span id="l12.17">   GetFolderOwnerNameFromPath takes as inputs a folder name</span>
<a href="#l12.18"></a><span id="l12.18">   in canonical form, and a namespace for that folder.</span>
<a href="#l12.19"></a><span id="l12.19">   The namespace MUST be of type kOtherUsersNamespace, hence the folder MUST be</span>
<a href="#l12.20"></a><span id="l12.20">   owned by another user.  This function extracts the folder owner's name from the</span>
<a href="#l12.21"></a><span id="l12.21">   canonical name of the folder, and returns an allocated copy of that owner's name</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/imap/src/nsImapFlagAndUidState.cpp</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapFlagAndUidState.cpp</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -275,17 +275,17 @@ NS_IMETHODIMP nsImapFlagAndUidState::Add</span>
<a href="#l13.4"></a><span id="l13.4"> }</span>
<a href="#l13.5"></a><span id="l13.5"> </span>
<a href="#l13.6"></a><span id="l13.6"> NS_IMETHODIMP nsImapFlagAndUidState::GetCustomFlags(uint32_t uid, char **customFlags)</span>
<a href="#l13.7"></a><span id="l13.7"> {</span>
<a href="#l13.8"></a><span id="l13.8">   MutexAutoLock mon(mLock);</span>
<a href="#l13.9"></a><span id="l13.9">   nsCString value;</span>
<a href="#l13.10"></a><span id="l13.10">   if (m_customFlagsHash.Get(uid, &amp;value))</span>
<a href="#l13.11"></a><span id="l13.11">   {</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-    *customFlags = NS_strdup(value.get());</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+    *customFlags = NS_xstrdup(value.get());</span>
<a href="#l13.14"></a><span id="l13.14">     return (*customFlags) ? NS_OK : NS_ERROR_FAILURE;</span>
<a href="#l13.15"></a><span id="l13.15">   }</span>
<a href="#l13.16"></a><span id="l13.16">   *customFlags = nullptr;</span>
<a href="#l13.17"></a><span id="l13.17">   return NS_OK;</span>
<a href="#l13.18"></a><span id="l13.18"> }</span>
<a href="#l13.19"></a><span id="l13.19"> </span>
<a href="#l13.20"></a><span id="l13.20"> NS_IMETHODIMP nsImapFlagAndUidState::ClearCustomFlags(uint32_t uid)</span>
<a href="#l13.21"></a><span id="l13.21"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -4370,18 +4370,18 @@ NS_IMETHODIMP nsImapMailFolder::GetMsgHd</span>
<a href="#l14.4"></a><span id="l14.4">   int32_t numKeysToFetch = m_keysToFetch.Length();</span>
<a href="#l14.5"></a><span id="l14.5">   int32_t startIndex = 0;</span>
<a href="#l14.6"></a><span id="l14.6">   if (folderOpen &amp;&amp; hdrChunkSize &gt; 0 &amp;&amp; (int32_t) m_keysToFetch.Length() &gt; hdrChunkSize)</span>
<a href="#l14.7"></a><span id="l14.7">   {</span>
<a href="#l14.8"></a><span id="l14.8">     numKeysToFetch = hdrChunkSize;</span>
<a href="#l14.9"></a><span id="l14.9">     *aMoreToDownload = true;</span>
<a href="#l14.10"></a><span id="l14.10">     startIndex = m_keysToFetch.Length() - hdrChunkSize;</span>
<a href="#l14.11"></a><span id="l14.11">   }</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  *aKeys = (nsMsgKey *) nsMemory::Clone(&amp;m_keysToFetch[startIndex],</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-                                       numKeysToFetch * sizeof(nsMsgKey));</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+  *aKeys = (nsMsgKey *) moz_xmemdup(&amp;m_keysToFetch[startIndex],</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+                                    numKeysToFetch * sizeof(nsMsgKey));</span>
<a href="#l14.16"></a><span id="l14.16">   NS_ENSURE_TRUE(*aKeys, NS_ERROR_OUT_OF_MEMORY);</span>
<a href="#l14.17"></a><span id="l14.17">   // Remove these for the incremental header download case, so that</span>
<a href="#l14.18"></a><span id="l14.18">   // we know we don't have to download them again.</span>
<a href="#l14.19"></a><span id="l14.19">   m_keysToFetch.RemoveElementsAt(startIndex, numKeysToFetch);</span>
<a href="#l14.20"></a><span id="l14.20">   *aLength = numKeysToFetch;</span>
<a href="#l14.21"></a><span id="l14.21"> </span>
<a href="#l14.22"></a><span id="l14.22">   return NS_OK;</span>
<a href="#l14.23"></a><span id="l14.23"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/import/outlook/src/MapiMessage.cpp</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/import/outlook/src/MapiMessage.cpp</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -1010,17 +1010,17 @@ bool CMapiMessage::AddAttachment(DWORD a</span>
<a href="#l15.4"></a><span id="l15.4">     }</span>
<a href="#l15.5"></a><span id="l15.5"> </span>
<a href="#l15.6"></a><span id="l15.6">     if (bResult)</span>
<a href="#l15.7"></a><span id="l15.7">       bResult = GetURL(data-&gt;tmp_file, getter_AddRefs(data-&gt;orig_url));</span>
<a href="#l15.8"></a><span id="l15.8"> </span>
<a href="#l15.9"></a><span id="l15.9">     if (bResult) {</span>
<a href="#l15.10"></a><span id="l15.10">       // Now we have the file; proceed to the other properties</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-      data-&gt;encoding = NS_strdup(ENCODING_BINARY);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+      data-&gt;encoding = NS_xstrdup(ENCODING_BINARY);</span>
<a href="#l15.14"></a><span id="l15.14"> </span>
<a href="#l15.15"></a><span id="l15.15">       nsString fname, fext;</span>
<a href="#l15.16"></a><span id="l15.16">       pVal = CMapiApi::GetMapiProperty(lpAttach, PR_ATTACH_LONG_FILENAME_W);</span>
<a href="#l15.17"></a><span id="l15.17">       if (!pVal)</span>
<a href="#l15.18"></a><span id="l15.18">         pVal = CMapiApi::GetMapiProperty(lpAttach, PR_ATTACH_FILENAME_W);</span>
<a href="#l15.19"></a><span id="l15.19">       CMapiApi::GetStringFromProp(pVal, fname);</span>
<a href="#l15.20"></a><span id="l15.20">       pVal = CMapiApi::GetMapiProperty(lpAttach, PR_ATTACH_EXTENSION_W);</span>
<a href="#l15.21"></a><span id="l15.21">       CMapiApi::GetStringFromProp(pVal, fext);</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineat">@@ -1041,30 +1041,30 @@ bool CMapiMessage::AddAttachment(DWORD a</span>
<a href="#l15.23"></a><span id="l15.23">         fname = L&quot;Attachment &quot;;</span>
<a href="#l15.24"></a><span id="l15.24">         fname.AppendInt(static_cast&lt;uint32_t&gt;(aNum));</span>
<a href="#l15.25"></a><span id="l15.25">       }</span>
<a href="#l15.26"></a><span id="l15.26">       data-&gt;real_name = ToNewUTF8String(fname);</span>
<a href="#l15.27"></a><span id="l15.27"> </span>
<a href="#l15.28"></a><span id="l15.28">       nsCString tmp;</span>
<a href="#l15.29"></a><span id="l15.29">        // We have converted it to the rfc822 document</span>
<a href="#l15.30"></a><span id="l15.30">       if (aMethod == ATTACH_EMBEDDED_MSG) {</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-        data-&gt;type = NS_strdup(MESSAGE_RFC822);</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+        data-&gt;type = NS_xstrdup(MESSAGE_RFC822);</span>
<a href="#l15.33"></a><span id="l15.33">       } else {</span>
<a href="#l15.34"></a><span id="l15.34">         pVal = CMapiApi::GetMapiProperty(lpAttach, PR_ATTACH_MIME_TAG_A);</span>
<a href="#l15.35"></a><span id="l15.35">         CMapiApi::GetStringFromProp(pVal, tmp);</span>
<a href="#l15.36"></a><span id="l15.36">         MAPI_TRACE1(&quot;\t\t\t--- Mime type: %s\r\n&quot;, tmp.get());</span>
<a href="#l15.37"></a><span id="l15.37">         if (tmp.IsEmpty()) {</span>
<a href="#l15.38"></a><span id="l15.38">           uint8_t *pType = NULL;</span>
<a href="#l15.39"></a><span id="l15.39">           if (!fext.IsEmpty()) {</span>
<a href="#l15.40"></a><span id="l15.40">             pType = CMimeTypes::GetMimeType(fext);</span>
<a href="#l15.41"></a><span id="l15.41">           }</span>
<a href="#l15.42"></a><span id="l15.42">           if (pType)</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineminus">-            data-&gt;type = NS_strdup((PC_S8)pType);</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineplus">+            data-&gt;type = NS_xstrdup((PC_S8)pType);</span>
<a href="#l15.45"></a><span id="l15.45">           else</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineminus">-            data-&gt;type = NS_strdup(APPLICATION_OCTET_STREAM);</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineplus">+            data-&gt;type = NS_xstrdup(APPLICATION_OCTET_STREAM);</span>
<a href="#l15.48"></a><span id="l15.48">         }</span>
<a href="#l15.49"></a><span id="l15.49">         else</span>
<a href="#l15.50"></a><span id="l15.50">           data-&gt;type = ToNewCString(tmp);</span>
<a href="#l15.51"></a><span id="l15.51">       }</span>
<a href="#l15.52"></a><span id="l15.52"> </span>
<a href="#l15.53"></a><span id="l15.53">       pVal = CMapiApi::GetMapiProperty(lpAttach, PR_ATTACH_CONTENT_ID_A);</span>
<a href="#l15.54"></a><span id="l15.54">       CMapiApi::GetStringFromProp(pVal, tmp);</span>
<a href="#l15.55"></a><span id="l15.55">       if (!tmp.IsEmpty())</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/import/src/nsImportService.cpp</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/import/src/nsImportService.cpp</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -184,18 +184,18 @@ NS_IMETHODIMP nsImportService::GetModule</span>
<a href="#l16.4"></a><span id="l16.4">     return NS_ERROR_FAILURE;</span>
<a href="#l16.5"></a><span id="l16.5"> </span>
<a href="#l16.6"></a><span id="l16.6">   ImportModuleDesc *  pDesc;</span>
<a href="#l16.7"></a><span id="l16.7">   int32_t  count = 0;</span>
<a href="#l16.8"></a><span id="l16.8">   for (int32_t i = 0; i &lt; m_pModules-&gt;GetCount(); i++) {</span>
<a href="#l16.9"></a><span id="l16.9">     pDesc = m_pModules-&gt;GetModuleDesc(i);</span>
<a href="#l16.10"></a><span id="l16.10">     if (pDesc-&gt;SupportsThings(filter)) {</span>
<a href="#l16.11"></a><span id="l16.11">       if (count == index) {</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-        *name = NS_strdup(pDesc-&gt;GetName());</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-        *moduleDescription = NS_strdup(pDesc-&gt;GetDescription());</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+        *name = NS_xstrdup(pDesc-&gt;GetName());</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+        *moduleDescription = NS_xstrdup(pDesc-&gt;GetDescription());</span>
<a href="#l16.16"></a><span id="l16.16">         return NS_OK;</span>
<a href="#l16.17"></a><span id="l16.17">       }</span>
<a href="#l16.18"></a><span id="l16.18">       else</span>
<a href="#l16.19"></a><span id="l16.19">         count++;</span>
<a href="#l16.20"></a><span id="l16.20">     }</span>
<a href="#l16.21"></a><span id="l16.21">   }</span>
<a href="#l16.22"></a><span id="l16.22"> </span>
<a href="#l16.23"></a><span id="l16.23">   return NS_ERROR_FAILURE;</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineat">@@ -217,17 +217,17 @@ NS_IMETHODIMP nsImportService::GetModule</span>
<a href="#l16.25"></a><span id="l16.25">     return NS_ERROR_FAILURE;</span>
<a href="#l16.26"></a><span id="l16.26"> </span>
<a href="#l16.27"></a><span id="l16.27">   ImportModuleDesc *  pDesc;</span>
<a href="#l16.28"></a><span id="l16.28">   int32_t  count = 0;</span>
<a href="#l16.29"></a><span id="l16.29">   for (int32_t i = 0; i &lt; m_pModules-&gt;GetCount(); i++) {</span>
<a href="#l16.30"></a><span id="l16.30">     pDesc = m_pModules-&gt;GetModuleDesc(i);</span>
<a href="#l16.31"></a><span id="l16.31">     if (pDesc-&gt;SupportsThings(filter)) {</span>
<a href="#l16.32"></a><span id="l16.32">       if (count == index) {</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineminus">-        *_retval = NS_strdup(pDesc-&gt;GetName());</span>
<a href="#l16.34"></a><span id="l16.34" class="difflineplus">+        *_retval = NS_xstrdup(pDesc-&gt;GetName());</span>
<a href="#l16.35"></a><span id="l16.35">         return NS_OK;</span>
<a href="#l16.36"></a><span id="l16.36">       }</span>
<a href="#l16.37"></a><span id="l16.37">       else</span>
<a href="#l16.38"></a><span id="l16.38">         count++;</span>
<a href="#l16.39"></a><span id="l16.39">     }</span>
<a href="#l16.40"></a><span id="l16.40">   }</span>
<a href="#l16.41"></a><span id="l16.41"> </span>
<a href="#l16.42"></a><span id="l16.42">   return NS_ERROR_FAILURE;</span>
<a href="#l16.43"></a><span id="l16.43" class="difflineat">@@ -250,17 +250,17 @@ NS_IMETHODIMP nsImportService::GetModule</span>
<a href="#l16.44"></a><span id="l16.44">     return NS_ERROR_FAILURE;</span>
<a href="#l16.45"></a><span id="l16.45"> </span>
<a href="#l16.46"></a><span id="l16.46">   ImportModuleDesc *  pDesc;</span>
<a href="#l16.47"></a><span id="l16.47">   int32_t  count = 0;</span>
<a href="#l16.48"></a><span id="l16.48">   for (int32_t i = 0; i &lt; m_pModules-&gt;GetCount(); i++) {</span>
<a href="#l16.49"></a><span id="l16.49">     pDesc = m_pModules-&gt;GetModuleDesc(i);</span>
<a href="#l16.50"></a><span id="l16.50">     if (pDesc-&gt;SupportsThings(filter)) {</span>
<a href="#l16.51"></a><span id="l16.51">       if (count == index) {</span>
<a href="#l16.52"></a><span id="l16.52" class="difflineminus">-        *_retval = NS_strdup(pDesc-&gt;GetDescription());</span>
<a href="#l16.53"></a><span id="l16.53" class="difflineplus">+        *_retval = NS_xstrdup(pDesc-&gt;GetDescription());</span>
<a href="#l16.54"></a><span id="l16.54">         return NS_OK;</span>
<a href="#l16.55"></a><span id="l16.55">       }</span>
<a href="#l16.56"></a><span id="l16.56">       else</span>
<a href="#l16.57"></a><span id="l16.57">         count++;</span>
<a href="#l16.58"></a><span id="l16.58">     }</span>
<a href="#l16.59"></a><span id="l16.59">   }</span>
<a href="#l16.60"></a><span id="l16.60"> </span>
<a href="#l16.61"></a><span id="l16.61">   return NS_ERROR_FAILURE;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/import/text/src/nsTextImport.cpp</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/import/text/src/nsTextImport.cpp</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -536,17 +536,17 @@ NS_IMETHODIMP ImportAddressImpl::GetSamp</span>
<a href="#l17.4"></a><span id="l17.4">   }</span>
<a href="#l17.5"></a><span id="l17.5"> </span>
<a href="#l17.6"></a><span id="l17.6">   bool fileExists;</span>
<a href="#l17.7"></a><span id="l17.7">   rv = m_fileLoc-&gt;Exists(&amp;fileExists);</span>
<a href="#l17.8"></a><span id="l17.8">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l17.9"></a><span id="l17.9"> </span>
<a href="#l17.10"></a><span id="l17.10">   if (!fileExists) {</span>
<a href="#l17.11"></a><span id="l17.11">     *pFound = false;</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-    *pStr = NS_strdup(&amp;term);</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+    *pStr = NS_xstrdup(&amp;term);</span>
<a href="#l17.14"></a><span id="l17.14">     return NS_OK;</span>
<a href="#l17.15"></a><span id="l17.15">   }</span>
<a href="#l17.16"></a><span id="l17.16"> </span>
<a href="#l17.17"></a><span id="l17.17">   nsAutoString line;</span>
<a href="#l17.18"></a><span id="l17.18">   rv = nsTextAddress::ReadRecordNumber(m_fileLoc, line, index);</span>
<a href="#l17.19"></a><span id="l17.19">   if (NS_SUCCEEDED(rv)) {</span>
<a href="#l17.20"></a><span id="l17.20">     nsString str;</span>
<a href="#l17.21"></a><span id="l17.21">     nsString field;</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineat">@@ -562,17 +562,17 @@ NS_IMETHODIMP ImportAddressImpl::GetSamp</span>
<a href="#l17.23"></a><span id="l17.23"> </span>
<a href="#l17.24"></a><span id="l17.24">     *pStr = ToNewUnicode(str);</span>
<a href="#l17.25"></a><span id="l17.25">     *pFound = true;</span>
<a href="#l17.26"></a><span id="l17.26"> </span>
<a href="#l17.27"></a><span id="l17.27">     /* IMPORT_LOG1(&quot;Sample data: %S\n&quot;, str.get()); */</span>
<a href="#l17.28"></a><span id="l17.28">   }</span>
<a href="#l17.29"></a><span id="l17.29">   else {</span>
<a href="#l17.30"></a><span id="l17.30">     *pFound = false;</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineminus">-    *pStr = NS_strdup(&amp;term);</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+    *pStr = NS_xstrdup(&amp;term);</span>
<a href="#l17.33"></a><span id="l17.33">   }</span>
<a href="#l17.34"></a><span id="l17.34"> </span>
<a href="#l17.35"></a><span id="l17.35">   return NS_OK;</span>
<a href="#l17.36"></a><span id="l17.36"> }</span>
<a href="#l17.37"></a><span id="l17.37"> </span>
<a href="#l17.38"></a><span id="l17.38"> NS_IMETHODIMP ImportAddressImpl::SetSampleLocation(nsIFile *pLocation)</span>
<a href="#l17.39"></a><span id="l17.39"> {</span>
<a href="#l17.40"></a><span id="l17.40">   NS_ENSURE_ARG_POINTER(pLocation);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/mime/src/nsStreamConverter.cpp</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/mime/src/nsStreamConverter.cpp</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -673,17 +673,17 @@ NS_IMETHODIMP nsStreamConverter::GetCont</span>
<a href="#l18.4"></a><span id="l18.4">     return NS_ERROR_NULL_POINTER;</span>
<a href="#l18.5"></a><span id="l18.5"> </span>
<a href="#l18.6"></a><span id="l18.6">   // since this method passes a string through an IDL file we need to use nsMemory to allocate it</span>
<a href="#l18.7"></a><span id="l18.7">   // and not strdup!</span>
<a href="#l18.8"></a><span id="l18.8">   //  (1) check to see if we have a real content type...use it first...</span>
<a href="#l18.9"></a><span id="l18.9">   if (!mRealContentType.IsEmpty())</span>
<a href="#l18.10"></a><span id="l18.10">     *aOutputContentType = ToNewCString(mRealContentType);</span>
<a href="#l18.11"></a><span id="l18.11">   else if (mOutputFormat.EqualsLiteral(&quot;raw&quot;))</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-    *aOutputContentType = (char *) nsMemory::Clone(UNKNOWN_CONTENT_TYPE, sizeof(UNKNOWN_CONTENT_TYPE));</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+    *aOutputContentType = (char *) moz_xmemdup(UNKNOWN_CONTENT_TYPE, sizeof(UNKNOWN_CONTENT_TYPE));</span>
<a href="#l18.14"></a><span id="l18.14">   else</span>
<a href="#l18.15"></a><span id="l18.15">     *aOutputContentType = ToNewCString(mOutputFormat);</span>
<a href="#l18.16"></a><span id="l18.16">   return NS_OK;</span>
<a href="#l18.17"></a><span id="l18.17"> }</span>
<a href="#l18.18"></a><span id="l18.18"> </span>
<a href="#l18.19"></a><span id="l18.19"> //</span>
<a href="#l18.20"></a><span id="l18.20"> // This is the type of output operation that is being requested by libmime. The types</span>
<a href="#l18.21"></a><span id="l18.21"> // of output are specified by nsIMimeOutputType enum</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/news/src/nsNNTPProtocol.cpp</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/news/src/nsNNTPProtocol.cpp</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -1650,17 +1650,17 @@ nsresult nsNNTPProtocol::GetPropertiesRe</span>
<a href="#l19.4"></a><span id="l19.4">     SetFlag(NNTP_PAUSE_FOR_READ);</span>
<a href="#l19.5"></a><span id="l19.5">     return NS_OK;</span>
<a href="#l19.6"></a><span id="l19.6">   }</span>
<a href="#l19.7"></a><span id="l19.7">   if (!line)</span>
<a href="#l19.8"></a><span id="l19.8">     return rv;  /* no line yet */</span>
<a href="#l19.9"></a><span id="l19.9"> </span>
<a href="#l19.10"></a><span id="l19.10">   if ('.' != line[0])</span>
<a href="#l19.11"></a><span id="l19.11">   {</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-    char *propertyName = NS_strdup(line);</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+    char *propertyName = NS_xstrdup(line);</span>
<a href="#l19.14"></a><span id="l19.14">     if (propertyName)</span>
<a href="#l19.15"></a><span id="l19.15">     {</span>
<a href="#l19.16"></a><span id="l19.16">       char *space = PL_strchr(propertyName, ' ');</span>
<a href="#l19.17"></a><span id="l19.17">       if (space)</span>
<a href="#l19.18"></a><span id="l19.18">       {</span>
<a href="#l19.19"></a><span id="l19.19">         char *propertyValue = space + 1;</span>
<a href="#l19.20"></a><span id="l19.20">         *space = '\0';</span>
<a href="#l19.21"></a><span id="l19.21">                 m_nntpServer-&gt;AddPropertyForGet(propertyName, propertyValue);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/rdf/base/nsRDFService.cpp</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/rdf/base/nsRDFService.cpp</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -462,17 +462,17 @@ LiteralImpl::EqualsNode(nsIRDFNode* aNod</span>
<a href="#l20.4"></a><span id="l20.4"> NS_IMETHODIMP</span>
<a href="#l20.5"></a><span id="l20.5"> LiteralImpl::GetValue(char16_t* *value)</span>
<a href="#l20.6"></a><span id="l20.6"> {</span>
<a href="#l20.7"></a><span id="l20.7">     NS_ASSERTION(value, &quot;null ptr&quot;);</span>
<a href="#l20.8"></a><span id="l20.8">     if (! value)</span>
<a href="#l20.9"></a><span id="l20.9">         return NS_ERROR_NULL_POINTER;</span>
<a href="#l20.10"></a><span id="l20.10"> </span>
<a href="#l20.11"></a><span id="l20.11">     const char16_t *temp = GetValue();</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-    *value = temp? NS_strdup(temp) : 0;</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+    *value = temp? NS_xstrdup(temp) : 0;</span>
<a href="#l20.14"></a><span id="l20.14">     return NS_OK;</span>
<a href="#l20.15"></a><span id="l20.15"> }</span>
<a href="#l20.16"></a><span id="l20.16"> </span>
<a href="#l20.17"></a><span id="l20.17"> </span>
<a href="#l20.18"></a><span id="l20.18"> NS_IMETHODIMP</span>
<a href="#l20.19"></a><span id="l20.19"> LiteralImpl::GetValueConst(const char16_t** aValue)</span>
<a href="#l20.20"></a><span id="l20.20"> {</span>
<a href="#l20.21"></a><span id="l20.21">     *aValue = GetValue();</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

