<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 6418:faf35fa380ca81292c391ade64bfa84fd150fe89</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ faf35fa380ca81292c391ade64bfa84fd150fe89" />
<meta property="og:url" content="/comm-central/rev/faf35fa380ca81292c391ade64bfa84fd150fe89" />
<meta property="og:description" content="bug 569341 - Implement a Data Manager unifying cookie, permission, password, and form data management, r=IanN sr=Neil" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / faf35fa380ca81292c391ade64bfa84fd150fe89 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/faf35fa380ca81292c391ade64bfa84fd150fe89">shortlog</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/faf35fa380ca81292c391ade64bfa84fd150fe89">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89">files</a> |
changeset |
<a href="/comm-central/raw-rev/faf35fa380ca81292c391ade64bfa84fd150fe89">raw</a>  | <a href="/comm-central/archive/faf35fa380ca81292c391ade64bfa84fd150fe89.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=569341">bug 569341</a> - Implement a Data Manager unifying cookie, permission, password, and form data management, r=IanN sr=Neil
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#82;&#111;&#98;&#101;&#114;&#116;&#32;&#75;&#97;&#105;&#115;&#101;&#114;&#32;&#60;&#107;&#97;&#105;&#114;&#111;&#64;&#107;&#97;&#105;&#114;&#111;&#46;&#97;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 24 Sep 2010 16:47:25 +0200</td></tr>

<tr>
 <td>changeset 6418</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/faf35fa380ca81292c391ade64bfa84fd150fe89">faf35fa380ca81292c391ade64bfa84fd150fe89</a></td>
</tr>



<tr>
<td>parent 6417</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/50cab7663d15742ab606d9df25585974155f5f62">50cab7663d15742ab606d9df25585974155f5f62</a>
</td>
</tr>

<tr>
<td>child 6419</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/4db8f7c2bd430dcdf1577ed4c138f72ac6416442">4db8f7c2bd430dcdf1577ed4c138f72ac6416442</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=faf35fa380ca81292c391ade64bfa84fd150fe89">4956</a></td></tr>
<tr><td>push user</td><td>kairo@kairo.at</td></tr>
<tr><td>push date</td><td class="date age">Fri, 24 Sep 2010 14:47:57 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@faf35fa380ca [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=faf35fa380ca81292c391ade64bfa84fd150fe89">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=faf35fa380ca81292c391ade64bfa84fd150fe89&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=faf35fa380ca81292c391ade64bfa84fd150fe89&newProject=comm-central&newRevision=faf35fa380ca81292c391ade64bfa84fd150fe89&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=faf35fa380ca81292c391ade64bfa84fd150fe89&newProject=comm-central&newRevision=faf35fa380ca81292c391ade64bfa84fd150fe89&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=faf35fa380ca81292c391ade64bfa84fd150fe89&newProject=comm-central&newRevision=faf35fa380ca81292c391ade64bfa84fd150fe89&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28IanN%29&revcount=50">IanN</a>, <a href="/comm-central/log?rev=reviewer%28Neil%29&revcount=50">Neil</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=569341">569341</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=569341">bug 569341</a> - Implement a Data Manager unifying cookie, permission, password, and form data management, r=IanN sr=Neil</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/Makefile.in">suite/common/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/Makefile.in">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/Makefile.in">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/Makefile.in">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/Makefile.in">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.css">suite/common/dataman/dataman.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.css">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.css">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.css">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.css">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.js">suite/common/dataman/dataman.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.js">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.js">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.js">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.js">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xml">suite/common/dataman/dataman.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xml">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xml">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xml">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xml">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xul">suite/common/dataman/dataman.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xul">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xul">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xul">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xul">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/dataman.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/Makefile.in">suite/common/dataman/tests/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/Makefile.in">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/Makefile.in">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/Makefile.in">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/Makefile.in">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/browser_dataman_basics.js">suite/common/dataman/tests/browser_dataman_basics.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/browser_dataman_basics.js">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/browser_dataman_basics.js">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/browser_dataman_basics.js">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/browser_dataman_basics.js">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/dataman/tests/browser_dataman_basics.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/jar.mn">suite/common/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/jar.mn">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/jar.mn">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/jar.mn">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/jar.mn">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/Makefile.in">suite/common/src/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/Makefile.in">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/Makefile.in">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/Makefile.in">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/Makefile.in">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/SuiteCommon.manifest">suite/common/src/SuiteCommon.manifest</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/SuiteCommon.manifest">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/SuiteCommon.manifest">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/SuiteCommon.manifest">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/SuiteCommon.manifest">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/SuiteCommon.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/nsAboutData.js">suite/common/src/nsAboutData.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/nsAboutData.js">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/nsAboutData.js">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/nsAboutData.js">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/nsAboutData.js">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/src/nsAboutData.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/tasksOverlay.xul">suite/common/tasksOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/tasksOverlay.xul">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/tasksOverlay.xul">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/tasksOverlay.xul">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/tasksOverlay.xul">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/common/tasksOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/installer/package-manifest.in">suite/installer/package-manifest.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/installer/package-manifest.in">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/installer/package-manifest.in">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/installer/package-manifest.in">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/installer/package-manifest.in">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/installer/package-manifest.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.dtd">suite/locales/en-US/chrome/common/dataman/dataman.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.dtd">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.dtd">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.dtd">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.dtd">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.properties">suite/locales/en-US/chrome/common/dataman/dataman.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.properties">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.properties">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.properties">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.properties">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/dataman/dataman.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/tasksOverlay.dtd">suite/locales/en-US/chrome/common/tasksOverlay.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/tasksOverlay.dtd">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/tasksOverlay.dtd">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/tasksOverlay.dtd">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/tasksOverlay.dtd">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/en-US/chrome/common/tasksOverlay.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/jar.mn">suite/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/locales/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/communicator/dataman/dataman.css">suite/themes/classic/communicator/dataman/dataman.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/communicator/dataman/dataman.css">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/communicator/dataman/dataman.css">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/communicator/dataman/dataman.css">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/communicator/dataman/dataman.css">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/communicator/dataman/dataman.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/jar.mn">suite/themes/classic/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/jar.mn">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/jar.mn">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/jar.mn">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/jar.mn">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/classic/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/communicator/dataman/dataman.css">suite/themes/modern/communicator/dataman/dataman.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/communicator/dataman/dataman.css">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/communicator/dataman/dataman.css">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/communicator/dataman/dataman.css">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/communicator/dataman/dataman.css">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/communicator/dataman/dataman.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/jar.mn">suite/themes/modern/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/jar.mn">file</a> |
<a href="/comm-central/annotate/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/jar.mn">annotate</a> |
<a href="/comm-central/diff/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/jar.mn">diff</a> |
<a href="/comm-central/comparison/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/jar.mn">comparison</a> |
<a href="/comm-central/log/faf35fa380ca81292c391ade64bfa84fd150fe89/suite/themes/modern/jar.mn">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/suite/common/Makefile.in</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/suite/common/Makefile.in</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -40,17 +40,17 @@ topsrcdir	= @top_srcdir@</span>
<a href="#l1.4"></a><span id="l1.4"> srcdir		= @srcdir@</span>
<a href="#l1.5"></a><span id="l1.5"> VPATH		= @srcdir@</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7"> include $(DEPTH)/config/autoconf.mk</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9"> PARALLEL_DIRS = public src</span>
<a href="#l1.10"></a><span id="l1.10"> </span>
<a href="#l1.11"></a><span id="l1.11"> ifdef ENABLE_TESTS</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-PARALLEL_DIRS += tests downloads/tests places/tests</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+PARALLEL_DIRS += tests dataman/tests downloads/tests places/tests</span>
<a href="#l1.14"></a><span id="l1.14"> endif</span>
<a href="#l1.15"></a><span id="l1.15"> </span>
<a href="#l1.16"></a><span id="l1.16"> include $(topsrcdir)/config/rules.mk</span>
<a href="#l1.17"></a><span id="l1.17"> </span>
<a href="#l1.18"></a><span id="l1.18"> abs_srcdir = $(call core_abspath,$(srcdir))</span>
<a href="#l1.19"></a><span id="l1.19"> </span>
<a href="#l1.20"></a><span id="l1.20"> CHROME_DEPS += $(abs_srcdir)/app-license.html</span>
<a href="#l1.21"></a><span id="l1.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1">new file mode 100644</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineminus">--- /dev/null</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineplus">+++ b/suite/common/dataman/dataman.css</span>
<a href="#l2.4"></a><span id="l2.4" class="difflineat">@@ -0,0 +1,54 @@</span>
<a href="#l2.5"></a><span id="l2.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l2.6"></a><span id="l2.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l2.7"></a><span id="l2.7" class="difflineplus">+ *</span>
<a href="#l2.8"></a><span id="l2.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l2.9"></a><span id="l2.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l2.10"></a><span id="l2.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l2.11"></a><span id="l2.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+ *</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+ * License.</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+ *</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+ * The Original Code is KaiRo's data manager.</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+ *</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+ * Robert Kaiser &lt;kairo@kairo.at&gt;.</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineplus">+ *</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineplus">+ *   Robert Kaiser &lt;kairo@kairo.at&gt; (original author)</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineplus">+ *</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineplus">+ * either of the GNU General Public License Version 2 or later (the &quot;GPL&quot;),</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineplus">+ * or the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineplus">+ *</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineplus">+</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineplus">+/* generic item gets used for permissions that don't need any special treatment */</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineplus">+richlistitem.permission {</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineplus">+  -moz-binding: url('chrome://communicator/content/dataman/dataman.xml#perm-generic-item');</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineplus">+  -moz-box-orient: vertical;</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineplus">+}</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineplus">+</span>
<a href="#l2.48"></a><span id="l2.48" class="difflineplus">+richlistitem.permission[type=&quot;cookie&quot;] {</span>
<a href="#l2.49"></a><span id="l2.49" class="difflineplus">+  -moz-binding: url('chrome://communicator/content/dataman/dataman.xml#perm-cookie-item');</span>
<a href="#l2.50"></a><span id="l2.50" class="difflineplus">+}</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineplus">+</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineplus">+richlistitem.permission[type=&quot;geo&quot;] {</span>
<a href="#l2.53"></a><span id="l2.53" class="difflineplus">+  -moz-binding: url('chrome://communicator/content/dataman/dataman.xml#perm-geo-item');</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineplus">+}</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineplus">+</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineplus">+richlistitem.permission[type=&quot;password&quot;] {</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineplus">+  -moz-binding: url('chrome://communicator/content/dataman/dataman.xml#perm-password-item');</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1">new file mode 100644</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineminus">--- /dev/null</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineplus">+++ b/suite/common/dataman/dataman.js</span>
<a href="#l3.4"></a><span id="l3.4" class="difflineat">@@ -0,0 +1,2342 @@</span>
<a href="#l3.5"></a><span id="l3.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l3.6"></a><span id="l3.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l3.7"></a><span id="l3.7" class="difflineplus">+ *</span>
<a href="#l3.8"></a><span id="l3.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+ *</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+ * License.</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+ *</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+ * The Original Code is KaiRo's data manager.</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+ *</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+ * Robert Kaiser &lt;kairo@kairo.at&gt;.</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineplus">+ *</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+ *   Robert Kaiser &lt;kairo@kairo.at&gt; (original author)</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineplus">+ *</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+ * either of the GNU General Public License Version 2 or later (the &quot;GPL&quot;),</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+ * or the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineplus">+ *</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineplus">+</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l3.43"></a><span id="l3.43" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineplus">+</span>
<a href="#l3.45"></a><span id="l3.45" class="difflineplus">+// locally loaded services</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineplus">+var gLocSvc = {};</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineplus">+XPCOMUtils.defineLazyServiceGetter(gLocSvc, &quot;eTLD&quot;,</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineplus">+                                   &quot;@mozilla.org/network/effective-tld-service;1&quot;,</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineplus">+                                   &quot;nsIEffectiveTLDService&quot;);</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineplus">+XPCOMUtils.defineLazyServiceGetter(gLocSvc, &quot;cookie&quot;,</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineplus">+                                   &quot;@mozilla.org/cookiemanager;1&quot;,</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineplus">+                                   &quot;nsICookieManager2&quot;);</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineplus">+XPCOMUtils.defineLazyServiceGetter(gLocSvc, &quot;pwd&quot;,</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineplus">+                                   &quot;@mozilla.org/login-manager;1&quot;,</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineplus">+                                   &quot;nsILoginManager&quot;);</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineplus">+XPCOMUtils.defineLazyServiceGetter(gLocSvc, &quot;date&quot;,</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineplus">+                                   &quot;@mozilla.org/intl/scriptabledateformat;1&quot;,</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineplus">+                                   &quot;nsIScriptableDateFormat&quot;);</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineplus">+XPCOMUtils.defineLazyServiceGetter(gLocSvc, &quot;fhist&quot;,</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineplus">+                                   &quot;@mozilla.org/satchel/form-history;1&quot;,</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineplus">+                                   &quot;nsIFormHistory2&quot;);</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineplus">+XPCOMUtils.defineLazyServiceGetter(gLocSvc, &quot;url&quot;,</span>
<a href="#l3.63"></a><span id="l3.63" class="difflineplus">+                                   &quot;@mozilla.org/network/url-parser;1?auth=maybe&quot;,</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineplus">+                                   &quot;nsIURLParser&quot;);</span>
<a href="#l3.65"></a><span id="l3.65" class="difflineplus">+XPCOMUtils.defineLazyServiceGetter(gLocSvc, &quot;clipboard&quot;,</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineplus">+                                   &quot;@mozilla.org/widget/clipboardhelper;1&quot;,</span>
<a href="#l3.67"></a><span id="l3.67" class="difflineplus">+                                   &quot;nsIClipboardHelper&quot;);</span>
<a href="#l3.68"></a><span id="l3.68" class="difflineplus">+</span>
<a href="#l3.69"></a><span id="l3.69" class="difflineplus">+// :::::::::::::::::::: general functions ::::::::::::::::::::</span>
<a href="#l3.70"></a><span id="l3.70" class="difflineplus">+var gDataman = {</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineplus">+  bundle: null,</span>
<a href="#l3.72"></a><span id="l3.72" class="difflineplus">+  debug: false,</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineplus">+</span>
<a href="#l3.74"></a><span id="l3.74" class="difflineplus">+  initialize: function dataman_initialize() {</span>
<a href="#l3.75"></a><span id="l3.75" class="difflineplus">+    try {</span>
<a href="#l3.76"></a><span id="l3.76" class="difflineplus">+      this.debug = Services.prefs.getBoolPref(&quot;data_manager.debug&quot;);</span>
<a href="#l3.77"></a><span id="l3.77" class="difflineplus">+    }</span>
<a href="#l3.78"></a><span id="l3.78" class="difflineplus">+    catch (e) {}</span>
<a href="#l3.79"></a><span id="l3.79" class="difflineplus">+    this.bundle = document.getElementById(&quot;datamanBundle&quot;);</span>
<a href="#l3.80"></a><span id="l3.80" class="difflineplus">+</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineplus">+    Services.obs.addObserver(this, &quot;cookie-changed&quot;, false);</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineplus">+    Services.obs.addObserver(this, &quot;perm-changed&quot;, false);</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineplus">+    Services.obs.addObserver(this, &quot;passwordmgr-storage-changed&quot;, false);</span>
<a href="#l3.84"></a><span id="l3.84" class="difflineplus">+    Services.contentPrefs.addObserver(null, this);</span>
<a href="#l3.85"></a><span id="l3.85" class="difflineplus">+    Services.obs.addObserver(this, &quot;satchel-storage-changed&quot;, false);</span>
<a href="#l3.86"></a><span id="l3.86" class="difflineplus">+</span>
<a href="#l3.87"></a><span id="l3.87" class="difflineplus">+    gTabs.initialize();</span>
<a href="#l3.88"></a><span id="l3.88" class="difflineplus">+    gDomains.initialize();</span>
<a href="#l3.89"></a><span id="l3.89" class="difflineplus">+  },</span>
<a href="#l3.90"></a><span id="l3.90" class="difflineplus">+</span>
<a href="#l3.91"></a><span id="l3.91" class="difflineplus">+  shutdown: function dataman_shutdown() {</span>
<a href="#l3.92"></a><span id="l3.92" class="difflineplus">+    Services.obs.removeObserver(this, &quot;cookie-changed&quot;);</span>
<a href="#l3.93"></a><span id="l3.93" class="difflineplus">+    Services.obs.removeObserver(this, &quot;perm-changed&quot;);</span>
<a href="#l3.94"></a><span id="l3.94" class="difflineplus">+    Services.obs.removeObserver(this, &quot;passwordmgr-storage-changed&quot;);</span>
<a href="#l3.95"></a><span id="l3.95" class="difflineplus">+    Services.contentPrefs.removeObserver(null, this);</span>
<a href="#l3.96"></a><span id="l3.96" class="difflineplus">+    Services.obs.removeObserver(this, &quot;satchel-storage-changed&quot;);</span>
<a href="#l3.97"></a><span id="l3.97" class="difflineplus">+</span>
<a href="#l3.98"></a><span id="l3.98" class="difflineplus">+    gDomains.shutdown();</span>
<a href="#l3.99"></a><span id="l3.99" class="difflineplus">+  },</span>
<a href="#l3.100"></a><span id="l3.100" class="difflineplus">+</span>
<a href="#l3.101"></a><span id="l3.101" class="difflineplus">+  debugMsg: function dataman_debugMsg(aLogMessage) {</span>
<a href="#l3.102"></a><span id="l3.102" class="difflineplus">+    if (this.debug)</span>
<a href="#l3.103"></a><span id="l3.103" class="difflineplus">+      Services.console.logStringMessage(aLogMessage);</span>
<a href="#l3.104"></a><span id="l3.104" class="difflineplus">+  },</span>
<a href="#l3.105"></a><span id="l3.105" class="difflineplus">+</span>
<a href="#l3.106"></a><span id="l3.106" class="difflineplus">+  debugError: function dataman_debugError(aLogMessage) {</span>
<a href="#l3.107"></a><span id="l3.107" class="difflineplus">+    if (this.debug)</span>
<a href="#l3.108"></a><span id="l3.108" class="difflineplus">+      Components.utils.reportError(aLogMessage);</span>
<a href="#l3.109"></a><span id="l3.109" class="difflineplus">+  },</span>
<a href="#l3.110"></a><span id="l3.110" class="difflineplus">+</span>
<a href="#l3.111"></a><span id="l3.111" class="difflineplus">+  // :::::::::: data change observers ::::::::::</span>
<a href="#l3.112"></a><span id="l3.112" class="difflineplus">+  QueryInterface: XPCOMUtils.generateQI([Components.interfaces.nsIObserver,</span>
<a href="#l3.113"></a><span id="l3.113" class="difflineplus">+                                         Components.interfaces.nsIContentPrefObserver]),</span>
<a href="#l3.114"></a><span id="l3.114" class="difflineplus">+</span>
<a href="#l3.115"></a><span id="l3.115" class="difflineplus">+  observe: function co_observe(aSubject, aTopic, aData) {</span>
<a href="#l3.116"></a><span id="l3.116" class="difflineplus">+    gDataman.debugMsg(&quot;Observed: &quot; + aTopic + &quot; - &quot; + aData);</span>
<a href="#l3.117"></a><span id="l3.117" class="difflineplus">+    switch (aTopic) {</span>
<a href="#l3.118"></a><span id="l3.118" class="difflineplus">+      case &quot;cookie-changed&quot;:</span>
<a href="#l3.119"></a><span id="l3.119" class="difflineplus">+        gCookies.reactToChange(aSubject, aData);</span>
<a href="#l3.120"></a><span id="l3.120" class="difflineplus">+        break;</span>
<a href="#l3.121"></a><span id="l3.121" class="difflineplus">+      case &quot;perm-changed&quot;:</span>
<a href="#l3.122"></a><span id="l3.122" class="difflineplus">+        gPerms.reactToChange(aSubject, aData);</span>
<a href="#l3.123"></a><span id="l3.123" class="difflineplus">+        break;</span>
<a href="#l3.124"></a><span id="l3.124" class="difflineplus">+      case &quot;passwordmgr-storage-changed&quot;:</span>
<a href="#l3.125"></a><span id="l3.125" class="difflineplus">+        if (/^hostSaving/.test(aData))</span>
<a href="#l3.126"></a><span id="l3.126" class="difflineplus">+          gPerms.reactToChange(aSubject, aData);</span>
<a href="#l3.127"></a><span id="l3.127" class="difflineplus">+        else</span>
<a href="#l3.128"></a><span id="l3.128" class="difflineplus">+          gPasswords.reactToChange(aSubject, aData);</span>
<a href="#l3.129"></a><span id="l3.129" class="difflineplus">+        break;</span>
<a href="#l3.130"></a><span id="l3.130" class="difflineplus">+      case &quot;satchel-storage-changed&quot;:</span>
<a href="#l3.131"></a><span id="l3.131" class="difflineplus">+        gFormdata.reactToChange(aSubject, aData);</span>
<a href="#l3.132"></a><span id="l3.132" class="difflineplus">+        break;</span>
<a href="#l3.133"></a><span id="l3.133" class="difflineplus">+      default:</span>
<a href="#l3.134"></a><span id="l3.134" class="difflineplus">+        gDataman.debugError(&quot;Unexpected change topic observed: &quot; + aTopic);</span>
<a href="#l3.135"></a><span id="l3.135" class="difflineplus">+        break;</span>
<a href="#l3.136"></a><span id="l3.136" class="difflineplus">+    }</span>
<a href="#l3.137"></a><span id="l3.137" class="difflineplus">+  },</span>
<a href="#l3.138"></a><span id="l3.138" class="difflineplus">+</span>
<a href="#l3.139"></a><span id="l3.139" class="difflineplus">+  onContentPrefSet: function co_onContentPrefSet(aGroup, aName, aValue) {</span>
<a href="#l3.140"></a><span id="l3.140" class="difflineplus">+    gDataman.debugMsg(&quot;Observed: content pref set&quot;);</span>
<a href="#l3.141"></a><span id="l3.141" class="difflineplus">+    gPrefs.reactToChange({host: aGroup, name: aName, value: aValue}, &quot;prefSet&quot;);</span>
<a href="#l3.142"></a><span id="l3.142" class="difflineplus">+  },</span>
<a href="#l3.143"></a><span id="l3.143" class="difflineplus">+</span>
<a href="#l3.144"></a><span id="l3.144" class="difflineplus">+  onContentPrefRemoved: function co_onContentPrefRemoved(aGroup, aName) {</span>
<a href="#l3.145"></a><span id="l3.145" class="difflineplus">+    gDataman.debugMsg(&quot;Observed: content pref removed&quot;);</span>
<a href="#l3.146"></a><span id="l3.146" class="difflineplus">+    gPrefs.reactToChange({host: aGroup, name: aName}, &quot;prefRemoved&quot;);</span>
<a href="#l3.147"></a><span id="l3.147" class="difflineplus">+  },</span>
<a href="#l3.148"></a><span id="l3.148" class="difflineplus">+</span>
<a href="#l3.149"></a><span id="l3.149" class="difflineplus">+  // :::::::::: utility functions ::::::::::</span>
<a href="#l3.150"></a><span id="l3.150" class="difflineplus">+  getTreeSelections: function dataman_getTreeSelections(aTree) {</span>
<a href="#l3.151"></a><span id="l3.151" class="difflineplus">+    let selections = [];</span>
<a href="#l3.152"></a><span id="l3.152" class="difflineplus">+    let select = aTree.view.selection;</span>
<a href="#l3.153"></a><span id="l3.153" class="difflineplus">+    if (select &amp;&amp; aTree.view.rowCount) {</span>
<a href="#l3.154"></a><span id="l3.154" class="difflineplus">+      let count = select.getRangeCount();</span>
<a href="#l3.155"></a><span id="l3.155" class="difflineplus">+      let min = {};</span>
<a href="#l3.156"></a><span id="l3.156" class="difflineplus">+      let max = {};</span>
<a href="#l3.157"></a><span id="l3.157" class="difflineplus">+      for (let i = 0; i &lt; count; i++) {</span>
<a href="#l3.158"></a><span id="l3.158" class="difflineplus">+        select.getRangeAt(i, min, max);</span>
<a href="#l3.159"></a><span id="l3.159" class="difflineplus">+        for (let k = min.value; k &lt;= max.value; k++)</span>
<a href="#l3.160"></a><span id="l3.160" class="difflineplus">+          if (k != -1)</span>
<a href="#l3.161"></a><span id="l3.161" class="difflineplus">+            selections.push(k);</span>
<a href="#l3.162"></a><span id="l3.162" class="difflineplus">+      }</span>
<a href="#l3.163"></a><span id="l3.163" class="difflineplus">+    }</span>
<a href="#l3.164"></a><span id="l3.164" class="difflineplus">+    return selections;</span>
<a href="#l3.165"></a><span id="l3.165" class="difflineplus">+  },</span>
<a href="#l3.166"></a><span id="l3.166" class="difflineplus">+</span>
<a href="#l3.167"></a><span id="l3.167" class="difflineplus">+  getSelectedIDs: function dataman_getSelectedIDs(aTree, aIDFunction) {</span>
<a href="#l3.168"></a><span id="l3.168" class="difflineplus">+    // Get IDs of selected elements for later restoration.</span>
<a href="#l3.169"></a><span id="l3.169" class="difflineplus">+    let selectionCache = [];</span>
<a href="#l3.170"></a><span id="l3.170" class="difflineplus">+    if (aTree.view.selection.count &lt; 1 || aTree.view.rowCount &lt; 1)</span>
<a href="#l3.171"></a><span id="l3.171" class="difflineplus">+      return selectionCache;</span>
<a href="#l3.172"></a><span id="l3.172" class="difflineplus">+</span>
<a href="#l3.173"></a><span id="l3.173" class="difflineplus">+    // Walk all selected rows and cache their IDs.</span>
<a href="#l3.174"></a><span id="l3.174" class="difflineplus">+    let start = {};</span>
<a href="#l3.175"></a><span id="l3.175" class="difflineplus">+    let end = {};</span>
<a href="#l3.176"></a><span id="l3.176" class="difflineplus">+    let numRanges = aTree.view.selection.getRangeCount();</span>
<a href="#l3.177"></a><span id="l3.177" class="difflineplus">+    for (let rg = 0; rg &lt; numRanges; rg++){</span>
<a href="#l3.178"></a><span id="l3.178" class="difflineplus">+      aTree.view.selection.getRangeAt(rg, start, end);</span>
<a href="#l3.179"></a><span id="l3.179" class="difflineplus">+      for (let row = start.value; row &lt;= end.value; row++)</span>
<a href="#l3.180"></a><span id="l3.180" class="difflineplus">+        selectionCache.push(aIDFunction(row));</span>
<a href="#l3.181"></a><span id="l3.181" class="difflineplus">+    }</span>
<a href="#l3.182"></a><span id="l3.182" class="difflineplus">+    return selectionCache;</span>
<a href="#l3.183"></a><span id="l3.183" class="difflineplus">+  },</span>
<a href="#l3.184"></a><span id="l3.184" class="difflineplus">+</span>
<a href="#l3.185"></a><span id="l3.185" class="difflineplus">+  restoreSelectionFromIDs: function dataman_getSelectedIDs(aTree, aIDFunction, aCachedIDs) {</span>
<a href="#l3.186"></a><span id="l3.186" class="difflineplus">+    // Restore selection from cached IDs (as possible).</span>
<a href="#l3.187"></a><span id="l3.187" class="difflineplus">+    if (!aCachedIDs.length)</span>
<a href="#l3.188"></a><span id="l3.188" class="difflineplus">+      return;</span>
<a href="#l3.189"></a><span id="l3.189" class="difflineplus">+</span>
<a href="#l3.190"></a><span id="l3.190" class="difflineplus">+    aTree.view.selection.clearSelection();</span>
<a href="#l3.191"></a><span id="l3.191" class="difflineplus">+    // Find out which current rows match a cached selection and add them to the selection.</span>
<a href="#l3.192"></a><span id="l3.192" class="difflineplus">+    for (let row = 0; row &lt; aTree.view.rowCount; row++)</span>
<a href="#l3.193"></a><span id="l3.193" class="difflineplus">+      if (aCachedIDs.indexOf(aIDFunction(row)) != -1)</span>
<a href="#l3.194"></a><span id="l3.194" class="difflineplus">+        aTree.view.selection.toggleSelect(row);</span>
<a href="#l3.195"></a><span id="l3.195" class="difflineplus">+  },</span>
<a href="#l3.196"></a><span id="l3.196" class="difflineplus">+}</span>
<a href="#l3.197"></a><span id="l3.197" class="difflineplus">+</span>
<a href="#l3.198"></a><span id="l3.198" class="difflineplus">+// :::::::::::::::::::: base object to use as a prototype for all others ::::::::::::::::::::</span>
<a href="#l3.199"></a><span id="l3.199" class="difflineplus">+var gBaseTreeView = {</span>
<a href="#l3.200"></a><span id="l3.200" class="difflineplus">+  setTree: function(aTree) {},</span>
<a href="#l3.201"></a><span id="l3.201" class="difflineplus">+  getImageSrc: function(aRow, aColumn) {},</span>
<a href="#l3.202"></a><span id="l3.202" class="difflineplus">+  getProgressMode: function(aRow, aColumn) {},</span>
<a href="#l3.203"></a><span id="l3.203" class="difflineplus">+  getCellValue: function(aRow, aColumn) {},</span>
<a href="#l3.204"></a><span id="l3.204" class="difflineplus">+  isSeparator: function(aIndex) { return false; },</span>
<a href="#l3.205"></a><span id="l3.205" class="difflineplus">+  isSorted: function() { return false; },</span>
<a href="#l3.206"></a><span id="l3.206" class="difflineplus">+  isContainer: function(aIndex) { return false; },</span>
<a href="#l3.207"></a><span id="l3.207" class="difflineplus">+  cycleHeader: function(aCol) {},</span>
<a href="#l3.208"></a><span id="l3.208" class="difflineplus">+  getRowProperties: function(aRow, aProp) {},</span>
<a href="#l3.209"></a><span id="l3.209" class="difflineplus">+  getColumnProperties: function(aColumn, aProp) {},</span>
<a href="#l3.210"></a><span id="l3.210" class="difflineplus">+  getCellProperties: function(aRow, aColumn, aProp) {}</span>
<a href="#l3.211"></a><span id="l3.211" class="difflineplus">+};</span>
<a href="#l3.212"></a><span id="l3.212" class="difflineplus">+</span>
<a href="#l3.213"></a><span id="l3.213" class="difflineplus">+// :::::::::::::::::::: domain list ::::::::::::::::::::</span>
<a href="#l3.214"></a><span id="l3.214" class="difflineplus">+var gDomains = {</span>
<a href="#l3.215"></a><span id="l3.215" class="difflineplus">+  tree: null,</span>
<a href="#l3.216"></a><span id="l3.216" class="difflineplus">+  searchfield: null,</span>
<a href="#l3.217"></a><span id="l3.217" class="difflineplus">+</span>
<a href="#l3.218"></a><span id="l3.218" class="difflineplus">+  domains: {},</span>
<a href="#l3.219"></a><span id="l3.219" class="difflineplus">+  domainObjects: {},</span>
<a href="#l3.220"></a><span id="l3.220" class="difflineplus">+  displayedDomains: [],</span>
<a href="#l3.221"></a><span id="l3.221" class="difflineplus">+  selectedDomain: {},</span>
<a href="#l3.222"></a><span id="l3.222" class="difflineplus">+  xlcache: {},</span>
<a href="#l3.223"></a><span id="l3.223" class="difflineplus">+</span>
<a href="#l3.224"></a><span id="l3.224" class="difflineplus">+  ignoreSelect: false,</span>
<a href="#l3.225"></a><span id="l3.225" class="difflineplus">+  ignoreUpdate: false,</span>
<a href="#l3.226"></a><span id="l3.226" class="difflineplus">+</span>
<a href="#l3.227"></a><span id="l3.227" class="difflineplus">+  initialize: function domain_initialize() {</span>
<a href="#l3.228"></a><span id="l3.228" class="difflineplus">+    gDataman.debugMsg(&quot;Start building domain list: &quot; + Date.now()/1000);</span>
<a href="#l3.229"></a><span id="l3.229" class="difflineplus">+</span>
<a href="#l3.230"></a><span id="l3.230" class="difflineplus">+    this.tree = document.getElementById(&quot;domainTree&quot;);</span>
<a href="#l3.231"></a><span id="l3.231" class="difflineplus">+    this.tree.view = this;</span>
<a href="#l3.232"></a><span id="l3.232" class="difflineplus">+</span>
<a href="#l3.233"></a><span id="l3.233" class="difflineplus">+    this.searchfield = document.getElementById(&quot;domainSearch&quot;);</span>
<a href="#l3.234"></a><span id="l3.234" class="difflineplus">+</span>
<a href="#l3.235"></a><span id="l3.235" class="difflineplus">+    // global &quot;domain&quot;</span>
<a href="#l3.236"></a><span id="l3.236" class="difflineplus">+    this.domainObjects[&quot;*&quot;] = {title: &quot;*&quot;,</span>
<a href="#l3.237"></a><span id="l3.237" class="difflineplus">+                               hasPreferences: Services.contentPrefs.getPrefs(null).enumerator.hasMoreElements(),</span>
<a href="#l3.238"></a><span id="l3.238" class="difflineplus">+                               hasFormData: true};</span>
<a href="#l3.239"></a><span id="l3.239" class="difflineplus">+    this.search(&quot;&quot;);</span>
<a href="#l3.240"></a><span id="l3.240" class="difflineplus">+    this.tree.view.selection.select(0);</span>
<a href="#l3.241"></a><span id="l3.241" class="difflineplus">+</span>
<a href="#l3.242"></a><span id="l3.242" class="difflineplus">+    let loaderInstance;</span>
<a href="#l3.243"></a><span id="l3.243" class="difflineplus">+    function nextStep() {</span>
<a href="#l3.244"></a><span id="l3.244" class="difflineplus">+      loaderInstance.next();</span>
<a href="#l3.245"></a><span id="l3.245" class="difflineplus">+    }</span>
<a href="#l3.246"></a><span id="l3.246" class="difflineplus">+    function loader() {</span>
<a href="#l3.247"></a><span id="l3.247" class="difflineplus">+      // Add domains for all cookies we find.</span>
<a href="#l3.248"></a><span id="l3.248" class="difflineplus">+      gDataman.debugMsg(&quot;Add cookies to domain list: &quot; + Date.now()/1000);</span>
<a href="#l3.249"></a><span id="l3.249" class="difflineplus">+      gDomains.ignoreUpdate = true;</span>
<a href="#l3.250"></a><span id="l3.250" class="difflineplus">+      gCookies.loadList();</span>
<a href="#l3.251"></a><span id="l3.251" class="difflineplus">+      for (let i = 0; i &lt; gCookies.cookies.length; i++)</span>
<a href="#l3.252"></a><span id="l3.252" class="difflineplus">+        gDomains.addDomainOrFlag(gCookies.cookies[i].rawHost, &quot;hasCookies&quot;);</span>
<a href="#l3.253"></a><span id="l3.253" class="difflineplus">+      gDomains.ignoreUpdate = false;</span>
<a href="#l3.254"></a><span id="l3.254" class="difflineplus">+      gDomains.search(gDomains.searchfield.value);</span>
<a href="#l3.255"></a><span id="l3.255" class="difflineplus">+      yield setTimeout(nextStep, 0);</span>
<a href="#l3.256"></a><span id="l3.256" class="difflineplus">+</span>
<a href="#l3.257"></a><span id="l3.257" class="difflineplus">+      // Add domains for permissions.</span>
<a href="#l3.258"></a><span id="l3.258" class="difflineplus">+      gDataman.debugMsg(&quot;Add permissions to domain list: &quot; + Date.now()/1000);</span>
<a href="#l3.259"></a><span id="l3.259" class="difflineplus">+      gDomains.ignoreUpdate = true;</span>
<a href="#l3.260"></a><span id="l3.260" class="difflineplus">+      let enumerator = Services.perms.enumerator;</span>
<a href="#l3.261"></a><span id="l3.261" class="difflineplus">+      while (enumerator.hasMoreElements()) {</span>
<a href="#l3.262"></a><span id="l3.262" class="difflineplus">+        let nextPermission = enumerator.getNext().QueryInterface(Components.interfaces.nsIPermission);</span>
<a href="#l3.263"></a><span id="l3.263" class="difflineplus">+        gDomains.addDomainOrFlag(nextPermission.host.replace(/^\./, &quot;&quot;), &quot;hasPermissions&quot;);</span>
<a href="#l3.264"></a><span id="l3.264" class="difflineplus">+      }</span>
<a href="#l3.265"></a><span id="l3.265" class="difflineplus">+      gDomains.ignoreUpdate = false;</span>
<a href="#l3.266"></a><span id="l3.266" class="difflineplus">+      gDomains.search(gDomains.searchfield.value);</span>
<a href="#l3.267"></a><span id="l3.267" class="difflineplus">+      yield setTimeout(nextStep, 0);</span>
<a href="#l3.268"></a><span id="l3.268" class="difflineplus">+</span>
<a href="#l3.269"></a><span id="l3.269" class="difflineplus">+      // Add domains for password rejects to permissions.</span>
<a href="#l3.270"></a><span id="l3.270" class="difflineplus">+      gDataman.debugMsg(&quot;Add pwd reject permissions to domain list: &quot; + Date.now()/1000);</span>
<a href="#l3.271"></a><span id="l3.271" class="difflineplus">+      gDomains.ignoreUpdate = true;</span>
<a href="#l3.272"></a><span id="l3.272" class="difflineplus">+      let rejectHosts = gLocSvc.pwd.getAllDisabledHosts();</span>
<a href="#l3.273"></a><span id="l3.273" class="difflineplus">+      for (let i = 0; i &lt; rejectHosts.length; i++)</span>
<a href="#l3.274"></a><span id="l3.274" class="difflineplus">+        gDomains.addDomainOrFlag(rejectHosts[i], &quot;hasPermissions&quot;);</span>
<a href="#l3.275"></a><span id="l3.275" class="difflineplus">+      gDomains.ignoreUpdate = false;</span>
<a href="#l3.276"></a><span id="l3.276" class="difflineplus">+      gDomains.search(gDomains.searchfield.value);</span>
<a href="#l3.277"></a><span id="l3.277" class="difflineplus">+      yield setTimeout(nextStep, 0);</span>
<a href="#l3.278"></a><span id="l3.278" class="difflineplus">+</span>
<a href="#l3.279"></a><span id="l3.279" class="difflineplus">+      // Add domains for content prefs.</span>
<a href="#l3.280"></a><span id="l3.280" class="difflineplus">+      gDataman.debugMsg(&quot;Add content prefs to domain list: &quot; + Date.now()/1000);</span>
<a href="#l3.281"></a><span id="l3.281" class="difflineplus">+      gDomains.ignoreUpdate = true;</span>
<a href="#l3.282"></a><span id="l3.282" class="difflineplus">+      try {</span>
<a href="#l3.283"></a><span id="l3.283" class="difflineplus">+        var statement = Services.contentPrefs.DBConnection.createStatement(&quot;SELECT groups.name AS host FROM groups&quot;);</span>
<a href="#l3.284"></a><span id="l3.284" class="difflineplus">+        while (statement.executeStep())</span>
<a href="#l3.285"></a><span id="l3.285" class="difflineplus">+          gDomains.addDomainOrFlag(statement.row[&quot;host&quot;], &quot;hasPreferences&quot;);</span>
<a href="#l3.286"></a><span id="l3.286" class="difflineplus">+      }</span>
<a href="#l3.287"></a><span id="l3.287" class="difflineplus">+      finally {</span>
<a href="#l3.288"></a><span id="l3.288" class="difflineplus">+        statement.reset();</span>
<a href="#l3.289"></a><span id="l3.289" class="difflineplus">+      }</span>
<a href="#l3.290"></a><span id="l3.290" class="difflineplus">+      gDomains.ignoreUpdate = false;</span>
<a href="#l3.291"></a><span id="l3.291" class="difflineplus">+      gDomains.search(gDomains.searchfield.value);</span>
<a href="#l3.292"></a><span id="l3.292" class="difflineplus">+      yield setTimeout(nextStep, 0);</span>
<a href="#l3.293"></a><span id="l3.293" class="difflineplus">+</span>
<a href="#l3.294"></a><span id="l3.294" class="difflineplus">+      // Add domains for passwords.</span>
<a href="#l3.295"></a><span id="l3.295" class="difflineplus">+      gDataman.debugMsg(&quot;Add passwords to domain list: &quot; + Date.now()/1000);</span>
<a href="#l3.296"></a><span id="l3.296" class="difflineplus">+      gDomains.ignoreUpdate = true;</span>
<a href="#l3.297"></a><span id="l3.297" class="difflineplus">+      gPasswords.loadList();</span>
<a href="#l3.298"></a><span id="l3.298" class="difflineplus">+      for (let i = 0; i &lt; gPasswords.allSignons.length; i++) {</span>
<a href="#l3.299"></a><span id="l3.299" class="difflineplus">+        gDomains.addDomainOrFlag(gPasswords.allSignons[i].hostname, &quot;hasPasswords&quot;);</span>
<a href="#l3.300"></a><span id="l3.300" class="difflineplus">+      }</span>
<a href="#l3.301"></a><span id="l3.301" class="difflineplus">+      gDomains.ignoreUpdate = false;</span>
<a href="#l3.302"></a><span id="l3.302" class="difflineplus">+      gDomains.search(gDomains.searchfield.value);</span>
<a href="#l3.303"></a><span id="l3.303" class="difflineplus">+      yield setTimeout(nextStep, 0);</span>
<a href="#l3.304"></a><span id="l3.304" class="difflineplus">+</span>
<a href="#l3.305"></a><span id="l3.305" class="difflineplus">+      // Send a notification that we finished.</span>
<a href="#l3.306"></a><span id="l3.306" class="difflineplus">+      gDataman.debugMsg(&quot;Domain list built: &quot; + Date.now()/1000);</span>
<a href="#l3.307"></a><span id="l3.307" class="difflineplus">+      Services.obs.notifyObservers(window, &quot;dataman-loaded&quot;, null);</span>
<a href="#l3.308"></a><span id="l3.308" class="difflineplus">+      yield;</span>
<a href="#l3.309"></a><span id="l3.309" class="difflineplus">+    }</span>
<a href="#l3.310"></a><span id="l3.310" class="difflineplus">+    loaderInstance = loader();</span>
<a href="#l3.311"></a><span id="l3.311" class="difflineplus">+    setTimeout(nextStep, 0);</span>
<a href="#l3.312"></a><span id="l3.312" class="difflineplus">+  },</span>
<a href="#l3.313"></a><span id="l3.313" class="difflineplus">+</span>
<a href="#l3.314"></a><span id="l3.314" class="difflineplus">+  shutdown: function domain_shutdown() {</span>
<a href="#l3.315"></a><span id="l3.315" class="difflineplus">+    gTabs.shutdown();</span>
<a href="#l3.316"></a><span id="l3.316" class="difflineplus">+    this.tree.view = null;</span>
<a href="#l3.317"></a><span id="l3.317" class="difflineplus">+  },</span>
<a href="#l3.318"></a><span id="l3.318" class="difflineplus">+</span>
<a href="#l3.319"></a><span id="l3.319" class="difflineplus">+  _getObjID: function domain__getObjID(aIdx) {</span>
<a href="#l3.320"></a><span id="l3.320" class="difflineplus">+    return gDomains.displayedDomains[aIdx].title;</span>
<a href="#l3.321"></a><span id="l3.321" class="difflineplus">+  },</span>
<a href="#l3.322"></a><span id="l3.322" class="difflineplus">+</span>
<a href="#l3.323"></a><span id="l3.323" class="difflineplus">+  getDomainFromHost: function domain_getDomainFromHost(aHostname) {</span>
<a href="#l3.324"></a><span id="l3.324" class="difflineplus">+    // Find the base domain name for the given host name.</span>
<a href="#l3.325"></a><span id="l3.325" class="difflineplus">+    if (!this.xlcache[aHostname]) {</span>
<a href="#l3.326"></a><span id="l3.326" class="difflineplus">+      // aHostname is not always an actual host name, but potentially something</span>
<a href="#l3.327"></a><span id="l3.327" class="difflineplus">+      // URI-like, e.g. gopher://example.com and newURI doesn't work there as we</span>
<a href="#l3.328"></a><span id="l3.328" class="difflineplus">+      // need to display entries for schemes that are not supported (any more).</span>
<a href="#l3.329"></a><span id="l3.329" class="difflineplus">+      // nsIURLParser is a fast way to generically ensure a pure host name.</span>
<a href="#l3.330"></a><span id="l3.330" class="difflineplus">+      // Return vars for nsIURLParser must all be objects,</span>
<a href="#l3.331"></a><span id="l3.331" class="difflineplus">+      // see bug 568997 for improvements to that interface.</span>
<a href="#l3.332"></a><span id="l3.332" class="difflineplus">+      var schemePos = {}, schemeLen = {}, authPos = {}, authLen = {}, pathPos = {},</span>
<a href="#l3.333"></a><span id="l3.333" class="difflineplus">+          pathLen = {}, usernamePos = {}, usernameLen = {}, passwordPos = {},</span>
<a href="#l3.334"></a><span id="l3.334" class="difflineplus">+          passwordLen = {}, hostnamePos = {}, hostnameLen = {}, port = {};</span>
<a href="#l3.335"></a><span id="l3.335" class="difflineplus">+      gLocSvc.url.parseURL(aHostname, -1, schemePos, schemeLen, authPos, authLen,</span>
<a href="#l3.336"></a><span id="l3.336" class="difflineplus">+                          pathPos, pathLen);</span>
<a href="#l3.337"></a><span id="l3.337" class="difflineplus">+      var auth = aHostname.substring(authPos.value, authPos.value + authLen.value);</span>
<a href="#l3.338"></a><span id="l3.338" class="difflineplus">+      gLocSvc.url.parseAuthority(auth, authLen.value, usernamePos, usernameLen,</span>
<a href="#l3.339"></a><span id="l3.339" class="difflineplus">+                                passwordPos, passwordLen, hostnamePos, hostnameLen, port);</span>
<a href="#l3.340"></a><span id="l3.340" class="difflineplus">+      var hostName = auth.substring(hostnamePos.value, hostnamePos.value + hostnameLen.value);</span>
<a href="#l3.341"></a><span id="l3.341" class="difflineplus">+</span>
<a href="#l3.342"></a><span id="l3.342" class="difflineplus">+      var domain;</span>
<a href="#l3.343"></a><span id="l3.343" class="difflineplus">+      try {</span>
<a href="#l3.344"></a><span id="l3.344" class="difflineplus">+        domain = gLocSvc.eTLD.getBaseDomainFromHost(hostName);</span>
<a href="#l3.345"></a><span id="l3.345" class="difflineplus">+      }</span>
<a href="#l3.346"></a><span id="l3.346" class="difflineplus">+      catch (e) {</span>
<a href="#l3.347"></a><span id="l3.347" class="difflineplus">+        domain = hostName;</span>
<a href="#l3.348"></a><span id="l3.348" class="difflineplus">+      }</span>
<a href="#l3.349"></a><span id="l3.349" class="difflineplus">+      this.xlcache[aHostname] = domain;</span>
<a href="#l3.350"></a><span id="l3.350" class="difflineplus">+      gDataman.debugMsg(&quot;cached: &quot; + aHostname + &quot; -&gt; &quot; + this.xlcache[aHostname]);</span>
<a href="#l3.351"></a><span id="l3.351" class="difflineplus">+    }</span>
<a href="#l3.352"></a><span id="l3.352" class="difflineplus">+    return this.xlcache[aHostname];</span>
<a href="#l3.353"></a><span id="l3.353" class="difflineplus">+  },</span>
<a href="#l3.354"></a><span id="l3.354" class="difflineplus">+</span>
<a href="#l3.355"></a><span id="l3.355" class="difflineplus">+  hostMatchesSelected: function domain_hostMatchesSelected(aHostname) {</span>
<a href="#l3.356"></a><span id="l3.356" class="difflineplus">+    return this.getDomainFromHost(aHostname) == this.selectedDomain.title;</span>
<a href="#l3.357"></a><span id="l3.357" class="difflineplus">+  },</span>
<a href="#l3.358"></a><span id="l3.358" class="difflineplus">+</span>
<a href="#l3.359"></a><span id="l3.359" class="difflineplus">+  addDomainOrFlag: function domain_addDomainOrFlag(aHostname, aFlag) {</span>
<a href="#l3.360"></a><span id="l3.360" class="difflineplus">+    // For existing domains, add flags, for others, add them to the object.</span>
<a href="#l3.361"></a><span id="l3.361" class="difflineplus">+    let domain = this.getDomainFromHost(aHostname);</span>
<a href="#l3.362"></a><span id="l3.362" class="difflineplus">+    if (!this.domainObjects[domain]) {</span>
<a href="#l3.363"></a><span id="l3.363" class="difflineplus">+      this.domainObjects[domain] = {title: domain};</span>
<a href="#l3.364"></a><span id="l3.364" class="difflineplus">+      this.domainObjects[domain][aFlag] = true;</span>
<a href="#l3.365"></a><span id="l3.365" class="difflineplus">+      gDataman.debugMsg(&quot;added domain: &quot; + domain + &quot; (with flag &quot; + aFlag + &quot;)&quot;);</span>
<a href="#l3.366"></a><span id="l3.366" class="difflineplus">+      if (!this.ignoreUpdate)</span>
<a href="#l3.367"></a><span id="l3.367" class="difflineplus">+        this.search(this.searchfield.value);</span>
<a href="#l3.368"></a><span id="l3.368" class="difflineplus">+    }</span>
<a href="#l3.369"></a><span id="l3.369" class="difflineplus">+    else if (!this.domainObjects[domain][aFlag]) {</span>
<a href="#l3.370"></a><span id="l3.370" class="difflineplus">+      this.domainObjects[domain][aFlag] = true;</span>
<a href="#l3.371"></a><span id="l3.371" class="difflineplus">+      gDataman.debugMsg(&quot;added flag &quot; + aFlag + &quot; to &quot; + domain);</span>
<a href="#l3.372"></a><span id="l3.372" class="difflineplus">+      if (domain == this.selectedDomain.title) {</span>
<a href="#l3.373"></a><span id="l3.373" class="difflineplus">+        // Just update the tab states.</span>
<a href="#l3.374"></a><span id="l3.374" class="difflineplus">+        this.select(true);</span>
<a href="#l3.375"></a><span id="l3.375" class="difflineplus">+      }</span>
<a href="#l3.376"></a><span id="l3.376" class="difflineplus">+    }</span>
<a href="#l3.377"></a><span id="l3.377" class="difflineplus">+  },</span>
<a href="#l3.378"></a><span id="l3.378" class="difflineplus">+</span>
<a href="#l3.379"></a><span id="l3.379" class="difflineplus">+  removeDomainOrFlag: function domain_removeDomainOrFlag(aDomain, aFlag) {</span>
<a href="#l3.380"></a><span id="l3.380" class="difflineplus">+    // Remove a flag from the given domain,</span>
<a href="#l3.381"></a><span id="l3.381" class="difflineplus">+    // remove the whole domain if it doesn't have any flags left.</span>
<a href="#l3.382"></a><span id="l3.382" class="difflineplus">+    if (!this.domainObjects[aDomain])</span>
<a href="#l3.383"></a><span id="l3.383" class="difflineplus">+      return;</span>
<a href="#l3.384"></a><span id="l3.384" class="difflineplus">+</span>
<a href="#l3.385"></a><span id="l3.385" class="difflineplus">+    gDataman.debugMsg(&quot;removed flag &quot; + aFlag + &quot; from &quot; + aDomain);</span>
<a href="#l3.386"></a><span id="l3.386" class="difflineplus">+    this.domainObjects[aDomain][aFlag] = false;</span>
<a href="#l3.387"></a><span id="l3.387" class="difflineplus">+    if (!this.domainObjects[aDomain].hasCookies &amp;&amp;</span>
<a href="#l3.388"></a><span id="l3.388" class="difflineplus">+        !this.domainObjects[aDomain].hasPermissions &amp;&amp;</span>
<a href="#l3.389"></a><span id="l3.389" class="difflineplus">+        !this.domainObjects[aDomain].hasPreferences &amp;&amp;</span>
<a href="#l3.390"></a><span id="l3.390" class="difflineplus">+        !this.domainObjects[aDomain].hasPasswords &amp;&amp;</span>
<a href="#l3.391"></a><span id="l3.391" class="difflineplus">+        !this.domainObjects[aDomain].hasFormData) {</span>
<a href="#l3.392"></a><span id="l3.392" class="difflineplus">+      gDataman.debugMsg(&quot;removed domain: &quot; + aDomain);</span>
<a href="#l3.393"></a><span id="l3.393" class="difflineplus">+      // Get index in display tree.</span>
<a href="#l3.394"></a><span id="l3.394" class="difflineplus">+      let disp_idx = -1;</span>
<a href="#l3.395"></a><span id="l3.395" class="difflineplus">+      for (let i = 0; i &lt; this.displayedDomains.length; i++) {</span>
<a href="#l3.396"></a><span id="l3.396" class="difflineplus">+        if (this.displayedDomains[i] == this.domainObjects[aDomain]) {</span>
<a href="#l3.397"></a><span id="l3.397" class="difflineplus">+          disp_idx = i;</span>
<a href="#l3.398"></a><span id="l3.398" class="difflineplus">+          break;</span>
<a href="#l3.399"></a><span id="l3.399" class="difflineplus">+        }</span>
<a href="#l3.400"></a><span id="l3.400" class="difflineplus">+      }</span>
<a href="#l3.401"></a><span id="l3.401" class="difflineplus">+      this.displayedDomains.splice(disp_idx, 1);</span>
<a href="#l3.402"></a><span id="l3.402" class="difflineplus">+      this.tree.treeBoxObject.rowCountChanged(disp_idx, -1);</span>
<a href="#l3.403"></a><span id="l3.403" class="difflineplus">+      delete this.domainObjects[aDomain];</span>
<a href="#l3.404"></a><span id="l3.404" class="difflineplus">+      // Make sure we clear the data pane when selection has been removed.</span>
<a href="#l3.405"></a><span id="l3.405" class="difflineplus">+      if (!this.tree.view.selection.count)</span>
<a href="#l3.406"></a><span id="l3.406" class="difflineplus">+        this.select();</span>
<a href="#l3.407"></a><span id="l3.407" class="difflineplus">+    }</span>
<a href="#l3.408"></a><span id="l3.408" class="difflineplus">+    else {</span>
<a href="#l3.409"></a><span id="l3.409" class="difflineplus">+      // Just update the tab states.</span>
<a href="#l3.410"></a><span id="l3.410" class="difflineplus">+      this.select(true);</span>
<a href="#l3.411"></a><span id="l3.411" class="difflineplus">+    }</span>
<a href="#l3.412"></a><span id="l3.412" class="difflineplus">+  },</span>
<a href="#l3.413"></a><span id="l3.413" class="difflineplus">+</span>
<a href="#l3.414"></a><span id="l3.414" class="difflineplus">+  resetFlagToDomains: function domain_resetFlagToDomains(aFlag, aDomainList) {</span>
<a href="#l3.415"></a><span id="l3.415" class="difflineplus">+    // Reset a flag to be only set on a specific set of domains,</span>
<a href="#l3.416"></a><span id="l3.416" class="difflineplus">+    // purging then-emtpy domain in the process.</span>
<a href="#l3.417"></a><span id="l3.417" class="difflineplus">+    // Needed when we need to reload a complete set of items.</span>
<a href="#l3.418"></a><span id="l3.418" class="difflineplus">+    gDataman.debugMsg(&quot;resetting domains for flag: &quot; + aFlag);</span>
<a href="#l3.419"></a><span id="l3.419" class="difflineplus">+    this.ignoreSelect = true;</span>
<a href="#l3.420"></a><span id="l3.420" class="difflineplus">+    var selectionCache = gDataman.getSelectedIDs(this.tree, this._getObjID);</span>
<a href="#l3.421"></a><span id="l3.421" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.422"></a><span id="l3.422" class="difflineplus">+    // First, clear all domains of this flag.</span>
<a href="#l3.423"></a><span id="l3.423" class="difflineplus">+    for (let domain in this.domainObjects) {</span>
<a href="#l3.424"></a><span id="l3.424" class="difflineplus">+      this.domainObjects[domain][aFlag] = false;</span>
<a href="#l3.425"></a><span id="l3.425" class="difflineplus">+    }</span>
<a href="#l3.426"></a><span id="l3.426" class="difflineplus">+    // Then, set it again on all domains in the new list.</span>
<a href="#l3.427"></a><span id="l3.427" class="difflineplus">+    for (let i = 0; i &lt; aDomainList.length; i++) {</span>
<a href="#l3.428"></a><span id="l3.428" class="difflineplus">+      this.addDomainOrFlag(aDomainList[i], aFlag);</span>
<a href="#l3.429"></a><span id="l3.429" class="difflineplus">+    }</span>
<a href="#l3.430"></a><span id="l3.430" class="difflineplus">+    // Now, purge all empty domains.</span>
<a href="#l3.431"></a><span id="l3.431" class="difflineplus">+    for (let domain in this.domainObjects) {</span>
<a href="#l3.432"></a><span id="l3.432" class="difflineplus">+      if (!this.domainObjects[domain].hasCookies &amp;&amp;</span>
<a href="#l3.433"></a><span id="l3.433" class="difflineplus">+          !this.domainObjects[domain].hasPermissions &amp;&amp;</span>
<a href="#l3.434"></a><span id="l3.434" class="difflineplus">+          !this.domainObjects[domain].hasPreferences &amp;&amp;</span>
<a href="#l3.435"></a><span id="l3.435" class="difflineplus">+          !this.domainObjects[domain].hasPasswords &amp;&amp;</span>
<a href="#l3.436"></a><span id="l3.436" class="difflineplus">+          !this.domainObjects[domain].hasFormData) {</span>
<a href="#l3.437"></a><span id="l3.437" class="difflineplus">+        delete this.domainObjects[domain];</span>
<a href="#l3.438"></a><span id="l3.438" class="difflineplus">+      }</span>
<a href="#l3.439"></a><span id="l3.439" class="difflineplus">+    }</span>
<a href="#l3.440"></a><span id="l3.440" class="difflineplus">+    this.search(this.searchfield.value);</span>
<a href="#l3.441"></a><span id="l3.441" class="difflineplus">+    this.ignoreSelect = false;</span>
<a href="#l3.442"></a><span id="l3.442" class="difflineplus">+    gDataman.restoreSelectionFromIDs(this.tree, this._getObjID, selectionCache);</span>
<a href="#l3.443"></a><span id="l3.443" class="difflineplus">+    // Make sure we clear the data pane when selection has been removed.</span>
<a href="#l3.444"></a><span id="l3.444" class="difflineplus">+    if (!this.tree.view.selection.count &amp;&amp; selectionCache.length)</span>
<a href="#l3.445"></a><span id="l3.445" class="difflineplus">+      this.select();</span>
<a href="#l3.446"></a><span id="l3.446" class="difflineplus">+  },</span>
<a href="#l3.447"></a><span id="l3.447" class="difflineplus">+</span>
<a href="#l3.448"></a><span id="l3.448" class="difflineplus">+  select: function domain_select(aNoTabSelect) {</span>
<a href="#l3.449"></a><span id="l3.449" class="difflineplus">+    if (this.ignoreSelect) {</span>
<a href="#l3.450"></a><span id="l3.450" class="difflineplus">+      if (this.tree.view.selection.count == 1)</span>
<a href="#l3.451"></a><span id="l3.451" class="difflineplus">+        this.selectedDomain = this.displayedDomains[this.tree.currentIndex];</span>
<a href="#l3.452"></a><span id="l3.452" class="difflineplus">+      return;</span>
<a href="#l3.453"></a><span id="l3.453" class="difflineplus">+    }</span>
<a href="#l3.454"></a><span id="l3.454" class="difflineplus">+</span>
<a href="#l3.455"></a><span id="l3.455" class="difflineplus">+    gDataman.debugMsg(&quot;Domain selected: &quot; + Date.now()/1000);</span>
<a href="#l3.456"></a><span id="l3.456" class="difflineplus">+</span>
<a href="#l3.457"></a><span id="l3.457" class="difflineplus">+    if (!this.tree.view.selection.count) {</span>
<a href="#l3.458"></a><span id="l3.458" class="difflineplus">+      gTabs.cookiesTab.disabled = true;</span>
<a href="#l3.459"></a><span id="l3.459" class="difflineplus">+      gTabs.permissionsTab.disabled = true;</span>
<a href="#l3.460"></a><span id="l3.460" class="difflineplus">+      gTabs.preferencesTab.disabled = true;</span>
<a href="#l3.461"></a><span id="l3.461" class="difflineplus">+      gTabs.passwordsTab.disabled = true;</span>
<a href="#l3.462"></a><span id="l3.462" class="difflineplus">+      gTabs.formdataTab.hidden = true;</span>
<a href="#l3.463"></a><span id="l3.463" class="difflineplus">+      gTabs.formdataTab.disabled = true;</span>
<a href="#l3.464"></a><span id="l3.464" class="difflineplus">+      gTabs.forgetTab.hidden = true;</span>
<a href="#l3.465"></a><span id="l3.465" class="difflineplus">+      gTabs.forgetTab.disabled = true;</span>
<a href="#l3.466"></a><span id="l3.466" class="difflineplus">+      gTabs.shutdown();</span>
<a href="#l3.467"></a><span id="l3.467" class="difflineplus">+      this.selectedDomain = {title: null};</span>
<a href="#l3.468"></a><span id="l3.468" class="difflineplus">+      gDataman.debugMsg(&quot;Domain select aborted (no selection)&quot;);</span>
<a href="#l3.469"></a><span id="l3.469" class="difflineplus">+      return;</span>
<a href="#l3.470"></a><span id="l3.470" class="difflineplus">+    }</span>
<a href="#l3.471"></a><span id="l3.471" class="difflineplus">+</span>
<a href="#l3.472"></a><span id="l3.472" class="difflineplus">+    if (this.tree.view.selection.count &gt; 1) {</span>
<a href="#l3.473"></a><span id="l3.473" class="difflineplus">+      gDataman.debugError(&quot;Data Manager doesn't support anything but one selected domain&quot;);</span>
<a href="#l3.474"></a><span id="l3.474" class="difflineplus">+      this.tree.view.selection.clearSelection();</span>
<a href="#l3.475"></a><span id="l3.475" class="difflineplus">+      this.selectedDomain = {title: null};</span>
<a href="#l3.476"></a><span id="l3.476" class="difflineplus">+      return;</span>
<a href="#l3.477"></a><span id="l3.477" class="difflineplus">+    }</span>
<a href="#l3.478"></a><span id="l3.478" class="difflineplus">+    this.selectedDomain = this.displayedDomains[this.tree.currentIndex];</span>
<a href="#l3.479"></a><span id="l3.479" class="difflineplus">+    // Disable/enable and hide/show the tabs as needed.</span>
<a href="#l3.480"></a><span id="l3.480" class="difflineplus">+    gTabs.cookiesTab.disabled = !this.selectedDomain.hasCookies;</span>
<a href="#l3.481"></a><span id="l3.481" class="difflineplus">+    gTabs.permissionsTab.disabled = !this.selectedDomain.hasPermissions;</span>
<a href="#l3.482"></a><span id="l3.482" class="difflineplus">+    gTabs.preferencesTab.disabled = !this.selectedDomain.hasPreferences;</span>
<a href="#l3.483"></a><span id="l3.483" class="difflineplus">+    gTabs.passwordsTab.disabled = !this.selectedDomain.hasPasswords;</span>
<a href="#l3.484"></a><span id="l3.484" class="difflineplus">+    gTabs.formdataTab.hidden = !this.selectedDomain.hasFormData;</span>
<a href="#l3.485"></a><span id="l3.485" class="difflineplus">+    gTabs.formdataTab.disabled = !this.selectedDomain.hasFormData;</span>
<a href="#l3.486"></a><span id="l3.486" class="difflineplus">+    gTabs.forgetTab.disabled = true;</span>
<a href="#l3.487"></a><span id="l3.487" class="difflineplus">+    gTabs.forgetTab.hidden = true;</span>
<a href="#l3.488"></a><span id="l3.488" class="difflineplus">+    // Switch to the first non-disabled tab if the one that's showing is</span>
<a href="#l3.489"></a><span id="l3.489" class="difflineplus">+    // disabled, otherwise, you can't use the keyboard to switch tabs.</span>
<a href="#l3.490"></a><span id="l3.490" class="difflineplus">+    if (gTabs.tabbox.selectedTab.disabled) {</span>
<a href="#l3.491"></a><span id="l3.491" class="difflineplus">+      for (let i = 0; i &lt; gTabs.tabbox.tabs.childNodes.length; ++i) {</span>
<a href="#l3.492"></a><span id="l3.492" class="difflineplus">+        if (!gTabs.tabbox.tabs.childNodes[i].disabled) {</span>
<a href="#l3.493"></a><span id="l3.493" class="difflineplus">+          gTabs.tabbox.selectedIndex = i;</span>
<a href="#l3.494"></a><span id="l3.494" class="difflineplus">+          break;</span>
<a href="#l3.495"></a><span id="l3.495" class="difflineplus">+        }</span>
<a href="#l3.496"></a><span id="l3.496" class="difflineplus">+      }</span>
<a href="#l3.497"></a><span id="l3.497" class="difflineplus">+    }</span>
<a href="#l3.498"></a><span id="l3.498" class="difflineplus">+    if (!aNoTabSelect)</span>
<a href="#l3.499"></a><span id="l3.499" class="difflineplus">+      gTabs.select();</span>
<a href="#l3.500"></a><span id="l3.500" class="difflineplus">+</span>
<a href="#l3.501"></a><span id="l3.501" class="difflineplus">+    // Ensure the focus stays on our tree.</span>
<a href="#l3.502"></a><span id="l3.502" class="difflineplus">+    this.tree.focus();</span>
<a href="#l3.503"></a><span id="l3.503" class="difflineplus">+</span>
<a href="#l3.504"></a><span id="l3.504" class="difflineplus">+    gDataman.debugMsg(&quot;Domain select finished: &quot; + Date.now()/1000);</span>
<a href="#l3.505"></a><span id="l3.505" class="difflineplus">+  },</span>
<a href="#l3.506"></a><span id="l3.506" class="difflineplus">+</span>
<a href="#l3.507"></a><span id="l3.507" class="difflineplus">+  handleKeyPress: function domain_handleKeyPress(aEvent) {</span>
<a href="#l3.508"></a><span id="l3.508" class="difflineplus">+    if (aEvent.keyCode == KeyEvent.DOM_VK_DELETE) {</span>
<a href="#l3.509"></a><span id="l3.509" class="difflineplus">+      this.forget();</span>
<a href="#l3.510"></a><span id="l3.510" class="difflineplus">+    }</span>
<a href="#l3.511"></a><span id="l3.511" class="difflineplus">+  },</span>
<a href="#l3.512"></a><span id="l3.512" class="difflineplus">+</span>
<a href="#l3.513"></a><span id="l3.513" class="difflineplus">+  sort: function domain_sort() {</span>
<a href="#l3.514"></a><span id="l3.514" class="difflineplus">+    // compare function for two domain items</span>
<a href="#l3.515"></a><span id="l3.515" class="difflineplus">+    let compfunc = function domain_sort_compare(aOne, aTwo) {</span>
<a href="#l3.516"></a><span id="l3.516" class="difflineplus">+      return aOne.title.localeCompare(aTwo.title);</span>
<a href="#l3.517"></a><span id="l3.517" class="difflineplus">+    };</span>
<a href="#l3.518"></a><span id="l3.518" class="difflineplus">+</span>
<a href="#l3.519"></a><span id="l3.519" class="difflineplus">+    // Do the actual sorting of the array.</span>
<a href="#l3.520"></a><span id="l3.520" class="difflineplus">+    this.displayedDomains.sort(compfunc);</span>
<a href="#l3.521"></a><span id="l3.521" class="difflineplus">+    this.tree.treeBoxObject.invalidate();</span>
<a href="#l3.522"></a><span id="l3.522" class="difflineplus">+  },</span>
<a href="#l3.523"></a><span id="l3.523" class="difflineplus">+</span>
<a href="#l3.524"></a><span id="l3.524" class="difflineplus">+  forget: function domain_forget() {</span>
<a href="#l3.525"></a><span id="l3.525" class="difflineplus">+    gTabs.forgetTab.hidden = false;</span>
<a href="#l3.526"></a><span id="l3.526" class="difflineplus">+    gTabs.forgetTab.disabled = false;</span>
<a href="#l3.527"></a><span id="l3.527" class="difflineplus">+    gTabs.tabbox.selectedTab = gTabs.forgetTab;</span>
<a href="#l3.528"></a><span id="l3.528" class="difflineplus">+  },</span>
<a href="#l3.529"></a><span id="l3.529" class="difflineplus">+</span>
<a href="#l3.530"></a><span id="l3.530" class="difflineplus">+  search: function domain_search(aSearchString) {</span>
<a href="#l3.531"></a><span id="l3.531" class="difflineplus">+    this.ignoreSelect = true;</span>
<a href="#l3.532"></a><span id="l3.532" class="difflineplus">+    this.tree.treeBoxObject.beginUpdateBatch();</span>
<a href="#l3.533"></a><span id="l3.533" class="difflineplus">+    var selectionCache = gDataman.getSelectedIDs(this.tree, this._getObjID);</span>
<a href="#l3.534"></a><span id="l3.534" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.535"></a><span id="l3.535" class="difflineplus">+    this.displayedDomains = [];</span>
<a href="#l3.536"></a><span id="l3.536" class="difflineplus">+    var lcSearch = aSearchString.toLocaleLowerCase();</span>
<a href="#l3.537"></a><span id="l3.537" class="difflineplus">+    for (let domain in this.domainObjects) {</span>
<a href="#l3.538"></a><span id="l3.538" class="difflineplus">+      if (domain.toLocaleLowerCase().indexOf(lcSearch) != -1)</span>
<a href="#l3.539"></a><span id="l3.539" class="difflineplus">+        this.displayedDomains.push(this.domainObjects[domain]);</span>
<a href="#l3.540"></a><span id="l3.540" class="difflineplus">+    }</span>
<a href="#l3.541"></a><span id="l3.541" class="difflineplus">+    this.sort();</span>
<a href="#l3.542"></a><span id="l3.542" class="difflineplus">+    gDataman.restoreSelectionFromIDs(this.tree, this._getObjID, selectionCache);</span>
<a href="#l3.543"></a><span id="l3.543" class="difflineplus">+    this.tree.treeBoxObject.endUpdateBatch();</span>
<a href="#l3.544"></a><span id="l3.544" class="difflineplus">+    this.ignoreSelect = false;</span>
<a href="#l3.545"></a><span id="l3.545" class="difflineplus">+    // Make sure we clear the data pane when selection has been removed.</span>
<a href="#l3.546"></a><span id="l3.546" class="difflineplus">+    if (!this.tree.view.selection.count &amp;&amp; selectionCache.length)</span>
<a href="#l3.547"></a><span id="l3.547" class="difflineplus">+      this.select();</span>
<a href="#l3.548"></a><span id="l3.548" class="difflineplus">+  },</span>
<a href="#l3.549"></a><span id="l3.549" class="difflineplus">+</span>
<a href="#l3.550"></a><span id="l3.550" class="difflineplus">+  focusSearch: function domain_focusSearch() {</span>
<a href="#l3.551"></a><span id="l3.551" class="difflineplus">+    this.searchfield.focus();</span>
<a href="#l3.552"></a><span id="l3.552" class="difflineplus">+  },</span>
<a href="#l3.553"></a><span id="l3.553" class="difflineplus">+</span>
<a href="#l3.554"></a><span id="l3.554" class="difflineplus">+  updateContext: function domain_updateContext() {</span>
<a href="#l3.555"></a><span id="l3.555" class="difflineplus">+    let forgetCtx = document.getElementById(&quot;domain-context-forget&quot;);</span>
<a href="#l3.556"></a><span id="l3.556" class="difflineplus">+    forgetCtx.disabled = !this.selectedDomain.title;</span>
<a href="#l3.557"></a><span id="l3.557" class="difflineplus">+    forgetCtx.label = this.selectedDomain.title == &quot;*&quot; ?</span>
<a href="#l3.558"></a><span id="l3.558" class="difflineplus">+                      forgetCtx.getAttribute(&quot;label_global&quot;) :</span>
<a href="#l3.559"></a><span id="l3.559" class="difflineplus">+                      forgetCtx.getAttribute(&quot;label_domain&quot;);</span>
<a href="#l3.560"></a><span id="l3.560" class="difflineplus">+    forgetCtx.accesskey = this.selectedDomain.title == &quot;*&quot; ?</span>
<a href="#l3.561"></a><span id="l3.561" class="difflineplus">+                          forgetCtx.getAttribute(&quot;accesskey_global&quot;) :</span>
<a href="#l3.562"></a><span id="l3.562" class="difflineplus">+                          forgetCtx.getAttribute(&quot;accesskey_domain&quot;);</span>
<a href="#l3.563"></a><span id="l3.563" class="difflineplus">+  },</span>
<a href="#l3.564"></a><span id="l3.564" class="difflineplus">+</span>
<a href="#l3.565"></a><span id="l3.565" class="difflineplus">+  // nsITreeView</span>
<a href="#l3.566"></a><span id="l3.566" class="difflineplus">+  __proto__: gBaseTreeView,</span>
<a href="#l3.567"></a><span id="l3.567" class="difflineplus">+  get rowCount() {</span>
<a href="#l3.568"></a><span id="l3.568" class="difflineplus">+    return this.displayedDomains.length;</span>
<a href="#l3.569"></a><span id="l3.569" class="difflineplus">+  },</span>
<a href="#l3.570"></a><span id="l3.570" class="difflineplus">+  getCellText: function(aRow, aColumn) {</span>
<a href="#l3.571"></a><span id="l3.571" class="difflineplus">+    switch (aColumn.id) {</span>
<a href="#l3.572"></a><span id="l3.572" class="difflineplus">+      case &quot;domainCol&quot;:</span>
<a href="#l3.573"></a><span id="l3.573" class="difflineplus">+        return this.displayedDomains[aRow].title;</span>
<a href="#l3.574"></a><span id="l3.574" class="difflineplus">+    }</span>
<a href="#l3.575"></a><span id="l3.575" class="difflineplus">+  },</span>
<a href="#l3.576"></a><span id="l3.576" class="difflineplus">+};</span>
<a href="#l3.577"></a><span id="l3.577" class="difflineplus">+</span>
<a href="#l3.578"></a><span id="l3.578" class="difflineplus">+// :::::::::::::::::::: tab management ::::::::::::::::::::</span>
<a href="#l3.579"></a><span id="l3.579" class="difflineplus">+var gTabs = {</span>
<a href="#l3.580"></a><span id="l3.580" class="difflineplus">+  tabbox: null,</span>
<a href="#l3.581"></a><span id="l3.581" class="difflineplus">+  tabs: null,</span>
<a href="#l3.582"></a><span id="l3.582" class="difflineplus">+  cookiesTab: null,</span>
<a href="#l3.583"></a><span id="l3.583" class="difflineplus">+  permissionsTab: null,</span>
<a href="#l3.584"></a><span id="l3.584" class="difflineplus">+  preferencesTab: null,</span>
<a href="#l3.585"></a><span id="l3.585" class="difflineplus">+  passwordsTab: null,</span>
<a href="#l3.586"></a><span id="l3.586" class="difflineplus">+  formdataTab: null,</span>
<a href="#l3.587"></a><span id="l3.587" class="difflineplus">+  forgetTab: null,</span>
<a href="#l3.588"></a><span id="l3.588" class="difflineplus">+</span>
<a href="#l3.589"></a><span id="l3.589" class="difflineplus">+  panels: {},</span>
<a href="#l3.590"></a><span id="l3.590" class="difflineplus">+  activePanel: null,</span>
<a href="#l3.591"></a><span id="l3.591" class="difflineplus">+</span>
<a href="#l3.592"></a><span id="l3.592" class="difflineplus">+  initialize: function tabs_initialize() {</span>
<a href="#l3.593"></a><span id="l3.593" class="difflineplus">+    gDataman.debugMsg(&quot;Initializing tabs&quot;);</span>
<a href="#l3.594"></a><span id="l3.594" class="difflineplus">+    this.tabbox = document.getElementById(&quot;tabbox&quot;);</span>
<a href="#l3.595"></a><span id="l3.595" class="difflineplus">+    this.cookiesTab = document.getElementById(&quot;cookiesTab&quot;);</span>
<a href="#l3.596"></a><span id="l3.596" class="difflineplus">+    this.permissionsTab = document.getElementById(&quot;permissionsTab&quot;);</span>
<a href="#l3.597"></a><span id="l3.597" class="difflineplus">+    this.preferencesTab = document.getElementById(&quot;preferencesTab&quot;);</span>
<a href="#l3.598"></a><span id="l3.598" class="difflineplus">+    this.passwordsTab = document.getElementById(&quot;passwordsTab&quot;);</span>
<a href="#l3.599"></a><span id="l3.599" class="difflineplus">+    this.formdataTab = document.getElementById(&quot;formdataTab&quot;);</span>
<a href="#l3.600"></a><span id="l3.600" class="difflineplus">+    this.forgetTab = document.getElementById(&quot;forgetTab&quot;);</span>
<a href="#l3.601"></a><span id="l3.601" class="difflineplus">+</span>
<a href="#l3.602"></a><span id="l3.602" class="difflineplus">+    this.panels = {</span>
<a href="#l3.603"></a><span id="l3.603" class="difflineplus">+      cookiesPanel: gCookies,</span>
<a href="#l3.604"></a><span id="l3.604" class="difflineplus">+      permissionsPanel: gPerms,</span>
<a href="#l3.605"></a><span id="l3.605" class="difflineplus">+      preferencesPanel: gPrefs,</span>
<a href="#l3.606"></a><span id="l3.606" class="difflineplus">+      passwordsPanel: gPasswords,</span>
<a href="#l3.607"></a><span id="l3.607" class="difflineplus">+      formdataPanel: gFormdata,</span>
<a href="#l3.608"></a><span id="l3.608" class="difflineplus">+      forgetPanel: gForget</span>
<a href="#l3.609"></a><span id="l3.609" class="difflineplus">+    };</span>
<a href="#l3.610"></a><span id="l3.610" class="difflineplus">+  },</span>
<a href="#l3.611"></a><span id="l3.611" class="difflineplus">+</span>
<a href="#l3.612"></a><span id="l3.612" class="difflineplus">+  shutdown: function tabs_shutdown() {</span>
<a href="#l3.613"></a><span id="l3.613" class="difflineplus">+    gDataman.debugMsg(&quot;Shutting down tabs&quot;);</span>
<a href="#l3.614"></a><span id="l3.614" class="difflineplus">+    if (this.activePanel) {</span>
<a href="#l3.615"></a><span id="l3.615" class="difflineplus">+      this.panels[this.activePanel].shutdown();</span>
<a href="#l3.616"></a><span id="l3.616" class="difflineplus">+      this.activePanel = null;</span>
<a href="#l3.617"></a><span id="l3.617" class="difflineplus">+    }</span>
<a href="#l3.618"></a><span id="l3.618" class="difflineplus">+  },</span>
<a href="#l3.619"></a><span id="l3.619" class="difflineplus">+</span>
<a href="#l3.620"></a><span id="l3.620" class="difflineplus">+  select: function tabs_select() {</span>
<a href="#l3.621"></a><span id="l3.621" class="difflineplus">+    gDataman.debugMsg(&quot;Selecting tab&quot;);</span>
<a href="#l3.622"></a><span id="l3.622" class="difflineplus">+    if (this.activePanel) {</span>
<a href="#l3.623"></a><span id="l3.623" class="difflineplus">+      this.panels[this.activePanel].shutdown();</span>
<a href="#l3.624"></a><span id="l3.624" class="difflineplus">+      this.activePanel = null;</span>
<a href="#l3.625"></a><span id="l3.625" class="difflineplus">+    }</span>
<a href="#l3.626"></a><span id="l3.626" class="difflineplus">+</span>
<a href="#l3.627"></a><span id="l3.627" class="difflineplus">+    if (!this.tabbox || this.tabbox.selectedPanel.disabled)</span>
<a href="#l3.628"></a><span id="l3.628" class="difflineplus">+      return;</span>
<a href="#l3.629"></a><span id="l3.629" class="difflineplus">+</span>
<a href="#l3.630"></a><span id="l3.630" class="difflineplus">+    this.activePanel = this.tabbox.selectedPanel.id;</span>
<a href="#l3.631"></a><span id="l3.631" class="difflineplus">+    this.panels[this.activePanel].initialize();</span>
<a href="#l3.632"></a><span id="l3.632" class="difflineplus">+  },</span>
<a href="#l3.633"></a><span id="l3.633" class="difflineplus">+</span>
<a href="#l3.634"></a><span id="l3.634" class="difflineplus">+  selectAll: function tabs_selectAll() {</span>
<a href="#l3.635"></a><span id="l3.635" class="difflineplus">+    try {</span>
<a href="#l3.636"></a><span id="l3.636" class="difflineplus">+      this.panels[this.activePanel].selectAll();</span>
<a href="#l3.637"></a><span id="l3.637" class="difflineplus">+    }</span>
<a href="#l3.638"></a><span id="l3.638" class="difflineplus">+    catch (e) {</span>
<a href="#l3.639"></a><span id="l3.639" class="difflineplus">+       gDataman.debugError(&quot;SelectAll didn't work for &quot; + this.activePanel + &quot;: &quot; + e);</span>
<a href="#l3.640"></a><span id="l3.640" class="difflineplus">+    }</span>
<a href="#l3.641"></a><span id="l3.641" class="difflineplus">+  },</span>
<a href="#l3.642"></a><span id="l3.642" class="difflineplus">+</span>
<a href="#l3.643"></a><span id="l3.643" class="difflineplus">+  focusSearch: function tabs_focusSearch() {</span>
<a href="#l3.644"></a><span id="l3.644" class="difflineplus">+    try {</span>
<a href="#l3.645"></a><span id="l3.645" class="difflineplus">+      this.panels[this.activePanel].focusSearch();</span>
<a href="#l3.646"></a><span id="l3.646" class="difflineplus">+    }</span>
<a href="#l3.647"></a><span id="l3.647" class="difflineplus">+    catch (e) {</span>
<a href="#l3.648"></a><span id="l3.648" class="difflineplus">+      gDataman.debugError(&quot;focusSearch didn't work for &quot; + this.activePanel + &quot;: &quot; + e);</span>
<a href="#l3.649"></a><span id="l3.649" class="difflineplus">+    }</span>
<a href="#l3.650"></a><span id="l3.650" class="difflineplus">+  },</span>
<a href="#l3.651"></a><span id="l3.651" class="difflineplus">+};</span>
<a href="#l3.652"></a><span id="l3.652" class="difflineplus">+</span>
<a href="#l3.653"></a><span id="l3.653" class="difflineplus">+// :::::::::::::::::::: cookies panel ::::::::::::::::::::</span>
<a href="#l3.654"></a><span id="l3.654" class="difflineplus">+var gCookies = {</span>
<a href="#l3.655"></a><span id="l3.655" class="difflineplus">+  tree: null,</span>
<a href="#l3.656"></a><span id="l3.656" class="difflineplus">+  cookieInfoName: null,</span>
<a href="#l3.657"></a><span id="l3.657" class="difflineplus">+  cookieInfoValue: null,</span>
<a href="#l3.658"></a><span id="l3.658" class="difflineplus">+  cookieInfoHostLabel: null,</span>
<a href="#l3.659"></a><span id="l3.659" class="difflineplus">+  cookieInfoHost: null,</span>
<a href="#l3.660"></a><span id="l3.660" class="difflineplus">+  cookieInfoPath: null,</span>
<a href="#l3.661"></a><span id="l3.661" class="difflineplus">+  cookieInfoSendType: null,</span>
<a href="#l3.662"></a><span id="l3.662" class="difflineplus">+  cookieInfoExpires: null,</span>
<a href="#l3.663"></a><span id="l3.663" class="difflineplus">+  removeButton: null,</span>
<a href="#l3.664"></a><span id="l3.664" class="difflineplus">+  blockOnRemove: null,</span>
<a href="#l3.665"></a><span id="l3.665" class="difflineplus">+</span>
<a href="#l3.666"></a><span id="l3.666" class="difflineplus">+  cookies: [],</span>
<a href="#l3.667"></a><span id="l3.667" class="difflineplus">+  displayedCookies: [],</span>
<a href="#l3.668"></a><span id="l3.668" class="difflineplus">+</span>
<a href="#l3.669"></a><span id="l3.669" class="difflineplus">+  initialize: function cookies_initialize() {</span>
<a href="#l3.670"></a><span id="l3.670" class="difflineplus">+    gDataman.debugMsg(&quot;Initializing cookies panel&quot;);</span>
<a href="#l3.671"></a><span id="l3.671" class="difflineplus">+    this.tree = document.getElementById(&quot;cookiesTree&quot;);</span>
<a href="#l3.672"></a><span id="l3.672" class="difflineplus">+    this.tree.view = this;</span>
<a href="#l3.673"></a><span id="l3.673" class="difflineplus">+</span>
<a href="#l3.674"></a><span id="l3.674" class="difflineplus">+    this.cookieInfoName = document.getElementById(&quot;cookieInfoName&quot;);</span>
<a href="#l3.675"></a><span id="l3.675" class="difflineplus">+    this.cookieInfoValue = document.getElementById(&quot;cookieInfoValue&quot;);</span>
<a href="#l3.676"></a><span id="l3.676" class="difflineplus">+    this.cookieInfoHostLabel = document.getElementById(&quot;cookieInfoHostLabel&quot;);</span>
<a href="#l3.677"></a><span id="l3.677" class="difflineplus">+    this.cookieInfoHost = document.getElementById(&quot;cookieInfoHost&quot;);</span>
<a href="#l3.678"></a><span id="l3.678" class="difflineplus">+    this.cookieInfoPath = document.getElementById(&quot;cookieInfoPath&quot;);</span>
<a href="#l3.679"></a><span id="l3.679" class="difflineplus">+    this.cookieInfoSendType = document.getElementById(&quot;cookieInfoSendType&quot;);</span>
<a href="#l3.680"></a><span id="l3.680" class="difflineplus">+    this.cookieInfoExpires = document.getElementById(&quot;cookieInfoExpires&quot;);</span>
<a href="#l3.681"></a><span id="l3.681" class="difflineplus">+</span>
<a href="#l3.682"></a><span id="l3.682" class="difflineplus">+    this.removeButton = document.getElementById(&quot;cookieRemove&quot;);</span>
<a href="#l3.683"></a><span id="l3.683" class="difflineplus">+    this.blockOnRemove = document.getElementById(&quot;cookieBlockOnRemove&quot;);</span>
<a href="#l3.684"></a><span id="l3.684" class="difflineplus">+</span>
<a href="#l3.685"></a><span id="l3.685" class="difflineplus">+    // this.loadList() is being called in gDomains.initialize() already</span>
<a href="#l3.686"></a><span id="l3.686" class="difflineplus">+    this.tree.treeBoxObject.beginUpdateBatch();</span>
<a href="#l3.687"></a><span id="l3.687" class="difflineplus">+    this.displayedCookies = this.cookies.filter(</span>
<a href="#l3.688"></a><span id="l3.688" class="difflineplus">+      function (aCookie) {</span>
<a href="#l3.689"></a><span id="l3.689" class="difflineplus">+        return gDomains.hostMatchesSelected(aCookie.rawHost);</span>
<a href="#l3.690"></a><span id="l3.690" class="difflineplus">+      });</span>
<a href="#l3.691"></a><span id="l3.691" class="difflineplus">+    this.sort(null, false, false);</span>
<a href="#l3.692"></a><span id="l3.692" class="difflineplus">+    this.tree.treeBoxObject.endUpdateBatch();</span>
<a href="#l3.693"></a><span id="l3.693" class="difflineplus">+  },</span>
<a href="#l3.694"></a><span id="l3.694" class="difflineplus">+</span>
<a href="#l3.695"></a><span id="l3.695" class="difflineplus">+  shutdown: function cookies_shutdown() {</span>
<a href="#l3.696"></a><span id="l3.696" class="difflineplus">+    gDataman.debugMsg(&quot;Shutting down cookies panel&quot;);</span>
<a href="#l3.697"></a><span id="l3.697" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.698"></a><span id="l3.698" class="difflineplus">+    this.tree.view = null;</span>
<a href="#l3.699"></a><span id="l3.699" class="difflineplus">+    this.displayedCookies = [];</span>
<a href="#l3.700"></a><span id="l3.700" class="difflineplus">+  },</span>
<a href="#l3.701"></a><span id="l3.701" class="difflineplus">+</span>
<a href="#l3.702"></a><span id="l3.702" class="difflineplus">+  loadList: function cookies_loadList() {</span>
<a href="#l3.703"></a><span id="l3.703" class="difflineplus">+    this.cookies = [];</span>
<a href="#l3.704"></a><span id="l3.704" class="difflineplus">+    let enumerator = gLocSvc.cookie.enumerator;</span>
<a href="#l3.705"></a><span id="l3.705" class="difflineplus">+    while (enumerator.hasMoreElements()) {</span>
<a href="#l3.706"></a><span id="l3.706" class="difflineplus">+      let nextCookie = enumerator.getNext();</span>
<a href="#l3.707"></a><span id="l3.707" class="difflineplus">+      if (!nextCookie) break;</span>
<a href="#l3.708"></a><span id="l3.708" class="difflineplus">+      nextCookie = nextCookie.QueryInterface(Components.interfaces.nsICookie2);</span>
<a href="#l3.709"></a><span id="l3.709" class="difflineplus">+      this.cookies.push(this._makeCookieObject(nextCookie));</span>
<a href="#l3.710"></a><span id="l3.710" class="difflineplus">+    }</span>
<a href="#l3.711"></a><span id="l3.711" class="difflineplus">+  },</span>
<a href="#l3.712"></a><span id="l3.712" class="difflineplus">+</span>
<a href="#l3.713"></a><span id="l3.713" class="difflineplus">+  _makeCookieObject: function cookies__makeCookieObject(aCookie) {</span>
<a href="#l3.714"></a><span id="l3.714" class="difflineplus">+      return {name: aCookie.name,</span>
<a href="#l3.715"></a><span id="l3.715" class="difflineplus">+              value: aCookie.value,</span>
<a href="#l3.716"></a><span id="l3.716" class="difflineplus">+              isDomain: aCookie.isDomain,</span>
<a href="#l3.717"></a><span id="l3.717" class="difflineplus">+              host: aCookie.host,</span>
<a href="#l3.718"></a><span id="l3.718" class="difflineplus">+              rawHost: aCookie.rawHost,</span>
<a href="#l3.719"></a><span id="l3.719" class="difflineplus">+              path: aCookie.path,</span>
<a href="#l3.720"></a><span id="l3.720" class="difflineplus">+              isSecure: aCookie.isSecure,</span>
<a href="#l3.721"></a><span id="l3.721" class="difflineplus">+              isSession: aCookie.isSession,</span>
<a href="#l3.722"></a><span id="l3.722" class="difflineplus">+              isHttpOnly: aCookie.isHttpOnly,</span>
<a href="#l3.723"></a><span id="l3.723" class="difflineplus">+              expires: this._getExpiresString(aCookie.expires),</span>
<a href="#l3.724"></a><span id="l3.724" class="difflineplus">+              expiresSortValue: aCookie.expires};</span>
<a href="#l3.725"></a><span id="l3.725" class="difflineplus">+  },</span>
<a href="#l3.726"></a><span id="l3.726" class="difflineplus">+</span>
<a href="#l3.727"></a><span id="l3.727" class="difflineplus">+  _getObjID: function cookies__getObjID(aIdx) {</span>
<a href="#l3.728"></a><span id="l3.728" class="difflineplus">+    var curCookie = gCookies.displayedCookies[aIdx];</span>
<a href="#l3.729"></a><span id="l3.729" class="difflineplus">+    return curCookie.host + &quot;|&quot; + curCookie.path + &quot;|&quot; + curCookie.name;</span>
<a href="#l3.730"></a><span id="l3.730" class="difflineplus">+  },</span>
<a href="#l3.731"></a><span id="l3.731" class="difflineplus">+</span>
<a href="#l3.732"></a><span id="l3.732" class="difflineplus">+  _getExpiresString: function cookies__getExpiresString(aExpires) {</span>
<a href="#l3.733"></a><span id="l3.733" class="difflineplus">+    if (aExpires) {</span>
<a href="#l3.734"></a><span id="l3.734" class="difflineplus">+      let date = new Date(1000 * aExpires);</span>
<a href="#l3.735"></a><span id="l3.735" class="difflineplus">+</span>
<a href="#l3.736"></a><span id="l3.736" class="difflineplus">+      // If a server manages to set a really long-lived cookie, the dateservice</span>
<a href="#l3.737"></a><span id="l3.737" class="difflineplus">+      // can't cope with it properly, so we'll just return a blank string.</span>
<a href="#l3.738"></a><span id="l3.738" class="difflineplus">+      // See bug 238045 for details.</span>
<a href="#l3.739"></a><span id="l3.739" class="difflineplus">+      let expiry = &quot;&quot;;</span>
<a href="#l3.740"></a><span id="l3.740" class="difflineplus">+      try {</span>
<a href="#l3.741"></a><span id="l3.741" class="difflineplus">+        expiry = gLocSvc.date.FormatDateTime(&quot;&quot;, gLocSvc.date.dateFormatLong,</span>
<a href="#l3.742"></a><span id="l3.742" class="difflineplus">+                                             gLocSvc.date.timeFormatSeconds,</span>
<a href="#l3.743"></a><span id="l3.743" class="difflineplus">+                                             date.getFullYear(), date.getMonth()+1,</span>
<a href="#l3.744"></a><span id="l3.744" class="difflineplus">+                                             date.getDate(), date.getHours(),</span>
<a href="#l3.745"></a><span id="l3.745" class="difflineplus">+                                             date.getMinutes(), date.getSeconds());</span>
<a href="#l3.746"></a><span id="l3.746" class="difflineplus">+      }</span>
<a href="#l3.747"></a><span id="l3.747" class="difflineplus">+      catch (e) {}</span>
<a href="#l3.748"></a><span id="l3.748" class="difflineplus">+      return expiry;</span>
<a href="#l3.749"></a><span id="l3.749" class="difflineplus">+    }</span>
<a href="#l3.750"></a><span id="l3.750" class="difflineplus">+    return gDataman.bundle.getString(&quot;cookies.expireAtEndOfSession&quot;);</span>
<a href="#l3.751"></a><span id="l3.751" class="difflineplus">+  },</span>
<a href="#l3.752"></a><span id="l3.752" class="difflineplus">+</span>
<a href="#l3.753"></a><span id="l3.753" class="difflineplus">+  select: function cookies_select() {</span>
<a href="#l3.754"></a><span id="l3.754" class="difflineplus">+    var selections = gDataman.getTreeSelections(this.tree);</span>
<a href="#l3.755"></a><span id="l3.755" class="difflineplus">+    this.removeButton.disabled = !selections.length;</span>
<a href="#l3.756"></a><span id="l3.756" class="difflineplus">+    if (!selections.length) {</span>
<a href="#l3.757"></a><span id="l3.757" class="difflineplus">+      this._clearCookieInfo();</span>
<a href="#l3.758"></a><span id="l3.758" class="difflineplus">+      return true;</span>
<a href="#l3.759"></a><span id="l3.759" class="difflineplus">+    }</span>
<a href="#l3.760"></a><span id="l3.760" class="difflineplus">+</span>
<a href="#l3.761"></a><span id="l3.761" class="difflineplus">+    if (selections.length &gt; 1) {</span>
<a href="#l3.762"></a><span id="l3.762" class="difflineplus">+      this._clearCookieInfo();</span>
<a href="#l3.763"></a><span id="l3.763" class="difflineplus">+      return true;</span>
<a href="#l3.764"></a><span id="l3.764" class="difflineplus">+    }</span>
<a href="#l3.765"></a><span id="l3.765" class="difflineplus">+</span>
<a href="#l3.766"></a><span id="l3.766" class="difflineplus">+    // At this point, we have a single cookie selected.</span>
<a href="#l3.767"></a><span id="l3.767" class="difflineplus">+    var showCookie = this.displayedCookies[selections[0]];</span>
<a href="#l3.768"></a><span id="l3.768" class="difflineplus">+</span>
<a href="#l3.769"></a><span id="l3.769" class="difflineplus">+    this.cookieInfoName.value = showCookie.name;</span>
<a href="#l3.770"></a><span id="l3.770" class="difflineplus">+    this.cookieInfoValue.value = showCookie.value;</span>
<a href="#l3.771"></a><span id="l3.771" class="difflineplus">+    this.cookieInfoHostLabel.value = showCookie.isDomain ?</span>
<a href="#l3.772"></a><span id="l3.772" class="difflineplus">+                                     this.cookieInfoHostLabel.getAttribute(&quot;value_domain&quot;) :</span>
<a href="#l3.773"></a><span id="l3.773" class="difflineplus">+                                     this.cookieInfoHostLabel.getAttribute(&quot;value_host&quot;);</span>
<a href="#l3.774"></a><span id="l3.774" class="difflineplus">+    this.cookieInfoHost.value = showCookie.host;</span>
<a href="#l3.775"></a><span id="l3.775" class="difflineplus">+    this.cookieInfoPath.value = showCookie.path;</span>
<a href="#l3.776"></a><span id="l3.776" class="difflineplus">+    var typestringID = &quot;cookies.&quot; +</span>
<a href="#l3.777"></a><span id="l3.777" class="difflineplus">+                       (showCookie.isSecure ? &quot;secureOnly&quot; : &quot;anyConnection&quot;) +</span>
<a href="#l3.778"></a><span id="l3.778" class="difflineplus">+                       (showCookie.isHttpOnly ? &quot;.httponly&quot; : &quot;.all&quot;);</span>
<a href="#l3.779"></a><span id="l3.779" class="difflineplus">+    this.cookieInfoSendType.value = gDataman.bundle.getString(typestringID);</span>
<a href="#l3.780"></a><span id="l3.780" class="difflineplus">+    this.cookieInfoExpires.value = showCookie.expires;</span>
<a href="#l3.781"></a><span id="l3.781" class="difflineplus">+    return true;</span>
<a href="#l3.782"></a><span id="l3.782" class="difflineplus">+  },</span>
<a href="#l3.783"></a><span id="l3.783" class="difflineplus">+</span>
<a href="#l3.784"></a><span id="l3.784" class="difflineplus">+  selectAll: function cookies_selectAll() {</span>
<a href="#l3.785"></a><span id="l3.785" class="difflineplus">+    this.tree.view.selection.selectAll();</span>
<a href="#l3.786"></a><span id="l3.786" class="difflineplus">+  },</span>
<a href="#l3.787"></a><span id="l3.787" class="difflineplus">+</span>
<a href="#l3.788"></a><span id="l3.788" class="difflineplus">+  _clearCookieInfo: function cookies__clearCookieInfo() {</span>
<a href="#l3.789"></a><span id="l3.789" class="difflineplus">+    var fields = [&quot;cookieInfoName&quot;, &quot;cookieInfoValue&quot;, &quot;cookieInfoHost&quot;,</span>
<a href="#l3.790"></a><span id="l3.790" class="difflineplus">+                  &quot;cookieInfoPath&quot;, &quot;cookieInfoSendType&quot;, &quot;cookieInfoExpires&quot;];</span>
<a href="#l3.791"></a><span id="l3.791" class="difflineplus">+    for (let i = 0; i &lt; fields.length; i++) {</span>
<a href="#l3.792"></a><span id="l3.792" class="difflineplus">+      this[fields[i]].value = &quot;&quot;;</span>
<a href="#l3.793"></a><span id="l3.793" class="difflineplus">+    }</span>
<a href="#l3.794"></a><span id="l3.794" class="difflineplus">+    this.cookieInfoHostLabel.value = this.cookieInfoHostLabel.getAttribute(&quot;value_host&quot;);</span>
<a href="#l3.795"></a><span id="l3.795" class="difflineplus">+  },</span>
<a href="#l3.796"></a><span id="l3.796" class="difflineplus">+</span>
<a href="#l3.797"></a><span id="l3.797" class="difflineplus">+  handleKeyPress: function cookies_handleKeyPress(aEvent) {</span>
<a href="#l3.798"></a><span id="l3.798" class="difflineplus">+    if (aEvent.keyCode == KeyEvent.DOM_VK_DELETE) {</span>
<a href="#l3.799"></a><span id="l3.799" class="difflineplus">+      this.delete();</span>
<a href="#l3.800"></a><span id="l3.800" class="difflineplus">+    }</span>
<a href="#l3.801"></a><span id="l3.801" class="difflineplus">+  },</span>
<a href="#l3.802"></a><span id="l3.802" class="difflineplus">+</span>
<a href="#l3.803"></a><span id="l3.803" class="difflineplus">+  sort: function cookies_sort(aColumn, aUpdateSelection, aInvertDirection) {</span>
<a href="#l3.804"></a><span id="l3.804" class="difflineplus">+    // Make sure we have a valid column.</span>
<a href="#l3.805"></a><span id="l3.805" class="difflineplus">+    let column = aColumn;</span>
<a href="#l3.806"></a><span id="l3.806" class="difflineplus">+    if (!column) {</span>
<a href="#l3.807"></a><span id="l3.807" class="difflineplus">+      let sortedCol = this.tree.columns.getSortedColumn();</span>
<a href="#l3.808"></a><span id="l3.808" class="difflineplus">+      if (sortedCol)</span>
<a href="#l3.809"></a><span id="l3.809" class="difflineplus">+        column = sortedCol.element;</span>
<a href="#l3.810"></a><span id="l3.810" class="difflineplus">+      else</span>
<a href="#l3.811"></a><span id="l3.811" class="difflineplus">+        column = document.getElementById(&quot;cookieHostCol&quot;);</span>
<a href="#l3.812"></a><span id="l3.812" class="difflineplus">+    }</span>
<a href="#l3.813"></a><span id="l3.813" class="difflineplus">+    else if (column.localName == &quot;treecols&quot; || column.localName == &quot;splitter&quot;)</span>
<a href="#l3.814"></a><span id="l3.814" class="difflineplus">+      return;</span>
<a href="#l3.815"></a><span id="l3.815" class="difflineplus">+</span>
<a href="#l3.816"></a><span id="l3.816" class="difflineplus">+    if (!column || column.localName != &quot;treecol&quot;) {</span>
<a href="#l3.817"></a><span id="l3.817" class="difflineplus">+      Components.utils.reportError(&quot;No column found to sort cookies by&quot;);</span>
<a href="#l3.818"></a><span id="l3.818" class="difflineplus">+      return;</span>
<a href="#l3.819"></a><span id="l3.819" class="difflineplus">+    }</span>
<a href="#l3.820"></a><span id="l3.820" class="difflineplus">+</span>
<a href="#l3.821"></a><span id="l3.821" class="difflineplus">+    let dirAscending = column.getAttribute(&quot;sortDirection&quot;) !=</span>
<a href="#l3.822"></a><span id="l3.822" class="difflineplus">+                       (aInvertDirection ? &quot;ascending&quot; : &quot;descending&quot;);</span>
<a href="#l3.823"></a><span id="l3.823" class="difflineplus">+    let dirFactor = dirAscending ? 1 : -1;</span>
<a href="#l3.824"></a><span id="l3.824" class="difflineplus">+</span>
<a href="#l3.825"></a><span id="l3.825" class="difflineplus">+    // Clear attributes on all columns, we're setting them again after sorting.</span>
<a href="#l3.826"></a><span id="l3.826" class="difflineplus">+    for (let node = column.parentNode.firstChild; node; node = node.nextSibling) {</span>
<a href="#l3.827"></a><span id="l3.827" class="difflineplus">+      node.removeAttribute(&quot;sortActive&quot;);</span>
<a href="#l3.828"></a><span id="l3.828" class="difflineplus">+      node.removeAttribute(&quot;sortDirection&quot;);</span>
<a href="#l3.829"></a><span id="l3.829" class="difflineplus">+    }</span>
<a href="#l3.830"></a><span id="l3.830" class="difflineplus">+</span>
<a href="#l3.831"></a><span id="l3.831" class="difflineplus">+    // compare function for two formdata items</span>
<a href="#l3.832"></a><span id="l3.832" class="difflineplus">+    let compfunc = function formdata_sort_compare(aOne, aTwo) {</span>
<a href="#l3.833"></a><span id="l3.833" class="difflineplus">+      switch (column.id) {</span>
<a href="#l3.834"></a><span id="l3.834" class="difflineplus">+        case &quot;cookieHostCol&quot;:</span>
<a href="#l3.835"></a><span id="l3.835" class="difflineplus">+          return dirFactor * aOne.rawHost.localeCompare(aTwo.rawHost);</span>
<a href="#l3.836"></a><span id="l3.836" class="difflineplus">+        case &quot;cookieNameCol&quot;:</span>
<a href="#l3.837"></a><span id="l3.837" class="difflineplus">+          return dirFactor * aOne.name.localeCompare(aTwo.name);</span>
<a href="#l3.838"></a><span id="l3.838" class="difflineplus">+        case &quot;cookieExpiresCol&quot;:</span>
<a href="#l3.839"></a><span id="l3.839" class="difflineplus">+          return dirFactor * (aOne.expiresSortValue - aTwo.expiresSortValue);</span>
<a href="#l3.840"></a><span id="l3.840" class="difflineplus">+      }</span>
<a href="#l3.841"></a><span id="l3.841" class="difflineplus">+      return 0;</span>
<a href="#l3.842"></a><span id="l3.842" class="difflineplus">+    };</span>
<a href="#l3.843"></a><span id="l3.843" class="difflineplus">+</span>
<a href="#l3.844"></a><span id="l3.844" class="difflineplus">+    if (aUpdateSelection) {</span>
<a href="#l3.845"></a><span id="l3.845" class="difflineplus">+      var selectionCache = gDataman.getSelectedIDs(this.tree, this._getObjID);</span>
<a href="#l3.846"></a><span id="l3.846" class="difflineplus">+    }</span>
<a href="#l3.847"></a><span id="l3.847" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.848"></a><span id="l3.848" class="difflineplus">+</span>
<a href="#l3.849"></a><span id="l3.849" class="difflineplus">+    // Do the actual sorting of the array.</span>
<a href="#l3.850"></a><span id="l3.850" class="difflineplus">+    this.displayedCookies.sort(compfunc);</span>
<a href="#l3.851"></a><span id="l3.851" class="difflineplus">+    this.tree.treeBoxObject.invalidate();</span>
<a href="#l3.852"></a><span id="l3.852" class="difflineplus">+</span>
<a href="#l3.853"></a><span id="l3.853" class="difflineplus">+    if (aUpdateSelection) {</span>
<a href="#l3.854"></a><span id="l3.854" class="difflineplus">+      gDataman.restoreSelectionFromIDs(this.tree, this._getObjID, selectionCache);</span>
<a href="#l3.855"></a><span id="l3.855" class="difflineplus">+    }</span>
<a href="#l3.856"></a><span id="l3.856" class="difflineplus">+</span>
<a href="#l3.857"></a><span id="l3.857" class="difflineplus">+    // Set attributes to the sorting we did.</span>
<a href="#l3.858"></a><span id="l3.858" class="difflineplus">+    column.setAttribute(&quot;sortActive&quot;, &quot;true&quot;);</span>
<a href="#l3.859"></a><span id="l3.859" class="difflineplus">+    column.setAttribute(&quot;sortDirection&quot;, dirAscending ? &quot;ascending&quot; : &quot;descending&quot;);</span>
<a href="#l3.860"></a><span id="l3.860" class="difflineplus">+  },</span>
<a href="#l3.861"></a><span id="l3.861" class="difflineplus">+</span>
<a href="#l3.862"></a><span id="l3.862" class="difflineplus">+  delete: function cookies_delete() {</span>
<a href="#l3.863"></a><span id="l3.863" class="difflineplus">+    var selections = gDataman.getTreeSelections(this.tree);</span>
<a href="#l3.864"></a><span id="l3.864" class="difflineplus">+</span>
<a href="#l3.865"></a><span id="l3.865" class="difflineplus">+    if (selections.length &gt; 1) {</span>
<a href="#l3.866"></a><span id="l3.866" class="difflineplus">+      let title = gDataman.bundle.getString(&quot;cookies.deleteSelectedTitle&quot;);</span>
<a href="#l3.867"></a><span id="l3.867" class="difflineplus">+      let msg = gDataman.bundle.getString(&quot;cookies.deleteSelected&quot;);</span>
<a href="#l3.868"></a><span id="l3.868" class="difflineplus">+      let flags = ((Services.prompt.BUTTON_TITLE_IS_STRING * Services.prompt.BUTTON_POS_0) +</span>
<a href="#l3.869"></a><span id="l3.869" class="difflineplus">+                   (Services.prompt.BUTTON_TITLE_CANCEL * Services.prompt.BUTTON_POS_1) +</span>
<a href="#l3.870"></a><span id="l3.870" class="difflineplus">+                   Services.prompt.BUTTON_POS_1_DEFAULT)</span>
<a href="#l3.871"></a><span id="l3.871" class="difflineplus">+      let yes = gDataman.bundle.getString(&quot;cookies.deleteSelectedYes&quot;);</span>
<a href="#l3.872"></a><span id="l3.872" class="difflineplus">+      if (Services.prompt.confirmEx(window, title, msg, flags, yes, null, null,</span>
<a href="#l3.873"></a><span id="l3.873" class="difflineplus">+                                    null, {value: 0}) == 1) // 1==&quot;Cancel&quot; button</span>
<a href="#l3.874"></a><span id="l3.874" class="difflineplus">+        return;</span>
<a href="#l3.875"></a><span id="l3.875" class="difflineplus">+    }</span>
<a href="#l3.876"></a><span id="l3.876" class="difflineplus">+</span>
<a href="#l3.877"></a><span id="l3.877" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.878"></a><span id="l3.878" class="difflineplus">+    // Loop backwards so later indexes in the list don't change.</span>
<a href="#l3.879"></a><span id="l3.879" class="difflineplus">+    for (let i = selections.length - 1; i &gt;= 0; i--) {</span>
<a href="#l3.880"></a><span id="l3.880" class="difflineplus">+      let delCookie = this.displayedCookies[selections[i]];</span>
<a href="#l3.881"></a><span id="l3.881" class="difflineplus">+      this.cookies.splice(this.cookies.indexOf(this.displayedCookies[selections[i]]), 1);</span>
<a href="#l3.882"></a><span id="l3.882" class="difflineplus">+      this.displayedCookies.splice(selections[i], 1);</span>
<a href="#l3.883"></a><span id="l3.883" class="difflineplus">+      this.tree.treeBoxObject.rowCountChanged(selections[i], -1);</span>
<a href="#l3.884"></a><span id="l3.884" class="difflineplus">+      gLocSvc.cookie.remove(delCookie.host, delCookie.name, delCookie.path,</span>
<a href="#l3.885"></a><span id="l3.885" class="difflineplus">+                            this.blockOnRemove.checked);</span>
<a href="#l3.886"></a><span id="l3.886" class="difflineplus">+    }</span>
<a href="#l3.887"></a><span id="l3.887" class="difflineplus">+    if (!this.displayedCookies.length)</span>
<a href="#l3.888"></a><span id="l3.888" class="difflineplus">+      gDomains.removeDomainOrFlag(gDomains.selectedDomain.title, &quot;hasCookies&quot;);</span>
<a href="#l3.889"></a><span id="l3.889" class="difflineplus">+  },</span>
<a href="#l3.890"></a><span id="l3.890" class="difflineplus">+</span>
<a href="#l3.891"></a><span id="l3.891" class="difflineplus">+  updateContext: function cookies_updateContext() {</span>
<a href="#l3.892"></a><span id="l3.892" class="difflineplus">+    document.getElementById(&quot;cookies-context-remove&quot;).disabled =</span>
<a href="#l3.893"></a><span id="l3.893" class="difflineplus">+      this.removeButton.disabled;</span>
<a href="#l3.894"></a><span id="l3.894" class="difflineplus">+    document.getElementById(&quot;cookies-context-selectall&quot;).disabled =</span>
<a href="#l3.895"></a><span id="l3.895" class="difflineplus">+      this.tree.view.selection.count &gt;= this.tree.view.rowCount;</span>
<a href="#l3.896"></a><span id="l3.896" class="difflineplus">+  },</span>
<a href="#l3.897"></a><span id="l3.897" class="difflineplus">+</span>
<a href="#l3.898"></a><span id="l3.898" class="difflineplus">+  reactToChange: function cookies_reactToChange(aSubject, aData) {</span>
<a href="#l3.899"></a><span id="l3.899" class="difflineplus">+    // aData: added, changed, deleted, batch-deleted, cleared, reload</span>
<a href="#l3.900"></a><span id="l3.900" class="difflineplus">+    // see http://mxr.mozilla.org/mozilla-central/source/netwerk/cookie/nsICookieService.idl</span>
<a href="#l3.901"></a><span id="l3.901" class="difflineplus">+    if (aData == &quot;batch-deleted&quot; || aData == &quot;cleared&quot; || aData == &quot;reload&quot;) {</span>
<a href="#l3.902"></a><span id="l3.902" class="difflineplus">+      // Go for re-parsing the whole thing, as cleared and reload need that anyhow</span>
<a href="#l3.903"></a><span id="l3.903" class="difflineplus">+      // (batch-deleted has an nsIArray of cookies, we could in theory do better there).</span>
<a href="#l3.904"></a><span id="l3.904" class="difflineplus">+      var selectionCache = [];</span>
<a href="#l3.905"></a><span id="l3.905" class="difflineplus">+      if (this.displayedCookies.length) {</span>
<a href="#l3.906"></a><span id="l3.906" class="difflineplus">+        selectionCache = gDataman.getSelectedIDs(this.tree, this._getObjID);</span>
<a href="#l3.907"></a><span id="l3.907" class="difflineplus">+        this.displayedCookies = [];</span>
<a href="#l3.908"></a><span id="l3.908" class="difflineplus">+      }</span>
<a href="#l3.909"></a><span id="l3.909" class="difflineplus">+      this.loadList();</span>
<a href="#l3.910"></a><span id="l3.910" class="difflineplus">+      var domainList = [];</span>
<a href="#l3.911"></a><span id="l3.911" class="difflineplus">+      for (let i = 0; i &lt; this.cookies.length; i++) {</span>
<a href="#l3.912"></a><span id="l3.912" class="difflineplus">+        let domain = gDomains.getDomainFromHost(this.cookies[i].rawHost);</span>
<a href="#l3.913"></a><span id="l3.913" class="difflineplus">+        if (domainList.indexOf(domain) == -1)</span>
<a href="#l3.914"></a><span id="l3.914" class="difflineplus">+          domainList.push(domain);</span>
<a href="#l3.915"></a><span id="l3.915" class="difflineplus">+      }</span>
<a href="#l3.916"></a><span id="l3.916" class="difflineplus">+      gDomains.resetFlagToDomains(&quot;hasCookies&quot;, domainList);</span>
<a href="#l3.917"></a><span id="l3.917" class="difflineplus">+      // Restore the local panel display if needed.</span>
<a href="#l3.918"></a><span id="l3.918" class="difflineplus">+      if (gTabs.activePanel == &quot;cookiesPanel&quot; &amp;&amp;</span>
<a href="#l3.919"></a><span id="l3.919" class="difflineplus">+          gDomains.selectedDomain.hasCookies) {</span>
<a href="#l3.920"></a><span id="l3.920" class="difflineplus">+        this.tree.treeBoxObject.beginUpdateBatch();</span>
<a href="#l3.921"></a><span id="l3.921" class="difflineplus">+        this.displayedCookies = this.cookies.filter(</span>
<a href="#l3.922"></a><span id="l3.922" class="difflineplus">+          function (aCookie) {</span>
<a href="#l3.923"></a><span id="l3.923" class="difflineplus">+            return gDomains.hostMatchesSelected(aCookie.rawHost);</span>
<a href="#l3.924"></a><span id="l3.924" class="difflineplus">+          });</span>
<a href="#l3.925"></a><span id="l3.925" class="difflineplus">+        this.sort(null, false, false);</span>
<a href="#l3.926"></a><span id="l3.926" class="difflineplus">+        gDataman.restoreSelectionFromIDs(this.tree, this._getObjID, selectionCache);</span>
<a href="#l3.927"></a><span id="l3.927" class="difflineplus">+        this.tree.treeBoxObject.endUpdateBatch();</span>
<a href="#l3.928"></a><span id="l3.928" class="difflineplus">+      }</span>
<a href="#l3.929"></a><span id="l3.929" class="difflineplus">+      return;</span>
<a href="#l3.930"></a><span id="l3.930" class="difflineplus">+    }</span>
<a href="#l3.931"></a><span id="l3.931" class="difflineplus">+</span>
<a href="#l3.932"></a><span id="l3.932" class="difflineplus">+    // Usual notifications for added, changed, deleted - do &quot;surgical&quot; updates.</span>
<a href="#l3.933"></a><span id="l3.933" class="difflineplus">+    aSubject.QueryInterface(Components.interfaces.nsICookie2);</span>
<a href="#l3.934"></a><span id="l3.934" class="difflineplus">+    let domain = gDomains.getDomainFromHost(aSubject.rawHost);</span>
<a href="#l3.935"></a><span id="l3.935" class="difflineplus">+    // Does change affect possibly loaded Cookies pane?</span>
<a href="#l3.936"></a><span id="l3.936" class="difflineplus">+    let affectsLoaded = this.displayedCookies.length &amp;&amp;</span>
<a href="#l3.937"></a><span id="l3.937" class="difflineplus">+                        gDomains.hostMatchesSelected(aSubject.rawHost);</span>
<a href="#l3.938"></a><span id="l3.938" class="difflineplus">+    if (aData == &quot;added&quot;) {</span>
<a href="#l3.939"></a><span id="l3.939" class="difflineplus">+      this.cookies.push(this._makeCookieObject(aSubject));</span>
<a href="#l3.940"></a><span id="l3.940" class="difflineplus">+      if (affectsLoaded) {</span>
<a href="#l3.941"></a><span id="l3.941" class="difflineplus">+        this.displayedCookies.push(this.cookies[this.cookies.length - 1]);</span>
<a href="#l3.942"></a><span id="l3.942" class="difflineplus">+        this.tree.treeBoxObject.rowCountChanged(this.cookies.length - 1, 1);</span>
<a href="#l3.943"></a><span id="l3.943" class="difflineplus">+        this.sort(null, true, false);</span>
<a href="#l3.944"></a><span id="l3.944" class="difflineplus">+      }</span>
<a href="#l3.945"></a><span id="l3.945" class="difflineplus">+      else {</span>
<a href="#l3.946"></a><span id="l3.946" class="difflineplus">+        gDomains.addDomainOrFlag(aSubject.rawHost, &quot;hasCookies&quot;);</span>
<a href="#l3.947"></a><span id="l3.947" class="difflineplus">+      }</span>
<a href="#l3.948"></a><span id="l3.948" class="difflineplus">+    }</span>
<a href="#l3.949"></a><span id="l3.949" class="difflineplus">+    else {</span>
<a href="#l3.950"></a><span id="l3.950" class="difflineplus">+      let idx = -1, disp_idx = -1, domainCookies = 0;</span>
<a href="#l3.951"></a><span id="l3.951" class="difflineplus">+      if (affectsLoaded) {</span>
<a href="#l3.952"></a><span id="l3.952" class="difflineplus">+        for (let i = 0; i &lt; this.displayedCookies.length; i++) {</span>
<a href="#l3.953"></a><span id="l3.953" class="difflineplus">+          let cookie = this.displayedCookies[i];</span>
<a href="#l3.954"></a><span id="l3.954" class="difflineplus">+          if (cookie.host == aSubject.host &amp;&amp; cookie.name == aSubject.name &amp;&amp;</span>
<a href="#l3.955"></a><span id="l3.955" class="difflineplus">+              cookie.path == aSubject.path) {</span>
<a href="#l3.956"></a><span id="l3.956" class="difflineplus">+            idx = this.cookies.indexOf(this.displayedCookies[i]);</span>
<a href="#l3.957"></a><span id="l3.957" class="difflineplus">+            disp_idx = i;</span>
<a href="#l3.958"></a><span id="l3.958" class="difflineplus">+            break;</span>
<a href="#l3.959"></a><span id="l3.959" class="difflineplus">+          }</span>
<a href="#l3.960"></a><span id="l3.960" class="difflineplus">+        }</span>
<a href="#l3.961"></a><span id="l3.961" class="difflineplus">+        if (aData == &quot;deleted&quot;)</span>
<a href="#l3.962"></a><span id="l3.962" class="difflineplus">+          domainCookies = this.displayedCookies.length;</span>
<a href="#l3.963"></a><span id="l3.963" class="difflineplus">+      }</span>
<a href="#l3.964"></a><span id="l3.964" class="difflineplus">+      else {</span>
<a href="#l3.965"></a><span id="l3.965" class="difflineplus">+        for (let i = 0; i &lt; this.cookies.length; i++) {</span>
<a href="#l3.966"></a><span id="l3.966" class="difflineplus">+          let cookie = this.cookies[i];</span>
<a href="#l3.967"></a><span id="l3.967" class="difflineplus">+          if (cookie.host == aSubject.host &amp;&amp; cookie.name == aSubject.name &amp;&amp;</span>
<a href="#l3.968"></a><span id="l3.968" class="difflineplus">+              cookie.path == aSubject.path) {</span>
<a href="#l3.969"></a><span id="l3.969" class="difflineplus">+            idx = i;</span>
<a href="#l3.970"></a><span id="l3.970" class="difflineplus">+            if (aData != &quot;deleted&quot;)</span>
<a href="#l3.971"></a><span id="l3.971" class="difflineplus">+              break;</span>
<a href="#l3.972"></a><span id="l3.972" class="difflineplus">+          }</span>
<a href="#l3.973"></a><span id="l3.973" class="difflineplus">+          if (aData == &quot;deleted&quot; &amp;&amp;</span>
<a href="#l3.974"></a><span id="l3.974" class="difflineplus">+              gDomains.getDomainFromHost(cookie.rawHost) == domain)</span>
<a href="#l3.975"></a><span id="l3.975" class="difflineplus">+            domainCookies++;</span>
<a href="#l3.976"></a><span id="l3.976" class="difflineplus">+        }</span>
<a href="#l3.977"></a><span id="l3.977" class="difflineplus">+      }</span>
<a href="#l3.978"></a><span id="l3.978" class="difflineplus">+      if (idx &gt;= 0) {</span>
<a href="#l3.979"></a><span id="l3.979" class="difflineplus">+        if (aData == &quot;changed&quot;) {</span>
<a href="#l3.980"></a><span id="l3.980" class="difflineplus">+          this.cookies[idx] = this._makeCookieObject(aSubject);</span>
<a href="#l3.981"></a><span id="l3.981" class="difflineplus">+          if (affectsLoaded)</span>
<a href="#l3.982"></a><span id="l3.982" class="difflineplus">+            this.tree.treeBoxObject.invalidateRow(disp_idx);</span>
<a href="#l3.983"></a><span id="l3.983" class="difflineplus">+        }</span>
<a href="#l3.984"></a><span id="l3.984" class="difflineplus">+        else if (aData == &quot;deleted&quot;) {</span>
<a href="#l3.985"></a><span id="l3.985" class="difflineplus">+          this.cookies.splice(idx, 1);</span>
<a href="#l3.986"></a><span id="l3.986" class="difflineplus">+          if (affectsLoaded) {</span>
<a href="#l3.987"></a><span id="l3.987" class="difflineplus">+            this.displayedCookies.splice(disp_idx, 1);</span>
<a href="#l3.988"></a><span id="l3.988" class="difflineplus">+            this.tree.treeBoxObject.rowCountChanged(disp_idx, -1);</span>
<a href="#l3.989"></a><span id="l3.989" class="difflineplus">+          }</span>
<a href="#l3.990"></a><span id="l3.990" class="difflineplus">+          if (domainCookies == 1)</span>
<a href="#l3.991"></a><span id="l3.991" class="difflineplus">+            gDomains.removeDomainOrFlag(domain, &quot;hasCookies&quot;);</span>
<a href="#l3.992"></a><span id="l3.992" class="difflineplus">+        }</span>
<a href="#l3.993"></a><span id="l3.993" class="difflineplus">+      }</span>
<a href="#l3.994"></a><span id="l3.994" class="difflineplus">+    }</span>
<a href="#l3.995"></a><span id="l3.995" class="difflineplus">+  },</span>
<a href="#l3.996"></a><span id="l3.996" class="difflineplus">+</span>
<a href="#l3.997"></a><span id="l3.997" class="difflineplus">+  forget: function cookies_forget() {</span>
<a href="#l3.998"></a><span id="l3.998" class="difflineplus">+    for (let i = 0; i &lt; this.cookies.length; i++) {</span>
<a href="#l3.999"></a><span id="l3.999" class="difflineplus">+      if (gDomains.hostMatchesSelected(this.cookies[i].rawHost)) {</span>
<a href="#l3.1000"></a><span id="l3.1000" class="difflineplus">+        gLocSvc.cookie.remove(this.cookies[i].host, this.cookies[i].name,</span>
<a href="#l3.1001"></a><span id="l3.1001" class="difflineplus">+                              this.cookies[i].path, false);</span>
<a href="#l3.1002"></a><span id="l3.1002" class="difflineplus">+        this.cookies.splice(i, 1);</span>
<a href="#l3.1003"></a><span id="l3.1003" class="difflineplus">+      }</span>
<a href="#l3.1004"></a><span id="l3.1004" class="difflineplus">+    }</span>
<a href="#l3.1005"></a><span id="l3.1005" class="difflineplus">+    gDomains.removeDomainOrFlag(gDomains.selectedDomain.title, &quot;hasCookies&quot;);</span>
<a href="#l3.1006"></a><span id="l3.1006" class="difflineplus">+  },</span>
<a href="#l3.1007"></a><span id="l3.1007" class="difflineplus">+</span>
<a href="#l3.1008"></a><span id="l3.1008" class="difflineplus">+  // nsITreeView</span>
<a href="#l3.1009"></a><span id="l3.1009" class="difflineplus">+  __proto__: gBaseTreeView,</span>
<a href="#l3.1010"></a><span id="l3.1010" class="difflineplus">+  get rowCount() {</span>
<a href="#l3.1011"></a><span id="l3.1011" class="difflineplus">+    return this.displayedCookies.length;</span>
<a href="#l3.1012"></a><span id="l3.1012" class="difflineplus">+  },</span>
<a href="#l3.1013"></a><span id="l3.1013" class="difflineplus">+  getCellText: function(aRow, aColumn) {</span>
<a href="#l3.1014"></a><span id="l3.1014" class="difflineplus">+    let cookie = this.displayedCookies[aRow];</span>
<a href="#l3.1015"></a><span id="l3.1015" class="difflineplus">+    switch (aColumn.id) {</span>
<a href="#l3.1016"></a><span id="l3.1016" class="difflineplus">+      case &quot;cookieHostCol&quot;:</span>
<a href="#l3.1017"></a><span id="l3.1017" class="difflineplus">+        return cookie.rawHost;</span>
<a href="#l3.1018"></a><span id="l3.1018" class="difflineplus">+      case &quot;cookieNameCol&quot;:</span>
<a href="#l3.1019"></a><span id="l3.1019" class="difflineplus">+        return cookie.name;</span>
<a href="#l3.1020"></a><span id="l3.1020" class="difflineplus">+      case &quot;cookieExpiresCol&quot;:</span>
<a href="#l3.1021"></a><span id="l3.1021" class="difflineplus">+        return cookie.expires;</span>
<a href="#l3.1022"></a><span id="l3.1022" class="difflineplus">+    }</span>
<a href="#l3.1023"></a><span id="l3.1023" class="difflineplus">+  },</span>
<a href="#l3.1024"></a><span id="l3.1024" class="difflineplus">+};</span>
<a href="#l3.1025"></a><span id="l3.1025" class="difflineplus">+</span>
<a href="#l3.1026"></a><span id="l3.1026" class="difflineplus">+// :::::::::::::::::::: permissions panel ::::::::::::::::::::</span>
<a href="#l3.1027"></a><span id="l3.1027" class="difflineplus">+var gPerms = {</span>
<a href="#l3.1028"></a><span id="l3.1028" class="difflineplus">+  list: null,</span>
<a href="#l3.1029"></a><span id="l3.1029" class="difflineplus">+</span>
<a href="#l3.1030"></a><span id="l3.1030" class="difflineplus">+  initialize: function permissions_initialize() {</span>
<a href="#l3.1031"></a><span id="l3.1031" class="difflineplus">+    gDataman.debugMsg(&quot;Initializing permissions panel&quot;);</span>
<a href="#l3.1032"></a><span id="l3.1032" class="difflineplus">+    this.list = document.getElementById(&quot;permList&quot;);</span>
<a href="#l3.1033"></a><span id="l3.1033" class="difflineplus">+</span>
<a href="#l3.1034"></a><span id="l3.1034" class="difflineplus">+    let enumerator = Services.perms.enumerator;</span>
<a href="#l3.1035"></a><span id="l3.1035" class="difflineplus">+    while (enumerator.hasMoreElements()) {</span>
<a href="#l3.1036"></a><span id="l3.1036" class="difflineplus">+      let nextPermission = enumerator.getNext();</span>
<a href="#l3.1037"></a><span id="l3.1037" class="difflineplus">+      nextPermission = nextPermission.QueryInterface(Components.interfaces.nsIPermission);</span>
<a href="#l3.1038"></a><span id="l3.1038" class="difflineplus">+      let rawHost = nextPermission.host.replace(/^\./, &quot;&quot;);</span>
<a href="#l3.1039"></a><span id="l3.1039" class="difflineplus">+      if (gDomains.hostMatchesSelected(rawHost)) {</span>
<a href="#l3.1040"></a><span id="l3.1040" class="difflineplus">+        let permElem = document.createElement(&quot;richlistitem&quot;);</span>
<a href="#l3.1041"></a><span id="l3.1041" class="difflineplus">+        permElem.setAttribute(&quot;type&quot;, nextPermission.type);</span>
<a href="#l3.1042"></a><span id="l3.1042" class="difflineplus">+        permElem.setAttribute(&quot;host&quot;, nextPermission.host);</span>
<a href="#l3.1043"></a><span id="l3.1043" class="difflineplus">+        permElem.setAttribute(&quot;rawHost&quot;, rawHost);</span>
<a href="#l3.1044"></a><span id="l3.1044" class="difflineplus">+        permElem.setAttribute(&quot;capability&quot;, nextPermission.capability);</span>
<a href="#l3.1045"></a><span id="l3.1045" class="difflineplus">+        permElem.setAttribute(&quot;class&quot;, &quot;permission&quot;);</span>
<a href="#l3.1046"></a><span id="l3.1046" class="difflineplus">+        this.list.appendChild(permElem);</span>
<a href="#l3.1047"></a><span id="l3.1047" class="difflineplus">+      }</span>
<a href="#l3.1048"></a><span id="l3.1048" class="difflineplus">+    }</span>
<a href="#l3.1049"></a><span id="l3.1049" class="difflineplus">+    // Visually treat password rejects like permissions.</span>
<a href="#l3.1050"></a><span id="l3.1050" class="difflineplus">+    let rejectHosts = gLocSvc.pwd.getAllDisabledHosts();</span>
<a href="#l3.1051"></a><span id="l3.1051" class="difflineplus">+    for (let i = 0; i &lt; rejectHosts.length; i++) {</span>
<a href="#l3.1052"></a><span id="l3.1052" class="difflineplus">+      if (gDomains.hostMatchesSelected(rejectHosts[i])) {</span>
<a href="#l3.1053"></a><span id="l3.1053" class="difflineplus">+        let permElem = document.createElement(&quot;richlistitem&quot;);</span>
<a href="#l3.1054"></a><span id="l3.1054" class="difflineplus">+        permElem.setAttribute(&quot;type&quot;, &quot;password&quot;);</span>
<a href="#l3.1055"></a><span id="l3.1055" class="difflineplus">+        permElem.setAttribute(&quot;host&quot;, rejectHosts[i]);</span>
<a href="#l3.1056"></a><span id="l3.1056" class="difflineplus">+        permElem.setAttribute(&quot;rawHost&quot;, gDomains.getDomainFromHost(rejectHosts[i]));</span>
<a href="#l3.1057"></a><span id="l3.1057" class="difflineplus">+        permElem.setAttribute(&quot;capability&quot;, Services.perms.DENY_ACTION);</span>
<a href="#l3.1058"></a><span id="l3.1058" class="difflineplus">+        permElem.setAttribute(&quot;class&quot;, &quot;permission&quot;);</span>
<a href="#l3.1059"></a><span id="l3.1059" class="difflineplus">+        this.list.appendChild(permElem);</span>
<a href="#l3.1060"></a><span id="l3.1060" class="difflineplus">+      }</span>
<a href="#l3.1061"></a><span id="l3.1061" class="difflineplus">+    }</span>
<a href="#l3.1062"></a><span id="l3.1062" class="difflineplus">+  },</span>
<a href="#l3.1063"></a><span id="l3.1063" class="difflineplus">+</span>
<a href="#l3.1064"></a><span id="l3.1064" class="difflineplus">+  shutdown: function permissions_shutdown() {</span>
<a href="#l3.1065"></a><span id="l3.1065" class="difflineplus">+    gDataman.debugMsg(&quot;Shutting down permissions panel&quot;);</span>
<a href="#l3.1066"></a><span id="l3.1066" class="difflineplus">+    // XXX: Here we could detect if we still hold any non-default settings and</span>
<a href="#l3.1067"></a><span id="l3.1067" class="difflineplus">+    //      trigger the removeDomainOrFlag if not.</span>
<a href="#l3.1068"></a><span id="l3.1068" class="difflineplus">+    while (this.list.hasChildNodes())</span>
<a href="#l3.1069"></a><span id="l3.1069" class="difflineplus">+      this.list.removeChild(this.list.lastChild);</span>
<a href="#l3.1070"></a><span id="l3.1070" class="difflineplus">+  },</span>
<a href="#l3.1071"></a><span id="l3.1071" class="difflineplus">+</span>
<a href="#l3.1072"></a><span id="l3.1072" class="difflineplus">+  // Most functions of permissions are in the XBL items!</span>
<a href="#l3.1073"></a><span id="l3.1073" class="difflineplus">+</span>
<a href="#l3.1074"></a><span id="l3.1074" class="difflineplus">+  getDefault: function permissions_getDefault(aType) {</span>
<a href="#l3.1075"></a><span id="l3.1075" class="difflineplus">+    switch (aType) {</span>
<a href="#l3.1076"></a><span id="l3.1076" class="difflineplus">+      case &quot;allowXULXBL&quot;:</span>
<a href="#l3.1077"></a><span id="l3.1077" class="difflineplus">+        return Services.perms.DENY_ACTION;</span>
<a href="#l3.1078"></a><span id="l3.1078" class="difflineplus">+      case &quot;cookie&quot;:</span>
<a href="#l3.1079"></a><span id="l3.1079" class="difflineplus">+        if (Services.prefs.getIntPref(&quot;network.cookie.cookieBehavior&quot;) == 2)</span>
<a href="#l3.1080"></a><span id="l3.1080" class="difflineplus">+          return Services.perms.DENY_ACTION;</span>
<a href="#l3.1081"></a><span id="l3.1081" class="difflineplus">+        if (Services.prefs.getIntPref(&quot;network.cookie.lifetimePolicy&quot;) == 2)</span>
<a href="#l3.1082"></a><span id="l3.1082" class="difflineplus">+          return Components.interfaces.nsICookiePermission.ACCESS_SESSION;</span>
<a href="#l3.1083"></a><span id="l3.1083" class="difflineplus">+        return Services.perms.ALLOW_ACTION;</span>
<a href="#l3.1084"></a><span id="l3.1084" class="difflineplus">+      case &quot;geo&quot;:</span>
<a href="#l3.1085"></a><span id="l3.1085" class="difflineplus">+        return Services.perms.DENY_ACTION;</span>
<a href="#l3.1086"></a><span id="l3.1086" class="difflineplus">+      case &quot;image&quot;:</span>
<a href="#l3.1087"></a><span id="l3.1087" class="difflineplus">+        if (Services.prefs.getIntPref(&quot;permissions.default.image&quot;) == 2)</span>
<a href="#l3.1088"></a><span id="l3.1088" class="difflineplus">+          return Services.perms.DENY_ACTION;</span>
<a href="#l3.1089"></a><span id="l3.1089" class="difflineplus">+        return Services.perms.ALLOW_ACTION;</span>
<a href="#l3.1090"></a><span id="l3.1090" class="difflineplus">+      case &quot;install&quot;:</span>
<a href="#l3.1091"></a><span id="l3.1091" class="difflineplus">+        if (Services.prefs.getBoolPref(&quot;xpinstall.whitelist.required&quot;))</span>
<a href="#l3.1092"></a><span id="l3.1092" class="difflineplus">+          return Services.perms.DENY_ACTION;</span>
<a href="#l3.1093"></a><span id="l3.1093" class="difflineplus">+        return Services.perms.ALLOW_ACTION;</span>
<a href="#l3.1094"></a><span id="l3.1094" class="difflineplus">+      case &quot;password&quot;:</span>
<a href="#l3.1095"></a><span id="l3.1095" class="difflineplus">+        return Services.perms.ALLOW_ACTION;</span>
<a href="#l3.1096"></a><span id="l3.1096" class="difflineplus">+      case &quot;popup&quot;:</span>
<a href="#l3.1097"></a><span id="l3.1097" class="difflineplus">+        if (Services.prefs.getBoolPref(&quot;dom.disable_open_during_load&quot;))</span>
<a href="#l3.1098"></a><span id="l3.1098" class="difflineplus">+          return Services.perms.DENY_ACTION;</span>
<a href="#l3.1099"></a><span id="l3.1099" class="difflineplus">+        return Services.perms.ALLOW_ACTION;</span>
<a href="#l3.1100"></a><span id="l3.1100" class="difflineplus">+    }</span>
<a href="#l3.1101"></a><span id="l3.1101" class="difflineplus">+    return Services.perms.UNKNOWN_ACTION;</span>
<a href="#l3.1102"></a><span id="l3.1102" class="difflineplus">+  },</span>
<a href="#l3.1103"></a><span id="l3.1103" class="difflineplus">+</span>
<a href="#l3.1104"></a><span id="l3.1104" class="difflineplus">+  reactToChange: function permissions_reactToChange(aSubject, aData) {</span>
<a href="#l3.1105"></a><span id="l3.1105" class="difflineplus">+    if (/^hostSaving/.test(aData)) {</span>
<a href="#l3.1106"></a><span id="l3.1106" class="difflineplus">+      // aData: hostSavingEnabled, hostSavingDisabled</span>
<a href="#l3.1107"></a><span id="l3.1107" class="difflineplus">+      aSubject.QueryInterface(Components.interfaces.nsISupportsString);</span>
<a href="#l3.1108"></a><span id="l3.1108" class="difflineplus">+      let domain = gDomains.getDomainFromHost(aSubject.data);</span>
<a href="#l3.1109"></a><span id="l3.1109" class="difflineplus">+      // Does change affect possibly loaded Preferences pane?</span>
<a href="#l3.1110"></a><span id="l3.1110" class="difflineplus">+      let affectsLoaded = this.list &amp;&amp; this.list.childElementCount &amp;&amp;</span>
<a href="#l3.1111"></a><span id="l3.1111" class="difflineplus">+                          gDomains.hostMatchesSelected(aSubject.data);</span>
<a href="#l3.1112"></a><span id="l3.1112" class="difflineplus">+      let permElem = null;</span>
<a href="#l3.1113"></a><span id="l3.1113" class="difflineplus">+      if (affectsLoaded) {</span>
<a href="#l3.1114"></a><span id="l3.1114" class="difflineplus">+        for (let i = 0; i &lt; this.list.children.length; i++) {</span>
<a href="#l3.1115"></a><span id="l3.1115" class="difflineplus">+          let elem = this.list.children[i];</span>
<a href="#l3.1116"></a><span id="l3.1116" class="difflineplus">+          if (elem.getAttribute(&quot;host&quot;) == aSubject.data &amp;&amp;</span>
<a href="#l3.1117"></a><span id="l3.1117" class="difflineplus">+              elem.getAttribute(&quot;type&quot;) == &quot;password&quot;)</span>
<a href="#l3.1118"></a><span id="l3.1118" class="difflineplus">+            permElem = elem;</span>
<a href="#l3.1119"></a><span id="l3.1119" class="difflineplus">+        }</span>
<a href="#l3.1120"></a><span id="l3.1120" class="difflineplus">+      }</span>
<a href="#l3.1121"></a><span id="l3.1121" class="difflineplus">+      if (aData == &quot;hostSavingEnabled&quot;) {</span>
<a href="#l3.1122"></a><span id="l3.1122" class="difflineplus">+        if (affectsLoaded) {</span>
<a href="#l3.1123"></a><span id="l3.1123" class="difflineplus">+          permElem.setCapability(Services.perms.ALLOW_ACTION, true);</span>
<a href="#l3.1124"></a><span id="l3.1124" class="difflineplus">+        }</span>
<a href="#l3.1125"></a><span id="l3.1125" class="difflineplus">+        else {</span>
<a href="#l3.1126"></a><span id="l3.1126" class="difflineplus">+          // Only remove if domain is not shown, note that this may leave an empty domain.</span>
<a href="#l3.1127"></a><span id="l3.1127" class="difflineplus">+          let haveDomainPerms = false;</span>
<a href="#l3.1128"></a><span id="l3.1128" class="difflineplus">+          let enumerator = Services.perms.enumerator;</span>
<a href="#l3.1129"></a><span id="l3.1129" class="difflineplus">+          while (enumerator.hasMoreElements()) {</span>
<a href="#l3.1130"></a><span id="l3.1130" class="difflineplus">+            let nextPermission = enumerator.getNext();</span>
<a href="#l3.1131"></a><span id="l3.1131" class="difflineplus">+            nextPermission = nextPermission.QueryInterface(Components.interfaces.nsIPermission);</span>
<a href="#l3.1132"></a><span id="l3.1132" class="difflineplus">+            if (domain == gDomains.getDomainFromHost(nextPermission.host.replace(/^\./, &quot;&quot;)))</span>
<a href="#l3.1133"></a><span id="l3.1133" class="difflineplus">+              haveDomainPerms = true;</span>
<a href="#l3.1134"></a><span id="l3.1134" class="difflineplus">+          }</span>
<a href="#l3.1135"></a><span id="l3.1135" class="difflineplus">+          let rejectHosts = gLocSvc.pwd.getAllDisabledHosts();</span>
<a href="#l3.1136"></a><span id="l3.1136" class="difflineplus">+          for (let i = 0; i &lt; rejectHosts.length; i++) {</span>
<a href="#l3.1137"></a><span id="l3.1137" class="difflineplus">+            if (domain == gDomains.getDomainFromHost(rejectHosts[i]))</span>
<a href="#l3.1138"></a><span id="l3.1138" class="difflineplus">+              haveDomainPerms = true;</span>
<a href="#l3.1139"></a><span id="l3.1139" class="difflineplus">+          }</span>
<a href="#l3.1140"></a><span id="l3.1140" class="difflineplus">+          if (!haveDomainPerms)</span>
<a href="#l3.1141"></a><span id="l3.1141" class="difflineplus">+            gDomains.removeDomainOrFlag(domain, &quot;hasPermissions&quot;);</span>
<a href="#l3.1142"></a><span id="l3.1142" class="difflineplus">+        }</span>
<a href="#l3.1143"></a><span id="l3.1143" class="difflineplus">+      }</span>
<a href="#l3.1144"></a><span id="l3.1144" class="difflineplus">+      else if (aData == &quot;hostSavingDisabled&quot;) {</span>
<a href="#l3.1145"></a><span id="l3.1145" class="difflineplus">+        if (affectsLoaded) {</span>
<a href="#l3.1146"></a><span id="l3.1146" class="difflineplus">+          if (permElem) {</span>
<a href="#l3.1147"></a><span id="l3.1147" class="difflineplus">+            permElem.setCapability(Services.perms.DENY_ACTION, true);</span>
<a href="#l3.1148"></a><span id="l3.1148" class="difflineplus">+          }</span>
<a href="#l3.1149"></a><span id="l3.1149" class="difflineplus">+          else {</span>
<a href="#l3.1150"></a><span id="l3.1150" class="difflineplus">+            permElem = document.createElement(&quot;richlistitem&quot;);</span>
<a href="#l3.1151"></a><span id="l3.1151" class="difflineplus">+            permElem.setAttribute(&quot;type&quot;, &quot;password&quot;);</span>
<a href="#l3.1152"></a><span id="l3.1152" class="difflineplus">+            permElem.setAttribute(&quot;host&quot;, aSubject.data);</span>
<a href="#l3.1153"></a><span id="l3.1153" class="difflineplus">+            permElem.setAttribute(&quot;rawHost&quot;, domain);</span>
<a href="#l3.1154"></a><span id="l3.1154" class="difflineplus">+            permElem.setAttribute(&quot;capability&quot;, 2);</span>
<a href="#l3.1155"></a><span id="l3.1155" class="difflineplus">+            permElem.setAttribute(&quot;class&quot;, &quot;permission&quot;);</span>
<a href="#l3.1156"></a><span id="l3.1156" class="difflineplus">+            permElem.setAttribute(&quot;orient&quot;, &quot;vertical&quot;);</span>
<a href="#l3.1157"></a><span id="l3.1157" class="difflineplus">+            this.list.appendChild(permElem);</span>
<a href="#l3.1158"></a><span id="l3.1158" class="difflineplus">+          }</span>
<a href="#l3.1159"></a><span id="l3.1159" class="difflineplus">+        }</span>
<a href="#l3.1160"></a><span id="l3.1160" class="difflineplus">+        gDomains.addDomainOrFlag(aSubject.data, &quot;hasPermissions&quot;);</span>
<a href="#l3.1161"></a><span id="l3.1161" class="difflineplus">+      }</span>
<a href="#l3.1162"></a><span id="l3.1162" class="difflineplus">+    }</span>
<a href="#l3.1163"></a><span id="l3.1163" class="difflineplus">+    else {</span>
<a href="#l3.1164"></a><span id="l3.1164" class="difflineplus">+      // aData: added, changed, deleted, cleared</span>
<a href="#l3.1165"></a><span id="l3.1165" class="difflineplus">+      // See http://mxr.mozilla.org/mozilla-central/source/netwerk/base/public/nsIPermissionManager.idl</span>
<a href="#l3.1166"></a><span id="l3.1166" class="difflineplus">+      if (aData == &quot;cleared&quot;) {</span>
<a href="#l3.1167"></a><span id="l3.1167" class="difflineplus">+        let domainList = [];</span>
<a href="#l3.1168"></a><span id="l3.1168" class="difflineplus">+        // Blocked passwords still belong in the list.</span>
<a href="#l3.1169"></a><span id="l3.1169" class="difflineplus">+        let rejectHosts = gLocSvc.pwd.getAllDisabledHosts();</span>
<a href="#l3.1170"></a><span id="l3.1170" class="difflineplus">+        for (let i = 0; i &lt; rejectHosts.length; i++) {</span>
<a href="#l3.1171"></a><span id="l3.1171" class="difflineplus">+          let dom = gDomains.getDomainFromHost(rejectHosts[i]);</span>
<a href="#l3.1172"></a><span id="l3.1172" class="difflineplus">+          if (domainList.indexOf(dom) == -1)</span>
<a href="#l3.1173"></a><span id="l3.1173" class="difflineplus">+            domainList.push(dom);</span>
<a href="#l3.1174"></a><span id="l3.1174" class="difflineplus">+        }</span>
<a href="#l3.1175"></a><span id="l3.1175" class="difflineplus">+        gDomains.resetFlagToDomains(&quot;hasPermissions&quot;, domainList);</span>
<a href="#l3.1176"></a><span id="l3.1176" class="difflineplus">+        return;</span>
<a href="#l3.1177"></a><span id="l3.1177" class="difflineplus">+      }</span>
<a href="#l3.1178"></a><span id="l3.1178" class="difflineplus">+      aSubject.QueryInterface(Components.interfaces.nsIPermission);</span>
<a href="#l3.1179"></a><span id="l3.1179" class="difflineplus">+      let rawHost = aSubject.host.replace(/^\./, &quot;&quot;);</span>
<a href="#l3.1180"></a><span id="l3.1180" class="difflineplus">+      let domain = gDomains.getDomainFromHost(rawHost);</span>
<a href="#l3.1181"></a><span id="l3.1181" class="difflineplus">+      // Does change affect possibly loaded Preferences pane?</span>
<a href="#l3.1182"></a><span id="l3.1182" class="difflineplus">+      let affectsLoaded = this.list &amp;&amp; this.list.childElementCount &amp;&amp;</span>
<a href="#l3.1183"></a><span id="l3.1183" class="difflineplus">+                          gDomains.hostMatchesSelected(rawHost);</span>
<a href="#l3.1184"></a><span id="l3.1184" class="difflineplus">+      let permElem = null;</span>
<a href="#l3.1185"></a><span id="l3.1185" class="difflineplus">+      if (affectsLoaded) {</span>
<a href="#l3.1186"></a><span id="l3.1186" class="difflineplus">+        for (let i = 0; i &lt; this.list.children.length; i++) {</span>
<a href="#l3.1187"></a><span id="l3.1187" class="difflineplus">+          let elem = this.list.children[i];</span>
<a href="#l3.1188"></a><span id="l3.1188" class="difflineplus">+          if (elem.getAttribute(&quot;host&quot;) == aSubject.host &amp;&amp;</span>
<a href="#l3.1189"></a><span id="l3.1189" class="difflineplus">+              elem.getAttribute(&quot;type&quot;) == aSubject.type)</span>
<a href="#l3.1190"></a><span id="l3.1190" class="difflineplus">+            permElem = elem;</span>
<a href="#l3.1191"></a><span id="l3.1191" class="difflineplus">+        }</span>
<a href="#l3.1192"></a><span id="l3.1192" class="difflineplus">+      }</span>
<a href="#l3.1193"></a><span id="l3.1193" class="difflineplus">+      if (aData == &quot;deleted&quot;) {</span>
<a href="#l3.1194"></a><span id="l3.1194" class="difflineplus">+        if (affectsLoaded) {</span>
<a href="#l3.1195"></a><span id="l3.1195" class="difflineplus">+          permElem.useDefault(true, true);</span>
<a href="#l3.1196"></a><span id="l3.1196" class="difflineplus">+        }</span>
<a href="#l3.1197"></a><span id="l3.1197" class="difflineplus">+        else {</span>
<a href="#l3.1198"></a><span id="l3.1198" class="difflineplus">+          // Only remove if domain is not shown, note that this may leave an empty domain.</span>
<a href="#l3.1199"></a><span id="l3.1199" class="difflineplus">+          let haveDomainPerms = false;</span>
<a href="#l3.1200"></a><span id="l3.1200" class="difflineplus">+          let enumerator = Services.perms.enumerator;</span>
<a href="#l3.1201"></a><span id="l3.1201" class="difflineplus">+          while (enumerator.hasMoreElements()) {</span>
<a href="#l3.1202"></a><span id="l3.1202" class="difflineplus">+            let nextPermission = enumerator.getNext();</span>
<a href="#l3.1203"></a><span id="l3.1203" class="difflineplus">+            nextPermission = nextPermission.QueryInterface(Components.interfaces.nsIPermission);</span>
<a href="#l3.1204"></a><span id="l3.1204" class="difflineplus">+            if (domain == gDomains.getDomainFromHost(nextPermission.host.replace(/^\./, &quot;&quot;)))</span>
<a href="#l3.1205"></a><span id="l3.1205" class="difflineplus">+              haveDomainPerms = true;</span>
<a href="#l3.1206"></a><span id="l3.1206" class="difflineplus">+          }</span>
<a href="#l3.1207"></a><span id="l3.1207" class="difflineplus">+          let rejectHosts = gLocSvc.pwd.getAllDisabledHosts();</span>
<a href="#l3.1208"></a><span id="l3.1208" class="difflineplus">+          for (let i = 0; i &lt; rejectHosts.length; i++) {</span>
<a href="#l3.1209"></a><span id="l3.1209" class="difflineplus">+            if (domain == gDomains.getDomainFromHost(rejectHosts[i]))</span>
<a href="#l3.1210"></a><span id="l3.1210" class="difflineplus">+              haveDomainPerms = true;</span>
<a href="#l3.1211"></a><span id="l3.1211" class="difflineplus">+          }</span>
<a href="#l3.1212"></a><span id="l3.1212" class="difflineplus">+          if (!haveDomainPerms)</span>
<a href="#l3.1213"></a><span id="l3.1213" class="difflineplus">+            gDomains.removeDomainOrFlag(domain, &quot;hasPermissions&quot;);</span>
<a href="#l3.1214"></a><span id="l3.1214" class="difflineplus">+        }</span>
<a href="#l3.1215"></a><span id="l3.1215" class="difflineplus">+      }</span>
<a href="#l3.1216"></a><span id="l3.1216" class="difflineplus">+      else if (aData == &quot;changed&quot; &amp;&amp; affectsLoaded) {</span>
<a href="#l3.1217"></a><span id="l3.1217" class="difflineplus">+        permElem.setCapability(aSubject.capability, true);</span>
<a href="#l3.1218"></a><span id="l3.1218" class="difflineplus">+      }</span>
<a href="#l3.1219"></a><span id="l3.1219" class="difflineplus">+      else if (aData == &quot;added&quot;) {</span>
<a href="#l3.1220"></a><span id="l3.1220" class="difflineplus">+        if (affectsLoaded) {</span>
<a href="#l3.1221"></a><span id="l3.1221" class="difflineplus">+          if (permElem) {</span>
<a href="#l3.1222"></a><span id="l3.1222" class="difflineplus">+            permElem.useDefault(false, true);</span>
<a href="#l3.1223"></a><span id="l3.1223" class="difflineplus">+            permElem.setCapability(aSubject.capability, true);</span>
<a href="#l3.1224"></a><span id="l3.1224" class="difflineplus">+          }</span>
<a href="#l3.1225"></a><span id="l3.1225" class="difflineplus">+          else {</span>
<a href="#l3.1226"></a><span id="l3.1226" class="difflineplus">+            permElem = document.createElement(&quot;richlistitem&quot;);</span>
<a href="#l3.1227"></a><span id="l3.1227" class="difflineplus">+            permElem.setAttribute(&quot;type&quot;, aSubject.type);</span>
<a href="#l3.1228"></a><span id="l3.1228" class="difflineplus">+            permElem.setAttribute(&quot;host&quot;, aSubject.host);</span>
<a href="#l3.1229"></a><span id="l3.1229" class="difflineplus">+            permElem.setAttribute(&quot;rawHost&quot;, rawHost);</span>
<a href="#l3.1230"></a><span id="l3.1230" class="difflineplus">+            permElem.setAttribute(&quot;capability&quot;, aSubject.capability);</span>
<a href="#l3.1231"></a><span id="l3.1231" class="difflineplus">+            permElem.setAttribute(&quot;class&quot;, &quot;permission&quot;);</span>
<a href="#l3.1232"></a><span id="l3.1232" class="difflineplus">+            permElem.setAttribute(&quot;orient&quot;, &quot;vertical&quot;);</span>
<a href="#l3.1233"></a><span id="l3.1233" class="difflineplus">+            this.list.appendChild(permElem);</span>
<a href="#l3.1234"></a><span id="l3.1234" class="difflineplus">+          }</span>
<a href="#l3.1235"></a><span id="l3.1235" class="difflineplus">+        }</span>
<a href="#l3.1236"></a><span id="l3.1236" class="difflineplus">+        gDomains.addDomainOrFlag(rawHost, &quot;hasPermissions&quot;);</span>
<a href="#l3.1237"></a><span id="l3.1237" class="difflineplus">+      }</span>
<a href="#l3.1238"></a><span id="l3.1238" class="difflineplus">+    }</span>
<a href="#l3.1239"></a><span id="l3.1239" class="difflineplus">+  },</span>
<a href="#l3.1240"></a><span id="l3.1240" class="difflineplus">+</span>
<a href="#l3.1241"></a><span id="l3.1241" class="difflineplus">+  forget: function permissions_forget() {</span>
<a href="#l3.1242"></a><span id="l3.1242" class="difflineplus">+    let delPerms = [];</span>
<a href="#l3.1243"></a><span id="l3.1243" class="difflineplus">+    let enumerator = Services.perms.enumerator;</span>
<a href="#l3.1244"></a><span id="l3.1244" class="difflineplus">+    while (enumerator.hasMoreElements()) {</span>
<a href="#l3.1245"></a><span id="l3.1245" class="difflineplus">+      let nextPermission = enumerator.getNext();</span>
<a href="#l3.1246"></a><span id="l3.1246" class="difflineplus">+      nextPermission = nextPermission.QueryInterface(Components.interfaces.nsIPermission);</span>
<a href="#l3.1247"></a><span id="l3.1247" class="difflineplus">+      let host = nextPermission.host;</span>
<a href="#l3.1248"></a><span id="l3.1248" class="difflineplus">+      if (gDomains.hostMatchesSelected(host.replace(/^\./, &quot;&quot;))) {</span>
<a href="#l3.1249"></a><span id="l3.1249" class="difflineplus">+        delPerms.push({host: host, type: nextPermission.type});</span>
<a href="#l3.1250"></a><span id="l3.1250" class="difflineplus">+      }</span>
<a href="#l3.1251"></a><span id="l3.1251" class="difflineplus">+    }</span>
<a href="#l3.1252"></a><span id="l3.1252" class="difflineplus">+    for (let i = 0; i &lt; delPerms.length; i++) {</span>
<a href="#l3.1253"></a><span id="l3.1253" class="difflineplus">+      Services.perms.remove(delPerms[i].host, delPerms[i].type);</span>
<a href="#l3.1254"></a><span id="l3.1254" class="difflineplus">+    }</span>
<a href="#l3.1255"></a><span id="l3.1255" class="difflineplus">+    // Also remove all password rejects.</span>
<a href="#l3.1256"></a><span id="l3.1256" class="difflineplus">+    let rejectHosts = gLocSvc.pwd.getAllDisabledHosts();</span>
<a href="#l3.1257"></a><span id="l3.1257" class="difflineplus">+    for (let i = 0; i &lt; rejectHosts.length; i++) {</span>
<a href="#l3.1258"></a><span id="l3.1258" class="difflineplus">+      if (gDomains.hostMatchesSelected(rejectHosts[i])) {</span>
<a href="#l3.1259"></a><span id="l3.1259" class="difflineplus">+        gLocSvc.pwd.setLoginSavingEnabled(rejectHosts[i], true);</span>
<a href="#l3.1260"></a><span id="l3.1260" class="difflineplus">+      }</span>
<a href="#l3.1261"></a><span id="l3.1261" class="difflineplus">+    }</span>
<a href="#l3.1262"></a><span id="l3.1262" class="difflineplus">+    gDomains.removeDomainOrFlag(gDomains.selectedDomain.title, &quot;hasPermissions&quot;);</span>
<a href="#l3.1263"></a><span id="l3.1263" class="difflineplus">+  },</span>
<a href="#l3.1264"></a><span id="l3.1264" class="difflineplus">+};</span>
<a href="#l3.1265"></a><span id="l3.1265" class="difflineplus">+</span>
<a href="#l3.1266"></a><span id="l3.1266" class="difflineplus">+// :::::::::::::::::::: content prefs panel ::::::::::::::::::::</span>
<a href="#l3.1267"></a><span id="l3.1267" class="difflineplus">+var gPrefs = {</span>
<a href="#l3.1268"></a><span id="l3.1268" class="difflineplus">+  tree: null,</span>
<a href="#l3.1269"></a><span id="l3.1269" class="difflineplus">+  removeButton: null,</span>
<a href="#l3.1270"></a><span id="l3.1270" class="difflineplus">+</span>
<a href="#l3.1271"></a><span id="l3.1271" class="difflineplus">+  prefs: [],</span>
<a href="#l3.1272"></a><span id="l3.1272" class="difflineplus">+</span>
<a href="#l3.1273"></a><span id="l3.1273" class="difflineplus">+  initialize: function prefs_initialize() {</span>
<a href="#l3.1274"></a><span id="l3.1274" class="difflineplus">+    gDataman.debugMsg(&quot;Initializing prefs panel&quot;);</span>
<a href="#l3.1275"></a><span id="l3.1275" class="difflineplus">+    this.tree = document.getElementById(&quot;prefsTree&quot;);</span>
<a href="#l3.1276"></a><span id="l3.1276" class="difflineplus">+    this.tree.view = this;</span>
<a href="#l3.1277"></a><span id="l3.1277" class="difflineplus">+</span>
<a href="#l3.1278"></a><span id="l3.1278" class="difflineplus">+    this.removeButton = document.getElementById(&quot;prefsRemove&quot;);</span>
<a href="#l3.1279"></a><span id="l3.1279" class="difflineplus">+</span>
<a href="#l3.1280"></a><span id="l3.1280" class="difflineplus">+    this.tree.treeBoxObject.beginUpdateBatch();</span>
<a href="#l3.1281"></a><span id="l3.1281" class="difflineplus">+    // Get all groups (hosts) that match the domain.</span>
<a href="#l3.1282"></a><span id="l3.1282" class="difflineplus">+    let domain = gDomains.selectedDomain.title;</span>
<a href="#l3.1283"></a><span id="l3.1283" class="difflineplus">+    if (domain == &quot;*&quot;) {</span>
<a href="#l3.1284"></a><span id="l3.1284" class="difflineplus">+      let enumerator = Services.contentPrefs.getPrefs(null).enumerator;</span>
<a href="#l3.1285"></a><span id="l3.1285" class="difflineplus">+      while (enumerator.hasMoreElements()) {</span>
<a href="#l3.1286"></a><span id="l3.1286" class="difflineplus">+        let pref = enumerator.getNext().QueryInterface(Components.interfaces.nsIProperty);</span>
<a href="#l3.1287"></a><span id="l3.1287" class="difflineplus">+        this.prefs.push({host: null, name: pref.name, value: pref.value});</span>
<a href="#l3.1288"></a><span id="l3.1288" class="difflineplus">+      }</span>
<a href="#l3.1289"></a><span id="l3.1289" class="difflineplus">+    }</span>
<a href="#l3.1290"></a><span id="l3.1290" class="difflineplus">+    else {</span>
<a href="#l3.1291"></a><span id="l3.1291" class="difflineplus">+      try {</span>
<a href="#l3.1292"></a><span id="l3.1292" class="difflineplus">+        let sql = &quot;SELECT groups.name AS host FROM groups WHERE host = :hostName OR host LIKE :hostMatch ESCAPE '/'&quot;;</span>
<a href="#l3.1293"></a><span id="l3.1293" class="difflineplus">+        var statement = Services.contentPrefs.DBConnection.createStatement(sql);</span>
<a href="#l3.1294"></a><span id="l3.1294" class="difflineplus">+        statement.params.hostName = domain;</span>
<a href="#l3.1295"></a><span id="l3.1295" class="difflineplus">+        statement.params.hostMatch = &quot;%.&quot; + statement.escapeStringForLIKE(domain, &quot;/&quot;);</span>
<a href="#l3.1296"></a><span id="l3.1296" class="difflineplus">+        while (statement.executeStep()) {</span>
<a href="#l3.1297"></a><span id="l3.1297" class="difflineplus">+          // Now, get all prefs for that host.</span>
<a href="#l3.1298"></a><span id="l3.1298" class="difflineplus">+          let enumerator =  Services.contentPrefs.getPrefs(statement.row[&quot;host&quot;]).enumerator;</span>
<a href="#l3.1299"></a><span id="l3.1299" class="difflineplus">+          while (enumerator.hasMoreElements()) {</span>
<a href="#l3.1300"></a><span id="l3.1300" class="difflineplus">+            let pref = enumerator.getNext().QueryInterface(Components.interfaces.nsIProperty);</span>
<a href="#l3.1301"></a><span id="l3.1301" class="difflineplus">+            this.prefs.push({host: statement.row[&quot;host&quot;], name: pref.name, value: pref.value});</span>
<a href="#l3.1302"></a><span id="l3.1302" class="difflineplus">+          }</span>
<a href="#l3.1303"></a><span id="l3.1303" class="difflineplus">+        }</span>
<a href="#l3.1304"></a><span id="l3.1304" class="difflineplus">+      }</span>
<a href="#l3.1305"></a><span id="l3.1305" class="difflineplus">+      finally {</span>
<a href="#l3.1306"></a><span id="l3.1306" class="difflineplus">+        statement.reset();</span>
<a href="#l3.1307"></a><span id="l3.1307" class="difflineplus">+      }</span>
<a href="#l3.1308"></a><span id="l3.1308" class="difflineplus">+    }</span>
<a href="#l3.1309"></a><span id="l3.1309" class="difflineplus">+    this.sort(null, false, false);</span>
<a href="#l3.1310"></a><span id="l3.1310" class="difflineplus">+    this.tree.treeBoxObject.endUpdateBatch();</span>
<a href="#l3.1311"></a><span id="l3.1311" class="difflineplus">+  },</span>
<a href="#l3.1312"></a><span id="l3.1312" class="difflineplus">+</span>
<a href="#l3.1313"></a><span id="l3.1313" class="difflineplus">+  shutdown: function prefs_shutdown() {</span>
<a href="#l3.1314"></a><span id="l3.1314" class="difflineplus">+    gDataman.debugMsg(&quot;Shutting down prefs panel&quot;);</span>
<a href="#l3.1315"></a><span id="l3.1315" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.1316"></a><span id="l3.1316" class="difflineplus">+    this.tree.view = null;</span>
<a href="#l3.1317"></a><span id="l3.1317" class="difflineplus">+    this.prefs = [];</span>
<a href="#l3.1318"></a><span id="l3.1318" class="difflineplus">+  },</span>
<a href="#l3.1319"></a><span id="l3.1319" class="difflineplus">+</span>
<a href="#l3.1320"></a><span id="l3.1320" class="difflineplus">+  _getObjID: function prefs__getObjID(aIdx) {</span>
<a href="#l3.1321"></a><span id="l3.1321" class="difflineplus">+    var curPref = gPrefs.prefs[aIdx];</span>
<a href="#l3.1322"></a><span id="l3.1322" class="difflineplus">+    return curPref.host + &quot;|&quot; + curPref.name;</span>
<a href="#l3.1323"></a><span id="l3.1323" class="difflineplus">+  },</span>
<a href="#l3.1324"></a><span id="l3.1324" class="difflineplus">+</span>
<a href="#l3.1325"></a><span id="l3.1325" class="difflineplus">+  select: function prefs_select() {</span>
<a href="#l3.1326"></a><span id="l3.1326" class="difflineplus">+    var selections = gDataman.getTreeSelections(this.tree);</span>
<a href="#l3.1327"></a><span id="l3.1327" class="difflineplus">+    this.removeButton.disabled = !selections.length;</span>
<a href="#l3.1328"></a><span id="l3.1328" class="difflineplus">+    return true;</span>
<a href="#l3.1329"></a><span id="l3.1329" class="difflineplus">+  },</span>
<a href="#l3.1330"></a><span id="l3.1330" class="difflineplus">+</span>
<a href="#l3.1331"></a><span id="l3.1331" class="difflineplus">+  selectAll: function prefs_selectAll() {</span>
<a href="#l3.1332"></a><span id="l3.1332" class="difflineplus">+    this.tree.view.selection.selectAll();</span>
<a href="#l3.1333"></a><span id="l3.1333" class="difflineplus">+  },</span>
<a href="#l3.1334"></a><span id="l3.1334" class="difflineplus">+</span>
<a href="#l3.1335"></a><span id="l3.1335" class="difflineplus">+  handleKeyPress: function prefs_handleKeyPress(aEvent) {</span>
<a href="#l3.1336"></a><span id="l3.1336" class="difflineplus">+    if (aEvent.keyCode == KeyEvent.DOM_VK_DELETE) {</span>
<a href="#l3.1337"></a><span id="l3.1337" class="difflineplus">+      this.delete();</span>
<a href="#l3.1338"></a><span id="l3.1338" class="difflineplus">+    }</span>
<a href="#l3.1339"></a><span id="l3.1339" class="difflineplus">+  },</span>
<a href="#l3.1340"></a><span id="l3.1340" class="difflineplus">+</span>
<a href="#l3.1341"></a><span id="l3.1341" class="difflineplus">+  sort: function prefs_sort(aColumn, aUpdateSelection, aInvertDirection) {</span>
<a href="#l3.1342"></a><span id="l3.1342" class="difflineplus">+    // Make sure we have a valid column.</span>
<a href="#l3.1343"></a><span id="l3.1343" class="difflineplus">+    let column = aColumn;</span>
<a href="#l3.1344"></a><span id="l3.1344" class="difflineplus">+    if (!column) {</span>
<a href="#l3.1345"></a><span id="l3.1345" class="difflineplus">+      let sortedCol = this.tree.columns.getSortedColumn();</span>
<a href="#l3.1346"></a><span id="l3.1346" class="difflineplus">+      if (sortedCol)</span>
<a href="#l3.1347"></a><span id="l3.1347" class="difflineplus">+        column = sortedCol.element;</span>
<a href="#l3.1348"></a><span id="l3.1348" class="difflineplus">+      else</span>
<a href="#l3.1349"></a><span id="l3.1349" class="difflineplus">+        column = document.getElementById(&quot;prefsHostCol&quot;);</span>
<a href="#l3.1350"></a><span id="l3.1350" class="difflineplus">+    }</span>
<a href="#l3.1351"></a><span id="l3.1351" class="difflineplus">+    else if (column.localName == &quot;treecols&quot; || column.localName == &quot;splitter&quot;)</span>
<a href="#l3.1352"></a><span id="l3.1352" class="difflineplus">+      return;</span>
<a href="#l3.1353"></a><span id="l3.1353" class="difflineplus">+</span>
<a href="#l3.1354"></a><span id="l3.1354" class="difflineplus">+    if (!column || column.localName != &quot;treecol&quot;) {</span>
<a href="#l3.1355"></a><span id="l3.1355" class="difflineplus">+      Components.utils.reportError(&quot;No column found to sort form data by&quot;);</span>
<a href="#l3.1356"></a><span id="l3.1356" class="difflineplus">+      return;</span>
<a href="#l3.1357"></a><span id="l3.1357" class="difflineplus">+    }</span>
<a href="#l3.1358"></a><span id="l3.1358" class="difflineplus">+</span>
<a href="#l3.1359"></a><span id="l3.1359" class="difflineplus">+    let dirAscending = column.getAttribute(&quot;sortDirection&quot;) !=</span>
<a href="#l3.1360"></a><span id="l3.1360" class="difflineplus">+                       (aInvertDirection ? &quot;ascending&quot; : &quot;descending&quot;);</span>
<a href="#l3.1361"></a><span id="l3.1361" class="difflineplus">+    let dirFactor = dirAscending ? 1 : -1;</span>
<a href="#l3.1362"></a><span id="l3.1362" class="difflineplus">+</span>
<a href="#l3.1363"></a><span id="l3.1363" class="difflineplus">+    // Clear attributes on all columns, we're setting them again after sorting.</span>
<a href="#l3.1364"></a><span id="l3.1364" class="difflineplus">+    for (let node = column.parentNode.firstChild; node; node = node.nextSibling) {</span>
<a href="#l3.1365"></a><span id="l3.1365" class="difflineplus">+      node.removeAttribute(&quot;sortActive&quot;);</span>
<a href="#l3.1366"></a><span id="l3.1366" class="difflineplus">+      node.removeAttribute(&quot;sortDirection&quot;);</span>
<a href="#l3.1367"></a><span id="l3.1367" class="difflineplus">+    }</span>
<a href="#l3.1368"></a><span id="l3.1368" class="difflineplus">+</span>
<a href="#l3.1369"></a><span id="l3.1369" class="difflineplus">+    // compare function for two content prefs</span>
<a href="#l3.1370"></a><span id="l3.1370" class="difflineplus">+    let compfunc = function prefs_sort_compare(aOne, aTwo) {</span>
<a href="#l3.1371"></a><span id="l3.1371" class="difflineplus">+      switch (column.id) {</span>
<a href="#l3.1372"></a><span id="l3.1372" class="difflineplus">+        case &quot;prefsHostCol&quot;:</span>
<a href="#l3.1373"></a><span id="l3.1373" class="difflineplus">+          return dirFactor * aOne.host.localeCompare(aTwo.host);</span>
<a href="#l3.1374"></a><span id="l3.1374" class="difflineplus">+        case &quot;prefsNameCol&quot;:</span>
<a href="#l3.1375"></a><span id="l3.1375" class="difflineplus">+          return dirFactor * aOne.name.localeCompare(aTwo.name);</span>
<a href="#l3.1376"></a><span id="l3.1376" class="difflineplus">+        case &quot;prefsValueCol&quot;:</span>
<a href="#l3.1377"></a><span id="l3.1377" class="difflineplus">+          return dirFactor * aOne.value.toString().localeCompare(aTwo.value);</span>
<a href="#l3.1378"></a><span id="l3.1378" class="difflineplus">+      }</span>
<a href="#l3.1379"></a><span id="l3.1379" class="difflineplus">+      return 0;</span>
<a href="#l3.1380"></a><span id="l3.1380" class="difflineplus">+    };</span>
<a href="#l3.1381"></a><span id="l3.1381" class="difflineplus">+</span>
<a href="#l3.1382"></a><span id="l3.1382" class="difflineplus">+    if (aUpdateSelection) {</span>
<a href="#l3.1383"></a><span id="l3.1383" class="difflineplus">+      var selectionCache = gDataman.getSelectedIDs(this.tree, this._getObjID);</span>
<a href="#l3.1384"></a><span id="l3.1384" class="difflineplus">+    }</span>
<a href="#l3.1385"></a><span id="l3.1385" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.1386"></a><span id="l3.1386" class="difflineplus">+</span>
<a href="#l3.1387"></a><span id="l3.1387" class="difflineplus">+    // Do the actual sorting of the array.</span>
<a href="#l3.1388"></a><span id="l3.1388" class="difflineplus">+    this.prefs.sort(compfunc);</span>
<a href="#l3.1389"></a><span id="l3.1389" class="difflineplus">+    this.tree.treeBoxObject.invalidate();</span>
<a href="#l3.1390"></a><span id="l3.1390" class="difflineplus">+</span>
<a href="#l3.1391"></a><span id="l3.1391" class="difflineplus">+    if (aUpdateSelection) {</span>
<a href="#l3.1392"></a><span id="l3.1392" class="difflineplus">+      gDataman.restoreSelectionFromIDs(this.tree, this._getObjID, selectionCache);</span>
<a href="#l3.1393"></a><span id="l3.1393" class="difflineplus">+    }</span>
<a href="#l3.1394"></a><span id="l3.1394" class="difflineplus">+</span>
<a href="#l3.1395"></a><span id="l3.1395" class="difflineplus">+    // Set attributes to the sorting we did.</span>
<a href="#l3.1396"></a><span id="l3.1396" class="difflineplus">+    column.setAttribute(&quot;sortActive&quot;, &quot;true&quot;);</span>
<a href="#l3.1397"></a><span id="l3.1397" class="difflineplus">+    column.setAttribute(&quot;sortDirection&quot;, dirAscending ? &quot;ascending&quot; : &quot;descending&quot;);</span>
<a href="#l3.1398"></a><span id="l3.1398" class="difflineplus">+  },</span>
<a href="#l3.1399"></a><span id="l3.1399" class="difflineplus">+</span>
<a href="#l3.1400"></a><span id="l3.1400" class="difflineplus">+  delete: function prefs_delete() {</span>
<a href="#l3.1401"></a><span id="l3.1401" class="difflineplus">+    var selections = gDataman.getTreeSelections(this.tree);</span>
<a href="#l3.1402"></a><span id="l3.1402" class="difflineplus">+</span>
<a href="#l3.1403"></a><span id="l3.1403" class="difflineplus">+    if (selections.length &gt; 1) {</span>
<a href="#l3.1404"></a><span id="l3.1404" class="difflineplus">+      let title = gDataman.bundle.getString(&quot;prefs.deleteSelectedTitle&quot;);</span>
<a href="#l3.1405"></a><span id="l3.1405" class="difflineplus">+      let msg = gDataman.bundle.getString(&quot;prefs.deleteSelected&quot;);</span>
<a href="#l3.1406"></a><span id="l3.1406" class="difflineplus">+      let flags = ((Services.prompt.BUTTON_TITLE_IS_STRING * Services.prompt.BUTTON_POS_0) +</span>
<a href="#l3.1407"></a><span id="l3.1407" class="difflineplus">+                   (Services.prompt.BUTTON_TITLE_CANCEL * Services.prompt.BUTTON_POS_1) +</span>
<a href="#l3.1408"></a><span id="l3.1408" class="difflineplus">+                   Services.prompt.BUTTON_POS_1_DEFAULT)</span>
<a href="#l3.1409"></a><span id="l3.1409" class="difflineplus">+      let yes = gDataman.bundle.getString(&quot;prefs.deleteSelectedYes&quot;);</span>
<a href="#l3.1410"></a><span id="l3.1410" class="difflineplus">+      if (Services.prompt.confirmEx(window, title, msg, flags, yes, null, null,</span>
<a href="#l3.1411"></a><span id="l3.1411" class="difflineplus">+                                    null, {value: 0}) == 1) // 1==&quot;Cancel&quot; button</span>
<a href="#l3.1412"></a><span id="l3.1412" class="difflineplus">+        return;</span>
<a href="#l3.1413"></a><span id="l3.1413" class="difflineplus">+    }</span>
<a href="#l3.1414"></a><span id="l3.1414" class="difflineplus">+</span>
<a href="#l3.1415"></a><span id="l3.1415" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.1416"></a><span id="l3.1416" class="difflineplus">+    // Loop backwards so later indexes in the list don't change.</span>
<a href="#l3.1417"></a><span id="l3.1417" class="difflineplus">+    for (let i = selections.length - 1; i &gt;= 0; i--) {</span>
<a href="#l3.1418"></a><span id="l3.1418" class="difflineplus">+      let delPref = this.prefs[selections[i]];</span>
<a href="#l3.1419"></a><span id="l3.1419" class="difflineplus">+      this.prefs.splice(selections[i], 1);</span>
<a href="#l3.1420"></a><span id="l3.1420" class="difflineplus">+      this.tree.treeBoxObject.rowCountChanged(selections[i], -1);</span>
<a href="#l3.1421"></a><span id="l3.1421" class="difflineplus">+      Services.contentPrefs.removePref(delPref.host, delPref.name);</span>
<a href="#l3.1422"></a><span id="l3.1422" class="difflineplus">+    }</span>
<a href="#l3.1423"></a><span id="l3.1423" class="difflineplus">+    if (!this.prefs.length)</span>
<a href="#l3.1424"></a><span id="l3.1424" class="difflineplus">+      gDomains.removeDomainOrFlag(gDomains.selectedDomain.title, &quot;hasPreferences&quot;);</span>
<a href="#l3.1425"></a><span id="l3.1425" class="difflineplus">+  },</span>
<a href="#l3.1426"></a><span id="l3.1426" class="difflineplus">+</span>
<a href="#l3.1427"></a><span id="l3.1427" class="difflineplus">+  updateContext: function prefs_updateContext() {</span>
<a href="#l3.1428"></a><span id="l3.1428" class="difflineplus">+    document.getElementById(&quot;prefs-context-remove&quot;).disabled =</span>
<a href="#l3.1429"></a><span id="l3.1429" class="difflineplus">+      this.removeButton.disabled;</span>
<a href="#l3.1430"></a><span id="l3.1430" class="difflineplus">+    document.getElementById(&quot;prefs-context-selectall&quot;).disabled =</span>
<a href="#l3.1431"></a><span id="l3.1431" class="difflineplus">+      this.tree.view.selection.count &gt;= this.tree.view.rowCount;</span>
<a href="#l3.1432"></a><span id="l3.1432" class="difflineplus">+  },</span>
<a href="#l3.1433"></a><span id="l3.1433" class="difflineplus">+</span>
<a href="#l3.1434"></a><span id="l3.1434" class="difflineplus">+  reactToChange: function prefs_reactToChange(aSubject, aData) {</span>
<a href="#l3.1435"></a><span id="l3.1435" class="difflineplus">+    // aData: prefSet, prefRemoved</span>
<a href="#l3.1436"></a><span id="l3.1436" class="difflineplus">+</span>
<a href="#l3.1437"></a><span id="l3.1437" class="difflineplus">+    // Do &quot;surgical&quot; updates.</span>
<a href="#l3.1438"></a><span id="l3.1438" class="difflineplus">+    let domain = gDomains.getDomainFromHost(aSubject.host);</span>
<a href="#l3.1439"></a><span id="l3.1439" class="difflineplus">+    // Does change affect possibly loaded Preferences pane?</span>
<a href="#l3.1440"></a><span id="l3.1440" class="difflineplus">+    let affectsLoaded = this.prefs.length &amp;&amp;</span>
<a href="#l3.1441"></a><span id="l3.1441" class="difflineplus">+                        gDomains.hostMatchesSelected(aSubject.host);</span>
<a href="#l3.1442"></a><span id="l3.1442" class="difflineplus">+    let idx = -1, domainPrefs = 0;</span>
<a href="#l3.1443"></a><span id="l3.1443" class="difflineplus">+    if (affectsLoaded) {</span>
<a href="#l3.1444"></a><span id="l3.1444" class="difflineplus">+      for (let i = 0; i &lt; this.prefs.length; i++) {</span>
<a href="#l3.1445"></a><span id="l3.1445" class="difflineplus">+        let cpref = this.prefs[i];</span>
<a href="#l3.1446"></a><span id="l3.1446" class="difflineplus">+        if (cpref &amp;&amp; cpref.host == aSubject.host &amp;&amp; cpref.name == aSubject.name) {</span>
<a href="#l3.1447"></a><span id="l3.1447" class="difflineplus">+          idx = this.prefs[i];</span>
<a href="#l3.1448"></a><span id="l3.1448" class="difflineplus">+          break;</span>
<a href="#l3.1449"></a><span id="l3.1449" class="difflineplus">+        }</span>
<a href="#l3.1450"></a><span id="l3.1450" class="difflineplus">+      }</span>
<a href="#l3.1451"></a><span id="l3.1451" class="difflineplus">+      if (aData == &quot;prefRemoved&quot;)</span>
<a href="#l3.1452"></a><span id="l3.1452" class="difflineplus">+        domainPrefs = this.prefs.length;</span>
<a href="#l3.1453"></a><span id="l3.1453" class="difflineplus">+    }</span>
<a href="#l3.1454"></a><span id="l3.1454" class="difflineplus">+    else if (aData == &quot;prefRemoved&quot;) {</span>
<a href="#l3.1455"></a><span id="l3.1455" class="difflineplus">+      // See if there are any prefs left for that domain.</span>
<a href="#l3.1456"></a><span id="l3.1456" class="difflineplus">+      if (domain == &quot;*&quot;) {</span>
<a href="#l3.1457"></a><span id="l3.1457" class="difflineplus">+        let enumerator = Services.contentPrefs.getPrefs(null).enumerator;</span>
<a href="#l3.1458"></a><span id="l3.1458" class="difflineplus">+        if (enumerator.hasMoreElements())</span>
<a href="#l3.1459"></a><span id="l3.1459" class="difflineplus">+          domainPrefs++;</span>
<a href="#l3.1460"></a><span id="l3.1460" class="difflineplus">+      }</span>
<a href="#l3.1461"></a><span id="l3.1461" class="difflineplus">+      else {</span>
<a href="#l3.1462"></a><span id="l3.1462" class="difflineplus">+        try {</span>
<a href="#l3.1463"></a><span id="l3.1463" class="difflineplus">+          let sql = &quot;SELECT groups.name AS host FROM groups WHERE host = :hostName OR host LIKE :hostMatch ESCAPE '/'&quot;;</span>
<a href="#l3.1464"></a><span id="l3.1464" class="difflineplus">+          var statement = Services.contentPrefs.DBConnection.createStatement(sql);</span>
<a href="#l3.1465"></a><span id="l3.1465" class="difflineplus">+          statement.params.hostName = domain;</span>
<a href="#l3.1466"></a><span id="l3.1466" class="difflineplus">+          statement.params.hostMatch = &quot;%.&quot; + statement.escapeStringForLIKE(domain, &quot;/&quot;);</span>
<a href="#l3.1467"></a><span id="l3.1467" class="difflineplus">+          while (statement.executeStep()) {</span>
<a href="#l3.1468"></a><span id="l3.1468" class="difflineplus">+            // Now, get all prefs for that host.</span>
<a href="#l3.1469"></a><span id="l3.1469" class="difflineplus">+            let enumerator = Services.contentPrefs.getPrefs(statement.row[&quot;host&quot;]).enumerator;</span>
<a href="#l3.1470"></a><span id="l3.1470" class="difflineplus">+            if (enumerator.hasMoreElements())</span>
<a href="#l3.1471"></a><span id="l3.1471" class="difflineplus">+              domainPrefs++;</span>
<a href="#l3.1472"></a><span id="l3.1472" class="difflineplus">+          }</span>
<a href="#l3.1473"></a><span id="l3.1473" class="difflineplus">+        }</span>
<a href="#l3.1474"></a><span id="l3.1474" class="difflineplus">+        finally {</span>
<a href="#l3.1475"></a><span id="l3.1475" class="difflineplus">+          statement.reset();</span>
<a href="#l3.1476"></a><span id="l3.1476" class="difflineplus">+        }</span>
<a href="#l3.1477"></a><span id="l3.1477" class="difflineplus">+      }</span>
<a href="#l3.1478"></a><span id="l3.1478" class="difflineplus">+      if (!domainPrefs)</span>
<a href="#l3.1479"></a><span id="l3.1479" class="difflineplus">+        gDomains.removeDomainOrFlag(domain, &quot;hasPreferences&quot;);</span>
<a href="#l3.1480"></a><span id="l3.1480" class="difflineplus">+    }</span>
<a href="#l3.1481"></a><span id="l3.1481" class="difflineplus">+    if (idx &gt;= 0) {</span>
<a href="#l3.1482"></a><span id="l3.1482" class="difflineplus">+      if (aData == &quot;prefSet&quot;) {</span>
<a href="#l3.1483"></a><span id="l3.1483" class="difflineplus">+        this.prefs[idx] = aSubject;</span>
<a href="#l3.1484"></a><span id="l3.1484" class="difflineplus">+        if (affectsLoaded)</span>
<a href="#l3.1485"></a><span id="l3.1485" class="difflineplus">+          this.tree.treeBoxObject.invalidateRow(disp_idx);</span>
<a href="#l3.1486"></a><span id="l3.1486" class="difflineplus">+      }</span>
<a href="#l3.1487"></a><span id="l3.1487" class="difflineplus">+      else if (aData == &quot;prefRemoved&quot;) {</span>
<a href="#l3.1488"></a><span id="l3.1488" class="difflineplus">+        this.prefs.splice(idx, 1);</span>
<a href="#l3.1489"></a><span id="l3.1489" class="difflineplus">+        if (affectsLoaded) {</span>
<a href="#l3.1490"></a><span id="l3.1490" class="difflineplus">+          this.tree.treeBoxObject.rowCountChanged(idx, -1);</span>
<a href="#l3.1491"></a><span id="l3.1491" class="difflineplus">+        }</span>
<a href="#l3.1492"></a><span id="l3.1492" class="difflineplus">+        if (domainPrefs == 1)</span>
<a href="#l3.1493"></a><span id="l3.1493" class="difflineplus">+          gDomains.removeDomainOrFlag(domain, &quot;hasPreferences&quot;);</span>
<a href="#l3.1494"></a><span id="l3.1494" class="difflineplus">+      }</span>
<a href="#l3.1495"></a><span id="l3.1495" class="difflineplus">+    }</span>
<a href="#l3.1496"></a><span id="l3.1496" class="difflineplus">+    else if (aData == &quot;prefSet&quot;) {</span>
<a href="#l3.1497"></a><span id="l3.1497" class="difflineplus">+      // Pref set, no prev index known - either new or existing pref domain.</span>
<a href="#l3.1498"></a><span id="l3.1498" class="difflineplus">+      if (affectsLoaded) {</span>
<a href="#l3.1499"></a><span id="l3.1499" class="difflineplus">+        this.prefs.push(aSubject);</span>
<a href="#l3.1500"></a><span id="l3.1500" class="difflineplus">+        this.tree.treeBoxObject.rowCountChanged(this.prefs.length - 1, 1);</span>
<a href="#l3.1501"></a><span id="l3.1501" class="difflineplus">+        this.sort(null, true, false);</span>
<a href="#l3.1502"></a><span id="l3.1502" class="difflineplus">+      }</span>
<a href="#l3.1503"></a><span id="l3.1503" class="difflineplus">+      else {</span>
<a href="#l3.1504"></a><span id="l3.1504" class="difflineplus">+        gDomains.addDomainOrFlag(aSubject.host, &quot;hasPreferences&quot;);</span>
<a href="#l3.1505"></a><span id="l3.1505" class="difflineplus">+      }</span>
<a href="#l3.1506"></a><span id="l3.1506" class="difflineplus">+    }</span>
<a href="#l3.1507"></a><span id="l3.1507" class="difflineplus">+  },</span>
<a href="#l3.1508"></a><span id="l3.1508" class="difflineplus">+</span>
<a href="#l3.1509"></a><span id="l3.1509" class="difflineplus">+  forget: function prefs_forget() {</span>
<a href="#l3.1510"></a><span id="l3.1510" class="difflineplus">+    let delPrefs = [];</span>
<a href="#l3.1511"></a><span id="l3.1511" class="difflineplus">+    try {</span>
<a href="#l3.1512"></a><span id="l3.1512" class="difflineplus">+      // Get all groups (hosts) that match the domain.</span>
<a href="#l3.1513"></a><span id="l3.1513" class="difflineplus">+      let domain = gDomains.selectedDomain.title;</span>
<a href="#l3.1514"></a><span id="l3.1514" class="difflineplus">+      if (domain == &quot;*&quot;) {</span>
<a href="#l3.1515"></a><span id="l3.1515" class="difflineplus">+        let enumerator =  Services.contentPrefs.getPrefs(null).enumerator;</span>
<a href="#l3.1516"></a><span id="l3.1516" class="difflineplus">+        while (enumerator.hasMoreElements()) {</span>
<a href="#l3.1517"></a><span id="l3.1517" class="difflineplus">+          let pref = enumerator.getNext().QueryInterface(Components.interfaces.nsIProperty);</span>
<a href="#l3.1518"></a><span id="l3.1518" class="difflineplus">+          delPrefs.push({host: null, name: pref.name, value: pref.value});</span>
<a href="#l3.1519"></a><span id="l3.1519" class="difflineplus">+        }</span>
<a href="#l3.1520"></a><span id="l3.1520" class="difflineplus">+      }</span>
<a href="#l3.1521"></a><span id="l3.1521" class="difflineplus">+      else {</span>
<a href="#l3.1522"></a><span id="l3.1522" class="difflineplus">+        let sql = &quot;SELECT groups.name AS host FROM groups WHERE host = :hostName OR host LIKE :hostMatch ESCAPE '/'&quot;;</span>
<a href="#l3.1523"></a><span id="l3.1523" class="difflineplus">+        var statement = Services.contentPrefs.DBConnection.createStatement(sql);</span>
<a href="#l3.1524"></a><span id="l3.1524" class="difflineplus">+        statement.params.hostName = domain;</span>
<a href="#l3.1525"></a><span id="l3.1525" class="difflineplus">+        statement.params.hostMatch = &quot;%.&quot; + statement.escapeStringForLIKE(domain, &quot;/&quot;);</span>
<a href="#l3.1526"></a><span id="l3.1526" class="difflineplus">+        while (statement.executeStep()) {</span>
<a href="#l3.1527"></a><span id="l3.1527" class="difflineplus">+          // Now, get all prefs for that host.</span>
<a href="#l3.1528"></a><span id="l3.1528" class="difflineplus">+          let enumerator =  Services.contentPrefs.getPrefs(statement.row[&quot;host&quot;]).enumerator;</span>
<a href="#l3.1529"></a><span id="l3.1529" class="difflineplus">+          while (enumerator.hasMoreElements()) {</span>
<a href="#l3.1530"></a><span id="l3.1530" class="difflineplus">+            let pref = enumerator.getNext().QueryInterface(Components.interfaces.nsIProperty);</span>
<a href="#l3.1531"></a><span id="l3.1531" class="difflineplus">+            delPrefs.push({host: statement.row[&quot;host&quot;], name: pref.name, value: pref.value});</span>
<a href="#l3.1532"></a><span id="l3.1532" class="difflineplus">+          }</span>
<a href="#l3.1533"></a><span id="l3.1533" class="difflineplus">+        }</span>
<a href="#l3.1534"></a><span id="l3.1534" class="difflineplus">+      }</span>
<a href="#l3.1535"></a><span id="l3.1535" class="difflineplus">+    }</span>
<a href="#l3.1536"></a><span id="l3.1536" class="difflineplus">+    finally {</span>
<a href="#l3.1537"></a><span id="l3.1537" class="difflineplus">+      statement.reset();</span>
<a href="#l3.1538"></a><span id="l3.1538" class="difflineplus">+    }</span>
<a href="#l3.1539"></a><span id="l3.1539" class="difflineplus">+    for (let i = 0; i &lt; delPrefs.length; i++) {</span>
<a href="#l3.1540"></a><span id="l3.1540" class="difflineplus">+      Services.contentPrefs.removePref(delPrefs[i].host, delPrefs[i].name);</span>
<a href="#l3.1541"></a><span id="l3.1541" class="difflineplus">+    }</span>
<a href="#l3.1542"></a><span id="l3.1542" class="difflineplus">+    gDomains.removeDomainOrFlag(gDomains.selectedDomain.title, &quot;hasPreferences&quot;);</span>
<a href="#l3.1543"></a><span id="l3.1543" class="difflineplus">+  },</span>
<a href="#l3.1544"></a><span id="l3.1544" class="difflineplus">+</span>
<a href="#l3.1545"></a><span id="l3.1545" class="difflineplus">+  // nsITreeView</span>
<a href="#l3.1546"></a><span id="l3.1546" class="difflineplus">+  __proto__: gBaseTreeView,</span>
<a href="#l3.1547"></a><span id="l3.1547" class="difflineplus">+  get rowCount() {</span>
<a href="#l3.1548"></a><span id="l3.1548" class="difflineplus">+    return this.prefs.length;</span>
<a href="#l3.1549"></a><span id="l3.1549" class="difflineplus">+  },</span>
<a href="#l3.1550"></a><span id="l3.1550" class="difflineplus">+  getCellText: function(aRow, aColumn) {</span>
<a href="#l3.1551"></a><span id="l3.1551" class="difflineplus">+    let cpref = this.prefs[aRow];</span>
<a href="#l3.1552"></a><span id="l3.1552" class="difflineplus">+    switch (aColumn.id) {</span>
<a href="#l3.1553"></a><span id="l3.1553" class="difflineplus">+      case &quot;prefsHostCol&quot;:</span>
<a href="#l3.1554"></a><span id="l3.1554" class="difflineplus">+        return cpref.host || &quot;*&quot;;</span>
<a href="#l3.1555"></a><span id="l3.1555" class="difflineplus">+      case &quot;prefsNameCol&quot;:</span>
<a href="#l3.1556"></a><span id="l3.1556" class="difflineplus">+        return cpref.name;</span>
<a href="#l3.1557"></a><span id="l3.1557" class="difflineplus">+      case &quot;prefsValueCol&quot;:</span>
<a href="#l3.1558"></a><span id="l3.1558" class="difflineplus">+        return cpref.value;</span>
<a href="#l3.1559"></a><span id="l3.1559" class="difflineplus">+    }</span>
<a href="#l3.1560"></a><span id="l3.1560" class="difflineplus">+  },</span>
<a href="#l3.1561"></a><span id="l3.1561" class="difflineplus">+};</span>
<a href="#l3.1562"></a><span id="l3.1562" class="difflineplus">+</span>
<a href="#l3.1563"></a><span id="l3.1563" class="difflineplus">+// :::::::::::::::::::: passwords panel ::::::::::::::::::::</span>
<a href="#l3.1564"></a><span id="l3.1564" class="difflineplus">+var gPasswords = {</span>
<a href="#l3.1565"></a><span id="l3.1565" class="difflineplus">+  tree: null,</span>
<a href="#l3.1566"></a><span id="l3.1566" class="difflineplus">+  removeButton: null,</span>
<a href="#l3.1567"></a><span id="l3.1567" class="difflineplus">+  toggleButton: null,</span>
<a href="#l3.1568"></a><span id="l3.1568" class="difflineplus">+  pwdCol: null,</span>
<a href="#l3.1569"></a><span id="l3.1569" class="difflineplus">+</span>
<a href="#l3.1570"></a><span id="l3.1570" class="difflineplus">+  allSignons: [],</span>
<a href="#l3.1571"></a><span id="l3.1571" class="difflineplus">+  displayedSignons: [],</span>
<a href="#l3.1572"></a><span id="l3.1572" class="difflineplus">+  showPasswords: false,</span>
<a href="#l3.1573"></a><span id="l3.1573" class="difflineplus">+</span>
<a href="#l3.1574"></a><span id="l3.1574" class="difflineplus">+  initialize: function passwords_initialize() {</span>
<a href="#l3.1575"></a><span id="l3.1575" class="difflineplus">+    gDataman.debugMsg(&quot;Initializing passwords panel&quot;);</span>
<a href="#l3.1576"></a><span id="l3.1576" class="difflineplus">+    this.tree = document.getElementById(&quot;passwordsTree&quot;);</span>
<a href="#l3.1577"></a><span id="l3.1577" class="difflineplus">+    this.tree.view = this;</span>
<a href="#l3.1578"></a><span id="l3.1578" class="difflineplus">+</span>
<a href="#l3.1579"></a><span id="l3.1579" class="difflineplus">+    this.removeButton = document.getElementById(&quot;pwdRemove&quot;);</span>
<a href="#l3.1580"></a><span id="l3.1580" class="difflineplus">+    this.toggleButton = document.getElementById(&quot;pwdToggle&quot;);</span>
<a href="#l3.1581"></a><span id="l3.1581" class="difflineplus">+    this.toggleButton.label = gDataman.bundle.getString(&quot;pwd.showPasswords&quot;);</span>
<a href="#l3.1582"></a><span id="l3.1582" class="difflineplus">+    this.toggleButton.accessKey = gDataman.bundle.getString(&quot;pwd.showPasswords.accesskey&quot;);</span>
<a href="#l3.1583"></a><span id="l3.1583" class="difflineplus">+</span>
<a href="#l3.1584"></a><span id="l3.1584" class="difflineplus">+    this.pwdCol = document.getElementById(&quot;pwdPasswordCol&quot;);</span>
<a href="#l3.1585"></a><span id="l3.1585" class="difflineplus">+</span>
<a href="#l3.1586"></a><span id="l3.1586" class="difflineplus">+    this.tree.treeBoxObject.beginUpdateBatch();</span>
<a href="#l3.1587"></a><span id="l3.1587" class="difflineplus">+    // this.loadList() is being called in gDomains.initialize() already</span>
<a href="#l3.1588"></a><span id="l3.1588" class="difflineplus">+    this.displayedSignons = this.allSignons.filter(</span>
<a href="#l3.1589"></a><span id="l3.1589" class="difflineplus">+      function (aSignon) {</span>
<a href="#l3.1590"></a><span id="l3.1590" class="difflineplus">+        return gDomains.hostMatchesSelected(aSignon.hostname);</span>
<a href="#l3.1591"></a><span id="l3.1591" class="difflineplus">+      });</span>
<a href="#l3.1592"></a><span id="l3.1592" class="difflineplus">+    this.sort(null, false, false);</span>
<a href="#l3.1593"></a><span id="l3.1593" class="difflineplus">+    this.tree.treeBoxObject.endUpdateBatch();</span>
<a href="#l3.1594"></a><span id="l3.1594" class="difflineplus">+  },</span>
<a href="#l3.1595"></a><span id="l3.1595" class="difflineplus">+</span>
<a href="#l3.1596"></a><span id="l3.1596" class="difflineplus">+  shutdown: function passwords_shutdown() {</span>
<a href="#l3.1597"></a><span id="l3.1597" class="difflineplus">+    gDataman.debugMsg(&quot;Shutting down passwords panel&quot;);</span>
<a href="#l3.1598"></a><span id="l3.1598" class="difflineplus">+    if (this.showPasswords)</span>
<a href="#l3.1599"></a><span id="l3.1599" class="difflineplus">+      this.togglePasswordVisible();</span>
<a href="#l3.1600"></a><span id="l3.1600" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.1601"></a><span id="l3.1601" class="difflineplus">+    this.tree.view = null;</span>
<a href="#l3.1602"></a><span id="l3.1602" class="difflineplus">+    this.displayedSignons = [];</span>
<a href="#l3.1603"></a><span id="l3.1603" class="difflineplus">+  },</span>
<a href="#l3.1604"></a><span id="l3.1604" class="difflineplus">+</span>
<a href="#l3.1605"></a><span id="l3.1605" class="difflineplus">+  loadList: function passwords_loadList() {</span>
<a href="#l3.1606"></a><span id="l3.1606" class="difflineplus">+    this.allSignons = gLocSvc.pwd.getAllLogins();</span>
<a href="#l3.1607"></a><span id="l3.1607" class="difflineplus">+  },</span>
<a href="#l3.1608"></a><span id="l3.1608" class="difflineplus">+</span>
<a href="#l3.1609"></a><span id="l3.1609" class="difflineplus">+  _getObjID: function passwords__getObjID(aIdx) {</span>
<a href="#l3.1610"></a><span id="l3.1610" class="difflineplus">+    var curSignon = gPasswords.displayedSignons[aIdx];</span>
<a href="#l3.1611"></a><span id="l3.1611" class="difflineplus">+    return curSignon.hostname + &quot;|&quot; + curSignon.httpRealm + &quot;|&quot; + curSignon.username;</span>
<a href="#l3.1612"></a><span id="l3.1612" class="difflineplus">+  },</span>
<a href="#l3.1613"></a><span id="l3.1613" class="difflineplus">+</span>
<a href="#l3.1614"></a><span id="l3.1614" class="difflineplus">+  select: function passwords_select() {</span>
<a href="#l3.1615"></a><span id="l3.1615" class="difflineplus">+    var selections = gDataman.getTreeSelections(this.tree);</span>
<a href="#l3.1616"></a><span id="l3.1616" class="difflineplus">+    this.removeButton.disabled = !selections.length;</span>
<a href="#l3.1617"></a><span id="l3.1617" class="difflineplus">+    return true;</span>
<a href="#l3.1618"></a><span id="l3.1618" class="difflineplus">+  },</span>
<a href="#l3.1619"></a><span id="l3.1619" class="difflineplus">+</span>
<a href="#l3.1620"></a><span id="l3.1620" class="difflineplus">+  selectAll: function passwords_selectAll() {</span>
<a href="#l3.1621"></a><span id="l3.1621" class="difflineplus">+    this.tree.view.selection.selectAll();</span>
<a href="#l3.1622"></a><span id="l3.1622" class="difflineplus">+  },</span>
<a href="#l3.1623"></a><span id="l3.1623" class="difflineplus">+</span>
<a href="#l3.1624"></a><span id="l3.1624" class="difflineplus">+  handleKeyPress: function passwords_handleKeyPress(aEvent) {</span>
<a href="#l3.1625"></a><span id="l3.1625" class="difflineplus">+    if (aEvent.keyCode == KeyEvent.DOM_VK_DELETE) {</span>
<a href="#l3.1626"></a><span id="l3.1626" class="difflineplus">+      this.delete();</span>
<a href="#l3.1627"></a><span id="l3.1627" class="difflineplus">+    }</span>
<a href="#l3.1628"></a><span id="l3.1628" class="difflineplus">+  },</span>
<a href="#l3.1629"></a><span id="l3.1629" class="difflineplus">+</span>
<a href="#l3.1630"></a><span id="l3.1630" class="difflineplus">+  sort: function passwords_sort(aColumn, aUpdateSelection, aInvertDirection) {</span>
<a href="#l3.1631"></a><span id="l3.1631" class="difflineplus">+    // Make sure we have a valid column.</span>
<a href="#l3.1632"></a><span id="l3.1632" class="difflineplus">+    let column = aColumn;</span>
<a href="#l3.1633"></a><span id="l3.1633" class="difflineplus">+    if (!column) {</span>
<a href="#l3.1634"></a><span id="l3.1634" class="difflineplus">+      let sortedCol = this.tree.columns.getSortedColumn();</span>
<a href="#l3.1635"></a><span id="l3.1635" class="difflineplus">+      if (sortedCol)</span>
<a href="#l3.1636"></a><span id="l3.1636" class="difflineplus">+        column = sortedCol.element;</span>
<a href="#l3.1637"></a><span id="l3.1637" class="difflineplus">+      else</span>
<a href="#l3.1638"></a><span id="l3.1638" class="difflineplus">+        column = document.getElementById(&quot;pwdHostCol&quot;);</span>
<a href="#l3.1639"></a><span id="l3.1639" class="difflineplus">+    }</span>
<a href="#l3.1640"></a><span id="l3.1640" class="difflineplus">+    else if (column.localName == &quot;treecols&quot; || column.localName == &quot;splitter&quot;)</span>
<a href="#l3.1641"></a><span id="l3.1641" class="difflineplus">+      return;</span>
<a href="#l3.1642"></a><span id="l3.1642" class="difflineplus">+</span>
<a href="#l3.1643"></a><span id="l3.1643" class="difflineplus">+    if (!column || column.localName != &quot;treecol&quot;) {</span>
<a href="#l3.1644"></a><span id="l3.1644" class="difflineplus">+      Components.utils.reportError(&quot;No column found to sort form data by&quot;);</span>
<a href="#l3.1645"></a><span id="l3.1645" class="difflineplus">+      return;</span>
<a href="#l3.1646"></a><span id="l3.1646" class="difflineplus">+    }</span>
<a href="#l3.1647"></a><span id="l3.1647" class="difflineplus">+</span>
<a href="#l3.1648"></a><span id="l3.1648" class="difflineplus">+    let dirAscending = column.getAttribute(&quot;sortDirection&quot;) !=</span>
<a href="#l3.1649"></a><span id="l3.1649" class="difflineplus">+                       (aInvertDirection ? &quot;ascending&quot; : &quot;descending&quot;);</span>
<a href="#l3.1650"></a><span id="l3.1650" class="difflineplus">+    let dirFactor = dirAscending ? 1 : -1;</span>
<a href="#l3.1651"></a><span id="l3.1651" class="difflineplus">+</span>
<a href="#l3.1652"></a><span id="l3.1652" class="difflineplus">+    // Clear attributes on all columns, we're setting them again after sorting.</span>
<a href="#l3.1653"></a><span id="l3.1653" class="difflineplus">+    for (let node = column.parentNode.firstChild; node; node = node.nextSibling) {</span>
<a href="#l3.1654"></a><span id="l3.1654" class="difflineplus">+      node.removeAttribute(&quot;sortActive&quot;);</span>
<a href="#l3.1655"></a><span id="l3.1655" class="difflineplus">+      node.removeAttribute(&quot;sortDirection&quot;);</span>
<a href="#l3.1656"></a><span id="l3.1656" class="difflineplus">+    }</span>
<a href="#l3.1657"></a><span id="l3.1657" class="difflineplus">+</span>
<a href="#l3.1658"></a><span id="l3.1658" class="difflineplus">+    // compare function for two signons</span>
<a href="#l3.1659"></a><span id="l3.1659" class="difflineplus">+    let compfunc = function passwords_sort_compare(aOne, aTwo) {</span>
<a href="#l3.1660"></a><span id="l3.1660" class="difflineplus">+      switch (column.id) {</span>
<a href="#l3.1661"></a><span id="l3.1661" class="difflineplus">+        case &quot;pwdHostCol&quot;:</span>
<a href="#l3.1662"></a><span id="l3.1662" class="difflineplus">+          return dirFactor * aOne.hostname.localeCompare(aTwo.hostname);</span>
<a href="#l3.1663"></a><span id="l3.1663" class="difflineplus">+        case &quot;pwdUserCol&quot;:</span>
<a href="#l3.1664"></a><span id="l3.1664" class="difflineplus">+          return dirFactor * aOne.username.localeCompare(aTwo.username);</span>
<a href="#l3.1665"></a><span id="l3.1665" class="difflineplus">+        case &quot;pwdPasswordCol&quot;:</span>
<a href="#l3.1666"></a><span id="l3.1666" class="difflineplus">+          return dirFactor * aOne.password.localeCompare(aTwo.password);</span>
<a href="#l3.1667"></a><span id="l3.1667" class="difflineplus">+      }</span>
<a href="#l3.1668"></a><span id="l3.1668" class="difflineplus">+      return 0;</span>
<a href="#l3.1669"></a><span id="l3.1669" class="difflineplus">+    };</span>
<a href="#l3.1670"></a><span id="l3.1670" class="difflineplus">+</span>
<a href="#l3.1671"></a><span id="l3.1671" class="difflineplus">+    if (aUpdateSelection) {</span>
<a href="#l3.1672"></a><span id="l3.1672" class="difflineplus">+      var selectionCache = gDataman.getSelectedIDs(this.tree, this._getObjID);</span>
<a href="#l3.1673"></a><span id="l3.1673" class="difflineplus">+    }</span>
<a href="#l3.1674"></a><span id="l3.1674" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.1675"></a><span id="l3.1675" class="difflineplus">+</span>
<a href="#l3.1676"></a><span id="l3.1676" class="difflineplus">+    // Do the actual sorting of the array.</span>
<a href="#l3.1677"></a><span id="l3.1677" class="difflineplus">+    this.displayedSignons.sort(compfunc);</span>
<a href="#l3.1678"></a><span id="l3.1678" class="difflineplus">+    this.tree.treeBoxObject.invalidate();</span>
<a href="#l3.1679"></a><span id="l3.1679" class="difflineplus">+</span>
<a href="#l3.1680"></a><span id="l3.1680" class="difflineplus">+    if (aUpdateSelection) {</span>
<a href="#l3.1681"></a><span id="l3.1681" class="difflineplus">+      gDataman.restoreSelectionFromIDs(this.tree, this._getObjID, selectionCache);</span>
<a href="#l3.1682"></a><span id="l3.1682" class="difflineplus">+    }</span>
<a href="#l3.1683"></a><span id="l3.1683" class="difflineplus">+</span>
<a href="#l3.1684"></a><span id="l3.1684" class="difflineplus">+    // Set attributes to the sorting we did.</span>
<a href="#l3.1685"></a><span id="l3.1685" class="difflineplus">+    column.setAttribute(&quot;sortActive&quot;, &quot;true&quot;);</span>
<a href="#l3.1686"></a><span id="l3.1686" class="difflineplus">+    column.setAttribute(&quot;sortDirection&quot;, dirAscending ? &quot;ascending&quot; : &quot;descending&quot;);</span>
<a href="#l3.1687"></a><span id="l3.1687" class="difflineplus">+  },</span>
<a href="#l3.1688"></a><span id="l3.1688" class="difflineplus">+</span>
<a href="#l3.1689"></a><span id="l3.1689" class="difflineplus">+  delete: function passwords_delete() {</span>
<a href="#l3.1690"></a><span id="l3.1690" class="difflineplus">+    var selections = gDataman.getTreeSelections(this.tree);</span>
<a href="#l3.1691"></a><span id="l3.1691" class="difflineplus">+</span>
<a href="#l3.1692"></a><span id="l3.1692" class="difflineplus">+    if (selections.length &gt; 1) {</span>
<a href="#l3.1693"></a><span id="l3.1693" class="difflineplus">+      let title = gDataman.bundle.getString(&quot;pwd.deleteSelectedTitle&quot;);</span>
<a href="#l3.1694"></a><span id="l3.1694" class="difflineplus">+      let msg = gDataman.bundle.getString(&quot;pwd.deleteSelected&quot;);</span>
<a href="#l3.1695"></a><span id="l3.1695" class="difflineplus">+      let flags = ((Services.prompt.BUTTON_TITLE_IS_STRING * Services.prompt.BUTTON_POS_0) +</span>
<a href="#l3.1696"></a><span id="l3.1696" class="difflineplus">+                   (Services.prompt.BUTTON_TITLE_CANCEL * Services.prompt.BUTTON_POS_1) +</span>
<a href="#l3.1697"></a><span id="l3.1697" class="difflineplus">+                   Services.prompt.BUTTON_POS_1_DEFAULT)</span>
<a href="#l3.1698"></a><span id="l3.1698" class="difflineplus">+      let yes = gDataman.bundle.getString(&quot;pwd.deleteSelectedYes&quot;);</span>
<a href="#l3.1699"></a><span id="l3.1699" class="difflineplus">+      if (Services.prompt.confirmEx(window, title, msg, flags, yes, null, null,</span>
<a href="#l3.1700"></a><span id="l3.1700" class="difflineplus">+                                    null, {value: 0}) == 1) // 1==&quot;Cancel&quot; button</span>
<a href="#l3.1701"></a><span id="l3.1701" class="difflineplus">+        return;</span>
<a href="#l3.1702"></a><span id="l3.1702" class="difflineplus">+    }</span>
<a href="#l3.1703"></a><span id="l3.1703" class="difflineplus">+</span>
<a href="#l3.1704"></a><span id="l3.1704" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.1705"></a><span id="l3.1705" class="difflineplus">+    // Loop backwards so later indexes in the list don't change.</span>
<a href="#l3.1706"></a><span id="l3.1706" class="difflineplus">+    for (let i = selections.length - 1; i &gt;= 0; i--) {</span>
<a href="#l3.1707"></a><span id="l3.1707" class="difflineplus">+      let delSignon = this.displayedSignons[selections[i]];</span>
<a href="#l3.1708"></a><span id="l3.1708" class="difflineplus">+      this.allSignons.splice(this.allSignons.indexOf(this.displayedSignons[selections[i]]), 1);</span>
<a href="#l3.1709"></a><span id="l3.1709" class="difflineplus">+      this.displayedSignons.splice(selections[i], 1);</span>
<a href="#l3.1710"></a><span id="l3.1710" class="difflineplus">+      this.tree.treeBoxObject.rowCountChanged(selections[i], -1);</span>
<a href="#l3.1711"></a><span id="l3.1711" class="difflineplus">+      gLocSvc.pwd.removeLogin(delSignon);</span>
<a href="#l3.1712"></a><span id="l3.1712" class="difflineplus">+    }</span>
<a href="#l3.1713"></a><span id="l3.1713" class="difflineplus">+    if (!this.displayedSignons.length)</span>
<a href="#l3.1714"></a><span id="l3.1714" class="difflineplus">+      gDomains.removeDomainOrFlag(gDomains.selectedDomain.title, &quot;hasPasswords&quot;);</span>
<a href="#l3.1715"></a><span id="l3.1715" class="difflineplus">+  },</span>
<a href="#l3.1716"></a><span id="l3.1716" class="difflineplus">+</span>
<a href="#l3.1717"></a><span id="l3.1717" class="difflineplus">+  togglePasswordVisible: function passwords_togglePasswordVisible() {</span>
<a href="#l3.1718"></a><span id="l3.1718" class="difflineplus">+    if (this.showPasswords || this._confirmShowPasswords()) {</span>
<a href="#l3.1719"></a><span id="l3.1719" class="difflineplus">+      this.showPasswords = !this.showPasswords;</span>
<a href="#l3.1720"></a><span id="l3.1720" class="difflineplus">+      this.toggleButton.label = gDataman.bundle.getString(this.showPasswords ?</span>
<a href="#l3.1721"></a><span id="l3.1721" class="difflineplus">+                                                         &quot;pwd.hidePasswords&quot; :</span>
<a href="#l3.1722"></a><span id="l3.1722" class="difflineplus">+                                                         &quot;pwd.showPasswords&quot;);</span>
<a href="#l3.1723"></a><span id="l3.1723" class="difflineplus">+      this.toggleButton.accessKey = gDataman.bundle.getString(this.showPasswords ?</span>
<a href="#l3.1724"></a><span id="l3.1724" class="difflineplus">+                                                             &quot;pwd.hidePasswords.accesskey&quot; :</span>
<a href="#l3.1725"></a><span id="l3.1725" class="difflineplus">+                                                             &quot;pwd.showPasswords.accesskey&quot;);</span>
<a href="#l3.1726"></a><span id="l3.1726" class="difflineplus">+      this.pwdCol.hidden = !this.showPasswords;</span>
<a href="#l3.1727"></a><span id="l3.1727" class="difflineplus">+    }</span>
<a href="#l3.1728"></a><span id="l3.1728" class="difflineplus">+  },</span>
<a href="#l3.1729"></a><span id="l3.1729" class="difflineplus">+</span>
<a href="#l3.1730"></a><span id="l3.1730" class="difflineplus">+  _confirmShowPasswords: function passwords__confirmShowPasswords() {</span>
<a href="#l3.1731"></a><span id="l3.1731" class="difflineplus">+    // This doesn't harm if passwords are not encrypted.</span>
<a href="#l3.1732"></a><span id="l3.1732" class="difflineplus">+    let tokendb = Components.classes[&quot;@mozilla.org/security/pk11tokendb;1&quot;]</span>
<a href="#l3.1733"></a><span id="l3.1733" class="difflineplus">+                            .createInstance(Components.interfaces.nsIPK11TokenDB);</span>
<a href="#l3.1734"></a><span id="l3.1734" class="difflineplus">+    let token = tokendb.getInternalKeyToken();</span>
<a href="#l3.1735"></a><span id="l3.1735" class="difflineplus">+</span>
<a href="#l3.1736"></a><span id="l3.1736" class="difflineplus">+    // If there is no master password, still give the user a chance to opt-out</span>
<a href="#l3.1737"></a><span id="l3.1737" class="difflineplus">+    // of displaying passwords</span>
<a href="#l3.1738"></a><span id="l3.1738" class="difflineplus">+    if (token.checkPassword(&quot;&quot;))</span>
<a href="#l3.1739"></a><span id="l3.1739" class="difflineplus">+      return this._askUserShowPasswords();</span>
<a href="#l3.1740"></a><span id="l3.1740" class="difflineplus">+</span>
<a href="#l3.1741"></a><span id="l3.1741" class="difflineplus">+    // So there's a master password. But since checkPassword didn't succeed,</span>
<a href="#l3.1742"></a><span id="l3.1742" class="difflineplus">+    // we're logged out (per nsIPK11Token.idl).</span>
<a href="#l3.1743"></a><span id="l3.1743" class="difflineplus">+    try {</span>
<a href="#l3.1744"></a><span id="l3.1744" class="difflineplus">+      // Relogin and ask for the master password.</span>
<a href="#l3.1745"></a><span id="l3.1745" class="difflineplus">+      token.login(true);  // 'true' means always prompt for token password. User</span>
<a href="#l3.1746"></a><span id="l3.1746" class="difflineplus">+                          // will be prompted until clicking 'Cancel' or</span>
<a href="#l3.1747"></a><span id="l3.1747" class="difflineplus">+                          // entering the correct password.</span>
<a href="#l3.1748"></a><span id="l3.1748" class="difflineplus">+    }</span>
<a href="#l3.1749"></a><span id="l3.1749" class="difflineplus">+    catch (e) {</span>
<a href="#l3.1750"></a><span id="l3.1750" class="difflineplus">+      // An exception will be thrown if the user cancels the login prompt dialog.</span>
<a href="#l3.1751"></a><span id="l3.1751" class="difflineplus">+      // User is also logged out of Software Security Device.</span>
<a href="#l3.1752"></a><span id="l3.1752" class="difflineplus">+    }</span>
<a href="#l3.1753"></a><span id="l3.1753" class="difflineplus">+</span>
<a href="#l3.1754"></a><span id="l3.1754" class="difflineplus">+    return token.isLoggedIn();</span>
<a href="#l3.1755"></a><span id="l3.1755" class="difflineplus">+  },</span>
<a href="#l3.1756"></a><span id="l3.1756" class="difflineplus">+</span>
<a href="#l3.1757"></a><span id="l3.1757" class="difflineplus">+  _askUserShowPasswords: function passwords__askUserShowPasswords() {</span>
<a href="#l3.1758"></a><span id="l3.1758" class="difflineplus">+    // Confirm the user wants to display passwords.</span>
<a href="#l3.1759"></a><span id="l3.1759" class="difflineplus">+    return Services.prompt.confirmEx(window, null,</span>
<a href="#l3.1760"></a><span id="l3.1760" class="difflineplus">+                                     gDataman.bundle.getString(&quot;pwd.noMasterPasswordPrompt&quot;),</span>
<a href="#l3.1761"></a><span id="l3.1761" class="difflineplus">+                                     Services.prompt.STD_YES_NO_BUTTONS,</span>
<a href="#l3.1762"></a><span id="l3.1762" class="difflineplus">+                                     null, null, null, null, { value: false }) == 0; // 0==&quot;Yes&quot; button</span>
<a href="#l3.1763"></a><span id="l3.1763" class="difflineplus">+  },</span>
<a href="#l3.1764"></a><span id="l3.1764" class="difflineplus">+</span>
<a href="#l3.1765"></a><span id="l3.1765" class="difflineplus">+  updateContext: function passwords_updateContext() {</span>
<a href="#l3.1766"></a><span id="l3.1766" class="difflineplus">+    document.getElementById(&quot;pwd-context-remove&quot;).disabled =</span>
<a href="#l3.1767"></a><span id="l3.1767" class="difflineplus">+      this.removeButton.disabled;</span>
<a href="#l3.1768"></a><span id="l3.1768" class="difflineplus">+    document.getElementById(&quot;pwd-context-copypassword&quot;).disabled =</span>
<a href="#l3.1769"></a><span id="l3.1769" class="difflineplus">+      this.tree.view.selection.count != 1;</span>
<a href="#l3.1770"></a><span id="l3.1770" class="difflineplus">+    document.getElementById(&quot;pwd-context-selectall&quot;).disabled =</span>
<a href="#l3.1771"></a><span id="l3.1771" class="difflineplus">+      this.tree.view.selection.count &gt;= this.tree.view.rowCount;</span>
<a href="#l3.1772"></a><span id="l3.1772" class="difflineplus">+  },</span>
<a href="#l3.1773"></a><span id="l3.1773" class="difflineplus">+</span>
<a href="#l3.1774"></a><span id="l3.1774" class="difflineplus">+  copyPassword: function passwords_copyPassword() {</span>
<a href="#l3.1775"></a><span id="l3.1775" class="difflineplus">+    // Copy selected signon's password to clipboard.</span>
<a href="#l3.1776"></a><span id="l3.1776" class="difflineplus">+    let row = this.tree.currentIndex;</span>
<a href="#l3.1777"></a><span id="l3.1777" class="difflineplus">+    let password = gPasswords.displayedSignons[row].password;</span>
<a href="#l3.1778"></a><span id="l3.1778" class="difflineplus">+    gLocSvc.clipboard.copyString(password);</span>
<a href="#l3.1779"></a><span id="l3.1779" class="difflineplus">+  },</span>
<a href="#l3.1780"></a><span id="l3.1780" class="difflineplus">+</span>
<a href="#l3.1781"></a><span id="l3.1781" class="difflineplus">+  reactToChange: function passwords_reactToChange(aSubject, aData) {</span>
<a href="#l3.1782"></a><span id="l3.1782" class="difflineplus">+    // aData: addLogin, modifyLogin, removeLogin, removeAllLogins</span>
<a href="#l3.1783"></a><span id="l3.1783" class="difflineplus">+    if (aData == &quot;removeAllLogins&quot;) {</span>
<a href="#l3.1784"></a><span id="l3.1784" class="difflineplus">+      // Go for re-parsing the whole thing.</span>
<a href="#l3.1785"></a><span id="l3.1785" class="difflineplus">+      if (this.displayedSignons.length) {</span>
<a href="#l3.1786"></a><span id="l3.1786" class="difflineplus">+        this.tree.treeBoxObject.beginUpdateBatch();</span>
<a href="#l3.1787"></a><span id="l3.1787" class="difflineplus">+        this.tree.view.selection.clearSelection();</span>
<a href="#l3.1788"></a><span id="l3.1788" class="difflineplus">+        this.displayedSignons = [];</span>
<a href="#l3.1789"></a><span id="l3.1789" class="difflineplus">+        this.tree.treeBoxObject.endUpdateBatch();</span>
<a href="#l3.1790"></a><span id="l3.1790" class="difflineplus">+      }</span>
<a href="#l3.1791"></a><span id="l3.1791" class="difflineplus">+      this.loadList();</span>
<a href="#l3.1792"></a><span id="l3.1792" class="difflineplus">+      let domainList = [];</span>
<a href="#l3.1793"></a><span id="l3.1793" class="difflineplus">+      for (let i = 0; i &lt; this.allSignons.length; i++) {</span>
<a href="#l3.1794"></a><span id="l3.1794" class="difflineplus">+        let domain = gDomains.getDomainFromHost(this.allSignons[i].hostname);</span>
<a href="#l3.1795"></a><span id="l3.1795" class="difflineplus">+        if (domainList.indexOf(domain) == -1)</span>
<a href="#l3.1796"></a><span id="l3.1796" class="difflineplus">+          domainList.push(domain);</span>
<a href="#l3.1797"></a><span id="l3.1797" class="difflineplus">+      }</span>
<a href="#l3.1798"></a><span id="l3.1798" class="difflineplus">+      gDomains.resetFlagToDomains(&quot;hasPasswords&quot;, domainList);</span>
<a href="#l3.1799"></a><span id="l3.1799" class="difflineplus">+      return;</span>
<a href="#l3.1800"></a><span id="l3.1800" class="difflineplus">+    }</span>
<a href="#l3.1801"></a><span id="l3.1801" class="difflineplus">+</span>
<a href="#l3.1802"></a><span id="l3.1802" class="difflineplus">+    // Usual notifications for addLogin, modifyLogin, removeLogin - do &quot;surgical&quot; updates.</span>
<a href="#l3.1803"></a><span id="l3.1803" class="difflineplus">+    let curLogin = null, oldLogin = null;</span>
<a href="#l3.1804"></a><span id="l3.1804" class="difflineplus">+    if (aData == &quot;modifyLogin&quot; &amp;&amp;</span>
<a href="#l3.1805"></a><span id="l3.1805" class="difflineplus">+        aSubject instanceof Components.interfaces.nsIArray) {</span>
<a href="#l3.1806"></a><span id="l3.1806" class="difflineplus">+      let enumerator = aSubject.enumerate();</span>
<a href="#l3.1807"></a><span id="l3.1807" class="difflineplus">+      if (enumerator.hasMoreElements()) {</span>
<a href="#l3.1808"></a><span id="l3.1808" class="difflineplus">+        oldLogin = enumerator.getNext();</span>
<a href="#l3.1809"></a><span id="l3.1809" class="difflineplus">+        oldLogin.QueryInterface(Components.interfaces.nsILoginInfo);</span>
<a href="#l3.1810"></a><span id="l3.1810" class="difflineplus">+      }</span>
<a href="#l3.1811"></a><span id="l3.1811" class="difflineplus">+      if (enumerator.hasMoreElements()) {</span>
<a href="#l3.1812"></a><span id="l3.1812" class="difflineplus">+        curLogin = enumerator.getNext();</span>
<a href="#l3.1813"></a><span id="l3.1813" class="difflineplus">+        curLogin.QueryInterface(Components.interfaces.nsILoginInfo);</span>
<a href="#l3.1814"></a><span id="l3.1814" class="difflineplus">+      }</span>
<a href="#l3.1815"></a><span id="l3.1815" class="difflineplus">+    }</span>
<a href="#l3.1816"></a><span id="l3.1816" class="difflineplus">+    else if (aSubject instanceof Components.interfaces.nsILoginInfo) {</span>
<a href="#l3.1817"></a><span id="l3.1817" class="difflineplus">+      curLogin = aSubject; oldLogin = aSubject;</span>
<a href="#l3.1818"></a><span id="l3.1818" class="difflineplus">+    }</span>
<a href="#l3.1819"></a><span id="l3.1819" class="difflineplus">+    else {</span>
<a href="#l3.1820"></a><span id="l3.1820" class="difflineplus">+      Components.utils.reportError(&quot;Observed an unrecognized signon change of type &quot; + aData);</span>
<a href="#l3.1821"></a><span id="l3.1821" class="difflineplus">+    }</span>
<a href="#l3.1822"></a><span id="l3.1822" class="difflineplus">+</span>
<a href="#l3.1823"></a><span id="l3.1823" class="difflineplus">+    let domain = gDomains.getDomainFromHost(curLogin.hostname);</span>
<a href="#l3.1824"></a><span id="l3.1824" class="difflineplus">+    // Does change affect possibly loaded Passwords pane?</span>
<a href="#l3.1825"></a><span id="l3.1825" class="difflineplus">+    let affectsLoaded = this.displayedSignons.length &amp;&amp;</span>
<a href="#l3.1826"></a><span id="l3.1826" class="difflineplus">+                        gDomains.hostMatchesSelected(curLogin.hostname);</span>
<a href="#l3.1827"></a><span id="l3.1827" class="difflineplus">+    if (aData == &quot;addLogin&quot;) {</span>
<a href="#l3.1828"></a><span id="l3.1828" class="difflineplus">+      this.allSignons.push(curLogin);</span>
<a href="#l3.1829"></a><span id="l3.1829" class="difflineplus">+</span>
<a href="#l3.1830"></a><span id="l3.1830" class="difflineplus">+      if (affectsLoaded) {</span>
<a href="#l3.1831"></a><span id="l3.1831" class="difflineplus">+        this.displayedSignons.push(this.allSignons[this.allSignons.length - 1]);</span>
<a href="#l3.1832"></a><span id="l3.1832" class="difflineplus">+        this.tree.treeBoxObject.rowCountChanged(this.allSignons.length - 1, 1);</span>
<a href="#l3.1833"></a><span id="l3.1833" class="difflineplus">+        this.sort(null, true, false);</span>
<a href="#l3.1834"></a><span id="l3.1834" class="difflineplus">+      }</span>
<a href="#l3.1835"></a><span id="l3.1835" class="difflineplus">+      else {</span>
<a href="#l3.1836"></a><span id="l3.1836" class="difflineplus">+        gDomains.addDomainOrFlag(curLogin.hostname, &quot;hasPasswords&quot;);</span>
<a href="#l3.1837"></a><span id="l3.1837" class="difflineplus">+      }</span>
<a href="#l3.1838"></a><span id="l3.1838" class="difflineplus">+    }</span>
<a href="#l3.1839"></a><span id="l3.1839" class="difflineplus">+    else {</span>
<a href="#l3.1840"></a><span id="l3.1840" class="difflineplus">+      let idx = -1, disp_idx = -1, domainPasswords = 0;</span>
<a href="#l3.1841"></a><span id="l3.1841" class="difflineplus">+      if (affectsLoaded) {</span>
<a href="#l3.1842"></a><span id="l3.1842" class="difflineplus">+        for (let i = 0; i &lt; this.displayedSignons.length; i++) {</span>
<a href="#l3.1843"></a><span id="l3.1843" class="difflineplus">+          let signon = this.displayedSignons[i];</span>
<a href="#l3.1844"></a><span id="l3.1844" class="difflineplus">+          if (signon &amp;&amp; signon.equals(oldLogin)) {</span>
<a href="#l3.1845"></a><span id="l3.1845" class="difflineplus">+            idx = this.allSignons.indexOf(this.displayedSignons[i]);</span>
<a href="#l3.1846"></a><span id="l3.1846" class="difflineplus">+            disp_idx = i;</span>
<a href="#l3.1847"></a><span id="l3.1847" class="difflineplus">+            break;</span>
<a href="#l3.1848"></a><span id="l3.1848" class="difflineplus">+          }</span>
<a href="#l3.1849"></a><span id="l3.1849" class="difflineplus">+        }</span>
<a href="#l3.1850"></a><span id="l3.1850" class="difflineplus">+        if (aData == &quot;removeLogin&quot;)</span>
<a href="#l3.1851"></a><span id="l3.1851" class="difflineplus">+          domainPasswords = this.displayedSignons.length;</span>
<a href="#l3.1852"></a><span id="l3.1852" class="difflineplus">+      }</span>
<a href="#l3.1853"></a><span id="l3.1853" class="difflineplus">+      else {</span>
<a href="#l3.1854"></a><span id="l3.1854" class="difflineplus">+        for (let i = 0; i &lt; this.allSignons.length; i++) {</span>
<a href="#l3.1855"></a><span id="l3.1855" class="difflineplus">+          let signon = this.allSignons[i];</span>
<a href="#l3.1856"></a><span id="l3.1856" class="difflineplus">+          if (signon &amp;&amp; signon.equals(oldLogin)) {</span>
<a href="#l3.1857"></a><span id="l3.1857" class="difflineplus">+            idx = i;</span>
<a href="#l3.1858"></a><span id="l3.1858" class="difflineplus">+            if (aData != &quot;removeLogin&quot;)</span>
<a href="#l3.1859"></a><span id="l3.1859" class="difflineplus">+              break;</span>
<a href="#l3.1860"></a><span id="l3.1860" class="difflineplus">+          }</span>
<a href="#l3.1861"></a><span id="l3.1861" class="difflineplus">+          if (aData == &quot;removeLogin&quot; &amp;&amp;</span>
<a href="#l3.1862"></a><span id="l3.1862" class="difflineplus">+              gDomains.getDomainFromHost(signon.hostname) == domain)</span>
<a href="#l3.1863"></a><span id="l3.1863" class="difflineplus">+            domainPasswords++;</span>
<a href="#l3.1864"></a><span id="l3.1864" class="difflineplus">+        }</span>
<a href="#l3.1865"></a><span id="l3.1865" class="difflineplus">+      }</span>
<a href="#l3.1866"></a><span id="l3.1866" class="difflineplus">+      if (idx &gt;= 0) {</span>
<a href="#l3.1867"></a><span id="l3.1867" class="difflineplus">+        if (aData == &quot;modifyLogin&quot;) {</span>
<a href="#l3.1868"></a><span id="l3.1868" class="difflineplus">+          this.allSignons[idx] = curLogin;</span>
<a href="#l3.1869"></a><span id="l3.1869" class="difflineplus">+          if (affectsLoaded)</span>
<a href="#l3.1870"></a><span id="l3.1870" class="difflineplus">+            this.tree.treeBoxObject.invalidateRow(disp_idx);</span>
<a href="#l3.1871"></a><span id="l3.1871" class="difflineplus">+        }</span>
<a href="#l3.1872"></a><span id="l3.1872" class="difflineplus">+        else if (aData == &quot;removeLogin&quot;) {</span>
<a href="#l3.1873"></a><span id="l3.1873" class="difflineplus">+          this.allSignons.splice(idx, 1);</span>
<a href="#l3.1874"></a><span id="l3.1874" class="difflineplus">+          if (affectsLoaded) {</span>
<a href="#l3.1875"></a><span id="l3.1875" class="difflineplus">+            this.displayedSignons.splice(disp_idx, 1);</span>
<a href="#l3.1876"></a><span id="l3.1876" class="difflineplus">+            this.tree.treeBoxObject.rowCountChanged(disp_idx, -1);</span>
<a href="#l3.1877"></a><span id="l3.1877" class="difflineplus">+          }</span>
<a href="#l3.1878"></a><span id="l3.1878" class="difflineplus">+          if (domainPasswords == 1)</span>
<a href="#l3.1879"></a><span id="l3.1879" class="difflineplus">+            gDomains.removeDomainOrFlag(domain, &quot;hasPasswords&quot;);</span>
<a href="#l3.1880"></a><span id="l3.1880" class="difflineplus">+        }</span>
<a href="#l3.1881"></a><span id="l3.1881" class="difflineplus">+      }</span>
<a href="#l3.1882"></a><span id="l3.1882" class="difflineplus">+    }</span>
<a href="#l3.1883"></a><span id="l3.1883" class="difflineplus">+  },</span>
<a href="#l3.1884"></a><span id="l3.1884" class="difflineplus">+</span>
<a href="#l3.1885"></a><span id="l3.1885" class="difflineplus">+  forget: function passwords_forget() {</span>
<a href="#l3.1886"></a><span id="l3.1886" class="difflineplus">+    for (let i = 0; i &lt; this.allSignons.length; i++) {</span>
<a href="#l3.1887"></a><span id="l3.1887" class="difflineplus">+      if (gDomains.hostMatchesSelected(this.allSignons[i].hostname)) {</span>
<a href="#l3.1888"></a><span id="l3.1888" class="difflineplus">+        gLocSvc.pwd.removeLogin(this.allSignons[i]);</span>
<a href="#l3.1889"></a><span id="l3.1889" class="difflineplus">+        this.allSignons.splice(i, 1);</span>
<a href="#l3.1890"></a><span id="l3.1890" class="difflineplus">+      }</span>
<a href="#l3.1891"></a><span id="l3.1891" class="difflineplus">+    }</span>
<a href="#l3.1892"></a><span id="l3.1892" class="difflineplus">+    gDomains.removeDomainOrFlag(gDomains.selectedDomain.title, &quot;hasPasswords&quot;);</span>
<a href="#l3.1893"></a><span id="l3.1893" class="difflineplus">+  },</span>
<a href="#l3.1894"></a><span id="l3.1894" class="difflineplus">+</span>
<a href="#l3.1895"></a><span id="l3.1895" class="difflineplus">+  // nsITreeView</span>
<a href="#l3.1896"></a><span id="l3.1896" class="difflineplus">+  __proto__: gBaseTreeView,</span>
<a href="#l3.1897"></a><span id="l3.1897" class="difflineplus">+  get rowCount() {</span>
<a href="#l3.1898"></a><span id="l3.1898" class="difflineplus">+    return this.displayedSignons.length;</span>
<a href="#l3.1899"></a><span id="l3.1899" class="difflineplus">+  },</span>
<a href="#l3.1900"></a><span id="l3.1900" class="difflineplus">+  getCellText: function(aRow, aColumn) {</span>
<a href="#l3.1901"></a><span id="l3.1901" class="difflineplus">+    let signon = this.displayedSignons[aRow];</span>
<a href="#l3.1902"></a><span id="l3.1902" class="difflineplus">+    switch (aColumn.id) {</span>
<a href="#l3.1903"></a><span id="l3.1903" class="difflineplus">+      case &quot;pwdHostCol&quot;:</span>
<a href="#l3.1904"></a><span id="l3.1904" class="difflineplus">+        return signon.httpRealm ?</span>
<a href="#l3.1905"></a><span id="l3.1905" class="difflineplus">+               (signon.hostname + &quot; (&quot; + signon.httpRealm + &quot;)&quot;) :</span>
<a href="#l3.1906"></a><span id="l3.1906" class="difflineplus">+               signon.hostname;</span>
<a href="#l3.1907"></a><span id="l3.1907" class="difflineplus">+      case &quot;pwdUserCol&quot;:</span>
<a href="#l3.1908"></a><span id="l3.1908" class="difflineplus">+        return signon.username || &quot;&quot;;</span>
<a href="#l3.1909"></a><span id="l3.1909" class="difflineplus">+      case &quot;pwdPasswordCol&quot;:</span>
<a href="#l3.1910"></a><span id="l3.1910" class="difflineplus">+        return signon.password || &quot;&quot;;</span>
<a href="#l3.1911"></a><span id="l3.1911" class="difflineplus">+    }</span>
<a href="#l3.1912"></a><span id="l3.1912" class="difflineplus">+  },</span>
<a href="#l3.1913"></a><span id="l3.1913" class="difflineplus">+};</span>
<a href="#l3.1914"></a><span id="l3.1914" class="difflineplus">+</span>
<a href="#l3.1915"></a><span id="l3.1915" class="difflineplus">+// :::::::::::::::::::: form data panel ::::::::::::::::::::</span>
<a href="#l3.1916"></a><span id="l3.1916" class="difflineplus">+var gFormdata = {</span>
<a href="#l3.1917"></a><span id="l3.1917" class="difflineplus">+  tree: null,</span>
<a href="#l3.1918"></a><span id="l3.1918" class="difflineplus">+  removeButton: null,</span>
<a href="#l3.1919"></a><span id="l3.1919" class="difflineplus">+  searchfield: null,</span>
<a href="#l3.1920"></a><span id="l3.1920" class="difflineplus">+</span>
<a href="#l3.1921"></a><span id="l3.1921" class="difflineplus">+  formdata: [],</span>
<a href="#l3.1922"></a><span id="l3.1922" class="difflineplus">+  displayedFormdata: [],</span>
<a href="#l3.1923"></a><span id="l3.1923" class="difflineplus">+</span>
<a href="#l3.1924"></a><span id="l3.1924" class="difflineplus">+  initialize: function formdata_initialize() {</span>
<a href="#l3.1925"></a><span id="l3.1925" class="difflineplus">+    gDataman.debugMsg(&quot;Initializing form data panel&quot;);</span>
<a href="#l3.1926"></a><span id="l3.1926" class="difflineplus">+    this.tree = document.getElementById(&quot;formdataTree&quot;);</span>
<a href="#l3.1927"></a><span id="l3.1927" class="difflineplus">+    this.tree.view = this;</span>
<a href="#l3.1928"></a><span id="l3.1928" class="difflineplus">+</span>
<a href="#l3.1929"></a><span id="l3.1929" class="difflineplus">+    this.searchfield = document.getElementById(&quot;fdataSearch&quot;);</span>
<a href="#l3.1930"></a><span id="l3.1930" class="difflineplus">+    this.removeButton = document.getElementById(&quot;fdataRemove&quot;);</span>
<a href="#l3.1931"></a><span id="l3.1931" class="difflineplus">+</span>
<a href="#l3.1932"></a><span id="l3.1932" class="difflineplus">+    // Always load fresh list, no need to react to changes when pane not open.</span>
<a href="#l3.1933"></a><span id="l3.1933" class="difflineplus">+    this.loadList();</span>
<a href="#l3.1934"></a><span id="l3.1934" class="difflineplus">+    this.search(&quot;&quot;);</span>
<a href="#l3.1935"></a><span id="l3.1935" class="difflineplus">+  },</span>
<a href="#l3.1936"></a><span id="l3.1936" class="difflineplus">+</span>
<a href="#l3.1937"></a><span id="l3.1937" class="difflineplus">+  shutdown: function formdata_shutdown() {</span>
<a href="#l3.1938"></a><span id="l3.1938" class="difflineplus">+    gDataman.debugMsg(&quot;Shutting down form data panel&quot;);</span>
<a href="#l3.1939"></a><span id="l3.1939" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.1940"></a><span id="l3.1940" class="difflineplus">+    this.tree.view = null;</span>
<a href="#l3.1941"></a><span id="l3.1941" class="difflineplus">+    this.displayedFormdata = [];</span>
<a href="#l3.1942"></a><span id="l3.1942" class="difflineplus">+  },</span>
<a href="#l3.1943"></a><span id="l3.1943" class="difflineplus">+</span>
<a href="#l3.1944"></a><span id="l3.1944" class="difflineplus">+  loadList: function formdata_loadList() {</span>
<a href="#l3.1945"></a><span id="l3.1945" class="difflineplus">+    this.formdata = [];</span>
<a href="#l3.1946"></a><span id="l3.1946" class="difflineplus">+    try {</span>
<a href="#l3.1947"></a><span id="l3.1947" class="difflineplus">+      let sql = &quot;SELECT fieldname, value, timesUsed, firstUsed, lastUsed, guid FROM moz_formhistory&quot;;</span>
<a href="#l3.1948"></a><span id="l3.1948" class="difflineplus">+      var statement = gLocSvc.fhist.DBConnection.createStatement(sql);</span>
<a href="#l3.1949"></a><span id="l3.1949" class="difflineplus">+      while (statement.executeStep()) {</span>
<a href="#l3.1950"></a><span id="l3.1950" class="difflineplus">+        this.formdata.push({fieldname: statement.row[&quot;fieldname&quot;],</span>
<a href="#l3.1951"></a><span id="l3.1951" class="difflineplus">+                            value: statement.row[&quot;value&quot;],</span>
<a href="#l3.1952"></a><span id="l3.1952" class="difflineplus">+                            timesUsed: statement.row[&quot;timesUsed&quot;],</span>
<a href="#l3.1953"></a><span id="l3.1953" class="difflineplus">+                            firstUsed: this._getTimeString(statement.row[&quot;firstUsed&quot;]),</span>
<a href="#l3.1954"></a><span id="l3.1954" class="difflineplus">+                            firstUsedSortValue: statement.row[&quot;firstUsed&quot;],</span>
<a href="#l3.1955"></a><span id="l3.1955" class="difflineplus">+                            lastUsed: this._getTimeString(statement.row[&quot;lastUsed&quot;]),</span>
<a href="#l3.1956"></a><span id="l3.1956" class="difflineplus">+                            lastUsedSortValue: statement.row[&quot;lastUsed&quot;],</span>
<a href="#l3.1957"></a><span id="l3.1957" class="difflineplus">+                            guid: statement.row[&quot;guid&quot;]}</span>
<a href="#l3.1958"></a><span id="l3.1958" class="difflineplus">+                          );</span>
<a href="#l3.1959"></a><span id="l3.1959" class="difflineplus">+      }</span>
<a href="#l3.1960"></a><span id="l3.1960" class="difflineplus">+    }</span>
<a href="#l3.1961"></a><span id="l3.1961" class="difflineplus">+    finally {</span>
<a href="#l3.1962"></a><span id="l3.1962" class="difflineplus">+      statement.reset();</span>
<a href="#l3.1963"></a><span id="l3.1963" class="difflineplus">+    }</span>
<a href="#l3.1964"></a><span id="l3.1964" class="difflineplus">+  },</span>
<a href="#l3.1965"></a><span id="l3.1965" class="difflineplus">+</span>
<a href="#l3.1966"></a><span id="l3.1966" class="difflineplus">+  _getTimeString: function formdata__getTimeString(aTimestamp) {</span>
<a href="#l3.1967"></a><span id="l3.1967" class="difflineplus">+    if (aTimestamp) {</span>
<a href="#l3.1968"></a><span id="l3.1968" class="difflineplus">+      let date = new Date(aTimestamp / 1000);</span>
<a href="#l3.1969"></a><span id="l3.1969" class="difflineplus">+</span>
<a href="#l3.1970"></a><span id="l3.1970" class="difflineplus">+      // If a date has an extreme value, the dateservice can't cope with it</span>
<a href="#l3.1971"></a><span id="l3.1971" class="difflineplus">+      // properly, so we'll just return a blank string.</span>
<a href="#l3.1972"></a><span id="l3.1972" class="difflineplus">+      // See bug 238045 for details.</span>
<a href="#l3.1973"></a><span id="l3.1973" class="difflineplus">+      let dtString = &quot;&quot;;</span>
<a href="#l3.1974"></a><span id="l3.1974" class="difflineplus">+      try {</span>
<a href="#l3.1975"></a><span id="l3.1975" class="difflineplus">+        dtString = gLocSvc.date.FormatDateTime(&quot;&quot;, gLocSvc.date.dateFormatLong,</span>
<a href="#l3.1976"></a><span id="l3.1976" class="difflineplus">+                                               gLocSvc.date.timeFormatSeconds,</span>
<a href="#l3.1977"></a><span id="l3.1977" class="difflineplus">+                                               date.getFullYear(), date.getMonth()+1,</span>
<a href="#l3.1978"></a><span id="l3.1978" class="difflineplus">+                                               date.getDate(), date.getHours(),</span>
<a href="#l3.1979"></a><span id="l3.1979" class="difflineplus">+                                               date.getMinutes(), date.getSeconds());</span>
<a href="#l3.1980"></a><span id="l3.1980" class="difflineplus">+      }</span>
<a href="#l3.1981"></a><span id="l3.1981" class="difflineplus">+      catch (e) {}</span>
<a href="#l3.1982"></a><span id="l3.1982" class="difflineplus">+      return dtString;</span>
<a href="#l3.1983"></a><span id="l3.1983" class="difflineplus">+    }</span>
<a href="#l3.1984"></a><span id="l3.1984" class="difflineplus">+    return &quot;&quot;;</span>
<a href="#l3.1985"></a><span id="l3.1985" class="difflineplus">+  },</span>
<a href="#l3.1986"></a><span id="l3.1986" class="difflineplus">+</span>
<a href="#l3.1987"></a><span id="l3.1987" class="difflineplus">+  _getObjID: function formdata__getObjID(aIdx) {</span>
<a href="#l3.1988"></a><span id="l3.1988" class="difflineplus">+    return gFormdata.displayedFormdata[aIdx].guid;</span>
<a href="#l3.1989"></a><span id="l3.1989" class="difflineplus">+  },</span>
<a href="#l3.1990"></a><span id="l3.1990" class="difflineplus">+</span>
<a href="#l3.1991"></a><span id="l3.1991" class="difflineplus">+  select: function formdata_select() {</span>
<a href="#l3.1992"></a><span id="l3.1992" class="difflineplus">+    var selections = gDataman.getTreeSelections(this.tree);</span>
<a href="#l3.1993"></a><span id="l3.1993" class="difflineplus">+    this.removeButton.disabled = !selections.length;</span>
<a href="#l3.1994"></a><span id="l3.1994" class="difflineplus">+    return true;</span>
<a href="#l3.1995"></a><span id="l3.1995" class="difflineplus">+  },</span>
<a href="#l3.1996"></a><span id="l3.1996" class="difflineplus">+</span>
<a href="#l3.1997"></a><span id="l3.1997" class="difflineplus">+  selectAll: function formdata_selectAll() {</span>
<a href="#l3.1998"></a><span id="l3.1998" class="difflineplus">+    this.tree.view.selection.selectAll();</span>
<a href="#l3.1999"></a><span id="l3.1999" class="difflineplus">+  },</span>
<a href="#l3.2000"></a><span id="l3.2000" class="difflineplus">+</span>
<a href="#l3.2001"></a><span id="l3.2001" class="difflineplus">+  handleKeyPress: function formdata_handleKeyPress(aEvent) {</span>
<a href="#l3.2002"></a><span id="l3.2002" class="difflineplus">+    if (aEvent.keyCode == KeyEvent.DOM_VK_DELETE) {</span>
<a href="#l3.2003"></a><span id="l3.2003" class="difflineplus">+      this.delete();</span>
<a href="#l3.2004"></a><span id="l3.2004" class="difflineplus">+    }</span>
<a href="#l3.2005"></a><span id="l3.2005" class="difflineplus">+  },</span>
<a href="#l3.2006"></a><span id="l3.2006" class="difflineplus">+</span>
<a href="#l3.2007"></a><span id="l3.2007" class="difflineplus">+  sort: function formdata_sort(aColumn, aUpdateSelection, aInvertDirection) {</span>
<a href="#l3.2008"></a><span id="l3.2008" class="difflineplus">+    // Make sure we have a valid column.</span>
<a href="#l3.2009"></a><span id="l3.2009" class="difflineplus">+    let column = aColumn;</span>
<a href="#l3.2010"></a><span id="l3.2010" class="difflineplus">+    if (!column) {</span>
<a href="#l3.2011"></a><span id="l3.2011" class="difflineplus">+      let sortedCol = this.tree.columns.getSortedColumn();</span>
<a href="#l3.2012"></a><span id="l3.2012" class="difflineplus">+      if (sortedCol)</span>
<a href="#l3.2013"></a><span id="l3.2013" class="difflineplus">+        column = sortedCol.element;</span>
<a href="#l3.2014"></a><span id="l3.2014" class="difflineplus">+      else</span>
<a href="#l3.2015"></a><span id="l3.2015" class="difflineplus">+        column = document.getElementById(&quot;fdataFieldCol&quot;);</span>
<a href="#l3.2016"></a><span id="l3.2016" class="difflineplus">+    }</span>
<a href="#l3.2017"></a><span id="l3.2017" class="difflineplus">+    else if (column.localName == &quot;treecols&quot; || column.localName == &quot;splitter&quot;)</span>
<a href="#l3.2018"></a><span id="l3.2018" class="difflineplus">+      return;</span>
<a href="#l3.2019"></a><span id="l3.2019" class="difflineplus">+</span>
<a href="#l3.2020"></a><span id="l3.2020" class="difflineplus">+    if (!column || column.localName != &quot;treecol&quot;) {</span>
<a href="#l3.2021"></a><span id="l3.2021" class="difflineplus">+      Components.utils.reportError(&quot;No column found to sort form data by&quot;);</span>
<a href="#l3.2022"></a><span id="l3.2022" class="difflineplus">+      return;</span>
<a href="#l3.2023"></a><span id="l3.2023" class="difflineplus">+    }</span>
<a href="#l3.2024"></a><span id="l3.2024" class="difflineplus">+</span>
<a href="#l3.2025"></a><span id="l3.2025" class="difflineplus">+    let dirAscending = column.getAttribute(&quot;sortDirection&quot;) !=</span>
<a href="#l3.2026"></a><span id="l3.2026" class="difflineplus">+                       (aInvertDirection ? &quot;ascending&quot; : &quot;descending&quot;);</span>
<a href="#l3.2027"></a><span id="l3.2027" class="difflineplus">+    let dirFactor = dirAscending ? 1 : -1;</span>
<a href="#l3.2028"></a><span id="l3.2028" class="difflineplus">+</span>
<a href="#l3.2029"></a><span id="l3.2029" class="difflineplus">+    // Clear attributes on all columns, we're setting them again after sorting.</span>
<a href="#l3.2030"></a><span id="l3.2030" class="difflineplus">+    for (let node = column.parentNode.firstChild; node; node = node.nextSibling) {</span>
<a href="#l3.2031"></a><span id="l3.2031" class="difflineplus">+      node.removeAttribute(&quot;sortActive&quot;);</span>
<a href="#l3.2032"></a><span id="l3.2032" class="difflineplus">+      node.removeAttribute(&quot;sortDirection&quot;);</span>
<a href="#l3.2033"></a><span id="l3.2033" class="difflineplus">+    }</span>
<a href="#l3.2034"></a><span id="l3.2034" class="difflineplus">+</span>
<a href="#l3.2035"></a><span id="l3.2035" class="difflineplus">+    // compare function for two formdata items</span>
<a href="#l3.2036"></a><span id="l3.2036" class="difflineplus">+    let compfunc = function formdata_sort_compare(aOne, aTwo) {</span>
<a href="#l3.2037"></a><span id="l3.2037" class="difflineplus">+      switch (column.id) {</span>
<a href="#l3.2038"></a><span id="l3.2038" class="difflineplus">+        case &quot;fdataFieldCol&quot;:</span>
<a href="#l3.2039"></a><span id="l3.2039" class="difflineplus">+          return dirFactor * aOne.fieldname.localeCompare(aTwo.fieldname);</span>
<a href="#l3.2040"></a><span id="l3.2040" class="difflineplus">+        case &quot;fdataValueCol&quot;:</span>
<a href="#l3.2041"></a><span id="l3.2041" class="difflineplus">+          return dirFactor * aOne.value.localeCompare(aTwo.value);</span>
<a href="#l3.2042"></a><span id="l3.2042" class="difflineplus">+        case &quot;fdataCountCol&quot;:</span>
<a href="#l3.2043"></a><span id="l3.2043" class="difflineplus">+          return dirFactor * (aOne.timesUsed - aTwo.timesUsed);</span>
<a href="#l3.2044"></a><span id="l3.2044" class="difflineplus">+        case &quot;fdataFirstCol&quot;:</span>
<a href="#l3.2045"></a><span id="l3.2045" class="difflineplus">+          return dirFactor * (aOne.firstUsedSortValue - aTwo.firstUsedSortValue);</span>
<a href="#l3.2046"></a><span id="l3.2046" class="difflineplus">+        case &quot;fdataLastCol&quot;:</span>
<a href="#l3.2047"></a><span id="l3.2047" class="difflineplus">+          return dirFactor * (aOne.lastUsedSortValue - aTwo.lastUsedSortValue);</span>
<a href="#l3.2048"></a><span id="l3.2048" class="difflineplus">+      }</span>
<a href="#l3.2049"></a><span id="l3.2049" class="difflineplus">+      return 0;</span>
<a href="#l3.2050"></a><span id="l3.2050" class="difflineplus">+    };</span>
<a href="#l3.2051"></a><span id="l3.2051" class="difflineplus">+</span>
<a href="#l3.2052"></a><span id="l3.2052" class="difflineplus">+    if (aUpdateSelection) {</span>
<a href="#l3.2053"></a><span id="l3.2053" class="difflineplus">+      var selectionCache = gDataman.getSelectedIDs(this.tree, this._getObjID);</span>
<a href="#l3.2054"></a><span id="l3.2054" class="difflineplus">+    }</span>
<a href="#l3.2055"></a><span id="l3.2055" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.2056"></a><span id="l3.2056" class="difflineplus">+</span>
<a href="#l3.2057"></a><span id="l3.2057" class="difflineplus">+    // Do the actual sorting of the array.</span>
<a href="#l3.2058"></a><span id="l3.2058" class="difflineplus">+    this.displayedFormdata.sort(compfunc);</span>
<a href="#l3.2059"></a><span id="l3.2059" class="difflineplus">+    this.tree.treeBoxObject.invalidate();</span>
<a href="#l3.2060"></a><span id="l3.2060" class="difflineplus">+</span>
<a href="#l3.2061"></a><span id="l3.2061" class="difflineplus">+    if (aUpdateSelection) {</span>
<a href="#l3.2062"></a><span id="l3.2062" class="difflineplus">+      gDataman.restoreSelectionFromIDs(this.tree, this._getObjID, selectionCache);</span>
<a href="#l3.2063"></a><span id="l3.2063" class="difflineplus">+    }</span>
<a href="#l3.2064"></a><span id="l3.2064" class="difflineplus">+</span>
<a href="#l3.2065"></a><span id="l3.2065" class="difflineplus">+    // Set attributes to the sorting we did.</span>
<a href="#l3.2066"></a><span id="l3.2066" class="difflineplus">+    column.setAttribute(&quot;sortActive&quot;, &quot;true&quot;);</span>
<a href="#l3.2067"></a><span id="l3.2067" class="difflineplus">+    column.setAttribute(&quot;sortDirection&quot;, dirAscending ? &quot;ascending&quot; : &quot;descending&quot;);</span>
<a href="#l3.2068"></a><span id="l3.2068" class="difflineplus">+  },</span>
<a href="#l3.2069"></a><span id="l3.2069" class="difflineplus">+</span>
<a href="#l3.2070"></a><span id="l3.2070" class="difflineplus">+  delete: function formdata_delete() {</span>
<a href="#l3.2071"></a><span id="l3.2071" class="difflineplus">+    var selections = gDataman.getTreeSelections(this.tree);</span>
<a href="#l3.2072"></a><span id="l3.2072" class="difflineplus">+</span>
<a href="#l3.2073"></a><span id="l3.2073" class="difflineplus">+    if (selections.length &gt; 1) {</span>
<a href="#l3.2074"></a><span id="l3.2074" class="difflineplus">+      let title = gDataman.bundle.getString(&quot;fdata.deleteSelectedTitle&quot;);</span>
<a href="#l3.2075"></a><span id="l3.2075" class="difflineplus">+      let msg = gDataman.bundle.getString(&quot;fdata.deleteSelected&quot;);</span>
<a href="#l3.2076"></a><span id="l3.2076" class="difflineplus">+      let flags = ((Services.prompt.BUTTON_TITLE_IS_STRING * Services.prompt.BUTTON_POS_0) +</span>
<a href="#l3.2077"></a><span id="l3.2077" class="difflineplus">+                   (Services.prompt.BUTTON_TITLE_CANCEL * Services.prompt.BUTTON_POS_1) +</span>
<a href="#l3.2078"></a><span id="l3.2078" class="difflineplus">+                   Services.prompt.BUTTON_POS_1_DEFAULT)</span>
<a href="#l3.2079"></a><span id="l3.2079" class="difflineplus">+      let yes = gDataman.bundle.getString(&quot;fdata.deleteSelectedYes&quot;);</span>
<a href="#l3.2080"></a><span id="l3.2080" class="difflineplus">+      if (Services.prompt.confirmEx(window, title, msg, flags, yes, null, null,</span>
<a href="#l3.2081"></a><span id="l3.2081" class="difflineplus">+                                    null, {value: 0}) == 1) // 1==&quot;Cancel&quot; button</span>
<a href="#l3.2082"></a><span id="l3.2082" class="difflineplus">+        return;</span>
<a href="#l3.2083"></a><span id="l3.2083" class="difflineplus">+    }</span>
<a href="#l3.2084"></a><span id="l3.2084" class="difflineplus">+</span>
<a href="#l3.2085"></a><span id="l3.2085" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.2086"></a><span id="l3.2086" class="difflineplus">+    // Loop backwards so later indexes in the list don't change.</span>
<a href="#l3.2087"></a><span id="l3.2087" class="difflineplus">+    for (let i = selections.length - 1; i &gt;= 0; i--) {</span>
<a href="#l3.2088"></a><span id="l3.2088" class="difflineplus">+      let delFData = this.displayedFormdata[selections[i]];</span>
<a href="#l3.2089"></a><span id="l3.2089" class="difflineplus">+      this.formdata.splice(this.formdata.indexOf(this.displayedFormdata[selections[i]]), 1);</span>
<a href="#l3.2090"></a><span id="l3.2090" class="difflineplus">+      this.displayedFormdata.splice(selections[i], 1);</span>
<a href="#l3.2091"></a><span id="l3.2091" class="difflineplus">+      this.tree.treeBoxObject.rowCountChanged(selections[i], -1);</span>
<a href="#l3.2092"></a><span id="l3.2092" class="difflineplus">+      gLocSvc.fhist.removeEntry(delFData.fieldname, delFData.value);</span>
<a href="#l3.2093"></a><span id="l3.2093" class="difflineplus">+    }</span>
<a href="#l3.2094"></a><span id="l3.2094" class="difflineplus">+  },</span>
<a href="#l3.2095"></a><span id="l3.2095" class="difflineplus">+</span>
<a href="#l3.2096"></a><span id="l3.2096" class="difflineplus">+  search: function formdata_search(aSearchString) {</span>
<a href="#l3.2097"></a><span id="l3.2097" class="difflineplus">+    let selectionCache = gDataman.getSelectedIDs(this.tree, this._getObjID);</span>
<a href="#l3.2098"></a><span id="l3.2098" class="difflineplus">+    this.tree.treeBoxObject.beginUpdateBatch();</span>
<a href="#l3.2099"></a><span id="l3.2099" class="difflineplus">+    this.tree.view.selection.clearSelection();</span>
<a href="#l3.2100"></a><span id="l3.2100" class="difflineplus">+    var lcSearch = aSearchString.toLocaleLowerCase();</span>
<a href="#l3.2101"></a><span id="l3.2101" class="difflineplus">+    this.displayedFormdata = this.formdata.filter(</span>
<a href="#l3.2102"></a><span id="l3.2102" class="difflineplus">+      function(aFd) {</span>
<a href="#l3.2103"></a><span id="l3.2103" class="difflineplus">+        return aFd.fieldname.toLocaleLowerCase().indexOf(lcSearch) != -1 ||</span>
<a href="#l3.2104"></a><span id="l3.2104" class="difflineplus">+               aFd.value.toLocaleLowerCase().indexOf(lcSearch) != -1;</span>
<a href="#l3.2105"></a><span id="l3.2105" class="difflineplus">+      });</span>
<a href="#l3.2106"></a><span id="l3.2106" class="difflineplus">+    this.sort(null, false, false);</span>
<a href="#l3.2107"></a><span id="l3.2107" class="difflineplus">+    gDataman.restoreSelectionFromIDs(this.tree, this._getObjID, selectionCache);</span>
<a href="#l3.2108"></a><span id="l3.2108" class="difflineplus">+    this.tree.treeBoxObject.endUpdateBatch();</span>
<a href="#l3.2109"></a><span id="l3.2109" class="difflineplus">+  },</span>
<a href="#l3.2110"></a><span id="l3.2110" class="difflineplus">+</span>
<a href="#l3.2111"></a><span id="l3.2111" class="difflineplus">+  focusSearch: function formdata_focusSearch() {</span>
<a href="#l3.2112"></a><span id="l3.2112" class="difflineplus">+    this.searchfield.focus();</span>
<a href="#l3.2113"></a><span id="l3.2113" class="difflineplus">+  },</span>
<a href="#l3.2114"></a><span id="l3.2114" class="difflineplus">+</span>
<a href="#l3.2115"></a><span id="l3.2115" class="difflineplus">+  updateContext: function formdata_updateContext() {</span>
<a href="#l3.2116"></a><span id="l3.2116" class="difflineplus">+    document.getElementById(&quot;fdata-context-remove&quot;).disabled =</span>
<a href="#l3.2117"></a><span id="l3.2117" class="difflineplus">+      this.removeButton.disabled;</span>
<a href="#l3.2118"></a><span id="l3.2118" class="difflineplus">+    document.getElementById(&quot;fdata-context-selectall&quot;).disabled =</span>
<a href="#l3.2119"></a><span id="l3.2119" class="difflineplus">+      this.tree.view.selection.count &gt;= this.tree.view.rowCount;</span>
<a href="#l3.2120"></a><span id="l3.2120" class="difflineplus">+  },</span>
<a href="#l3.2121"></a><span id="l3.2121" class="difflineplus">+</span>
<a href="#l3.2122"></a><span id="l3.2122" class="difflineplus">+  reactToChange: function formdata_reactToChange(aSubject, aData) {</span>
<a href="#l3.2123"></a><span id="l3.2123" class="difflineplus">+    // aData: addEntry, modifyEntry, removeEntry, removeAllEntries,</span>
<a href="#l3.2124"></a><span id="l3.2124" class="difflineplus">+    // removeEntriesForName, removeEntriesByTimeframe, expireOldEntries,</span>
<a href="#l3.2125"></a><span id="l3.2125" class="difflineplus">+    // before-removeEntry, before-removeAllEntries, before-removeEntriesForName,</span>
<a href="#l3.2126"></a><span id="l3.2126" class="difflineplus">+    // before-removeEntriesByTimeframe, before-expireOldEntries</span>
<a href="#l3.2127"></a><span id="l3.2127" class="difflineplus">+</span>
<a href="#l3.2128"></a><span id="l3.2128" class="difflineplus">+    // Ignore changes when no form data pane is loaded</span>
<a href="#l3.2129"></a><span id="l3.2129" class="difflineplus">+    // or if we caught a before-* notification.</span>
<a href="#l3.2130"></a><span id="l3.2130" class="difflineplus">+    if (!this.displayedFormdata.length || /^before-/.test(aData))</span>
<a href="#l3.2131"></a><span id="l3.2131" class="difflineplus">+      return;</span>
<a href="#l3.2132"></a><span id="l3.2132" class="difflineplus">+</span>
<a href="#l3.2133"></a><span id="l3.2133" class="difflineplus">+    if (aData == &quot;removeAllEntries&quot; || aData == &quot;removeEntriesForName&quot; ||</span>
<a href="#l3.2134"></a><span id="l3.2134" class="difflineplus">+        aData == &quot;removeEntriesByTimeframe&quot; || aData == &quot;expireOldEntries&quot;) {</span>
<a href="#l3.2135"></a><span id="l3.2135" class="difflineplus">+      // Go for re-parsing the whole thing.</span>
<a href="#l3.2136"></a><span id="l3.2136" class="difflineplus">+      this.tree.treeBoxObject.beginUpdateBatch();</span>
<a href="#l3.2137"></a><span id="l3.2137" class="difflineplus">+      this.tree.view.selection.clearSelection();</span>
<a href="#l3.2138"></a><span id="l3.2138" class="difflineplus">+      this.displayedFormdata = [];</span>
<a href="#l3.2139"></a><span id="l3.2139" class="difflineplus">+      this.tree.treeBoxObject.endUpdateBatch();</span>
<a href="#l3.2140"></a><span id="l3.2140" class="difflineplus">+</span>
<a href="#l3.2141"></a><span id="l3.2141" class="difflineplus">+      this.loadList();</span>
<a href="#l3.2142"></a><span id="l3.2142" class="difflineplus">+      this.search(&quot;&quot;);</span>
<a href="#l3.2143"></a><span id="l3.2143" class="difflineplus">+      return;</span>
<a href="#l3.2144"></a><span id="l3.2144" class="difflineplus">+    }</span>
<a href="#l3.2145"></a><span id="l3.2145" class="difflineplus">+</span>
<a href="#l3.2146"></a><span id="l3.2146" class="difflineplus">+    // Usual notifications for addEntry, modifyEntry, removeEntry - do &quot;surgical&quot; updates.</span>
<a href="#l3.2147"></a><span id="l3.2147" class="difflineplus">+    let subjectData = []; // Those notifications all have: name, value, guid.</span>
<a href="#l3.2148"></a><span id="l3.2148" class="difflineplus">+    if (aSubject instanceof Components.interfaces.nsIArray) {</span>
<a href="#l3.2149"></a><span id="l3.2149" class="difflineplus">+      let enumerator = aSubject.enumerate();</span>
<a href="#l3.2150"></a><span id="l3.2150" class="difflineplus">+      while (enumerator.hasMoreElements()) {</span>
<a href="#l3.2151"></a><span id="l3.2151" class="difflineplus">+        let nextElem = enumerator.getNext();</span>
<a href="#l3.2152"></a><span id="l3.2152" class="difflineplus">+        if (nextElem instanceof Components.interfaces.nsISupportsString ||</span>
<a href="#l3.2153"></a><span id="l3.2153" class="difflineplus">+            nextElem instanceof Components.interfaces.nsISupportsPRInt64) {</span>
<a href="#l3.2154"></a><span id="l3.2154" class="difflineplus">+          subjectData.push(nextElem.data);</span>
<a href="#l3.2155"></a><span id="l3.2155" class="difflineplus">+        }</span>
<a href="#l3.2156"></a><span id="l3.2156" class="difflineplus">+      }</span>
<a href="#l3.2157"></a><span id="l3.2157" class="difflineplus">+    }</span>
<a href="#l3.2158"></a><span id="l3.2158" class="difflineplus">+    else {</span>
<a href="#l3.2159"></a><span id="l3.2159" class="difflineplus">+      Components.utils.reportError(&quot;Observed an unrecognized formdata change of type &quot; + aData);</span>
<a href="#l3.2160"></a><span id="l3.2160" class="difflineplus">+      return;</span>
<a href="#l3.2161"></a><span id="l3.2161" class="difflineplus">+    }</span>
<a href="#l3.2162"></a><span id="l3.2162" class="difflineplus">+</span>
<a href="#l3.2163"></a><span id="l3.2163" class="difflineplus">+    let entryData = null;</span>
<a href="#l3.2164"></a><span id="l3.2164" class="difflineplus">+    if (aData == &quot;addEntry&quot; || aData == &quot;modifyEntry&quot;) {</span>
<a href="#l3.2165"></a><span id="l3.2165" class="difflineplus">+      try {</span>
<a href="#l3.2166"></a><span id="l3.2166" class="difflineplus">+        let sql = &quot;SELECT fieldname, value, timesUsed, firstUsed, lastUsed, guid FROM moz_formhistory WHERE guid = :guid&quot;;</span>
<a href="#l3.2167"></a><span id="l3.2167" class="difflineplus">+        var statement = gLocSvc.fhist.DBConnection.createStatement(sql);</span>
<a href="#l3.2168"></a><span id="l3.2168" class="difflineplus">+        statement.params.guid = subjectData[2];</span>
<a href="#l3.2169"></a><span id="l3.2169" class="difflineplus">+        while (statement.executeStep()) {</span>
<a href="#l3.2170"></a><span id="l3.2170" class="difflineplus">+          entryData = {fieldname: statement.row[&quot;fieldname&quot;],</span>
<a href="#l3.2171"></a><span id="l3.2171" class="difflineplus">+                       value: statement.row[&quot;value&quot;],</span>
<a href="#l3.2172"></a><span id="l3.2172" class="difflineplus">+                       timesUsed: statement.row[&quot;timesUsed&quot;],</span>
<a href="#l3.2173"></a><span id="l3.2173" class="difflineplus">+                       firstUsed: this._getTimeString(statement.row[&quot;firstUsed&quot;]),</span>
<a href="#l3.2174"></a><span id="l3.2174" class="difflineplus">+                       firstUsedSortValue: statement.row[&quot;firstUsed&quot;],</span>
<a href="#l3.2175"></a><span id="l3.2175" class="difflineplus">+                       lastUsed: this._getTimeString(statement.row[&quot;lastUsed&quot;]),</span>
<a href="#l3.2176"></a><span id="l3.2176" class="difflineplus">+                       lastUsedSortValue: statement.row[&quot;lastUsed&quot;],</span>
<a href="#l3.2177"></a><span id="l3.2177" class="difflineplus">+                       guid: statement.row[&quot;guid&quot;]};</span>
<a href="#l3.2178"></a><span id="l3.2178" class="difflineplus">+        }</span>
<a href="#l3.2179"></a><span id="l3.2179" class="difflineplus">+      }</span>
<a href="#l3.2180"></a><span id="l3.2180" class="difflineplus">+      finally {</span>
<a href="#l3.2181"></a><span id="l3.2181" class="difflineplus">+        statement.reset();</span>
<a href="#l3.2182"></a><span id="l3.2182" class="difflineplus">+      }</span>
<a href="#l3.2183"></a><span id="l3.2183" class="difflineplus">+</span>
<a href="#l3.2184"></a><span id="l3.2184" class="difflineplus">+      if (!entryData) {</span>
<a href="#l3.2185"></a><span id="l3.2185" class="difflineplus">+        Components.utils.reportError(&quot;Could not find added/modifed formdata entry&quot;);</span>
<a href="#l3.2186"></a><span id="l3.2186" class="difflineplus">+        return;</span>
<a href="#l3.2187"></a><span id="l3.2187" class="difflineplus">+      }</span>
<a href="#l3.2188"></a><span id="l3.2188" class="difflineplus">+    }</span>
<a href="#l3.2189"></a><span id="l3.2189" class="difflineplus">+</span>
<a href="#l3.2190"></a><span id="l3.2190" class="difflineplus">+    if (aData == &quot;addEntry&quot;) {</span>
<a href="#l3.2191"></a><span id="l3.2191" class="difflineplus">+      this.formdata.push(entryData);</span>
<a href="#l3.2192"></a><span id="l3.2192" class="difflineplus">+</span>
<a href="#l3.2193"></a><span id="l3.2193" class="difflineplus">+      this.displayedFormdata.push(this.formdata[this.formdata.length - 1]);</span>
<a href="#l3.2194"></a><span id="l3.2194" class="difflineplus">+      this.tree.treeBoxObject.rowCountChanged(this.formdata.length - 1, 1);</span>
<a href="#l3.2195"></a><span id="l3.2195" class="difflineplus">+      this.search(&quot;&quot;);</span>
<a href="#l3.2196"></a><span id="l3.2196" class="difflineplus">+    }</span>
<a href="#l3.2197"></a><span id="l3.2197" class="difflineplus">+    else {</span>
<a href="#l3.2198"></a><span id="l3.2198" class="difflineplus">+      let idx = -1, disp_idx = -1;</span>
<a href="#l3.2199"></a><span id="l3.2199" class="difflineplus">+      for (let i = 0; i &lt; this.displayedFormdata.length; i++) {</span>
<a href="#l3.2200"></a><span id="l3.2200" class="difflineplus">+        let fdata = this.displayedFormdata[i];</span>
<a href="#l3.2201"></a><span id="l3.2201" class="difflineplus">+        if (fdata &amp;&amp; fdata.guid == subjectData[2]) {</span>
<a href="#l3.2202"></a><span id="l3.2202" class="difflineplus">+          idx = this.formdata.indexOf(this.displayedFormdata[i]);</span>
<a href="#l3.2203"></a><span id="l3.2203" class="difflineplus">+          disp_idx = i;</span>
<a href="#l3.2204"></a><span id="l3.2204" class="difflineplus">+          break;</span>
<a href="#l3.2205"></a><span id="l3.2205" class="difflineplus">+        }</span>
<a href="#l3.2206"></a><span id="l3.2206" class="difflineplus">+      }</span>
<a href="#l3.2207"></a><span id="l3.2207" class="difflineplus">+      if (idx &gt;= 0) {</span>
<a href="#l3.2208"></a><span id="l3.2208" class="difflineplus">+        if (aData == &quot;modifyEntry&quot;) {</span>
<a href="#l3.2209"></a><span id="l3.2209" class="difflineplus">+          this.formdata[idx] = entryData;</span>
<a href="#l3.2210"></a><span id="l3.2210" class="difflineplus">+          this.tree.treeBoxObject.invalidateRow(disp_idx);</span>
<a href="#l3.2211"></a><span id="l3.2211" class="difflineplus">+        }</span>
<a href="#l3.2212"></a><span id="l3.2212" class="difflineplus">+        else if (aData == &quot;removeEntry&quot;) {</span>
<a href="#l3.2213"></a><span id="l3.2213" class="difflineplus">+          this.formdata.splice(idx, 1);</span>
<a href="#l3.2214"></a><span id="l3.2214" class="difflineplus">+          this.displayedFormdata.splice(disp_idx, 1);</span>
<a href="#l3.2215"></a><span id="l3.2215" class="difflineplus">+          this.tree.treeBoxObject.rowCountChanged(disp_idx, -1);</span>
<a href="#l3.2216"></a><span id="l3.2216" class="difflineplus">+        }</span>
<a href="#l3.2217"></a><span id="l3.2217" class="difflineplus">+      }</span>
<a href="#l3.2218"></a><span id="l3.2218" class="difflineplus">+    }</span>
<a href="#l3.2219"></a><span id="l3.2219" class="difflineplus">+  },</span>
<a href="#l3.2220"></a><span id="l3.2220" class="difflineplus">+</span>
<a href="#l3.2221"></a><span id="l3.2221" class="difflineplus">+  forget: function formdata_forget() {</span>
<a href="#l3.2222"></a><span id="l3.2222" class="difflineplus">+    gLocSvc.fhist.removeAllEntries();</span>
<a href="#l3.2223"></a><span id="l3.2223" class="difflineplus">+  },</span>
<a href="#l3.2224"></a><span id="l3.2224" class="difflineplus">+</span>
<a href="#l3.2225"></a><span id="l3.2225" class="difflineplus">+  // nsITreeView</span>
<a href="#l3.2226"></a><span id="l3.2226" class="difflineplus">+  __proto__: gBaseTreeView,</span>
<a href="#l3.2227"></a><span id="l3.2227" class="difflineplus">+  get rowCount() {</span>
<a href="#l3.2228"></a><span id="l3.2228" class="difflineplus">+    return this.displayedFormdata.length;</span>
<a href="#l3.2229"></a><span id="l3.2229" class="difflineplus">+  },</span>
<a href="#l3.2230"></a><span id="l3.2230" class="difflineplus">+  getCellText: function(aRow, aColumn) {</span>
<a href="#l3.2231"></a><span id="l3.2231" class="difflineplus">+    let fdata = this.displayedFormdata[aRow];</span>
<a href="#l3.2232"></a><span id="l3.2232" class="difflineplus">+    switch (aColumn.id) {</span>
<a href="#l3.2233"></a><span id="l3.2233" class="difflineplus">+      case &quot;fdataFieldCol&quot;:</span>
<a href="#l3.2234"></a><span id="l3.2234" class="difflineplus">+        return fdata.fieldname;</span>
<a href="#l3.2235"></a><span id="l3.2235" class="difflineplus">+      case &quot;fdataValueCol&quot;:</span>
<a href="#l3.2236"></a><span id="l3.2236" class="difflineplus">+        return fdata.value;</span>
<a href="#l3.2237"></a><span id="l3.2237" class="difflineplus">+      case &quot;fdataCountCol&quot;:</span>
<a href="#l3.2238"></a><span id="l3.2238" class="difflineplus">+        return fdata.timesUsed;</span>
<a href="#l3.2239"></a><span id="l3.2239" class="difflineplus">+      case &quot;fdataFirstCol&quot;:</span>
<a href="#l3.2240"></a><span id="l3.2240" class="difflineplus">+        return fdata.firstUsed;</span>
<a href="#l3.2241"></a><span id="l3.2241" class="difflineplus">+      case &quot;fdataLastCol&quot;:</span>
<a href="#l3.2242"></a><span id="l3.2242" class="difflineplus">+        return fdata.lastUsed;</span>
<a href="#l3.2243"></a><span id="l3.2243" class="difflineplus">+    }</span>
<a href="#l3.2244"></a><span id="l3.2244" class="difflineplus">+  },</span>
<a href="#l3.2245"></a><span id="l3.2245" class="difflineplus">+};</span>
<a href="#l3.2246"></a><span id="l3.2246" class="difflineplus">+</span>
<a href="#l3.2247"></a><span id="l3.2247" class="difflineplus">+// :::::::::::::::::::: forget panel ::::::::::::::::::::</span>
<a href="#l3.2248"></a><span id="l3.2248" class="difflineplus">+var gForget = {</span>
<a href="#l3.2249"></a><span id="l3.2249" class="difflineplus">+  forgetDesc: null,</span>
<a href="#l3.2250"></a><span id="l3.2250" class="difflineplus">+  forgetCookies: null,</span>
<a href="#l3.2251"></a><span id="l3.2251" class="difflineplus">+  forgetPermissions: null,</span>
<a href="#l3.2252"></a><span id="l3.2252" class="difflineplus">+  forgetPreferences: null,</span>
<a href="#l3.2253"></a><span id="l3.2253" class="difflineplus">+  forgetPasswords: null,</span>
<a href="#l3.2254"></a><span id="l3.2254" class="difflineplus">+  forgetFormdata: null,</span>
<a href="#l3.2255"></a><span id="l3.2255" class="difflineplus">+  forgetCookiesLabel: null,</span>
<a href="#l3.2256"></a><span id="l3.2256" class="difflineplus">+  forgetPermissionsLabel: null,</span>
<a href="#l3.2257"></a><span id="l3.2257" class="difflineplus">+  forgetPreferencesLabel: null,</span>
<a href="#l3.2258"></a><span id="l3.2258" class="difflineplus">+  forgetPasswordsLabel: null,</span>
<a href="#l3.2259"></a><span id="l3.2259" class="difflineplus">+  forgetFormdataLabel: null,</span>
<a href="#l3.2260"></a><span id="l3.2260" class="difflineplus">+  forgetButton: null,</span>
<a href="#l3.2261"></a><span id="l3.2261" class="difflineplus">+</span>
<a href="#l3.2262"></a><span id="l3.2262" class="difflineplus">+  initialize: function forget_initialize() {</span>
<a href="#l3.2263"></a><span id="l3.2263" class="difflineplus">+    gDataman.debugMsg(&quot;Initializing forget panel&quot;);</span>
<a href="#l3.2264"></a><span id="l3.2264" class="difflineplus">+</span>
<a href="#l3.2265"></a><span id="l3.2265" class="difflineplus">+    this.forgetDesc = document.getElementById(&quot;forgetDesc&quot;);</span>
<a href="#l3.2266"></a><span id="l3.2266" class="difflineplus">+    [&quot;forgetCookies&quot;, &quot;forgetPermissions&quot;, &quot;forgetPreferences&quot;,</span>
<a href="#l3.2267"></a><span id="l3.2267" class="difflineplus">+     &quot;forgetPasswords&quot;, &quot;forgetFormdata&quot;].forEach(function(elemID) {</span>
<a href="#l3.2268"></a><span id="l3.2268" class="difflineplus">+      gForget[elemID] = document.getElementById(elemID);</span>
<a href="#l3.2269"></a><span id="l3.2269" class="difflineplus">+      gForget[elemID].hidden = false;</span>
<a href="#l3.2270"></a><span id="l3.2270" class="difflineplus">+      gForget[elemID].checked = false;</span>
<a href="#l3.2271"></a><span id="l3.2271" class="difflineplus">+      let labelID = elemID + &quot;Label&quot;;</span>
<a href="#l3.2272"></a><span id="l3.2272" class="difflineplus">+      gForget[labelID] = document.getElementById(labelID);</span>
<a href="#l3.2273"></a><span id="l3.2273" class="difflineplus">+      gForget[labelID].hidden = true;</span>
<a href="#l3.2274"></a><span id="l3.2274" class="difflineplus">+    });</span>
<a href="#l3.2275"></a><span id="l3.2275" class="difflineplus">+    this.forgetButton = document.getElementById(&quot;forgetButton&quot;);</span>
<a href="#l3.2276"></a><span id="l3.2276" class="difflineplus">+    this.forgetButton.hidden = false;</span>
<a href="#l3.2277"></a><span id="l3.2277" class="difflineplus">+</span>
<a href="#l3.2278"></a><span id="l3.2278" class="difflineplus">+    if (gDomains.selectedDomain.title == &quot;*&quot;)</span>
<a href="#l3.2279"></a><span id="l3.2279" class="difflineplus">+      this.forgetDesc.value = gDataman.bundle.getString(&quot;forget.desc.global.pre&quot;);</span>
<a href="#l3.2280"></a><span id="l3.2280" class="difflineplus">+    else</span>
<a href="#l3.2281"></a><span id="l3.2281" class="difflineplus">+      this.forgetDesc.value = gDataman.bundle.getFormattedString(&quot;forget.desc.domain.pre&quot;,</span>
<a href="#l3.2282"></a><span id="l3.2282" class="difflineplus">+                                                                 [gDomains.selectedDomain.title]);</span>
<a href="#l3.2283"></a><span id="l3.2283" class="difflineplus">+</span>
<a href="#l3.2284"></a><span id="l3.2284" class="difflineplus">+    this.forgetCookies.disabled = !gDomains.selectedDomain.hasCookies;</span>
<a href="#l3.2285"></a><span id="l3.2285" class="difflineplus">+    this.forgetPermissions.disabled = !gDomains.selectedDomain.hasPermissions;</span>
<a href="#l3.2286"></a><span id="l3.2286" class="difflineplus">+    this.forgetPreferences.disabled = !gDomains.selectedDomain.hasPreferences;</span>
<a href="#l3.2287"></a><span id="l3.2287" class="difflineplus">+    this.forgetPasswords.disabled = !gDomains.selectedDomain.hasPasswords;</span>
<a href="#l3.2288"></a><span id="l3.2288" class="difflineplus">+    this.forgetFormdata.disabled = !gDomains.selectedDomain.hasFormData;</span>
<a href="#l3.2289"></a><span id="l3.2289" class="difflineplus">+    this.forgetFormdata.hidden = !gDomains.selectedDomain.hasFormData;</span>
<a href="#l3.2290"></a><span id="l3.2290" class="difflineplus">+    this.updateOptions();</span>
<a href="#l3.2291"></a><span id="l3.2291" class="difflineplus">+  },</span>
<a href="#l3.2292"></a><span id="l3.2292" class="difflineplus">+</span>
<a href="#l3.2293"></a><span id="l3.2293" class="difflineplus">+  shutdown: function forget_shutdown() {</span>
<a href="#l3.2294"></a><span id="l3.2294" class="difflineplus">+    gDataman.debugMsg(&quot;Shutting down forget panel&quot;);</span>
<a href="#l3.2295"></a><span id="l3.2295" class="difflineplus">+  },</span>
<a href="#l3.2296"></a><span id="l3.2296" class="difflineplus">+</span>
<a href="#l3.2297"></a><span id="l3.2297" class="difflineplus">+  updateOptions: function forget_updateOptions() {</span>
<a href="#l3.2298"></a><span id="l3.2298" class="difflineplus">+    this.forgetButton.disabled = !(this.forgetCookies.checked ||</span>
<a href="#l3.2299"></a><span id="l3.2299" class="difflineplus">+                                   this.forgetPermissions.checked ||</span>
<a href="#l3.2300"></a><span id="l3.2300" class="difflineplus">+                                   this.forgetPreferences.checked ||</span>
<a href="#l3.2301"></a><span id="l3.2301" class="difflineplus">+                                   this.forgetPasswords.checked ||</span>
<a href="#l3.2302"></a><span id="l3.2302" class="difflineplus">+                                   this.forgetFormdata.checked);</span>
<a href="#l3.2303"></a><span id="l3.2303" class="difflineplus">+  },</span>
<a href="#l3.2304"></a><span id="l3.2304" class="difflineplus">+</span>
<a href="#l3.2305"></a><span id="l3.2305" class="difflineplus">+  forget: function forget_forget() {</span>
<a href="#l3.2306"></a><span id="l3.2306" class="difflineplus">+    // Domain might get removed and selected domain changed!</span>
<a href="#l3.2307"></a><span id="l3.2307" class="difflineplus">+    let delDomainTitle = gDomains.selectedDomain.title;</span>
<a href="#l3.2308"></a><span id="l3.2308" class="difflineplus">+</span>
<a href="#l3.2309"></a><span id="l3.2309" class="difflineplus">+    if (this.forgetCookies.checked) {</span>
<a href="#l3.2310"></a><span id="l3.2310" class="difflineplus">+      gCookies.forget();</span>
<a href="#l3.2311"></a><span id="l3.2311" class="difflineplus">+      this.forgetCookiesLabel.hidden = false;</span>
<a href="#l3.2312"></a><span id="l3.2312" class="difflineplus">+    }</span>
<a href="#l3.2313"></a><span id="l3.2313" class="difflineplus">+    this.forgetCookies.hidden = true;</span>
<a href="#l3.2314"></a><span id="l3.2314" class="difflineplus">+</span>
<a href="#l3.2315"></a><span id="l3.2315" class="difflineplus">+    if (this.forgetPermissions.checked) {</span>
<a href="#l3.2316"></a><span id="l3.2316" class="difflineplus">+      gPerms.forget();</span>
<a href="#l3.2317"></a><span id="l3.2317" class="difflineplus">+      this.forgetPermissionsLabel.hidden = false;</span>
<a href="#l3.2318"></a><span id="l3.2318" class="difflineplus">+    }</span>
<a href="#l3.2319"></a><span id="l3.2319" class="difflineplus">+    this.forgetPermissions.hidden = true;</span>
<a href="#l3.2320"></a><span id="l3.2320" class="difflineplus">+</span>
<a href="#l3.2321"></a><span id="l3.2321" class="difflineplus">+    if (this.forgetPreferences.checked) {</span>
<a href="#l3.2322"></a><span id="l3.2322" class="difflineplus">+      gPrefs.forget();</span>
<a href="#l3.2323"></a><span id="l3.2323" class="difflineplus">+      this.forgetPreferencesLabel.hidden = false;</span>
<a href="#l3.2324"></a><span id="l3.2324" class="difflineplus">+    }</span>
<a href="#l3.2325"></a><span id="l3.2325" class="difflineplus">+    this.forgetPreferences.hidden = true;</span>
<a href="#l3.2326"></a><span id="l3.2326" class="difflineplus">+</span>
<a href="#l3.2327"></a><span id="l3.2327" class="difflineplus">+    if (this.forgetPasswords.checked) {</span>
<a href="#l3.2328"></a><span id="l3.2328" class="difflineplus">+      gPasswords.forget();</span>
<a href="#l3.2329"></a><span id="l3.2329" class="difflineplus">+      this.forgetPasswordsLabel.hidden = false;</span>
<a href="#l3.2330"></a><span id="l3.2330" class="difflineplus">+    }</span>
<a href="#l3.2331"></a><span id="l3.2331" class="difflineplus">+    this.forgetPasswords.hidden = true;</span>
<a href="#l3.2332"></a><span id="l3.2332" class="difflineplus">+</span>
<a href="#l3.2333"></a><span id="l3.2333" class="difflineplus">+    if (this.forgetFormdata.checked) {</span>
<a href="#l3.2334"></a><span id="l3.2334" class="difflineplus">+      gFormdata.forget();</span>
<a href="#l3.2335"></a><span id="l3.2335" class="difflineplus">+      this.forgetFormdataLabel.hidden = false;</span>
<a href="#l3.2336"></a><span id="l3.2336" class="difflineplus">+    }</span>
<a href="#l3.2337"></a><span id="l3.2337" class="difflineplus">+    this.forgetFormdata.hidden = true;</span>
<a href="#l3.2338"></a><span id="l3.2338" class="difflineplus">+</span>
<a href="#l3.2339"></a><span id="l3.2339" class="difflineplus">+    if (delDomainTitle == &quot;*&quot;)</span>
<a href="#l3.2340"></a><span id="l3.2340" class="difflineplus">+      this.forgetDesc.value = gDataman.bundle.getString(&quot;forget.desc.global.post&quot;);</span>
<a href="#l3.2341"></a><span id="l3.2341" class="difflineplus">+    else</span>
<a href="#l3.2342"></a><span id="l3.2342" class="difflineplus">+      this.forgetDesc.value = gDataman.bundle.getFormattedString(&quot;forget.desc.domain.post&quot;,</span>
<a href="#l3.2343"></a><span id="l3.2343" class="difflineplus">+                                                                 [delDomainTitle]);</span>
<a href="#l3.2344"></a><span id="l3.2344" class="difflineplus">+    this.forgetButton.hidden = true;</span>
<a href="#l3.2345"></a><span id="l3.2345" class="difflineplus">+  },</span>
<a href="#l3.2346"></a><span id="l3.2346" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1">new file mode 100644</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineminus">--- /dev/null</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineplus">+++ b/suite/common/dataman/dataman.xml</span>
<a href="#l4.4"></a><span id="l4.4" class="difflineat">@@ -0,0 +1,244 @@</span>
<a href="#l4.5"></a><span id="l4.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l4.6"></a><span id="l4.6" class="difflineplus">+&lt;!-- ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l4.7"></a><span id="l4.7" class="difflineplus">+   - Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l4.8"></a><span id="l4.8" class="difflineplus">+   -</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineplus">+   - The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l4.10"></a><span id="l4.10" class="difflineplus">+   - 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineplus">+   - the License. You may obtain a copy of the License at</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+   - http://www.mozilla.org/MPL/</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+   -</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+   - Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+   - WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+   - for the specific language governing rights and limitations under the</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+   - License.</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+   -</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+   - The Original Code is KaiRo's data manager.</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+   -</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+   - The Initial Developer of the Original Code is</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+   - Robert Kaiser &lt;kairo@kairo.at&gt;.</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+   - Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineplus">+   - the Initial Developer. All Rights Reserved.</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+   -</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineplus">+   - Contributor(s):</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineplus">+   -   Robert Kaiser &lt;kairo@kairo.at&gt; (original author)</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+   -</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+   - Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+   - either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+   - the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+   - in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+   - of those above. If you wish to allow use of your version of this file only</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+   - under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+   - use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+   - decision by deleting the provisions above and replace them with the notice</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+   - and other provisions required by the LGPL or the GPL. If you do not delete</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+   - the provisions above, a recipient may use your version of this file under</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+   - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+   -</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+   - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+&lt;!DOCTYPE bindings [</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+&lt;!ENTITY % datamanDTD SYSTEM &quot;chrome://communicator/locale/dataman/dataman.dtd&quot;&gt;</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+%datamanDTD;</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineplus">+]&gt;</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineplus">+</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+&lt;bindings id=&quot;datamanBindings&quot;</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineplus">+          xmlns=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineplus">+          xmlns:xul=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+          xmlns:xbl=&quot;http://www.mozilla.org/xbl&quot;&gt;</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineplus">+</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineplus">+  &lt;binding id=&quot;perm-base-item&quot;</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineplus">+           extends=&quot;chrome://global/content/bindings/richlistbox.xml#richlistitem&quot;&gt;</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineplus">+    &lt;implementation&gt;</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineplus">+      &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineplus">+        var permLabel = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;,</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineplus">+                                                                &quot;permLabel&quot;);</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineplus">+        try {</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineplus">+          permLabel.value = gDataman.bundle.getString(&quot;perm.&quot; + this.type + &quot;.label&quot;);</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineplus">+        }</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineplus">+        catch (e) {</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineplus">+          permLabel.value = this.type;</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineplus">+        }</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineplus">+        this._updateRadio();</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineplus">+      ]]&gt;&lt;/constructor&gt;</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineplus">+</span>
<a href="#l4.68"></a><span id="l4.68" class="difflineplus">+      &lt;property name=&quot;capability&quot;&gt;</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineplus">+        &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineplus">+          if (this.hasAttribute(&quot;capability&quot;))</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineplus">+            return this.getAttribute(&quot;capability&quot;);</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineplus">+          return -1;</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineplus">+        ]]&gt;&lt;/getter&gt;</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineplus">+        &lt;setter&gt;&lt;![CDATA[</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineplus">+          this.setAttribute(&quot;capability&quot;, val);</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineplus">+          this._updateRadio();</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineplus">+        ]]&gt;&lt;/setter&gt;</span>
<a href="#l4.78"></a><span id="l4.78" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l4.79"></a><span id="l4.79" class="difflineplus">+</span>
<a href="#l4.80"></a><span id="l4.80" class="difflineplus">+      &lt;property name=&quot;host&quot; readonly=&quot;true&quot;</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineplus">+                onget=&quot;return this.getAttribute('host');&quot;/&gt;</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineplus">+</span>
<a href="#l4.83"></a><span id="l4.83" class="difflineplus">+      &lt;property name=&quot;type&quot; readonly=&quot;true&quot;</span>
<a href="#l4.84"></a><span id="l4.84" class="difflineplus">+                onget=&quot;return this.getAttribute('type');&quot;/&gt;</span>
<a href="#l4.85"></a><span id="l4.85" class="difflineplus">+</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineplus">+      &lt;method name=&quot;_updateRadio&quot;&gt;</span>
<a href="#l4.87"></a><span id="l4.87" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l4.88"></a><span id="l4.88" class="difflineplus">+          let radio = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;,</span>
<a href="#l4.89"></a><span id="l4.89" class="difflineplus">+                                                              &quot;permSetting-&quot; + this.capability);</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineplus">+          if (radio)</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineplus">+            radio.radioGroup.selectedItem = radio;</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineplus">+          else {</span>
<a href="#l4.93"></a><span id="l4.93" class="difflineplus">+            let radioGroup = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;,</span>
<a href="#l4.94"></a><span id="l4.94" class="difflineplus">+                                                                     &quot;radioGroup&quot;);</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineplus">+            radioGroup.selectedIndex = -1;</span>
<a href="#l4.96"></a><span id="l4.96" class="difflineplus">+          }</span>
<a href="#l4.97"></a><span id="l4.97" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l4.98"></a><span id="l4.98" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l4.99"></a><span id="l4.99" class="difflineplus">+</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineplus">+      &lt;method name=&quot;useDefault&quot;&gt;</span>
<a href="#l4.101"></a><span id="l4.101" class="difflineplus">+        &lt;parameter name=&quot;aChecked&quot;/&gt;</span>
<a href="#l4.102"></a><span id="l4.102" class="difflineplus">+        &lt;parameter name=&quot;aUIUpdateOnly&quot;/&gt;</span>
<a href="#l4.103"></a><span id="l4.103" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l4.104"></a><span id="l4.104" class="difflineplus">+          let checkbox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;,</span>
<a href="#l4.105"></a><span id="l4.105" class="difflineplus">+                                                                 &quot;useDefault&quot;);</span>
<a href="#l4.106"></a><span id="l4.106" class="difflineplus">+          if (checkbox.checked != aChecked)</span>
<a href="#l4.107"></a><span id="l4.107" class="difflineplus">+            checkbox.checked = aChecked;</span>
<a href="#l4.108"></a><span id="l4.108" class="difflineplus">+          let radioGroup = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;,</span>
<a href="#l4.109"></a><span id="l4.109" class="difflineplus">+                                                                   &quot;radioGroup&quot;);</span>
<a href="#l4.110"></a><span id="l4.110" class="difflineplus">+          radioGroup.disabled = aChecked;</span>
<a href="#l4.111"></a><span id="l4.111" class="difflineplus">+          if (aChecked) {</span>
<a href="#l4.112"></a><span id="l4.112" class="difflineplus">+            if (!aUIUpdateOnly)</span>
<a href="#l4.113"></a><span id="l4.113" class="difflineplus">+              Services.perms.remove(this.host, this.type);</span>
<a href="#l4.114"></a><span id="l4.114" class="difflineplus">+            this.capability = gPerms.getDefault(this.type);</span>
<a href="#l4.115"></a><span id="l4.115" class="difflineplus">+          }</span>
<a href="#l4.116"></a><span id="l4.116" class="difflineplus">+          this._updateRadio();</span>
<a href="#l4.117"></a><span id="l4.117" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l4.118"></a><span id="l4.118" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l4.119"></a><span id="l4.119" class="difflineplus">+</span>
<a href="#l4.120"></a><span id="l4.120" class="difflineplus">+      &lt;method name=&quot;setCapability&quot;&gt;</span>
<a href="#l4.121"></a><span id="l4.121" class="difflineplus">+        &lt;parameter name=&quot;aValue&quot;/&gt;</span>
<a href="#l4.122"></a><span id="l4.122" class="difflineplus">+        &lt;parameter name=&quot;aUIUpdateOnly&quot;/&gt;</span>
<a href="#l4.123"></a><span id="l4.123" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l4.124"></a><span id="l4.124" class="difflineplus">+          this.capability = aValue;</span>
<a href="#l4.125"></a><span id="l4.125" class="difflineplus">+          let radio = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;,</span>
<a href="#l4.126"></a><span id="l4.126" class="difflineplus">+                                                              &quot;permSetting-&quot; + aValue);</span>
<a href="#l4.127"></a><span id="l4.127" class="difflineplus">+          if (radio &amp;&amp; !radio.selected)</span>
<a href="#l4.128"></a><span id="l4.128" class="difflineplus">+            radio.radioGroup.selectedItem = radio;</span>
<a href="#l4.129"></a><span id="l4.129" class="difflineplus">+          if (!aUIUpdateOnly)</span>
<a href="#l4.130"></a><span id="l4.130" class="difflineplus">+            Services.perms.add(Services.io.newURI(&quot;http://&quot; + this.host, null, null),</span>
<a href="#l4.131"></a><span id="l4.131" class="difflineplus">+                               this.type, aValue);</span>
<a href="#l4.132"></a><span id="l4.132" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l4.133"></a><span id="l4.133" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l4.134"></a><span id="l4.134" class="difflineplus">+</span>
<a href="#l4.135"></a><span id="l4.135" class="difflineplus">+    &lt;/implementation&gt;</span>
<a href="#l4.136"></a><span id="l4.136" class="difflineplus">+  &lt;/binding&gt;</span>
<a href="#l4.137"></a><span id="l4.137" class="difflineplus">+</span>
<a href="#l4.138"></a><span id="l4.138" class="difflineplus">+  &lt;binding id=&quot;perm-generic-item&quot;</span>
<a href="#l4.139"></a><span id="l4.139" class="difflineplus">+           extends=&quot;chrome://communicator/content/dataman/dataman.xml#perm-base-item&quot;&gt;</span>
<a href="#l4.140"></a><span id="l4.140" class="difflineplus">+    &lt;content&gt;</span>
<a href="#l4.141"></a><span id="l4.141" class="difflineplus">+      &lt;xul:hbox&gt;</span>
<a href="#l4.142"></a><span id="l4.142" class="difflineplus">+        &lt;xul:label anonid=&quot;permHost&quot; class=&quot;hostLabel&quot; xbl:inherits=&quot;value=rawHost&quot;/&gt;</span>
<a href="#l4.143"></a><span id="l4.143" class="difflineplus">+        &lt;xul:label anonid=&quot;permLabel&quot; class=&quot;permissionLabel&quot; control=&quot;radioGroup&quot;/&gt;</span>
<a href="#l4.144"></a><span id="l4.144" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l4.145"></a><span id="l4.145" class="difflineplus">+      &lt;xul:hbox role=&quot;group&quot; aria-labelledby=&quot;permLabel&quot;&gt;</span>
<a href="#l4.146"></a><span id="l4.146" class="difflineplus">+        &lt;xul:checkbox class=&quot;indent&quot; anonid=&quot;useDefault&quot; label=&quot;&amp;perm.UseDefault;&quot;</span>
<a href="#l4.147"></a><span id="l4.147" class="difflineplus">+                      oncommand=&quot;document.getBindingParent(this).useDefault(this.checked);&quot;/&gt;</span>
<a href="#l4.148"></a><span id="l4.148" class="difflineplus">+        &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l4.149"></a><span id="l4.149" class="difflineplus">+        &lt;xul:radiogroup anonid=&quot;radioGroup&quot; orient=&quot;horizontal&quot;&gt;</span>
<a href="#l4.150"></a><span id="l4.150" class="difflineplus">+          &lt;xul:radio anonid=&quot;permSetting-1&quot; label=&quot;&amp;perm.Allow;&quot;</span>
<a href="#l4.151"></a><span id="l4.151" class="difflineplus">+                     oncommand=&quot;document.getBindingParent(this).setCapability(Services.perms.ALLOW_ACTION);&quot;/&gt;</span>
<a href="#l4.152"></a><span id="l4.152" class="difflineplus">+          &lt;xul:radio anonid=&quot;permSetting-2&quot; label=&quot;&amp;perm.Block;&quot;</span>
<a href="#l4.153"></a><span id="l4.153" class="difflineplus">+                     oncommand=&quot;document.getBindingParent(this).setCapability(Services.perms.DENY_ACTION);&quot;/&gt;</span>
<a href="#l4.154"></a><span id="l4.154" class="difflineplus">+        &lt;/xul:radiogroup&gt;</span>
<a href="#l4.155"></a><span id="l4.155" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l4.156"></a><span id="l4.156" class="difflineplus">+    &lt;/content&gt;</span>
<a href="#l4.157"></a><span id="l4.157" class="difflineplus">+  &lt;/binding&gt;</span>
<a href="#l4.158"></a><span id="l4.158" class="difflineplus">+</span>
<a href="#l4.159"></a><span id="l4.159" class="difflineplus">+  &lt;binding id=&quot;perm-cookie-item&quot;</span>
<a href="#l4.160"></a><span id="l4.160" class="difflineplus">+           extends=&quot;chrome://communicator/content/dataman/dataman.xml#perm-base-item&quot;&gt;</span>
<a href="#l4.161"></a><span id="l4.161" class="difflineplus">+    &lt;content&gt;</span>
<a href="#l4.162"></a><span id="l4.162" class="difflineplus">+      &lt;xul:hbox&gt;</span>
<a href="#l4.163"></a><span id="l4.163" class="difflineplus">+        &lt;xul:label anonid=&quot;permHost&quot; class=&quot;hostLabel&quot; xbl:inherits=&quot;value=rawHost&quot;/&gt;</span>
<a href="#l4.164"></a><span id="l4.164" class="difflineplus">+        &lt;xul:label anonid=&quot;permLabel&quot; class=&quot;permissionLabel&quot; control=&quot;radioGroup&quot;/&gt;</span>
<a href="#l4.165"></a><span id="l4.165" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l4.166"></a><span id="l4.166" class="difflineplus">+      &lt;xul:hbox role=&quot;group&quot; aria-labelledby=&quot;permLabel&quot;&gt;</span>
<a href="#l4.167"></a><span id="l4.167" class="difflineplus">+        &lt;xul:checkbox class=&quot;indent&quot; anonid=&quot;useDefault&quot; label=&quot;&amp;perm.UseDefault;&quot;</span>
<a href="#l4.168"></a><span id="l4.168" class="difflineplus">+                      oncommand=&quot;document.getBindingParent(this).useDefault(this.checked);&quot;/&gt;</span>
<a href="#l4.169"></a><span id="l4.169" class="difflineplus">+        &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l4.170"></a><span id="l4.170" class="difflineplus">+        &lt;xul:radiogroup anonid=&quot;radioGroup&quot; orient=&quot;horizontal&quot;&gt;</span>
<a href="#l4.171"></a><span id="l4.171" class="difflineplus">+          &lt;xul:radio anonid=&quot;permSetting-1&quot; label=&quot;&amp;perm.Allow;&quot;</span>
<a href="#l4.172"></a><span id="l4.172" class="difflineplus">+                     oncommand=&quot;document.getBindingParent(this).setCapability(Services.perms.ALLOW_ACTION);&quot;/&gt;</span>
<a href="#l4.173"></a><span id="l4.173" class="difflineplus">+          &lt;xul:radio anonid=&quot;permSetting-8&quot; label=&quot;&amp;perm.AllowSession;&quot;</span>
<a href="#l4.174"></a><span id="l4.174" class="difflineplus">+                     oncommand=&quot;document.getBindingParent(this).setCapability(Components.interfaces.nsICookiePermission.ACCESS_SESSION);&quot;/&gt;</span>
<a href="#l4.175"></a><span id="l4.175" class="difflineplus">+          &lt;xul:radio anonid=&quot;permSetting-2&quot; label=&quot;&amp;perm.Block;&quot;</span>
<a href="#l4.176"></a><span id="l4.176" class="difflineplus">+                     oncommand=&quot;document.getBindingParent(this).setCapability(Services.perms.DENY_ACTION);&quot;/&gt;</span>
<a href="#l4.177"></a><span id="l4.177" class="difflineplus">+        &lt;/xul:radiogroup&gt;</span>
<a href="#l4.178"></a><span id="l4.178" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l4.179"></a><span id="l4.179" class="difflineplus">+    &lt;/content&gt;</span>
<a href="#l4.180"></a><span id="l4.180" class="difflineplus">+  &lt;/binding&gt;</span>
<a href="#l4.181"></a><span id="l4.181" class="difflineplus">+</span>
<a href="#l4.182"></a><span id="l4.182" class="difflineplus">+  &lt;binding id=&quot;perm-geo-item&quot;</span>
<a href="#l4.183"></a><span id="l4.183" class="difflineplus">+           extends=&quot;chrome://communicator/content/dataman/dataman.xml#perm-base-item&quot;&gt;</span>
<a href="#l4.184"></a><span id="l4.184" class="difflineplus">+    &lt;content&gt;</span>
<a href="#l4.185"></a><span id="l4.185" class="difflineplus">+      &lt;xul:hbox&gt;</span>
<a href="#l4.186"></a><span id="l4.186" class="difflineplus">+        &lt;xul:label anonid=&quot;permHost&quot; class=&quot;hostLabel&quot; xbl:inherits=&quot;value=rawHost&quot;/&gt;</span>
<a href="#l4.187"></a><span id="l4.187" class="difflineplus">+        &lt;xul:label anonid=&quot;permLabel&quot; class=&quot;permissionLabel&quot; control=&quot;radioGroup&quot;/&gt;</span>
<a href="#l4.188"></a><span id="l4.188" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l4.189"></a><span id="l4.189" class="difflineplus">+      &lt;xul:hbox role=&quot;group&quot; aria-labelledby=&quot;permLabel&quot;&gt;</span>
<a href="#l4.190"></a><span id="l4.190" class="difflineplus">+        &lt;xul:checkbox class=&quot;indent&quot; anonid=&quot;useDefault&quot; label=&quot;&amp;perm.AskAlways;&quot;</span>
<a href="#l4.191"></a><span id="l4.191" class="difflineplus">+                      oncommand=&quot;document.getBindingParent(this).useDefault(this.checked);&quot;/&gt;</span>
<a href="#l4.192"></a><span id="l4.192" class="difflineplus">+        &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l4.193"></a><span id="l4.193" class="difflineplus">+        &lt;xul:radiogroup anonid=&quot;radioGroup&quot; orient=&quot;horizontal&quot;&gt;</span>
<a href="#l4.194"></a><span id="l4.194" class="difflineplus">+          &lt;xul:radio anonid=&quot;permSetting-1&quot; label=&quot;&amp;perm.Allow;&quot;</span>
<a href="#l4.195"></a><span id="l4.195" class="difflineplus">+                     oncommand=&quot;document.getBindingParent(this).setCapability(Services.perms.ALLOW_ACTION);&quot;/&gt;</span>
<a href="#l4.196"></a><span id="l4.196" class="difflineplus">+          &lt;xul:radio anonid=&quot;permSetting-2&quot; label=&quot;&amp;perm.Block;&quot;</span>
<a href="#l4.197"></a><span id="l4.197" class="difflineplus">+                     oncommand=&quot;document.getBindingParent(this).setCapability(Services.perms.DENY_ACTION);&quot;/&gt;</span>
<a href="#l4.198"></a><span id="l4.198" class="difflineplus">+        &lt;/xul:radiogroup&gt;</span>
<a href="#l4.199"></a><span id="l4.199" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l4.200"></a><span id="l4.200" class="difflineplus">+    &lt;/content&gt;</span>
<a href="#l4.201"></a><span id="l4.201" class="difflineplus">+  &lt;/binding&gt;</span>
<a href="#l4.202"></a><span id="l4.202" class="difflineplus">+</span>
<a href="#l4.203"></a><span id="l4.203" class="difflineplus">+  &lt;binding id=&quot;perm-password-item&quot; extends=&quot;chrome://communicator/content/dataman/dataman.xml#perm-base-item&quot;&gt;</span>
<a href="#l4.204"></a><span id="l4.204" class="difflineplus">+    &lt;content&gt;</span>
<a href="#l4.205"></a><span id="l4.205" class="difflineplus">+      &lt;xul:hbox&gt;</span>
<a href="#l4.206"></a><span id="l4.206" class="difflineplus">+        &lt;xul:label anonid=&quot;permHost&quot; class=&quot;hostLabel&quot; xbl:inherits=&quot;value=rawHost&quot;/&gt;</span>
<a href="#l4.207"></a><span id="l4.207" class="difflineplus">+        &lt;xul:label anonid=&quot;permLabel&quot; class=&quot;permissionLabel&quot; control=&quot;radioGroup&quot;/&gt;</span>
<a href="#l4.208"></a><span id="l4.208" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l4.209"></a><span id="l4.209" class="difflineplus">+      &lt;xul:hbox role=&quot;group&quot; aria-labelledby=&quot;permLabel&quot;&gt;</span>
<a href="#l4.210"></a><span id="l4.210" class="difflineplus">+        &lt;xul:checkbox class=&quot;indent&quot; anonid=&quot;useDefault&quot; hidden=&quot;true&quot;/&gt;</span>
<a href="#l4.211"></a><span id="l4.211" class="difflineplus">+        &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l4.212"></a><span id="l4.212" class="difflineplus">+        &lt;xul:radiogroup anonid=&quot;radioGroup&quot; orient=&quot;horizontal&quot;&gt;</span>
<a href="#l4.213"></a><span id="l4.213" class="difflineplus">+          &lt;xul:radio anonid=&quot;permSetting-1&quot; label=&quot;&amp;perm.AskAlways;&quot;</span>
<a href="#l4.214"></a><span id="l4.214" class="difflineplus">+                     oncommand=&quot;document.getBindingParent(this).setCapability(Services.perms.ALLOW_ACTION);&quot;/&gt;</span>
<a href="#l4.215"></a><span id="l4.215" class="difflineplus">+          &lt;xul:radio anonid=&quot;permSetting-2&quot; label=&quot;&amp;perm.NeverSave;&quot;</span>
<a href="#l4.216"></a><span id="l4.216" class="difflineplus">+                     oncommand=&quot;document.getBindingParent(this).setCapability(Services.perms.DENY_ACTION);&quot;/&gt;</span>
<a href="#l4.217"></a><span id="l4.217" class="difflineplus">+        &lt;/xul:radiogroup&gt;</span>
<a href="#l4.218"></a><span id="l4.218" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l4.219"></a><span id="l4.219" class="difflineplus">+    &lt;/content&gt;</span>
<a href="#l4.220"></a><span id="l4.220" class="difflineplus">+</span>
<a href="#l4.221"></a><span id="l4.221" class="difflineplus">+    &lt;implementation&gt;</span>
<a href="#l4.222"></a><span id="l4.222" class="difflineplus">+      &lt;method name=&quot;useDefault&quot;&gt;</span>
<a href="#l4.223"></a><span id="l4.223" class="difflineplus">+        &lt;parameter name=&quot;aChecked&quot;/&gt;</span>
<a href="#l4.224"></a><span id="l4.224" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l4.225"></a><span id="l4.225" class="difflineplus">+          // just for compat, makes it easier to generically &quot;delete&quot; perms</span>
<a href="#l4.226"></a><span id="l4.226" class="difflineplus">+          if (aChecked)</span>
<a href="#l4.227"></a><span id="l4.227" class="difflineplus">+            this.setCapability(Services.perms.ALLOW_ACTION);</span>
<a href="#l4.228"></a><span id="l4.228" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l4.229"></a><span id="l4.229" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l4.230"></a><span id="l4.230" class="difflineplus">+</span>
<a href="#l4.231"></a><span id="l4.231" class="difflineplus">+      &lt;method name=&quot;setCapability&quot;&gt;</span>
<a href="#l4.232"></a><span id="l4.232" class="difflineplus">+        &lt;parameter name=&quot;aValue&quot;/&gt;</span>
<a href="#l4.233"></a><span id="l4.233" class="difflineplus">+        &lt;parameter name=&quot;aUIUpdateOnly&quot;/&gt;</span>
<a href="#l4.234"></a><span id="l4.234" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l4.235"></a><span id="l4.235" class="difflineplus">+          this.capability = aValue;</span>
<a href="#l4.236"></a><span id="l4.236" class="difflineplus">+          let radio = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;,</span>
<a href="#l4.237"></a><span id="l4.237" class="difflineplus">+                                                              &quot;permSetting-&quot; + aValue);</span>
<a href="#l4.238"></a><span id="l4.238" class="difflineplus">+          if (radio &amp;&amp; !radio.selected)</span>
<a href="#l4.239"></a><span id="l4.239" class="difflineplus">+            radio.radioGroup.selectedItem = radio;</span>
<a href="#l4.240"></a><span id="l4.240" class="difflineplus">+          if (!aUIUpdateOnly)</span>
<a href="#l4.241"></a><span id="l4.241" class="difflineplus">+            gLocSvc.pwd.setLoginSavingEnabled(this.host,</span>
<a href="#l4.242"></a><span id="l4.242" class="difflineplus">+                                              aValue == Services.perms.ALLOW_ACTION);</span>
<a href="#l4.243"></a><span id="l4.243" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l4.244"></a><span id="l4.244" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l4.245"></a><span id="l4.245" class="difflineplus">+    &lt;/implementation&gt;</span>
<a href="#l4.246"></a><span id="l4.246" class="difflineplus">+  &lt;/binding&gt;</span>
<a href="#l4.247"></a><span id="l4.247" class="difflineplus">+</span>
<a href="#l4.248"></a><span id="l4.248" class="difflineplus">+&lt;/bindings&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1">new file mode 100644</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineminus">--- /dev/null</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineplus">+++ b/suite/common/dataman/dataman.xul</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineat">@@ -0,0 +1,486 @@</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l5.6"></a><span id="l5.6" class="difflineplus">+&lt;!-- ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l5.7"></a><span id="l5.7" class="difflineplus">+   - Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l5.8"></a><span id="l5.8" class="difflineplus">+   -</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineplus">+   - The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineplus">+   - 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+   - the License. You may obtain a copy of the License at</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+   - http://www.mozilla.org/MPL/</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+   -</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+   - Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+   - WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+   - for the specific language governing rights and limitations under the</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+   - License.</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+   -</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+   - The Original Code is KaiRo's data manager.</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+   -</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+   - The Initial Developer of the Original Code is</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+   - Robert Kaiser &lt;kairo@kairo.at&gt;.</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+   - Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineplus">+   - the Initial Developer. All Rights Reserved.</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+   -</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+   - Contributor(s):</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+   -   Robert Kaiser &lt;kairo@kairo.at&gt; (original author)</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineplus">+   -</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+   - Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+   - either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+   - the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+   - in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+   - of those above. If you wish to allow use of your version of this file only</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+   - under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+   - use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+   - decision by deleting the provisions above and replace them with the notice</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+   - and other provisions required by the LGPL or the GPL. If you do not delete</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+   - the provisions above, a recipient may use your version of this file under</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+   - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+   -</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+   - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://communicator/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://communicator/content/dataman/dataman.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://communicator/skin/dataman/dataman.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineplus">+</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineplus">+&lt;!DOCTYPE page [</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineplus">+&lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot;&gt;</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineplus">+%brandDTD;</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineplus">+&lt;!ENTITY % datamanDTD SYSTEM &quot;chrome://communicator/locale/dataman/dataman.dtd&quot;&gt;</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+%datamanDTD;</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineplus">+]&gt;</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineplus">+</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineplus">+&lt;page xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineplus">+      id=&quot;dataman-page&quot; title=&quot;&amp;dataman.windowTitle;&quot;</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineplus">+      onload=&quot;gDataman.initialize();&quot;</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineplus">+      onunload=&quot;gDataman.shutdown();&quot;&gt;</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineplus">+</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineplus">+          src=&quot;chrome://communicator/content/dataman/dataman.js&quot;/&gt;</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineplus">+</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineplus">+  &lt;stringbundleset id=&quot;datamanBundleSet&quot;&gt;</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineplus">+    &lt;stringbundle id=&quot;datamanBundle&quot;</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineplus">+                  src=&quot;chrome://communicator/locale/dataman/dataman.properties&quot;/&gt;</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineplus">+  &lt;/stringbundleset&gt;</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineplus">+</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineplus">+  &lt;commandset id=&quot;datamanCommands&quot;&gt;</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineplus">+    &lt;command id=&quot;cmd_selectAll&quot;</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineplus">+             oncommand=&quot;gTabs.selectAll();&quot;/&gt;</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineplus">+    &lt;command id=&quot;cmd_search_domain&quot;</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineplus">+             oncommand=&quot;gDomains.focusSearch();&quot;/&gt;</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineplus">+    &lt;command id=&quot;cmd_search_data&quot;</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineplus">+             oncommand=&quot;gTabs.focusSearch();&quot;/&gt;</span>
<a href="#l5.74"></a><span id="l5.74" class="difflineplus">+  &lt;/commandset&gt;</span>
<a href="#l5.75"></a><span id="l5.75" class="difflineplus">+</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineplus">+  &lt;keyset id=&quot;datamanKeys&quot;&gt;</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineplus">+    &lt;key id=&quot;key_selectAll&quot;</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineplus">+         command=&quot;cmd_selectAll&quot;</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineplus">+         key=&quot;&amp;selectAll.key;&quot;</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineplus">+         modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineplus">+    &lt;key id=&quot;key_search_domain&quot;</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineplus">+         command=&quot;cmd_search_domain&quot;</span>
<a href="#l5.83"></a><span id="l5.83" class="difflineplus">+         key=&quot;&amp;domain.search.key;&quot;</span>
<a href="#l5.84"></a><span id="l5.84" class="difflineplus">+         modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l5.85"></a><span id="l5.85" class="difflineplus">+    &lt;key id=&quot;key_search_data&quot;</span>
<a href="#l5.86"></a><span id="l5.86" class="difflineplus">+         command=&quot;cmd_search_data&quot;</span>
<a href="#l5.87"></a><span id="l5.87" class="difflineplus">+         key=&quot;&amp;data.search.key;&quot;</span>
<a href="#l5.88"></a><span id="l5.88" class="difflineplus">+         modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l5.89"></a><span id="l5.89" class="difflineplus">+  &lt;/keyset&gt;</span>
<a href="#l5.90"></a><span id="l5.90" class="difflineplus">+</span>
<a href="#l5.91"></a><span id="l5.91" class="difflineplus">+  &lt;popupset id=&quot;datamanContextSet&quot;&gt;</span>
<a href="#l5.92"></a><span id="l5.92" class="difflineplus">+    &lt;menupopup id=&quot;domainTreeContextMenu&quot;</span>
<a href="#l5.93"></a><span id="l5.93" class="difflineplus">+               onpopupshowing=&quot;gDomains.updateContext();&quot;&gt;</span>
<a href="#l5.94"></a><span id="l5.94" class="difflineplus">+      &lt;menuitem id=&quot;domain-context-forget&quot;</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineplus">+                label_domain=&quot;&amp;domain.ctx.forgetdomain.label;&quot;</span>
<a href="#l5.96"></a><span id="l5.96" class="difflineplus">+                accesskey_domain=&quot;&amp;domain.ctx.forgetdomain.accesskey;&quot;</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineplus">+                label_global=&quot;&amp;domain.ctx.forgetglobal.label;&quot;</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineplus">+                accesskey_global=&quot;&amp;domain.ctx.forgetglobal.accesskey;&quot;</span>
<a href="#l5.99"></a><span id="l5.99" class="difflineplus">+                oncommand=&quot;gDomains.forget();&quot;/&gt;</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineplus">+    &lt;/menupopup&gt;</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineplus">+</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineplus">+    &lt;menupopup id=&quot;cookiesTreeContextMenu&quot;</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineplus">+               onpopupshowing=&quot;gCookies.updateContext();&quot;&gt;</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineplus">+      &lt;menuitem id=&quot;cookies-context-remove&quot;</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineplus">+                label=&quot;&amp;cookies.ctx.remove.label;&quot;</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineplus">+                accesskey=&quot;&amp;cookies.ctx.remove.accesskey;&quot;</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineplus">+                oncommand=&quot;gCookies.delete();&quot;/&gt;</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineplus">+      &lt;menuitem id=&quot;cookies-context-selectall&quot;</span>
<a href="#l5.109"></a><span id="l5.109" class="difflineplus">+                label=&quot;&amp;cookies.ctx.selectAll.label;&quot;</span>
<a href="#l5.110"></a><span id="l5.110" class="difflineplus">+                accesskey=&quot;&amp;cookies.ctx.selectAll.accesskey;&quot;</span>
<a href="#l5.111"></a><span id="l5.111" class="difflineplus">+                oncommand=&quot;gCookies.selectAll();&quot;/&gt;</span>
<a href="#l5.112"></a><span id="l5.112" class="difflineplus">+    &lt;/menupopup&gt;</span>
<a href="#l5.113"></a><span id="l5.113" class="difflineplus">+</span>
<a href="#l5.114"></a><span id="l5.114" class="difflineplus">+    &lt;menupopup id=&quot;prefsTreeContextMenu&quot;</span>
<a href="#l5.115"></a><span id="l5.115" class="difflineplus">+               onpopupshowing=&quot;gPrefs.updateContext();&quot;&gt;</span>
<a href="#l5.116"></a><span id="l5.116" class="difflineplus">+      &lt;menuitem id=&quot;prefs-context-remove&quot;</span>
<a href="#l5.117"></a><span id="l5.117" class="difflineplus">+                label=&quot;&amp;prefs.ctx.remove.label;&quot;</span>
<a href="#l5.118"></a><span id="l5.118" class="difflineplus">+                accesskey=&quot;&amp;prefs.ctx.remove.accesskey;&quot;</span>
<a href="#l5.119"></a><span id="l5.119" class="difflineplus">+                oncommand=&quot;gPrefs.delete();&quot;/&gt;</span>
<a href="#l5.120"></a><span id="l5.120" class="difflineplus">+      &lt;menuitem id=&quot;prefs-context-selectall&quot;</span>
<a href="#l5.121"></a><span id="l5.121" class="difflineplus">+                label=&quot;&amp;prefs.ctx.selectAll.label;&quot;</span>
<a href="#l5.122"></a><span id="l5.122" class="difflineplus">+                accesskey=&quot;&amp;prefs.ctx.selectAll.accesskey;&quot;</span>
<a href="#l5.123"></a><span id="l5.123" class="difflineplus">+                oncommand=&quot;gPrefs.selectAll();&quot;/&gt;</span>
<a href="#l5.124"></a><span id="l5.124" class="difflineplus">+    &lt;/menupopup&gt;</span>
<a href="#l5.125"></a><span id="l5.125" class="difflineplus">+</span>
<a href="#l5.126"></a><span id="l5.126" class="difflineplus">+    &lt;menupopup id=&quot;passwordsTreeContextMenu&quot;</span>
<a href="#l5.127"></a><span id="l5.127" class="difflineplus">+               onpopupshowing=&quot;gPasswords.updateContext();&quot;&gt;</span>
<a href="#l5.128"></a><span id="l5.128" class="difflineplus">+      &lt;menuitem id=&quot;pwd-context-remove&quot;</span>
<a href="#l5.129"></a><span id="l5.129" class="difflineplus">+                label=&quot;&amp;pwd.ctx.remove.label;&quot;</span>
<a href="#l5.130"></a><span id="l5.130" class="difflineplus">+                accesskey=&quot;&amp;pwd.ctx.remove.accesskey;&quot;</span>
<a href="#l5.131"></a><span id="l5.131" class="difflineplus">+                oncommand=&quot;gPasswords.delete();&quot;/&gt;</span>
<a href="#l5.132"></a><span id="l5.132" class="difflineplus">+      &lt;menuitem id=&quot;pwd-context-copypassword&quot;</span>
<a href="#l5.133"></a><span id="l5.133" class="difflineplus">+                label=&quot;&amp;pwd.ctx.copyPasswordCmd.label;&quot;</span>
<a href="#l5.134"></a><span id="l5.134" class="difflineplus">+                accesskey=&quot;&amp;pwd.ctx.copyPasswordCmd.accesskey;&quot;</span>
<a href="#l5.135"></a><span id="l5.135" class="difflineplus">+                oncommand=&quot;gPasswords.copyPassword();&quot;/&gt;</span>
<a href="#l5.136"></a><span id="l5.136" class="difflineplus">+      &lt;menuitem id=&quot;pwd-context-selectall&quot;</span>
<a href="#l5.137"></a><span id="l5.137" class="difflineplus">+                label=&quot;&amp;pwd.ctx.selectAll.label;&quot;</span>
<a href="#l5.138"></a><span id="l5.138" class="difflineplus">+                accesskey=&quot;&amp;pwd.ctx.selectAll.accesskey;&quot;</span>
<a href="#l5.139"></a><span id="l5.139" class="difflineplus">+                oncommand=&quot;gPasswords.selectAll();&quot;/&gt;</span>
<a href="#l5.140"></a><span id="l5.140" class="difflineplus">+    &lt;/menupopup&gt;</span>
<a href="#l5.141"></a><span id="l5.141" class="difflineplus">+</span>
<a href="#l5.142"></a><span id="l5.142" class="difflineplus">+    &lt;menupopup id=&quot;formdataTreeContextMenu&quot;</span>
<a href="#l5.143"></a><span id="l5.143" class="difflineplus">+               onpopupshowing=&quot;gFormdata.updateContext();&quot;&gt;</span>
<a href="#l5.144"></a><span id="l5.144" class="difflineplus">+      &lt;menuitem id=&quot;fdata-context-remove&quot;</span>
<a href="#l5.145"></a><span id="l5.145" class="difflineplus">+                label=&quot;&amp;fdata.ctx.remove.label;&quot;</span>
<a href="#l5.146"></a><span id="l5.146" class="difflineplus">+                accesskey=&quot;&amp;fdata.ctx.remove.accesskey;&quot;</span>
<a href="#l5.147"></a><span id="l5.147" class="difflineplus">+                oncommand=&quot;gFormdata.delete();&quot;/&gt;</span>
<a href="#l5.148"></a><span id="l5.148" class="difflineplus">+      &lt;menuitem id=&quot;fdata-context-selectall&quot;</span>
<a href="#l5.149"></a><span id="l5.149" class="difflineplus">+                label=&quot;&amp;fdata.ctx.selectAll.label;&quot;</span>
<a href="#l5.150"></a><span id="l5.150" class="difflineplus">+                accesskey=&quot;&amp;fdata.ctx.selectAll.accesskey;&quot;</span>
<a href="#l5.151"></a><span id="l5.151" class="difflineplus">+                oncommand=&quot;gFormdata.selectAll();&quot;/&gt;</span>
<a href="#l5.152"></a><span id="l5.152" class="difflineplus">+    &lt;/menupopup&gt;</span>
<a href="#l5.153"></a><span id="l5.153" class="difflineplus">+  &lt;/popupset&gt;</span>
<a href="#l5.154"></a><span id="l5.154" class="difflineplus">+</span>
<a href="#l5.155"></a><span id="l5.155" class="difflineplus">+  &lt;hbox flex=&quot;1&quot;&gt;</span>
<a href="#l5.156"></a><span id="l5.156" class="difflineplus">+    &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l5.157"></a><span id="l5.157" class="difflineplus">+      &lt;textbox id=&quot;domainSearch&quot;</span>
<a href="#l5.158"></a><span id="l5.158" class="difflineplus">+               clickSelectsAll=&quot;true&quot;</span>
<a href="#l5.159"></a><span id="l5.159" class="difflineplus">+               type=&quot;search&quot;</span>
<a href="#l5.160"></a><span id="l5.160" class="difflineplus">+               class=&quot;compact&quot;</span>
<a href="#l5.161"></a><span id="l5.161" class="difflineplus">+               placeholder=&quot;&amp;domain.search.placeholder;&quot;</span>
<a href="#l5.162"></a><span id="l5.162" class="difflineplus">+               oncommand=&quot;gDomains.search(this.value);&quot;/&gt;</span>
<a href="#l5.163"></a><span id="l5.163" class="difflineplus">+      &lt;tree id=&quot;domainTree&quot;</span>
<a href="#l5.164"></a><span id="l5.164" class="difflineplus">+            seltype=&quot;single&quot;</span>
<a href="#l5.165"></a><span id="l5.165" class="difflineplus">+            flex=&quot;1&quot;</span>
<a href="#l5.166"></a><span id="l5.166" class="difflineplus">+            hidecolumnpicker=&quot;true&quot;</span>
<a href="#l5.167"></a><span id="l5.167" class="difflineplus">+            onkeypress=&quot;gDomains.handleKeyPress(event);&quot;</span>
<a href="#l5.168"></a><span id="l5.168" class="difflineplus">+            onselect=&quot;gDomains.select();&quot;</span>
<a href="#l5.169"></a><span id="l5.169" class="difflineplus">+            context=&quot;domainTreeContextMenu&quot;&gt;</span>
<a href="#l5.170"></a><span id="l5.170" class="difflineplus">+        &lt;treecols&gt;</span>
<a href="#l5.171"></a><span id="l5.171" class="difflineplus">+          &lt;treecol id=&quot;domainCol&quot;</span>
<a href="#l5.172"></a><span id="l5.172" class="difflineplus">+                   label=&quot;&amp;domain.tree.domain.label;&quot;</span>
<a href="#l5.173"></a><span id="l5.173" class="difflineplus">+                   flex=&quot;1&quot;</span>
<a href="#l5.174"></a><span id="l5.174" class="difflineplus">+                   sortDirection=&quot;ascending&quot;/&gt;</span>
<a href="#l5.175"></a><span id="l5.175" class="difflineplus">+        &lt;/treecols&gt;</span>
<a href="#l5.176"></a><span id="l5.176" class="difflineplus">+        &lt;treechildren/&gt;</span>
<a href="#l5.177"></a><span id="l5.177" class="difflineplus">+      &lt;/tree&gt;</span>
<a href="#l5.178"></a><span id="l5.178" class="difflineplus">+    &lt;/vbox&gt;</span>
<a href="#l5.179"></a><span id="l5.179" class="difflineplus">+</span>
<a href="#l5.180"></a><span id="l5.180" class="difflineplus">+    &lt;splitter/&gt;</span>
<a href="#l5.181"></a><span id="l5.181" class="difflineplus">+</span>
<a href="#l5.182"></a><span id="l5.182" class="difflineplus">+    &lt;tabbox id=&quot;tabbox&quot; flex=&quot;6&quot;&gt;</span>
<a href="#l5.183"></a><span id="l5.183" class="difflineplus">+      &lt;tabs onselect=&quot;gTabs.select();&quot;&gt;</span>
<a href="#l5.184"></a><span id="l5.184" class="difflineplus">+        &lt;tab id=&quot;cookiesTab&quot; label=&quot;&amp;tab.cookies.label;&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l5.185"></a><span id="l5.185" class="difflineplus">+        &lt;tab id=&quot;permissionsTab&quot; label=&quot;&amp;tab.permissions.label;&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l5.186"></a><span id="l5.186" class="difflineplus">+        &lt;tab id=&quot;preferencesTab&quot; label=&quot;&amp;tab.preferences.label;&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l5.187"></a><span id="l5.187" class="difflineplus">+        &lt;tab id=&quot;passwordsTab&quot; label=&quot;&amp;tab.passwords.label;&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l5.188"></a><span id="l5.188" class="difflineplus">+        &lt;tab id=&quot;formdataTab&quot; label=&quot;&amp;tab.formdata.label;&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l5.189"></a><span id="l5.189" class="difflineplus">+        &lt;tab id=&quot;forgetTab&quot; label=&quot;&amp;tab.forget.label;&quot; hidden=&quot;true&quot;/&gt;</span>
<a href="#l5.190"></a><span id="l5.190" class="difflineplus">+      &lt;/tabs&gt;</span>
<a href="#l5.191"></a><span id="l5.191" class="difflineplus">+</span>
<a href="#l5.192"></a><span id="l5.192" class="difflineplus">+      &lt;tabpanels id=&quot;tabpanels&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l5.193"></a><span id="l5.193" class="difflineplus">+        &lt;vbox id=&quot;cookiesPanel&quot;&gt;</span>
<a href="#l5.194"></a><span id="l5.194" class="difflineplus">+          &lt;description&gt;&amp;cookies.description;&lt;/description&gt;</span>
<a href="#l5.195"></a><span id="l5.195" class="difflineplus">+          &lt;tree id=&quot;cookiesTree&quot;</span>
<a href="#l5.196"></a><span id="l5.196" class="difflineplus">+                flex=&quot;1&quot;</span>
<a href="#l5.197"></a><span id="l5.197" class="difflineplus">+                onkeypress=&quot;gCookies.handleKeyPress(event);&quot;</span>
<a href="#l5.198"></a><span id="l5.198" class="difflineplus">+                onselect=&quot;gCookies.select();&quot;</span>
<a href="#l5.199"></a><span id="l5.199" class="difflineplus">+                context=&quot;cookiesTreeContextMenu&quot;&gt;</span>
<a href="#l5.200"></a><span id="l5.200" class="difflineplus">+            &lt;treecols onclick=&quot;gCookies.sort(event.target, true, true);&quot;&gt;</span>
<a href="#l5.201"></a><span id="l5.201" class="difflineplus">+              &lt;treecol id=&quot;cookieHostCol&quot;</span>
<a href="#l5.202"></a><span id="l5.202" class="difflineplus">+                       label=&quot;&amp;cookies.tree.host.label;&quot;</span>
<a href="#l5.203"></a><span id="l5.203" class="difflineplus">+                       flex=&quot;5&quot;</span>
<a href="#l5.204"></a><span id="l5.204" class="difflineplus">+                       persist=&quot;width hidden&quot;/&gt;</span>
<a href="#l5.205"></a><span id="l5.205" class="difflineplus">+              &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l5.206"></a><span id="l5.206" class="difflineplus">+              &lt;treecol id=&quot;cookieNameCol&quot;</span>
<a href="#l5.207"></a><span id="l5.207" class="difflineplus">+                       label=&quot;&amp;cookies.tree.name.label;&quot;</span>
<a href="#l5.208"></a><span id="l5.208" class="difflineplus">+                       flex=&quot;5&quot;</span>
<a href="#l5.209"></a><span id="l5.209" class="difflineplus">+                       persist=&quot;width hidden&quot;/&gt;</span>
<a href="#l5.210"></a><span id="l5.210" class="difflineplus">+              &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l5.211"></a><span id="l5.211" class="difflineplus">+              &lt;treecol id=&quot;cookieExpiresCol&quot;</span>
<a href="#l5.212"></a><span id="l5.212" class="difflineplus">+                       label=&quot;&amp;cookies.tree.expires.label;&quot;</span>
<a href="#l5.213"></a><span id="l5.213" class="difflineplus">+                       flex=&quot;10&quot;</span>
<a href="#l5.214"></a><span id="l5.214" class="difflineplus">+                       hidden=&quot;true&quot;</span>
<a href="#l5.215"></a><span id="l5.215" class="difflineplus">+                       persist=&quot;width hidden&quot;/&gt;</span>
<a href="#l5.216"></a><span id="l5.216" class="difflineplus">+            &lt;/treecols&gt;</span>
<a href="#l5.217"></a><span id="l5.217" class="difflineplus">+            &lt;treechildren/&gt;</span>
<a href="#l5.218"></a><span id="l5.218" class="difflineplus">+          &lt;/tree&gt;</span>
<a href="#l5.219"></a><span id="l5.219" class="difflineplus">+</span>
<a href="#l5.220"></a><span id="l5.220" class="difflineplus">+          &lt;groupbox&gt;</span>
<a href="#l5.221"></a><span id="l5.221" class="difflineplus">+            &lt;caption label=&quot;&amp;cookies.infobox.label;&quot;/&gt;</span>
<a href="#l5.222"></a><span id="l5.222" class="difflineplus">+            &lt;grid flex=&quot;1&quot;&gt;</span>
<a href="#l5.223"></a><span id="l5.223" class="difflineplus">+              &lt;columns&gt;</span>
<a href="#l5.224"></a><span id="l5.224" class="difflineplus">+                &lt;column/&gt;</span>
<a href="#l5.225"></a><span id="l5.225" class="difflineplus">+                &lt;column flex=&quot;1&quot;/&gt;</span>
<a href="#l5.226"></a><span id="l5.226" class="difflineplus">+              &lt;/columns&gt;</span>
<a href="#l5.227"></a><span id="l5.227" class="difflineplus">+</span>
<a href="#l5.228"></a><span id="l5.228" class="difflineplus">+              &lt;rows&gt;</span>
<a href="#l5.229"></a><span id="l5.229" class="difflineplus">+                &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l5.230"></a><span id="l5.230" class="difflineplus">+                  &lt;hbox pack=&quot;end&quot;&gt;</span>
<a href="#l5.231"></a><span id="l5.231" class="difflineplus">+                    &lt;label value=&quot;&amp;cookies.info.name.label;&quot;</span>
<a href="#l5.232"></a><span id="l5.232" class="difflineplus">+                           control=&quot;cookieInfoName&quot;/&gt;</span>
<a href="#l5.233"></a><span id="l5.233" class="difflineplus">+                  &lt;/hbox&gt;</span>
<a href="#l5.234"></a><span id="l5.234" class="difflineplus">+                  &lt;textbox id=&quot;cookieInfoName&quot; readonly=&quot;true&quot; class=&quot;plain&quot;/&gt;</span>
<a href="#l5.235"></a><span id="l5.235" class="difflineplus">+                &lt;/row&gt;</span>
<a href="#l5.236"></a><span id="l5.236" class="difflineplus">+</span>
<a href="#l5.237"></a><span id="l5.237" class="difflineplus">+                &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l5.238"></a><span id="l5.238" class="difflineplus">+                  &lt;hbox pack=&quot;end&quot;&gt;</span>
<a href="#l5.239"></a><span id="l5.239" class="difflineplus">+                    &lt;label value=&quot;&amp;cookies.info.value.label;&quot;</span>
<a href="#l5.240"></a><span id="l5.240" class="difflineplus">+                           control=&quot;cookieInfoValue&quot;/&gt;</span>
<a href="#l5.241"></a><span id="l5.241" class="difflineplus">+                  &lt;/hbox&gt;</span>
<a href="#l5.242"></a><span id="l5.242" class="difflineplus">+                  &lt;textbox id=&quot;cookieInfoValue&quot; readonly=&quot;true&quot; class=&quot;plain&quot;/&gt;</span>
<a href="#l5.243"></a><span id="l5.243" class="difflineplus">+                &lt;/row&gt;</span>
<a href="#l5.244"></a><span id="l5.244" class="difflineplus">+</span>
<a href="#l5.245"></a><span id="l5.245" class="difflineplus">+                &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l5.246"></a><span id="l5.246" class="difflineplus">+                  &lt;hbox pack=&quot;end&quot;&gt;</span>
<a href="#l5.247"></a><span id="l5.247" class="difflineplus">+                    &lt;label id=&quot;cookieInfoHostLabel&quot;</span>
<a href="#l5.248"></a><span id="l5.248" class="difflineplus">+                           value=&quot;&amp;cookies.info.host.label;&quot;</span>
<a href="#l5.249"></a><span id="l5.249" class="difflineplus">+                           value_host=&quot;&amp;cookies.info.host.label;&quot;</span>
<a href="#l5.250"></a><span id="l5.250" class="difflineplus">+                           value_domain=&quot;&amp;cookies.info.domain.label;&quot;</span>
<a href="#l5.251"></a><span id="l5.251" class="difflineplus">+                           control=&quot;cookieInfoHost&quot;/&gt;</span>
<a href="#l5.252"></a><span id="l5.252" class="difflineplus">+                  &lt;/hbox&gt;</span>
<a href="#l5.253"></a><span id="l5.253" class="difflineplus">+                  &lt;textbox id=&quot;cookieInfoHost&quot; readonly=&quot;true&quot; class=&quot;plain&quot;/&gt;</span>
<a href="#l5.254"></a><span id="l5.254" class="difflineplus">+                &lt;/row&gt;</span>
<a href="#l5.255"></a><span id="l5.255" class="difflineplus">+</span>
<a href="#l5.256"></a><span id="l5.256" class="difflineplus">+                &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l5.257"></a><span id="l5.257" class="difflineplus">+                  &lt;hbox pack=&quot;end&quot;&gt;</span>
<a href="#l5.258"></a><span id="l5.258" class="difflineplus">+                    &lt;label value=&quot;&amp;cookies.info.path.label;&quot;</span>
<a href="#l5.259"></a><span id="l5.259" class="difflineplus">+                           control=&quot;cookieInfoPath&quot;/&gt;</span>
<a href="#l5.260"></a><span id="l5.260" class="difflineplus">+                  &lt;/hbox&gt;</span>
<a href="#l5.261"></a><span id="l5.261" class="difflineplus">+                  &lt;textbox id=&quot;cookieInfoPath&quot; readonly=&quot;true&quot; class=&quot;plain&quot;/&gt;</span>
<a href="#l5.262"></a><span id="l5.262" class="difflineplus">+                &lt;/row&gt;</span>
<a href="#l5.263"></a><span id="l5.263" class="difflineplus">+</span>
<a href="#l5.264"></a><span id="l5.264" class="difflineplus">+                &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l5.265"></a><span id="l5.265" class="difflineplus">+                  &lt;hbox pack=&quot;end&quot;&gt;</span>
<a href="#l5.266"></a><span id="l5.266" class="difflineplus">+                    &lt;label value=&quot;&amp;cookies.info.sendtype.label;&quot;</span>
<a href="#l5.267"></a><span id="l5.267" class="difflineplus">+                           control=&quot;cookieInfoSendType&quot;/&gt;</span>
<a href="#l5.268"></a><span id="l5.268" class="difflineplus">+                  &lt;/hbox&gt;</span>
<a href="#l5.269"></a><span id="l5.269" class="difflineplus">+                  &lt;textbox id=&quot;cookieInfoSendType&quot; readonly=&quot;true&quot; class=&quot;plain&quot;/&gt;</span>
<a href="#l5.270"></a><span id="l5.270" class="difflineplus">+                &lt;/row&gt;</span>
<a href="#l5.271"></a><span id="l5.271" class="difflineplus">+</span>
<a href="#l5.272"></a><span id="l5.272" class="difflineplus">+                &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l5.273"></a><span id="l5.273" class="difflineplus">+                  &lt;hbox pack=&quot;end&quot;&gt;</span>
<a href="#l5.274"></a><span id="l5.274" class="difflineplus">+                    &lt;label value=&quot;&amp;cookies.info.expires.label;&quot;</span>
<a href="#l5.275"></a><span id="l5.275" class="difflineplus">+                           control=&quot;cookieInfoExpires&quot;/&gt;</span>
<a href="#l5.276"></a><span id="l5.276" class="difflineplus">+                  &lt;/hbox&gt;</span>
<a href="#l5.277"></a><span id="l5.277" class="difflineplus">+                  &lt;textbox id=&quot;cookieInfoExpires&quot; readonly=&quot;true&quot; class=&quot;plain&quot;/&gt;</span>
<a href="#l5.278"></a><span id="l5.278" class="difflineplus">+                &lt;/row&gt;</span>
<a href="#l5.279"></a><span id="l5.279" class="difflineplus">+              &lt;/rows&gt;</span>
<a href="#l5.280"></a><span id="l5.280" class="difflineplus">+            &lt;/grid&gt;</span>
<a href="#l5.281"></a><span id="l5.281" class="difflineplus">+          &lt;/groupbox&gt;</span>
<a href="#l5.282"></a><span id="l5.282" class="difflineplus">+</span>
<a href="#l5.283"></a><span id="l5.283" class="difflineplus">+          &lt;hbox id=&quot;cookieButtons&quot; align=&quot;center&quot;&gt;</span>
<a href="#l5.284"></a><span id="l5.284" class="difflineplus">+            &lt;button id=&quot;cookieRemove&quot;</span>
<a href="#l5.285"></a><span id="l5.285" class="difflineplus">+                    label=&quot;&amp;cookies.button.remove.label;&quot;</span>
<a href="#l5.286"></a><span id="l5.286" class="difflineplus">+                    accesskey=&quot;&amp;cookies.button.remove.accesskey;&quot;</span>
<a href="#l5.287"></a><span id="l5.287" class="difflineplus">+                    disabled=&quot;true&quot;</span>
<a href="#l5.288"></a><span id="l5.288" class="difflineplus">+                    oncommand=&quot;gCookies.delete();&quot;/&gt;</span>
<a href="#l5.289"></a><span id="l5.289" class="difflineplus">+            &lt;checkbox id=&quot;cookieBlockOnRemove&quot;</span>
<a href="#l5.290"></a><span id="l5.290" class="difflineplus">+                      label=&quot;&amp;cookies.blockOnRemove.label;&quot;</span>
<a href="#l5.291"></a><span id="l5.291" class="difflineplus">+                      accesskey=&quot;&amp;cookies.blockOnRemove.accesskey;&quot;</span>
<a href="#l5.292"></a><span id="l5.292" class="difflineplus">+                      persist=&quot;checked&quot;/&gt;</span>
<a href="#l5.293"></a><span id="l5.293" class="difflineplus">+          &lt;/hbox&gt;</span>
<a href="#l5.294"></a><span id="l5.294" class="difflineplus">+        &lt;/vbox&gt;</span>
<a href="#l5.295"></a><span id="l5.295" class="difflineplus">+</span>
<a href="#l5.296"></a><span id="l5.296" class="difflineplus">+        &lt;vbox id=&quot;permissionsPanel&quot;&gt;</span>
<a href="#l5.297"></a><span id="l5.297" class="difflineplus">+          &lt;richlistbox id=&quot;permList&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l5.298"></a><span id="l5.298" class="difflineplus">+        &lt;/vbox&gt;</span>
<a href="#l5.299"></a><span id="l5.299" class="difflineplus">+</span>
<a href="#l5.300"></a><span id="l5.300" class="difflineplus">+        &lt;vbox id=&quot;preferencesPanel&quot;&gt;</span>
<a href="#l5.301"></a><span id="l5.301" class="difflineplus">+          &lt;description&gt;&amp;prefs.description;&lt;/description&gt;</span>
<a href="#l5.302"></a><span id="l5.302" class="difflineplus">+          &lt;tree id=&quot;prefsTree&quot;</span>
<a href="#l5.303"></a><span id="l5.303" class="difflineplus">+                flex=&quot;1&quot;</span>
<a href="#l5.304"></a><span id="l5.304" class="difflineplus">+                onkeypress=&quot;gPrefs.handleKeyPress(event);&quot;</span>
<a href="#l5.305"></a><span id="l5.305" class="difflineplus">+                onselect=&quot;gPrefs.select();&quot;</span>
<a href="#l5.306"></a><span id="l5.306" class="difflineplus">+                context=&quot;prefsTreeContextMenu&quot;&gt;</span>
<a href="#l5.307"></a><span id="l5.307" class="difflineplus">+            &lt;treecols onclick=&quot;gPrefs.sort(event.target, true, true);&quot;&gt;</span>
<a href="#l5.308"></a><span id="l5.308" class="difflineplus">+              &lt;treecol id=&quot;prefsHostCol&quot;</span>
<a href="#l5.309"></a><span id="l5.309" class="difflineplus">+                       label=&quot;&amp;prefs.tree.host.label;&quot;</span>
<a href="#l5.310"></a><span id="l5.310" class="difflineplus">+                       flex=&quot;5&quot;</span>
<a href="#l5.311"></a><span id="l5.311" class="difflineplus">+                       persist=&quot;width hidden&quot;/&gt;</span>
<a href="#l5.312"></a><span id="l5.312" class="difflineplus">+              &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l5.313"></a><span id="l5.313" class="difflineplus">+              &lt;treecol id=&quot;prefsNameCol&quot;</span>
<a href="#l5.314"></a><span id="l5.314" class="difflineplus">+                       label=&quot;&amp;prefs.tree.name.label;&quot;</span>
<a href="#l5.315"></a><span id="l5.315" class="difflineplus">+                       flex=&quot;5&quot;</span>
<a href="#l5.316"></a><span id="l5.316" class="difflineplus">+                       persist=&quot;width hidden&quot;/&gt;</span>
<a href="#l5.317"></a><span id="l5.317" class="difflineplus">+              &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l5.318"></a><span id="l5.318" class="difflineplus">+              &lt;treecol id=&quot;prefsValueCol&quot;</span>
<a href="#l5.319"></a><span id="l5.319" class="difflineplus">+                       label=&quot;&amp;prefs.tree.value.label;&quot;</span>
<a href="#l5.320"></a><span id="l5.320" class="difflineplus">+                       flex=&quot;10&quot;</span>
<a href="#l5.321"></a><span id="l5.321" class="difflineplus">+                       persist=&quot;width hidden&quot;/&gt;</span>
<a href="#l5.322"></a><span id="l5.322" class="difflineplus">+            &lt;/treecols&gt;</span>
<a href="#l5.323"></a><span id="l5.323" class="difflineplus">+            &lt;treechildren/&gt;</span>
<a href="#l5.324"></a><span id="l5.324" class="difflineplus">+          &lt;/tree&gt;</span>
<a href="#l5.325"></a><span id="l5.325" class="difflineplus">+          &lt;hbox id=&quot;prefsButtons&quot;&gt;</span>
<a href="#l5.326"></a><span id="l5.326" class="difflineplus">+            &lt;button id=&quot;prefsRemove&quot;</span>
<a href="#l5.327"></a><span id="l5.327" class="difflineplus">+                    label=&quot;&amp;prefs.button.remove.label;&quot;</span>
<a href="#l5.328"></a><span id="l5.328" class="difflineplus">+                    accesskey=&quot;&amp;prefs.button.remove.accesskey;&quot;</span>
<a href="#l5.329"></a><span id="l5.329" class="difflineplus">+                    disabled=&quot;true&quot;</span>
<a href="#l5.330"></a><span id="l5.330" class="difflineplus">+                    oncommand=&quot;gPrefs.delete();&quot;/&gt;</span>
<a href="#l5.331"></a><span id="l5.331" class="difflineplus">+          &lt;/hbox&gt;</span>
<a href="#l5.332"></a><span id="l5.332" class="difflineplus">+        &lt;/vbox&gt;</span>
<a href="#l5.333"></a><span id="l5.333" class="difflineplus">+</span>
<a href="#l5.334"></a><span id="l5.334" class="difflineplus">+        &lt;vbox id=&quot;passwordsPanel&quot;&gt;</span>
<a href="#l5.335"></a><span id="l5.335" class="difflineplus">+          &lt;description&gt;&amp;pwd.description;&lt;/description&gt;</span>
<a href="#l5.336"></a><span id="l5.336" class="difflineplus">+          &lt;tree id=&quot;passwordsTree&quot;</span>
<a href="#l5.337"></a><span id="l5.337" class="difflineplus">+                flex=&quot;1&quot;</span>
<a href="#l5.338"></a><span id="l5.338" class="difflineplus">+                hidecolumnpicker=&quot;true&quot;</span>
<a href="#l5.339"></a><span id="l5.339" class="difflineplus">+                onkeypress=&quot;gPasswords.handleKeyPress(event);&quot;</span>
<a href="#l5.340"></a><span id="l5.340" class="difflineplus">+                onselect=&quot;gPasswords.select();&quot;</span>
<a href="#l5.341"></a><span id="l5.341" class="difflineplus">+                context=&quot;passwordsTreeContextMenu&quot;&gt;</span>
<a href="#l5.342"></a><span id="l5.342" class="difflineplus">+            &lt;treecols onclick=&quot;gPasswords.sort(event.target, true, true);&quot;&gt;</span>
<a href="#l5.343"></a><span id="l5.343" class="difflineplus">+              &lt;treecol id=&quot;pwdHostCol&quot;</span>
<a href="#l5.344"></a><span id="l5.344" class="difflineplus">+                       label=&quot;&amp;pwd.tree.host.label;&quot;</span>
<a href="#l5.345"></a><span id="l5.345" class="difflineplus">+                       flex=&quot;5&quot;</span>
<a href="#l5.346"></a><span id="l5.346" class="difflineplus">+                       persist=&quot;width&quot;/&gt;</span>
<a href="#l5.347"></a><span id="l5.347" class="difflineplus">+              &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l5.348"></a><span id="l5.348" class="difflineplus">+              &lt;treecol id=&quot;pwdUserCol&quot;</span>
<a href="#l5.349"></a><span id="l5.349" class="difflineplus">+                       label=&quot;&amp;pwd.tree.username.label;&quot;</span>
<a href="#l5.350"></a><span id="l5.350" class="difflineplus">+                       flex=&quot;2&quot;</span>
<a href="#l5.351"></a><span id="l5.351" class="difflineplus">+                       persist=&quot;width&quot;/&gt;</span>
<a href="#l5.352"></a><span id="l5.352" class="difflineplus">+              &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l5.353"></a><span id="l5.353" class="difflineplus">+              &lt;treecol id=&quot;pwdPasswordCol&quot;</span>
<a href="#l5.354"></a><span id="l5.354" class="difflineplus">+                       label=&quot;&amp;pwd.tree.password.label;&quot;</span>
<a href="#l5.355"></a><span id="l5.355" class="difflineplus">+                       flex=&quot;2&quot;</span>
<a href="#l5.356"></a><span id="l5.356" class="difflineplus">+                       hidden=&quot;true&quot;</span>
<a href="#l5.357"></a><span id="l5.357" class="difflineplus">+                       persist=&quot;width&quot;/&gt;</span>
<a href="#l5.358"></a><span id="l5.358" class="difflineplus">+            &lt;/treecols&gt;</span>
<a href="#l5.359"></a><span id="l5.359" class="difflineplus">+            &lt;treechildren/&gt;</span>
<a href="#l5.360"></a><span id="l5.360" class="difflineplus">+          &lt;/tree&gt;</span>
<a href="#l5.361"></a><span id="l5.361" class="difflineplus">+          &lt;hbox id=&quot;passwordButtons&quot;&gt;</span>
<a href="#l5.362"></a><span id="l5.362" class="difflineplus">+            &lt;button id=&quot;pwdRemove&quot;</span>
<a href="#l5.363"></a><span id="l5.363" class="difflineplus">+                    label=&quot;&amp;pwd.button.remove.label;&quot;</span>
<a href="#l5.364"></a><span id="l5.364" class="difflineplus">+                    accesskey=&quot;&amp;pwd.button.remove.accesskey;&quot;</span>
<a href="#l5.365"></a><span id="l5.365" class="difflineplus">+                    disabled=&quot;true&quot;</span>
<a href="#l5.366"></a><span id="l5.366" class="difflineplus">+                    oncommand=&quot;gPasswords.delete();&quot;/&gt;</span>
<a href="#l5.367"></a><span id="l5.367" class="difflineplus">+            &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l5.368"></a><span id="l5.368" class="difflineplus">+            &lt;button id=&quot;pwdToggle&quot;</span>
<a href="#l5.369"></a><span id="l5.369" class="difflineplus">+                    oncommand=&quot;gPasswords.togglePasswordVisible();&quot;/&gt;</span>
<a href="#l5.370"></a><span id="l5.370" class="difflineplus">+          &lt;/hbox&gt;</span>
<a href="#l5.371"></a><span id="l5.371" class="difflineplus">+        &lt;/vbox&gt;</span>
<a href="#l5.372"></a><span id="l5.372" class="difflineplus">+</span>
<a href="#l5.373"></a><span id="l5.373" class="difflineplus">+        &lt;vbox id=&quot;formdataPanel&quot;&gt;</span>
<a href="#l5.374"></a><span id="l5.374" class="difflineplus">+          &lt;textbox id=&quot;fdataSearch&quot;</span>
<a href="#l5.375"></a><span id="l5.375" class="difflineplus">+                   clickSelectsAll=&quot;true&quot;</span>
<a href="#l5.376"></a><span id="l5.376" class="difflineplus">+                   type=&quot;search&quot;</span>
<a href="#l5.377"></a><span id="l5.377" class="difflineplus">+                   class=&quot;compact&quot;</span>
<a href="#l5.378"></a><span id="l5.378" class="difflineplus">+                   placeholder=&quot;&amp;fdata.search.placeholder;&quot;</span>
<a href="#l5.379"></a><span id="l5.379" class="difflineplus">+                   oncommand=&quot;gFormdata.search(this.value);&quot;/&gt;</span>
<a href="#l5.380"></a><span id="l5.380" class="difflineplus">+          &lt;tree id=&quot;formdataTree&quot;</span>
<a href="#l5.381"></a><span id="l5.381" class="difflineplus">+                flex=&quot;1&quot;</span>
<a href="#l5.382"></a><span id="l5.382" class="difflineplus">+                onkeypress=&quot;gFormdata.handleKeyPress(event);&quot;</span>
<a href="#l5.383"></a><span id="l5.383" class="difflineplus">+                onselect=&quot;gFormdata.select();&quot;</span>
<a href="#l5.384"></a><span id="l5.384" class="difflineplus">+                context=&quot;formdataTreeContextMenu&quot;&gt;</span>
<a href="#l5.385"></a><span id="l5.385" class="difflineplus">+            &lt;treecols onclick=&quot;gFormdata.sort(event.target, true, true);&quot;&gt;</span>
<a href="#l5.386"></a><span id="l5.386" class="difflineplus">+              &lt;treecol id=&quot;fdataFieldCol&quot;</span>
<a href="#l5.387"></a><span id="l5.387" class="difflineplus">+                       label=&quot;&amp;fdata.tree.fieldname.label;&quot;</span>
<a href="#l5.388"></a><span id="l5.388" class="difflineplus">+                       flex=&quot;5&quot;</span>
<a href="#l5.389"></a><span id="l5.389" class="difflineplus">+                       persist=&quot;width hidden&quot;/&gt;</span>
<a href="#l5.390"></a><span id="l5.390" class="difflineplus">+              &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l5.391"></a><span id="l5.391" class="difflineplus">+              &lt;treecol id=&quot;fdataValueCol&quot;</span>
<a href="#l5.392"></a><span id="l5.392" class="difflineplus">+                       label=&quot;&amp;fdata.tree.value.label;&quot;</span>
<a href="#l5.393"></a><span id="l5.393" class="difflineplus">+                       flex=&quot;10&quot;</span>
<a href="#l5.394"></a><span id="l5.394" class="difflineplus">+                       persist=&quot;width hidden&quot;/&gt;</span>
<a href="#l5.395"></a><span id="l5.395" class="difflineplus">+              &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l5.396"></a><span id="l5.396" class="difflineplus">+              &lt;treecol id=&quot;fdataCountCol&quot;</span>
<a href="#l5.397"></a><span id="l5.397" class="difflineplus">+                       label=&quot;&amp;fdata.tree.usecount.label;&quot;</span>
<a href="#l5.398"></a><span id="l5.398" class="difflineplus">+                       flex=&quot;2&quot;</span>
<a href="#l5.399"></a><span id="l5.399" class="difflineplus">+                       hidden=&quot;true&quot;</span>
<a href="#l5.400"></a><span id="l5.400" class="difflineplus">+                       persist=&quot;width hidden&quot;/&gt;</span>
<a href="#l5.401"></a><span id="l5.401" class="difflineplus">+              &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l5.402"></a><span id="l5.402" class="difflineplus">+              &lt;treecol id=&quot;fdataFirstCol&quot;</span>
<a href="#l5.403"></a><span id="l5.403" class="difflineplus">+                       label=&quot;&amp;fdata.tree.firstused.label;&quot;</span>
<a href="#l5.404"></a><span id="l5.404" class="difflineplus">+                       flex=&quot;10&quot;</span>
<a href="#l5.405"></a><span id="l5.405" class="difflineplus">+                       hidden=&quot;true&quot;</span>
<a href="#l5.406"></a><span id="l5.406" class="difflineplus">+                       persist=&quot;width hidden&quot;/&gt;</span>
<a href="#l5.407"></a><span id="l5.407" class="difflineplus">+              &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l5.408"></a><span id="l5.408" class="difflineplus">+              &lt;treecol id=&quot;fdataLastCol&quot;</span>
<a href="#l5.409"></a><span id="l5.409" class="difflineplus">+                       label=&quot;&amp;fdata.tree.lastused.label;&quot;</span>
<a href="#l5.410"></a><span id="l5.410" class="difflineplus">+                       flex=&quot;10&quot;</span>
<a href="#l5.411"></a><span id="l5.411" class="difflineplus">+                       hidden=&quot;true&quot;</span>
<a href="#l5.412"></a><span id="l5.412" class="difflineplus">+                       persist=&quot;width hidden&quot;/&gt;</span>
<a href="#l5.413"></a><span id="l5.413" class="difflineplus">+            &lt;/treecols&gt;</span>
<a href="#l5.414"></a><span id="l5.414" class="difflineplus">+            &lt;treechildren/&gt;</span>
<a href="#l5.415"></a><span id="l5.415" class="difflineplus">+          &lt;/tree&gt;</span>
<a href="#l5.416"></a><span id="l5.416" class="difflineplus">+          &lt;hbox id=&quot;formdataButtons&quot;&gt;</span>
<a href="#l5.417"></a><span id="l5.417" class="difflineplus">+            &lt;button id=&quot;fdataRemove&quot;</span>
<a href="#l5.418"></a><span id="l5.418" class="difflineplus">+                    label=&quot;&amp;fdata.button.remove.label;&quot;</span>
<a href="#l5.419"></a><span id="l5.419" class="difflineplus">+                    accesskey=&quot;&amp;fdata.button.remove.accesskey;&quot;</span>
<a href="#l5.420"></a><span id="l5.420" class="difflineplus">+                    disabled=&quot;true&quot;</span>
<a href="#l5.421"></a><span id="l5.421" class="difflineplus">+                    oncommand=&quot;gFormdata.delete();&quot;/&gt;</span>
<a href="#l5.422"></a><span id="l5.422" class="difflineplus">+          &lt;/hbox&gt;</span>
<a href="#l5.423"></a><span id="l5.423" class="difflineplus">+        &lt;/vbox&gt;</span>
<a href="#l5.424"></a><span id="l5.424" class="difflineplus">+</span>
<a href="#l5.425"></a><span id="l5.425" class="difflineplus">+        &lt;vbox id=&quot;forgetPanel&quot;&gt;</span>
<a href="#l5.426"></a><span id="l5.426" class="difflineplus">+          &lt;description id=&quot;forgetDesc&quot;/&gt;</span>
<a href="#l5.427"></a><span id="l5.427" class="difflineplus">+          &lt;hbox&gt;</span>
<a href="#l5.428"></a><span id="l5.428" class="difflineplus">+            &lt;checkbox id=&quot;forgetCookies&quot;</span>
<a href="#l5.429"></a><span id="l5.429" class="difflineplus">+                      label=&quot;&amp;forget.cookies.label;&quot;</span>
<a href="#l5.430"></a><span id="l5.430" class="difflineplus">+                      accesskey=&quot;&amp;forget.cookies.accesskey;&quot;</span>
<a href="#l5.431"></a><span id="l5.431" class="difflineplus">+                      disabled=&quot;true&quot;</span>
<a href="#l5.432"></a><span id="l5.432" class="difflineplus">+                      oncommand=&quot;gForget.updateOptions();&quot;/&gt;</span>
<a href="#l5.433"></a><span id="l5.433" class="difflineplus">+            &lt;label id=&quot;forgetCookiesLabel&quot;</span>
<a href="#l5.434"></a><span id="l5.434" class="difflineplus">+                   value=&quot;&amp;forget.cookies.label;&quot;</span>
<a href="#l5.435"></a><span id="l5.435" class="difflineplus">+                   hidden=&quot;true&quot;/&gt;</span>
<a href="#l5.436"></a><span id="l5.436" class="difflineplus">+          &lt;/hbox&gt;</span>
<a href="#l5.437"></a><span id="l5.437" class="difflineplus">+          &lt;hbox&gt;</span>
<a href="#l5.438"></a><span id="l5.438" class="difflineplus">+            &lt;checkbox id=&quot;forgetPermissions&quot;</span>
<a href="#l5.439"></a><span id="l5.439" class="difflineplus">+                      label=&quot;&amp;forget.permissions.label;&quot;</span>
<a href="#l5.440"></a><span id="l5.440" class="difflineplus">+                      accesskey=&quot;&amp;forget.permissions.accesskey;&quot;</span>
<a href="#l5.441"></a><span id="l5.441" class="difflineplus">+                      disabled=&quot;true&quot;</span>
<a href="#l5.442"></a><span id="l5.442" class="difflineplus">+                      oncommand=&quot;gForget.updateOptions();&quot;/&gt;</span>
<a href="#l5.443"></a><span id="l5.443" class="difflineplus">+            &lt;label id=&quot;forgetPermissionsLabel&quot;</span>
<a href="#l5.444"></a><span id="l5.444" class="difflineplus">+                   value=&quot;&amp;forget.permissions.label;&quot;</span>
<a href="#l5.445"></a><span id="l5.445" class="difflineplus">+                   hidden=&quot;true&quot;/&gt;</span>
<a href="#l5.446"></a><span id="l5.446" class="difflineplus">+          &lt;/hbox&gt;</span>
<a href="#l5.447"></a><span id="l5.447" class="difflineplus">+          &lt;hbox&gt;</span>
<a href="#l5.448"></a><span id="l5.448" class="difflineplus">+            &lt;checkbox id=&quot;forgetPreferences&quot;</span>
<a href="#l5.449"></a><span id="l5.449" class="difflineplus">+                      label=&quot;&amp;forget.preferences.label;&quot;</span>
<a href="#l5.450"></a><span id="l5.450" class="difflineplus">+                      accesskey=&quot;&amp;forget.preferences.accesskey;&quot;</span>
<a href="#l5.451"></a><span id="l5.451" class="difflineplus">+                      disabled=&quot;true&quot;</span>
<a href="#l5.452"></a><span id="l5.452" class="difflineplus">+                      oncommand=&quot;gForget.updateOptions();&quot;/&gt;</span>
<a href="#l5.453"></a><span id="l5.453" class="difflineplus">+            &lt;label id=&quot;forgetPreferencesLabel&quot;</span>
<a href="#l5.454"></a><span id="l5.454" class="difflineplus">+                   value=&quot;&amp;forget.preferences.label;&quot;</span>
<a href="#l5.455"></a><span id="l5.455" class="difflineplus">+                   hidden=&quot;true&quot;/&gt;</span>
<a href="#l5.456"></a><span id="l5.456" class="difflineplus">+          &lt;/hbox&gt;</span>
<a href="#l5.457"></a><span id="l5.457" class="difflineplus">+          &lt;hbox&gt;</span>
<a href="#l5.458"></a><span id="l5.458" class="difflineplus">+            &lt;checkbox id=&quot;forgetPasswords&quot;</span>
<a href="#l5.459"></a><span id="l5.459" class="difflineplus">+                      label=&quot;&amp;forget.passwords.label;&quot;</span>
<a href="#l5.460"></a><span id="l5.460" class="difflineplus">+                      accesskey=&quot;&amp;forget.passwords.accesskey;&quot;</span>
<a href="#l5.461"></a><span id="l5.461" class="difflineplus">+                      disabled=&quot;true&quot;</span>
<a href="#l5.462"></a><span id="l5.462" class="difflineplus">+                      oncommand=&quot;gForget.updateOptions();&quot;/&gt;</span>
<a href="#l5.463"></a><span id="l5.463" class="difflineplus">+            &lt;label id=&quot;forgetPasswordsLabel&quot;</span>
<a href="#l5.464"></a><span id="l5.464" class="difflineplus">+                   value=&quot;&amp;forget.passwords.label;&quot;</span>
<a href="#l5.465"></a><span id="l5.465" class="difflineplus">+                   hidden=&quot;true&quot;/&gt;</span>
<a href="#l5.466"></a><span id="l5.466" class="difflineplus">+          &lt;/hbox&gt;</span>
<a href="#l5.467"></a><span id="l5.467" class="difflineplus">+          &lt;hbox&gt;</span>
<a href="#l5.468"></a><span id="l5.468" class="difflineplus">+            &lt;checkbox id=&quot;forgetFormdata&quot;</span>
<a href="#l5.469"></a><span id="l5.469" class="difflineplus">+                      label=&quot;&amp;forget.formdata.label;&quot;</span>
<a href="#l5.470"></a><span id="l5.470" class="difflineplus">+                      accesskey=&quot;&amp;forget.formdata.accesskey;&quot;</span>
<a href="#l5.471"></a><span id="l5.471" class="difflineplus">+                      disabled=&quot;true&quot;</span>
<a href="#l5.472"></a><span id="l5.472" class="difflineplus">+                      hidden=&quot;true&quot;</span>
<a href="#l5.473"></a><span id="l5.473" class="difflineplus">+                      oncommand=&quot;gForget.updateOptions();&quot;/&gt;</span>
<a href="#l5.474"></a><span id="l5.474" class="difflineplus">+            &lt;label id=&quot;forgetFormdataLabel&quot;</span>
<a href="#l5.475"></a><span id="l5.475" class="difflineplus">+                   value=&quot;&amp;forget.formdata.label;&quot;</span>
<a href="#l5.476"></a><span id="l5.476" class="difflineplus">+                   hidden=&quot;true&quot;/&gt;</span>
<a href="#l5.477"></a><span id="l5.477" class="difflineplus">+          &lt;/hbox&gt;</span>
<a href="#l5.478"></a><span id="l5.478" class="difflineplus">+          &lt;hbox&gt;</span>
<a href="#l5.479"></a><span id="l5.479" class="difflineplus">+            &lt;button id=&quot;forgetButton&quot;</span>
<a href="#l5.480"></a><span id="l5.480" class="difflineplus">+                    label=&quot;&amp;forget.button.label;&quot;</span>
<a href="#l5.481"></a><span id="l5.481" class="difflineplus">+                    accesskey=&quot;&amp;forget.button.accesskey;&quot;</span>
<a href="#l5.482"></a><span id="l5.482" class="difflineplus">+                    disabled=&quot;true&quot;</span>
<a href="#l5.483"></a><span id="l5.483" class="difflineplus">+                    oncommand=&quot;gForget.forget();&quot;/&gt;</span>
<a href="#l5.484"></a><span id="l5.484" class="difflineplus">+          &lt;/hbox&gt;</span>
<a href="#l5.485"></a><span id="l5.485" class="difflineplus">+        &lt;/vbox&gt;</span>
<a href="#l5.486"></a><span id="l5.486" class="difflineplus">+      &lt;/tabpanels&gt;</span>
<a href="#l5.487"></a><span id="l5.487" class="difflineplus">+    &lt;/tabbox&gt;</span>
<a href="#l5.488"></a><span id="l5.488" class="difflineplus">+  &lt;/hbox&gt;</span>
<a href="#l5.489"></a><span id="l5.489" class="difflineplus">+</span>
<a href="#l5.490"></a><span id="l5.490" class="difflineplus">+&lt;/page&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">new file mode 100644</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineminus">--- /dev/null</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineplus">+++ b/suite/common/dataman/tests/Makefile.in</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineat">@@ -0,0 +1,51 @@</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l6.6"></a><span id="l6.6" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l6.7"></a><span id="l6.7" class="difflineplus">+#</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+#</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+# License.</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+#</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+# The Original Code is KaiRo's data manager.</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+#</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineplus">+# Robert Kaiser &lt;kairo@kairo.at&gt;.</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineplus">+#</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineplus">+# Contributor(s):</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineplus">+#  Robert Kaiser &lt;kairo@kairo.at&gt; (original author)</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineplus">+#</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineplus">+#</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineplus">+</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineplus">+DEPTH		= ../../../..</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineplus">+topsrcdir	= @top_srcdir@</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+srcdir		= @srcdir@</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineplus">+VPATH		= @srcdir@</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineplus">+relativesrcdir = suite/common/dataman/tests</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineplus">+</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineplus">+include $(topsrcdir)/config/rules.mk</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineplus">+</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineplus">+_BROWSER_FILES = \</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+    browser_dataman_basics.js \</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+    $(NULL)</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineplus">+</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineplus">+libs:: $(_BROWSER_FILES)</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineplus">+	$(INSTALL) $(foreach f,$^,&quot;$f&quot;) $(MOZDEPTH)/_tests/testing/mochitest/browser/$(relativesrcdir)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">new file mode 100644</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineminus">--- /dev/null</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineplus">+++ b/suite/common/dataman/tests/browser_dataman_basics.js</span>
<a href="#l7.4"></a><span id="l7.4" class="difflineat">@@ -0,0 +1,545 @@</span>
<a href="#l7.5"></a><span id="l7.5" class="difflineplus">+/* Any copyright is dedicated to the Public Domain.</span>
<a href="#l7.6"></a><span id="l7.6" class="difflineplus">+ * http://creativecommons.org/publicdomain/zero/1.0/</span>
<a href="#l7.7"></a><span id="l7.7" class="difflineplus">+ */</span>
<a href="#l7.8"></a><span id="l7.8" class="difflineplus">+</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineplus">+// Test basic functionality of the data manager</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineplus">+</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+// happen to match what's used in Data Manager itself</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+var gLocSvc = {</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+  cookie: Components.classes[&quot;@mozilla.org/cookiemanager;1&quot;]</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+                    .getService(Components.interfaces.nsICookieManager2),</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+  fhist: Components.classes[&quot;@mozilla.org/satchel/form-history;1&quot;]</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+                   .getService(Components.interfaces.nsIFormHistory2),</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+  pwd: Components.classes[&quot;@mozilla.org/login-manager;1&quot;]</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+                 .getService(Components.interfaces.nsILoginManager),</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+}</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineplus">+const DATAMAN_LOADED = &quot;dataman-loaded&quot;;</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineplus">+const TEST_DONE = &quot;dataman-test-done&quot;;</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineplus">+function test() {</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+  // Preload data.</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineplus">+  // Note that before this test starts, what is already set are permissions for</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineplus">+  // getpersonas.com and addons.mozilla.org to install addons as well as</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineplus">+  // permissions for a number of sites used in mochitest to load XUL/XBL.</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineplus">+  // For the latter, those domains are used/listed: 172.0.0.1, bank1.com,</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+  // bank2.com, example.com, example.org, mochi.test, test,</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineplus">+  // xn--exmple-cua.test, xn--hxajbheg2az3al.xn--jxalpdlp</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+  // We should not touch those permissions so other tests can run, which means</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineplus">+  // we should avoid using those domains altogether as we can't remove them.</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineplus">+  let now_epoch = parseInt(Date.now() / 1000);</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineplus">+</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineplus">+  // Add cookie: not secure, non-HTTPOnly, session</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineplus">+  gLocSvc.cookie.add(&quot;bar.geckoisgecko.org&quot;, &quot;&quot;, &quot;name0&quot;, &quot;value0&quot;,</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineplus">+                     false, false, true, now_epoch + 600);</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+  // Add cookie: not secure, HTTPOnly, session</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineplus">+  gLocSvc.cookie.add(&quot;foo.geckoisgecko.org&quot;, &quot;&quot;, &quot;name1&quot;, &quot;value1&quot;,</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineplus">+                     false, true, true, now_epoch + 600);</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineplus">+  // Add cookie: secure, HTTPOnly, session</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineplus">+  gLocSvc.cookie.add(&quot;secure.geckoisgecko.org&quot;, &quot;&quot;, &quot;name2&quot;, &quot;value2&quot;,</span>
<a href="#l7.47"></a><span id="l7.47" class="difflineplus">+                     true, true, true, now_epoch + 600);</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineplus">+  // Add cookie: secure, non-HTTPOnly, expiry in an hour</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineplus">+  gLocSvc.cookie.add(&quot;drumbeat.org&quot;, &quot;&quot;, &quot;name3&quot;, &quot;value3&quot;,</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineplus">+                     true, false, false, now_epoch + 3600);</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineplus">+</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineplus">+  // Add a few form history entries</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineplus">+  gLocSvc.fhist.addEntry(&quot;akey&quot;, &quot;value0&quot;);</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineplus">+  gLocSvc.fhist.addEntry(&quot;ekey&quot;, &quot;value1&quot;);</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineplus">+  gLocSvc.fhist.addEntry(&quot;ekey&quot;, &quot;value2&quot;);</span>
<a href="#l7.56"></a><span id="l7.56" class="difflineplus">+  gLocSvc.fhist.addEntry(&quot;bkey&quot;, &quot;value3&quot;);</span>
<a href="#l7.57"></a><span id="l7.57" class="difflineplus">+  gLocSvc.fhist.addEntry(&quot;bkey&quot;, &quot;value4&quot;);</span>
<a href="#l7.58"></a><span id="l7.58" class="difflineplus">+  gLocSvc.fhist.addEntry(&quot;ckey&quot;, &quot;value5&quot;);</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineplus">+</span>
<a href="#l7.60"></a><span id="l7.60" class="difflineplus">+  // Add a few passwords</span>
<a href="#l7.61"></a><span id="l7.61" class="difflineplus">+  let loginInfo1 = Components.classes[&quot;@mozilla.org/login-manager/loginInfo;1&quot;]</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineplus">+                             .createInstance(Components.interfaces.nsILoginInfo);</span>
<a href="#l7.63"></a><span id="l7.63" class="difflineplus">+  loginInfo1.init(&quot;http://www.geckoisgecko.org&quot;, &quot;http://www.geckoisgecko.org&quot;, null,</span>
<a href="#l7.64"></a><span id="l7.64" class="difflineplus">+                  &quot;dataman&quot;, &quot;mysecret&quot;, &quot;user&quot;, &quot;pwd&quot;);</span>
<a href="#l7.65"></a><span id="l7.65" class="difflineplus">+  gLocSvc.pwd.addLogin(loginInfo1);</span>
<a href="#l7.66"></a><span id="l7.66" class="difflineplus">+  let loginInfo2 = Components.classes[&quot;@mozilla.org/login-manager/loginInfo;1&quot;]</span>
<a href="#l7.67"></a><span id="l7.67" class="difflineplus">+                             .createInstance(Components.interfaces.nsILoginInfo);</span>
<a href="#l7.68"></a><span id="l7.68" class="difflineplus">+  loginInfo2.init(&quot;gopher://geckoisgecko.org:4711&quot;, null, &quot;foo&quot;,</span>
<a href="#l7.69"></a><span id="l7.69" class="difflineplus">+                  &quot;dataman&quot;, &quot;mysecret&quot;, &quot;&quot;, &quot;&quot;);</span>
<a href="#l7.70"></a><span id="l7.70" class="difflineplus">+  gLocSvc.pwd.addLogin(loginInfo2);</span>
<a href="#l7.71"></a><span id="l7.71" class="difflineplus">+</span>
<a href="#l7.72"></a><span id="l7.72" class="difflineplus">+  //Services.prefs.setBoolPref(&quot;data_manager.debug&quot;, true);</span>
<a href="#l7.73"></a><span id="l7.73" class="difflineplus">+</span>
<a href="#l7.74"></a><span id="l7.74" class="difflineplus">+  gBrowser.addTab();</span>
<a href="#l7.75"></a><span id="l7.75" class="difflineplus">+  // Open the Data Manager, testing the menu item.</span>
<a href="#l7.76"></a><span id="l7.76" class="difflineplus">+  document.getElementById(&quot;tasksDataman&quot;).click();</span>
<a href="#l7.77"></a><span id="l7.77" class="difflineplus">+</span>
<a href="#l7.78"></a><span id="l7.78" class="difflineplus">+  var testIndex = 0;</span>
<a href="#l7.79"></a><span id="l7.79" class="difflineplus">+  var win;</span>
<a href="#l7.80"></a><span id="l7.80" class="difflineplus">+</span>
<a href="#l7.81"></a><span id="l7.81" class="difflineplus">+  let testObs = {</span>
<a href="#l7.82"></a><span id="l7.82" class="difflineplus">+    observe: function(aSubject, aTopic, aData) {</span>
<a href="#l7.83"></a><span id="l7.83" class="difflineplus">+      if (aTopic == DATAMAN_LOADED) {</span>
<a href="#l7.84"></a><span id="l7.84" class="difflineplus">+        Services.obs.removeObserver(testObs, DATAMAN_LOADED);</span>
<a href="#l7.85"></a><span id="l7.85" class="difflineplus">+        ok(true, &quot;Data Manager is loaded&quot;);</span>
<a href="#l7.86"></a><span id="l7.86" class="difflineplus">+</span>
<a href="#l7.87"></a><span id="l7.87" class="difflineplus">+        win = content.wrappedJSObject;</span>
<a href="#l7.88"></a><span id="l7.88" class="difflineplus">+        Services.obs.addObserver(testObs, TEST_DONE, false);</span>
<a href="#l7.89"></a><span id="l7.89" class="difflineplus">+        // Trigger the first test now!</span>
<a href="#l7.90"></a><span id="l7.90" class="difflineplus">+        Services.obs.notifyObservers(window, TEST_DONE, null);</span>
<a href="#l7.91"></a><span id="l7.91" class="difflineplus">+      }</span>
<a href="#l7.92"></a><span id="l7.92" class="difflineplus">+      else {</span>
<a href="#l7.93"></a><span id="l7.93" class="difflineplus">+        // TEST_DONE triggered, run next test</span>
<a href="#l7.94"></a><span id="l7.94" class="difflineplus">+        info(&quot;run test #&quot; + (testIndex + 1) + &quot; of &quot; + testFuncs.length +</span>
<a href="#l7.95"></a><span id="l7.95" class="difflineplus">+             &quot; (&quot; + testFuncs[testIndex].name + &quot;)&quot;);</span>
<a href="#l7.96"></a><span id="l7.96" class="difflineplus">+        testFuncs[testIndex++](win);</span>
<a href="#l7.97"></a><span id="l7.97" class="difflineplus">+</span>
<a href="#l7.98"></a><span id="l7.98" class="difflineplus">+        if (testIndex &gt;= testFuncs.length) {</span>
<a href="#l7.99"></a><span id="l7.99" class="difflineplus">+          // Finish this up!</span>
<a href="#l7.100"></a><span id="l7.100" class="difflineplus">+          Services.obs.removeObserver(testObs, TEST_DONE);</span>
<a href="#l7.101"></a><span id="l7.101" class="difflineplus">+          gLocSvc.cookie.removeAll();</span>
<a href="#l7.102"></a><span id="l7.102" class="difflineplus">+          gLocSvc.fhist.removeAllEntries();</span>
<a href="#l7.103"></a><span id="l7.103" class="difflineplus">+          finish();</span>
<a href="#l7.104"></a><span id="l7.104" class="difflineplus">+        }</span>
<a href="#l7.105"></a><span id="l7.105" class="difflineplus">+      }</span>
<a href="#l7.106"></a><span id="l7.106" class="difflineplus">+    }</span>
<a href="#l7.107"></a><span id="l7.107" class="difflineplus">+  };</span>
<a href="#l7.108"></a><span id="l7.108" class="difflineplus">+  waitForExplicitFinish();</span>
<a href="#l7.109"></a><span id="l7.109" class="difflineplus">+  Services.obs.addObserver(testObs, DATAMAN_LOADED, false);</span>
<a href="#l7.110"></a><span id="l7.110" class="difflineplus">+}</span>
<a href="#l7.111"></a><span id="l7.111" class="difflineplus">+</span>
<a href="#l7.112"></a><span id="l7.112" class="difflineplus">+var testFuncs = [</span>
<a href="#l7.113"></a><span id="l7.113" class="difflineplus">+function test_open_state(aWin) {</span>
<a href="#l7.114"></a><span id="l7.114" class="difflineplus">+  is(aWin.document.documentElement.id, &quot;dataman-page&quot;,</span>
<a href="#l7.115"></a><span id="l7.115" class="difflineplus">+     &quot;The active tab is the Data Manager&quot;);</span>
<a href="#l7.116"></a><span id="l7.116" class="difflineplus">+  is(aWin.gDomains.tree.view.rowCount, 14,</span>
<a href="#l7.117"></a><span id="l7.117" class="difflineplus">+     &quot;The correct number of domains is listed&quot;);</span>
<a href="#l7.118"></a><span id="l7.118" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;formdataPanel&quot;,</span>
<a href="#l7.119"></a><span id="l7.119" class="difflineplus">+     &quot;Form data panel is selected&quot;);</span>
<a href="#l7.120"></a><span id="l7.120" class="difflineplus">+</span>
<a href="#l7.121"></a><span id="l7.121" class="difflineplus">+  aWin.document.getElementById(&quot;domainSearch&quot;).value = &quot;mo&quot;;</span>
<a href="#l7.122"></a><span id="l7.122" class="difflineplus">+  aWin.document.getElementById(&quot;domainSearch&quot;).doCommand();</span>
<a href="#l7.123"></a><span id="l7.123" class="difflineplus">+  is(aWin.gDomains.tree.view.selection.count, 0,</span>
<a href="#l7.124"></a><span id="l7.124" class="difflineplus">+     &quot;In search, non-matching selection is lost&quot;);</span>
<a href="#l7.125"></a><span id="l7.125" class="difflineplus">+  is(aWin.gDomains.tree.view.rowCount, 2,</span>
<a href="#l7.126"></a><span id="l7.126" class="difflineplus">+     &quot;In search, the correct number of domains is listed&quot;);</span>
<a href="#l7.127"></a><span id="l7.127" class="difflineplus">+  is(aWin.gDomains.displayedDomains.map(function(aDom) { return aDom.title; })</span>
<a href="#l7.128"></a><span id="l7.128" class="difflineplus">+                                   .join(&quot;,&quot;),</span>
<a href="#l7.129"></a><span id="l7.129" class="difflineplus">+     &quot;mochi.test,mozilla.org&quot;,</span>
<a href="#l7.130"></a><span id="l7.130" class="difflineplus">+     &quot;In search, the correct domains are listed&quot;);</span>
<a href="#l7.131"></a><span id="l7.131" class="difflineplus">+</span>
<a href="#l7.132"></a><span id="l7.132" class="difflineplus">+  aWin.gDomains.tree.view.selection.select(0);</span>
<a href="#l7.133"></a><span id="l7.133" class="difflineplus">+  aWin.document.getElementById(&quot;domainSearch&quot;).value = &quot;&quot;;</span>
<a href="#l7.134"></a><span id="l7.134" class="difflineplus">+  aWin.document.getElementById(&quot;domainSearch&quot;).doCommand();</span>
<a href="#l7.135"></a><span id="l7.135" class="difflineplus">+  is(aWin.gDomains.tree.view.rowCount, 14,</span>
<a href="#l7.136"></a><span id="l7.136" class="difflineplus">+     &quot;After search, the correct number of domains is listed&quot;);</span>
<a href="#l7.137"></a><span id="l7.137" class="difflineplus">+  is(aWin.gDomains.tree.view.selection.count, 1,</span>
<a href="#l7.138"></a><span id="l7.138" class="difflineplus">+     &quot;After search, number of selections is correct&quot;);</span>
<a href="#l7.139"></a><span id="l7.139" class="difflineplus">+  is(aWin.gDomains.selectedDomain.title, &quot;mochi.test&quot;,</span>
<a href="#l7.140"></a><span id="l7.140" class="difflineplus">+     &quot;After search, matching selection is kept correctly&quot;);</span>
<a href="#l7.141"></a><span id="l7.141" class="difflineplus">+</span>
<a href="#l7.142"></a><span id="l7.142" class="difflineplus">+  aWin.gDomains.tree.view.selection.select(0);</span>
<a href="#l7.143"></a><span id="l7.143" class="difflineplus">+  is(aWin.gDomains.selectedDomain.title, &quot;*&quot;,</span>
<a href="#l7.144"></a><span id="l7.144" class="difflineplus">+     &quot;* domain is selected again&quot;);</span>
<a href="#l7.145"></a><span id="l7.145" class="difflineplus">+  Services.obs.notifyObservers(window, TEST_DONE, null);</span>
<a href="#l7.146"></a><span id="l7.146" class="difflineplus">+},</span>
<a href="#l7.147"></a><span id="l7.147" class="difflineplus">+</span>
<a href="#l7.148"></a><span id="l7.148" class="difflineplus">+function test_fdata_panel(aWin) {</span>
<a href="#l7.149"></a><span id="l7.149" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;formdataPanel&quot;,</span>
<a href="#l7.150"></a><span id="l7.150" class="difflineplus">+     &quot;Form data panel is selected&quot;);</span>
<a href="#l7.151"></a><span id="l7.151" class="difflineplus">+  is(aWin.gFormdata.tree.view.rowCount, 6,</span>
<a href="#l7.152"></a><span id="l7.152" class="difflineplus">+     &quot;The correct number of form data entries is listed&quot;);</span>
<a href="#l7.153"></a><span id="l7.153" class="difflineplus">+</span>
<a href="#l7.154"></a><span id="l7.154" class="difflineplus">+  aWin.gFormdata.tree.view.selection.rangedSelect(0, 1, true); // item 0, 3</span>
<a href="#l7.155"></a><span id="l7.155" class="difflineplus">+  aWin.document.getElementById(&quot;fdataSearch&quot;).value = &quot;b&quot;; // item 3, 4 match</span>
<a href="#l7.156"></a><span id="l7.156" class="difflineplus">+  aWin.document.getElementById(&quot;fdataSearch&quot;).doCommand();</span>
<a href="#l7.157"></a><span id="l7.157" class="difflineplus">+  is(aWin.gFormdata.tree.view.selection.count, 1,</span>
<a href="#l7.158"></a><span id="l7.158" class="difflineplus">+     &quot;In search, non-matching part of selection is lost&quot;);</span>
<a href="#l7.159"></a><span id="l7.159" class="difflineplus">+  is(aWin.gFormdata.displayedFormdata[aWin.gFormdata.tree.currentIndex].value, &quot;value3&quot;,</span>
<a href="#l7.160"></a><span id="l7.160" class="difflineplus">+     &quot;In search, matching part selection is kept correctly&quot;);</span>
<a href="#l7.161"></a><span id="l7.161" class="difflineplus">+  is(aWin.gFormdata.tree.view.rowCount, 2,</span>
<a href="#l7.162"></a><span id="l7.162" class="difflineplus">+     &quot;In search, the correct number of form data entries is listed&quot;);</span>
<a href="#l7.163"></a><span id="l7.163" class="difflineplus">+  is(aWin.gFormdata.displayedFormdata.map(function(aFd) { return aFd.value; })</span>
<a href="#l7.164"></a><span id="l7.164" class="difflineplus">+                                     .join(&quot;,&quot;),</span>
<a href="#l7.165"></a><span id="l7.165" class="difflineplus">+     &quot;value3,value4&quot;,</span>
<a href="#l7.166"></a><span id="l7.166" class="difflineplus">+     &quot;In search, the correct domains are listed&quot;);</span>
<a href="#l7.167"></a><span id="l7.167" class="difflineplus">+</span>
<a href="#l7.168"></a><span id="l7.168" class="difflineplus">+  aWin.document.getElementById(&quot;fdataSearch&quot;).value = &quot;&quot;;</span>
<a href="#l7.169"></a><span id="l7.169" class="difflineplus">+  aWin.document.getElementById(&quot;fdataSearch&quot;).doCommand();</span>
<a href="#l7.170"></a><span id="l7.170" class="difflineplus">+  is(aWin.gFormdata.tree.view.rowCount, 6,</span>
<a href="#l7.171"></a><span id="l7.171" class="difflineplus">+     &quot;After search, the correct number of form data entries is listed&quot;);</span>
<a href="#l7.172"></a><span id="l7.172" class="difflineplus">+  is(aWin.gFormdata.tree.view.selection.count, 1,</span>
<a href="#l7.173"></a><span id="l7.173" class="difflineplus">+     &quot;After search, number of selections is correct&quot;);</span>
<a href="#l7.174"></a><span id="l7.174" class="difflineplus">+  is(aWin.gFormdata.displayedFormdata[aWin.gFormdata.tree.currentIndex].value, &quot;value3&quot;,</span>
<a href="#l7.175"></a><span id="l7.175" class="difflineplus">+     &quot;After search, matching selection is kept correctly&quot;);</span>
<a href="#l7.176"></a><span id="l7.176" class="difflineplus">+</span>
<a href="#l7.177"></a><span id="l7.177" class="difflineplus">+  aWin.gFormdata.tree.view.selection.clearSelection();</span>
<a href="#l7.178"></a><span id="l7.178" class="difflineplus">+  is(aWin.document.getElementById(&quot;fdataRemove&quot;).disabled, true,</span>
<a href="#l7.179"></a><span id="l7.179" class="difflineplus">+     &quot;The remove button is disabled&quot;);</span>
<a href="#l7.180"></a><span id="l7.180" class="difflineplus">+  aWin.gFormdata.tree.view.selection.rangedSelect(0, 1, true); // value0, value3</span>
<a href="#l7.181"></a><span id="l7.181" class="difflineplus">+  aWin.gFormdata.tree.view.selection.rangedSelect(3, 3, true); // value5</span>
<a href="#l7.182"></a><span id="l7.182" class="difflineplus">+  aWin.gFormdata.tree.view.selection.rangedSelect(5, 5, true); // value2</span>
<a href="#l7.183"></a><span id="l7.183" class="difflineplus">+  is(aWin.gFormdata.tree.view.selection.count, 4,</span>
<a href="#l7.184"></a><span id="l7.184" class="difflineplus">+     &quot;The correct number of items is selected&quot;);</span>
<a href="#l7.185"></a><span id="l7.185" class="difflineplus">+  is(aWin.document.getElementById(&quot;fdataRemove&quot;).disabled, false,</span>
<a href="#l7.186"></a><span id="l7.186" class="difflineplus">+     &quot;After selecting, the remove button is enabled&quot;);</span>
<a href="#l7.187"></a><span id="l7.187" class="difflineplus">+</span>
<a href="#l7.188"></a><span id="l7.188" class="difflineplus">+  gLocSvc.fhist.removeEntry(&quot;ckey&quot;, &quot;value5&quot;);</span>
<a href="#l7.189"></a><span id="l7.189" class="difflineplus">+  is(aWin.gFormdata.tree.view.rowCount, 5,</span>
<a href="#l7.190"></a><span id="l7.190" class="difflineplus">+     &quot;After remove, the correct number of form data entries is listed&quot;);</span>
<a href="#l7.191"></a><span id="l7.191" class="difflineplus">+  is(aWin.gFormdata.tree.view.selection.count, 3,</span>
<a href="#l7.192"></a><span id="l7.192" class="difflineplus">+     &quot;After remove, the correct number of items is selected&quot;);</span>
<a href="#l7.193"></a><span id="l7.193" class="difflineplus">+</span>
<a href="#l7.194"></a><span id="l7.194" class="difflineplus">+  gLocSvc.fhist.addEntry(&quot;dkey&quot;, &quot;value6&quot;);</span>
<a href="#l7.195"></a><span id="l7.195" class="difflineplus">+  is(aWin.gFormdata.tree.view.rowCount, 6,</span>
<a href="#l7.196"></a><span id="l7.196" class="difflineplus">+     &quot;After add, the correct number of form data entries is listed&quot;);</span>
<a href="#l7.197"></a><span id="l7.197" class="difflineplus">+  is(aWin.gFormdata.tree.view.selection.count, 3,</span>
<a href="#l7.198"></a><span id="l7.198" class="difflineplus">+     &quot;After add, the correct number of items is selected&quot;);</span>
<a href="#l7.199"></a><span id="l7.199" class="difflineplus">+</span>
<a href="#l7.200"></a><span id="l7.200" class="difflineplus">+  aWin.document.getElementById(&quot;fdataValueCol&quot;).click();</span>
<a href="#l7.201"></a><span id="l7.201" class="difflineplus">+  is(aWin.gFormdata.tree.view.selection.count, 3,</span>
<a href="#l7.202"></a><span id="l7.202" class="difflineplus">+     &quot;After sort, the correct number of items is selected&quot;);</span>
<a href="#l7.203"></a><span id="l7.203" class="difflineplus">+  is(aWin.gDataman.getTreeSelections(aWin.gFormdata.tree)</span>
<a href="#l7.204"></a><span id="l7.204" class="difflineplus">+                  .map(function(aSel) { return aWin.gFormdata.displayedFormdata[aSel].value; })</span>
<a href="#l7.205"></a><span id="l7.205" class="difflineplus">+                  .join(&quot;,&quot;),</span>
<a href="#l7.206"></a><span id="l7.206" class="difflineplus">+     &quot;value0,value2,value3&quot;,</span>
<a href="#l7.207"></a><span id="l7.207" class="difflineplus">+     &quot;After sort, correct items are selected&quot;);</span>
<a href="#l7.208"></a><span id="l7.208" class="difflineplus">+</span>
<a href="#l7.209"></a><span id="l7.209" class="difflineplus">+   // Select only one for testing remove button, as catching the prompt is hard.</span>
<a href="#l7.210"></a><span id="l7.210" class="difflineplus">+  aWin.gFormdata.tree.view.selection.select(5);</span>
<a href="#l7.211"></a><span id="l7.211" class="difflineplus">+  aWin.document.getElementById(&quot;fdataRemove&quot;).click();</span>
<a href="#l7.212"></a><span id="l7.212" class="difflineplus">+  is(aWin.gFormdata.tree.view.rowCount, 5,</span>
<a href="#l7.213"></a><span id="l7.213" class="difflineplus">+     &quot;After remove button, the correct number of form data entries is listed&quot;);</span>
<a href="#l7.214"></a><span id="l7.214" class="difflineplus">+  is(aWin.gFormdata.tree.view.selection.count, 0,</span>
<a href="#l7.215"></a><span id="l7.215" class="difflineplus">+     &quot;After remove button, no items are selected&quot;);</span>
<a href="#l7.216"></a><span id="l7.216" class="difflineplus">+  Services.obs.notifyObservers(window, TEST_DONE, null);</span>
<a href="#l7.217"></a><span id="l7.217" class="difflineplus">+},</span>
<a href="#l7.218"></a><span id="l7.218" class="difflineplus">+</span>
<a href="#l7.219"></a><span id="l7.219" class="difflineplus">+function test_cookies_panel(aWin) {</span>
<a href="#l7.220"></a><span id="l7.220" class="difflineplus">+  aWin.gDomains.tree.view.selection.select(7);</span>
<a href="#l7.221"></a><span id="l7.221" class="difflineplus">+  is(aWin.gDomains.selectedDomain.title, &quot;geckoisgecko.org&quot;,</span>
<a href="#l7.222"></a><span id="l7.222" class="difflineplus">+     &quot;For cookie tests 1, correct domain is selected&quot;);</span>
<a href="#l7.223"></a><span id="l7.223" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;cookiesPanel&quot;,</span>
<a href="#l7.224"></a><span id="l7.224" class="difflineplus">+     &quot;Cookies panel is selected&quot;);</span>
<a href="#l7.225"></a><span id="l7.225" class="difflineplus">+  is(aWin.gCookies.tree.view.rowCount, 3,</span>
<a href="#l7.226"></a><span id="l7.226" class="difflineplus">+     &quot;The correct number of cookies is listed&quot;);</span>
<a href="#l7.227"></a><span id="l7.227" class="difflineplus">+</span>
<a href="#l7.228"></a><span id="l7.228" class="difflineplus">+  aWin.gCookies.tree.view.selection.select(0);</span>
<a href="#l7.229"></a><span id="l7.229" class="difflineplus">+  is(aWin.document.getElementById(&quot;cookieInfoSendType&quot;).value,</span>
<a href="#l7.230"></a><span id="l7.230" class="difflineplus">+     &quot;Any type of connection&quot;,</span>
<a href="#l7.231"></a><span id="l7.231" class="difflineplus">+     &quot;Correct send type for first cookie&quot;);</span>
<a href="#l7.232"></a><span id="l7.232" class="difflineplus">+  is(aWin.document.getElementById(&quot;cookieInfoExpires&quot;).value,</span>
<a href="#l7.233"></a><span id="l7.233" class="difflineplus">+     &quot;At end of session&quot;,</span>
<a href="#l7.234"></a><span id="l7.234" class="difflineplus">+     &quot;Correct expiry label for first cookie&quot;);</span>
<a href="#l7.235"></a><span id="l7.235" class="difflineplus">+</span>
<a href="#l7.236"></a><span id="l7.236" class="difflineplus">+  aWin.gCookies.tree.view.selection.select(1);</span>
<a href="#l7.237"></a><span id="l7.237" class="difflineplus">+  is(aWin.document.getElementById(&quot;cookieInfoSendType&quot;).value,</span>
<a href="#l7.238"></a><span id="l7.238" class="difflineplus">+     &quot;Any type of connection, no script access&quot;,</span>
<a href="#l7.239"></a><span id="l7.239" class="difflineplus">+     &quot;Correct send type for second cookie&quot;);</span>
<a href="#l7.240"></a><span id="l7.240" class="difflineplus">+</span>
<a href="#l7.241"></a><span id="l7.241" class="difflineplus">+  aWin.gCookies.tree.view.selection.select(2);</span>
<a href="#l7.242"></a><span id="l7.242" class="difflineplus">+  is(aWin.document.getElementById(&quot;cookieInfoSendType&quot;).value,</span>
<a href="#l7.243"></a><span id="l7.243" class="difflineplus">+     &quot;Encrypted connections only and no script access&quot;,</span>
<a href="#l7.244"></a><span id="l7.244" class="difflineplus">+     &quot;Correct send type for third cookie&quot;);</span>
<a href="#l7.245"></a><span id="l7.245" class="difflineplus">+</span>
<a href="#l7.246"></a><span id="l7.246" class="difflineplus">+  aWin.gDomains.tree.view.selection.select(4);</span>
<a href="#l7.247"></a><span id="l7.247" class="difflineplus">+  is(aWin.gDomains.selectedDomain.title, &quot;drumbeat.org&quot;,</span>
<a href="#l7.248"></a><span id="l7.248" class="difflineplus">+     &quot;For cookie tests 2, correct domain is selected&quot;);</span>
<a href="#l7.249"></a><span id="l7.249" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;cookiesPanel&quot;,</span>
<a href="#l7.250"></a><span id="l7.250" class="difflineplus">+     &quot;Cookies panel is selected&quot;);</span>
<a href="#l7.251"></a><span id="l7.251" class="difflineplus">+  is(aWin.gCookies.tree.view.rowCount, 1,</span>
<a href="#l7.252"></a><span id="l7.252" class="difflineplus">+     &quot;The correct number of cookies is listed&quot;);</span>
<a href="#l7.253"></a><span id="l7.253" class="difflineplus">+  aWin.gCookies.updateContext(); // don't actually open it, would be async</span>
<a href="#l7.254"></a><span id="l7.254" class="difflineplus">+  is(aWin.document.getElementById(&quot;cookies-context-selectall&quot;).disabled, false,</span>
<a href="#l7.255"></a><span id="l7.255" class="difflineplus">+     &quot;The select all context menu item is enabled&quot;);</span>
<a href="#l7.256"></a><span id="l7.256" class="difflineplus">+  is(aWin.document.getElementById(&quot;cookies-context-remove&quot;).disabled, true,</span>
<a href="#l7.257"></a><span id="l7.257" class="difflineplus">+     &quot;The remove context menu item is disabled&quot;);</span>
<a href="#l7.258"></a><span id="l7.258" class="difflineplus">+</span>
<a href="#l7.259"></a><span id="l7.259" class="difflineplus">+  aWin.document.getElementById(&quot;cookies-context-selectall&quot;).click();</span>
<a href="#l7.260"></a><span id="l7.260" class="difflineplus">+  is(aWin.document.getElementById(&quot;cookieInfoSendType&quot;).value,</span>
<a href="#l7.261"></a><span id="l7.261" class="difflineplus">+     &quot;Encrypted connections only&quot;,</span>
<a href="#l7.262"></a><span id="l7.262" class="difflineplus">+     &quot;Correct send type for third cookie&quot;);</span>
<a href="#l7.263"></a><span id="l7.263" class="difflineplus">+  isnot(aWin.document.getElementById(&quot;cookieInfoExpires&quot;).value,</span>
<a href="#l7.264"></a><span id="l7.264" class="difflineplus">+        &quot;At end of session&quot;,</span>
<a href="#l7.265"></a><span id="l7.265" class="difflineplus">+        &quot;Expiry label for this cookie is not session&quot;);</span>
<a href="#l7.266"></a><span id="l7.266" class="difflineplus">+  aWin.gCookies.updateContext(); // don't actually open it, would be async</span>
<a href="#l7.267"></a><span id="l7.267" class="difflineplus">+  is(aWin.document.getElementById(&quot;cookies-context-selectall&quot;).disabled, true,</span>
<a href="#l7.268"></a><span id="l7.268" class="difflineplus">+     &quot;After selecting, the select all context menu item is disabled&quot;);</span>
<a href="#l7.269"></a><span id="l7.269" class="difflineplus">+  is(aWin.document.getElementById(&quot;cookies-context-remove&quot;).disabled, false,</span>
<a href="#l7.270"></a><span id="l7.270" class="difflineplus">+     &quot;After selecting, the remove context menu item is enabled&quot;);</span>
<a href="#l7.271"></a><span id="l7.271" class="difflineplus">+</span>
<a href="#l7.272"></a><span id="l7.272" class="difflineplus">+  aWin.document.getElementById(&quot;cookies-context-remove&quot;).click();</span>
<a href="#l7.273"></a><span id="l7.273" class="difflineplus">+  is(aWin.gDomains.tree.view.rowCount, 13,</span>
<a href="#l7.274"></a><span id="l7.274" class="difflineplus">+     &quot;The domain has been removed from the list&quot;);</span>
<a href="#l7.275"></a><span id="l7.275" class="difflineplus">+  is(aWin.gTabs.activePanel, null,</span>
<a href="#l7.276"></a><span id="l7.276" class="difflineplus">+     &quot;No panel is active&quot;);</span>
<a href="#l7.277"></a><span id="l7.277" class="difflineplus">+  is(aWin.gTabs.tabbox.selectedTab.disabled, true,</span>
<a href="#l7.278"></a><span id="l7.278" class="difflineplus">+     &quot;The selected panel is disabled&quot;);</span>
<a href="#l7.279"></a><span id="l7.279" class="difflineplus">+  Services.obs.notifyObservers(window, TEST_DONE, null);</span>
<a href="#l7.280"></a><span id="l7.280" class="difflineplus">+},</span>
<a href="#l7.281"></a><span id="l7.281" class="difflineplus">+</span>
<a href="#l7.282"></a><span id="l7.282" class="difflineplus">+function test_permissions_panel(aWin) {</span>
<a href="#l7.283"></a><span id="l7.283" class="difflineplus">+  aWin.gDomains.tree.view.selection.select(7);</span>
<a href="#l7.284"></a><span id="l7.284" class="difflineplus">+  is(aWin.gDomains.selectedDomain.title, &quot;getpersonas.com&quot;,</span>
<a href="#l7.285"></a><span id="l7.285" class="difflineplus">+     &quot;For permissions tests, correct domain is selected&quot;);</span>
<a href="#l7.286"></a><span id="l7.286" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;permissionsPanel&quot;,</span>
<a href="#l7.287"></a><span id="l7.287" class="difflineplus">+     &quot;Permissions panel is selected&quot;);</span>
<a href="#l7.288"></a><span id="l7.288" class="difflineplus">+  Services.perms.add(Services.io.newURI(&quot;http://cookie.getpersonas.com/&quot;, null, null),</span>
<a href="#l7.289"></a><span id="l7.289" class="difflineplus">+                     &quot;cookie&quot;, Components.interfaces.nsICookiePermission.ACCESS_SESSION);</span>
<a href="#l7.290"></a><span id="l7.290" class="difflineplus">+  Services.perms.add(Services.io.newURI(&quot;http://cookie2.getpersonas.com/&quot;, null, null),</span>
<a href="#l7.291"></a><span id="l7.291" class="difflineplus">+                     &quot;cookie&quot;, Services.perms.DENY_ACTION);</span>
<a href="#l7.292"></a><span id="l7.292" class="difflineplus">+  Services.perms.add(Services.io.newURI(&quot;http://geo.getpersonas.com/&quot;, null, null),</span>
<a href="#l7.293"></a><span id="l7.293" class="difflineplus">+                     &quot;geo&quot;, Services.perms.ALLOW_ACTION);</span>
<a href="#l7.294"></a><span id="l7.294" class="difflineplus">+  Services.perms.add(Services.io.newURI(&quot;http://image.getpersonas.com/&quot;, null, null),</span>
<a href="#l7.295"></a><span id="l7.295" class="difflineplus">+                     &quot;image&quot;, Services.perms.DENY_ACTION);</span>
<a href="#l7.296"></a><span id="l7.296" class="difflineplus">+  Services.perms.add(Services.io.newURI(&quot;http://install.getpersonas.com/&quot;, null, null),</span>
<a href="#l7.297"></a><span id="l7.297" class="difflineplus">+                     &quot;install&quot;, Services.perms.ALLOW_ACTION);</span>
<a href="#l7.298"></a><span id="l7.298" class="difflineplus">+  Services.perms.add(Services.io.newURI(&quot;http://popup.getpersonas.com/&quot;, null, null),</span>
<a href="#l7.299"></a><span id="l7.299" class="difflineplus">+                     &quot;popup&quot;, Services.perms.ALLOW_ACTION);</span>
<a href="#l7.300"></a><span id="l7.300" class="difflineplus">+  Services.perms.add(Services.io.newURI(&quot;http://test.getpersonas.com/&quot;, null, null),</span>
<a href="#l7.301"></a><span id="l7.301" class="difflineplus">+                     &quot;test&quot;, Services.perms.DENY_ACTION);</span>
<a href="#l7.302"></a><span id="l7.302" class="difflineplus">+  Services.perms.add(Services.io.newURI(&quot;http://xul.getpersonas.com/&quot;, null, null),</span>
<a href="#l7.303"></a><span id="l7.303" class="difflineplus">+                     &quot;allowXULXBL&quot;, Services.perms.ALLOW_ACTION);</span>
<a href="#l7.304"></a><span id="l7.304" class="difflineplus">+  gLocSvc.pwd.setLoginSavingEnabled(&quot;password.getpersonas.com&quot;, false);</span>
<a href="#l7.305"></a><span id="l7.305" class="difflineplus">+  is(aWin.gPerms.list.children.length, 10,</span>
<a href="#l7.306"></a><span id="l7.306" class="difflineplus">+     &quot;The correct number of permissions is displayed in the list&quot;);</span>
<a href="#l7.307"></a><span id="l7.307" class="difflineplus">+  for (let i = 1; i &lt; aWin.gPerms.list.children.length; i++) {</span>
<a href="#l7.308"></a><span id="l7.308" class="difflineplus">+    let perm = aWin.gPerms.list.children[i];</span>
<a href="#l7.309"></a><span id="l7.309" class="difflineplus">+    switch (perm.type) {</span>
<a href="#l7.310"></a><span id="l7.310" class="difflineplus">+      case &quot;allowXULXBL&quot;:</span>
<a href="#l7.311"></a><span id="l7.311" class="difflineplus">+        is(perm.labelElement.value, &quot;Use XUL/XBL Markup&quot;,</span>
<a href="#l7.312"></a><span id="l7.312" class="difflineplus">+           &quot;Correct label for type: &quot; + perm.type);</span>
<a href="#l7.313"></a><span id="l7.313" class="difflineplus">+        is(perm.capability, 1,</span>
<a href="#l7.314"></a><span id="l7.314" class="difflineplus">+           &quot;Correct capability for: &quot; + perm.host);</span>
<a href="#l7.315"></a><span id="l7.315" class="difflineplus">+        perm.useDefault(true);</span>
<a href="#l7.316"></a><span id="l7.316" class="difflineplus">+        is(perm.capability, 2,</span>
<a href="#l7.317"></a><span id="l7.317" class="difflineplus">+           &quot;Set back to correct default&quot;);</span>
<a href="#l7.318"></a><span id="l7.318" class="difflineplus">+        break;</span>
<a href="#l7.319"></a><span id="l7.319" class="difflineplus">+      case &quot;cookie&quot;:</span>
<a href="#l7.320"></a><span id="l7.320" class="difflineplus">+        is(perm.labelElement.value, &quot;Set Cookies&quot;,</span>
<a href="#l7.321"></a><span id="l7.321" class="difflineplus">+           &quot;Correct label for type: &quot; + perm.type);</span>
<a href="#l7.322"></a><span id="l7.322" class="difflineplus">+        is(perm.capability, perm.host == &quot;cookie.getpersonas.com&quot; ? 8 : 2,</span>
<a href="#l7.323"></a><span id="l7.323" class="difflineplus">+           &quot;Correct capability for: &quot; + perm.host);</span>
<a href="#l7.324"></a><span id="l7.324" class="difflineplus">+        perm.useDefault(true);</span>
<a href="#l7.325"></a><span id="l7.325" class="difflineplus">+        is(perm.capability, 1,</span>
<a href="#l7.326"></a><span id="l7.326" class="difflineplus">+           &quot;Set back to correct default&quot;);</span>
<a href="#l7.327"></a><span id="l7.327" class="difflineplus">+        break;</span>
<a href="#l7.328"></a><span id="l7.328" class="difflineplus">+      case &quot;geo&quot;:</span>
<a href="#l7.329"></a><span id="l7.329" class="difflineplus">+        is(perm.labelElement.value, &quot;Share Location&quot;,</span>
<a href="#l7.330"></a><span id="l7.330" class="difflineplus">+           &quot;Correct label for type: &quot; + perm.type);</span>
<a href="#l7.331"></a><span id="l7.331" class="difflineplus">+        is(perm.capability, 1,</span>
<a href="#l7.332"></a><span id="l7.332" class="difflineplus">+           &quot;Correct capability for: &quot; + perm.host);</span>
<a href="#l7.333"></a><span id="l7.333" class="difflineplus">+        perm.useDefault(true);</span>
<a href="#l7.334"></a><span id="l7.334" class="difflineplus">+        is(perm.capability, 2,</span>
<a href="#l7.335"></a><span id="l7.335" class="difflineplus">+           &quot;Set back to correct default&quot;);</span>
<a href="#l7.336"></a><span id="l7.336" class="difflineplus">+        break;</span>
<a href="#l7.337"></a><span id="l7.337" class="difflineplus">+      case &quot;image&quot;:</span>
<a href="#l7.338"></a><span id="l7.338" class="difflineplus">+        is(perm.labelElement.value, &quot;Load Images&quot;,</span>
<a href="#l7.339"></a><span id="l7.339" class="difflineplus">+           &quot;Correct label for type: &quot; + perm.type);</span>
<a href="#l7.340"></a><span id="l7.340" class="difflineplus">+        is(perm.capability, 2,</span>
<a href="#l7.341"></a><span id="l7.341" class="difflineplus">+           &quot;Correct capability for: &quot; + perm.host);</span>
<a href="#l7.342"></a><span id="l7.342" class="difflineplus">+        perm.useDefault(true);</span>
<a href="#l7.343"></a><span id="l7.343" class="difflineplus">+        is(perm.capability, 1,</span>
<a href="#l7.344"></a><span id="l7.344" class="difflineplus">+           &quot;Set back to correct default&quot;);</span>
<a href="#l7.345"></a><span id="l7.345" class="difflineplus">+        break;</span>
<a href="#l7.346"></a><span id="l7.346" class="difflineplus">+      case &quot;install&quot;:</span>
<a href="#l7.347"></a><span id="l7.347" class="difflineplus">+        is(perm.labelElement.value, &quot;Install Add-ons&quot;,</span>
<a href="#l7.348"></a><span id="l7.348" class="difflineplus">+           &quot;Correct label for type: &quot; + perm.type);</span>
<a href="#l7.349"></a><span id="l7.349" class="difflineplus">+        is(perm.capability, 1,</span>
<a href="#l7.350"></a><span id="l7.350" class="difflineplus">+           &quot;Correct capability for: &quot; + perm.host);</span>
<a href="#l7.351"></a><span id="l7.351" class="difflineplus">+        perm.useDefault(true);</span>
<a href="#l7.352"></a><span id="l7.352" class="difflineplus">+        is(perm.capability, 2,</span>
<a href="#l7.353"></a><span id="l7.353" class="difflineplus">+           &quot;Set back to correct default&quot;);</span>
<a href="#l7.354"></a><span id="l7.354" class="difflineplus">+        break;</span>
<a href="#l7.355"></a><span id="l7.355" class="difflineplus">+      case &quot;password&quot;:</span>
<a href="#l7.356"></a><span id="l7.356" class="difflineplus">+        is(perm.labelElement.value, &quot;Save Passwords&quot;,</span>
<a href="#l7.357"></a><span id="l7.357" class="difflineplus">+           &quot;Correct label for type: &quot; + perm.type);</span>
<a href="#l7.358"></a><span id="l7.358" class="difflineplus">+        is(perm.capability, 2,</span>
<a href="#l7.359"></a><span id="l7.359" class="difflineplus">+           &quot;Correct capability for: &quot; + perm.host);</span>
<a href="#l7.360"></a><span id="l7.360" class="difflineplus">+        perm.useDefault(true);</span>
<a href="#l7.361"></a><span id="l7.361" class="difflineplus">+        is(perm.capability, 1,</span>
<a href="#l7.362"></a><span id="l7.362" class="difflineplus">+           &quot;Set back to correct default&quot;);</span>
<a href="#l7.363"></a><span id="l7.363" class="difflineplus">+        break;</span>
<a href="#l7.364"></a><span id="l7.364" class="difflineplus">+      case &quot;popup&quot;:</span>
<a href="#l7.365"></a><span id="l7.365" class="difflineplus">+        is(perm.labelElement.value, &quot;Open Popup Windows&quot;,</span>
<a href="#l7.366"></a><span id="l7.366" class="difflineplus">+           &quot;Correct label for type: &quot; + perm.type);</span>
<a href="#l7.367"></a><span id="l7.367" class="difflineplus">+        is(perm.capability, 1,</span>
<a href="#l7.368"></a><span id="l7.368" class="difflineplus">+           &quot;Correct capability for: &quot; + perm.host);</span>
<a href="#l7.369"></a><span id="l7.369" class="difflineplus">+        perm.useDefault(true);</span>
<a href="#l7.370"></a><span id="l7.370" class="difflineplus">+        is(perm.capability, 1,</span>
<a href="#l7.371"></a><span id="l7.371" class="difflineplus">+           &quot;Set back to correct default&quot;);</span>
<a href="#l7.372"></a><span id="l7.372" class="difflineplus">+        break;</span>
<a href="#l7.373"></a><span id="l7.373" class="difflineplus">+      default:</span>
<a href="#l7.374"></a><span id="l7.374" class="difflineplus">+        is(perm.labelElement.value, perm.type,</span>
<a href="#l7.375"></a><span id="l7.375" class="difflineplus">+           &quot;Correct default label for type: &quot; + perm.type);</span>
<a href="#l7.376"></a><span id="l7.376" class="difflineplus">+        is(perm.capability, 2,</span>
<a href="#l7.377"></a><span id="l7.377" class="difflineplus">+           &quot;Correct capability for: &quot; + perm.host);</span>
<a href="#l7.378"></a><span id="l7.378" class="difflineplus">+        perm.useDefault(true);</span>
<a href="#l7.379"></a><span id="l7.379" class="difflineplus">+        is(perm.capability, 0,</span>
<a href="#l7.380"></a><span id="l7.380" class="difflineplus">+           &quot;Set to correct default&quot;);</span>
<a href="#l7.381"></a><span id="l7.381" class="difflineplus">+       break;</span>
<a href="#l7.382"></a><span id="l7.382" class="difflineplus">+    }</span>
<a href="#l7.383"></a><span id="l7.383" class="difflineplus">+  }</span>
<a href="#l7.384"></a><span id="l7.384" class="difflineplus">+</span>
<a href="#l7.385"></a><span id="l7.385" class="difflineplus">+  aWin.gDomains.tree.view.selection.select(0); // Switch to * domain.</span>
<a href="#l7.386"></a><span id="l7.386" class="difflineplus">+  aWin.gDomains.tree.view.selection.select(7); // Switch back to rebuild the perm list.</span>
<a href="#l7.387"></a><span id="l7.387" class="difflineplus">+  is(aWin.gPerms.list.children.length, 1,</span>
<a href="#l7.388"></a><span id="l7.388" class="difflineplus">+     &quot;After the test, the correct number of permissions is displayed in the list&quot;);</span>
<a href="#l7.389"></a><span id="l7.389" class="difflineplus">+  Services.obs.notifyObservers(window, TEST_DONE, null);</span>
<a href="#l7.390"></a><span id="l7.390" class="difflineplus">+},</span>
<a href="#l7.391"></a><span id="l7.391" class="difflineplus">+</span>
<a href="#l7.392"></a><span id="l7.392" class="difflineplus">+function test_prefs_panel(aWin) {</span>
<a href="#l7.393"></a><span id="l7.393" class="difflineplus">+  Services.contentPrefs.setPref(&quot;my.drumbeat.org&quot;, &quot;data_manager.test&quot;, &quot;foo&quot;);</span>
<a href="#l7.394"></a><span id="l7.394" class="difflineplus">+  Services.contentPrefs.setPref(&quot;drumbeat.org&quot;, &quot;data_manager.test&quot;, &quot;bar&quot;);</span>
<a href="#l7.395"></a><span id="l7.395" class="difflineplus">+  is(aWin.gDomains.tree.view.rowCount, 14,</span>
<a href="#l7.396"></a><span id="l7.396" class="difflineplus">+     &quot;The domain for prefs tests has been added from the list&quot;);</span>
<a href="#l7.397"></a><span id="l7.397" class="difflineplus">+  aWin.gDomains.tree.view.selection.select(4);</span>
<a href="#l7.398"></a><span id="l7.398" class="difflineplus">+  is(aWin.gDomains.selectedDomain.title, &quot;drumbeat.org&quot;,</span>
<a href="#l7.399"></a><span id="l7.399" class="difflineplus">+     &quot;For prefs tests, correct domain is selected&quot;);</span>
<a href="#l7.400"></a><span id="l7.400" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;preferencesPanel&quot;,</span>
<a href="#l7.401"></a><span id="l7.401" class="difflineplus">+     &quot;Preferences panel is selected&quot;);</span>
<a href="#l7.402"></a><span id="l7.402" class="difflineplus">+  is(aWin.gPrefs.tree.view.rowCount, 2,</span>
<a href="#l7.403"></a><span id="l7.403" class="difflineplus">+     &quot;The correct number of prefs is listed&quot;);</span>
<a href="#l7.404"></a><span id="l7.404" class="difflineplus">+</span>
<a href="#l7.405"></a><span id="l7.405" class="difflineplus">+  aWin.gDomains.updateContext(); // don't actually open it, would be async</span>
<a href="#l7.406"></a><span id="l7.406" class="difflineplus">+  is(aWin.document.getElementById(&quot;domain-context-forget&quot;).disabled, false,</span>
<a href="#l7.407"></a><span id="l7.407" class="difflineplus">+     &quot;The domain's forget context menu item is enabled&quot;);</span>
<a href="#l7.408"></a><span id="l7.408" class="difflineplus">+</span>
<a href="#l7.409"></a><span id="l7.409" class="difflineplus">+  aWin.document.getElementById(&quot;domain-context-forget&quot;).click();</span>
<a href="#l7.410"></a><span id="l7.410" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;forgetPanel&quot;,</span>
<a href="#l7.411"></a><span id="l7.411" class="difflineplus">+     &quot;Forget panel is selected&quot;);</span>
<a href="#l7.412"></a><span id="l7.412" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetTab&quot;).disabled, false,</span>
<a href="#l7.413"></a><span id="l7.413" class="difflineplus">+     &quot;Forget panel is enabled&quot;);</span>
<a href="#l7.414"></a><span id="l7.414" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetTab&quot;).hidden, false,</span>
<a href="#l7.415"></a><span id="l7.415" class="difflineplus">+     &quot;Forget panel is unhidden&quot;);</span>
<a href="#l7.416"></a><span id="l7.416" class="difflineplus">+</span>
<a href="#l7.417"></a><span id="l7.417" class="difflineplus">+  aWin.gDomains.tree.view.selection.select(3);</span>
<a href="#l7.418"></a><span id="l7.418" class="difflineplus">+  isnot(aWin.gDomains.selectedDomain.title, &quot;drumbeat.org&quot;,</span>
<a href="#l7.419"></a><span id="l7.419" class="difflineplus">+        &quot;Switching away goes to a different domain: &quot; + aWin.gDomains.selectedDomain.title);</span>
<a href="#l7.420"></a><span id="l7.420" class="difflineplus">+  isnot(aWin.gTabs.activePanel, &quot;forgetPanel&quot;,</span>
<a href="#l7.421"></a><span id="l7.421" class="difflineplus">+        &quot;Forget panel is not selected any more: &quot; + aWin.gTabs.activePanel);</span>
<a href="#l7.422"></a><span id="l7.422" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetTab&quot;).disabled, true,</span>
<a href="#l7.423"></a><span id="l7.423" class="difflineplus">+     &quot;Forget panel is disabled&quot;);</span>
<a href="#l7.424"></a><span id="l7.424" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetTab&quot;).hidden, true,</span>
<a href="#l7.425"></a><span id="l7.425" class="difflineplus">+     &quot;Forget panel is disabled&quot;);</span>
<a href="#l7.426"></a><span id="l7.426" class="difflineplus">+</span>
<a href="#l7.427"></a><span id="l7.427" class="difflineplus">+  aWin.gDomains.tree.view.selection.select(4);</span>
<a href="#l7.428"></a><span id="l7.428" class="difflineplus">+  is(aWin.gDomains.selectedDomain.title, &quot;drumbeat.org&quot;,</span>
<a href="#l7.429"></a><span id="l7.429" class="difflineplus">+     &quot;Correct domain is selected again&quot;);</span>
<a href="#l7.430"></a><span id="l7.430" class="difflineplus">+  aWin.document.getElementById(&quot;domain-context-forget&quot;).click();</span>
<a href="#l7.431"></a><span id="l7.431" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;forgetPanel&quot;,</span>
<a href="#l7.432"></a><span id="l7.432" class="difflineplus">+     &quot;Forget panel is selected again&quot;);</span>
<a href="#l7.433"></a><span id="l7.433" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetTab&quot;).disabled, false,</span>
<a href="#l7.434"></a><span id="l7.434" class="difflineplus">+     &quot;Forget panel is enabled again&quot;);</span>
<a href="#l7.435"></a><span id="l7.435" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetTab&quot;).hidden, false,</span>
<a href="#l7.436"></a><span id="l7.436" class="difflineplus">+     &quot;Forget panel is unhidden again&quot;);</span>
<a href="#l7.437"></a><span id="l7.437" class="difflineplus">+</span>
<a href="#l7.438"></a><span id="l7.438" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetPreferences&quot;).disabled, false,</span>
<a href="#l7.439"></a><span id="l7.439" class="difflineplus">+     &quot;Forget preferences checkbox is enabled&quot;);</span>
<a href="#l7.440"></a><span id="l7.440" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetButton&quot;).disabled, true,</span>
<a href="#l7.441"></a><span id="l7.441" class="difflineplus">+     &quot;Forget button is disabled&quot;);</span>
<a href="#l7.442"></a><span id="l7.442" class="difflineplus">+  aWin.document.getElementById(&quot;forgetPreferences&quot;).click();</span>
<a href="#l7.443"></a><span id="l7.443" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetPreferences&quot;).checked, true,</span>
<a href="#l7.444"></a><span id="l7.444" class="difflineplus">+     &quot;Forget preferences checkbox is checked&quot;);</span>
<a href="#l7.445"></a><span id="l7.445" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetButton&quot;).disabled, false,</span>
<a href="#l7.446"></a><span id="l7.446" class="difflineplus">+     &quot;Forget button is enabled&quot;);</span>
<a href="#l7.447"></a><span id="l7.447" class="difflineplus">+</span>
<a href="#l7.448"></a><span id="l7.448" class="difflineplus">+  aWin.document.getElementById(&quot;forgetButton&quot;).click();</span>
<a href="#l7.449"></a><span id="l7.449" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetButton&quot;).hidden, true,</span>
<a href="#l7.450"></a><span id="l7.450" class="difflineplus">+     &quot;Forget button is hidden&quot;);</span>
<a href="#l7.451"></a><span id="l7.451" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetPreferences&quot;).hidden, true,</span>
<a href="#l7.452"></a><span id="l7.452" class="difflineplus">+     &quot;Forget preferences checkbox is hidden&quot;);</span>
<a href="#l7.453"></a><span id="l7.453" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetPreferencesLabel&quot;).hidden, false,</span>
<a href="#l7.454"></a><span id="l7.454" class="difflineplus">+     &quot;Forget preferences label is shown&quot;);</span>
<a href="#l7.455"></a><span id="l7.455" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetTab&quot;).hidden, true,</span>
<a href="#l7.456"></a><span id="l7.456" class="difflineplus">+     &quot;Forget tab is hidden again&quot;);</span>
<a href="#l7.457"></a><span id="l7.457" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetTab&quot;).disabled, true,</span>
<a href="#l7.458"></a><span id="l7.458" class="difflineplus">+     &quot;Forget panel is disabled again&quot;);</span>
<a href="#l7.459"></a><span id="l7.459" class="difflineplus">+</span>
<a href="#l7.460"></a><span id="l7.460" class="difflineplus">+  is(aWin.gDomains.tree.view.rowCount, 13,</span>
<a href="#l7.461"></a><span id="l7.461" class="difflineplus">+     &quot;The domain for prefs tests has been removed from the list&quot;);</span>
<a href="#l7.462"></a><span id="l7.462" class="difflineplus">+  is(aWin.gDomains.tree.view.selection.count, 0,</span>
<a href="#l7.463"></a><span id="l7.463" class="difflineplus">+     &quot;No domain is selected&quot;);</span>
<a href="#l7.464"></a><span id="l7.464" class="difflineplus">+</span>
<a href="#l7.465"></a><span id="l7.465" class="difflineplus">+  aWin.gDomains.updateContext(); // don't actually open it, would be async</span>
<a href="#l7.466"></a><span id="l7.466" class="difflineplus">+  is(aWin.document.getElementById(&quot;domain-context-forget&quot;).disabled, true,</span>
<a href="#l7.467"></a><span id="l7.467" class="difflineplus">+     &quot;The domain's forget context menu item is disabled&quot;);</span>
<a href="#l7.468"></a><span id="l7.468" class="difflineplus">+  Services.obs.notifyObservers(window, TEST_DONE, null);</span>
<a href="#l7.469"></a><span id="l7.469" class="difflineplus">+},</span>
<a href="#l7.470"></a><span id="l7.470" class="difflineplus">+</span>
<a href="#l7.471"></a><span id="l7.471" class="difflineplus">+function test_passwords_panel(aWin) {</span>
<a href="#l7.472"></a><span id="l7.472" class="difflineplus">+  aWin.gDomains.tree.view.selection.select(6);</span>
<a href="#l7.473"></a><span id="l7.473" class="difflineplus">+  is(aWin.gDomains.selectedDomain.title, &quot;geckoisgecko.org&quot;,</span>
<a href="#l7.474"></a><span id="l7.474" class="difflineplus">+     &quot;For passwords tests, correct domain is selected&quot;);</span>
<a href="#l7.475"></a><span id="l7.475" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;cookiesPanel&quot;,</span>
<a href="#l7.476"></a><span id="l7.476" class="difflineplus">+     &quot;Cookies panel is selected&quot;);</span>
<a href="#l7.477"></a><span id="l7.477" class="difflineplus">+</span>
<a href="#l7.478"></a><span id="l7.478" class="difflineplus">+  aWin.gDomains.updateContext(); // don't actually open it, would be async</span>
<a href="#l7.479"></a><span id="l7.479" class="difflineplus">+  is(aWin.document.getElementById(&quot;domain-context-forget&quot;).disabled, false,</span>
<a href="#l7.480"></a><span id="l7.480" class="difflineplus">+     &quot;The domain's forget context menu item is enabled&quot;);</span>
<a href="#l7.481"></a><span id="l7.481" class="difflineplus">+</span>
<a href="#l7.482"></a><span id="l7.482" class="difflineplus">+  aWin.document.getElementById(&quot;domain-context-forget&quot;).click();</span>
<a href="#l7.483"></a><span id="l7.483" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;forgetPanel&quot;,</span>
<a href="#l7.484"></a><span id="l7.484" class="difflineplus">+     &quot;Forget panel is selected&quot;);</span>
<a href="#l7.485"></a><span id="l7.485" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetTab&quot;).disabled, false,</span>
<a href="#l7.486"></a><span id="l7.486" class="difflineplus">+     &quot;Forget panel is enabled&quot;);</span>
<a href="#l7.487"></a><span id="l7.487" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetTab&quot;).hidden, false,</span>
<a href="#l7.488"></a><span id="l7.488" class="difflineplus">+     &quot;Forget panel is unhidden&quot;);</span>
<a href="#l7.489"></a><span id="l7.489" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetPreferences&quot;).hidden, false,</span>
<a href="#l7.490"></a><span id="l7.490" class="difflineplus">+     &quot;Forget preferences checkbox is shown&quot;);</span>
<a href="#l7.491"></a><span id="l7.491" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetPreferences&quot;).disabled, true,</span>
<a href="#l7.492"></a><span id="l7.492" class="difflineplus">+     &quot;Forget preferences checkbox is disabled&quot;);</span>
<a href="#l7.493"></a><span id="l7.493" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetPreferencesLabel&quot;).hidden, true,</span>
<a href="#l7.494"></a><span id="l7.494" class="difflineplus">+     &quot;Forget preferences label is hidden&quot;);</span>
<a href="#l7.495"></a><span id="l7.495" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetCookies&quot;).hidden, false,</span>
<a href="#l7.496"></a><span id="l7.496" class="difflineplus">+     &quot;Forget cookies checkbox is shown&quot;);</span>
<a href="#l7.497"></a><span id="l7.497" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetCookies&quot;).disabled, false,</span>
<a href="#l7.498"></a><span id="l7.498" class="difflineplus">+     &quot;Forget cookies checkbox is enabled&quot;);</span>
<a href="#l7.499"></a><span id="l7.499" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetCookiesLabel&quot;).hidden, true,</span>
<a href="#l7.500"></a><span id="l7.500" class="difflineplus">+     &quot;Forget cookies label is hidden&quot;);</span>
<a href="#l7.501"></a><span id="l7.501" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetPasswords&quot;).hidden, false,</span>
<a href="#l7.502"></a><span id="l7.502" class="difflineplus">+     &quot;Forget passwords checkbox is shown&quot;);</span>
<a href="#l7.503"></a><span id="l7.503" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetPasswords&quot;).disabled, false,</span>
<a href="#l7.504"></a><span id="l7.504" class="difflineplus">+     &quot;Forget passwords checkbox is enabled&quot;);</span>
<a href="#l7.505"></a><span id="l7.505" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetPasswordsLabel&quot;).hidden, true,</span>
<a href="#l7.506"></a><span id="l7.506" class="difflineplus">+     &quot;Forget passwords label is hidden&quot;);</span>
<a href="#l7.507"></a><span id="l7.507" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetButton&quot;).hidden, false,</span>
<a href="#l7.508"></a><span id="l7.508" class="difflineplus">+     &quot;Forget button is shown&quot;);</span>
<a href="#l7.509"></a><span id="l7.509" class="difflineplus">+  is(aWin.document.getElementById(&quot;forgetButton&quot;).disabled, true,</span>
<a href="#l7.510"></a><span id="l7.510" class="difflineplus">+     &quot;Forget button is disabled&quot;);</span>
<a href="#l7.511"></a><span id="l7.511" class="difflineplus">+</span>
<a href="#l7.512"></a><span id="l7.512" class="difflineplus">+  aWin.gTabs.tabbox.selectedTab = aWin.document.getElementById(&quot;passwordsTab&quot;);</span>
<a href="#l7.513"></a><span id="l7.513" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;passwordsPanel&quot;,</span>
<a href="#l7.514"></a><span id="l7.514" class="difflineplus">+     &quot;Passwords panel is selected&quot;);</span>
<a href="#l7.515"></a><span id="l7.515" class="difflineplus">+  is(aWin.gPasswords.tree.view.rowCount, 2,</span>
<a href="#l7.516"></a><span id="l7.516" class="difflineplus">+     &quot;The correct number of passwords is listed&quot;);</span>
<a href="#l7.517"></a><span id="l7.517" class="difflineplus">+  is(aWin.document.getElementById(&quot;pwdRemove&quot;).disabled, true,</span>
<a href="#l7.518"></a><span id="l7.518" class="difflineplus">+     &quot;The remove button is disabled&quot;);</span>
<a href="#l7.519"></a><span id="l7.519" class="difflineplus">+</span>
<a href="#l7.520"></a><span id="l7.520" class="difflineplus">+  aWin.gPasswords.tree.view.selection.select(0);</span>
<a href="#l7.521"></a><span id="l7.521" class="difflineplus">+  is(aWin.document.getElementById(&quot;pwdRemove&quot;).disabled, false,</span>
<a href="#l7.522"></a><span id="l7.522" class="difflineplus">+     &quot;After selecting, the remove button is enabled&quot;);</span>
<a href="#l7.523"></a><span id="l7.523" class="difflineplus">+</span>
<a href="#l7.524"></a><span id="l7.524" class="difflineplus">+  aWin.document.getElementById(&quot;pwdRemove&quot;).click();</span>
<a href="#l7.525"></a><span id="l7.525" class="difflineplus">+  is(aWin.gPasswords.tree.view.rowCount, 1,</span>
<a href="#l7.526"></a><span id="l7.526" class="difflineplus">+     &quot;After deleting, the correct number of passwords is listed&quot;);</span>
<a href="#l7.527"></a><span id="l7.527" class="difflineplus">+  is(aWin.gPasswords.tree.view.selection.count, 0,</span>
<a href="#l7.528"></a><span id="l7.528" class="difflineplus">+     &quot;After deleting, no passwords are selected&quot;);</span>
<a href="#l7.529"></a><span id="l7.529" class="difflineplus">+  is(aWin.document.getElementById(&quot;pwdRemove&quot;).disabled, true,</span>
<a href="#l7.530"></a><span id="l7.530" class="difflineplus">+     &quot;After deleting, the remove button is disabled&quot;);</span>
<a href="#l7.531"></a><span id="l7.531" class="difflineplus">+</span>
<a href="#l7.532"></a><span id="l7.532" class="difflineplus">+  aWin.gPasswords.tree.view.selection.select(0);</span>
<a href="#l7.533"></a><span id="l7.533" class="difflineplus">+  aWin.document.getElementById(&quot;pwdRemove&quot;).click();</span>
<a href="#l7.534"></a><span id="l7.534" class="difflineplus">+  is(aWin.gTabs.activePanel, &quot;cookiesPanel&quot;,</span>
<a href="#l7.535"></a><span id="l7.535" class="difflineplus">+     &quot;After deleting last password, cookies panel is selected again&quot;);</span>
<a href="#l7.536"></a><span id="l7.536" class="difflineplus">+  Services.obs.notifyObservers(window, TEST_DONE, null);</span>
<a href="#l7.537"></a><span id="l7.537" class="difflineplus">+},</span>
<a href="#l7.538"></a><span id="l7.538" class="difflineplus">+</span>
<a href="#l7.539"></a><span id="l7.539" class="difflineplus">+function test_close(aWin) {</span>
<a href="#l7.540"></a><span id="l7.540" class="difflineplus">+  function dmWindowClosedListener() {</span>
<a href="#l7.541"></a><span id="l7.541" class="difflineplus">+    aWin.removeEventListener(&quot;unload&quot;, dmWindowClosedListener, false);</span>
<a href="#l7.542"></a><span id="l7.542" class="difflineplus">+    isnot(content.document.documentElement.id, &quot;dataman-page&quot;,</span>
<a href="#l7.543"></a><span id="l7.543" class="difflineplus">+       &quot;The active tab is not the Data Manager&quot;);</span>
<a href="#l7.544"></a><span id="l7.544" class="difflineplus">+    Services.obs.notifyObservers(window, TEST_DONE, null);</span>
<a href="#l7.545"></a><span id="l7.545" class="difflineplus">+  }</span>
<a href="#l7.546"></a><span id="l7.546" class="difflineplus">+  aWin.addEventListener(&quot;unload&quot;, dmWindowClosedListener, false);</span>
<a href="#l7.547"></a><span id="l7.547" class="difflineplus">+  aWin.close();</span>
<a href="#l7.548"></a><span id="l7.548" class="difflineplus">+}</span>
<a href="#l7.549"></a><span id="l7.549" class="difflineplus">+];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/suite/common/jar.mn</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/suite/common/jar.mn</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -123,16 +123,20 @@ comm.jar:</span>
<a href="#l8.4"></a><span id="l8.4">    content/communicator/bookmarks/bookmarksManager.js               (bookmarks/bookmarksManager.js)</span>
<a href="#l8.5"></a><span id="l8.5">    content/communicator/bookmarks/bookmarksManager.xul              (bookmarks/bookmarksManager.xul)</span>
<a href="#l8.6"></a><span id="l8.6">    content/communicator/bookmarks/browser-places.js                 (bookmarks/browser-places.js)</span>
<a href="#l8.7"></a><span id="l8.7">    content/communicator/bookmarks/editBookmarkOverlay.js            (bookmarks/editBookmarkOverlay.js)</span>
<a href="#l8.8"></a><span id="l8.8">    content/communicator/bookmarks/editBookmarkOverlay.xul           (bookmarks/editBookmarkOverlay.xul)</span>
<a href="#l8.9"></a><span id="l8.9">    content/communicator/bookmarks/moveBookmarks.js                  (bookmarks/moveBookmarks.js)</span>
<a href="#l8.10"></a><span id="l8.10">    content/communicator/bookmarks/moveBookmarks.xul                 (bookmarks/moveBookmarks.xul)</span>
<a href="#l8.11"></a><span id="l8.11">    content/communicator/bookmarks/placesOverlay.xul                 (bookmarks/placesOverlay.xul)</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+   content/communicator/dataman/dataman.css                         (dataman/dataman.css)</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+   content/communicator/dataman/dataman.js                          (dataman/dataman.js)</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+   content/communicator/dataman/dataman.xml                         (dataman/dataman.xml)</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+   content/communicator/dataman/dataman.xul                         (dataman/dataman.xul)</span>
<a href="#l8.16"></a><span id="l8.16">    content/communicator/directory/directory.html                    (directory/directory.html)</span>
<a href="#l8.17"></a><span id="l8.17">    content/communicator/directory/directory.js                      (directory/directory.js)</span>
<a href="#l8.18"></a><span id="l8.18">    content/communicator/directory/directory.xul                     (directory/directory.xul)</span>
<a href="#l8.19"></a><span id="l8.19">    content/communicator/downloads/downloadmanager.js                (downloads/downloadmanager.js)</span>
<a href="#l8.20"></a><span id="l8.20">    content/communicator/downloads/downloadmanager.xul               (downloads/downloadmanager.xul)</span>
<a href="#l8.21"></a><span id="l8.21">    content/communicator/downloads/DownloadProgressListener.js       (downloads/DownloadProgressListener.js)</span>
<a href="#l8.22"></a><span id="l8.22">    content/communicator/downloads/progressDialog.xul                (downloads/progressDialog.xul)</span>
<a href="#l8.23"></a><span id="l8.23">    content/communicator/downloads/progressDialog.js                 (downloads/progressDialog.js)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/suite/common/src/Makefile.in</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/suite/common/src/Makefile.in</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -42,16 +42,17 @@ VPATH		= @srcdir@</span>
<a href="#l9.4"></a><span id="l9.4"> </span>
<a href="#l9.5"></a><span id="l9.5"> include $(DEPTH)/config/autoconf.mk</span>
<a href="#l9.6"></a><span id="l9.6"> </span>
<a href="#l9.7"></a><span id="l9.7"> MODULE		= suitecommon</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9"> EXTRA_COMPONENTS = \</span>
<a href="#l9.10"></a><span id="l9.10"> 	nsAbout.js \</span>
<a href="#l9.11"></a><span id="l9.11"> 	nsAboutCertError.js \</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+	nsAboutData.js \</span>
<a href="#l9.13"></a><span id="l9.13"> 	nsAboutSessionRestore.js \</span>
<a href="#l9.14"></a><span id="l9.14"> 	nsSessionStartup.js \</span>
<a href="#l9.15"></a><span id="l9.15"> 	nsSidebar.js \</span>
<a href="#l9.16"></a><span id="l9.16"> 	SuiteCommon.manifest \</span>
<a href="#l9.17"></a><span id="l9.17"> 	nsSuiteDownloadManagerUI.js \</span>
<a href="#l9.18"></a><span id="l9.18"> 	nsSuiteGlue.js \</span>
<a href="#l9.19"></a><span id="l9.19"> 	$(NULL)</span>
<a href="#l9.20"></a><span id="l9.20"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/suite/common/src/SuiteCommon.manifest</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/suite/common/src/SuiteCommon.manifest</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -1,14 +1,16 @@</span>
<a href="#l10.4"></a><span id="l10.4"> component {08bbb4af-7bff-4b16-8ff7-d62f3ec5aa0c} nsSuiteDownloadManagerUI.js</span>
<a href="#l10.5"></a><span id="l10.5"> contract @mozilla.org/download-manager-ui;1 {08bbb4af-7bff-4b16-8ff7-d62f3ec5aa0c}</span>
<a href="#l10.6"></a><span id="l10.6"> component {d54f2c89-8fd6-4eeb-a7a4-51d4dcdf460f} nsAbout.js</span>
<a href="#l10.7"></a><span id="l10.7"> contract @mozilla.org/network/protocol/about;1?what= {d54f2c89-8fd6-4eeb-a7a4-51d4dcdf460f}</span>
<a href="#l10.8"></a><span id="l10.8"> component {b24861fb-e91a-40dd-886d-68d26a9586c7} nsAboutCertError.js</span>
<a href="#l10.9"></a><span id="l10.9"> contract @mozilla.org/network/protocol/about;1?what=certerror {b24861fb-e91a-40dd-886d-68d26a9586c7}</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineplus">+component {7a02e7fe-b32c-40ea-a790-246ca49b6061} nsAboutData.js</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineplus">+contract @mozilla.org/network/protocol/about;1?what=data {7a02e7fe-b32c-40ea-a790-246ca49b6061}</span>
<a href="#l10.12"></a><span id="l10.12"> component {a03c813e-abe8-41de-8d0c-5aa85f877696} nsAboutSessionRestore.js</span>
<a href="#l10.13"></a><span id="l10.13"> contract @mozilla.org/network/protocol/about;1?what=sessionrestore {a03c813e-abe8-41de-8d0c-5aa85f877696}</span>
<a href="#l10.14"></a><span id="l10.14"> component {4e6c1112-57b6-44ba-adf9-99fb573b0a30} nsSessionStartup.js</span>
<a href="#l10.15"></a><span id="l10.15"> contract @mozilla.org/suite/sessionstartup;1 {4e6c1112-57b6-44ba-adf9-99fb573b0a30}</span>
<a href="#l10.16"></a><span id="l10.16"> category app-startup SessionStartup service,@mozilla.org/suite/sessionstartup;1</span>
<a href="#l10.17"></a><span id="l10.17"> component {d37ccdf1-496f-4135-9575-037180af010d} nsSessionStore.js</span>
<a href="#l10.18"></a><span id="l10.18"> contract @mozilla.org/suite/sessionstore;1 {d37ccdf1-496f-4135-9575-037180af010d}</span>
<a href="#l10.19"></a><span id="l10.19"> component {bbbbe845-5a1b-40ee-813c-f84b8faaa07c} nsSuiteGlue.js</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">new file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- /dev/null</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ b/suite/common/src/nsAboutData.js</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -0,0 +1,58 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineplus">+ *</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+ *</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+ * License.</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+ *</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+ * The Original Code is the KaiRo's data manager.</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineplus">+ *</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineplus">+ * Robert Kaiser &lt;kairo@kairo.at&gt;.</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l11.24"></a><span id="l11.24" class="difflineplus">+ *</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineplus">+ *  Robert Kaiser &lt;kairo@kairo.at&gt; (original author)</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineplus">+ *</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l11.30"></a><span id="l11.30" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineplus">+ *</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineplus">+</span>
<a href="#l11.42"></a><span id="l11.42" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l11.43"></a><span id="l11.43" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l11.44"></a><span id="l11.44" class="difflineplus">+</span>
<a href="#l11.45"></a><span id="l11.45" class="difflineplus">+function AboutData() { }</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineplus">+AboutData.prototype = {</span>
<a href="#l11.47"></a><span id="l11.47" class="difflineplus">+  classID: Components.ID(&quot;{7a02e7fe-b32c-40ea-a790-246ca49b6061}&quot;),</span>
<a href="#l11.48"></a><span id="l11.48" class="difflineplus">+  QueryInterface: XPCOMUtils.generateQI([Components.interfaces.nsIAboutModule]),</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineplus">+</span>
<a href="#l11.50"></a><span id="l11.50" class="difflineplus">+  getURIFlags: function(aURI) {</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineplus">+    return Components.interfaces.nsIAboutModule.ALLOW_SCRIPT;</span>
<a href="#l11.52"></a><span id="l11.52" class="difflineplus">+  },</span>
<a href="#l11.53"></a><span id="l11.53" class="difflineplus">+</span>
<a href="#l11.54"></a><span id="l11.54" class="difflineplus">+  newChannel: function(aURI) {</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineplus">+    let channel = Services.io.newChannel(&quot;chrome://communicator/content/dataman/dataman.xul&quot;,</span>
<a href="#l11.56"></a><span id="l11.56" class="difflineplus">+                                         null, null);</span>
<a href="#l11.57"></a><span id="l11.57" class="difflineplus">+    channel.originalURI = aURI;</span>
<a href="#l11.58"></a><span id="l11.58" class="difflineplus">+    return channel;</span>
<a href="#l11.59"></a><span id="l11.59" class="difflineplus">+  }</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineplus">+};</span>
<a href="#l11.61"></a><span id="l11.61" class="difflineplus">+</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineplus">+var NSGetFactory = XPCOMUtils.generateNSGetFactory([AboutData]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/suite/common/tasksOverlay.xul</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/suite/common/tasksOverlay.xul</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -16,24 +16,29 @@</span>
<a href="#l12.4"></a><span id="l12.4"> &lt;keyset id=&quot;tasksKeys&quot;&gt;</span>
<a href="#l12.5"></a><span id="l12.5">   &lt;key id=&quot;key_navigator&quot;    key=&quot;&amp;navigatorCmd.commandkey;&quot;   command=&quot;Tasks:Navigator&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l12.6"></a><span id="l12.6">   &lt;key id=&quot;key_downloadManager&quot; key=&quot;&amp;downloadManagerCmd.commandkey;&quot;</span>
<a href="#l12.7"></a><span id="l12.7">        command=&quot;downloadmgr&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l12.8"></a><span id="l12.8">   &lt;key id=&quot;key_errorConsole&quot; key=&quot;&amp;errorConsoleCmd.commandkey;&quot;</span>
<a href="#l12.9"></a><span id="l12.9">        command=&quot;Tasks:ErrorConsole&quot; modifiers=&quot;accel,shift&quot;/&gt;</span>
<a href="#l12.10"></a><span id="l12.10"> &lt;/keyset&gt;</span>
<a href="#l12.11"></a><span id="l12.11"> &lt;commandset id=&quot;tasksCommands&quot;&gt;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+  &lt;command id=&quot;Tasks:DataMan&quot; oncommand=&quot;goAbout('data');&quot;/&gt;</span>
<a href="#l12.13"></a><span id="l12.13">   &lt;command id=&quot;Tasks:Navigator&quot; oncommand=&quot;toNavigator();&quot;/&gt;</span>
<a href="#l12.14"></a><span id="l12.14">   &lt;command id=&quot;Tasks:ErrorConsole&quot; oncommand=&quot;toJavaScriptConsole();&quot;/&gt;</span>
<a href="#l12.15"></a><span id="l12.15"> &lt;/commandset&gt;</span>
<a href="#l12.16"></a><span id="l12.16"> </span>
<a href="#l12.17"></a><span id="l12.17"> </span>
<a href="#l12.18"></a><span id="l12.18">       &lt;!-- Tasks Menu --&gt;</span>
<a href="#l12.19"></a><span id="l12.19">       &lt;menu id=&quot;tasksMenu&quot; label=&quot;&amp;tasksMenu.label;&quot; accesskey=&quot;&amp;tasksMenu.accesskey;&quot;&gt;</span>
<a href="#l12.20"></a><span id="l12.20">         &lt;menupopup id=&quot;taskPopup&quot;&gt;</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+          &lt;menuitem id=&quot;tasksDataman&quot;</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+                    label=&quot;&amp;datamanCmd.label;&quot;</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+                    accesskey=&quot;&amp;datamanCmd.accesskey;&quot;</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+                    command=&quot;Tasks:DataMan&quot;/&gt;</span>
<a href="#l12.25"></a><span id="l12.25">           &lt;menu id=&quot;menu_passwordManager&quot;</span>
<a href="#l12.26"></a><span id="l12.26">                 label=&quot;&amp;passwordManagerCmd.label;&quot;</span>
<a href="#l12.27"></a><span id="l12.27">                 accesskey=&quot;&amp;passwordManagerCmd.accesskey;&quot;&gt;</span>
<a href="#l12.28"></a><span id="l12.28">             &lt;menupopup id=&quot;passwordPopup&quot;&gt;</span>
<a href="#l12.29"></a><span id="l12.29">               &lt;menuitem label=&quot;&amp;passwordDisplayCmd.label;&quot;</span>
<a href="#l12.30"></a><span id="l12.30">                         accesskey=&quot;&amp;passwordDisplayCmd.accesskey;&quot;</span>
<a href="#l12.31"></a><span id="l12.31">                         oncommand=&quot;toPasswordManager();&quot;/&gt;</span>
<a href="#l12.32"></a><span id="l12.32">               &lt;menuitem label=&quot;&amp;passwordExpireCmd.label;&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/suite/installer/package-manifest.in</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/suite/installer/package-manifest.in</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -312,16 +312,17 @@</span>
<a href="#l13.4"></a><span id="l13.4"> ;#ifdef MOZ_IPC</span>
<a href="#l13.5"></a><span id="l13.5"> ;@BINPATH@/components/messageWakeupService.js</span>
<a href="#l13.6"></a><span id="l13.6"> ;@BINPATH@/components/messageWakeupService.manifest</span>
<a href="#l13.7"></a><span id="l13.7"> ;#endif</span>
<a href="#l13.8"></a><span id="l13.8"> @BINPATH@/components/NetworkGeolocationProvider.js</span>
<a href="#l13.9"></a><span id="l13.9"> @BINPATH@/components/NetworkGeolocationProvider.manifest</span>
<a href="#l13.10"></a><span id="l13.10"> @BINPATH@/components/nsAbout.js</span>
<a href="#l13.11"></a><span id="l13.11"> @BINPATH@/components/nsAboutCertError.js</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+@BINPATH@/components/nsAboutData.js</span>
<a href="#l13.13"></a><span id="l13.13"> @BINPATH@/components/nsAboutFeeds.js</span>
<a href="#l13.14"></a><span id="l13.14"> @BINPATH@/components/nsAboutRights.js</span>
<a href="#l13.15"></a><span id="l13.15"> @BINPATH@/components/nsAboutSessionRestore.js</span>
<a href="#l13.16"></a><span id="l13.16"> @BINPATH@/components/nsBadCertHandler.js</span>
<a href="#l13.17"></a><span id="l13.17"> @BINPATH@/components/nsBadCertHandler.manifest</span>
<a href="#l13.18"></a><span id="l13.18"> @BINPATH@/components/nsBlocklistService.js</span>
<a href="#l13.19"></a><span id="l13.19"> @BINPATH@/components/nsBrowserContentHandler.js</span>
<a href="#l13.20"></a><span id="l13.20"> @BINPATH@/components/nsComposerCmdLineHandler.js</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1">new file mode 100644</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineminus">--- /dev/null</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineplus">+++ b/suite/locales/en-US/chrome/common/dataman/dataman.dtd</span>
<a href="#l14.4"></a><span id="l14.4" class="difflineat">@@ -0,0 +1,159 @@</span>
<a href="#l14.5"></a><span id="l14.5" class="difflineplus">+&lt;!-- ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l14.6"></a><span id="l14.6" class="difflineplus">+   - Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l14.7"></a><span id="l14.7" class="difflineplus">+   -</span>
<a href="#l14.8"></a><span id="l14.8" class="difflineplus">+   - The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l14.9"></a><span id="l14.9" class="difflineplus">+   - 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l14.10"></a><span id="l14.10" class="difflineplus">+   - the License. You may obtain a copy of the License at</span>
<a href="#l14.11"></a><span id="l14.11" class="difflineplus">+   - http://www.mozilla.org/MPL/</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+   -</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+   - Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+   - WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+   - for the specific language governing rights and limitations under the</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineplus">+   - License.</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+   -</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineplus">+   - The Original Code is KaiRo's data manager.</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineplus">+   -</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineplus">+   - The Initial Developer of the Original Code is</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineplus">+   - Robert Kaiser &lt;kairo@kairo.at&gt;.</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineplus">+   - Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineplus">+   - the Initial Developer. All Rights Reserved.</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineplus">+   -</span>
<a href="#l14.25"></a><span id="l14.25" class="difflineplus">+   - Contributor(s):</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineplus">+   -   Robert Kaiser &lt;kairo@kairo.at&gt; (original author)</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineplus">+   -</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineplus">+   - Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l14.29"></a><span id="l14.29" class="difflineplus">+   - either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineplus">+   - the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineplus">+   - in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+   - of those above. If you wish to allow use of your version of this file only</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineplus">+   - under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineplus">+   - use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l14.35"></a><span id="l14.35" class="difflineplus">+   - decision by deleting the provisions above and replace them with the notice</span>
<a href="#l14.36"></a><span id="l14.36" class="difflineplus">+   - and other provisions required by the LGPL or the GPL. If you do not delete</span>
<a href="#l14.37"></a><span id="l14.37" class="difflineplus">+   - the provisions above, a recipient may use your version of this file under</span>
<a href="#l14.38"></a><span id="l14.38" class="difflineplus">+   - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l14.39"></a><span id="l14.39" class="difflineplus">+   -</span>
<a href="#l14.40"></a><span id="l14.40" class="difflineplus">+   - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineplus">+</span>
<a href="#l14.42"></a><span id="l14.42" class="difflineplus">+&lt;!ENTITY dataman.windowTitle &quot;Data Manager&quot;&gt;</span>
<a href="#l14.43"></a><span id="l14.43" class="difflineplus">+</span>
<a href="#l14.44"></a><span id="l14.44" class="difflineplus">+&lt;!ENTITY selectAll.key &quot;a&quot;&gt;</span>
<a href="#l14.45"></a><span id="l14.45" class="difflineplus">+</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineplus">+&lt;!ENTITY domain.search.placeholder &quot;Search Domains&quot;&gt;</span>
<a href="#l14.47"></a><span id="l14.47" class="difflineplus">+&lt;!ENTITY domain.search.key &quot;f&quot;&gt;</span>
<a href="#l14.48"></a><span id="l14.48" class="difflineplus">+</span>
<a href="#l14.49"></a><span id="l14.49" class="difflineplus">+&lt;!ENTITY domain.tree.domain.label &quot;Domain&quot;&gt;</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineplus">+</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+&lt;!ENTITY domain.ctx.forgetdomain.label &quot;Forget About This Domain&quot;&gt;</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+&lt;!ENTITY domain.ctx.forgetdomain.accesskey &quot;F&quot;&gt;</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineplus">+&lt;!ENTITY domain.ctx.forgetglobal.label &quot;Forget Global Data&quot;&gt;</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineplus">+&lt;!ENTITY domain.ctx.forgetglobal.accesskey &quot;F&quot;&gt;</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineplus">+</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineplus">+&lt;!ENTITY data.search.key &quot;k&quot;&gt;</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineplus">+</span>
<a href="#l14.58"></a><span id="l14.58" class="difflineplus">+&lt;!ENTITY tab.cookies.label &quot;Cookies&quot;&gt;</span>
<a href="#l14.59"></a><span id="l14.59" class="difflineplus">+&lt;!ENTITY tab.permissions.label &quot;Permissions&quot;&gt;</span>
<a href="#l14.60"></a><span id="l14.60" class="difflineplus">+&lt;!ENTITY tab.preferences.label &quot;Preferences&quot;&gt;</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineplus">+&lt;!ENTITY tab.passwords.label &quot;Passwords&quot;&gt;</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineplus">+&lt;!ENTITY tab.formdata.label &quot;Form Data&quot;&gt;</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineplus">+&lt;!ENTITY tab.forget.label &quot;Forget&quot;&gt;</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineplus">+</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineplus">+&lt;!-- cookies --&gt;</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineplus">+&lt;!ENTITY cookies.description &quot;This domain has stored the following cookies on your computer:&quot;&gt;</span>
<a href="#l14.67"></a><span id="l14.67" class="difflineplus">+</span>
<a href="#l14.68"></a><span id="l14.68" class="difflineplus">+&lt;!ENTITY cookies.tree.host.label &quot;Website&quot;&gt;</span>
<a href="#l14.69"></a><span id="l14.69" class="difflineplus">+&lt;!ENTITY cookies.tree.name.label &quot;Cookie Name&quot;&gt;</span>
<a href="#l14.70"></a><span id="l14.70" class="difflineplus">+&lt;!ENTITY cookies.tree.expires.label &quot;Expires&quot;&gt;</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineplus">+</span>
<a href="#l14.72"></a><span id="l14.72" class="difflineplus">+&lt;!ENTITY cookies.infobox.label &quot;Information about the selected Cookie&quot;&gt;</span>
<a href="#l14.73"></a><span id="l14.73" class="difflineplus">+</span>
<a href="#l14.74"></a><span id="l14.74" class="difflineplus">+&lt;!ENTITY cookies.info.name.label &quot;Name:&quot;&gt;</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineplus">+&lt;!ENTITY cookies.info.value.label &quot;Content:&quot;&gt;</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineplus">+&lt;!ENTITY cookies.info.host.label &quot;Host:&quot;&gt;</span>
<a href="#l14.77"></a><span id="l14.77" class="difflineplus">+&lt;!ENTITY cookies.info.domain.label &quot;Domain:&quot;&gt;</span>
<a href="#l14.78"></a><span id="l14.78" class="difflineplus">+&lt;!ENTITY cookies.info.path.label &quot;Path:&quot;&gt;</span>
<a href="#l14.79"></a><span id="l14.79" class="difflineplus">+&lt;!ENTITY cookies.info.sendtype.label &quot;Send For:&quot;&gt;</span>
<a href="#l14.80"></a><span id="l14.80" class="difflineplus">+&lt;!ENTITY cookies.info.expires.label &quot;Expires:&quot;&gt;</span>
<a href="#l14.81"></a><span id="l14.81" class="difflineplus">+</span>
<a href="#l14.82"></a><span id="l14.82" class="difflineplus">+&lt;!ENTITY cookies.ctx.remove.label &quot;Remove&quot;&gt;</span>
<a href="#l14.83"></a><span id="l14.83" class="difflineplus">+&lt;!ENTITY cookies.ctx.remove.accesskey &quot;R&quot;&gt;</span>
<a href="#l14.84"></a><span id="l14.84" class="difflineplus">+&lt;!ENTITY cookies.ctx.selectAll.label &quot;Select All&quot;&gt;</span>
<a href="#l14.85"></a><span id="l14.85" class="difflineplus">+&lt;!ENTITY cookies.ctx.selectAll.accesskey &quot;A&quot;&gt;</span>
<a href="#l14.86"></a><span id="l14.86" class="difflineplus">+</span>
<a href="#l14.87"></a><span id="l14.87" class="difflineplus">+&lt;!ENTITY cookies.button.remove.label &quot;Remove&quot;&gt;</span>
<a href="#l14.88"></a><span id="l14.88" class="difflineplus">+&lt;!ENTITY cookies.button.remove.accesskey &quot;R&quot;&gt;</span>
<a href="#l14.89"></a><span id="l14.89" class="difflineplus">+</span>
<a href="#l14.90"></a><span id="l14.90" class="difflineplus">+&lt;!ENTITY cookies.blockOnRemove.label &quot;When removing, block the listed websites from setting future cookies&quot;&gt;</span>
<a href="#l14.91"></a><span id="l14.91" class="difflineplus">+&lt;!ENTITY cookies.blockOnRemove.accesskey &quot;W&quot;&gt;</span>
<a href="#l14.92"></a><span id="l14.92" class="difflineplus">+</span>
<a href="#l14.93"></a><span id="l14.93" class="difflineplus">+&lt;!-- permissions --&gt;</span>
<a href="#l14.94"></a><span id="l14.94" class="difflineplus">+&lt;!ENTITY perm.UseDefault &quot;Use Default&quot;&gt;</span>
<a href="#l14.95"></a><span id="l14.95" class="difflineplus">+&lt;!ENTITY perm.AskAlways &quot;Always ask&quot;&gt;</span>
<a href="#l14.96"></a><span id="l14.96" class="difflineplus">+&lt;!ENTITY perm.NeverSave &quot;Never save&quot;&gt;</span>
<a href="#l14.97"></a><span id="l14.97" class="difflineplus">+&lt;!ENTITY perm.Allow &quot;Allow&quot;&gt;</span>
<a href="#l14.98"></a><span id="l14.98" class="difflineplus">+&lt;!ENTITY perm.AllowSession &quot;Allow for Session&quot;&gt;</span>
<a href="#l14.99"></a><span id="l14.99" class="difflineplus">+&lt;!ENTITY perm.Block &quot;Block&quot;&gt;</span>
<a href="#l14.100"></a><span id="l14.100" class="difflineplus">+</span>
<a href="#l14.101"></a><span id="l14.101" class="difflineplus">+&lt;!-- preferences --&gt;</span>
<a href="#l14.102"></a><span id="l14.102" class="difflineplus">+&lt;!ENTITY prefs.description &quot;Content preferences are a way for &amp;brandShortName; to save its settings, like zoom levels, specifically for a website.&quot;&gt;</span>
<a href="#l14.103"></a><span id="l14.103" class="difflineplus">+</span>
<a href="#l14.104"></a><span id="l14.104" class="difflineplus">+&lt;!ENTITY prefs.tree.host.label &quot;Website&quot;&gt;</span>
<a href="#l14.105"></a><span id="l14.105" class="difflineplus">+&lt;!ENTITY prefs.tree.name.label &quot;Preference Name&quot;&gt;</span>
<a href="#l14.106"></a><span id="l14.106" class="difflineplus">+&lt;!ENTITY prefs.tree.value.label &quot;Value&quot;&gt;</span>
<a href="#l14.107"></a><span id="l14.107" class="difflineplus">+</span>
<a href="#l14.108"></a><span id="l14.108" class="difflineplus">+&lt;!ENTITY prefs.ctx.remove.label &quot;Remove&quot;&gt;</span>
<a href="#l14.109"></a><span id="l14.109" class="difflineplus">+&lt;!ENTITY prefs.ctx.remove.accesskey &quot;R&quot;&gt;</span>
<a href="#l14.110"></a><span id="l14.110" class="difflineplus">+&lt;!ENTITY prefs.ctx.selectAll.label &quot;Select All&quot;&gt;</span>
<a href="#l14.111"></a><span id="l14.111" class="difflineplus">+&lt;!ENTITY prefs.ctx.selectAll.accesskey &quot;A&quot;&gt;</span>
<a href="#l14.112"></a><span id="l14.112" class="difflineplus">+</span>
<a href="#l14.113"></a><span id="l14.113" class="difflineplus">+&lt;!ENTITY prefs.button.remove.label &quot;Remove&quot;&gt;</span>
<a href="#l14.114"></a><span id="l14.114" class="difflineplus">+&lt;!ENTITY prefs.button.remove.accesskey &quot;R&quot;&gt;</span>
<a href="#l14.115"></a><span id="l14.115" class="difflineplus">+</span>
<a href="#l14.116"></a><span id="l14.116" class="difflineplus">+&lt;!-- passwords --&gt;</span>
<a href="#l14.117"></a><span id="l14.117" class="difflineplus">+&lt;!ENTITY pwd.description &quot;You have the following passwords stored for this domain:&quot;&gt;</span>
<a href="#l14.118"></a><span id="l14.118" class="difflineplus">+</span>
<a href="#l14.119"></a><span id="l14.119" class="difflineplus">+&lt;!ENTITY pwd.tree.host.label &quot;Website&quot;&gt;</span>
<a href="#l14.120"></a><span id="l14.120" class="difflineplus">+&lt;!ENTITY pwd.tree.username.label &quot;Username&quot;&gt;</span>
<a href="#l14.121"></a><span id="l14.121" class="difflineplus">+&lt;!ENTITY pwd.tree.password.label &quot;Password&quot;&gt;</span>
<a href="#l14.122"></a><span id="l14.122" class="difflineplus">+</span>
<a href="#l14.123"></a><span id="l14.123" class="difflineplus">+&lt;!ENTITY pwd.ctx.remove.label &quot;Remove&quot;&gt;</span>
<a href="#l14.124"></a><span id="l14.124" class="difflineplus">+&lt;!ENTITY pwd.ctx.remove.accesskey &quot;R&quot;&gt;</span>
<a href="#l14.125"></a><span id="l14.125" class="difflineplus">+&lt;!ENTITY pwd.ctx.copyPasswordCmd.label &quot;Copy Password&quot;&gt;</span>
<a href="#l14.126"></a><span id="l14.126" class="difflineplus">+&lt;!ENTITY pwd.ctx.copyPasswordCmd.accesskey &quot;C&quot;&gt;</span>
<a href="#l14.127"></a><span id="l14.127" class="difflineplus">+&lt;!ENTITY pwd.ctx.selectAll.label &quot;Select All&quot;&gt;</span>
<a href="#l14.128"></a><span id="l14.128" class="difflineplus">+&lt;!ENTITY pwd.ctx.selectAll.accesskey &quot;A&quot;&gt;</span>
<a href="#l14.129"></a><span id="l14.129" class="difflineplus">+</span>
<a href="#l14.130"></a><span id="l14.130" class="difflineplus">+&lt;!ENTITY pwd.button.remove.label &quot;Remove&quot;&gt;</span>
<a href="#l14.131"></a><span id="l14.131" class="difflineplus">+&lt;!ENTITY pwd.button.remove.accesskey &quot;R&quot;&gt;</span>
<a href="#l14.132"></a><span id="l14.132" class="difflineplus">+</span>
<a href="#l14.133"></a><span id="l14.133" class="difflineplus">+&lt;!-- form data --&gt;</span>
<a href="#l14.134"></a><span id="l14.134" class="difflineplus">+&lt;!ENTITY fdata.search.placeholder &quot;Search Field Data&quot;&gt;</span>
<a href="#l14.135"></a><span id="l14.135" class="difflineplus">+</span>
<a href="#l14.136"></a><span id="l14.136" class="difflineplus">+&lt;!ENTITY fdata.tree.fieldname.label &quot;Field Name&quot;&gt;</span>
<a href="#l14.137"></a><span id="l14.137" class="difflineplus">+&lt;!ENTITY fdata.tree.value.label &quot;Entered Value&quot;&gt;</span>
<a href="#l14.138"></a><span id="l14.138" class="difflineplus">+&lt;!ENTITY fdata.tree.usecount.label &quot;Use Count&quot;&gt;</span>
<a href="#l14.139"></a><span id="l14.139" class="difflineplus">+&lt;!ENTITY fdata.tree.firstused.label &quot;First Used&quot;&gt;</span>
<a href="#l14.140"></a><span id="l14.140" class="difflineplus">+&lt;!ENTITY fdata.tree.lastused.label &quot;Last Used&quot;&gt;</span>
<a href="#l14.141"></a><span id="l14.141" class="difflineplus">+</span>
<a href="#l14.142"></a><span id="l14.142" class="difflineplus">+&lt;!ENTITY fdata.ctx.remove.label &quot;Remove&quot;&gt;</span>
<a href="#l14.143"></a><span id="l14.143" class="difflineplus">+&lt;!ENTITY fdata.ctx.remove.accesskey &quot;R&quot;&gt;</span>
<a href="#l14.144"></a><span id="l14.144" class="difflineplus">+&lt;!ENTITY fdata.ctx.selectAll.label &quot;Select All&quot;&gt;</span>
<a href="#l14.145"></a><span id="l14.145" class="difflineplus">+&lt;!ENTITY fdata.ctx.selectAll.accesskey &quot;A&quot;&gt;</span>
<a href="#l14.146"></a><span id="l14.146" class="difflineplus">+</span>
<a href="#l14.147"></a><span id="l14.147" class="difflineplus">+&lt;!ENTITY fdata.button.remove.label &quot;Remove&quot;&gt;</span>
<a href="#l14.148"></a><span id="l14.148" class="difflineplus">+&lt;!ENTITY fdata.button.remove.accesskey &quot;R&quot;&gt;</span>
<a href="#l14.149"></a><span id="l14.149" class="difflineplus">+</span>
<a href="#l14.150"></a><span id="l14.150" class="difflineplus">+&lt;!-- forget --&gt;</span>
<a href="#l14.151"></a><span id="l14.151" class="difflineplus">+&lt;!ENTITY forget.cookies.label &quot;Cookies&quot;&gt;</span>
<a href="#l14.152"></a><span id="l14.152" class="difflineplus">+&lt;!ENTITY forget.cookies.accesskey &quot;C&quot;&gt;</span>
<a href="#l14.153"></a><span id="l14.153" class="difflineplus">+&lt;!ENTITY forget.permissions.label &quot;Permissions&quot;&gt;</span>
<a href="#l14.154"></a><span id="l14.154" class="difflineplus">+&lt;!ENTITY forget.permissions.accesskey &quot;P&quot;&gt;</span>
<a href="#l14.155"></a><span id="l14.155" class="difflineplus">+&lt;!ENTITY forget.preferences.label &quot;Content Preferences&quot;&gt;</span>
<a href="#l14.156"></a><span id="l14.156" class="difflineplus">+&lt;!ENTITY forget.preferences.accesskey &quot;o&quot;&gt;</span>
<a href="#l14.157"></a><span id="l14.157" class="difflineplus">+&lt;!ENTITY forget.passwords.label &quot;Passwords&quot;&gt;</span>
<a href="#l14.158"></a><span id="l14.158" class="difflineplus">+&lt;!ENTITY forget.passwords.accesskey &quot;a&quot;&gt;</span>
<a href="#l14.159"></a><span id="l14.159" class="difflineplus">+&lt;!ENTITY forget.formdata.label &quot;Form Data&quot;&gt;</span>
<a href="#l14.160"></a><span id="l14.160" class="difflineplus">+&lt;!ENTITY forget.formdata.accesskey &quot;D&quot;&gt;</span>
<a href="#l14.161"></a><span id="l14.161" class="difflineplus">+</span>
<a href="#l14.162"></a><span id="l14.162" class="difflineplus">+&lt;!ENTITY forget.button.label &quot;Forget This Data&quot;&gt;</span>
<a href="#l14.163"></a><span id="l14.163" class="difflineplus">+&lt;!ENTITY forget.button.accesskey &quot;F&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1">new file mode 100644</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineminus">--- /dev/null</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineplus">+++ b/suite/locales/en-US/chrome/common/dataman/dataman.properties</span>
<a href="#l15.4"></a><span id="l15.4" class="difflineat">@@ -0,0 +1,84 @@</span>
<a href="#l15.5"></a><span id="l15.5" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l15.6"></a><span id="l15.6" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l15.7"></a><span id="l15.7" class="difflineplus">+#</span>
<a href="#l15.8"></a><span id="l15.8" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l15.9"></a><span id="l15.9" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l15.10"></a><span id="l15.10" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l15.11"></a><span id="l15.11" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineplus">+#</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+# License.</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineplus">+#</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineplus">+# The Original Code is KaiRo's data manager.</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+#</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineplus">+# Robert Kaiser &lt;kairo@kairo.at&gt;.</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineplus">+#</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+# Contributor(s):</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+#  Robert Kaiser &lt;kairo@kairo.at&gt; (original author)</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineplus">+#</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineplus">+#</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineplus">+</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineplus">+# cookies</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineplus">+cookies.expireAtEndOfSession=At end of session</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineplus">+</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineplus">+cookies.secureOnly.httponly=Encrypted connections only and no script access</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineplus">+cookies.secureOnly.all=Encrypted connections only</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineplus">+cookies.anyConnection.httponly=Any type of connection, no script access</span>
<a href="#l15.48"></a><span id="l15.48" class="difflineplus">+cookies.anyConnection.all=Any type of connection</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineplus">+</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineplus">+cookies.deleteSelected=Are you sure you want to delete the selected cookies?</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineplus">+cookies.deleteSelectedTitle=Remove Selected Cookies</span>
<a href="#l15.52"></a><span id="l15.52" class="difflineplus">+cookies.deleteSelectedYes=&amp;Remove</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineplus">+</span>
<a href="#l15.54"></a><span id="l15.54" class="difflineplus">+# permissions</span>
<a href="#l15.55"></a><span id="l15.55" class="difflineplus">+perm.allowXULXBL.label=Use XUL/XBL Markup</span>
<a href="#l15.56"></a><span id="l15.56" class="difflineplus">+perm.cookie.label=Set Cookies</span>
<a href="#l15.57"></a><span id="l15.57" class="difflineplus">+perm.geo.label=Share Location</span>
<a href="#l15.58"></a><span id="l15.58" class="difflineplus">+perm.image.label=Load Images</span>
<a href="#l15.59"></a><span id="l15.59" class="difflineplus">+perm.install.label=Install Add-ons</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineplus">+perm.password.label=Save Passwords</span>
<a href="#l15.61"></a><span id="l15.61" class="difflineplus">+perm.popup.label=Open Popup Windows</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineplus">+</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineplus">+# passwords</span>
<a href="#l15.64"></a><span id="l15.64" class="difflineplus">+pwd.hidePasswords=Hide Passwords</span>
<a href="#l15.65"></a><span id="l15.65" class="difflineplus">+pwd.hidePasswords.accesskey=P</span>
<a href="#l15.66"></a><span id="l15.66" class="difflineplus">+pwd.showPasswords=Show Passwords</span>
<a href="#l15.67"></a><span id="l15.67" class="difflineplus">+pwd.showPasswords.accesskey=P</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineplus">+pwd.noMasterPasswordPrompt=Are you sure you wish to show your passwords?</span>
<a href="#l15.69"></a><span id="l15.69" class="difflineplus">+</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineplus">+pwd.deleteSelected=Are you sure you want to delete the selected passwords?</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineplus">+pwd.deleteSelectedTitle=Remove Selected Passwords</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineplus">+pwd.deleteSelectedYes=&amp;Remove</span>
<a href="#l15.73"></a><span id="l15.73" class="difflineplus">+</span>
<a href="#l15.74"></a><span id="l15.74" class="difflineplus">+# preferences</span>
<a href="#l15.75"></a><span id="l15.75" class="difflineplus">+prefs.deleteSelected=Are you sure you want to delete the selected preferences?</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineplus">+prefs.deleteSelectedTitle=Remove Selected Preferences</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineplus">+prefs.deleteSelectedYes=&amp;Remove</span>
<a href="#l15.78"></a><span id="l15.78" class="difflineplus">+</span>
<a href="#l15.79"></a><span id="l15.79" class="difflineplus">+# form data</span>
<a href="#l15.80"></a><span id="l15.80" class="difflineplus">+fdata.deleteSelected=Are you sure you want to delete the selected form history entries?</span>
<a href="#l15.81"></a><span id="l15.81" class="difflineplus">+fdata.deleteSelectedTitle=Remove Selected Form Data</span>
<a href="#l15.82"></a><span id="l15.82" class="difflineplus">+fdata.deleteSelectedYes=&amp;Remove</span>
<a href="#l15.83"></a><span id="l15.83" class="difflineplus">+</span>
<a href="#l15.84"></a><span id="l15.84" class="difflineplus">+# forget</span>
<a href="#l15.85"></a><span id="l15.85" class="difflineplus">+forget.desc.domain.pre=Forget about all data of the following types associated with the domain &quot;%S&quot;:</span>
<a href="#l15.86"></a><span id="l15.86" class="difflineplus">+forget.desc.domain.post=All data associated with the domain &quot;%S&quot; of the following types has been deleted:</span>
<a href="#l15.87"></a><span id="l15.87" class="difflineplus">+forget.desc.global.pre=Forget about all global data of the following types:</span>
<a href="#l15.88"></a><span id="l15.88" class="difflineplus">+forget.desc.global.post=All global data of the following types has been deleted:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/suite/locales/en-US/chrome/common/tasksOverlay.dtd</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/common/tasksOverlay.dtd</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -18,16 +18,19 @@</span>
<a href="#l16.4"></a><span id="l16.4"> &lt;!ENTITY webDevelopment.accesskey &quot;W&quot;&gt;</span>
<a href="#l16.5"></a><span id="l16.5"> </span>
<a href="#l16.6"></a><span id="l16.6"> &lt;!ENTITY windowMenu.label &quot;Window&quot;&gt;</span>
<a href="#l16.7"></a><span id="l16.7"> &lt;!ENTITY windowMenu.accesskey &quot;W&quot;&gt;</span>
<a href="#l16.8"></a><span id="l16.8"> </span>
<a href="#l16.9"></a><span id="l16.9"> &lt;!ENTITY tasksMenu.label &quot;Tools&quot;&gt;</span>
<a href="#l16.10"></a><span id="l16.10"> &lt;!ENTITY tasksMenu.accesskey &quot;T&quot;&gt; </span>
<a href="#l16.11"></a><span id="l16.11"> </span>
<a href="#l16.12"></a><span id="l16.12" class="difflineplus">+&lt;!ENTITY datamanCmd.label &quot;Data Manager&quot;&gt;</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+&lt;!ENTITY datamanCmd.accesskey &quot;M&quot;&gt;</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+</span>
<a href="#l16.15"></a><span id="l16.15"> &lt;!ENTITY passwordManagerCmd.label &quot;Password Manager&quot;&gt;</span>
<a href="#l16.16"></a><span id="l16.16"> &lt;!ENTITY passwordManagerCmd.accesskey &quot;P&quot;&gt;</span>
<a href="#l16.17"></a><span id="l16.17"> </span>
<a href="#l16.18"></a><span id="l16.18"> &lt;!ENTITY passwordDisplayCmd.label &quot;Manage Stored Passwords&quot;&gt;</span>
<a href="#l16.19"></a><span id="l16.19"> &lt;!ENTITY passwordDisplayCmd.accesskey &quot;M&quot;&gt;</span>
<a href="#l16.20"></a><span id="l16.20"> </span>
<a href="#l16.21"></a><span id="l16.21"> &lt;!ENTITY passwordExpireCmd.label &quot;Log Out&quot;&gt;</span>
<a href="#l16.22"></a><span id="l16.22"> &lt;!ENTITY passwordExpireCmd.accesskey &quot;l&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/suite/locales/jar.mn</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/suite/locales/jar.mn</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -42,16 +42,18 @@</span>
<a href="#l17.4"></a><span id="l17.4">   locale/@AB_CD@/communicator/utilityOverlay.properties                     (%chrome/common/utilityOverlay.properties)</span>
<a href="#l17.5"></a><span id="l17.5">   locale/@AB_CD@/communicator/viewZoomOverlay.dtd                           (%chrome/common/viewZoomOverlay.dtd)</span>
<a href="#l17.6"></a><span id="l17.6">   locale/@AB_CD@/communicator/viewZoomOverlay.properties                    (%chrome/common/viewZoomOverlay.properties)</span>
<a href="#l17.7"></a><span id="l17.7">   locale/@AB_CD@/communicator/aboutSessionRestore.dtd                       (%chrome/common/aboutSessionRestore.dtd)</span>
<a href="#l17.8"></a><span id="l17.8">   locale/@AB_CD@/communicator/bookmarks/bm-props.properties                 (%chrome/common/bookmarks/bm-props.properties)</span>
<a href="#l17.9"></a><span id="l17.9">   locale/@AB_CD@/communicator/bookmarks/editBookmarkOverlay.dtd             (%chrome/common/bookmarks/editBookmarkOverlay.dtd)</span>
<a href="#l17.10"></a><span id="l17.10">   locale/@AB_CD@/communicator/bookmarks/moveBookmarks.dtd                   (%chrome/common/bookmarks/moveBookmarks.dtd)</span>
<a href="#l17.11"></a><span id="l17.11">   locale/@AB_CD@/communicator/bookmarks/places.dtd                          (%chrome/common/bookmarks/places.dtd)</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+  locale/@AB_CD@/communicator/dataman/dataman.dtd                           (%chrome/common/dataman/dataman.dtd)</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+  locale/@AB_CD@/communicator/dataman/dataman.properties                    (%chrome/common/dataman/dataman.properties)</span>
<a href="#l17.14"></a><span id="l17.14">   locale/@AB_CD@/communicator/directory/directory.dtd                       (%chrome/common/directory/directory.dtd)</span>
<a href="#l17.15"></a><span id="l17.15">   locale/@AB_CD@/communicator/downloads/downloadmanager.dtd                 (%chrome/common/downloads/downloadmanager.dtd)</span>
<a href="#l17.16"></a><span id="l17.16">   locale/@AB_CD@/communicator/downloads/downloadmanager.properties          (%chrome/common/downloads/downloadmanager.properties)</span>
<a href="#l17.17"></a><span id="l17.17">   locale/@AB_CD@/communicator/downloads/progressDialog.dtd                  (%chrome/common/downloads/progressDialog.dtd)</span>
<a href="#l17.18"></a><span id="l17.18">   locale/@AB_CD@/communicator/help/cert_dialog_help.xhtml                   (%chrome/common/help/cert_dialog_help.xhtml)</span>
<a href="#l17.19"></a><span id="l17.19">   locale/@AB_CD@/communicator/help/certs_help.xhtml                         (%chrome/common/help/certs_help.xhtml)</span>
<a href="#l17.20"></a><span id="l17.20">   locale/@AB_CD@/communicator/help/certs_prefs_help.xhtml                   (%chrome/common/help/certs_prefs_help.xhtml)</span>
<a href="#l17.21"></a><span id="l17.21">   locale/@AB_CD@/communicator/help/composer_help.xhtml                      (%chrome/common/help/composer_help.xhtml)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1">new file mode 100644</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineminus">--- /dev/null</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineplus">+++ b/suite/themes/classic/communicator/dataman/dataman.css</span>
<a href="#l18.4"></a><span id="l18.4" class="difflineat">@@ -0,0 +1,60 @@</span>
<a href="#l18.5"></a><span id="l18.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l18.6"></a><span id="l18.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l18.7"></a><span id="l18.7" class="difflineplus">+ *</span>
<a href="#l18.8"></a><span id="l18.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l18.9"></a><span id="l18.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineplus">+ *</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineplus">+ * License.</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineplus">+ *</span>
<a href="#l18.18"></a><span id="l18.18" class="difflineplus">+ * The Original Code is KaiRo's data manager.</span>
<a href="#l18.19"></a><span id="l18.19" class="difflineplus">+ *</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineplus">+ * Robert Kaiser &lt;kairo@kairo.at&gt;.</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l18.24"></a><span id="l18.24" class="difflineplus">+ *</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineplus">+ *   Robert Kaiser &lt;kairo@kairo.at&gt; (original author)</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineplus">+ *</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineplus">+ * either of the GNU General Public License Version 2 or later (the &quot;GPL&quot;),</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineplus">+ * or the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l18.33"></a><span id="l18.33" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l18.37"></a><span id="l18.37" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l18.38"></a><span id="l18.38" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l18.39"></a><span id="l18.39" class="difflineplus">+ *</span>
<a href="#l18.40"></a><span id="l18.40" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l18.41"></a><span id="l18.41" class="difflineplus">+</span>
<a href="#l18.42"></a><span id="l18.42" class="difflineplus">+#permList {</span>
<a href="#l18.43"></a><span id="l18.43" class="difflineplus">+  margin-top: .5em;</span>
<a href="#l18.44"></a><span id="l18.44" class="difflineplus">+  overflow: auto;</span>
<a href="#l18.45"></a><span id="l18.45" class="difflineplus">+}</span>
<a href="#l18.46"></a><span id="l18.46" class="difflineplus">+</span>
<a href="#l18.47"></a><span id="l18.47" class="difflineplus">+.permission {</span>
<a href="#l18.48"></a><span id="l18.48" class="difflineplus">+  padding-top: 6px;</span>
<a href="#l18.49"></a><span id="l18.49" class="difflineplus">+  padding-bottom: 6px;</span>
<a href="#l18.50"></a><span id="l18.50" class="difflineplus">+  -moz-padding-start: 7px;</span>
<a href="#l18.51"></a><span id="l18.51" class="difflineplus">+  -moz-padding-end: 7px;</span>
<a href="#l18.52"></a><span id="l18.52" class="difflineplus">+  min-height: 25px;</span>
<a href="#l18.53"></a><span id="l18.53" class="difflineplus">+  border-bottom: 1px dotted ThreeDFace;</span>
<a href="#l18.54"></a><span id="l18.54" class="difflineplus">+}</span>
<a href="#l18.55"></a><span id="l18.55" class="difflineplus">+</span>
<a href="#l18.56"></a><span id="l18.56" class="difflineplus">+.hostLabel {</span>
<a href="#l18.57"></a><span id="l18.57" class="difflineplus">+  font-weight: bold;</span>
<a href="#l18.58"></a><span id="l18.58" class="difflineplus">+  font-style: italic;</span>
<a href="#l18.59"></a><span id="l18.59" class="difflineplus">+  -moz-margin-end: 1em;</span>
<a href="#l18.60"></a><span id="l18.60" class="difflineplus">+}</span>
<a href="#l18.61"></a><span id="l18.61" class="difflineplus">+</span>
<a href="#l18.62"></a><span id="l18.62" class="difflineplus">+.permissionLabel {</span>
<a href="#l18.63"></a><span id="l18.63" class="difflineplus">+  font-weight: bold;</span>
<a href="#l18.64"></a><span id="l18.64" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/suite/themes/classic/jar.mn</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/suite/themes/classic/jar.mn</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -82,16 +82,17 @@ classic.jar:</span>
<a href="#l19.4"></a><span id="l19.4">   skin/classic/communicator/bookmarks/bookmark-item-dis.png             (communicator/bookmarks/bookmark-item-dis.png)</span>
<a href="#l19.5"></a><span id="l19.5">   skin/classic/communicator/bookmarks/bookmark-item.png                 (communicator/bookmarks/bookmark-item.png)</span>
<a href="#l19.6"></a><span id="l19.6">   skin/classic/communicator/bookmarks/toolbarDropMarker.png             (communicator/bookmarks/toolbarDropMarker.png)</span>
<a href="#l19.7"></a><span id="l19.7">   skin/classic/communicator/bookmarks/unsortedBookmarks.png             (communicator/bookmarks/unsortedBookmarks.png)</span>
<a href="#l19.8"></a><span id="l19.8">   skin/classic/communicator/brand/throbber-anim.png                     (communicator/brand/throbber-anim.png)</span>
<a href="#l19.9"></a><span id="l19.9">   skin/classic/communicator/brand/throbber-single.png                   (communicator/brand/throbber-single.png)</span>
<a href="#l19.10"></a><span id="l19.10">   skin/classic/communicator/brand/throbber16-anim.png                   (communicator/brand/throbber16-anim.png)</span>
<a href="#l19.11"></a><span id="l19.11">   skin/classic/communicator/brand/throbber16-single.png                 (communicator/brand/throbber16-single.png)</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+  skin/classic/communicator/dataman/dataman.css                         (communicator/dataman/dataman.css)</span>
<a href="#l19.13"></a><span id="l19.13">   skin/classic/communicator/directory/directory.css                     (communicator/directory/directory.css)</span>
<a href="#l19.14"></a><span id="l19.14">   skin/classic/communicator/feed-subscribe.css                          (communicator/feed-subscribe.css)</span>
<a href="#l19.15"></a><span id="l19.15">   skin/classic/communicator/feed-subscribe-ui.css                       (communicator/feed-subscribe-ui.css)</span>
<a href="#l19.16"></a><span id="l19.16">   skin/classic/communicator/fullscreen-video.css                        (communicator/fullscreen-video.css)</span>
<a href="#l19.17"></a><span id="l19.17">   skin/classic/communicator/directory/folder-clsd.gif                   (communicator/directory/folder-clsd.gif)</span>
<a href="#l19.18"></a><span id="l19.18">   skin/classic/communicator/directory/folder-open.gif                   (communicator/directory/folder-open.gif)</span>
<a href="#l19.19"></a><span id="l19.19">   skin/classic/communicator/directory/file.gif                          (communicator/directory/file.gif)</span>
<a href="#l19.20"></a><span id="l19.20">   skin/classic/communicator/downloads/dl-remove.png                     (communicator/downloads/dl-remove.png)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1">new file mode 100644</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineminus">--- /dev/null</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineplus">+++ b/suite/themes/modern/communicator/dataman/dataman.css</span>
<a href="#l20.4"></a><span id="l20.4" class="difflineat">@@ -0,0 +1,60 @@</span>
<a href="#l20.5"></a><span id="l20.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l20.6"></a><span id="l20.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l20.7"></a><span id="l20.7" class="difflineplus">+ *</span>
<a href="#l20.8"></a><span id="l20.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l20.9"></a><span id="l20.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l20.10"></a><span id="l20.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l20.11"></a><span id="l20.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineplus">+ *</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineplus">+ * License.</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineplus">+ *</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineplus">+ * The Original Code is KaiRo's data manager.</span>
<a href="#l20.19"></a><span id="l20.19" class="difflineplus">+ *</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineplus">+ * Robert Kaiser &lt;kairo@kairo.at&gt;.</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l20.23"></a><span id="l20.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineplus">+ *</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l20.26"></a><span id="l20.26" class="difflineplus">+ *   Robert Kaiser &lt;kairo@kairo.at&gt; (original author)</span>
<a href="#l20.27"></a><span id="l20.27" class="difflineplus">+ *</span>
<a href="#l20.28"></a><span id="l20.28" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineplus">+ * either of the GNU General Public License Version 2 or later (the &quot;GPL&quot;),</span>
<a href="#l20.30"></a><span id="l20.30" class="difflineplus">+ * or the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l20.33"></a><span id="l20.33" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l20.34"></a><span id="l20.34" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l20.35"></a><span id="l20.35" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l20.36"></a><span id="l20.36" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l20.37"></a><span id="l20.37" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l20.38"></a><span id="l20.38" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l20.39"></a><span id="l20.39" class="difflineplus">+ *</span>
<a href="#l20.40"></a><span id="l20.40" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l20.41"></a><span id="l20.41" class="difflineplus">+</span>
<a href="#l20.42"></a><span id="l20.42" class="difflineplus">+#permList {</span>
<a href="#l20.43"></a><span id="l20.43" class="difflineplus">+  margin-top: .5em;</span>
<a href="#l20.44"></a><span id="l20.44" class="difflineplus">+  overflow: auto;</span>
<a href="#l20.45"></a><span id="l20.45" class="difflineplus">+}</span>
<a href="#l20.46"></a><span id="l20.46" class="difflineplus">+</span>
<a href="#l20.47"></a><span id="l20.47" class="difflineplus">+.permission {</span>
<a href="#l20.48"></a><span id="l20.48" class="difflineplus">+  padding-top: 6px;</span>
<a href="#l20.49"></a><span id="l20.49" class="difflineplus">+  padding-bottom: 6px;</span>
<a href="#l20.50"></a><span id="l20.50" class="difflineplus">+  -moz-padding-start: 7px;</span>
<a href="#l20.51"></a><span id="l20.51" class="difflineplus">+  -moz-padding-end: 7px;</span>
<a href="#l20.52"></a><span id="l20.52" class="difflineplus">+  min-height: 25px;</span>
<a href="#l20.53"></a><span id="l20.53" class="difflineplus">+  border-bottom: 1px dotted #C7D0D9;</span>
<a href="#l20.54"></a><span id="l20.54" class="difflineplus">+}</span>
<a href="#l20.55"></a><span id="l20.55" class="difflineplus">+</span>
<a href="#l20.56"></a><span id="l20.56" class="difflineplus">+.hostLabel {</span>
<a href="#l20.57"></a><span id="l20.57" class="difflineplus">+  font-weight: bold;</span>
<a href="#l20.58"></a><span id="l20.58" class="difflineplus">+  font-style: italic;</span>
<a href="#l20.59"></a><span id="l20.59" class="difflineplus">+  -moz-margin-end: 1em;</span>
<a href="#l20.60"></a><span id="l20.60" class="difflineplus">+}</span>
<a href="#l20.61"></a><span id="l20.61" class="difflineplus">+</span>
<a href="#l20.62"></a><span id="l20.62" class="difflineplus">+.permissionLabel {</span>
<a href="#l20.63"></a><span id="l20.63" class="difflineplus">+  font-weight: bold;</span>
<a href="#l20.64"></a><span id="l20.64" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/suite/themes/modern/jar.mn</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/suite/themes/modern/jar.mn</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -43,16 +43,17 @@ modern.jar:</span>
<a href="#l21.4"></a><span id="l21.4">   skin/modern/communicator/bookmarks/query.png                     (communicator/bookmarks/query.png)</span>
<a href="#l21.5"></a><span id="l21.5">   skin/modern/communicator/bookmarks/tagContainerIcon.png          (communicator/bookmarks/tagContainerIcon.png)</span>
<a href="#l21.6"></a><span id="l21.6">   skin/modern/communicator/bookmarks/toolbarDropMarker.png         (communicator/bookmarks/toolbarDropMarker.png)</span>
<a href="#l21.7"></a><span id="l21.7">   skin/modern/communicator/bookmarks/unsortedBookmarks.png         (communicator/bookmarks/unsortedBookmarks.png)</span>
<a href="#l21.8"></a><span id="l21.8">   skin/modern/communicator/brand/throbber-anim.png                 (communicator/brand/throbber-anim.png)</span>
<a href="#l21.9"></a><span id="l21.9">   skin/modern/communicator/brand/throbber-single.png               (communicator/brand/throbber-single.png)</span>
<a href="#l21.10"></a><span id="l21.10">   skin/modern/communicator/brand/throbber16-anim.png               (communicator/brand/throbber16-anim.png)</span>
<a href="#l21.11"></a><span id="l21.11">   skin/modern/communicator/brand/throbber16-single.png             (communicator/brand/throbber16-single.png)</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+  skin/modern/communicator/dataman/dataman.css                     (communicator/dataman/dataman.css)</span>
<a href="#l21.13"></a><span id="l21.13">   skin/modern/communicator/directory/file-folder-closed.gif        (communicator/directory/file-folder-closed.gif)</span>
<a href="#l21.14"></a><span id="l21.14">   skin/modern/communicator/directory/file-folder-open.gif          (communicator/directory/file-folder-open.gif)</span>
<a href="#l21.15"></a><span id="l21.15">   skin/modern/communicator/directory/file-icon.gif                 (communicator/directory/file-icon.gif)</span>
<a href="#l21.16"></a><span id="l21.16">   skin/modern/communicator/directory/directory.css                 (communicator/directory/directory.css)</span>
<a href="#l21.17"></a><span id="l21.17">   skin/modern/communicator/downloads/dl-remove.png                 (communicator/downloads/dl-remove.png)</span>
<a href="#l21.18"></a><span id="l21.18">   skin/modern/communicator/downloads/downloadButtons.png           (communicator/downloads/downloadButtons.png)</span>
<a href="#l21.19"></a><span id="l21.19">   skin/modern/communicator/downloads/downloadmanager.css           (communicator/downloads/downloadmanager.css)</span>
<a href="#l21.20"></a><span id="l21.20">   skin/modern/communicator/feed-subscribe.css                      (communicator/feed-subscribe.css)</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

