<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 27687:eb003d43c6555eaac3fcb50361d6473f7b7e2dbe</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ eb003d43c6555eaac3fcb50361d6473f7b7e2dbe" />
<meta property="og:url" content="/comm-central/rev/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe" />
<meta property="og:description" content="Bug 1582782 - Fix brace formatting in some .html files. r=clokep" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / eb003d43c6555eaac3fcb50361d6473f7b7e2dbe 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe">shortlog</a> |
<a href="/comm-central/log/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe">files</a> |
changeset |
<a href="/comm-central/raw-rev/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe">raw</a>  | <a href="/comm-central/archive/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1582782">Bug 1582782</a> - Fix brace formatting in some .html files. r=clokep
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#80;&#97;&#117;&#108;&#32;&#77;&#111;&#114;&#114;&#105;&#115;&#32;&#60;&#112;&#97;&#117;&#108;&#64;&#116;&#104;&#117;&#110;&#100;&#101;&#114;&#98;&#105;&#114;&#100;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 20 Sep 2019 12:05:31 -0400</td></tr>

<tr>
 <td>changeset 27687</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe">eb003d43c6555eaac3fcb50361d6473f7b7e2dbe</a></td>
</tr>



<tr>
<td>parent 27686</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/b72fde123f323bfbcbcc160584695c08741864f8">b72fde123f323bfbcbcc160584695c08741864f8</a>
</td>
</tr>

<tr>
<td>child 27688</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/7e7de17ddcc057f3aef571c2bb0a92eb874bd84d">7e7de17ddcc057f3aef571c2bb0a92eb874bd84d</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=eb003d43c6555eaac3fcb50361d6473f7b7e2dbe">16447</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Mon, 23 Sep 2019 22:12:17 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@8b63311aafa9 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=8b63311aafa97d5b7a822510c00134bd1f0fd3f4">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=8b63311aafa97d5b7a822510c00134bd1f0fd3f4&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=8b63311aafa97d5b7a822510c00134bd1f0fd3f4&newProject=comm-central&newRevision=b72fde123f323bfbcbcc160584695c08741864f8&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=8b63311aafa97d5b7a822510c00134bd1f0fd3f4&newProject=comm-central&newRevision=b72fde123f323bfbcbcc160584695c08741864f8&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=8b63311aafa97d5b7a822510c00134bd1f0fd3f4&newProject=comm-central&newRevision=b72fde123f323bfbcbcc160584695c08741864f8&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28clokep%29&revcount=50">clokep</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1582782">1582782</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1572047">1572047</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1582782">Bug 1582782</a> - Fix brace formatting in some .html files. r=clokep

As part of rolling out Prettier formatting in
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1572047">bug 1572047</a>, we inserted curly brackets using eslint
and then relied on Prettier to format them correctly.
However, we currently tell Prettier to ignore .html
files. So a few of those ended up with curly braces
that were not formatted well. This changeset fixes
those up manually.

(Per clokep it is not really feasible to move this
JavaScript code into .js files given the way chat
message styles work.)</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/bubbles/Footer.html">mail/components/im/messages/bubbles/Footer.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/bubbles/Footer.html">file</a> |
<a href="/comm-central/annotate/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/bubbles/Footer.html">annotate</a> |
<a href="/comm-central/diff/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/bubbles/Footer.html">diff</a> |
<a href="/comm-central/comparison/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/bubbles/Footer.html">comparison</a> |
<a href="/comm-central/log/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/bubbles/Footer.html">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/dark/Footer.html">mail/components/im/messages/dark/Footer.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/dark/Footer.html">file</a> |
<a href="/comm-central/annotate/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/dark/Footer.html">annotate</a> |
<a href="/comm-central/diff/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/dark/Footer.html">diff</a> |
<a href="/comm-central/comparison/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/dark/Footer.html">comparison</a> |
<a href="/comm-central/log/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/dark/Footer.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/mail/Footer.html">mail/components/im/messages/mail/Footer.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/mail/Footer.html">file</a> |
<a href="/comm-central/annotate/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/mail/Footer.html">annotate</a> |
<a href="/comm-central/diff/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/mail/Footer.html">diff</a> |
<a href="/comm-central/comparison/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/mail/Footer.html">comparison</a> |
<a href="/comm-central/log/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/mail/Footer.html">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/papersheets/Footer.html">mail/components/im/messages/papersheets/Footer.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/papersheets/Footer.html">file</a> |
<a href="/comm-central/annotate/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/papersheets/Footer.html">annotate</a> |
<a href="/comm-central/diff/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/papersheets/Footer.html">diff</a> |
<a href="/comm-central/comparison/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/papersheets/Footer.html">comparison</a> |
<a href="/comm-central/log/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/components/im/messages/papersheets/Footer.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/test/mozmill/utils/html/collections.html">mail/test/mozmill/utils/html/collections.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/test/mozmill/utils/html/collections.html">file</a> |
<a href="/comm-central/annotate/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/test/mozmill/utils/html/collections.html">annotate</a> |
<a href="/comm-central/diff/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/test/mozmill/utils/html/collections.html">diff</a> |
<a href="/comm-central/comparison/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/test/mozmill/utils/html/collections.html">comparison</a> |
<a href="/comm-central/log/eb003d43c6555eaac3fcb50361d6473f7b7e2dbe/mail/test/mozmill/utils/html/collections.html">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/components/im/messages/bubbles/Footer.html</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/components/im/messages/bubbles/Footer.html</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -14,24 +14,26 @@ const bubble_borders = &quot;hsl(#, 100%, #%)</span>
<a href="#l1.4"></a><span id="l1.4"> const pseudo_color = &quot;hsl(#, 100%, #%)&quot;;</span>
<a href="#l1.5"></a><span id="l1.5"> const pseudo_background = &quot;hsl(#, 100%, #%)&quot;;</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7"> var alternating = null;</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9"> function setColors(target) {</span>
<a href="#l1.10"></a><span id="l1.10">   var senderColor = target.getAttribute(&quot;data-senderColor&quot;);</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-  if (!senderColor)</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-    {return;}</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+  if (!senderColor) {</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+    return;</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineplus">+  }</span>
<a href="#l1.17"></a><span id="l1.17"> </span>
<a href="#l1.18"></a><span id="l1.18">   var regexp = /color:\s*hsl\(\s*(\d{1,3})\s*,\s*\d{1,3}\%\s*,\s*\d{1,3}\%\s*\)/;</span>
<a href="#l1.19"></a><span id="l1.19">   var parsed = regexp.exec(senderColor);</span>
<a href="#l1.20"></a><span id="l1.20"> </span>
<a href="#l1.21"></a><span id="l1.21" class="difflineminus">-  if (!parsed)</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineminus">-    {return;}</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineplus">+  if (!parsed) {</span>
<a href="#l1.24"></a><span id="l1.24" class="difflineplus">+    return;</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineplus">+  }</span>
<a href="#l1.26"></a><span id="l1.26"> </span>
<a href="#l1.27"></a><span id="l1.27">   var senderHue = ((Math.round(parsed[1] / 10)) * 10) % 360;</span>
<a href="#l1.28"></a><span id="l1.28">   var lightness = elements_lightness[senderHue / 10];</span>
<a href="#l1.29"></a><span id="l1.29"> </span>
<a href="#l1.30"></a><span id="l1.30">   target.style.backgroundColor = bubble_background.replace(&quot;#&quot;, senderHue);</span>
<a href="#l1.31"></a><span id="l1.31">   target.style.borderColor = bubble_borders.replace(&quot;#&quot;, senderHue)</span>
<a href="#l1.32"></a><span id="l1.32">                                            .replace(&quot;#&quot;, lightness[2]);</span>
<a href="#l1.33"></a><span id="l1.33"> </span>
<a href="#l1.34"></a><span id="l1.34" class="difflineat">@@ -52,25 +54,28 @@ function setColors(target) {</span>
<a href="#l1.35"></a><span id="l1.35">     }</span>
<a href="#l1.36"></a><span id="l1.36">     imageURL += alternating;</span>
<a href="#l1.37"></a><span id="l1.37">   }</span>
<a href="#l1.38"></a><span id="l1.38">   div_indicator.style.backgroundImage = imageURL + &quot;.png')&quot;;</span>
<a href="#l1.39"></a><span id="l1.39"> }</span>
<a href="#l1.40"></a><span id="l1.40"> </span>
<a href="#l1.41"></a><span id="l1.41"> </span>
<a href="#l1.42"></a><span id="l1.42"> function prettyPrintTime(aValue, aNoSeconds) {</span>
<a href="#l1.43"></a><span id="l1.43" class="difflineminus">-  if (aValue &lt; 60 &amp;&amp; aNoSeconds)</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineminus">-    {return &quot;&quot;;}</span>
<a href="#l1.45"></a><span id="l1.45" class="difflineplus">+  if (aValue &lt; 60 &amp;&amp; aNoSeconds) {</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineplus">+    return &quot;&quot;;</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineplus">+  }</span>
<a href="#l1.48"></a><span id="l1.48"> </span>
<a href="#l1.49"></a><span id="l1.49" class="difflineminus">-  if (aNoSeconds)</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineminus">-    {aValue -= aValue % 60;}</span>
<a href="#l1.51"></a><span id="l1.51" class="difflineplus">+  if (aNoSeconds) {</span>
<a href="#l1.52"></a><span id="l1.52" class="difflineplus">+    aValue -= aValue % 60;</span>
<a href="#l1.53"></a><span id="l1.53" class="difflineplus">+  }</span>
<a href="#l1.54"></a><span id="l1.54"> </span>
<a href="#l1.55"></a><span id="l1.55">   let valuesAndUnits = window.convertTimeUnits(aValue);</span>
<a href="#l1.56"></a><span id="l1.56" class="difflineminus">-  if (!valuesAndUnits[2])</span>
<a href="#l1.57"></a><span id="l1.57" class="difflineminus">-    {valuesAndUnits.splice(2, 2);}</span>
<a href="#l1.58"></a><span id="l1.58" class="difflineplus">+  if (!valuesAndUnits[2]) {</span>
<a href="#l1.59"></a><span id="l1.59" class="difflineplus">+    valuesAndUnits.splice(2, 2);</span>
<a href="#l1.60"></a><span id="l1.60" class="difflineplus">+  }</span>
<a href="#l1.61"></a><span id="l1.61">   return valuesAndUnits.join(&quot; &quot;);</span>
<a href="#l1.62"></a><span id="l1.62"> }</span>
<a href="#l1.63"></a><span id="l1.63"> </span>
<a href="#l1.64"></a><span id="l1.64"> // The &quot;shadow&quot; constant is the minimum acceptable margin-bottom for a bubble</span>
<a href="#l1.65"></a><span id="l1.65"> // with a shadow, and the minimum spacing between the bubbles of two messages</span>
<a href="#l1.66"></a><span id="l1.66"> // arriving in the same second. It should match the value of margin-bottom and</span>
<a href="#l1.67"></a><span id="l1.67"> // box-shadow-bottom for the &quot;bubble&quot; class.</span>
<a href="#l1.68"></a><span id="l1.68"> const shadow = 3;</span>
<a href="#l1.69"></a><span id="l1.69" class="difflineat">@@ -95,62 +100,67 @@ var lastMessageTimeoutTime = -1;</span>
<a href="#l1.70"></a><span id="l1.70">  * the time in text. To avoid blinking Mac scrollbar and visual distractions</span>
<a href="#l1.71"></a><span id="l1.71">  * for some very sensitive users, we update the whitespace only when a new</span>
<a href="#l1.72"></a><span id="l1.72">  * message is displayed or when the user switches between tabs. While the</span>
<a href="#l1.73"></a><span id="l1.73">  * conversation is visible, this function is called by timers, but we will</span>
<a href="#l1.74"></a><span id="l1.74">  * only update the time displayed in text (this behavior is obtained by</span>
<a href="#l1.75"></a><span id="l1.75">  * setting the aUpdateTextOnly parameter to true; otherwise it is omitted).</span>
<a href="#l1.76"></a><span id="l1.76">  */</span>
<a href="#l1.77"></a><span id="l1.77"> function handleLastMessage(aUpdateTextOnly) {</span>
<a href="#l1.78"></a><span id="l1.78" class="difflineminus">-  if (window.messageInsertPending)</span>
<a href="#l1.79"></a><span id="l1.79" class="difflineminus">-    {return;}</span>
<a href="#l1.80"></a><span id="l1.80" class="difflineplus">+  if (window.messageInsertPending) {</span>
<a href="#l1.81"></a><span id="l1.81" class="difflineplus">+    return;</span>
<a href="#l1.82"></a><span id="l1.82" class="difflineplus">+  }</span>
<a href="#l1.83"></a><span id="l1.83"> </span>
<a href="#l1.84"></a><span id="l1.84">   var intervalInMs = Date.now() - lastMsgTime * 1000;</span>
<a href="#l1.85"></a><span id="l1.85">   var interval = Math.round(intervalInMs / 1000);</span>
<a href="#l1.86"></a><span id="l1.86">   var p = document.getElementById(&quot;lastMessage&quot;);</span>
<a href="#l1.87"></a><span id="l1.87">   var margin;</span>
<a href="#l1.88"></a><span id="l1.88">   if (!aUpdateTextOnly) {</span>
<a href="#l1.89"></a><span id="l1.89">     // Impose a minimum to ensure the last bubble doesn't touch the editbox.</span>
<a href="#l1.90"></a><span id="l1.90">     margin = computeSpace(Math.max(intervalInMs, 5000) / 1000);</span>
<a href="#l1.91"></a><span id="l1.91">   }</span>
<a href="#l1.92"></a><span id="l1.92">   var text = &quot;&quot;;</span>
<a href="#l1.93"></a><span id="l1.93">   if (interval &gt;= timebeforetextdisplay) {</span>
<a href="#l1.94"></a><span id="l1.94" class="difflineminus">-    if (!aUpdateTextOnly)</span>
<a href="#l1.95"></a><span id="l1.95" class="difflineminus">-      {p.style.lineHeight = (margin + shadow) + &quot;px&quot;;}</span>
<a href="#l1.96"></a><span id="l1.96" class="difflineplus">+    if (!aUpdateTextOnly) {</span>
<a href="#l1.97"></a><span id="l1.97" class="difflineplus">+      p.style.lineHeight = (margin + shadow) + &quot;px&quot;;</span>
<a href="#l1.98"></a><span id="l1.98" class="difflineplus">+    }</span>
<a href="#l1.99"></a><span id="l1.99">     p.setAttribute(&quot;class&quot;, &quot;interval&quot;);</span>
<a href="#l1.100"></a><span id="l1.100">     text = prettyPrintTime(interval, true);</span>
<a href="#l1.101"></a><span id="l1.101">     margin = 0;</span>
<a href="#l1.102"></a><span id="l1.102">   }</span>
<a href="#l1.103"></a><span id="l1.103">   p.textContent = text;</span>
<a href="#l1.104"></a><span id="l1.104">   if (!aUpdateTextOnly) {</span>
<a href="#l1.105"></a><span id="l1.105">     p.style.marginTop = (margin - shadow) + &quot;px&quot;;</span>
<a href="#l1.106"></a><span id="l1.106" class="difflineminus">-    if (convScrollEnabled())</span>
<a href="#l1.107"></a><span id="l1.107" class="difflineminus">-      {scrollToElement(p);}</span>
<a href="#l1.108"></a><span id="l1.108" class="difflineplus">+    if (convScrollEnabled()) {</span>
<a href="#l1.109"></a><span id="l1.109" class="difflineplus">+      scrollToElement(p);</span>
<a href="#l1.110"></a><span id="l1.110" class="difflineplus">+    }</span>
<a href="#l1.111"></a><span id="l1.111">   }</span>
<a href="#l1.112"></a><span id="l1.112"> </span>
<a href="#l1.113"></a><span id="l1.113">   var next = timebeforetextdisplay * 1000 - intervalInMs;</span>
<a href="#l1.114"></a><span id="l1.114">   if (next &lt;= 0) {</span>
<a href="#l1.115"></a><span id="l1.115" class="difflineminus">-    if (intervalInMs &gt; kMsPerDay)</span>
<a href="#l1.116"></a><span id="l1.116" class="difflineminus">-      {next = kMsPerHour - intervalInMs % kMsPerHour;}</span>
<a href="#l1.117"></a><span id="l1.117" class="difflineminus">-    else</span>
<a href="#l1.118"></a><span id="l1.118" class="difflineminus">-      {next = kMsPerMinute - intervalInMs % kMsPerMinute;}</span>
<a href="#l1.119"></a><span id="l1.119" class="difflineplus">+    if (intervalInMs &gt; kMsPerDay) {</span>
<a href="#l1.120"></a><span id="l1.120" class="difflineplus">+      next = kMsPerHour - intervalInMs % kMsPerHour;</span>
<a href="#l1.121"></a><span id="l1.121" class="difflineplus">+    } else {</span>
<a href="#l1.122"></a><span id="l1.122" class="difflineplus">+      next = kMsPerMinute - intervalInMs % kMsPerMinute;</span>
<a href="#l1.123"></a><span id="l1.123" class="difflineplus">+    }</span>
<a href="#l1.124"></a><span id="l1.124">     aUpdateTextOnly = true;</span>
<a href="#l1.125"></a><span id="l1.125">   }</span>
<a href="#l1.126"></a><span id="l1.126"> </span>
<a href="#l1.127"></a><span id="l1.127">   // The setTimeout callbacks are frequently called a few ms early,</span>
<a href="#l1.128"></a><span id="l1.128">   // but our code prefers being called a little late, so add 20ms.</span>
<a href="#l1.129"></a><span id="l1.129">   lastMessageTimeoutTime = next + 20;</span>
<a href="#l1.130"></a><span id="l1.130">   lastMessageTimeout =</span>
<a href="#l1.131"></a><span id="l1.131">     setTimeout(handleLastMessage, lastMessageTimeoutTime, aUpdateTextOnly);</span>
<a href="#l1.132"></a><span id="l1.132"> }</span>
<a href="#l1.133"></a><span id="l1.133"> </span>
<a href="#l1.134"></a><span id="l1.134"> var lastMsgTime = 0;</span>
<a href="#l1.135"></a><span id="l1.135"> function updateLastMsgTime(aMsgTime) {</span>
<a href="#l1.136"></a><span id="l1.136" class="difflineminus">-  if (aMsgTime &gt; lastMsgTime)</span>
<a href="#l1.137"></a><span id="l1.137" class="difflineminus">-    {lastMsgTime = aMsgTime;}</span>
<a href="#l1.138"></a><span id="l1.138" class="difflineplus">+  if (aMsgTime &gt; lastMsgTime) {</span>
<a href="#l1.139"></a><span id="l1.139" class="difflineplus">+    lastMsgTime = aMsgTime;</span>
<a href="#l1.140"></a><span id="l1.140" class="difflineplus">+  }</span>
<a href="#l1.141"></a><span id="l1.141"> </span>
<a href="#l1.142"></a><span id="l1.142">   if (lastMsgTime &amp;&amp; lastMessageTimeoutTime != 0 &amp;&amp; !document.hidden) {</span>
<a href="#l1.143"></a><span id="l1.143">     clearTimeout(lastMessageTimeout);</span>
<a href="#l1.144"></a><span id="l1.144">     setTimeout(handleLastMessage, 0);</span>
<a href="#l1.145"></a><span id="l1.145">     lastMessageTimeoutTime = 0;</span>
<a href="#l1.146"></a><span id="l1.146">   }</span>
<a href="#l1.147"></a><span id="l1.147"> }</span>
<a href="#l1.148"></a><span id="l1.148"> </span>
<a href="#l1.149"></a><span id="l1.149" class="difflineat">@@ -162,29 +172,31 @@ function visibilityChanged() {</span>
<a href="#l1.150"></a><span id="l1.150">     handleLastMessage();</span>
<a href="#l1.151"></a><span id="l1.151">   }</span>
<a href="#l1.152"></a><span id="l1.152"> }</span>
<a href="#l1.153"></a><span id="l1.153"> </span>
<a href="#l1.154"></a><span id="l1.154"> function checkNewText(target) {</span>
<a href="#l1.155"></a><span id="l1.155">   var nicks = target.getElementsByClassName(&quot;ib-nick&quot;);</span>
<a href="#l1.156"></a><span id="l1.156">   for (var i = 0; i &lt; nicks.length; ++i) {</span>
<a href="#l1.157"></a><span id="l1.157">     var nick = nicks[i];</span>
<a href="#l1.158"></a><span id="l1.158" class="difflineminus">-    if (nick.hasAttribute(&quot;data-left&quot;))</span>
<a href="#l1.159"></a><span id="l1.159" class="difflineminus">-      {continue;}</span>
<a href="#l1.160"></a><span id="l1.160" class="difflineplus">+    if (nick.hasAttribute(&quot;data-left&quot;)) {</span>
<a href="#l1.161"></a><span id="l1.161" class="difflineplus">+      continue;</span>
<a href="#l1.162"></a><span id="l1.162" class="difflineplus">+    }</span>
<a href="#l1.163"></a><span id="l1.163">     var hue = nick.getAttribute(&quot;data-nickColor&quot;);</span>
<a href="#l1.164"></a><span id="l1.164">     var senderHue = ((Math.round(hue / 10)) * 10) % 360;</span>
<a href="#l1.165"></a><span id="l1.165">     var lightness = elements_lightness[senderHue / 10];</span>
<a href="#l1.166"></a><span id="l1.166">     nick.style.backgroundColor = pseudo_background.replace(&quot;#&quot;, senderHue).replace(&quot;#&quot;, lightness[1]);</span>
<a href="#l1.167"></a><span id="l1.167">     nick.style.color = pseudo_color.replace(&quot;#&quot;, senderHue).replace(&quot;#&quot;, lightness[0]);</span>
<a href="#l1.168"></a><span id="l1.168">     nick.style.borderColor = bubble_borders.replace(&quot;#&quot;, senderHue).replace(&quot;#&quot;, lightness[2]);</span>
<a href="#l1.169"></a><span id="l1.169">   }</span>
<a href="#l1.170"></a><span id="l1.170"> </span>
<a href="#l1.171"></a><span id="l1.171">   var msgTime = null;</span>
<a href="#l1.172"></a><span id="l1.172" class="difflineminus">-  if (target._originalMsg)</span>
<a href="#l1.173"></a><span id="l1.173" class="difflineminus">-    {msgTime = target._originalMsg.time;}</span>
<a href="#l1.174"></a><span id="l1.174" class="difflineplus">+  if (target._originalMsg) {</span>
<a href="#l1.175"></a><span id="l1.175" class="difflineplus">+    msgTime = target._originalMsg.time;</span>
<a href="#l1.176"></a><span id="l1.176" class="difflineplus">+  }</span>
<a href="#l1.177"></a><span id="l1.177">   if (target.tagName == &quot;DIV&quot; &amp;&amp; target.classList.contains(&quot;bubble&quot;)) {</span>
<a href="#l1.178"></a><span id="l1.178">     setColors(target);</span>
<a href="#l1.179"></a><span id="l1.179"> </span>
<a href="#l1.180"></a><span id="l1.180">     var prev = target.previousSibling;</span>
<a href="#l1.181"></a><span id="l1.181">     var shouldSetUnreadRuler = prev &amp;&amp; prev.id &amp;&amp; prev.id == &quot;unread-ruler&quot;;</span>
<a href="#l1.182"></a><span id="l1.182">     var shouldSetSessionRuler = prev &amp;&amp; prev.className &amp;&amp; prev.className == &quot;sessionstart-ruler&quot;;</span>
<a href="#l1.183"></a><span id="l1.183">     // We need an extra pixel of margin at the top to make the margins appear</span>
<a href="#l1.184"></a><span id="l1.184">     // to be of equal size, since the preceding bubble will have a shadow.</span>
<a href="#l1.185"></a><span id="l1.185" class="difflineat">@@ -239,24 +251,28 @@ function checkNewText(target) {</span>
<a href="#l1.186"></a><span id="l1.186">       p.addEventListener(&quot;click&quot;, event =&gt;</span>
<a href="#l1.187"></a><span id="l1.187">         event.target.parentNode.classList.toggle(&quot;hide-children&quot;));</span>
<a href="#l1.188"></a><span id="l1.188">       parent.insertBefore(p, parent.querySelector(&quot;p.event:nth-of-type(2)&quot;));</span>
<a href="#l1.189"></a><span id="l1.189">       parent.classList.add(&quot;hide-children&quot;);</span>
<a href="#l1.190"></a><span id="l1.190">       parent.grouped = true;</span>
<a href="#l1.191"></a><span id="l1.191">     }</span>
<a href="#l1.192"></a><span id="l1.192">   }</span>
<a href="#l1.193"></a><span id="l1.193"> </span>
<a href="#l1.194"></a><span id="l1.194" class="difflineminus">-  if (msgTime)</span>
<a href="#l1.195"></a><span id="l1.195" class="difflineminus">-    {updateLastMsgTime(msgTime);}</span>
<a href="#l1.196"></a><span id="l1.196" class="difflineplus">+  if (msgTime) {</span>
<a href="#l1.197"></a><span id="l1.197" class="difflineplus">+    updateLastMsgTime(msgTime);</span>
<a href="#l1.198"></a><span id="l1.198" class="difflineplus">+  }</span>
<a href="#l1.199"></a><span id="l1.199"> }</span>
<a href="#l1.200"></a><span id="l1.200"> </span>
<a href="#l1.201"></a><span id="l1.201"> new MutationObserver(function(aMutations) {</span>
<a href="#l1.202"></a><span id="l1.202" class="difflineminus">-  for (let mutation of aMutations)</span>
<a href="#l1.203"></a><span id="l1.203" class="difflineminus">-    {for (let node of mutation.addedNodes)</span>
<a href="#l1.204"></a><span id="l1.204" class="difflineminus">-      {if (node instanceof HTMLElement)</span>
<a href="#l1.205"></a><span id="l1.205" class="difflineminus">-        {checkNewText(node);}}}</span>
<a href="#l1.206"></a><span id="l1.206" class="difflineplus">+  for (let mutation of aMutations) {</span>
<a href="#l1.207"></a><span id="l1.207" class="difflineplus">+    for (let node of mutation.addedNodes) {</span>
<a href="#l1.208"></a><span id="l1.208" class="difflineplus">+      if (node instanceof HTMLElement) {</span>
<a href="#l1.209"></a><span id="l1.209" class="difflineplus">+        checkNewText(node);</span>
<a href="#l1.210"></a><span id="l1.210" class="difflineplus">+      }</span>
<a href="#l1.211"></a><span id="l1.211" class="difflineplus">+    }</span>
<a href="#l1.212"></a><span id="l1.212" class="difflineplus">+  }</span>
<a href="#l1.213"></a><span id="l1.213"> }).observe(document.getElementById(&quot;ibcontent&quot;),</span>
<a href="#l1.214"></a><span id="l1.214">            {childList: true, subtree: true});</span>
<a href="#l1.215"></a><span id="l1.215"> </span>
<a href="#l1.216"></a><span id="l1.216"> document.addEventListener(&quot;visibilitychange&quot;, visibilityChanged);</span>
<a href="#l1.217"></a><span id="l1.217"> &lt;/script&gt;</span>
<a href="#l1.218"></a><span id="l1.218"> </span>
<a href="#l1.219"></a><span id="l1.219"> &lt;p id=&quot;lastMessage&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/components/im/messages/dark/Footer.html</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/components/im/messages/dark/Footer.html</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -5,43 +5,50 @@</span>
<a href="#l2.4"></a><span id="l2.4"> &lt;script&gt;</span>
<a href="#l2.5"></a><span id="l2.5"> const p_border_top = &quot;1px solid hsla(#, 100%, 80%, 0.4)&quot;;</span>
<a href="#l2.6"></a><span id="l2.6"> const p_background = &quot;-moz-linear-gradient(top, hsla(#, 100%, 80%, 0.3), hsla(#, 100%, 80%, 0.1) 30px)&quot;;</span>
<a href="#l2.7"></a><span id="l2.7"> const nick_background = &quot;-moz-linear-gradient(top, hsla(#, 100%, 80%, 0.3), hsla(#, 100%, 80%, 0.1) 1em)&quot;;</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9"> function setColors(target) {</span>
<a href="#l2.10"></a><span id="l2.10">   var senderColor = target.getAttribute(&quot;data-senderColor&quot;);</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-  if (!senderColor)</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-    {return;}</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+  if (!senderColor) {</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+    return;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+  }</span>
<a href="#l2.17"></a><span id="l2.17"> </span>
<a href="#l2.18"></a><span id="l2.18">   var regexp = /color:\s*hsl\(\s*(\d{1,3})\s*,\s*\d{1,3}\%\s*,\s*\d{1,3}\%\s*\)/;</span>
<a href="#l2.19"></a><span id="l2.19">   var parsed = regexp.exec(senderColor);</span>
<a href="#l2.20"></a><span id="l2.20"> </span>
<a href="#l2.21"></a><span id="l2.21" class="difflineminus">-  if (!parsed)</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineminus">-    {return;}</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+  if (!parsed) {</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineplus">+    return;</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineplus">+  }</span>
<a href="#l2.26"></a><span id="l2.26"> </span>
<a href="#l2.27"></a><span id="l2.27">   var senderHue = parsed[1];</span>
<a href="#l2.28"></a><span id="l2.28"> </span>
<a href="#l2.29"></a><span id="l2.29">   target.style.borderTop = p_border_top.replace(&quot;#&quot;, senderHue);</span>
<a href="#l2.30"></a><span id="l2.30">   target.style.background = p_background.replace(/#/g, senderHue);</span>
<a href="#l2.31"></a><span id="l2.31"> }</span>
<a href="#l2.32"></a><span id="l2.32"> </span>
<a href="#l2.33"></a><span id="l2.33"> function checkNewText(target) {</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineminus">-  if (target.tagName == &quot;P&quot; &amp;&amp; target.className != &quot;event-messages&quot;)</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineminus">-    {setColors(target);}</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineplus">+  if (target.tagName == &quot;P&quot; &amp;&amp; target.className != &quot;event-messages&quot;) {</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineplus">+    setColors(target);</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineplus">+  }</span>
<a href="#l2.39"></a><span id="l2.39"> </span>
<a href="#l2.40"></a><span id="l2.40">   var nicks = target.getElementsByClassName(&quot;ib-nick&quot;);</span>
<a href="#l2.41"></a><span id="l2.41">   for (var i = 0; i &lt; nicks.length; ++i) {</span>
<a href="#l2.42"></a><span id="l2.42">     var nick = nicks[i];</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineminus">-    if (!nick.hasAttribute(&quot;data-left&quot;))</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineminus">-      {nick.style.background = nick_background.replace(/#/g, nick.getAttribute(&quot;data-nickColor&quot;));}</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineplus">+    if (!nick.hasAttribute(&quot;data-left&quot;)) {</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineplus">+      nick.style.background = nick_background.replace(/#/g, nick.getAttribute(&quot;data-nickColor&quot;));</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineplus">+    }</span>
<a href="#l2.48"></a><span id="l2.48">   }</span>
<a href="#l2.49"></a><span id="l2.49"> }</span>
<a href="#l2.50"></a><span id="l2.50"> </span>
<a href="#l2.51"></a><span id="l2.51"> new MutationObserver(function(aMutations) {</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineminus">-  for (let mutation of aMutations)</span>
<a href="#l2.53"></a><span id="l2.53" class="difflineminus">-    {for (let node of mutation.addedNodes)</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineminus">-      {if (node instanceof HTMLElement)</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineminus">-        {checkNewText(node);}}}</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineplus">+  for (let mutation of aMutations) {</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineplus">+    for (let node of mutation.addedNodes) {</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineplus">+      if (node instanceof HTMLElement) {</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineplus">+        checkNewText(node);</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineplus">+      }</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineplus">+    }</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineplus">+  }</span>
<a href="#l2.63"></a><span id="l2.63"> }).observe(document.getElementById(&quot;ibcontent&quot;),</span>
<a href="#l2.64"></a><span id="l2.64">            {childList: true, subtree: true});</span>
<a href="#l2.65"></a><span id="l2.65"> &lt;/script&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/components/im/messages/mail/Footer.html</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/components/im/messages/mail/Footer.html</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -17,16 +17,19 @@ function checkNewText(target) {</span>
<a href="#l3.4"></a><span id="l3.4">       parent.insertBefore(p, parent.querySelector(&quot;p.event:nth-of-type(2)&quot;));</span>
<a href="#l3.5"></a><span id="l3.5">       parent.classList.add(&quot;hide-children&quot;);</span>
<a href="#l3.6"></a><span id="l3.6">       parent.grouped = true;</span>
<a href="#l3.7"></a><span id="l3.7">     }</span>
<a href="#l3.8"></a><span id="l3.8">   }</span>
<a href="#l3.9"></a><span id="l3.9"> }</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11"> new MutationObserver(function(aMutations) {</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  for (let mutation of aMutations)</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-    {for (let node of mutation.addedNodes)</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-      {if (node instanceof HTMLElement)</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-        {checkNewText(node);}}}</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+  for (let mutation of aMutations) {</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+    for (let node of mutation.addedNodes) {</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+      if (node instanceof HTMLElement) {</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+        checkNewText(node);</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+      }</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+    }</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineplus">+  }</span>
<a href="#l3.23"></a><span id="l3.23"> }).observe(document.getElementById(&quot;ibcontent&quot;),</span>
<a href="#l3.24"></a><span id="l3.24">            {childList: true, subtree: true});</span>
<a href="#l3.25"></a><span id="l3.25"> </span>
<a href="#l3.26"></a><span id="l3.26"> &lt;/script&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/components/im/messages/papersheets/Footer.html</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/components/im/messages/papersheets/Footer.html</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -15,20 +15,21 @@ function setColors(target) {</span>
<a href="#l4.4"></a><span id="l4.4">   var senderColor = target.getAttribute(&quot;data-senderColor&quot;);</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6">   if (senderColor) {</span>
<a href="#l4.7"></a><span id="l4.7">     var regexp = /color:\s*hsl\(\s*(\d{1,3})\s*,\s*\d{1,3}\%\s*,\s*\d{1,3}\%\s*\)/;</span>
<a href="#l4.8"></a><span id="l4.8">     var parsed = regexp.exec(senderColor);</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10">     if (parsed) {</span>
<a href="#l4.11"></a><span id="l4.11">       var senderHue = parsed[1];</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-      if (target.classList.contains(&quot;context&quot;))</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-        {target.setAttribute(&quot;style&quot;, bg_context_gradient.replace(/#/g, senderHue));}</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-      else</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-        {target.setAttribute(&quot;style&quot;, bg_gradient.replace(/#/g, senderHue));}</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+      if (target.classList.contains(&quot;context&quot;)) {</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+        target.setAttribute(&quot;style&quot;, bg_context_gradient.replace(/#/g, senderHue));</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+      } else {</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+        target.setAttribute(&quot;style&quot;, bg_gradient.replace(/#/g, senderHue));</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+      }</span>
<a href="#l4.21"></a><span id="l4.21">     }</span>
<a href="#l4.22"></a><span id="l4.22">   }</span>
<a href="#l4.23"></a><span id="l4.23"> </span>
<a href="#l4.24"></a><span id="l4.24">   if (body.scrollHeight &lt;= screen.height) {</span>
<a href="#l4.25"></a><span id="l4.25">     if (senderHue) {</span>
<a href="#l4.26"></a><span id="l4.26">       body.setAttribute(&quot;style&quot;, bg_color.replace(&quot;#&quot;, senderHue));</span>
<a href="#l4.27"></a><span id="l4.27">     } else if (target.classList.contains(&quot;outgoing&quot;)) {</span>
<a href="#l4.28"></a><span id="l4.28">       body.className = &quot;outgoing-color&quot;;</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineat">@@ -60,15 +61,18 @@ function checkNewText(target) {</span>
<a href="#l4.30"></a><span id="l4.30">       parent.classList.add(&quot;hide-children&quot;);</span>
<a href="#l4.31"></a><span id="l4.31">       parent.grouped = true;</span>
<a href="#l4.32"></a><span id="l4.32">     }</span>
<a href="#l4.33"></a><span id="l4.33">   }</span>
<a href="#l4.34"></a><span id="l4.34"> }</span>
<a href="#l4.35"></a><span id="l4.35"> </span>
<a href="#l4.36"></a><span id="l4.36"> </span>
<a href="#l4.37"></a><span id="l4.37"> new MutationObserver(function(aMutations) {</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineminus">-  for (let mutation of aMutations)</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineminus">-    {for (let node of mutation.addedNodes)</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineminus">-      {if (node instanceof HTMLElement)</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineminus">-        {checkNewText(node);}}}</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+  for (let mutation of aMutations) {</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+    for (let node of mutation.addedNodes) {</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+      if (node instanceof HTMLElement) {</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+        checkNewText(node);</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineplus">+      }</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineplus">+    }</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+  }</span>
<a href="#l4.49"></a><span id="l4.49"> }).observe(document.getElementById(&quot;ibcontent&quot;),</span>
<a href="#l4.50"></a><span id="l4.50">            {childList: true, subtree: true});</span>
<a href="#l4.51"></a><span id="l4.51"> &lt;/script&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/test/mozmill/utils/html/collections.html</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/test/mozmill/utils/html/collections.html</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -6,18 +6,19 @@</span>
<a href="#l5.4"></a><span id="l5.4">       const ITERATOR_SYMBOL = JS_HAS_SYMBOLS ? Symbol.iterator : &quot;@@iterator&quot;;</span>
<a href="#l5.5"></a><span id="l5.5">       var gIterator = (function* () {</span>
<a href="#l5.6"></a><span id="l5.6">         yield 1; yield 2; yield 3; yield 4; yield 5;</span>
<a href="#l5.7"></a><span id="l5.7">       })();</span>
<a href="#l5.8"></a><span id="l5.8"> </span>
<a href="#l5.9"></a><span id="l5.9">       var gCustomIterator = {</span>
<a href="#l5.10"></a><span id="l5.10">         _array: [6, 7, 8, 9],</span>
<a href="#l5.11"></a><span id="l5.11">         [ITERATOR_SYMBOL]: function* testIterator() {</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-          for (var i = 0; i &lt; this._array.length; ++i)</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-            {yield this._array[i];}</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+          for (var i = 0; i &lt; this._array.length; ++i) {</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+            yield this._array[i];</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+          }</span>
<a href="#l5.17"></a><span id="l5.17">         },</span>
<a href="#l5.18"></a><span id="l5.18">       };</span>
<a href="#l5.19"></a><span id="l5.19">     &lt;/script&gt;</span>
<a href="#l5.20"></a><span id="l5.20">   &lt;/head&gt;</span>
<a href="#l5.21"></a><span id="l5.21">   &lt;body&gt;</span>
<a href="#l5.22"></a><span id="l5.22">     I have two collections defined - gIterator is an iterator, and contains</span>
<a href="#l5.23"></a><span id="l5.23">     [1, 2, 3, 4, 5], and gCustomIterator is an object with an @@iterator</span>
<a href="#l5.24"></a><span id="l5.24">     method that contains [6, 7, 8, 9].</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:32Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

