<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 7463:ad530f75937aa15aa30d89b210b810f346113374</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ ad530f75937aa15aa30d89b210b810f346113374" />
<meta property="og:url" content="/comm-central/rev/ad530f75937aa15aa30d89b210b810f346113374" />
<meta property="og:description" content="Bug 634419 - Port |Bug 602682 - Sync UI: Implement easy setup|. r=Neil" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / ad530f75937aa15aa30d89b210b810f346113374 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/ad530f75937aa15aa30d89b210b810f346113374">shortlog</a> |
<a href="/comm-central/log/ad530f75937aa15aa30d89b210b810f346113374">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/ad530f75937aa15aa30d89b210b810f346113374">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/ad530f75937aa15aa30d89b210b810f346113374">files</a> |
changeset |
<a href="/comm-central/raw-rev/ad530f75937aa15aa30d89b210b810f346113374">raw</a>  | <a href="/comm-central/archive/ad530f75937aa15aa30d89b210b810f346113374.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=634419">Bug 634419</a> - Port |<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=602682">Bug 602682</a> - Sync UI: Implement easy setup|. r=Neil
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#101;&#110;&#115;&#32;&#72;&#97;&#116;&#108;&#97;&#107;&#32;&#60;&#106;&#104;&#64;&#106;&#117;&#110;&#101;&#116;&#122;&#46;&#100;&#101;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 29 Mar 2011 19:30:30 +0200</td></tr>

<tr>
 <td>changeset 7463</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/ad530f75937aa15aa30d89b210b810f346113374">ad530f75937aa15aa30d89b210b810f346113374</a></td>
</tr>



<tr>
<td>parent 7462</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/5f36003d805e5bab40b183c7ad4e325368bb91f4">5f36003d805e5bab40b183c7ad4e325368bb91f4</a>
</td>
</tr>

<tr>
<td>child 7464</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/7410fb8132babc39c19f3363aeb3d4646a200dc7">7410fb8132babc39c19f3363aeb3d4646a200dc7</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=ad530f75937aa15aa30d89b210b810f346113374">5723</a></td></tr>
<tr><td>push user</td><td>jh@junetz.de</td></tr>
<tr><td>push date</td><td class="date age">Tue, 29 Mar 2011 19:45:22 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@7dc09e40c5f8 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=7dc09e40c5f8e8aaed72981f5079443802be3bfe">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=7dc09e40c5f8e8aaed72981f5079443802be3bfe&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7dc09e40c5f8e8aaed72981f5079443802be3bfe&newProject=comm-central&newRevision=d06d41cd2ccffa9bc360aa7122e59f2e98637e59&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7dc09e40c5f8e8aaed72981f5079443802be3bfe&newProject=comm-central&newRevision=d06d41cd2ccffa9bc360aa7122e59f2e98637e59&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7dc09e40c5f8e8aaed72981f5079443802be3bfe&newProject=comm-central&newRevision=d06d41cd2ccffa9bc360aa7122e59f2e98637e59&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Neil%29&revcount=50">Neil</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=634419">634419</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=602682">602682</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=634419">Bug 634419</a> - Port |<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=602682">Bug 602682</a> - Sync UI: Implement easy setup|. r=Neil
Part 2: Existing Account Wizard</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.js">suite/common/sync/syncSetup.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.js">file</a> |
<a href="/comm-central/annotate/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.js">annotate</a> |
<a href="/comm-central/diff/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.js">diff</a> |
<a href="/comm-central/comparison/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.js">comparison</a> |
<a href="/comm-central/log/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.xul">suite/common/sync/syncSetup.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.xul">file</a> |
<a href="/comm-central/annotate/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.xul">annotate</a> |
<a href="/comm-central/diff/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.xul">diff</a> |
<a href="/comm-central/comparison/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.xul">comparison</a> |
<a href="/comm-central/log/ad530f75937aa15aa30d89b210b810f346113374/suite/common/sync/syncSetup.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ad530f75937aa15aa30d89b210b810f346113374/suite/locales/en-US/chrome/common/sync/syncSetup.dtd">suite/locales/en-US/chrome/common/sync/syncSetup.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ad530f75937aa15aa30d89b210b810f346113374/suite/locales/en-US/chrome/common/sync/syncSetup.dtd">file</a> |
<a href="/comm-central/annotate/ad530f75937aa15aa30d89b210b810f346113374/suite/locales/en-US/chrome/common/sync/syncSetup.dtd">annotate</a> |
<a href="/comm-central/diff/ad530f75937aa15aa30d89b210b810f346113374/suite/locales/en-US/chrome/common/sync/syncSetup.dtd">diff</a> |
<a href="/comm-central/comparison/ad530f75937aa15aa30d89b210b810f346113374/suite/locales/en-US/chrome/common/sync/syncSetup.dtd">comparison</a> |
<a href="/comm-central/log/ad530f75937aa15aa30d89b210b810f346113374/suite/locales/en-US/chrome/common/sync/syncSetup.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ad530f75937aa15aa30d89b210b810f346113374/suite/themes/classic/communicator/sync/syncSetup.css">suite/themes/classic/communicator/sync/syncSetup.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ad530f75937aa15aa30d89b210b810f346113374/suite/themes/classic/communicator/sync/syncSetup.css">file</a> |
<a href="/comm-central/annotate/ad530f75937aa15aa30d89b210b810f346113374/suite/themes/classic/communicator/sync/syncSetup.css">annotate</a> |
<a href="/comm-central/diff/ad530f75937aa15aa30d89b210b810f346113374/suite/themes/classic/communicator/sync/syncSetup.css">diff</a> |
<a href="/comm-central/comparison/ad530f75937aa15aa30d89b210b810f346113374/suite/themes/classic/communicator/sync/syncSetup.css">comparison</a> |
<a href="/comm-central/log/ad530f75937aa15aa30d89b210b810f346113374/suite/themes/classic/communicator/sync/syncSetup.css">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/suite/common/sync/syncSetup.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/suite/common/sync/syncSetup.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -44,18 +44,18 @@ const Cr = Components.results;</span>
<a href="#l1.4"></a><span id="l1.4"> const Cu = Components.utils;</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6"> // page consts</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8"> const INTRO_PAGE                    = 0;</span>
<a href="#l1.9"></a><span id="l1.9"> const NEW_ACCOUNT_START_PAGE        = 1;</span>
<a href="#l1.10"></a><span id="l1.10"> const NEW_ACCOUNT_PP_PAGE           = 2;</span>
<a href="#l1.11"></a><span id="l1.11"> const NEW_ACCOUNT_CAPTCHA_PAGE      = 3;</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-const EXISTING_ACCOUNT_LOGIN_PAGE   = 4;</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-const EXISTING_ACCOUNT_PP_PAGE      = 5;</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+const EXISTING_ACCOUNT_CONNECT_PAGE = 4;</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+const EXISTING_ACCOUNT_LOGIN_PAGE   = 5;</span>
<a href="#l1.16"></a><span id="l1.16"> const OPTIONS_PAGE                  = 6;</span>
<a href="#l1.17"></a><span id="l1.17"> const OPTIONS_CONFIRM_PAGE          = 7;</span>
<a href="#l1.18"></a><span id="l1.18"> const SETUP_SUCCESS_PAGE            = 8;</span>
<a href="#l1.19"></a><span id="l1.19"> </span>
<a href="#l1.20"></a><span id="l1.20"> Cu.import(&quot;resource://services-sync/main.js&quot;);</span>
<a href="#l1.21"></a><span id="l1.21"> Cu.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l1.22"></a><span id="l1.22"> Cu.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l1.23"></a><span id="l1.23"> Cu.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l1.24"></a><span id="l1.24" class="difflineat">@@ -73,19 +73,18 @@ var gSyncSetup = {</span>
<a href="#l1.25"></a><span id="l1.25">   status: {</span>
<a href="#l1.26"></a><span id="l1.26">     password: false,</span>
<a href="#l1.27"></a><span id="l1.27">     email: false,</span>
<a href="#l1.28"></a><span id="l1.28">     server: false</span>
<a href="#l1.29"></a><span id="l1.29">   },</span>
<a href="#l1.30"></a><span id="l1.30"> </span>
<a href="#l1.31"></a><span id="l1.31">   get _usingMainServers() {</span>
<a href="#l1.32"></a><span id="l1.32">     if (this._settingUpNew)</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineminus">-      return document.getElementById(&quot;serverType&quot;).selectedItem.value == &quot;main&quot;;</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineminus">-    return document.getElementById(&quot;existingServerType&quot;).selectedItem.value == &quot;main&quot;;</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineplus">+      return document.getElementById(&quot;server&quot;).selectedIndex == 0;</span>
<a href="#l1.37"></a><span id="l1.37" class="difflineplus">+    return document.getElementById(&quot;existingServer&quot;).selectedIndex == 0;</span>
<a href="#l1.38"></a><span id="l1.38">   },</span>
<a href="#l1.39"></a><span id="l1.39"> </span>
<a href="#l1.40"></a><span id="l1.40">   init: function () {</span>
<a href="#l1.41"></a><span id="l1.41">     let obs = [</span>
<a href="#l1.42"></a><span id="l1.42">       [&quot;weave:service:changepph:finish&quot;, &quot;onResetPassphrase&quot;],</span>
<a href="#l1.43"></a><span id="l1.43">       [&quot;weave:service:verify-login:start&quot;,  &quot;onLoginStart&quot;],</span>
<a href="#l1.44"></a><span id="l1.44">       [&quot;weave:service:verify-login:error&quot;,  &quot;onLoginEnd&quot;],</span>
<a href="#l1.45"></a><span id="l1.45">       [&quot;weave:service:verify-login:finish&quot;, &quot;onLoginEnd&quot;]];</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineat">@@ -133,17 +132,17 @@ var gSyncSetup = {</span>
<a href="#l1.47"></a><span id="l1.47"> </span>
<a href="#l1.48"></a><span id="l1.48">   startNewAccountSetup: function () {</span>
<a href="#l1.49"></a><span id="l1.49">     this._settingUpNew = true;</span>
<a href="#l1.50"></a><span id="l1.50">     this.wizard.pageIndex = NEW_ACCOUNT_START_PAGE;</span>
<a href="#l1.51"></a><span id="l1.51">   },</span>
<a href="#l1.52"></a><span id="l1.52"> </span>
<a href="#l1.53"></a><span id="l1.53">   useExistingAccount: function () {</span>
<a href="#l1.54"></a><span id="l1.54">     this._settingUpNew = false;</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineminus">-    this.wizard.pageIndex = EXISTING_ACCOUNT_LOGIN_PAGE;</span>
<a href="#l1.56"></a><span id="l1.56" class="difflineplus">+    this.wizard.pageIndex = EXISTING_ACCOUNT_CONNECT_PAGE;</span>
<a href="#l1.57"></a><span id="l1.57">   },</span>
<a href="#l1.58"></a><span id="l1.58"> </span>
<a href="#l1.59"></a><span id="l1.59">   onResetPassphrase: function () {</span>
<a href="#l1.60"></a><span id="l1.60">     document.getElementById(&quot;existingPassphrase&quot;).value =</span>
<a href="#l1.61"></a><span id="l1.61">       Weave.Utils.hyphenatePassphrase(Weave.Service.passphrase);</span>
<a href="#l1.62"></a><span id="l1.62"> </span>
<a href="#l1.63"></a><span id="l1.63">     this.wizard.advance();</span>
<a href="#l1.64"></a><span id="l1.64">   },</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineat">@@ -152,41 +151,40 @@ var gSyncSetup = {</span>
<a href="#l1.66"></a><span id="l1.66">     this.toggleLoginFeedback(false);</span>
<a href="#l1.67"></a><span id="l1.67">   },</span>
<a href="#l1.68"></a><span id="l1.68"> </span>
<a href="#l1.69"></a><span id="l1.69">   onLoginEnd: function () {</span>
<a href="#l1.70"></a><span id="l1.70">     this.toggleLoginFeedback(true);</span>
<a href="#l1.71"></a><span id="l1.71">   },</span>
<a href="#l1.72"></a><span id="l1.72"> </span>
<a href="#l1.73"></a><span id="l1.73">   toggleLoginFeedback: function (stop) {</span>
<a href="#l1.74"></a><span id="l1.74" class="difflineminus">-    switch (this.wizard.pageIndex) {</span>
<a href="#l1.75"></a><span id="l1.75" class="difflineminus">-      case EXISTING_ACCOUNT_LOGIN_PAGE:</span>
<a href="#l1.76"></a><span id="l1.76" class="difflineminus">-        document.getElementById(&quot;connect-throbber&quot;).hidden = stop;</span>
<a href="#l1.77"></a><span id="l1.77" class="difflineminus">-        let feedback = document.getElementById(&quot;existingPasswordFeedbackRow&quot;);</span>
<a href="#l1.78"></a><span id="l1.78" class="difflineminus">-        if (stop) {</span>
<a href="#l1.79"></a><span id="l1.79" class="difflineminus">-          let success = Weave.Status.login == Weave.LOGIN_SUCCEEDED ||</span>
<a href="#l1.80"></a><span id="l1.80" class="difflineminus">-                        Weave.Status.login == Weave.LOGIN_FAILED_INVALID_PASSPHRASE;</span>
<a href="#l1.81"></a><span id="l1.81" class="difflineminus">-          this._setFeedbackMessage(feedback, success, Weave.Status.login);</span>
<a href="#l1.82"></a><span id="l1.82" class="difflineminus">-        }</span>
<a href="#l1.83"></a><span id="l1.83" class="difflineminus">-        else</span>
<a href="#l1.84"></a><span id="l1.84" class="difflineminus">-          this._setFeedbackMessage(feedback, true);</span>
<a href="#l1.85"></a><span id="l1.85" class="difflineplus">+    document.getElementById(&quot;login-throbber&quot;).hidden = stop;</span>
<a href="#l1.86"></a><span id="l1.86" class="difflineplus">+    let password = document.getElementById(&quot;existingPasswordFeedbackRow&quot;);</span>
<a href="#l1.87"></a><span id="l1.87" class="difflineplus">+    let server = document.getElementById(&quot;existingServerFeedbackRow&quot;);</span>
<a href="#l1.88"></a><span id="l1.88" class="difflineplus">+    let passphrase = document.getElementById(&quot;existingPassphraseFeedbackRow&quot;);</span>
<a href="#l1.89"></a><span id="l1.89" class="difflineplus">+</span>
<a href="#l1.90"></a><span id="l1.90" class="difflineplus">+    if (!stop || Weave.Status.login == Weave.LOGIN_SUCCEEDED) {</span>
<a href="#l1.91"></a><span id="l1.91" class="difflineplus">+      password.hidden = server.hidden = passphrase.hidden = true;</span>
<a href="#l1.92"></a><span id="l1.92" class="difflineplus">+      return;</span>
<a href="#l1.93"></a><span id="l1.93" class="difflineplus">+    }</span>
<a href="#l1.94"></a><span id="l1.94" class="difflineplus">+</span>
<a href="#l1.95"></a><span id="l1.95" class="difflineplus">+    let feedback;</span>
<a href="#l1.96"></a><span id="l1.96" class="difflineplus">+    switch (Weave.Status.login) {</span>
<a href="#l1.97"></a><span id="l1.97" class="difflineplus">+      case Weave.LOGIN_FAILED_NETWORK_ERROR:</span>
<a href="#l1.98"></a><span id="l1.98" class="difflineplus">+      case Weave.LOGIN_FAILED_SERVER_ERROR:</span>
<a href="#l1.99"></a><span id="l1.99" class="difflineplus">+        feedback = server;</span>
<a href="#l1.100"></a><span id="l1.100">         break;</span>
<a href="#l1.101"></a><span id="l1.101" class="difflineminus">-      case EXISTING_ACCOUNT_PP_PAGE:</span>
<a href="#l1.102"></a><span id="l1.102" class="difflineminus">-        document.getElementById(&quot;passphrase-throbber&quot;).hidden = stop;</span>
<a href="#l1.103"></a><span id="l1.103" class="difflineminus">-        feedback = document.getElementById(&quot;existingPassphraseFeedbackBox&quot;);</span>
<a href="#l1.104"></a><span id="l1.104" class="difflineminus">-        if (stop) {</span>
<a href="#l1.105"></a><span id="l1.105" class="difflineminus">-          let success = Weave.Status.login == Weave.LOGIN_SUCCEEDED;</span>
<a href="#l1.106"></a><span id="l1.106" class="difflineminus">-          this._setFeedbackMessage(feedback, success, Weave.Status.login);</span>
<a href="#l1.107"></a><span id="l1.107" class="difflineminus">-          document.getElementById(&quot;passphraseHelpBox&quot;).hidden = success;</span>
<a href="#l1.108"></a><span id="l1.108" class="difflineminus">-        }</span>
<a href="#l1.109"></a><span id="l1.109" class="difflineminus">-        else</span>
<a href="#l1.110"></a><span id="l1.110" class="difflineminus">-          this._setFeedbackMessage(feedback, true);</span>
<a href="#l1.111"></a><span id="l1.111" class="difflineminus">-</span>
<a href="#l1.112"></a><span id="l1.112" class="difflineplus">+      case Weave.LOGIN_FAILED_LOGIN_REJECTED:</span>
<a href="#l1.113"></a><span id="l1.113" class="difflineplus">+        feedback = password;</span>
<a href="#l1.114"></a><span id="l1.114" class="difflineplus">+        break;</span>
<a href="#l1.115"></a><span id="l1.115" class="difflineplus">+      case Weave.LOGIN_FAILED_INVALID_PASSPHRASE:</span>
<a href="#l1.116"></a><span id="l1.116" class="difflineplus">+        feedback = passphrase;</span>
<a href="#l1.117"></a><span id="l1.117">         break;</span>
<a href="#l1.118"></a><span id="l1.118">     }</span>
<a href="#l1.119"></a><span id="l1.119" class="difflineplus">+    this._setFeedbackMessage(feedback, false, Weave.Status.login);</span>
<a href="#l1.120"></a><span id="l1.120">   },</span>
<a href="#l1.121"></a><span id="l1.121"> </span>
<a href="#l1.122"></a><span id="l1.122">   setupInitialSync: function () {</span>
<a href="#l1.123"></a><span id="l1.123">     let action = document.getElementById(&quot;mergeChoiceRadio&quot;).value;</span>
<a href="#l1.124"></a><span id="l1.124">     switch (action) {</span>
<a href="#l1.125"></a><span id="l1.125">       case &quot;resetClient&quot;:</span>
<a href="#l1.126"></a><span id="l1.126">         // if we're not resetting sync, we don't need to explicitly</span>
<a href="#l1.127"></a><span id="l1.127">         // call resetClient</span>
<a href="#l1.128"></a><span id="l1.128" class="difflineat">@@ -195,20 +193,16 @@ var gSyncSetup = {</span>
<a href="#l1.129"></a><span id="l1.129">         // otherwise, fall through</span>
<a href="#l1.130"></a><span id="l1.130">       case &quot;wipeClient&quot;:</span>
<a href="#l1.131"></a><span id="l1.131">       case &quot;wipeRemote&quot;:</span>
<a href="#l1.132"></a><span id="l1.132">         Weave.Svc.Prefs.set(&quot;firstSync&quot;, action);</span>
<a href="#l1.133"></a><span id="l1.133">         break;</span>
<a href="#l1.134"></a><span id="l1.134">     }</span>
<a href="#l1.135"></a><span id="l1.135">   },</span>
<a href="#l1.136"></a><span id="l1.136"> </span>
<a href="#l1.137"></a><span id="l1.137" class="difflineminus">-  onPassphraseKeyUp: function (event) {</span>
<a href="#l1.138"></a><span id="l1.138" class="difflineminus">-    this.checkFields();</span>
<a href="#l1.139"></a><span id="l1.139" class="difflineminus">-  },</span>
<a href="#l1.140"></a><span id="l1.140" class="difflineminus">-</span>
<a href="#l1.141"></a><span id="l1.141">   // fun with validation!</span>
<a href="#l1.142"></a><span id="l1.142">   checkFields: function () {</span>
<a href="#l1.143"></a><span id="l1.143">     this.wizard.canAdvance = this.readyToAdvance();</span>
<a href="#l1.144"></a><span id="l1.144">   },</span>
<a href="#l1.145"></a><span id="l1.145"> </span>
<a href="#l1.146"></a><span id="l1.146">   readyToAdvance: function () {</span>
<a href="#l1.147"></a><span id="l1.147">     switch (this.wizard.pageIndex) {</span>
<a href="#l1.148"></a><span id="l1.148">       case INTRO_PAGE:</span>
<a href="#l1.149"></a><span id="l1.149" class="difflineat">@@ -220,29 +214,27 @@ var gSyncSetup = {</span>
<a href="#l1.150"></a><span id="l1.150">         }</span>
<a href="#l1.151"></a><span id="l1.151">         if (this._usingMainServers)</span>
<a href="#l1.152"></a><span id="l1.152">           return document.getElementById(&quot;tos&quot;).checked;</span>
<a href="#l1.153"></a><span id="l1.153"> </span>
<a href="#l1.154"></a><span id="l1.154">         return true;</span>
<a href="#l1.155"></a><span id="l1.155">       case EXISTING_ACCOUNT_LOGIN_PAGE:</span>
<a href="#l1.156"></a><span id="l1.156">         let hasUser = document.getElementById(&quot;existingAccountName&quot;).value != &quot;&quot;;</span>
<a href="#l1.157"></a><span id="l1.157">         let hasPass = document.getElementById(&quot;existingPassword&quot;).value != &quot;&quot;;</span>
<a href="#l1.158"></a><span id="l1.158" class="difflineminus">-        if (hasUser &amp;&amp; hasPass) {</span>
<a href="#l1.159"></a><span id="l1.159" class="difflineplus">+        let hasKey = document.getElementById(&quot;existingPassphrase&quot;).value != &quot;&quot;;</span>
<a href="#l1.160"></a><span id="l1.160" class="difflineplus">+        if (hasUser &amp;&amp; hasPass &amp;&amp; hasKey) {</span>
<a href="#l1.161"></a><span id="l1.161">           if (this._usingMainServers)</span>
<a href="#l1.162"></a><span id="l1.162">             return true;</span>
<a href="#l1.163"></a><span id="l1.163"> </span>
<a href="#l1.164"></a><span id="l1.164" class="difflineminus">-          if (this._validateServer(document.getElementById(&quot;existingServerURL&quot;), false))</span>
<a href="#l1.165"></a><span id="l1.165" class="difflineplus">+          if (this._validateServer(document.getElementById(&quot;existingServer&quot;), false))</span>
<a href="#l1.166"></a><span id="l1.166">             return true;</span>
<a href="#l1.167"></a><span id="l1.167">         }</span>
<a href="#l1.168"></a><span id="l1.168">         return false;</span>
<a href="#l1.169"></a><span id="l1.169" class="difflineminus">-      case EXISTING_ACCOUNT_PP_PAGE:</span>
<a href="#l1.170"></a><span id="l1.170" class="difflineminus">-        let el = document.getElementById(&quot;existingPassphrase&quot;);</span>
<a href="#l1.171"></a><span id="l1.171" class="difflineminus">-        return Weave.Utils.isPassphrase(el.value);</span>
<a href="#l1.172"></a><span id="l1.172">     }</span>
<a href="#l1.173"></a><span id="l1.173" class="difflineminus">-    // we probably shouldn't get here</span>
<a href="#l1.174"></a><span id="l1.174" class="difflineplus">+    // Default, e.g. wizard's special page -1 etc.</span>
<a href="#l1.175"></a><span id="l1.175">     return true;</span>
<a href="#l1.176"></a><span id="l1.176">   },</span>
<a href="#l1.177"></a><span id="l1.177"> </span>
<a href="#l1.178"></a><span id="l1.178">   onEmailInput: function () {</span>
<a href="#l1.179"></a><span id="l1.179">     // Check account validity when the user stops typing for 1 second.</span>
<a href="#l1.180"></a><span id="l1.180">     if (this._checkAccountTimer)</span>
<a href="#l1.181"></a><span id="l1.181">       window.clearTimeout(this._checkAccountTimer);</span>
<a href="#l1.182"></a><span id="l1.182">     this._checkAccountTimer = window.setTimeout(function () {</span>
<a href="#l1.183"></a><span id="l1.183" class="difflineat">@@ -322,30 +314,36 @@ var gSyncSetup = {</span>
<a href="#l1.184"></a><span id="l1.184">         document.getElementById(&quot;saveSyncKeyButton&quot;).focus();</span>
<a href="#l1.185"></a><span id="l1.185">         let el = document.getElementById(&quot;weavePassphrase&quot;);</span>
<a href="#l1.186"></a><span id="l1.186">         if (!el.value)</span>
<a href="#l1.187"></a><span id="l1.187">           this.onPassphraseGenerate();</span>
<a href="#l1.188"></a><span id="l1.188">         this.checkFields();</span>
<a href="#l1.189"></a><span id="l1.189">         break;</span>
<a href="#l1.190"></a><span id="l1.190">       case NEW_ACCOUNT_START_PAGE:</span>
<a href="#l1.191"></a><span id="l1.191">         this.wizard.getButton(&quot;extra1&quot;).hidden = false;</span>
<a href="#l1.192"></a><span id="l1.192" class="difflineminus">-        this.onServerChange();</span>
<a href="#l1.193"></a><span id="l1.193" class="difflineminus">-        // fall through</span>
<a href="#l1.194"></a><span id="l1.194" class="difflineminus">-      case EXISTING_ACCOUNT_LOGIN_PAGE:</span>
<a href="#l1.195"></a><span id="l1.195" class="difflineplus">+        this.wizard.getButton(&quot;next&quot;).hidden = false;</span>
<a href="#l1.196"></a><span id="l1.196" class="difflineplus">+        this.wizard.getButton(&quot;back&quot;).hidden = false;</span>
<a href="#l1.197"></a><span id="l1.197" class="difflineplus">+        this.wizard.canRewind = true;</span>
<a href="#l1.198"></a><span id="l1.198">         this.checkFields();</span>
<a href="#l1.199"></a><span id="l1.199" class="difflineplus">+        break;</span>
<a href="#l1.200"></a><span id="l1.200" class="difflineplus">+      case EXISTING_ACCOUNT_CONNECT_PAGE:</span>
<a href="#l1.201"></a><span id="l1.201">         this.wizard.getButton(&quot;next&quot;).hidden = false;</span>
<a href="#l1.202"></a><span id="l1.202">         this.wizard.getButton(&quot;back&quot;).hidden = false;</span>
<a href="#l1.203"></a><span id="l1.203">         this.wizard.getButton(&quot;extra1&quot;).hidden = false;</span>
<a href="#l1.204"></a><span id="l1.204" class="difflineplus">+        this.wizard.canAdvance = false;</span>
<a href="#l1.205"></a><span id="l1.205">         this.wizard.canRewind = true;</span>
<a href="#l1.206"></a><span id="l1.206" class="difflineplus">+        this.startEasySetup();</span>
<a href="#l1.207"></a><span id="l1.207">         break;</span>
<a href="#l1.208"></a><span id="l1.208" class="difflineminus">-      case EXISTING_ACCOUNT_PP_PAGE:</span>
<a href="#l1.209"></a><span id="l1.209" class="difflineplus">+      case EXISTING_ACCOUNT_LOGIN_PAGE:</span>
<a href="#l1.210"></a><span id="l1.210" class="difflineplus">+        this.wizard.canRewind = true;</span>
<a href="#l1.211"></a><span id="l1.211">         this.checkFields();</span>
<a href="#l1.212"></a><span id="l1.212">         break;</span>
<a href="#l1.213"></a><span id="l1.213">       case SETUP_SUCCESS_PAGE:</span>
<a href="#l1.214"></a><span id="l1.214">         this.wizard.canRewind = false;</span>
<a href="#l1.215"></a><span id="l1.215" class="difflineplus">+        this.wizard.canAdvance = true;</span>
<a href="#l1.216"></a><span id="l1.216">         this.wizard.getButton(&quot;back&quot;).hidden = true;</span>
<a href="#l1.217"></a><span id="l1.217">         this.wizard.getButton(&quot;next&quot;).hidden = true;</span>
<a href="#l1.218"></a><span id="l1.218">         this.wizard.getButton(&quot;cancel&quot;).hidden = true;</span>
<a href="#l1.219"></a><span id="l1.219">         this.wizard.getButton(&quot;finish&quot;).hidden = false;</span>
<a href="#l1.220"></a><span id="l1.220">         this._handleSuccess();</span>
<a href="#l1.221"></a><span id="l1.221">         break;</span>
<a href="#l1.222"></a><span id="l1.222">       case OPTIONS_PAGE:</span>
<a href="#l1.223"></a><span id="l1.223">         this.wizard.canRewind = false;</span>
<a href="#l1.224"></a><span id="l1.224" class="difflineat">@@ -427,31 +425,16 @@ var gSyncSetup = {</span>
<a href="#l1.225"></a><span id="l1.225">         // Time to load the captcha.</span>
<a href="#l1.226"></a><span id="l1.226">         // First check for NoScript and whitelist the right sites.</span>
<a href="#l1.227"></a><span id="l1.227">         this._handleNoScript(true);</span>
<a href="#l1.228"></a><span id="l1.228">         this.captchaBrowser.loadURI(Weave.Service.miscAPI + &quot;captcha_html&quot;);</span>
<a href="#l1.229"></a><span id="l1.229">         break;</span>
<a href="#l1.230"></a><span id="l1.230">       case EXISTING_ACCOUNT_LOGIN_PAGE:</span>
<a href="#l1.231"></a><span id="l1.231">         Weave.Service.account = document.getElementById(&quot;existingAccountName&quot;).value;</span>
<a href="#l1.232"></a><span id="l1.232">         Weave.Service.password = document.getElementById(&quot;existingPassword&quot;).value;</span>
<a href="#l1.233"></a><span id="l1.233" class="difflineminus">-        Weave.Service.passphrase = Weave.Utils.normalizePassphrase(</span>
<a href="#l1.234"></a><span id="l1.234" class="difflineminus">-          document.getElementById(&quot;existingPassphrase&quot;).value);</span>
<a href="#l1.235"></a><span id="l1.235" class="difflineminus">-</span>
<a href="#l1.236"></a><span id="l1.236" class="difflineminus">-        // verifyLogin() will likely return false because we probably don't</span>
<a href="#l1.237"></a><span id="l1.237" class="difflineminus">-        // have a passphrase yet (unless the user already entered it</span>
<a href="#l1.238"></a><span id="l1.238" class="difflineminus">-        // and hit the back button).</span>
<a href="#l1.239"></a><span id="l1.239" class="difflineminus">-        if (!Weave.Service.verifyLogin()</span>
<a href="#l1.240"></a><span id="l1.240" class="difflineminus">-            &amp;&amp; Weave.Status.login != Weave.LOGIN_FAILED_NO_PASSPHRASE</span>
<a href="#l1.241"></a><span id="l1.241" class="difflineminus">-            &amp;&amp; Weave.Status.login != Weave.LOGIN_FAILED_INVALID_PASSPHRASE) {</span>
<a href="#l1.242"></a><span id="l1.242" class="difflineminus">-          let feedback = document.getElementById(&quot;existingPasswordFeedbackRow&quot;);</span>
<a href="#l1.243"></a><span id="l1.243" class="difflineminus">-          this._setFeedbackMessage(feedback, false, Weave.Status.login);</span>
<a href="#l1.244"></a><span id="l1.244" class="difflineminus">-          return false;</span>
<a href="#l1.245"></a><span id="l1.245" class="difflineminus">-        }</span>
<a href="#l1.246"></a><span id="l1.246" class="difflineminus">-        break;</span>
<a href="#l1.247"></a><span id="l1.247" class="difflineminus">-      case EXISTING_ACCOUNT_PP_PAGE:</span>
<a href="#l1.248"></a><span id="l1.248">         let pp = document.getElementById(&quot;existingPassphrase&quot;).value;</span>
<a href="#l1.249"></a><span id="l1.249">         Weave.Service.passphrase = Weave.Utils.normalizePassphrase(pp);</span>
<a href="#l1.250"></a><span id="l1.250">         if (Weave.Service.login())</span>
<a href="#l1.251"></a><span id="l1.251">           this.wizard.pageIndex = SETUP_SUCCESS_PAGE;</span>
<a href="#l1.252"></a><span id="l1.252">         return false;</span>
<a href="#l1.253"></a><span id="l1.253">       case OPTIONS_PAGE:</span>
<a href="#l1.254"></a><span id="l1.254">         let desc = document.getElementById(&quot;mergeChoiceRadio&quot;).selectedIndex;</span>
<a href="#l1.255"></a><span id="l1.255">         // No confirmation needed on new account setup or merge option</span>
<a href="#l1.256"></a><span id="l1.256" class="difflineat">@@ -471,18 +454,19 @@ var gSyncSetup = {</span>
<a href="#l1.257"></a><span id="l1.257">   },</span>
<a href="#l1.258"></a><span id="l1.258"> </span>
<a href="#l1.259"></a><span id="l1.259">   onWizardBack: function () {</span>
<a href="#l1.260"></a><span id="l1.260">     switch (this.wizard.pageIndex) {</span>
<a href="#l1.261"></a><span id="l1.261">       case NEW_ACCOUNT_START_PAGE:</span>
<a href="#l1.262"></a><span id="l1.262">       case EXISTING_ACCOUNT_LOGIN_PAGE:</span>
<a href="#l1.263"></a><span id="l1.263">         this.wizard.pageIndex = INTRO_PAGE;</span>
<a href="#l1.264"></a><span id="l1.264">         return false;</span>
<a href="#l1.265"></a><span id="l1.265" class="difflineminus">-      case EXISTING_ACCOUNT_PP_PAGE: // no idea wtf is up here, but meh!</span>
<a href="#l1.266"></a><span id="l1.266" class="difflineminus">-        this.wizard.pageIndex = EXISTING_ACCOUNT_LOGIN_PAGE;</span>
<a href="#l1.267"></a><span id="l1.267" class="difflineplus">+      case EXISTING_ACCOUNT_CONNECT_PAGE:</span>
<a href="#l1.268"></a><span id="l1.268" class="difflineplus">+        this.abortEasySetup();</span>
<a href="#l1.269"></a><span id="l1.269" class="difflineplus">+        this.wizard.pageIndex = INTRO_PAGE;</span>
<a href="#l1.270"></a><span id="l1.270">         return false;</span>
<a href="#l1.271"></a><span id="l1.271">       case OPTIONS_CONFIRM_PAGE:</span>
<a href="#l1.272"></a><span id="l1.272">         // Backing up from the confirmation page = resetting first sync to merge.</span>
<a href="#l1.273"></a><span id="l1.273">         document.getElementById(&quot;mergeChoiceRadio&quot;).selectedIndex = 0;</span>
<a href="#l1.274"></a><span id="l1.274">         return this.returnFromOptions();</span>
<a href="#l1.275"></a><span id="l1.275">     }</span>
<a href="#l1.276"></a><span id="l1.276">     return true;</span>
<a href="#l1.277"></a><span id="l1.277">   },</span>
<a href="#l1.278"></a><span id="l1.278" class="difflineat">@@ -520,16 +504,17 @@ var gSyncSetup = {</span>
<a href="#l1.279"></a><span id="l1.279">   onWizardCancel: function () {</span>
<a href="#l1.280"></a><span id="l1.280">     if (this._resettingSync)</span>
<a href="#l1.281"></a><span id="l1.281">       return;</span>
<a href="#l1.282"></a><span id="l1.282"> </span>
<a href="#l1.283"></a><span id="l1.283">     if (this.wizard.pageIndex == SETUP_SUCCESS_PAGE) {</span>
<a href="#l1.284"></a><span id="l1.284">       this.onWizardFinish();</span>
<a href="#l1.285"></a><span id="l1.285">       return;</span>
<a href="#l1.286"></a><span id="l1.286">     }</span>
<a href="#l1.287"></a><span id="l1.287" class="difflineplus">+    this.abortEasySetup();</span>
<a href="#l1.288"></a><span id="l1.288">     this._handleNoScript(false);</span>
<a href="#l1.289"></a><span id="l1.289">     Weave.Service.startOver();</span>
<a href="#l1.290"></a><span id="l1.290">   },</span>
<a href="#l1.291"></a><span id="l1.291"> </span>
<a href="#l1.292"></a><span id="l1.292">   onSyncOptions: function () {</span>
<a href="#l1.293"></a><span id="l1.293">     this._beforeOptionsPage = this.wizard.pageIndex;</span>
<a href="#l1.294"></a><span id="l1.294">     this.wizard.pageIndex = OPTIONS_PAGE;</span>
<a href="#l1.295"></a><span id="l1.295">   },</span>
<a href="#l1.296"></a><span id="l1.296" class="difflineat">@@ -542,16 +527,74 @@ var gSyncSetup = {</span>
<a href="#l1.297"></a><span id="l1.297">     this.wizard.getButton(&quot;back&quot;).setAttribute(&quot;accesskey&quot;,</span>
<a href="#l1.298"></a><span id="l1.298">                                                this._backButtonAccesskey);</span>
<a href="#l1.299"></a><span id="l1.299">     this.wizard.getButton(&quot;cancel&quot;).hidden = false;</span>
<a href="#l1.300"></a><span id="l1.300">     this.wizard.getButton(&quot;extra1&quot;).hidden = false;</span>
<a href="#l1.301"></a><span id="l1.301">     this.wizard.pageIndex = this._beforeOptionsPage;</span>
<a href="#l1.302"></a><span id="l1.302">     return false;</span>
<a href="#l1.303"></a><span id="l1.303">   },</span>
<a href="#l1.304"></a><span id="l1.304"> </span>
<a href="#l1.305"></a><span id="l1.305" class="difflineplus">+  startEasySetup: function () {</span>
<a href="#l1.306"></a><span id="l1.306" class="difflineplus">+    // Don't do anything if we have a client already (e.g. we went to</span>
<a href="#l1.307"></a><span id="l1.307" class="difflineplus">+    // Sync Options and just came back).</span>
<a href="#l1.308"></a><span id="l1.308" class="difflineplus">+    if (this._jpakeclient)</span>
<a href="#l1.309"></a><span id="l1.309" class="difflineplus">+      return;</span>
<a href="#l1.310"></a><span id="l1.310" class="difflineplus">+</span>
<a href="#l1.311"></a><span id="l1.311" class="difflineplus">+    let self = this;</span>
<a href="#l1.312"></a><span id="l1.312" class="difflineplus">+    this._jpakeclient = new Weave.JPAKEClient({</span>
<a href="#l1.313"></a><span id="l1.313" class="difflineplus">+      displayPIN: function displayPIN(pin) {</span>
<a href="#l1.314"></a><span id="l1.314" class="difflineplus">+        document.getElementById(&quot;easySetupPIN1&quot;).value = pin.slice(0, 4);</span>
<a href="#l1.315"></a><span id="l1.315" class="difflineplus">+        document.getElementById(&quot;easySetupPIN2&quot;).value = pin.slice(4, 8);</span>
<a href="#l1.316"></a><span id="l1.316" class="difflineplus">+        document.getElementById(&quot;easySetupPIN3&quot;).value = pin.slice(8);</span>
<a href="#l1.317"></a><span id="l1.317" class="difflineplus">+      },</span>
<a href="#l1.318"></a><span id="l1.318" class="difflineplus">+</span>
<a href="#l1.319"></a><span id="l1.319" class="difflineplus">+      onComplete: function onComplete(credentials) {</span>
<a href="#l1.320"></a><span id="l1.320" class="difflineplus">+        Weave.Service.account = credentials.account;</span>
<a href="#l1.321"></a><span id="l1.321" class="difflineplus">+        Weave.Service.password = credentials.password;</span>
<a href="#l1.322"></a><span id="l1.322" class="difflineplus">+        Weave.Service.passphrase = credentials.synckey;</span>
<a href="#l1.323"></a><span id="l1.323" class="difflineplus">+        Weave.Service.serverURL = credentials.serverURL;</span>
<a href="#l1.324"></a><span id="l1.324" class="difflineplus">+        self.wizard.pageIndex = SETUP_SUCCESS_PAGE;</span>
<a href="#l1.325"></a><span id="l1.325" class="difflineplus">+      },</span>
<a href="#l1.326"></a><span id="l1.326" class="difflineplus">+</span>
<a href="#l1.327"></a><span id="l1.327" class="difflineplus">+      onAbort: function onAbort(error) {</span>
<a href="#l1.328"></a><span id="l1.328" class="difflineplus">+        delete self._jpakeclient;</span>
<a href="#l1.329"></a><span id="l1.329" class="difflineplus">+</span>
<a href="#l1.330"></a><span id="l1.330" class="difflineplus">+        // No error means manual abort, e.g. wizard is aborted. Ignore.</span>
<a href="#l1.331"></a><span id="l1.331" class="difflineplus">+        if (!error)</span>
<a href="#l1.332"></a><span id="l1.332" class="difflineplus">+          return;</span>
<a href="#l1.333"></a><span id="l1.333" class="difflineplus">+</span>
<a href="#l1.334"></a><span id="l1.334" class="difflineplus">+        // Automatically go to manual setup if we couldn't acquire a channel.</span>
<a href="#l1.335"></a><span id="l1.335" class="difflineplus">+        if (error == Weave.JPAKE_ERROR_CHANNEL) {</span>
<a href="#l1.336"></a><span id="l1.336" class="difflineplus">+          self.wizard.pageIndex = EXISTING_ACCOUNT_LOGIN_PAGE;</span>
<a href="#l1.337"></a><span id="l1.337" class="difflineplus">+          return;</span>
<a href="#l1.338"></a><span id="l1.338" class="difflineplus">+        }</span>
<a href="#l1.339"></a><span id="l1.339" class="difflineplus">+</span>
<a href="#l1.340"></a><span id="l1.340" class="difflineplus">+        // Restart on all other errors.</span>
<a href="#l1.341"></a><span id="l1.341" class="difflineplus">+        self.startEasySetup();</span>
<a href="#l1.342"></a><span id="l1.342" class="difflineplus">+      }</span>
<a href="#l1.343"></a><span id="l1.343" class="difflineplus">+    });</span>
<a href="#l1.344"></a><span id="l1.344" class="difflineplus">+    this._jpakeclient.receiveNoPIN();</span>
<a href="#l1.345"></a><span id="l1.345" class="difflineplus">+  },</span>
<a href="#l1.346"></a><span id="l1.346" class="difflineplus">+</span>
<a href="#l1.347"></a><span id="l1.347" class="difflineplus">+  abortEasySetup: function () {</span>
<a href="#l1.348"></a><span id="l1.348" class="difflineplus">+    document.getElementById(&quot;easySetupPIN1&quot;).value = &quot;&quot;;</span>
<a href="#l1.349"></a><span id="l1.349" class="difflineplus">+    document.getElementById(&quot;easySetupPIN2&quot;).value = &quot;&quot;;</span>
<a href="#l1.350"></a><span id="l1.350" class="difflineplus">+    document.getElementById(&quot;easySetupPIN3&quot;).value = &quot;&quot;;</span>
<a href="#l1.351"></a><span id="l1.351" class="difflineplus">+    if (!this._jpakeclient)</span>
<a href="#l1.352"></a><span id="l1.352" class="difflineplus">+      return;</span>
<a href="#l1.353"></a><span id="l1.353" class="difflineplus">+</span>
<a href="#l1.354"></a><span id="l1.354" class="difflineplus">+    this._jpakeclient.abort();</span>
<a href="#l1.355"></a><span id="l1.355" class="difflineplus">+    delete this._jpakeclient;</span>
<a href="#l1.356"></a><span id="l1.356" class="difflineplus">+  },</span>
<a href="#l1.357"></a><span id="l1.357" class="difflineplus">+</span>
<a href="#l1.358"></a><span id="l1.358" class="difflineplus">+  manualSetup: function () {</span>
<a href="#l1.359"></a><span id="l1.359" class="difflineplus">+    this.abortEasySetup();</span>
<a href="#l1.360"></a><span id="l1.360" class="difflineplus">+    this.wizard.pageIndex = EXISTING_ACCOUNT_LOGIN_PAGE;</span>
<a href="#l1.361"></a><span id="l1.361" class="difflineplus">+  },</span>
<a href="#l1.362"></a><span id="l1.362" class="difflineplus">+</span>
<a href="#l1.363"></a><span id="l1.363">   // _handleNoScript is needed because it blocks the captcha. So we temporarily</span>
<a href="#l1.364"></a><span id="l1.364">   // allow the necessary sites so that we can verify the user is in fact a human.</span>
<a href="#l1.365"></a><span id="l1.365">   // This was done with the help of Giorgio (NoScript author). See bug 508112.</span>
<a href="#l1.366"></a><span id="l1.366">   _handleNoScript: function (addExceptions) {</span>
<a href="#l1.367"></a><span id="l1.367">     // if NoScript isn't installed, or is disabled, bail out.</span>
<a href="#l1.368"></a><span id="l1.368">     if (!(&quot;@maone.net/noscript-service;1&quot; in Cc))</span>
<a href="#l1.369"></a><span id="l1.369">       return;</span>
<a href="#l1.370"></a><span id="l1.370"> </span>
<a href="#l1.371"></a><span id="l1.371" class="difflineat">@@ -568,34 +611,56 @@ var gSyncSetup = {</span>
<a href="#l1.372"></a><span id="l1.372">     else {</span>
<a href="#l1.373"></a><span id="l1.373">       this._disabledSites.forEach(function(site) {</span>
<a href="#l1.374"></a><span id="l1.374">         ns.setJSEnabled(site, false);</span>
<a href="#l1.375"></a><span id="l1.375">       });</span>
<a href="#l1.376"></a><span id="l1.376">       this._disabledSites = [];</span>
<a href="#l1.377"></a><span id="l1.377">     }</span>
<a href="#l1.378"></a><span id="l1.378">   },</span>
<a href="#l1.379"></a><span id="l1.379"> </span>
<a href="#l1.380"></a><span id="l1.380" class="difflineminus">-  onServerChange: function () {</span>
<a href="#l1.381"></a><span id="l1.381" class="difflineminus">-    if (this.wizard.pageIndex == EXISTING_ACCOUNT_LOGIN_PAGE) {</span>
<a href="#l1.382"></a><span id="l1.382" class="difflineminus">-      if (this._usingMainServers)</span>
<a href="#l1.383"></a><span id="l1.383" class="difflineminus">-        Weave.Svc.Prefs.reset(&quot;serverURL&quot;);</span>
<a href="#l1.384"></a><span id="l1.384" class="difflineminus">-      document.getElementById(&quot;existingServerRow&quot;).hidden = this._usingMainServers;</span>
<a href="#l1.385"></a><span id="l1.385" class="difflineminus">-      this.checkFields();</span>
<a href="#l1.386"></a><span id="l1.386" class="difflineminus">-      return;</span>
<a href="#l1.387"></a><span id="l1.387" class="difflineplus">+  _updateControl: function(controlId) {</span>
<a href="#l1.388"></a><span id="l1.388" class="difflineplus">+    let control = document.getElementById(controlId);</span>
<a href="#l1.389"></a><span id="l1.389" class="difflineplus">+    if (control.selectedIndex == 0) {</span>
<a href="#l1.390"></a><span id="l1.390" class="difflineplus">+      control.editable = false;</span>
<a href="#l1.391"></a><span id="l1.391" class="difflineplus">+      Weave.Svc.Prefs.reset(&quot;serverURL&quot;);</span>
<a href="#l1.392"></a><span id="l1.392" class="difflineplus">+    } else {</span>
<a href="#l1.393"></a><span id="l1.393" class="difflineplus">+      // Prevent double selection upon using down key.</span>
<a href="#l1.394"></a><span id="l1.394" class="difflineplus">+      control.menuBoxObject.activeChild = null;</span>
<a href="#l1.395"></a><span id="l1.395" class="difflineplus">+      control.editable = true;</span>
<a href="#l1.396"></a><span id="l1.396" class="difflineplus">+      control.value = &quot;&quot;;</span>
<a href="#l1.397"></a><span id="l1.397">     }</span>
<a href="#l1.398"></a><span id="l1.398" class="difflineplus">+    // Force a style flush to ensure that the binding is attached.</span>
<a href="#l1.399"></a><span id="l1.399" class="difflineplus">+    control.clientTop;</span>
<a href="#l1.400"></a><span id="l1.400" class="difflineplus">+    control.focus();</span>
<a href="#l1.401"></a><span id="l1.401" class="difflineplus">+    return control;</span>
<a href="#l1.402"></a><span id="l1.402" class="difflineplus">+  },</span>
<a href="#l1.403"></a><span id="l1.403" class="difflineplus">+  </span>
<a href="#l1.404"></a><span id="l1.404" class="difflineplus">+  onExistingServerCommand: function () {</span>
<a href="#l1.405"></a><span id="l1.405" class="difflineplus">+    this._updateControl(&quot;existingServer&quot;);</span>
<a href="#l1.406"></a><span id="l1.406" class="difflineplus">+    document.getElementById(&quot;existingServerFeedbackRow&quot;).hidden = true;</span>
<a href="#l1.407"></a><span id="l1.407" class="difflineplus">+    this.checkFields();</span>
<a href="#l1.408"></a><span id="l1.408" class="difflineplus">+  },</span>
<a href="#l1.409"></a><span id="l1.409"> </span>
<a href="#l1.410"></a><span id="l1.410" class="difflineminus">-    document.getElementById(&quot;serverRow&quot;).hidden = this._usingMainServers;</span>
<a href="#l1.411"></a><span id="l1.411" class="difflineplus">+  onExistingServerInput: function () {</span>
<a href="#l1.412"></a><span id="l1.412" class="difflineplus">+    // Check custom server validity when the user stops typing for 1 second.</span>
<a href="#l1.413"></a><span id="l1.413" class="difflineplus">+    if (this._existingServerTimer)</span>
<a href="#l1.414"></a><span id="l1.414" class="difflineplus">+      window.clearTimeout(this._existingServerTimer);</span>
<a href="#l1.415"></a><span id="l1.415" class="difflineplus">+    this._existingServerTimer = window.setTimeout(function () {</span>
<a href="#l1.416"></a><span id="l1.416" class="difflineplus">+      gSyncSetup.checkFields();</span>
<a href="#l1.417"></a><span id="l1.417" class="difflineplus">+    }, 1000);</span>
<a href="#l1.418"></a><span id="l1.418" class="difflineplus">+  },</span>
<a href="#l1.419"></a><span id="l1.419" class="difflineplus">+</span>
<a href="#l1.420"></a><span id="l1.420" class="difflineplus">+  onServerCommand: function () {</span>
<a href="#l1.421"></a><span id="l1.421">     document.getElementById(&quot;TOSRow&quot;).hidden = !this._usingMainServers;</span>
<a href="#l1.422"></a><span id="l1.422" class="difflineminus">-</span>
<a href="#l1.423"></a><span id="l1.423" class="difflineminus">-    if (!this._usingMainServers) {</span>
<a href="#l1.424"></a><span id="l1.424" class="difflineplus">+    let control = this._updateControl(&quot;server&quot;);</span>
<a href="#l1.425"></a><span id="l1.425" class="difflineplus">+    if (control.selectedIndex &gt; 0) {</span>
<a href="#l1.426"></a><span id="l1.426" class="difflineplus">+      // checkServer() will call checkAccount() and checkFields().</span>
<a href="#l1.427"></a><span id="l1.427">       this.checkServer();</span>
<a href="#l1.428"></a><span id="l1.428">       return;</span>
<a href="#l1.429"></a><span id="l1.429">     }</span>
<a href="#l1.430"></a><span id="l1.430" class="difflineminus">-</span>
<a href="#l1.431"></a><span id="l1.431" class="difflineminus">-    Weave.Svc.Prefs.reset(&quot;serverURL&quot;);</span>
<a href="#l1.432"></a><span id="l1.432">     this.checkAccount();</span>
<a href="#l1.433"></a><span id="l1.433">     this.status.server = true;</span>
<a href="#l1.434"></a><span id="l1.434">     document.getElementById(&quot;serverFeedbackRow&quot;).hidden = true;</span>
<a href="#l1.435"></a><span id="l1.435">     this.checkFields();</span>
<a href="#l1.436"></a><span id="l1.436">   },</span>
<a href="#l1.437"></a><span id="l1.437"> </span>
<a href="#l1.438"></a><span id="l1.438">   onServerInput: function () {</span>
<a href="#l1.439"></a><span id="l1.439">     // Check custom server validity when the user stops typing for 1 second.</span>
<a href="#l1.440"></a><span id="l1.440" class="difflineat">@@ -603,17 +668,17 @@ var gSyncSetup = {</span>
<a href="#l1.441"></a><span id="l1.441">       window.clearTimeout(this._checkServerTimer);</span>
<a href="#l1.442"></a><span id="l1.442">     this._checkServerTimer = window.setTimeout(function () {</span>
<a href="#l1.443"></a><span id="l1.443">       gSyncSetup.checkServer();</span>
<a href="#l1.444"></a><span id="l1.444">     }, 1000);</span>
<a href="#l1.445"></a><span id="l1.445">   },</span>
<a href="#l1.446"></a><span id="l1.446"> </span>
<a href="#l1.447"></a><span id="l1.447">   checkServer: function () {</span>
<a href="#l1.448"></a><span id="l1.448">     delete this._checkServerTimer;</span>
<a href="#l1.449"></a><span id="l1.449" class="difflineminus">-    let el = document.getElementById(&quot;weaveServerURL&quot;);</span>
<a href="#l1.450"></a><span id="l1.450" class="difflineplus">+    let el = document.getElementById(&quot;server&quot;);</span>
<a href="#l1.451"></a><span id="l1.451">     let valid = false;</span>
<a href="#l1.452"></a><span id="l1.452">     let feedback = document.getElementById(&quot;serverFeedbackRow&quot;);</span>
<a href="#l1.453"></a><span id="l1.453"> </span>
<a href="#l1.454"></a><span id="l1.454">     let str = &quot;&quot;;</span>
<a href="#l1.455"></a><span id="l1.455">     if (el.value) {</span>
<a href="#l1.456"></a><span id="l1.456">       valid = this._validateServer(el, true);</span>
<a href="#l1.457"></a><span id="l1.457">       let str = valid ? &quot;&quot; : &quot;serverInvalid.label&quot;;</span>
<a href="#l1.458"></a><span id="l1.458">       this._setFeedbackMessage(feedback, valid, str);</span>
<a href="#l1.459"></a><span id="l1.459" class="difflineat">@@ -800,19 +865,19 @@ var gSyncSetup = {</span>
<a href="#l1.460"></a><span id="l1.460">     return true;</span>
<a href="#l1.461"></a><span id="l1.461">   },</span>
<a href="#l1.462"></a><span id="l1.462"> </span>
<a href="#l1.463"></a><span id="l1.463">   // sets class and string on a feedback element</span>
<a href="#l1.464"></a><span id="l1.464">   // if no property string is passed in, we clear label/style</span>
<a href="#l1.465"></a><span id="l1.465">   _setFeedback: function (element, success, string) {</span>
<a href="#l1.466"></a><span id="l1.466">     element.hidden = success || !string;</span>
<a href="#l1.467"></a><span id="l1.467">     let classname = success ? &quot;success&quot; : &quot;error&quot;;</span>
<a href="#l1.468"></a><span id="l1.468" class="difflineminus">-    let image = element.lastChild.firstChild;</span>
<a href="#l1.469"></a><span id="l1.469" class="difflineplus">+    let image = element.getElementsByAttribute(&quot;class&quot;, &quot;statusIcon&quot;)[0];</span>
<a href="#l1.470"></a><span id="l1.470">     image.setAttribute(&quot;status&quot;, classname);</span>
<a href="#l1.471"></a><span id="l1.471" class="difflineminus">-    let label = element.lastChild.lastChild;</span>
<a href="#l1.472"></a><span id="l1.472" class="difflineplus">+    let label = element.getElementsByAttribute(&quot;class&quot;, &quot;status&quot;)[0];</span>
<a href="#l1.473"></a><span id="l1.473">     label.value = string;</span>
<a href="#l1.474"></a><span id="l1.474">   },</span>
<a href="#l1.475"></a><span id="l1.475"> </span>
<a href="#l1.476"></a><span id="l1.476">   // shim</span>
<a href="#l1.477"></a><span id="l1.477">   _setFeedbackMessage: function (element, success, string) {</span>
<a href="#l1.478"></a><span id="l1.478">     let str = &quot;&quot;;</span>
<a href="#l1.479"></a><span id="l1.479">     if (string) {</span>
<a href="#l1.480"></a><span id="l1.480">       try {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/suite/common/sync/syncSetup.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/suite/common/sync/syncSetup.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -84,19 +84,21 @@</span>
<a href="#l2.4"></a><span id="l2.4">               label=&quot;&amp;button.createNewAccount.label;&quot;</span>
<a href="#l2.5"></a><span id="l2.5">               oncommand=&quot;gSyncSetup.startNewAccountSetup();&quot;</span>
<a href="#l2.6"></a><span id="l2.6">               align=&quot;center&quot;/&gt;</span>
<a href="#l2.7"></a><span id="l2.7">       &lt;spacer flex=&quot;3&quot;/&gt;</span>
<a href="#l2.8"></a><span id="l2.8">     &lt;/vbox&gt;</span>
<a href="#l2.9"></a><span id="l2.9">     &lt;separator class=&quot;groove&quot;/&gt;</span>
<a href="#l2.10"></a><span id="l2.10">     &lt;vbox align=&quot;center&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l2.11"></a><span id="l2.11">       &lt;spacer flex=&quot;3&quot;/&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+      &lt;label value=&quot;&amp;setup.haveAccount.label;&quot;/&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+      &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l2.14"></a><span id="l2.14">       &lt;button id=&quot;existingAccount&quot;</span>
<a href="#l2.15"></a><span id="l2.15">               class=&quot;accountChoiceButton&quot;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineminus">-              label=&quot;&amp;button.haveAccount.label;&quot;</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+              label=&quot;&amp;button.connect.label;&quot;</span>
<a href="#l2.18"></a><span id="l2.18">               oncommand=&quot;gSyncSetup.useExistingAccount();&quot;/&gt;</span>
<a href="#l2.19"></a><span id="l2.19">       &lt;spacer flex=&quot;3&quot;/&gt;</span>
<a href="#l2.20"></a><span id="l2.20">     &lt;/vbox&gt;</span>
<a href="#l2.21"></a><span id="l2.21">   &lt;/wizardpage&gt;</span>
<a href="#l2.22"></a><span id="l2.22"> </span>
<a href="#l2.23"></a><span id="l2.23">   &lt;wizardpage id=&quot;newAccountStart&quot;</span>
<a href="#l2.24"></a><span id="l2.24">               label=&quot;&amp;setup.newAccountDetailsPage.title.label;&quot;</span>
<a href="#l2.25"></a><span id="l2.25">               onextra1=&quot;gSyncSetup.onSyncOptions();&quot;</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineat">@@ -140,33 +142,28 @@</span>
<a href="#l2.27"></a><span id="l2.27">         &lt;row id=&quot;passwordFeedbackRow&quot; align=&quot;center&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l2.28"></a><span id="l2.28">           &lt;spacer/&gt;</span>
<a href="#l2.29"></a><span id="l2.29">           &lt;hbox&gt;</span>
<a href="#l2.30"></a><span id="l2.30">             &lt;image class=&quot;statusIcon&quot;/&gt;</span>
<a href="#l2.31"></a><span id="l2.31">             &lt;label class=&quot;status&quot; value=&quot; &quot;/&gt;</span>
<a href="#l2.32"></a><span id="l2.32">           &lt;/hbox&gt;</span>
<a href="#l2.33"></a><span id="l2.33">         &lt;/row&gt;</span>
<a href="#l2.34"></a><span id="l2.34">         &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineminus">-          &lt;label control=&quot;serverType&quot;</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineplus">+          &lt;label control=&quot;server&quot;</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineplus">+                 accesskey=&quot;&amp;server.accesskey;&quot;</span>
<a href="#l2.38"></a><span id="l2.38">                  value=&quot;&amp;server.label;&quot;/&gt;</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineminus">-          &lt;menulist id=&quot;serverType&quot; oncommand=&quot;gSyncSetup.onServerChange();&quot;&gt;</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineplus">+          &lt;menulist id=&quot;server&quot;</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineplus">+                    oncommand=&quot;gSyncSetup.onServerCommand();&quot;</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineplus">+                    oninput=&quot;gSyncSetup.onServerInput();&quot;&gt;</span>
<a href="#l2.43"></a><span id="l2.43">             &lt;menupopup&gt;</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineminus">-              &lt;menuitem label=&quot;&amp;serverType.main.label;&quot;</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineminus">-                        value=&quot;main&quot;/&gt;</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineminus">-              &lt;menuitem label=&quot;&amp;serverType.custom.label;&quot;</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineminus">-                        value=&quot;custom&quot;/&gt;</span>
<a href="#l2.48"></a><span id="l2.48" class="difflineplus">+              &lt;menuitem label=&quot;&amp;serverType.main.label;&quot;/&gt;</span>
<a href="#l2.49"></a><span id="l2.49" class="difflineplus">+              &lt;menuitem label=&quot;&amp;serverType.custom2.label;&quot;/&gt;</span>
<a href="#l2.50"></a><span id="l2.50">             &lt;/menupopup&gt;</span>
<a href="#l2.51"></a><span id="l2.51">           &lt;/menulist&gt;</span>
<a href="#l2.52"></a><span id="l2.52">         &lt;/row&gt;</span>
<a href="#l2.53"></a><span id="l2.53" class="difflineminus">-        &lt;row id=&quot;serverRow&quot; hidden=&quot;true&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineminus">-          &lt;label value=&quot;&amp;signIn.serverURL.label;&quot;</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineminus">-                 accesskey=&quot;&amp;signIn.serverURL.accesskey;&quot;</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineminus">-                 control=&quot;weaveServerURL&quot;/&gt;</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineminus">-          &lt;textbox id=&quot;weaveServerURL&quot; oninput=&quot;gSyncSetup.onServerInput();&quot;/&gt;</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineminus">-        &lt;/row&gt;</span>
<a href="#l2.59"></a><span id="l2.59">         &lt;row id=&quot;serverFeedbackRow&quot; align=&quot;center&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l2.60"></a><span id="l2.60">           &lt;spacer/&gt;</span>
<a href="#l2.61"></a><span id="l2.61">           &lt;hbox&gt;</span>
<a href="#l2.62"></a><span id="l2.62">             &lt;image class=&quot;statusIcon&quot;/&gt;</span>
<a href="#l2.63"></a><span id="l2.63">             &lt;label class=&quot;status&quot; value=&quot; &quot;/&gt;</span>
<a href="#l2.64"></a><span id="l2.64">           &lt;/hbox&gt;</span>
<a href="#l2.65"></a><span id="l2.65">         &lt;/row&gt;</span>
<a href="#l2.66"></a><span id="l2.66">         &lt;row id=&quot;TOSRow&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.67"></a><span id="l2.67" class="difflineat">@@ -244,116 +241,146 @@</span>
<a href="#l2.68"></a><span id="l2.68">       &lt;hbox id=&quot;captchaFeedback&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l2.69"></a><span id="l2.69">         &lt;image class=&quot;statusIcon&quot;/&gt;</span>
<a href="#l2.70"></a><span id="l2.70">         &lt;label class=&quot;status&quot; value=&quot; &quot;/&gt;</span>
<a href="#l2.71"></a><span id="l2.71">       &lt;/hbox&gt;</span>
<a href="#l2.72"></a><span id="l2.72">       &lt;spacer flex=&quot;3&quot;/&gt;</span>
<a href="#l2.73"></a><span id="l2.73">     &lt;/vbox&gt;</span>
<a href="#l2.74"></a><span id="l2.74">   &lt;/wizardpage&gt;</span>
<a href="#l2.75"></a><span id="l2.75"> </span>
<a href="#l2.76"></a><span id="l2.76" class="difflineminus">-  &lt;wizardpage id=&quot;useExisting&quot;</span>
<a href="#l2.77"></a><span id="l2.77" class="difflineminus">-              label=&quot;&amp;setup.existingAccount.title.label;&quot;</span>
<a href="#l2.78"></a><span id="l2.78" class="difflineplus">+  &lt;wizardpage id=&quot;addDevice&quot;</span>
<a href="#l2.79"></a><span id="l2.79" class="difflineplus">+              label=&quot;&amp;addDevice.title.label;&quot;</span>
<a href="#l2.80"></a><span id="l2.80" class="difflineplus">+              onextra1=&quot;gSyncSetup.onSyncOptions();&quot;</span>
<a href="#l2.81"></a><span id="l2.81" class="difflineplus">+              onpageshow=&quot;gSyncSetup.onPageShow();&quot;&gt;</span>
<a href="#l2.82"></a><span id="l2.82" class="difflineplus">+    &lt;description&gt;</span>
<a href="#l2.83"></a><span id="l2.83" class="difflineplus">+      &amp;addDevice.setup.description.label;</span>
<a href="#l2.84"></a><span id="l2.84" class="difflineplus">+      &lt;label class=&quot;text-link&quot;</span>
<a href="#l2.85"></a><span id="l2.85" class="difflineplus">+             value=&quot;&amp;addDevice.showMeHow.label;&quot;</span>
<a href="#l2.86"></a><span id="l2.86" class="difflineplus">+             href=&quot;https://services.mozilla.com/sync/help/easy-setup&quot;/&gt;</span>
<a href="#l2.87"></a><span id="l2.87" class="difflineplus">+    &lt;/description&gt;</span>
<a href="#l2.88"></a><span id="l2.88" class="difflineplus">+    &lt;description&gt;&amp;addDevice.setup.enterCode.label;&lt;/description&gt;</span>
<a href="#l2.89"></a><span id="l2.89" class="difflineplus">+    &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l2.90"></a><span id="l2.90" class="difflineplus">+    &lt;vbox align=&quot;center&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l2.91"></a><span id="l2.91" class="difflineplus">+      &lt;textbox id=&quot;easySetupPIN1&quot;</span>
<a href="#l2.92"></a><span id="l2.92" class="difflineplus">+               class=&quot;pin&quot;</span>
<a href="#l2.93"></a><span id="l2.93" class="difflineplus">+               value=&quot;&quot;</span>
<a href="#l2.94"></a><span id="l2.94" class="difflineplus">+               size=&quot;4&quot;</span>
<a href="#l2.95"></a><span id="l2.95" class="difflineplus">+               disabled=&quot;true&quot;/&gt;</span>
<a href="#l2.96"></a><span id="l2.96" class="difflineplus">+      &lt;textbox id=&quot;easySetupPIN2&quot;</span>
<a href="#l2.97"></a><span id="l2.97" class="difflineplus">+               class=&quot;pin&quot;</span>
<a href="#l2.98"></a><span id="l2.98" class="difflineplus">+               value=&quot;&quot;</span>
<a href="#l2.99"></a><span id="l2.99" class="difflineplus">+               size=&quot;4&quot;</span>
<a href="#l2.100"></a><span id="l2.100" class="difflineplus">+               disabled=&quot;true&quot;/&gt;</span>
<a href="#l2.101"></a><span id="l2.101" class="difflineplus">+      &lt;textbox id=&quot;easySetupPIN3&quot;</span>
<a href="#l2.102"></a><span id="l2.102" class="difflineplus">+               class=&quot;pin&quot;</span>
<a href="#l2.103"></a><span id="l2.103" class="difflineplus">+               value=&quot;&quot;</span>
<a href="#l2.104"></a><span id="l2.104" class="difflineplus">+               size=&quot;4&quot;</span>
<a href="#l2.105"></a><span id="l2.105" class="difflineplus">+               disabled=&quot;true&quot;/&gt;</span>
<a href="#l2.106"></a><span id="l2.106" class="difflineplus">+    &lt;/vbox&gt;</span>
<a href="#l2.107"></a><span id="l2.107" class="difflineplus">+    &lt;spacer flex=&quot;3&quot;/&gt;</span>
<a href="#l2.108"></a><span id="l2.108" class="difflineplus">+    &lt;label class=&quot;text-link&quot;</span>
<a href="#l2.109"></a><span id="l2.109" class="difflineplus">+           value=&quot;&amp;addDevice.dontHaveDevice.label;&quot;</span>
<a href="#l2.110"></a><span id="l2.110" class="difflineplus">+           onclick=&quot;gSyncSetup.manualSetup();&quot;/&gt;</span>
<a href="#l2.111"></a><span id="l2.111" class="difflineplus">+  &lt;/wizardpage&gt;</span>
<a href="#l2.112"></a><span id="l2.112" class="difflineplus">+</span>
<a href="#l2.113"></a><span id="l2.113" class="difflineplus">+  &lt;wizardpage id=&quot;existingAccount&quot;</span>
<a href="#l2.114"></a><span id="l2.114" class="difflineplus">+              label=&quot;&amp;setup.signInPage.title.label;&quot;</span>
<a href="#l2.115"></a><span id="l2.115">               onextra1=&quot;gSyncSetup.onSyncOptions();&quot;</span>
<a href="#l2.116"></a><span id="l2.116">               onpageshow=&quot;gSyncSetup.onPageShow();&quot;&gt;</span>
<a href="#l2.117"></a><span id="l2.117">     &lt;grid&gt;</span>
<a href="#l2.118"></a><span id="l2.118">       &lt;columns&gt;</span>
<a href="#l2.119"></a><span id="l2.119">         &lt;column/&gt;</span>
<a href="#l2.120"></a><span id="l2.120">         &lt;column class=&quot;inputColumn&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l2.121"></a><span id="l2.121">       &lt;/columns&gt;</span>
<a href="#l2.122"></a><span id="l2.122">       &lt;rows&gt;</span>
<a href="#l2.123"></a><span id="l2.123" class="difflineminus">-        &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l2.124"></a><span id="l2.124" class="difflineminus">-          &lt;label control=&quot;existingServerType&quot;</span>
<a href="#l2.125"></a><span id="l2.125" class="difflineminus">-                 value=&quot;&amp;server.label;&quot;/&gt;</span>
<a href="#l2.126"></a><span id="l2.126" class="difflineminus">-          &lt;menulist id=&quot;existingServerType&quot; oncommand=&quot;gSyncSetup.onServerChange();&quot;&gt;</span>
<a href="#l2.127"></a><span id="l2.127" class="difflineminus">-            &lt;menupopup&gt;</span>
<a href="#l2.128"></a><span id="l2.128" class="difflineminus">-              &lt;menuitem label=&quot;&amp;serverType.main.label;&quot;</span>
<a href="#l2.129"></a><span id="l2.129" class="difflineminus">-                        value=&quot;main&quot;/&gt;</span>
<a href="#l2.130"></a><span id="l2.130" class="difflineminus">-              &lt;menuitem label=&quot;&amp;serverType.custom.label;&quot;</span>
<a href="#l2.131"></a><span id="l2.131" class="difflineminus">-                        value=&quot;custom&quot;/&gt;</span>
<a href="#l2.132"></a><span id="l2.132" class="difflineminus">-            &lt;/menupopup&gt;</span>
<a href="#l2.133"></a><span id="l2.133" class="difflineminus">-          &lt;/menulist&gt;</span>
<a href="#l2.134"></a><span id="l2.134" class="difflineminus">-        &lt;/row&gt;</span>
<a href="#l2.135"></a><span id="l2.135" class="difflineminus">-        &lt;row id=&quot;existingServerRow&quot; hidden=&quot;true&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.136"></a><span id="l2.136" class="difflineminus">-          &lt;label id=&quot;existingServerURLLabel&quot;</span>
<a href="#l2.137"></a><span id="l2.137" class="difflineminus">-                 value=&quot;&amp;signIn.serverURL.label;&quot;</span>
<a href="#l2.138"></a><span id="l2.138" class="difflineminus">-                 accesskey=&quot;&amp;signIn.serverURL.accesskey;&quot;</span>
<a href="#l2.139"></a><span id="l2.139" class="difflineminus">-                 control=&quot;existingServerURL&quot;/&gt;</span>
<a href="#l2.140"></a><span id="l2.140" class="difflineminus">-          &lt;textbox id=&quot;existingServerURL&quot;</span>
<a href="#l2.141"></a><span id="l2.141" class="difflineminus">-                   onchange=&quot;gSyncSetup.checkFields(event);&quot;/&gt;</span>
<a href="#l2.142"></a><span id="l2.142" class="difflineminus">-        &lt;/row&gt;</span>
<a href="#l2.143"></a><span id="l2.143">         &lt;row id=&quot;existingAccountRow&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.144"></a><span id="l2.144">           &lt;label id=&quot;existingAccountLabel&quot;</span>
<a href="#l2.145"></a><span id="l2.145" class="difflineminus">-                 value=&quot;&amp;signIn.account.label;&quot;</span>
<a href="#l2.146"></a><span id="l2.146" class="difflineminus">-                 accesskey=&quot;&amp;signIn.account.accesskey;&quot;</span>
<a href="#l2.147"></a><span id="l2.147" class="difflineplus">+                 value=&quot;&amp;signIn.account2.label;&quot;</span>
<a href="#l2.148"></a><span id="l2.148" class="difflineplus">+                 accesskey=&quot;&amp;signIn.account2.accesskey;&quot;</span>
<a href="#l2.149"></a><span id="l2.149">                  control=&quot;existingAccountName&quot;/&gt;</span>
<a href="#l2.150"></a><span id="l2.150">           &lt;textbox id=&quot;existingAccountName&quot;</span>
<a href="#l2.151"></a><span id="l2.151">                    oninput=&quot;gSyncSetup.checkFields(event);&quot;</span>
<a href="#l2.152"></a><span id="l2.152">                    onchange=&quot;gSyncSetup.checkFields(event);&quot;/&gt;</span>
<a href="#l2.153"></a><span id="l2.153">         &lt;/row&gt;</span>
<a href="#l2.154"></a><span id="l2.154" class="difflineminus">-        &lt;row id=&quot;existingAccountFeedbackRow&quot; align=&quot;center&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l2.155"></a><span id="l2.155" class="difflineminus">-          &lt;spacer/&gt;</span>
<a href="#l2.156"></a><span id="l2.156" class="difflineminus">-          &lt;hbox&gt;</span>
<a href="#l2.157"></a><span id="l2.157" class="difflineminus">-            &lt;image class=&quot;statusIcon&quot;/&gt;</span>
<a href="#l2.158"></a><span id="l2.158" class="difflineminus">-            &lt;label class=&quot;status&quot; value=&quot; &quot;/&gt;</span>
<a href="#l2.159"></a><span id="l2.159" class="difflineminus">-          &lt;/hbox&gt;</span>
<a href="#l2.160"></a><span id="l2.160" class="difflineminus">-        &lt;/row&gt;</span>
<a href="#l2.161"></a><span id="l2.161">         &lt;row id=&quot;existingPasswordRow&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.162"></a><span id="l2.162">           &lt;label id=&quot;existingPasswordLabel&quot;</span>
<a href="#l2.163"></a><span id="l2.163">                  value=&quot;&amp;signIn.password.label;&quot;</span>
<a href="#l2.164"></a><span id="l2.164">                  accesskey=&quot;&amp;signIn.password.accesskey;&quot;</span>
<a href="#l2.165"></a><span id="l2.165">                  control=&quot;existingPassword&quot;/&gt;</span>
<a href="#l2.166"></a><span id="l2.166">           &lt;textbox id=&quot;existingPassword&quot;</span>
<a href="#l2.167"></a><span id="l2.167">                    type=&quot;password&quot;</span>
<a href="#l2.168"></a><span id="l2.168">                    onkeyup=&quot;gSyncSetup.checkFields(event);&quot;</span>
<a href="#l2.169"></a><span id="l2.169">                    onchange=&quot;gSyncSetup.checkFields(event);&quot;/&gt;</span>
<a href="#l2.170"></a><span id="l2.170">         &lt;/row&gt;</span>
<a href="#l2.171"></a><span id="l2.171">         &lt;row id=&quot;existingPasswordFeedbackRow&quot; align=&quot;center&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l2.172"></a><span id="l2.172" class="difflineminus">-          &lt;label class=&quot;text-link small&quot;</span>
<a href="#l2.173"></a><span id="l2.173" class="difflineminus">-                 value=&quot;&amp;resetPassword.label;&quot;</span>
<a href="#l2.174"></a><span id="l2.174" class="difflineminus">-                 onclick=&quot;gSyncUtils.resetPassword(); return false;&quot;/&gt;</span>
<a href="#l2.175"></a><span id="l2.175" class="difflineplus">+          &lt;spacer/&gt;</span>
<a href="#l2.176"></a><span id="l2.176">           &lt;hbox&gt;</span>
<a href="#l2.177"></a><span id="l2.177">             &lt;image class=&quot;statusIcon&quot;/&gt;</span>
<a href="#l2.178"></a><span id="l2.178">             &lt;label class=&quot;status&quot; value=&quot; &quot;/&gt;</span>
<a href="#l2.179"></a><span id="l2.179">           &lt;/hbox&gt;</span>
<a href="#l2.180"></a><span id="l2.180">         &lt;/row&gt;</span>
<a href="#l2.181"></a><span id="l2.181" class="difflineminus">-        &lt;row id=&quot;existingLoginFeedbackRow&quot;&gt;</span>
<a href="#l2.182"></a><span id="l2.182" class="difflineplus">+        &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l2.183"></a><span id="l2.183">           &lt;spacer/&gt;</span>
<a href="#l2.184"></a><span id="l2.184" class="difflineminus">-          &lt;hbox id=&quot;connect-throbber&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l2.185"></a><span id="l2.185" class="difflineminus">-            &lt;image/&gt;</span>
<a href="#l2.186"></a><span id="l2.186" class="difflineminus">-            &lt;label value=&quot;&amp;connecting.label;&quot;/&gt;</span>
<a href="#l2.187"></a><span id="l2.187" class="difflineminus">-        &lt;/hbox&gt;</span>
<a href="#l2.188"></a><span id="l2.188" class="difflineplus">+          &lt;label class=&quot;text-link&quot;</span>
<a href="#l2.189"></a><span id="l2.189" class="difflineplus">+                 value=&quot;&amp;resetPassword.label;&quot;</span>
<a href="#l2.190"></a><span id="l2.190" class="difflineplus">+                 onclick=&quot;gSyncUtils.resetPassword(); return false;&quot;/&gt;</span>
<a href="#l2.191"></a><span id="l2.191" class="difflineplus">+        &lt;/row&gt;</span>
<a href="#l2.192"></a><span id="l2.192" class="difflineplus">+        &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l2.193"></a><span id="l2.193" class="difflineplus">+          &lt;label control=&quot;existingServer&quot;</span>
<a href="#l2.194"></a><span id="l2.194" class="difflineplus">+                 accesskey=&quot;&amp;server.accesskey;&quot;</span>
<a href="#l2.195"></a><span id="l2.195" class="difflineplus">+                 value=&quot;&amp;server.label;&quot;/&gt;</span>
<a href="#l2.196"></a><span id="l2.196" class="difflineplus">+          &lt;menulist id=&quot;existingServer&quot;</span>
<a href="#l2.197"></a><span id="l2.197" class="difflineplus">+                    oncommand=&quot;gSyncSetup.onExistingServerCommand();&quot;</span>
<a href="#l2.198"></a><span id="l2.198" class="difflineplus">+                    oninput=&quot;gSyncSetup.onExistingServerInput();&quot;&gt;</span>
<a href="#l2.199"></a><span id="l2.199" class="difflineplus">+            &lt;menupopup&gt;</span>
<a href="#l2.200"></a><span id="l2.200" class="difflineplus">+              &lt;menuitem label=&quot;&amp;serverType.main.label;&quot;/&gt;</span>
<a href="#l2.201"></a><span id="l2.201" class="difflineplus">+              &lt;menuitem label=&quot;&amp;serverType.custom2.label;&quot;/&gt;</span>
<a href="#l2.202"></a><span id="l2.202" class="difflineplus">+            &lt;/menupopup&gt;</span>
<a href="#l2.203"></a><span id="l2.203" class="difflineplus">+          &lt;/menulist&gt;</span>
<a href="#l2.204"></a><span id="l2.204" class="difflineplus">+        &lt;/row&gt;</span>
<a href="#l2.205"></a><span id="l2.205" class="difflineplus">+        &lt;row id=&quot;existingServerFeedbackRow&quot; align=&quot;center&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l2.206"></a><span id="l2.206" class="difflineplus">+          &lt;spacer/&gt;</span>
<a href="#l2.207"></a><span id="l2.207" class="difflineplus">+          &lt;hbox&gt;</span>
<a href="#l2.208"></a><span id="l2.208" class="difflineplus">+            &lt;image class=&quot;statusIcon&quot;/&gt;</span>
<a href="#l2.209"></a><span id="l2.209" class="difflineplus">+            &lt;vbox&gt;</span>
<a href="#l2.210"></a><span id="l2.210" class="difflineplus">+              &lt;label class=&quot;status&quot; value=&quot; &quot;/&gt;</span>
<a href="#l2.211"></a><span id="l2.211" class="difflineplus">+            &lt;/vbox&gt;</span>
<a href="#l2.212"></a><span id="l2.212" class="difflineplus">+          &lt;/hbox&gt;</span>
<a href="#l2.213"></a><span id="l2.213">         &lt;/row&gt;</span>
<a href="#l2.214"></a><span id="l2.214">       &lt;/rows&gt;</span>
<a href="#l2.215"></a><span id="l2.215">     &lt;/grid&gt;</span>
<a href="#l2.216"></a><span id="l2.216" class="difflineminus">-  &lt;/wizardpage&gt;</span>
<a href="#l2.217"></a><span id="l2.217"> </span>
<a href="#l2.218"></a><span id="l2.218" class="difflineminus">-  &lt;wizardpage id=&quot;existingPassphraseEntry&quot;</span>
<a href="#l2.219"></a><span id="l2.219" class="difflineminus">-              label=&quot;&amp;setup.existingSyncKeyPage.title;&quot;</span>
<a href="#l2.220"></a><span id="l2.220" class="difflineminus">-              onextra1=&quot;gSyncSetup.onSyncOptions();&quot;</span>
<a href="#l2.221"></a><span id="l2.221" class="difflineminus">-              onpageshow=&quot;gSyncSetup.onPageShow();&quot;&gt;</span>
<a href="#l2.222"></a><span id="l2.222" class="difflineminus">-    &lt;description&gt;&amp;setup.existingSyncKeyPage.description;&lt;/description&gt;</span>
<a href="#l2.223"></a><span id="l2.223" class="difflineminus">-    &lt;textbox id=&quot;existingPassphrase&quot;</span>
<a href="#l2.224"></a><span id="l2.224" class="difflineminus">-             onkeyup=&quot;gSyncSetup.onPassphraseKeyUp(event);&quot;</span>
<a href="#l2.225"></a><span id="l2.225" class="difflineminus">-             onchange=&quot;gSyncSetup.checkFields();&quot;/&gt;</span>
<a href="#l2.226"></a><span id="l2.226" class="difflineminus">-    &lt;hbox id=&quot;passphrase-throbber&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l2.227"></a><span id="l2.227" class="difflineminus">-      &lt;image/&gt;</span>
<a href="#l2.228"></a><span id="l2.228" class="difflineminus">-      &lt;label value=&quot;&amp;verifying.label;&quot;/&gt;</span>
<a href="#l2.229"></a><span id="l2.229" class="difflineminus">-    &lt;/hbox&gt;</span>
<a href="#l2.230"></a><span id="l2.230" class="difflineminus">-    &lt;hbox align=&quot;left&quot; id=&quot;existingPassphraseFeedbackBox&quot;&gt;</span>
<a href="#l2.231"></a><span id="l2.231" class="difflineminus">-      &lt;spacer/&gt;</span>
<a href="#l2.232"></a><span id="l2.232" class="difflineminus">-      &lt;hbox&gt;</span>
<a href="#l2.233"></a><span id="l2.233" class="difflineminus">-        &lt;image class=&quot;statusIcon&quot;/&gt;</span>
<a href="#l2.234"></a><span id="l2.234" class="difflineminus">-        &lt;label class=&quot;status&quot; value=&quot; &quot;/&gt;</span>
<a href="#l2.235"></a><span id="l2.235" class="difflineplus">+    &lt;groupbox&gt;</span>
<a href="#l2.236"></a><span id="l2.236" class="difflineplus">+      &lt;label id=&quot;existingPassphraseLabel&quot;</span>
<a href="#l2.237"></a><span id="l2.237" class="difflineplus">+             value=&quot;&amp;signIn.syncKey.label;&quot;</span>
<a href="#l2.238"></a><span id="l2.238" class="difflineplus">+             accesskey=&quot;&amp;signIn.syncKey.accesskey;&quot;</span>
<a href="#l2.239"></a><span id="l2.239" class="difflineplus">+             control=&quot;existingPassphrase&quot;/&gt;</span>
<a href="#l2.240"></a><span id="l2.240" class="difflineplus">+      &lt;textbox id=&quot;existingPassphrase&quot;</span>
<a href="#l2.241"></a><span id="l2.241" class="difflineplus">+               oninput=&quot;gSyncSetup.checkFields();&quot;/&gt;</span>
<a href="#l2.242"></a><span id="l2.242" class="difflineplus">+      &lt;hbox id=&quot;login-throbber&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l2.243"></a><span id="l2.243" class="difflineplus">+        &lt;image/&gt;</span>
<a href="#l2.244"></a><span id="l2.244" class="difflineplus">+        &lt;label value=&quot;&amp;verifying.label;&quot;/&gt;</span>
<a href="#l2.245"></a><span id="l2.245">       &lt;/hbox&gt;</span>
<a href="#l2.246"></a><span id="l2.246" class="difflineminus">-    &lt;/hbox&gt;</span>
<a href="#l2.247"></a><span id="l2.247" class="difflineminus">-    &lt;vbox class=&quot;small&quot; id=&quot;passphraseHelpBox&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l2.248"></a><span id="l2.248" class="difflineminus">-      &lt;description class=&quot;small&quot;&gt;&amp;existingSyncKeyHelp.description;&lt;/description&gt;</span>
<a href="#l2.249"></a><span id="l2.249" class="difflineminus">-      &lt;label class=&quot;text-link small&quot;</span>
<a href="#l2.250"></a><span id="l2.250" class="difflineminus">-             value=&quot;&amp;lostSyncKey.label;&quot;</span>
<a href="#l2.251"></a><span id="l2.251" class="difflineminus">-             onclick=&quot;gSyncUtils.resetPassphrase(); return false;&quot;/&gt;</span>
<a href="#l2.252"></a><span id="l2.252" class="difflineplus">+      &lt;vbox align=&quot;left&quot; id=&quot;existingPassphraseFeedbackRow&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l2.253"></a><span id="l2.253" class="difflineplus">+        &lt;hbox&gt;</span>
<a href="#l2.254"></a><span id="l2.254" class="difflineplus">+          &lt;image class=&quot;statusIcon&quot;/&gt;</span>
<a href="#l2.255"></a><span id="l2.255" class="difflineplus">+          &lt;label class=&quot;status&quot; value=&quot; &quot;/&gt;</span>
<a href="#l2.256"></a><span id="l2.256" class="difflineplus">+        &lt;/hbox&gt;</span>
<a href="#l2.257"></a><span id="l2.257" class="difflineplus">+      &lt;/vbox&gt;</span>
<a href="#l2.258"></a><span id="l2.258" class="difflineplus">+    &lt;/groupbox&gt;</span>
<a href="#l2.259"></a><span id="l2.259" class="difflineplus">+    &lt;vbox id=&quot;passphraseHelpBox&quot;&gt;</span>
<a href="#l2.260"></a><span id="l2.260" class="difflineplus">+      &lt;description&gt;</span>
<a href="#l2.261"></a><span id="l2.261" class="difflineplus">+        &amp;existingSyncKey.description;</span>
<a href="#l2.262"></a><span id="l2.262" class="difflineplus">+        &lt;label class=&quot;text-link&quot;</span>
<a href="#l2.263"></a><span id="l2.263" class="difflineplus">+               value=&quot;&amp;addDevice.showMeHow.label;&quot;</span>
<a href="#l2.264"></a><span id="l2.264" class="difflineplus">+               href=&quot;https://services.mozilla.com/sync/help/manual-setup&quot;/&gt;</span>
<a href="#l2.265"></a><span id="l2.265" class="difflineplus">+        &lt;label class=&quot;text-link&quot;</span>
<a href="#l2.266"></a><span id="l2.266" class="difflineplus">+               value=&quot;&amp;resetSyncKey.label;&quot;</span>
<a href="#l2.267"></a><span id="l2.267" class="difflineplus">+               onclick=&quot;gSyncUtils.resetPassphrase(); return false;&quot;/&gt;</span>
<a href="#l2.268"></a><span id="l2.268" class="difflineplus">+      &lt;/description&gt;</span>
<a href="#l2.269"></a><span id="l2.269">     &lt;/vbox&gt;</span>
<a href="#l2.270"></a><span id="l2.270">   &lt;/wizardpage&gt;</span>
<a href="#l2.271"></a><span id="l2.271"> </span>
<a href="#l2.272"></a><span id="l2.272">   &lt;wizardpage id=&quot;syncOptionsPage&quot;</span>
<a href="#l2.273"></a><span id="l2.273">               label=&quot;&amp;setup.optionsPage.title;&quot;</span>
<a href="#l2.274"></a><span id="l2.274">               onpageshow=&quot;gSyncSetup.onPageShow();&quot;&gt;</span>
<a href="#l2.275"></a><span id="l2.275">     &lt;groupbox id=&quot;syncOptions&quot;&gt;</span>
<a href="#l2.276"></a><span id="l2.276">       &lt;grid&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/suite/locales/en-US/chrome/common/sync/syncSetup.dtd</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/common/sync/syncSetup.dtd</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,30 +1,32 @@</span>
<a href="#l3.4"></a><span id="l3.4"> &lt;!ENTITY accountSetupTitle.label    &quot;&amp;syncBrand.fullName.label; Setup&quot;&gt;</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6"> &lt;!-- First page of the wizard --&gt;</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> &lt;!ENTITY setup.pickSetupType.description &quot;Welcome, if you've never used &amp;syncBrand.fullName.label; before, you will need to create a new account.&quot;&gt;</span>
<a href="#l3.9"></a><span id="l3.9"> &lt;!ENTITY button.createNewAccount.label &quot;Create a New Account&quot;&gt;</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineminus">-&lt;!ENTITY button.haveAccount.label &quot;I Have a &amp;syncBrand.fullName.label; Account&quot;&gt;</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineplus">+&lt;!ENTITY setup.haveAccount.label &quot;I already have a &amp;syncBrand.fullName.label; account.&quot;&gt;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+&lt;!ENTITY button.connect.label &quot;Connect&quot;&gt;</span>
<a href="#l3.13"></a><span id="l3.13"> </span>
<a href="#l3.14"></a><span id="l3.14"> &lt;!ENTITY setup.choicePage.title.label     &quot;Have you used &amp;syncBrand.fullName.label; before?&quot;&gt;</span>
<a href="#l3.15"></a><span id="l3.15"> &lt;!ENTITY setup.choicePage.new.label       &quot;I've never used &amp;syncBrand.shortName.label; before&quot;&gt;</span>
<a href="#l3.16"></a><span id="l3.16"> &lt;!ENTITY setup.choicePage.existing.label  &quot;I'm already using &amp;syncBrand.shortName.label; on another computer&quot;&gt;</span>
<a href="#l3.17"></a><span id="l3.17"> </span>
<a href="#l3.18"></a><span id="l3.18"> &lt;!-- New Account AND Existing Account --&gt;</span>
<a href="#l3.19"></a><span id="l3.19"> &lt;!ENTITY server.label               &quot;Server&quot;&gt;</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+&lt;!ENTITY server.accesskey           &quot;S&quot;&gt;</span>
<a href="#l3.21"></a><span id="l3.21"> &lt;!ENTITY serverType.main.label      &quot;&amp;syncBrand.fullName.label; Server&quot;&gt;</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineminus">-&lt;!ENTITY serverType.custom.label    &quot;Use a custom server&quot;&gt;</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineminus">-&lt;!ENTITY signIn.account.label       &quot;Email Address / User Name&quot;&gt;</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineminus">-&lt;!ENTITY signIn.account.accesskey   &quot;E&quot;&gt;</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineplus">+&lt;!ENTITY serverType.custom2.label   &quot;Use a custom server&quot;&gt;</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+&lt;!ENTITY signIn.account2.label      &quot;Account&quot;&gt;</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineplus">+&lt;!ENTITY signIn.account2.accesskey  &quot;A&quot;&gt;</span>
<a href="#l3.28"></a><span id="l3.28"> &lt;!ENTITY signIn.password.label      &quot;Password&quot;&gt;</span>
<a href="#l3.29"></a><span id="l3.29"> &lt;!ENTITY signIn.password.accesskey  &quot;P&quot;&gt;</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-&lt;!ENTITY signIn.serverURL.label     &quot;Server URL&quot;&gt;</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-&lt;!ENTITY signIn.serverURL.accesskey &quot;S&quot;&gt;</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+&lt;!ENTITY signIn.syncKey.label       &quot;Sync Key&quot;&gt;</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+&lt;!ENTITY signIn.syncKey.accesskey   &quot;K&quot;&gt;</span>
<a href="#l3.34"></a><span id="l3.34"> </span>
<a href="#l3.35"></a><span id="l3.35"> &lt;!-- New Account Page 1: Basic Account Info --&gt;</span>
<a href="#l3.36"></a><span id="l3.36"> &lt;!ENTITY setup.newAccountDetailsPage.title.label &quot;Account Details&quot;&gt;</span>
<a href="#l3.37"></a><span id="l3.37"> &lt;!ENTITY setup.confirmPassword.label             &quot;Confirm Password&quot;&gt;</span>
<a href="#l3.38"></a><span id="l3.38"> &lt;!ENTITY setup.confirmPassword.accesskey         &quot;C&quot;&gt;</span>
<a href="#l3.39"></a><span id="l3.39"> &lt;!ENTITY setup.emailAddress.label                &quot;Email Address&quot;&gt;</span>
<a href="#l3.40"></a><span id="l3.40"> &lt;!ENTITY setup.emailAddress.accesskey            &quot;E&quot;&gt;</span>
<a href="#l3.41"></a><span id="l3.41"> &lt;!-- LOCALIZATION NOTE: tosAgree1, tosLink, tosAgree2, ppLink, tosAgree3 are</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineat">@@ -62,27 +64,22 @@</span>
<a href="#l3.43"></a><span id="l3.43"> &lt;!ENTITY addDevice.setup.enterCode.label    &quot;Then, enter this code:&quot;&gt;</span>
<a href="#l3.44"></a><span id="l3.44"> &lt;!ENTITY addDevice.dialog.description.label &quot;To activate your new device, go to &amp;syncBrand.shortName.label; Preferences/Options on the device and select &amp;#x0022;Connect.&amp;#x0022;&quot;&gt;</span>
<a href="#l3.45"></a><span id="l3.45"> &lt;!ENTITY addDevice.dialog.enterCode.label   &quot;Enter the code that the device provides:&quot;&gt;</span>
<a href="#l3.46"></a><span id="l3.46"> &lt;!ENTITY addDevice.dialog.tryAgain.label    &quot;Please try again.&quot;&gt;</span>
<a href="#l3.47"></a><span id="l3.47"> &lt;!ENTITY addDevice.dialog.successful.label  &quot;The device has been successfully added. The initial synchronization can take several minutes and will finish in the background.&quot;&gt;</span>
<a href="#l3.48"></a><span id="l3.48"> &lt;!ENTITY addDevice.dialog.syncKey.label     &quot;To activate your device you will need to enter your Sync Key. Please print or save this key and take it with you.&quot;&gt;</span>
<a href="#l3.49"></a><span id="l3.49"> &lt;!ENTITY addDevice.dialog.connected.label   &quot;Device Connected&quot;&gt;</span>
<a href="#l3.50"></a><span id="l3.50"> </span>
<a href="#l3.51"></a><span id="l3.51" class="difflineminus">-&lt;!-- Existing Account Page 1: Login --&gt;</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineminus">-&lt;!ENTITY setup.existingAccount.title.label &quot;Enter Account Information&quot;&gt;</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineplus">+&lt;!-- Existing Account Page 2: Manual Login --&gt;</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineplus">+&lt;!ENTITY setup.signInPage.title.label &quot;Sign In&quot;&gt;</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineplus">+&lt;!ENTITY existingSyncKey.description  &quot;You can get a copy of your Sync Key by going to &amp;syncBrand.shortName.label; Preferences/Options on your other device, and selecting &amp;#x0022;My Sync Key&amp;#x0022; under &amp;#x0022;Manage Account&amp;#x0022;.&quot;&gt;</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineplus">+&lt;!ENTITY verifying.label              &quot;Verifying&quot;&gt;</span>
<a href="#l3.57"></a><span id="l3.57"> &lt;!ENTITY resetPassword.label          &quot;Reset Password&quot;&gt;</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineminus">-&lt;!ENTITY connecting.label             &quot;Connecting&quot;&gt;</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineminus">-&lt;!-- Existing Account Page 2: Sync Key --&gt;</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineminus">-&lt;!ENTITY setup.existingSyncKeyPage.title &quot;Please Enter Your Sync Key&quot;&gt;</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineminus">-&lt;!ENTITY setup.existingSyncKeyPage.description &quot;The Sync Key was generated for you, or you entered your own, when you first signed up for &amp;syncBrand.fullName.label;. It is not the same as your password.&quot;&gt;</span>
<a href="#l3.63"></a><span id="l3.63" class="difflineminus">-&lt;!ENTITY existingSyncKeyHelp.description &quot;You can find your saved Sync Key by going to your other computer and checking the Saved Passwords under Security. If you still cannot get the correct Sync Key, you can choose to reset it, but you will lose any data stored on the server.&quot;&gt;</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineminus">-&lt;!ENTITY lostSyncKey.label            &quot;I have lost my Sync Key&quot;&gt;</span>
<a href="#l3.65"></a><span id="l3.65" class="difflineminus">-&lt;!ENTITY verifying.label              &quot;Verifying&quot;&gt;</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineplus">+&lt;!ENTITY resetSyncKey.label           &quot;I have lost my other device.&quot;&gt;</span>
<a href="#l3.67"></a><span id="l3.67"> </span>
<a href="#l3.68"></a><span id="l3.68"> &lt;!-- Sync Options --&gt;</span>
<a href="#l3.69"></a><span id="l3.69"> &lt;!ENTITY setup.optionsPage.title      &quot;Sync Options&quot;&gt;</span>
<a href="#l3.70"></a><span id="l3.70"> &lt;!ENTITY syncComputerName.label       &quot;Computer Name:&quot;&gt;</span>
<a href="#l3.71"></a><span id="l3.71"> &lt;!ENTITY syncComputerName.accesskey   &quot;C&quot;&gt;</span>
<a href="#l3.72"></a><span id="l3.72"> </span>
<a href="#l3.73"></a><span id="l3.73"> &lt;!ENTITY syncMy.label               &quot;Sync My&quot;&gt;</span>
<a href="#l3.74"></a><span id="l3.74"> &lt;!ENTITY engine.bookmarks.label     &quot;Bookmarks&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/suite/themes/classic/communicator/sync/syncSetup.css</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/suite/themes/classic/communicator/sync/syncSetup.css</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -52,18 +52,18 @@ wizardpage {</span>
<a href="#l4.4"></a><span id="l4.4"> </span>
<a href="#l4.5"></a><span id="l4.5"> .confirm {</span>
<a href="#l4.6"></a><span id="l4.6">   border: 1px solid black;</span>
<a href="#l4.7"></a><span id="l4.7">   padding: 1em;</span>
<a href="#l4.8"></a><span id="l4.8">   border-radius: 5px;</span>
<a href="#l4.9"></a><span id="l4.9"> }</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11"> /* Override the text-link style from global.css */</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-.text-link,</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-.text-link:focus {</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+description &gt; .text-link,</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+description &gt; .text-link:focus {</span>
<a href="#l4.16"></a><span id="l4.16">   margin: 0px;</span>
<a href="#l4.17"></a><span id="l4.17">   padding: 0px;</span>
<a href="#l4.18"></a><span id="l4.18"> }</span>
<a href="#l4.19"></a><span id="l4.19"> </span>
<a href="#l4.20"></a><span id="l4.20"> .success,</span>
<a href="#l4.21"></a><span id="l4.21"> .error {</span>
<a href="#l4.22"></a><span id="l4.22">   padding: 2px;</span>
<a href="#l4.23"></a><span id="l4.23">   border-radius: 2px;</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineat">@@ -96,18 +96,23 @@ wizardpage {</span>
<a href="#l4.25"></a><span id="l4.25"> .inputColumn {</span>
<a href="#l4.26"></a><span id="l4.26">   -moz-margin-end: 2px;</span>
<a href="#l4.27"></a><span id="l4.27"> }</span>
<a href="#l4.28"></a><span id="l4.28"> </span>
<a href="#l4.29"></a><span id="l4.29"> .recommended {</span>
<a href="#l4.30"></a><span id="l4.30">   font-weight: bold;</span>
<a href="#l4.31"></a><span id="l4.31"> }</span>
<a href="#l4.32"></a><span id="l4.32"> </span>
<a href="#l4.33"></a><span id="l4.33" class="difflineminus">-#connect-throbber image,</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineminus">-#passphrase-throbber image {</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+.pin {</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+  font-size: 18pt;</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+  text-align: center;</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+}</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+#add-device-throbber,</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+#login-throbber {</span>
<a href="#l4.42"></a><span id="l4.42">   list-style-image: url(&quot;chrome://global/skin/icons/loading_16.png&quot;);</span>
<a href="#l4.43"></a><span id="l4.43"> }</span>
<a href="#l4.44"></a><span id="l4.44"> </span>
<a href="#l4.45"></a><span id="l4.45"> #successPageIcon {</span>
<a href="#l4.46"></a><span id="l4.46">   /* TODO replace this with a 128px version (bug 591122) */</span>
<a href="#l4.47"></a><span id="l4.47">   list-style-image: url(&quot;chrome://communicator/skin/sync/sync-32.png&quot;);</span>
<a href="#l4.48"></a><span id="l4.48"> }</span>
<a href="#l4.49"></a><span id="l4.49"> </span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

