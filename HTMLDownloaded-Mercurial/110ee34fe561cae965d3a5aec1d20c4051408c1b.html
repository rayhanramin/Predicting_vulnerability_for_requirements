<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 28170:110ee34fe561cae965d3a5aec1d20c4051408c1b</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 110ee34fe561cae965d3a5aec1d20c4051408c1b" />
<meta property="og:url" content="/comm-central/rev/110ee34fe561cae965d3a5aec1d20c4051408c1b" />
<meta property="og:description" content="Bug 1557504 - remove [array] use in xpidl from calIItemBase.idl and calIAlarm.idl. r=pmorris" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 110ee34fe561cae965d3a5aec1d20c4051408c1b 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/110ee34fe561cae965d3a5aec1d20c4051408c1b">shortlog</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/110ee34fe561cae965d3a5aec1d20c4051408c1b">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b">files</a> |
changeset |
<a href="/comm-central/raw-rev/110ee34fe561cae965d3a5aec1d20c4051408c1b">raw</a>  | <a href="/comm-central/archive/110ee34fe561cae965d3a5aec1d20c4051408c1b.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1557504">Bug 1557504</a> - remove [array] use in xpidl from calIItemBase.idl and calIAlarm.idl. r=pmorris
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#75;&#104;&#117;&#115;&#104;&#105;&#108;&#32;&#77;&#105;&#115;&#116;&#114;&#121;&#32;&#60;&#107;&#104;&#117;&#115;&#104;&#105;&#108;&#51;&#50;&#52;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 14 Nov 2019 21:19:51 +0530</td></tr>

<tr>
 <td>changeset 28170</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/110ee34fe561cae965d3a5aec1d20c4051408c1b">110ee34fe561cae965d3a5aec1d20c4051408c1b</a></td>
</tr>



<tr>
<td>parent 28169</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/64e5700c2428333fb571e2477b7609badec9d83d">64e5700c2428333fb571e2477b7609badec9d83d</a>
</td>
</tr>

<tr>
<td>child 28171</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/bd0fd75f44381a6db63a95fce6ba61159b791228">bd0fd75f44381a6db63a95fce6ba61159b791228</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=110ee34fe561cae965d3a5aec1d20c4051408c1b">16686</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Thu, 14 Nov 2019 17:37:35 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@110ee34fe561 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=110ee34fe561cae965d3a5aec1d20c4051408c1b">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=110ee34fe561cae965d3a5aec1d20c4051408c1b&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=110ee34fe561cae965d3a5aec1d20c4051408c1b&newProject=comm-central&newRevision=4f748b7dc20dfb713f118f680cec8c2c8443862f&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=110ee34fe561cae965d3a5aec1d20c4051408c1b&newProject=comm-central&newRevision=4f748b7dc20dfb713f118f680cec8c2c8443862f&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=110ee34fe561cae965d3a5aec1d20c4051408c1b&newProject=comm-central&newRevision=4f748b7dc20dfb713f118f680cec8c2c8443862f&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28pmorris%29&revcount=50">pmorris</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1557504">1557504</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1557504">Bug 1557504</a> - remove [array] use in xpidl from calIItemBase.idl and calIAlarm.idl. r=pmorris</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/agenda-listbox-utils.js">calendar/base/content/agenda-listbox-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/agenda-listbox-utils.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/agenda-listbox-utils.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/agenda-listbox-utils.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/agenda-listbox-utils.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/agenda-listbox-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-base-view.js">calendar/base/content/calendar-base-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-base-view.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-base-view.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-base-view.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-base-view.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-base-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-clipboard.js">calendar/base/content/calendar-clipboard.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-clipboard.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-clipboard.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-clipboard.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-clipboard.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-clipboard.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-command-controller.js">calendar/base/content/calendar-command-controller.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-command-controller.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-command-controller.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-command-controller.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-command-controller.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-command-controller.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-dnd-listener.js">calendar/base/content/calendar-dnd-listener.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-dnd-listener.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-dnd-listener.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-dnd-listener.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-dnd-listener.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-dnd-listener.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-editable-item.js">calendar/base/content/calendar-editable-item.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-editable-item.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-editable-item.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-editable-item.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-editable-item.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-editable-item.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-item-editing.js">calendar/base/content/calendar-item-editing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-item-editing.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-item-editing.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-item-editing.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-item-editing.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-item-editing.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-multiday-base-view.js">calendar/base/content/calendar-multiday-base-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-multiday-base-view.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-multiday-base-view.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-multiday-base-view.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-multiday-base-view.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-multiday-base-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-tree-view.js">calendar/base/content/calendar-task-tree-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-tree-view.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-tree-view.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-tree-view.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-tree-view.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-tree-view.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-view.js">calendar/base/content/calendar-task-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-view.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-view.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-view.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-view.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-task-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-ui-utils.js">calendar/base/content/calendar-ui-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-ui-utils.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-ui-utils.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-ui-utils.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-ui-utils.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-ui-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-unifinder.js">calendar/base/content/calendar-unifinder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-unifinder.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-unifinder.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-unifinder.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-unifinder.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/calendar-unifinder.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-dialog-utils.js">calendar/base/content/dialogs/calendar-dialog-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-dialog-utils.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-dialog-utils.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-dialog-utils.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-dialog-utils.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-dialog-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">calendar/base/content/dialogs/calendar-event-dialog-reminder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-invitations-dialog.js">calendar/base/content/dialogs/calendar-invitations-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-invitations-dialog.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-invitations-dialog.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-invitations-dialog.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-invitations-dialog.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-invitations-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-summary-dialog.js">calendar/base/content/dialogs/calendar-summary-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-summary-dialog.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-summary-dialog.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-summary-dialog.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-summary-dialog.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/dialogs/calendar-summary-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/widgets/calendar-minimonth.js">calendar/base/content/widgets/calendar-minimonth.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/widgets/calendar-minimonth.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/widgets/calendar-minimonth.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/widgets/calendar-minimonth.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/widgets/calendar-minimonth.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/content/widgets/calendar-minimonth.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calItipUtils.jsm">calendar/base/modules/utils/calItipUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calItipUtils.jsm">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calItipUtils.jsm">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calItipUtils.jsm">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calItipUtils.jsm">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calItipUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calPrintUtils.jsm">calendar/base/modules/utils/calPrintUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calPrintUtils.jsm">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calPrintUtils.jsm">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calPrintUtils.jsm">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calPrintUtils.jsm">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calPrintUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calUnifinderUtils.jsm">calendar/base/modules/utils/calUnifinderUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calUnifinderUtils.jsm">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calUnifinderUtils.jsm">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calUnifinderUtils.jsm">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calUnifinderUtils.jsm">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/modules/utils/calUnifinderUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIAlarm.idl">calendar/base/public/calIAlarm.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIAlarm.idl">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIAlarm.idl">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIAlarm.idl">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIAlarm.idl">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIAlarm.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIItemBase.idl">calendar/base/public/calIItemBase.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIItemBase.idl">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIItemBase.idl">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIItemBase.idl">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIItemBase.idl">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/public/calIItemBase.idl">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarm.js">calendar/base/src/calAlarm.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarm.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarm.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarm.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarm.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarm.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarmService.js">calendar/base/src/calAlarmService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarmService.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarmService.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarmService.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarmService.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calAlarmService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calFilter.js">calendar/base/src/calFilter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calFilter.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calFilter.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calFilter.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calFilter.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calFilter.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItemBase.js">calendar/base/src/calItemBase.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItemBase.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItemBase.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItemBase.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItemBase.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItemBase.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItipItem.js">calendar/base/src/calItipItem.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItipItem.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItipItem.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItipItem.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItipItem.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/base/src/calItipItem.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/import-export/calOutlookCSVImportExport.js">calendar/import-export/calOutlookCSVImportExport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/import-export/calOutlookCSVImportExport.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/import-export/calOutlookCSVImportExport.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/import-export/calOutlookCSVImportExport.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/import-export/calOutlookCSVImportExport.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/import-export/calOutlookCSVImportExport.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/imip-bar.js">calendar/lightning/content/imip-bar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/imip-bar.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/imip-bar.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/imip-bar.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/imip-bar.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/imip-bar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/lightning-item-iframe.js">calendar/lightning/content/lightning-item-iframe.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/lightning-item-iframe.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/lightning-item-iframe.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/lightning-item-iframe.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/lightning-item-iframe.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/content/lightning-item-iframe.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/modules/ltnInvitationUtils.jsm">calendar/lightning/modules/ltnInvitationUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/modules/ltnInvitationUtils.jsm">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/modules/ltnInvitationUtils.jsm">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/modules/ltnInvitationUtils.jsm">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/modules/ltnInvitationUtils.jsm">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/lightning/modules/ltnInvitationUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/caldav/calDavCalendar.js">calendar/providers/caldav/calDavCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/caldav/calDavCalendar.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/caldav/calDavCalendar.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/caldav/calDavCalendar.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/caldav/calDavCalendar.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/caldav/calDavCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/storage/calStorageCalendar.js">calendar/providers/storage/calStorageCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/storage/calStorageCalendar.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/storage/calStorageCalendar.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/storage/calStorageCalendar.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/storage/calStorageCalendar.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/storage/calStorageCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/wcap/calWcapCalendarItems.js">calendar/providers/wcap/calWcapCalendarItems.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/wcap/calWcapCalendarItems.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/wcap/calWcapCalendarItems.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/wcap/calWcapCalendarItems.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/wcap/calWcapCalendarItems.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/providers/wcap/calWcapCalendarItems.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/resources/content/mouseoverPreviews.js">calendar/resources/content/mouseoverPreviews.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/resources/content/mouseoverPreviews.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/resources/content/mouseoverPreviews.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/resources/content/mouseoverPreviews.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/resources/content/mouseoverPreviews.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/resources/content/mouseoverPreviews.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarm.js">calendar/test/unit/test_alarm.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarm.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarm.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarm.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarm.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarm.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarmutils.js">calendar/test/unit/test_alarmutils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarmutils.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarmutils.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarmutils.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarmutils.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_alarmutils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_attendee.js">calendar/test/unit/test_attendee.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_attendee.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_attendee.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_attendee.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_attendee.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_attendee.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1199942.js">calendar/test/unit/test_bug1199942.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1199942.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1199942.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1199942.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1199942.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1199942.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1204255.js">calendar/test/unit/test_bug1204255.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1204255.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1204255.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1204255.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1204255.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1204255.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1209399.js">calendar/test/unit/test_bug1209399.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1209399.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1209399.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1209399.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1209399.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug1209399.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug494140.js">calendar/test/unit/test_bug494140.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug494140.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug494140.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug494140.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug494140.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_bug494140.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_items.js">calendar/test/unit/test_items.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_items.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_items.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_items.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_items.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_items.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_relation.js">calendar/test/unit/test_relation.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_relation.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_relation.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_relation.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_relation.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_relation.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_storage.js">calendar/test/unit/test_storage.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_storage.js">file</a> |
<a href="/comm-central/annotate/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_storage.js">annotate</a> |
<a href="/comm-central/diff/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_storage.js">diff</a> |
<a href="/comm-central/comparison/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_storage.js">comparison</a> |
<a href="/comm-central/log/110ee34fe561cae965d3a5aec1d20c4051408c1b/calendar/test/unit/test_storage.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/agenda-listbox-utils.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/agenda-listbox-utils.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -896,17 +896,17 @@ agendaListbox.calendarObserver.onAddItem</span>
<a href="#l1.4"></a><span id="l1.4">   setCurrentEvent();</span>
<a href="#l1.5"></a><span id="l1.5"> };</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7"> agendaListbox.calendarObserver.getOccurrencesBetween = function(aItem) {</span>
<a href="#l1.8"></a><span id="l1.8">   let occs = [];</span>
<a href="#l1.9"></a><span id="l1.9">   let start = this.agendaListbox.getStart();</span>
<a href="#l1.10"></a><span id="l1.10">   let end = this.agendaListbox.getEnd();</span>
<a href="#l1.11"></a><span id="l1.11">   if (start &amp;&amp; end) {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    occs = aItem.getOccurrencesBetween(start, end, {});</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    occs = aItem.getOccurrencesBetween(start, end);</span>
<a href="#l1.14"></a><span id="l1.14">   }</span>
<a href="#l1.15"></a><span id="l1.15">   return occs;</span>
<a href="#l1.16"></a><span id="l1.16"> };</span>
<a href="#l1.17"></a><span id="l1.17"> </span>
<a href="#l1.18"></a><span id="l1.18"> agendaListbox.calendarObserver.onDeleteItem = function(item, rebuildFlag) {</span>
<a href="#l1.19"></a><span id="l1.19">   this.onLocalDeleteItem(item, true);</span>
<a href="#l1.20"></a><span id="l1.20"> };</span>
<a href="#l1.21"></a><span id="l1.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/calendar-base-view.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/calendar-base-view.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -48,40 +48,32 @@</span>
<a href="#l2.4"></a><span id="l2.4">           (!item.entryDate &amp;&amp; !item.dueDate) ||</span>
<a href="#l2.5"></a><span id="l2.5">           !this.calView.mTasksInView ||</span>
<a href="#l2.6"></a><span id="l2.6">           (item.isCompleted &amp;&amp; !this.calView.mShowCompleted)</span>
<a href="#l2.7"></a><span id="l2.7">         ) {</span>
<a href="#l2.8"></a><span id="l2.8">           return;</span>
<a href="#l2.9"></a><span id="l2.9">         }</span>
<a href="#l2.10"></a><span id="l2.10">       }</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-      const occs = item.getOccurrencesBetween(</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-        this.calView.startDate,</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-        this.calView.queryEndDate,</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineminus">-        {}</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineminus">-      );</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+      const occs = item.getOccurrencesBetween(this.calView.startDate, this.calView.queryEndDate);</span>
<a href="#l2.18"></a><span id="l2.18">       for (const occ of occs) {</span>
<a href="#l2.19"></a><span id="l2.19">         if (cal.item.isToDo(occ)) {</span>
<a href="#l2.20"></a><span id="l2.20">           this.calView.doAddItem(occ.QueryInterface(Ci.calITodo));</span>
<a href="#l2.21"></a><span id="l2.21">         } else {</span>
<a href="#l2.22"></a><span id="l2.22">           this.calView.doAddItem(occ.QueryInterface(Ci.calIEvent));</span>
<a href="#l2.23"></a><span id="l2.23">         }</span>
<a href="#l2.24"></a><span id="l2.24">       }</span>
<a href="#l2.25"></a><span id="l2.25">     }</span>
<a href="#l2.26"></a><span id="l2.26"> </span>
<a href="#l2.27"></a><span id="l2.27">     onModifyItem(newItem, oldItem) {</span>
<a href="#l2.28"></a><span id="l2.28">       if (cal.item.isToDo(newItem) &amp;&amp; cal.item.isToDo(oldItem) &amp;&amp; !this.calView.mTasksInView) {</span>
<a href="#l2.29"></a><span id="l2.29">         return;</span>
<a href="#l2.30"></a><span id="l2.30">       }</span>
<a href="#l2.31"></a><span id="l2.31">       if (!cal.item.isToDo(oldItem) || oldItem.entryDate || oldItem.dueDate) {</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineminus">-        let occs = oldItem.getOccurrencesBetween(</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineminus">-          this.calView.startDate,</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineminus">-          this.calView.queryEndDate,</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineminus">-          {}</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineminus">-        );</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineplus">+        let occs = oldItem.getOccurrencesBetween(this.calView.startDate, this.calView.queryEndDate);</span>
<a href="#l2.38"></a><span id="l2.38">         for (const occ of occs) {</span>
<a href="#l2.39"></a><span id="l2.39">           if (cal.item.isToDo(occ)) {</span>
<a href="#l2.40"></a><span id="l2.40">             this.calView.doDeleteItem(occ.QueryInterface(Ci.calITodo));</span>
<a href="#l2.41"></a><span id="l2.41">           } else {</span>
<a href="#l2.42"></a><span id="l2.42">             this.calView.doDeleteItem(occ.QueryInterface(Ci.calIEvent));</span>
<a href="#l2.43"></a><span id="l2.43">           }</span>
<a href="#l2.44"></a><span id="l2.44">         }</span>
<a href="#l2.45"></a><span id="l2.45">       }</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineat">@@ -89,21 +81,17 @@</span>
<a href="#l2.47"></a><span id="l2.47">         if ((!newItem.entryDate &amp;&amp; !newItem.dueDate) || !this.calView.mTasksInView) {</span>
<a href="#l2.48"></a><span id="l2.48">           return;</span>
<a href="#l2.49"></a><span id="l2.49">         }</span>
<a href="#l2.50"></a><span id="l2.50">         if (newItem.isCompleted &amp;&amp; !this.calView.mShowCompleted) {</span>
<a href="#l2.51"></a><span id="l2.51">           return;</span>
<a href="#l2.52"></a><span id="l2.52">         }</span>
<a href="#l2.53"></a><span id="l2.53">       }</span>
<a href="#l2.54"></a><span id="l2.54"> </span>
<a href="#l2.55"></a><span id="l2.55" class="difflineminus">-      let occs = newItem.getOccurrencesBetween(</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineminus">-        this.calView.startDate,</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineminus">-        this.calView.queryEndDate,</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineminus">-        {}</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineminus">-      );</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineplus">+      let occs = newItem.getOccurrencesBetween(this.calView.startDate, this.calView.queryEndDate);</span>
<a href="#l2.61"></a><span id="l2.61">       for (const occ of occs) {</span>
<a href="#l2.62"></a><span id="l2.62">         if (cal.item.isToDo(occ)) {</span>
<a href="#l2.63"></a><span id="l2.63">           this.calView.doAddItem(occ.QueryInterface(Ci.calITodo));</span>
<a href="#l2.64"></a><span id="l2.64">         } else {</span>
<a href="#l2.65"></a><span id="l2.65">           this.calView.doAddItem(occ.QueryInterface(Ci.calIEvent));</span>
<a href="#l2.66"></a><span id="l2.66">         }</span>
<a href="#l2.67"></a><span id="l2.67">       }</span>
<a href="#l2.68"></a><span id="l2.68">     }</span>
<a href="#l2.69"></a><span id="l2.69" class="difflineat">@@ -116,21 +104,17 @@</span>
<a href="#l2.70"></a><span id="l2.70">         if (!item.entryDate &amp;&amp; !item.dueDate) {</span>
<a href="#l2.71"></a><span id="l2.71">           return;</span>
<a href="#l2.72"></a><span id="l2.72">         }</span>
<a href="#l2.73"></a><span id="l2.73">         if (item.isCompleted &amp;&amp; !this.calView.mShowCompleted) {</span>
<a href="#l2.74"></a><span id="l2.74">           return;</span>
<a href="#l2.75"></a><span id="l2.75">         }</span>
<a href="#l2.76"></a><span id="l2.76">       }</span>
<a href="#l2.77"></a><span id="l2.77"> </span>
<a href="#l2.78"></a><span id="l2.78" class="difflineminus">-      const occs = item.getOccurrencesBetween(</span>
<a href="#l2.79"></a><span id="l2.79" class="difflineminus">-        this.calView.startDate,</span>
<a href="#l2.80"></a><span id="l2.80" class="difflineminus">-        this.calView.queryEndDate,</span>
<a href="#l2.81"></a><span id="l2.81" class="difflineminus">-        {}</span>
<a href="#l2.82"></a><span id="l2.82" class="difflineminus">-      );</span>
<a href="#l2.83"></a><span id="l2.83" class="difflineplus">+      const occs = item.getOccurrencesBetween(this.calView.startDate, this.calView.queryEndDate);</span>
<a href="#l2.84"></a><span id="l2.84">       for (const occ of occs) {</span>
<a href="#l2.85"></a><span id="l2.85">         if (cal.item.isToDo(occ)) {</span>
<a href="#l2.86"></a><span id="l2.86">           this.calView.doDeleteItem(occ.QueryInterface(Ci.calITodo));</span>
<a href="#l2.87"></a><span id="l2.87">         } else {</span>
<a href="#l2.88"></a><span id="l2.88">           this.calView.doDeleteItem(occ.QueryInterface(Ci.calIEvent));</span>
<a href="#l2.89"></a><span id="l2.89">         }</span>
<a href="#l2.90"></a><span id="l2.90">       }</span>
<a href="#l2.91"></a><span id="l2.91">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/calendar-clipboard.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/calendar-clipboard.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -204,17 +204,17 @@ function pasteFromClipboard() {</span>
<a href="#l3.4"></a><span id="l3.4">         earliestDate.isDate = true;</span>
<a href="#l3.5"></a><span id="l3.5">         offset = firstDate.subtractDate(earliestDate);</span>
<a href="#l3.6"></a><span id="l3.6">         let deltaDST = firstDate.timezoneOffset - earliestDate.timezoneOffset;</span>
<a href="#l3.7"></a><span id="l3.7">         offset.inSeconds += deltaDST;</span>
<a href="#l3.8"></a><span id="l3.8">       }</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10">       // we only will need to ask whether to send notifications, if there</span>
<a href="#l3.11"></a><span id="l3.11">       // are attendees at all</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-      let withAttendees = items.filter(aItem =&gt; aItem.getAttendees({}).length &gt; 0);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+      let withAttendees = items.filter(aItem =&gt; aItem.getAttendees().length &gt; 0);</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15">       let notify = Ci.calIItipItem.USER;</span>
<a href="#l3.16"></a><span id="l3.16">       let destCal = null;</span>
<a href="#l3.17"></a><span id="l3.17">       if (Services.prefs.getBoolPref(&quot;calendar.paste.intoSelectedCalendar&quot;, false)) {</span>
<a href="#l3.18"></a><span id="l3.18">         destCal = getSelectedCalendar();</span>
<a href="#l3.19"></a><span id="l3.19">       } else {</span>
<a href="#l3.20"></a><span id="l3.20">         let pasteText = &quot;paste&quot;;</span>
<a href="#l3.21"></a><span id="l3.21">         if (withAttendees.length) {</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -290,17 +290,17 @@ function pasteFromClipboard() {</span>
<a href="#l3.23"></a><span id="l3.23">         // Set new UID to allow multiple paste actions of the same</span>
<a href="#l3.24"></a><span id="l3.24">         // clipboard content.</span>
<a href="#l3.25"></a><span id="l3.25">         newItem.id = cal.getUUID();</span>
<a href="#l3.26"></a><span id="l3.26">         if (offset) {</span>
<a href="#l3.27"></a><span id="l3.27">           cal.item.shiftOffset(newItem, offset);</span>
<a href="#l3.28"></a><span id="l3.28">         }</span>
<a href="#l3.29"></a><span id="l3.29"> </span>
<a href="#l3.30"></a><span id="l3.30">         let extResp = { responseMode: Ci.calIItipItem.NONE };</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-        if (item.getAttendees({}).length &gt; 0) {</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+        if (item.getAttendees().length &gt; 0) {</span>
<a href="#l3.33"></a><span id="l3.33">           extResp.responseMode = notify;</span>
<a href="#l3.34"></a><span id="l3.34">         }</span>
<a href="#l3.35"></a><span id="l3.35"> </span>
<a href="#l3.36"></a><span id="l3.36">         doTransaction(&quot;add&quot;, newItem, destCal, null, null, extResp);</span>
<a href="#l3.37"></a><span id="l3.37">       }</span>
<a href="#l3.38"></a><span id="l3.38">       endBatchTransaction();</span>
<a href="#l3.39"></a><span id="l3.39">       break;</span>
<a href="#l3.40"></a><span id="l3.40">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-command-controller.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-command-controller.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -505,17 +505,17 @@ var calendarController = {</span>
<a href="#l4.4"></a><span id="l4.4">         }</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6">         if (cal.itip.isInvitation(item)) {</span>
<a href="#l4.7"></a><span id="l4.7">           selected_events_invitation++;</span>
<a href="#l4.8"></a><span id="l4.8">         } else if (item.organizer) {</span>
<a href="#l4.9"></a><span id="l4.9">           // If we are the organizer and there are attendees, then</span>
<a href="#l4.10"></a><span id="l4.10">           // this is likely also an invitation.</span>
<a href="#l4.11"></a><span id="l4.11">           let calOrgId = item.calendar.getProperty(&quot;organizerId&quot;);</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-          if (item.organizer.id == calOrgId &amp;&amp; item.getAttendees({}).length) {</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+          if (item.organizer.id == calOrgId &amp;&amp; item.getAttendees().length) {</span>
<a href="#l4.14"></a><span id="l4.14">             selected_events_invitation++;</span>
<a href="#l4.15"></a><span id="l4.15">           }</span>
<a href="#l4.16"></a><span id="l4.16">         }</span>
<a href="#l4.17"></a><span id="l4.17">       }</span>
<a href="#l4.18"></a><span id="l4.18">     }</span>
<a href="#l4.19"></a><span id="l4.19"> </span>
<a href="#l4.20"></a><span id="l4.20">     calendarController.selected_events_readonly = selected_events_readonly == selLength;</span>
<a href="#l4.21"></a><span id="l4.21"> </span>
<a href="#l4.22"></a><span id="l4.22" class="difflineat">@@ -646,17 +646,17 @@ var calendarController = {</span>
<a href="#l4.23"></a><span id="l4.23"> </span>
<a href="#l4.24"></a><span id="l4.24">     for (let item of selectedTasks) {</span>
<a href="#l4.25"></a><span id="l4.25">       if (cal.itip.isInvitation(item)) {</span>
<a href="#l4.26"></a><span id="l4.26">         selected_tasks_invitation++;</span>
<a href="#l4.27"></a><span id="l4.27">       } else if (item.organizer) {</span>
<a href="#l4.28"></a><span id="l4.28">         // If we are the organizer and there are attendees, then</span>
<a href="#l4.29"></a><span id="l4.29">         // this is likely also an invitation.</span>
<a href="#l4.30"></a><span id="l4.30">         let calOrgId = item.calendar.getProperty(&quot;organizerId&quot;);</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-        if (item.organizer.id == calOrgId &amp;&amp; item.getAttendees({}).length) {</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+        if (item.organizer.id == calOrgId &amp;&amp; item.getAttendees().length) {</span>
<a href="#l4.33"></a><span id="l4.33">           selected_tasks_invitation++;</span>
<a href="#l4.34"></a><span id="l4.34">         }</span>
<a href="#l4.35"></a><span id="l4.35">       }</span>
<a href="#l4.36"></a><span id="l4.36">     }</span>
<a href="#l4.37"></a><span id="l4.37"> </span>
<a href="#l4.38"></a><span id="l4.38">     return selectedTasks.length == selected_tasks_invitation;</span>
<a href="#l4.39"></a><span id="l4.39">   },</span>
<a href="#l4.40"></a><span id="l4.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/calendar-dnd-listener.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/calendar-dnd-listener.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -65,24 +65,24 @@ var itemConversion = {</span>
<a href="#l5.4"></a><span id="l5.4">   copyItemBase: function(aItem, aTarget) {</span>
<a href="#l5.5"></a><span id="l5.5">     const copyProps = [&quot;SUMMARY&quot;, &quot;LOCATION&quot;, &quot;DESCRIPTION&quot;, &quot;URL&quot;, &quot;CLASS&quot;, &quot;PRIORITY&quot;];</span>
<a href="#l5.6"></a><span id="l5.6"> </span>
<a href="#l5.7"></a><span id="l5.7">     for (let prop of copyProps) {</span>
<a href="#l5.8"></a><span id="l5.8">       aTarget.setProperty(prop, aItem.getProperty(prop));</span>
<a href="#l5.9"></a><span id="l5.9">     }</span>
<a href="#l5.10"></a><span id="l5.10"> </span>
<a href="#l5.11"></a><span id="l5.11">     // Attendees</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-    let attendees = aItem.getAttendees({});</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+    let attendees = aItem.getAttendees();</span>
<a href="#l5.14"></a><span id="l5.14">     for (let attendee of attendees) {</span>
<a href="#l5.15"></a><span id="l5.15">       aTarget.addAttendee(attendee.clone());</span>
<a href="#l5.16"></a><span id="l5.16">     }</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18">     // Categories</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineminus">-    let categories = aItem.getCategories({});</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineminus">-    aTarget.setCategories(categories.length, categories);</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+    let categories = aItem.getCategories();</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+    aTarget.setCategories(categories);</span>
<a href="#l5.23"></a><span id="l5.23"> </span>
<a href="#l5.24"></a><span id="l5.24">     // Organizer</span>
<a href="#l5.25"></a><span id="l5.25">     aTarget.organizer = aItem.organizer ? aItem.organizer.clone() : null;</span>
<a href="#l5.26"></a><span id="l5.26"> </span>
<a href="#l5.27"></a><span id="l5.27">     // Calendar</span>
<a href="#l5.28"></a><span id="l5.28">     aTarget.calendar = getSelectedCalendar();</span>
<a href="#l5.29"></a><span id="l5.29"> </span>
<a href="#l5.30"></a><span id="l5.30">     // Recurrence</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineat">@@ -106,17 +106,17 @@ var itemConversion = {</span>
<a href="#l5.32"></a><span id="l5.32"> </span>
<a href="#l5.33"></a><span id="l5.33">     // Dates and alarms</span>
<a href="#l5.34"></a><span id="l5.34">     if (!aEvent.startDate.isDate &amp;&amp; !aEvent.endDate.isDate) {</span>
<a href="#l5.35"></a><span id="l5.35">       // Dates</span>
<a href="#l5.36"></a><span id="l5.36">       item.entryDate = aEvent.startDate.clone();</span>
<a href="#l5.37"></a><span id="l5.37">       item.dueDate = aEvent.endDate.clone();</span>
<a href="#l5.38"></a><span id="l5.38"> </span>
<a href="#l5.39"></a><span id="l5.39">       // Alarms</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineminus">-      for (let alarm of aEvent.getAlarms({})) {</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+      for (let alarm of aEvent.getAlarms()) {</span>
<a href="#l5.42"></a><span id="l5.42">         item.addAlarm(alarm.clone());</span>
<a href="#l5.43"></a><span id="l5.43">       }</span>
<a href="#l5.44"></a><span id="l5.44">       item.alarmLastAck = aEvent.alarmLastAck ? aEvent.alarmLastAck.clone() : null;</span>
<a href="#l5.45"></a><span id="l5.45">     }</span>
<a href="#l5.46"></a><span id="l5.46"> </span>
<a href="#l5.47"></a><span id="l5.47">     // Map Status values</span>
<a href="#l5.48"></a><span id="l5.48">     let statusMap = {</span>
<a href="#l5.49"></a><span id="l5.49">       TENTATIVE: &quot;NEEDS-ACTION&quot;,</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineat">@@ -157,17 +157,17 @@ var itemConversion = {</span>
<a href="#l5.51"></a><span id="l5.51">     if (!item.endDate) {</span>
<a href="#l5.52"></a><span id="l5.52">       // Make the event be the default event length if no due date was</span>
<a href="#l5.53"></a><span id="l5.53">       // specified.</span>
<a href="#l5.54"></a><span id="l5.54">       item.endDate = item.startDate.clone();</span>
<a href="#l5.55"></a><span id="l5.55">       item.endDate.minute += Services.prefs.getIntPref(&quot;calendar.event.defaultlength&quot;, 60);</span>
<a href="#l5.56"></a><span id="l5.56">     }</span>
<a href="#l5.57"></a><span id="l5.57"> </span>
<a href="#l5.58"></a><span id="l5.58">     // Alarms</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineminus">-    for (let alarm of aTask.getAlarms({})) {</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineplus">+    for (let alarm of aTask.getAlarms()) {</span>
<a href="#l5.61"></a><span id="l5.61">       item.addAlarm(alarm.clone());</span>
<a href="#l5.62"></a><span id="l5.62">     }</span>
<a href="#l5.63"></a><span id="l5.63">     item.alarmLastAck = aTask.alarmLastAck ? aTask.alarmLastAck.clone() : null;</span>
<a href="#l5.64"></a><span id="l5.64"> </span>
<a href="#l5.65"></a><span id="l5.65">     // Map Status values</span>
<a href="#l5.66"></a><span id="l5.66">     let statusMap = {</span>
<a href="#l5.67"></a><span id="l5.67">       &quot;NEEDS-ACTION&quot;: &quot;TENTATIVE&quot;,</span>
<a href="#l5.68"></a><span id="l5.68">       COMPLETED: &quot;CONFIRMED&quot;,</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineat">@@ -403,17 +403,17 @@ calMailButtonDNDObserver.prototype = {</span>
<a href="#l5.70"></a><span id="l5.70">    * on the 'mail mode'-button.</span>
<a href="#l5.71"></a><span id="l5.71">    *</span>
<a href="#l5.72"></a><span id="l5.72">    * @param aItems        An array of items to handle.</span>
<a href="#l5.73"></a><span id="l5.73">    */</span>
<a href="#l5.74"></a><span id="l5.74">   onDropItems: function(aItems) {</span>
<a href="#l5.75"></a><span id="l5.75">     if (aItems &amp;&amp; aItems.length &gt; 0) {</span>
<a href="#l5.76"></a><span id="l5.76">       let item = aItems[0];</span>
<a href="#l5.77"></a><span id="l5.77">       let identity = item.calendar.getProperty(&quot;imip.identity&quot;);</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineminus">-      let parties = item.getAttendees({});</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineplus">+      let parties = item.getAttendees();</span>
<a href="#l5.80"></a><span id="l5.80">       if (item.organizer) {</span>
<a href="#l5.81"></a><span id="l5.81">         parties.push(item.organizer);</span>
<a href="#l5.82"></a><span id="l5.82">       }</span>
<a href="#l5.83"></a><span id="l5.83">       if (identity) {</span>
<a href="#l5.84"></a><span id="l5.84">         // if no identity is defined, the composer will fall back to</span>
<a href="#l5.85"></a><span id="l5.85">         // whatever seems suitable - in this case we don't try to remove</span>
<a href="#l5.86"></a><span id="l5.86">         // the sender from the recipient list</span>
<a href="#l5.87"></a><span id="l5.87">         identity = identity.QueryInterface(Ci.nsIMsgIdentity);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/calendar-editable-item.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/calendar-editable-item.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -293,26 +293,26 @@</span>
<a href="#l6.4"></a><span id="l6.4">       setBooleanAttribute(locationLabel, &quot;hidden&quot;, !showLocation || !location);</span>
<a href="#l6.5"></a><span id="l6.5">     }</span>
<a href="#l6.6"></a><span id="l6.6"> </span>
<a href="#l6.7"></a><span id="l6.7">     setCSSClasses() {</span>
<a href="#l6.8"></a><span id="l6.8">       let item = this.mOccurrence;</span>
<a href="#l6.9"></a><span id="l6.9">       let cssSafeId = cal.view.formatStringForCSSRule(item.calendar.id);</span>
<a href="#l6.10"></a><span id="l6.10">       this.style.setProperty(&quot;--item-backcolor&quot;, `var(--calendar-${cssSafeId}-backcolor)`);</span>
<a href="#l6.11"></a><span id="l6.11">       this.style.setProperty(&quot;--item-forecolor&quot;, `var(--calendar-${cssSafeId}-forecolor)`);</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-      let categoriesArray = item.getCategories({});</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+      let categoriesArray = item.getCategories();</span>
<a href="#l6.14"></a><span id="l6.14">       if (categoriesArray.length &gt; 0) {</span>
<a href="#l6.15"></a><span id="l6.15">         let cssClassesArray = categoriesArray.map(cal.view.formatStringForCSSRule);</span>
<a href="#l6.16"></a><span id="l6.16">         this.setAttribute(&quot;categories&quot;, cssClassesArray.join(&quot; &quot;));</span>
<a href="#l6.17"></a><span id="l6.17">         let categoriesBox = this.querySelector(&quot;.calendar-category-box&quot;);</span>
<a href="#l6.18"></a><span id="l6.18">         categoriesBox.style.backgroundColor = `var(--category-${cssClassesArray[0]}-color)`;</span>
<a href="#l6.19"></a><span id="l6.19">       }</span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21">       // Add alarm icons as needed.</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineminus">-      let alarms = item.getAlarms({});</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+      let alarms = item.getAlarms();</span>
<a href="#l6.24"></a><span id="l6.24">       if (alarms.length &amp;&amp; Services.prefs.getBoolPref(&quot;calendar.alarms.indicator.show&quot;, true)) {</span>
<a href="#l6.25"></a><span id="l6.25">         let iconsBox = this.querySelector(&quot;.alarm-icons-box&quot;);</span>
<a href="#l6.26"></a><span id="l6.26">         cal.alarms.addReminderImages(iconsBox, alarms);</span>
<a href="#l6.27"></a><span id="l6.27"> </span>
<a href="#l6.28"></a><span id="l6.28">         // Set suppressed status on the icons box.</span>
<a href="#l6.29"></a><span id="l6.29">         setElementValue(</span>
<a href="#l6.30"></a><span id="l6.30">           iconsBox,</span>
<a href="#l6.31"></a><span id="l6.31">           item.calendar.getProperty(&quot;suppressAlarms&quot;) || false,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/calendar-item-editing.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/calendar-item-editing.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -760,17 +760,17 @@ function setContextPartstat(aTarget, aIt</span>
<a href="#l7.4"></a><span id="l7.4">    * @param   {calEvent|calTodo}  aItem  The calendar item to inspect</span>
<a href="#l7.5"></a><span id="l7.5">    * @returns {?calIAttendee}            An calIAttendee object or null if no</span>
<a href="#l7.6"></a><span id="l7.6">    *                                       participant was detected</span>
<a href="#l7.7"></a><span id="l7.7">    */</span>
<a href="#l7.8"></a><span id="l7.8">   function getParticipant(aItem) {</span>
<a href="#l7.9"></a><span id="l7.9">     let party = null;</span>
<a href="#l7.10"></a><span id="l7.10">     if (cal.itip.isInvitation(aItem)) {</span>
<a href="#l7.11"></a><span id="l7.11">       party = cal.itip.getInvitedAttendee(aItem);</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-    } else if (aItem.organizer &amp;&amp; aItem.getAttendees({}).length) {</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+    } else if (aItem.organizer &amp;&amp; aItem.getAttendees().length) {</span>
<a href="#l7.14"></a><span id="l7.14">       let calOrgId = aItem.calendar.getProperty(&quot;organizerId&quot;);</span>
<a href="#l7.15"></a><span id="l7.15">       if (calOrgId.toLowerCase() == aItem.organizer.id.toLowerCase()) {</span>
<a href="#l7.16"></a><span id="l7.16">         party = aItem.organizer;</span>
<a href="#l7.17"></a><span id="l7.17">       }</span>
<a href="#l7.18"></a><span id="l7.18">     }</span>
<a href="#l7.19"></a><span id="l7.19">     return party;</span>
<a href="#l7.20"></a><span id="l7.20">   }</span>
<a href="#l7.21"></a><span id="l7.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-base-view.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-base-view.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -903,17 +903,17 @@</span>
<a href="#l8.4"></a><span id="l8.4"> </span>
<a href="#l8.5"></a><span id="l8.5">       for (const item of this.mSelectedItems) {</span>
<a href="#l8.6"></a><span id="l8.6">         const startDateProperty = cal.dtz.startDateProp(item);</span>
<a href="#l8.7"></a><span id="l8.7">         const endDateProperty = cal.dtz.endDateProp(item);</span>
<a href="#l8.8"></a><span id="l8.8"> </span>
<a href="#l8.9"></a><span id="l8.9">         let occs = [];</span>
<a href="#l8.10"></a><span id="l8.10">         if (item.recurrenceInfo) {</span>
<a href="#l8.11"></a><span id="l8.11">           // If selected a parent item, show occurrence(s) in view range.</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-          occs = item.getOccurrencesBetween(this.startDate, this.queryEndDate, {}, 0);</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+          occs = item.getOccurrencesBetween(this.startDate, this.queryEndDate);</span>
<a href="#l8.14"></a><span id="l8.14">         } else {</span>
<a href="#l8.15"></a><span id="l8.15">           occs = [item];</span>
<a href="#l8.16"></a><span id="l8.16">         }</span>
<a href="#l8.17"></a><span id="l8.17"> </span>
<a href="#l8.18"></a><span id="l8.18">         for (const occ of occs) {</span>
<a href="#l8.19"></a><span id="l8.19">           let occStart = occ[startDateProperty];</span>
<a href="#l8.20"></a><span id="l8.20">           let occEnd = occ[endDateProperty];</span>
<a href="#l8.21"></a><span id="l8.21">           // Must have at least one of start or end.</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineat">@@ -1002,17 +1002,17 @@</span>
<a href="#l8.23"></a><span id="l8.23">      * Return all the occurrences of a given item that are currently displayed in the view.</span>
<a href="#l8.24"></a><span id="l8.24">      *</span>
<a href="#l8.25"></a><span id="l8.25">      * @param {calIItemBase} item    A calendar item.</span>
<a href="#l8.26"></a><span id="l8.26">      * @return {calIItemBase[]}      An array of occurrences.</span>
<a href="#l8.27"></a><span id="l8.27">      */</span>
<a href="#l8.28"></a><span id="l8.28">     getItemOccurrencesInView(item) {</span>
<a href="#l8.29"></a><span id="l8.29">       if (item.recurrenceInfo &amp;&amp; item.recurrenceStartDate) {</span>
<a href="#l8.30"></a><span id="l8.30">         // If a parent item is selected, show occurrence(s) in view range.</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-        return item.getOccurrencesBetween(this.startDate, this.queryEndDate, {}, 0);</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineplus">+        return item.getOccurrencesBetween(this.startDate, this.queryEndDate);</span>
<a href="#l8.33"></a><span id="l8.33">       } else if (item.recurrenceStartDate) {</span>
<a href="#l8.34"></a><span id="l8.34">         return [item];</span>
<a href="#l8.35"></a><span id="l8.35">       }</span>
<a href="#l8.36"></a><span id="l8.36">       // Undated todo.</span>
<a href="#l8.37"></a><span id="l8.37">       return [];</span>
<a href="#l8.38"></a><span id="l8.38">     }</span>
<a href="#l8.39"></a><span id="l8.39"> </span>
<a href="#l8.40"></a><span id="l8.40">     /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/content/calendar-task-tree-view.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-tree-view.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -237,22 +237,22 @@ class CalendarTaskTreeView {</span>
<a href="#l9.4"></a><span id="l9.4">     properties.push(&quot;calendarid-&quot; + cal.view.formatStringForCSSRule(item.calendar.id));</span>
<a href="#l9.5"></a><span id="l9.5"> </span>
<a href="#l9.6"></a><span id="l9.6">     // Add item status atom.</span>
<a href="#l9.7"></a><span id="l9.7">     if (item.status) {</span>
<a href="#l9.8"></a><span id="l9.8">       properties.push(&quot;status-&quot; + item.status.toLowerCase());</span>
<a href="#l9.9"></a><span id="l9.9">     }</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11">     // Alarm status atom.</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    if (item.getAlarms({}).length) {</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    if (item.getAlarms().length) {</span>
<a href="#l9.14"></a><span id="l9.14">       properties.push(&quot;alarm&quot;);</span>
<a href="#l9.15"></a><span id="l9.15">     }</span>
<a href="#l9.16"></a><span id="l9.16"> </span>
<a href="#l9.17"></a><span id="l9.17">     // Task categories.</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineminus">-    properties = properties.concat(item.getCategories({}).map(cal.view.formatStringForCSSRule));</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+    properties = properties.concat(item.getCategories().map(cal.view.formatStringForCSSRule));</span>
<a href="#l9.20"></a><span id="l9.20"> </span>
<a href="#l9.21"></a><span id="l9.21">     return properties.join(&quot; &quot;);</span>
<a href="#l9.22"></a><span id="l9.22">   }</span>
<a href="#l9.23"></a><span id="l9.23"> </span>
<a href="#l9.24"></a><span id="l9.24">   cycleCell(row, col) {</span>
<a href="#l9.25"></a><span id="l9.25">     let task = this.tree.mTaskArray[row];</span>
<a href="#l9.26"></a><span id="l9.26"> </span>
<a href="#l9.27"></a><span id="l9.27">     // Prevent toggling completed status for parent items of</span>
<a href="#l9.28"></a><span id="l9.28" class="difflineat">@@ -306,17 +306,17 @@ class CalendarTaskTreeView {</span>
<a href="#l9.29"></a><span id="l9.29">       case &quot;completedDate&quot;:</span>
<a href="#l9.30"></a><span id="l9.30">         return task.recurrenceInfo</span>
<a href="#l9.31"></a><span id="l9.31">           ? cal.l10n.getDateFmtString(&quot;Repeating&quot;)</span>
<a href="#l9.32"></a><span id="l9.32">           : this._formatDateTime(task[property]);</span>
<a href="#l9.33"></a><span id="l9.33">       case &quot;percentComplete&quot;:</span>
<a href="#l9.34"></a><span id="l9.34">         return task.percentComplete &gt; 0 ? task.percentComplete + &quot;%&quot; : &quot;&quot;;</span>
<a href="#l9.35"></a><span id="l9.35">       case &quot;categories&quot;:</span>
<a href="#l9.36"></a><span id="l9.36">         // TODO This is l10n-unfriendly.</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineminus">-        return task.getCategories({}).join(&quot;, &quot;);</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineplus">+        return task.getCategories().join(&quot;, &quot;);</span>
<a href="#l9.39"></a><span id="l9.39">       case &quot;location&quot;:</span>
<a href="#l9.40"></a><span id="l9.40">         return task.getProperty(&quot;LOCATION&quot;);</span>
<a href="#l9.41"></a><span id="l9.41">       case &quot;status&quot;:</span>
<a href="#l9.42"></a><span id="l9.42">         return getToDoStatusString(task);</span>
<a href="#l9.43"></a><span id="l9.43">       case &quot;calendar&quot;:</span>
<a href="#l9.44"></a><span id="l9.44">         return task.calendar.name;</span>
<a href="#l9.45"></a><span id="l9.45">       case &quot;duration&quot;:</span>
<a href="#l9.46"></a><span id="l9.46">         return this.tree.duration(task);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/content/calendar-task-view.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-view.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -118,17 +118,17 @@ var taskDetailsView = {</span>
<a href="#l10.4"></a><span id="l10.4">           default: {</span>
<a href="#l10.5"></a><span id="l10.5">             document</span>
<a href="#l10.6"></a><span id="l10.6">               .getElementById(&quot;calendar-task-details-status-row&quot;)</span>
<a href="#l10.7"></a><span id="l10.7">               .toggleAttribute(&quot;hidden&quot;, true);</span>
<a href="#l10.8"></a><span id="l10.8">             break;</span>
<a href="#l10.9"></a><span id="l10.9">           }</span>
<a href="#l10.10"></a><span id="l10.10">         }</span>
<a href="#l10.11"></a><span id="l10.11">       }</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-      let categories = item.getCategories({});</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+      let categories = item.getCategories();</span>
<a href="#l10.14"></a><span id="l10.14">       if (</span>
<a href="#l10.15"></a><span id="l10.15">         !document</span>
<a href="#l10.16"></a><span id="l10.16">           .getElementById(&quot;calendar-task-details-category-row&quot;)</span>
<a href="#l10.17"></a><span id="l10.17">           .toggleAttribute(&quot;hidden&quot;, categories.length == 0)</span>
<a href="#l10.18"></a><span id="l10.18">       ) {</span>
<a href="#l10.19"></a><span id="l10.19">         document.getElementById(&quot;calendar-task-details-category&quot;).textContent = categories.join(</span>
<a href="#l10.20"></a><span id="l10.20">           &quot;, &quot;</span>
<a href="#l10.21"></a><span id="l10.21">         );</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineat">@@ -169,17 +169,17 @@ var taskDetailsView = {</span>
<a href="#l10.23"></a><span id="l10.23">         }</span>
<a href="#l10.24"></a><span id="l10.24">       }</span>
<a href="#l10.25"></a><span id="l10.25">       let textbox = document.getElementById(&quot;calendar-task-details-description&quot;);</span>
<a href="#l10.26"></a><span id="l10.26">       let description = item.hasProperty(&quot;DESCRIPTION&quot;) ? item.getProperty(&quot;DESCRIPTION&quot;) : null;</span>
<a href="#l10.27"></a><span id="l10.27">       textbox.value = description;</span>
<a href="#l10.28"></a><span id="l10.28">       textbox.readOnly = true;</span>
<a href="#l10.29"></a><span id="l10.29">       let attachmentRows = document.getElementById(&quot;calendar-task-details-attachment-rows&quot;);</span>
<a href="#l10.30"></a><span id="l10.30">       removeChildren(attachmentRows);</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-      let attachments = item.getAttachments({});</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+      let attachments = item.getAttachments();</span>
<a href="#l10.33"></a><span id="l10.33">       if (displayElement(&quot;calendar-task-details-attachment-row&quot;, attachments.length &gt; 0)) {</span>
<a href="#l10.34"></a><span id="l10.34">         displayElement(&quot;calendar-task-details-attachment-rows&quot;, true);</span>
<a href="#l10.35"></a><span id="l10.35">         for (let attachment of attachments) {</span>
<a href="#l10.36"></a><span id="l10.36">           let url = attachment.calIAttachment.uri.spec;</span>
<a href="#l10.37"></a><span id="l10.37">           let urlLabel = document.createXULElement(&quot;label&quot;);</span>
<a href="#l10.38"></a><span id="l10.38">           urlLabel.setAttribute(&quot;class&quot;, &quot;text-link&quot;);</span>
<a href="#l10.39"></a><span id="l10.39">           urlLabel.setAttribute(&quot;value&quot;, url);</span>
<a href="#l10.40"></a><span id="l10.40">           urlLabel.setAttribute(&quot;tooltiptext&quot;, url);</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineat">@@ -191,17 +191,17 @@ var taskDetailsView = {</span>
<a href="#l10.42"></a><span id="l10.42">       }</span>
<a href="#l10.43"></a><span id="l10.43">     }</span>
<a href="#l10.44"></a><span id="l10.44">   },</span>
<a href="#l10.45"></a><span id="l10.45"> </span>
<a href="#l10.46"></a><span id="l10.46">   loadCategories: function() {</span>
<a href="#l10.47"></a><span id="l10.47">     let categoryPopup = document.getElementById(&quot;task-actions-category-popup&quot;);</span>
<a href="#l10.48"></a><span id="l10.48">     let item = document.getElementById(&quot;calendar-task-tree&quot;).currentTask;</span>
<a href="#l10.49"></a><span id="l10.49"> </span>
<a href="#l10.50"></a><span id="l10.50" class="difflineminus">-    let itemCategories = item.getCategories({});</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineplus">+    let itemCategories = item.getCategories();</span>
<a href="#l10.52"></a><span id="l10.52">     let categoryList = cal.category.fromPrefs();</span>
<a href="#l10.53"></a><span id="l10.53">     for (let cat of itemCategories) {</span>
<a href="#l10.54"></a><span id="l10.54">       if (!categoryList.includes(cat)) {</span>
<a href="#l10.55"></a><span id="l10.55">         categoryList.push(cat);</span>
<a href="#l10.56"></a><span id="l10.56">       }</span>
<a href="#l10.57"></a><span id="l10.57">     }</span>
<a href="#l10.58"></a><span id="l10.58">     cal.l10n.sortArrayByLocaleCollator(categoryList);</span>
<a href="#l10.59"></a><span id="l10.59"> </span>
<a href="#l10.60"></a><span id="l10.60" class="difflineat">@@ -232,29 +232,29 @@ var taskDetailsView = {</span>
<a href="#l10.61"></a><span id="l10.61">       categoryPopup.appendChild(menuitem);</span>
<a href="#l10.62"></a><span id="l10.62">     }</span>
<a href="#l10.63"></a><span id="l10.63">   },</span>
<a href="#l10.64"></a><span id="l10.64"> </span>
<a href="#l10.65"></a><span id="l10.65">   saveCategories: function(event) {</span>
<a href="#l10.66"></a><span id="l10.66">     let categoryPopup = document.getElementById(&quot;task-actions-category-popup&quot;);</span>
<a href="#l10.67"></a><span id="l10.67">     let item = document.getElementById(&quot;calendar-task-tree&quot;).currentTask;</span>
<a href="#l10.68"></a><span id="l10.68"> </span>
<a href="#l10.69"></a><span id="l10.69" class="difflineminus">-    let oldCategories = item.getCategories({});</span>
<a href="#l10.70"></a><span id="l10.70" class="difflineplus">+    let oldCategories = item.getCategories();</span>
<a href="#l10.71"></a><span id="l10.71">     let categories = Array.from(</span>
<a href="#l10.72"></a><span id="l10.72">       categoryPopup.querySelectorAll(&quot;menuitem.calendar-category[checked]&quot;),</span>
<a href="#l10.73"></a><span id="l10.73">       menuitem =&gt; menuitem.value</span>
<a href="#l10.74"></a><span id="l10.74">     );</span>
<a href="#l10.75"></a><span id="l10.75">     let unchanged = oldCategories.length == categories.length;</span>
<a href="#l10.76"></a><span id="l10.76">     for (let i = 0; unchanged &amp;&amp; i &lt; categories.length; i++) {</span>
<a href="#l10.77"></a><span id="l10.77">       unchanged = oldCategories[i] == categories[i];</span>
<a href="#l10.78"></a><span id="l10.78">     }</span>
<a href="#l10.79"></a><span id="l10.79"> </span>
<a href="#l10.80"></a><span id="l10.80">     if (!unchanged) {</span>
<a href="#l10.81"></a><span id="l10.81">       let newItem = item.clone();</span>
<a href="#l10.82"></a><span id="l10.82" class="difflineminus">-      newItem.setCategories(categories.length, categories);</span>
<a href="#l10.83"></a><span id="l10.83" class="difflineplus">+      newItem.setCategories(categories);</span>
<a href="#l10.84"></a><span id="l10.84">       doTransaction(&quot;modify&quot;, newItem, newItem.calendar, item, null);</span>
<a href="#l10.85"></a><span id="l10.85">       return false;</span>
<a href="#l10.86"></a><span id="l10.86">     }</span>
<a href="#l10.87"></a><span id="l10.87"> </span>
<a href="#l10.88"></a><span id="l10.88">     return true;</span>
<a href="#l10.89"></a><span id="l10.89">   },</span>
<a href="#l10.90"></a><span id="l10.90"> </span>
<a href="#l10.91"></a><span id="l10.91">   categoryTextboxKeypress: function(event) {</span>
<a href="#l10.92"></a><span id="l10.92" class="difflineat">@@ -332,17 +332,17 @@ var taskDetailsView = {</span>
<a href="#l10.93"></a><span id="l10.93">     }</span>
<a href="#l10.94"></a><span id="l10.94"> </span>
<a href="#l10.95"></a><span id="l10.95">     if (modified) {</span>
<a href="#l10.96"></a><span id="l10.96">       categoryList = categoryPopup.querySelectorAll(&quot;menuitem.calendar-category[checked]&quot;);</span>
<a href="#l10.97"></a><span id="l10.97">       categories = Array.from(categoryList, cat =&gt; cat.getAttribute(&quot;value&quot;));</span>
<a href="#l10.98"></a><span id="l10.98"> </span>
<a href="#l10.99"></a><span id="l10.99">       let item = document.getElementById(&quot;calendar-task-tree&quot;).currentTask;</span>
<a href="#l10.100"></a><span id="l10.100">       let newItem = item.clone();</span>
<a href="#l10.101"></a><span id="l10.101" class="difflineminus">-      newItem.setCategories(categories.length, categories);</span>
<a href="#l10.102"></a><span id="l10.102" class="difflineplus">+      newItem.setCategories(categories);</span>
<a href="#l10.103"></a><span id="l10.103">       doTransaction(&quot;modify&quot;, newItem, newItem.calendar, item, null);</span>
<a href="#l10.104"></a><span id="l10.104">     }</span>
<a href="#l10.105"></a><span id="l10.105"> </span>
<a href="#l10.106"></a><span id="l10.106">     event.target.value = &quot;&quot;;</span>
<a href="#l10.107"></a><span id="l10.107">   },</span>
<a href="#l10.108"></a><span id="l10.108"> };</span>
<a href="#l10.109"></a><span id="l10.109"> </span>
<a href="#l10.110"></a><span id="l10.110"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/content/calendar-ui-utils.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/content/calendar-ui-utils.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -669,17 +669,17 @@ function setupAttendanceMenu(aMenu, aIte</span>
<a href="#l11.4"></a><span id="l11.4">    * @returns {?String}                  The participation status string</span>
<a href="#l11.5"></a><span id="l11.5">    *                                       as per RfC 5545 or null if no</span>
<a href="#l11.6"></a><span id="l11.6">    *                                       participant was detected</span>
<a href="#l11.7"></a><span id="l11.7">    */</span>
<a href="#l11.8"></a><span id="l11.8">   function getInvitationStatus(aItem) {</span>
<a href="#l11.9"></a><span id="l11.9">     let party = null;</span>
<a href="#l11.10"></a><span id="l11.10">     if (cal.itip.isInvitation(aItem)) {</span>
<a href="#l11.11"></a><span id="l11.11">       party = cal.itip.getInvitedAttendee(aItem);</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-    } else if (aItem.organizer &amp;&amp; aItem.getAttendees({}).length) {</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+    } else if (aItem.organizer &amp;&amp; aItem.getAttendees().length) {</span>
<a href="#l11.14"></a><span id="l11.14">       let calOrgId = aItem.calendar.getProperty(&quot;organizerId&quot;);</span>
<a href="#l11.15"></a><span id="l11.15">       if (calOrgId &amp;&amp; calOrgId.toLowerCase() == aItem.organizer.id.toLowerCase()) {</span>
<a href="#l11.16"></a><span id="l11.16">         party = aItem.organizer;</span>
<a href="#l11.17"></a><span id="l11.17">       }</span>
<a href="#l11.18"></a><span id="l11.18">     }</span>
<a href="#l11.19"></a><span id="l11.19">     return party &amp;&amp; (party.participationStatus || &quot;NEEDS-ACTION&quot;);</span>
<a href="#l11.20"></a><span id="l11.20">   }</span>
<a href="#l11.21"></a><span id="l11.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/content/calendar-unifinder.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/content/calendar-unifinder.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -143,17 +143,17 @@ var unifinderObserver = {</span>
<a href="#l12.4"></a><span id="l12.4">    *</span>
<a href="#l12.5"></a><span id="l12.5">    * @return aItem        The item to add to the tree.</span>
<a href="#l12.6"></a><span id="l12.6">    */</span>
<a href="#l12.7"></a><span id="l12.7">   addItemToTree: function(aItem) {</span>
<a href="#l12.8"></a><span id="l12.8">     let items;</span>
<a href="#l12.9"></a><span id="l12.9">     let filter = unifinderTreeView.mFilter;</span>
<a href="#l12.10"></a><span id="l12.10"> </span>
<a href="#l12.11"></a><span id="l12.11">     if (filter.startDate &amp;&amp; filter.endDate) {</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-      items = aItem.getOccurrencesBetween(filter.startDate, filter.endDate, {});</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+      items = aItem.getOccurrencesBetween(filter.startDate, filter.endDate);</span>
<a href="#l12.14"></a><span id="l12.14">     } else {</span>
<a href="#l12.15"></a><span id="l12.15">       items = [aItem];</span>
<a href="#l12.16"></a><span id="l12.16">     }</span>
<a href="#l12.17"></a><span id="l12.17">     unifinderTreeView.addItems(items.filter(filter.isItemInFilters, filter));</span>
<a href="#l12.18"></a><span id="l12.18">   },</span>
<a href="#l12.19"></a><span id="l12.19"> </span>
<a href="#l12.20"></a><span id="l12.20">   /**</span>
<a href="#l12.21"></a><span id="l12.21">    * Remove an item from the unifinder tree. It is safe to call these for any</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineat">@@ -161,17 +161,17 @@ var unifinderObserver = {</span>
<a href="#l12.23"></a><span id="l12.23">    * needs to be done to the tree.</span>
<a href="#l12.24"></a><span id="l12.24">    *</span>
<a href="#l12.25"></a><span id="l12.25">    * @return aItem        The item to remove from the tree.</span>
<a href="#l12.26"></a><span id="l12.26">    */</span>
<a href="#l12.27"></a><span id="l12.27">   removeItemFromTree: function(aItem) {</span>
<a href="#l12.28"></a><span id="l12.28">     let items;</span>
<a href="#l12.29"></a><span id="l12.29">     let filter = unifinderTreeView.mFilter;</span>
<a href="#l12.30"></a><span id="l12.30">     if (filter.startDate &amp;&amp; filter.endDate &amp;&amp; aItem.parentItem == aItem) {</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-      items = aItem.getOccurrencesBetween(filter.startDate, filter.endDate, {});</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+      items = aItem.getOccurrencesBetween(filter.startDate, filter.endDate);</span>
<a href="#l12.33"></a><span id="l12.33">     } else {</span>
<a href="#l12.34"></a><span id="l12.34">       items = [aItem];</span>
<a href="#l12.35"></a><span id="l12.35">     }</span>
<a href="#l12.36"></a><span id="l12.36">     // XXX: do we really still need this, we are always checking it in the refreshInternal</span>
<a href="#l12.37"></a><span id="l12.37">     unifinderTreeView.removeItems(items.filter(filter.isItemInFilters, filter));</span>
<a href="#l12.38"></a><span id="l12.38">   },</span>
<a href="#l12.39"></a><span id="l12.39"> </span>
<a href="#l12.40"></a><span id="l12.40">   observe: function() {</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineat">@@ -717,22 +717,22 @@ var unifinderTreeView = {</span>
<a href="#l12.42"></a><span id="l12.42">     properties.push(&quot;calendar-&quot; + cal.view.formatStringForCSSRule(item.calendar.name));</span>
<a href="#l12.43"></a><span id="l12.43"> </span>
<a href="#l12.44"></a><span id="l12.44">     // Add item status atom</span>
<a href="#l12.45"></a><span id="l12.45">     if (item.status) {</span>
<a href="#l12.46"></a><span id="l12.46">       properties.push(&quot;status-&quot; + item.status.toLowerCase());</span>
<a href="#l12.47"></a><span id="l12.47">     }</span>
<a href="#l12.48"></a><span id="l12.48"> </span>
<a href="#l12.49"></a><span id="l12.49">     // Alarm status atom</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineminus">-    if (item.getAlarms({}).length) {</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineplus">+    if (item.getAlarms().length) {</span>
<a href="#l12.52"></a><span id="l12.52">       properties.push(&quot;alarm&quot;);</span>
<a href="#l12.53"></a><span id="l12.53">     }</span>
<a href="#l12.54"></a><span id="l12.54"> </span>
<a href="#l12.55"></a><span id="l12.55">     // Task categories</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineminus">-    properties = properties.concat(item.getCategories({}).map(cal.view.formatStringForCSSRule));</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+    properties = properties.concat(item.getCategories().map(cal.view.formatStringForCSSRule));</span>
<a href="#l12.58"></a><span id="l12.58"> </span>
<a href="#l12.59"></a><span id="l12.59">     return properties.join(&quot; &quot;);</span>
<a href="#l12.60"></a><span id="l12.60">   },</span>
<a href="#l12.61"></a><span id="l12.61">   getColumnProperties: function(aCol) {</span>
<a href="#l12.62"></a><span id="l12.62">     return &quot;&quot;;</span>
<a href="#l12.63"></a><span id="l12.63">   },</span>
<a href="#l12.64"></a><span id="l12.64"> </span>
<a href="#l12.65"></a><span id="l12.65">   isContainer: function() {</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineat">@@ -793,17 +793,17 @@ var unifinderTreeView = {</span>
<a href="#l12.67"></a><span id="l12.67">         // let eventEndDate = getCurrentNextOrPreviousRecurrence(calendarEvent);</span>
<a href="#l12.68"></a><span id="l12.68">         if (calendarEvent.startDate.isDate) {</span>
<a href="#l12.69"></a><span id="l12.69">           // display enddate is ical enddate - 1</span>
<a href="#l12.70"></a><span id="l12.70">           eventEndDate.day = eventEndDate.day - 1;</span>
<a href="#l12.71"></a><span id="l12.71">         }</span>
<a href="#l12.72"></a><span id="l12.72">         return formatUnifinderEventDateTime(eventEndDate);</span>
<a href="#l12.73"></a><span id="l12.73">       }</span>
<a href="#l12.74"></a><span id="l12.74">       case &quot;categories&quot;: {</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineminus">-        return calendarEvent.getCategories({}).join(&quot;, &quot;);</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineplus">+        return calendarEvent.getCategories().join(&quot;, &quot;);</span>
<a href="#l12.77"></a><span id="l12.77">       }</span>
<a href="#l12.78"></a><span id="l12.78">       case &quot;location&quot;: {</span>
<a href="#l12.79"></a><span id="l12.79">         return calendarEvent.getProperty(&quot;LOCATION&quot;);</span>
<a href="#l12.80"></a><span id="l12.80">       }</span>
<a href="#l12.81"></a><span id="l12.81">       case &quot;status&quot;: {</span>
<a href="#l12.82"></a><span id="l12.82">         return getEventStatusString(calendarEvent);</span>
<a href="#l12.83"></a><span id="l12.83">       }</span>
<a href="#l12.84"></a><span id="l12.84">       case &quot;calendar&quot;: {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -297,17 +297,17 @@ function loadReminders(reminders) {</span>
<a href="#l13.4"></a><span id="l13.4">  * Save the selected reminder into the passed item.</span>
<a href="#l13.5"></a><span id="l13.5">  *</span>
<a href="#l13.6"></a><span id="l13.6">  * @param item      The item save the reminder into.</span>
<a href="#l13.7"></a><span id="l13.7">  */</span>
<a href="#l13.8"></a><span id="l13.8"> function saveReminder(item) {</span>
<a href="#l13.9"></a><span id="l13.9">   // We want to compare the old alarms with the new ones. If these are not</span>
<a href="#l13.10"></a><span id="l13.10">   // the same, then clear the snooze/dismiss times</span>
<a href="#l13.11"></a><span id="l13.11">   let oldAlarmMap = {};</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-  for (let alarm of item.getAlarms({})) {</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+  for (let alarm of item.getAlarms()) {</span>
<a href="#l13.14"></a><span id="l13.14">     oldAlarmMap[alarm.icalString] = true;</span>
<a href="#l13.15"></a><span id="l13.15">   }</span>
<a href="#l13.16"></a><span id="l13.16"> </span>
<a href="#l13.17"></a><span id="l13.17">   // Clear the alarms so we can add our new ones.</span>
<a href="#l13.18"></a><span id="l13.18">   item.clearAlarms();</span>
<a href="#l13.19"></a><span id="l13.19"> </span>
<a href="#l13.20"></a><span id="l13.20">   let reminderList = document.getElementById(&quot;item-alarm&quot;);</span>
<a href="#l13.21"></a><span id="l13.21">   if (reminderList.value != &quot;none&quot;) {</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -333,17 +333,17 @@ function saveReminder(item) {</span>
<a href="#l13.23"></a><span id="l13.23">       alarmActions[action] = true;</span>
<a href="#l13.24"></a><span id="l13.24">     }</span>
<a href="#l13.25"></a><span id="l13.25"> </span>
<a href="#l13.26"></a><span id="l13.26">     // Make sure only alarms are saved that work in the given calendar.</span>
<a href="#l13.27"></a><span id="l13.27">     reminders.filter(x =&gt; x.action in alarmActions).forEach(item.addAlarm, item);</span>
<a href="#l13.28"></a><span id="l13.28">   }</span>
<a href="#l13.29"></a><span id="l13.29"> </span>
<a href="#l13.30"></a><span id="l13.30">   // Compare alarms to see if something changed.</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-  for (let alarm of item.getAlarms({})) {</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+  for (let alarm of item.getAlarms()) {</span>
<a href="#l13.33"></a><span id="l13.33">     let ics = alarm.icalString;</span>
<a href="#l13.34"></a><span id="l13.34">     if (ics in oldAlarmMap) {</span>
<a href="#l13.35"></a><span id="l13.35">       // The new alarm is also in the old set, remember this</span>
<a href="#l13.36"></a><span id="l13.36">       delete oldAlarmMap[ics];</span>
<a href="#l13.37"></a><span id="l13.37">     } else {</span>
<a href="#l13.38"></a><span id="l13.38">       // The new alarm is not in the old set, this means the alarms</span>
<a href="#l13.39"></a><span id="l13.39">       // differ and we can break out.</span>
<a href="#l13.40"></a><span id="l13.40">       oldAlarmMap[ics] = true;</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineat">@@ -704,17 +704,17 @@ function adaptScheduleAgent(aItem) {</span>
<a href="#l13.42"></a><span id="l13.42">     let identity = aItem.calendar.getProperty(&quot;imip.identity&quot;);</span>
<a href="#l13.43"></a><span id="l13.43">     let orgEmail = identity &amp;&amp; identity.QueryInterface(Ci.nsIMsgIdentity).email;</span>
<a href="#l13.44"></a><span id="l13.44">     let organizerAction = aItem.organizer &amp;&amp; orgEmail &amp;&amp; aItem.organizer.id == &quot;mailto:&quot; + orgEmail;</span>
<a href="#l13.45"></a><span id="l13.45">     if (aItem.calendar.getProperty(&quot;forceEmailScheduling&quot;)) {</span>
<a href="#l13.46"></a><span id="l13.46">       cal.LOG(&quot;Enforcing clientside email based scheduling.&quot;);</span>
<a href="#l13.47"></a><span id="l13.47">       // for attendees, we change schedule-agent only in case of an</span>
<a href="#l13.48"></a><span id="l13.48">       // organizer triggered action</span>
<a href="#l13.49"></a><span id="l13.49">       if (organizerAction) {</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineminus">-        aItem.getAttendees({}).forEach(aAttendee =&gt; {</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+        aItem.getAttendees().forEach(aAttendee =&gt; {</span>
<a href="#l13.52"></a><span id="l13.52">           // overwriting must always happen consistently for all</span>
<a href="#l13.53"></a><span id="l13.53">           // attendees regarding SERVER or CLIENT but must not override</span>
<a href="#l13.54"></a><span id="l13.54">           // e.g. NONE, so we only overwrite if the param is set to</span>
<a href="#l13.55"></a><span id="l13.55">           // SERVER or doesn't exist</span>
<a href="#l13.56"></a><span id="l13.56">           if (</span>
<a href="#l13.57"></a><span id="l13.57">             aAttendee.getProperty(&quot;SCHEDULE-AGENT&quot;) == &quot;SERVER&quot; ||</span>
<a href="#l13.58"></a><span id="l13.58">             !aAttendee.getProperty(&quot;SCHEDULE-AGENT&quot;)</span>
<a href="#l13.59"></a><span id="l13.59">           ) {</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineat">@@ -730,17 +730,17 @@ function adaptScheduleAgent(aItem) {</span>
<a href="#l13.61"></a><span id="l13.61">       ) {</span>
<a href="#l13.62"></a><span id="l13.62">         // for organizer, we change the schedule-agent only in case of</span>
<a href="#l13.63"></a><span id="l13.63">         // an attendee triggered action</span>
<a href="#l13.64"></a><span id="l13.64">         aItem.organizer.setProperty(&quot;SCHEDULE-AGENT&quot;, &quot;CLIENT&quot;);</span>
<a href="#l13.65"></a><span id="l13.65">         aItem.organizer.deleteProperty(&quot;SCHEDULE-STATUS&quot;);</span>
<a href="#l13.66"></a><span id="l13.66">         aItem.organizer.deleteProperty(&quot;SCHEDULE-FORCE-SEND&quot;);</span>
<a href="#l13.67"></a><span id="l13.67">       }</span>
<a href="#l13.68"></a><span id="l13.68">     } else if (organizerAction) {</span>
<a href="#l13.69"></a><span id="l13.69" class="difflineminus">-      aItem.getAttendees({}).forEach(aAttendee =&gt; {</span>
<a href="#l13.70"></a><span id="l13.70" class="difflineplus">+      aItem.getAttendees().forEach(aAttendee =&gt; {</span>
<a href="#l13.71"></a><span id="l13.71">         if (aAttendee.getProperty(&quot;SCHEDULE-AGENT&quot;) == &quot;CLIENT&quot;) {</span>
<a href="#l13.72"></a><span id="l13.72">           aAttendee.deleteProperty(&quot;SCHEDULE-AGENT&quot;);</span>
<a href="#l13.73"></a><span id="l13.73">         }</span>
<a href="#l13.74"></a><span id="l13.74">       });</span>
<a href="#l13.75"></a><span id="l13.75">     } else if (aItem.organizer &amp;&amp; aItem.organizer.getProperty(&quot;SCHEDULE-AGENT&quot;) == &quot;CLIENT&quot;) {</span>
<a href="#l13.76"></a><span id="l13.76">       aItem.organizer.deleteProperty(&quot;SCHEDULE-AGENT&quot;);</span>
<a href="#l13.77"></a><span id="l13.77">     }</span>
<a href="#l13.78"></a><span id="l13.78">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-reminder.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-reminder.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -80,17 +80,17 @@ function onLoad() {</span>
<a href="#l14.4"></a><span id="l14.4"> </span>
<a href="#l14.5"></a><span id="l14.5"> /**</span>
<a href="#l14.6"></a><span id="l14.6">  * Load Reminders from the window's arguments and set up dialog controls to</span>
<a href="#l14.7"></a><span id="l14.7">  * their initial values.</span>
<a href="#l14.8"></a><span id="l14.8">  */</span>
<a href="#l14.9"></a><span id="l14.9"> function loadReminders() {</span>
<a href="#l14.10"></a><span id="l14.10">   let args = window.arguments[0];</span>
<a href="#l14.11"></a><span id="l14.11">   let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  let reminders = args.reminders || args.item.getAlarms({});</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+  let reminders = args.reminders || args.item.getAlarms();</span>
<a href="#l14.14"></a><span id="l14.14"> </span>
<a href="#l14.15"></a><span id="l14.15">   // This dialog should not be shown if the calendar doesn't support alarms at</span>
<a href="#l14.16"></a><span id="l14.16">   // all, so the case of maxCount = 0 breaking this logic doesn't apply.</span>
<a href="#l14.17"></a><span id="l14.17">   let maxReminders = args.calendar.getProperty(&quot;capabilities.alarms.maxCount&quot;);</span>
<a href="#l14.18"></a><span id="l14.18">   let count = Math.min(reminders.length, maxReminders || reminders.length);</span>
<a href="#l14.19"></a><span id="l14.19">   for (let i = 0; i &lt; count; i++) {</span>
<a href="#l14.20"></a><span id="l14.20">     if (reminders[i].action in allowedActionsMap) {</span>
<a href="#l14.21"></a><span id="l14.21">       // Set up the listitem and add it to the listbox, but only if the</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-invitations-dialog.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-invitations-dialog.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -290,17 +290,17 @@ function fillJobQueue(queue) {</span>
<a href="#l15.4"></a><span id="l15.4">     let oldStatus = richListItem.initialParticipationStatus;</span>
<a href="#l15.5"></a><span id="l15.5">     if (newStatus != oldStatus) {</span>
<a href="#l15.6"></a><span id="l15.6">       let actionString = &quot;modify&quot;;</span>
<a href="#l15.7"></a><span id="l15.7">       let oldCalendarItem = richListItem.calendarItem;</span>
<a href="#l15.8"></a><span id="l15.8">       let newCalendarItem = oldCalendarItem.clone();</span>
<a href="#l15.9"></a><span id="l15.9"> </span>
<a href="#l15.10"></a><span id="l15.10">       // set default alarm on unresponded items that have not been declined:</span>
<a href="#l15.11"></a><span id="l15.11">       if (</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-        !newCalendarItem.getAlarms({}).length &amp;&amp;</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+        !newCalendarItem.getAlarms().length &amp;&amp;</span>
<a href="#l15.14"></a><span id="l15.14">         oldStatus == &quot;NEEDS-ACTION&quot; &amp;&amp;</span>
<a href="#l15.15"></a><span id="l15.15">         newStatus != &quot;DECLINED&quot;</span>
<a href="#l15.16"></a><span id="l15.16">       ) {</span>
<a href="#l15.17"></a><span id="l15.17">         cal.alarms.setDefaultValues(newCalendarItem);</span>
<a href="#l15.18"></a><span id="l15.18">       }</span>
<a href="#l15.19"></a><span id="l15.19"> </span>
<a href="#l15.20"></a><span id="l15.20">       richListItem.setCalendarItemParticipationStatus(newCalendarItem, newStatus);</span>
<a href="#l15.21"></a><span id="l15.21">       let job = {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -58,29 +58,29 @@ function onLoad() {</span>
<a href="#l16.4"></a><span id="l16.4"> </span>
<a href="#l16.5"></a><span id="l16.5">   // set the dialog-id to enable the right window-icon to be loaded.</span>
<a href="#l16.6"></a><span id="l16.6">   if (cal.item.isEvent(item)) {</span>
<a href="#l16.7"></a><span id="l16.7">     setDialogId(document.documentElement, &quot;calendar-event-summary-dialog&quot;);</span>
<a href="#l16.8"></a><span id="l16.8">   } else if (cal.item.isToDo(item)) {</span>
<a href="#l16.9"></a><span id="l16.9">     setDialogId(document.documentElement, &quot;calendar-task-summary-dialog&quot;);</span>
<a href="#l16.10"></a><span id="l16.10">   }</span>
<a href="#l16.11"></a><span id="l16.11"> </span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-  window.attendees = item.getAttendees({});</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+  window.attendees = item.getAttendees();</span>
<a href="#l16.14"></a><span id="l16.14"> </span>
<a href="#l16.15"></a><span id="l16.15">   let calendar = cal.wrapInstance(item.calendar, Ci.calISchedulingSupport);</span>
<a href="#l16.16"></a><span id="l16.16">   window.readOnly = !(</span>
<a href="#l16.17"></a><span id="l16.17">     cal.acl.isCalendarWritable(calendar) &amp;&amp;</span>
<a href="#l16.18"></a><span id="l16.18">     (cal.acl.userCanModifyItem(item) ||</span>
<a href="#l16.19"></a><span id="l16.19">       (calendar &amp;&amp; item.calendar.isInvitation(item) &amp;&amp; cal.acl.userCanRespondToInvitation(item)))</span>
<a href="#l16.20"></a><span id="l16.20">   );</span>
<a href="#l16.21"></a><span id="l16.21">   if (!window.readOnly &amp;&amp; calendar) {</span>
<a href="#l16.22"></a><span id="l16.22">     let attendee = calendar.getInvitedAttendee(item);</span>
<a href="#l16.23"></a><span id="l16.23">     if (attendee) {</span>
<a href="#l16.24"></a><span id="l16.24">       // if this is an unresponded invitation, preset our default alarm values:</span>
<a href="#l16.25"></a><span id="l16.25" class="difflineminus">-      if (!item.getAlarms({}).length &amp;&amp; attendee.participationStatus == &quot;NEEDS-ACTION&quot;) {</span>
<a href="#l16.26"></a><span id="l16.26" class="difflineplus">+      if (!item.getAlarms().length &amp;&amp; attendee.participationStatus == &quot;NEEDS-ACTION&quot;) {</span>
<a href="#l16.27"></a><span id="l16.27">         cal.alarms.setDefaultValues(item);</span>
<a href="#l16.28"></a><span id="l16.28">       }</span>
<a href="#l16.29"></a><span id="l16.29"> </span>
<a href="#l16.30"></a><span id="l16.30">       window.attendee = attendee.clone();</span>
<a href="#l16.31"></a><span id="l16.31">       // Since we don't have API to update an attendee in place, remove</span>
<a href="#l16.32"></a><span id="l16.32">       // and add again. Also, this is needed if the attendee doesn't exist</span>
<a href="#l16.33"></a><span id="l16.33">       // (i.e REPLY on a mailing list)</span>
<a href="#l16.34"></a><span id="l16.34">       item.removeAttendee(attendee);</span>
<a href="#l16.35"></a><span id="l16.35" class="difflineat">@@ -118,31 +118,31 @@ function onLoad() {</span>
<a href="#l16.36"></a><span id="l16.36">   }</span>
<a href="#l16.37"></a><span id="l16.37">   // show reminder if this item is *not* readonly.</span>
<a href="#l16.38"></a><span id="l16.38">   // this case happens for example if this is an invitation.</span>
<a href="#l16.39"></a><span id="l16.39">   let argCalendar = window.arguments[0].calendarEvent.calendar;</span>
<a href="#l16.40"></a><span id="l16.40">   let supportsReminders =</span>
<a href="#l16.41"></a><span id="l16.41">     argCalendar.getProperty(&quot;capabilities.alarms.oninvitations.supported&quot;) !== false;</span>
<a href="#l16.42"></a><span id="l16.42">   if (!window.readOnly &amp;&amp; supportsReminders) {</span>
<a href="#l16.43"></a><span id="l16.43">     document.getElementById(&quot;reminder-row&quot;).removeAttribute(&quot;hidden&quot;);</span>
<a href="#l16.44"></a><span id="l16.44" class="difflineminus">-    loadReminders(window.calendarItem.getAlarms({}));</span>
<a href="#l16.45"></a><span id="l16.45" class="difflineplus">+    loadReminders(window.calendarItem.getAlarms());</span>
<a href="#l16.46"></a><span id="l16.46">     updateReminder();</span>
<a href="#l16.47"></a><span id="l16.47">   }</span>
<a href="#l16.48"></a><span id="l16.48"> </span>
<a href="#l16.49"></a><span id="l16.49">   updateRepeatDetails();</span>
<a href="#l16.50"></a><span id="l16.50">   updateAttendees();</span>
<a href="#l16.51"></a><span id="l16.51">   updateLink();</span>
<a href="#l16.52"></a><span id="l16.52"> </span>
<a href="#l16.53"></a><span id="l16.53">   let location = item.getProperty(&quot;LOCATION&quot;);</span>
<a href="#l16.54"></a><span id="l16.54">   if (location &amp;&amp; location.length) {</span>
<a href="#l16.55"></a><span id="l16.55">     document.getElementById(&quot;location-row&quot;).removeAttribute(&quot;hidden&quot;);</span>
<a href="#l16.56"></a><span id="l16.56">     document.getElementById(&quot;item-location&quot;).value = location;</span>
<a href="#l16.57"></a><span id="l16.57">   }</span>
<a href="#l16.58"></a><span id="l16.58"> </span>
<a href="#l16.59"></a><span id="l16.59" class="difflineminus">-  let categories = item.getCategories({});</span>
<a href="#l16.60"></a><span id="l16.60" class="difflineplus">+  let categories = item.getCategories();</span>
<a href="#l16.61"></a><span id="l16.61">   if (categories.length &gt; 0) {</span>
<a href="#l16.62"></a><span id="l16.62">     document.getElementById(&quot;category-row&quot;).removeAttribute(&quot;hidden&quot;);</span>
<a href="#l16.63"></a><span id="l16.63">     document.getElementById(&quot;item-category&quot;).value = categories.join(&quot;, &quot;); // TODO l10n-unfriendly</span>
<a href="#l16.64"></a><span id="l16.64">   }</span>
<a href="#l16.65"></a><span id="l16.65"> </span>
<a href="#l16.66"></a><span id="l16.66">   let organizer = item.organizer;</span>
<a href="#l16.67"></a><span id="l16.67">   if (organizer &amp;&amp; organizer.id) {</span>
<a href="#l16.68"></a><span id="l16.68">     document.getElementById(&quot;organizer-row&quot;).removeAttribute(&quot;hidden&quot;);</span>
<a href="#l16.69"></a><span id="l16.69" class="difflineat">@@ -203,17 +203,17 @@ function onLoad() {</span>
<a href="#l16.70"></a><span id="l16.70">       let textbox = document.getElementById(&quot;item-description&quot;);</span>
<a href="#l16.71"></a><span id="l16.71">       textbox.value = description;</span>
<a href="#l16.72"></a><span id="l16.72">       textbox.readOnly = true;</span>
<a href="#l16.73"></a><span id="l16.73">     }</span>
<a href="#l16.74"></a><span id="l16.74">   }</span>
<a href="#l16.75"></a><span id="l16.75"> </span>
<a href="#l16.76"></a><span id="l16.76">   document.title = item.title;</span>
<a href="#l16.77"></a><span id="l16.77"> </span>
<a href="#l16.78"></a><span id="l16.78" class="difflineminus">-  let attachments = item.getAttachments({});</span>
<a href="#l16.79"></a><span id="l16.79" class="difflineplus">+  let attachments = item.getAttachments();</span>
<a href="#l16.80"></a><span id="l16.80">   if (attachments.length) {</span>
<a href="#l16.81"></a><span id="l16.81">     // we only want to display uri type attachments and no ones received inline with the</span>
<a href="#l16.82"></a><span id="l16.82">     // invitation message (having a CID: prefix results in about:blank) here</span>
<a href="#l16.83"></a><span id="l16.83">     let attCounter = 0;</span>
<a href="#l16.84"></a><span id="l16.84">     attachments.forEach(aAttachment =&gt; {</span>
<a href="#l16.85"></a><span id="l16.85">       if (aAttachment.uri &amp;&amp; aAttachment.uri.spec != &quot;about:blank&quot;) {</span>
<a href="#l16.86"></a><span id="l16.86">         let attachment = document.getElementById(&quot;attachment-template&quot;).cloneNode(true);</span>
<a href="#l16.87"></a><span id="l16.87">         attachment.removeAttribute(&quot;id&quot;);</span>
<a href="#l16.88"></a><span id="l16.88" class="difflineat">@@ -505,16 +505,16 @@ function sendMailToOrganizer() {</span>
<a href="#l16.89"></a><span id="l16.89">  */</span>
<a href="#l16.90"></a><span id="l16.90"> function openAttachment(aAttachmentId) {</span>
<a href="#l16.91"></a><span id="l16.91">   if (!aAttachmentId) {</span>
<a href="#l16.92"></a><span id="l16.92">     return;</span>
<a href="#l16.93"></a><span id="l16.93">   }</span>
<a href="#l16.94"></a><span id="l16.94">   let args = window.arguments[0];</span>
<a href="#l16.95"></a><span id="l16.95">   let item = args.calendarEvent;</span>
<a href="#l16.96"></a><span id="l16.96">   let attachments = item</span>
<a href="#l16.97"></a><span id="l16.97" class="difflineminus">-    .getAttachments({})</span>
<a href="#l16.98"></a><span id="l16.98" class="difflineplus">+    .getAttachments()</span>
<a href="#l16.99"></a><span id="l16.99">     .filter(aAttachment =&gt; aAttachment.hashId == aAttachmentId);</span>
<a href="#l16.100"></a><span id="l16.100">   if (attachments.length &amp;&amp; attachments[0].uri &amp;&amp; attachments[0].uri.spec != &quot;about:blank&quot;) {</span>
<a href="#l16.101"></a><span id="l16.101">     Cc[&quot;@mozilla.org/uriloader/external-protocol-service;1&quot;]</span>
<a href="#l16.102"></a><span id="l16.102">       .getService(Ci.nsIExternalProtocolService)</span>
<a href="#l16.103"></a><span id="l16.103">       .loadURI(attachments[0].uri);</span>
<a href="#l16.104"></a><span id="l16.104">   }</span>
<a href="#l16.105"></a><span id="l16.105"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-minimonth.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-minimonth.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -312,17 +312,17 @@</span>
<a href="#l17.4"></a><span id="l17.4">     onGetResult(aCalendar, aStatus, aItemType, aDetail, aCount, aItems) {</span>
<a href="#l17.5"></a><span id="l17.5">       if (Components.isSuccessCode(aStatus)) {</span>
<a href="#l17.6"></a><span id="l17.6">         aItems.forEach(item =&gt; this.setBusyDaysForOccurrence(item, true));</span>
<a href="#l17.7"></a><span id="l17.7">       }</span>
<a href="#l17.8"></a><span id="l17.8">     }</span>
<a href="#l17.9"></a><span id="l17.9"> </span>
<a href="#l17.10"></a><span id="l17.10">     setBusyDaysForItem(aItem, aState) {</span>
<a href="#l17.11"></a><span id="l17.11">       let items = aItem.recurrenceInfo</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-        ? aItem.getOccurrencesBetween(this.firstDate, this.lastDate, {})</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+        ? aItem.getOccurrencesBetween(this.firstDate, this.lastDate)</span>
<a href="#l17.14"></a><span id="l17.14">         : [aItem];</span>
<a href="#l17.15"></a><span id="l17.15">       items.forEach(item =&gt; this.setBusyDaysForOccurrence(item, aState));</span>
<a href="#l17.16"></a><span id="l17.16">     }</span>
<a href="#l17.17"></a><span id="l17.17"> </span>
<a href="#l17.18"></a><span id="l17.18">     parseBoxBusy(aBox) {</span>
<a href="#l17.19"></a><span id="l17.19">       let boxBusy = {};</span>
<a href="#l17.20"></a><span id="l17.20"> </span>
<a href="#l17.21"></a><span id="l17.21">       let busyStr = aBox.getAttribute(&quot;busy&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/base/modules/utils/calItipUtils.jsm</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/base/modules/utils/calItipUtils.jsm</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -322,17 +322,17 @@ var calitip = {</span>
<a href="#l18.4"></a><span id="l18.4">       if (foundItems &amp;&amp; foundItems.length) {</span>
<a href="#l18.5"></a><span id="l18.5">         data.showItems.push(&quot;imipDetailsButton&quot;);</span>
<a href="#l18.6"></a><span id="l18.6">         if (itipItem.receivedMethod == &quot;COUNTER&quot; &amp;&amp; itipItem.sender) {</span>
<a href="#l18.7"></a><span id="l18.7">           if (disallowedCounter) {</span>
<a href="#l18.8"></a><span id="l18.8">             data.label = cal.l10n.getLtnString(&quot;imipBarDisallowedCounterText&quot;);</span>
<a href="#l18.9"></a><span id="l18.9">           } else {</span>
<a href="#l18.10"></a><span id="l18.10">             let comparison;</span>
<a href="#l18.11"></a><span id="l18.11">             for (let item of itipItem.getItemList()) {</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-              let attendees = cal.itip.getAttendeesBySender(item.getAttendees({}), itipItem.sender);</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+              let attendees = cal.itip.getAttendeesBySender(item.getAttendees(), itipItem.sender);</span>
<a href="#l18.14"></a><span id="l18.14">               if (attendees.length == 1) {</span>
<a href="#l18.15"></a><span id="l18.15">                 comparison = calitip.compareSequence(item, foundItems[0]);</span>
<a href="#l18.16"></a><span id="l18.16">                 if (comparison == 1) {</span>
<a href="#l18.17"></a><span id="l18.17">                   data.label = cal.l10n.getLtnString(&quot;imipBarCounterErrorText&quot;);</span>
<a href="#l18.18"></a><span id="l18.18">                   break;</span>
<a href="#l18.19"></a><span id="l18.19">                 } else if (comparison == -1) {</span>
<a href="#l18.20"></a><span id="l18.20">                   data.label = cal.l10n.getLtnString(&quot;imipBarCounterPreviousVersionText&quot;);</span>
<a href="#l18.21"></a><span id="l18.21">                 }</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineat">@@ -794,18 +794,18 @@ var calitip = {</span>
<a href="#l18.23"></a><span id="l18.23">             &quot;cal.itip.checkAndSend(): Invalid value &quot; +</span>
<a href="#l18.24"></a><span id="l18.24">               aExtResponse.responseMode +</span>
<a href="#l18.25"></a><span id="l18.25">               &quot; provided for responseMode attribute in argument aExtResponse.&quot; +</span>
<a href="#l18.26"></a><span id="l18.26">               &quot; Falling back to USER mode.\r\n&quot; +</span>
<a href="#l18.27"></a><span id="l18.27">               cal.STACK(20)</span>
<a href="#l18.28"></a><span id="l18.28">           );</span>
<a href="#l18.29"></a><span id="l18.29">       }</span>
<a href="#l18.30"></a><span id="l18.30">     } else if (</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineminus">-      (aOriginalItem &amp;&amp; aOriginalItem.getAttendees({}).length) ||</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineminus">-      aItem.getAttendees({}).length</span>
<a href="#l18.33"></a><span id="l18.33" class="difflineplus">+      (aOriginalItem &amp;&amp; aOriginalItem.getAttendees().length) ||</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineplus">+      aItem.getAttendees().length</span>
<a href="#l18.35"></a><span id="l18.35">     ) {</span>
<a href="#l18.36"></a><span id="l18.36">       // let's log something useful to notify addon developers or find any</span>
<a href="#l18.37"></a><span id="l18.37">       // missing pieces in the conversions if the current or original item</span>
<a href="#l18.38"></a><span id="l18.38">       // has attendees - the latter is to prevent logging if creating events</span>
<a href="#l18.39"></a><span id="l18.39">       // by click and slide in day or week views</span>
<a href="#l18.40"></a><span id="l18.40">       cal.LOG(</span>
<a href="#l18.41"></a><span id="l18.41">         &quot;cal.itip.checkAndSend: no response mode provided, &quot; +</span>
<a href="#l18.42"></a><span id="l18.42">           &quot;falling back to USER mode.\r\n&quot; +</span>
<a href="#l18.43"></a><span id="l18.43" class="difflineat">@@ -898,33 +898,33 @@ var calitip = {</span>
<a href="#l18.44"></a><span id="l18.44"> </span>
<a href="#l18.45"></a><span id="l18.45">     if (aItem.getProperty(&quot;X-MOZ-SEND-INVITATIONS&quot;) != &quot;TRUE&quot;) {</span>
<a href="#l18.46"></a><span id="l18.46">       // Only send invitations/cancellations</span>
<a href="#l18.47"></a><span id="l18.47">       // if the user checked the checkbox</span>
<a href="#l18.48"></a><span id="l18.48">       return;</span>
<a href="#l18.49"></a><span id="l18.49">     }</span>
<a href="#l18.50"></a><span id="l18.50"> </span>
<a href="#l18.51"></a><span id="l18.51">     // special handling for invitation with event status cancelled</span>
<a href="#l18.52"></a><span id="l18.52" class="difflineminus">-    if (aItem.getAttendees({}).length &gt; 0 &amp;&amp; aItem.getProperty(&quot;STATUS&quot;) == &quot;CANCELLED&quot;) {</span>
<a href="#l18.53"></a><span id="l18.53" class="difflineplus">+    if (aItem.getAttendees().length &gt; 0 &amp;&amp; aItem.getProperty(&quot;STATUS&quot;) == &quot;CANCELLED&quot;) {</span>
<a href="#l18.54"></a><span id="l18.54">       if (calitip.getSequence(aItem) &gt; 0) {</span>
<a href="#l18.55"></a><span id="l18.55">         // make sure we send a cancellation and not an request</span>
<a href="#l18.56"></a><span id="l18.56">         aOpType = Ci.calIOperationListener.DELETE;</span>
<a href="#l18.57"></a><span id="l18.57">       } else {</span>
<a href="#l18.58"></a><span id="l18.58">         // don't send an invitation, if the event was newly created and has status cancelled</span>
<a href="#l18.59"></a><span id="l18.59">         return;</span>
<a href="#l18.60"></a><span id="l18.60">       }</span>
<a href="#l18.61"></a><span id="l18.61">     }</span>
<a href="#l18.62"></a><span id="l18.62"> </span>
<a href="#l18.63"></a><span id="l18.63">     if (aOpType == Ci.calIOperationListener.DELETE) {</span>
<a href="#l18.64"></a><span id="l18.64" class="difflineminus">-      sendMessage(aItem, &quot;CANCEL&quot;, aItem.getAttendees({}), autoResponse);</span>
<a href="#l18.65"></a><span id="l18.65" class="difflineplus">+      sendMessage(aItem, &quot;CANCEL&quot;, aItem.getAttendees(), autoResponse);</span>
<a href="#l18.66"></a><span id="l18.66">       return;</span>
<a href="#l18.67"></a><span id="l18.67">     } // else ADD, MODIFY:</span>
<a href="#l18.68"></a><span id="l18.68"> </span>
<a href="#l18.69"></a><span id="l18.69" class="difflineminus">-    let originalAtt = aOriginalItem ? aOriginalItem.getAttendees({}) : [];</span>
<a href="#l18.70"></a><span id="l18.70" class="difflineminus">-    let itemAtt = aItem.getAttendees({});</span>
<a href="#l18.71"></a><span id="l18.71" class="difflineplus">+    let originalAtt = aOriginalItem ? aOriginalItem.getAttendees() : [];</span>
<a href="#l18.72"></a><span id="l18.72" class="difflineplus">+    let itemAtt = aItem.getAttendees();</span>
<a href="#l18.73"></a><span id="l18.73">     let canceledAttendees = [];</span>
<a href="#l18.74"></a><span id="l18.74">     let addedAttendees = [];</span>
<a href="#l18.75"></a><span id="l18.75"> </span>
<a href="#l18.76"></a><span id="l18.76">     if (itemAtt.length &gt; 0 || originalAtt.length &gt; 0) {</span>
<a href="#l18.77"></a><span id="l18.77">       let attMap = {};</span>
<a href="#l18.78"></a><span id="l18.78">       for (let att of originalAtt) {</span>
<a href="#l18.79"></a><span id="l18.79">         attMap[att.id.toLowerCase()] = att;</span>
<a href="#l18.80"></a><span id="l18.80">       }</span>
<a href="#l18.81"></a><span id="l18.81" class="difflineat">@@ -962,17 +962,17 @@ var calitip = {</span>
<a href="#l18.82"></a><span id="l18.82">       ) {</span>
<a href="#l18.83"></a><span id="l18.83">         let requestItem = aItem.clone();</span>
<a href="#l18.84"></a><span id="l18.84">         if (!requestItem.organizer) {</span>
<a href="#l18.85"></a><span id="l18.85">           requestItem.organizer = createOrganizer(requestItem.calendar);</span>
<a href="#l18.86"></a><span id="l18.86">         }</span>
<a href="#l18.87"></a><span id="l18.87"> </span>
<a href="#l18.88"></a><span id="l18.88">         // Fix up our attendees for invitations using some good defaults</span>
<a href="#l18.89"></a><span id="l18.89">         let recipients = [];</span>
<a href="#l18.90"></a><span id="l18.90" class="difflineminus">-        let reqItemAtt = requestItem.getAttendees({});</span>
<a href="#l18.91"></a><span id="l18.91" class="difflineplus">+        let reqItemAtt = requestItem.getAttendees();</span>
<a href="#l18.92"></a><span id="l18.92">         if (!isMinorUpdate) {</span>
<a href="#l18.93"></a><span id="l18.93">           requestItem.removeAllAttendees();</span>
<a href="#l18.94"></a><span id="l18.94">         }</span>
<a href="#l18.95"></a><span id="l18.95">         for (let attendee of reqItemAtt) {</span>
<a href="#l18.96"></a><span id="l18.96">           if (!isMinorUpdate) {</span>
<a href="#l18.97"></a><span id="l18.97">             attendee = attendee.clone();</span>
<a href="#l18.98"></a><span id="l18.98">             if (!attendee.role) {</span>
<a href="#l18.99"></a><span id="l18.99">               attendee.role = &quot;REQ-PARTICIPANT&quot;;</span>
<a href="#l18.100"></a><span id="l18.100" class="difflineat">@@ -1307,38 +1307,38 @@ function setReceivedInfo(item, itipItemI</span>
<a href="#l18.101"></a><span id="l18.101">  * @return {calIItemBase}           The stripped item</span>
<a href="#l18.102"></a><span id="l18.102">  */</span>
<a href="#l18.103"></a><span id="l18.103"> function stripUserData(item_) {</span>
<a href="#l18.104"></a><span id="l18.104">   let item = item_.clone();</span>
<a href="#l18.105"></a><span id="l18.105">   let stamp = item.stampTime;</span>
<a href="#l18.106"></a><span id="l18.106">   let lastModified = item.lastModifiedTime;</span>
<a href="#l18.107"></a><span id="l18.107">   item.clearAlarms();</span>
<a href="#l18.108"></a><span id="l18.108">   item.alarmLastAck = null;</span>
<a href="#l18.109"></a><span id="l18.109" class="difflineminus">-  item.setCategories(0, []);</span>
<a href="#l18.110"></a><span id="l18.110" class="difflineplus">+  item.setCategories([]);</span>
<a href="#l18.111"></a><span id="l18.111">   item.deleteProperty(&quot;RECEIVED-SEQUENCE&quot;);</span>
<a href="#l18.112"></a><span id="l18.112">   item.deleteProperty(&quot;RECEIVED-DTSTAMP&quot;);</span>
<a href="#l18.113"></a><span id="l18.113">   for (let [name] of item.properties) {</span>
<a href="#l18.114"></a><span id="l18.114">     let pname = name;</span>
<a href="#l18.115"></a><span id="l18.115">     if (pname.substr(0, &quot;X-MOZ-&quot;.length) == &quot;X-MOZ-&quot;) {</span>
<a href="#l18.116"></a><span id="l18.116">       item.deleteProperty(name);</span>
<a href="#l18.117"></a><span id="l18.117">     }</span>
<a href="#l18.118"></a><span id="l18.118">   }</span>
<a href="#l18.119"></a><span id="l18.119" class="difflineminus">-  item.getAttendees({}).forEach(att =&gt; {</span>
<a href="#l18.120"></a><span id="l18.120" class="difflineplus">+  item.getAttendees().forEach(att =&gt; {</span>
<a href="#l18.121"></a><span id="l18.121">     att.deleteProperty(&quot;RECEIVED-SEQUENCE&quot;);</span>
<a href="#l18.122"></a><span id="l18.122">     att.deleteProperty(&quot;RECEIVED-DTSTAMP&quot;);</span>
<a href="#l18.123"></a><span id="l18.123">   });</span>
<a href="#l18.124"></a><span id="l18.124"> </span>
<a href="#l18.125"></a><span id="l18.125">   // according to RfC 6638, the following items must not be exposed in client side</span>
<a href="#l18.126"></a><span id="l18.126">   // scheduling messages, so let's remove it if present</span>
<a href="#l18.127"></a><span id="l18.127">   let removeSchedulingParams = aCalUser =&gt; {</span>
<a href="#l18.128"></a><span id="l18.128">     aCalUser.deleteProperty(&quot;SCHEDULE-AGENT&quot;);</span>
<a href="#l18.129"></a><span id="l18.129">     aCalUser.deleteProperty(&quot;SCHEDULE-FORCE-SEND&quot;);</span>
<a href="#l18.130"></a><span id="l18.130">     aCalUser.deleteProperty(&quot;SCHEDULE-STATUS&quot;);</span>
<a href="#l18.131"></a><span id="l18.131">   };</span>
<a href="#l18.132"></a><span id="l18.132" class="difflineminus">-  item.getAttendees({}).forEach(removeSchedulingParams);</span>
<a href="#l18.133"></a><span id="l18.133" class="difflineplus">+  item.getAttendees().forEach(removeSchedulingParams);</span>
<a href="#l18.134"></a><span id="l18.134">   if (item.organizer) {</span>
<a href="#l18.135"></a><span id="l18.135">     removeSchedulingParams(item.organizer);</span>
<a href="#l18.136"></a><span id="l18.136">   }</span>
<a href="#l18.137"></a><span id="l18.137"> </span>
<a href="#l18.138"></a><span id="l18.138">   item.setProperty(&quot;DTSTAMP&quot;, stamp);</span>
<a href="#l18.139"></a><span id="l18.139">   item.setProperty(&quot;LAST-MODIFIED&quot;, lastModified); // need to be last to undirty the item</span>
<a href="#l18.140"></a><span id="l18.140">   return item;</span>
<a href="#l18.141"></a><span id="l18.141"> }</span>
<a href="#l18.142"></a><span id="l18.142" class="difflineat">@@ -1356,22 +1356,22 @@ function updateItem(item, itipItemItem) </span>
<a href="#l18.143"></a><span id="l18.143">    *</span>
<a href="#l18.144"></a><span id="l18.144">    * @param {calIItemBase} newItem        The new item to copy to</span>
<a href="#l18.145"></a><span id="l18.145">    * @param {calIItemBase} oldItem        The old item to copy from</span>
<a href="#l18.146"></a><span id="l18.146">    */</span>
<a href="#l18.147"></a><span id="l18.147">   function updateUserData(newItem, oldItem) {</span>
<a href="#l18.148"></a><span id="l18.148">     // preserve user settings:</span>
<a href="#l18.149"></a><span id="l18.149">     newItem.generation = oldItem.generation;</span>
<a href="#l18.150"></a><span id="l18.150">     newItem.clearAlarms();</span>
<a href="#l18.151"></a><span id="l18.151" class="difflineminus">-    for (let alarm of oldItem.getAlarms({})) {</span>
<a href="#l18.152"></a><span id="l18.152" class="difflineplus">+    for (let alarm of oldItem.getAlarms()) {</span>
<a href="#l18.153"></a><span id="l18.153">       newItem.addAlarm(alarm);</span>
<a href="#l18.154"></a><span id="l18.154">     }</span>
<a href="#l18.155"></a><span id="l18.155">     newItem.alarmLastAck = oldItem.alarmLastAck;</span>
<a href="#l18.156"></a><span id="l18.156" class="difflineminus">-    let cats = oldItem.getCategories({});</span>
<a href="#l18.157"></a><span id="l18.157" class="difflineminus">-    newItem.setCategories(cats.length, cats);</span>
<a href="#l18.158"></a><span id="l18.158" class="difflineplus">+    let cats = oldItem.getCategories();</span>
<a href="#l18.159"></a><span id="l18.159" class="difflineplus">+    newItem.setCategories(cats);</span>
<a href="#l18.160"></a><span id="l18.160">   }</span>
<a href="#l18.161"></a><span id="l18.161"> </span>
<a href="#l18.162"></a><span id="l18.162">   let newItem = item.clone();</span>
<a href="#l18.163"></a><span id="l18.163">   newItem.icalComponent = itipItemItem.icalComponent;</span>
<a href="#l18.164"></a><span id="l18.164">   setReceivedInfo(newItem, itipItemItem);</span>
<a href="#l18.165"></a><span id="l18.165">   updateUserData(newItem, item);</span>
<a href="#l18.166"></a><span id="l18.166"> </span>
<a href="#l18.167"></a><span id="l18.167">   let recInfo = itipItemItem.recurrenceInfo;</span>
<a href="#l18.168"></a><span id="l18.168" class="difflineat">@@ -1727,17 +1727,17 @@ ItipItemFinder.prototype = {</span>
<a href="#l18.169"></a><span id="l18.169">                   // the item has been rescheduled with master:</span>
<a href="#l18.170"></a><span id="l18.170">                   itipItemItem = itipItemItem.parentItem;</span>
<a href="#l18.171"></a><span id="l18.171">                 }</span>
<a href="#l18.172"></a><span id="l18.172">               }</span>
<a href="#l18.173"></a><span id="l18.173"> </span>
<a href="#l18.174"></a><span id="l18.174">               switch (method) {</span>
<a href="#l18.175"></a><span id="l18.175">                 case &quot;REFRESH&quot;: {</span>
<a href="#l18.176"></a><span id="l18.176">                   // xxx todo test</span>
<a href="#l18.177"></a><span id="l18.177" class="difflineminus">-                  let attendees = itipItemItem.getAttendees({});</span>
<a href="#l18.178"></a><span id="l18.178" class="difflineplus">+                  let attendees = itipItemItem.getAttendees();</span>
<a href="#l18.179"></a><span id="l18.179">                   cal.ASSERT(attendees.length == 1, &quot;invalid number of attendees in REFRESH!&quot;);</span>
<a href="#l18.180"></a><span id="l18.180">                   if (attendees.length &gt; 0) {</span>
<a href="#l18.181"></a><span id="l18.181">                     let action = function(opListener, partStat, extResponse) {</span>
<a href="#l18.182"></a><span id="l18.182">                       if (!item.organizer) {</span>
<a href="#l18.183"></a><span id="l18.183">                         let org = createOrganizer(item.calendar);</span>
<a href="#l18.184"></a><span id="l18.184">                         if (org) {</span>
<a href="#l18.185"></a><span id="l18.185">                           item = item.clone();</span>
<a href="#l18.186"></a><span id="l18.186">                           item.organizer = org;</span>
<a href="#l18.187"></a><span id="l18.187" class="difflineat">@@ -1751,17 +1751,17 @@ ItipItemFinder.prototype = {</span>
<a href="#l18.188"></a><span id="l18.188">                       );</span>
<a href="#l18.189"></a><span id="l18.189">                     };</span>
<a href="#l18.190"></a><span id="l18.190">                     operations.push(action);</span>
<a href="#l18.191"></a><span id="l18.191">                   }</span>
<a href="#l18.192"></a><span id="l18.192">                   break;</span>
<a href="#l18.193"></a><span id="l18.193">                 }</span>
<a href="#l18.194"></a><span id="l18.194">                 case &quot;PUBLISH&quot;:</span>
<a href="#l18.195"></a><span id="l18.195">                   cal.ASSERT(</span>
<a href="#l18.196"></a><span id="l18.196" class="difflineminus">-                    itipItemItem.getAttendees({}).length == 0,</span>
<a href="#l18.197"></a><span id="l18.197" class="difflineplus">+                    itipItemItem.getAttendees().length == 0,</span>
<a href="#l18.198"></a><span id="l18.198">                     &quot;invalid number of attendees in PUBLISH!&quot;</span>
<a href="#l18.199"></a><span id="l18.199">                   );</span>
<a href="#l18.200"></a><span id="l18.200">                   if (</span>
<a href="#l18.201"></a><span id="l18.201">                     item.calendar.getProperty(&quot;itip.disableRevisionChecks&quot;) ||</span>
<a href="#l18.202"></a><span id="l18.202">                     calitip.compare(itipItemItem, item) &gt; 0</span>
<a href="#l18.203"></a><span id="l18.203">                   ) {</span>
<a href="#l18.204"></a><span id="l18.204">                     let newItem = updateItem(item, itipItemItem);</span>
<a href="#l18.205"></a><span id="l18.205">                     let action = function(opListener, partStat, extResponse) {</span>
<a href="#l18.206"></a><span id="l18.206" class="difflineat">@@ -1842,17 +1842,17 @@ ItipItemFinder.prototype = {</span>
<a href="#l18.207"></a><span id="l18.207">                 }</span>
<a href="#l18.208"></a><span id="l18.208">                 case &quot;DECLINECOUNTER&quot;:</span>
<a href="#l18.209"></a><span id="l18.209">                   // nothing to do right now, but once countering is implemented,</span>
<a href="#l18.210"></a><span id="l18.210">                   // we probably need some action here to remove the proposal from</span>
<a href="#l18.211"></a><span id="l18.211">                   // the countering attendee's calendar</span>
<a href="#l18.212"></a><span id="l18.212">                   break;</span>
<a href="#l18.213"></a><span id="l18.213">                 case &quot;COUNTER&quot;:</span>
<a href="#l18.214"></a><span id="l18.214">                 case &quot;REPLY&quot;: {</span>
<a href="#l18.215"></a><span id="l18.215" class="difflineminus">-                  let attendees = itipItemItem.getAttendees({});</span>
<a href="#l18.216"></a><span id="l18.216" class="difflineplus">+                  let attendees = itipItemItem.getAttendees();</span>
<a href="#l18.217"></a><span id="l18.217">                   if (method == &quot;REPLY&quot;) {</span>
<a href="#l18.218"></a><span id="l18.218">                     cal.ASSERT(attendees.length == 1, &quot;invalid number of attendees in REPLY!&quot;);</span>
<a href="#l18.219"></a><span id="l18.219">                   } else {</span>
<a href="#l18.220"></a><span id="l18.220">                     attendees = cal.itip.getAttendeesBySender(attendees, this.mItipItem.sender);</span>
<a href="#l18.221"></a><span id="l18.221">                     cal.ASSERT(</span>
<a href="#l18.222"></a><span id="l18.222">                       attendees.length == 1,</span>
<a href="#l18.223"></a><span id="l18.223">                       &quot;ambiguous resolution of replying attendee in COUNTER!&quot;</span>
<a href="#l18.224"></a><span id="l18.224">                     );</span>
<a href="#l18.225"></a><span id="l18.225" class="difflineat">@@ -1982,17 +1982,17 @@ ItipItemFinder.prototype = {</span>
<a href="#l18.226"></a><span id="l18.226">                 if (att) {</span>
<a href="#l18.227"></a><span id="l18.227">                   att.participationStatus = partStat;</span>
<a href="#l18.228"></a><span id="l18.228">                 } else {</span>
<a href="#l18.229"></a><span id="l18.229">                   cal.ASSERT(att, &quot;no attendee to reply REQUEST!&quot;);</span>
<a href="#l18.230"></a><span id="l18.230">                   return null;</span>
<a href="#l18.231"></a><span id="l18.231">                 }</span>
<a href="#l18.232"></a><span id="l18.232">               } else {</span>
<a href="#l18.233"></a><span id="l18.233">                 cal.ASSERT(</span>
<a href="#l18.234"></a><span id="l18.234" class="difflineminus">-                  itipItemItem.getAttendees({}).length == 0,</span>
<a href="#l18.235"></a><span id="l18.235" class="difflineplus">+                  itipItemItem.getAttendees().length == 0,</span>
<a href="#l18.236"></a><span id="l18.236">                   &quot;invalid number of attendees in PUBLISH!&quot;</span>
<a href="#l18.237"></a><span id="l18.237">                 );</span>
<a href="#l18.238"></a><span id="l18.238">                 cal.alarms.setDefaultValues(newItem);</span>
<a href="#l18.239"></a><span id="l18.239">               }</span>
<a href="#l18.240"></a><span id="l18.240">               return newItem.calendar.addItem(</span>
<a href="#l18.241"></a><span id="l18.241">                 newItem,</span>
<a href="#l18.242"></a><span id="l18.242">                 method == &quot;REQUEST&quot; ? new ItipOpListener(opListener, null, extResponse) : opListener</span>
<a href="#l18.243"></a><span id="l18.243">               );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/base/modules/utils/calPrintUtils.jsm</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/base/modules/utils/calPrintUtils.jsm</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -49,17 +49,17 @@ var calprint = {</span>
<a href="#l19.4"></a><span id="l19.4">     itemNode.item = item;</span>
<a href="#l19.5"></a><span id="l19.5"> </span>
<a href="#l19.6"></a><span id="l19.6">     // Fill in details of the item</span>
<a href="#l19.7"></a><span id="l19.7">     let itemInterval = cal.print.getItemIntervalString(item, boxDate);</span>
<a href="#l19.8"></a><span id="l19.8">     itemNode.querySelector(&quot;.item-interval&quot;).textContent = itemInterval;</span>
<a href="#l19.9"></a><span id="l19.9">     itemNode.querySelector(&quot;.item-title&quot;).textContent = item.title;</span>
<a href="#l19.10"></a><span id="l19.10"> </span>
<a href="#l19.11"></a><span id="l19.11">     // Fill in category details</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-    let categoriesArray = item.getCategories({});</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+    let categoriesArray = item.getCategories();</span>
<a href="#l19.14"></a><span id="l19.14">     if (categoriesArray.length &gt; 0) {</span>
<a href="#l19.15"></a><span id="l19.15">       let cssClassesArray = categoriesArray.map(cal.view.formatStringForCSSRule);</span>
<a href="#l19.16"></a><span id="l19.16">       let categoriesBox = itemNode.querySelector(&quot;.category-color-box&quot;);</span>
<a href="#l19.17"></a><span id="l19.17">       categoriesBox.setAttribute(&quot;categories&quot;, cssClassesArray.join(&quot; &quot;));</span>
<a href="#l19.18"></a><span id="l19.18">       categoriesBox.style.border = `2px solid var(--category-${cssClassesArray[0]}-color)`;</span>
<a href="#l19.19"></a><span id="l19.19">     }</span>
<a href="#l19.20"></a><span id="l19.20"> </span>
<a href="#l19.21"></a><span id="l19.21">     // Fill in calendar color</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/base/modules/utils/calUnifinderUtils.jsm</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/base/modules/utils/calUnifinderUtils.jsm</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -44,17 +44,17 @@ var calunifinder = {</span>
<a href="#l20.4"></a><span id="l20.4">           return -62168601600000000; // ns value for (0000/00/00 00:00:00)</span>
<a href="#l20.5"></a><span id="l20.5">         }</span>
<a href="#l20.6"></a><span id="l20.6">         return aItem[aKey].nativeTime;</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8">       case &quot;percentComplete&quot;:</span>
<a href="#l20.9"></a><span id="l20.9">         return aItem.percentComplete;</span>
<a href="#l20.10"></a><span id="l20.10"> </span>
<a href="#l20.11"></a><span id="l20.11">       case &quot;categories&quot;:</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-        return aItem.getCategories({}).join(&quot;, &quot;);</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+        return aItem.getCategories().join(&quot;, &quot;);</span>
<a href="#l20.14"></a><span id="l20.14"> </span>
<a href="#l20.15"></a><span id="l20.15">       case &quot;location&quot;:</span>
<a href="#l20.16"></a><span id="l20.16">         return aItem.getProperty(&quot;LOCATION&quot;) || &quot;&quot;;</span>
<a href="#l20.17"></a><span id="l20.17"> </span>
<a href="#l20.18"></a><span id="l20.18">       case &quot;status&quot;: {</span>
<a href="#l20.19"></a><span id="l20.19">         let statusSet = cal.item.isEvent(aItem) ? eventStatus : taskStatus;</span>
<a href="#l20.20"></a><span id="l20.20">         return statusSet.indexOf(aItem.status);</span>
<a href="#l20.21"></a><span id="l20.21">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/base/public/calIAlarm.idl</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/base/public/calIAlarm.idl</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -113,30 +113,28 @@ interface calIAlarm : nsISupports</span>
<a href="#l21.4"></a><span id="l21.4">     attribute AUTF8String summary;</span>
<a href="#l21.5"></a><span id="l21.5"> </span>
<a href="#l21.6"></a><span id="l21.6">     /**</span>
<a href="#l21.7"></a><span id="l21.7">      * Manage Attendee for this alarm. Not valid for AUDIO and DISPLAY alarms.</span>
<a href="#l21.8"></a><span id="l21.8">      */</span>
<a href="#l21.9"></a><span id="l21.9">      void addAttendee(in calIAttendee aAttendee);</span>
<a href="#l21.10"></a><span id="l21.10">      void deleteAttendee(in calIAttendee aAttendee);</span>
<a href="#l21.11"></a><span id="l21.11">      void clearAttendees();</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-     void getAttendees(out uint32_t count,</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineminus">-                       [array,size_is(count),retval] out calIAttendee attendees);</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+     Array&lt;calIAttendee&gt; getAttendees();</span>
<a href="#l21.15"></a><span id="l21.15"> </span>
<a href="#l21.16"></a><span id="l21.16">     /**</span>
<a href="#l21.17"></a><span id="l21.17">      * Manage Attachments for this alarm.</span>
<a href="#l21.18"></a><span id="l21.18">      * For EMAIL alarms, more than one attachment can be specified.</span>
<a href="#l21.19"></a><span id="l21.19">      * For AUDIO alarms, one Attachment can be specified.</span>
<a href="#l21.20"></a><span id="l21.20">      * For DISPLAY alarms, attachments are invalid.</span>
<a href="#l21.21"></a><span id="l21.21">      */</span>
<a href="#l21.22"></a><span id="l21.22">      void addAttachment(in calIAttachment aAttachment);</span>
<a href="#l21.23"></a><span id="l21.23">      void deleteAttachment(in calIAttachment aAttachment);</span>
<a href="#l21.24"></a><span id="l21.24">      void clearAttachments();</span>
<a href="#l21.25"></a><span id="l21.25" class="difflineminus">-     void getAttachments(out uint32_t count,</span>
<a href="#l21.26"></a><span id="l21.26" class="difflineminus">-                         [array,size_is(count),retval] out calIAttachment attachments);</span>
<a href="#l21.27"></a><span id="l21.27" class="difflineplus">+     Array&lt;calIAttachment&gt; getAttachments();</span>
<a href="#l21.28"></a><span id="l21.28"> </span>
<a href="#l21.29"></a><span id="l21.29">     /**</span>
<a href="#l21.30"></a><span id="l21.30">      * The human readable representation of this alarm. Uses locale strings.</span>
<a href="#l21.31"></a><span id="l21.31">      *</span>
<a href="#l21.32"></a><span id="l21.32">      * @param aItem     The item to base the string on. Defaults to an event.</span>
<a href="#l21.33"></a><span id="l21.33">      */</span>
<a href="#l21.34"></a><span id="l21.34">     AUTF8String toString([optional] in calIItemBase aItem);</span>
<a href="#l21.35"></a><span id="l21.35"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/base/public/calIItemBase.idl</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/base/public/calIItemBase.idl</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -108,20 +108,19 @@ interface calIItemBase : nsISupports</span>
<a href="#l22.4"></a><span id="l22.4"> </span>
<a href="#l22.5"></a><span id="l22.5">   //</span>
<a href="#l22.6"></a><span id="l22.6">   // alarms</span>
<a href="#l22.7"></a><span id="l22.7">   //</span>
<a href="#l22.8"></a><span id="l22.8"> </span>
<a href="#l22.9"></a><span id="l22.9">   /**</span>
<a href="#l22.10"></a><span id="l22.10">    * Get all alarms assigned to this item</span>
<a href="#l22.11"></a><span id="l22.11">    *</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-   * @param count       The number of alarms</span>
<a href="#l22.13"></a><span id="l22.13">    * @param aAlarms     The array of calIAlarms</span>
<a href="#l22.14"></a><span id="l22.14">    */</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineminus">-  void getAlarms(out uint32_t count, [array, size_is(count), retval] out calIAlarm aAlarms);</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineplus">+  Array&lt;calIAlarm&gt; getAlarms();</span>
<a href="#l22.17"></a><span id="l22.17"> </span>
<a href="#l22.18"></a><span id="l22.18">    /**</span>
<a href="#l22.19"></a><span id="l22.19">    * Add an alarm to the item</span>
<a href="#l22.20"></a><span id="l22.20">    *</span>
<a href="#l22.21"></a><span id="l22.21">    * @param aAlarm      The calIAlarm to add</span>
<a href="#l22.22"></a><span id="l22.22">    */</span>
<a href="#l22.23"></a><span id="l22.23">   void addAlarm(in calIAlarm aAlarm);</span>
<a href="#l22.24"></a><span id="l22.24"> </span>
<a href="#l22.25"></a><span id="l22.25" class="difflineat">@@ -255,64 +254,59 @@ interface calIItemBase : nsISupports</span>
<a href="#l22.26"></a><span id="l22.26">   attribute calIAttendee organizer;</span>
<a href="#l22.27"></a><span id="l22.27"> </span>
<a href="#l22.28"></a><span id="l22.28">   //</span>
<a href="#l22.29"></a><span id="l22.29">   // Attendees</span>
<a href="#l22.30"></a><span id="l22.30">   //</span>
<a href="#l22.31"></a><span id="l22.31"> </span>
<a href="#l22.32"></a><span id="l22.32">   // The array returned here is not live; it will not reflect calls to</span>
<a href="#l22.33"></a><span id="l22.33">   // removeAttendee/addAttendee that follow the call to getAttendees.</span>
<a href="#l22.34"></a><span id="l22.34" class="difflineminus">-  void getAttendees(out uint32_t count,</span>
<a href="#l22.35"></a><span id="l22.35" class="difflineminus">-                    [array,size_is(count),retval] out calIAttendee attendees);</span>
<a href="#l22.36"></a><span id="l22.36" class="difflineplus">+  Array&lt;calIAttendee&gt; getAttendees();</span>
<a href="#l22.37"></a><span id="l22.37"> </span>
<a href="#l22.38"></a><span id="l22.38">   /**</span>
<a href="#l22.39"></a><span id="l22.39">    * getAttendeeById's matching is done in a case-insensitive manner to handle</span>
<a href="#l22.40"></a><span id="l22.40">    * places where &quot;MAILTO:&quot; or similar properties are capitalized arbitrarily</span>
<a href="#l22.41"></a><span id="l22.41">    * by different calendar clients.</span>
<a href="#l22.42"></a><span id="l22.42">    */</span>
<a href="#l22.43"></a><span id="l22.43">   calIAttendee getAttendeeById(in AUTF8String id);</span>
<a href="#l22.44"></a><span id="l22.44">   void addAttendee(in calIAttendee attendee);</span>
<a href="#l22.45"></a><span id="l22.45">   void removeAttendee(in calIAttendee attendee);</span>
<a href="#l22.46"></a><span id="l22.46">   void removeAllAttendees();</span>
<a href="#l22.47"></a><span id="l22.47"> </span>
<a href="#l22.48"></a><span id="l22.48">   //</span>
<a href="#l22.49"></a><span id="l22.49">   // Attachments</span>
<a href="#l22.50"></a><span id="l22.50">   //</span>
<a href="#l22.51"></a><span id="l22.51" class="difflineminus">-  void getAttachments(out uint32_t count,</span>
<a href="#l22.52"></a><span id="l22.52" class="difflineminus">-                      [array,size_is(count),retval] out calIAttachment attachments);</span>
<a href="#l22.53"></a><span id="l22.53" class="difflineplus">+  Array&lt;calIAttachment&gt; getAttachments();</span>
<a href="#l22.54"></a><span id="l22.54">   void addAttachment(in calIAttachment attachment);</span>
<a href="#l22.55"></a><span id="l22.55">   void removeAttachment(in calIAttachment attachment);</span>
<a href="#l22.56"></a><span id="l22.56">   void removeAllAttachments();</span>
<a href="#l22.57"></a><span id="l22.57"> </span>
<a href="#l22.58"></a><span id="l22.58">   //</span>
<a href="#l22.59"></a><span id="l22.59">   // Categories</span>
<a href="#l22.60"></a><span id="l22.60">   //</span>
<a href="#l22.61"></a><span id="l22.61"> </span>
<a href="#l22.62"></a><span id="l22.62">   /**</span>
<a href="#l22.63"></a><span id="l22.63">    * Gets the array of categories this item belongs to.</span>
<a href="#l22.64"></a><span id="l22.64">    */</span>
<a href="#l22.65"></a><span id="l22.65" class="difflineminus">-  void getCategories(out uint32_t aCount,</span>
<a href="#l22.66"></a><span id="l22.66" class="difflineminus">-                     [array, size_is(aCount), retval] out wstring aCategories);</span>
<a href="#l22.67"></a><span id="l22.67" class="difflineplus">+  Array&lt;AString&gt; getCategories();</span>
<a href="#l22.68"></a><span id="l22.68"> </span>
<a href="#l22.69"></a><span id="l22.69">   /**</span>
<a href="#l22.70"></a><span id="l22.70">    * Sets the array of categories this item belongs to.</span>
<a href="#l22.71"></a><span id="l22.71">    */</span>
<a href="#l22.72"></a><span id="l22.72" class="difflineminus">-  void setCategories(in uint32_t aCount,</span>
<a href="#l22.73"></a><span id="l22.73" class="difflineminus">-                     [array, size_is(aCount)] in wstring aCategories);</span>
<a href="#l22.74"></a><span id="l22.74" class="difflineplus">+  void setCategories(in Array&lt;AString&gt; aCategories);</span>
<a href="#l22.75"></a><span id="l22.75"> </span>
<a href="#l22.76"></a><span id="l22.76">   //</span>
<a href="#l22.77"></a><span id="l22.77">   // Relations</span>
<a href="#l22.78"></a><span id="l22.78">   //</span>
<a href="#l22.79"></a><span id="l22.79"> </span>
<a href="#l22.80"></a><span id="l22.80">   /**</span>
<a href="#l22.81"></a><span id="l22.81">    * This gives back every relation where the item is neither the owner of the</span>
<a href="#l22.82"></a><span id="l22.82">    * relation nor the referred relation</span>
<a href="#l22.83"></a><span id="l22.83">    */</span>
<a href="#l22.84"></a><span id="l22.84" class="difflineminus">-  void getRelations(out uint32_t count,</span>
<a href="#l22.85"></a><span id="l22.85" class="difflineminus">-                    [array,size_is(count),retval] out calIRelation relations);</span>
<a href="#l22.86"></a><span id="l22.86" class="difflineplus">+  Array&lt;calIRelation&gt; getRelations();</span>
<a href="#l22.87"></a><span id="l22.87"> </span>
<a href="#l22.88"></a><span id="l22.88">   /**</span>
<a href="#l22.89"></a><span id="l22.89">    * Adds a relation to the item</span>
<a href="#l22.90"></a><span id="l22.90">    */</span>
<a href="#l22.91"></a><span id="l22.91">   void addRelation(in calIRelation relation);</span>
<a href="#l22.92"></a><span id="l22.92"> </span>
<a href="#l22.93"></a><span id="l22.93">   /**</span>
<a href="#l22.94"></a><span id="l22.94">    * Removes the relation for this item and the referred item</span>
<a href="#l22.95"></a><span id="l22.95" class="difflineat">@@ -326,19 +320,17 @@ interface calIItemBase : nsISupports</span>
<a href="#l22.96"></a><span id="l22.96"> </span>
<a href="#l22.97"></a><span id="l22.97">   // Occurrence querying</span>
<a href="#l22.98"></a><span id="l22.98">   //</span>
<a href="#l22.99"></a><span id="l22.99"> </span>
<a href="#l22.100"></a><span id="l22.100">   /**</span>
<a href="#l22.101"></a><span id="l22.101">    * Return a list of occurrences of this item between the given dates.  The items</span>
<a href="#l22.102"></a><span id="l22.102">    * returned are the same type as this one, as proxies.</span>
<a href="#l22.103"></a><span id="l22.103">    */</span>
<a href="#l22.104"></a><span id="l22.104" class="difflineminus">-  void getOccurrencesBetween (in calIDateTime aStartDate, in calIDateTime aEndDate,</span>
<a href="#l22.105"></a><span id="l22.105" class="difflineminus">-                              out uint32_t aCount,</span>
<a href="#l22.106"></a><span id="l22.106" class="difflineminus">-                              [array,size_is(aCount),retval] out calIItemBase aOccurrences);</span>
<a href="#l22.107"></a><span id="l22.107" class="difflineplus">+  Array&lt;calIItemBase&gt; getOccurrencesBetween(in calIDateTime aStartDate, in calIDateTime aEndDate);</span>
<a href="#l22.108"></a><span id="l22.108"> </span>
<a href="#l22.109"></a><span id="l22.109">   /**</span>
<a href="#l22.110"></a><span id="l22.110">    * If this item is a proxy or overridden item, parentItem will point upwards</span>
<a href="#l22.111"></a><span id="l22.111">    * to our parent.  Otherwise, it will point to this.</span>
<a href="#l22.112"></a><span id="l22.112">    * parentItem can thus always be used for modifyItem() calls</span>
<a href="#l22.113"></a><span id="l22.113">    * to providers.</span>
<a href="#l22.114"></a><span id="l22.114">    */</span>
<a href="#l22.115"></a><span id="l22.115">   attribute calIItemBase parentItem;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/base/src/calAlarm.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/base/src/calAlarm.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -246,24 +246,23 @@ calAlarm.prototype = {</span>
<a href="#l23.4"></a><span id="l23.4">     let alarmDate = this.mAbsoluteDate.clone();</span>
<a href="#l23.5"></a><span id="l23.5"> </span>
<a href="#l23.6"></a><span id="l23.6">     // All Day events are handled as 00:00:00</span>
<a href="#l23.7"></a><span id="l23.7">     alarmDate.isDate = false;</span>
<a href="#l23.8"></a><span id="l23.8">     alarmDate.addDuration(this.mDuration);</span>
<a href="#l23.9"></a><span id="l23.9">     return alarmDate;</span>
<a href="#l23.10"></a><span id="l23.10">   },</span>
<a href="#l23.11"></a><span id="l23.11"> </span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-  getAttendees: function(aCount) {</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+  getAttendees: function() {</span>
<a href="#l23.14"></a><span id="l23.14">     let attendees;</span>
<a href="#l23.15"></a><span id="l23.15">     if (this.action == &quot;AUDIO&quot; || this.action == &quot;DISPLAY&quot;) {</span>
<a href="#l23.16"></a><span id="l23.16">       attendees = [];</span>
<a href="#l23.17"></a><span id="l23.17">     } else {</span>
<a href="#l23.18"></a><span id="l23.18">       attendees = this.mAttendees.concat([]);</span>
<a href="#l23.19"></a><span id="l23.19">     }</span>
<a href="#l23.20"></a><span id="l23.20" class="difflineminus">-    aCount.value = attendees.length;</span>
<a href="#l23.21"></a><span id="l23.21">     return attendees;</span>
<a href="#l23.22"></a><span id="l23.22">   },</span>
<a href="#l23.23"></a><span id="l23.23"> </span>
<a href="#l23.24"></a><span id="l23.24">   addAttendee: function(aAttendee) {</span>
<a href="#l23.25"></a><span id="l23.25">     // Make sure its not duplicate</span>
<a href="#l23.26"></a><span id="l23.26">     this.deleteAttendee(aAttendee);</span>
<a href="#l23.27"></a><span id="l23.27"> </span>
<a href="#l23.28"></a><span id="l23.28">     // Now check if its valid</span>
<a href="#l23.29"></a><span id="l23.29" class="difflineat">@@ -284,26 +283,25 @@ calAlarm.prototype = {</span>
<a href="#l23.30"></a><span id="l23.30">       }</span>
<a href="#l23.31"></a><span id="l23.31">     }</span>
<a href="#l23.32"></a><span id="l23.32">   },</span>
<a href="#l23.33"></a><span id="l23.33"> </span>
<a href="#l23.34"></a><span id="l23.34">   clearAttendees: function() {</span>
<a href="#l23.35"></a><span id="l23.35">     this.mAttendees = [];</span>
<a href="#l23.36"></a><span id="l23.36">   },</span>
<a href="#l23.37"></a><span id="l23.37"> </span>
<a href="#l23.38"></a><span id="l23.38" class="difflineminus">-  getAttachments: function(aCount) {</span>
<a href="#l23.39"></a><span id="l23.39" class="difflineplus">+  getAttachments: function() {</span>
<a href="#l23.40"></a><span id="l23.40">     let attachments;</span>
<a href="#l23.41"></a><span id="l23.41">     if (this.action == &quot;AUDIO&quot;) {</span>
<a href="#l23.42"></a><span id="l23.42">       attachments = this.mAttachments.length ? [this.mAttachments[0]] : [];</span>
<a href="#l23.43"></a><span id="l23.43">     } else if (this.action == &quot;DISPLAY&quot;) {</span>
<a href="#l23.44"></a><span id="l23.44">       attachments = [];</span>
<a href="#l23.45"></a><span id="l23.45">     } else {</span>
<a href="#l23.46"></a><span id="l23.46">       attachments = this.mAttachments.concat([]);</span>
<a href="#l23.47"></a><span id="l23.47">     }</span>
<a href="#l23.48"></a><span id="l23.48" class="difflineminus">-    aCount.value = attachments.length;</span>
<a href="#l23.49"></a><span id="l23.49">     return attachments;</span>
<a href="#l23.50"></a><span id="l23.50">   },</span>
<a href="#l23.51"></a><span id="l23.51"> </span>
<a href="#l23.52"></a><span id="l23.52">   addAttachment: function(aAttachment) {</span>
<a href="#l23.53"></a><span id="l23.53">     // Make sure its not duplicate</span>
<a href="#l23.54"></a><span id="l23.54">     this.deleteAttachment(aAttachment);</span>
<a href="#l23.55"></a><span id="l23.55"> </span>
<a href="#l23.56"></a><span id="l23.56">     // Now check if its valid</span>
<a href="#l23.57"></a><span id="l23.57" class="difflineat">@@ -391,29 +389,29 @@ calAlarm.prototype = {</span>
<a href="#l23.58"></a><span id="l23.58">       durationProp.valueAsIcalString = this.repeatOffset.icalString;</span>
<a href="#l23.59"></a><span id="l23.59"> </span>
<a href="#l23.60"></a><span id="l23.60">       comp.addProperty(repeatProp);</span>
<a href="#l23.61"></a><span id="l23.61">       comp.addProperty(durationProp);</span>
<a href="#l23.62"></a><span id="l23.62">     }</span>
<a href="#l23.63"></a><span id="l23.63"> </span>
<a href="#l23.64"></a><span id="l23.64">     // Set up attendees (REQUIRED for EMAIL action)</span>
<a href="#l23.65"></a><span id="l23.65">     /* TODO should we be strict here?</span>
<a href="#l23.66"></a><span id="l23.66" class="difflineminus">-        if (this.action == &quot;EMAIL&quot; &amp;&amp; !this.getAttendees({}).length) {</span>
<a href="#l23.67"></a><span id="l23.67" class="difflineplus">+        if (this.action == &quot;EMAIL&quot; &amp;&amp; !this.getAttendees().length) {</span>
<a href="#l23.68"></a><span id="l23.68">             throw Cr.NS_ERROR_NOT_INITIALIZED;</span>
<a href="#l23.69"></a><span id="l23.69">         } */</span>
<a href="#l23.70"></a><span id="l23.70" class="difflineminus">-    for (let attendee of this.getAttendees({})) {</span>
<a href="#l23.71"></a><span id="l23.71" class="difflineplus">+    for (let attendee of this.getAttendees()) {</span>
<a href="#l23.72"></a><span id="l23.72">       comp.addProperty(attendee.icalProperty);</span>
<a href="#l23.73"></a><span id="l23.73">     }</span>
<a href="#l23.74"></a><span id="l23.74"> </span>
<a href="#l23.75"></a><span id="l23.75">     /* TODO should we be strict here?</span>
<a href="#l23.76"></a><span id="l23.76">         if (this.action == &quot;EMAIL&quot; &amp;&amp; !this.attachments.length) {</span>
<a href="#l23.77"></a><span id="l23.77">             throw Cr.NS_ERROR_NOT_INITIALIZED;</span>
<a href="#l23.78"></a><span id="l23.78">         } */</span>
<a href="#l23.79"></a><span id="l23.79"> </span>
<a href="#l23.80"></a><span id="l23.80" class="difflineminus">-    for (let attachment of this.getAttachments({})) {</span>
<a href="#l23.81"></a><span id="l23.81" class="difflineplus">+    for (let attachment of this.getAttachments()) {</span>
<a href="#l23.82"></a><span id="l23.82">       comp.addProperty(attachment.icalProperty);</span>
<a href="#l23.83"></a><span id="l23.83">     }</span>
<a href="#l23.84"></a><span id="l23.84"> </span>
<a href="#l23.85"></a><span id="l23.85">     // Set up summary (REQUIRED for EMAIL)</span>
<a href="#l23.86"></a><span id="l23.86">     if (this.summary || this.action == &quot;EMAIL&quot;) {</span>
<a href="#l23.87"></a><span id="l23.87">       let summaryProp = icssvc.createIcalProperty(&quot;SUMMARY&quot;);</span>
<a href="#l23.88"></a><span id="l23.88">       // Summary needs to have a non-empty value</span>
<a href="#l23.89"></a><span id="l23.89">       summaryProp.value = this.summary || cal.l10n.getCalString(&quot;alarmDefaultSummary&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/calendar/base/src/calAlarmService.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/calendar/base/src/calAlarmService.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -314,17 +314,17 @@ calAlarmService.prototype = {</span>
<a href="#l24.4"></a><span id="l24.4">   addAlarmsForItem: function(aItem) {</span>
<a href="#l24.5"></a><span id="l24.5">     if (cal.item.isToDo(aItem) &amp;&amp; aItem.isCompleted) {</span>
<a href="#l24.6"></a><span id="l24.6">       // If this is a task and it is completed, don't add the alarm.</span>
<a href="#l24.7"></a><span id="l24.7">       return;</span>
<a href="#l24.8"></a><span id="l24.8">     }</span>
<a href="#l24.9"></a><span id="l24.9"> </span>
<a href="#l24.10"></a><span id="l24.10">     let showMissed = Services.prefs.getBoolPref(&quot;calendar.alarms.showmissed&quot;, true);</span>
<a href="#l24.11"></a><span id="l24.11"> </span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-    let alarms = aItem.getAlarms({});</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+    let alarms = aItem.getAlarms();</span>
<a href="#l24.14"></a><span id="l24.14">     for (let alarm of alarms) {</span>
<a href="#l24.15"></a><span id="l24.15">       let alarmDate = cal.alarms.calculateAlarmDate(aItem, alarm);</span>
<a href="#l24.16"></a><span id="l24.16"> </span>
<a href="#l24.17"></a><span id="l24.17">       if (!alarmDate || alarm.action != &quot;DISPLAY&quot;) {</span>
<a href="#l24.18"></a><span id="l24.18">         // Only take care of DISPLAY alarms with an alarm date.</span>
<a href="#l24.19"></a><span id="l24.19">         continue;</span>
<a href="#l24.20"></a><span id="l24.20">       }</span>
<a href="#l24.21"></a><span id="l24.21"> </span>
<a href="#l24.22"></a><span id="l24.22" class="difflineat">@@ -396,17 +396,17 @@ calAlarmService.prototype = {</span>
<a href="#l24.23"></a><span id="l24.23">       }</span>
<a href="#l24.24"></a><span id="l24.24">     }</span>
<a href="#l24.25"></a><span id="l24.25">   },</span>
<a href="#l24.26"></a><span id="l24.26"> </span>
<a href="#l24.27"></a><span id="l24.27">   removeAlarmsForItem: function(aItem) {</span>
<a href="#l24.28"></a><span id="l24.28">     // make sure already fired alarms are purged out of the alarm window:</span>
<a href="#l24.29"></a><span id="l24.29">     this.mObservers.notify(&quot;onRemoveAlarmsByItem&quot;, [aItem]);</span>
<a href="#l24.30"></a><span id="l24.30">     // Purge alarms specifically for this item (i.e exception)</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineminus">-    for (let alarm of aItem.getAlarms({})) {</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineplus">+    for (let alarm of aItem.getAlarms()) {</span>
<a href="#l24.33"></a><span id="l24.33">       this.removeTimer(aItem, alarm);</span>
<a href="#l24.34"></a><span id="l24.34">     }</span>
<a href="#l24.35"></a><span id="l24.35">   },</span>
<a href="#l24.36"></a><span id="l24.36"> </span>
<a href="#l24.37"></a><span id="l24.37">   getOccurrencesInRange: function(aItem) {</span>
<a href="#l24.38"></a><span id="l24.38">     // We search 1 month in each direction for alarms.  Therefore,</span>
<a href="#l24.39"></a><span id="l24.39">     // we need occurrences between initial start date and 1 month from now</span>
<a href="#l24.40"></a><span id="l24.40">     let until = nowUTC();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/base/src/calFilter.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/base/src/calFilter.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -382,17 +382,17 @@ calFilter.prototype = {</span>
<a href="#l25.4"></a><span id="l25.4">     // TODO: Support specifying which fields to search on</span>
<a href="#l25.5"></a><span id="l25.5">     for (let field of [&quot;SUMMARY&quot;, &quot;DESCRIPTION&quot;, &quot;LOCATION&quot;, &quot;URL&quot;]) {</span>
<a href="#l25.6"></a><span id="l25.6">       let val = aItem.getProperty(field);</span>
<a href="#l25.7"></a><span id="l25.7">       if (val &amp;&amp; val.toLowerCase().includes(searchText)) {</span>
<a href="#l25.8"></a><span id="l25.8">         return true;</span>
<a href="#l25.9"></a><span id="l25.9">       }</span>
<a href="#l25.10"></a><span id="l25.10">     }</span>
<a href="#l25.11"></a><span id="l25.11"> </span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-    return aItem.getCategories({}).some(cat =&gt; cat.toLowerCase().includes(searchText));</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+    return aItem.getCategories().some(cat =&gt; cat.toLowerCase().includes(searchText));</span>
<a href="#l25.14"></a><span id="l25.14">   },</span>
<a href="#l25.15"></a><span id="l25.15"> </span>
<a href="#l25.16"></a><span id="l25.16">   /**</span>
<a href="#l25.17"></a><span id="l25.17">    * Checks if the item matches the current filter date range.</span>
<a href="#l25.18"></a><span id="l25.18">    *</span>
<a href="#l25.19"></a><span id="l25.19">    * @param aItem               The item to check.</span>
<a href="#l25.20"></a><span id="l25.20">    * @return                    Returns true if the item falls within the date range</span>
<a href="#l25.21"></a><span id="l25.21">    *                            specified by mStartDate and mEndDate, false otherwise.</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineat">@@ -438,17 +438,17 @@ calFilter.prototype = {</span>
<a href="#l25.23"></a><span id="l25.23">     if (result &amp;&amp; props.category) {</span>
<a href="#l25.24"></a><span id="l25.24">       let cats = [];</span>
<a href="#l25.25"></a><span id="l25.25"> </span>
<a href="#l25.26"></a><span id="l25.26">       if (typeof props.category == &quot;string&quot;) {</span>
<a href="#l25.27"></a><span id="l25.27">         cats.push(props.category);</span>
<a href="#l25.28"></a><span id="l25.28">       } else if (Array.isArray(props.category)) {</span>
<a href="#l25.29"></a><span id="l25.29">         cats = props.category;</span>
<a href="#l25.30"></a><span id="l25.30">       }</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineminus">-      result = cats.some(cat =&gt; aItem.getCategories({}).includes(cat));</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineplus">+      result = cats.some(cat =&gt; aItem.getCategories().includes(cat));</span>
<a href="#l25.33"></a><span id="l25.33">     }</span>
<a href="#l25.34"></a><span id="l25.34"> </span>
<a href="#l25.35"></a><span id="l25.35">     // test the status property. Only applies to tasks.</span>
<a href="#l25.36"></a><span id="l25.36">     if (result &amp;&amp; props.status != null &amp;&amp; cal.item.isToDo(aItem)) {</span>
<a href="#l25.37"></a><span id="l25.37">       let completed = aItem.isCompleted;</span>
<a href="#l25.38"></a><span id="l25.38">       let current = !aItem.completedDate || today.compare(aItem.completedDate) &lt;= 0;</span>
<a href="#l25.39"></a><span id="l25.39">       let percent = aItem.percentComplete || 0;</span>
<a href="#l25.40"></a><span id="l25.40"> </span>
<a href="#l25.41"></a><span id="l25.41" class="difflineat">@@ -847,18 +847,17 @@ calFilter.prototype = {</span>
<a href="#l25.42"></a><span id="l25.42">     ) {</span>
<a href="#l25.43"></a><span id="l25.43">       // either this isn't a repeating item, the occurrence filter specifies that</span>
<a href="#l25.44"></a><span id="l25.44">       // we don't want occurrences, or we have a default occurrence filter with an</span>
<a href="#l25.45"></a><span id="l25.45">       // unbound date range, so we return just the unexpanded item.</span>
<a href="#l25.46"></a><span id="l25.46">       occs = [aItem];</span>
<a href="#l25.47"></a><span id="l25.47">     } else {</span>
<a href="#l25.48"></a><span id="l25.48">       occs = aItem.getOccurrencesBetween(</span>
<a href="#l25.49"></a><span id="l25.49">         this.mStartDate || cal.createDateTime(),</span>
<a href="#l25.50"></a><span id="l25.50" class="difflineminus">-        this.mEndDate || cal.dtz.now(),</span>
<a href="#l25.51"></a><span id="l25.51" class="difflineminus">-        {}</span>
<a href="#l25.52"></a><span id="l25.52" class="difflineplus">+        this.mEndDate || cal.dtz.now()</span>
<a href="#l25.53"></a><span id="l25.53">       );</span>
<a href="#l25.54"></a><span id="l25.54">       if (props.occurrences == props.FILTER_OCCURRENCES_PAST_AND_NEXT &amp;&amp; !this.mEndDate) {</span>
<a href="#l25.55"></a><span id="l25.55">         // we have an unbound date range and the occurrence filter specifies</span>
<a href="#l25.56"></a><span id="l25.56">         // that we also want the next matching occurrence if available.</span>
<a href="#l25.57"></a><span id="l25.57">         let next = this.getNextOccurrence(aItem);</span>
<a href="#l25.58"></a><span id="l25.58">         if (next) {</span>
<a href="#l25.59"></a><span id="l25.59">           occs.push(next);</span>
<a href="#l25.60"></a><span id="l25.60">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/calendar/base/src/calItemBase.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/calendar/base/src/calItemBase.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -268,17 +268,17 @@ calItemBase.prototype = {</span>
<a href="#l26.4"></a><span id="l26.4"> </span>
<a href="#l26.5"></a><span id="l26.5">     let org = this.organizer;</span>
<a href="#l26.6"></a><span id="l26.6">     if (org) {</span>
<a href="#l26.7"></a><span id="l26.7">       org = org.clone();</span>
<a href="#l26.8"></a><span id="l26.8">     }</span>
<a href="#l26.9"></a><span id="l26.9">     cloned.mOrganizer = org;</span>
<a href="#l26.10"></a><span id="l26.10"> </span>
<a href="#l26.11"></a><span id="l26.11">     cloned.mAttendees = [];</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-    for (let att of this.getAttendees({})) {</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+    for (let att of this.getAttendees()) {</span>
<a href="#l26.14"></a><span id="l26.14">       cloned.mAttendees.push(att.clone());</span>
<a href="#l26.15"></a><span id="l26.15">     }</span>
<a href="#l26.16"></a><span id="l26.16"> </span>
<a href="#l26.17"></a><span id="l26.17">     cloned.mProperties = new Map();</span>
<a href="#l26.18"></a><span id="l26.18">     for (let [name, value] of this.mProperties.entries()) {</span>
<a href="#l26.19"></a><span id="l26.19">       if (value instanceof Ci.calIDateTime) {</span>
<a href="#l26.20"></a><span id="l26.20">         value = value.clone();</span>
<a href="#l26.21"></a><span id="l26.21">       }</span>
<a href="#l26.22"></a><span id="l26.22" class="difflineat">@@ -291,29 +291,29 @@ calItemBase.prototype = {</span>
<a href="#l26.23"></a><span id="l26.23">         for (let param in propBucket) {</span>
<a href="#l26.24"></a><span id="l26.24">           newBucket[param] = propBucket[param];</span>
<a href="#l26.25"></a><span id="l26.25">         }</span>
<a href="#l26.26"></a><span id="l26.26">         cloned.mPropertyParams[name] = newBucket;</span>
<a href="#l26.27"></a><span id="l26.27">       }</span>
<a href="#l26.28"></a><span id="l26.28">     }</span>
<a href="#l26.29"></a><span id="l26.29"> </span>
<a href="#l26.30"></a><span id="l26.30">     cloned.mAttachments = [];</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineminus">-    for (let att of this.getAttachments({})) {</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineplus">+    for (let att of this.getAttachments()) {</span>
<a href="#l26.33"></a><span id="l26.33">       cloned.mAttachments.push(att.clone());</span>
<a href="#l26.34"></a><span id="l26.34">     }</span>
<a href="#l26.35"></a><span id="l26.35"> </span>
<a href="#l26.36"></a><span id="l26.36">     cloned.mRelations = [];</span>
<a href="#l26.37"></a><span id="l26.37" class="difflineminus">-    for (let rel of this.getRelations({})) {</span>
<a href="#l26.38"></a><span id="l26.38" class="difflineplus">+    for (let rel of this.getRelations()) {</span>
<a href="#l26.39"></a><span id="l26.39">       cloned.mRelations.push(rel.clone());</span>
<a href="#l26.40"></a><span id="l26.40">     }</span>
<a href="#l26.41"></a><span id="l26.41"> </span>
<a href="#l26.42"></a><span id="l26.42" class="difflineminus">-    cloned.mCategories = this.getCategories({});</span>
<a href="#l26.43"></a><span id="l26.43" class="difflineplus">+    cloned.mCategories = this.getCategories();</span>
<a href="#l26.44"></a><span id="l26.44"> </span>
<a href="#l26.45"></a><span id="l26.45">     cloned.mAlarms = [];</span>
<a href="#l26.46"></a><span id="l26.46" class="difflineminus">-    for (let alarm of this.getAlarms({})) {</span>
<a href="#l26.47"></a><span id="l26.47" class="difflineplus">+    for (let alarm of this.getAlarms()) {</span>
<a href="#l26.48"></a><span id="l26.48">       // Clone alarms into new item, assume the alarms from the old item</span>
<a href="#l26.49"></a><span id="l26.49">       // are valid and don't need validation.</span>
<a href="#l26.50"></a><span id="l26.50">       cloned.mAlarms.push(alarm.clone());</span>
<a href="#l26.51"></a><span id="l26.51">     }</span>
<a href="#l26.52"></a><span id="l26.52"> </span>
<a href="#l26.53"></a><span id="l26.53">     let alarmLastAck = this.alarmLastAck;</span>
<a href="#l26.54"></a><span id="l26.54">     if (alarmLastAck) {</span>
<a href="#l26.55"></a><span id="l26.55">       alarmLastAck = alarmLastAck.clone();</span>
<a href="#l26.56"></a><span id="l26.56" class="difflineat">@@ -478,49 +478,47 @@ calItemBase.prototype = {</span>
<a href="#l26.57"></a><span id="l26.57">           value: parameters[paramName],</span>
<a href="#l26.58"></a><span id="l26.58">         };</span>
<a href="#l26.59"></a><span id="l26.59">       },</span>
<a href="#l26.60"></a><span id="l26.60">     };</span>
<a href="#l26.61"></a><span id="l26.61">   },</span>
<a href="#l26.62"></a><span id="l26.62"> </span>
<a href="#l26.63"></a><span id="l26.63">   // void getAttendees(out PRUint32 count,</span>
<a href="#l26.64"></a><span id="l26.64">   //                   [array,size_is(count),retval] out calIAttendee attendees);</span>
<a href="#l26.65"></a><span id="l26.65" class="difflineminus">-  getAttendees: function(countObj) {</span>
<a href="#l26.66"></a><span id="l26.66" class="difflineplus">+  getAttendees: function() {</span>
<a href="#l26.67"></a><span id="l26.67">     if (!this.mAttendees &amp;&amp; this.mIsProxy) {</span>
<a href="#l26.68"></a><span id="l26.68" class="difflineminus">-      this.mAttendees = this.mParentItem.getAttendees(countObj);</span>
<a href="#l26.69"></a><span id="l26.69" class="difflineplus">+      this.mAttendees = this.mParentItem.getAttendees();</span>
<a href="#l26.70"></a><span id="l26.70">     }</span>
<a href="#l26.71"></a><span id="l26.71">     if (this.mAttendees) {</span>
<a href="#l26.72"></a><span id="l26.72" class="difflineminus">-      countObj.value = this.mAttendees.length;</span>
<a href="#l26.73"></a><span id="l26.73">       return this.mAttendees.concat([]); // clone</span>
<a href="#l26.74"></a><span id="l26.74">     } else {</span>
<a href="#l26.75"></a><span id="l26.75" class="difflineminus">-      countObj.value = 0;</span>
<a href="#l26.76"></a><span id="l26.76">       return [];</span>
<a href="#l26.77"></a><span id="l26.77">     }</span>
<a href="#l26.78"></a><span id="l26.78">   },</span>
<a href="#l26.79"></a><span id="l26.79"> </span>
<a href="#l26.80"></a><span id="l26.80">   // calIAttendee getAttendeeById(in AUTF8String id);</span>
<a href="#l26.81"></a><span id="l26.81">   getAttendeeById: function(id) {</span>
<a href="#l26.82"></a><span id="l26.82" class="difflineminus">-    let attendees = this.getAttendees({});</span>
<a href="#l26.83"></a><span id="l26.83" class="difflineplus">+    let attendees = this.getAttendees();</span>
<a href="#l26.84"></a><span id="l26.84">     let lowerCaseId = id.toLowerCase();</span>
<a href="#l26.85"></a><span id="l26.85">     for (let attendee of attendees) {</span>
<a href="#l26.86"></a><span id="l26.86">       // This match must be case insensitive to deal with differing</span>
<a href="#l26.87"></a><span id="l26.87">       // cases of things like MAILTO:</span>
<a href="#l26.88"></a><span id="l26.88">       if (attendee.id.toLowerCase() == lowerCaseId) {</span>
<a href="#l26.89"></a><span id="l26.89">         return attendee;</span>
<a href="#l26.90"></a><span id="l26.90">       }</span>
<a href="#l26.91"></a><span id="l26.91">     }</span>
<a href="#l26.92"></a><span id="l26.92">     return null;</span>
<a href="#l26.93"></a><span id="l26.93">   },</span>
<a href="#l26.94"></a><span id="l26.94"> </span>
<a href="#l26.95"></a><span id="l26.95">   // void removeAttendee(in calIAttendee attendee);</span>
<a href="#l26.96"></a><span id="l26.96">   removeAttendee: function(attendee) {</span>
<a href="#l26.97"></a><span id="l26.97">     this.modify();</span>
<a href="#l26.98"></a><span id="l26.98">     let found = false,</span>
<a href="#l26.99"></a><span id="l26.99">       newAttendees = [];</span>
<a href="#l26.100"></a><span id="l26.100" class="difflineminus">-    let attendees = this.getAttendees({});</span>
<a href="#l26.101"></a><span id="l26.101" class="difflineplus">+    let attendees = this.getAttendees();</span>
<a href="#l26.102"></a><span id="l26.102">     let attIdLowerCase = attendee.id.toLowerCase();</span>
<a href="#l26.103"></a><span id="l26.103"> </span>
<a href="#l26.104"></a><span id="l26.104">     for (let i = 0; i &lt; attendees.length; i++) {</span>
<a href="#l26.105"></a><span id="l26.105">       if (attendees[i].id.toLowerCase() == attIdLowerCase) {</span>
<a href="#l26.106"></a><span id="l26.106">         found = true;</span>
<a href="#l26.107"></a><span id="l26.107">       } else {</span>
<a href="#l26.108"></a><span id="l26.108">         newAttendees.push(attendees[i]);</span>
<a href="#l26.109"></a><span id="l26.109">       }</span>
<a href="#l26.110"></a><span id="l26.110" class="difflineat">@@ -569,32 +567,29 @@ calItemBase.prototype = {</span>
<a href="#l26.111"></a><span id="l26.111">                 attendee.toString() +</span>
<a href="#l26.112"></a><span id="l26.112">                 &quot;\n&quot; +</span>
<a href="#l26.113"></a><span id="l26.113">                 cal.STACK(20)</span>
<a href="#l26.114"></a><span id="l26.114">             );</span>
<a href="#l26.115"></a><span id="l26.115">           }</span>
<a href="#l26.116"></a><span id="l26.116">         }</span>
<a href="#l26.117"></a><span id="l26.117">       }</span>
<a href="#l26.118"></a><span id="l26.118">       this.modify();</span>
<a href="#l26.119"></a><span id="l26.119" class="difflineminus">-      this.mAttendees = this.getAttendees({});</span>
<a href="#l26.120"></a><span id="l26.120" class="difflineplus">+      this.mAttendees = this.getAttendees();</span>
<a href="#l26.121"></a><span id="l26.121">       this.mAttendees.push(attendee);</span>
<a href="#l26.122"></a><span id="l26.122">     }</span>
<a href="#l26.123"></a><span id="l26.123">   },</span>
<a href="#l26.124"></a><span id="l26.124"> </span>
<a href="#l26.125"></a><span id="l26.125" class="difflineminus">-  // void getAttachments(out PRUint32 count,</span>
<a href="#l26.126"></a><span id="l26.126" class="difflineminus">-  //                     [array,size_is(count),retval] out calIAttachment attachments);</span>
<a href="#l26.127"></a><span id="l26.127" class="difflineminus">-  getAttachments: function(aCount) {</span>
<a href="#l26.128"></a><span id="l26.128" class="difflineplus">+  // Array&lt;calIAttachment&gt; getAttachments();</span>
<a href="#l26.129"></a><span id="l26.129" class="difflineplus">+  getAttachments: function() {</span>
<a href="#l26.130"></a><span id="l26.130">     if (!this.mAttachments &amp;&amp; this.mIsProxy) {</span>
<a href="#l26.131"></a><span id="l26.131" class="difflineminus">-      this.mAttachments = this.mParentItem.getAttachments(aCount);</span>
<a href="#l26.132"></a><span id="l26.132" class="difflineplus">+      this.mAttachments = this.mParentItem.getAttachments();</span>
<a href="#l26.133"></a><span id="l26.133">     }</span>
<a href="#l26.134"></a><span id="l26.134">     if (this.mAttachments) {</span>
<a href="#l26.135"></a><span id="l26.135" class="difflineminus">-      aCount.value = this.mAttachments.length;</span>
<a href="#l26.136"></a><span id="l26.136">       return this.mAttachments.concat([]); // clone</span>
<a href="#l26.137"></a><span id="l26.137">     } else {</span>
<a href="#l26.138"></a><span id="l26.138" class="difflineminus">-      aCount.value = 0;</span>
<a href="#l26.139"></a><span id="l26.139">       return [];</span>
<a href="#l26.140"></a><span id="l26.140">     }</span>
<a href="#l26.141"></a><span id="l26.141">   },</span>
<a href="#l26.142"></a><span id="l26.142"> </span>
<a href="#l26.143"></a><span id="l26.143">   // void removeAttachment(in calIAttachment attachment);</span>
<a href="#l26.144"></a><span id="l26.144">   removeAttachment: function(aAttachment) {</span>
<a href="#l26.145"></a><span id="l26.145">     this.modify();</span>
<a href="#l26.146"></a><span id="l26.146">     for (let attIndex in this.mAttachments) {</span>
<a href="#l26.147"></a><span id="l26.147" class="difflineat">@@ -604,39 +599,36 @@ calItemBase.prototype = {</span>
<a href="#l26.148"></a><span id="l26.148">         break;</span>
<a href="#l26.149"></a><span id="l26.149">       }</span>
<a href="#l26.150"></a><span id="l26.150">     }</span>
<a href="#l26.151"></a><span id="l26.151">   },</span>
<a href="#l26.152"></a><span id="l26.152"> </span>
<a href="#l26.153"></a><span id="l26.153">   // void addAttachment(in calIAttachment attachment);</span>
<a href="#l26.154"></a><span id="l26.154">   addAttachment: function(attachment) {</span>
<a href="#l26.155"></a><span id="l26.155">     this.modify();</span>
<a href="#l26.156"></a><span id="l26.156" class="difflineminus">-    this.mAttachments = this.getAttachments({});</span>
<a href="#l26.157"></a><span id="l26.157" class="difflineplus">+    this.mAttachments = this.getAttachments();</span>
<a href="#l26.158"></a><span id="l26.158">     if (!this.mAttachments.some(x =&gt; x.hashId == attachment.hashId)) {</span>
<a href="#l26.159"></a><span id="l26.159">       this.mAttachments.push(attachment);</span>
<a href="#l26.160"></a><span id="l26.160">     }</span>
<a href="#l26.161"></a><span id="l26.161">   },</span>
<a href="#l26.162"></a><span id="l26.162"> </span>
<a href="#l26.163"></a><span id="l26.163">   // void removeAllAttachments();</span>
<a href="#l26.164"></a><span id="l26.164">   removeAllAttachments: function() {</span>
<a href="#l26.165"></a><span id="l26.165">     this.modify();</span>
<a href="#l26.166"></a><span id="l26.166">     this.mAttachments = [];</span>
<a href="#l26.167"></a><span id="l26.167">   },</span>
<a href="#l26.168"></a><span id="l26.168"> </span>
<a href="#l26.169"></a><span id="l26.169" class="difflineminus">-  // void getRelations(out PRUint32 count,</span>
<a href="#l26.170"></a><span id="l26.170" class="difflineminus">-  //                   [array,size_is(count),retval] out calIRelation relations);</span>
<a href="#l26.171"></a><span id="l26.171" class="difflineminus">-  getRelations: function(aCount) {</span>
<a href="#l26.172"></a><span id="l26.172" class="difflineplus">+  // Array&lt;calIRelation&gt; getRelations();</span>
<a href="#l26.173"></a><span id="l26.173" class="difflineplus">+  getRelations: function() {</span>
<a href="#l26.174"></a><span id="l26.174">     if (!this.mRelations &amp;&amp; this.mIsProxy) {</span>
<a href="#l26.175"></a><span id="l26.175" class="difflineminus">-      this.mRelations = this.mParentItem.getRelations(aCount);</span>
<a href="#l26.176"></a><span id="l26.176" class="difflineplus">+      this.mRelations = this.mParentItem.getRelations();</span>
<a href="#l26.177"></a><span id="l26.177">     }</span>
<a href="#l26.178"></a><span id="l26.178">     if (this.mRelations) {</span>
<a href="#l26.179"></a><span id="l26.179" class="difflineminus">-      aCount.value = this.mRelations.length;</span>
<a href="#l26.180"></a><span id="l26.180">       return this.mRelations.concat([]);</span>
<a href="#l26.181"></a><span id="l26.181">     } else {</span>
<a href="#l26.182"></a><span id="l26.182" class="difflineminus">-      aCount.value = 0;</span>
<a href="#l26.183"></a><span id="l26.183">       return [];</span>
<a href="#l26.184"></a><span id="l26.184">     }</span>
<a href="#l26.185"></a><span id="l26.185">   },</span>
<a href="#l26.186"></a><span id="l26.186"> </span>
<a href="#l26.187"></a><span id="l26.187">   // void removeRelation(in calIRelation relation);</span>
<a href="#l26.188"></a><span id="l26.188">   removeRelation: function(aRelation) {</span>
<a href="#l26.189"></a><span id="l26.189">     this.modify();</span>
<a href="#l26.190"></a><span id="l26.190">     for (let attIndex in this.mRelations) {</span>
<a href="#l26.191"></a><span id="l26.191" class="difflineat">@@ -650,17 +642,17 @@ calItemBase.prototype = {</span>
<a href="#l26.192"></a><span id="l26.192">         break;</span>
<a href="#l26.193"></a><span id="l26.193">       }</span>
<a href="#l26.194"></a><span id="l26.194">     }</span>
<a href="#l26.195"></a><span id="l26.195">   },</span>
<a href="#l26.196"></a><span id="l26.196"> </span>
<a href="#l26.197"></a><span id="l26.197">   // void addRelation(in calIRelation relation);</span>
<a href="#l26.198"></a><span id="l26.198">   addRelation: function(aRelation) {</span>
<a href="#l26.199"></a><span id="l26.199">     this.modify();</span>
<a href="#l26.200"></a><span id="l26.200" class="difflineminus">-    this.mRelations = this.getRelations({});</span>
<a href="#l26.201"></a><span id="l26.201" class="difflineplus">+    this.mRelations = this.getRelations();</span>
<a href="#l26.202"></a><span id="l26.202">     this.mRelations.push(aRelation);</span>
<a href="#l26.203"></a><span id="l26.203">     // XXX ensure that the relation isn't already there?</span>
<a href="#l26.204"></a><span id="l26.204">   },</span>
<a href="#l26.205"></a><span id="l26.205"> </span>
<a href="#l26.206"></a><span id="l26.206">   // void removeAllRelations();</span>
<a href="#l26.207"></a><span id="l26.207">   removeAllRelations: function() {</span>
<a href="#l26.208"></a><span id="l26.208">     this.modify();</span>
<a href="#l26.209"></a><span id="l26.209">     this.mRelations = [];</span>
<a href="#l26.210"></a><span id="l26.210" class="difflineat">@@ -690,34 +682,30 @@ calItemBase.prototype = {</span>
<a href="#l26.211"></a><span id="l26.211">       return this.mOrganizer;</span>
<a href="#l26.212"></a><span id="l26.212">     }</span>
<a href="#l26.213"></a><span id="l26.213">   },</span>
<a href="#l26.214"></a><span id="l26.214">   set organizer(organizer) {</span>
<a href="#l26.215"></a><span id="l26.215">     this.modify();</span>
<a href="#l26.216"></a><span id="l26.216">     this.mOrganizer = organizer;</span>
<a href="#l26.217"></a><span id="l26.217">   },</span>
<a href="#l26.218"></a><span id="l26.218"> </span>
<a href="#l26.219"></a><span id="l26.219" class="difflineminus">-  // void getCategories(out PRUint32 aCount,</span>
<a href="#l26.220"></a><span id="l26.220" class="difflineminus">-  //                    [array, size_is(aCount), retval] out wstring aCategories);</span>
<a href="#l26.221"></a><span id="l26.221" class="difflineminus">-  getCategories: function(aCount) {</span>
<a href="#l26.222"></a><span id="l26.222" class="difflineplus">+  // Array&lt;AString&gt; getCategories();</span>
<a href="#l26.223"></a><span id="l26.223" class="difflineplus">+  getCategories: function() {</span>
<a href="#l26.224"></a><span id="l26.224">     if (!this.mCategories &amp;&amp; this.mIsProxy) {</span>
<a href="#l26.225"></a><span id="l26.225" class="difflineminus">-      this.mCategories = this.mParentItem.getCategories(aCount);</span>
<a href="#l26.226"></a><span id="l26.226" class="difflineplus">+      this.mCategories = this.mParentItem.getCategories();</span>
<a href="#l26.227"></a><span id="l26.227">     }</span>
<a href="#l26.228"></a><span id="l26.228">     if (this.mCategories) {</span>
<a href="#l26.229"></a><span id="l26.229" class="difflineminus">-      aCount.value = this.mCategories.length;</span>
<a href="#l26.230"></a><span id="l26.230">       return this.mCategories.concat([]); // clone</span>
<a href="#l26.231"></a><span id="l26.231">     } else {</span>
<a href="#l26.232"></a><span id="l26.232" class="difflineminus">-      aCount.value = 0;</span>
<a href="#l26.233"></a><span id="l26.233">       return [];</span>
<a href="#l26.234"></a><span id="l26.234">     }</span>
<a href="#l26.235"></a><span id="l26.235">   },</span>
<a href="#l26.236"></a><span id="l26.236"> </span>
<a href="#l26.237"></a><span id="l26.237" class="difflineminus">-  // void setCategories(in PRUint32 aCount,</span>
<a href="#l26.238"></a><span id="l26.238" class="difflineminus">-  //                    [array, size_is(aCount)] in wstring aCategories);</span>
<a href="#l26.239"></a><span id="l26.239" class="difflineminus">-  setCategories: function(aCount, aCategories) {</span>
<a href="#l26.240"></a><span id="l26.240" class="difflineplus">+  // void setCategories(in Array&lt;AString&gt; aCategories);</span>
<a href="#l26.241"></a><span id="l26.241" class="difflineplus">+  setCategories: function(aCategories) {</span>
<a href="#l26.242"></a><span id="l26.242">     this.modify();</span>
<a href="#l26.243"></a><span id="l26.243">     this.mCategories = aCategories.concat([]);</span>
<a href="#l26.244"></a><span id="l26.244">   },</span>
<a href="#l26.245"></a><span id="l26.245"> </span>
<a href="#l26.246"></a><span id="l26.246">   // attribute AUTF8String icalString;</span>
<a href="#l26.247"></a><span id="l26.247">   get icalString() {</span>
<a href="#l26.248"></a><span id="l26.248">     throw Cr.NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l26.249"></a><span id="l26.249">   },</span>
<a href="#l26.250"></a><span id="l26.250" class="difflineat">@@ -963,35 +951,35 @@ calItemBase.prototype = {</span>
<a href="#l26.251"></a><span id="l26.251"> </span>
<a href="#l26.252"></a><span id="l26.252">     this.mapPropsToICS(icalcomp, this.icsBasePropMap);</span>
<a href="#l26.253"></a><span id="l26.253"> </span>
<a href="#l26.254"></a><span id="l26.254">     let org = this.organizer;</span>
<a href="#l26.255"></a><span id="l26.255">     if (org) {</span>
<a href="#l26.256"></a><span id="l26.256">       icalcomp.addProperty(org.icalProperty);</span>
<a href="#l26.257"></a><span id="l26.257">     }</span>
<a href="#l26.258"></a><span id="l26.258"> </span>
<a href="#l26.259"></a><span id="l26.259" class="difflineminus">-    for (let attendee of this.getAttendees({})) {</span>
<a href="#l26.260"></a><span id="l26.260" class="difflineplus">+    for (let attendee of this.getAttendees()) {</span>
<a href="#l26.261"></a><span id="l26.261">       icalcomp.addProperty(attendee.icalProperty);</span>
<a href="#l26.262"></a><span id="l26.262">     }</span>
<a href="#l26.263"></a><span id="l26.263"> </span>
<a href="#l26.264"></a><span id="l26.264" class="difflineminus">-    for (let attachment of this.getAttachments({})) {</span>
<a href="#l26.265"></a><span id="l26.265" class="difflineplus">+    for (let attachment of this.getAttachments()) {</span>
<a href="#l26.266"></a><span id="l26.266">       icalcomp.addProperty(attachment.icalProperty);</span>
<a href="#l26.267"></a><span id="l26.267">     }</span>
<a href="#l26.268"></a><span id="l26.268"> </span>
<a href="#l26.269"></a><span id="l26.269" class="difflineminus">-    for (let relation of this.getRelations({})) {</span>
<a href="#l26.270"></a><span id="l26.270" class="difflineplus">+    for (let relation of this.getRelations()) {</span>
<a href="#l26.271"></a><span id="l26.271">       icalcomp.addProperty(relation.icalProperty);</span>
<a href="#l26.272"></a><span id="l26.272">     }</span>
<a href="#l26.273"></a><span id="l26.273"> </span>
<a href="#l26.274"></a><span id="l26.274">     if (this.mRecurrenceInfo) {</span>
<a href="#l26.275"></a><span id="l26.275">       for (let ritem of this.mRecurrenceInfo.getRecurrenceItems({})) {</span>
<a href="#l26.276"></a><span id="l26.276">         icalcomp.addProperty(ritem.icalProperty);</span>
<a href="#l26.277"></a><span id="l26.277">       }</span>
<a href="#l26.278"></a><span id="l26.278">     }</span>
<a href="#l26.279"></a><span id="l26.279"> </span>
<a href="#l26.280"></a><span id="l26.280" class="difflineminus">-    for (let cat of this.getCategories({})) {</span>
<a href="#l26.281"></a><span id="l26.281" class="difflineplus">+    for (let cat of this.getCategories()) {</span>
<a href="#l26.282"></a><span id="l26.282">       let catprop = icssvc.createIcalProperty(&quot;CATEGORIES&quot;);</span>
<a href="#l26.283"></a><span id="l26.283">       catprop.value = cat;</span>
<a href="#l26.284"></a><span id="l26.284">       icalcomp.addProperty(catprop);</span>
<a href="#l26.285"></a><span id="l26.285">     }</span>
<a href="#l26.286"></a><span id="l26.286"> </span>
<a href="#l26.287"></a><span id="l26.287">     if (this.mAlarms) {</span>
<a href="#l26.288"></a><span id="l26.288">       for (let alarm of this.mAlarms) {</span>
<a href="#l26.289"></a><span id="l26.289">         icalcomp.addSubcomponent(alarm.icalComponent);</span>
<a href="#l26.290"></a><span id="l26.290" class="difflineat">@@ -1002,30 +990,24 @@ calItemBase.prototype = {</span>
<a href="#l26.291"></a><span id="l26.291">     if (alarmLastAck) {</span>
<a href="#l26.292"></a><span id="l26.292">       let lastAck = cal.getIcsService().createIcalProperty(&quot;X-MOZ-LASTACK&quot;);</span>
<a href="#l26.293"></a><span id="l26.293">       // - should we further ensure that those are UTC or rely on calAlarmService doing so?</span>
<a href="#l26.294"></a><span id="l26.294">       lastAck.value = alarmLastAck.icalString;</span>
<a href="#l26.295"></a><span id="l26.295">       icalcomp.addProperty(lastAck);</span>
<a href="#l26.296"></a><span id="l26.296">     }</span>
<a href="#l26.297"></a><span id="l26.297">   },</span>
<a href="#l26.298"></a><span id="l26.298"> </span>
<a href="#l26.299"></a><span id="l26.299" class="difflineminus">-  // void getAlarms(out PRUint32 count, [array, size_is(count), retval] out calIAlarm aAlarms);</span>
<a href="#l26.300"></a><span id="l26.300" class="difflineminus">-  getAlarms: function(aCount) {</span>
<a href="#l26.301"></a><span id="l26.301" class="difflineminus">-    if (typeof aCount != &quot;object&quot;) {</span>
<a href="#l26.302"></a><span id="l26.302" class="difflineminus">-      throw Cr.NS_ERROR_XPC_NEED_OUT_OBJECT;</span>
<a href="#l26.303"></a><span id="l26.303" class="difflineminus">-    }</span>
<a href="#l26.304"></a><span id="l26.304" class="difflineminus">-</span>
<a href="#l26.305"></a><span id="l26.305" class="difflineplus">+  // Array&lt;calIAlarm&gt; getAlarms();</span>
<a href="#l26.306"></a><span id="l26.306" class="difflineplus">+  getAlarms: function() {</span>
<a href="#l26.307"></a><span id="l26.307">     if (!this.mAlarms &amp;&amp; this.mIsProxy) {</span>
<a href="#l26.308"></a><span id="l26.308" class="difflineminus">-      this.mAlarms = this.mParentItem.getAlarms(aCount);</span>
<a href="#l26.309"></a><span id="l26.309" class="difflineplus">+      this.mAlarms = this.mParentItem.getAlarms();</span>
<a href="#l26.310"></a><span id="l26.310">     }</span>
<a href="#l26.311"></a><span id="l26.311">     if (this.mAlarms) {</span>
<a href="#l26.312"></a><span id="l26.312" class="difflineminus">-      aCount.value = this.mAlarms.length;</span>
<a href="#l26.313"></a><span id="l26.313">       return this.mAlarms.concat([]); // clone</span>
<a href="#l26.314"></a><span id="l26.314">     } else {</span>
<a href="#l26.315"></a><span id="l26.315" class="difflineminus">-      aCount.value = 0;</span>
<a href="#l26.316"></a><span id="l26.316">       return [];</span>
<a href="#l26.317"></a><span id="l26.317">     }</span>
<a href="#l26.318"></a><span id="l26.318">   },</span>
<a href="#l26.319"></a><span id="l26.319"> </span>
<a href="#l26.320"></a><span id="l26.320">   /**</span>
<a href="#l26.321"></a><span id="l26.321">    * Adds an alarm. The second parameter is for internal use only, i.e not</span>
<a href="#l26.322"></a><span id="l26.322">    * provided on the interface.</span>
<a href="#l26.323"></a><span id="l26.323">    *</span>
<a href="#l26.324"></a><span id="l26.324" class="difflineat">@@ -1039,52 +1021,48 @@ calItemBase.prototype = {</span>
<a href="#l26.325"></a><span id="l26.325">         // Trigger the icalComponent getter to make sure the alarm is valid.</span>
<a href="#l26.326"></a><span id="l26.326">         aAlarm.icalComponent; // eslint-disable-line no-unused-expressions</span>
<a href="#l26.327"></a><span id="l26.327">       } catch (e) {</span>
<a href="#l26.328"></a><span id="l26.328">         throw Cr.NS_ERROR_INVALID_ARG;</span>
<a href="#l26.329"></a><span id="l26.329">       }</span>
<a href="#l26.330"></a><span id="l26.330">     }</span>
<a href="#l26.331"></a><span id="l26.331"> </span>
<a href="#l26.332"></a><span id="l26.332">     this.modify();</span>
<a href="#l26.333"></a><span id="l26.333" class="difflineminus">-    this.mAlarms = this.getAlarms({});</span>
<a href="#l26.334"></a><span id="l26.334" class="difflineplus">+    this.mAlarms = this.getAlarms();</span>
<a href="#l26.335"></a><span id="l26.335">     this.mAlarms.push(aAlarm);</span>
<a href="#l26.336"></a><span id="l26.336">   },</span>
<a href="#l26.337"></a><span id="l26.337"> </span>
<a href="#l26.338"></a><span id="l26.338">   // void deleteAlarm(in calIAlarm aAlarm);</span>
<a href="#l26.339"></a><span id="l26.339">   deleteAlarm: function(aAlarm) {</span>
<a href="#l26.340"></a><span id="l26.340">     this.modify();</span>
<a href="#l26.341"></a><span id="l26.341" class="difflineminus">-    this.mAlarms = this.getAlarms({});</span>
<a href="#l26.342"></a><span id="l26.342" class="difflineplus">+    this.mAlarms = this.getAlarms();</span>
<a href="#l26.343"></a><span id="l26.343">     for (let i = 0; i &lt; this.mAlarms.length; i++) {</span>
<a href="#l26.344"></a><span id="l26.344">       if (cal.data.compareObjects(this.mAlarms[i], aAlarm, Ci.calIAlarm)) {</span>
<a href="#l26.345"></a><span id="l26.345">         this.mAlarms.splice(i, 1);</span>
<a href="#l26.346"></a><span id="l26.346">         break;</span>
<a href="#l26.347"></a><span id="l26.347">       }</span>
<a href="#l26.348"></a><span id="l26.348">     }</span>
<a href="#l26.349"></a><span id="l26.349">   },</span>
<a href="#l26.350"></a><span id="l26.350"> </span>
<a href="#l26.351"></a><span id="l26.351">   // void clearAlarms();</span>
<a href="#l26.352"></a><span id="l26.352">   clearAlarms: function() {</span>
<a href="#l26.353"></a><span id="l26.353">     this.modify();</span>
<a href="#l26.354"></a><span id="l26.354">     this.mAlarms = [];</span>
<a href="#l26.355"></a><span id="l26.355">   },</span>
<a href="#l26.356"></a><span id="l26.356"> </span>
<a href="#l26.357"></a><span id="l26.357" class="difflineminus">-  // void getOccurrencesBetween (in calIDateTime aStartDate, in calIDateTime aEndDate,</span>
<a href="#l26.358"></a><span id="l26.358" class="difflineminus">-  //                             out PRUint32 aCount,</span>
<a href="#l26.359"></a><span id="l26.359" class="difflineminus">-  //                             [array,size_is(aCount),retval] out calIItemBase aOccurrences);</span>
<a href="#l26.360"></a><span id="l26.360" class="difflineminus">-  getOccurrencesBetween: function(aStartDate, aEndDate, aCount) {</span>
<a href="#l26.361"></a><span id="l26.361" class="difflineplus">+  // Array&lt;calIItemBase&gt; getOccurrencesBetween(in calIDateTime aStartDate, in calIDateTime aEndDate);</span>
<a href="#l26.362"></a><span id="l26.362" class="difflineplus">+  getOccurrencesBetween: function(aStartDate, aEndDate) {</span>
<a href="#l26.363"></a><span id="l26.363">     if (this.recurrenceInfo) {</span>
<a href="#l26.364"></a><span id="l26.364" class="difflineminus">-      return this.recurrenceInfo.getOccurrences(aStartDate, aEndDate, 0, aCount);</span>
<a href="#l26.365"></a><span id="l26.365" class="difflineplus">+      return this.recurrenceInfo.getOccurrences(aStartDate, aEndDate, 0, {});</span>
<a href="#l26.366"></a><span id="l26.366">     }</span>
<a href="#l26.367"></a><span id="l26.367"> </span>
<a href="#l26.368"></a><span id="l26.368">     if (cal.item.checkIfInRange(this, aStartDate, aEndDate)) {</span>
<a href="#l26.369"></a><span id="l26.369" class="difflineminus">-      aCount.value = 1;</span>
<a href="#l26.370"></a><span id="l26.370">       return [this];</span>
<a href="#l26.371"></a><span id="l26.371">     }</span>
<a href="#l26.372"></a><span id="l26.372"> </span>
<a href="#l26.373"></a><span id="l26.373" class="difflineminus">-    aCount.value = 0;</span>
<a href="#l26.374"></a><span id="l26.374">     return [];</span>
<a href="#l26.375"></a><span id="l26.375">   },</span>
<a href="#l26.376"></a><span id="l26.376"> };</span>
<a href="#l26.377"></a><span id="l26.377"> </span>
<a href="#l26.378"></a><span id="l26.378"> makeMemberAttr(calItemBase, &quot;CREATED&quot;, null, &quot;creationDate&quot;, true);</span>
<a href="#l26.379"></a><span id="l26.379"> makeMemberAttr(calItemBase, &quot;SUMMARY&quot;, null, &quot;title&quot;, true);</span>
<a href="#l26.380"></a><span id="l26.380"> makeMemberAttr(calItemBase, &quot;PRIORITY&quot;, 0, &quot;priority&quot;, true);</span>
<a href="#l26.381"></a><span id="l26.381"> makeMemberAttr(calItemBase, &quot;CLASS&quot;, &quot;PUBLIC&quot;, &quot;privacy&quot;, true);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/base/src/calItipItem.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/base/src/calItipItem.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -104,29 +104,29 @@ calItipItem.prototype = {</span>
<a href="#l27.4"></a><span id="l27.4">       item.deleteProperty(&quot;RECEIVED-SEQUENCE&quot;);</span>
<a href="#l27.5"></a><span id="l27.5">       item.deleteProperty(&quot;RECEIVED-DTSTAMP&quot;);</span>
<a href="#l27.6"></a><span id="l27.6">       for (let [name] of item.properties) {</span>
<a href="#l27.7"></a><span id="l27.7">         if (name != &quot;X-MOZ-FAKED-MASTER&quot; &amp;&amp; name.substr(0, &quot;X-MOZ-&quot;.length) == &quot;X-MOZ-&quot;) {</span>
<a href="#l27.8"></a><span id="l27.8">           item.deleteProperty(name);</span>
<a href="#l27.9"></a><span id="l27.9">         }</span>
<a href="#l27.10"></a><span id="l27.10">       }</span>
<a href="#l27.11"></a><span id="l27.11">       // never publish an organizer's RECEIVED params:</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-      item.getAttendees({}).forEach(att =&gt; {</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+      item.getAttendees().forEach(att =&gt; {</span>
<a href="#l27.14"></a><span id="l27.14">         att.deleteProperty(&quot;RECEIVED-SEQUENCE&quot;);</span>
<a href="#l27.15"></a><span id="l27.15">         att.deleteProperty(&quot;RECEIVED-DTSTAMP&quot;);</span>
<a href="#l27.16"></a><span id="l27.16">       });</span>
<a href="#l27.17"></a><span id="l27.17"> </span>
<a href="#l27.18"></a><span id="l27.18">       // according to RfC 6638, the following items must not be exposed in client side</span>
<a href="#l27.19"></a><span id="l27.19">       // email scheduling messages, so let's remove it if present</span>
<a href="#l27.20"></a><span id="l27.20">       let removeSchedulingParams = aCalUser =&gt; {</span>
<a href="#l27.21"></a><span id="l27.21">         aCalUser.deleteProperty(&quot;SCHEDULE-AGENT&quot;);</span>
<a href="#l27.22"></a><span id="l27.22">         aCalUser.deleteProperty(&quot;SCHEDULE-FORCE-SEND&quot;);</span>
<a href="#l27.23"></a><span id="l27.23">         aCalUser.deleteProperty(&quot;SCHEDULE-STATUS&quot;);</span>
<a href="#l27.24"></a><span id="l27.24">       };</span>
<a href="#l27.25"></a><span id="l27.25" class="difflineminus">-      item.getAttendees({}).forEach(removeSchedulingParams);</span>
<a href="#l27.26"></a><span id="l27.26" class="difflineplus">+      item.getAttendees().forEach(removeSchedulingParams);</span>
<a href="#l27.27"></a><span id="l27.27">       // we're graceful here as some PUBLISHed events may violate RfC by having no organizer</span>
<a href="#l27.28"></a><span id="l27.28">       if (item.organizer) {</span>
<a href="#l27.29"></a><span id="l27.29">         removeSchedulingParams(item.organizer);</span>
<a href="#l27.30"></a><span id="l27.30">       }</span>
<a href="#l27.31"></a><span id="l27.31"> </span>
<a href="#l27.32"></a><span id="l27.32">       item.setProperty(&quot;DTSTAMP&quot;, stamp);</span>
<a href="#l27.33"></a><span id="l27.33">       item.setProperty(&quot;LAST-MODIFIED&quot;, lastModified); // need to be last to undirty the item</span>
<a href="#l27.34"></a><span id="l27.34">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -371,17 +371,17 @@ calOutlookCSVImporter.prototype = {</span>
<a href="#l28.4"></a><span id="l28.4">           if (txt) {</span>
<a href="#l28.5"></a><span id="l28.5">             event.setProperty(&quot;DESCRIPTION&quot;, txt);</span>
<a href="#l28.6"></a><span id="l28.6">           }</span>
<a href="#l28.7"></a><span id="l28.7">         }</span>
<a href="#l28.8"></a><span id="l28.8">         if (&quot;categoriesIndex&quot; in args) {</span>
<a href="#l28.9"></a><span id="l28.9">           txt = this.parseTextField(eventFields[args.categoriesIndex]);</span>
<a href="#l28.10"></a><span id="l28.10">           if (txt) {</span>
<a href="#l28.11"></a><span id="l28.11">             let categories = cal.category.stringToArray(txt);</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-            event.setCategories(categories.length, categories);</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+            event.setCategories(categories);</span>
<a href="#l28.14"></a><span id="l28.14">           }</span>
<a href="#l28.15"></a><span id="l28.15">         }</span>
<a href="#l28.16"></a><span id="l28.16">         if (&quot;locationIndex&quot; in args) {</span>
<a href="#l28.17"></a><span id="l28.17">           txt = this.parseTextField(eventFields[args.locationIndex]);</span>
<a href="#l28.18"></a><span id="l28.18">           if (txt) {</span>
<a href="#l28.19"></a><span id="l28.19">             event.setProperty(&quot;LOCATION&quot;, txt);</span>
<a href="#l28.20"></a><span id="l28.20">           }</span>
<a href="#l28.21"></a><span id="l28.21">         }</span>
<a href="#l28.22"></a><span id="l28.22" class="difflineat">@@ -493,24 +493,24 @@ calOutlookCSVExporter.prototype = {</span>
<a href="#l28.23"></a><span id="l28.23">       let line = [];</span>
<a href="#l28.24"></a><span id="l28.24">       line.push(item.title);</span>
<a href="#l28.25"></a><span id="l28.25">       line.push(dateString(item.startDate));</span>
<a href="#l28.26"></a><span id="l28.26">       line.push(timeString(item.startDate));</span>
<a href="#l28.27"></a><span id="l28.27">       line.push(dateString(item.endDate));</span>
<a href="#l28.28"></a><span id="l28.28">       line.push(timeString(item.endDate));</span>
<a href="#l28.29"></a><span id="l28.29">       line.push(item.startDate.isDate ? localeEn.valueTrue : localeEn.valueFalse);</span>
<a href="#l28.30"></a><span id="l28.30">       let alarmDate;</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineminus">-      let alarms = item.getAlarms({});</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineplus">+      let alarms = item.getAlarms();</span>
<a href="#l28.33"></a><span id="l28.33">       if (alarms.length) {</span>
<a href="#l28.34"></a><span id="l28.34">         alarmDate = cal.alarms.calculateAlarmDate(item, alarms[0]);</span>
<a href="#l28.35"></a><span id="l28.35">       }</span>
<a href="#l28.36"></a><span id="l28.36">       line.push(alarmDate ? localeEn.valueTrue : localeEn.valueFalse);</span>
<a href="#l28.37"></a><span id="l28.37">       line.push(alarmDate ? dateString(alarmDate) : &quot;&quot;);</span>
<a href="#l28.38"></a><span id="l28.38">       line.push(alarmDate ? timeString(alarmDate) : &quot;&quot;);</span>
<a href="#l28.39"></a><span id="l28.39" class="difflineminus">-      line.push(txtString(cal.category.arrayToString(item.getCategories({})))); // xxx todo: what's the correct way to encode ',' in csv?, how are multi-values expressed?</span>
<a href="#l28.40"></a><span id="l28.40" class="difflineplus">+      line.push(txtString(cal.category.arrayToString(item.getCategories()))); // xxx todo: what's the correct way to encode ',' in csv?, how are multi-values expressed?</span>
<a href="#l28.41"></a><span id="l28.41">       line.push(txtString(item.getProperty(&quot;DESCRIPTION&quot;)));</span>
<a href="#l28.42"></a><span id="l28.42">       line.push(txtString(item.getProperty(&quot;LOCATION&quot;)));</span>
<a href="#l28.43"></a><span id="l28.43">       line.push(item.privacy == &quot;PRIVATE&quot; ? localeEn.valueTrue : localeEn.valueFalse);</span>
<a href="#l28.44"></a><span id="l28.44"> </span>
<a href="#l28.45"></a><span id="l28.45">       line = line.map(value =&gt; `&quot;${String(value).replace(/&quot;/g, '&quot;&quot;')}&quot;`);</span>
<a href="#l28.46"></a><span id="l28.46">       str = line.join(&quot;,&quot;) + exportLineEnding;</span>
<a href="#l28.47"></a><span id="l28.47"> </span>
<a href="#l28.48"></a><span id="l28.48">       let converter = Cc[&quot;@mozilla.org/intl/scriptableunicodeconverter&quot;].createInstance(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/lightning/content/imip-bar.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/lightning/content/imip-bar.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -356,17 +356,17 @@ var ltnImipBar = {</span>
<a href="#l29.4"></a><span id="l29.4">           onOperationComplete: function(aCalendar, aStatus, aOperationType, aId, aDetail) {</span>
<a href="#l29.5"></a><span id="l29.5">             if (Components.isSuccessCode(aStatus) &amp;&amp; isDeclineCounter) {</span>
<a href="#l29.6"></a><span id="l29.6">               // TODO: move the DECLINECOUNTER stuff to actionFunc</span>
<a href="#l29.7"></a><span id="l29.7">               aItipItem.getItemList().forEach(aItem =&gt; {</span>
<a href="#l29.8"></a><span id="l29.8">                 // we can rely on the received itipItem to reply at this stage</span>
<a href="#l29.9"></a><span id="l29.9">                 // already, the checks have been done in cal.itip.processFoundItems</span>
<a href="#l29.10"></a><span id="l29.10">                 // when setting up the respective aActionFunc</span>
<a href="#l29.11"></a><span id="l29.11">                 let attendees = cal.itip.getAttendeesBySender(</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-                  aItem.getAttendees({}),</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+                  aItem.getAttendees(),</span>
<a href="#l29.14"></a><span id="l29.14">                   aItipItem.sender</span>
<a href="#l29.15"></a><span id="l29.15">                 );</span>
<a href="#l29.16"></a><span id="l29.16">                 let status = true;</span>
<a href="#l29.17"></a><span id="l29.17">                 if (</span>
<a href="#l29.18"></a><span id="l29.18">                   attendees.length == 1 &amp;&amp;</span>
<a href="#l29.19"></a><span id="l29.19">                   ltnImipBar.foundItems &amp;&amp;</span>
<a href="#l29.20"></a><span id="l29.20">                   ltnImipBar.foundItems.length</span>
<a href="#l29.21"></a><span id="l29.21">                 ) {</span>
<a href="#l29.22"></a><span id="l29.22" class="difflineat">@@ -432,17 +432,17 @@ var ltnImipBar = {</span>
<a href="#l29.23"></a><span id="l29.23">           let proposedRID = proposedItem.getProperty(&quot;RECURRENCE-ID&quot;);</span>
<a href="#l29.24"></a><span id="l29.24">           if (proposedRID) {</span>
<a href="#l29.25"></a><span id="l29.25">             // if this is a counterproposal for a specific occurrence, we use</span>
<a href="#l29.26"></a><span id="l29.26">             // that to compare with</span>
<a href="#l29.27"></a><span id="l29.27">             item = item.recurrenceInfo.getOccurrenceFor(proposedRID).clone();</span>
<a href="#l29.28"></a><span id="l29.28">           }</span>
<a href="#l29.29"></a><span id="l29.29">           let parsedProposal = ltn.invitation.parseCounter(proposedItem, item);</span>
<a href="#l29.30"></a><span id="l29.30">           let potentialProposers = cal.itip.getAttendeesBySender(</span>
<a href="#l29.31"></a><span id="l29.31" class="difflineminus">-            proposedItem.getAttendees({}),</span>
<a href="#l29.32"></a><span id="l29.32" class="difflineplus">+            proposedItem.getAttendees(),</span>
<a href="#l29.33"></a><span id="l29.33">             ltnImipBar.itipItem.sender</span>
<a href="#l29.34"></a><span id="l29.34">           );</span>
<a href="#l29.35"></a><span id="l29.35">           let proposingAttendee = potentialProposers.length == 1 ? potentialProposers[0] : null;</span>
<a href="#l29.36"></a><span id="l29.36">           if (</span>
<a href="#l29.37"></a><span id="l29.37">             proposingAttendee &amp;&amp;</span>
<a href="#l29.38"></a><span id="l29.38">             [&quot;OK&quot;, &quot;OUTDATED&quot;, &quot;NOTLATESTUPDATE&quot;].includes(parsedProposal.result.type)</span>
<a href="#l29.39"></a><span id="l29.39">           ) {</span>
<a href="#l29.40"></a><span id="l29.40">             counterProposal = {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -382,27 +382,27 @@ function onLoad() {</span>
<a href="#l30.4"></a><span id="l30.4">   window.initialStartDateValue = args.initialStartDateValue;</span>
<a href="#l30.5"></a><span id="l30.5"> </span>
<a href="#l30.6"></a><span id="l30.6">   window.attendeeTabLabel = document.getElementById(&quot;event-grid-tab-attendees&quot;).label;</span>
<a href="#l30.7"></a><span id="l30.7">   window.attachmentTabLabel = document.getElementById(&quot;event-grid-tab-attachments&quot;).label;</span>
<a href="#l30.8"></a><span id="l30.8">   // we store the array of attendees in the window.</span>
<a href="#l30.9"></a><span id="l30.9">   // clone each existing attendee since we still suffer</span>
<a href="#l30.10"></a><span id="l30.10">   // from the 'lost x-properties'-bug.</span>
<a href="#l30.11"></a><span id="l30.11">   window.attendees = [];</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-  let attendees = item.getAttendees({});</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+  let attendees = item.getAttendees();</span>
<a href="#l30.14"></a><span id="l30.14">   if (attendees &amp;&amp; attendees.length) {</span>
<a href="#l30.15"></a><span id="l30.15">     for (let attendee of attendees) {</span>
<a href="#l30.16"></a><span id="l30.16">       window.attendees.push(attendee.clone());</span>
<a href="#l30.17"></a><span id="l30.17">     }</span>
<a href="#l30.18"></a><span id="l30.18">   }</span>
<a href="#l30.19"></a><span id="l30.19"> </span>
<a href="#l30.20"></a><span id="l30.20">   window.organizer = null;</span>
<a href="#l30.21"></a><span id="l30.21">   if (item.organizer) {</span>
<a href="#l30.22"></a><span id="l30.22">     window.organizer = item.organizer.clone();</span>
<a href="#l30.23"></a><span id="l30.23" class="difflineminus">-  } else if (item.getAttendees({}).length &gt; 0) {</span>
<a href="#l30.24"></a><span id="l30.24" class="difflineplus">+  } else if (item.getAttendees().length &gt; 0) {</span>
<a href="#l30.25"></a><span id="l30.25">     // previous versions of calendar may have filled ORGANIZER correctly on overridden instances:</span>
<a href="#l30.26"></a><span id="l30.26">     let orgId = item.calendar.getProperty(&quot;organizerId&quot;);</span>
<a href="#l30.27"></a><span id="l30.27">     if (orgId) {</span>
<a href="#l30.28"></a><span id="l30.28">       let organizer = cal.createAttendee();</span>
<a href="#l30.29"></a><span id="l30.29">       organizer.id = orgId;</span>
<a href="#l30.30"></a><span id="l30.30">       organizer.commonName = item.calendar.getProperty(&quot;organizerCN&quot;);</span>
<a href="#l30.31"></a><span id="l30.31">       organizer.role = &quot;REQ-PARTICIPANT&quot;;</span>
<a href="#l30.32"></a><span id="l30.32">       organizer.participationStatus = &quot;ACCEPTED&quot;;</span>
<a href="#l30.33"></a><span id="l30.33" class="difflineat">@@ -658,30 +658,30 @@ function loadDialog(aItem) {</span>
<a href="#l30.34"></a><span id="l30.34">       calendarList.selectedIndex = indexToSelect;</span>
<a href="#l30.35"></a><span id="l30.35">     }</span>
<a href="#l30.36"></a><span id="l30.36">   }</span>
<a href="#l30.37"></a><span id="l30.37"> </span>
<a href="#l30.38"></a><span id="l30.38">   // Categories</span>
<a href="#l30.39"></a><span id="l30.39">   if (gNewItemUI) {</span>
<a href="#l30.40"></a><span id="l30.40">     // XXX more to do here with localization, see loadCategories.</span>
<a href="#l30.41"></a><span id="l30.41">     itemProps.initialCategoriesList = cal.l10n.sortArrayByLocaleCollator(cal.category.fromPrefs());</span>
<a href="#l30.42"></a><span id="l30.42" class="difflineminus">-    itemProps.initialCategories = aItem.getCategories({});</span>
<a href="#l30.43"></a><span id="l30.43" class="difflineplus">+    itemProps.initialCategories = aItem.getCategories();</span>
<a href="#l30.44"></a><span id="l30.44"> </span>
<a href="#l30.45"></a><span id="l30.45">     // just to demo capsules component</span>
<a href="#l30.46"></a><span id="l30.46">     itemProps.initialCategories = [&quot;Some&quot;, &quot;Demo&quot;, &quot;Categories&quot;];</span>
<a href="#l30.47"></a><span id="l30.47">   } else {</span>
<a href="#l30.48"></a><span id="l30.48">     loadCategories(aItem);</span>
<a href="#l30.49"></a><span id="l30.49">   }</span>
<a href="#l30.50"></a><span id="l30.50"> </span>
<a href="#l30.51"></a><span id="l30.51">   // Attachment</span>
<a href="#l30.52"></a><span id="l30.52">   if (!gNewItemUI) {</span>
<a href="#l30.53"></a><span id="l30.53">     loadCloudProviders();</span>
<a href="#l30.54"></a><span id="l30.54">   }</span>
<a href="#l30.55"></a><span id="l30.55">   let hasAttachments = capSupported(&quot;attachments&quot;);</span>
<a href="#l30.56"></a><span id="l30.56" class="difflineminus">-  let attachments = aItem.getAttachments({});</span>
<a href="#l30.57"></a><span id="l30.57" class="difflineplus">+  let attachments = aItem.getAttachments();</span>
<a href="#l30.58"></a><span id="l30.58">   if (gNewItemUI) {</span>
<a href="#l30.59"></a><span id="l30.59">     itemProps.initialAttachments = {};</span>
<a href="#l30.60"></a><span id="l30.60">   }</span>
<a href="#l30.61"></a><span id="l30.61">   if (hasAttachments &amp;&amp; attachments &amp;&amp; attachments.length &gt; 0) {</span>
<a href="#l30.62"></a><span id="l30.62">     for (let attachment of attachments) {</span>
<a href="#l30.63"></a><span id="l30.63">       if (gNewItemUI) {</span>
<a href="#l30.64"></a><span id="l30.64">         if (</span>
<a href="#l30.65"></a><span id="l30.65">           attachment &amp;&amp;</span>
<a href="#l30.66"></a><span id="l30.66" class="difflineat">@@ -781,17 +781,17 @@ function loadDialog(aItem) {</span>
<a href="#l30.67"></a><span id="l30.67">     itemProps.initialRepeatUntilDate = untilDate;</span>
<a href="#l30.68"></a><span id="l30.68">     // XXX more to do, see loadRepeat</span>
<a href="#l30.69"></a><span id="l30.69">   } else {</span>
<a href="#l30.70"></a><span id="l30.70">     loadRepeat(repeatType, untilDate, aItem);</span>
<a href="#l30.71"></a><span id="l30.71">   }</span>
<a href="#l30.72"></a><span id="l30.72"> </span>
<a href="#l30.73"></a><span id="l30.73">   if (!gNewItemUI) {</span>
<a href="#l30.74"></a><span id="l30.74">     // load reminders details</span>
<a href="#l30.75"></a><span id="l30.75" class="difflineminus">-    loadReminders(aItem.getAlarms({}));</span>
<a href="#l30.76"></a><span id="l30.76" class="difflineplus">+    loadReminders(aItem.getAlarms());</span>
<a href="#l30.77"></a><span id="l30.77"> </span>
<a href="#l30.78"></a><span id="l30.78">     // Synchronize link-top-image with keep-duration-button status</span>
<a href="#l30.79"></a><span id="l30.79">     let keepAttribute =</span>
<a href="#l30.80"></a><span id="l30.80">       document.getElementById(&quot;keepduration-button&quot;).getAttribute(&quot;keep&quot;) == &quot;true&quot;;</span>
<a href="#l30.81"></a><span id="l30.81">     setBooleanAttribute(&quot;link-image-top&quot;, &quot;keep&quot;, keepAttribute);</span>
<a href="#l30.82"></a><span id="l30.82"> </span>
<a href="#l30.83"></a><span id="l30.83">     updateDateTime();</span>
<a href="#l30.84"></a><span id="l30.84"> </span>
<a href="#l30.85"></a><span id="l30.85" class="difflineat">@@ -904,17 +904,17 @@ function changeUndiscloseCheckboxStatus(</span>
<a href="#l30.86"></a><span id="l30.86"> }</span>
<a href="#l30.87"></a><span id="l30.87"> </span>
<a href="#l30.88"></a><span id="l30.88"> /**</span>
<a href="#l30.89"></a><span id="l30.89">  * Loads the item's categories into the category panel</span>
<a href="#l30.90"></a><span id="l30.90">  *</span>
<a href="#l30.91"></a><span id="l30.91">  * @param aItem     The item to load into the category panel</span>
<a href="#l30.92"></a><span id="l30.92">  */</span>
<a href="#l30.93"></a><span id="l30.93"> function loadCategories(aItem) {</span>
<a href="#l30.94"></a><span id="l30.94" class="difflineminus">-  let itemCategories = aItem.getCategories({});</span>
<a href="#l30.95"></a><span id="l30.95" class="difflineplus">+  let itemCategories = aItem.getCategories();</span>
<a href="#l30.96"></a><span id="l30.96">   let categoryList = cal.category.fromPrefs();</span>
<a href="#l30.97"></a><span id="l30.97">   for (let cat of itemCategories) {</span>
<a href="#l30.98"></a><span id="l30.98">     if (!categoryList.includes(cat)) {</span>
<a href="#l30.99"></a><span id="l30.99">       categoryList.push(cat);</span>
<a href="#l30.100"></a><span id="l30.100">     }</span>
<a href="#l30.101"></a><span id="l30.101">   }</span>
<a href="#l30.102"></a><span id="l30.102">   cal.l10n.sortArrayByLocaleCollator(categoryList);</span>
<a href="#l30.103"></a><span id="l30.103"> </span>
<a href="#l30.104"></a><span id="l30.104" class="difflineat">@@ -1071,17 +1071,17 @@ function categoryTextboxKeypress(event) </span>
<a href="#l30.105"></a><span id="l30.105">  * @param aItem     The item to set the categories on</span>
<a href="#l30.106"></a><span id="l30.106">  */</span>
<a href="#l30.107"></a><span id="l30.107"> function saveCategories(aItem) {</span>
<a href="#l30.108"></a><span id="l30.108">   let categoryPopup = document.getElementById(&quot;item-categories-popup&quot;);</span>
<a href="#l30.109"></a><span id="l30.109">   let categoryList = Array.from(</span>
<a href="#l30.110"></a><span id="l30.110">     categoryPopup.querySelectorAll(&quot;menuitem.calendar-category[checked]&quot;),</span>
<a href="#l30.111"></a><span id="l30.111">     cat =&gt; cat.getAttribute(&quot;label&quot;)</span>
<a href="#l30.112"></a><span id="l30.112">   );</span>
<a href="#l30.113"></a><span id="l30.113" class="difflineminus">-  aItem.setCategories(categoryList.length, categoryList);</span>
<a href="#l30.114"></a><span id="l30.114" class="difflineplus">+  aItem.setCategories(categoryList);</span>
<a href="#l30.115"></a><span id="l30.115"> }</span>
<a href="#l30.116"></a><span id="l30.116"> </span>
<a href="#l30.117"></a><span id="l30.117"> /**</span>
<a href="#l30.118"></a><span id="l30.118">  * Sets up all date related controls from the passed item</span>
<a href="#l30.119"></a><span id="l30.119">  *</span>
<a href="#l30.120"></a><span id="l30.120">  * @param item      The item to parse information out of.</span>
<a href="#l30.121"></a><span id="l30.121">  */</span>
<a href="#l30.122"></a><span id="l30.122"> function loadDateTime(item) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -32,17 +32,17 @@ ltn.invitation = {</span>
<a href="#l31.4"></a><span id="l31.4">           header = cal.l10n.getLtnString(&quot;itipRequestBody&quot;, [organizerString, summary]);</span>
<a href="#l31.5"></a><span id="l31.5">           break;</span>
<a href="#l31.6"></a><span id="l31.6">         case &quot;CANCEL&quot;:</span>
<a href="#l31.7"></a><span id="l31.7">           header = cal.l10n.getLtnString(&quot;itipCancelBody&quot;, [organizerString, summary]);</span>
<a href="#l31.8"></a><span id="l31.8">           break;</span>
<a href="#l31.9"></a><span id="l31.9">         case &quot;COUNTER&quot;:</span>
<a href="#l31.10"></a><span id="l31.10">         // falls through</span>
<a href="#l31.11"></a><span id="l31.11">         case &quot;REPLY&quot;: {</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-          let attendees = item.getAttendees({});</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+          let attendees = item.getAttendees();</span>
<a href="#l31.14"></a><span id="l31.14">           let sender = cal.itip.getAttendeesBySender(attendees, aItipItem.sender);</span>
<a href="#l31.15"></a><span id="l31.15">           if (sender.length == 1) {</span>
<a href="#l31.16"></a><span id="l31.16">             if (aItipItem.responseMethod == &quot;COUNTER&quot;) {</span>
<a href="#l31.17"></a><span id="l31.17">               header = cal.l10n.getLtnString(&quot;itipCounterBody&quot;, [sender[0].toString(), summary]);</span>
<a href="#l31.18"></a><span id="l31.18">             } else {</span>
<a href="#l31.19"></a><span id="l31.19">               let statusString =</span>
<a href="#l31.20"></a><span id="l31.20">                 sender[0].participationStatus == &quot;DECLINED&quot;</span>
<a href="#l31.21"></a><span id="l31.21">                   ? &quot;itipReplyBodyDecline&quot;</span>
<a href="#l31.22"></a><span id="l31.22" class="difflineat">@@ -207,26 +207,26 @@ ltn.invitation = {</span>
<a href="#l31.23"></a><span id="l31.23">       .replace(&quot;*~*~*~*~*~*~*~*~*~*&quot;, &quot;&quot;);</span>
<a href="#l31.24"></a><span id="l31.24">     field(&quot;description&quot;, eventDescription, true);</span>
<a href="#l31.25"></a><span id="l31.25"> </span>
<a href="#l31.26"></a><span id="l31.26">     // URL</span>
<a href="#l31.27"></a><span id="l31.27">     field(&quot;url&quot;, aEvent.getProperty(&quot;URL&quot;), true);</span>
<a href="#l31.28"></a><span id="l31.28"> </span>
<a href="#l31.29"></a><span id="l31.29">     // ATTACH - we only display URI but no BINARY type attachments here</span>
<a href="#l31.30"></a><span id="l31.30">     let links = [];</span>
<a href="#l31.31"></a><span id="l31.31" class="difflineminus">-    let attachments = aEvent.getAttachments({});</span>
<a href="#l31.32"></a><span id="l31.32" class="difflineplus">+    let attachments = aEvent.getAttachments();</span>
<a href="#l31.33"></a><span id="l31.33">     for (let attachment of attachments) {</span>
<a href="#l31.34"></a><span id="l31.34">       if (attachment.uri) {</span>
<a href="#l31.35"></a><span id="l31.35">         links.push(attachment.uri.spec);</span>
<a href="#l31.36"></a><span id="l31.36">       }</span>
<a href="#l31.37"></a><span id="l31.37">     }</span>
<a href="#l31.38"></a><span id="l31.38">     field(&quot;attachments&quot;, links.join(&quot;&lt;br&gt;&quot;), true);</span>
<a href="#l31.39"></a><span id="l31.39"> </span>
<a href="#l31.40"></a><span id="l31.40">     // ATTENDEE and ORGANIZER fields</span>
<a href="#l31.41"></a><span id="l31.41" class="difflineminus">-    let attendees = aEvent.getAttendees({});</span>
<a href="#l31.42"></a><span id="l31.42" class="difflineplus">+    let attendees = aEvent.getAttendees();</span>
<a href="#l31.43"></a><span id="l31.43">     let attendeeTemplate = doc.getElementById(&quot;attendee-template&quot;);</span>
<a href="#l31.44"></a><span id="l31.44">     let attendeeTable = doc.getElementById(&quot;attendee-table&quot;);</span>
<a href="#l31.45"></a><span id="l31.45">     let organizerTable = doc.getElementById(&quot;organizer-table&quot;);</span>
<a href="#l31.46"></a><span id="l31.46">     doc.getElementById(&quot;imipHtml-attendees-row&quot;).hidden = attendees.length &lt; 1;</span>
<a href="#l31.47"></a><span id="l31.47">     doc.getElementById(&quot;imipHtml-organizer-row&quot;).hidden = !aEvent.organizer;</span>
<a href="#l31.48"></a><span id="l31.48"> </span>
<a href="#l31.49"></a><span id="l31.49">     let setupAttendee = function(aAttendee) {</span>
<a href="#l31.50"></a><span id="l31.50">       let row = attendeeTemplate.cloneNode(true);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -2870,17 +2870,17 @@ calDavCalendar.prototype = {</span>
<a href="#l32.4"></a><span id="l32.4">     ) {};</span>
<a href="#l32.5"></a><span id="l32.5">     getItemListener.onGetResult = function(aCalendar, aStatus, aItemType, aDetail, aCount, aItems) {</span>
<a href="#l32.6"></a><span id="l32.6">       let itemToUpdate = aItems[0];</span>
<a href="#l32.7"></a><span id="l32.7">       if (aItem.recurrenceId &amp;&amp; itemToUpdate.recurrenceInfo) {</span>
<a href="#l32.8"></a><span id="l32.8">         itemToUpdate = itemToUpdate.recurrenceInfo.getOccurrenceFor(aItem.recurrenceId);</span>
<a href="#l32.9"></a><span id="l32.9">       }</span>
<a href="#l32.10"></a><span id="l32.10">       let newItem = itemToUpdate.clone();</span>
<a href="#l32.11"></a><span id="l32.11"> </span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-      for (let attendee of aItem.getAttendees({})) {</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+      for (let attendee of aItem.getAttendees()) {</span>
<a href="#l32.14"></a><span id="l32.14">         let att = newItem.getAttendeeById(attendee.id);</span>
<a href="#l32.15"></a><span id="l32.15">         if (att) {</span>
<a href="#l32.16"></a><span id="l32.16">           newItem.removeAttendee(att);</span>
<a href="#l32.17"></a><span id="l32.17">           att = att.clone();</span>
<a href="#l32.18"></a><span id="l32.18">           att.participationStatus = attendee.participationStatus;</span>
<a href="#l32.19"></a><span id="l32.19">           newItem.addAttendee(att);</span>
<a href="#l32.20"></a><span id="l32.20">         }</span>
<a href="#l32.21"></a><span id="l32.21">       }</span>
<a href="#l32.22"></a><span id="l32.22" class="difflineat">@@ -2992,17 +2992,17 @@ calDavCalendar.prototype = {</span>
<a href="#l32.23"></a><span id="l32.23">       // let's make sure we notify calendar users marked for client-side scheduling by email</span>
<a href="#l32.24"></a><span id="l32.24">       let recipients = [];</span>
<a href="#l32.25"></a><span id="l32.25">       for (let item of aItipItem.getItemList()) {</span>
<a href="#l32.26"></a><span id="l32.26">         if (aItipItem.receivedMethod == &quot;REPLY&quot;) {</span>
<a href="#l32.27"></a><span id="l32.27">           if (item.organizer.getProperty(&quot;SCHEDULE-AGENT&quot;) == &quot;CLIENT&quot;) {</span>
<a href="#l32.28"></a><span id="l32.28">             recipients.push(item.organizer);</span>
<a href="#l32.29"></a><span id="l32.29">           }</span>
<a href="#l32.30"></a><span id="l32.30">         } else {</span>
<a href="#l32.31"></a><span id="l32.31" class="difflineminus">-          let atts = item.getAttendees({}).filter(att =&gt; {</span>
<a href="#l32.32"></a><span id="l32.32" class="difflineplus">+          let atts = item.getAttendees().filter(att =&gt; {</span>
<a href="#l32.33"></a><span id="l32.33">             return att.getProperty(&quot;SCHEDULE-AGENT&quot;) == &quot;CLIENT&quot;;</span>
<a href="#l32.34"></a><span id="l32.34">           });</span>
<a href="#l32.35"></a><span id="l32.35">           for (let att of atts) {</span>
<a href="#l32.36"></a><span id="l32.36">             recipients.push(att);</span>
<a href="#l32.37"></a><span id="l32.37">           }</span>
<a href="#l32.38"></a><span id="l32.38">         }</span>
<a href="#l32.39"></a><span id="l32.39">       }</span>
<a href="#l32.40"></a><span id="l32.40">       if (recipients.length) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -1720,17 +1720,17 @@ calStorageCalendar.prototype = {</span>
<a href="#l33.4"></a><span id="l33.4"> </span>
<a href="#l33.5"></a><span id="l33.5">       let name = row.getResultByName(&quot;key&quot;);</span>
<a href="#l33.6"></a><span id="l33.6">       switch (name) {</span>
<a href="#l33.7"></a><span id="l33.7">         case &quot;DURATION&quot;:</span>
<a href="#l33.8"></a><span id="l33.8">           // for events DTEND/DUE is enforced by calEvent/calTodo, so suppress DURATION:</span>
<a href="#l33.9"></a><span id="l33.9">           break;</span>
<a href="#l33.10"></a><span id="l33.10">         case &quot;CATEGORIES&quot;: {</span>
<a href="#l33.11"></a><span id="l33.11">           let cats = cal.category.stringToArray(row.getResultByName(&quot;value&quot;));</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-          item.setCategories(cats.length, cats);</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+          item.setCategories(cats);</span>
<a href="#l33.14"></a><span id="l33.14">           break;</span>
<a href="#l33.15"></a><span id="l33.15">         }</span>
<a href="#l33.16"></a><span id="l33.16">         default:</span>
<a href="#l33.17"></a><span id="l33.17">           item.setProperty(name, row.getResultByName(&quot;value&quot;));</span>
<a href="#l33.18"></a><span id="l33.18">           break;</span>
<a href="#l33.19"></a><span id="l33.19">       }</span>
<a href="#l33.20"></a><span id="l33.20">     });</span>
<a href="#l33.21"></a><span id="l33.21"> </span>
<a href="#l33.22"></a><span id="l33.22" class="difflineat">@@ -1945,17 +1945,17 @@ calStorageCalendar.prototype = {</span>
<a href="#l33.23"></a><span id="l33.23">         await this.executeAsync(selectItem, row =&gt; {</span>
<a href="#l33.24"></a><span id="l33.24">           let name = row.getResultByName(&quot;key&quot;);</span>
<a href="#l33.25"></a><span id="l33.25">           switch (name) {</span>
<a href="#l33.26"></a><span id="l33.26">             case &quot;DURATION&quot;:</span>
<a href="#l33.27"></a><span id="l33.27">               // for events DTEND/DUE is enforced by calEvent/calTodo, so suppress DURATION:</span>
<a href="#l33.28"></a><span id="l33.28">               break;</span>
<a href="#l33.29"></a><span id="l33.29">             case &quot;CATEGORIES&quot;: {</span>
<a href="#l33.30"></a><span id="l33.30">               let cats = cal.category.stringToArray(row.getResultByName(&quot;value&quot;));</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineminus">-              item.setCategories(cats.length, cats);</span>
<a href="#l33.32"></a><span id="l33.32" class="difflineplus">+              item.setCategories(cats);</span>
<a href="#l33.33"></a><span id="l33.33">               break;</span>
<a href="#l33.34"></a><span id="l33.34">             }</span>
<a href="#l33.35"></a><span id="l33.35">             default:</span>
<a href="#l33.36"></a><span id="l33.36">               item.setProperty(name, row.getResultByName(&quot;value&quot;));</span>
<a href="#l33.37"></a><span id="l33.37">               break;</span>
<a href="#l33.38"></a><span id="l33.38">           }</span>
<a href="#l33.39"></a><span id="l33.39">         });</span>
<a href="#l33.40"></a><span id="l33.40">       } catch (e) {</span>
<a href="#l33.41"></a><span id="l33.41" class="difflineat">@@ -2277,17 +2277,17 @@ calStorageCalendar.prototype = {</span>
<a href="#l33.42"></a><span id="l33.42">     params.bindByName(&quot;priority&quot;, item.getProperty(&quot;PRIORITY&quot;));</span>
<a href="#l33.43"></a><span id="l33.43">     params.bindByName(&quot;privacy&quot;, item.getProperty(&quot;CLASS&quot;));</span>
<a href="#l33.44"></a><span id="l33.44">     params.bindByName(&quot;ical_status&quot;, item.getProperty(&quot;STATUS&quot;));</span>
<a href="#l33.45"></a><span id="l33.45"> </span>
<a href="#l33.46"></a><span id="l33.46">     params.bindByName(&quot;alarm_last_ack&quot;, item.alarmLastAck &amp;&amp; item.alarmLastAck.nativeTime);</span>
<a href="#l33.47"></a><span id="l33.47">   },</span>
<a href="#l33.48"></a><span id="l33.48"> </span>
<a href="#l33.49"></a><span id="l33.49">   prepareAttendees: function(stmts, item, olditem) {</span>
<a href="#l33.50"></a><span id="l33.50" class="difflineminus">-    let attendees = item.getAttendees({});</span>
<a href="#l33.51"></a><span id="l33.51" class="difflineplus">+    let attendees = item.getAttendees();</span>
<a href="#l33.52"></a><span id="l33.52">     if (item.organizer) {</span>
<a href="#l33.53"></a><span id="l33.53">       attendees = attendees.concat([]);</span>
<a href="#l33.54"></a><span id="l33.54">       attendees.push(item.organizer);</span>
<a href="#l33.55"></a><span id="l33.55">     }</span>
<a href="#l33.56"></a><span id="l33.56">     if (attendees.length &gt; 0) {</span>
<a href="#l33.57"></a><span id="l33.57">       let array = this.prepareAsyncStatement(stmts, this.mInsertAttendee);</span>
<a href="#l33.58"></a><span id="l33.58">       for (let att of attendees) {</span>
<a href="#l33.59"></a><span id="l33.59">         let params = this.prepareAsyncParams(array);</span>
<a href="#l33.60"></a><span id="l33.60" class="difflineat">@@ -2333,17 +2333,17 @@ calStorageCalendar.prototype = {</span>
<a href="#l33.61"></a><span id="l33.61">     for (let [name, value] of item.properties) {</span>
<a href="#l33.62"></a><span id="l33.62">       ret = CAL_ITEM_FLAG.HAS_PROPERTIES;</span>
<a href="#l33.63"></a><span id="l33.63">       if (item.isPropertyPromoted(name)) {</span>
<a href="#l33.64"></a><span id="l33.64">         continue;</span>
<a href="#l33.65"></a><span id="l33.65">       }</span>
<a href="#l33.66"></a><span id="l33.66">       this.prepareProperty(stmts, item, name, value);</span>
<a href="#l33.67"></a><span id="l33.67">     }</span>
<a href="#l33.68"></a><span id="l33.68"> </span>
<a href="#l33.69"></a><span id="l33.69" class="difflineminus">-    let cats = item.getCategories({});</span>
<a href="#l33.70"></a><span id="l33.70" class="difflineplus">+    let cats = item.getCategories();</span>
<a href="#l33.71"></a><span id="l33.71">     if (cats.length &gt; 0) {</span>
<a href="#l33.72"></a><span id="l33.72">       ret = CAL_ITEM_FLAG.HAS_PROPERTIES;</span>
<a href="#l33.73"></a><span id="l33.73">       this.prepareProperty(stmts, item, &quot;CATEGORIES&quot;, cal.category.arrayToString(cats));</span>
<a href="#l33.74"></a><span id="l33.74">     }</span>
<a href="#l33.75"></a><span id="l33.75"> </span>
<a href="#l33.76"></a><span id="l33.76">     return ret;</span>
<a href="#l33.77"></a><span id="l33.77">   },</span>
<a href="#l33.78"></a><span id="l33.78"> </span>
<a href="#l33.79"></a><span id="l33.79" class="difflineat">@@ -2380,51 +2380,51 @@ calStorageCalendar.prototype = {</span>
<a href="#l33.80"></a><span id="l33.80">     } else if (item.recurrenceId &amp;&amp; item.recurrenceId.isDate) {</span>
<a href="#l33.81"></a><span id="l33.81">       flags |= CAL_ITEM_FLAG.RECURRENCE_ID_ALLDAY;</span>
<a href="#l33.82"></a><span id="l33.82">     }</span>
<a href="#l33.83"></a><span id="l33.83"> </span>
<a href="#l33.84"></a><span id="l33.84">     return flags;</span>
<a href="#l33.85"></a><span id="l33.85">   },</span>
<a href="#l33.86"></a><span id="l33.86"> </span>
<a href="#l33.87"></a><span id="l33.87">   prepareAttachments: function(stmts, item, olditem) {</span>
<a href="#l33.88"></a><span id="l33.88" class="difflineminus">-    let attachments = item.getAttachments({});</span>
<a href="#l33.89"></a><span id="l33.89" class="difflineplus">+    let attachments = item.getAttachments();</span>
<a href="#l33.90"></a><span id="l33.90">     if (attachments &amp;&amp; attachments.length &gt; 0) {</span>
<a href="#l33.91"></a><span id="l33.91">       let array = this.prepareAsyncStatement(stmts, this.mInsertAttachment);</span>
<a href="#l33.92"></a><span id="l33.92">       for (let att of attachments) {</span>
<a href="#l33.93"></a><span id="l33.93">         let params = this.prepareAsyncParams(array);</span>
<a href="#l33.94"></a><span id="l33.94">         this.setDateParamHelper(params, &quot;recurrence_id&quot;, item.recurrenceId);</span>
<a href="#l33.95"></a><span id="l33.95">         params.bindByName(&quot;item_id&quot;, item.id);</span>
<a href="#l33.96"></a><span id="l33.96">         params.bindByName(&quot;icalString&quot;, att.icalString);</span>
<a href="#l33.97"></a><span id="l33.97"> </span>
<a href="#l33.98"></a><span id="l33.98">         array.addParams(params);</span>
<a href="#l33.99"></a><span id="l33.99">       }</span>
<a href="#l33.100"></a><span id="l33.100">       return CAL_ITEM_FLAG.HAS_ATTACHMENTS;</span>
<a href="#l33.101"></a><span id="l33.101">     }</span>
<a href="#l33.102"></a><span id="l33.102">     return 0;</span>
<a href="#l33.103"></a><span id="l33.103">   },</span>
<a href="#l33.104"></a><span id="l33.104"> </span>
<a href="#l33.105"></a><span id="l33.105">   prepareRelations: function(stmts, item, olditem) {</span>
<a href="#l33.106"></a><span id="l33.106" class="difflineminus">-    let relations = item.getRelations({});</span>
<a href="#l33.107"></a><span id="l33.107" class="difflineplus">+    let relations = item.getRelations();</span>
<a href="#l33.108"></a><span id="l33.108">     if (relations &amp;&amp; relations.length &gt; 0) {</span>
<a href="#l33.109"></a><span id="l33.109">       let array = this.prepareAsyncStatement(stmts, this.mInsertRelation);</span>
<a href="#l33.110"></a><span id="l33.110">       for (let rel of relations) {</span>
<a href="#l33.111"></a><span id="l33.111">         let params = this.prepareAsyncParams(array);</span>
<a href="#l33.112"></a><span id="l33.112">         this.setDateParamHelper(params, &quot;recurrence_id&quot;, item.recurrenceId);</span>
<a href="#l33.113"></a><span id="l33.113">         params.bindByName(&quot;item_id&quot;, item.id);</span>
<a href="#l33.114"></a><span id="l33.114">         params.bindByName(&quot;icalString&quot;, rel.icalString);</span>
<a href="#l33.115"></a><span id="l33.115"> </span>
<a href="#l33.116"></a><span id="l33.116">         array.addParams(params);</span>
<a href="#l33.117"></a><span id="l33.117">       }</span>
<a href="#l33.118"></a><span id="l33.118">       return CAL_ITEM_FLAG.HAS_RELATIONS;</span>
<a href="#l33.119"></a><span id="l33.119">     }</span>
<a href="#l33.120"></a><span id="l33.120">     return 0;</span>
<a href="#l33.121"></a><span id="l33.121">   },</span>
<a href="#l33.122"></a><span id="l33.122"> </span>
<a href="#l33.123"></a><span id="l33.123">   prepareAlarms: function(stmts, item, olditem) {</span>
<a href="#l33.124"></a><span id="l33.124" class="difflineminus">-    let alarms = item.getAlarms({});</span>
<a href="#l33.125"></a><span id="l33.125" class="difflineplus">+    let alarms = item.getAlarms();</span>
<a href="#l33.126"></a><span id="l33.126">     if (alarms.length &lt; 1) {</span>
<a href="#l33.127"></a><span id="l33.127">       return 0;</span>
<a href="#l33.128"></a><span id="l33.128">     }</span>
<a href="#l33.129"></a><span id="l33.129"> </span>
<a href="#l33.130"></a><span id="l33.130">     let array = this.prepareAsyncStatement(stmts, this.mInsertAlarm);</span>
<a href="#l33.131"></a><span id="l33.131">     for (let alarm of alarms) {</span>
<a href="#l33.132"></a><span id="l33.132">       let params = this.prepareAsyncParams(array);</span>
<a href="#l33.133"></a><span id="l33.133">       this.setDateParamHelper(params, &quot;recurrence_id&quot;, item.recurrenceId);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -139,17 +139,17 @@ calWcapCalendar.prototype.encodeRecurren</span>
<a href="#l34.4"></a><span id="l34.4">   // or whether to replace the rrule, ambiguous documentation!!!</span>
<a href="#l34.5"></a><span id="l34.5">   // check with store(with no uid) upon adoptItem() which behaves strange</span>
<a href="#l34.6"></a><span id="l34.6">   // if rchange=0 is set!</span>
<a href="#l34.7"></a><span id="l34.7"> };</span>
<a href="#l34.8"></a><span id="l34.8"> </span>
<a href="#l34.9"></a><span id="l34.9"> calWcapCalendar.prototype.getAlarmParams = function(item) {</span>
<a href="#l34.10"></a><span id="l34.10">   let params = null;</span>
<a href="#l34.11"></a><span id="l34.11">   // xxx TODO ALARMSUPPORT check if WCAP supports multiple alarms</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-  let alarms = item.getAlarms({}).filter(x =&gt; x.action == &quot;EMAIL&quot;);</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+  let alarms = item.getAlarms().filter(x =&gt; x.action == &quot;EMAIL&quot;);</span>
<a href="#l34.14"></a><span id="l34.14">   let alarm = alarms.length &gt; 0 &amp;&amp; alarms[0];</span>
<a href="#l34.15"></a><span id="l34.15"> </span>
<a href="#l34.16"></a><span id="l34.16">   if (alarm) {</span>
<a href="#l34.17"></a><span id="l34.17">     let alarmStart = cal.alarms.calculateAlarmOffset(item, alarm);</span>
<a href="#l34.18"></a><span id="l34.18">     if (alarm.related == alarm.ALARM_RELATED_END) {</span>
<a href="#l34.19"></a><span id="l34.19">       // cs does not support explicit RELATED=END when</span>
<a href="#l34.20"></a><span id="l34.20">       // both start|entry and end|due are written</span>
<a href="#l34.21"></a><span id="l34.21">       let dur = item.duration;</span>
<a href="#l34.22"></a><span id="l34.22" class="difflineat">@@ -205,17 +205,17 @@ calWcapCalendar.prototype.isInvitation =</span>
<a href="#l34.23"></a><span id="l34.23">   let orgCalId = getCalId(item.organizer);</span>
<a href="#l34.24"></a><span id="l34.24">   if (!orgCalId || orgCalId == calId) {</span>
<a href="#l34.25"></a><span id="l34.25">     return false;</span>
<a href="#l34.26"></a><span id="l34.26">   }</span>
<a href="#l34.27"></a><span id="l34.27">   return this.getInvitedAttendee(item) != null;</span>
<a href="#l34.28"></a><span id="l34.28"> };</span>
<a href="#l34.29"></a><span id="l34.29"> </span>
<a href="#l34.30"></a><span id="l34.30"> calWcapCalendar.prototype.getInvitedAttendee = function(item) {</span>
<a href="#l34.31"></a><span id="l34.31" class="difflineminus">-  let att = getAttendeeByCalId(item.getAttendees({}), this.calId);</span>
<a href="#l34.32"></a><span id="l34.32" class="difflineplus">+  let att = getAttendeeByCalId(item.getAttendees(), this.calId);</span>
<a href="#l34.33"></a><span id="l34.33">   if (!att) {</span>
<a href="#l34.34"></a><span id="l34.34">     // try to find mail address</span>
<a href="#l34.35"></a><span id="l34.35">     let prefMail = this.session.getUserPreferences(&quot;X-NSCP-WCAP-PREF-mail&quot;);</span>
<a href="#l34.36"></a><span id="l34.36">     if (prefMail.length &gt; 0 &amp;&amp; prefMail[0].length &gt; 0) {</span>
<a href="#l34.37"></a><span id="l34.37">       att = item.getAttendeeById(&quot;mailto:&quot; + prefMail[0]);</span>
<a href="#l34.38"></a><span id="l34.38">     }</span>
<a href="#l34.39"></a><span id="l34.39">   }</span>
<a href="#l34.40"></a><span id="l34.40">   return att;</span>
<a href="#l34.41"></a><span id="l34.41" class="difflineat">@@ -231,17 +231,17 @@ calWcapCalendar.prototype.canNotify = fu</span>
<a href="#l34.42"></a><span id="l34.42">     case &quot;CANCEL&quot;:</span>
<a href="#l34.43"></a><span id="l34.43">       // when creating new items, mind that organizer's id</span>
<a href="#l34.44"></a><span id="l34.44">       return (</span>
<a href="#l34.45"></a><span id="l34.45">         !item.organizer || // might yet not be set</span>
<a href="#l34.46"></a><span id="l34.46">         item.organizer.id == calId || // or is set to raw calId</span>
<a href="#l34.47"></a><span id="l34.47">         getCalId(item.organizer) == calId</span>
<a href="#l34.48"></a><span id="l34.48">       );</span>
<a href="#l34.49"></a><span id="l34.49">     case &quot;REPLY&quot;: // only if we we're invited from cs, and find matching X-S1CS-CALID:</span>
<a href="#l34.50"></a><span id="l34.50" class="difflineminus">-      return getAttendeeByCalId(item.getAttendees({}), calId) != null;</span>
<a href="#l34.51"></a><span id="l34.51" class="difflineplus">+      return getAttendeeByCalId(item.getAttendees(), calId) != null;</span>
<a href="#l34.52"></a><span id="l34.52">     default:</span>
<a href="#l34.53"></a><span id="l34.53">       return false;</span>
<a href="#l34.54"></a><span id="l34.54">   }</span>
<a href="#l34.55"></a><span id="l34.55"> };</span>
<a href="#l34.56"></a><span id="l34.56"> </span>
<a href="#l34.57"></a><span id="l34.57"> function equalDatetimes(one, two) {</span>
<a href="#l34.58"></a><span id="l34.58">   return (!one &amp;&amp; !two) || (one &amp;&amp; two &amp;&amp; one.isDate == two.isDate &amp;&amp; one.compare(two) == 0);</span>
<a href="#l34.59"></a><span id="l34.59"> }</span>
<a href="#l34.60"></a><span id="l34.60" class="difflineat">@@ -338,22 +338,22 @@ calWcapCalendar.prototype.storeItem = fu</span>
<a href="#l34.61"></a><span id="l34.61">   let method = METHOD_PUBLISH;</span>
<a href="#l34.62"></a><span id="l34.62">   let bNoSmtpNotify = false;</span>
<a href="#l34.63"></a><span id="l34.63">   let params = &quot;&quot;;</span>
<a href="#l34.64"></a><span id="l34.64"> </span>
<a href="#l34.65"></a><span id="l34.65">   let calId = this.calId;</span>
<a href="#l34.66"></a><span id="l34.66">   if (!bAddItem &amp;&amp; this.isInvitation(item)) {</span>
<a href="#l34.67"></a><span id="l34.67">     // REPLY</span>
<a href="#l34.68"></a><span id="l34.68">     method = METHOD_REPLY;</span>
<a href="#l34.69"></a><span id="l34.69" class="difflineminus">-    let att = getAttendeeByCalId(item.getAttendees({}), calId);</span>
<a href="#l34.70"></a><span id="l34.70" class="difflineplus">+    let att = getAttendeeByCalId(item.getAttendees(), calId);</span>
<a href="#l34.71"></a><span id="l34.71">     if (att) {</span>
<a href="#l34.72"></a><span id="l34.72">       log(&quot;attendee: &quot; + att.icalProperty.icalString, this);</span>
<a href="#l34.73"></a><span id="l34.73">       let oldAtt = null;</span>
<a href="#l34.74"></a><span id="l34.74">       if (oldItem) {</span>
<a href="#l34.75"></a><span id="l34.75" class="difflineminus">-        oldAtt = getAttendeeByCalId(oldItem.getAttendees({}), calId);</span>
<a href="#l34.76"></a><span id="l34.76" class="difflineplus">+        oldAtt = getAttendeeByCalId(oldItem.getAttendees(), calId);</span>
<a href="#l34.77"></a><span id="l34.77">       }</span>
<a href="#l34.78"></a><span id="l34.78">       if (!oldAtt || att.participationStatus != oldAtt.participationStatus) {</span>
<a href="#l34.79"></a><span id="l34.79">         // REPLY first for just this calendar:</span>
<a href="#l34.80"></a><span id="l34.80">         params +=</span>
<a href="#l34.81"></a><span id="l34.81">           &quot;&amp;attendees=PARTSTAT=&quot; + att.participationStatus + &quot;^&quot; + encodeURIComponent(att.id);</span>
<a href="#l34.82"></a><span id="l34.82">       }</span>
<a href="#l34.83"></a><span id="l34.83">     }</span>
<a href="#l34.84"></a><span id="l34.84">   } else {</span>
<a href="#l34.85"></a><span id="l34.85" class="difflineat">@@ -388,17 +388,17 @@ calWcapCalendar.prototype.storeItem = fu</span>
<a href="#l34.86"></a><span id="l34.86">     } else {</span>
<a href="#l34.87"></a><span id="l34.87">       // calITodo</span>
<a href="#l34.88"></a><span id="l34.88">       // xxx todo: dtstart is mandatory for cs, so if this is</span>
<a href="#l34.89"></a><span id="l34.89">       //           undefined, assume an allDay todo???</span>
<a href="#l34.90"></a><span id="l34.90">       dtstart = item.entryDate;</span>
<a href="#l34.91"></a><span id="l34.91">       dtend = item.dueDate;</span>
<a href="#l34.92"></a><span id="l34.92"> </span>
<a href="#l34.93"></a><span id="l34.93">       // cs bug: enforce DUE (set to DTSTART) if alarm is set</span>
<a href="#l34.94"></a><span id="l34.94" class="difflineminus">-      if (!dtend &amp;&amp; item.getAlarms({}).length) {</span>
<a href="#l34.95"></a><span id="l34.95" class="difflineplus">+      if (!dtend &amp;&amp; item.getAlarms().length) {</span>
<a href="#l34.96"></a><span id="l34.96">         dtend = dtstart;</span>
<a href="#l34.97"></a><span id="l34.97">       }</span>
<a href="#l34.98"></a><span id="l34.98"> </span>
<a href="#l34.99"></a><span id="l34.99">       bIsAllDay = dtstart &amp;&amp; dtstart.isDate;</span>
<a href="#l34.100"></a><span id="l34.100">       if (</span>
<a href="#l34.101"></a><span id="l34.101">         !oldItem ||</span>
<a href="#l34.102"></a><span id="l34.102">         !identicalDatetimes(dtstart, oldItem.entryDate) ||</span>
<a href="#l34.103"></a><span id="l34.103">         !identicalDatetimes(dtend, oldItem.dueDate)</span>
<a href="#l34.104"></a><span id="l34.104" class="difflineat">@@ -424,31 +424,31 @@ calWcapCalendar.prototype.storeItem = fu</span>
<a href="#l34.105"></a><span id="l34.105">     if (!orgCalId) {</span>
<a href="#l34.106"></a><span id="l34.106">       // new events yet don't have X-S1CS-CALID set on ORGANIZER or this is outbound iTIP</span>
<a href="#l34.107"></a><span id="l34.107">       let orgId = getOrgId(item);</span>
<a href="#l34.108"></a><span id="l34.108">       if (!orgId || orgId.toLowerCase().replace(/^mailto:/, &quot;&quot;) == this.ownerId.toLowerCase()) {</span>
<a href="#l34.109"></a><span id="l34.109">         orgCalId = calId; // own event</span>
<a href="#l34.110"></a><span id="l34.110">       } // else outbound</span>
<a href="#l34.111"></a><span id="l34.111">     }</span>
<a href="#l34.112"></a><span id="l34.112"> </span>
<a href="#l34.113"></a><span id="l34.113" class="difflineminus">-    let attendees = item.getAttendees({});</span>
<a href="#l34.114"></a><span id="l34.114" class="difflineplus">+    let attendees = item.getAttendees();</span>
<a href="#l34.115"></a><span id="l34.115">     if (attendees.length &gt; 0) {</span>
<a href="#l34.116"></a><span id="l34.116">       // xxx todo: why ever, X-S1CS-EMAIL is unsupported though documented for calprops... WTF.</span>
<a href="#l34.117"></a><span id="l34.117">       let attParam = encodeAttendees(attendees);</span>
<a href="#l34.118"></a><span id="l34.118" class="difflineminus">-      if (!oldItem || attParam != encodeAttendees(oldItem.getAttendees({}))) {</span>
<a href="#l34.119"></a><span id="l34.119" class="difflineplus">+      if (!oldItem || attParam != encodeAttendees(oldItem.getAttendees())) {</span>
<a href="#l34.120"></a><span id="l34.120">         params += &quot;&amp;attendees=&quot; + attParam;</span>
<a href="#l34.121"></a><span id="l34.121">       }</span>
<a href="#l34.122"></a><span id="l34.122"> </span>
<a href="#l34.123"></a><span id="l34.123">       if (orgCalId == calId) {</span>
<a href="#l34.124"></a><span id="l34.124">         method = METHOD_REQUEST;</span>
<a href="#l34.125"></a><span id="l34.125">       } else {</span>
<a href="#l34.126"></a><span id="l34.126">         method = METHOD_UPDATE;</span>
<a href="#l34.127"></a><span id="l34.127">         bNoSmtpNotify = true;</span>
<a href="#l34.128"></a><span id="l34.128">       }</span>
<a href="#l34.129"></a><span id="l34.129" class="difflineminus">-    } else if (oldItem &amp;&amp; oldItem.getAttendees({}).length &gt; 0) {</span>
<a href="#l34.130"></a><span id="l34.130" class="difflineplus">+    } else if (oldItem &amp;&amp; oldItem.getAttendees().length &gt; 0) {</span>
<a href="#l34.131"></a><span id="l34.131">       // else using just PUBLISH</span>
<a href="#l34.132"></a><span id="l34.132">       params += &quot;&amp;attendees=&quot;; // clear attendees</span>
<a href="#l34.133"></a><span id="l34.133">     }</span>
<a href="#l34.134"></a><span id="l34.134"> </span>
<a href="#l34.135"></a><span id="l34.135">     if (orgCalId) {</span>
<a href="#l34.136"></a><span id="l34.136">       if (!oldItem || orgCalId != getCalId(oldItem.organizer)) {</span>
<a href="#l34.137"></a><span id="l34.137">         params += &quot;&amp;orgCalid=&quot; + encodeURIComponent(orgCalId);</span>
<a href="#l34.138"></a><span id="l34.138">       }</span>
<a href="#l34.139"></a><span id="l34.139" class="difflineat">@@ -460,19 +460,19 @@ calWcapCalendar.prototype.storeItem = fu</span>
<a href="#l34.140"></a><span id="l34.140">       }</span>
<a href="#l34.141"></a><span id="l34.141">     }</span>
<a href="#l34.142"></a><span id="l34.142"> </span>
<a href="#l34.143"></a><span id="l34.143">     let val = item.title;</span>
<a href="#l34.144"></a><span id="l34.144">     if (!oldItem || val != oldItem.title) {</span>
<a href="#l34.145"></a><span id="l34.145">       params += &quot;&amp;summary=&quot; + encodeURIComponent(val);</span>
<a href="#l34.146"></a><span id="l34.146">     }</span>
<a href="#l34.147"></a><span id="l34.147"> </span>
<a href="#l34.148"></a><span id="l34.148" class="difflineminus">-    let categories = item.getCategories({});</span>
<a href="#l34.149"></a><span id="l34.149" class="difflineplus">+    let categories = item.getCategories();</span>
<a href="#l34.150"></a><span id="l34.150">     let catParam = encodeCategories(categories);</span>
<a href="#l34.151"></a><span id="l34.151" class="difflineminus">-    if (!oldItem || catParam != encodeCategories(oldItem.getCategories({}))) {</span>
<a href="#l34.152"></a><span id="l34.152" class="difflineplus">+    if (!oldItem || catParam != encodeCategories(oldItem.getCategories())) {</span>
<a href="#l34.153"></a><span id="l34.153">       params += &quot;&amp;categories=&quot; + catParam;</span>
<a href="#l34.154"></a><span id="l34.154">     }</span>
<a href="#l34.155"></a><span id="l34.155"> </span>
<a href="#l34.156"></a><span id="l34.156">     val = diffProperty(item, oldItem, &quot;DESCRIPTION&quot;);</span>
<a href="#l34.157"></a><span id="l34.157">     if (val !== null) {</span>
<a href="#l34.158"></a><span id="l34.158">       params += &quot;&amp;desc=&quot; + encodeURIComponent(val);</span>
<a href="#l34.159"></a><span id="l34.159">     }</span>
<a href="#l34.160"></a><span id="l34.160">     val = diffProperty(item, oldItem, &quot;LOCATION&quot;);</span>
<a href="#l34.161"></a><span id="l34.161" class="difflineat">@@ -642,17 +642,17 @@ calWcapCalendar.prototype.storeItem = fu</span>
<a href="#l34.162"></a><span id="l34.162"> </span>
<a href="#l34.163"></a><span id="l34.163"> calWcapCalendar.prototype.tunnelXProps = function(destItem, srcItem) {</span>
<a href="#l34.164"></a><span id="l34.164">   // xxx todo: temp workaround for bug in calItemBase.js</span>
<a href="#l34.165"></a><span id="l34.165">   if (!isParent(srcItem)) {</span>
<a href="#l34.166"></a><span id="l34.166">     return;</span>
<a href="#l34.167"></a><span id="l34.167">   }</span>
<a href="#l34.168"></a><span id="l34.168">   // tunnel alarm X-MOZ-SNOOZE only if alarm is still set:</span>
<a href="#l34.169"></a><span id="l34.169">   // TODO ALARMSUPPORT still needed when showing alarms as EMAIL for wcap?</span>
<a href="#l34.170"></a><span id="l34.170" class="difflineminus">-  let hasAlarms = destItem.getAlarms({}).length;</span>
<a href="#l34.171"></a><span id="l34.171" class="difflineplus">+  let hasAlarms = destItem.getAlarms().length;</span>
<a href="#l34.172"></a><span id="l34.172">   for (let [name, value] of srcItem.properties) {</span>
<a href="#l34.173"></a><span id="l34.173">     try {</span>
<a href="#l34.174"></a><span id="l34.174">       if (name.startsWith(&quot;X-MOZ-&quot;)) {</span>
<a href="#l34.175"></a><span id="l34.175">         switch (name) {</span>
<a href="#l34.176"></a><span id="l34.176">           // keep snooze stamps for occurrences only and if alarm is still set:</span>
<a href="#l34.177"></a><span id="l34.177">           case &quot;X-MOZ-SNOOZE-TIME&quot;:</span>
<a href="#l34.178"></a><span id="l34.178">             if (!hasAlarms) {</span>
<a href="#l34.179"></a><span id="l34.179">               break; // alarm has been reset</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/calendar/resources/content/mouseoverPreviews.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/calendar/resources/content/mouseoverPreviews.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -266,17 +266,17 @@ function getPreviewForEvent(aEvent, aIsT</span>
<a href="#l35.4"></a><span id="l35.4">       boxAppendLabeledText(vbox, &quot;tooltipCalName&quot;, calendarNameString);</span>
<a href="#l35.5"></a><span id="l35.5">     }</span>
<a href="#l35.6"></a><span id="l35.6"> </span>
<a href="#l35.7"></a><span id="l35.7">     if (event.status &amp;&amp; event.status != &quot;NONE&quot;) {</span>
<a href="#l35.8"></a><span id="l35.8">       let statusString = getEventStatusString(event);</span>
<a href="#l35.9"></a><span id="l35.9">       boxAppendLabeledText(vbox, &quot;tooltipStatus&quot;, statusString);</span>
<a href="#l35.10"></a><span id="l35.10">     }</span>
<a href="#l35.11"></a><span id="l35.11"> </span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-    if (event.organizer &amp;&amp; event.getAttendees({}).length &gt; 0) {</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+    if (event.organizer &amp;&amp; event.getAttendees().length &gt; 0) {</span>
<a href="#l35.14"></a><span id="l35.14">       let organizer = event.organizer;</span>
<a href="#l35.15"></a><span id="l35.15">       boxAppendLabeledText(vbox, &quot;tooltipOrganizer&quot;, organizer);</span>
<a href="#l35.16"></a><span id="l35.16">     }</span>
<a href="#l35.17"></a><span id="l35.17"> </span>
<a href="#l35.18"></a><span id="l35.18">     let description = event.getProperty(&quot;DESCRIPTION&quot;);</span>
<a href="#l35.19"></a><span id="l35.19">     if (description) {</span>
<a href="#l35.20"></a><span id="l35.20">       boxAppendBodySeparator(vbox);</span>
<a href="#l35.21"></a><span id="l35.21">       // display wrapped description lines, like body of message below headers</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/calendar/test/unit/test_alarm.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/calendar/test/unit/test_alarm.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -93,35 +93,35 @@ function test_email_alarm() {</span>
<a href="#l36.4"></a><span id="l36.4">   alarm.offset = cal.createDuration();</span>
<a href="#l36.5"></a><span id="l36.5"> </span>
<a href="#l36.6"></a><span id="l36.6">   // Check for at least one attendee</span>
<a href="#l36.7"></a><span id="l36.7">   let attendee1 = cal.createAttendee();</span>
<a href="#l36.8"></a><span id="l36.8">   attendee1.id = &quot;mailto:horst&quot;;</span>
<a href="#l36.9"></a><span id="l36.9">   let attendee2 = cal.createAttendee();</span>
<a href="#l36.10"></a><span id="l36.10">   attendee2.id = &quot;mailto:gustav&quot;;</span>
<a href="#l36.11"></a><span id="l36.11"> </span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-  equal(alarm.getAttendees({}).length, 0);</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+  equal(alarm.getAttendees().length, 0);</span>
<a href="#l36.14"></a><span id="l36.14">   alarm.addAttendee(attendee1);</span>
<a href="#l36.15"></a><span id="l36.15" class="difflineminus">-  equal(alarm.getAttendees({}).length, 1);</span>
<a href="#l36.16"></a><span id="l36.16" class="difflineplus">+  equal(alarm.getAttendees().length, 1);</span>
<a href="#l36.17"></a><span id="l36.17">   alarm.addAttendee(attendee2);</span>
<a href="#l36.18"></a><span id="l36.18" class="difflineminus">-  equal(alarm.getAttendees({}).length, 2);</span>
<a href="#l36.19"></a><span id="l36.19" class="difflineplus">+  equal(alarm.getAttendees().length, 2);</span>
<a href="#l36.20"></a><span id="l36.20">   alarm.addAttendee(attendee1);</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineminus">-  let addedAttendees = alarm.getAttendees({});</span>
<a href="#l36.22"></a><span id="l36.22" class="difflineplus">+  let addedAttendees = alarm.getAttendees();</span>
<a href="#l36.23"></a><span id="l36.23">   equal(addedAttendees.length, 2);</span>
<a href="#l36.24"></a><span id="l36.24">   equal(addedAttendees[0], attendee2);</span>
<a href="#l36.25"></a><span id="l36.25">   equal(addedAttendees[1], attendee1);</span>
<a href="#l36.26"></a><span id="l36.26"> </span>
<a href="#l36.27"></a><span id="l36.27">   ok(!!alarm.icalComponent.serializeToICS().match(/mailto:horst/));</span>
<a href="#l36.28"></a><span id="l36.28">   ok(!!alarm.icalComponent.serializeToICS().match(/mailto:gustav/));</span>
<a href="#l36.29"></a><span id="l36.29"> </span>
<a href="#l36.30"></a><span id="l36.30">   alarm.deleteAttendee(attendee1);</span>
<a href="#l36.31"></a><span id="l36.31" class="difflineminus">-  equal(alarm.getAttendees({}).length, 1);</span>
<a href="#l36.32"></a><span id="l36.32" class="difflineplus">+  equal(alarm.getAttendees().length, 1);</span>
<a href="#l36.33"></a><span id="l36.33"> </span>
<a href="#l36.34"></a><span id="l36.34">   alarm.clearAttendees();</span>
<a href="#l36.35"></a><span id="l36.35" class="difflineminus">-  equal(alarm.getAttendees({}).length, 0);</span>
<a href="#l36.36"></a><span id="l36.36" class="difflineplus">+  equal(alarm.getAttendees().length, 0);</span>
<a href="#l36.37"></a><span id="l36.37"> </span>
<a href="#l36.38"></a><span id="l36.38">   // Make sure attendees are correctly folded/imported</span>
<a href="#l36.39"></a><span id="l36.39">   alarm.icalString = dedent`</span>
<a href="#l36.40"></a><span id="l36.40">         BEGIN:VALARM</span>
<a href="#l36.41"></a><span id="l36.41">         ACTION:EMAIL</span>
<a href="#l36.42"></a><span id="l36.42">         TRIGGER;VALUE=DURATION:-PT5M</span>
<a href="#l36.43"></a><span id="l36.43">         ATTENDEE:mailto:test@example.com</span>
<a href="#l36.44"></a><span id="l36.44">         ATTENDEE:mailto:test@example.com</span>
<a href="#l36.45"></a><span id="l36.45" class="difflineat">@@ -166,43 +166,43 @@ function test_audio_alarm() {</span>
<a href="#l36.46"></a><span id="l36.46">   // Test attachments</span>
<a href="#l36.47"></a><span id="l36.47">   let sound = cal.createAttachment();</span>
<a href="#l36.48"></a><span id="l36.48">   sound.uri = Services.io.newURI(&quot;file:///sound.wav&quot;);</span>
<a href="#l36.49"></a><span id="l36.49">   let sound2 = cal.createAttachment();</span>
<a href="#l36.50"></a><span id="l36.50">   sound2.uri = Services.io.newURI(&quot;file:///sound2.wav&quot;);</span>
<a href="#l36.51"></a><span id="l36.51"> </span>
<a href="#l36.52"></a><span id="l36.52">   // Adding an attachment should work</span>
<a href="#l36.53"></a><span id="l36.53">   alarm.addAttachment(sound);</span>
<a href="#l36.54"></a><span id="l36.54" class="difflineminus">-  let addedAttachments = alarm.getAttachments({});</span>
<a href="#l36.55"></a><span id="l36.55" class="difflineplus">+  let addedAttachments = alarm.getAttachments();</span>
<a href="#l36.56"></a><span id="l36.56">   equal(addedAttachments.length, 1);</span>
<a href="#l36.57"></a><span id="l36.57">   equal(addedAttachments[0], sound);</span>
<a href="#l36.58"></a><span id="l36.58">   ok(alarm.icalString.includes(&quot;ATTACH:file:///sound.wav&quot;));</span>
<a href="#l36.59"></a><span id="l36.59"> </span>
<a href="#l36.60"></a><span id="l36.60">   // Adding twice shouldn't change anything</span>
<a href="#l36.61"></a><span id="l36.61">   alarm.addAttachment(sound);</span>
<a href="#l36.62"></a><span id="l36.62" class="difflineminus">-  addedAttachments = alarm.getAttachments({});</span>
<a href="#l36.63"></a><span id="l36.63" class="difflineplus">+  addedAttachments = alarm.getAttachments();</span>
<a href="#l36.64"></a><span id="l36.64">   equal(addedAttachments.length, 1);</span>
<a href="#l36.65"></a><span id="l36.65">   equal(addedAttachments[0], sound);</span>
<a href="#l36.66"></a><span id="l36.66"> </span>
<a href="#l36.67"></a><span id="l36.67">   try {</span>
<a href="#l36.68"></a><span id="l36.68">     alarm.addAttachment(sound2);</span>
<a href="#l36.69"></a><span id="l36.69">     do_throw(&quot;Adding a second attachment should fail for type AUDIO&quot;);</span>
<a href="#l36.70"></a><span id="l36.70">   } catch (e) {</span>
<a href="#l36.71"></a><span id="l36.71">     // TODO looks like this test is disabled. Why?</span>
<a href="#l36.72"></a><span id="l36.72">   }</span>
<a href="#l36.73"></a><span id="l36.73"> </span>
<a href="#l36.74"></a><span id="l36.74">   // Deleting should work</span>
<a href="#l36.75"></a><span id="l36.75">   alarm.deleteAttachment(sound);</span>
<a href="#l36.76"></a><span id="l36.76" class="difflineminus">-  addedAttachments = alarm.getAttachments({});</span>
<a href="#l36.77"></a><span id="l36.77" class="difflineplus">+  addedAttachments = alarm.getAttachments();</span>
<a href="#l36.78"></a><span id="l36.78">   equal(addedAttachments.length, 0);</span>
<a href="#l36.79"></a><span id="l36.79"> </span>
<a href="#l36.80"></a><span id="l36.80">   // As well as clearing</span>
<a href="#l36.81"></a><span id="l36.81">   alarm.addAttachment(sound);</span>
<a href="#l36.82"></a><span id="l36.82">   alarm.clearAttachments();</span>
<a href="#l36.83"></a><span id="l36.83" class="difflineminus">-  addedAttachments = alarm.getAttachments({});</span>
<a href="#l36.84"></a><span id="l36.84" class="difflineplus">+  addedAttachments = alarm.getAttachments();</span>
<a href="#l36.85"></a><span id="l36.85">   equal(addedAttachments.length, 0);</span>
<a href="#l36.86"></a><span id="l36.86"> </span>
<a href="#l36.87"></a><span id="l36.87">   // AUDIO alarms should only be allowing one attachment, and folding any with the same value</span>
<a href="#l36.88"></a><span id="l36.88">   alarm.icalString = dedent`</span>
<a href="#l36.89"></a><span id="l36.89">         BEGIN:VALARM</span>
<a href="#l36.90"></a><span id="l36.90">         ACTION:AUDIO</span>
<a href="#l36.91"></a><span id="l36.91">         TRIGGER;VALUE=DURATION:-PT5M</span>
<a href="#l36.92"></a><span id="l36.92">         ATTACH:Basso</span>
<a href="#l36.93"></a><span id="l36.93" class="difflineat">@@ -232,50 +232,50 @@ function test_custom_alarm() {</span>
<a href="#l36.94"></a><span id="l36.94">   equal(alarm.summary, &quot;summary&quot;);</span>
<a href="#l36.95"></a><span id="l36.95"> </span>
<a href="#l36.96"></a><span id="l36.96">   // Test for attendees</span>
<a href="#l36.97"></a><span id="l36.97">   let attendee1 = cal.createAttendee();</span>
<a href="#l36.98"></a><span id="l36.98">   attendee1.id = &quot;mailto:horst&quot;;</span>
<a href="#l36.99"></a><span id="l36.99">   let attendee2 = cal.createAttendee();</span>
<a href="#l36.100"></a><span id="l36.100">   attendee2.id = &quot;mailto:gustav&quot;;</span>
<a href="#l36.101"></a><span id="l36.101"> </span>
<a href="#l36.102"></a><span id="l36.102" class="difflineminus">-  equal(alarm.getAttendees({}).length, 0);</span>
<a href="#l36.103"></a><span id="l36.103" class="difflineplus">+  equal(alarm.getAttendees().length, 0);</span>
<a href="#l36.104"></a><span id="l36.104">   alarm.addAttendee(attendee1);</span>
<a href="#l36.105"></a><span id="l36.105" class="difflineminus">-  equal(alarm.getAttendees({}).length, 1);</span>
<a href="#l36.106"></a><span id="l36.106" class="difflineplus">+  equal(alarm.getAttendees().length, 1);</span>
<a href="#l36.107"></a><span id="l36.107">   alarm.addAttendee(attendee2);</span>
<a href="#l36.108"></a><span id="l36.108" class="difflineminus">-  equal(alarm.getAttendees({}).length, 2);</span>
<a href="#l36.109"></a><span id="l36.109" class="difflineplus">+  equal(alarm.getAttendees().length, 2);</span>
<a href="#l36.110"></a><span id="l36.110">   alarm.addAttendee(attendee1);</span>
<a href="#l36.111"></a><span id="l36.111" class="difflineminus">-  equal(alarm.getAttendees({}).length, 2);</span>
<a href="#l36.112"></a><span id="l36.112" class="difflineplus">+  equal(alarm.getAttendees().length, 2);</span>
<a href="#l36.113"></a><span id="l36.113"> </span>
<a href="#l36.114"></a><span id="l36.114">   alarm.deleteAttendee(attendee1);</span>
<a href="#l36.115"></a><span id="l36.115" class="difflineminus">-  equal(alarm.getAttendees({}).length, 1);</span>
<a href="#l36.116"></a><span id="l36.116" class="difflineplus">+  equal(alarm.getAttendees().length, 1);</span>
<a href="#l36.117"></a><span id="l36.117"> </span>
<a href="#l36.118"></a><span id="l36.118">   alarm.clearAttendees();</span>
<a href="#l36.119"></a><span id="l36.119" class="difflineminus">-  equal(alarm.getAttendees({}).length, 0);</span>
<a href="#l36.120"></a><span id="l36.120" class="difflineplus">+  equal(alarm.getAttendees().length, 0);</span>
<a href="#l36.121"></a><span id="l36.121"> </span>
<a href="#l36.122"></a><span id="l36.122">   // Test for attachments</span>
<a href="#l36.123"></a><span id="l36.123">   let attach1 = cal.createAttachment();</span>
<a href="#l36.124"></a><span id="l36.124">   attach1.uri = Services.io.newURI(&quot;file:///example.txt&quot;);</span>
<a href="#l36.125"></a><span id="l36.125">   let attach2 = cal.createAttachment();</span>
<a href="#l36.126"></a><span id="l36.126">   attach2.uri = Services.io.newURI(&quot;file:///example2.txt&quot;);</span>
<a href="#l36.127"></a><span id="l36.127"> </span>
<a href="#l36.128"></a><span id="l36.128">   alarm.addAttachment(attach1);</span>
<a href="#l36.129"></a><span id="l36.129">   alarm.addAttachment(attach2);</span>
<a href="#l36.130"></a><span id="l36.130"> </span>
<a href="#l36.131"></a><span id="l36.131" class="difflineminus">-  let addedAttachments = alarm.getAttachments({});</span>
<a href="#l36.132"></a><span id="l36.132" class="difflineplus">+  let addedAttachments = alarm.getAttachments();</span>
<a href="#l36.133"></a><span id="l36.133">   equal(addedAttachments.length, 2);</span>
<a href="#l36.134"></a><span id="l36.134">   equal(addedAttachments[0], attach1);</span>
<a href="#l36.135"></a><span id="l36.135">   equal(addedAttachments[1], attach2);</span>
<a href="#l36.136"></a><span id="l36.136"> </span>
<a href="#l36.137"></a><span id="l36.137">   alarm.deleteAttachment(attach1);</span>
<a href="#l36.138"></a><span id="l36.138" class="difflineminus">-  addedAttachments = alarm.getAttachments({});</span>
<a href="#l36.139"></a><span id="l36.139" class="difflineplus">+  addedAttachments = alarm.getAttachments();</span>
<a href="#l36.140"></a><span id="l36.140">   equal(addedAttachments.length, 1);</span>
<a href="#l36.141"></a><span id="l36.141"> </span>
<a href="#l36.142"></a><span id="l36.142">   alarm.clearAttachments();</span>
<a href="#l36.143"></a><span id="l36.143" class="difflineminus">-  addedAttachments = alarm.getAttachments({});</span>
<a href="#l36.144"></a><span id="l36.144" class="difflineplus">+  addedAttachments = alarm.getAttachments();</span>
<a href="#l36.145"></a><span id="l36.145">   equal(addedAttachments.length, 0);</span>
<a href="#l36.146"></a><span id="l36.146"> }</span>
<a href="#l36.147"></a><span id="l36.147"> </span>
<a href="#l36.148"></a><span id="l36.148"> // Check if any combination of REPEAT and DURATION work as expected.</span>
<a href="#l36.149"></a><span id="l36.149"> function test_repeat() {</span>
<a href="#l36.150"></a><span id="l36.150">   dump(&quot;Testing REPEAT and DURATION properties...&quot;);</span>
<a href="#l36.151"></a><span id="l36.151">   let alarm = cal.createAlarm();</span>
<a href="#l36.152"></a><span id="l36.152"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/calendar/test/unit/test_alarmutils.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/calendar/test/unit/test_alarmutils.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -12,51 +12,51 @@ function run_test() {</span>
<a href="#l37.4"></a><span id="l37.4"> add_task(async function test_setDefaultValues_events() {</span>
<a href="#l37.5"></a><span id="l37.5">   let item, alarm;</span>
<a href="#l37.6"></a><span id="l37.6"> </span>
<a href="#l37.7"></a><span id="l37.7">   Services.prefs.setIntPref(&quot;calendar.alarms.onforevents&quot;, 1);</span>
<a href="#l37.8"></a><span id="l37.8">   Services.prefs.setStringPref(&quot;calendar.alarms.eventalarmunit&quot;, &quot;hours&quot;);</span>
<a href="#l37.9"></a><span id="l37.9">   Services.prefs.setIntPref(&quot;calendar.alarms.eventalarmlen&quot;, 60);</span>
<a href="#l37.10"></a><span id="l37.10">   item = cal.createEvent();</span>
<a href="#l37.11"></a><span id="l37.11">   cal.alarms.setDefaultValues(item);</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-  alarm = item.getAlarms({})[0];</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+  alarm = item.getAlarms()[0];</span>
<a href="#l37.14"></a><span id="l37.14">   ok(alarm);</span>
<a href="#l37.15"></a><span id="l37.15">   equal(alarm.related, alarm.ALARM_RELATED_START);</span>
<a href="#l37.16"></a><span id="l37.16">   equal(alarm.action, &quot;DISPLAY&quot;);</span>
<a href="#l37.17"></a><span id="l37.17">   equal(alarm.offset.icalString, &quot;-P2DT12H&quot;);</span>
<a href="#l37.18"></a><span id="l37.18"> </span>
<a href="#l37.19"></a><span id="l37.19">   Services.prefs.setIntPref(&quot;calendar.alarms.onforevents&quot;, 1);</span>
<a href="#l37.20"></a><span id="l37.20">   Services.prefs.setStringPref(&quot;calendar.alarms.eventalarmunit&quot;, &quot;yards&quot;);</span>
<a href="#l37.21"></a><span id="l37.21">   Services.prefs.setIntPref(&quot;calendar.alarms.eventalarmlen&quot;, 20);</span>
<a href="#l37.22"></a><span id="l37.22">   item = cal.createEvent();</span>
<a href="#l37.23"></a><span id="l37.23">   cal.alarms.setDefaultValues(item);</span>
<a href="#l37.24"></a><span id="l37.24" class="difflineminus">-  alarm = item.getAlarms({})[0];</span>
<a href="#l37.25"></a><span id="l37.25" class="difflineplus">+  alarm = item.getAlarms()[0];</span>
<a href="#l37.26"></a><span id="l37.26">   ok(alarm);</span>
<a href="#l37.27"></a><span id="l37.27">   equal(alarm.related, alarm.ALARM_RELATED_START);</span>
<a href="#l37.28"></a><span id="l37.28">   equal(alarm.action, &quot;DISPLAY&quot;);</span>
<a href="#l37.29"></a><span id="l37.29">   equal(alarm.offset.icalString, &quot;-PT20M&quot;);</span>
<a href="#l37.30"></a><span id="l37.30"> </span>
<a href="#l37.31"></a><span id="l37.31">   Services.prefs.setIntPref(&quot;calendar.alarms.onforevents&quot;, 0);</span>
<a href="#l37.32"></a><span id="l37.32">   item = cal.createEvent();</span>
<a href="#l37.33"></a><span id="l37.33">   cal.alarms.setDefaultValues(item);</span>
<a href="#l37.34"></a><span id="l37.34" class="difflineminus">-  equal(item.getAlarms({}).length, 0);</span>
<a href="#l37.35"></a><span id="l37.35" class="difflineplus">+  equal(item.getAlarms().length, 0);</span>
<a href="#l37.36"></a><span id="l37.36"> </span>
<a href="#l37.37"></a><span id="l37.37">   let mockCalendar = {</span>
<a href="#l37.38"></a><span id="l37.38">     getProperty: function() {</span>
<a href="#l37.39"></a><span id="l37.39">       return [&quot;SHOUT&quot;];</span>
<a href="#l37.40"></a><span id="l37.40">     },</span>
<a href="#l37.41"></a><span id="l37.41">   };</span>
<a href="#l37.42"></a><span id="l37.42"> </span>
<a href="#l37.43"></a><span id="l37.43">   Services.prefs.setIntPref(&quot;calendar.alarms.onforevents&quot;, 1);</span>
<a href="#l37.44"></a><span id="l37.44">   Services.prefs.setStringPref(&quot;calendar.alarms.eventalarmunit&quot;, &quot;hours&quot;);</span>
<a href="#l37.45"></a><span id="l37.45">   Services.prefs.setIntPref(&quot;calendar.alarms.eventalarmlen&quot;, 60);</span>
<a href="#l37.46"></a><span id="l37.46">   item = cal.createEvent();</span>
<a href="#l37.47"></a><span id="l37.47">   item.calendar = mockCalendar;</span>
<a href="#l37.48"></a><span id="l37.48">   cal.alarms.setDefaultValues(item);</span>
<a href="#l37.49"></a><span id="l37.49" class="difflineminus">-  alarm = item.getAlarms({})[0];</span>
<a href="#l37.50"></a><span id="l37.50" class="difflineplus">+  alarm = item.getAlarms()[0];</span>
<a href="#l37.51"></a><span id="l37.51">   ok(alarm);</span>
<a href="#l37.52"></a><span id="l37.52">   equal(alarm.related, alarm.ALARM_RELATED_START);</span>
<a href="#l37.53"></a><span id="l37.53">   equal(alarm.action, &quot;SHOUT&quot;);</span>
<a href="#l37.54"></a><span id="l37.54">   equal(alarm.offset.icalString, &quot;-P2DT12H&quot;);</span>
<a href="#l37.55"></a><span id="l37.55"> </span>
<a href="#l37.56"></a><span id="l37.56">   Services.prefs.clearUserPref(&quot;calendar.alarms.onforevents&quot;);</span>
<a href="#l37.57"></a><span id="l37.57">   Services.prefs.clearUserPref(&quot;calendar.alarms.eventalarmunit&quot;);</span>
<a href="#l37.58"></a><span id="l37.58">   Services.prefs.clearUserPref(&quot;calendar.alarms.eventalarmlen&quot;);</span>
<a href="#l37.59"></a><span id="l37.59" class="difflineat">@@ -71,52 +71,52 @@ add_task(async function test_setDefaultV</span>
<a href="#l37.60"></a><span id="l37.60">   };</span>
<a href="#l37.61"></a><span id="l37.61"> </span>
<a href="#l37.62"></a><span id="l37.62">   Services.prefs.setIntPref(&quot;calendar.alarms.onfortodos&quot;, 1);</span>
<a href="#l37.63"></a><span id="l37.63">   Services.prefs.setStringPref(&quot;calendar.alarms.todoalarmunit&quot;, &quot;hours&quot;);</span>
<a href="#l37.64"></a><span id="l37.64">   Services.prefs.setIntPref(&quot;calendar.alarms.todoalarmlen&quot;, 60);</span>
<a href="#l37.65"></a><span id="l37.65">   item = cal.createTodo();</span>
<a href="#l37.66"></a><span id="l37.66">   equal(item.entryDate, null);</span>
<a href="#l37.67"></a><span id="l37.67">   cal.alarms.setDefaultValues(item);</span>
<a href="#l37.68"></a><span id="l37.68" class="difflineminus">-  alarm = item.getAlarms({})[0];</span>
<a href="#l37.69"></a><span id="l37.69" class="difflineplus">+  alarm = item.getAlarms()[0];</span>
<a href="#l37.70"></a><span id="l37.70">   ok(alarm);</span>
<a href="#l37.71"></a><span id="l37.71">   equal(alarm.related, alarm.ALARM_RELATED_START);</span>
<a href="#l37.72"></a><span id="l37.72">   equal(alarm.action, &quot;DISPLAY&quot;);</span>
<a href="#l37.73"></a><span id="l37.73">   equal(alarm.offset.icalString, &quot;-P2DT12H&quot;);</span>
<a href="#l37.74"></a><span id="l37.74">   equal(item.entryDate, nowDate);</span>
<a href="#l37.75"></a><span id="l37.75"> </span>
<a href="#l37.76"></a><span id="l37.76">   Services.prefs.setIntPref(&quot;calendar.alarms.onfortodos&quot;, 1);</span>
<a href="#l37.77"></a><span id="l37.77">   Services.prefs.setStringPref(&quot;calendar.alarms.todoalarmunit&quot;, &quot;yards&quot;);</span>
<a href="#l37.78"></a><span id="l37.78">   Services.prefs.setIntPref(&quot;calendar.alarms.todoalarmlen&quot;, 20);</span>
<a href="#l37.79"></a><span id="l37.79">   item = cal.createTodo();</span>
<a href="#l37.80"></a><span id="l37.80">   cal.alarms.setDefaultValues(item);</span>
<a href="#l37.81"></a><span id="l37.81" class="difflineminus">-  alarm = item.getAlarms({})[0];</span>
<a href="#l37.82"></a><span id="l37.82" class="difflineplus">+  alarm = item.getAlarms()[0];</span>
<a href="#l37.83"></a><span id="l37.83">   ok(alarm);</span>
<a href="#l37.84"></a><span id="l37.84">   equal(alarm.related, alarm.ALARM_RELATED_START);</span>
<a href="#l37.85"></a><span id="l37.85">   equal(alarm.action, &quot;DISPLAY&quot;);</span>
<a href="#l37.86"></a><span id="l37.86">   equal(alarm.offset.icalString, &quot;-PT20M&quot;);</span>
<a href="#l37.87"></a><span id="l37.87"> </span>
<a href="#l37.88"></a><span id="l37.88">   Services.prefs.setIntPref(&quot;calendar.alarms.onfortodos&quot;, 0);</span>
<a href="#l37.89"></a><span id="l37.89">   item = cal.createTodo();</span>
<a href="#l37.90"></a><span id="l37.90">   cal.alarms.setDefaultValues(item);</span>
<a href="#l37.91"></a><span id="l37.91" class="difflineminus">-  equal(item.getAlarms({}).length, 0);</span>
<a href="#l37.92"></a><span id="l37.92" class="difflineplus">+  equal(item.getAlarms().length, 0);</span>
<a href="#l37.93"></a><span id="l37.93"> </span>
<a href="#l37.94"></a><span id="l37.94">   let mockCalendar = {</span>
<a href="#l37.95"></a><span id="l37.95">     getProperty: function() {</span>
<a href="#l37.96"></a><span id="l37.96">       return [&quot;SHOUT&quot;];</span>
<a href="#l37.97"></a><span id="l37.97">     },</span>
<a href="#l37.98"></a><span id="l37.98">   };</span>
<a href="#l37.99"></a><span id="l37.99"> </span>
<a href="#l37.100"></a><span id="l37.100">   Services.prefs.setIntPref(&quot;calendar.alarms.onfortodos&quot;, 1);</span>
<a href="#l37.101"></a><span id="l37.101">   Services.prefs.setStringPref(&quot;calendar.alarms.todoalarmunit&quot;, &quot;hours&quot;);</span>
<a href="#l37.102"></a><span id="l37.102">   Services.prefs.setIntPref(&quot;calendar.alarms.todoalarmlen&quot;, 60);</span>
<a href="#l37.103"></a><span id="l37.103">   item = cal.createTodo();</span>
<a href="#l37.104"></a><span id="l37.104">   item.calendar = mockCalendar;</span>
<a href="#l37.105"></a><span id="l37.105">   cal.alarms.setDefaultValues(item);</span>
<a href="#l37.106"></a><span id="l37.106" class="difflineminus">-  alarm = item.getAlarms({})[0];</span>
<a href="#l37.107"></a><span id="l37.107" class="difflineplus">+  alarm = item.getAlarms()[0];</span>
<a href="#l37.108"></a><span id="l37.108">   ok(alarm);</span>
<a href="#l37.109"></a><span id="l37.109">   equal(alarm.related, alarm.ALARM_RELATED_START);</span>
<a href="#l37.110"></a><span id="l37.110">   equal(alarm.action, &quot;SHOUT&quot;);</span>
<a href="#l37.111"></a><span id="l37.111">   equal(alarm.offset.icalString, &quot;-P2DT12H&quot;);</span>
<a href="#l37.112"></a><span id="l37.112"> </span>
<a href="#l37.113"></a><span id="l37.113">   Services.prefs.clearUserPref(&quot;calendar.alarms.onfortodos&quot;);</span>
<a href="#l37.114"></a><span id="l37.114">   Services.prefs.clearUserPref(&quot;calendar.alarms.todoalarmunit&quot;);</span>
<a href="#l37.115"></a><span id="l37.115">   Services.prefs.clearUserPref(&quot;calendar.alarms.todoalarmlen&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/calendar/test/unit/test_attendee.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/calendar/test/unit/test_attendee.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -6,20 +6,18 @@ function run_test() {</span>
<a href="#l38.4"></a><span id="l38.4">   test_values();</span>
<a href="#l38.5"></a><span id="l38.5">   test_serialize();</span>
<a href="#l38.6"></a><span id="l38.6">   test_properties();</span>
<a href="#l38.7"></a><span id="l38.7">   test_doubleParameters(); // Bug 875739</span>
<a href="#l38.8"></a><span id="l38.8"> }</span>
<a href="#l38.9"></a><span id="l38.9"> </span>
<a href="#l38.10"></a><span id="l38.10"> function test_values() {</span>
<a href="#l38.11"></a><span id="l38.11">   function findAttendeesInResults(event, expectedAttendees) {</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-    let countObj = {};</span>
<a href="#l38.13"></a><span id="l38.13">     // Getting all attendees</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineminus">-    let allAttendees = event.getAttendees(countObj);</span>
<a href="#l38.15"></a><span id="l38.15" class="difflineminus">-    equal(countObj.value, allAttendees.length);</span>
<a href="#l38.16"></a><span id="l38.16" class="difflineplus">+    let allAttendees = event.getAttendees();</span>
<a href="#l38.17"></a><span id="l38.17"> </span>
<a href="#l38.18"></a><span id="l38.18">     equal(allAttendees.length, expectedAttendees.length);</span>
<a href="#l38.19"></a><span id="l38.19"> </span>
<a href="#l38.20"></a><span id="l38.20">     // Check if all expected attendees are found</span>
<a href="#l38.21"></a><span id="l38.21">     for (let i = 0; i &lt; expectedAttendees.length; i++) {</span>
<a href="#l38.22"></a><span id="l38.22">       ok(allAttendees.includes(expectedAttendees[i]));</span>
<a href="#l38.23"></a><span id="l38.23">     }</span>
<a href="#l38.24"></a><span id="l38.24"> </span>
<a href="#l38.25"></a><span id="l38.25" class="difflineat">@@ -79,18 +77,18 @@ function test_values() {</span>
<a href="#l38.26"></a><span id="l38.26">   attendee1.makeImmutable();</span>
<a href="#l38.27"></a><span id="l38.27">   testImmutability(attendee1, properties);</span>
<a href="#l38.28"></a><span id="l38.28">   // Testing cascaded immutability (event -&gt; attendee)</span>
<a href="#l38.29"></a><span id="l38.29">   event.makeImmutable();</span>
<a href="#l38.30"></a><span id="l38.30">   testImmutability(attendee2, properties);</span>
<a href="#l38.31"></a><span id="l38.31"> </span>
<a href="#l38.32"></a><span id="l38.32">   // Testing cloning</span>
<a href="#l38.33"></a><span id="l38.33">   let eventClone = event.clone();</span>
<a href="#l38.34"></a><span id="l38.34" class="difflineminus">-  let clonedatts = eventClone.getAttendees({});</span>
<a href="#l38.35"></a><span id="l38.35" class="difflineminus">-  let atts = event.getAttendees({});</span>
<a href="#l38.36"></a><span id="l38.36" class="difflineplus">+  let clonedatts = eventClone.getAttendees();</span>
<a href="#l38.37"></a><span id="l38.37" class="difflineplus">+  let atts = event.getAttendees();</span>
<a href="#l38.38"></a><span id="l38.38">   equal(atts.length, clonedatts.length);</span>
<a href="#l38.39"></a><span id="l38.39"> </span>
<a href="#l38.40"></a><span id="l38.40">   for (let i = 0; i &lt; clonedatts.length; i++) {</span>
<a href="#l38.41"></a><span id="l38.41">     // The attributes should not be equal</span>
<a href="#l38.42"></a><span id="l38.42">     notEqual(atts[i], clonedatts[i]);</span>
<a href="#l38.43"></a><span id="l38.43">     // But the ids should</span>
<a href="#l38.44"></a><span id="l38.44">     equal(atts[i].id, clonedatts[i].id);</span>
<a href="#l38.45"></a><span id="l38.45">   }</span>
<a href="#l38.46"></a><span id="l38.46" class="difflineat">@@ -283,13 +281,13 @@ function test_doubleParameters() {</span>
<a href="#l38.47"></a><span id="l38.47">     attendee4: {</span>
<a href="#l38.48"></a><span id="l38.48">       param: [&quot;CN&quot;, &quot;PARTSTAT&quot;, &quot;X-RECEIVED-DTSTAMP&quot;, &quot;X-RECEIVED-SEQUENCE&quot;],</span>
<a href="#l38.49"></a><span id="l38.49">       values: [&quot;CN_attendee4&quot;, &quot;ACCEPTED&quot;, &quot;20130827T124944Z&quot;, &quot;0&quot;],</span>
<a href="#l38.50"></a><span id="l38.50">     },</span>
<a href="#l38.51"></a><span id="l38.51">   };</span>
<a href="#l38.52"></a><span id="l38.52"> </span>
<a href="#l38.53"></a><span id="l38.53">   let event = createEventFromIcalString(ics);</span>
<a href="#l38.54"></a><span id="l38.54">   let organizer = [event.organizer];</span>
<a href="#l38.55"></a><span id="l38.55" class="difflineminus">-  let attendees = event.getAttendees({});</span>
<a href="#l38.56"></a><span id="l38.56" class="difflineplus">+  let attendees = event.getAttendees();</span>
<a href="#l38.57"></a><span id="l38.57"> </span>
<a href="#l38.58"></a><span id="l38.58">   testParameters(organizer, expectedOrganizer);</span>
<a href="#l38.59"></a><span id="l38.59">   testParameters(attendees, expectedAttendee);</span>
<a href="#l38.60"></a><span id="l38.60"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/calendar/test/unit/test_bug1199942.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/calendar/test/unit/test_bug1199942.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -51,17 +51,17 @@ function serializeEvent_test() {</span>
<a href="#l39.4"></a><span id="l39.4"> </span>
<a href="#l39.5"></a><span id="l39.5">   let expectedIds = [</span>
<a href="#l39.6"></a><span id="l39.6">     &quot;mailto:user2@example.net&quot;,</span>
<a href="#l39.7"></a><span id="l39.7">     &quot;mailto:user3@example.net&quot;,</span>
<a href="#l39.8"></a><span id="l39.8">     &quot;mailto:user4@example.net&quot;,</span>
<a href="#l39.9"></a><span id="l39.9">     &quot;urn:uuid:user5&quot;,</span>
<a href="#l39.10"></a><span id="l39.10">   ];</span>
<a href="#l39.11"></a><span id="l39.11">   let event = createEventFromIcalString(ics);</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-  let attendees = event.getAttendees({});</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+  let attendees = event.getAttendees();</span>
<a href="#l39.14"></a><span id="l39.14"> </span>
<a href="#l39.15"></a><span id="l39.15">   // check whether all attendees get returned with expected id</span>
<a href="#l39.16"></a><span id="l39.16">   for (let attendee of attendees) {</span>
<a href="#l39.17"></a><span id="l39.17">     ok(expectedIds.includes(attendee.id));</span>
<a href="#l39.18"></a><span id="l39.18">   }</span>
<a href="#l39.19"></a><span id="l39.19"> </span>
<a href="#l39.20"></a><span id="l39.20">   // serialize the event again and check whether the attendees still are in shape</span>
<a href="#l39.21"></a><span id="l39.21">   let serializer = Cc[&quot;@mozilla.org/calendar/ics-serializer;1&quot;].createInstance(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/calendar/test/unit/test_bug1204255.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/calendar/test/unit/test_bug1204255.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -117,17 +117,17 @@ function test_fromICS() {</span>
<a href="#l40.4"></a><span id="l40.4">     { id: &quot;mailto:user2@example.net&quot;, partstat: &quot;NEEDS-ACTION&quot;, cname: &quot;PREFIXED&quot; },</span>
<a href="#l40.5"></a><span id="l40.5">     { id: &quot;mailto:user3@example.net&quot;, partstat: &quot;NEEDS-ACTION&quot;, cname: &quot;NOT PREFIXED&quot; },</span>
<a href="#l40.6"></a><span id="l40.6">     { id: &quot;mailto:user4@example.net&quot;, partstat: &quot;ACCEPTED&quot;, cname: &quot;PREFIXED&quot; },</span>
<a href="#l40.7"></a><span id="l40.7">     { id: &quot;mailto:user5@example.net&quot;, partstat: &quot;TENTATIVE&quot;, cname: &quot;NOT PREFIXED&quot; },</span>
<a href="#l40.8"></a><span id="l40.8">     { id: &quot;mailto:user6@example.net&quot;, partstat: &quot;DECLINED&quot;, cname: &quot;NOT PREFIXED&quot; },</span>
<a href="#l40.9"></a><span id="l40.9">     { id: &quot;mailto:user7@example.net&quot;, partstat: &quot;DECLINED&quot;, cname: &quot;PREFIXED&quot; },</span>
<a href="#l40.10"></a><span id="l40.10">   ];</span>
<a href="#l40.11"></a><span id="l40.11">   let event = createEventFromIcalString(ics);</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-  let attendees = event.getAttendees({});</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+  let attendees = event.getAttendees();</span>
<a href="#l40.14"></a><span id="l40.14"> </span>
<a href="#l40.15"></a><span id="l40.15">   // check whether all attendees get returned as expected</span>
<a href="#l40.16"></a><span id="l40.16">   equal(attendees.length, expected.length);</span>
<a href="#l40.17"></a><span id="l40.17">   let count = 0;</span>
<a href="#l40.18"></a><span id="l40.18">   for (let attendee of attendees) {</span>
<a href="#l40.19"></a><span id="l40.19">     for (let exp of expected) {</span>
<a href="#l40.20"></a><span id="l40.20">       if (attendee.id == exp.id) {</span>
<a href="#l40.21"></a><span id="l40.21">         equal(attendee.participationStatus, exp.partstat, &quot;partstat matches for &quot; + exp.id);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/calendar/test/unit/test_bug1209399.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/calendar/test/unit/test_bug1209399.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -98,14 +98,14 @@ function test_fromICS() {</span>
<a href="#l41.4"></a><span id="l41.4">     { id: &quot;mailto:user4@example.net&quot;, cname: &quot;&quot; },</span>
<a href="#l41.5"></a><span id="l41.5">     { id: &quot;mailto:user5@example.net&quot;, cname: &quot;&quot; },</span>
<a href="#l41.6"></a><span id="l41.6">     { id: &quot;mailto:user6@example.net&quot;, cname: null },</span>
<a href="#l41.7"></a><span id="l41.7">     { id: &quot;mailto:user7@example.net&quot;, cname: &quot;&quot; },</span>
<a href="#l41.8"></a><span id="l41.8">     { id: &quot;mailto:user8@example.net&quot;, cname: &quot;&quot; },</span>
<a href="#l41.9"></a><span id="l41.9">   ];</span>
<a href="#l41.10"></a><span id="l41.10">   let event = createEventFromIcalString(ics);</span>
<a href="#l41.11"></a><span id="l41.11"> </span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-  equal(event.getAttendees({}).length, expected.length, &quot;Check test consistency&quot;);</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+  equal(event.getAttendees().length, expected.length, &quot;Check test consistency&quot;);</span>
<a href="#l41.14"></a><span id="l41.14">   for (let exp of expected) {</span>
<a href="#l41.15"></a><span id="l41.15">     let attendee = event.getAttendeeById(exp.id);</span>
<a href="#l41.16"></a><span id="l41.16">     equal(attendee.commonName, exp.cname, &quot;Test for commonName matching of &quot; + exp.id);</span>
<a href="#l41.17"></a><span id="l41.17">   }</span>
<a href="#l41.18"></a><span id="l41.18"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/calendar/test/unit/test_bug494140.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/calendar/test/unit/test_bug494140.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -26,30 +26,30 @@ add_task(async () =&gt; {</span>
<a href="#l42.4"></a><span id="l42.4">       &quot;ACTION:DISPLAY\r\n&quot; +</span>
<a href="#l42.5"></a><span id="l42.5">       &quot;TRIGGER;VALUE=DURATION:-PT10M\r\n&quot; +</span>
<a href="#l42.6"></a><span id="l42.6">       &quot;DESCRIPTION:Mozilla Alarm: Test\r\n&quot; +</span>
<a href="#l42.7"></a><span id="l42.7">       &quot;END:VALARM\r\n&quot; +</span>
<a href="#l42.8"></a><span id="l42.8">       &quot;END:VEVENT&quot;</span>
<a href="#l42.9"></a><span id="l42.9">   );</span>
<a href="#l42.10"></a><span id="l42.10"> </span>
<a href="#l42.11"></a><span id="l42.11">   // There should be one alarm, one relation and one attachment</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-  equal(item.getAlarms({}).length, 1);</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineminus">-  equal(item.getRelations({}).length, 1);</span>
<a href="#l42.14"></a><span id="l42.14" class="difflineminus">-  equal(item.getAttachments({}).length, 1);</span>
<a href="#l42.15"></a><span id="l42.15" class="difflineplus">+  equal(item.getAlarms().length, 1);</span>
<a href="#l42.16"></a><span id="l42.16" class="difflineplus">+  equal(item.getRelations().length, 1);</span>
<a href="#l42.17"></a><span id="l42.17" class="difflineplus">+  equal(item.getAttachments().length, 1);</span>
<a href="#l42.18"></a><span id="l42.18"> </span>
<a href="#l42.19"></a><span id="l42.19">   // Change the occurrence to another day</span>
<a href="#l42.20"></a><span id="l42.20">   let occ = item.recurrenceInfo.getOccurrenceFor(cal.createDateTime(&quot;20090604T073000Z&quot;));</span>
<a href="#l42.21"></a><span id="l42.21">   occ.QueryInterface(Ci.calIEvent);</span>
<a href="#l42.22"></a><span id="l42.22">   occ.startDate = cal.createDateTime(&quot;20090618T073000Z&quot;);</span>
<a href="#l42.23"></a><span id="l42.23">   item.recurrenceInfo.modifyException(occ, true);</span>
<a href="#l42.24"></a><span id="l42.24"> </span>
<a href="#l42.25"></a><span id="l42.25">   // There should still be one alarm, one relation and one attachment</span>
<a href="#l42.26"></a><span id="l42.26" class="difflineminus">-  equal(item.getAlarms({}).length, 1);</span>
<a href="#l42.27"></a><span id="l42.27" class="difflineminus">-  equal(item.getRelations({}).length, 1);</span>
<a href="#l42.28"></a><span id="l42.28" class="difflineminus">-  equal(item.getAttachments({}).length, 1);</span>
<a href="#l42.29"></a><span id="l42.29" class="difflineplus">+  equal(item.getAlarms().length, 1);</span>
<a href="#l42.30"></a><span id="l42.30" class="difflineplus">+  equal(item.getRelations().length, 1);</span>
<a href="#l42.31"></a><span id="l42.31" class="difflineplus">+  equal(item.getAttachments().length, 1);</span>
<a href="#l42.32"></a><span id="l42.32"> </span>
<a href="#l42.33"></a><span id="l42.33">   // Add the item to the storage calendar and retrieve it again</span>
<a href="#l42.34"></a><span id="l42.34">   await new Promise(resolve =&gt; {</span>
<a href="#l42.35"></a><span id="l42.35">     storageCal.adoptItem(item, {</span>
<a href="#l42.36"></a><span id="l42.36">       onGetResult: function() {},</span>
<a href="#l42.37"></a><span id="l42.37">       onOperationComplete: resolve,</span>
<a href="#l42.38"></a><span id="l42.38">     });</span>
<a href="#l42.39"></a><span id="l42.39">   });</span>
<a href="#l42.40"></a><span id="l42.40" class="difflineat">@@ -58,12 +58,12 @@ add_task(async () =&gt; {</span>
<a href="#l42.41"></a><span id="l42.41">       onGetResult: function(cal, stat, type, detail, count, items) {</span>
<a href="#l42.42"></a><span id="l42.42">         resolve(items[0]);</span>
<a href="#l42.43"></a><span id="l42.43">       },</span>
<a href="#l42.44"></a><span id="l42.44">       onOperationComplete: function() {},</span>
<a href="#l42.45"></a><span id="l42.45">     });</span>
<a href="#l42.46"></a><span id="l42.46">   });</span>
<a href="#l42.47"></a><span id="l42.47"> </span>
<a href="#l42.48"></a><span id="l42.48">   // There should still be one alarm, one relation and one attachment</span>
<a href="#l42.49"></a><span id="l42.49" class="difflineminus">-  equal(retrievedItem.getAlarms({}).length, 1);</span>
<a href="#l42.50"></a><span id="l42.50" class="difflineminus">-  equal(retrievedItem.getRelations({}).length, 1);</span>
<a href="#l42.51"></a><span id="l42.51" class="difflineminus">-  equal(retrievedItem.getAttachments({}).length, 1);</span>
<a href="#l42.52"></a><span id="l42.52" class="difflineplus">+  equal(retrievedItem.getAlarms().length, 1);</span>
<a href="#l42.53"></a><span id="l42.53" class="difflineplus">+  equal(retrievedItem.getRelations().length, 1);</span>
<a href="#l42.54"></a><span id="l42.54" class="difflineplus">+  equal(retrievedItem.getAttachments().length, 1);</span>
<a href="#l42.55"></a><span id="l42.55"> });</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/calendar/test/unit/test_items.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/calendar/test/unit/test_items.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -90,71 +90,71 @@ function test_attachment() {</span>
<a href="#l43.4"></a><span id="l43.4"> </span>
<a href="#l43.5"></a><span id="l43.5">   let a = cal.createAttachment();</span>
<a href="#l43.6"></a><span id="l43.6">   a.rawData = &quot;horst&quot;;</span>
<a href="#l43.7"></a><span id="l43.7"> </span>
<a href="#l43.8"></a><span id="l43.8">   let b = cal.createAttachment();</span>
<a href="#l43.9"></a><span id="l43.9">   b.rawData = &quot;bruno&quot;;</span>
<a href="#l43.10"></a><span id="l43.10"> </span>
<a href="#l43.11"></a><span id="l43.11">   e.addAttachment(a);</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-  equal(e.getAttachments({}).length, 1);</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+  equal(e.getAttachments().length, 1);</span>
<a href="#l43.14"></a><span id="l43.14"> </span>
<a href="#l43.15"></a><span id="l43.15">   e.addAttachment(b);</span>
<a href="#l43.16"></a><span id="l43.16" class="difflineminus">-  equal(e.getAttachments({}).length, 2);</span>
<a href="#l43.17"></a><span id="l43.17" class="difflineplus">+  equal(e.getAttachments().length, 2);</span>
<a href="#l43.18"></a><span id="l43.18"> </span>
<a href="#l43.19"></a><span id="l43.19">   e.removeAttachment(a);</span>
<a href="#l43.20"></a><span id="l43.20" class="difflineminus">-  equal(e.getAttachments({}).length, 1);</span>
<a href="#l43.21"></a><span id="l43.21" class="difflineplus">+  equal(e.getAttachments().length, 1);</span>
<a href="#l43.22"></a><span id="l43.22"> </span>
<a href="#l43.23"></a><span id="l43.23">   e.removeAllAttachments();</span>
<a href="#l43.24"></a><span id="l43.24" class="difflineminus">-  equal(e.getAttachments({}).length, 0);</span>
<a href="#l43.25"></a><span id="l43.25" class="difflineplus">+  equal(e.getAttachments().length, 0);</span>
<a href="#l43.26"></a><span id="l43.26"> }</span>
<a href="#l43.27"></a><span id="l43.27"> </span>
<a href="#l43.28"></a><span id="l43.28"> function test_attendee() {</span>
<a href="#l43.29"></a><span id="l43.29">   let e = cal.createEvent();</span>
<a href="#l43.30"></a><span id="l43.30">   equal(e.getAttendeeById(&quot;unknown&quot;), null);</span>
<a href="#l43.31"></a><span id="l43.31" class="difflineminus">-  equal(e.getAttendees({}).length, 0);</span>
<a href="#l43.32"></a><span id="l43.32" class="difflineplus">+  equal(e.getAttendees().length, 0);</span>
<a href="#l43.33"></a><span id="l43.33"> </span>
<a href="#l43.34"></a><span id="l43.34">   let a = cal.createAttendee();</span>
<a href="#l43.35"></a><span id="l43.35">   a.id = &quot;mailto:horst&quot;;</span>
<a href="#l43.36"></a><span id="l43.36"> </span>
<a href="#l43.37"></a><span id="l43.37">   let b = cal.createAttendee();</span>
<a href="#l43.38"></a><span id="l43.38">   b.id = &quot;mailto:bruno&quot;;</span>
<a href="#l43.39"></a><span id="l43.39"> </span>
<a href="#l43.40"></a><span id="l43.40">   e.addAttendee(a);</span>
<a href="#l43.41"></a><span id="l43.41" class="difflineminus">-  equal(e.getAttendees({}).length, 1);</span>
<a href="#l43.42"></a><span id="l43.42" class="difflineplus">+  equal(e.getAttendees().length, 1);</span>
<a href="#l43.43"></a><span id="l43.43">   equal(e.getAttendeeById(&quot;mailto:horst&quot;), a);</span>
<a href="#l43.44"></a><span id="l43.44"> </span>
<a href="#l43.45"></a><span id="l43.45">   e.addAttendee(b);</span>
<a href="#l43.46"></a><span id="l43.46" class="difflineminus">-  equal(e.getAttendees({}).length, 2);</span>
<a href="#l43.47"></a><span id="l43.47" class="difflineplus">+  equal(e.getAttendees().length, 2);</span>
<a href="#l43.48"></a><span id="l43.48"> </span>
<a href="#l43.49"></a><span id="l43.49">   let comp = e.icalComponent;</span>
<a href="#l43.50"></a><span id="l43.50">   let aprop = comp.getFirstProperty(&quot;ATTENDEE&quot;);</span>
<a href="#l43.51"></a><span id="l43.51">   equal(aprop.value, &quot;mailto:horst&quot;);</span>
<a href="#l43.52"></a><span id="l43.52">   aprop = comp.getNextProperty(&quot;ATTENDEE&quot;);</span>
<a href="#l43.53"></a><span id="l43.53">   equal(aprop.value, &quot;mailto:bruno&quot;);</span>
<a href="#l43.54"></a><span id="l43.54">   equal(comp.getNextProperty(&quot;ATTENDEE&quot;), null);</span>
<a href="#l43.55"></a><span id="l43.55"> </span>
<a href="#l43.56"></a><span id="l43.56">   e.removeAttendee(a);</span>
<a href="#l43.57"></a><span id="l43.57" class="difflineminus">-  equal(e.getAttendees({}).length, 1);</span>
<a href="#l43.58"></a><span id="l43.58" class="difflineplus">+  equal(e.getAttendees().length, 1);</span>
<a href="#l43.59"></a><span id="l43.59">   equal(e.getAttendeeById(&quot;mailto:horst&quot;), null);</span>
<a href="#l43.60"></a><span id="l43.60"> </span>
<a href="#l43.61"></a><span id="l43.61">   e.removeAllAttendees();</span>
<a href="#l43.62"></a><span id="l43.62" class="difflineminus">-  equal(e.getAttendees({}).length, 0);</span>
<a href="#l43.63"></a><span id="l43.63" class="difflineplus">+  equal(e.getAttendees().length, 0);</span>
<a href="#l43.64"></a><span id="l43.64"> }</span>
<a href="#l43.65"></a><span id="l43.65"> </span>
<a href="#l43.66"></a><span id="l43.66"> function test_categories() {</span>
<a href="#l43.67"></a><span id="l43.67">   let e = cal.createEvent();</span>
<a href="#l43.68"></a><span id="l43.68"> </span>
<a href="#l43.69"></a><span id="l43.69" class="difflineminus">-  equal(e.getCategories({}).length, 0);</span>
<a href="#l43.70"></a><span id="l43.70" class="difflineplus">+  equal(e.getCategories().length, 0);</span>
<a href="#l43.71"></a><span id="l43.71"> </span>
<a href="#l43.72"></a><span id="l43.72">   let cat = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;];</span>
<a href="#l43.73"></a><span id="l43.73" class="difflineminus">-  e.setCategories(3, cat);</span>
<a href="#l43.74"></a><span id="l43.74" class="difflineplus">+  e.setCategories(cat);</span>
<a href="#l43.75"></a><span id="l43.75"> </span>
<a href="#l43.76"></a><span id="l43.76">   cat[0] = &quot;err&quot;;</span>
<a href="#l43.77"></a><span id="l43.77" class="difflineminus">-  equal(e.getCategories({}).join(&quot;,&quot;), &quot;a,b,c&quot;);</span>
<a href="#l43.78"></a><span id="l43.78" class="difflineplus">+  equal(e.getCategories().join(&quot;,&quot;), &quot;a,b,c&quot;);</span>
<a href="#l43.79"></a><span id="l43.79"> </span>
<a href="#l43.80"></a><span id="l43.80">   let comp = e.icalComponent;</span>
<a href="#l43.81"></a><span id="l43.81">   let getter = comp.getFirstProperty.bind(comp);</span>
<a href="#l43.82"></a><span id="l43.82"> </span>
<a href="#l43.83"></a><span id="l43.83">   cat[0] = &quot;a&quot;;</span>
<a href="#l43.84"></a><span id="l43.84">   while (cat.length) {</span>
<a href="#l43.85"></a><span id="l43.85">     equal(cat.shift(), getter(&quot;CATEGORIES&quot;).value);</span>
<a href="#l43.86"></a><span id="l43.86">     getter = comp.getNextProperty.bind(comp);</span>
<a href="#l43.87"></a><span id="l43.87" class="difflineat">@@ -173,23 +173,23 @@ function test_alarm() {</span>
<a href="#l43.88"></a><span id="l43.88">   let ecomp = e.icalComponent;</span>
<a href="#l43.89"></a><span id="l43.89">   let vcomp = ecomp.getFirstSubcomponent(&quot;VALARM&quot;);</span>
<a href="#l43.90"></a><span id="l43.90">   equal(vcomp.serializeToICS(), alarm.icalString);</span>
<a href="#l43.91"></a><span id="l43.91"> </span>
<a href="#l43.92"></a><span id="l43.92">   let alarm2 = alarm.clone();</span>
<a href="#l43.93"></a><span id="l43.93"> </span>
<a href="#l43.94"></a><span id="l43.94">   e.addAlarm(alarm2);</span>
<a href="#l43.95"></a><span id="l43.95"> </span>
<a href="#l43.96"></a><span id="l43.96" class="difflineminus">-  equal(e.getAlarms({}).length, 2);</span>
<a href="#l43.97"></a><span id="l43.97" class="difflineplus">+  equal(e.getAlarms().length, 2);</span>
<a href="#l43.98"></a><span id="l43.98">   e.deleteAlarm(alarm);</span>
<a href="#l43.99"></a><span id="l43.99" class="difflineminus">-  equal(e.getAlarms({}).length, 1);</span>
<a href="#l43.100"></a><span id="l43.100" class="difflineminus">-  equal(e.getAlarms({})[0], alarm2);</span>
<a href="#l43.101"></a><span id="l43.101" class="difflineplus">+  equal(e.getAlarms().length, 1);</span>
<a href="#l43.102"></a><span id="l43.102" class="difflineplus">+  equal(e.getAlarms()[0], alarm2);</span>
<a href="#l43.103"></a><span id="l43.103"> </span>
<a href="#l43.104"></a><span id="l43.104">   e.clearAlarms();</span>
<a href="#l43.105"></a><span id="l43.105" class="difflineminus">-  equal(e.getAlarms({}).length, 0);</span>
<a href="#l43.106"></a><span id="l43.106" class="difflineplus">+  equal(e.getAlarms().length, 0);</span>
<a href="#l43.107"></a><span id="l43.107"> }</span>
<a href="#l43.108"></a><span id="l43.108"> </span>
<a href="#l43.109"></a><span id="l43.109"> function test_immutable() {</span>
<a href="#l43.110"></a><span id="l43.110">   let event = cal.createEvent();</span>
<a href="#l43.111"></a><span id="l43.111"> </span>
<a href="#l43.112"></a><span id="l43.112">   let date = cal.createDateTime();</span>
<a href="#l43.113"></a><span id="l43.113">   date.timezone = cal.getTimezoneService().getTimezone(&quot;Europe/Berlin&quot;);</span>
<a href="#l43.114"></a><span id="l43.114">   event.alarmLastAck = date;</span>
<a href="#l43.115"></a><span id="l43.115" class="difflineat">@@ -203,17 +203,17 @@ function test_immutable() {</span>
<a href="#l43.116"></a><span id="l43.116">   alarm.description = &quot;foo&quot;;</span>
<a href="#l43.117"></a><span id="l43.117">   alarm.related = alarm.ALARM_RELATED_START;</span>
<a href="#l43.118"></a><span id="l43.118">   alarm.offset = cal.createDuration(&quot;PT1S&quot;);</span>
<a href="#l43.119"></a><span id="l43.119">   event.addAlarm(alarm);</span>
<a href="#l43.120"></a><span id="l43.120"> </span>
<a href="#l43.121"></a><span id="l43.121">   event.setProperty(&quot;X-NAME&quot;, &quot;X-VALUE&quot;);</span>
<a href="#l43.122"></a><span id="l43.122">   event.setPropertyParameter(&quot;X-NAME&quot;, &quot;X-PARAM&quot;, &quot;X-PARAMVAL&quot;);</span>
<a href="#l43.123"></a><span id="l43.123"> </span>
<a href="#l43.124"></a><span id="l43.124" class="difflineminus">-  event.setCategories(3, [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]);</span>
<a href="#l43.125"></a><span id="l43.125" class="difflineplus">+  event.setCategories([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]);</span>
<a href="#l43.126"></a><span id="l43.126"> </span>
<a href="#l43.127"></a><span id="l43.127">   equal(event.alarmLastAck.timezone.tzid, cal.dtz.UTC.tzid);</span>
<a href="#l43.128"></a><span id="l43.128"> </span>
<a href="#l43.129"></a><span id="l43.129">   event.makeImmutable();</span>
<a href="#l43.130"></a><span id="l43.130"> </span>
<a href="#l43.131"></a><span id="l43.131">   // call again, should not throw</span>
<a href="#l43.132"></a><span id="l43.132">   event.makeImmutable();</span>
<a href="#l43.133"></a><span id="l43.133"> </span>
<a href="#l43.134"></a><span id="l43.134" class="difflineat">@@ -226,17 +226,17 @@ function test_immutable() {</span>
<a href="#l43.135"></a><span id="l43.135">   }, /Can not modify immutable data container/);</span>
<a href="#l43.136"></a><span id="l43.136">   throws(() =&gt; {</span>
<a href="#l43.137"></a><span id="l43.137">     event.calendar = null;</span>
<a href="#l43.138"></a><span id="l43.138">   }, /Can not modify immutable data container/);</span>
<a href="#l43.139"></a><span id="l43.139">   throws(() =&gt; {</span>
<a href="#l43.140"></a><span id="l43.140">     event.parentItem = null;</span>
<a href="#l43.141"></a><span id="l43.141">   }, /Can not modify immutable data container/);</span>
<a href="#l43.142"></a><span id="l43.142">   throws(() =&gt; {</span>
<a href="#l43.143"></a><span id="l43.143" class="difflineminus">-    event.setCategories(3, [&quot;d&quot;, &quot;e&quot;, &quot;f&quot;]);</span>
<a href="#l43.144"></a><span id="l43.144" class="difflineplus">+    event.setCategories([&quot;d&quot;, &quot;e&quot;, &quot;f&quot;]);</span>
<a href="#l43.145"></a><span id="l43.145">   }, /Can not modify immutable data container/);</span>
<a href="#l43.146"></a><span id="l43.146"> </span>
<a href="#l43.147"></a><span id="l43.147">   let event2 = event.clone();</span>
<a href="#l43.148"></a><span id="l43.148">   event2.organizer.id = &quot;two&quot;;</span>
<a href="#l43.149"></a><span id="l43.149"> </span>
<a href="#l43.150"></a><span id="l43.150">   equal(org.id, &quot;one&quot;);</span>
<a href="#l43.151"></a><span id="l43.151">   equal(event2.organizer.id, &quot;two&quot;);</span>
<a href="#l43.152"></a><span id="l43.152"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/calendar/test/unit/test_relation.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/calendar/test/unit/test_relation.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -38,49 +38,47 @@ function run_test() {</span>
<a href="#l44.4"></a><span id="l44.4">   // test icalproperty</span>
<a href="#l44.5"></a><span id="l44.5">   // eslint-disable-next-line no-unused-expressions</span>
<a href="#l44.6"></a><span id="l44.6">   relation2.icalProperty;</span>
<a href="#l44.7"></a><span id="l44.7"> </span>
<a href="#l44.8"></a><span id="l44.8">   test_icalprop();</span>
<a href="#l44.9"></a><span id="l44.9"> }</span>
<a href="#l44.10"></a><span id="l44.10"> </span>
<a href="#l44.11"></a><span id="l44.11"> function checkRelations(event, expRel) {</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-  let countObj = {};</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineminus">-  let allRel = event.getRelations(countObj);</span>
<a href="#l44.14"></a><span id="l44.14" class="difflineminus">-  equal(countObj.value, allRel.length);</span>
<a href="#l44.15"></a><span id="l44.15" class="difflineplus">+  let allRel = event.getRelations();</span>
<a href="#l44.16"></a><span id="l44.16">   equal(allRel.length, expRel.length);</span>
<a href="#l44.17"></a><span id="l44.17"> </span>
<a href="#l44.18"></a><span id="l44.18">   // check if all expacted relations are found</span>
<a href="#l44.19"></a><span id="l44.19">   for (let i = 0; i &lt; expRel.length; i++) {</span>
<a href="#l44.20"></a><span id="l44.20">     ok(allRel.includes(expRel[i]));</span>
<a href="#l44.21"></a><span id="l44.21">   }</span>
<a href="#l44.22"></a><span id="l44.22"> </span>
<a href="#l44.23"></a><span id="l44.23">   // Check if all found relations are expected</span>
<a href="#l44.24"></a><span id="l44.24">   for (let i = 0; i &lt; allRel.length; i++) {</span>
<a href="#l44.25"></a><span id="l44.25">     ok(expRel.includes(allRel[i]));</span>
<a href="#l44.26"></a><span id="l44.26">   }</span>
<a href="#l44.27"></a><span id="l44.27"> }</span>
<a href="#l44.28"></a><span id="l44.28"> </span>
<a href="#l44.29"></a><span id="l44.29"> function modifyRelations(event, oldRel) {</span>
<a href="#l44.30"></a><span id="l44.30" class="difflineminus">-  let allRel = event.getRelations({});</span>
<a href="#l44.31"></a><span id="l44.31" class="difflineplus">+  let allRel = event.getRelations();</span>
<a href="#l44.32"></a><span id="l44.32">   let rel = allRel[0];</span>
<a href="#l44.33"></a><span id="l44.33"> </span>
<a href="#l44.34"></a><span id="l44.34">   // modify the properties</span>
<a href="#l44.35"></a><span id="l44.35">   rel.relType = &quot;SIBLING&quot;;</span>
<a href="#l44.36"></a><span id="l44.36">   equal(rel.relType, &quot;SIBLING&quot;);</span>
<a href="#l44.37"></a><span id="l44.37">   equal(rel.relType, allRel[0].relType);</span>
<a href="#l44.38"></a><span id="l44.38"> </span>
<a href="#l44.39"></a><span id="l44.39">   // remove one relation</span>
<a href="#l44.40"></a><span id="l44.40">   event.removeRelation(rel);</span>
<a href="#l44.41"></a><span id="l44.41" class="difflineminus">-  equal(event.getRelations({}).length, oldRel.length - 1);</span>
<a href="#l44.42"></a><span id="l44.42" class="difflineplus">+  equal(event.getRelations().length, oldRel.length - 1);</span>
<a href="#l44.43"></a><span id="l44.43"> </span>
<a href="#l44.44"></a><span id="l44.44">   // add one relation and remove all relations</span>
<a href="#l44.45"></a><span id="l44.45">   event.addRelation(oldRel[0]);</span>
<a href="#l44.46"></a><span id="l44.46">   event.removeAllRelations();</span>
<a href="#l44.47"></a><span id="l44.47" class="difflineminus">-  equal(event.getRelations({}), 0);</span>
<a href="#l44.48"></a><span id="l44.48" class="difflineplus">+  equal(event.getRelations(), 0);</span>
<a href="#l44.49"></a><span id="l44.49"> }</span>
<a href="#l44.50"></a><span id="l44.50"> </span>
<a href="#l44.51"></a><span id="l44.51"> function test_icalprop() {</span>
<a href="#l44.52"></a><span id="l44.52">   let rel = cal.createRelation();</span>
<a href="#l44.53"></a><span id="l44.53"> </span>
<a href="#l44.54"></a><span id="l44.54">   rel.relType = &quot;SIBLING&quot;;</span>
<a href="#l44.55"></a><span id="l44.55">   rel.setParameter(&quot;X-PROP&quot;, &quot;VAL&quot;);</span>
<a href="#l44.56"></a><span id="l44.56">   rel.relId = &quot;value&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/calendar/test/unit/test_storage.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/calendar/test/unit/test_storage.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -40,39 +40,39 @@ add_task(async () =&gt; {</span>
<a href="#l45.4"></a><span id="l45.4">       found: false,</span>
<a href="#l45.5"></a><span id="l45.5">       onGetResult: function(calendar, status, type, detail, count, items) {</span>
<a href="#l45.6"></a><span id="l45.6">         let item = items[0];</span>
<a href="#l45.7"></a><span id="l45.7"> </span>
<a href="#l45.8"></a><span id="l45.8">         // Check start date</span>
<a href="#l45.9"></a><span id="l45.9">         equal(item.startDate.compare(cal.createDateTime(&quot;20120101T010101Z&quot;)), 0);</span>
<a href="#l45.10"></a><span id="l45.10"> </span>
<a href="#l45.11"></a><span id="l45.11">         // Check attachment</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-        let attaches = item.getAttachments({});</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+        let attaches = item.getAttachments();</span>
<a href="#l45.14"></a><span id="l45.14">         let attach = attaches[0];</span>
<a href="#l45.15"></a><span id="l45.15">         equal(attaches.length, 1);</span>
<a href="#l45.16"></a><span id="l45.16">         equal(attach.uri.spec, &quot;http://example.com/test.ics&quot;);</span>
<a href="#l45.17"></a><span id="l45.17">         equal(attach.formatType, &quot;text/calendar&quot;);</span>
<a href="#l45.18"></a><span id="l45.18">         equal(attach.encoding, &quot;BASE64&quot;);</span>
<a href="#l45.19"></a><span id="l45.19">         equal(attach.getParameter(&quot;FILENAME&quot;), &quot;test.ics&quot;);</span>
<a href="#l45.20"></a><span id="l45.20"> </span>
<a href="#l45.21"></a><span id="l45.21">         // Check attendee</span>
<a href="#l45.22"></a><span id="l45.22" class="difflineminus">-        let attendees = item.getAttendees({});</span>
<a href="#l45.23"></a><span id="l45.23" class="difflineplus">+        let attendees = item.getAttendees();</span>
<a href="#l45.24"></a><span id="l45.24">         let attendee = attendees[0];</span>
<a href="#l45.25"></a><span id="l45.25">         equal(attendees.length, 1);</span>
<a href="#l45.26"></a><span id="l45.26">         equal(attendee.id, &quot;mailto:test@example.com&quot;);</span>
<a href="#l45.27"></a><span id="l45.27">         equal(attendee.commonName, &quot;Name&quot;);</span>
<a href="#l45.28"></a><span id="l45.28">         equal(attendee.rsvp, &quot;TRUE&quot;);</span>
<a href="#l45.29"></a><span id="l45.29">         equal(attendee.isOrganizer, false);</span>
<a href="#l45.30"></a><span id="l45.30">         equal(attendee.role, &quot;REQ-PARTICIPANT&quot;);</span>
<a href="#l45.31"></a><span id="l45.31">         equal(attendee.participationStatus, &quot;ACCEPTED&quot;);</span>
<a href="#l45.32"></a><span id="l45.32">         equal(attendee.userType, &quot;INDIVIDUAL&quot;);</span>
<a href="#l45.33"></a><span id="l45.33">         equal(attendee.getProperty(&quot;X-THING&quot;), &quot;BAR&quot;);</span>
<a href="#l45.34"></a><span id="l45.34"> </span>
<a href="#l45.35"></a><span id="l45.35">         // Check relation</span>
<a href="#l45.36"></a><span id="l45.36" class="difflineminus">-        let relations = item.getRelations({});</span>
<a href="#l45.37"></a><span id="l45.37" class="difflineplus">+        let relations = item.getRelations();</span>
<a href="#l45.38"></a><span id="l45.38">         let rel = relations[0];</span>
<a href="#l45.39"></a><span id="l45.39">         equal(relations.length, 1);</span>
<a href="#l45.40"></a><span id="l45.40">         equal(rel.relType, &quot;SIBLING&quot;);</span>
<a href="#l45.41"></a><span id="l45.41">         equal(rel.relId, &quot;VALUE&quot;);</span>
<a href="#l45.42"></a><span id="l45.42">         equal(rel.getParameter(&quot;FOO&quot;), &quot;BAR&quot;);</span>
<a href="#l45.43"></a><span id="l45.43"> </span>
<a href="#l45.44"></a><span id="l45.44">         // Check recurrence item</span>
<a href="#l45.45"></a><span id="l45.45">         for (let ritem of item.recurrenceInfo.getRecurrenceItems({})) {</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:32Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

