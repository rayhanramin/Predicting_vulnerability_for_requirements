<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 264:b5776223fe06fbdbd32d9eec9c620e48b761f2a2</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ b5776223fe06fbdbd32d9eec9c620e48b761f2a2" />
<meta property="og:url" content="/comm-central/rev/b5776223fe06fbdbd32d9eec9c620e48b761f2a2" />
<meta property="og:description" content="Bug 421428 nsIFolderListener should admit that it's passing nsIMsgFolders, r/sr=Neil" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / b5776223fe06fbdbd32d9eec9c620e48b761f2a2 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/b5776223fe06fbdbd32d9eec9c620e48b761f2a2">shortlog</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/b5776223fe06fbdbd32d9eec9c620e48b761f2a2">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2">files</a> |
changeset |
<a href="/comm-central/raw-rev/b5776223fe06fbdbd32d9eec9c620e48b761f2a2">raw</a>  | <a href="/comm-central/archive/b5776223fe06fbdbd32d9eec9c620e48b761f2a2.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=421428">Bug 421428</a> nsIFolderListener should admit that it's passing nsIMsgFolders, r/sr=Neil
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#101;&#121;&#32;&#77;&#105;&#110;&#116;&#97;&#32;&#60;&#106;&#109;&#105;&#110;&#116;&#97;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 05 Sep 2008 09:20:18 -0400</td></tr>

<tr>
 <td>changeset 264</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/b5776223fe06fbdbd32d9eec9c620e48b761f2a2">b5776223fe06fbdbd32d9eec9c620e48b761f2a2</a></td>
</tr>



<tr>
<td>parent 263</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/94c0142a32ac0ccb8d963a7938bc63bb21a34415">94c0142a32ac0ccb8d963a7938bc63bb21a34415</a>
</td>
</tr>

<tr>
<td>child 265</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/d6e5d976103e615ae181ad9103f7c726fb840859">d6e5d976103e615ae181ad9103f7c726fb840859</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=b5776223fe06fbdbd32d9eec9c620e48b761f2a2">235</a></td></tr>
<tr><td>push user</td><td>jminta@gmail.com</td></tr>
<tr><td>push date</td><td class="date age">Fri, 05 Sep 2008 13:27:03 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@b5776223fe06 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=b5776223fe06fbdbd32d9eec9c620e48b761f2a2">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=b5776223fe06fbdbd32d9eec9c620e48b761f2a2&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=b5776223fe06fbdbd32d9eec9c620e48b761f2a2&newProject=comm-central&newRevision=b5776223fe06fbdbd32d9eec9c620e48b761f2a2&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=b5776223fe06fbdbd32d9eec9c620e48b761f2a2&newProject=comm-central&newRevision=b5776223fe06fbdbd32d9eec9c620e48b761f2a2&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=b5776223fe06fbdbd32d9eec9c620e48b761f2a2&newProject=comm-central&newRevision=b5776223fe06fbdbd32d9eec9c620e48b761f2a2&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>

<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=421428">421428</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=421428">Bug 421428</a> nsIFolderListener should admit that it's passing nsIMsgFolders, r/sr=Neil</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/messageWindow.js">mail/base/content/messageWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/messageWindow.js">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/messageWindow.js">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/messageWindow.js">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/messageWindow.js">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/messageWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/msgMail3PaneWindow.js">mail/base/content/msgMail3PaneWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/msgMail3PaneWindow.js">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/msgMail3PaneWindow.js">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/msgMail3PaneWindow.js">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/msgMail3PaneWindow.js">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mail/base/content/msgMail3PaneWindow.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/public/nsIFolderListener.idl">mailnews/base/public/nsIFolderListener.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/public/nsIFolderListener.idl">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/public/nsIFolderListener.idl">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/public/nsIFolderListener.idl">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/public/nsIFolderListener.idl">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/public/nsIFolderListener.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/messageWindow.js">mailnews/base/resources/content/messageWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/messageWindow.js">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/messageWindow.js">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/messageWindow.js">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/messageWindow.js">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/messageWindow.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/msgMail3PaneWindow.js">mailnews/base/resources/content/msgMail3PaneWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/msgMail3PaneWindow.js">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/msgMail3PaneWindow.js">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/msgMail3PaneWindow.js">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/msgMail3PaneWindow.js">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/resources/content/msgMail3PaneWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessenger.cpp">mailnews/base/src/nsMessenger.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessenger.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessenger.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessenger.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessenger.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessenger.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOS2Integration.cpp">mailnews/base/src/nsMessengerOS2Integration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOS2Integration.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOS2Integration.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOS2Integration.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOS2Integration.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOS2Integration.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOSXIntegration.cpp">mailnews/base/src/nsMessengerOSXIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOSXIntegration.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOSXIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOSXIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOSXIntegration.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerOSXIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerUnixIntegration.cpp">mailnews/base/src/nsMessengerUnixIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerUnixIntegration.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerUnixIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerUnixIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerUnixIntegration.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerUnixIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerWinIntegration.cpp">mailnews/base/src/nsMessengerWinIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerWinIntegration.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerWinIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerWinIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerWinIntegration.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMessengerWinIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManager.cpp">mailnews/base/src/nsMsgAccountManager.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManager.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManager.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManager.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManager.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManager.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManagerDS.cpp">mailnews/base/src/nsMsgAccountManagerDS.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManagerDS.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManagerDS.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManagerDS.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManagerDS.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgAccountManagerDS.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.cpp">mailnews/base/src/nsMsgFolderDataSource.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.h">mailnews/base/src/nsMsgFolderDataSource.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.h">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.h">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.h">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.h">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgFolderDataSource.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgMailSession.cpp">mailnews/base/src/nsMsgMailSession.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgMailSession.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgMailSession.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgMailSession.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgMailSession.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsMsgMailSession.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsStatusBarBiffManager.cpp">mailnews/base/src/nsStatusBarBiffManager.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsStatusBarBiffManager.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsStatusBarBiffManager.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsStatusBarBiffManager.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsStatusBarBiffManager.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/base/src/nsStatusBarBiffManager.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsLocalUndoTxn.cpp">mailnews/local/src/nsLocalUndoTxn.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsLocalUndoTxn.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsLocalUndoTxn.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsLocalUndoTxn.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsLocalUndoTxn.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsLocalUndoTxn.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsPop3IncomingServer.cpp">mailnews/local/src/nsPop3IncomingServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsPop3IncomingServer.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsPop3IncomingServer.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsPop3IncomingServer.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsPop3IncomingServer.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsPop3IncomingServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsRssIncomingServer.cpp">mailnews/local/src/nsRssIncomingServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsRssIncomingServer.cpp">file</a> |
<a href="/comm-central/annotate/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsRssIncomingServer.cpp">annotate</a> |
<a href="/comm-central/diff/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsRssIncomingServer.cpp">diff</a> |
<a href="/comm-central/comparison/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsRssIncomingServer.cpp">comparison</a> |
<a href="/comm-central/log/b5776223fe06fbdbd32d9eec9c620e48b761f2a2/mailnews/local/src/nsRssIncomingServer.cpp">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/messageWindow.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/messageWindow.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -54,27 +54,27 @@ var gRerootOnFolderLoadForStandAlone = f</span>
<a href="#l1.4"></a><span id="l1.4"> var gNextMessageAfterLoad = null;</span>
<a href="#l1.5"></a><span id="l1.5"> var gMessageToLoad = nsMsgKey_None;</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7"> // the folderListener object</span>
<a href="#l1.8"></a><span id="l1.8"> var folderListener = {</span>
<a href="#l1.9"></a><span id="l1.9">   OnItemAdded: function(parentItem, item) {},</span>
<a href="#l1.10"></a><span id="l1.10"> </span>
<a href="#l1.11"></a><span id="l1.11">   OnItemRemoved: function(parentItem, item) {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    if (parentItem.Value != gCurrentFolderUri)</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    if (parentItem.URI != gCurrentFolderUri)</span>
<a href="#l1.14"></a><span id="l1.14">       return;</span>
<a href="#l1.15"></a><span id="l1.15"> </span>
<a href="#l1.16"></a><span id="l1.16">     if (item instanceof Components.interfaces.nsIMsgDBHdr &amp;&amp;</span>
<a href="#l1.17"></a><span id="l1.17">         extractMsgKeyFromURI() == item.messageKey)</span>
<a href="#l1.18"></a><span id="l1.18">       gCurrentMessageIsDeleted = true;</span>
<a href="#l1.19"></a><span id="l1.19">   },</span>
<a href="#l1.20"></a><span id="l1.20"> </span>
<a href="#l1.21"></a><span id="l1.21">   OnItemPropertyChanged: function(item, property, oldValue, newValue) {},</span>
<a href="#l1.22"></a><span id="l1.22">   OnItemIntPropertyChanged: function(item, property, oldValue, newValue) {</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineminus">-    if (item.Value == gCurrentFolderUri) {</span>
<a href="#l1.24"></a><span id="l1.24" class="difflineplus">+    if (item.URI == gCurrentFolderUri) {</span>
<a href="#l1.25"></a><span id="l1.25">       if (property.toString() == &quot;TotalMessages&quot; || property.toString() == &quot;TotalUnreadMessages&quot;) {</span>
<a href="#l1.26"></a><span id="l1.26">         UpdateStandAloneMessageCounts();</span>
<a href="#l1.27"></a><span id="l1.27">       }</span>
<a href="#l1.28"></a><span id="l1.28">     }</span>
<a href="#l1.29"></a><span id="l1.29">   },</span>
<a href="#l1.30"></a><span id="l1.30">   OnItemBoolPropertyChanged: function(item, property, oldValue, newValue) {},</span>
<a href="#l1.31"></a><span id="l1.31">   OnItemUnicharPropertyChanged: function(item, property, oldValue, newValue){},</span>
<a href="#l1.32"></a><span id="l1.32">   OnItemPropertyFlagChanged: function(item, property, oldFlag, newFlag) {},</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineat">@@ -86,22 +86,19 @@ var folderListener = {</span>
<a href="#l1.34"></a><span id="l1.34">       HandleDeleteOrMoveMsgCompleted(folder);</span>
<a href="#l1.35"></a><span id="l1.35">     else if (eventType == &quot;DeleteOrMoveMsgFailed&quot;)</span>
<a href="#l1.36"></a><span id="l1.36">       HandleDeleteOrMoveMsgFailed(folder);</span>
<a href="#l1.37"></a><span id="l1.37">     else if (eventType == &quot;FolderLoaded&quot;) {</span>
<a href="#l1.38"></a><span id="l1.38">       if (folder) {</span>
<a href="#l1.39"></a><span id="l1.39">         var uri = folder.URI;</span>
<a href="#l1.40"></a><span id="l1.40">         if (uri == gCurrentFolderToRerootForStandAlone) {</span>
<a href="#l1.41"></a><span id="l1.41">           gCurrentFolderToRerootForStandAlone = null;</span>
<a href="#l1.42"></a><span id="l1.42" class="difflineminus">-          var msgFolder = folder.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l1.43"></a><span id="l1.43" class="difflineminus">-          if (msgFolder) {</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineminus">-            msgFolder.endFolderLoading();</span>
<a href="#l1.45"></a><span id="l1.45" class="difflineminus">-            if (gRerootOnFolderLoadForStandAlone) {</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineminus">-              RerootFolderForStandAlone(uri);</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineminus">-            }</span>
<a href="#l1.48"></a><span id="l1.48" class="difflineplus">+          folder.endFolderLoading();</span>
<a href="#l1.49"></a><span id="l1.49" class="difflineplus">+          if (gRerootOnFolderLoadForStandAlone) {</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineplus">+            RerootFolderForStandAlone(uri);</span>
<a href="#l1.51"></a><span id="l1.51">           }</span>
<a href="#l1.52"></a><span id="l1.52">         }</span>
<a href="#l1.53"></a><span id="l1.53">       }</span>
<a href="#l1.54"></a><span id="l1.54">     }</span>
<a href="#l1.55"></a><span id="l1.55">     else if (eventType == &quot;JunkStatusChanged&quot;) {</span>
<a href="#l1.56"></a><span id="l1.56">       HandleJunkStatusChanged(folder);</span>
<a href="#l1.57"></a><span id="l1.57">     }</span>
<a href="#l1.58"></a><span id="l1.58">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -167,16 +167,17 @@ var folderListener = {</span>
<a href="#l2.4"></a><span id="l2.4">     OnItemRemoved: function(parentItem, item) { },</span>
<a href="#l2.5"></a><span id="l2.5"> </span>
<a href="#l2.6"></a><span id="l2.6">     OnItemPropertyChanged: function(item, property, oldValue, newValue) { },</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8">     OnItemIntPropertyChanged: function(item, property, oldValue, newValue) {</span>
<a href="#l2.9"></a><span id="l2.9">       if (item == gMsgFolderSelected) {</span>
<a href="#l2.10"></a><span id="l2.10">         if(property.toString() == &quot;TotalMessages&quot; || property.toString() == &quot;TotalUnreadMessages&quot;) {</span>
<a href="#l2.11"></a><span id="l2.11">           UpdateStatusMessageCounts(gMsgFolderSelected);</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+          item = item.QueryInterface(Components.interfaces.nsIRDFResource);</span>
<a href="#l2.13"></a><span id="l2.13">           UpdateFolderLocationPicker(item);</span>
<a href="#l2.14"></a><span id="l2.14">         }</span>
<a href="#l2.15"></a><span id="l2.15">       }</span>
<a href="#l2.16"></a><span id="l2.16">     },</span>
<a href="#l2.17"></a><span id="l2.17"> </span>
<a href="#l2.18"></a><span id="l2.18">     OnItemBoolPropertyChanged: function(item, property, oldValue, newValue) { },</span>
<a href="#l2.19"></a><span id="l2.19"> </span>
<a href="#l2.20"></a><span id="l2.20">     OnItemUnicharPropertyChanged: function(item, property, oldValue, newValue) { },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/base/public/nsIFolderListener.idl</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/base/public/nsIFolderListener.idl</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -34,51 +34,50 @@</span>
<a href="#l3.4"></a><span id="l3.4">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l3.5"></a><span id="l3.5">  *</span>
<a href="#l3.6"></a><span id="l3.6">  * ***** END LICENSE BLOCK ***** */</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> #include &quot;nsISupports.idl&quot;</span>
<a href="#l3.9"></a><span id="l3.9"> #include &quot;nsIAtom.idl&quot;</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11"> interface nsIMsgFolder;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-interface nsIRDFResource;</span>
<a href="#l3.13"></a><span id="l3.13"> interface nsIMsgDBHdr;</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15"> typedef unsigned long folderListenerNotifyFlagValue;</span>
<a href="#l3.16"></a><span id="l3.16"> </span>
<a href="#l3.17"></a><span id="l3.17"> [scriptable, uuid(1c8e6a86-ae35-4c95-8e43-b2e98d6d1574)]</span>
<a href="#l3.18"></a><span id="l3.18"> interface nsIFolderListener : nsISupports {</span>
<a href="#l3.19"></a><span id="l3.19">   const folderListenerNotifyFlagValue added = 0x1;</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineminus">-  void OnItemAdded(in nsIRDFResource aParentItem,</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+  void OnItemAdded(in nsIMsgFolder aParentItem,</span>
<a href="#l3.22"></a><span id="l3.22">                    in nsISupports aItem);</span>
<a href="#l3.23"></a><span id="l3.23">   </span>
<a href="#l3.24"></a><span id="l3.24">   const folderListenerNotifyFlagValue removed = 0x2;</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineminus">-  void OnItemRemoved(in nsIRDFResource aParentItem,</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+  void OnItemRemoved(in nsIMsgFolder aParentItem,</span>
<a href="#l3.27"></a><span id="l3.27">                      in nsISupports aItem);</span>
<a href="#l3.28"></a><span id="l3.28">   </span>
<a href="#l3.29"></a><span id="l3.29">   const folderListenerNotifyFlagValue propertyChanged = 0x4;</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-  void OnItemPropertyChanged(in nsIRDFResource aItem,</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+  void OnItemPropertyChanged(in nsIMsgFolder aItem,</span>
<a href="#l3.32"></a><span id="l3.32">                              in nsIAtom aProperty,</span>
<a href="#l3.33"></a><span id="l3.33">                              in string aOldValue,</span>
<a href="#l3.34"></a><span id="l3.34">                              in string aNewValue);</span>
<a href="#l3.35"></a><span id="l3.35">   </span>
<a href="#l3.36"></a><span id="l3.36">   const folderListenerNotifyFlagValue intPropertyChanged = 0x8;</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineminus">-  void OnItemIntPropertyChanged(in nsIRDFResource aItem,</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+  void OnItemIntPropertyChanged(in nsIMsgFolder aItem,</span>
<a href="#l3.39"></a><span id="l3.39">                                 in nsIAtom aProperty,</span>
<a href="#l3.40"></a><span id="l3.40">                                 in long aOldValue,</span>
<a href="#l3.41"></a><span id="l3.41">                                 in long aNewValue);</span>
<a href="#l3.42"></a><span id="l3.42">   </span>
<a href="#l3.43"></a><span id="l3.43">   const folderListenerNotifyFlagValue boolPropertyChanged = 0x10;</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineminus">-  void OnItemBoolPropertyChanged(in nsIRDFResource aItem,</span>
<a href="#l3.45"></a><span id="l3.45" class="difflineplus">+  void OnItemBoolPropertyChanged(in nsIMsgFolder aItem,</span>
<a href="#l3.46"></a><span id="l3.46">                                  in nsIAtom aProperty,</span>
<a href="#l3.47"></a><span id="l3.47">                                  in boolean aOldValue,</span>
<a href="#l3.48"></a><span id="l3.48">                                  in boolean aNewValue);</span>
<a href="#l3.49"></a><span id="l3.49">   </span>
<a href="#l3.50"></a><span id="l3.50">   const folderListenerNotifyFlagValue unicharPropertyChanged = 0x20;</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineminus">-  void OnItemUnicharPropertyChanged(in nsIRDFResource aItem,</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineplus">+  void OnItemUnicharPropertyChanged(in nsIMsgFolder aItem,</span>
<a href="#l3.53"></a><span id="l3.53">                                     in nsIAtom aProperty,</span>
<a href="#l3.54"></a><span id="l3.54">                                     in wstring aOldValue,</span>
<a href="#l3.55"></a><span id="l3.55">                                     in wstring aNewValue);</span>
<a href="#l3.56"></a><span id="l3.56">   </span>
<a href="#l3.57"></a><span id="l3.57">   const folderListenerNotifyFlagValue propertyFlagChanged = 0x40;</span>
<a href="#l3.58"></a><span id="l3.58">   void OnItemPropertyFlagChanged(in nsIMsgDBHdr aItem,</span>
<a href="#l3.59"></a><span id="l3.59">                                  in nsIAtom aProperty,</span>
<a href="#l3.60"></a><span id="l3.60">                                  in unsigned long aOldFlag,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/base/resources/content/messageWindow.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/base/resources/content/messageWindow.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -53,27 +53,27 @@ var gCurrentFolderToRerootForStandAlone;</span>
<a href="#l4.4"></a><span id="l4.4"> var gRerootOnFolderLoadForStandAlone = false;</span>
<a href="#l4.5"></a><span id="l4.5"> var gNextMessageAfterLoad = null;</span>
<a href="#l4.6"></a><span id="l4.6"> </span>
<a href="#l4.7"></a><span id="l4.7"> // the folderListener object</span>
<a href="#l4.8"></a><span id="l4.8"> var folderListener = {</span>
<a href="#l4.9"></a><span id="l4.9">   OnItemAdded: function(parentItem, item) {},</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11">   OnItemRemoved: function(parentItem, item) {</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-    if (parentItem.Value != gCurrentFolderUri)</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+    if (parentItem.URI != gCurrentFolderUri)</span>
<a href="#l4.14"></a><span id="l4.14">       return;</span>
<a href="#l4.15"></a><span id="l4.15"> </span>
<a href="#l4.16"></a><span id="l4.16">     if (item instanceof Components.interfaces.nsIMsgDBHdr &amp;&amp;</span>
<a href="#l4.17"></a><span id="l4.17">         extractMsgKeyFromURI() == item.messageKey)</span>
<a href="#l4.18"></a><span id="l4.18">       gCurrentMessageIsDeleted = true;</span>
<a href="#l4.19"></a><span id="l4.19">   },</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21">   OnItemPropertyChanged: function(item, property, oldValue, newValue) {},</span>
<a href="#l4.22"></a><span id="l4.22">   OnItemIntPropertyChanged: function(item, property, oldValue, newValue) { </span>
<a href="#l4.23"></a><span id="l4.23" class="difflineminus">-    if (item.Value == gCurrentFolderUri) {</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineplus">+    if (item.URI == gCurrentFolderUri) {</span>
<a href="#l4.25"></a><span id="l4.25">       if (property.toString() == &quot;TotalMessages&quot; || property.toString() == &quot;TotalUnreadMessages&quot;) {</span>
<a href="#l4.26"></a><span id="l4.26">         UpdateStandAloneMessageCounts();</span>
<a href="#l4.27"></a><span id="l4.27">       }      </span>
<a href="#l4.28"></a><span id="l4.28">     }</span>
<a href="#l4.29"></a><span id="l4.29">   },</span>
<a href="#l4.30"></a><span id="l4.30">   OnItemBoolPropertyChanged: function(item, property, oldValue, newValue) {},</span>
<a href="#l4.31"></a><span id="l4.31">   OnItemUnicharPropertyChanged: function(item, property, oldValue, newValue){},</span>
<a href="#l4.32"></a><span id="l4.32">   OnItemPropertyFlagChanged: function(item, property, oldFlag, newFlag) {},</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineat">@@ -85,22 +85,19 @@ var folderListener = {</span>
<a href="#l4.34"></a><span id="l4.34">       HandleDeleteOrMoveMsgCompleted(folder);</span>
<a href="#l4.35"></a><span id="l4.35">     else if (eventType == &quot;DeleteOrMoveMsgFailed&quot;)</span>
<a href="#l4.36"></a><span id="l4.36">       HandleDeleteOrMoveMsgFailed(folder);</span>
<a href="#l4.37"></a><span id="l4.37">     else if (eventType == &quot;FolderLoaded&quot;) {</span>
<a href="#l4.38"></a><span id="l4.38">       if (folder) {</span>
<a href="#l4.39"></a><span id="l4.39">         var uri = folder.URI;</span>
<a href="#l4.40"></a><span id="l4.40">         if (uri == gCurrentFolderToRerootForStandAlone) {</span>
<a href="#l4.41"></a><span id="l4.41">           gCurrentFolderToRerootForStandAlone = null;</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineminus">-          var msgFolder = folder.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineminus">-          if (msgFolder) {</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineminus">-            msgFolder.endFolderLoading();</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineminus">-            if (gRerootOnFolderLoadForStandAlone) {</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineminus">-              RerootFolderForStandAlone(uri);</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineminus">-            }</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+          folder.endFolderLoading();</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineplus">+          if (gRerootOnFolderLoadForStandAlone) {</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineplus">+            RerootFolderForStandAlone(uri);</span>
<a href="#l4.51"></a><span id="l4.51">           }   </span>
<a href="#l4.52"></a><span id="l4.52">         }</span>
<a href="#l4.53"></a><span id="l4.53">       }</span>
<a href="#l4.54"></a><span id="l4.54">     }</span>
<a href="#l4.55"></a><span id="l4.55">     else if (eventType == &quot;JunkStatusChanged&quot;) {</span>
<a href="#l4.56"></a><span id="l4.56">       HandleJunkStatusChanged(folder);</span>
<a href="#l4.57"></a><span id="l4.57">     }</span>
<a href="#l4.58"></a><span id="l4.58">   }   </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/base/resources/content/msgMail3PaneWindow.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/base/resources/content/msgMail3PaneWindow.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -155,16 +155,17 @@ var folderListener = {</span>
<a href="#l5.4"></a><span id="l5.4">     OnItemRemoved: function(parentItem, item) { },</span>
<a href="#l5.5"></a><span id="l5.5"> </span>
<a href="#l5.6"></a><span id="l5.6">     OnItemPropertyChanged: function(item, property, oldValue, newValue) { },</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8">     OnItemIntPropertyChanged: function(item, property, oldValue, newValue) {</span>
<a href="#l5.9"></a><span id="l5.9">       if (item == gMsgFolderSelected) {</span>
<a href="#l5.10"></a><span id="l5.10">         if(property.toString() == &quot;TotalMessages&quot; || property.toString() == &quot;TotalUnreadMessages&quot;) {</span>
<a href="#l5.11"></a><span id="l5.11">           UpdateStatusMessageCounts(gMsgFolderSelected);</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+          item = item.QueryInterface(Components.interfaces.nsIRDFResource);</span>
<a href="#l5.13"></a><span id="l5.13">           UpdateLocationBar(item);</span>
<a href="#l5.14"></a><span id="l5.14">         }</span>
<a href="#l5.15"></a><span id="l5.15">       }</span>
<a href="#l5.16"></a><span id="l5.16">     },</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18">     OnItemBoolPropertyChanged: function(item, property, oldValue, newValue) { },</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20">     OnItemUnicharPropertyChanged: function(item, property, oldValue, newValue) { },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -2144,24 +2144,24 @@ NS_IMETHODIMP nsMessenger::GetNavigateHi</span>
<a href="#l6.4"></a><span id="l6.4">     if (!*next)</span>
<a href="#l6.5"></a><span id="l6.5">       return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l6.6"></a><span id="l6.6">     next++;</span>
<a href="#l6.7"></a><span id="l6.7">   }</span>
<a href="#l6.8"></a><span id="l6.8">   *aHistoryUris = outArray;</span>
<a href="#l6.9"></a><span id="l6.9">   return NS_OK;</span>
<a href="#l6.10"></a><span id="l6.10"> }</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-/* void OnItemAdded (in nsIRDFResource parentItem, in nsISupports item); */</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-NS_IMETHODIMP nsMessenger::OnItemAdded(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+/* void OnItemAdded (in nsIMsgFolder parentItem, in nsISupports item); */</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+NS_IMETHODIMP nsMessenger::OnItemAdded(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l6.16"></a><span id="l6.16"> {</span>
<a href="#l6.17"></a><span id="l6.17">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l6.18"></a><span id="l6.18"> }</span>
<a href="#l6.19"></a><span id="l6.19"> </span>
<a href="#l6.20"></a><span id="l6.20" class="difflineminus">-/* void OnItemRemoved (in nsIRDFResource parentItem, in nsISupports item); */</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineminus">-NS_IMETHODIMP nsMessenger::OnItemRemoved(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+/* void OnItemRemoved (in nsIMsgFolder parentItem, in nsISupports item); */</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+NS_IMETHODIMP nsMessenger::OnItemRemoved(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l6.24"></a><span id="l6.24"> {</span>
<a href="#l6.25"></a><span id="l6.25">   // check if this item is a message header that's in our history list. If so,</span>
<a href="#l6.26"></a><span id="l6.26">   // remove it from the history list.</span>
<a href="#l6.27"></a><span id="l6.27">   nsCOMPtr &lt;nsIMsgDBHdr&gt; msgHdr = do_QueryInterface(item);</span>
<a href="#l6.28"></a><span id="l6.28">   if (msgHdr)</span>
<a href="#l6.29"></a><span id="l6.29">   {</span>
<a href="#l6.30"></a><span id="l6.30">     nsCOMPtr &lt;nsIMsgFolder&gt; folder;</span>
<a href="#l6.31"></a><span id="l6.31">     msgHdr-&gt;GetFolder(getter_AddRefs(folder));</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineat">@@ -2181,36 +2181,36 @@ NS_IMETHODIMP nsMessenger::OnItemRemoved</span>
<a href="#l6.33"></a><span id="l6.33">         if ((PRInt32) mCurHistoryPos &gt;= uriPos)</span>
<a href="#l6.34"></a><span id="l6.34">           mCurHistoryPos -= 2;</span>
<a href="#l6.35"></a><span id="l6.35">       }</span>
<a href="#l6.36"></a><span id="l6.36">     }</span>
<a href="#l6.37"></a><span id="l6.37">   }</span>
<a href="#l6.38"></a><span id="l6.38">   return NS_OK;</span>
<a href="#l6.39"></a><span id="l6.39"> }</span>
<a href="#l6.40"></a><span id="l6.40"> </span>
<a href="#l6.41"></a><span id="l6.41" class="difflineminus">-/* void OnItemPropertyChanged (in nsIRDFResource item, in nsIAtom property, in string oldValue, in string newValue); */</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineminus">-NS_IMETHODIMP nsMessenger::OnItemPropertyChanged(nsIRDFResource *item, nsIAtom *property, const char *oldValue, const char *newValue)</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineplus">+/* void OnItemPropertyChanged (in nsIMsgFolder item, in nsIAtom property, in string oldValue, in string newValue); */</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+NS_IMETHODIMP nsMessenger::OnItemPropertyChanged(nsIMsgFolder *item, nsIAtom *property, const char *oldValue, const char *newValue)</span>
<a href="#l6.45"></a><span id="l6.45"> {</span>
<a href="#l6.46"></a><span id="l6.46">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l6.47"></a><span id="l6.47"> }</span>
<a href="#l6.48"></a><span id="l6.48"> </span>
<a href="#l6.49"></a><span id="l6.49" class="difflineminus">-/* void OnItemIntPropertyChanged (in nsIRDFResource item, in nsIAtom property, in long oldValue, in long newValue); */</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-NS_IMETHODIMP nsMessenger::OnItemIntPropertyChanged(nsIRDFResource *item, nsIAtom *property, PRInt32 oldValue, PRInt32 newValue)</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+/* void OnItemIntPropertyChanged (in nsIMsgFolder item, in nsIAtom property, in long oldValue, in long newValue); */</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+NS_IMETHODIMP nsMessenger::OnItemIntPropertyChanged(nsIMsgFolder *item, nsIAtom *property, PRInt32 oldValue, PRInt32 newValue)</span>
<a href="#l6.53"></a><span id="l6.53"> {</span>
<a href="#l6.54"></a><span id="l6.54">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l6.55"></a><span id="l6.55"> }</span>
<a href="#l6.56"></a><span id="l6.56"> </span>
<a href="#l6.57"></a><span id="l6.57" class="difflineminus">-/* void OnItemBoolPropertyChanged (in nsIRDFResource item, in nsIAtom property, in boolean oldValue, in boolean newValue); */</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineminus">-NS_IMETHODIMP nsMessenger::OnItemBoolPropertyChanged(nsIRDFResource *item, nsIAtom *property, PRBool oldValue, PRBool newValue)</span>
<a href="#l6.59"></a><span id="l6.59" class="difflineplus">+/* void OnItemBoolPropertyChanged (in nsIMsgFolder item, in nsIAtom property, in boolean oldValue, in boolean newValue); */</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineplus">+NS_IMETHODIMP nsMessenger::OnItemBoolPropertyChanged(nsIMsgFolder *item, nsIAtom *property, PRBool oldValue, PRBool newValue)</span>
<a href="#l6.61"></a><span id="l6.61"> {</span>
<a href="#l6.62"></a><span id="l6.62">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l6.63"></a><span id="l6.63"> }</span>
<a href="#l6.64"></a><span id="l6.64"> </span>
<a href="#l6.65"></a><span id="l6.65" class="difflineminus">-/* void OnItemUnicharPropertyChanged (in nsIRDFResource item, in nsIAtom property, in wstring oldValue, in wstring newValue); */</span>
<a href="#l6.66"></a><span id="l6.66" class="difflineminus">-NS_IMETHODIMP nsMessenger::OnItemUnicharPropertyChanged(nsIRDFResource *item, nsIAtom *property, const PRUnichar *oldValue, const PRUnichar *newValue)</span>
<a href="#l6.67"></a><span id="l6.67" class="difflineplus">+/* void OnItemUnicharPropertyChanged (in nsIMsgFolder item, in nsIAtom property, in wstring oldValue, in wstring newValue); */</span>
<a href="#l6.68"></a><span id="l6.68" class="difflineplus">+NS_IMETHODIMP nsMessenger::OnItemUnicharPropertyChanged(nsIMsgFolder *item, nsIAtom *property, const PRUnichar *oldValue, const PRUnichar *newValue)</span>
<a href="#l6.69"></a><span id="l6.69"> {</span>
<a href="#l6.70"></a><span id="l6.70">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l6.71"></a><span id="l6.71"> }</span>
<a href="#l6.72"></a><span id="l6.72"> </span>
<a href="#l6.73"></a><span id="l6.73"> /* void OnItemPropertyFlagChanged (in nsIMsgDBHdr item, in nsIAtom property, in unsigned long oldFlag, in unsigned long newFlag); */</span>
<a href="#l6.74"></a><span id="l6.74"> NS_IMETHODIMP nsMessenger::OnItemPropertyFlagChanged(nsIMsgDBHdr *item, nsIAtom *property, PRUint32 oldFlag, PRUint32 newFlag)</span>
<a href="#l6.75"></a><span id="l6.75"> {</span>
<a href="#l6.76"></a><span id="l6.76">   return NS_ERROR_NOT_IMPLEMENTED;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerOS2Integration.cpp</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerOS2Integration.cpp</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -103,59 +103,59 @@ nsMessengerOS2Integration::Init()</span>
<a href="#l7.4"></a><span id="l7.4">   // because we care if the default server changes</span>
<a href="#l7.5"></a><span id="l7.5">   rv = accountManager-&gt;AddRootFolderListener(this);</span>
<a href="#l7.6"></a><span id="l7.6">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8">   return NS_OK;</span>
<a href="#l7.9"></a><span id="l7.9"> }</span>
<a href="#l7.10"></a><span id="l7.10"> </span>
<a href="#l7.11"></a><span id="l7.11"> NS_IMETHODIMP</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-nsMessengerOS2Integration::OnItemPropertyChanged(nsIRDFResource *, nsIAtom *, char const *, char const *)</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+nsMessengerOS2Integration::OnItemPropertyChanged(nsIMsgFolder *, nsIAtom *, char const *, char const *)</span>
<a href="#l7.14"></a><span id="l7.14"> {</span>
<a href="#l7.15"></a><span id="l7.15">   return NS_OK;</span>
<a href="#l7.16"></a><span id="l7.16"> }</span>
<a href="#l7.17"></a><span id="l7.17"> </span>
<a href="#l7.18"></a><span id="l7.18"> NS_IMETHODIMP</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineminus">-nsMessengerOS2Integration::OnItemUnicharPropertyChanged(nsIRDFResource *, nsIAtom *, const PRUnichar *, const PRUnichar *)</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+nsMessengerOS2Integration::OnItemUnicharPropertyChanged(nsIMsgFolder *, nsIAtom *, const PRUnichar *, const PRUnichar *)</span>
<a href="#l7.21"></a><span id="l7.21"> {</span>
<a href="#l7.22"></a><span id="l7.22">   return NS_OK;</span>
<a href="#l7.23"></a><span id="l7.23"> }</span>
<a href="#l7.24"></a><span id="l7.24"> </span>
<a href="#l7.25"></a><span id="l7.25"> NS_IMETHODIMP</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineminus">-nsMessengerOS2Integration::OnItemRemoved(nsIRDFResource *, nsISupports *)</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+nsMessengerOS2Integration::OnItemRemoved(nsIMsgFolder *, nsISupports *)</span>
<a href="#l7.28"></a><span id="l7.28"> {</span>
<a href="#l7.29"></a><span id="l7.29">   return NS_OK;</span>
<a href="#l7.30"></a><span id="l7.30"> }</span>
<a href="#l7.31"></a><span id="l7.31"> </span>
<a href="#l7.32"></a><span id="l7.32"> NS_IMETHODIMP</span>
<a href="#l7.33"></a><span id="l7.33"> nsMessengerOS2Integration::OnItemPropertyFlagChanged(nsIMsgDBHdr *item, nsIAtom *property, PRUint32 oldFlag, PRUint32 newFlag)</span>
<a href="#l7.34"></a><span id="l7.34"> {</span>
<a href="#l7.35"></a><span id="l7.35">   return NS_OK;</span>
<a href="#l7.36"></a><span id="l7.36"> }</span>
<a href="#l7.37"></a><span id="l7.37"> </span>
<a href="#l7.38"></a><span id="l7.38"> NS_IMETHODIMP</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineminus">-nsMessengerOS2Integration::OnItemAdded(nsIRDFResource *, nsISupports *)</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineplus">+nsMessengerOS2Integration::OnItemAdded(nsIMsgFolder *, nsISupports *)</span>
<a href="#l7.41"></a><span id="l7.41"> {</span>
<a href="#l7.42"></a><span id="l7.42">   return NS_OK;</span>
<a href="#l7.43"></a><span id="l7.43"> }</span>
<a href="#l7.44"></a><span id="l7.44"> </span>
<a href="#l7.45"></a><span id="l7.45"> NS_IMETHODIMP</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineminus">-nsMessengerOS2Integration::OnItemBoolPropertyChanged(nsIRDFResource *aItem, nsIAtom *aProperty, PRBool aOldValue, PRBool aNewValue)</span>
<a href="#l7.47"></a><span id="l7.47" class="difflineplus">+nsMessengerOS2Integration::OnItemBoolPropertyChanged(nsIMsgFolder *aItem, nsIAtom *aProperty, PRBool aOldValue, PRBool aNewValue)</span>
<a href="#l7.48"></a><span id="l7.48"> {</span>
<a href="#l7.49"></a><span id="l7.49">   return NS_OK;</span>
<a href="#l7.50"></a><span id="l7.50"> }</span>
<a href="#l7.51"></a><span id="l7.51"> </span>
<a href="#l7.52"></a><span id="l7.52"> NS_IMETHODIMP</span>
<a href="#l7.53"></a><span id="l7.53"> nsMessengerOS2Integration::OnItemEvent(nsIMsgFolder *, nsIAtom *)</span>
<a href="#l7.54"></a><span id="l7.54"> {</span>
<a href="#l7.55"></a><span id="l7.55">   return NS_OK;</span>
<a href="#l7.56"></a><span id="l7.56"> }</span>
<a href="#l7.57"></a><span id="l7.57"> </span>
<a href="#l7.58"></a><span id="l7.58"> NS_IMETHODIMP</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineminus">-nsMessengerOS2Integration::OnItemIntPropertyChanged(nsIRDFResource *aItem, nsIAtom *aProperty, PRInt32 aOldValue, PRInt32 aNewValue)</span>
<a href="#l7.60"></a><span id="l7.60" class="difflineplus">+nsMessengerOS2Integration::OnItemIntPropertyChanged(nsIMsgFolder *aItem, nsIAtom *aProperty, PRInt32 aOldValue, PRInt32 aNewValue)</span>
<a href="#l7.61"></a><span id="l7.61"> {</span>
<a href="#l7.62"></a><span id="l7.62">   PULONG pUnreadState = NULL;</span>
<a href="#l7.63"></a><span id="l7.63">   APIRET rc = DosGetNamedSharedMem((PVOID *)&amp;pUnreadState, WARPCENTER_SHAREDMEM,</span>
<a href="#l7.64"></a><span id="l7.64">                                    PAG_READ | PAG_WRITE);</span>
<a href="#l7.65"></a><span id="l7.65">   if (rc != NO_ERROR)</span>
<a href="#l7.66"></a><span id="l7.66">     return NS_OK;</span>
<a href="#l7.67"></a><span id="l7.67"> </span>
<a href="#l7.68"></a><span id="l7.68">   if (aProperty == mBiffStateAtom) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerOSXIntegration.cpp</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerOSXIntegration.cpp</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -39,17 +39,16 @@</span>
<a href="#l8.4"></a><span id="l8.4">  </span>
<a href="#l8.5"></a><span id="l8.5"> #include &quot;nscore.h&quot;</span>
<a href="#l8.6"></a><span id="l8.6"> #include &quot;nsMessengerOSXIntegration.h&quot;</span>
<a href="#l8.7"></a><span id="l8.7"> #include &quot;nsIMsgAccountManager.h&quot;</span>
<a href="#l8.8"></a><span id="l8.8"> #include &quot;nsIMsgMailSession.h&quot;</span>
<a href="#l8.9"></a><span id="l8.9"> #include &quot;nsIMsgIncomingServer.h&quot;</span>
<a href="#l8.10"></a><span id="l8.10"> #include &quot;nsIMsgIdentity.h&quot;</span>
<a href="#l8.11"></a><span id="l8.11"> #include &quot;nsIMsgAccount.h&quot;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-#include &quot;nsIRDFResource.h&quot;</span>
<a href="#l8.13"></a><span id="l8.13"> #include &quot;nsIMsgFolder.h&quot;</span>
<a href="#l8.14"></a><span id="l8.14"> #include &quot;nsCOMPtr.h&quot;</span>
<a href="#l8.15"></a><span id="l8.15"> #include &quot;nsMsgBaseCID.h&quot;</span>
<a href="#l8.16"></a><span id="l8.16"> #include &quot;nsMsgFolderFlags.h&quot;</span>
<a href="#l8.17"></a><span id="l8.17"> #include &quot;nsDirectoryServiceDefs.h&quot;</span>
<a href="#l8.18"></a><span id="l8.18"> #include &quot;nsIDirectoryService.h&quot;</span>
<a href="#l8.19"></a><span id="l8.19"> #include &quot;MailNewsTypes.h&quot;</span>
<a href="#l8.20"></a><span id="l8.20"> #include &quot;nsIWindowMediator.h&quot;</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineat">@@ -116,29 +115,29 @@ nsMessengerOSXIntegration::Init()</span>
<a href="#l8.22"></a><span id="l8.22">   // because we care if the unread total count changes</span>
<a href="#l8.23"></a><span id="l8.23">   rv = mailSession-&gt;AddFolderListener(this, nsIFolderListener::boolPropertyChanged | nsIFolderListener::intPropertyChanged);</span>
<a href="#l8.24"></a><span id="l8.24">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l8.25"></a><span id="l8.25"> </span>
<a href="#l8.26"></a><span id="l8.26">   return NS_OK;</span>
<a href="#l8.27"></a><span id="l8.27"> }</span>
<a href="#l8.28"></a><span id="l8.28"> </span>
<a href="#l8.29"></a><span id="l8.29"> NS_IMETHODIMP</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineminus">-nsMessengerOSXIntegration::OnItemPropertyChanged(nsIRDFResource *, nsIAtom *, char const *, char const *)</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineplus">+nsMessengerOSXIntegration::OnItemPropertyChanged(nsIMsgFolder *, nsIAtom *, char const *, char const *)</span>
<a href="#l8.32"></a><span id="l8.32"> {</span>
<a href="#l8.33"></a><span id="l8.33">   return NS_OK;</span>
<a href="#l8.34"></a><span id="l8.34"> }</span>
<a href="#l8.35"></a><span id="l8.35"> </span>
<a href="#l8.36"></a><span id="l8.36"> NS_IMETHODIMP</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineminus">-nsMessengerOSXIntegration::OnItemUnicharPropertyChanged(nsIRDFResource *, nsIAtom *, const PRUnichar *, const PRUnichar *)</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+nsMessengerOSXIntegration::OnItemUnicharPropertyChanged(nsIMsgFolder *, nsIAtom *, const PRUnichar *, const PRUnichar *)</span>
<a href="#l8.39"></a><span id="l8.39"> {</span>
<a href="#l8.40"></a><span id="l8.40">   return NS_OK;</span>
<a href="#l8.41"></a><span id="l8.41"> }</span>
<a href="#l8.42"></a><span id="l8.42"> </span>
<a href="#l8.43"></a><span id="l8.43"> NS_IMETHODIMP</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineminus">-nsMessengerOSXIntegration::OnItemRemoved(nsIRDFResource *, nsISupports *)</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineplus">+nsMessengerOSXIntegration::OnItemRemoved(nsIMsgFolder *, nsISupports *)</span>
<a href="#l8.46"></a><span id="l8.46"> {</span>
<a href="#l8.47"></a><span id="l8.47">   return NS_OK;</span>
<a href="#l8.48"></a><span id="l8.48"> }</span>
<a href="#l8.49"></a><span id="l8.49"> </span>
<a href="#l8.50"></a><span id="l8.50"> PRInt32 nsMessengerOSXIntegration::CountNewMessages()</span>
<a href="#l8.51"></a><span id="l8.51"> {</span>
<a href="#l8.52"></a><span id="l8.52">   // iterate over all the folders in mFoldersWithNewMail</span>
<a href="#l8.53"></a><span id="l8.53">   nsCOMPtr&lt;nsIMsgFolder&gt; folder;</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineat">@@ -324,72 +323,69 @@ nsresult nsMessengerOSXIntegration::OnAl</span>
<a href="#l8.55"></a><span id="l8.55"> </span>
<a href="#l8.56"></a><span id="l8.56"> NS_IMETHODIMP</span>
<a href="#l8.57"></a><span id="l8.57"> nsMessengerOSXIntegration::OnItemPropertyFlagChanged(nsIMsgDBHdr *item, nsIAtom *property, PRUint32 oldFlag, PRUint32 newFlag)</span>
<a href="#l8.58"></a><span id="l8.58"> {</span>
<a href="#l8.59"></a><span id="l8.59">   return NS_OK;</span>
<a href="#l8.60"></a><span id="l8.60"> }</span>
<a href="#l8.61"></a><span id="l8.61"> </span>
<a href="#l8.62"></a><span id="l8.62"> NS_IMETHODIMP</span>
<a href="#l8.63"></a><span id="l8.63" class="difflineminus">-nsMessengerOSXIntegration::OnItemAdded(nsIRDFResource *, nsISupports *)</span>
<a href="#l8.64"></a><span id="l8.64" class="difflineplus">+nsMessengerOSXIntegration::OnItemAdded(nsIMsgFolder *, nsISupports *)</span>
<a href="#l8.65"></a><span id="l8.65"> {</span>
<a href="#l8.66"></a><span id="l8.66">   return NS_OK;</span>
<a href="#l8.67"></a><span id="l8.67"> }</span>
<a href="#l8.68"></a><span id="l8.68"> </span>
<a href="#l8.69"></a><span id="l8.69"> NS_IMETHODIMP</span>
<a href="#l8.70"></a><span id="l8.70" class="difflineminus">-nsMessengerOSXIntegration::OnItemBoolPropertyChanged(nsIRDFResource *aItem,</span>
<a href="#l8.71"></a><span id="l8.71" class="difflineplus">+nsMessengerOSXIntegration::OnItemBoolPropertyChanged(nsIMsgFolder *aItem,</span>
<a href="#l8.72"></a><span id="l8.72">                                                          nsIAtom *aProperty,</span>
<a href="#l8.73"></a><span id="l8.73">                                                          PRBool aOldValue,</span>
<a href="#l8.74"></a><span id="l8.74">                                                          PRBool aNewValue)</span>
<a href="#l8.75"></a><span id="l8.75"> {</span>
<a href="#l8.76"></a><span id="l8.76">   return NS_OK;</span>
<a href="#l8.77"></a><span id="l8.77"> }</span>
<a href="#l8.78"></a><span id="l8.78"> </span>
<a href="#l8.79"></a><span id="l8.79"> NS_IMETHODIMP</span>
<a href="#l8.80"></a><span id="l8.80"> nsMessengerOSXIntegration::OnItemEvent(nsIMsgFolder *, nsIAtom *)</span>
<a href="#l8.81"></a><span id="l8.81"> {</span>
<a href="#l8.82"></a><span id="l8.82">   return NS_OK;</span>
<a href="#l8.83"></a><span id="l8.83"> }</span>
<a href="#l8.84"></a><span id="l8.84"> </span>
<a href="#l8.85"></a><span id="l8.85"> NS_IMETHODIMP</span>
<a href="#l8.86"></a><span id="l8.86" class="difflineminus">-nsMessengerOSXIntegration::OnItemIntPropertyChanged(nsIRDFResource *aItem, nsIAtom *aProperty, PRInt32 aOldValue, PRInt32 aNewValue)</span>
<a href="#l8.87"></a><span id="l8.87" class="difflineplus">+nsMessengerOSXIntegration::OnItemIntPropertyChanged(nsIMsgFolder *aItem, nsIAtom *aProperty, PRInt32 aOldValue, PRInt32 aNewValue)</span>
<a href="#l8.88"></a><span id="l8.88"> {</span>
<a href="#l8.89"></a><span id="l8.89">   // if we got new mail bounce the Dock icon and/or apply badge to Dock icon</span>
<a href="#l8.90"></a><span id="l8.90">   if (mBiffStateAtom == aProperty &amp;&amp; mFoldersWithNewMail)</span>
<a href="#l8.91"></a><span id="l8.91">   {</span>
<a href="#l8.92"></a><span id="l8.92" class="difflineminus">-    nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryInterface(aItem);</span>
<a href="#l8.93"></a><span id="l8.93" class="difflineminus">-    NS_ENSURE_TRUE(folder, NS_OK);</span>
<a href="#l8.94"></a><span id="l8.94" class="difflineminus">-</span>
<a href="#l8.95"></a><span id="l8.95">     if (aNewValue == nsIMsgFolder::nsMsgBiffState_NewMail) </span>
<a href="#l8.96"></a><span id="l8.96">     {</span>
<a href="#l8.97"></a><span id="l8.97">       // if the icon is not already visible, only show a system tray icon iff </span>
<a href="#l8.98"></a><span id="l8.98">       // we are performing biff (as opposed to the user getting new mail)</span>
<a href="#l8.99"></a><span id="l8.99">       if (!mBiffIconVisible)</span>
<a href="#l8.100"></a><span id="l8.100">       {</span>
<a href="#l8.101"></a><span id="l8.101">         PRBool performingBiff = PR_FALSE;</span>
<a href="#l8.102"></a><span id="l8.102">         nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l8.103"></a><span id="l8.103" class="difflineminus">-        folder-&gt;GetServer(getter_AddRefs(server));</span>
<a href="#l8.104"></a><span id="l8.104" class="difflineplus">+        aItem-&gt;GetServer(getter_AddRefs(server));</span>
<a href="#l8.105"></a><span id="l8.105">         if (server)</span>
<a href="#l8.106"></a><span id="l8.106">           server-&gt;GetPerformingBiff(&amp;performingBiff);</span>
<a href="#l8.107"></a><span id="l8.107">         if (!performingBiff) </span>
<a href="#l8.108"></a><span id="l8.108">           return NS_OK; // kick out right now...</span>
<a href="#l8.109"></a><span id="l8.109">       }</span>
<a href="#l8.110"></a><span id="l8.110"> </span>
<a href="#l8.111"></a><span id="l8.111" class="difflineminus">-      nsCOMPtr&lt;nsIWeakReference&gt; weakFolder = do_GetWeakReference(folder); </span>
<a href="#l8.112"></a><span id="l8.112" class="difflineplus">+      nsCOMPtr&lt;nsIWeakReference&gt; weakFolder = do_GetWeakReference(aItem); </span>
<a href="#l8.113"></a><span id="l8.113">       // remove the element if it is already in the array....</span>
<a href="#l8.114"></a><span id="l8.114">       PRUint32 count = 0;</span>
<a href="#l8.115"></a><span id="l8.115">       PRUint32 index = 0; </span>
<a href="#l8.116"></a><span id="l8.116">       mFoldersWithNewMail-&gt;Count(&amp;count);</span>
<a href="#l8.117"></a><span id="l8.117">       nsCOMPtr&lt;nsIMsgFolder&gt; oldFolder;</span>
<a href="#l8.118"></a><span id="l8.118">       nsCOMPtr&lt;nsIWeakReference&gt; weakReference;</span>
<a href="#l8.119"></a><span id="l8.119">       for (index = 0; index &lt; count; index++)</span>
<a href="#l8.120"></a><span id="l8.120">       {</span>
<a href="#l8.121"></a><span id="l8.121">         weakReference = do_QueryElementAt(mFoldersWithNewMail, index);</span>
<a href="#l8.122"></a><span id="l8.122">         oldFolder = do_QueryReferent(weakReference);</span>
<a href="#l8.123"></a><span id="l8.123" class="difflineminus">-        if (oldFolder == folder) // if they point to the same folder</span>
<a href="#l8.124"></a><span id="l8.124" class="difflineplus">+        if (oldFolder == aItem) // if they point to the same folder</span>
<a href="#l8.125"></a><span id="l8.125">           break;</span>
<a href="#l8.126"></a><span id="l8.126">         oldFolder = nsnull;</span>
<a href="#l8.127"></a><span id="l8.127">       }</span>
<a href="#l8.128"></a><span id="l8.128"> </span>
<a href="#l8.129"></a><span id="l8.129"> 	 if (oldFolder)</span>
<a href="#l8.130"></a><span id="l8.130">        mFoldersWithNewMail-&gt;ReplaceElementAt(weakFolder, index);</span>
<a href="#l8.131"></a><span id="l8.131"> 	 else</span>
<a href="#l8.132"></a><span id="l8.132">        mFoldersWithNewMail-&gt;AppendElement(weakFolder);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerUnixIntegration.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerUnixIntegration.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -39,17 +39,16 @@</span>
<a href="#l9.4"></a><span id="l9.4">  * ***** END LICENSE BLOCK ***** */</span>
<a href="#l9.5"></a><span id="l9.5"> </span>
<a href="#l9.6"></a><span id="l9.6"> #include &quot;nsMessengerUnixIntegration.h&quot;</span>
<a href="#l9.7"></a><span id="l9.7"> #include &quot;nsIMsgAccountManager.h&quot;</span>
<a href="#l9.8"></a><span id="l9.8"> #include &quot;nsIMsgMailSession.h&quot;</span>
<a href="#l9.9"></a><span id="l9.9"> #include &quot;nsIMsgIncomingServer.h&quot;</span>
<a href="#l9.10"></a><span id="l9.10"> #include &quot;nsIMsgIdentity.h&quot;</span>
<a href="#l9.11"></a><span id="l9.11"> #include &quot;nsIMsgAccount.h&quot;</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-#include &quot;nsIRDFResource.h&quot;</span>
<a href="#l9.13"></a><span id="l9.13"> #include &quot;nsIMsgFolder.h&quot;</span>
<a href="#l9.14"></a><span id="l9.14"> #include &quot;nsCOMPtr.h&quot;</span>
<a href="#l9.15"></a><span id="l9.15"> #include &quot;nsMsgBaseCID.h&quot;</span>
<a href="#l9.16"></a><span id="l9.16"> #include &quot;nsMsgFolderFlags.h&quot;</span>
<a href="#l9.17"></a><span id="l9.17"> #include &quot;nsDirectoryServiceDefs.h&quot;</span>
<a href="#l9.18"></a><span id="l9.18"> #include &quot;nsAppDirectoryServiceDefs.h&quot;</span>
<a href="#l9.19"></a><span id="l9.19"> #include &quot;nsIDirectoryService.h&quot;</span>
<a href="#l9.20"></a><span id="l9.20"> #include &quot;nsIWindowWatcher.h&quot;</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineat">@@ -128,29 +127,29 @@ nsMessengerUnixIntegration::Init()</span>
<a href="#l9.22"></a><span id="l9.22">   nsresult rv;</span>
<a href="#l9.23"></a><span id="l9.23"> </span>
<a href="#l9.24"></a><span id="l9.24">   nsCOMPtr&lt;nsIMsgMailSession&gt; mailSession = do_GetService(NS_MSGMAILSESSION_CONTRACTID, &amp;rv);</span>
<a href="#l9.25"></a><span id="l9.25">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l9.26"></a><span id="l9.26">   return mailSession-&gt;AddFolderListener(this, nsIFolderListener::intPropertyChanged);</span>
<a href="#l9.27"></a><span id="l9.27"> }</span>
<a href="#l9.28"></a><span id="l9.28"> </span>
<a href="#l9.29"></a><span id="l9.29"> NS_IMETHODIMP</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineminus">-nsMessengerUnixIntegration::OnItemPropertyChanged(nsIRDFResource *, nsIAtom *, char const *, char const *)</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineplus">+nsMessengerUnixIntegration::OnItemPropertyChanged(nsIMsgFolder *, nsIAtom *, char const *, char const *)</span>
<a href="#l9.32"></a><span id="l9.32"> {</span>
<a href="#l9.33"></a><span id="l9.33">   return NS_OK;</span>
<a href="#l9.34"></a><span id="l9.34"> }</span>
<a href="#l9.35"></a><span id="l9.35"> </span>
<a href="#l9.36"></a><span id="l9.36"> NS_IMETHODIMP</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineminus">-nsMessengerUnixIntegration::OnItemUnicharPropertyChanged(nsIRDFResource *, nsIAtom *, const PRUnichar *, const PRUnichar *)</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineplus">+nsMessengerUnixIntegration::OnItemUnicharPropertyChanged(nsIMsgFolder *, nsIAtom *, const PRUnichar *, const PRUnichar *)</span>
<a href="#l9.39"></a><span id="l9.39"> {</span>
<a href="#l9.40"></a><span id="l9.40">   return NS_OK;</span>
<a href="#l9.41"></a><span id="l9.41"> }</span>
<a href="#l9.42"></a><span id="l9.42"> </span>
<a href="#l9.43"></a><span id="l9.43"> NS_IMETHODIMP</span>
<a href="#l9.44"></a><span id="l9.44" class="difflineminus">-nsMessengerUnixIntegration::OnItemRemoved(nsIRDFResource *, nsISupports *)</span>
<a href="#l9.45"></a><span id="l9.45" class="difflineplus">+nsMessengerUnixIntegration::OnItemRemoved(nsIMsgFolder *, nsISupports *)</span>
<a href="#l9.46"></a><span id="l9.46"> {</span>
<a href="#l9.47"></a><span id="l9.47">   return NS_OK;</span>
<a href="#l9.48"></a><span id="l9.48"> }</span>
<a href="#l9.49"></a><span id="l9.49"> </span>
<a href="#l9.50"></a><span id="l9.50"> nsresult nsMessengerUnixIntegration::GetStringBundle(nsIStringBundle **aBundle)</span>
<a href="#l9.51"></a><span id="l9.51"> {</span>
<a href="#l9.52"></a><span id="l9.52">   nsresult rv = NS_OK;</span>
<a href="#l9.53"></a><span id="l9.53">   NS_ENSURE_ARG_POINTER(aBundle);</span>
<a href="#l9.54"></a><span id="l9.54" class="difflineat">@@ -400,58 +399,55 @@ nsresult nsMessengerUnixIntegration::Get</span>
<a href="#l9.55"></a><span id="l9.55"> </span>
<a href="#l9.56"></a><span id="l9.56"> NS_IMETHODIMP</span>
<a href="#l9.57"></a><span id="l9.57"> nsMessengerUnixIntegration::OnItemPropertyFlagChanged(nsIMsgDBHdr *item, nsIAtom *property, PRUint32 oldFlag, PRUint32 newFlag)</span>
<a href="#l9.58"></a><span id="l9.58"> {</span>
<a href="#l9.59"></a><span id="l9.59">   return NS_OK;</span>
<a href="#l9.60"></a><span id="l9.60"> }</span>
<a href="#l9.61"></a><span id="l9.61"> </span>
<a href="#l9.62"></a><span id="l9.62"> NS_IMETHODIMP</span>
<a href="#l9.63"></a><span id="l9.63" class="difflineminus">-nsMessengerUnixIntegration::OnItemAdded(nsIRDFResource *, nsISupports *)</span>
<a href="#l9.64"></a><span id="l9.64" class="difflineplus">+nsMessengerUnixIntegration::OnItemAdded(nsIMsgFolder *, nsISupports *)</span>
<a href="#l9.65"></a><span id="l9.65"> {</span>
<a href="#l9.66"></a><span id="l9.66">   return NS_OK;</span>
<a href="#l9.67"></a><span id="l9.67"> }</span>
<a href="#l9.68"></a><span id="l9.68"> </span>
<a href="#l9.69"></a><span id="l9.69"> NS_IMETHODIMP</span>
<a href="#l9.70"></a><span id="l9.70" class="difflineminus">-nsMessengerUnixIntegration::OnItemBoolPropertyChanged(nsIRDFResource *aItem,</span>
<a href="#l9.71"></a><span id="l9.71" class="difflineplus">+nsMessengerUnixIntegration::OnItemBoolPropertyChanged(nsIMsgFolder *aItem,</span>
<a href="#l9.72"></a><span id="l9.72">                                                          nsIAtom *aProperty,</span>
<a href="#l9.73"></a><span id="l9.73">                                                          PRBool aOldValue,</span>
<a href="#l9.74"></a><span id="l9.74">                                                          PRBool aNewValue)</span>
<a href="#l9.75"></a><span id="l9.75"> {</span>
<a href="#l9.76"></a><span id="l9.76">   return NS_OK;</span>
<a href="#l9.77"></a><span id="l9.77"> }</span>
<a href="#l9.78"></a><span id="l9.78"> </span>
<a href="#l9.79"></a><span id="l9.79"> NS_IMETHODIMP</span>
<a href="#l9.80"></a><span id="l9.80"> nsMessengerUnixIntegration::OnItemEvent(nsIMsgFolder *, nsIAtom *)</span>
<a href="#l9.81"></a><span id="l9.81"> {</span>
<a href="#l9.82"></a><span id="l9.82">   return NS_OK;</span>
<a href="#l9.83"></a><span id="l9.83"> }</span>
<a href="#l9.84"></a><span id="l9.84"> </span>
<a href="#l9.85"></a><span id="l9.85"> NS_IMETHODIMP</span>
<a href="#l9.86"></a><span id="l9.86" class="difflineminus">-nsMessengerUnixIntegration::OnItemIntPropertyChanged(nsIRDFResource *aItem, nsIAtom *aProperty, PRInt32 aOldValue, PRInt32 aNewValue)</span>
<a href="#l9.87"></a><span id="l9.87" class="difflineplus">+nsMessengerUnixIntegration::OnItemIntPropertyChanged(nsIMsgFolder *aItem, nsIAtom *aProperty, PRInt32 aOldValue, PRInt32 aNewValue)</span>
<a href="#l9.88"></a><span id="l9.88"> {</span>
<a href="#l9.89"></a><span id="l9.89">   // if we got new mail show a icon in the system tray</span>
<a href="#l9.90"></a><span id="l9.90">   if (mBiffStateAtom == aProperty &amp;&amp; mFoldersWithNewMail)</span>
<a href="#l9.91"></a><span id="l9.91">   {</span>
<a href="#l9.92"></a><span id="l9.92" class="difflineminus">-    nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryInterface(aItem);</span>
<a href="#l9.93"></a><span id="l9.93" class="difflineminus">-    NS_ENSURE_TRUE(folder, NS_OK);</span>
<a href="#l9.94"></a><span id="l9.94" class="difflineminus">-</span>
<a href="#l9.95"></a><span id="l9.95">     if (aNewValue == nsIMsgFolder::nsMsgBiffState_NewMail) </span>
<a href="#l9.96"></a><span id="l9.96">     {</span>
<a href="#l9.97"></a><span id="l9.97">       // only show a system tray icon iff we are performing biff</span>
<a href="#l9.98"></a><span id="l9.98">       // (as opposed to the user getting new mail)</span>
<a href="#l9.99"></a><span id="l9.99">       PRBool performingBiff = PR_FALSE;</span>
<a href="#l9.100"></a><span id="l9.100">       nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l9.101"></a><span id="l9.101" class="difflineminus">-      folder-&gt;GetServer(getter_AddRefs(server));</span>
<a href="#l9.102"></a><span id="l9.102" class="difflineplus">+      aItem-&gt;GetServer(getter_AddRefs(server));</span>
<a href="#l9.103"></a><span id="l9.103">       if (server)</span>
<a href="#l9.104"></a><span id="l9.104">         server-&gt;GetPerformingBiff(&amp;performingBiff);</span>
<a href="#l9.105"></a><span id="l9.105">       if (!performingBiff) </span>
<a href="#l9.106"></a><span id="l9.106">         return NS_OK; // kick out right now...</span>
<a href="#l9.107"></a><span id="l9.107"> </span>
<a href="#l9.108"></a><span id="l9.108" class="difflineminus">-      nsCOMPtr&lt;nsIWeakReference&gt; weakFolder = do_GetWeakReference(folder); </span>
<a href="#l9.109"></a><span id="l9.109" class="difflineplus">+      nsCOMPtr&lt;nsIWeakReference&gt; weakFolder = do_GetWeakReference(aItem); </span>
<a href="#l9.110"></a><span id="l9.110"> </span>
<a href="#l9.111"></a><span id="l9.111">       if (mFoldersWithNewMail-&gt;IndexOf(weakFolder) == -1)</span>
<a href="#l9.112"></a><span id="l9.112">         mFoldersWithNewMail-&gt;AppendElement(weakFolder);</span>
<a href="#l9.113"></a><span id="l9.113">       // now regenerate the tooltip</span>
<a href="#l9.114"></a><span id="l9.114">       FillToolTipInfo();    </span>
<a href="#l9.115"></a><span id="l9.115">     }</span>
<a href="#l9.116"></a><span id="l9.116">     else if (aNewValue == nsIMsgFolder::nsMsgBiffState_NoMail)</span>
<a href="#l9.117"></a><span id="l9.117">     {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerWinIntegration.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerWinIntegration.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -43,17 +43,16 @@</span>
<a href="#l10.4"></a><span id="l10.4"> #include &lt;shellapi.h&gt;</span>
<a href="#l10.5"></a><span id="l10.5"> </span>
<a href="#l10.6"></a><span id="l10.6"> #include &quot;nsMessengerWinIntegration.h&quot;</span>
<a href="#l10.7"></a><span id="l10.7"> #include &quot;nsIMsgAccountManager.h&quot;</span>
<a href="#l10.8"></a><span id="l10.8"> #include &quot;nsIMsgMailSession.h&quot;</span>
<a href="#l10.9"></a><span id="l10.9"> #include &quot;nsIMsgIncomingServer.h&quot;</span>
<a href="#l10.10"></a><span id="l10.10"> #include &quot;nsIMsgIdentity.h&quot;</span>
<a href="#l10.11"></a><span id="l10.11"> #include &quot;nsIMsgAccount.h&quot;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-#include &quot;nsIRDFResource.h&quot;</span>
<a href="#l10.13"></a><span id="l10.13"> #include &quot;nsIMsgFolder.h&quot;</span>
<a href="#l10.14"></a><span id="l10.14"> #include &quot;nsCOMPtr.h&quot;</span>
<a href="#l10.15"></a><span id="l10.15"> #include &quot;nsMsgBaseCID.h&quot;</span>
<a href="#l10.16"></a><span id="l10.16"> #include &quot;nsMsgFolderFlags.h&quot;</span>
<a href="#l10.17"></a><span id="l10.17"> #include &quot;nsDirectoryServiceDefs.h&quot;</span>
<a href="#l10.18"></a><span id="l10.18"> #include &quot;nsAppDirectoryServiceDefs.h&quot;</span>
<a href="#l10.19"></a><span id="l10.19"> #include &quot;nsIDirectoryService.h&quot;</span>
<a href="#l10.20"></a><span id="l10.20"> #include &quot;nsIWindowWatcher.h&quot;</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineat">@@ -428,29 +427,29 @@ nsMessengerWinIntegration::Init()</span>
<a href="#l10.22"></a><span id="l10.22">     rv = ResetCurrent();</span>
<a href="#l10.23"></a><span id="l10.23">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.24"></a><span id="l10.24">   }</span>
<a href="#l10.25"></a><span id="l10.25"> </span>
<a href="#l10.26"></a><span id="l10.26">   return NS_OK;</span>
<a href="#l10.27"></a><span id="l10.27"> }</span>
<a href="#l10.28"></a><span id="l10.28"> </span>
<a href="#l10.29"></a><span id="l10.29"> NS_IMETHODIMP</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineminus">-nsMessengerWinIntegration::OnItemPropertyChanged(nsIRDFResource *, nsIAtom *, char const *, char const *)</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineplus">+nsMessengerWinIntegration::OnItemPropertyChanged(nsIMsgFolder *, nsIAtom *, char const *, char const *)</span>
<a href="#l10.32"></a><span id="l10.32"> {</span>
<a href="#l10.33"></a><span id="l10.33">   return NS_OK;</span>
<a href="#l10.34"></a><span id="l10.34"> }</span>
<a href="#l10.35"></a><span id="l10.35"> </span>
<a href="#l10.36"></a><span id="l10.36"> NS_IMETHODIMP</span>
<a href="#l10.37"></a><span id="l10.37" class="difflineminus">-nsMessengerWinIntegration::OnItemUnicharPropertyChanged(nsIRDFResource *, nsIAtom *, const PRUnichar *, const PRUnichar *)</span>
<a href="#l10.38"></a><span id="l10.38" class="difflineplus">+nsMessengerWinIntegration::OnItemUnicharPropertyChanged(nsIMsgFolder *, nsIAtom *, const PRUnichar *, const PRUnichar *)</span>
<a href="#l10.39"></a><span id="l10.39"> {</span>
<a href="#l10.40"></a><span id="l10.40">   return NS_OK;</span>
<a href="#l10.41"></a><span id="l10.41"> }</span>
<a href="#l10.42"></a><span id="l10.42"> </span>
<a href="#l10.43"></a><span id="l10.43"> NS_IMETHODIMP</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineminus">-nsMessengerWinIntegration::OnItemRemoved(nsIRDFResource *, nsISupports *)</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineplus">+nsMessengerWinIntegration::OnItemRemoved(nsIMsgFolder *, nsISupports *)</span>
<a href="#l10.46"></a><span id="l10.46"> {</span>
<a href="#l10.47"></a><span id="l10.47">   return NS_OK;</span>
<a href="#l10.48"></a><span id="l10.48"> }</span>
<a href="#l10.49"></a><span id="l10.49"> </span>
<a href="#l10.50"></a><span id="l10.50"> nsresult nsMessengerWinIntegration::GetStringBundle(nsIStringBundle **aBundle)</span>
<a href="#l10.51"></a><span id="l10.51"> {</span>
<a href="#l10.52"></a><span id="l10.52">   nsresult rv = NS_OK;</span>
<a href="#l10.53"></a><span id="l10.53">   NS_ENSURE_ARG_POINTER(aBundle);</span>
<a href="#l10.54"></a><span id="l10.54" class="difflineat">@@ -844,23 +843,23 @@ void nsMessengerWinIntegration::RevertTo</span>
<a href="#l10.55"></a><span id="l10.55"> </span>
<a href="#l10.56"></a><span id="l10.56"> NS_IMETHODIMP</span>
<a href="#l10.57"></a><span id="l10.57"> nsMessengerWinIntegration::OnItemPropertyFlagChanged(nsIMsgDBHdr *item, nsIAtom *property, PRUint32 oldFlag, PRUint32 newFlag)</span>
<a href="#l10.58"></a><span id="l10.58"> {</span>
<a href="#l10.59"></a><span id="l10.59">   return NS_OK;</span>
<a href="#l10.60"></a><span id="l10.60"> }</span>
<a href="#l10.61"></a><span id="l10.61"> </span>
<a href="#l10.62"></a><span id="l10.62"> NS_IMETHODIMP</span>
<a href="#l10.63"></a><span id="l10.63" class="difflineminus">-nsMessengerWinIntegration::OnItemAdded(nsIRDFResource *, nsISupports *)</span>
<a href="#l10.64"></a><span id="l10.64" class="difflineplus">+nsMessengerWinIntegration::OnItemAdded(nsIMsgFolder *, nsISupports *)</span>
<a href="#l10.65"></a><span id="l10.65"> {</span>
<a href="#l10.66"></a><span id="l10.66">   return NS_OK;</span>
<a href="#l10.67"></a><span id="l10.67"> }</span>
<a href="#l10.68"></a><span id="l10.68"> </span>
<a href="#l10.69"></a><span id="l10.69"> NS_IMETHODIMP</span>
<a href="#l10.70"></a><span id="l10.70" class="difflineminus">-nsMessengerWinIntegration::OnItemBoolPropertyChanged(nsIRDFResource *aItem,</span>
<a href="#l10.71"></a><span id="l10.71" class="difflineplus">+nsMessengerWinIntegration::OnItemBoolPropertyChanged(nsIMsgFolder *aItem,</span>
<a href="#l10.72"></a><span id="l10.72">                                                          nsIAtom *aProperty,</span>
<a href="#l10.73"></a><span id="l10.73">                                                          PRBool aOldValue,</span>
<a href="#l10.74"></a><span id="l10.74">                                                          PRBool aNewValue)</span>
<a href="#l10.75"></a><span id="l10.75"> {</span>
<a href="#l10.76"></a><span id="l10.76">   if (aProperty == mDefaultServerAtom) {</span>
<a href="#l10.77"></a><span id="l10.77">     nsresult rv;</span>
<a href="#l10.78"></a><span id="l10.78"> </span>
<a href="#l10.79"></a><span id="l10.79">     // this property changes multiple times</span>
<a href="#l10.80"></a><span id="l10.80" class="difflineat">@@ -886,42 +885,39 @@ nsMessengerWinIntegration::OnItemBoolPro</span>
<a href="#l10.81"></a><span id="l10.81"> </span>
<a href="#l10.82"></a><span id="l10.82"> NS_IMETHODIMP</span>
<a href="#l10.83"></a><span id="l10.83"> nsMessengerWinIntegration::OnItemEvent(nsIMsgFolder *, nsIAtom *)</span>
<a href="#l10.84"></a><span id="l10.84"> {</span>
<a href="#l10.85"></a><span id="l10.85">   return NS_OK;</span>
<a href="#l10.86"></a><span id="l10.86"> }</span>
<a href="#l10.87"></a><span id="l10.87"> </span>
<a href="#l10.88"></a><span id="l10.88"> NS_IMETHODIMP</span>
<a href="#l10.89"></a><span id="l10.89" class="difflineminus">-nsMessengerWinIntegration::OnItemIntPropertyChanged(nsIRDFResource *aItem, nsIAtom *aProperty, PRInt32 aOldValue, PRInt32 aNewValue)</span>
<a href="#l10.90"></a><span id="l10.90" class="difflineplus">+nsMessengerWinIntegration::OnItemIntPropertyChanged(nsIMsgFolder *aItem, nsIAtom *aProperty, PRInt32 aOldValue, PRInt32 aNewValue)</span>
<a href="#l10.91"></a><span id="l10.91"> {</span>
<a href="#l10.92"></a><span id="l10.92">   // if we got new mail show a icon in the system tray</span>
<a href="#l10.93"></a><span id="l10.93">   if (mBiffStateAtom == aProperty &amp;&amp; mFoldersWithNewMail)</span>
<a href="#l10.94"></a><span id="l10.94">   {</span>
<a href="#l10.95"></a><span id="l10.95">     if (!mBiffIconInitialized)</span>
<a href="#l10.96"></a><span id="l10.96">       InitializeBiffStatusIcon();</span>
<a href="#l10.97"></a><span id="l10.97"> </span>
<a href="#l10.98"></a><span id="l10.98" class="difflineminus">-    nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryInterface(aItem);</span>
<a href="#l10.99"></a><span id="l10.99" class="difflineminus">-    NS_ENSURE_TRUE(folder, NS_OK);</span>
<a href="#l10.100"></a><span id="l10.100" class="difflineminus">-</span>
<a href="#l10.101"></a><span id="l10.101">     if (aNewValue == nsIMsgFolder::nsMsgBiffState_NewMail)</span>
<a href="#l10.102"></a><span id="l10.102">     {</span>
<a href="#l10.103"></a><span id="l10.103">       // if the icon is not already visible, only show a system tray icon iff</span>
<a href="#l10.104"></a><span id="l10.104">       // we are performing biff (as opposed to the user getting new mail)</span>
<a href="#l10.105"></a><span id="l10.105">       if (!mBiffIconVisible)</span>
<a href="#l10.106"></a><span id="l10.106">       {</span>
<a href="#l10.107"></a><span id="l10.107">         PRBool performingBiff = PR_FALSE;</span>
<a href="#l10.108"></a><span id="l10.108">         nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l10.109"></a><span id="l10.109" class="difflineminus">-        folder-&gt;GetServer(getter_AddRefs(server));</span>
<a href="#l10.110"></a><span id="l10.110" class="difflineplus">+        aItem-&gt;GetServer(getter_AddRefs(server));</span>
<a href="#l10.111"></a><span id="l10.111">         if (server)</span>
<a href="#l10.112"></a><span id="l10.112">           server-&gt;GetPerformingBiff(&amp;performingBiff);</span>
<a href="#l10.113"></a><span id="l10.113">         if (!performingBiff)</span>
<a href="#l10.114"></a><span id="l10.114">           return NS_OK; // kick out right now...</span>
<a href="#l10.115"></a><span id="l10.115">       }</span>
<a href="#l10.116"></a><span id="l10.116" class="difflineminus">-      nsCOMPtr&lt;nsIWeakReference&gt; weakFolder = do_GetWeakReference(folder);</span>
<a href="#l10.117"></a><span id="l10.117" class="difflineplus">+      nsCOMPtr&lt;nsIWeakReference&gt; weakFolder = do_GetWeakReference(aItem);</span>
<a href="#l10.118"></a><span id="l10.118"> </span>
<a href="#l10.119"></a><span id="l10.119">       if (mFoldersWithNewMail-&gt;IndexOf(weakFolder) == -1)</span>
<a href="#l10.120"></a><span id="l10.120">         mFoldersWithNewMail-&gt;AppendElement(weakFolder);</span>
<a href="#l10.121"></a><span id="l10.121">       // now regenerate the tooltip</span>
<a href="#l10.122"></a><span id="l10.122">       FillToolTipInfo();</span>
<a href="#l10.123"></a><span id="l10.123">     }</span>
<a href="#l10.124"></a><span id="l10.124">     else if (aNewValue == nsIMsgFolder::nsMsgBiffState_NoMail)</span>
<a href="#l10.125"></a><span id="l10.125">     {</span>
<a href="#l10.126"></a><span id="l10.126" class="difflineat">@@ -941,22 +937,22 @@ nsMessengerWinIntegration::OnItemIntProp</span>
<a href="#l10.127"></a><span id="l10.127">         GenericShellNotify(NIM_DELETE);</span>
<a href="#l10.128"></a><span id="l10.128">       }</span>
<a href="#l10.129"></a><span id="l10.129">     }</span>
<a href="#l10.130"></a><span id="l10.130">   } // if the biff property changed</span>
<a href="#l10.131"></a><span id="l10.131"> </span>
<a href="#l10.132"></a><span id="l10.132">   if (!mStoreUnreadCounts) return NS_OK; // don't do anything here if we aren't storing unread counts...</span>
<a href="#l10.133"></a><span id="l10.133"> </span>
<a href="#l10.134"></a><span id="l10.134">   if (aProperty == mTotalUnreadMessagesAtom) {</span>
<a href="#l10.135"></a><span id="l10.135" class="difflineminus">-    const char *itemURI = nsnull;</span>
<a href="#l10.136"></a><span id="l10.136" class="difflineplus">+    nsCString itemURI;</span>
<a href="#l10.137"></a><span id="l10.137">     nsresult rv;</span>
<a href="#l10.138"></a><span id="l10.138" class="difflineminus">-    rv = aItem-&gt;GetValueConst(&amp;itemURI);</span>
<a href="#l10.139"></a><span id="l10.139" class="difflineplus">+    rv = aItem-&gt;GetURI(itemURI);</span>
<a href="#l10.140"></a><span id="l10.140">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.141"></a><span id="l10.141"> </span>
<a href="#l10.142"></a><span id="l10.142" class="difflineminus">-    if (itemURI &amp;&amp; mInboxURI.Equals(itemURI))</span>
<a href="#l10.143"></a><span id="l10.143" class="difflineplus">+    if (mInboxURI.Equals(itemURI))</span>
<a href="#l10.144"></a><span id="l10.144">       mCurrentUnreadCount = aNewValue;</span>
<a href="#l10.145"></a><span id="l10.145"> </span>
<a href="#l10.146"></a><span id="l10.146">     // If the timer isn't running yet, then we immediately update the</span>
<a href="#l10.147"></a><span id="l10.147">     // registry and then start a one-shot timer. If the Unread counter</span>
<a href="#l10.148"></a><span id="l10.148">     // has toggled zero / nonzero, we also update immediately.</span>
<a href="#l10.149"></a><span id="l10.149">     // Otherwise, if the timer is running, defer the update. This means</span>
<a href="#l10.150"></a><span id="l10.150">     // that all counter updates that occur within the timer interval are</span>
<a href="#l10.151"></a><span id="l10.151">     // batched into a single registry update, to avoid hitting the</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/base/src/nsMsgAccountManager.cpp</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgAccountManager.cpp</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -2943,17 +2943,17 @@ nsresult nsMsgAccountManager::AddVFListe</span>
<a href="#l11.4"></a><span id="l11.4">     dbListener-&gt;m_virtualFolder = virtualFolder;</span>
<a href="#l11.5"></a><span id="l11.5">     dbListener-&gt;m_folderWatching = realFolder;</span>
<a href="#l11.6"></a><span id="l11.6">     dbListener-&gt;Init();</span>
<a href="#l11.7"></a><span id="l11.7">     msgDBService-&gt;RegisterPendingListener(realFolder, dbListener);</span>
<a href="#l11.8"></a><span id="l11.8">   }</span>
<a href="#l11.9"></a><span id="l11.9">   return NS_OK;</span>
<a href="#l11.10"></a><span id="l11.10"> }</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-NS_IMETHODIMP nsMsgAccountManager::OnItemAdded(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+NS_IMETHODIMP nsMsgAccountManager::OnItemAdded(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l11.14"></a><span id="l11.14"> {</span>
<a href="#l11.15"></a><span id="l11.15">   nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryInterface(item);</span>
<a href="#l11.16"></a><span id="l11.16">   // just kick out with a success code if the item in question is not a folder</span>
<a href="#l11.17"></a><span id="l11.17">   if (!folder)</span>
<a href="#l11.18"></a><span id="l11.18">     return NS_OK;</span>
<a href="#l11.19"></a><span id="l11.19">   PRUint32 folderFlags;</span>
<a href="#l11.20"></a><span id="l11.20">   folder-&gt;GetFlags(&amp;folderFlags);</span>
<a href="#l11.21"></a><span id="l11.21">   nsresult rv = NS_OK;</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineat">@@ -2973,17 +2973,17 @@ NS_IMETHODIMP nsMsgAccountManager::OnIte</span>
<a href="#l11.23"></a><span id="l11.23">       nsCOMPtr&lt;nsIRDFService&gt; rdf(do_GetService(&quot;@mozilla.org/rdf/rdf-service;1&quot;, &amp;rv));</span>
<a href="#l11.24"></a><span id="l11.24">       AddVFListenersForVF(folder, srchFolderUri.get(), rdf, msgDBService);</span>
<a href="#l11.25"></a><span id="l11.25">     }</span>
<a href="#l11.26"></a><span id="l11.26">     rv = SaveVirtualFolders();</span>
<a href="#l11.27"></a><span id="l11.27">   }</span>
<a href="#l11.28"></a><span id="l11.28">   return rv;</span>
<a href="#l11.29"></a><span id="l11.29"> }</span>
<a href="#l11.30"></a><span id="l11.30"> </span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-NS_IMETHODIMP nsMsgAccountManager::OnItemRemoved(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+NS_IMETHODIMP nsMsgAccountManager::OnItemRemoved(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l11.33"></a><span id="l11.33"> {</span>
<a href="#l11.34"></a><span id="l11.34">   nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryInterface(item);</span>
<a href="#l11.35"></a><span id="l11.35">   // just kick out with a success code if the item in question is not a folder</span>
<a href="#l11.36"></a><span id="l11.36">   if (!folder)</span>
<a href="#l11.37"></a><span id="l11.37">     return NS_OK;</span>
<a href="#l11.38"></a><span id="l11.38">   nsresult rv = NS_OK;</span>
<a href="#l11.39"></a><span id="l11.39">   PRUint32 folderFlags;</span>
<a href="#l11.40"></a><span id="l11.40">   folder-&gt;GetFlags(&amp;folderFlags);</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineat">@@ -2995,32 +2995,32 @@ NS_IMETHODIMP nsMsgAccountManager::OnIte</span>
<a href="#l11.42"></a><span id="l11.42">     folder-&gt;SetFlags(0);</span>
<a href="#l11.43"></a><span id="l11.43">   }</span>
<a href="#l11.44"></a><span id="l11.44">   // need to check if the underlying folder for a VF was removed, in which case we need to</span>
<a href="#l11.45"></a><span id="l11.45">   // remove the virtual folder.</span>
<a href="#l11.46"></a><span id="l11.46"> </span>
<a href="#l11.47"></a><span id="l11.47">  return rv;</span>
<a href="#l11.48"></a><span id="l11.48"> }</span>
<a href="#l11.49"></a><span id="l11.49"> </span>
<a href="#l11.50"></a><span id="l11.50" class="difflineminus">-NS_IMETHODIMP nsMsgAccountManager::OnItemPropertyChanged(nsIRDFResource *item, nsIAtom *property, const char *oldValue, const char *newValue)</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineplus">+NS_IMETHODIMP nsMsgAccountManager::OnItemPropertyChanged(nsIMsgFolder *item, nsIAtom *property, const char *oldValue, const char *newValue)</span>
<a href="#l11.52"></a><span id="l11.52"> {</span>
<a href="#l11.53"></a><span id="l11.53">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l11.54"></a><span id="l11.54"> }</span>
<a href="#l11.55"></a><span id="l11.55"> </span>
<a href="#l11.56"></a><span id="l11.56" class="difflineminus">-NS_IMETHODIMP nsMsgAccountManager::OnItemIntPropertyChanged(nsIRDFResource *item, nsIAtom *property, PRInt32 oldValue, PRInt32 newValue)</span>
<a href="#l11.57"></a><span id="l11.57" class="difflineplus">+NS_IMETHODIMP nsMsgAccountManager::OnItemIntPropertyChanged(nsIMsgFolder *item, nsIAtom *property, PRInt32 oldValue, PRInt32 newValue)</span>
<a href="#l11.58"></a><span id="l11.58"> {</span>
<a href="#l11.59"></a><span id="l11.59">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l11.60"></a><span id="l11.60"> }</span>
<a href="#l11.61"></a><span id="l11.61"> </span>
<a href="#l11.62"></a><span id="l11.62" class="difflineminus">-NS_IMETHODIMP nsMsgAccountManager::OnItemBoolPropertyChanged(nsIRDFResource *item, nsIAtom *property, PRBool oldValue, PRBool newValue)</span>
<a href="#l11.63"></a><span id="l11.63" class="difflineplus">+NS_IMETHODIMP nsMsgAccountManager::OnItemBoolPropertyChanged(nsIMsgFolder *item, nsIAtom *property, PRBool oldValue, PRBool newValue)</span>
<a href="#l11.64"></a><span id="l11.64"> {</span>
<a href="#l11.65"></a><span id="l11.65">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l11.66"></a><span id="l11.66"> }</span>
<a href="#l11.67"></a><span id="l11.67"> </span>
<a href="#l11.68"></a><span id="l11.68" class="difflineminus">-NS_IMETHODIMP nsMsgAccountManager::OnItemUnicharPropertyChanged(nsIRDFResource *item, nsIAtom *property, const PRUnichar *oldValue, const PRUnichar *newValue)</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineplus">+NS_IMETHODIMP nsMsgAccountManager::OnItemUnicharPropertyChanged(nsIMsgFolder *item, nsIAtom *property, const PRUnichar *oldValue, const PRUnichar *newValue)</span>
<a href="#l11.70"></a><span id="l11.70"> {</span>
<a href="#l11.71"></a><span id="l11.71">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l11.72"></a><span id="l11.72"> }</span>
<a href="#l11.73"></a><span id="l11.73"> </span>
<a href="#l11.74"></a><span id="l11.74"> </span>
<a href="#l11.75"></a><span id="l11.75"> NS_IMETHODIMP nsMsgAccountManager::OnItemPropertyFlagChanged(nsIMsgDBHdr *item, nsIAtom *property, PRUint32 oldFlag, PRUint32 newFlag)</span>
<a href="#l11.76"></a><span id="l11.76"> {</span>
<a href="#l11.77"></a><span id="l11.77">   return NS_ERROR_NOT_IMPLEMENTED;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/src/nsMsgAccountManagerDS.cpp</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgAccountManagerDS.cpp</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -1261,65 +1261,67 @@ nsMsgAccountManagerDataSource::OnServerU</span>
<a href="#l12.4"></a><span id="l12.4"> </span>
<a href="#l12.5"></a><span id="l12.5"> NS_IMETHODIMP</span>
<a href="#l12.6"></a><span id="l12.6"> nsMsgAccountManagerDataSource::OnServerChanged(nsIMsgIncomingServer *server)</span>
<a href="#l12.7"></a><span id="l12.7"> {</span>
<a href="#l12.8"></a><span id="l12.8">   return NS_OK;</span>
<a href="#l12.9"></a><span id="l12.9"> }</span>
<a href="#l12.10"></a><span id="l12.10"> </span>
<a href="#l12.11"></a><span id="l12.11"> nsresult</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-nsMsgAccountManagerDataSource::OnItemPropertyChanged(nsIRDFResource *, nsIAtom *, char const *, char const *)</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+nsMsgAccountManagerDataSource::OnItemPropertyChanged(nsIMsgFolder *, nsIAtom *, char const *, char const *)</span>
<a href="#l12.14"></a><span id="l12.14"> {</span>
<a href="#l12.15"></a><span id="l12.15">   return NS_OK;</span>
<a href="#l12.16"></a><span id="l12.16"> }</span>
<a href="#l12.17"></a><span id="l12.17"> </span>
<a href="#l12.18"></a><span id="l12.18"> nsresult</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineminus">-nsMsgAccountManagerDataSource::OnItemUnicharPropertyChanged(nsIRDFResource *, nsIAtom *, const PRUnichar *, const PRUnichar *)</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+nsMsgAccountManagerDataSource::OnItemUnicharPropertyChanged(nsIMsgFolder *, nsIAtom *, const PRUnichar *, const PRUnichar *)</span>
<a href="#l12.21"></a><span id="l12.21"> {</span>
<a href="#l12.22"></a><span id="l12.22">   return NS_OK;</span>
<a href="#l12.23"></a><span id="l12.23"> }</span>
<a href="#l12.24"></a><span id="l12.24"> </span>
<a href="#l12.25"></a><span id="l12.25"> nsresult</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineminus">-nsMsgAccountManagerDataSource::OnItemRemoved(nsIRDFResource *, nsISupports *)</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineplus">+nsMsgAccountManagerDataSource::OnItemRemoved(nsIMsgFolder *, nsISupports *)</span>
<a href="#l12.28"></a><span id="l12.28"> {</span>
<a href="#l12.29"></a><span id="l12.29">   return NS_OK;</span>
<a href="#l12.30"></a><span id="l12.30"> }</span>
<a href="#l12.31"></a><span id="l12.31"> </span>
<a href="#l12.32"></a><span id="l12.32"> nsresult</span>
<a href="#l12.33"></a><span id="l12.33"> nsMsgAccountManagerDataSource::OnItemPropertyFlagChanged(nsIMsgDBHdr *, nsIAtom *, PRUint32, PRUint32)</span>
<a href="#l12.34"></a><span id="l12.34"> {</span>
<a href="#l12.35"></a><span id="l12.35">   return NS_OK;</span>
<a href="#l12.36"></a><span id="l12.36"> }</span>
<a href="#l12.37"></a><span id="l12.37"> </span>
<a href="#l12.38"></a><span id="l12.38"> nsresult</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineminus">-nsMsgAccountManagerDataSource::OnItemAdded(nsIRDFResource *, nsISupports *)</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineplus">+nsMsgAccountManagerDataSource::OnItemAdded(nsIMsgFolder *, nsISupports *)</span>
<a href="#l12.41"></a><span id="l12.41"> {</span>
<a href="#l12.42"></a><span id="l12.42">   return NS_OK;</span>
<a href="#l12.43"></a><span id="l12.43"> }</span>
<a href="#l12.44"></a><span id="l12.44"> </span>
<a href="#l12.45"></a><span id="l12.45"> </span>
<a href="#l12.46"></a><span id="l12.46"> nsresult</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineminus">-nsMsgAccountManagerDataSource::OnItemBoolPropertyChanged(nsIRDFResource *aItem,</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineplus">+nsMsgAccountManagerDataSource::OnItemBoolPropertyChanged(nsIMsgFolder *aItem,</span>
<a href="#l12.49"></a><span id="l12.49">                                                          nsIAtom *aProperty,</span>
<a href="#l12.50"></a><span id="l12.50">                                                          PRBool aOldValue,</span>
<a href="#l12.51"></a><span id="l12.51">                                                          PRBool aNewValue)</span>
<a href="#l12.52"></a><span id="l12.52"> {</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineminus">-  if (aProperty == kDefaultServerAtom)</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineminus">-    NotifyObservers(aItem, kNC_IsDefaultServer, kTrueLiteral, nsnull, aNewValue, PR_FALSE);</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineplus">+  if (aProperty == kDefaultServerAtom) {</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineplus">+    nsCOMPtr&lt;nsIRDFResource&gt; resource(do_QueryInterface(aItem));</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+    NotifyObservers(resource, kNC_IsDefaultServer, kTrueLiteral, nsnull, aNewValue, PR_FALSE);</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineplus">+  }</span>
<a href="#l12.59"></a><span id="l12.59">   return NS_OK;</span>
<a href="#l12.60"></a><span id="l12.60"> }</span>
<a href="#l12.61"></a><span id="l12.61"> </span>
<a href="#l12.62"></a><span id="l12.62"> nsresult</span>
<a href="#l12.63"></a><span id="l12.63"> nsMsgAccountManagerDataSource::OnItemEvent(nsIMsgFolder *, nsIAtom *)</span>
<a href="#l12.64"></a><span id="l12.64"> {</span>
<a href="#l12.65"></a><span id="l12.65">   return NS_OK;</span>
<a href="#l12.66"></a><span id="l12.66"> }</span>
<a href="#l12.67"></a><span id="l12.67"> </span>
<a href="#l12.68"></a><span id="l12.68"> nsresult</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineminus">-nsMsgAccountManagerDataSource::OnItemIntPropertyChanged(nsIRDFResource *, nsIAtom *, PRInt32, PRInt32)</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineplus">+nsMsgAccountManagerDataSource::OnItemIntPropertyChanged(nsIMsgFolder *, nsIAtom *, PRInt32, PRInt32)</span>
<a href="#l12.71"></a><span id="l12.71"> {</span>
<a href="#l12.72"></a><span id="l12.72">   return NS_OK;</span>
<a href="#l12.73"></a><span id="l12.73"> }</span>
<a href="#l12.74"></a><span id="l12.74"> </span>
<a href="#l12.75"></a><span id="l12.75"> PRBool</span>
<a href="#l12.76"></a><span id="l12.76"> nsMsgAccountManagerDataSource::IsFakeAccountRequired()</span>
<a href="#l12.77"></a><span id="l12.77"> {</span>
<a href="#l12.78"></a><span id="l12.78">   nsresult rv;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/src/nsMsgFolderDataSource.cpp</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgFolderDataSource.cpp</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -820,52 +820,54 @@ nsMsgFolderDataSource::DoCommand(nsISupp</span>
<a href="#l13.4"></a><span id="l13.4">       rv = NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l13.5"></a><span id="l13.5">     }</span>
<a href="#l13.6"></a><span id="l13.6">   }</span>
<a href="#l13.7"></a><span id="l13.7">   //for the moment return NS_OK, because failure stops entire DoCommand process.</span>
<a href="#l13.8"></a><span id="l13.8">   return rv;</span>
<a href="#l13.9"></a><span id="l13.9">   //return NS_OK;</span>
<a href="#l13.10"></a><span id="l13.10"> }</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-NS_IMETHODIMP nsMsgFolderDataSource::OnItemAdded(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+NS_IMETHODIMP nsMsgFolderDataSource::OnItemAdded(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l13.14"></a><span id="l13.14"> {</span>
<a href="#l13.15"></a><span id="l13.15">   return OnItemAddedOrRemoved(parentItem, item, PR_TRUE);</span>
<a href="#l13.16"></a><span id="l13.16"> }</span>
<a href="#l13.17"></a><span id="l13.17"> </span>
<a href="#l13.18"></a><span id="l13.18" class="difflineminus">-NS_IMETHODIMP nsMsgFolderDataSource::OnItemRemoved(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineplus">+NS_IMETHODIMP nsMsgFolderDataSource::OnItemRemoved(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l13.20"></a><span id="l13.20"> {</span>
<a href="#l13.21"></a><span id="l13.21">   return OnItemAddedOrRemoved(parentItem, item, PR_FALSE);</span>
<a href="#l13.22"></a><span id="l13.22"> }</span>
<a href="#l13.23"></a><span id="l13.23"> </span>
<a href="#l13.24"></a><span id="l13.24" class="difflineminus">-nsresult nsMsgFolderDataSource::OnItemAddedOrRemoved(nsIRDFResource *parentItem, nsISupports *item, PRBool added)</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineplus">+nsresult nsMsgFolderDataSource::OnItemAddedOrRemoved(nsIMsgFolder *parentItem, nsISupports *item, PRBool added)</span>
<a href="#l13.26"></a><span id="l13.26"> {</span>
<a href="#l13.27"></a><span id="l13.27">   nsCOMPtr&lt;nsIRDFNode&gt; itemNode(do_QueryInterface(item));</span>
<a href="#l13.28"></a><span id="l13.28">   if (itemNode)</span>
<a href="#l13.29"></a><span id="l13.29">   {</span>
<a href="#l13.30"></a><span id="l13.30" class="difflineminus">-    NotifyObservers(parentItem, kNC_Child, itemNode, nsnull, added, PR_FALSE);</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineplus">+    nsCOMPtr&lt;nsIRDFResource&gt; parentResource(do_QueryInterface(parentItem));</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+    NotifyObservers(parentResource, kNC_Child, itemNode, nsnull, added, PR_FALSE);</span>
<a href="#l13.33"></a><span id="l13.33">   }</span>
<a href="#l13.34"></a><span id="l13.34">   return NS_OK;</span>
<a href="#l13.35"></a><span id="l13.35"> }</span>
<a href="#l13.36"></a><span id="l13.36"> </span>
<a href="#l13.37"></a><span id="l13.37"> NS_IMETHODIMP</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineminus">-nsMsgFolderDataSource::OnItemPropertyChanged(nsIRDFResource *resource,</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineplus">+nsMsgFolderDataSource::OnItemPropertyChanged(nsIMsgFolder *resource,</span>
<a href="#l13.40"></a><span id="l13.40">                                              nsIAtom *property,</span>
<a href="#l13.41"></a><span id="l13.41">                                              const char *oldValue,</span>
<a href="#l13.42"></a><span id="l13.42">                                              const char *newValue)</span>
<a href="#l13.43"></a><span id="l13.43"> </span>
<a href="#l13.44"></a><span id="l13.44"> {</span>
<a href="#l13.45"></a><span id="l13.45">   return NS_OK;</span>
<a href="#l13.46"></a><span id="l13.46"> }</span>
<a href="#l13.47"></a><span id="l13.47"> </span>
<a href="#l13.48"></a><span id="l13.48"> NS_IMETHODIMP</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineminus">-nsMsgFolderDataSource::OnItemIntPropertyChanged(nsIRDFResource *resource,</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineplus">+nsMsgFolderDataSource::OnItemIntPropertyChanged(nsIMsgFolder *folder,</span>
<a href="#l13.51"></a><span id="l13.51">                                                 nsIAtom *property,</span>
<a href="#l13.52"></a><span id="l13.52">                                                 PRInt32 oldValue,</span>
<a href="#l13.53"></a><span id="l13.53">                                                 PRInt32 newValue)</span>
<a href="#l13.54"></a><span id="l13.54"> {</span>
<a href="#l13.55"></a><span id="l13.55" class="difflineplus">+  nsCOMPtr&lt;nsIRDFResource&gt; resource(do_QueryInterface(folder));</span>
<a href="#l13.56"></a><span id="l13.56">   if (kTotalMessagesAtom == property)</span>
<a href="#l13.57"></a><span id="l13.57">     OnTotalMessagePropertyChanged(resource, oldValue, newValue);</span>
<a href="#l13.58"></a><span id="l13.58">   else if (kTotalUnreadMessagesAtom == property)</span>
<a href="#l13.59"></a><span id="l13.59">     OnUnreadMessagePropertyChanged(resource, oldValue, newValue);</span>
<a href="#l13.60"></a><span id="l13.60">   else if (kFolderSizeAtom == property)</span>
<a href="#l13.61"></a><span id="l13.61">     OnFolderSizePropertyChanged(resource, oldValue, newValue);</span>
<a href="#l13.62"></a><span id="l13.62">   else if (kSortOrderAtom == property)</span>
<a href="#l13.63"></a><span id="l13.63">     OnFolderSortOrderPropertyChanged(resource, oldValue, newValue);</span>
<a href="#l13.64"></a><span id="l13.64" class="difflineat">@@ -878,42 +880,40 @@ nsMsgFolderDataSource::OnItemIntProperty</span>
<a href="#l13.65"></a><span id="l13.65">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l13.66"></a><span id="l13.66"> </span>
<a href="#l13.67"></a><span id="l13.67">     NotifyPropertyChanged(resource, kNC_BiffState, biffNode);</span>
<a href="#l13.68"></a><span id="l13.68">   }</span>
<a href="#l13.69"></a><span id="l13.69">   return NS_OK;</span>
<a href="#l13.70"></a><span id="l13.70"> }</span>
<a href="#l13.71"></a><span id="l13.71"> </span>
<a href="#l13.72"></a><span id="l13.72"> NS_IMETHODIMP</span>
<a href="#l13.73"></a><span id="l13.73" class="difflineminus">-nsMsgFolderDataSource::OnItemUnicharPropertyChanged(nsIRDFResource *resource,</span>
<a href="#l13.74"></a><span id="l13.74" class="difflineplus">+nsMsgFolderDataSource::OnItemUnicharPropertyChanged(nsIMsgFolder *folder,</span>
<a href="#l13.75"></a><span id="l13.75">                                                     nsIAtom *property,</span>
<a href="#l13.76"></a><span id="l13.76">                                                     const PRUnichar *oldValue,</span>
<a href="#l13.77"></a><span id="l13.77">                                                     const PRUnichar *newValue)</span>
<a href="#l13.78"></a><span id="l13.78"> {</span>
<a href="#l13.79"></a><span id="l13.79" class="difflineplus">+  nsCOMPtr&lt;nsIRDFResource&gt; resource(do_QueryInterface(folder));</span>
<a href="#l13.80"></a><span id="l13.80">   if (kNameAtom == property)</span>
<a href="#l13.81"></a><span id="l13.81">   {</span>
<a href="#l13.82"></a><span id="l13.82" class="difflineminus">-    nsCOMPtr&lt;nsIMsgFolder&gt; folder(do_QueryInterface(resource));</span>
<a href="#l13.83"></a><span id="l13.83" class="difflineminus">-    if (folder)</span>
<a href="#l13.84"></a><span id="l13.84" class="difflineminus">-    {</span>
<a href="#l13.85"></a><span id="l13.85" class="difflineminus">-      PRInt32 numUnread;</span>
<a href="#l13.86"></a><span id="l13.86" class="difflineminus">-      folder-&gt;GetNumUnread(PR_FALSE, &amp;numUnread);</span>
<a href="#l13.87"></a><span id="l13.87" class="difflineminus">-      NotifyFolderTreeNameChanged(folder, resource, numUnread);</span>
<a href="#l13.88"></a><span id="l13.88" class="difflineminus">-      NotifyFolderTreeSimpleNameChanged(folder, resource);</span>
<a href="#l13.89"></a><span id="l13.89" class="difflineminus">-      NotifyFolderNameChanged(folder, resource);</span>
<a href="#l13.90"></a><span id="l13.90" class="difflineminus">-    }</span>
<a href="#l13.91"></a><span id="l13.91" class="difflineplus">+    PRInt32 numUnread;</span>
<a href="#l13.92"></a><span id="l13.92" class="difflineplus">+    folder-&gt;GetNumUnread(PR_FALSE, &amp;numUnread);</span>
<a href="#l13.93"></a><span id="l13.93" class="difflineplus">+    NotifyFolderTreeNameChanged(folder, resource, numUnread);</span>
<a href="#l13.94"></a><span id="l13.94" class="difflineplus">+    NotifyFolderTreeSimpleNameChanged(folder, resource);</span>
<a href="#l13.95"></a><span id="l13.95" class="difflineplus">+    NotifyFolderNameChanged(folder, resource);</span>
<a href="#l13.96"></a><span id="l13.96">   }</span>
<a href="#l13.97"></a><span id="l13.97">   return NS_OK;</span>
<a href="#l13.98"></a><span id="l13.98"> }</span>
<a href="#l13.99"></a><span id="l13.99"> </span>
<a href="#l13.100"></a><span id="l13.100"> NS_IMETHODIMP</span>
<a href="#l13.101"></a><span id="l13.101" class="difflineminus">-nsMsgFolderDataSource::OnItemBoolPropertyChanged(nsIRDFResource *resource,</span>
<a href="#l13.102"></a><span id="l13.102" class="difflineplus">+nsMsgFolderDataSource::OnItemBoolPropertyChanged(nsIMsgFolder *folder,</span>
<a href="#l13.103"></a><span id="l13.103">                                                  nsIAtom *property,</span>
<a href="#l13.104"></a><span id="l13.104">                                                  PRBool oldValue,</span>
<a href="#l13.105"></a><span id="l13.105">                                                  PRBool newValue)</span>
<a href="#l13.106"></a><span id="l13.106"> {</span>
<a href="#l13.107"></a><span id="l13.107" class="difflineplus">+  nsCOMPtr&lt;nsIRDFResource&gt; resource(do_QueryInterface(folder));</span>
<a href="#l13.108"></a><span id="l13.108">   if (newValue != oldValue) {</span>
<a href="#l13.109"></a><span id="l13.109">     nsIRDFNode* literalNode = newValue?kTrueLiteral:kFalseLiteral;</span>
<a href="#l13.110"></a><span id="l13.110">     nsIRDFNode* oldLiteralNode = oldValue?kTrueLiteral:kFalseLiteral;</span>
<a href="#l13.111"></a><span id="l13.111">     if (kNewMessagesAtom == property)</span>
<a href="#l13.112"></a><span id="l13.112">       NotifyPropertyChanged(resource, kNC_NewMessages, literalNode);</span>
<a href="#l13.113"></a><span id="l13.113">     else if (kSynchronizeAtom == property)</span>
<a href="#l13.114"></a><span id="l13.114">       NotifyPropertyChanged(resource, kNC_Synchronize, literalNode);</span>
<a href="#l13.115"></a><span id="l13.115">     else if (kOpenAtom == property)</span>
<a href="#l13.116"></a><span id="l13.116" class="difflineat">@@ -2313,26 +2313,29 @@ NS_IMETHODIMP nsMsgFlatFolderDataSource:</span>
<a href="#l13.117"></a><span id="l13.117">         return NS_OK;</span>
<a href="#l13.118"></a><span id="l13.118">       }</span>
<a href="#l13.119"></a><span id="l13.119">     }</span>
<a href="#l13.120"></a><span id="l13.120">   }</span>
<a href="#l13.121"></a><span id="l13.121">   *hasAssertion = PR_FALSE;</span>
<a href="#l13.122"></a><span id="l13.122">   return NS_OK;</span>
<a href="#l13.123"></a><span id="l13.123"> }</span>
<a href="#l13.124"></a><span id="l13.124"> </span>
<a href="#l13.125"></a><span id="l13.125" class="difflineminus">-nsresult nsMsgFlatFolderDataSource::OnItemAddedOrRemoved(nsIRDFResource *parentItem, nsISupports *item, PRBool added)</span>
<a href="#l13.126"></a><span id="l13.126" class="difflineplus">+nsresult nsMsgFlatFolderDataSource::OnItemAddedOrRemoved(nsIMsgFolder *parentItem, nsISupports *item, PRBool added)</span>
<a href="#l13.127"></a><span id="l13.127"> {</span>
<a href="#l13.128"></a><span id="l13.128">   // When a folder is added or removed, parentItem is the parent folder and item is the folder being</span>
<a href="#l13.129"></a><span id="l13.129">   // added or removed. In a flat data source, there is no arc in the graph between the parent folder</span>
<a href="#l13.130"></a><span id="l13.130">   // and the folder being added or removed. Our flat data source root (i.e. mailnewsunreadfolders:/) has</span>
<a href="#l13.131"></a><span id="l13.131">   // an arc with the child property to every folder in the data source.  We must change parentItem</span>
<a href="#l13.132"></a><span id="l13.132">   // to be our data source root before calling nsMsgFolderDataSource::OnItemAddedOrRemoved. This ensures</span>
<a href="#l13.133"></a><span id="l13.133">   // that datasource listeners such as the template builder properly handle add and remove</span>
<a href="#l13.134"></a><span id="l13.134">   // notifications on the flat datasource.</span>
<a href="#l13.135"></a><span id="l13.135" class="difflineminus">-  return nsMsgFolderDataSource::OnItemAddedOrRemoved(m_rootResource, item, added);</span>
<a href="#l13.136"></a><span id="l13.136" class="difflineplus">+  nsCOMPtr&lt;nsIRDFNode&gt; itemNode(do_QueryInterface(item));</span>
<a href="#l13.137"></a><span id="l13.137" class="difflineplus">+  if (itemNode)</span>
<a href="#l13.138"></a><span id="l13.138" class="difflineplus">+    NotifyObservers(m_rootResource, kNC_Child, itemNode, nsnull, added, PR_FALSE);</span>
<a href="#l13.139"></a><span id="l13.139" class="difflineplus">+  return NS_OK;</span>
<a href="#l13.140"></a><span id="l13.140"> }</span>
<a href="#l13.141"></a><span id="l13.141"> </span>
<a href="#l13.142"></a><span id="l13.142"> PRBool nsMsgFlatFolderDataSource::ResourceIsOurRoot(nsIRDFResource *resource)</span>
<a href="#l13.143"></a><span id="l13.143"> {</span>
<a href="#l13.144"></a><span id="l13.144">   return m_rootResource.get() == resource;</span>
<a href="#l13.145"></a><span id="l13.145"> }</span>
<a href="#l13.146"></a><span id="l13.146"> </span>
<a href="#l13.147"></a><span id="l13.147"> PRBool nsMsgFlatFolderDataSource::WantsThisFolder(nsIMsgFolder *folder)</span>
<a href="#l13.148"></a><span id="l13.148" class="difflineat">@@ -2514,17 +2517,17 @@ PRBool nsMsgRecentFoldersDataSource::Wan</span>
<a href="#l13.149"></a><span id="l13.149">         }</span>
<a href="#l13.150"></a><span id="l13.150">       }</span>
<a href="#l13.151"></a><span id="l13.151">     }</span>
<a href="#l13.152"></a><span id="l13.152">   }</span>
<a href="#l13.153"></a><span id="l13.153">   m_builtRecentFolders = PR_TRUE;</span>
<a href="#l13.154"></a><span id="l13.154">   return m_folders.IndexOf(folder) != kNotFound;</span>
<a href="#l13.155"></a><span id="l13.155"> }</span>
<a href="#l13.156"></a><span id="l13.156"> </span>
<a href="#l13.157"></a><span id="l13.157" class="difflineminus">-NS_IMETHODIMP nsMsgRecentFoldersDataSource::OnItemAdded(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l13.158"></a><span id="l13.158" class="difflineplus">+NS_IMETHODIMP nsMsgRecentFoldersDataSource::OnItemAdded(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l13.159"></a><span id="l13.159"> {</span>
<a href="#l13.160"></a><span id="l13.160">   // if we've already built the recent folder array, we should add this item to the array</span>
<a href="#l13.161"></a><span id="l13.161">   // since just added items are by definition new.</span>
<a href="#l13.162"></a><span id="l13.162">   // I think this means newly discovered imap folders (ones w/o msf files) will</span>
<a href="#l13.163"></a><span id="l13.163">   // get added, but maybe that's OK.</span>
<a href="#l13.164"></a><span id="l13.164">   if (m_builtRecentFolders)</span>
<a href="#l13.165"></a><span id="l13.165">   {</span>
<a href="#l13.166"></a><span id="l13.166">     nsCOMPtr&lt;nsIMsgFolder&gt; folder(do_QueryInterface(item));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/src/nsMsgFolderDataSource.h</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgFolderDataSource.h</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -196,17 +196,17 @@ protected:</span>
<a href="#l14.4"></a><span id="l14.4">   nsresult DoFolderHasAssertion(nsIMsgFolder *folder, nsIRDFResource *property, nsIRDFNode *target,</span>
<a href="#l14.5"></a><span id="l14.5">                                 PRBool tv, PRBool *hasAssertion);</span>
<a href="#l14.6"></a><span id="l14.6"> </span>
<a href="#l14.7"></a><span id="l14.7">   nsresult GetBiffStateString(PRUint32 biffState, nsCAutoString &amp; biffStateStr);</span>
<a href="#l14.8"></a><span id="l14.8"> </span>
<a href="#l14.9"></a><span id="l14.9">   nsresult CreateUnreadMessagesNameString(PRInt32 unreadMessages, nsAutoString &amp;nameString);</span>
<a href="#l14.10"></a><span id="l14.10">   nsresult CreateArcsOutEnumerator();</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  virtual nsresult OnItemAddedOrRemoved(nsIRDFResource *parentItem, nsISupports *item, PRBool added);</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+  virtual nsresult OnItemAddedOrRemoved(nsIMsgFolder *parentItem, nsISupports *item, PRBool added);</span>
<a href="#l14.14"></a><span id="l14.14"> </span>
<a href="#l14.15"></a><span id="l14.15">   nsresult OnUnreadMessagePropertyChanged(nsIRDFResource *folderResource, PRInt32 oldValue, PRInt32 newValue);</span>
<a href="#l14.16"></a><span id="l14.16">   nsresult OnTotalMessagePropertyChanged(nsIRDFResource *folderResource, PRInt32 oldValue, PRInt32 newValue);</span>
<a href="#l14.17"></a><span id="l14.17">   nsresult OnFolderSizePropertyChanged(nsIRDFResource *folderResource, PRInt32 oldValue, PRInt32 newValue);</span>
<a href="#l14.18"></a><span id="l14.18">   nsresult OnFolderSortOrderPropertyChanged(nsIRDFResource *folderResource, PRInt32 oldValue, PRInt32 newValue);</span>
<a href="#l14.19"></a><span id="l14.19">   nsresult NotifyFolderTreeNameChanged(nsIMsgFolder *folder, nsIRDFResource *folderResource, PRInt32 aUnreadMessages);</span>
<a href="#l14.20"></a><span id="l14.20">   nsresult NotifyFolderTreeSimpleNameChanged(nsIMsgFolder *folder, nsIRDFResource *folderResource);</span>
<a href="#l14.21"></a><span id="l14.21">   nsresult NotifyFolderNameChanged(nsIMsgFolder *folder, nsIRDFResource *folderResource);</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineat">@@ -324,17 +324,17 @@ public:</span>
<a href="#l14.23"></a><span id="l14.23">                             nsIRDFResource* property,</span>
<a href="#l14.24"></a><span id="l14.24">                             nsIRDFNode* target,</span>
<a href="#l14.25"></a><span id="l14.25">                             PRBool tv,</span>
<a href="#l14.26"></a><span id="l14.26">                             PRBool* hasAssertion);</span>
<a href="#l14.27"></a><span id="l14.27"> protected:</span>
<a href="#l14.28"></a><span id="l14.28">   virtual nsresult GetFolderDisplayName(nsIMsgFolder *folder, nsString&amp; folderName);</span>
<a href="#l14.29"></a><span id="l14.29">   virtual PRBool WantsThisFolder(nsIMsgFolder *folder);</span>
<a href="#l14.30"></a><span id="l14.30">           PRBool ResourceIsOurRoot(nsIRDFResource *resource);</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-  virtual nsresult OnItemAddedOrRemoved(nsIRDFResource *parentItem, nsISupports *item, PRBool added);</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+  virtual nsresult OnItemAddedOrRemoved(nsIMsgFolder *parentItem, nsISupports *item, PRBool added);</span>
<a href="#l14.33"></a><span id="l14.33"> </span>
<a href="#l14.34"></a><span id="l14.34">   nsCOMArray &lt;nsIMsgFolder&gt; m_folders;</span>
<a href="#l14.35"></a><span id="l14.35">   nsCOMPtr&lt;nsIRDFResource&gt;  m_rootResource; // the resource for our root</span>
<a href="#l14.36"></a><span id="l14.36">   nsCString m_dsName;</span>
<a href="#l14.37"></a><span id="l14.37"> };</span>
<a href="#l14.38"></a><span id="l14.38"> </span>
<a href="#l14.39"></a><span id="l14.39"> </span>
<a href="#l14.40"></a><span id="l14.40"> class nsMsgUnreadFoldersDataSource : public nsMsgFlatFolderDataSource</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineat">@@ -362,17 +362,17 @@ class nsMsgRecentFoldersDataSource : pub</span>
<a href="#l14.42"></a><span id="l14.42"> {</span>
<a href="#l14.43"></a><span id="l14.43"> public:</span>
<a href="#l14.44"></a><span id="l14.44">   nsMsgRecentFoldersDataSource() {m_dsName = &quot;mailnewsrecentfolders&quot;; m_builtRecentFolders = PR_FALSE;</span>
<a href="#l14.45"></a><span id="l14.45">                                   m_cutOffDate = 0; m_maxNumFolders = 15;}</span>
<a href="#l14.46"></a><span id="l14.46">   virtual ~nsMsgRecentFoldersDataSource() {}</span>
<a href="#l14.47"></a><span id="l14.47">   virtual nsresult NotifyPropertyChanged(nsIRDFResource *resource, </span>
<a href="#l14.48"></a><span id="l14.48">                     nsIRDFResource *property, nsIRDFNode *newNode, </span>
<a href="#l14.49"></a><span id="l14.49">                     nsIRDFNode *oldNode);</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineminus">-  NS_IMETHOD OnItemAdded(nsIRDFResource *parentItem, nsISupports *item);</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+  NS_IMETHOD OnItemAdded(nsIMsgFolder *parentItem, nsISupports *item);</span>
<a href="#l14.52"></a><span id="l14.52">   virtual void Cleanup();</span>
<a href="#l14.53"></a><span id="l14.53"> protected:</span>
<a href="#l14.54"></a><span id="l14.54">   PRBool m_builtRecentFolders;</span>
<a href="#l14.55"></a><span id="l14.55">   virtual PRBool WantsThisFolder(nsIMsgFolder *folder);</span>
<a href="#l14.56"></a><span id="l14.56">   PRUint32 m_cutOffDate;</span>
<a href="#l14.57"></a><span id="l14.57">   PRInt32 m_maxNumFolders;</span>
<a href="#l14.58"></a><span id="l14.58"> };</span>
<a href="#l14.59"></a><span id="l14.59"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/base/src/nsMsgMailSession.cpp</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgMailSession.cpp</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -121,50 +121,50 @@ NS_IMETHODIMP nsMsgMailSession::RemoveFo</span>
<a href="#l15.4"></a><span id="l15.4">   while (iter.HasMore()) {                                             \</span>
<a href="#l15.5"></a><span id="l15.5">     const folderListener &amp;fL = iter.GetNext();                         \</span>
<a href="#l15.6"></a><span id="l15.6">     if (fL.mNotifyFlags &amp; nsIFolderListener::propertyflag_)            \</span>
<a href="#l15.7"></a><span id="l15.7">       fL.mListener-&gt;propertyfunc_ params_;                             \</span>
<a href="#l15.8"></a><span id="l15.8">   }                                                                    \</span>
<a href="#l15.9"></a><span id="l15.9">   PR_END_MACRO</span>
<a href="#l15.10"></a><span id="l15.10"> </span>
<a href="#l15.11"></a><span id="l15.11"> NS_IMETHODIMP</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-nsMsgMailSession::OnItemPropertyChanged(nsIRDFResource *aItem,</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+nsMsgMailSession::OnItemPropertyChanged(nsIMsgFolder *aItem,</span>
<a href="#l15.14"></a><span id="l15.14">                                         nsIAtom *aProperty,</span>
<a href="#l15.15"></a><span id="l15.15">                                         const char* aOldValue,</span>
<a href="#l15.16"></a><span id="l15.16">                                         const char* aNewValue)</span>
<a href="#l15.17"></a><span id="l15.17"> {</span>
<a href="#l15.18"></a><span id="l15.18">   NOTIFY_FOLDER_LISTENERS(propertyChanged, OnItemPropertyChanged,</span>
<a href="#l15.19"></a><span id="l15.19">                           (aItem, aProperty, aOldValue, aNewValue));</span>
<a href="#l15.20"></a><span id="l15.20">   return NS_OK;</span>
<a href="#l15.21"></a><span id="l15.21"> }</span>
<a href="#l15.22"></a><span id="l15.22"> </span>
<a href="#l15.23"></a><span id="l15.23"> NS_IMETHODIMP</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineminus">-nsMsgMailSession::OnItemUnicharPropertyChanged(nsIRDFResource *aItem,</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+nsMsgMailSession::OnItemUnicharPropertyChanged(nsIMsgFolder *aItem,</span>
<a href="#l15.26"></a><span id="l15.26">                                                nsIAtom *aProperty,</span>
<a href="#l15.27"></a><span id="l15.27">                                                const PRUnichar* aOldValue,</span>
<a href="#l15.28"></a><span id="l15.28">                                                const PRUnichar* aNewValue)</span>
<a href="#l15.29"></a><span id="l15.29"> {</span>
<a href="#l15.30"></a><span id="l15.30">   NOTIFY_FOLDER_LISTENERS(unicharPropertyChanged, OnItemUnicharPropertyChanged,</span>
<a href="#l15.31"></a><span id="l15.31">                           (aItem, aProperty, aOldValue, aNewValue));</span>
<a href="#l15.32"></a><span id="l15.32">   return NS_OK;</span>
<a href="#l15.33"></a><span id="l15.33"> }</span>
<a href="#l15.34"></a><span id="l15.34"> </span>
<a href="#l15.35"></a><span id="l15.35"> NS_IMETHODIMP</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineminus">-nsMsgMailSession::OnItemIntPropertyChanged(nsIRDFResource *aItem,</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+nsMsgMailSession::OnItemIntPropertyChanged(nsIMsgFolder *aItem,</span>
<a href="#l15.38"></a><span id="l15.38">                                            nsIAtom *aProperty,</span>
<a href="#l15.39"></a><span id="l15.39">                                            PRInt32 aOldValue,</span>
<a href="#l15.40"></a><span id="l15.40">                                            PRInt32 aNewValue)</span>
<a href="#l15.41"></a><span id="l15.41"> {</span>
<a href="#l15.42"></a><span id="l15.42">   NOTIFY_FOLDER_LISTENERS(intPropertyChanged, OnItemIntPropertyChanged,</span>
<a href="#l15.43"></a><span id="l15.43">                           (aItem, aProperty, aOldValue, aNewValue));</span>
<a href="#l15.44"></a><span id="l15.44">   return NS_OK;</span>
<a href="#l15.45"></a><span id="l15.45"> }</span>
<a href="#l15.46"></a><span id="l15.46"> </span>
<a href="#l15.47"></a><span id="l15.47"> NS_IMETHODIMP</span>
<a href="#l15.48"></a><span id="l15.48" class="difflineminus">-nsMsgMailSession::OnItemBoolPropertyChanged(nsIRDFResource *aItem,</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineplus">+nsMsgMailSession::OnItemBoolPropertyChanged(nsIMsgFolder *aItem,</span>
<a href="#l15.50"></a><span id="l15.50">                                             nsIAtom *aProperty,</span>
<a href="#l15.51"></a><span id="l15.51">                                             PRBool aOldValue,</span>
<a href="#l15.52"></a><span id="l15.52">                                             PRBool aNewValue)</span>
<a href="#l15.53"></a><span id="l15.53"> {</span>
<a href="#l15.54"></a><span id="l15.54">   NOTIFY_FOLDER_LISTENERS(boolPropertyChanged, OnItemBoolPropertyChanged,</span>
<a href="#l15.55"></a><span id="l15.55">                           (aItem, aProperty, aOldValue, aNewValue));</span>
<a href="#l15.56"></a><span id="l15.56">   return NS_OK;</span>
<a href="#l15.57"></a><span id="l15.57"> }</span>
<a href="#l15.58"></a><span id="l15.58" class="difflineat">@@ -175,24 +175,24 @@ nsMsgMailSession::OnItemPropertyFlagChan</span>
<a href="#l15.59"></a><span id="l15.59">                                             PRUint32 aOldValue,</span>
<a href="#l15.60"></a><span id="l15.60">                                             PRUint32 aNewValue)</span>
<a href="#l15.61"></a><span id="l15.61"> {</span>
<a href="#l15.62"></a><span id="l15.62">   NOTIFY_FOLDER_LISTENERS(propertyFlagChanged, OnItemPropertyFlagChanged,</span>
<a href="#l15.63"></a><span id="l15.63">                           (aItem, aProperty, aOldValue, aNewValue));</span>
<a href="#l15.64"></a><span id="l15.64">   return NS_OK;</span>
<a href="#l15.65"></a><span id="l15.65"> }</span>
<a href="#l15.66"></a><span id="l15.66"> </span>
<a href="#l15.67"></a><span id="l15.67" class="difflineminus">-NS_IMETHODIMP nsMsgMailSession::OnItemAdded(nsIRDFResource *aParentItem,</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineplus">+NS_IMETHODIMP nsMsgMailSession::OnItemAdded(nsIMsgFolder *aParentItem,</span>
<a href="#l15.69"></a><span id="l15.69">                                             nsISupports *aItem)</span>
<a href="#l15.70"></a><span id="l15.70"> {</span>
<a href="#l15.71"></a><span id="l15.71">   NOTIFY_FOLDER_LISTENERS(added, OnItemAdded, (aParentItem, aItem));</span>
<a href="#l15.72"></a><span id="l15.72">   return NS_OK;</span>
<a href="#l15.73"></a><span id="l15.73"> }</span>
<a href="#l15.74"></a><span id="l15.74"> </span>
<a href="#l15.75"></a><span id="l15.75" class="difflineminus">-NS_IMETHODIMP nsMsgMailSession::OnItemRemoved(nsIRDFResource *aParentItem,</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineplus">+NS_IMETHODIMP nsMsgMailSession::OnItemRemoved(nsIMsgFolder *aParentItem,</span>
<a href="#l15.77"></a><span id="l15.77">                                               nsISupports *aItem)</span>
<a href="#l15.78"></a><span id="l15.78"> {</span>
<a href="#l15.79"></a><span id="l15.79">   NOTIFY_FOLDER_LISTENERS(removed, OnItemRemoved, (aParentItem, aItem));</span>
<a href="#l15.80"></a><span id="l15.80">   return NS_OK;</span>
<a href="#l15.81"></a><span id="l15.81"> }</span>
<a href="#l15.82"></a><span id="l15.82"> </span>
<a href="#l15.83"></a><span id="l15.83"> </span>
<a href="#l15.84"></a><span id="l15.84"> NS_IMETHODIMP nsMsgMailSession::OnItemEvent(nsIMsgFolder *aFolder,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/base/src/nsStatusBarBiffManager.cpp</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/base/src/nsStatusBarBiffManager.cpp</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -161,35 +161,35 @@ nsresult nsStatusBarBiffManager::PlayBif</span>
<a href="#l16.4"></a><span id="l16.4">     rv = mSound-&gt;PlaySystemSound(DEFAULT_SYSTEM_SOUND);</span>
<a href="#l16.5"></a><span id="l16.5">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l16.6"></a><span id="l16.6">   }</span>
<a href="#l16.7"></a><span id="l16.7">   return rv;</span>
<a href="#l16.8"></a><span id="l16.8"> }</span>
<a href="#l16.9"></a><span id="l16.9"> </span>
<a href="#l16.10"></a><span id="l16.10"> // nsIFolderListener methods....</span>
<a href="#l16.11"></a><span id="l16.11"> NS_IMETHODIMP </span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-nsStatusBarBiffManager::OnItemAdded(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+nsStatusBarBiffManager::OnItemAdded(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l16.14"></a><span id="l16.14"> {</span>
<a href="#l16.15"></a><span id="l16.15">   return NS_OK;</span>
<a href="#l16.16"></a><span id="l16.16"> }</span>
<a href="#l16.17"></a><span id="l16.17"> </span>
<a href="#l16.18"></a><span id="l16.18"> NS_IMETHODIMP </span>
<a href="#l16.19"></a><span id="l16.19" class="difflineminus">-nsStatusBarBiffManager::OnItemRemoved(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineplus">+nsStatusBarBiffManager::OnItemRemoved(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l16.21"></a><span id="l16.21"> {</span>
<a href="#l16.22"></a><span id="l16.22">   return NS_OK;</span>
<a href="#l16.23"></a><span id="l16.23"> }</span>
<a href="#l16.24"></a><span id="l16.24"> </span>
<a href="#l16.25"></a><span id="l16.25"> NS_IMETHODIMP </span>
<a href="#l16.26"></a><span id="l16.26" class="difflineminus">-nsStatusBarBiffManager::OnItemPropertyChanged(nsIRDFResource *item, nsIAtom *property, const char *oldValue, const char *newValue)</span>
<a href="#l16.27"></a><span id="l16.27" class="difflineplus">+nsStatusBarBiffManager::OnItemPropertyChanged(nsIMsgFolder *item, nsIAtom *property, const char *oldValue, const char *newValue)</span>
<a href="#l16.28"></a><span id="l16.28"> {</span>
<a href="#l16.29"></a><span id="l16.29">   return NS_OK;</span>
<a href="#l16.30"></a><span id="l16.30"> }</span>
<a href="#l16.31"></a><span id="l16.31"> </span>
<a href="#l16.32"></a><span id="l16.32"> NS_IMETHODIMP</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineminus">-nsStatusBarBiffManager::OnItemIntPropertyChanged(nsIRDFResource *item, nsIAtom *property, PRInt32 oldValue, PRInt32 newValue)</span>
<a href="#l16.34"></a><span id="l16.34" class="difflineplus">+nsStatusBarBiffManager::OnItemIntPropertyChanged(nsIMsgFolder *item, nsIAtom *property, PRInt32 oldValue, PRInt32 newValue)</span>
<a href="#l16.35"></a><span id="l16.35"> {</span>
<a href="#l16.36"></a><span id="l16.36">   if (kBiffStateAtom == property &amp;&amp; mCurrentBiffState != newValue) {</span>
<a href="#l16.37"></a><span id="l16.37">     // if we got new mail, attempt to play a sound.</span>
<a href="#l16.38"></a><span id="l16.38">     // if we fail along the way, don't return.</span>
<a href="#l16.39"></a><span id="l16.39">     // we still need to update the UI.    </span>
<a href="#l16.40"></a><span id="l16.40">     if (newValue == nsIMsgFolder::nsMsgBiffState_NewMail) {</span>
<a href="#l16.41"></a><span id="l16.41">       // if we fail to play the biff sound, keep going.</span>
<a href="#l16.42"></a><span id="l16.42">       (void)PlayBiffSound();</span>
<a href="#l16.43"></a><span id="l16.43" class="difflineat">@@ -202,23 +202,23 @@ nsStatusBarBiffManager::OnItemIntPropert</span>
<a href="#l16.44"></a><span id="l16.44">       </span>
<a href="#l16.45"></a><span id="l16.45">     if (observerService)</span>
<a href="#l16.46"></a><span id="l16.46">       observerService-&gt;NotifyObservers(this, &quot;mail:biff-state-changed&quot;, nsnull);</span>
<a href="#l16.47"></a><span id="l16.47">   }</span>
<a href="#l16.48"></a><span id="l16.48">   return NS_OK;</span>
<a href="#l16.49"></a><span id="l16.49"> }</span>
<a href="#l16.50"></a><span id="l16.50"> </span>
<a href="#l16.51"></a><span id="l16.51"> NS_IMETHODIMP </span>
<a href="#l16.52"></a><span id="l16.52" class="difflineminus">-nsStatusBarBiffManager::OnItemBoolPropertyChanged(nsIRDFResource *item, nsIAtom *property, PRBool oldValue, PRBool newValue)</span>
<a href="#l16.53"></a><span id="l16.53" class="difflineplus">+nsStatusBarBiffManager::OnItemBoolPropertyChanged(nsIMsgFolder *item, nsIAtom *property, PRBool oldValue, PRBool newValue)</span>
<a href="#l16.54"></a><span id="l16.54"> {</span>
<a href="#l16.55"></a><span id="l16.55">   return NS_OK;</span>
<a href="#l16.56"></a><span id="l16.56"> }</span>
<a href="#l16.57"></a><span id="l16.57"> </span>
<a href="#l16.58"></a><span id="l16.58"> NS_IMETHODIMP </span>
<a href="#l16.59"></a><span id="l16.59" class="difflineminus">-nsStatusBarBiffManager::OnItemUnicharPropertyChanged(nsIRDFResource *item, nsIAtom *property, const PRUnichar *oldValue, const PRUnichar *newValue)</span>
<a href="#l16.60"></a><span id="l16.60" class="difflineplus">+nsStatusBarBiffManager::OnItemUnicharPropertyChanged(nsIMsgFolder *item, nsIAtom *property, const PRUnichar *oldValue, const PRUnichar *newValue)</span>
<a href="#l16.61"></a><span id="l16.61"> {</span>
<a href="#l16.62"></a><span id="l16.62">   return NS_OK;</span>
<a href="#l16.63"></a><span id="l16.63"> }</span>
<a href="#l16.64"></a><span id="l16.64"> </span>
<a href="#l16.65"></a><span id="l16.65"> NS_IMETHODIMP </span>
<a href="#l16.66"></a><span id="l16.66"> nsStatusBarBiffManager::OnItemPropertyFlagChanged(nsIMsgDBHdr *item, nsIAtom *property, PRUint32 oldFlag, PRUint32 newFlag)</span>
<a href="#l16.67"></a><span id="l16.67"> {</span>
<a href="#l16.68"></a><span id="l16.68">   return NS_OK;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/local/src/nsLocalUndoTxn.cpp</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/local/src/nsLocalUndoTxn.cpp</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -410,42 +410,42 @@ nsLocalUndoFolderListener::nsLocalUndoFo</span>
<a href="#l17.4"></a><span id="l17.4">   mTxn = aTxn;</span>
<a href="#l17.5"></a><span id="l17.5">   mFolder = aFolder;</span>
<a href="#l17.6"></a><span id="l17.6"> }</span>
<a href="#l17.7"></a><span id="l17.7"> </span>
<a href="#l17.8"></a><span id="l17.8"> nsLocalUndoFolderListener::~nsLocalUndoFolderListener()</span>
<a href="#l17.9"></a><span id="l17.9"> {</span>
<a href="#l17.10"></a><span id="l17.10"> }</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-NS_IMETHODIMP nsLocalUndoFolderListener::OnItemAdded(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+NS_IMETHODIMP nsLocalUndoFolderListener::OnItemAdded(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l17.14"></a><span id="l17.14"> {</span>
<a href="#l17.15"></a><span id="l17.15">     return NS_OK;</span>
<a href="#l17.16"></a><span id="l17.16"> }</span>
<a href="#l17.17"></a><span id="l17.17"> </span>
<a href="#l17.18"></a><span id="l17.18" class="difflineminus">-NS_IMETHODIMP nsLocalUndoFolderListener::OnItemRemoved(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineplus">+NS_IMETHODIMP nsLocalUndoFolderListener::OnItemRemoved(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l17.20"></a><span id="l17.20"> {</span>
<a href="#l17.21"></a><span id="l17.21">     return NS_OK;</span>
<a href="#l17.22"></a><span id="l17.22"> }</span>
<a href="#l17.23"></a><span id="l17.23"> </span>
<a href="#l17.24"></a><span id="l17.24" class="difflineminus">-NS_IMETHODIMP nsLocalUndoFolderListener::OnItemPropertyChanged(nsIRDFResource *item, nsIAtom *property, const char *oldValue, const char *newValue)</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineplus">+NS_IMETHODIMP nsLocalUndoFolderListener::OnItemPropertyChanged(nsIMsgFolder *item, nsIAtom *property, const char *oldValue, const char *newValue)</span>
<a href="#l17.26"></a><span id="l17.26"> {</span>
<a href="#l17.27"></a><span id="l17.27">     return NS_OK;</span>
<a href="#l17.28"></a><span id="l17.28"> }</span>
<a href="#l17.29"></a><span id="l17.29"> </span>
<a href="#l17.30"></a><span id="l17.30" class="difflineminus">-NS_IMETHODIMP nsLocalUndoFolderListener::OnItemIntPropertyChanged(nsIRDFResource *item, nsIAtom *property, PRInt32 oldValue, PRInt32 newValue)</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineplus">+NS_IMETHODIMP nsLocalUndoFolderListener::OnItemIntPropertyChanged(nsIMsgFolder *item, nsIAtom *property, PRInt32 oldValue, PRInt32 newValue)</span>
<a href="#l17.32"></a><span id="l17.32"> {</span>
<a href="#l17.33"></a><span id="l17.33">     return NS_OK;</span>
<a href="#l17.34"></a><span id="l17.34"> }</span>
<a href="#l17.35"></a><span id="l17.35"> </span>
<a href="#l17.36"></a><span id="l17.36" class="difflineminus">-NS_IMETHODIMP nsLocalUndoFolderListener::OnItemBoolPropertyChanged(nsIRDFResource *item, nsIAtom *property, PRBool oldValue, PRBool newValue)</span>
<a href="#l17.37"></a><span id="l17.37" class="difflineplus">+NS_IMETHODIMP nsLocalUndoFolderListener::OnItemBoolPropertyChanged(nsIMsgFolder *item, nsIAtom *property, PRBool oldValue, PRBool newValue)</span>
<a href="#l17.38"></a><span id="l17.38"> {</span>
<a href="#l17.39"></a><span id="l17.39">     return NS_OK;</span>
<a href="#l17.40"></a><span id="l17.40"> }</span>
<a href="#l17.41"></a><span id="l17.41"> </span>
<a href="#l17.42"></a><span id="l17.42" class="difflineminus">-NS_IMETHODIMP nsLocalUndoFolderListener::OnItemUnicharPropertyChanged(nsIRDFResource *item, nsIAtom *property, const PRUnichar *oldValue, const PRUnichar *newValue)</span>
<a href="#l17.43"></a><span id="l17.43" class="difflineplus">+NS_IMETHODIMP nsLocalUndoFolderListener::OnItemUnicharPropertyChanged(nsIMsgFolder *item, nsIAtom *property, const PRUnichar *oldValue, const PRUnichar *newValue)</span>
<a href="#l17.44"></a><span id="l17.44"> {</span>
<a href="#l17.45"></a><span id="l17.45">     return NS_OK;</span>
<a href="#l17.46"></a><span id="l17.46"> }</span>
<a href="#l17.47"></a><span id="l17.47"> </span>
<a href="#l17.48"></a><span id="l17.48"> NS_IMETHODIMP nsLocalUndoFolderListener::OnItemPropertyFlagChanged(nsIMsgDBHdr *item, nsIAtom *property, PRUint32 oldFlag, PRUint32 newFlag)</span>
<a href="#l17.49"></a><span id="l17.49"> {</span>
<a href="#l17.50"></a><span id="l17.50">     return NS_OK;</span>
<a href="#l17.51"></a><span id="l17.51"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/local/src/nsPop3IncomingServer.cpp</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/local/src/nsPop3IncomingServer.cpp</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -46,17 +46,16 @@</span>
<a href="#l18.4"></a><span id="l18.4"> #include &quot;nsIPop3Service.h&quot;</span>
<a href="#l18.5"></a><span id="l18.5"> #include &quot;nsMsgBaseCID.h&quot;</span>
<a href="#l18.6"></a><span id="l18.6"> #include &quot;nsMsgLocalCID.h&quot;</span>
<a href="#l18.7"></a><span id="l18.7"> #include &quot;nsMsgFolderFlags.h&quot;</span>
<a href="#l18.8"></a><span id="l18.8"> #include &quot;nsPop3Protocol.h&quot;</span>
<a href="#l18.9"></a><span id="l18.9"> #include &quot;nsIMsgLocalMailFolder.h&quot;</span>
<a href="#l18.10"></a><span id="l18.10"> #include &quot;nsIMsgAccountManager.h&quot;</span>
<a href="#l18.11"></a><span id="l18.11"> #include &quot;nsIMsgMailNewsUrl.h&quot;</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-#include &quot;nsIRDFResource.h&quot;</span>
<a href="#l18.13"></a><span id="l18.13"> </span>
<a href="#l18.14"></a><span id="l18.14"> static NS_DEFINE_CID(kCPop3ServiceCID, NS_POP3SERVICE_CID);</span>
<a href="#l18.15"></a><span id="l18.15"> </span>
<a href="#l18.16"></a><span id="l18.16"> class nsPop3GetMailChainer : public nsIUrlListener</span>
<a href="#l18.17"></a><span id="l18.17"> {</span>
<a href="#l18.18"></a><span id="l18.18"> public:</span>
<a href="#l18.19"></a><span id="l18.19">   NS_DECL_ISUPPORTS</span>
<a href="#l18.20"></a><span id="l18.20">   NS_DECL_NSIURLLISTENER</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineat">@@ -154,22 +153,21 @@ NS_IMETHODIMP nsPop3IncomingServer::SetD</span>
<a href="#l18.22"></a><span id="l18.22">     // use GetRootFolder, because that returns the real</span>
<a href="#l18.23"></a><span id="l18.23">     // root, not the deferred to root.</span>
<a href="#l18.24"></a><span id="l18.24">     rv = GetRootFolder(getter_AddRefs(rootFolder));</span>
<a href="#l18.25"></a><span id="l18.25">     if (rootFolder)</span>
<a href="#l18.26"></a><span id="l18.26">     {</span>
<a href="#l18.27"></a><span id="l18.27">       // if isDeferred state has changed, send notification</span>
<a href="#l18.28"></a><span id="l18.28">       if (aAccountKey.IsEmpty() != deferredToAccount.IsEmpty())</span>
<a href="#l18.29"></a><span id="l18.29">       {</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineminus">-        nsCOMPtr &lt;nsIRDFResource&gt; folderRes = do_QueryInterface(rootFolder);</span>
<a href="#l18.31"></a><span id="l18.31">         nsCOMPtr &lt;nsIAtom&gt; deferAtom = getter_AddRefs(NS_NewAtom(&quot;isDeferred&quot;));</span>
<a href="#l18.32"></a><span id="l18.32">         nsCOMPtr &lt;nsIAtom&gt; canFileAtom = getter_AddRefs(NS_NewAtom(&quot;CanFileMessages&quot;));</span>
<a href="#l18.33"></a><span id="l18.33" class="difflineminus">-        folderListenerManager-&gt;OnItemBoolPropertyChanged(folderRes, deferAtom,</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineplus">+        folderListenerManager-&gt;OnItemBoolPropertyChanged(rootFolder, deferAtom,</span>
<a href="#l18.35"></a><span id="l18.35">                   !deferredToAccount.IsEmpty(), deferredToAccount.IsEmpty());</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineminus">-        folderListenerManager-&gt;OnItemBoolPropertyChanged(folderRes, canFileAtom,</span>
<a href="#l18.37"></a><span id="l18.37" class="difflineplus">+        folderListenerManager-&gt;OnItemBoolPropertyChanged(rootFolder, canFileAtom,</span>
<a href="#l18.38"></a><span id="l18.38">                   deferredToAccount.IsEmpty(), !deferredToAccount.IsEmpty());</span>
<a href="#l18.39"></a><span id="l18.39"> </span>
<a href="#l18.40"></a><span id="l18.40">         // this hack causes the account manager ds to send notifications to the</span>
<a href="#l18.41"></a><span id="l18.41">         // xul content builder that make the changed acct appear or disappear</span>
<a href="#l18.42"></a><span id="l18.42">         // from the folder pane and related menus.</span>
<a href="#l18.43"></a><span id="l18.43">         nsCOMPtr&lt;nsIMsgAccountManager&gt; acctMgr =</span>
<a href="#l18.44"></a><span id="l18.44">                             do_GetService(NS_MSGACCOUNTMANAGER_CONTRACTID);</span>
<a href="#l18.45"></a><span id="l18.45">         if (acctMgr)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/local/src/nsRssIncomingServer.cpp</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/local/src/nsRssIncomingServer.cpp</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -249,17 +249,17 @@ NS_IMETHODIMP nsRssIncomingServer::GetSe</span>
<a href="#l19.4"></a><span id="l19.4"> </span>
<a href="#l19.5"></a><span id="l19.5"> NS_IMETHODIMP nsRssIncomingServer::GetCanSearchMessages(PRBool *canSearchMessages)</span>
<a href="#l19.6"></a><span id="l19.6"> {</span>
<a href="#l19.7"></a><span id="l19.7">   NS_ENSURE_ARG_POINTER(canSearchMessages);</span>
<a href="#l19.8"></a><span id="l19.8">   *canSearchMessages = PR_TRUE;</span>
<a href="#l19.9"></a><span id="l19.9">   return NS_OK;</span>
<a href="#l19.10"></a><span id="l19.10"> }</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-NS_IMETHODIMP nsRssIncomingServer::OnItemAdded(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+NS_IMETHODIMP nsRssIncomingServer::OnItemAdded(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l19.14"></a><span id="l19.14"> {</span>
<a href="#l19.15"></a><span id="l19.15">   nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryInterface(item);</span>
<a href="#l19.16"></a><span id="l19.16">   // just kick out with a success code if the item in question is not a folder</span>
<a href="#l19.17"></a><span id="l19.17">   if (!folder)</span>
<a href="#l19.18"></a><span id="l19.18">     return NS_OK;</span>
<a href="#l19.19"></a><span id="l19.19"> </span>
<a href="#l19.20"></a><span id="l19.20">   nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l19.21"></a><span id="l19.21">   nsresult rv = folder-&gt;GetServer(getter_AddRefs(server));</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineat">@@ -312,37 +312,37 @@ NS_IMETHODIMP nsRssIncomingServer::OnIte</span>
<a href="#l19.23"></a><span id="l19.23">       if (rssFolder)</span>
<a href="#l19.24"></a><span id="l19.24">         rssDownloader-&gt;UpdateSubscriptionsDS(rssFolder, unsubscribe);</span>
<a href="#l19.25"></a><span id="l19.25">     }</span>
<a href="#l19.26"></a><span id="l19.26">   }</span>
<a href="#l19.27"></a><span id="l19.27"> </span>
<a href="#l19.28"></a><span id="l19.28">   return rv;</span>
<a href="#l19.29"></a><span id="l19.29"> }</span>
<a href="#l19.30"></a><span id="l19.30"> </span>
<a href="#l19.31"></a><span id="l19.31" class="difflineminus">-NS_IMETHODIMP nsRssIncomingServer::OnItemRemoved(nsIRDFResource *parentItem, nsISupports *item)</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineplus">+NS_IMETHODIMP nsRssIncomingServer::OnItemRemoved(nsIMsgFolder *parentItem, nsISupports *item)</span>
<a href="#l19.33"></a><span id="l19.33"> {</span>
<a href="#l19.34"></a><span id="l19.34">  return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l19.35"></a><span id="l19.35"> }</span>
<a href="#l19.36"></a><span id="l19.36"> </span>
<a href="#l19.37"></a><span id="l19.37" class="difflineminus">-NS_IMETHODIMP nsRssIncomingServer::OnItemPropertyChanged(nsIRDFResource *item, nsIAtom *property, const char *oldValue, const char *newValue)</span>
<a href="#l19.38"></a><span id="l19.38" class="difflineplus">+NS_IMETHODIMP nsRssIncomingServer::OnItemPropertyChanged(nsIMsgFolder *item, nsIAtom *property, const char *oldValue, const char *newValue)</span>
<a href="#l19.39"></a><span id="l19.39"> {</span>
<a href="#l19.40"></a><span id="l19.40">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l19.41"></a><span id="l19.41"> }</span>
<a href="#l19.42"></a><span id="l19.42"> </span>
<a href="#l19.43"></a><span id="l19.43" class="difflineminus">-NS_IMETHODIMP nsRssIncomingServer::OnItemIntPropertyChanged(nsIRDFResource *item, nsIAtom *property, PRInt32 oldValue, PRInt32 newValue)</span>
<a href="#l19.44"></a><span id="l19.44" class="difflineplus">+NS_IMETHODIMP nsRssIncomingServer::OnItemIntPropertyChanged(nsIMsgFolder *item, nsIAtom *property, PRInt32 oldValue, PRInt32 newValue)</span>
<a href="#l19.45"></a><span id="l19.45"> {</span>
<a href="#l19.46"></a><span id="l19.46">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l19.47"></a><span id="l19.47"> }</span>
<a href="#l19.48"></a><span id="l19.48"> </span>
<a href="#l19.49"></a><span id="l19.49" class="difflineminus">-NS_IMETHODIMP nsRssIncomingServer::OnItemBoolPropertyChanged(nsIRDFResource *item, nsIAtom *property, PRBool oldValue, PRBool newValue)</span>
<a href="#l19.50"></a><span id="l19.50" class="difflineplus">+NS_IMETHODIMP nsRssIncomingServer::OnItemBoolPropertyChanged(nsIMsgFolder *item, nsIAtom *property, PRBool oldValue, PRBool newValue)</span>
<a href="#l19.51"></a><span id="l19.51"> {</span>
<a href="#l19.52"></a><span id="l19.52">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l19.53"></a><span id="l19.53"> }</span>
<a href="#l19.54"></a><span id="l19.54"> </span>
<a href="#l19.55"></a><span id="l19.55" class="difflineminus">-NS_IMETHODIMP nsRssIncomingServer::OnItemUnicharPropertyChanged(nsIRDFResource *item, nsIAtom *property, const PRUnichar *oldValue, const PRUnichar *newValue)</span>
<a href="#l19.56"></a><span id="l19.56" class="difflineplus">+NS_IMETHODIMP nsRssIncomingServer::OnItemUnicharPropertyChanged(nsIMsgFolder *item, nsIAtom *property, const PRUnichar *oldValue, const PRUnichar *newValue)</span>
<a href="#l19.57"></a><span id="l19.57"> {</span>
<a href="#l19.58"></a><span id="l19.58">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l19.59"></a><span id="l19.59"> }</span>
<a href="#l19.60"></a><span id="l19.60"> </span>
<a href="#l19.61"></a><span id="l19.61"> NS_IMETHODIMP nsRssIncomingServer::OnItemPropertyFlagChanged(nsIMsgDBHdr *item, nsIAtom *property, PRUint32 oldFlag, PRUint32 newFlag)</span>
<a href="#l19.62"></a><span id="l19.62"> {</span>
<a href="#l19.63"></a><span id="l19.63">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l19.64"></a><span id="l19.64"> }</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

