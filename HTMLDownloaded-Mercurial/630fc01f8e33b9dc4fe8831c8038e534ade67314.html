<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 24865:630fc01f8e33b9dc4fe8831c8038e534ade67314</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 630fc01f8e33b9dc4fe8831c8038e534ade67314" />
<meta property="og:url" content="/comm-central/rev/630fc01f8e33b9dc4fe8831c8038e534ade67314" />
<meta property="og:description" content="Bug 1487008 - Toolbar buttons WebExtensions API. r=philipp" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 630fc01f8e33b9dc4fe8831c8038e534ade67314 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/630fc01f8e33b9dc4fe8831c8038e534ade67314">shortlog</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/630fc01f8e33b9dc4fe8831c8038e534ade67314">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314">files</a> |
changeset |
<a href="/comm-central/raw-rev/630fc01f8e33b9dc4fe8831c8038e534ade67314">raw</a>  | <a href="/comm-central/archive/630fc01f8e33b9dc4fe8831c8038e534ade67314.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1487008">Bug 1487008</a> - Toolbar buttons WebExtensions API. r=philipp
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#71;&#101;&#111;&#102;&#102;&#32;&#76;&#97;&#110;&#107;&#111;&#119;&#32;&#60;&#103;&#101;&#111;&#102;&#102;&#64;&#100;&#97;&#114;&#107;&#116;&#114;&#111;&#106;&#97;&#110;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 27 Sep 2018 12:03:28 +1200</td></tr>

<tr>
 <td>changeset 24865</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/630fc01f8e33b9dc4fe8831c8038e534ade67314">630fc01f8e33b9dc4fe8831c8038e534ade67314</a></td>
</tr>



<tr>
<td>parent 24864</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/93d3584af75b199939a7e19ef2c6d87d44d494fa">93d3584af75b199939a7e19ef2c6d87d44d494fa</a>
</td>
</tr>

<tr>
<td>child 24866</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/064d247285aaf55f3dcbdd999d5c36ae7a809cbf">064d247285aaf55f3dcbdd999d5c36ae7a809cbf</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=630fc01f8e33b9dc4fe8831c8038e534ade67314">14956</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Mon, 01 Oct 2018 16:56:51 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@630fc01f8e33 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=630fc01f8e33b9dc4fe8831c8038e534ade67314">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=630fc01f8e33b9dc4fe8831c8038e534ade67314&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=630fc01f8e33b9dc4fe8831c8038e534ade67314&newProject=comm-central&newRevision=630fc01f8e33b9dc4fe8831c8038e534ade67314&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=630fc01f8e33b9dc4fe8831c8038e534ade67314&newProject=comm-central&newRevision=630fc01f8e33b9dc4fe8831c8038e534ade67314&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=630fc01f8e33b9dc4fe8831c8038e534ade67314&newProject=comm-central&newRevision=630fc01f8e33b9dc4fe8831c8038e534ade67314&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28philipp%29&revcount=50">philipp</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1487008">1487008</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1487008">Bug 1487008</a> - Toolbar buttons WebExtensions API. r=philipp</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/common/src/extensionSupport.jsm">common/src/extensionSupport.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/common/src/extensionSupport.jsm">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/common/src/extensionSupport.jsm">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/common/src/extensionSupport.jsm">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/common/src/extensionSupport.jsm">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/common/src/extensionSupport.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/base/content/messenger.css">mail/base/content/messenger.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/base/content/messenger.css">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/base/content/messenger.css">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/base/content/messenger.css">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/base/content/messenger.css">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/base/content/messenger.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/compose/content/messengercompose.xul">mail/components/compose/content/messengercompose.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/compose/content/messengercompose.xul">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/compose/content/messengercompose.xul">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/compose/content/messengercompose.xul">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/compose/content/messengercompose.xul">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/compose/content/messengercompose.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionPopups.jsm">mail/components/extensions/ExtensionPopups.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionPopups.jsm">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionPopups.jsm">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionPopups.jsm">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionPopups.jsm">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionPopups.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionToolbarButtons.jsm">mail/components/extensions/ExtensionToolbarButtons.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionToolbarButtons.jsm">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionToolbarButtons.jsm">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionToolbarButtons.jsm">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionToolbarButtons.jsm">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ExtensionToolbarButtons.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ext-mail.json">mail/components/extensions/ext-mail.json</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ext-mail.json">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ext-mail.json">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ext-mail.json">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ext-mail.json">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/ext-mail.json">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/extension.svg">mail/components/extensions/extension.svg</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/extension.svg">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/extension.svg">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/extension.svg">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/extension.svg">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/extension.svg">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/jar.mn">mail/components/extensions/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/jar.mn">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/jar.mn">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/jar.mn">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/jar.mn">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/moz.build">mail/components/extensions/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/moz.build">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/moz.build">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/moz.build">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/moz.build">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-browserAction.js">mail/components/extensions/parent/ext-browserAction.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-browserAction.js">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-browserAction.js">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-browserAction.js">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-browserAction.js">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-browserAction.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-composeAction.js">mail/components/extensions/parent/ext-composeAction.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-composeAction.js">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-composeAction.js">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-composeAction.js">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-composeAction.js">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/parent/ext-composeAction.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/browserAction.json">mail/components/extensions/schemas/browserAction.json</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/browserAction.json">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/browserAction.json">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/browserAction.json">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/browserAction.json">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/browserAction.json">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/composeAction.json">mail/components/extensions/schemas/composeAction.json</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/composeAction.json">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/composeAction.json">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/composeAction.json">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/composeAction.json">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/components/extensions/schemas/composeAction.json">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/themes/shared/mail/messengercompose.css">mail/themes/shared/mail/messengercompose.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/themes/shared/mail/messengercompose.css">file</a> |
<a href="/comm-central/annotate/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/themes/shared/mail/messengercompose.css">annotate</a> |
<a href="/comm-central/diff/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/themes/shared/mail/messengercompose.css">diff</a> |
<a href="/comm-central/comparison/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/themes/shared/mail/messengercompose.css">comparison</a> |
<a href="/comm-central/log/630fc01f8e33b9dc4fe8831c8038e534ade67314/mail/themes/shared/mail/messengercompose.css">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/common/src/extensionSupport.jsm</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/common/src/extensionSupport.jsm</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -214,16 +214,20 @@ var ExtensionSupport = {</span>
<a href="#l1.4"></a><span id="l1.4">       Services.wm.removeListener(this._windowListener);</span>
<a href="#l1.5"></a><span id="l1.5">       openWindowList.clear();</span>
<a href="#l1.6"></a><span id="l1.6">       openWindowList = undefined;</span>
<a href="#l1.7"></a><span id="l1.7">     }</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9">     return true;</span>
<a href="#l1.10"></a><span id="l1.10">   },</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+  get openWindows() {</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    return openWindowList.values();</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+  },</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+</span>
<a href="#l1.16"></a><span id="l1.16">   _windowListener: {</span>
<a href="#l1.17"></a><span id="l1.17">     // nsIWindowMediatorListener functions</span>
<a href="#l1.18"></a><span id="l1.18">     onOpenWindow(xulWindow) {</span>
<a href="#l1.19"></a><span id="l1.19">       // A new window has opened.</span>
<a href="#l1.20"></a><span id="l1.20">       let domWindow = xulWindow.docShell.domWindow;</span>
<a href="#l1.21"></a><span id="l1.21"> </span>
<a href="#l1.22"></a><span id="l1.22">       // Here we pass no caller ID, so all registered callers get notified.</span>
<a href="#l1.23"></a><span id="l1.23">       ExtensionSupport._waitForLoad(domWindow);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/messenger.css</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/messenger.css</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -548,16 +548,83 @@ preftab:root /* override :root */ {</span>
<a href="#l2.4"></a><span id="l2.4"> :root[lwthemeicons~=&quot;--freebusy-icon&quot;] #button-freebusy:-moz-lwtheme {</span>
<a href="#l2.5"></a><span id="l2.5">   list-style-image: var(--freebusy-icon) !important;</span>
<a href="#l2.6"></a><span id="l2.6"> }</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8"> :root[lwthemeicons~=&quot;--timezones-icon&quot;] #button-timezones:-moz-lwtheme {</span>
<a href="#l2.9"></a><span id="l2.9">   list-style-image: var(--timezones-icon) !important;</span>
<a href="#l2.10"></a><span id="l2.10"> }</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+/* Rules to help integrate WebExtension buttons */</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+.webextension-action &gt; .toolbarbutton-badge-stack &gt; .toolbarbutton-icon {</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+  height: 16px;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+  width: 16px;</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+}</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+@media not all and (min-resolution: 1.1dppx) {</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+  .webextension-action {</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image, inherit);</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineplus">+  }</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineplus">+  toolbar[brighttext] .webextension-action {</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image-light, inherit);</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineplus">+  }</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineplus">+</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineplus">+  toolbar:not([brighttext]) .webextension-action:-moz-lwtheme {</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image-dark, inherit);</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineplus">+  }</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+  .webextension-action[cui-areatype=&quot;menu-panel&quot;] {</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image, inherit);</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+  }</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineplus">+</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineplus">+  :root[lwt-popup-brighttext] .webextension-action[cui-areatype=&quot;menu-panel&quot;] {</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image-light, inherit);</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineplus">+  }</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineplus">+</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineplus">+  :root:not([lwt-popup-brighttext]) .webextension-action[cui-areatype=&quot;menu-panel&quot;]:-moz-lwtheme {</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image-dark, inherit);</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineplus">+  }</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineplus">+</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineplus">+  .webextension-menuitem {</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineplus">+    list-style-image: var(--webextension-menuitem-image, inherit) !important;</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineplus">+  }</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineplus">+}</span>
<a href="#l2.48"></a><span id="l2.48" class="difflineplus">+</span>
<a href="#l2.49"></a><span id="l2.49" class="difflineplus">+@media (min-resolution: 1.1dppx) {</span>
<a href="#l2.50"></a><span id="l2.50" class="difflineplus">+  .webextension-action {</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image-2x, inherit);</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineplus">+  }</span>
<a href="#l2.53"></a><span id="l2.53" class="difflineplus">+</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineplus">+  toolbar[brighttext] .webextension-action {</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image-2x-light, inherit);</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineplus">+  }</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineplus">+</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineplus">+  toolbar:not([brighttext]) .webextension-action:-moz-lwtheme {</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image-2x-dark, inherit);</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineplus">+  }</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineplus">+</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineplus">+  .webextension-action[cui-areatype=&quot;menu-panel&quot;] {</span>
<a href="#l2.63"></a><span id="l2.63" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image-2x, inherit);</span>
<a href="#l2.64"></a><span id="l2.64" class="difflineplus">+  }</span>
<a href="#l2.65"></a><span id="l2.65" class="difflineplus">+</span>
<a href="#l2.66"></a><span id="l2.66" class="difflineplus">+  :root[lwt-popup-brighttext] .webextension-action[cui-areatype=&quot;menu-panel&quot;] {</span>
<a href="#l2.67"></a><span id="l2.67" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image-2x-light, inherit);</span>
<a href="#l2.68"></a><span id="l2.68" class="difflineplus">+  }</span>
<a href="#l2.69"></a><span id="l2.69" class="difflineplus">+</span>
<a href="#l2.70"></a><span id="l2.70" class="difflineplus">+  :root:not([lwt-popup-brighttext]) .webextension-action[cui-areatype=&quot;menu-panel&quot;]:-moz-lwtheme {</span>
<a href="#l2.71"></a><span id="l2.71" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image-2x-dark, inherit);</span>
<a href="#l2.72"></a><span id="l2.72" class="difflineplus">+  }</span>
<a href="#l2.73"></a><span id="l2.73" class="difflineplus">+</span>
<a href="#l2.74"></a><span id="l2.74" class="difflineplus">+  .webextension-menuitem {</span>
<a href="#l2.75"></a><span id="l2.75" class="difflineplus">+    list-style-image: var(--webextension-menuitem-image-2x, inherit) !important;</span>
<a href="#l2.76"></a><span id="l2.76" class="difflineplus">+  }</span>
<a href="#l2.77"></a><span id="l2.77" class="difflineplus">+}</span>
<a href="#l2.78"></a><span id="l2.78" class="difflineplus">+</span>
<a href="#l2.79"></a><span id="l2.79"> /* Status bar */</span>
<a href="#l2.80"></a><span id="l2.80"> </span>
<a href="#l2.81"></a><span id="l2.81"> %ifdef XP_MACOSX</span>
<a href="#l2.82"></a><span id="l2.82"> statusbar {</span>
<a href="#l2.83"></a><span id="l2.83">   padding-right: 14px;</span>
<a href="#l2.84"></a><span id="l2.84"> }</span>
<a href="#l2.85"></a><span id="l2.85"> </span>
<a href="#l2.86"></a><span id="l2.86"> .statusbar-resizerpanel {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/components/compose/content/messengercompose.xul</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/components/compose/content/messengercompose.xul</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -565,16 +565,18 @@</span>
<a href="#l3.4"></a><span id="l3.4"> </span>
<a href="#l3.5"></a><span id="l3.5">   &lt;key id=&quot;increasefontsizekb&quot; key=&quot;&amp;incrementFontSize.key;&quot; observes=&quot;cmd_increaseFontStep&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l3.6"></a><span id="l3.6">   &lt;key key=&quot;&amp;incrementFontSize.key;&quot; observes=&quot;cmd_increaseFontStep&quot; modifiers=&quot;accel, shift&quot;/&gt;</span>
<a href="#l3.7"></a><span id="l3.7">   &lt;key key=&quot;&amp;incrementFontSize.key2;&quot; observes=&quot;cmd_increaseFontStep&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l3.8"></a><span id="l3.8"> </span>
<a href="#l3.9"></a><span id="l3.9">   &lt;key id=&quot;insertlinkkb&quot; key=&quot;&amp;insertLinkCmd2.key;&quot; observes=&quot;cmd_link&quot; modifiers=&quot;accel&quot;/&gt;</span>
<a href="#l3.10"></a><span id="l3.10"> &lt;/keyset&gt;</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+&lt;popupset id=&quot;mainPopupSet&quot;/&gt;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+</span>
<a href="#l3.14"></a><span id="l3.14"> &lt;!-- Reorder Attachments Panel --&gt;</span>
<a href="#l3.15"></a><span id="l3.15"> &lt;panel id=&quot;reorderAttachmentsPanel&quot;</span>
<a href="#l3.16"></a><span id="l3.16">        orient=&quot;vertical&quot;</span>
<a href="#l3.17"></a><span id="l3.17">        type=&quot;arrow&quot;</span>
<a href="#l3.18"></a><span id="l3.18">        flip=&quot;slide&quot;</span>
<a href="#l3.19"></a><span id="l3.19">        onpopupshowing=&quot;reorderAttachmentsPanelOnPopupShowing();&quot;</span>
<a href="#l3.20"></a><span id="l3.20">        consumeoutsideclicks=&quot;false&quot;</span>
<a href="#l3.21"></a><span id="l3.21">        noautohide=&quot;true&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1">new file mode 100644</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineminus">--- /dev/null</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineplus">+++ b/mail/components/extensions/ExtensionPopups.jsm</span>
<a href="#l4.4"></a><span id="l4.4" class="difflineat">@@ -0,0 +1,334 @@</span>
<a href="#l4.5"></a><span id="l4.5" class="difflineplus">+/* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */</span>
<a href="#l4.6"></a><span id="l4.6" class="difflineplus">+/* vim: set sts=2 sw=2 et tw=80: */</span>
<a href="#l4.7"></a><span id="l4.7" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l4.8"></a><span id="l4.8" class="difflineplus">+</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineplus">+/* This file is a much-modified copy of browser/components/extensions/ExtensionPopups.jsm. */</span>
<a href="#l4.10"></a><span id="l4.10" class="difflineplus">+</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;BasePopup&quot;, &quot;ViewPopup&quot;];</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+ChromeUtils.defineModuleGetter(this, &quot;ExtensionParent&quot;,</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+                               &quot;resource://gre/modules/ExtensionParent.jsm&quot;);</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+ChromeUtils.import(&quot;resource://gre/modules/ExtensionUtils.jsm&quot;);</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+const {</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+  DefaultWeakMap,</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+  promiseEvent,</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+} = ExtensionUtils;</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+class BasePopup {</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+  constructor(extension, viewNode, popupURL, browserStyle, fixedWidth = false, blockParser = false) {</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineplus">+    this.extension = extension;</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+    this.popupURL = popupURL;</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineplus">+    this.viewNode = viewNode;</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineplus">+    this.browserStyle = browserStyle;</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+    this.window = viewNode.ownerGlobal;</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+    this.destroyed = false;</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+    this.fixedWidth = fixedWidth;</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+    this.blockParser = blockParser;</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+    extension.callOnClose(this);</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+    this.contentReady = new Promise(resolve =&gt; {</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+      this._resolveContentReady = resolve;</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+    });</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+    this.window.addEventListener(&quot;unload&quot;, this);</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+    this.viewNode.addEventListener(&quot;popuphiding&quot;, this);</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+    this.panel.addEventListener(&quot;popuppositioned&quot;, this, {once: true, capture: true});</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+    this.browser = null;</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+    this.browserLoaded = new Promise((resolve, reject) =&gt; {</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+      this.browserLoadedDeferred = {resolve, reject};</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineplus">+    });</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineplus">+    this.browserReady = this.createBrowser(viewNode, popupURL);</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineplus">+    BasePopup.instances.get(this.window).set(extension, this);</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineplus">+  }</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineplus">+  static for(extension, window) {</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineplus">+    return BasePopup.instances.get(window).get(extension);</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineplus">+  }</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineplus">+</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineplus">+  destroy() {</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineplus">+    this.extension.forgetOnClose(this);</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineplus">+</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineplus">+    this.window.removeEventListener(&quot;unload&quot;, this);</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineplus">+</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineplus">+    this.destroyed = true;</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineplus">+    this.browserLoadedDeferred.reject(new Error(&quot;Popup destroyed&quot;));</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineplus">+    // Ignore unhandled rejections if the &quot;attach&quot; method is not called.</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineplus">+    this.browserLoaded.catch(() =&gt; {});</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineplus">+</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineplus">+    BasePopup.instances.get(this.window).delete(this.extension);</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineplus">+</span>
<a href="#l4.68"></a><span id="l4.68" class="difflineplus">+    return this.browserReady.then(() =&gt; {</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineplus">+      if (this.browser) {</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineplus">+        this.destroyBrowser(this.browser, true);</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineplus">+        this.browser.parentNode.remove();</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineplus">+      }</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineplus">+      if (this.stack) {</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineplus">+        this.stack.remove();</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineplus">+      }</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineplus">+</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineplus">+      if (this.viewNode) {</span>
<a href="#l4.78"></a><span id="l4.78" class="difflineplus">+        this.viewNode.removeEventListener(&quot;popuphiding&quot;, this);</span>
<a href="#l4.79"></a><span id="l4.79" class="difflineplus">+        delete this.viewNode.customRectGetter;</span>
<a href="#l4.80"></a><span id="l4.80" class="difflineplus">+      }</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineplus">+</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineplus">+      let {panel} = this;</span>
<a href="#l4.83"></a><span id="l4.83" class="difflineplus">+      if (panel) {</span>
<a href="#l4.84"></a><span id="l4.84" class="difflineplus">+        panel.removeEventListener(&quot;popuppositioned&quot;, this, {capture: true});</span>
<a href="#l4.85"></a><span id="l4.85" class="difflineplus">+        panel.style.removeProperty(&quot;--arrowpanel-background&quot;);</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineplus">+        panel.style.removeProperty(&quot;--arrowpanel-border-color&quot;);</span>
<a href="#l4.87"></a><span id="l4.87" class="difflineplus">+      }</span>
<a href="#l4.88"></a><span id="l4.88" class="difflineplus">+</span>
<a href="#l4.89"></a><span id="l4.89" class="difflineplus">+      this.browser = null;</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineplus">+      this.stack = null;</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineplus">+      this.viewNode = null;</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineplus">+    });</span>
<a href="#l4.93"></a><span id="l4.93" class="difflineplus">+  }</span>
<a href="#l4.94"></a><span id="l4.94" class="difflineplus">+</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineplus">+  destroyBrowser(browser, finalize = false) {</span>
<a href="#l4.96"></a><span id="l4.96" class="difflineplus">+    let mm = browser.messageManager;</span>
<a href="#l4.97"></a><span id="l4.97" class="difflineplus">+    // If the browser has already been removed from the document, because the</span>
<a href="#l4.98"></a><span id="l4.98" class="difflineplus">+    // popup was closed externally, there will be no message manager here, so</span>
<a href="#l4.99"></a><span id="l4.99" class="difflineplus">+    // just replace our receiveMessage method with a stub.</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineplus">+    if (mm) {</span>
<a href="#l4.101"></a><span id="l4.101" class="difflineplus">+      mm.removeMessageListener(&quot;DOMTitleChanged&quot;, this);</span>
<a href="#l4.102"></a><span id="l4.102" class="difflineplus">+      mm.removeMessageListener(&quot;Extension:BrowserBackgroundChanged&quot;, this);</span>
<a href="#l4.103"></a><span id="l4.103" class="difflineplus">+      mm.removeMessageListener(&quot;Extension:BrowserContentLoaded&quot;, this);</span>
<a href="#l4.104"></a><span id="l4.104" class="difflineplus">+      mm.removeMessageListener(&quot;Extension:BrowserResized&quot;, this);</span>
<a href="#l4.105"></a><span id="l4.105" class="difflineplus">+      mm.removeMessageListener(&quot;Extension:DOMWindowClose&quot;, this);</span>
<a href="#l4.106"></a><span id="l4.106" class="difflineplus">+    } else if (finalize) {</span>
<a href="#l4.107"></a><span id="l4.107" class="difflineplus">+      this.receiveMessage = () =&gt; {};</span>
<a href="#l4.108"></a><span id="l4.108" class="difflineplus">+    }</span>
<a href="#l4.109"></a><span id="l4.109" class="difflineplus">+  }</span>
<a href="#l4.110"></a><span id="l4.110" class="difflineplus">+</span>
<a href="#l4.111"></a><span id="l4.111" class="difflineplus">+  get panel() {</span>
<a href="#l4.112"></a><span id="l4.112" class="difflineplus">+    return this.viewNode;</span>
<a href="#l4.113"></a><span id="l4.113" class="difflineplus">+  }</span>
<a href="#l4.114"></a><span id="l4.114" class="difflineplus">+</span>
<a href="#l4.115"></a><span id="l4.115" class="difflineplus">+  receiveMessage({name, data}) {</span>
<a href="#l4.116"></a><span id="l4.116" class="difflineplus">+    switch (name) {</span>
<a href="#l4.117"></a><span id="l4.117" class="difflineplus">+      case &quot;DOMTitleChanged&quot;:</span>
<a href="#l4.118"></a><span id="l4.118" class="difflineplus">+        this.viewNode.setAttribute(&quot;aria-label&quot;, this.browser.contentTitle);</span>
<a href="#l4.119"></a><span id="l4.119" class="difflineplus">+        break;</span>
<a href="#l4.120"></a><span id="l4.120" class="difflineplus">+</span>
<a href="#l4.121"></a><span id="l4.121" class="difflineplus">+      case &quot;Extension:BrowserBackgroundChanged&quot;:</span>
<a href="#l4.122"></a><span id="l4.122" class="difflineplus">+        this.setBackground(data.background);</span>
<a href="#l4.123"></a><span id="l4.123" class="difflineplus">+        break;</span>
<a href="#l4.124"></a><span id="l4.124" class="difflineplus">+</span>
<a href="#l4.125"></a><span id="l4.125" class="difflineplus">+      case &quot;Extension:BrowserContentLoaded&quot;:</span>
<a href="#l4.126"></a><span id="l4.126" class="difflineplus">+        this.browserLoadedDeferred.resolve();</span>
<a href="#l4.127"></a><span id="l4.127" class="difflineplus">+        break;</span>
<a href="#l4.128"></a><span id="l4.128" class="difflineplus">+</span>
<a href="#l4.129"></a><span id="l4.129" class="difflineplus">+      case &quot;Extension:BrowserResized&quot;:</span>
<a href="#l4.130"></a><span id="l4.130" class="difflineplus">+        this._resolveContentReady();</span>
<a href="#l4.131"></a><span id="l4.131" class="difflineplus">+        if (this.ignoreResizes) {</span>
<a href="#l4.132"></a><span id="l4.132" class="difflineplus">+          this.dimensions = data;</span>
<a href="#l4.133"></a><span id="l4.133" class="difflineplus">+        } else {</span>
<a href="#l4.134"></a><span id="l4.134" class="difflineplus">+          this.resizeBrowser(data);</span>
<a href="#l4.135"></a><span id="l4.135" class="difflineplus">+        }</span>
<a href="#l4.136"></a><span id="l4.136" class="difflineplus">+        break;</span>
<a href="#l4.137"></a><span id="l4.137" class="difflineplus">+</span>
<a href="#l4.138"></a><span id="l4.138" class="difflineplus">+      case &quot;Extension:DOMWindowClose&quot;:</span>
<a href="#l4.139"></a><span id="l4.139" class="difflineplus">+        this.closePopup();</span>
<a href="#l4.140"></a><span id="l4.140" class="difflineplus">+        break;</span>
<a href="#l4.141"></a><span id="l4.141" class="difflineplus">+    }</span>
<a href="#l4.142"></a><span id="l4.142" class="difflineplus">+  }</span>
<a href="#l4.143"></a><span id="l4.143" class="difflineplus">+</span>
<a href="#l4.144"></a><span id="l4.144" class="difflineplus">+  handleEvent(event) {</span>
<a href="#l4.145"></a><span id="l4.145" class="difflineplus">+    switch (event.type) {</span>
<a href="#l4.146"></a><span id="l4.146" class="difflineplus">+      case &quot;unload&quot;:</span>
<a href="#l4.147"></a><span id="l4.147" class="difflineplus">+      case &quot;popuphiding&quot;:</span>
<a href="#l4.148"></a><span id="l4.148" class="difflineplus">+        if (!this.destroyed) {</span>
<a href="#l4.149"></a><span id="l4.149" class="difflineplus">+          this.destroy();</span>
<a href="#l4.150"></a><span id="l4.150" class="difflineplus">+        }</span>
<a href="#l4.151"></a><span id="l4.151" class="difflineplus">+        break;</span>
<a href="#l4.152"></a><span id="l4.152" class="difflineplus">+      case &quot;popuppositioned&quot;:</span>
<a href="#l4.153"></a><span id="l4.153" class="difflineplus">+        if (!this.destroyed) {</span>
<a href="#l4.154"></a><span id="l4.154" class="difflineplus">+          this.browserLoaded.then(() =&gt; {</span>
<a href="#l4.155"></a><span id="l4.155" class="difflineplus">+            if (this.destroyed) {</span>
<a href="#l4.156"></a><span id="l4.156" class="difflineplus">+              return;</span>
<a href="#l4.157"></a><span id="l4.157" class="difflineplus">+            }</span>
<a href="#l4.158"></a><span id="l4.158" class="difflineplus">+            this.browser.messageManager.sendAsyncMessage(&quot;Extension:GrabFocus&quot;, {});</span>
<a href="#l4.159"></a><span id="l4.159" class="difflineplus">+          }).catch(() =&gt; {</span>
<a href="#l4.160"></a><span id="l4.160" class="difflineplus">+            // If the panel closes too fast an exception is raised here and tests will fail.</span>
<a href="#l4.161"></a><span id="l4.161" class="difflineplus">+          });</span>
<a href="#l4.162"></a><span id="l4.162" class="difflineplus">+        }</span>
<a href="#l4.163"></a><span id="l4.163" class="difflineplus">+        break;</span>
<a href="#l4.164"></a><span id="l4.164" class="difflineplus">+    }</span>
<a href="#l4.165"></a><span id="l4.165" class="difflineplus">+  }</span>
<a href="#l4.166"></a><span id="l4.166" class="difflineplus">+</span>
<a href="#l4.167"></a><span id="l4.167" class="difflineplus">+  createBrowser(viewNode, popupURL = null) {</span>
<a href="#l4.168"></a><span id="l4.168" class="difflineplus">+    let document = viewNode.ownerDocument;</span>
<a href="#l4.169"></a><span id="l4.169" class="difflineplus">+</span>
<a href="#l4.170"></a><span id="l4.170" class="difflineplus">+    let stack = document.createXULElement(&quot;stack&quot;);</span>
<a href="#l4.171"></a><span id="l4.171" class="difflineplus">+    stack.setAttribute(&quot;class&quot;, &quot;webextension-popup-stack&quot;);</span>
<a href="#l4.172"></a><span id="l4.172" class="difflineplus">+</span>
<a href="#l4.173"></a><span id="l4.173" class="difflineplus">+    let browser = document.createXULElement(&quot;browser&quot;);</span>
<a href="#l4.174"></a><span id="l4.174" class="difflineplus">+    browser.setAttribute(&quot;type&quot;, &quot;content&quot;);</span>
<a href="#l4.175"></a><span id="l4.175" class="difflineplus">+    browser.setAttribute(&quot;disableglobalhistory&quot;, &quot;true&quot;);</span>
<a href="#l4.176"></a><span id="l4.176" class="difflineplus">+    browser.setAttribute(&quot;transparent&quot;, &quot;true&quot;);</span>
<a href="#l4.177"></a><span id="l4.177" class="difflineplus">+    browser.setAttribute(&quot;class&quot;, &quot;webextension-popup-browser&quot;);</span>
<a href="#l4.178"></a><span id="l4.178" class="difflineplus">+    browser.setAttribute(&quot;webextension-view-type&quot;, &quot;popup&quot;);</span>
<a href="#l4.179"></a><span id="l4.179" class="difflineplus">+    browser.setAttribute(&quot;tooltip&quot;, &quot;aHTMLTooltip&quot;);</span>
<a href="#l4.180"></a><span id="l4.180" class="difflineplus">+    browser.setAttribute(&quot;contextmenu&quot;, &quot;contentAreaContextMenu&quot;);</span>
<a href="#l4.181"></a><span id="l4.181" class="difflineplus">+    browser.setAttribute(&quot;autocompletepopup&quot;, &quot;PopupAutoComplete&quot;);</span>
<a href="#l4.182"></a><span id="l4.182" class="difflineplus">+    browser.setAttribute(&quot;selectmenulist&quot;, &quot;ContentSelectDropdown&quot;);</span>
<a href="#l4.183"></a><span id="l4.183" class="difflineplus">+    browser.setAttribute(&quot;selectmenuconstrained&quot;, &quot;false&quot;);</span>
<a href="#l4.184"></a><span id="l4.184" class="difflineplus">+    browser.sameProcessAsFrameLoader = this.extension.groupFrameLoader;</span>
<a href="#l4.185"></a><span id="l4.185" class="difflineplus">+</span>
<a href="#l4.186"></a><span id="l4.186" class="difflineplus">+    // We only need flex sizing for the sake of the slide-in sub-views of the</span>
<a href="#l4.187"></a><span id="l4.187" class="difflineplus">+    // main menu panel, so that the browser occupies the full width of the view,</span>
<a href="#l4.188"></a><span id="l4.188" class="difflineplus">+    // and also takes up any extra height that's available to it.</span>
<a href="#l4.189"></a><span id="l4.189" class="difflineplus">+    browser.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l4.190"></a><span id="l4.190" class="difflineplus">+    stack.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l4.191"></a><span id="l4.191" class="difflineplus">+</span>
<a href="#l4.192"></a><span id="l4.192" class="difflineplus">+    // Note: When using noautohide panels, the popup manager will add width and</span>
<a href="#l4.193"></a><span id="l4.193" class="difflineplus">+    // height attributes to the panel, breaking our resize code, if the browser</span>
<a href="#l4.194"></a><span id="l4.194" class="difflineplus">+    // starts out smaller than 30px by 10px. This isn't an issue now, but it</span>
<a href="#l4.195"></a><span id="l4.195" class="difflineplus">+    // will be if and when we popup debugging.</span>
<a href="#l4.196"></a><span id="l4.196" class="difflineplus">+</span>
<a href="#l4.197"></a><span id="l4.197" class="difflineplus">+    this.browser = browser;</span>
<a href="#l4.198"></a><span id="l4.198" class="difflineplus">+    this.stack = stack;</span>
<a href="#l4.199"></a><span id="l4.199" class="difflineplus">+</span>
<a href="#l4.200"></a><span id="l4.200" class="difflineplus">+    let readyPromise = promiseEvent(browser, &quot;load&quot;);</span>
<a href="#l4.201"></a><span id="l4.201" class="difflineplus">+</span>
<a href="#l4.202"></a><span id="l4.202" class="difflineplus">+    stack.appendChild(browser);</span>
<a href="#l4.203"></a><span id="l4.203" class="difflineplus">+    viewNode.appendChild(stack);</span>
<a href="#l4.204"></a><span id="l4.204" class="difflineplus">+</span>
<a href="#l4.205"></a><span id="l4.205" class="difflineplus">+    ExtensionParent.apiManager.emit(&quot;extension-browser-inserted&quot;, browser);</span>
<a href="#l4.206"></a><span id="l4.206" class="difflineplus">+</span>
<a href="#l4.207"></a><span id="l4.207" class="difflineplus">+    let setupBrowser = browser =&gt; {</span>
<a href="#l4.208"></a><span id="l4.208" class="difflineplus">+      let mm = browser.messageManager;</span>
<a href="#l4.209"></a><span id="l4.209" class="difflineplus">+      mm.addMessageListener(&quot;DOMTitleChanged&quot;, this);</span>
<a href="#l4.210"></a><span id="l4.210" class="difflineplus">+      mm.addMessageListener(&quot;Extension:BrowserBackgroundChanged&quot;, this);</span>
<a href="#l4.211"></a><span id="l4.211" class="difflineplus">+      mm.addMessageListener(&quot;Extension:BrowserContentLoaded&quot;, this);</span>
<a href="#l4.212"></a><span id="l4.212" class="difflineplus">+      mm.addMessageListener(&quot;Extension:BrowserResized&quot;, this);</span>
<a href="#l4.213"></a><span id="l4.213" class="difflineplus">+      mm.addMessageListener(&quot;Extension:DOMWindowClose&quot;, this, true);</span>
<a href="#l4.214"></a><span id="l4.214" class="difflineplus">+      return browser;</span>
<a href="#l4.215"></a><span id="l4.215" class="difflineplus">+    };</span>
<a href="#l4.216"></a><span id="l4.216" class="difflineplus">+</span>
<a href="#l4.217"></a><span id="l4.217" class="difflineplus">+    if (!popupURL) {</span>
<a href="#l4.218"></a><span id="l4.218" class="difflineplus">+      return setupBrowser(browser);</span>
<a href="#l4.219"></a><span id="l4.219" class="difflineplus">+    }</span>
<a href="#l4.220"></a><span id="l4.220" class="difflineplus">+</span>
<a href="#l4.221"></a><span id="l4.221" class="difflineplus">+    return readyPromise.then(() =&gt; {</span>
<a href="#l4.222"></a><span id="l4.222" class="difflineplus">+      setupBrowser(browser);</span>
<a href="#l4.223"></a><span id="l4.223" class="difflineplus">+      let mm = browser.messageManager;</span>
<a href="#l4.224"></a><span id="l4.224" class="difflineplus">+</span>
<a href="#l4.225"></a><span id="l4.225" class="difflineplus">+      // Sets the context information for context menus.</span>
<a href="#l4.226"></a><span id="l4.226" class="difflineplus">+      mm.loadFrameScript(&quot;chrome://browser/content/content.js&quot;, true, true);</span>
<a href="#l4.227"></a><span id="l4.227" class="difflineplus">+</span>
<a href="#l4.228"></a><span id="l4.228" class="difflineplus">+      mm.loadFrameScript(</span>
<a href="#l4.229"></a><span id="l4.229" class="difflineplus">+        &quot;chrome://extensions/content/ext-browser-content.js&quot;, false, true);</span>
<a href="#l4.230"></a><span id="l4.230" class="difflineplus">+</span>
<a href="#l4.231"></a><span id="l4.231" class="difflineplus">+      mm.sendAsyncMessage(&quot;Extension:InitBrowser&quot;, {</span>
<a href="#l4.232"></a><span id="l4.232" class="difflineplus">+        allowScriptsToClose: true,</span>
<a href="#l4.233"></a><span id="l4.233" class="difflineplus">+        blockParser: this.blockParser,</span>
<a href="#l4.234"></a><span id="l4.234" class="difflineplus">+        fixedWidth: this.fixedWidth,</span>
<a href="#l4.235"></a><span id="l4.235" class="difflineplus">+        maxWidth: 800,</span>
<a href="#l4.236"></a><span id="l4.236" class="difflineplus">+        maxHeight: 600,</span>
<a href="#l4.237"></a><span id="l4.237" class="difflineplus">+        stylesheets: [],</span>
<a href="#l4.238"></a><span id="l4.238" class="difflineplus">+      });</span>
<a href="#l4.239"></a><span id="l4.239" class="difflineplus">+</span>
<a href="#l4.240"></a><span id="l4.240" class="difflineplus">+      browser.loadURI(popupURL, {triggeringPrincipal: this.extension.principal});</span>
<a href="#l4.241"></a><span id="l4.241" class="difflineplus">+    });</span>
<a href="#l4.242"></a><span id="l4.242" class="difflineplus">+  }</span>
<a href="#l4.243"></a><span id="l4.243" class="difflineplus">+</span>
<a href="#l4.244"></a><span id="l4.244" class="difflineplus">+  resizeBrowser({width, height, detail}) {</span>
<a href="#l4.245"></a><span id="l4.245" class="difflineplus">+    if (this.fixedWidth) {</span>
<a href="#l4.246"></a><span id="l4.246" class="difflineplus">+      // Figure out how much extra space we have on the side of the panel</span>
<a href="#l4.247"></a><span id="l4.247" class="difflineplus">+      // opposite the arrow.</span>
<a href="#l4.248"></a><span id="l4.248" class="difflineplus">+      let side = this.panel.getAttribute(&quot;side&quot;) == &quot;top&quot; ? &quot;bottom&quot; : &quot;top&quot;;</span>
<a href="#l4.249"></a><span id="l4.249" class="difflineplus">+      let maxHeight = this.viewHeight + this.extraHeight[side];</span>
<a href="#l4.250"></a><span id="l4.250" class="difflineplus">+</span>
<a href="#l4.251"></a><span id="l4.251" class="difflineplus">+      height = Math.min(height, maxHeight);</span>
<a href="#l4.252"></a><span id="l4.252" class="difflineplus">+      this.browser.style.height = `${height}px`;</span>
<a href="#l4.253"></a><span id="l4.253" class="difflineplus">+</span>
<a href="#l4.254"></a><span id="l4.254" class="difflineplus">+      // Used by the panelmultiview code to figure out sizing without reparenting</span>
<a href="#l4.255"></a><span id="l4.255" class="difflineplus">+      // (which would destroy the browser and break us).</span>
<a href="#l4.256"></a><span id="l4.256" class="difflineplus">+      this.lastCalculatedInViewHeight = Math.max(height, this.viewHeight);</span>
<a href="#l4.257"></a><span id="l4.257" class="difflineplus">+    } else {</span>
<a href="#l4.258"></a><span id="l4.258" class="difflineplus">+      this.browser.style.width = `${width}px`;</span>
<a href="#l4.259"></a><span id="l4.259" class="difflineplus">+      this.browser.style.minWidth = `${width}px`;</span>
<a href="#l4.260"></a><span id="l4.260" class="difflineplus">+      this.browser.style.height = `${height}px`;</span>
<a href="#l4.261"></a><span id="l4.261" class="difflineplus">+      this.browser.style.minHeight = `${height}px`;</span>
<a href="#l4.262"></a><span id="l4.262" class="difflineplus">+    }</span>
<a href="#l4.263"></a><span id="l4.263" class="difflineplus">+</span>
<a href="#l4.264"></a><span id="l4.264" class="difflineplus">+    let event = new this.window.CustomEvent(&quot;WebExtPopupResized&quot;, {detail});</span>
<a href="#l4.265"></a><span id="l4.265" class="difflineplus">+    this.browser.dispatchEvent(event);</span>
<a href="#l4.266"></a><span id="l4.266" class="difflineplus">+  }</span>
<a href="#l4.267"></a><span id="l4.267" class="difflineplus">+</span>
<a href="#l4.268"></a><span id="l4.268" class="difflineplus">+  setBackground(background) {</span>
<a href="#l4.269"></a><span id="l4.269" class="difflineplus">+    // Panels inherit the applied theme (light, dark, etc) and there is a high</span>
<a href="#l4.270"></a><span id="l4.270" class="difflineplus">+    // likelihood that most extension authors will not have tested with a dark theme.</span>
<a href="#l4.271"></a><span id="l4.271" class="difflineplus">+    // If they have not set a background-color, we force it to white to ensure visibility</span>
<a href="#l4.272"></a><span id="l4.272" class="difflineplus">+    // of the extension content. Passing `null` should be treated the same as no argument,</span>
<a href="#l4.273"></a><span id="l4.273" class="difflineplus">+    // which is why we can't use default parameters here.</span>
<a href="#l4.274"></a><span id="l4.274" class="difflineplus">+    if (!background) {</span>
<a href="#l4.275"></a><span id="l4.275" class="difflineplus">+      background = &quot;#fff&quot;;</span>
<a href="#l4.276"></a><span id="l4.276" class="difflineplus">+    }</span>
<a href="#l4.277"></a><span id="l4.277" class="difflineplus">+    if (this.panel.id != &quot;widget-overflow&quot;) {</span>
<a href="#l4.278"></a><span id="l4.278" class="difflineplus">+      this.panel.style.setProperty(&quot;--arrowpanel-background&quot;, background);</span>
<a href="#l4.279"></a><span id="l4.279" class="difflineplus">+    }</span>
<a href="#l4.280"></a><span id="l4.280" class="difflineplus">+    if (background == &quot;#fff&quot;) {</span>
<a href="#l4.281"></a><span id="l4.281" class="difflineplus">+      // Set a usable default color that work with the default background-color.</span>
<a href="#l4.282"></a><span id="l4.282" class="difflineplus">+      this.panel.style.setProperty(&quot;--arrowpanel-border-color&quot;, &quot;hsla(210,4%,10%,.15)&quot;);</span>
<a href="#l4.283"></a><span id="l4.283" class="difflineplus">+    }</span>
<a href="#l4.284"></a><span id="l4.284" class="difflineplus">+    this.background = background;</span>
<a href="#l4.285"></a><span id="l4.285" class="difflineplus">+  }</span>
<a href="#l4.286"></a><span id="l4.286" class="difflineplus">+}</span>
<a href="#l4.287"></a><span id="l4.287" class="difflineplus">+</span>
<a href="#l4.288"></a><span id="l4.288" class="difflineplus">+class ViewPopup extends BasePopup {</span>
<a href="#l4.289"></a><span id="l4.289" class="difflineplus">+  constructor(extension, window, popupURL, browserStyle, fixedWidth, blockParser) {</span>
<a href="#l4.290"></a><span id="l4.290" class="difflineplus">+    let document = window.document;</span>
<a href="#l4.291"></a><span id="l4.291" class="difflineplus">+</span>
<a href="#l4.292"></a><span id="l4.292" class="difflineplus">+    let panel = document.createXULElement(&quot;panel&quot;);</span>
<a href="#l4.293"></a><span id="l4.293" class="difflineplus">+    panel.setAttribute(&quot;type&quot;, &quot;arrow&quot;);</span>
<a href="#l4.294"></a><span id="l4.294" class="difflineplus">+    document.getElementById(&quot;mainPopupSet&quot;).appendChild(panel);</span>
<a href="#l4.295"></a><span id="l4.295" class="difflineplus">+</span>
<a href="#l4.296"></a><span id="l4.296" class="difflineplus">+    super(extension, panel, popupURL, browserStyle, fixedWidth, blockParser);</span>
<a href="#l4.297"></a><span id="l4.297" class="difflineplus">+</span>
<a href="#l4.298"></a><span id="l4.298" class="difflineplus">+    this.ignoreResizes = true;</span>
<a href="#l4.299"></a><span id="l4.299" class="difflineplus">+</span>
<a href="#l4.300"></a><span id="l4.300" class="difflineplus">+    this.shown = false;</span>
<a href="#l4.301"></a><span id="l4.301" class="difflineplus">+    this.tempPanel = panel;</span>
<a href="#l4.302"></a><span id="l4.302" class="difflineplus">+    this.tempBrowser = this.browser;</span>
<a href="#l4.303"></a><span id="l4.303" class="difflineplus">+</span>
<a href="#l4.304"></a><span id="l4.304" class="difflineplus">+    this.browser.classList.add(&quot;webextension-preload-browser&quot;);</span>
<a href="#l4.305"></a><span id="l4.305" class="difflineplus">+  }</span>
<a href="#l4.306"></a><span id="l4.306" class="difflineplus">+</span>
<a href="#l4.307"></a><span id="l4.307" class="difflineplus">+  removeTempPanel() {</span>
<a href="#l4.308"></a><span id="l4.308" class="difflineplus">+    if (this.tempPanel) {</span>
<a href="#l4.309"></a><span id="l4.309" class="difflineplus">+      this.tempPanel.remove();</span>
<a href="#l4.310"></a><span id="l4.310" class="difflineplus">+      this.tempPanel = null;</span>
<a href="#l4.311"></a><span id="l4.311" class="difflineplus">+    }</span>
<a href="#l4.312"></a><span id="l4.312" class="difflineplus">+    if (this.tempBrowser) {</span>
<a href="#l4.313"></a><span id="l4.313" class="difflineplus">+      this.tempBrowser.parentNode.remove();</span>
<a href="#l4.314"></a><span id="l4.314" class="difflineplus">+      this.tempBrowser = null;</span>
<a href="#l4.315"></a><span id="l4.315" class="difflineplus">+    }</span>
<a href="#l4.316"></a><span id="l4.316" class="difflineplus">+  }</span>
<a href="#l4.317"></a><span id="l4.317" class="difflineplus">+</span>
<a href="#l4.318"></a><span id="l4.318" class="difflineplus">+  destroy() {</span>
<a href="#l4.319"></a><span id="l4.319" class="difflineplus">+    return super.destroy().then(() =&gt; {</span>
<a href="#l4.320"></a><span id="l4.320" class="difflineplus">+      this.removeTempPanel();</span>
<a href="#l4.321"></a><span id="l4.321" class="difflineplus">+    });</span>
<a href="#l4.322"></a><span id="l4.322" class="difflineplus">+  }</span>
<a href="#l4.323"></a><span id="l4.323" class="difflineplus">+</span>
<a href="#l4.324"></a><span id="l4.324" class="difflineplus">+  closePopup() {</span>
<a href="#l4.325"></a><span id="l4.325" class="difflineplus">+    if (this.shown) {</span>
<a href="#l4.326"></a><span id="l4.326" class="difflineplus">+      this.viewNode.hidePopup();</span>
<a href="#l4.327"></a><span id="l4.327" class="difflineplus">+    } else {</span>
<a href="#l4.328"></a><span id="l4.328" class="difflineplus">+      this.destroy();</span>
<a href="#l4.329"></a><span id="l4.329" class="difflineplus">+    }</span>
<a href="#l4.330"></a><span id="l4.330" class="difflineplus">+  }</span>
<a href="#l4.331"></a><span id="l4.331" class="difflineplus">+}</span>
<a href="#l4.332"></a><span id="l4.332" class="difflineplus">+</span>
<a href="#l4.333"></a><span id="l4.333" class="difflineplus">+/**</span>
<a href="#l4.334"></a><span id="l4.334" class="difflineplus">+ * A map of active popups for a given browser window.</span>
<a href="#l4.335"></a><span id="l4.335" class="difflineplus">+ *</span>
<a href="#l4.336"></a><span id="l4.336" class="difflineplus">+ * WeakMap[window -&gt; WeakMap[Extension -&gt; BasePopup]]</span>
<a href="#l4.337"></a><span id="l4.337" class="difflineplus">+ */</span>
<a href="#l4.338"></a><span id="l4.338" class="difflineplus">+BasePopup.instances = new DefaultWeakMap(() =&gt; new WeakMap());</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1">new file mode 100644</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineminus">--- /dev/null</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineplus">+++ b/mail/components/extensions/ExtensionToolbarButtons.jsm</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineat">@@ -0,0 +1,559 @@</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineplus">+/* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */</span>
<a href="#l5.6"></a><span id="l5.6" class="difflineplus">+/* vim: set sts=2 sw=2 et tw=80: */</span>
<a href="#l5.7"></a><span id="l5.7" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l5.8"></a><span id="l5.8" class="difflineplus">+</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineplus">+this.EXPORTED_SYMBOLS = [&quot;ToolbarButtonAPI&quot;];</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineplus">+</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+ChromeUtils.defineModuleGetter(this, &quot;ViewPopup&quot;, &quot;resource:///modules/ExtensionPopups.jsm&quot;);</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+ChromeUtils.defineModuleGetter(this, &quot;ExtensionSupport&quot;, &quot;resource:///modules/extensionSupport.jsm&quot;);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+ChromeUtils.import(&quot;resource://gre/modules/ExtensionCommon.jsm&quot;);</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+ChromeUtils.import(&quot;resource://gre/modules/ExtensionUtils.jsm&quot;);</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+ChromeUtils.import(&quot;resource://gre/modules/ExtensionParent.jsm&quot;);</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+const {</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+  EventManager,</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+  ExtensionAPI,</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+  makeWidgetId,</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+} = ExtensionCommon;</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+const {</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineplus">+  IconDetails,</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+  StartupCache,</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+} = ExtensionParent;</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineplus">+const {</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+  DefaultWeakMap,</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+  ExtensionError,</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+} = ExtensionUtils;</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+XPCOMUtils.defineLazyGlobalGetters(this, [&quot;InspectorUtils&quot;]);</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+var XUL_NS = &quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;;</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+var DEFAULT_ICON = &quot;chrome://messenger/content/extension.svg&quot;;</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+this.ToolbarButtonAPI = class extends ExtensionAPI {</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+  /**</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+   * Called when the extension is enabled.</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+   *</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+   * @param {String} entryName</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+   *        The name of the property in the extension manifest</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+   */</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineplus">+  async onManifestEntry(entryName) {</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineplus">+    let {extension} = this;</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineplus">+    this.paint = this.paint.bind(this);</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineplus">+    this.unpaint = this.unpaint.bind(this);</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineplus">+</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+    this.widgetId = makeWidgetId(extension.id);</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineplus">+    this.id = `${this.widgetId}-${this.manifestName}-toolbarbutton`;</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineplus">+</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineplus">+    this.eventQueue = [];</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineplus">+</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineplus">+    let options = extension.manifest[entryName];</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineplus">+    this.defaults = {</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineplus">+      enabled: true,</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineplus">+      title: options.default_title || extension.name,</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineplus">+      badgeText: &quot;&quot;,</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineplus">+      badgeBackgroundColor: null,</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineplus">+      popup: options.default_popup || &quot;&quot;,</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineplus">+    };</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineplus">+    this.globals = Object.create(this.defaults);</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineplus">+</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineplus">+    this.browserStyle = options.browser_style;</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineplus">+</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineplus">+    this.defaults.icon = await StartupCache.get(</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineplus">+      extension, [this.manifestName, &quot;default_icon&quot;],</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineplus">+      () =&gt; IconDetails.normalize({</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineplus">+        path: options.default_icon,</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineplus">+        iconType: this.manifestName,</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineplus">+        themeIcons: options.theme_icons,</span>
<a href="#l5.74"></a><span id="l5.74" class="difflineplus">+      }, extension));</span>
<a href="#l5.75"></a><span id="l5.75" class="difflineplus">+</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineplus">+    this.iconData = new DefaultWeakMap(icons =&gt; this.getIconData(icons));</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineplus">+    this.iconData.set(</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineplus">+      this.defaults.icon,</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineplus">+      await StartupCache.get(</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineplus">+        extension, [this.manifestName, &quot;default_icon_data&quot;],</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineplus">+        () =&gt; this.getIconData(this.defaults.icon)));</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineplus">+</span>
<a href="#l5.83"></a><span id="l5.83" class="difflineplus">+    ExtensionSupport.registerWindowListener(this.id, {</span>
<a href="#l5.84"></a><span id="l5.84" class="difflineplus">+      chromeURLs: this.windowURLs,</span>
<a href="#l5.85"></a><span id="l5.85" class="difflineplus">+      onLoadWindow: window =&gt; {</span>
<a href="#l5.86"></a><span id="l5.86" class="difflineplus">+        this.paint(window);</span>
<a href="#l5.87"></a><span id="l5.87" class="difflineplus">+      },</span>
<a href="#l5.88"></a><span id="l5.88" class="difflineplus">+    });</span>
<a href="#l5.89"></a><span id="l5.89" class="difflineplus">+  }</span>
<a href="#l5.90"></a><span id="l5.90" class="difflineplus">+</span>
<a href="#l5.91"></a><span id="l5.91" class="difflineplus">+  /**</span>
<a href="#l5.92"></a><span id="l5.92" class="difflineplus">+   * Called when the extension is disabled or removed.</span>
<a href="#l5.93"></a><span id="l5.93" class="difflineplus">+   *</span>
<a href="#l5.94"></a><span id="l5.94" class="difflineplus">+   * @param reason</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineplus">+   */</span>
<a href="#l5.96"></a><span id="l5.96" class="difflineplus">+  onShutdown(reason) {</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineplus">+    if (reason === &quot;APP_SHUTDOWN&quot;) {</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineplus">+      return;</span>
<a href="#l5.99"></a><span id="l5.99" class="difflineplus">+    }</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineplus">+</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineplus">+    ExtensionSupport.unregisterWindowListener(this.id);</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineplus">+    for (let window of ExtensionSupport.openWindows) {</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineplus">+      if (this.windowURLs.includes(window.location.href)) {</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineplus">+        this.unpaint(window);</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineplus">+      }</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineplus">+    }</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineplus">+  }</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineplus">+</span>
<a href="#l5.109"></a><span id="l5.109" class="difflineplus">+  /**</span>
<a href="#l5.110"></a><span id="l5.110" class="difflineplus">+   * Creates a toolbar button.</span>
<a href="#l5.111"></a><span id="l5.111" class="difflineplus">+   *</span>
<a href="#l5.112"></a><span id="l5.112" class="difflineplus">+   * @param {Window} window</span>
<a href="#l5.113"></a><span id="l5.113" class="difflineplus">+   */</span>
<a href="#l5.114"></a><span id="l5.114" class="difflineplus">+  makeButton(window) {</span>
<a href="#l5.115"></a><span id="l5.115" class="difflineplus">+    let {document} = window;</span>
<a href="#l5.116"></a><span id="l5.116" class="difflineplus">+    let button = document.createElementNS(XUL_NS, &quot;toolbarbutton&quot;);</span>
<a href="#l5.117"></a><span id="l5.117" class="difflineplus">+    button.id = this.id;</span>
<a href="#l5.118"></a><span id="l5.118" class="difflineplus">+    button.classList.add(&quot;toolbarbutton-1&quot;);</span>
<a href="#l5.119"></a><span id="l5.119" class="difflineplus">+    button.classList.add(&quot;webextension-action&quot;);</span>
<a href="#l5.120"></a><span id="l5.120" class="difflineplus">+    button.classList.add(&quot;badged-button&quot;);</span>
<a href="#l5.121"></a><span id="l5.121" class="difflineplus">+    button.setAttribute(&quot;data-extensionid&quot;, this.extension.id);</span>
<a href="#l5.122"></a><span id="l5.122" class="difflineplus">+    button.addEventListener(&quot;mousedown&quot;, this);</span>
<a href="#l5.123"></a><span id="l5.123" class="difflineplus">+    this.updateButton(button, this.globals);</span>
<a href="#l5.124"></a><span id="l5.124" class="difflineplus">+    return button;</span>
<a href="#l5.125"></a><span id="l5.125" class="difflineplus">+  }</span>
<a href="#l5.126"></a><span id="l5.126" class="difflineplus">+</span>
<a href="#l5.127"></a><span id="l5.127" class="difflineplus">+  /**</span>
<a href="#l5.128"></a><span id="l5.128" class="difflineplus">+   * Adds a toolbar button to this window.</span>
<a href="#l5.129"></a><span id="l5.129" class="difflineplus">+   *</span>
<a href="#l5.130"></a><span id="l5.130" class="difflineplus">+   * @param {Window} window</span>
<a href="#l5.131"></a><span id="l5.131" class="difflineplus">+   */</span>
<a href="#l5.132"></a><span id="l5.132" class="difflineplus">+  paint(window) {</span>
<a href="#l5.133"></a><span id="l5.133" class="difflineplus">+    let {document} = window;</span>
<a href="#l5.134"></a><span id="l5.134" class="difflineplus">+    if (document.getElementById(this.id)) {</span>
<a href="#l5.135"></a><span id="l5.135" class="difflineplus">+      return;</span>
<a href="#l5.136"></a><span id="l5.136" class="difflineplus">+    }</span>
<a href="#l5.137"></a><span id="l5.137" class="difflineplus">+</span>
<a href="#l5.138"></a><span id="l5.138" class="difflineplus">+    let toolbox = document.getElementById(this.toolboxId);</span>
<a href="#l5.139"></a><span id="l5.139" class="difflineplus">+    let toolbar = document.getElementById(this.toolbarId);</span>
<a href="#l5.140"></a><span id="l5.140" class="difflineplus">+    if (!toolbox) {</span>
<a href="#l5.141"></a><span id="l5.141" class="difflineplus">+      return;</span>
<a href="#l5.142"></a><span id="l5.142" class="difflineplus">+    }</span>
<a href="#l5.143"></a><span id="l5.143" class="difflineplus">+    let button = this.makeButton(window);</span>
<a href="#l5.144"></a><span id="l5.144" class="difflineplus">+    if (toolbox.palette) {</span>
<a href="#l5.145"></a><span id="l5.145" class="difflineplus">+      toolbox.palette.appendChild(button);</span>
<a href="#l5.146"></a><span id="l5.146" class="difflineplus">+    } else {</span>
<a href="#l5.147"></a><span id="l5.147" class="difflineplus">+      toolbar.appendChild(button);</span>
<a href="#l5.148"></a><span id="l5.148" class="difflineplus">+    }</span>
<a href="#l5.149"></a><span id="l5.149" class="difflineplus">+    let currentSet = toolbar.getAttribute(&quot;currentset&quot;).split(&quot;,&quot;);</span>
<a href="#l5.150"></a><span id="l5.150" class="difflineplus">+    if (currentSet.includes(this.id)) {</span>
<a href="#l5.151"></a><span id="l5.151" class="difflineplus">+      toolbar.currentSet = currentSet.join(&quot;,&quot;);</span>
<a href="#l5.152"></a><span id="l5.152" class="difflineplus">+    } else {</span>
<a href="#l5.153"></a><span id="l5.153" class="difflineplus">+      currentSet.push(this.id);</span>
<a href="#l5.154"></a><span id="l5.154" class="difflineplus">+      toolbar.currentSet = currentSet.join(&quot;,&quot;);</span>
<a href="#l5.155"></a><span id="l5.155" class="difflineplus">+</span>
<a href="#l5.156"></a><span id="l5.156" class="difflineplus">+      let persistAttribute = toolbar.getAttribute(&quot;persist&quot;);</span>
<a href="#l5.157"></a><span id="l5.157" class="difflineplus">+      if (persistAttribute &amp;&amp; persistAttribute.split(/\s+/).includes(&quot;currentset&quot;)) {</span>
<a href="#l5.158"></a><span id="l5.158" class="difflineplus">+        Services.xulStore.persist(toolbar, &quot;currentset&quot;);</span>
<a href="#l5.159"></a><span id="l5.159" class="difflineplus">+      }</span>
<a href="#l5.160"></a><span id="l5.160" class="difflineplus">+    }</span>
<a href="#l5.161"></a><span id="l5.161" class="difflineplus">+  }</span>
<a href="#l5.162"></a><span id="l5.162" class="difflineplus">+</span>
<a href="#l5.163"></a><span id="l5.163" class="difflineplus">+  /**</span>
<a href="#l5.164"></a><span id="l5.164" class="difflineplus">+   * Removes the toolbar button from this window.</span>
<a href="#l5.165"></a><span id="l5.165" class="difflineplus">+   *</span>
<a href="#l5.166"></a><span id="l5.166" class="difflineplus">+   * @param {Window} window</span>
<a href="#l5.167"></a><span id="l5.167" class="difflineplus">+   */</span>
<a href="#l5.168"></a><span id="l5.168" class="difflineplus">+  unpaint(window) {</span>
<a href="#l5.169"></a><span id="l5.169" class="difflineplus">+    let {document} = window;</span>
<a href="#l5.170"></a><span id="l5.170" class="difflineplus">+    let button = document.getElementById(this.id);</span>
<a href="#l5.171"></a><span id="l5.171" class="difflineplus">+    if (button) {</span>
<a href="#l5.172"></a><span id="l5.172" class="difflineplus">+      button.remove();</span>
<a href="#l5.173"></a><span id="l5.173" class="difflineplus">+    }</span>
<a href="#l5.174"></a><span id="l5.174" class="difflineplus">+  }</span>
<a href="#l5.175"></a><span id="l5.175" class="difflineplus">+</span>
<a href="#l5.176"></a><span id="l5.176" class="difflineplus">+  /**</span>
<a href="#l5.177"></a><span id="l5.177" class="difflineplus">+   * Triggers this browser action for the given window, with the same effects as</span>
<a href="#l5.178"></a><span id="l5.178" class="difflineplus">+   * if it were clicked by a user.</span>
<a href="#l5.179"></a><span id="l5.179" class="difflineplus">+   *</span>
<a href="#l5.180"></a><span id="l5.180" class="difflineplus">+   * This has no effect if the browser action is disabled for, or not</span>
<a href="#l5.181"></a><span id="l5.181" class="difflineplus">+   * present in, the given window.</span>
<a href="#l5.182"></a><span id="l5.182" class="difflineplus">+   *</span>
<a href="#l5.183"></a><span id="l5.183" class="difflineplus">+   * @param {Window} window</span>
<a href="#l5.184"></a><span id="l5.184" class="difflineplus">+   */</span>
<a href="#l5.185"></a><span id="l5.185" class="difflineplus">+  async triggerAction(window) {</span>
<a href="#l5.186"></a><span id="l5.186" class="difflineplus">+    let {document} = window;</span>
<a href="#l5.187"></a><span id="l5.187" class="difflineplus">+    let button = document.getElementById(this.id);</span>
<a href="#l5.188"></a><span id="l5.188" class="difflineplus">+    let popupURL = this.getProperty(this.globals, &quot;popup&quot;);</span>
<a href="#l5.189"></a><span id="l5.189" class="difflineplus">+    let enabled = this.getProperty(this.globals, &quot;enabled&quot;);</span>
<a href="#l5.190"></a><span id="l5.190" class="difflineplus">+</span>
<a href="#l5.191"></a><span id="l5.191" class="difflineplus">+    if (button &amp;&amp; popupURL &amp;&amp; enabled) {</span>
<a href="#l5.192"></a><span id="l5.192" class="difflineplus">+      let popup = ViewPopup.for(this.extension, window) || this.getPopup(window, popupURL);</span>
<a href="#l5.193"></a><span id="l5.193" class="difflineplus">+      popup.viewNode.openPopup(button);</span>
<a href="#l5.194"></a><span id="l5.194" class="difflineplus">+    } else {</span>
<a href="#l5.195"></a><span id="l5.195" class="difflineplus">+      this.emit(&quot;click&quot;);</span>
<a href="#l5.196"></a><span id="l5.196" class="difflineplus">+    }</span>
<a href="#l5.197"></a><span id="l5.197" class="difflineplus">+  }</span>
<a href="#l5.198"></a><span id="l5.198" class="difflineplus">+</span>
<a href="#l5.199"></a><span id="l5.199" class="difflineplus">+  /**</span>
<a href="#l5.200"></a><span id="l5.200" class="difflineplus">+   * Event listener.</span>
<a href="#l5.201"></a><span id="l5.201" class="difflineplus">+   *</span>
<a href="#l5.202"></a><span id="l5.202" class="difflineplus">+   * @param {Event} event</span>
<a href="#l5.203"></a><span id="l5.203" class="difflineplus">+   */</span>
<a href="#l5.204"></a><span id="l5.204" class="difflineplus">+  handleEvent(event) {</span>
<a href="#l5.205"></a><span id="l5.205" class="difflineplus">+    let window = event.target.ownerGlobal;</span>
<a href="#l5.206"></a><span id="l5.206" class="difflineplus">+</span>
<a href="#l5.207"></a><span id="l5.207" class="difflineplus">+    switch (event.type) {</span>
<a href="#l5.208"></a><span id="l5.208" class="difflineplus">+      case &quot;mousedown&quot;:</span>
<a href="#l5.209"></a><span id="l5.209" class="difflineplus">+        if (event.button == 0) {</span>
<a href="#l5.210"></a><span id="l5.210" class="difflineplus">+          this.triggerAction(window);</span>
<a href="#l5.211"></a><span id="l5.211" class="difflineplus">+        }</span>
<a href="#l5.212"></a><span id="l5.212" class="difflineplus">+        break;</span>
<a href="#l5.213"></a><span id="l5.213" class="difflineplus">+    }</span>
<a href="#l5.214"></a><span id="l5.214" class="difflineplus">+  }</span>
<a href="#l5.215"></a><span id="l5.215" class="difflineplus">+</span>
<a href="#l5.216"></a><span id="l5.216" class="difflineplus">+  /**</span>
<a href="#l5.217"></a><span id="l5.217" class="difflineplus">+   * Returns a potentially pre-loaded popup for the given URL in the given</span>
<a href="#l5.218"></a><span id="l5.218" class="difflineplus">+   * window. If a matching pre-load popup already exists, returns that.</span>
<a href="#l5.219"></a><span id="l5.219" class="difflineplus">+   * Otherwise, initializes a new one.</span>
<a href="#l5.220"></a><span id="l5.220" class="difflineplus">+   *</span>
<a href="#l5.221"></a><span id="l5.221" class="difflineplus">+   * If a pre-load popup exists which does not match, it is destroyed before a</span>
<a href="#l5.222"></a><span id="l5.222" class="difflineplus">+   * new one is created.</span>
<a href="#l5.223"></a><span id="l5.223" class="difflineplus">+   *</span>
<a href="#l5.224"></a><span id="l5.224" class="difflineplus">+   * @param {Window} window</span>
<a href="#l5.225"></a><span id="l5.225" class="difflineplus">+   *        The browser window in which to create the popup.</span>
<a href="#l5.226"></a><span id="l5.226" class="difflineplus">+   * @param {string} popupURL</span>
<a href="#l5.227"></a><span id="l5.227" class="difflineplus">+   *        The URL to load into the popup.</span>
<a href="#l5.228"></a><span id="l5.228" class="difflineplus">+   * @param {boolean} [blockParser = false]</span>
<a href="#l5.229"></a><span id="l5.229" class="difflineplus">+   *        True if the HTML parser should initially be blocked.</span>
<a href="#l5.230"></a><span id="l5.230" class="difflineplus">+   * @returns {ViewPopup}</span>
<a href="#l5.231"></a><span id="l5.231" class="difflineplus">+   */</span>
<a href="#l5.232"></a><span id="l5.232" class="difflineplus">+  getPopup(window, popupURL, blockParser = false) {</span>
<a href="#l5.233"></a><span id="l5.233" class="difflineplus">+    let popup = new ViewPopup(this.extension, window, popupURL, this.browserStyle, false, blockParser);</span>
<a href="#l5.234"></a><span id="l5.234" class="difflineplus">+    popup.ignoreResizes = false;</span>
<a href="#l5.235"></a><span id="l5.235" class="difflineplus">+    return popup;</span>
<a href="#l5.236"></a><span id="l5.236" class="difflineplus">+  }</span>
<a href="#l5.237"></a><span id="l5.237" class="difflineplus">+</span>
<a href="#l5.238"></a><span id="l5.238" class="difflineplus">+  /**</span>
<a href="#l5.239"></a><span id="l5.239" class="difflineplus">+   * Update the toolbar button |node| with the tab context data</span>
<a href="#l5.240"></a><span id="l5.240" class="difflineplus">+   * in |tabData|.</span>
<a href="#l5.241"></a><span id="l5.241" class="difflineplus">+   *</span>
<a href="#l5.242"></a><span id="l5.242" class="difflineplus">+   * @param {XULElement} node</span>
<a href="#l5.243"></a><span id="l5.243" class="difflineplus">+   *        XUL toolbarbutton to update</span>
<a href="#l5.244"></a><span id="l5.244" class="difflineplus">+   * @param {Object} tabData</span>
<a href="#l5.245"></a><span id="l5.245" class="difflineplus">+   *        Properties to set</span>
<a href="#l5.246"></a><span id="l5.246" class="difflineplus">+   * @param {boolean} sync</span>
<a href="#l5.247"></a><span id="l5.247" class="difflineplus">+   *        Whether to perform the update immediately</span>
<a href="#l5.248"></a><span id="l5.248" class="difflineplus">+   */</span>
<a href="#l5.249"></a><span id="l5.249" class="difflineplus">+  updateButton(node, tabData, sync = false) {</span>
<a href="#l5.250"></a><span id="l5.250" class="difflineplus">+    let title = tabData.title || this.extension.name;</span>
<a href="#l5.251"></a><span id="l5.251" class="difflineplus">+    let callback = () =&gt; {</span>
<a href="#l5.252"></a><span id="l5.252" class="difflineplus">+      node.setAttribute(&quot;tooltiptext&quot;, title);</span>
<a href="#l5.253"></a><span id="l5.253" class="difflineplus">+      node.setAttribute(&quot;label&quot;, title);</span>
<a href="#l5.254"></a><span id="l5.254" class="difflineplus">+</span>
<a href="#l5.255"></a><span id="l5.255" class="difflineplus">+      if (tabData.badgeText) {</span>
<a href="#l5.256"></a><span id="l5.256" class="difflineplus">+        node.setAttribute(&quot;badge&quot;, tabData.badgeText);</span>
<a href="#l5.257"></a><span id="l5.257" class="difflineplus">+      } else {</span>
<a href="#l5.258"></a><span id="l5.258" class="difflineplus">+        node.removeAttribute(&quot;badge&quot;);</span>
<a href="#l5.259"></a><span id="l5.259" class="difflineplus">+      }</span>
<a href="#l5.260"></a><span id="l5.260" class="difflineplus">+</span>
<a href="#l5.261"></a><span id="l5.261" class="difflineplus">+      if (tabData.enabled) {</span>
<a href="#l5.262"></a><span id="l5.262" class="difflineplus">+        node.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l5.263"></a><span id="l5.263" class="difflineplus">+      } else {</span>
<a href="#l5.264"></a><span id="l5.264" class="difflineplus">+        node.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l5.265"></a><span id="l5.265" class="difflineplus">+      }</span>
<a href="#l5.266"></a><span id="l5.266" class="difflineplus">+</span>
<a href="#l5.267"></a><span id="l5.267" class="difflineplus">+      let color = tabData.badgeBackgroundColor;</span>
<a href="#l5.268"></a><span id="l5.268" class="difflineplus">+      if (color) {</span>
<a href="#l5.269"></a><span id="l5.269" class="difflineplus">+        color = `rgba(${color[0]}, ${color[1]}, ${color[2]}, ${color[3] / 255})`;</span>
<a href="#l5.270"></a><span id="l5.270" class="difflineplus">+        node.setAttribute(&quot;badgeStyle&quot;, `background-color: ${color};`);</span>
<a href="#l5.271"></a><span id="l5.271" class="difflineplus">+      } else {</span>
<a href="#l5.272"></a><span id="l5.272" class="difflineplus">+        node.removeAttribute(&quot;badgeStyle&quot;);</span>
<a href="#l5.273"></a><span id="l5.273" class="difflineplus">+      }</span>
<a href="#l5.274"></a><span id="l5.274" class="difflineplus">+</span>
<a href="#l5.275"></a><span id="l5.275" class="difflineplus">+      let {style, legacy} = this.iconData.get(tabData.icon);</span>
<a href="#l5.276"></a><span id="l5.276" class="difflineplus">+      const LEGACY_CLASS = &quot;toolbarbutton-legacy-addon&quot;;</span>
<a href="#l5.277"></a><span id="l5.277" class="difflineplus">+      if (legacy) {</span>
<a href="#l5.278"></a><span id="l5.278" class="difflineplus">+        node.classList.add(LEGACY_CLASS);</span>
<a href="#l5.279"></a><span id="l5.279" class="difflineplus">+      } else {</span>
<a href="#l5.280"></a><span id="l5.280" class="difflineplus">+        node.classList.remove(LEGACY_CLASS);</span>
<a href="#l5.281"></a><span id="l5.281" class="difflineplus">+      }</span>
<a href="#l5.282"></a><span id="l5.282" class="difflineplus">+</span>
<a href="#l5.283"></a><span id="l5.283" class="difflineplus">+      node.setAttribute(&quot;style&quot;, style);</span>
<a href="#l5.284"></a><span id="l5.284" class="difflineplus">+    };</span>
<a href="#l5.285"></a><span id="l5.285" class="difflineplus">+    if (sync) {</span>
<a href="#l5.286"></a><span id="l5.286" class="difflineplus">+      callback();</span>
<a href="#l5.287"></a><span id="l5.287" class="difflineplus">+    } else {</span>
<a href="#l5.288"></a><span id="l5.288" class="difflineplus">+      node.ownerGlobal.requestAnimationFrame(callback);</span>
<a href="#l5.289"></a><span id="l5.289" class="difflineplus">+    }</span>
<a href="#l5.290"></a><span id="l5.290" class="difflineplus">+  }</span>
<a href="#l5.291"></a><span id="l5.291" class="difflineplus">+</span>
<a href="#l5.292"></a><span id="l5.292" class="difflineplus">+  /**</span>
<a href="#l5.293"></a><span id="l5.293" class="difflineplus">+   * Get icon properties for updating the UI.</span>
<a href="#l5.294"></a><span id="l5.294" class="difflineplus">+   *</span>
<a href="#l5.295"></a><span id="l5.295" class="difflineplus">+   * @param {Object} icons</span>
<a href="#l5.296"></a><span id="l5.296" class="difflineplus">+   *        Contains the icon information, typically the extension manifest</span>
<a href="#l5.297"></a><span id="l5.297" class="difflineplus">+   */</span>
<a href="#l5.298"></a><span id="l5.298" class="difflineplus">+  getIconData(icons) {</span>
<a href="#l5.299"></a><span id="l5.299" class="difflineplus">+    let baseSize = 16;</span>
<a href="#l5.300"></a><span id="l5.300" class="difflineplus">+    let {icon, size} = IconDetails.getPreferredIcon(icons, this.extension, baseSize);</span>
<a href="#l5.301"></a><span id="l5.301" class="difflineplus">+</span>
<a href="#l5.302"></a><span id="l5.302" class="difflineplus">+    let legacy = false;</span>
<a href="#l5.303"></a><span id="l5.303" class="difflineplus">+</span>
<a href="#l5.304"></a><span id="l5.304" class="difflineplus">+    // If the best available icon size is not divisible by 16, check if we have</span>
<a href="#l5.305"></a><span id="l5.305" class="difflineplus">+    // an 18px icon to fall back to, and trim off the padding instead.</span>
<a href="#l5.306"></a><span id="l5.306" class="difflineplus">+    if (size % 16 &amp;&amp; typeof icon === &quot;string&quot; &amp;&amp; !icon.endsWith(&quot;.svg&quot;)) {</span>
<a href="#l5.307"></a><span id="l5.307" class="difflineplus">+      let result = IconDetails.getPreferredIcon(icons, this.extension, 18);</span>
<a href="#l5.308"></a><span id="l5.308" class="difflineplus">+</span>
<a href="#l5.309"></a><span id="l5.309" class="difflineplus">+      if (result.size % 18 == 0) {</span>
<a href="#l5.310"></a><span id="l5.310" class="difflineplus">+        baseSize = 18;</span>
<a href="#l5.311"></a><span id="l5.311" class="difflineplus">+        icon = result.icon;</span>
<a href="#l5.312"></a><span id="l5.312" class="difflineplus">+        legacy = true;</span>
<a href="#l5.313"></a><span id="l5.313" class="difflineplus">+      }</span>
<a href="#l5.314"></a><span id="l5.314" class="difflineplus">+    }</span>
<a href="#l5.315"></a><span id="l5.315" class="difflineplus">+</span>
<a href="#l5.316"></a><span id="l5.316" class="difflineplus">+    let getIcon = (size, theme) =&gt; {</span>
<a href="#l5.317"></a><span id="l5.317" class="difflineplus">+      let {icon} = IconDetails.getPreferredIcon(icons, this.extension, size);</span>
<a href="#l5.318"></a><span id="l5.318" class="difflineplus">+      if (typeof icon === &quot;object&quot;) {</span>
<a href="#l5.319"></a><span id="l5.319" class="difflineplus">+        if (icon[theme] == IconDetails.DEFAULT_ICON) {</span>
<a href="#l5.320"></a><span id="l5.320" class="difflineplus">+          icon[theme] = DEFAULT_ICON;</span>
<a href="#l5.321"></a><span id="l5.321" class="difflineplus">+        }</span>
<a href="#l5.322"></a><span id="l5.322" class="difflineplus">+        return IconDetails.escapeUrl(icon[theme]);</span>
<a href="#l5.323"></a><span id="l5.323" class="difflineplus">+      }</span>
<a href="#l5.324"></a><span id="l5.324" class="difflineplus">+      if (icon == IconDetails.DEFAULT_ICON) {</span>
<a href="#l5.325"></a><span id="l5.325" class="difflineplus">+        return DEFAULT_ICON;</span>
<a href="#l5.326"></a><span id="l5.326" class="difflineplus">+      }</span>
<a href="#l5.327"></a><span id="l5.327" class="difflineplus">+      return IconDetails.escapeUrl(icon);</span>
<a href="#l5.328"></a><span id="l5.328" class="difflineplus">+    };</span>
<a href="#l5.329"></a><span id="l5.329" class="difflineplus">+</span>
<a href="#l5.330"></a><span id="l5.330" class="difflineplus">+    let getStyle = (name, size) =&gt; {</span>
<a href="#l5.331"></a><span id="l5.331" class="difflineplus">+      return `</span>
<a href="#l5.332"></a><span id="l5.332" class="difflineplus">+        --webextension-${name}: url(&quot;${getIcon(size, &quot;default&quot;)}&quot;);</span>
<a href="#l5.333"></a><span id="l5.333" class="difflineplus">+        --webextension-${name}-light: url(&quot;${getIcon(size, &quot;light&quot;)}&quot;);</span>
<a href="#l5.334"></a><span id="l5.334" class="difflineplus">+        --webextension-${name}-dark: url(&quot;${getIcon(size, &quot;dark&quot;)}&quot;);</span>
<a href="#l5.335"></a><span id="l5.335" class="difflineplus">+      `;</span>
<a href="#l5.336"></a><span id="l5.336" class="difflineplus">+    };</span>
<a href="#l5.337"></a><span id="l5.337" class="difflineplus">+</span>
<a href="#l5.338"></a><span id="l5.338" class="difflineplus">+    let style = `</span>
<a href="#l5.339"></a><span id="l5.339" class="difflineplus">+      ${getStyle(&quot;menupanel-image&quot;, 32)}</span>
<a href="#l5.340"></a><span id="l5.340" class="difflineplus">+      ${getStyle(&quot;menupanel-image-2x&quot;, 64)}</span>
<a href="#l5.341"></a><span id="l5.341" class="difflineplus">+      ${getStyle(&quot;toolbar-image&quot;, baseSize)}</span>
<a href="#l5.342"></a><span id="l5.342" class="difflineplus">+      ${getStyle(&quot;toolbar-image-2x&quot;, baseSize * 2)}</span>
<a href="#l5.343"></a><span id="l5.343" class="difflineplus">+    `;</span>
<a href="#l5.344"></a><span id="l5.344" class="difflineplus">+</span>
<a href="#l5.345"></a><span id="l5.345" class="difflineplus">+    let realIcon = getIcon(size, &quot;default&quot;);</span>
<a href="#l5.346"></a><span id="l5.346" class="difflineplus">+</span>
<a href="#l5.347"></a><span id="l5.347" class="difflineplus">+    return {style, legacy, realIcon};</span>
<a href="#l5.348"></a><span id="l5.348" class="difflineplus">+  }</span>
<a href="#l5.349"></a><span id="l5.349" class="difflineplus">+</span>
<a href="#l5.350"></a><span id="l5.350" class="difflineplus">+  /**</span>
<a href="#l5.351"></a><span id="l5.351" class="difflineplus">+   * Update the toolbar button for a given window.</span>
<a href="#l5.352"></a><span id="l5.352" class="difflineplus">+   *</span>
<a href="#l5.353"></a><span id="l5.353" class="difflineplus">+   * @param {ChromeWindow} window</span>
<a href="#l5.354"></a><span id="l5.354" class="difflineplus">+   *        Browser chrome window.</span>
<a href="#l5.355"></a><span id="l5.355" class="difflineplus">+   */</span>
<a href="#l5.356"></a><span id="l5.356" class="difflineplus">+  updateWindow(window) {</span>
<a href="#l5.357"></a><span id="l5.357" class="difflineplus">+    let button = window.document.getElementById(this.id);</span>
<a href="#l5.358"></a><span id="l5.358" class="difflineplus">+    if (button) {</span>
<a href="#l5.359"></a><span id="l5.359" class="difflineplus">+      this.updateButton(button, this.globals);</span>
<a href="#l5.360"></a><span id="l5.360" class="difflineplus">+    }</span>
<a href="#l5.361"></a><span id="l5.361" class="difflineplus">+  }</span>
<a href="#l5.362"></a><span id="l5.362" class="difflineplus">+</span>
<a href="#l5.363"></a><span id="l5.363" class="difflineplus">+  /**</span>
<a href="#l5.364"></a><span id="l5.364" class="difflineplus">+   * Update the toolbar button when the extension changes the icon, title, url, etc.</span>
<a href="#l5.365"></a><span id="l5.365" class="difflineplus">+   * If it only changes a parameter for a single tab, `target` will be that tab.</span>
<a href="#l5.366"></a><span id="l5.366" class="difflineplus">+   * If it only changes a parameter for a single window, `target` will be that window.</span>
<a href="#l5.367"></a><span id="l5.367" class="difflineplus">+   * Otherwise `target` will be null.</span>
<a href="#l5.368"></a><span id="l5.368" class="difflineplus">+   *</span>
<a href="#l5.369"></a><span id="l5.369" class="difflineplus">+   * @param {XULElement|ChromeWindow|null} target</span>
<a href="#l5.370"></a><span id="l5.370" class="difflineplus">+   *        Browser tab or browser chrome window, may be null.</span>
<a href="#l5.371"></a><span id="l5.371" class="difflineplus">+   */</span>
<a href="#l5.372"></a><span id="l5.372" class="difflineplus">+  updateOnChange(target) {</span>
<a href="#l5.373"></a><span id="l5.373" class="difflineplus">+    if (target) {</span>
<a href="#l5.374"></a><span id="l5.374" class="difflineplus">+      let window = target.ownerGlobal;</span>
<a href="#l5.375"></a><span id="l5.375" class="difflineplus">+      if (target === window || target.selected) {</span>
<a href="#l5.376"></a><span id="l5.376" class="difflineplus">+        this.updateWindow(window);</span>
<a href="#l5.377"></a><span id="l5.377" class="difflineplus">+      }</span>
<a href="#l5.378"></a><span id="l5.378" class="difflineplus">+    } else {</span>
<a href="#l5.379"></a><span id="l5.379" class="difflineplus">+      for (let window of ExtensionSupport.openWindows) {</span>
<a href="#l5.380"></a><span id="l5.380" class="difflineplus">+        if (this.windowURLs.includes(window.location.href)) {</span>
<a href="#l5.381"></a><span id="l5.381" class="difflineplus">+          this.updateWindow(window);</span>
<a href="#l5.382"></a><span id="l5.382" class="difflineplus">+        }</span>
<a href="#l5.383"></a><span id="l5.383" class="difflineplus">+      }</span>
<a href="#l5.384"></a><span id="l5.384" class="difflineplus">+    }</span>
<a href="#l5.385"></a><span id="l5.385" class="difflineplus">+  }</span>
<a href="#l5.386"></a><span id="l5.386" class="difflineplus">+</span>
<a href="#l5.387"></a><span id="l5.387" class="difflineplus">+  /**</span>
<a href="#l5.388"></a><span id="l5.388" class="difflineplus">+   * Gets the target object and its associated values corresponding to</span>
<a href="#l5.389"></a><span id="l5.389" class="difflineplus">+   * the `details` parameter of the various get* and set* API methods.</span>
<a href="#l5.390"></a><span id="l5.390" class="difflineplus">+   *</span>
<a href="#l5.391"></a><span id="l5.391" class="difflineplus">+   * @param {Object} details</span>
<a href="#l5.392"></a><span id="l5.392" class="difflineplus">+   *        An object with optional `tabId` or `windowId` properties.</span>
<a href="#l5.393"></a><span id="l5.393" class="difflineplus">+   * @throws if both `tabId` and `windowId` are specified, or if they are invalid.</span>
<a href="#l5.394"></a><span id="l5.394" class="difflineplus">+   * @returns {Object}</span>
<a href="#l5.395"></a><span id="l5.395" class="difflineplus">+   *        An object with two properties: `target` and `values`.</span>
<a href="#l5.396"></a><span id="l5.396" class="difflineplus">+   *        - If a `tabId` was specified, `target` will be the corresponding</span>
<a href="#l5.397"></a><span id="l5.397" class="difflineplus">+   *          XULElement tab. If a `windowId` was specified, `target` will be</span>
<a href="#l5.398"></a><span id="l5.398" class="difflineplus">+   *          the corresponding ChromeWindow. Otherwise it will be `null`.</span>
<a href="#l5.399"></a><span id="l5.399" class="difflineplus">+   *        - `values` will contain the icon, title, badge, etc. associated with</span>
<a href="#l5.400"></a><span id="l5.400" class="difflineplus">+   *          the target.</span>
<a href="#l5.401"></a><span id="l5.401" class="difflineplus">+   */</span>
<a href="#l5.402"></a><span id="l5.402" class="difflineplus">+  getContextData({tabId, windowId}) {</span>
<a href="#l5.403"></a><span id="l5.403" class="difflineplus">+    if (tabId != null &amp;&amp; windowId != null) {</span>
<a href="#l5.404"></a><span id="l5.404" class="difflineplus">+      throw new ExtensionError(&quot;Only one of tabId and windowId can be specified.&quot;);</span>
<a href="#l5.405"></a><span id="l5.405" class="difflineplus">+    }</span>
<a href="#l5.406"></a><span id="l5.406" class="difflineplus">+    let target, values;</span>
<a href="#l5.407"></a><span id="l5.407" class="difflineplus">+    // if (tabId != null) {</span>
<a href="#l5.408"></a><span id="l5.408" class="difflineplus">+    //   target = tabTracker.getTab(tabId);</span>
<a href="#l5.409"></a><span id="l5.409" class="difflineplus">+    //   values = this.tabContext.get(target);</span>
<a href="#l5.410"></a><span id="l5.410" class="difflineplus">+    // } else if (windowId != null) {</span>
<a href="#l5.411"></a><span id="l5.411" class="difflineplus">+    //   target = windowTracker.getWindow(windowId);</span>
<a href="#l5.412"></a><span id="l5.412" class="difflineplus">+    //   values = this.tabContext.get(target);</span>
<a href="#l5.413"></a><span id="l5.413" class="difflineplus">+    // } else {</span>
<a href="#l5.414"></a><span id="l5.414" class="difflineplus">+      target = null;</span>
<a href="#l5.415"></a><span id="l5.415" class="difflineplus">+      values = this.globals;</span>
<a href="#l5.416"></a><span id="l5.416" class="difflineplus">+    // }</span>
<a href="#l5.417"></a><span id="l5.417" class="difflineplus">+    return {target, values};</span>
<a href="#l5.418"></a><span id="l5.418" class="difflineplus">+  }</span>
<a href="#l5.419"></a><span id="l5.419" class="difflineplus">+</span>
<a href="#l5.420"></a><span id="l5.420" class="difflineplus">+  /**</span>
<a href="#l5.421"></a><span id="l5.421" class="difflineplus">+   * Set a global, window specific or tab specific property.</span>
<a href="#l5.422"></a><span id="l5.422" class="difflineplus">+   *</span>
<a href="#l5.423"></a><span id="l5.423" class="difflineplus">+   * @param {Object} details</span>
<a href="#l5.424"></a><span id="l5.424" class="difflineplus">+   *        An object with optional `tabId` or `windowId` properties.</span>
<a href="#l5.425"></a><span id="l5.425" class="difflineplus">+   * @param {string} prop</span>
<a href="#l5.426"></a><span id="l5.426" class="difflineplus">+   *        String property to set. Should should be one of &quot;icon&quot;, &quot;title&quot;,</span>
<a href="#l5.427"></a><span id="l5.427" class="difflineplus">+   *        &quot;badgeText&quot;, &quot;popup&quot;, &quot;badgeBackgroundColor&quot; or &quot;enabled&quot;.</span>
<a href="#l5.428"></a><span id="l5.428" class="difflineplus">+   * @param {string} value</span>
<a href="#l5.429"></a><span id="l5.429" class="difflineplus">+   *        Value for prop.</span>
<a href="#l5.430"></a><span id="l5.430" class="difflineplus">+   */</span>
<a href="#l5.431"></a><span id="l5.431" class="difflineplus">+  setProperty(details, prop, value) {</span>
<a href="#l5.432"></a><span id="l5.432" class="difflineplus">+    let {target, values} = this.getContextData(details);</span>
<a href="#l5.433"></a><span id="l5.433" class="difflineplus">+    if (value === null) {</span>
<a href="#l5.434"></a><span id="l5.434" class="difflineplus">+      delete values[prop];</span>
<a href="#l5.435"></a><span id="l5.435" class="difflineplus">+    } else {</span>
<a href="#l5.436"></a><span id="l5.436" class="difflineplus">+      values[prop] = value;</span>
<a href="#l5.437"></a><span id="l5.437" class="difflineplus">+    }</span>
<a href="#l5.438"></a><span id="l5.438" class="difflineplus">+</span>
<a href="#l5.439"></a><span id="l5.439" class="difflineplus">+    this.updateOnChange(target);</span>
<a href="#l5.440"></a><span id="l5.440" class="difflineplus">+  }</span>
<a href="#l5.441"></a><span id="l5.441" class="difflineplus">+</span>
<a href="#l5.442"></a><span id="l5.442" class="difflineplus">+  /**</span>
<a href="#l5.443"></a><span id="l5.443" class="difflineplus">+   * Retrieve the value of a global, window specific or tab specific property.</span>
<a href="#l5.444"></a><span id="l5.444" class="difflineplus">+   *</span>
<a href="#l5.445"></a><span id="l5.445" class="difflineplus">+   * @param {Object} details</span>
<a href="#l5.446"></a><span id="l5.446" class="difflineplus">+   *        An object with optional `tabId` or `windowId` properties.</span>
<a href="#l5.447"></a><span id="l5.447" class="difflineplus">+   * @param {string} prop</span>
<a href="#l5.448"></a><span id="l5.448" class="difflineplus">+   *        String property to retrieve. Should should be one of &quot;icon&quot;, &quot;title&quot;,</span>
<a href="#l5.449"></a><span id="l5.449" class="difflineplus">+   *        &quot;badgeText&quot;, &quot;popup&quot;, &quot;badgeBackgroundColor&quot; or &quot;enabled&quot;.</span>
<a href="#l5.450"></a><span id="l5.450" class="difflineplus">+   * @returns {string} value</span>
<a href="#l5.451"></a><span id="l5.451" class="difflineplus">+   *          Value of prop.</span>
<a href="#l5.452"></a><span id="l5.452" class="difflineplus">+   */</span>
<a href="#l5.453"></a><span id="l5.453" class="difflineplus">+  getProperty(details, prop) {</span>
<a href="#l5.454"></a><span id="l5.454" class="difflineplus">+    return this.getContextData(details).values[prop];</span>
<a href="#l5.455"></a><span id="l5.455" class="difflineplus">+  }</span>
<a href="#l5.456"></a><span id="l5.456" class="difflineplus">+</span>
<a href="#l5.457"></a><span id="l5.457" class="difflineplus">+  /**</span>
<a href="#l5.458"></a><span id="l5.458" class="difflineplus">+   * WebExtension API.</span>
<a href="#l5.459"></a><span id="l5.459" class="difflineplus">+   *</span>
<a href="#l5.460"></a><span id="l5.460" class="difflineplus">+   * @param {Object} context</span>
<a href="#l5.461"></a><span id="l5.461" class="difflineplus">+   */</span>
<a href="#l5.462"></a><span id="l5.462" class="difflineplus">+  getAPI(context) {</span>
<a href="#l5.463"></a><span id="l5.463" class="difflineplus">+    let {extension} = context;</span>
<a href="#l5.464"></a><span id="l5.464" class="difflineplus">+</span>
<a href="#l5.465"></a><span id="l5.465" class="difflineplus">+    let action = this;</span>
<a href="#l5.466"></a><span id="l5.466" class="difflineplus">+</span>
<a href="#l5.467"></a><span id="l5.467" class="difflineplus">+    return {</span>
<a href="#l5.468"></a><span id="l5.468" class="difflineplus">+      [this.manifestName]: {</span>
<a href="#l5.469"></a><span id="l5.469" class="difflineplus">+        onClicked: new EventManager({</span>
<a href="#l5.470"></a><span id="l5.470" class="difflineplus">+          context,</span>
<a href="#l5.471"></a><span id="l5.471" class="difflineplus">+          name: `${this.manifestName}.onClicked`,</span>
<a href="#l5.472"></a><span id="l5.472" class="difflineplus">+          inputHandling: true,</span>
<a href="#l5.473"></a><span id="l5.473" class="difflineplus">+          register: fire =&gt; {</span>
<a href="#l5.474"></a><span id="l5.474" class="difflineplus">+            let listener = (event, browser) =&gt; {</span>
<a href="#l5.475"></a><span id="l5.475" class="difflineplus">+              context.withPendingBrowser(browser, () =&gt; fire.sync());</span>
<a href="#l5.476"></a><span id="l5.476" class="difflineplus">+            };</span>
<a href="#l5.477"></a><span id="l5.477" class="difflineplus">+            action.on(&quot;click&quot;, listener);</span>
<a href="#l5.478"></a><span id="l5.478" class="difflineplus">+            return () =&gt; {</span>
<a href="#l5.479"></a><span id="l5.479" class="difflineplus">+              action.off(&quot;click&quot;, listener);</span>
<a href="#l5.480"></a><span id="l5.480" class="difflineplus">+            };</span>
<a href="#l5.481"></a><span id="l5.481" class="difflineplus">+          },</span>
<a href="#l5.482"></a><span id="l5.482" class="difflineplus">+        }).api(),</span>
<a href="#l5.483"></a><span id="l5.483" class="difflineplus">+</span>
<a href="#l5.484"></a><span id="l5.484" class="difflineplus">+        enable(tabId) {</span>
<a href="#l5.485"></a><span id="l5.485" class="difflineplus">+          action.setProperty({tabId}, &quot;enabled&quot;, true);</span>
<a href="#l5.486"></a><span id="l5.486" class="difflineplus">+        },</span>
<a href="#l5.487"></a><span id="l5.487" class="difflineplus">+</span>
<a href="#l5.488"></a><span id="l5.488" class="difflineplus">+        disable(tabId) {</span>
<a href="#l5.489"></a><span id="l5.489" class="difflineplus">+          action.setProperty({tabId}, &quot;enabled&quot;, false);</span>
<a href="#l5.490"></a><span id="l5.490" class="difflineplus">+        },</span>
<a href="#l5.491"></a><span id="l5.491" class="difflineplus">+</span>
<a href="#l5.492"></a><span id="l5.492" class="difflineplus">+        isEnabled(details) {</span>
<a href="#l5.493"></a><span id="l5.493" class="difflineplus">+          return action.getProperty(details, &quot;enabled&quot;);</span>
<a href="#l5.494"></a><span id="l5.494" class="difflineplus">+        },</span>
<a href="#l5.495"></a><span id="l5.495" class="difflineplus">+</span>
<a href="#l5.496"></a><span id="l5.496" class="difflineplus">+        setTitle(details) {</span>
<a href="#l5.497"></a><span id="l5.497" class="difflineplus">+          action.setProperty(details, &quot;title&quot;, details.title);</span>
<a href="#l5.498"></a><span id="l5.498" class="difflineplus">+        },</span>
<a href="#l5.499"></a><span id="l5.499" class="difflineplus">+</span>
<a href="#l5.500"></a><span id="l5.500" class="difflineplus">+        getTitle(details) {</span>
<a href="#l5.501"></a><span id="l5.501" class="difflineplus">+          return action.getProperty(details, &quot;title&quot;);</span>
<a href="#l5.502"></a><span id="l5.502" class="difflineplus">+        },</span>
<a href="#l5.503"></a><span id="l5.503" class="difflineplus">+</span>
<a href="#l5.504"></a><span id="l5.504" class="difflineplus">+        setIcon(details) {</span>
<a href="#l5.505"></a><span id="l5.505" class="difflineplus">+          details.iconType = this.manifestName;</span>
<a href="#l5.506"></a><span id="l5.506" class="difflineplus">+</span>
<a href="#l5.507"></a><span id="l5.507" class="difflineplus">+          let icon = IconDetails.normalize(details, extension, context);</span>
<a href="#l5.508"></a><span id="l5.508" class="difflineplus">+          if (!Object.keys(icon).length) {</span>
<a href="#l5.509"></a><span id="l5.509" class="difflineplus">+            icon = null;</span>
<a href="#l5.510"></a><span id="l5.510" class="difflineplus">+          }</span>
<a href="#l5.511"></a><span id="l5.511" class="difflineplus">+          action.setProperty(details, &quot;icon&quot;, icon);</span>
<a href="#l5.512"></a><span id="l5.512" class="difflineplus">+        },</span>
<a href="#l5.513"></a><span id="l5.513" class="difflineplus">+</span>
<a href="#l5.514"></a><span id="l5.514" class="difflineplus">+        setBadgeText(details) {</span>
<a href="#l5.515"></a><span id="l5.515" class="difflineplus">+          action.setProperty(details, &quot;badgeText&quot;, details.text);</span>
<a href="#l5.516"></a><span id="l5.516" class="difflineplus">+        },</span>
<a href="#l5.517"></a><span id="l5.517" class="difflineplus">+</span>
<a href="#l5.518"></a><span id="l5.518" class="difflineplus">+        getBadgeText(details) {</span>
<a href="#l5.519"></a><span id="l5.519" class="difflineplus">+          return action.getProperty(details, &quot;badgeText&quot;);</span>
<a href="#l5.520"></a><span id="l5.520" class="difflineplus">+        },</span>
<a href="#l5.521"></a><span id="l5.521" class="difflineplus">+</span>
<a href="#l5.522"></a><span id="l5.522" class="difflineplus">+        setPopup(details) {</span>
<a href="#l5.523"></a><span id="l5.523" class="difflineplus">+          // Note: Chrome resolves arguments to setIcon relative to the calling</span>
<a href="#l5.524"></a><span id="l5.524" class="difflineplus">+          // context, but resolves arguments to setPopup relative to the extension</span>
<a href="#l5.525"></a><span id="l5.525" class="difflineplus">+          // root.</span>
<a href="#l5.526"></a><span id="l5.526" class="difflineplus">+          // For internal consistency, we currently resolve both relative to the</span>
<a href="#l5.527"></a><span id="l5.527" class="difflineplus">+          // calling context.</span>
<a href="#l5.528"></a><span id="l5.528" class="difflineplus">+          let url = details.popup &amp;&amp; context.uri.resolve(details.popup);</span>
<a href="#l5.529"></a><span id="l5.529" class="difflineplus">+          if (url &amp;&amp; !context.checkLoadURL(url)) {</span>
<a href="#l5.530"></a><span id="l5.530" class="difflineplus">+            return Promise.reject({message: `Access denied for URL ${url}`});</span>
<a href="#l5.531"></a><span id="l5.531" class="difflineplus">+          }</span>
<a href="#l5.532"></a><span id="l5.532" class="difflineplus">+          action.setProperty(details, &quot;popup&quot;, url);</span>
<a href="#l5.533"></a><span id="l5.533" class="difflineplus">+          return Promise.resolve(null);</span>
<a href="#l5.534"></a><span id="l5.534" class="difflineplus">+        },</span>
<a href="#l5.535"></a><span id="l5.535" class="difflineplus">+</span>
<a href="#l5.536"></a><span id="l5.536" class="difflineplus">+        getPopup(details) {</span>
<a href="#l5.537"></a><span id="l5.537" class="difflineplus">+          return action.getProperty(details, &quot;popup&quot;);</span>
<a href="#l5.538"></a><span id="l5.538" class="difflineplus">+        },</span>
<a href="#l5.539"></a><span id="l5.539" class="difflineplus">+</span>
<a href="#l5.540"></a><span id="l5.540" class="difflineplus">+        setBadgeBackgroundColor(details) {</span>
<a href="#l5.541"></a><span id="l5.541" class="difflineplus">+          let color = details.color;</span>
<a href="#l5.542"></a><span id="l5.542" class="difflineplus">+          if (typeof color == &quot;string&quot;) {</span>
<a href="#l5.543"></a><span id="l5.543" class="difflineplus">+            let col = InspectorUtils.colorToRGBA(color);</span>
<a href="#l5.544"></a><span id="l5.544" class="difflineplus">+            if (!col) {</span>
<a href="#l5.545"></a><span id="l5.545" class="difflineplus">+              throw new ExtensionError(`Invalid badge background color: &quot;${color}&quot;`);</span>
<a href="#l5.546"></a><span id="l5.546" class="difflineplus">+            }</span>
<a href="#l5.547"></a><span id="l5.547" class="difflineplus">+            color = col &amp;&amp; [col.r, col.g, col.b, Math.round(col.a * 255)];</span>
<a href="#l5.548"></a><span id="l5.548" class="difflineplus">+          }</span>
<a href="#l5.549"></a><span id="l5.549" class="difflineplus">+          action.setProperty(details, &quot;badgeBackgroundColor&quot;, color);</span>
<a href="#l5.550"></a><span id="l5.550" class="difflineplus">+        },</span>
<a href="#l5.551"></a><span id="l5.551" class="difflineplus">+</span>
<a href="#l5.552"></a><span id="l5.552" class="difflineplus">+        getBadgeBackgroundColor(details, callback) {</span>
<a href="#l5.553"></a><span id="l5.553" class="difflineplus">+          let color = action.getProperty(details, &quot;badgeBackgroundColor&quot;);</span>
<a href="#l5.554"></a><span id="l5.554" class="difflineplus">+          return color || [0xd9, 0, 0, 255];</span>
<a href="#l5.555"></a><span id="l5.555" class="difflineplus">+        },</span>
<a href="#l5.556"></a><span id="l5.556" class="difflineplus">+</span>
<a href="#l5.557"></a><span id="l5.557" class="difflineplus">+        openPopup() {</span>
<a href="#l5.558"></a><span id="l5.558" class="difflineplus">+          throw new Error(&quot;Not implemented&quot;);</span>
<a href="#l5.559"></a><span id="l5.559" class="difflineplus">+        },</span>
<a href="#l5.560"></a><span id="l5.560" class="difflineplus">+      },</span>
<a href="#l5.561"></a><span id="l5.561" class="difflineplus">+    };</span>
<a href="#l5.562"></a><span id="l5.562" class="difflineplus">+  }</span>
<a href="#l5.563"></a><span id="l5.563" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/components/extensions/ext-mail.json</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/components/extensions/ext-mail.json</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1,9 +1,27 @@</span>
<a href="#l6.4"></a><span id="l6.4"> {</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineplus">+  &quot;browserAction&quot;: {</span>
<a href="#l6.6"></a><span id="l6.6" class="difflineplus">+    &quot;url&quot;: &quot;chrome://messenger/content/parent/ext-browserAction.js&quot;,</span>
<a href="#l6.7"></a><span id="l6.7" class="difflineplus">+    &quot;schema&quot;: &quot;chrome://messenger/content/schemas/browserAction.json&quot;,</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineplus">+    &quot;scopes&quot;: [&quot;addon_parent&quot;],</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineplus">+    &quot;manifest&quot;: [&quot;browser_action&quot;],</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineplus">+    &quot;paths&quot;: [</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineplus">+      [&quot;browserAction&quot;]</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+    ]</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+  },</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+  &quot;composeAction&quot;: {</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+    &quot;url&quot;: &quot;chrome://messenger/content/parent/ext-composeAction.js&quot;,</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+    &quot;schema&quot;: &quot;chrome://messenger/content/schemas/composeAction.json&quot;,</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+    &quot;scopes&quot;: [&quot;addon_parent&quot;],</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+    &quot;manifest&quot;: [&quot;compose_action&quot;],</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+    &quot;paths&quot;: [</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+      [&quot;composeAction&quot;]</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineplus">+    ]</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+  },</span>
<a href="#l6.23"></a><span id="l6.23">   &quot;legacy&quot;: {</span>
<a href="#l6.24"></a><span id="l6.24">     &quot;url&quot;: &quot;chrome://messenger/content/parent/ext-legacy.js&quot;,</span>
<a href="#l6.25"></a><span id="l6.25">     &quot;schema&quot;: &quot;chrome://messenger/content/schemas/legacy.json&quot;,</span>
<a href="#l6.26"></a><span id="l6.26">     &quot;scopes&quot;: [&quot;addon_parent&quot;],</span>
<a href="#l6.27"></a><span id="l6.27">     &quot;manifest&quot;: [&quot;legacy&quot;]</span>
<a href="#l6.28"></a><span id="l6.28">   },</span>
<a href="#l6.29"></a><span id="l6.29">   &quot;tabs&quot;: {</span>
<a href="#l6.30"></a><span id="l6.30">     &quot;url&quot;: &quot;chrome://messenger/content/parent/ext-tabs.js&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">new file mode 100644</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineminus">--- /dev/null</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineplus">+++ b/mail/components/extensions/extension.svg</span>
<a href="#l7.4"></a><span id="l7.4" class="difflineat">@@ -0,0 +1,19 @@</span>
<a href="#l7.5"></a><span id="l7.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<a href="#l7.6"></a><span id="l7.6" class="difflineplus">+&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l7.7"></a><span id="l7.7" class="difflineplus">+   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l7.8"></a><span id="l7.8" class="difflineplus">+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineplus">+&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineplus">+     width=&quot;64&quot; height=&quot;64&quot; viewBox=&quot;0 0 64 64&quot;&gt;</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineplus">+  &lt;defs&gt;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+    &lt;style&gt;</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+      .style-puzzle-piece {</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+        fill: url('#gradient-linear-puzzle-piece');</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+      }</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+    &lt;/style&gt;</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+    &lt;linearGradient id=&quot;gradient-linear-puzzle-piece&quot; x1=&quot;0%&quot; y1=&quot;0%&quot; x2=&quot;0%&quot; y2=&quot;100%&quot;&gt;</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+      &lt;stop offset=&quot;0%&quot; stop-color=&quot;#66cc52&quot; stop-opacity=&quot;1&quot;/&gt;</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+      &lt;stop offset=&quot;100%&quot; stop-color=&quot;#60bf4c&quot; stop-opacity=&quot;1&quot;/&gt;</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+    &lt;/linearGradient&gt;</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+  &lt;/defs&gt;</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+  &lt;path class=&quot;style-puzzle-piece&quot; d=&quot;M42,62c2.2,0,4-1.8,4-4l0-14.2c0,0,0.4-3.7,2.8-3.7c2.4,0,2.2,3.9,6.7,3.9c2.3,0,6.2-1.2,6.2-8.2 c0-7-3.9-7.9-6.2-7.9c-4.5,0-4.3,3.7-6.7,3.7c-2.4,0-2.8-3.8-2.8-3.8V22c0-2.2-1.8-4-4-4H31.5c0,0-3.4-0.6-3.4-3 c0-2.4,3.8-2.6,3.8-7.1c0-2.3-1.3-5.9-8.3-5.9s-8,3.6-8,5.9c0,4.5,3.4,4.7,3.4,7.1c0,2.4-3.4,3-3.4,3H6c-2.2,0-4,1.8-4,4l0,7.8 c0,0-0.4,6,4.4,6c3.1,0,3.2-4.1,7.3-4.1c2,0,4,1.9,4,6c0,4.2-2,6.3-4,6.3c-4,0-4.2-4.1-7.3-4.1c-4.8,0-4.4,5.8-4.4,5.8L2,58 c0,2.2,1.8,4,4,4H19c0,0,6.3,0.4,6.3-4.4c0-3.1-4-3.6-4-7.7c0-2,2.2-4.5,6.4-4.5c4.2,0,6.6,2.5,6.6,4.5c0,4-3.9,4.6-3.9,7.7 c0,4.9,6.3,4.4,6.3,4.4H42z&quot;/&gt;</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineplus">+&lt;/svg&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/components/extensions/jar.mn</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/components/extensions/jar.mn</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1,18 +1,23 @@</span>
<a href="#l8.4"></a><span id="l8.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.5"></a><span id="l8.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.6"></a><span id="l8.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8"> messenger.jar:</span>
<a href="#l8.9"></a><span id="l8.9">     content/messenger/ext-mail.json                (ext-mail.json)</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineplus">+    content/messenger/extension.svg                (extension.svg)</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+    content/messenger/parent/ext-browserAction.js  (parent/ext-browserAction.js)</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+    content/messenger/parent/ext-composeAction.js  (parent/ext-composeAction.js)</span>
<a href="#l8.14"></a><span id="l8.14">     content/messenger/parent/ext-legacy.js         (parent/ext-legacy.js)</span>
<a href="#l8.15"></a><span id="l8.15">     content/messenger/parent/ext-mail.js           (parent/ext-mail.js)</span>
<a href="#l8.16"></a><span id="l8.16">     content/messenger/parent/ext-tabs.js           (parent/ext-tabs.js)</span>
<a href="#l8.17"></a><span id="l8.17">     content/messenger/parent/ext-windows.js        (parent/ext-windows.js)</span>
<a href="#l8.18"></a><span id="l8.18"> </span>
<a href="#l8.19"></a><span id="l8.19">     content/messenger/child/ext-tabs.js            (child/ext-tabs.js)</span>
<a href="#l8.20"></a><span id="l8.20">     content/messenger/child/ext-mail.js            (child/ext-mail.js)</span>
<a href="#l8.21"></a><span id="l8.21"> </span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+    content/messenger/schemas/browserAction.json   (schemas/browserAction.json)</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+    content/messenger/schemas/composeAction.json   (schemas/composeAction.json)</span>
<a href="#l8.24"></a><span id="l8.24">     content/messenger/schemas/legacy.json   (schemas/legacy.json)</span>
<a href="#l8.25"></a><span id="l8.25">     content/messenger/schemas/tabs.json     (schemas/tabs.json)</span>
<a href="#l8.26"></a><span id="l8.26">     content/messenger/schemas/windows.json  (schemas/windows.json)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/components/extensions/moz.build</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/components/extensions/moz.build</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -1,9 +1,14 @@</span>
<a href="#l9.4"></a><span id="l9.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l9.5"></a><span id="l9.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l9.6"></a><span id="l9.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8"> EXTRA_COMPONENTS += [</span>
<a href="#l9.9"></a><span id="l9.9">     'extensions-mail.manifest',</span>
<a href="#l9.10"></a><span id="l9.10"> ]</span>
<a href="#l9.11"></a><span id="l9.11"> </span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+EXTRA_JS_MODULES += [</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    'ExtensionPopups.jsm',</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+    'ExtensionToolbarButtons.jsm',</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+]</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+</span>
<a href="#l9.17"></a><span id="l9.17"> JAR_MANIFESTS += ['jar.mn']</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">new file mode 100644</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineminus">--- /dev/null</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineplus">+++ b/mail/components/extensions/parent/ext-browserAction.js</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineat">@@ -0,0 +1,16 @@</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineplus">+/* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */</span>
<a href="#l10.6"></a><span id="l10.6" class="difflineplus">+/* vim: set sts=2 sw=2 et tw=80: */</span>
<a href="#l10.7"></a><span id="l10.7" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l10.8"></a><span id="l10.8" class="difflineplus">+</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineplus">+ChromeUtils.defineModuleGetter(this, &quot;ToolbarButtonAPI&quot;, &quot;resource:///modules/ExtensionToolbarButtons.jsm&quot;);</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineplus">+</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineplus">+this.browserAction = class extends ToolbarButtonAPI {</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+  constructor(extension) {</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+    super(extension);</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+    this.manifest_name = &quot;browser_action&quot;;</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+    this.manifestName = &quot;browserAction&quot;;</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineplus">+    this.windowURLs = [&quot;chrome://messenger/content/messenger.xul&quot;];</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineplus">+    this.toolboxId = &quot;mail-toolbox&quot;;</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineplus">+    this.toolbarId = &quot;mail-bar3&quot;;</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineplus">+  }</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">new file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- /dev/null</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ b/mail/components/extensions/parent/ext-composeAction.js</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -0,0 +1,37 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineplus">+/* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineplus">+/* vim: set sts=2 sw=2 et tw=80: */</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineplus">+&quot;use strict&quot;;</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineplus">+</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineplus">+ChromeUtils.defineModuleGetter(this, &quot;ToolbarButtonAPI&quot;, &quot;resource:///modules/ExtensionToolbarButtons.jsm&quot;);</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineplus">+</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineplus">+this.composeAction = class extends ToolbarButtonAPI {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+  constructor(extension) {</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+    super(extension);</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+    this.manifest_name = &quot;compose_action&quot;;</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+    this.manifestName = &quot;composeAction&quot;;</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+    this.windowURLs = [&quot;chrome://messenger/content/messengercompose/messengercompose.xul&quot;];</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+    let format = extension.manifest.compose_action.default_area == &quot;formattoolbar&quot;;</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineplus">+    this.toolboxId = format ? &quot;FormatToolbox&quot; : &quot;compose-toolbox&quot;;</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineplus">+    this.toolbarId = format ? &quot;FormatToolbar&quot; : &quot;composeToolbar2&quot;;</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineplus">+</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineplus">+    if (format) {</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineplus">+      this.paint = this.paintFormatToolbar;</span>
<a href="#l11.24"></a><span id="l11.24" class="difflineplus">+    }</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineplus">+  }</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineplus">+</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineplus">+  paintFormatToolbar(window) {</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+    let {document} = window;</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineplus">+    if (document.getElementById(this.id)) {</span>
<a href="#l11.30"></a><span id="l11.30" class="difflineplus">+        return;</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineplus">+    }</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineplus">+    let toolbar = document.getElementById(this.toolbarId);</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineplus">+    let button = this.makeButton(window);</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineplus">+    let before = toolbar.lastElementChild;</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineplus">+    while (before.localName == &quot;spacer&quot;) {</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineplus">+      before = before.previousElementSibling;</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineplus">+    }</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineplus">+    toolbar.insertBefore(button, before.nextElementSibling);</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineplus">+  }</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">new file mode 100644</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineminus">--- /dev/null</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineplus">+++ b/mail/components/extensions/schemas/browserAction.json</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineat">@@ -0,0 +1,417 @@</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineplus">+[</span>
<a href="#l12.6"></a><span id="l12.6" class="difflineplus">+  {</span>
<a href="#l12.7"></a><span id="l12.7" class="difflineplus">+    &quot;namespace&quot;: &quot;manifest&quot;,</span>
<a href="#l12.8"></a><span id="l12.8" class="difflineplus">+    &quot;types&quot;: [</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineplus">+      {</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineplus">+        &quot;$extend&quot;: &quot;WebExtensionManifest&quot;,</span>
<a href="#l12.11"></a><span id="l12.11" class="difflineplus">+        &quot;properties&quot;: {</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+          &quot;browser_action&quot;: {</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+            &quot;additionalProperties&quot;: { &quot;$ref&quot;: &quot;UnrecognizedProperty&quot; },</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+              &quot;default_title&quot;: {</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;,</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+                &quot;preprocess&quot;: &quot;localize&quot;</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+              },</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+              &quot;default_icon&quot;: {</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+                &quot;$ref&quot;: &quot;IconPath&quot;,</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+                &quot;optional&quot;: true</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+              },</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineplus">+              &quot;theme_icons&quot;: {</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineplus">+                &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+                &quot;minItems&quot;: 1,</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineplus">+                &quot;items&quot;: { &quot;$ref&quot;: &quot;ThemeIcons&quot; },</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineplus">+                &quot;description&quot;: &quot;Specifies icons to use for dark and light themes&quot;</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+              },</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+              &quot;default_popup&quot;: {</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;,</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+                &quot;format&quot;: &quot;relativeUrl&quot;,</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineplus">+                &quot;preprocess&quot;: &quot;localize&quot;</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineplus">+              },</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineplus">+              &quot;browser_style&quot;: {</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineplus">+                &quot;type&quot;: &quot;boolean&quot;,</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineplus">+                &quot;default&quot;: false</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineplus">+              },</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineplus">+              &quot;default_area&quot;: {</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineplus">+                &quot;description&quot;: &quot;Defines the location the browserAction will appear by default.  The default location is navbar.&quot;,</span>
<a href="#l12.45"></a><span id="l12.45" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;,</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineplus">+                &quot;enum&quot;: [],</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineplus">+                &quot;optional&quot;: true</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineplus">+              }</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineplus">+            },</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineplus">+            &quot;optional&quot;: true</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineplus">+          }</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineplus">+        }</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineplus">+      }</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+    ]</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineplus">+  },</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineplus">+  {</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+    &quot;namespace&quot;: &quot;browserAction&quot;,</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineplus">+    &quot;description&quot;: &quot;Use toolbar actions to put icons in the mail window toolbar. In addition to its icon, a toolbar action can also have a tooltip, a badge, and a popup. This namespace is called browserAction for compatibility with browser WebExtensions.&quot;,</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineplus">+    &quot;types&quot;: [</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineplus">+      {</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineplus">+        &quot;id&quot;: &quot;Details&quot;,</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineplus">+        &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineplus">+        &quot;description&quot;: &quot;Specifies to which tab or window the value should be set, or from which one it should be retrieved. If no tab nor window is specified, the global value is set or retrieved.&quot;,</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineplus">+        &quot;properties&quot;: {</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineplus">+          &quot;tabId&quot;: {</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineplus">+            &quot;type&quot;: &quot;integer&quot;,</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineplus">+            &quot;minimum&quot;: 0,</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineplus">+            &quot;description&quot;: &quot;When setting a value, it will be specific to the specified tab, and will automatically reset when the tab navigates. When getting, specifies the tab to get the value from; if there is no tab-specific value, the window one will be inherited.&quot;</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineplus">+          },</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineplus">+          &quot;windowId&quot;: {</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineplus">+            &quot;type&quot;: &quot;integer&quot;,</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineplus">+            &quot;minimum&quot;: -2,</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineplus">+            &quot;description&quot;: &quot;When setting a value, it will be specific to the specified window. When getting, specifies the window to get the value from; if there is no window-specific value, the global one will be inherited.&quot;</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineplus">+          }</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineplus">+        }</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineplus">+      },</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineplus">+      {</span>
<a href="#l12.80"></a><span id="l12.80" class="difflineplus">+        &quot;id&quot;: &quot;ColorArray&quot;,</span>
<a href="#l12.81"></a><span id="l12.81" class="difflineplus">+        &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l12.82"></a><span id="l12.82" class="difflineplus">+        &quot;items&quot;: {</span>
<a href="#l12.83"></a><span id="l12.83" class="difflineplus">+          &quot;type&quot;: &quot;integer&quot;,</span>
<a href="#l12.84"></a><span id="l12.84" class="difflineplus">+          &quot;minimum&quot;: 0,</span>
<a href="#l12.85"></a><span id="l12.85" class="difflineplus">+          &quot;maximum&quot;: 255</span>
<a href="#l12.86"></a><span id="l12.86" class="difflineplus">+        },</span>
<a href="#l12.87"></a><span id="l12.87" class="difflineplus">+        &quot;minItems&quot;: 4,</span>
<a href="#l12.88"></a><span id="l12.88" class="difflineplus">+        &quot;maxItems&quot;: 4</span>
<a href="#l12.89"></a><span id="l12.89" class="difflineplus">+      },</span>
<a href="#l12.90"></a><span id="l12.90" class="difflineplus">+      {</span>
<a href="#l12.91"></a><span id="l12.91" class="difflineplus">+        &quot;id&quot;: &quot;ImageDataType&quot;,</span>
<a href="#l12.92"></a><span id="l12.92" class="difflineplus">+        &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l12.93"></a><span id="l12.93" class="difflineplus">+        &quot;isInstanceOf&quot;: &quot;ImageData&quot;,</span>
<a href="#l12.94"></a><span id="l12.94" class="difflineplus">+        &quot;additionalProperties&quot;: { &quot;type&quot;: &quot;any&quot; },</span>
<a href="#l12.95"></a><span id="l12.95" class="difflineplus">+        &quot;postprocess&quot;: &quot;convertImageDataToURL&quot;,</span>
<a href="#l12.96"></a><span id="l12.96" class="difflineplus">+        &quot;description&quot;: &quot;Pixel data for an image. Must be an ImageData object (for example, from a &lt;code&gt;canvas&lt;/code&gt; element).&quot;</span>
<a href="#l12.97"></a><span id="l12.97" class="difflineplus">+      }</span>
<a href="#l12.98"></a><span id="l12.98" class="difflineplus">+    ],</span>
<a href="#l12.99"></a><span id="l12.99" class="difflineplus">+    &quot;functions&quot;: [</span>
<a href="#l12.100"></a><span id="l12.100" class="difflineplus">+      {</span>
<a href="#l12.101"></a><span id="l12.101" class="difflineplus">+        &quot;name&quot;: &quot;setTitle&quot;,</span>
<a href="#l12.102"></a><span id="l12.102" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.103"></a><span id="l12.103" class="difflineplus">+        &quot;description&quot;: &quot;Sets the title of the toolbar action. This shows up in the tooltip.&quot;,</span>
<a href="#l12.104"></a><span id="l12.104" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l12.105"></a><span id="l12.105" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.106"></a><span id="l12.106" class="difflineplus">+          {</span>
<a href="#l12.107"></a><span id="l12.107" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l12.108"></a><span id="l12.108" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l12.109"></a><span id="l12.109" class="difflineplus">+            &quot;$import&quot;: &quot;Details&quot;,</span>
<a href="#l12.110"></a><span id="l12.110" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l12.111"></a><span id="l12.111" class="difflineplus">+              &quot;title&quot;: {</span>
<a href="#l12.112"></a><span id="l12.112" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l12.113"></a><span id="l12.113" class="difflineplus">+                  {&quot;type&quot;: &quot;string&quot;},</span>
<a href="#l12.114"></a><span id="l12.114" class="difflineplus">+                  {&quot;type&quot;: &quot;null&quot;}</span>
<a href="#l12.115"></a><span id="l12.115" class="difflineplus">+                ],</span>
<a href="#l12.116"></a><span id="l12.116" class="difflineplus">+                &quot;description&quot;: &quot;The string the toolbar action should display when moused over.&quot;</span>
<a href="#l12.117"></a><span id="l12.117" class="difflineplus">+              }</span>
<a href="#l12.118"></a><span id="l12.118" class="difflineplus">+            }</span>
<a href="#l12.119"></a><span id="l12.119" class="difflineplus">+          },</span>
<a href="#l12.120"></a><span id="l12.120" class="difflineplus">+          {</span>
<a href="#l12.121"></a><span id="l12.121" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.122"></a><span id="l12.122" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l12.123"></a><span id="l12.123" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l12.124"></a><span id="l12.124" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l12.125"></a><span id="l12.125" class="difflineplus">+          }</span>
<a href="#l12.126"></a><span id="l12.126" class="difflineplus">+        ]</span>
<a href="#l12.127"></a><span id="l12.127" class="difflineplus">+      },</span>
<a href="#l12.128"></a><span id="l12.128" class="difflineplus">+      {</span>
<a href="#l12.129"></a><span id="l12.129" class="difflineplus">+        &quot;name&quot;: &quot;getTitle&quot;,</span>
<a href="#l12.130"></a><span id="l12.130" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.131"></a><span id="l12.131" class="difflineplus">+        &quot;description&quot;: &quot;Gets the title of the toolbar action.&quot;,</span>
<a href="#l12.132"></a><span id="l12.132" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l12.133"></a><span id="l12.133" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.134"></a><span id="l12.134" class="difflineplus">+          {</span>
<a href="#l12.135"></a><span id="l12.135" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l12.136"></a><span id="l12.136" class="difflineplus">+            &quot;$ref&quot;: &quot;Details&quot;</span>
<a href="#l12.137"></a><span id="l12.137" class="difflineplus">+          },</span>
<a href="#l12.138"></a><span id="l12.138" class="difflineplus">+          {</span>
<a href="#l12.139"></a><span id="l12.139" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.140"></a><span id="l12.140" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l12.141"></a><span id="l12.141" class="difflineplus">+            &quot;parameters&quot;: [</span>
<a href="#l12.142"></a><span id="l12.142" class="difflineplus">+              {</span>
<a href="#l12.143"></a><span id="l12.143" class="difflineplus">+                &quot;name&quot;: &quot;result&quot;,</span>
<a href="#l12.144"></a><span id="l12.144" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;</span>
<a href="#l12.145"></a><span id="l12.145" class="difflineplus">+              }</span>
<a href="#l12.146"></a><span id="l12.146" class="difflineplus">+            ]</span>
<a href="#l12.147"></a><span id="l12.147" class="difflineplus">+          }</span>
<a href="#l12.148"></a><span id="l12.148" class="difflineplus">+        ]</span>
<a href="#l12.149"></a><span id="l12.149" class="difflineplus">+      },</span>
<a href="#l12.150"></a><span id="l12.150" class="difflineplus">+      {</span>
<a href="#l12.151"></a><span id="l12.151" class="difflineplus">+        &quot;name&quot;: &quot;setIcon&quot;,</span>
<a href="#l12.152"></a><span id="l12.152" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.153"></a><span id="l12.153" class="difflineplus">+        &quot;description&quot;: &quot;Sets the icon for the toolbar action. The icon can be specified either as the path to an image file or as the pixel data from a canvas element, or as dictionary of either one of those. Either the &lt;b&gt;path&lt;/b&gt; or the &lt;b&gt;imageData&lt;/b&gt; property must be specified.&quot;,</span>
<a href="#l12.154"></a><span id="l12.154" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l12.155"></a><span id="l12.155" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.156"></a><span id="l12.156" class="difflineplus">+          {</span>
<a href="#l12.157"></a><span id="l12.157" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l12.158"></a><span id="l12.158" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l12.159"></a><span id="l12.159" class="difflineplus">+            &quot;$import&quot;: &quot;Details&quot;,</span>
<a href="#l12.160"></a><span id="l12.160" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l12.161"></a><span id="l12.161" class="difflineplus">+              &quot;imageData&quot;: {</span>
<a href="#l12.162"></a><span id="l12.162" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l12.163"></a><span id="l12.163" class="difflineplus">+                  { &quot;$ref&quot;: &quot;ImageDataType&quot; },</span>
<a href="#l12.164"></a><span id="l12.164" class="difflineplus">+                  {</span>
<a href="#l12.165"></a><span id="l12.165" class="difflineplus">+                    &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l12.166"></a><span id="l12.166" class="difflineplus">+                    &quot;patternProperties&quot;: {</span>
<a href="#l12.167"></a><span id="l12.167" class="difflineplus">+                      &quot;^[1-9]\\d*$&quot;: {&quot;$ref&quot;: &quot;ImageDataType&quot;}</span>
<a href="#l12.168"></a><span id="l12.168" class="difflineplus">+                    }</span>
<a href="#l12.169"></a><span id="l12.169" class="difflineplus">+                  }</span>
<a href="#l12.170"></a><span id="l12.170" class="difflineplus">+                ],</span>
<a href="#l12.171"></a><span id="l12.171" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l12.172"></a><span id="l12.172" class="difflineplus">+                &quot;description&quot;: &quot;Either an ImageData object or a dictionary {size -&gt; ImageData} representing icon to be set. If the icon is specified as a dictionary, the actual image to be used is chosen depending on screen's pixel density. If the number of image pixels that fit into one screen space unit equals &lt;code&gt;scale&lt;/code&gt;, then image with size &lt;code&gt;scale&lt;/code&gt; * 19 will be selected. Initially only scales 1 and 2 will be supported. At least one image must be specified. Note that 'details.imageData = foo' is equivalent to 'details.imageData = {'19': foo}'&quot;</span>
<a href="#l12.173"></a><span id="l12.173" class="difflineplus">+              },</span>
<a href="#l12.174"></a><span id="l12.174" class="difflineplus">+              &quot;path&quot;: {</span>
<a href="#l12.175"></a><span id="l12.175" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l12.176"></a><span id="l12.176" class="difflineplus">+                  { &quot;type&quot;: &quot;string&quot; },</span>
<a href="#l12.177"></a><span id="l12.177" class="difflineplus">+                  {</span>
<a href="#l12.178"></a><span id="l12.178" class="difflineplus">+                    &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l12.179"></a><span id="l12.179" class="difflineplus">+                    &quot;patternProperties&quot;: {</span>
<a href="#l12.180"></a><span id="l12.180" class="difflineplus">+                      &quot;^[1-9]\\d*$&quot;: { &quot;type&quot;: &quot;string&quot; }</span>
<a href="#l12.181"></a><span id="l12.181" class="difflineplus">+                    }</span>
<a href="#l12.182"></a><span id="l12.182" class="difflineplus">+                  }</span>
<a href="#l12.183"></a><span id="l12.183" class="difflineplus">+                ],</span>
<a href="#l12.184"></a><span id="l12.184" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l12.185"></a><span id="l12.185" class="difflineplus">+                &quot;description&quot;: &quot;Either a relative image path or a dictionary {size -&gt; relative image path} pointing to icon to be set. If the icon is specified as a dictionary, the actual image to be used is chosen depending on screen's pixel density. If the number of image pixels that fit into one screen space unit equals &lt;code&gt;scale&lt;/code&gt;, then image with size &lt;code&gt;scale&lt;/code&gt; * 19 will be selected. Initially only scales 1 and 2 will be supported. At least one image must be specified. Note that 'details.path = foo' is equivalent to 'details.imageData = {'19': foo}'&quot;</span>
<a href="#l12.186"></a><span id="l12.186" class="difflineplus">+              }</span>
<a href="#l12.187"></a><span id="l12.187" class="difflineplus">+            }</span>
<a href="#l12.188"></a><span id="l12.188" class="difflineplus">+          },</span>
<a href="#l12.189"></a><span id="l12.189" class="difflineplus">+          {</span>
<a href="#l12.190"></a><span id="l12.190" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.191"></a><span id="l12.191" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l12.192"></a><span id="l12.192" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l12.193"></a><span id="l12.193" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l12.194"></a><span id="l12.194" class="difflineplus">+          }</span>
<a href="#l12.195"></a><span id="l12.195" class="difflineplus">+        ]</span>
<a href="#l12.196"></a><span id="l12.196" class="difflineplus">+      },</span>
<a href="#l12.197"></a><span id="l12.197" class="difflineplus">+      {</span>
<a href="#l12.198"></a><span id="l12.198" class="difflineplus">+        &quot;name&quot;: &quot;setPopup&quot;,</span>
<a href="#l12.199"></a><span id="l12.199" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.200"></a><span id="l12.200" class="difflineplus">+        &quot;description&quot;: &quot;Sets the html document to be opened as a popup when the user clicks on the toolbar action's icon.&quot;,</span>
<a href="#l12.201"></a><span id="l12.201" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l12.202"></a><span id="l12.202" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.203"></a><span id="l12.203" class="difflineplus">+          {</span>
<a href="#l12.204"></a><span id="l12.204" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l12.205"></a><span id="l12.205" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l12.206"></a><span id="l12.206" class="difflineplus">+            &quot;$import&quot;: &quot;Details&quot;,</span>
<a href="#l12.207"></a><span id="l12.207" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l12.208"></a><span id="l12.208" class="difflineplus">+              &quot;popup&quot;: {</span>
<a href="#l12.209"></a><span id="l12.209" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l12.210"></a><span id="l12.210" class="difflineplus">+                  {&quot;type&quot;: &quot;string&quot;},</span>
<a href="#l12.211"></a><span id="l12.211" class="difflineplus">+                  {&quot;type&quot;: &quot;null&quot;}</span>
<a href="#l12.212"></a><span id="l12.212" class="difflineplus">+                ],</span>
<a href="#l12.213"></a><span id="l12.213" class="difflineplus">+                &quot;description&quot;: &quot;The html file to show in a popup.  If set to the empty string (''), no popup is shown.&quot;</span>
<a href="#l12.214"></a><span id="l12.214" class="difflineplus">+              }</span>
<a href="#l12.215"></a><span id="l12.215" class="difflineplus">+            }</span>
<a href="#l12.216"></a><span id="l12.216" class="difflineplus">+          },</span>
<a href="#l12.217"></a><span id="l12.217" class="difflineplus">+          {</span>
<a href="#l12.218"></a><span id="l12.218" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.219"></a><span id="l12.219" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l12.220"></a><span id="l12.220" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l12.221"></a><span id="l12.221" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l12.222"></a><span id="l12.222" class="difflineplus">+          }</span>
<a href="#l12.223"></a><span id="l12.223" class="difflineplus">+        ]</span>
<a href="#l12.224"></a><span id="l12.224" class="difflineplus">+      },</span>
<a href="#l12.225"></a><span id="l12.225" class="difflineplus">+      {</span>
<a href="#l12.226"></a><span id="l12.226" class="difflineplus">+        &quot;name&quot;: &quot;getPopup&quot;,</span>
<a href="#l12.227"></a><span id="l12.227" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.228"></a><span id="l12.228" class="difflineplus">+        &quot;description&quot;: &quot;Gets the html document set as the popup for this toolbar action.&quot;,</span>
<a href="#l12.229"></a><span id="l12.229" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l12.230"></a><span id="l12.230" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.231"></a><span id="l12.231" class="difflineplus">+          {</span>
<a href="#l12.232"></a><span id="l12.232" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l12.233"></a><span id="l12.233" class="difflineplus">+            &quot;$ref&quot;: &quot;Details&quot;</span>
<a href="#l12.234"></a><span id="l12.234" class="difflineplus">+          },</span>
<a href="#l12.235"></a><span id="l12.235" class="difflineplus">+          {</span>
<a href="#l12.236"></a><span id="l12.236" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.237"></a><span id="l12.237" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l12.238"></a><span id="l12.238" class="difflineplus">+            &quot;parameters&quot;: [</span>
<a href="#l12.239"></a><span id="l12.239" class="difflineplus">+              {</span>
<a href="#l12.240"></a><span id="l12.240" class="difflineplus">+                &quot;name&quot;: &quot;result&quot;,</span>
<a href="#l12.241"></a><span id="l12.241" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;</span>
<a href="#l12.242"></a><span id="l12.242" class="difflineplus">+              }</span>
<a href="#l12.243"></a><span id="l12.243" class="difflineplus">+            ]</span>
<a href="#l12.244"></a><span id="l12.244" class="difflineplus">+          }</span>
<a href="#l12.245"></a><span id="l12.245" class="difflineplus">+        ]</span>
<a href="#l12.246"></a><span id="l12.246" class="difflineplus">+      },</span>
<a href="#l12.247"></a><span id="l12.247" class="difflineplus">+      {</span>
<a href="#l12.248"></a><span id="l12.248" class="difflineplus">+        &quot;name&quot;: &quot;setBadgeText&quot;,</span>
<a href="#l12.249"></a><span id="l12.249" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.250"></a><span id="l12.250" class="difflineplus">+        &quot;description&quot;: &quot;Sets the badge text for the toolbar action. The badge is displayed on top of the icon.&quot;,</span>
<a href="#l12.251"></a><span id="l12.251" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l12.252"></a><span id="l12.252" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.253"></a><span id="l12.253" class="difflineplus">+          {</span>
<a href="#l12.254"></a><span id="l12.254" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l12.255"></a><span id="l12.255" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l12.256"></a><span id="l12.256" class="difflineplus">+            &quot;$import&quot;: &quot;Details&quot;,</span>
<a href="#l12.257"></a><span id="l12.257" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l12.258"></a><span id="l12.258" class="difflineplus">+              &quot;text&quot;: {</span>
<a href="#l12.259"></a><span id="l12.259" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l12.260"></a><span id="l12.260" class="difflineplus">+                  {&quot;type&quot;: &quot;string&quot;},</span>
<a href="#l12.261"></a><span id="l12.261" class="difflineplus">+                  {&quot;type&quot;: &quot;null&quot;}</span>
<a href="#l12.262"></a><span id="l12.262" class="difflineplus">+                ],</span>
<a href="#l12.263"></a><span id="l12.263" class="difflineplus">+                &quot;description&quot;: &quot;Any number of characters can be passed, but only about four can fit in the space.&quot;</span>
<a href="#l12.264"></a><span id="l12.264" class="difflineplus">+              }</span>
<a href="#l12.265"></a><span id="l12.265" class="difflineplus">+            }</span>
<a href="#l12.266"></a><span id="l12.266" class="difflineplus">+          },</span>
<a href="#l12.267"></a><span id="l12.267" class="difflineplus">+          {</span>
<a href="#l12.268"></a><span id="l12.268" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.269"></a><span id="l12.269" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l12.270"></a><span id="l12.270" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l12.271"></a><span id="l12.271" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l12.272"></a><span id="l12.272" class="difflineplus">+          }</span>
<a href="#l12.273"></a><span id="l12.273" class="difflineplus">+        ]</span>
<a href="#l12.274"></a><span id="l12.274" class="difflineplus">+      },</span>
<a href="#l12.275"></a><span id="l12.275" class="difflineplus">+      {</span>
<a href="#l12.276"></a><span id="l12.276" class="difflineplus">+        &quot;name&quot;: &quot;getBadgeText&quot;,</span>
<a href="#l12.277"></a><span id="l12.277" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.278"></a><span id="l12.278" class="difflineplus">+        &quot;description&quot;: &quot;Gets the badge text of the toolbar action. If no tab nor window is specified is specified, the global badge text is returned.&quot;,</span>
<a href="#l12.279"></a><span id="l12.279" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l12.280"></a><span id="l12.280" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.281"></a><span id="l12.281" class="difflineplus">+          {</span>
<a href="#l12.282"></a><span id="l12.282" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l12.283"></a><span id="l12.283" class="difflineplus">+            &quot;$ref&quot;: &quot;Details&quot;</span>
<a href="#l12.284"></a><span id="l12.284" class="difflineplus">+          },</span>
<a href="#l12.285"></a><span id="l12.285" class="difflineplus">+          {</span>
<a href="#l12.286"></a><span id="l12.286" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.287"></a><span id="l12.287" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l12.288"></a><span id="l12.288" class="difflineplus">+            &quot;parameters&quot;: [</span>
<a href="#l12.289"></a><span id="l12.289" class="difflineplus">+              {</span>
<a href="#l12.290"></a><span id="l12.290" class="difflineplus">+                &quot;name&quot;: &quot;result&quot;,</span>
<a href="#l12.291"></a><span id="l12.291" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;</span>
<a href="#l12.292"></a><span id="l12.292" class="difflineplus">+              }</span>
<a href="#l12.293"></a><span id="l12.293" class="difflineplus">+            ]</span>
<a href="#l12.294"></a><span id="l12.294" class="difflineplus">+          }</span>
<a href="#l12.295"></a><span id="l12.295" class="difflineplus">+        ]</span>
<a href="#l12.296"></a><span id="l12.296" class="difflineplus">+      },</span>
<a href="#l12.297"></a><span id="l12.297" class="difflineplus">+      {</span>
<a href="#l12.298"></a><span id="l12.298" class="difflineplus">+        &quot;name&quot;: &quot;setBadgeBackgroundColor&quot;,</span>
<a href="#l12.299"></a><span id="l12.299" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.300"></a><span id="l12.300" class="difflineplus">+        &quot;description&quot;: &quot;Sets the background color for the badge.&quot;,</span>
<a href="#l12.301"></a><span id="l12.301" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l12.302"></a><span id="l12.302" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.303"></a><span id="l12.303" class="difflineplus">+          {</span>
<a href="#l12.304"></a><span id="l12.304" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l12.305"></a><span id="l12.305" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l12.306"></a><span id="l12.306" class="difflineplus">+            &quot;$import&quot;: &quot;Details&quot;,</span>
<a href="#l12.307"></a><span id="l12.307" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l12.308"></a><span id="l12.308" class="difflineplus">+              &quot;color&quot;: {</span>
<a href="#l12.309"></a><span id="l12.309" class="difflineplus">+                &quot;description&quot;: &quot;An array of four integers in the range [0,255] that make up the RGBA color of the badge. For example, opaque red is &lt;code&gt;[255, 0, 0, 255]&lt;/code&gt;. Can also be a string with a CSS value, with opaque red being &lt;code&gt;#FF0000&lt;/code&gt; or &lt;code&gt;#F00&lt;/code&gt;.&quot;,</span>
<a href="#l12.310"></a><span id="l12.310" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l12.311"></a><span id="l12.311" class="difflineplus">+                  {&quot;type&quot;: &quot;string&quot;},</span>
<a href="#l12.312"></a><span id="l12.312" class="difflineplus">+                  {&quot;$ref&quot;: &quot;ColorArray&quot;},</span>
<a href="#l12.313"></a><span id="l12.313" class="difflineplus">+                  {&quot;type&quot;: &quot;null&quot;}</span>
<a href="#l12.314"></a><span id="l12.314" class="difflineplus">+                ]</span>
<a href="#l12.315"></a><span id="l12.315" class="difflineplus">+              }</span>
<a href="#l12.316"></a><span id="l12.316" class="difflineplus">+            }</span>
<a href="#l12.317"></a><span id="l12.317" class="difflineplus">+          },</span>
<a href="#l12.318"></a><span id="l12.318" class="difflineplus">+          {</span>
<a href="#l12.319"></a><span id="l12.319" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.320"></a><span id="l12.320" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l12.321"></a><span id="l12.321" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l12.322"></a><span id="l12.322" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l12.323"></a><span id="l12.323" class="difflineplus">+          }</span>
<a href="#l12.324"></a><span id="l12.324" class="difflineplus">+        ]</span>
<a href="#l12.325"></a><span id="l12.325" class="difflineplus">+      },</span>
<a href="#l12.326"></a><span id="l12.326" class="difflineplus">+      {</span>
<a href="#l12.327"></a><span id="l12.327" class="difflineplus">+        &quot;name&quot;: &quot;getBadgeBackgroundColor&quot;,</span>
<a href="#l12.328"></a><span id="l12.328" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.329"></a><span id="l12.329" class="difflineplus">+        &quot;description&quot;: &quot;Gets the background color of the toolbar action.&quot;,</span>
<a href="#l12.330"></a><span id="l12.330" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l12.331"></a><span id="l12.331" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.332"></a><span id="l12.332" class="difflineplus">+          {</span>
<a href="#l12.333"></a><span id="l12.333" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l12.334"></a><span id="l12.334" class="difflineplus">+            &quot;$ref&quot;: &quot;Details&quot;</span>
<a href="#l12.335"></a><span id="l12.335" class="difflineplus">+          },</span>
<a href="#l12.336"></a><span id="l12.336" class="difflineplus">+          {</span>
<a href="#l12.337"></a><span id="l12.337" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.338"></a><span id="l12.338" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l12.339"></a><span id="l12.339" class="difflineplus">+            &quot;parameters&quot;: [</span>
<a href="#l12.340"></a><span id="l12.340" class="difflineplus">+              {</span>
<a href="#l12.341"></a><span id="l12.341" class="difflineplus">+                &quot;name&quot;: &quot;result&quot;,</span>
<a href="#l12.342"></a><span id="l12.342" class="difflineplus">+                &quot;$ref&quot;: &quot;ColorArray&quot;</span>
<a href="#l12.343"></a><span id="l12.343" class="difflineplus">+              }</span>
<a href="#l12.344"></a><span id="l12.344" class="difflineplus">+            ]</span>
<a href="#l12.345"></a><span id="l12.345" class="difflineplus">+          }</span>
<a href="#l12.346"></a><span id="l12.346" class="difflineplus">+        ]</span>
<a href="#l12.347"></a><span id="l12.347" class="difflineplus">+      },</span>
<a href="#l12.348"></a><span id="l12.348" class="difflineplus">+      {</span>
<a href="#l12.349"></a><span id="l12.349" class="difflineplus">+        &quot;name&quot;: &quot;enable&quot;,</span>
<a href="#l12.350"></a><span id="l12.350" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.351"></a><span id="l12.351" class="difflineplus">+        &quot;description&quot;: &quot;Enables the toolbar action for a tab. By default, toolbar actions are enabled.&quot;,</span>
<a href="#l12.352"></a><span id="l12.352" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l12.353"></a><span id="l12.353" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.354"></a><span id="l12.354" class="difflineplus">+          {</span>
<a href="#l12.355"></a><span id="l12.355" class="difflineplus">+            &quot;type&quot;: &quot;integer&quot;,</span>
<a href="#l12.356"></a><span id="l12.356" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l12.357"></a><span id="l12.357" class="difflineplus">+            &quot;name&quot;: &quot;tabId&quot;,</span>
<a href="#l12.358"></a><span id="l12.358" class="difflineplus">+            &quot;minimum&quot;: 0,</span>
<a href="#l12.359"></a><span id="l12.359" class="difflineplus">+            &quot;description&quot;: &quot;The id of the tab for which you want to modify the toolbar action.&quot;</span>
<a href="#l12.360"></a><span id="l12.360" class="difflineplus">+          },</span>
<a href="#l12.361"></a><span id="l12.361" class="difflineplus">+          {</span>
<a href="#l12.362"></a><span id="l12.362" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.363"></a><span id="l12.363" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l12.364"></a><span id="l12.364" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l12.365"></a><span id="l12.365" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l12.366"></a><span id="l12.366" class="difflineplus">+          }</span>
<a href="#l12.367"></a><span id="l12.367" class="difflineplus">+        ]</span>
<a href="#l12.368"></a><span id="l12.368" class="difflineplus">+      },</span>
<a href="#l12.369"></a><span id="l12.369" class="difflineplus">+      {</span>
<a href="#l12.370"></a><span id="l12.370" class="difflineplus">+        &quot;name&quot;: &quot;disable&quot;,</span>
<a href="#l12.371"></a><span id="l12.371" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.372"></a><span id="l12.372" class="difflineplus">+        &quot;description&quot;: &quot;Disables the toolbar action for a tab.&quot;,</span>
<a href="#l12.373"></a><span id="l12.373" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l12.374"></a><span id="l12.374" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.375"></a><span id="l12.375" class="difflineplus">+          {</span>
<a href="#l12.376"></a><span id="l12.376" class="difflineplus">+            &quot;type&quot;: &quot;integer&quot;,</span>
<a href="#l12.377"></a><span id="l12.377" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l12.378"></a><span id="l12.378" class="difflineplus">+            &quot;name&quot;: &quot;tabId&quot;,</span>
<a href="#l12.379"></a><span id="l12.379" class="difflineplus">+            &quot;minimum&quot;: 0,</span>
<a href="#l12.380"></a><span id="l12.380" class="difflineplus">+            &quot;description&quot;: &quot;The id of the tab for which you want to modify the toolbar action.&quot;</span>
<a href="#l12.381"></a><span id="l12.381" class="difflineplus">+          },</span>
<a href="#l12.382"></a><span id="l12.382" class="difflineplus">+          {</span>
<a href="#l12.383"></a><span id="l12.383" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.384"></a><span id="l12.384" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l12.385"></a><span id="l12.385" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l12.386"></a><span id="l12.386" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l12.387"></a><span id="l12.387" class="difflineplus">+          }</span>
<a href="#l12.388"></a><span id="l12.388" class="difflineplus">+        ]</span>
<a href="#l12.389"></a><span id="l12.389" class="difflineplus">+      },</span>
<a href="#l12.390"></a><span id="l12.390" class="difflineplus">+      {</span>
<a href="#l12.391"></a><span id="l12.391" class="difflineplus">+        &quot;name&quot;: &quot;isEnabled&quot;,</span>
<a href="#l12.392"></a><span id="l12.392" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.393"></a><span id="l12.393" class="difflineplus">+        &quot;description&quot;: &quot;Checks whether the toolbar action is enabled.&quot;,</span>
<a href="#l12.394"></a><span id="l12.394" class="difflineplus">+        &quot;async&quot;: true,</span>
<a href="#l12.395"></a><span id="l12.395" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.396"></a><span id="l12.396" class="difflineplus">+          {</span>
<a href="#l12.397"></a><span id="l12.397" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l12.398"></a><span id="l12.398" class="difflineplus">+            &quot;$ref&quot;: &quot;Details&quot;</span>
<a href="#l12.399"></a><span id="l12.399" class="difflineplus">+          }</span>
<a href="#l12.400"></a><span id="l12.400" class="difflineplus">+        ]</span>
<a href="#l12.401"></a><span id="l12.401" class="difflineplus">+      },</span>
<a href="#l12.402"></a><span id="l12.402" class="difflineplus">+      {</span>
<a href="#l12.403"></a><span id="l12.403" class="difflineplus">+        &quot;name&quot;: &quot;openPopup&quot;,</span>
<a href="#l12.404"></a><span id="l12.404" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.405"></a><span id="l12.405" class="difflineplus">+        &quot;requireUserInput&quot;: true,</span>
<a href="#l12.406"></a><span id="l12.406" class="difflineplus">+        &quot;description&quot;: &quot;Opens the extension popup window in the active window.&quot;,</span>
<a href="#l12.407"></a><span id="l12.407" class="difflineplus">+        &quot;async&quot;: true,</span>
<a href="#l12.408"></a><span id="l12.408" class="difflineplus">+        &quot;parameters&quot;: []</span>
<a href="#l12.409"></a><span id="l12.409" class="difflineplus">+      }</span>
<a href="#l12.410"></a><span id="l12.410" class="difflineplus">+    ],</span>
<a href="#l12.411"></a><span id="l12.411" class="difflineplus">+    &quot;events&quot;: [</span>
<a href="#l12.412"></a><span id="l12.412" class="difflineplus">+      {</span>
<a href="#l12.413"></a><span id="l12.413" class="difflineplus">+        &quot;name&quot;: &quot;onClicked&quot;,</span>
<a href="#l12.414"></a><span id="l12.414" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l12.415"></a><span id="l12.415" class="difflineplus">+        &quot;description&quot;: &quot;Fired when a toolbar action icon is clicked.  This event will not fire if the toolbar action has a popup.&quot;,</span>
<a href="#l12.416"></a><span id="l12.416" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l12.417"></a><span id="l12.417" class="difflineplus">+        ]</span>
<a href="#l12.418"></a><span id="l12.418" class="difflineplus">+      }</span>
<a href="#l12.419"></a><span id="l12.419" class="difflineplus">+    ]</span>
<a href="#l12.420"></a><span id="l12.420" class="difflineplus">+  }</span>
<a href="#l12.421"></a><span id="l12.421" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1">new file mode 100644</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineminus">--- /dev/null</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineplus">+++ b/mail/components/extensions/schemas/composeAction.json</span>
<a href="#l13.4"></a><span id="l13.4" class="difflineat">@@ -0,0 +1,417 @@</span>
<a href="#l13.5"></a><span id="l13.5" class="difflineplus">+[</span>
<a href="#l13.6"></a><span id="l13.6" class="difflineplus">+  {</span>
<a href="#l13.7"></a><span id="l13.7" class="difflineplus">+    &quot;namespace&quot;: &quot;manifest&quot;,</span>
<a href="#l13.8"></a><span id="l13.8" class="difflineplus">+    &quot;types&quot;: [</span>
<a href="#l13.9"></a><span id="l13.9" class="difflineplus">+      {</span>
<a href="#l13.10"></a><span id="l13.10" class="difflineplus">+        &quot;$extend&quot;: &quot;WebExtensionManifest&quot;,</span>
<a href="#l13.11"></a><span id="l13.11" class="difflineplus">+        &quot;properties&quot;: {</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+          &quot;compose_action&quot;: {</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineplus">+            &quot;additionalProperties&quot;: { &quot;$ref&quot;: &quot;UnrecognizedProperty&quot; },</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineplus">+              &quot;default_title&quot;: {</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;,</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineplus">+                &quot;preprocess&quot;: &quot;localize&quot;</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineplus">+              },</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineplus">+              &quot;default_icon&quot;: {</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineplus">+                &quot;$ref&quot;: &quot;IconPath&quot;,</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineplus">+                &quot;optional&quot;: true</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineplus">+              },</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineplus">+              &quot;theme_icons&quot;: {</span>
<a href="#l13.26"></a><span id="l13.26" class="difflineplus">+                &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l13.27"></a><span id="l13.27" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineplus">+                &quot;minItems&quot;: 1,</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineplus">+                &quot;items&quot;: { &quot;$ref&quot;: &quot;ThemeIcons&quot; },</span>
<a href="#l13.30"></a><span id="l13.30" class="difflineplus">+                &quot;description&quot;: &quot;Specifies icons to use for dark and light themes&quot;</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineplus">+              },</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+              &quot;default_popup&quot;: {</span>
<a href="#l13.33"></a><span id="l13.33" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;,</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineplus">+                &quot;format&quot;: &quot;relativeUrl&quot;,</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l13.36"></a><span id="l13.36" class="difflineplus">+                &quot;preprocess&quot;: &quot;localize&quot;</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineplus">+              },</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineplus">+              &quot;browser_style&quot;: {</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineplus">+                &quot;type&quot;: &quot;boolean&quot;,</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineplus">+                &quot;default&quot;: false</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineplus">+              },</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineplus">+              &quot;default_area&quot;: {</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineplus">+                &quot;description&quot;: &quot;Defines the location the composeAction will appear by default. The default location is maintoolbar.&quot;,</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;,</span>
<a href="#l13.46"></a><span id="l13.46" class="difflineplus">+                &quot;enum&quot;: [&quot;maintoolbar&quot;, &quot;formattoolbar&quot;],</span>
<a href="#l13.47"></a><span id="l13.47" class="difflineplus">+                &quot;optional&quot;: true</span>
<a href="#l13.48"></a><span id="l13.48" class="difflineplus">+              }</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineplus">+            },</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineplus">+            &quot;optional&quot;: true</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+          }</span>
<a href="#l13.52"></a><span id="l13.52" class="difflineplus">+        }</span>
<a href="#l13.53"></a><span id="l13.53" class="difflineplus">+      }</span>
<a href="#l13.54"></a><span id="l13.54" class="difflineplus">+    ]</span>
<a href="#l13.55"></a><span id="l13.55" class="difflineplus">+  },</span>
<a href="#l13.56"></a><span id="l13.56" class="difflineplus">+  {</span>
<a href="#l13.57"></a><span id="l13.57" class="difflineplus">+    &quot;namespace&quot;: &quot;composeAction&quot;,</span>
<a href="#l13.58"></a><span id="l13.58" class="difflineplus">+    &quot;description&quot;: &quot;Use toolbar actions to put icons in the message composition toolbars. In addition to its icon, a toolbar action can also have a tooltip, a badge, and a popup.&quot;,</span>
<a href="#l13.59"></a><span id="l13.59" class="difflineplus">+    &quot;types&quot;: [</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineplus">+      {</span>
<a href="#l13.61"></a><span id="l13.61" class="difflineplus">+        &quot;id&quot;: &quot;Details&quot;,</span>
<a href="#l13.62"></a><span id="l13.62" class="difflineplus">+        &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l13.63"></a><span id="l13.63" class="difflineplus">+        &quot;description&quot;: &quot;Specifies to which tab or window the value should be set, or from which one it should be retrieved. If no tab nor window is specified, the global value is set or retrieved.&quot;,</span>
<a href="#l13.64"></a><span id="l13.64" class="difflineplus">+        &quot;properties&quot;: {</span>
<a href="#l13.65"></a><span id="l13.65" class="difflineplus">+          &quot;tabId&quot;: {</span>
<a href="#l13.66"></a><span id="l13.66" class="difflineplus">+            &quot;type&quot;: &quot;integer&quot;,</span>
<a href="#l13.67"></a><span id="l13.67" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l13.68"></a><span id="l13.68" class="difflineplus">+            &quot;minimum&quot;: 0,</span>
<a href="#l13.69"></a><span id="l13.69" class="difflineplus">+            &quot;description&quot;: &quot;When setting a value, it will be specific to the specified tab, and will automatically reset when the tab navigates. When getting, specifies the tab to get the value from; if there is no tab-specific value, the window one will be inherited.&quot;</span>
<a href="#l13.70"></a><span id="l13.70" class="difflineplus">+          },</span>
<a href="#l13.71"></a><span id="l13.71" class="difflineplus">+          &quot;windowId&quot;: {</span>
<a href="#l13.72"></a><span id="l13.72" class="difflineplus">+            &quot;type&quot;: &quot;integer&quot;,</span>
<a href="#l13.73"></a><span id="l13.73" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l13.74"></a><span id="l13.74" class="difflineplus">+            &quot;minimum&quot;: -2,</span>
<a href="#l13.75"></a><span id="l13.75" class="difflineplus">+            &quot;description&quot;: &quot;When setting a value, it will be specific to the specified window. When getting, specifies the window to get the value from; if there is no window-specific value, the global one will be inherited.&quot;</span>
<a href="#l13.76"></a><span id="l13.76" class="difflineplus">+          }</span>
<a href="#l13.77"></a><span id="l13.77" class="difflineplus">+        }</span>
<a href="#l13.78"></a><span id="l13.78" class="difflineplus">+      },</span>
<a href="#l13.79"></a><span id="l13.79" class="difflineplus">+      {</span>
<a href="#l13.80"></a><span id="l13.80" class="difflineplus">+        &quot;id&quot;: &quot;ColorArray&quot;,</span>
<a href="#l13.81"></a><span id="l13.81" class="difflineplus">+        &quot;type&quot;: &quot;array&quot;,</span>
<a href="#l13.82"></a><span id="l13.82" class="difflineplus">+        &quot;items&quot;: {</span>
<a href="#l13.83"></a><span id="l13.83" class="difflineplus">+          &quot;type&quot;: &quot;integer&quot;,</span>
<a href="#l13.84"></a><span id="l13.84" class="difflineplus">+          &quot;minimum&quot;: 0,</span>
<a href="#l13.85"></a><span id="l13.85" class="difflineplus">+          &quot;maximum&quot;: 255</span>
<a href="#l13.86"></a><span id="l13.86" class="difflineplus">+        },</span>
<a href="#l13.87"></a><span id="l13.87" class="difflineplus">+        &quot;minItems&quot;: 4,</span>
<a href="#l13.88"></a><span id="l13.88" class="difflineplus">+        &quot;maxItems&quot;: 4</span>
<a href="#l13.89"></a><span id="l13.89" class="difflineplus">+      },</span>
<a href="#l13.90"></a><span id="l13.90" class="difflineplus">+      {</span>
<a href="#l13.91"></a><span id="l13.91" class="difflineplus">+        &quot;id&quot;: &quot;ImageDataType&quot;,</span>
<a href="#l13.92"></a><span id="l13.92" class="difflineplus">+        &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l13.93"></a><span id="l13.93" class="difflineplus">+        &quot;isInstanceOf&quot;: &quot;ImageData&quot;,</span>
<a href="#l13.94"></a><span id="l13.94" class="difflineplus">+        &quot;additionalProperties&quot;: { &quot;type&quot;: &quot;any&quot; },</span>
<a href="#l13.95"></a><span id="l13.95" class="difflineplus">+        &quot;postprocess&quot;: &quot;convertImageDataToURL&quot;,</span>
<a href="#l13.96"></a><span id="l13.96" class="difflineplus">+        &quot;description&quot;: &quot;Pixel data for an image. Must be an ImageData object (for example, from a &lt;code&gt;canvas&lt;/code&gt; element).&quot;</span>
<a href="#l13.97"></a><span id="l13.97" class="difflineplus">+      }</span>
<a href="#l13.98"></a><span id="l13.98" class="difflineplus">+    ],</span>
<a href="#l13.99"></a><span id="l13.99" class="difflineplus">+    &quot;functions&quot;: [</span>
<a href="#l13.100"></a><span id="l13.100" class="difflineplus">+      {</span>
<a href="#l13.101"></a><span id="l13.101" class="difflineplus">+        &quot;name&quot;: &quot;setTitle&quot;,</span>
<a href="#l13.102"></a><span id="l13.102" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.103"></a><span id="l13.103" class="difflineplus">+        &quot;description&quot;: &quot;Sets the title of the toolbar action. This shows up in the tooltip.&quot;,</span>
<a href="#l13.104"></a><span id="l13.104" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l13.105"></a><span id="l13.105" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.106"></a><span id="l13.106" class="difflineplus">+          {</span>
<a href="#l13.107"></a><span id="l13.107" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l13.108"></a><span id="l13.108" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l13.109"></a><span id="l13.109" class="difflineplus">+            &quot;$import&quot;: &quot;Details&quot;,</span>
<a href="#l13.110"></a><span id="l13.110" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l13.111"></a><span id="l13.111" class="difflineplus">+              &quot;title&quot;: {</span>
<a href="#l13.112"></a><span id="l13.112" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l13.113"></a><span id="l13.113" class="difflineplus">+                  {&quot;type&quot;: &quot;string&quot;},</span>
<a href="#l13.114"></a><span id="l13.114" class="difflineplus">+                  {&quot;type&quot;: &quot;null&quot;}</span>
<a href="#l13.115"></a><span id="l13.115" class="difflineplus">+                ],</span>
<a href="#l13.116"></a><span id="l13.116" class="difflineplus">+                &quot;description&quot;: &quot;The string the toolbar action should display when moused over.&quot;</span>
<a href="#l13.117"></a><span id="l13.117" class="difflineplus">+              }</span>
<a href="#l13.118"></a><span id="l13.118" class="difflineplus">+            }</span>
<a href="#l13.119"></a><span id="l13.119" class="difflineplus">+          },</span>
<a href="#l13.120"></a><span id="l13.120" class="difflineplus">+          {</span>
<a href="#l13.121"></a><span id="l13.121" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.122"></a><span id="l13.122" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l13.123"></a><span id="l13.123" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l13.124"></a><span id="l13.124" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l13.125"></a><span id="l13.125" class="difflineplus">+          }</span>
<a href="#l13.126"></a><span id="l13.126" class="difflineplus">+        ]</span>
<a href="#l13.127"></a><span id="l13.127" class="difflineplus">+      },</span>
<a href="#l13.128"></a><span id="l13.128" class="difflineplus">+      {</span>
<a href="#l13.129"></a><span id="l13.129" class="difflineplus">+        &quot;name&quot;: &quot;getTitle&quot;,</span>
<a href="#l13.130"></a><span id="l13.130" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.131"></a><span id="l13.131" class="difflineplus">+        &quot;description&quot;: &quot;Gets the title of the toolbar action.&quot;,</span>
<a href="#l13.132"></a><span id="l13.132" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l13.133"></a><span id="l13.133" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.134"></a><span id="l13.134" class="difflineplus">+          {</span>
<a href="#l13.135"></a><span id="l13.135" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l13.136"></a><span id="l13.136" class="difflineplus">+            &quot;$ref&quot;: &quot;Details&quot;</span>
<a href="#l13.137"></a><span id="l13.137" class="difflineplus">+          },</span>
<a href="#l13.138"></a><span id="l13.138" class="difflineplus">+          {</span>
<a href="#l13.139"></a><span id="l13.139" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.140"></a><span id="l13.140" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l13.141"></a><span id="l13.141" class="difflineplus">+            &quot;parameters&quot;: [</span>
<a href="#l13.142"></a><span id="l13.142" class="difflineplus">+              {</span>
<a href="#l13.143"></a><span id="l13.143" class="difflineplus">+                &quot;name&quot;: &quot;result&quot;,</span>
<a href="#l13.144"></a><span id="l13.144" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;</span>
<a href="#l13.145"></a><span id="l13.145" class="difflineplus">+              }</span>
<a href="#l13.146"></a><span id="l13.146" class="difflineplus">+            ]</span>
<a href="#l13.147"></a><span id="l13.147" class="difflineplus">+          }</span>
<a href="#l13.148"></a><span id="l13.148" class="difflineplus">+        ]</span>
<a href="#l13.149"></a><span id="l13.149" class="difflineplus">+      },</span>
<a href="#l13.150"></a><span id="l13.150" class="difflineplus">+      {</span>
<a href="#l13.151"></a><span id="l13.151" class="difflineplus">+        &quot;name&quot;: &quot;setIcon&quot;,</span>
<a href="#l13.152"></a><span id="l13.152" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.153"></a><span id="l13.153" class="difflineplus">+        &quot;description&quot;: &quot;Sets the icon for the toolbar action. The icon can be specified either as the path to an image file or as the pixel data from a canvas element, or as dictionary of either one of those. Either the &lt;b&gt;path&lt;/b&gt; or the &lt;b&gt;imageData&lt;/b&gt; property must be specified.&quot;,</span>
<a href="#l13.154"></a><span id="l13.154" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l13.155"></a><span id="l13.155" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.156"></a><span id="l13.156" class="difflineplus">+          {</span>
<a href="#l13.157"></a><span id="l13.157" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l13.158"></a><span id="l13.158" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l13.159"></a><span id="l13.159" class="difflineplus">+            &quot;$import&quot;: &quot;Details&quot;,</span>
<a href="#l13.160"></a><span id="l13.160" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l13.161"></a><span id="l13.161" class="difflineplus">+              &quot;imageData&quot;: {</span>
<a href="#l13.162"></a><span id="l13.162" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l13.163"></a><span id="l13.163" class="difflineplus">+                  { &quot;$ref&quot;: &quot;ImageDataType&quot; },</span>
<a href="#l13.164"></a><span id="l13.164" class="difflineplus">+                  {</span>
<a href="#l13.165"></a><span id="l13.165" class="difflineplus">+                    &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l13.166"></a><span id="l13.166" class="difflineplus">+                    &quot;patternProperties&quot;: {</span>
<a href="#l13.167"></a><span id="l13.167" class="difflineplus">+                      &quot;^[1-9]\\d*$&quot;: {&quot;$ref&quot;: &quot;ImageDataType&quot;}</span>
<a href="#l13.168"></a><span id="l13.168" class="difflineplus">+                    }</span>
<a href="#l13.169"></a><span id="l13.169" class="difflineplus">+                  }</span>
<a href="#l13.170"></a><span id="l13.170" class="difflineplus">+                ],</span>
<a href="#l13.171"></a><span id="l13.171" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l13.172"></a><span id="l13.172" class="difflineplus">+                &quot;description&quot;: &quot;Either an ImageData object or a dictionary {size -&gt; ImageData} representing icon to be set. If the icon is specified as a dictionary, the actual image to be used is chosen depending on screen's pixel density. If the number of image pixels that fit into one screen space unit equals &lt;code&gt;scale&lt;/code&gt;, then image with size &lt;code&gt;scale&lt;/code&gt; * 19 will be selected. Initially only scales 1 and 2 will be supported. At least one image must be specified. Note that 'details.imageData = foo' is equivalent to 'details.imageData = {'19': foo}'&quot;</span>
<a href="#l13.173"></a><span id="l13.173" class="difflineplus">+              },</span>
<a href="#l13.174"></a><span id="l13.174" class="difflineplus">+              &quot;path&quot;: {</span>
<a href="#l13.175"></a><span id="l13.175" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l13.176"></a><span id="l13.176" class="difflineplus">+                  { &quot;type&quot;: &quot;string&quot; },</span>
<a href="#l13.177"></a><span id="l13.177" class="difflineplus">+                  {</span>
<a href="#l13.178"></a><span id="l13.178" class="difflineplus">+                    &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l13.179"></a><span id="l13.179" class="difflineplus">+                    &quot;patternProperties&quot;: {</span>
<a href="#l13.180"></a><span id="l13.180" class="difflineplus">+                      &quot;^[1-9]\\d*$&quot;: { &quot;type&quot;: &quot;string&quot; }</span>
<a href="#l13.181"></a><span id="l13.181" class="difflineplus">+                    }</span>
<a href="#l13.182"></a><span id="l13.182" class="difflineplus">+                  }</span>
<a href="#l13.183"></a><span id="l13.183" class="difflineplus">+                ],</span>
<a href="#l13.184"></a><span id="l13.184" class="difflineplus">+                &quot;optional&quot;: true,</span>
<a href="#l13.185"></a><span id="l13.185" class="difflineplus">+                &quot;description&quot;: &quot;Either a relative image path or a dictionary {size -&gt; relative image path} pointing to icon to be set. If the icon is specified as a dictionary, the actual image to be used is chosen depending on screen's pixel density. If the number of image pixels that fit into one screen space unit equals &lt;code&gt;scale&lt;/code&gt;, then image with size &lt;code&gt;scale&lt;/code&gt; * 19 will be selected. Initially only scales 1 and 2 will be supported. At least one image must be specified. Note that 'details.path = foo' is equivalent to 'details.imageData = {'19': foo}'&quot;</span>
<a href="#l13.186"></a><span id="l13.186" class="difflineplus">+              }</span>
<a href="#l13.187"></a><span id="l13.187" class="difflineplus">+            }</span>
<a href="#l13.188"></a><span id="l13.188" class="difflineplus">+          },</span>
<a href="#l13.189"></a><span id="l13.189" class="difflineplus">+          {</span>
<a href="#l13.190"></a><span id="l13.190" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.191"></a><span id="l13.191" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l13.192"></a><span id="l13.192" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l13.193"></a><span id="l13.193" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l13.194"></a><span id="l13.194" class="difflineplus">+          }</span>
<a href="#l13.195"></a><span id="l13.195" class="difflineplus">+        ]</span>
<a href="#l13.196"></a><span id="l13.196" class="difflineplus">+      },</span>
<a href="#l13.197"></a><span id="l13.197" class="difflineplus">+      {</span>
<a href="#l13.198"></a><span id="l13.198" class="difflineplus">+        &quot;name&quot;: &quot;setPopup&quot;,</span>
<a href="#l13.199"></a><span id="l13.199" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.200"></a><span id="l13.200" class="difflineplus">+        &quot;description&quot;: &quot;Sets the html document to be opened as a popup when the user clicks on the toolbar action's icon.&quot;,</span>
<a href="#l13.201"></a><span id="l13.201" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l13.202"></a><span id="l13.202" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.203"></a><span id="l13.203" class="difflineplus">+          {</span>
<a href="#l13.204"></a><span id="l13.204" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l13.205"></a><span id="l13.205" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l13.206"></a><span id="l13.206" class="difflineplus">+            &quot;$import&quot;: &quot;Details&quot;,</span>
<a href="#l13.207"></a><span id="l13.207" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l13.208"></a><span id="l13.208" class="difflineplus">+              &quot;popup&quot;: {</span>
<a href="#l13.209"></a><span id="l13.209" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l13.210"></a><span id="l13.210" class="difflineplus">+                  {&quot;type&quot;: &quot;string&quot;},</span>
<a href="#l13.211"></a><span id="l13.211" class="difflineplus">+                  {&quot;type&quot;: &quot;null&quot;}</span>
<a href="#l13.212"></a><span id="l13.212" class="difflineplus">+                ],</span>
<a href="#l13.213"></a><span id="l13.213" class="difflineplus">+                &quot;description&quot;: &quot;The html file to show in a popup.  If set to the empty string (''), no popup is shown.&quot;</span>
<a href="#l13.214"></a><span id="l13.214" class="difflineplus">+              }</span>
<a href="#l13.215"></a><span id="l13.215" class="difflineplus">+            }</span>
<a href="#l13.216"></a><span id="l13.216" class="difflineplus">+          },</span>
<a href="#l13.217"></a><span id="l13.217" class="difflineplus">+          {</span>
<a href="#l13.218"></a><span id="l13.218" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.219"></a><span id="l13.219" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l13.220"></a><span id="l13.220" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l13.221"></a><span id="l13.221" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l13.222"></a><span id="l13.222" class="difflineplus">+          }</span>
<a href="#l13.223"></a><span id="l13.223" class="difflineplus">+        ]</span>
<a href="#l13.224"></a><span id="l13.224" class="difflineplus">+      },</span>
<a href="#l13.225"></a><span id="l13.225" class="difflineplus">+      {</span>
<a href="#l13.226"></a><span id="l13.226" class="difflineplus">+        &quot;name&quot;: &quot;getPopup&quot;,</span>
<a href="#l13.227"></a><span id="l13.227" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.228"></a><span id="l13.228" class="difflineplus">+        &quot;description&quot;: &quot;Gets the html document set as the popup for this toolbar action.&quot;,</span>
<a href="#l13.229"></a><span id="l13.229" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l13.230"></a><span id="l13.230" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.231"></a><span id="l13.231" class="difflineplus">+          {</span>
<a href="#l13.232"></a><span id="l13.232" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l13.233"></a><span id="l13.233" class="difflineplus">+            &quot;$ref&quot;: &quot;Details&quot;</span>
<a href="#l13.234"></a><span id="l13.234" class="difflineplus">+          },</span>
<a href="#l13.235"></a><span id="l13.235" class="difflineplus">+          {</span>
<a href="#l13.236"></a><span id="l13.236" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.237"></a><span id="l13.237" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l13.238"></a><span id="l13.238" class="difflineplus">+            &quot;parameters&quot;: [</span>
<a href="#l13.239"></a><span id="l13.239" class="difflineplus">+              {</span>
<a href="#l13.240"></a><span id="l13.240" class="difflineplus">+                &quot;name&quot;: &quot;result&quot;,</span>
<a href="#l13.241"></a><span id="l13.241" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;</span>
<a href="#l13.242"></a><span id="l13.242" class="difflineplus">+              }</span>
<a href="#l13.243"></a><span id="l13.243" class="difflineplus">+            ]</span>
<a href="#l13.244"></a><span id="l13.244" class="difflineplus">+          }</span>
<a href="#l13.245"></a><span id="l13.245" class="difflineplus">+        ]</span>
<a href="#l13.246"></a><span id="l13.246" class="difflineplus">+      },</span>
<a href="#l13.247"></a><span id="l13.247" class="difflineplus">+      {</span>
<a href="#l13.248"></a><span id="l13.248" class="difflineplus">+        &quot;name&quot;: &quot;setBadgeText&quot;,</span>
<a href="#l13.249"></a><span id="l13.249" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.250"></a><span id="l13.250" class="difflineplus">+        &quot;description&quot;: &quot;Sets the badge text for the toolbar action. The badge is displayed on top of the icon.&quot;,</span>
<a href="#l13.251"></a><span id="l13.251" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l13.252"></a><span id="l13.252" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.253"></a><span id="l13.253" class="difflineplus">+          {</span>
<a href="#l13.254"></a><span id="l13.254" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l13.255"></a><span id="l13.255" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l13.256"></a><span id="l13.256" class="difflineplus">+            &quot;$import&quot;: &quot;Details&quot;,</span>
<a href="#l13.257"></a><span id="l13.257" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l13.258"></a><span id="l13.258" class="difflineplus">+              &quot;text&quot;: {</span>
<a href="#l13.259"></a><span id="l13.259" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l13.260"></a><span id="l13.260" class="difflineplus">+                  {&quot;type&quot;: &quot;string&quot;},</span>
<a href="#l13.261"></a><span id="l13.261" class="difflineplus">+                  {&quot;type&quot;: &quot;null&quot;}</span>
<a href="#l13.262"></a><span id="l13.262" class="difflineplus">+                ],</span>
<a href="#l13.263"></a><span id="l13.263" class="difflineplus">+                &quot;description&quot;: &quot;Any number of characters can be passed, but only about four can fit in the space.&quot;</span>
<a href="#l13.264"></a><span id="l13.264" class="difflineplus">+              }</span>
<a href="#l13.265"></a><span id="l13.265" class="difflineplus">+            }</span>
<a href="#l13.266"></a><span id="l13.266" class="difflineplus">+          },</span>
<a href="#l13.267"></a><span id="l13.267" class="difflineplus">+          {</span>
<a href="#l13.268"></a><span id="l13.268" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.269"></a><span id="l13.269" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l13.270"></a><span id="l13.270" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l13.271"></a><span id="l13.271" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l13.272"></a><span id="l13.272" class="difflineplus">+          }</span>
<a href="#l13.273"></a><span id="l13.273" class="difflineplus">+        ]</span>
<a href="#l13.274"></a><span id="l13.274" class="difflineplus">+      },</span>
<a href="#l13.275"></a><span id="l13.275" class="difflineplus">+      {</span>
<a href="#l13.276"></a><span id="l13.276" class="difflineplus">+        &quot;name&quot;: &quot;getBadgeText&quot;,</span>
<a href="#l13.277"></a><span id="l13.277" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.278"></a><span id="l13.278" class="difflineplus">+        &quot;description&quot;: &quot;Gets the badge text of the toolbar action. If no tab nor window is specified is specified, the global badge text is returned.&quot;,</span>
<a href="#l13.279"></a><span id="l13.279" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l13.280"></a><span id="l13.280" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.281"></a><span id="l13.281" class="difflineplus">+          {</span>
<a href="#l13.282"></a><span id="l13.282" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l13.283"></a><span id="l13.283" class="difflineplus">+            &quot;$ref&quot;: &quot;Details&quot;</span>
<a href="#l13.284"></a><span id="l13.284" class="difflineplus">+          },</span>
<a href="#l13.285"></a><span id="l13.285" class="difflineplus">+          {</span>
<a href="#l13.286"></a><span id="l13.286" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.287"></a><span id="l13.287" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l13.288"></a><span id="l13.288" class="difflineplus">+            &quot;parameters&quot;: [</span>
<a href="#l13.289"></a><span id="l13.289" class="difflineplus">+              {</span>
<a href="#l13.290"></a><span id="l13.290" class="difflineplus">+                &quot;name&quot;: &quot;result&quot;,</span>
<a href="#l13.291"></a><span id="l13.291" class="difflineplus">+                &quot;type&quot;: &quot;string&quot;</span>
<a href="#l13.292"></a><span id="l13.292" class="difflineplus">+              }</span>
<a href="#l13.293"></a><span id="l13.293" class="difflineplus">+            ]</span>
<a href="#l13.294"></a><span id="l13.294" class="difflineplus">+          }</span>
<a href="#l13.295"></a><span id="l13.295" class="difflineplus">+        ]</span>
<a href="#l13.296"></a><span id="l13.296" class="difflineplus">+      },</span>
<a href="#l13.297"></a><span id="l13.297" class="difflineplus">+      {</span>
<a href="#l13.298"></a><span id="l13.298" class="difflineplus">+        &quot;name&quot;: &quot;setBadgeBackgroundColor&quot;,</span>
<a href="#l13.299"></a><span id="l13.299" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.300"></a><span id="l13.300" class="difflineplus">+        &quot;description&quot;: &quot;Sets the background color for the badge.&quot;,</span>
<a href="#l13.301"></a><span id="l13.301" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l13.302"></a><span id="l13.302" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.303"></a><span id="l13.303" class="difflineplus">+          {</span>
<a href="#l13.304"></a><span id="l13.304" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l13.305"></a><span id="l13.305" class="difflineplus">+            &quot;type&quot;: &quot;object&quot;,</span>
<a href="#l13.306"></a><span id="l13.306" class="difflineplus">+            &quot;$import&quot;: &quot;Details&quot;,</span>
<a href="#l13.307"></a><span id="l13.307" class="difflineplus">+            &quot;properties&quot;: {</span>
<a href="#l13.308"></a><span id="l13.308" class="difflineplus">+              &quot;color&quot;: {</span>
<a href="#l13.309"></a><span id="l13.309" class="difflineplus">+                &quot;description&quot;: &quot;An array of four integers in the range [0,255] that make up the RGBA color of the badge. For example, opaque red is &lt;code&gt;[255, 0, 0, 255]&lt;/code&gt;. Can also be a string with a CSS value, with opaque red being &lt;code&gt;#FF0000&lt;/code&gt; or &lt;code&gt;#F00&lt;/code&gt;.&quot;,</span>
<a href="#l13.310"></a><span id="l13.310" class="difflineplus">+                &quot;choices&quot;: [</span>
<a href="#l13.311"></a><span id="l13.311" class="difflineplus">+                  {&quot;type&quot;: &quot;string&quot;},</span>
<a href="#l13.312"></a><span id="l13.312" class="difflineplus">+                  {&quot;$ref&quot;: &quot;ColorArray&quot;},</span>
<a href="#l13.313"></a><span id="l13.313" class="difflineplus">+                  {&quot;type&quot;: &quot;null&quot;}</span>
<a href="#l13.314"></a><span id="l13.314" class="difflineplus">+                ]</span>
<a href="#l13.315"></a><span id="l13.315" class="difflineplus">+              }</span>
<a href="#l13.316"></a><span id="l13.316" class="difflineplus">+            }</span>
<a href="#l13.317"></a><span id="l13.317" class="difflineplus">+          },</span>
<a href="#l13.318"></a><span id="l13.318" class="difflineplus">+          {</span>
<a href="#l13.319"></a><span id="l13.319" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.320"></a><span id="l13.320" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l13.321"></a><span id="l13.321" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l13.322"></a><span id="l13.322" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l13.323"></a><span id="l13.323" class="difflineplus">+          }</span>
<a href="#l13.324"></a><span id="l13.324" class="difflineplus">+        ]</span>
<a href="#l13.325"></a><span id="l13.325" class="difflineplus">+      },</span>
<a href="#l13.326"></a><span id="l13.326" class="difflineplus">+      {</span>
<a href="#l13.327"></a><span id="l13.327" class="difflineplus">+        &quot;name&quot;: &quot;getBadgeBackgroundColor&quot;,</span>
<a href="#l13.328"></a><span id="l13.328" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.329"></a><span id="l13.329" class="difflineplus">+        &quot;description&quot;: &quot;Gets the background color of the toolbar action.&quot;,</span>
<a href="#l13.330"></a><span id="l13.330" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l13.331"></a><span id="l13.331" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.332"></a><span id="l13.332" class="difflineplus">+          {</span>
<a href="#l13.333"></a><span id="l13.333" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l13.334"></a><span id="l13.334" class="difflineplus">+            &quot;$ref&quot;: &quot;Details&quot;</span>
<a href="#l13.335"></a><span id="l13.335" class="difflineplus">+          },</span>
<a href="#l13.336"></a><span id="l13.336" class="difflineplus">+          {</span>
<a href="#l13.337"></a><span id="l13.337" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.338"></a><span id="l13.338" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l13.339"></a><span id="l13.339" class="difflineplus">+            &quot;parameters&quot;: [</span>
<a href="#l13.340"></a><span id="l13.340" class="difflineplus">+              {</span>
<a href="#l13.341"></a><span id="l13.341" class="difflineplus">+                &quot;name&quot;: &quot;result&quot;,</span>
<a href="#l13.342"></a><span id="l13.342" class="difflineplus">+                &quot;$ref&quot;: &quot;ColorArray&quot;</span>
<a href="#l13.343"></a><span id="l13.343" class="difflineplus">+              }</span>
<a href="#l13.344"></a><span id="l13.344" class="difflineplus">+            ]</span>
<a href="#l13.345"></a><span id="l13.345" class="difflineplus">+          }</span>
<a href="#l13.346"></a><span id="l13.346" class="difflineplus">+        ]</span>
<a href="#l13.347"></a><span id="l13.347" class="difflineplus">+      },</span>
<a href="#l13.348"></a><span id="l13.348" class="difflineplus">+      {</span>
<a href="#l13.349"></a><span id="l13.349" class="difflineplus">+        &quot;name&quot;: &quot;enable&quot;,</span>
<a href="#l13.350"></a><span id="l13.350" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.351"></a><span id="l13.351" class="difflineplus">+        &quot;description&quot;: &quot;Enables the toolbar action for a tab. By default, toolbar actions are enabled.&quot;,</span>
<a href="#l13.352"></a><span id="l13.352" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l13.353"></a><span id="l13.353" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.354"></a><span id="l13.354" class="difflineplus">+          {</span>
<a href="#l13.355"></a><span id="l13.355" class="difflineplus">+            &quot;type&quot;: &quot;integer&quot;,</span>
<a href="#l13.356"></a><span id="l13.356" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l13.357"></a><span id="l13.357" class="difflineplus">+            &quot;name&quot;: &quot;tabId&quot;,</span>
<a href="#l13.358"></a><span id="l13.358" class="difflineplus">+            &quot;minimum&quot;: 0,</span>
<a href="#l13.359"></a><span id="l13.359" class="difflineplus">+            &quot;description&quot;: &quot;The id of the tab for which you want to modify the toolbar action.&quot;</span>
<a href="#l13.360"></a><span id="l13.360" class="difflineplus">+          },</span>
<a href="#l13.361"></a><span id="l13.361" class="difflineplus">+          {</span>
<a href="#l13.362"></a><span id="l13.362" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.363"></a><span id="l13.363" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l13.364"></a><span id="l13.364" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l13.365"></a><span id="l13.365" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l13.366"></a><span id="l13.366" class="difflineplus">+          }</span>
<a href="#l13.367"></a><span id="l13.367" class="difflineplus">+        ]</span>
<a href="#l13.368"></a><span id="l13.368" class="difflineplus">+      },</span>
<a href="#l13.369"></a><span id="l13.369" class="difflineplus">+      {</span>
<a href="#l13.370"></a><span id="l13.370" class="difflineplus">+        &quot;name&quot;: &quot;disable&quot;,</span>
<a href="#l13.371"></a><span id="l13.371" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.372"></a><span id="l13.372" class="difflineplus">+        &quot;description&quot;: &quot;Disables the toolbar action for a tab.&quot;,</span>
<a href="#l13.373"></a><span id="l13.373" class="difflineplus">+        &quot;async&quot;: &quot;callback&quot;,</span>
<a href="#l13.374"></a><span id="l13.374" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.375"></a><span id="l13.375" class="difflineplus">+          {</span>
<a href="#l13.376"></a><span id="l13.376" class="difflineplus">+            &quot;type&quot;: &quot;integer&quot;,</span>
<a href="#l13.377"></a><span id="l13.377" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l13.378"></a><span id="l13.378" class="difflineplus">+            &quot;name&quot;: &quot;tabId&quot;,</span>
<a href="#l13.379"></a><span id="l13.379" class="difflineplus">+            &quot;minimum&quot;: 0,</span>
<a href="#l13.380"></a><span id="l13.380" class="difflineplus">+            &quot;description&quot;: &quot;The id of the tab for which you want to modify the toolbar action.&quot;</span>
<a href="#l13.381"></a><span id="l13.381" class="difflineplus">+          },</span>
<a href="#l13.382"></a><span id="l13.382" class="difflineplus">+          {</span>
<a href="#l13.383"></a><span id="l13.383" class="difflineplus">+            &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.384"></a><span id="l13.384" class="difflineplus">+            &quot;name&quot;: &quot;callback&quot;,</span>
<a href="#l13.385"></a><span id="l13.385" class="difflineplus">+            &quot;optional&quot;: true,</span>
<a href="#l13.386"></a><span id="l13.386" class="difflineplus">+            &quot;parameters&quot;: []</span>
<a href="#l13.387"></a><span id="l13.387" class="difflineplus">+          }</span>
<a href="#l13.388"></a><span id="l13.388" class="difflineplus">+        ]</span>
<a href="#l13.389"></a><span id="l13.389" class="difflineplus">+      },</span>
<a href="#l13.390"></a><span id="l13.390" class="difflineplus">+      {</span>
<a href="#l13.391"></a><span id="l13.391" class="difflineplus">+        &quot;name&quot;: &quot;isEnabled&quot;,</span>
<a href="#l13.392"></a><span id="l13.392" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.393"></a><span id="l13.393" class="difflineplus">+        &quot;description&quot;: &quot;Checks whether the toolbar action is enabled.&quot;,</span>
<a href="#l13.394"></a><span id="l13.394" class="difflineplus">+        &quot;async&quot;: true,</span>
<a href="#l13.395"></a><span id="l13.395" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.396"></a><span id="l13.396" class="difflineplus">+          {</span>
<a href="#l13.397"></a><span id="l13.397" class="difflineplus">+            &quot;name&quot;: &quot;details&quot;,</span>
<a href="#l13.398"></a><span id="l13.398" class="difflineplus">+            &quot;$ref&quot;: &quot;Details&quot;</span>
<a href="#l13.399"></a><span id="l13.399" class="difflineplus">+          }</span>
<a href="#l13.400"></a><span id="l13.400" class="difflineplus">+        ]</span>
<a href="#l13.401"></a><span id="l13.401" class="difflineplus">+      },</span>
<a href="#l13.402"></a><span id="l13.402" class="difflineplus">+      {</span>
<a href="#l13.403"></a><span id="l13.403" class="difflineplus">+        &quot;name&quot;: &quot;openPopup&quot;,</span>
<a href="#l13.404"></a><span id="l13.404" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.405"></a><span id="l13.405" class="difflineplus">+        &quot;requireUserInput&quot;: true,</span>
<a href="#l13.406"></a><span id="l13.406" class="difflineplus">+        &quot;description&quot;: &quot;Opens the extension popup window in the active window.&quot;,</span>
<a href="#l13.407"></a><span id="l13.407" class="difflineplus">+        &quot;async&quot;: true,</span>
<a href="#l13.408"></a><span id="l13.408" class="difflineplus">+        &quot;parameters&quot;: []</span>
<a href="#l13.409"></a><span id="l13.409" class="difflineplus">+      }</span>
<a href="#l13.410"></a><span id="l13.410" class="difflineplus">+    ],</span>
<a href="#l13.411"></a><span id="l13.411" class="difflineplus">+    &quot;events&quot;: [</span>
<a href="#l13.412"></a><span id="l13.412" class="difflineplus">+      {</span>
<a href="#l13.413"></a><span id="l13.413" class="difflineplus">+        &quot;name&quot;: &quot;onClicked&quot;,</span>
<a href="#l13.414"></a><span id="l13.414" class="difflineplus">+        &quot;type&quot;: &quot;function&quot;,</span>
<a href="#l13.415"></a><span id="l13.415" class="difflineplus">+        &quot;description&quot;: &quot;Fired when a toolbar action icon is clicked.  This event will not fire if the toolbar action has a popup.&quot;,</span>
<a href="#l13.416"></a><span id="l13.416" class="difflineplus">+        &quot;parameters&quot;: [</span>
<a href="#l13.417"></a><span id="l13.417" class="difflineplus">+        ]</span>
<a href="#l13.418"></a><span id="l13.418" class="difflineplus">+      }</span>
<a href="#l13.419"></a><span id="l13.419" class="difflineplus">+    ]</span>
<a href="#l13.420"></a><span id="l13.420" class="difflineplus">+  }</span>
<a href="#l13.421"></a><span id="l13.421" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mail/themes/shared/mail/messengercompose.css</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mail/themes/shared/mail/messengercompose.css</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -5,16 +5,83 @@</span>
<a href="#l14.4"></a><span id="l14.4"> @namespace url(&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;);</span>
<a href="#l14.5"></a><span id="l14.5"> </span>
<a href="#l14.6"></a><span id="l14.6"> :root {</span>
<a href="#l14.7"></a><span id="l14.7">   --lwt-additional-images: none;</span>
<a href="#l14.8"></a><span id="l14.8">   --lwt-background-alignment: right top;</span>
<a href="#l14.9"></a><span id="l14.9">   --lwt-background-tiling: no-repeat;</span>
<a href="#l14.10"></a><span id="l14.10"> }</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+/* Rules to help integrate WebExtension buttons */</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+.webextension-browser-action &gt; .toolbarbutton-badge-stack &gt; .toolbarbutton-icon {</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+  height: 16px;</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineplus">+  width: 16px;</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+}</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineplus">+</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineplus">+@media not all and (min-resolution: 1.1dppx) {</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineplus">+  .webextension-browser-action {</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image, inherit);</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineplus">+  }</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineplus">+</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineplus">+  toolbar[brighttext] .webextension-browser-action {</span>
<a href="#l14.25"></a><span id="l14.25" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image-light, inherit);</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineplus">+  }</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineplus">+</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineplus">+  toolbar:not([brighttext]) .webextension-browser-action:-moz-lwtheme {</span>
<a href="#l14.29"></a><span id="l14.29" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image-dark, inherit);</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineplus">+  }</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineplus">+</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+  .webextension-browser-action[cui-areatype=&quot;menu-panel&quot;] {</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image, inherit);</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineplus">+  }</span>
<a href="#l14.35"></a><span id="l14.35" class="difflineplus">+</span>
<a href="#l14.36"></a><span id="l14.36" class="difflineplus">+  :root[lwt-popup-brighttext] .webextension-browser-action[cui-areatype=&quot;menu-panel&quot;] {</span>
<a href="#l14.37"></a><span id="l14.37" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image-light, inherit);</span>
<a href="#l14.38"></a><span id="l14.38" class="difflineplus">+  }</span>
<a href="#l14.39"></a><span id="l14.39" class="difflineplus">+</span>
<a href="#l14.40"></a><span id="l14.40" class="difflineplus">+  :root:not([lwt-popup-brighttext]) .webextension-browser-action[cui-areatype=&quot;menu-panel&quot;]:-moz-lwtheme {</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image-dark, inherit);</span>
<a href="#l14.42"></a><span id="l14.42" class="difflineplus">+  }</span>
<a href="#l14.43"></a><span id="l14.43" class="difflineplus">+</span>
<a href="#l14.44"></a><span id="l14.44" class="difflineplus">+  .webextension-menuitem {</span>
<a href="#l14.45"></a><span id="l14.45" class="difflineplus">+    list-style-image: var(--webextension-menuitem-image, inherit) !important;</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineplus">+  }</span>
<a href="#l14.47"></a><span id="l14.47" class="difflineplus">+}</span>
<a href="#l14.48"></a><span id="l14.48" class="difflineplus">+</span>
<a href="#l14.49"></a><span id="l14.49" class="difflineplus">+@media (min-resolution: 1.1dppx) {</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineplus">+  .webextension-browser-action {</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image-2x, inherit);</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+  }</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineplus">+</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineplus">+  toolbar[brighttext] .webextension-browser-action {</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image-2x-light, inherit);</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineplus">+  }</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineplus">+</span>
<a href="#l14.58"></a><span id="l14.58" class="difflineplus">+  toolbar:not([brighttext]) .webextension-browser-action:-moz-lwtheme {</span>
<a href="#l14.59"></a><span id="l14.59" class="difflineplus">+    list-style-image: var(--webextension-toolbar-image-2x-dark, inherit);</span>
<a href="#l14.60"></a><span id="l14.60" class="difflineplus">+  }</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineplus">+</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineplus">+  .webextension-browser-action[cui-areatype=&quot;menu-panel&quot;] {</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image-2x, inherit);</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineplus">+  }</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineplus">+</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineplus">+  :root[lwt-popup-brighttext] .webextension-browser-action[cui-areatype=&quot;menu-panel&quot;] {</span>
<a href="#l14.67"></a><span id="l14.67" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image-2x-light, inherit);</span>
<a href="#l14.68"></a><span id="l14.68" class="difflineplus">+  }</span>
<a href="#l14.69"></a><span id="l14.69" class="difflineplus">+</span>
<a href="#l14.70"></a><span id="l14.70" class="difflineplus">+  :root:not([lwt-popup-brighttext]) .webextension-browser-action[cui-areatype=&quot;menu-panel&quot;]:-moz-lwtheme {</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineplus">+    list-style-image: var(--webextension-menupanel-image-2x-dark, inherit);</span>
<a href="#l14.72"></a><span id="l14.72" class="difflineplus">+  }</span>
<a href="#l14.73"></a><span id="l14.73" class="difflineplus">+</span>
<a href="#l14.74"></a><span id="l14.74" class="difflineplus">+  .webextension-menuitem {</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineplus">+    list-style-image: var(--webextension-menuitem-image-2x, inherit) !important;</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineplus">+  }</span>
<a href="#l14.77"></a><span id="l14.77" class="difflineplus">+}</span>
<a href="#l14.78"></a><span id="l14.78" class="difflineplus">+</span>
<a href="#l14.79"></a><span id="l14.79"> #attachmentBucket {</span>
<a href="#l14.80"></a><span id="l14.80">   width: 15em;</span>
<a href="#l14.81"></a><span id="l14.81">   min-width: 15em;</span>
<a href="#l14.82"></a><span id="l14.82"> }</span>
<a href="#l14.83"></a><span id="l14.83"> </span>
<a href="#l14.84"></a><span id="l14.84"> #attachmentBucket &gt; scrollbox &gt; .scrollbox-innerbox {</span>
<a href="#l14.85"></a><span id="l14.85">   padding: 1px;</span>
<a href="#l14.86"></a><span id="l14.86"> }</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

