<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 6412:200dcbfaafff4404f69e944807f8c3268e15ef02</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 200dcbfaafff4404f69e944807f8c3268e15ef02" />
<meta property="og:url" content="/comm-central/rev/200dcbfaafff4404f69e944807f8c3268e15ef02" />
<meta property="og:description" content="Fix bug 350174 - Task list doesn't support displaying and editing of occurrences of repeating tasks. r=philipp,ui-r=andreasn" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 200dcbfaafff4404f69e944807f8c3268e15ef02 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/200dcbfaafff4404f69e944807f8c3268e15ef02">shortlog</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/200dcbfaafff4404f69e944807f8c3268e15ef02">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02">files</a> |
changeset |
<a href="/comm-central/raw-rev/200dcbfaafff4404f69e944807f8c3268e15ef02">raw</a>  | <a href="/comm-central/archive/200dcbfaafff4404f69e944807f8c3268e15ef02.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
Fix <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=350174">bug 350174</a> - Task list doesn't support displaying and editing of occurrences of repeating tasks. r=philipp,ui-r=andreasn
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#77;&#97;&#116;&#116;&#104;&#101;&#119;&#32;&#77;&#101;&#99;&#99;&#97;&#32;&#60;&#109;&#97;&#116;&#116;&#104;&#101;&#119;&#46;&#109;&#101;&#99;&#99;&#97;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Wed, 15 Sep 2010 17:31:00 +0200</td></tr>

<tr>
 <td>changeset 6412</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/200dcbfaafff4404f69e944807f8c3268e15ef02">200dcbfaafff4404f69e944807f8c3268e15ef02</a></td>
</tr>



<tr>
<td>parent 6411</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/bf7ef020ee97250a57a2c8d3b0c01a920e5aa672">bf7ef020ee97250a57a2c8d3b0c01a920e5aa672</a>
</td>
</tr>

<tr>
<td>child 6413</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/efbf61196fb5f9a2127ddfe804eb18f8855f7796">efbf61196fb5f9a2127ddfe804eb18f8855f7796</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=200dcbfaafff4404f69e944807f8c3268e15ef02">4951</a></td></tr>
<tr><td>push user</td><td>mozilla@kewis.ch</td></tr>
<tr><td>push date</td><td class="date age">Thu, 23 Sep 2010 19:57:24 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@200dcbfaafff [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=200dcbfaafff4404f69e944807f8c3268e15ef02">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=200dcbfaafff4404f69e944807f8c3268e15ef02&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=200dcbfaafff4404f69e944807f8c3268e15ef02&newProject=comm-central&newRevision=200dcbfaafff4404f69e944807f8c3268e15ef02&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=200dcbfaafff4404f69e944807f8c3268e15ef02&newProject=comm-central&newRevision=200dcbfaafff4404f69e944807f8c3268e15ef02&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=200dcbfaafff4404f69e944807f8c3268e15ef02&newProject=comm-central&newRevision=200dcbfaafff4404f69e944807f8c3268e15ef02&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28philipp%29&revcount=50">philipp</a>, <a href="/comm-central/log?rev=reviewer%28andreasn%29&revcount=50">andreasn</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=350174">350174</a></td></tr>




</table></div>

<div class="page_body description">Fix <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=350174">bug 350174</a> - Task list doesn't support displaying and editing of occurrences of repeating tasks. r=philipp,ui-r=andreasn</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-chrome-startup.js">calendar/base/content/calendar-chrome-startup.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-chrome-startup.js">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-chrome-startup.js">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-chrome-startup.js">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-chrome-startup.js">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-chrome-startup.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-common-sets.js">calendar/base/content/calendar-common-sets.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-common-sets.js">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-common-sets.js">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-common-sets.js">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-common-sets.js">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-common-sets.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-tree.xml">calendar/base/content/calendar-task-tree.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-tree.xml">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-tree.xml">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-tree.xml">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-tree.xml">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-tree.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-view.js">calendar/base/content/calendar-task-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-view.js">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-view.js">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-view.js">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-view.js">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-task-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.js">calendar/base/content/calendar-unifinder-todo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.js">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.js">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.js">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.js">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.xul">calendar/base/content/calendar-unifinder-todo.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.xul">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.xul">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.xul">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.xul">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/calendar-unifinder-todo.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/today-pane.js">calendar/base/content/today-pane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/today-pane.js">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/today-pane.js">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/today-pane.js">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/today-pane.js">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/content/today-pane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calFilter.js">calendar/base/src/calFilter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calFilter.js">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calFilter.js">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calFilter.js">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calFilter.js">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calFilter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calUtils.js">calendar/base/src/calUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calUtils.js">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calUtils.js">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calUtils.js">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calUtils.js">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/src/calUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/themes/common/calendar-task-tree.css">calendar/base/themes/common/calendar-task-tree.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/themes/common/calendar-task-tree.css">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/themes/common/calendar-task-tree.css">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/themes/common/calendar-task-tree.css">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/themes/common/calendar-task-tree.css">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/base/themes/common/calendar-task-tree.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/lightning/content/messenger-overlay-sidebar.xul">calendar/lightning/content/messenger-overlay-sidebar.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/lightning/content/messenger-overlay-sidebar.xul">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/lightning/content/messenger-overlay-sidebar.xul">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/lightning/content/messenger-overlay-sidebar.xul">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/lightning/content/messenger-overlay-sidebar.xul">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/lightning/content/messenger-overlay-sidebar.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/calendar.dtd">calendar/locales/en-US/chrome/calendar/calendar.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/calendar.dtd">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/calendar.dtd">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/calendar.dtd">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/calendar.dtd">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/calendar.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/dateFormat.properties">calendar/locales/en-US/chrome/calendar/dateFormat.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/dateFormat.properties">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/dateFormat.properties">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/dateFormat.properties">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/dateFormat.properties">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/locales/en-US/chrome/calendar/dateFormat.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/providers/memory/calMemoryCalendar.js">calendar/providers/memory/calMemoryCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/providers/memory/calMemoryCalendar.js">file</a> |
<a href="/comm-central/annotate/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/providers/memory/calMemoryCalendar.js">annotate</a> |
<a href="/comm-central/diff/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/providers/memory/calMemoryCalendar.js">diff</a> |
<a href="/comm-central/comparison/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/providers/memory/calMemoryCalendar.js">comparison</a> |
<a href="/comm-central/log/200dcbfaafff4404f69e944807f8c3268e15ef02/calendar/providers/memory/calMemoryCalendar.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/calendar-chrome-startup.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/calendar-chrome-startup.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -71,16 +71,19 @@ function commonInitCalendar() {</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5"> /**</span>
<a href="#l1.6"></a><span id="l1.6">  * Common unload steps for calendar chrome windows.</span>
<a href="#l1.7"></a><span id="l1.7">  */</span>
<a href="#l1.8"></a><span id="l1.8"> function commonFinishCalendar() {</span>
<a href="#l1.9"></a><span id="l1.9">     // Unload the calendar manager</span>
<a href="#l1.10"></a><span id="l1.10">     unloadCalendarManager();</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+    // clean up the unifinder</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    finishCalendarToDoUnifinder();</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+</span>
<a href="#l1.15"></a><span id="l1.15">     // Remove the command controller</span>
<a href="#l1.16"></a><span id="l1.16">     removeCalendarCommandController();</span>
<a href="#l1.17"></a><span id="l1.17"> </span>
<a href="#l1.18"></a><span id="l1.18">     document.getElementById(&quot;calsidebar_splitter&quot;).removeEventListener(&quot;command&quot;, onCalendarViewResize, false);</span>
<a href="#l1.19"></a><span id="l1.19">     window.removeEventListener(&quot;resize&quot;, onCalendarViewResize, true);</span>
<a href="#l1.20"></a><span id="l1.20"> </span>
<a href="#l1.21"></a><span id="l1.21">     // Clean up the category colors</span>
<a href="#l1.22"></a><span id="l1.22">     categoryManagement.cleanupCategories();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/calendar-common-sets.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/calendar-common-sets.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -765,14 +765,18 @@ function setupContextItemType(event, ite</span>
<a href="#l2.4"></a><span id="l2.4">  * Shows the given date in the current view, if in calendar mode.</span>
<a href="#l2.5"></a><span id="l2.5">  *</span>
<a href="#l2.6"></a><span id="l2.6">  * XXX This function is misplaced, should go to calendar-views.js or a minimonth</span>
<a href="#l2.7"></a><span id="l2.7">  * specific js file.</span>
<a href="#l2.8"></a><span id="l2.8">  *</span>
<a href="#l2.9"></a><span id="l2.9">  * @param aNewDate      The new date as a JSDate.</span>
<a href="#l2.10"></a><span id="l2.10">  */</span>
<a href="#l2.11"></a><span id="l2.11"> function minimonthPick(aNewDate) {</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-  if (isSunbird() || gCurrentMode == &quot;calendar&quot;) {</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+  if (cal.isSunbird() || gCurrentMode == &quot;calendar&quot; || gCurrentMode == &quot;task&quot;) {</span>
<a href="#l2.14"></a><span id="l2.14">       let cdt = jsDateToDateTime(aNewDate, currentView().timezone);</span>
<a href="#l2.15"></a><span id="l2.15">       cdt.isDate = true;</span>
<a href="#l2.16"></a><span id="l2.16">       currentView().goToDay(cdt);</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+      // update date filter for task tree</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+      let tree = document.getElementById(cal.isSunbird() ? &quot;unifinder-todo-tree&quot; : &quot;calendar-task-tree&quot;);</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+      tree.updateFilter();</span>
<a href="#l2.21"></a><span id="l2.21">   }</span>
<a href="#l2.22"></a><span id="l2.22"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -243,16 +243,17 @@</span>
<a href="#l3.4"></a><span id="l3.4">       &lt;field name=&quot;mTaskArray&quot;&gt;[]&lt;/field&gt;</span>
<a href="#l3.5"></a><span id="l3.5">       &lt;field name=&quot;mHash2Index&quot;&gt;&lt;![CDATA[({})]]&gt;&lt;/field&gt;</span>
<a href="#l3.6"></a><span id="l3.6">       &lt;field name=&quot;mRefreshQueue&quot;&gt;[]&lt;/field&gt;</span>
<a href="#l3.7"></a><span id="l3.7">       &lt;field name=&quot;mPendingRefresh&quot;&gt;null&lt;/field&gt;</span>
<a href="#l3.8"></a><span id="l3.8">       &lt;field name=&quot;mShowCompletedTasks&quot;&gt;true&lt;/field&gt;</span>
<a href="#l3.9"></a><span id="l3.9">       &lt;field name=&quot;mFilter&quot;&gt;null&lt;/field&gt;</span>
<a href="#l3.10"></a><span id="l3.10">       &lt;field name=&quot;mStartDate&quot;&gt;null&lt;/field&gt;</span>
<a href="#l3.11"></a><span id="l3.11">       &lt;field name=&quot;mEndDate&quot;&gt;null&lt;/field&gt;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+      &lt;field name=&quot;mDateRangeFilter&quot;&gt;null&lt;/field&gt;</span>
<a href="#l3.13"></a><span id="l3.13"> </span>
<a href="#l3.14"></a><span id="l3.14">       &lt;property name=&quot;currentIndex&quot;&gt;</span>
<a href="#l3.15"></a><span id="l3.15">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l3.16"></a><span id="l3.16">           var tree = document.getAnonymousElementByAttribute(</span>
<a href="#l3.17"></a><span id="l3.17">               this, &quot;anonid&quot;, &quot;calendar-task-tree&quot;);</span>
<a href="#l3.18"></a><span id="l3.18">           return tree.currentIndex;</span>
<a href="#l3.19"></a><span id="l3.19">         ]]&gt;&lt;/getter&gt;</span>
<a href="#l3.20"></a><span id="l3.20">       &lt;/property&gt;</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineat">@@ -521,18 +522,21 @@</span>
<a href="#l3.22"></a><span id="l3.22">                         .map(getAtomFromService)</span>
<a href="#l3.23"></a><span id="l3.23">                         .forEach(aProps.AppendElement, aProps);</span>
<a href="#l3.24"></a><span id="l3.24">           },</span>
<a href="#l3.25"></a><span id="l3.25"> </span>
<a href="#l3.26"></a><span id="l3.26">           // Called on the view when a cell in a non-selectable cycling</span>
<a href="#l3.27"></a><span id="l3.27">           // column (e.g., unread/flag/etc.) is clicked.</span>
<a href="#l3.28"></a><span id="l3.28">           cycleCell: function mTV_cycleCell(aRow, aCol) {</span>
<a href="#l3.29"></a><span id="l3.29">               var task = this.binding.mTaskArray[aRow];</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-              if(!task)</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+              // prevent toggling completed status for parent items of repeating tasks</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+              if (!task || task.recurrenceInfo) {</span>
<a href="#l3.34"></a><span id="l3.34">                   return;</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+              }</span>
<a href="#l3.36"></a><span id="l3.36">               if (aCol != null) {</span>
<a href="#l3.37"></a><span id="l3.37">                   var content = aCol.element.getAttribute(&quot;itemproperty&quot;);</span>
<a href="#l3.38"></a><span id="l3.38">                   if (content == &quot;completed&quot;)  {</span>
<a href="#l3.39"></a><span id="l3.39">                       var newTask = task.clone().QueryInterface(Components.interfaces.calITodo);</span>
<a href="#l3.40"></a><span id="l3.40">                       newTask.isCompleted = !task.completedDate;</span>
<a href="#l3.41"></a><span id="l3.41">                       doTransaction('modify', newTask, newTask.calendar, task, null);</span>
<a href="#l3.42"></a><span id="l3.42">                   }</span>
<a href="#l3.43"></a><span id="l3.43">               }</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineat">@@ -568,21 +572,21 @@</span>
<a href="#l3.45"></a><span id="l3.45">               var task = this.binding.mTaskArray[aRow];</span>
<a href="#l3.46"></a><span id="l3.46">               if (!task)</span>
<a href="#l3.47"></a><span id="l3.47">                   return false;</span>
<a href="#l3.48"></a><span id="l3.48">               switch (aCol.element.getAttribute(&quot;itemproperty&quot;)) {</span>
<a href="#l3.49"></a><span id="l3.49">                   case &quot;title&quot;:</span>
<a href="#l3.50"></a><span id="l3.50">                       // return title, or &quot;Untitled&quot; if empty/null</span>
<a href="#l3.51"></a><span id="l3.51">                       return (task.title ? task.title.replace(/\n/g, ' ') : calGetString(&quot;calendar&quot;, &quot;eventUntitled&quot;));</span>
<a href="#l3.52"></a><span id="l3.52">                   case &quot;entryDate&quot;:</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineminus">-                      return this._formatDateTime(task.entryDate);</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineplus">+                      return task.recurrenceInfo ? calGetString(&quot;dateFormat&quot;, &quot;Repeating&quot;) : this._formatDateTime(task.entryDate);</span>
<a href="#l3.55"></a><span id="l3.55">                   case &quot;dueDate&quot;:</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineminus">-                      return this._formatDateTime(task.dueDate);</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineplus">+                      return task.recurrenceInfo ? calGetString(&quot;dateFormat&quot;, &quot;Repeating&quot;) : this._formatDateTime(task.dueDate);</span>
<a href="#l3.58"></a><span id="l3.58">                   case &quot;completedDate&quot;:</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-                      return this._formatDateTime(task.completedDate);</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineplus">+                      return task.recurrenceInfo ? calGetString(&quot;dateFormat&quot;, &quot;Repeating&quot;) : this._formatDateTime(task.completedDate);</span>
<a href="#l3.61"></a><span id="l3.61">                   case &quot;percentComplete&quot;:</span>
<a href="#l3.62"></a><span id="l3.62">                       return (task.percentComplete &gt; 0 ? task.percentComplete + &quot;%&quot; : &quot;&quot;);</span>
<a href="#l3.63"></a><span id="l3.63">                   case &quot;categories&quot;:</span>
<a href="#l3.64"></a><span id="l3.64">                       return task.getCategories({}).join(&quot;, &quot;); // TODO l10n-unfriendly</span>
<a href="#l3.65"></a><span id="l3.65">                   case &quot;location&quot;:</span>
<a href="#l3.66"></a><span id="l3.66">                       return task.getProperty(&quot;LOCATION&quot;);</span>
<a href="#l3.67"></a><span id="l3.67">                   case &quot;status&quot;:</span>
<a href="#l3.68"></a><span id="l3.68">                       return getToDoStatusString(task);</span>
<a href="#l3.69"></a><span id="l3.69" class="difflineat">@@ -826,39 +830,70 @@</span>
<a href="#l3.70"></a><span id="l3.70">           onLoad: function tTO_onLoad() {</span>
<a href="#l3.71"></a><span id="l3.71">               if (this.mBatchCount == 0) {</span>
<a href="#l3.72"></a><span id="l3.72">                   this.binding.refresh();</span>
<a href="#l3.73"></a><span id="l3.73">               }</span>
<a href="#l3.74"></a><span id="l3.74">           },</span>
<a href="#l3.75"></a><span id="l3.75"> </span>
<a href="#l3.76"></a><span id="l3.76">           onAddItem: function tTO_onAddItem(aItem) {</span>
<a href="#l3.77"></a><span id="l3.77">               if (cal.isToDo(aItem) &amp;&amp;</span>
<a href="#l3.78"></a><span id="l3.78" class="difflineminus">-                  this.binding.mFilter.isItemInFilters(aItem) &amp;&amp;</span>
<a href="#l3.79"></a><span id="l3.79">                   !this.mBatchCount) { </span>
<a href="#l3.80"></a><span id="l3.80" class="difflineminus">-                  this.binding.mTreeView.addItem(aItem);</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineplus">+</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineplus">+                  // get occurrences of repeating items</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineplus">+                  let occs;</span>
<a href="#l3.84"></a><span id="l3.84" class="difflineplus">+                  if (this.binding.mFilter.endDate) {</span>
<a href="#l3.85"></a><span id="l3.85" class="difflineplus">+                      occs = aItem.getOccurrencesBetween(this.binding.mFilter.startDate,</span>
<a href="#l3.86"></a><span id="l3.86" class="difflineplus">+                                                         this.binding.mFilter.endDate,</span>
<a href="#l3.87"></a><span id="l3.87" class="difflineplus">+                                                         {});</span>
<a href="#l3.88"></a><span id="l3.88" class="difflineplus">+                  } else {</span>
<a href="#l3.89"></a><span id="l3.89" class="difflineplus">+                      occs = [aItem];</span>
<a href="#l3.90"></a><span id="l3.90" class="difflineplus">+                  }</span>
<a href="#l3.91"></a><span id="l3.91" class="difflineplus">+                  for each (let occ in occs) {</span>
<a href="#l3.92"></a><span id="l3.92" class="difflineplus">+                      if (this.binding.mFilter.isItemInFilters(occ)) {</span>
<a href="#l3.93"></a><span id="l3.93" class="difflineplus">+                          this.binding.mTreeView.addItem(occ);</span>
<a href="#l3.94"></a><span id="l3.94" class="difflineplus">+                      }</span>
<a href="#l3.95"></a><span id="l3.95" class="difflineplus">+                  }</span>
<a href="#l3.96"></a><span id="l3.96">               }</span>
<a href="#l3.97"></a><span id="l3.97">           },</span>
<a href="#l3.98"></a><span id="l3.98"> </span>
<a href="#l3.99"></a><span id="l3.99">           onModifyItem: function tTO_onModifyItem(aNewItem, aOldItem) {</span>
<a href="#l3.100"></a><span id="l3.100">               if ((cal.isToDo(aNewItem) || cal.isToDo(aOldItem))</span>
<a href="#l3.101"></a><span id="l3.101">                   &amp;&amp; !this.mBatchCount) {</span>
<a href="#l3.102"></a><span id="l3.102" class="difflineminus">-                  // forward the call to the view which will in turn</span>
<a href="#l3.103"></a><span id="l3.103" class="difflineminus">-                  // update the internal reference and the view.</span>
<a href="#l3.104"></a><span id="l3.104" class="difflineminus">-                  this.binding.mTreeView.modifyItem(aNewItem, aOldItem);</span>
<a href="#l3.105"></a><span id="l3.105" class="difflineplus">+</span>
<a href="#l3.106"></a><span id="l3.106" class="difflineplus">+                  if ((this.binding.mFilter.endDate) &amp;&amp;</span>
<a href="#l3.107"></a><span id="l3.107" class="difflineplus">+                      (aOldItem.recurrenceInfo || aNewItem.recurrenceInfo)) {</span>
<a href="#l3.108"></a><span id="l3.108" class="difflineplus">+</span>
<a href="#l3.109"></a><span id="l3.109" class="difflineplus">+                      // if item is repeating refresh to updated all modified occurrences</span>
<a href="#l3.110"></a><span id="l3.110" class="difflineplus">+                      this.binding.refresh();</span>
<a href="#l3.111"></a><span id="l3.111" class="difflineplus">+                  } else {</span>
<a href="#l3.112"></a><span id="l3.112" class="difflineplus">+                      // forward the call to the view which will in turn</span>
<a href="#l3.113"></a><span id="l3.113" class="difflineplus">+                      // update the internal reference and the view.</span>
<a href="#l3.114"></a><span id="l3.114" class="difflineplus">+                      this.binding.mTreeView.modifyItem(aNewItem, aOldItem);</span>
<a href="#l3.115"></a><span id="l3.115" class="difflineplus">+                  }</span>
<a href="#l3.116"></a><span id="l3.116"> </span>
<a href="#l3.117"></a><span id="l3.117">                   // we also need to notify potential listeners.</span>
<a href="#l3.118"></a><span id="l3.118">                   var event = document.createEvent('Events');</span>
<a href="#l3.119"></a><span id="l3.119">                   event.initEvent('select', true, false);</span>
<a href="#l3.120"></a><span id="l3.120">                   this.binding.dispatchEvent(event);</span>
<a href="#l3.121"></a><span id="l3.121">               }</span>
<a href="#l3.122"></a><span id="l3.122">           },</span>
<a href="#l3.123"></a><span id="l3.123"> </span>
<a href="#l3.124"></a><span id="l3.124">           onDeleteItem: function tTO_onDeleteItem(aDeletedItem) {</span>
<a href="#l3.125"></a><span id="l3.125">               if (cal.isToDo(aDeletedItem) &amp;&amp; !this.mBatchCount) {</span>
<a href="#l3.126"></a><span id="l3.126" class="difflineminus">-                  this.binding.mTreeView.removeItem(aDeletedItem);</span>
<a href="#l3.127"></a><span id="l3.127" class="difflineplus">+</span>
<a href="#l3.128"></a><span id="l3.128" class="difflineplus">+                  // get occurrences of repeating items</span>
<a href="#l3.129"></a><span id="l3.129" class="difflineplus">+                  let occs;</span>
<a href="#l3.130"></a><span id="l3.130" class="difflineplus">+                  if (this.binding.mFilter.endDate) {</span>
<a href="#l3.131"></a><span id="l3.131" class="difflineplus">+                      occs = aDeletedItem.getOccurrencesBetween(this.binding.mFilter.startDate,</span>
<a href="#l3.132"></a><span id="l3.132" class="difflineplus">+                                                                this.binding.mFilter.endDate,</span>
<a href="#l3.133"></a><span id="l3.133" class="difflineplus">+                                                                {});</span>
<a href="#l3.134"></a><span id="l3.134" class="difflineplus">+                  } else {</span>
<a href="#l3.135"></a><span id="l3.135" class="difflineplus">+                      occs = [aDeletedItem];</span>
<a href="#l3.136"></a><span id="l3.136" class="difflineplus">+                  }</span>
<a href="#l3.137"></a><span id="l3.137" class="difflineplus">+                  occs.forEach(this.binding.mTreeView.removeItem, this.binding.mTreeView);</span>
<a href="#l3.138"></a><span id="l3.138">               }</span>
<a href="#l3.139"></a><span id="l3.139">           },</span>
<a href="#l3.140"></a><span id="l3.140"> </span>
<a href="#l3.141"></a><span id="l3.141">           onError: function tTO_onError(aCalendar, aErrNo, aMessage) {},</span>
<a href="#l3.142"></a><span id="l3.142">           onPropertyChanged: function tTO_onPropertyChanged(aCalendar, aName, aValue, aOldValue) {</span>
<a href="#l3.143"></a><span id="l3.143">               switch (aName) {</span>
<a href="#l3.144"></a><span id="l3.144">                   case &quot;disabled&quot;:</span>
<a href="#l3.145"></a><span id="l3.145">                       if (aValue) {</span>
<a href="#l3.146"></a><span id="l3.146" class="difflineat">@@ -939,17 +974,17 @@</span>
<a href="#l3.147"></a><span id="l3.147"> </span>
<a href="#l3.148"></a><span id="l3.148">           var refreshJob = {</span>
<a href="#l3.149"></a><span id="l3.149">               execute: function() {</span>
<a href="#l3.150"></a><span id="l3.150">                   var filter = aFilter || !savedThis.mShowCompletedTasks ?</span>
<a href="#l3.151"></a><span id="l3.151">                       aCalendar.ITEM_FILTER_COMPLETED_NO :</span>
<a href="#l3.152"></a><span id="l3.152">                       aCalendar.ITEM_FILTER_COMPLETED_ALL;</span>
<a href="#l3.153"></a><span id="l3.153">                   filter |= aCalendar.ITEM_FILTER_TYPE_TODO;</span>
<a href="#l3.154"></a><span id="l3.154"> </span>
<a href="#l3.155"></a><span id="l3.155" class="difflineminus">-                  if (savedThis.mFilter.startDate &amp;&amp; savedThis.mFilter.endDate) {</span>
<a href="#l3.156"></a><span id="l3.156" class="difflineplus">+                  if (savedThis.mFilter.endDate) {</span>
<a href="#l3.157"></a><span id="l3.157">                       filter |= aCalendar.ITEM_FILTER_CLASS_OCCURRENCES;</span>
<a href="#l3.158"></a><span id="l3.158">                   }</span>
<a href="#l3.159"></a><span id="l3.159">                   aCalendar.getItems(filter,</span>
<a href="#l3.160"></a><span id="l3.160">                                      0,</span>
<a href="#l3.161"></a><span id="l3.161">                                      savedThis.mFilter.startDate,</span>
<a href="#l3.162"></a><span id="l3.162">                                      savedThis.mFilter.endDate,</span>
<a href="#l3.163"></a><span id="l3.163">                                      refreshListener);</span>
<a href="#l3.164"></a><span id="l3.164">               }</span>
<a href="#l3.165"></a><span id="l3.165" class="difflineat">@@ -1076,16 +1111,36 @@</span>
<a href="#l3.166"></a><span id="l3.166">       &lt;/method&gt;</span>
<a href="#l3.167"></a><span id="l3.167"> </span>
<a href="#l3.168"></a><span id="l3.168">       &lt;method name=&quot;getInitialDate&quot;&gt;</span>
<a href="#l3.169"></a><span id="l3.169">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.170"></a><span id="l3.170">           let initialDate = currentView().selectedDay;</span>
<a href="#l3.171"></a><span id="l3.171">           return initialDate ? initialDate : now();</span>
<a href="#l3.172"></a><span id="l3.172">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.173"></a><span id="l3.173">       &lt;/method&gt;</span>
<a href="#l3.174"></a><span id="l3.174" class="difflineplus">+</span>
<a href="#l3.175"></a><span id="l3.175" class="difflineplus">+      &lt;method name=&quot;updateFilter&quot;&gt;</span>
<a href="#l3.176"></a><span id="l3.176" class="difflineplus">+        &lt;parameter name=&quot;aFilter&quot;/&gt;</span>
<a href="#l3.177"></a><span id="l3.177" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.178"></a><span id="l3.178" class="difflineplus">+            this.mFilter.propertyFilter = aFilter || this.mFilter.propertyFilter || &quot;all&quot;;</span>
<a href="#l3.179"></a><span id="l3.179" class="difflineplus">+            this.mDateRangeFilter = aFilter || this.mDateRangeFilter;</span>
<a href="#l3.180"></a><span id="l3.180" class="difflineplus">+            if (this.mDateRangeFilter) {</span>
<a href="#l3.181"></a><span id="l3.181" class="difflineplus">+                this.mFilter.setDateFilter(this.mDateRangeFilter);</span>
<a href="#l3.182"></a><span id="l3.182" class="difflineplus">+            } else {</span>
<a href="#l3.183"></a><span id="l3.183" class="difflineplus">+                let oneDay = cal.createDuration();</span>
<a href="#l3.184"></a><span id="l3.184" class="difflineplus">+                oneDay.days = 1;</span>
<a href="#l3.185"></a><span id="l3.185" class="difflineplus">+                this.mFilter.startDate = cal.createDateTime();</span>
<a href="#l3.186"></a><span id="l3.186" class="difflineplus">+                this.mFilter.endDate = this.getInitialDate().clone();</span>
<a href="#l3.187"></a><span id="l3.187" class="difflineplus">+                this.mFilter.endDate.addDuration(oneDay);</span>
<a href="#l3.188"></a><span id="l3.188" class="difflineplus">+            }</span>
<a href="#l3.189"></a><span id="l3.189" class="difflineplus">+</span>
<a href="#l3.190"></a><span id="l3.190" class="difflineplus">+            this.refresh();</span>
<a href="#l3.191"></a><span id="l3.191" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l3.192"></a><span id="l3.192" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l3.193"></a><span id="l3.193" class="difflineplus">+</span>
<a href="#l3.194"></a><span id="l3.194">     &lt;/implementation&gt;</span>
<a href="#l3.195"></a><span id="l3.195"> </span>
<a href="#l3.196"></a><span id="l3.196">     &lt;handlers&gt;</span>
<a href="#l3.197"></a><span id="l3.197">       &lt;handler event=&quot;select&quot;&gt;&lt;![CDATA[</span>
<a href="#l3.198"></a><span id="l3.198">         this.mTreeView.onSelect(event);</span>
<a href="#l3.199"></a><span id="l3.199">         calendarController.onSelectionChanged({detail:this.selectedTasks});</span>
<a href="#l3.200"></a><span id="l3.200">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l3.201"></a><span id="l3.201">       &lt;handler event=&quot;dblclick&quot; button=&quot;0&quot;&gt;&lt;![CDATA[</span>
<a href="#l3.202"></a><span id="l3.202" class="difflineat">@@ -1150,15 +1205,15 @@</span>
<a href="#l3.203"></a><span id="l3.203">     &lt;/handlers&gt;</span>
<a href="#l3.204"></a><span id="l3.204"> </span>
<a href="#l3.205"></a><span id="l3.205">   &lt;/binding&gt;</span>
<a href="#l3.206"></a><span id="l3.206"> </span>
<a href="#l3.207"></a><span id="l3.207">   &lt;binding id=&quot;calendar-task-tree-todaypane&quot; extends=&quot;chrome://calendar/content/calendar-task-tree.xml#calendar-task-tree&quot;&gt;</span>
<a href="#l3.208"></a><span id="l3.208">     &lt;implementation&gt;</span>
<a href="#l3.209"></a><span id="l3.209">       &lt;method name=&quot;getInitialDate&quot;&gt;</span>
<a href="#l3.210"></a><span id="l3.210">             &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.211"></a><span id="l3.211" class="difflineminus">-              let initialDate = agendaListbox.today.start;</span>
<a href="#l3.212"></a><span id="l3.212" class="difflineplus">+              let initialDate = agendaListbox.today ? agendaListbox.today.start : now();</span>
<a href="#l3.213"></a><span id="l3.213">               return initialDate ? initialDate : now();</span>
<a href="#l3.214"></a><span id="l3.214">             ]]&gt;&lt;/body&gt;</span>
<a href="#l3.215"></a><span id="l3.215">       &lt;/method&gt;</span>
<a href="#l3.216"></a><span id="l3.216">     &lt;/implementation&gt;    </span>
<a href="#l3.217"></a><span id="l3.217">   &lt;/binding&gt;</span>
<a href="#l3.218"></a><span id="l3.218"> &lt;/bindings&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-task-view.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-view.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -182,21 +182,18 @@ var taskDetailsView = {</span>
<a href="#l4.4"></a><span id="l4.4">  *</span>
<a href="#l4.5"></a><span id="l4.5">  * @param filter        The filter name to set.</span>
<a href="#l4.6"></a><span id="l4.6">  */</span>
<a href="#l4.7"></a><span id="l4.7"> function taskViewUpdate(filter) {</span>
<a href="#l4.8"></a><span id="l4.8">     document.getElementById(&quot;filterBroadcaster&quot;).setAttribute(&quot;value&quot;, filter);</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10">     var tree = document.getElementById(&quot;calendar-task-tree&quot;);</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-    // set the filters</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-    tree.mFilter.propertyFilter  = filter;</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-    tree.mFilter.setDateFilter(filter);</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">-    tree.refresh();</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+    // update the filter</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+    tree.updateFilter(filter || &quot;all&quot;);</span>
<a href="#l4.19"></a><span id="l4.19"> }</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21"> /**</span>
<a href="#l4.22"></a><span id="l4.22">  * Prepares a dialog to send an email to the organizer of the currently selected</span>
<a href="#l4.23"></a><span id="l4.23">  * task in the task view.</span>
<a href="#l4.24"></a><span id="l4.24">  *</span>
<a href="#l4.25"></a><span id="l4.25">  * XXX We already have a function with this name in the event dialog. Either</span>
<a href="#l4.26"></a><span id="l4.26">  * consolidate or make name more clear.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/calendar-unifinder-todo.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/calendar-unifinder-todo.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -45,21 +45,35 @@</span>
<a href="#l5.4"></a><span id="l5.4"> </span>
<a href="#l5.5"></a><span id="l5.5"> /**</span>
<a href="#l5.6"></a><span id="l5.6">  * Called when the window is loaded to set up the unifinder-todo.</span>
<a href="#l5.7"></a><span id="l5.7">  */</span>
<a href="#l5.8"></a><span id="l5.8"> function prepareCalendarToDoUnifinder() {</span>
<a href="#l5.9"></a><span id="l5.9">     if (isSunbird()) {</span>
<a href="#l5.10"></a><span id="l5.10">         document.getElementById(&quot;todo-label&quot;).removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l5.11"></a><span id="l5.11">     }</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-    updateShowCompleted();</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+    // add listener to update the date filters</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+    getViewDeck().addEventListener(&quot;dayselect&quot;, updateCalendarToDoUnifinder, false);</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+    updateCalendarToDoUnifinder();</span>
<a href="#l5.18"></a><span id="l5.18"> }</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20"> /**</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineminus">- * Handler function to update the show completed view in the unifinder todo.</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+ * Updates the applied filter and show completed view of the unifinder todo.</span>
<a href="#l5.23"></a><span id="l5.23">  */</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineminus">-function updateShowCompleted() {</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+function updateCalendarToDoUnifinder() {</span>
<a href="#l5.26"></a><span id="l5.26">     // Set up hiding completed tasks for the unifinder-todo tree</span>
<a href="#l5.27"></a><span id="l5.27">     var showCompleted = document.getElementById(&quot;show-completed-checkbox&quot;).checked;</span>
<a href="#l5.28"></a><span id="l5.28">     var tree = document.getElementById(&quot;unifinder-todo-tree&quot;);</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+    // update the filter</span>
<a href="#l5.31"></a><span id="l5.31">     tree.showCompleted = showCompleted;</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineminus">-    tree.refresh();</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+    tree.updateFilter();</span>
<a href="#l5.34"></a><span id="l5.34"> }</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+/**</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+ * Called when the window is unloaded to clean up the unifinder-todo.</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+ */</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+function finishCalendarToDoUnifinder() {</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+    // remove listeners</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+    getViewDeck().removeEventListener(&quot;dayselect&quot;, updateCalendarToDoUnifinder, false);</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+}</span>
<a href="#l5.43"></a><span id="l5.43">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/calendar-unifinder-todo.xul</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/calendar-unifinder-todo.xul</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -58,17 +58,17 @@</span>
<a href="#l6.4"></a><span id="l6.4">     &lt;box id=&quot;todo-label&quot; align=&quot;left&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l6.5"></a><span id="l6.5">       &lt;label flex=&quot;1&quot; crop=&quot;end&quot; style=&quot;font-weight: bold&quot; value=&quot;&amp;calendar.unifinder.todoitems.label;&quot; control=&quot;unifinder-todo-tree&quot;/&gt;</span>
<a href="#l6.6"></a><span id="l6.6">     &lt;/box&gt;</span>
<a href="#l6.7"></a><span id="l6.7">     &lt;box align=&quot;center&quot;&gt;</span>
<a href="#l6.8"></a><span id="l6.8">       &lt;checkbox id=&quot;show-completed-checkbox&quot;</span>
<a href="#l6.9"></a><span id="l6.9">                 label=&quot;&amp;calendar.unifinder.showcompletedtodos.label;&quot;</span>
<a href="#l6.10"></a><span id="l6.10">                 flex=&quot;1&quot;</span>
<a href="#l6.11"></a><span id="l6.11">                 crop=&quot;end&quot;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-                oncommand=&quot;updateShowCompleted()&quot;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+                oncommand=&quot;updateCalendarToDoUnifinder()&quot;</span>
<a href="#l6.14"></a><span id="l6.14">                 persist=&quot;checked&quot;/&gt;</span>
<a href="#l6.15"></a><span id="l6.15">     &lt;/box&gt;</span>
<a href="#l6.16"></a><span id="l6.16">     &lt;vbox id=&quot;calendar-task-tree-detail&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l6.17"></a><span id="l6.17">       &lt;calendar-task-tree id=&quot;unifinder-todo-tree&quot; flex=&quot;1&quot;</span>
<a href="#l6.18"></a><span id="l6.18">                           visible-columns=&quot;completed priority title&quot;</span>
<a href="#l6.19"></a><span id="l6.19">                           persist=&quot;visible-columns ordinals widths sort-active sort-direction&quot;</span>
<a href="#l6.20"></a><span id="l6.20">                           context=&quot;taskitem-context-menu&quot;/&gt;</span>
<a href="#l6.21"></a><span id="l6.21">       &lt;textbox id=&quot;unifinder-task-edit-field&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/today-pane.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/today-pane.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -250,17 +250,18 @@ var TodayPane = {</span>
<a href="#l7.4"></a><span id="l7.4">         return (cal.sameDay(cal.now(), this.start));</span>
<a href="#l7.5"></a><span id="l7.5">     },</span>
<a href="#l7.6"></a><span id="l7.6"> </span>
<a href="#l7.7"></a><span id="l7.7">     /**</span>
<a href="#l7.8"></a><span id="l7.8">      * Update the period headers in the agenda listbox using the today pane's</span>
<a href="#l7.9"></a><span id="l7.9">      * start date.</span>
<a href="#l7.10"></a><span id="l7.10">      */</span>
<a href="#l7.11"></a><span id="l7.11">     updatePeriod: function updatePeriod() {</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-        return agendaListbox.refreshPeriodDates(this.start.clone());</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+        agendaListbox.refreshPeriodDates(this.start.clone());</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+        updateCalendarToDoUnifinder();</span>
<a href="#l7.15"></a><span id="l7.15">     },</span>
<a href="#l7.16"></a><span id="l7.16"> </span>
<a href="#l7.17"></a><span id="l7.17">     /**</span>
<a href="#l7.18"></a><span id="l7.18">      * Display a certain section in the minday/minimonth part of the todaypane.</span>
<a href="#l7.19"></a><span id="l7.19">      *</span>
<a href="#l7.20"></a><span id="l7.20">      * @param aSection      The section to display</span>
<a href="#l7.21"></a><span id="l7.21">      */</span>
<a href="#l7.22"></a><span id="l7.22">     displayMiniSection: function displayMiniSection(aSection) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/src/calFilter.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/src/calFilter.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -97,16 +97,19 @@ calFilter.prototype = {</span>
<a href="#l8.4"></a><span id="l8.4">             return (percentCompleted(item) &lt; 100) &amp;&amp;</span>
<a href="#l8.5"></a><span id="l8.5">             !(item.dueDate.compare(now()) &gt; 0);</span>
<a href="#l8.6"></a><span id="l8.6">         },</span>
<a href="#l8.7"></a><span id="l8.7">         open: function cF_filterCompleted(item) {</span>
<a href="#l8.8"></a><span id="l8.8">             return (percentCompleted(item) &lt; 100);</span>
<a href="#l8.9"></a><span id="l8.9">         },</span>
<a href="#l8.10"></a><span id="l8.10">         completed: function cF_filterCompleted(item) {</span>
<a href="#l8.11"></a><span id="l8.11">             return (percentCompleted(item) &gt;= 100);</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+        },</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+        repeating: function cF_filterRepeating(item) {</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+            return (item.recurrenceInfo != null);</span>
<a href="#l8.15"></a><span id="l8.15">         }</span>
<a href="#l8.16"></a><span id="l8.16">     },</span>
<a href="#l8.17"></a><span id="l8.17"> </span>
<a href="#l8.18"></a><span id="l8.18">     get startDate() {</span>
<a href="#l8.19"></a><span id="l8.19">         return this.mStartDate;</span>
<a href="#l8.20"></a><span id="l8.20">     },</span>
<a href="#l8.21"></a><span id="l8.21"> </span>
<a href="#l8.22"></a><span id="l8.22">     set startDate(aStartDate) {</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineat">@@ -192,73 +195,88 @@ calFilter.prototype = {</span>
<a href="#l8.24"></a><span id="l8.24"> </span>
<a href="#l8.25"></a><span id="l8.25"> /**</span>
<a href="#l8.26"></a><span id="l8.26">  * @param aFilter a String describing the filter, it should met a regEx to call </span>
<a href="#l8.27"></a><span id="l8.27">  *                duration from filter otherwise a costumized filter is called</span>
<a href="#l8.28"></a><span id="l8.28">  * @return        [startDate, endDate]</span>
<a href="#l8.29"></a><span id="l8.29">  */</span>
<a href="#l8.30"></a><span id="l8.30"> </span>
<a href="#l8.31"></a><span id="l8.31"> function getDatesForFilter(aFilter) {</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineminus">-    var EndDate = createDateTime();</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineminus">-    var StartDate = createDateTime();</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineminus">-    var Duration = createDuration();</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineminus">-    var oneDay = createDuration();</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineplus">+    let endDate = cal.createDateTime();</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineplus">+    let startDate = cal.createDateTime();</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+    let duration = cal.createDuration();</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineplus">+    let oneDay = cal.createDuration();</span>
<a href="#l8.40"></a><span id="l8.40">     oneDay.days = 1;</span>
<a href="#l8.41"></a><span id="l8.41"> </span>
<a href="#l8.42"></a><span id="l8.42" class="difflineminus">-    var durFilterReg = /next|last\d+\D+$/</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineplus">+    let durFilterReg = /next|last\d+\D+$/</span>
<a href="#l8.44"></a><span id="l8.44">     if (durFilterReg.exec(aFilter)) {</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineminus">-        Duration =  durationFromFilter(aFilter);</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineminus">-        if (!Duration) {</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineminus">-          EndDate = null;</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineminus">-          StartDate = null;</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineplus">+        duration =  durationFromFilter(aFilter);</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineplus">+        if (!duration) {</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+            endDate = null;</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineplus">+            startDate = null;</span>
<a href="#l8.53"></a><span id="l8.53">         } else {</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineminus">-          StartDate = now();</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineminus">-          EndDate = now();</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineminus">-          EndDate.addDuration(Duration);</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineplus">+            startDate = cal.now();</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineplus">+            endDate = cal.now();</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineplus">+            endDate.addDuration(duration);</span>
<a href="#l8.60"></a><span id="l8.60">         }</span>
<a href="#l8.61"></a><span id="l8.61">     } else {</span>
<a href="#l8.62"></a><span id="l8.62">       switch (aFilter) {</span>
<a href="#l8.63"></a><span id="l8.63">         case &quot;all&quot;:</span>
<a href="#l8.64"></a><span id="l8.64" class="difflineminus">-            StartDate = null;</span>
<a href="#l8.65"></a><span id="l8.65" class="difflineminus">-            EndDate = null;</span>
<a href="#l8.66"></a><span id="l8.66" class="difflineplus">+            startDate = null;</span>
<a href="#l8.67"></a><span id="l8.67" class="difflineplus">+            endDate = null;</span>
<a href="#l8.68"></a><span id="l8.68">             break;</span>
<a href="#l8.69"></a><span id="l8.69"> </span>
<a href="#l8.70"></a><span id="l8.70">         case &quot;today&quot;:</span>
<a href="#l8.71"></a><span id="l8.71" class="difflineminus">-            StartDate = now();</span>
<a href="#l8.72"></a><span id="l8.72" class="difflineminus">-            StartDate.isDate = true;</span>
<a href="#l8.73"></a><span id="l8.73" class="difflineminus">-            EndDate = now();</span>
<a href="#l8.74"></a><span id="l8.74" class="difflineminus">-            EndDate.isDate = true;</span>
<a href="#l8.75"></a><span id="l8.75" class="difflineminus">-            EndDate.addDuration(oneDay);</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineplus">+            startDate = cal.now();</span>
<a href="#l8.77"></a><span id="l8.77" class="difflineplus">+            startDate.isDate = true;</span>
<a href="#l8.78"></a><span id="l8.78" class="difflineplus">+            endDate = cal.now();</span>
<a href="#l8.79"></a><span id="l8.79" class="difflineplus">+            endDate.isDate = true;</span>
<a href="#l8.80"></a><span id="l8.80" class="difflineplus">+            endDate.addDuration(oneDay);</span>
<a href="#l8.81"></a><span id="l8.81">             break;</span>
<a href="#l8.82"></a><span id="l8.82"> </span>
<a href="#l8.83"></a><span id="l8.83">         case &quot;thisCalendarMonth&quot;:</span>
<a href="#l8.84"></a><span id="l8.84" class="difflineminus">-            StartDate = now().startOfMonth;</span>
<a href="#l8.85"></a><span id="l8.85" class="difflineminus">-            EndDate = now().endOfMonth;</span>
<a href="#l8.86"></a><span id="l8.86" class="difflineminus">-            EndDate.addDuration(oneDay);</span>
<a href="#l8.87"></a><span id="l8.87" class="difflineplus">+            startDate = cal.now().startOfMonth;</span>
<a href="#l8.88"></a><span id="l8.88" class="difflineplus">+            endDate = cal.now().endOfMonth;</span>
<a href="#l8.89"></a><span id="l8.89" class="difflineplus">+            endDate.addDuration(oneDay);</span>
<a href="#l8.90"></a><span id="l8.90">             break;</span>
<a href="#l8.91"></a><span id="l8.91"> </span>
<a href="#l8.92"></a><span id="l8.92">         case &quot;future&quot;:</span>
<a href="#l8.93"></a><span id="l8.93" class="difflineminus">-            StartDate = now();</span>
<a href="#l8.94"></a><span id="l8.94" class="difflineminus">-            EndDate = null;</span>
<a href="#l8.95"></a><span id="l8.95" class="difflineplus">+            startDate = cal.now();</span>
<a href="#l8.96"></a><span id="l8.96" class="difflineplus">+            endDate = null;</span>
<a href="#l8.97"></a><span id="l8.97">             break;</span>
<a href="#l8.98"></a><span id="l8.98"> </span>
<a href="#l8.99"></a><span id="l8.99">         case &quot;current&quot;:</span>
<a href="#l8.100"></a><span id="l8.100" class="difflineminus">-            var SelectedDate = currentView().selectedDay;</span>
<a href="#l8.101"></a><span id="l8.101" class="difflineminus">-            StartDate = SelectedDate.clone();</span>
<a href="#l8.102"></a><span id="l8.102" class="difflineminus">-            StartDate.isDate = true;</span>
<a href="#l8.103"></a><span id="l8.103" class="difflineminus">-            EndDate = StartDate.clone();</span>
<a href="#l8.104"></a><span id="l8.104" class="difflineminus">-            EndDate.addDuration(oneDay);</span>
<a href="#l8.105"></a><span id="l8.105" class="difflineplus">+            let selectedDate = currentView().selectedDay;</span>
<a href="#l8.106"></a><span id="l8.106" class="difflineplus">+            startDate = selectedDate.clone();</span>
<a href="#l8.107"></a><span id="l8.107" class="difflineplus">+            startDate.isDate = true;</span>
<a href="#l8.108"></a><span id="l8.108" class="difflineplus">+            endDate = startDate.clone();</span>
<a href="#l8.109"></a><span id="l8.109" class="difflineplus">+            endDate.addDuration(oneDay);</span>
<a href="#l8.110"></a><span id="l8.110">             break;</span>
<a href="#l8.111"></a><span id="l8.111" class="difflineplus">+</span>
<a href="#l8.112"></a><span id="l8.112" class="difflineplus">+        case &quot;throughcurrent&quot;:</span>
<a href="#l8.113"></a><span id="l8.113" class="difflineplus">+        case &quot;open&quot;:</span>
<a href="#l8.114"></a><span id="l8.114" class="difflineplus">+        case &quot;overdue&quot;:</span>
<a href="#l8.115"></a><span id="l8.115" class="difflineplus">+        case &quot;completed&quot;:</span>
<a href="#l8.116"></a><span id="l8.116" class="difflineplus">+        case &quot;notstarted&quot;:</span>
<a href="#l8.117"></a><span id="l8.117" class="difflineplus">+            // use the later of the current date or the selected date of the current view</span>
<a href="#l8.118"></a><span id="l8.118" class="difflineplus">+            endDate = currentView().selectedDay.clone();</span>
<a href="#l8.119"></a><span id="l8.119" class="difflineplus">+            if (endDate.jsDate &lt; cal.now().jsDate) {</span>
<a href="#l8.120"></a><span id="l8.120" class="difflineplus">+                endDate = cal.now();</span>
<a href="#l8.121"></a><span id="l8.121" class="difflineplus">+            }</span>
<a href="#l8.122"></a><span id="l8.122" class="difflineplus">+            endDate.isDate = true;</span>
<a href="#l8.123"></a><span id="l8.123" class="difflineplus">+            endDate.addDuration(oneDay);</span>
<a href="#l8.124"></a><span id="l8.124" class="difflineplus">+            break;</span>
<a href="#l8.125"></a><span id="l8.125" class="difflineplus">+</span>
<a href="#l8.126"></a><span id="l8.126">         default:</span>
<a href="#l8.127"></a><span id="l8.127" class="difflineminus">-            StartDate = null;</span>
<a href="#l8.128"></a><span id="l8.128" class="difflineminus">-            EndDate = null;</span>
<a href="#l8.129"></a><span id="l8.129" class="difflineplus">+            startDate = null;</span>
<a href="#l8.130"></a><span id="l8.130" class="difflineplus">+            endDate = null;</span>
<a href="#l8.131"></a><span id="l8.131">             break;</span>
<a href="#l8.132"></a><span id="l8.132">       }</span>
<a href="#l8.133"></a><span id="l8.133">     }</span>
<a href="#l8.134"></a><span id="l8.134" class="difflineminus">-    return [StartDate, EndDate];</span>
<a href="#l8.135"></a><span id="l8.135" class="difflineplus">+    return [startDate, endDate];</span>
<a href="#l8.136"></a><span id="l8.136"> }</span>
<a href="#l8.137"></a><span id="l8.137"> </span>
<a href="#l8.138"></a><span id="l8.138"> /**</span>
<a href="#l8.139"></a><span id="l8.139">  * Functions to create a duration based on a filter string.</span>
<a href="#l8.140"></a><span id="l8.140">  * </span>
<a href="#l8.141"></a><span id="l8.141">  * @param aFilter the filter string, it has has to match the pattern</span>
<a href="#l8.142"></a><span id="l8.142">  *                [last|next] Period [UnitOfThePeriod]</span>
<a href="#l8.143"></a><span id="l8.143">  * @return        the duration or null</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/src/calUtils.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/src/calUtils.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -1113,16 +1113,19 @@ function checkIfInRange(item, rangeStart</span>
<a href="#l9.4"></a><span id="l9.4">  * completed, overdue, duetoday, inprogress, future</span>
<a href="#l9.5"></a><span id="l9.5">  *</span>
<a href="#l9.6"></a><span id="l9.6">  * @param aTask     The task to check.</span>
<a href="#l9.7"></a><span id="l9.7">  * @return          The progress atom.</span>
<a href="#l9.8"></a><span id="l9.8">  */</span>
<a href="#l9.9"></a><span id="l9.9"> function getProgressAtom(aTask) {</span>
<a href="#l9.10"></a><span id="l9.10">     var now = new Date();</span>
<a href="#l9.11"></a><span id="l9.11"> </span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+    if (aTask.recurrenceInfo)</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+      return &quot;repeating&quot;;</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+</span>
<a href="#l9.15"></a><span id="l9.15">     if (aTask.isCompleted)</span>
<a href="#l9.16"></a><span id="l9.16">       return &quot;completed&quot;;</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18">     if (aTask.dueDate &amp;&amp; aTask.dueDate.isValid) {</span>
<a href="#l9.19"></a><span id="l9.19">         if (aTask.dueDate.jsDate.getTime() &lt; now.getTime()) {</span>
<a href="#l9.20"></a><span id="l9.20">             return &quot;overdue&quot;;</span>
<a href="#l9.21"></a><span id="l9.21">         } else if (aTask.dueDate.year == now.getFullYear() &amp;&amp;</span>
<a href="#l9.22"></a><span id="l9.22">                    aTask.dueDate.month == now.getMonth() &amp;&amp;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/themes/common/calendar-task-tree.css</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/themes/common/calendar-task-tree.css</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -125,16 +125,21 @@</span>
<a href="#l10.4"></a><span id="l10.4"> .calendar-task-tree &gt; treechildren::-moz-tree-image(calendar-task-tree-col-completed, duetoday),</span>
<a href="#l10.5"></a><span id="l10.5"> .calendar-task-tree &gt; treechildren::-moz-tree-image(calendar-task-tree-col-completed, overdue),</span>
<a href="#l10.6"></a><span id="l10.6"> .calendar-task-tree &gt; treechildren::-moz-tree-image(calendar-task-tree-col-completed, future),</span>
<a href="#l10.7"></a><span id="l10.7"> .calendar-task-tree &gt; treechildren::-moz-tree-image(calendar-task-tree-col-completed, inprogress) {</span>
<a href="#l10.8"></a><span id="l10.8">     list-style-image: url(chrome://calendar/skin/unifinder-images.png);</span>
<a href="#l10.9"></a><span id="l10.9">     -moz-image-region: rect(0 13px 13px 0);</span>
<a href="#l10.10"></a><span id="l10.10"> }</span>
<a href="#l10.11"></a><span id="l10.11"> </span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+.calendar-task-tree &gt; treechildren::-moz-tree-image(calendar-task-tree-col-completed, repeating) {</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+    list-style-image: url(chrome://calendar/skin/unifinder-images.png);</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+    -moz-image-region: rect(0 39px 13px 26px);</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+}</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineplus">+</span>
<a href="#l10.17"></a><span id="l10.17"> .calendar-task-tree-col-priority {</span>
<a href="#l10.18"></a><span id="l10.18">     list-style-image: url(chrome://calendar/skin/unifinder-images.png);</span>
<a href="#l10.19"></a><span id="l10.19">     -moz-image-region: rect(0 65px 13px 52px);</span>
<a href="#l10.20"></a><span id="l10.20"> }</span>
<a href="#l10.21"></a><span id="l10.21"> </span>
<a href="#l10.22"></a><span id="l10.22"> .calendar-task-tree &gt; treechildren::-moz-tree-image(calendar-task-tree-col-priority, mediumpriority),</span>
<a href="#l10.23"></a><span id="l10.23"> .todo-due-image-class {</span>
<a href="#l10.24"></a><span id="l10.24">     list-style-image: url(chrome://calendar/skin/unifinder-images.png);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/lightning/content/messenger-overlay-sidebar.xul</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/lightning/content/messenger-overlay-sidebar.xul</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -252,23 +252,23 @@</span>
<a href="#l11.4"></a><span id="l11.4">                   attribute=&quot;value&quot;</span>
<a href="#l11.5"></a><span id="l11.5">                   onbroadcast=&quot;checkRadioControl(this.parentNode, document.getElementById(this.getAttribute('element')).getAttribute('value'));&quot;/&gt;</span>
<a href="#l11.6"></a><span id="l11.6">         &lt;menuitem id=&quot;ltnTasksViewFilterTasks&quot;</span>
<a href="#l11.7"></a><span id="l11.7">                   type=&quot;checkbox&quot;</span>
<a href="#l11.8"></a><span id="l11.8">                   label=&quot;&amp;calendar.tasks.view.filtertasks.label;&quot;</span>
<a href="#l11.9"></a><span id="l11.9">                   accesskey=&quot;&amp;calendar.tasks.view.filtertasks.accesskey;&quot;</span>
<a href="#l11.10"></a><span id="l11.10">                   command=&quot;calendar_toggle_filter_command&quot;/&gt;</span>
<a href="#l11.11"></a><span id="l11.11">         &lt;menuseparator id=&quot;ltnTasksViewSeparator&quot;/&gt;</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-        &lt;menuitem id=&quot;ltnTasksViewFilterAll&quot;</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+        &lt;menuitem id=&quot;ltnTasksViewFilterCurrent&quot;</span>
<a href="#l11.14"></a><span id="l11.14">                   name=&quot;filtergroup&quot;</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineminus">-                  value=&quot;all&quot;</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+                  value=&quot;throughcurrent&quot;</span>
<a href="#l11.17"></a><span id="l11.17">                   type=&quot;radio&quot;</span>
<a href="#l11.18"></a><span id="l11.18">                   command=&quot;calendar_task_filter_command&quot;</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineminus">-                  label=&quot;&amp;calendar.task.filter.all.label;&quot;</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineminus">-                  accesskey=&quot;&amp;calendar.task.filter.all.accesskey;&quot;/&gt;</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineplus">+                  label=&quot;&amp;calendar.task.filter.current.label;&quot;</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineplus">+                  accesskey=&quot;&amp;calendar.task.filter.current.accesskey;&quot;/&gt;</span>
<a href="#l11.23"></a><span id="l11.23">         &lt;menuitem id=&quot;ltnTasksViewFilterToday&quot;</span>
<a href="#l11.24"></a><span id="l11.24">                   name=&quot;filtergroup&quot;</span>
<a href="#l11.25"></a><span id="l11.25">                   value=&quot;today&quot;</span>
<a href="#l11.26"></a><span id="l11.26">                   type=&quot;radio&quot;</span>
<a href="#l11.27"></a><span id="l11.27">                   command=&quot;calendar_task_filter_command&quot;</span>
<a href="#l11.28"></a><span id="l11.28">                   label=&quot;&amp;calendar.task.filter.today.label;&quot;</span>
<a href="#l11.29"></a><span id="l11.29">                   accesskey=&quot;&amp;calendar.task.filter.today.accesskey;&quot;/&gt;</span>
<a href="#l11.30"></a><span id="l11.30">         &lt;menuitem id=&quot;ltnTasksViewFilterNext7days&quot;</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineat">@@ -301,16 +301,23 @@</span>
<a href="#l11.32"></a><span id="l11.32">                   accesskey=&quot;&amp;calendar.task.filter.completed.accesskey;&quot;/&gt;</span>
<a href="#l11.33"></a><span id="l11.33">         &lt;menuitem id=&quot;ltnTasksViewFilterOpen&quot;</span>
<a href="#l11.34"></a><span id="l11.34">                   name=&quot;filtergroup&quot;</span>
<a href="#l11.35"></a><span id="l11.35">                   type=&quot;radio&quot;</span>
<a href="#l11.36"></a><span id="l11.36">                   value=&quot;open&quot;</span>
<a href="#l11.37"></a><span id="l11.37">                   command=&quot;calendar_task_filter_command&quot;</span>
<a href="#l11.38"></a><span id="l11.38">                   label=&quot;&amp;calendar.task.filter.open.label;&quot;</span>
<a href="#l11.39"></a><span id="l11.39">                   accesskey=&quot;&amp;calendar.task.filter.open.accesskey;&quot;/&gt;</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineplus">+        &lt;menuitem id=&quot;ltnTasksViewFilterAll&quot;</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineplus">+                  name=&quot;filtergroup&quot;</span>
<a href="#l11.42"></a><span id="l11.42" class="difflineplus">+                  value=&quot;all&quot;</span>
<a href="#l11.43"></a><span id="l11.43" class="difflineplus">+                  type=&quot;radio&quot;</span>
<a href="#l11.44"></a><span id="l11.44" class="difflineplus">+                  command=&quot;calendar_task_filter_command&quot;</span>
<a href="#l11.45"></a><span id="l11.45" class="difflineplus">+                  label=&quot;&amp;calendar.task.filter.all.label;&quot;</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineplus">+                  accesskey=&quot;&amp;calendar.task.filter.all.accesskey;&quot;/&gt;</span>
<a href="#l11.47"></a><span id="l11.47">       &lt;/menupopup&gt;</span>
<a href="#l11.48"></a><span id="l11.48">     &lt;/menu&gt;</span>
<a href="#l11.49"></a><span id="l11.49">   &lt;/menupopup&gt;</span>
<a href="#l11.50"></a><span id="l11.50"> </span>
<a href="#l11.51"></a><span id="l11.51">   &lt;menupopup id=&quot;menu_GoPopup&quot;&gt;</span>
<a href="#l11.52"></a><span id="l11.52">     &lt;menuitem id=&quot;ltnGoToToday&quot;</span>
<a href="#l11.53"></a><span id="l11.53">               insertafter=&quot;goNextSeparator&quot;</span>
<a href="#l11.54"></a><span id="l11.54">               label=&quot;&amp;goTodayCmd.label;&quot;</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineat">@@ -510,23 +517,24 @@</span>
<a href="#l11.56"></a><span id="l11.56">                                class=&quot;treenode-checkbox&quot;</span>
<a href="#l11.57"></a><span id="l11.57">                                label=&quot;&amp;calendar.task.filter.title.label;&quot;/&gt;</span>
<a href="#l11.58"></a><span id="l11.58">               &lt;modevbox id=&quot;task-filtertree-pane&quot; flex=&quot;1&quot; mode=&quot;task&quot; broadcaster=&quot;modeBroadcaster&quot; refcontrol=&quot;task-tree-filter-header&quot;&gt;</span>
<a href="#l11.59"></a><span id="l11.59">                  &lt;radiogroup id=&quot;task-tree-filtergroup&quot; class=&quot;task-tree-subpane&quot;</span>
<a href="#l11.60"></a><span id="l11.60">                              persist=&quot;value&quot;&gt;</span>
<a href="#l11.61"></a><span id="l11.61">                    &lt;observes element=&quot;filterBroadcaster&quot;</span>
<a href="#l11.62"></a><span id="l11.62">                              attribute=&quot;value&quot;</span>
<a href="#l11.63"></a><span id="l11.63">                              onbroadcast=&quot;checkRadioControl(this.parentNode, document.getElementById('filterBroadcaster').getAttribute('value'));&quot;/&gt;</span>
<a href="#l11.64"></a><span id="l11.64" class="difflineminus">-                   &lt;radio id=&quot;opt_all_filter&quot; label=&quot;&amp;calendar.task.filter.all.label;&quot; value=&quot;all&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l11.65"></a><span id="l11.65" class="difflineplus">+                   &lt;radio id=&quot;opt_throughcurrent_filter&quot; label=&quot;&amp;calendar.task.filter.current.label;&quot; value=&quot;throughcurrent&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l11.66"></a><span id="l11.66">                    &lt;radio id=&quot;opt_today_filter&quot; label=&quot;&amp;calendar.task.filter.today.label;&quot; value=&quot;today&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l11.67"></a><span id="l11.67">                    &lt;radio id=&quot;opt_next7days_filter&quot; label=&quot;&amp;calendar.task.filter.next7days.label;&quot; value=&quot;next7days&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l11.68"></a><span id="l11.68">                    &lt;radio id=&quot;opt_notstarted_filter&quot; label=&quot;&amp;calendar.task.filter.notstarted.label;&quot; value=&quot;notstarted&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l11.69"></a><span id="l11.69">                    &lt;radio id=&quot;opt_overdue_filter&quot; label=&quot;&amp;calendar.task.filter.overdue.label;&quot; value=&quot;overdue&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l11.70"></a><span id="l11.70">                    &lt;radio id=&quot;opt_completed_filter&quot; label=&quot;&amp;calendar.task.filter.completed.label;&quot; value=&quot;completed&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l11.71"></a><span id="l11.71">                    &lt;radio id=&quot;opt_open_filter&quot; label=&quot;&amp;calendar.task.filter.open.label;&quot; value=&quot;open&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l11.72"></a><span id="l11.72" class="difflineplus">+                   &lt;radio id=&quot;opt_all_filter&quot; label=&quot;&amp;calendar.task.filter.all.label;&quot; value=&quot;all&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l11.73"></a><span id="l11.73">                  &lt;/radiogroup&gt;</span>
<a href="#l11.74"></a><span id="l11.74">               &lt;/modevbox&gt;</span>
<a href="#l11.75"></a><span id="l11.75">             &lt;/modevbox&gt;</span>
<a href="#l11.76"></a><span id="l11.76">             &lt;modevbox id=&quot;calendar-list-pane&quot; flex=&quot;1&quot; mode=&quot;calendar,task&quot; broadcaster=&quot;modeBroadcaster&quot;</span>
<a href="#l11.77"></a><span id="l11.77">                       refcontrol=&quot;calendar_toggle_calendarlist_command&quot;&gt;</span>
<a href="#l11.78"></a><span id="l11.78">               &lt;treenode-checkbox id=&quot;calendar-list-header&quot;</span>
<a href="#l11.79"></a><span id="l11.79">                                checked=&quot;true&quot;</span>
<a href="#l11.80"></a><span id="l11.80">                                class=&quot;treenode-checkbox&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/locales/en-US/chrome/calendar/calendar.dtd</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/locales/en-US/chrome/calendar/calendar.dtd</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -146,16 +146,20 @@</span>
<a href="#l12.4"></a><span id="l12.4"> &lt;!ENTITY calendar.task.filter.notstarted.label      &quot;Not Started Tasks&quot;&gt;</span>
<a href="#l12.5"></a><span id="l12.5"> &lt;!ENTITY calendar.task.filter.notstarted.accesskey  &quot;a&quot;&gt;</span>
<a href="#l12.6"></a><span id="l12.6"> &lt;!ENTITY calendar.task.filter.overdue.label         &quot;Overdue Tasks&quot;&gt;</span>
<a href="#l12.7"></a><span id="l12.7"> &lt;!ENTITY calendar.task.filter.overdue.accesskey     &quot;O&quot;&gt;</span>
<a href="#l12.8"></a><span id="l12.8"> &lt;!ENTITY calendar.task.filter.completed.label       &quot;Completed Tasks&quot;&gt;</span>
<a href="#l12.9"></a><span id="l12.9"> &lt;!ENTITY calendar.task.filter.completed.accesskey   &quot;C&quot;&gt;</span>
<a href="#l12.10"></a><span id="l12.10"> &lt;!ENTITY calendar.task.filter.open.label            &quot;Incomplete Tasks&quot;&gt;</span>
<a href="#l12.11"></a><span id="l12.11"> &lt;!ENTITY calendar.task.filter.open.accesskey        &quot;m&quot;&gt;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+&lt;!ENTITY calendar.task.filter.current.label         &quot;Current Tasks&quot;&gt;</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+&lt;!ENTITY calendar.task.filter.current.accesskey     &quot;u&quot;&gt;</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+&lt;!ENTITY calendar.task.filter.repeating.label       &quot;Repeating Tasks&quot;&gt;</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+&lt;!ENTITY calendar.task.filter.repeating.accesskey   &quot;R&quot;&gt;</span>
<a href="#l12.16"></a><span id="l12.16"> </span>
<a href="#l12.17"></a><span id="l12.17"> &lt;!ENTITY calendar.task-details.title.label           &quot;title&quot;&gt;</span>
<a href="#l12.18"></a><span id="l12.18"> &lt;!ENTITY calendar.task-details.organizer.label       &quot;from&quot;&gt;</span>
<a href="#l12.19"></a><span id="l12.19"> &lt;!ENTITY calendar.task-details.priority.label        &quot;priority&quot;&gt;</span>
<a href="#l12.20"></a><span id="l12.20"> &lt;!ENTITY calendar.task-details.priority.low.label    &quot;Low&quot;&gt;</span>
<a href="#l12.21"></a><span id="l12.21"> &lt;!ENTITY calendar.task-details.priority.normal.label &quot;Normal&quot;&gt;</span>
<a href="#l12.22"></a><span id="l12.22"> &lt;!ENTITY calendar.task-details.priority.high.label   &quot;High&quot;&gt;</span>
<a href="#l12.23"></a><span id="l12.23"> &lt;!ENTITY calendar.task-details.status.label          &quot;status&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/locales/en-US/chrome/calendar/dateFormat.properties</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/locales/en-US/chrome/calendar/dateFormat.properties</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -119,8 +119,9 @@ day.28.number=28</span>
<a href="#l13.4"></a><span id="l13.4"> day.29.number=29</span>
<a href="#l13.5"></a><span id="l13.5"> day.30.number=30</span>
<a href="#l13.6"></a><span id="l13.6"> day.31.number=31</span>
<a href="#l13.7"></a><span id="l13.7"> </span>
<a href="#l13.8"></a><span id="l13.8"> noon=Noon</span>
<a href="#l13.9"></a><span id="l13.9"> midnight=Midnight</span>
<a href="#l13.10"></a><span id="l13.10"> </span>
<a href="#l13.11"></a><span id="l13.11"> AllDay=All Day</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+Repeating=(Repeating)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/providers/memory/calMemoryCalendar.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/providers/memory/calMemoryCalendar.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -447,18 +447,22 @@ calMemoryCalendar.prototype = {</span>
<a href="#l14.4"></a><span id="l14.4">                 if (!wantEvents) {</span>
<a href="#l14.5"></a><span id="l14.5">                     continue;</span>
<a href="#l14.6"></a><span id="l14.6">                 }</span>
<a href="#l14.7"></a><span id="l14.7">             } else if (!wantTodos) {</span>
<a href="#l14.8"></a><span id="l14.8">                 continue;</span>
<a href="#l14.9"></a><span id="l14.9">             }</span>
<a href="#l14.10"></a><span id="l14.10"> </span>
<a href="#l14.11"></a><span id="l14.11">             if (itemReturnOccurrences &amp;&amp; item.recurrenceInfo) {</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-                var occurrences = item.recurrenceInfo.getOccurrences(</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-                    aRangeStart, aRangeEnd, aCount ? aCount - itemsFound.length : 0, {});</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+                let startDate  = aRangeStart;</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+                if (!aRangeStart &amp;&amp; cal.isToDo(item)) {</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineplus">+                    startDate = item.entryDate;</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+                }</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineplus">+                let occurrences = item.recurrenceInfo.getOccurrences(</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineplus">+                    startDate, aRangeEnd, aCount ? aCount - itemsFound.length : 0, {});</span>
<a href="#l14.20"></a><span id="l14.20">                 if (wantUnrespondedInvitations) {</span>
<a href="#l14.21"></a><span id="l14.21">                     occurrences = occurrences.filter(checkUnrespondedInvitation);</span>
<a href="#l14.22"></a><span id="l14.22">                 }</span>
<a href="#l14.23"></a><span id="l14.23">                 if (!isEvent_) {</span>
<a href="#l14.24"></a><span id="l14.24">                     occurrences = occurrences.filter(checkCompleted);</span>
<a href="#l14.25"></a><span id="l14.25">                 }</span>
<a href="#l14.26"></a><span id="l14.26">                 itemsFound = itemsFound.concat(occurrences);</span>
<a href="#l14.27"></a><span id="l14.27">             } else if ((!wantUnrespondedInvitations || checkUnrespondedInvitation(item)) &amp;&amp;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

